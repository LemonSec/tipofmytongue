1
00:00:02,040 --> 00:00:05,040
welcome everyone to 3 P.M and our last

2
00:00:05,040 --> 00:00:08,039
conference talk in track two we've got

3
00:00:08,039 --> 00:00:09,900
John Stoner here with us today being a

4
00:00:09,900 --> 00:00:11,639
better Defender by channeling your worst

5
00:00:11,639 --> 00:00:13,559
adversary Lessons Learned building

6
00:00:13,559 --> 00:00:16,320
adversary emulations John's a principal

7
00:00:16,320 --> 00:00:18,720
security strategist at Splunk where he's

8
00:00:18,720 --> 00:00:20,880
uh working to educate and improve users

9
00:00:20,880 --> 00:00:22,380
capabilities and security operations

10
00:00:22,380 --> 00:00:24,779
threat hunting incident response and

11
00:00:24,779 --> 00:00:26,939
threat intelligence uh he's written some

12
00:00:26,939 --> 00:00:28,740
Hands-On workshops that focus on working

13
00:00:28,740 --> 00:00:30,300
on those specific security skills you

14
00:00:30,300 --> 00:00:32,640
can find those on us Planck blogs uh he

15
00:00:32,640 --> 00:00:36,260
enjoys problem solving that's good

16
00:00:36,260 --> 00:00:38,780
with the job you've got

17
00:00:38,780 --> 00:00:41,040
writing and educating when he's not

18
00:00:41,040 --> 00:00:42,960
doing cyber things he enjoys reading or

19
00:00:42,960 --> 00:00:44,820
binge watching the TV series that you've

20
00:00:44,820 --> 00:00:46,860
already watched during the fall and

21
00:00:46,860 --> 00:00:48,059
winter you can find him driving his boys

22
00:00:48,059 --> 00:00:49,559
to hockey rinks across the northeastern

23
00:00:49,559 --> 00:00:51,660
U.S he also enjoys listening to what his

24
00:00:51,660 --> 00:00:54,440
teammates call 80s sad timey music

25
00:00:54,440 --> 00:00:58,920
you'll see John thank you

26
00:00:58,920 --> 00:01:00,840
all right thank you all for being here

27
00:01:00,840 --> 00:01:05,760
uh I realize the last slot almost of the

28
00:01:05,760 --> 00:01:07,560
last day of the conference is always the

29
00:01:07,560 --> 00:01:09,780
prime time so hey thank you for sticking

30
00:01:09,780 --> 00:01:11,760
with us number one number two I'm glad

31
00:01:11,760 --> 00:01:12,600
we didn't have to move everybody

32
00:01:12,600 --> 00:01:14,760
including the camera folks out to the

33
00:01:14,760 --> 00:01:16,140
pool that everybody's sitting out there

34
00:01:16,140 --> 00:01:17,520
is a little bit too Breezy so I guess

35
00:01:17,520 --> 00:01:19,680
everybody came in so it's great

36
00:01:19,680 --> 00:01:22,080
um we're going to be talking about uh

37
00:01:22,080 --> 00:01:23,280
you know Lessons Learned building

38
00:01:23,280 --> 00:01:27,540
adversary emulations and again as was

39
00:01:27,540 --> 00:01:29,460
mentioned before this is a little bit

40
00:01:29,460 --> 00:01:31,920
different than probably somebody who is

41
00:01:31,920 --> 00:01:34,259
looking to do uh you know the pen

42
00:01:34,259 --> 00:01:35,939
testing the red team route right because

43
00:01:35,939 --> 00:01:38,400
both for starters that's not what I do

44
00:01:38,400 --> 00:01:41,640
um I'm I'm more The Blue Team guy uh we

45
00:01:41,640 --> 00:01:45,119
do a blue team Capture the Flag uh we

46
00:01:45,119 --> 00:01:47,280
help up level analysts we try to make

47
00:01:47,280 --> 00:01:48,840
them better at their jobs and so that's

48
00:01:48,840 --> 00:01:50,340
what a lot of these pieces that I'm

49
00:01:50,340 --> 00:01:51,720
going to be talking about are things

50
00:01:51,720 --> 00:01:53,340
that I've learned as I've been building

51
00:01:53,340 --> 00:01:55,920
these uh adversary emulations over the

52
00:01:55,920 --> 00:01:57,720
past couple of years

53
00:01:57,720 --> 00:01:58,500
um

54
00:01:58,500 --> 00:02:00,720
yesterday during the keynote right Derek

55
00:02:00,720 --> 00:02:03,540
mentioned Partnerships uh I tried to

56
00:02:03,540 --> 00:02:04,619
write it down because otherwise I can't

57
00:02:04,619 --> 00:02:05,759
keep track of this stuff Partnerships

58
00:02:05,759 --> 00:02:07,439
not adversaries are attempts to be

59
00:02:07,439 --> 00:02:08,639
better

60
00:02:08,639 --> 00:02:10,199
um with the blue team right and that

61
00:02:10,199 --> 00:02:11,760
kind of resonated with this overall

62
00:02:11,760 --> 00:02:13,440
concept of the things that we're trying

63
00:02:13,440 --> 00:02:16,980
to do so that's as I'm talking that's

64
00:02:16,980 --> 00:02:18,540
kind of the frame of reference that I'm

65
00:02:18,540 --> 00:02:19,860
coming from

66
00:02:19,860 --> 00:02:22,379
um you heard the bio already uh Twitter

67
00:02:22,379 --> 00:02:24,060
handles there

68
00:02:24,060 --> 00:02:25,800
um and yeah specifically The Smiths

69
00:02:25,800 --> 00:02:27,239
you'll see a couple references to what

70
00:02:27,239 --> 00:02:29,040
would probably be called 80 sad timing

71
00:02:29,040 --> 00:02:30,660
music out there I'll let you guys figure

72
00:02:30,660 --> 00:02:32,640
out which ones those are

73
00:02:32,640 --> 00:02:35,220
in the next 45 minutes kind of the three

74
00:02:35,220 --> 00:02:37,319
high-level Concepts methods to emulate

75
00:02:37,319 --> 00:02:39,000
the adversary share what we've done

76
00:02:39,000 --> 00:02:40,860
provide some of those lessons learned

77
00:02:40,860 --> 00:02:42,660
that if you guys decide you want to do

78
00:02:42,660 --> 00:02:45,000
things like this that you can learn from

79
00:02:45,000 --> 00:02:46,440
those things that we didn't do quite so

80
00:02:46,440 --> 00:02:48,680
well

81
00:02:48,900 --> 00:02:50,879
uh yesterday

82
00:02:50,879 --> 00:02:52,200
um Adam's talked about a little bit

83
00:02:52,200 --> 00:02:54,840
about Red Canary and uh emulating

84
00:02:54,840 --> 00:02:56,519
adversaries

85
00:02:56,519 --> 00:02:58,260
um you know if you want to do unit

86
00:02:58,260 --> 00:02:59,640
testing you can certainly do unit

87
00:02:59,640 --> 00:03:01,140
testing out there that's a good way to

88
00:03:01,140 --> 00:03:04,800
emulate uh specific adversary actions uh

89
00:03:04,800 --> 00:03:06,360
you can automate those things right

90
00:03:06,360 --> 00:03:08,700
there's Caldera miter Caldera that's

91
00:03:08,700 --> 00:03:10,680
Yellowstone Caldera different Caldera

92
00:03:10,680 --> 00:03:12,540
same concept though right you could do

93
00:03:12,540 --> 00:03:14,040
the automated testing there's lots of

94
00:03:14,040 --> 00:03:16,019
things out there we're not talking about

95
00:03:16,019 --> 00:03:17,340
those kinds of things here we're

96
00:03:17,340 --> 00:03:18,659
actually talking about kind of rolling

97
00:03:18,659 --> 00:03:20,519
up our sleeves building this thing and

98
00:03:20,519 --> 00:03:22,200
then running it end to end and then

99
00:03:22,200 --> 00:03:24,959
doing stuff with that data set and the

100
00:03:24,959 --> 00:03:26,700
reason we do that is because there's

101
00:03:26,700 --> 00:03:27,659
lots of different things you can

102
00:03:27,659 --> 00:03:29,640
accomplish when you're trying to build

103
00:03:29,640 --> 00:03:31,500
your adversary emulation

104
00:03:31,500 --> 00:03:33,659
high-level prevention detection response

105
00:03:33,659 --> 00:03:35,040
forensics

106
00:03:35,040 --> 00:03:37,440
a lot of what we're doing is focusing on

107
00:03:37,440 --> 00:03:39,540
the detection side of this okay because

108
00:03:39,540 --> 00:03:41,159
at the end of the day

109
00:03:41,159 --> 00:03:43,140
that's what we do at Splunk right we

110
00:03:43,140 --> 00:03:45,480
focus on detection we focus on trying to

111
00:03:45,480 --> 00:03:48,720
go ahead and basically

112
00:03:48,720 --> 00:03:51,360
Bridge the data Gap

113
00:03:51,360 --> 00:03:52,080
um

114
00:03:52,080 --> 00:03:54,180
because if we can't see it we can't

115
00:03:54,180 --> 00:03:55,680
haunt it if we can't hunt it we can't

116
00:03:55,680 --> 00:03:57,900
detect it okay and that's what we want

117
00:03:57,900 --> 00:04:00,440
to focus on

118
00:04:00,780 --> 00:04:03,959
Bots anybody play Bots

119
00:04:03,959 --> 00:04:08,099
Bots okay Bots is our blue team capture

120
00:04:08,099 --> 00:04:09,360
the flag

121
00:04:09,360 --> 00:04:12,000
we started in 2016 building it to be

122
00:04:12,000 --> 00:04:14,819
realistic to be a competition

123
00:04:14,819 --> 00:04:16,440
and where I've kind of taken this is to

124
00:04:16,440 --> 00:04:18,060
try to do some of the training pieces of

125
00:04:18,060 --> 00:04:19,320
this

126
00:04:19,320 --> 00:04:21,839
so

127
00:04:21,839 --> 00:04:25,560
we built a company called frothly

128
00:04:25,560 --> 00:04:28,620
frothly is a brewing

129
00:04:28,620 --> 00:04:31,080
what do we call this

130
00:04:31,080 --> 00:04:32,880
there are brewing supply companies where

131
00:04:32,880 --> 00:04:38,160
they started off okay you need to have a

132
00:04:38,160 --> 00:04:41,280
you need to have a victim but the victim

133
00:04:41,280 --> 00:04:43,560
shouldn't be your own organization right

134
00:04:43,560 --> 00:04:45,120
it could be right but we're not going to

135
00:04:45,120 --> 00:04:46,620
attack Splunk right that wouldn't kind

136
00:04:46,620 --> 00:04:48,479
of be a bad thing

137
00:04:48,479 --> 00:04:50,160
what we wanted to do was we wanted to

138
00:04:50,160 --> 00:04:51,840
have a

139
00:04:51,840 --> 00:04:53,880
something to go after and so we created

140
00:04:53,880 --> 00:04:55,800
frothly frothly has characters and

141
00:04:55,800 --> 00:05:00,660
personas Grace uh hoppy is the CEO okay

142
00:05:00,660 --> 00:05:03,120
Grace has an entire team out there of

143
00:05:03,120 --> 00:05:04,020
folks

144
00:05:04,020 --> 00:05:06,300
okay and what she's trying to do is

145
00:05:06,300 --> 00:05:08,040
she's trying to run her bra or her

146
00:05:08,040 --> 00:05:09,240
Brewing Company

147
00:05:09,240 --> 00:05:11,340
and she's got representative personas

148
00:05:11,340 --> 00:05:13,080
inside of that

149
00:05:13,080 --> 00:05:16,919
marketing r d i t

150
00:05:16,919 --> 00:05:18,180
you guys have those kinds of things in

151
00:05:18,180 --> 00:05:20,639
your companies right of course

152
00:05:20,639 --> 00:05:22,139
what we wanted to do was have a

153
00:05:22,139 --> 00:05:24,120
representative organization so that when

154
00:05:24,120 --> 00:05:26,160
they're attacked we can focus on a

155
00:05:26,160 --> 00:05:27,660
specific Persona who's being attacked

156
00:05:27,660 --> 00:05:30,240
and the specific actions of that Persona

157
00:05:30,240 --> 00:05:33,120
okay now if you wanted to do an

158
00:05:33,120 --> 00:05:34,199
adversary emulation in your own

159
00:05:34,199 --> 00:05:36,840
organization you could certainly do that

160
00:05:36,840 --> 00:05:38,520
but you don't want to pick on Bob in

161
00:05:38,520 --> 00:05:40,800
accounting you want to pick on freedom

162
00:05:40,800 --> 00:05:42,360
marketing right because at the end of

163
00:05:42,360 --> 00:05:43,560
the day we're not into victim shaming

164
00:05:43,560 --> 00:05:45,960
here what we're trying to do is try and

165
00:05:45,960 --> 00:05:49,500
go ahead and create that emulation and

166
00:05:49,500 --> 00:05:51,539
so when we're adverse um emulating the

167
00:05:51,539 --> 00:05:53,520
adversary we also have to have a victim

168
00:05:53,520 --> 00:05:55,020
that we're emulating okay and that's

169
00:05:55,020 --> 00:05:56,880
what we've done here the other thing

170
00:05:56,880 --> 00:05:58,320
that we've done with this is we've built

171
00:05:58,320 --> 00:06:00,120
this in such a way that if we want to

172
00:06:00,120 --> 00:06:02,880
scale this over time and change the

173
00:06:02,880 --> 00:06:05,940
landscape around it we can do that

174
00:06:05,940 --> 00:06:07,680
so when we started the Brewing Supply

175
00:06:07,680 --> 00:06:09,000
Company it was just a brewing supply

176
00:06:09,000 --> 00:06:09,979
company

177
00:06:09,979 --> 00:06:12,479
we wanted to emulate a kubernetes attack

178
00:06:12,479 --> 00:06:14,880
well we hired Developers for frostley

179
00:06:14,880 --> 00:06:16,259
right and so this kind of became a

180
00:06:16,259 --> 00:06:17,400
little bit of a sitcom kind of thing

181
00:06:17,400 --> 00:06:18,720
where you're adding different pieces to

182
00:06:18,720 --> 00:06:21,000
this uh we wanted to emulate an ICS

183
00:06:21,000 --> 00:06:22,979
scenario they bought an organization

184
00:06:22,979 --> 00:06:24,419
called thirsty burner which was a

185
00:06:24,419 --> 00:06:26,400
brewery because we had a brewery with

186
00:06:26,400 --> 00:06:28,380
the ICS system right and we want to

187
00:06:28,380 --> 00:06:29,819
monitor those things so these are the

188
00:06:29,819 --> 00:06:31,500
kinds of things that we did to add to

189
00:06:31,500 --> 00:06:34,020
emulate the victim part of this right

190
00:06:34,020 --> 00:06:35,580
and then the other part of this is

191
00:06:35,580 --> 00:06:38,039
obviously is emulating the adversary

192
00:06:38,039 --> 00:06:40,319
okay now

193
00:06:40,319 --> 00:06:42,060
the adversary can be a different

194
00:06:42,060 --> 00:06:44,100
personas depending upon the scenario

195
00:06:44,100 --> 00:06:45,180
that you want to do if you want to

196
00:06:45,180 --> 00:06:47,400
emulate an Insider threat we've got to

197
00:06:47,400 --> 00:06:48,720
come up with that Insider threat for

198
00:06:48,720 --> 00:06:51,000
your organization if you want to look at

199
00:06:51,000 --> 00:06:53,100
nation state same kind of thing if you

200
00:06:53,100 --> 00:06:55,199
do cyber criminal that's fine there's

201
00:06:55,199 --> 00:06:56,460
different ways that we can go ahead and

202
00:06:56,460 --> 00:06:58,080
emulate our adversary we just need to

203
00:06:58,080 --> 00:06:59,400
start with that Persona figure out what

204
00:06:59,400 --> 00:07:02,160
that Persona is and go from there what

205
00:07:02,160 --> 00:07:03,780
I'm going to talk about is the

206
00:07:03,780 --> 00:07:05,520
nation-state piece which is the one that

207
00:07:05,520 --> 00:07:06,840
I've kind of been focusing on over the

208
00:07:06,840 --> 00:07:08,580
past couple of years

209
00:07:08,580 --> 00:07:10,919
now before we dive into the nation state

210
00:07:10,919 --> 00:07:12,060
piece anybody ever seen the diamond

211
00:07:12,060 --> 00:07:13,860
model just quick show of hands I kind of

212
00:07:13,860 --> 00:07:15,419
asked these kinds of questions for for

213
00:07:15,419 --> 00:07:17,759
feedback here all right so about half

214
00:07:17,759 --> 00:07:19,560
the people raised their hand

215
00:07:19,560 --> 00:07:21,960
the idea behind the diamond model is to

216
00:07:21,960 --> 00:07:23,280
be able to kind of show the inner

217
00:07:23,280 --> 00:07:25,259
relationships between an adversary their

218
00:07:25,259 --> 00:07:27,120
victim the infrastructure and the

219
00:07:27,120 --> 00:07:28,740
capabilities and so a couple of really

220
00:07:28,740 --> 00:07:30,360
really smart guys wrote this white paper

221
00:07:30,360 --> 00:07:31,860
a long time ago you can check out the

222
00:07:31,860 --> 00:07:33,840
links I'll post the slides and you can

223
00:07:33,840 --> 00:07:35,460
read all about the diamond model in

224
00:07:35,460 --> 00:07:37,139
concept

225
00:07:37,139 --> 00:07:38,940
you ever see Star Wars

226
00:07:38,940 --> 00:07:40,979
all right great about half the people

227
00:07:40,979 --> 00:07:43,620
same thing Okay good guys thanks

228
00:07:43,620 --> 00:07:44,539
um

229
00:07:44,539 --> 00:07:46,979
threat connected a Blog on the diamond

230
00:07:46,979 --> 00:07:48,599
model and applying the diamond model to

231
00:07:48,599 --> 00:07:50,460
Star Wars and specifically the Battle of

232
00:07:50,460 --> 00:07:52,319
Yavin a couple of years ago and it's a

233
00:07:52,319 --> 00:07:53,639
great way to contextualize the diamond

234
00:07:53,639 --> 00:07:56,160
model in a way that you know you could

235
00:07:56,160 --> 00:07:58,319
probably grab onto and the idea here

236
00:07:58,319 --> 00:08:00,539
without going into this whole Star Wars

237
00:08:00,539 --> 00:08:01,919
thing because I assume a few guys have

238
00:08:01,919 --> 00:08:03,720
seen it it sounds like uh is there's

239
00:08:03,720 --> 00:08:04,919
that relationship between the

240
00:08:04,919 --> 00:08:06,840
capabilities of the adversary the

241
00:08:06,840 --> 00:08:08,580
infrastructure and the victim the

242
00:08:08,580 --> 00:08:10,020
adversary and the victim Etc right

243
00:08:10,020 --> 00:08:11,880
because each of those vertices halves a

244
00:08:11,880 --> 00:08:14,520
relationship and then the East-West is

245
00:08:14,520 --> 00:08:16,259
the technical relationship the north

246
00:08:16,259 --> 00:08:19,620
south is the socio-political okay so I

247
00:08:19,620 --> 00:08:21,240
can go ahead and use something like this

248
00:08:21,240 --> 00:08:24,660
and I start building out my

249
00:08:24,660 --> 00:08:26,039
um

250
00:08:26,039 --> 00:08:29,099
I start building out my uh my my uh my

251
00:08:29,099 --> 00:08:30,960
scenario and so this first one that we

252
00:08:30,960 --> 00:08:33,539
did with the nation state was focusing

253
00:08:33,539 --> 00:08:35,399
on a couple of capabilities like

254
00:08:35,399 --> 00:08:37,020
Powershell Empire because it was about

255
00:08:37,020 --> 00:08:39,719
2017 Powershell Empire was something we

256
00:08:39,719 --> 00:08:41,520
were seeing a lot about there so we

257
00:08:41,520 --> 00:08:43,140
thought we'd go ahead and you know take

258
00:08:43,140 --> 00:08:46,440
a look build it uh um an adversary

259
00:08:46,440 --> 00:08:49,080
built on uh East Asian nation state that

260
00:08:49,080 --> 00:08:50,820
will remain nameless

261
00:08:50,820 --> 00:08:53,279
um but you can probably figure out who

262
00:08:53,279 --> 00:08:55,320
um we kind of grabbed a couple of those

263
00:08:55,320 --> 00:08:56,519
higher level Concepts around

264
00:08:56,519 --> 00:08:58,800
capabilities and we built a technical

265
00:08:58,800 --> 00:09:00,300
axis around this which were different

266
00:09:00,300 --> 00:09:02,160
modules that we wanted to exercise in

267
00:09:02,160 --> 00:09:03,779
Powershell Empire and doing a couple

268
00:09:03,779 --> 00:09:05,519
other things we wanted to be able to

269
00:09:05,519 --> 00:09:07,740
track adversary infrastructure as well

270
00:09:07,740 --> 00:09:09,959
with SSL certificates so we leveraged

271
00:09:09,959 --> 00:09:12,240
some technology to do that we focused on

272
00:09:12,240 --> 00:09:14,279
some fpp and some DNS exfiltrations to

273
00:09:14,279 --> 00:09:16,140
exercise that as well and so we went

274
00:09:16,140 --> 00:09:18,500
from there

275
00:09:18,540 --> 00:09:21,060
following your tadong which is the name

276
00:09:21,060 --> 00:09:25,200
of our adversary group came back and so

277
00:09:25,200 --> 00:09:27,240
when you're emulating an adversary we

278
00:09:27,240 --> 00:09:28,260
don't want to keep doing the same thing

279
00:09:28,260 --> 00:09:30,300
over and over again but at the same time

280
00:09:30,300 --> 00:09:32,640
much like a real life adversary we don't

281
00:09:32,640 --> 00:09:34,140
want to scrap all of our ttps and start

282
00:09:34,140 --> 00:09:36,060
over from scratch right so we got to

283
00:09:36,060 --> 00:09:38,100
kind of reach a balance point we kept

284
00:09:38,100 --> 00:09:39,720
Powershell in place

285
00:09:39,720 --> 00:09:41,100
but

286
00:09:41,100 --> 00:09:45,060
about 2018 time frame right uh struts

287
00:09:45,060 --> 00:09:47,040
vulnerability anybody ever have to deal

288
00:09:47,040 --> 00:09:49,260
with struts and vulnerabilities no good

289
00:09:49,260 --> 00:09:51,600
glad to hear it awesome

290
00:09:51,600 --> 00:09:53,399
um struts vulnerability was out there

291
00:09:53,399 --> 00:09:56,339
and you know people run Linux boxes in

292
00:09:56,339 --> 00:09:57,959
their environment I think it's not the

293
00:09:57,959 --> 00:09:59,220
year of the Linux desktop that's coming

294
00:09:59,220 --> 00:10:02,160
soon I think but you know uh Linux boxes

295
00:10:02,160 --> 00:10:03,420
are out there the first scenario we did

296
00:10:03,420 --> 00:10:05,459
was Windows focused we said well that'd

297
00:10:05,459 --> 00:10:06,720
be interesting what if we had windows

298
00:10:06,720 --> 00:10:08,519
and Linux in the environment and there

299
00:10:08,519 --> 00:10:10,140
was some sort of a pivot between the two

300
00:10:10,140 --> 00:10:11,940
and we would go after a struts

301
00:10:11,940 --> 00:10:14,839
vulnerability on win on a Linux box okay

302
00:10:14,839 --> 00:10:17,640
what happens if how are we going to

303
00:10:17,640 --> 00:10:19,140
monitor that Linux box do we have sysmon

304
00:10:19,140 --> 00:10:22,200
for Linux we do now did we have it in

305
00:10:22,200 --> 00:10:23,760
2018

306
00:10:23,760 --> 00:10:25,200
no

307
00:10:25,200 --> 00:10:27,360
so how about OS query we'll use OS query

308
00:10:27,360 --> 00:10:28,560
instead

309
00:10:28,560 --> 00:10:30,060
okay the benefit of some of these things

310
00:10:30,060 --> 00:10:31,620
is by running these simulations and

311
00:10:31,620 --> 00:10:33,060
emulations we're able to go ahead and

312
00:10:33,060 --> 00:10:34,800
also see what the logging Fidelity of

313
00:10:34,800 --> 00:10:36,060
these systems are which is again what

314
00:10:36,060 --> 00:10:37,440
we're focused on right we're focused on

315
00:10:37,440 --> 00:10:38,940
that detection part of it and we want to

316
00:10:38,940 --> 00:10:40,920
make sure that we can see that

317
00:10:40,920 --> 00:10:42,899
the other thing we started doing was we

318
00:10:42,899 --> 00:10:44,579
said well

319
00:10:44,579 --> 00:10:46,860
what if taydongong targets froth Lee's

320
00:10:46,860 --> 00:10:50,100
AWS instances and their M365 and their

321
00:10:50,100 --> 00:10:51,720
Azure because frothly is going to start

322
00:10:51,720 --> 00:10:53,339
moving to the cloud remember that talked

323
00:10:53,339 --> 00:10:56,399
about moving to those new terrains right

324
00:10:56,399 --> 00:10:58,740
2018 if you guys think back to that

325
00:10:58,740 --> 00:11:01,320
started seeing more people using AWS I

326
00:11:01,320 --> 00:11:02,519
mean it was around for a while we saw

327
00:11:02,519 --> 00:11:04,380
Microsoft cloud for a while but we see

328
00:11:04,380 --> 00:11:06,420
more and more more and more users moving

329
00:11:06,420 --> 00:11:08,459
their workloads to those places so again

330
00:11:08,459 --> 00:11:09,899
what we wanted to do is we wanted to

331
00:11:09,899 --> 00:11:11,399
start kind of picking at that and saying

332
00:11:11,399 --> 00:11:13,380
okay what kind of visibility do we get

333
00:11:13,380 --> 00:11:16,740
in those environments and what can we

334
00:11:16,740 --> 00:11:19,200
see what can we hunt what can we detect

335
00:11:19,200 --> 00:11:20,880
right and that kind of was the trend

336
00:11:20,880 --> 00:11:23,100
with this and so we built those kinds of

337
00:11:23,100 --> 00:11:25,079
things into it incidentally we had two

338
00:11:25,079 --> 00:11:26,459
different operations we had operations

339
00:11:26,459 --> 00:11:28,800
Stout and operation logger right one was

340
00:11:28,800 --> 00:11:30,899
for AWS one was for Microsoft 365

341
00:11:30,899 --> 00:11:31,920
because of course you have to have

342
00:11:31,920 --> 00:11:33,240
operation names whatever you're doing

343
00:11:33,240 --> 00:11:35,220
you know you know the nation state

344
00:11:35,220 --> 00:11:37,140
activity okay

345
00:11:37,140 --> 00:11:38,519
okay

346
00:11:38,519 --> 00:11:41,519
moving to 2019

347
00:11:41,519 --> 00:11:43,860
um we decided to ditch Tate on gong they

348
00:11:43,860 --> 00:11:45,360
had had a good run for us but we had

349
00:11:45,360 --> 00:11:47,220
done two years of Powershell Empire we

350
00:11:47,220 --> 00:11:48,839
wanted to mix this up and do some other

351
00:11:48,839 --> 00:11:50,339
new things

352
00:11:50,339 --> 00:11:52,440
so this is kind of when I took this over

353
00:11:52,440 --> 00:11:55,500
as a as my primary focus in terms of

354
00:11:55,500 --> 00:11:57,000
being the nation state so the

355
00:11:57,000 --> 00:12:00,000
nation-state I drew was uh what a

356
00:12:00,000 --> 00:12:01,860
combination of fancy bear and cozy bear

357
00:12:01,860 --> 00:12:04,560
and we called it the violent memes

358
00:12:04,560 --> 00:12:06,779
okay that was your first 80s sad time

359
00:12:06,779 --> 00:12:09,120
you reference music

360
00:12:09,120 --> 00:12:11,700
um so when you set up a nation state

361
00:12:11,700 --> 00:12:13,079
adversary probably one of the first

362
00:12:13,079 --> 00:12:14,339
things to do whether you're doing nation

363
00:12:14,339 --> 00:12:15,720
state or you're doing cyber criminal or

364
00:12:15,720 --> 00:12:17,279
you're doing Insider you probably want

365
00:12:17,279 --> 00:12:18,300
to do a little bit of your research

366
00:12:18,300 --> 00:12:19,740
figure out what you want to make this

367
00:12:19,740 --> 00:12:22,380
thing be so I started pulling thread

368
00:12:22,380 --> 00:12:23,579
Intel

369
00:12:23,579 --> 00:12:26,339
first thing I come across aside from the

370
00:12:26,339 --> 00:12:28,260
years of threat Intel reports prior to

371
00:12:28,260 --> 00:12:31,860
this but this 2018 uh as we're kind of

372
00:12:31,860 --> 00:12:33,779
starting to form this up

373
00:12:33,779 --> 00:12:36,180
come across this mandiant

374
00:12:36,180 --> 00:12:38,459
um report talking about weaponized link

375
00:12:38,459 --> 00:12:41,100
files it's like oh we haven't done link

376
00:12:41,100 --> 00:12:42,899
files before we did some spear fishing I

377
00:12:42,899 --> 00:12:44,100
haven't done link files though that'd be

378
00:12:44,100 --> 00:12:45,959
kind of interesting

379
00:12:45,959 --> 00:12:48,800
continue to do some reading Microsoft

380
00:12:48,800 --> 00:12:51,180
comes out with another report talking

381
00:12:51,180 --> 00:12:53,339
about targeting ngos they didn't say hey

382
00:12:53,339 --> 00:12:55,980
this is uh this is apt-29 but they said

383
00:12:55,980 --> 00:12:58,320
hey this this stuff's happening

384
00:12:58,320 --> 00:12:59,940
um and I come out of a public sector

385
00:12:59,940 --> 00:13:01,800
background so okay this is kind of

386
00:13:01,800 --> 00:13:03,060
interesting kind of targeted some of the

387
00:13:03,060 --> 00:13:04,860
customers I worked with and they were

388
00:13:04,860 --> 00:13:06,420
nice enough to put this diagram out

389
00:13:06,420 --> 00:13:09,000
there and it kind of captured the oh

390
00:13:09,000 --> 00:13:11,639
okay start connecting the dots going

391
00:13:11,639 --> 00:13:14,220
yeah okay the weaponize link file uh

392
00:13:14,220 --> 00:13:15,720
throws a decoy file out there

393
00:13:15,720 --> 00:13:18,839
establishes a stage one Cobalt strike

394
00:13:18,839 --> 00:13:20,940
good yeah this looks like something that

395
00:13:20,940 --> 00:13:22,380
we could we could emulate this looks

396
00:13:22,380 --> 00:13:23,940
like something we could do and so this

397
00:13:23,940 --> 00:13:25,740
was good you know kind of good ideas to

398
00:13:25,740 --> 00:13:27,720
be able to start with

399
00:13:27,720 --> 00:13:30,360
about that same time nobody's heard

400
00:13:30,360 --> 00:13:32,100
about her attack right nobody's heard of

401
00:13:32,100 --> 00:13:33,480
it nobody heard it in the past two days

402
00:13:33,480 --> 00:13:37,500
either I'm sure right 2019 miter attack

403
00:13:37,500 --> 00:13:39,120
is really kind of I don't say it's

404
00:13:39,120 --> 00:13:40,860
reaching that reaching that Crest but

405
00:13:40,860 --> 00:13:42,360
again miter Tech's been around for a few

406
00:13:42,360 --> 00:13:44,639
years but all of a sudden your hearing

407
00:13:44,639 --> 00:13:47,040
writer attack everywhere right

408
00:13:47,040 --> 00:13:49,200
um and so one of the other things we

409
00:13:49,200 --> 00:13:50,880
were trying to do with this was to be

410
00:13:50,880 --> 00:13:53,100
able to kind of say okay how can we

411
00:13:53,100 --> 00:13:55,139
how can we do these things and also

412
00:13:55,139 --> 00:13:57,000
again help the blue teams to be able to

413
00:13:57,000 --> 00:13:59,279
start talking about this the thing I

414
00:13:59,279 --> 00:14:00,899
like about miter attack is there is a

415
00:14:00,899 --> 00:14:03,779
symbiotic relationship okay symbiotic

416
00:14:03,779 --> 00:14:05,760
relationship between the threat Hunters

417
00:14:05,760 --> 00:14:07,500
the incident responders the security Ops

418
00:14:07,500 --> 00:14:09,899
folks the thread Intel people miter

419
00:14:09,899 --> 00:14:12,000
attack becomes that taxonomy that common

420
00:14:12,000 --> 00:14:14,040
language that everybody can kind of

421
00:14:14,040 --> 00:14:16,079
speak in right and when I say that

422
00:14:16,079 --> 00:14:17,820
symbiotic relationship okay it's the

423
00:14:17,820 --> 00:14:20,579
egret and the cattle okay great the idea

424
00:14:20,579 --> 00:14:22,680
is the cattle goes ahead and walks stirs

425
00:14:22,680 --> 00:14:24,240
up the worms the egrets eat those then

426
00:14:24,240 --> 00:14:25,680
the egrets take the little ticks and

427
00:14:25,680 --> 00:14:27,600
stuff that make the livestock uh sick

428
00:14:27,600 --> 00:14:29,339
right and picks it off right that's the

429
00:14:29,339 --> 00:14:31,079
symbiotic relationship

430
00:14:31,079 --> 00:14:32,820
I had somebody when I put this up for

431
00:14:32,820 --> 00:14:34,740
the first time say who's the Egret who's

432
00:14:34,740 --> 00:14:36,300
the bovine I'm not going to get into

433
00:14:36,300 --> 00:14:38,519
that you guys can decide who's who but

434
00:14:38,519 --> 00:14:39,779
at the end of the day there is a

435
00:14:39,779 --> 00:14:41,100
relationship between these different

436
00:14:41,100 --> 00:14:42,660
groups that they have to work with one

437
00:14:42,660 --> 00:14:44,519
another and be their success is driven

438
00:14:44,519 --> 00:14:45,959
by one another

439
00:14:45,959 --> 00:14:48,600
using attack as a common

440
00:14:48,600 --> 00:14:50,459
communication language can be very very

441
00:14:50,459 --> 00:14:53,100
helpful and so as we're building our

442
00:14:53,100 --> 00:14:55,260
emulation we wanted to also start

443
00:14:55,260 --> 00:14:57,600
sprinkling in those attack techniques

444
00:14:57,600 --> 00:15:00,600
and sub techniques now into this so we'd

445
00:15:00,600 --> 00:15:02,100
have that common framework to work off

446
00:15:02,100 --> 00:15:03,480
of as well

447
00:15:03,480 --> 00:15:05,279
so

448
00:15:05,279 --> 00:15:07,800
tack Navigator this is before the sub

449
00:15:07,800 --> 00:15:09,360
technique so it was a lot smaller at the

450
00:15:09,360 --> 00:15:10,040
time

451
00:15:10,040 --> 00:15:13,079
apt-29 or 28 29

452
00:15:13,079 --> 00:15:15,720
28. therefore

453
00:15:15,720 --> 00:15:17,399
there's my palette for the violent memes

454
00:15:17,399 --> 00:15:20,579
okay so this is my adversary technique

455
00:15:20,579 --> 00:15:22,500
palette that I'm going to work off of as

456
00:15:22,500 --> 00:15:24,959
a starting point okay this isn't I'm not

457
00:15:24,959 --> 00:15:25,920
going to use all of these things right

458
00:15:25,920 --> 00:15:27,180
but I'm going to see okay this is the

459
00:15:27,180 --> 00:15:28,380
kind of stuff I want to pick and choose

460
00:15:28,380 --> 00:15:31,800
from to be able to work with

461
00:15:31,800 --> 00:15:33,540
so I established a couple of high-level

462
00:15:33,540 --> 00:15:35,639
goals and I said okay if I can't get

463
00:15:35,639 --> 00:15:37,019
anything else done what are the couple

464
00:15:37,019 --> 00:15:38,339
things that I want to do well I want to

465
00:15:38,339 --> 00:15:41,100
use that weaponized link file okay I

466
00:15:41,100 --> 00:15:42,720
want to try some domain fronting okay

467
00:15:42,720 --> 00:15:44,940
now if you read the the uh the reports

468
00:15:44,940 --> 00:15:47,399
and and the miter attack stuff uh the

469
00:15:47,399 --> 00:15:48,959
domain fronting that they were doing was

470
00:15:48,959 --> 00:15:50,880
with like a Meek plug-in and doing it

471
00:15:50,880 --> 00:15:52,800
through Tor I was like wow that's pretty

472
00:15:52,800 --> 00:15:54,540
badass

473
00:15:54,540 --> 00:15:56,100
um I'm not sure if I really want to go

474
00:15:56,100 --> 00:15:57,480
to that level because here's the other

475
00:15:57,480 --> 00:15:58,860
thing again I want to help the blue team

476
00:15:58,860 --> 00:16:00,360
from a visibility perspective if it's

477
00:16:00,360 --> 00:16:02,940
all encoded in Tor and https

478
00:16:02,940 --> 00:16:04,740
what exactly are they going to get out

479
00:16:04,740 --> 00:16:06,480
of that maybe I can just do domain

480
00:16:06,480 --> 00:16:08,279
fronting with some HTTP and say you know

481
00:16:08,279 --> 00:16:10,019
the adversary got lazy

482
00:16:10,019 --> 00:16:11,940
what happens if you were able to go

483
00:16:11,940 --> 00:16:13,560
ahead and still see this going through

484
00:16:13,560 --> 00:16:15,180
and saying okay I've got this thing is

485
00:16:15,180 --> 00:16:16,920
there something in there that I can can

486
00:16:16,920 --> 00:16:18,480
I get into and figure it out the answer

487
00:16:18,480 --> 00:16:20,519
is yes by the way

488
00:16:20,519 --> 00:16:22,500
um but you know let's go ahead and try

489
00:16:22,500 --> 00:16:24,240
to challenge them with some of that I

490
00:16:24,240 --> 00:16:25,380
said let's do some accessibility

491
00:16:25,380 --> 00:16:26,699
features

492
00:16:26,699 --> 00:16:28,019
of course I'm gonna do a Golden Ticket

493
00:16:28,019 --> 00:16:30,060
attack that would be lovely and I want

494
00:16:30,060 --> 00:16:31,860
to go ahead and go after the ntds dip

495
00:16:31,860 --> 00:16:33,360
file everybody knows what the ntds did

496
00:16:33,360 --> 00:16:35,279
file is okay that's this game over for

497
00:16:35,279 --> 00:16:36,660
the ad right at that point I'm

498
00:16:36,660 --> 00:16:38,699
rebuilding so those were kind of my five

499
00:16:38,699 --> 00:16:41,100
high level pieces so I'm happy to go

500
00:16:41,100 --> 00:16:42,180
into it

501
00:16:42,180 --> 00:16:44,880
any sad tiny reference number two

502
00:16:44,880 --> 00:16:46,500
first thing I ran into is I could not

503
00:16:46,500 --> 00:16:48,180
get my hands on a copy of cobalt strike

504
00:16:48,180 --> 00:16:51,060
I wanted to buy a copy I couldn't buy a

505
00:16:51,060 --> 00:16:52,440
copy

506
00:16:52,440 --> 00:16:54,959
separate Conversation Over beers

507
00:16:54,959 --> 00:16:56,880
um Powershell Empire we had just spent

508
00:16:56,880 --> 00:16:58,199
two years doing

509
00:16:58,199 --> 00:17:00,540
so my adversary is not going to be using

510
00:17:00,540 --> 00:17:01,920
Powershell Empire again because I want

511
00:17:01,920 --> 00:17:04,559
to expose my end customers and analysts

512
00:17:04,559 --> 00:17:05,939
to new

513
00:17:05,939 --> 00:17:07,619
Terrain

514
00:17:07,619 --> 00:17:09,959
so we ended up settling on Metasploit

515
00:17:09,959 --> 00:17:12,359
okay now I wasn't using looking to run

516
00:17:12,359 --> 00:17:14,040
Metasploit as being like let's go run

517
00:17:14,040 --> 00:17:15,540
the modules and Metasploit and see what

518
00:17:15,540 --> 00:17:17,640
lights up right but it did serve a

519
00:17:17,640 --> 00:17:18,900
purpose to allow me to drop into

520
00:17:18,900 --> 00:17:20,579
interpreter and get to shells and those

521
00:17:20,579 --> 00:17:21,900
kinds of things so it was nice and handy

522
00:17:21,900 --> 00:17:23,339
from that perspective

523
00:17:23,339 --> 00:17:25,619
we had introduced the cloud in the past

524
00:17:25,619 --> 00:17:28,020
right last year we we kind of just said

525
00:17:28,020 --> 00:17:29,520
a little SharePoint here and a little

526
00:17:29,520 --> 00:17:32,040
bit of exchange here but we wanted to

527
00:17:32,040 --> 00:17:33,299
start building some active directory

528
00:17:33,299 --> 00:17:36,000
integration with Azure right so we uh

529
00:17:36,000 --> 00:17:38,100
well we set up Azure ad sync right

530
00:17:38,100 --> 00:17:39,960
adsync is not the thing that's you know

531
00:17:39,960 --> 00:17:42,299
preferred now it's ad connect but adsync

532
00:17:42,299 --> 00:17:43,620
was there at the time so we leveraged

533
00:17:43,620 --> 00:17:44,460
that

534
00:17:44,460 --> 00:17:45,900
we also kind of set the bar for

535
00:17:45,900 --> 00:17:47,220
ourselves to say that all workstations

536
00:17:47,220 --> 00:17:49,200
were going to workstation uh win 10

537
00:17:49,200 --> 00:17:51,600
minimum right not win no more win seven

538
00:17:51,600 --> 00:17:52,919
okay

539
00:17:52,919 --> 00:17:54,900
I'm not even asking people at win7 here

540
00:17:54,900 --> 00:17:56,520
I'm sure if somebody does that's okay

541
00:17:56,520 --> 00:17:58,620
again you know there's business needs

542
00:17:58,620 --> 00:17:59,940
for certain things

543
00:17:59,940 --> 00:18:02,160
if you want to emulate on a Windows 7

544
00:18:02,160 --> 00:18:04,620
because it's because it's low hanging

545
00:18:04,620 --> 00:18:05,760
fruit that's probably not the reason to

546
00:18:05,760 --> 00:18:07,200
do it but if you have them in your

547
00:18:07,200 --> 00:18:08,460
environment and you want to emulate

548
00:18:08,460 --> 00:18:09,900
those kinds of things use it as a

549
00:18:09,900 --> 00:18:11,700
teaching point for your analysts to say

550
00:18:11,700 --> 00:18:13,740
hey we're running this low-hanging fruit

551
00:18:13,740 --> 00:18:15,240
over here these are the things that are

552
00:18:15,240 --> 00:18:17,039
probably most likely to get popped how

553
00:18:17,039 --> 00:18:18,720
can we better monitor around them right

554
00:18:18,720 --> 00:18:20,100
so if you use them use them for a reason

555
00:18:20,100 --> 00:18:22,080
but you know in our case we were trying

556
00:18:22,080 --> 00:18:25,020
to drive a little bit higher level there

557
00:18:25,020 --> 00:18:27,480
so as we came up with the goals as we

558
00:18:27,480 --> 00:18:29,220
started forming this out built that

559
00:18:29,220 --> 00:18:30,840
diamond model to kind of say hey this is

560
00:18:30,840 --> 00:18:32,280
what we're kind of looking like the

561
00:18:32,280 --> 00:18:34,080
capabilities were my goals if you will

562
00:18:34,080 --> 00:18:35,700
right so that's kind of where we started

563
00:18:35,700 --> 00:18:38,160
from there doing the thread Intel

564
00:18:38,160 --> 00:18:39,900
research we said hey german-based

565
00:18:39,900 --> 00:18:41,400
digitalocean server sound like a good

566
00:18:41,400 --> 00:18:43,799
thing to do we'll use enom for our DNS

567
00:18:43,799 --> 00:18:45,240
so trying to get an emulate that

568
00:18:45,240 --> 00:18:48,299
adversary uh and off we go

569
00:18:48,299 --> 00:18:49,679
oh wait

570
00:18:49,679 --> 00:18:52,080
before we go let's draw a picture to

571
00:18:52,080 --> 00:18:54,120
kind of help visualize this a little bit

572
00:18:54,120 --> 00:18:55,380
more and this is by the way where that

573
00:18:55,380 --> 00:18:57,059
thirsty burner Brewery came in because

574
00:18:57,059 --> 00:18:58,740
we were going ahead and doing an ICS

575
00:18:58,740 --> 00:19:01,380
scenario as well and so the Brew the the

576
00:19:01,380 --> 00:19:03,780
Brewing Supply Company

577
00:19:03,780 --> 00:19:05,940
um bought the brewery to kind of help

578
00:19:05,940 --> 00:19:07,440
build this thing out a little bit more

579
00:19:07,440 --> 00:19:10,380
so we have the brewery right which is

580
00:19:10,380 --> 00:19:13,380
running a local A.D sinking to Azure

581
00:19:13,380 --> 00:19:15,679
where the rest of frothy's moved because

582
00:19:15,679 --> 00:19:18,600
we know that nobody I mean day one when

583
00:19:18,600 --> 00:19:20,039
you buy a new company all of their

584
00:19:20,039 --> 00:19:21,600
infrastructure is already in the new

585
00:19:21,600 --> 00:19:23,400
company's infrastructure right I mean

586
00:19:23,400 --> 00:19:24,960
there's no transition there's never like

587
00:19:24,960 --> 00:19:27,600
stuff here and stuff here and a six or

588
00:19:27,600 --> 00:19:29,039
nine month transition that never happens

589
00:19:29,039 --> 00:19:30,780
right

590
00:19:30,780 --> 00:19:32,220
okay I'm a little concerned that

591
00:19:32,220 --> 00:19:33,480
everybody goes yeah you're right that's

592
00:19:33,480 --> 00:19:36,299
exactly what happens right no no so

593
00:19:36,299 --> 00:19:38,039
again these are the kinds of little real

594
00:19:38,039 --> 00:19:40,620
world touches that we try to hit on

595
00:19:40,620 --> 00:19:42,780
um you can see you know and the reason I

596
00:19:42,780 --> 00:19:43,980
the other reason I like drawing pictures

597
00:19:43,980 --> 00:19:46,620
is because you know with previously with

598
00:19:46,620 --> 00:19:48,360
apts there's a lot of stuff happening

599
00:19:48,360 --> 00:19:49,679
there's a lot of things going on I feel

600
00:19:49,679 --> 00:19:51,480
like there's a lot of misdirection so if

601
00:19:51,480 --> 00:19:52,919
you can kind of draw this thing and help

602
00:19:52,919 --> 00:19:55,140
kind of visualize this it makes it

603
00:19:55,140 --> 00:19:56,820
easier as we're getting into the next

604
00:19:56,820 --> 00:19:58,440
steps which is writing our narratives

605
00:19:58,440 --> 00:20:00,480
now people don't necessarily like

606
00:20:00,480 --> 00:20:02,580
writing narratives okay so I'm not going

607
00:20:02,580 --> 00:20:03,780
to sit there and say you need to write a

608
00:20:03,780 --> 00:20:05,520
narrative if you want to just do bullet

609
00:20:05,520 --> 00:20:08,220
points right hey I'm trying to do this I

610
00:20:08,220 --> 00:20:09,360
want to do this I want to do this I want

611
00:20:09,360 --> 00:20:12,240
to have a checklist so to speak okay

612
00:20:12,240 --> 00:20:14,340
um not a bad way to go to be very Frank

613
00:20:14,340 --> 00:20:15,960
with you by the time I get to the Cloud

614
00:20:15,960 --> 00:20:17,400
part of the attack which you intend to

615
00:20:17,400 --> 00:20:18,900
be the very end of it it got to the

616
00:20:18,900 --> 00:20:19,980
bullet point thing I was just like let

617
00:20:19,980 --> 00:20:21,120
me just

618
00:20:21,120 --> 00:20:22,440
we're done

619
00:20:22,440 --> 00:20:24,539
that's it okay

620
00:20:24,539 --> 00:20:27,120
but going into it and writing a little

621
00:20:27,120 --> 00:20:29,220
bit more of a narrative explaining what

622
00:20:29,220 --> 00:20:31,320
we're planning on doing mapping it to

623
00:20:31,320 --> 00:20:34,020
specific techniques having the commands

624
00:20:34,020 --> 00:20:36,539
there as well right that gives me a way

625
00:20:36,539 --> 00:20:37,919
of being able to kind of put this all

626
00:20:37,919 --> 00:20:39,539
together and it's also very nice to have

627
00:20:39,539 --> 00:20:41,640
this because when I come back to this in

628
00:20:41,640 --> 00:20:43,740
two or three months to write questions

629
00:20:43,740 --> 00:20:46,980
for a CTF to educate users about

630
00:20:46,980 --> 00:20:49,320
specific pieces of this it's good to

631
00:20:49,320 --> 00:20:51,179
have this context rather than hey I ran

632
00:20:51,179 --> 00:20:52,620
this command

633
00:20:52,620 --> 00:20:55,200
why do I run this Command right the

634
00:20:55,200 --> 00:20:56,700
other thing we've done is again adding

635
00:20:56,700 --> 00:20:58,320
the techniques in there as well to help

636
00:20:58,320 --> 00:21:00,360
contextualize us now for people who know

637
00:21:00,360 --> 00:21:02,400
attack very well and inside out they

638
00:21:02,400 --> 00:21:03,419
were probably looking at this going

639
00:21:03,419 --> 00:21:06,360
commonly used Port is not a um technique

640
00:21:06,360 --> 00:21:07,919
anymore no it isn't but at the time it

641
00:21:07,919 --> 00:21:09,900
was okay so this is kind of the

642
00:21:09,900 --> 00:21:12,059
snapshots from there the other thing

643
00:21:12,059 --> 00:21:13,320
that I've learned and this goes into

644
00:21:13,320 --> 00:21:14,820
having the sub techniques there because

645
00:21:14,820 --> 00:21:16,380
this was the following Year's um

646
00:21:16,380 --> 00:21:18,960
narrative and then and then run book if

647
00:21:18,960 --> 00:21:20,160
you will

648
00:21:20,160 --> 00:21:22,080
um was to start putting time stamps in

649
00:21:22,080 --> 00:21:24,299
there and I found the time stamps being

650
00:21:24,299 --> 00:21:26,640
very very valuable and you'll see why

651
00:21:26,640 --> 00:21:27,900
this isn't a little bit when I start

652
00:21:27,900 --> 00:21:29,580
talking about some of the other tools

653
00:21:29,580 --> 00:21:31,919
that I started utilizing was to be able

654
00:21:31,919 --> 00:21:33,539
to go back and find the data that we

655
00:21:33,539 --> 00:21:35,640
were actually logging number one okay so

656
00:21:35,640 --> 00:21:37,140
you run a scenario that's over multiple

657
00:21:37,140 --> 00:21:38,940
hours you also happen to have background

658
00:21:38,940 --> 00:21:40,140
noise running because you have other

659
00:21:40,140 --> 00:21:41,340
workstations running at the same time

660
00:21:41,340 --> 00:21:42,659
you have other servers running at the

661
00:21:42,659 --> 00:21:43,919
same time right because you're trying to

662
00:21:43,919 --> 00:21:46,260
get this stuff lost in the noise so

663
00:21:46,260 --> 00:21:47,520
going back and actually finding the

664
00:21:47,520 --> 00:21:49,020
commands that you ran is incredibly

665
00:21:49,020 --> 00:21:50,880
important it's also incredibly important

666
00:21:50,880 --> 00:21:54,120
to understand what commands you ran but

667
00:21:54,120 --> 00:21:57,179
then your logging tools did not see

668
00:21:57,179 --> 00:21:59,640
to say hey here's a potential blind spot

669
00:21:59,640 --> 00:22:01,799
okay so the ones in yellow I happen to

670
00:22:01,799 --> 00:22:03,000
have both of these right one was a

671
00:22:03,000 --> 00:22:04,500
scheduled task and one was a registry

672
00:22:04,500 --> 00:22:06,840
entry and boom boom I had those but I

673
00:22:06,840 --> 00:22:08,940
can tell you for a fact

674
00:22:08,940 --> 00:22:11,340
um particularly this past year where I

675
00:22:11,340 --> 00:22:13,320
ran some Powershell stuff through uh

676
00:22:13,320 --> 00:22:15,000
through Covenant

677
00:22:15,000 --> 00:22:17,220
um and and through a Powershell uh grunt

678
00:22:17,220 --> 00:22:20,280
that um or Powershell tasks through the

679
00:22:20,280 --> 00:22:23,460
grunt it wasn't seen it was invisible

680
00:22:23,460 --> 00:22:24,900
that's right so I go back to go looking

681
00:22:24,900 --> 00:22:27,000
for it I can't find it

682
00:22:27,000 --> 00:22:28,620
um not necessarily a bad thing right

683
00:22:28,620 --> 00:22:30,000
because there's other things that happen

684
00:22:30,000 --> 00:22:32,400
Downstream that I can write to and ask

685
00:22:32,400 --> 00:22:34,260
questions about but when I was trying to

686
00:22:34,260 --> 00:22:35,700
ask questions about different comment

687
00:22:35,700 --> 00:22:37,260
tags and script block logging and then

688
00:22:37,260 --> 00:22:39,120
the script lock wasn't actually there

689
00:22:39,120 --> 00:22:41,580
that was a little disappointing okay but

690
00:22:41,580 --> 00:22:43,260
those are the reasons why as you're

691
00:22:43,260 --> 00:22:44,400
building out these narratives it's

692
00:22:44,400 --> 00:22:45,720
important to go ahead and time stamp

693
00:22:45,720 --> 00:22:46,980
this stuff and understand where these

694
00:22:46,980 --> 00:22:48,000
pieces are

695
00:22:48,000 --> 00:22:50,940
so I got done through that scenario we

696
00:22:50,940 --> 00:22:52,080
ran through it I'll talk about some of

697
00:22:52,080 --> 00:22:53,100
the lessons learned and some of the

698
00:22:53,100 --> 00:22:55,260
painful pieces here in a little bit

699
00:22:55,260 --> 00:22:57,659
but here's the miter attack uh that we

700
00:22:57,659 --> 00:22:58,740
ran

701
00:22:58,740 --> 00:23:00,900
so how do we do the yellow is the

702
00:23:00,900 --> 00:23:02,640
palette if you will

703
00:23:02,640 --> 00:23:05,520
okay the orange ones

704
00:23:05,520 --> 00:23:08,220
were the things that the Violet memes uh

705
00:23:08,220 --> 00:23:12,179
did okay apt-20 apt-29 in this scenario

706
00:23:12,179 --> 00:23:14,460
the red ones were things that were not

707
00:23:14,460 --> 00:23:17,039
identified in the miter attack as being

708
00:23:17,039 --> 00:23:18,960
things that they did but things we did

709
00:23:18,960 --> 00:23:20,880
anyway a lot of that was Discovery kinds

710
00:23:20,880 --> 00:23:23,400
of things and then at the time

711
00:23:23,400 --> 00:23:25,679
um the blue was the cloud right so miter

712
00:23:25,679 --> 00:23:27,480
attack had a separate Cloud Matrix I

713
00:23:27,480 --> 00:23:28,679
think at one point before they started

714
00:23:28,679 --> 00:23:29,760
kind of rolling all this stuff together

715
00:23:29,760 --> 00:23:31,559
and so the blue were some of the cloud

716
00:23:31,559 --> 00:23:34,140
activities that we did okay so if I look

717
00:23:34,140 --> 00:23:35,760
at this I'm kind of like yeah all right

718
00:23:35,760 --> 00:23:37,740
I did a pretty good job I got you know I

719
00:23:37,740 --> 00:23:38,700
covered a lot of different things

720
00:23:38,700 --> 00:23:40,679
covered a lot of different Tactics still

721
00:23:40,679 --> 00:23:42,480
a lot of yellow out there so hey next

722
00:23:42,480 --> 00:23:44,520
year there's some more opportunities of

723
00:23:44,520 --> 00:23:47,039
doing some different things

724
00:23:47,039 --> 00:23:49,140
what happened in 2020

725
00:23:49,140 --> 00:23:51,780
sure right nothing

726
00:23:51,780 --> 00:23:54,600
uh we all went to zoom

727
00:23:54,600 --> 00:23:57,480
so 2020

728
00:23:57,480 --> 00:23:58,980
um we start looking at this and start

729
00:23:58,980 --> 00:24:00,720
going okay what are we going to do

730
00:24:00,720 --> 00:24:02,820
what's our uh what's what's our scenario

731
00:24:02,820 --> 00:24:04,679
going to look like well number one I

732
00:24:04,679 --> 00:24:06,419
wanted to get off a meta there was no

733
00:24:06,419 --> 00:24:07,980
knock on my display but I wanted to try

734
00:24:07,980 --> 00:24:10,620
some other things before the pandemic I

735
00:24:10,620 --> 00:24:12,299
got to uh chat with a couple thread

736
00:24:12,299 --> 00:24:13,679
Intel analysts and some of the feedback

737
00:24:13,679 --> 00:24:16,380
I got around apg29 was hey there's a

738
00:24:16,380 --> 00:24:18,720
couple of specific uh c2s that we're

739
00:24:18,720 --> 00:24:21,840
seeing um seeing certain nation-state

740
00:24:21,840 --> 00:24:23,820
actors using

741
00:24:23,820 --> 00:24:25,860
um okay tell us more okay that's

742
00:24:25,860 --> 00:24:27,360
interesting

743
00:24:27,360 --> 00:24:29,640
um and oh by the way we're seeing more

744
00:24:29,640 --> 00:24:32,159
focus on the cloud and we're seeing more

745
00:24:32,159 --> 00:24:35,340
uh you know less customized tooling and

746
00:24:35,340 --> 00:24:37,200
more just using this stuff that's there

747
00:24:37,200 --> 00:24:40,440
oh that's interesting okay so living off

748
00:24:40,440 --> 00:24:42,539
the land right that seems like that's in

749
00:24:42,539 --> 00:24:45,059
play that's another high level goal

750
00:24:45,059 --> 00:24:46,919
um we're doing more and more Powershell

751
00:24:46,919 --> 00:24:48,179
but at the same time we're not being

752
00:24:48,179 --> 00:24:50,039
fair to the Defenders and giving them

753
00:24:50,039 --> 00:24:51,299
the ability even though there's things

754
00:24:51,299 --> 00:24:52,559
like script lock logging that's

755
00:24:52,559 --> 00:24:54,299
available so guess what we did for

756
00:24:54,299 --> 00:24:57,000
frothly frothly got script lock logging

757
00:24:57,000 --> 00:24:58,919
okay so again we're trying to raise the

758
00:24:58,919 --> 00:25:00,240
Defenders a little bit here by giving

759
00:25:00,240 --> 00:25:03,020
them additional capabilities too

760
00:25:03,020 --> 00:25:05,760
we moved to active directory connect

761
00:25:05,760 --> 00:25:11,360
okay and we built a bit of a more robust

762
00:25:11,360 --> 00:25:15,120
Azure ad integration as well and then my

763
00:25:15,120 --> 00:25:17,580
background initially was SQL DBA that

764
00:25:17,580 --> 00:25:19,020
was the first job I had coming out of

765
00:25:19,020 --> 00:25:21,780
school uh and so you know Azure was

766
00:25:21,780 --> 00:25:24,840
moving SQL to the cloud or had moved SQL

767
00:25:24,840 --> 00:25:25,919
to the cloud and I thought that would be

768
00:25:25,919 --> 00:25:27,360
kind of something interesting so I built

769
00:25:27,360 --> 00:25:30,059
a frothly customer database uh in the

770
00:25:30,059 --> 00:25:32,279
cloud and part of the overall attack

771
00:25:32,279 --> 00:25:34,440
scheme was pivoting to the cloud and

772
00:25:34,440 --> 00:25:36,480
then going after that what would that

773
00:25:36,480 --> 00:25:38,520
look like if somebody had Azure auditing

774
00:25:38,520 --> 00:25:40,260
turned on and okay how does that look

775
00:25:40,260 --> 00:25:41,940
like when it's going to an event Hub and

776
00:25:41,940 --> 00:25:44,100
then coming down into into our case into

777
00:25:44,100 --> 00:25:45,900
Splunk but into whatever tool you're

778
00:25:45,900 --> 00:25:48,360
using and when they start bcping data

779
00:25:48,360 --> 00:25:50,220
out of that what kind of visibility do I

780
00:25:50,220 --> 00:25:52,799
have because if I'm not bcping to a box

781
00:25:52,799 --> 00:25:54,360
inside of my compromised environment am

782
00:25:54,360 --> 00:25:55,799
I even seeing something going out of the

783
00:25:55,799 --> 00:25:57,900
cloud to some other third place

784
00:25:57,900 --> 00:25:59,580
those kinds of things are the kinds of

785
00:25:59,580 --> 00:26:01,860
questions we're trying to answer

786
00:26:01,860 --> 00:26:04,380
so we go through we do this

787
00:26:04,380 --> 00:26:06,299
uh oh and by the way the other part of

788
00:26:06,299 --> 00:26:08,940
this was the scenario again changed

789
00:26:08,940 --> 00:26:11,820
because who's in the office

790
00:26:11,820 --> 00:26:14,100
no word no one right well you know what

791
00:26:14,100 --> 00:26:15,360
you got one or two guys coming in the

792
00:26:15,360 --> 00:26:17,340
office right you got on-prem stuff that

793
00:26:17,340 --> 00:26:18,900
you have to deal with right but they

794
00:26:18,900 --> 00:26:20,100
come into the office here and there

795
00:26:20,100 --> 00:26:22,080
there's not much of a lateral movement

796
00:26:22,080 --> 00:26:23,460
kind of story here going from

797
00:26:23,460 --> 00:26:24,900
workstation to workstation because those

798
00:26:24,900 --> 00:26:27,000
workstations aren't on the same network

799
00:26:27,000 --> 00:26:29,880
right but so we we augmented that story

800
00:26:29,880 --> 00:26:31,320
we kind of crafted it and went from

801
00:26:31,320 --> 00:26:32,340
there

802
00:26:32,340 --> 00:26:35,640
fast forward to last year what happened

803
00:26:35,640 --> 00:26:38,460
what was in the news

804
00:26:38,460 --> 00:26:42,380
give you a hint it's on the screen there

805
00:26:42,840 --> 00:26:45,000
um yeah so um

806
00:26:45,000 --> 00:26:48,600
yeah that thing so software supply chain

807
00:26:48,600 --> 00:26:50,000
seemed all of a sudden be in the news

808
00:26:50,000 --> 00:26:52,799
and so it seemed like that was an

809
00:26:52,799 --> 00:26:55,100
interesting place to go ahead and focus

810
00:26:55,100 --> 00:26:57,240
and to

811
00:26:57,240 --> 00:27:00,659
um to go after and so

812
00:27:00,659 --> 00:27:02,520
um

813
00:27:02,520 --> 00:27:04,440
frothley decided to have an active

814
00:27:04,440 --> 00:27:07,020
director of federation right we did ad

815
00:27:07,020 --> 00:27:09,779
connect before the Lex logical thing has

816
00:27:09,779 --> 00:27:11,220
developed their game and say you know

817
00:27:11,220 --> 00:27:12,419
what we're going to continue with that

818
00:27:12,419 --> 00:27:13,980
local on-prem because there's some stuff

819
00:27:13,980 --> 00:27:15,960
we just can't move to the cloud we still

820
00:27:15,960 --> 00:27:18,419
have stuff on-prem right again never

821
00:27:18,419 --> 00:27:20,220
happens does it but we're going to go

822
00:27:20,220 --> 00:27:22,500
ahead and have that adfs and have that

823
00:27:22,500 --> 00:27:25,100
synchronization happening from there

824
00:27:25,100 --> 00:27:27,539
unfortunately obviously you know that

825
00:27:27,539 --> 00:27:29,220
can get pop what happens if that gets

826
00:27:29,220 --> 00:27:31,260
popped well all of a sudden I have that

827
00:27:31,260 --> 00:27:33,240
golden saml kind of attack available

828
00:27:33,240 --> 00:27:35,940
what can I get to within my Azure

829
00:27:35,940 --> 00:27:38,940
environment with golden saml let's see

830
00:27:38,940 --> 00:27:41,400
okay and so a scenario played out going

831
00:27:41,400 --> 00:27:42,900
through those things we kept Covenant

832
00:27:42,900 --> 00:27:44,820
all the way through by the way

833
00:27:44,820 --> 00:27:46,799
um still kept doing some Powershell but

834
00:27:46,799 --> 00:27:48,299
also started building some more stuff

835
00:27:48,299 --> 00:27:50,100
into C sharp did anybody see the

836
00:27:50,100 --> 00:27:51,480
invisibility cloak presentation

837
00:27:51,480 --> 00:27:54,179
yesterday okay I wish I had that about

838
00:27:54,179 --> 00:27:55,799
nine months ago because that would have

839
00:27:55,799 --> 00:27:57,179
made my life a hell of a lot easier

840
00:27:57,179 --> 00:27:59,039
because I was busy recompiling and

841
00:27:59,039 --> 00:28:02,340
building uh some c-sharp apps to be able

842
00:28:02,340 --> 00:28:04,080
to go through different kinds of things

843
00:28:04,080 --> 00:28:06,059
and make them less obvious that would

844
00:28:06,059 --> 00:28:07,980
have made it a heck of a lot easier but

845
00:28:07,980 --> 00:28:09,779
you know it is what it is

846
00:28:09,779 --> 00:28:11,039
um real quick

847
00:28:11,039 --> 00:28:12,960
um a lot of the work that I did with the

848
00:28:12,960 --> 00:28:15,779
graph API stuff and the attack on that

849
00:28:15,779 --> 00:28:18,539
um Roberto Rodriguez from Microsoft had

850
00:28:18,539 --> 00:28:20,340
done some nice stuff around simuland if

851
00:28:20,340 --> 00:28:21,779
anybody hasn't seen that check that out

852
00:28:21,779 --> 00:28:24,000
a lot of good information there to be

853
00:28:24,000 --> 00:28:25,200
able to go ahead and test that if that's

854
00:28:25,200 --> 00:28:26,520
something you decide that you want to

855
00:28:26,520 --> 00:28:28,620
Noodle around with

856
00:28:28,620 --> 00:28:29,760
so

857
00:28:29,760 --> 00:28:31,919
from a tool perspective touched on a

858
00:28:31,919 --> 00:28:33,179
number of these different kinds of tools

859
00:28:33,179 --> 00:28:34,559
obviously there's a couple of things

860
00:28:34,559 --> 00:28:37,020
that are c2s a couple credential dumping

861
00:28:37,020 --> 00:28:39,120
tools a lot of like standard Windows

862
00:28:39,120 --> 00:28:40,380
things that you'd expect to see in your

863
00:28:40,380 --> 00:28:41,640
environment

864
00:28:41,640 --> 00:28:43,080
um so we did we did touch on these

865
00:28:43,080 --> 00:28:44,159
things there's a couple of other things

866
00:28:44,159 --> 00:28:45,659
that I've got out there that we did as

867
00:28:45,659 --> 00:28:48,539
well but again not focused on the custom

868
00:28:48,539 --> 00:28:50,820
malware pieces of this right not focused

869
00:28:50,820 --> 00:28:53,580
on some sort of exotic tool sets right

870
00:28:53,580 --> 00:28:56,580
focusing on kind of the base

871
00:28:56,580 --> 00:28:58,980
kinds of things that that everybody has

872
00:28:58,980 --> 00:29:00,360
access to

873
00:29:00,360 --> 00:29:01,860
um to be able to do this or you know if

874
00:29:01,860 --> 00:29:03,120
I'm trying to do this myself I don't

875
00:29:03,120 --> 00:29:04,380
have to necessarily come up with those

876
00:29:04,380 --> 00:29:07,440
with with some of those you know more uh

877
00:29:07,440 --> 00:29:10,200
more exotic things if you will

878
00:29:10,200 --> 00:29:13,799
all right so uh sometimes

879
00:29:13,799 --> 00:29:17,279
the uh the presentation Fairy comes and

880
00:29:17,279 --> 00:29:20,340
bestows good grace upon you and so last

881
00:29:20,340 --> 00:29:22,679
week as I'm sitting down you know kind

882
00:29:22,679 --> 00:29:23,940
of collecting my thoughts and trying to

883
00:29:23,940 --> 00:29:26,760
finalize my deck mandiant drops this

884
00:29:26,760 --> 00:29:29,779
report tying UNC

885
00:29:29,779 --> 00:29:33,480
2452 to apt-29 right so before they had

886
00:29:33,480 --> 00:29:36,059
kind of said yeah but we're not ready to

887
00:29:36,059 --> 00:29:37,559
say this is this and put them together

888
00:29:37,559 --> 00:29:39,419
last week they dropped their report and

889
00:29:39,419 --> 00:29:40,980
said yeah

890
00:29:40,980 --> 00:29:43,740
this is the same thing okay so I started

891
00:29:43,740 --> 00:29:45,299
reading through the report and this was

892
00:29:45,299 --> 00:29:47,700
kind of a full kind of you know let's

893
00:29:47,700 --> 00:29:49,200
look at this again let's look at their

894
00:29:49,200 --> 00:29:50,760
opsec let's look at their history we're

895
00:29:50,760 --> 00:29:52,140
folding these libraries of techniques

896
00:29:52,140 --> 00:29:54,000
together and so like I was able to kind

897
00:29:54,000 --> 00:29:55,919
of look at this and go well how do we do

898
00:29:55,919 --> 00:29:58,140
right and so I took a look at this and

899
00:29:58,140 --> 00:29:59,520
they kind of called out these high level

900
00:29:59,520 --> 00:30:02,220
Concepts here and the bullets that are

901
00:30:02,220 --> 00:30:04,320
there basically are tied to the observed

902
00:30:04,320 --> 00:30:07,980
tradecraft okay so varying intrusion

903
00:30:07,980 --> 00:30:10,500
vectors they're saying apt-29 uses a lot

904
00:30:10,500 --> 00:30:11,820
of varying intrusion vectors on the

905
00:30:11,820 --> 00:30:12,779
right hand side they put their nice

906
00:30:12,779 --> 00:30:14,039
little picture so I started looking into

907
00:30:14,039 --> 00:30:15,899
that and looking at our our run books

908
00:30:15,899 --> 00:30:18,059
that we had we said how do we do well

909
00:30:18,059 --> 00:30:19,740
we um

910
00:30:19,740 --> 00:30:21,899
the first one there I can't even see it

911
00:30:21,899 --> 00:30:26,039
on the screen first one there is

912
00:30:26,039 --> 00:30:27,360
getting to the edge of my screen here

913
00:30:27,360 --> 00:30:29,460
stolen credentials yep we stole

914
00:30:29,460 --> 00:30:32,039
credentials right we did that uh the

915
00:30:32,039 --> 00:30:34,320
next one was uh fishing we did the

916
00:30:34,320 --> 00:30:35,940
fishing but we've kind of stopped doing

917
00:30:35,940 --> 00:30:37,620
the fishing because fishing fishing

918
00:30:37,620 --> 00:30:38,580
fishing

919
00:30:38,580 --> 00:30:41,460
right yes that's gonna happen password

920
00:30:41,460 --> 00:30:45,120
spray did that uh supply chain yep did

921
00:30:45,120 --> 00:30:46,799
that so we've kind of covered a nice

922
00:30:46,799 --> 00:30:49,200
range of their uh different initial

923
00:30:49,200 --> 00:30:50,820
attack vectors

924
00:30:50,820 --> 00:30:52,380
the heightened opsec there's a whole

925
00:30:52,380 --> 00:30:54,779
table of heightened opsec out there

926
00:30:54,779 --> 00:30:56,159
um well one of them in there is

927
00:30:56,159 --> 00:30:58,500
disabling logging clearly again from a

928
00:30:58,500 --> 00:31:00,059
detection perspective we're not trying

929
00:31:00,059 --> 00:31:01,320
to get into that because if we did we

930
00:31:01,320 --> 00:31:02,580
didn't have a CTF and we wouldn't have

931
00:31:02,580 --> 00:31:04,260
anything to workshop on right if there's

932
00:31:04,260 --> 00:31:05,460
no logs we wouldn't be able to really

933
00:31:05,460 --> 00:31:07,080
kind of talk about it right we want to

934
00:31:07,080 --> 00:31:08,159
call out that you know if there's

935
00:31:08,159 --> 00:31:09,600
defensive evasion and clearing of

936
00:31:09,600 --> 00:31:11,520
clearing of the audit log and those

937
00:31:11,520 --> 00:31:13,200
kinds of things there's techniques to do

938
00:31:13,200 --> 00:31:14,760
that maybe I could go ahead and turn it

939
00:31:14,760 --> 00:31:17,220
off during the emulation and say hey

940
00:31:17,220 --> 00:31:18,960
there was a window of time that the

941
00:31:18,960 --> 00:31:20,520
logging got turned off but obviously if

942
00:31:20,520 --> 00:31:21,840
I just turn off logging it's kind of

943
00:31:21,840 --> 00:31:23,340
self-defeating for the purpose that

944
00:31:23,340 --> 00:31:25,260
we're trying to up level the analyst for

945
00:31:25,260 --> 00:31:26,700
right so understanding that they should

946
00:31:26,700 --> 00:31:28,380
be they should be looking for it and if

947
00:31:28,380 --> 00:31:29,820
they see gaps in logging that might be a

948
00:31:29,820 --> 00:31:31,140
concern but I'm not just going to flip

949
00:31:31,140 --> 00:31:32,220
that off

950
00:31:32,220 --> 00:31:35,100
uh sophistication on-prem to Cloud yeah

951
00:31:35,100 --> 00:31:38,640
we did that that's good uh bypass MFA

952
00:31:38,640 --> 00:31:42,120
that graph API attack with golden saml

953
00:31:42,120 --> 00:31:45,419
will go blazing right through MFA it

954
00:31:45,419 --> 00:31:48,360
won't care flat out you're in you've got

955
00:31:48,360 --> 00:31:51,299
that ticket you are doing stuff down at

956
00:31:51,299 --> 00:31:54,360
the um I was using Azure it was using uh

957
00:31:54,360 --> 00:31:56,940
80 80 internals Azure 80 or 80 internals

958
00:31:56,940 --> 00:31:58,740
as a scripting it's Powershell scripts

959
00:31:58,740 --> 00:32:00,480
you're literally just sending curl

960
00:32:00,480 --> 00:32:02,760
commands and sending API calls right

961
00:32:02,760 --> 00:32:04,919
underneath it and that's that token that

962
00:32:04,919 --> 00:32:06,539
you have is blessed and good and through

963
00:32:06,539 --> 00:32:09,120
and it's not going to hit MFA MFA is

964
00:32:09,120 --> 00:32:10,679
going to go right you know well I don't

965
00:32:10,679 --> 00:32:12,120
care you're good you got the you got the

966
00:32:12,120 --> 00:32:13,679
token

967
00:32:13,679 --> 00:32:14,340
um

968
00:32:14,340 --> 00:32:15,840
it called out maintaining a light

969
00:32:15,840 --> 00:32:16,740
footprint

970
00:32:16,740 --> 00:32:19,020
can I come back to you okay let me come

971
00:32:19,020 --> 00:32:19,980
I'll come back to you at the end of the

972
00:32:19,980 --> 00:32:21,360
slide and say

973
00:32:21,360 --> 00:32:22,740
um

974
00:32:22,740 --> 00:32:27,260
this kind of uh this kind of uh

975
00:32:27,299 --> 00:32:29,039
this kind of validated the feedback that

976
00:32:29,039 --> 00:32:30,600
we got from the thread Intel analysts in

977
00:32:30,600 --> 00:32:32,520
the early a year and a half before that

978
00:32:32,520 --> 00:32:35,100
talking about leveraging stolen creds

979
00:32:35,100 --> 00:32:37,320
abusing native Microsoft features right

980
00:32:37,320 --> 00:32:39,720
those kinds of things Speed and Agility

981
00:32:39,720 --> 00:32:41,220
we're not doing that right we're running

982
00:32:41,220 --> 00:32:43,200
a competition on a yearly basis we're

983
00:32:43,200 --> 00:32:44,940
building content to help educate

984
00:32:44,940 --> 00:32:47,279
analysts so I'm not trying to do this

985
00:32:47,279 --> 00:32:48,899
really really super agile right I'm not

986
00:32:48,899 --> 00:32:50,760
going to go out and whip up another one

987
00:32:50,760 --> 00:32:52,799
to go ahead and and build another attack

988
00:32:52,799 --> 00:32:54,480
so that doesn't really apply to us and

989
00:32:54,480 --> 00:32:55,919
then following the data we don't do a

990
00:32:55,919 --> 00:32:57,360
lot of stuff with mail quite honestly

991
00:32:57,360 --> 00:33:00,179
one time we try to do mail uh

992
00:33:00,179 --> 00:33:02,100
we had frothly send a bunch of mail to

993
00:33:02,100 --> 00:33:03,600
one another which was great but you know

994
00:33:03,600 --> 00:33:04,799
that at that point how many people are

995
00:33:04,799 --> 00:33:05,820
going to send you know we're not going

996
00:33:05,820 --> 00:33:07,440
to send a lot of mail so what we did was

997
00:33:07,440 --> 00:33:09,779
we signed up a bunch of people to

998
00:33:09,779 --> 00:33:12,659
um mail aliases right or spam you know

999
00:33:12,659 --> 00:33:13,860
so everybody's getting spammed with

1000
00:33:13,860 --> 00:33:15,360
stuff just to create more noise in our

1001
00:33:15,360 --> 00:33:18,720
in our um in our inboxes

1002
00:33:18,720 --> 00:33:20,640
then we started realizing that our legal

1003
00:33:20,640 --> 00:33:21,720
team was going to have issues around

1004
00:33:21,720 --> 00:33:24,299
gdpr because of privacy issues if we

1005
00:33:24,299 --> 00:33:25,980
actually published our data set and made

1006
00:33:25,980 --> 00:33:27,419
them available that way so we kind of

1007
00:33:27,419 --> 00:33:28,860
got out of the whole mail business so

1008
00:33:28,860 --> 00:33:30,059
something to think about if you decide

1009
00:33:30,059 --> 00:33:31,140
you want to do your own kind of thing

1010
00:33:31,140 --> 00:33:33,000
with how you deal with male and privacy

1011
00:33:33,000 --> 00:33:34,019
issues

1012
00:33:34,019 --> 00:33:36,000
anyhow long and short of it is we did a

1013
00:33:36,000 --> 00:33:37,740
lot of focus on persistence which is

1014
00:33:37,740 --> 00:33:39,539
obviously something apt-29 was focused

1015
00:33:39,539 --> 00:33:41,700
on so I'd say we did okay with the

1016
00:33:41,700 --> 00:33:43,080
following the data to establish that

1017
00:33:43,080 --> 00:33:47,360
persistence as part of that yes sorry

1018
00:33:53,279 --> 00:33:56,340
yeah so

1019
00:33:56,340 --> 00:33:59,340
what time are we at now yeah we're good

1020
00:33:59,340 --> 00:34:02,580
um yeah so the challenge

1021
00:34:02,580 --> 00:34:06,000
the challenge that you have and I was

1022
00:34:06,000 --> 00:34:07,980
sitting in a session

1023
00:34:07,980 --> 00:34:09,480
I think it was Andy's session this

1024
00:34:09,480 --> 00:34:10,619
morning we were talking about some of

1025
00:34:10,619 --> 00:34:13,980
that as well the problem is is the there

1026
00:34:13,980 --> 00:34:16,199
are specific events that you will see

1027
00:34:16,199 --> 00:34:19,918
the creation of the secret the global

1028
00:34:19,918 --> 00:34:22,440
um you know the the the the user getting

1029
00:34:22,440 --> 00:34:24,899
promoted to a higher level Authority the

1030
00:34:24,899 --> 00:34:26,339
service principal getting these

1031
00:34:26,339 --> 00:34:28,080
additional rights

1032
00:34:28,080 --> 00:34:29,820
everything else I'm gonna say everything

1033
00:34:29,820 --> 00:34:31,918
else but all that other stuff that's

1034
00:34:31,918 --> 00:34:34,320
happening you're blind too you're flat

1035
00:34:34,320 --> 00:34:36,179
out blind too and

1036
00:34:36,179 --> 00:34:37,980
I was kind of surprised about that

1037
00:34:37,980 --> 00:34:39,899
because when I got when I when I went

1038
00:34:39,899 --> 00:34:41,399
through this time this last scenario I

1039
00:34:41,399 --> 00:34:42,540
went to pull it and started looking

1040
00:34:42,540 --> 00:34:44,699
through my data I'm going I'm seeing

1041
00:34:44,699 --> 00:34:46,080
these mile markers

1042
00:34:46,080 --> 00:34:48,300
along the way but I'm not seeing the 15

1043
00:34:48,300 --> 00:34:50,339
things underneath the surface that I'm

1044
00:34:50,339 --> 00:34:52,399
doing to get to those next mile markers

1045
00:34:52,399 --> 00:34:55,320
and I was actually at a Sans forensics

1046
00:34:55,320 --> 00:34:57,960
class in December and was talking to the

1047
00:34:57,960 --> 00:34:59,880
instructor there and the comment was

1048
00:34:59,880 --> 00:35:01,500
made there as well was basically

1049
00:35:01,500 --> 00:35:04,800
Microsoft doesn't log at that graph API

1050
00:35:04,800 --> 00:35:06,300
level or if they log they don't make it

1051
00:35:06,300 --> 00:35:07,260
available but if you think about

1052
00:35:07,260 --> 00:35:08,940
everything that's happening outside of

1053
00:35:08,940 --> 00:35:10,920
azure it's all graph API

1054
00:35:10,920 --> 00:35:13,640
everywhere

1055
00:35:16,680 --> 00:35:19,680
okay

1056
00:35:29,579 --> 00:35:32,280
it is it's a tremendous blind spot thank

1057
00:35:32,280 --> 00:35:33,839
you no that's good to hear

1058
00:35:33,839 --> 00:35:35,520
um but yeah that's that's that's the

1059
00:35:35,520 --> 00:35:36,960
problem if I could see the secrets being

1060
00:35:36,960 --> 00:35:39,000
created I can hate the global I can say

1061
00:35:39,000 --> 00:35:41,640
Service uh service principle gets the

1062
00:35:41,640 --> 00:35:44,520
you know the the read write role right I

1063
00:35:44,520 --> 00:35:46,619
can get those things

1064
00:35:46,619 --> 00:35:48,900
um but yeah there's then there's like I

1065
00:35:48,900 --> 00:35:49,980
said all that other stuff that's

1066
00:35:49,980 --> 00:35:52,320
happening all the you know um even just

1067
00:35:52,320 --> 00:35:53,940
creating the ticket itself right if I've

1068
00:35:53,940 --> 00:35:56,460
got if I've got something from the adfs

1069
00:35:56,460 --> 00:35:59,160
initially like the crafting of the

1070
00:35:59,160 --> 00:36:01,800
ticket not don't even see that and then

1071
00:36:01,800 --> 00:36:04,380
all of a sudden it's happening so yeah

1072
00:36:04,380 --> 00:36:06,960
it's it's it's literally focused on

1073
00:36:06,960 --> 00:36:08,339
those key milestones in the meantime

1074
00:36:08,339 --> 00:36:10,440
until they've got something more verbose

1075
00:36:10,440 --> 00:36:13,200
there yep

1076
00:36:13,200 --> 00:36:15,900
this is an eye chart

1077
00:36:15,900 --> 00:36:18,000
we could all agree to that I think okay

1078
00:36:18,000 --> 00:36:20,220
if anybody can see that that's great I

1079
00:36:20,220 --> 00:36:21,420
can't even see it and it's like right

1080
00:36:21,420 --> 00:36:23,339
here in front of me um so this again is

1081
00:36:23,339 --> 00:36:24,720
my kind of kind of that Milestone

1082
00:36:24,720 --> 00:36:26,220
evaluation going okay how are we doing

1083
00:36:26,220 --> 00:36:28,380
with the Violet Meats

1084
00:36:28,380 --> 00:36:30,180
um this is the latest miter attack

1085
00:36:30,180 --> 00:36:32,460
technique this is the v11 stuff that

1086
00:36:32,460 --> 00:36:33,780
just came out

1087
00:36:33,780 --> 00:36:36,599
um the stuff in white is is just I don't

1088
00:36:36,599 --> 00:36:37,680
I don't know how to get the stuff in

1089
00:36:37,680 --> 00:36:39,599
white which is the non-violent meme

1090
00:36:39,599 --> 00:36:41,700
stuff out of there okay the lightest

1091
00:36:41,700 --> 00:36:44,579
blue stuff is basically my palette if

1092
00:36:44,579 --> 00:36:46,440
you will and then the darker shades are

1093
00:36:46,440 --> 00:36:47,940
the frequency that we're using those

1094
00:36:47,940 --> 00:36:49,980
things okay so there's still stuff we

1095
00:36:49,980 --> 00:36:51,660
haven't really touched on wasn't able to

1096
00:36:51,660 --> 00:36:53,280
touch on but we're hitting a lot of the

1097
00:36:53,280 --> 00:36:54,599
key points all the way through this and

1098
00:36:54,599 --> 00:36:55,800
it was kind of a good way to be able to

1099
00:36:55,800 --> 00:36:57,060
look at this over the past three years

1100
00:36:57,060 --> 00:36:58,920
and kind of go okay are we hitting these

1101
00:36:58,920 --> 00:37:00,900
different pieces are we getting coverage

1102
00:37:00,900 --> 00:37:03,540
are we helping to educate our analysts

1103
00:37:03,540 --> 00:37:05,700
on these different techniques because at

1104
00:37:05,700 --> 00:37:07,619
the end of the day again my goal isn't

1105
00:37:07,619 --> 00:37:08,760
just to get to the end of this and go

1106
00:37:08,760 --> 00:37:11,280
woohoo I cracked it right my goal is to

1107
00:37:11,280 --> 00:37:13,200
be able to go ahead and generate data

1108
00:37:13,200 --> 00:37:15,420
sets that I can show analysts that I can

1109
00:37:15,420 --> 00:37:18,420
test them I can validate and say yes are

1110
00:37:18,420 --> 00:37:20,640
you seeing this run dll 32 over here

1111
00:37:20,640 --> 00:37:22,200
this thing happening right that's a

1112
00:37:22,200 --> 00:37:23,760
technique that that this adversary is

1113
00:37:23,760 --> 00:37:25,920
using can you see this data exfiltration

1114
00:37:25,920 --> 00:37:28,260
via cloud service that's a technique

1115
00:37:28,260 --> 00:37:30,420
this adversary is using and so on and so

1116
00:37:30,420 --> 00:37:31,740
forth and that's what we're trying to do

1117
00:37:31,740 --> 00:37:35,160
so let's

1118
00:37:35,160 --> 00:37:37,680
13 minutes or so let's talk about some

1119
00:37:37,680 --> 00:37:40,339
lessons learned

1120
00:37:40,500 --> 00:37:42,180
another sad time you reference there all

1121
00:37:42,180 --> 00:37:43,740
right so keeping it real this is always

1122
00:37:43,740 --> 00:37:45,540
a concern

1123
00:37:45,540 --> 00:37:46,920
um this is something I think we always

1124
00:37:46,920 --> 00:37:48,359
spend a lot of time thinking about is

1125
00:37:48,359 --> 00:37:51,119
this realistic is this realistic no no

1126
00:37:51,119 --> 00:37:53,220
this can't possibly be realistic

1127
00:37:53,220 --> 00:37:55,140
I've kind of worked my way around to

1128
00:37:55,140 --> 00:37:56,520
this to say

1129
00:37:56,520 --> 00:37:58,560
most of these things are going to pass

1130
00:37:58,560 --> 00:38:00,480
the realism test

1131
00:38:00,480 --> 00:38:01,079
um

1132
00:38:01,079 --> 00:38:02,520
how many admins do you know that don't

1133
00:38:02,520 --> 00:38:03,599
follow their own organizational

1134
00:38:03,599 --> 00:38:05,160
procedures

1135
00:38:05,160 --> 00:38:07,200
okay I'm not asking if you're the admin

1136
00:38:07,200 --> 00:38:09,660
but you know okay that happens

1137
00:38:09,660 --> 00:38:11,880
um how many people sat through a cloud

1138
00:38:11,880 --> 00:38:14,339
presentation in the past day and you

1139
00:38:14,339 --> 00:38:16,320
know and sat there and said

1140
00:38:16,320 --> 00:38:18,480
that looks really cool I have no idea

1141
00:38:18,480 --> 00:38:20,040
how somebody configured this thing to

1142
00:38:20,040 --> 00:38:21,420
make this happen this way in this way

1143
00:38:21,420 --> 00:38:23,280
right Cloud configurations

1144
00:38:23,280 --> 00:38:25,260
misconfigurations happen all the time

1145
00:38:25,260 --> 00:38:28,140
right I can tell you I set the stuff up

1146
00:38:28,140 --> 00:38:30,240
and I'm just like yep okay

1147
00:38:30,240 --> 00:38:31,920
best three buckets there we're good

1148
00:38:31,920 --> 00:38:33,780
we're moving on right I'm not really

1149
00:38:33,780 --> 00:38:35,700
locking that down safe to say that's

1150
00:38:35,700 --> 00:38:36,960
probably what's happening in a lot of

1151
00:38:36,960 --> 00:38:38,339
organizations

1152
00:38:38,339 --> 00:38:41,099
AV and EDR bypasses hell we probably

1153
00:38:41,099 --> 00:38:42,599
said everybody probably sat through at

1154
00:38:42,599 --> 00:38:44,099
least one if not two or three sessions

1155
00:38:44,099 --> 00:38:45,300
that cover different kinds of things

1156
00:38:45,300 --> 00:38:48,000
like that right I mean I uh Henry talked

1157
00:38:48,000 --> 00:38:49,980
about some of that stuff Andy talked

1158
00:38:49,980 --> 00:38:52,440
about some of that stuff uh

1159
00:38:52,440 --> 00:38:54,060
um I'm trying to think if there's uh oh

1160
00:38:54,060 --> 00:38:55,500
and then of course Brett yesterday

1161
00:38:55,500 --> 00:38:57,060
talked about that sorry I said at least

1162
00:38:57,060 --> 00:38:58,560
three sessions that talked about

1163
00:38:58,560 --> 00:39:00,240
different kinds of bypassing these kinds

1164
00:39:00,240 --> 00:39:01,400
of things

1165
00:39:01,400 --> 00:39:03,480
misconfigurations happen People Are

1166
00:39:03,480 --> 00:39:04,800
People

1167
00:39:04,800 --> 00:39:07,500
don't make it too crazy but safe to say

1168
00:39:07,500 --> 00:39:08,640
that these things are going to be things

1169
00:39:08,640 --> 00:39:10,740
that you can go ahead and say yeah we

1170
00:39:10,740 --> 00:39:12,720
got this let's go ahead and let's go

1171
00:39:12,720 --> 00:39:14,579
ahead and move forward with this okay

1172
00:39:14,579 --> 00:39:17,700
things that work current events thread

1173
00:39:17,700 --> 00:39:19,859
Intel reports utilize those things

1174
00:39:19,859 --> 00:39:21,420
Concepts that are talked about here this

1175
00:39:21,420 --> 00:39:23,760
becomes great fodder for being able to

1176
00:39:23,760 --> 00:39:26,760
go ahead and build out your specific

1177
00:39:26,760 --> 00:39:28,560
emulation

1178
00:39:28,560 --> 00:39:30,240
um if you're doing this for your own

1179
00:39:30,240 --> 00:39:31,920
organization right again I'm doing it

1180
00:39:31,920 --> 00:39:33,240
from a different perspective I'm doing

1181
00:39:33,240 --> 00:39:35,280
it kind of globally okay so that's why

1182
00:39:35,280 --> 00:39:36,900
we have one team doing Insider one team

1183
00:39:36,900 --> 00:39:38,520
doing nation state one team doing cyber

1184
00:39:38,520 --> 00:39:40,200
crime right we're kind of trying to

1185
00:39:40,200 --> 00:39:42,980
address a much wider swath focus on your

1186
00:39:42,980 --> 00:39:46,440
adversary and their capabilities so if

1187
00:39:46,440 --> 00:39:47,700
you're concerned about Insider threat

1188
00:39:47,700 --> 00:39:50,220
focus on that build out this process

1189
00:39:50,220 --> 00:39:52,500
around Insider threat right if cyber

1190
00:39:52,500 --> 00:39:54,359
crime cyber criminals are focusing on

1191
00:39:54,359 --> 00:39:55,680
your environment and you want to emulate

1192
00:39:55,680 --> 00:39:58,380
them right pick that don't worry about

1193
00:39:58,380 --> 00:40:00,300
making it a mirror copy

1194
00:40:00,300 --> 00:40:02,820
anybody worry about Shadow copies how

1195
00:40:02,820 --> 00:40:03,900
many ways are there to get to a shadow

1196
00:40:03,900 --> 00:40:05,280
copy

1197
00:40:05,280 --> 00:40:07,380
one

1198
00:40:07,380 --> 00:40:10,380
no no not one right VSS admin right

1199
00:40:10,380 --> 00:40:12,240
there's one right we could probably go

1200
00:40:12,240 --> 00:40:14,040
around the room and find a few more

1201
00:40:14,040 --> 00:40:16,020
expose them to different things don't

1202
00:40:16,020 --> 00:40:17,579
keep going back to the same well over

1203
00:40:17,579 --> 00:40:19,200
and over again right again we're not

1204
00:40:19,200 --> 00:40:21,599
trying to we're not trying to crack in

1205
00:40:21,599 --> 00:40:23,460
and get to the capture the flag right

1206
00:40:23,460 --> 00:40:25,079
what we're trying to do is show them the

1207
00:40:25,079 --> 00:40:26,700
different ways that somebody can get to

1208
00:40:26,700 --> 00:40:30,359
that ntds.dit file as an example right

1209
00:40:30,359 --> 00:40:31,740
we want to expose them to those

1210
00:40:31,740 --> 00:40:34,380
different things so they go oh oh oh oh

1211
00:40:34,380 --> 00:40:36,660
oh oh yeah we're going from here uh I

1212
00:40:36,660 --> 00:40:37,740
see where they're going I see what

1213
00:40:37,740 --> 00:40:39,480
they're trying to do right let's expose

1214
00:40:39,480 --> 00:40:41,579
them to those different methods

1215
00:40:41,579 --> 00:40:44,280
use the network use the endpoint you

1216
00:40:44,280 --> 00:40:45,780
want both of those things for visibility

1217
00:40:45,780 --> 00:40:47,700
hell this is a good way to go ahead and

1218
00:40:47,700 --> 00:40:49,500
assess different kinds of Technologies

1219
00:40:49,500 --> 00:40:51,540
you're looking at onboarding

1220
00:40:51,540 --> 00:40:53,400
okay if you can go ahead and put it

1221
00:40:53,400 --> 00:40:55,859
against your an emulation plan and say

1222
00:40:55,859 --> 00:40:57,060
hey we're looking at this endpoint

1223
00:40:57,060 --> 00:40:58,800
technology but man we can't see crap

1224
00:40:58,800 --> 00:41:01,380
when it comes to this specific thing

1225
00:41:01,380 --> 00:41:02,280
um

1226
00:41:02,280 --> 00:41:04,740
we had AV early on the first couple of

1227
00:41:04,740 --> 00:41:06,540
years we did AV and built AV into our

1228
00:41:06,540 --> 00:41:07,920
systems and everything else and it was

1229
00:41:07,920 --> 00:41:10,260
shocking obviously not probably not

1230
00:41:10,260 --> 00:41:12,420
shocking but it was shocking that we saw

1231
00:41:12,420 --> 00:41:14,520
such little value out of the AV even

1232
00:41:14,520 --> 00:41:15,720
though when we were like yeah let's just

1233
00:41:15,720 --> 00:41:17,579
run some generic stuff that we knew

1234
00:41:17,579 --> 00:41:19,440
would light it up it just wasn't giving

1235
00:41:19,440 --> 00:41:21,180
us enough Telemetry to really go wow

1236
00:41:21,180 --> 00:41:22,380
this is really valuable so we actually

1237
00:41:22,380 --> 00:41:25,079
stopped putting AV into ours into our

1238
00:41:25,079 --> 00:41:26,579
into our scenarios from a logging

1239
00:41:26,579 --> 00:41:27,780
perspective because it was just like it

1240
00:41:27,780 --> 00:41:29,640
isn't creating more value for the

1241
00:41:29,640 --> 00:41:31,320
analysts let's focus on things that

1242
00:41:31,320 --> 00:41:33,599
would create value sysmon those kinds of

1243
00:41:33,599 --> 00:41:34,680
things it would create that visibility

1244
00:41:34,680 --> 00:41:37,098
for us

1245
00:41:37,500 --> 00:41:41,339
um balance the benefit and the burden

1246
00:41:41,339 --> 00:41:43,200
um if you look at miter attack there's

1247
00:41:43,200 --> 00:41:45,720
only so many initial access methods and

1248
00:41:45,720 --> 00:41:47,280
for those sitting in here yesterday or

1249
00:41:47,280 --> 00:41:48,900
earlier just the session before we

1250
00:41:48,900 --> 00:41:51,000
talked about fishing and the things that

1251
00:41:51,000 --> 00:41:52,500
were happening over and over from a

1252
00:41:52,500 --> 00:41:54,119
phishing perspective

1253
00:41:54,119 --> 00:41:55,920
there are people's jobs who literally

1254
00:41:55,920 --> 00:41:57,540
have to click on stuff right that's

1255
00:41:57,540 --> 00:41:59,400
their job they have to open stuff from

1256
00:41:59,400 --> 00:42:01,800
the ex outside they're probably going to

1257
00:42:01,800 --> 00:42:05,040
get fish a time or two right

1258
00:42:05,040 --> 00:42:08,640
if you're stressing out about good

1259
00:42:08,640 --> 00:42:09,980
um initial access

1260
00:42:09,980 --> 00:42:12,960
techniques maybe you go ahead and say

1261
00:42:12,960 --> 00:42:14,460
you know what let's not burden ourselves

1262
00:42:14,460 --> 00:42:16,079
with worrying about that part let's just

1263
00:42:16,079 --> 00:42:18,300
assume breach at this point okay because

1264
00:42:18,300 --> 00:42:19,740
we know they have to click on something

1265
00:42:19,740 --> 00:42:21,599
we can believe we can we can play the

1266
00:42:21,599 --> 00:42:23,579
card of saying yes we know that this has

1267
00:42:23,579 --> 00:42:25,859
happened they're now in now let's focus

1268
00:42:25,859 --> 00:42:28,140
on the rest of the kill chain let's

1269
00:42:28,140 --> 00:42:29,280
focus on everything else that's

1270
00:42:29,280 --> 00:42:31,800
happening after exploit okay if that

1271
00:42:31,800 --> 00:42:32,940
makes it a little bit easier for you to

1272
00:42:32,940 --> 00:42:34,619
get this thing set up and get benefit to

1273
00:42:34,619 --> 00:42:36,359
the analysts that's what you want to do

1274
00:42:36,359 --> 00:42:38,339
okay

1275
00:42:38,339 --> 00:42:40,800
um we boil the ocean we have to boil the

1276
00:42:40,800 --> 00:42:41,700
ocean because we're building these

1277
00:42:41,700 --> 00:42:43,200
end-to-end scenarios again I'm building

1278
00:42:43,200 --> 00:42:45,119
a I'm building a competition I'm

1279
00:42:45,119 --> 00:42:47,040
building question sets I'm building an

1280
00:42:47,040 --> 00:42:49,140
education for an analyst so I want to be

1281
00:42:49,140 --> 00:42:50,400
able to do the whole end-to-end thing

1282
00:42:50,400 --> 00:42:51,720
but I'll tell you what my life would be

1283
00:42:51,720 --> 00:42:53,579
a whole lot easier if we could go ahead

1284
00:42:53,579 --> 00:42:54,780
and just say you know what we're just

1285
00:42:54,780 --> 00:42:56,280
going to focus on data staging and

1286
00:42:56,280 --> 00:42:58,140
exfiltration today where we're going to

1287
00:42:58,140 --> 00:43:00,060
focus on execution and lateral movement

1288
00:43:00,060 --> 00:43:02,160
right maybe just focus on a smaller

1289
00:43:02,160 --> 00:43:03,540
subset of that and say we're going to

1290
00:43:03,540 --> 00:43:04,740
build on this and we're going to train

1291
00:43:04,740 --> 00:43:06,119
on this and we're going to get our

1292
00:43:06,119 --> 00:43:07,680
analysts better on this part or this

1293
00:43:07,680 --> 00:43:09,480
combination so something to think about

1294
00:43:09,480 --> 00:43:10,619
there

1295
00:43:10,619 --> 00:43:11,520
um and then at the end of the day

1296
00:43:11,520 --> 00:43:13,440
keeping your focus on that right what

1297
00:43:13,440 --> 00:43:15,240
are the things that

1298
00:43:15,240 --> 00:43:16,140
um

1299
00:43:16,140 --> 00:43:17,880
what are the things that keep you up at

1300
00:43:17,880 --> 00:43:18,540
night

1301
00:43:18,540 --> 00:43:20,099
right

1302
00:43:20,099 --> 00:43:21,599
um those are the things to focus on if

1303
00:43:21,599 --> 00:43:22,500
you're going to go ahead and build an

1304
00:43:22,500 --> 00:43:23,520
emulation

1305
00:43:23,520 --> 00:43:25,380
now

1306
00:43:25,380 --> 00:43:27,780
when you prepare you want to test test

1307
00:43:27,780 --> 00:43:28,980
this is where I go back to the unit

1308
00:43:28,980 --> 00:43:30,480
testing and I'm not saying necessarily

1309
00:43:30,480 --> 00:43:31,560
the Red Canary stuff but if you want to

1310
00:43:31,560 --> 00:43:33,540
use the Red Canary stuff great but when

1311
00:43:33,540 --> 00:43:35,460
you're doing this you have a you have a

1312
00:43:35,460 --> 00:43:36,720
challenge here you have to go ahead and

1313
00:43:36,720 --> 00:43:38,160
make sure the tool does what you want it

1314
00:43:38,160 --> 00:43:40,380
to do you have to make sure that your

1315
00:43:40,380 --> 00:43:42,720
logging on the other hand sees what you

1316
00:43:42,720 --> 00:43:44,280
want it to see and of course you have

1317
00:43:44,280 --> 00:43:46,319
your victim system that has to do you

1318
00:43:46,319 --> 00:43:47,880
know whatever it is to give you your

1319
00:43:47,880 --> 00:43:51,000
gateway to the next spot okay once you

1320
00:43:51,000 --> 00:43:52,619
do those little unit tests if you will

1321
00:43:52,619 --> 00:43:54,359
then you want to test this thing end to

1322
00:43:54,359 --> 00:43:55,440
end

1323
00:43:55,440 --> 00:43:57,000
makes sense

1324
00:43:57,000 --> 00:43:59,339
now at the same time you have to be

1325
00:43:59,339 --> 00:44:00,540
prepared that something's going to break

1326
00:44:00,540 --> 00:44:02,040
now if you're doing your unit testing

1327
00:44:02,040 --> 00:44:03,480
you'll know

1328
00:44:03,480 --> 00:44:05,280
pretty well where your potential

1329
00:44:05,280 --> 00:44:07,560
problems are going to crop up

1330
00:44:07,560 --> 00:44:09,119
um is it the pivot from Windows to you

1331
00:44:09,119 --> 00:44:10,740
to Linux we talked about with Tate on

1332
00:44:10,740 --> 00:44:11,940
gong

1333
00:44:11,940 --> 00:44:13,680
funny story about that I was responsible

1334
00:44:13,680 --> 00:44:15,060
for the windows side of it my colleague

1335
00:44:15,060 --> 00:44:16,560
Ryan was responsible for the Linux side

1336
00:44:16,560 --> 00:44:18,180
of it he lives in Dallas I live in

1337
00:44:18,180 --> 00:44:20,099
Virginia we met in San Francisco the

1338
00:44:20,099 --> 00:44:22,319
night before and we said hey we never

1339
00:44:22,319 --> 00:44:24,599
really built that pivot and so midnight

1340
00:44:24,599 --> 00:44:26,040
we're sitting in the offices kind of

1341
00:44:26,040 --> 00:44:27,420
trying to go now how exactly are we

1342
00:44:27,420 --> 00:44:28,920
going to make this pivot work because

1343
00:44:28,920 --> 00:44:30,960
we're recording this thing end end

1344
00:44:30,960 --> 00:44:32,220
those are the kinds of things that you

1345
00:44:32,220 --> 00:44:34,140
want to practice ahead of time so you

1346
00:44:34,140 --> 00:44:35,640
don't get to the day of and you're going

1347
00:44:35,640 --> 00:44:37,740
through this rdping through a firewall

1348
00:44:37,740 --> 00:44:39,119
she's got a slide on that in a second

1349
00:44:39,119 --> 00:44:41,760
xfiltration through a firewall

1350
00:44:41,760 --> 00:44:43,560
we had a Palo Alto in there that had

1351
00:44:43,560 --> 00:44:45,119
some prevention on it and by golly that

1352
00:44:45,119 --> 00:44:46,619
prevention worked we were trying to

1353
00:44:46,619 --> 00:44:49,140
exfiltrate Via FTP and we exfiltrated

1354
00:44:49,140 --> 00:44:51,000
everything but literally the Crown Jewel

1355
00:44:51,000 --> 00:44:53,099
if you will and it kept getting blocked

1356
00:44:53,099 --> 00:44:54,420
and so we ended up building a DNS

1357
00:44:54,420 --> 00:44:56,040
exfiltration on the fly to try to get

1358
00:44:56,040 --> 00:44:57,839
around that

1359
00:44:57,839 --> 00:44:59,940
those things happen

1360
00:44:59,940 --> 00:45:02,400
um what happens when your C2 drops

1361
00:45:02,400 --> 00:45:04,560
um Covenant I use Covenant for past

1362
00:45:04,560 --> 00:45:06,540
couple years I love Covenant I decided

1363
00:45:06,540 --> 00:45:08,160
to do an SMB where I kind of come in

1364
00:45:08,160 --> 00:45:10,140
sideways go go with SMB to another

1365
00:45:10,140 --> 00:45:12,720
system and move laterally that way

1366
00:45:12,720 --> 00:45:15,480
um worked great I think I was memory my

1367
00:45:15,480 --> 00:45:16,859
memory utilization was strapped it

1368
00:45:16,859 --> 00:45:19,380
dropped the C2 right this is when the

1369
00:45:19,380 --> 00:45:20,940
persistence techniques that you stuck in

1370
00:45:20,940 --> 00:45:23,280
there earlier on just for grins to

1371
00:45:23,280 --> 00:45:24,660
highlight to the analysts that these are

1372
00:45:24,660 --> 00:45:25,980
persistence techniques you might

1373
00:45:25,980 --> 00:45:28,140
actually find yourself using

1374
00:45:28,140 --> 00:45:31,140
during your emulation because you need

1375
00:45:31,140 --> 00:45:32,520
it otherwise you're starting over from

1376
00:45:32,520 --> 00:45:33,540
scratch

1377
00:45:33,540 --> 00:45:34,980
so those are things to keep in mind as

1378
00:45:34,980 --> 00:45:36,480
well

1379
00:45:36,480 --> 00:45:38,640
um the sticky key when we did the sticky

1380
00:45:38,640 --> 00:45:39,839
keys

1381
00:45:39,839 --> 00:45:41,280
um literally sticky keys I thought that

1382
00:45:41,280 --> 00:45:43,319
was kind of a cool cool image

1383
00:45:43,319 --> 00:45:45,540
um with powdered sugar on top

1384
00:45:45,540 --> 00:45:47,940
um we got four hours into this emulation

1385
00:45:47,940 --> 00:45:50,960
okay I had multiple people doing stuff

1386
00:45:50,960 --> 00:45:53,480
we had

1387
00:45:53,480 --> 00:45:56,819
Watson seats on VMS emulating the

1388
00:45:56,819 --> 00:45:59,700
frothly employees in San Francisco we

1389
00:45:59,700 --> 00:46:01,800
had our thirsty burner Brewery stuff in

1390
00:46:01,800 --> 00:46:04,380
Colorado in a basement uh running on a

1391
00:46:04,380 --> 00:46:06,660
VMware having two workstations over here

1392
00:46:06,660 --> 00:46:09,240
that were being handled

1393
00:46:09,240 --> 00:46:11,099
um and we had a pivot that we were doing

1394
00:46:11,099 --> 00:46:14,520
from the adversary to one of the Thirsty

1395
00:46:14,520 --> 00:46:17,160
burner systems to be able to RDP and we

1396
00:46:17,160 --> 00:46:19,319
got into that and I realized that

1397
00:46:19,319 --> 00:46:20,640
because of the way we had our

1398
00:46:20,640 --> 00:46:21,900
configuration which I'll talk about

1399
00:46:21,900 --> 00:46:24,960
virtual versus physical versus cloud in

1400
00:46:24,960 --> 00:46:26,280
a second

1401
00:46:26,280 --> 00:46:28,319
um we couldn't get there from here

1402
00:46:28,319 --> 00:46:29,940
and so we actually ended up building an

1403
00:46:29,940 --> 00:46:31,800
RDP pivot on the on the fly to get

1404
00:46:31,800 --> 00:46:33,660
around the firewall that was there and

1405
00:46:33,660 --> 00:46:35,220
literally this was the article that we

1406
00:46:35,220 --> 00:46:36,660
pulled and took a look at and and and

1407
00:46:36,660 --> 00:46:38,640
came up with that work around

1408
00:46:38,640 --> 00:46:40,200
these are the kinds of things that you

1409
00:46:40,200 --> 00:46:41,700
know this is why this the hair is this

1410
00:46:41,700 --> 00:46:43,020
color rather than the color it used to

1411
00:46:43,020 --> 00:46:43,800
be

1412
00:46:43,800 --> 00:46:45,300
um because those things happen as you're

1413
00:46:45,300 --> 00:46:47,220
doing it right and so the choice is do

1414
00:46:47,220 --> 00:46:49,160
you abandon that part of the exercise

1415
00:46:49,160 --> 00:46:52,380
maybe do you start over from scratch do

1416
00:46:52,380 --> 00:46:53,940
you stop tape I mean how do you do those

1417
00:46:53,940 --> 00:46:55,619
kinds of things so again the more you

1418
00:46:55,619 --> 00:46:57,420
can think about these things the better

1419
00:46:57,420 --> 00:47:00,000
off you'll be

1420
00:47:00,000 --> 00:47:02,520
back to the analyst to make help make

1421
00:47:02,520 --> 00:47:04,020
the analysts better give them some

1422
00:47:04,020 --> 00:47:06,300
curveballs if you have a junior set of

1423
00:47:06,300 --> 00:47:08,099
analysts right

1424
00:47:08,099 --> 00:47:11,040
just the regular commands mimicats.exe

1425
00:47:11,040 --> 00:47:13,380
totally fine right

1426
00:47:13,380 --> 00:47:14,819
maybe you changed the name and you make

1427
00:47:14,819 --> 00:47:16,200
them look in sysmon and see the original

1428
00:47:16,200 --> 00:47:18,599
file name right then you maybe start

1429
00:47:18,599 --> 00:47:19,859
recompiling and making them start

1430
00:47:19,859 --> 00:47:22,260
looking at switches then maybe you start

1431
00:47:22,260 --> 00:47:23,940
moving changing the switches names and

1432
00:47:23,940 --> 00:47:25,200
make them start looking at the behaviors

1433
00:47:25,200 --> 00:47:27,300
right give them the curveballs don't

1434
00:47:27,300 --> 00:47:28,740
keep feeding in the softball over and

1435
00:47:28,740 --> 00:47:30,660
over and over again

1436
00:47:30,660 --> 00:47:33,780
um and of course don't run in clear text

1437
00:47:33,780 --> 00:47:36,359
so one the one one year we did this with

1438
00:47:36,359 --> 00:47:38,160
mimicats I ran many cats through the

1439
00:47:38,160 --> 00:47:41,280
Metasploit module via kiwi did many cats

1440
00:47:41,280 --> 00:47:43,200
for uh the Kerberos dump and then

1441
00:47:43,200 --> 00:47:45,660
actually Black Hills I had a Blog that I

1442
00:47:45,660 --> 00:47:46,980
went ahead and used that to modify

1443
00:47:46,980 --> 00:47:48,119
Powershell so I gave them three

1444
00:47:48,119 --> 00:47:49,859
different flavors of mimicats one year

1445
00:47:49,859 --> 00:47:52,079
right golden ticket attack I could do

1446
00:47:52,079 --> 00:47:54,540
with mimic cats or rubius but I gave it

1447
00:47:54,540 --> 00:47:55,920
a Twist and went ahead and used rubius

1448
00:47:55,920 --> 00:47:57,180
because rubius was brand new at that

1449
00:47:57,180 --> 00:48:00,000
point in time okay uh I wanted to see

1450
00:48:00,000 --> 00:48:01,440
what rubius would do rubius is now

1451
00:48:01,440 --> 00:48:02,819
actually on the attack list of software

1452
00:48:02,819 --> 00:48:04,200
as well so I guess it's gotten to that

1453
00:48:04,200 --> 00:48:06,060
point where it's like oh crap we gotta

1454
00:48:06,060 --> 00:48:07,680
you know we're trying so it's reached

1455
00:48:07,680 --> 00:48:09,599
that level of awareness but again with

1456
00:48:09,599 --> 00:48:11,400
the example of credential attacks being

1457
00:48:11,400 --> 00:48:12,420
able to give them a couple different

1458
00:48:12,420 --> 00:48:13,980
flavors to expose them to these

1459
00:48:13,980 --> 00:48:15,660
different things and don't let them just

1460
00:48:15,660 --> 00:48:17,520
sit there and go oh yeah I see the name

1461
00:48:17,520 --> 00:48:19,500
I'm good oh yeah I see the hash right

1462
00:48:19,500 --> 00:48:22,560
the hashes right whatever

1463
00:48:22,560 --> 00:48:25,560
uh to Recon or not Recon I don't care to

1464
00:48:25,560 --> 00:48:26,700
Recon

1465
00:48:26,700 --> 00:48:28,740
um for before initial access unless I

1466
00:48:28,740 --> 00:48:31,020
want to highlight sloppy tradecraft

1467
00:48:31,020 --> 00:48:32,640
um I'm more interested in showing Recon

1468
00:48:32,640 --> 00:48:34,619
after I get a foothold to go ahead and

1469
00:48:34,619 --> 00:48:35,880
help educate them right this is the

1470
00:48:35,880 --> 00:48:37,680
classic do I see a ping and then who am

1471
00:48:37,680 --> 00:48:40,200
I or who am I then a ping right

1472
00:48:40,200 --> 00:48:42,839
Network guys do it one way

1473
00:48:42,839 --> 00:48:45,359
nobody else really does it that way

1474
00:48:45,359 --> 00:48:46,740
um you know an adversary would why would

1475
00:48:46,740 --> 00:48:48,359
an adversary look at who am I first and

1476
00:48:48,359 --> 00:48:50,579
then ping you know that's that might be

1477
00:48:50,579 --> 00:48:52,859
a slight difference but looking at

1478
00:48:52,859 --> 00:48:55,260
things from that perspective

1479
00:48:55,260 --> 00:48:55,980
um

1480
00:48:55,980 --> 00:48:58,140
virtual cloud or physical I don't care

1481
00:48:58,140 --> 00:49:00,300
anymore I used to care about this but

1482
00:49:00,300 --> 00:49:01,380
again this kind of got back to the

1483
00:49:01,380 --> 00:49:03,599
keeping it real part I care about cost

1484
00:49:03,599 --> 00:49:06,119
and I care about convenience okay having

1485
00:49:06,119 --> 00:49:08,280
servers in a VMware over here two states

1486
00:49:08,280 --> 00:49:10,140
away from me having people here in

1487
00:49:10,140 --> 00:49:12,359
VMware having some stuff in the cloud it

1488
00:49:12,359 --> 00:49:14,640
gets very confusing set it to something

1489
00:49:14,640 --> 00:49:17,099
else if it has VM net in there in the in

1490
00:49:17,099 --> 00:49:19,020
the log stream for the um for the

1491
00:49:19,020 --> 00:49:20,579
network stack or AWS for the network

1492
00:49:20,579 --> 00:49:23,040
stack that to me does not matter it

1493
00:49:23,040 --> 00:49:24,060
might matter to you but it doesn't

1494
00:49:24,060 --> 00:49:26,099
matter to me this past year when I did

1495
00:49:26,099 --> 00:49:28,800
the adfs stuff I actually had Azure I'm

1496
00:49:28,800 --> 00:49:31,579
sorry Azure ad running and I had my

1497
00:49:31,579 --> 00:49:34,319
on-prem active directory in AWS set up

1498
00:49:34,319 --> 00:49:36,839
with a VPC I got good bandwidth it was

1499
00:49:36,839 --> 00:49:38,640
reasonably inexpensive and I didn't have

1500
00:49:38,640 --> 00:49:40,079
my security team calling me and going

1501
00:49:40,079 --> 00:49:41,400
why are you running these attacks on

1502
00:49:41,400 --> 00:49:43,020
your workstation because my workstation

1503
00:49:43,020 --> 00:49:44,880
was running VMware and they kept seeing

1504
00:49:44,880 --> 00:49:46,859
this weird stuff coming into my system

1505
00:49:46,859 --> 00:49:48,599
so it made a lot easier for everybody

1506
00:49:48,599 --> 00:49:50,900
else

1507
00:49:51,060 --> 00:49:53,160
at the end of the day you're not going

1508
00:49:53,160 --> 00:49:54,599
to be able to get to perfect

1509
00:49:54,599 --> 00:49:56,099
don't worry about getting to perfect for

1510
00:49:56,099 --> 00:49:57,720
the adversary you want to get to that

1511
00:49:57,720 --> 00:49:59,700
good enough right that you're helping up

1512
00:49:59,700 --> 00:50:01,859
level your analysts stay focused on

1513
00:50:01,859 --> 00:50:04,380
those goals that you have okay and be

1514
00:50:04,380 --> 00:50:06,000
aware of the risk of diminishing returns

1515
00:50:06,000 --> 00:50:08,220
when I built the software supply chain

1516
00:50:08,220 --> 00:50:12,300
attack I built a c-sharp app based on

1517
00:50:12,300 --> 00:50:14,220
some msdn article that I read and I

1518
00:50:14,220 --> 00:50:15,599
customized the hell out of it I'm like

1519
00:50:15,599 --> 00:50:17,460
wow this is really nice and then I built

1520
00:50:17,460 --> 00:50:19,560
my little dll inject and I stuck that

1521
00:50:19,560 --> 00:50:20,880
onto the thing and it created my

1522
00:50:20,880 --> 00:50:23,099
callback and I was so happy and then I

1523
00:50:23,099 --> 00:50:24,540
looked at the log stream after we ran

1524
00:50:24,540 --> 00:50:26,520
the emulation and I have about this much

1525
00:50:26,520 --> 00:50:29,520
of that software shown in it and I

1526
00:50:29,520 --> 00:50:30,960
probably spent this much time in it

1527
00:50:30,960 --> 00:50:33,359
right maybe if I'd done a CI CD scenario

1528
00:50:33,359 --> 00:50:34,560
as well you would have seen more of it

1529
00:50:34,560 --> 00:50:36,720
but it was just that very small bit and

1530
00:50:36,720 --> 00:50:38,520
the amount of time spent on that versus

1531
00:50:38,520 --> 00:50:40,319
the payoff of what the analyst gained

1532
00:50:40,319 --> 00:50:42,839
wasn't there so keep those things in

1533
00:50:42,839 --> 00:50:44,819
mind

1534
00:50:44,819 --> 00:50:48,119
um last set of thoughts

1535
00:50:48,119 --> 00:50:50,160
figure out your goals the techniques

1536
00:50:50,160 --> 00:50:51,780
will come along I use this miter attack

1537
00:50:51,780 --> 00:50:53,280
you don't have to use miter attack use

1538
00:50:53,280 --> 00:50:54,780
what you want

1539
00:50:54,780 --> 00:50:56,339
um use your thread intelligence though

1540
00:50:56,339 --> 00:50:57,780
again I use Global threat intelligence

1541
00:50:57,780 --> 00:51:00,119
because my my customer base is global

1542
00:51:00,119 --> 00:51:01,500
right I have to do this for for

1543
00:51:01,500 --> 00:51:03,000
everybody if you're doing it for your

1544
00:51:03,000 --> 00:51:05,460
own organization focus on your thread

1545
00:51:05,460 --> 00:51:07,700
Intel focus on your threat itself

1546
00:51:07,700 --> 00:51:09,660
individual techniques are fine

1547
00:51:09,660 --> 00:51:11,700
individual techniques in concert with

1548
00:51:11,700 --> 00:51:13,319
one another better right because again I

1549
00:51:13,319 --> 00:51:14,640
want my analysts sitting there going oh

1550
00:51:14,640 --> 00:51:16,140
I see this then I see this and I see

1551
00:51:16,140 --> 00:51:18,059
this that's what I'm looking for is that

1552
00:51:18,059 --> 00:51:20,940
chaining okay identify the gaps in the

1553
00:51:20,940 --> 00:51:23,040
data improve that visibility by

1554
00:51:23,040 --> 00:51:24,960
improving the logging once you have the

1555
00:51:24,960 --> 00:51:26,579
logs wrap it back to the security

1556
00:51:26,579 --> 00:51:27,900
operations teams to get better

1557
00:51:27,900 --> 00:51:30,180
detections and at the end of the day for

1558
00:51:30,180 --> 00:51:32,099
goodness sake the upper end of the

1559
00:51:32,099 --> 00:51:34,440
pyramid is the stuff I care about I buy

1560
00:51:34,440 --> 00:51:36,960
IP addresses I buy domains right I use

1561
00:51:36,960 --> 00:51:39,300
them I change them like shirts right the

1562
00:51:39,300 --> 00:51:41,400
hashes I compile something and I got a

1563
00:51:41,400 --> 00:51:43,200
hash I recompile it because I pull out a

1564
00:51:43,200 --> 00:51:45,420
string and I got a different hash I

1565
00:51:45,420 --> 00:51:46,800
don't care about any of that stuff my

1566
00:51:46,800 --> 00:51:48,660
analysts don't care about those things

1567
00:51:48,660 --> 00:51:50,880
right I want them to be looking at tools

1568
00:51:50,880 --> 00:51:52,319
and ttps and saying what are the

1569
00:51:52,319 --> 00:51:53,940
behaviors what are the activities what

1570
00:51:53,940 --> 00:51:55,800
are the things that are being logged and

1571
00:51:55,800 --> 00:51:57,240
what can I go ahead and get better at

1572
00:51:57,240 --> 00:51:59,700
from that perspective

1573
00:51:59,700 --> 00:52:01,200
if you want to go ahead and play around

1574
00:52:01,200 --> 00:52:02,760
and I realize I think I'm two minutes

1575
00:52:02,760 --> 00:52:04,440
over I apologize

1576
00:52:04,440 --> 00:52:05,400
um

1577
00:52:05,400 --> 00:52:06,900
we have a platform out there called

1578
00:52:06,900 --> 00:52:09,000
bots.splunk.com we put some of our data

1579
00:52:09,000 --> 00:52:10,200
sets up there we put some hunting

1580
00:52:10,200 --> 00:52:11,640
modules up there we've got more stuff

1581
00:52:11,640 --> 00:52:13,319
that we keep adding to it if you ever

1582
00:52:13,319 --> 00:52:14,880
play Bots this is the place you end up

1583
00:52:14,880 --> 00:52:16,440
going to play and because our scoring

1584
00:52:16,440 --> 00:52:18,119
server if you want to check it out it's

1585
00:52:18,119 --> 00:52:20,220
free feel free to play around with the

1586
00:52:20,220 --> 00:52:23,280
data sets that are there and with that

1587
00:52:23,280 --> 00:52:25,500
um I'm opening up the questions

1588
00:52:25,500 --> 00:52:28,619
thank you all for your time this is

1589
00:52:28,619 --> 00:52:30,720
I've I've kind of been building this

1590
00:52:30,720 --> 00:52:31,859
thing out in my head and trying to

1591
00:52:31,859 --> 00:52:33,359
improve upon this so thank you for your

1592
00:52:33,359 --> 00:52:34,859
patience as I kind of get through the

1593
00:52:34,859 --> 00:52:36,240
rocky part at the beginning and kind of

1594
00:52:36,240 --> 00:52:37,980
get into my flow because it's uh it's

1595
00:52:37,980 --> 00:52:39,660
still a little rocky on the front end if

1596
00:52:39,660 --> 00:52:40,920
you want to reach out to me or if you

1597
00:52:40,920 --> 00:52:42,240
want to chat afterwards I'll be here

1598
00:52:42,240 --> 00:52:44,640
I'll be here this evening we've got a

1599
00:52:44,640 --> 00:52:45,900
few bot stickers up here if anybody

1600
00:52:45,900 --> 00:52:48,240
wants any of that but otherwise open for

1601
00:52:48,240 --> 00:52:50,419
questions

1602
00:52:58,500 --> 00:53:01,099
yes sir

1603
00:53:03,059 --> 00:53:06,059
foreign

1604
00:53:10,440 --> 00:53:15,020
security conferences would

1605
00:53:15,119 --> 00:53:17,880
so well I was going to say literally I

1606
00:53:17,880 --> 00:53:21,059
sat I've I sat through at least six

1607
00:53:21,059 --> 00:53:23,280
talks in the past two days seven talks

1608
00:53:23,280 --> 00:53:24,839
in the past two days that touched on

1609
00:53:24,839 --> 00:53:27,119
elements of things that I covered today

1610
00:53:27,119 --> 00:53:28,920
like literally and I I think I only

1611
00:53:28,920 --> 00:53:31,260
referenced about four of them but things

1612
00:53:31,260 --> 00:53:34,140
like this I think would be tremendous

1613
00:53:34,140 --> 00:53:35,520
um

1614
00:53:35,520 --> 00:53:38,220
yeah

1615
00:53:38,220 --> 00:53:40,800
um I mean so

1616
00:53:40,800 --> 00:53:43,140
I'd say the b-sides ones can be good

1617
00:53:43,140 --> 00:53:45,960
they're they're you know I if that one's

1618
00:53:45,960 --> 00:53:47,640
always tough because

1619
00:53:47,640 --> 00:53:48,780
um depending on how many tracks they

1620
00:53:48,780 --> 00:53:50,160
have I think some of those tend to be

1621
00:53:50,160 --> 00:53:51,780
decent uh in terms of some of the

1622
00:53:51,780 --> 00:53:54,359
content that's delivered around those

1623
00:53:54,359 --> 00:53:57,599
um I think the the Defcon black hat

1624
00:53:57,599 --> 00:53:59,640
combination if if you don't have the

1625
00:53:59,640 --> 00:54:00,839
budgets for the black hat part of the

1626
00:54:00,839 --> 00:54:03,420
Defcon part is certainly good from that

1627
00:54:03,420 --> 00:54:04,920
perspective I'd say some of the sand

1628
00:54:04,920 --> 00:54:06,839
Summits could be very very useful as

1629
00:54:06,839 --> 00:54:08,280
well those are just places that I've

1630
00:54:08,280 --> 00:54:09,540
been specifically I'm sure there's a lot

1631
00:54:09,540 --> 00:54:11,640
more that other people have here as well

1632
00:54:11,640 --> 00:54:15,920
so it'll be a couple I'd toss out there

1633
00:54:16,980 --> 00:54:20,339
sorry I yes I understand I'm not I'm not

1634
00:54:20,339 --> 00:54:21,839
trying to get into my my stuff

1635
00:54:21,839 --> 00:54:23,640
specifically yeah Splunk has a user

1636
00:54:23,640 --> 00:54:25,260
conference as well I'd say though we

1637
00:54:25,260 --> 00:54:26,640
don't talk as much about this kind of

1638
00:54:26,640 --> 00:54:28,920
stuff though just you know for all uh

1639
00:54:28,920 --> 00:54:30,240
transparency

1640
00:54:30,240 --> 00:54:32,660
so

1641
00:54:33,059 --> 00:54:34,980
I had that one big Shield logo that was

1642
00:54:34,980 --> 00:54:36,359
probably as much as I felt comfortable

1643
00:54:36,359 --> 00:54:37,680
doing

1644
00:54:37,680 --> 00:54:38,579
okay

1645
00:54:38,579 --> 00:54:40,559
anyone else

1646
00:54:40,559 --> 00:54:42,420
all right well I'll be here for a couple

1647
00:54:42,420 --> 00:54:43,440
more minutes if anybody wants to chat

1648
00:54:43,440 --> 00:54:46,579
offline otherwise thank you

