1
00:00:04,019 --> 00:00:07,799
Dr Cuevas Cruz is an offensive security

2
00:00:07,799 --> 00:00:10,740
consultant forensic analysis analyst and

3
00:00:10,740 --> 00:00:13,820
threat Hunter he spends the gamut

4
00:00:13,820 --> 00:00:16,440
for some of the most renowned security

5
00:00:16,440 --> 00:00:18,539
companies in this in the industry which

6
00:00:18,539 --> 00:00:21,119
will remain nameless because I want to

7
00:00:21,119 --> 00:00:23,640
let him get started so Hector tell us

8
00:00:23,640 --> 00:00:26,279
about ATM at the moment penetration

9
00:00:26,279 --> 00:00:28,260
testing at the moment

10
00:00:28,260 --> 00:00:31,019
awesome thank you

11
00:00:31,019 --> 00:00:34,500
so first of all my name is Hector I'm

12
00:00:34,500 --> 00:00:37,620
from Mexico so my politics for my Ascent

13
00:00:37,620 --> 00:00:39,719
for my English

14
00:00:39,719 --> 00:00:40,620
um

15
00:00:40,620 --> 00:00:42,660
I'm security consultant right now the

16
00:00:42,660 --> 00:00:45,660
bishop Fox uh uh I have work aspenation

17
00:00:45,660 --> 00:00:48,420
tester uh forensic analyst and incident

18
00:00:48,420 --> 00:00:51,600
responder and also I have work a street

19
00:00:51,600 --> 00:00:54,860
hunter in a bank for one year and a half

20
00:00:54,860 --> 00:00:59,160
so in the bank what I have done is I

21
00:00:59,160 --> 00:01:02,399
have worked with the ATMs logs and try

22
00:01:02,399 --> 00:01:06,420
to see some of the misbehavior and try

23
00:01:06,420 --> 00:01:09,060
to grab that information

24
00:01:09,060 --> 00:01:12,920
parse it sending to a cm and try to

25
00:01:12,920 --> 00:01:15,720
trigger some alerts if I saw that

26
00:01:15,720 --> 00:01:17,640
something was happening in there so

27
00:01:17,640 --> 00:01:20,280
that's kind of my experience here

28
00:01:20,280 --> 00:01:21,780
because I have done some forensic

29
00:01:21,780 --> 00:01:25,140
analysis for ATMs I will talk about that

30
00:01:25,140 --> 00:01:27,180
later but right now we are going to

31
00:01:27,180 --> 00:01:31,560
focus on the offensive part of the ATMs

32
00:01:31,560 --> 00:01:34,799
but first why we are going to talk about

33
00:01:34,799 --> 00:01:37,200
this so the reason of this talk is

34
00:01:37,200 --> 00:01:39,060
because I have talked with some

35
00:01:39,060 --> 00:01:41,880
consultants and they came to me and say

36
00:01:41,880 --> 00:01:45,360
Hey you know I have been assigned to

37
00:01:45,360 --> 00:01:48,299
perform these penetration tests in the

38
00:01:48,299 --> 00:01:51,320
for this ATM and I don't know what to do

39
00:01:51,320 --> 00:01:53,700
and the penetration test is the next

40
00:01:53,700 --> 00:01:57,360
week uh and the plan for the company is

41
00:01:57,360 --> 00:01:59,820
that you just have your vulnerity

42
00:01:59,820 --> 00:02:02,640
scanner you have your metasployed your

43
00:02:02,640 --> 00:02:04,500
exploits or something like that and you

44
00:02:04,500 --> 00:02:06,060
are ready to go because you are

45
00:02:06,060 --> 00:02:08,340
experienced penetration tester you have

46
00:02:08,340 --> 00:02:10,979
done a lot of network mutation tests web

47
00:02:10,979 --> 00:02:13,340
application pen tests red teams exercise

48
00:02:13,340 --> 00:02:17,340
and so they guess that you already know

49
00:02:17,340 --> 00:02:19,560
how to perform a penetration test in the

50
00:02:19,560 --> 00:02:22,140
ATMs because they assume that is the

51
00:02:22,140 --> 00:02:25,080
same but indeed what should I test in an

52
00:02:25,080 --> 00:02:28,319
ATM how should I do it what tuning will

53
00:02:28,319 --> 00:02:29,700
I need

54
00:02:29,700 --> 00:02:30,360
um

55
00:02:30,360 --> 00:02:33,360
is it the same as a normal pen test that

56
00:02:33,360 --> 00:02:37,260
I always do in a network what is the

57
00:02:37,260 --> 00:02:39,540
main purpose of the test which is my

58
00:02:39,540 --> 00:02:42,720
goal when I talk about ATM penetration

59
00:02:42,720 --> 00:02:45,300
tests we always think that it's about

60
00:02:45,300 --> 00:02:48,239
money I think that I'm going to do a

61
00:02:48,239 --> 00:02:51,599
jackpoting and I picture myself with an

62
00:02:51,599 --> 00:02:54,120
ATM and doing a jackpoting and the

63
00:02:54,120 --> 00:02:56,879
caches in the in the floor that's pretty

64
00:02:56,879 --> 00:02:59,040
exciting but is that the goal for the

65
00:02:59,040 --> 00:03:01,200
financial institution

66
00:03:01,200 --> 00:03:03,599
so at the end what I'm going to

67
00:03:03,599 --> 00:03:05,519
recommend what I'm going to report to

68
00:03:05,519 --> 00:03:07,459
that financial institution

69
00:03:07,459 --> 00:03:10,680
and also one thing that I have seen many

70
00:03:10,680 --> 00:03:14,400
many times in some reports from some

71
00:03:14,400 --> 00:03:17,519
Consultants is that they just came they

72
00:03:17,519 --> 00:03:20,940
just bought their USB with Kali Linux in

73
00:03:20,940 --> 00:03:23,819
the ATM and that's it they said I hacked

74
00:03:23,819 --> 00:03:27,959
the ATM and it's insecure but why okay

75
00:03:27,959 --> 00:03:30,840
yeah maybe I can report that but there

76
00:03:30,840 --> 00:03:34,080
must be a reason of that

77
00:03:34,080 --> 00:03:35,220
um

78
00:03:35,220 --> 00:03:38,760
but first let's learn some basic

79
00:03:38,760 --> 00:03:42,018
concepts of ATMs

80
00:03:42,239 --> 00:03:43,500
so

81
00:03:43,500 --> 00:03:47,760
at the end the ATM has some parts some

82
00:03:47,760 --> 00:03:49,280
components

83
00:03:49,280 --> 00:03:53,519
a lot of components indeed but let's

84
00:03:53,519 --> 00:03:56,819
wrap it up and say that we have that the

85
00:03:56,819 --> 00:03:59,599
ATM inside has a computer

86
00:03:59,599 --> 00:04:02,819
we have this misconception that the ATMs

87
00:04:02,819 --> 00:04:06,060
always have Windows XP

88
00:04:06,060 --> 00:04:08,659
um I'm not very familiar in the states

89
00:04:08,659 --> 00:04:12,299
with that but at least in Mexico and in

90
00:04:12,299 --> 00:04:15,199
Latin America that is not the case why

91
00:04:15,199 --> 00:04:18,238
because in Latin America

92
00:04:18,238 --> 00:04:22,740
uh ATMs are attacked constantly uh one

93
00:04:22,740 --> 00:04:25,020
of the main countries that are attacked

94
00:04:25,020 --> 00:04:29,880
it's Russia Mexico and Brazil so you

95
00:04:29,880 --> 00:04:31,919
know that if something is constantly

96
00:04:31,919 --> 00:04:35,280
being attacked you must keep it securing

97
00:04:35,280 --> 00:04:36,780
constantly

98
00:04:36,780 --> 00:04:41,280
so right now uh most of the ATMs in

99
00:04:41,280 --> 00:04:44,639
these countries are Windows 7 and they

100
00:04:44,639 --> 00:04:46,500
are migrating already or they are

101
00:04:46,500 --> 00:04:49,680
already in Windows 10. so this thing

102
00:04:49,680 --> 00:04:52,860
that ah Atmos has Windows XP and those

103
00:04:52,860 --> 00:04:55,620
are really easy to hack that's a

104
00:04:55,620 --> 00:04:57,360
misconception that I have seen indeed

105
00:04:57,360 --> 00:05:00,120
some of the ATMs that I have tests that

106
00:05:00,120 --> 00:05:01,880
has Windows XP

107
00:05:01,880 --> 00:05:04,860
uh for me it sometimes has been more

108
00:05:04,860 --> 00:05:06,500
difficult to

109
00:05:06,500 --> 00:05:09,860
hack to do a jackpoting for example

110
00:05:09,860 --> 00:05:12,800
that those are

111
00:05:12,800 --> 00:05:15,300
Windows 7 because I'm more familiar

112
00:05:15,300 --> 00:05:17,699
right now with Windows 7 you don't have

113
00:05:17,699 --> 00:05:20,759
much experience right now Windows XP if

114
00:05:20,759 --> 00:05:23,940
I put Windows XP right now and I tell

115
00:05:23,940 --> 00:05:27,000
you hey you have to hack it you will see

116
00:05:27,000 --> 00:05:29,100
that many of the comments that you are

117
00:05:29,100 --> 00:05:31,740
familiar with will not work are not

118
00:05:31,740 --> 00:05:34,380
installed because those were installed

119
00:05:34,380 --> 00:05:36,660
in later versions

120
00:05:36,660 --> 00:05:39,900
so that thing is a misconception that I

121
00:05:39,900 --> 00:05:42,900
want to uh let you know

122
00:05:42,900 --> 00:05:46,020
so we have the computer in the ATM we

123
00:05:46,020 --> 00:05:48,479
have uh the card reader that are the

124
00:05:48,479 --> 00:05:51,199
target for the skimmers that we all know

125
00:05:51,199 --> 00:05:54,720
uh we have the cash dispenser that are

126
00:05:54,720 --> 00:05:56,699
targeted for Black Box attacks that I

127
00:05:56,699 --> 00:05:59,520
will talk about that later we have the

128
00:05:59,520 --> 00:06:01,380
network equipment equipment that

129
00:06:01,380 --> 00:06:04,440
normally that's uh store in an upper

130
00:06:04,440 --> 00:06:06,660
cabinet for example in external loan

131
00:06:06,660 --> 00:06:08,820
ATMs we're going to see those type of

132
00:06:08,820 --> 00:06:10,139
ATMs later

133
00:06:10,139 --> 00:06:13,080
uh we have the external case that I that

134
00:06:13,080 --> 00:06:15,840
is which protects the ATM

135
00:06:15,840 --> 00:06:18,660
and we have the save where we store the

136
00:06:18,660 --> 00:06:20,840
money

137
00:06:20,940 --> 00:06:21,720
um

138
00:06:21,720 --> 00:06:23,580
but we have more components than that

139
00:06:23,580 --> 00:06:27,479
for example we have some ATMs with vein

140
00:06:27,479 --> 00:06:31,680
Scanner with QR code readers with cache

141
00:06:31,680 --> 00:06:36,300
acceptor with we have a NF snfc reader

142
00:06:36,300 --> 00:06:40,860
with camera receiver printer the Epp the

143
00:06:40,860 --> 00:06:44,460
encrypting pin pad we have if if the

144
00:06:44,460 --> 00:06:47,580
financial institution the bank wants to

145
00:06:47,580 --> 00:06:50,100
spend some more money in the ATMs they

146
00:06:50,100 --> 00:06:52,039
put some extra save words

147
00:06:52,039 --> 00:06:54,780
on Hardware or in software we are going

148
00:06:54,780 --> 00:06:56,819
to talk about that also

149
00:06:56,819 --> 00:07:00,720
but we can have a lot of more components

150
00:07:00,720 --> 00:07:03,479
in the ATMs the previous ones that I

151
00:07:03,479 --> 00:07:06,360
talk about are like the main but we can

152
00:07:06,360 --> 00:07:08,580
have a lot of more components

153
00:07:08,580 --> 00:07:11,340
so some of the type of fdms that we can

154
00:07:11,340 --> 00:07:14,940
found is the Standalone ATM that we can

155
00:07:14,940 --> 00:07:17,220
found in the when we go to our

156
00:07:17,220 --> 00:07:20,240
University to the mall

157
00:07:20,240 --> 00:07:23,660
that we just see there standing there

158
00:07:23,660 --> 00:07:27,780
and it's like not that good protected we

159
00:07:27,780 --> 00:07:30,960
have some uh through the wall ATMs that

160
00:07:30,960 --> 00:07:34,080
we normally see in the banks uh in the

161
00:07:34,080 --> 00:07:36,240
financial institution indeed I was

162
00:07:36,240 --> 00:07:39,900
working in one of these streets and I

163
00:07:39,900 --> 00:07:41,479
saw one of these

164
00:07:41,479 --> 00:07:45,419
I see this is really common here

165
00:07:45,419 --> 00:07:48,240
um those are not that common in in other

166
00:07:48,240 --> 00:07:50,340
countries and we have also a drive

167
00:07:50,340 --> 00:07:52,020
through

168
00:07:52,020 --> 00:07:57,000
um also we have ATMs by how it's service

169
00:07:57,000 --> 00:08:00,060
so this means if it's service front or

170
00:08:00,060 --> 00:08:04,319
rear uh when the cash in transit they

171
00:08:04,319 --> 00:08:07,560
are going to service the ATM they will

172
00:08:07,560 --> 00:08:10,680
open it by the front or the rear also if

173
00:08:10,680 --> 00:08:13,199
they need to be managed by the

174
00:08:13,199 --> 00:08:15,000
administrator how they are going to open

175
00:08:15,000 --> 00:08:16,440
it so

176
00:08:16,440 --> 00:08:20,099
these are one these are some things for

177
00:08:20,099 --> 00:08:21,599
example this

178
00:08:21,599 --> 00:08:25,080
um this ATM that is through the wall for

179
00:08:25,080 --> 00:08:27,599
example is going to be service by the

180
00:08:27,599 --> 00:08:30,180
constant Transit uh rear but it's going

181
00:08:30,180 --> 00:08:32,099
to be open to access the computer in

182
00:08:32,099 --> 00:08:34,020
front

183
00:08:34,020 --> 00:08:37,020
um we have also these type of ATMs by

184
00:08:37,020 --> 00:08:39,899
type of type of network communication if

185
00:08:39,899 --> 00:08:41,940
it's going to be Wireless if it's going

186
00:08:41,940 --> 00:08:45,720
to be list line for example this depends

187
00:08:45,720 --> 00:08:48,720
also of the location if I'm going to put

188
00:08:48,720 --> 00:08:52,980
a ATM in a place that doesn't have

189
00:08:52,980 --> 00:08:55,140
really good connection

190
00:08:55,140 --> 00:08:56,180
um well

191
00:08:56,180 --> 00:08:59,100
those ones may be going to be subtletal

192
00:08:59,100 --> 00:09:02,519
because they don't support uh

193
00:09:02,519 --> 00:09:05,820
um Wi-Fi or because we don't have that

194
00:09:05,820 --> 00:09:07,820
um

195
00:09:09,200 --> 00:09:13,320
uh I I don't remember the word

196
00:09:13,320 --> 00:09:14,420
um

197
00:09:14,420 --> 00:09:16,680
bandwidth sorry we don't have the

198
00:09:16,680 --> 00:09:20,580
bandwidth like uh to to give all that

199
00:09:20,580 --> 00:09:23,399
technology to the ATM so if we have an

200
00:09:23,399 --> 00:09:28,140
ATM with certainly satellite connection

201
00:09:28,140 --> 00:09:32,279
we can place some Protections in the ATM

202
00:09:32,279 --> 00:09:35,640
like for example I can have an EDR in

203
00:09:35,640 --> 00:09:39,120
that ATM because uh the connection is

204
00:09:39,120 --> 00:09:42,899
not going to be stable so I can being uh

205
00:09:42,899 --> 00:09:45,839
constantly monitoring that ATM I can be

206
00:09:45,839 --> 00:09:48,959
sending comments to that ATM and the

207
00:09:48,959 --> 00:09:53,160
banks know that they put that ATM like

208
00:09:53,160 --> 00:09:55,140
it's going to be maybe uh more

209
00:09:55,140 --> 00:09:57,720
susceptible to attacks but they are

210
00:09:57,720 --> 00:10:00,620
going to accept that risk

211
00:10:00,620 --> 00:10:04,140
and also we have ATMs by functionality

212
00:10:04,140 --> 00:10:06,899
as I told you depends on the components

213
00:10:06,899 --> 00:10:09,300
but they can accept deposits they can

214
00:10:09,300 --> 00:10:13,019
save checks they can recycle cash uh

215
00:10:13,019 --> 00:10:16,200
have dual dispensers Etc so this it's

216
00:10:16,200 --> 00:10:19,440
just like a brave introduction to ATMs

217
00:10:19,440 --> 00:10:22,440
the components how they are the types of

218
00:10:22,440 --> 00:10:24,240
the ATMs

219
00:10:24,240 --> 00:10:27,120
but now let's talk about the ATM

220
00:10:27,120 --> 00:10:30,180
security posture that we found

221
00:10:30,180 --> 00:10:32,760
we have some attack categories that we

222
00:10:32,760 --> 00:10:35,040
can divide into three the physical

223
00:10:35,040 --> 00:10:38,220
theological and the flow in the physical

224
00:10:38,220 --> 00:10:40,440
we have all of those attacks that

225
00:10:40,440 --> 00:10:42,540
physically will attack the ATM for

226
00:10:42,540 --> 00:10:46,620
example the Run rate where I just wrap

227
00:10:46,620 --> 00:10:49,700
some change into the ATM and I will use

228
00:10:49,700 --> 00:10:52,220
uh a ram

229
00:10:52,220 --> 00:10:55,320
car and we'll take it off from the

230
00:10:55,320 --> 00:10:59,940
ground uh I will steal the whole ATM and

231
00:10:59,940 --> 00:11:02,220
I don't care about the damage that I

232
00:11:02,220 --> 00:11:03,600
will do

233
00:11:03,600 --> 00:11:06,420
um also they can use explosives into the

234
00:11:06,420 --> 00:11:09,540
ATM they will just try to blow up in the

235
00:11:09,540 --> 00:11:11,880
in the safe and access the cache

236
00:11:11,880 --> 00:11:12,839
directly

237
00:11:12,839 --> 00:11:15,600
in The Logical they are not going to do

238
00:11:15,600 --> 00:11:18,959
that they are going to try to don't make

239
00:11:18,959 --> 00:11:21,360
physical damage to the ATM they are

240
00:11:21,360 --> 00:11:24,600
going to act try to access somehow into

241
00:11:24,600 --> 00:11:27,360
the ATM they can access by Network they

242
00:11:27,360 --> 00:11:30,860
can maybe access by a hit device USB

243
00:11:30,860 --> 00:11:34,140
into the ATM and plant maybe a malware

244
00:11:34,140 --> 00:11:37,380
into the ATM to access to the to the

245
00:11:37,380 --> 00:11:39,980
cache to do a black box attack

246
00:11:39,980 --> 00:11:43,980
and in the throat attack category we

247
00:11:43,980 --> 00:11:46,019
have a skimming that they will attack

248
00:11:46,019 --> 00:11:48,899
they will Target their customers they

249
00:11:48,899 --> 00:11:52,920
will not Target per se the ATM

250
00:11:52,920 --> 00:11:55,140
and we have also transaction reversal

251
00:11:55,140 --> 00:11:57,959
Frost that in this case they are going

252
00:11:57,959 --> 00:11:59,300
to

253
00:11:59,300 --> 00:12:03,420
make the ATM to give money by playing

254
00:12:03,420 --> 00:12:05,880
with the cars saying hey I'm going to

255
00:12:05,880 --> 00:12:08,279
insert my car I'm going to tell you give

256
00:12:08,279 --> 00:12:11,700
me one amount of cash and then I'm going

257
00:12:11,700 --> 00:12:15,600
to jump the the ATM I'm going to tell

258
00:12:15,600 --> 00:12:18,120
you hey you didn't give me the money uh

259
00:12:18,120 --> 00:12:21,360
I'm going to jump the the cash uh

260
00:12:21,360 --> 00:12:24,779
dispenser uh and when the ATM is trying

261
00:12:24,779 --> 00:12:26,820
to retrieve the cash from the cash

262
00:12:26,820 --> 00:12:29,880
dispenser I'm going to pull that cash so

263
00:12:29,880 --> 00:12:33,120
the ATM is going to be jam in that case

264
00:12:33,120 --> 00:12:36,720
what is going to happen is that I by

265
00:12:36,720 --> 00:12:40,440
first pull it the cash but the ATM

266
00:12:40,440 --> 00:12:43,019
is going to receive a signal that hey I

267
00:12:43,019 --> 00:12:45,600
I don't know what happened to the to the

268
00:12:45,600 --> 00:12:49,860
to the to that cache uh but I have to uh

269
00:12:49,860 --> 00:12:52,740
deposit uh that amount

270
00:12:52,740 --> 00:12:57,180
to the client again so that's some fraud

271
00:12:57,180 --> 00:13:00,979
that they are doing

272
00:13:01,320 --> 00:13:04,079
so which resources we have available

273
00:13:04,079 --> 00:13:07,800
right now uh these are some of the

274
00:13:07,800 --> 00:13:09,540
really

275
00:13:09,540 --> 00:13:12,120
um less resources that we have for

276
00:13:12,120 --> 00:13:14,880
example PCI ATM security guidelines it's

277
00:13:14,880 --> 00:13:17,760
a PDF available that we have that you

278
00:13:17,760 --> 00:13:19,639
can download

279
00:13:19,639 --> 00:13:23,040
we have also the European Association

280
00:13:23,040 --> 00:13:27,000
for secure transactions uh and the ATM

281
00:13:27,000 --> 00:13:29,700
industry Association nevertheless these

282
00:13:29,700 --> 00:13:32,160
associations are not like public

283
00:13:32,160 --> 00:13:35,220
available you have to be part of these

284
00:13:35,220 --> 00:13:37,500
associations you have to be you have to

285
00:13:37,500 --> 00:13:40,019
have a membership this membership has a

286
00:13:40,019 --> 00:13:42,480
cost uh you have to pay this fee this

287
00:13:42,480 --> 00:13:45,180
fee is not that cheap and also you have

288
00:13:45,180 --> 00:13:48,839
to for register you have to pass some

289
00:13:48,839 --> 00:13:51,899
um checks uh like you have to be part of

290
00:13:51,899 --> 00:13:54,899
a bag or a financial institution you

291
00:13:54,899 --> 00:13:58,079
have to have certain number of clients

292
00:13:58,079 --> 00:14:00,120
and stuff like that so it's not always

293
00:14:00,120 --> 00:14:01,680
easy to

294
00:14:01,680 --> 00:14:04,620
access to this kind of information also

295
00:14:04,620 --> 00:14:07,019
we have some advisories from vendors

296
00:14:07,019 --> 00:14:10,139
about the vendors will only send these

297
00:14:10,139 --> 00:14:14,459
advisories to obviously to their clients

298
00:14:14,459 --> 00:14:18,000
so most of these information that it's

299
00:14:18,000 --> 00:14:19,519
available

300
00:14:19,519 --> 00:14:23,160
uh is not public available it will be

301
00:14:23,160 --> 00:14:25,920
only for that Circle that it's really

302
00:14:25,920 --> 00:14:27,959
close that it's only for financial

303
00:14:27,959 --> 00:14:29,880
institutions that it's okay because you

304
00:14:29,880 --> 00:14:31,440
can maybe

305
00:14:31,440 --> 00:14:33,959
um open all that information to

306
00:14:33,959 --> 00:14:37,019
everybody because yeah the bad guys

307
00:14:37,019 --> 00:14:40,980
cyber crime can get that and do bad

308
00:14:40,980 --> 00:14:43,740
stuff but the truth is that they are

309
00:14:43,740 --> 00:14:46,680
doing right now that so makes no sense

310
00:14:46,680 --> 00:14:49,440
to me for example we have this is the

311
00:14:49,440 --> 00:14:52,680
security guidelines from PCI uh where

312
00:14:52,680 --> 00:14:54,480
the security guidelines right now they

313
00:14:54,480 --> 00:14:57,600
say Hey you have to place the Epp the

314
00:14:57,600 --> 00:15:00,920
encrypting pinpad this way yeah so they

315
00:15:00,920 --> 00:15:05,600
so somebody can came and see how you are

316
00:15:05,600 --> 00:15:08,100
writing the pin

317
00:15:08,100 --> 00:15:09,560
um

318
00:15:09,560 --> 00:15:12,120
okay for me this is not a security

319
00:15:12,120 --> 00:15:13,279
guideline

320
00:15:13,279 --> 00:15:16,440
this doesn't make this doesn't give any

321
00:15:16,440 --> 00:15:19,019
information about uh really how to

322
00:15:19,019 --> 00:15:23,639
secure an ATM but this is like one of

323
00:15:23,639 --> 00:15:25,500
the only information that we have out

324
00:15:25,500 --> 00:15:26,940
there

325
00:15:26,940 --> 00:15:28,980
so

326
00:15:28,980 --> 00:15:32,399
do we need more documentation well I

327
00:15:32,399 --> 00:15:34,320
really think so that's the reason why

328
00:15:34,320 --> 00:15:36,899
I'm here trying to share a little bit of

329
00:15:36,899 --> 00:15:38,639
this

330
00:15:38,639 --> 00:15:41,579
um some of uh of Consultants have

331
00:15:41,579 --> 00:15:44,699
approached me and say hey uh how we can

332
00:15:44,699 --> 00:15:48,540
test this or stuff like that but indeed

333
00:15:48,540 --> 00:15:52,199
this image from Below in that says is it

334
00:15:52,199 --> 00:15:55,019
possible to hack ATMs it's a thread from

335
00:15:55,019 --> 00:15:57,839
Reddit from two days ago and they are

336
00:15:57,839 --> 00:15:58,880
talking about

337
00:15:58,880 --> 00:16:01,620
Terminator John Connor if it's possible

338
00:16:01,620 --> 00:16:04,740
I mean it's 2022 and we are still

339
00:16:04,740 --> 00:16:08,160
discussing that so it's really

340
00:16:08,160 --> 00:16:10,860
um interesting that thread

341
00:16:10,860 --> 00:16:11,519
um

342
00:16:11,519 --> 00:16:14,760
but yeah at the end I have found that

343
00:16:14,760 --> 00:16:17,540
many financial institutions uh doesn't

344
00:16:17,540 --> 00:16:20,880
uh have like the experienced Consultants

345
00:16:20,880 --> 00:16:22,699
to respond when they are being attacked

346
00:16:22,699 --> 00:16:28,079
and ATMs are really uh different between

347
00:16:28,079 --> 00:16:31,620
Brands between models so when they are

348
00:16:31,620 --> 00:16:33,779
being attacked because I have been in

349
00:16:33,779 --> 00:16:36,959
the defensive part sometimes it's really

350
00:16:36,959 --> 00:16:38,759
really hard

351
00:16:38,759 --> 00:16:39,899
um

352
00:16:39,899 --> 00:16:42,240
but let's talk about now the most common

353
00:16:42,240 --> 00:16:44,699
attacks we're going to talk about the

354
00:16:44,699 --> 00:16:47,339
most common attacks uh from the cyber

355
00:16:47,339 --> 00:16:50,180
crime point of view

356
00:16:50,399 --> 00:16:52,920
so one of the most common is the

357
00:16:52,920 --> 00:16:55,440
physical access because they are going

358
00:16:55,440 --> 00:16:56,880
to

359
00:16:56,880 --> 00:17:01,560
came to the ATM uh grab some tools and

360
00:17:01,560 --> 00:17:04,160
they are going to try to open the ATM

361
00:17:04,160 --> 00:17:07,199
however they can but the interesting

362
00:17:07,199 --> 00:17:09,599
things the interesting thing here is

363
00:17:09,599 --> 00:17:11,819
that many of the times that we have seen

364
00:17:11,819 --> 00:17:13,020
this

365
00:17:13,020 --> 00:17:14,819
um from the financial institution side

366
00:17:14,819 --> 00:17:17,339
is that they are not coming with just

367
00:17:17,339 --> 00:17:20,400
any tool they are coming with crafted

368
00:17:20,400 --> 00:17:23,220
tools with custom made tools so for

369
00:17:23,220 --> 00:17:26,099
example here what I am showing here is

370
00:17:26,099 --> 00:17:30,900
that these tools are not bended these

371
00:17:30,900 --> 00:17:33,299
were done this way because that's the

372
00:17:33,299 --> 00:17:37,740
way they need it to be to reach maybe

373
00:17:37,740 --> 00:17:41,640
something that they need so

374
00:17:41,640 --> 00:17:44,280
that was really interesting because if

375
00:17:44,280 --> 00:17:48,000
you rub that tool and you try to use it

376
00:17:48,000 --> 00:17:51,720
you will see that that was uh that that

377
00:17:51,720 --> 00:17:55,500
fit perfectly for One ATM specific so

378
00:17:55,500 --> 00:17:59,900
for example if a bank has a NCR

379
00:17:59,900 --> 00:18:05,220
wink or D bold ATMs and you saw that

380
00:18:05,220 --> 00:18:09,380
these tools were found in a default ATM

381
00:18:09,380 --> 00:18:13,140
uh normally what it's happening is that

382
00:18:13,140 --> 00:18:15,539
these tools will work in all of those

383
00:18:15,539 --> 00:18:19,799
Dibbles ATMs of the same model

384
00:18:19,799 --> 00:18:21,600
and if you go

385
00:18:21,600 --> 00:18:23,840
to the NCR

386
00:18:23,840 --> 00:18:26,640
ATM that it's just next

387
00:18:26,640 --> 00:18:30,840
that doubled uh ATM of the same bank in

388
00:18:30,840 --> 00:18:32,760
the same Branch this will not work

389
00:18:32,760 --> 00:18:37,380
because they study one PM they target

390
00:18:37,380 --> 00:18:39,960
that ATM and they will try to exploit

391
00:18:39,960 --> 00:18:44,280
that ATM that's how it works normally uh

392
00:18:44,280 --> 00:18:46,200
always for the financial institutions

393
00:18:46,200 --> 00:18:50,039
they target One ATM one model and they

394
00:18:50,039 --> 00:18:51,840
try to exploit it as much as they can

395
00:18:51,840 --> 00:18:54,840
then they jump to another one

396
00:18:54,840 --> 00:18:58,080
so in the other picture you can see that

397
00:18:58,080 --> 00:19:02,039
if this one even has a literal camera in

398
00:19:02,039 --> 00:19:04,080
that one because they need to see

399
00:19:04,080 --> 00:19:06,320
something

400
00:19:06,960 --> 00:19:10,020
so uh another attack that they are doing

401
00:19:10,020 --> 00:19:12,900
is Black Box uh attack they use a black

402
00:19:12,900 --> 00:19:15,720
box device Black Box device is nothing

403
00:19:15,720 --> 00:19:19,020
but they disconnect so right now well

404
00:19:19,020 --> 00:19:21,720
it's happening is that the dispenser is

405
00:19:21,720 --> 00:19:23,580
connected to the computer

406
00:19:23,580 --> 00:19:25,820
so what they do is that they disconnect

407
00:19:25,820 --> 00:19:28,799
the dispenser from the computer and they

408
00:19:28,799 --> 00:19:31,140
they connect the dispensers to their own

409
00:19:31,140 --> 00:19:33,240
computer so they can connect it to a

410
00:19:33,240 --> 00:19:35,640
Raspberry p to a laptop to our cell

411
00:19:35,640 --> 00:19:37,500
phone to wherever they have to wherever

412
00:19:37,500 --> 00:19:40,980
they have prepared and in that computer

413
00:19:40,980 --> 00:19:43,200
in that black box device that they

414
00:19:43,200 --> 00:19:46,140
prepare it they have already programmed

415
00:19:46,140 --> 00:19:49,200
that device to say hey dispense the

416
00:19:49,200 --> 00:19:51,840
money so

417
00:19:51,840 --> 00:19:52,500
um

418
00:19:52,500 --> 00:19:55,980
a protection that the attackers have

419
00:19:55,980 --> 00:19:58,260
done that the sorry the financial

420
00:19:58,260 --> 00:20:01,020
institutions have implemented is that

421
00:20:01,020 --> 00:20:02,640
they use like

422
00:20:02,640 --> 00:20:05,280
um certificates for example so the

423
00:20:05,280 --> 00:20:08,280
computer has a certificate and the uh

424
00:20:08,280 --> 00:20:10,460
the cash dispenser has a

425
00:20:10,460 --> 00:20:13,380
certificate if these certificates

426
00:20:13,380 --> 00:20:16,520
mismatch well then another

427
00:20:16,520 --> 00:20:19,440
device can be plugged

428
00:20:19,440 --> 00:20:22,380
um it will not work so this is how they

429
00:20:22,380 --> 00:20:24,780
are fighting black box attacks

430
00:20:24,780 --> 00:20:28,740
nevertheless like in the last eight

431
00:20:28,740 --> 00:20:31,440
months I saw that

432
00:20:31,440 --> 00:20:34,080
the attackers found a way to bypass this

433
00:20:34,080 --> 00:20:37,140
and this is like the old

434
00:20:37,140 --> 00:20:38,419
um

435
00:20:38,419 --> 00:20:42,360
deals uh attack like when you open the

436
00:20:42,360 --> 00:20:45,660
computer and if the vios has a but it

437
00:20:45,660 --> 00:20:47,880
was possible protected you just unplug

438
00:20:47,880 --> 00:20:49,200
the

439
00:20:49,200 --> 00:20:51,600
the battery and the password was reset

440
00:20:51,600 --> 00:20:53,880
so they do something like that what they

441
00:20:53,880 --> 00:20:56,640
do is like they they burn some some

442
00:20:56,640 --> 00:21:00,299
chips in the in the cash dispenser and

443
00:21:00,299 --> 00:21:03,360
they reset like these certificates and

444
00:21:03,360 --> 00:21:06,480
they are able to again uh connect their

445
00:21:06,480 --> 00:21:08,220
black box device

446
00:21:08,220 --> 00:21:10,799
so this one is like the second most

447
00:21:10,799 --> 00:21:12,179
common attack

448
00:21:12,179 --> 00:21:15,780
and the third one now obviously is uh

449
00:21:15,780 --> 00:21:20,220
about xfs uh when they talk to xfs and

450
00:21:20,220 --> 00:21:21,840
they can

451
00:21:21,840 --> 00:21:25,200
um dispense money so we have seen many

452
00:21:25,200 --> 00:21:30,780
of the malwares that can talk xfs and

453
00:21:30,780 --> 00:21:33,179
they can dispense only for example we

454
00:21:33,179 --> 00:21:34,980
have Bluetooth no one of the most

455
00:21:34,980 --> 00:21:38,940
popular most famous malwers

456
00:21:38,940 --> 00:21:42,720
what but what is xfs xfs is confirmed of

457
00:21:42,720 --> 00:21:47,159
apis and spis so for example uh to put

458
00:21:47,159 --> 00:21:51,059
it like easy an API is an easy way to

459
00:21:51,059 --> 00:21:54,659
tell XF xfs what do we want to do we

460
00:21:54,659 --> 00:21:57,780
want to read a car we want to open the

461
00:21:57,780 --> 00:22:00,179
dispenser we want to read a pin it's

462
00:22:00,179 --> 00:22:03,360
like normal commands

463
00:22:03,360 --> 00:22:04,200
um

464
00:22:04,200 --> 00:22:07,200
and an SPI the service provider

465
00:22:07,200 --> 00:22:10,740
interface will be the specific interface

466
00:22:10,740 --> 00:22:12,900
that will interact with a specific

467
00:22:12,900 --> 00:22:16,679
peripheral so every ATM has their

468
00:22:16,679 --> 00:22:18,780
specific peripherals and those

469
00:22:18,780 --> 00:22:22,440
peripherals have their specific dlls so

470
00:22:22,440 --> 00:22:26,760
because uh all of those ATMs with

471
00:22:26,760 --> 00:22:29,280
different brands and models have their

472
00:22:29,280 --> 00:22:32,280
own dlls dlls it was really difficult

473
00:22:32,280 --> 00:22:36,299
like to talk to each one so they created

474
00:22:36,299 --> 00:22:40,020
xfls like this API to talk to all of

475
00:22:40,020 --> 00:22:44,520
them so xfs will translate to doses to

476
00:22:44,520 --> 00:22:45,299
those

477
00:22:45,299 --> 00:22:49,799
uh to those spis and the spis will

478
00:22:49,799 --> 00:22:53,520
translate and we'll talk to those dlls

479
00:22:53,520 --> 00:22:55,919
so for example like we see in those

480
00:22:55,919 --> 00:22:58,980
registers we have the application of the

481
00:22:58,980 --> 00:23:03,480
bank that will talk xfs and we have the

482
00:23:03,480 --> 00:23:05,880
access manager the multibander now the

483
00:23:05,880 --> 00:23:09,179
middleware and that one will talk to the

484
00:23:09,179 --> 00:23:11,400
spis and SPS will translate to the dll

485
00:23:11,400 --> 00:23:14,640
so this is the reason why when we have

486
00:23:14,640 --> 00:23:19,740
one malware that talk that talks xfs

487
00:23:19,740 --> 00:23:22,500
uh normally it will works in several

488
00:23:22,500 --> 00:23:25,220
ATMs

489
00:23:25,919 --> 00:23:27,600
for example this is an example of

490
00:23:27,600 --> 00:23:30,780
malware xfs I was doing here forensic

491
00:23:30,780 --> 00:23:33,900
analysis of a malware

492
00:23:33,900 --> 00:23:37,440
um we will we only know that that ATM

493
00:23:37,440 --> 00:23:41,760
was attacked uh we didn't know how and

494
00:23:41,760 --> 00:23:43,760
what I did was write

495
00:23:43,760 --> 00:23:47,880
uh Jara rule really easy and you can I

496
00:23:47,880 --> 00:23:49,620
don't know if you can see but here you

497
00:23:49,620 --> 00:23:52,320
can see like those

498
00:23:52,320 --> 00:23:57,120
um xfs instructions like wfs open wfs

499
00:23:57,120 --> 00:24:01,159
execute wfs startup those are like

500
00:24:01,159 --> 00:24:04,740
normal commands that the email words

501
00:24:04,740 --> 00:24:08,760
will use in xfs so I just wrote this uh

502
00:24:08,760 --> 00:24:12,179
there are rule I'll run this in my

503
00:24:12,179 --> 00:24:15,240
autopsy forensic station

504
00:24:15,240 --> 00:24:18,539
and I found uh really quickly some

505
00:24:18,539 --> 00:24:22,020
binaries that were using these functions

506
00:24:22,020 --> 00:24:25,200
and I was able to identify malware in

507
00:24:25,200 --> 00:24:26,960
that ATM

508
00:24:26,960 --> 00:24:30,539
this is one example for example of a

509
00:24:30,539 --> 00:24:34,080
malware using xfs those binaries were

510
00:24:34,080 --> 00:24:37,260
used in xfs but in the picture that it's

511
00:24:37,260 --> 00:24:40,020
behind for example this malware was not

512
00:24:40,020 --> 00:24:43,260
using xfs that's one way to do it but

513
00:24:43,260 --> 00:24:45,240
another way to do it is that malwares

514
00:24:45,240 --> 00:24:48,059
are not using xfs instead what they are

515
00:24:48,059 --> 00:24:51,260
doing is that they are reusing

516
00:24:51,260 --> 00:24:54,860
binaries dlls that already

517
00:24:54,860 --> 00:24:59,039
do things so for example here this one

518
00:24:59,039 --> 00:25:05,159
is using cscw CNG that it's a dll for

519
00:25:05,159 --> 00:25:08,840
wincore dsdll specifically

520
00:25:08,840 --> 00:25:13,080
talks to the dispenser in Winker and if

521
00:25:13,080 --> 00:25:16,140
you use it it will you you will be able

522
00:25:16,140 --> 00:25:18,900
to dispense some money so the malware

523
00:25:18,900 --> 00:25:23,520
instead of using xfs it will be only

524
00:25:23,520 --> 00:25:28,020
using this dll and that's one way like

525
00:25:28,020 --> 00:25:30,419
to hide

526
00:25:30,419 --> 00:25:31,980
um some of the tasks that you are doing

527
00:25:31,980 --> 00:25:33,539
because if your room for example that

528
00:25:33,539 --> 00:25:36,000
there are rule that I wrote you won't

529
00:25:36,000 --> 00:25:39,179
find that in this malware because you

530
00:25:39,179 --> 00:25:42,360
are not using xfs you are just reusing

531
00:25:42,360 --> 00:25:45,480
this dll so this is like the third most

532
00:25:45,480 --> 00:25:48,720
common way that cybercromb is using that

533
00:25:48,720 --> 00:25:51,539
it's just the malware

534
00:25:51,539 --> 00:25:53,700
so finally

535
00:25:53,700 --> 00:25:56,159
which are the main uses that we should

536
00:25:56,159 --> 00:25:58,380
report in a pen test

537
00:25:58,380 --> 00:26:00,720
now we are ready to

538
00:26:00,720 --> 00:26:03,740
I don't know uh both my colleague

539
00:26:03,740 --> 00:26:06,440
started scanning with nmap I don't know

540
00:26:06,440 --> 00:26:08,840
use some exploits with

541
00:26:08,840 --> 00:26:12,659
metasployed even starnesus because I

542
00:26:12,659 --> 00:26:15,600
have seen that in some reports

543
00:26:15,600 --> 00:26:18,539
um but at the end we have heard a lot of

544
00:26:18,539 --> 00:26:20,700
this phrase that it's security is like

545
00:26:20,700 --> 00:26:24,000
an onion because we know is larger it

546
00:26:24,000 --> 00:26:26,520
but uh I want to see it more like a game

547
00:26:26,520 --> 00:26:29,940
so we're going to see it in this way

548
00:26:29,940 --> 00:26:32,940
we're going to uh see the environment

549
00:26:32,940 --> 00:26:35,880
when we are going to test an ATM we are

550
00:26:35,880 --> 00:26:37,320
going to see the environment we're going

551
00:26:37,320 --> 00:26:39,299
to see the physical components we're

552
00:26:39,299 --> 00:26:41,100
going to see the network layer and we're

553
00:26:41,100 --> 00:26:43,320
going to see the application layer to be

554
00:26:43,320 --> 00:26:45,659
able to test uh like the whole

555
00:26:45,659 --> 00:26:49,559
environment of the ATM

556
00:26:49,559 --> 00:26:50,940
so

557
00:26:50,940 --> 00:26:54,120
when I arrived to do a to perform an ATM

558
00:26:54,120 --> 00:26:57,059
penetration test I'm not just arriving

559
00:26:57,059 --> 00:27:00,960
to the ATM and I have seen some

560
00:27:00,960 --> 00:27:02,820
Consultants that they just say hey give

561
00:27:02,820 --> 00:27:04,799
me the IP address and I will start the

562
00:27:04,799 --> 00:27:08,039
penetration test but no uh when I do a

563
00:27:08,039 --> 00:27:09,960
penetration test and I always talk to

564
00:27:09,960 --> 00:27:12,480
the bank to the financial institution

565
00:27:12,480 --> 00:27:15,539
hey I have to do it physically I can do

566
00:27:15,539 --> 00:27:19,740
it this test just by the IP address why

567
00:27:19,740 --> 00:27:21,840
because I will have to test as I told

568
00:27:21,840 --> 00:27:24,020
you the environment in the physical

569
00:27:24,020 --> 00:27:27,960
layer and I can do that just because on

570
00:27:27,960 --> 00:27:29,520
the application and I can do it that

571
00:27:29,520 --> 00:27:32,940
just with an IP address and so when I

572
00:27:32,940 --> 00:27:37,260
arrive to the ATM it doesn't matter if

573
00:27:37,260 --> 00:27:39,779
it's a standalone it's a through wall

574
00:27:39,779 --> 00:27:41,940
ATM

575
00:27:41,940 --> 00:27:46,559
I will see the CCTV and the ATM cameras

576
00:27:46,559 --> 00:27:51,059
so let's picture if these are if the ATM

577
00:27:51,059 --> 00:27:54,559
it's an University it's in in a mall

578
00:27:54,559 --> 00:27:58,500
it's if it's in the bank what I will try

579
00:27:58,500 --> 00:28:02,400
to see first of all if I are just as I

580
00:28:02,400 --> 00:28:05,520
arrive if there is any camera place

581
00:28:05,520 --> 00:28:06,840
there is

582
00:28:06,840 --> 00:28:07,760
um

583
00:28:07,760 --> 00:28:11,460
uh recording in the ATMs why this is

584
00:28:11,460 --> 00:28:13,200
really really important because

585
00:28:13,200 --> 00:28:15,960
maybe you say hey that doesn't matter to

586
00:28:15,960 --> 00:28:20,700
me this is not ATM hacking yeah but uh

587
00:28:20,700 --> 00:28:24,480
when the man has an incident for example

588
00:28:24,480 --> 00:28:26,700
a transaction revolves of row

589
00:28:26,700 --> 00:28:29,940
you can respond to that

590
00:28:29,940 --> 00:28:33,080
without cameras and without locks so

591
00:28:33,080 --> 00:28:35,640
mainly with locks but also with cameras

592
00:28:35,640 --> 00:28:37,200
because the cameras will give you the

593
00:28:37,200 --> 00:28:39,480
modus operandi how how they are

594
00:28:39,480 --> 00:28:42,240
triggering those routes

595
00:28:42,240 --> 00:28:44,880
if you don't have cameras that's a

596
00:28:44,880 --> 00:28:45,740
really

597
00:28:45,740 --> 00:28:48,480
issue for the institution

598
00:28:48,480 --> 00:28:53,539
uh and that's one thing I have seen many

599
00:28:53,539 --> 00:28:56,820
a lot of times that there is a CCTV

600
00:28:56,820 --> 00:28:57,720
camera

601
00:28:57,720 --> 00:28:59,279
but sometimes it's

602
00:28:59,279 --> 00:29:02,940
just uh recording to another place

603
00:29:02,940 --> 00:29:05,880
and I have to say hey yeah you have a

604
00:29:05,880 --> 00:29:07,559
camera but you have to move it because

605
00:29:07,559 --> 00:29:10,440
it's not recording to that ATM

606
00:29:10,440 --> 00:29:13,679
or when I opened the ATM I have seen

607
00:29:13,679 --> 00:29:17,400
that a lot of things you you don't have

608
00:29:17,400 --> 00:29:18,860
camera

609
00:29:18,860 --> 00:29:22,140
but it is not connected or you have a

610
00:29:22,140 --> 00:29:23,760
camera that is connected but it's not

611
00:29:23,760 --> 00:29:27,000
recording because obviously if all of

612
00:29:27,000 --> 00:29:29,820
those records uh it's a storage and the

613
00:29:29,820 --> 00:29:33,120
storage is money and well you know they

614
00:29:33,120 --> 00:29:35,520
don't want to spend so for me this is

615
00:29:35,520 --> 00:29:37,440
one of the main things that we are going

616
00:29:37,440 --> 00:29:39,080
to review

617
00:29:39,080 --> 00:29:41,480
the other thing that I'm going to review

618
00:29:41,480 --> 00:29:43,500
in the environment in the physical

619
00:29:43,500 --> 00:29:46,559
environment is the cables explosive

620
00:29:46,559 --> 00:29:47,580
cables

621
00:29:47,580 --> 00:29:50,220
so for example it's really normal that

622
00:29:50,220 --> 00:29:52,980
I'd say here there's a cable that it's

623
00:29:52,980 --> 00:29:56,700
just hanging out there and

624
00:29:56,700 --> 00:29:59,720
what happens I can cut it

625
00:29:59,720 --> 00:30:02,279
and for example in the picture in the

626
00:30:02,279 --> 00:30:05,820
middle it was a USB cable and what we

627
00:30:05,820 --> 00:30:09,240
did is that we really um

628
00:30:09,240 --> 00:30:13,500
a good uh what we did is that we connect

629
00:30:13,500 --> 00:30:17,279
a hub and we were able to really uh

630
00:30:17,279 --> 00:30:23,100
connect a keyboard and a USB device

631
00:30:23,100 --> 00:30:26,820
and that part from where it from where

632
00:30:26,820 --> 00:30:30,000
we get that cable is from where the

633
00:30:30,000 --> 00:30:33,899
camera should be so in this ATM we got

634
00:30:33,899 --> 00:30:38,700
uh we we asked the bank if we were if we

635
00:30:38,700 --> 00:30:41,820
could cut that cable of course

636
00:30:41,820 --> 00:30:45,860
um we got that approval but uh in that

637
00:30:45,860 --> 00:30:49,679
uh square that where we got that cable

638
00:30:49,679 --> 00:30:52,799
it should be the camera but as there was

639
00:30:52,799 --> 00:30:55,500
no camera there is only one little

640
00:30:55,500 --> 00:30:59,880
plastic there uh one attacker came just

641
00:30:59,880 --> 00:31:03,299
and just break it and the cable is just

642
00:31:03,299 --> 00:31:06,720
right there we can grab it cut it and we

643
00:31:06,720 --> 00:31:10,919
can connect directly we can access to

644
00:31:10,919 --> 00:31:13,980
the ATM by connecting an USB and do a

645
00:31:13,980 --> 00:31:16,919
heat attack we can connect a keyboard

646
00:31:16,919 --> 00:31:19,740
and we can do a screen or kiosk

647
00:31:19,740 --> 00:31:22,679
jailbreak and take control of the ATM

648
00:31:22,679 --> 00:31:25,020
and normally that's one thing that maybe

649
00:31:25,020 --> 00:31:28,260
you don't know but the ATMs wrong with

650
00:31:28,260 --> 00:31:31,020
service privilege or administrator

651
00:31:31,020 --> 00:31:34,440
privilege and even though if they are

652
00:31:34,440 --> 00:31:36,659
not running with this privilege you

653
00:31:36,659 --> 00:31:38,940
don't need those privilege to do a

654
00:31:38,940 --> 00:31:40,020
jackpoting

655
00:31:40,020 --> 00:31:43,740
do you just need any user privilege so

656
00:31:43,740 --> 00:31:47,760
just with getting you to drop something

657
00:31:47,760 --> 00:31:51,659
into the ATM you can talk to xfs and you

658
00:31:51,659 --> 00:31:54,419
will be able to perform that attack

659
00:31:54,419 --> 00:31:57,299
and in the last picture well that's a

660
00:31:57,299 --> 00:31:59,460
picture of a really well protected

661
00:31:59,460 --> 00:32:02,580
cables of an ATM

662
00:32:02,580 --> 00:32:04,980
another thing is that we found a lot of

663
00:32:04,980 --> 00:32:07,320
weak locks or locks by default you know

664
00:32:07,320 --> 00:32:11,640
but uh just with some logs lock picks uh

665
00:32:11,640 --> 00:32:15,419
you can open it we indeed did some

666
00:32:15,419 --> 00:32:18,720
contests that how many seconds you take

667
00:32:18,720 --> 00:32:20,640
it to open it

668
00:32:20,640 --> 00:32:21,299
um

669
00:32:21,299 --> 00:32:23,720
some of them were really really easy

670
00:32:23,720 --> 00:32:27,600
indeed some ATMs were not even need to

671
00:32:27,600 --> 00:32:30,779
have logs lock picking tools to open it

672
00:32:30,779 --> 00:32:34,620
to could use even sometimes another kind

673
00:32:34,620 --> 00:32:38,760
of tools like clothes hangers or

674
00:32:38,760 --> 00:32:39,480
um

675
00:32:39,480 --> 00:32:42,299
cardboard ah

676
00:32:42,299 --> 00:32:44,760
and I'm gonna show you a video at the

677
00:32:44,760 --> 00:32:48,419
end of how we did that those are some of

678
00:32:48,419 --> 00:32:51,480
my tools that I normally take you have

679
00:32:51,480 --> 00:32:55,320
to take to see if you can take those

680
00:32:55,320 --> 00:32:57,679
long picks

681
00:32:57,679 --> 00:33:01,559
to that country because normally they

682
00:33:01,559 --> 00:33:04,919
are not allowed it could be illegal

683
00:33:04,919 --> 00:33:07,440
and sometimes even we have seen that

684
00:33:07,440 --> 00:33:10,740
some ATMs they change their locks to

685
00:33:10,740 --> 00:33:14,000
tubular locks but also we have picks for

686
00:33:14,000 --> 00:33:17,899
those kinds of locks

687
00:33:17,960 --> 00:33:21,480
uh we found also that ATMs have sensors

688
00:33:21,480 --> 00:33:23,600
uh you have different kind of sensors

689
00:33:23,600 --> 00:33:27,360
sensor mechanical sensors magnetic

690
00:33:27,360 --> 00:33:31,559
sensors uh laser sensors the most common

691
00:33:31,559 --> 00:33:35,000
sensors are mechanical and are um

692
00:33:35,000 --> 00:33:39,440
magnetic sensors but sometimes you can

693
00:33:39,440 --> 00:33:44,039
reach Those sensors by the Bands and you

694
00:33:44,039 --> 00:33:46,700
just need to try to see where they are

695
00:33:46,700 --> 00:33:49,019
that's the reason why the attackers

696
00:33:49,019 --> 00:33:52,080
steal the ATMs not maybe because of the

697
00:33:52,080 --> 00:33:54,600
money because they want to study that

698
00:33:54,600 --> 00:33:56,820
ATM they want to study that model in

699
00:33:56,820 --> 00:34:00,179
specific And when they see that ATM it's

700
00:34:00,179 --> 00:34:02,039
already with all the security

701
00:34:02,039 --> 00:34:04,860
protections of the bank they steal it

702
00:34:04,860 --> 00:34:07,559
and they study what they have they have

703
00:34:07,559 --> 00:34:09,719
sensors they have extra safe words they

704
00:34:09,719 --> 00:34:12,179
have software protections they study

705
00:34:12,179 --> 00:34:15,659
everything and they then prepare they

706
00:34:15,659 --> 00:34:17,580
came with their crafted tools and they

707
00:34:17,580 --> 00:34:19,918
attack it in just seconds

708
00:34:19,918 --> 00:34:22,440
because they already know where and how

709
00:34:22,440 --> 00:34:25,320
to do it so in this case what we do is

710
00:34:25,320 --> 00:34:28,099
we are trying to see we for example a

711
00:34:28,099 --> 00:34:32,219
hand lamp from the pens here we can see

712
00:34:32,219 --> 00:34:34,980
ah here is a sensor uh if I can reach it

713
00:34:34,980 --> 00:34:37,739
for example here with some of the lock

714
00:34:37,739 --> 00:34:40,080
picking tools I was able to reach this

715
00:34:40,080 --> 00:34:43,260
mechanical sensor and when I was able to

716
00:34:43,260 --> 00:34:46,980
lock pick the the lock and open the ATM

717
00:34:46,980 --> 00:34:50,280
I wouldn't trigger the alarm to the ATM

718
00:34:50,280 --> 00:34:53,460
so that's some things that you should

719
00:34:53,460 --> 00:34:55,699
note

720
00:34:55,760 --> 00:34:59,760
also we have unprotected bias views

721
00:34:59,760 --> 00:35:01,560
um that's one of the things that I told

722
00:35:01,560 --> 00:35:02,940
you about

723
00:35:02,940 --> 00:35:06,599
yeah uh I have seen many of the reports

724
00:35:06,599 --> 00:35:09,599
of ATMs I I bought Kali Linux yeah

725
00:35:09,599 --> 00:35:11,640
that's one great thing but what is the

726
00:35:11,640 --> 00:35:13,020
main problem the main problem is that

727
00:35:13,020 --> 00:35:16,619
boc is not protected so yeah it's a

728
00:35:16,619 --> 00:35:21,020
finding uh but it's not the main goal

729
00:35:21,020 --> 00:35:24,680
also we have an encrypted hard drive

730
00:35:24,680 --> 00:35:27,960
for me this is like the most

731
00:35:27,960 --> 00:35:31,380
uh critical findings in ATM penetration

732
00:35:31,380 --> 00:35:34,920
testing why because if when I found uh

733
00:35:34,920 --> 00:35:36,900
on a creative hard drive it allows me a

734
00:35:36,900 --> 00:35:38,099
lot of things for example install

735
00:35:38,099 --> 00:35:41,400
malware start is extract hashes and

736
00:35:41,400 --> 00:35:44,579
passwords disabled users uh disabled

737
00:35:44,579 --> 00:35:48,119
security software and mostly because I

738
00:35:48,119 --> 00:35:52,560
was able to bypass a lot of ACLS I will

739
00:35:52,560 --> 00:35:54,359
list some of the security software

740
00:35:54,359 --> 00:35:56,579
protection that I was able to

741
00:35:56,579 --> 00:35:57,359
um

742
00:35:57,359 --> 00:35:59,820
bypass at the end

743
00:35:59,820 --> 00:36:03,180
also if we have biosome protected I

744
00:36:03,180 --> 00:36:05,700
don't have to Dismount the hard drive I

745
00:36:05,700 --> 00:36:09,180
will I use cam Boot and mount the hard

746
00:36:09,180 --> 00:36:09,960
drive

747
00:36:09,960 --> 00:36:12,599
also we have unnecessary network service

748
00:36:12,599 --> 00:36:16,680
exposes sometimes uh sometimes I have

749
00:36:16,680 --> 00:36:19,800
phone even Legacy protocols in there and

750
00:36:19,800 --> 00:36:21,720
well you know that's like a normal pen

751
00:36:21,720 --> 00:36:24,839
test but this is just a small part

752
00:36:24,839 --> 00:36:27,300
that yeah with the IP address you can do

753
00:36:27,300 --> 00:36:28,859
like a normal pen test Network pen test

754
00:36:28,859 --> 00:36:32,760
but this is just one finding from all of

755
00:36:32,760 --> 00:36:34,260
the findings that we are

756
00:36:34,260 --> 00:36:36,480
seeing right now

757
00:36:36,480 --> 00:36:41,520
we have kiosk jailbreak so to do a

758
00:36:41,520 --> 00:36:44,839
screener break in ATM uh we will need

759
00:36:44,839 --> 00:36:48,960
one thing that is how to uh control the

760
00:36:48,960 --> 00:36:52,200
ATM normally it will it will be by

761
00:36:52,200 --> 00:36:54,240
having a keyboard connected in the ATM

762
00:36:54,240 --> 00:36:57,119
or maybe sometimes the ATM it's

763
00:36:57,119 --> 00:37:00,359
touchscreen also uh if you will be able

764
00:37:00,359 --> 00:37:03,660
to bypass uh but you know

765
00:37:03,660 --> 00:37:04,820
um

766
00:37:04,820 --> 00:37:08,660
minimizing a window

767
00:37:08,660 --> 00:37:12,240
going into help and opening Internet

768
00:37:12,240 --> 00:37:16,079
Explorer and then do launch the CMD and

769
00:37:16,079 --> 00:37:18,780
stuff like that then well you can do a

770
00:37:18,780 --> 00:37:21,000
lot of things

771
00:37:21,000 --> 00:37:22,880
foreign

772
00:37:22,880 --> 00:37:25,320
some of the security protections on my

773
00:37:25,320 --> 00:37:28,020
past that I have seen

774
00:37:28,020 --> 00:37:32,060
or have been able to do it in software

775
00:37:32,060 --> 00:37:36,900
some of the most common software that

776
00:37:36,900 --> 00:37:39,780
are focused for ATMs are check it

777
00:37:39,780 --> 00:37:43,579
checker look wise Horizon

778
00:37:43,579 --> 00:37:47,579
and also we have seen simantech McAfee

779
00:37:47,579 --> 00:37:53,940
edrs for example all of these have ACLS

780
00:37:53,940 --> 00:37:57,740
um all of these ACLS

781
00:37:57,740 --> 00:38:00,619
denies a lot of

782
00:38:00,619 --> 00:38:05,099
actions that you drop some binaries

783
00:38:05,099 --> 00:38:09,420
there and execute and that's great but

784
00:38:09,420 --> 00:38:12,920
if you are able to bypass those ACLS

785
00:38:12,920 --> 00:38:17,099
then well you are like uh it's like your

786
00:38:17,099 --> 00:38:20,160
domain admin in an ATM because you will

787
00:38:20,160 --> 00:38:23,640
be able indeed to

788
00:38:23,640 --> 00:38:26,339
put a binary that we control xfs and

789
00:38:26,339 --> 00:38:29,099
then you will you can uh perform the

790
00:38:29,099 --> 00:38:30,599
jackpot in attack

791
00:38:30,599 --> 00:38:33,359
in Hardware you will have uh sometimes

792
00:38:33,359 --> 00:38:36,119
anti-skiming anti-black box and extra

793
00:38:36,119 --> 00:38:38,760
save words these ones have been really

794
00:38:38,760 --> 00:38:41,700
fun like you have found

795
00:38:41,700 --> 00:38:45,839
um metal bars metal pins vent covers for

796
00:38:45,839 --> 00:38:49,079
protection the the sensors or stuff like

797
00:38:49,079 --> 00:38:52,640
that now we have used some pumps air

798
00:38:52,640 --> 00:38:56,880
pumps uh to to bypass some of these

799
00:38:56,880 --> 00:39:00,060
metal bars and stuff like that

800
00:39:00,060 --> 00:39:01,339
um

801
00:39:01,339 --> 00:39:04,740
these extra save words we have only seen

802
00:39:04,740 --> 00:39:07,220
those in the Laboratories

803
00:39:07,220 --> 00:39:11,660
because it's not normal that they will

804
00:39:11,660 --> 00:39:15,060
spend all of that money in the in the

805
00:39:15,060 --> 00:39:17,640
ATMs normally the institutions will say

806
00:39:17,640 --> 00:39:21,839
we know uh we have assessed the risk and

807
00:39:21,839 --> 00:39:24,359
we know that we lost this amount of

808
00:39:24,359 --> 00:39:27,119
money in all of these ATM attacks per

809
00:39:27,119 --> 00:39:28,220
year

810
00:39:28,220 --> 00:39:31,380
and if we accept this risk is going to

811
00:39:31,380 --> 00:39:34,200
be less money that if we put all of this

812
00:39:34,200 --> 00:39:36,240
if we change the logs if we put extra

813
00:39:36,240 --> 00:39:37,980
save words if we put software

814
00:39:37,980 --> 00:39:40,619
protections and at the end well you can

815
00:39:40,619 --> 00:39:43,619
do much with that you can just recommend

816
00:39:43,619 --> 00:39:46,200
to the financial institutions but at the

817
00:39:46,200 --> 00:39:47,700
end they are going to decide they are

818
00:39:47,700 --> 00:39:51,420
going to do their their assessment

819
00:39:51,420 --> 00:39:55,579
um well normally that's the way they go

820
00:39:55,579 --> 00:39:59,339
so at the end is there a methodology for

821
00:39:59,339 --> 00:40:01,560
ATM penetration tests

822
00:40:01,560 --> 00:40:04,740
um node that I have found I'm working in

823
00:40:04,740 --> 00:40:05,640
one

824
00:40:05,640 --> 00:40:09,000
uh this is just like a draft that I'm

825
00:40:09,000 --> 00:40:11,339
working

826
00:40:11,339 --> 00:40:13,099
um but I'm doing like a markdown

827
00:40:13,099 --> 00:40:15,900
complete uh

828
00:40:15,900 --> 00:40:18,900
methodology with test cases and how to

829
00:40:18,900 --> 00:40:22,260
do each one of those with examples and

830
00:40:22,260 --> 00:40:23,420
all of those

831
00:40:23,420 --> 00:40:27,720
I haven't finished but I will want to do

832
00:40:27,720 --> 00:40:31,079
to have like this uh you know normal

833
00:40:31,079 --> 00:40:34,440
awesome ATM teaches that we see in

834
00:40:34,440 --> 00:40:36,119
GitHub

835
00:40:36,119 --> 00:40:37,500
um

836
00:40:37,500 --> 00:40:39,079
um put it there for the community

837
00:40:39,079 --> 00:40:42,240
because that's something that I haven't

838
00:40:42,240 --> 00:40:44,940
found normally there are there is

839
00:40:44,940 --> 00:40:47,400
information about ATMs yeah but normally

840
00:40:47,400 --> 00:40:51,240
it's about security researches that they

841
00:40:51,240 --> 00:40:53,400
found something that is uh sometimes

842
00:40:53,400 --> 00:40:58,440
really Advanced or just normal topics

843
00:40:58,440 --> 00:41:01,260
um or sometimes about these associations

844
00:41:01,260 --> 00:41:04,920
that is your that is just garbage

845
00:41:04,920 --> 00:41:05,579
um

846
00:41:05,579 --> 00:41:08,400
but at the end what I would like to have

847
00:41:08,400 --> 00:41:10,920
is a methodology for penetration testers

848
00:41:10,920 --> 00:41:14,099
that they can follow and see hey I want

849
00:41:14,099 --> 00:41:16,020
I have this ATM what I need to do

850
00:41:16,020 --> 00:41:18,839
because I have been there I have faced

851
00:41:18,839 --> 00:41:22,260
the ATM and have uh and say hey I don't

852
00:41:22,260 --> 00:41:24,060
know what you do this is a really

853
00:41:24,060 --> 00:41:25,800
strange machine and I don't know what to

854
00:41:25,800 --> 00:41:28,320
do at the end um I'm not talking about

855
00:41:28,320 --> 00:41:31,020
I'm going to show you how to do a

856
00:41:31,020 --> 00:41:33,420
jackpoting and we have a lot of videos

857
00:41:33,420 --> 00:41:37,320
of that of another person's I have done

858
00:41:37,320 --> 00:41:39,960
that yes yes but that's not the point

859
00:41:39,960 --> 00:41:43,440
here the point is how to assess an ATM

860
00:41:43,440 --> 00:41:45,300
to perform

861
00:41:45,300 --> 00:41:45,960
um

862
00:41:45,960 --> 00:41:48,300
an integral test for a financial

863
00:41:48,300 --> 00:41:51,240
institution so you can do a report and

864
00:41:51,240 --> 00:41:55,459
and deliver to to your client

865
00:41:56,520 --> 00:41:57,960
so

866
00:41:57,960 --> 00:42:00,000
talking about tooling

867
00:42:00,000 --> 00:42:02,040
we have this

868
00:42:02,040 --> 00:42:04,740
um this is my portable kit as I told you

869
00:42:04,740 --> 00:42:07,680
uh you have to see what you can

870
00:42:07,680 --> 00:42:11,820
um bring depending to the country I have

871
00:42:11,820 --> 00:42:14,960
worked a lot of in Latin America

872
00:42:14,960 --> 00:42:18,180
uh and sometimes well I I can bring all

873
00:42:18,180 --> 00:42:19,260
of those

874
00:42:19,260 --> 00:42:20,119
um

875
00:42:20,119 --> 00:42:24,240
bigs um because sometimes it's illegal

876
00:42:24,240 --> 00:42:27,000
indeed in Mexico where I am from the

877
00:42:27,000 --> 00:42:28,920
position of those are illegal

878
00:42:28,920 --> 00:42:33,599
but I have to have it uh but yeah those

879
00:42:33,599 --> 00:42:36,000
are some of my tooling for hit attacks

880
00:42:36,000 --> 00:42:38,220
for networking

881
00:42:38,220 --> 00:42:41,000
um screwdrivers cables raspberry

882
00:42:41,000 --> 00:42:46,440
keyboard a mouse uh I have found that

883
00:42:46,440 --> 00:42:48,560
sometimes when I forgot something

884
00:42:48,560 --> 00:42:51,960
the most uh unnecessary thing that you

885
00:42:51,960 --> 00:42:55,020
maybe think that is I will have to go

886
00:42:55,020 --> 00:42:58,380
into a local store a store and budget

887
00:42:58,380 --> 00:43:01,319
and as I told you we have Sometimes some

888
00:43:01,319 --> 00:43:05,000
improvised tools uh like cloth hangers

889
00:43:05,000 --> 00:43:08,220
uh we have sometimes used this to open

890
00:43:08,220 --> 00:43:12,000
an ATM you don't even need the key or

891
00:43:12,000 --> 00:43:16,020
those uh lock picks to open it uh and

892
00:43:16,020 --> 00:43:18,480
the last three ones that is tape

893
00:43:18,480 --> 00:43:22,619
cardboard and magnets uh we created this

894
00:43:22,619 --> 00:43:26,160
Tool uh as you can see the red one is

895
00:43:26,160 --> 00:43:29,579
the cardboard the tape and the circle is

896
00:43:29,579 --> 00:43:32,579
the magnet and we use it to do something

897
00:43:32,579 --> 00:43:36,020
and I'm gonna show you what

898
00:43:36,020 --> 00:43:40,020
here I use set the cardboard to open the

899
00:43:40,020 --> 00:43:42,180
ATM I don't have a key I don't have

900
00:43:42,180 --> 00:43:45,839
locks and now I'm using the magnet

901
00:43:45,839 --> 00:43:48,720
to bypass the sensor

902
00:43:48,720 --> 00:43:53,119
so just with cardboard tape and magnet

903
00:43:53,119 --> 00:43:56,339
and this was one rule one one tool to

904
00:43:56,339 --> 00:43:59,460
room them all and this was just one ATM

905
00:43:59,460 --> 00:44:02,940
one specific xtm that the lock was

906
00:44:02,940 --> 00:44:07,140
opened in the upside of the ATM so you

907
00:44:07,140 --> 00:44:10,700
just need to push that part of the lock

908
00:44:10,700 --> 00:44:13,020
the key just

909
00:44:13,020 --> 00:44:17,700
um was moving that part so I use the the

910
00:44:17,700 --> 00:44:21,180
cardboard just to push it and then the

911
00:44:21,180 --> 00:44:25,200
magnet uh I just bought a lamp that was

912
00:44:25,200 --> 00:44:29,220
having a magnet and I use it to bypass

913
00:44:29,220 --> 00:44:31,020
the sensor and the alarm wasn't

914
00:44:31,020 --> 00:44:33,480
triggered

915
00:44:33,480 --> 00:44:34,500
so

916
00:44:34,500 --> 00:44:38,700
at the end is jackpot in the main goal

917
00:44:38,700 --> 00:44:43,800
um for example one time uh

918
00:44:43,800 --> 00:44:46,920
I was doing a Pinterest uh

919
00:44:46,920 --> 00:44:50,040
and an external apprentice and what I

920
00:44:50,040 --> 00:44:54,300
found is that they had an explosive RDP

921
00:44:54,300 --> 00:44:57,200
service that who with uh weak password

922
00:44:57,200 --> 00:45:01,800
so I was able to get into that uh

923
00:45:01,800 --> 00:45:03,720
Windows server

924
00:45:03,720 --> 00:45:06,599
system and from there I start to do a

925
00:45:06,599 --> 00:45:09,119
normal pen test the network expectation

926
00:45:09,119 --> 00:45:11,660
that was a flattened network with Legacy

927
00:45:11,660 --> 00:45:14,339
protocols I know you will know where I'm

928
00:45:14,339 --> 00:45:18,119
going so from there I was able to get

929
00:45:18,119 --> 00:45:21,540
passwords from memory a lot of passwords

930
00:45:21,540 --> 00:45:24,180
from there I start to pee boat I found

931
00:45:24,180 --> 00:45:28,260
the ATM network and at the end I learned

932
00:45:28,260 --> 00:45:30,660
into an ATM

933
00:45:30,660 --> 00:45:33,079
um from that ATM I was able to Jackpot

934
00:45:33,079 --> 00:45:36,180
remotely because

935
00:45:36,180 --> 00:45:38,940
I knew how to do it I I had my own

936
00:45:38,940 --> 00:45:43,560
binary to do it but at the end um that

937
00:45:43,560 --> 00:45:46,260
that didn't make any sense so that was

938
00:45:46,260 --> 00:45:48,420
in another country and this ATM was

939
00:45:48,420 --> 00:45:52,020
places in Central America doesn't make

940
00:45:52,020 --> 00:45:54,300
any sense for the financial institution

941
00:45:54,300 --> 00:45:57,900
that didn't add any value I told them

942
00:45:57,900 --> 00:46:01,020
yeah I was able to Jackpot this

943
00:46:01,020 --> 00:46:04,680
and what I did maybe was worse than what

944
00:46:04,680 --> 00:46:08,819
I offered to them because I

945
00:46:08,819 --> 00:46:11,700
I in some ATM

946
00:46:11,700 --> 00:46:15,720
just one bill was dispensed into the

947
00:46:15,720 --> 00:46:20,359
ground but uh the balance in the ATM now

948
00:46:20,359 --> 00:46:24,119
didn't match so that was a thing for for

949
00:46:24,119 --> 00:46:25,980
the final institution even though I

950
00:46:25,980 --> 00:46:28,020
reported and all that stuff and that

951
00:46:28,020 --> 00:46:30,359
wasn't a problem but that was that

952
00:46:30,359 --> 00:46:33,420
didn't make sense so for the institution

953
00:46:33,420 --> 00:46:36,240
they needed to hey how can I protect my

954
00:46:36,240 --> 00:46:39,960
ATMs they didn't know hey you caused a

955
00:46:39,960 --> 00:46:42,720
problem because now my balance uh

956
00:46:42,720 --> 00:46:45,540
doesn't match you know

957
00:46:45,540 --> 00:46:48,300
so at the end

958
00:46:48,300 --> 00:46:51,480
um as I told you these are like the

959
00:46:51,480 --> 00:46:54,900
layers that I try to cover so oh sorry

960
00:46:54,900 --> 00:46:56,940
this is in Spanish sorry sorry about

961
00:46:56,940 --> 00:46:59,640
that I didn't change that slide but it's

962
00:46:59,640 --> 00:47:02,400
the environment the physical

963
00:47:02,400 --> 00:47:05,700
um layer the network layer and the

964
00:47:05,700 --> 00:47:07,619
application layer

965
00:47:07,619 --> 00:47:08,940
so

966
00:47:08,940 --> 00:47:10,859
the conclusions

967
00:47:10,859 --> 00:47:13,380
is that performing an ATM penetration

968
00:47:13,380 --> 00:47:16,380
test is an integral test which involves

969
00:47:16,380 --> 00:47:18,540
several layers

970
00:47:18,540 --> 00:47:20,460
um you have to consider all the tools

971
00:47:20,460 --> 00:47:23,280
that you will use and you have to verify

972
00:47:23,280 --> 00:47:24,619
their

973
00:47:24,619 --> 00:47:27,839
legitimacy depending on the country that

974
00:47:27,839 --> 00:47:31,619
you will perform the the test

975
00:47:31,619 --> 00:47:34,980
you should never perform a jackpot in

976
00:47:34,980 --> 00:47:37,500
attack without prior prior authorization

977
00:47:37,500 --> 00:47:40,500
of the banks because the balance as I

978
00:47:40,500 --> 00:47:43,680
told you on the logs will mismatch and

979
00:47:43,680 --> 00:47:47,040
that's really uh one thing for the

980
00:47:47,040 --> 00:47:49,140
financial institution and I told you

981
00:47:49,140 --> 00:47:52,980
that will make really angry the banks

982
00:47:52,980 --> 00:47:54,960
because it's a lot of

983
00:47:54,960 --> 00:47:58,380
um a trouble I have work in the bank and

984
00:47:58,380 --> 00:48:01,819
it's something big

985
00:48:01,920 --> 00:48:04,980
um jackpoting at the end it's never the

986
00:48:04,980 --> 00:48:09,540
goal for us as penetration testers

987
00:48:09,540 --> 00:48:13,380
um because we are there to prevent the

988
00:48:13,380 --> 00:48:17,940
cyber crime to perform the jackpoting

989
00:48:17,940 --> 00:48:21,180
um Linux in an ATM yeah it's a finding

990
00:48:21,180 --> 00:48:24,119
but never is the goal of the test

991
00:48:24,119 --> 00:48:27,540
and at the end the financial institution

992
00:48:27,540 --> 00:48:29,460
and the Consultants are from the same

993
00:48:29,460 --> 00:48:31,800
team and the key is going to be

994
00:48:31,800 --> 00:48:34,440
communication content communication for

995
00:48:34,440 --> 00:48:36,420
a success successful ATM penetration

996
00:48:36,420 --> 00:48:38,700
test so sometimes what happens is that

997
00:48:38,700 --> 00:48:41,220
when I'm doing a penetration test with

998
00:48:41,220 --> 00:48:44,160
really good physical security and for

999
00:48:44,160 --> 00:48:46,740
example I can open it I don't stop there

1000
00:48:46,740 --> 00:48:49,740
I go to the financial institution and

1001
00:48:49,740 --> 00:48:52,079
let's say hey I wasn't able to open

1002
00:48:52,079 --> 00:48:54,240
because these this this and this I have

1003
00:48:54,240 --> 00:48:56,960
already accessed the environment your

1004
00:48:56,960 --> 00:49:00,240
how its place and the cables and all

1005
00:49:00,240 --> 00:49:03,060
that stuff but now to perform the next

1006
00:49:03,060 --> 00:49:05,339
layer of the assessment I need you to

1007
00:49:05,339 --> 00:49:08,940
open then I will write down this in the

1008
00:49:08,940 --> 00:49:11,520
report I will say you have this good

1009
00:49:11,520 --> 00:49:15,780
security uh in the physics I will write

1010
00:49:15,780 --> 00:49:19,380
about the the environment but uh now I

1011
00:49:19,380 --> 00:49:22,200
will try to assess the network and

1012
00:49:22,200 --> 00:49:26,099
application layers and sometimes uh yeah

1013
00:49:26,099 --> 00:49:28,500
they opened it and I found that they

1014
00:49:28,500 --> 00:49:29,720
have bad

1015
00:49:29,720 --> 00:49:32,579
protocols or the hard drive isn't

1016
00:49:32,579 --> 00:49:34,619
encrypted and those are high findings

1017
00:49:34,619 --> 00:49:36,960
and they will say hey but yeah I have to

1018
00:49:36,960 --> 00:49:40,260
open uh we are going to discuss yeah but

1019
00:49:40,260 --> 00:49:42,780
at the end an attacker is not going to

1020
00:49:42,780 --> 00:49:44,819
care about that they are going to come

1021
00:49:44,819 --> 00:49:47,280
with tools with heavy tools they are

1022
00:49:47,280 --> 00:49:48,359
going to open it they are going to

1023
00:49:48,359 --> 00:49:50,700
destroy your ATM and they are going to

1024
00:49:50,700 --> 00:49:52,140
steal your hard drive and they are going

1025
00:49:52,140 --> 00:49:54,119
to steal all of your information so

1026
00:49:54,119 --> 00:49:56,520
that's one thing you the communication

1027
00:49:56,520 --> 00:49:58,579
with the institution is going to be key

1028
00:49:58,579 --> 00:50:01,740
and you have to keep moving with the

1029
00:50:01,740 --> 00:50:05,400
layers of the test

1030
00:50:05,400 --> 00:50:07,099
um yeah that's it

1031
00:50:07,099 --> 00:50:10,760
so thank you Hector

1032
00:50:12,200 --> 00:50:15,420
so any questions for Hector this couple

1033
00:50:15,420 --> 00:50:17,660
here

1034
00:50:20,599 --> 00:50:22,859
yeah they are going to be posting the

1035
00:50:22,859 --> 00:50:24,119
Discord Channel

1036
00:50:24,119 --> 00:50:26,460
oh yeah for all talks the slide should

1037
00:50:26,460 --> 00:50:28,260
be posted they are not right now but

1038
00:50:28,260 --> 00:50:29,760
keep checking back

1039
00:50:29,760 --> 00:50:32,300
yes

1040
00:50:43,160 --> 00:50:45,900
uh I really hope this year

1041
00:50:45,900 --> 00:50:47,880
that I have been working in this app

1042
00:50:47,880 --> 00:50:50,880
because it's not only about offensive I

1043
00:50:50,880 --> 00:50:52,680
have been gathering information about

1044
00:50:52,680 --> 00:50:55,619
forensic and trade hunting

1045
00:50:55,619 --> 00:50:58,200
um artifacts because sometimes what I

1046
00:50:58,200 --> 00:51:00,960
have fun is that for example if you land

1047
00:51:00,960 --> 00:51:05,460
into a network of ATM or whatever and

1048
00:51:05,460 --> 00:51:06,920
you want to

1049
00:51:06,920 --> 00:51:11,760
know if one computer is an ATM uh I I

1050
00:51:11,760 --> 00:51:14,819
want to have some artifacts to see a

1051
00:51:14,819 --> 00:51:15,780
specific

1052
00:51:15,780 --> 00:51:18,599
information if this is an ATM which

1053
00:51:18,599 --> 00:51:20,579
brand which model there is not enough

1054
00:51:20,579 --> 00:51:23,339
information of that so I'm trying to

1055
00:51:23,339 --> 00:51:24,780
gather all of that information not only

1056
00:51:24,780 --> 00:51:26,880
for offensive but for forensics and also

1057
00:51:26,880 --> 00:51:29,040
For Thread hunting so I'm working on

1058
00:51:29,040 --> 00:51:31,619
that but it's a lot of information but

1059
00:51:31,619 --> 00:51:33,720
I'm trying to do this you're

1060
00:51:33,720 --> 00:51:36,000
for those on the feed the question was

1061
00:51:36,000 --> 00:51:38,640
when is it going to be ready when is it

1062
00:51:38,640 --> 00:51:40,200
going to be done and the answer I

1063
00:51:40,200 --> 00:51:43,859
believe is real soon now okay

1064
00:51:43,859 --> 00:51:46,700
any questions

1065
00:51:51,839 --> 00:51:54,660
um never I never get destructive

1066
00:51:54,660 --> 00:51:57,420
um the only time that I have done that

1067
00:51:57,420 --> 00:52:01,440
it's on the logs that have been tubular

1068
00:52:01,440 --> 00:52:04,740
because I have never tested before and

1069
00:52:04,740 --> 00:52:08,059
when I was able to lock it to open it

1070
00:52:08,059 --> 00:52:12,720
I saw that those Peaks those looks uh

1071
00:52:12,720 --> 00:52:15,660
like were disarmed and I wasn't able to

1072
00:52:15,660 --> 00:52:18,359
put it back like release it was really

1073
00:52:18,359 --> 00:52:20,940
really hard so I will just say if you

1074
00:52:20,940 --> 00:52:24,300
found those tubular locks be careful

1075
00:52:24,300 --> 00:52:26,099
with that because sometimes

1076
00:52:26,099 --> 00:52:27,680
if you

1077
00:52:27,680 --> 00:52:32,520
take off the the the Peaks uh maybe you

1078
00:52:32,520 --> 00:52:36,079
will won't be able to put it back

1079
00:52:37,740 --> 00:52:41,099
Hector so I was multitasking while you

1080
00:52:41,099 --> 00:52:43,740
were talking and I found the

1081
00:52:43,740 --> 00:52:47,460
availability of xfs simulators that you

1082
00:52:47,460 --> 00:52:49,200
can buy so there are actually ATM

1083
00:52:49,200 --> 00:52:52,440
simulators that you can buy are they

1084
00:52:52,440 --> 00:52:54,240
expensive have you used anything like

1085
00:52:54,240 --> 00:52:56,819
that to write malware to help you in

1086
00:52:56,819 --> 00:53:00,720
your pen testing work uh no I have never

1087
00:53:00,720 --> 00:53:03,900
used it but uh

1088
00:53:03,900 --> 00:53:06,720
um sometimes you can buy an ATM

1089
00:53:06,720 --> 00:53:08,460
please easier

1090
00:53:08,460 --> 00:53:10,740
so so buying the hardware is easier than

1091
00:53:10,740 --> 00:53:12,420
buying the simulation software Yeah

1092
00:53:12,420 --> 00:53:15,300
because sometimes uh ATMs

1093
00:53:15,300 --> 00:53:17,480
um it's legal to budget in some places

1094
00:53:17,480 --> 00:53:20,099
uh because they are not being used by

1095
00:53:20,099 --> 00:53:24,559
the institutions anymore so yeah

1096
00:53:24,900 --> 00:53:28,099
all right thank you very much

