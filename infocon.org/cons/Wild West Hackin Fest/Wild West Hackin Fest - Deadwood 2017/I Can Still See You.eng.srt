1
00:00:00,570 --> 00:00:15,459
[Music]

2
00:00:11,160 --> 00:00:18,790
all the attendees<font color="#E5E5E5"> who apparently were</font>

3
00:00:15,459 --> 00:00:20,170
<font color="#E5E5E5">we're inclined to decode some hex to</font>

4
00:00:18,790 --> 00:00:23,890
figure out whether or not this is<font color="#CCCCCC"> the</font>

5
00:00:20,170 --> 00:00:25,570
room<font color="#CCCCCC"> for you I think maybe next year</font>

6
00:00:23,890 --> 00:00:28,360
I'll just go<font color="#CCCCCC"> ahead and put the title of</font>

7
00:00:25,570 --> 00:00:33,340
<font color="#E5E5E5">my talk in ASCII and more</font><font color="#CCCCCC"> people will</font>

8
00:00:28,360 --> 00:00:37,870
show up<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so if you didn't</font>

9
00:00:33,340 --> 00:00:46,810
decode it I'll decode it<font color="#CCCCCC"> for you it's</font>

10
00:00:37,870 --> 00:00:49,149
<font color="#E5E5E5">not terribly Trixie here's why</font>

11
00:00:46,810 --> 00:00:51,750
sure enough shameless plug<font color="#E5E5E5"> there will be</font>

12
00:00:49,149 --> 00:00:51,750
one<font color="#E5E5E5"> more of those</font>

13
00:00:52,110 --> 00:00:59,050
so a quick<font color="#E5E5E5"> Who am I I decided the</font><font color="#CCCCCC"> the</font>

14
00:00:56,170 --> 00:01:03,070
simplest way to say Who am I is with the

15
00:00:59,050 --> 00:01:04,449
built-in command<font color="#CCCCCC"> Who am i right</font><font color="#E5E5E5"> so I'm</font>

16
00:01:03,070 --> 00:01:06,670
not<font color="#CCCCCC"> gonna go into a lot of detail about</font>

17
00:01:04,449 --> 00:01:09,280
<font color="#CCCCCC">Who I am you guys all got the googles</font>

18
00:01:06,670 --> 00:01:12,459
you can figure it<font color="#E5E5E5"> out but if I say Who</font>

19
00:01:09,280 --> 00:01:14,619
am<font color="#E5E5E5"> I groups we can see some abbreviated</font>

20
00:01:12,459 --> 00:01:17,560
output from<font color="#E5E5E5"> this command I am</font><font color="#CCCCCC"> of course</font>

21
00:01:14,619 --> 00:01:20,770
<font color="#CCCCCC">a member</font><font color="#E5E5E5"> of the mandatory and</font><font color="#CCCCCC"> AM enabled</font>

22
00:01:17,560 --> 00:01:23,679
everyone group<font color="#CCCCCC"> as we all are</font><font color="#E5E5E5"> right also</font>

23
00:01:20,770 --> 00:01:27,179
<font color="#CCCCCC">a</font><font color="#E5E5E5"> member of J Hamm Corp group which is</font>

24
00:01:23,679 --> 00:01:30,369
an optional group but enabled by default

25
00:01:27,179 --> 00:01:32,979
<font color="#E5E5E5">I'm a member of the SANS Institute group</font>

26
00:01:30,369 --> 00:01:37,840
<font color="#E5E5E5">as a certified instructor also optional</font>

27
00:01:32,979 --> 00:01:39,908
disabled by default and finally I

28
00:01:37,840 --> 00:01:42,549
remember the author<font color="#CCCCCC"> group</font><font color="#E5E5E5"> for Network</font>

29
00:01:39,909 --> 00:01:45,939
forensics<font color="#E5E5E5"> it's also an optional group</font><font color="#CCCCCC"> j</font>

30
00:01:42,549 --> 00:01:48,130
<font color="#CCCCCC">j strand has read</font><font color="#E5E5E5"> I'm not sure</font><font color="#CCCCCC"> whatever</font>

31
00:01:45,939 --> 00:01:50,919
members of this group there are but

32
00:01:48,130 --> 00:01:54,699
actually<font color="#CCCCCC"> that's optional group for read</font>

33
00:01:50,919 --> 00:01:59,499
then finally what privileges do I have

34
00:01:54,700 --> 00:02:00,880
who am i<font color="#E5E5E5"> /</font><font color="#CCCCCC"> Prive</font><font color="#E5E5E5"> let's see the</font><font color="#CCCCCC"> SE</font><font color="#E5E5E5"> debug</font>

35
00:01:59,499 --> 00:02:03,520
privilege you guys should all<font color="#CCCCCC"> know this</font>

36
00:02:00,880 --> 00:02:04,899
one<font color="#E5E5E5"> right right</font><font color="#CCCCCC"> i renamed the</font>

37
00:02:03,520 --> 00:02:06,459
description<font color="#E5E5E5"> that's the understand what</font>

38
00:02:04,899 --> 00:02:11,110
relic did just now group<font color="#E5E5E5"> and for me that</font>

39
00:02:06,459 --> 00:02:12,910
is disabled that<font color="#E5E5E5"> is disabled also the SE</font>

40
00:02:11,110 --> 00:02:15,850
<font color="#CCCCCC">stun hacking privilege which i</font><font color="#E5E5E5"> invented</font>

41
00:02:12,910 --> 00:02:16,480
to impress all<font color="#CCCCCC"> of you with my wicked</font>

42
00:02:15,850 --> 00:02:19,120
<font color="#CCCCCC">stunts</font>

43
00:02:16,480 --> 00:02:21,909
<font color="#E5E5E5">King skills that for me is also disabled</font>

44
00:02:19,120 --> 00:02:24,190
<font color="#CCCCCC">I also do not have the rocket</font><font color="#E5E5E5"> server</font>

45
00:02:21,909 --> 00:02:27,280
surgery privilege for performing

46
00:02:24,190 --> 00:02:30,280
impossible feats<font color="#E5E5E5"> but I do have the</font><font color="#CCCCCC"> C</font>

47
00:02:27,280 --> 00:02:33,760
packets privilege<font color="#CCCCCC"> I do have the C</font>

48
00:02:30,280 --> 00:02:36,160
badguys privilege and I do have the blue

49
00:02:33,760 --> 00:02:38,290
team<font color="#E5E5E5"> privilege so these are the</font>

50
00:02:36,160 --> 00:02:41,220
privileges<font color="#E5E5E5"> I have thank you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> we not</font>

51
00:02:38,290 --> 00:02:44,140
all stunt hackers here this week

52
00:02:41,220 --> 00:02:48,549
good good good<font color="#E5E5E5"> now as long as we're</font>

53
00:02:44,140 --> 00:02:52,420
talking<font color="#CCCCCC"> about the Who am i</font><font color="#E5E5E5"> /</font><font color="#CCCCCC"> Prive</font><font color="#E5E5E5"> who</font>

54
00:02:48,549 --> 00:02:55,690
<font color="#E5E5E5">am</font><font color="#CCCCCC"> i that command</font><font color="#E5E5E5"> is only</font><font color="#CCCCCC"> run by a</font>

55
00:02:52,420 --> 00:02:58,569
couple<font color="#E5E5E5"> of different kinds</font><font color="#CCCCCC"> of people</font><font color="#E5E5E5"> sis</font>

56
00:02:55,690 --> 00:03:02,579
admins who are lost in shell<font color="#E5E5E5"> among shell</font>

57
00:02:58,569 --> 00:03:05,230
<font color="#CCCCCC">amongst shell</font><font color="#E5E5E5"> and who else says Who am I</font>

58
00:03:02,579 --> 00:03:08,109
who else<font color="#E5E5E5"> apparently whoever hacked</font>

59
00:03:05,230 --> 00:03:11,200
Equifax because reports have it that<font color="#CCCCCC"> the</font>

60
00:03:08,109 --> 00:03:13,269
<font color="#CCCCCC">xxx web shells that they</font><font color="#E5E5E5"> popped</font><font color="#CCCCCC"> xxx web</font>

61
00:03:11,200 --> 00:03:16,018
shells<font color="#E5E5E5"> that's a way to do persistence</font>

62
00:03:13,269 --> 00:03:18,670
isn't it lose the shell pop a new one

63
00:03:16,019 --> 00:03:22,359
<font color="#E5E5E5">but if these</font><font color="#CCCCCC"> xxx web shells that got</font>

64
00:03:18,670 --> 00:03:24,730
popped<font color="#E5E5E5"> all of them the very first</font>

65
00:03:22,359 --> 00:03:26,530
command executed was<font color="#CCCCCC"> Who am</font><font color="#E5E5E5"> I</font>

66
00:03:24,730 --> 00:03:30,160
because you pop<font color="#E5E5E5"> a shell and</font><font color="#CCCCCC"> you got to</font>

67
00:03:26,530 --> 00:03:32,470
figure<font color="#E5E5E5"> out what privily</font><font color="#CCCCCC"> / proved</font><font color="#E5E5E5"> what I</font>

68
00:03:30,160 --> 00:03:34,260
just used to<font color="#E5E5E5"> show you my privileges is</font>

69
00:03:32,470 --> 00:03:36,609
what they use to<font color="#E5E5E5"> figure out their own</font>

70
00:03:34,260 --> 00:03:41,250
<font color="#E5E5E5">and there's a reason why the title says</font>

71
00:03:36,609 --> 00:03:45,459
pipe<font color="#E5E5E5"> output to call</font><font color="#CCCCCC"> Congress because if</font>

72
00:03:41,250 --> 00:03:47,829
Equifax had merely had the auditing of

73
00:03:45,459 --> 00:03:50,349
<font color="#E5E5E5">the Who am I command turned on to see</font>

74
00:03:47,829 --> 00:03:53,739
event 46 88 and the<font color="#CCCCCC"> windows event logs</font>

75
00:03:50,349 --> 00:03:57,160
<font color="#E5E5E5">centralized aggregated correlated and</font>

76
00:03:53,739 --> 00:03:58,569
detected they would have<font color="#E5E5E5"> seen every</font>

77
00:03:57,160 --> 00:04:04,410
single<font color="#CCCCCC"> one of</font><font color="#E5E5E5"> those web shells</font>

78
00:03:58,569 --> 00:04:06,268
immediately this<font color="#CCCCCC"> does not</font><font color="#E5E5E5"> rocket surgery</font>

79
00:04:04,410 --> 00:04:09,940
<font color="#E5E5E5">turn this on</font>

80
00:04:06,269 --> 00:04:12,340
turn this on<font color="#E5E5E5"> this is just a little</font><font color="#CCCCCC"> a</font>

81
00:04:09,940 --> 00:04:15,340
<font color="#E5E5E5">little spoiler</font><font color="#CCCCCC"> about what this talk is</font>

82
00:04:12,340 --> 00:04:17,889
about look all this<font color="#CCCCCC"> stunt hacking man</font>

83
00:04:15,340 --> 00:04:20,349
you guys on the red team sitting last

84
00:04:17,889 --> 00:04:22,750
night listening to osmosis<font color="#CCCCCC"> tell me about</font>

85
00:04:20,349 --> 00:04:25,390
this<font color="#CCCCCC"> fantastic new thing he'd done</font><font color="#E5E5E5"> with</font>

86
00:04:22,750 --> 00:04:27,159
six different pivots inside one box just

87
00:04:25,390 --> 00:04:29,169
to do a thing<font color="#E5E5E5"> and I said guys you're</font>

88
00:04:27,159 --> 00:04:29,480
trying too hard<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> not that hard it</font>

89
00:04:29,169 --> 00:04:30,979
<font color="#CCCCCC">doesn't</font>

90
00:04:29,480 --> 00:04:35,150
have to be that<font color="#CCCCCC"> hard because on blue</font>

91
00:04:30,980 --> 00:04:39,380
team<font color="#CCCCCC"> this turn on Windows security</font>

92
00:04:35,150 --> 00:04:41,210
auditing<font color="#E5E5E5"> for event 46 88 and Equifax</font>

93
00:04:39,380 --> 00:04:43,490
wouldn't maybe had to have been<font color="#E5E5E5"> sitting</font>

94
00:04:41,210 --> 00:04:47,180
<font color="#CCCCCC">in front of</font><font color="#E5E5E5"> Congress so what's all this</font>

95
00:04:43,490 --> 00:04:48,860
<font color="#CCCCCC">then</font><font color="#E5E5E5"> well this started when strand told</font>

96
00:04:47,180 --> 00:04:51,620
me he was putting<font color="#E5E5E5"> on a con</font>

97
00:04:48,860 --> 00:04:54,590
<font color="#E5E5E5">and I said yay how can I help and he</font>

98
00:04:51,620 --> 00:04:56,960
says you're a speaker<font color="#CCCCCC"> well that's not</font>

99
00:04:54,590 --> 00:04:58,489
that<font color="#E5E5E5"> I was thinking you got water to</font>

100
00:04:56,960 --> 00:05:02,450
carry<font color="#E5E5E5"> I mean what's what has to happen</font>

101
00:04:58,490 --> 00:05:04,490
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right so I decided fine give me all</font>

102
00:05:02,450 --> 00:05:05,659
your bad packets<font color="#E5E5E5"> don't tell me what's in</font>

103
00:05:04,490 --> 00:05:07,460
them<font color="#E5E5E5"> just give me a bunch of bad hack</font>

104
00:05:05,660 --> 00:05:10,280
packets<font color="#E5E5E5"> do your worst</font>

105
00:05:07,460 --> 00:05:12,500
and John strand<font color="#E5E5E5"> says sure black hells</font>

106
00:05:10,280 --> 00:05:16,010
makes the worst packets<font color="#CCCCCC"> they're the very</font>

107
00:05:12,500 --> 00:05:18,350
worst I can<font color="#CCCCCC"> tell you so that's</font><font color="#E5E5E5"> what I</font>

108
00:05:16,010 --> 00:05:19,430
<font color="#CCCCCC">decided I was</font><font color="#E5E5E5"> going to start with so the</font>

109
00:05:18,350 --> 00:05:21,530
staff says well what do you want you

110
00:05:19,430 --> 00:05:23,810
want a full campaign<font color="#E5E5E5"> you want me to</font>

111
00:05:21,530 --> 00:05:26,239
record an entire hack<font color="#E5E5E5"> and and I said not</font>

112
00:05:23,810 --> 00:05:28,970
<font color="#E5E5E5">just do some stuff just</font><font color="#CCCCCC"> do some stuff</font>

113
00:05:26,240 --> 00:05:30,950
<font color="#E5E5E5">but tap the line sniff the switch</font><font color="#CCCCCC"> just</font>

114
00:05:28,970 --> 00:05:33,890
<font color="#E5E5E5">give me the</font><font color="#CCCCCC"> pack of</font><font color="#E5E5E5"> data and I'll tell</font>

115
00:05:30,950 --> 00:05:35,630
you what you did<font color="#CCCCCC"> I said okay here and I</font>

116
00:05:33,890 --> 00:05:37,280
got literally a random box of chocolates

117
00:05:35,630 --> 00:05:39,740
about the<font color="#E5E5E5"> only thing I knew in advance</font>

118
00:05:37,280 --> 00:05:42,919
<font color="#E5E5E5">about what was in these packet caps was</font>

119
00:05:39,740 --> 00:05:46,430
the name<font color="#CCCCCC"> of the P cap</font><font color="#E5E5E5"> like for</font><font color="#CCCCCC"> instance</font>

120
00:05:42,920 --> 00:05:47,930
<font color="#CCCCCC">I chose I chose</font><font color="#E5E5E5"> two of the ones that</font>

121
00:05:46,430 --> 00:05:50,960
I've<font color="#E5E5E5"> been given I got a set of</font><font color="#CCCCCC"> seven I</font>

122
00:05:47,930 --> 00:05:53,090
chose<font color="#E5E5E5"> initial which based on the time</font>

123
00:05:50,960 --> 00:05:54,409
<font color="#E5E5E5">stamps was the first one and then I</font>

124
00:05:53,090 --> 00:05:55,789
chose<font color="#CCCCCC"> another one</font><font color="#E5E5E5"> because it was named</font>

125
00:05:54,410 --> 00:05:58,880
better cap and I thought that might<font color="#CCCCCC"> be</font>

126
00:05:55,790 --> 00:06:01,160
fun<font color="#E5E5E5"> so that's it so what are we gonna</font>

127
00:05:58,880 --> 00:06:03,650
see<font color="#E5E5E5"> analysis all quick and</font><font color="#CCCCCC"> dirty stuff</font><font color="#E5E5E5"> I</font>

128
00:06:01,160 --> 00:06:06,530
did not dive deep I did not use<font color="#E5E5E5"> Splunk</font><font color="#CCCCCC"> I</font>

129
00:06:03,650 --> 00:06:08,780
did not use<font color="#CCCCCC"> sims I did I did not use all</font>

130
00:06:06,530 --> 00:06:11,539
<font color="#CCCCCC">the fancy tools with all the blinking</font>

131
00:06:08,780 --> 00:06:12,979
<font color="#CCCCCC">lights I didn't use any of that no</font>

132
00:06:11,540 --> 00:06:14,780
inspection what was beyond what was

133
00:06:12,980 --> 00:06:17,000
easily instrumented by like say

134
00:06:14,780 --> 00:06:19,729
capturing some packets and running some

135
00:06:17,000 --> 00:06:22,550
tools that<font color="#E5E5E5"> monitor the packets so at</font>

136
00:06:19,730 --> 00:06:24,410
layer<font color="#CCCCCC"> 2 & 3 we got our watch and some</font>

137
00:06:22,550 --> 00:06:26,750
<font color="#E5E5E5">net flow data and</font><font color="#CCCCCC"> that's it at layer 4</font>

138
00:06:24,410 --> 00:06:28,790
yeah I brought<font color="#E5E5E5"> in some snortin bro so a</font>

139
00:06:26,750 --> 00:06:30,620
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> content but only only the</font>

140
00:06:28,790 --> 00:06:32,690
content that<font color="#E5E5E5"> bro by default these are</font>

141
00:06:30,620 --> 00:06:35,420
default<font color="#CCCCCC"> config for bull snort and bro</font>

142
00:06:32,690 --> 00:06:37,550
only<font color="#E5E5E5"> only what they would would normally</font>

143
00:06:35,420 --> 00:06:40,550
catch command line<font color="#E5E5E5"> inspection on</font>

144
00:06:37,550 --> 00:06:43,040
whatever<font color="#CCCCCC"> is captured</font><font color="#E5E5E5"> no fun GUI tools at</font>

145
00:06:40,550 --> 00:06:45,620
all meaning<font color="#CCCCCC"> nothing</font><font color="#E5E5E5"> that</font>

146
00:06:43,040 --> 00:06:48,170
can't be<font color="#E5E5E5"> scripted for immediate</font>

147
00:06:45,620 --> 00:06:50,360
real-time alerting<font color="#E5E5E5"> through if nothing</font>

148
00:06:48,170 --> 00:06:53,000
else syslog aggregation but<font color="#E5E5E5"> no full</font>

149
00:06:50,360 --> 00:06:55,760
content inspection<font color="#CCCCCC"> I resisted</font><font color="#E5E5E5"> the urge</font>

150
00:06:53,000 --> 00:06:57,770
<font color="#CCCCCC">to pull stuff into Wireshark</font><font color="#E5E5E5"> I'd</font>

151
00:06:55,760 --> 00:07:00,050
resisted that<font color="#E5E5E5"> urge but I didn't do it</font>

152
00:06:57,770 --> 00:07:02,000
no no<font color="#E5E5E5"> worth session reconstruction at</font>

153
00:07:00,050 --> 00:07:06,530
all other<font color="#E5E5E5"> than what bro does so here's</font>

154
00:07:02,000 --> 00:07:07,550
my<font color="#CCCCCC"> 2p caps</font><font color="#E5E5E5"> my general methodology start</font>

155
00:07:06,530 --> 00:07:10,250
out<font color="#E5E5E5"> with some initial reconnaissance</font>

156
00:07:07,550 --> 00:07:12,440
that's not just<font color="#E5E5E5"> for Red Team Blue</font><font color="#CCCCCC"> Team</font>

157
00:07:10,250 --> 00:07:15,410
initial reconnaissance<font color="#CCCCCC"> - I want</font><font color="#E5E5E5"> to know</font>

158
00:07:12,440 --> 00:07:17,390
when stuff<font color="#E5E5E5"> starts when it ends</font><font color="#CCCCCC"> I want to</font>

159
00:07:15,410 --> 00:07:19,250
<font color="#E5E5E5">know what kinds of things are</font><font color="#CCCCCC"> involved</font>

160
00:07:17,390 --> 00:07:22,219
what protocols are involved any any

161
00:07:19,250 --> 00:07:24,290
immediate obvious anomalies<font color="#CCCCCC"> that I can</font>

162
00:07:22,220 --> 00:07:27,230
see in the traffic that was<font color="#E5E5E5"> observed and</font>

163
00:07:24,290 --> 00:07:29,810
who's who<font color="#E5E5E5"> who's who's in this recording</font>

164
00:07:27,230 --> 00:07:31,610
of<font color="#E5E5E5"> network</font><font color="#CCCCCC"> activity right</font><font color="#E5E5E5"> so then any</font>

165
00:07:29,810 --> 00:07:33,620
anomalous behavior I would looked at and

166
00:07:31,610 --> 00:07:38,030
look at<font color="#E5E5E5"> and drill down</font><font color="#CCCCCC"> to see who's the</font>

167
00:07:33,620 --> 00:07:40,010
evil<font color="#CCCCCC"> who are they being evil to and did</font>

168
00:07:38,030 --> 00:07:40,940
they propagate but most important<font color="#E5E5E5"> how</font>

169
00:07:40,010 --> 00:07:43,400
did the evil<font color="#E5E5E5"> get there in the first</font>

170
00:07:40,940 --> 00:07:45,469
<font color="#CCCCCC">place if I say an evil host how did it</font>

171
00:07:43,400 --> 00:07:47,090
become evil<font color="#CCCCCC"> I need to know</font><font color="#E5E5E5"> that as an</font>

172
00:07:45,470 --> 00:07:48,950
investigator right and all<font color="#E5E5E5"> of this</font>

173
00:07:47,090 --> 00:07:51,760
around timeline analysis putting all the

174
00:07:48,950 --> 00:07:54,800
events<font color="#CCCCCC"> that I observed into an into an</font>

175
00:07:51,760 --> 00:07:57,530
understandable sequence of events of the

176
00:07:54,800 --> 00:08:02,950
events of interest<font color="#CCCCCC"> all right all right</font>

177
00:07:57,530 --> 00:08:05,960
<font color="#E5E5E5">so</font><font color="#CCCCCC"> here's</font><font color="#E5E5E5"> my recon on initial pcap okay</font>

178
00:08:02,950 --> 00:08:07,370
so Trixie<font color="#CCCCCC"> I ran</font><font color="#E5E5E5"> cap infos on it to see</font>

179
00:08:05,960 --> 00:08:10,280
when it<font color="#E5E5E5"> started and when it stopped</font>

180
00:08:07,370 --> 00:08:11,510
that's the bounds<font color="#CCCCCC"> for my timeline</font><font color="#E5E5E5"> I know</font>

181
00:08:10,280 --> 00:08:13,760
the<font color="#E5E5E5"> boundaries</font><font color="#CCCCCC"> for when stuff happens</font>

182
00:08:11,510 --> 00:08:16,150
<font color="#E5E5E5">right</font><font color="#CCCCCC"> I know the</font><font color="#E5E5E5"> boundaries for</font><font color="#CCCCCC"> what</font>

183
00:08:13,760 --> 00:08:18,890
<font color="#E5E5E5">happens and then I ran bro on it and</font>

184
00:08:16,150 --> 00:08:20,900
just<font color="#E5E5E5"> in a word count on the con log to</font>

185
00:08:18,890 --> 00:08:23,450
<font color="#CCCCCC">see how</font><font color="#E5E5E5"> many conversations does this</font>

186
00:08:20,900 --> 00:08:26,270
<font color="#CCCCCC">pcap contain</font><font color="#E5E5E5"> so we see about 32,000</font>

187
00:08:23,450 --> 00:08:29,120
conversations in this<font color="#CCCCCC"> pcap all</font><font color="#E5E5E5"> right</font>

188
00:08:26,270 --> 00:08:30,560
what ports are being used on this

189
00:08:29,120 --> 00:08:31,850
<font color="#E5E5E5">network</font><font color="#CCCCCC"> I guess I should have give a</font>

190
00:08:30,560 --> 00:08:33,950
<font color="#E5E5E5">little bit of background about the</font>

191
00:08:31,850 --> 00:08:36,020
network and the activities this<font color="#E5E5E5"> all the</font>

192
00:08:33,950 --> 00:08:38,419
<font color="#E5E5E5">stuff that</font><font color="#CCCCCC"> I'm analyzing was done by</font>

193
00:08:36,020 --> 00:08:41,360
Black Hills<font color="#E5E5E5"> testers in Black Hills</font>

194
00:08:38,419 --> 00:08:43,760
<font color="#E5E5E5">testing lab right so it's it's a it's a</font>

195
00:08:41,360 --> 00:08:45,860
full<font color="#E5E5E5"> windows and environment domain</font>

196
00:08:43,760 --> 00:08:48,350
controllers the whole bit with normal

197
00:08:45,860 --> 00:08:50,150
stuff going on and as we'll see some

198
00:08:48,350 --> 00:08:52,010
abnormal stuff going on<font color="#E5E5E5"> because hey</font>

199
00:08:50,150 --> 00:08:52,520
that's that's where<font color="#E5E5E5"> Black Hills testers</font>

200
00:08:52,010 --> 00:08:55,120
live

201
00:08:52,520 --> 00:08:56,899
that's who brought me this stuff so I

202
00:08:55,120 --> 00:08:58,279
<font color="#E5E5E5">count out the con law</font>

203
00:08:56,899 --> 00:09:00,680
send it through broke up looking just

204
00:08:58,279 --> 00:09:04,430
<font color="#E5E5E5">for the responding port sorting them by</font>

205
00:09:00,680 --> 00:09:06,050
<font color="#E5E5E5">unique</font><font color="#CCCCCC"> count</font><font color="#E5E5E5"> and what's the number first</font>

206
00:09:04,430 --> 00:09:09,229
<font color="#E5E5E5">we're on the head</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> of 32</font>

207
00:09:06,050 --> 00:09:12,859
conversations<font color="#E5E5E5"> more than</font><font color="#CCCCCC"> 13,000</font><font color="#E5E5E5"> of them</font>

208
00:09:09,230 --> 00:09:13,999
are to port 5000<font color="#E5E5E5"> what's port 5000 anyone</font>

209
00:09:12,860 --> 00:09:17,779
know off the<font color="#E5E5E5"> top</font><font color="#CCCCCC"> your head what's port</font>

210
00:09:13,999 --> 00:09:20,779
5000 nobody you know<font color="#CCCCCC"> you</font><font color="#E5E5E5"> don't know what</font>

211
00:09:17,779 --> 00:09:22,759
service is assigned<font color="#E5E5E5"> to port 5000 evil</font>

212
00:09:20,779 --> 00:09:26,269
<font color="#E5E5E5">evil was going to be on what's on port</font>

213
00:09:22,759 --> 00:09:35,720
5000 every time it's gonna be evil<font color="#CCCCCC"> I had</font>

214
00:09:26,269 --> 00:09:38,959
<font color="#E5E5E5">I ran one command and found evil okay so</font>

215
00:09:35,720 --> 00:09:40,009
then I<font color="#E5E5E5"> think well okay who's listening</font>

216
00:09:38,959 --> 00:09:41,748
on evil

217
00:09:40,009 --> 00:09:44,329
so another broke out of<font color="#E5E5E5"> the con log</font>

218
00:09:41,749 --> 00:09:45,800
looking now at the responding host along

219
00:09:44,329 --> 00:09:49,069
with the responding<font color="#E5E5E5"> port</font><font color="#CCCCCC"> rapping out my</font>

220
00:09:45,800 --> 00:09:52,160
port sorting there's one this one guy

221
00:09:49,069 --> 00:09:56,209
that's it just<font color="#E5E5E5"> one</font><font color="#CCCCCC"> guy listen on port</font>

222
00:09:52,160 --> 00:09:58,040
5000 accounts for more for almost half

223
00:09:56,209 --> 00:10:00,709
<font color="#E5E5E5">of the conversations have I found</font>

224
00:09:58,040 --> 00:10:01,309
anomalous<font color="#CCCCCC"> I found evil in three easy</font>

225
00:10:00,709 --> 00:10:04,638
steps

226
00:10:01,309 --> 00:10:07,449
there we have right<font color="#CCCCCC"> now</font>

227
00:10:04,639 --> 00:10:10,279
if there's somebody listening on port

228
00:10:07,449 --> 00:10:13,128
5000 then there's somebody<font color="#CCCCCC"> trying to</font>

229
00:10:10,279 --> 00:10:15,620
talk to that guy<font color="#CCCCCC"> on</font><font color="#E5E5E5"> five thousand that's</font>

230
00:10:13,129 --> 00:10:17,209
probably evil<font color="#E5E5E5"> too right because</font><font color="#CCCCCC"> how else</font>

231
00:10:15,620 --> 00:10:19,670
is somebody gonna be<font color="#E5E5E5"> thinking to be</font>

232
00:10:17,209 --> 00:10:23,300
connecting to port 5000 so another bit

233
00:10:19,670 --> 00:10:25,370
of<font color="#CCCCCC"> bro-cut</font><font color="#E5E5E5"> magic not magic more looking</font>

234
00:10:23,300 --> 00:10:26,990
<font color="#E5E5E5">now at I got a</font><font color="#CCCCCC"> timestamp</font>

235
00:10:25,370 --> 00:10:29,179
I got the source IP source port

236
00:10:26,990 --> 00:10:30,410
destination IP destination port we knew

237
00:10:29,179 --> 00:10:33,499
what that was<font color="#E5E5E5"> going to be that's just</font>

238
00:10:30,410 --> 00:10:35,420
<font color="#CCCCCC">for my grepping</font><font color="#E5E5E5"> and then the number</font><font color="#CCCCCC"> of</font>

239
00:10:33,499 --> 00:10:36,679
bytes in either direction originating<font color="#CCCCCC"> a</font>

240
00:10:35,420 --> 00:10:39,259
destination<font color="#CCCCCC"> in the state of the</font>

241
00:10:36,679 --> 00:10:42,110
<font color="#E5E5E5">connection and yeah I looked a little</font>

242
00:10:39,259 --> 00:10:45,379
<font color="#E5E5E5">bit more bro data and what do I</font><font color="#CCCCCC"> find</font>

243
00:10:42,110 --> 00:10:48,139
there always gets<font color="#E5E5E5"> for slash login slash</font>

244
00:10:45,379 --> 00:10:54,079
process dot<font color="#CCCCCC"> PHP whereby the server</font>

245
00:10:48,139 --> 00:10:56,959
<font color="#E5E5E5">always says 200</font><font color="#CCCCCC"> okay and that's it</font><font color="#E5E5E5"> 200</font>

246
00:10:54,079 --> 00:10:59,508
<font color="#CCCCCC">okay with nothing to return just okay I</font>

247
00:10:56,959 --> 00:11:02,239
heard<font color="#CCCCCC"> you and that</font><font color="#E5E5E5"> was it</font><font color="#CCCCCC"> so it would</font>

248
00:10:59,509 --> 00:11:06,019
seem<font color="#CCCCCC"> to me well 202</font><font color="#E5E5E5"> and the client</font><font color="#CCCCCC"> as a</font>

249
00:11:02,240 --> 00:11:07,730
client<font color="#CCCCCC"> into one as a server or evil man</font>

250
00:11:06,019 --> 00:11:08,870
I'm<font color="#CCCCCC"> four slides in and I've solved this</font>

251
00:11:07,730 --> 00:11:12,020
right

252
00:11:08,870 --> 00:11:16,310
but how they get that way<font color="#E5E5E5"> well let's go</font>

253
00:11:12,020 --> 00:11:17,780
back<font color="#CCCCCC"> if we</font><font color="#E5E5E5"> look back at</font><font color="#CCCCCC"> at this here</font><font color="#E5E5E5"> it</font>

254
00:11:16,310 --> 00:11:19,189
wasn't<font color="#E5E5E5"> just</font><font color="#CCCCCC"> PI import</font><font color="#E5E5E5"> five I mean</font>

255
00:11:17,780 --> 00:11:20,360
there's a whole lot<font color="#CCCCCC"> of evil</font><font color="#E5E5E5"> in here</font>

256
00:11:19,190 --> 00:11:21,650
<font color="#CCCCCC">what's a eight eight eight eight and</font>

257
00:11:20,360 --> 00:11:25,670
that's<font color="#E5E5E5"> not okay</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

258
00:11:21,650 --> 00:11:29,449
but<font color="#CCCCCC"> 49 666</font><font color="#E5E5E5"> I want to look at that one</font>

259
00:11:25,670 --> 00:11:30,349
too so we look at<font color="#E5E5E5"> that one too and</font><font color="#CCCCCC"> what</font>

260
00:11:29,450 --> 00:11:33,350
do I<font color="#CCCCCC"> see here</font>

261
00:11:30,350 --> 00:11:35,800
well I see<font color="#E5E5E5"> my evil 202 is the listener</font>

262
00:11:33,350 --> 00:11:41,120
always but now I see a<font color="#E5E5E5"> new player</font>

263
00:11:35,800 --> 00:11:43,370
<font color="#E5E5E5">connecting out 10.2 33 - 33</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> 10 so</font>

264
00:11:41,120 --> 00:11:45,980
looking at just those connections<font color="#E5E5E5"> look</font>

265
00:11:43,370 --> 00:11:47,720
at the<font color="#E5E5E5"> timing of them about two</font>

266
00:11:45,980 --> 00:11:49,910
connections every 30 minutes

267
00:11:47,720 --> 00:11:52,340
<font color="#E5E5E5">there are always two together always</font>

268
00:11:49,910 --> 00:11:54,949
<font color="#CCCCCC">about every 30 minutes</font><font color="#E5E5E5"> and it continues</font>

269
00:11:52,340 --> 00:11:57,170
for almost<font color="#E5E5E5"> the entirety of the pcap it</font>

270
00:11:54,950 --> 00:12:00,920
was just about a day that all<font color="#E5E5E5"> this</font>

271
00:11:57,170 --> 00:12:02,900
activity took place so if I look<font color="#E5E5E5"> at the</font>

272
00:12:00,920 --> 00:12:07,699
<font color="#CCCCCC">timestamp</font><font color="#E5E5E5"> it's clear that 202 was an</font>

273
00:12:02,900 --> 00:12:10,100
evil server<font color="#E5E5E5"> on 49 666 before 202 was</font>

274
00:12:07,700 --> 00:12:11,210
involved<font color="#E5E5E5"> on four five four five thousand</font>

275
00:12:10,100 --> 00:12:13,370
and now I know<font color="#E5E5E5"> for sure</font>

276
00:12:11,210 --> 00:12:17,480
well<font color="#CCCCCC"> know for sure</font><font color="#E5E5E5"> I'm strongly</font>

277
00:12:13,370 --> 00:12:19,220
suspicious that<font color="#E5E5E5"> 10 to 33 - 33 10 is also</font>

278
00:12:17,480 --> 00:12:22,070
<font color="#E5E5E5">evil because it's the thing that's</font>

279
00:12:19,220 --> 00:12:27,380
beaconing out<font color="#E5E5E5"> actually connecting out to</font>

280
00:12:22,070 --> 00:12:31,040
an<font color="#E5E5E5"> unto an unusual port right so also</font>

281
00:12:27,380 --> 00:12:33,590
some<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little extra fun if we</font><font color="#CCCCCC"> actually</font>

282
00:12:31,040 --> 00:12:36,170
look<font color="#CCCCCC"> at a little deeper of Bro data</font>

283
00:12:33,590 --> 00:12:40,640
about these<font color="#E5E5E5"> connections from 10 to 202</font>

284
00:12:36,170 --> 00:12:44,360
on port<font color="#E5E5E5"> 4/9 666 here all I've done is</font>

285
00:12:40,640 --> 00:12:46,280
add<font color="#E5E5E5"> the connection UID and I grab</font><font color="#CCCCCC"> one of</font>

286
00:12:44,360 --> 00:12:47,840
those and just grep for<font color="#E5E5E5"> it in all the</font>

287
00:12:46,280 --> 00:12:51,380
logs and I can see that<font color="#E5E5E5"> in those</font>

288
00:12:47,840 --> 00:12:54,290
connections<font color="#E5E5E5"> I've got some dce/rpc stuff</font>

289
00:12:51,380 --> 00:12:56,270
that gets logged and some ntlm stuff

290
00:12:54,290 --> 00:13:00,790
that gets<font color="#E5E5E5"> logged</font><font color="#CCCCCC"> and I see a login</font><font color="#E5E5E5"> using</font>

291
00:12:56,270 --> 00:13:06,800
the account<font color="#E5E5E5"> s be seen expose idrd see</font>

292
00:13:00,790 --> 00:13:09,319
now I googled<font color="#E5E5E5"> SV our next pose ID RDC</font>

293
00:13:06,800 --> 00:13:11,060
and Google didn't tell me anything<font color="#CCCCCC"> that</font>

294
00:13:09,320 --> 00:13:13,970
<font color="#E5E5E5">I didn't already</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> right now I know</font>

295
00:13:11,060 --> 00:13:15,979
what<font color="#E5E5E5"> his testers are using inside the</font>

296
00:13:13,970 --> 00:13:17,840
test lab but that's just a<font color="#CCCCCC"> little fun</font>

297
00:13:15,980 --> 00:13:21,410
aside that doesn't really<font color="#E5E5E5"> tell me too</font>

298
00:13:17,840 --> 00:13:23,300
much<font color="#E5E5E5"> more but</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> still don't know why 202</font>

299
00:13:21,410 --> 00:13:26,540
is so evil

300
00:13:23,300 --> 00:13:28,640
it's<font color="#E5E5E5"> involved in all the evil stuff</font><font color="#CCCCCC"> how</font>

301
00:13:26,540 --> 00:13:30,709
did<font color="#E5E5E5"> it become evil in the first place</font>

302
00:13:28,640 --> 00:13:33,110
so I didn't<font color="#CCCCCC"> say I'm skipping</font><font color="#E5E5E5"> some steps</font>

303
00:13:30,709 --> 00:13:36,768
<font color="#CCCCCC">I I went back and</font><font color="#E5E5E5"> looked at all the flow</font>

304
00:13:33,110 --> 00:13:39,820
data saying<font color="#CCCCCC"> alright what activity was</font>

305
00:13:36,769 --> 00:13:41,300
<font color="#CCCCCC">2:02 involved in prior to the evil stuff</font>

306
00:13:39,820 --> 00:13:44,600
<font color="#CCCCCC">nada</font>

307
00:13:41,300 --> 00:13:47,899
<font color="#E5E5E5">crickets that's unusual because</font>

308
00:13:44,600 --> 00:13:50,269
<font color="#CCCCCC">typically in a corporate network if I</font>

309
00:13:47,899 --> 00:13:51,230
see some crazy lateral connections like

310
00:13:50,269 --> 00:13:54,050
I'm seeing here

311
00:13:51,230 --> 00:13:56,240
some evil stuff going on<font color="#E5E5E5"> if I track back</font>

312
00:13:54,050 --> 00:13:59,029
in<font color="#E5E5E5"> time which is the purpose of having</font>

313
00:13:56,240 --> 00:14:00,769
flow data<font color="#CCCCCC"> I go back in time and see what</font>

314
00:13:59,029 --> 00:14:02,750
happened before<font color="#CCCCCC"> that what happened</font>

315
00:14:00,769 --> 00:14:04,550
before<font color="#E5E5E5"> that</font><font color="#CCCCCC"> specifically</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> 202</font><font color="#E5E5E5"> what</font>

316
00:14:02,750 --> 00:14:06,980
happened before<font color="#E5E5E5"> that what I'm gonna see</font>

317
00:14:04,550 --> 00:14:07,849
is somebody got<font color="#CCCCCC"> finished somebody</font>

318
00:14:06,980 --> 00:14:10,070
clicked a link

319
00:14:07,850 --> 00:14:14,470
<font color="#E5E5E5">somebody got a</font><font color="#CCCCCC"> drive-bys the Box got</font>

320
00:14:10,070 --> 00:14:17,089
popped first but I don't see any of that

321
00:14:14,470 --> 00:14:19,730
nothing at all before the<font color="#E5E5E5"> evil which</font>

322
00:14:17,089 --> 00:14:22,820
tells me<font color="#E5E5E5"> we don't have a patient</font><font color="#CCCCCC"> zero we</font>

323
00:14:19,730 --> 00:14:25,040
have an aggressor in the<font color="#E5E5E5"> chair</font><font color="#CCCCCC"> a deck</font>

324
00:14:22,820 --> 00:14:27,079
I've now been able to sort out enough<font color="#E5E5E5"> of</font>

325
00:14:25,040 --> 00:14:29,230
the sequence of events<font color="#CCCCCC"> to</font><font color="#E5E5E5"> know the</font>

326
00:14:27,079 --> 00:14:33,620
difference<font color="#E5E5E5"> between remote command</font>

327
00:14:29,230 --> 00:14:35,630
exploitation some remote control and an

328
00:14:33,620 --> 00:14:37,670
internal bad actor which doesn't

329
00:14:35,630 --> 00:14:39,170
<font color="#E5E5E5">surprise me in the</font><font color="#CCCCCC"> Black</font><font color="#E5E5E5"> Hills lab that</font>

330
00:14:37,670 --> 00:14:41,719
that would be how that would start right

331
00:14:39,170 --> 00:14:43,640
I think<font color="#E5E5E5"> it was Jordan I doubted actually</font>

332
00:14:41,720 --> 00:14:45,350
I don't<font color="#CCCCCC"> remember</font><font color="#E5E5E5"> who it was somebody</font>

333
00:14:43,640 --> 00:14:47,689
somebody sat down in a chair and

334
00:14:45,350 --> 00:14:51,649
commenced to<font color="#CCCCCC"> hacking</font><font color="#E5E5E5"> and I can see when</font>

335
00:14:47,690 --> 00:14:54,170
they did it it woke up evil

336
00:14:51,649 --> 00:14:57,560
it didn't<font color="#E5E5E5"> get evil through time it woke</font>

337
00:14:54,170 --> 00:14:59,719
up that way<font color="#CCCCCC"> so what about 10:00 what</font>

338
00:14:57,560 --> 00:15:02,089
about<font color="#E5E5E5"> 10:00 how did it get in the mix</font>

339
00:14:59,720 --> 00:15:05,720
well actually<font color="#E5E5E5"> if we go back and look at</font>

340
00:15:02,089 --> 00:15:09,350
the<font color="#E5E5E5"> history of</font><font color="#CCCCCC"> tens activity</font><font color="#E5E5E5"> what do we</font>

341
00:15:05,720 --> 00:15:11,329
see<font color="#CCCCCC"> 202 is banging on a banging on</font><font color="#E5E5E5"> a</font>

342
00:15:09,350 --> 00:15:16,370
banging on a banging on<font color="#CCCCCC"> it and then what</font>

343
00:15:11,329 --> 00:15:20,120
changes<font color="#E5E5E5"> what changes is right around 13</font>

344
00:15:16,370 --> 00:15:22,699
hours 55 minutes and 19 seconds some

345
00:15:20,120 --> 00:15:27,250
connections from<font color="#E5E5E5"> 202 or a connection</font><font color="#CCCCCC"> or</font>

346
00:15:22,699 --> 00:15:30,349
two from 202 2.10 on port 445

347
00:15:27,250 --> 00:15:33,770
simultaneously and computer time results

348
00:15:30,350 --> 00:15:35,570
in<font color="#CCCCCC"> 10 suddenly being interested in</font>

349
00:15:33,770 --> 00:15:38,990
talking<font color="#E5E5E5"> to 202</font>

350
00:15:35,570 --> 00:15:42,290
as the client<font color="#E5E5E5"> that's what changed</font><font color="#CCCCCC"> 10</font>

351
00:15:38,990 --> 00:15:45,080
didn't wake up evil<font color="#CCCCCC"> 202</font><font color="#E5E5E5"> got to him made</font>

352
00:15:42,290 --> 00:15:48,949
him evil<font color="#E5E5E5"> now</font><font color="#CCCCCC"> I have no full content do I</font>

353
00:15:45,080 --> 00:15:53,450
know what it<font color="#E5E5E5"> was at 202 did</font><font color="#CCCCCC"> 210 from</font>

354
00:15:48,950 --> 00:15:55,970
this do I need to at this<font color="#CCCCCC"> stage of an</font>

355
00:15:53,450 --> 00:15:58,840
investigation do I care<font color="#CCCCCC"> no that's what</font>

356
00:15:55,970 --> 00:16:02,150
<font color="#CCCCCC">disk forensics is for I teach</font><font color="#E5E5E5"> that too</font>

357
00:15:58,840 --> 00:16:03,800
<font color="#E5E5E5">I'm pretty fond</font><font color="#CCCCCC"> of that I know that</font>

358
00:16:02,150 --> 00:16:06,470
there's some systems I want<font color="#CCCCCC"> to go find</font>

359
00:16:03,800 --> 00:16:08,900
<font color="#E5E5E5">and if I go find them and</font><font color="#CCCCCC"> squish them I</font>

360
00:16:06,470 --> 00:16:13,940
will have<font color="#CCCCCC"> one</font><font color="#E5E5E5"> how quickly could I have</font>

361
00:16:08,900 --> 00:16:14,709
done<font color="#E5E5E5"> that Equifax two months later six</font>

362
00:16:13,940 --> 00:16:17,600
months later

363
00:16:14,710 --> 00:16:20,090
<font color="#E5E5E5">how about within</font><font color="#CCCCCC"> the day how about</font>

364
00:16:17,600 --> 00:16:23,570
within<font color="#CCCCCC"> the day how hard would it be to</font>

365
00:16:20,090 --> 00:16:26,830
script some grepping of<font color="#CCCCCC"> subcon logs</font><font color="#E5E5E5"> for</font>

366
00:16:23,570 --> 00:16:31,550
stuff like<font color="#E5E5E5"> this it's not rocket surgery</font>

367
00:16:26,830 --> 00:16:33,020
<font color="#E5E5E5">it's not rocket surgery so how about a</font>

368
00:16:31,550 --> 00:16:35,510
quick glance<font color="#E5E5E5"> at this remember I have</font>

369
00:16:33,020 --> 00:16:38,120
<font color="#E5E5E5">snort - I have snort maybe snort tell me</font>

370
00:16:35,510 --> 00:16:41,660
something so<font color="#E5E5E5"> I ran snort against the</font>

371
00:16:38,120 --> 00:16:43,460
same pcap look at the alerts and this is

372
00:16:41,660 --> 00:16:46,550
all this<font color="#E5E5E5"> is all I got it's all I got</font>

373
00:16:43,460 --> 00:16:49,610
<font color="#CCCCCC">all right in this case though when I</font><font color="#E5E5E5"> was</font>

374
00:16:46,550 --> 00:16:53,240
looking at the<font color="#E5E5E5"> open ports I just decided</font>

375
00:16:49,610 --> 00:16:56,300
on an instinct to<font color="#E5E5E5"> jump to the</font><font color="#CCCCCC"> most-used</font>

376
00:16:53,240 --> 00:16:57,950
unusual ports<font color="#E5E5E5"> but for this I think I'm</font>

377
00:16:56,300 --> 00:16:59,630
gonna go with<font color="#CCCCCC"> long</font><font color="#E5E5E5"> tail analysis I'm</font>

378
00:16:57,950 --> 00:17:02,300
gonna go look<font color="#E5E5E5"> at the least frequent</font>

379
00:16:59,630 --> 00:17:06,109
<font color="#E5E5E5">alerts the least frequent events so I</font>

380
00:17:02,300 --> 00:17:08,240
see a bunch of<font color="#CCCCCC"> NetBIOS SMB a</font><font color="#E5E5E5"> Unicode</font>

381
00:17:06,109 --> 00:17:10,520
username<font color="#CCCCCC"> overflow attempt right these</font>

382
00:17:08,240 --> 00:17:12,290
things<font color="#E5E5E5"> these things</font><font color="#CCCCCC"> look like they could</font>

383
00:17:10,520 --> 00:17:15,170
<font color="#E5E5E5">be interesting they could maybe tell me</font>

384
00:17:12,290 --> 00:17:17,959
something<font color="#CCCCCC"> - so if I go and</font><font color="#E5E5E5"> look at those</font>

385
00:17:15,170 --> 00:17:20,439
what do I see<font color="#E5E5E5"> well I get confirmation</font>

386
00:17:17,959 --> 00:17:24,050
<font color="#E5E5E5">who my players are all right</font>

387
00:17:20,439 --> 00:17:27,589
confirmation corroboration<font color="#E5E5E5"> through</font>

388
00:17:24,050 --> 00:17:31,610
correlation that's as useful as fill<font color="#E5E5E5"> it</font>

389
00:17:27,589 --> 00:17:33,620
as full content<font color="#E5E5E5"> in most cases right do</font><font color="#CCCCCC"> I</font>

390
00:17:31,610 --> 00:17:36,649
at this<font color="#E5E5E5"> point do I even need to go grab</font>

391
00:17:33,620 --> 00:17:39,290
the<font color="#E5E5E5"> actual frame that caused these</font>

392
00:17:36,650 --> 00:17:41,180
alerts<font color="#E5E5E5"> open up the snort rule hold them</font>

393
00:17:39,290 --> 00:17:43,190
<font color="#E5E5E5">side by side like I normally do if I'm</font>

394
00:17:41,180 --> 00:17:44,750
doing false positive analysis<font color="#E5E5E5"> look at</font>

395
00:17:43,190 --> 00:17:46,400
look at the rule that<font color="#E5E5E5"> caused the alert</font>

396
00:17:44,750 --> 00:17:48,110
look at the pack of<font color="#CCCCCC"> the trip the trigger</font>

397
00:17:46,400 --> 00:17:49,050
and hold<font color="#E5E5E5"> them side by side and say why</font>

398
00:17:48,110 --> 00:17:51,060
did this<font color="#E5E5E5"> packet</font>

399
00:17:49,050 --> 00:17:53,129
<font color="#E5E5E5">this rule the fire</font><font color="#CCCCCC"> I didn't even do that</font>

400
00:17:51,060 --> 00:17:56,310
<font color="#CCCCCC">in this case I could have what was I</font>

401
00:17:53,130 --> 00:18:01,020
gonna find was it a bad packet<font color="#CCCCCC"> what do</font>

402
00:17:56,310 --> 00:18:02,550
you think<font color="#E5E5E5"> I think so pretty sure so</font>

403
00:18:01,020 --> 00:18:05,700
here's a quick and<font color="#CCCCCC"> dirty timeline for</font>

404
00:18:02,550 --> 00:18:08,850
initial<font color="#CCCCCC"> pcap so far and it took me what</font>

405
00:18:05,700 --> 00:18:10,530
all<font color="#CCCCCC"> of probably more time talking</font><font color="#E5E5E5"> about</font>

406
00:18:08,850 --> 00:18:13,260
<font color="#E5E5E5">it then actually</font><font color="#CCCCCC"> putting this together</font>

407
00:18:10,530 --> 00:18:14,610
<font color="#CCCCCC">so we</font><font color="#E5E5E5"> have our starting and ending of</font>

408
00:18:13,260 --> 00:18:16,800
when the<font color="#E5E5E5"> pack is starting when they</font><font color="#CCCCCC"> stop</font>

409
00:18:14,610 --> 00:18:20,370
I got that right out<font color="#E5E5E5"> of cap</font><font color="#CCCCCC"> inflows</font><font color="#E5E5E5"> then</font>

410
00:18:16,800 --> 00:18:21,290
we can see just within within<font color="#CCCCCC"> a few</font>

411
00:18:20,370 --> 00:18:24,360
seconds

412
00:18:21,290 --> 00:18:27,690
whoever it was sat down at 202 s console

413
00:18:24,360 --> 00:18:29,449
<font color="#E5E5E5">and started started thinking around with</font>

414
00:18:27,690 --> 00:18:33,270
a bunch of probes to 201

415
00:18:29,450 --> 00:18:36,840
<font color="#E5E5E5">then 202 finally begins hitting 10 and</font>

416
00:18:33,270 --> 00:18:39,300
then 10 starts calling<font color="#E5E5E5"> back and the</font>

417
00:18:36,840 --> 00:18:41,820
<font color="#CCCCCC">pwnage</font><font color="#E5E5E5"> is spread and we get some</font>

418
00:18:39,300 --> 00:18:44,159
corroboration from snort<font color="#E5E5E5"> for</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> stuff</font>

419
00:18:41,820 --> 00:18:47,159
that<font color="#E5E5E5"> goes later on but at</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> point I</font>

420
00:18:44,160 --> 00:18:49,350
<font color="#E5E5E5">probably know</font><font color="#CCCCCC"> enough to continue</font><font color="#E5E5E5"> a</font>

421
00:18:47,160 --> 00:18:52,110
full-fledged investigation<font color="#CCCCCC"> I know for</font>

422
00:18:49,350 --> 00:18:55,560
sure I know enough to<font color="#CCCCCC"> trigger response</font>

423
00:18:52,110 --> 00:18:57,389
<font color="#E5E5E5">incident response guys her what yeah</font>

424
00:18:55,560 --> 00:19:00,090
incident response is fun<font color="#E5E5E5"> well actually</font>

425
00:18:57,390 --> 00:19:01,500
it's not fun but but it's important<font color="#E5E5E5"> it's</font>

426
00:19:00,090 --> 00:19:04,439
important and here's how we could get

427
00:19:01,500 --> 00:19:06,840
there<font color="#E5E5E5"> now I still I'd to this day</font><font color="#CCCCCC"> I</font>

428
00:19:04,440 --> 00:19:08,670
can't even remember like I said who was

429
00:19:06,840 --> 00:19:11,939
who was<font color="#CCCCCC"> the tester</font><font color="#E5E5E5"> that gave me this</font>

430
00:19:08,670 --> 00:19:13,350
lovin I have no idea what<font color="#E5E5E5"> Trixie stuff</font>

431
00:19:11,940 --> 00:19:14,550
they did<font color="#E5E5E5"> cuz that's what I</font><font color="#CCCCCC"> told</font><font color="#E5E5E5"> him I</font>

432
00:19:13,350 --> 00:19:15,600
said<font color="#CCCCCC"> I don't need</font><font color="#E5E5E5"> the full campaign I</font>

433
00:19:14,550 --> 00:19:17,669
don't need<font color="#E5E5E5"> this story all the way end</font>

434
00:19:15,600 --> 00:19:19,949
and<font color="#CCCCCC"> just do the kinds of things you're</font>

435
00:19:17,670 --> 00:19:22,110
gonna be doing at<font color="#E5E5E5"> Wild</font><font color="#CCCCCC"> West hacking</font><font color="#E5E5E5"> fest</font>

436
00:19:19,950 --> 00:19:24,780
<font color="#E5E5E5">all the fun stunts everybody's going to</font>

437
00:19:22,110 --> 00:19:27,360
<font color="#E5E5E5">be</font><font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> obfuscate everything</font>

438
00:19:24,780 --> 00:19:29,210
<font color="#CCCCCC">off you scan your</font><font color="#E5E5E5"> PowerShell until you</font>

439
00:19:27,360 --> 00:19:33,050
can't even<font color="#CCCCCC"> read</font><font color="#E5E5E5"> it anymore</font>

440
00:19:29,210 --> 00:19:34,590
but is it<font color="#E5E5E5"> still gonna fling a packet</font>

441
00:19:33,050 --> 00:19:37,590
uh-huh

442
00:19:34,590 --> 00:19:40,530
still gonna fling a packet so my next

443
00:19:37,590 --> 00:19:43,439
<font color="#CCCCCC">pcap the better cap little session recon</font>

444
00:19:40,530 --> 00:19:47,160
with ARP watch<font color="#E5E5E5"> you guys know ARP watch</font>

445
00:19:43,440 --> 00:19:51,630
anybody<font color="#E5E5E5"> a few of you shaking your heads</font>

446
00:19:47,160 --> 00:19:53,700
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> Dan you better yeah yeah we talked</font>

447
00:19:51,630 --> 00:19:55,830
about<font color="#CCCCCC"> that yeah ARP</font><font color="#E5E5E5"> watch</font>

448
00:19:53,700 --> 00:19:57,690
<font color="#E5E5E5">it's a bajillion years old I</font><font color="#CCCCCC"> don't think</font>

449
00:19:55,830 --> 00:20:01,199
the codes been updated in like<font color="#E5E5E5"> seven</font>

450
00:19:57,690 --> 00:20:03,410
years<font color="#E5E5E5"> or something</font><font color="#CCCCCC"> like that I just</font>

451
00:20:01,200 --> 00:20:06,930
<font color="#CCCCCC">throw the pcap through our</font><font color="#E5E5E5"> pas</font>

452
00:20:03,410 --> 00:20:08,370
actually on a whim<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I could I could</font>

453
00:20:06,930 --> 00:20:11,070
have figured<font color="#E5E5E5"> this out too because</font><font color="#CCCCCC"> I</font>

454
00:20:08,370 --> 00:20:13,679
actually prior to this did just a<font color="#CCCCCC"> little</font>

455
00:20:11,070 --> 00:20:16,290
bit of TCP dump<font color="#E5E5E5"> one of my favorite tools</font>

456
00:20:13,680 --> 00:20:17,580
just<font color="#E5E5E5"> saying TCP dump</font><font color="#CCCCCC"> how many packets</font>

457
00:20:16,290 --> 00:20:19,860
<font color="#E5E5E5">TCP dump</font>

458
00:20:17,580 --> 00:20:22,830
how many<font color="#CCCCCC"> ARP frames and then</font><font color="#E5E5E5"> compare the</font>

459
00:20:19,860 --> 00:20:26,639
numbers and<font color="#E5E5E5"> if 30%</font><font color="#CCCCCC"> of your frames are</font>

460
00:20:22,830 --> 00:20:28,290
<font color="#CCCCCC">ARP something's not</font><font color="#E5E5E5"> okay so I throw ARP</font>

461
00:20:26,640 --> 00:20:30,330
watch<font color="#E5E5E5"> and throw</font><font color="#CCCCCC"> it at our watch and what</font>

462
00:20:28,290 --> 00:20:32,190
do I see<font color="#CCCCCC"> so if you've never read any ARP</font>

463
00:20:30,330 --> 00:20:34,470
watch output<font color="#E5E5E5"> this is just this is</font><font color="#CCCCCC"> just</font>

464
00:20:32,190 --> 00:20:36,360
literally gripped straight out<font color="#CCCCCC"> of you</font>

465
00:20:34,470 --> 00:20:37,790
can grab it straight out<font color="#CCCCCC"> of syslog if</font>

466
00:20:36,360 --> 00:20:40,229
you have<font color="#E5E5E5"> our watch running all the time</font>

467
00:20:37,790 --> 00:20:41,850
<font color="#E5E5E5">it's just</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> lip pcap tool that</font>

468
00:20:40,230 --> 00:20:44,040
<font color="#CCCCCC">sniff sauna</font><font color="#E5E5E5"> interface and it's on a tap</font>

469
00:20:41,850 --> 00:20:45,929
and and can be and can<font color="#E5E5E5"> be monitored all</font>

470
00:20:44,040 --> 00:20:48,330
the time<font color="#CCCCCC"> this</font><font color="#E5E5E5"> flip flop thing it's</font>

471
00:20:45,930 --> 00:20:51,570
telling me<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> saying</font><font color="#E5E5E5"> that because the</font>

472
00:20:48,330 --> 00:20:55,290
IP address in this column used to have

473
00:20:51,570 --> 00:20:58,110
this<font color="#E5E5E5"> MAC address assigned to it and due</font>

474
00:20:55,290 --> 00:21:00,000
to it watching<font color="#E5E5E5"> the ARP ARP watch it</font>

475
00:20:58,110 --> 00:21:02,040
discovered that it now thinks that MAC

476
00:21:00,000 --> 00:21:05,430
address because<font color="#CCCCCC"> it</font><font color="#E5E5E5"> saw some gratuitous</font>

477
00:21:02,040 --> 00:21:08,090
<font color="#E5E5E5">ARP replies poisoning ARP cache what</font>

478
00:21:05,430 --> 00:21:12,750
this means now<font color="#E5E5E5"> is it's entirely likely</font>

479
00:21:08,090 --> 00:21:14,280
<font color="#CCCCCC">that all these guys now believe what's</font>

480
00:21:12,750 --> 00:21:15,540
what's<font color="#E5E5E5"> the most common MAC address</font>

481
00:21:14,280 --> 00:21:18,270
<font color="#E5E5E5">that's trying trying trying trying</font>

482
00:21:15,540 --> 00:21:20,250
trying clearly the station that that MAC

483
00:21:18,270 --> 00:21:22,350
address<font color="#CCCCCC"> is evil</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> there's no</font>

484
00:21:20,250 --> 00:21:24,810
<font color="#CCCCCC">reason why any other station would be</font>

485
00:21:22,350 --> 00:21:26,969
saying hey I'm that IP address<font color="#CCCCCC"> no that</font>

486
00:21:24,810 --> 00:21:29,940
IP address<font color="#CCCCCC"> that's me - that one that's</font>

487
00:21:26,970 --> 00:21:31,860
me<font color="#CCCCCC"> - send all your traffic to me because</font>

488
00:21:29,940 --> 00:21:33,810
I want<font color="#E5E5E5"> to be the I</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to be the man</font><font color="#CCCCCC"> in</font>

489
00:21:31,860 --> 00:21:36,300
the middle<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right which is what's</font>

490
00:21:33,810 --> 00:21:38,610
about<font color="#E5E5E5"> to resolve result from this so I</font>

491
00:21:36,300 --> 00:21:43,379
know at layer<font color="#CCCCCC"> two that's an evil station</font>

492
00:21:38,610 --> 00:21:45,419
<font color="#E5E5E5">could</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> get an alert off this yeah if I</font>

493
00:21:43,380 --> 00:21:47,670
<font color="#E5E5E5">get something watching my syslog and it</font>

494
00:21:45,420 --> 00:21:51,120
sees a<font color="#E5E5E5"> bunch of flip-flop messages could</font>

495
00:21:47,670 --> 00:21:53,760
<font color="#E5E5E5">it make my pager go off and I could put</font>

496
00:21:51,120 --> 00:21:56,189
<font color="#E5E5E5">down my sandwich and go</font><font color="#CCCCCC"> find the station</font>

497
00:21:53,760 --> 00:21:58,170
<font color="#CCCCCC">with his MAC address</font><font color="#E5E5E5"> go I don't know</font>

498
00:21:56,190 --> 00:22:00,210
<font color="#E5E5E5">scrape is straight scrape a</font><font color="#CCCCCC"> kam table</font>

499
00:21:58,170 --> 00:22:02,970
out of<font color="#CCCCCC"> a switch follow a</font><font color="#E5E5E5"> little cable</font>

500
00:22:00,210 --> 00:22:06,120
<font color="#E5E5E5">and squish somebody with a</font><font color="#CCCCCC"> clue stick</font>

501
00:22:02,970 --> 00:22:08,160
<font color="#CCCCCC">all right I mean</font><font color="#E5E5E5"> seriously or in</font><font color="#CCCCCC"> a</font>

502
00:22:06,120 --> 00:22:10,020
highly secure environment where clue

503
00:22:08,160 --> 00:22:14,520
sticks are not<font color="#E5E5E5"> allowed in by the guards</font>

504
00:22:10,020 --> 00:22:16,470
<font color="#E5E5E5">clue ship just carry a clue ship find</font>

505
00:22:14,520 --> 00:22:20,309
<font color="#E5E5E5">that end user find that bad actor</font>

506
00:22:16,470 --> 00:22:22,020
take<font color="#E5E5E5"> him out</font><font color="#CCCCCC"> so alright</font><font color="#E5E5E5"> that's this is</font>

507
00:22:20,309 --> 00:22:25,950
<font color="#E5E5E5">this is pretty clear that</font><font color="#CCCCCC"> that's going</font>

508
00:22:22,020 --> 00:22:28,500
<font color="#CCCCCC">on so let's look</font><font color="#E5E5E5"> at the con log now for</font>

509
00:22:25,950 --> 00:22:31,289
this guy sorting<font color="#E5E5E5"> by the longest duration</font>

510
00:22:28,500 --> 00:22:34,080
of connection and just<font color="#E5E5E5"> grepping for my</font>

511
00:22:31,289 --> 00:22:37,740
evil<font color="#E5E5E5"> MAC address first two hits first</font>

512
00:22:34,080 --> 00:22:41,280
hit is hit layer<font color="#E5E5E5"> two from the bad</font>

513
00:22:37,740 --> 00:22:44,450
station<font color="#E5E5E5"> to the broadcast</font><font color="#CCCCCC"> pretending</font><font color="#E5E5E5"> to</font>

514
00:22:41,280 --> 00:22:48,990
be 201 at layer 3<font color="#CCCCCC"> 2 layer</font><font color="#E5E5E5"> 3 broadcast</font>

515
00:22:44,450 --> 00:22:51,510
for that many seconds yeah<font color="#E5E5E5"> Wow</font>

516
00:22:48,990 --> 00:22:53,340
that's what I<font color="#E5E5E5"> said I was like that's man</font>

517
00:22:51,510 --> 00:22:57,450
<font color="#E5E5E5">whoever was running better</font><font color="#CCCCCC"> cap had that</font>

518
00:22:53,340 --> 00:22:59,428
in like super hyper aggressive mode that

519
00:22:57,450 --> 00:23:01,740
some of the<font color="#E5E5E5"> switches might got hurt from</font>

520
00:22:59,429 --> 00:23:05,159
<font color="#E5E5E5">the ARP flooding right</font><font color="#CCCCCC"> ok so then the</font>

521
00:23:01,740 --> 00:23:07,980
second longest duration thing from some

522
00:23:05,159 --> 00:23:10,620
other station<font color="#E5E5E5"> trying to connect to</font><font color="#CCCCCC"> that</font>

523
00:23:07,980 --> 00:23:13,620
<font color="#E5E5E5">guy hi oh and look it's</font><font color="#CCCCCC"> 2 o-two are over</font>

524
00:23:10,620 --> 00:23:17,010
old friend<font color="#E5E5E5"> - OH -</font><font color="#CCCCCC"> it is</font><font color="#E5E5E5"> trying to</font>

525
00:23:13,620 --> 00:23:21,059
connect out to some external<font color="#E5E5E5"> IP address</font>

526
00:23:17,010 --> 00:23:24,658
at layer 3<font color="#E5E5E5"> but look where it's sending</font>

527
00:23:21,059 --> 00:23:28,370
its<font color="#CCCCCC"> traffic at layer 2 apparently it now</font>

528
00:23:24,659 --> 00:23:31,010
thinks the bad guy is the<font color="#E5E5E5"> router and</font>

529
00:23:28,370 --> 00:23:35,129
nothing bad can happen

530
00:23:31,010 --> 00:23:38,610
so probably<font color="#CCCCCC"> 201 is our aggressor looks a</font>

531
00:23:35,130 --> 00:23:41,070
lot like<font color="#E5E5E5"> 202 is the principal victim and</font>

532
00:23:38,610 --> 00:23:43,799
all its<font color="#CCCCCC"> traffic is being hijacked cuz it</font>

533
00:23:41,070 --> 00:23:47,250
layer to all its<font color="#CCCCCC"> traffic is</font><font color="#E5E5E5"> going to the</font>

534
00:23:43,799 --> 00:23:50,400
bad MAC address so a little bit more

535
00:23:47,250 --> 00:23:53,900
inspection in<font color="#E5E5E5"> the con log and what else</font>

536
00:23:50,400 --> 00:23:57,090
<font color="#E5E5E5">can we see well here we see - OH -</font>

537
00:23:53,900 --> 00:23:59,700
trying to<font color="#E5E5E5"> talk outbound to an external</font>

538
00:23:57,090 --> 00:24:02,908
IP address<font color="#CCCCCC"> - port 8 8 8 8</font><font color="#E5E5E5"> now I ask</font>

539
00:23:59,700 --> 00:24:05,210
again what service lives on port 80 8 8

540
00:24:02,909 --> 00:24:09,270
8 by now you know<font color="#E5E5E5"> the</font><font color="#CCCCCC"> answer what is</font><font color="#E5E5E5"> it</font>

541
00:24:05,210 --> 00:24:14,210
evil very good so that's<font color="#CCCCCC"> for sure</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> ok</font>

542
00:24:09,270 --> 00:24:16,889
oh and by the way same station still<font color="#CCCCCC"> 202</font>

543
00:24:14,210 --> 00:24:18,299
trying to talk<font color="#CCCCCC"> -</font><font color="#E5E5E5"> 10 trying to talk - 11</font>

544
00:24:16,890 --> 00:24:19,890
<font color="#E5E5E5">probably trying</font><font color="#CCCCCC"> to talk to</font><font color="#E5E5E5"> another of</font>

545
00:24:18,299 --> 00:24:24,080
its<font color="#E5E5E5"> friends lots of other of its friends</font>

546
00:24:19,890 --> 00:24:28,860
on port 445<font color="#E5E5E5"> but yet it all goes through</font>

547
00:24:24,080 --> 00:24:30,178
evil so no matter what good things<font color="#E5E5E5"> 202</font>

548
00:24:28,860 --> 00:24:31,590
is trying to do but<font color="#E5E5E5"> if it's trying</font>

549
00:24:30,179 --> 00:24:34,409
<font color="#E5E5E5">connect out to eight eight eight eight</font>

550
00:24:31,590 --> 00:24:36,209
<font color="#E5E5E5">it's not just doing</font><font color="#CCCCCC"> only good things but</font>

551
00:24:34,409 --> 00:24:38,610
anything it's doing at this<font color="#CCCCCC"> point is</font>

552
00:24:36,210 --> 00:24:41,190
clearly being hijacked<font color="#E5E5E5"> by</font><font color="#CCCCCC"> a dresser</font>

553
00:24:38,610 --> 00:24:42,479
<font color="#E5E5E5">probably at 201 and layer three but we</font>

554
00:24:41,190 --> 00:24:45,360
know<font color="#CCCCCC"> it's MAC address which is</font><font color="#E5E5E5"> more</font>

555
00:24:42,480 --> 00:24:47,009
important<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> situation so let's</font>

556
00:24:45,360 --> 00:24:50,519
check out that<font color="#CCCCCC"> c2 angle</font>

557
00:24:47,009 --> 00:24:51,360
sure enough<font color="#E5E5E5"> from this station</font><font color="#CCCCCC"> through</font>

558
00:24:50,519 --> 00:24:54,179
<font color="#CCCCCC">our man in the middle</font>

559
00:24:51,360 --> 00:24:55,590
yeah from<font color="#E5E5E5"> 202 to an external</font><font color="#CCCCCC"> IP address</font>

560
00:24:54,179 --> 00:25:00,240
<font color="#E5E5E5">to port</font><font color="#CCCCCC"> eight eight eight eight eight</font>

561
00:24:55,590 --> 00:25:02,730
<font color="#CCCCCC">and look at the durations</font><font color="#E5E5E5"> looks like it</font>

562
00:25:00,240 --> 00:25:03,990
made contact<font color="#CCCCCC"> it tried to phone home</font>

563
00:25:02,730 --> 00:25:05,999
phone home phone home phone home phone

564
00:25:03,990 --> 00:25:07,139
home phone home<font color="#E5E5E5"> and sooner or later it</font>

565
00:25:05,999 --> 00:25:09,419
must have made contact

566
00:25:07,139 --> 00:25:14,879
<font color="#E5E5E5">because of the longer durations</font><font color="#CCCCCC"> all</font>

567
00:25:09,419 --> 00:25:19,350
<font color="#E5E5E5">right now do I care who 96.4 T 5.30 3.73</font>

568
00:25:14,879 --> 00:25:21,119
is do I care well<font color="#CCCCCC"> kinda</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit I</font>

569
00:25:19,350 --> 00:25:25,168
mean<font color="#E5E5E5"> I want to know why it's trying to</font>

570
00:25:21,119 --> 00:25:26,610
talk to them but I know for sure<font color="#CCCCCC"> that my</font>

571
00:25:25,169 --> 00:25:31,909
<font color="#E5E5E5">man in the middle is seeing everything</font>

572
00:25:26,610 --> 00:25:34,998
<font color="#E5E5E5">anyway</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so even if these</font><font color="#CCCCCC"> are</font>

573
00:25:31,909 --> 00:25:37,379
legit outbound connections for<font color="#E5E5E5"> c2</font>

574
00:25:34,999 --> 00:25:42,809
<font color="#E5E5E5">there's a man in the middle in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> sea</font>

575
00:25:37,379 --> 00:25:46,289
<font color="#CCCCCC">two somebodies hijacking their own c24</font>

576
00:25:42,809 --> 00:25:47,700
why<font color="#E5E5E5"> I don't know</font><font color="#CCCCCC"> I'm sure Wireshark</font>

577
00:25:46,289 --> 00:25:49,200
could tell me a<font color="#E5E5E5"> whole lot more probably</font>

578
00:25:47,700 --> 00:25:51,119
what I'd find would be<font color="#CCCCCC"> a whole lot of</font>

579
00:25:49,200 --> 00:25:52,889
obfuscated PowerShell thanks to the guys

580
00:25:51,119 --> 00:25:55,350
at<font color="#CCCCCC"> Black Hills</font><font color="#E5E5E5"> if I know them at all</font>

581
00:25:52,889 --> 00:25:57,090
<font color="#CCCCCC">what I'm gonna find</font><font color="#E5E5E5"> is stuff that's</font>

582
00:25:55,350 --> 00:25:59,039
obvious<font color="#E5E5E5"> gated with multiple rounds of</font>

583
00:25:57,090 --> 00:26:01,830
obfuscation<font color="#CCCCCC"> and I just don't</font><font color="#E5E5E5"> feel like</font>

584
00:25:59,039 --> 00:26:05,220
<font color="#E5E5E5">running base64 decode that often all</font>

585
00:26:01,830 --> 00:26:09,269
right so I'm<font color="#CCCCCC"> just gonna let that be</font><font color="#E5E5E5"> but</font>

586
00:26:05,220 --> 00:26:10,799
clearly we know who the router is now<font color="#CCCCCC"> so</font>

587
00:26:09,269 --> 00:26:12,629
so if<font color="#E5E5E5"> port eight eight eight eight is</font>

588
00:26:10,799 --> 00:26:16,019
now one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> c2i</font>

589
00:26:12,629 --> 00:26:17,129
indicators of<font color="#E5E5E5"> compromise I do care</font><font color="#CCCCCC"> about</font>

590
00:26:16,019 --> 00:26:19,529
what's gonna happen<font color="#CCCCCC"> next</font>

591
00:26:17,129 --> 00:26:21,809
all<font color="#E5E5E5"> right there's our I do care about</font>

592
00:26:19,529 --> 00:26:22,529
<font color="#E5E5E5">these connections outbound to port eight</font>

593
00:26:21,809 --> 00:26:24,269
eight eight eight

594
00:26:22,529 --> 00:26:26,279
all right here's where they're being

595
00:26:24,269 --> 00:26:28,710
connected<font color="#E5E5E5"> to those are my C two</font>

596
00:26:26,279 --> 00:26:32,070
endpoints on<font color="#E5E5E5"> the outside ostensibly</font>

597
00:26:28,710 --> 00:26:34,019
<font color="#CCCCCC">those are my</font><font color="#E5E5E5"> C 2 out endpoints on the</font>

598
00:26:32,070 --> 00:26:38,789
outside but<font color="#E5E5E5"> with a</font><font color="#CCCCCC"> hijack in the middle</font>

599
00:26:34,019 --> 00:26:41,309
who knows so hey anything else<font color="#E5E5E5"> trying to</font>

600
00:26:38,789 --> 00:26:43,559
connect outbound to this or any<font color="#E5E5E5"> of my</font>

601
00:26:41,309 --> 00:26:44,970
<font color="#CCCCCC">other systems</font><font color="#E5E5E5"> pwned like</font><font color="#CCCCCC"> 202</font><font color="#E5E5E5"> that</font>

602
00:26:43,559 --> 00:26:48,360
<font color="#E5E5E5">that's the question I'm trying to ask</font>

603
00:26:44,970 --> 00:26:50,639
here<font color="#E5E5E5"> right has 201 managed to hijack</font>

604
00:26:48,360 --> 00:26:54,299
<font color="#E5E5E5">anybody else and get them to go out to</font>

605
00:26:50,639 --> 00:26:57,299
<font color="#E5E5E5">888 and luckily we see little old 202</font>

606
00:26:54,299 --> 00:27:00,240
<font color="#CCCCCC">all by itself the only one connecting</font>

607
00:26:57,299 --> 00:27:03,899
out this is a good<font color="#CCCCCC"> result the last thing</font>

608
00:27:00,240 --> 00:27:06,210
you want to<font color="#E5E5E5"> see is</font><font color="#CCCCCC"> OS everybody they're</font>

609
00:27:03,899 --> 00:27:08,820
all<font color="#E5E5E5"> having a party how about</font><font color="#CCCCCC"> poor date</font>

610
00:27:06,210 --> 00:27:12,299
<font color="#CCCCCC">888 right now at</font><font color="#E5E5E5"> least at least at this</font>

611
00:27:08,820 --> 00:27:15,149
in this instance<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> early we're early</font>

612
00:27:12,299 --> 00:27:17,190
we're<font color="#E5E5E5"> early enough to</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> find 201 and</font>

613
00:27:15,149 --> 00:27:17,699
202 and squish them<font color="#E5E5E5"> because if I wait</font>

614
00:27:17,190 --> 00:27:19,440
very long

615
00:27:17,700 --> 00:27:22,200
what can I guarantee<font color="#CCCCCC"> that lists</font><font color="#E5E5E5"> gonna</font>

616
00:27:19,440 --> 00:27:24,980
look<font color="#CCCCCC"> like</font><font color="#E5E5E5"> it's gonna be a party on board</font>

617
00:27:22,200 --> 00:27:27,749
<font color="#E5E5E5">a date a date isn't it</font><font color="#CCCCCC"> I don't want that</font>

618
00:27:24,980 --> 00:27:32,360
one web shell<font color="#CCCCCC"> okay one web show</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> not</font>

619
00:27:27,749 --> 00:27:35,669
<font color="#E5E5E5">30 it's unnecessary</font><font color="#CCCCCC"> so maybe one victim</font>

620
00:27:32,360 --> 00:27:37,408
so what was the initial<font color="#E5E5E5"> compromise of</font>

621
00:27:35,669 --> 00:27:39,749
<font color="#CCCCCC">two oh two in the first place</font>

622
00:27:37,409 --> 00:27:43,799
how do I track back initial compromises

623
00:27:39,749 --> 00:27:46,769
man<font color="#E5E5E5"> DNS data DNS data is your friend DNS</font>

624
00:27:43,799 --> 00:27:49,220
data probably the single<font color="#CCCCCC"> most important</font>

625
00:27:46,769 --> 00:27:54,749
<font color="#E5E5E5">source of data for</font><font color="#CCCCCC"> network forensics</font><font color="#E5E5E5"> in</font>

626
00:27:49,220 --> 00:27:56,610
2017 and tomorrow<font color="#CCCCCC"> too DNS data why</font><font color="#E5E5E5"> I was</font>

627
00:27:54,749 --> 00:27:59,820
around in the early<font color="#E5E5E5"> days in</font><font color="#CCCCCC"> the early</font>

628
00:27:56,610 --> 00:28:02,248
2000<font color="#E5E5E5"> Z's when all there were the rise of</font>

629
00:27:59,820 --> 00:28:04,860
<font color="#E5E5E5">the botnets</font><font color="#CCCCCC"> when all the bots are</font>

630
00:28:02,249 --> 00:28:08,519
connecting out to their<font color="#CCCCCC"> situ all of them</font>

631
00:28:04,860 --> 00:28:11,969
via IRC<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> 4 6 6 6 7 like geniuses with</font>

632
00:28:08,519 --> 00:28:13,889
<font color="#E5E5E5">hard-coded IP addresses yeah they used</font>

633
00:28:11,970 --> 00:28:16,080
to use<font color="#CCCCCC"> hard-coded IP addresses for all</font>

634
00:28:13,889 --> 00:28:18,090
this but<font color="#CCCCCC"> the bad guys</font><font color="#E5E5E5"> got smart and said</font>

635
00:28:16,080 --> 00:28:20,158
oh if we use a<font color="#E5E5E5"> hard-coded IP address</font>

636
00:28:18,090 --> 00:28:21,840
<font color="#E5E5E5">you'll block me you'll squish me and</font>

637
00:28:20,159 --> 00:28:25,559
heck you might<font color="#E5E5E5"> even report me to</font><font color="#CCCCCC"> the</font>

638
00:28:21,840 --> 00:28:27,959
feds<font color="#E5E5E5"> so it's all via DNS lots of</font>

639
00:28:25,559 --> 00:28:30,090
digitally generated addresses and so on

640
00:28:27,960 --> 00:28:34,409
and so forth<font color="#CCCCCC"> but in this case</font><font color="#E5E5E5"> I just</font><font color="#CCCCCC"> say</font>

641
00:28:30,090 --> 00:28:37,499
<font color="#CCCCCC">all right if mm of 202 of 202</font><font color="#E5E5E5"> is</font>

642
00:28:34,409 --> 00:28:39,720
connecting outbound<font color="#E5E5E5"> what sort of DNS</font>

643
00:28:37,499 --> 00:28:42,629
questions was he asking prior right

644
00:28:39,720 --> 00:28:45,539
because chances are chances are I'm

645
00:28:42,629 --> 00:28:47,399
<font color="#E5E5E5">gonna see a DNS resolution prior to any</font>

646
00:28:45,539 --> 00:28:48,619
of the evil outbound connections<font color="#E5E5E5"> so I</font>

647
00:28:47,399 --> 00:28:50,820
look<font color="#E5E5E5"> and what do I see</font>

648
00:28:48,619 --> 00:28:52,980
well this is truncated<font color="#CCCCCC"> there was more</font>

649
00:28:50,820 --> 00:28:54,809
activity<font color="#CCCCCC"> than this</font><font color="#E5E5E5"> but the the</font>

650
00:28:52,980 --> 00:28:56,300
connection<font color="#CCCCCC"> that immediately preceded</font><font color="#E5E5E5"> was</font>

651
00:28:54,809 --> 00:28:59,510
<font color="#CCCCCC">2</font>

652
00:28:56,300 --> 00:29:01,850
<font color="#E5E5E5">a message that could that be a</font>

653
00:28:59,510 --> 00:29:03,110
<font color="#E5E5E5">legitimate Microsoft server involved in</font>

654
00:29:01,850 --> 00:29:04,480
all this

655
00:29:03,110 --> 00:29:08,389
[Music]

656
00:29:04,480 --> 00:29:10,940
well when I when I drill down<font color="#E5E5E5"> here's</font>

657
00:29:08,390 --> 00:29:12,770
here's<font color="#CCCCCC"> why DNS logs are so important now</font>

658
00:29:10,940 --> 00:29:14,390
if you're not logging DNS off your DNS

659
00:29:12,770 --> 00:29:17,660
server because your DNS admin won't let

660
00:29:14,390 --> 00:29:20,780
you fine let bro do it right<font color="#CCCCCC"> so bro has</font>

661
00:29:17,660 --> 00:29:22,430
the same data for me<font color="#E5E5E5"> and I now</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> that</font>

662
00:29:20,780 --> 00:29:24,560
there<font color="#E5E5E5"> was</font><font color="#CCCCCC"> a lookup</font><font color="#E5E5E5"> for that IP address</font>

663
00:29:22,430 --> 00:29:28,460
<font color="#CCCCCC">or for that name</font><font color="#E5E5E5"> that resulted in</font><font color="#CCCCCC"> that</font>

664
00:29:24,560 --> 00:29:31,720
IP<font color="#CCCCCC"> address in the in the 12:47 9.19 7.2</font>

665
00:29:28,460 --> 00:29:34,310
<font color="#E5E5E5">23 IP address so let's say hey um</font>

666
00:29:31,720 --> 00:29:38,090
<font color="#E5E5E5">anybody connected to that and in this</font>

667
00:29:34,310 --> 00:29:42,889
case<font color="#E5E5E5"> now I'm using</font><font color="#CCCCCC"> Broz files dot log I</font>

668
00:29:38,090 --> 00:29:44,720
love bro so much I'm actually I'm very

669
00:29:42,890 --> 00:29:46,640
<font color="#E5E5E5">glad that they're renaming it because</font>

670
00:29:44,720 --> 00:29:51,560
you know the bad connotation<font color="#CCCCCC"> of bro I</font>

671
00:29:46,640 --> 00:29:53,690
love my bro<font color="#CCCCCC"> but</font><font color="#E5E5E5"> no</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> I love that I love</font>

672
00:29:51,560 --> 00:29:56,690
<font color="#E5E5E5">the bro network analysis framework is</font>

673
00:29:53,690 --> 00:29:58,430
what<font color="#CCCCCC"> I love cuz if it sees a file move</font>

674
00:29:56,690 --> 00:30:01,400
doesn't<font color="#CCCCCC"> matter what protocol</font><font color="#E5E5E5"> doesn't</font>

675
00:29:58,430 --> 00:30:03,380
matter what connection it notices<font color="#E5E5E5"> hey a</font>

676
00:30:01,400 --> 00:30:05,090
file move<font color="#E5E5E5"> if you want</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> to tell you</font>

677
00:30:03,380 --> 00:30:08,290
about it all you got<font color="#E5E5E5"> to do is ask</font><font color="#CCCCCC"> so I</font>

678
00:30:05,090 --> 00:30:12,139
asked bro hey<font color="#E5E5E5"> um tell</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> about any files</font>

679
00:30:08,290 --> 00:30:16,250
<font color="#E5E5E5">that involved um oh I don't know that</font>

680
00:30:12,140 --> 00:30:18,470
bad IP address and what do I see<font color="#CCCCCC"> yeah</font>

681
00:30:16,250 --> 00:30:21,110
there were files moved<font color="#E5E5E5"> all right there</font>

682
00:30:18,470 --> 00:30:24,410
were sure files moved<font color="#CCCCCC"> all right</font><font color="#E5E5E5"> how</font>

683
00:30:21,110 --> 00:30:25,729
<font color="#CCCCCC">about that they were move via HTTP oh by</font>

684
00:30:24,410 --> 00:30:28,160
the wind<font color="#E5E5E5"> by the</font><font color="#CCCCCC"> way I've got I've got</font>

685
00:30:25,730 --> 00:30:30,230
md5 in<font color="#CCCCCC"> sha</font><font color="#E5E5E5"> sums</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> bro did that</font>

686
00:30:28,160 --> 00:30:32,570
automatically<font color="#E5E5E5"> for</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> it said hey a file</font>

687
00:30:30,230 --> 00:30:34,310
went by<font color="#CCCCCC"> oh and</font><font color="#E5E5E5"> I recorded the md5 and</font>

688
00:30:32,570 --> 00:30:37,399
sha-1 for you just in<font color="#E5E5E5"> case you want to</font>

689
00:30:34,310 --> 00:30:39,770
<font color="#E5E5E5">know about those later on bro will carve</font>

690
00:30:37,400 --> 00:30:41,720
the files out<font color="#E5E5E5"> and save the content if</font>

691
00:30:39,770 --> 00:30:43,639
<font color="#CCCCCC">you ask it but</font><font color="#E5E5E5"> that's a little heavy</font>

692
00:30:41,720 --> 00:30:45,890
<font color="#E5E5E5">that's a little heavy right fill up your</font>

693
00:30:43,640 --> 00:30:47,540
<font color="#E5E5E5">desk and such and if I'm as you'll see</font>

694
00:30:45,890 --> 00:30:48,530
in a second if I just want to consult

695
00:30:47,540 --> 00:30:51,139
virustotal

696
00:30:48,530 --> 00:30:54,080
all I need is the hash<font color="#E5E5E5"> right</font><font color="#CCCCCC"> if I want</font>

697
00:30:51,140 --> 00:30:56,390
to<font color="#CCCCCC"> keep a file full of known</font><font color="#E5E5E5"> goods and</font>

698
00:30:54,080 --> 00:30:58,100
known Bad's<font color="#E5E5E5"> by hash all like I can</font>

699
00:30:56,390 --> 00:31:00,430
script that and bro I<font color="#E5E5E5"> don't have to do</font>

700
00:30:58,100 --> 00:31:04,250
anything<font color="#CCCCCC"> bro</font><font color="#E5E5E5"> we'll just give it to me</font>

701
00:31:00,430 --> 00:31:06,830
but in any case<font color="#E5E5E5"> I said hey in my HTTP</font>

702
00:31:04,250 --> 00:31:08,800
log why don't you show me<font color="#CCCCCC"> the</font><font color="#E5E5E5"> same</font>

703
00:31:06,830 --> 00:31:11,830
conversations but this time

704
00:31:08,800 --> 00:31:14,520
I want a user<font color="#E5E5E5"> agent and the URI</font><font color="#CCCCCC"> here's</font>

705
00:31:11,830 --> 00:31:16,840
my user agent there's no Mozilla there<font color="#CCCCCC"> I</font>

706
00:31:14,520 --> 00:31:22,530
don't<font color="#CCCCCC"> see Mozilla in any of that and</font>

707
00:31:16,840 --> 00:31:25,270
here's my URI<font color="#E5E5E5"> now this could be</font><font color="#CCCCCC"> legit</font>

708
00:31:22,530 --> 00:31:28,660
<font color="#E5E5E5">office data downloads cab files for</font>

709
00:31:25,270 --> 00:31:32,440
office data updates<font color="#E5E5E5"> it could be it could</font>

710
00:31:28,660 --> 00:31:35,850
<font color="#E5E5E5">be all legit stuff it could have all</font>

711
00:31:32,440 --> 00:31:38,410
been legit stuff<font color="#E5E5E5"> when it was requested</font>

712
00:31:35,850 --> 00:31:43,419
but is it gonna be legit when it comes

713
00:31:38,410 --> 00:31:44,050
back<font color="#E5E5E5"> what do we think</font><font color="#CCCCCC"> well here's</font><font color="#E5E5E5"> the</font>

714
00:31:43,420 --> 00:31:46,420
<font color="#E5E5E5">deal</font>

715
00:31:44,050 --> 00:31:49,540
I do a who is and sure enough<font color="#E5E5E5"> that's a</font>

716
00:31:46,420 --> 00:31:51,490
Microsoft Corp IP address port<font color="#E5E5E5"> 202</font>

717
00:31:49,540 --> 00:31:53,230
thought it was just you know connecting

718
00:31:51,490 --> 00:31:56,590
out to the<font color="#E5E5E5"> mothership to</font><font color="#CCCCCC"> pull down</font>

719
00:31:53,230 --> 00:31:58,150
<font color="#E5E5E5">whatever it's</font><font color="#CCCCCC"> supposed to pull down and</font>

720
00:31:56,590 --> 00:32:02,590
<font color="#E5E5E5">also</font><font color="#CCCCCC"> for this</font><font color="#E5E5E5"> pcap I ran it through</font>

721
00:31:58,150 --> 00:32:07,150
<font color="#CCCCCC">snortin this one with clear ownage and</font>

722
00:32:02,590 --> 00:32:10,959
clear bad files moving clear propagation

723
00:32:07,150 --> 00:32:12,490
clear<font color="#CCCCCC"> c2 snort right out of the box with</font>

724
00:32:10,960 --> 00:32:15,610
<font color="#E5E5E5">the latest snort</font><font color="#CCCCCC"> rule set shows me</font>

725
00:32:12,490 --> 00:32:17,680
nothing but hey<font color="#CCCCCC"> I sent those Sean somes</font>

726
00:32:15,610 --> 00:32:20,760
<font color="#E5E5E5">over to virustotal</font><font color="#CCCCCC"> it showed me nothing</font>

727
00:32:17,680 --> 00:32:23,500
<font color="#E5E5E5">either does that mean it's all</font><font color="#CCCCCC"> ok</font>

728
00:32:20,760 --> 00:32:25,300
nothing<font color="#CCCCCC"> bad happened right because snort</font>

729
00:32:23,500 --> 00:32:27,430
said nothing bad happened<font color="#E5E5E5"> virustotal</font>

730
00:32:25,300 --> 00:32:32,860
said nothing bad happened did<font color="#E5E5E5"> something</font>

731
00:32:27,430 --> 00:32:35,890
<font color="#E5E5E5">bad happen how do I know</font><font color="#CCCCCC"> I saw that I</font>

732
00:32:32,860 --> 00:32:38,709
saw the hijack happen<font color="#E5E5E5"> with just a few</font>

733
00:32:35,890 --> 00:32:40,720
command line stunts not even stunts<font color="#E5E5E5"> and</font>

734
00:32:38,710 --> 00:32:43,150
I can still see it<font color="#E5E5E5"> and that's what this</font>

735
00:32:40,720 --> 00:32:45,880
whole talk<font color="#CCCCCC"> was about I can still see you</font>

736
00:32:43,150 --> 00:32:48,070
I can still<font color="#E5E5E5"> see you do all the</font><font color="#CCCCCC"> trick sia</font>

737
00:32:45,880 --> 00:32:49,900
stuff you want<font color="#CCCCCC"> deviant actually asked me</font>

738
00:32:48,070 --> 00:32:51,370
and<font color="#CCCCCC"> we need Eko</font><font color="#E5E5E5"> to the name</font><font color="#CCCCCC"> of the title</font>

739
00:32:49,900 --> 00:32:54,370
so is it all gonna be about<font color="#E5E5E5"> do a</font><font color="#CCCCCC"> few</font>

740
00:32:51,370 --> 00:32:57,070
<font color="#CCCCCC">station I'm like well kind of not off</font>

741
00:32:54,370 --> 00:33:00,159
you skate<font color="#CCCCCC"> away Trixie up your</font><font color="#E5E5E5"> power show</font>

742
00:32:57,070 --> 00:33:02,860
off you skate<font color="#E5E5E5"> your payloads</font><font color="#CCCCCC"> use weird</font>

743
00:33:00,160 --> 00:33:07,510
protocols and ports<font color="#E5E5E5"> and you will evade</font>

744
00:33:02,860 --> 00:33:09,669
my detection nope not even<font color="#E5E5E5"> close however</font>

745
00:33:07,510 --> 00:33:11,950
<font color="#CCCCCC">I</font><font color="#E5E5E5"> gotta admit some weakness right I</font>

746
00:33:09,670 --> 00:33:14,410
<font color="#CCCCCC">gotta admit you got</font><font color="#E5E5E5"> to be appropriately</font>

747
00:33:11,950 --> 00:33:16,660
instrumented<font color="#E5E5E5"> how could I do all this</font>

748
00:33:14,410 --> 00:33:19,480
well because<font color="#CCCCCC"> Black Hills was kind enough</font>

749
00:33:16,660 --> 00:33:21,910
to<font color="#E5E5E5"> turn on the</font><font color="#CCCCCC"> package sniffer before</font>

750
00:33:19,480 --> 00:33:22,810
they did all<font color="#E5E5E5"> their fun is that rocket</font>

751
00:33:21,910 --> 00:33:26,100
<font color="#E5E5E5">surgery</font>

752
00:33:22,810 --> 00:33:28,570
sniffing packets<font color="#E5E5E5"> one important networks</font>

753
00:33:26,100 --> 00:33:31,510
<font color="#E5E5E5">typically we</font><font color="#CCCCCC"> have very bad lack of</font>

754
00:33:28,570 --> 00:33:33,100
visibility into<font color="#E5E5E5"> lateral movement points</font>

755
00:33:31,510 --> 00:33:34,900
because if we're<font color="#E5E5E5"> going to be sniffing</font>

756
00:33:33,100 --> 00:33:37,000
packets if we're<font color="#E5E5E5"> going to be watching</font>

757
00:33:34,900 --> 00:33:39,250
<font color="#CCCCCC">Network activity we do it on</font><font color="#E5E5E5"> the</font>

758
00:33:37,000 --> 00:33:42,340
<font color="#E5E5E5">perimeter which perimeter the perimeter</font>

759
00:33:39,250 --> 00:33:43,930
<font color="#CCCCCC">the perimeter</font><font color="#E5E5E5"> hey why not on your server</font>

760
00:33:42,340 --> 00:33:45,639
<font color="#E5E5E5">Enclave perimeter why not on your</font>

761
00:33:43,930 --> 00:33:48,010
desktop Enclave perimeter why not on

762
00:33:45,640 --> 00:33:53,200
<font color="#CCCCCC">this switch where</font><font color="#E5E5E5"> your important servers</font>

763
00:33:48,010 --> 00:33:55,330
live how about that could be<font color="#E5E5E5"> but we have</font>

764
00:33:53,200 --> 00:33:57,250
<font color="#E5E5E5">a pretty bad lack of detection even of</font>

765
00:33:55,330 --> 00:33:59,110
post exploitation activity in general

766
00:33:57,250 --> 00:34:02,200
<font color="#E5E5E5">but that's fixable</font>

767
00:33:59,110 --> 00:34:04,540
that's what's fixable that's what's

768
00:34:02,200 --> 00:34:06,130
fixable<font color="#E5E5E5"> exploitation hard to see for</font>

769
00:34:04,540 --> 00:34:07,780
most<font color="#CCCCCC"> environment stage one flies by</font>

770
00:34:06,130 --> 00:34:10,120
detection no matter what's<font color="#CCCCCC"> the what</font>

771
00:34:07,780 --> 00:34:12,489
stuff you<font color="#E5E5E5"> buy your</font><font color="#CCCCCC"> next generation shiny</font>

772
00:34:10,120 --> 00:34:14,620
lights are not<font color="#CCCCCC"> gonna see it</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> know this</font>

773
00:34:12,489 --> 00:34:17,020
because<font color="#E5E5E5"> I know relic I know strand I</font>

774
00:34:14,620 --> 00:34:19,179
know these guys can bypass<font color="#E5E5E5"> anything it</font>

775
00:34:17,020 --> 00:34:20,889
<font color="#E5E5E5">will I get that that's fine I'm not</font>

776
00:34:19,179 --> 00:34:21,810
gonna see the initial exploit<font color="#E5E5E5"> virustotal</font>

777
00:34:20,889 --> 00:34:25,929
<font color="#CCCCCC">own either</font>

778
00:34:21,810 --> 00:34:27,699
stage<font color="#CCCCCC"> two that's less excusable</font><font color="#E5E5E5"> because</font>

779
00:34:25,929 --> 00:34:29,560
now we're talking<font color="#CCCCCC"> about some sort</font><font color="#E5E5E5"> of</font>

780
00:34:27,699 --> 00:34:31,389
bigger binary<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> have some</font>

781
00:34:29,560 --> 00:34:33,549
hallmarks in it it's gonna have<font color="#CCCCCC"> the</font>

782
00:34:31,389 --> 00:34:36,069
libraries<font color="#CCCCCC"> for the c2</font><font color="#E5E5E5"> it's gonna have the</font>

783
00:34:33,550 --> 00:34:37,780
libraries for<font color="#CCCCCC"> the crypto</font><font color="#E5E5E5"> all that stuff</font>

784
00:34:36,070 --> 00:34:40,120
and<font color="#E5E5E5"> stage two still has to go in the</font>

785
00:34:37,780 --> 00:34:43,179
clear<font color="#E5E5E5"> cuz stage one doesn't</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the</font>

786
00:34:40,120 --> 00:34:45,069
crypto libraries in it yet<font color="#CCCCCC"> right so</font><font color="#E5E5E5"> the</font>

787
00:34:43,179 --> 00:34:47,020
stage<font color="#CCCCCC"> 2 download is going to be clear</font>

788
00:34:45,070 --> 00:34:48,460
text<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> less excusable</font>

789
00:34:47,020 --> 00:34:50,320
that we don't see<font color="#E5E5E5"> that but we don't see</font>

790
00:34:48,460 --> 00:34:54,159
<font color="#E5E5E5">it oh we don't see that that's</font><font color="#CCCCCC"> alright</font>

791
00:34:50,320 --> 00:34:54,580
but post exploitation<font color="#CCCCCC"> that's my bread</font>

792
00:34:54,159 --> 00:34:57,340
and<font color="#E5E5E5"> butter</font>

793
00:34:54,580 --> 00:34:59,700
bring it cuz I've redefined the win<font color="#E5E5E5"> you</font>

794
00:34:57,340 --> 00:35:03,460
pop one<font color="#E5E5E5"> of my boxes</font><font color="#CCCCCC"> you didn't win you</font>

795
00:34:59,700 --> 00:35:05,259
<font color="#CCCCCC">pop</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> shelves you didn't win a little</font>

796
00:35:03,460 --> 00:35:07,150
bit of lateral<font color="#E5E5E5"> movement</font><font color="#CCCCCC"> even you didn't</font>

797
00:35:05,260 --> 00:35:09,460
win<font color="#E5E5E5"> you don't win until you steal my</font>

798
00:35:07,150 --> 00:35:12,130
stuff that's<font color="#E5E5E5"> when you win and I lose</font><font color="#CCCCCC"> up</font>

799
00:35:09,460 --> 00:35:15,390
<font color="#E5E5E5">until that point up</font><font color="#CCCCCC"> until when my data</font>

800
00:35:12,130 --> 00:35:18,640
goes out the door<font color="#E5E5E5"> this is my house</font><font color="#CCCCCC"> and</font>

801
00:35:15,390 --> 00:35:21,730
<font color="#E5E5E5">if I instrument it right</font><font color="#CCCCCC"> I have all the</font>

802
00:35:18,640 --> 00:35:23,109
advantage but I have to instrument it

803
00:35:21,730 --> 00:35:25,060
right I have<font color="#CCCCCC"> to be looking I have to be</font>

804
00:35:23,110 --> 00:35:28,110
at<font color="#E5E5E5"> home I have</font><font color="#CCCCCC"> to be watching alright</font>

805
00:35:25,060 --> 00:35:30,370
and<font color="#E5E5E5"> yeah osmosis last night was saying</font>

806
00:35:28,110 --> 00:35:32,200
yeah I was<font color="#CCCCCC"> picking on</font><font color="#E5E5E5"> him</font><font color="#CCCCCC"> about yeah but</font>

807
00:35:30,370 --> 00:35:34,690
<font color="#CCCCCC">your stuff still throws packets right</font>

808
00:35:32,200 --> 00:35:36,460
<font color="#E5E5E5">still doing</font><font color="#CCCCCC"> c2 right</font><font color="#E5E5E5"> he's like yeah but</font>

809
00:35:34,690 --> 00:35:40,270
<font color="#CCCCCC">my</font><font color="#E5E5E5"> internet explorer</font>

810
00:35:36,460 --> 00:35:43,089
likes to<font color="#E5E5E5"> troll who didn't even say</font>

811
00:35:40,270 --> 00:35:46,660
Twitter's<font color="#E5E5E5"> and an Instagram and</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> so</font>

812
00:35:43,089 --> 00:35:50,410
am I gonna<font color="#E5E5E5"> see your</font><font color="#CCCCCC"> c2</font><font color="#E5E5E5"> on port 443</font><font color="#CCCCCC"> to</font>

813
00:35:46,660 --> 00:35:52,450
all the<font color="#CCCCCC"> social media sites now Moses is</font>

814
00:35:50,410 --> 00:35:54,098
right that's hard<font color="#CCCCCC"> that is it's hard</font>

815
00:35:52,450 --> 00:35:56,439
that's<font color="#CCCCCC"> alright</font>

816
00:35:54,099 --> 00:35:58,720
likewise with<font color="#CCCCCC"> exfil could be it could be</font>

817
00:35:56,440 --> 00:36:01,900
even in<font color="#E5E5E5"> the same channel but if I can</font>

818
00:35:58,720 --> 00:36:03,899
quickly<font color="#E5E5E5"> identify</font><font color="#CCCCCC"> the bad actors I can</font>

819
00:36:01,900 --> 00:36:08,410
still stop it before it's<font color="#CCCCCC"> too late</font>

820
00:36:03,900 --> 00:36:10,809
<font color="#E5E5E5">before</font><font color="#CCCCCC"> you're in the</font><font color="#E5E5E5"> papers so that's</font>

821
00:36:08,410 --> 00:36:12,460
our place to win<font color="#E5E5E5"> so here's my summary</font><font color="#CCCCCC"> I</font>

822
00:36:10,809 --> 00:36:14,680
don't know if you've<font color="#E5E5E5"> heard this adage in</font>

823
00:36:12,460 --> 00:36:17,710
a world of blind<font color="#E5E5E5"> men the one-eyed</font><font color="#CCCCCC"> man is</font>

824
00:36:14,680 --> 00:36:21,808
king<font color="#CCCCCC"> well in the domain of</font><font color="#E5E5E5"> the blind the</font>

825
00:36:17,710 --> 00:36:21,809
one-eyed<font color="#E5E5E5"> man sees the</font><font color="#CCCCCC"> new domain admin</font>

826
00:36:23,430 --> 00:36:31,210
<font color="#CCCCCC">alright so that's</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> variation one last</font>

827
00:36:27,970 --> 00:36:33,939
bit of summary<font color="#CCCCCC"> + + I've</font><font color="#E5E5E5"> been pumping</font>

828
00:36:31,210 --> 00:36:36,609
<font color="#E5E5E5">these ideas now in print for over</font><font color="#CCCCCC"> 5</font>

829
00:36:33,940 --> 00:36:40,690
years<font color="#E5E5E5"> I gave you my shameless</font><font color="#CCCCCC"> plug for</font>

830
00:36:36,609 --> 00:36:42,279
<font color="#E5E5E5">my book that</font><font color="#CCCCCC"> I wrote back</font><font color="#E5E5E5"> in 2012 and I</font>

831
00:36:40,690 --> 00:36:44,380
put<font color="#E5E5E5"> about everything I could</font><font color="#CCCCCC"> think of in</font>

832
00:36:42,280 --> 00:36:46,390
it or everything<font color="#E5E5E5"> that I got in it before</font>

833
00:36:44,380 --> 00:36:48,790
<font color="#E5E5E5">I got</font><font color="#CCCCCC"> exhausted</font><font color="#E5E5E5"> of putting together a</font>

834
00:36:46,390 --> 00:36:50,170
<font color="#E5E5E5">nearly 600 page book but I missed some</font>

835
00:36:48,790 --> 00:36:52,569
critical things<font color="#E5E5E5"> that aren't then and</font>

836
00:36:50,170 --> 00:36:54,549
<font color="#E5E5E5">since and I'm tired of strand pointing</font>

837
00:36:52,569 --> 00:36:55,990
them<font color="#E5E5E5"> out to me that oh why didn't why</font>

838
00:36:54,549 --> 00:36:57,400
didn't you write<font color="#E5E5E5"> about this why didn't</font>

839
00:36:55,990 --> 00:36:59,529
you write<font color="#E5E5E5"> about that you need to write</font><font color="#CCCCCC"> a</font>

840
00:36:57,400 --> 00:37:02,170
new book<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I I hate writing worse than</font>

841
00:36:59,530 --> 00:37:02,410
anything in the universe<font color="#CCCCCC"> I hate it</font><font color="#E5E5E5"> so</font>

842
00:37:02,170 --> 00:37:05,500
bad

843
00:37:02,410 --> 00:37:08,879
I was like dude I don't want he's like

844
00:37:05,500 --> 00:37:08,880
what you have<font color="#E5E5E5"> to I say I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want it</font>

845
00:37:09,299 --> 00:37:16,299
we sat down me<font color="#CCCCCC"> and</font><font color="#E5E5E5"> John</font><font color="#CCCCCC"> and Erica</font><font color="#E5E5E5"> and my</font>

846
00:37:12,640 --> 00:37:18,670
lovely wife Paola<font color="#E5E5E5"> sat down over</font><font color="#CCCCCC"> beers</font>

847
00:37:16,299 --> 00:37:20,170
and started to<font color="#E5E5E5"> make a laundry list of</font>

848
00:37:18,670 --> 00:37:22,000
all the stuff that<font color="#E5E5E5"> should have been in</font>

849
00:37:20,170 --> 00:37:24,460
the book but<font color="#E5E5E5"> five years</font><font color="#CCCCCC"> ago may</font><font color="#E5E5E5"> be</font>

850
00:37:22,000 --> 00:37:26,890
excusable except for the<font color="#E5E5E5"> DNS thing and</font>

851
00:37:24,460 --> 00:37:28,960
finally strand twisted the screws enough

852
00:37:26,890 --> 00:37:30,730
such that<font color="#CCCCCC"> with the</font><font color="#E5E5E5"> support of my family</font>

853
00:37:28,960 --> 00:37:35,730
<font color="#E5E5E5">and colleagues I'm announcing here for</font>

854
00:37:30,730 --> 00:37:35,730
the first time<font color="#E5E5E5"> ever</font><font color="#CCCCCC"> that strand wins</font>

855
00:37:38,609 --> 00:37:42,779
there will be a<font color="#E5E5E5"> volume</font><font color="#CCCCCC"> two</font>

856
00:37:43,380 --> 00:37:49,510
he has to<font color="#E5E5E5"> help he promised he has to</font>

857
00:37:47,110 --> 00:37:52,770
help<font color="#E5E5E5"> but yeah so there will be volume to</font>

858
00:37:49,510 --> 00:37:55,300
my publisher<font color="#E5E5E5"> doesn't even know just yet</font>

859
00:37:52,770 --> 00:37:56,920
my intellectual<font color="#E5E5E5"> property</font><font color="#CCCCCC"> attorney said</font>

860
00:37:55,300 --> 00:37:59,320
<font color="#E5E5E5">yes it's all everything's clear get it</font>

861
00:37:56,920 --> 00:38:02,620
done<font color="#E5E5E5"> yeah so I'll be I'll be calling my</font>

862
00:37:59,320 --> 00:38:04,180
publisher very soon<font color="#E5E5E5"> and then shortly</font>

863
00:38:02,620 --> 00:38:08,549
thereafter<font color="#CCCCCC"> we'll address</font><font color="#E5E5E5"> all the</font>

864
00:38:04,180 --> 00:38:14,830
shortcomings<font color="#E5E5E5"> and that's it any questions</font>

865
00:38:08,550 --> 00:38:16,540
<font color="#CCCCCC">but when's the book out you know it</font>

866
00:38:14,830 --> 00:38:18,790
takes it takes a while negotiating with

867
00:38:16,540 --> 00:38:21,610
publishers in the<font color="#E5E5E5"> first place</font><font color="#CCCCCC"> I've got a</font>

868
00:38:18,790 --> 00:38:23,620
rough outline then the long tedium of

869
00:38:21,610 --> 00:38:25,150
writing the thing begins<font color="#E5E5E5"> but honestly</font>

870
00:38:23,620 --> 00:38:26,650
I've got so<font color="#E5E5E5"> much</font><font color="#CCCCCC"> of this stuff in my</font>

871
00:38:25,150 --> 00:38:28,630
head I think<font color="#E5E5E5"> it's just a matter of</font>

872
00:38:26,650 --> 00:38:30,100
barfing it out and in pages that

873
00:38:28,630 --> 00:38:33,010
hopefully someone can<font color="#E5E5E5"> add it up nice and</font>

874
00:38:30,100 --> 00:38:34,870
<font color="#E5E5E5">legible</font><font color="#CCCCCC"> so I don't know I'm I I hope</font>

875
00:38:33,010 --> 00:38:37,660
<font color="#E5E5E5">within the year</font><font color="#CCCCCC"> I hope by the time</font><font color="#E5E5E5"> I'm</font>

876
00:38:34,870 --> 00:38:40,450
<font color="#E5E5E5">standing here next year which if I get</font>

877
00:38:37,660 --> 00:38:41,890
<font color="#E5E5E5">invited back</font><font color="#CCCCCC"> I will say yes</font><font color="#E5E5E5"> hopefully</font><font color="#CCCCCC"> by</font>

878
00:38:40,450 --> 00:38:43,779
the time<font color="#E5E5E5"> I'm standing here next year</font>

879
00:38:41,890 --> 00:38:47,680
it'll at least be available for

880
00:38:43,780 --> 00:38:51,220
pre-order<font color="#E5E5E5"> I hope we'll</font><font color="#CCCCCC"> see I also</font><font color="#E5E5E5"> have a</font>

881
00:38:47,680 --> 00:38:55,330
life<font color="#CCCCCC"> ever</font><font color="#E5E5E5"> you know this you</font><font color="#CCCCCC"> know this</font>

882
00:38:51,220 --> 00:38:56,740
<font color="#E5E5E5">match oh and the prettiest part of it</font>

883
00:38:55,330 --> 00:38:58,290
sitting<font color="#E5E5E5"> right</font><font color="#CCCCCC"> here taking</font><font color="#E5E5E5"> pictures</font><font color="#CCCCCC"> of my</font>

884
00:38:56,740 --> 00:39:03,310
slides for me thank you<font color="#E5E5E5"> baby</font>

885
00:38:58,290 --> 00:39:06,460
all<font color="#E5E5E5"> right any other</font><font color="#CCCCCC"> questions am</font><font color="#E5E5E5"> I on</font>

886
00:39:03,310 --> 00:39:09,040
time<font color="#CCCCCC"> whoo-hoo</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right well in that</font>

887
00:39:06,460 --> 00:39:11,640
<font color="#E5E5E5">case you're all free to</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> but thank you</font>

888
00:39:09,040 --> 00:39:11,640
<font color="#CCCCCC">for coming</font>

889
00:39:12,539 --> 00:39:14,599
<font color="#E5E5E5">you</font>

