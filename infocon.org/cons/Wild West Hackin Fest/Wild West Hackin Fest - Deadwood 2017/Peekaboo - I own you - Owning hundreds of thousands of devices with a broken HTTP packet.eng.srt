1
00:00:00,780 --> 00:00:15,040
[Music]

2
00:00:11,670 --> 00:00:16,509
the fourth or<font color="#CCCCCC"> fifth time I'm doing this</font>

3
00:00:15,040 --> 00:00:18,910
talk<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the final time so I said</font>

4
00:00:16,509 --> 00:00:23,949
okay I will go out<font color="#CCCCCC"> with a bang</font><font color="#E5E5E5"> so</font>

5
00:00:18,910 --> 00:00:25,689
<font color="#E5E5E5">welcome everyone let's start</font><font color="#CCCCCC"> we're going</font>

6
00:00:23,949 --> 00:00:29,550
<font color="#CCCCCC">to</font><font color="#E5E5E5"> talk about some really really</font>

7
00:00:25,689 --> 00:00:32,650
horrible<font color="#E5E5E5"> security vulnerabilities in</font>

8
00:00:29,550 --> 00:00:36,760
security cameras<font color="#E5E5E5"> such as</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> one and</font>

9
00:00:32,650 --> 00:00:38,170
I'm gonna go into<font color="#CCCCCC"> more details as I as I</font>

10
00:00:36,760 --> 00:00:40,330
continue but first I have to<font color="#CCCCCC"> do the</font>

11
00:00:38,170 --> 00:00:45,010
obligatory<font color="#CCCCCC"> Who am I here's</font><font color="#E5E5E5"> another good</font>

12
00:00:40,330 --> 00:00:46,210
man who made up a good decision so I

13
00:00:45,010 --> 00:00:48,760
have to like<font color="#CCCCCC"> you know through the</font>

14
00:00:46,210 --> 00:00:51,309
obligatory<font color="#E5E5E5"> who am i first so my name is</font>

15
00:00:48,760 --> 00:00:52,839
the<font color="#CCCCCC"> meet</font><font color="#E5E5E5"> in my name is Amit super if you</font>

16
00:00:51,309 --> 00:00:55,030
guys are like<font color="#E5E5E5"> hey what's with the weird</font>

17
00:00:52,839 --> 00:00:56,949
name<font color="#CCCCCC"> and that's that's because I'm</font>

18
00:00:55,030 --> 00:01:00,129
originally from here and that's Tel Aviv

19
00:00:56,949 --> 00:01:06,520
Israel<font color="#CCCCCC"> and last year</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> moved to the US</font>

20
00:01:00,129 --> 00:01:08,679
and and I moved<font color="#E5E5E5"> to Boston</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> there's a</font>

21
00:01:06,520 --> 00:01:10,720
really<font color="#E5E5E5"> bad storm heading there</font><font color="#CCCCCC"> right now</font>

22
00:01:08,680 --> 00:01:14,680
so I<font color="#E5E5E5"> have no idea</font><font color="#CCCCCC"> if I'm gonna go back</font>

23
00:01:10,720 --> 00:01:16,600
home<font color="#E5E5E5"> day after</font><font color="#CCCCCC"> tomorrow about three</font>

24
00:01:14,680 --> 00:01:19,120
months ago<font color="#E5E5E5"> I</font><font color="#CCCCCC"> was internet famous for</font>

25
00:01:16,600 --> 00:01:20,110
about two days for doing<font color="#E5E5E5"> this and</font><font color="#CCCCCC"> that</font>

26
00:01:19,120 --> 00:01:23,290
was the not

27
00:01:20,110 --> 00:01:25,930
petia<font color="#E5E5E5"> vaccination kind of thing</font><font color="#CCCCCC"> that was</font>

28
00:01:23,290 --> 00:01:26,890
really really<font color="#E5E5E5"> terrible the media made my</font>

29
00:01:25,930 --> 00:01:31,110
life a living hell

30
00:01:26,890 --> 00:01:36,970
<font color="#E5E5E5">so I said okay I'll just do</font><font color="#CCCCCC"> it again</font>

31
00:01:31,110 --> 00:01:38,470
<font color="#E5E5E5">this time with a bad bad rabbit so that</font>

32
00:01:36,970 --> 00:01:42,130
happened<font color="#CCCCCC"> do a few days ago that's</font>

33
00:01:38,470 --> 00:01:44,560
actually the<font color="#CCCCCC"> screen shot on that shows</font>

34
00:01:42,130 --> 00:01:46,560
how bad rabbit crashes<font color="#E5E5E5"> when you apply my</font>

35
00:01:44,560 --> 00:01:49,840
vaccine so that was<font color="#E5E5E5"> pretty cool actually</font>

36
00:01:46,560 --> 00:01:51,490
<font color="#CCCCCC">I work as a security researcher for</font><font color="#E5E5E5"> a</font>

37
00:01:49,840 --> 00:01:54,300
really cool<font color="#E5E5E5"> company called cyber reason</font>

38
00:01:51,490 --> 00:01:54,300
hey Trevor

39
00:01:58,390 --> 00:02:07,970
<font color="#E5E5E5">um I'm coming I'm coming</font><font color="#CCCCCC"> for you before</font>

40
00:02:04,760 --> 00:02:09,770
<font color="#CCCCCC">side reason I did I did some acting at a</font>

41
00:02:07,970 --> 00:02:13,790
certain nation state actor for nine

42
00:02:09,770 --> 00:02:15,440
years<font color="#CCCCCC"> and</font><font color="#E5E5E5"> as for certs I don't have any</font>

43
00:02:13,790 --> 00:02:19,250
I actually never<font color="#CCCCCC"> graduate another</font><font color="#E5E5E5"> vai</font>

44
00:02:15,440 --> 00:02:21,710
school<font color="#CCCCCC"> and I have a really</font><font color="#E5E5E5"> really weird</font>

45
00:02:19,250 --> 00:02:24,650
hobby<font color="#CCCCCC"> other than this obviously I</font>

46
00:02:21,710 --> 00:02:26,780
reverse engineer<font color="#E5E5E5"> embedded stuff for fun</font>

47
00:02:24,650 --> 00:02:30,560
<font color="#CCCCCC">it's kind of a weird hobby</font><font color="#E5E5E5"> and I owe</font><font color="#CCCCCC"> it</font>

48
00:02:26,780 --> 00:02:32,570
to<font color="#CCCCCC"> Zack</font><font color="#E5E5E5"> cut lip and Dev TTY is 0 which</font>

49
00:02:30,560 --> 00:02:33,770
is Craig Hefner<font color="#CCCCCC"> I've been to a</font><font color="#E5E5E5"> bunch of</font>

50
00:02:32,570 --> 00:02:35,570
<font color="#E5E5E5">their talks a few years ago and I said</font>

51
00:02:33,770 --> 00:02:37,820
oh wow<font color="#E5E5E5"> that's such a cool</font><font color="#CCCCCC"> thing I need</font>

52
00:02:35,570 --> 00:02:40,010
to<font color="#E5E5E5"> make a habit out of it I'm also on</font>

53
00:02:37,820 --> 00:02:42,200
Twitter so<font color="#E5E5E5"> if like any of you want</font><font color="#CCCCCC"> to</font>

54
00:02:40,010 --> 00:02:45,200
contact<font color="#E5E5E5"> me or</font><font color="#CCCCCC"> like totally embarrass me</font>

55
00:02:42,200 --> 00:02:46,970
right now that's my handle go nuts if

56
00:02:45,200 --> 00:02:48,500
someone can tag<font color="#E5E5E5"> malware unicorn and say</font>

57
00:02:46,970 --> 00:02:50,470
<font color="#E5E5E5">that and tell her that I stole her look</font>

58
00:02:48,500 --> 00:02:53,630
that's actually gonna<font color="#E5E5E5"> be pretty funny</font>

59
00:02:50,470 --> 00:02:55,670
what's on our<font color="#CCCCCC"> agenda today other than me</font>

60
00:02:53,630 --> 00:02:57,950
trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make this</font><font color="#CCCCCC"> thing work we're</font>

61
00:02:55,670 --> 00:02:59,869
gonna do a quick device overview on that

62
00:02:57,950 --> 00:03:02,119
piece<font color="#E5E5E5"> of which is the camera we're</font>

63
00:02:59,870 --> 00:03:05,540
going to talk<font color="#E5E5E5"> about we're then going to</font>

64
00:03:02,120 --> 00:03:07,700
map our attack surface on that piece of

65
00:03:05,540 --> 00:03:09,640
 that's the camera right here we're

66
00:03:07,700 --> 00:03:13,570
going<font color="#E5E5E5"> to do some vulnerability research</font>

67
00:03:09,640 --> 00:03:17,720
for followed by exploitation<font color="#CCCCCC"> and</font>

68
00:03:13,570 --> 00:03:20,209
hopefully a demo<font color="#CCCCCC"> I have a bunch of demos</font>

69
00:03:17,720 --> 00:03:23,900
<font color="#E5E5E5">so I want to tell you the</font><font color="#CCCCCC"> story of like</font>

70
00:03:20,209 --> 00:03:25,489
how this<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> happened so</font><font color="#E5E5E5"> a while</font><font color="#CCCCCC"> ago</font>

71
00:03:23,900 --> 00:03:29,000
and<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was before I moved to</font><font color="#CCCCCC"> the u.s.</font>

72
00:03:25,489 --> 00:03:31,220
I went to my friend you<font color="#E5E5E5"> have that's also</font>

73
00:03:29,000 --> 00:03:33,200
an Israeli name<font color="#E5E5E5"> and that research that</font>

74
00:03:31,220 --> 00:03:36,380
<font color="#CCCCCC">I'm sharing with you guys is the work of</font>

75
00:03:33,200 --> 00:03:38,510
us both<font color="#E5E5E5"> he should be he's credited for</font>

76
00:03:36,380 --> 00:03:41,359
<font color="#E5E5E5">it for everything in this we did it</font>

77
00:03:38,510 --> 00:03:43,280
together<font color="#E5E5E5"> so we were at his place</font><font color="#CCCCCC"> and we</font>

78
00:03:41,360 --> 00:03:44,660
were kind of bored<font color="#CCCCCC"> it was a Saturday</font><font color="#E5E5E5"> and</font>

79
00:03:43,280 --> 00:03:47,360
<font color="#CCCCCC">you were looking for something</font><font color="#E5E5E5"> to hack</font>

80
00:03:44,660 --> 00:03:49,670
<font color="#E5E5E5">and he had this camera behind his desk</font>

81
00:03:47,360 --> 00:03:51,470
and like we were really<font color="#E5E5E5"> like</font><font color="#CCCCCC"> okay let's</font>

82
00:03:49,670 --> 00:03:54,380
let's let's you know<font color="#E5E5E5"> let's let's try to</font>

83
00:03:51,470 --> 00:03:59,540
hack it<font color="#CCCCCC"> so let's talk about what are we</font>

84
00:03:54,380 --> 00:04:03,260
<font color="#E5E5E5">hacking actually so this is a gonna grab</font>

85
00:03:59,540 --> 00:04:05,420
a seat Trevor this<font color="#E5E5E5"> is a cloud IP</font>

86
00:04:03,260 --> 00:04:08,179
security<font color="#E5E5E5"> camera and I need all</font><font color="#CCCCCC"> of you to</font>

87
00:04:05,420 --> 00:04:11,480
<font color="#E5E5E5">remember the word cloud because that</font>

88
00:04:08,180 --> 00:04:13,250
gonna come back to<font color="#E5E5E5"> us</font><font color="#CCCCCC"> and now when you</font>

89
00:04:11,480 --> 00:04:14,929
<font color="#E5E5E5">look when you look at this camera</font><font color="#CCCCCC"> when</font>

90
00:04:13,250 --> 00:04:16,310
<font color="#E5E5E5">you see how you know</font><font color="#CCCCCC"> if you hold</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> you</font>

91
00:04:14,930 --> 00:04:18,530
can see<font color="#E5E5E5"> that it's really cheap and</font>

92
00:04:16,310 --> 00:04:21,228
<font color="#CCCCCC">really shitty</font><font color="#E5E5E5"> it actually broke on the</font>

93
00:04:18,529 --> 00:04:24,080
way here so that's kind of broken<font color="#E5E5E5"> right</font>

94
00:04:21,228 --> 00:04:27,380
now<font color="#CCCCCC"> and we said yeah you</font><font color="#E5E5E5"> know it looks</font>

95
00:04:24,080 --> 00:04:29,210
so crappy<font color="#E5E5E5"> it there has to be something</font>

96
00:04:27,380 --> 00:04:34,780
in there so we had to we<font color="#CCCCCC"> had to try to</font>

97
00:04:29,210 --> 00:04:34,780
hack it<font color="#CCCCCC"> so let's do a quick overview</font><font color="#E5E5E5"> of</font>

98
00:04:35,560 --> 00:04:44,810
the device<font color="#CCCCCC"> so the cloud IP camera so</font>

99
00:04:42,470 --> 00:04:46,280
what is it<font color="#E5E5E5"> actually so it's basically a</font>

100
00:04:44,810 --> 00:04:49,849
<font color="#E5E5E5">computer you know everything is a</font>

101
00:04:46,280 --> 00:04:52,909
computer and this is<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is running on</font>

102
00:04:49,849 --> 00:04:55,370
a generic<font color="#E5E5E5"> ARM architecture it has an arm</font>

103
00:04:52,910 --> 00:04:59,470
SOC system on a chip<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> running its</font>

104
00:04:55,370 --> 00:05:01,880
own brewed version of Linux with busybox

105
00:04:59,470 --> 00:05:04,099
now if you<font color="#E5E5E5"> don't know what busybox is</font>

106
00:05:01,880 --> 00:05:08,659
busybox is basically an environment that

107
00:05:04,099 --> 00:05:10,460
<font color="#E5E5E5">allows you</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> create a very small POSIX</font>

108
00:05:08,660 --> 00:05:12,440
environment<font color="#E5E5E5"> it's basically one</font>

109
00:05:10,460 --> 00:05:15,289
statically linked multi called binary

110
00:05:12,440 --> 00:05:18,050
<font color="#E5E5E5">that has everything you</font><font color="#CCCCCC"> need inside of</font>

111
00:05:15,289 --> 00:05:19,520
it so let's look at<font color="#E5E5E5"> this for example</font><font color="#CCCCCC"> I</font>

112
00:05:18,050 --> 00:05:23,810
can zoom in<font color="#E5E5E5"> because</font><font color="#CCCCCC"> their resolution is</font>

113
00:05:19,520 --> 00:05:25,669
kind of weird so let's say you want to

114
00:05:23,810 --> 00:05:26,840
call some sort of<font color="#E5E5E5"> a binary right so</font>

115
00:05:25,669 --> 00:05:29,930
let's say you want to call route which

116
00:05:26,840 --> 00:05:32,030
<font color="#CCCCCC">is like a regular</font><font color="#E5E5E5"> UNIX command that you</font>

117
00:05:29,930 --> 00:05:33,830
<font color="#CCCCCC">can configure a routing table</font><font color="#E5E5E5"> so when</font>

118
00:05:32,030 --> 00:05:36,830
you call route it<font color="#E5E5E5"> is actually sim linked</font>

119
00:05:33,830 --> 00:05:39,050
to<font color="#E5E5E5"> slash bin slash busy box and busy box</font>

120
00:05:36,830 --> 00:05:40,820
sees that when<font color="#E5E5E5"> it when it's</font><font color="#CCCCCC"> being ran it</font>

121
00:05:39,050 --> 00:05:43,820
<font color="#E5E5E5">yeah when it's being executed it looks</font>

122
00:05:40,820 --> 00:05:46,009
at you know the<font color="#E5E5E5"> argument the arc V</font>

123
00:05:43,820 --> 00:05:48,560
<font color="#CCCCCC">position 0</font><font color="#E5E5E5"> it sees that it was called</font>

124
00:05:46,009 --> 00:05:50,240
via route and then it gives<font color="#E5E5E5"> you the</font>

125
00:05:48,560 --> 00:05:54,820
route function out functionality that's

126
00:05:50,240 --> 00:05:58,639
inside<font color="#CCCCCC"> that statically linked binary so</font>

127
00:05:54,820 --> 00:06:01,669
let's<font color="#E5E5E5"> continue it runs a bunch of really</font>

128
00:05:58,639 --> 00:06:03,020
<font color="#E5E5E5">outdated code so like if you</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> at</font>

129
00:06:01,669 --> 00:06:05,719
<font color="#E5E5E5">this thing I mean</font><font color="#CCCCCC"> you know you buy it</font>

130
00:06:03,020 --> 00:06:08,419
you I bought this one like a year<font color="#CCCCCC"> ago</font>

131
00:06:05,720 --> 00:06:11,270
and it has code on it<font color="#CCCCCC"> and a lot of</font>

132
00:06:08,419 --> 00:06:12,799
<font color="#E5E5E5">libraries from like</font><font color="#CCCCCC"> 10 years ago and all</font>

133
00:06:11,270 --> 00:06:14,060
<font color="#E5E5E5">of those things are kind of mashed</font>

134
00:06:12,800 --> 00:06:15,710
together and<font color="#CCCCCC"> they were hacked together</font>

135
00:06:14,060 --> 00:06:17,360
and someone<font color="#E5E5E5"> said I'm gonna try to</font>

136
00:06:15,710 --> 00:06:19,580
compile it<font color="#E5E5E5"> and if it's gonna work it's</font>

137
00:06:17,360 --> 00:06:21,090
<font color="#E5E5E5">gonna be awesome</font><font color="#CCCCCC"> and the problem with</font>

138
00:06:19,580 --> 00:06:23,880
<font color="#E5E5E5">those thing is that this is never</font>

139
00:06:21,090 --> 00:06:26,010
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> if like you compiled something you</font>

140
00:06:23,880 --> 00:06:28,020
say I don't<font color="#E5E5E5"> give a</font><font color="#CCCCCC"> about security I</font>

141
00:06:26,010 --> 00:06:29,610
just<font color="#E5E5E5"> wanted them thing to work then</font>

142
00:06:28,020 --> 00:06:32,729
you're gonna have a<font color="#CCCCCC"> bedtime and we're</font>

143
00:06:29,610 --> 00:06:35,370
gonna we're<font color="#E5E5E5"> gonna see that today so</font>

144
00:06:32,729 --> 00:06:37,440
remember<font color="#CCCCCC"> that I said to</font><font color="#E5E5E5"> remember the</font>

145
00:06:35,370 --> 00:06:39,510
cloud thing so this<font color="#CCCCCC"> camera has something</font>

146
00:06:37,440 --> 00:06:42,240
<font color="#E5E5E5">that's called a pee pee pee pee protocol</font>

147
00:06:39,510 --> 00:06:44,639
and I always<font color="#E5E5E5"> said that it's like</font><font color="#CCCCCC"> a point</font>

148
00:06:42,240 --> 00:06:46,350
to point to point to point<font color="#E5E5E5"> protocol and</font>

149
00:06:44,639 --> 00:06:52,889
the third point is probably<font color="#CCCCCC"> the Chinese</font>

150
00:06:46,350 --> 00:06:55,620
<font color="#E5E5E5">and and this was put there this was put</font>

151
00:06:52,889 --> 00:06:57,570
there<font color="#E5E5E5"> to circumvent like pesky</font><font color="#CCCCCC"> NAT</font>

152
00:06:55,620 --> 00:06:59,130
situations so<font color="#E5E5E5"> you know whoever made this</font>

153
00:06:57,570 --> 00:07:00,990
camera I wanted<font color="#E5E5E5"> you to</font><font color="#CCCCCC"> just plug it</font><font color="#E5E5E5"> into</font>

154
00:06:59,130 --> 00:07:02,700
<font color="#E5E5E5">your network</font><font color="#CCCCCC"> and he didn't</font><font color="#E5E5E5"> want you to</font>

155
00:07:00,990 --> 00:07:03,990
<font color="#E5E5E5">you know like mess around with port</font>

156
00:07:02,700 --> 00:07:06,000
forwarding<font color="#CCCCCC"> Xand stuff on your</font><font color="#E5E5E5"> router</font>

157
00:07:03,990 --> 00:07:10,020
he just wanted<font color="#E5E5E5"> it</font><font color="#CCCCCC"> to plug it in</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font>

158
00:07:06,000 --> 00:07:12,330
it'll<font color="#CCCCCC"> work</font><font color="#E5E5E5"> now um oops now every</font><font color="#CCCCCC"> camera</font>

159
00:07:10,020 --> 00:07:13,889
and I can't I<font color="#E5E5E5"> can't show it</font><font color="#CCCCCC"> to you</font>

160
00:07:12,330 --> 00:07:15,450
<font color="#CCCCCC">because the suit</font><font color="#E5E5E5"> the moment I'll lift it</font>

161
00:07:13,889 --> 00:07:18,150
up it'll it'll break to pieces<font color="#CCCCCC"> because</font>

162
00:07:15,450 --> 00:07:20,460
<font color="#E5E5E5">it's a piece of</font><font color="#CCCCCC"> the the bottom of</font>

163
00:07:18,150 --> 00:07:23,810
it it has a QR<font color="#CCCCCC"> code</font><font color="#E5E5E5"> and they have an app</font>

164
00:07:20,460 --> 00:07:26,880
<font color="#CCCCCC">that you scan the QR code of the camera</font>

165
00:07:23,810 --> 00:07:30,750
<font color="#E5E5E5">and then it basically</font><font color="#CCCCCC"> builds a tunnel</font>

166
00:07:26,880 --> 00:07:33,330
<font color="#E5E5E5">through the Chinese to your house and</font>

167
00:07:30,750 --> 00:07:35,310
then<font color="#CCCCCC"> you can use and then you</font><font color="#E5E5E5"> can use</font>

168
00:07:33,330 --> 00:07:38,639
and then<font color="#E5E5E5"> you can use</font><font color="#CCCCCC"> your app to see</font>

169
00:07:35,310 --> 00:07:40,650
what's<font color="#E5E5E5"> going on at</font><font color="#CCCCCC"> your house now it's</font>

170
00:07:38,639 --> 00:07:43,770
made by a company<font color="#CCCCCC"> called V</font><font color="#E5E5E5"> Star cam and</font>

171
00:07:40,650 --> 00:07:45,870
they also they they<font color="#E5E5E5"> make it under their</font>

172
00:07:43,770 --> 00:07:48,690
own brand but they also sell it to other

173
00:07:45,870 --> 00:07:50,099
<font color="#E5E5E5">vendors like white labeling basically</font>

174
00:07:48,690 --> 00:07:51,840
and other vendors<font color="#CCCCCC"> just slap their</font>

175
00:07:50,099 --> 00:07:53,490
sticker on<font color="#CCCCCC"> it and you know they make</font>

176
00:07:51,840 --> 00:07:55,650
camera<font color="#CCCCCC"> too now they make cameras do now</font>

177
00:07:53,490 --> 00:07:59,030
<font color="#E5E5E5">now the cool thing</font><font color="#CCCCCC"> about these</font><font color="#E5E5E5"> Star cam</font>

178
00:07:55,650 --> 00:08:01,020
is that if you go to<font color="#CCCCCC"> the website now</font>

179
00:07:59,030 --> 00:08:02,969
<font color="#CCCCCC">it's kind of</font><font color="#E5E5E5"> blurry because of the</font>

180
00:08:01,020 --> 00:08:05,340
resolution<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it says no more</font><font color="#CCCCCC"> security</font>

181
00:08:02,970 --> 00:08:07,860
<font color="#CCCCCC">where</font><font color="#E5E5E5"> if vulnerability worries it it</font>

182
00:08:05,340 --> 00:08:10,859
says account remote login reminder<font color="#E5E5E5"> what</font>

183
00:08:07,860 --> 00:08:14,510
the does that mean<font color="#E5E5E5"> weak password</font>

184
00:08:10,860 --> 00:08:14,510
prompt<font color="#CCCCCC"> we'll get back to this</font>

185
00:08:15,379 --> 00:08:20,210
mobile phone and email address<font color="#E5E5E5"> and</font>

186
00:08:21,139 --> 00:08:29,340
<font color="#CCCCCC">gesture password I looked at the apps</font><font color="#E5E5E5"> I</font>

187
00:08:26,580 --> 00:08:33,689
reverse engineered them I didn't see any

188
00:08:29,340 --> 00:08:36,978
<font color="#E5E5E5">of that</font><font color="#CCCCCC"> over there now as I said their</font>

189
00:08:33,690 --> 00:08:39,060
apps<font color="#E5E5E5"> were Android and iOS are really bad</font>

190
00:08:36,979 --> 00:08:40,890
<font color="#CCCCCC">but we're not</font><font color="#E5E5E5"> gonna talk about that</font>

191
00:08:39,059 --> 00:08:42,299
we're actually going<font color="#E5E5E5"> to talk about the</font>

192
00:08:40,890 --> 00:08:43,919
web server that<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> running which is</font>

193
00:08:42,299 --> 00:08:45,479
<font color="#E5E5E5">the go ahead web server anybody here</font>

194
00:08:43,919 --> 00:08:48,420
knows<font color="#CCCCCC"> that web</font><font color="#E5E5E5"> servers show of hands</font>

195
00:08:45,480 --> 00:08:50,670
other than<font color="#E5E5E5"> Trevor okay</font><font color="#CCCCCC"> and you</font><font color="#E5E5E5"> guys okay</font>

196
00:08:48,420 --> 00:08:52,410
so we're gonna talk<font color="#CCCCCC"> about it and there's</font>

197
00:08:50,670 --> 00:08:53,819
also a web interface<font color="#E5E5E5"> it's just the</font>

198
00:08:52,410 --> 00:08:55,079
clusterfuck of<font color="#E5E5E5"> elementary school level</font>

199
00:08:53,820 --> 00:08:56,970
<font color="#E5E5E5">code that was mashed together and</font>

200
00:08:55,079 --> 00:09:00,660
<font color="#E5E5E5">somehow managed to compile we'll get to</font>

201
00:08:56,970 --> 00:09:02,730
that<font color="#CCCCCC"> too now this thing is</font><font color="#E5E5E5"> really</font>

202
00:09:00,660 --> 00:09:04,560
popular<font color="#E5E5E5"> like I have a show tender show</font>

203
00:09:02,730 --> 00:09:06,540
<font color="#CCCCCC">show then dork that</font><font color="#E5E5E5"> gave me eight</font>

204
00:09:04,560 --> 00:09:08,339
<font color="#E5E5E5">hundred thousand</font><font color="#CCCCCC"> results on show damn</font>

205
00:09:06,540 --> 00:09:11,130
<font color="#E5E5E5">that's eight</font><font color="#CCCCCC"> hundred thousand</font><font color="#E5E5E5"> root</font>

206
00:09:08,339 --> 00:09:13,050
<font color="#CCCCCC">shells everywhere</font><font color="#E5E5E5"> and you can get those</font>

207
00:09:11,130 --> 00:09:16,350
cameras in Amazon<font color="#CCCCCC"> and eBay and other</font>

208
00:09:13,050 --> 00:09:18,959
<font color="#CCCCCC">websites for like</font><font color="#E5E5E5"> 30</font><font color="#CCCCCC"> bucks so pro tip if</font>

209
00:09:16,350 --> 00:09:21,449
you want<font color="#CCCCCC"> to secure your</font><font color="#E5E5E5"> house</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> buy</font>

210
00:09:18,959 --> 00:09:24,930
something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> costs</font><font color="#CCCCCC"> thirty</font><font color="#E5E5E5"> bucks</font>

211
00:09:21,449 --> 00:09:27,300
<font color="#CCCCCC">I bought a lot of</font><font color="#E5E5E5"> those from different</font>

212
00:09:24,930 --> 00:09:29,370
<font color="#E5E5E5">vendors that's like an actual photo from</font>

213
00:09:27,300 --> 00:09:30,810
our office<font color="#E5E5E5"> I bought a lot of those from</font>

214
00:09:29,370 --> 00:09:33,320
from<font color="#E5E5E5"> different vendors</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see that</font>

215
00:09:30,810 --> 00:09:35,609
a lot<font color="#CCCCCC"> of them kind of look the same</font>

216
00:09:33,320 --> 00:09:37,829
except the one on the<font color="#E5E5E5"> back which is</font><font color="#CCCCCC"> like</font>

217
00:09:35,610 --> 00:09:40,199
<font color="#E5E5E5">a more sturdy model that was made to be</font>

218
00:09:37,829 --> 00:09:42,449
used<font color="#CCCCCC"> outside</font><font color="#E5E5E5"> but they are all running</font>

219
00:09:40,199 --> 00:09:46,649
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same shitty code that we're gonna</font>

220
00:09:42,449 --> 00:09:47,939
exploit now<font color="#E5E5E5"> let's talk about the web</font>

221
00:09:46,649 --> 00:09:49,620
server because you know when you're

222
00:09:47,940 --> 00:09:51,779
doing<font color="#E5E5E5"> security research on such devices</font>

223
00:09:49,620 --> 00:09:54,959
<font color="#E5E5E5">like routers and cameras and those sort</font>

224
00:09:51,779 --> 00:09:57,660
of things that's now called IOT it oh

225
00:09:54,959 --> 00:09:59,489
yeah and that another<font color="#E5E5E5"> thing IOT the</font>

226
00:09:57,660 --> 00:10:02,910
Internet of Things<font color="#CCCCCC"> it is the same</font>

227
00:09:59,490 --> 00:10:04,709
<font color="#E5E5E5">Internet as everything else there is no</font>

228
00:10:02,910 --> 00:10:09,540
such thing as IOT so let's stop using

229
00:10:04,709 --> 00:10:11,699
<font color="#E5E5E5">this really really stupid term so let's</font>

230
00:10:09,540 --> 00:10:13,649
talk about<font color="#E5E5E5"> the web server because that's</font>

231
00:10:11,699 --> 00:10:15,630
the that's<font color="#E5E5E5"> the thing</font><font color="#CCCCCC"> that you as the</font>

232
00:10:13,649 --> 00:10:17,519
user interact with the most that's<font color="#E5E5E5"> what</font>

233
00:10:15,630 --> 00:10:19,589
gives you the the video feed<font color="#CCCCCC"> that would</font>

234
00:10:17,519 --> 00:10:21,750
that's<font color="#E5E5E5"> what gives you the images then</font>

235
00:10:19,589 --> 00:10:23,990
<font color="#CCCCCC">okay I'm done with this I can't do this</font>

236
00:10:21,750 --> 00:10:23,990
anymore

237
00:10:24,110 --> 00:10:32,850
sorry<font color="#E5E5E5"> Trevor</font><font color="#CCCCCC"> we'll get back to you</font>

238
00:10:27,240 --> 00:10:37,410
<font color="#E5E5E5">I just executed a unicorn on stage right</font>

239
00:10:32,850 --> 00:10:40,730
<font color="#E5E5E5">away can you guys still hear me I will I</font>

240
00:10:37,410 --> 00:10:46,410
will<font color="#E5E5E5"> thanks Joe Cocker</font>

241
00:10:40,730 --> 00:10:53,210
<font color="#E5E5E5">okay wait something here what's that why</font>

242
00:10:46,410 --> 00:10:55,110
do I have two of those okay okay okay<font color="#CCCCCC"> so</font>

243
00:10:53,210 --> 00:10:56,610
<font color="#E5E5E5">let's talk</font><font color="#CCCCCC"> about a web server because</font>

244
00:10:55,110 --> 00:10:58,200
that's what gives<font color="#E5E5E5"> you access to</font>

245
00:10:56,610 --> 00:11:00,210
everything<font color="#E5E5E5"> and that's like always</font>

246
00:10:58,200 --> 00:11:01,650
usually<font color="#E5E5E5"> the weakest point when you're</font>

247
00:11:00,210 --> 00:11:04,860
doing security research and such devices

248
00:11:01,650 --> 00:11:07,439
<font color="#CCCCCC">so let's</font><font color="#E5E5E5"> look at the features</font><font color="#CCCCCC"> of go</font>

249
00:11:04,860 --> 00:11:09,240
ahead web server so this is text<font color="#CCCCCC"> that</font>

250
00:11:07,440 --> 00:11:11,820
that's like<font color="#E5E5E5"> the feature list from their</font>

251
00:11:09,240 --> 00:11:13,589
<font color="#E5E5E5">website</font><font color="#CCCCCC"> now go ahead web server is an</font>

252
00:11:11,820 --> 00:11:15,690
<font color="#E5E5E5">open source project most of it is</font><font color="#CCCCCC"> open</font>

253
00:11:13,589 --> 00:11:17,220
source they have<font color="#CCCCCC"> a git repository you</font>

254
00:11:15,690 --> 00:11:20,400
can<font color="#E5E5E5"> look at the code</font><font color="#CCCCCC"> and you can like</font>

255
00:11:17,220 --> 00:11:22,410
read how shitty it is and they have

256
00:11:20,400 --> 00:11:23,970
<font color="#E5E5E5">something that's called a CGI handler</font>

257
00:11:22,410 --> 00:11:27,719
now<font color="#E5E5E5"> in case you</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know what</font><font color="#CCCCCC"> a CGI</font>

258
00:11:23,970 --> 00:11:30,600
<font color="#E5E5E5">handler is it stands for common gateway</font>

259
00:11:27,720 --> 00:11:35,010
interface<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that basically means that</font>

260
00:11:30,600 --> 00:11:38,160
you have code that's running<font color="#E5E5E5"> on this but</font>

261
00:11:35,010 --> 00:11:41,610
<font color="#E5E5E5">that code is getting input from you the</font>

262
00:11:38,160 --> 00:11:43,439
users<font color="#E5E5E5"> now that code could be a script</font>

263
00:11:41,610 --> 00:11:45,270
<font color="#CCCCCC">that could be a binary file that could</font>

264
00:11:43,440 --> 00:11:49,560
<font color="#E5E5E5">be whatever but</font><font color="#CCCCCC"> whatever it is you</font>

265
00:11:45,270 --> 00:11:50,130
<font color="#E5E5E5">control</font><font color="#CCCCCC"> the input</font><font color="#E5E5E5"> now that's a terrible</font>

266
00:11:49,560 --> 00:11:52,709
idea

267
00:11:50,130 --> 00:11:54,000
that was really popular<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the 90s</font><font color="#E5E5E5"> like</font>

268
00:11:52,709 --> 00:11:56,640
you remember when you go to<font color="#E5E5E5"> websites it</font>

269
00:11:54,000 --> 00:12:00,270
looks like URL slash CGI - bin slash

270
00:11:56,640 --> 00:12:01,640
<font color="#E5E5E5">something this is that and that is</font>

271
00:12:00,270 --> 00:12:05,069
horrible

272
00:12:01,640 --> 00:12:09,150
now as I<font color="#CCCCCC"> said this is an open source</font>

273
00:12:05,070 --> 00:12:11,339
project<font color="#E5E5E5"> so the CGI is used for third</font>

274
00:12:09,150 --> 00:12:13,500
parties such as<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know the the vendor</font>

275
00:12:11,339 --> 00:12:16,980
<font color="#CCCCCC">of this camera to add more features to</font>

276
00:12:13,500 --> 00:12:19,320
the product<font color="#E5E5E5"> so when those features are</font>

277
00:12:16,980 --> 00:12:22,140
programmed<font color="#E5E5E5"> and when they are linked with</font>

278
00:12:19,320 --> 00:12:24,000
<font color="#E5E5E5">the CGI handler once your code will be</font>

279
00:12:22,140 --> 00:12:26,370
compiled with the code of<font color="#CCCCCC"> the webserver</font>

280
00:12:24,000 --> 00:12:28,230
<font color="#E5E5E5">the CGI functionality will be in the</font>

281
00:12:26,370 --> 00:12:30,029
<font color="#CCCCCC">webserver executable file and</font><font color="#E5E5E5"> that's</font>

282
00:12:28,230 --> 00:12:31,200
important<font color="#E5E5E5"> to</font><font color="#CCCCCC"> remember because</font><font color="#E5E5E5"> this is</font>

283
00:12:30,029 --> 00:12:35,070
what we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> reverse engineer</font>

284
00:12:31,200 --> 00:12:36,450
<font color="#E5E5E5">later now back to our story what we were</font>

285
00:12:35,070 --> 00:12:38,280
looking<font color="#CCCCCC"> for was code</font>

286
00:12:36,450 --> 00:12:39,900
execution<font color="#E5E5E5"> remote code execution we</font>

287
00:12:38,280 --> 00:12:41,579
wanted to<font color="#E5E5E5"> point our fingers at an IP</font>

288
00:12:39,900 --> 00:12:44,880
address<font color="#CCCCCC"> that</font><font color="#E5E5E5"> has this and get a root</font>

289
00:12:41,580 --> 00:12:47,850
shell<font color="#E5E5E5"> but we had one</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> we didn't</font>

290
00:12:44,880 --> 00:12:49,620
have the firmware<font color="#E5E5E5"> now usually again when</font>

291
00:12:47,850 --> 00:12:52,500
I<font color="#E5E5E5"> did a lot</font><font color="#CCCCCC"> of security research and</font>

292
00:12:49,620 --> 00:12:53,820
<font color="#E5E5E5">those kind of things and usually</font><font color="#CCCCCC"> what</font>

293
00:12:52,500 --> 00:12:55,770
you do is you go to the vendors website

294
00:12:53,820 --> 00:12:57,150
<font color="#E5E5E5">you download the firmware you unpack it</font>

295
00:12:55,770 --> 00:13:00,300
<font color="#E5E5E5">and then you start reverse engineering</font>

296
00:12:57,150 --> 00:13:02,610
<font color="#E5E5E5">but in that case this</font><font color="#CCCCCC"> thing is so</font>

297
00:13:00,300 --> 00:13:04,790
generic<font color="#E5E5E5"> that we didn't know who makes it</font>

298
00:13:02,610 --> 00:13:07,800
because it's such a generic Chinese

299
00:13:04,790 --> 00:13:10,740
product<font color="#E5E5E5"> and we can go to like generic</font>

300
00:13:07,800 --> 00:13:13,260
<font color="#E5E5E5">Chinese vendor</font><font color="#CCCCCC"> comm because we don't</font>

301
00:13:10,740 --> 00:13:19,280
know who the vendor is so you know what

302
00:13:13,260 --> 00:13:21,689
<font color="#E5E5E5">that means we literally took a hammer</font>

303
00:13:19,280 --> 00:13:23,100
that's that's the camera<font color="#E5E5E5"> that we were</font>

304
00:13:21,690 --> 00:13:24,690
working<font color="#CCCCCC"> on back at</font><font color="#E5E5E5"> the time so we</font>

305
00:13:23,100 --> 00:13:27,390
<font color="#CCCCCC">actually took a hammer and we tore it</font>

306
00:13:24,690 --> 00:13:31,280
<font color="#E5E5E5">apart</font><font color="#CCCCCC"> and you</font><font color="#E5E5E5"> can see here that</font><font color="#CCCCCC"> it has</font>

307
00:13:27,390 --> 00:13:31,280
<font color="#E5E5E5">the board this is the board right here</font>

308
00:13:31,700 --> 00:13:36,990
<font color="#CCCCCC">it has a board</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> here the resolution</font>

309
00:13:34,200 --> 00:13:40,170
is<font color="#CCCCCC"> super-weird</font><font color="#E5E5E5"> I have no idea why but</font>

310
00:13:36,990 --> 00:13:41,730
what we did is<font color="#E5E5E5"> we</font><font color="#CCCCCC"> found the UART headers</font>

311
00:13:40,170 --> 00:13:43,319
on that board now<font color="#E5E5E5"> if you don't know what</font>

312
00:13:41,730 --> 00:13:45,030
a you are<font color="#E5E5E5"> - if you if you don't know</font>

313
00:13:43,320 --> 00:13:48,210
what you<font color="#E5E5E5"> are it is it's</font><font color="#CCCCCC"> basically a</font>

314
00:13:45,030 --> 00:13:50,069
serial interface<font color="#CCCCCC"> that you connect to and</font>

315
00:13:48,210 --> 00:13:52,770
it gives<font color="#CCCCCC"> you it basically</font><font color="#E5E5E5"> gives you</font>

316
00:13:50,070 --> 00:13:55,140
access as if you had a<font color="#E5E5E5"> monitor and a</font>

317
00:13:52,770 --> 00:13:57,949
keyboard connected directly to<font color="#CCCCCC"> the to</font>

318
00:13:55,140 --> 00:14:00,420
the board<font color="#CCCCCC"> so if</font><font color="#E5E5E5"> everything works out</font>

319
00:13:57,950 --> 00:14:03,720
usually you get a root shell<font color="#CCCCCC"> but you</font>

320
00:14:00,420 --> 00:14:05,760
have to do this<font color="#E5E5E5"> ugliness now this is</font>

321
00:14:03,720 --> 00:14:07,740
<font color="#E5E5E5">actually what we did so we use the bus</font>

322
00:14:05,760 --> 00:14:09,900
pirate that's the red board over there<font color="#E5E5E5"> -</font>

323
00:14:07,740 --> 00:14:11,820
<font color="#CCCCCC">and we</font><font color="#E5E5E5"> found the we found the headers</font>

324
00:14:09,900 --> 00:14:15,030
<font color="#E5E5E5">and we connected and soldered some wires</font>

325
00:14:11,820 --> 00:14:17,100
<font color="#E5E5E5">and we booted the thing and</font><font color="#CCCCCC"> after we we</font>

326
00:14:15,030 --> 00:14:19,650
guessed<font color="#CCCCCC"> all the properties</font><font color="#E5E5E5"> and that took</font>

327
00:14:17,100 --> 00:14:21,390
us<font color="#E5E5E5"> a while</font><font color="#CCCCCC"> you know we plugged it in and</font>

328
00:14:19,650 --> 00:14:24,030
<font color="#E5E5E5">we saw a bootloader and eventually we</font>

329
00:14:21,390 --> 00:14:25,620
had a root shell<font color="#E5E5E5"> now while this is a</font>

330
00:14:24,030 --> 00:14:27,540
root<font color="#CCCCCC"> shell and this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> cool this</font>

331
00:14:25,620 --> 00:14:31,500
<font color="#CCCCCC">is still not</font><font color="#E5E5E5"> remote code execution this</font>

332
00:14:27,540 --> 00:14:34,829
is just<font color="#CCCCCC"> around with</font><font color="#E5E5E5"> a hammer so</font>

333
00:14:31,500 --> 00:14:38,430
now what so<font color="#E5E5E5"> now we need to get the</font>

334
00:14:34,830 --> 00:14:40,560
actual files from this<font color="#E5E5E5"> thing from the</font>

335
00:14:38,430 --> 00:14:43,140
<font color="#CCCCCC">from the from the flash memory that's</font>

336
00:14:40,560 --> 00:14:44,579
here on<font color="#E5E5E5"> the device because we want to we</font>

337
00:14:43,140 --> 00:14:45,610
want<font color="#E5E5E5"> to</font><font color="#CCCCCC"> reverse-engineer it</font><font color="#E5E5E5"> we want to</font>

338
00:14:44,580 --> 00:14:47,950
look at it and we want<font color="#CCCCCC"> to</font>

339
00:14:45,610 --> 00:14:51,160
what's in there<font color="#E5E5E5"> so actually what we did</font>

340
00:14:47,950 --> 00:14:53,529
is we transferred all of<font color="#CCCCCC"> the MTD blocks</font>

341
00:14:51,160 --> 00:14:55,660
<font color="#E5E5E5">/dev / MTD blocks to a computer using</font>

342
00:14:53,529 --> 00:14:58,300
<font color="#E5E5E5">nothing but deep but DeeDee and netcat</font>

343
00:14:55,660 --> 00:15:02,050
and that was super<font color="#CCCCCC"> easy because now we</font>

344
00:14:58,300 --> 00:15:04,359
had a shell<font color="#E5E5E5"> on the on the camera so we</font>

345
00:15:02,050 --> 00:15:06,339
just executed this<font color="#E5E5E5"> command we piped it</font>

346
00:15:04,360 --> 00:15:08,410
to netcat<font color="#E5E5E5"> we had another machine</font>

347
00:15:06,339 --> 00:15:11,140
<font color="#CCCCCC">listening on that IP address and port</font>

348
00:15:08,410 --> 00:15:14,589
<font color="#CCCCCC">and it basically</font><font color="#E5E5E5"> just wrote everything</font>

349
00:15:11,140 --> 00:15:16,269
from the flash piped it to netcat<font color="#E5E5E5"> and we</font>

350
00:15:14,589 --> 00:15:19,089
had a file on<font color="#CCCCCC"> the other side it</font><font color="#E5E5E5"> has all</font>

351
00:15:16,269 --> 00:15:21,640
the firmware<font color="#E5E5E5"> so now we could</font><font color="#CCCCCC"> use</font>

352
00:15:19,089 --> 00:15:22,839
<font color="#E5E5E5">traditional tools such as bin</font><font color="#CCCCCC"> walk</font><font color="#E5E5E5"> and</font>

353
00:15:21,640 --> 00:15:24,370
if you<font color="#E5E5E5"> don't know what bin walk is</font><font color="#CCCCCC"> I'll</font>

354
00:15:22,839 --> 00:15:26,740
talk about<font color="#E5E5E5"> in a second we can</font><font color="#CCCCCC"> use bin</font>

355
00:15:24,370 --> 00:15:29,529
walk<font color="#E5E5E5"> to actually extract all the files</font>

356
00:15:26,740 --> 00:15:32,980
and and look at them I'm done with this

357
00:15:29,529 --> 00:15:36,579
<font color="#E5E5E5">- we'll get back to it Trevor don't</font>

358
00:15:32,980 --> 00:15:38,079
<font color="#E5E5E5">worry you're in heaven now again the</font>

359
00:15:36,579 --> 00:15:42,699
resolution is<font color="#E5E5E5"> really weird but what we</font>

360
00:15:38,079 --> 00:15:45,969
see here<font color="#E5E5E5"> basically is we have all of</font><font color="#CCCCCC"> the</font>

361
00:15:42,700 --> 00:15:48,279
offsets<font color="#E5E5E5"> and what's in those offsets so</font>

362
00:15:45,970 --> 00:15:51,880
that it has a bunch<font color="#E5E5E5"> of lzma compressed</font>

363
00:15:48,279 --> 00:15:53,140
data up there<font color="#CCCCCC"> again it's it's</font><font color="#E5E5E5"> impossible</font>

364
00:15:51,880 --> 00:15:55,750
to read in this resolution but that's

365
00:15:53,140 --> 00:16:00,399
like the<font color="#E5E5E5"> kernel and after that that's</font>

366
00:15:55,750 --> 00:16:03,490
<font color="#E5E5E5">actually the disk partition so now when</font>

367
00:16:00,399 --> 00:16:08,260
we<font color="#CCCCCC"> have</font><font color="#E5E5E5"> access to the</font><font color="#CCCCCC"> actual files</font><font color="#E5E5E5"> we</font>

368
00:16:03,490 --> 00:16:11,649
know that<font color="#E5E5E5"> this device actually runs a</font>

369
00:16:08,260 --> 00:16:12,880
kernel from 2008<font color="#E5E5E5"> and if you if you're</font>

370
00:16:11,649 --> 00:16:15,160
<font color="#CCCCCC">into Linux you know that this version</font>

371
00:16:12,880 --> 00:16:19,240
was probably like the<font color="#CCCCCC"> worst</font><font color="#E5E5E5"> it has like</font>

372
00:16:15,160 --> 00:16:20,769
60 different kernel exploits<font color="#E5E5E5"> and that's</font>

373
00:16:19,240 --> 00:16:22,750
<font color="#CCCCCC">the kernel from 2008 running on a</font>

374
00:16:20,769 --> 00:16:25,209
product<font color="#E5E5E5"> that was purchased like last</font>

375
00:16:22,750 --> 00:16:26,649
year<font color="#E5E5E5"> so that's already bad</font>

376
00:16:25,209 --> 00:16:28,239
we know that it's running<font color="#E5E5E5"> go ahead</font>

377
00:16:26,649 --> 00:16:29,350
<font color="#E5E5E5">webserver I always I already talked</font>

378
00:16:28,240 --> 00:16:31,420
about<font color="#E5E5E5"> it and we know that the source</font>

379
00:16:29,350 --> 00:16:32,589
<font color="#E5E5E5">code</font><font color="#CCCCCC"> is available</font><font color="#E5E5E5"> so it</font><font color="#CCCCCC"> actually saves</font>

380
00:16:31,420 --> 00:16:34,689
us a<font color="#CCCCCC"> lot of work because we don't need</font>

381
00:16:32,589 --> 00:16:38,230
<font color="#E5E5E5">to use i2 bro we could just go and read</font>

382
00:16:34,690 --> 00:16:40,329
<font color="#E5E5E5">the code it has</font><font color="#CCCCCC"> a lot of cool e</font><font color="#E5E5E5"> look a</font>

383
00:16:38,230 --> 00:16:44,800
lot of poorly<font color="#E5E5E5"> written looking code along</font>

384
00:16:40,329 --> 00:16:47,109
<font color="#CCCCCC">with a lot a lot of really old</font><font color="#E5E5E5"> libraries</font>

385
00:16:44,800 --> 00:16:50,430
and<font color="#CCCCCC"> an other kind</font><font color="#E5E5E5"> of software it's like</font>

386
00:16:47,110 --> 00:16:53,670
it's a mess<font color="#E5E5E5"> and you'll see it and</font>

387
00:16:50,430 --> 00:16:56,729
the password<font color="#E5E5E5"> for the web administration</font>

388
00:16:53,670 --> 00:16:58,800
is stored in clear text<font color="#E5E5E5"> in a file that's</font>

389
00:16:56,730 --> 00:17:02,730
called<font color="#E5E5E5"> system dot ini in the web root</font>

390
00:16:58,800 --> 00:17:07,280
directory<font color="#E5E5E5"> now you can't ask for that</font>

391
00:17:02,730 --> 00:17:11,460
file<font color="#CCCCCC"> because it's</font><font color="#E5E5E5"> password</font><font color="#CCCCCC"> protected but</font>

392
00:17:07,280 --> 00:17:13,920
<font color="#CCCCCC">all of this says that something</font><font color="#E5E5E5"> has to</font>

393
00:17:11,460 --> 00:17:15,990
<font color="#CCCCCC">be vulnerable</font><font color="#E5E5E5"> there so let's take a</font>

394
00:17:13,920 --> 00:17:18,360
break from the story for a second and

395
00:17:15,990 --> 00:17:20,640
talk<font color="#E5E5E5"> about user control strings or input</font>

396
00:17:18,359 --> 00:17:22,260
or whatever you want to call it so when

397
00:17:20,640 --> 00:17:23,640
the user which<font color="#CCCCCC"> is you when you're</font>

398
00:17:22,260 --> 00:17:26,640
interacting when you're communicating

399
00:17:23,640 --> 00:17:29,520
<font color="#E5E5E5">with</font><font color="#CCCCCC"> a software</font><font color="#E5E5E5"> with a piece</font><font color="#CCCCCC"> of code you</font>

400
00:17:26,640 --> 00:17:31,320
<font color="#E5E5E5">are actually sending</font><font color="#CCCCCC"> input</font><font color="#E5E5E5"> to it now</font>

401
00:17:29,520 --> 00:17:34,379
this input<font color="#E5E5E5"> that you are sending is</font>

402
00:17:31,320 --> 00:17:36,720
controlled by<font color="#E5E5E5"> you the user now the</font>

403
00:17:34,380 --> 00:17:39,210
software<font color="#E5E5E5"> then takes this input that was</font>

404
00:17:36,720 --> 00:17:41,730
given by<font color="#CCCCCC"> you and applies some sort of</font>

405
00:17:39,210 --> 00:17:43,320
logic<font color="#E5E5E5"> some sort of that's basically the</font>

406
00:17:41,730 --> 00:17:45,120
code<font color="#CCCCCC"> that's running there so it gets</font>

407
00:17:43,320 --> 00:17:48,510
input<font color="#CCCCCC"> from you and then it applies the</font>

408
00:17:45,120 --> 00:17:52,100
<font color="#E5E5E5">logic on it now if something in that</font>

409
00:17:48,510 --> 00:17:55,020
code is vulnerable if you can subvert

410
00:17:52,100 --> 00:17:57,120
<font color="#E5E5E5">the execution path or if you can use</font>

411
00:17:55,020 --> 00:17:59,280
<font color="#E5E5E5">your</font><font color="#CCCCCC"> input to up with whatever</font>

412
00:17:57,120 --> 00:18:04,949
that's<font color="#E5E5E5"> running here then it means that</font>

413
00:17:59,280 --> 00:18:07,110
you're a<font color="#E5E5E5"> good hacker next now let's</font>

414
00:18:04,950 --> 00:18:09,350
start<font color="#E5E5E5"> mapping our attack vectors so</font>

415
00:18:07,110 --> 00:18:11,879
first of all<font color="#E5E5E5"> we need to understand where</font>

416
00:18:09,350 --> 00:18:15,240
where is or are there any<font color="#CCCCCC"> user</font>

417
00:18:11,880 --> 00:18:16,920
controlled strings<font color="#E5E5E5"> and once we found</font>

418
00:18:15,240 --> 00:18:18,360
once we find those<font color="#E5E5E5"> places we need to</font>

419
00:18:16,920 --> 00:18:21,270
understand if the code<font color="#E5E5E5"> that handles</font>

420
00:18:18,360 --> 00:18:23,399
<font color="#E5E5E5">those if the code that handles the input</font>

421
00:18:21,270 --> 00:18:24,930
from from<font color="#CCCCCC"> from the user we need to</font>

422
00:18:23,400 --> 00:18:26,250
understand if it's<font color="#CCCCCC"> vulnerable</font><font color="#E5E5E5"> and if it</font>

423
00:18:24,930 --> 00:18:30,720
is vulnerable<font color="#CCCCCC"> we need to understand how</font>

424
00:18:26,250 --> 00:18:32,340
hard is it<font color="#E5E5E5"> to exploit it so let's try</font>

425
00:18:30,720 --> 00:18:33,420
<font color="#E5E5E5">logging in to</font><font color="#CCCCCC"> the admin panel because</font>

426
00:18:32,340 --> 00:18:36,300
you know<font color="#E5E5E5"> that's where all the goodness</font>

427
00:18:33,420 --> 00:18:37,980
is so we<font color="#E5E5E5"> just visit that URL that's like</font>

428
00:18:36,300 --> 00:18:40,590
the IP<font color="#E5E5E5"> that the camera had on the</font>

429
00:18:37,980 --> 00:18:42,600
network<font color="#E5E5E5"> the port is running on the the</font>

430
00:18:40,590 --> 00:18:45,060
web server is<font color="#CCCCCC"> listening</font><font color="#E5E5E5"> on port 81</font><font color="#CCCCCC"> and</font>

431
00:18:42,600 --> 00:18:48,510
we are<font color="#E5E5E5"> immediately hit</font><font color="#CCCCCC"> with a password</font>

432
00:18:45,060 --> 00:18:50,810
box<font color="#E5E5E5"> because you</font><font color="#CCCCCC"> need to authenticate</font><font color="#E5E5E5"> in</font>

433
00:18:48,510 --> 00:18:53,810
order to get into<font color="#CCCCCC"> the admin panel</font><font color="#E5E5E5"> right</font>

434
00:18:50,810 --> 00:18:53,810
<font color="#CCCCCC">now</font>

435
00:18:58,810 --> 00:19:05,600
<font color="#E5E5E5">okay</font>

436
00:19:00,110 --> 00:19:08,719
so such<font color="#CCCCCC"> anti-climactic so the first stop</font>

437
00:19:05,600 --> 00:19:12,620
is to<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> analyze</font><font color="#CCCCCC"> the login process</font>

438
00:19:08,720 --> 00:19:13,670
what happens when you log in so let's

439
00:19:12,620 --> 00:19:16,250
talk about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> that password</font>

440
00:19:13,670 --> 00:19:19,940
authentication box the<font color="#CCCCCC"> week that</font><font color="#E5E5E5"> we we</font>

441
00:19:16,250 --> 00:19:21,560
<font color="#CCCCCC">just saw so</font><font color="#E5E5E5"> we looked at it and we it</font>

442
00:19:19,940 --> 00:19:23,390
didn't appear to<font color="#CCCCCC"> be easily exploitable I</font>

443
00:19:21,560 --> 00:19:25,700
mean there was a buffer over overflow

444
00:19:23,390 --> 00:19:27,710
there we<font color="#E5E5E5"> actually managed</font><font color="#CCCCCC"> to crash the</font>

445
00:19:25,700 --> 00:19:32,030
<font color="#E5E5E5">web server after we supplied a really</font>

446
00:19:27,710 --> 00:19:34,700
really long<font color="#E5E5E5"> username but you know</font><font color="#CCCCCC"> buffer</font>

447
00:19:32,030 --> 00:19:38,000
overflows they require writing<font color="#E5E5E5"> shell</font>

448
00:19:34,700 --> 00:19:42,020
<font color="#E5E5E5">codes and debugging and we were lazy and</font>

449
00:19:38,000 --> 00:19:43,700
<font color="#CCCCCC">I don't</font><font color="#E5E5E5"> want to do that so what happens</font>

450
00:19:42,020 --> 00:19:45,200
there it just compares the input that

451
00:19:43,700 --> 00:19:47,180
<font color="#E5E5E5">you're giving that you're giving it</font>

452
00:19:45,200 --> 00:19:49,910
basically<font color="#E5E5E5"> the</font><font color="#CCCCCC"> username and</font><font color="#E5E5E5"> password</font><font color="#CCCCCC"> it</font>

453
00:19:47,180 --> 00:19:51,110
just compares it to what's in system<font color="#E5E5E5"> I</font>

454
00:19:49,910 --> 00:19:53,030
<font color="#E5E5E5">and I that's the file I told you about</font>

455
00:19:51,110 --> 00:19:57,260
earlier<font color="#CCCCCC"> and if it matches your</font>

456
00:19:53,030 --> 00:20:01,100
authenticated now as I said buffer

457
00:19:57,260 --> 00:20:02,540
overflows<font color="#E5E5E5"> not cool on a Saturday</font><font color="#CCCCCC"> no so</font>

458
00:20:01,100 --> 00:20:04,040
let's think about it<font color="#CCCCCC"> again</font><font color="#E5E5E5"> for a moment</font>

459
00:20:02,540 --> 00:20:05,840
right so we need<font color="#E5E5E5"> to understand what is</font>

460
00:20:04,040 --> 00:20:08,629
the first point<font color="#E5E5E5"> of</font><font color="#CCCCCC"> contact of a user</font>

461
00:20:05,840 --> 00:20:12,199
<font color="#E5E5E5">control string</font><font color="#CCCCCC"> with the web server and</font>

462
00:20:08,630 --> 00:20:18,140
<font color="#E5E5E5">that is the web request itself now look</font>

463
00:20:12,200 --> 00:20:23,150
at<font color="#CCCCCC"> that gif</font><font color="#E5E5E5"> isn't it nice yeah things</font>

464
00:20:18,140 --> 00:20:26,930
were simple back then so let's talk

465
00:20:23,150 --> 00:20:30,770
about HTTP requests so this is a really

466
00:20:26,930 --> 00:20:32,660
<font color="#E5E5E5">really basic</font><font color="#CCCCCC"> example of how an HTTP</font>

467
00:20:30,770 --> 00:20:34,190
request looks<font color="#E5E5E5"> like right we have the</font>

468
00:20:32,660 --> 00:20:36,710
action that we<font color="#CCCCCC"> want to do</font><font color="#E5E5E5"> that's in red</font>

469
00:20:34,190 --> 00:20:38,720
that's get we<font color="#E5E5E5"> want to get a file we're</font>

470
00:20:36,710 --> 00:20:40,340
requesting we then have the path of the

471
00:20:38,720 --> 00:20:43,070
file that<font color="#E5E5E5"> we're requesting that's in</font>

472
00:20:40,340 --> 00:20:45,679
green<font color="#CCCCCC"> that slash index dot ASP</font><font color="#E5E5E5"> now slash</font>

473
00:20:43,070 --> 00:20:50,570
is really important because when<font color="#E5E5E5"> you're</font>

474
00:20:45,680 --> 00:20:52,100
using HTTP sorry<font color="#E5E5E5"> you have to start with</font>

475
00:20:50,570 --> 00:20:54,710
a slash you have to start<font color="#E5E5E5"> from the root</font>

476
00:20:52,100 --> 00:20:57,230
<font color="#E5E5E5">and build your URL from there and then</font>

477
00:20:54,710 --> 00:21:00,040
in<font color="#E5E5E5"> the end in black we have HTTP slash</font>

478
00:20:57,230 --> 00:21:02,690
1.1 that's the protocol that<font color="#E5E5E5"> we're using</font>

479
00:21:00,040 --> 00:21:05,220
now if everything<font color="#CCCCCC"> checks out if all the</font>

480
00:21:02,690 --> 00:21:07,080
permission check out if everything is<font color="#CCCCCC"> OK</font>

481
00:21:05,220 --> 00:21:11,120
the server<font color="#E5E5E5"> then responds with something</font>

482
00:21:07,080 --> 00:21:15,210
that's called an HTTP response 200<font color="#CCCCCC"> ok</font>

483
00:21:11,120 --> 00:21:17,389
<font color="#CCCCCC">reply</font><font color="#E5E5E5"> and that packet that HTTP packet</font>

484
00:21:15,210 --> 00:21:20,160
that you're<font color="#E5E5E5"> getting are actually a</font>

485
00:21:17,390 --> 00:21:21,390
series of packets will contain the data

486
00:21:20,160 --> 00:21:23,400
<font color="#E5E5E5">that you've asked for</font>

487
00:21:21,390 --> 00:21:24,780
and again that's that's all going<font color="#E5E5E5"> to</font>

488
00:21:23,400 --> 00:21:26,330
<font color="#E5E5E5">happen if everything checks out if the</font>

489
00:21:24,780 --> 00:21:29,610
page exists if the permission are<font color="#CCCCCC"> okay</font>

490
00:21:26,330 --> 00:21:31,199
<font color="#E5E5E5">that's ever so let's go</font><font color="#CCCCCC"> and as I said</font>

491
00:21:29,610 --> 00:21:33,360
<font color="#E5E5E5">this is open source</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> can actually</font>

492
00:21:31,200 --> 00:21:36,630
<font color="#E5E5E5">look</font><font color="#CCCCCC"> and look</font><font color="#E5E5E5"> for that code and find it</font>

493
00:21:33,360 --> 00:21:39,540
so we actually went<font color="#CCCCCC"> ten years back</font><font color="#E5E5E5"> and</font>

494
00:21:36,630 --> 00:21:42,660
get<font color="#E5E5E5"> because we discovered</font><font color="#CCCCCC"> back right at</font>

495
00:21:39,540 --> 00:21:45,420
that<font color="#CCCCCC"> moment</font><font color="#E5E5E5"> we realized that while this</font>

496
00:21:42,660 --> 00:21:47,540
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> actually this thing as I said it</font>

497
00:21:45,420 --> 00:21:50,070
<font color="#E5E5E5">runs</font>

498
00:21:47,540 --> 00:21:52,230
go ahead<font color="#E5E5E5"> webserver it was running a</font>

499
00:21:50,070 --> 00:21:56,280
version from like<font color="#E5E5E5"> ten or twelve</font><font color="#CCCCCC"> years</font>

500
00:21:52,230 --> 00:21:58,380
ago<font color="#E5E5E5"> so we had to go way way way</font><font color="#CCCCCC"> way back</font>

501
00:21:56,280 --> 00:22:00,780
in to get<font color="#CCCCCC"> repository to</font><font color="#E5E5E5"> find that</font>

502
00:21:58,380 --> 00:22:02,790
vulnerable code<font color="#E5E5E5"> so we found that</font>

503
00:22:00,780 --> 00:22:04,200
function<font color="#CCCCCC"> webOS get port and we you know</font>

504
00:22:02,790 --> 00:22:05,970
we<font color="#E5E5E5"> took it from there because we</font><font color="#CCCCCC"> saw</font>

505
00:22:04,200 --> 00:22:08,940
<font color="#CCCCCC">that</font><font color="#E5E5E5"> like you can see on the top</font><font color="#CCCCCC"> it like</font>

506
00:22:05,970 --> 00:22:10,800
<font color="#E5E5E5">it takes the the web request the</font><font color="#CCCCCC"> Pardons</font>

507
00:22:08,940 --> 00:22:13,350
start figuring out which is<font color="#E5E5E5"> which and</font>

508
00:22:10,800 --> 00:22:16,379
where is wearing the request and then we

509
00:22:13,350 --> 00:22:20,520
saw that<font color="#E5E5E5"> and that's where things start</font>

510
00:22:16,380 --> 00:22:22,560
to get stupid<font color="#E5E5E5"> so as you can see those</font>

511
00:22:20,520 --> 00:22:26,010
<font color="#E5E5E5">three red arrows they point for the most</font>

512
00:22:22,560 --> 00:22:27,810
alarming thing in this whole<font color="#E5E5E5"> research</font><font color="#CCCCCC"> so</font>

513
00:22:26,010 --> 00:22:30,090
as I said there are<font color="#E5E5E5"> several types</font><font color="#CCCCCC"> of</font>

514
00:22:27,810 --> 00:22:31,970
requests<font color="#CCCCCC"> right there you</font><font color="#E5E5E5"> have get you</font>

515
00:22:30,090 --> 00:22:35,399
have post you have<font color="#CCCCCC"> head</font><font color="#E5E5E5"> whatever now</font>

516
00:22:31,970 --> 00:22:37,560
again HTTP is a protocol<font color="#E5E5E5"> it has when</font><font color="#CCCCCC"> you</font>

517
00:22:35,400 --> 00:22:40,350
are working<font color="#CCCCCC"> with it you have to work by</font>

518
00:22:37,560 --> 00:22:42,659
the protocol and if you send a<font color="#CCCCCC"> request</font>

519
00:22:40,350 --> 00:22:44,550
that's malformed<font color="#E5E5E5"> or if you send</font>

520
00:22:42,660 --> 00:22:46,140
something that doesn't<font color="#E5E5E5"> doesn't conform</font>

521
00:22:44,550 --> 00:22:48,840
with<font color="#E5E5E5"> the HTTP standard you'll get an</font>

522
00:22:46,140 --> 00:22:52,490
<font color="#E5E5E5">error and that error is called 400 bad</font>

523
00:22:48,840 --> 00:22:56,399
request you<font color="#E5E5E5"> can see it right right here</font>

524
00:22:52,490 --> 00:23:01,140
so basically<font color="#CCCCCC"> what this code says it says</font>

525
00:22:56,400 --> 00:23:05,690
if the user sends an HTTP request<font color="#CCCCCC"> that</font>

526
00:23:01,140 --> 00:23:09,060
is not a get a post or a head request

527
00:23:05,690 --> 00:23:12,270
you need to send him<font color="#CCCCCC"> back a</font><font color="#E5E5E5"> 400 error</font>

528
00:23:09,060 --> 00:23:15,240
<font color="#CCCCCC">bade</font><font color="#E5E5E5"> bad HTTP request but the thing is</font>

529
00:23:12,270 --> 00:23:17,160
<font color="#E5E5E5">that you can do whatever you want</font>

530
00:23:15,240 --> 00:23:18,809
whatever<font color="#CCCCCC"> request you want you can send</font>

531
00:23:17,160 --> 00:23:20,280
the<font color="#CCCCCC"> card the content of the request can</font>

532
00:23:18,809 --> 00:23:22,678
be<font color="#E5E5E5"> whatever you want as</font><font color="#CCCCCC"> long as it had</font>

533
00:23:20,280 --> 00:23:28,170
guests along as it as long<font color="#CCCCCC"> as it's</font><font color="#E5E5E5"> a get</font>

534
00:23:22,679 --> 00:23:31,320
a post or<font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> request right so recap</font>

535
00:23:28,170 --> 00:23:34,500
<font color="#E5E5E5">an HTTP request</font><font color="#CCCCCC"> is only</font><font color="#E5E5E5"> considered legit</font>

536
00:23:31,320 --> 00:23:37,010
<font color="#E5E5E5">if there is a slash at the beginning of</font>

537
00:23:34,500 --> 00:23:40,080
it<font color="#E5E5E5"> because we have to</font><font color="#CCCCCC"> start from slash</font>

538
00:23:37,010 --> 00:23:42,809
<font color="#E5E5E5">there is no real exception handling of</font>

539
00:23:40,080 --> 00:23:45,270
<font color="#E5E5E5">rep of web</font><font color="#CCCCCC"> requests you will only get a</font>

540
00:23:42,809 --> 00:23:49,320
four hundred error if the<font color="#E5E5E5"> request that</font>

541
00:23:45,270 --> 00:23:52,639
you sent is not a post<font color="#CCCCCC"> a</font><font color="#E5E5E5"> get or</font><font color="#CCCCCC"> ahead</font>

542
00:23:49,320 --> 00:23:56,370
request<font color="#E5E5E5"> things are about to get stupid</font>

543
00:23:52,640 --> 00:24:01,350
<font color="#E5E5E5">so if will send a request like</font><font color="#CCCCCC"> this and</font>

544
00:23:56,370 --> 00:24:03,928
I actually live demo number one this<font color="#CCCCCC"> is</font>

545
00:24:01,350 --> 00:24:05,520
<font color="#E5E5E5">so weird with</font><font color="#CCCCCC"> that resolution</font><font color="#E5E5E5"> so what</font>

546
00:24:03,929 --> 00:24:08,490
I'm gonna do I'm<font color="#CCCCCC"> gonna connect to</font><font color="#E5E5E5"> the</font>

547
00:24:05,520 --> 00:24:13,080
web request to the<font color="#CCCCCC"> web server</font><font color="#E5E5E5"> right and</font>

548
00:24:08,490 --> 00:24:17,309
I'm gonna send a normal request get

549
00:24:13,080 --> 00:24:21,300
system dot ini HTTP<font color="#CCCCCC"> and as</font><font color="#E5E5E5"> you can see</font>

550
00:24:17,309 --> 00:24:23,940
<font color="#E5E5E5">we get an error unauthorized right now</font>

551
00:24:21,300 --> 00:24:26,399
we got that<font color="#E5E5E5"> error because we were trying</font>

552
00:24:23,940 --> 00:24:28,800
to<font color="#E5E5E5"> ask</font><font color="#CCCCCC"> for the file it has</font><font color="#E5E5E5"> the password</font>

553
00:24:26,400 --> 00:24:30,690
<font color="#CCCCCC">now that file is protected by the</font>

554
00:24:28,800 --> 00:24:32,340
<font color="#E5E5E5">password we just requested we didn't do</font>

555
00:24:30,690 --> 00:24:35,010
any<font color="#E5E5E5"> authentication so we got an error</font>

556
00:24:32,340 --> 00:24:38,699
<font color="#E5E5E5">but as I said the request can contain</font>

557
00:24:35,010 --> 00:24:41,400
anything<font color="#CCCCCC"> as long as it's a get request</font>

558
00:24:38,700 --> 00:24:45,030
or a post or<font color="#E5E5E5"> a head requested so live</font>

559
00:24:41,400 --> 00:24:46,350
demo number one<font color="#E5E5E5"> we're gonna clear</font><font color="#CCCCCC"> that</font>

560
00:24:45,030 --> 00:24:47,970
I'm<font color="#CCCCCC"> gonna do that</font><font color="#E5E5E5"> again</font>

561
00:24:46,350 --> 00:24:53,070
<font color="#E5E5E5">and this</font><font color="#CCCCCC"> time I'm gonna do get system</font>

562
00:24:47,970 --> 00:24:54,929
<font color="#CCCCCC">dot ini no slash right no slash every</font>

563
00:24:53,070 --> 00:24:57,419
other web server should give me an error

564
00:24:54,929 --> 00:25:00,220
but if I'll do this I'm going<font color="#E5E5E5"> to get the</font>

565
00:24:57,420 --> 00:25:04,549
file with<font color="#E5E5E5"> the password</font>

566
00:25:00,220 --> 00:25:06,410
so it has a bunch<font color="#E5E5E5"> of binary crap in it</font>

567
00:25:04,549 --> 00:25:09,350
that's<font color="#E5E5E5"> the question marks ignore it but</font>

568
00:25:06,410 --> 00:25:11,570
you can see under the<font color="#CCCCCC"> nist.gov</font>

569
00:25:09,350 --> 00:25:17,030
if you look one line<font color="#E5E5E5"> below it you'll see</font>

570
00:25:11,570 --> 00:25:18,950
admin and then<font color="#E5E5E5"> za q q SW CDE admin is</font>

571
00:25:17,030 --> 00:25:22,190
the<font color="#CCCCCC"> username</font><font color="#E5E5E5"> hard-coded can't change it</font>

572
00:25:18,950 --> 00:25:24,620
and what follows it is the<font color="#E5E5E5"> password now</font>

573
00:25:22,190 --> 00:25:25,820
remember the weak password thing that

574
00:25:24,620 --> 00:25:27,620
they<font color="#E5E5E5"> said</font><font color="#CCCCCC"> that there is a warning</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you</font>

575
00:25:25,820 --> 00:25:29,510
set a weak password<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they said in</font>

576
00:25:27,620 --> 00:25:32,809
their banner where there's no<font color="#E5E5E5"> security</font>

577
00:25:29,510 --> 00:25:34,700
<font color="#CCCCCC">vulnerability worries</font><font color="#E5E5E5"> so I really wanted</font>

578
00:25:32,809 --> 00:25:36,710
to impress<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> you and I wanted</font><font color="#E5E5E5"> to</font>

579
00:25:34,700 --> 00:25:38,450
set a really strong password with a

580
00:25:36,710 --> 00:25:39,770
whole bunch<font color="#CCCCCC"> of numbers and characters in</font>

581
00:25:38,450 --> 00:25:41,360
uppercase and lower in the work<font color="#CCCCCC"> is like</font>

582
00:25:39,770 --> 00:25:43,220
I want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> I wanted to</font><font color="#CCCCCC"> show</font><font color="#E5E5E5"> you how</font>

583
00:25:41,360 --> 00:25:45,139
useless it<font color="#E5E5E5"> is</font><font color="#CCCCCC"> but every time I try to</font>

584
00:25:43,220 --> 00:25:47,240
<font color="#E5E5E5">set a strong password</font><font color="#CCCCCC"> I got an error and</font>

585
00:25:45,140 --> 00:25:48,470
I couldn't understand<font color="#E5E5E5"> why so I started</font>

586
00:25:47,240 --> 00:25:50,740
<font color="#CCCCCC">reverse-engineering the</font><font color="#E5E5E5"> server</font><font color="#CCCCCC"> and</font>

587
00:25:48,470 --> 00:25:55,250
debugging<font color="#E5E5E5"> it and then I saw that the</font>

588
00:25:50,740 --> 00:26:00,710
<font color="#CCCCCC">developers</font><font color="#E5E5E5"> made a mistake it's really</font>

589
00:25:55,250 --> 00:26:03,110
bad<font color="#E5E5E5"> they used an or instead of an end so</font>

590
00:26:00,710 --> 00:26:06,460
a password can only be all lowercase<font color="#E5E5E5"> all</font>

591
00:26:03,110 --> 00:26:06,459
uppercase or all numbers

592
00:26:08,059 --> 00:26:20,730
no more<font color="#E5E5E5"> security vulnerability worries</font>

593
00:26:11,450 --> 00:26:22,500
so that was live demo number<font color="#E5E5E5"> one that's</font>

594
00:26:20,730 --> 00:26:25,860
<font color="#E5E5E5">my backup but it worked</font><font color="#CCCCCC"> okay so demo</font>

595
00:26:22,500 --> 00:26:28,350
number one<font color="#E5E5E5"> and as we saw we got the file</font>

596
00:26:25,860 --> 00:26:31,740
with<font color="#E5E5E5"> the password now you're all saying</font>

597
00:26:28,350 --> 00:26:34,590
well great<font color="#E5E5E5"> so you have the password to</font>

598
00:26:31,740 --> 00:26:36,600
<font color="#E5E5E5">the camera and</font><font color="#CCCCCC"> you can like look at</font>

599
00:26:34,590 --> 00:26:37,678
<font color="#CCCCCC">whatever it is you know you look at</font>

600
00:26:36,600 --> 00:26:39,120
<font color="#CCCCCC">whatever it is it's filming it's</font>

601
00:26:37,679 --> 00:26:41,070
recording me<font color="#E5E5E5"> you could look into someone</font>

602
00:26:39,120 --> 00:26:44,010
<font color="#CCCCCC">living into someone's living</font><font color="#E5E5E5"> room</font><font color="#CCCCCC"> wow</font>

603
00:26:41,070 --> 00:26:50,760
<font color="#E5E5E5">this is not news this was like the first</font>

604
00:26:44,010 --> 00:26:53,419
episode<font color="#CCCCCC"> in CSI cyber so what we did</font>

605
00:26:50,760 --> 00:26:56,000
after<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we started like going through</font>

606
00:26:53,419 --> 00:26:59,370
<font color="#E5E5E5">the admin panel now as you can</font><font color="#CCCCCC"> see</font>

607
00:26:56,000 --> 00:27:03,000
<font color="#CCCCCC">beautiful</font><font color="#E5E5E5"> design breathtaking user</font>

608
00:26:59,370 --> 00:27:04,860
experience<font color="#E5E5E5"> now whenever</font><font color="#CCCCCC"> I do those sort</font>

609
00:27:03,000 --> 00:27:06,990
of things<font color="#CCCCCC"> I'm a one-trick</font><font color="#E5E5E5"> pony so</font>

610
00:27:04,860 --> 00:27:10,949
whatever what I always<font color="#E5E5E5"> do is whenever I</font>

611
00:27:06,990 --> 00:27:13,020
see those<font color="#E5E5E5"> boxes</font><font color="#CCCCCC"> that get</font><font color="#E5E5E5"> input what what</font>

612
00:27:10,950 --> 00:27:16,230
I always<font color="#E5E5E5"> do is I</font><font color="#CCCCCC"> just type semicolon</font>

613
00:27:13,020 --> 00:27:17,790
reboot<font color="#E5E5E5"> in them and I hit submit</font><font color="#CCCCCC"> and if</font>

614
00:27:16,230 --> 00:27:19,740
the<font color="#E5E5E5"> device reboots</font><font color="#CCCCCC"> it means that we have</font>

615
00:27:17,790 --> 00:27:24,320
<font color="#E5E5E5">code execution is</font><font color="#CCCCCC"> root it's super simple</font>

616
00:27:19,740 --> 00:27:29,940
<font color="#CCCCCC">so I did</font><font color="#E5E5E5"> that and the device rebooted</font>

617
00:27:24,320 --> 00:27:31,740
we're like<font color="#CCCCCC"> now that</font><font color="#E5E5E5"> means</font><font color="#CCCCCC"> that</font>

618
00:27:29,940 --> 00:27:34,169
someone<font color="#CCCCCC"> is calling system with user</font>

619
00:27:31,740 --> 00:27:36,120
input<font color="#CCCCCC"> bad idea</font><font color="#E5E5E5"> now if you don't know</font>

620
00:27:34,169 --> 00:27:38,669
what system is this<font color="#E5E5E5"> is a standard</font><font color="#CCCCCC"> C call</font>

621
00:27:36,120 --> 00:27:40,168
that's in stdlib.h<font color="#CCCCCC"> what you basically do</font>

622
00:27:38,669 --> 00:27:42,150
is<font color="#E5E5E5"> you call a function</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> called</font>

623
00:27:40,169 --> 00:27:43,500
system and you pass the argument to it

624
00:27:42,150 --> 00:27:45,660
the<font color="#E5E5E5"> argument is the command you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to</font>

625
00:27:43,500 --> 00:27:47,790
execute the command will then be

626
00:27:45,660 --> 00:27:49,740
executed as a child process<font color="#E5E5E5"> of the</font>

627
00:27:47,790 --> 00:27:52,799
process that<font color="#E5E5E5"> has this so in that case</font>

628
00:27:49,740 --> 00:27:55,350
when I when I<font color="#E5E5E5"> when I wrote reboot and</font>

629
00:27:52,799 --> 00:27:58,650
submitted it<font color="#E5E5E5"> what happened is the</font>

630
00:27:55,350 --> 00:28:00,689
<font color="#CCCCCC">webserver executed reboot as a child</font>

631
00:27:58,650 --> 00:28:03,630
process<font color="#E5E5E5"> of its own and then the camera</font>

632
00:28:00,690 --> 00:28:05,940
rebooted so that means also<font color="#E5E5E5"> that the web</font>

633
00:28:03,630 --> 00:28:08,130
server<font color="#CCCCCC"> is running as root because it</font>

634
00:28:05,940 --> 00:28:10,500
rebooted<font color="#CCCCCC"> the device never run anything</font>

635
00:28:08,130 --> 00:28:11,910
<font color="#CCCCCC">that's facing</font><font color="#E5E5E5"> the Internet as root</font>

636
00:28:10,500 --> 00:28:15,710
that's a bad idea you're<font color="#E5E5E5"> gonna have a</font>

637
00:28:11,910 --> 00:28:18,630
bad time<font color="#CCCCCC"> now I always always say this</font>

638
00:28:15,710 --> 00:28:19,610
because I've done<font color="#E5E5E5"> this specific talk</font>

639
00:28:18,630 --> 00:28:21,590
several<font color="#E5E5E5"> times</font>

640
00:28:19,610 --> 00:28:24,020
other talks about like intuitive

641
00:28:21,590 --> 00:28:26,780
security<font color="#CCCCCC"> I see this everywhere</font>

642
00:28:24,020 --> 00:28:28,370
everywhere<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> worked on more than I</font>

643
00:28:26,780 --> 00:28:32,120
think<font color="#E5E5E5"> about like three or four hundred</font>

644
00:28:28,370 --> 00:28:35,299
devices<font color="#CCCCCC"> and majority of them like</font><font color="#E5E5E5"> 75%</font>

645
00:28:32,120 --> 00:28:36,428
<font color="#CCCCCC">did this don't ever</font><font color="#E5E5E5"> do this this</font><font color="#CCCCCC"> is a</font>

646
00:28:35,299 --> 00:28:39,170
<font color="#E5E5E5">bad idea</font>

647
00:28:36,429 --> 00:28:40,670
<font color="#E5E5E5">now that is</font><font color="#CCCCCC"> actually called</font><font color="#E5E5E5"> a command</font>

648
00:28:39,170 --> 00:28:43,580
injection vulnerability and<font color="#CCCCCC"> that means</font>

649
00:28:40,670 --> 00:28:46,370
that the input<font color="#E5E5E5"> that's being provided by</font>

650
00:28:43,580 --> 00:28:48,169
the user<font color="#CCCCCC"> the input that goes to the CGI</font>

651
00:28:46,370 --> 00:28:51,379
handler that<font color="#E5E5E5"> we talked about is not</font>

652
00:28:48,170 --> 00:28:53,660
<font color="#CCCCCC">being</font><font color="#E5E5E5"> sanitized right that means the</font>

653
00:28:51,380 --> 00:28:55,730
input is being sprinted directly into a

654
00:28:53,660 --> 00:28:57,350
<font color="#CCCCCC">buffer that called that the system is</font>

655
00:28:55,730 --> 00:28:59,330
being<font color="#E5E5E5"> called with that buffer that's</font>

656
00:28:57,350 --> 00:29:01,820
being passed<font color="#CCCCCC"> directly</font><font color="#E5E5E5"> to system no one</font>

657
00:28:59,330 --> 00:29:04,129
cares about what's going on<font color="#E5E5E5"> in the input</font>

658
00:29:01,820 --> 00:29:07,399
because it just compiled so it's<font color="#E5E5E5"> okay</font>

659
00:29:04,130 --> 00:29:09,380
<font color="#E5E5E5">and no one is</font><font color="#CCCCCC"> looking forward</font><font color="#E5E5E5"> no one</font><font color="#CCCCCC"> is</font>

660
00:29:07,400 --> 00:29:11,120
looking to see if<font color="#E5E5E5"> you have those</font>

661
00:29:09,380 --> 00:29:13,640
characters<font color="#E5E5E5"> in there the semicolon the</font>

662
00:29:11,120 --> 00:29:15,320
pipe and and<font color="#CCCCCC"> and backtick there</font><font color="#E5E5E5"> are</font>

663
00:29:13,640 --> 00:29:18,700
other<font color="#E5E5E5"> variations but these are like the</font>

664
00:29:15,320 --> 00:29:22,939
<font color="#E5E5E5">the usual ones usual suspects so</font>

665
00:29:18,700 --> 00:29:25,220
<font color="#E5E5E5">semicolon means</font><font color="#CCCCCC"> run this command like</font>

666
00:29:22,940 --> 00:29:28,940
you do semi-cold reboot so it means<font color="#E5E5E5"> run</font>

667
00:29:25,220 --> 00:29:31,010
reboot once you finish running the

668
00:29:28,940 --> 00:29:33,169
command<font color="#E5E5E5"> you ran before pipe means take</font>

669
00:29:31,010 --> 00:29:35,450
that<font color="#E5E5E5"> take what it take the output of one</font>

670
00:29:33,169 --> 00:29:37,130
program<font color="#E5E5E5"> and pipe it</font><font color="#CCCCCC"> into another program</font>

671
00:29:35,450 --> 00:29:40,040
so all<font color="#E5E5E5"> of those are tricks that you can</font>

672
00:29:37,130 --> 00:29:41,870
<font color="#CCCCCC">use</font><font color="#E5E5E5"> to do command injections and now</font>

673
00:29:40,040 --> 00:29:43,790
it's<font color="#E5E5E5"> ida pro time</font><font color="#CCCCCC"> i mean you know i said</font>

674
00:29:41,870 --> 00:29:45,080
<font color="#CCCCCC">okay i have to see if that</font><font color="#E5E5E5"> is what i</font>

675
00:29:43,790 --> 00:29:47,030
<font color="#E5E5E5">think it is because i mean it rebooted</font>

676
00:29:45,080 --> 00:29:48,830
but i wanted<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be sure so i looked at</font>

677
00:29:47,030 --> 00:29:52,370
it<font color="#CCCCCC"> a night of pro and</font><font color="#E5E5E5"> if you remember</font>

678
00:29:48,830 --> 00:29:54,350
that<font color="#E5E5E5"> page</font><font color="#CCCCCC"> i'll go</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> that page is it's</font>

679
00:29:52,370 --> 00:29:58,100
called<font color="#E5E5E5"> the mail sending page so this</font>

680
00:29:54,350 --> 00:30:00,620
camera<font color="#CCCCCC"> has a feature and it constantly</font>

681
00:29:58,100 --> 00:30:03,260
it's consciously looking at your house

682
00:30:00,620 --> 00:30:05,659
or<font color="#CCCCCC"> whatever you put</font><font color="#E5E5E5"> it and if it detects</font>

683
00:30:03,260 --> 00:30:09,860
any motion<font color="#E5E5E5"> any movement it can send you</font>

684
00:30:05,660 --> 00:30:13,250
an<font color="#CCCCCC"> e-mail now when it sends that email</font>

685
00:30:09,860 --> 00:30:15,049
<font color="#E5E5E5">it actually looks like this there is</font><font color="#CCCCCC"> a</font>

686
00:30:13,250 --> 00:30:17,690
string<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you can tell it okay send me</font>

687
00:30:15,049 --> 00:30:19,450
<font color="#E5E5E5">an</font><font color="#CCCCCC"> e-mail</font><font color="#E5E5E5"> it has a string in it</font><font color="#CCCCCC"> i don't</font>

688
00:30:17,690 --> 00:30:24,230
know someone<font color="#E5E5E5"> is breaking into</font><font color="#CCCCCC"> your house</font>

689
00:30:19,450 --> 00:30:26,570
and pipe it into<font color="#CCCCCC"> another process</font><font color="#E5E5E5"> that's</font>

690
00:30:24,230 --> 00:30:28,450
called<font color="#E5E5E5"> mail</font><font color="#CCCCCC"> x and there's a</font><font color="#E5E5E5"> bunch of</font>

691
00:30:26,570 --> 00:30:31,350
<font color="#E5E5E5">arguments here - a whatever that means</font>

692
00:30:28,450 --> 00:30:33,030
percentages<font color="#CCCCCC"> and again</font>

693
00:30:31,350 --> 00:30:36,539
another percentage<font color="#CCCCCC"> s</font><font color="#E5E5E5"> is all</font><font color="#CCCCCC"> over the</font>

694
00:30:33,030 --> 00:30:38,700
<font color="#CCCCCC">place</font><font color="#E5E5E5"> we inject our command into those</font>

695
00:30:36,539 --> 00:30:41,100
<font color="#E5E5E5">places because</font><font color="#CCCCCC"> no one sanitizes the</font>

696
00:30:38,700 --> 00:30:44,490
<font color="#E5E5E5">input right so that means that we</font><font color="#CCCCCC"> have</font>

697
00:30:41,100 --> 00:30:45,750
remote code execution<font color="#E5E5E5"> so we're almost at</font>

698
00:30:44,490 --> 00:30:49,980
demo time

699
00:30:45,750 --> 00:30:51,900
now<font color="#E5E5E5"> um when I did this in Derby gone</font>

700
00:30:49,980 --> 00:30:54,059
Trevor you probably remember<font color="#CCCCCC"> that</font><font color="#E5E5E5"> when</font>

701
00:30:51,900 --> 00:30:57,960
you<font color="#CCCCCC"> surprised</font><font color="#E5E5E5"> me with this disgusting</font>

702
00:30:54,059 --> 00:31:03,240
what was it<font color="#CCCCCC"> sima yeah that was fun</font>

703
00:30:57,960 --> 00:31:04,289
warm Zima hot Zima I said because I did

704
00:31:03,240 --> 00:31:08,039
this<font color="#E5E5E5"> stuff before</font><font color="#CCCCCC"> and everybody said</font>

705
00:31:04,289 --> 00:31:10,379
well you know it's not really impressive

706
00:31:08,039 --> 00:31:13,710
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the camera has to have all of</font>

707
00:31:10,380 --> 00:31:16,740
<font color="#CCCCCC">its ports</font><font color="#E5E5E5"> exposed the</font><font color="#CCCCCC"> Internet and</font><font color="#E5E5E5"> this</font>

708
00:31:13,710 --> 00:31:18,600
<font color="#E5E5E5">is like a nice POC but in usual</font><font color="#CCCCCC"> cases it</font>

709
00:31:16,740 --> 00:31:19,860
<font color="#CCCCCC">doesn't happen</font><font color="#E5E5E5"> only like one port is</font>

710
00:31:18,600 --> 00:31:21,719
forwarded to the camera<font color="#E5E5E5"> and if you want</font>

711
00:31:19,860 --> 00:31:24,299
to pop a shell if it's not a reverse

712
00:31:21,720 --> 00:31:26,400
<font color="#CCCCCC">shell and I'm not doing a reverse shell</font>

713
00:31:24,299 --> 00:31:29,190
in that case you have<font color="#CCCCCC"> to have a port</font>

714
00:31:26,400 --> 00:31:32,370
open that's forwarded<font color="#E5E5E5"> into the shell we</font>

715
00:31:29,190 --> 00:31:33,720
want to connect and people<font color="#E5E5E5"> talk when</font><font color="#CCCCCC"> I</font>

716
00:31:32,370 --> 00:31:35,010
did my damn it's like<font color="#E5E5E5"> oh yeah it's not</font>

717
00:31:33,720 --> 00:31:36,570
<font color="#CCCCCC">it's not really impressive because</font><font color="#E5E5E5"> your</font>

718
00:31:35,010 --> 00:31:38,610
camera<font color="#CCCCCC"> is connected directly to your</font>

719
00:31:36,570 --> 00:31:40,908
computer<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> know you have all the</font>

720
00:31:38,610 --> 00:31:44,789
ports<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I said okay challenge accepted</font>

721
00:31:40,909 --> 00:31:46,200
<font color="#CCCCCC">so I built this setup in this</font><font color="#E5E5E5"> setup is</font>

722
00:31:44,789 --> 00:31:48,360
<font color="#CCCCCC">actually we have the attack machine</font>

723
00:31:46,200 --> 00:31:52,049
<font color="#E5E5E5">which is my laptop</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we have a router</font>

724
00:31:48,360 --> 00:31:54,299
<font color="#E5E5E5">and I have a shitty router here and our</font>

725
00:31:52,049 --> 00:31:56,970
attack machine<font color="#E5E5E5"> is connected</font><font color="#CCCCCC"> to the</font>

726
00:31:54,299 --> 00:31:58,289
router<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the LAN side right to simulate</font>

727
00:31:56,970 --> 00:32:00,480
<font color="#E5E5E5">that we are like coming from the</font>

728
00:31:58,289 --> 00:32:02,340
<font color="#E5E5E5">internet the router has the camera</font>

729
00:32:00,480 --> 00:32:04,559
<font color="#E5E5E5">connected to it on the land side and it</font>

730
00:32:02,340 --> 00:32:07,199
<font color="#CCCCCC">has a Raspberry Pi</font><font color="#E5E5E5"> and there</font><font color="#CCCCCC"> I I'm gonna</font>

731
00:32:04,559 --> 00:32:09,030
<font color="#E5E5E5">use the Raspberry Pi to basically</font>

732
00:32:07,200 --> 00:32:10,559
simulate<font color="#E5E5E5"> another machine</font><font color="#CCCCCC"> on a network</font>

733
00:32:09,030 --> 00:32:13,139
and<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to show you how I'm going</font>

734
00:32:10,559 --> 00:32:15,960
<font color="#CCCCCC">to pivot</font><font color="#E5E5E5"> from the camera to</font><font color="#CCCCCC"> that machine</font>

735
00:32:13,140 --> 00:32:18,090
<font color="#E5E5E5">by forwarding ports by actually taking</font>

736
00:32:15,960 --> 00:32:21,419
advantage<font color="#CCCCCC"> of the router</font><font color="#E5E5E5"> now that works</font>

737
00:32:18,090 --> 00:32:25,199
in<font color="#CCCCCC"> almost any case</font><font color="#E5E5E5"> if you have</font><font color="#CCCCCC"> UPnP</font>

738
00:32:21,419 --> 00:32:26,789
turned on now the reason this diagram is

739
00:32:25,200 --> 00:32:29,070
kind of<font color="#E5E5E5"> ugly</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it looks</font><font color="#CCCCCC"> like this</font><font color="#E5E5E5"> is</font>

740
00:32:26,789 --> 00:32:30,780
<font color="#E5E5E5">because I'm</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> bad at doing graphic</font>

741
00:32:29,070 --> 00:32:33,360
<font color="#E5E5E5">stuff and I didn't have anyone to</font><font color="#CCCCCC"> help</font>

742
00:32:30,780 --> 00:32:34,678
me<font color="#E5E5E5"> and another thing is I mean I'm a</font>

743
00:32:33,360 --> 00:32:36,780
foreigner I moved to the US last year

744
00:32:34,679 --> 00:32:38,970
<font color="#E5E5E5">and when I</font><font color="#CCCCCC"> stepped the block that says</font>

745
00:32:36,780 --> 00:32:42,379
attack machine<font color="#E5E5E5"> was originally</font><font color="#CCCCCC"> here and</font>

746
00:32:38,970 --> 00:32:42,380
then I realized<font color="#E5E5E5"> it looks like a dick</font>

747
00:32:44,320 --> 00:32:50,899
and after a year<font color="#E5E5E5"> after here in the US</font><font color="#CCCCCC"> I</font>

748
00:32:48,800 --> 00:32:55,070
learned that<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> offensive to</font><font color="#E5E5E5"> some</font>

749
00:32:50,900 --> 00:33:02,810
<font color="#CCCCCC">people okay</font><font color="#E5E5E5"> don't want to cause</font><font color="#CCCCCC"> any</font>

750
00:32:55,070 --> 00:33:05,929
right so so what I'm actually<font color="#E5E5E5"> gonna do</font>

751
00:33:02,810 --> 00:33:07,790
now<font color="#E5E5E5"> is I'm gonna I wrote I wrote some I</font>

752
00:33:05,930 --> 00:33:10,160
wrote some exploit code that does

753
00:33:07,790 --> 00:33:12,710
everything<font color="#E5E5E5"> I show</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> now but instead of</font>

754
00:33:10,160 --> 00:33:14,960
executing<font color="#E5E5E5"> a semicolon reboot I'm going</font>

755
00:33:12,710 --> 00:33:17,810
to execute<font color="#E5E5E5"> semicolon</font><font color="#CCCCCC"> telling it</font><font color="#E5E5E5"> D</font>

756
00:33:14,960 --> 00:33:21,140
because the camera has on its image<font color="#E5E5E5"> like</font>

757
00:33:17,810 --> 00:33:22,700
the kind<font color="#E5E5E5"> folks that that you know</font>

758
00:33:21,140 --> 00:33:24,050
<font color="#CCCCCC">created the image that's running</font><font color="#E5E5E5"> on that</font>

759
00:33:22,700 --> 00:33:26,960
<font color="#E5E5E5">camera they were kind</font><font color="#CCCCCC"> enough to include</font>

760
00:33:24,050 --> 00:33:28,970
all sorts<font color="#CCCCCC"> of really</font><font color="#E5E5E5"> really nice tools</font>

761
00:33:26,960 --> 00:33:31,670
<font color="#E5E5E5">for security researchers such as netcat</font>

762
00:33:28,970 --> 00:33:33,020
and<font color="#CCCCCC"> DD</font><font color="#E5E5E5"> that we used before to extract</font><font color="#CCCCCC"> to</font>

763
00:33:31,670 --> 00:33:35,600
extract the data from<font color="#CCCCCC"> the camera</font><font color="#E5E5E5"> and</font>

764
00:33:33,020 --> 00:33:36,440
they also included a telnet server<font color="#CCCCCC"> how</font>

765
00:33:35,600 --> 00:33:39,679
<font color="#E5E5E5">convenient</font>

766
00:33:36,440 --> 00:33:42,380
I don't need<font color="#CCCCCC"> to write</font><font color="#E5E5E5"> shellcode now what</font>

767
00:33:39,680 --> 00:33:45,500
<font color="#E5E5E5">this command does is running town of D</font>

768
00:33:42,380 --> 00:33:47,330
and -<font color="#E5E5E5"> P says what port you want to use</font>

769
00:33:45,500 --> 00:33:50,330
<font color="#E5E5E5">so I'm gonna say</font><font color="#CCCCCC"> just use port</font><font color="#E5E5E5"> 4 4 4 4</font>

770
00:33:47,330 --> 00:33:51,530
<font color="#E5E5E5">now the problem is that if you ever use</font>

771
00:33:50,330 --> 00:33:53,179
telnet you know that when you're

772
00:33:51,530 --> 00:33:55,910
connecting to<font color="#E5E5E5"> tell it it asks you for</font>

773
00:33:53,180 --> 00:33:58,760
your<font color="#E5E5E5"> username and password</font><font color="#CCCCCC"> now I don't</font>

774
00:33:55,910 --> 00:33:59,780
know what the<font color="#E5E5E5"> user name is I mean I know</font>

775
00:33:58,760 --> 00:34:01,220
that<font color="#CCCCCC"> the</font><font color="#E5E5E5"> user name is rude</font><font color="#CCCCCC"> but I don't</font>

776
00:33:59,780 --> 00:34:03,050
<font color="#CCCCCC">know what the password is because I had</font>

777
00:34:01,220 --> 00:34:05,990
<font color="#E5E5E5">nothing to do with</font><font color="#CCCCCC"> the image I have no</font>

778
00:34:03,050 --> 00:34:07,760
idea what's in<font color="#E5E5E5"> /et c / bas WG like what</font>

779
00:34:05,990 --> 00:34:09,800
what what<font color="#CCCCCC"> what's in there</font><font color="#E5E5E5"> I don't know</font>

780
00:34:07,760 --> 00:34:12,260
<font color="#E5E5E5">what the password is but telethia has a</font>

781
00:34:09,800 --> 00:34:15,169
really cool flag that's called<font color="#E5E5E5"> - L and -</font>

782
00:34:12,260 --> 00:34:18,380
L means what program do you<font color="#E5E5E5"> want me to</font>

783
00:34:15,168 --> 00:34:20,690
run<font color="#E5E5E5"> after a connection has been</font>

784
00:34:18,380 --> 00:34:24,710
established<font color="#CCCCCC"> so I'm saying just run VIN</font>

785
00:34:20,690 --> 00:34:30,380
<font color="#CCCCCC">SH</font><font color="#E5E5E5"> and give me a shell so that's my</font>

786
00:34:24,710 --> 00:34:32,540
trick so what I'm also gonna<font color="#CCCCCC"> show you is</font>

787
00:34:30,380 --> 00:34:34,490
how I'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to take advantage of UPnP</font>

788
00:34:32,540 --> 00:34:39,409
so let's talk<font color="#E5E5E5"> about that after I'll show</font>

789
00:34:34,489 --> 00:34:41,239
you this so as<font color="#E5E5E5"> I said I wrote some</font>

790
00:34:39,409 --> 00:34:44,360
exploit code and it's here it's called

791
00:34:41,239 --> 00:34:47,109
camp own so I'm gonna say I'm gonna have

792
00:34:44,360 --> 00:34:47,110
it saved here

793
00:34:49,190 --> 00:34:55,889
so what I'm doing<font color="#E5E5E5"> now is I'm sending</font>

794
00:34:52,560 --> 00:34:57,480
<font color="#CCCCCC">that</font><font color="#E5E5E5"> broken packet without the slash</font><font color="#CCCCCC"> and</font>

795
00:34:55,889 --> 00:34:59,550
I actually had<font color="#CCCCCC"> to write that myself</font>

796
00:34:57,480 --> 00:35:02,670
<font color="#E5E5E5">because all the Python modules that are</font>

797
00:34:59,550 --> 00:35:04,920
<font color="#E5E5E5">doing HTTP requests such as</font><font color="#CCCCCC"> request or</font>

798
00:35:02,670 --> 00:35:07,200
URL<font color="#E5E5E5"> live or whatever they can't send</font>

799
00:35:04,920 --> 00:35:08,880
<font color="#E5E5E5">this packet because</font><font color="#CCCCCC"> this packet doesn't</font>

800
00:35:07,200 --> 00:35:10,680
conform with the HTTP standard so<font color="#CCCCCC"> I i'm</font>

801
00:35:08,880 --> 00:35:12,540
actually using raw sockets to create the

802
00:35:10,680 --> 00:35:15,000
request that sending a<font color="#E5E5E5"> get request</font>

803
00:35:12,540 --> 00:35:17,970
<font color="#CCCCCC">without the slash so first what happens</font>

804
00:35:15,000 --> 00:35:19,950
is it<font color="#CCCCCC"> asked for system I and I to</font>

805
00:35:17,970 --> 00:35:24,899
extract<font color="#CCCCCC"> the password from</font><font color="#E5E5E5"> it so it did</font>

806
00:35:19,950 --> 00:35:27,000
it here<font color="#E5E5E5"> and then it opens a root</font><font color="#CCCCCC"> shell</font>

807
00:35:24,900 --> 00:35:29,760
using the talent the talent trick I

808
00:35:27,000 --> 00:35:32,760
showed you now as I said<font color="#E5E5E5"> this is</font>

809
00:35:29,760 --> 00:35:34,650
<font color="#E5E5E5">connected this is like the</font><font color="#CCCCCC"> internet so</font>

810
00:35:32,760 --> 00:35:37,980
now<font color="#E5E5E5"> there's a root shell waiting</font><font color="#CCCCCC"> for me</font>

811
00:35:34,650 --> 00:35:42,900
<font color="#CCCCCC">on</font><font color="#E5E5E5"> port</font><font color="#CCCCCC"> 4 4 4 4 but if I connect</font><font color="#E5E5E5"> to the</font>

812
00:35:37,980 --> 00:35:44,520
camera<font color="#E5E5E5"> on port 4 4 4 4 it's not going to</font>

813
00:35:42,900 --> 00:35:46,619
work it's not<font color="#CCCCCC"> going to connect because</font>

814
00:35:44,520 --> 00:35:53,609
<font color="#E5E5E5">this fort isn't forwarded on the router</font>

815
00:35:46,619 --> 00:35:56,490
to<font color="#CCCCCC"> the camera but as I said we have UPnP</font>

816
00:35:53,609 --> 00:35:58,700
enabled on<font color="#CCCCCC"> the router</font><font color="#E5E5E5"> most of you</font>

817
00:35:56,490 --> 00:36:01,709
<font color="#E5E5E5">probably have UPnP enabled on your</font>

818
00:35:58,700 --> 00:36:04,080
<font color="#CCCCCC">router at home I really hope that</font><font color="#E5E5E5"> most</font>

819
00:36:01,710 --> 00:36:06,630
<font color="#E5E5E5">of you are</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to turn</font><font color="#CCCCCC"> UPnP off after</font>

820
00:36:04,080 --> 00:36:10,109
you'll see this so if you don't know

821
00:36:06,630 --> 00:36:12,359
what<font color="#CCCCCC"> UPnP is or to be specific you</font><font color="#E5E5E5"> PNP</font>

822
00:36:10,109 --> 00:36:15,060
<font color="#CCCCCC">IgD Internet gateway device</font><font color="#E5E5E5"> and that's</font>

823
00:36:12,359 --> 00:36:17,190
<font color="#E5E5E5">the RFC if you really want to read it</font>

824
00:36:15,060 --> 00:36:20,190
you<font color="#CCCCCC"> pienty is a protocol that basically</font>

825
00:36:17,190 --> 00:36:22,260
allows<font color="#E5E5E5"> software to connect to the</font><font color="#CCCCCC"> UPnP</font>

826
00:36:20,190 --> 00:36:24,570
<font color="#E5E5E5">api that's on your router and ask it to</font>

827
00:36:22,260 --> 00:36:26,869
forward ports<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> LAN side to the</font>

828
00:36:24,570 --> 00:36:28,950
<font color="#CCCCCC">landside</font><font color="#E5E5E5"> so for example if you use Skype</font>

829
00:36:26,869 --> 00:36:30,690
Skype was I think one of the first

830
00:36:28,950 --> 00:36:32,069
programs that used you can<font color="#CCCCCC"> pee so like</font>

831
00:36:30,690 --> 00:36:33,440
you<font color="#E5E5E5"> know it needs to forward port</font>

832
00:36:32,070 --> 00:36:36,359
because if you're<font color="#E5E5E5"> behind a NAT router</font>

833
00:36:33,440 --> 00:36:38,580
<font color="#E5E5E5">your computer isn't accessible from</font><font color="#CCCCCC"> the</font>

834
00:36:36,359 --> 00:36:39,779
<font color="#CCCCCC">internet so Skype</font><font color="#E5E5E5"> for example sends</font><font color="#CCCCCC"> a</font>

835
00:36:38,580 --> 00:36:43,710
<font color="#CCCCCC">request that our</font><font color="#E5E5E5"> our and say hey router</font>

836
00:36:39,780 --> 00:36:45,990
<font color="#CCCCCC">I need you to</font><font color="#E5E5E5"> forward me port 1 1 1 1 to</font>

837
00:36:43,710 --> 00:36:50,280
this IP address<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the land side to port</font>

838
00:36:45,990 --> 00:36:54,149
1 1 1 1<font color="#E5E5E5"> TCP now that seemed to be a good</font>

839
00:36:50,280 --> 00:36:57,440
idea back at the time like JavaScript or

840
00:36:54,150 --> 00:37:01,340
brexit<font color="#E5E5E5"> or a lot of</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> horrible ideas</font>

841
00:36:57,440 --> 00:37:03,470
now<font color="#E5E5E5"> these cameras have a UPnP client on</font>

842
00:37:01,340 --> 00:37:05,150
them the server as I said is running on

843
00:37:03,470 --> 00:37:09,859
the router but the client is<font color="#CCCCCC"> running on</font>

844
00:37:05,150 --> 00:37:11,210
the camera<font color="#CCCCCC"> and because I know I know</font><font color="#E5E5E5"> and</font>

845
00:37:09,860 --> 00:37:13,220
I<font color="#E5E5E5"> know it because</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> reverse</font><font color="#CCCCCC"> engineer</font><font color="#E5E5E5"> the</font>

846
00:37:11,210 --> 00:37:15,860
code and<font color="#E5E5E5"> I saw that at some point</font><font color="#CCCCCC"> it</font>

847
00:37:13,220 --> 00:37:22,759
calls a file called<font color="#E5E5E5"> UPN PC static and</font>

848
00:37:15,860 --> 00:37:24,470
passes a bunch of<font color="#CCCCCC"> arguments to it so</font>

849
00:37:22,760 --> 00:37:26,900
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what you PNP static looks like</font>

850
00:37:24,470 --> 00:37:28,459
like on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> camera so you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> see I can</font>

851
00:37:26,900 --> 00:37:32,600
just<font color="#E5E5E5"> ask it I can just</font><font color="#CCCCCC"> call it an I say</font>

852
00:37:28,460 --> 00:37:35,030
-<font color="#CCCCCC"> a add IP space</font><font color="#E5E5E5"> port space external</font>

853
00:37:32,600 --> 00:37:36,830
<font color="#E5E5E5">port space protocol basically I can open</font>

854
00:37:35,030 --> 00:37:38,870
any port I want on your network<font color="#E5E5E5"> and you</font>

855
00:37:36,830 --> 00:37:41,930
<font color="#CCCCCC">can redirect it to</font><font color="#E5E5E5"> anything</font><font color="#CCCCCC"> that you</font>

856
00:37:38,870 --> 00:37:43,549
have on your<font color="#CCCCCC"> network</font><font color="#E5E5E5"> only</font><font color="#CCCCCC"> because you</font>

857
00:37:41,930 --> 00:37:49,430
use a shitty camera<font color="#E5E5E5"> that you got off of</font>

858
00:37:43,550 --> 00:37:54,140
<font color="#E5E5E5">Amazon so let me show you</font><font color="#CCCCCC"> that so what I</font>

859
00:37:49,430 --> 00:37:58,509
did<font color="#CCCCCC"> is I wrote another exploit</font><font color="#E5E5E5"> and I</font>

860
00:37:54,140 --> 00:38:05,410
called it<font color="#E5E5E5"> you peen</font><font color="#CCCCCC"> Campo UPnP</font><font color="#E5E5E5"> and</font>

861
00:37:58,510 --> 00:38:05,410
basically I can just forward that port

862
00:38:11,810 --> 00:38:20,120
<font color="#CCCCCC">I just realized that</font><font color="#E5E5E5"> I forgot what's the</font>

863
00:38:16,820 --> 00:38:24,620
internal IP of<font color="#CCCCCC"> the camera inside a</font>

864
00:38:20,120 --> 00:38:29,299
network<font color="#E5E5E5"> I'm gonna I'm gonna see if</font><font color="#CCCCCC"> it's</font>

865
00:38:24,620 --> 00:38:34,430
this<font color="#E5E5E5"> I totally forgot what what the IP</font>

866
00:38:29,300 --> 00:38:35,870
of<font color="#E5E5E5"> the camera inside the network</font><font color="#CCCCCC"> is so</font>

867
00:38:34,430 --> 00:38:37,310
if that demo is<font color="#E5E5E5"> gonna fail it's not</font>

868
00:38:35,870 --> 00:38:39,740
because of<font color="#E5E5E5"> the demo gods because I'm an</font>

869
00:38:37,310 --> 00:38:50,810
idiot<font color="#E5E5E5"> that's like the only thing I</font>

870
00:38:39,740 --> 00:38:57,410
didn't test so we're waiting<font color="#E5E5E5"> for that to</font>

871
00:38:50,810 --> 00:39:01,630
run now while it's running<font color="#E5E5E5"> you know what</font>

872
00:38:57,410 --> 00:39:03,500
I won't waste<font color="#E5E5E5"> your</font><font color="#CCCCCC"> time with waiting I</font>

873
00:39:01,630 --> 00:39:05,750
want<font color="#CCCCCC"> to talk to you about some</font>

874
00:39:03,500 --> 00:39:08,510
interesting<font color="#E5E5E5"> facts</font><font color="#CCCCCC"> so the slash</font>

875
00:39:05,750 --> 00:39:10,460
vulnerability so we went and and

876
00:39:08,510 --> 00:39:11,870
disclosed it and did responsible

877
00:39:10,460 --> 00:39:14,300
disclosure which came back to<font color="#E5E5E5"> bite us</font>

878
00:39:11,870 --> 00:39:16,790
back in the ass<font color="#E5E5E5"> and it was actually</font>

879
00:39:14,300 --> 00:39:19,280
<font color="#CCCCCC">discovered</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> this guy Luigi Aoyama on a</font>

880
00:39:16,790 --> 00:39:22,550
printer that was<font color="#E5E5E5"> using that that server</font>

881
00:39:19,280 --> 00:39:24,260
back in 2004<font color="#E5E5E5"> so</font><font color="#CCCCCC"> what we</font><font color="#E5E5E5"> thought was a</font>

882
00:39:22,550 --> 00:39:26,570
<font color="#CCCCCC">zero-day was</font><font color="#E5E5E5"> actually like a four</font>

883
00:39:24,260 --> 00:39:29,290
thousand seventy seven hundred<font color="#CCCCCC"> and forty</font>

884
00:39:26,570 --> 00:39:34,040
<font color="#E5E5E5">five day exploit which you can</font>

885
00:39:29,290 --> 00:39:35,210
demonstrates how shitty that<font color="#CCCCCC"> thing is so</font>

886
00:39:34,040 --> 00:39:36,890
we got to see<font color="#E5E5E5"> these four that</font>

887
00:39:35,210 --> 00:39:39,110
vulnerability those are<font color="#E5E5E5"> two CVEs</font><font color="#CCCCCC"> and</font>

888
00:39:36,890 --> 00:39:42,049
then any<font color="#E5E5E5"> of you heard</font><font color="#CCCCCC"> about the purser</font>

889
00:39:39,110 --> 00:39:44,570
the percy<font color="#CCCCCC"> roy botnet it's like another</font>

890
00:39:42,050 --> 00:39:46,730
botnet like<font color="#CCCCCC"> mirai so they actually used</font>

891
00:39:44,570 --> 00:39:51,020
our<font color="#CCCCCC"> exploits</font><font color="#E5E5E5"> because we responsibly</font>

892
00:39:46,730 --> 00:39:55,840
disclosed them so this<font color="#E5E5E5"> is like not our</font>

893
00:39:51,020 --> 00:39:55,840
fault<font color="#E5E5E5"> don't deport me</font>

894
00:39:58,150 --> 00:40:10,760
let's see if it finished<font color="#CCCCCC"> okay let's try</font>

895
00:40:02,150 --> 00:40:14,210
<font color="#E5E5E5">that yes and as you can see we now have</font>

896
00:40:10,760 --> 00:40:16,100
<font color="#E5E5E5">a new shell</font><font color="#CCCCCC"> I can show you I'll do ID as</font>

897
00:40:14,210 --> 00:40:19,910
you can see I'm UID 0

898
00:40:16,100 --> 00:40:22,490
I'm<font color="#CCCCCC"> Brut that's CODIS execution</font><font color="#E5E5E5"> that</font>

899
00:40:19,910 --> 00:40:24,350
works on every<font color="#CCCCCC"> router that has European</font>

900
00:40:22,490 --> 00:40:26,450
<font color="#CCCCCC">be turned on every</font><font color="#E5E5E5"> router doesn't matter</font>

901
00:40:24,350 --> 00:40:30,650
which vendor<font color="#CCCCCC"> even like an expensive</font>

902
00:40:26,450 --> 00:40:35,000
<font color="#E5E5E5">Cisco so kill your</font><font color="#CCCCCC"> UPnP that's running</font>

903
00:40:30,650 --> 00:40:37,070
<font color="#E5E5E5">on</font><font color="#CCCCCC"> your router some routers like cheap</font>

904
00:40:35,000 --> 00:40:38,780
routers such as this thing I bought here

905
00:40:37,070 --> 00:40:41,000
<font color="#E5E5E5">you can see it it's a router that cost</font>

906
00:40:38,780 --> 00:40:44,930
me<font color="#E5E5E5"> 10</font><font color="#CCCCCC"> bucks I got</font><font color="#E5E5E5"> it for my demo at</font>

907
00:40:41,000 --> 00:40:48,410
Derby con<font color="#E5E5E5"> as I said I have some I have</font>

908
00:40:44,930 --> 00:40:52,190
<font color="#E5E5E5">like</font><font color="#CCCCCC"> 5 minutes so I can actually give</font>

909
00:40:48,410 --> 00:40:54,920
you a bonus because<font color="#E5E5E5"> my hobby is to break</font>

910
00:40:52,190 --> 00:40:56,690
into cheap so I can actually<font color="#E5E5E5"> show</font>

911
00:40:54,920 --> 00:40:59,900
<font color="#CCCCCC">you real quick how shitty those things</font>

912
00:40:56,690 --> 00:41:01,430
are I have another<font color="#E5E5E5"> vulnerability</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I</font>

913
00:40:59,900 --> 00:41:06,070
found on that<font color="#E5E5E5"> router so that router</font>

914
00:41:01,430 --> 00:41:08,629
<font color="#E5E5E5">always listens on always listens on port</font>

915
00:41:06,070 --> 00:41:11,120
8080 for its administration<font color="#CCCCCC"> panel on the</font>

916
00:41:08,630 --> 00:41:12,980
internet side you can<font color="#E5E5E5"> turn it off now if</font>

917
00:41:11,120 --> 00:41:15,560
you send this HTTP request with no

918
00:41:12,980 --> 00:41:17,360
authentication<font color="#E5E5E5"> you'll get all of the</font>

919
00:41:15,560 --> 00:41:19,310
configuration including like the Wi-Fi

920
00:41:17,360 --> 00:41:21,950
password the whatever like everything

921
00:41:19,310 --> 00:41:24,080
<font color="#CCCCCC">isn't</font><font color="#E5E5E5"> there so like those things are</font>

922
00:41:21,950 --> 00:41:27,410
<font color="#CCCCCC">really crappy and it's like clear text</font>

923
00:41:24,080 --> 00:41:29,600
now remember I told you<font color="#E5E5E5"> about the</font>

924
00:41:27,410 --> 00:41:32,810
Raspberry Pi<font color="#E5E5E5"> so I want to show you</font>

925
00:41:29,600 --> 00:41:35,299
something so I showed you<font color="#CCCCCC"> how I open the</font>

926
00:41:32,810 --> 00:41:37,430
port and forward it<font color="#E5E5E5"> to this camera but I</font>

927
00:41:35,300 --> 00:41:40,280
also have a Raspberry Pi that I<font color="#E5E5E5"> hope</font>

928
00:41:37,430 --> 00:41:42,200
it's yes<font color="#E5E5E5"> seems to be working I also have</font>

929
00:41:40,280 --> 00:41:43,580
a Raspberry Pi<font color="#E5E5E5"> on a network that's</font>

930
00:41:42,200 --> 00:41:45,649
simulating another<font color="#CCCCCC"> machine right and</font>

931
00:41:43,580 --> 00:41:51,980
that<font color="#E5E5E5"> Raspberry Pi is running a web</font>

932
00:41:45,650 --> 00:41:54,920
server and<font color="#CCCCCC"> I want to show you yeah I</font>

933
00:41:51,980 --> 00:41:58,250
want to<font color="#E5E5E5"> show you this is really</font>

934
00:41:54,920 --> 00:42:03,030
<font color="#CCCCCC">difficult if I'll try to connect on this</font>

935
00:41:58,250 --> 00:42:07,080
sport<font color="#E5E5E5"> oh I already ran it</font>

936
00:42:03,030 --> 00:42:08,640
so anyways it doesn't<font color="#CCCCCC"> matter I just</font>

937
00:42:07,080 --> 00:42:10,160
saved you like three minutes<font color="#CCCCCC"> so what</font>

938
00:42:08,640 --> 00:42:12,299
happened is I use the same exploit

939
00:42:10,160 --> 00:42:15,870
here's the same exploit to forward a

940
00:42:12,300 --> 00:42:18,240
port from I so I connected<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the</font>

941
00:42:15,870 --> 00:42:20,339
<font color="#E5E5E5">Internet to the camera executed the</font><font color="#CCCCCC"> UPnP</font>

942
00:42:18,240 --> 00:42:23,250
<font color="#CCCCCC">client</font><font color="#E5E5E5"> that went to the router and said</font>

943
00:42:20,340 --> 00:42:25,830
hey I want<font color="#CCCCCC"> you to forward port this port</font>

944
00:42:23,250 --> 00:42:28,290
10,000 to the IP address of<font color="#E5E5E5"> the</font>

945
00:42:25,830 --> 00:42:29,790
Raspberry Pi which is<font color="#E5E5E5"> like completely</font>

946
00:42:28,290 --> 00:42:32,580
unrelated to this<font color="#E5E5E5"> whole to this whole</font>

947
00:42:29,790 --> 00:42:34,290
<font color="#E5E5E5">thing so that means that I can use a</font>

948
00:42:32,580 --> 00:42:37,170
shitty device<font color="#E5E5E5"> on your network to</font>

949
00:42:34,290 --> 00:42:40,740
basically<font color="#E5E5E5"> hone your entire network</font><font color="#CCCCCC"> and</font>

950
00:42:37,170 --> 00:42:44,520
<font color="#CCCCCC">just do whatever I want with it um some</font>

951
00:42:40,740 --> 00:42:45,990
<font color="#CCCCCC">shoutouts</font><font color="#E5E5E5"> because I'm like done my</font>

952
00:42:44,520 --> 00:42:49,050
friends<font color="#E5E5E5"> from cyber</font><font color="#CCCCCC"> reasons some of them</font>

953
00:42:45,990 --> 00:42:52,229
are here<font color="#CCCCCC"> Zak cutlip</font><font color="#E5E5E5"> and Craig Hefner</font>

954
00:42:49,050 --> 00:42:54,630
like<font color="#E5E5E5"> I owe this people pretty</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> my</font>

955
00:42:52,230 --> 00:42:56,190
career like they're<font color="#E5E5E5"> really awesome and</font>

956
00:42:54,630 --> 00:42:59,010
you<font color="#CCCCCC"> know if you know this he's really</font>

957
00:42:56,190 --> 00:43:01,020
<font color="#CCCCCC">cool he pushed me to do a bunch of talks</font>

958
00:42:59,010 --> 00:43:02,850
and conferences<font color="#CCCCCC"> Patrick</font><font color="#E5E5E5"> quarterly he's a</font>

959
00:43:01,020 --> 00:43:03,810
really<font color="#CCCCCC"> cool guy does a lot</font><font color="#E5E5E5"> of he's a</font>

960
00:43:02,850 --> 00:43:05,580
good friend<font color="#CCCCCC"> of mine does</font><font color="#E5E5E5"> a lot of</font>

961
00:43:03,810 --> 00:43:08,190
<font color="#E5E5E5">security research tools for max which is</font>

962
00:43:05,580 --> 00:43:10,230
<font color="#CCCCCC">also a thing</font><font color="#E5E5E5"> I do and he</font><font color="#CCCCCC"> also like I</font>

963
00:43:08,190 --> 00:43:11,970
always<font color="#CCCCCC"> talk to him</font><font color="#E5E5E5"> and like those people</font>

964
00:43:10,230 --> 00:43:14,280
in Jonathan Levin<font color="#E5E5E5"> wrote like the best</font>

965
00:43:11,970 --> 00:43:16,049
book on<font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> OS security like those</font>

966
00:43:14,280 --> 00:43:17,790
people<font color="#E5E5E5"> are like the people I come to</font>

967
00:43:16,050 --> 00:43:20,970
talk<font color="#CCCCCC"> to and come to bounce</font><font color="#E5E5E5"> ideas back</font>

968
00:43:17,790 --> 00:43:22,740
bounce ideas off with and that that's

969
00:43:20,970 --> 00:43:24,870
what<font color="#E5E5E5"> makes this</font><font color="#CCCCCC"> community great in this</font>

970
00:43:22,740 --> 00:43:26,879
<font color="#E5E5E5">industry like</font><font color="#CCCCCC"> you know if you take</font><font color="#E5E5E5"> apart</font>

971
00:43:24,870 --> 00:43:27,990
<font color="#E5E5E5">if you take out</font><font color="#CCCCCC"> all the drama from it</font>

972
00:43:26,880 --> 00:43:28,350
like especially if you're<font color="#E5E5E5"> like on</font>

973
00:43:27,990 --> 00:43:30,540
<font color="#CCCCCC">Twitter</font>

974
00:43:28,350 --> 00:43:33,120
<font color="#E5E5E5">it's like those kind of things that make</font>

975
00:43:30,540 --> 00:43:34,740
<font color="#CCCCCC">this thing cool</font><font color="#E5E5E5"> because like I'm getting</font>

976
00:43:33,120 --> 00:43:36,750
paid to do what<font color="#E5E5E5"> I like and this is</font>

977
00:43:34,740 --> 00:43:38,220
<font color="#E5E5E5">awesome and</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> all of us are</font><font color="#CCCCCC"> doing</font>

978
00:43:36,750 --> 00:43:39,330
<font color="#E5E5E5">it and it's because</font><font color="#CCCCCC"> of people like this</font>

979
00:43:38,220 --> 00:43:41,939
an atmosphere<font color="#CCCCCC"> like this</font><font color="#E5E5E5"> in the community</font>

980
00:43:39,330 --> 00:43:45,710
<font color="#CCCCCC">so don't be assholes to each other like</font>

981
00:43:41,940 --> 00:43:45,710
be nice thank you

982
00:43:47,770 --> 00:43:53,410
<font color="#CCCCCC">I think we have like</font><font color="#E5E5E5"> two minutes for</font>

983
00:43:51,850 --> 00:44:00,390
<font color="#E5E5E5">questions if anyone wants to</font><font color="#CCCCCC"> ask</font>

984
00:43:53,410 --> 00:44:00,390
something very good<font color="#CCCCCC"> oh yeah</font>

985
00:44:12,460 --> 00:44:18,260
the question was<font color="#E5E5E5"> and it's a very good</font>

986
00:44:15,800 --> 00:44:21,050
<font color="#E5E5E5">question</font><font color="#CCCCCC"> the question was</font><font color="#E5E5E5"> well I showed</font>

987
00:44:18,260 --> 00:44:22,970
how I forwarded<font color="#CCCCCC"> I afford</font><font color="#E5E5E5"> at a port to</font>

988
00:44:21,050 --> 00:44:24,230
<font color="#E5E5E5">the Raspberry Pi</font><font color="#CCCCCC"> but in order</font><font color="#E5E5E5"> to afford</font>

989
00:44:22,970 --> 00:44:26,990
<font color="#E5E5E5">that port I needed to know</font><font color="#CCCCCC"> the IP</font>

990
00:44:24,230 --> 00:44:30,380
address of<font color="#E5E5E5"> that in inside the network so</font>

991
00:44:26,990 --> 00:44:32,569
there isn't<font color="#E5E5E5"> and and you know if there's</font>

992
00:44:30,380 --> 00:44:34,820
any<font color="#CCCCCC"> way I can scan or fuzz</font><font color="#E5E5E5"> those IP</font>

993
00:44:32,570 --> 00:44:39,410
addresses<font color="#CCCCCC"> there</font><font color="#E5E5E5"> isn't really an easy way</font>

994
00:44:34,820 --> 00:44:41,839
<font color="#CCCCCC">what I usually do is I just forward a</font>

995
00:44:39,410 --> 00:44:44,210
<font color="#E5E5E5">whole bunch</font><font color="#CCCCCC"> of ports</font><font color="#E5E5E5"> like you know port</font>

996
00:44:41,839 --> 00:44:45,500
<font color="#E5E5E5">80 port one foot like 145 like default</font>

997
00:44:44,210 --> 00:44:47,930
ports I just forward all of<font color="#E5E5E5"> them and</font>

998
00:44:45,500 --> 00:44:51,770
then I<font color="#E5E5E5"> just I started like scanning it</font>

999
00:44:47,930 --> 00:44:58,910
scanning it from the outside<font color="#CCCCCC"> any other</font>

1000
00:44:51,770 --> 00:45:00,710
questions yeah yeah yes<font color="#E5E5E5"> so the question</font>

1001
00:44:58,910 --> 00:45:03,290
<font color="#CCCCCC">was if it was possible to do a reverse</font>

1002
00:45:00,710 --> 00:45:06,040
shell<font color="#CCCCCC"> it was possible</font><font color="#E5E5E5"> it's just</font><font color="#CCCCCC"> not such</font>

1003
00:45:03,290 --> 00:45:12,470
a cool<font color="#E5E5E5"> like this is a cooler demo</font>

1004
00:45:06,040 --> 00:45:28,640
another questions the router vendor<font color="#CCCCCC"> 10</font>

1005
00:45:12,470 --> 00:45:29,990
<font color="#E5E5E5">de 10 bucks pristine so really good</font>

1006
00:45:28,640 --> 00:45:31,910
<font color="#E5E5E5">question so</font><font color="#CCCCCC"> the question is if the</font>

1007
00:45:29,990 --> 00:45:33,589
crappy v-star can make<font color="#CCCCCC"> foscam</font><font color="#E5E5E5"> so</font>

1008
00:45:31,910 --> 00:45:35,660
actually what<font color="#CCCCCC"> i</font><font color="#E5E5E5"> found out when</font><font color="#CCCCCC"> i bought</font>

1009
00:45:33,589 --> 00:45:38,480
<font color="#CCCCCC">all of those cameras so foscam is a</font>

1010
00:45:35,660 --> 00:45:42,560
<font color="#E5E5E5">completely different company but they're</font>

1011
00:45:38,480 --> 00:45:44,300
low in their<font color="#CCCCCC"> low-end stuff is that</font><font color="#E5E5E5"> their</font>

1012
00:45:42,560 --> 00:45:49,790
higher end stuff which is<font color="#CCCCCC"> also really</font>

1013
00:45:44,300 --> 00:45:51,260
shitty<font color="#CCCCCC"> run</font><font color="#E5E5E5"> is running different code but</font>

1014
00:45:49,790 --> 00:45:53,270
the lower end stuff I think they<font color="#E5E5E5"> out</font>

1015
00:45:51,260 --> 00:45:54,050
<font color="#E5E5E5">sourced it from them because it's like</font>

1016
00:45:53,270 --> 00:45:55,759
<font color="#E5E5E5">it works</font>

1017
00:45:54,050 --> 00:45:57,290
I have<font color="#CCCCCC"> Foskey and one of those cameras</font>

1018
00:45:55,760 --> 00:46:00,880
<font color="#CCCCCC">that I showed earlier one</font><font color="#E5E5E5"> of them was a</font>

1019
00:45:57,290 --> 00:46:00,880
<font color="#CCCCCC">foscam from and it looked like</font><font color="#E5E5E5"> this</font>

1020
00:46:05,710 --> 00:46:10,400
that's a problem<font color="#CCCCCC"> because</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't think I</font>

1021
00:46:08,420 --> 00:46:12,770
mean I always<font color="#E5E5E5"> like people</font><font color="#CCCCCC"> ask Missy</font><font color="#E5E5E5"> I</font>

1022
00:46:10,400 --> 00:46:16,520
<font color="#E5E5E5">don't know get a nest or something</font><font color="#CCCCCC"> but I</font>

1023
00:46:12,770 --> 00:46:19,280
mean no one<font color="#E5E5E5"> found something on nest cams</font>

1024
00:46:16,520 --> 00:46:23,330
<font color="#E5E5E5">yet</font><font color="#CCCCCC"> so like</font><font color="#E5E5E5"> it's it's a problem you know</font>

1025
00:46:19,280 --> 00:46:25,310
<font color="#CCCCCC">I think I'm done</font>

1026
00:46:23,330 --> 00:46:27,740
if anyone<font color="#E5E5E5"> wants to ask me more questions</font>

1027
00:46:25,310 --> 00:46:30,200
we can do it like<font color="#E5E5E5"> after I clear all</font><font color="#CCCCCC"> of</font>

1028
00:46:27,740 --> 00:46:32,560
<font color="#CCCCCC">that mess from here thank you</font><font color="#E5E5E5"> guys thank</font>

1029
00:46:30,200 --> 00:46:32,560
you<font color="#CCCCCC"> very much</font>

