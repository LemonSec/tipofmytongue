1
00:00:03,170 --> 00:00:08,490
hello everyone my name<font color="#CCCCCC"> is marcin Hodge</font>

2
00:00:06,000 --> 00:00:11,879
and<font color="#E5E5E5"> I'm from</font><font color="#CCCCCC"> fireEye's advanced</font>

3
00:00:08,490 --> 00:00:14,699
practices team<font color="#E5E5E5"> our advanced practices</font>

4
00:00:11,879 --> 00:00:17,670
team consists of<font color="#E5E5E5"> two sub teams one</font><font color="#CCCCCC"> of</font>

5
00:00:14,699 --> 00:00:20,450
them is adversary<font color="#CCCCCC"> Pursuit</font><font color="#E5E5E5"> I'm the member</font>

6
00:00:17,670 --> 00:00:22,800
<font color="#E5E5E5">of this team</font><font color="#CCCCCC"> and our core mission is to</font>

7
00:00:20,450 --> 00:00:26,400
pursue groups that matter across

8
00:00:22,800 --> 00:00:30,119
<font color="#CCCCCC">fireEye's ecosystem there's some sort of</font>

9
00:00:26,400 --> 00:00:32,399
adjacent team called adversary methods

10
00:00:30,119 --> 00:00:35,210
and<font color="#CCCCCC"> dannielle Bohanon that presented</font>

11
00:00:32,399 --> 00:00:39,300
<font color="#CCCCCC">yesterday is a member of this team and</font>

12
00:00:35,210 --> 00:00:42,030
<font color="#E5E5E5">their core mission is to apply the</font>

13
00:00:39,300 --> 00:00:44,720
knowledge of attacker<font color="#E5E5E5"> attackers</font>

14
00:00:42,030 --> 00:00:49,470
tradecraft<font color="#CCCCCC"> in order</font><font color="#E5E5E5"> to develop</font>

15
00:00:44,720 --> 00:00:54,120
actionable signals and detect<font color="#E5E5E5"> groups</font>

16
00:00:49,470 --> 00:00:56,250
that matter I'm<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to talk today</font>

17
00:00:54,120 --> 00:01:01,078
about threat intelligence and how we do

18
00:00:56,250 --> 00:01:05,519
<font color="#E5E5E5">it</font><font color="#CCCCCC"> but before I dive into</font><font color="#E5E5E5"> the details</font>

19
00:01:01,079 --> 00:01:17,880
<font color="#E5E5E5">let me quickly introduce myself and and</font>

20
00:01:05,519 --> 00:01:19,889
the idea<font color="#CCCCCC"> behind this presentation I'm</font>

21
00:01:17,880 --> 00:01:22,859
sorry for that<font color="#E5E5E5"> I have a little bit of</font>

22
00:01:19,889 --> 00:01:24,658
over<font color="#CCCCCC"> nine years experience in responding</font>

23
00:01:22,859 --> 00:01:27,990
<font color="#E5E5E5">to some of the most prolific threat</font>

24
00:01:24,659 --> 00:01:30,090
actors around<font color="#CCCCCC"> this world my career in</font>

25
00:01:27,990 --> 00:01:37,199
computer in this computer security

26
00:01:30,090 --> 00:01:40,289
industry started when I joined<font color="#E5E5E5"> a Polish</font>

27
00:01:37,200 --> 00:01:43,560
governmental cert where we responded to

28
00:01:40,289 --> 00:01:46,919
<font color="#E5E5E5">a number of nation state sponsored</font>

29
00:01:43,560 --> 00:01:49,889
intrusions from both Chinese and<font color="#CCCCCC"> Russian</font>

30
00:01:46,919 --> 00:01:53,009
groups<font color="#CCCCCC"> i moved</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> a couple</font><font color="#E5E5E5"> of years</font>

31
00:01:49,889 --> 00:01:56,240
to a private private sector where<font color="#E5E5E5"> i</font>

32
00:01:53,009 --> 00:01:59,399
where<font color="#E5E5E5"> i contributed to</font><font color="#CCCCCC"> dragonfly</font>

33
00:01:56,240 --> 00:02:05,189
research and white paper<font color="#CCCCCC"> that was later</font>

34
00:01:59,399 --> 00:02:05,729
published by Symantec around 2014 at

35
00:02:05,189 --> 00:02:08,429
fireEye

36
00:02:05,729 --> 00:02:11,700
I contacted research of into various

37
00:02:08,429 --> 00:02:13,680
advanced persistent threats<font color="#CCCCCC"> in</font>

38
00:02:11,700 --> 00:02:18,530
<font color="#E5E5E5">particular groups from China</font>

39
00:02:13,680 --> 00:02:18,530
and<font color="#CCCCCC"> other so Southeast Asian countries</font>

40
00:02:19,670 --> 00:02:26,608
<font color="#CCCCCC">the major takeaway from</font><font color="#E5E5E5"> this</font>

41
00:02:21,959 --> 00:02:28,469
presentation for you is<font color="#CCCCCC"> that I would</font>

42
00:02:26,609 --> 00:02:30,269
like<font color="#E5E5E5"> you to realize</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> everything is</font>

43
00:02:28,469 --> 00:02:32,969
connected to<font color="#CCCCCC"> everything else it is a</font>

44
00:02:30,269 --> 00:02:35,459
famous<font color="#E5E5E5"> quote by Leonardo da</font><font color="#CCCCCC"> Vinci and</font>

45
00:02:32,969 --> 00:02:40,920
I'm going to<font color="#E5E5E5"> show you how I stumbled</font>

46
00:02:35,459 --> 00:02:43,469
<font color="#E5E5E5">upon this I was working in Singapore's</font>

47
00:02:40,920 --> 00:02:46,738
museum of art and<font color="#CCCCCC"> science</font><font color="#E5E5E5"> and I saw this</font>

48
00:02:43,469 --> 00:02:49,888
huge<font color="#CCCCCC"> wall with this picture I took a</font>

49
00:02:46,739 --> 00:02:52,349
photo of<font color="#E5E5E5"> it and I what struck me in this</font>

50
00:02:49,889 --> 00:02:56,549
in this<font color="#CCCCCC"> picture is the</font><font color="#E5E5E5"> concept of nodes</font>

51
00:02:52,349 --> 00:02:59,060
and edges<font color="#E5E5E5"> the nodes are the dots and the</font>

52
00:02:56,549 --> 00:03:02,430
edges are<font color="#E5E5E5"> the lines connecting them and</font>

53
00:02:59,060 --> 00:03:05,700
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the whole paradigm of everything</font>

54
00:03:02,430 --> 00:03:07,950
being connected<font color="#CCCCCC"> to</font><font color="#E5E5E5"> everything else</font><font color="#CCCCCC"> when</font>

55
00:03:05,700 --> 00:03:11,488
I was<font color="#E5E5E5"> thinking a little bit</font><font color="#CCCCCC"> more about</font>

56
00:03:07,950 --> 00:03:15,899
this<font color="#E5E5E5"> topic I researched</font><font color="#CCCCCC"> the</font>

57
00:03:11,489 --> 00:03:17,760
presentations<font color="#E5E5E5"> given by other vendors and</font>

58
00:03:15,900 --> 00:03:20,970
other analysts and everyone is talking

59
00:03:17,760 --> 00:03:23,519
about<font color="#E5E5E5"> you know cool advanced persistent</font>

60
00:03:20,970 --> 00:03:26,010
threat campaigns<font color="#E5E5E5"> clever intrusion</font>

61
00:03:23,519 --> 00:03:29,189
techniques but no one really<font color="#E5E5E5"> explains</font>

62
00:03:26,010 --> 00:03:32,599
how they do their analysis<font color="#E5E5E5"> so today I'm</font>

63
00:03:29,189 --> 00:03:35,599
going to<font color="#E5E5E5"> show you how we do it</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> fire</font>

64
00:03:32,599 --> 00:03:38,280
<font color="#E5E5E5">but before we go into the details of</font>

65
00:03:35,599 --> 00:03:40,198
intelligence analysis I want to talk

66
00:03:38,280 --> 00:03:48,840
about<font color="#E5E5E5"> a little bit about</font><font color="#CCCCCC"> intelligence</font>

67
00:03:40,199 --> 00:03:51,120
objectives the main intelligence

68
00:03:48,840 --> 00:03:55,579
<font color="#E5E5E5">objectives the main intelligence</font>

69
00:03:51,120 --> 00:03:58,739
<font color="#E5E5E5">objective is to reduce uncertainty and</font>

70
00:03:55,579 --> 00:04:00,959
intelligence reduces uncertainty by

71
00:03:58,739 --> 00:04:05,189
providing knowledge<font color="#E5E5E5"> the</font><font color="#CCCCCC"> knowledge that</font>

72
00:04:00,959 --> 00:04:10,019
<font color="#E5E5E5">is accurate timely and relevant and it</font>

73
00:04:05,189 --> 00:04:13,698
has to pertain<font color="#E5E5E5"> to either threat Intel</font>

74
00:04:10,019 --> 00:04:18,060
landscape<font color="#E5E5E5"> cyber it can</font><font color="#CCCCCC"> also pertain to</font>

75
00:04:13,699 --> 00:04:20,370
<font color="#E5E5E5">war field or politics the knowledge</font><font color="#CCCCCC"> that</font>

76
00:04:18,060 --> 00:04:22,260
intelligence provides has to be about

77
00:04:20,370 --> 00:04:25,759
the threat and<font color="#E5E5E5"> the surrounding</font>

78
00:04:22,260 --> 00:04:28,310
environment<font color="#E5E5E5"> let me talk</font><font color="#CCCCCC"> about why</font>

79
00:04:25,759 --> 00:04:31,819
threat intelligence is both for me and

80
00:04:28,310 --> 00:04:34,460
<font color="#CCCCCC">for our</font><font color="#E5E5E5"> team for</font><font color="#CCCCCC"> us threat intelligence</font>

81
00:04:31,819 --> 00:04:37,729
basically<font color="#CCCCCC"> means visibility on threat</font>

82
00:04:34,460 --> 00:04:43,430
actors<font color="#CCCCCC"> exploits</font><font color="#E5E5E5"> and malware it can be</font>

83
00:04:37,729 --> 00:04:46,938
both tactical<font color="#CCCCCC"> where the analysts focus</font>

84
00:04:43,430 --> 00:04:52,849
on TTP's indicators and artifacts

85
00:04:46,939 --> 00:04:56,659
it can also be strategic where you focus

86
00:04:52,849 --> 00:04:59,180
<font color="#E5E5E5">on how t TP is change over time what</font>

87
00:04:56,659 --> 00:05:02,080
<font color="#E5E5E5">kind of industries</font><font color="#CCCCCC"> are targeted</font><font color="#E5E5E5"> what</font>

88
00:04:59,180 --> 00:05:07,340
kind of data<font color="#E5E5E5"> is stolen</font><font color="#CCCCCC"> you analyze</font>

89
00:05:02,080 --> 00:05:10,520
motivations and<font color="#CCCCCC"> I can and who benefits</font>

90
00:05:07,340 --> 00:05:14,419
<font color="#CCCCCC">from the intrusions</font><font color="#E5E5E5"> as well as analysis</font>

91
00:05:10,520 --> 00:05:19,878
of the attackers infrastructure but<font color="#E5E5E5"> most</font>

92
00:05:14,419 --> 00:05:22,849
importantly threat intelligence is all

93
00:05:19,879 --> 00:05:26,449
about attribution capability and what I

94
00:05:22,849 --> 00:05:29,150
mean<font color="#CCCCCC"> by</font><font color="#E5E5E5"> attribution capability is being</font>

95
00:05:26,449 --> 00:05:33,039
able to take this and<font color="#CCCCCC"> imagine that you</font>

96
00:05:29,150 --> 00:05:35,989
are<font color="#E5E5E5"> doing a lot of</font><font color="#CCCCCC"> incident response</font>

97
00:05:33,039 --> 00:05:38,779
<font color="#E5E5E5">engagements in your infrastructure you</font>

98
00:05:35,990 --> 00:05:41,360
come up with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> couple of incidents</font><font color="#CCCCCC"> over</font>

99
00:05:38,779 --> 00:05:43,939
time and you gather a bunch of

100
00:05:41,360 --> 00:05:50,029
indicators of compromise<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> have</font>

101
00:05:43,939 --> 00:05:52,849
to analyze<font color="#E5E5E5"> and basically go from this</font><font color="#CCCCCC"> to</font>

102
00:05:50,029 --> 00:05:55,879
something<font color="#E5E5E5"> like this you have a OCS</font>

103
00:05:52,849 --> 00:05:58,729
<font color="#E5E5E5">then you have to bundle them together</font>

104
00:05:55,879 --> 00:06:02,719
<font color="#E5E5E5">target and discover those</font><font color="#CCCCCC"> tactics</font>

105
00:05:58,729 --> 00:06:07,210
procedures and overlaps<font color="#E5E5E5"> and you have to</font>

106
00:06:02,719 --> 00:06:12,770
go from basic set of<font color="#E5E5E5"> iOS's to a whole</font>

107
00:06:07,210 --> 00:06:15,948
hopefully fully<font color="#CCCCCC"> flavored apt group so if</font>

108
00:06:12,770 --> 00:06:18,529
I show<font color="#CCCCCC"> you again the picture that I took</font>

109
00:06:15,949 --> 00:06:21,860
in Singapore you<font color="#E5E5E5"> can clearly</font><font color="#CCCCCC"> see the</font>

110
00:06:18,529 --> 00:06:24,649
idea of nodes<font color="#E5E5E5"> and edges in this picture</font>

111
00:06:21,860 --> 00:06:26,839
and for us<font color="#E5E5E5"> nodes are basically</font>

112
00:06:24,649 --> 00:06:30,740
indicators of<font color="#E5E5E5"> compromise</font><font color="#CCCCCC"> that are</font>

113
00:06:26,839 --> 00:06:33,439
connected by different edges and in

114
00:06:30,740 --> 00:06:36,019
order to<font color="#CCCCCC"> bring</font><font color="#E5E5E5"> this whole idea of nodes</font>

115
00:06:33,439 --> 00:06:37,650
and<font color="#E5E5E5"> edges closer to you</font><font color="#CCCCCC"> I want to give</font>

116
00:06:36,019 --> 00:06:40,259
<font color="#E5E5E5">you an example of</font>

117
00:06:37,650 --> 00:06:43,440
tracking the cars<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a very</font><font color="#E5E5E5"> basic</font>

118
00:06:40,259 --> 00:06:47,720
example<font color="#E5E5E5"> so let's say we want to track</font>

119
00:06:43,440 --> 00:06:51,509
<font color="#CCCCCC">the cars and</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> to create an old</font>

120
00:06:47,720 --> 00:06:54,270
car<font color="#CCCCCC"> note and we have to come up</font><font color="#E5E5E5"> with a</font>

121
00:06:51,509 --> 00:07:00,300
set<font color="#CCCCCC"> of properties that we want to store</font>

122
00:06:54,270 --> 00:07:03,690
in our database<font color="#E5E5E5"> about the car one of</font>

123
00:07:00,300 --> 00:07:07,560
these one<font color="#CCCCCC"> of these properties would</font>

124
00:07:03,690 --> 00:07:09,780
definitely be a VIN number<font color="#CCCCCC"> that it's</font>

125
00:07:07,560 --> 00:07:12,240
some<font color="#E5E5E5"> sort of unique identifier for</font><font color="#CCCCCC"> a car</font>

126
00:07:09,780 --> 00:07:15,090
<font color="#E5E5E5">the other would the other one would</font><font color="#CCCCCC"> be a</font>

127
00:07:12,240 --> 00:07:17,760
color and if we want<font color="#E5E5E5"> to track</font><font color="#CCCCCC"> the age of</font>

128
00:07:15,090 --> 00:07:22,739
the car we would store<font color="#E5E5E5"> another property</font>

129
00:07:17,760 --> 00:07:24,599
<font color="#CCCCCC">like a</font><font color="#E5E5E5"> manufacturing date when someone</font>

130
00:07:22,740 --> 00:07:27,570
would argue<font color="#CCCCCC"> okay maybe we can track</font>

131
00:07:24,600 --> 00:07:29,880
registration plates<font color="#E5E5E5"> but because car can</font>

132
00:07:27,570 --> 00:07:32,610
<font color="#E5E5E5">have many registration plates we would</font>

133
00:07:29,880 --> 00:07:36,000
<font color="#E5E5E5">actually create another node for this</font>

134
00:07:32,610 --> 00:07:39,090
called registration plate and also store

135
00:07:36,000 --> 00:07:41,220
different<font color="#E5E5E5"> properties for this node one</font>

136
00:07:39,090 --> 00:07:43,229
of them would<font color="#E5E5E5"> be a number and the other</font>

137
00:07:41,220 --> 00:07:46,919
one let's say would<font color="#E5E5E5"> be a registration</font>

138
00:07:43,229 --> 00:07:49,139
date<font color="#E5E5E5"> so we have two nodes already we</font>

139
00:07:46,919 --> 00:07:52,020
want to<font color="#E5E5E5"> create</font><font color="#CCCCCC"> another one</font><font color="#E5E5E5"> for the</font>

140
00:07:49,139 --> 00:07:54,780
<font color="#E5E5E5">person node because people own cars</font>

141
00:07:52,020 --> 00:07:57,139
right so what would<font color="#CCCCCC"> be</font><font color="#E5E5E5"> the properties</font><font color="#CCCCCC"> of</font>

142
00:07:54,780 --> 00:07:59,429
a person note that we want<font color="#CCCCCC"> to track</font>

143
00:07:57,139 --> 00:08:04,020
definitely first name and the<font color="#E5E5E5"> last name</font>

144
00:07:59,430 --> 00:08:06,750
and for example<font color="#CCCCCC"> birthdate</font><font color="#E5E5E5"> so this is a</font>

145
00:08:04,020 --> 00:08:09,330
very<font color="#E5E5E5"> basic model for tracking cars and</font>

146
00:08:06,750 --> 00:08:11,610
we have<font color="#CCCCCC"> only trees three nodes in this</font>

147
00:08:09,330 --> 00:08:14,180
model<font color="#E5E5E5"> what would be the the edges that</font>

148
00:08:11,610 --> 00:08:17,220
we can connect all these nodes together

149
00:08:14,180 --> 00:08:20,490
<font color="#CCCCCC">so a car can have</font><font color="#E5E5E5"> a registration plate</font>

150
00:08:17,220 --> 00:08:23,610
and the node car is connected<font color="#CCCCCC"> to</font>

151
00:08:20,490 --> 00:08:26,310
registration<font color="#E5E5E5"> plate by edge called car</font>

152
00:08:23,610 --> 00:08:28,979
has reg and the person can<font color="#E5E5E5"> also have a</font>

153
00:08:26,310 --> 00:08:32,880
car and these two nodes are connected<font color="#CCCCCC"> by</font>

154
00:08:28,979 --> 00:08:36,449
person has car<font color="#E5E5E5"> edge someone would argue</font>

155
00:08:32,880 --> 00:08:39,659
<font color="#CCCCCC">that person can also have a registration</font>

156
00:08:36,450 --> 00:08:43,380
plate but this is just<font color="#E5E5E5"> a presentation of</font>

157
00:08:39,659 --> 00:08:46,439
idea<font color="#E5E5E5"> of nodes and edges so it doesn't</font>

158
00:08:43,380 --> 00:08:49,079
matter in<font color="#E5E5E5"> this example what kind of</font>

159
00:08:46,440 --> 00:08:50,730
queries<font color="#E5E5E5"> we would like</font><font color="#CCCCCC"> to run if we want</font>

160
00:08:49,079 --> 00:08:51,599
<font color="#E5E5E5">to track the cars</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> of all give</font><font color="#CCCCCC"> me</font>

161
00:08:50,730 --> 00:08:58,170
all<font color="#CCCCCC"> red cars</font>

162
00:08:51,600 --> 00:09:02,310
manufactured in 2012<font color="#CCCCCC"> or give</font><font color="#E5E5E5"> me give me</font>

163
00:08:58,170 --> 00:09:05,790
<font color="#CCCCCC">all red cars</font><font color="#E5E5E5"> and if belonging to a male</font>

164
00:09:02,310 --> 00:09:07,739
that<font color="#E5E5E5"> is between 25</font><font color="#CCCCCC"> and 25 years old</font><font color="#E5E5E5"> say</font>

165
00:09:05,790 --> 00:09:11,130
<font color="#CCCCCC">dong</font><font color="#E5E5E5"> the car type is</font><font color="#CCCCCC"> said on</font><font color="#E5E5E5"> the</font>

166
00:09:07,740 --> 00:09:13,320
<font color="#E5E5E5">registration plate</font><font color="#CCCCCC"> starts with</font><font color="#E5E5E5"> the W if</font>

167
00:09:11,130 --> 00:09:15,300
we would like to<font color="#CCCCCC"> actually issued this</font>

168
00:09:13,320 --> 00:09:19,500
query we would have to extend<font color="#E5E5E5"> our model</font>

169
00:09:15,300 --> 00:09:22,260
because<font color="#CCCCCC"> we</font><font color="#E5E5E5"> didn't store any</font><font color="#CCCCCC"> type of a</font>

170
00:09:19,500 --> 00:09:25,740
car in our model so how does this

171
00:09:22,260 --> 00:09:27,240
pertain to a cyber threat data model I'm

172
00:09:25,740 --> 00:09:30,540
going<font color="#CCCCCC"> to give you a</font><font color="#E5E5E5"> couple of examples</font>

173
00:09:27,240 --> 00:09:34,610
<font color="#E5E5E5">from the cyber realm from cyber threat</font>

174
00:09:30,540 --> 00:09:38,250
tracking database<font color="#CCCCCC"> and these will be very</font>

175
00:09:34,610 --> 00:09:40,620
very basic examples for<font color="#E5E5E5"> example</font><font color="#CCCCCC"> in terms</font>

176
00:09:38,250 --> 00:09:47,690
of malware communications let's start

177
00:09:40,620 --> 00:09:50,280
with Malory<font color="#E5E5E5"> combs we've got two nodes</font>

178
00:09:47,690 --> 00:09:52,860
<font color="#E5E5E5">the one</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the left is</font><font color="#CCCCCC"> the five the</font><font color="#E5E5E5"> one</font>

179
00:09:50,280 --> 00:09:56,670
on the right is the fqdn<font color="#E5E5E5"> basically a</font>

180
00:09:52,860 --> 00:09:59,100
domain<font color="#CCCCCC"> name and</font><font color="#E5E5E5"> these two can</font><font color="#CCCCCC"> be bundled</font>

181
00:09:56,670 --> 00:10:02,670
together with the<font color="#CCCCCC"> run</font><font color="#E5E5E5"> DNS lookup edge</font>

182
00:09:59,100 --> 00:10:06,360
<font color="#E5E5E5">basically means</font><font color="#CCCCCC"> that the file resolves a</font>

183
00:10:02,670 --> 00:10:09,599
domain name upon execution<font color="#E5E5E5"> the other</font>

184
00:10:06,360 --> 00:10:11,670
<font color="#E5E5E5">example is run connect edge and it</font>

185
00:10:09,600 --> 00:10:14,640
basically<font color="#E5E5E5"> describes a scenario where a</font>

186
00:10:11,670 --> 00:10:17,699
file<font color="#E5E5E5"> upon execution connects to a</font>

187
00:10:14,640 --> 00:10:23,580
certain port or on certain<font color="#CCCCCC"> IP address</font>

188
00:10:17,700 --> 00:10:27,410
this is a node called<font color="#E5E5E5"> ipv4 server the</font>

189
00:10:23,580 --> 00:10:31,920
last example of malware<font color="#E5E5E5"> comes would be</font>

190
00:10:27,410 --> 00:10:35,670
<font color="#CCCCCC">from get URL</font><font color="#E5E5E5"> edge that connects file and</font>

191
00:10:31,920 --> 00:10:39,589
the URL<font color="#CCCCCC"> node and basically describes a</font>

192
00:10:35,670 --> 00:10:43,890
scenario where file upon execution makes

193
00:10:39,590 --> 00:10:46,880
HTTP<font color="#E5E5E5"> request to a remote URL and it can</font>

194
00:10:43,890 --> 00:10:50,220
be for<font color="#E5E5E5"> various reasons it may be</font>

195
00:10:46,880 --> 00:10:53,760
<font color="#CCCCCC">download of additional payload it can be</font>

196
00:10:50,220 --> 00:10:56,040
posting stolen data from from the

197
00:10:53,760 --> 00:11:01,310
compromised<font color="#CCCCCC"> machine it doesn't matter in</font>

198
00:10:56,040 --> 00:11:04,490
this example let's<font color="#E5E5E5"> oh let's go over</font>

199
00:11:01,310 --> 00:11:07,279
another<font color="#E5E5E5"> set of nodes and edges the</font>

200
00:11:04,490 --> 00:11:10,640
<font color="#E5E5E5">describe host operations my host</font>

201
00:11:07,279 --> 00:11:12,800
operations we mean here that every

202
00:11:10,640 --> 00:11:15,170
action<font color="#CCCCCC"> that is done by the traductor</font><font color="#E5E5E5"> on</font>

203
00:11:12,800 --> 00:11:19,219
<font color="#E5E5E5">the compromised machine</font><font color="#CCCCCC"> so let's say we</font>

204
00:11:15,170 --> 00:11:22,250
have a very basic association between

205
00:11:19,220 --> 00:11:24,770
the host and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> file and fs reps edge</font>

206
00:11:22,250 --> 00:11:27,680
in this case<font color="#E5E5E5"> basically means</font><font color="#CCCCCC"> that the</font>

207
00:11:24,770 --> 00:11:30,350
file was present on<font color="#CCCCCC"> a machine we store</font>

208
00:11:27,680 --> 00:11:33,920
<font color="#CCCCCC">additional properties in this edge in</font>

209
00:11:30,350 --> 00:11:35,420
this FS<font color="#CCCCCC"> krebs</font><font color="#E5E5E5"> edge where we</font><font color="#CCCCCC"> capture for</font>

210
00:11:33,920 --> 00:11:41,029
example creation time

211
00:11:35,420 --> 00:11:43,160
creation time and file path<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> can</font>

212
00:11:41,029 --> 00:11:46,310
<font color="#CCCCCC">distinguish for example directories</font>

213
00:11:43,160 --> 00:11:50,770
where certain threat actors store their

214
00:11:46,310 --> 00:11:54,140
files<font color="#CCCCCC"> drop their files</font><font color="#E5E5E5"> and execute them</font>

215
00:11:50,770 --> 00:11:56,750
another<font color="#E5E5E5"> example of a</font><font color="#CCCCCC"> very basic</font><font color="#E5E5E5"> edge</font>

216
00:11:54,140 --> 00:11:58,880
between host and host is<font color="#CCCCCC"> lat move edge</font>

217
00:11:56,750 --> 00:12:03,790
and it<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> means</font><font color="#CCCCCC"> that the</font>

218
00:11:58,880 --> 00:12:09,140
traductor<font color="#E5E5E5"> moved from host a to host B</font>

219
00:12:03,790 --> 00:12:13,069
the last example of<font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> ops is our</font>

220
00:12:09,140 --> 00:12:15,980
host command<font color="#CCCCCC"> our host command</font><font color="#E5E5E5"> edge where</font>

221
00:12:13,070 --> 00:12:18,649
we store information that particular

222
00:12:15,980 --> 00:12:21,980
host command was run<font color="#E5E5E5"> on the host host</font>

223
00:12:18,649 --> 00:12:24,620
command can<font color="#E5E5E5"> be cmd.exe can be sequel</font>

224
00:12:21,980 --> 00:12:27,620
command<font color="#E5E5E5"> looking for data anything that</font>

225
00:12:24,620 --> 00:12:32,170
that malicious<font color="#CCCCCC"> thread actor can execute</font>

226
00:12:27,620 --> 00:12:35,510
on a host let's move on<font color="#E5E5E5"> to some more</font>

227
00:12:32,170 --> 00:12:38,899
<font color="#E5E5E5">meaningful example and I will use a</font>

228
00:12:35,510 --> 00:12:40,970
spearfishing example in this case so

229
00:12:38,899 --> 00:12:44,360
there will be more nodes and more edges

230
00:12:40,970 --> 00:12:49,880
connected between<font color="#E5E5E5"> them let's say we have</font>

231
00:12:44,360 --> 00:12:52,430
an email address<font color="#CCCCCC"> that sent that sent an</font>

232
00:12:49,880 --> 00:12:55,760
email to<font color="#CCCCCC"> another email</font><font color="#E5E5E5"> address it has</font>

233
00:12:52,430 --> 00:13:03,349
two files<font color="#E5E5E5"> connected with the sub file</font>

234
00:12:55,760 --> 00:13:09,610
<font color="#E5E5E5">edge some sort of can mean that there is</font>

235
00:13:03,350 --> 00:13:11,959
an attachment or<font color="#E5E5E5"> a URL URL instead of</font>

236
00:13:09,610 --> 00:13:13,940
instead<font color="#E5E5E5"> of sending attachment the</font>

237
00:13:11,959 --> 00:13:17,589
malicious thread<font color="#E5E5E5"> actors sometimes and</font>

238
00:13:13,940 --> 00:13:20,710
<font color="#E5E5E5">URLs for the victim</font><font color="#CCCCCC"> to click on write</font>

239
00:13:17,590 --> 00:13:24,010
does this make sense to<font color="#CCCCCC"> you guys</font><font color="#E5E5E5"> because</font>

240
00:13:20,710 --> 00:13:26,680
when I look at this set<font color="#CCCCCC"> of nodes and</font>

241
00:13:24,010 --> 00:13:29,110
<font color="#E5E5E5">edges it actually makes little</font><font color="#CCCCCC"> son</font>

242
00:13:26,680 --> 00:13:32,969
little<font color="#E5E5E5"> sense because there's something</font>

243
00:13:29,110 --> 00:13:36,070
<font color="#CCCCCC">missing here in this modeling exercise</font>

244
00:13:32,970 --> 00:13:38,170
<font color="#E5E5E5">what is missing is</font><font color="#CCCCCC"> the context</font>

245
00:13:36,070 --> 00:13:41,470
<font color="#CCCCCC">information</font><font color="#E5E5E5"> are missing and I'm</font><font color="#CCCCCC"> gonna</font>

246
00:13:38,170 --> 00:13:43,810
I'm<font color="#CCCCCC"> going to go through</font><font color="#E5E5E5"> context how we</font>

247
00:13:41,470 --> 00:13:46,990
apply context information<font color="#CCCCCC"> to our graph</font>

248
00:13:43,810 --> 00:13:50,170
database so that<font color="#CCCCCC"> the analyst</font><font color="#E5E5E5"> can</font>

249
00:13:46,990 --> 00:13:52,270
leverage this information<font color="#E5E5E5"> later you can</font>

250
00:13:50,170 --> 00:13:56,079
see that all these nodes are annotated

251
00:13:52,270 --> 00:13:59,050
<font color="#E5E5E5">with like methodology fish sander</font>

252
00:13:56,080 --> 00:14:01,510
<font color="#E5E5E5">there's there is a fish message in the</font>

253
00:13:59,050 --> 00:14:04,329
middle there's the victim of our

254
00:14:01,510 --> 00:14:07,900
spearfishing message<font color="#E5E5E5"> there's a payload</font>

255
00:14:04,330 --> 00:14:11,080
body<font color="#E5E5E5"> and additional payload if the</font>

256
00:14:07,900 --> 00:14:16,630
traductor<font color="#E5E5E5"> chose to send a URL instead of</font>

257
00:14:11,080 --> 00:14:19,900
attachment let's go through<font color="#CCCCCC"> all these</font>

258
00:14:16,630 --> 00:14:22,810
behaviors<font color="#CCCCCC"> the PHV aspect that you just</font>

259
00:14:19,900 --> 00:14:27,220
saw<font color="#E5E5E5"> stands for behavior so we are</font>

260
00:14:22,810 --> 00:14:28,780
capturing behavior of every every

261
00:14:27,220 --> 00:14:31,450
malicious or non malicious behavior

262
00:14:28,780 --> 00:14:35,199
<font color="#CCCCCC">under this huge tree of different</font>

263
00:14:31,450 --> 00:14:37,210
behaviors<font color="#E5E5E5"> this one captures the the</font>

264
00:14:35,200 --> 00:14:40,990
<font color="#CCCCCC">fishing exercise and you can see that</font>

265
00:14:37,210 --> 00:14:43,660
there is<font color="#CCCCCC"> a description for sender it's</font>

266
00:14:40,990 --> 00:14:45,970
actually the email address that<font color="#E5E5E5"> sent the</font>

267
00:14:43,660 --> 00:14:48,400
message there<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> actual file or</font>

268
00:14:45,970 --> 00:14:51,610
relevant headers<font color="#E5E5E5"> there's a victim</font>

269
00:14:48,400 --> 00:14:57,100
<font color="#E5E5E5">payload and the body so actual text of</font>

270
00:14:51,610 --> 00:14:59,290
our spearfishing message as I said

271
00:14:57,100 --> 00:15:03,760
before the<font color="#E5E5E5"> beach V stands for behavior</font>

272
00:14:59,290 --> 00:15:07,569
<font color="#E5E5E5">and this is the top aspect of our threat</font>

273
00:15:03,760 --> 00:15:09,700
modeling<font color="#E5E5E5"> threat of our threat model</font><font color="#CCCCCC"> and</font>

274
00:15:07,570 --> 00:15:12,580
you can see you can see<font color="#E5E5E5"> that there</font><font color="#CCCCCC"> are</font>

275
00:15:09,700 --> 00:15:14,980
sub aspects like<font color="#E5E5E5"> math math stands for</font>

276
00:15:12,580 --> 00:15:17,880
methodology and under this<font color="#E5E5E5"> huge tree we</font>

277
00:15:14,980 --> 00:15:20,770
<font color="#CCCCCC">are capturing</font><font color="#E5E5E5"> different methodologies</font>

278
00:15:17,880 --> 00:15:23,710
<font color="#CCCCCC">there is</font><font color="#E5E5E5"> another sub aspect called fish</font>

279
00:15:20,770 --> 00:15:27,460
and all our<font color="#E5E5E5"> examples from this</font>

280
00:15:23,710 --> 00:15:31,190
<font color="#E5E5E5">spearfishing exercise can be described</font>

281
00:15:27,460 --> 00:15:34,680
but by<font color="#CCCCCC"> these set of us</font>

282
00:15:31,190 --> 00:15:36,930
let me show you some other behavior

283
00:15:34,680 --> 00:15:38,880
trees that we are using in our database

284
00:15:36,930 --> 00:15:43,439
and<font color="#E5E5E5"> this is just an</font><font color="#CCCCCC"> example because the</font>

285
00:15:38,880 --> 00:15:50,100
tree is<font color="#E5E5E5"> has like</font><font color="#CCCCCC"> dozens of</font><font color="#E5E5E5"> thousands of</font>

286
00:15:43,440 --> 00:15:54,900
different<font color="#E5E5E5"> aspects we already we</font><font color="#CCCCCC"> already</font>

287
00:15:50,100 --> 00:15:56,820
went through the fish aspect<font color="#E5E5E5"> we have our</font>

288
00:15:54,900 --> 00:15:59,279
victims and their body and the<font color="#E5E5E5"> payload</font>

289
00:15:56,820 --> 00:16:02,390
<font color="#E5E5E5">but we also have something</font><font color="#CCCCCC"> like file</font><font color="#E5E5E5"> ops</font>

290
00:15:59,279 --> 00:16:04,740
<font color="#CCCCCC">and file ops basically pertains to any</font>

291
00:16:02,390 --> 00:16:10,800
operations that the traductor could do

292
00:16:04,740 --> 00:16:13,380
on a file such as such<font color="#CCCCCC"> as macro for</font>

293
00:16:10,800 --> 00:16:16,229
example very simple<font color="#E5E5E5"> aspect that we apply</font>

294
00:16:13,380 --> 00:16:19,279
<font color="#CCCCCC">to any file that has a macro inside it</font>

295
00:16:16,230 --> 00:16:24,060
can<font color="#E5E5E5"> be XLS file can be</font><font color="#CCCCCC"> docx file</font>

296
00:16:19,279 --> 00:16:26,220
<font color="#CCCCCC">whatever</font><font color="#E5E5E5"> contains macro the other aspect</font>

297
00:16:24,060 --> 00:16:30,260
would be obfuscation<font color="#E5E5E5"> and this pertains</font>

298
00:16:26,220 --> 00:16:34,920
to any let's say string concatenation

299
00:16:30,260 --> 00:16:37,650
<font color="#CCCCCC">that Depot is working on so we</font><font color="#E5E5E5"> don't</font>

300
00:16:34,920 --> 00:16:39,599
actually<font color="#E5E5E5"> use up</font><font color="#CCCCCC"> we use several</font><font color="#E5E5E5"> sub</font>

301
00:16:37,650 --> 00:16:41,910
aspects that pertain to a<font color="#E5E5E5"> particular</font>

302
00:16:39,600 --> 00:16:47,400
obfuscation<font color="#E5E5E5"> technique like string</font>

303
00:16:41,910 --> 00:16:50,130
concatenation<font color="#E5E5E5"> there's another tree</font><font color="#CCCCCC"> that</font>

304
00:16:47,400 --> 00:16:54,990
we are capturing context for<font color="#E5E5E5"> host</font>

305
00:16:50,130 --> 00:16:58,320
operations<font color="#CCCCCC"> so any any activity done by</font>

306
00:16:54,990 --> 00:17:01,550
malicious<font color="#CCCCCC"> traductor on</font><font color="#E5E5E5"> the host and a</font>

307
00:16:58,320 --> 00:17:05,490
couple<font color="#CCCCCC"> of examples would be wipe this</font>

308
00:17:01,550 --> 00:17:08,069
behavior would pertain to<font color="#E5E5E5"> any commands</font>

309
00:17:05,490 --> 00:17:11,760
that attacker<font color="#CCCCCC"> run in order to wipe the</font>

310
00:17:08,069 --> 00:17:17,399
logs or wipe event logs<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> another</font>

311
00:17:11,760 --> 00:17:20,309
<font color="#CCCCCC">example for for data mining so this this</font>

312
00:17:17,400 --> 00:17:24,689
aspect would be<font color="#E5E5E5"> applied</font><font color="#CCCCCC"> to any node that</font>

313
00:17:20,309 --> 00:17:27,300
pertains to thread<font color="#E5E5E5"> act</font><font color="#CCCCCC"> or data mining</font>

314
00:17:24,689 --> 00:17:29,910
<font color="#CCCCCC">for example looking for emails or</font>

315
00:17:27,300 --> 00:17:33,570
looking<font color="#E5E5E5"> for certain files looking for</font>

316
00:17:29,910 --> 00:17:39,179
some<font color="#E5E5E5"> certain records in the database</font><font color="#CCCCCC"> all</font>

317
00:17:33,570 --> 00:17:40,580
<font color="#E5E5E5">these nodes would get this aspect let me</font>

318
00:17:39,179 --> 00:17:43,790
quickly go<font color="#CCCCCC"> through</font>

319
00:17:40,580 --> 00:17:46,370
at another subtree<font color="#CCCCCC"> of our behavior</font>

320
00:17:43,790 --> 00:17:48,889
aspect<font color="#E5E5E5"> and this pertains to capabilities</font>

321
00:17:46,370 --> 00:17:51,979
of malware<font color="#E5E5E5"> so when we</font><font color="#CCCCCC"> are modeling our</font>

322
00:17:48,890 --> 00:17:54,470
<font color="#E5E5E5">malware samples for</font><font color="#CCCCCC"> example if they</font><font color="#E5E5E5"> have</font>

323
00:17:51,980 --> 00:17:57,290
command and control capability<font color="#E5E5E5"> with</font>

324
00:17:54,470 --> 00:18:02,440
Twitter<font color="#E5E5E5"> or github</font><font color="#CCCCCC"> they would get these</font>

325
00:17:57,290 --> 00:18:06,110
aspects<font color="#E5E5E5"> applied to the malware nodes</font>

326
00:18:02,440 --> 00:18:08,750
there's another<font color="#E5E5E5"> another aspect called</font>

327
00:18:06,110 --> 00:18:12,379
<font color="#CCCCCC">Crypt</font><font color="#E5E5E5"> and it basically</font><font color="#CCCCCC"> means that the</font>

328
00:18:08,750 --> 00:18:15,910
file has capability to encrypt the data

329
00:18:12,380 --> 00:18:22,460
with either<font color="#E5E5E5"> AES or</font><font color="#CCCCCC"> RC 4 or</font><font color="#E5E5E5"> whatever</font>

330
00:18:15,910 --> 00:18:25,330
<font color="#CCCCCC">whatever encryption protocol</font><font color="#E5E5E5"> it's using</font>

331
00:18:22,460 --> 00:18:29,450
we have<font color="#E5E5E5"> much more</font><font color="#CCCCCC"> than that</font>

332
00:18:25,330 --> 00:18:31,639
data mined<font color="#E5E5E5"> pertains to a malware that is</font>

333
00:18:29,450 --> 00:18:34,370
able<font color="#CCCCCC"> to for example look for</font><font color="#E5E5E5"> certain</font>

334
00:18:31,640 --> 00:18:37,010
files<font color="#CCCCCC"> or</font><font color="#E5E5E5"> it's able</font><font color="#CCCCCC"> to record</font><font color="#E5E5E5"> the screen</font>

335
00:18:34,370 --> 00:18:39,830
<font color="#E5E5E5">or it's able to kill</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> lock the system</font>

336
00:18:37,010 --> 00:18:41,930
<font color="#CCCCCC">these set of aspects</font><font color="#E5E5E5"> would be applied to</font>

337
00:18:39,830 --> 00:18:45,590
every malware that have<font color="#CCCCCC"> these sort of</font>

338
00:18:41,930 --> 00:18:50,170
capabilities<font color="#CCCCCC"> ok we</font><font color="#E5E5E5"> covered the the</font>

339
00:18:45,590 --> 00:18:57,139
<font color="#E5E5E5">behavior aspect let's quickly go through</font>

340
00:18:50,170 --> 00:19:00,050
<font color="#E5E5E5">signature aspect this</font><font color="#CCCCCC"> is another tree</font>

341
00:18:57,140 --> 00:19:05,230
<font color="#CCCCCC">that we are using in our database where</font>

342
00:19:00,050 --> 00:19:08,450
<font color="#CCCCCC">we for example capture CVS from</font>

343
00:19:05,230 --> 00:19:10,790
different<font color="#E5E5E5"> years and these aspects will</font>

344
00:19:08,450 --> 00:19:13,190
<font color="#CCCCCC">be applied to malware</font><font color="#E5E5E5"> that is exploiting</font>

345
00:19:10,790 --> 00:19:15,490
certain vulnerability<font color="#E5E5E5"> sometimes we</font><font color="#CCCCCC"> are</font>

346
00:19:13,190 --> 00:19:22,060
<font color="#CCCCCC">just using exploit if we are</font><font color="#E5E5E5"> not sure</font>

347
00:19:15,490 --> 00:19:24,980
sometimes<font color="#E5E5E5"> and enter seek slash mouth</font>

348
00:19:22,060 --> 00:19:27,169
aspect<font color="#E5E5E5"> will have all these sub aspects</font>

349
00:19:24,980 --> 00:19:30,440
that pertain to part particular malware

350
00:19:27,170 --> 00:19:30,950
families<font color="#E5E5E5"> so let's say we have so core ZX</font>

351
00:19:30,440 --> 00:19:34,450
<font color="#E5E5E5">shell</font>

352
00:19:30,950 --> 00:19:38,120
so<font color="#CCCCCC"> six slash max so goo would get every</font>

353
00:19:34,450 --> 00:19:40,670
every malware sample of this<font color="#E5E5E5"> family</font>

354
00:19:38,120 --> 00:19:45,949
<font color="#E5E5E5">would get this aspect let's go back to</font>

355
00:19:40,670 --> 00:19:47,750
our<font color="#E5E5E5"> spearfishing modeling exercise we</font>

356
00:19:45,950 --> 00:19:50,410
have<font color="#CCCCCC"> this set of nodes connected with</font>

357
00:19:47,750 --> 00:19:50,410
<font color="#CCCCCC">our edges</font>

358
00:19:51,720 --> 00:19:57,060
and you can see the payload<font color="#E5E5E5"> here on</font><font color="#CCCCCC"> the</font>

359
00:19:54,780 --> 00:20:00,120
bottom<font color="#CCCCCC"> right this is our actual</font>

360
00:19:57,060 --> 00:20:01,740
<font color="#E5E5E5">attachment in our spear phishing email</font>

361
00:20:00,120 --> 00:20:05,550
<font color="#E5E5E5">let's take a look</font>

362
00:20:01,740 --> 00:20:08,970
what kind<font color="#E5E5E5"> of aspects it would get let's</font>

363
00:20:05,550 --> 00:20:12,330
say that this attachment<font color="#E5E5E5"> was sent with</font>

364
00:20:08,970 --> 00:20:16,260
<font color="#CCCCCC">that file name payroll 2018 XLS</font><font color="#E5E5E5"> we have</font>

365
00:20:12,330 --> 00:20:18,179
our met fish<font color="#E5E5E5"> that payload we analyzed</font>

366
00:20:16,260 --> 00:20:21,360
the sample discovered that this is

367
00:20:18,180 --> 00:20:26,580
<font color="#E5E5E5">actual full bar malware family and we</font>

368
00:20:21,360 --> 00:20:31,530
know that it contains a macro there's

369
00:20:26,580 --> 00:20:33,990
another note<font color="#CCCCCC"> a sub file from this XLS</font>

370
00:20:31,530 --> 00:20:37,200
file<font color="#E5E5E5"> that will also get full bar malware</font>

371
00:20:33,990 --> 00:20:40,080
family<font color="#E5E5E5"> we know that it's a macro because</font>

372
00:20:37,200 --> 00:20:43,200
we extract it just just the text version

373
00:20:40,080 --> 00:20:45,540
<font color="#CCCCCC">of the VB script and we know</font><font color="#E5E5E5"> that it's</font>

374
00:20:43,200 --> 00:20:51,360
written in Visual Basic so we applied

375
00:20:45,540 --> 00:20:55,980
code language VB script this macro goes

376
00:20:51,360 --> 00:20:59,310
to a<font color="#CCCCCC"> URL sorry here this</font><font color="#E5E5E5"> mouth this</font>

377
00:20:55,980 --> 00:21:04,560
macro goes to a URL<font color="#E5E5E5"> it's grabbing food</font>

378
00:20:59,310 --> 00:21:13,470
<font color="#E5E5E5">exe sample that is</font><font color="#CCCCCC"> also mild or fubar</font>

379
00:21:04,560 --> 00:21:17,220
family and here's our<font color="#CCCCCC"> full</font><font color="#E5E5E5"> exe we've got</font>

380
00:21:13,470 --> 00:21:20,400
our base name for exe fubar<font color="#E5E5E5"> family we</font>

381
00:21:17,220 --> 00:21:23,910
during reverse engineering process<font color="#CCCCCC"> we</font>

382
00:21:20,400 --> 00:21:25,980
identified<font color="#CCCCCC"> that is actual</font><font color="#E5E5E5"> a code family</font>

383
00:21:23,910 --> 00:21:29,460
for fubar it's not obfuscated or

384
00:21:25,980 --> 00:21:35,190
encrypted and it's a backdoor<font color="#E5E5E5"> and it has</font>

385
00:21:29,460 --> 00:21:38,100
two capabilities of reaching out to<font color="#CCCCCC"> it C</font>

386
00:21:35,190 --> 00:21:43,400
<font color="#CCCCCC">and C by HTTP protocol and it can also</font>

387
00:21:38,100 --> 00:21:46,949
execute commands<font color="#E5E5E5"> the URL this is not the</font>

388
00:21:43,400 --> 00:21:50,360
finished modeling of this basic example

389
00:21:46,950 --> 00:21:53,730
<font color="#E5E5E5">the URL</font><font color="#CCCCCC"> is also connected to its fqdn</font>

390
00:21:50,360 --> 00:21:58,350
<font color="#E5E5E5">that has its own registrar and it has</font>

391
00:21:53,730 --> 00:22:01,290
its own IP resolution address let's take

392
00:21:58,350 --> 00:22:04,129
a look at<font color="#E5E5E5"> this example closer as we</font><font color="#CCCCCC"> try</font>

393
00:22:01,290 --> 00:22:10,668
<font color="#E5E5E5">to analyze this intrusion</font>

394
00:22:04,130 --> 00:22:12,950
closer we have our<font color="#CCCCCC"> host the</font><font color="#E5E5E5"> food</font><font color="#CCCCCC"> exe has</font>

395
00:22:10,669 --> 00:22:16,520
its own command and control server<font color="#E5E5E5"> with</font>

396
00:22:12,950 --> 00:22:19,160
<font color="#E5E5E5">the different domain name</font><font color="#CCCCCC"> done</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> of</font>

397
00:22:16,520 --> 00:22:21,559
course it has<font color="#CCCCCC"> its own fqdn and the</font>

398
00:22:19,160 --> 00:22:23,809
<font color="#E5E5E5">registrar and this file was present on</font><font color="#CCCCCC"> a</font>

399
00:22:21,559 --> 00:22:26,178
house<font color="#E5E5E5"> that we analyzed the</font><font color="#CCCCCC"> house that</font>

400
00:22:23,809 --> 00:22:29,629
from the person<font color="#E5E5E5"> that received spirit</font>

401
00:22:26,179 --> 00:22:33,549
spear phishing email what we have seen

402
00:22:29,630 --> 00:22:38,320
later<font color="#E5E5E5"> after let's say 30 minutes</font><font color="#CCCCCC"> of</font>

403
00:22:33,549 --> 00:22:44,770
dropping this<font color="#E5E5E5"> full exe file</font><font color="#CCCCCC"> the host</font>

404
00:22:38,320 --> 00:22:47,330
<font color="#E5E5E5">executed</font><font color="#CCCCCC"> command</font><font color="#E5E5E5"> to go to actual URL and</font>

405
00:22:44,770 --> 00:22:50,600
grabbed additional file

406
00:22:47,330 --> 00:22:53,918
<font color="#CCCCCC">meow</font><font color="#E5E5E5"> dot exe and upon analysis we</font><font color="#CCCCCC"> have</font>

407
00:22:50,600 --> 00:22:56,480
discovered<font color="#CCCCCC"> that it's just</font><font color="#E5E5E5"> mini cuts</font>

408
00:22:53,919 --> 00:23:03,200
<font color="#E5E5E5">publicly available</font><font color="#CCCCCC"> tool it's it's</font><font color="#E5E5E5"> not</font>

409
00:22:56,480 --> 00:23:08,480
real malware<font color="#E5E5E5"> right so our</font><font color="#CCCCCC"> host has</font><font color="#E5E5E5"> this</font>

410
00:23:03,200 --> 00:23:10,309
file and<font color="#E5E5E5"> after additional analysis we</font>

411
00:23:08,480 --> 00:23:12,799
have<font color="#CCCCCC"> discovered additional dropped file</font>

412
00:23:10,309 --> 00:23:14,990
maybe 10 maybe 15 minutes<font color="#E5E5E5"> later and it</font>

413
00:23:12,799 --> 00:23:18,830
passed passwords dot txt

414
00:23:14,990 --> 00:23:23,780
<font color="#CCCCCC">it contains hashes and its present in C</font>

415
00:23:18,830 --> 00:23:26,090
<font color="#E5E5E5">X Y Z passwords txt file additional</font>

416
00:23:23,780 --> 00:23:29,408
analysis revealed that<font color="#E5E5E5"> there was another</font>

417
00:23:26,090 --> 00:23:33,320
another host<font color="#CCCCCC"> command run there was ping</font>

418
00:23:29,409 --> 00:23:36,169
<font color="#CCCCCC">request to our</font><font color="#E5E5E5"> evil domain and attackers</font>

419
00:23:33,320 --> 00:23:38,539
executed at additional command using<font color="#CCCCCC"> 4</font>

420
00:23:36,169 --> 00:23:42,950
<font color="#E5E5E5">exe they basically sent the passwords</font>

421
00:23:38,539 --> 00:23:46,280
<font color="#E5E5E5">today</font><font color="#CCCCCC"> are C and</font><font color="#E5E5E5"> C address we've got</font><font color="#CCCCCC"> our</font>

422
00:23:42,950 --> 00:23:51,980
exfil<font color="#E5E5E5"> aspect because it pertains to</font>

423
00:23:46,280 --> 00:23:56,330
exfiltration of data and we've got our

424
00:23:51,980 --> 00:24:01,850
signal fubar<font color="#CCCCCC"> aspect for fubar malware</font>

425
00:23:56,330 --> 00:24:04,010
family and I'm pretty<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you when</font>

426
00:24:01,850 --> 00:24:06,350
<font color="#CCCCCC">you were following</font><font color="#E5E5E5"> this spearfishing</font>

427
00:24:04,010 --> 00:24:09,470
<font color="#CCCCCC">modeling you get the idea that there is</font>

428
00:24:06,350 --> 00:24:11,809
only one person responsible<font color="#CCCCCC"> for</font><font color="#E5E5E5"> it they</font>

429
00:24:09,470 --> 00:24:16,860
<font color="#CCCCCC">sent an</font><font color="#E5E5E5"> attachment they</font><font color="#CCCCCC"> drop</font><font color="#E5E5E5"> their full</font>

430
00:24:11,809 --> 00:24:20,879
exe file and they<font color="#E5E5E5"> drop</font>

431
00:24:16,860 --> 00:24:23,490
they downloaded<font color="#CCCCCC"> mimic ads created</font>

432
00:24:20,880 --> 00:24:25,890
<font color="#E5E5E5">password txt with the hashes of the</font>

433
00:24:23,490 --> 00:24:27,960
passwords and exfiltrated it<font color="#E5E5E5"> we are</font>

434
00:24:25,890 --> 00:24:30,840
pretty sure<font color="#E5E5E5"> in this example going from</font>

435
00:24:27,960 --> 00:24:34,350
<font color="#E5E5E5">left to right we have our set of IOC s</font>

436
00:24:30,840 --> 00:24:36,000
<font color="#E5E5E5">and we can pretty much know that</font><font color="#CCCCCC"> we have</font>

437
00:24:34,350 --> 00:24:38,159
really high confidence that<font color="#CCCCCC"> it's either</font>

438
00:24:36,000 --> 00:24:43,799
one<font color="#CCCCCC"> person or one group so we're going</font>

439
00:24:38,160 --> 00:24:46,260
<font color="#CCCCCC">to attribute it to one entity and this</font>

440
00:24:43,799 --> 00:24:49,080
is the final<font color="#E5E5E5"> aspect that I want to talk</font>

441
00:24:46,260 --> 00:24:49,799
about<font color="#E5E5E5"> because it's the most important</font>

442
00:24:49,080 --> 00:24:53,070
aspect

443
00:24:49,799 --> 00:24:55,679
it's the apt or<font color="#E5E5E5"> some companies you</font><font color="#CCCCCC"> are</font>

444
00:24:53,070 --> 00:24:57,950
using<font color="#E5E5E5"> threat aspect they pay it</font>

445
00:24:55,679 --> 00:25:01,710
basically pertains to attribution and

446
00:24:57,950 --> 00:25:04,020
it's some<font color="#CCCCCC"> sort of business of</font><font color="#E5E5E5"> cyber</font>

447
00:25:01,710 --> 00:25:06,390
threat modeling it represents you know

448
00:25:04,020 --> 00:25:09,870
<font color="#E5E5E5">analytical</font><font color="#CCCCCC"> assessment that</font><font color="#E5E5E5"> a set of</font>

449
00:25:06,390 --> 00:25:14,130
indicator is used<font color="#CCCCCC"> by</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> particular group</font>

450
00:25:09,870 --> 00:25:16,949
or threat actor and<font color="#E5E5E5"> there there are</font>

451
00:25:14,130 --> 00:25:19,380
<font color="#CCCCCC">several considerations in</font><font color="#E5E5E5"> terms of</font>

452
00:25:16,950 --> 00:25:23,760
attribution you have to you have<font color="#E5E5E5"> to</font>

453
00:25:19,380 --> 00:25:26,370
<font color="#E5E5E5">think</font><font color="#CCCCCC"> about how your attribution</font>

454
00:25:23,760 --> 00:25:28,950
<font color="#E5E5E5">framework how rigid your you want your</font>

455
00:25:26,370 --> 00:25:31,678
attribution framework to be because less

456
00:25:28,950 --> 00:25:34,080
rigid attribution framework<font color="#E5E5E5"> made means</font>

457
00:25:31,679 --> 00:25:38,460
that we will make more mistakes<font color="#CCCCCC"> in</font>

458
00:25:34,080 --> 00:25:40,699
attributing<font color="#E5E5E5"> intrusion sets you have to</font>

459
00:25:38,460 --> 00:25:44,160
think about analytic confidence<font color="#E5E5E5"> how</font>

460
00:25:40,700 --> 00:25:47,760
confident you are<font color="#E5E5E5"> that set of indicators</font>

461
00:25:44,160 --> 00:25:49,980
belongs to<font color="#E5E5E5"> a</font><font color="#CCCCCC"> particular</font><font color="#E5E5E5"> group or not you</font>

462
00:25:47,760 --> 00:25:52,530
have to<font color="#CCCCCC"> think about correlation value of</font>

463
00:25:49,980 --> 00:25:54,110
certain<font color="#E5E5E5"> indicators of compromise and</font><font color="#CCCCCC"> you</font>

464
00:25:52,530 --> 00:25:57,450
also have to<font color="#CCCCCC"> think about</font><font color="#E5E5E5"> the bias</font>

465
00:25:54,110 --> 00:25:59,790
because<font color="#E5E5E5"> our brain works in a horribly</font>

466
00:25:57,450 --> 00:26:04,049
biased way I'm an analyst<font color="#E5E5E5"> and I make</font>

467
00:25:59,790 --> 00:26:06,750
<font color="#E5E5E5">mistakes</font><font color="#CCCCCC"> every day you know our brain</font>

468
00:26:04,049 --> 00:26:08,850
will always try to adapt to<font color="#CCCCCC"> something</font>

469
00:26:06,750 --> 00:26:11,640
<font color="#E5E5E5">whenever we are</font><font color="#CCCCCC"> processing new</font>

470
00:26:08,850 --> 00:26:13,740
information we will<font color="#CCCCCC"> always</font><font color="#E5E5E5"> make</font>

471
00:26:11,640 --> 00:26:16,830
assumptions<font color="#CCCCCC"> based on what we have</font>

472
00:26:13,740 --> 00:26:19,740
experienced<font color="#E5E5E5"> in the past and based on</font>

473
00:26:16,830 --> 00:26:22,049
<font color="#E5E5E5">what we know and based on and we will</font>

474
00:26:19,740 --> 00:26:24,390
come up<font color="#CCCCCC"> with the solution that</font><font color="#E5E5E5"> we think</font>

475
00:26:22,049 --> 00:26:28,780
it's true<font color="#E5E5E5"> and I will give you an example</font>

476
00:26:24,390 --> 00:26:32,410
<font color="#CCCCCC">I was following the apt 32 group</font>

477
00:26:28,780 --> 00:26:35,230
<font color="#CCCCCC">a couple of</font><font color="#E5E5E5"> years</font><font color="#CCCCCC"> ago</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> the nation</font>

478
00:26:32,410 --> 00:26:38,650
<font color="#E5E5E5">state sponsored group from Vietnam and</font>

479
00:26:35,230 --> 00:26:41,830
they were using active<font color="#E5E5E5"> mime attachment</font>

480
00:26:38,650 --> 00:26:46,360
<font color="#E5E5E5">it's basically a text file</font><font color="#CCCCCC"> that can be</font>

481
00:26:41,830 --> 00:26:48,760
<font color="#E5E5E5">renamed from</font><font color="#CCCCCC"> HDA to</font><font color="#E5E5E5"> doc and it contains</font>

482
00:26:46,360 --> 00:26:50,320
macros it contains all<font color="#E5E5E5"> the objects</font>

483
00:26:48,760 --> 00:26:54,310
everything fully-fledged

484
00:26:50,320 --> 00:26:57,040
<font color="#CCCCCC">spear fishing attachment</font><font color="#E5E5E5"> and I had a</font>

485
00:26:54,310 --> 00:26:59,649
basic<font color="#CCCCCC"> Yara</font><font color="#E5E5E5"> Rulon virustotal</font><font color="#CCCCCC"> and I was</font>

486
00:26:57,040 --> 00:27:02,320
looking at literally<font color="#E5E5E5"> every active</font><font color="#CCCCCC"> mime</font>

487
00:26:59,650 --> 00:27:06,010
file<font color="#E5E5E5"> that was present or uploaded to</font>

488
00:27:02,320 --> 00:27:09,520
virustotal<font color="#CCCCCC"> and after a while working on</font>

489
00:27:06,010 --> 00:27:12,220
this apt<font color="#CCCCCC"> 32 group</font><font color="#E5E5E5"> whenever I saw an</font>

490
00:27:09,520 --> 00:27:15,639
active<font color="#E5E5E5"> mine that had like three to six</font>

491
00:27:12,220 --> 00:27:20,260
<font color="#CCCCCC">av detections on virustotal</font><font color="#E5E5E5"> and that</font>

492
00:27:15,640 --> 00:27:23,140
this file would have<font color="#E5E5E5"> Vietnamese looking</font>

493
00:27:20,260 --> 00:27:25,840
<font color="#E5E5E5">file name</font><font color="#CCCCCC"> I my brain would literally</font>

494
00:27:23,140 --> 00:27:27,730
tell me hey you have an apt<font color="#CCCCCC"> 32 example</font>

495
00:27:25,840 --> 00:27:30,220
here this will be fairly<font color="#E5E5E5"> easy to</font>

496
00:27:27,730 --> 00:27:35,290
attribute<font color="#E5E5E5"> right but it's not always the</font>

497
00:27:30,220 --> 00:27:37,450
<font color="#CCCCCC">case</font><font color="#E5E5E5"> be mindful of that so what happens</font>

498
00:27:35,290 --> 00:27:40,360
when<font color="#E5E5E5"> we can't really attribute something</font>

499
00:27:37,450 --> 00:27:43,450
to a group that<font color="#E5E5E5"> we were</font><font color="#CCCCCC"> tracking</font>

500
00:27:40,360 --> 00:27:46,449
traductor that we know about we we<font color="#CCCCCC"> don't</font>

501
00:27:43,450 --> 00:27:51,070
<font color="#CCCCCC">have any correlation between</font><font color="#E5E5E5"> set a and</font>

502
00:27:46,450 --> 00:27:53,590
set B and<font color="#E5E5E5"> we should be handing out hunks</font>

503
00:27:51,070 --> 00:27:55,659
like candy<font color="#CCCCCC"> UNK is a</font><font color="#E5E5E5"> uncatted Erised</font>

504
00:27:53,590 --> 00:27:58,689
group that we<font color="#CCCCCC"> are using in our thread</font>

505
00:27:55,660 --> 00:28:01,480
database and this<font color="#CCCCCC"> is the actual</font><font color="#E5E5E5"> code of</font>

506
00:27:58,690 --> 00:28:05,050
our main developer of our thread Intel

507
00:28:01,480 --> 00:28:08,830
database so and what it<font color="#E5E5E5"> means is that I</font>

508
00:28:05,050 --> 00:28:14,010
will<font color="#CCCCCC"> show you our tree of</font><font color="#E5E5E5"> apt aspect it</font>

509
00:28:08,830 --> 00:28:18,580
basically contains words<font color="#CCCCCC"> apt</font><font color="#E5E5E5"> 1 237 and</font>

510
00:28:14,010 --> 00:28:20,470
<font color="#CCCCCC">onyx up to 1,000 something 1,100 so</font>

511
00:28:18,580 --> 00:28:22,810
we're tracking so many groups because<font color="#CCCCCC"> we</font>

512
00:28:20,470 --> 00:28:24,340
<font color="#E5E5E5">are we have very rigid attribution</font>

513
00:28:22,810 --> 00:28:29,169
framework and we don't want to make

514
00:28:24,340 --> 00:28:30,939
these mistakes<font color="#E5E5E5"> so let's say</font><font color="#CCCCCC"> that our</font>

515
00:28:29,170 --> 00:28:36,810
spearfishing example that we<font color="#E5E5E5"> just</font>

516
00:28:30,940 --> 00:28:39,550
modeled is our<font color="#E5E5E5"> Anquan we are fairly</font>

517
00:28:36,810 --> 00:28:42,729
confident<font color="#E5E5E5"> that this</font><font color="#CCCCCC"> is just</font><font color="#E5E5E5"> one person</font>

518
00:28:39,550 --> 00:28:45,200
or one<font color="#CCCCCC"> group trying to</font>

519
00:28:42,729 --> 00:28:47,929
<font color="#CCCCCC">compromising machine gather password</font>

520
00:28:45,200 --> 00:28:49,909
hashes and exfiltrate them<font color="#E5E5E5"> we have</font>

521
00:28:47,929 --> 00:28:53,720
couple of<font color="#E5E5E5"> email we</font><font color="#CCCCCC"> have one email</font>

522
00:28:49,909 --> 00:28:59,119
<font color="#E5E5E5">address</font><font color="#CCCCCC"> we've</font><font color="#E5E5E5"> got three domain names a</font>

523
00:28:53,720 --> 00:29:02,690
couple<font color="#CCCCCC"> of file names</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> mimikatz</font><font color="#E5E5E5"> sample</font>

524
00:28:59,119 --> 00:29:05,359
and this is all<font color="#E5E5E5"> on</font><font color="#CCCCCC"> one for us</font><font color="#E5E5E5"> let's say</font>

525
00:29:02,690 --> 00:29:07,940
<font color="#E5E5E5">that I know two weeks later we had</font>

526
00:29:05,359 --> 00:29:11,658
<font color="#E5E5E5">another intrusion from different email</font>

527
00:29:07,940 --> 00:29:12,590
address using<font color="#CCCCCC"> the same malware family</font>

528
00:29:11,659 --> 00:29:15,979
<font color="#CCCCCC">fubar</font>

529
00:29:12,590 --> 00:29:20,539
it's not XLS file anymore<font color="#E5E5E5"> it's just</font><font color="#CCCCCC"> doc</font>

530
00:29:15,979 --> 00:29:22,940
<font color="#E5E5E5">X the</font><font color="#CCCCCC"> C and C the the</font>

531
00:29:20,539 --> 00:29:26,269
<font color="#CCCCCC">command-and-control fqdn is completely</font>

532
00:29:22,940 --> 00:29:29,690
different<font color="#E5E5E5"> the mimic</font><font color="#CCCCCC"> ads is not longer</font>

533
00:29:26,269 --> 00:29:32,090
meow<font color="#E5E5E5"> it's me me dot exe so nothing</font>

534
00:29:29,690 --> 00:29:34,849
<font color="#CCCCCC">really stands out right we have only one</font>

535
00:29:32,090 --> 00:29:37,428
malware family that it's just used by

536
00:29:34,849 --> 00:29:44,418
<font color="#CCCCCC">these two groups</font><font color="#E5E5E5"> we would attribute it</font>

537
00:29:37,429 --> 00:29:50,720
<font color="#E5E5E5">to anak</font><font color="#CCCCCC"> too but</font><font color="#E5E5E5"> let's say that</font><font color="#CCCCCC"> after</font>

538
00:29:44,419 --> 00:29:53,389
another day they<font color="#E5E5E5"> drop this file again</font>

539
00:29:50,720 --> 00:29:55,789
<font color="#CCCCCC">passwords dot txt</font><font color="#E5E5E5"> in the same in the</font>

540
00:29:53,389 --> 00:29:59,330
same<font color="#E5E5E5"> directory right we would still</font>

541
00:29:55,789 --> 00:30:02,119
attribute it to<font color="#CCCCCC"> aunt too but we would</font>

542
00:29:59,330 --> 00:30:06,678
come<font color="#CCCCCC"> up with</font><font color="#E5E5E5"> this we would come</font><font color="#CCCCCC"> up with</font>

543
00:30:02,119 --> 00:30:09,049
this merging of two different<font color="#E5E5E5"> eggs</font><font color="#CCCCCC"> we</font>

544
00:30:06,679 --> 00:30:11,599
would have use of<font color="#CCCCCC"> full Burma a</font><font color="#E5E5E5"> family</font>

545
00:30:09,049 --> 00:30:13,820
<font color="#E5E5E5">that has quite low overlap confidence</font>

546
00:30:11,599 --> 00:30:15,918
level we will have the same stage

547
00:30:13,820 --> 00:30:19,668
directory where they dropped passwords

548
00:30:15,919 --> 00:30:22,549
txt<font color="#E5E5E5"> with medium</font><font color="#CCCCCC"> confidence level but</font>

549
00:30:19,669 --> 00:30:27,470
when they xfield it the file to the<font color="#E5E5E5"> same</font>

550
00:30:22,549 --> 00:30:29,059
<font color="#CCCCCC">F</font><font color="#E5E5E5"> Korean this</font><font color="#CCCCCC"> is quite high</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> has very</font>

551
00:30:27,470 --> 00:30:31,029
high correlation value we would

552
00:30:29,059 --> 00:30:34,220
<font color="#E5E5E5">basically merge them together</font>

553
00:30:31,029 --> 00:30:36,139
<font color="#E5E5E5">and now I will give you an example from</font>

554
00:30:34,220 --> 00:30:38,570
<font color="#E5E5E5">the front lines</font><font color="#CCCCCC"> I've been</font><font color="#E5E5E5"> talking about</font>

555
00:30:36,139 --> 00:30:41,389
theory for<font color="#E5E5E5"> this whole presentation let's</font>

556
00:30:38,570 --> 00:30:44,029
talk about<font color="#E5E5E5"> some real stuff we had an</font>

557
00:30:41,389 --> 00:30:48,629
intrusion later<font color="#E5E5E5"> earlier this year a</font>

558
00:30:44,029 --> 00:30:51,010
<font color="#CCCCCC">couple</font><font color="#E5E5E5"> of our a couple of our</font>

559
00:30:48,630 --> 00:30:56,530
clients were compromised<font color="#CCCCCC"> and we were</font>

560
00:30:51,010 --> 00:30:58,809
<font color="#E5E5E5">responding</font><font color="#CCCCCC"> to these intrusions</font><font color="#E5E5E5"> and the</font>

561
00:30:56,530 --> 00:31:01,750
trade actors used two tools that were

562
00:30:58,809 --> 00:31:04,260
exclusively attributed to<font color="#E5E5E5"> apt 20</font><font color="#CCCCCC"> before</font>

563
00:31:01,750 --> 00:31:07,540
<font color="#E5E5E5">it's cetera backdoor</font>

564
00:31:04,260 --> 00:31:10,900
it's<font color="#CCCCCC"> a cetera proxy tool and a cookie</font>

565
00:31:07,540 --> 00:31:13,240
<font color="#E5E5E5">clog backdoor and we were quite puzzled</font>

566
00:31:10,900 --> 00:31:15,670
<font color="#CCCCCC">we attributed to a new UNK because this</font>

567
00:31:13,240 --> 00:31:19,480
group was<font color="#CCCCCC"> dormant for us for</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> a year</font>

568
00:31:15,670 --> 00:31:24,640
<font color="#E5E5E5">and we didn't have any overlaps beside</font>

569
00:31:19,480 --> 00:31:27,580
these two malware families but we tried

570
00:31:24,640 --> 00:31:32,740
<font color="#E5E5E5">to wait a little bit more we had our apt</font>

571
00:31:27,580 --> 00:31:35,470
20 and our<font color="#E5E5E5"> uncle and we waited and and</font>

572
00:31:32,740 --> 00:31:41,260
try to pivot from<font color="#E5E5E5"> what we know and what</font>

573
00:31:35,470 --> 00:31:44,770
if we can find<font color="#E5E5E5"> some overlaps so later</font>

574
00:31:41,260 --> 00:31:46,990
during the<font color="#CCCCCC"> IR process we got some some</font>

575
00:31:44,770 --> 00:31:49,240
more<font color="#CCCCCC"> evidence and we had our use of</font>

576
00:31:46,990 --> 00:31:52,210
cetera and cookie<font color="#CCCCCC"> Club this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> where</font>

577
00:31:49,240 --> 00:31:54,820
very low overlap confidence level they

578
00:31:52,210 --> 00:31:58,870
use the<font color="#E5E5E5"> session</font><font color="#CCCCCC"> token' in their malware</font>

579
00:31:54,820 --> 00:32:01,090
<font color="#E5E5E5">and it was quite unique for</font><font color="#CCCCCC"> abt 20 but</font>

580
00:31:58,870 --> 00:32:05,020
what they did as well as<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see</font>

581
00:32:01,090 --> 00:32:08,439
<font color="#CCCCCC">they used the</font><font color="#E5E5E5"> rar to compressed files</font>

582
00:32:05,020 --> 00:32:12,250
for exfil and they use a password<font color="#CCCCCC"> that</font>

583
00:32:08,440 --> 00:32:14,470
starts<font color="#E5E5E5"> and ends</font><font color="#CCCCCC"> with the bracket there</font>

584
00:32:12,250 --> 00:32:15,429
is a letter D there<font color="#CCCCCC"> is this hash that</font>

585
00:32:14,470 --> 00:32:19,150
overlaps

586
00:32:15,429 --> 00:32:23,169
they also used<font color="#CCCCCC"> D dot gif and T</font><font color="#E5E5E5"> wanted</font>

587
00:32:19,150 --> 00:32:26,110
give during<font color="#E5E5E5"> exfiltration</font><font color="#CCCCCC"> so this was</font>

588
00:32:23,169 --> 00:32:28,929
quite<font color="#CCCCCC"> high</font><font color="#E5E5E5"> confidence for us and it had</font>

589
00:32:26,110 --> 00:32:31,959
a<font color="#E5E5E5"> really high correlation value to merge</font>

590
00:32:28,929 --> 00:32:36,190
these two groups<font color="#E5E5E5"> together it was</font>

591
00:32:31,960 --> 00:32:41,919
confirmed that<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> apt</font><font color="#E5E5E5"> 20 let me give</font>

592
00:32:36,190 --> 00:32:44,320
you<font color="#CCCCCC"> another example of of</font><font color="#E5E5E5"> our Intel</font>

593
00:32:41,919 --> 00:32:48,040
support that we give to<font color="#E5E5E5"> our managed</font>

594
00:32:44,320 --> 00:32:50,530
<font color="#CCCCCC">defence Sox if you don't have a graph</font>

595
00:32:48,040 --> 00:32:52,928
database<font color="#E5E5E5"> you can still pivot to</font>

596
00:32:50,530 --> 00:32:55,090
<font color="#CCCCCC">something that is</font><font color="#E5E5E5"> really on the internet</font>

597
00:32:52,929 --> 00:32:58,840
and<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> public and I'm going to go</font>

598
00:32:55,090 --> 00:33:00,490
through this example<font color="#CCCCCC"> really quick</font><font color="#E5E5E5"> we</font>

599
00:32:58,840 --> 00:33:01,270
<font color="#E5E5E5">discovered a piece of malware that was</font>

600
00:33:00,490 --> 00:33:07,470
communique

601
00:33:01,270 --> 00:33:11,710
<font color="#CCCCCC">ding over ssl and we could see the</font>

602
00:33:07,470 --> 00:33:14,380
requests and<font color="#CCCCCC"> the responses were fairly</font>

603
00:33:11,710 --> 00:33:16,210
<font color="#CCCCCC">the same</font><font color="#E5E5E5"> in terms of size so we knew</font>

604
00:33:14,380 --> 00:33:19,140
that<font color="#CCCCCC"> it's not the web browsing activity</font>

605
00:33:16,210 --> 00:33:22,270
there might be some<font color="#CCCCCC"> backdoor behind it</font>

606
00:33:19,140 --> 00:33:25,300
<font color="#CCCCCC">then later we're on live response we</font>

607
00:33:22,270 --> 00:33:28,600
discovered this<font color="#CCCCCC"> the Excel sample and we</font>

608
00:33:25,300 --> 00:33:35,379
analyzed it<font color="#E5E5E5"> and we saw that it used a</font>

609
00:33:28,600 --> 00:33:38,860
very old<font color="#E5E5E5"> and</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> unique open SSL</font><font color="#CCCCCC"> that</font>

610
00:33:35,380 --> 00:33:41,440
was that was bundled together with the<font color="#CCCCCC"> C</font>

611
00:33:38,860 --> 00:33:44,919
<font color="#CCCCCC">actual sample so we wrote</font><font color="#E5E5E5"> that sig for</font>

612
00:33:41,440 --> 00:33:46,660
this SSL particular SSL client<font color="#E5E5E5"> hello we</font>

613
00:33:44,920 --> 00:33:48,880
were waiting<font color="#E5E5E5"> if we're gonna you</font><font color="#CCCCCC"> know</font>

614
00:33:46,660 --> 00:33:51,010
break up<font color="#E5E5E5"> our company</font><font color="#CCCCCC"> or not because</font>

615
00:33:48,880 --> 00:33:53,680
maybe<font color="#E5E5E5"> there will be false positive storm</font>

616
00:33:51,010 --> 00:33:57,190
<font color="#E5E5E5">but we</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> quite</font><font color="#CCCCCC"> lucky</font><font color="#E5E5E5"> and we started</font>

617
00:33:53,680 --> 00:33:59,530
seeing traffic<font color="#E5E5E5"> only</font><font color="#CCCCCC"> on few at IP</font>

618
00:33:57,190 --> 00:34:01,390
addresses and we started discovering all

619
00:33:59,530 --> 00:34:07,420
these C and C's that you see on the

620
00:34:01,390 --> 00:34:14,440
right and all<font color="#E5E5E5"> of them they</font><font color="#CCCCCC"> shared one</font>

621
00:34:07,420 --> 00:34:16,450
serial number one SSL certificate after

622
00:34:14,440 --> 00:34:20,168
a couple<font color="#E5E5E5"> of days we saw another IP</font>

623
00:34:16,449 --> 00:34:25,509
address with the same SSL certificate

624
00:34:20,168 --> 00:34:28,989
and we do pivoting every day on every

625
00:34:25,510 --> 00:34:33,570
<font color="#E5E5E5">set</font><font color="#CCCCCC"> of indicators</font><font color="#E5E5E5"> and we just saw speedy</font>

626
00:34:28,989 --> 00:34:36,040
<font color="#E5E5E5">Anna's entries Philippines</font><font color="#CCCCCC"> News muqaam</font>

627
00:34:33,570 --> 00:34:38,710
second photo frame that count is<font color="#CCCCCC"> three</font>

628
00:34:36,040 --> 00:34:44,380
<font color="#CCCCCC">fqt ends resolved this</font><font color="#E5E5E5"> IP</font><font color="#CCCCCC"> address in the</font>

629
00:34:38,710 --> 00:34:46,480
past<font color="#E5E5E5"> and these three</font><font color="#CCCCCC"> fqd ends were</font>

630
00:34:44,380 --> 00:34:50,110
present in<font color="#E5E5E5"> a</font><font color="#CCCCCC"> kaspersky report about</font>

631
00:34:46,480 --> 00:34:52,330
<font color="#CCCCCC">Helsing apt we are actually</font><font color="#E5E5E5"> tracking is</font>

632
00:34:50,110 --> 00:34:55,510
it as well but this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just an example</font>

633
00:34:52,330 --> 00:34:58,660
of<font color="#CCCCCC"> how you can pivot</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> we can</font><font color="#E5E5E5"> use ping</font>

634
00:34:55,510 --> 00:35:03,730
<font color="#E5E5E5">and protein to get to public reporting</font>

635
00:34:58,660 --> 00:35:11,290
about apt intrusions then later we also

636
00:35:03,730 --> 00:35:12,620
saw additional IP addresses IP addresses

637
00:35:11,290 --> 00:35:15,620
on

638
00:35:12,620 --> 00:35:18,529
if total and nonsenses<font color="#CCCCCC"> so there is a was</font>

639
00:35:15,620 --> 00:35:24,740
a bunch of malicious infrastructure

640
00:35:18,530 --> 00:35:29,450
behind<font color="#E5E5E5"> it this is the final this is the</font>

641
00:35:24,740 --> 00:35:31,939
final final couple<font color="#E5E5E5"> of slides of my talk</font>

642
00:35:29,450 --> 00:35:34,220
I'm<font color="#E5E5E5"> going to tell you what to do and</font>

643
00:35:31,940 --> 00:35:36,350
what<font color="#CCCCCC"> not</font><font color="#E5E5E5"> to do if you want to if you</font>

644
00:35:34,220 --> 00:35:38,660
want<font color="#CCCCCC"> to launch your own</font><font color="#E5E5E5"> cyber threat</font>

645
00:35:36,350 --> 00:35:43,910
intelligence programs<font color="#CCCCCC"> I really have only</font>

646
00:35:38,660 --> 00:35:47,359
four dudes you have to have threat

647
00:35:43,910 --> 00:35:49,879
intelligence personnel<font color="#CCCCCC"> even</font><font color="#E5E5E5"> one or two</font>

648
00:35:47,360 --> 00:35:52,850
analysts will do<font color="#E5E5E5"> but they have to be</font>

649
00:35:49,880 --> 00:35:55,670
dedicated<font color="#E5E5E5"> to their</font><font color="#CCCCCC"> work and to this</font>

650
00:35:52,850 --> 00:35:58,100
particular<font color="#E5E5E5"> task in your team you have</font><font color="#CCCCCC"> to</font>

651
00:35:55,670 --> 00:35:59,930
<font color="#E5E5E5">have some reverse engineering capability</font>

652
00:35:58,100 --> 00:36:02,600
in<font color="#CCCCCC"> your either in the threat</font>

653
00:35:59,930 --> 00:36:06,560
intelligence team<font color="#E5E5E5"> or</font><font color="#CCCCCC"> sock team or the</font>

654
00:36:02,600 --> 00:36:08,600
third team<font color="#CCCCCC"> you also have to have tech</font>

655
00:36:06,560 --> 00:36:15,710
<font color="#CCCCCC">stack that will allow you pushing</font>

656
00:36:08,600 --> 00:36:18,890
signatures both snort and<font color="#E5E5E5"> Yara</font><font color="#CCCCCC"> and basic</font>

657
00:36:15,710 --> 00:36:20,750
<font color="#CCCCCC">tasks</font><font color="#E5E5E5"> pivoting and context creation can</font>

658
00:36:18,890 --> 00:36:23,089
<font color="#CCCCCC">be really accomplished using</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> or</font>

659
00:36:20,750 --> 00:36:25,630
three people<font color="#E5E5E5"> in</font><font color="#CCCCCC"> your threat intelligence</font>

660
00:36:23,090 --> 00:36:30,170
team<font color="#CCCCCC"> the next steps would be definitely</font>

661
00:36:25,630 --> 00:36:33,590
<font color="#E5E5E5">try to leverage graph database and I</font>

662
00:36:30,170 --> 00:36:37,610
recommend<font color="#E5E5E5"> using</font><font color="#CCCCCC"> open source synapse</font>

663
00:36:33,590 --> 00:36:39,620
database<font color="#E5E5E5"> for this task it doesn't come</font>

664
00:36:37,610 --> 00:36:41,840
up come with the GUI but it's very

665
00:36:39,620 --> 00:36:46,190
efficient<font color="#CCCCCC"> it's actually a hyper graph</font>

666
00:36:41,840 --> 00:36:50,240
database but this is a this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a topic</font>

667
00:36:46,190 --> 00:36:53,090
<font color="#CCCCCC">for a different presentation I guess in</font>

668
00:36:50,240 --> 00:36:54,770
terms of don't<font color="#E5E5E5"> and this is something</font>

669
00:36:53,090 --> 00:36:58,400
that<font color="#E5E5E5"> I have seen across different</font>

670
00:36:54,770 --> 00:37:01,340
companies maybe<font color="#E5E5E5"> not in Europe but really</font>

671
00:36:58,400 --> 00:37:03,890
one don't is just don't do newscaster

672
00:37:01,340 --> 00:37:06,320
threat intelligence where you buy<font color="#E5E5E5"> a</font>

673
00:37:03,890 --> 00:37:08,779
bunch of feeds you combine them together

674
00:37:06,320 --> 00:37:11,720
and briefed<font color="#E5E5E5"> c-level executives</font>

675
00:37:08,780 --> 00:37:13,910
periodically<font color="#E5E5E5"> please don't do it instead</font>

676
00:37:11,720 --> 00:37:16,879
you just focus on<font color="#CCCCCC"> the data you</font><font color="#E5E5E5"> already</font>

677
00:37:13,910 --> 00:37:19,370
<font color="#E5E5E5">have leverage your sock or</font><font color="#CCCCCC"> ir practice</font>

678
00:37:16,880 --> 00:37:22,430
there's a lot of indicators<font color="#E5E5E5"> that you can</font>

679
00:37:19,370 --> 00:37:25,710
<font color="#CCCCCC">definitely use</font><font color="#E5E5E5"> in terms of providing</font>

680
00:37:22,430 --> 00:37:29,129
context of what's really targeting you

681
00:37:25,710 --> 00:37:32,190
<font color="#CCCCCC">the company try to get</font><font color="#E5E5E5"> access to some</font>

682
00:37:29,130 --> 00:37:36,560
enrichment data sources<font color="#E5E5E5"> so passive dns</font>

683
00:37:32,190 --> 00:37:41,460
<font color="#CCCCCC">SSL certificates and Whois information</font>

684
00:37:36,560 --> 00:37:44,640
<font color="#CCCCCC">try to hunt for attackers activity Targ</font>

685
00:37:41,460 --> 00:37:46,560
and describe what you see<font color="#E5E5E5"> and I</font>

686
00:37:44,640 --> 00:37:48,598
<font color="#E5E5E5">guarantee you that if you keep pivoting</font>

687
00:37:46,560 --> 00:37:51,390
you will definitely<font color="#CCCCCC"> find something</font><font color="#E5E5E5"> like</font>

688
00:37:48,599 --> 00:37:54,780
the example from<font color="#E5E5E5"> Kaspersky</font><font color="#CCCCCC"> housing</font>

689
00:37:51,390 --> 00:37:58,430
report<font color="#E5E5E5"> that's all I had</font><font color="#CCCCCC"> I will be</font><font color="#E5E5E5"> happy</font>

690
00:37:54,780 --> 00:37:58,430
to<font color="#CCCCCC"> answer some questions if you have</font>

