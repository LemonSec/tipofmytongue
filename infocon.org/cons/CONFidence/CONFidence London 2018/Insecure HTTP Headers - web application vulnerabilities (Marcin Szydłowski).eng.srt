1
00:00:06,549 --> 00:00:12,860
<font color="#CCCCCC">so</font><font color="#E5E5E5"> much for joining</font>

2
00:00:08,220 --> 00:00:12,860
today<font color="#E5E5E5"> so my name</font><font color="#CCCCCC"> is Martin</font><font color="#E5E5E5"> should was</font>

3
00:00:13,100 --> 00:00:19,490
headers<font color="#E5E5E5"> so in general this topic is</font>

4
00:00:17,030 --> 00:00:22,130
about web application<font color="#E5E5E5"> security but not</font>

5
00:00:19,490 --> 00:00:24,470
<font color="#CCCCCC">only web application security so we'll</font>

6
00:00:22,130 --> 00:00:27,710
just<font color="#E5E5E5"> jump</font><font color="#CCCCCC"> to this</font><font color="#E5E5E5"> topic a little bit and</font>

7
00:00:24,470 --> 00:00:30,229
discuss<font color="#CCCCCC"> a couple</font><font color="#E5E5E5"> of things so yeah</font>

8
00:00:27,710 --> 00:00:32,870
that's the table<font color="#CCCCCC"> of contents so we are</font>

9
00:00:30,230 --> 00:00:35,720
<font color="#E5E5E5">going to speak about two types of</font>

10
00:00:32,870 --> 00:00:38,390
headers<font color="#CCCCCC"> first of</font><font color="#E5E5E5"> which will be host</font>

11
00:00:35,720 --> 00:00:42,850
header and second of which will<font color="#E5E5E5"> be X for</font>

12
00:00:38,390 --> 00:00:45,350
<font color="#E5E5E5">what for header so I would like</font><font color="#CCCCCC"> to</font>

13
00:00:42,850 --> 00:00:48,019
<font color="#E5E5E5">explain what are</font><font color="#CCCCCC"> the risk associated</font>

14
00:00:45,350 --> 00:00:52,220
with<font color="#E5E5E5"> these two headers and how can</font><font color="#CCCCCC"> you</font>

15
00:00:48,019 --> 00:00:53,420
<font color="#E5E5E5">deal with them later on so Who am I so</font>

16
00:00:52,220 --> 00:00:55,190
<font color="#E5E5E5">as he already mentioned my name is</font>

17
00:00:53,420 --> 00:00:58,940
<font color="#E5E5E5">Martin C</font><font color="#CCCCCC"> Dworsky I'm based in Krakow</font>

18
00:00:55,190 --> 00:01:01,640
Poland<font color="#E5E5E5"> so I used to work as a as a pen</font>

19
00:00:58,940 --> 00:01:04,158
tester<font color="#E5E5E5"> like full-time pen tester I used</font>

20
00:01:01,640 --> 00:01:08,330
to work<font color="#CCCCCC"> for some</font><font color="#E5E5E5"> global banks global</font>

21
00:01:04,159 --> 00:01:10,670
financial companies<font color="#E5E5E5"> right now I work as</font>

22
00:01:08,330 --> 00:01:13,670
a security<font color="#CCCCCC"> consultant for one of the</font>

23
00:01:10,670 --> 00:01:16,070
global companies as well<font color="#E5E5E5"> apart from</font><font color="#CCCCCC"> that</font>

24
00:01:13,670 --> 00:01:19,490
I'm a<font color="#E5E5E5"> security researchers</font><font color="#CCCCCC"> and</font>

25
00:01:16,070 --> 00:01:21,710
researcher and<font color="#CCCCCC"> a bug bounty hunter I do</font>

26
00:01:19,490 --> 00:01:24,919
<font color="#CCCCCC">mostly</font><font color="#E5E5E5"> private pilot bug bounty spoke</font>

27
00:01:21,710 --> 00:01:31,030
about sometimes I'll<font color="#CCCCCC"> participate</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> in</font>

28
00:01:24,920 --> 00:01:34,789
the<font color="#E5E5E5"> public ones so in general that's it</font>

29
00:01:31,030 --> 00:01:37,280
why HTTP headers because<font color="#E5E5E5"> as I</font><font color="#CCCCCC"> mentioned</font>

30
00:01:34,789 --> 00:01:40,490
<font color="#E5E5E5">I do a lot of bug bounty programs and</font>

31
00:01:37,280 --> 00:01:43,579
the thing is<font color="#E5E5E5"> that this let's say most</font>

32
00:01:40,490 --> 00:01:45,919
common vulnerabilities like XSS<font color="#E5E5E5"> or SQL</font>

33
00:01:43,579 --> 00:01:48,169
injections<font color="#CCCCCC"> no</font><font color="#E5E5E5"> insecure direct object</font>

34
00:01:45,920 --> 00:01:51,229
<font color="#E5E5E5">offense is very hard to</font><font color="#CCCCCC"> find these</font>

35
00:01:48,170 --> 00:01:53,960
vulnerabilities in bug bounty programs

36
00:01:51,229 --> 00:01:56,570
because you know a<font color="#E5E5E5"> lot of people test</font>

37
00:01:53,960 --> 00:01:58,820
this side so it's not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> find</font>

38
00:01:56,570 --> 00:02:01,788
common<font color="#E5E5E5"> owner abilities so these</font>

39
00:01:58,820 --> 00:02:03,529
vulnerabilities are not a<font color="#E5E5E5"> common one</font><font color="#CCCCCC"> the</font>

40
00:02:01,789 --> 00:02:06,439
thing is<font color="#E5E5E5"> that they</font><font color="#CCCCCC"> are not described in</font>

41
00:02:03,530 --> 00:02:07,840
<font color="#CCCCCC">our top ten which is</font><font color="#E5E5E5"> probably the most</font>

42
00:02:06,439 --> 00:02:10,818
well-known document<font color="#E5E5E5"> about</font>

43
00:02:07,840 --> 00:02:12,710
vulnerabilities in the applications they

44
00:02:10,818 --> 00:02:14,810
are<font color="#E5E5E5"> not described in our testing guide</font>

45
00:02:12,710 --> 00:02:17,950
so I checked that before<font color="#E5E5E5"> before coming</font>

46
00:02:14,810 --> 00:02:20,900
here and<font color="#E5E5E5"> basically if you go to</font><font color="#CCCCCC"> OS</font>

47
00:02:17,950 --> 00:02:24,230
methodology<font color="#E5E5E5"> there is nothing about HTTP</font>

48
00:02:20,900 --> 00:02:26,150
headers about these two<font color="#E5E5E5"> that I'm going</font>

49
00:02:24,230 --> 00:02:29,690
<font color="#CCCCCC">to represent you today</font>

50
00:02:26,150 --> 00:02:31,730
so the thing is<font color="#CCCCCC"> that not</font><font color="#E5E5E5"> a lot of people</font>

51
00:02:29,690 --> 00:02:36,980
know<font color="#CCCCCC"> about</font><font color="#E5E5E5"> these vulnerabilities</font>

52
00:02:31,730 --> 00:02:39,230
however they result in<font color="#CCCCCC"> high-impact</font>

53
00:02:36,980 --> 00:02:41,780
vulnerabilities<font color="#E5E5E5"> in high high risks for</font>

54
00:02:39,230 --> 00:02:44,230
for the<font color="#E5E5E5"> entire organization</font><font color="#CCCCCC"> so we'll go</font>

55
00:02:41,780 --> 00:02:47,200
through<font color="#CCCCCC"> some examples</font><font color="#E5E5E5"> today but</font>

56
00:02:44,230 --> 00:02:51,078
basically as I already mentioned<font color="#E5E5E5"> they're</font>

57
00:02:47,200 --> 00:02:52,819
very uncommon<font color="#CCCCCC"> and</font><font color="#E5E5E5"> they are hard to find</font>

58
00:02:51,079 --> 00:02:55,510
<font color="#CCCCCC">because they are</font><font color="#E5E5E5"> not easily detectable</font>

59
00:02:52,819 --> 00:02:58,040
with automatic scanners<font color="#E5E5E5"> their</font>

60
00:02:55,510 --> 00:03:00,890
<font color="#E5E5E5">infrastructure or architecture dependent</font>

61
00:02:58,040 --> 00:03:02,569
so basically they might be in one

62
00:03:00,890 --> 00:03:04,670
<font color="#E5E5E5">application</font><font color="#CCCCCC"> on one environment</font>

63
00:03:02,569 --> 00:03:06,798
but<font color="#E5E5E5"> not on in the same</font><font color="#CCCCCC"> application on</font>

64
00:03:04,670 --> 00:03:09,260
the other environment so because<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that</font>

65
00:03:06,799 --> 00:03:11,230
I believe<font color="#CCCCCC"> that they are not that</font><font color="#E5E5E5"> popular</font>

66
00:03:09,260 --> 00:03:13,310
among speakers<font color="#E5E5E5"> and researchers so</font>

67
00:03:11,230 --> 00:03:15,340
hopefully this<font color="#E5E5E5"> will be</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> new for</font>

68
00:03:13,310 --> 00:03:19,640
<font color="#CCCCCC">you as well</font>

69
00:03:15,340 --> 00:03:22,459
okay so basics<font color="#E5E5E5"> so water HTTP headers so</font>

70
00:03:19,640 --> 00:03:25,010
each time<font color="#CCCCCC"> you perform some actions</font><font color="#E5E5E5"> let's</font>

71
00:03:22,459 --> 00:03:28,129
say in<font color="#CCCCCC"> your</font><font color="#E5E5E5"> web browser</font><font color="#CCCCCC"> your web</font><font color="#E5E5E5"> browser</font>

72
00:03:25,010 --> 00:03:30,950
<font color="#CCCCCC">will send</font><font color="#E5E5E5"> so-called HTTP</font><font color="#CCCCCC"> requests</font><font color="#E5E5E5"> to the</font>

73
00:03:28,129 --> 00:03:34,040
<font color="#E5E5E5">web server and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> request contains of</font>

74
00:03:30,950 --> 00:03:36,950
HTTP headers which are which are Indies

75
00:03:34,040 --> 00:03:40,638
and from request body which is sent

76
00:03:36,950 --> 00:03:42,950
<font color="#E5E5E5">right after HTTP headers so basically as</font>

77
00:03:40,639 --> 00:03:43,549
you<font color="#CCCCCC"> can see here you have</font><font color="#E5E5E5"> like a couple</font>

78
00:03:42,950 --> 00:03:46,578
<font color="#E5E5E5">of them</font>

79
00:03:43,549 --> 00:03:48,950
<font color="#CCCCCC">so how's</font><font color="#E5E5E5"> user</font><font color="#CCCCCC"> agent</font><font color="#E5E5E5"> cookie connection</font><font color="#CCCCCC"> on</font>

80
00:03:46,579 --> 00:03:50,889
<font color="#E5E5E5">all of</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> basically if you google</font>

81
00:03:48,950 --> 00:03:56,388
that<font color="#E5E5E5"> in Wikipedia I will find a list of</font>

82
00:03:50,889 --> 00:03:58,699
<font color="#CCCCCC">551 common HTTP headers service already</font>

83
00:03:56,389 --> 00:04:01,280
mentioned<font color="#E5E5E5"> today we are going</font><font color="#CCCCCC"> to discuss</font>

84
00:03:58,699 --> 00:04:07,099
two of them<font color="#E5E5E5"> so first of all the host</font>

85
00:04:01,280 --> 00:04:10,639
<font color="#E5E5E5">header which basically allows you to to</font>

86
00:04:07,099 --> 00:04:12,980
<font color="#E5E5E5">differentiate to which</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> to eat to</font>

87
00:04:10,639 --> 00:04:15,709
which virtual host the request<font color="#E5E5E5"> should go</font>

88
00:04:12,980 --> 00:04:17,358
to so for example if you have a<font color="#E5E5E5"> number</font>

89
00:04:15,709 --> 00:04:20,690
<font color="#CCCCCC">of applications with adding on the same</font>

90
00:04:17,358 --> 00:04:24,049
host you<font color="#E5E5E5"> can choose which of them should</font>

91
00:04:20,690 --> 00:04:26,990
this request reach and the second type

92
00:04:24,050 --> 00:04:29,810
of<font color="#E5E5E5"> header is x-forwarded-for</font>

93
00:04:26,990 --> 00:04:34,400
so this is this header which<font color="#CCCCCC"> is used by</font>

94
00:04:29,810 --> 00:04:37,449
proxies<font color="#E5E5E5"> by load balancer to to tell our</font>

95
00:04:34,400 --> 00:04:42,159
server<font color="#E5E5E5"> what's the real IP</font>

96
00:04:37,449 --> 00:04:47,830
of of the client<font color="#CCCCCC"> I set it up</font>

97
00:04:42,159 --> 00:04:51,430
<font color="#CCCCCC">AWS lab so if some of you prefer to</font><font color="#E5E5E5"> test</font>

98
00:04:47,830 --> 00:04:53,378
that during on their laptops<font color="#E5E5E5"> we can just</font>

99
00:04:51,430 --> 00:04:55,960
go to this<font color="#CCCCCC"> webpage</font><font color="#E5E5E5"> and and and play it</font>

100
00:04:53,379 --> 00:04:59,169
with<font color="#E5E5E5"> that a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> it's not like</font>

101
00:04:55,960 --> 00:05:01,359
<font color="#E5E5E5">super fancy environment but in general</font>

102
00:04:59,169 --> 00:05:03,520
<font color="#E5E5E5">some of these</font><font color="#CCCCCC"> examples that</font><font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to</font>

103
00:05:01,360 --> 00:05:06,279
present today<font color="#E5E5E5"> might be just check on</font>

104
00:05:03,520 --> 00:05:09,370
this<font color="#CCCCCC"> website</font><font color="#E5E5E5"> and you can easily see see</font>

105
00:05:06,279 --> 00:05:11,710
what are the results<font color="#CCCCCC"> this URL will just</font>

106
00:05:09,370 --> 00:05:14,529
go all<font color="#CCCCCC"> the way down here so it will be</font>

107
00:05:11,710 --> 00:05:19,299
<font color="#E5E5E5">presented</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> during the entire</font>

108
00:05:14,529 --> 00:05:23,969
presentation<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> I start</font><font color="#E5E5E5"> do we</font>

109
00:05:19,300 --> 00:05:27,849
have any penetration testers<font color="#E5E5E5"> in the room</font>

110
00:05:23,969 --> 00:05:33,939
okay<font color="#E5E5E5"> cool and do we have any developers</font>

111
00:05:27,849 --> 00:05:37,050
or<font color="#E5E5E5"> DevOps okay</font><font color="#CCCCCC"> correct so starting from</font>

112
00:05:33,939 --> 00:05:40,240
the first<font color="#E5E5E5"> issue so poisoning so</font>

113
00:05:37,050 --> 00:05:42,370
poisoning is I would say it's<font color="#E5E5E5"> quite</font>

114
00:05:40,240 --> 00:05:47,379
<font color="#E5E5E5">common because</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> people know</font>

115
00:05:42,370 --> 00:05:49,449
about<font color="#E5E5E5"> about hospice on</font><font color="#CCCCCC"> Inc but the thing</font>

116
00:05:47,379 --> 00:05:51,789
is<font color="#CCCCCC"> that it's hard to</font><font color="#E5E5E5"> find a practical</font>

117
00:05:49,449 --> 00:05:54,819
practical example<font color="#E5E5E5"> of exploiting this</font>

118
00:05:51,789 --> 00:05:57,219
vulnerability<font color="#E5E5E5"> so in general these</font>

119
00:05:54,819 --> 00:06:00,009
attacks are described<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> internet</font>

120
00:05:57,219 --> 00:06:03,039
<font color="#E5E5E5">but it's hard to find</font><font color="#CCCCCC"> like a use</font><font color="#E5E5E5"> case of</font>

121
00:06:00,009 --> 00:06:05,199
<font color="#CCCCCC">such an attack however</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> examples</font><font color="#E5E5E5"> I'm</font>

122
00:06:03,039 --> 00:06:07,599
going<font color="#E5E5E5"> to present will give you such an</font>

123
00:06:05,199 --> 00:06:10,779
<font color="#CCCCCC">opportunity so this is a common password</font>

124
00:06:07,599 --> 00:06:13,628
<font color="#CCCCCC">reset flow so we use that wants to reset</font>

125
00:06:10,779 --> 00:06:16,599
his or her password<font color="#E5E5E5"> he will send a</font>

126
00:06:13,629 --> 00:06:21,879
<font color="#E5E5E5">request to to do to some web server like</font>

127
00:06:16,599 --> 00:06:24,430
<font color="#E5E5E5">it</font><font color="#CCCCCC"> Monken comma with his email in post</font>

128
00:06:21,879 --> 00:06:27,219
request body and sever will respond with

129
00:06:24,430 --> 00:06:30,459
<font color="#CCCCCC">the with with</font><font color="#E5E5E5"> an email which allows him</font>

130
00:06:27,219 --> 00:06:34,139
to set a new password and and<font color="#E5E5E5"> to reset</font>

131
00:06:30,459 --> 00:06:37,479
the old one<font color="#E5E5E5"> right so the thing is that</font>

132
00:06:34,139 --> 00:06:41,770
<font color="#CCCCCC">if the application is vulnerable to this</font>

133
00:06:37,479 --> 00:06:47,399
hospital<font color="#E5E5E5"> poisoning</font><font color="#CCCCCC"> hacker</font><font color="#E5E5E5"> or a bad guy</font>

134
00:06:41,770 --> 00:06:50,469
<font color="#CCCCCC">basically can use host header with some</font>

135
00:06:47,399 --> 00:06:51,190
let's say<font color="#E5E5E5"> malicious</font><font color="#CCCCCC"> web site</font><font color="#E5E5E5"> send this</font>

136
00:06:50,469 --> 00:06:54,099
request to<font color="#CCCCCC"> the</font>

137
00:06:51,190 --> 00:06:56,650
<font color="#CCCCCC">webserver</font><font color="#E5E5E5"> and if the application is</font>

138
00:06:54,100 --> 00:07:02,530
vulnerable<font color="#CCCCCC"> the server will respond with</font>

139
00:06:56,650 --> 00:07:05,530
an<font color="#E5E5E5"> email with this malicious domain</font>

140
00:07:02,530 --> 00:07:09,070
<font color="#CCCCCC">within its body</font><font color="#E5E5E5"> so basically</font><font color="#CCCCCC"> server will</font>

141
00:07:05,530 --> 00:07:10,960
take this value and<font color="#CCCCCC"> just paste it to the</font>

142
00:07:09,070 --> 00:07:14,290
<font color="#CCCCCC">email</font><font color="#E5E5E5"> so the email will come from the</font>

143
00:07:10,960 --> 00:07:17,710
<font color="#E5E5E5">legitimate mail server however the link</font>

144
00:07:14,290 --> 00:07:19,930
will point<font color="#E5E5E5"> user to some malicious site</font>

145
00:07:17,710 --> 00:07:23,169
right<font color="#CCCCCC"> and</font><font color="#E5E5E5"> in that case if user is</font>

146
00:07:19,930 --> 00:07:26,050
unaware<font color="#E5E5E5"> of</font><font color="#CCCCCC"> what may happen</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> their</font>

147
00:07:23,170 --> 00:07:32,080
his credentials will be sent to<font color="#CCCCCC"> - due to</font>

148
00:07:26,050 --> 00:07:34,660
<font color="#CCCCCC">the malicious Oscar another</font><font color="#E5E5E5"> example</font><font color="#CCCCCC"> also</font>

149
00:07:32,080 --> 00:07:37,000
<font color="#E5E5E5">connected</font><font color="#CCCCCC"> to host header</font><font color="#E5E5E5"> this is this is</font>

150
00:07:34,660 --> 00:07:38,410
not<font color="#CCCCCC"> directly</font><font color="#E5E5E5"> related</font><font color="#CCCCCC"> to web application</font>

151
00:07:37,000 --> 00:07:42,580
itself is more like infrastructure

152
00:07:38,410 --> 00:07:45,250
however<font color="#E5E5E5"> is</font><font color="#CCCCCC"> also like quite a crucial one</font>

153
00:07:42,580 --> 00:07:48,070
<font color="#E5E5E5">so let's imagine a situation</font><font color="#CCCCCC"> where where</font>

154
00:07:45,250 --> 00:07:50,530
we have two servers which<font color="#E5E5E5"> are for</font>

155
00:07:48,070 --> 00:07:53,170
example behind<font color="#E5E5E5"> some load balancer</font><font color="#CCCCCC"> we can</font>

156
00:07:50,530 --> 00:07:56,469
also consider<font color="#E5E5E5"> them as two virtual</font>

157
00:07:53,170 --> 00:07:59,200
servers on on one physical<font color="#CCCCCC"> host for</font>

158
00:07:56,470 --> 00:08:02,530
<font color="#E5E5E5">example so in that case when user wants</font>

159
00:07:59,200 --> 00:08:05,320
<font color="#CCCCCC">to reach external one monkey com</font>

160
00:08:02,530 --> 00:08:07,659
<font color="#E5E5E5">he will send the request the request</font>

161
00:08:05,320 --> 00:08:09,250
<font color="#E5E5E5">will be intercepted but by some poxy</font>

162
00:08:07,660 --> 00:08:12,340
a load balancer<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the load balancer</font>

163
00:08:09,250 --> 00:08:14,650
<font color="#CCCCCC">who is we will send that request to - to</font>

164
00:08:12,340 --> 00:08:16,330
this server<font color="#E5E5E5"> right the thing is and then</font>

165
00:08:14,650 --> 00:08:19,659
<font color="#E5E5E5">the server obviously will</font><font color="#CCCCCC"> will let our</font>

166
00:08:16,330 --> 00:08:24,159
return some some<font color="#CCCCCC"> webpage</font><font color="#E5E5E5"> right the thing</font>

167
00:08:19,660 --> 00:08:28,240
is that an attacker<font color="#E5E5E5"> may simply a modify</font>

168
00:08:24,160 --> 00:08:30,610
<font color="#E5E5E5">value of host header and if web box is</font>

169
00:08:28,240 --> 00:08:32,549
not configured<font color="#E5E5E5"> properly</font><font color="#CCCCCC"> of if</font><font color="#E5E5E5"> someone</font>

170
00:08:30,610 --> 00:08:36,580
decides to host<font color="#E5E5E5"> internal external</font>

171
00:08:32,549 --> 00:08:39,968
applications on the same host<font color="#E5E5E5"> there is a</font>

172
00:08:36,580 --> 00:08:43,060
chance<font color="#CCCCCC"> that this how this request will</font>

173
00:08:39,969 --> 00:08:45,790
get forwarded to some internal<font color="#E5E5E5"> web</font>

174
00:08:43,059 --> 00:08:47,800
server and internal web page will<font color="#E5E5E5"> be</font>

175
00:08:45,790 --> 00:08:51,160
<font color="#E5E5E5">returned back</font><font color="#CCCCCC"> to the attacker</font>

176
00:08:47,800 --> 00:08:53,349
so basically we can<font color="#E5E5E5"> get an access to to</font>

177
00:08:51,160 --> 00:08:58,540
the internal infrastructure<font color="#E5E5E5"> just by</font>

178
00:08:53,350 --> 00:08:59,980
abusing<font color="#E5E5E5"> the the host header value now if</font>

179
00:08:58,540 --> 00:09:03,250
you think<font color="#CCCCCC"> that</font><font color="#E5E5E5"> such an attack</font><font color="#CCCCCC"> is</font>

180
00:08:59,980 --> 00:09:04,840
<font color="#E5E5E5">uncommon</font><font color="#CCCCCC"> you can just go to - - these</font>

181
00:09:03,250 --> 00:09:07,540
two articles<font color="#E5E5E5"> like</font><font color="#CCCCCC"> Tehran or</font>

182
00:09:04,840 --> 00:09:10,000
try to<font color="#E5E5E5"> google</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so basically one guy</font>

183
00:09:07,540 --> 00:09:12,250
from<font color="#CCCCCC"> I</font><font color="#E5E5E5"> believe Ecuador found such a</font>

184
00:09:10,000 --> 00:09:14,500
vulnerability in<font color="#E5E5E5"> Google so he received</font>

185
00:09:12,250 --> 00:09:16,690
like<font color="#CCCCCC"> 10,000 u.s. dollars back bounty</font>

186
00:09:14,500 --> 00:09:18,750
<font color="#E5E5E5">there was</font><font color="#CCCCCC"> sodom some other guy</font><font color="#E5E5E5"> who</font><font color="#CCCCCC"> also</font>

187
00:09:16,690 --> 00:09:21,580
used this technique to<font color="#CCCCCC"> basically to</font>

188
00:09:18,750 --> 00:09:24,580
infiltrate like<font color="#E5E5E5"> 27 Department of Defense</font>

189
00:09:21,580 --> 00:09:28,210
<font color="#CCCCCC">Service so it's it's a pretty that's</font><font color="#E5E5E5"> a</font>

190
00:09:24,580 --> 00:09:30,850
huge issue<font color="#E5E5E5"> in the end so just</font><font color="#CCCCCC"> to sum up</font>

191
00:09:28,210 --> 00:09:35,100
this let's say this<font color="#CCCCCC"> first chapter</font><font color="#E5E5E5"> about</font>

192
00:09:30,850 --> 00:09:38,790
these<font color="#E5E5E5"> host header issues</font><font color="#CCCCCC"> so obviously</font>

193
00:09:35,100 --> 00:09:42,430
you need<font color="#CCCCCC"> to remember</font><font color="#E5E5E5"> that all of</font><font color="#CCCCCC"> the</font>

194
00:09:38,790 --> 00:09:44,740
data which is<font color="#E5E5E5"> passed in HTTP headers</font>

195
00:09:42,430 --> 00:09:46,870
might be spoofed by<font color="#E5E5E5"> the attacker so you</font>

196
00:09:44,740 --> 00:09:50,140
shouldn't<font color="#E5E5E5"> trust any value which is</font>

197
00:09:46,870 --> 00:09:52,930
passed in the in the in<font color="#E5E5E5"> the host headers</font>

198
00:09:50,140 --> 00:09:54,699
or any other headers<font color="#CCCCCC"> what's</font><font color="#E5E5E5"> very</font>

199
00:09:52,930 --> 00:09:57,989
important is that these vulnerabilities

200
00:09:54,700 --> 00:10:02,560
<font color="#E5E5E5">are not specific for tested services</font>

201
00:09:57,990 --> 00:10:05,950
because in the<font color="#E5E5E5"> end they may also result</font>

202
00:10:02,560 --> 00:10:09,040
in in abusing<font color="#E5E5E5"> some for</font><font color="#CCCCCC"> example internal</font>

203
00:10:05,950 --> 00:10:12,850
<font color="#E5E5E5">services and in some other some other</font>

204
00:10:09,040 --> 00:10:14,469
<font color="#E5E5E5">applications</font><font color="#CCCCCC"> writes</font><font color="#E5E5E5"> on some other let's</font>

205
00:10:12,850 --> 00:10:16,570
call it applications which I think on

206
00:10:14,470 --> 00:10:18,490
the same same host so the thing is<font color="#CCCCCC"> that</font>

207
00:10:16,570 --> 00:10:21,940
<font color="#CCCCCC">for example if you are able to exploit</font>

208
00:10:18,490 --> 00:10:23,950
this this this vulnerability<font color="#E5E5E5"> that I</font>

209
00:10:21,940 --> 00:10:25,570
mentioned in the<font color="#E5E5E5"> previous slide</font><font color="#CCCCCC"> you are</font>

210
00:10:23,950 --> 00:10:27,520
<font color="#CCCCCC">able to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> access to some other</font>

211
00:10:25,570 --> 00:10:33,760
applications and not<font color="#CCCCCC"> only</font><font color="#E5E5E5"> to the tested</font>

212
00:10:27,520 --> 00:10:35,860
one okay<font color="#CCCCCC"> so these are let's say tactical</font>

213
00:10:33,760 --> 00:10:38,710
recommendations for for the developers

214
00:10:35,860 --> 00:10:41,380
so you shouldn't<font color="#E5E5E5"> trust any values which</font>

215
00:10:38,710 --> 00:10:43,480
are<font color="#E5E5E5"> passed in the host header and in X</font>

216
00:10:41,380 --> 00:10:45,100
for<font color="#E5E5E5"> valid host header because in in</font>

217
00:10:43,480 --> 00:10:47,350
general<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you are not able to exploit</font>

218
00:10:45,100 --> 00:10:48,910
this vulnerability using host header you

219
00:10:47,350 --> 00:10:51,160
should probably add additional header

220
00:10:48,910 --> 00:10:53,380
which<font color="#CCCCCC"> will be</font><font color="#E5E5E5"> X forwarded host and there</font>

221
00:10:51,160 --> 00:10:55,990
is a strong<font color="#CCCCCC"> chance that one of these</font>

222
00:10:53,380 --> 00:10:59,740
headers<font color="#E5E5E5"> will work just fine</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> this</font>

223
00:10:55,990 --> 00:11:02,200
application<font color="#CCCCCC"> you need to watch out</font><font color="#E5E5E5"> while</font>

224
00:10:59,740 --> 00:11:04,510
deploying solution on<font color="#E5E5E5"> multiple</font>

225
00:11:02,200 --> 00:11:07,570
environments so that's a quite common

226
00:11:04,510 --> 00:11:10,210
issue that<font color="#CCCCCC"> let's say</font><font color="#E5E5E5"> lazy developer will</font>

227
00:11:07,570 --> 00:11:12,730
just take his application<font color="#E5E5E5"> implement</font><font color="#CCCCCC"> it</font>

228
00:11:10,210 --> 00:11:14,560
on its own let's say testing

229
00:11:12,730 --> 00:11:18,040
<font color="#CCCCCC">infrastructure the application work is</font>

230
00:11:14,560 --> 00:11:19,869
<font color="#E5E5E5">just fine because it just takes the</font>

231
00:11:18,040 --> 00:11:22,510
host header value and paste is that in

232
00:11:19,870 --> 00:11:24,160
the in the email<font color="#E5E5E5"> however later on when</font>

233
00:11:22,510 --> 00:11:27,160
<font color="#E5E5E5">this application is deployed in client</font>

234
00:11:24,160 --> 00:11:30,550
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> it is</font><font color="#CCCCCC"> vulnerable to</font><font color="#E5E5E5"> this to</font>

235
00:11:27,160 --> 00:11:33,640
this<font color="#E5E5E5"> issue which allows</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> send a</font>

236
00:11:30,550 --> 00:11:36,069
spoofed<font color="#CCCCCC"> password</font><font color="#E5E5E5"> reset emails so because</font>

237
00:11:33,640 --> 00:11:39,189
of that you<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> remember again</font><font color="#E5E5E5"> not</font>

238
00:11:36,070 --> 00:11:41,890
to trust the the host<font color="#E5E5E5"> header and</font>

239
00:11:39,190 --> 00:11:44,590
obviously<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> the most important</font>

240
00:11:41,890 --> 00:11:46,990
<font color="#E5E5E5">one but not specific for web</font>

241
00:11:44,590 --> 00:11:49,510
applications<font color="#E5E5E5"> so make sure that you</font>

242
00:11:46,990 --> 00:11:52,690
configure<font color="#CCCCCC"> your reverse proxy and virtual</font>

243
00:11:49,510 --> 00:11:55,210
<font color="#CCCCCC">host incorrectly obviously is</font><font color="#E5E5E5"> probably</font>

244
00:11:52,690 --> 00:11:58,210
easy to<font color="#E5E5E5"> say not easy to do but in</font>

245
00:11:55,210 --> 00:12:00,900
general you should<font color="#E5E5E5"> probably avoid for</font>

246
00:11:58,210 --> 00:12:03,310
example hosting external and internal

247
00:12:00,900 --> 00:12:09,939
applications on<font color="#E5E5E5"> this area on the same</font>

248
00:12:03,310 --> 00:12:14,140
host<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> second header</font><font color="#CCCCCC"> which I would like</font>

249
00:12:09,940 --> 00:12:18,640
to discuss<font color="#CCCCCC"> today is extraordinaire</font><font color="#E5E5E5"> so</font>

250
00:12:14,140 --> 00:12:22,840
again that's a header which<font color="#CCCCCC"> is sent by a</font>

251
00:12:18,640 --> 00:12:24,640
web proxy tool to the<font color="#CCCCCC"> web server -</font><font color="#E5E5E5"> for</font>

252
00:12:22,840 --> 00:12:27,250
web server<font color="#E5E5E5"> to understand what's the</font><font color="#CCCCCC"> IP</font>

253
00:12:24,640 --> 00:12:30,430
address<font color="#CCCCCC"> of client</font><font color="#E5E5E5"> so that's the</font>

254
00:12:27,250 --> 00:12:32,260
legitimate flow so let's imagine that<font color="#E5E5E5"> we</font>

255
00:12:30,430 --> 00:12:34,660
<font color="#E5E5E5">have</font><font color="#CCCCCC"> some application which</font><font color="#E5E5E5"> allows an</font>

256
00:12:32,260 --> 00:12:37,590
administrator<font color="#CCCCCC"> to view the access log in</font>

257
00:12:34,660 --> 00:12:41,290
the web browser<font color="#E5E5E5"> so clients want to</font>

258
00:12:37,590 --> 00:12:45,130
clients coming from<font color="#E5E5E5"> 9 8 7 6 IP address</font>

259
00:12:41,290 --> 00:12:46,810
wants to reach<font color="#CCCCCC"> a banking.com</font><font color="#E5E5E5"> he sends a</font>

260
00:12:45,130 --> 00:12:50,310
request this request is intercepted<font color="#CCCCCC"> by</font>

261
00:12:46,810 --> 00:12:55,930
some proxy<font color="#E5E5E5"> or load balancer or whatever</font>

262
00:12:50,310 --> 00:12:58,209
<font color="#E5E5E5">so this this device puts extra valid for</font>

263
00:12:55,930 --> 00:13:01,569
header with IP address<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this customer</font>

264
00:12:58,210 --> 00:13:04,840
<font color="#E5E5E5">and it sends</font><font color="#CCCCCC"> that to to the banking.com</font>

265
00:13:01,570 --> 00:13:07,060
right so now the<font color="#E5E5E5"> banking.com server</font>

266
00:13:04,840 --> 00:13:10,510
knows that there<font color="#E5E5E5"> is this device in</font>

267
00:13:07,060 --> 00:13:12,880
between<font color="#E5E5E5"> so it will take</font><font color="#CCCCCC"> the IP address</font>

268
00:13:10,510 --> 00:13:16,030
from from this header and put<font color="#E5E5E5"> that</font>

269
00:13:12,880 --> 00:13:19,240
<font color="#E5E5E5">directly into access lock on the server</font>

270
00:13:16,030 --> 00:13:21,459
<font color="#E5E5E5">so basically it should work just fine</font>

271
00:13:19,240 --> 00:13:24,240
<font color="#CCCCCC">but there are many issues with</font><font color="#E5E5E5"> that so</font>

272
00:13:21,460 --> 00:13:27,520
first of all different application

273
00:13:24,240 --> 00:13:29,770
different applications treats<font color="#E5E5E5"> values in</font>

274
00:13:27,520 --> 00:13:31,150
that<font color="#E5E5E5"> server in that header in a</font>

275
00:13:29,770 --> 00:13:31,779
different way<font color="#CCCCCC"> so some of the</font>

276
00:13:31,150 --> 00:13:33,790
applications

277
00:13:31,779 --> 00:13:35,980
<font color="#E5E5E5">they see for example multiple</font>

278
00:13:33,790 --> 00:13:39,040
<font color="#CCCCCC">x-forwarded-for values</font><font color="#E5E5E5"> they will take</font>

279
00:13:35,980 --> 00:13:40,810
only the first one<font color="#E5E5E5"> some of them will</font>

280
00:13:39,040 --> 00:13:42,910
take<font color="#E5E5E5"> none of them and you need to</font>

281
00:13:40,810 --> 00:13:46,119
remember<font color="#CCCCCC"> that sometimes there might be a</font>

282
00:13:42,910 --> 00:13:47,889
situation when some someone decides<font color="#E5E5E5"> to</font>

283
00:13:46,120 --> 00:13:49,930
change<font color="#CCCCCC"> the architecture</font><font color="#E5E5E5"> the network</font>

284
00:13:47,889 --> 00:13:53,769
architecture<font color="#CCCCCC"> and basically they</font><font color="#E5E5E5"> will</font>

285
00:13:49,930 --> 00:13:58,839
<font color="#E5E5E5">decide to take that</font><font color="#CCCCCC"> piece take they</font><font color="#E5E5E5"> take</font>

286
00:13:53,769 --> 00:14:01,329
that device<font color="#E5E5E5"> out of</font><font color="#CCCCCC"> the let's say our</font>

287
00:13:58,839 --> 00:14:03,759
application architecture<font color="#E5E5E5"> and in that</font>

288
00:14:01,329 --> 00:14:07,089
case<font color="#E5E5E5"> anytime that an attacker will send</font>

289
00:14:03,759 --> 00:14:09,879
a request with x-forwarded-for header<font color="#E5E5E5"> he</font>

290
00:14:07,089 --> 00:14:12,579
will be able<font color="#E5E5E5"> to spoof the the IP address</font>

291
00:14:09,879 --> 00:14:13,809
of<font color="#E5E5E5"> all the requests the thing is that</font>

292
00:14:12,579 --> 00:14:19,180
you can use this<font color="#E5E5E5"> technique</font><font color="#CCCCCC"> for example</font>

293
00:14:13,809 --> 00:14:22,449
<font color="#E5E5E5">to inject the cost escaping value so I</font>

294
00:14:19,180 --> 00:14:26,339
spotted this vulnerability like number

295
00:14:22,449 --> 00:14:28,870
of times in couple<font color="#E5E5E5"> of let's say of</font>

296
00:14:26,339 --> 00:14:31,120
<font color="#CCCCCC">system of some major banks during bug</font>

297
00:14:28,870 --> 00:14:33,519
bounty programs<font color="#E5E5E5"> so I would say that</font><font color="#CCCCCC"> this</font>

298
00:14:31,120 --> 00:14:36,790
one is<font color="#E5E5E5"> common one it's it's not</font><font color="#CCCCCC"> always</font>

299
00:14:33,519 --> 00:14:41,920
you are not always able to paste the<font color="#E5E5E5"> two</font>

300
00:14:36,790 --> 00:14:45,339
to embed the the XSS payload<font color="#E5E5E5"> however</font>

301
00:14:41,920 --> 00:14:48,370
spoofing the<font color="#E5E5E5"> the IP address of incoming</font>

302
00:14:45,339 --> 00:14:53,649
<font color="#CCCCCC">requests is is quite quite quite a</font>

303
00:14:48,370 --> 00:14:56,589
<font color="#E5E5E5">obvious</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> okay more issues related</font>

304
00:14:53,649 --> 00:15:00,459
<font color="#CCCCCC">to</font><font color="#E5E5E5"> export it for business logic bypass</font>

305
00:14:56,589 --> 00:15:03,220
so for example if you have some<font color="#CCCCCC"> webpage</font>

306
00:15:00,459 --> 00:15:05,349
which<font color="#E5E5E5"> allows you to vote I don't know</font>

307
00:15:03,220 --> 00:15:09,250
for whatever right so there they might

308
00:15:05,350 --> 00:15:11,620
be there might<font color="#CCCCCC"> be some</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> voltic page</font>

309
00:15:09,250 --> 00:15:14,079
and they<font color="#E5E5E5"> did the person who gets the</font>

310
00:15:11,620 --> 00:15:17,050
<font color="#CCCCCC">most</font><font color="#E5E5E5"> votes wins some competition with</font>

311
00:15:14,079 --> 00:15:18,929
some<font color="#CCCCCC"> price</font><font color="#E5E5E5"> so in that case again if the</font>

312
00:15:17,050 --> 00:15:22,209
application is<font color="#CCCCCC"> not configured</font><font color="#E5E5E5"> properly</font>

313
00:15:18,929 --> 00:15:25,360
<font color="#E5E5E5">it is possible</font><font color="#CCCCCC"> to send multiple</font><font color="#E5E5E5"> requests</font>

314
00:15:22,209 --> 00:15:27,489
with coming<font color="#E5E5E5"> from different IP address</font>

315
00:15:25,360 --> 00:15:30,399
and despite the<font color="#CCCCCC"> fact that this</font>

316
00:15:27,490 --> 00:15:32,800
application<font color="#E5E5E5"> is configured to allow only</font>

317
00:15:30,399 --> 00:15:37,929
<font color="#E5E5E5">one vote per IP we are able</font><font color="#CCCCCC"> to bypass</font>

318
00:15:32,800 --> 00:15:41,769
<font color="#E5E5E5">this this safe mechanism but by using</font>

319
00:15:37,929 --> 00:15:43,439
multiple<font color="#E5E5E5"> x-forwarded-for header values</font>

320
00:15:41,769 --> 00:15:46,710
<font color="#E5E5E5">so again</font>

321
00:15:43,440 --> 00:15:49,530
<font color="#CCCCCC">I just calculated</font><font color="#E5E5E5"> it really quickly so</font>

322
00:15:46,710 --> 00:15:52,850
basically you can add yourself<font color="#CCCCCC"> like 4.2</font>

323
00:15:49,530 --> 00:15:55,110
billion of votes<font color="#E5E5E5"> and again that's</font>

324
00:15:52,850 --> 00:15:57,750
vulnerability which<font color="#CCCCCC"> I identified during</font>

325
00:15:55,110 --> 00:16:00,480
one of the bug bounty<font color="#E5E5E5"> programs so again</font>

326
00:15:57,750 --> 00:16:05,220
it's not<font color="#E5E5E5"> a common one</font><font color="#CCCCCC"> but it will allow</font>

327
00:16:00,480 --> 00:16:11,970
<font color="#CCCCCC">you to like</font><font color="#E5E5E5"> impact the results</font><font color="#CCCCCC"> of the</font>

328
00:16:05,220 --> 00:16:14,460
voting pretty much<font color="#E5E5E5"> and the first</font>

329
00:16:11,970 --> 00:16:17,670
scenario<font color="#E5E5E5"> also related to</font><font color="#CCCCCC"> 2x4 is for</font>

330
00:16:14,460 --> 00:16:19,290
header<font color="#E5E5E5"> and that's an issue which I have</font>

331
00:16:17,670 --> 00:16:21,719
<font color="#E5E5E5">not identified personally but my</font>

332
00:16:19,290 --> 00:16:24,300
<font color="#E5E5E5">colleague identified that in one</font><font color="#CCCCCC"> of the</font>

333
00:16:21,720 --> 00:16:25,980
<font color="#E5E5E5">global banks again so access control</font>

334
00:16:24,300 --> 00:16:29,219
<font color="#CCCCCC">bypass</font><font color="#E5E5E5"> so as you probably know some of</font>

335
00:16:25,980 --> 00:16:32,430
the applications rely<font color="#E5E5E5"> on the IP address</font>

336
00:16:29,220 --> 00:16:34,410
if they want<font color="#E5E5E5"> to restrict the access to</font>

337
00:16:32,430 --> 00:16:36,750
some<font color="#CCCCCC"> resources on the web server so</font>

338
00:16:34,410 --> 00:16:40,439
basically by simply modifying<font color="#E5E5E5"> the value</font>

339
00:16:36,750 --> 00:16:42,810
<font color="#CCCCCC">of X 404 header you can basically access</font>

340
00:16:40,440 --> 00:16:45,630
<font color="#E5E5E5">for example admin resources or some</font>

341
00:16:42,810 --> 00:16:47,459
other<font color="#CCCCCC"> similar restricted resources</font><font color="#E5E5E5"> so</font>

342
00:16:45,630 --> 00:16:51,240
basically my colleague<font color="#E5E5E5"> used the</font>

343
00:16:47,460 --> 00:16:53,190
technique<font color="#E5E5E5"> to to get access</font><font color="#CCCCCC"> to some debug</font>

344
00:16:51,240 --> 00:16:56,400
<font color="#CCCCCC">web</font><font color="#E5E5E5"> page which later on allowed him to</font>

345
00:16:53,190 --> 00:16:57,990
to perform<font color="#CCCCCC"> remote code execution on the</font>

346
00:16:56,400 --> 00:17:02,430
<font color="#E5E5E5">web server so</font><font color="#CCCCCC"> that was just</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> first</font>

347
00:16:57,990 --> 00:17:04,910
step<font color="#CCCCCC"> so he just</font><font color="#E5E5E5"> put</font><font color="#CCCCCC"> the localhost in X</font>

348
00:17:02,430 --> 00:17:12,540
<font color="#E5E5E5">for</font><font color="#CCCCCC"> defer for header and it worked just</font>

349
00:17:04,910 --> 00:17:16,560
just perfectly<font color="#E5E5E5"> okay so the question</font><font color="#CCCCCC"> is</font>

350
00:17:12,540 --> 00:17:18,720
how<font color="#CCCCCC"> to avoid</font><font color="#E5E5E5"> that so the problem with</font>

351
00:17:16,560 --> 00:17:21,359
this is<font color="#CCCCCC"> that this is like strictly</font>

352
00:17:18,720 --> 00:17:22,589
dependent<font color="#E5E5E5"> on the infrastructure and of</font>

353
00:17:21,359 --> 00:17:24,359
the architecture of<font color="#CCCCCC"> your web</font>

354
00:17:22,589 --> 00:17:28,919
applications so even if you are a

355
00:17:24,359 --> 00:17:32,100
<font color="#CCCCCC">developer</font><font color="#E5E5E5"> and you do a great</font><font color="#CCCCCC"> job of a</font>

356
00:17:28,920 --> 00:17:34,110
good job<font color="#CCCCCC"> it may</font><font color="#E5E5E5"> happen that it will be</font>

357
00:17:32,100 --> 00:17:36,360
vulnerable<font color="#E5E5E5"> to this kind</font><font color="#CCCCCC"> of attacks</font>

358
00:17:34,110 --> 00:17:38,610
because people from from<font color="#CCCCCC"> your</font>

359
00:17:36,360 --> 00:17:42,060
infrastructure team<font color="#E5E5E5"> removed something</font>

360
00:17:38,610 --> 00:17:44,790
from<font color="#E5E5E5"> some components from the from</font><font color="#CCCCCC"> this</font>

361
00:17:42,060 --> 00:17:47,730
<font color="#E5E5E5">system</font><font color="#CCCCCC"> and never told you about that</font><font color="#E5E5E5"> so</font>

362
00:17:44,790 --> 00:17:50,220
there is such a risk<font color="#E5E5E5"> however we can</font>

363
00:17:47,730 --> 00:17:52,440
somehow<font color="#E5E5E5"> mitigate such a risk so first of</font>

364
00:17:50,220 --> 00:17:55,590
all<font color="#E5E5E5"> we can create the applications which</font>

365
00:17:52,440 --> 00:17:56,940
let's say are<font color="#E5E5E5"> aware of such a such a</font>

366
00:17:55,590 --> 00:17:59,610
possibility and then you can

367
00:17:56,940 --> 00:18:02,610
just your<font color="#E5E5E5"> code</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to prevent such an</font>

368
00:17:59,610 --> 00:18:04,919
attack<font color="#E5E5E5"> obviously you shouldn't trust the</font>

369
00:18:02,610 --> 00:18:07,110
values which are<font color="#E5E5E5"> passed in the</font><font color="#CCCCCC"> export</font><font color="#E5E5E5"> is</font>

370
00:18:04,920 --> 00:18:09,300
for headers<font color="#E5E5E5"> and you should include all</font>

371
00:18:07,110 --> 00:18:12,780
<font color="#E5E5E5">the</font><font color="#CCCCCC"> values to</font><font color="#E5E5E5"> avoid this cross site</font>

372
00:18:09,300 --> 00:18:16,080
scripting attacks last but not least

373
00:18:12,780 --> 00:18:17,820
probably the most important<font color="#E5E5E5"> one</font><font color="#CCCCCC"> so think</font>

374
00:18:16,080 --> 00:18:20,669
<font color="#E5E5E5">twice before copying and pasting</font><font color="#CCCCCC"> codes</font>

375
00:18:17,820 --> 00:18:24,720
because<font color="#E5E5E5"> you may use you may encounter</font>

376
00:18:20,670 --> 00:18:27,600
<font color="#CCCCCC">some of the code snippets for example on</font>

377
00:18:24,720 --> 00:18:31,230
I don't<font color="#CCCCCC"> know like on paste bin or Stack</font>

378
00:18:27,600 --> 00:18:35,760
Overflow<font color="#E5E5E5"> or whatever else so this this</font>

379
00:18:31,230 --> 00:18:38,040
codes events may work just<font color="#CCCCCC"> fine</font><font color="#E5E5E5"> on their</font>

380
00:18:35,760 --> 00:18:39,780
environment<font color="#CCCCCC"> but on your environment</font><font color="#E5E5E5"> this</font>

381
00:18:38,040 --> 00:18:44,480
one is going<font color="#CCCCCC"> to work like</font><font color="#E5E5E5"> completely</font>

382
00:18:39,780 --> 00:18:45,780
different<font color="#CCCCCC"> and make us some some issues</font>

383
00:18:44,480 --> 00:18:48,510
<font color="#E5E5E5">okay</font>

384
00:18:45,780 --> 00:18:50,550
so summary and and key takeaways from

385
00:18:48,510 --> 00:18:52,590
<font color="#E5E5E5">the presentation so as I already</font>

386
00:18:50,550 --> 00:18:56,370
<font color="#CCCCCC">mentioned so most of these</font><font color="#E5E5E5"> examples were</font>

387
00:18:52,590 --> 00:18:58,139
identified in in in life systems which

388
00:18:56,370 --> 00:19:00,469
were exposed<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> Internet so</font>

389
00:18:58,140 --> 00:19:02,640
basically you could easily exploit that

390
00:19:00,470 --> 00:19:05,130
vulnerabilities to<font color="#E5E5E5"> get in no control</font>

391
00:19:02,640 --> 00:19:07,230
<font color="#CCCCCC">over some server</font><font color="#E5E5E5"> you could exploit that</font>

392
00:19:05,130 --> 00:19:09,960
<font color="#E5E5E5">to spoof some emails you could exploit</font>

393
00:19:07,230 --> 00:19:13,590
that to to modify the the<font color="#E5E5E5"> results of</font>

394
00:19:09,960 --> 00:19:15,180
some of<font color="#CCCCCC"> some</font><font color="#E5E5E5"> online voting rights as I</font>

395
00:19:13,590 --> 00:19:17,790
mentioned a<font color="#CCCCCC"> couple of</font><font color="#E5E5E5"> times it's really</font>

396
00:19:15,180 --> 00:19:20,250
<font color="#E5E5E5">important to remember</font><font color="#CCCCCC"> that these</font>

397
00:19:17,790 --> 00:19:22,940
vulnerabilities<font color="#E5E5E5"> are strongly dependent</font>

398
00:19:20,250 --> 00:19:26,510
<font color="#E5E5E5">on the used infrastructure architecture</font>

399
00:19:22,940 --> 00:19:29,940
<font color="#CCCCCC">so it's</font><font color="#E5E5E5"> not very easy</font><font color="#CCCCCC"> to detect that</font>

400
00:19:26,510 --> 00:19:31,560
<font color="#CCCCCC">what's</font><font color="#E5E5E5"> even more important is that</font><font color="#CCCCCC"> we</font>

401
00:19:29,940 --> 00:19:33,720
<font color="#E5E5E5">have more and</font><font color="#CCCCCC"> more vulnerabilities which</font>

402
00:19:31,560 --> 00:19:35,820
are directly<font color="#CCCCCC"> related to</font><font color="#E5E5E5"> the to the</font>

403
00:19:33,720 --> 00:19:39,270
underlying infrastructure so for example

404
00:19:35,820 --> 00:19:41,010
<font color="#E5E5E5">cache poisoning</font><font color="#CCCCCC"> so that's one of them at</font>

405
00:19:39,270 --> 00:19:45,750
site includes<font color="#CCCCCC"> so that's again the seven</font>

406
00:19:41,010 --> 00:19:48,210
<font color="#E5E5E5">liability which basically is dependent</font>

407
00:19:45,750 --> 00:19:50,730
on the on the<font color="#E5E5E5"> caching servers which</font>

408
00:19:48,210 --> 00:19:54,660
might be<font color="#CCCCCC"> before the application and</font><font color="#E5E5E5"> also</font>

409
00:19:50,730 --> 00:19:58,680
more and<font color="#E5E5E5"> more people implement TLS 1.3</font>

410
00:19:54,660 --> 00:20:01,140
which has this zero<font color="#CCCCCC"> RTT and let's let's</font>

411
00:19:58,680 --> 00:20:04,590
<font color="#E5E5E5">call it a feature however if you enable</font>

412
00:20:01,140 --> 00:20:07,200
<font color="#E5E5E5">that TLS 1.3 we've 0tt you need to</font>

413
00:20:04,590 --> 00:20:09,419
remember that<font color="#E5E5E5"> you need to prevent or to</font>

414
00:20:07,200 --> 00:20:10,620
fight the replay attacks<font color="#E5E5E5"> on the</font>

415
00:20:09,420 --> 00:20:13,409
application level

416
00:20:10,620 --> 00:20:16,020
so again the the<font color="#CCCCCC"> application which which</font>

417
00:20:13,409 --> 00:20:17,850
may work<font color="#E5E5E5"> just fine on on</font><font color="#CCCCCC"> one</font>

418
00:20:16,020 --> 00:20:19,650
infrastructure may work completely

419
00:20:17,850 --> 00:20:21,918
different<font color="#E5E5E5"> on on some other</font>

420
00:20:19,650 --> 00:20:25,020
<font color="#E5E5E5">infrastructure</font>

421
00:20:21,919 --> 00:20:27,179
<font color="#E5E5E5">okay so strategic recommendations coming</font>

422
00:20:25,020 --> 00:20:29,400
<font color="#E5E5E5">from that</font><font color="#CCCCCC"> presentation so first of all</font>

423
00:20:27,179 --> 00:20:33,110
increase<font color="#CCCCCC"> security awareness</font><font color="#E5E5E5"> among</font>

424
00:20:29,400 --> 00:20:35,549
developers and solution architects so

425
00:20:33,110 --> 00:20:39,000
yeah<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think that's quite</font><font color="#E5E5E5"> obvious but</font>

426
00:20:35,549 --> 00:20:41,879
what<font color="#E5E5E5"> is quite important is that if you</font>

427
00:20:39,000 --> 00:20:43,620
<font color="#E5E5E5">are able maybe to to discuss all the</font>

428
00:20:41,880 --> 00:20:45,779
changes with them and discuss<font color="#E5E5E5"> potential</font>

429
00:20:43,620 --> 00:20:47,580
impact they will understand what are

430
00:20:45,779 --> 00:20:50,070
your<font color="#E5E5E5"> concerns and they will somehow help</font>

431
00:20:47,580 --> 00:20:52,379
<font color="#E5E5E5">you with that so obviously you should</font>

432
00:20:50,070 --> 00:20:54,360
review code snippets<font color="#E5E5E5"> if you use some so</font>

433
00:20:52,380 --> 00:20:56,640
if you<font color="#CCCCCC"> have like</font><font color="#E5E5E5"> I don't know some code</font>

434
00:20:54,360 --> 00:20:57,990
repository in your company<font color="#E5E5E5"> so maybe it</font>

435
00:20:56,640 --> 00:20:59,490
would<font color="#CCCCCC"> be</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> to review</font><font color="#E5E5E5"> them for</font>

436
00:20:57,990 --> 00:21:02,399
<font color="#E5E5E5">potential infrastructure related</font>

437
00:20:59,490 --> 00:21:04,200
vulnerabilities<font color="#E5E5E5"> and if you if you find</font>

438
00:21:02,399 --> 00:21:06,928
<font color="#E5E5E5">one maybe it would be good</font><font color="#CCCCCC"> to add</font><font color="#E5E5E5"> some</font>

439
00:21:04,200 --> 00:21:09,510
<font color="#E5E5E5">comments to this to this code in code</font>

440
00:21:06,929 --> 00:21:11,840
repositories<font color="#CCCCCC"> for example that</font><font color="#E5E5E5"> this code</font>

441
00:21:09,510 --> 00:21:16,350
works only<font color="#E5E5E5"> if you have a web proxy</font>

442
00:21:11,840 --> 00:21:22,470
<font color="#E5E5E5">before if you have a proxy server</font><font color="#CCCCCC"> B</font>

443
00:21:16,350 --> 00:21:27,029
between<font color="#E5E5E5"> you and client</font><font color="#CCCCCC"> quite an obvious</font>

444
00:21:22,470 --> 00:21:28,950
one so if<font color="#E5E5E5"> you an</font><font color="#CCCCCC"> some-some let's say dev</font>

445
00:21:27,029 --> 00:21:31,919
ops team<font color="#E5E5E5"> make it def</font>

446
00:21:28,950 --> 00:21:34,350
<font color="#E5E5E5">ops team so you can identify all the</font>

447
00:21:31,919 --> 00:21:37,140
<font color="#E5E5E5">vulnerabilities</font><font color="#CCCCCC"> in the early stage</font><font color="#E5E5E5"> of</font>

448
00:21:34,350 --> 00:21:40,010
<font color="#E5E5E5">the project obviously you should also</font>

449
00:21:37,140 --> 00:21:42,990
perform<font color="#E5E5E5"> a lot of manual security testing</font>

450
00:21:40,010 --> 00:21:46,230
<font color="#E5E5E5">probably it would be it should be</font>

451
00:21:42,990 --> 00:21:50,039
<font color="#E5E5E5">considered to to perform then them in</font>

452
00:21:46,230 --> 00:21:52,289
the let's say let's call<font color="#E5E5E5"> it final</font>

453
00:21:50,039 --> 00:21:55,320
<font color="#E5E5E5">ultimate environment so for example</font>

454
00:21:52,289 --> 00:21:57,450
before<font color="#E5E5E5"> launching some something to to</font>

455
00:21:55,320 --> 00:22:00,270
prod before launching the<font color="#CCCCCC"> application</font>

456
00:21:57,450 --> 00:22:02,370
you should<font color="#E5E5E5"> test that in the on the very</font>

457
00:22:00,270 --> 00:22:03,658
same environment<font color="#E5E5E5"> and if the tests are</font>

458
00:22:02,370 --> 00:22:06,629
successful<font color="#E5E5E5"> you should launch the</font>

459
00:22:03,659 --> 00:22:09,779
application<font color="#E5E5E5"> it's quite easy</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> tell but</font>

460
00:22:06,630 --> 00:22:13,260
easy to<font color="#E5E5E5"> say not</font><font color="#CCCCCC"> that easy to do in</font>

461
00:22:09,779 --> 00:22:15,570
corporate environments<font color="#CCCCCC"> but yeah you</font>

462
00:22:13,260 --> 00:22:17,610
should you should at<font color="#CCCCCC"> least understand</font>

463
00:22:15,570 --> 00:22:20,600
the limitations of<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> and</font>

464
00:22:17,610 --> 00:22:22,918
based<font color="#E5E5E5"> on that</font><font color="#CCCCCC"> take any further decisions</font>

465
00:22:20,600 --> 00:22:25,250
<font color="#E5E5E5">how you should you should proceed</font><font color="#CCCCCC"> with</font>

466
00:22:22,919 --> 00:22:30,650
<font color="#E5E5E5">with</font>

467
00:22:25,250 --> 00:22:33,240
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> that's it from my side so I hope</font>

468
00:22:30,650 --> 00:22:36,179
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you enjoyed the presentation if you</font>

469
00:22:33,240 --> 00:22:38,070
have<font color="#E5E5E5"> just any questions just think now</font>

470
00:22:36,179 --> 00:22:41,870
or<font color="#E5E5E5"> just drop me an email and</font><font color="#CCCCCC"> then</font>

471
00:22:38,070 --> 00:22:41,870
hopefully<font color="#CCCCCC"> I</font><font color="#E5E5E5"> will be able to</font><font color="#CCCCCC"> answer</font><font color="#E5E5E5"> them</font>

