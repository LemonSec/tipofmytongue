1
00:00:09,760 --> 00:00:10,320
and uh

2
00:00:10,320 --> 00:00:13,599
good afternoon everyone uh today i'm

3
00:00:13,599 --> 00:00:14,719
going to take you to

4
00:00:14,719 --> 00:00:17,760
to africa to uncover

5
00:00:17,760 --> 00:00:20,480
some mechanisms of the financially

6
00:00:20,480 --> 00:00:22,480
motivated threat groups that are

7
00:00:22,480 --> 00:00:26,720
operating there to to conduct the cyber

8
00:00:26,720 --> 00:00:28,880
heists

9
00:00:28,880 --> 00:00:31,359
and you may ask why such topic why not

10
00:00:31,359 --> 00:00:32,719
another apt

11
00:00:32,719 --> 00:00:36,399
uh intrusions topic so mainly

12
00:00:36,399 --> 00:00:39,840
uh it was because

13
00:00:39,840 --> 00:00:42,559
when i joined the private sector

14
00:00:42,559 --> 00:00:44,399
actually the international bank

15
00:00:44,399 --> 00:00:47,680
i was challenged by the new new for me

16
00:00:47,680 --> 00:00:50,640
threat landscape

17
00:00:50,800 --> 00:00:54,070
the company i work i work for

18
00:00:54,070 --> 00:00:56,320
[Music]

19
00:00:56,320 --> 00:00:59,440
in many global markets

20
00:00:59,440 --> 00:01:02,480
also africa so i was uh

21
00:01:02,480 --> 00:01:04,400
interested what are the risks what are

22
00:01:04,400 --> 00:01:06,640
the threats uh in africa and i found

23
00:01:06,640 --> 00:01:07,600
this

24
00:01:07,600 --> 00:01:09,360
fascinating for me topic that i would

25
00:01:09,360 --> 00:01:12,400
like to share with you today

26
00:01:12,400 --> 00:01:15,119
so let's go to kenya where most of those

27
00:01:15,119 --> 00:01:16,240
prolific

28
00:01:16,240 --> 00:01:20,240
groups operates and try to

29
00:01:20,240 --> 00:01:23,680
make familiarize with the modus operandi

30
00:01:23,680 --> 00:01:24,960
of those groups

31
00:01:24,960 --> 00:01:28,240
so agenda for today uh

32
00:01:28,240 --> 00:01:30,320
so let's begin with understanding the

33
00:01:30,320 --> 00:01:32,000
african kill chain because this is

34
00:01:32,000 --> 00:01:32,560
something

35
00:01:32,560 --> 00:01:35,439
very unique their their tactics are

36
00:01:35,439 --> 00:01:37,200
quite unique for the region

37
00:01:37,200 --> 00:01:40,640
for the groups that operate there

38
00:01:40,640 --> 00:01:43,840
and later on we'll focus on the threat

39
00:01:43,840 --> 00:01:44,960
landscape

40
00:01:44,960 --> 00:01:49,759
and we'll then try to

41
00:01:49,759 --> 00:01:53,040
learn what differentiate those groups

42
00:01:53,040 --> 00:01:55,520
how can we cluster them because although

43
00:01:55,520 --> 00:01:56,960
there is one common

44
00:01:56,960 --> 00:01:59,759
uh african kill chain those groups also

45
00:01:59,759 --> 00:02:01,759
differentiate from each other and we'll

46
00:02:01,759 --> 00:02:02,880
try to understand

47
00:02:02,880 --> 00:02:05,600
how they how they could be clustered and

48
00:02:05,600 --> 00:02:07,040
also

49
00:02:07,040 --> 00:02:09,840
i will learn something about the history

50
00:02:09,840 --> 00:02:11,920
the history of the development of those

51
00:02:11,920 --> 00:02:12,560
groups

52
00:02:12,560 --> 00:02:15,440
what happened in the past to understand

53
00:02:15,440 --> 00:02:16,720
that the current

54
00:02:16,720 --> 00:02:20,160
threats and lastly third part

55
00:02:20,160 --> 00:02:23,040
would be two case studies that the the

56
00:02:23,040 --> 00:02:24,080
more

57
00:02:24,080 --> 00:02:27,599
focus on the python keyloggers and also

58
00:02:27,599 --> 00:02:29,760
the analysis of capabilities and

59
00:02:29,760 --> 00:02:31,920
infrastructure of one of the

60
00:02:31,920 --> 00:02:34,959
thread groups named grub zone

61
00:02:34,959 --> 00:02:38,400
and here we will look in more

62
00:02:38,400 --> 00:02:42,239
details so uh just few words about

63
00:02:42,239 --> 00:02:45,280
me cuba asked why it

64
00:02:45,280 --> 00:02:47,390
happened how i joined

65
00:02:47,390 --> 00:02:48,840
[Music]

66
00:02:48,840 --> 00:02:52,080
security so like i said i

67
00:02:52,080 --> 00:02:56,000
16 years ago i um i joined the navy

68
00:02:56,000 --> 00:02:58,480
and ended in national cyber security

69
00:02:58,480 --> 00:02:59,280
center

70
00:02:59,280 --> 00:03:02,239
uh poland then i uh left the military

71
00:03:02,239 --> 00:03:03,519
sector joined the private sector and

72
00:03:03,519 --> 00:03:05,200
currently i'm now

73
00:03:05,200 --> 00:03:07,519
uh cyber threat intelligence senior

74
00:03:07,519 --> 00:03:10,400
manager at standard chartered bank

75
00:03:10,400 --> 00:03:13,440
uh i have always been uh

76
00:03:13,440 --> 00:03:17,120
instant response forensic forensic man

77
00:03:17,120 --> 00:03:19,760
but probably you would like to know also

78
00:03:19,760 --> 00:03:21,280
what does it mean to be a threat

79
00:03:21,280 --> 00:03:23,920
intel analyst so actually threat intel

80
00:03:23,920 --> 00:03:25,760
analyst is somebody who

81
00:03:25,760 --> 00:03:28,080
who tries to connect the dots uh

82
00:03:28,080 --> 00:03:29,840
somebody who wants to

83
00:03:29,840 --> 00:03:33,680
to find a pattern track the threads

84
00:03:33,680 --> 00:03:36,400
often it is very similar to to searching

85
00:03:36,400 --> 00:03:38,239
the needle in the haystack and

86
00:03:38,239 --> 00:03:40,080
very often you don't find the needle and

87
00:03:40,080 --> 00:03:41,519
you got lost in the rabbit hole but

88
00:03:41,519 --> 00:03:42,480
sometimes

89
00:03:42,480 --> 00:03:44,799
you can find it you can find the pattern

90
00:03:44,799 --> 00:03:45,680
and

91
00:03:45,680 --> 00:03:48,319
find great satisfaction in tracking

92
00:03:48,319 --> 00:03:48,799
threats

93
00:03:48,799 --> 00:03:52,080
threat groups and often

94
00:03:52,080 --> 00:03:55,519
stopping their operations

95
00:03:55,519 --> 00:03:58,400
so that's that's about me let's focus on

96
00:03:58,400 --> 00:04:00,239
on africa oh

97
00:04:00,239 --> 00:04:03,280
disclaimer that opinions and assessments

98
00:04:03,280 --> 00:04:06,879
presented are slowly my own and

99
00:04:06,879 --> 00:04:10,080
not represent my employer's position

100
00:04:10,080 --> 00:04:12,560
and the investigation the case studies

101
00:04:12,560 --> 00:04:14,319
here are based on the publicly

102
00:04:14,319 --> 00:04:16,798
available data however most of the

103
00:04:16,798 --> 00:04:18,880
samples the clustering of threat groups

104
00:04:18,880 --> 00:04:20,798
and their naming convention is thanks to

105
00:04:20,798 --> 00:04:22,720
on its services and this is a

106
00:04:22,720 --> 00:04:25,199
the company organization that that is

107
00:04:25,199 --> 00:04:26,160
kenya based

108
00:04:26,160 --> 00:04:28,880
and they are really tracking the the

109
00:04:28,880 --> 00:04:30,000
threats

110
00:04:30,000 --> 00:04:32,880
and actually their block was was

111
00:04:32,880 --> 00:04:34,080
inspiration to

112
00:04:34,080 --> 00:04:36,400
do my research and i tried to follow

113
00:04:36,400 --> 00:04:38,080
their blog and many of the

114
00:04:38,080 --> 00:04:40,479
sources from these presentations are

115
00:04:40,479 --> 00:04:41,440
based on their

116
00:04:41,440 --> 00:04:44,639
operations they are not only incident

117
00:04:44,639 --> 00:04:46,720
responses that help the

118
00:04:46,720 --> 00:04:49,840
organization victims in

119
00:04:49,840 --> 00:04:52,800
east africa but they are also conducting

120
00:04:52,800 --> 00:04:54,560
a very unique

121
00:04:54,560 --> 00:04:57,280
government authorized offensive actions

122
00:04:57,280 --> 00:04:57,919
against

123
00:04:57,919 --> 00:05:01,360
against threats this is very fascinating

124
00:05:01,360 --> 00:05:06,000
they they gain many of the samples

125
00:05:06,000 --> 00:05:07,840
of the threat intelligence they gain

126
00:05:07,840 --> 00:05:10,000
from offensive actions

127
00:05:10,000 --> 00:05:13,199
from from their infrastructure

128
00:05:13,199 --> 00:05:16,240
i will have links to their blog here so

129
00:05:16,240 --> 00:05:19,440
and i will recommend generally following

130
00:05:19,440 --> 00:05:20,720
them

131
00:05:20,720 --> 00:05:24,639
a very dangerous job also because

132
00:05:24,639 --> 00:05:27,280
they operate there in the region they

133
00:05:27,280 --> 00:05:28,240
are tracking

134
00:05:28,240 --> 00:05:32,160
and fighting the groups uh there so

135
00:05:32,160 --> 00:05:34,720
in this in this case this is a very

136
00:05:34,720 --> 00:05:37,440
dangerous job it's not like analyzing

137
00:05:37,440 --> 00:05:39,919
very distant threats and publishing

138
00:05:39,919 --> 00:05:40,880
information

139
00:05:40,880 --> 00:05:43,600
uh about them revealing their operations

140
00:05:43,600 --> 00:05:45,520
stopping their operations

141
00:05:45,520 --> 00:05:48,720
and those guys really risk but they

142
00:05:48,720 --> 00:05:52,639
they do really good job there

143
00:05:52,639 --> 00:05:55,120
so let's go and try to understand the

144
00:05:55,120 --> 00:05:56,400
african

145
00:05:56,400 --> 00:05:59,840
kill chain what is so unique about this

146
00:05:59,840 --> 00:06:01,039
skill chain

147
00:06:01,039 --> 00:06:04,319
and we need to understand that they use

148
00:06:04,319 --> 00:06:07,600
use a lot of the insiders and usually

149
00:06:07,600 --> 00:06:08,400
the initial

150
00:06:08,400 --> 00:06:10,880
access to the victim organization is

151
00:06:10,880 --> 00:06:11,840
done

152
00:06:11,840 --> 00:06:15,280
via the the rock device so

153
00:06:15,280 --> 00:06:17,280
the insider for example a bright

154
00:06:17,280 --> 00:06:19,520
personal um

155
00:06:19,520 --> 00:06:22,560
that disgruntled employee is trained

156
00:06:22,560 --> 00:06:23,840
instructed to

157
00:06:23,840 --> 00:06:27,520
to take special laptop and to attach it

158
00:06:27,520 --> 00:06:29,199
to the network of the victim

159
00:06:29,199 --> 00:06:31,360
and usually this is how most of the

160
00:06:31,360 --> 00:06:33,600
intrusions in

161
00:06:33,600 --> 00:06:39,280
begin so uh in comparison to the

162
00:06:39,280 --> 00:06:41,759
other cyber intrusions that happen

163
00:06:41,759 --> 00:06:42,720
worldw

164
00:06:42,720 --> 00:06:44,800
in the world for example when we compare

165
00:06:44,800 --> 00:06:45,759
to apt

166
00:06:45,759 --> 00:06:49,280
intrusions which usually start with the

167
00:06:49,280 --> 00:06:52,000
spear fishing phishing males sometimes

168
00:06:52,000 --> 00:06:54,160
there are very wide campaigns

169
00:06:54,160 --> 00:06:57,039
uh and trying to to find opportunistic

170
00:06:57,039 --> 00:06:58,000
victim

171
00:06:58,000 --> 00:07:00,080
in this case then the intrusions are

172
00:07:00,080 --> 00:07:02,400
very targeted so the insiders

173
00:07:02,400 --> 00:07:05,759
are instructed that the whole gang

174
00:07:05,759 --> 00:07:08,639
the whole group is focused on on for

175
00:07:08,639 --> 00:07:11,120
example one target

176
00:07:11,120 --> 00:07:14,720
and um yeah and the

177
00:07:14,720 --> 00:07:17,919
initial access uh you can also find the

178
00:07:17,919 --> 00:07:19,039
mitral attack

179
00:07:19,039 --> 00:07:22,240
uh technique for that in the tactic

180
00:07:22,240 --> 00:07:25,520
initial access there is a tactic

181
00:07:25,520 --> 00:07:28,639
technique called hardware additions and

182
00:07:28,639 --> 00:07:29,520
if you open a

183
00:07:29,520 --> 00:07:31,280
mitral attack framework there's only one

184
00:07:31,280 --> 00:07:33,759
example of a threat group that uses

185
00:07:33,759 --> 00:07:36,479
that kind of a technique this also means

186
00:07:36,479 --> 00:07:36,960
that

187
00:07:36,960 --> 00:07:38,880
even in mitral attack there are not many

188
00:07:38,880 --> 00:07:40,639
examples of

189
00:07:40,639 --> 00:07:44,479
groups threat groups that use such

190
00:07:44,479 --> 00:07:47,520
methods to to access their victim

191
00:07:47,520 --> 00:07:50,639
in in the case of mitral attack it is a

192
00:07:50,639 --> 00:07:53,680
dark vishnu group which is an um

193
00:07:53,680 --> 00:07:55,360
eastern european actor that's

194
00:07:55,360 --> 00:07:57,440
financially motivated that

195
00:07:57,440 --> 00:08:00,000
that hit at least eight financial

196
00:08:00,000 --> 00:08:01,280
institutions

197
00:08:01,280 --> 00:08:05,039
in the years 2017-18

198
00:08:05,039 --> 00:08:07,919
and and that's all that that's only one

199
00:08:07,919 --> 00:08:08,560
example

200
00:08:08,560 --> 00:08:11,840
so it's not very popular and if you

201
00:08:11,840 --> 00:08:12,560
remember

202
00:08:12,560 --> 00:08:15,039
presentations from day one from from

203
00:08:15,039 --> 00:08:17,199
yakupat mache very very interesting

204
00:08:17,199 --> 00:08:19,199
presentations about

205
00:08:19,199 --> 00:08:23,039
their physical penetration tests

206
00:08:23,039 --> 00:08:26,560
you may see that those examples and

207
00:08:26,560 --> 00:08:27,039
those

208
00:08:27,039 --> 00:08:30,160
tests are not very uh far from from

209
00:08:30,160 --> 00:08:32,719
reality maybe they are not that popular

210
00:08:32,719 --> 00:08:34,559
but for example if you're a financial

211
00:08:34,559 --> 00:08:36,880
institution and you are operating in

212
00:08:36,880 --> 00:08:37,839
africa

213
00:08:37,839 --> 00:08:39,760
you definitely should take under

214
00:08:39,760 --> 00:08:42,240
consideration the physical security the

215
00:08:42,240 --> 00:08:43,679
insider threat

216
00:08:43,679 --> 00:08:47,839
and um and focus on so all that so

217
00:08:47,839 --> 00:08:50,000
initial foothold is the rogue device for

218
00:08:50,000 --> 00:08:52,160
example laptop hidden somewhere could be

219
00:08:52,160 --> 00:08:53,040
even

220
00:08:53,040 --> 00:08:55,680
hidden in the server room there were

221
00:08:55,680 --> 00:08:57,519
such cases

222
00:08:57,519 --> 00:09:00,160
so probably you're interested what's

223
00:09:00,160 --> 00:09:02,160
specific about

224
00:09:02,160 --> 00:09:06,160
this laptop so usually those laptops

225
00:09:06,160 --> 00:09:09,040
are windows operating uh have windows

226
00:09:09,040 --> 00:09:10,000
operating system

227
00:09:10,000 --> 00:09:14,080
installed on um so nothing original

228
00:09:14,080 --> 00:09:16,480
but they also have the commercial of the

229
00:09:16,480 --> 00:09:17,440
shell

230
00:09:17,440 --> 00:09:19,839
remote access tools installed and you

231
00:09:19,839 --> 00:09:22,399
can see that the icons here on the slide

232
00:09:22,399 --> 00:09:24,320
that they installed go to my pc

233
00:09:24,320 --> 00:09:26,160
teamviewer any desks

234
00:09:26,160 --> 00:09:30,160
so the graphical tools to to control

235
00:09:30,160 --> 00:09:32,720
the computer remotely so very easy to

236
00:09:32,720 --> 00:09:34,560
operate

237
00:09:34,560 --> 00:09:38,080
and the and the insiders are trained to

238
00:09:38,080 --> 00:09:40,240
uh to how to troubleshoot them how to

239
00:09:40,240 --> 00:09:42,480
connect them so very basic

240
00:09:42,480 --> 00:09:46,399
steps um how to operate those laptops

241
00:09:46,399 --> 00:09:50,480
and also those laptops uh have

242
00:09:50,480 --> 00:09:53,279
suspend hibernation disabled so they are

243
00:09:53,279 --> 00:09:55,040
operating all the time

244
00:09:55,040 --> 00:09:58,160
usually they have double

245
00:09:58,160 --> 00:10:00,480
network access so they have their

246
00:10:00,480 --> 00:10:01,360
internet

247
00:10:01,360 --> 00:10:03,440
connectivity for example they connect

248
00:10:03,440 --> 00:10:04,959
they are connected to guest

249
00:10:04,959 --> 00:10:08,000
wi-fi or they have their

250
00:10:08,000 --> 00:10:10,720
internet modem and with the second lag

251
00:10:10,720 --> 00:10:12,720
they are connected to the internal

252
00:10:12,720 --> 00:10:16,000
network so that so the group is already

253
00:10:16,000 --> 00:10:17,519
in

254
00:10:17,519 --> 00:10:21,040
what happens later later they begin to

255
00:10:21,040 --> 00:10:22,399
move laterally

256
00:10:22,399 --> 00:10:25,040
they other tools that are installed on

257
00:10:25,040 --> 00:10:26,399
such a laptop

258
00:10:26,399 --> 00:10:29,760
are for example ip scanners graphical

259
00:10:29,760 --> 00:10:32,800
mode scanners they often use

260
00:10:32,800 --> 00:10:35,600
offensive security tools like like

261
00:10:35,600 --> 00:10:37,760
bloodhounds or

262
00:10:37,760 --> 00:10:42,160
cme toolkits of crack map exec toolkit

263
00:10:42,160 --> 00:10:45,440
for for finding

264
00:10:45,440 --> 00:10:47,760
weaknesses in active directory

265
00:10:47,760 --> 00:10:48,959
environments

266
00:10:48,959 --> 00:10:51,760
and of course when they when they gather

267
00:10:51,760 --> 00:10:52,399
for example

268
00:10:52,399 --> 00:10:55,120
i don't know brute forcing passwords or

269
00:10:55,120 --> 00:10:56,399
kerberos thing

270
00:10:56,399 --> 00:10:59,120
when they when they get credentials they

271
00:10:59,120 --> 00:11:00,959
start to move laterally

272
00:11:00,959 --> 00:11:04,160
how of course they they they do

273
00:11:04,160 --> 00:11:06,880
lateral movement over smb with the use

274
00:11:06,880 --> 00:11:07,920
of old good

275
00:11:07,920 --> 00:11:11,120
ps exec so in that case they do not

276
00:11:11,120 --> 00:11:12,240
differ from

277
00:11:12,240 --> 00:11:15,920
uh even the most prolific apt groups

278
00:11:15,920 --> 00:11:16,399
that

279
00:11:16,399 --> 00:11:19,760
that also use ps exec for for such

280
00:11:19,760 --> 00:11:23,279
purposes and later on something which is

281
00:11:23,279 --> 00:11:25,839
very unique to african threat groups

282
00:11:25,839 --> 00:11:28,079
is that key logging they use they very

283
00:11:28,079 --> 00:11:29,600
often use the

284
00:11:29,600 --> 00:11:33,279
the python keyloggers which were

285
00:11:33,279 --> 00:11:36,320
compiled to windows binary by pi

286
00:11:36,320 --> 00:11:37,519
installer

287
00:11:37,519 --> 00:11:40,240
and i use here the citation by phineas

288
00:11:40,240 --> 00:11:41,200
fisher so

289
00:11:41,200 --> 00:11:44,240
another threat actor from his memo after

290
00:11:44,240 --> 00:11:44,959
he hit

291
00:11:44,959 --> 00:11:49,040
the the hacking team that in reality

292
00:11:49,040 --> 00:11:51,440
the mimikats and keyloggers view all

293
00:11:51,440 --> 00:11:52,160
passwords

294
00:11:52,160 --> 00:11:55,200
equally so they do not usually dump the

295
00:11:55,200 --> 00:11:56,000
passwords with

296
00:11:56,000 --> 00:11:58,000
any tools they use the keyloggers they

297
00:11:58,000 --> 00:11:59,760
install them and we'll focus

298
00:11:59,760 --> 00:12:04,240
on the analysis of the keyloggers in our

299
00:12:04,240 --> 00:12:08,639
case case studies section

300
00:12:08,880 --> 00:12:12,240
and a little bit of history so in 2014

301
00:12:12,240 --> 00:12:14,399
that there was a fork bomb cartel

302
00:12:14,399 --> 00:12:16,720
created in casarani casarani is a kind

303
00:12:16,720 --> 00:12:17,519
of a

304
00:12:17,519 --> 00:12:20,800
ghetto area in uh in nairobi

305
00:12:20,800 --> 00:12:22,800
and also called the cyber criminal

306
00:12:22,800 --> 00:12:26,000
silicon valley and there are lots of

307
00:12:26,000 --> 00:12:31,519
criminals from nigeria from south africa

308
00:12:31,519 --> 00:12:34,959
that's where they recruit money mules

309
00:12:34,959 --> 00:12:38,320
and and people to the gang um

310
00:12:38,320 --> 00:12:41,279
and it was it happened in 2014 what is

311
00:12:41,279 --> 00:12:42,880
very important

312
00:12:42,880 --> 00:12:45,600
it was created by by a man who was a

313
00:12:45,600 --> 00:12:47,440
former policeman and

314
00:12:47,440 --> 00:12:49,760
and that fact is is quite is quite

315
00:12:49,760 --> 00:12:50,480
interesting

316
00:12:50,480 --> 00:12:52,480
and important because many of those

317
00:12:52,480 --> 00:12:54,639
heists and many of those groups

318
00:12:54,639 --> 00:12:57,200
are supported by the corrupted uh

319
00:12:57,200 --> 00:12:58,560
politicians

320
00:12:58,560 --> 00:13:01,120
by by the governors they're they are

321
00:13:01,120 --> 00:13:03,519
also supported by the corrupted

322
00:13:03,519 --> 00:13:06,639
uh policemen so that's why it is

323
00:13:06,639 --> 00:13:10,639
also very hard for defenders

324
00:13:10,639 --> 00:13:14,079
to to operate against them and they

325
00:13:14,079 --> 00:13:15,600
really risk uh

326
00:13:15,600 --> 00:13:18,800
the their lies because those gangs are

327
00:13:18,800 --> 00:13:20,160
not only

328
00:13:20,160 --> 00:13:23,200
operating in in cyberspace but

329
00:13:23,200 --> 00:13:25,600
they also kill people in in the physical

330
00:13:25,600 --> 00:13:27,279
world

331
00:13:27,279 --> 00:13:29,760
for example money meals who are not

332
00:13:29,760 --> 00:13:32,639
bringing the money

333
00:13:32,959 --> 00:13:37,120
so let's use the diamond model

334
00:13:37,120 --> 00:13:40,880
to to analyze the features of such

335
00:13:40,880 --> 00:13:44,160
um of such group and i divided here

336
00:13:44,160 --> 00:13:46,959
that the fork bomba cartel into those

337
00:13:46,959 --> 00:13:48,000
diamond model features

338
00:13:48,000 --> 00:13:50,399
so it was an east africa gang uh formed

339
00:13:50,399 --> 00:13:51,360
by the uh

340
00:13:51,360 --> 00:13:54,480
policeman consisted of of

341
00:13:54,480 --> 00:13:57,600
many of the of the smaller teams so

342
00:13:57,600 --> 00:13:59,839
it became a kind of a cartel big

343
00:13:59,839 --> 00:14:01,120
organization

344
00:14:01,120 --> 00:14:04,639
and their capabilities they use

345
00:14:04,639 --> 00:14:08,000
many of the commercial tools for remote

346
00:14:08,000 --> 00:14:10,399
access control like teamviewer go to my

347
00:14:10,399 --> 00:14:11,440
pc

348
00:14:11,440 --> 00:14:15,360
but also the open source tools

349
00:14:15,360 --> 00:14:18,320
for offensive security like metasploit

350
00:14:18,320 --> 00:14:20,079
ps empire

351
00:14:20,079 --> 00:14:23,199
and another open source project like

352
00:14:23,199 --> 00:14:24,959
quasar rat which is available at

353
00:14:24,959 --> 00:14:28,480
uh at the github cduq is is not that

354
00:14:28,480 --> 00:14:31,760
that background from apt 29 but it is a

355
00:14:31,760 --> 00:14:33,920
kind of a python backdoor

356
00:14:33,920 --> 00:14:37,279
compiled by pi installer to to windows

357
00:14:37,279 --> 00:14:39,760
executable of course they use the python

358
00:14:39,760 --> 00:14:40,959
key loggers

359
00:14:40,959 --> 00:14:43,680
and the whole history if you analyze the

360
00:14:43,680 --> 00:14:45,360
history of keyloggers

361
00:14:45,360 --> 00:14:47,440
goes back to the fork bombo cartel

362
00:14:47,440 --> 00:14:48,560
keylogger we'll

363
00:14:48,560 --> 00:14:51,760
analyze it later they used insiders

364
00:14:51,760 --> 00:14:55,680
very often ict personnel with access to

365
00:14:55,680 --> 00:14:59,839
network and

366
00:15:00,079 --> 00:15:03,839
and critical assets

367
00:15:03,839 --> 00:15:06,399
for infrastructure they also they used

368
00:15:06,399 --> 00:15:07,360
for example

369
00:15:07,360 --> 00:15:10,399
gmail for key logging they executed that

370
00:15:10,399 --> 00:15:13,360
the locked key keystrokes to to gmail

371
00:15:13,360 --> 00:15:14,399
and they targeted

372
00:15:14,399 --> 00:15:16,720
banks sakos so save and credit

373
00:15:16,720 --> 00:15:17,920
organizations and

374
00:15:17,920 --> 00:15:20,160
other financial institutions and they

375
00:15:20,160 --> 00:15:21,680
were very prolific

376
00:15:21,680 --> 00:15:26,079
they still um millions of uh

377
00:15:26,079 --> 00:15:30,959
of dollars later on in 2017 this group

378
00:15:30,959 --> 00:15:34,800
uh was partly uh

379
00:15:34,800 --> 00:15:38,079
arrested um and divided into smaller

380
00:15:38,079 --> 00:15:38,639
groups

381
00:15:38,639 --> 00:15:41,440
that the cartel divided into smaller

382
00:15:41,440 --> 00:15:42,880
fork bomber group

383
00:15:42,880 --> 00:15:46,560
but but also other organizations like

384
00:15:46,560 --> 00:15:49,279
silent cards grub zone the doctors

385
00:15:49,279 --> 00:15:50,639
telecode and

386
00:15:50,639 --> 00:15:53,199
some of those groups cooperate with each

387
00:15:53,199 --> 00:15:55,360
other and some of them

388
00:15:55,360 --> 00:15:59,839
fight each other and

389
00:15:59,839 --> 00:16:03,519
later on the the fork bomb cartel

390
00:16:03,519 --> 00:16:07,040
and turned for example into the grub

391
00:16:07,040 --> 00:16:08,399
zone and

392
00:16:08,399 --> 00:16:11,279
later on one year later after the arrest

393
00:16:11,279 --> 00:16:12,240
of the

394
00:16:12,240 --> 00:16:15,199
majority of fork bomb cartel they

395
00:16:15,199 --> 00:16:17,680
connected with the old money mule

396
00:16:17,680 --> 00:16:20,240
money mules to to form the fork bomb

397
00:16:20,240 --> 00:16:21,040
group so

398
00:16:21,040 --> 00:16:25,440
those groups are not very stable

399
00:16:25,440 --> 00:16:28,720
they change they they mix but for

400
00:16:28,720 --> 00:16:29,600
example

401
00:16:29,600 --> 00:16:32,240
grab zone do not cooperate with the

402
00:16:32,240 --> 00:16:33,120
group

403
00:16:33,120 --> 00:16:37,360
silent cards and silent cars in 2019

404
00:16:37,360 --> 00:16:39,600
they divided into the consultants and

405
00:16:39,600 --> 00:16:41,680
the rural shepherds and for example

406
00:16:41,680 --> 00:16:44,160
consultants do not cooperate

407
00:16:44,160 --> 00:16:47,199
with grab zone however rural shepherds

408
00:16:47,199 --> 00:16:50,480
cooperate with them and

409
00:16:50,480 --> 00:16:52,959
fork bomb group was terminated at the

410
00:16:52,959 --> 00:16:55,040
end of 2019

411
00:16:55,040 --> 00:16:58,240
uh in rwanda and then they organized

412
00:16:58,240 --> 00:17:01,519
um big highs they tried to target the

413
00:17:01,519 --> 00:17:04,079
one of the biggest banks in east and

414
00:17:04,079 --> 00:17:05,439
central

415
00:17:05,439 --> 00:17:09,679
africa and even some members of the

416
00:17:09,679 --> 00:17:11,039
ruiru shepherds

417
00:17:11,039 --> 00:17:12,799
were with them and they were also

418
00:17:12,799 --> 00:17:14,640
arrested

419
00:17:14,640 --> 00:17:17,679
during this heist to

420
00:17:17,679 --> 00:17:20,240
uh it was very successful operation for

421
00:17:20,240 --> 00:17:20,880
the

422
00:17:20,880 --> 00:17:22,799
for those good cops and for the

423
00:17:22,799 --> 00:17:24,959
defenders tracking those

424
00:17:24,959 --> 00:17:30,840
uh threats and how does it look in

425
00:17:30,840 --> 00:17:33,120
2020 so

426
00:17:33,120 --> 00:17:36,960
nothing is static those groups like

427
00:17:36,960 --> 00:17:39,440
grabs on consultants they are regrouping

428
00:17:39,440 --> 00:17:41,520
maybe we'll see that they will split

429
00:17:41,520 --> 00:17:45,200
or maybe merge their capabilities and

430
00:17:45,200 --> 00:17:47,039
are still the doctors there are still

431
00:17:47,039 --> 00:17:49,120
silent cards telecom team

432
00:17:49,120 --> 00:17:51,600
but this is the east africa threat

433
00:17:51,600 --> 00:17:52,880
landscape

434
00:17:52,880 --> 00:17:55,520
and for example from west africa we have

435
00:17:55,520 --> 00:17:57,520
the group corzetta which is also

436
00:17:57,520 --> 00:18:00,799
interesting because there are some links

437
00:18:00,799 --> 00:18:03,520
uh showing that there could be some

438
00:18:03,520 --> 00:18:05,520
cooperation with the

439
00:18:05,520 --> 00:18:10,720
big uh cyber threat like ta 505

440
00:18:10,720 --> 00:18:12,799
so the group that targets many

441
00:18:12,799 --> 00:18:14,559
organizations across the world

442
00:18:14,559 --> 00:18:17,919
not not connected with the region

443
00:18:17,919 --> 00:18:19,679
so this is also another topic that could

444
00:18:19,679 --> 00:18:22,000
be very interesting to research and to

445
00:18:22,000 --> 00:18:24,960
and to analyze

446
00:18:25,520 --> 00:18:28,320
and this was a history so if we would

447
00:18:28,320 --> 00:18:30,000
like to cluster the groups

448
00:18:30,000 --> 00:18:32,000
uh let's look for example about the

449
00:18:32,000 --> 00:18:33,280
silent cars and

450
00:18:33,280 --> 00:18:36,559
and their features so this is quite big

451
00:18:36,559 --> 00:18:39,919
big big gang

452
00:18:39,919 --> 00:18:42,640
and lots of the members like the corps

453
00:18:42,640 --> 00:18:43,919
members for example

454
00:18:43,919 --> 00:18:48,160
like about 20 and they also use go to pc

455
00:18:48,160 --> 00:18:51,120
any pc remote assistance but they use

456
00:18:51,120 --> 00:18:52,240
the cduke

457
00:18:52,240 --> 00:18:53,840
so that so the back they're used

458
00:18:53,840 --> 00:18:55,440
formally by the fork bomb

459
00:18:55,440 --> 00:18:57,120
from the keyloggers they use something

460
00:18:57,120 --> 00:18:58,960
called land cruiser

461
00:18:58,960 --> 00:19:01,280
they use insiders but they use anyone

462
00:19:01,280 --> 00:19:04,400
with access could be also a janitor

463
00:19:04,400 --> 00:19:07,120
they have very fast operational tempo so

464
00:19:07,120 --> 00:19:08,480
when they enter they

465
00:19:08,480 --> 00:19:11,840
they quickly uh performed the

466
00:19:11,840 --> 00:19:15,679
the the initial withdrawal of the

467
00:19:15,679 --> 00:19:18,880
of the funds for the infrastructure they

468
00:19:18,880 --> 00:19:19,919
used

469
00:19:19,919 --> 00:19:22,400
cloud services a lot for example gmail

470
00:19:22,400 --> 00:19:23,039
ftp

471
00:19:23,039 --> 00:19:25,919
drive hq and they have quite wide

472
00:19:25,919 --> 00:19:28,320
targeting they even target hospitals

473
00:19:28,320 --> 00:19:32,080
insurance so not only financial

474
00:19:32,080 --> 00:19:33,120
institutions

475
00:19:33,120 --> 00:19:35,200
and they have potential to attack

476
00:19:35,200 --> 00:19:37,200
several victim organizations

477
00:19:37,200 --> 00:19:39,360
at one time so sometimes they do not

478
00:19:39,360 --> 00:19:42,160
only focus on one victim

479
00:19:42,160 --> 00:19:45,760
the consumption consultants are

480
00:19:45,760 --> 00:19:49,679
also quite unique for example they use

481
00:19:49,679 --> 00:19:53,520
another commercial of the shell

482
00:19:53,520 --> 00:19:55,840
tool to control this hidden laptop they

483
00:19:55,840 --> 00:19:57,919
use w agent

484
00:19:57,919 --> 00:20:00,640
and they use python keylogger called

485
00:20:00,640 --> 00:20:01,919
coco logger

486
00:20:01,919 --> 00:20:04,480
and for infrastructure of course this is

487
00:20:04,480 --> 00:20:06,080
the infrastructure

488
00:20:06,080 --> 00:20:10,400
related to w agent and apart from banks

489
00:20:10,400 --> 00:20:14,400
cycles and they also target

490
00:20:14,400 --> 00:20:17,760
the creditors and grab zone

491
00:20:17,760 --> 00:20:19,760
and in general they use different

492
00:20:19,760 --> 00:20:21,520
vectors they experiment they use

493
00:20:21,520 --> 00:20:24,960
metal preterm caesar red which is also

494
00:20:24,960 --> 00:20:28,400
open source ps empire so they try to use

495
00:20:28,400 --> 00:20:30,240
different capabilities

496
00:20:30,240 --> 00:20:33,760
uh they use of course commercial rats

497
00:20:33,760 --> 00:20:38,720
like any desks rod sim bot a lot of them

498
00:20:38,720 --> 00:20:41,120
probably because they want to experiment

499
00:20:41,120 --> 00:20:42,799
with

500
00:20:42,799 --> 00:20:45,039
antivirus detections and they want to

501
00:20:45,039 --> 00:20:46,640
try something new

502
00:20:46,640 --> 00:20:50,000
that has very low uh antivirus detection

503
00:20:50,000 --> 00:20:51,200
and that's why they change

504
00:20:51,200 --> 00:20:54,400
all those tools and

505
00:20:54,400 --> 00:20:56,960
for keylogger for example they use hail

506
00:20:56,960 --> 00:20:57,679
mary

507
00:20:57,679 --> 00:21:00,480
which again is very similar to the

508
00:21:00,480 --> 00:21:01,360
keylogger

509
00:21:01,360 --> 00:21:03,600
that was invented written invented by

510
00:21:03,600 --> 00:21:05,840
the fork bomb

511
00:21:05,840 --> 00:21:08,960
and they also attack quite widely

512
00:21:08,960 --> 00:21:11,760
and let's go to the first case study

513
00:21:11,760 --> 00:21:12,720
about the

514
00:21:12,720 --> 00:21:16,480
python keyloggers

515
00:21:16,480 --> 00:21:19,520
they have one origin like i

516
00:21:19,520 --> 00:21:22,720
mentioned before and if you look at the

517
00:21:22,720 --> 00:21:23,840
main

518
00:21:23,840 --> 00:21:26,240
function in this source code of this

519
00:21:26,240 --> 00:21:28,320
python keylogger

520
00:21:28,320 --> 00:21:30,799
you will see the main logic the main

521
00:21:30,799 --> 00:21:32,880
engine of uh for the keylogger

522
00:21:32,880 --> 00:21:35,280
and this is a part that was probably

523
00:21:35,280 --> 00:21:36,720
copied years ago

524
00:21:36,720 --> 00:21:39,200
from any of from from the forum even the

525
00:21:39,200 --> 00:21:40,480
variables were not

526
00:21:40,480 --> 00:21:45,520
changed so that so the uh variable hm

527
00:21:45,520 --> 00:21:47,919
for hook manager is is not changed and

528
00:21:47,919 --> 00:21:49,600
this part actually

529
00:21:49,600 --> 00:21:53,280
um reoccurs in every

530
00:21:53,280 --> 00:21:56,720
uh python key logger of

531
00:21:56,720 --> 00:21:59,280
from different thread actor from

532
00:21:59,280 --> 00:21:59,760
different

533
00:21:59,760 --> 00:22:02,640
aft group

534
00:22:04,000 --> 00:22:07,200
so um this is also

535
00:22:07,200 --> 00:22:10,559
part of the code that is repetitive

536
00:22:10,559 --> 00:22:13,760
and for example you can see that they

537
00:22:13,760 --> 00:22:15,120
try to get out the

538
00:22:15,120 --> 00:22:18,240
environment variable for user name

539
00:22:18,240 --> 00:22:22,000
and then later on this username is used

540
00:22:22,000 --> 00:22:23,039
as a

541
00:22:23,039 --> 00:22:26,960
file name where the keystrokes are being

542
00:22:26,960 --> 00:22:27,760
locked

543
00:22:27,760 --> 00:22:30,960
and this is also very uh common across

544
00:22:30,960 --> 00:22:31,919
those

545
00:22:31,919 --> 00:22:35,440
um keyloggers in the comments section

546
00:22:35,440 --> 00:22:36,640
you can see

547
00:22:36,640 --> 00:22:39,360
that previously the fork bomb group and

548
00:22:39,360 --> 00:22:40,240
here you can

549
00:22:40,240 --> 00:22:43,120
you can now learn why this group is

550
00:22:43,120 --> 00:22:43,679
named

551
00:22:43,679 --> 00:22:46,880
for bombo because that that was the name

552
00:22:46,880 --> 00:22:50,080
of the of the accounts and gmail

553
00:22:50,080 --> 00:22:50,960
accounts for

554
00:22:50,960 --> 00:22:52,840
for that group so they used to

555
00:22:52,840 --> 00:22:54,240
exfiltrate

556
00:22:54,240 --> 00:22:57,280
the keystrokes to gmail

557
00:22:57,280 --> 00:23:02,559
now they usually keep them

558
00:23:02,559 --> 00:23:05,280
on the machine on the victim machine and

559
00:23:05,280 --> 00:23:06,960
they exfiltrate them

560
00:23:06,960 --> 00:23:09,520
those archives over the command control

561
00:23:09,520 --> 00:23:11,918
channel

562
00:23:13,200 --> 00:23:16,640
here you can see that the differences

563
00:23:16,640 --> 00:23:19,440
between the python keyloggers of the

564
00:23:19,440 --> 00:23:20,559
consultants

565
00:23:20,559 --> 00:23:22,960
and and the silent cards and you can see

566
00:23:22,960 --> 00:23:23,600
that there are

567
00:23:23,600 --> 00:23:26,159
quite a lot of similarities sometimes

568
00:23:26,159 --> 00:23:27,120
they differ

569
00:23:27,120 --> 00:23:30,240
with uh with some imports uh some have

570
00:23:30,240 --> 00:23:32,960
some commented sections to

571
00:23:32,960 --> 00:23:36,799
to include binary libraries with ftp

572
00:23:36,799 --> 00:23:42,240
and to base64 encode some of the parts

573
00:23:42,240 --> 00:23:44,799
the consultants here you can see that

574
00:23:44,799 --> 00:23:45,919
they use

575
00:23:45,919 --> 00:23:48,400
this naming convention that they name

576
00:23:48,400 --> 00:23:50,799
the archive after the username

577
00:23:50,799 --> 00:23:54,400
so the victim user name

578
00:23:54,400 --> 00:23:57,600
however you can also see that the way

579
00:23:57,600 --> 00:23:58,000
they

580
00:23:58,000 --> 00:24:01,360
create the log even the

581
00:24:01,360 --> 00:24:04,480
dividing sections is the same so there

582
00:24:04,480 --> 00:24:04,880
are

583
00:24:04,880 --> 00:24:07,360
often very slight differences between

584
00:24:07,360 --> 00:24:08,000
the

585
00:24:08,000 --> 00:24:11,039
keynoters of different groups

586
00:24:11,039 --> 00:24:14,400
but here i gathered some common

587
00:24:14,400 --> 00:24:15,279
artifacts

588
00:24:15,279 --> 00:24:18,720
of fat keyloggers so usually

589
00:24:18,720 --> 00:24:20,799
they are the python scripts that are

590
00:24:20,799 --> 00:24:22,080
compiled to

591
00:24:22,080 --> 00:24:24,559
dot exist on the windows executable by

592
00:24:24,559 --> 00:24:26,559
by the pi installer so when you use pi

593
00:24:26,559 --> 00:24:27,760
installer

594
00:24:27,760 --> 00:24:30,799
for that usually the file size is about

595
00:24:30,799 --> 00:24:33,039
five megabytes so they are not small

596
00:24:33,039 --> 00:24:34,320
files

597
00:24:34,320 --> 00:24:36,960
uh in comparison to the the

598
00:24:36,960 --> 00:24:38,480
functionality

599
00:24:38,480 --> 00:24:41,279
the file names are masquerading known

600
00:24:41,279 --> 00:24:42,559
software for example

601
00:24:42,559 --> 00:24:46,320
onenote or adobe or java and

602
00:24:46,320 --> 00:24:49,600
sometimes they have also the the icon

603
00:24:49,600 --> 00:24:52,640
so the e if

604
00:24:52,640 --> 00:24:57,120
if there is a keylogger named java.xc it

605
00:24:57,120 --> 00:24:58,720
usually has the java

606
00:24:58,720 --> 00:25:01,760
icon they are usually located in program

607
00:25:01,760 --> 00:25:02,640
data

608
00:25:02,640 --> 00:25:05,120
so the key loggers and the logs are

609
00:25:05,120 --> 00:25:05,760
saved to

610
00:25:05,760 --> 00:25:08,960
program data user profiles all

611
00:25:08,960 --> 00:25:12,000
user profiles and this is also

612
00:25:12,000 --> 00:25:15,440
quite good thread hunting rule that

613
00:25:15,440 --> 00:25:19,200
it's very wise to look to hunt for files

614
00:25:19,200 --> 00:25:21,840
that are created in those locations

615
00:25:21,840 --> 00:25:25,520
because typically uh on a clean system

616
00:25:25,520 --> 00:25:28,080
there should not be any of the files

617
00:25:28,080 --> 00:25:30,000
there are mainly

618
00:25:30,000 --> 00:25:33,679
locations where folders are

619
00:25:33,679 --> 00:25:36,880
created not single files

620
00:25:36,880 --> 00:25:40,080
but very often adversaries you

621
00:25:40,080 --> 00:25:43,120
use those locations to to to have a

622
00:25:43,120 --> 00:25:44,000
staging

623
00:25:44,000 --> 00:25:46,880
area for their files before exfiltration

624
00:25:46,880 --> 00:25:47,600
and it's

625
00:25:47,600 --> 00:25:49,679
quite wise to to create for example

626
00:25:49,679 --> 00:25:51,440
thread hunting rules on your

627
00:25:51,440 --> 00:25:55,360
edr system or av system to hunt for any

628
00:25:55,360 --> 00:25:56,000
new files

629
00:25:56,000 --> 00:25:59,600
created there and for example

630
00:25:59,600 --> 00:26:02,880
uh different groups across across time

631
00:26:02,880 --> 00:26:03,840
they used

632
00:26:03,840 --> 00:26:06,480
file names based on username but with

633
00:26:06,480 --> 00:26:08,080
different extensions like

634
00:26:08,080 --> 00:26:10,960
tar ini

635
00:26:11,520 --> 00:26:14,799
uh they changed by mainly were connected

636
00:26:14,799 --> 00:26:16,000
with some

637
00:26:16,000 --> 00:26:20,720
uh archive files and the persistence

638
00:26:20,720 --> 00:26:21,919
there is

639
00:26:21,919 --> 00:26:25,120
the persistence very simple persistence

640
00:26:25,120 --> 00:26:27,919
uh that's created by the rankings of the

641
00:26:27,919 --> 00:26:29,760
um

642
00:26:29,760 --> 00:26:32,799
registry persistence the simplest way

643
00:26:32,799 --> 00:26:34,320
the simplest technique for

644
00:26:34,320 --> 00:26:39,039
for that was was used before

645
00:26:39,039 --> 00:26:41,039
is there a possibility to create yara

646
00:26:41,039 --> 00:26:43,440
for the date for detecting such python

647
00:26:43,440 --> 00:26:45,039
keylogger

648
00:26:45,039 --> 00:26:48,080
it's not that trivial because when in by

649
00:26:48,080 --> 00:26:49,279
installer

650
00:26:49,279 --> 00:26:52,799
packages the the script

651
00:26:52,799 --> 00:26:56,720
it is like one package with all the

652
00:26:56,720 --> 00:26:58,400
dependencies

653
00:26:58,400 --> 00:27:01,279
and and also this is like a runtime

654
00:27:01,279 --> 00:27:02,640
environment and

655
00:27:02,640 --> 00:27:05,120
and when it's run the script is

656
00:27:05,120 --> 00:27:06,320
interpreted

657
00:27:06,320 --> 00:27:09,360
so you cannot hunt for any specific uh

658
00:27:09,360 --> 00:27:12,480
keywords from the file from the

659
00:27:12,480 --> 00:27:15,200
decompiled python script but for example

660
00:27:15,200 --> 00:27:17,520
like in that case you can hunt for

661
00:27:17,520 --> 00:27:20,640
for the imports so for the specific

662
00:27:20,640 --> 00:27:22,720
artifacts connected with the

663
00:27:22,720 --> 00:27:25,520
imported libraries of the script it is

664
00:27:25,520 --> 00:27:26,960
not very precise

665
00:27:26,960 --> 00:27:30,159
yara rule for a yellow hand but it's

666
00:27:30,159 --> 00:27:30,559
quite

667
00:27:30,559 --> 00:27:34,000
wide you do not only catch

668
00:27:34,000 --> 00:27:37,360
aft samples but it's

669
00:27:37,360 --> 00:27:41,760
quite quite good yellow rule

670
00:27:41,760 --> 00:27:45,360
to be deployed to find

671
00:27:45,360 --> 00:27:47,600
in general python keylogger and then

672
00:27:47,600 --> 00:27:48,720
when you analyze

673
00:27:48,720 --> 00:27:50,960
reverse engineer it you can try to

674
00:27:50,960 --> 00:27:51,919
understand

675
00:27:51,919 --> 00:27:54,559
and you can apply more specific uh yar

676
00:27:54,559 --> 00:27:55,600
rules to the

677
00:27:55,600 --> 00:27:59,600
the final the compiled python script

678
00:28:00,080 --> 00:28:02,320
let's go to the case study number two

679
00:28:02,320 --> 00:28:03,760
and and analyze

680
00:28:03,760 --> 00:28:05,840
a little bit about the grub zone

681
00:28:05,840 --> 00:28:08,159
infrastructure and their capabilities

682
00:28:08,159 --> 00:28:09,120
especially the

683
00:28:09,120 --> 00:28:11,360
the newest one that were used and

684
00:28:11,360 --> 00:28:12,960
deployed against the victims

685
00:28:12,960 --> 00:28:16,480
in 2020

686
00:28:16,480 --> 00:28:20,320
so uh the inspiration was

687
00:28:20,320 --> 00:28:23,360
like in every case for african financial

688
00:28:23,360 --> 00:28:24,000
threats

689
00:28:24,000 --> 00:28:26,000
i used the term african financial

690
00:28:26,000 --> 00:28:28,320
threats although the original intention

691
00:28:28,320 --> 00:28:30,640
by honest services was

692
00:28:30,640 --> 00:28:34,799
advanced financial threats in africa

693
00:28:34,799 --> 00:28:39,039
so african financial threats is is my

694
00:28:39,039 --> 00:28:42,559
translation maybe not with the intention

695
00:28:42,559 --> 00:28:43,120
of the

696
00:28:43,120 --> 00:28:46,480
original authors when you look for

697
00:28:46,480 --> 00:28:47,200
example

698
00:28:47,200 --> 00:28:50,480
in in the materials from their workshops

699
00:28:50,480 --> 00:28:53,039
you can find some background interesting

700
00:28:53,039 --> 00:28:54,080
information

701
00:28:54,080 --> 00:28:57,760
that grabs them as using new python 3

702
00:28:57,760 --> 00:29:01,039
back there in this year and you can find

703
00:29:01,039 --> 00:29:03,360
the ip address and the port

704
00:29:03,360 --> 00:29:06,320
probably the command control server for

705
00:29:06,320 --> 00:29:07,600
this background so

706
00:29:07,600 --> 00:29:10,000
what kind of background it is and what

707
00:29:10,000 --> 00:29:11,279
can we learn about this

708
00:29:11,279 --> 00:29:16,640
ip so let's maybe try to

709
00:29:17,440 --> 00:29:20,480
dig for a needle in a haystack

710
00:29:20,480 --> 00:29:25,039
and we'll see what can we find if we can

711
00:29:25,039 --> 00:29:27,760
dig stay in the rabbit hole or can we

712
00:29:27,760 --> 00:29:28,960
find any pattern

713
00:29:28,960 --> 00:29:31,440
and something that can be used

714
00:29:31,440 --> 00:29:32,480
operationally

715
00:29:32,480 --> 00:29:35,679
later and maybe something

716
00:29:35,679 --> 00:29:37,279
maybe we could uncover something to

717
00:29:37,279 --> 00:29:39,440
track those actors

718
00:29:39,440 --> 00:29:42,880
so if you take this iep and

719
00:29:42,880 --> 00:29:47,279
uh analyze it and check it on showdown

720
00:29:47,279 --> 00:29:50,559
and i don't know if you use showdown and

721
00:29:50,559 --> 00:29:51,919
i really recommend

722
00:29:51,919 --> 00:29:55,039
you use the beta version because

723
00:29:55,039 --> 00:29:57,520
in the beta version you can also use the

724
00:29:57,520 --> 00:29:58,320
history

725
00:29:58,320 --> 00:30:01,360
so that the past counts by showdown it

726
00:30:01,360 --> 00:30:02,399
is not available

727
00:30:02,399 --> 00:30:06,080
in the old web gui it has been always

728
00:30:06,080 --> 00:30:10,159
accessible via api via command line

729
00:30:10,159 --> 00:30:12,480
but not from the web gui now it is

730
00:30:12,480 --> 00:30:14,240
possible but only in the

731
00:30:14,240 --> 00:30:17,600
beta version of showdown so we can see

732
00:30:17,600 --> 00:30:18,640
that there are some

733
00:30:18,640 --> 00:30:22,000
ports associated not only now but in the

734
00:30:22,000 --> 00:30:25,360
past with this ip um

735
00:30:25,360 --> 00:30:28,399
do you see any interesting ports i think

736
00:30:28,399 --> 00:30:29,200
that those

737
00:30:29,200 --> 00:30:31,520
ones in the middle are quite interesting

738
00:30:31,520 --> 00:30:32,720
free 306

739
00:30:32,720 --> 00:30:36,799
is the default port for mysql mysql3389

740
00:30:36,799 --> 00:30:39,440
is the default port for rdp remote

741
00:30:39,440 --> 00:30:40,159
desktop

742
00:30:40,159 --> 00:30:43,760
protocol so maybe let's see later on

743
00:30:43,760 --> 00:30:47,440
what can we learn about those

744
00:30:48,840 --> 00:30:51,440
ports

745
00:30:51,440 --> 00:30:54,720
just to analyze the who is information

746
00:30:54,720 --> 00:30:55,919
and this ip

747
00:30:55,919 --> 00:30:59,200
um belongs to the cloud one host this is

748
00:30:59,200 --> 00:31:00,080
a hosting

749
00:31:00,080 --> 00:31:02,399
and when you check their products they

750
00:31:02,399 --> 00:31:04,000
usually offer some hosting

751
00:31:04,000 --> 00:31:07,679
of uh vms vpss

752
00:31:07,679 --> 00:31:09,840
connected with offensive security for

753
00:31:09,840 --> 00:31:11,519
example kali linux

754
00:31:11,519 --> 00:31:14,080
parrot security you see torque hidden

755
00:31:14,080 --> 00:31:16,000
services

756
00:31:16,000 --> 00:31:19,519
so that type of uh

757
00:31:19,519 --> 00:31:23,440
vms and

758
00:31:23,600 --> 00:31:27,320
let's go to the analysis of the port

759
00:31:27,320 --> 00:31:29,440
3389 so rdp

760
00:31:29,440 --> 00:31:31,760
and here you can see in showdown this is

761
00:31:31,760 --> 00:31:34,080
a screenshot from sheldon

762
00:31:34,080 --> 00:31:38,720
that there was accessible port and rdp

763
00:31:38,720 --> 00:31:39,919
connection to the

764
00:31:39,919 --> 00:31:43,600
national bank of kenya

765
00:31:43,600 --> 00:31:46,880
and this might be associated with this

766
00:31:46,880 --> 00:31:47,919
bank

767
00:31:47,919 --> 00:31:49,840
so what happened here so it's very

768
00:31:49,840 --> 00:31:52,320
likely that the adversary that operated

769
00:31:52,320 --> 00:31:52,799
this

770
00:31:52,799 --> 00:31:56,080
component control server uh managed to

771
00:31:56,080 --> 00:32:00,240
tunnel out the rdp to this

772
00:32:00,240 --> 00:32:03,840
uh c2 to connect for example with

773
00:32:03,840 --> 00:32:08,080
their client and operates

774
00:32:08,080 --> 00:32:11,120
with this machine

775
00:32:11,760 --> 00:32:15,200
using this c2 infrastructure so

776
00:32:15,200 --> 00:32:17,760
we can find some evidence that one of

777
00:32:17,760 --> 00:32:20,240
their victims was national bank of

778
00:32:20,240 --> 00:32:22,960
of kenya

779
00:32:25,360 --> 00:32:28,960
but if we analyze the port 8080

780
00:32:28,960 --> 00:32:33,120
which like like it was presented before

781
00:32:33,120 --> 00:32:35,760
was associated with the new tool new

782
00:32:35,760 --> 00:32:37,279
python vector

783
00:32:37,279 --> 00:32:40,559
we don't see much information shotan

784
00:32:40,559 --> 00:32:42,640
tells us that this is a kind of a

785
00:32:42,640 --> 00:32:46,960
http proxy with bad request answers and

786
00:32:46,960 --> 00:32:50,080
in my research i i learned that if

787
00:32:50,080 --> 00:32:52,960
the python if the new python vector was

788
00:32:52,960 --> 00:32:54,159
used it was used

789
00:32:54,159 --> 00:32:57,200
in the beginning of the year in february

790
00:32:57,200 --> 00:32:58,320
in march

791
00:32:58,320 --> 00:33:02,320
so not in july not in august like

792
00:33:02,320 --> 00:33:05,360
it is written here

793
00:33:05,360 --> 00:33:08,399
so are there any traces that

794
00:33:08,399 --> 00:33:10,799
this ip was connected with this python

795
00:33:10,799 --> 00:33:12,320
backdoor

796
00:33:12,320 --> 00:33:14,000
maybe it's better to understand what

797
00:33:14,000 --> 00:33:16,320
kind of background it is

798
00:33:16,320 --> 00:33:20,000
so i also took some strings from

799
00:33:20,000 --> 00:33:24,640
from this image and i tried to

800
00:33:24,640 --> 00:33:28,799
pivot with those strings and if you put

801
00:33:28,799 --> 00:33:31,360
this string into google you get only

802
00:33:31,360 --> 00:33:32,399
seven results

803
00:33:32,399 --> 00:33:34,799
and the first result points you to the

804
00:33:34,799 --> 00:33:35,600
github

805
00:33:35,600 --> 00:33:38,480
uh of the project ihr shell this is not

806
00:33:38,480 --> 00:33:39,919
a human resource

807
00:33:39,919 --> 00:33:43,279
uh project this is actually the

808
00:33:43,279 --> 00:33:46,799
vector that is written in python python

809
00:33:46,799 --> 00:33:47,679
3

810
00:33:47,679 --> 00:33:50,920
and is supported by flask so the

811
00:33:50,920 --> 00:33:52,559
[Music]

812
00:33:52,559 --> 00:33:56,720
framework for uh web applications

813
00:33:56,720 --> 00:34:00,240
and maybe we could try to

814
00:34:00,240 --> 00:34:04,000
analyze with this project to to get some

815
00:34:04,000 --> 00:34:06,640
indicators to get some patterns

816
00:34:06,640 --> 00:34:11,119
that will help us track the detector

817
00:34:11,119 --> 00:34:14,399
if you take this string and for example

818
00:34:14,399 --> 00:34:17,040
check virustotal you can see that there

819
00:34:17,040 --> 00:34:17,599
are not

820
00:34:17,599 --> 00:34:19,359
many hits and this is probably the

821
00:34:19,359 --> 00:34:22,399
reason why this actor uses

822
00:34:22,399 --> 00:34:25,280
those capabilities because as you see

823
00:34:25,280 --> 00:34:25,839
after

824
00:34:25,839 --> 00:34:29,199
compiling of the of the client so the

825
00:34:29,199 --> 00:34:30,079
backdoor

826
00:34:30,079 --> 00:34:32,960
to the windows executable there's only

827
00:34:32,960 --> 00:34:33,440
one

828
00:34:33,440 --> 00:34:35,679
detection on virustotal and that's

829
00:34:35,679 --> 00:34:37,520
probably the reason

830
00:34:37,520 --> 00:34:39,599
why they try to experiment with new

831
00:34:39,599 --> 00:34:40,560
tools

832
00:34:40,560 --> 00:34:42,399
they do not want to maybe they do not

833
00:34:42,399 --> 00:34:44,000
know i don't know

834
00:34:44,000 --> 00:34:47,119
how to obfuscate how to bypass so they

835
00:34:47,119 --> 00:34:48,879
try to

836
00:34:48,879 --> 00:34:51,679
experiment with easiest option try to

837
00:34:51,679 --> 00:34:52,960
find new tools

838
00:34:52,960 --> 00:34:56,320
and maybe use them because they have

839
00:34:56,320 --> 00:34:57,040
very low

840
00:34:57,040 --> 00:35:02,000
av detections

841
00:35:02,000 --> 00:35:05,119
um if you look

842
00:35:05,119 --> 00:35:08,160
uh into the source code of the server pi

843
00:35:08,160 --> 00:35:09,760
so the server component of this command

844
00:35:09,760 --> 00:35:10,560
control

845
00:35:10,560 --> 00:35:12,720
you can see that it is based on the on

846
00:35:12,720 --> 00:35:14,960
the flask tornado

847
00:35:14,960 --> 00:35:17,040
server and there should be some

848
00:35:17,040 --> 00:35:18,160
indicators

849
00:35:18,160 --> 00:35:20,640
of this tornado server and when i

850
00:35:20,640 --> 00:35:22,640
compared it with the

851
00:35:22,640 --> 00:35:25,359
information from showdown i can i found

852
00:35:25,359 --> 00:35:26,560
only one day

853
00:35:26,560 --> 00:35:30,079
when this response was present

854
00:35:30,079 --> 00:35:33,520
was captured by shodhan and it is

855
00:35:33,520 --> 00:35:37,200
related to the server flask server

856
00:35:37,200 --> 00:35:40,640
offered and used in this

857
00:35:40,640 --> 00:35:44,000
server component

858
00:35:44,000 --> 00:35:48,079
so maybe let's dig more with that

859
00:35:48,079 --> 00:35:51,200
the best way is to is to just

860
00:35:51,200 --> 00:35:55,040
uh git clone this project and try to

861
00:35:55,040 --> 00:35:56,720
experiment

862
00:35:56,720 --> 00:35:59,119
on your own with the project and to

863
00:35:59,119 --> 00:35:59,839
analyze

864
00:35:59,839 --> 00:36:03,359
the responses so when i try to

865
00:36:03,359 --> 00:36:06,720
uh send requests with kernel to to this

866
00:36:06,720 --> 00:36:09,839
c2 component i got quite same http

867
00:36:09,839 --> 00:36:12,000
responses if you look at the headers

868
00:36:12,000 --> 00:36:15,680
so the headers here are very similar

869
00:36:15,680 --> 00:36:18,720
to what was uh indexed by

870
00:36:18,720 --> 00:36:21,280
showdown i will go back to the previous

871
00:36:21,280 --> 00:36:23,200
slide so you could now compare

872
00:36:23,200 --> 00:36:26,400
that the red parts here

873
00:36:26,400 --> 00:36:29,599
are also present

874
00:36:29,599 --> 00:36:32,800
in this response that was captured by

875
00:36:32,800 --> 00:36:37,680
shodhan it was captured in january

876
00:36:37,680 --> 00:36:41,440
at the end of january at this ip so we

877
00:36:41,440 --> 00:36:43,200
are always talking about this one

878
00:36:43,200 --> 00:36:46,480
ip of this infrastructure associated

879
00:36:46,480 --> 00:36:49,359
with grub zone

880
00:36:51,200 --> 00:36:53,440
when we go further and we and for

881
00:36:53,440 --> 00:36:54,240
example let's

882
00:36:54,240 --> 00:36:57,359
try to look how popular

883
00:36:57,359 --> 00:37:01,280
this vehicle httpd is in showdown so we

884
00:37:01,280 --> 00:37:01,599
get

885
00:37:01,599 --> 00:37:04,880
a lot of results but if we focus on the

886
00:37:04,880 --> 00:37:06,560
very specific

887
00:37:06,560 --> 00:37:09,839
version of of the server

888
00:37:09,839 --> 00:37:13,040
and we use uh those numbers

889
00:37:13,040 --> 00:37:15,920
works so and and python with this

890
00:37:15,920 --> 00:37:17,280
exactly

891
00:37:17,280 --> 00:37:20,560
exact numbers so the number is quite

892
00:37:20,560 --> 00:37:23,599
quite low it's almost 300

893
00:37:23,599 --> 00:37:27,119
if we try to narrow down those results

894
00:37:27,119 --> 00:37:28,160
and for example

895
00:37:28,160 --> 00:37:30,960
use some http headers which are quite

896
00:37:30,960 --> 00:37:32,400
unique for this

897
00:37:32,400 --> 00:37:35,680
project we could find that

898
00:37:35,680 --> 00:37:38,480
there are 11 results for example of the

899
00:37:38,480 --> 00:37:39,200
servers

900
00:37:39,200 --> 00:37:42,560
that have headers like x frame options

901
00:37:42,560 --> 00:37:43,599
same origin

902
00:37:43,599 --> 00:37:48,720
or xss protection with modes

903
00:37:48,839 --> 00:37:51,839
block quite low number

904
00:37:51,839 --> 00:37:55,359
so we are still not sure if every of

905
00:37:55,359 --> 00:37:56,960
those 11 ips

906
00:37:56,960 --> 00:37:59,520
is connected with the c2 infrastructure

907
00:37:59,520 --> 00:38:00,320
rather not

908
00:38:00,320 --> 00:38:02,640
because other headers are different but

909
00:38:02,640 --> 00:38:03,680
this is quite

910
00:38:03,680 --> 00:38:06,160
low number and we could approach this

911
00:38:06,160 --> 00:38:07,119
topic to

912
00:38:07,119 --> 00:38:10,079
to find new infrastructure a little bit

913
00:38:10,079 --> 00:38:12,079
differently but we will have to be

914
00:38:12,079 --> 00:38:14,640
more active because this was like a

915
00:38:14,640 --> 00:38:16,800
passive reconnaissance

916
00:38:16,800 --> 00:38:19,839
we could do some active checking and for

917
00:38:19,839 --> 00:38:20,480
example

918
00:38:20,480 --> 00:38:22,480
if we go to the source code of this

919
00:38:22,480 --> 00:38:24,800
project we can see that there is a

920
00:38:24,800 --> 00:38:25,760
registered

921
00:38:25,760 --> 00:38:28,880
root in this source code for

922
00:38:28,880 --> 00:38:32,960
asset commander so for example when you

923
00:38:32,960 --> 00:38:37,680
use carol and send the

924
00:38:38,000 --> 00:38:42,000
get commander slash

925
00:38:42,000 --> 00:38:45,440
now you get very specific response

926
00:38:45,440 --> 00:38:48,720
there is a 308 http response

927
00:38:48,720 --> 00:38:51,119
which is a permanent redirect and this

928
00:38:51,119 --> 00:38:51,839
is very

929
00:38:51,839 --> 00:38:54,079
unique for this project that for this

930
00:38:54,079 --> 00:38:54,880
specific

931
00:38:54,880 --> 00:38:57,119
request there is such a permanent

932
00:38:57,119 --> 00:38:59,760
redirect and when you

933
00:38:59,760 --> 00:39:02,480
also send the get commander with the

934
00:39:02,480 --> 00:39:03,520
slash

935
00:39:03,520 --> 00:39:07,440
at the end then you get the

936
00:39:07,440 --> 00:39:11,359
response 200 so the normal

937
00:39:11,359 --> 00:39:14,880
positive response there is such asset

938
00:39:14,880 --> 00:39:18,960
so this is something very unique to that

939
00:39:18,960 --> 00:39:22,000
hr shell server component

940
00:39:22,000 --> 00:39:25,760
so what can we do to to track this

941
00:39:25,760 --> 00:39:26,880
infrastructure

942
00:39:26,880 --> 00:39:29,599
for example in census we could use such

943
00:39:29,599 --> 00:39:30,640
a search

944
00:39:30,640 --> 00:39:33,839
so we focus on the vertoic

945
00:39:33,839 --> 00:39:36,720
server we focus on the specific headers

946
00:39:36,720 --> 00:39:37,040
like

947
00:39:37,040 --> 00:39:40,079
same origin with all no sniff

948
00:39:40,079 --> 00:39:43,119
options but we are looking for

949
00:39:43,119 --> 00:39:46,400
302 so the redirects this is also

950
00:39:46,400 --> 00:39:47,359
typical for

951
00:39:47,359 --> 00:39:50,720
hr shell and to be

952
00:39:50,720 --> 00:39:54,240
100 sure if we want to take the risk

953
00:39:54,240 --> 00:39:57,760
and we can try to check and send the

954
00:39:57,760 --> 00:40:02,480
active request to such server

955
00:40:02,560 --> 00:40:05,839
this is the the same query but

956
00:40:05,839 --> 00:40:09,359
the same logic but for showdown

957
00:40:09,359 --> 00:40:12,560
and you can see there's a syntax for

958
00:40:12,560 --> 00:40:14,720
showdown you can check the

959
00:40:14,720 --> 00:40:18,240
um the response which has a minus sign

960
00:40:18,240 --> 00:40:18,960
here

961
00:40:18,960 --> 00:40:22,160
because i'm not looking for the 200

962
00:40:22,160 --> 00:40:25,520
response because i am asking only for

963
00:40:25,520 --> 00:40:28,720
um for the root uh

964
00:40:28,720 --> 00:40:32,640
asset what are other c2 fingerprints

965
00:40:32,640 --> 00:40:35,200
that were present on this ip for example

966
00:40:35,200 --> 00:40:35,760
there was

967
00:40:35,760 --> 00:40:39,440
quite specific ssl certificate

968
00:40:39,440 --> 00:40:41,119
and if you take the subject of the

969
00:40:41,119 --> 00:40:43,040
certificate and try to find out

970
00:40:43,040 --> 00:40:45,599
and pivot with this information you can

971
00:40:45,599 --> 00:40:46,079
find

972
00:40:46,079 --> 00:40:49,599
another ip um on the internet that is

973
00:40:49,599 --> 00:40:50,480
present

974
00:40:50,480 --> 00:40:53,680
with same subject this is not a hard

975
00:40:53,680 --> 00:40:54,560
link

976
00:40:54,560 --> 00:40:58,880
this is very low um low confidence link

977
00:40:58,880 --> 00:41:00,960
you you cannot say that this

978
00:41:00,960 --> 00:41:02,160
infrastructure is

979
00:41:02,160 --> 00:41:04,560
all connected with grab zone but this is

980
00:41:04,560 --> 00:41:06,240
a link that you can follow

981
00:41:06,240 --> 00:41:08,079
and you can dig more another

982
00:41:08,079 --> 00:41:09,599
confirmation could be that

983
00:41:09,599 --> 00:41:13,040
both of those ips are hosted by

984
00:41:13,040 --> 00:41:16,560
in the infrastructure that's belonging

985
00:41:16,560 --> 00:41:16,730
to

986
00:41:16,730 --> 00:41:18,839
[Music]

987
00:41:18,839 --> 00:41:20,560
ovh um

988
00:41:20,560 --> 00:41:22,800
what are other fingerprints interesting

989
00:41:22,800 --> 00:41:25,200
here on another another port

990
00:41:25,200 --> 00:41:28,160
in different time about the time that

991
00:41:28,160 --> 00:41:28,880
that was

992
00:41:28,880 --> 00:41:30,880
when the server was operated by grab

993
00:41:30,880 --> 00:41:33,200
zone there is very specific

994
00:41:33,200 --> 00:41:36,240
and http response

995
00:41:36,240 --> 00:41:39,040
get file not specified in url so what

996
00:41:39,040 --> 00:41:40,240
can we do with that

997
00:41:40,240 --> 00:41:42,319
of course we can go to google and search

998
00:41:42,319 --> 00:41:43,680
for that string

999
00:41:43,680 --> 00:41:46,319
and we can only find one resource and

1000
00:41:46,319 --> 00:41:47,280
this is a

1001
00:41:47,280 --> 00:41:50,640
article about how to create a file

1002
00:41:50,640 --> 00:41:55,119
a file hosting server in goldline

1003
00:41:55,119 --> 00:41:59,040
so um this is a simple way how

1004
00:41:59,040 --> 00:42:01,119
probably adversary in this case grab

1005
00:42:01,119 --> 00:42:03,760
some operators wanted to download the

1006
00:42:03,760 --> 00:42:07,920
other tools from the victim computers

1007
00:42:07,920 --> 00:42:09,760
why i think that it is from victim

1008
00:42:09,760 --> 00:42:11,839
computers because they

1009
00:42:11,839 --> 00:42:15,040
modified a little bit this this project

1010
00:42:15,040 --> 00:42:16,720
and added special

1011
00:42:16,720 --> 00:42:20,000
header to the to the response the header

1012
00:42:20,000 --> 00:42:23,359
that will uh that will

1013
00:42:23,359 --> 00:42:26,240
not stop the browser to download a file

1014
00:42:26,240 --> 00:42:29,040
when there is a

1015
00:42:29,040 --> 00:42:32,400
conflict between the extension and the

1016
00:42:32,400 --> 00:42:35,839
and the real um mime

1017
00:42:35,839 --> 00:42:40,319
uh analyzed by the by the by the browser

1018
00:42:40,319 --> 00:42:43,520
um if you look for any

1019
00:42:43,520 --> 00:42:47,119
of the servers that has

1020
00:42:47,119 --> 00:42:49,599
such a response in the internet you can

1021
00:42:49,599 --> 00:42:50,640
only find this

1022
00:42:50,640 --> 00:42:53,040
one ip so this is not a big

1023
00:42:53,040 --> 00:42:55,200
infrastructure you can see that

1024
00:42:55,200 --> 00:42:58,640
no other people use such uh

1025
00:42:58,640 --> 00:43:01,920
such uh implementation

1026
00:43:01,920 --> 00:43:04,960
for so this is not a popular project

1027
00:43:04,960 --> 00:43:07,760
probably the it was written years ago by

1028
00:43:07,760 --> 00:43:09,680
somebody by a blogger

1029
00:43:09,680 --> 00:43:12,000
they found it and tried to use it in

1030
00:43:12,000 --> 00:43:12,720
their

1031
00:43:12,720 --> 00:43:15,839
in their purpose but this could be very

1032
00:43:15,839 --> 00:43:18,720
good indicator to find there another

1033
00:43:18,720 --> 00:43:20,880
infrastructure when they for example

1034
00:43:20,880 --> 00:43:23,920
begin another operation

1035
00:43:23,920 --> 00:43:27,119
they they set up new server

1036
00:43:27,119 --> 00:43:29,599
this could be also a good indicator to

1037
00:43:29,599 --> 00:43:31,440
hunt them

1038
00:43:31,440 --> 00:43:33,119
that's the way how you can find it in

1039
00:43:33,119 --> 00:43:34,720
showdown you can use the hashes

1040
00:43:34,720 --> 00:43:38,839
of the html so the response so the the

1041
00:43:38,839 --> 00:43:40,240
body um

1042
00:43:40,240 --> 00:43:43,520
and that's the way oh and this is uh

1043
00:43:43,520 --> 00:43:46,720
also the way how to

1044
00:43:46,880 --> 00:43:48,800
so here previously we talked about

1045
00:43:48,800 --> 00:43:50,480
hunting the infrastructure

1046
00:43:50,480 --> 00:43:52,400
let's say a bit about hunting that the

1047
00:43:52,400 --> 00:43:54,160
clients component

1048
00:43:54,160 --> 00:43:57,280
for example after compiling the

1049
00:43:57,280 --> 00:44:00,480
the source code of the client to the exa

1050
00:44:00,480 --> 00:44:01,599
file

1051
00:44:01,599 --> 00:44:04,560
there is very specific resource and a

1052
00:44:04,560 --> 00:44:05,440
manifest

1053
00:44:05,440 --> 00:44:08,480
file this is

1054
00:44:08,480 --> 00:44:11,839
present here and this manifest file is

1055
00:44:11,839 --> 00:44:14,319
present in all the executables compiled

1056
00:44:14,319 --> 00:44:15,680
by pi installer

1057
00:44:15,680 --> 00:44:17,359
and when you check it for example in

1058
00:44:17,359 --> 00:44:20,240
virus total you can get only 15 files

1059
00:44:20,240 --> 00:44:22,319
and this is a very precise heat

1060
00:44:22,319 --> 00:44:25,920
because all those 15 files are related

1061
00:44:25,920 --> 00:44:26,640
to the

1062
00:44:26,640 --> 00:44:29,599
to this project so the client of the

1063
00:44:29,599 --> 00:44:32,160
higher shell you cannot say that this is

1064
00:44:32,160 --> 00:44:34,960
for sure grab zone but then you can get

1065
00:44:34,960 --> 00:44:35,599
the list

1066
00:44:35,599 --> 00:44:38,880
of the of the vectors

1067
00:44:38,880 --> 00:44:41,200
and then you can decompile them analyze

1068
00:44:41,200 --> 00:44:42,160
and maybe

1069
00:44:42,160 --> 00:44:45,280
uh take out the c2 server which is

1070
00:44:45,280 --> 00:44:46,560
included there and

1071
00:44:46,560 --> 00:44:49,440
and reach this information further

1072
00:44:49,440 --> 00:44:52,000
anything else suspicious on this ip

1073
00:44:52,000 --> 00:44:54,880
so for example here you we can see the

1074
00:44:54,880 --> 00:44:56,160
response

1075
00:44:56,160 --> 00:44:59,599
uh this is a matter of typical default

1076
00:44:59,599 --> 00:45:03,119
metal predator response it was present

1077
00:45:03,119 --> 00:45:06,400
in february march april

1078
00:45:06,400 --> 00:45:09,920
so this group also used metal predator

1079
00:45:09,920 --> 00:45:13,119
during their operations in spring

1080
00:45:13,119 --> 00:45:18,160
and there is also a pierce empire hosted

1081
00:45:18,160 --> 00:45:21,680
uh on 21st and 22nd of

1082
00:45:21,680 --> 00:45:24,800
january january however we cannot we

1083
00:45:24,800 --> 00:45:25,440
cannot

1084
00:45:25,440 --> 00:45:27,599
connect this activity with this group

1085
00:45:27,599 --> 00:45:28,720
why because

1086
00:45:28,720 --> 00:45:32,960
on the 24th the ssh and the fingerprint

1087
00:45:32,960 --> 00:45:34,400
for the ssh service

1088
00:45:34,400 --> 00:45:37,680
changed so it may indicate that this box

1089
00:45:37,680 --> 00:45:39,119
this server was

1090
00:45:39,119 --> 00:45:41,599
was just a new build we can we are not

1091
00:45:41,599 --> 00:45:42,319
sure that

1092
00:45:42,319 --> 00:45:45,040
this is i don't know updated server or

1093
00:45:45,040 --> 00:45:47,280
installed server by same actor

1094
00:45:47,280 --> 00:45:50,240
everything what happens uh on this

1095
00:45:50,240 --> 00:45:52,480
server from 24

1096
00:45:52,480 --> 00:45:55,920
to up to now could be with some moderate

1097
00:45:55,920 --> 00:45:57,599
confidence associated with

1098
00:45:57,599 --> 00:46:00,480
with one actor one adversary of course

1099
00:46:00,480 --> 00:46:01,520
we need to

1100
00:46:01,520 --> 00:46:03,760
to have to gather more evidence for that

1101
00:46:03,760 --> 00:46:04,640
but

1102
00:46:04,640 --> 00:46:06,960
i clustered those activities from

1103
00:46:06,960 --> 00:46:07,760
january

1104
00:46:07,760 --> 00:46:10,079
from the end of january till now to one

1105
00:46:10,079 --> 00:46:10,960
group

1106
00:46:10,960 --> 00:46:14,000
everything before i cannot be

1107
00:46:14,000 --> 00:46:16,079
sure of that it's worth noting worth

1108
00:46:16,079 --> 00:46:17,599
marking somewhere

1109
00:46:17,599 --> 00:46:21,119
tagging maybe with lower confidence

1110
00:46:21,119 --> 00:46:24,240
but nothing for sure even in

1111
00:46:24,240 --> 00:46:26,240
december there was a couple strike

1112
00:46:26,240 --> 00:46:27,680
hosted with there's a

1113
00:46:27,680 --> 00:46:30,480
typical couple strike default response

1114
00:46:30,480 --> 00:46:32,160
but no hard evidence

1115
00:46:32,160 --> 00:46:36,040
for clustering so to sum up grub zone

1116
00:46:36,040 --> 00:46:37,200
2020

1117
00:46:37,200 --> 00:46:41,040
uh in in 2020 this group uses

1118
00:46:41,040 --> 00:46:44,560
python vectors like intershell rgrad

1119
00:46:44,560 --> 00:46:47,200
this is information actually from honest

1120
00:46:47,200 --> 00:46:48,319
services

1121
00:46:48,319 --> 00:46:51,599
and from their operations and and they

1122
00:46:51,599 --> 00:46:52,160
share the

1123
00:46:52,160 --> 00:46:54,560
information publicly and they use

1124
00:46:54,560 --> 00:46:56,480
metapreter they use rdp

1125
00:46:56,480 --> 00:46:59,520
tonalink probably they use ng rock for

1126
00:46:59,520 --> 00:47:01,440
those rdp tunneling

1127
00:47:01,440 --> 00:47:04,160
uh they use tools downloaded via victim

1128
00:47:04,160 --> 00:47:05,040
browser

1129
00:47:05,040 --> 00:47:08,079
and for that they use this go file

1130
00:47:08,079 --> 00:47:09,760
server they use

1131
00:47:09,760 --> 00:47:13,680
hr shell and quite unique is

1132
00:47:13,680 --> 00:47:18,240
hosting in in the company cloud one host

1133
00:47:18,240 --> 00:47:20,880
and the victims we learned in this

1134
00:47:20,880 --> 00:47:22,160
investigation that they

1135
00:47:22,160 --> 00:47:24,640
they hit national bank of kenya we saw

1136
00:47:24,640 --> 00:47:25,520
that they were

1137
00:47:25,520 --> 00:47:28,960
quite quite successful

1138
00:47:28,960 --> 00:47:32,240
no hard evidence if they about the

1139
00:47:32,240 --> 00:47:36,799
the final impact on the on the victim

1140
00:47:36,880 --> 00:47:38,880
if you if you think this is an

1141
00:47:38,880 --> 00:47:41,280
interesting subject i also recommend you

1142
00:47:41,280 --> 00:47:43,920
go and check the honest services block

1143
00:47:43,920 --> 00:47:45,839
and for example this document is very

1144
00:47:45,839 --> 00:47:47,920
fascinating because this is the history

1145
00:47:47,920 --> 00:47:48,400
of for

1146
00:47:48,400 --> 00:47:52,000
bombay intrusions they're optic failures

1147
00:47:52,000 --> 00:47:55,839
and also the offensive operations

1148
00:47:55,839 --> 00:47:58,319
carried by on its services

1149
00:47:58,319 --> 00:48:00,400
you can you can find out the the

1150
00:48:00,400 --> 00:48:03,440
screenshots from the adversary machines

1151
00:48:03,440 --> 00:48:06,720
so how the operators from honest

1152
00:48:06,720 --> 00:48:07,920
services

1153
00:48:07,920 --> 00:48:11,760
uh spied on them and

1154
00:48:11,760 --> 00:48:16,000
really recommended reading um

1155
00:48:16,000 --> 00:48:18,839
yes so thank you generally for the

1156
00:48:18,839 --> 00:48:20,160
attention

1157
00:48:20,160 --> 00:48:25,599
um for myself it is a very fascinating

1158
00:48:25,599 --> 00:48:28,000
subject i'm going to continue the

1159
00:48:28,000 --> 00:48:30,480
research tracking of those groups

1160
00:48:30,480 --> 00:48:34,319
and i think that it's

1161
00:48:34,319 --> 00:48:37,119
something new especially the kill chain

1162
00:48:37,119 --> 00:48:37,760
and

1163
00:48:37,760 --> 00:48:41,359
this physical access you the usage of

1164
00:48:41,359 --> 00:48:44,800
other tools um made it

1165
00:48:44,800 --> 00:48:48,480
quite uh interesting area to to dig more

1166
00:48:48,480 --> 00:48:50,480
and there are still many of the unknowns

1167
00:48:50,480 --> 00:48:52,000
i'm still a

1168
00:48:52,000 --> 00:48:55,200
learner and i take

1169
00:48:55,200 --> 00:48:58,079
a lot of information and i'm trying to

1170
00:48:58,079 --> 00:48:59,520
enrich them

1171
00:48:59,520 --> 00:49:02,640
with my analysis based on the

1172
00:49:02,640 --> 00:49:05,680
samples based on the information

1173
00:49:05,680 --> 00:49:09,680
that are taken out by the brave men from

1174
00:49:09,680 --> 00:49:10,640
kenya

1175
00:49:10,640 --> 00:49:13,520
and thanks to them we can learn more

1176
00:49:13,520 --> 00:49:14,240
about

1177
00:49:14,240 --> 00:49:16,640
what happens in that region in that

1178
00:49:16,640 --> 00:49:17,760
threat landscape

1179
00:49:17,760 --> 00:49:31,119
so thank you again

