1
00:00:12,400 --> 00:00:13,120
so

2
00:00:13,120 --> 00:00:16,160
hello i'm giovanni camurati i will

3
00:00:16,160 --> 00:00:16,720
present

4
00:00:16,720 --> 00:00:18,640
understanding screaming channels from a

5
00:00:18,640 --> 00:00:20,400
detailed analysis to

6
00:00:20,400 --> 00:00:23,279
improve the text

7
00:00:29,439 --> 00:00:33,200
um hello so i i'm joining i will present

8
00:00:33,200 --> 00:00:35,120
uh understanding streaming channels

9
00:00:35,120 --> 00:00:36,719
screaming channels are

10
00:00:36,719 --> 00:00:39,680
a novel type of electromagnetic side

11
00:00:39,680 --> 00:00:41,040
channel attacks

12
00:00:41,040 --> 00:00:44,239
i am a phd student in eureka in the

13
00:00:44,239 --> 00:00:45,520
south of france

14
00:00:45,520 --> 00:00:48,559
and i mostly work on this studying this

15
00:00:48,559 --> 00:00:50,160
interaction between

16
00:00:50,160 --> 00:00:53,360
radio transceivers and digital devices

17
00:00:53,360 --> 00:00:54,960
to see if there can be some

18
00:00:54,960 --> 00:00:57,440
security implications security problems

19
00:00:57,440 --> 00:00:59,920
but in general i also like

20
00:00:59,920 --> 00:01:02,719
computer architectures embedded systems

21
00:01:02,719 --> 00:01:03,359
and

22
00:01:03,359 --> 00:01:06,479
i have been working on firmware analysis

23
00:01:06,479 --> 00:01:09,439
so why are radios and computing devices

24
00:01:09,439 --> 00:01:10,000
together

25
00:01:10,000 --> 00:01:11,760
in the first place well that's because

26
00:01:11,760 --> 00:01:13,760
modern devices are connected

27
00:01:13,760 --> 00:01:16,880
so besides having computation

28
00:01:16,880 --> 00:01:19,920
sensing and actuation capabilities they

29
00:01:19,920 --> 00:01:20,799
also have

30
00:01:20,799 --> 00:01:23,040
wireless interfaces to communicate with

31
00:01:23,040 --> 00:01:24,400
other devices

32
00:01:24,400 --> 00:01:26,560
so for example this device could talk

33
00:01:26,560 --> 00:01:28,799
with a smartphone over bluetooth low

34
00:01:28,799 --> 00:01:29,600
energy

35
00:01:29,600 --> 00:01:32,240
and to protect these communications we

36
00:01:32,240 --> 00:01:33,119
need

37
00:01:33,119 --> 00:01:36,640
cryptographic algorithms

38
00:01:36,640 --> 00:01:39,200
it's very convenient to place all these

39
00:01:39,200 --> 00:01:40,079
components

40
00:01:40,079 --> 00:01:42,960
analog radio frequency digital on the

41
00:01:42,960 --> 00:01:43,920
same chip

42
00:01:43,920 --> 00:01:47,680
because of cost reasons area reasons and

43
00:01:47,680 --> 00:01:49,680
most importantly because it's very easy

44
00:01:49,680 --> 00:01:51,200
to integrate a chip with

45
00:01:51,200 --> 00:01:53,439
all the functionalities in one place

46
00:01:53,439 --> 00:01:55,360
inside a product

47
00:01:55,360 --> 00:01:57,840
unfortunately in these cases there can

48
00:01:57,840 --> 00:01:58,880
also be

49
00:01:58,880 --> 00:02:01,360
some issues so let's imagine to have our

50
00:02:01,360 --> 00:02:02,000
device

51
00:02:02,000 --> 00:02:03,680
and a cryptographic algorithm for

52
00:02:03,680 --> 00:02:05,920
example aes running on it

53
00:02:05,920 --> 00:02:08,160
to protect let's say authentication to

54
00:02:08,160 --> 00:02:10,000
the device

55
00:02:10,000 --> 00:02:12,720
if we measure the power consumption or

56
00:02:12,720 --> 00:02:15,120
other physical parameters with a probe

57
00:02:15,120 --> 00:02:15,760
and

58
00:02:15,760 --> 00:02:18,080
close proximity to the device we can

59
00:02:18,080 --> 00:02:18,959
extract

60
00:02:18,959 --> 00:02:20,879
traces which correspond to the

61
00:02:20,879 --> 00:02:22,720
encryptions which are correlated with

62
00:02:22,720 --> 00:02:24,480
the encryption so that with

63
00:02:24,480 --> 00:02:27,120
some statistical analysis we can find

64
00:02:27,120 --> 00:02:27,680
the key

65
00:02:27,680 --> 00:02:29,760
and break cryptography these are called

66
00:02:29,760 --> 00:02:31,440
side channels the conventional side

67
00:02:31,440 --> 00:02:32,080
channels

68
00:02:32,080 --> 00:02:34,400
but most of the time they are outside of

69
00:02:34,400 --> 00:02:36,319
the threat model for these this kind of

70
00:02:36,319 --> 00:02:37,760
devices because they need

71
00:02:37,760 --> 00:02:40,959
physical access to the device instead we

72
00:02:40,959 --> 00:02:42,480
have observed that

73
00:02:42,480 --> 00:02:44,640
the cryptographic algorithm running on

74
00:02:44,640 --> 00:02:45,680
the device

75
00:02:45,680 --> 00:02:48,800
also modulates the radio emissions

76
00:02:48,800 --> 00:02:50,480
intentional radio emissions of the

77
00:02:50,480 --> 00:02:52,480
device so for example if the

78
00:02:52,480 --> 00:02:54,800
chip is sending bluetooth packets the

79
00:02:54,800 --> 00:02:57,599
aes algorithm modulates these packets

80
00:02:57,599 --> 00:02:59,920
and the leakage is amplified and

81
00:02:59,920 --> 00:03:02,080
broadcast at a potentially very large

82
00:03:02,080 --> 00:03:03,840
distance so that for example at 10

83
00:03:03,840 --> 00:03:04,560
meters

84
00:03:04,560 --> 00:03:07,440
we can still observe some execution

85
00:03:07,440 --> 00:03:08,159
traces

86
00:03:08,159 --> 00:03:10,159
from cryptography we can run side

87
00:03:10,159 --> 00:03:12,239
channel attacks and we can break

88
00:03:12,239 --> 00:03:14,640
a cryptography from a distance so we

89
00:03:14,640 --> 00:03:15,360
call these

90
00:03:15,360 --> 00:03:17,840
screaming channels because the power of

91
00:03:17,840 --> 00:03:19,440
the leakage is high

92
00:03:19,440 --> 00:03:21,680
because it's amplified by an intentional

93
00:03:21,680 --> 00:03:22,640
radio

94
00:03:22,640 --> 00:03:24,959
transmitter so here is an example of

95
00:03:24,959 --> 00:03:26,640
screaming channels in practice

96
00:03:26,640 --> 00:03:28,640
uh let's consider this a bluetooth low

97
00:03:28,640 --> 00:03:30,879
energy chip which on the same silicon

98
00:03:30,879 --> 00:03:31,280
die

99
00:03:31,280 --> 00:03:34,720
also has a cortex m4 processor and let's

100
00:03:34,720 --> 00:03:35,920
place ourselves

101
00:03:35,920 --> 00:03:38,319
at two meters from it with a big antenna

102
00:03:38,319 --> 00:03:39,680
and a radio receiver

103
00:03:39,680 --> 00:03:42,319
and then let's look at the radio channel

104
00:03:42,319 --> 00:03:43,440
so what we can see

105
00:03:43,440 --> 00:03:45,360
here is a spectrogram plot so the

106
00:03:45,360 --> 00:03:47,599
spectrogram plot shows the frequency on

107
00:03:47,599 --> 00:03:50,239
the y-axis and the time on the x-axis so

108
00:03:50,239 --> 00:03:51,680
you can see the evolution of the

109
00:03:51,680 --> 00:03:53,680
frequency components of the energy

110
00:03:53,680 --> 00:03:55,840
of the frequency components over time

111
00:03:55,840 --> 00:03:57,439
and you can see that

112
00:03:57,439 --> 00:04:00,560
the packets for bluetooth packets are

113
00:04:00,560 --> 00:04:01,360
visible

114
00:04:01,360 --> 00:04:03,599
but not only that we can also see the

115
00:04:03,599 --> 00:04:04,640
firmware itself

116
00:04:04,640 --> 00:04:07,040
executing we can see the waiting loop

117
00:04:07,040 --> 00:04:08,080
and we can say

118
00:04:08,080 --> 00:04:11,040
cas encryptions in the time domain it's

119
00:04:11,040 --> 00:04:12,959
maybe easier to observe them because we

120
00:04:12,959 --> 00:04:14,879
can recognize the characteristic

121
00:04:14,879 --> 00:04:17,918
key schedule and the 10 rounds of

122
00:04:17,918 --> 00:04:21,120
aes so how is this

123
00:04:21,120 --> 00:04:23,680
possible well that's because the radio

124
00:04:23,680 --> 00:04:24,720
transmitter

125
00:04:24,720 --> 00:04:27,520
is a block which which uses analog radio

126
00:04:27,520 --> 00:04:28,080
frequency

127
00:04:28,080 --> 00:04:30,479
components which are very sensitive to

128
00:04:30,479 --> 00:04:32,880
noise and on the same silicon die

129
00:04:32,880 --> 00:04:35,280
we also have digital blocks like the

130
00:04:35,280 --> 00:04:37,520
processor and memory which use digital

131
00:04:37,520 --> 00:04:39,680
components digital signals which produce

132
00:04:39,680 --> 00:04:41,600
a lot of electromagnetic noise

133
00:04:41,600 --> 00:04:43,759
and since the two are on the same

134
00:04:43,759 --> 00:04:45,040
silicon die there are

135
00:04:45,040 --> 00:04:48,000
many many possible paths for propagation

136
00:04:48,000 --> 00:04:50,080
uh for example the power supply

137
00:04:50,080 --> 00:04:52,160
so that this noise flows from the

138
00:04:52,160 --> 00:04:54,400
digital part to the radio part

139
00:04:54,400 --> 00:04:57,440
and it end up ends up modulating

140
00:04:57,440 --> 00:05:00,000
the radio transmission so in general

141
00:05:00,000 --> 00:05:02,000
digital activity information about the

142
00:05:02,000 --> 00:05:03,759
digital activity of the chip

143
00:05:03,759 --> 00:05:06,240
becomes visible on the radio channel at

144
00:05:06,240 --> 00:05:08,160
a large distance from the device

145
00:05:08,160 --> 00:05:10,080
and for example if we look at crypto

146
00:05:10,080 --> 00:05:12,000
then we can mount sign channel attacks

147
00:05:12,000 --> 00:05:14,960
against cryptography

148
00:05:14,960 --> 00:05:17,600
with this uh initial idea explanation of

149
00:05:17,600 --> 00:05:19,759
the root cause and a first attack

150
00:05:19,759 --> 00:05:21,919
in a controlled environment but already

151
00:05:21,919 --> 00:05:23,039
at 10 meters

152
00:05:23,039 --> 00:05:26,639
we published a first paper at ccs

153
00:05:26,639 --> 00:05:29,280
and then we decided to investigate this

154
00:05:29,280 --> 00:05:30,720
noble leakage vector

155
00:05:30,720 --> 00:05:33,600
in detail to understand its peculiar

156
00:05:33,600 --> 00:05:34,800
characteristics but

157
00:05:34,800 --> 00:05:37,120
also to improve the attacks and make

158
00:05:37,120 --> 00:05:38,880
them more realistic

159
00:05:38,880 --> 00:05:41,759
and this paper uh we just published it

160
00:05:41,759 --> 00:05:42,400
at the

161
00:05:42,400 --> 00:05:44,400
chess this year i would like to thank

162
00:05:44,400 --> 00:05:45,919
all my co-authors

163
00:05:45,919 --> 00:05:48,960
marius monk sebastian poplar thomas

164
00:05:48,960 --> 00:05:53,359
and my supervisors aurelian francione

165
00:05:53,759 --> 00:05:56,960
so let's now dig into

166
00:05:56,960 --> 00:05:59,199
screaming channels trying to understand

167
00:05:59,199 --> 00:06:00,880
their characteristics

168
00:06:00,880 --> 00:06:04,639
more in detail intuitively our victim

169
00:06:04,639 --> 00:06:07,039
is the cpu here on the left on which the

170
00:06:07,039 --> 00:06:08,479
algorithm is running

171
00:06:08,479 --> 00:06:10,720
and normally usually in conventional

172
00:06:10,720 --> 00:06:12,720
side channels we place a near field

173
00:06:12,720 --> 00:06:13,360
probe

174
00:06:13,360 --> 00:06:15,120
very close to it with a very short

175
00:06:15,120 --> 00:06:17,280
channel to measure its electromagnetic

176
00:06:17,280 --> 00:06:19,600
emissions or its power consumption and

177
00:06:19,600 --> 00:06:21,120
break a cryptography

178
00:06:21,120 --> 00:06:24,000
instead streaming channel traces take a

179
00:06:24,000 --> 00:06:25,680
completely different path

180
00:06:25,680 --> 00:06:28,560
first they flow from the cpu to the

181
00:06:28,560 --> 00:06:30,000
radio transmitter

182
00:06:30,000 --> 00:06:32,720
and this can introduce could introduce a

183
00:06:32,720 --> 00:06:34,080
signal to signal-to-noise

184
00:06:34,080 --> 00:06:36,960
ratio changes it could distort the

185
00:06:36,960 --> 00:06:37,919
signal

186
00:06:37,919 --> 00:06:40,400
and then the transmitter picks up the

187
00:06:40,400 --> 00:06:41,120
signal

188
00:06:41,120 --> 00:06:42,960
up converts it to radio frequency

189
00:06:42,960 --> 00:06:45,120
amplifies it and broadcasts it through

190
00:06:45,120 --> 00:06:46,000
the antenna

191
00:06:46,000 --> 00:06:48,160
over the air so now the leakage goes

192
00:06:48,160 --> 00:06:49,759
through a radio channel

193
00:06:49,759 --> 00:06:51,280
which again could introduce

194
00:06:51,280 --> 00:06:53,120
signal-to-noise ratio changes

195
00:06:53,120 --> 00:06:54,960
or distortion and here many more

196
00:06:54,960 --> 00:06:56,479
parameters can change

197
00:06:56,479 --> 00:06:58,479
like the distance the setup that we use

198
00:06:58,479 --> 00:07:00,479
for reception the bluetooth low energy

199
00:07:00,479 --> 00:07:01,199
channel

200
00:07:01,199 --> 00:07:03,919
but most importantly the leakage is not

201
00:07:03,919 --> 00:07:04,720
sent

202
00:07:04,720 --> 00:07:06,560
intentionally on the channel

203
00:07:06,560 --> 00:07:08,319
continuously here we have that the

204
00:07:08,319 --> 00:07:10,479
leakage is sent at the same time

205
00:07:10,479 --> 00:07:13,039
as intentional data and the two have

206
00:07:13,039 --> 00:07:13,599
different

207
00:07:13,599 --> 00:07:17,280
or same modulation and the packets

208
00:07:17,280 --> 00:07:19,440
are sent a discrete instance of time

209
00:07:19,440 --> 00:07:20,800
they have a fixed length

210
00:07:20,800 --> 00:07:22,479
and they don't not necessarily

211
00:07:22,479 --> 00:07:24,479
synchronize with the encryptions

212
00:07:24,479 --> 00:07:27,039
finally uh since we're talking mostly

213
00:07:27,039 --> 00:07:29,759
about bluetooth low energy in this stock

214
00:07:29,759 --> 00:07:31,919
bluetooth low energy uses frequency

215
00:07:31,919 --> 00:07:33,360
hopping which means that

216
00:07:33,360 --> 00:07:35,680
the channel changes following absolute

217
00:07:35,680 --> 00:07:37,120
random sequence

218
00:07:37,120 --> 00:07:40,240
to avoid interference it's a form of

219
00:07:40,240 --> 00:07:43,440
spread spectrum um

220
00:07:43,440 --> 00:07:45,759
we have uh taken a bluetooth low energy

221
00:07:45,759 --> 00:07:46,560
device

222
00:07:46,560 --> 00:07:49,680
and studied it in uh detail uh i will

223
00:07:49,680 --> 00:07:52,080
not now focus on the methodology and on

224
00:07:52,080 --> 00:07:52,639
the

225
00:07:52,639 --> 00:07:54,479
experiments that we did that you can

226
00:07:54,479 --> 00:07:56,560
find in the chess paper but i will

227
00:07:56,560 --> 00:07:58,560
rather focus on the most interesting

228
00:07:58,560 --> 00:08:00,720
results especially those that are useful

229
00:08:00,720 --> 00:08:02,160
to improve the attacks

230
00:08:02,160 --> 00:08:04,560
so if we take one device and on this

231
00:08:04,560 --> 00:08:06,400
very same device we run

232
00:08:06,400 --> 00:08:08,560
conventional side channels and screaming

233
00:08:08,560 --> 00:08:10,479
channels we can observe that they have a

234
00:08:10,479 --> 00:08:12,800
comparable signal-to-noise ratio

235
00:08:12,800 --> 00:08:15,360
even though screaming traces uh have a

236
00:08:15,360 --> 00:08:16,400
higher power

237
00:08:16,400 --> 00:08:18,800
and can be let's say extracted with a

238
00:08:18,800 --> 00:08:20,080
much simpler setup

239
00:08:20,080 --> 00:08:21,360
than the one that we need for

240
00:08:21,360 --> 00:08:22,879
conventional side channels with

241
00:08:22,879 --> 00:08:25,759
amplifiers and special probes

242
00:08:25,759 --> 00:08:28,960
both leakages are first order but

243
00:08:28,960 --> 00:08:30,879
screaming channel leakages have a

244
00:08:30,879 --> 00:08:32,799
non-linear distortion which is

245
00:08:32,799 --> 00:08:35,120
probably introduced by the path between

246
00:08:35,120 --> 00:08:37,039
the digital and the radio part

247
00:08:37,039 --> 00:08:40,399
on the chip so with this in mind we find

248
00:08:40,399 --> 00:08:42,399
that the best attacks that we can run

249
00:08:42,399 --> 00:08:44,880
are profiled correlation attacks why

250
00:08:44,880 --> 00:08:45,760
because first

251
00:08:45,760 --> 00:08:48,000
they take a profiling set of traces and

252
00:08:48,000 --> 00:08:50,000
the ace then they estimate

253
00:08:50,000 --> 00:08:52,640
the function the leakage model between

254
00:08:52,640 --> 00:08:54,000
the variable that we want

255
00:08:54,000 --> 00:08:55,839
to discover in the cryptographic

256
00:08:55,839 --> 00:08:57,680
algorithm and the leakage

257
00:08:57,680 --> 00:08:59,839
and this can also be a non-linear like

258
00:08:59,839 --> 00:09:01,519
it is for streaming channels

259
00:09:01,519 --> 00:09:03,519
and then for an actual attack or for

260
00:09:03,519 --> 00:09:06,000
analysis what we take is an attack set

261
00:09:06,000 --> 00:09:07,760
and we measure the linear correlation

262
00:09:07,760 --> 00:09:09,680
between the traces in the attack set

263
00:09:09,680 --> 00:09:13,360
and those uh in the profile

264
00:09:13,360 --> 00:09:15,200
we have studied many different

265
00:09:15,200 --> 00:09:16,640
parameters how

266
00:09:16,640 --> 00:09:18,240
the signal changes with different

267
00:09:18,240 --> 00:09:20,959
parameters and we started with distance

268
00:09:20,959 --> 00:09:22,000
because distance is the

269
00:09:22,000 --> 00:09:24,720
most characteristic feature of screaming

270
00:09:24,720 --> 00:09:25,360
channels

271
00:09:25,360 --> 00:09:27,600
however actually distance doesn't have

272
00:09:27,600 --> 00:09:28,640
such a big

273
00:09:28,640 --> 00:09:32,240
impact on our on our attacks

274
00:09:32,240 --> 00:09:35,760
because what really matters is the noise

275
00:09:35,760 --> 00:09:36,959
in the environment the type of

276
00:09:36,959 --> 00:09:38,959
environment maybe reflections or noise

277
00:09:38,959 --> 00:09:40,240
from other devices

278
00:09:40,240 --> 00:09:42,640
and the setup how good is the setup for

279
00:09:42,640 --> 00:09:44,160
a given distance is the antenna

280
00:09:44,160 --> 00:09:46,720
directional do we use spatial diversity

281
00:09:46,720 --> 00:09:48,880
external amplifiers and so on and so

282
00:09:48,880 --> 00:09:51,839
forth so if we have a good setup

283
00:09:51,839 --> 00:09:53,279
adapted to the environment and the

284
00:09:53,279 --> 00:09:55,440
environment is not too harsh

285
00:09:55,440 --> 00:09:57,360
then we have we can get a very good

286
00:09:57,360 --> 00:10:00,240
correlation even at 10 meters we can get

287
00:10:00,240 --> 00:10:02,560
even better correlation than at 10

288
00:10:02,560 --> 00:10:04,480
centimeters if we use a better

289
00:10:04,480 --> 00:10:08,000
software-defined radio and correlation

290
00:10:08,000 --> 00:10:09,600
and distortion don't change with

291
00:10:09,600 --> 00:10:11,360
distance don't change with frequency

292
00:10:11,360 --> 00:10:13,360
don't change with device instance

293
00:10:13,360 --> 00:10:15,600
with this means that the the shape of

294
00:10:15,600 --> 00:10:17,040
the leakage the way

295
00:10:17,040 --> 00:10:20,399
the chip leaks is is mostly stable

296
00:10:20,399 --> 00:10:23,440
and similar and this

297
00:10:23,440 --> 00:10:26,880
lets us reuse profiles this is a big

298
00:10:26,880 --> 00:10:28,160
advantage we can

299
00:10:28,160 --> 00:10:30,000
let's imagine that we want to attack a

300
00:10:30,000 --> 00:10:32,000
device at 10 meters in a

301
00:10:32,000 --> 00:10:34,160
complex environment so what we will do

302
00:10:34,160 --> 00:10:35,760
is actually take a different

303
00:10:35,760 --> 00:10:38,079
device on which we have control we bring

304
00:10:38,079 --> 00:10:39,360
it in into a

305
00:10:39,360 --> 00:10:41,040
simple environment where there is not

306
00:10:41,040 --> 00:10:42,959
much noise maybe at short distance or

307
00:10:42,959 --> 00:10:44,000
even via cable

308
00:10:44,000 --> 00:10:46,240
we profile it and then we reuse this

309
00:10:46,240 --> 00:10:48,720
profile against this other device at 10

310
00:10:48,720 --> 00:10:49,279
meters

311
00:10:49,279 --> 00:10:51,040
that we want to attack and this is

312
00:10:51,040 --> 00:10:53,279
really a big advantage

313
00:10:53,279 --> 00:10:56,399
of streaming channels uh

314
00:10:56,399 --> 00:10:58,959
once we have uh learned so much more

315
00:10:58,959 --> 00:10:59,839
about

316
00:10:59,839 --> 00:11:02,480
how the channel works and how to exploit

317
00:11:02,480 --> 00:11:03,920
it with good attacks

318
00:11:03,920 --> 00:11:06,959
we looked into uh more challenging

319
00:11:06,959 --> 00:11:10,880
victims to attack so at with the ccs

320
00:11:10,880 --> 00:11:11,519
paper

321
00:11:11,519 --> 00:11:14,560
we had some attacks via cable at 10

322
00:11:14,560 --> 00:11:15,440
centimeters

323
00:11:15,440 --> 00:11:17,600
and even at 10 meters but in a

324
00:11:17,600 --> 00:11:19,360
controlled environment the anechoic

325
00:11:19,360 --> 00:11:21,440
chamber is basically

326
00:11:21,440 --> 00:11:24,640
protected from electromagnetic noise

327
00:11:24,640 --> 00:11:27,200
so for the chest paper we decided to

328
00:11:27,200 --> 00:11:28,160
make the environment

329
00:11:28,160 --> 00:11:30,880
more real and we first went into a home

330
00:11:30,880 --> 00:11:31,600
environment

331
00:11:31,600 --> 00:11:34,800
with many obstacles and we had an attack

332
00:11:34,800 --> 00:11:37,200
at of kill recovery attack at 55

333
00:11:37,200 --> 00:11:38,240
centimeters

334
00:11:38,240 --> 00:11:41,680
and we used the special diversity to

335
00:11:41,680 --> 00:11:44,240
take the reflections from different

336
00:11:44,240 --> 00:11:44,800
paths

337
00:11:44,800 --> 00:11:47,279
caused by the obstacles then we went

338
00:11:47,279 --> 00:11:49,200
into an office in a corridor

339
00:11:49,200 --> 00:11:51,440
and we decided to push the distance at

340
00:11:51,440 --> 00:11:52,399
which the attack

341
00:11:52,399 --> 00:11:55,040
is possible so we reached 10 meters but

342
00:11:55,040 --> 00:11:57,200
this time in a realistic environment

343
00:11:57,200 --> 00:12:00,079
and then even 15 meters but i have to

344
00:12:00,079 --> 00:12:00,800
say that

345
00:12:00,800 --> 00:12:04,240
at 15 meters the attack is really hard

346
00:12:04,240 --> 00:12:06,959
in the sense that tuning the setup to

347
00:12:06,959 --> 00:12:07,839
these conditions

348
00:12:07,839 --> 00:12:10,000
is really critical for example tuning

349
00:12:10,000 --> 00:12:12,079
the direction of the directional antenna

350
00:12:12,079 --> 00:12:13,600
calibrating the radio

351
00:12:13,600 --> 00:12:16,639
using external amplifiers so it took us

352
00:12:16,639 --> 00:12:19,440
several attempts to build a good attack

353
00:12:19,440 --> 00:12:19,920
set

354
00:12:19,920 --> 00:12:22,959
at 15 meters what is very interesting is

355
00:12:22,959 --> 00:12:26,399
that we didn't even try to profile the

356
00:12:26,399 --> 00:12:29,040
device the victim device at 15 meters

357
00:12:29,040 --> 00:12:31,279
we just took a different device we built

358
00:12:31,279 --> 00:12:33,040
a profile via cable

359
00:12:33,040 --> 00:12:35,519
uh in a very convenient situation and

360
00:12:35,519 --> 00:12:36,880
then we reused it

361
00:12:36,880 --> 00:12:39,519
for the attack interestingly in the

362
00:12:39,519 --> 00:12:40,160
office

363
00:12:40,160 --> 00:12:42,959
we managed to observe a leakage with a

364
00:12:42,959 --> 00:12:43,680
t-test

365
00:12:43,680 --> 00:12:46,480
at the 40 meters i mean that looking at

366
00:12:46,480 --> 00:12:49,440
the difference between different traces

367
00:12:49,440 --> 00:12:51,839
corresponding to different keys we were

368
00:12:51,839 --> 00:12:54,079
we were able to see a signal

369
00:12:54,079 --> 00:12:57,120
the presence of a leakage and then at 60

370
00:12:57,120 --> 00:12:58,320
meters we were still

371
00:12:58,320 --> 00:13:01,200
able to extract aes traces in the sense

372
00:13:01,200 --> 00:13:02,720
of being able to observe

373
00:13:02,720 --> 00:13:05,200
one uh encryption and extract the

374
00:13:05,200 --> 00:13:08,320
corresponding trace

375
00:13:08,320 --> 00:13:11,600
here is uh an example of the attack in

376
00:13:11,600 --> 00:13:13,120
the office you can see the picture just

377
00:13:13,120 --> 00:13:14,480
to get an idea

378
00:13:14,480 --> 00:13:16,720
and the number of traces that we used

379
00:13:16,720 --> 00:13:18,639
and also you can observe in the scheme

380
00:13:18,639 --> 00:13:20,079
on the right that there were

381
00:13:20,079 --> 00:13:22,720
a lot of other devices and rooms and

382
00:13:22,720 --> 00:13:25,120
offices around

383
00:13:25,120 --> 00:13:28,240
here instead i put a scheme of the

384
00:13:28,240 --> 00:13:31,120
attack at home with special diversity so

385
00:13:31,120 --> 00:13:33,279
the idea is that the signal would take

386
00:13:33,279 --> 00:13:35,519
different paths and these different

387
00:13:35,519 --> 00:13:37,760
paths have uncorrelated noise

388
00:13:37,760 --> 00:13:39,839
so if we use more than one antenna and

389
00:13:39,839 --> 00:13:41,040
we pick these uh

390
00:13:41,040 --> 00:13:43,279
signals uh separately then we can

391
00:13:43,279 --> 00:13:44,320
combine them

392
00:13:44,320 --> 00:13:47,120
and remove the noise and improve the

393
00:13:47,120 --> 00:13:49,360
signal-to-noise ratio so that an attack

394
00:13:49,360 --> 00:13:51,519
is still possible despite uh the

395
00:13:51,519 --> 00:13:53,920
obstacles in the middle

396
00:13:53,920 --> 00:13:56,399
in general uh for screaming channels a

397
00:13:56,399 --> 00:13:57,199
lot of

398
00:13:57,199 --> 00:13:59,600
uh radio communication techniques can be

399
00:13:59,600 --> 00:14:00,800
used and leveraged

400
00:14:00,800 --> 00:14:04,560
to improve the attacks we also looked

401
00:14:04,560 --> 00:14:07,600
into the hardware aes block

402
00:14:07,600 --> 00:14:09,600
why because the hardware aes block is

403
00:14:09,600 --> 00:14:11,440
used in many applications

404
00:14:11,440 --> 00:14:13,920
including link layer encryption

405
00:14:13,920 --> 00:14:16,240
unfortunately the hardware aes block

406
00:14:16,240 --> 00:14:18,639
doesn't leak as much as the cpu because

407
00:14:18,639 --> 00:14:21,199
it's a dedicated hardware module

408
00:14:21,199 --> 00:14:23,279
so we can't see the internal

409
00:14:23,279 --> 00:14:24,800
computations with the

410
00:14:24,800 --> 00:14:27,600
key and the plain text but we were still

411
00:14:27,600 --> 00:14:29,120
able to observe

412
00:14:29,120 --> 00:14:32,000
transfers transfers of key plaintext and

413
00:14:32,000 --> 00:14:33,440
ciphertext bytes

414
00:14:33,440 --> 00:14:36,480
both in firmware uh doing a mm copy

415
00:14:36,480 --> 00:14:39,839
and in hardware doing a dma to bring

416
00:14:39,839 --> 00:14:41,199
the plaintext and the key from one

417
00:14:41,199 --> 00:14:43,600
location to the peripheral

418
00:14:43,600 --> 00:14:45,839
so in this case it is possible to run

419
00:14:45,839 --> 00:14:46,720
some kind of

420
00:14:46,720 --> 00:14:49,040
side channel attacks called simple power

421
00:14:49,040 --> 00:14:50,560
analysis attacks

422
00:14:50,560 --> 00:14:53,600
but uh we were not able to fully extract

423
00:14:53,600 --> 00:14:56,000
the plain text or the key yet but this

424
00:14:56,000 --> 00:14:57,760
is a very promising

425
00:14:57,760 --> 00:14:59,600
direction for attacking this kind of

426
00:14:59,600 --> 00:15:01,760
block

427
00:15:01,760 --> 00:15:05,519
so after doing attacks in a more complex

428
00:15:05,519 --> 00:15:06,240
environment

429
00:15:06,240 --> 00:15:08,880
and against a more complex target we

430
00:15:08,880 --> 00:15:10,000
decided to look

431
00:15:10,000 --> 00:15:13,040
at real device it's a real system

432
00:15:13,040 --> 00:15:15,680
and we focused on google eddystone

433
00:15:15,680 --> 00:15:17,360
beacons what what are they

434
00:15:17,360 --> 00:15:20,399
they're simple devices very small that

435
00:15:20,399 --> 00:15:23,440
continuously emit some beacons some

436
00:15:23,440 --> 00:15:25,680
bluetooth low energy packets containing

437
00:15:25,680 --> 00:15:26,800
some information

438
00:15:26,800 --> 00:15:30,160
about the place or object

439
00:15:30,160 --> 00:15:32,320
where they are so for example if they

440
00:15:32,320 --> 00:15:34,160
are placed on a museum or story on a

441
00:15:34,160 --> 00:15:34,720
monument

442
00:15:34,720 --> 00:15:37,759
they would transmit

443
00:15:37,759 --> 00:15:41,040
the url of the museum they were really

444
00:15:41,040 --> 00:15:41,440
used

445
00:15:41,440 --> 00:15:45,120
for many applications iot applications

446
00:15:45,120 --> 00:15:46,959
and ideas like the physical web or

447
00:15:46,959 --> 00:15:48,800
proximity marketing

448
00:15:48,800 --> 00:15:52,079
and they are still available

449
00:15:52,079 --> 00:15:55,920
in commerce since they they transmit

450
00:15:55,920 --> 00:15:57,120
some fixed information

451
00:15:57,120 --> 00:15:59,440
they need to be configured and the owner

452
00:15:59,440 --> 00:16:00,399
can connect

453
00:16:00,399 --> 00:16:03,040
to the device and authenticate and then

454
00:16:03,040 --> 00:16:04,720
configure the device

455
00:16:04,720 --> 00:16:07,600
so as you can see they were designed

456
00:16:07,600 --> 00:16:08,160
with

457
00:16:08,160 --> 00:16:10,800
security and privacy in mind because

458
00:16:10,800 --> 00:16:13,120
telemetry data can be encrypted

459
00:16:13,120 --> 00:16:16,000
the id can be ephemeral to avoid

460
00:16:16,000 --> 00:16:16,880
tracking

461
00:16:16,880 --> 00:16:19,759
and the authentication is protected by a

462
00:16:19,759 --> 00:16:20,240
good

463
00:16:20,240 --> 00:16:24,000
authentication protocol using aes

464
00:16:24,000 --> 00:16:26,240
so let's have a look at this protocol a

465
00:16:26,240 --> 00:16:28,079
bit more in detail

466
00:16:28,079 --> 00:16:30,480
we have a beacon we have the owner they

467
00:16:30,480 --> 00:16:31,360
both know

468
00:16:31,360 --> 00:16:34,800
a pre-shared key if the owner wants to

469
00:16:34,800 --> 00:16:36,800
to authenticate to the device it first

470
00:16:36,800 --> 00:16:39,680
connects with via bluetooth then reads

471
00:16:39,680 --> 00:16:41,440
the unlock characteristic this is done

472
00:16:41,440 --> 00:16:41,839
at the

473
00:16:41,839 --> 00:16:44,399
let's say application layer uh the

474
00:16:44,399 --> 00:16:45,040
beacon

475
00:16:45,040 --> 00:16:47,680
as a response generates a random plain

476
00:16:47,680 --> 00:16:48,959
text random challenge

477
00:16:48,959 --> 00:16:51,920
p and sends it back to the owner then

478
00:16:51,920 --> 00:16:52,639
they both

479
00:16:52,639 --> 00:16:55,199
compute the as encryption with this

480
00:16:55,199 --> 00:16:57,360
challenge and the known pre-shared key

481
00:16:57,360 --> 00:16:59,519
and the owner sends it back to the

482
00:16:59,519 --> 00:17:01,600
beacon by writing to the unlock

483
00:17:01,600 --> 00:17:03,360
characteristic then the beacon can

484
00:17:03,360 --> 00:17:05,760
compare the two cipher texts and if they

485
00:17:05,760 --> 00:17:07,760
are the same this is the proof the owner

486
00:17:07,760 --> 00:17:08,799
was the right one

487
00:17:08,799 --> 00:17:11,039
and new depreciate key and then the

488
00:17:11,039 --> 00:17:12,079
owner becomes

489
00:17:12,079 --> 00:17:14,400
allowed to read and write more

490
00:17:14,400 --> 00:17:16,240
characteristics

491
00:17:16,240 --> 00:17:19,199
on the device let's now take the point

492
00:17:19,199 --> 00:17:19,760
of view

493
00:17:19,760 --> 00:17:23,359
of an attacker the attacker can trigger

494
00:17:23,359 --> 00:17:26,079
aes encryptions with known random

495
00:17:26,079 --> 00:17:26,880
plaintext

496
00:17:26,880 --> 00:17:29,440
and the unknown key by simply reading

497
00:17:29,440 --> 00:17:30,880
the unlock characteristic

498
00:17:30,880 --> 00:17:33,200
and this can be done over the air at a

499
00:17:33,200 --> 00:17:34,720
distance from the device

500
00:17:34,720 --> 00:17:36,000
and then since we were talking about

501
00:17:36,000 --> 00:17:38,480
streaming channel attacks the traces

502
00:17:38,480 --> 00:17:40,320
corresponding to these encryptions

503
00:17:40,320 --> 00:17:42,559
are visible on the radio channel over

504
00:17:42,559 --> 00:17:44,160
the air so the owner can both

505
00:17:44,160 --> 00:17:46,640
trigger and measure aes encryptions from

506
00:17:46,640 --> 00:17:48,799
a distance so this is a very interesting

507
00:17:48,799 --> 00:17:49,760
target for

508
00:17:49,760 --> 00:17:52,640
screaming channels

509
00:17:53,600 --> 00:17:56,320
unfortunately what happens is that this

510
00:17:56,320 --> 00:17:57,919
is a real example in which

511
00:17:57,919 --> 00:18:00,880
the devices use uh frequency hopping so

512
00:18:00,880 --> 00:18:02,880
there are 37 data channels and the

513
00:18:02,880 --> 00:18:04,160
frequency keeps

514
00:18:04,160 --> 00:18:06,480
changing and we need to follow it so we

515
00:18:06,480 --> 00:18:07,360
need to

516
00:18:07,360 --> 00:18:10,960
have let's say a faster radio or enough

517
00:18:10,960 --> 00:18:11,679
bandwidth

518
00:18:11,679 --> 00:18:14,080
and know the sequence this is very

519
00:18:14,080 --> 00:18:16,000
problematic for streaming channels but

520
00:18:16,000 --> 00:18:17,039
fortunately

521
00:18:17,039 --> 00:18:20,640
we had the idea to use a known standard

522
00:18:20,640 --> 00:18:22,559
feature of the protocol to block

523
00:18:22,559 --> 00:18:24,240
most of the channels this feature is the

524
00:18:24,240 --> 00:18:26,000
channel map and it's available to the

525
00:18:26,000 --> 00:18:27,440
attacker when it connects

526
00:18:27,440 --> 00:18:30,240
so now only two data channels are are

527
00:18:30,240 --> 00:18:30,799
used

528
00:18:30,799 --> 00:18:32,480
and the attacker can tune into one of

529
00:18:32,480 --> 00:18:34,240
them and mount

530
00:18:34,240 --> 00:18:37,039
streaming channel attacks so the threat

531
00:18:37,039 --> 00:18:38,320
model is this

532
00:18:38,320 --> 00:18:41,360
ability to trigger and measure

533
00:18:41,360 --> 00:18:43,360
as encryptions even if the device

534
00:18:43,360 --> 00:18:45,280
doesn't have physical access and was not

535
00:18:45,280 --> 00:18:46,720
protected against

536
00:18:46,720 --> 00:18:48,720
side channels for this reason we

537
00:18:48,720 --> 00:18:50,320
attacked a real

538
00:18:50,320 --> 00:18:52,799
implementation a real demo unmodified

539
00:18:52,799 --> 00:18:54,080
from the nordic sdk

540
00:18:54,080 --> 00:18:57,039
with optimized code hopping enabled but

541
00:18:57,039 --> 00:18:57,840
reduced

542
00:18:57,840 --> 00:19:00,160
using the channel map and aes

543
00:19:00,160 --> 00:19:02,320
implemented in software the tiny as

544
00:19:02,320 --> 00:19:03,440
implementation

545
00:19:03,440 --> 00:19:05,840
i want to say that the newer versions of

546
00:19:05,840 --> 00:19:06,960
the sdk

547
00:19:06,960 --> 00:19:09,120
use the hardware block so as of now they

548
00:19:09,120 --> 00:19:10,320
are not vulnerable

549
00:19:10,320 --> 00:19:13,600
to screaming channels our attack was uh

550
00:19:13,600 --> 00:19:14,240
was in

551
00:19:14,240 --> 00:19:16,480
simplified conditions we connected via

552
00:19:16,480 --> 00:19:18,240
cable like we did at the beginning with

553
00:19:18,240 --> 00:19:19,840
the other attacks

554
00:19:19,840 --> 00:19:22,080
but it already shows that a real

555
00:19:22,080 --> 00:19:24,080
protocol could be vulnerable to

556
00:19:24,080 --> 00:19:26,080
screaming channels and when we contacted

557
00:19:26,080 --> 00:19:26,720
google

558
00:19:26,720 --> 00:19:29,440
we obtained a google plug 100 program

559
00:19:29,440 --> 00:19:32,559
honorable mention for for this

560
00:19:32,559 --> 00:19:34,960
if screaming channels are a problem we

561
00:19:34,960 --> 00:19:36,480
need countermeasures

562
00:19:36,480 --> 00:19:38,480
and we're not talking about security

563
00:19:38,480 --> 00:19:40,880
devices which are a lot

564
00:19:40,880 --> 00:19:42,960
have a lot of resources and are designed

565
00:19:42,960 --> 00:19:44,880
to be secure like a smart card

566
00:19:44,880 --> 00:19:46,960
we have devices which are very

567
00:19:46,960 --> 00:19:49,200
constrained in term of cost for example

568
00:19:49,200 --> 00:19:49,679
so

569
00:19:49,679 --> 00:19:51,840
yes plastic counter measures in hardware

570
00:19:51,840 --> 00:19:53,280
and software would work

571
00:19:53,280 --> 00:19:55,440
but they are often too expensive and

572
00:19:55,440 --> 00:19:57,120
it's better to look at the specific

573
00:19:57,120 --> 00:19:58,320
countermeasures

574
00:19:58,320 --> 00:20:00,799
that for example turn off the radio

575
00:20:00,799 --> 00:20:02,480
during sensitive computations

576
00:20:02,480 --> 00:20:04,480
or use the hardware block at least for

577
00:20:04,480 --> 00:20:06,240
now so without being expensive they

578
00:20:06,240 --> 00:20:07,600
completely remove

579
00:20:07,600 --> 00:20:10,640
the channel itself at the hybrid level

580
00:20:10,640 --> 00:20:12,159
we could reduce the coupling between

581
00:20:12,159 --> 00:20:14,000
digital part and radio

582
00:20:14,000 --> 00:20:16,480
but that would be again expensive to

583
00:20:16,480 --> 00:20:18,400
design and to test

584
00:20:18,400 --> 00:20:21,039
so to conclude we have shown a generic

585
00:20:21,039 --> 00:20:21,600
problem

586
00:20:21,600 --> 00:20:23,679
the possibility to run remote side

587
00:20:23,679 --> 00:20:25,760
channel attacks well from a distance

588
00:20:25,760 --> 00:20:28,559
because a radio broadcast the leakage we

589
00:20:28,559 --> 00:20:30,640
have seen that this leakage is peculiar

590
00:20:30,640 --> 00:20:32,960
somehow it's easier to exploit because

591
00:20:32,960 --> 00:20:34,080
it's amplified

592
00:20:34,080 --> 00:20:36,080
but somehow it's harder to exploit

593
00:20:36,080 --> 00:20:37,679
because it's distorted

594
00:20:37,679 --> 00:20:40,159
and we have seen more and more realistic

595
00:20:40,159 --> 00:20:40,720
attacks

596
00:20:40,720 --> 00:20:43,120
so we need clever specific

597
00:20:43,120 --> 00:20:44,960
countermeasures

598
00:20:44,960 --> 00:20:46,720
we would like in the future to attack

599
00:20:46,720 --> 00:20:48,640
wi-fi and possibly

600
00:20:48,640 --> 00:20:51,520
the hardware block in aes we have

601
00:20:51,520 --> 00:20:52,799
published our code

602
00:20:52,799 --> 00:20:55,120
data and instructions so feel free to

603
00:20:55,120 --> 00:20:57,280
visit the webpage or to contact me if

604
00:20:57,280 --> 00:20:57,840
you want

605
00:20:57,840 --> 00:21:00,880
to uh ask questions or help you want

606
00:21:00,880 --> 00:21:01,520
help with

607
00:21:01,520 --> 00:21:04,159
replicating the results of the paper

608
00:21:04,159 --> 00:21:05,760
thank you very much for coming to this

609
00:21:05,760 --> 00:21:06,320
talk

610
00:21:06,320 --> 00:21:10,080
and i give back the

611
00:21:10,080 --> 00:21:17,840
thing to the organizers

612
00:21:19,679 --> 00:21:21,760
you

