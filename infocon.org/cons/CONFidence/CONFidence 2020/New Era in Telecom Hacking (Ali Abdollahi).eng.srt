1
00:00:15,360 --> 00:00:16,000
uh

2
00:00:16,000 --> 00:00:18,400
my friends i hope you are doing great

3
00:00:18,400 --> 00:00:19,920
and well

4
00:00:19,920 --> 00:00:23,279
uh welcome to my session

5
00:00:23,279 --> 00:00:26,720
uh first of all uh i want to introduce

6
00:00:26,720 --> 00:00:27,760
myself

7
00:00:27,760 --> 00:00:32,000
uh and thank you organizer and all

8
00:00:32,000 --> 00:00:34,160
sponsor for this support

9
00:00:34,160 --> 00:00:35,680
and this is my honor to speak at

10
00:00:35,680 --> 00:00:38,399
confidence so

11
00:00:38,399 --> 00:00:40,640
i'm ali abdullahi a cyber security

12
00:00:40,640 --> 00:00:41,680
enthusiast with

13
00:00:41,680 --> 00:00:44,160
over eight years of experience in

14
00:00:44,160 --> 00:00:45,600
variety of fields

15
00:00:45,600 --> 00:00:48,719
and uh i'm trying actually to make

16
00:00:48,719 --> 00:00:50,000
cyberspace

17
00:00:50,000 --> 00:00:53,520
a safer place i'm instructor at hacking9

18
00:00:53,520 --> 00:00:55,680
an active researcher and buck hunter and

19
00:00:55,680 --> 00:00:57,280
a regular speaker

20
00:00:57,280 --> 00:01:00,480
and trainer at famous uh conferences

21
00:01:00,480 --> 00:01:00,879
like

22
00:01:00,879 --> 00:01:04,559
uh defcon elvas

23
00:01:04,559 --> 00:01:07,840
eastsides cocoon texas cyber summit

24
00:01:07,840 --> 00:01:11,840
and no name khan so uh

25
00:01:11,840 --> 00:01:13,840
in this presentation we're going to talk

26
00:01:13,840 --> 00:01:15,200
about uh

27
00:01:15,200 --> 00:01:18,880
actually a hot topic uh

28
00:01:18,880 --> 00:01:20,400
and we are going to take a look at

29
00:01:20,400 --> 00:01:21,920
mobile network which used

30
00:01:21,920 --> 00:01:24,840
by mobile operators and many other

31
00:01:24,840 --> 00:01:26,479
entities

32
00:01:26,479 --> 00:01:28,960
and this area of test contains many

33
00:01:28,960 --> 00:01:29,920
valuable

34
00:01:29,920 --> 00:01:33,360
information like uh subscriber unique

35
00:01:33,360 --> 00:01:34,320
information

36
00:01:34,320 --> 00:01:37,840
phone numbers user location etc

37
00:01:37,840 --> 00:01:40,079
the important thing is in this stock

38
00:01:40,079 --> 00:01:42,079
that what we are going to review

39
00:01:42,079 --> 00:01:44,960
is all possible bypassing methods and

40
00:01:44,960 --> 00:01:46,880
bringing security mechanisms

41
00:01:46,880 --> 00:01:49,040
and i think you may heard much more

42
00:01:49,040 --> 00:01:51,360
about telecom and ss7 vulnerabilities

43
00:01:51,360 --> 00:01:52,640
and hacking before

44
00:01:52,640 --> 00:01:55,759
so i decided to talk about new things

45
00:01:55,759 --> 00:01:56,719
and topics

46
00:01:56,719 --> 00:01:59,439
in this presentation already let's get

47
00:01:59,439 --> 00:02:01,520
it

48
00:02:05,520 --> 00:02:07,200
actually there are many security

49
00:02:07,200 --> 00:02:08,878
incidents and news

50
00:02:08,878 --> 00:02:11,599
about uh vulnerabilities and hacking

51
00:02:11,599 --> 00:02:13,599
mobile infrastructures

52
00:02:13,599 --> 00:02:17,440
including protocols like ss7

53
00:02:17,440 --> 00:02:20,480
communications and interconnections

54
00:02:20,480 --> 00:02:23,680
in the top left corner there is a news

55
00:02:23,680 --> 00:02:25,200
regarding attacking

56
00:02:25,200 --> 00:02:29,360
financial organization and atm infection

57
00:02:29,360 --> 00:02:33,360
by exploiting ss7 protocol which is

58
00:02:33,360 --> 00:02:37,519
one of the most and most usable

59
00:02:37,519 --> 00:02:41,760
protocol in telecom infrastructure

60
00:02:41,760 --> 00:02:45,200
in this case hackers uh actually try to

61
00:02:45,200 --> 00:02:48,640
intercept uh authorized payment phone

62
00:02:48,640 --> 00:02:51,760
sms to exploit them because one of the

63
00:02:51,760 --> 00:02:53,280
most usable attacks

64
00:02:53,280 --> 00:02:56,720
is sms interception

65
00:02:56,720 --> 00:03:00,080
and spoofing actually in the lower left

66
00:03:00,080 --> 00:03:03,519
corner you can see a news about abusing

67
00:03:03,519 --> 00:03:07,680
telecom protocol to target uk metro bank

68
00:03:07,680 --> 00:03:11,120
in 2019 in this scenario

69
00:03:11,120 --> 00:03:14,720
hikers actually tracked and intercept

70
00:03:14,720 --> 00:03:17,440
text messages to get unauthorized access

71
00:03:17,440 --> 00:03:18,400
to banking

72
00:03:18,400 --> 00:03:22,000
accounts and in the top right

73
00:03:22,000 --> 00:03:25,120
corner you can find another news

74
00:03:25,120 --> 00:03:26,319
regarding

75
00:03:26,319 --> 00:03:29,480
fixing ss7 and telecom

76
00:03:29,480 --> 00:03:32,959
vulnerabilities in united states which

77
00:03:32,959 --> 00:03:33,760
would be

78
00:03:33,760 --> 00:03:36,360
very helpful to secure the

79
00:03:36,360 --> 00:03:37,519
communications

80
00:03:37,519 --> 00:03:42,480
and subscribers information

81
00:03:42,480 --> 00:03:45,599
so the last one is news about sending

82
00:03:45,599 --> 00:03:46,640
tweets

83
00:03:46,640 --> 00:03:50,400
using sms which patched by twitter

84
00:03:50,400 --> 00:03:53,680
to avoid unwanted and harmful tweets and

85
00:03:53,680 --> 00:03:54,640
combating

86
00:03:54,640 --> 00:04:00,239
malicious actors

87
00:04:00,239 --> 00:04:03,599
so now the question is that

88
00:04:03,599 --> 00:04:07,040
what types of attacks and uh

89
00:04:07,040 --> 00:04:11,040
telecom based vulnerabilities uh

90
00:04:11,040 --> 00:04:14,959
are possible and turning subscribers

91
00:04:14,959 --> 00:04:18,399
and telecom networks and why they are

92
00:04:18,399 --> 00:04:19,279
important

93
00:04:19,279 --> 00:04:22,880
to us so the first is

94
00:04:22,880 --> 00:04:25,919
subscriber data locate is

95
00:04:25,919 --> 00:04:29,199
a vital part for uh every security

96
00:04:29,199 --> 00:04:31,199
experts and telecom experts

97
00:04:31,199 --> 00:04:34,560
to set up their next steps and scenarios

98
00:04:34,560 --> 00:04:38,880
and in in this part of the scenario a

99
00:04:38,880 --> 00:04:42,639
hacker will retrieve subscribers nc

100
00:04:42,639 --> 00:04:45,840
number and other stuff as you know

101
00:04:45,840 --> 00:04:49,759
bmc number is one of vital information

102
00:04:49,759 --> 00:04:52,800
in telecommunication which is unique for

103
00:04:52,800 --> 00:04:53,199
you

104
00:04:53,199 --> 00:04:55,600
for each mobile subscriber all around

105
00:04:55,600 --> 00:04:56,880
the world

106
00:04:56,880 --> 00:05:00,240
next one is network data leakage which

107
00:05:00,240 --> 00:05:00,720
is

108
00:05:00,720 --> 00:05:03,840
uh very important for a hacker

109
00:05:03,840 --> 00:05:06,560
to understand what's happening inside

110
00:05:06,560 --> 00:05:08,400
mobile core network

111
00:05:08,400 --> 00:05:11,600
and which kind of devices are in place

112
00:05:11,600 --> 00:05:12,880
actually

113
00:05:12,880 --> 00:05:16,240
so finding mobile subscribers location

114
00:05:16,240 --> 00:05:19,039
is of one of most critical issues based

115
00:05:19,039 --> 00:05:19,360
on

116
00:05:19,360 --> 00:05:22,240
this stack criminals can retrieve

117
00:05:22,240 --> 00:05:23,840
subscriber

118
00:05:23,840 --> 00:05:27,520
sell global identifier or cgi value

119
00:05:27,520 --> 00:05:30,560
and convert it to mobile country code

120
00:05:30,560 --> 00:05:33,680
a mobile network code location

121
00:05:33,680 --> 00:05:37,039
area code and cell id to find

122
00:05:37,039 --> 00:05:40,160
the actual sector uh on

123
00:05:40,160 --> 00:05:43,280
bts or um any kind of that like

124
00:05:43,280 --> 00:05:46,400
in node b which the subscriber connected

125
00:05:46,400 --> 00:05:46,880
to

126
00:05:46,880 --> 00:05:50,400
so it's very dangerous and

127
00:05:50,960 --> 00:05:53,680
sniffing uh actually is the next

128
00:05:53,680 --> 00:05:54,560
scenario

129
00:05:54,560 --> 00:05:56,880
which points to voice and sms

130
00:05:56,880 --> 00:05:58,880
interception

131
00:05:58,880 --> 00:06:02,000
uh sp think is another test case which

132
00:06:02,000 --> 00:06:03,280
is very interesting

133
00:06:03,280 --> 00:06:06,800
because if you take advantage of

134
00:06:06,800 --> 00:06:09,919
it as a hacker or

135
00:06:09,919 --> 00:06:13,120
uh maybe a pen tester you may perform a

136
00:06:13,120 --> 00:06:13,919
call with

137
00:06:13,919 --> 00:06:17,039
fake caller id or send an sms

138
00:06:17,039 --> 00:06:20,160
using fake number the last attack

139
00:06:20,160 --> 00:06:20,880
category

140
00:06:20,880 --> 00:06:23,919
is fraud and a hacker

141
00:06:23,919 --> 00:06:27,360
can perform malicious ussd based

142
00:06:27,360 --> 00:06:28,800
requests

143
00:06:28,800 --> 00:06:32,400
called redirection uh sim card profile

144
00:06:32,400 --> 00:06:36,159
swapping etc in this case

145
00:06:42,400 --> 00:06:45,520
so this is the actual

146
00:06:45,520 --> 00:06:47,600
mobile network architecture as you can

147
00:06:47,600 --> 00:06:48,960
see

148
00:06:48,960 --> 00:06:51,530
uh recover uh

149
00:06:51,530 --> 00:06:53,039
[Music]

150
00:06:53,039 --> 00:06:56,160
generations of mobile communication

151
00:06:56,160 --> 00:06:59,520
you can see 2g 3g and 4g network

152
00:06:59,520 --> 00:07:03,280
as you can see we have uh

153
00:07:03,280 --> 00:07:06,400
bts node b and e node b

154
00:07:06,400 --> 00:07:10,560
with bts working in 2g and gsm network

155
00:07:10,560 --> 00:07:14,720
node b working in 3g and umts based

156
00:07:14,720 --> 00:07:16,639
network as you can see

157
00:07:16,639 --> 00:07:19,919
the middle of the picture and enod b or

158
00:07:19,919 --> 00:07:21,360
evolve node b

159
00:07:21,360 --> 00:07:25,120
working as as like as bts

160
00:07:25,120 --> 00:07:28,560
in lte and 4g network so

161
00:07:28,560 --> 00:07:32,000
another important element is um

162
00:07:32,000 --> 00:07:35,520
bsc and rnc which is

163
00:07:35,520 --> 00:07:38,960
uh like psc in 2g

164
00:07:38,960 --> 00:07:42,160
and we have no esc or rnc in

165
00:07:42,160 --> 00:07:45,759
4g lte network it's directly connected

166
00:07:45,759 --> 00:07:46,560
to the core

167
00:07:46,560 --> 00:07:50,400
elements mme actually bsc and rnc is

168
00:07:50,400 --> 00:07:51,280
something like

169
00:07:51,280 --> 00:07:55,360
an aggregator and decided uh

170
00:07:55,360 --> 00:07:59,840
based on your uh actually

171
00:08:00,080 --> 00:08:03,360
data data type like voice is it voice or

172
00:08:03,360 --> 00:08:03,919
is it

173
00:08:03,919 --> 00:08:06,720
internet data it's decided to move

174
00:08:06,720 --> 00:08:08,240
forward your

175
00:08:08,240 --> 00:08:10,879
request to the core network or packet

176
00:08:10,879 --> 00:08:12,720
data network as you can see

177
00:08:12,720 --> 00:08:16,160
coordinate ford uh called cs or circuit

178
00:08:16,160 --> 00:08:17,039
suite

179
00:08:17,039 --> 00:08:20,160
and a data network called packet switch

180
00:08:20,160 --> 00:08:23,520
or ps network

181
00:08:23,840 --> 00:08:27,759
however in lte we have all those

182
00:08:27,759 --> 00:08:31,680
elements together and um

183
00:08:31,680 --> 00:08:35,279
uh sgw act as sgsn

184
00:08:35,279 --> 00:08:39,200
in 3g and 2g and pgw or packet gate they

185
00:08:39,200 --> 00:08:40,399
act as ggs

186
00:08:40,399 --> 00:08:43,599
and uh 3g

187
00:08:43,599 --> 00:08:47,040
and sgw and i will be responsible for

188
00:08:47,040 --> 00:08:50,160
internet data internet connection

189
00:08:50,160 --> 00:08:53,360
and mme act as the most

190
00:08:53,360 --> 00:08:57,360
uh usable uh core element network

191
00:08:57,360 --> 00:09:00,399
like uh hlr and

192
00:09:00,399 --> 00:09:03,519
fss is something different and

193
00:09:03,519 --> 00:09:06,720
msc vlr and other elements

194
00:09:06,720 --> 00:09:10,800
put inside mme in one single elements in

195
00:09:10,800 --> 00:09:13,599
lte network

196
00:09:16,880 --> 00:09:20,839
so in this picture we have 5g

197
00:09:20,839 --> 00:09:24,000
architecture most of elements are

198
00:09:24,000 --> 00:09:27,600
different but from a hacker point of

199
00:09:27,600 --> 00:09:29,279
view

200
00:09:29,279 --> 00:09:32,720
vulnerabilities security flaws

201
00:09:32,720 --> 00:09:34,560
or opportunities in traditional

202
00:09:34,560 --> 00:09:36,080
technology are still

203
00:09:36,080 --> 00:09:39,680
available in 5g architecture as i

204
00:09:39,680 --> 00:09:41,120
mentioned at the beginning of the

205
00:09:41,120 --> 00:09:43,200
presentation

206
00:09:43,200 --> 00:09:46,480
please note that actually 5g network has

207
00:09:46,480 --> 00:09:48,399
its own vulnerabilities

208
00:09:48,399 --> 00:09:51,680
and because of ip backbone and software

209
00:09:51,680 --> 00:09:53,760
usage in this generation

210
00:09:53,760 --> 00:09:58,640
many other doors opened to hacker

211
00:10:02,839 --> 00:10:05,839
nowadays

212
00:10:07,839 --> 00:10:12,480
so now these are hacking scenarios

213
00:10:12,480 --> 00:10:15,839
uh in different

214
00:10:15,839 --> 00:10:19,839
uh categories

215
00:10:20,160 --> 00:10:25,279
so uh what is our vectors we're going to

216
00:10:25,279 --> 00:10:28,800
perform a hacking operation

217
00:10:28,800 --> 00:10:31,120
hacker point of view against mobile

218
00:10:31,120 --> 00:10:32,399
networks so

219
00:10:32,399 --> 00:10:35,519
the first uh category is

220
00:10:35,519 --> 00:10:39,680
mobile radio access network or ran

221
00:10:39,680 --> 00:10:42,480
this is very good choice because it is

222
00:10:42,480 --> 00:10:45,200
more accessible and easier whenever you

223
00:10:45,200 --> 00:10:47,839
turn on your phone actually you're

224
00:10:47,839 --> 00:10:48,720
dealing with

225
00:10:48,720 --> 00:10:51,839
a basis station and you are in radio

226
00:10:51,839 --> 00:10:53,279
access network

227
00:10:53,279 --> 00:10:56,720
the second vector is attacking a mobile

228
00:10:56,720 --> 00:10:58,720
or signaling core network

229
00:10:58,720 --> 00:11:01,839
which needs to have uh signaling and

230
00:11:01,839 --> 00:11:05,920
ss7 access so an attacker could gain

231
00:11:05,920 --> 00:11:07,920
unauthorized access to

232
00:11:07,920 --> 00:11:11,040
signaling network

233
00:11:11,040 --> 00:11:14,800
by officially maybe or from a dark web

234
00:11:14,800 --> 00:11:18,800
so you can find many uh ss7 access

235
00:11:18,800 --> 00:11:21,920
to buy in top inside dark web or maybe

236
00:11:21,920 --> 00:11:24,640
retrieve such an access from the network

237
00:11:24,640 --> 00:11:26,640
owner according to

238
00:11:26,640 --> 00:11:30,160
an official contract

239
00:11:30,160 --> 00:11:33,200
so the third vector and scenario

240
00:11:33,200 --> 00:11:36,480
is a data network which is very

241
00:11:36,480 --> 00:11:38,959
common and easy because most of the

242
00:11:38,959 --> 00:11:39,760
tanks

243
00:11:39,760 --> 00:11:43,839
can perform from the internet

244
00:11:46,560 --> 00:11:51,440
now i'm gonna talk about radio security

245
00:11:51,440 --> 00:11:53,680
so

246
00:11:55,120 --> 00:11:57,760
let's review all possible mechanisms in

247
00:11:57,760 --> 00:11:58,880
ran

248
00:11:58,880 --> 00:12:02,120
first is why device registration using

249
00:12:02,120 --> 00:12:05,519
imei which is a unique code based on

250
00:12:05,519 --> 00:12:06,079
your

251
00:12:06,079 --> 00:12:09,120
mobile device hardware second is

252
00:12:09,120 --> 00:12:11,279
enabling ciphering algorithms

253
00:12:11,279 --> 00:12:14,320
to fight against interception and many

254
00:12:14,320 --> 00:12:15,760
in the middle

255
00:12:15,760 --> 00:12:18,720
third item is using only lte and lt

256
00:12:18,720 --> 00:12:20,480
advanced infrastructure

257
00:12:20,480 --> 00:12:22,480
instead of traditional mobile core

258
00:12:22,480 --> 00:12:25,680
networks in 2g

259
00:12:31,360 --> 00:12:34,480
so here is a architecture of

260
00:12:34,480 --> 00:12:38,160
radio access network

261
00:12:38,160 --> 00:12:42,160
uh you can see

262
00:12:42,160 --> 00:12:45,200
there are uh some e nodes b's

263
00:12:45,200 --> 00:12:48,480
uh which uh points e and b

264
00:12:48,480 --> 00:12:52,160
and four e note b's and each eu tran

265
00:12:52,160 --> 00:12:56,240
uh stands for uh radio access networking

266
00:12:56,240 --> 00:12:58,880
lte and they're connected using s1

267
00:12:58,880 --> 00:13:01,680
interfaces to the core network

268
00:13:01,680 --> 00:13:04,880
mme or sgw if you want to

269
00:13:04,880 --> 00:13:09,360
uh actually deal with the internet data

270
00:13:09,360 --> 00:13:12,160
and they are connected to each other

271
00:13:12,160 --> 00:13:12,800
using

272
00:13:12,800 --> 00:13:16,959
x2 interfaces as you can see

273
00:13:19,440 --> 00:13:22,079
so mobile device registration or imei

274
00:13:22,079 --> 00:13:24,480
restriction policies

275
00:13:24,480 --> 00:13:27,600
uh so there is a question why we should

276
00:13:27,600 --> 00:13:28,079
use

277
00:13:28,079 --> 00:13:31,519
imei policy the answer is to fight

278
00:13:31,519 --> 00:13:34,720
against phone smuggling lawful

279
00:13:34,720 --> 00:13:37,040
and security monitoring and tracking

280
00:13:37,040 --> 00:13:38,639
stolen devices

281
00:13:38,639 --> 00:13:43,120
and also tracking criminals

282
00:13:44,800 --> 00:13:48,320
so here's the bypass first bypass method

283
00:13:48,320 --> 00:13:51,440
to bypass imei policy

284
00:13:51,440 --> 00:13:55,040
so uh okay

285
00:13:55,040 --> 00:13:58,720
with the help of a motorola c 115

286
00:13:58,720 --> 00:14:01,839
and 118

287
00:14:01,839 --> 00:14:04,480
osma company software we can set an

288
00:14:04,480 --> 00:14:06,160
invalid or fake

289
00:14:06,160 --> 00:14:09,839
or even duplicate imei and set up a call

290
00:14:09,839 --> 00:14:13,600
to test network reaction and behaviors

291
00:14:13,600 --> 00:14:16,959
so as requirements we need osmocambium

292
00:14:16,959 --> 00:14:17,920
sulfur

293
00:14:17,920 --> 00:14:21,880
and motorola c115 or

294
00:14:21,880 --> 00:14:24,880
c118

295
00:14:27,279 --> 00:14:30,560
according to the picture here uh network

296
00:14:30,560 --> 00:14:31,120
sent

297
00:14:31,120 --> 00:14:35,040
identity request to my phone

298
00:14:35,040 --> 00:14:38,320
and uh based on

299
00:14:38,320 --> 00:14:41,519
imei as you can see type of identity

300
00:14:41,519 --> 00:14:44,720
set to imei so me

301
00:14:44,720 --> 00:14:48,639
as mobile subscriber must reply with

302
00:14:48,639 --> 00:14:53,120
a valid imei value

303
00:14:53,920 --> 00:14:56,160
so

304
00:14:57,680 --> 00:15:00,959
as you can see in the shot here

305
00:15:00,959 --> 00:15:04,480
i replied to the network with an invalid

306
00:15:04,480 --> 00:15:06,000
imei

307
00:15:06,000 --> 00:15:10,639
set all zero so the network

308
00:15:10,839 --> 00:15:14,880
here accepted an invalid imei

309
00:15:14,880 --> 00:15:18,720
from uh my side and uh cyber framework

310
00:15:18,720 --> 00:15:19,839
completed so

311
00:15:19,839 --> 00:15:23,920
i can even set up a call or send an sms

312
00:15:23,920 --> 00:15:28,079
using an invalid imei set to all

313
00:15:28,079 --> 00:15:30,479
zero

314
00:15:32,480 --> 00:15:36,720
so ciphering key to avoid

315
00:15:36,720 --> 00:15:40,639
any kind of interception uh

316
00:15:40,639 --> 00:15:43,120
there are some different categories of

317
00:15:43,120 --> 00:15:44,399
cyphering keys like

318
00:15:44,399 --> 00:15:48,320
casey rand and asterisk a random number

319
00:15:48,320 --> 00:15:51,040
actually in radio access network which

320
00:15:51,040 --> 00:15:52,160
uh

321
00:15:52,160 --> 00:15:55,680
secure the radio network to avoid

322
00:15:55,680 --> 00:15:58,800
active skipping and they always store

323
00:15:58,800 --> 00:16:02,560
in hlr from home location

324
00:16:02,560 --> 00:16:06,079
uh for hss in 3g 4g

325
00:16:06,079 --> 00:16:08,639
which are which is the database of all

326
00:16:08,639 --> 00:16:10,560
subscribers data

327
00:16:10,560 --> 00:16:13,120
so this element it's a lot of justice is

328
00:16:13,120 --> 00:16:13,920
very important

329
00:16:13,920 --> 00:16:18,399
as i will give you a great demonstration

330
00:16:18,399 --> 00:16:22,560
in our next slide hss or hlr

331
00:16:22,560 --> 00:16:24,959
as subscriber database as i mentioned

332
00:16:24,959 --> 00:16:26,639
has components called

333
00:16:26,639 --> 00:16:30,720
auc or authentication center

334
00:16:30,720 --> 00:16:32,959
which responsible for ciphering and

335
00:16:32,959 --> 00:16:35,040
authentication procedures

336
00:16:35,040 --> 00:16:38,160
to bypass and get this information we

337
00:16:38,160 --> 00:16:39,920
are going to targeting

338
00:16:39,920 --> 00:16:43,199
authentication center inside hlr hss

339
00:16:43,199 --> 00:16:46,639
by abusing ss7 and signaling

340
00:16:46,639 --> 00:16:51,680
access as a roaming partner

341
00:16:51,680 --> 00:16:53,920
here

342
00:16:56,560 --> 00:16:58,959
we have two steps three main steps

343
00:16:58,959 --> 00:16:59,680
choosing

344
00:16:59,680 --> 00:17:02,959
different attack vector

345
00:17:03,279 --> 00:17:06,079
attacker hacker will be an intruder

346
00:17:06,079 --> 00:17:06,799
maybe or

347
00:17:06,799 --> 00:17:09,280
malicious roaming partner and our

348
00:17:09,280 --> 00:17:10,799
targeted element

349
00:17:10,799 --> 00:17:14,400
is authentication center or auc

350
00:17:14,400 --> 00:17:18,240
inside hlr hlr hss

351
00:17:18,240 --> 00:17:21,760
and so what

352
00:17:21,760 --> 00:17:24,319
is the exact point of procedures to

353
00:17:24,319 --> 00:17:26,000
perform this attack

354
00:17:26,000 --> 00:17:29,039
bypass actually

355
00:17:29,120 --> 00:17:32,320
as you can see i sent a malicious ss7

356
00:17:32,320 --> 00:17:33,039
map

357
00:17:33,039 --> 00:17:36,880
sent authentication info as you can see

358
00:17:36,880 --> 00:17:39,919
in the right hand side

359
00:17:40,080 --> 00:17:43,440
uh to the targeted core network from

360
00:17:43,440 --> 00:17:46,480
ss7 network to retrieve ciphering

361
00:17:46,480 --> 00:17:47,760
information

362
00:17:47,760 --> 00:17:50,799
and the network respond me

363
00:17:50,799 --> 00:17:54,240
using clear text values

364
00:17:54,240 --> 00:17:57,840
of random number estrus and kc ciphering

365
00:17:57,840 --> 00:17:58,559
key

366
00:17:58,559 --> 00:18:02,080
as you can see so by using this method

367
00:18:02,080 --> 00:18:05,360
of bypass i retrieve

368
00:18:05,360 --> 00:18:08,559
highly confidential uh

369
00:18:08,559 --> 00:18:12,559
ciphering information of a specific

370
00:18:12,559 --> 00:18:15,840
subscriber in mobile

371
00:18:19,039 --> 00:18:22,480
so the next one is using advanced mobile

372
00:18:22,480 --> 00:18:25,280
technologies

373
00:18:27,520 --> 00:18:30,880
like using lte and lt advanced 5g

374
00:18:30,880 --> 00:18:33,840
maybe to bring uh highest quality and

375
00:18:33,840 --> 00:18:35,200
performance

376
00:18:35,200 --> 00:18:39,679
uh having more privacy and security

377
00:18:39,679 --> 00:18:42,880
in radio segments and core network

378
00:18:42,880 --> 00:18:46,320
and other factors like uh voiceover lte

379
00:18:46,320 --> 00:18:47,360
volte

380
00:18:47,360 --> 00:18:51,918
for flexibility and other reasons

381
00:18:53,200 --> 00:18:57,760
so let's review uh

382
00:18:57,760 --> 00:19:01,600
one of our bypassing method in this area

383
00:19:01,600 --> 00:19:04,000
uh this is a general way and this is a

384
00:19:04,000 --> 00:19:05,760
general technique

385
00:19:05,760 --> 00:19:08,799
and to downgrading subscribers to

386
00:19:08,799 --> 00:19:11,280
traditional technologies to older

387
00:19:11,280 --> 00:19:14,400
generation like 2g and 3g

388
00:19:14,400 --> 00:19:17,760
which are vulnerable to perform

389
00:19:17,760 --> 00:19:20,080
downgrading we need to use a signal

390
00:19:20,080 --> 00:19:21,120
jammer

391
00:19:21,120 --> 00:19:25,840
as you can see here

392
00:19:27,420 --> 00:19:30,650
[Music]

393
00:19:33,450 --> 00:19:36,720
[Music]

394
00:19:36,720 --> 00:19:39,760
in a specific area and after that all

395
00:19:39,760 --> 00:19:40,799
victims

396
00:19:40,799 --> 00:19:43,280
downgraded to older technologies like

397
00:19:43,280 --> 00:19:44,880
umts and gsm which

398
00:19:44,880 --> 00:19:49,919
are uh more easier for hacker

399
00:19:49,919 --> 00:19:53,919
criminals to exploit and intercept

400
00:19:53,919 --> 00:19:58,720
the data of our victim in this scenario

401
00:19:59,919 --> 00:20:02,160
so

402
00:20:03,760 --> 00:20:06,960
uh voice over lte or

403
00:20:06,960 --> 00:20:10,799
volte so many of you talking

404
00:20:10,799 --> 00:20:13,840
using your voice or uh over

405
00:20:13,840 --> 00:20:17,360
lte uh your telecom

406
00:20:17,360 --> 00:20:20,799
and carrier functionality and experience

407
00:20:20,799 --> 00:20:24,080
a better quality of voice so

408
00:20:24,080 --> 00:20:27,760
you select voiceover lte

409
00:20:27,760 --> 00:20:31,120
and but recently some researchers

410
00:20:31,120 --> 00:20:34,400
found a security flaw inside volte

411
00:20:34,400 --> 00:20:35,840
technology

412
00:20:35,840 --> 00:20:38,960
the attack named rivolti

413
00:20:38,960 --> 00:20:42,480
which exploit the reuse of the same key

414
00:20:42,480 --> 00:20:43,039
stream

415
00:20:43,039 --> 00:20:46,559
for two subsequent calls within

416
00:20:46,559 --> 00:20:49,200
actually one radio connection this

417
00:20:49,200 --> 00:20:50,640
weakness is caused by

418
00:20:50,640 --> 00:20:53,360
an implementation flow of the base

419
00:20:53,360 --> 00:20:54,080
station

420
00:20:54,080 --> 00:20:57,520
in lte called enodb as i mentioned

421
00:20:57,520 --> 00:20:58,559
before

422
00:20:58,559 --> 00:21:01,840
to perform a revolt attack the attacker

423
00:21:01,840 --> 00:21:02,720
sniffs

424
00:21:02,720 --> 00:21:05,200
the encrypted radio traffic a victim

425
00:21:05,200 --> 00:21:06,320
within the cell

426
00:21:06,320 --> 00:21:10,090
of vulnerable

427
00:21:10,090 --> 00:21:12,720
[Music]

428
00:21:12,720 --> 00:21:16,000
enough b after the first call

429
00:21:16,000 --> 00:21:18,720
ends the attacker calls the victim and

430
00:21:18,720 --> 00:21:20,480
engages him in a conversation

431
00:21:20,480 --> 00:21:24,000
so uh they named this case key string

432
00:21:24,000 --> 00:21:24,720
call

433
00:21:24,720 --> 00:21:27,039
if you want to learn more about revolt

434
00:21:27,039 --> 00:21:28,320
attack

435
00:21:28,320 --> 00:21:31,600
you can visit this website

436
00:21:31,600 --> 00:21:36,799
and learn more about this vulnerability

437
00:21:36,799 --> 00:21:40,879
which is covered recently

438
00:21:42,080 --> 00:21:45,919
so now uh-huh the talk is going more hot

439
00:21:45,919 --> 00:21:49,919
and more interesting because we are uh

440
00:21:49,919 --> 00:21:52,880
going to have a deep dive inside core

441
00:21:52,880 --> 00:21:55,520
network

442
00:21:57,360 --> 00:22:00,720
so security in circuit street

443
00:22:00,720 --> 00:22:03,760
divided into using ss

444
00:22:03,760 --> 00:22:07,360
sms actually home routing or signaling

445
00:22:07,360 --> 00:22:10,000
firewalls

446
00:22:10,799 --> 00:22:13,679
i'm going to start with home routine so

447
00:22:13,679 --> 00:22:14,799
what is home routine

448
00:22:14,799 --> 00:22:18,240
actually home routing act as a proxy

449
00:22:18,240 --> 00:22:20,559
uh and the definition of home router is

450
00:22:20,559 --> 00:22:22,159
to hiding

451
00:22:22,159 --> 00:22:26,000
subscribers in c number which is very

452
00:22:26,000 --> 00:22:29,679
very valuable information to perform

453
00:22:29,679 --> 00:22:32,720
uh criminal scenarios from hacker

454
00:22:32,720 --> 00:22:37,840
point of view and as you can see

455
00:22:38,840 --> 00:22:41,840
here

456
00:22:42,159 --> 00:22:45,200
the hacker xss and the explorators

457
00:22:45,200 --> 00:22:48,880
respond with real value

458
00:22:48,880 --> 00:22:51,600
however home router change the value

459
00:22:51,600 --> 00:22:54,400
with the fake one

460
00:22:54,400 --> 00:22:58,159
so the real number ends with

461
00:22:58,159 --> 00:23:02,240
uh 9 0 1 however

462
00:23:02,240 --> 00:23:04,480
the change value is different and ends

463
00:23:04,480 --> 00:23:09,039
with 4 3 2 1.

464
00:23:09,039 --> 00:23:13,440
so how we can detect these mechanics

465
00:23:14,320 --> 00:23:17,840
uh you need just to send two or more

466
00:23:17,840 --> 00:23:20,880
same malicious ss7 messages

467
00:23:20,880 --> 00:23:24,080
like sri or sri for example

468
00:23:24,080 --> 00:23:28,320
something else and

469
00:23:28,320 --> 00:23:31,440
if you receive different responses it

470
00:23:31,440 --> 00:23:32,080
means that

471
00:23:32,080 --> 00:23:34,720
sms home router is in place as you can

472
00:23:34,720 --> 00:23:35,120
see

473
00:23:35,120 --> 00:23:37,200
where attacker received different

474
00:23:37,200 --> 00:23:38,320
responses as

475
00:23:38,320 --> 00:23:41,760
a mc number as an easy number of

476
00:23:41,760 --> 00:23:45,200
the same weak themes so sms rotary or

477
00:23:45,200 --> 00:23:46,400
home routine

478
00:23:46,400 --> 00:23:51,840
is in charge during this scenario

479
00:23:52,080 --> 00:23:55,360
okay bypassing

480
00:23:55,360 --> 00:23:59,360
so in uh mobile networks we have two

481
00:23:59,360 --> 00:24:02,480
types of beautiful titles of gt

482
00:24:02,480 --> 00:24:05,679
something like ip address uh

483
00:24:05,679 --> 00:24:09,039
msi sdn consists of a mobile account

484
00:24:09,039 --> 00:24:10,720
recorder mcc

485
00:24:10,720 --> 00:24:14,080
npc and sn which is a unique number

486
00:24:14,080 --> 00:24:17,679
c consists of mcc mnc

487
00:24:17,679 --> 00:24:20,000
and mobile network code as i mentioned

488
00:24:20,000 --> 00:24:21,440
before and msi n

489
00:24:21,440 --> 00:24:26,000
which is unique entity consists of

490
00:24:26,000 --> 00:24:29,279
mcc mobile country code and pc and msi

491
00:24:29,279 --> 00:24:32,799
as you can see in this case

492
00:24:32,799 --> 00:24:35,600
our thread actor can abuse entity number

493
00:24:35,600 --> 00:24:36,480
and a valid

494
00:24:36,480 --> 00:24:39,200
random enzyme number to request other

495
00:24:39,200 --> 00:24:41,120
information regarding the targeted

496
00:24:41,120 --> 00:24:42,159
mobile

497
00:24:42,159 --> 00:24:47,840
number and its real easy number

498
00:24:52,799 --> 00:24:55,918
signaling firewall

499
00:24:56,320 --> 00:25:00,320
so mobile operators and

500
00:25:00,320 --> 00:25:04,000
mno like and also nvnos your signaling

501
00:25:04,000 --> 00:25:05,360
fiber to protect

502
00:25:05,360 --> 00:25:09,679
their uh signaling ss7 and diameter sig

503
00:25:09,679 --> 00:25:11,360
train infrastructures

504
00:25:11,360 --> 00:25:14,640
uh signal packaging inspection filtering

505
00:25:14,640 --> 00:25:16,480
or deploying blacklisting or

506
00:25:16,480 --> 00:25:19,279
whitelisting

507
00:25:19,440 --> 00:25:23,840
so as you can see signaling firewall

508
00:25:23,840 --> 00:25:26,960
like other firewalls like

509
00:25:26,960 --> 00:25:29,039
application firewalls and layer 2

510
00:25:29,039 --> 00:25:30,159
fireballs

511
00:25:30,159 --> 00:25:35,600
detect and block malicious activities

512
00:25:35,600 --> 00:25:38,959
but here

513
00:25:39,440 --> 00:25:42,480
we are going to bypass signaling

514
00:25:42,480 --> 00:25:43,600
firewall

515
00:25:43,600 --> 00:25:46,880
and to bypass these variables we need

516
00:25:46,880 --> 00:25:48,240
just to play with

517
00:25:48,240 --> 00:25:52,400
tcap so what is pcap

518
00:25:52,400 --> 00:25:56,240
so tcap is a ss7 sub protocol and it's

519
00:25:56,240 --> 00:25:56,640
like

520
00:25:56,640 --> 00:26:00,400
tcp uh tcap enables deployment of

521
00:26:00,400 --> 00:26:02,480
advanced intelligent network services

522
00:26:02,480 --> 00:26:05,840
by supporting non-circuit related

523
00:26:05,840 --> 00:26:08,640
information exchange between signaling

524
00:26:08,640 --> 00:26:09,840
points using

525
00:26:09,840 --> 00:26:13,520
sccp which is connectionless service

526
00:26:13,520 --> 00:26:16,799
and tcap provides the framework to

527
00:26:16,799 --> 00:26:18,640
retrieve information

528
00:26:18,640 --> 00:26:23,600
or invoke remote remote operations

529
00:26:23,679 --> 00:26:27,360
and it offers uh for end users

530
00:26:27,360 --> 00:26:30,559
in ss7 network to query another

531
00:26:30,559 --> 00:26:33,360
and nodes and act as the software

532
00:26:33,360 --> 00:26:35,760
interface between ss7

533
00:26:35,760 --> 00:26:40,400
uh nodes and elements so

534
00:26:40,720 --> 00:26:43,360
to perform

535
00:26:45,279 --> 00:26:48,559
or biting from tcap or sending

536
00:26:48,559 --> 00:26:52,480
double operation message

537
00:26:52,480 --> 00:26:57,120
the application context name or asacn

538
00:26:57,120 --> 00:27:01,440
is used for all supported itu

539
00:27:01,440 --> 00:27:04,640
telecom standard itu tcap message

540
00:27:04,640 --> 00:27:07,840
except abort message no attempt to

541
00:27:07,840 --> 00:27:10,240
retrieve the acn is made for

542
00:27:10,240 --> 00:27:13,520
abort messages all other supported uh

543
00:27:13,520 --> 00:27:16,960
message may have a dialogue portion

544
00:27:16,960 --> 00:27:19,279
containing dialog requests

545
00:27:19,279 --> 00:27:22,480
unidirectional dialog dialog responses

546
00:27:22,480 --> 00:27:25,279
from which the acn is retrieved if no

547
00:27:25,279 --> 00:27:27,520
dialog portion is detected

548
00:27:27,520 --> 00:27:31,120
then the acn is assumed to be none

549
00:27:31,120 --> 00:27:33,440
so the tcap op code based routing

550
00:27:33,440 --> 00:27:34,799
feature attempt to

551
00:27:34,799 --> 00:27:38,720
find the operation code in all supported

552
00:27:38,720 --> 00:27:41,200
ticket message expect abortions are

553
00:27:41,200 --> 00:27:43,200
mentioned

554
00:27:43,200 --> 00:27:45,520
so this message must contain invoke and

555
00:27:45,520 --> 00:27:48,080
return results which points to our

556
00:27:48,080 --> 00:27:51,440
retrieved information and

557
00:27:51,440 --> 00:27:55,120
here is the whole scenario

558
00:27:56,960 --> 00:28:01,039
removing uh application context name

559
00:28:01,039 --> 00:28:04,240
from tcap message and to start the

560
00:28:04,240 --> 00:28:05,919
procedure we need

561
00:28:05,919 --> 00:28:08,559
to remove dialog request section from

562
00:28:08,559 --> 00:28:10,000
our malicious

563
00:28:10,000 --> 00:28:13,440
ss7 message then there will not

564
00:28:13,440 --> 00:28:16,080
application context name to point to

565
00:28:16,080 --> 00:28:20,158
malicious ss7 math method

566
00:28:23,200 --> 00:28:28,559
here using sending double operation

567
00:28:28,840 --> 00:28:31,039
message

568
00:28:31,039 --> 00:28:34,080
uh most of signaling variables

569
00:28:34,080 --> 00:28:37,520
actually block or accept a message based

570
00:28:37,520 --> 00:28:38,159
on

571
00:28:38,159 --> 00:28:41,279
message type so each signaling message

572
00:28:41,279 --> 00:28:42,080
has its own

573
00:28:42,080 --> 00:28:44,799
opcode or operation code and it's a real

574
00:28:44,799 --> 00:28:46,240
critical number

575
00:28:46,240 --> 00:28:48,720
and as you can see in the picture a

576
00:28:48,720 --> 00:28:52,159
hacker tried to put a legitimate ss7

577
00:28:52,159 --> 00:28:55,360
map message up code in the first step

578
00:28:55,360 --> 00:28:59,600
and then put a malicious

579
00:28:59,600 --> 00:29:03,760
ss7 here

580
00:29:04,799 --> 00:29:09,120
after a legitimate ss7 message

581
00:29:09,120 --> 00:29:13,520
there is a malicious ss7 message so

582
00:29:13,520 --> 00:29:16,320
in the first step hacker tried to put

583
00:29:16,320 --> 00:29:17,200
acn

584
00:29:17,200 --> 00:29:20,559
address and matches operation and after

585
00:29:20,559 --> 00:29:21,120
that

586
00:29:21,120 --> 00:29:24,000
the same area will begin and legitimate

587
00:29:24,000 --> 00:29:25,679
ss7 map message

588
00:29:25,679 --> 00:29:29,039
which is uh approved by signal any

589
00:29:29,039 --> 00:29:30,640
signaling for evolves

590
00:29:30,640 --> 00:29:34,399
and after that hacker try to put

591
00:29:34,399 --> 00:29:37,760
a message assistant so signaling

592
00:29:37,760 --> 00:29:38,720
fireball

593
00:29:38,720 --> 00:29:42,000
uh as a additional points and elements

594
00:29:42,000 --> 00:29:46,080
in telecommunication uh just check

595
00:29:46,080 --> 00:29:49,120
the first operation code

596
00:29:49,120 --> 00:29:51,360
and

597
00:29:52,640 --> 00:29:55,360
see it will say it seems legitimate

598
00:29:55,360 --> 00:29:55,919
message

599
00:29:55,919 --> 00:29:58,559
so there's no malicious behavior inside

600
00:29:58,559 --> 00:30:00,080
this message there is no

601
00:30:00,080 --> 00:30:03,760
sign of uh malicious action

602
00:30:03,760 --> 00:30:07,440
so the message would go to

603
00:30:07,440 --> 00:30:10,720
core network like hss hlr

604
00:30:10,720 --> 00:30:13,840
with a malicious operation code

605
00:30:13,840 --> 00:30:16,960
inside the message so

606
00:30:16,960 --> 00:30:22,159
in this case hlr hss or any other core

607
00:30:22,159 --> 00:30:24,799
network element

608
00:30:24,799 --> 00:30:28,000
read the full content of the message so

609
00:30:28,000 --> 00:30:28,480
it can

610
00:30:28,480 --> 00:30:32,399
understand what's inside the message

611
00:30:32,399 --> 00:30:35,520
it's not clear because we put

612
00:30:35,520 --> 00:30:38,399
two different options one of them was

613
00:30:38,399 --> 00:30:39,440
legitimate and

614
00:30:39,440 --> 00:30:42,960
other was malicious one so

615
00:30:42,960 --> 00:30:46,640
hlr says in this case as an example

616
00:30:46,640 --> 00:30:50,000
uh asked to receive

617
00:30:50,000 --> 00:30:53,360
the message again so 695

618
00:30:53,360 --> 00:30:56,080
still think that the session the whole

619
00:30:56,080 --> 00:30:56,880
session

620
00:30:56,880 --> 00:31:00,480
between hacker network element

621
00:31:00,480 --> 00:31:03,600
and targeted network element is still

622
00:31:03,600 --> 00:31:07,679
legitimate and keep the session

623
00:31:07,679 --> 00:31:12,000
and the hacker as a request point

624
00:31:12,000 --> 00:31:15,279
must try it again and this is the actual

625
00:31:15,279 --> 00:31:16,000
point

626
00:31:16,000 --> 00:31:20,000
hacker wants that hacker wants

627
00:31:20,000 --> 00:31:22,320
this legitimate session this open

628
00:31:22,320 --> 00:31:24,080
session without any other

629
00:31:24,080 --> 00:31:27,519
interception and uh

630
00:31:27,519 --> 00:31:31,279
operation on our mel on his malicious

631
00:31:31,279 --> 00:31:34,640
uh actually uh behavior

632
00:31:34,640 --> 00:31:38,000
so hacker say thanks and this is

633
00:31:38,000 --> 00:31:39,760
actually i want

634
00:31:39,760 --> 00:31:42,960
and uh i want subscriber information

635
00:31:42,960 --> 00:31:43,279
like

636
00:31:43,279 --> 00:31:46,320
mc number like uh cell global

637
00:31:46,320 --> 00:31:49,840
identifier or anything else uh

638
00:31:49,840 --> 00:31:52,720
as you can see hlr hss or any other

639
00:31:52,720 --> 00:31:53,760
elements

640
00:31:53,760 --> 00:31:56,399
uh will respond with subscriber mc

641
00:31:56,399 --> 00:31:57,039
number

642
00:31:57,039 --> 00:32:00,399
and any other network information like a

643
00:32:00,399 --> 00:32:04,080
subsystem number like internal gts and

644
00:32:04,080 --> 00:32:05,039
point

645
00:32:05,039 --> 00:32:07,840
so these information are vital for a

646
00:32:07,840 --> 00:32:08,799
hacker

647
00:32:08,799 --> 00:32:12,559
to set up next

648
00:32:13,039 --> 00:32:17,200
scenarios which are more dangerous

649
00:32:17,279 --> 00:32:19,840
so here's some highlights as i mentioned

650
00:32:19,840 --> 00:32:20,960
in past

651
00:32:20,960 --> 00:32:24,080
several years mobile operator and

652
00:32:24,080 --> 00:32:25,600
telecom

653
00:32:25,600 --> 00:32:28,230
providers turn against

654
00:32:28,230 --> 00:32:33,720
[Music]

655
00:32:33,919 --> 00:32:37,120
as i mentioned during these slides

656
00:32:37,120 --> 00:32:40,080
so in this presentation i try to explain

657
00:32:40,080 --> 00:32:42,080
all possible security features

658
00:32:42,080 --> 00:32:45,200
and bypassing techniques in

659
00:32:45,200 --> 00:32:49,360
uh say all segments of a telecom

660
00:32:49,360 --> 00:32:52,399
network and infrastructure

661
00:32:52,399 --> 00:32:55,440
so we must consider security assessment

662
00:32:55,440 --> 00:32:57,519
and pen testing are very important

663
00:32:57,519 --> 00:33:00,080
because in these networks we are dealing

664
00:33:00,080 --> 00:33:02,320
with millions of user

665
00:33:02,320 --> 00:33:06,159
private data and uh be careful about

666
00:33:06,159 --> 00:33:10,399
blind targeting

667
00:33:10,399 --> 00:33:13,120
buy uh some security solutions security

668
00:33:13,120 --> 00:33:15,200
appliance or software because they are

669
00:33:15,200 --> 00:33:16,480
not fair enough

670
00:33:16,480 --> 00:33:19,840
we must have uh behavioral analysis

671
00:33:19,840 --> 00:33:21,279
and continuous monitoring as

672
00:33:21,279 --> 00:33:25,840
complementary solutions

673
00:33:26,640 --> 00:33:28,960
you can be in touch with me to share our

674
00:33:28,960 --> 00:33:30,880
knowledge and experience

675
00:33:30,880 --> 00:33:33,440
and thank you for your attention i'm

676
00:33:33,440 --> 00:33:39,840
getting the microphone

677
00:33:39,919 --> 00:33:42,000
you

