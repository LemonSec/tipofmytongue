1
00:00:00,000 --> 00:00:05,000
so I'm not discounting these papers
their crate papers they talk about

2
00:00:05,000 --> 00:00:10,090
awesome techniques and procedures that
you can apply to other things but when

3
00:00:10,090 --> 00:00:14,490
you're talking about risk to an
organization 1 bypass for one

4
00:00:14,490 --> 00:00:24,410
application in one scenario is not
something I want to invest in a Java so

5
00:00:24,410 --> 00:00:28,939
we've we've dealt with all buffer
overflows and and heap overflows right

6
00:00:28,939 --> 00:00:34,460
all that's done you met protects us
against all of that right it's not an

7
00:00:34,460 --> 00:00:41,469
end all be all but it does a really good
job so what about jobs jobs kind of dead

8
00:00:41,469 --> 00:00:43,340
so I can actually skipped a lot

9
00:00:43,340 --> 00:00:47,370
but the reason why i wanna talk about it
a little bit is we're going back to that

10
00:00:47,370 --> 00:00:55,580
dirt road mentality me as an attacker
when I see when I do a fish and job was

11
00:00:55,580 --> 00:01:01,379
still prevalent couple years ago right
when I do if I see the first user agent

12
00:01:01,379 --> 00:01:08,560
come across as this browser anyone tell
me what this prosperous anyone know what

13
00:01:08,560 --> 00:01:17,200
a user agent is one person in the room
knows what a user ages ok we're gonna go

14
00:01:17,200 --> 00:01:33,530
really well here so this is a Firefox go
everything is Mozilla Wow 64 that means

15
00:01:33,530 --> 00:01:37,759
it's 64 or 32 bit now we got trolls

16
00:01:38,470 --> 00:01:48,050
died May 23 times about this application
about this operating system just by them

17
00:01:48,050 --> 00:01:53,070
surfing the web site that I've setup for
fishing I don't even have to capture

18
00:01:53,070 --> 00:01:56,800
credentials I don't have to exploit the
box I know everything I need to know

19
00:01:56,800 --> 00:02:02,509
about their browser right so the cool
thing is that once once the job of

20
00:02:02,510 --> 00:02:11,330
plug-in is enabled or or or triggered by
a job application the request for that

21
00:02:11,330 --> 00:02:17,410
application actually comes from the job
or process and the job a process has a

22
00:02:17,410 --> 00:02:27,019
different user agent so when I see this
summer crossed for this come across with

23
00:02:27,020 --> 00:02:32,930
this come across the inside of my web
blogs guess what I do I have this

24
00:02:32,930 --> 00:02:37,050
wonderful dynamic application for
fishing that says oh you're running this

25
00:02:37,050 --> 00:02:43,550
portable version of Java I will send you
this exploit its really simple what do

26
00:02:43,550 --> 00:02:47,930
you do on the defender side anything
that is an outdated version of Java

27
00:02:47,930 --> 00:02:55,010
block it at the proxy done so this
actually got this is a lot less

28
00:02:55,010 --> 00:02:59,600
effective these days because Chavez
basically blocked in every single

29
00:02:59,600 --> 00:03:05,480
browser but the mindset is still the
same start thinking about how an

30
00:03:05,480 --> 00:03:11,119
attacker sees things and focus on that
dirt road going to the point where where

31
00:03:11,120 --> 00:03:18,989
you can make effective protections and a
smaller scale that work better so that's

32
00:03:18,989 --> 00:03:23,670
what I see if they never see that there
were great and you will never see this

33
00:03:23,670 --> 00:03:27,018
before you just click OK

34
00:03:27,989 --> 00:03:31,950
mortals where the trolls and in the
other talks

35
00:03:33,240 --> 00:03:36,240
you guys just fine my talking going
we're gonna do this

36
00:03:37,430 --> 00:03:48,380
approved so this is what I used to talk
about is is blocking at the proxy

37
00:03:48,380 --> 00:03:54,260
because that was the only way you could
do it and the cool thing about this is

38
00:03:54,260 --> 00:03:59,790
that it worked in SLO as well right so
if you look at a proxy Log you see the

39
00:03:59,790 --> 00:04:03,150
user-agent still goes a crossed just
fine

40
00:04:03,150 --> 00:04:18,640
inside proxy logs for SSL traffic on
nafta alright so there's September 2014

41
00:04:18,640 --> 00:04:22,120
I it's on gordon says we're going to
block anything that Saturday

42
00:04:22,120 --> 00:04:29,030
patch Tuesday went around and things got
better than chrome said we're going to

43
00:04:29,030 --> 00:04:33,659
follow that same thing a year later and
said we're gonna stop all things from

44
00:04:33,660 --> 00:04:38,340
chrome are all Java plug-in stuff from
Chrome which is better than just

45
00:04:38,340 --> 00:04:41,340
outdated

46
00:04:47,340 --> 00:04:56,750
Firefox so if we got rid of if you got
rid of all of the Java stuff now what's

47
00:04:56,750 --> 00:04:59,139
next for your point of view what are we
doing that

48
00:04:59,139 --> 00:05:07,560
JavaScript c'mon lashes back

49
00:05:15,449 --> 00:05:30,529
ok see this whole wire thing doesn't
work so well alright so we got we got

50
00:05:30,529 --> 00:05:36,289
through the flash suffering and to
protect against / I don't really have

51
00:05:36,289 --> 00:05:37,400
anything for you

52
00:05:37,400 --> 00:05:42,580
it runs in the browser already so you
have to have a exploit for it what are

53
00:05:42,580 --> 00:05:49,839
the things that is much much more like
job than anything else in flash is Adobe

54
00:05:49,839 --> 00:05:55,210
AIR anyone ever heard of Adobe AIR yeah
so it'll be here

55
00:05:55,210 --> 00:06:01,349
runs as an executable on on your actual
web system right you know that right

56
00:06:01,349 --> 00:06:04,770
there is no pop up asking you that
you're you're wanting to run it you

57
00:06:04,770 --> 00:06:09,568
don't have to sign anything actually
better than better than jobs in that

58
00:06:09,569 --> 00:06:15,599
case the other thing about this Adobe
AIR thing is that it does the exact same

59
00:06:15,599 --> 00:06:22,719
stuff as Java it sends the request over
to the Adobe AIR application and

60
00:06:22,719 --> 00:06:28,029
plugging and then it pulls down the code
so you can protect it and the very same

61
00:06:28,029 --> 00:06:36,370
way that we did Java in the previous
slides ok so let's move on to some of my

62
00:06:36,370 --> 00:06:43,899
books on on current pen testing /
protections so this one is one of my

63
00:06:43,899 --> 00:06:50,449
favorite stories of all time I was
working as a stock analyst or search and

64
00:06:50,449 --> 00:06:55,939
Rab guy came along they hear all the
reports for Alltel things that we caught

65
00:06:55,939 --> 00:07:03,209
looking through the port weather.com
plugin weather.com plugin weather.com

66
00:07:03,209 --> 00:07:12,560
flogging removed removed to root PWD on
plugging her mood bTW dump removed from

67
00:07:12,560 --> 00:07:15,169
where ya yes sir

68
00:07:15,169 --> 00:07:20,729
the one that's sitting on the internet
so the guy was like yeah we got it we

69
00:07:20,729 --> 00:07:25,789
gotta removed does anyone here know what
Peter be dumped does except the people

70
00:07:25,789 --> 00:07:27,389
over here

71
00:07:27,389 --> 00:07:34,639
hashes hashes passwords basically in

72
00:07:34,639 --> 00:07:41,979
the broadest sense of the word so
password jumping to was on an IIS server

73
00:07:41,979 --> 00:07:56,748
and I got removed but that's ok we're
all good right and it's so so we started

74
00:07:56,749 --> 00:08:03,490
investigation or like it got there
somehow it was on that box somehow so

75
00:08:03,490 --> 00:08:10,020
one of the things that I i stress is
that while while a lot of a lot of teams

76
00:08:10,020 --> 00:08:16,469
turn this thing called the hips or host
intrusion prevention system or or AV

77
00:08:16,469 --> 00:08:28,779
they turn these things on but they they
they don't make them go into into actual

78
00:08:28,779 --> 00:08:35,070
protection mode so hips McAfee's the
biggest person in the in the world so

79
00:08:35,070 --> 00:08:39,130
everyone has McAfee's hips so I can say
that that's the application

80
00:08:39,649 --> 00:08:43,839
well the problem with that is that the
host Intrusion Prevention part never

81
00:08:43,839 --> 00:08:51,260
gets turned on its always disabled only
mood because it breaks a lot of stuff is

82
00:08:51,260 --> 00:08:57,870
your applications down it stops all
things from working however you can set

83
00:08:57,870 --> 00:09:04,760
up blocking on specific categories only
so they have an entire category of

84
00:09:04,760 --> 00:09:07,760
hacking tools turn that on

85
00:09:08,279 --> 00:09:18,640
so idiotic + was the only application
that did this this is my first gave this

86
00:09:18,640 --> 00:09:25,380
talk in 2014 it was the only one that
gave this is but there are a lot of a

87
00:09:25,380 --> 00:09:28,140
lot of systems and even PowerShell can
do this now

88
00:09:28,140 --> 00:09:39,040
logon alerting for valid logs anyone
actually on their home computer audit

89
00:09:39,040 --> 00:09:47,000
their successful long guns recorded

90
00:09:47,000 --> 00:09:57,640
so successful log onto something that
very very few organizations do more and

91
00:09:57,640 --> 00:10:04,100
more doing it these days but they don't
do very much so the the awesome been

92
00:10:04,100 --> 00:10:10,330
tested I did that had this enabled was
one of my biggest sales of all time

93
00:10:11,220 --> 00:10:16,790
so how this happened as I I got on nice
tits and a fish got the fish got into

94
00:10:16,790 --> 00:10:21,209
their application using Java was awesome
got my first started going around first

95
00:10:21,210 --> 00:10:24,950
box had two main admin on it done right

96
00:10:25,530 --> 00:10:29,520
dropped as has started dropped his
password or house at the time I don't

97
00:10:29,520 --> 00:10:34,819
know rumor which instead of going around
to different boxes it was like two

98
00:10:34,820 --> 00:10:40,240
o'clock in the morning cuz that's when
all the best pen testing happens on

99
00:10:40,240 --> 00:10:48,770
Friday of last day of the dentist so we
were going around and hitting box after

100
00:10:48,770 --> 00:10:57,600
box trying to find our are in goal and
this man had it set up through a tiara +

101
00:10:57,600 --> 00:11:02,520
so that whenever his account was used
more than one in more than one place

102
00:11:02,520 --> 00:11:08,160
within a five-minute period you got a
SMS alert about it he said this up it is

103
00:11:08,160 --> 00:11:13,140
self and he had the ability 3d on a
pledge to send an SMS back to reset his

104
00:11:13,140 --> 00:11:18,000
password automatically so all we did was
we woke up at two o'clock in the morning

105
00:11:18,000 --> 00:11:22,140
so I that happened sent him SMS
resetting the password to the next day

106
00:11:22,140 --> 00:11:27,500
came in and we were already stunted we
couldn't do anything we had we had not

107
00:11:27,500 --> 00:11:32,350
gotten any more access than he found his
broker got us out and that was it

108
00:11:32,980 --> 00:11:40,880
and all he did was roll over 2 a.m. and
sent a text that was his security it was

109
00:11:40,880 --> 00:11:41,570
awesome

110
00:11:41,570 --> 00:11:46,089
hips we've already talked about that
phone skinny I'm gonna get on a soapbox

111
00:11:46,089 --> 00:11:51,260
Omarion kind of a soap box on other
topics but also talks about this there

112
00:11:51,260 --> 00:11:56,010
are too many organizations these days
that you've on scanning shit hit the box

113
00:11:56,010 --> 00:11:58,030
to the venomous can and then send

114
00:11:58,030 --> 00:12:01,480
their vulnerability scan results
directly to the owners of those

115
00:12:01,480 --> 00:12:08,330
applications say hey go Pyxis you know
the problem is with that they don't care

116
00:12:10,550 --> 00:12:16,300
the application or only cares that it is
online they also have no idea what a

117
00:12:16,300 --> 00:12:25,599
buffer overflow means or does he might
have an idea but if it's Apache PHP

118
00:12:25,600 --> 00:12:32,500
vulnerability in XYZ plugin as their top
critical vulnerability they're going to

119
00:12:32,500 --> 00:12:34,890
last you off the stage

120
00:12:34,890 --> 00:12:40,180
why because that is a critical and on
RedHat they roll patches backwards in

121
00:12:40,180 --> 00:12:45,319
and then the Apache version doesn't look
the same and without actually analyzing

122
00:12:45,320 --> 00:12:53,330
what is in those reports you are doing
your entire company to service without

123
00:12:53,330 --> 00:12:57,550
looking at those before you send him off
the people say here are the actual

124
00:12:57,550 --> 00:13:00,800
exploitable things here are their
critical things that you need to look at

125
00:13:00,800 --> 00:13:04,530
yes it's going to take more time yes you
can't do the entire organization in a

126
00:13:04,530 --> 00:13:08,980
month or depending on the size of the
organization right you're going to have

127
00:13:08,980 --> 00:13:12,980
to explain that to your boss to say I'm
the world's can guy but I can't complete

128
00:13:12,980 --> 00:13:17,520
this an amount of time because I'm
actually doing analysis on it what you

129
00:13:17,520 --> 00:13:21,770
paid me to do that's gonna be hard
conversation but you need to have it if

130
00:13:21,770 --> 00:13:25,770
you're going to be a scanner the cool
thing about this is even if you're not a

131
00:13:25,770 --> 00:13:30,620
vulnerability scanning person or even if
you don't know exploit or any of that

132
00:13:30,620 --> 00:13:35,550
stuff or know how to exploit machines
the next time your Pinterest company

133
00:13:35,550 --> 00:13:39,469
comes around and say hey we're going to
start the dentist in about a month ago

134
00:13:39,470 --> 00:13:44,470
hold on hold on let me give you my
phones can there be like when I get up I

135
00:13:44,470 --> 00:13:50,350
get to know all the cool stuff that's
right here to tell us what's wonderful

136
00:13:50,350 --> 00:13:54,470
about an hour and a half to two hours
three hours however long it takes them

137
00:13:54,470 --> 00:13:59,180
to look at phones can they're going to
be able to tell you which things are

138
00:13:59,180 --> 00:14:04,550
exploitable they're gonna give you more
analysis on that one scan result than

139
00:14:04,550 --> 00:14:09,540
any of your guys good or maybe not like
depends on what skill set you guys have

140
00:14:09,540 --> 00:14:14,060
right in your organization but but
you're using that Penn testers time more

141
00:14:14,060 --> 00:14:19,550
effectively to go back to a question
that Erica earlier how do you how do you

142
00:14:19,550 --> 00:14:25,569
kill that animosity between red teamers
and the people who are ready they're

143
00:14:25,569 --> 00:14:33,389
trying to push the stuff I've had for
that what I do on a call is I go I know

144
00:14:33,389 --> 00:14:36,430
I know when I'm coming in as a
consultant what's what's the biggest

145
00:14:36,430 --> 00:14:39,180
issues that you're dealing with these
days what's what are you trying to push

146
00:14:39,180 --> 00:14:44,810
I will make sure that that's on my
report right and then now we're friends

147
00:14:44,810 --> 00:14:50,349
now we're friends now I'm pushing your
agenda now I might disagree with it and

148
00:14:50,350 --> 00:14:53,300
we'll talk back and forth on that and
I'm not going to blame except what

149
00:14:53,300 --> 00:14:58,008
you're asking me to do but making it so
that it's more collaborative piece is

150
00:14:58,009 --> 00:15:03,300
where we're where we need to go with
these things so get your sisters

151
00:15:03,300 --> 00:15:08,130
involved use their time wisely one of
things to talk about

152
00:15:08,709 --> 00:15:11,709
also skip it

153
00:15:13,750 --> 00:15:22,069
yeah crowdsourcing security with it so I
used to work for a company really large

154
00:15:22,069 --> 00:15:27,639
company fortune 1000 and we started a
really cool program that is totally not

155
00:15:27,639 --> 00:15:34,470
my idea but I'm stealing it and
proposing is my idea on these lights so

156
00:15:34,470 --> 00:15:39,529
what we did was inside the company we
had this program that's a day if you see

157
00:15:39,529 --> 00:15:43,939
a security incident physical digital any
security incident you've got points

158
00:15:48,120 --> 00:15:56,889
how much does it cost the company how
much 10 points as Casa company 0 total

159
00:15:56,889 --> 00:16:04,510
budget use $0 every single boss on the
planet will love that right so after

160
00:16:04,510 --> 00:16:11,380
after a while if after a month or two
months or whatever it person errors

161
00:16:11,380 --> 00:16:14,310
Asian got points and it became
competitive and once you have these

162
00:16:14,310 --> 00:16:18,520
points if you were the top three in our
organization or

163
00:16:18,520 --> 00:16:23,390
different business unit the top three
you got a letter from the president and

164
00:16:23,390 --> 00:16:28,890
owner of the company saying thank you
for your service to our company now for

165
00:16:28,890 --> 00:16:32,500
a lot of people that's awesome you can
put that in your resume to put that in

166
00:16:32,500 --> 00:16:33,560
your in here

167
00:16:33,560 --> 00:16:38,520
weekly or monthly review our yearly
review now you have something to go and

168
00:16:38,520 --> 00:16:42,980
say hey I did this I have this email
from the present company if that is not

169
00:16:42,980 --> 00:16:59,320
incentive for you there was also a Visa
gift card gift card was $100 it was $200

170
00:16:59,320 --> 00:17:03,740
for the second place and $300 for the
first place if you can get three hundred

171
00:17:03,740 --> 00:17:09,990
dollars in your pocket every single
quarter for just reporting a fish

172
00:17:09,990 --> 00:17:14,890
wouldn't you write even people who are
security people would love to just have

173
00:17:14,890 --> 00:17:22,440
you know a free gift card they cannot
tell the wife about Muse leader right so

174
00:17:22,440 --> 00:17:34,660
great thing is that now in our
competitive leaving gave badges how much

175
00:17:34,660 --> 00:17:40,820
does bad just cost it doesn't cost the
company anything so we gave badges for

176
00:17:40,820 --> 00:17:44,639
people who reported things we gave
physical security badges so if you if

177
00:17:44,640 --> 00:17:48,380
you notice that when tailgating you know
how many tailgating and incidents

178
00:17:48,380 --> 00:17:53,680
happened on the first quarter that we
institute this program thousands across

179
00:17:53,680 --> 00:17:58,220
the entire company thousands you know
how many happened after the after the

180
00:17:58,220 --> 00:18:05,200
second quarter one or two people would
actually go come back from lunch and

181
00:18:05,200 --> 00:18:13,850
watch for anyone trying to tailgate to
get points to get something for free so

182
00:18:13,850 --> 00:18:23,870
the cost of a breach is 100 million to 3
million 7,500,000 $500 quarter easy sell

183
00:18:23,870 --> 00:18:29,169
to all of your business corporate
executives and stuff really used to get

184
00:18:29,170 --> 00:18:31,450
going

185
00:18:31,450 --> 00:18:37,320
we r while I was there we we took this
to the next step we actually instituted

186
00:18:37,320 --> 00:18:42,830
internal bug bounty program we should we
said hey this is going so well we're

187
00:18:42,830 --> 00:18:49,710
giving points away all the time there
were gonna say hey if you see a problem

188
00:18:49,710 --> 00:18:54,809
in any one of our applications as you're
using them you can get points where to

189
00:18:54,809 --> 00:19:00,178
buy reporting that bug how many of you
in here have gone into some internal

190
00:19:00,179 --> 00:19:07,740
page to a school site or chew corporate
website or or something and it broke in

191
00:19:07,740 --> 00:19:13,419
some way and you saw sequel or you saw
some other error on the page and he went

192
00:19:13,419 --> 00:19:25,210
off that sucks it's broken and kept
going right for you guys if what we did

193
00:19:25,210 --> 00:19:28,610
was made it so that if you could if you
reported any of that we found we had the

194
00:19:28,610 --> 00:19:33,490
people you know that would take care of
that that's the important piece you when

195
00:19:33,490 --> 00:19:39,149
you have to employ a couple people under
help desk or whatever to look at these

196
00:19:39,149 --> 00:19:45,479
reports and validating so it does cost
money but usually from people that you

197
00:19:45,480 --> 00:19:48,480
already have

198
00:19:56,070 --> 00:20:02,280
moving on to another topic any parts
parts are funny I'm you get to watch

199
00:20:02,280 --> 00:20:08,310
attackers do stuff but trying to get a
honeypot into a corporate organization

200
00:20:08,310 --> 00:20:14,500
the size of Fortune 1050 is not gonna
happen I mean you have to be shooting

201
00:20:14,500 --> 00:20:20,880
rainbows out of places to be able to get
it to work or organ approved so one of

202
00:20:20,880 --> 00:20:25,160
the ways that we we work through this to
say hey we've gotten to the point where

203
00:20:25,160 --> 00:20:28,900
we do relatively good security when
wanna wanna see more of what the

204
00:20:28,900 --> 00:20:33,800
attackers doing is by setting up a WS
unlimited or

205
00:20:33,800 --> 00:20:38,510
yes sir or some GPS somewhere and then
on our corporate website on the

206
00:20:38,510 --> 00:20:47,010
company's main website we port forwarded
1433 force equal out to an AWS account

207
00:20:47,010 --> 00:20:53,460
so it was going into our corporate
network then the firewall was turning

208
00:20:53,460 --> 00:20:58,360
around to some other application on the
internet so we actually had a valid

209
00:20:58,360 --> 00:21:01,679
honey pot that never touched our
internal organization and looked like it

210
00:21:01,680 --> 00:21:02,720
was valid

211
00:21:02,720 --> 00:21:09,400
now the now the defenders got to look at
more of what the attackers were doing so

212
00:21:09,400 --> 00:21:12,850
we did this on a number of occasions a
number of different applications we had

213
00:21:12,850 --> 00:21:19,730
so there's a couple that we're only on
SL we put 80 on their stuff like that

214
00:21:19,730 --> 00:21:32,510
yes this is my favorite vulnerability of
all time it is built into Windows all

215
00:21:32,510 --> 00:21:38,510
the way up through windows 10 has anyone
ever seen that setting I guarantee this

216
00:21:38,510 --> 00:21:43,600
that at least 20 people in this room
right now are looking at their laptops

217
00:21:43,600 --> 00:21:49,699
ongoing yep it's because its default on
you know what happens when the settings

218
00:21:49,700 --> 00:21:57,990
default on your Windows application or
your Windows OS goes hey do I see anyone

219
00:21:57,990 --> 00:22:03,260
on my network called W pad guess what by
computers called

220
00:22:03,260 --> 00:22:09,090
W pad every single one of them actually
have an issue with his home because I

221
00:22:09,090 --> 00:22:13,770
forget to set the setting on my BM's and
then I can't get the internet for some

222
00:22:13,770 --> 00:22:19,830
reason and then I remember that all of
my computers are called W bad but this

223
00:22:19,830 --> 00:22:21,439
setting turned on

224
00:22:21,440 --> 00:22:25,350
looks for computer called W bad anywhere
you are on any network so your theory on

225
00:22:25,350 --> 00:22:33,010
gogo in-flight or Starbucks it will look
for me pad once it does this it then

226
00:22:33,010 --> 00:22:40,270
asks that server computer that says it's
too bad for proxy settings guess what my

227
00:22:40,270 --> 00:22:46,879
computer does provides the proxy
settings the great thing about this is

228
00:22:46,880 --> 00:22:51,080
that the CFAA the car Computer Fraud and
Abuse Act says that you were actually

229
00:22:51,080 --> 00:23:02,179
seeing my computer so you're the one
doing illegal stuff not me so as soon as

230
00:23:02,180 --> 00:23:06,530
I as soon as I provide those proxy
settings if I do anything but provide

231
00:23:06,530 --> 00:23:12,930
those proxy settings then I i get into
legal ramifications so how do you defend

232
00:23:12,930 --> 00:23:17,920
against this in your corporate network
make sure that you had actually has a

233
00:23:17,920 --> 00:23:25,260
DNS setting ipv6 they made it more
difficult to figure out its W W W bad

234
00:23:25,260 --> 00:23:35,950
Windows and Microsoft you're awesome
disable NetBIOS inside of the main this

235
00:23:35,950 --> 00:23:40,150
is a really hard one to get right
because every single user for every

236
00:23:40,150 --> 00:23:43,540
single computer so if you log into one
computer and then go to another one you

237
00:23:43,540 --> 00:23:47,810
have two different product yet different
settings for this NetBIOS needs to be

238
00:23:47,810 --> 00:23:52,690
turned off on everyone that's hard to do
there are some like stackoverflow in

239
00:23:52,690 --> 00:24:01,470
other settings to get this done but it's
really hard so everyone turned out to be

240
00:24:01,470 --> 00:24:06,220
bad now is if not my computers on the
network to

241
00:24:09,180 --> 00:24:15,760
DNS this is where I start getting jaws
drop DNS turn it off

242
00:24:15,760 --> 00:24:21,290
turn off the united in corporate
networks you can do this as long as you

243
00:24:21,290 --> 00:24:27,409
have a proxy and we all have proxies
right no unfortunate but a lot of other

244
00:24:27,410 --> 00:24:31,250
organizations don't want to go through
the hassle of dealing with making a

245
00:24:31,250 --> 00:24:35,520
proxy or or saying it so that's not
transparent guess what a transparent

246
00:24:35,520 --> 00:24:42,920
proxy is to an attacker transparent it
doesn't do anything so why do you have

247
00:24:42,920 --> 00:24:43,390
it

248
00:24:43,390 --> 00:24:48,610
well we would do well built during great
web filtering means I go to the web

249
00:24:48,610 --> 00:24:56,659
filtering company I go to their submit
Web Filter update I go then my evil

250
00:24:56,660 --> 00:25:05,200
attacker dot com website what kind of
category is it travel five minutes to an

251
00:25:05,200 --> 00:25:09,710
hour later they've updated it they've
come to my website I went to a point set

252
00:25:09,710 --> 00:25:16,210
expedia.com they go hit its travel I
then rewrote my website to something

253
00:25:16,210 --> 00:25:16,720
else

254
00:25:16,720 --> 00:25:24,200
Bob's your uncle your categorization is
awesome so how does this relate to

255
00:25:24,200 --> 00:25:33,010
Dennis genus prints for example when I
first started this big company I thought

256
00:25:33,010 --> 00:25:36,710
I was the biggest guy on the block I
thought I was awesome I was like hey

257
00:25:36,710 --> 00:25:43,160
guys check this out I just started
working on this this DNS based c2 you're

258
00:25:43,160 --> 00:25:47,650
never gonna see it goes over command
control over DNS it does a resolution

259
00:25:47,650 --> 00:25:54,240
all the way up and down the chain I
started running it didn't work all the

260
00:25:54,240 --> 00:26:01,560
other retailers are on the team relation
what's this like I got it could work

261
00:26:01,560 --> 00:26:10,080
it's awesome and they were just laughing
at me because in this in the entire

262
00:26:10,080 --> 00:26:16,159
fortune 10 company TNS didn't work it
resolved anything for Active Directory

263
00:26:16,160 --> 00:26:19,630
just fine but the Active Directory DNS
service did not have for dinner

264
00:26:19,630 --> 00:26:25,730
so how does this work how does how can
you survive without the internet works

265
00:26:25,730 --> 00:26:30,860
on DNS right what happened was their
proxy did all the DNS requests when you

266
00:26:30,860 --> 00:26:36,870
submit a request to the proxy server it
doesn't do the DNS requests first does

267
00:26:36,870 --> 00:26:44,320
it after for HDTV so problem solved so
the cool thing about this is that it

268
00:26:44,320 --> 00:26:49,179
kills in cut entire class of command
control that's getting more popular each

269
00:26:49,180 --> 00:26:54,690
day so if you turn off the in this
internally at least forwarding off any

270
00:26:54,690 --> 00:26:59,140
kind of seats you that they do so let's
say I'm an attack when I hit your

271
00:26:59,140 --> 00:27:03,360
organization in your DNS turned off I
sent over my awesome seats you based

272
00:27:03,360 --> 00:27:10,409
your DNS basie to i get 400 400 people
the clip all four hundred people click

273
00:27:10,410 --> 00:27:15,470
and run my binary guess what happens I
can't do anything so it doesn't matter

274
00:27:15,470 --> 00:27:20,020
if I get code execution and that's the
point of the stock is getting to the

275
00:27:20,020 --> 00:27:27,050
point where your users can click on what
ever they want wherever they want and it

276
00:27:27,050 --> 00:27:33,419
doesn't do anything on your vision or it
runs and I'm not cool enough to write i

277
00:27:33,420 --> 00:27:43,590
AI based see two batteries so anyone
recognize this logo

278
00:27:44,720 --> 00:27:47,720
this is directly stolen from someone
else

279
00:27:51,010 --> 00:27:58,010
the slightest trudeau like the reason
why I copied directly and ask permission

280
00:27:58,010 --> 00:28:03,480
first was that this slide is absolutely
true there's not an organization in the

281
00:28:03,480 --> 00:28:11,410
world even foreign ones try pen testing
a vision that different language than

282
00:28:11,410 --> 00:28:18,110
you and you try and go see Ed Cowan
ford's backslash like windows or tried

283
00:28:18,110 --> 00:28:23,379
to the system user it's all different
anyway

284
00:28:23,380 --> 00:28:28,010
but these were everywhere for some
reason it's a universal language to make

285
00:28:28,010 --> 00:28:29,890
your password

286
00:28:29,890 --> 00:28:40,610
welcome one no idea why so how do you
deal with this deal with this as a

287
00:28:40,610 --> 00:28:45,790
recession by getting your pen testers to
do your password audit you would not

288
00:28:45,790 --> 00:28:50,830
believe how Getty a pen tester will get
when they won independence you say here

289
00:28:50,830 --> 00:29:00,500
here's our domain controller like I want
you to a password on it you'll go you'll

290
00:29:00,500 --> 00:29:05,710
get him to say we actually know what
that word is cuz I got three kids but

291
00:29:05,710 --> 00:29:12,300
seriously they have so much fun and the
cool thing is that now they have

292
00:29:12,300 --> 00:29:20,260
passwords great now they can do more
fingers even faster are you benefit out

293
00:29:20,260 --> 00:29:27,490
of that right you just getting more out
of him so ask your pen tester comes if

294
00:29:27,490 --> 00:29:28,710
you can't do it yourself

295
00:29:28,710 --> 00:29:33,160
the cool thing is as part of our
reservations we set up a p.m. on a

296
00:29:33,160 --> 00:29:38,690
domain controller all had access to was
the domain controller it was like 12 one

297
00:29:38,690 --> 00:29:44,580
local host or hostess only three or
VirtualBox whatever they did was every

298
00:29:44,580 --> 00:29:52,120
every every quarter it did a password on
it using the rocky you list if your

299
00:29:52,120 --> 00:29:55,419
password was in the Rocky list you got
an email warning saying that your

300
00:29:55,420 --> 00:30:01,000
account was going to be locked out
within a day if you didn't change the

301
00:30:01,000 --> 00:30:10,330
password so anyone who had the password
in it is in the rocky or in the rockies

302
00:30:10,330 --> 00:30:15,750
they got a notification saying they had
24 hours to change the password or or

303
00:30:15,750 --> 00:30:20,900
their password or there would be a lot
and this being put on my clock out after

304
00:30:20,900 --> 00:30:26,210
day they didn't respond burden change it
so it did it is dumping read it you know

305
00:30:26,210 --> 00:30:32,020
it's tested this is crazy awesome so
guess what when when I'm on a pen tests

306
00:30:32,020 --> 00:30:34,560
ordered or doing arranging this
afternoon I dump your domain controller

307
00:30:34,560 --> 00:30:40,100
and not a single one cracks guess what
is going through my mind as psychology

308
00:30:40,100 --> 00:30:43,350
piece I did something wrong

309
00:30:43,350 --> 00:30:47,139
not your your passwords are great
because no one's bastards ever great I

310
00:30:47,140 --> 00:30:52,470
did something wrong so I'm gonna stress
out trying to fix my cracking tool to

311
00:30:52,470 --> 00:30:58,200
fix it so I can actually get a password
to dump or a password to crack and then

312
00:30:58,200 --> 00:31:03,140
when I finally get one of you like oh
it's good but if you can get inside the

313
00:31:03,140 --> 00:31:13,310
head of your attackers and screw them
that's the best friends before I get to

314
00:31:13,310 --> 00:31:18,500
the very stuff we're talking more about
that I'm gonna get into the clinic in /

315
00:31:18,500 --> 00:31:26,940
proxy one of the cool things about this
is the psychology of it so in the

316
00:31:26,940 --> 00:31:32,390
company are used to work for whenever if
you were the first person on the first

317
00:31:32,390 --> 00:31:36,700
day of the month to come into the
company and start your work you would

318
00:31:36,700 --> 00:31:46,230
see this at google.com we comments
blocked his google.com block okay and

319
00:31:46,230 --> 00:31:49,590
then it's a don't worry this could be
the first time today so attempted to go

320
00:31:49,590 --> 00:31:54,810
here click on the unblock to allow this
through on block is red

321
00:31:56,240 --> 00:32:02,500
walk it is we are quick green buttons
automatically this is great blog but it

322
00:32:02,500 --> 00:32:08,200
actually does absolutely nothing it's a
placebo effect it makes you feel better

323
00:32:08,200 --> 00:32:14,520
that you didn't go to a website it
basically distance back I'm block is red

324
00:32:14,520 --> 00:32:19,690
so the other cool portion of this is
that it's not appear for some reason is

325
00:32:19,690 --> 00:32:31,030
is on the actual / set as for the entire
company so if I go to expletive website

326
00:32:31,030 --> 00:32:34,240
about bad things that humans do together
in natural way

327
00:32:38,809 --> 00:32:55,769
so if I go to their website and this
this pops up the crazy thing that goes

328
00:32:55,769 --> 00:33:01,299
through users mines in your mind is do I
really want this for the entire company

329
00:33:01,299 --> 00:33:08,629
no I do not right now they have a log
now it's this road now it's in their

330
00:33:08,629 --> 00:33:15,600
face saying that I i as a as a proxy
admin have a longer view allowing bad

331
00:33:15,600 --> 00:33:17,709
website to go here

332
00:33:17,710 --> 00:33:25,789
the insane piece about this is that it
works that you have less infections

333
00:33:25,789 --> 00:33:26,658
because of it

334
00:33:26,659 --> 00:33:30,429
why because I don't know of a piece of
malware on the planet that can click a

335
00:33:30,429 --> 00:33:31,059
button

336
00:33:31,059 --> 00:33:35,129
whatever can do it

337
00:33:35,129 --> 00:33:40,158
Empire can't do it strike can't do it
all of the other piece of our poison ivy

338
00:33:40,159 --> 00:33:46,480
can do it like there isn't now where
they can click a flash-based button so

339
00:33:46,480 --> 00:33:50,619
guess what your users can click anything
that you want and it's not gonna get

340
00:33:50,619 --> 00:33:53,749
allowed through unless it's going to a
valid website that someone's already

341
00:33:53,749 --> 00:33:57,230
gotten two before and said yes go there

342
00:33:57,230 --> 00:34:01,289
the interesting thing about this is the
cool thing about this is that most

343
00:34:01,289 --> 00:34:15,000
people who do fishing so I set up my
mind I'm not that will set up my command

344
00:34:15,000 --> 00:34:18,270
and control on the same part because I
don't want if they could official

345
00:34:18,270 --> 00:34:26,159
website to block my commanding control
user might click on saying yes allow

346
00:34:26,159 --> 00:34:30,679
this through to their official website
if you're really good but guess what

347
00:34:30,679 --> 00:34:36,168
once they have color code execution
website because the malware can click

348
00:34:36,168 --> 00:34:40,399
the button now

349
00:34:41,710 --> 00:34:48,409
help you if you loud SSH outbound
doesn't help you if you allowed 21

350
00:34:48,409 --> 00:34:51,859
outbound doesn't help you if you like
all the ports are found that most

351
00:34:51,859 --> 00:35:00,900
universities and colleges do write this
can only help once you have strict rules

352
00:35:00,900 --> 00:35:06,790
to only allowed go through the proxy ok
that makes sense

353
00:35:08,300 --> 00:35:21,880
hired Rob stage I don't mind doing on
time and it's ok so even canaries this

354
00:35:21,880 --> 00:35:27,050
is my favorite part of the top so this
is all about how I got caught how many

355
00:35:27,050 --> 00:35:32,580
painters to talk about how they get
caught the reason why they don't ya

356
00:35:37,430 --> 00:35:50,210
is because if a reputation about the
people

357
00:35:50,980 --> 00:36:03,520
or learn are open to it but again that's
what I had my first and then temperature

358
00:36:03,520 --> 00:36:12,070
due tomorrow in CCDC or tonight Dec
demanding temp inside a description it

359
00:36:12,070 --> 00:36:19,070
sit here is the password for temporary
password for domain admin what I didn't

360
00:36:19,070 --> 00:36:19,960
look at is how

361
00:36:19,960 --> 00:36:25,609
hours it was allowed to login 0 so when
I first got this is on the test I was

362
00:36:25,609 --> 00:36:28,910
like awesome descriptions as the
password right out

363
00:36:28,910 --> 00:36:35,560
medication successful it works good
choice

364
00:36:35,560 --> 00:36:38,560
everywhere

365
00:36:40,620 --> 00:36:55,049
anytime was used to like 400 emails but
this is how you catch that actors make

366
00:36:55,050 --> 00:37:03,290
it exciting for them to get something
and then the cool thing is there's very

367
00:37:03,290 --> 00:37:08,029
little false positives how many times do
you think a regular users gonna look at

368
00:37:08,030 --> 00:37:17,730
a description of a domain admin ago I'm
gonna try that out every day the other

369
00:37:17,730 --> 00:37:24,500
one was this past 2014 one so there was
a share called password audit 2014 on

370
00:37:24,500 --> 00:37:28,650
the on the network first thing I did on
test really gotta show looked at past

371
00:37:28,650 --> 00:37:30,450
chair Mike

372
00:37:30,450 --> 00:37:42,319
into it opened up it was good as it gets
all the passwords for megs of stock so

373
00:37:42,320 --> 00:37:49,710
it looks like an actual word from John
the Ripper whatever so it had everyone

374
00:37:49,710 --> 00:37:51,770
deny on it

375
00:37:51,770 --> 00:37:57,320
Commission does anyone know in Windows
wedding everyone didn't I rule does even

376
00:37:57,320 --> 00:38:06,140
if your system it over there so it's
just a couple ways to get around this

377
00:38:06,140 --> 00:38:13,830
but it's not something that you normally
think so if I'm an ad in a standard you

378
00:38:13,830 --> 00:38:16,830
I cannot

379
00:38:19,340 --> 00:38:24,490
the allow me to see that it doesn't
everyone tonight on it so guess what I

380
00:38:24,490 --> 00:38:37,520
did attack her I wouldn't say ok I'm
going to trial of quick access to let me

381
00:38:37,520 --> 00:38:46,290
try it with other users with each other
so I tried it with every user that I had

382
00:38:46,290 --> 00:38:59,670
guess what the defenders did walk out
out out out out any false positive this

383
00:38:59,670 --> 00:39:01,000
creates

384
00:39:01,000 --> 00:39:08,640
if there if someone is looking for this
file and opens it they have bad

385
00:39:08,640 --> 00:39:13,589
intentions even if it's accidental even
if it's an insider

386
00:39:16,650 --> 00:39:27,960
ok backup database 112 so in this one is
a guy who actually hired because we

387
00:39:27,960 --> 00:39:30,690
didn't want to have him defending
against this anymore

388
00:39:30,690 --> 00:39:38,390
set up computer called backup database
so the first thing we did on the test

389
00:39:38,390 --> 00:39:43,129
was look at this ABC had a very outdated
version of my sequel on Windows

390
00:39:43,130 --> 00:39:53,750
apprentices in the room were like oh
right so it was the first thing I did

391
00:39:53,750 --> 00:39:57,240
was route

392
00:39:57,240 --> 00:40:07,169
but it's dead authentication successful
and then double back to try this again

393
00:40:07,170 --> 00:40:18,619
coming back to my problem with this guy
was removed so all it ever did was say

394
00:40:18,619 --> 00:40:26,020
successfully returned and host so you
could have indicate as any user on the

395
00:40:26,020 --> 00:40:33,500
planet and it would just be back you
know disconnect you would one be lo from

396
00:40:33,500 --> 00:40:36,500
this thing and it was just a Raspberry
Pi or something

397
00:40:37,660 --> 00:40:51,549
any web developer that it was hilarious
because he would get scanned by these

398
00:40:51,550 --> 00:40:56,140
scans every so often and he did it
because they need up to six like single

399
00:40:56,140 --> 00:41:00,100
injection and cross-site scripting and
all that crap they didn't want to know

400
00:41:00,100 --> 00:41:03,100
what he did was he set up all of these
fake

401
00:41:04,020 --> 00:41:08,310
htaccess forwards so that any time you
scanned it with the vulnerability

402
00:41:08,310 --> 00:41:15,720
scanning tool it said 402 which is
payment require so he was basically

403
00:41:15,720 --> 00:41:23,069
telling all of the scanner monkeys to
pay him next one

404
00:41:23,930 --> 00:41:33,230
anyone ever go to get credit card
numbers dot com everyone's like no hard

405
00:41:33,230 --> 00:41:36,210
numbers dot com is actually a really
cool website that lets you generate

406
00:41:36,210 --> 00:41:43,780
numbers pick one dummy data using your
database and this one really horrible

407
00:41:43,780 --> 00:41:49,859
because on this test we are we were
tasked with getting credit card data so

408
00:41:49,859 --> 00:41:55,340
we got the credit card data by accessing
Oracle database and then Oracle database

409
00:41:55,340 --> 00:41:59,950
we had gotten Oracle guy who was really
good at Oracle databases and what he did

410
00:41:59,950 --> 00:42:05,990
but he would listen all the Oracle
databases in the thing that they're

411
00:42:05,990 --> 00:42:10,459
called something else but anyways the
databases and their names like ch4

412
00:42:10,460 --> 00:42:20,080
42101 561 credit cards t-series 76 more
54321 like all of these are the names so

413
00:42:20,080 --> 00:42:27,210
guess where we win the one that said
credit cards we downloaded all of the

414
00:42:27,210 --> 00:42:34,700
credit cards that we went to the report
more like we got all your cards and they

415
00:42:34,700 --> 00:42:40,020
relate you got that one that are
dominated caught you and you don't get

416
00:42:40,020 --> 00:42:44,009
any of the other one because every
single one of the third databases where

417
00:42:44,010 --> 00:42:54,820
the actual credit cards we didn't even
look we didn't even go into any of the

418
00:42:54,820 --> 00:43:05,290
other databases anyone ever deal with
juniper VPN this Jennifer Jennifer VPNs

419
00:43:05,290 --> 00:43:08,250
are actually pretty cool of him in the
back door which is also cool but anyways

420
00:43:08,250 --> 00:43:16,270
they had the ability to make their own
custom HTML pages for your insight or

421
00:43:16,270 --> 00:43:27,450
whatever and what is dude he set up his
VPN website to have eighty-four username

422
00:43:27,450 --> 00:43:30,450
password embedded as they HTML comment

423
00:43:31,320 --> 00:43:35,369
inside of their database inside of the
custom website for their Jennifer so

424
00:43:35,369 --> 00:43:40,250
when we went to abuse first on it like
crowds like it's just that we didn't

425
00:43:40,250 --> 00:43:43,250
have to use Eric for his shoe horn stuff

426
00:43:43,750 --> 00:43:51,630
asking about that later so its credit
right in there so we tried the critical

427
00:43:51,630 --> 00:43:55,690
they worked like we're in

428
00:43:57,040 --> 00:44:10,520
had 00 apply to it but couldn't do a
single thing in the locker IP adresses

429
00:44:12,550 --> 00:44:18,490
like all of this stuff about are all
about

430
00:44:19,160 --> 00:44:25,190
false positive ways of detecting bad
guys by using their own psychology

431
00:44:25,190 --> 00:44:33,900
against them this one this one got me in
trouble specifically so we were doing a

432
00:44:33,900 --> 00:44:38,410
test and we had a bunch of our guys on
the team doing fishing and a bunch of

433
00:44:38,410 --> 00:44:44,160
our guys on the team doing web so I was
doing journalism the fishing people have

434
00:44:44,160 --> 00:44:49,720
did their side of stuff they got like 50
credentials but it didn't get internal

435
00:44:49,720 --> 00:44:58,589
act like they had fifty stuff so that we
on the T but inside I'm like hey I found

436
00:44:58,590 --> 00:45:04,230
a place where we can validate this thing
and maybe get more stuff maybe get more

437
00:45:04,230 --> 00:45:10,730
you know access so I stab incise log-in
actually should go to demean unit so

438
00:45:10,730 --> 00:45:17,860
it's ed in enabled we can do more with
this so I started hey guys you got the

439
00:45:17,860 --> 00:45:24,720
critical let's try some of these out I
tried every single one of them all it

440
00:45:24,720 --> 00:45:31,990
did was forward back to the main page
and every one of those accounts got

441
00:45:31,990 --> 00:45:51,569
locked out or changed inside of the team
was they didn't you burned every single

442
00:45:51,570 --> 00:46:05,950
one of them next one you guys can do
this guy actually had telnet device just

443
00:46:05,950 --> 00:46:09,810
a Raspberry Pi whatever connected to a
small little minor next to his desk and

444
00:46:09,810 --> 00:46:18,049
said anytime you see 423 traffic ever
put up a red red sign and then it gave

445
00:46:18,050 --> 00:46:20,960
him since he was the system admin as
well

446
00:46:20,960 --> 00:46:27,840
gave him the exact court that it was on
so we were doing an internal testing in

447
00:46:27,840 --> 00:46:32,100
this office that the system would put us
in this unused off like that

448
00:46:32,680 --> 00:46:47,308
on the first floor he walked up like a
guy so he blocked airports and we were

449
00:46:47,309 --> 00:46:57,450
pretty much done all this stuff really
is is to make it so that you guys think

450
00:46:57,450 --> 00:47:03,129
about attackers more people than some
magical unicorns that can get anything

451
00:47:03,130 --> 00:47:07,670
done if you think of them as people then
you start thinking about the psychology

452
00:47:07,670 --> 00:47:11,220
involved in it and then you start
thinking about ways that you can really

453
00:47:11,220 --> 00:47:16,348
true but one of the one of the pieces
that I stay in corporate America that

454
00:47:16,349 --> 00:47:22,750
don't involve some reason on the
security side of things is to help the

455
00:47:22,750 --> 00:47:28,400
helpdesk get any order to your front
line near the people who know when weird

456
00:47:28,400 --> 00:47:36,150
stuff is happening I get caught on
Pinterest border but I people to provide

457
00:47:36,150 --> 00:47:43,270
security box it's it's the Oracle admin
says hey I got a weird logging did you

458
00:47:43,270 --> 00:47:48,030
guys look into this and they call the
help desk or they call you know the

459
00:47:48,030 --> 00:47:52,680
firewall a dinner or something else they
call someone and the fact that

460
00:47:52,680 --> 00:48:01,359
organizations don't get their helpdesk
involved in this security thing that's

461
00:48:01,359 --> 00:48:05,180
pretty much it very much

462
00:48:11,470 --> 00:48:25,410
questions comments concerns saved
Radames he ok

