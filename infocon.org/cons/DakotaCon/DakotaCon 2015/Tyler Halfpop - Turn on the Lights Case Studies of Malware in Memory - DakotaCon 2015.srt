1
00:00:00,980 --> 00:00:07,750
goal is to see the day when you do this
you want to serve your parsley model

2
00:00:07,750 --> 00:00:13,980
yourself an easy way to jazz just like
el pais on server or probably want to

3
00:00:13,980 --> 00:00:18,650
serve it with a CVS so it's a little bit
harder to see in detecting the network

4
00:00:18,650 --> 00:00:25,820
but I agree we put this into the ghetto
recently kind of funny he's saying you

5
00:00:25,820 --> 00:00:30,099
know don't just run stuff off get her a
lot of security it's amazing that they

6
00:00:30,099 --> 00:00:34,800
do that they put at the bottom to throw
something terrible that just happened

7
00:00:34,800 --> 00:00:40,530
because he did that you know the public
get other you don't control so it's kind

8
00:00:40,530 --> 00:00:44,980
of funny laugh but they say it's gonna
give somebody a mild heart attack if

9
00:00:44,980 --> 00:00:49,108
there is a lot of examples out there was
actually pointed down from get up and

10
00:00:49,109 --> 00:00:55,890
say their own on servers not offended
that the setup that was set up to serve

11
00:00:55,890 --> 00:01:05,400
from the directory and then this is
setting up a listener something every

12
00:01:05,400 --> 00:01:14,290
spree familiar with the actual
PowerShell to run so you have an

13
00:01:14,290 --> 00:01:19,040
attacker machine in a victim machines is
actually run on the attacker machine to

14
00:01:19,040 --> 00:01:25,940
remotely execute code on another victim
machine so you're invoking the command

15
00:01:25,940 --> 00:01:36,550
down 139 they're downloading going down
the show code and executing it

16
00:01:36,550 --> 00:01:44,220
vs the parameters there to do that so it
never writes the disc on the victim

17
00:01:44,220 --> 00:01:50,840
machine there's there's nothing there so
just example of you know when that runs

18
00:01:50,840 --> 00:01:59,470
and she is kind of something we've all
again the corner every time I've got to

19
00:01:59,470 --> 00:02:03,640
work the first time interpreter probably
still do it works pretty excited but

20
00:02:03,640 --> 00:02:10,489
either way from the InfoSec reactions
like one of my favorite sites definitely

21
00:02:10,489 --> 00:02:12,190
check it out

22
00:02:12,190 --> 00:02:20,220
really fun stuff on there so anyways
procession got set up and just read a

23
00:02:20,220 --> 00:02:31,300
couple in a system that processes see
Elsass down there the bottom 512 so they

24
00:02:31,300 --> 00:02:37,660
were actually going to migrate else as
you can see that we're now in there so

25
00:02:37,660 --> 00:02:43,290
if you're looking at OCBC suspicious
definitely going to want to look at the

26
00:02:43,290 --> 00:02:45,440
server you're digging in looking at it

27
00:02:45,440 --> 00:02:51,180
not really gonna see anything like no
problem it's cool bro going on

28
00:02:51,180 --> 00:03:02,580
bombers be excited by their so what's
really going on is reflective injection

29
00:03:02,580 --> 00:03:11,110
discharged kind of they're just so
what's going on in virtual a like X

30
00:03:11,110 --> 00:03:16,050
allocate space other process and Windows
is kind of amazing that you're allowed

31
00:03:16,050 --> 00:03:20,080
to do that but then and then you're
gonna write the dealio into there and

32
00:03:20,080 --> 00:03:27,880
and run it that's kinda how those
working in back in so I can say there's

33
00:03:27,880 --> 00:03:33,480
no binary today is not a lot to look at
but you know volatility to the rescue

34
00:03:33,480 --> 00:03:38,470
gear so we'd run that now find plugin
that we talked about earlier it's gonna

35
00:03:38,470 --> 00:03:43,269
go through and look for injected code on
the box and its gonna pull back just

36
00:03:43,269 --> 00:03:48,040
like one of the examples that have found
here and you know I guess I look at the

37
00:03:48,040 --> 00:03:54,590
assembly you know some of these look
could be more on that one

38
00:03:58,370 --> 00:04:04,150
for their see this would like to live
our script looking at all the network

39
00:04:04,150 --> 00:04:08,489
connections as well but just wanted to
show what you doin volatility with it

40
00:04:08,489 --> 00:04:20,769
doing that skin wise Elsass talking
about the box on dat not normal is

41
00:04:20,769 --> 00:04:25,330
another example of PowerShell and this
one's kind of almost even worse in some

42
00:04:25,330 --> 00:04:31,370
ways like kind of cheating I think but
you're funny cats

43
00:04:32,010 --> 00:04:38,949
reflective PL injection from there so
you're likely loading many cats not

44
00:04:38,949 --> 00:04:43,750
writing anything to piss and you're able
to dump threads are millions of babies

45
00:04:43,750 --> 00:04:49,000
not familiar with Mimi cats really cool
tool to run it and basically dumped

46
00:04:49,000 --> 00:04:51,250
hashes

47
00:04:51,250 --> 00:04:56,320
potentials in the box just like how we
did with power split running it voting

48
00:04:56,320 --> 00:05:03,050
and other machine they're downloading
you want and then just invoking yet

49
00:05:03,050 --> 00:05:15,240
dumping the creds just grows like I give
up but they just cant get hashes

50
00:05:15,240 --> 00:05:27,110
attackers so like not allowed to go up
right that a Quran it he got the creds

51
00:05:27,110 --> 00:05:33,580
there's some network traffic maybe to
look at but PowerShell does it over like

52
00:05:33,580 --> 00:05:39,380
a CBS reports by default the maybe you
are looking for internally starts in

53
00:05:39,380 --> 00:05:43,630
between hosts that's bad something to
look at but what if we know something

54
00:05:43,630 --> 00:05:46,419
bad will look into it more

55
00:05:46,419 --> 00:05:52,698
PowerShell memory artifacts that are
there so when you run the command line

56
00:05:52,699 --> 00:05:59,380
and interactive PowerShell gonna run in
the WS

57
00:05:59,380 --> 00:06:07,320
prob post a TAC you're going to see
their voting protocol XML in there some

58
00:06:07,320 --> 00:06:11,460
research I put out a black cat couple
years ago

59
00:06:11,460 --> 00:06:17,560
year ago maybe now it went through and
looked at a lot of the stuff but the

60
00:06:17,560 --> 00:06:22,330
problem with that with that process is
as soon as it closes its gone but

61
00:06:22,330 --> 00:06:27,760
there's a sec hosts NRM service that
keeps running so it's an interesting one

62
00:06:27,760 --> 00:06:34,630
can contain some web services management
so messages for the remoting and in some

63
00:06:34,630 --> 00:06:38,580
of the tests they did they did it took a
dump immediately after running some

64
00:06:38,580 --> 00:06:42,490
commands and looking for the strains in
memory and an also-ran five hours after

65
00:06:42,490 --> 00:06:47,410
an ad in a week after there were still
some remnants in memory still after a

66
00:06:47,410 --> 00:06:57,150
week that's kinda dependent on how much
activity there is placing a memory so

67
00:06:57,150 --> 00:07:09,870
there's an example from them unique as
we ran so here just listen that ps3

68
00:07:09,870 --> 00:07:16,640
finding the SPC host service and then
dumping that and then just looking

69
00:07:16,640 --> 00:07:26,140
through a text editor and you will see a
lot of stuff for their citizens taken

70
00:07:26,140 --> 00:07:31,320
immediately after it replicates in the
testing with like time delay a bit with

71
00:07:31,320 --> 00:07:42,060
memory forensics time is kinda essence
overtime things paged out or are gone so

72
00:07:42,060 --> 00:07:46,290
evil uses

73
00:07:47,900 --> 00:07:57,739
so evil uses for some friends except
like bad guys could actually use it for

74
00:07:57,740 --> 00:08:03,820
you know offensively minded security
researcher dumping hashes from the files

75
00:08:03,820 --> 00:08:14,490
some backups and files or VMware stuff
the center and also a lot of people

76
00:08:14,490 --> 00:08:22,690
sleep there viens so they're gonna have
the memory the raw dump right there this

77
00:08:22,690 --> 00:08:30,310
is showing both silly processes are
dumped hashes there you just listing the

78
00:08:30,310 --> 00:08:36,020
registry hive and then getting offsets
you can put them into the hashtag plugin

79
00:08:36,020 --> 00:08:46,829
in the bottom and kind of trade-offs get
a couple of these actors out there and

80
00:08:46,830 --> 00:08:53,360
also TrueCrypt you know dumping that it
can be used for your good friends case

81
00:08:53,360 --> 00:09:00,720
or potentially you know you get into
somebody's encrypted container this one

82
00:09:00,720 --> 00:09:08,910
just running trip summary on a memory I
get the password out of their hearts and

83
00:09:08,910 --> 00:09:13,430
that and then there's zero day in there
as well

84
00:09:16,690 --> 00:09:20,900
and dump their the key as well as Turkey
right from

85
00:09:25,990 --> 00:09:43,850
project RAM scraper another example of
how an hour can use memory for good and

86
00:09:43,850 --> 00:09:51,310
bad credit cards in memory kinda
reported on and looked at by the box

87
00:09:51,310 --> 00:10:01,859
there we're looking at now wear
something I learned from ulcer really

88
00:10:01,860 --> 00:10:07,730
big fan of them so you doing like now
announces its really easy it's hard to

89
00:10:07,730 --> 00:10:13,570
see here this image but how you doin
Alice just to kind of break it off and

90
00:10:13,570 --> 00:10:19,220
then it really easy to do a tree
breaking down all the different parts

91
00:10:19,220 --> 00:10:20,140
about them how are they

92
00:10:20,140 --> 00:10:27,750
you might want to know or maybe come
back to in the future look at zoom in on

93
00:10:27,750 --> 00:10:31,850
a part of it like the mutex

94
00:10:35,770 --> 00:10:42,410
network traffic I can also dump files
like an expert on my nap so screenshots

95
00:10:42,410 --> 00:10:53,180
as well there as well as some of the
request to get post to get requests

96
00:10:53,180 --> 00:10:59,849
there is right upon infection what
happens is the get and then other

97
00:10:59,850 --> 00:11:05,190
posters actually digging further when it
finds a good cards I can post it up to

98
00:11:05,190 --> 00:11:12,959
the the malware c2 server and this is
kind of cool our authors leave little

99
00:11:12,959 --> 00:11:16,779
kind of Easter eggs are little things
mean they're using when you're debugging

100
00:11:16,779 --> 00:11:27,329
now we're just havin there so through
this malware there's a jump is always

101
00:11:27,329 --> 00:11:30,329
taken there

102
00:11:33,670 --> 00:11:39,400
don't take that job actually it's going
to launch of a GUI and bugging you can

103
00:11:39,400 --> 00:11:43,790
make it not to jump and then you're
gonna get this its gonna show you each

104
00:11:43,790 --> 00:11:53,930
process of scanning is going through a
cool but digging in further the kind of

105
00:11:53,930 --> 00:11:58,359
my map here in smaller stuff they want
to document we're looking at is an hour

106
00:11:58,360 --> 00:12:01,630
later that you don't from memory or just
in general

107
00:12:01,630 --> 00:12:06,980
some of the things I like to read about
it also you can kind of like plus and

108
00:12:06,980 --> 00:12:23,290
minus open in and shut different areas
to kind of make it less busy lady bug

109
00:12:23,290 --> 00:12:32,040
debugger to use its buy one most popular
ones besides maybe a little bit steeper

110
00:12:32,040 --> 00:12:38,589
learning curve to use to bug bugs
symbols starting to bug is getting into

111
00:12:38,590 --> 00:12:44,530
play with this is kind of like I just
mapped the functions way too small to

112
00:12:44,530 --> 00:12:57,550
see Alex I got there but it's going to
our its gonna cut himself to a new

113
00:12:57,550 --> 00:13:03,810
location is what it was doing on this
page and it's gonna put a file there

114
00:13:03,810 --> 00:13:10,050
that file was not there it's going to
dump it in its gonna do that notify get

115
00:13:10,050 --> 00:13:16,969
requests telling them our other hey I'm
here and then from there it's going to

116
00:13:16,970 --> 00:13:22,120
these things and start checking for
credit card numbers is looking for the

117
00:13:22,120 --> 00:13:26,340
track to credit card information is
gonna find something

118
00:13:27,430 --> 00:13:30,760
checking for the beginning part of find
something that looks like it's gonna

119
00:13:30,760 --> 00:13:35,650
check it with the lawn algorithm that's
an algorithm for credit cards actually

120
00:13:35,650 --> 00:13:41,510
the jet and then it was about verifies
that can upload it to the

121
00:13:41,510 --> 00:13:49,000
c2 server that hosts this is gonna do
example screenshot from all the bugs

122
00:13:49,000 --> 00:14:02,140
here just where can see the server their
call to their and then this is an output

123
00:14:02,140 --> 00:14:09,380
from Wireshark earlier give him play
with now where a lot of times it needs

124
00:14:09,380 --> 00:14:14,670
internet connection or some sort of
network that's usually a bad idea

125
00:14:16,580 --> 00:14:22,240
don't want these guys going where you're
coming from or allowing a system of you

126
00:14:22,240 --> 00:14:25,990
doing its 8 p.m. to connect out the
Internet is in the bag as we know that

127
00:14:25,990 --> 00:14:32,490
you're looking at it so there's a really
cool really cool tool called vignette by

128
00:14:32,490 --> 00:14:38,290
Andrew negative he was here last year
showed some there some Cheerios are

129
00:14:38,290 --> 00:14:42,640
familiar with it but this is just
actually saves apk to simulate a network

130
00:14:42,640 --> 00:14:47,090
and respond to requests and in saving
off to pick up this is just an example

131
00:14:47,090 --> 00:14:55,260
of the request in there saying I am
Alive gotta get an infection also popped

132
00:14:55,260 --> 00:15:08,920
up a message box so on this memory
forensics is interesting for you

133
00:15:08,920 --> 00:15:11,209
recommend downloading it

134
00:15:11,210 --> 00:15:16,940
volatility volatility foundation there's
like a whole slew simple memory images

135
00:15:16,940 --> 00:15:23,750
to play with and then I like I said the
book art of memory forensics is super

136
00:15:23,750 --> 00:15:25,930
details like 90 pages long

137
00:15:25,930 --> 00:15:32,560
on forensics and also covers a lot of
stuff with its internals gonna need to

138
00:15:32,560 --> 00:15:39,540
know friends ex and they're also able to
dig in and motility you mentioned

139
00:15:39,540 --> 00:15:43,069
earlier to look at windows internals and
learn windows internals looking at the

140
00:15:43,070 --> 00:15:47,070
source code there is really awesome for
that and just play with it

141
00:15:47,070 --> 00:15:50,070
get those memory image is your own dumps

142
00:15:53,480 --> 00:16:05,459
like one of my favorite in here like the
kind of clothes with you

143
00:16:05,459 --> 00:16:14,359
protections are a really effective for
an organization to do so definitely

144
00:16:14,360 --> 00:16:19,940
whitelisting is is really huge like
we've been learning slowly and security

145
00:16:19,940 --> 00:16:24,850
that blacklisting really isn't working
so that's you know and if I received

146
00:16:24,850 --> 00:16:33,410
your applied in a broader context really
what lessons that I mean like

147
00:16:33,410 --> 00:16:43,600
application whitelisting not just like
the nine also there's some built in ones

148
00:16:43,600 --> 00:16:49,209
but then also be careful not to buy
passes their disabling PowerShell

149
00:16:49,209 --> 00:16:56,638
PowerShell attacks Stephanie really
dangerous unless you know maybe not for

150
00:16:56,639 --> 00:17:00,500
normal users save lit Joba no bad thing

151
00:17:01,459 --> 00:17:07,178
weightless personalized another thing
organizations going bad passes on the

152
00:17:07,179 --> 00:17:10,179
network by listening

153
00:17:17,980 --> 00:17:22,829
so widely staying on at work in an hour
traffic as much as you can

154
00:17:22,829 --> 00:17:28,349
proxying outbound traffic prevent some
of those shells in a lot of now where

155
00:17:28,349 --> 00:17:32,469
needs to communicate outside you can
break that somehow it's always a good

156
00:17:32,470 --> 00:17:33,530
thing

157
00:17:33,530 --> 00:17:40,350
an application security a friend of mine
damian as a whole bunch talking that

158
00:17:40,350 --> 00:17:46,330
that's interesting to you on
blacklisting basically doesn't work and

159
00:17:46,330 --> 00:17:53,790
he's going to buy passes for like wow
its application security testing is

160
00:17:53,790 --> 00:17:56,909
really important as well

161
00:17:56,910 --> 00:18:02,710
segment of things is a kind of basic
security things but you know we're

162
00:18:02,710 --> 00:18:07,240
looking at some of the real kind of deep
and kind of things of memory forensics

163
00:18:07,240 --> 00:18:12,470
and reversing but it seems like a lot of
the basic stuff you see a lot of

164
00:18:12,470 --> 00:18:18,950
breaches like the real basic things are
gonna missed and that's the problem

165
00:18:18,950 --> 00:18:24,460
segmenting ship that's going down or
something you know being able to segment

166
00:18:24,460 --> 00:18:30,410
off different areas super important
different accounts of the same local

167
00:18:30,410 --> 00:18:31,520
admin all the way out there

168
00:18:31,520 --> 00:18:36,830
organization because like we looked at
like many cats if they're gonna get that

169
00:18:36,830 --> 00:18:42,870
they're like everything from there the
different accounts for normal in admin

170
00:18:42,870 --> 00:18:49,530
usage and then also segmenting big fan
of multi-factor authentication

171
00:18:49,530 --> 00:18:52,330
segmenting out as much as you can

172
00:18:52,330 --> 00:18:55,750
different trust not only just the
internet but if you have an area that is

173
00:18:55,750 --> 00:18:58,070
really important for your business

174
00:18:58,070 --> 00:19:03,909
really wanna segment that out with
multi-factor even internally really good

175
00:19:03,910 --> 00:19:09,090
thing to do now just by itself it's
something I also really want to train

176
00:19:09,090 --> 00:19:17,639
your users on because perfect can
definitely be socially engineered from

177
00:19:17,640 --> 00:19:20,890
the ones we just click Yes No maybe it
keeps popping up for some leader in

178
00:19:20,890 --> 00:19:30,059
click Yes or No getting called and asked
to give up so I certainly would you like

179
00:19:30,059 --> 00:19:30,720
your social

180
00:19:30,720 --> 00:19:38,390
during testing there till then the last
one huge focus there to see and it was

181
00:19:38,390 --> 00:19:44,870
like working on detecting we have all
these tools and things that were using a

182
00:19:44,870 --> 00:19:52,639
really good people looking at the logs
and looking at everything actually find

183
00:19:52,640 --> 00:19:57,039
as bad as we looked at some of those
examples of an hour actually doing

184
00:19:57,039 --> 00:20:01,419
active hunting and looking trying to
find some was bad so that might not

185
00:20:01,419 --> 00:20:08,640
always be there on a surface look a lot
of organizations there's over 200 days

186
00:20:08,640 --> 00:20:20,010
before knowing when they've been hacked
so really taking time to look at more of

187
00:20:20,010 --> 00:20:21,039
a priority

188
00:20:21,039 --> 00:20:26,690
also a detection and so some legal
strategies with detection about recently

189
00:20:26,690 --> 00:20:33,809
doing things like many ports Johnson
talks about a lot like that product

190
00:20:33,809 --> 00:20:41,730
artillery another one is out there it's
really cool just like actively kind of

191
00:20:41,730 --> 00:20:46,840
putting something out there for people
to connect to it and not a normal user

192
00:20:46,840 --> 00:20:50,970
would connect to its right so I could be
a darkness IP address is something that

193
00:20:50,970 --> 00:20:55,210
nobody should ever be connecting to and
if that somebody doesn't that there

194
00:20:55,210 --> 00:20:59,380
should be like an alarm to look at
something that's a really good strategy

195
00:20:59,380 --> 00:21:06,140
also bro IDs some of the PowerShell
remoting things we talked about maybe

196
00:21:06,140 --> 00:21:10,669
using that to look for some of the
communication between hosts or maybe

197
00:21:10,669 --> 00:21:17,760
from the VPN inside those things as well
as monitoring exfiltration is a big

198
00:21:17,760 --> 00:21:22,169
thing like this is the Sony attack me so
recently with Sony getting attacked in

199
00:21:22,169 --> 00:21:31,049
like all kinds of information getting
out there looking for it going out and

200
00:21:31,049 --> 00:21:40,059
also mentioned Google rapid response
scale scale where Facebook has a really

201
00:21:40,059 --> 00:21:43,490
cool tools or less query or clinic

202
00:21:43,490 --> 00:21:52,500
and Mac they still allows you to query
or OS with sequel type commands so it's

203
00:21:52,500 --> 00:21:59,200
really easy to install you start taking
her know that but she likes lacked

204
00:21:59,200 --> 00:22:11,600
whatever field you wanna know lesson
from there to talk and I don't wear that

205
00:22:11,600 --> 00:22:15,879
thank you guys

