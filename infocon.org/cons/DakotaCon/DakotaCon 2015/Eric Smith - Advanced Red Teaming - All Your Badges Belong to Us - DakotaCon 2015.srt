1
00:00:00,000 --> 00:00:12,870
welcome everybody thinks I'm and I'll be
talking about some RFID attacks if I can

2
00:00:12,870 --> 00:00:22,479
see you guys got everybody or anybody
somebody alright so it goes through a

3
00:00:22,480 --> 00:00:27,640
series of a refresher what's been going
in and what we're talking about here is

4
00:00:27,640 --> 00:00:32,960
RFID as it relates to access control for
buildings so not your bus passes not

5
00:00:32,960 --> 00:00:37,110
sure my fare cards not sure you know ski
resort passes things like that

6
00:00:37,629 --> 00:00:42,300
specifically two types technology that
will dive into a bit one of them around

7
00:00:42,300 --> 00:00:43,468
for a long time

8
00:00:43,469 --> 00:00:48,190
lot of researchers have talked about him
which is a low frequency Arthus and

9
00:00:48,190 --> 00:00:53,800
newer technologies encrypted format and
that's all we're gonna focus home in the

10
00:00:53,800 --> 00:00:57,800
latter part of the talk and after that
we'll talk about some advanced attacks

11
00:00:57,800 --> 00:01:01,608
you can do against those kinds of
systems as well as some medication

12
00:01:01,609 --> 00:01:08,810
around this things a little bit about
company that I work for large consulting

13
00:01:08,810 --> 00:01:11,810
we've been around now for eight years

14
00:01:14,350 --> 00:01:19,649
a decent stuff in the industry I just
work related but also things related to

15
00:01:19,650 --> 00:01:23,549
improving the community one of things we
put together that we're proud of what

16
00:01:23,549 --> 00:01:28,180
they've actually copied us so we start
writing standards for how to conduct

17
00:01:28,180 --> 00:01:33,460
security assessments specifically round
pen testing standards about it prior to

18
00:01:33,460 --> 00:01:38,320
what this with this created so myself
along with about one of the people in

19
00:01:38,320 --> 00:01:44,039
the community got together a standard
around along with that of other things

20
00:01:44,040 --> 00:01:48,759
about the company itself and one of
things that you guys may have heard of a

21
00:01:48,759 --> 00:01:50,350
little TV show they made about us

22
00:01:50,350 --> 00:01:55,210
Tiger Team we presented a number of
conferences around the world I

23
00:01:55,210 --> 00:02:00,658
personally have presented here at the
Kodokan few times as well as performed

24
00:02:00,659 --> 00:02:06,579
on the red team Percy City senior lot
about myself obviously tell him not

25
00:02:06,579 --> 00:02:10,619
serious I don't have the suit picture I
was actually a boat race we did last

26
00:02:10,619 --> 00:02:12,920
year when his ass off

27
00:02:12,920 --> 00:02:17,519
what are some of the services like I
specialize in is contesting risk

28
00:02:17,520 --> 00:02:20,890
assessment social engineering physical
security and Linda threat types of

29
00:02:20,890 --> 00:02:25,790
attacks so this obviously is is one type
of attack you can do when you're looking

30
00:02:25,790 --> 00:02:31,709
at things like red team physical
security implicit threats so important

31
00:02:31,709 --> 00:02:37,700
enough to be able to do what I like to
do if you're not somebody made a quote a

32
00:02:37,700 --> 00:02:40,970
long time ago if you're getting up into
working every day you're not happy then

33
00:02:40,970 --> 00:02:47,069
its work not a career so I personally
been lucky enough to get everything and

34
00:02:47,069 --> 00:02:50,500
be happy with what I do and the company
that i've i've helped build a network

35
00:02:50,500 --> 00:02:55,860
for and it's more of a hobby than a job
so again you know what we're talking

36
00:02:55,860 --> 00:02:59,370
about here is one aspect of raging
testing that's obviously got a long

37
00:02:59,370 --> 00:03:03,290
definition of what rating testing us it
originated in the military and you guys

38
00:03:03,290 --> 00:03:06,920
can read that long definition you want
to but the analogy that we like to use

39
00:03:06,920 --> 00:03:11,929
are already testing is it simulates a
fight if you put someone in the ring and

40
00:03:11,930 --> 00:03:14,299
they are actually in the middle of
flight

41
00:03:14,299 --> 00:03:18,970
gonna know how they can't rain all day
in the gym boxing and perform all these

42
00:03:18,970 --> 00:03:22,450
different types of martial arts until
you're actually in a fight you don't

43
00:03:22,450 --> 00:03:26,328
know how you gonna stand up and fight so
when I read team testing is to put an

44
00:03:26,329 --> 00:03:34,630
organization into an actual fight to
defend against similar what we do for a

45
00:03:34,630 --> 00:03:38,450
number of reasons to conduct it
obviously one is still simulate what

46
00:03:38,450 --> 00:03:43,040
would happen in a real attack was the
impact of the brand was the impact the

47
00:03:43,040 --> 00:03:47,440
bottom line the company but also it's
essentially a full Dr test for your

48
00:03:47,440 --> 00:03:51,370
emphasis program how well your gonna
hold up to a number of different types

49
00:03:51,370 --> 00:03:58,269
of attacks whether it's physical social
electronic or a blend of those testing

50
00:03:58,269 --> 00:04:03,600
like that already is a collaboration of
those different aspects so you may use

51
00:04:03,600 --> 00:04:07,930
an electronic attack to gain access to
an organization once you've gained

52
00:04:07,930 --> 00:04:11,989
access then you might use that to get
physical access so there's some things

53
00:04:11,989 --> 00:04:16,500
I'll talk about in this talk where we
can leverage things like penetration

54
00:04:16,500 --> 00:04:20,418
testing from the outside gain access to
a bad system learned details about

55
00:04:20,418 --> 00:04:24,490
what's in that bag system to create a
badge and the shop on site magic to a

56
00:04:24,490 --> 00:04:26,070
building and all that started from

57
00:04:26,070 --> 00:04:31,250
external threat so there's a number of
techniques when you speak of Redding

58
00:04:31,250 --> 00:04:35,660
testing and gain access to a facility
conventional attacks everything from

59
00:04:35,660 --> 00:04:40,670
jail getting into a building a social
agenda if you wanna call it that all the

60
00:04:40,670 --> 00:04:44,540
way down to lock picking and shimmy and
lock bypassing and doing things around

61
00:04:44,540 --> 00:04:48,740
with elevators and also the different
types of direct attacks we're

62
00:04:48,740 --> 00:04:54,900
specifically talked about today is just
are fighting so there's two technologies

63
00:04:54,900 --> 00:04:57,859
the run talk about today one and they
both look similar

64
00:04:57,860 --> 00:05:01,810
the badges are you see people all the
time around lenders things like that you

65
00:05:01,810 --> 00:05:05,870
guys may have campus for doing certain
things there's two types there is a low

66
00:05:05,870 --> 00:05:11,610
frequency which runs at $125 and there's
also high frequency that runs at 13.5

67
00:05:11,610 --> 00:05:14,590
six megahertz to read ranges on both of
them

68
00:05:14,590 --> 00:05:19,130
vary slightly depending on what kind of
reader that the card numbers and it's so

69
00:05:19,130 --> 00:05:22,730
we'll dive into a little about the the
length of those and how some of those

70
00:05:22,730 --> 00:05:25,820
things work but specifically there's two
types were on talk about today

71
00:05:26,330 --> 00:05:29,789
low-frequency be an unencrypted
high-frequency being high class

72
00:05:29,790 --> 00:05:36,840
technology which is always so here's the
stink of it this is a quote

73
00:05:36,840 --> 00:05:43,609
released the date on it and it's from
hid which is the number one vendor for

74
00:05:43,610 --> 00:05:49,010
all these different asset types of cards
and technologies and the quote was the

75
00:05:49,010 --> 00:05:53,080
low frequency on the cards are still
using about eighty percent of their

76
00:05:53,080 --> 00:05:58,190
their customers space the other 20% is
using a mixture of of these types of

77
00:05:58,190 --> 00:06:03,260
assets some of them that I play some of
them being a third party that's not hid

78
00:06:03,260 --> 00:06:06,690
specific but eighty percent of the
companies out there that use access

79
00:06:06,690 --> 00:06:13,000
controls related to RFID cards or using
the unencrypted form so that scary just

80
00:06:13,000 --> 00:06:16,220
a statistic but then you put it into
perspective of who's actually using

81
00:06:16,220 --> 00:06:18,940
those kinds of cards and and this ties
back to some of what Scott was just

82
00:06:18,940 --> 00:06:25,980
alluding to is whenever you can put
physical harm someone or you can impact

83
00:06:25,980 --> 00:06:31,250
someone's life that's usually much more
risk than a business losing data using

84
00:06:31,250 --> 00:06:35,260
personal records losing something that's
going to cost them a financial amount of

85
00:06:35,260 --> 00:06:37,639
money and sometimes it's it's it's

86
00:06:37,639 --> 00:06:40,949
compared to how much they make right
there's a big debate going on right now

87
00:06:40,949 --> 00:06:45,099
about how much is a breach actually
impact a company phone company survive a

88
00:06:45,099 --> 00:06:49,498
breach of those companies can look it
you know companies like TJMaxx years ago

89
00:06:49,499 --> 00:06:54,090
they're still around doing great work at
Target their stock drop it was minimal

90
00:06:54,090 --> 00:06:58,279
so when you put things into perspective
like this and you start looking at

91
00:06:58,279 --> 00:07:03,050
places that that have these types of
technologies you looking at kato plants

92
00:07:03,050 --> 00:07:07,680
nuclear plants hospitals all these are
places that you could cause physical

93
00:07:07,680 --> 00:07:11,840
harm physical destruction to not only
two people in that facility but around

94
00:07:11,840 --> 00:07:15,008
the facility imagine getting into a
nuclear plant causing destruction there

95
00:07:15,009 --> 00:07:18,039
and all these are using an integrated
technology that you'll see all

96
00:07:18,039 --> 00:07:22,289
passengers so how does it work

97
00:07:22,949 --> 00:07:29,330
got one here that it wasn't working

98
00:07:29,330 --> 00:07:34,409
it's all broke from flying on the blame
it's been three trips now with me but

99
00:07:34,409 --> 00:07:38,029
this is this is a bad system that I
purchased a company called midpoint

100
00:07:38,029 --> 00:07:41,979
security and they assemble whatever
badge technology you want to put in here

101
00:07:41,979 --> 00:07:48,479
so this is actually a new reg reader a
multi-class reader that or a controller

102
00:07:48,479 --> 00:07:51,889
animal to class reader supports both the
low-frequency and high-frequency

103
00:07:51,889 --> 00:07:57,300
an encrypted so it's a great way to
simulate what you guys have or what a

104
00:07:57,300 --> 00:08:01,240
company has for their entire facility
they would have an axe a reader on the

105
00:08:01,240 --> 00:08:04,610
outside the building would walk up there
they would then have a controller

106
00:08:04,610 --> 00:08:09,270
somewhere buried in a wall a switch
closet where the controller may be that

107
00:08:09,270 --> 00:08:13,639
controller than interfaces to a system
on the back end that is the badge

108
00:08:13,639 --> 00:08:19,050
software that controls who has access to
what was a user might have access just

109
00:08:19,050 --> 00:08:23,089
first wore a privileged user might have
access to a datacenter the bad system

110
00:08:23,089 --> 00:08:26,949
itself holds all these different roles
and access levels so those interface of

111
00:08:26,949 --> 00:08:30,879
the best system then you have things
like you might see when you walk out a

112
00:08:30,879 --> 00:08:38,329
push for snacks so the simulation have
forced exit you also have a simulation

113
00:08:38,328 --> 00:08:43,718
here that most stores have some kind of
magnetic alarm so if you break that they

114
00:08:43,719 --> 00:08:47,040
are not going to do it is loud if I
break that being that will stimulate the

115
00:08:47,040 --> 00:08:51,779
door was open without that bad actually
opening the door so great way to

116
00:08:51,779 --> 00:08:56,290
demonstrate how a bad system works but
essentially you look at the diagram here

117
00:08:56,790 --> 00:09:02,390
user walks up to add or bad as in
there's a field of ivory for the RFID

118
00:09:02,390 --> 00:09:08,500
reader itself powers the card
information stored on the card sends it

119
00:09:08,500 --> 00:09:13,529
back to the controller then converts
that to what's called weekend and on

120
00:09:13,529 --> 00:09:17,360
that side of the reader everything's
unencrypted and then from there to the

121
00:09:17,360 --> 00:09:23,420
bad system determines if you have access
to that particular reader that you're so

122
00:09:23,420 --> 00:09:31,160
far so hid is again there is an HID and
in my opinion the way I like to put it

123
00:09:31,160 --> 00:09:36,069
is there a Microsoft without Apple the
only market there's no other company out

124
00:09:36,069 --> 00:09:40,459
there that you can compete with what
they do or small little occurred over

125
00:09:40,459 --> 00:09:45,969
the years they have a small part of
market but it's a fraction hid house for

126
00:09:45,970 --> 00:09:50,800
years they've been putting out more and
more technologies but predominately the

127
00:09:50,800 --> 00:09:55,490
design of them if you open up a card is
there is an RFID chip inside of it and

128
00:09:55,490 --> 00:09:58,380
there's internet usually goes around the
perimeter of the card if you were to

129
00:09:58,380 --> 00:10:02,189
open up one of these cars you'd see one
of these types of formats they all kind

130
00:10:02,190 --> 00:10:08,310
of all the same process changes are
typically about the same there anywhere

131
00:10:08,310 --> 00:10:13,279
from one to two inches for these kinds
of cards are for these kinds of readers

132
00:10:13,279 --> 00:10:17,819
and then you look at a few of the big
garage salary or so in the parking

133
00:10:17,819 --> 00:10:21,839
garages airports things like that you'll
see a reader that's usually two feet 3

134
00:10:21,839 --> 00:10:22,890
think something like that

135
00:10:22,890 --> 00:10:30,480
square those have a much wider range so
the card directly up to the reader you

136
00:10:30,480 --> 00:10:33,500
can be a foot or two away from it so
we'll talk about how you can leverage

137
00:10:33,500 --> 00:10:39,970
some of those things well so on the back
in a reference to something called the

138
00:10:39,970 --> 00:10:45,180
weekend protocol is is how the reader
communicates to the axis controller

139
00:10:45,180 --> 00:10:49,880
there's essentially two wires Thursday
20 and 80 one day soon we're protocol

140
00:10:49,880 --> 00:10:56,240
back to the controller and unencrypted
and you can decode those attacks on the

141
00:10:56,240 --> 00:10:59,180
controller will talk about some of those
later in the talk so

142
00:10:59,180 --> 00:11:04,410
everything from the reader to the
controller is an unencrypted protocol

143
00:11:04,410 --> 00:11:10,800
call weekend so when you're thinking
about what is required for you to

144
00:11:10,800 --> 00:11:15,180
authenticate and gain access to a
particular door entry system there's

145
00:11:15,180 --> 00:11:18,640
three things that gets looked at when
you receive your card or your tag is

146
00:11:18,640 --> 00:11:26,180
what they call them to a reader they
look at what's called a card I 3537 bit

147
00:11:26,180 --> 00:11:27,290
whatever it might be

148
00:11:27,290 --> 00:11:34,300
it also looks at what you were assigned
to that building and also looks at what

149
00:11:34,300 --> 00:11:37,800
your access card number which is
typically printed on the card so really

150
00:11:37,800 --> 00:11:39,839
city code and access card number

151
00:11:39,840 --> 00:11:45,200
the only two pieces of data I need to
either for differential or present

152
00:11:45,200 --> 00:11:49,450
notification token to the reader to try
and gain access to that doorway facility

153
00:11:49,450 --> 00:11:54,160
code an access card the access card
number is typically printed on the badge

154
00:11:54,160 --> 00:11:59,510
now think of using the password if
you're walking around with a you know a

155
00:11:59,510 --> 00:12:03,680
tag on your chest name tag and had your
user name on it you would consider that

156
00:12:03,680 --> 00:12:06,819
somewhat of a league right now I know
what your username is all that is forgot

157
00:12:06,820 --> 00:12:12,330
your password code and access card
number or really just to user IDs or two

158
00:12:12,330 --> 00:12:17,170
passwords so if I can learn one off of
walking up to someone is looking at

159
00:12:17,170 --> 00:12:21,959
their badge someone post pictures of
them all the time online if I'm in a bad

160
00:12:21,960 --> 00:12:26,510
system and I can pull out now have at
least one of the two pieces required to

161
00:12:26,510 --> 00:12:29,770
authenticate there's multi-factor we can
talk about later that enforces

162
00:12:29,770 --> 00:12:35,890
biometrics and things like that those
flaws in those two but the the basis of

163
00:12:35,890 --> 00:12:39,689
an authentication when you attack your
reader is a facility code and a card

164
00:12:39,690 --> 00:12:46,130
number so they should consider private
your passwords whether it's encrypted on

165
00:12:46,130 --> 00:12:50,950
the back in its still weakened the data
those two pieces of information should

166
00:12:50,950 --> 00:12:54,110
be considered private what we are
finding when we were doing some of our

167
00:12:54,110 --> 00:13:00,670
research is like the postings online
course people also like to buy extra

168
00:13:00,670 --> 00:13:04,979
cards from ebay when they run out of
course because they've hired more

169
00:13:04,980 --> 00:13:10,780
employees it lost chords whatever you
look here and so when HIV cells extra

170
00:13:10,780 --> 00:13:12,350
cards they sell them in a series

171
00:13:12,350 --> 00:13:19,910
by a range of cards and it might be you
know 6000 6500 cards but then you know

172
00:13:19,910 --> 00:13:23,400
cost cuts budget cuts whatever you don't
have as many employees you thought you

173
00:13:23,400 --> 00:13:26,990
were going to you might want to sell
those carts people don't put those on

174
00:13:26,990 --> 00:13:34,620
eBay so on ebay they list right on the
box what my company code facility code

175
00:13:34,620 --> 00:13:40,540
is in the range of cards that are
selling so think of it in terms of us

176
00:13:40,540 --> 00:13:46,610
announced until collection right if I
figure out what the company to access

177
00:13:46,610 --> 00:13:51,110
card number and then I do some kind of
intelligence gathering on eBay seller

178
00:13:51,110 --> 00:13:55,100
cancel reply to find out who he works
for you than enough time I figure that

179
00:13:55,100 --> 00:13:58,960
out now I know the possibility coat and
possibly the range of access card

180
00:13:58,960 --> 00:14:03,820
numbers and then walk up to his facility
route numbers either before the ones he

181
00:14:03,820 --> 00:14:08,080
selling her after or just brute arranged
already know the facility code and gain

182
00:14:08,080 --> 00:14:15,920
access to the building because someone
stole some pretty bad so then we found

183
00:14:15,920 --> 00:14:23,680
another issue HIV results through
partners channels there's resellers out

184
00:14:23,680 --> 00:14:28,689
there that you can call up and say hey
I've got badge I don't know what my

185
00:14:28,690 --> 00:14:33,030
facility code is I don't know anything
about it because our admin that used to

186
00:14:33,030 --> 00:14:34,310
run the batch system got fired

187
00:14:34,310 --> 00:14:39,380
doesn't work anymore can you help me out
anymore courts will take the series

188
00:14:39,380 --> 00:14:41,610
number off of your heart

189
00:14:41,610 --> 00:14:46,900
look it up in a database interfaces hid
and they can tell you exactly which are

190
00:14:46,900 --> 00:14:51,970
based on the order strain which is on
the card so think of that from an attack

191
00:14:51,970 --> 00:14:55,990
perspective now if one channel partner
gets compromised and that access to that

192
00:14:55,990 --> 00:15:01,470
customer databases now I can look up any
serial number of water or any order

193
00:15:01,470 --> 00:15:08,540
number and access card numbers for that
particular company so another Intel leak

194
00:15:08,540 --> 00:15:11,860
that I've never even had to touch
anything on your company never had

195
00:15:11,860 --> 00:15:16,230
anything I've done all history until
Gathering online to find out information

196
00:15:16,230 --> 00:15:19,230
about how to get into your facility
before even show up

197
00:15:25,000 --> 00:15:30,160
of how the card numbers and and access
card numbers and agent goes all work

198
00:15:30,160 --> 00:15:33,510
together to authenticate but how easy it
is to gain information about even

199
00:15:33,510 --> 00:15:40,990
compromise so let's dig into a to how
you can attack RFID systems and an asset

200
00:15:40,990 --> 00:15:42,020
tax

201
00:15:42,020 --> 00:15:46,819
start out with a low frequency first
because it's it's been a horses and beat

202
00:15:46,820 --> 00:15:48,170
for four years

203
00:15:48,170 --> 00:15:51,829
everyone's talked about it as the new
technology new hardware that's come out

204
00:15:51,830 --> 00:15:56,340
but it's still seventy eighty percent
still

205
00:15:56,340 --> 00:16:01,710
unencrypted horrible can be closed can
be modified so a piece of hardware came

206
00:16:01,710 --> 00:16:05,650
out a few years ago it's been a number
of years now and it's kind of the Swiss

207
00:16:05,650 --> 00:16:12,620
army knife of RFID so if you want to
dive into the hardware is called a box

208
00:16:12,620 --> 00:16:18,040
marked three so you can buy a legitimate
from the vendor that makes them or you

209
00:16:18,040 --> 00:16:23,030
can buy from China $400 left's think
they're a list for four bucks and

210
00:16:23,030 --> 00:16:28,770
China's gone for like two or three at
the nearby the engine is reported so far

211
00:16:28,770 --> 00:16:33,110
less than 450 bucks need to go break
into eighty percent of the buildings out

212
00:16:33,110 --> 00:16:37,230
there it's pretty bad so there's a
couple ways you can use it

213
00:16:37,230 --> 00:16:40,120
there's a lot of different types of
attacks you can do with it not just a

214
00:16:40,120 --> 00:16:44,040
lower frequency in which you can also do
things like my fair which your bus

215
00:16:44,040 --> 00:16:55,490
passes your ski resort lift tickets your
meal cards actually so think about it

216
00:16:55,490 --> 00:16:59,890
from you know from that aspect right it
is not just a frequency that you have to

217
00:16:59,890 --> 00:17:08,139
put in some parts but is actually works
at a very high level were your

218
00:17:08,140 --> 00:17:13,750
controller or and this runs a operating
system firmware and then you've got a

219
00:17:13,750 --> 00:17:17,329
USB connection to interface with me see
whether its Windows Linux or if you want

220
00:17:17,329 --> 00:17:21,220
to use and then you got any antenna and
there's different types of antennas

221
00:17:21,220 --> 00:17:22,060
there's

222
00:17:22,060 --> 00:17:28,159
high-frequency antennas to get longer
rearranges you can supply extra power to

223
00:17:28,160 --> 00:17:32,080
arrange things like that so a lot of
different stuff you can do with

224
00:17:32,080 --> 00:17:38,720
three so first I want to show you how
easy it is to clone one of these

225
00:17:38,720 --> 00:17:42,960
unencrypted proxy port to which you're
eighty percent of the market again right

226
00:17:42,960 --> 00:18:06,320
so let's do that first you're so smart
three is a wizard mode kind of a

227
00:18:06,320 --> 00:18:11,460
standalone mode you can use it without a
minute there is also the ability to to

228
00:18:11,460 --> 00:18:14,500
watch the output which is what I want
you here so you guys can see what we're

229
00:18:14,500 --> 00:18:20,380
doing and to interface with it

230
00:18:20,990 --> 00:18:27,169
frequency hid modulation and I'll take
the card and so there's there's a couple

231
00:18:27,169 --> 00:18:32,450
of methods out there to acquire bad
information there's what the industry's

232
00:18:32,450 --> 00:18:37,090
kinda called how the blood test method
which David expertise and you can you

233
00:18:37,090 --> 00:18:43,570
can walk by and their badges and read it
that fast and essentially it works like

234
00:18:43,570 --> 00:19:05,029
this you put your reader into so as fast
as I resent to a line

235
00:19:11,080 --> 00:19:21,320
so as fast as I resent cards little read
and the crips information on those carts

236
00:19:21,320 --> 00:19:23,950
35 the card number

237
00:19:23,950 --> 00:19:29,630
good everything it reads one of those
prints obviously the standard also

238
00:19:29,630 --> 00:19:34,610
stores that in its memory buffer so in a
standalone mode I'll say that next and

239
00:19:34,610 --> 00:19:40,439
how you can work it you can set into a
stand-alone vote vote in the first card

240
00:19:40,440 --> 00:19:46,470
interacts with its rights to a memory
buffer is stores in their simulated and

241
00:19:46,470 --> 00:19:52,130
it replays what's in that mode so you
get the right one that were so

242
00:20:07,750 --> 00:20:24,040
44 indicates to this building so now we
do what's called simulation and we just

243
00:20:24,040 --> 00:20:36,790
paste information now its simulation
that tag so I gave the stalking through

244
00:20:36,790 --> 00:20:39,790
into laptops that have 5 dumbest

245
00:20:54,300 --> 00:20:57,300
so

246
00:20:57,940 --> 00:21:04,650
formation simulate replay it and people
that use these in our industry usually

247
00:21:04,650 --> 00:21:09,850
carry the products markets out of their
jacket when the cord on their sleeve to

248
00:21:09,850 --> 00:21:14,330
have these in their hand and walk up to
a building there inside no one thinks

249
00:21:14,330 --> 00:21:15,320
anything different

250
00:21:15,320 --> 00:21:20,379
the sad part about this attack these
types of attacks is the beach is enough

251
00:21:20,380 --> 00:21:24,950
for someone to trust that what you just
did was authorized and you can even get

252
00:21:24,950 --> 00:21:29,200
by with some of the things that we do
and I'm sure Dave team does well as just

253
00:21:29,200 --> 00:21:33,570
having a card that does it indicate what
makes the reader is usually enough to

254
00:21:33,570 --> 00:21:37,280
tell you to a building because someone
heard it be behind them they hold the

255
00:21:37,280 --> 00:21:40,149
door they don't realize that that
Bieber's bad

256
00:21:40,150 --> 00:21:43,900
is no different than a successful be
it's just a big the reader may display a

257
00:21:43,900 --> 00:21:48,900
reader rain if that's turned on but
that's enough for someone to not check

258
00:21:48,900 --> 00:21:52,470
the guy behind them hold the door for
you let you in so we always have a

259
00:21:52,470 --> 00:21:55,720
couple cars are pockets just trying to
indicate that he'll get into a building

260
00:21:55,720 --> 00:22:01,090
but essentially that's how that attack
works you're within range of someone you

261
00:22:01,090 --> 00:22:05,439
read that aggravation you then simulated
or go one step further in right that

262
00:22:05,440 --> 00:22:06,110
information

263
00:22:06,110 --> 00:22:11,290
clone command right that to a cartoon I
have a physical card and if that company

264
00:22:11,290 --> 00:22:17,420
is you know enhanced and they put actual
pictures on the badges badges you can

265
00:22:17,420 --> 00:22:20,700
put a picture on that edge so it looks
like you're an employee with someone

266
00:22:20,700 --> 00:22:24,980
else's cock information and now you can
walk up to a gym with a legitimate

267
00:22:24,980 --> 00:22:30,540
looking bad no one says anything so
pretty bad right now is that is anyone

268
00:22:30,540 --> 00:22:31,570
can do it

269
00:22:31,570 --> 00:22:37,889
push a button whatever so the rocks mark
becomes even more sexy when you can see

270
00:22:37,890 --> 00:22:46,010
it because you can get regular power
bank USB battery bury all this inside of

271
00:22:46,010 --> 00:22:51,710
a regular plastic keyboard transmits
RFID and now I'm walking around on

272
00:22:51,710 --> 00:22:58,110
campus with a keyboard or a clipboard
and that transmit the RFID from the

273
00:22:58,110 --> 00:23:02,530
internet so that I can walk up and
tapped the clipboard against the reader

274
00:23:02,530 --> 00:23:06,520
that transmits and let me into the
building as well so now it's concealed

275
00:23:06,520 --> 00:23:07,539
that it doesn't look

276
00:23:07,539 --> 00:23:10,799
I don't look like Joe hacker walking
around with you know crazy looking

277
00:23:10,799 --> 00:23:15,179
electronics hanging out of my tactical
jacket with forty pockets on it I'm

278
00:23:15,179 --> 00:23:18,259
walking up with a clipboard and chances
are if you get a clipboard you mean

279
00:23:18,259 --> 00:23:22,489
business and was gonna ask questions cuz
you look busy right so clipboards are

280
00:23:22,489 --> 00:23:27,100
one the best tools for users when he
tried to get into the facility is

281
00:23:27,100 --> 00:23:32,189
usually a collar shirt you're involved
with something no one's gonna question

282
00:23:32,190 --> 00:23:37,059
you know you look like you're busy so
that's kind of just a quick demo of how

283
00:23:37,059 --> 00:23:41,059
easy it is to again break into eighty
percent of the buildings out early that

284
00:23:41,059 --> 00:23:51,369
use frequency so in perspective of we're
RFID has come from when it relates to

285
00:23:51,369 --> 00:24:03,199
the low frequency products court Tues so
someone decided that found stone Brad

286
00:24:03,200 --> 00:24:09,529
into its settings they pronounced it a
couple years ago took the firmware of

287
00:24:09,529 --> 00:24:14,710
the products mark and customize it and
wrote something operatic route so now

288
00:24:14,710 --> 00:24:21,789
think of this in a situation where I
still cats vag whether I take a picture

289
00:24:21,789 --> 00:24:26,559
of it or I find in the bed method was to
get the facility Co the access card

290
00:24:26,559 --> 00:24:30,879
number in the car type and then I have
this information but pat doesn't have

291
00:24:30,879 --> 00:24:35,779
access to a char area where the
executive floor or wherever I want to go

292
00:24:35,779 --> 00:24:41,679
there has elevated privileges data
center so code for that building still

293
00:24:41,679 --> 00:24:46,379
gonna be the same most likely in most
cases it is but someone else's bad has

294
00:24:46,379 --> 00:24:52,158
access to that reader to get into that
security area of the facility so it is a

295
00:24:52,159 --> 00:24:55,950
different batch number right still seem
facility code still think are tight but

296
00:24:55,950 --> 00:24:58,889
someone else has a different batch
number assigned to them and they have

297
00:24:58,889 --> 00:25:06,248
extra rights so someone came up with a
method to brute through a series of

298
00:25:06,249 --> 00:25:09,950
access card numbers so using a proxy for
custom firmware I don't have that

299
00:25:09,950 --> 00:25:13,840
firmware on here you can read someone's
card

300
00:25:15,049 --> 00:25:19,529
pools the facility code and it starts at
a series of bad ideas you give it

301
00:25:19,529 --> 00:25:23,940
through one by one and you hold up to
the reader and it presents one every

302
00:25:23,940 --> 00:25:29,169
half 2nd second wherever he said until
it finds one that opens the door so

303
00:25:29,169 --> 00:25:36,200
literally rolling up so pretty simple
method because it's all an encrypted the

304
00:25:36,200 --> 00:25:41,460
overhead or that transaction isn't very
intensive so it does take a lot of

305
00:25:41,460 --> 00:25:45,610
computing power to brute force those
credentials so can all be done just you

306
00:25:45,610 --> 00:25:50,619
know small little processors and so
something that you know obviously became

307
00:25:50,619 --> 00:25:55,320
a big issue there was being able to
elevate privileges just put it in

308
00:25:55,320 --> 00:26:02,428
perspective of a Windows environment I
have standard access user that has email

309
00:26:02,429 --> 00:26:06,330
and SharePoint doesn't have access to
everything else but now I can brute

310
00:26:06,330 --> 00:26:10,470
force a bunch of usernames essentially
until I find the right using to get into

311
00:26:10,470 --> 00:26:15,460
domain controllers get into you you know
Linux environment whatever might be so

312
00:26:15,460 --> 00:26:18,879
I've gone from standard user to
superuser just by breathing through a

313
00:26:18,879 --> 00:26:24,109
series of just one property which is the
access card pretty bad right direction

314
00:26:24,109 --> 00:26:31,119
so obviously became something big for
our industry but we decided that we want

315
00:26:31,119 --> 00:26:35,619
to take it one step further and figure
out how to do what I've always referred

316
00:26:35,619 --> 00:26:40,379
to as smart reporting I talked in the
past they've talked about it some too is

317
00:26:40,379 --> 00:26:45,509
if an attacker I don't want to generate
so much in the way that you're gonna

318
00:26:45,509 --> 00:26:51,649
find me want to be smart and intelligent
about how I tilt my logins brute forcing

319
00:26:51,649 --> 00:26:55,379
things on the outside I'm not gonna run
dictionary of thirty thousand words but

320
00:26:55,379 --> 00:26:58,248
chances are the one you're gonna see
that you're going to stop me with an IPS

321
00:26:58,249 --> 00:27:04,629
something or 2 I'm gonna walk an account
now in batches counts but I'm generated

322
00:27:04,629 --> 00:27:08,369
enough noise and traffic you're going to
see that at some point so I don't

323
00:27:08,369 --> 00:27:12,549
necessarily want to walk up to a reader
in it for 10 minutes and looked like you

324
00:27:12,549 --> 00:27:16,230
know look suspiciously I'm standing
there with my head at two o'clock in the

325
00:27:16,230 --> 00:27:20,080
morning badge in waiting in a baby
smoking a cigarette or something to

326
00:27:20,080 --> 00:27:23,970
consider myself but at some point
someone's going to catch me

327
00:27:23,970 --> 00:27:28,180
maybe if there's a camera on that day or
whatever so let's be more intelligent

328
00:27:28,180 --> 00:27:33,520
about how we try to indicate in an
attempt to negotiations so this is where

329
00:27:33,520 --> 00:27:38,560
the Red Team threats of comes in right
if I can learn information either about

330
00:27:38,560 --> 00:27:42,510
you as a target or I can learn
information from a bad system and

331
00:27:42,510 --> 00:27:47,850
extracted data because I can look up and
see ok pat has access to first floor but

332
00:27:47,850 --> 00:27:53,100
Scott has access to data center and
Scott badge numbers this now let's take

333
00:27:53,100 --> 00:27:57,100
the information I know from Dave or
pattern whoever by example as it's now

334
00:27:57,100 --> 00:28:02,590
and then showed that data in that I need
that associated a card number

335
00:28:03,380 --> 00:28:08,690
make my asset tag in electronic format
then simulate that now I've done one

336
00:28:08,690 --> 00:28:13,130
attempt but I use the information I've
learned from ocean from attack on bad

337
00:28:13,130 --> 00:28:19,020
system from whatever and then I simulate
that so what i'm showing here is kinda

338
00:28:19,020 --> 00:28:26,910
how the the binary stream appears and
then convert that to hexadecimal format

339
00:28:26,910 --> 00:28:31,310
which is essentially what that tag ideas
so I showed you before was we did the

340
00:28:31,310 --> 00:28:35,149
modulation demodulation gave us the tag
information after the heck string was

341
00:28:35,150 --> 00:28:39,950
decoded and then what I did in the next
example was broken down one step further

342
00:28:39,950 --> 00:28:46,870
so you can see what that binary string
looks like so 435 card format there's

343
00:28:46,870 --> 00:28:51,729
always parody on both sides of the
string there's always a preamble based

344
00:28:51,730 --> 00:28:55,650
on what kind of course format is always
remember that strength so I know where

345
00:28:55,650 --> 00:28:59,460
my start stop is my code as well as
access card number which is what I'm

346
00:28:59,460 --> 00:29:05,410
showing green and purple then I just
modify my access card number to match

347
00:29:05,410 --> 00:29:10,990
the target in 2012 now I generate that
through anything online or you can write

348
00:29:10,990 --> 00:29:14,840
a script where we wrote a script for
example appears I'm going from hexa

349
00:29:14,840 --> 00:29:19,360
decimal to binary takes you know half
second right something's going to do it

350
00:29:19,360 --> 00:29:24,100
for your script whatever you want to do
so I generates my strength from my badge

351
00:29:24,100 --> 00:29:27,689
number that I want to become that back
into my stream

352
00:29:27,690 --> 00:29:33,470
converted back the other way hexadecimal
and a similar that all encrypted again

353
00:29:33,470 --> 00:29:36,760
I've taken a portion of the credentials

354
00:29:36,760 --> 00:29:42,740
set modified it created the stream back
and I need for the hex tag reader all

355
00:29:42,740 --> 00:29:49,200
again unencrypted very easy to do so

356
00:29:53,050 --> 00:29:57,860
show there was was what I just did which
we were just generate that with the

357
00:29:57,860 --> 00:30:02,449
script whatever a step back into
simulation command before that within

358
00:30:02,450 --> 00:30:06,580
badge in much better shape than a shower
before so it's a good time of get on to

359
00:30:06,580 --> 00:30:11,470
the next day off so we've gone from
nothing to clone and stimulate every

360
00:30:11,470 --> 00:30:17,980
play and then also read or learn
information modify and elevate frivolous

361
00:30:17,980 --> 00:30:24,310
so two solid attacks with with proxy
cards that are eighty percent of the

362
00:30:24,310 --> 00:30:30,500
market again so now I can learn what I
need within inches of someone I can

363
00:30:30,500 --> 00:30:35,060
learn from bad I can learn off buying
cards are looking up information about a

364
00:30:35,060 --> 00:30:40,740
company or whatever I can you know
social and my way into something we do a

365
00:30:40,740 --> 00:30:44,510
lot of work is maybe I come in

366
00:30:44,510 --> 00:30:48,870
interview for a job or I get a tour of
your building something that is going to

367
00:30:48,870 --> 00:30:54,909
give me a visitor patch chances are that
matches the same facility code but a

368
00:30:54,910 --> 00:31:00,490
limited access card number to just get
me in first floor lobby to break room or

369
00:31:00,490 --> 00:31:06,860
wherever they're gonna allow me to go as
a visitor so I the bathroom it's hard

370
00:31:06,860 --> 00:31:09,709
right information then go back home

371
00:31:09,710 --> 00:31:12,950
create a bunch of cards learn more
information take pictures somebody's

372
00:31:12,950 --> 00:31:16,690
card whatever make the card I wanna make
to match an actual employee has access

373
00:31:17,600 --> 00:31:21,060
come back in a later date just with what
I learned from a visitor badge that was

374
00:31:21,060 --> 00:31:25,040
given to me during a tour or an
interview or whatever so they have a

375
00:31:25,040 --> 00:31:30,500
perspective that way if I'm able to get
one read off a badge that can turn into

376
00:31:30,500 --> 00:31:34,880
elevated privileges pretty easily so

377
00:31:35,420 --> 00:31:43,120
to to extend our our attack range of
having to make it obvious and go up and

378
00:31:43,120 --> 00:31:46,959
tap somebody to get the asset
information if they had a hangover waste

379
00:31:46,960 --> 00:31:53,700
or lanyard or whatever let's increase
our or our distance for attack so from

380
00:31:53,700 --> 00:31:58,460
standard reader on the side of a
building that usually has a read range

381
00:31:58,460 --> 00:32:06,930
of ZnO couple years you know if you're
looking to what usually find a parking

382
00:32:06,930 --> 00:32:12,290
garages because they don't you get a
liqueur your car gets the concrete

383
00:32:12,290 --> 00:32:17,149
pylons there or it might be raining they
want to see vehicle whatever might be

384
00:32:17,150 --> 00:32:25,000
moving out the window so now you have a
larger reader larger internal power is a

385
00:32:25,000 --> 00:32:32,410
bit different and that now extends the
range 2 to 3 feet so that an attack

386
00:32:32,410 --> 00:32:36,450
perspective to 3 feet is me walking up
and ask somebody for a lighter cigarette

387
00:32:36,450 --> 00:32:43,570
or asking directions or just having a
conversation so now I've gone from being

388
00:32:43,570 --> 00:32:49,000
suspicious attacker tapping someone to a
personal history of a conversation and

389
00:32:49,000 --> 00:32:55,390
I've read what I need and the way that
we do that is we took a standard reader

390
00:32:55,390 --> 00:33:01,470
stock off the shelf by one online for 34
bucks and we did the research that some

391
00:33:01,470 --> 00:33:05,550
of this we took it a bit further later
on talk about and Audrina

392
00:33:06,710 --> 00:33:12,140
assets on the other side of the reader
where the if it's encrypted where the

393
00:33:12,140 --> 00:33:16,940
unencrypted data would occur the weekend
data and it reads the weekend data

394
00:33:16,940 --> 00:33:22,350
echoes it extracts all the information
they need access card number and cards

395
00:33:22,350 --> 00:33:27,399
and if it's encrypted data tells me that
as well so they somebody put some

396
00:33:27,400 --> 00:33:31,420
clothes out a few years ago we use that
code along with some other researchers

397
00:33:31,420 --> 00:33:38,280
have used it to modify it a bit and we
now have a hard reno that sits inside of

398
00:33:38,280 --> 00:33:43,300
this reader and what's cool about this
reader is it can be deployed a number of

399
00:33:43,300 --> 00:33:47,580
ways you can put it in your briefcase
and walk around and

400
00:33:47,580 --> 00:33:52,689
you know if your European your satchel
call it and you walk around with your

401
00:33:52,690 --> 00:33:57,120
purse and walk through a crowd of people
and as a crowd of people anyone who has

402
00:33:57,120 --> 00:34:02,060
an expose RFID tag I'm reading of a min
within that range in its right into a

403
00:34:02,060 --> 00:34:06,110
nasty court go back to my scary van in
the parking lot I look at all my

404
00:34:06,110 --> 00:34:10,520
information I pull out which ones I want
I write my cards I walked back into the

405
00:34:10,520 --> 00:34:13,909
building and I've done all that just by
walking through a crowd of people and

406
00:34:13,909 --> 00:34:17,420
within two to three feet provided have
enough power for that reader I'm now

407
00:34:17,420 --> 00:34:21,639
siphoning data off so now

408
00:34:22,560 --> 00:34:28,320
couple that with what we've just talked
about hard and I've gone from walking to

409
00:34:28,320 --> 00:34:32,770
a crowd of people to creating asset
credentials that I need or want to

410
00:34:32,770 --> 00:34:40,780
create and encrypted in the reason that
it's so simple as because it's encrypted

411
00:34:40,780 --> 00:34:49,150
so here's where it gets fun hid decided
all right let's solve this problem and

412
00:34:49,150 --> 00:34:56,810
create an encrypted ass attack so
everything from card which looks like I

413
00:34:56,810 --> 00:35:01,910
should get up close on it you look at
the details everything from car to

414
00:35:01,910 --> 00:35:07,240
reader is encrypted so someone snoopy
that connection it's a group that I can

415
00:35:07,240 --> 00:35:11,700
just Dakota like I did walking up
tapping the card is encrypted from

416
00:35:11,700 --> 00:35:16,669
reader to controller is still unclear
that still week so we'll talk about a

417
00:35:16,670 --> 00:35:24,340
tax on that side of the fence later but
everything from asset tag reader so that

418
00:35:24,340 --> 00:35:32,450
means awesome so we decided let's take
the same attack and let's modify the

419
00:35:32,450 --> 00:35:36,080
code a bit more and now it's be able to
do the same thing and get the

420
00:35:36,080 --> 00:35:39,410
information I need all these encrypted
cards because we'll talk about a minute

421
00:35:39,410 --> 00:35:44,259
is we can also do some of these same
attacks but now you're talking ten

422
00:35:44,260 --> 00:35:45,260
percent of the market

423
00:35:45,260 --> 00:35:49,640
whatever that statistic is not the
seventy to eighty thousand so this is

424
00:35:49,640 --> 00:35:54,330
more of a specialized focused attack on
someone has a higher level of security

425
00:35:54,330 --> 00:36:00,009
problem with that is the cost to replace
all of your unencrypted arrears

426
00:36:00,010 --> 00:36:03,890
and then provision new cards for all
your employees and your that transition

427
00:36:03,890 --> 00:36:08,069
phase you're rolling out its new cards
is pretty impactful to accompany him to

428
00:36:08,070 --> 00:36:12,630
go in and just replace it all so chances
are usually those companies only do

429
00:36:12,630 --> 00:36:15,520
things like this when they move into a
new building where they're building a

430
00:36:15,520 --> 00:36:20,860
facility or even somewhere he has it
they don't go usually retrofit you know

431
00:36:20,860 --> 00:36:24,020
new technology sometimes for these
things because you're talking about

432
00:36:24,020 --> 00:36:27,380
pulling drywall pulling cables it's not
as easy as replacing the reader

433
00:36:27,380 --> 00:36:33,530
sometimes replacing the controllers
giving everyone a new card so the the

434
00:36:33,530 --> 00:36:37,540
architectural changes in the costs
obviously is is more of an impact

435
00:36:37,540 --> 00:36:41,700
sometimes so this is obviously smaller
market but high-level security

436
00:36:41,700 --> 00:36:45,930
facilities are probably going to have
these so we did the same thing same

437
00:36:45,930 --> 00:36:50,480
concept use a large reader this time is
different models are ninety instead of a

438
00:36:50,480 --> 00:36:55,990
maxi products and we took our ninety
connected on our geo to it

439
00:36:55,990 --> 00:36:59,899
to wire state is your day 2012 read the
weekend data in the right to an sdcard

440
00:36:59,900 --> 00:37:06,470
again same thing to 3 feet the rear ends
a little differently I class and I can

441
00:37:06,470 --> 00:37:10,339
get that information I need to same
process right now as far as to what I

442
00:37:10,340 --> 00:37:16,710
want to do so this kind of just give you
a high level we took it one step further

443
00:37:16,710 --> 00:37:18,030
putting LCD on it

444
00:37:18,030 --> 00:37:21,660
LCD prints out what it reads I don't
have to take it back to the van and

445
00:37:21,660 --> 00:37:26,779
polyester information although the
Prince's lolz day there's an example of

446
00:37:26,780 --> 00:37:36,460
a Reno now a cardinal and we did all
this in enforcing so you can actually go

447
00:37:36,460 --> 00:37:42,220
preacher on board if you want to do and
then it gives you exact locations where

448
00:37:42,220 --> 00:37:48,209
you need to sort everything go one step
further and pretty bored and connect the

449
00:37:48,210 --> 00:37:51,990
Arjuna directly to the board so couple
ways you can go further with it we've

450
00:37:51,990 --> 00:37:56,450
got a bit further sort of corporate into
some of our readers but concept is

451
00:37:56,450 --> 00:37:57,529
pretty simple right

452
00:37:57,530 --> 00:38:02,540
the Argentine assets on the unencrypted
side reads data 0221 wires that we can

453
00:38:02,540 --> 00:38:08,000
information prints out the data you need
and we have a link that we have four

454
00:38:08,000 --> 00:38:11,579
large consulting and hopefully we have
our code

455
00:38:11,579 --> 00:38:21,549
so here's where it gets fun in 2010
someone couple of researchers milosz did

456
00:38:21,549 --> 00:38:28,900
if that's how you pronounce his name up
there he did a paper that's become the

457
00:38:28,900 --> 00:38:35,099
Bible of class acting is what's called
the heart of darkness are targets breaks

458
00:38:35,099 --> 00:38:40,209
down everything start to finish and how
that I clasp cards work from the group

459
00:38:40,209 --> 00:38:45,700
their routines to the ciphers to the
algorithms everything is in this paper

460
00:38:45,700 --> 00:38:51,109
and what they discovered they were doing
their research is not this reader but

461
00:38:51,109 --> 00:38:56,009
another record of you three hundred the
revision a reader's that came out had

462
00:38:56,009 --> 00:39:01,219
the serial interface still enable
disable the interface given enough

463
00:39:01,219 --> 00:39:06,700
research someone finally figured out how
to wire up and connect to the serial

464
00:39:06,700 --> 00:39:10,859
interface and don't the firmware and saw
the firmware for the encryption keys

465
00:39:10,859 --> 00:39:16,519
right class so now you could go by
revision a reader pull the firmware

466
00:39:16,519 --> 00:39:21,029
encryption keys and essentially become
hid and do whatever I want to do with a

467
00:39:21,029 --> 00:39:26,739
night class car because I can write my
class just like hid could so use the

468
00:39:26,739 --> 00:39:31,969
data card same attacks we do with the
boss 429 now I class essentially became

469
00:39:31,969 --> 00:39:36,099
a parts car to an unencrypted card if
you will because the key was stolen

470
00:39:36,099 --> 00:39:43,089
right so you would think you obviously
will be changed the case your password

471
00:39:43,089 --> 00:39:45,969
is compromised he has compromised
whatever it is

472
00:39:45,969 --> 00:39:51,789
change the damn key right there was put
out new readers and disabled serial

473
00:39:51,789 --> 00:39:53,579
nervous so it can't happen again

474
00:39:53,579 --> 00:39:56,579
worst vacation ever

475
00:39:57,109 --> 00:40:05,130
today they still use the same encryption
key so five years later thinking so that

476
00:40:05,130 --> 00:40:10,499
he obviously isn't on paper but you go
out and you get a reader off ebay for 30

477
00:40:10,499 --> 00:40:15,169
bucks all the processes outlined align
the firmware get key

478
00:40:18,410 --> 00:40:22,230
so that obviously did you know a tidal
wave of things

479
00:40:22,230 --> 00:40:26,140
cloning became possible which is
essentially what we do with the boxcar

480
00:40:26,140 --> 00:40:32,430
to the mark as of last week just had
some functionality added to the firmware

481
00:40:32,430 --> 00:40:37,270
do the same things with a class I can
close I can simulate a replay I can make

482
00:40:37,270 --> 00:40:43,740
my own information generate my own tags
all those types of things all because I

483
00:40:43,740 --> 00:40:50,038
have that theoretically if I had it have
the master key to do those things but

484
00:40:50,039 --> 00:40:59,010
you can always call prison China and you
can buy a stock on the key reader 5321

485
00:40:59,010 --> 00:41:05,319
is the model and you call China which
has been around for a long time there

486
00:41:05,319 --> 00:41:14,400
were three so far from there and you buy
their eyeglass cleaner

487
00:41:15,690 --> 00:41:23,760
corner really is is a key authentication
he the master key the decryption key on

488
00:41:23,760 --> 00:41:30,319
USB Drive and a custom driver not unlike
the customer China thing so that's why I

489
00:41:30,319 --> 00:41:39,240
have another laptop network so it's the
actual data but essentially they've

490
00:41:39,240 --> 00:41:43,098
written a custom driver to interface
with this an actor's hid and give you

491
00:41:43,099 --> 00:41:48,210
the ability to do the same thing we did
with aprox to take a class or do I get

492
00:41:48,210 --> 00:41:54,450
my hands on one and the information
stored in the memory blocks I'll do a

493
00:41:54,450 --> 00:42:01,109
quick demo at work so how easy is it to
clone that I class starts

494
00:42:06,420 --> 00:42:25,520
Josh last RFID classes and they said no
so I figured this obviously would be

495
00:42:25,520 --> 00:42:31,980
some dug into the research of it but at
a high level it's pretty simple to

496
00:42:31,980 --> 00:42:37,720
understand right stuff is easy to
understand because it's all an assist a

497
00:42:37,720 --> 00:42:40,868
vindication routine that a card is
presented to a reader

498
00:42:40,869 --> 00:42:47,299
intercept that data is no difference
between the wire network like and sniff

499
00:42:47,299 --> 00:42:50,650
and get a username and password you
don't have to be a genius to present

500
00:42:50,650 --> 00:42:53,720
that somewhere you just figure out what
they used a password isn't how to

501
00:42:53,720 --> 00:42:59,348
present it to whatever you're in this
case it's a reader not a website so

502
00:43:28,620 --> 00:43:37,640
gods

503
00:45:03,369 --> 00:45:19,809
here we've got a few minutes

504
00:45:38,630 --> 00:46:07,029
perspective from Chi perspective you can
protect the data that's leaking off the

505
00:46:07,029 --> 00:46:12,250
card if you will but really the right
way to protect these types of the tax is

506
00:46:12,250 --> 00:46:21,369
protect the bag system itself more than
anything right if if i learn your

507
00:46:21,369 --> 00:46:25,519
password I shouldn't be able to
compromise your entire organization and

508
00:46:25,519 --> 00:46:29,359
that's essentially what happen here file
earn one piece of data off these badges

509
00:46:29,359 --> 00:46:33,240
chances are good he'll be privileges to
super user and then get to where I need

510
00:46:33,240 --> 00:46:38,879
to go right so this is standard security
i class when you talk about the IPSP

511
00:46:38,880 --> 00:46:46,480
Starbucks cards you can do except limit
what could happen if if an attack were

512
00:46:46,480 --> 00:46:51,339
to occur you can put two factors some of
the things that you actually all talk

513
00:46:51,339 --> 00:47:01,170
about now so I classical want to show
that I'm not putting on this laptop has

514
00:47:01,170 --> 00:47:11,210
its China the demo essentially dumps the
card information and list out the block

515
00:47:11,210 --> 00:47:14,210
data stored on the card

516
00:47:18,570 --> 00:47:21,570
broker now this work

517
00:48:10,180 --> 00:48:29,109
security a custom key for your facility
so custom encryption key instead of the

518
00:48:29,110 --> 00:48:31,630
leaky that came off of the reader so
that's where you're going with it right

519
00:48:31,630 --> 00:48:33,450
and you set a custom p

520
00:48:33,450 --> 00:48:38,200
there's some discoveries in that real
now with elite security high security

521
00:48:38,200 --> 00:48:47,310
and the reader itself the technology
used the occasion process uses a weak

522
00:48:47,310 --> 00:48:52,640
encryption which is similar to death so
many miners indifference when does this

523
00:48:52,640 --> 00:48:55,609
does obviously can be brutal pretty
easily

524
00:48:55,610 --> 00:49:00,460
the attack that can occur on a custom
security key applied which is high

525
00:49:00,460 --> 00:49:04,800
security leak security is you can use
the products work now with new code and

526
00:49:04,800 --> 00:49:09,000
present a number of indications hips
against a reader capture enough data go

527
00:49:09,000 --> 00:49:13,320
back and brute force that encryption key
and then used a key versus the stolen

528
00:49:13,320 --> 00:49:18,310
key and do the same thing again with a
class right so what I wanted to show

529
00:49:18,310 --> 00:49:27,930
what it looks like when someone you
don't like last card

530
00:49:29,609 --> 00:49:35,489
number of blocks that you are concerned
with lots 0 is the serial number

531
00:49:36,109 --> 00:49:39,759
hardly any passes out there use the
serial number to indicate with you can

532
00:49:39,759 --> 00:49:44,440
force as long as in the support a range
of what a night class you're supposed to

533
00:49:44,440 --> 00:49:50,630
be like 12 where our data about the
court itself like six is usually card

534
00:49:50,630 --> 00:49:57,230
type like seven is where the silicon the
access card number is stored block 89 is

535
00:49:57,230 --> 00:50:04,150
typically wear to factor data elements
are stored by open things like that so

536
00:50:04,150 --> 00:50:10,480
here's the stink about bio alluded to
earlier if in some situations if you

537
00:50:10,480 --> 00:50:16,029
have to factor in place your second
factor authentication is stored on the

538
00:50:16,029 --> 00:50:24,539
cart to see that again so the pin and
the bio is stored on the car so when I

539
00:50:24,539 --> 00:50:30,259
walk up and resent my tagged the reader
the Reader goes card number is allowed

540
00:50:30,259 --> 00:50:34,489
to authenticate facility goes live with
indicate what is your PIN or what is

541
00:50:34,489 --> 00:50:37,660
your fingerprint you then enter that
data

542
00:50:37,660 --> 00:50:44,989
validates that against what's on your
card lines so all I have to do is copy

543
00:50:44,989 --> 00:50:49,059
Dave's card I don't care what his
fingerprint is I make an electronic

544
00:50:49,059 --> 00:50:53,670
signature of my fingerprint whatever my
block a block 9 will look like or my pin

545
00:50:53,670 --> 00:50:59,220
number and put that into block a block 9
in now a nice indicated that reader I

546
00:50:59,220 --> 00:51:05,629
know what my pin is because I said it in
blocking blood flow to factor is that

547
00:51:05,630 --> 00:51:07,210
way it doesn't exist

548
00:51:07,210 --> 00:51:10,079
client-side validation everyone knows
that does web apps and things like that

549
00:51:10,079 --> 00:51:15,410
his client side validation is the worst
you could have right there's nothing to

550
00:51:15,410 --> 00:51:20,480
have any type of integrity about that
information is all forged so you can

551
00:51:20,480 --> 00:51:24,989
overwrite information so what I want to
show was how easy it is just what the

552
00:51:24,989 --> 00:51:30,499
army he to do all those blocks take a
blank card writers block back to the

553
00:51:30,499 --> 00:51:35,180
heart and soul of a night class card
because I had that master encryption

554
00:51:35,180 --> 00:51:40,470
stolen back in 2010 you can then
elevated privileges go one step further

555
00:51:40,470 --> 00:51:41,618
and

556
00:51:41,619 --> 00:51:45,619
and generate the information you need
for block seven which is your facility

557
00:51:45,619 --> 00:51:50,130
code access card number and write that
down to now have gone from standard

558
00:51:50,130 --> 00:51:55,059
security standard user to elevate user
because I modified my blocks of

559
00:51:55,059 --> 00:51:59,950
information which is my access code for
the elevated views about 12 minutes so

560
00:51:59,950 --> 00:52:06,439
again you know the class offers
encryption so someone can snoop the

561
00:52:06,440 --> 00:52:10,589
connection but what good is a cryptic
easy compromise that's really what all

562
00:52:10,589 --> 00:52:16,779
this boils down too so leave a minute or
two for questions is a couple of other

563
00:52:16,779 --> 00:52:23,220
things that you can do it is about one
is what's called the Gecko attack attack

564
00:52:23,220 --> 00:52:29,410
is essentially snapping in today 2021
wires on the backside of the reader is

565
00:52:29,410 --> 00:52:30,399
unencrypted

566
00:52:30,400 --> 00:52:34,240
intercept that we can data as a bad
indicates now have the information I

567
00:52:34,240 --> 00:52:38,640
need to go make the badge because now of
fighting off the data that I need for

568
00:52:38,640 --> 00:52:44,828
cards I so there's a tax of you can
physically get to the controller of the

569
00:52:44,829 --> 00:52:48,450
wiring behind the reader which
essentially is pull the reader off all

570
00:52:48,450 --> 00:52:54,339
your data one and sniffing to date all
those wires and it's what's called a

571
00:52:54,339 --> 00:52:58,739
gecko attack so research and learning
more about that one

572
00:52:59,259 --> 00:53:04,880
there's also the the blended threats we
talked about before right if I can gain

573
00:53:04,880 --> 00:53:08,730
access to a bad system itself the
Badshah for the roses system I can

574
00:53:08,730 --> 00:53:11,739
extract information off the system and
start doing what I need to do their

575
00:53:11,739 --> 00:53:18,869
respective mitigation peace really is
the last talked about we're doing so I

576
00:53:18,869 --> 00:53:22,819
can talk about after we're done we're
going to run out of time but there's a

577
00:53:22,819 --> 00:53:25,799
there's some stuff that there were
starting to build now that will

578
00:53:25,799 --> 00:53:30,839
basically simulate kind of a mesh
network of all the red team members so

579
00:53:30,839 --> 00:53:35,078
maybe I have someone in the parking lot
is running the equipment and doing the

580
00:53:35,079 --> 00:53:40,049
card builds and you know taking the date
of someone's feeding them out a an

581
00:53:40,049 --> 00:53:44,640
operational person in the field and
using a mesh network to feed all that

582
00:53:44,640 --> 00:53:48,440
data back and forth whether it's a
microcontroller that's buried

583
00:53:48,440 --> 00:53:54,890
in a Micro PC with a signal connection
or 3G or 4G connection somewhere down

584
00:53:54,890 --> 00:53:58,379
the field siphoning cards get the data
they need public back to the guy in the

585
00:53:58,380 --> 00:54:04,109
van van's making cards in simulating tag
during those things back to the reader

586
00:54:04,109 --> 00:54:09,220
in the field in the fields of walking so
creating a collaboration of team members

587
00:54:09,220 --> 00:54:14,540
to expedite access into a building
essentially a one person taking the

588
00:54:14,540 --> 00:54:18,020
chance of getting burned but three or
four people on it each person has a

589
00:54:18,020 --> 00:54:22,020
different role within that attack and
feel that centrally to a place that we

590
00:54:22,020 --> 00:54:27,390
need also being able to back door reader
itself so what if I get back to a reader

591
00:54:27,390 --> 00:54:29,170
in this has been done already

592
00:54:29,170 --> 00:54:33,200
back to a reader in every time someone
who hates I loaded it into something I

593
00:54:33,200 --> 00:54:36,980
come back later twenty-four hours later
I take it out the reader home and I'll

594
00:54:36,980 --> 00:54:41,430
get the data I need instead of taking
the chances of you know I am I gonna get

595
00:54:41,430 --> 00:54:46,339
a good read a lot of people get the
right off the bat bags into the reader

596
00:54:46,339 --> 00:54:52,828
for the days when sdcard ever want to
store or actual traded over 3G or maybe

597
00:54:52,829 --> 00:54:56,599
the wireless on that campus and now have
gained the information I need to go back

598
00:54:56,599 --> 00:55:04,890
to a reader mitigation there's there's
really not a lot you can do to protect

599
00:55:04,890 --> 00:55:09,598
the tag on the cheap RFID sleeves they
do work they're decent some of them in

600
00:55:09,599 --> 00:55:14,890
approving the network as well but really
what you want to do is implement a

601
00:55:14,890 --> 00:55:19,598
system that has the right to technology
not something that's right to the court

602
00:55:19,599 --> 00:55:24,960
there are systems out there that do
server-side validation air gap the

603
00:55:24,960 --> 00:55:28,869
bestest I should be able to compromise
your Active Directory environment and an

604
00:55:28,869 --> 00:55:34,220
RDP to your badges happens a lot we we
see a lot some companies now are getting

605
00:55:34,220 --> 00:55:39,250
smart in their air gap in that just like
they would there be no RSA server

606
00:55:39,250 --> 00:55:44,540
security service here got that thing off
the network so that I can pivot from

607
00:55:44,540 --> 00:55:48,960
compromising user workstation to getting
domain admin to getting that system as I

608
00:55:48,960 --> 00:55:52,460
get the bad system chances are can then
get your facility could get your access

609
00:55:52,460 --> 00:55:55,329
card numbers I now who's in the building
at that time

610
00:55:55,329 --> 00:55:59,540
find out what you know what access level
they have can they get there sooner or

611
00:55:59,540 --> 00:56:01,400
even better what we like to do

612
00:56:01,400 --> 00:56:08,570
compromises open the doors so I'm in a
bad system remotely Dave's on-site I say

613
00:56:08,570 --> 00:56:14,480
goes right datacenter door open they
wanted so the blended threats up is

614
00:56:14,480 --> 00:56:18,450
really where the beauty is for some of
these days and then the last thing is

615
00:56:18,450 --> 00:56:23,520
something that we haven't seen as an
industry yet and that's kinda IPS

616
00:56:23,520 --> 00:56:27,740
technology around that doesn't exist
today all batches of have their own

617
00:56:27,740 --> 00:56:31,830
logging for good or bad whatever they
are no one's really centralizing those

618
00:56:31,830 --> 00:56:37,580
logs like they do other systems in the
environments but there's really no IPS

619
00:56:37,580 --> 00:56:43,990
system that would detect if someone
walked up to 50 immediate indication

620
00:56:43,990 --> 00:56:48,319
tips on a reader that is exists the
chances are the only way someone

621
00:56:48,320 --> 00:56:50,400
approximate

622
00:56:50,400 --> 00:56:55,330
classroom or a smart route is if they
are physically see no camera someone

623
00:56:55,330 --> 00:56:58,860
observes and staying there for a minute
trying to get into this reader so

624
00:56:58,860 --> 00:57:04,890
there's not a lot of coverage around
some type of technology to still layer

625
00:57:04,890 --> 00:57:09,790
in front of a bad system so will be and
then obviously training training

626
00:57:09,790 --> 00:57:13,830
training your guard training your staff
training for what the lookout for looks

627
00:57:13,830 --> 00:57:23,740
that crazy guy with a quick shout outs
number of people that get a lot of stuff

628
00:57:23,740 --> 00:57:27,919
a lot of research that are way smarter
than I am about the stuff essentially

629
00:57:27,920 --> 00:57:31,520
I've been able to put a lot of stuff
together and talk about how it impacts

630
00:57:31,520 --> 00:57:38,650
the company but also be able to put it
into a a one hour talk versus a year so

631
00:57:38,650 --> 00:57:40,620
a lot of people there that I definitely
give thanks to

