1
00:00:11,570 --> 00:00:17,310
so I'm Nate Warfield and we can't stop

2
00:00:14,400 --> 00:00:19,200
here because this is bak country so I'd

3
00:00:17,310 --> 00:00:20,970
like to start with sort of a brief room

4
00:00:19,200 --> 00:00:23,669
like why is this an interesting topic to

5
00:00:20,970 --> 00:00:25,560
me I think network security is very

6
00:00:23,669 --> 00:00:26,789
important and I feel like today it's

7
00:00:25,560 --> 00:00:28,619
kind of one of those things that gets

8
00:00:26,789 --> 00:00:30,150
overlooked by a lot of people you know

9
00:00:28,619 --> 00:00:31,679
we're busy with patching we're busy with

10
00:00:30,150 --> 00:00:32,940
you know worrying about phishing and

11
00:00:31,679 --> 00:00:33,900
we're kind of forgetting about the

12
00:00:32,940 --> 00:00:35,160
network that's sitting there running

13
00:00:33,900 --> 00:00:36,629
everything in the bounds and network

14
00:00:35,160 --> 00:00:39,089
equipment are getting exploited very

15
00:00:36,629 --> 00:00:40,410
very quickly today - sometimes it's days

16
00:00:39,089 --> 00:00:41,550
I've even seen them exploited in a

17
00:00:40,410 --> 00:00:44,940
matter of hours from when they've

18
00:00:41,550 --> 00:00:46,769
disclosed the tax reviewing more precise

19
00:00:44,940 --> 00:00:48,809
right I think we're kind of over the

20
00:00:46,770 --> 00:00:51,539
days of these sort of cluster bomb wanna

21
00:00:48,809 --> 00:00:53,489
cry not Pecha type attack and people are

22
00:00:51,539 --> 00:00:55,739
using targeted ransomware to shut down

23
00:00:53,489 --> 00:00:56,968
businesses to hold you know in the

24
00:00:55,739 --> 00:00:59,239
United States we're seeing this happen

25
00:00:56,969 --> 00:01:01,289
with like state agencies and governments

26
00:00:59,239 --> 00:01:02,730
Travelex in the UK got their entire

27
00:01:01,289 --> 00:01:05,220
network shut down right around the new

28
00:01:02,730 --> 00:01:06,840
year they were got into via the pulse

29
00:01:05,220 --> 00:01:09,000
VPN was the way they got into the

30
00:01:06,840 --> 00:01:10,470
network and these devices because they

31
00:01:09,000 --> 00:01:12,179
sit at the edge of your network they're

32
00:01:10,470 --> 00:01:13,590
a really good place for lateral movement

33
00:01:12,179 --> 00:01:14,880
right an attackers like if they get into

34
00:01:13,590 --> 00:01:17,070
your VPN device they've called the odd

35
00:01:14,880 --> 00:01:18,390
access to maybe Active Directory they've

36
00:01:17,070 --> 00:01:20,339
maybe got access to different user

37
00:01:18,390 --> 00:01:22,770
accounts or just your entire network is

38
00:01:20,340 --> 00:01:24,630
back there um and holes in your network

39
00:01:22,770 --> 00:01:26,759
to exist as much as you think you have

40
00:01:24,630 --> 00:01:28,110
it secured I guarantee you point me out

41
00:01:26,759 --> 00:01:30,390
it I'll find some way that you didn't

42
00:01:28,110 --> 00:01:32,430
think was there and it's imperative that

43
00:01:30,390 --> 00:01:33,990
you find these things before someone

44
00:01:32,430 --> 00:01:36,770
that's like me but not as responsible as

45
00:01:33,990 --> 00:01:39,089
me and he finds them and shuts you down

46
00:01:36,770 --> 00:01:40,949
when we looking at the risk I kind of

47
00:01:39,090 --> 00:01:42,509
split it into two halves first off we

48
00:01:40,950 --> 00:01:44,399
have the computer the consumer scale

49
00:01:42,509 --> 00:01:46,530
risk and this is not stuff that we don't

50
00:01:44,399 --> 00:01:48,149
know about but it's things like old ISP

51
00:01:46,530 --> 00:01:49,500
routers right we've got some shots here

52
00:01:48,149 --> 00:01:50,939
of you know the bunch of ubiquity

53
00:01:49,500 --> 00:01:52,259
routers that someone hacked into and

54
00:01:50,939 --> 00:01:54,779
they left a note saying I hacked this

55
00:01:52,259 --> 00:01:56,520
thing please help me a d-link has been

56
00:01:54,780 --> 00:01:58,140
interesting a bunch of their router is

57
00:01:56,520 --> 00:01:59,759
not offering software updates for them

58
00:01:58,140 --> 00:02:02,509
so many vulnerabilities that are found

59
00:01:59,759 --> 00:02:05,070
are gonna be out there for the time

60
00:02:02,509 --> 00:02:06,840
didn't cut up home appliances right

61
00:02:05,070 --> 00:02:09,389
we're starting to plug everything is IOT

62
00:02:06,840 --> 00:02:11,160
everybody wants connected devices this

63
00:02:09,389 --> 00:02:12,600
is kind of a joke of somebody's surfing

64
00:02:11,160 --> 00:02:14,489
one of the hub websites on a

65
00:02:12,600 --> 00:02:16,890
refrigerator at a client's store in the

66
00:02:14,489 --> 00:02:19,380
United States Home Media

67
00:02:16,890 --> 00:02:20,929
we've got TVs you know Smart TVs Smart

68
00:02:19,380 --> 00:02:23,790
TVs are being put in the Internet

69
00:02:20,930 --> 00:02:26,129
Android Android debug garages

70
00:02:23,790 --> 00:02:27,540
or either cellphones or some of the

71
00:02:26,129 --> 00:02:28,920
Wi-Fi hotspots all the stuff gets

72
00:02:27,540 --> 00:02:31,170
plugged in the internet and people just

73
00:02:28,920 --> 00:02:32,339
leave it there the risk here is not so

74
00:02:31,170 --> 00:02:33,809
much here they're gonna get into your

75
00:02:32,340 --> 00:02:35,340
network with these things but more the

76
00:02:33,810 --> 00:02:36,989
decent devices will get exploited and

77
00:02:35,340 --> 00:02:41,010
then repurposed to attack your network

78
00:02:36,989 --> 00:02:42,659
when we start looking at oh and the FBI

79
00:02:41,010 --> 00:02:43,739
was nice enough to remind us don't

80
00:02:42,659 --> 00:02:45,929
forget to change your refrigerator

81
00:02:43,739 --> 00:02:47,159
password if you said that to somebody 20

82
00:02:45,930 --> 00:02:48,689
years ago they probably looked at you

83
00:02:47,159 --> 00:02:51,659
like what are you even talking about but

84
00:02:48,689 --> 00:02:53,340
this is the world we live in uh when we

85
00:02:51,659 --> 00:02:55,349
look at the enterprise scale and the

86
00:02:53,340 --> 00:02:57,030
risk there it's not anything that we're

87
00:02:55,349 --> 00:02:59,189
not accustomed to right it's people

88
00:02:57,030 --> 00:03:01,409
forgetting to patch this is the number

89
00:02:59,189 --> 00:03:02,459
as of yesterday of unpatched Citrix

90
00:03:01,409 --> 00:03:03,000
devices that are out there on the

91
00:03:02,459 --> 00:03:04,859
Internet

92
00:03:03,000 --> 00:03:07,200
so there's like 14,000 of these things

93
00:03:04,859 --> 00:03:09,329
still sitting there in secure cloud

94
00:03:07,200 --> 00:03:11,129
deployments the last month showed that

95
00:03:09,329 --> 00:03:13,319
any business no matter how big it can

96
00:03:11,129 --> 00:03:14,760
have these you know misconfigurations

97
00:03:13,319 --> 00:03:16,760
are a little bit of an oversight that

98
00:03:14,760 --> 00:03:18,599
lends up being a very bad PR thing

99
00:03:16,760 --> 00:03:20,638
fortunately this was responsibly

100
00:03:18,599 --> 00:03:21,899
disclosed but someone less responsible

101
00:03:20,639 --> 00:03:25,319
could have probably done something worse

102
00:03:21,900 --> 00:03:28,379
with it Network hardware this was a

103
00:03:25,319 --> 00:03:29,819
terrifying find 12,000 Cisco routers the

104
00:03:28,379 --> 00:03:31,500
banner message when you log into these

105
00:03:29,819 --> 00:03:33,750
things tells you well the banner on the

106
00:03:31,500 --> 00:03:35,340
router says here's the username here's

107
00:03:33,750 --> 00:03:37,379
the password when you log in your level

108
00:03:35,340 --> 00:03:40,370
15 which is a router version of system

109
00:03:37,379 --> 00:03:43,138
out there running telnet know things and

110
00:03:40,370 --> 00:03:44,609
then server ILO there's a there's many

111
00:03:43,139 --> 00:03:46,709
many examples these are the top ones

112
00:03:44,609 --> 00:03:48,060
that I just wanted it to illustrate but

113
00:03:46,709 --> 00:03:49,500
you know your lights out management for

114
00:03:48,060 --> 00:03:50,639
your server probably should not be on

115
00:03:49,500 --> 00:03:52,650
the internet that's supposed to be in

116
00:03:50,639 --> 00:03:56,220
your data center not exposed or anybody

117
00:03:52,650 --> 00:03:57,440
can hit it so how do I kind of find

118
00:03:56,220 --> 00:03:59,790
these things I like to look at both the

119
00:03:57,440 --> 00:04:01,680
for the attack threshold or the attack

120
00:03:59,790 --> 00:04:03,298
surface from the internet and then also

121
00:04:01,680 --> 00:04:03,959
systems that are attacking other systems

122
00:04:03,299 --> 00:04:06,810
on the Internet

123
00:04:03,959 --> 00:04:08,639
some of these tools census many people

124
00:04:06,810 --> 00:04:10,229
have probably heard of I don't use it as

125
00:04:08,639 --> 00:04:12,629
much as others but it's a really good

126
00:04:10,229 --> 00:04:15,060
resource binary edge they're fairly new

127
00:04:12,629 --> 00:04:16,829
very powerful actually binary edge was

128
00:04:15,060 --> 00:04:18,959
the tool that the researcher who found

129
00:04:16,829 --> 00:04:20,720
the Microsoft database leaked to use

130
00:04:18,959 --> 00:04:23,370
binary edge to find it

131
00:04:20,720 --> 00:04:25,169
BGP view I'm gonna get to this a little

132
00:04:23,370 --> 00:04:26,699
bit more later it's mostly just for

133
00:04:25,169 --> 00:04:28,229
figuring out autonomous systems and

134
00:04:26,699 --> 00:04:31,470
routing and what networks are owned by

135
00:04:28,229 --> 00:04:33,719
who but my two favorite or tools would

136
00:04:31,470 --> 00:04:34,889
be showdown and gray noise I'm fortunate

137
00:04:33,719 --> 00:04:36,300
enough to work for a company like

138
00:04:34,889 --> 00:04:37,350
Microsoft where they buy the very

139
00:04:36,300 --> 00:04:38,670
expensive enterprise light

140
00:04:37,350 --> 00:04:40,590
since for me so I get to play with all

141
00:04:38,670 --> 00:04:42,150
the fun features and then gray noise

142
00:04:40,590 --> 00:04:44,219
I've been using them for a year and a

143
00:04:42,150 --> 00:04:46,950
half and it's a really fantastic system

144
00:04:44,220 --> 00:04:48,330
that has a network of sensors and it

145
00:04:46,950 --> 00:04:50,400
basically looks at all the Internet

146
00:04:48,330 --> 00:04:52,550
traffic that's going non discriminant

147
00:04:50,400 --> 00:04:55,109
being sprayed either with port scans

148
00:04:52,550 --> 00:04:56,760
targeted attacks it stores all of this

149
00:04:55,110 --> 00:04:58,890
and then it replies a heuristic against

150
00:04:56,760 --> 00:05:01,170
the traffic and it can identify you know

151
00:04:58,890 --> 00:05:03,120
what type of an attack was it what type

152
00:05:01,170 --> 00:05:04,920
of a botnet was it and so you can sort

153
00:05:03,120 --> 00:05:09,120
to mine through this data and start

154
00:05:04,920 --> 00:05:10,740
looking for patterns so kind of going to

155
00:05:09,120 --> 00:05:13,770
start with grey noise here the malicious

156
00:05:10,740 --> 00:05:15,450
traffic grey noise has about 15 million

157
00:05:13,770 --> 00:05:17,070
IP addresses that it seems sort of

158
00:05:15,450 --> 00:05:20,190
programmatically scanning the internet

159
00:05:17,070 --> 00:05:21,870
looking for stuff 6 million of those it

160
00:05:20,190 --> 00:05:23,760
can tell right off the bat or malicious

161
00:05:21,870 --> 00:05:26,040
based on the heuristics that it has I

162
00:05:23,760 --> 00:05:28,380
kind of did a small sample of some of

163
00:05:26,040 --> 00:05:30,870
the tags that are the signs there's 360

164
00:05:28,380 --> 00:05:33,270
odd tags that it uses I don't have space

165
00:05:30,870 --> 00:05:34,830
to show you all that here but every

166
00:05:33,270 --> 00:05:37,740
single country on earth is doing this

167
00:05:34,830 --> 00:05:39,659
and what was surprised to me is even

168
00:05:37,740 --> 00:05:41,070
Antarctica has a machine that's doing

169
00:05:39,660 --> 00:05:42,960
some sort of malicious activity right

170
00:05:41,070 --> 00:05:44,010
all the way down there some machine has

171
00:05:42,960 --> 00:05:46,919
been hacked into and it's doing

172
00:05:44,010 --> 00:05:48,150
something weird now there's another 9

173
00:05:46,920 --> 00:05:50,010
million addresses that gray noise

174
00:05:48,150 --> 00:05:51,750
doesn't know what they are and usually

175
00:05:50,010 --> 00:05:53,250
when they say it's unknown it just means

176
00:05:51,750 --> 00:05:55,380
they don't have a heuristic for it so

177
00:05:53,250 --> 00:05:57,000
whatever the traffic is doing might be

178
00:05:55,380 --> 00:05:59,280
bad but once we figure out once the

179
00:05:57,000 --> 00:06:00,930
heuristic is developed and gets applied

180
00:05:59,280 --> 00:06:02,190
then you usually see tens or hundreds of

181
00:06:00,930 --> 00:06:06,300
thousands of machines that are actually

182
00:06:02,190 --> 00:06:08,130
doing a specific thing so when we want

183
00:06:06,300 --> 00:06:09,990
to go and look I used green lana's

184
00:06:08,130 --> 00:06:11,940
example here so I can pull this input

185
00:06:09,990 --> 00:06:14,880
you put the IP address of one of these

186
00:06:11,940 --> 00:06:16,410
Dreamland malicious machines in and gray

187
00:06:14,880 --> 00:06:18,240
noise is nice enough to tell me ok I've

188
00:06:16,410 --> 00:06:19,620
seen this thing doing a mess sequel

189
00:06:18,240 --> 00:06:22,380
brute-forcing and scanning for EM a

190
00:06:19,620 --> 00:06:24,420
sequel databases now you can flip over

191
00:06:22,380 --> 00:06:25,920
to showdown and you can see ok well what

192
00:06:24,420 --> 00:06:27,840
is this IP address weird what's it what

193
00:06:25,920 --> 00:06:29,430
is it running what ports are open and

194
00:06:27,840 --> 00:06:31,530
you'll notice at the bottom there's a

195
00:06:29,430 --> 00:06:32,940
little thing for vulnerabilities show

196
00:06:31,530 --> 00:06:34,619
dan will try to tell what

197
00:06:32,940 --> 00:06:37,530
vulnerabilities a system is that has on

198
00:06:34,620 --> 00:06:39,360
the I was exposed to in this case this

199
00:06:37,530 --> 00:06:40,409
is one of the WebDAV believe it was one

200
00:06:39,360 --> 00:06:43,470
of the vulnerabilities at the shadow

201
00:06:40,410 --> 00:06:44,850
brokers dropped on 2017 and so we know

202
00:06:43,470 --> 00:06:46,200
that's weaponized POC it's almost

203
00:06:44,850 --> 00:06:48,210
guaranteed somebody used that

204
00:06:46,200 --> 00:06:49,860
vulnerability hack to do this is machine

205
00:06:48,210 --> 00:06:50,820
and is repurposed it to scan the

206
00:06:49,860 --> 00:06:53,550
internet for MSC

207
00:06:50,820 --> 00:06:54,510
try to prove force databases and it's

208
00:06:53,550 --> 00:06:56,460
also interesting you'll notice the

209
00:06:54,510 --> 00:06:57,930
little red dot there showed an consumes

210
00:06:56,460 --> 00:06:59,700
great noise data so when you look at an

211
00:06:57,930 --> 00:07:00,960
IP if show down if gray noise has seen

212
00:06:59,700 --> 00:07:03,690
it showdown will know it too

213
00:07:00,960 --> 00:07:05,070
you won't get all the details that you

214
00:07:03,690 --> 00:07:09,180
get out of gray noise but it's kind of a

215
00:07:05,070 --> 00:07:11,310
cool little indicator so I wanted to say

216
00:07:09,180 --> 00:07:13,050
what is the last twelve months look like

217
00:07:11,310 --> 00:07:14,490
I want is kind of curious you know what

218
00:07:13,050 --> 00:07:17,100
is what are people looking for on the

219
00:07:14,490 --> 00:07:18,480
Internet in the last year so there's a

220
00:07:17,100 --> 00:07:20,130
hundred and thirty nine different

221
00:07:18,480 --> 00:07:22,320
heuristics that are sort of were mish

222
00:07:20,130 --> 00:07:25,590
that some of these are RCS some of them

223
00:07:22,320 --> 00:07:27,300
have actual cv exploits I can't really

224
00:07:25,590 --> 00:07:29,460
go into all the details on them you can

225
00:07:27,300 --> 00:07:31,470
talk to me later about that but when I

226
00:07:29,460 --> 00:07:32,969
broke it down there's 3.9 million IP

227
00:07:31,470 --> 00:07:35,100
addresses that are actually doing some

228
00:07:32,970 --> 00:07:36,960
sort of wormy activity right you'll

229
00:07:35,100 --> 00:07:38,130
notice that eternal blue it takes up

230
00:07:36,960 --> 00:07:40,349
most of those so three year old

231
00:07:38,130 --> 00:07:41,820
vulnerability is still a huge it's

232
00:07:40,350 --> 00:07:43,440
probably two or three million machines

233
00:07:41,820 --> 00:07:45,180
that are still out there trying to scan

234
00:07:43,440 --> 00:07:48,480
and pop and you use the eternal blue

235
00:07:45,180 --> 00:07:50,400
exploit and this makes up about 68% of

236
00:07:48,480 --> 00:07:53,040
malicious traffic that's seen by gray

237
00:07:50,400 --> 00:07:54,450
nose on the internet the other thing the

238
00:07:53,040 --> 00:07:56,580
gray noise picks up his brute-force errs

239
00:07:54,450 --> 00:07:57,930
so I started doing a breakdown of like

240
00:07:56,580 --> 00:07:59,849
what are all the brute forcing is doing

241
00:07:57,930 --> 00:08:02,610
there's 16 different techniques that it

242
00:07:59,850 --> 00:08:03,930
can catch a heuristic for and those make

243
00:08:02,610 --> 00:08:05,730
up about one and a half million IP

244
00:08:03,930 --> 00:08:07,350
addresses which is quite a lot of people

245
00:08:05,730 --> 00:08:08,700
trying to brute force and it's nothing

246
00:08:07,350 --> 00:08:11,070
we haven't seen before right it's telnet

247
00:08:08,700 --> 00:08:13,289
sssh there's also a bunch of the

248
00:08:11,070 --> 00:08:14,790
administrative tools like RTP and VNC

249
00:08:13,290 --> 00:08:16,230
things that you really shouldn't be

250
00:08:14,790 --> 00:08:18,660
opening up to the internet but people

251
00:08:16,230 --> 00:08:21,090
still do anyways and that comes out to

252
00:08:18,660 --> 00:08:24,690
another 26% of the malicious traffic is

253
00:08:21,090 --> 00:08:25,950
just brute forcing attempts I wanted to

254
00:08:24,690 --> 00:08:26,880
give you a little illustration of what

255
00:08:25,950 --> 00:08:29,130
you can do when you're looking at a

256
00:08:26,880 --> 00:08:30,480
specific country so if this you know the

257
00:08:29,130 --> 00:08:32,400
other day in my hotel I said let me look

258
00:08:30,480 --> 00:08:34,080
at well it's coming out of Israel so you

259
00:08:32,400 --> 00:08:35,459
can do a breakdown what I'm filtering

260
00:08:34,080 --> 00:08:37,590
down is the only things that have more

261
00:08:35,460 --> 00:08:39,599
than 100 IP addresses in them but here's

262
00:08:37,590 --> 00:08:41,840
the top networks in Israel that are out

263
00:08:39,599 --> 00:08:44,040
scanning the internet looking for things

264
00:08:41,840 --> 00:08:45,420
some of the heuristics that it's

265
00:08:44,039 --> 00:08:47,250
identified of the traffic that's coming

266
00:08:45,420 --> 00:08:49,890
out of Israel so Moriah is not a big

267
00:08:47,250 --> 00:08:51,810
surprise to be the top one we see a lot

268
00:08:49,890 --> 00:08:53,640
of tel nuts stuff here you know just

269
00:08:51,810 --> 00:08:56,219
sort of the this is fairly common across

270
00:08:53,640 --> 00:08:57,600
almost any countries and then the

271
00:08:56,220 --> 00:08:59,070
operating systems if you detect which

272
00:08:57,600 --> 00:09:00,720
OSS are running which is kind of cool

273
00:08:59,070 --> 00:09:03,000
and like I said being a network engineer

274
00:09:00,720 --> 00:09:03,960
I to me an autonomous system number is

275
00:09:03,000 --> 00:09:06,270
like my neighborhood

276
00:09:03,960 --> 00:09:07,860
that's where I like to I focus on that

277
00:09:06,270 --> 00:09:09,870
as my way of mapping out networks for

278
00:09:07,860 --> 00:09:12,770
your top asns that are looking for

279
00:09:09,870 --> 00:09:15,450
things are also visible in gray noise

280
00:09:12,770 --> 00:09:16,980
now gray noise isn't more it's more than

281
00:09:15,450 --> 00:09:18,210
just a reporting mechanism right you can

282
00:09:16,980 --> 00:09:19,710
start using some of this data for

283
00:09:18,210 --> 00:09:21,209
actually like forensics and and

284
00:09:19,710 --> 00:09:23,520
augmenting your other threat

285
00:09:21,209 --> 00:09:25,020
intelligence feeds one of the cool

286
00:09:23,520 --> 00:09:26,430
features when you're running their

287
00:09:25,020 --> 00:09:28,920
command-line client is you can actually

288
00:09:26,430 --> 00:09:30,899
take your log file throw it into this

289
00:09:28,920 --> 00:09:32,250
gray noise analyze it'll pull out all

290
00:09:30,899 --> 00:09:33,779
the IP addresses that it's seen in the

291
00:09:32,250 --> 00:09:35,370
log file it'll push all those IP

292
00:09:33,779 --> 00:09:37,050
adjusters their brain oiz and it'll tell

293
00:09:35,370 --> 00:09:38,339
you here's all of the systems that are

294
00:09:37,050 --> 00:09:40,050
doing weird things and here's all the

295
00:09:38,339 --> 00:09:42,390
bad actors versus here's your normal

296
00:09:40,050 --> 00:09:44,699
customers or your users this screenshot

297
00:09:42,390 --> 00:09:46,110
is just from one of my VMs so there's no

298
00:09:44,700 --> 00:09:48,270
three of the attempts were good because

299
00:09:46,110 --> 00:09:49,860
that's me SSH again and all the rest of

300
00:09:48,270 --> 00:09:51,420
them were basically people in China and

301
00:09:49,860 --> 00:09:54,810
other countries trying to brute force my

302
00:09:51,420 --> 00:09:57,089
SSH server this is one of the cooler

303
00:09:54,810 --> 00:09:58,800
features that it's still in beta but

304
00:09:57,089 --> 00:10:00,000
they allowed me to talk about this I

305
00:09:58,800 --> 00:10:02,310
asked them if it's cool and they said

306
00:10:00,000 --> 00:10:04,410
yeah what it's doing is it's what I call

307
00:10:02,310 --> 00:10:05,760
a packet capture time machine so all of

308
00:10:04,410 --> 00:10:07,410
this traffic the gray noise is seeing

309
00:10:05,760 --> 00:10:10,860
it's storing all of it and probably

310
00:10:07,410 --> 00:10:12,420
petabytes of GFP caps once this thing

311
00:10:10,860 --> 00:10:13,050
goes live you'll be able to say give me

312
00:10:12,420 --> 00:10:15,029
an IP address

313
00:10:13,050 --> 00:10:16,680
give me a time slice like six months ago

314
00:10:15,029 --> 00:10:18,390
I want to see what this IP address did

315
00:10:16,680 --> 00:10:20,189
and it'll chew through this and it'll

316
00:10:18,390 --> 00:10:21,750
drop you out a packet capture file that

317
00:10:20,190 --> 00:10:24,360
you can open up in Wireshark so this

318
00:10:21,750 --> 00:10:25,920
example here I found a machine from his

319
00:10:24,360 --> 00:10:27,570
back in the fall that was doing him a

320
00:10:25,920 --> 00:10:29,729
sequel brute-forcing so I was like ok

321
00:10:27,570 --> 00:10:31,140
what are they doing and you can see that

322
00:10:29,730 --> 00:10:33,270
username that it's trying the password

323
00:10:31,140 --> 00:10:35,189
that it's trying some of the redacted

324
00:10:33,270 --> 00:10:36,949
bits are there to protect gray noise and

325
00:10:35,190 --> 00:10:39,839
sensor IPS because I'm not trying to

326
00:10:36,950 --> 00:10:41,820
expose them to people by passing them

327
00:10:39,839 --> 00:10:43,230
but this is a really cool feature just

328
00:10:41,820 --> 00:10:45,330
being able to look back you know years

329
00:10:43,230 --> 00:10:48,300
ago and see what did this IP do what did

330
00:10:45,330 --> 00:10:51,060
it do later rom for augmenting threat

331
00:10:48,300 --> 00:10:52,949
Intel data this was kind of fun there's

332
00:10:51,060 --> 00:10:54,719
a fire I blog post I was talking about

333
00:10:52,950 --> 00:10:56,010
an actor or they were going after and I

334
00:10:54,720 --> 00:10:58,079
don't even remember what the service was

335
00:10:56,010 --> 00:10:59,970
but buried in the blog post they

336
00:10:58,079 --> 00:11:01,770
mentioned this a web server path that

337
00:10:59,970 --> 00:11:03,680
this exploit was throwing so I was like

338
00:11:01,770 --> 00:11:05,910
I wonder if that's in gray noise I

339
00:11:03,680 --> 00:11:08,069
search it in grey noise and lo and

340
00:11:05,910 --> 00:11:10,079
behold there's 200 machines almost all

341
00:11:08,070 --> 00:11:11,730
of them are in China that are all doing

342
00:11:10,079 --> 00:11:14,640
this type of malicious activity that's a

343
00:11:11,730 --> 00:11:16,050
known malicious actor so you could if

344
00:11:14,640 --> 00:11:16,650
you were so inclined to take this list

345
00:11:16,050 --> 00:11:17,339
of IPs

346
00:11:16,650 --> 00:11:18,870
but the many

347
00:11:17,340 --> 00:11:20,460
firewall put them in your block list and

348
00:11:18,870 --> 00:11:21,720
say hey you know what I know this is a

349
00:11:20,460 --> 00:11:23,490
bad guy I don't want to let them in my

350
00:11:21,720 --> 00:11:25,740
network I'm not even just be

351
00:11:23,490 --> 00:11:27,960
indiscriminate about about blocking this

352
00:11:25,740 --> 00:11:31,710
traffic which is I think a pretty cool

353
00:11:27,960 --> 00:11:33,690
feature so I've kind of wanted to go

354
00:11:31,710 --> 00:11:35,520
about an attack timeline there is this

355
00:11:33,690 --> 00:11:37,440
citrix local file inclusion

356
00:11:35,520 --> 00:11:41,819
vulnerability that made the news in the

357
00:11:37,440 --> 00:11:43,560
last month so citrix disclosed this this

358
00:11:41,820 --> 00:11:46,050
vulnerability on december 17th of last

359
00:11:43,560 --> 00:11:47,489
year and I think that probably because

360
00:11:46,050 --> 00:11:48,780
of the Christmas holidays a lot of

361
00:11:47,490 --> 00:11:50,670
people didn't really pay we're really

362
00:11:48,780 --> 00:11:53,209
looking it didn't get much news traction

363
00:11:50,670 --> 00:11:56,910
for the rest of December but in January

364
00:11:53,210 --> 00:11:58,590
this guy from tripwire saw this and

365
00:11:56,910 --> 00:12:00,060
decided to dig into it say hey what is

366
00:11:58,590 --> 00:12:01,140
this vulnerability how do you exploit it

367
00:12:00,060 --> 00:12:03,449
what's the risk so he wrote a very

368
00:12:01,140 --> 00:12:05,610
verbose blog post on how to test for it

369
00:12:03,450 --> 00:12:07,740
the exact stream that you would send to

370
00:12:05,610 --> 00:12:10,200
a NetScaler device to actually see if

371
00:12:07,740 --> 00:12:12,420
this thing was vulnerable so gray noise

372
00:12:10,200 --> 00:12:14,340
added a signature for this the next day

373
00:12:12,420 --> 00:12:15,630
they said I'd you know we should check

374
00:12:14,340 --> 00:12:19,020
and see if people are trying to exploit

375
00:12:15,630 --> 00:12:21,060
this thing one day later literally one

376
00:12:19,020 --> 00:12:22,770
day after they had a signature they

377
00:12:21,060 --> 00:12:24,959
started picking up attack traffic now

378
00:12:22,770 --> 00:12:26,970
the screenshot and the bottom left side

379
00:12:24,960 --> 00:12:28,530
is actually right from their server as I

380
00:12:26,970 --> 00:12:30,690
said can you give me the very first IP

381
00:12:28,530 --> 00:12:33,140
that you ever saw try to exploit it and

382
00:12:30,690 --> 00:12:35,520
they're like yes we can here it is

383
00:12:33,140 --> 00:12:38,189
confirmed obviously by their their web

384
00:12:35,520 --> 00:12:39,840
UI what's interesting is that the fine

385
00:12:38,190 --> 00:12:41,580
folks over a trusted SEC had set up a

386
00:12:39,840 --> 00:12:44,190
honeypot to try to catch the same

387
00:12:41,580 --> 00:12:46,230
activity a couple of days later they

388
00:12:44,190 --> 00:12:48,300
pick up the same exploitation attempt

389
00:12:46,230 --> 00:12:49,620
these are the same techniques but one

390
00:12:48,300 --> 00:12:51,180
thing I want to highlight is we're

391
00:12:49,620 --> 00:12:53,250
talking about a two day window between

392
00:12:51,180 --> 00:12:55,339
pot basically proof of concept being out

393
00:12:53,250 --> 00:12:58,950
and people trying to exploit this thing

394
00:12:55,340 --> 00:13:00,600
January 10th was a Friday so it was very

395
00:12:58,950 --> 00:13:01,770
easily but it's very possible that

396
00:13:00,600 --> 00:13:03,720
someone could have not been paying

397
00:13:01,770 --> 00:13:05,370
attention to the InfoSec news they go

398
00:13:03,720 --> 00:13:06,780
home for the weekend they come back in

399
00:13:05,370 --> 00:13:08,280
on Monday they're NetScaler has been

400
00:13:06,780 --> 00:13:10,350
hacked like that's how little time you

401
00:13:08,280 --> 00:13:11,760
have to address this stuff if you've

402
00:13:10,350 --> 00:13:13,230
worked for a large company you know how

403
00:13:11,760 --> 00:13:15,569
long it changed windows and change the

404
00:13:13,230 --> 00:13:17,820
approval processes can take if it's a

405
00:13:15,570 --> 00:13:18,720
VPN device you know your your executives

406
00:13:17,820 --> 00:13:19,710
aren't going to be real happy when

407
00:13:18,720 --> 00:13:21,720
you're rebooting that thing in the

408
00:13:19,710 --> 00:13:23,310
middle of the day but you need to

409
00:13:21,720 --> 00:13:24,260
understand that time is not on your side

410
00:13:23,310 --> 00:13:26,880
in these things

411
00:13:24,260 --> 00:13:29,189
and then rain noise even started picking

412
00:13:26,880 --> 00:13:30,689
up as people as the InfoSec community

413
00:13:29,190 --> 00:13:32,190
picked up on this and said hey

414
00:13:30,690 --> 00:13:33,960
we need to start defending ourselves

415
00:13:32,190 --> 00:13:35,880
attackers shifted it and they started

416
00:13:33,960 --> 00:13:37,440
using like URL encoding to try to get

417
00:13:35,880 --> 00:13:39,210
around filters that people were putting

418
00:13:37,440 --> 00:13:41,160
in place and grain always picks that up

419
00:13:39,210 --> 00:13:42,480
too so it's like you could try but you

420
00:13:41,160 --> 00:13:43,709
can't really hide when you're when

421
00:13:42,480 --> 00:13:45,750
you're doing this in discriminant

422
00:13:43,710 --> 00:13:47,460
scanning now mind you if someone's

423
00:13:45,750 --> 00:13:49,410
targeting an attack and we got you

424
00:13:47,460 --> 00:13:53,370
brain o's may not pick this up but most

425
00:13:49,410 --> 00:13:55,620
of these attackers aren't the other

426
00:13:53,370 --> 00:13:57,570
thing I like to look at so switching

427
00:13:55,620 --> 00:13:59,850
over to how do we defend ourselves from

428
00:13:57,570 --> 00:14:02,340
this stuff I do this pretty frequently

429
00:13:59,850 --> 00:14:04,170
for a customer as when I'm asked and

430
00:14:02,340 --> 00:14:06,330
usually in preparation for talks like

431
00:14:04,170 --> 00:14:07,949
this and like I said I like to start

432
00:14:06,330 --> 00:14:09,330
with an ASN this is if it's an

433
00:14:07,950 --> 00:14:10,800
old-school Network any company that's

434
00:14:09,330 --> 00:14:12,090
been established for a while it usually

435
00:14:10,800 --> 00:14:14,609
has an autonomous system that they're

436
00:14:12,090 --> 00:14:16,560
running behind the caveat of course is

437
00:14:14,610 --> 00:14:19,680
if they're in the cloud that's all gonna

438
00:14:16,560 --> 00:14:21,420
be from their cloud provider this is

439
00:14:19,680 --> 00:14:23,069
where I start using BGP view right I'll

440
00:14:21,420 --> 00:14:24,750
say okay let me figure out where this is

441
00:14:23,070 --> 00:14:27,450
what's this network and I start looking

442
00:14:24,750 --> 00:14:30,090
for anomalies like this network and iran

443
00:14:27,450 --> 00:14:31,290
is by my favorite network because

444
00:14:30,090 --> 00:14:32,910
they've got they there is their

445
00:14:31,290 --> 00:14:33,870
allegedly a cellular and Internet

446
00:14:32,910 --> 00:14:36,150
company out of Iran

447
00:14:33,870 --> 00:14:38,250
they've got 1.3 million IP addresses

448
00:14:36,150 --> 00:14:40,260
that they own now when we look at show

449
00:14:38,250 --> 00:14:42,420
Dan there's a surprisingly known low

450
00:14:40,260 --> 00:14:44,640
number of these things online if you go

451
00:14:42,420 --> 00:14:46,410
like comparison to the the United States

452
00:14:44,640 --> 00:14:47,970
some of the ISPs there you see millions

453
00:14:46,410 --> 00:14:50,219
and millions of things online because

454
00:14:47,970 --> 00:14:52,910
it's the modem interfaces the fact that

455
00:14:50,220 --> 00:14:55,020
this one only has 3000 is cut off weird

456
00:14:52,910 --> 00:14:56,610
we flip over and look at how many

457
00:14:55,020 --> 00:14:58,680
systems are scanning the internet out of

458
00:14:56,610 --> 00:15:00,210
that ASN Dre annoys tells me almost a

459
00:14:58,680 --> 00:15:03,030
third of that autonomous system is

460
00:15:00,210 --> 00:15:05,220
scanning the internet so 400,000 IPs are

461
00:15:03,030 --> 00:15:07,410
looking for stuff from a network that's

462
00:15:05,220 --> 00:15:09,060
supposedly not really online so this is

463
00:15:07,410 --> 00:15:11,400
weird it's an anomaly and and I don't

464
00:15:09,060 --> 00:15:12,569
really believe in coincidence so if I

465
00:15:11,400 --> 00:15:15,930
find out more about that you'll hear

466
00:15:12,570 --> 00:15:17,490
from me next year so when I kind

467
00:15:15,930 --> 00:15:19,020
mentioned cloud networks can be kind of

468
00:15:17,490 --> 00:15:21,180
tricky when you're looking to find a tax

469
00:15:19,020 --> 00:15:22,949
surface so that's when I switch over to

470
00:15:21,180 --> 00:15:25,410
DNS and there's another place that

471
00:15:22,950 --> 00:15:26,730
showed and can be super powerful is it

472
00:15:25,410 --> 00:15:28,079
has a feature where you could say show

473
00:15:26,730 --> 00:15:29,970
me all the hosts that you know about in

474
00:15:28,080 --> 00:15:31,470
a domain right most of us have probably

475
00:15:29,970 --> 00:15:33,030
used DNS brute force servers or DNS

476
00:15:31,470 --> 00:15:34,950
recon and things like that

477
00:15:33,030 --> 00:15:36,870
this is faster I could just say show ten

478
00:15:34,950 --> 00:15:38,910
domain tell me the domain I kind of

479
00:15:36,870 --> 00:15:41,310
singled out Clear View AI which is very

480
00:15:38,910 --> 00:15:42,390
interesting considering the cool setup

481
00:15:41,310 --> 00:15:43,890
here blue hat with the facial

482
00:15:42,390 --> 00:15:44,560
recognition

483
00:15:43,890 --> 00:15:46,360
clear

484
00:15:44,560 --> 00:15:49,449
selling facial recognition to the US

485
00:15:46,360 --> 00:15:51,699
government so Shonen has another option

486
00:15:49,449 --> 00:15:53,589
since they already have IP dress our IP

487
00:15:51,699 --> 00:15:55,449
information there is a flag you can

488
00:15:53,589 --> 00:15:57,249
throw to this that says well show me all

489
00:15:55,449 --> 00:15:58,990
the hosts and show me all the ports that

490
00:15:57,249 --> 00:16:00,579
these hosts have running so you don't

491
00:15:58,990 --> 00:16:01,660
have to even you know you can find this

492
00:16:00,579 --> 00:16:03,008
out you can find out where their

493
00:16:01,660 --> 00:16:04,389
footprint is across all of their

494
00:16:03,009 --> 00:16:09,160
different environments and what ports

495
00:16:04,389 --> 00:16:10,779
are open on those posts so another trick

496
00:16:09,160 --> 00:16:13,439
if you're looking for an autonomous

497
00:16:10,779 --> 00:16:16,420
system there's this fun little who is

498
00:16:13,439 --> 00:16:18,339
command that you can run and so I was

499
00:16:16,420 --> 00:16:19,569
actually getting a permit for my drone

500
00:16:18,339 --> 00:16:20,889
before I came here to Israel and I

501
00:16:19,569 --> 00:16:23,979
figured okay let me take a look at this

502
00:16:20,889 --> 00:16:25,329
arrow club quickly one one command I can

503
00:16:23,980 --> 00:16:27,459
find out what autonomous system they're

504
00:16:25,329 --> 00:16:28,839
running in and then I can flip over and

505
00:16:27,459 --> 00:16:31,029
say okay well what is it what does their

506
00:16:28,839 --> 00:16:32,800
domain look like and quite in - commands

507
00:16:31,029 --> 00:16:34,300
I figured out where they are and I can

508
00:16:32,800 --> 00:16:36,160
also see that they're running RDP on

509
00:16:34,300 --> 00:16:37,748
their email server probably not the best

510
00:16:36,160 --> 00:16:40,709
thing to be doing

511
00:16:37,749 --> 00:16:44,079
yes I really know them and let them know

512
00:16:40,709 --> 00:16:46,569
so when we're talking about hunting with

513
00:16:44,079 --> 00:16:48,219
show Dan I don't know how many people

514
00:16:46,569 --> 00:16:49,959
have used it but most people start with

515
00:16:48,220 --> 00:16:52,029
a port right what for it's open on the

516
00:16:49,959 --> 00:16:55,119
Internet they start looking that way or

517
00:16:52,029 --> 00:16:56,470
you'll go with products shown in can

518
00:16:55,120 --> 00:16:56,980
detect different types of products that

519
00:16:56,470 --> 00:17:00,250
are out there

520
00:16:56,980 --> 00:17:02,410
it's not a automatic process so it's not

521
00:17:00,250 --> 00:17:03,519
always a hundred percent but you could

522
00:17:02,410 --> 00:17:04,720
say all right I want to see all the

523
00:17:03,519 --> 00:17:07,689
doctor machines running on these

524
00:17:04,720 --> 00:17:08,919
different ports organization is a good

525
00:17:07,689 --> 00:17:09,880
way of filtering it down

526
00:17:08,919 --> 00:17:11,770
when you're looking at the entire

527
00:17:09,880 --> 00:17:13,449
internet if you can then scope this down

528
00:17:11,770 --> 00:17:14,530
to be your organization or the

529
00:17:13,449 --> 00:17:18,010
organization that you're doing an

530
00:17:14,530 --> 00:17:19,418
assessment for here's one of the fun

531
00:17:18,010 --> 00:17:22,059
things that I get with a very expensive

532
00:17:19,419 --> 00:17:23,919
license Thank You Microsoft there's this

533
00:17:22,059 --> 00:17:26,319
tag searching and this is very very

534
00:17:23,919 --> 00:17:29,080
powerful which is why Shannon keeps it

535
00:17:26,319 --> 00:17:31,000
locked behind these licenses my favorite

536
00:17:29,080 --> 00:17:32,740
feature on here is the set the tag for

537
00:17:31,000 --> 00:17:34,390
self signed what's this lets you do is

538
00:17:32,740 --> 00:17:37,000
it lets you search for any machine with

539
00:17:34,390 --> 00:17:38,380
a self-signed ssl certificate one of the

540
00:17:37,000 --> 00:17:40,539
most common places you'll see it's all

541
00:17:38,380 --> 00:17:43,179
signed SSL certificate is network

542
00:17:40,539 --> 00:17:45,039
hardware so your routers your load

543
00:17:43,179 --> 00:17:47,020
balancers or firewalls anything that has

544
00:17:45,039 --> 00:17:48,399
a web administration panel the vendors

545
00:17:47,020 --> 00:17:49,899
are gonna want to make it secure you're

546
00:17:48,399 --> 00:17:51,850
probably not gonna spend the money on a

547
00:17:49,899 --> 00:17:54,280
real SSL certificate so you'll run the

548
00:17:51,850 --> 00:17:56,199
self-signed certificate so every single

549
00:17:54,280 --> 00:17:58,240
time I point that's us do a self-signed

550
00:17:56,200 --> 00:18:00,820
search against a company I find router

551
00:17:58,240 --> 00:18:02,679
printers Polycom phone systems like it's

552
00:18:00,820 --> 00:18:05,530
just obscene the amount of like stuff

553
00:18:02,679 --> 00:18:06,940
that's there so it's definitely worth

554
00:18:05,530 --> 00:18:08,320
the money if you're at enterprise to

555
00:18:06,940 --> 00:18:11,080
have this and be able to search this

556
00:18:08,320 --> 00:18:12,460
stuff yourself the other cool feature

557
00:18:11,080 --> 00:18:15,010
that you can do with the enterprise

558
00:18:12,460 --> 00:18:18,160
license is searching by vulnerability

559
00:18:15,010 --> 00:18:20,650
now show Dan uses the common platform a

560
00:18:18,160 --> 00:18:22,120
numeration field to identify versions of

561
00:18:20,650 --> 00:18:23,980
software and then it makes an educated

562
00:18:22,120 --> 00:18:26,260
guess as to what vulnerabilities might

563
00:18:23,980 --> 00:18:27,730
affect this thing in the case of things

564
00:18:26,260 --> 00:18:29,470
like Apache you may see lots of

565
00:18:27,730 --> 00:18:31,390
vulnerabilities they're not entirely

566
00:18:29,470 --> 00:18:33,070
confirmed because it may depend on what

567
00:18:31,390 --> 00:18:36,010
module Apache is running is it even

568
00:18:33,070 --> 00:18:38,020
enabled but it can also to connect and

569
00:18:36,010 --> 00:18:40,629
do it program like an actual test so it

570
00:18:38,020 --> 00:18:43,360
would like for Citrix for pulse for ms

571
00:18:40,630 --> 00:18:45,190
1710 for blue keep shown ends actually

572
00:18:43,360 --> 00:18:47,350
connecting running a test script and

573
00:18:45,190 --> 00:18:48,880
confirming that it's vulnerable you can

574
00:18:47,350 --> 00:18:51,550
see this stuff if you go to the IP

575
00:18:48,880 --> 00:18:52,960
details of a single host you'll see as I

576
00:18:51,550 --> 00:18:55,090
mentioned earlier when we're looking at

577
00:18:52,960 --> 00:18:57,700
Greenland that the machine said oh it

578
00:18:55,090 --> 00:18:59,500
has this vulnerability anybody can do

579
00:18:57,700 --> 00:19:01,120
that the other thing the thing that you

580
00:18:59,500 --> 00:19:03,460
can only do with the Enterprise license

581
00:19:01,120 --> 00:19:05,649
is searching by vulnerability so what I

582
00:19:03,460 --> 00:19:07,390
have here is like for every machine that

583
00:19:05,650 --> 00:19:10,090
has not been patched for blue key and I

584
00:19:07,390 --> 00:19:12,300
have a list of 470,000 systems confirmed

585
00:19:10,090 --> 00:19:14,500
to be vulnerable just waiting to get hit

586
00:19:12,300 --> 00:19:16,480
obviously with great power comes great

587
00:19:14,500 --> 00:19:18,010
responsibility which is why this is not

588
00:19:16,480 --> 00:19:23,470
a feature that just anybody can go and

589
00:19:18,010 --> 00:19:25,210
search with now kind of going farther

590
00:19:23,470 --> 00:19:27,429
down the rabbit hole I like to do this

591
00:19:25,210 --> 00:19:29,950
stuff it is very interesting to me to

592
00:19:27,429 --> 00:19:31,270
take apart the network traffic and look

593
00:19:29,950 --> 00:19:32,710
at look at an endpoint and try to figure

594
00:19:31,270 --> 00:19:34,210
out how can I sort of systematically

595
00:19:32,710 --> 00:19:35,410
fingerprint this thing you know

596
00:19:34,210 --> 00:19:37,870
especially when it's like oh it's just

597
00:19:35,410 --> 00:19:40,330
running on TCP 443 right it's an SSL

598
00:19:37,870 --> 00:19:43,840
server there's ways to detect what it

599
00:19:40,330 --> 00:19:46,870
actually is one of the ways you can do

600
00:19:43,840 --> 00:19:48,850
it that I like to do some of this showed

601
00:19:46,870 --> 00:19:51,489
an magic you can run all of the metadata

602
00:19:48,850 --> 00:19:53,320
that showed and stores it calls a facet

603
00:19:51,490 --> 00:19:55,540
so you can start enumerated saying hey

604
00:19:53,320 --> 00:19:57,070
give me statistics on specific facets

605
00:19:55,540 --> 00:19:58,750
that you're interested in and not only

606
00:19:57,070 --> 00:20:00,220
will you get counts but you'll also be

607
00:19:58,750 --> 00:20:02,590
able to tell what some of these facet

608
00:20:00,220 --> 00:20:05,020
names are so you know this example I'm

609
00:20:02,590 --> 00:20:06,760
looking at ok show me all of the HTTP

610
00:20:05,020 --> 00:20:09,129
wofe devices right your web application

611
00:20:06,760 --> 00:20:10,870
firewalls so not only do I know that you

612
00:20:09,130 --> 00:20:11,830
know CloudFlare is the biggest but I

613
00:20:10,870 --> 00:20:13,570
also know all the

614
00:20:11,830 --> 00:20:15,850
names of different laughs that are out

615
00:20:13,570 --> 00:20:17,350
there so I can then take this turn it

616
00:20:15,850 --> 00:20:20,889
into a search and say okay search for

617
00:20:17,350 --> 00:20:22,059
HTTP laughs you know f5 big IP APM and

618
00:20:20,890 --> 00:20:23,649
I'll be able to find every one of these

619
00:20:22,059 --> 00:20:24,129
devices that showdown knows about on the

620
00:20:23,649 --> 00:20:26,590
Internet

621
00:20:24,130 --> 00:20:29,169
the other cool trick for people to use

622
00:20:26,590 --> 00:20:31,000
showdown net : 0/0 is the entire

623
00:20:29,169 --> 00:20:32,470
internet so you do that you don't have

624
00:20:31,000 --> 00:20:34,029
to worry about is it an ASN is an

625
00:20:32,470 --> 00:20:36,330
organization no just search for the

626
00:20:34,029 --> 00:20:39,130
entire internet and see what you find

627
00:20:36,330 --> 00:20:40,539
some of the fun stuff that you get into

628
00:20:39,130 --> 00:20:42,399
you when you're looking as I mentioned

629
00:20:40,539 --> 00:20:44,529
SSL it seems like that's gonna be hard

630
00:20:42,399 --> 00:20:46,360
to fingerprint not as much as you would

631
00:20:44,529 --> 00:20:47,919
think alright some of these vendors of

632
00:20:46,360 --> 00:20:50,139
these products like kubernetes for

633
00:20:47,919 --> 00:20:51,580
example they will put it as a sell

634
00:20:50,139 --> 00:20:53,918
certificate in the product and the

635
00:20:51,580 --> 00:20:55,629
issuer will always be the same thing so

636
00:20:53,919 --> 00:20:57,429
I can say ok look for every mission you

637
00:20:55,630 --> 00:21:00,010
have give me every IP address that has

638
00:20:57,429 --> 00:21:01,450
an SSL cert with kubernetes in it and

639
00:21:00,010 --> 00:21:03,220
there i've got two hundred and thirty

640
00:21:01,450 --> 00:21:05,889
four thousand kubernetes machines with a

641
00:21:03,220 --> 00:21:07,090
single showed enquiry there's a cool new

642
00:21:05,889 --> 00:21:08,529
feature they've added this facet

643
00:21:07,090 --> 00:21:10,689
analysis which lets you then break it

644
00:21:08,529 --> 00:21:12,820
down by organization that pull down you

645
00:21:10,690 --> 00:21:14,230
can also look by country by postal code

646
00:21:12,820 --> 00:21:16,029
a whole bunch of other stuff so you can

647
00:21:14,230 --> 00:21:18,279
kind of refine what you're looking for

648
00:21:16,029 --> 00:21:19,480
if you're looking at the entire world or

649
00:21:18,279 --> 00:21:20,679
if you're looking at your specific

650
00:21:19,480 --> 00:21:22,690
organization you can drill down even

651
00:21:20,679 --> 00:21:27,700
farther depending on how many machines

652
00:21:22,690 --> 00:21:29,830
you have online HTTP HTML this is fun

653
00:21:27,700 --> 00:21:32,470
you can actually dig through the HTML of

654
00:21:29,830 --> 00:21:35,289
any return page and you can search it so

655
00:21:32,470 --> 00:21:37,600
this example here is these are the big

656
00:21:35,289 --> 00:21:39,549
IP they have five big IP load balancer

657
00:21:37,600 --> 00:21:41,949
products this is one of their admin

658
00:21:39,549 --> 00:21:44,110
panels because when you log out it has a

659
00:21:41,950 --> 00:21:45,820
logout page and that gets returned in

660
00:21:44,110 --> 00:21:47,350
the HTML when shown and scans it it's

661
00:21:45,820 --> 00:21:48,720
just know you've been logged out but you

662
00:21:47,350 --> 00:21:51,039
can search this thing and now I found

663
00:21:48,720 --> 00:21:55,090
25,000 f5 devices sitting there with

664
00:21:51,039 --> 00:21:57,039
their admin ports online HTTP title has

665
00:21:55,090 --> 00:21:59,019
another fun one this is really good for

666
00:21:57,039 --> 00:22:01,600
finding home routers and IOT devices

667
00:21:59,019 --> 00:22:03,220
this stuff gets hard-coded nobody's ever

668
00:22:01,600 --> 00:22:04,990
gonna change it and even if someone knew

669
00:22:03,220 --> 00:22:06,100
how to change it the next time their

670
00:22:04,990 --> 00:22:08,440
router got an upgrade it would most

671
00:22:06,100 --> 00:22:10,240
likely get reset so this is you know

672
00:22:08,440 --> 00:22:11,860
this is our chief han home router as you

673
00:22:10,240 --> 00:22:14,470
can find D links like this you can find

674
00:22:11,860 --> 00:22:16,918
all sorts of different IOT garbage

675
00:22:14,470 --> 00:22:19,929
honestly by using this type of a search

676
00:22:16,919 --> 00:22:21,789
and then digging back into the SSL you

677
00:22:19,929 --> 00:22:24,220
can also I was looking for just VPN

678
00:22:21,789 --> 00:22:25,639
devices in general because most people

679
00:22:24,220 --> 00:22:27,829
when they're but even if it says

680
00:22:25,639 --> 00:22:29,718
a signed SSL cert not a not a

681
00:22:27,829 --> 00:22:31,009
self-signed cert they're gonna have well

682
00:22:29,719 --> 00:22:33,169
what is what is the name of this device

683
00:22:31,009 --> 00:22:34,279
on my network oh it's VPN dot my company

684
00:22:33,169 --> 00:22:35,539
comm cool

685
00:22:34,279 --> 00:22:37,519
I'm gonna go search for a nice on

686
00:22:35,539 --> 00:22:39,529
anything that has VPN in the SSL search

687
00:22:37,519 --> 00:22:41,599
subject now I have two hundred and sixty

688
00:22:39,529 --> 00:22:43,279
five thousand VPN devices right it's

689
00:22:41,599 --> 00:22:45,168
you're taking billions of IP addresses

690
00:22:43,279 --> 00:22:46,849
and very quickly narrowing it down for

691
00:22:45,169 --> 00:22:50,629
your target site which i think is just

692
00:22:46,849 --> 00:22:52,968
fun so some of the more advanced ways to

693
00:22:50,629 --> 00:22:54,109
fingerprint this stuff like if you lu

694
00:22:52,969 --> 00:22:55,639
doing this in your own network and

695
00:22:54,109 --> 00:22:57,769
you're trying to figure out what do i

696
00:22:55,639 --> 00:22:58,849
have some of the stuff gets important to

697
00:22:57,769 --> 00:23:00,559
you if you're in a company where you

698
00:22:58,849 --> 00:23:02,269
acquire another company so you're

699
00:23:00,559 --> 00:23:03,678
acquiring not only their you know the

700
00:23:02,269 --> 00:23:04,909
people that work there their technology

701
00:23:03,679 --> 00:23:06,950
but you're also inquiring all of their

702
00:23:04,909 --> 00:23:08,389
technical debt in their network and all

703
00:23:06,950 --> 00:23:10,399
of their network configuration and every

704
00:23:08,389 --> 00:23:11,958
design decision or bad decision that

705
00:23:10,399 --> 00:23:14,508
they may have made now becomes your your

706
00:23:11,959 --> 00:23:16,549
responsibility so when you're trying to

707
00:23:14,509 --> 00:23:18,349
find this trying to find these things

708
00:23:16,549 --> 00:23:20,359
what i do is start off by finding a

709
00:23:18,349 --> 00:23:21,559
system that you know is the system that

710
00:23:20,359 --> 00:23:22,789
you're looking for find this like I mean

711
00:23:21,559 --> 00:23:24,889
if you have your own NetScaler for

712
00:23:22,789 --> 00:23:26,329
example just hit it put the IP address

713
00:23:24,889 --> 00:23:29,269
and show down see what showed and tells

714
00:23:26,329 --> 00:23:31,249
you about it from there you kind of see

715
00:23:29,269 --> 00:23:33,019
there's this little raw data field you

716
00:23:31,249 --> 00:23:34,399
click into the raw data field and what

717
00:23:33,019 --> 00:23:36,019
you get is every single piece of

718
00:23:34,399 --> 00:23:38,149
metadata that Showdown is indexed for

719
00:23:36,019 --> 00:23:39,559
that host and so that's almost of that

720
00:23:38,149 --> 00:23:40,939
stuff you can then turn around and you

721
00:23:39,559 --> 00:23:41,899
can start searching the rest of the

722
00:23:40,940 --> 00:23:44,089
internet or the rest of your

723
00:23:41,899 --> 00:23:46,518
organization for I like the vendor

724
00:23:44,089 --> 00:23:47,690
specific strings because these are stuff

725
00:23:46,519 --> 00:23:51,579
that doesn't get changed

726
00:23:47,690 --> 00:23:54,229
login pages for web servers things like

727
00:23:51,579 --> 00:23:55,849
for example they have five devices have

728
00:23:54,229 --> 00:23:57,320
a cookie feature that allows for

729
00:23:55,849 --> 00:23:58,849
persistence that stuff gets stuck in

730
00:23:57,320 --> 00:24:01,070
every web request whether it's good or

731
00:23:58,849 --> 00:24:03,950
bad so you can just find that start

732
00:24:01,070 --> 00:24:05,239
searching it path redirection a lot of

733
00:24:03,950 --> 00:24:06,829
these things because it's hitting show

734
00:24:05,239 --> 00:24:09,049
dance hitting it on an IP address and

735
00:24:06,829 --> 00:24:11,389
not a DNS name so many times you hit an

736
00:24:09,049 --> 00:24:13,339
IP you get a 302 redirect you can also

737
00:24:11,389 --> 00:24:14,748
signature off the 302 redirect and start

738
00:24:13,339 --> 00:24:16,399
searching that thing for the path that

739
00:24:14,749 --> 00:24:19,669
it wants to send the host to or the

740
00:24:16,399 --> 00:24:22,248
client to headers information kind of

741
00:24:19,669 --> 00:24:23,659
same as the cookies and or just find

742
00:24:22,249 --> 00:24:25,669
different metadata that showed in itself

743
00:24:23,659 --> 00:24:27,379
is collected like you can see it's

744
00:24:25,669 --> 00:24:29,659
identified the product of this device to

745
00:24:27,379 --> 00:24:31,248
be a pulse secure it also has the same

746
00:24:29,659 --> 00:24:32,839
HTTP title so you kind of have two

747
00:24:31,249 --> 00:24:35,119
choices right do I go it's pulse secure

748
00:24:32,839 --> 00:24:38,639
in the title or just pull secure as the

749
00:24:35,119 --> 00:24:42,120
product I chose go with the product

750
00:24:38,640 --> 00:24:43,740
so 24,000 of these are there sometimes

751
00:24:42,120 --> 00:24:45,239
these results will be very complex

752
00:24:43,740 --> 00:24:47,370
there's going to be a ton of data so you

753
00:24:45,240 --> 00:24:49,740
can also download into a JSON file and

754
00:24:47,370 --> 00:24:51,179
then write some Python code or use JQ or

755
00:24:49,740 --> 00:24:52,320
one of those tools to kind of chew

756
00:24:51,180 --> 00:24:55,050
through it and start finding

757
00:24:52,320 --> 00:24:56,790
commonalities one of the pro tips if

758
00:24:55,050 --> 00:24:58,889
you're good with python and you don't

759
00:24:56,790 --> 00:25:00,480
have $10,000 for that enterprise license

760
00:24:58,890 --> 00:25:02,970
you can just write a Python script

761
00:25:00,480 --> 00:25:05,040
download all this like take your target

762
00:25:02,970 --> 00:25:06,630
Network download everything run through

763
00:25:05,040 --> 00:25:08,670
the Python and find all the self-signed

764
00:25:06,630 --> 00:25:10,020
sorts yourself right it saves you some

765
00:25:08,670 --> 00:25:14,130
money if you can't afford a license and

766
00:25:10,020 --> 00:25:16,260
you get the same net result so some case

767
00:25:14,130 --> 00:25:18,350
studies I kind of make it a game when I

768
00:25:16,260 --> 00:25:20,460
see new vulnerabilities get announced

769
00:25:18,350 --> 00:25:22,469
things get dropped on the Internet

770
00:25:20,460 --> 00:25:24,120
my goal is how fast can I find them how

771
00:25:22,470 --> 00:25:25,890
many of it can I find them and like how

772
00:25:24,120 --> 00:25:28,080
accurate is it and I try to share this

773
00:25:25,890 --> 00:25:29,460
with people just in my opinion I should

774
00:25:28,080 --> 00:25:30,570
be helping others defend their networks

775
00:25:29,460 --> 00:25:33,060
and not just hoarding all this

776
00:25:30,570 --> 00:25:34,710
information so the pulsed VPN

777
00:25:33,060 --> 00:25:36,810
vulnerability that I mentioned that was

778
00:25:34,710 --> 00:25:39,300
the one Travelex got hit with and I

779
00:25:36,810 --> 00:25:41,879
think a few other businesses this came

780
00:25:39,300 --> 00:25:43,470
out last summer initially showed and

781
00:25:41,880 --> 00:25:45,570
didn't have any sort of a detection for

782
00:25:43,470 --> 00:25:47,010
it right they do have a significant

783
00:25:45,570 --> 00:25:48,720
amount of lag between something getting

784
00:25:47,010 --> 00:25:50,879
announced and then being able to pick it

785
00:25:48,720 --> 00:25:52,740
up both in building the fingerprint or

786
00:25:50,880 --> 00:25:54,540
the test and then it also it does take a

787
00:25:52,740 --> 00:25:56,640
while for them to scan four billion IP

788
00:25:54,540 --> 00:25:58,260
addresses so they may not get it in

789
00:25:56,640 --> 00:25:59,670
there tomorrow but it doesn't mean

790
00:25:58,260 --> 00:26:00,840
attackers are waiting right this is you

791
00:25:59,670 --> 00:26:02,790
need to find this ourselves

792
00:26:00,840 --> 00:26:04,740
protect your network don't rely on

793
00:26:02,790 --> 00:26:07,590
showdown use it as a tool to find this

794
00:26:04,740 --> 00:26:10,740
stuff so initially as I mentioned the

795
00:26:07,590 --> 00:26:12,899
the 302 redirect for that that pulse

796
00:26:10,740 --> 00:26:15,420
device sent you to this forward slash

797
00:26:12,900 --> 00:26:18,090
stand on page you could just search that

798
00:26:15,420 --> 00:26:20,280
find them all a few months later shown

799
00:26:18,090 --> 00:26:21,600
and it out of owner ability tag but it

800
00:26:20,280 --> 00:26:23,879
would have been too late if you'd been

801
00:26:21,600 --> 00:26:26,399
waiting around so this is this was a fun

802
00:26:23,880 --> 00:26:27,390
one with Citrix I actually ended up

803
00:26:26,400 --> 00:26:29,700
building about a dozen different

804
00:26:27,390 --> 00:26:31,920
detections for this this is the one that

805
00:26:29,700 --> 00:26:34,920
I kind of went with which is the the

806
00:26:31,920 --> 00:26:36,570
HTTP wife of a net scaler this one was

807
00:26:34,920 --> 00:26:38,310
onion eek and that shown actually added

808
00:26:36,570 --> 00:26:39,840
a detection like two or three days after

809
00:26:38,310 --> 00:26:41,340
people started seeing exploitation

810
00:26:39,840 --> 00:26:43,919
because they just know they understand

811
00:26:41,340 --> 00:26:46,590
that it's important but here was this is

812
00:26:43,920 --> 00:26:47,790
a little pro tip and it's a twelve

813
00:26:46,590 --> 00:26:49,830
hundred twenty-five thousand of these

814
00:26:47,790 --> 00:26:51,180
things now these aren't just VPN devices

815
00:26:49,830 --> 00:26:51,939
these are also Citrix makes load

816
00:26:51,180 --> 00:26:54,970
balancers

817
00:26:51,940 --> 00:26:55,840
they all show up is the same device this

818
00:26:54,970 --> 00:26:58,870
was a fun one

819
00:26:55,840 --> 00:27:01,120
so we Microsoft MS or C actually the

820
00:26:58,870 --> 00:27:03,370
team I work for we released some patches

821
00:27:01,120 --> 00:27:05,439
in January for our D gateway which it

822
00:27:03,370 --> 00:27:09,010
was actually the UDP transport service

823
00:27:05,440 --> 00:27:10,660
that runs on 30 391 at the time showed n

824
00:27:09,010 --> 00:27:12,280
didn't actually scan UDP three three

825
00:27:10,660 --> 00:27:13,930
nine one so I sent him an email said hey

826
00:27:12,280 --> 00:27:15,790
could you start scanning this in the

827
00:27:13,930 --> 00:27:18,550
meantime I'm gonna go and start digging

828
00:27:15,790 --> 00:27:20,379
around what I did was we have an RDP

829
00:27:18,550 --> 00:27:22,000
Gateway system at Microsoft there's one

830
00:27:20,380 --> 00:27:23,290
that we use for our own corporate stuff

831
00:27:22,000 --> 00:27:26,290
so I just said what a showdown know

832
00:27:23,290 --> 00:27:28,420
about it as I dug in I realized that our

833
00:27:26,290 --> 00:27:29,590
D gateway most of these things are not

834
00:27:28,420 --> 00:27:31,630
just gonna run UDP you there's also

835
00:27:29,590 --> 00:27:34,389
gonna be RT web running when you dig

836
00:27:31,630 --> 00:27:36,730
into the page of RT web there is a logon

837
00:27:34,390 --> 00:27:38,110
field nobody is ever gonna change this

838
00:27:36,730 --> 00:27:39,580
right nobody's gonna go in and tweak the

839
00:27:38,110 --> 00:27:42,310
HTML it might even just break the

840
00:27:39,580 --> 00:27:44,500
product if you try doing it the so TD

841
00:27:42,310 --> 00:27:47,020
domain user name label is a fuel that's

842
00:27:44,500 --> 00:27:49,570
very unique and it's very easy to search

843
00:27:47,020 --> 00:27:53,260
and then lo and behold I have 20,000 Rd

844
00:27:49,570 --> 00:27:55,570
web servers because of the way that UDP

845
00:27:53,260 --> 00:27:57,430
works there's really no it's pretty much

846
00:27:55,570 --> 00:28:00,669
impossible to detect with Showdown

847
00:27:57,430 --> 00:28:02,620
if it's actually running our DG gateway

848
00:28:00,670 --> 00:28:04,060
so what you need to do here is you would

849
00:28:02,620 --> 00:28:05,739
download all the results and then write

850
00:28:04,060 --> 00:28:08,770
some code to say okay if I'm running use

851
00:28:05,740 --> 00:28:11,410
d3 391 and I have RT web running on

852
00:28:08,770 --> 00:28:13,560
there that's almost a guaranteed RT

853
00:28:11,410 --> 00:28:17,860
gateway machine

854
00:28:13,560 --> 00:28:18,790
so in closing on these this is not new

855
00:28:17,860 --> 00:28:21,610
stuff

856
00:28:18,790 --> 00:28:23,080
I I kind of I always find it funny I'm

857
00:28:21,610 --> 00:28:25,149
proud to be here I'm honored to be here

858
00:28:23,080 --> 00:28:26,620
I do kind of find it funny that 30 years

859
00:28:25,150 --> 00:28:27,880
after I started hacking into networks

860
00:28:26,620 --> 00:28:29,649
I'm sitting up here talking about the

861
00:28:27,880 --> 00:28:32,740
same problems in the same mistakes that

862
00:28:29,650 --> 00:28:34,780
people were making in the 90s CIRA days

863
00:28:32,740 --> 00:28:37,360
are very expensive right everybody knows

864
00:28:34,780 --> 00:28:39,160
I mean like as Dave said earlier we do a

865
00:28:37,360 --> 00:28:39,669
lot of work at Microsoft making Windows

866
00:28:39,160 --> 00:28:41,260
harder

867
00:28:39,670 --> 00:28:43,480
people are making every chief trying to

868
00:28:41,260 --> 00:28:45,430
make every piece of software more secure

869
00:28:43,480 --> 00:28:48,280
less exploitable you know it's not

870
00:28:45,430 --> 00:28:49,780
expensive mistakes and attackers are

871
00:28:48,280 --> 00:28:51,670
gonna thrive on your mistakes your

872
00:28:49,780 --> 00:28:53,290
oversight but you're like I'll do it and

873
00:28:51,670 --> 00:28:54,940
I'll do it on Monday it's fine boss it's

874
00:28:53,290 --> 00:28:57,129
fine we did we have a weekend it's cool

875
00:28:54,940 --> 00:28:58,600
no it's not like they're gonna come in

876
00:28:57,130 --> 00:29:00,130
and they're gonna they're gonna take

877
00:28:58,600 --> 00:29:01,750
advantage of this stuff as you know

878
00:29:00,130 --> 00:29:05,770
don't you don't want to be the statistic

879
00:29:01,750 --> 00:29:06,429
right so what I would advise is you need

880
00:29:05,770 --> 00:29:08,139
to be assessing your

881
00:29:06,429 --> 00:29:09,759
network on a regular basis right we all

882
00:29:08,139 --> 00:29:11,289
understand we'd probably most people

883
00:29:09,759 --> 00:29:11,919
have a love/hate relationship with patch

884
00:29:11,289 --> 00:29:13,658
Tuesday

885
00:29:11,919 --> 00:29:15,039
you have to reboot all your machines

886
00:29:13,659 --> 00:29:16,509
once a month well if you're rebooting

887
00:29:15,039 --> 00:29:17,919
your routines once a month why aren't

888
00:29:16,509 --> 00:29:20,049
you also taking a look at what your

889
00:29:17,919 --> 00:29:21,549
internet exposure is like something may

890
00:29:20,049 --> 00:29:23,049
have changed especially if you're

891
00:29:21,549 --> 00:29:24,639
running in cloud deployments where you

892
00:29:23,049 --> 00:29:26,080
may have people that you don't know are

893
00:29:24,639 --> 00:29:27,939
spinning up different things and

894
00:29:26,080 --> 00:29:31,509
subscriptions if you've got some of

895
00:29:27,940 --> 00:29:32,950
these things like the Express route back

896
00:29:31,509 --> 00:29:34,629
into your corporate network if your

897
00:29:32,950 --> 00:29:36,279
cloud subscription gets hacked that's a

898
00:29:34,629 --> 00:29:39,090
gateway back inside your network right

899
00:29:36,279 --> 00:29:42,009
you need keeping tabs on this stuff so

900
00:29:39,090 --> 00:29:44,740
monthly basis or you can anytime an

901
00:29:42,009 --> 00:29:46,059
exploit gets disclosed you can unfollow

902
00:29:44,740 --> 00:29:47,649
me on Twitter if you like because I

903
00:29:46,059 --> 00:29:48,908
always post the stuff as soon as I see

904
00:29:47,649 --> 00:29:51,158
it and build a signature I just put it

905
00:29:48,909 --> 00:29:52,749
on Twitter for anybody else to have or

906
00:29:51,159 --> 00:29:54,309
at any time something changes right if

907
00:29:52,749 --> 00:29:56,499
you have to do once again if you acquire

908
00:29:54,309 --> 00:29:58,149
a company or you reorg or you you know

909
00:29:56,499 --> 00:29:59,769
maybe you deploy a new office or you do

910
00:29:58,149 --> 00:30:01,600
something changes on your network you

911
00:29:59,769 --> 00:30:02,529
need to just be doing just just scan it

912
00:30:01,600 --> 00:30:04,059
check it out

913
00:30:02,529 --> 00:30:06,429
like none of this stuff is complicated

914
00:30:04,059 --> 00:30:08,529
you could do this in 15 or 20 minutes

915
00:30:06,429 --> 00:30:10,749
and that amount of time I give you if

916
00:30:08,529 --> 00:30:13,389
you can't spare 15 or 20 minutes I don't

917
00:30:10,749 --> 00:30:15,669
know how to help you and with that thank

918
00:30:13,389 --> 00:30:17,998
you very much blue hat thank you for

919
00:30:15,669 --> 00:30:17,999
having me

920
00:30:18,510 --> 00:30:22,269
[Applause]

