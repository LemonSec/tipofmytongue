1
00:00:11,660 --> 00:00:16,410
hello everyone thanks to blue hat for

2
00:00:14,730 --> 00:00:19,490
having me it's a pleasure to be here

3
00:00:16,410 --> 00:00:22,259
so in this talk we're going to dissect

4
00:00:19,490 --> 00:00:24,750
the malware and the techniques used

5
00:00:22,260 --> 00:00:27,300
within the malware by two very

6
00:00:24,750 --> 00:00:29,070
interesting apt groups that we've been

7
00:00:27,300 --> 00:00:33,180
focused on focusing on for the past

8
00:00:29,070 --> 00:00:34,560
couple of years thank you for the

9
00:00:33,180 --> 00:00:35,970
wonderful introduction that was a really

10
00:00:34,560 --> 00:00:38,970
cool video so I don't need to talk about

11
00:00:35,970 --> 00:00:41,280
myself instead I want to do a shout out

12
00:00:38,970 --> 00:00:43,410
to the whole ESET research team that's

13
00:00:41,280 --> 00:00:46,050
been tracking these adversaries and

14
00:00:43,410 --> 00:00:48,720
their malware one of them who you had

15
00:00:46,050 --> 00:00:51,059
the chance to listen to yesterday that's

16
00:00:48,720 --> 00:00:54,480
Susana and this is also the work of

17
00:00:51,060 --> 00:00:56,310
other team members here so this is the

18
00:00:54,480 --> 00:01:00,330
location where a lot of this research

19
00:00:56,310 --> 00:01:03,240
originates from this is Houston in our

20
00:01:00,330 --> 00:01:05,700
ESET headquarters in Bratislava that's

21
00:01:03,240 --> 00:01:08,280
one of them we also have another lab in

22
00:01:05,700 --> 00:01:12,390
Montreal where the research the first

23
00:01:08,280 --> 00:01:15,990
piece of research comes from so in this

24
00:01:12,390 --> 00:01:18,509
case study rather than an overview of

25
00:01:15,990 --> 00:01:20,460
all the activities done by this apt

26
00:01:18,509 --> 00:01:23,810
group I'm gonna be focusing on one

27
00:01:20,460 --> 00:01:27,899
specific example of unique trade craft

28
00:01:23,810 --> 00:01:30,659
and that tradecraft is called LoJack's

29
00:01:27,899 --> 00:01:32,039
show hands who heard about it ring a

30
00:01:30,659 --> 00:01:35,249
bell okay we have a couple of hands

31
00:01:32,039 --> 00:01:38,130
that's cool so it was the first ufi

32
00:01:35,249 --> 00:01:40,439
rootkit we found in the wild now this

33
00:01:38,130 --> 00:01:43,439
was a big deal for two main reasons

34
00:01:40,439 --> 00:01:45,589
first a ufi rootkit is an extremely

35
00:01:43,439 --> 00:01:48,449
powerful persistence mechanism and

36
00:01:45,590 --> 00:01:51,179
secondly we found that it was used by

37
00:01:48,450 --> 00:01:53,249
one of the most infamous apt groups in

38
00:01:51,179 --> 00:01:54,840
operation today some of you might know

39
00:01:53,249 --> 00:01:56,429
what Groupon talking about for the

40
00:01:54,840 --> 00:01:58,649
others I'll build it a little bit of

41
00:01:56,429 --> 00:02:00,959
suspense and really feel it a little bit

42
00:01:58,649 --> 00:02:04,020
later so let's take a closer look at

43
00:02:00,959 --> 00:02:07,049
this discovery the inspiration for the

44
00:02:04,020 --> 00:02:10,280
LoJack's malware comes from a legitimate

45
00:02:07,049 --> 00:02:14,760
piece of software called LoJack

46
00:02:10,280 --> 00:02:17,520
now LoJack previously also known as copy

47
00:02:14,760 --> 00:02:19,320
trace is an anti-theft solution by

48
00:02:17,520 --> 00:02:22,230
absolute software that comes

49
00:02:19,320 --> 00:02:23,650
pre-installed on laptops from many

50
00:02:22,230 --> 00:02:25,238
different vendors

51
00:02:23,650 --> 00:02:27,489
it has the functionality you would

52
00:02:25,239 --> 00:02:30,760
expect from an anti-theft solution such

53
00:02:27,489 --> 00:02:33,220
as being able to locate lock or remotely

54
00:02:30,760 --> 00:02:35,828
wipe your device but what makes it

55
00:02:33,220 --> 00:02:39,760
particularly interesting for our talk is

56
00:02:35,829 --> 00:02:41,769
its persistence mechanism so this

57
00:02:39,760 --> 00:02:44,950
statement was taken from their own

58
00:02:41,769 --> 00:02:47,319
website and it says that it's built into

59
00:02:44,950 --> 00:02:49,209
the BIOS or firmware during the

60
00:02:47,319 --> 00:02:51,548
manufacturing process of most major

61
00:02:49,209 --> 00:02:53,349
device manufacturers we are able to

62
00:02:51,549 --> 00:02:55,329
provide our customers with the only

63
00:02:53,349 --> 00:02:58,659
security solution that can withstand a

64
00:02:55,329 --> 00:03:03,120
factory reset installation of annual OS

65
00:02:58,659 --> 00:03:07,450
or even a complete harddrive replacement

66
00:03:03,120 --> 00:03:10,930
so that's pretty promising functionality

67
00:03:07,450 --> 00:03:13,810
right so this is the architecture of an

68
00:03:10,930 --> 00:03:16,480
older version of LoJack if we take a

69
00:03:13,810 --> 00:03:19,209
look under the hood and this is how it

70
00:03:16,480 --> 00:03:22,179
actually ensures that persistence so

71
00:03:19,209 --> 00:03:23,799
first there's the ufi module that's the

72
00:03:22,180 --> 00:03:27,129
part that comes pre-installed on the

73
00:03:23,799 --> 00:03:28,810
laptops this is executed right after the

74
00:03:27,129 --> 00:03:31,989
computer is powered on but before

75
00:03:28,810 --> 00:03:35,109
Windows starts it'll copy a simple

76
00:03:31,989 --> 00:03:39,790
downloader called the small agent onto

77
00:03:35,109 --> 00:03:42,909
the windows partition now when windows

78
00:03:39,790 --> 00:03:45,220
starts the small agent is launched and

79
00:03:42,909 --> 00:03:47,798
then connects to a remote server to

80
00:03:45,220 --> 00:03:50,290
download the full agent and execute it

81
00:03:47,799 --> 00:03:53,139
and the full agent is the component

82
00:03:50,290 --> 00:03:55,328
that's responsible that contains the

83
00:03:53,139 --> 00:04:01,690
implementation of all that advertised

84
00:03:55,329 --> 00:04:03,729
LoJack anti-theft functionality so this

85
00:04:01,690 --> 00:04:06,099
powerful persistence mechanism makes

86
00:04:03,729 --> 00:04:08,709
perfect sense for an anti-theft solution

87
00:04:06,099 --> 00:04:11,530
I mean without it if a thief would be

88
00:04:08,709 --> 00:04:13,090
able to easily wipe the hard drive and

89
00:04:11,530 --> 00:04:15,329
get rid of it it wouldn't be a very

90
00:04:13,090 --> 00:04:18,820
useful and ethat solution now would it

91
00:04:15,329 --> 00:04:21,820
but this would also be very useful for

92
00:04:18,820 --> 00:04:24,219
an attacker which is obviously what

93
00:04:21,820 --> 00:04:27,810
happened so there was a vulnerability in

94
00:04:24,220 --> 00:04:30,240
this older version of LoJack

95
00:04:27,810 --> 00:04:33,099
specifically in the LoJack small agent

96
00:04:30,240 --> 00:04:35,380
its configuration file contained the

97
00:04:33,099 --> 00:04:37,449
domain where it goes to down download

98
00:04:35,380 --> 00:04:39,939
the full agent and

99
00:04:37,449 --> 00:04:41,319
that attackers were able to simply

100
00:04:39,939 --> 00:04:44,169
replace this domain name with a

101
00:04:41,319 --> 00:04:46,689
malicious one effectively transforming a

102
00:04:44,169 --> 00:04:49,628
legitimate persistent anti-theft tool

103
00:04:46,689 --> 00:04:53,919
into a very malicious very persistent

104
00:04:49,629 --> 00:04:56,919
backdoor so such samples were first

105
00:04:53,919 --> 00:05:00,430
discovered by our bure networks we

106
00:04:56,919 --> 00:05:02,789
detect this trojan eyes a small agent as

107
00:05:00,430 --> 00:05:05,379
win32 slash LoJack's

108
00:05:02,789 --> 00:05:07,568
but naturally we were interested in

109
00:05:05,379 --> 00:05:10,180
finding out if the attackers also went

110
00:05:07,569 --> 00:05:15,159
further earlier in all these steps and

111
00:05:10,180 --> 00:05:17,680
also compromised the ufi part so we

112
00:05:15,159 --> 00:05:19,900
decided to go on a hunt and started

113
00:05:17,680 --> 00:05:21,930
looking in our telemetry eventually

114
00:05:19,900 --> 00:05:25,748
finding out that the answer was yes

115
00:05:21,930 --> 00:05:27,430
so we discovered a very interesting APC

116
00:05:25,749 --> 00:05:31,289
campaign against government and

117
00:05:27,430 --> 00:05:35,589
diplomatic organizations in Europe and

118
00:05:31,289 --> 00:05:38,438
on those computers we found tooling of

119
00:05:35,589 --> 00:05:41,979
this apt group that we had been tracking

120
00:05:38,439 --> 00:05:44,830
for quite a while now and in addition to

121
00:05:41,979 --> 00:05:48,639
those tools we found some very

122
00:05:44,830 --> 00:05:52,240
interesting utilities such as this one

123
00:05:48,639 --> 00:05:54,939
info underscore efi XE this is actually

124
00:05:52,240 --> 00:05:57,999
a benign custom tool and its purpose is

125
00:05:54,939 --> 00:05:59,289
to extract a lot of information on the

126
00:05:57,999 --> 00:06:01,719
system out the system's hardware

127
00:05:59,289 --> 00:06:04,029
including the ufi firmware vendor and

128
00:06:01,719 --> 00:06:07,419
version so this was kind of like the

129
00:06:04,029 --> 00:06:11,770
first sign that maybe a LoJack's uf5

130
00:06:07,419 --> 00:06:15,128
rootkit might exist later we found this

131
00:06:11,770 --> 00:06:18,729
other custom tool rewriter underscore

132
00:06:15,129 --> 00:06:20,469
read XE was what it was called and the

133
00:06:18,729 --> 00:06:22,959
purpose of this one was to dump the

134
00:06:20,469 --> 00:06:25,569
entire content of the ufi firmware

135
00:06:22,959 --> 00:06:28,270
memory now that looks like a same proper

136
00:06:25,569 --> 00:06:30,339
simple operation but it's not the tool

137
00:06:28,270 --> 00:06:33,310
has to talk to the spi flash controller

138
00:06:30,339 --> 00:06:37,569
on a very low-level protocol and that's

139
00:06:33,310 --> 00:06:41,199
a far from trivial thing to do then now

140
00:06:37,569 --> 00:06:43,659
this all took some time so later on we

141
00:06:41,199 --> 00:06:47,889
were able to find this other utility

142
00:06:43,659 --> 00:06:50,060
rewriter underscore binary egg binary

143
00:06:47,889 --> 00:06:52,340
eggsy

144
00:06:50,060 --> 00:06:55,370
and this is actually where we also found

145
00:06:52,340 --> 00:06:58,099
the ufi rootkit component embedded

146
00:06:55,370 --> 00:07:00,980
inside so hence the detection name for

147
00:06:58,100 --> 00:07:03,410
that one is efi slash LoJack's

148
00:07:00,980 --> 00:07:06,770
now this rewriter binary XE what that

149
00:07:03,410 --> 00:07:10,700
does is it has code to add this embedded

150
00:07:06,770 --> 00:07:13,789
rootkit into the firmware image dumped

151
00:07:10,700 --> 00:07:16,340
by that previous to the rewrite or read

152
00:07:13,790 --> 00:07:19,570
XE and then to write this trojan eyes

153
00:07:16,340 --> 00:07:23,989
image back to the target firmware memory

154
00:07:19,570 --> 00:07:26,750
so what does the ufi rootkit the LoJack

155
00:07:23,990 --> 00:07:28,880
see if I rootkit actually do well

156
00:07:26,750 --> 00:07:30,950
although the implementation was far from

157
00:07:28,880 --> 00:07:32,900
trivial from a high level perspective

158
00:07:30,950 --> 00:07:33,710
the functionality was pretty

159
00:07:32,900 --> 00:07:36,349
straightforward

160
00:07:33,710 --> 00:07:38,299
now as is the first thing that starts

161
00:07:36,350 --> 00:07:40,610
running when you power up your computer

162
00:07:38,300 --> 00:07:41,570
before Windows starts it had to load an

163
00:07:40,610 --> 00:07:44,380
NTFS driver

164
00:07:41,570 --> 00:07:48,110
to allow read and write operations

165
00:07:44,380 --> 00:07:50,240
afterwards it would write the small

166
00:07:48,110 --> 00:07:52,669
agent the trojan eyes small agent that

167
00:07:50,240 --> 00:07:55,100
win32 slash LoJack's component to the

168
00:07:52,669 --> 00:07:57,560
system partition and then it would

169
00:07:55,100 --> 00:08:01,400
ensure its execution by patching the

170
00:07:57,560 --> 00:08:03,710
Windows registry now after having seen

171
00:08:01,400 --> 00:08:06,200
after having discovered all of this so

172
00:08:03,710 --> 00:08:09,080
this looked really really interesting so

173
00:08:06,200 --> 00:08:12,830
we found a ufi rootkit that a UFO

174
00:08:09,080 --> 00:08:16,070
rootkit actually exists but we were not

175
00:08:12,830 --> 00:08:18,800
entirely SATs they're still not entirely

176
00:08:16,070 --> 00:08:22,610
satisfied we wanted to catch it in the

177
00:08:18,800 --> 00:08:25,460
act so fortunately we have a ufi scanner

178
00:08:22,610 --> 00:08:29,660
as part of our endpoint protection

179
00:08:25,460 --> 00:08:31,609
platform and later on after the

180
00:08:29,660 --> 00:08:33,530
discovery of these files and looking

181
00:08:31,610 --> 00:08:35,870
into the telemetry from the ufi scanner

182
00:08:33,530 --> 00:08:38,718
we were able to find and actually

183
00:08:35,870 --> 00:08:43,089
confirm that this ufi rootkit was

184
00:08:38,719 --> 00:08:45,440
actually actively being used in the wild

185
00:08:43,089 --> 00:08:48,980
and we were able to attribute the attack

186
00:08:45,440 --> 00:08:51,440
to this intimate said 'not apt group

187
00:08:48,980 --> 00:08:53,990
also known as fancy bear APD 28 or

188
00:08:51,440 --> 00:08:55,550
whatever's your favorite alias for this

189
00:08:53,990 --> 00:08:59,150
group which i think needs absolutely no

190
00:08:55,550 --> 00:09:02,569
introduction for this audience this is

191
00:08:59,150 --> 00:09:03,949
the group behind many of the jeep

192
00:09:02,570 --> 00:09:08,710
politically motivated

193
00:09:03,950 --> 00:09:11,450
tax the DNC hack and all of those so

194
00:09:08,710 --> 00:09:14,360
after having discovered this you fi rich

195
00:09:11,450 --> 00:09:16,010
kids are no longer merely a theoretical

196
00:09:14,360 --> 00:09:17,600
or proof-of-concept threat as they were

197
00:09:16,010 --> 00:09:19,520
before

198
00:09:17,600 --> 00:09:21,380
they've been deployed against

199
00:09:19,520 --> 00:09:24,220
high-profile targets but even if you're

200
00:09:21,380 --> 00:09:27,320
not a diplomat or a government employee

201
00:09:24,220 --> 00:09:29,000
we can expect that this type of advanced

202
00:09:27,320 --> 00:09:31,580
tradecraft can be used by any dedicated

203
00:09:29,000 --> 00:09:34,520
attacker now against any organization

204
00:09:31,580 --> 00:09:36,710
actually worth the effort if you're

205
00:09:34,520 --> 00:09:39,319
interested in to more technical details

206
00:09:36,710 --> 00:09:43,100
we have a white paper on it where you

207
00:09:39,320 --> 00:09:45,140
can find out more okay so let's have a

208
00:09:43,100 --> 00:09:47,690
show of hands who's familiar or who has

209
00:09:45,140 --> 00:09:50,540
worked with mitre attack in any way or

210
00:09:47,690 --> 00:09:54,290
form okay quite a lot of you in case

211
00:09:50,540 --> 00:09:56,750
there's anyone that's not familiar it's

212
00:09:54,290 --> 00:10:00,819
basically a knowledge base of apt

213
00:09:56,750 --> 00:10:04,370
tactics and techniques and also malware

214
00:10:00,820 --> 00:10:06,290
so software names and apt groups so

215
00:10:04,370 --> 00:10:08,390
we're really nice nice taxonomy and a

216
00:10:06,290 --> 00:10:11,420
knowledge base packaged all together and

217
00:10:08,390 --> 00:10:15,140
we started mapping our threat research

218
00:10:11,420 --> 00:10:16,579
to mitre attack about a year ago one of

219
00:10:15,140 --> 00:10:19,280
the reasons for that being that it's

220
00:10:16,580 --> 00:10:21,170
nice to have a common language in order

221
00:10:19,280 --> 00:10:23,270
to be able to better communicate the

222
00:10:21,170 --> 00:10:26,959
results of our research so LoJack's is

223
00:10:23,270 --> 00:10:30,050
also featured there for a more

224
00:10:26,960 --> 00:10:34,130
high-level overview of the capability

225
00:10:30,050 --> 00:10:36,680
you can also take a look there now the

226
00:10:34,130 --> 00:10:40,430
technique that is listed under is called

227
00:10:36,680 --> 00:10:43,219
system firmware and until then as I said

228
00:10:40,430 --> 00:10:46,430
you fi routines were mostly proof of

229
00:10:43,220 --> 00:10:48,980
concepts or reported capability of some

230
00:10:46,430 --> 00:10:51,199
government agencies or even the hacking

231
00:10:48,980 --> 00:10:52,280
team espionage software but this was

232
00:10:51,200 --> 00:10:55,540
actually the first time that we actually

233
00:10:52,280 --> 00:11:00,800
saw it being used in the wild by malware

234
00:10:55,540 --> 00:11:04,939
okay so let's move on to the second

235
00:11:00,800 --> 00:11:07,430
example the second case study this is

236
00:11:04,940 --> 00:11:10,550
predominantly a research done by my

237
00:11:07,430 --> 00:11:12,439
colleague Anton sharapov and in this

238
00:11:10,550 --> 00:11:13,849
case I'm not going to be only talking

239
00:11:12,440 --> 00:11:17,779
about one piece of malware bunnies that

240
00:11:13,850 --> 00:11:19,910
we're gonna give a really nice overview

241
00:11:17,779 --> 00:11:21,350
of all the capability and although the

242
00:11:19,910 --> 00:11:23,930
campaign different campaign is in the

243
00:11:21,350 --> 00:11:29,439
most interesting malware and techniques

244
00:11:23,930 --> 00:11:32,300
that this group has been using so

245
00:11:29,439 --> 00:11:36,319
sandworm as they're right now most

246
00:11:32,300 --> 00:11:38,269
popularly referred to we haven't really

247
00:11:36,319 --> 00:11:43,969
been using that name because we track

248
00:11:38,269 --> 00:11:45,740
them with a more granular level so

249
00:11:43,970 --> 00:11:48,790
tracking various clusters which then

250
00:11:45,740 --> 00:11:52,999
fall under this sort of umbrella term

251
00:11:48,790 --> 00:11:54,920
there's also a book now about all these

252
00:11:52,999 --> 00:11:57,050
activities by Andy Greenberg titled

253
00:11:54,920 --> 00:11:58,939
sandworm it's a really good read so if

254
00:11:57,050 --> 00:12:00,920
you haven't read it I do encourage you

255
00:11:58,939 --> 00:12:03,649
to pick it up where you can read the

256
00:12:00,920 --> 00:12:07,430
whole story about all this stuff that

257
00:12:03,649 --> 00:12:09,860
was happening mostly in Ukraine but not

258
00:12:07,430 --> 00:12:12,410
only in Ukraine because so for a lot of

259
00:12:09,860 --> 00:12:14,420
the activity of these group we saw in

260
00:12:12,410 --> 00:12:15,279
other countries as well for example

261
00:12:14,420 --> 00:12:20,748
Poland

262
00:12:15,279 --> 00:12:24,230
so the first tooling the first malware

263
00:12:20,749 --> 00:12:25,970
that we sort of started focusing on and

264
00:12:24,230 --> 00:12:28,879
we're able to tie to this group was

265
00:12:25,970 --> 00:12:30,980
black energy and black energy itself it

266
00:12:28,879 --> 00:12:34,399
has a really interesting history where

267
00:12:30,980 --> 00:12:38,089
it went black energy version one being

268
00:12:34,399 --> 00:12:40,879
basically a cybercrime toolkit used for

269
00:12:38,089 --> 00:12:42,649
cyber crime being modular being used for

270
00:12:40,879 --> 00:12:44,180
denial of service attack and various

271
00:12:42,649 --> 00:12:50,180
other crime were stuff eventually

272
00:12:44,180 --> 00:12:51,739
evolving into this apt tool but even

273
00:12:50,180 --> 00:12:54,349
still being being basically a

274
00:12:51,740 --> 00:12:58,759
general-purpose cyber weapon so it was

275
00:12:54,350 --> 00:13:01,370
used it was used in the historically the

276
00:12:58,759 --> 00:13:04,370
first attacks against a power grid that

277
00:13:01,370 --> 00:13:08,990
resulted in a blackout caused by a cyber

278
00:13:04,370 --> 00:13:11,959
attack but black energy as I said it

279
00:13:08,990 --> 00:13:14,870
gave the attackers access inside that

280
00:13:11,959 --> 00:13:18,199
critical network inside the Ukrainian

281
00:13:14,870 --> 00:13:20,480
the Ukraine Ukrainians Power Grid the

282
00:13:18,199 --> 00:13:24,079
electricity distribution substations it

283
00:13:20,480 --> 00:13:27,410
was a very very well organized attack

284
00:13:24,079 --> 00:13:29,089
and it was distributed so different sub

285
00:13:27,410 --> 00:13:31,400
stations all across the country were

286
00:13:29,089 --> 00:13:33,110
targeted around the

287
00:13:31,400 --> 00:13:34,730
time and a lot of preparations went

288
00:13:33,110 --> 00:13:37,070
after so the blackout itself was

289
00:13:34,730 --> 00:13:39,020
actually only the culmination of the

290
00:13:37,070 --> 00:13:42,200
attack and many months of preparations

291
00:13:39,020 --> 00:13:44,840
and actually attempts to get inside were

292
00:13:42,200 --> 00:13:49,490
happening prior to this visible end

293
00:13:44,840 --> 00:13:51,290
effect that we saw so black energy was

294
00:13:49,490 --> 00:13:53,360
used for initial access it was used for

295
00:13:51,290 --> 00:13:56,209
lateral movement and all of those things

296
00:13:53,360 --> 00:13:57,830
but the actual pulling the plug the

297
00:13:56,210 --> 00:13:59,690
flipping of the of the switches the

298
00:13:57,830 --> 00:14:02,030
circuit breakers that was not done by

299
00:13:59,690 --> 00:14:06,740
black energy that was done manually

300
00:14:02,030 --> 00:14:10,390
because the attackers were able to get

301
00:14:06,740 --> 00:14:13,160
access credentials to a remote access

302
00:14:10,390 --> 00:14:15,620
software called radmann that the

303
00:14:13,160 --> 00:14:17,839
administrators of of the Ukrainian Power

304
00:14:15,620 --> 00:14:19,400
Grid we're actually using because a lot

305
00:14:17,840 --> 00:14:21,440
of these substations are geographically

306
00:14:19,400 --> 00:14:23,540
very widespread so they need needed to

307
00:14:21,440 --> 00:14:26,090
have a capability to connect to these

308
00:14:23,540 --> 00:14:28,939
remotely and they were able to do that

309
00:14:26,090 --> 00:14:31,460
so in case there's anyone who hasn't

310
00:14:28,940 --> 00:14:34,550
seen this this video I will play it for

311
00:14:31,460 --> 00:14:39,380
you this was actually taken by one

312
00:14:34,550 --> 00:14:41,630
engineer at one of these substations you

313
00:14:39,380 --> 00:14:44,710
can notice the up-to-date operating

314
00:14:41,630 --> 00:14:44,710
system that they were using their

315
00:14:48,910 --> 00:14:59,560
purpose this video was - this is the

316
00:14:57,710 --> 00:15:01,910
point of this video was to show look

317
00:14:59,560 --> 00:15:05,390
somebody is remotely manipulating the

318
00:15:01,910 --> 00:15:07,069
controls flipping switches and I'm not

319
00:15:05,390 --> 00:15:09,430
it's not me I'm not touching the mouse

320
00:15:07,070 --> 00:15:09,430
or the keyboard

321
00:15:11,290 --> 00:15:14,429
[Music]

322
00:15:19,149 --> 00:15:30,529
I'm gonna take you think it over okay so

323
00:15:27,829 --> 00:15:35,209
that was that blackout happened in

324
00:15:30,529 --> 00:15:38,600
December 2015 the group was also

325
00:15:35,209 --> 00:15:40,549
responsible for another Ukrainian power

326
00:15:38,600 --> 00:15:45,679
grid attack that happened almost exactly

327
00:15:40,549 --> 00:15:49,608
one year later in December 2016 but we

328
00:15:45,679 --> 00:15:51,259
were only able to confidently attribute

329
00:15:49,609 --> 00:15:52,939
it to this group later on and I'll get

330
00:15:51,259 --> 00:15:57,489
to that in just a second

331
00:15:52,939 --> 00:16:01,189
but we analyzed we analyzed this malware

332
00:15:57,489 --> 00:16:05,290
called it in destroyer for the purpose

333
00:16:01,189 --> 00:16:08,599
that in this case the attack itself was

334
00:16:05,290 --> 00:16:10,309
not that didn't have that much more of

335
00:16:08,600 --> 00:16:15,429
an impact compared to the Year previous

336
00:16:10,309 --> 00:16:17,600
prior to that there was it affected a

337
00:16:15,429 --> 00:16:19,689
transmission sub-station this time not a

338
00:16:17,600 --> 00:16:22,639
distribution but a transmission one

339
00:16:19,689 --> 00:16:26,259
station of the north Kiev so potentially

340
00:16:22,639 --> 00:16:28,129
targeting a larger region but it was not

341
00:16:26,259 --> 00:16:29,480
distributed so it was not multiple

342
00:16:28,129 --> 00:16:31,579
substations like the like the year

343
00:16:29,480 --> 00:16:36,499
before that and the outage actually only

344
00:16:31,579 --> 00:16:38,299
only lasted for an hour which part of

345
00:16:36,499 --> 00:16:41,869
the reason for that could have been that

346
00:16:38,299 --> 00:16:43,910
the Ukrainians already had experience

347
00:16:41,869 --> 00:16:47,059
with dealing dealing with this and

348
00:16:43,910 --> 00:16:49,699
another another another reason being

349
00:16:47,059 --> 00:16:52,309
that the attackers basically failed in

350
00:16:49,699 --> 00:16:55,549
their attempt but the part I'm trying to

351
00:16:52,309 --> 00:16:59,079
say is that this malware didn't really

352
00:16:55,549 --> 00:17:01,519
feel filled up its potential because

353
00:16:59,079 --> 00:17:04,519
this time they were using a much much

354
00:17:01,519 --> 00:17:06,709
more powerful malware framework than

355
00:17:04,519 --> 00:17:08,209
black energy and not only was it more

356
00:17:06,709 --> 00:17:10,339
powerful but it was very very very

357
00:17:08,209 --> 00:17:15,199
tailored and specifically designed to

358
00:17:10,339 --> 00:17:17,240
attack the power grid and for all these

359
00:17:15,199 --> 00:17:18,949
reasons we consider it to be one of the

360
00:17:17,240 --> 00:17:22,730
most cunning pieces of malware ever

361
00:17:18,949 --> 00:17:24,769
created thanks to its modularity and to

362
00:17:22,730 --> 00:17:28,299
the capability to communicate with ICS

363
00:17:24,769 --> 00:17:29,480
industrial control system as equipment

364
00:17:28,299 --> 00:17:31,309
using

365
00:17:29,480 --> 00:17:33,370
industrial communication protocols

366
00:17:31,309 --> 00:17:40,910
effectively bridging the gap between

367
00:17:33,370 --> 00:17:43,729
IIIT and ot attacks okay let's continue

368
00:17:40,910 --> 00:17:46,480
with the time line I'll get back to the

369
00:17:43,730 --> 00:17:50,900
techniques used by industry or later

370
00:17:46,480 --> 00:17:53,270
then we sort of saw a shift of activity

371
00:17:50,900 --> 00:17:55,760
of this group to what we started calling

372
00:17:53,270 --> 00:17:57,770
teleports because there was some stuff

373
00:17:55,760 --> 00:17:59,090
in common some of their infrastructure

374
00:17:57,770 --> 00:18:03,950
was he reused but the malware was

375
00:17:59,090 --> 00:18:05,750
different and and they were using they

376
00:18:03,950 --> 00:18:08,140
were using back doors which were using

377
00:18:05,750 --> 00:18:11,169
the telegram API for command and control

378
00:18:08,140 --> 00:18:14,630
communication hence the nickname and

379
00:18:11,169 --> 00:18:17,210
also the focus the targeting changed

380
00:18:14,630 --> 00:18:20,179
quite quite a bit so still Ukraine the

381
00:18:17,210 --> 00:18:22,429
the ambition was to do crippled

382
00:18:20,179 --> 00:18:25,700
operation throughout all over the

383
00:18:22,429 --> 00:18:28,669
country but it was not going after the

384
00:18:25,700 --> 00:18:30,320
energy industry primarily it was going

385
00:18:28,669 --> 00:18:32,570
after the financial sector mostly so a

386
00:18:30,320 --> 00:18:35,299
lot of banks and now also all other

387
00:18:32,570 --> 00:18:36,860
other financial institutions Ministry of

388
00:18:35,299 --> 00:18:40,250
Finance Stock Exchange and these types

389
00:18:36,860 --> 00:18:42,709
of targets were targeted by the

390
00:18:40,250 --> 00:18:46,669
teleport's subgroup let's we can call it

391
00:18:42,710 --> 00:18:49,040
that and they're in there malware they

392
00:18:46,669 --> 00:18:50,990
were also responsible for the infamous

393
00:18:49,040 --> 00:18:55,490
not Patriot Act that's spread beyond the

394
00:18:50,990 --> 00:18:57,320
borders of Ukraine and that was

395
00:18:55,490 --> 00:19:00,860
facilitated that actually started the

396
00:18:57,320 --> 00:19:04,879
patient zero of that epidemic being and

397
00:19:00,860 --> 00:19:07,520
the ME dog backdoor a backdoor basically

398
00:19:04,880 --> 00:19:12,320
distributed through the update mechanism

399
00:19:07,520 --> 00:19:14,120
of this widely used financial accounting

400
00:19:12,320 --> 00:19:18,559
software using using used all over the

401
00:19:14,120 --> 00:19:21,409
country this other box I have here XML

402
00:19:18,559 --> 00:19:24,950
so we only found discovered that later

403
00:19:21,410 --> 00:19:27,080
on in April of 2018 and this was this

404
00:19:24,950 --> 00:19:29,020
was the actual piece of evidence that we

405
00:19:27,080 --> 00:19:33,470
were missing that that allowed us to

406
00:19:29,020 --> 00:19:36,200
connect in destroyer with this whole

407
00:19:33,470 --> 00:19:38,980
activity of this group so so we knew

408
00:19:36,200 --> 00:19:41,659
that XML was the work of this tel BOTS

409
00:19:38,980 --> 00:19:43,130
sub group due to the execution change

410
00:19:41,659 --> 00:19:45,890
due to malware similarities and

411
00:19:43,130 --> 00:19:50,210
stuff like that and that actually

412
00:19:45,890 --> 00:19:52,840
contained similarities to green energy

413
00:19:50,210 --> 00:19:56,690
later that contain code similarities

414
00:19:52,840 --> 00:19:59,570
unique code similarities with industry

415
00:19:56,690 --> 00:20:01,250
so we have the XML backdoor on the left

416
00:19:59,570 --> 00:20:05,270
and we have the industry main backdoor

417
00:20:01,250 --> 00:20:07,730
on the right and we were able to

418
00:20:05,270 --> 00:20:10,639
conclude that yes this is linked I mean

419
00:20:07,730 --> 00:20:13,970
before it was it was expected even

420
00:20:10,640 --> 00:20:17,870
before we found this and it was it was

421
00:20:13,970 --> 00:20:20,780
it was a claim bye-bye or this was the

422
00:20:17,870 --> 00:20:23,989
opinion the general opinion of the

423
00:20:20,780 --> 00:20:26,660
security community that this stuff is is

424
00:20:23,990 --> 00:20:29,360
done by the same group but no actual

425
00:20:26,660 --> 00:20:31,580
evidence was presented to to support

426
00:20:29,360 --> 00:20:34,850
that fact I mean it made sense right I'm

427
00:20:31,580 --> 00:20:37,040
if you have an attacker who attacks the

428
00:20:34,850 --> 00:20:40,129
Ukrainian power grid causes a mass

429
00:20:37,040 --> 00:20:43,879
blackout and then another year you have

430
00:20:40,130 --> 00:20:45,860
kind of this the same effect most

431
00:20:43,880 --> 00:20:48,650
probably there are related somehow but

432
00:20:45,860 --> 00:20:50,600
at that time it was mostly a guess until

433
00:20:48,650 --> 00:20:57,890
we were able to to find this a piece of

434
00:20:50,600 --> 00:21:01,340
evidence okay so there was also a

435
00:20:57,890 --> 00:21:04,550
parallel activity it actually started

436
00:21:01,340 --> 00:21:08,149
the first instances of gray energy that

437
00:21:04,550 --> 00:21:11,050
we saw we saw around the time that we

438
00:21:08,150 --> 00:21:15,680
saw the last instances of black energy

439
00:21:11,050 --> 00:21:17,360
so for that reason we we considered gray

440
00:21:15,680 --> 00:21:21,920
energy to kind of be the successor of

441
00:21:17,360 --> 00:21:25,370
the black energy subgroup or activity

442
00:21:21,920 --> 00:21:27,440
cluster and basically taking place in

443
00:21:25,370 --> 00:21:29,090
parallel to the to the other subgroup of

444
00:21:27,440 --> 00:21:30,590
teleports which were primarily focusing

445
00:21:29,090 --> 00:21:33,010
on the financial sector

446
00:21:30,590 --> 00:21:38,360
so yeah grey energy they continued

447
00:21:33,010 --> 00:21:40,040
targeting the energy sector and we'll

448
00:21:38,360 --> 00:21:42,590
talk a little bit more about core energy

449
00:21:40,040 --> 00:21:45,530
in just a second so let's take a look at

450
00:21:42,590 --> 00:21:48,260
the the techniques that this group was

451
00:21:45,530 --> 00:21:51,560
using the most notable ones for initial

452
00:21:48,260 --> 00:21:53,450
axis they mostly relied on spear

453
00:21:51,560 --> 00:21:57,470
phishing emails and I guess that's

454
00:21:53,450 --> 00:21:59,510
unsurprising most apt groups do that

455
00:21:57,470 --> 00:22:02,330
and they were employing various means to

456
00:21:59,510 --> 00:22:05,120
gain execution weather various methods

457
00:22:02,330 --> 00:22:09,379
of pure social engineering or using

458
00:22:05,120 --> 00:22:13,250
exploits CVE 2014 401 4

459
00:22:09,380 --> 00:22:15,110
ring a bell anyone ok so that's what

460
00:22:13,250 --> 00:22:17,360
later became known as the sand worm

461
00:22:15,110 --> 00:22:19,820
vulnerability that Anton reported to

462
00:22:17,360 --> 00:22:23,360
Microsoft that later got patched so that

463
00:22:19,820 --> 00:22:29,110
was being used to spread a black energy

464
00:22:23,360 --> 00:22:31,790
around the the second half of 2014

465
00:22:29,110 --> 00:22:36,110
so yeah they even they were even were

466
00:22:31,790 --> 00:22:38,030
using a zero-day some other interesting

467
00:22:36,110 --> 00:22:40,250
initial access techniques was the supply

468
00:22:38,030 --> 00:22:43,910
chain compromise which already hinted at

469
00:22:40,250 --> 00:22:46,250
so that was the compromise of ME doc the

470
00:22:43,910 --> 00:22:48,500
most widely used financial software in

471
00:22:46,250 --> 00:22:50,930
Ukraine the attackers managed to

472
00:22:48,500 --> 00:22:53,750
compromise the hope basically the whole

473
00:22:50,930 --> 00:22:55,070
infrastructure of this company through

474
00:22:53,750 --> 00:22:57,920
from their source code all the way to

475
00:22:55,070 --> 00:23:01,330
their update servers and they abuse the

476
00:22:57,920 --> 00:23:03,920
update server mechanism to to push

477
00:23:01,330 --> 00:23:08,330
basically Trojan Trojan eyes to pitch

478
00:23:03,920 --> 00:23:10,820
back doored backdoored updates virtually

479
00:23:08,330 --> 00:23:13,210
to every every business around the whole

480
00:23:10,820 --> 00:23:16,070
country and then through this backdoor

481
00:23:13,210 --> 00:23:21,020
through this Emma dog backdoor they

482
00:23:16,070 --> 00:23:24,770
pushed the non petia epidemic so that's

483
00:23:21,020 --> 00:23:26,629
that's the most widely known example of

484
00:23:24,770 --> 00:23:30,440
such a compromise but that's not the

485
00:23:26,630 --> 00:23:32,990
only one so that happened in June 2017

486
00:23:30,440 --> 00:23:35,090
not petia there but there were also

487
00:23:32,990 --> 00:23:37,880
other supply chain attacks used by this

488
00:23:35,090 --> 00:23:42,080
group that preceded it that were not

489
00:23:37,880 --> 00:23:44,180
that well covered another really

490
00:23:42,080 --> 00:23:46,159
interesting initial access technique

491
00:23:44,180 --> 00:23:48,890
this time this was used by grey energy

492
00:23:46,160 --> 00:23:52,040
was gaining entry via vulnerable web

493
00:23:48,890 --> 00:23:53,870
servers so they found a vulnerability in

494
00:23:52,040 --> 00:23:56,510
these web servers and they kind of used

495
00:23:53,870 --> 00:23:57,979
it as a as a reentry technique so they

496
00:23:56,510 --> 00:24:00,290
first had to know that this this

497
00:23:57,980 --> 00:24:03,500
vulnerability was there and then they

498
00:24:00,290 --> 00:24:06,379
had it as a backup mechanism of getting

499
00:24:03,500 --> 00:24:09,500
in again say after their malware was

500
00:24:06,380 --> 00:24:10,720
cleaned off from from the network from

501
00:24:09,500 --> 00:24:14,300
the systems

502
00:24:10,720 --> 00:24:17,810
and some of some other really

503
00:24:14,300 --> 00:24:19,940
interesting techniques for example there

504
00:24:17,810 --> 00:24:22,490
were black energy plugins which were

505
00:24:19,940 --> 00:24:24,590
abusing TeamViewer specific versions of

506
00:24:22,490 --> 00:24:27,170
team Team Viewer for remote unattended

507
00:24:24,590 --> 00:24:30,730
access so there was a special setting to

508
00:24:27,170 --> 00:24:34,490
virtually open up another backup

509
00:24:30,730 --> 00:24:37,730
backdoor that the attackers could use to

510
00:24:34,490 --> 00:24:39,470
gain entry into the network

511
00:24:37,730 --> 00:24:41,960
there were also black energy plugins

512
00:24:39,470 --> 00:24:44,060
which acted as parasitic infections now

513
00:24:41,960 --> 00:24:47,720
this is really interesting because we

514
00:24:44,060 --> 00:24:50,899
don't see these much nowadays right so

515
00:24:47,720 --> 00:24:52,820
parasitic effectors viruses that's

516
00:24:50,900 --> 00:24:54,230
something that we definitely don't

517
00:24:52,820 --> 00:24:56,149
encounter that much and we were

518
00:24:54,230 --> 00:24:59,630
surprised to see that this malware was

519
00:24:56,150 --> 00:25:01,490
using this specifically we found some

520
00:24:59,630 --> 00:25:05,660
some Juniper installers which were which

521
00:25:01,490 --> 00:25:10,340
were infected using using this this

522
00:25:05,660 --> 00:25:12,380
particular plugin now are there any ICS

523
00:25:10,340 --> 00:25:16,300
folks in the audience some of you might

524
00:25:12,380 --> 00:25:19,940
recognize what this technique is about

525
00:25:16,300 --> 00:25:24,169
so this one is execution via HDMI so

526
00:25:19,940 --> 00:25:27,250
this was also being used to to launch to

527
00:25:24,170 --> 00:25:32,300
install black energy and specifically

528
00:25:27,250 --> 00:25:33,100
that script would be opened by General

529
00:25:32,300 --> 00:25:35,840
Electric's

530
00:25:33,100 --> 00:25:40,370
simplicity HMI but they're also hm eyes

531
00:25:35,840 --> 00:25:42,500
targeted like somatic wincc so this was

532
00:25:40,370 --> 00:25:44,540
actually one of the first indicators of

533
00:25:42,500 --> 00:25:46,760
this group's interest in critical

534
00:25:44,540 --> 00:25:49,580
infrastructure and the energy sector

535
00:25:46,760 --> 00:25:52,430
because all of this stuff was this curve

536
00:25:49,580 --> 00:25:57,560
all this stuff happened before the

537
00:25:52,430 --> 00:25:59,530
blackout and so that was the first

538
00:25:57,560 --> 00:26:03,520
example let's talk a little bit about

539
00:25:59,530 --> 00:26:08,180
what grey energy the the the latest

540
00:26:03,520 --> 00:26:10,940
evolution of this group's arsenal so

541
00:26:08,180 --> 00:26:13,280
what this focus was about as I said

542
00:26:10,940 --> 00:26:16,670
already mostly energy companies not

543
00:26:13,280 --> 00:26:18,820
exclusively but mostly they were

544
00:26:16,670 --> 00:26:21,170
targeting ICS control workstations

545
00:26:18,820 --> 00:26:23,580
searching for some specific SCADA

546
00:26:21,170 --> 00:26:25,980
software and

547
00:26:23,580 --> 00:26:28,020
very curious observation one that also

548
00:26:25,980 --> 00:26:30,000
indicated the group's targeting was that

549
00:26:28,020 --> 00:26:32,430
some of the gray energy samples we

550
00:26:30,000 --> 00:26:36,390
detected and analyzed were signed with a

551
00:26:32,430 --> 00:26:39,060
certificate from Advantech a Taiwanese

552
00:26:36,390 --> 00:26:41,520
manufacturer of industrial and IOT

553
00:26:39,060 --> 00:26:44,520
hardware so these were most likely

554
00:26:41,520 --> 00:26:46,680
stolen from the company just as in the

555
00:26:44,520 --> 00:26:51,060
case of Stuxnet or with the recent plead

556
00:26:46,680 --> 00:26:52,890
or more recent plead malware campaign so

557
00:26:51,060 --> 00:26:56,399
more some more interesting gray energy

558
00:26:52,890 --> 00:26:58,590
techniques for for OPSEC for staying

559
00:26:56,400 --> 00:27:00,690
under the cover they didn't push all of

560
00:26:58,590 --> 00:27:02,639
their modules so it was also modular

561
00:27:00,690 --> 00:27:06,450
this is also kind of a signature thing

562
00:27:02,640 --> 00:27:08,220
for this group they were select only

563
00:27:06,450 --> 00:27:12,720
selectively pushing the modules the

564
00:27:08,220 --> 00:27:15,300
plugins to each target as needed and all

565
00:27:12,720 --> 00:27:17,280
these plugins they they use various

566
00:27:15,300 --> 00:27:20,040
levels of security so they were encrypt

567
00:27:17,280 --> 00:27:22,170
their code decrypted and and for a lot

568
00:27:20,040 --> 00:27:26,220
of lot of these samples we were not able

569
00:27:22,170 --> 00:27:28,340
to even find out what exactly their

570
00:27:26,220 --> 00:27:30,150
functionality was because it was

571
00:27:28,340 --> 00:27:35,370
encrypted with it with the hardware

572
00:27:30,150 --> 00:27:38,250
based key they were using what I call

573
00:27:35,370 --> 00:27:40,760
internal CNC proxies so basically using

574
00:27:38,250 --> 00:27:43,350
internal CNC servers with the first

575
00:27:40,760 --> 00:27:45,660
stage first level of the CNC servers

576
00:27:43,350 --> 00:27:48,449
being without the compromised

577
00:27:45,660 --> 00:27:52,710
organizations network and it also makes

578
00:27:48,450 --> 00:27:54,660
sense I mean it's less suspicious if one

579
00:27:52,710 --> 00:27:57,120
node is communicating outside to a

580
00:27:54,660 --> 00:27:58,880
malicious the actual CNC server rather

581
00:27:57,120 --> 00:28:00,770
than all of the infected nodes

582
00:27:58,880 --> 00:28:03,990
connecting to it directly

583
00:28:00,770 --> 00:28:06,570
now those actual CNC servers they also

584
00:28:03,990 --> 00:28:09,960
operated as for relays this is also

585
00:28:06,570 --> 00:28:12,210
something that we saw commonly being

586
00:28:09,960 --> 00:28:14,310
used by this group not only gray energy

587
00:28:12,210 --> 00:28:16,260
but also black energy before also in

588
00:28:14,310 --> 00:28:18,629
destroyers all all those CNC servers

589
00:28:16,260 --> 00:28:20,930
most of them at least we're running two

590
00:28:18,630 --> 00:28:23,640
relays so kind of an upset requirement

591
00:28:20,930 --> 00:28:26,910
the malware wasn't communicating with

592
00:28:23,640 --> 00:28:29,670
the CNCs by a tour but we believe this

593
00:28:26,910 --> 00:28:32,220
was used for the attackers for the

594
00:28:29,670 --> 00:28:34,530
malware operators to connect and to get

595
00:28:32,220 --> 00:28:36,150
to the dump sites and to send commands

596
00:28:34,530 --> 00:28:41,790
and all that stuff

597
00:28:36,150 --> 00:28:44,010
for anonymity okay so let's talk about

598
00:28:41,790 --> 00:28:45,659
all the impact that I already kind of

599
00:28:44,010 --> 00:28:49,110
kind of mentioned kind of suggested

600
00:28:45,660 --> 00:28:50,940
hinted if I was to describe this group

601
00:28:49,110 --> 00:28:53,729
with just one word I would definitely

602
00:28:50,940 --> 00:28:55,770
call them impactful for the havoc they

603
00:28:53,730 --> 00:28:57,990
caused in Ukraine with their sabotage

604
00:28:55,770 --> 00:28:59,820
operations which left hundreds of

605
00:28:57,990 --> 00:29:03,030
thousands of civilians without

606
00:28:59,820 --> 00:29:05,669
electricity for hours as well as the

607
00:29:03,030 --> 00:29:07,770
naughtiest sudo ransomware that caused

608
00:29:05,670 --> 00:29:12,000
large-scale damage to some of the

609
00:29:07,770 --> 00:29:15,480
world's largest corporations and when

610
00:29:12,000 --> 00:29:19,160
the damages were reported by those

611
00:29:15,480 --> 00:29:22,170
companies Merck Meijer FedEx and so on

612
00:29:19,160 --> 00:29:27,170
it became to be known as the most

613
00:29:22,170 --> 00:29:29,850
damaging cyberattack in history so I

614
00:29:27,170 --> 00:29:31,650
want focused on industry because it's

615
00:29:29,850 --> 00:29:34,199
probably the most unique piece of

616
00:29:31,650 --> 00:29:37,860
malware and in that case we're not

617
00:29:34,200 --> 00:29:40,440
mapping the activity to the regular

618
00:29:37,860 --> 00:29:46,620
mitre attack matrix because mitre

619
00:29:40,440 --> 00:29:48,660
actually just recently released a matrix

620
00:29:46,620 --> 00:29:50,250
specifically for industrial control

621
00:29:48,660 --> 00:29:52,800
systems so it's still kind of a work in

622
00:29:50,250 --> 00:29:55,830
progress but there's there is a slightly

623
00:29:52,800 --> 00:29:59,850
different slightly modified matrix with

624
00:29:55,830 --> 00:30:01,800
a little bit different take tactics and

625
00:29:59,850 --> 00:30:06,120
and slightly different techniques under

626
00:30:01,800 --> 00:30:08,100
those tactics as as like really being

627
00:30:06,120 --> 00:30:08,959
really specific to industrial control

628
00:30:08,100 --> 00:30:11,850
systems

629
00:30:08,960 --> 00:30:15,410
so in destroyer is also featured there

630
00:30:11,850 --> 00:30:19,110
and let's let's do a more high-level

631
00:30:15,410 --> 00:30:24,210
description of what it was capable of so

632
00:30:19,110 --> 00:30:27,449
this is a substation and we added we

633
00:30:24,210 --> 00:30:30,600
identified three main ways in industry

634
00:30:27,450 --> 00:30:33,270
the in destroyer samples attacked these

635
00:30:30,600 --> 00:30:36,149
electricity distribution substations or

636
00:30:33,270 --> 00:30:39,120
transmission in this case so firstly and

637
00:30:36,150 --> 00:30:41,340
most importantly it could directly

638
00:30:39,120 --> 00:30:44,520
control the industrial hardware on site

639
00:30:41,340 --> 00:30:47,699
so these types of boxes protection

640
00:30:44,520 --> 00:30:49,500
relays it could send commands to these

641
00:30:47,700 --> 00:30:52,340
devices

642
00:30:49,500 --> 00:30:55,020
and it would do so using one of four

643
00:30:52,340 --> 00:30:58,320
industrial communication protocols so

644
00:30:55,020 --> 00:31:02,970
these were embedded in industry being

645
00:30:58,320 --> 00:31:05,520
used as as plugins now industry was

646
00:31:02,970 --> 00:31:07,650
abusing these protocols there were no

647
00:31:05,520 --> 00:31:09,840
exploits involved no software

648
00:31:07,650 --> 00:31:13,100
vulnerabilities in play but you have to

649
00:31:09,840 --> 00:31:15,929
remember that all of these all of these

650
00:31:13,100 --> 00:31:20,580
protocols were designed decades ago

651
00:31:15,930 --> 00:31:22,050
without security or without the the

652
00:31:20,580 --> 00:31:25,379
notion in mind that all of this stuff

653
00:31:22,050 --> 00:31:30,210
would be connected remotely and exposed

654
00:31:25,380 --> 00:31:32,330
for remote and malicious axis so the

655
00:31:30,210 --> 00:31:36,300
second type of impact in this case

656
00:31:32,330 --> 00:31:38,820
vulnerabilities were in play here and

657
00:31:36,300 --> 00:31:41,540
this was about rendering protection

658
00:31:38,820 --> 00:31:45,870
relays irresponsive so this was a

659
00:31:41,540 --> 00:31:49,530
exploiting a bug in Siemens software it

660
00:31:45,870 --> 00:31:51,510
wasn't a zero-day so it had it had

661
00:31:49,530 --> 00:31:54,360
patches available around the time that

662
00:31:51,510 --> 00:31:57,900
this was abused but you can probably

663
00:31:54,360 --> 00:31:59,820
imagine the state of patching that these

664
00:31:57,900 --> 00:32:03,630
systems were at it's it's a lot long

665
00:31:59,820 --> 00:32:06,480
difficult and a lot more problematic

666
00:32:03,630 --> 00:32:08,520
than in regular computer networks so

667
00:32:06,480 --> 00:32:13,260
this was done by the denial of service

668
00:32:08,520 --> 00:32:16,379
component then there was a third type of

669
00:32:13,260 --> 00:32:18,240
payload functionality in the industry

670
00:32:16,380 --> 00:32:21,270
samples we analyzed and this was the

671
00:32:18,240 --> 00:32:23,130
data wiper module its purpose was to

672
00:32:21,270 --> 00:32:24,350
make recovery from the attack more

673
00:32:23,130 --> 00:32:27,780
difficult

674
00:32:24,350 --> 00:32:31,050
basically to amplify the impact of the

675
00:32:27,780 --> 00:32:32,250
attack it went not after that industrial

676
00:32:31,050 --> 00:32:34,500
hardware not after those protection

677
00:32:32,250 --> 00:32:36,420
relays but after the workstations used

678
00:32:34,500 --> 00:32:37,830
to configure them monitoring this the

679
00:32:36,420 --> 00:32:42,450
were stations running that SCADA

680
00:32:37,830 --> 00:32:44,129
software it would search specific it

681
00:32:42,450 --> 00:32:46,320
would add it had a list of specific

682
00:32:44,130 --> 00:32:50,430
files belonging to SCADA software and

683
00:32:46,320 --> 00:32:52,500
processes it would rewrite those wipe

684
00:32:50,430 --> 00:32:54,030
them and basically render the system

685
00:32:52,500 --> 00:32:58,250
unbootable a kind of a nightmare

686
00:32:54,030 --> 00:33:01,800
scenario for for the defenders

687
00:32:58,250 --> 00:33:03,000
so speaking of these wipers or these

688
00:33:01,800 --> 00:33:06,389
various destroy

689
00:33:03,000 --> 00:33:10,110
the components they are also kind of a

690
00:33:06,390 --> 00:33:12,929
signature technique of this group while

691
00:33:10,110 --> 00:33:15,600
tracking them we observed an evolution

692
00:33:12,929 --> 00:33:19,080
of these techniques - from black energy

693
00:33:15,600 --> 00:33:22,399
plugins through standalone kill disk

694
00:33:19,080 --> 00:33:24,320
malware to destructive file encryptor

695
00:33:22,400 --> 00:33:28,130
masquerading as ransomware

696
00:33:24,320 --> 00:33:33,210
the most infamous being Apogee of course

697
00:33:28,130 --> 00:33:35,730
and most of tell abouts data Viper

698
00:33:33,210 --> 00:33:38,669
modules were focusing on Windows but

699
00:33:35,730 --> 00:33:43,440
they also had samples targeting Linux

700
00:33:38,669 --> 00:33:45,960
servers so in this case the the

701
00:33:43,440 --> 00:33:49,500
techniques would be data encrypted for

702
00:33:45,960 --> 00:33:54,780
for impacts for example and another

703
00:33:49,500 --> 00:33:58,140
technique this was an image discovered

704
00:33:54,780 --> 00:33:59,549
by the employees of a specific Ukrainian

705
00:33:58,140 --> 00:34:02,870
institution one morning when they came

706
00:33:59,549 --> 00:34:06,360
to work so a cultural reference

707
00:34:02,870 --> 00:34:09,598
obviously the operators the the

708
00:34:06,360 --> 00:34:10,980
adversary was a fan of miss robot so I

709
00:34:09,599 --> 00:34:12,480
don't know how we could call this a

710
00:34:10,980 --> 00:34:17,190
defacement we could call it a prank

711
00:34:12,480 --> 00:34:20,310
whatever so that brings me to the end of

712
00:34:17,190 --> 00:34:23,369
the talk this was kind of a trip down

713
00:34:20,310 --> 00:34:25,199
memory lane until now but I have to say

714
00:34:23,369 --> 00:34:29,129
that all these adversaries are still

715
00:34:25,199 --> 00:34:32,219
active we have been seeing their

716
00:34:29,129 --> 00:34:33,839
activity more or less and we continue

717
00:34:32,219 --> 00:34:39,290
tracking them and we will be releasing

718
00:34:33,839 --> 00:34:39,290
more information on them thank you

719
00:34:40,679 --> 00:34:44,968
[Applause]

