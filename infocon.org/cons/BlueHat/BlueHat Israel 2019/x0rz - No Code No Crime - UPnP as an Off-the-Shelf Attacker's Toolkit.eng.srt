1
00:00:00,000 --> 00:00:16,550
[Music]

2
00:00:12,339 --> 00:00:19,490
<font color="#CCCCCC">thank you for having me here today</font><font color="#E5E5E5"> so as</font>

3
00:00:16,550 --> 00:00:22,070
you<font color="#E5E5E5"> probably guessed from</font><font color="#CCCCCC"> the title my</font>

4
00:00:19,490 --> 00:00:25,848
talk will be about<font color="#CCCCCC"> UPnP and Oh to abuse</font>

5
00:00:22,070 --> 00:00:28,489
the protocol so first of all<font color="#E5E5E5"> Who am I</font>

6
00:00:25,849 --> 00:00:32,090
so you<font color="#E5E5E5"> mostly know me from</font><font color="#CCCCCC"> Twitter I</font>

7
00:00:28,489 --> 00:00:35,600
<font color="#E5E5E5">guess</font><font color="#CCCCCC"> ask sauce I'm French so</font><font color="#E5E5E5"> sorry for</font>

8
00:00:32,090 --> 00:00:38,360
my broken<font color="#E5E5E5"> English</font><font color="#CCCCCC"> I have been</font><font color="#E5E5E5"> working in</font>

9
00:00:35,600 --> 00:00:41,719
<font color="#E5E5E5">the in plastic industry for more</font><font color="#CCCCCC"> than</font>

10
00:00:38,360 --> 00:00:49,640
eight years<font color="#E5E5E5"> and I am not working as in</font>

11
00:00:41,719 --> 00:00:51,920
our<font color="#E5E5E5"> consulting company so let's go</font>

12
00:00:49,640 --> 00:00:52,640
straight<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the main topic of a</font><font color="#CCCCCC"> talk so</font>

13
00:00:51,920 --> 00:00:55,000
last March

14
00:00:52,640 --> 00:00:57,559
<font color="#CCCCCC">címon tech reported about the inception</font>

15
00:00:55,000 --> 00:01:01,100
framework group which happened<font color="#CCCCCC"> to be an</font>

16
00:00:57,559 --> 00:01:05,899
apt and they used a lot of<font color="#E5E5E5"> IOT devices</font>

17
00:01:01,100 --> 00:01:08,600
and<font color="#CCCCCC"> UPnP to I'd them cells</font><font color="#E5E5E5"> so what what</font>

18
00:01:05,899 --> 00:01:12,320
is<font color="#E5E5E5"> interesting is that according</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

19
00:01:08,600 --> 00:01:14,329
report<font color="#E5E5E5"> we could abuse this protocol</font>

20
00:01:12,320 --> 00:01:17,538
<font color="#E5E5E5">without any custom malware to be</font>

21
00:01:14,329 --> 00:01:21,350
injected<font color="#CCCCCC"> into</font><font color="#E5E5E5"> the router so this is</font>

22
00:01:17,539 --> 00:01:25,689
interesting<font color="#CCCCCC"> and of course the fret</font><font color="#E5E5E5"> actor</font>

23
00:01:21,350 --> 00:01:28,038
have been using<font color="#E5E5E5"> this for so many years</font>

24
00:01:25,689 --> 00:01:30,529
this is<font color="#CCCCCC"> all semantics portrayed the</font>

25
00:01:28,039 --> 00:01:32,749
attacks so an operator<font color="#E5E5E5"> from an unknown</font>

26
00:01:30,529 --> 00:01:35,869
<font color="#E5E5E5">location was opening through a VPS and</font>

27
00:01:32,749 --> 00:01:38,539
<font color="#E5E5E5">then three layers or</font><font color="#CCCCCC"> few tiles to</font>

28
00:01:35,869 --> 00:01:40,880
analyze them<font color="#E5E5E5"> so of course I</font><font color="#CCCCCC"> got</font>

29
00:01:38,539 --> 00:01:45,319
interested<font color="#E5E5E5"> and</font><font color="#CCCCCC"> decided to</font><font color="#E5E5E5"> find</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> or</font>

30
00:01:40,880 --> 00:01:48,408
one could do<font color="#E5E5E5"> exactly that</font><font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> go</font>

31
00:01:45,319 --> 00:01:50,029
<font color="#E5E5E5">into</font><font color="#CCCCCC"> the know first disclaimer yeah</font><font color="#E5E5E5"> so</font>

32
00:01:48,409 --> 00:01:53,599
what you need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know about</font><font color="#E5E5E5"> this</font>

33
00:01:50,029 --> 00:01:56,450
research is that<font color="#CCCCCC"> UPnP acts have been</font>

34
00:01:53,599 --> 00:01:59,479
around for ages<font color="#E5E5E5"> so my goal</font><font color="#CCCCCC"> today is to</font>

35
00:01:56,450 --> 00:02:01,909
<font color="#E5E5E5">make it a little</font><font color="#CCCCCC"> less secret and giving</font>

36
00:01:59,479 --> 00:02:04,399
it more visibility<font color="#CCCCCC"> so I'm not</font><font color="#E5E5E5"> claiming</font>

37
00:02:01,909 --> 00:02:07,939
any of this to<font color="#E5E5E5"> be new of course</font><font color="#CCCCCC"> it is</font>

38
00:02:04,399 --> 00:02:09,739
not really new but<font color="#E5E5E5"> a it's still being</font>

39
00:02:07,939 --> 00:02:13,819
seen in the<font color="#CCCCCC"> wider</font><font color="#E5E5E5"> so let's do something</font>

40
00:02:09,739 --> 00:02:16,209
<font color="#CCCCCC">about it right so there's a lot of</font><font color="#E5E5E5"> noise</font>

41
00:02:13,819 --> 00:02:18,829
on<font color="#CCCCCC"> the internet</font><font color="#E5E5E5"> continue scanning from</font>

42
00:02:16,209 --> 00:02:21,530
multiple parties like showed<font color="#E5E5E5"> on census</font>

43
00:02:18,830 --> 00:02:22,930
and all of the others it's like<font color="#E5E5E5"> internet</font>

44
00:02:21,530 --> 00:02:27,870
party you know

45
00:02:22,930 --> 00:02:31,980
and this graph<font color="#CCCCCC"> shows</font><font color="#E5E5E5"> UV scan on</font><font color="#CCCCCC"> UPnP so</font>

46
00:02:27,870 --> 00:02:35,410
most<font color="#E5E5E5"> specifically</font><font color="#CCCCCC"> the 1900 port on UDP</font>

47
00:02:31,980 --> 00:02:37,359
<font color="#E5E5E5">for last year so it's quite buzzy</font>

48
00:02:35,410 --> 00:02:39,760
there's a lot of activity<font color="#CCCCCC"> going on and</font>

49
00:02:37,360 --> 00:02:43,150
what<font color="#E5E5E5"> is interesting here</font><font color="#CCCCCC"> is you can</font>

50
00:02:39,760 --> 00:02:45,840
almost see<font color="#CCCCCC"> a</font><font color="#E5E5E5"> small pattern so I don't</font>

51
00:02:43,150 --> 00:02:50,080
know if there<font color="#CCCCCC"> is any correlation but</font>

52
00:02:45,840 --> 00:02:52,450
when we when<font color="#CCCCCC"> we are public research you</font>

53
00:02:50,080 --> 00:02:54,250
might have some<font color="#CCCCCC"> people scanning</font><font color="#E5E5E5"> more</font>

54
00:02:52,450 --> 00:02:57,069
after<font color="#E5E5E5"> you you research like for example</font>

55
00:02:54,250 --> 00:03:00,040
<font color="#E5E5E5">like on the right you have like V I can</font>

56
00:02:57,069 --> 00:03:04,958
<font color="#CCCCCC">my research paper and then you just</font>

57
00:03:00,040 --> 00:03:09,399
bikes<font color="#CCCCCC"> of scans so why are people</font>

58
00:03:04,959 --> 00:03:12,370
<font color="#E5E5E5">scanning</font><font color="#CCCCCC"> UPnP what if I told you you can</font>

59
00:03:09,400 --> 00:03:16,239
build<font color="#E5E5E5"> build your own botnet of Reuters</font>

60
00:03:12,370 --> 00:03:20,380
without any<font color="#E5E5E5"> single infection well let's</font>

61
00:03:16,239 --> 00:03:22,599
talk about<font color="#CCCCCC"> UPnP so UPnP stands for</font>

62
00:03:20,380 --> 00:03:24,700
universal plug and<font color="#E5E5E5"> play it's a set of</font>

63
00:03:22,599 --> 00:03:27,220
networking protocols to allow devices<font color="#E5E5E5"> to</font>

64
00:03:24,700 --> 00:03:29,649
discover each other's and use them out

65
00:03:27,220 --> 00:03:33,700
of the box without<font color="#CCCCCC"> any configuration</font><font color="#E5E5E5"> so</font>

66
00:03:29,650 --> 00:03:35,709
it's literally plug-and-play<font color="#CCCCCC"> you can</font>

67
00:03:33,700 --> 00:03:38,170
tell the architecture it<font color="#CCCCCC"> is pretty hard</font>

68
00:03:35,709 --> 00:03:44,049
<font color="#CCCCCC">because there is a lot of XML</font><font color="#E5E5E5"> and soap</font>

69
00:03:38,170 --> 00:03:46,899
so like the late 90s<font color="#CCCCCC"> so yeah you</font><font color="#E5E5E5"> can say</font>

70
00:03:44,049 --> 00:03:49,120
it's just<font color="#CCCCCC"> a bunch of photo curves used</font>

71
00:03:46,900 --> 00:03:53,370
to remotely query or controller device

72
00:03:49,120 --> 00:03:56,620
well<font color="#E5E5E5"> what could possibly</font><font color="#CCCCCC"> go wrong</font>

73
00:03:53,370 --> 00:03:58,900
so according<font color="#CCCCCC"> to the UPnP specification</font>

74
00:03:56,620 --> 00:04:01,299
so by the way by the way<font color="#E5E5E5"> all the</font>

75
00:03:58,900 --> 00:04:03,459
<font color="#E5E5E5">specification are open of course on the</font>

76
00:04:01,299 --> 00:04:06,190
internet<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> can really read all the</font>

77
00:04:03,459 --> 00:04:08,350
documents and find like a lot<font color="#E5E5E5"> of answers</font>

78
00:04:06,190 --> 00:04:10,440
interesting stuff and that's<font color="#E5E5E5"> what I have</font>

79
00:04:08,350 --> 00:04:13,600
<font color="#E5E5E5">been</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> just reading the</font>

80
00:04:10,440 --> 00:04:16,389
documentation<font color="#E5E5E5"> so there are six layers of</font>

81
00:04:13,600 --> 00:04:19,089
protocols and I will only<font color="#E5E5E5"> focus on the</font>

82
00:04:16,389 --> 00:04:21,728
first three layer so discovery

83
00:04:19,089 --> 00:04:24,849
description and control<font color="#E5E5E5"> discovery is</font>

84
00:04:21,728 --> 00:04:28,510
basically the<font color="#E5E5E5"> SSDP protocol HTTP</font><font color="#CCCCCC"> of our</font>

85
00:04:24,850 --> 00:04:31,570
<font color="#CCCCCC">UDP using multicast for discovery then</font>

86
00:04:28,510 --> 00:04:34,349
description<font color="#E5E5E5"> this is when the</font><font color="#CCCCCC"> UPnP device</font>

87
00:04:31,570 --> 00:04:36,930
will describe its capabilities

88
00:04:34,350 --> 00:04:39,450
finally control where the magic happens

89
00:04:36,930 --> 00:04:42,630
you can query and control the device

90
00:04:39,450 --> 00:04:45,390
with soap<font color="#CCCCCC"> so it's kind of like our PC</font>

91
00:04:42,630 --> 00:04:50,490
but without<font color="#E5E5E5"> a notification</font><font color="#CCCCCC"> because you</font>

92
00:04:45,390 --> 00:04:53,539
know so<font color="#CCCCCC"> how does it work well this is a</font>

93
00:04:50,490 --> 00:04:57,660
simple<font color="#CCCCCC"> example I'm going to explain</font><font color="#E5E5E5"> you</font>

94
00:04:53,540 --> 00:05:01,200
<font color="#E5E5E5">when for example</font><font color="#CCCCCC"> peer-to-peer</font><font color="#E5E5E5"> clients on</font>

95
00:04:57,660 --> 00:05:03,150
your computer will request<font color="#CCCCCC"> the Rooter</font><font color="#E5E5E5"> to</font>

96
00:05:01,200 --> 00:05:05,969
<font color="#CCCCCC">open a port to make a direct</font><font color="#E5E5E5"> connection</font>

97
00:05:03,150 --> 00:05:10,500
<font color="#E5E5E5">right so it</font><font color="#CCCCCC"> is also</font><font color="#E5E5E5"> used by Skype and</font>

98
00:05:05,970 --> 00:05:12,630
many other application so<font color="#CCCCCC"> you Penn P is</font>

99
00:05:10,500 --> 00:05:14,880
one of the easy way<font color="#E5E5E5"> to achieve that like</font>

100
00:05:12,630 --> 00:05:18,090
when<font color="#E5E5E5"> you are inside the</font><font color="#CCCCCC"> land</font><font color="#E5E5E5"> we are</font>

101
00:05:14,880 --> 00:05:22,920
<font color="#CCCCCC">behind the nut and you</font><font color="#E5E5E5"> want appear to</font>

102
00:05:18,090 --> 00:05:25,799
directly access your host<font color="#E5E5E5"> so first your</font>

103
00:05:22,920 --> 00:05:28,770
computer will<font color="#CCCCCC"> send the multicast so it's</font>

104
00:05:25,800 --> 00:05:31,890
HTTP<font color="#E5E5E5"> over UDP</font><font color="#CCCCCC"> request to discover either</font>

105
00:05:28,770 --> 00:05:34,770
any<font color="#CCCCCC"> UPnP another gateway device on the</font>

106
00:05:31,890 --> 00:05:36,870
network<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that would be</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> IgD</font><font color="#E5E5E5"> I</font>

107
00:05:34,770 --> 00:05:38,430
believe the Internet gateway device in

108
00:05:36,870 --> 00:05:40,350
the<font color="#E5E5E5"> European peace specification and</font>

109
00:05:38,430 --> 00:05:43,230
<font color="#E5E5E5">that is basically the Rooter</font><font color="#CCCCCC"> so you are</font>

110
00:05:40,350 --> 00:05:46,470
looking<font color="#CCCCCC"> for a favor Rooter</font><font color="#E5E5E5"> right and the</font>

111
00:05:43,230 --> 00:05:48,900
router will reply back<font color="#CCCCCC"> with over UDP</font>

112
00:05:46,470 --> 00:05:52,920
<font color="#E5E5E5">with an XML location of its control</font>

113
00:05:48,900 --> 00:05:54,630
points like so<font color="#E5E5E5"> and then the computer</font>

114
00:05:52,920 --> 00:05:56,760
<font color="#CCCCCC">will ask the Rooter to</font><font color="#E5E5E5"> forward a</font>

115
00:05:54,630 --> 00:05:59,640
particular<font color="#CCCCCC"> port in order</font><font color="#E5E5E5"> for the</font>

116
00:05:56,760 --> 00:06:03,030
peer-to-peer to work so<font color="#E5E5E5"> this is the</font>

117
00:05:59,640 --> 00:06:05,789
control<font color="#CCCCCC"> part</font><font color="#E5E5E5"> and finally the Rooter will</font>

118
00:06:03,030 --> 00:06:08,130
just comply and<font color="#E5E5E5"> say ok you I opened the</font>

119
00:06:05,790 --> 00:06:10,230
spot and the direct connection can be

120
00:06:08,130 --> 00:06:12,390
made it's as simple as that

121
00:06:10,230 --> 00:06:14,370
and this happens if<font color="#CCCCCC"> like a few</font>

122
00:06:12,390 --> 00:06:16,830
milliseconds and you<font color="#CCCCCC"> does not</font><font color="#E5E5E5"> notice</font>

123
00:06:14,370 --> 00:06:20,070
anything<font color="#E5E5E5"> but that is what you</font><font color="#CCCCCC"> pimpy can</font>

124
00:06:16,830 --> 00:06:21,810
<font color="#CCCCCC">be useful for and this</font><font color="#E5E5E5"> is the more</font>

125
00:06:20,070 --> 00:06:25,170
<font color="#E5E5E5">formal view of what is happening via the</font>

126
00:06:21,810 --> 00:06:27,300
scene<font color="#CCCCCC"> so 1st SS DB over UDP when SCPD</font>

127
00:06:25,170 --> 00:06:30,950
over TCP and finally the<font color="#CCCCCC"> control</font><font color="#E5E5E5"> path</font>

128
00:06:27,300 --> 00:06:33,990
with soap<font color="#E5E5E5"> this is just air for reference</font>

129
00:06:30,950 --> 00:06:36,409
<font color="#E5E5E5">what happens now if you send a discovery</font>

130
00:06:33,990 --> 00:06:39,210
packet so<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> M search</font><font color="#E5E5E5"> packet over</font>

131
00:06:36,410 --> 00:06:41,250
<font color="#CCCCCC">UDP on the Internet</font>

132
00:06:39,210 --> 00:06:43,650
to some random water is it supposed to

133
00:06:41,250 --> 00:06:46,650
reply back well of course it isn't

134
00:06:43,650 --> 00:06:49,799
<font color="#E5E5E5">supposed to reply because European</font><font color="#CCCCCC"> peace</font>

135
00:06:46,650 --> 00:06:53,400
is<font color="#E5E5E5"> supposed to be on the land it does no</font>

136
00:06:49,800 --> 00:06:56,460
I I mean no sense to be<font color="#CCCCCC"> on the internet</font>

137
00:06:53,400 --> 00:07:00,450
right but sometimes<font color="#CCCCCC"> when we computer</font>

138
00:06:56,460 --> 00:07:03,060
with just<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> here so this is</font><font color="#CCCCCC"> the first</font>

139
00:07:00,450 --> 00:07:04,740
vulnerability the discovery<font color="#E5E5E5"> service</font>

140
00:07:03,060 --> 00:07:07,050
should<font color="#E5E5E5"> understand on the one interface</font>

141
00:07:04,740 --> 00:07:09,930
of course and when<font color="#E5E5E5"> you get something</font>

142
00:07:07,050 --> 00:07:13,110
like<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> say now I'm search with</font>

143
00:07:09,930 --> 00:07:15,330
oath as a local multicast address

144
00:07:13,110 --> 00:07:18,530
<font color="#CCCCCC">because this is</font><font color="#E5E5E5"> like no more M such</font>

145
00:07:15,330 --> 00:07:21,960
packets<font color="#E5E5E5"> but you still get a 200</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> reply</font>

146
00:07:18,530 --> 00:07:24,260
<font color="#CCCCCC">even if it's</font><font color="#E5E5E5"> like from the internet so</font>

147
00:07:21,960 --> 00:07:27,180
<font color="#E5E5E5">there's something wrong here</font><font color="#CCCCCC"> obviously</font>

148
00:07:24,260 --> 00:07:31,440
<font color="#CCCCCC">don't don't need to be an expert too</font>

149
00:07:27,180 --> 00:07:34,500
so here is in blue is<font color="#CCCCCC"> the service</font>

150
00:07:31,440 --> 00:07:37,080
<font color="#E5E5E5">response if you're lucky you can notice</font>

151
00:07:34,500 --> 00:07:39,540
the<font color="#CCCCCC"> location header pointing to our</font>

152
00:07:37,080 --> 00:07:42,840
private IP address so this is the

153
00:07:39,540 --> 00:07:46,560
description XML<font color="#E5E5E5"> right so this here is</font>

154
00:07:42,840 --> 00:07:50,849
<font color="#CCCCCC">the discovery phase and is pointing you</font>

155
00:07:46,560 --> 00:07:52,950
to<font color="#CCCCCC"> be discovery phase so</font><font color="#E5E5E5"> no let's try oh</font>

156
00:07:50,850 --> 00:07:55,620
it's a private<font color="#E5E5E5"> IP address so I cannot</font>

157
00:07:52,950 --> 00:07:58,229
access<font color="#E5E5E5"> it from the internet</font><font color="#CCCCCC"> right well</font>

158
00:07:55,620 --> 00:08:02,240
<font color="#E5E5E5">just</font><font color="#CCCCCC"> replace the private IP with the</font>

159
00:07:58,230 --> 00:08:02,240
public IP<font color="#E5E5E5"> address and maybe it will work</font>

160
00:08:02,330 --> 00:08:08,760
sometimes it work so this<font color="#E5E5E5"> is the XML</font>

161
00:08:06,240 --> 00:08:11,430
exposing the control points<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this is</font>

162
00:08:08,760 --> 00:08:13,590
basically like<font color="#E5E5E5"> the soap URL and it will</font>

163
00:08:11,430 --> 00:08:16,110
describe<font color="#CCCCCC"> the</font><font color="#E5E5E5"> device capabilities what</font>

164
00:08:13,590 --> 00:08:18,989
what it what<font color="#CCCCCC"> it can offer and the most</font>

165
00:08:16,110 --> 00:08:21,360
interesting<font color="#E5E5E5"> part in this document is the</font>

166
00:08:18,990 --> 00:08:24,900
one IP connection service<font color="#E5E5E5"> and I will</font>

167
00:08:21,360 --> 00:08:26,310
explain why in the next<font color="#E5E5E5"> slide but what</font>

168
00:08:24,900 --> 00:08:29,640
you need<font color="#E5E5E5"> to know is</font><font color="#CCCCCC"> that this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font>

169
00:08:26,310 --> 00:08:31,590
<font color="#CCCCCC">circum vulnerability this XML file</font>

170
00:08:29,640 --> 00:08:33,840
shouldn't be exposed<font color="#E5E5E5"> on the Internet</font><font color="#CCCCCC"> it</font>

171
00:08:31,590 --> 00:08:35,309
should say on<font color="#E5E5E5"> the LAN and if it even if</font>

172
00:08:33,840 --> 00:08:37,350
it doesn't<font color="#E5E5E5"> contain any credential or</font>

173
00:08:35,309 --> 00:08:39,390
<font color="#E5E5E5">secrets</font><font color="#CCCCCC"> this isn't right</font>

174
00:08:37,350 --> 00:08:44,580
it gives more visibility<font color="#E5E5E5"> for an attacker</font>

175
00:08:39,390 --> 00:08:48,270
<font color="#CCCCCC">to further</font><font color="#E5E5E5"> abuse the protocol so what is</font>

176
00:08:44,580 --> 00:08:51,150
this one IP connection<font color="#E5E5E5"> service</font><font color="#CCCCCC"> so it's a</font>

177
00:08:48,270 --> 00:08:53,310
set of features introduced in<font color="#CCCCCC"> UPnP for</font>

178
00:08:51,150 --> 00:08:55,050
NAT traversal and generic bot mapping

179
00:08:53,310 --> 00:08:57,810
functionality<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> look at the</font>

180
00:08:55,050 --> 00:08:58,498
documentation<font color="#E5E5E5"> there is one function</font><font color="#CCCCCC"> but</font>

181
00:08:57,810 --> 00:09:00,329
is<font color="#E5E5E5"> actually</font>

182
00:08:58,499 --> 00:09:03,209
very interesting I don't<font color="#CCCCCC"> know if you can</font>

183
00:09:00,329 --> 00:09:05,309
read it<font color="#E5E5E5"> this is the</font><font color="#CCCCCC"> artpop mapping</font>

184
00:09:03,209 --> 00:09:06,478
function it<font color="#E5E5E5"> is being used in the example</font>

185
00:09:05,309 --> 00:09:09,539
I<font color="#CCCCCC"> showed you with</font><font color="#E5E5E5"> the peer-to-peer</font>

186
00:09:06,479 --> 00:09:11,399
clients<font color="#CCCCCC"> so you can basically ask the</font>

187
00:09:09,539 --> 00:09:13,709
<font color="#E5E5E5">router to redirect traffic to your OS</font>

188
00:09:11,399 --> 00:09:18,209
<font color="#E5E5E5">and this is yeah basically used for NAT</font>

189
00:09:13,709 --> 00:09:20,459
traversal<font color="#E5E5E5"> this Vince function takes at</font>

190
00:09:18,209 --> 00:09:23,628
least four parameters the protocol

191
00:09:20,459 --> 00:09:26,819
requested so TCP<font color="#E5E5E5"> or UDP then the</font>

192
00:09:23,629 --> 00:09:28,829
<font color="#CCCCCC">internet client where you</font><font color="#E5E5E5"> shoot the</font>

193
00:09:26,819 --> 00:09:31,169
where you ask the<font color="#E5E5E5"> water we're ready to</font>

194
00:09:28,829 --> 00:09:33,988
redirect the traffic to so IP address

195
00:09:31,169 --> 00:09:35,639
and<font color="#E5E5E5"> port and then we external port being</font>

196
00:09:33,989 --> 00:09:40,289
<font color="#E5E5E5">opened on the one interface of the</font>

197
00:09:35,639 --> 00:09:41,759
router<font color="#E5E5E5"> so this is what the fun begins of</font>

198
00:09:40,289 --> 00:09:44,669
<font color="#CCCCCC">course because</font><font color="#E5E5E5"> we can abuse this</font>

199
00:09:41,759 --> 00:09:47,429
function<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can even</font><font color="#E5E5E5"> call it from</font>

200
00:09:44,669 --> 00:09:50,399
<font color="#E5E5E5">the</font><font color="#CCCCCC"> internet so normally you will</font>

201
00:09:47,429 --> 00:09:52,409
provide your private IP address in the

202
00:09:50,399 --> 00:09:54,269
internal client parameter but you can

203
00:09:52,409 --> 00:09:56,699
actually<font color="#E5E5E5"> change</font><font color="#CCCCCC"> it to anything</font><font color="#E5E5E5"> right</font>

204
00:09:54,269 --> 00:09:58,859
<font color="#E5E5E5">because behind the</font><font color="#CCCCCC"> scenes</font><font color="#E5E5E5"> in most</font>

205
00:09:56,699 --> 00:10:01,589
implementations where<font color="#CCCCCC"> you PNP demon will</font>

206
00:09:58,859 --> 00:10:05,489
simply spawn IP tables<font color="#E5E5E5"> with your input</font>

207
00:10:01,589 --> 00:10:08,159
<font color="#CCCCCC">like no sanity checks okay</font><font color="#E5E5E5"> so that's</font>

208
00:10:05,489 --> 00:10:11,189
<font color="#CCCCCC">also why</font><font color="#E5E5E5"> you get a tons of remote code</font>

209
00:10:08,159 --> 00:10:13,349
execution on<font color="#CCCCCC"> UPnP demon because yeah</font>

210
00:10:11,189 --> 00:10:17,248
just<font color="#CCCCCC"> pawn</font><font color="#E5E5E5"> system IP tables with your</font>

211
00:10:13,349 --> 00:10:20,249
data<font color="#E5E5E5"> and you get</font><font color="#CCCCCC"> that 200 okay and this</font>

212
00:10:17,249 --> 00:10:24,689
is this is it<font color="#E5E5E5"> you can use the router as</font>

213
00:10:20,249 --> 00:10:27,929
a proxy<font color="#E5E5E5"> and connect</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> your target so of</font>

214
00:10:24,689 --> 00:10:30,659
course<font color="#CCCCCC"> right this is bad</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> there are</font>

215
00:10:27,929 --> 00:10:32,879
<font color="#E5E5E5">two flows being exploited here so first</font>

216
00:10:30,659 --> 00:10:34,379
of<font color="#E5E5E5"> all the sub invocation I mean it's</font>

217
00:10:32,879 --> 00:10:36,599
really<font color="#CCCCCC"> allowed from the internet and</font>

218
00:10:34,379 --> 00:10:38,309
secondly the the internal client

219
00:10:36,599 --> 00:10:41,999
parameter should<font color="#CCCCCC"> be a private IP address</font>

220
00:10:38,309 --> 00:10:44,459
like simple stuff but<font color="#E5E5E5"> you know and this</font>

221
00:10:41,999 --> 00:10:46,109
<font color="#E5E5E5">is a payload the soap payload you can so</font>

222
00:10:44,459 --> 00:10:48,899
soap is<font color="#E5E5E5"> basically if you don't</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> soap</font>

223
00:10:46,109 --> 00:10:51,749
it's basically like a fancy HTTP<font color="#E5E5E5"> so</font><font color="#CCCCCC"> if</font>

224
00:10:48,899 --> 00:10:54,779
this is<font color="#E5E5E5"> like a post request</font><font color="#CCCCCC"> with a few</font>

225
00:10:51,749 --> 00:10:58,229
things more but so this is the post

226
00:10:54,779 --> 00:11:00,569
request<font color="#E5E5E5"> and I like</font><font color="#CCCCCC"> make packets to be as</font>

227
00:10:58,229 --> 00:11:02,669
close<font color="#CCCCCC"> as possible to the legitimate</font>

228
00:11:00,569 --> 00:11:06,378
<font color="#CCCCCC">phone but</font><font color="#E5E5E5"> you can do as much smaller</font>

229
00:11:02,669 --> 00:11:09,929
payload so you<font color="#E5E5E5"> have the soap action</font>

230
00:11:06,379 --> 00:11:11,420
<font color="#E5E5E5">either and you just ask for</font><font color="#CCCCCC"> the hub</font><font color="#E5E5E5"> at</font>

231
00:11:09,929 --> 00:11:13,850
port mapping function

232
00:11:11,420 --> 00:11:16,010
and then the interesting parameters are

233
00:11:13,850 --> 00:11:18,380
new internal<font color="#E5E5E5"> clients which you can</font>

234
00:11:16,010 --> 00:11:20,810
specify your<font color="#E5E5E5"> target IP address</font><font color="#CCCCCC"> we in</font>

235
00:11:18,380 --> 00:11:23,420
Boeing port which can<font color="#CCCCCC"> be a random port</font>

236
00:11:20,810 --> 00:11:27,260
you choose<font color="#E5E5E5"> and destination port where</font>

237
00:11:23,420 --> 00:11:29,560
you<font color="#E5E5E5"> want to go okay</font><font color="#CCCCCC"> so time to do a</font>

238
00:11:27,260 --> 00:11:29,560
small demo

239
00:11:36,100 --> 00:11:38,130
Oh

240
00:11:38,220 --> 00:11:48,080
<font color="#E5E5E5">okay just went to sleep</font>

241
00:11:41,850 --> 00:11:48,080
sorry about<font color="#CCCCCC"> that or</font>

242
00:11:50,720 --> 00:11:56,379
I will duplicate right so

243
00:11:56,670 --> 00:12:01,800
there we go<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> a I'm sorry</font>

244
00:12:00,180 --> 00:12:04,140
it's really<font color="#E5E5E5"> small but</font><font color="#CCCCCC"> just to show</font><font color="#E5E5E5"> you</font>

245
00:12:01,800 --> 00:12:07,020
guys<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's really simple to exploit</font>

246
00:12:04,140 --> 00:12:09,540
and to find<font color="#E5E5E5"> new route so this is a small</font>

247
00:12:07,020 --> 00:12:11,970
script<font color="#E5E5E5"> I've made running on a VPS</font><font color="#CCCCCC"> and I</font>

248
00:12:09,540 --> 00:12:14,459
am rate-limiting myself and just to show

249
00:12:11,970 --> 00:12:17,250
<font color="#E5E5E5">you that in 60 seconds I can find like</font>

250
00:12:14,460 --> 00:12:20,580
<font color="#CCCCCC">10</font><font color="#E5E5E5"> Reuters being vulnerable to this</font><font color="#CCCCCC"> in</font>

251
00:12:17,250 --> 00:12:24,150
many countries<font color="#E5E5E5"> so I get light of a lot</font>

252
00:12:20,580 --> 00:12:26,220
<font color="#CCCCCC">of</font><font color="#E5E5E5"> em I'm</font><font color="#CCCCCC"> such reply</font><font color="#E5E5E5"> so a lot of</font><font color="#CCCCCC"> UPnP</font>

253
00:12:24,150 --> 00:12:34,980
device out<font color="#CCCCCC"> there and some of them being</font>

254
00:12:26,220 --> 00:12:36,710
vulnerable to<font color="#E5E5E5"> this</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> we can go to this</font>

255
00:12:34,980 --> 00:12:42,780
line<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> thank you</font>

256
00:12:36,710 --> 00:12:43,530
so yeah this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> quite an issue time to</font>

257
00:12:42,780 --> 00:12:47,060
do<font color="#CCCCCC"> some research</font>

258
00:12:43,530 --> 00:12:50,160
<font color="#CCCCCC">let's scan the planet with a squid</font><font color="#E5E5E5"> so I</font>

259
00:12:47,060 --> 00:12:53,579
found out<font color="#E5E5E5"> that UPnP enabled devices</font>

260
00:12:50,160 --> 00:12:56,670
<font color="#E5E5E5">account for almost 0.5 percent of all</font>

261
00:12:53,580 --> 00:12:59,220
the ipv4<font color="#E5E5E5"> address space which is I mean</font>

262
00:12:56,670 --> 00:13:01,890
it's small but it's kind of<font color="#E5E5E5"> huge when</font>

263
00:12:59,220 --> 00:13:05,010
you<font color="#E5E5E5"> compare to</font><font color="#CCCCCC"> other services</font><font color="#E5E5E5"> and among</font>

264
00:13:01,890 --> 00:13:07,560
those<font color="#CCCCCC"> 12%</font><font color="#E5E5E5"> are being vulnerable to be</font>

265
00:13:05,010 --> 00:13:12,260
open for<font color="#CCCCCC"> what attack that's quite a lot</font>

266
00:13:07,560 --> 00:13:17,760
because it's to<font color="#E5E5E5"> 260,000 online right now</font>

267
00:13:12,260 --> 00:13:20,670
<font color="#CCCCCC">devices being vulnerable</font><font color="#E5E5E5"> and you have</font>

268
00:13:17,760 --> 00:13:24,660
like most<font color="#CCCCCC"> green our operators are</font>

269
00:13:20,670 --> 00:13:27,449
<font color="#E5E5E5">located in Southeast Asia which is why</font>

270
00:13:24,660 --> 00:13:29,640
I'm I guess but it's more<font color="#CCCCCC"> like more</font><font color="#E5E5E5"> or</font>

271
00:13:27,450 --> 00:13:33,240
<font color="#E5E5E5">less a nice</font><font color="#CCCCCC"> P issue like miss</font>

272
00:13:29,640 --> 00:13:35,880
configuration happening from there<font color="#E5E5E5"> and</font>

273
00:13:33,240 --> 00:13:38,220
the good news though is that<font color="#E5E5E5"> this number</font>

274
00:13:35,880 --> 00:13:41,580
<font color="#E5E5E5">of wearable</font><font color="#CCCCCC"> devices is declining like</font>

275
00:13:38,220 --> 00:13:44,310
I've been doing scans<font color="#E5E5E5"> in November and a</font>

276
00:13:41,580 --> 00:13:46,950
few a few days<font color="#E5E5E5"> ago and the numbers are</font>

277
00:13:44,310 --> 00:13:50,699
like<font color="#E5E5E5"> declining so good news but it's</font>

278
00:13:46,950 --> 00:13:55,850
still a lot here is just a hit map to

279
00:13:50,700 --> 00:13:57,350
show<font color="#E5E5E5"> you so</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> are blue area</font>

280
00:13:55,850 --> 00:14:00,260
around the world<font color="#E5E5E5"> but especially in</font>

281
00:13:57,350 --> 00:14:04,190
Southeast Asia<font color="#CCCCCC"> some close ups or</font>

282
00:14:00,260 --> 00:14:08,980
<font color="#E5E5E5">Sherwood through torrid and yeah lots of</font>

283
00:14:04,190 --> 00:14:12,770
<font color="#CCCCCC">em in Korea and Japan</font><font color="#E5E5E5"> and also in China</font>

284
00:14:08,980 --> 00:14:14,750
so per ticket<font color="#CCCCCC"> all together this</font><font color="#E5E5E5"> is what</font>

285
00:14:12,770 --> 00:14:16,760
the inception group have<font color="#E5E5E5"> been doing</font><font color="#CCCCCC"> like</font>

286
00:14:14,750 --> 00:14:19,310
<font color="#E5E5E5">for years changing three layers of</font>

287
00:14:16,760 --> 00:14:21,020
<font color="#CCCCCC">filters</font><font color="#E5E5E5"> to anonymize themselves it's</font>

288
00:14:19,310 --> 00:14:23,300
really<font color="#CCCCCC"> easy once you get</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> treat like</font>

289
00:14:21,020 --> 00:14:26,870
<font color="#CCCCCC">at port mapping and then you can</font>

290
00:14:23,300 --> 00:14:29,510
basically use like proxy chains<font color="#E5E5E5"> and go</font>

291
00:14:26,870 --> 00:14:31,750
to the next<font color="#E5E5E5"> route or using the previous</font>

292
00:14:29,510 --> 00:14:35,540
one<font color="#E5E5E5"> and chain as many nodes as you want</font>

293
00:14:31,750 --> 00:14:37,690
<font color="#E5E5E5">so I guess we might then</font><font color="#CCCCCC"> want it to do</font>

294
00:14:35,540 --> 00:14:41,290
<font color="#CCCCCC">like a parallel tour</font><font color="#E5E5E5"> network because</font>

295
00:14:37,690 --> 00:14:43,790
<font color="#CCCCCC">tree nodes it's like the Tor network</font><font color="#E5E5E5"> and</font>

296
00:14:41,290 --> 00:14:46,219
about this botnet because we<font color="#E5E5E5"> can call</font>

297
00:14:43,790 --> 00:14:48,620
<font color="#E5E5E5">its about net because they are made of</font>

298
00:14:46,220 --> 00:14:52,220
compromised<font color="#CCCCCC"> Rooter</font><font color="#E5E5E5"> so even if there is</font>

299
00:14:48,620 --> 00:14:55,310
no payload well I mean no binary it's

300
00:14:52,220 --> 00:14:57,470
still a botnet phone in my book so there

301
00:14:55,310 --> 00:15:00,319
is a large set<font color="#CCCCCC"> of nodes located in more</font>

302
00:14:57,470 --> 00:15:02,990
than 80 countries<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> 40 times more</font>

303
00:15:00,320 --> 00:15:04,640
nodes<font color="#E5E5E5"> than actual</font><font color="#CCCCCC"> toe relays so I guess</font>

304
00:15:02,990 --> 00:15:07,370
why maybe we<font color="#CCCCCC"> attacked or I've been</font>

305
00:15:04,640 --> 00:15:09,620
<font color="#CCCCCC">choosing this technique</font><font color="#E5E5E5"> and also</font><font color="#CCCCCC"> a</font>

306
00:15:07,370 --> 00:15:12,770
minimal footprint<font color="#E5E5E5"> no implant unnecessary</font>

307
00:15:09,620 --> 00:15:15,640
<font color="#CCCCCC">you just use their protocol</font><font color="#E5E5E5"> and logs are</font>

308
00:15:12,770 --> 00:15:20,480
really<font color="#E5E5E5"> hard to get on those devices so</font>

309
00:15:15,640 --> 00:15:22,490
really<font color="#E5E5E5"> like no no traces also you get</font>

310
00:15:20,480 --> 00:15:23,570
residential IP addresses<font color="#E5E5E5"> which is kind</font>

311
00:15:22,490 --> 00:15:27,350
of good because<font color="#E5E5E5"> you are not being</font>

312
00:15:23,570 --> 00:15:30,530
blacklisted<font color="#E5E5E5"> but yeah it's kind of slow</font>

313
00:15:27,350 --> 00:15:36,620
<font color="#E5E5E5">that is true and there are no encryption</font>

314
00:15:30,530 --> 00:15:39,079
<font color="#E5E5E5">so but wait like all run</font><font color="#CCCCCC"> oddity</font>

315
00:15:36,620 --> 00:15:41,390
researchers uncovered the<font color="#CCCCCC"> VIS botnet</font>

316
00:15:39,080 --> 00:15:43,670
like<font color="#E5E5E5"> what did they find</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> the fret</font>

317
00:15:41,390 --> 00:15:50,030
actor have been using exactly<font color="#E5E5E5"> three</font>

318
00:15:43,670 --> 00:15:53,449
layers of photos can you guess<font color="#E5E5E5"> like it's</font>

319
00:15:50,030 --> 00:15:56,209
time to be<font color="#CCCCCC"> hacker</font><font color="#E5E5E5"> man so say hello</font><font color="#CCCCCC"> to</font>

320
00:15:53,450 --> 00:15:58,670
this little<font color="#CCCCCC"> European B function</font><font color="#E5E5E5"> called</font>

321
00:15:56,210 --> 00:16:00,650
get generic port mapping entry which

322
00:15:58,670 --> 00:16:04,430
doesn't really need some fancy

323
00:16:00,650 --> 00:16:06,880
documentation to guess what it can do so

324
00:16:04,430 --> 00:16:10,349
you<font color="#E5E5E5"> can create the water and</font>

325
00:16:06,880 --> 00:16:14,230
<font color="#E5E5E5">we get a list</font><font color="#CCCCCC"> of all active</font><font color="#E5E5E5"> entries</font>

326
00:16:10,350 --> 00:16:16,660
including the ones that are added using

327
00:16:14,230 --> 00:16:19,200
<font color="#CCCCCC">the</font><font color="#E5E5E5"> add port mapping function which is</font>

328
00:16:16,660 --> 00:16:22,060
kind of cool<font color="#CCCCCC"> because</font><font color="#E5E5E5"> with this well</font>

329
00:16:19,200 --> 00:16:26,020
let's track the inception<font color="#CCCCCC"> ephemeral</font>

330
00:16:22,060 --> 00:16:30,250
group so what<font color="#E5E5E5"> you have to do to do to do</font>

331
00:16:26,020 --> 00:16:33,340
this is just scans for all the<font color="#CCCCCC"> European</font>

332
00:16:30,250 --> 00:16:36,580
POS on the<font color="#E5E5E5"> planet and send get generic</font>

333
00:16:33,340 --> 00:16:38,560
pop mapping<font color="#E5E5E5"> country</font><font color="#CCCCCC"> request and if you</font>

334
00:16:36,580 --> 00:16:42,520
get a reply well the device<font color="#E5E5E5"> is</font>

335
00:16:38,560 --> 00:16:45,550
vulnerable<font color="#CCCCCC"> so</font><font color="#E5E5E5"> okay cool and also you</font>

336
00:16:42,520 --> 00:16:48,760
will<font color="#E5E5E5"> get like a list of all the entries</font>

337
00:16:45,550 --> 00:16:51,160
going on so if you see<font color="#E5E5E5"> like a public</font><font color="#CCCCCC"> IP</font>

338
00:16:48,760 --> 00:16:53,830
address in the<font color="#E5E5E5"> port mapping entry very</font>

339
00:16:51,160 --> 00:16:55,810
something really fishy going on<font color="#E5E5E5"> so for</font>

340
00:16:53,830 --> 00:16:58,420
<font color="#E5E5E5">example if you get a reply from this one</font>

341
00:16:55,810 --> 00:17:01,660
<font color="#E5E5E5">and you say</font><font color="#CCCCCC"> ok oh I get there is</font><font color="#E5E5E5"> an</font>

342
00:16:58,420 --> 00:17:04,659
<font color="#E5E5E5">active connection from C</font><font color="#CCCCCC"> to some other</font>

343
00:17:01,660 --> 00:17:06,099
IP like in South America<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is weird I</font>

344
00:17:04,660 --> 00:17:08,410
will keep it in mind

345
00:17:06,099 --> 00:17:12,639
<font color="#CCCCCC">oh and on this route</font><font color="#E5E5E5"> servers another</font>

346
00:17:08,410 --> 00:17:16,569
active entry going to<font color="#E5E5E5"> be to see</font><font color="#CCCCCC"> and on</font>

347
00:17:12,640 --> 00:17:19,680
this<font color="#E5E5E5"> one you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> have connection not a</font>

348
00:17:16,569 --> 00:17:23,050
connection but an entry on<font color="#E5E5E5"> A to B so</font>

349
00:17:19,680 --> 00:17:27,040
<font color="#CCCCCC">this way you can really like trace back</font>

350
00:17:23,050 --> 00:17:29,020
<font color="#E5E5E5">the enzyme from framework I have just</font>

351
00:17:27,040 --> 00:17:32,139
one small question for Simon<font color="#CCCCCC"> techies</font>

352
00:17:29,020 --> 00:17:35,500
because with this<font color="#E5E5E5"> technique</font><font color="#CCCCCC"> you cannot</font>

353
00:17:32,140 --> 00:17:38,590
find the oil<font color="#E5E5E5"> origin so I don't know oh</font>

354
00:17:35,500 --> 00:17:43,440
wait it will tell the where VPS server

355
00:17:38,590 --> 00:17:43,439
involved<font color="#CCCCCC"> that it's interesting to know</font>

356
00:17:43,800 --> 00:17:49,230
this is<font color="#E5E5E5"> not it</font><font color="#CCCCCC"> varies a counter</font>

357
00:17:46,300 --> 00:17:52,360
<font color="#E5E5E5">hacktivist so ought to be like a ghost</font>

358
00:17:49,230 --> 00:17:55,750
<font color="#CCCCCC">small trick so it's easy actually</font>

359
00:17:52,360 --> 00:17:57,850
<font color="#E5E5E5">after a successful port mapping just</font>

360
00:17:55,750 --> 00:18:00,070
make your connection and then<font color="#E5E5E5"> you can</font>

361
00:17:57,850 --> 00:18:01,300
invoke<font color="#E5E5E5"> delete port mapping and of course</font>

362
00:18:00,070 --> 00:18:04,419
<font color="#CCCCCC">delete bone mapping</font>

363
00:18:01,300 --> 00:18:06,210
well it won't close your TCP session

364
00:18:04,420 --> 00:18:09,430
once your TCP session is established

365
00:18:06,210 --> 00:18:13,000
<font color="#CCCCCC">well</font><font color="#E5E5E5"> it's like I told you IP tables</font>

366
00:18:09,430 --> 00:18:15,450
<font color="#CCCCCC">behind so if you remove a rules</font><font color="#E5E5E5"> your TCP</font>

367
00:18:13,000 --> 00:18:17,110
session if it's open it will stay

368
00:18:15,450 --> 00:18:19,749
<font color="#E5E5E5">established</font>

369
00:18:17,110 --> 00:18:23,110
and then if a third party tries to

370
00:18:19,749 --> 00:18:27,879
create<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Rooter for any boat country</font>

371
00:18:23,110 --> 00:18:34,149
he wants see anything<font color="#E5E5E5"> so this is one way</font>

372
00:18:27,879 --> 00:18:36,189
to be like invisible<font color="#CCCCCC"> some hover fred</font><font color="#E5E5E5"> Tac</font>

373
00:18:34,149 --> 00:18:38,469
<font color="#E5E5E5">Toe have been using the same bag this</font>

374
00:18:36,190 --> 00:18:41,379
time<font color="#E5E5E5"> discovered by Akamai and published</font>

375
00:18:38,470 --> 00:18:45,519
in November last last<font color="#E5E5E5"> year so what is</font>

376
00:18:41,379 --> 00:18:47,529
this all<font color="#CCCCCC"> about what this protector I've</font>

377
00:18:45,519 --> 00:18:49,749
been doing is<font color="#E5E5E5"> quite smart</font><font color="#CCCCCC"> he wanted to</font>

378
00:18:47,529 --> 00:18:52,509
exploit the eternal<font color="#CCCCCC"> grooving</font><font color="#E5E5E5"> ability on</font>

379
00:18:49,749 --> 00:18:56,609
computers but<font color="#CCCCCC"> we're behind NAT and used</font>

380
00:18:52,509 --> 00:18:59,409
<font color="#CCCCCC">upp to directly connect to its target so</font>

381
00:18:56,609 --> 00:19:01,389
from the internet and I<font color="#CCCCCC"> really think</font>

382
00:18:59,409 --> 00:19:06,070
<font color="#CCCCCC">that ahem I should have called</font><font color="#E5E5E5"> that</font>

383
00:19:01,389 --> 00:19:08,109
external blue yeah<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't know but yeah</font>

384
00:19:06,070 --> 00:19:10,418
they<font color="#CCCCCC"> actually named it after the</font>

385
00:19:08,109 --> 00:19:13,210
signature<font color="#E5E5E5"> of a phone on the packet so</font>

386
00:19:10,419 --> 00:19:15,309
the<font color="#E5E5E5"> description</font><font color="#CCCCCC"> actually in the soap</font><font color="#E5E5E5"> you</font>

387
00:19:13,210 --> 00:19:17,320
could you can<font color="#CCCCCC"> you have a optional</font>

388
00:19:15,309 --> 00:19:20,499
<font color="#E5E5E5">parameter called description and this</font>

389
00:19:17,320 --> 00:19:23,399
<font color="#E5E5E5">fret</font><font color="#CCCCCC"> actor have been</font><font color="#E5E5E5"> writing</font><font color="#CCCCCC"> Garrity's</font>

390
00:19:20,499 --> 00:19:26,919
<font color="#CCCCCC">lancer so I don't know why in the soap</font>

391
00:19:23,399 --> 00:19:32,080
<font color="#E5E5E5">so that's one way to make</font><font color="#CCCCCC"> yourself</font>

392
00:19:26,919 --> 00:19:35,350
detectable so yeah<font color="#CCCCCC"> and then once the</font>

393
00:19:32,080 --> 00:19:38,009
port is open<font color="#E5E5E5"> you can exploit the make</font>

394
00:19:35,350 --> 00:19:38,009
the computer

395
00:19:39,550 --> 00:19:46,000
more<font color="#CCCCCC"> ox so this can be further</font><font color="#E5E5E5"> abused</font>

396
00:19:42,850 --> 00:19:48,909
<font color="#E5E5E5">for discovery of internal lost with the</font>

397
00:19:46,000 --> 00:19:50,980
fact that<font color="#CCCCCC"> private IP addresses easily</font>

398
00:19:48,910 --> 00:19:53,700
<font color="#CCCCCC">enumerable</font><font color="#E5E5E5"> just go through all</font><font color="#CCCCCC"> no</font>

399
00:19:50,980 --> 00:19:56,440
imports<font color="#E5E5E5"> and</font><font color="#CCCCCC"> fingerprint internal</font><font color="#E5E5E5"> host</font>

400
00:19:53,700 --> 00:19:58,570
<font color="#E5E5E5">and you can access</font><font color="#CCCCCC"> them sensitive data</font>

401
00:19:56,440 --> 00:20:02,100
<font color="#E5E5E5">like storage printers and stuff like</font>

402
00:19:58,570 --> 00:20:04,960
that<font color="#CCCCCC"> given the fact that most people</font>

403
00:20:02,100 --> 00:20:07,330
give little attention to<font color="#E5E5E5"> their internal</font>

404
00:20:04,960 --> 00:20:13,210
security<font color="#E5E5E5"> this can pose a huge risk for</font>

405
00:20:07,330 --> 00:20:15,580
owners of<font color="#E5E5E5"> vulnerable</font><font color="#CCCCCC"> reuters last UPnP</font>

406
00:20:13,210 --> 00:20:17,920
<font color="#E5E5E5">act for today</font><font color="#CCCCCC"> soul</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> özkan</font><font color="#E5E5E5"> think</font>

407
00:20:15,580 --> 00:20:20,770
<font color="#CCCCCC">management service is another set</font><font color="#E5E5E5"> of</font>

408
00:20:17,920 --> 00:20:23,350
features being offered by<font color="#CCCCCC"> UPnP and guess</font>

409
00:20:20,770 --> 00:20:26,710
what<font color="#E5E5E5"> not</font><font color="#CCCCCC"> only can</font><font color="#E5E5E5"> you get internal</font>

410
00:20:23,350 --> 00:20:29,980
parameters such as domain<font color="#E5E5E5"> name DHCP or</font>

411
00:20:26,710 --> 00:20:35,050
DNS server but you<font color="#E5E5E5"> can actually set them</font>

412
00:20:29,980 --> 00:20:36,850
whoa yeah and well this function speaks

413
00:20:35,050 --> 00:20:38,710
for itself<font color="#CCCCCC"> you can guess it's</font><font color="#E5E5E5"> pretty</font>

414
00:20:36,850 --> 00:20:41,230
dangerous<font color="#E5E5E5"> if your rotor is being a</font>

415
00:20:38,710 --> 00:20:44,650
vulnerable and exposed<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the internet</font>

416
00:20:41,230 --> 00:20:49,500
you<font color="#CCCCCC"> can change the NS server which is</font>

417
00:20:44,650 --> 00:20:53,190
kind of critical<font color="#CCCCCC"> in my opinion so yeah</font>

418
00:20:49,500 --> 00:20:55,510
<font color="#CCCCCC">UPnP acts are still at</font><font color="#E5E5E5"> I think in 2019</font>

419
00:20:53,190 --> 00:20:57,220
<font color="#CCCCCC">there have been</font><font color="#E5E5E5"> years of abuse by</font>

420
00:20:55,510 --> 00:20:59,710
multiple threat actors and what is

421
00:20:57,220 --> 00:21:04,080
<font color="#E5E5E5">interesting here is it's really like no</font>

422
00:20:59,710 --> 00:21:06,400
code no crime like like in Windows

423
00:21:04,080 --> 00:21:09,250
environments<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> marvels</font>

424
00:21:06,400 --> 00:21:11,410
<font color="#E5E5E5">of course but you</font><font color="#CCCCCC"> have also a</font><font color="#E5E5E5"> lot of</font>

425
00:21:09,250 --> 00:21:13,630
antivirus and telemetry<font color="#E5E5E5"> so you can</font>

426
00:21:11,410 --> 00:21:16,530
detect<font color="#E5E5E5"> them pretty easily</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> it has</font>

427
00:21:13,630 --> 00:21:19,930
been<font color="#E5E5E5"> lay low like it's been low key</font>

428
00:21:16,530 --> 00:21:22,750
using<font color="#E5E5E5"> like I think for five years it has</font>

429
00:21:19,930 --> 00:21:26,080
been detected<font color="#E5E5E5"> for at least five years so</font>

430
00:21:22,750 --> 00:21:30,880
yeah you can go<font color="#E5E5E5"> unnoticed with</font>

431
00:21:26,080 --> 00:21:33,159
techniques like this and yeah so yeah

432
00:21:30,880 --> 00:21:35,200
patch it or disable it no but I guess

433
00:21:33,160 --> 00:21:36,430
it's more like<font color="#E5E5E5"> miss configuration going</font>

434
00:21:35,200 --> 00:21:39,310
on

435
00:21:36,430 --> 00:21:43,180
so operators need<font color="#CCCCCC"> ISP need to do</font>

436
00:21:39,310 --> 00:21:45,830
something about that here are my

437
00:21:43,180 --> 00:21:47,490
references<font color="#CCCCCC"> I used</font><font color="#E5E5E5"> for is research and</font>

438
00:21:45,830 --> 00:21:50,010
thank you

439
00:21:47,490 --> 00:21:53,789
[Applause]

440
00:21:50,010 --> 00:21:53,789
[Music]

