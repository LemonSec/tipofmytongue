1
00:00:00,030 --> 00:00:04,799
and I have the<font color="#E5E5E5"> pleasure of introducing</font>

2
00:00:00,930 --> 00:00:07,500
<font color="#E5E5E5">two wonderful individuals from</font><font color="#CCCCCC"> MWR Mpho</font>

3
00:00:04,799 --> 00:00:09,870
security we<font color="#E5E5E5"> have got Dave</font><font color="#CCCCCC"> Hartley</font><font color="#E5E5E5"> a</font>

4
00:00:07,500 --> 00:00:12,240
published author and<font color="#CCCCCC"> Metasploit</font>

5
00:00:09,870 --> 00:00:15,509
contributor as well as William Knowles

6
00:00:12,240 --> 00:00:21,570
for post exploitation<font color="#E5E5E5"> researcher with</font>

7
00:00:15,509 --> 00:00:22,080
that thank you<font color="#CCCCCC"> hi everyone thank you</font>

8
00:00:21,570 --> 00:00:24,660
<font color="#CCCCCC">very</font><font color="#E5E5E5"> much</font>

9
00:00:22,080 --> 00:00:26,880
so before we<font color="#E5E5E5"> start I just want to say</font>

10
00:00:24,660 --> 00:00:29,130
<font color="#E5E5E5">like we've really enjoyed being here so</font>

11
00:00:26,880 --> 00:00:30,840
far<font color="#E5E5E5"> and the hospitality is out of this</font>

12
00:00:29,130 --> 00:00:32,820
<font color="#E5E5E5">world this is the</font><font color="#CCCCCC"> best we've ever</font><font color="#E5E5E5"> been</font>

13
00:00:30,840 --> 00:00:35,100
trapped as a speaker anywhere<font color="#E5E5E5"> so thank</font>

14
00:00:32,820 --> 00:00:38,270
you very<font color="#E5E5E5"> much to everyone involved</font><font color="#CCCCCC"> ok so</font>

15
00:00:35,100 --> 00:00:41,309
moving<font color="#E5E5E5"> on we're here to talk about</font>

16
00:00:38,270 --> 00:00:43,980
<font color="#E5E5E5">command and control title is over at CT</font>

17
00:00:41,309 --> 00:00:47,760
over<font color="#CCCCCC"> it see to the art of</font><font color="#E5E5E5"> blending in</font>

18
00:00:43,980 --> 00:00:48,809
and basically just<font color="#E5E5E5"> to make sure</font><font color="#CCCCCC"> that</font>

19
00:00:47,760 --> 00:00:54,510
you're in the right room<font color="#E5E5E5"> and don't to</font>

20
00:00:48,809 --> 00:00:57,569
run out what we're<font color="#E5E5E5"> gonna do is talk</font>

21
00:00:54,510 --> 00:01:00,030
through various different<font color="#CCCCCC"> capabilities</font>

22
00:00:57,570 --> 00:01:02,879
<font color="#E5E5E5">that lots of different text</font><font color="#CCCCCC"> acts blinkin</font>

23
00:01:00,030 --> 00:01:04,530
boxes are able to<font color="#E5E5E5"> do these days with</font>

24
00:01:02,879 --> 00:01:06,630
detecting command and control channels

25
00:01:04,530 --> 00:01:08,400
<font color="#E5E5E5">initiated by malware</font><font color="#CCCCCC"> our red team's and</font>

26
00:01:06,630 --> 00:01:10,408
bits and<font color="#E5E5E5"> pieces</font><font color="#CCCCCC"> we're going to show you</font>

27
00:01:08,400 --> 00:01:13,229
or talk about<font color="#CCCCCC"> a few tricks that</font><font color="#E5E5E5"> we've</font>

28
00:01:10,409 --> 00:01:15,060
used over<font color="#E5E5E5"> the months years to fly under</font>

29
00:01:13,229 --> 00:01:17,189
<font color="#CCCCCC">the radar of</font><font color="#E5E5E5"> some of those technology</font>

30
00:01:15,060 --> 00:01:20,250
stacks and individuals looking<font color="#E5E5E5"> for</font>

31
00:01:17,189 --> 00:01:22,460
things<font color="#E5E5E5"> that we're up to and</font><font color="#CCCCCC"> we'll</font>

32
00:01:20,250 --> 00:01:25,650
discuss what's available<font color="#E5E5E5"> at the moment</font>

33
00:01:22,460 --> 00:01:27,119
<font color="#E5E5E5">in the offensive tooling world for what</font>

34
00:01:25,650 --> 00:01:30,090
works<font color="#E5E5E5"> sort of classifying traditional</font>

35
00:01:27,119 --> 00:01:33,060
<font color="#E5E5E5">command and control channels and we're</font>

36
00:01:30,090 --> 00:01:35,600
in a demo tool<font color="#E5E5E5"> today that we will be</font>

37
00:01:33,060 --> 00:01:39,270
<font color="#E5E5E5">releasing but perhaps not today because</font>

38
00:01:35,600 --> 00:01:40,919
your codes a bit shoddy<font color="#E5E5E5"> and but we're</font>

39
00:01:39,270 --> 00:01:44,100
almost<font color="#E5E5E5"> there hopefully we will release</font>

40
00:01:40,920 --> 00:01:45,659
<font color="#CCCCCC">it very soon</font><font color="#E5E5E5"> and we want to sort of end</font>

41
00:01:44,100 --> 00:01:46,949
with the obligatory<font color="#E5E5E5"> help you with a</font>

42
00:01:45,659 --> 00:01:48,829
little<font color="#CCCCCC"> bit if it</font><font color="#E5E5E5"> defends where do we go</font>

43
00:01:46,950 --> 00:01:50,700
from here<font color="#CCCCCC"> what can we be doing and</font>

44
00:01:48,829 --> 00:01:52,169
hopefully<font color="#E5E5E5"> now you want to stick</font><font color="#CCCCCC"> around</font>

45
00:01:50,700 --> 00:01:58,100
and<font color="#E5E5E5"> listen to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so I'll give you</font><font color="#CCCCCC"> a</font>

46
00:01:52,170 --> 00:02:04,680
second to<font color="#E5E5E5"> run away if you want</font><font color="#CCCCCC"> ok cool</font>

47
00:01:58,100 --> 00:02:06,869
<font color="#E5E5E5">so</font><font color="#CCCCCC"> CB on a slide we do red blue purple</font>

48
00:02:04,680 --> 00:02:08,340
rainbow<font color="#E5E5E5"> teaming whatever you want to</font>

49
00:02:06,869 --> 00:02:10,139
classify<font color="#E5E5E5"> it call it</font>

50
00:02:08,340 --> 00:02:12,090
we've got shiny badges and

51
00:02:10,139 --> 00:02:13,619
certifications and accreditations and

52
00:02:12,090 --> 00:02:16,710
<font color="#E5E5E5">all that</font><font color="#CCCCCC"> sort stuff</font>

53
00:02:13,620 --> 00:02:18,870
basically we<font color="#E5E5E5"> primarily operate with Tier</font>

54
00:02:16,710 --> 00:02:20,340
one<font color="#CCCCCC"> international financials</font><font color="#E5E5E5"> running</font>

55
00:02:18,870 --> 00:02:22,020
what you guys would classify<font color="#CCCCCC"> as</font><font color="#E5E5E5"> red team</font>

56
00:02:20,340 --> 00:02:24,180
<font color="#E5E5E5">but it's kind</font><font color="#CCCCCC"> of attack simulation</font>

57
00:02:22,020 --> 00:02:25,890
simulation stuff<font color="#E5E5E5"> helping</font><font color="#CCCCCC"> those</font>

58
00:02:24,180 --> 00:02:28,800
<font color="#E5E5E5">organizations mature their cyber</font>

59
00:02:25,890 --> 00:02:30,359
resilience<font color="#E5E5E5"> not just owning them but also</font>

60
00:02:28,800 --> 00:02:34,110
helping them<font color="#E5E5E5"> to better defend their</font>

61
00:02:30,360 --> 00:02:35,610
environments<font color="#E5E5E5"> not just financial we also</font>

62
00:02:34,110 --> 00:02:41,010
work<font color="#CCCCCC"> in other industries government</font>

63
00:02:35,610 --> 00:02:42,600
telcos<font color="#E5E5E5"> nuclear all that stuff si si si</font>

64
00:02:41,010 --> 00:02:43,950
si loads<font color="#E5E5E5"> of schemes that do like</font>

65
00:02:42,600 --> 00:02:46,530
detection and response is a response

66
00:02:43,950 --> 00:02:49,200
<font color="#CCCCCC">it's all really impressive</font><font color="#E5E5E5"> but if you're</font>

67
00:02:46,530 --> 00:02:50,970
<font color="#E5E5E5">not that impressed</font><font color="#CCCCCC"> I was hoping he</font><font color="#E5E5E5"> might</font>

68
00:02:49,200 --> 00:02:52,470
be in the audience<font color="#CCCCCC"> but he's certainly</font>

69
00:02:50,970 --> 00:02:54,630
<font color="#CCCCCC">been impressed with</font><font color="#E5E5E5"> some of</font><font color="#CCCCCC"> our work and</font>

70
00:02:52,470 --> 00:02:56,760
when we do these kind of<font color="#E5E5E5"> operations</font>

71
00:02:54,630 --> 00:02:57,840
invariably some of our malware he's

72
00:02:56,760 --> 00:03:00,420
<font color="#CCCCCC">gonna get</font><font color="#E5E5E5"> out there</font><font color="#CCCCCC"> into the public</font>

73
00:02:57,840 --> 00:03:03,270
domain<font color="#E5E5E5"> people pick up on it and it's</font>

74
00:03:00,420 --> 00:03:05,488
nice<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have it praised we didn't</font>

75
00:03:03,270 --> 00:03:07,920
actually use<font color="#E5E5E5"> any of those in any real</font>

76
00:03:05,489 --> 00:03:11,040
campaigns but<font color="#E5E5E5"> then also we've</font><font color="#CCCCCC"> had</font>

77
00:03:07,920 --> 00:03:13,410
various certs<font color="#E5E5E5"> across the world that</font>

78
00:03:11,040 --> 00:03:15,660
<font color="#E5E5E5">intelligence groups I guess you could</font>

79
00:03:13,410 --> 00:03:17,250
<font color="#E5E5E5">call them put in a phone call to some</font>

80
00:03:15,660 --> 00:03:19,260
<font color="#E5E5E5">clients or industries and</font><font color="#CCCCCC"> warn them that</font>

81
00:03:17,250 --> 00:03:25,049
<font color="#CCCCCC">our new</font><font color="#E5E5E5"> Russian apt is on its way and</font>

82
00:03:19,260 --> 00:03:27,600
it's<font color="#CCCCCC"> not it's just us</font><font color="#E5E5E5"> so what's the kind</font>

83
00:03:25,049 --> 00:03:30,049
of premise to this<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> set</font>

84
00:03:27,600 --> 00:03:35,100
off by making a statement<font color="#E5E5E5"> that you</font>

85
00:03:30,049 --> 00:03:37,290
perfectly able<font color="#E5E5E5"> to challenge but I firmly</font>

86
00:03:35,100 --> 00:03:40,260
believe that blue<font color="#CCCCCC"> team's these days have</font>

87
00:03:37,290 --> 00:03:43,140
so many<font color="#E5E5E5"> tools and tricks and all sorts</font>

88
00:03:40,260 --> 00:03:45,899
of cool stuff<font color="#E5E5E5"> in their bags</font><font color="#CCCCCC"> to really</font>

89
00:03:43,140 --> 00:03:47,880
rival most red<font color="#CCCCCC"> teams</font><font color="#E5E5E5"> and threat actors</font>

90
00:03:45,900 --> 00:03:51,750
capabilities the<font color="#CCCCCC"> industry's matured</font>

91
00:03:47,880 --> 00:03:53,190
massively there's lots of stuff

92
00:03:51,750 --> 00:03:56,160
commercial lots of people rolling their

93
00:03:53,190 --> 00:03:58,140
own doing impressive things and my view

94
00:03:56,160 --> 00:04:01,410
<font color="#CCCCCC">is that if you've got all this stuff in</font>

95
00:03:58,140 --> 00:04:03,720
<font color="#E5E5E5">place that even if you're really capable</font>

96
00:04:01,410 --> 00:04:06,090
<font color="#E5E5E5">and adaptive adversary' rolling your</font><font color="#CCCCCC"> own</font>

97
00:04:03,720 --> 00:04:08,730
stuff even if it's all customized you're

98
00:04:06,090 --> 00:04:11,310
likely<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> detected in most modern</font>

99
00:04:08,730 --> 00:04:13,140
<font color="#CCCCCC">amateur environments so as far</font><font color="#E5E5E5"> as we're</font>

100
00:04:11,310 --> 00:04:15,989
concerned<font color="#E5E5E5"> like traditional command and</font>

101
00:04:13,140 --> 00:04:21,570
control is dead<font color="#E5E5E5"> and we're going to talk</font>

102
00:04:15,989 --> 00:04:22,979
<font color="#CCCCCC">about</font><font color="#E5E5E5"> C 3 so kind of backing</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> up a</font>

103
00:04:21,570 --> 00:04:25,500
<font color="#E5E5E5">little bit a lot of the organizations</font>

104
00:04:22,979 --> 00:04:27,150
that<font color="#E5E5E5"> we work with surely five six years</font>

105
00:04:25,500 --> 00:04:28,590
ago weren't that capable

106
00:04:27,150 --> 00:04:30,630
in that time period they've massively

107
00:04:28,590 --> 00:04:34,130
matured<font color="#E5E5E5"> there's loads of stuff you got</font>

108
00:04:30,630 --> 00:04:39,120
<font color="#CCCCCC">ET or I</font><font color="#E5E5E5"> managed</font><font color="#CCCCCC"> DD or next-gen AV</font>

109
00:04:34,130 --> 00:04:41,990
<font color="#E5E5E5">various</font><font color="#CCCCCC"> seam stacks</font><font color="#E5E5E5"> threat hunters so I</font>

110
00:04:39,120 --> 00:04:41,990
don't like threat hunters

111
00:04:42,020 --> 00:04:46,919
some say it's a<font color="#CCCCCC"> buzzword but</font><font color="#E5E5E5"> to be</font>

112
00:04:45,090 --> 00:04:48,630
honest things<font color="#E5E5E5"> got a lot harder</font><font color="#CCCCCC"> in the</font>

113
00:04:46,919 --> 00:04:51,870
offensive community and<font color="#E5E5E5"> doing these</font>

114
00:04:48,630 --> 00:04:53,190
offensive operations when<font color="#E5E5E5"> before you</font>

115
00:04:51,870 --> 00:04:55,290
even started you know that there's a

116
00:04:53,190 --> 00:04:56,790
team inside your target<font color="#E5E5E5"> that already</font>

117
00:04:55,290 --> 00:04:58,260
assumes you've compromised them and he's

118
00:04:56,790 --> 00:05:00,720
<font color="#E5E5E5">already looking for you so there's no</font>

119
00:04:58,260 --> 00:05:04,590
surprise element<font color="#E5E5E5"> anymore and it's been a</font>

120
00:05:00,720 --> 00:05:06,630
tough thing to deal with loads of blue

121
00:05:04,590 --> 00:05:08,609
<font color="#E5E5E5">team socks</font><font color="#CCCCCC"> they're toolings all the</font>

122
00:05:06,630 --> 00:05:09,990
stuff<font color="#E5E5E5"> that underpins their operations</font>

123
00:05:08,610 --> 00:05:11,880
they're just brimming<font color="#CCCCCC"> with all sorts of</font>

124
00:05:09,990 --> 00:05:14,669
cool stuff<font color="#CCCCCC"> and it's no longer the domain</font>

125
00:05:11,880 --> 00:05:18,650
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the red team or the</font><font color="#CCCCCC"> practice</font><font color="#E5E5E5"> malware</font>

126
00:05:14,669 --> 00:05:18,650
<font color="#CCCCCC">writers</font><font color="#E5E5E5"> to have all this cool stuff</font><font color="#CCCCCC"> so</font>

127
00:05:19,460 --> 00:05:24,090
<font color="#CCCCCC">I'm going to focus</font><font color="#E5E5E5"> primarily</font><font color="#CCCCCC"> on command</font>

128
00:05:22,530 --> 00:05:25,400
and<font color="#CCCCCC"> control</font><font color="#E5E5E5"> nothing else in the cyber</font>

129
00:05:24,090 --> 00:05:28,138
kill chain we're not going<font color="#E5E5E5"> to talk about</font>

130
00:05:25,400 --> 00:05:30,270
various<font color="#E5E5E5"> you know fancy new techniques</font>

131
00:05:28,139 --> 00:05:31,320
other than stuff that we can<font color="#E5E5E5"> use to</font>

132
00:05:30,270 --> 00:05:33,719
<font color="#E5E5E5">communicate with our</font><font color="#CCCCCC"> malware and go</font>

133
00:05:31,320 --> 00:05:36,690
undetected<font color="#CCCCCC"> and this comes about</font><font color="#E5E5E5"> because</font>

134
00:05:33,720 --> 00:05:38,220
most<font color="#CCCCCC"> organizations that we target</font><font color="#E5E5E5"> of any</font>

135
00:05:36,690 --> 00:05:40,349
sort<font color="#CCCCCC"> of level of</font><font color="#E5E5E5"> maturity have some kind</font>

136
00:05:38,220 --> 00:05:44,389
of web proxy in place this<font color="#E5E5E5"> filtering</font>

137
00:05:40,349 --> 00:05:49,080
<font color="#CCCCCC">loan bad and letting good through</font><font color="#E5E5E5"> the</font>

138
00:05:44,389 --> 00:05:50,550
<font color="#CCCCCC">guess</font><font color="#E5E5E5"> tagline headline would be most</font>

139
00:05:49,080 --> 00:05:52,680
environments want to allow everyone<font color="#E5E5E5"> to</font>

140
00:05:50,550 --> 00:05:53,940
visit<font color="#E5E5E5"> the websites use cool stuff do</font>

141
00:05:52,680 --> 00:05:55,349
things get<font color="#E5E5E5"> on with their job</font><font color="#CCCCCC"> but they</font>

142
00:05:53,940 --> 00:05:56,789
<font color="#CCCCCC">don't want malware visiting bad sites</font>

143
00:05:55,349 --> 00:05:59,190
that they know of<font color="#E5E5E5"> so there's always this</font>

144
00:05:56,789 --> 00:06:00,719
web proxy in place that's got<font color="#E5E5E5"> some sort</font>

145
00:05:59,190 --> 00:06:02,610
<font color="#CCCCCC">of</font><font color="#E5E5E5"> database of all the known bad</font>

146
00:06:00,720 --> 00:06:04,080
websites<font color="#CCCCCC"> for command and</font><font color="#E5E5E5"> control servers</font>

147
00:06:02,610 --> 00:06:05,910
out<font color="#E5E5E5"> there and supposed to just block</font>

148
00:06:04,080 --> 00:06:07,260
them<font color="#E5E5E5"> and make everything fine then</font><font color="#CCCCCC"> these</font>

149
00:06:05,910 --> 00:06:11,669
various filters they implement like

150
00:06:07,260 --> 00:06:13,229
<font color="#E5E5E5">blocking porn social media allowing just</font>

151
00:06:11,669 --> 00:06:14,520
financial banking services or<font color="#E5E5E5"> whatever</font>

152
00:06:13,229 --> 00:06:21,780
in all these<font color="#CCCCCC"> websites fall into these</font>

153
00:06:14,520 --> 00:06:24,060
<font color="#E5E5E5">categories</font><font color="#CCCCCC"> so how do we</font><font color="#E5E5E5"> get round these</font>

154
00:06:21,780 --> 00:06:26,669
technology stacks<font color="#E5E5E5"> what do we do</font>

155
00:06:24,060 --> 00:06:28,830
so we set ourselves this challenge<font color="#E5E5E5"> which</font>

156
00:06:26,669 --> 00:06:30,180
<font color="#E5E5E5">is basically our tools patterns of</font>

157
00:06:28,830 --> 00:06:33,510
communication<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> use in the things</font>

158
00:06:30,180 --> 00:06:34,530
<font color="#E5E5E5">that we're</font><font color="#CCCCCC"> doing how we're doing it when</font>

159
00:06:33,510 --> 00:06:35,940
we're going<font color="#E5E5E5"> up against a target</font><font color="#CCCCCC"> that</font>

160
00:06:34,530 --> 00:06:37,388
knows their environment well has all

161
00:06:35,940 --> 00:06:40,150
these<font color="#E5E5E5"> shiny tools</font>

162
00:06:37,389 --> 00:06:41,740
they're always going<font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> anomalous</font>

163
00:06:40,150 --> 00:06:43,929
behaviors or<font color="#E5E5E5"> a command control channel</font>

164
00:06:41,740 --> 00:06:45,580
<font color="#E5E5E5">so what do we do about it and</font><font color="#CCCCCC"> that's</font>

165
00:06:43,930 --> 00:06:49,240
<font color="#E5E5E5">what today's talk about is specifically</font>

166
00:06:45,580 --> 00:06:50,620
<font color="#CCCCCC">focused</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> red teams and</font><font color="#E5E5E5"> what we do so</font>

167
00:06:49,240 --> 00:06:55,599
we're gonna take you on a small<font color="#E5E5E5"> journey</font>

168
00:06:50,620 --> 00:06:58,270
of how we got<font color="#E5E5E5"> there because</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> not</font>

169
00:06:55,599 --> 00:07:00,520
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> talk about evading</font><font color="#CCCCCC"> edr or</font>

170
00:06:58,270 --> 00:07:01,659
getting implant<font color="#CCCCCC"> onto bots we can assume</font>

171
00:07:00,520 --> 00:07:04,180
<font color="#E5E5E5">that you've got the implant this</font><font color="#CCCCCC"> is</font>

172
00:07:01,659 --> 00:07:06,129
<font color="#CCCCCC">about the communications there's some</font>

173
00:07:04,180 --> 00:07:08,289
nice tooling from<font color="#CCCCCC"> MD SEC called</font>

174
00:07:06,129 --> 00:07:10,449
<font color="#CCCCCC">sharpshooter</font><font color="#E5E5E5"> and we'll have one coming</font>

175
00:07:08,289 --> 00:07:13,090
<font color="#E5E5E5">out</font><font color="#CCCCCC"> baby we'll release</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> maybe it will</font>

176
00:07:10,449 --> 00:07:14,139
<font color="#CCCCCC">change its name but it's called</font>

177
00:07:13,090 --> 00:07:20,409
inappropriate<font color="#CCCCCC"> touch and it's something</font>

178
00:07:14,139 --> 00:07:22,180
that<font color="#E5E5E5"> we use blue a really good you know</font>

179
00:07:20,409 --> 00:07:23,560
<font color="#E5E5E5">in our experience</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> environments</font>

180
00:07:22,180 --> 00:07:26,530
<font color="#E5E5E5">that we test in and the clients that we</font>

181
00:07:23,560 --> 00:07:28,360
<font color="#CCCCCC">have the blue team has always been</font>

182
00:07:26,530 --> 00:07:29,770
historically<font color="#CCCCCC"> quite good at stop</font><font color="#E5E5E5"> spotting</font>

183
00:07:28,360 --> 00:07:32,729
stuff coming in at the perimeter so the

184
00:07:29,770 --> 00:07:35,169
initial fish or probe or whatever it<font color="#E5E5E5"> is</font>

185
00:07:32,729 --> 00:07:38,169
but<font color="#E5E5E5"> once it's</font><font color="#CCCCCC"> on the endpoint</font><font color="#E5E5E5"> things</font>

186
00:07:35,169 --> 00:07:41,080
change<font color="#E5E5E5"> so the whole armadillo type</font>

187
00:07:38,169 --> 00:07:42,940
situation we found<font color="#E5E5E5"> in a lot</font><font color="#CCCCCC"> of places</font>

188
00:07:41,080 --> 00:07:44,740
<font color="#E5E5E5">that really good this kind of a we've</font>

189
00:07:42,940 --> 00:07:47,409
got<font color="#E5E5E5"> about four</font><font color="#CCCCCC"> hours of operational time</font>

190
00:07:44,740 --> 00:07:49,569
before we're completely evicted<font color="#CCCCCC"> and we</font>

191
00:07:47,409 --> 00:07:51,009
also looked<font color="#E5E5E5"> at the PlayBook that those</font>

192
00:07:49,569 --> 00:07:52,750
incident responders go through the blue

193
00:07:51,009 --> 00:07:54,460
team in that time period<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it was</font>

194
00:07:52,750 --> 00:07:56,050
normally<font color="#E5E5E5"> they go and identify</font><font color="#CCCCCC"> the fish</font>

195
00:07:54,460 --> 00:07:58,090
so either someone's clicked on oh I've

196
00:07:56,050 --> 00:07:59,500
been fished button or makes a phone<font color="#E5E5E5"> call</font>

197
00:07:58,090 --> 00:08:02,198
<font color="#CCCCCC">I did something silly and clicked</font><font color="#E5E5E5"> on a</font>

198
00:07:59,500 --> 00:08:03,520
thing and then the<font color="#CCCCCC"> ir team will</font><font color="#E5E5E5"> start to</font>

199
00:08:02,199 --> 00:08:05,919
look at the<font color="#E5E5E5"> indicators</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> compromise in</font>

200
00:08:03,520 --> 00:08:08,198
<font color="#E5E5E5">there find the initial foothold block</font>

201
00:08:05,919 --> 00:08:09,818
the<font color="#CCCCCC"> CT etc and it all takes</font><font color="#E5E5E5"> about four</font>

202
00:08:08,199 --> 00:08:11,259
hours<font color="#CCCCCC"> technically</font><font color="#E5E5E5"> could probably do it a</font>

203
00:08:09,819 --> 00:08:13,770
lot<font color="#CCCCCC"> quicker but operationally it's</font><font color="#E5E5E5"> about</font>

204
00:08:11,259 --> 00:08:16,840
four hours<font color="#E5E5E5"> so we need to deal with</font><font color="#CCCCCC"> that</font>

205
00:08:13,770 --> 00:08:18,758
<font color="#E5E5E5">we've seen some stuff work an auto alert</font>

206
00:08:16,840 --> 00:08:20,080
<font color="#E5E5E5">on</font><font color="#CCCCCC"> c2</font><font color="#E5E5E5"> channels because the enamels</font>

207
00:08:18,759 --> 00:08:24,250
<font color="#CCCCCC">behave</font><font color="#E5E5E5"> in some of the indicators that</font>

208
00:08:20,080 --> 00:08:25,628
we'll<font color="#E5E5E5"> talk about but it's very prone</font><font color="#CCCCCC"> to</font>

209
00:08:24,250 --> 00:08:26,889
false positives<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you don't to be</font>

210
00:08:25,629 --> 00:08:28,539
shutting<font color="#E5E5E5"> down websites left right and</font>

211
00:08:26,889 --> 00:08:31,000
<font color="#E5E5E5">center and also if we were to use</font>

212
00:08:28,539 --> 00:08:33,250
<font color="#CCCCCC">something like AWS</font><font color="#E5E5E5"> as a c2 and you</font>

213
00:08:31,000 --> 00:08:35,320
automatically<font color="#E5E5E5"> shut</font><font color="#CCCCCC"> down access</font><font color="#E5E5E5"> to AWS</font>

214
00:08:33,250 --> 00:08:36,969
people are<font color="#E5E5E5"> going to scream so it's not</font>

215
00:08:35,320 --> 00:08:42,909
really something<font color="#CCCCCC"> people have</font><font color="#E5E5E5"> got fully</font>

216
00:08:36,969 --> 00:08:45,010
automated just yet<font color="#CCCCCC"> okay so where are we</font>

217
00:08:42,909 --> 00:08:47,350
traditional what we're classifying is

218
00:08:45,010 --> 00:08:49,740
traditional<font color="#E5E5E5"> see - so</font><font color="#CCCCCC"> tool sets most</font>

219
00:08:47,350 --> 00:08:51,490
<font color="#CCCCCC">people are using a cobalt strike empire</font>

220
00:08:49,740 --> 00:08:56,080
<font color="#E5E5E5">Metasploit</font>

221
00:08:51,490 --> 00:08:59,530
traditional channels<font color="#E5E5E5"> or HTTP s and DNS</font>

222
00:08:56,080 --> 00:09:00,970
and over the years these tool sets have

223
00:08:59,530 --> 00:09:02,650
allowed you to slightly start operating

224
00:09:00,970 --> 00:09:04,630
<font color="#E5E5E5">and customizing those in some way</font><font color="#CCCCCC"> shape</font>

225
00:09:02,650 --> 00:09:07,090
or<font color="#CCCCCC"> form and call what strikes coin the</font>

226
00:09:04,630 --> 00:09:13,810
malleable profile and I think<font color="#E5E5E5"> custom</font>

227
00:09:07,090 --> 00:09:17,190
profile<font color="#CCCCCC"> is something in Empire I don't</font>

228
00:09:13,810 --> 00:09:17,189
<font color="#E5E5E5">think these much options in</font><font color="#CCCCCC"> Metasploit</font>

229
00:09:18,330 --> 00:09:21,970
so this is what it kind of<font color="#E5E5E5"> looks like</font>

230
00:09:20,470 --> 00:09:23,560
<font color="#E5E5E5">and this kind of came about and these</font>

231
00:09:21,970 --> 00:09:25,150
<font color="#E5E5E5">aren't mine this is URL somewhere you</font>

232
00:09:23,560 --> 00:09:26,439
can visit<font color="#E5E5E5"> and gone get a full deep dive</font>

233
00:09:25,150 --> 00:09:29,410
<font color="#E5E5E5">into all</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> it allows you to</font>

234
00:09:26,440 --> 00:09:31,570
<font color="#E5E5E5">control various elements of the protocol</font>

235
00:09:29,410 --> 00:09:33,160
<font color="#E5E5E5">either</font><font color="#CCCCCC"> putting your payload</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> your</font>

236
00:09:31,570 --> 00:09:35,680
communications in a post header and get

237
00:09:33,160 --> 00:09:36,910
header changing HTTP file type headers

238
00:09:35,680 --> 00:09:39,069
and just basically<font color="#E5E5E5"> playing around with</font>

239
00:09:36,910 --> 00:09:40,839
it<font color="#CCCCCC"> wherever you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> smugly payload in to</font>

240
00:09:39,070 --> 00:09:43,420
get past any sort of detection routine

241
00:09:40,840 --> 00:09:46,720
but<font color="#E5E5E5"> really it was put together by those</font>

242
00:09:43,420 --> 00:09:48,099
tool offers<font color="#E5E5E5"> to allow you to emulate</font><font color="#CCCCCC"> a</font>

243
00:09:46,720 --> 00:09:49,780
particular<font color="#CCCCCC"> thread</font><font color="#E5E5E5"> just malware</font>

244
00:09:48,100 --> 00:09:53,220
communication channels so that<font color="#CCCCCC"> you could</font>

245
00:09:49,780 --> 00:09:55,329
test your detection algorithms<font color="#E5E5E5"> that way</font>

246
00:09:53,220 --> 00:09:56,740
there's a lot<font color="#E5E5E5"> of functionality</font><font color="#CCCCCC"> you can</font>

247
00:09:55,330 --> 00:09:58,960
play with<font color="#E5E5E5"> and a lot</font><font color="#CCCCCC"> of things you can do</font>

248
00:09:56,740 --> 00:09:59,890
to get past most places<font color="#E5E5E5"> but</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not</font>

249
00:09:58,960 --> 00:10:01,660
always<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> hundred percent</font>

250
00:09:59,890 --> 00:10:07,350
<font color="#CCCCCC">reliable because</font><font color="#E5E5E5"> it's it's still gonna</font>

251
00:10:01,660 --> 00:10:07,350
be<font color="#E5E5E5"> slightly anomalous in some some cases</font>

252
00:10:07,470 --> 00:10:11,200
what are the things<font color="#CCCCCC"> we've been able to</font>

253
00:10:09,580 --> 00:10:13,000
do so a platform<font color="#E5E5E5"> just playing around and</font>

254
00:10:11,200 --> 00:10:14,680
modifying<font color="#E5E5E5"> the traffic so this is kind of</font>

255
00:10:13,000 --> 00:10:16,240
what our<font color="#CCCCCC"> setup looks like I'm sure</font>

256
00:10:14,680 --> 00:10:17,439
<font color="#E5E5E5">people have got similar stuff and</font>

257
00:10:16,240 --> 00:10:19,840
there's loads<font color="#CCCCCC"> of blog posts about how</font><font color="#E5E5E5"> to</font>

258
00:10:17,440 --> 00:10:22,180
set<font color="#E5E5E5"> up a Red Team infrastructure but</font>

259
00:10:19,840 --> 00:10:24,160
this is specifically<font color="#E5E5E5"> to focus on too</font>

260
00:10:22,180 --> 00:10:25,689
much at this<font color="#E5E5E5"> element in the middle</font><font color="#CCCCCC"> but</font>

261
00:10:24,160 --> 00:10:28,510
<font color="#E5E5E5">it's specifically set up</font><font color="#CCCCCC"> to hide</font><font color="#E5E5E5"> our</font>

262
00:10:25,690 --> 00:10:31,570
attribution<font color="#CCCCCC"> so your whole bunch</font><font color="#E5E5E5"> a cloud</font>

263
00:10:28,510 --> 00:10:32,620
redirect<font color="#CCCCCC"> errs to our</font><font color="#E5E5E5"> physical</font>

264
00:10:31,570 --> 00:10:33,010
infrastructure that sits in a data

265
00:10:32,620 --> 00:10:35,500
center

266
00:10:33,010 --> 00:10:36,970
our team can VPN<font color="#CCCCCC"> choose it to a face all</font>

267
00:10:35,500 --> 00:10:38,560
that sort of nice good<font color="#E5E5E5"> secure</font>

268
00:10:36,970 --> 00:10:40,810
architecture is taken<font color="#E5E5E5"> care of so we</font><font color="#CCCCCC"> can</font>

269
00:10:38,560 --> 00:10:42,369
give our clients one fuzzy feeling that

270
00:10:40,810 --> 00:10:44,739
we're taking<font color="#E5E5E5"> care of this</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> but</font>

271
00:10:42,370 --> 00:10:46,150
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> what we do</font><font color="#CCCCCC"> is because</font>

272
00:10:44,740 --> 00:10:48,070
everyone's running<font color="#E5E5E5"> these web proxies we</font>

273
00:10:46,150 --> 00:10:50,770
want to spin up domains<font color="#E5E5E5"> that</font><font color="#CCCCCC"> have good</font>

274
00:10:48,070 --> 00:10:53,080
reputations<font color="#E5E5E5"> we can go and buy those</font>

275
00:10:50,770 --> 00:10:55,750
domains once they expire or auction

276
00:10:53,080 --> 00:10:57,190
<font color="#CCCCCC">they've got a</font><font color="#E5E5E5"> good reputation that means</font>

277
00:10:55,750 --> 00:11:00,100
that they're more<font color="#CCCCCC"> likely to be allowed</font>

278
00:10:57,190 --> 00:11:03,030
in any particular<font color="#CCCCCC"> giving web proxy we</font>

279
00:11:00,100 --> 00:11:05,139
can<font color="#CCCCCC"> also auto like submit those to the</font>

280
00:11:03,030 --> 00:11:06,519
web proxy vendors

281
00:11:05,139 --> 00:11:08,559
who<font color="#CCCCCC"> maintained</font><font color="#E5E5E5"> these databases of</font><font color="#CCCCCC"> what</font>

282
00:11:06,519 --> 00:11:10,989
<font color="#CCCCCC">smell good we spin up a website</font><font color="#E5E5E5"> put</font>

283
00:11:08,559 --> 00:11:12,279
something benign and safe on<font color="#E5E5E5"> there run</font>

284
00:11:10,989 --> 00:11:14,079
it<font color="#E5E5E5"> for a little</font><font color="#CCCCCC"> while build a reputation</font>

285
00:11:12,279 --> 00:11:15,699
<font color="#E5E5E5">get it signed off as good and then when</font>

286
00:11:14,079 --> 00:11:17,679
we use it<font color="#CCCCCC"> in an attack</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> known</font>

287
00:11:15,699 --> 00:11:20,799
bad until someone reports<font color="#CCCCCC"> that there's</font>

288
00:11:17,679 --> 00:11:22,509
no about it we use a lot of<font color="#E5E5E5"> different</font>

289
00:11:20,799 --> 00:11:24,639
<font color="#CCCCCC">DevOps approaches that if something does</font>

290
00:11:22,509 --> 00:11:26,499
<font color="#CCCCCC">get burned we can tear it</font><font color="#E5E5E5"> down</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> spin</font>

291
00:11:24,639 --> 00:11:27,819
new stuff up quite quickly<font color="#E5E5E5"> but also a</font>

292
00:11:26,499 --> 00:11:29,829
whole<font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> of stuff that we</font><font color="#CCCCCC"> sped up</font>

293
00:11:27,819 --> 00:11:31,919
<font color="#E5E5E5">with various web proxies that if we see</font>

294
00:11:29,829 --> 00:11:34,209
the incident<font color="#E5E5E5"> responders start to look at</font>

295
00:11:31,919 --> 00:11:35,290
<font color="#CCCCCC">investigate</font><font color="#E5E5E5"> anything that we're doing we</font>

296
00:11:34,209 --> 00:11:37,268
can just tear that<font color="#E5E5E5"> down it's been</font>

297
00:11:35,290 --> 00:11:39,488
something<font color="#E5E5E5"> else up or we can read out</font><font color="#CCCCCC"> of</font>

298
00:11:37,269 --> 00:11:40,779
them off to something<font color="#E5E5E5"> a different</font>

299
00:11:39,489 --> 00:11:41,949
malware payload with different

300
00:11:40,779 --> 00:11:43,569
indicators are compromised so if they're

301
00:11:41,949 --> 00:11:45,219
going<font color="#E5E5E5"> to extract those</font><font color="#CCCCCC"> RCS and then make</font>

302
00:11:43,569 --> 00:11:47,108
<font color="#CCCCCC">decisions based</font><font color="#E5E5E5"> on those if we give them</font>

303
00:11:45,220 --> 00:11:48,850
false<font color="#CCCCCC"> Flags</font><font color="#E5E5E5"> then we probably got a bit</font>

304
00:11:47,109 --> 00:11:53,139
more<font color="#E5E5E5"> time with</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> real operation</font><font color="#CCCCCC"> and</font>

305
00:11:48,850 --> 00:11:55,329
bits and pieces like<font color="#CCCCCC"> that also</font><font color="#E5E5E5"> getting</font>

306
00:11:53,139 --> 00:11:57,730
financial services websites can<font color="#CCCCCC"> be quite</font>

307
00:11:55,329 --> 00:11:58,748
hard and there's<font color="#CCCCCC"> fair few expert</font><font color="#E5E5E5"> de</font>

308
00:11:57,730 --> 00:12:07,389
<font color="#E5E5E5">Maynes</font><font color="#CCCCCC"> and getting into that country is</font>

309
00:11:58,749 --> 00:12:11,139
quite<font color="#E5E5E5"> useful some other tricks so</font>

310
00:12:07,389 --> 00:12:16,179
sometimes when we've gone up against

311
00:12:11,139 --> 00:12:18,009
certain<font color="#CCCCCC"> guess countries a division</font><font color="#E5E5E5"> of a</font>

312
00:12:16,179 --> 00:12:20,079
<font color="#CCCCCC">bank say operating somewhere</font><font color="#E5E5E5"> like</font>

313
00:12:18,009 --> 00:12:22,029
Germany where they have stricter laws

314
00:12:20,079 --> 00:12:23,559
about<font color="#E5E5E5"> what</font><font color="#CCCCCC"> can be inspected from an SL</font>

315
00:12:22,029 --> 00:12:25,059
perspective as well<font color="#E5E5E5"> so getting a lot of</font>

316
00:12:23,559 --> 00:12:26,769
<font color="#CCCCCC">US health certificates and setting up</font><font color="#E5E5E5"> as</font>

317
00:12:25,059 --> 00:12:27,868
a cell type traffic so<font color="#CCCCCC"> that basically</font>

318
00:12:26,769 --> 00:12:34,720
<font color="#E5E5E5">they're walking man in the middle</font>

319
00:12:27,869 --> 00:12:36,040
<font color="#E5E5E5">investigated other things so I'll</font>

320
00:12:34,720 --> 00:12:38,110
mention two main fronting and<font color="#E5E5E5"> then just</font>

321
00:12:36,040 --> 00:12:39,219
move on because<font color="#CCCCCC"> as far</font><font color="#E5E5E5"> as we're</font>

322
00:12:38,110 --> 00:12:42,519
concerned<font color="#E5E5E5"> it's kind of dead</font>

323
00:12:39,220 --> 00:12:44,470
it's almost<font color="#E5E5E5"> fixed completely it's big in</font>

324
00:12:42,519 --> 00:12:46,419
Asia again still at the<font color="#E5E5E5"> moment but most</font>

325
00:12:44,470 --> 00:12:48,519
places this never<font color="#CCCCCC"> worked</font><font color="#E5E5E5"> it was known</font>

326
00:12:46,419 --> 00:12:50,079
RFC compliant so most<font color="#CCCCCC"> vendors that</font>

327
00:12:48,519 --> 00:12:51,850
implemented their<font color="#CCCCCC"> properties correctly</font>

328
00:12:50,079 --> 00:12:53,559
wouldn't allow it<font color="#CCCCCC"> to pass through anyway</font>

329
00:12:51,850 --> 00:12:55,720
<font color="#E5E5E5">but basically it's about hiding behind</font>

330
00:12:53,559 --> 00:12:57,519
legitimate services and<font color="#E5E5E5"> just changing</font>

331
00:12:55,720 --> 00:12:58,809
headers so that the proxy thinks he's

332
00:12:57,519 --> 00:13:03,189
going to<font color="#E5E5E5"> one place and ends up going to</font>

333
00:12:58,809 --> 00:13:07,269
somewhere else<font color="#CCCCCC"> we send in our payloads</font>

334
00:13:03,189 --> 00:13:10,089
<font color="#CCCCCC">stage list</font><font color="#E5E5E5"> so I for a long time if you</font>

335
00:13:07,269 --> 00:13:12,910
sent in your malware and it pulled down

336
00:13:10,089 --> 00:13:15,819
<font color="#E5E5E5">the stage where the signature was you</font>

337
00:13:12,910 --> 00:13:17,230
know for alpha<font color="#CCCCCC"> choice to a URI it was</font>

338
00:13:15,819 --> 00:13:18,549
exactly<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> modeled in Kabul straight</font>

339
00:13:17,230 --> 00:13:18,830
straight<font color="#CCCCCC"> off</font><font color="#E5E5E5"> Matt's</font><font color="#CCCCCC"> place</font><font color="#E5E5E5"> so everyone</font>

340
00:13:18,549 --> 00:13:19,910
<font color="#E5E5E5">knew</font>

341
00:13:18,830 --> 00:13:23,290
it<font color="#E5E5E5"> looked like and we're gonna pick it</font>

342
00:13:19,910 --> 00:13:25,459
up<font color="#CCCCCC"> straight away and so</font><font color="#E5E5E5"> not staging</font>

343
00:13:23,290 --> 00:13:27,319
customizing<font color="#E5E5E5"> this</font><font color="#CCCCCC"> stake in</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> eye</font><font color="#E5E5E5"> bits</font>

344
00:13:25,460 --> 00:13:29,480
of pieces<font color="#CCCCCC"> that gets</font><font color="#E5E5E5"> us</font><font color="#CCCCCC"> around the</font>

345
00:13:27,320 --> 00:13:31,010
malleable profiles changing it stuff so

346
00:13:29,480 --> 00:13:33,320
we look like legit traffic if we can

347
00:13:31,010 --> 00:13:37,819
modify the headers<font color="#CCCCCC"> to get round bits and</font>

348
00:13:33,320 --> 00:13:40,190
pieces<font color="#CCCCCC"> said</font><font color="#E5E5E5"> check in once you're</font><font color="#CCCCCC"> onto a</font>

349
00:13:37,820 --> 00:13:41,450
box looking at the proxy<font color="#E5E5E5"> Pat</font><font color="#CCCCCC"> file</font><font color="#E5E5E5"> see if</font>

350
00:13:40,190 --> 00:13:42,890
we can figure out where there are other

351
00:13:41,450 --> 00:13:44,690
properties<font color="#CCCCCC"> that perhaps someone isn't</font>

352
00:13:42,890 --> 00:13:47,449
<font color="#E5E5E5">watching and again</font><font color="#CCCCCC"> they're going through</font>

353
00:13:44,690 --> 00:13:49,580
<font color="#CCCCCC">a</font><font color="#E5E5E5"> country were SSL inspection might not</font>

354
00:13:47,450 --> 00:13:53,870
be<font color="#E5E5E5"> taking</font><font color="#CCCCCC"> place finding that proxy going</font>

355
00:13:49,580 --> 00:13:55,190
through there<font color="#E5E5E5"> breaking</font><font color="#CCCCCC"> our communication</font>

356
00:13:53,870 --> 00:13:58,910
channels<font color="#E5E5E5"> down into smaller and</font><font color="#CCCCCC"> smaller</font>

357
00:13:55,190 --> 00:14:00,080
chunks so<font color="#E5E5E5"> we don't trigger DLP sometimes</font>

358
00:13:58,910 --> 00:14:03,469
we've been burnt<font color="#E5E5E5"> because of the DLP</font>

359
00:14:00,080 --> 00:14:05,120
<font color="#E5E5E5">solution</font><font color="#CCCCCC"> and then the most reliable</font><font color="#E5E5E5"> one</font>

360
00:14:03,470 --> 00:14:06,740
was like persist using these<font color="#E5E5E5"> two</font><font color="#CCCCCC"> turret</font>

361
00:14:05,120 --> 00:14:08,600
techniques which<font color="#CCCCCC"> is basically if we</font><font color="#E5E5E5"> know</font>

362
00:14:06,740 --> 00:14:09,950
<font color="#E5E5E5">that the things that</font><font color="#CCCCCC"> we're doing is</font>

363
00:14:08,600 --> 00:14:11,360
gonna<font color="#E5E5E5"> get us burned because it's come</font>

364
00:14:09,950 --> 00:14:13,190
<font color="#CCCCCC">through from a phishing email</font><font color="#E5E5E5"> and</font>

365
00:14:11,360 --> 00:14:15,110
someone's going<font color="#CCCCCC"> to go to that host</font><font color="#E5E5E5"> and</font>

366
00:14:13,190 --> 00:14:16,820
then nuke it<font color="#E5E5E5"> we want to use some kind</font><font color="#CCCCCC"> of</font>

367
00:14:15,110 --> 00:14:20,510
persistence mechanism that would survive

368
00:14:16,820 --> 00:14:22,340
<font color="#CCCCCC">that nuking so if you look</font><font color="#E5E5E5"> like MW or</font>

369
00:14:20,510 --> 00:14:24,410
<font color="#E5E5E5">ellipse or website we've written up</font>

370
00:14:22,340 --> 00:14:26,480
assistance to all<font color="#CCCCCC"> called</font><font color="#E5E5E5"> X rules that</font>

371
00:14:24,410 --> 00:14:28,699
hides itself in the<font color="#E5E5E5"> outlet profile and</font>

372
00:14:26,480 --> 00:14:29,680
then if<font color="#E5E5E5"> anyone watch the</font><font color="#CCCCCC"> Machine the</font>

373
00:14:28,700 --> 00:14:32,030
<font color="#CCCCCC">next time they log</font><font color="#E5E5E5"> into a new machine</font>

374
00:14:29,680 --> 00:14:32,959
<font color="#CCCCCC">the malware comes back and it doesn't</font>

375
00:14:32,030 --> 00:14:34,810
<font color="#E5E5E5">really matter</font><font color="#CCCCCC"> about the</font><font color="#E5E5E5"> command and</font>

376
00:14:32,960 --> 00:14:37,220
<font color="#E5E5E5">control challenge using at</font><font color="#CCCCCC"> that stage</font>

377
00:14:34,810 --> 00:14:39,199
<font color="#E5E5E5">because there's no other pre indicators</font>

378
00:14:37,220 --> 00:14:40,940
<font color="#E5E5E5">to draw their attention to</font><font color="#CCCCCC"> it and</font><font color="#E5E5E5"> we</font>

379
00:14:39,200 --> 00:14:43,940
need to might wait another week<font color="#CCCCCC"> two</font>

380
00:14:40,940 --> 00:14:44,870
months until we fire that<font color="#CCCCCC"> up the problem</font>

381
00:14:43,940 --> 00:14:46,550
with all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these is they're not</font>

382
00:14:44,870 --> 00:14:49,460
reliable<font color="#CCCCCC"> and we've got to</font><font color="#E5E5E5"> think about</font>

383
00:14:46,550 --> 00:14:50,569
every campaign and every breach<font color="#E5E5E5"> which</font>

384
00:14:49,460 --> 00:14:52,760
one's going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> work which one's not</font>

385
00:14:50,570 --> 00:14:56,660
going<font color="#E5E5E5"> to work what combination etc which</font>

386
00:14:52,760 --> 00:14:58,550
isn't really great and<font color="#E5E5E5"> also one of the</font>

387
00:14:56,660 --> 00:15:00,319
downsides<font color="#E5E5E5"> to all of this like</font>

388
00:14:58,550 --> 00:15:02,329
registering multiple<font color="#CCCCCC"> domains spinning</font>

389
00:15:00,320 --> 00:15:04,220
them up<font color="#E5E5E5"> having them nice and clean</font><font color="#CCCCCC"> is</font>

390
00:15:02,330 --> 00:15:06,350
they do stick out like a sore<font color="#CCCCCC"> thumb it</font>

391
00:15:04,220 --> 00:15:09,200
doesn't<font color="#E5E5E5"> matter how clean or what a great</font>

392
00:15:06,350 --> 00:15:11,390
reputation my<font color="#E5E5E5"> website has it's probably</font>

393
00:15:09,200 --> 00:15:13,220
the first time anyone's seen it in the

394
00:15:11,390 --> 00:15:14,689
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> that I'm in it</font><font color="#E5E5E5"> doesn't</font>

395
00:15:13,220 --> 00:15:16,250
matter what it's<font color="#CCCCCC"> called if no one's ever</font>

396
00:15:14,690 --> 00:15:17,240
spoken to<font color="#E5E5E5"> it before it sticks out and</font>

397
00:15:16,250 --> 00:15:19,220
someone's<font color="#E5E5E5"> going to go and have a look at</font>

398
00:15:17,240 --> 00:15:23,270
it<font color="#E5E5E5"> and then start to pull</font><font color="#CCCCCC"> up the thread</font>

399
00:15:19,220 --> 00:15:26,500
<font color="#E5E5E5">so</font><font color="#CCCCCC"> again that's</font><font color="#E5E5E5"> not great and it's still</font>

400
00:15:23,270 --> 00:15:26,500
how a lot of<font color="#E5E5E5"> people operate in</font>

401
00:15:27,799 --> 00:15:33,540
so conclusion of my premise which I said

402
00:15:31,499 --> 00:15:36,779
I'm happy<font color="#E5E5E5"> to be challenged on I still</font>

403
00:15:33,540 --> 00:15:38,809
believe<font color="#E5E5E5"> that if most defenders leverage</font>

404
00:15:36,779 --> 00:15:41,939
all the<font color="#CCCCCC"> tech that's</font><font color="#E5E5E5"> available to them</font>

405
00:15:38,809 --> 00:15:44,249
gather the right telemetry understand

406
00:15:41,939 --> 00:15:46,469
their environment<font color="#CCCCCC"> how these offensive</font>

407
00:15:44,249 --> 00:15:48,629
tools work<font color="#E5E5E5"> how those communication</font>

408
00:15:46,470 --> 00:15:49,799
channels look like<font color="#E5E5E5"> know if something is</font>

409
00:15:48,629 --> 00:15:51,569
<font color="#CCCCCC">a brand new domain all that sort of</font>

410
00:15:49,799 --> 00:15:54,600
stuff<font color="#E5E5E5"> then as far</font><font color="#CCCCCC"> as I'm concerned</font>

411
00:15:51,569 --> 00:15:56,519
<font color="#E5E5E5">detection of c2 is almost a solved</font>

412
00:15:54,600 --> 00:15:58,319
problem<font color="#CCCCCC"> I accept a</font><font color="#E5E5E5"> lot of different blue</font>

413
00:15:56,519 --> 00:15:59,610
<font color="#E5E5E5">teams are in a different place some</font>

414
00:15:58,319 --> 00:16:01,019
don't have<font color="#E5E5E5"> all that</font><font color="#CCCCCC"> money don't have</font><font color="#E5E5E5"> the</font>

415
00:15:59,610 --> 00:16:02,790
shiny boxes<font color="#CCCCCC"> haven't got the people</font><font color="#E5E5E5"> to</font>

416
00:16:01,019 --> 00:16:05,429
roll<font color="#E5E5E5"> around but that doesn't mean that</font>

417
00:16:02,790 --> 00:16:08,759
<font color="#E5E5E5">we now need</font><font color="#CCCCCC"> to invent a new</font><font color="#E5E5E5"> box or a new</font>

418
00:16:05,429 --> 00:16:12,379
tool<font color="#CCCCCC"> to detect I'm pretty much</font><font color="#E5E5E5"> the route</font>

419
00:16:08,759 --> 00:16:16,529
to get in there<font color="#E5E5E5"> it's quite</font><font color="#CCCCCC"> well known</font><font color="#E5E5E5"> so</font>

420
00:16:12,379 --> 00:16:18,389
we want to be able to have<font color="#E5E5E5"> more success</font>

421
00:16:16,529 --> 00:16:21,869
<font color="#E5E5E5">against our clients that we've helped</font>

422
00:16:18,389 --> 00:16:23,279
get to<font color="#E5E5E5"> this stage even</font><font color="#CCCCCC"> if other people</font>

423
00:16:21,869 --> 00:16:24,329
on<font color="#CCCCCC"> that out there aren't</font><font color="#E5E5E5"> quite there yet</font>

424
00:16:23,279 --> 00:16:25,949
<font color="#E5E5E5">and we want to make</font><font color="#CCCCCC"> sure that our</font>

425
00:16:24,329 --> 00:16:28,049
offensive capability is ahead of the

426
00:16:25,949 --> 00:16:32,008
<font color="#E5E5E5">game as well so this</font><font color="#CCCCCC"> is how we change</font>

427
00:16:28,049 --> 00:16:34,350
the<font color="#CCCCCC"> game and how we went</font><font color="#E5E5E5"> about it you</font>

428
00:16:32,009 --> 00:16:38,549
will<font color="#E5E5E5"> do part two of the journey of</font>

429
00:16:34,350 --> 00:16:40,499
course<font color="#CCCCCC"> so</font><font color="#E5E5E5"> the part two of this talk will</font>

430
00:16:38,549 --> 00:16:41,910
be<font color="#E5E5E5"> predominantly focusing on kind of</font>

431
00:16:40,499 --> 00:16:43,169
some<font color="#E5E5E5"> of these sort of lingering issues</font>

432
00:16:41,910 --> 00:16:46,169
<font color="#E5E5E5">around running command and control</font>

433
00:16:43,169 --> 00:16:50,249
channels that<font color="#E5E5E5"> dave</font><font color="#CCCCCC"> has mentioned in</font>

434
00:16:46,169 --> 00:16:51,869
<font color="#E5E5E5">particular</font><font color="#CCCCCC"> the tooling that</font><font color="#E5E5E5"> we've tried</font>

435
00:16:50,249 --> 00:16:55,429
<font color="#CCCCCC">to</font><font color="#E5E5E5"> develop or have developed</font><font color="#CCCCCC"> for</font>

436
00:16:51,869 --> 00:16:58,079
ourselves<font color="#CCCCCC"> to try</font><font color="#E5E5E5"> and solve the problem</font>

437
00:16:55,429 --> 00:17:00,540
and and and so<font color="#E5E5E5"> on</font>

438
00:16:58,079 --> 00:17:02,849
like all attempts<font color="#CCCCCC"> at making great</font>

439
00:17:00,540 --> 00:17:04,740
innovations however we found<font color="#E5E5E5"> that other</font>

440
00:17:02,850 --> 00:17:07,589
people have<font color="#E5E5E5"> been</font><font color="#CCCCCC"> doing something similar</font>

441
00:17:04,740 --> 00:17:10,199
<font color="#E5E5E5">or have got there before</font><font color="#CCCCCC"> us whether</font>

442
00:17:07,589 --> 00:17:12,418
<font color="#E5E5E5">that's in the security community</font><font color="#CCCCCC"> the</font>

443
00:17:10,199 --> 00:17:16,199
wider industry<font color="#E5E5E5"> but</font><font color="#CCCCCC"> especially the bad</font>

444
00:17:12,419 --> 00:17:19,079
guys themselves so there's lots of

445
00:17:16,199 --> 00:17:21,480
threat intelligence<font color="#E5E5E5"> reports of you know</font>

446
00:17:19,079 --> 00:17:23,869
apt groups<font color="#CCCCCC"> threat actors whatever you</font>

447
00:17:21,480 --> 00:17:27,329
want to call them doing<font color="#E5E5E5"> interesting</font>

448
00:17:23,869 --> 00:17:29,129
<font color="#E5E5E5">esoteric see two things</font><font color="#CCCCCC"> the Toller</font>

449
00:17:27,329 --> 00:17:31,678
apt group is a really good example<font color="#CCCCCC"> of</font>

450
00:17:29,130 --> 00:17:33,539
that<font color="#CCCCCC"> very</font><font color="#E5E5E5"> recent very topical they were</font>

451
00:17:31,679 --> 00:17:36,720
<font color="#E5E5E5">leveraging</font><font color="#CCCCCC"> mappy to sort</font><font color="#E5E5E5"> of interact</font>

452
00:17:33,539 --> 00:17:39,790
with<font color="#E5E5E5"> Outlook and spend send and receive</font>

453
00:17:36,720 --> 00:17:42,700
<font color="#E5E5E5">emails with specially formatted PDFs the</font>

454
00:17:39,790 --> 00:17:45,370
<font color="#CCCCCC">carried there kind of see too</font><font color="#E5E5E5"> kind of</font>

455
00:17:42,700 --> 00:17:46,810
payload if you will so lots of

456
00:17:45,370 --> 00:17:49,030
<font color="#E5E5E5">interesting things</font><font color="#CCCCCC"> are sort of going</font><font color="#E5E5E5"> on</font>

457
00:17:46,810 --> 00:17:52,899
by kind<font color="#E5E5E5"> of these sort of groups out</font>

458
00:17:49,030 --> 00:17:54,610
<font color="#CCCCCC">there but when it comes to the security</font>

459
00:17:52,900 --> 00:17:57,220
community ourselves and when we're doing

460
00:17:54,610 --> 00:17:59,590
attack simulations<font color="#E5E5E5"> what tooling is there</font>

461
00:17:57,220 --> 00:18:02,650
<font color="#E5E5E5">available for us to kind of mimic these</font>

462
00:17:59,590 --> 00:18:05,350
activities and<font color="#CCCCCC"> the answer is there's</font>

463
00:18:02,650 --> 00:18:07,480
some tooling out there<font color="#E5E5E5"> for doing kind of</font>

464
00:18:05,350 --> 00:18:10,719
interesting<font color="#CCCCCC"> situ</font><font color="#E5E5E5"> channels through things</font>

465
00:18:07,480 --> 00:18:12,070
<font color="#CCCCCC">like social media emails or whatever</font><font color="#E5E5E5"> but</font>

466
00:18:10,720 --> 00:18:13,570
<font color="#E5E5E5">the problem with a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this kind</font><font color="#CCCCCC"> of</font>

467
00:18:12,070 --> 00:18:15,550
tooling<font color="#CCCCCC"> that people have developed</font><font color="#E5E5E5"> and</font>

468
00:18:13,570 --> 00:18:18,220
<font color="#E5E5E5">put out there is that</font><font color="#CCCCCC"> it's not backwards</font>

469
00:18:15,550 --> 00:18:20,470
<font color="#CCCCCC">compatible with the</font><font color="#E5E5E5"> toolkits that</font><font color="#CCCCCC"> we</font>

470
00:18:18,220 --> 00:18:22,300
kind of<font color="#E5E5E5"> know and love and like to use as</font>

471
00:18:20,470 --> 00:18:24,670
<font color="#E5E5E5">part of these attack simulations so</font>

472
00:18:22,300 --> 00:18:27,250
things like cobalt strike or<font color="#E5E5E5"> Empire or</font>

473
00:18:24,670 --> 00:18:29,530
whatever<font color="#E5E5E5"> these kind of proof of concepts</font>

474
00:18:27,250 --> 00:18:31,270
stand alone<font color="#E5E5E5"> the result of this is that</font>

475
00:18:29,530 --> 00:18:33,430
there's<font color="#CCCCCC"> kind of additional development</font>

476
00:18:31,270 --> 00:18:34,960
work for<font color="#CCCCCC"> everyone involved</font><font color="#E5E5E5"> if they want</font>

477
00:18:33,430 --> 00:18:41,710
<font color="#E5E5E5">to do something a</font><font color="#CCCCCC"> little bit more</font><font color="#E5E5E5"> than</font>

478
00:18:34,960 --> 00:18:46,750
than what is<font color="#E5E5E5"> standard so one potential</font>

479
00:18:41,710 --> 00:18:48,880
solution<font color="#E5E5E5"> to this came in 2017 in form in</font>

480
00:18:46,750 --> 00:18:51,310
the form<font color="#CCCCCC"> of the external situ interface</font>

481
00:18:48,880 --> 00:18:54,430
that<font color="#CCCCCC"> Raphael merge</font><font color="#E5E5E5"> introduced into</font>

482
00:18:51,310 --> 00:18:57,310
cobalt strike and effectively<font color="#CCCCCC"> what</font><font color="#E5E5E5"> this</font>

483
00:18:54,430 --> 00:19:00,760
allows you to<font color="#CCCCCC"> do is</font><font color="#E5E5E5"> man in the middle</font>

484
00:18:57,310 --> 00:19:03,820
cobalt strike traffic the way that this

485
00:19:00,760 --> 00:19:05,980
works is you kind of<font color="#E5E5E5"> introduce some sort</font>

486
00:19:03,820 --> 00:19:08,230
of intermediary<font color="#CCCCCC"> come-up components to</font>

487
00:19:05,980 --> 00:19:10,060
cobalt strike communication so in the

488
00:19:08,230 --> 00:19:12,690
initial<font color="#E5E5E5"> proof of concept that</font><font color="#CCCCCC"> referral</font>

489
00:19:10,060 --> 00:19:15,790
<font color="#CCCCCC">merge released there was kind</font><font color="#E5E5E5"> of a</font>

490
00:19:12,690 --> 00:19:17,740
client executable that<font color="#CCCCCC"> interacted with</font>

491
00:19:15,790 --> 00:19:20,350
cobalt strikes<font color="#E5E5E5"> implant which</font><font color="#CCCCCC"> is called</font>

492
00:19:17,740 --> 00:19:22,210
beacon<font color="#E5E5E5"> over</font><font color="#CCCCCC"> a named pipe so it</font><font color="#E5E5E5"> would</font>

493
00:19:20,350 --> 00:19:24,159
receive kind of a blob of data<font color="#CCCCCC"> over that</font>

494
00:19:22,210 --> 00:19:25,810
named<font color="#CCCCCC"> pipe which you would then</font><font color="#E5E5E5"> forward</font>

495
00:19:24,160 --> 00:19:28,330
over a socket<font color="#CCCCCC"> just some kind of</font>

496
00:19:25,810 --> 00:19:30,370
<font color="#CCCCCC">server-side</font><font color="#E5E5E5"> infrastructure server-side</font>

497
00:19:28,330 --> 00:19:33,699
executable before it would<font color="#E5E5E5"> be passed on</font>

498
00:19:30,370 --> 00:19:35,500
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the cobalt strike team server</font><font color="#CCCCCC"> but</font>

499
00:19:33,700 --> 00:19:37,030
conceptually<font color="#CCCCCC"> you know it's kind of</font>

500
00:19:35,500 --> 00:19:39,730
receiving<font color="#CCCCCC"> this blob you could do</font>

501
00:19:37,030 --> 00:19:41,200
<font color="#CCCCCC">anything</font><font color="#E5E5E5"> with it</font><font color="#CCCCCC"> and kind of</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> kind</font>

502
00:19:39,730 --> 00:19:44,290
of the sort of<font color="#E5E5E5"> general idea behind</font>

503
00:19:41,200 --> 00:19:46,360
external<font color="#E5E5E5"> situ man-in-the-middle in the</font>

504
00:19:44,290 --> 00:19:48,129
traffic<font color="#E5E5E5"> and then through this special</font>

505
00:19:46,360 --> 00:19:49,330
<font color="#E5E5E5">interface on the team server you can</font>

506
00:19:48,130 --> 00:19:50,150
kind of<font color="#E5E5E5"> pass that in and it would be</font>

507
00:19:49,330 --> 00:19:52,340
sort<font color="#CCCCCC"> of except</font>

508
00:19:50,150 --> 00:19:56,810
did<font color="#E5E5E5"> it's kind of like a blob of</font>

509
00:19:52,340 --> 00:19:59,270
information now there are a<font color="#E5E5E5"> few people</font>

510
00:19:56,810 --> 00:20:01,159
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> kind of a couple</font><font color="#CCCCCC"> of examples of</font>

511
00:19:59,270 --> 00:20:03,500
people<font color="#CCCCCC"> who have</font><font color="#E5E5E5"> developed external situ</font>

512
00:20:01,160 --> 00:20:06,350
implementations<font color="#E5E5E5"> and they're in the</font>

513
00:20:03,500 --> 00:20:07,460
<font color="#E5E5E5">public domain</font><font color="#CCCCCC"> and they're very</font><font color="#E5E5E5"> good for</font>

514
00:20:06,350 --> 00:20:09,830
us<font color="#CCCCCC"> however they had a couple of</font>

515
00:20:07,460 --> 00:20:14,240
<font color="#E5E5E5">limitations</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> that made them not</font>

516
00:20:09,830 --> 00:20:16,040
suitable for<font color="#E5E5E5"> use so the first one being</font>

517
00:20:14,240 --> 00:20:19,400
<font color="#CCCCCC">that they weren't</font><font color="#E5E5E5"> as extensible as we</font>

518
00:20:16,040 --> 00:20:21,620
would<font color="#E5E5E5"> like them to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> or if they kind of</font>

519
00:20:19,400 --> 00:20:23,390
where they were extensible<font color="#CCCCCC"> they were</font>

520
00:20:21,620 --> 00:20:25,969
written in<font color="#E5E5E5"> like languages like</font><font color="#CCCCCC"> Python</font>

521
00:20:23,390 --> 00:20:27,950
<font color="#E5E5E5">which while it kind</font><font color="#CCCCCC"> of makes it easier</font>

522
00:20:25,970 --> 00:20:30,080
to rapidly<font color="#E5E5E5"> prototype things it's kind of</font>

523
00:20:27,950 --> 00:20:31,640
not ideal from<font color="#E5E5E5"> a avoiding detection</font>

524
00:20:30,080 --> 00:20:35,689
perspective there's much more<font color="#E5E5E5"> kind of</font>

525
00:20:31,640 --> 00:20:38,150
indicators for identifying<font color="#E5E5E5"> kind of dll's</font>

526
00:20:35,690 --> 00:20:39,620
compiled<font color="#E5E5E5"> you know that a kind of Python</font>

527
00:20:38,150 --> 00:20:44,270
<font color="#E5E5E5">on the back end really</font>

528
00:20:39,620 --> 00:20:48,110
so we developed our<font color="#E5E5E5"> own</font><font color="#CCCCCC"> which we've</font>

529
00:20:44,270 --> 00:20:50,480
<font color="#E5E5E5">called not C 2 but C 3 custom command</font>

530
00:20:48,110 --> 00:20:53,510
and control when developing<font color="#E5E5E5"> this we had</font>

531
00:20:50,480 --> 00:20:56,000
three key design requirements in mind<font color="#E5E5E5"> we</font>

532
00:20:53,510 --> 00:20:59,930
wanted<font color="#E5E5E5"> to enable rapid prototyping of</font>

533
00:20:56,000 --> 00:21:02,960
any kind<font color="#CCCCCC"> of new</font><font color="#E5E5E5"> C</font><font color="#CCCCCC"> 2 mechanisms so the</font>

534
00:20:59,930 --> 00:21:04,310
implants for C 3 are written in C++<font color="#E5E5E5"> not</font>

535
00:21:02,960 --> 00:21:07,190
the<font color="#E5E5E5"> easiest language to rapidly</font>

536
00:21:04,310 --> 00:21:09,169
prototype in but the idea was basically

537
00:21:07,190 --> 00:21:11,390
we wanted<font color="#E5E5E5"> to sort of create a situation</font>

538
00:21:09,170 --> 00:21:13,940
<font color="#E5E5E5">where</font><font color="#CCCCCC"> if you wanted</font><font color="#E5E5E5"> to add new C</font><font color="#CCCCCC"> 2</font>

539
00:21:11,390 --> 00:21:16,000
mechanisms<font color="#CCCCCC"> to the framework there was</font>

540
00:21:13,940 --> 00:21:18,080
only<font color="#E5E5E5"> a sort of a limited</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> of</font>

541
00:21:16,000 --> 00:21:19,460
methods<font color="#CCCCCC"> that you would need to</font><font color="#E5E5E5"> implement</font>

542
00:21:18,080 --> 00:21:23,030
<font color="#E5E5E5">and kind of everything</font><font color="#CCCCCC"> else was</font>

543
00:21:19,460 --> 00:21:24,440
abstracted away<font color="#E5E5E5"> another thing was we</font>

544
00:21:23,030 --> 00:21:25,820
wanted<font color="#E5E5E5"> to</font><font color="#CCCCCC"> ensure that if we were</font><font color="#E5E5E5"> doing</font>

545
00:21:24,440 --> 00:21:28,670
<font color="#E5E5E5">something new</font><font color="#CCCCCC"> and kind of we were</font>

546
00:21:25,820 --> 00:21:29,899
running kind<font color="#E5E5E5"> of these sort</font><font color="#CCCCCC"> of new C 2</font>

547
00:21:28,670 --> 00:21:32,390
channels and we had a framework<font color="#E5E5E5"> for</font>

548
00:21:29,900 --> 00:21:34,760
<font color="#CCCCCC">doing this that when</font><font color="#E5E5E5"> we had an implant</font>

549
00:21:32,390 --> 00:21:37,100
<font color="#E5E5E5">we could kind of dynamically switch out</font>

550
00:21:34,760 --> 00:21:39,770
between the the C<font color="#CCCCCC"> 2 mechanisms that</font>

551
00:21:37,100 --> 00:21:42,469
we're using so we're kind of<font color="#E5E5E5"> just not</font>

552
00:21:39,770 --> 00:21:44,750
constantly pummeling kind of one kind<font color="#CCCCCC"> of</font>

553
00:21:42,470 --> 00:21:47,780
resource<font color="#E5E5E5"> that would have pivoting</font>

554
00:21:44,750 --> 00:21:49,430
traffic through in addition to that we

555
00:21:47,780 --> 00:21:51,139
wanted<font color="#E5E5E5"> to allow chaining so that's kind</font>

556
00:21:49,430 --> 00:21:53,090
of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> fundamental requirement I think of</font>

557
00:21:51,140 --> 00:21:55,730
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of implants these days that you</font>

558
00:21:53,090 --> 00:21:57,169
<font color="#E5E5E5">know you can chain and pivot multiple</font>

559
00:21:55,730 --> 00:22:00,340
kind of implants<font color="#E5E5E5"> together</font><font color="#CCCCCC"> if you're</font>

560
00:21:57,170 --> 00:22:00,340
<font color="#E5E5E5">doing things like internal</font><font color="#CCCCCC"> natural</font>

561
00:22:00,950 --> 00:22:05,810
so<font color="#E5E5E5"> I should mention as well and Dave</font>

562
00:22:03,740 --> 00:22:08,780
mentioned it earlier the<font color="#E5E5E5"> idea was</font><font color="#CCCCCC"> to</font>

563
00:22:05,810 --> 00:22:11,780
release<font color="#CCCCCC"> c3 at blue hat unfortunately as</font>

564
00:22:08,780 --> 00:22:13,730
<font color="#E5E5E5">Dave said my code is pretty rubbish</font><font color="#CCCCCC"> and</font>

565
00:22:11,780 --> 00:22:15,410
<font color="#E5E5E5">it's taking a little bit</font><font color="#CCCCCC"> longer to get</font>

566
00:22:13,730 --> 00:22:17,360
it ready<font color="#E5E5E5"> for public release but as sort</font>

567
00:22:15,410 --> 00:22:20,120
of a<font color="#CCCCCC"> public commitment</font><font color="#E5E5E5"> I think within</font>

568
00:22:17,360 --> 00:22:27,729
<font color="#E5E5E5">kind of four weeks it will</font><font color="#CCCCCC"> be out there</font>

569
00:22:20,120 --> 00:22:31,370
<font color="#E5E5E5">maximum six but</font><font color="#CCCCCC"> to maybe this afternoon</font>

570
00:22:27,730 --> 00:22:33,170
<font color="#CCCCCC">but in - to do a sort of sort of an</font>

571
00:22:31,370 --> 00:22:35,750
introduction<font color="#CCCCCC"> to c3</font><font color="#E5E5E5"> and what it's all</font>

572
00:22:33,170 --> 00:22:38,320
about when it does get released<font color="#CCCCCC"> implants</font>

573
00:22:35,750 --> 00:22:40,730
within c3<font color="#CCCCCC"> are called what we call relays</font>

574
00:22:38,320 --> 00:22:42,740
<font color="#CCCCCC">the idea being that there's two basic</font>

575
00:22:40,730 --> 00:22:44,470
types there's client-side relays the

576
00:22:42,740 --> 00:22:47,480
ones that you run<font color="#E5E5E5"> on a compromised host</font>

577
00:22:44,470 --> 00:22:49,490
<font color="#E5E5E5">and then the server-side relays you sort</font>

578
00:22:47,480 --> 00:22:50,660
of run<font color="#CCCCCC"> on</font><font color="#E5E5E5"> your infrastructure you</font>

579
00:22:49,490 --> 00:22:52,670
generally you would have kind<font color="#E5E5E5"> of one</font>

580
00:22:50,660 --> 00:22:54,710
<font color="#E5E5E5">server-side relay and then many client</font>

581
00:22:52,670 --> 00:22:57,070
relays<font color="#CCCCCC"> all of which</font><font color="#E5E5E5"> can be chained</font>

582
00:22:54,710 --> 00:23:00,440
together potentially client-side relays

583
00:22:57,070 --> 00:23:02,720
are basically implants that<font color="#CCCCCC"> can</font>

584
00:23:00,440 --> 00:23:06,200
communicate<font color="#E5E5E5"> through some</font><font color="#CCCCCC"> mechanism to</font><font color="#E5E5E5"> an</font>

585
00:23:02,720 --> 00:23:08,030
implant<font color="#E5E5E5"> from another toolkit</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> for</font>

586
00:23:06,200 --> 00:23:11,810
<font color="#E5E5E5">example something that could interact</font>

587
00:23:08,030 --> 00:23:13,370
and speak<font color="#E5E5E5"> to</font><font color="#CCCCCC"> COBOL strikes beacon but</font>

588
00:23:11,810 --> 00:23:16,399
<font color="#E5E5E5">then the one on the</font><font color="#CCCCCC"> server-side</font><font color="#E5E5E5"> would be</font>

589
00:23:13,370 --> 00:23:18,709
sort of collating data from this kind<font color="#E5E5E5"> of</font>

590
00:23:16,400 --> 00:23:20,120
<font color="#E5E5E5">network of nodes and then kind</font><font color="#CCCCCC"> of</font>

591
00:23:18,710 --> 00:23:22,250
passing that on to some form<font color="#E5E5E5"> of</font>

592
00:23:20,120 --> 00:23:26,899
listening<font color="#E5E5E5"> post such as the cobalt strike</font>

593
00:23:22,250 --> 00:23:28,520
team server extensibility<font color="#CCCCCC"> is kind</font><font color="#E5E5E5"> of the</font>

594
00:23:26,900 --> 00:23:30,320
key thing that<font color="#E5E5E5"> we wanted to implement</font>

595
00:23:28,520 --> 00:23:33,020
<font color="#CCCCCC">within c3 and the way that you do that</font>

596
00:23:30,320 --> 00:23:35,689
is through interfaces or that's what

597
00:23:33,020 --> 00:23:38,270
we're<font color="#CCCCCC"> calling them</font><font color="#E5E5E5"> so the idea being</font>

598
00:23:35,690 --> 00:23:40,970
<font color="#E5E5E5">that you attach interfaces many</font><font color="#CCCCCC"> warned</font>

599
00:23:38,270 --> 00:23:42,650
<font color="#CCCCCC">or many to a particular relay you</font>

600
00:23:40,970 --> 00:23:45,250
receive on an interface you send on an

601
00:23:42,650 --> 00:23:47,360
interface<font color="#E5E5E5"> a relay relays traffic</font>

602
00:23:45,250 --> 00:23:51,140
<font color="#E5E5E5">conceptually</font><font color="#CCCCCC"> there's two types</font>

603
00:23:47,360 --> 00:23:52,879
so there's implant interfaces which are

604
00:23:51,140 --> 00:23:55,190
kind of<font color="#E5E5E5"> interfaces that</font><font color="#CCCCCC"> you would use to</font>

605
00:23:52,880 --> 00:23:57,590
interact<font color="#CCCCCC"> with</font><font color="#E5E5E5"> another toolkit so an</font>

606
00:23:55,190 --> 00:24:00,350
example would be you<font color="#E5E5E5"> read and write</font><font color="#CCCCCC"> to a</font>

607
00:23:57,590 --> 00:24:02,959
named<font color="#E5E5E5"> PI to interact with beacon or</font>

608
00:24:00,350 --> 00:24:06,590
there's<font color="#E5E5E5"> channel interfaces which would</font>

609
00:24:02,960 --> 00:24:08,030
be more for relay to relay communication

610
00:24:06,590 --> 00:24:10,159
and<font color="#E5E5E5"> they're sort of traditionally what</font>

611
00:24:08,030 --> 00:24:11,720
you<font color="#E5E5E5"> would associate with C - so you're</font>

612
00:24:10,160 --> 00:24:15,409
sending a blob of data Rover hitched

613
00:24:11,720 --> 00:24:17,990
<font color="#CCCCCC">TP or</font><font color="#E5E5E5"> something like that</font><font color="#CCCCCC"> now as I said</font>

614
00:24:15,409 --> 00:24:20,630
this is<font color="#CCCCCC"> where</font><font color="#E5E5E5"> kind of c3 is kind of</font>

615
00:24:17,990 --> 00:24:24,710
extensible so if you want to support<font color="#E5E5E5"> a</font>

616
00:24:20,630 --> 00:24:26,630
another<font color="#CCCCCC"> toolkit you just implement</font><font color="#E5E5E5"> an</font>

617
00:24:24,710 --> 00:24:28,909
interface<font color="#E5E5E5"> for that toolkit if you want</font>

618
00:24:26,630 --> 00:24:31,309
to<font color="#CCCCCC"> implement a new c2 mechanism and have</font>

619
00:24:28,909 --> 00:24:33,590
that work with c3<font color="#E5E5E5"> you just implement a</font>

620
00:24:31,309 --> 00:24:35,600
<font color="#E5E5E5">particular channel interface for doing</font>

621
00:24:33,590 --> 00:24:40,459
<font color="#E5E5E5">that and everything</font><font color="#CCCCCC"> else is kind of</font>

622
00:24:35,600 --> 00:24:41,840
<font color="#E5E5E5">abstracted away and I should have</font>

623
00:24:40,460 --> 00:24:43,370
<font color="#E5E5E5">mentioned as well so we know in terms</font><font color="#CCCCCC"> of</font>

624
00:24:41,840 --> 00:24:45,320
doing that implementation<font color="#E5E5E5"> there's three</font>

625
00:24:43,370 --> 00:24:47,418
basic<font color="#E5E5E5"> methods that you would use</font><font color="#CCCCCC"> for</font>

626
00:24:45,320 --> 00:24:49,370
doing<font color="#E5E5E5"> that</font><font color="#CCCCCC"> that would be like how you</font>

627
00:24:47,419 --> 00:24:50,929
send data how<font color="#E5E5E5"> you receive data and</font>

628
00:24:49,370 --> 00:24:54,168
<font color="#E5E5E5">another one which is kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> how you</font>

629
00:24:50,929 --> 00:24:55,720
<font color="#E5E5E5">would identify yourself</font><font color="#CCCCCC"> so that's really</font>

630
00:24:54,169 --> 00:24:58,610
<font color="#E5E5E5">just kind of a couple</font><font color="#CCCCCC"> of lines</font><font color="#E5E5E5"> of code</font>

631
00:24:55,720 --> 00:25:00,260
<font color="#CCCCCC">to give you a kind of a feeling</font><font color="#E5E5E5"> of some</font>

632
00:24:58,610 --> 00:25:02,000
of the interfaces<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we've implemented</font>

633
00:25:00,260 --> 00:25:03,710
<font color="#E5E5E5">for ourselves</font>

634
00:25:02,000 --> 00:25:08,059
and some of<font color="#E5E5E5"> which we may release some</font>

635
00:25:03,710 --> 00:25:10,909
may not<font color="#CCCCCC"> but just to give</font><font color="#E5E5E5"> you sort of a</font>

636
00:25:08,059 --> 00:25:13,090
feeling<font color="#E5E5E5"> of what's possible from the very</font>

637
00:25:10,909 --> 00:25:14,780
beginning there<font color="#CCCCCC"> are two basic in</font>

638
00:25:13,090 --> 00:25:16,360
interfaces which are absolutely

639
00:25:14,780 --> 00:25:18,710
essential to<font color="#E5E5E5"> making everything else work</font>

640
00:25:16,360 --> 00:25:22,129
and those implant interfaces for

641
00:25:18,710 --> 00:25:24,380
interacting with cobalt strike<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of</font>

642
00:25:22,130 --> 00:25:26,630
<font color="#CCCCCC">the</font><font color="#E5E5E5"> ecosystem of</font><font color="#CCCCCC"> coops right so think of</font>

643
00:25:24,380 --> 00:25:28,309
this<font color="#CCCCCC"> as kind</font><font color="#E5E5E5"> of one that you would run</font>

644
00:25:26,630 --> 00:25:31,190
<font color="#E5E5E5">on the client</font><font color="#CCCCCC"> side which will be</font>

645
00:25:28,309 --> 00:25:33,139
receiving data from<font color="#E5E5E5"> beacon so ingress</font>

646
00:25:31,190 --> 00:25:36,110
into<font color="#CCCCCC"> like the c3</font><font color="#E5E5E5"> network if you will and</font>

647
00:25:33,140 --> 00:25:37,880
then one that<font color="#E5E5E5"> passes it from a server</font>

648
00:25:36,110 --> 00:25:40,030
relay to the cobalt<font color="#CCCCCC"> strike team server</font>

649
00:25:37,880 --> 00:25:44,049
so when it's egressing from the network

650
00:25:40,030 --> 00:25:47,120
within<font color="#E5E5E5"> c3 we can handle stage</font><font color="#CCCCCC"> Alice</font>

651
00:25:44,049 --> 00:25:48,889
<font color="#E5E5E5">implants which is kind</font><font color="#CCCCCC"> of not natively</font>

652
00:25:47,120 --> 00:25:50,750
part of the<font color="#E5E5E5"> external in situ interface</font>

653
00:25:48,890 --> 00:25:52,340
within Cobalt strike it's kind of a bit

654
00:25:50,750 --> 00:25:55,309
<font color="#CCCCCC">of a</font><font color="#E5E5E5"> bodge solution because of that but</font>

655
00:25:52,340 --> 00:25:57,620
<font color="#CCCCCC">it does work and another</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that I</font>

656
00:25:55,309 --> 00:25:59,840
would<font color="#E5E5E5"> mention is that for now we do only</font>

657
00:25:57,620 --> 00:26:01,489
<font color="#E5E5E5">have these interfaces for kind of</font>

658
00:25:59,840 --> 00:26:03,590
<font color="#E5E5E5">interacting</font><font color="#CCCCCC"> with cobalt strike but</font>

659
00:26:01,490 --> 00:26:05,600
there's no reason why this couldn't be

660
00:26:03,590 --> 00:26:08,449
very easily ported to kind<font color="#E5E5E5"> of other</font>

661
00:26:05,600 --> 00:26:10,969
<font color="#E5E5E5">toolkits so</font><font color="#CCCCCC"> Metasploit for example you</font>

662
00:26:08,450 --> 00:26:12,049
know has kind of already<font color="#E5E5E5"> got implants</font>

663
00:26:10,970 --> 00:26:16,880
<font color="#E5E5E5">that you can generate that</font><font color="#CCCCCC"> username</font>

664
00:26:12,049 --> 00:26:21,200
<font color="#E5E5E5">pipes for communication</font><font color="#CCCCCC"> in terms of kind</font>

665
00:26:16,880 --> 00:26:23,809
<font color="#E5E5E5">of relay to relay channel interfaces one</font>

666
00:26:21,200 --> 00:26:25,070
<font color="#E5E5E5">that we have is for doing</font><font color="#CCCCCC"> c2 via</font>

667
00:26:23,809 --> 00:26:27,830
<font color="#CCCCCC">onedrive</font>

668
00:26:25,070 --> 00:26:30,169
which is<font color="#E5E5E5"> obviously using files as a sort</font>

669
00:26:27,830 --> 00:26:32,300
of a<font color="#CCCCCC"> medium for communication</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> lets</font>

670
00:26:30,170 --> 00:26:35,860
us push traffic through some quite

671
00:26:32,300 --> 00:26:40,419
reputable<font color="#CCCCCC"> microsoft domains for this</font>

672
00:26:35,860 --> 00:26:44,300
communication<font color="#E5E5E5"> it leverages the graph API</font>

673
00:26:40,420 --> 00:26:45,440
<font color="#CCCCCC">another one is the kind</font><font color="#E5E5E5"> of tasks with in</font>

674
00:26:44,300 --> 00:26:47,379
<font color="#E5E5E5">Outlook so</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of things that</font>

675
00:26:45,440 --> 00:26:51,500
<font color="#CCCCCC">you would</font><font color="#E5E5E5"> use for</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> your to-do list</font>

676
00:26:47,380 --> 00:26:53,540
<font color="#CCCCCC">again</font><font color="#E5E5E5"> we can do that</font><font color="#CCCCCC"> through 365 this</font>

677
00:26:51,500 --> 00:26:56,630
time we're<font color="#CCCCCC"> not using the graph API we're</font>

678
00:26:53,540 --> 00:26:59,840
using the legacy REST API<font color="#E5E5E5"> which provides</font>

679
00:26:56,630 --> 00:27:04,910
<font color="#CCCCCC">sort of another domain</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> c2</font><font color="#E5E5E5"> transport</font>

680
00:26:59,840 --> 00:27:07,850
as an extension<font color="#CCCCCC"> of that there is</font><font color="#E5E5E5"> outlook</font>

681
00:27:04,910 --> 00:27:10,880
tasks again<font color="#E5E5E5"> but this time</font><font color="#CCCCCC"> instead of</font>

682
00:27:07,850 --> 00:27:14,120
using the kind of<font color="#E5E5E5"> legacy REST API</font><font color="#CCCCCC"> it</font>

683
00:27:10,880 --> 00:27:16,070
<font color="#E5E5E5">uses exchange web services so</font><font color="#CCCCCC"> that's</font>

684
00:27:14,120 --> 00:27:19,669
kind of a<font color="#E5E5E5"> soap based protocol so if</font>

685
00:27:16,070 --> 00:27:20,990
you're you<font color="#E5E5E5"> don't necessarily need to use</font>

686
00:27:19,670 --> 00:27:23,330
<font color="#E5E5E5">it just with office 365</font>

687
00:27:20,990 --> 00:27:26,000
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> exchange web services enabled by</font>

688
00:27:23,330 --> 00:27:27,949
default<font color="#CCCCCC"> on any exchange server</font><font color="#E5E5E5"> so you</font>

689
00:27:26,000 --> 00:27:30,080
<font color="#CCCCCC">could use</font><font color="#E5E5E5"> it for kind of any cloud</font>

690
00:27:27,950 --> 00:27:31,640
provider that<font color="#E5E5E5"> does</font><font color="#CCCCCC"> have exchange servers</font>

691
00:27:30,080 --> 00:27:34,399
or you could even<font color="#E5E5E5"> use on-premise</font>

692
00:27:31,640 --> 00:27:37,040
exchange servers for internal lateral

693
00:27:34,400 --> 00:27:39,280
movement or you<font color="#CCCCCC"> can even</font><font color="#E5E5E5"> do sort of like</font>

694
00:27:37,040 --> 00:27:42,280
<font color="#CCCCCC">a hybrid</font><font color="#E5E5E5"> type thing where you have</font>

695
00:27:39,280 --> 00:27:45,350
compromised<font color="#E5E5E5"> clients which are</font>

696
00:27:42,280 --> 00:27:46,970
interacting<font color="#CCCCCC"> with on-premise exchange</font>

697
00:27:45,350 --> 00:27:48,560
servers<font color="#E5E5E5"> and then you're pulling that</font>

698
00:27:46,970 --> 00:27:51,490
<font color="#CCCCCC">from that exchange service public</font>

699
00:27:48,560 --> 00:27:51,490
<font color="#E5E5E5">interface as</font><font color="#CCCCCC"> well</font>

700
00:27:52,990 --> 00:28:02,270
sorry<font color="#CCCCCC"> Kabul strike</font><font color="#E5E5E5"> does do internal kind</font>

701
00:27:57,890 --> 00:28:04,610
of<font color="#CCCCCC"> situ via SMB the problem with this</font>

702
00:28:02,270 --> 00:28:07,280
however<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that it requires direct</font><font color="#E5E5E5"> host</font>

703
00:28:04,610 --> 00:28:09,260
<font color="#CCCCCC">of hosts communication so to provide</font>

704
00:28:07,280 --> 00:28:11,960
kind<font color="#E5E5E5"> of an extensional extension of that</font>

705
00:28:09,260 --> 00:28:14,690
<font color="#E5E5E5">within</font><font color="#CCCCCC"> c3 there's another interface</font><font color="#E5E5E5"> for</font>

706
00:28:11,960 --> 00:28:16,040
<font color="#E5E5E5">doing c2 via file shares which is</font>

707
00:28:14,690 --> 00:28:17,720
<font color="#E5E5E5">obviously kind of just specifying a</font>

708
00:28:16,040 --> 00:28:19,970
folder and<font color="#E5E5E5"> then sort of files are being</font>

709
00:28:17,720 --> 00:28:22,910
<font color="#E5E5E5">used to sort of transport</font><font color="#CCCCCC"> that and that</font>

710
00:28:19,970 --> 00:28:26,900
allows<font color="#CCCCCC"> us to do</font><font color="#E5E5E5"> c2 about c2 via indirect</font>

711
00:28:22,910 --> 00:28:29,630
means there is an internal<font color="#E5E5E5"> API between</font>

712
00:28:26,900 --> 00:28:31,790
<font color="#E5E5E5">all the client relays</font><font color="#CCCCCC"> you know for</font><font color="#E5E5E5"> doing</font>

713
00:28:29,630 --> 00:28:33,170
things<font color="#CCCCCC"> like</font><font color="#E5E5E5"> you know profiling what's</font>

714
00:28:31,790 --> 00:28:35,750
the capability of<font color="#E5E5E5"> a relay what</font>

715
00:28:33,170 --> 00:28:38,000
interfaces does it have or<font color="#E5E5E5"> even kind of</font>

716
00:28:35,750 --> 00:28:38,600
dynamically configuring it<font color="#E5E5E5"> so if you</font>

717
00:28:38,000 --> 00:28:41,690
want to

718
00:28:38,600 --> 00:28:43,070
tear down<font color="#E5E5E5"> an interface on</font><font color="#CCCCCC"> a relay or you</font>

719
00:28:41,690 --> 00:28:45,370
want to spin up a new<font color="#E5E5E5"> interface on a</font>

720
00:28:43,070 --> 00:28:47,570
relay<font color="#E5E5E5"> you can do that through the API</font>

721
00:28:45,370 --> 00:28:51,289
<font color="#CCCCCC">that's obviously transported over</font>

722
00:28:47,570 --> 00:28:52,820
whatever<font color="#CCCCCC"> c2 mechanism is in use and</font><font color="#E5E5E5"> kind</font>

723
00:28:51,289 --> 00:28:55,820
<font color="#CCCCCC">of another</font><font color="#E5E5E5"> kind of key benefit of</font><font color="#CCCCCC"> that</font>

724
00:28:52,820 --> 00:28:57,320
as well is if you're kind<font color="#E5E5E5"> of wanting</font><font color="#CCCCCC"> to</font>

725
00:28:55,820 --> 00:29:00,260
dynamically configure something<font color="#E5E5E5"> at</font>

726
00:28:57,320 --> 00:29:02,480
<font color="#CCCCCC">runtime and use a new c2 mechanism</font><font color="#E5E5E5"> you</font>

727
00:29:00,260 --> 00:29:05,240
<font color="#E5E5E5">can kind of create the new interface at</font>

728
00:29:02,480 --> 00:29:06,950
<font color="#CCCCCC">runtime and kind of pass credentials as</font>

729
00:29:05,240 --> 00:29:08,870
part<font color="#E5E5E5"> of that process</font><font color="#CCCCCC"> so if you're using</font>

730
00:29:06,950 --> 00:29:10,549
<font color="#E5E5E5">something like office 365</font><font color="#CCCCCC"> that obviously</font>

731
00:29:08,870 --> 00:29:13,100
needs to be authenticated<font color="#E5E5E5"> in some form</font>

732
00:29:10,549 --> 00:29:15,639
so you<font color="#E5E5E5"> can do that</font><font color="#CCCCCC"> run time rather than</font>

733
00:29:13,100 --> 00:29:21,168
<font color="#E5E5E5">having things compiled into the binary</font>

734
00:29:15,640 --> 00:29:22,460
<font color="#E5E5E5">itself on initial access</font><font color="#CCCCCC"> this can</font>

735
00:29:21,169 --> 00:29:23,600
obviously<font color="#CCCCCC"> all get start to get quite</font>

736
00:29:22,460 --> 00:29:26,780
complex if you have more than a few

737
00:29:23,600 --> 00:29:28,969
<font color="#E5E5E5">client relays there is a a web interface</font>

738
00:29:26,780 --> 00:29:30,770
<font color="#CCCCCC">for kind of visualizing</font><font color="#E5E5E5"> all of this</font>

739
00:29:28,970 --> 00:29:32,630
stuff and<font color="#E5E5E5"> making it easier to</font><font color="#CCCCCC"> interact</font>

740
00:29:30,770 --> 00:29:35,990
with<font color="#E5E5E5"> this network or the relays in the</font>

741
00:29:32,630 --> 00:29:39,230
network<font color="#E5E5E5"> moving on to the more practical</font>

742
00:29:35,990 --> 00:29:42,380
<font color="#CCCCCC">things</font><font color="#E5E5E5"> getting a demo in there</font><font color="#CCCCCC"> so if we</font>

743
00:29:39,230 --> 00:29:44,240
take kind of<font color="#E5E5E5"> an example</font><font color="#CCCCCC"> scenario of Acme</font>

744
00:29:42,380 --> 00:29:46,909
<font color="#E5E5E5">Bank which has gone through some attack</font>

745
00:29:44,240 --> 00:29:48,260
simulations a few years ago<font color="#CCCCCC"> you know</font>

746
00:29:46,909 --> 00:29:51,020
maybe let's<font color="#E5E5E5"> assume they got pummeled</font>

747
00:29:48,260 --> 00:29:52,220
quite hard<font color="#E5E5E5"> roughed up a</font><font color="#CCCCCC"> little bit</font><font color="#E5E5E5"> and</font>

748
00:29:51,020 --> 00:29:55,460
as a result they've made heavy

749
00:29:52,220 --> 00:29:58,190
investments in<font color="#CCCCCC"> cybersecurity solutions</font>

750
00:29:55,460 --> 00:30:02,059
<font color="#E5E5E5">and other kind of processes</font><font color="#CCCCCC"> so they've</font>

751
00:29:58,190 --> 00:30:03,440
developed an in-house<font color="#CCCCCC"> sock they've kind</font>

752
00:30:02,059 --> 00:30:05,928
of invested in all kind<font color="#CCCCCC"> of the blinky</font>

753
00:30:03,440 --> 00:30:08,390
boxes doing categorization enforcement

754
00:30:05,929 --> 00:30:11,210
behavioral analysis<font color="#CCCCCC"> you know flagging of</font>

755
00:30:08,390 --> 00:30:13,100
known bad domains and so on and in order

756
00:30:11,210 --> 00:30:15,169
to<font color="#E5E5E5"> prevent attackers</font><font color="#CCCCCC"> from running</font>

757
00:30:13,100 --> 00:30:17,149
rampant once they're on<font color="#E5E5E5"> the internal</font>

758
00:30:15,169 --> 00:30:18,860
<font color="#CCCCCC">network they've also</font><font color="#E5E5E5"> deployed</font>

759
00:30:17,150 --> 00:30:22,429
workstation to workstation firewalls

760
00:30:18,860 --> 00:30:25,939
globally<font color="#CCCCCC"> to hinder that</font><font color="#E5E5E5"> so how can see</font>

761
00:30:22,429 --> 00:30:27,860
<font color="#E5E5E5">three help in this situation</font><font color="#CCCCCC"> one of the</font>

762
00:30:25,940 --> 00:30:30,380
<font color="#E5E5E5">ways is kind of pivoting your</font><font color="#CCCCCC"> traffic</font>

763
00:30:27,860 --> 00:30:33,439
through reputable domains<font color="#E5E5E5"> so the obvious</font>

764
00:30:30,380 --> 00:30:34,820
<font color="#E5E5E5">kind of benefit of that is</font><font color="#CCCCCC"> that if</font>

765
00:30:33,440 --> 00:30:36,230
<font color="#E5E5E5">anyone is kind of watching that within</font>

766
00:30:34,820 --> 00:30:38,360
<font color="#E5E5E5">the sock you know if they've seen</font>

767
00:30:36,230 --> 00:30:40,309
<font color="#E5E5E5">traffic go to like a Microsoft domain or</font>

768
00:30:38,360 --> 00:30:43,158
like an<font color="#CCCCCC"> apple domain or kind of whoever</font>

769
00:30:40,309 --> 00:30:45,559
domain<font color="#E5E5E5"> it's immediately less suspicious</font>

770
00:30:43,159 --> 00:30:48,530
<font color="#CCCCCC">but</font><font color="#E5E5E5"> also many of the sort</font><font color="#CCCCCC"> of networking</font>

771
00:30:45,559 --> 00:30:51,970
appliances<font color="#E5E5E5"> explicitly whitelist</font>

772
00:30:48,530 --> 00:30:53,590
<font color="#E5E5E5">some traffic's to these domains as</font><font color="#CCCCCC"> well</font>

773
00:30:51,970 --> 00:30:57,100
so in<font color="#E5E5E5"> this particular demo that I'll</font>

774
00:30:53,590 --> 00:31:01,330
show here<font color="#E5E5E5"> it's running a client relay</font>

775
00:30:57,100 --> 00:31:04,560
and then getting<font color="#E5E5E5"> a initial access and</font>

776
00:31:01,330 --> 00:31:10,419
staging beacon through office<font color="#E5E5E5"> 365</font>

777
00:31:04,560 --> 00:31:12,550
<font color="#CCCCCC">onedrive</font><font color="#E5E5E5"> specifically so here we have</font>

778
00:31:10,420 --> 00:31:18,400
the<font color="#CCCCCC"> c3 web interface that</font><font color="#E5E5E5"> I mentioned</font>

779
00:31:12,550 --> 00:31:20,110
earlier<font color="#CCCCCC"> down it's sort of you can see</font>

780
00:31:18,400 --> 00:31:21,580
here there's the the server relay that I

781
00:31:20,110 --> 00:31:23,439
mentioned there's<font color="#CCCCCC"> also the cobalt strike</font>

782
00:31:21,580 --> 00:31:25,810
team server<font color="#E5E5E5"> we can see at the moment</font>

783
00:31:23,440 --> 00:31:27,310
<font color="#E5E5E5">that there's no traffic flowing through</font>

784
00:31:25,810 --> 00:31:29,440
<font color="#CCCCCC">onedrive there's no files or anything</font>

785
00:31:27,310 --> 00:31:31,210
<font color="#E5E5E5">there and also in the background you'll</font>

786
00:31:29,440 --> 00:31:35,170
notice it was a bit quick but there

787
00:31:31,210 --> 00:31:38,200
wasn't<font color="#E5E5E5"> any</font><font color="#CCCCCC"> there wasn't any kind</font><font color="#E5E5E5"> of</font>

788
00:31:35,170 --> 00:31:40,600
initial access<font color="#E5E5E5"> so if we go</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> to the</font>

789
00:31:38,200 --> 00:31:42,310
client<font color="#E5E5E5"> we run the file you know whatever</font>

790
00:31:40,600 --> 00:31:45,370
you know it's a<font color="#E5E5E5"> phishing payload or</font>

791
00:31:42,310 --> 00:31:48,760
something<font color="#CCCCCC"> we should</font><font color="#E5E5E5"> begin to see traffic</font>

792
00:31:45,370 --> 00:31:51,070
flowing through onedrive<font color="#E5E5E5"> and then in a</font>

793
00:31:48,760 --> 00:31:53,379
few<font color="#E5E5E5"> seconds we'll see that staging</font>

794
00:31:51,070 --> 00:31:56,710
process<font color="#E5E5E5"> complete and getting that access</font>

795
00:31:53,380 --> 00:31:58,180
<font color="#E5E5E5">back to the</font><font color="#CCCCCC"> cobalt strike team server so</font>

796
00:31:56,710 --> 00:31:59,740
just doing a quick demo to<font color="#CCCCCC"> show you that</font>

797
00:31:58,180 --> 00:32:03,070
you<font color="#E5E5E5"> know you can indeed interact over</font>

798
00:31:59,740 --> 00:32:05,740
onedrive and on the right within<font color="#E5E5E5"> the web</font>

799
00:32:03,070 --> 00:32:07,929
interface<font color="#CCCCCC"> we'll see</font><font color="#E5E5E5"> when the client</font>

800
00:32:05,740 --> 00:32:10,300
<font color="#E5E5E5">relay sends back some configuration</font>

801
00:32:07,930 --> 00:32:11,980
information<font color="#E5E5E5"> that then that will get</font>

802
00:32:10,300 --> 00:32:15,280
<font color="#E5E5E5">populated and we can see what the c3</font>

803
00:32:11,980 --> 00:32:16,930
network is like so there's a<font color="#E5E5E5"> two client</font>

804
00:32:15,280 --> 00:32:17,440
relays there's a server relay which we

805
00:32:16,930 --> 00:32:19,090
had before

806
00:32:17,440 --> 00:32:20,920
<font color="#CCCCCC">which is now communicating</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the</font>

807
00:32:19,090 --> 00:32:23,620
client relay<font color="#E5E5E5"> and an attached to that</font>

808
00:32:20,920 --> 00:32:28,570
client relay<font color="#CCCCCC"> there is kind of an</font>

809
00:32:23,620 --> 00:32:31,800
instance of beacon running as well so if

810
00:32:28,570 --> 00:32:34,000
we want<font color="#CCCCCC"> to extend our access internally</font>

811
00:32:31,800 --> 00:32:35,530
<font color="#CCCCCC">one thing that we'll want to do is</font><font color="#E5E5E5"> kind</font>

812
00:32:34,000 --> 00:32:37,570
of move<font color="#E5E5E5"> on to</font><font color="#CCCCCC"> other hosts obviously</font>

813
00:32:35,530 --> 00:32:39,340
however<font color="#E5E5E5"> I'm gonna have to get</font><font color="#CCCCCC"> around</font>

814
00:32:37,570 --> 00:32:41,560
this problem<font color="#E5E5E5"> of workstation to</font>

815
00:32:39,340 --> 00:32:43,629
workstation firewalls<font color="#E5E5E5"> the obvious answer</font>

816
00:32:41,560 --> 00:32:46,840
is using one of<font color="#E5E5E5"> the internal interfaces</font>

817
00:32:43,630 --> 00:32:51,540
such as<font color="#E5E5E5"> kind of lateral movement through</font>

818
00:32:46,840 --> 00:32:54,429
file shares so that<font color="#E5E5E5"> initial kind of</font>

819
00:32:51,540 --> 00:32:57,430
access that<font color="#E5E5E5"> we obtained within that kind</font>

820
00:32:54,430 --> 00:32:59,650
<font color="#E5E5E5">of you know</font><font color="#CCCCCC"> DLL that's kind of being</font>

821
00:32:57,430 --> 00:33:01,210
<font color="#E5E5E5">executed we</font><font color="#CCCCCC"> obviously didn't know what</font>

822
00:32:59,650 --> 00:33:03,370
that file share was that we would want

823
00:33:01,210 --> 00:33:04,670
<font color="#CCCCCC">to laterally move through so we're going</font>

824
00:33:03,370 --> 00:33:07,340
<font color="#E5E5E5">to</font><font color="#CCCCCC"> need a dynamic</font>

825
00:33:04,670 --> 00:33:09,620
add a new interface<font color="#E5E5E5"> that listens on that</font>

826
00:33:07,340 --> 00:33:12,050
file share and then we're gonna need to

827
00:33:09,620 --> 00:33:13,580
jump over to<font color="#CCCCCC"> another</font><font color="#E5E5E5"> host and game you</font>

828
00:33:12,050 --> 00:33:16,310
know use some<font color="#CCCCCC"> sort</font><font color="#E5E5E5"> of method</font><font color="#CCCCCC"> to gain</font>

829
00:33:13,580 --> 00:33:18,139
code execution on<font color="#CCCCCC"> that host so for</font>

830
00:33:16,310 --> 00:33:19,520
<font color="#E5E5E5">example in this demo that would just be</font>

831
00:33:18,140 --> 00:33:21,050
let's<font color="#E5E5E5"> just assume that</font><font color="#CCCCCC"> we've</font><font color="#E5E5E5"> backdoor to</font>

832
00:33:19,520 --> 00:33:24,650
file on a file share or<font color="#CCCCCC"> or something</font>

833
00:33:21,050 --> 00:33:26,300
<font color="#E5E5E5">similar</font><font color="#CCCCCC"> to that so</font><font color="#E5E5E5"> in the bottom</font>

834
00:33:24,650 --> 00:33:27,920
<font color="#E5E5E5">left-hand</font><font color="#CCCCCC"> corner</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can see sort of an</font>

835
00:33:26,300 --> 00:33:31,879
example<font color="#CCCCCC"> of an API</font><font color="#E5E5E5"> command that would be</font>

836
00:33:27,920 --> 00:33:33,560
<font color="#E5E5E5">running basically you know it says it's</font>

837
00:33:31,880 --> 00:33:35,840
a text command<font color="#E5E5E5"> there's a new interface</font>

838
00:33:33,560 --> 00:33:39,800
<font color="#CCCCCC">of a particular type we</font><font color="#E5E5E5"> want it to</font>

839
00:33:35,840 --> 00:33:42,169
<font color="#CCCCCC">behave like</font><font color="#E5E5E5"> a server</font><font color="#CCCCCC"> and this is sort of</font>

840
00:33:39,800 --> 00:33:43,460
the the UNC path to the file share

841
00:33:42,170 --> 00:33:45,460
<font color="#CCCCCC">there's also</font><font color="#E5E5E5"> different bits of</font>

842
00:33:43,460 --> 00:33:47,780
configuration<font color="#CCCCCC"> information such as</font>

843
00:33:45,460 --> 00:33:49,610
<font color="#CCCCCC">prefectures and</font><font color="#E5E5E5"> suffixes</font><font color="#CCCCCC"> for any files</font>

844
00:33:47,780 --> 00:33:51,649
that get<font color="#CCCCCC"> created on that</font><font color="#E5E5E5"> on that file</font>

845
00:33:49,610 --> 00:33:53,510
share<font color="#E5E5E5"> and how often you</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> kind of</font>

846
00:33:51,650 --> 00:33:56,540
interact<font color="#E5E5E5"> with it as well in terms of</font>

847
00:33:53,510 --> 00:33:58,730
sleep and jitter timer so<font color="#CCCCCC"> within the</font><font color="#E5E5E5"> C 3</font>

848
00:33:56,540 --> 00:34:00,290
<font color="#E5E5E5">web UI</font><font color="#CCCCCC"> we can see that there's a client</font>

849
00:33:58,730 --> 00:34:04,640
<font color="#E5E5E5">relay currently it's only got an</font>

850
00:34:00,290 --> 00:34:07,220
interface for<font color="#CCCCCC"> onedrive but we can run</font>

851
00:34:04,640 --> 00:34:09,020
this<font color="#CCCCCC"> command and then this</font><font color="#E5E5E5"> will kind of</font>

852
00:34:07,220 --> 00:34:10,880
<font color="#E5E5E5">feed the traffic off through onedrive to</font>

853
00:34:09,020 --> 00:34:13,580
that<font color="#E5E5E5"> initial client relay and we'll spin</font>

854
00:34:10,880 --> 00:34:15,800
up that new interface<font color="#E5E5E5"> so now we want to</font>

855
00:34:13,580 --> 00:34:17,418
<font color="#E5E5E5">jump through</font><font color="#CCCCCC"> to that second</font><font color="#E5E5E5"> host that we</font>

856
00:34:15,800 --> 00:34:20,330
want to compromise<font color="#E5E5E5"> that's just kind</font><font color="#CCCCCC"> of</font>

857
00:34:17,418 --> 00:34:22,279
demo<font color="#E5E5E5"> getting code execution as well so</font>

858
00:34:20,330 --> 00:34:25,489
you know there's<font color="#E5E5E5"> this legitimate file</font>

859
00:34:22,280 --> 00:34:29,210
that we've backdoored in some forms such

860
00:34:25,489 --> 00:34:31,549
as you<font color="#E5E5E5"> know adding a macro and then once</font>

861
00:34:29,210 --> 00:34:34,220
<font color="#CCCCCC">that runs just a jump</font><font color="#E5E5E5"> through a couple</font>

862
00:34:31,550 --> 00:34:38,740
of warnings<font color="#CCCCCC"> Microsoft Office security</font>

863
00:34:34,219 --> 00:34:42,649
and all that<font color="#CCCCCC"> click click click indeed</font>

864
00:34:38,739 --> 00:34:45,109
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> when we jump back over to kind</font>

865
00:34:42,649 --> 00:34:47,690
<font color="#E5E5E5">of the attacking infrastructure</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can</font>

866
00:34:45,110 --> 00:34:49,730
see immediately<font color="#CCCCCC"> that kind of that system</font>

867
00:34:47,690 --> 00:34:53,149
<font color="#CCCCCC">is now kind</font><font color="#E5E5E5"> of beaconing back we've got</font>

868
00:34:49,730 --> 00:34:54,429
access<font color="#E5E5E5"> in</font><font color="#CCCCCC"> cobalt</font><font color="#E5E5E5"> strike and again what</font>

869
00:34:53,149 --> 00:34:56,960
it will do is it will<font color="#CCCCCC"> send back that</font>

870
00:34:54,429 --> 00:34:58,600
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> some profile information which</font>

871
00:34:56,960 --> 00:35:02,240
will allow us<font color="#CCCCCC"> to</font><font color="#E5E5E5"> kind of populate that</font>

872
00:34:58,600 --> 00:35:03,680
<font color="#E5E5E5">web UI as well so that will take a</font>

873
00:35:02,240 --> 00:35:05,660
<font color="#E5E5E5">couple of seconds but</font><font color="#CCCCCC"> just to</font><font color="#E5E5E5"> kind of</font>

874
00:35:03,680 --> 00:35:07,700
confirm again so we have<font color="#CCCCCC"> that</font><font color="#E5E5E5"> initial</font>

875
00:35:05,660 --> 00:35:09,529
client relay which is running<font color="#CCCCCC"> and pivot</font>

876
00:35:07,700 --> 00:35:11,660
<font color="#CCCCCC">and sending traffic</font><font color="#E5E5E5"> over onedrive and</font>

877
00:35:09,530 --> 00:35:13,070
then what we've done is added a new

878
00:35:11,660 --> 00:35:16,129
interface<font color="#E5E5E5"> on that that's listening</font><font color="#CCCCCC"> on a</font>

879
00:35:13,070 --> 00:35:17,100
file share<font color="#E5E5E5"> and then there is another</font>

880
00:35:16,130 --> 00:35:18,870
<font color="#CCCCCC">compromised</font>

881
00:35:17,100 --> 00:35:21,029
that's kind of<font color="#E5E5E5"> sending</font><font color="#CCCCCC"> data</font><font color="#E5E5E5"> to that file</font>

882
00:35:18,870 --> 00:35:23,100
share which is<font color="#E5E5E5"> being pulled back by that</font>

883
00:35:21,030 --> 00:35:25,830
initial<font color="#E5E5E5"> client relay and then being sent</font>

884
00:35:23,100 --> 00:35:30,270
<font color="#E5E5E5">back over onedrive</font><font color="#CCCCCC"> so we can chain them</font>

885
00:35:25,830 --> 00:35:33,720
together in this<font color="#E5E5E5"> way</font><font color="#CCCCCC"> c3 is by no means a</font>

886
00:35:30,270 --> 00:35:35,550
finished product<font color="#CCCCCC"> you know we we</font>

887
00:35:33,720 --> 00:35:37,649
obviously need<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> certain things such</font>

888
00:35:35,550 --> 00:35:40,080
<font color="#E5E5E5">as ship it is a very good</font><font color="#CCCCCC"> example of</font>

889
00:35:37,650 --> 00:35:41,940
something<font color="#CCCCCC"> that we need</font><font color="#E5E5E5"> to do</font><font color="#CCCCCC"> which as I</font>

890
00:35:40,080 --> 00:35:45,029
<font color="#CCCCCC">said will hopefully be in</font><font color="#E5E5E5"> the next kind</font>

891
00:35:41,940 --> 00:35:46,590
<font color="#E5E5E5">of four weeks six maximum</font><font color="#CCCCCC"> but some of</font>

892
00:35:45,030 --> 00:35:48,810
the other things<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> want to do are</font>

893
00:35:46,590 --> 00:35:50,430
<font color="#CCCCCC">listed here a couple of</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> that I</font>

894
00:35:48,810 --> 00:35:51,990
wanted<font color="#E5E5E5"> to call out would be we want to</font>

895
00:35:50,430 --> 00:35:54,600
kind<font color="#CCCCCC"> of put more interfaces out there</font>

896
00:35:51,990 --> 00:35:55,890
when we<font color="#E5E5E5"> publicly release ed so for some</font>

897
00:35:54,600 --> 00:35:58,770
<font color="#CCCCCC">of them</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I've mentioned</font><font color="#E5E5E5"> we may not</font>

898
00:35:55,890 --> 00:36:00,060
release<font color="#E5E5E5"> them all but you</font><font color="#CCCCCC"> know we may</font>

899
00:35:58,770 --> 00:36:02,820
<font color="#E5E5E5">only release sort of those that are more</font>

900
00:36:00,060 --> 00:36:04,290
kind of service agnostic<font color="#CCCCCC"> but</font><font color="#E5E5E5"> at the same</font>

901
00:36:02,820 --> 00:36:05,550
time we do sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> create</font>

902
00:36:04,290 --> 00:36:08,580
interfaces<font color="#CCCCCC"> that we may or may not</font>

903
00:36:05,550 --> 00:36:10,800
release are things like pivoting traffic

904
00:36:08,580 --> 00:36:12,360
through services that organizations are

905
00:36:10,800 --> 00:36:15,720
kind of<font color="#E5E5E5"> commonly using so things like</font>

906
00:36:12,360 --> 00:36:18,000
slack or confluence or<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of doing</font>

907
00:36:15,720 --> 00:36:20,700
internal<font color="#CCCCCC"> c2 via things like Active</font>

908
00:36:18,000 --> 00:36:22,470
Directory DNS records in addition to

909
00:36:20,700 --> 00:36:25,710
that<font color="#E5E5E5"> another key thing that we want to</font>

910
00:36:22,470 --> 00:36:27,899
put in there is kind of I<font color="#E5E5E5"> guess the</font>

911
00:36:25,710 --> 00:36:30,420
concept<font color="#E5E5E5"> of like multiplexing so if you</font>

912
00:36:27,900 --> 00:36:31,470
have kind<font color="#E5E5E5"> of a compromised host</font><font color="#CCCCCC"> if you</font>

913
00:36:30,420 --> 00:36:33,690
kind of<font color="#E5E5E5"> have multiple interfaces</font>

914
00:36:31,470 --> 00:36:36,870
attached to that that it in some way

915
00:36:33,690 --> 00:36:39,750
kind of randomly<font color="#E5E5E5"> kind of sends traffic</font>

916
00:36:36,870 --> 00:36:41,190
<font color="#E5E5E5">over different interfaces</font><font color="#CCCCCC"> so rather</font><font color="#E5E5E5"> than</font>

917
00:36:39,750 --> 00:36:43,680
<font color="#CCCCCC">just kind</font><font color="#E5E5E5"> of pummeling your</font><font color="#CCCCCC"> traffic over</font>

918
00:36:41,190 --> 00:36:45,510
<font color="#E5E5E5">one drive you can kind of blend</font><font color="#CCCCCC"> in to</font>

919
00:36:43,680 --> 00:36:49,710
<font color="#E5E5E5">legitimate traffic a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> more and</font>

920
00:36:45,510 --> 00:36:52,350
<font color="#E5E5E5">kind of spread things out on</font><font color="#CCCCCC"> that topic</font>

921
00:36:49,710 --> 00:36:55,560
<font color="#E5E5E5">I think that's us done I don't have you</font>

922
00:36:52,350 --> 00:36:59,330
got any<font color="#E5E5E5"> final words there no no he has</font>

923
00:36:55,560 --> 00:36:59,330
no final words so if anyone<font color="#E5E5E5"> has</font>

924
00:37:09,950 --> 00:37:13,939
so if we have<font color="#CCCCCC"> question and</font><font color="#E5E5E5"> answers right</font>

925
00:37:12,740 --> 00:37:15,740
<font color="#E5E5E5">now</font><font color="#CCCCCC"> so if you</font><font color="#E5E5E5"> have a question please</font>

926
00:37:13,940 --> 00:37:17,030
<font color="#E5E5E5">raise</font><font color="#CCCCCC"> your hand</font><font color="#E5E5E5"> please wait</font><font color="#CCCCCC"> for a mic to</font>

927
00:37:15,740 --> 00:37:18,828
come to you<font color="#E5E5E5"> so that we can get it for</font>

928
00:37:17,030 --> 00:37:20,920
the recording<font color="#CCCCCC"> does</font><font color="#E5E5E5"> anyone have any</font>

929
00:37:18,829 --> 00:37:20,920
<font color="#E5E5E5">questions</font>

930
00:37:28,540 --> 00:37:33,770
how are you with<font color="#E5E5E5"> the SMB file shares and</font>

931
00:37:32,930 --> 00:37:35,589
all that kind of<font color="#E5E5E5"> stuff</font>

932
00:37:33,770 --> 00:37:38,390
how are you being sure that<font color="#E5E5E5"> it's only</font>

933
00:37:35,589 --> 00:37:40,849
your traffic<font color="#CCCCCC"> who's able</font><font color="#E5E5E5"> to control the</font>

934
00:37:38,390 --> 00:37:43,400
the<font color="#E5E5E5"> other implants and not somebody</font><font color="#CCCCCC"> else</font>

935
00:37:40,849 --> 00:37:46,160
<font color="#E5E5E5">on the network so the way that that</font>

936
00:37:43,400 --> 00:37:47,000
would be<font color="#E5E5E5"> determined</font><font color="#CCCCCC"> is through so the</font>

937
00:37:46,160 --> 00:37:48,560
first thing you would<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to specify</font>

938
00:37:47,000 --> 00:37:51,530
you obviously have<font color="#E5E5E5"> to specify a</font><font color="#CCCCCC"> folder</font>

939
00:37:48,560 --> 00:37:53,420
but<font color="#E5E5E5"> then within that the interfaces will</font>

940
00:37:51,530 --> 00:37:56,150
explicitly check<font color="#E5E5E5"> you know I've been</font>

941
00:37:53,420 --> 00:37:58,990
configured<font color="#CCCCCC"> with you might have seen that</font>

942
00:37:56,150 --> 00:38:01,220
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> preface</font><font color="#E5E5E5"> and suffix so it will</font>

943
00:37:58,990 --> 00:38:02,979
kind of go<font color="#CCCCCC"> out and it</font><font color="#E5E5E5"> will only fetch</font>

944
00:38:01,220 --> 00:38:05,839
files that meet those particular

945
00:38:02,980 --> 00:38:07,520
<font color="#CCCCCC">parameters rather than kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> just</font>

946
00:38:05,839 --> 00:38:09,320
pulling<font color="#CCCCCC"> anything in and deleting</font>

947
00:38:07,520 --> 00:38:10,880
arbitrary data it's kind of somewhat

948
00:38:09,320 --> 00:38:12,890
restricted to the parameters that you

949
00:38:10,880 --> 00:38:15,859
<font color="#E5E5E5">provide it and it will do validation in</font>

950
00:38:12,890 --> 00:38:17,540
that way<font color="#E5E5E5"> well if</font><font color="#CCCCCC"> if I was</font><font color="#E5E5E5"> somebody with</font>

951
00:38:15,859 --> 00:38:18,980
access<font color="#CCCCCC"> to that file share</font><font color="#E5E5E5"> yeah and I</font>

952
00:38:17,540 --> 00:38:21,170
<font color="#CCCCCC">could see files being created</font><font color="#E5E5E5"> and</font>

953
00:38:18,980 --> 00:38:22,670
deleted<font color="#E5E5E5"> and stuff what would prevent</font><font color="#CCCCCC"> me</font>

954
00:38:21,170 --> 00:38:25,310
from putting different<font color="#E5E5E5"> commands in those</font>

955
00:38:22,670 --> 00:38:27,619
same<font color="#E5E5E5"> files those of that pattern</font><font color="#CCCCCC"> and</font>

956
00:38:25,310 --> 00:38:29,839
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> so there would be</font><font color="#E5E5E5"> nothing stopping</font>

957
00:38:27,619 --> 00:38:32,089
<font color="#CCCCCC">you dropping the files in there they</font>

958
00:38:29,839 --> 00:38:34,490
wouldn't be kind of<font color="#E5E5E5"> so let's say you</font>

959
00:38:32,089 --> 00:38:37,940
<font color="#E5E5E5">kind of somehow worked out</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> like</font>

960
00:38:34,490 --> 00:38:40,299
what the format was of the kind of like

961
00:38:37,940 --> 00:38:43,430
an API command that<font color="#E5E5E5"> you need to run etc</font>

962
00:38:40,300 --> 00:38:44,780
<font color="#E5E5E5">the all of the relays do have they do</font>

963
00:38:43,430 --> 00:38:47,720
leverage like authenticated encryption

964
00:38:44,780 --> 00:38:49,160
and stuff for you<font color="#E5E5E5"> know like before they</font>

965
00:38:47,720 --> 00:38:50,359
will run an API command they'll check

966
00:38:49,160 --> 00:38:52,848
that it's actually coming<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the</font>

967
00:38:50,359 --> 00:38:56,390
server relay<font color="#CCCCCC"> so they won't kind of like</font>

968
00:38:52,849 --> 00:38:58,460
arbitrarily<font color="#E5E5E5"> kind of be kind</font><font color="#CCCCCC"> of executing</font>

969
00:38:56,390 --> 00:39:01,009
stuff there<font color="#E5E5E5"> is some validation of</font><font color="#CCCCCC"> that</font>

970
00:38:58,460 --> 00:39:02,930
in there as well<font color="#CCCCCC"> but I mean</font><font color="#E5E5E5"> there's</font>

971
00:39:01,010 --> 00:39:05,119
<font color="#CCCCCC">nothing to stop kind of arbitrary files</font>

972
00:39:02,930 --> 00:39:06,919
being being added in there<font color="#E5E5E5"> but there is</font>

973
00:39:05,119 --> 00:39:08,839
<font color="#E5E5E5">other kind of countermeasures</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> would</font>

974
00:39:06,920 --> 00:39:10,970
prevent negative<font color="#E5E5E5"> effects from</font><font color="#CCCCCC"> that it's</font>

975
00:39:08,839 --> 00:39:19,339
open source<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can check out</font>

976
00:39:10,970 --> 00:39:21,709
<font color="#E5E5E5">yourself soon to</font><font color="#CCCCCC"> be open</font><font color="#E5E5E5"> source so as</font>

977
00:39:19,339 --> 00:39:24,859
someone<font color="#E5E5E5"> who works on the one of the</font>

978
00:39:21,710 --> 00:39:26,960
<font color="#CCCCCC">affer mentioned 365 channels of</font>

979
00:39:24,859 --> 00:39:28,910
communication is there anything we<font color="#E5E5E5"> can</font>

980
00:39:26,960 --> 00:39:32,359
<font color="#CCCCCC">be doing</font><font color="#E5E5E5"> at like the</font><font color="#CCCCCC"> application level</font>

981
00:39:28,910 --> 00:39:35,109
<font color="#E5E5E5">to be trying to detect or remediate</font>

982
00:39:32,359 --> 00:39:37,339
<font color="#E5E5E5">these these channels somehow</font>

983
00:39:35,109 --> 00:39:38,509
<font color="#E5E5E5">recommendations so I think there's the</font>

984
00:39:37,339 --> 00:39:41,690
certain things that<font color="#E5E5E5"> you could be doing</font>

985
00:39:38,510 --> 00:39:42,050
so as an example<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that traffic</font>

986
00:39:41,690 --> 00:39:44,060
<font color="#E5E5E5">that's</font>

987
00:39:42,050 --> 00:39:45,770
going up there<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> it is</font>

988
00:39:44,060 --> 00:39:47,330
effectively a binary blob<font color="#E5E5E5"> that's been</font>

989
00:39:45,770 --> 00:39:51,170
you<font color="#E5E5E5"> know basically</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> encoded or</font>

990
00:39:47,330 --> 00:39:52,069
something now maybe there's lots of

991
00:39:51,170 --> 00:39:53,540
people<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> doing this for</font>

992
00:39:52,070 --> 00:39:56,360
legitimate<font color="#CCCCCC"> reasons which will make</font><font color="#E5E5E5"> that</font>

993
00:39:53,540 --> 00:39:58,070
quite<font color="#CCCCCC"> difficult</font><font color="#E5E5E5"> to detect but I think</font>

994
00:39:56,360 --> 00:40:00,590
there's certain messages that<font color="#E5E5E5"> will be</font>

995
00:39:58,070 --> 00:40:02,840
<font color="#E5E5E5">kind of transported that you would</font>

996
00:40:00,590 --> 00:40:07,370
definitely<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> flagging on so as</font>

997
00:40:02,840 --> 00:40:09,560
I<font color="#E5E5E5"> said we can do</font><font color="#CCCCCC"> stage less kind of in</font>

998
00:40:07,370 --> 00:40:12,440
<font color="#CCCCCC">c3 implants</font><font color="#E5E5E5"> so like you know</font><font color="#CCCCCC"> it'd</font><font color="#E5E5E5"> be</font>

999
00:40:09,560 --> 00:40:15,110
kind of<font color="#E5E5E5"> like a c3 relay that's already</font>

1000
00:40:12,440 --> 00:40:18,230
<font color="#E5E5E5">got an embedded beacon cobalt stripe</font>

1001
00:40:15,110 --> 00:40:19,970
beacon instance associated<font color="#E5E5E5"> with that but</font>

1002
00:40:18,230 --> 00:40:22,010
if<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> not there then we</font><font color="#E5E5E5"> have to</font>

1003
00:40:19,970 --> 00:40:24,500
stage<font color="#E5E5E5"> that over things</font><font color="#CCCCCC"> like office</font><font color="#E5E5E5"> 365</font>

1004
00:40:22,010 --> 00:40:25,820
<font color="#CCCCCC">now if you you know if you basically</font>

1005
00:40:24,500 --> 00:40:28,040
<font color="#CCCCCC">call decode that at the end of the day</font>

1006
00:40:25,820 --> 00:40:29,870
it's still<font color="#CCCCCC"> a you know it's a beacon DLL</font>

1007
00:40:28,040 --> 00:40:33,380
<font color="#CCCCCC">that you know you guys could be it</font><font color="#E5E5E5"> could</font>

1008
00:40:29,870 --> 00:40:34,609
be<font color="#E5E5E5"> flagging on so I would say that from</font>

1009
00:40:33,380 --> 00:40:36,740
what I've<font color="#CCCCCC"> seen</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> hasn't been any</font>

1010
00:40:34,610 --> 00:40:39,620
blocking<font color="#E5E5E5"> or any staging traffic over</font>

1011
00:40:36,740 --> 00:40:41,180
<font color="#E5E5E5">office 365 so I'm not sure</font><font color="#CCCCCC"> if there is</font>

1012
00:40:39,620 --> 00:40:43,400
any<font color="#E5E5E5"> sort of scanning or</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> that's</font>

1013
00:40:41,180 --> 00:40:45,710
<font color="#E5E5E5">going on at the</font><font color="#CCCCCC"> moment around that</font><font color="#E5E5E5"> area</font>

1014
00:40:43,400 --> 00:40:47,090
but we're not<font color="#CCCCCC"> keen</font><font color="#E5E5E5"> on Microsoft there</font>

1015
00:40:45,710 --> 00:40:50,030
these<font color="#CCCCCC"> are</font><font color="#E5E5E5"> just the</font><font color="#CCCCCC"> ones that</font><font color="#E5E5E5"> were</font>

1016
00:40:47,090 --> 00:40:51,590
implemented<font color="#CCCCCC"> because they're</font><font color="#E5E5E5"> often most</font>

1017
00:40:50,030 --> 00:40:53,600
in use in a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the environments we</font>

1018
00:40:51,590 --> 00:40:55,340
go up against so the idea is that<font color="#E5E5E5"> by</font>

1019
00:40:53,600 --> 00:40:56,960
<font color="#CCCCCC">using all</font><font color="#E5E5E5"> these will blend in so when</font>

1020
00:40:55,340 --> 00:40:58,280
you<font color="#E5E5E5"> say can you look at it there's so</font>

1021
00:40:56,960 --> 00:40:59,270
much<font color="#E5E5E5"> noise there because everyone in</font>

1022
00:40:58,280 --> 00:41:01,550
that<font color="#CCCCCC"> environment is going to</font><font color="#E5E5E5"> be using</font>

1023
00:40:59,270 --> 00:41:03,620
<font color="#E5E5E5">those services</font><font color="#CCCCCC"> that's the kind of the</font>

1024
00:41:01,550 --> 00:41:05,270
idea to hide in<font color="#E5E5E5"> all that noise</font><font color="#CCCCCC"> and look</font>

1025
00:41:03,620 --> 00:41:07,819
as legit as possible and splendid<font color="#CCCCCC"> and</font>

1026
00:41:05,270 --> 00:41:11,090
like we<font color="#E5E5E5"> said we've got slack Google</font>

1027
00:41:07,820 --> 00:41:12,590
<font color="#E5E5E5">Drive others that were working on and we</font>

1028
00:41:11,090 --> 00:41:13,670
may not push all<font color="#CCCCCC"> of those out because we</font>

1029
00:41:12,590 --> 00:41:15,920
want<font color="#E5E5E5"> to</font><font color="#CCCCCC"> keep them for ourselves but the</font>

1030
00:41:13,670 --> 00:41:18,170
framework<font color="#E5E5E5"> itself has been designed in</font>

1031
00:41:15,920 --> 00:41:21,350
such a way<font color="#CCCCCC"> that you guys can rapidly</font>

1032
00:41:18,170 --> 00:41:30,620
prototype those like probably much more

1033
00:41:21,350 --> 00:41:34,730
stable<font color="#CCCCCC"> it'd</font><font color="#E5E5E5"> be fun he's not</font><font color="#CCCCCC"> like X</font><font color="#E5E5E5"> on</font>

1034
00:41:30,620 --> 00:41:37,870
any other questions<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> thank you</font>

1035
00:41:34,730 --> 00:41:37,870
<font color="#CCCCCC">very much guys thank you</font><font color="#E5E5E5"> very much</font>

