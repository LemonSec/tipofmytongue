1
00:00:00,050 --> 00:00:02,270
[Music]

2
00:00:02,730 --> 00:00:07,789
please welcome to the stage jean-luc

3
00:00:09,220 --> 00:00:17,330
[Music]

4
00:00:13,780 --> 00:00:19,790
good morning everybody my name is John

5
00:00:17,330 --> 00:00:22,189
Liu Peck and I am the deputy says oh and

6
00:00:19,790 --> 00:00:24,529
lead consultant for critical informatics

7
00:00:22,190 --> 00:00:26,510
or CI security we're based out of

8
00:00:24,529 --> 00:00:28,490
Bremerton and we are a combination of

9
00:00:26,510 --> 00:00:30,140
managed detection and professional

10
00:00:28,490 --> 00:00:32,210
services but we work in the security

11
00:00:30,140 --> 00:00:33,500
space this morning I'm going to talk

12
00:00:32,210 --> 00:00:35,329
about a few Incident Response

13
00:00:33,500 --> 00:00:37,490
engagements and investigations that

14
00:00:35,329 --> 00:00:38,300
we've performed recently first a little

15
00:00:37,490 --> 00:00:39,829
bit about me

16
00:00:38,300 --> 00:00:42,680
my background is an infrastructure

17
00:00:39,829 --> 00:00:44,360
engineering and supercomputers I used to

18
00:00:42,680 --> 00:00:45,230
plug things in and make them go fast and

19
00:00:44,360 --> 00:00:46,850
then I would hand them off to

20
00:00:45,230 --> 00:00:48,739
specialists who do interesting things

21
00:00:46,850 --> 00:00:51,440
with them like trying to save the world

22
00:00:48,740 --> 00:00:52,760
from malaria and global warming today my

23
00:00:51,440 --> 00:00:54,290
time is split between Enterprise Risk

24
00:00:52,760 --> 00:00:56,510
Management Incident Response services

25
00:00:54,290 --> 00:00:58,160
and I also manage and support our

26
00:00:56,510 --> 00:00:59,660
internal security controls and

27
00:00:58,160 --> 00:01:02,029
compliance of our company with Mike

28
00:00:59,660 --> 00:01:04,030
Hamilton who's sea-ice founder and the

29
00:01:02,030 --> 00:01:06,439
former says Oh for the city of Seattle

30
00:01:04,030 --> 00:01:07,909
I'm here to talk about what we've seen

31
00:01:06,439 --> 00:01:09,710
and I our engagements over the last

32
00:01:07,909 --> 00:01:12,259
couple of years how we are all

33
00:01:09,710 --> 00:01:13,699
witnessing but also in the middle of a

34
00:01:12,259 --> 00:01:16,670
change in the Incident Response

35
00:01:13,700 --> 00:01:17,630
landscape as you expect everything

36
00:01:16,670 --> 00:01:19,399
you're about to see here has been

37
00:01:17,630 --> 00:01:23,179
anonymized but everything actually

38
00:01:19,399 --> 00:01:24,859
occurred before we dig in too far I

39
00:01:23,179 --> 00:01:27,679
would like to ask some questions of the

40
00:01:24,859 --> 00:01:30,649
audience so please raise your hand if

41
00:01:27,679 --> 00:01:32,509
you work with or you support an incident

42
00:01:30,649 --> 00:01:34,369
response team now this might be formal

43
00:01:32,509 --> 00:01:36,679
or it could be just you get called in

44
00:01:34,369 --> 00:01:40,909
when stuff goes wrong pretty good

45
00:01:36,679 --> 00:01:44,389
numbers now who uses office 365 or Azure

46
00:01:40,909 --> 00:01:48,170
as part of production excellent

47
00:01:44,389 --> 00:01:51,399
and who here actually works on the

48
00:01:48,170 --> 00:01:53,649
office 365 the azure or the ATP teams

49
00:01:51,399 --> 00:01:55,729
way cool all right

50
00:01:53,649 --> 00:01:58,999
thank you for having me here today and

51
00:01:55,729 --> 00:02:00,229
here we go so first up number one this

52
00:01:58,999 --> 00:02:02,929
incident was with a company called

53
00:02:00,229 --> 00:02:04,700
stargazer foods they are a food

54
00:02:02,929 --> 00:02:07,369
manufacturer who make health conscious

55
00:02:04,700 --> 00:02:09,170
protein bars and snack foods they've got

56
00:02:07,369 --> 00:02:12,020
a hybrid environment that split between

57
00:02:09,169 --> 00:02:13,819
office 365 as you're there on Prem

58
00:02:12,020 --> 00:02:16,580
Services and a manufacturing environment

59
00:02:13,819 --> 00:02:18,410
with a lot of IOT gear they also have a

60
00:02:16,580 --> 00:02:20,030
field sales team who spend weeks on the

61
00:02:18,410 --> 00:02:23,030
go with their laptops and all the good

62
00:02:20,030 --> 00:02:24,390
and bad that comes with so a sales rep

63
00:02:23,030 --> 00:02:26,790
laptop trigger

64
00:02:24,390 --> 00:02:28,980
evie alert one day stargazer calls us up

65
00:02:26,790 --> 00:02:30,870
and says hey we got this alert for a

66
00:02:28,980 --> 00:02:33,000
laptop it's crypto something or another

67
00:02:30,870 --> 00:02:35,010
we don't know if it's bad we just you

68
00:02:33,000 --> 00:02:37,110
know we just need to understand more of

69
00:02:35,010 --> 00:02:39,060
what's going on can you guys come in and

70
00:02:37,110 --> 00:02:41,940
do your forensics thing and tell us what

71
00:02:39,060 --> 00:02:45,420
happened so the risks of something like

72
00:02:41,940 --> 00:02:47,400
this as you imagine are not trivial but

73
00:02:45,420 --> 00:02:49,369
they could be but they could also be

74
00:02:47,400 --> 00:02:51,480
supremely devastating for the business

75
00:02:49,370 --> 00:02:52,530
malware could get loose potentially

76
00:02:51,480 --> 00:02:54,840
bring down the manufacturing line

77
00:02:52,530 --> 00:02:57,270
impacting production or something could

78
00:02:54,840 --> 00:02:58,920
be phoning home somewhere they've also

79
00:02:57,270 --> 00:03:00,510
got client data and normal business

80
00:02:58,920 --> 00:03:03,179
operations stuff which we need to be

81
00:03:00,510 --> 00:03:04,799
aware of so we get on site and we sit

82
00:03:03,180 --> 00:03:06,030
down and start talking with them one of

83
00:03:04,800 --> 00:03:06,870
the first things we ask is what have you

84
00:03:06,030 --> 00:03:09,000
done so far

85
00:03:06,870 --> 00:03:11,010
what containment or response steps have

86
00:03:09,000 --> 00:03:12,840
you taken so far and they run us through

87
00:03:11,010 --> 00:03:14,310
it first they disconnected the laptop

88
00:03:12,840 --> 00:03:16,170
from the network this is good they

89
00:03:14,310 --> 00:03:18,570
turned off Wi-Fi then they disabled the

90
00:03:16,170 --> 00:03:20,040
employees ad account this is good then

91
00:03:18,570 --> 00:03:21,299
we unde it from the domain but other

92
00:03:20,040 --> 00:03:24,000
than that we haven't touched it we've

93
00:03:21,300 --> 00:03:25,800
just left it alone now I'm sure some of

94
00:03:24,000 --> 00:03:27,930
you are seeing what might be wrong with

95
00:03:25,800 --> 00:03:29,549
this picture and so we're talking on the

96
00:03:27,930 --> 00:03:33,810
phone oh yeah this is good this is good

97
00:03:29,549 --> 00:03:35,760
no wait back up a second so if you've

98
00:03:33,810 --> 00:03:37,500
never had cause to do it before when you

99
00:03:35,760 --> 00:03:40,140
remove a computer from a domain when you

100
00:03:37,500 --> 00:03:42,690
unjoin it from Active Directory domain

101
00:03:40,140 --> 00:03:46,200
or Azure ad there's a lot of changes

102
00:03:42,690 --> 00:03:47,970
which happen on the computer files get

103
00:03:46,200 --> 00:03:49,619
changed system information gets changed

104
00:03:47,970 --> 00:03:51,930
you lose network information about user

105
00:03:49,620 --> 00:03:53,820
accounts and it often reboots the

106
00:03:51,930 --> 00:03:55,620
computer at least once so if you're

107
00:03:53,820 --> 00:03:57,570
coming in to do a forensic analysis of a

108
00:03:55,620 --> 00:03:59,160
system where you want it to be more or

109
00:03:57,570 --> 00:04:00,600
less intact from the moment of the

110
00:03:59,160 --> 00:04:02,070
incident this is not great for

111
00:04:00,600 --> 00:04:04,049
preserving evidence and in fact can

112
00:04:02,070 --> 00:04:06,209
actually spoil very critical evidence to

113
00:04:04,049 --> 00:04:09,030
understand what the incident contained

114
00:04:06,209 --> 00:04:10,380
what it was but to an IT admin who's

115
00:04:09,030 --> 00:04:11,610
just trying to keep something bad from

116
00:04:10,380 --> 00:04:13,350
happening to their network this is

117
00:04:11,610 --> 00:04:14,910
actually a very prudent step they're

118
00:04:13,350 --> 00:04:17,640
disconnecting it from their environment

119
00:04:14,910 --> 00:04:19,589
and so it makes sense now I want to be

120
00:04:17,640 --> 00:04:21,358
very clear that this is not the clients

121
00:04:19,589 --> 00:04:23,219
fault this is not a mistake on the

122
00:04:21,358 --> 00:04:25,440
clients part this was actually a process

123
00:04:23,220 --> 00:04:27,360
failure on my part because we didn't

124
00:04:25,440 --> 00:04:29,219
tell them not to but I bring this up

125
00:04:27,360 --> 00:04:31,290
because it's a very excellent example of

126
00:04:29,220 --> 00:04:31,680
how somebody doing what they think is

127
00:04:31,290 --> 00:04:33,780
right

128
00:04:31,680 --> 00:04:36,390
could detrimental E effect an

129
00:04:33,780 --> 00:04:37,070
investigation now a process failure on

130
00:04:36,390 --> 00:04:39,229
my part

131
00:04:37,070 --> 00:04:40,700
one's easy to fix so we wrote up this

132
00:04:39,230 --> 00:04:42,140
little document which now we hand out

133
00:04:40,700 --> 00:04:44,420
every time somebody calls and says the

134
00:04:42,140 --> 00:04:45,860
word forensics and we make sure that

135
00:04:44,420 --> 00:04:48,080
they have a copy of it so they can see

136
00:04:45,860 --> 00:04:50,300
all right leave the computer alone don't

137
00:04:48,080 --> 00:04:51,620
remove from the domain do disconnect it

138
00:04:50,300 --> 00:04:53,900
from your network these are all good

139
00:04:51,620 --> 00:04:57,350
things boom problem solved process

140
00:04:53,900 --> 00:04:59,870
changes yeah but back to stargazer we

141
00:04:57,350 --> 00:05:01,190
get on site we image up the laptop and

142
00:04:59,870 --> 00:05:02,990
we used a commercial tool that's very

143
00:05:01,190 --> 00:05:05,480
well used in the industry very common

144
00:05:02,990 --> 00:05:07,160
the laptops drive was built in wasn't a

145
00:05:05,480 --> 00:05:09,020
normal SATA Drive that we could remove

146
00:05:07,160 --> 00:05:10,940
or we could take back with us and so we

147
00:05:09,020 --> 00:05:12,349
imaged it up to a USB disk and we get

148
00:05:10,940 --> 00:05:14,030
our little text output file from the

149
00:05:12,350 --> 00:05:15,800
process it says yeah everything's hashed

150
00:05:14,030 --> 00:05:18,020
alright and the image check came across

151
00:05:15,800 --> 00:05:19,190
great all the data is good we get it

152
00:05:18,020 --> 00:05:21,109
back to our lab and we start

153
00:05:19,190 --> 00:05:22,790
investigating and pretty quickly we see

154
00:05:21,110 --> 00:05:24,350
that we're able to see the files like we

155
00:05:22,790 --> 00:05:25,880
can see all the system files we can see

156
00:05:24,350 --> 00:05:27,470
all the data we we see what we're

157
00:05:25,880 --> 00:05:29,420
expecting but we can't actually see

158
00:05:27,470 --> 00:05:31,940
anything within those files there's no

159
00:05:29,420 --> 00:05:34,370
content that's being analyzed there we

160
00:05:31,940 --> 00:05:35,570
take a closer look and we say yeah this

161
00:05:34,370 --> 00:05:37,670
looks like it might actually be

162
00:05:35,570 --> 00:05:39,409
encrypted so we call the client back and

163
00:05:37,670 --> 00:05:41,930
we say hey guys did you happen to get

164
00:05:39,410 --> 00:05:43,670
BitLocker running on this laptop they're

165
00:05:41,930 --> 00:05:45,740
very proud they go yeah we push it out

166
00:05:43,670 --> 00:05:47,360
by GPO it's all working we have to print

167
00:05:45,740 --> 00:05:49,040
out the recovery keys and we keep track

168
00:05:47,360 --> 00:05:52,700
of those in a filing cabinet but yeah

169
00:05:49,040 --> 00:05:54,530
you know so okay all right we know we

170
00:05:52,700 --> 00:05:56,180
have a problem because we've imaged up

171
00:05:54,530 --> 00:05:57,890
this laptop it's full of encrypted data

172
00:05:56,180 --> 00:06:01,580
and even though our tool can see it it

173
00:05:57,890 --> 00:06:03,650
can't actually see it so we go back on

174
00:06:01,580 --> 00:06:05,780
site we work with them to decrypt the

175
00:06:03,650 --> 00:06:07,700
drive we get it imaged up again we bring

176
00:06:05,780 --> 00:06:09,950
the data back to our lab which we can

177
00:06:07,700 --> 00:06:12,170
now read we clearly find that the laptop

178
00:06:09,950 --> 00:06:13,760
user was deliberately running a crypto

179
00:06:12,170 --> 00:06:15,920
minor for personal profit and doing

180
00:06:13,760 --> 00:06:17,300
other bad stuff generally so we send

181
00:06:15,920 --> 00:06:18,680
them the report and we say here's what

182
00:06:17,300 --> 00:06:20,150
we found here's all the evidence that we

183
00:06:18,680 --> 00:06:22,370
see it's over to you guys you can make a

184
00:06:20,150 --> 00:06:24,109
decision about how to proceed then

185
00:06:22,370 --> 00:06:25,700
internally at CI we take a look at what

186
00:06:24,110 --> 00:06:27,080
happened here how did we image up a

187
00:06:25,700 --> 00:06:28,969
drive that was full of encrypted data

188
00:06:27,080 --> 00:06:30,349
and bring it back we take a look at our

189
00:06:28,970 --> 00:06:32,270
processes and again we we hold a

190
00:06:30,350 --> 00:06:34,640
retrospective we we make improvements

191
00:06:32,270 --> 00:06:36,229
that's great but this import this

192
00:06:34,640 --> 00:06:38,210
engagement had a good result in the end

193
00:06:36,230 --> 00:06:39,740
we were able to confirm the finding and

194
00:06:38,210 --> 00:06:41,120
we gave them the evidence they needed we

195
00:06:39,740 --> 00:06:42,770
had technical issues we were able to

196
00:06:41,120 --> 00:06:44,510
overcome but the thing that I want to

197
00:06:42,770 --> 00:06:46,669
communicate here is that this is

198
00:06:44,510 --> 00:06:48,169
ultimately the same forensic analysis

199
00:06:46,669 --> 00:06:49,789
process that we've been using for the

200
00:06:48,169 --> 00:06:50,690
better part of 20 years quite probably

201
00:06:49,790 --> 00:06:52,340
even longer

202
00:06:50,690 --> 00:06:53,930
ultimately you're making a copy of a

203
00:06:52,340 --> 00:06:55,400
computer you're taking it back to a lab

204
00:06:53,930 --> 00:06:56,630
you're diving into it and exploring

205
00:06:55,400 --> 00:06:57,859
what's happened then you're putting

206
00:06:56,630 --> 00:06:58,430
together data and you're sending it back

207
00:06:57,860 --> 00:07:00,320
to the client

208
00:06:58,430 --> 00:07:02,630
it's all very manual very human involved

209
00:07:00,320 --> 00:07:06,700
it's not good that's not bad it's just a

210
00:07:02,630 --> 00:07:09,890
data point on to incident number two

211
00:07:06,700 --> 00:07:11,450
very good Realtors these guys are a

212
00:07:09,890 --> 00:07:14,060
property management company in North

213
00:07:11,450 --> 00:07:15,710
Carolina they are all office 365 they

214
00:07:14,060 --> 00:07:17,840
have no servers they have no on-premise

215
00:07:15,710 --> 00:07:19,400
environments other than a little

216
00:07:17,840 --> 00:07:20,960
wireless access point and switch for a

217
00:07:19,400 --> 00:07:22,909
few employees who work out of an office

218
00:07:20,960 --> 00:07:25,099
otherwise the rest of their sales team

219
00:07:22,910 --> 00:07:26,870
about 400 agents who are working across

220
00:07:25,100 --> 00:07:28,430
the state we're all working on their end

221
00:07:26,870 --> 00:07:30,800
points their PCs their Mac's their

222
00:07:28,430 --> 00:07:32,720
mobile devices now we've got customer

223
00:07:30,800 --> 00:07:34,610
information which they handle property

224
00:07:32,720 --> 00:07:36,230
forms resident forms and information

225
00:07:34,610 --> 00:07:38,060
they've also got a ton of financial

226
00:07:36,230 --> 00:07:39,710
information about their clients and

227
00:07:38,060 --> 00:07:41,660
their tenants for paying rent paying

228
00:07:39,710 --> 00:07:43,969
property manner the property owners what

229
00:07:41,660 --> 00:07:46,070
they're owed escrow payments especially

230
00:07:43,970 --> 00:07:47,210
but they don't know that they have this

231
00:07:46,070 --> 00:07:50,360
information as far as they're concerned

232
00:07:47,210 --> 00:07:51,530
it all just lives in email so you might

233
00:07:50,360 --> 00:07:55,250
be seeing part of the problem here as

234
00:07:51,530 --> 00:07:56,869
well so farragut are all office 365

235
00:07:55,250 --> 00:07:59,780
client would effectively unmanage

236
00:07:56,870 --> 00:08:02,660
endpoints got fished in particular

237
00:07:59,780 --> 00:08:04,789
Amanda in finance got fished and like

238
00:08:02,660 --> 00:08:07,010
most victim orgs at first they didn't

239
00:08:04,790 --> 00:08:10,280
know they got fished they only

240
00:08:07,010 --> 00:08:12,890
discovered they got fished whoops my

241
00:08:10,280 --> 00:08:14,479
animations they only figured out they

242
00:08:12,890 --> 00:08:16,729
got fished when sending a wire transfer

243
00:08:14,480 --> 00:08:18,410
for the third time to a second new bank

244
00:08:16,730 --> 00:08:20,210
account for the same customer and

245
00:08:18,410 --> 00:08:22,370
decided no something doesn't seem right

246
00:08:20,210 --> 00:08:24,200
here which is good that's a good

247
00:08:22,370 --> 00:08:25,880
awareness to have but you can see by

248
00:08:24,200 --> 00:08:27,080
this point there's some damage which has

249
00:08:25,880 --> 00:08:30,110
already done some money's already gone

250
00:08:27,080 --> 00:08:31,609
out the door so they've already done an

251
00:08:30,110 --> 00:08:33,080
impressive amount of investigating by

252
00:08:31,610 --> 00:08:34,520
the time we go out and we meet with them

253
00:08:33,080 --> 00:08:36,140
by the time we're there they've already

254
00:08:34,520 --> 00:08:38,210
found the suspicious emails that and

255
00:08:36,140 --> 00:08:40,429
ahead Amanda had not sent but which were

256
00:08:38,210 --> 00:08:42,320
strangely in her sent items folder they

257
00:08:40,429 --> 00:08:44,030
spotted where the attacker was using

258
00:08:42,320 --> 00:08:46,010
different lingo in these emails they all

259
00:08:44,030 --> 00:08:48,920
ended with kindly and that's not how

260
00:08:46,010 --> 00:08:50,270
Amanda ends her emails and so we start

261
00:08:48,920 --> 00:08:51,530
diving into this with them they've got a

262
00:08:50,270 --> 00:08:52,790
phenomenal amount of paper trail

263
00:08:51,530 --> 00:08:54,020
evidence already they've got these

264
00:08:52,790 --> 00:08:55,910
printed emails they've got fake

265
00:08:54,020 --> 00:08:57,650
documents with forged signatures and

266
00:08:55,910 --> 00:08:59,180
bank account information that goes to

267
00:08:57,650 --> 00:09:01,100
strange bank accounts that nobody's ever

268
00:08:59,180 --> 00:09:02,719
seen before it's all ready and organized

269
00:09:01,100 --> 00:09:04,280
for us and we sit down with them yeah

270
00:09:02,720 --> 00:09:05,720
this was a great job fantastic

271
00:09:04,280 --> 00:09:06,949
they also had their bank stopped the

272
00:09:05,720 --> 00:09:10,850
wire transfers which were in progress

273
00:09:06,950 --> 00:09:12,470
also a very prudent step they had reset

274
00:09:10,850 --> 00:09:14,030
their bank passwords they had enabled

275
00:09:12,470 --> 00:09:15,470
mfa for their financial accounts and

276
00:09:14,030 --> 00:09:17,420
they had started resetting their office

277
00:09:15,470 --> 00:09:18,800
365 accounts so by the time we're

278
00:09:17,420 --> 00:09:20,030
talking with them I'm like you guys are

279
00:09:18,800 --> 00:09:22,160
doing great what do you need us for here

280
00:09:20,030 --> 00:09:24,439
but that's where they got stuck because

281
00:09:22,160 --> 00:09:25,790
after they had reset those passwords the

282
00:09:24,440 --> 00:09:27,530
attacker was still there they were still

283
00:09:25,790 --> 00:09:30,020
getting emails coming in from this bad

284
00:09:27,530 --> 00:09:39,740
actor so clearly the attacker had

285
00:09:30,020 --> 00:09:41,090
persistence inside the domain so they

286
00:09:39,740 --> 00:09:43,820
give us access to their as your ad

287
00:09:41,090 --> 00:09:46,400
environment we start investigating now

288
00:09:43,820 --> 00:09:48,350
there's one key detail here which is out

289
00:09:46,400 --> 00:09:57,020
of the norm for a realty agency in North

290
00:09:48,350 --> 00:09:58,400
Carolina who thinks they see it yeah

291
00:09:57,020 --> 00:09:59,150
this didn't look like North Carolina to

292
00:09:58,400 --> 00:10:01,040
me either

293
00:09:59,150 --> 00:10:03,380
now I actually didn't know where this

294
00:10:01,040 --> 00:10:05,780
was I had not heard of this and so we

295
00:10:03,380 --> 00:10:07,760
pop over to Bing it with Google and then

296
00:10:05,780 --> 00:10:09,470
we learned pretty quickly that no Sumi

297
00:10:07,760 --> 00:10:12,230
is in fact a long way from North

298
00:10:09,470 --> 00:10:15,920
Carolina but we keep digging and soon we

299
00:10:12,230 --> 00:10:19,550
see that's not the only problem now who

300
00:10:15,920 --> 00:10:23,750
thinks they see it come on hands up if

301
00:10:19,550 --> 00:10:25,490
you think you see it yep who uses Skype

302
00:10:23,750 --> 00:10:27,290
in a web browser that's just crazy we've

303
00:10:25,490 --> 00:10:28,580
got teams these days I mean what's

304
00:10:27,290 --> 00:10:30,469
what's going on here this is obviously

305
00:10:28,580 --> 00:10:31,940
bad I'm kidding of course because we

306
00:10:30,470 --> 00:10:36,440
know that London is nowhere near in

307
00:10:31,940 --> 00:10:38,390
North Carolina either so by this point

308
00:10:36,440 --> 00:10:40,010
we've got at least one account in a very

309
00:10:38,390 --> 00:10:41,569
critical position that's been owned from

310
00:10:40,010 --> 00:10:44,210
multiple locations that are very clearly

311
00:10:41,570 --> 00:10:45,710
not where the client is and we also know

312
00:10:44,210 --> 00:10:47,030
that just resetting passwords is not

313
00:10:45,710 --> 00:10:48,680
going to be enough to kick them out it

314
00:10:47,030 --> 00:10:50,750
didn't work once already so doing it

315
00:10:48,680 --> 00:10:52,130
again it's just not gonna work now as

316
00:10:50,750 --> 00:10:54,350
risk managers and incident responders

317
00:10:52,130 --> 00:10:56,150
part of what we do is we think about how

318
00:10:54,350 --> 00:10:58,130
bad could this get we're thinking about

319
00:10:56,150 --> 00:11:00,500
what are the risks that we could see

320
00:10:58,130 --> 00:11:02,240
here so we know that through the logs

321
00:11:00,500 --> 00:11:04,220
and compromised email accounts that

322
00:11:02,240 --> 00:11:05,810
malware could be a thing including

323
00:11:04,220 --> 00:11:07,790
remote access tools going onto these

324
00:11:05,810 --> 00:11:09,319
computers coming in through PDF email

325
00:11:07,790 --> 00:11:11,390
attachments with these these banking

326
00:11:09,320 --> 00:11:12,650
forms we know that they're at risk of

327
00:11:11,390 --> 00:11:14,330
losing financial and customer data

328
00:11:12,650 --> 00:11:16,370
because most of it lives inside their

329
00:11:14,330 --> 00:11:17,840
office 365 email accounts and this could

330
00:11:16,370 --> 00:11:19,190
be potentially a very bad day if

331
00:11:17,840 --> 00:11:20,990
a lot of people not just the business

332
00:11:19,190 --> 00:11:22,970
but also their clients their tenants and

333
00:11:20,990 --> 00:11:24,710
their property owners we know that the

334
00:11:22,970 --> 00:11:26,750
bad actors could have very interesting

335
00:11:24,710 --> 00:11:28,040
ways of sticking around and so I was

336
00:11:26,750 --> 00:11:30,320
concerned particularly about the

337
00:11:28,040 --> 00:11:31,790
potential for malware here having come

338
00:11:30,320 --> 00:11:33,500
through with those attachments so before

339
00:11:31,790 --> 00:11:35,660
we started doing any major remediation

340
00:11:33,500 --> 00:11:37,400
work any major cleanup work we had to

341
00:11:35,660 --> 00:11:38,959
analyze those emails we had to analyze

342
00:11:37,400 --> 00:11:40,670
those attachments because we needed to

343
00:11:38,960 --> 00:11:42,530
understand were they malicious or were

344
00:11:40,670 --> 00:11:45,290
they just forged documents and we needed

345
00:11:42,530 --> 00:11:47,270
to do it in a hurry now for malware

346
00:11:45,290 --> 00:11:49,280
analysis we could spin up something like

347
00:11:47,270 --> 00:11:50,840
flare VM or KooKoo sandbox and we could

348
00:11:49,280 --> 00:11:52,520
dive into it by hand these would work

349
00:11:50,840 --> 00:11:54,320
well these are great tools we use them a

350
00:11:52,520 --> 00:11:56,329
lot but they're not fast they're not

351
00:11:54,320 --> 00:11:57,560
quick like set it and forget it and go

352
00:11:56,330 --> 00:11:59,630
off and do a bunch of other work kind of

353
00:11:57,560 --> 00:12:01,369
fast with all of these tools you have to

354
00:11:59,630 --> 00:12:02,750
build the VM you got to deploy the tools

355
00:12:01,370 --> 00:12:04,550
you got to wait for it all to compile

356
00:12:02,750 --> 00:12:05,600
and install together you got to load the

357
00:12:04,550 --> 00:12:07,520
malware and then you got to do the

358
00:12:05,600 --> 00:12:08,480
analysis by hand you're the one loading

359
00:12:07,520 --> 00:12:10,520
them up you're the one doing the work

360
00:12:08,480 --> 00:12:12,500
there's a lot of streamlining automation

361
00:12:10,520 --> 00:12:14,780
in these but it's still a very manually

362
00:12:12,500 --> 00:12:16,730
laborious process we're talking hours if

363
00:12:14,780 --> 00:12:20,030
not days worth of analysis effort to do

364
00:12:16,730 --> 00:12:21,740
it right and to really be sure another

365
00:12:20,030 --> 00:12:23,329
option that investigators use quite

366
00:12:21,740 --> 00:12:25,640
commonly virustotal

367
00:12:23,330 --> 00:12:26,900
or hybrid analysis these services again

368
00:12:25,640 --> 00:12:28,310
they're fantastic and these two

369
00:12:26,900 --> 00:12:29,569
especially because they put them out

370
00:12:28,310 --> 00:12:31,040
there for free you don't even need an

371
00:12:29,570 --> 00:12:32,390
email account in order to throw a file

372
00:12:31,040 --> 00:12:33,920
up there and understand is this

373
00:12:32,390 --> 00:12:36,319
malicious has this been seen by

374
00:12:33,920 --> 00:12:37,490
antivirus agents before they'll take

375
00:12:36,320 --> 00:12:39,110
your file they'll run it through a whole

376
00:12:37,490 --> 00:12:40,460
bunch of scanning agents and VM types

377
00:12:39,110 --> 00:12:40,700
they'll tell you if the files up to no

378
00:12:40,460 --> 00:12:42,650
good

379
00:12:40,700 --> 00:12:44,540
did it try and phone home is a calling

380
00:12:42,650 --> 00:12:45,860
strange IP addresses and you know coming

381
00:12:44,540 --> 00:12:46,490
out of a text file or something you

382
00:12:45,860 --> 00:12:48,710
wouldn't expect

383
00:12:46,490 --> 00:12:52,790
I love these services but there's a

384
00:12:48,710 --> 00:12:53,510
catch by submitting your file to

385
00:12:52,790 --> 00:12:55,730
virustotal

386
00:12:53,510 --> 00:12:57,280
you are asking virustotal to share your

387
00:12:55,730 --> 00:12:59,930
submission with the security community

388
00:12:57,280 --> 00:13:01,579
now for Rando malicious emails with

389
00:12:59,930 --> 00:13:03,739
here's that zip file you didn't ask for

390
00:13:01,580 --> 00:13:06,140
that's not a big deal that's great for

391
00:13:03,740 --> 00:13:08,420
client data for banking information for

392
00:13:06,140 --> 00:13:11,030
private or protected information this

393
00:13:08,420 --> 00:13:11,740
doesn't fly but hey we have good news

394
00:13:11,030 --> 00:13:15,020
everybody

395
00:13:11,740 --> 00:13:16,790
Microsoft had an app for that turns out

396
00:13:15,020 --> 00:13:18,110
this service is fantastic because not

397
00:13:16,790 --> 00:13:21,050
only can you submit this file to

398
00:13:18,110 --> 00:13:22,640
Microsoft for analysis and not only is

399
00:13:21,050 --> 00:13:24,709
as Microsoft providing a critical

400
00:13:22,640 --> 00:13:26,540
security function to another Microsoft

401
00:13:24,710 --> 00:13:29,510
customer remembering this tenant as part

402
00:13:26,540 --> 00:13:31,130
of office 365 but you can specify when

403
00:13:29,510 --> 00:13:32,960
the file gets scrubbed

404
00:13:31,130 --> 00:13:34,820
now as a compliance guy who has written

405
00:13:32,960 --> 00:13:36,350
more than a few audit reports where have

406
00:13:34,820 --> 00:13:39,560
dinged people about record retentions

407
00:13:36,350 --> 00:13:40,760
problems this is fantastic so we

408
00:13:39,560 --> 00:13:42,109
submitted the emails through this

409
00:13:40,760 --> 00:13:43,580
service we bundle them all up together

410
00:13:42,110 --> 00:13:45,200
and we send them off in a package in

411
00:13:43,580 --> 00:13:47,270
about six hours later we get a report

412
00:13:45,200 --> 00:13:49,370
back saying yep hey all clear not only

413
00:13:47,270 --> 00:13:51,260
did we run it through the ATP analysis

414
00:13:49,370 --> 00:13:53,120
service we had an analyst take a look

415
00:13:51,260 --> 00:13:54,710
over the findings the analysts confirmed

416
00:13:53,120 --> 00:13:56,810
there was nothing funky going on there

417
00:13:54,710 --> 00:13:58,610
it turns out they're just PDFs with

418
00:13:56,810 --> 00:14:00,560
phony signatures so this wasn't a very

419
00:13:58,610 --> 00:14:02,330
sophisticated attack they weren't going

420
00:14:00,560 --> 00:14:04,819
for a technical intrusion they were

421
00:14:02,330 --> 00:14:06,710
trying to leverage business processes it

422
00:14:04,820 --> 00:14:11,500
was business email compromised in the

423
00:14:06,710 --> 00:14:14,150
traditional sense so now we move on to

424
00:14:11,500 --> 00:14:15,710
remediation because we know that

425
00:14:14,150 --> 00:14:17,329
changing passwords wasn't going to work

426
00:14:15,710 --> 00:14:20,060
we had to hit him with a one-two-three

427
00:14:17,330 --> 00:14:21,590
punch so we went user by user and we

428
00:14:20,060 --> 00:14:23,449
started dropping all of the active

429
00:14:21,590 --> 00:14:24,890
sessions in progress and then once the

430
00:14:23,450 --> 00:14:26,900
sessions were dumped we reset

431
00:14:24,890 --> 00:14:28,610
everybody's passwords and then we helped

432
00:14:26,900 --> 00:14:30,319
Farragut roll out MFA to all their

433
00:14:28,610 --> 00:14:33,230
employees because MFA's not just a good

434
00:14:30,320 --> 00:14:34,730
idea it's a great idea some other

435
00:14:33,230 --> 00:14:36,320
controls that we put in place included

436
00:14:34,730 --> 00:14:38,420
conditional access policies so this

437
00:14:36,320 --> 00:14:39,650
limits logins to just the u.s. so we're

438
00:14:38,420 --> 00:14:41,329
kicking out all the year international

439
00:14:39,650 --> 00:14:43,400
users who don't actually work for the

440
00:14:41,330 --> 00:14:45,290
company and even though the emails came

441
00:14:43,400 --> 00:14:47,090
back clean we took a bunch of time and

442
00:14:45,290 --> 00:14:48,410
we scanned all the endpoints for safety

443
00:14:47,090 --> 00:14:49,940
we wanted to make sure there really was

444
00:14:48,410 --> 00:14:51,140
no viruses or malware running in there

445
00:14:49,940 --> 00:14:52,610
and then we did some follow-up

446
00:14:51,140 --> 00:14:54,080
monitoring and watch there Azura

447
00:14:52,610 --> 00:14:55,640
environment for a few months checking

448
00:14:54,080 --> 00:14:56,960
the out audit logs and making sure that

449
00:14:55,640 --> 00:14:58,880
everything was on the up and up before

450
00:14:56,960 --> 00:15:00,200
we gave them the all-clear fortunately

451
00:14:58,880 --> 00:15:01,939
this one resolves pretty quickly and

452
00:15:00,200 --> 00:15:03,650
easily once we kicked out the intruders

453
00:15:01,940 --> 00:15:05,660
we were able to confirm that nope

454
00:15:03,650 --> 00:15:07,400
everything's looking good and they saw

455
00:15:05,660 --> 00:15:10,250
all the funny business take care take

456
00:15:07,400 --> 00:15:12,290
care of itself so looking back at this

457
00:15:10,250 --> 00:15:14,600
one this gig was a blend of mail sample

458
00:15:12,290 --> 00:15:16,730
and log analysis on-premise endpoint

459
00:15:14,600 --> 00:15:19,070
scanning and helping to implement global

460
00:15:16,730 --> 00:15:21,560
technical controls on their office 365

461
00:15:19,070 --> 00:15:23,090
environment we use all cloud services

462
00:15:21,560 --> 00:15:24,680
for everything except the endpoint

463
00:15:23,090 --> 00:15:27,140
scanning that was all its effectively

464
00:15:24,680 --> 00:15:28,640
unmanaged it wasn't centralized AV but

465
00:15:27,140 --> 00:15:30,620
again this is a small company we're

466
00:15:28,640 --> 00:15:32,120
talking five administrative staff none

467
00:15:30,620 --> 00:15:33,530
of whom are IT none of whom are

468
00:15:32,120 --> 00:15:35,570
technical they're business people

469
00:15:33,530 --> 00:15:37,069
they're property managers all they know

470
00:15:35,570 --> 00:15:39,620
is that they paid GoDaddy every month

471
00:15:37,070 --> 00:15:42,730
and the email kept going until they got

472
00:15:39,620 --> 00:15:42,730
hacked from across the planet

473
00:15:43,130 --> 00:15:47,390
so onto incident number three incident

474
00:15:45,920 --> 00:15:50,270
number three is with Sky Heart

475
00:15:47,390 --> 00:15:52,130
University this guy hurt University had

476
00:15:50,270 --> 00:15:53,720
a fishing event in their office 365

477
00:15:52,130 --> 00:15:55,580
email environment very similar to

478
00:15:53,720 --> 00:15:56,900
Farragut a staff member click the link

479
00:15:55,580 --> 00:15:58,100
credentials got stolen and some bad

480
00:15:56,900 --> 00:15:59,780
stuff happen but they didn't actually

481
00:15:58,100 --> 00:16:01,370
call us in for this one they handled

482
00:15:59,780 --> 00:16:02,990
that side of the incident already we

483
00:16:01,370 --> 00:16:04,730
weren't involved there but what they did

484
00:16:02,990 --> 00:16:06,620
want is an outside look at their

485
00:16:04,730 --> 00:16:08,480
on-premise data center environment about

486
00:16:06,620 --> 00:16:10,460
800 servers or so that they needed to

487
00:16:08,480 --> 00:16:11,960
make sure we're free of malware because

488
00:16:10,460 --> 00:16:13,490
they didn't want something bad to happen

489
00:16:11,960 --> 00:16:16,640
on probably the biggest business day of

490
00:16:13,490 --> 00:16:19,160
the year and we knew this was going to

491
00:16:16,640 --> 00:16:21,890
be a tricky one because how could we

492
00:16:19,160 --> 00:16:23,959
scan 800 servers in an active production

493
00:16:21,890 --> 00:16:26,030
data center across the country far far

494
00:16:23,960 --> 00:16:28,520
away looking everywhere that malware

495
00:16:26,030 --> 00:16:30,199
might hide without burning time building

496
00:16:28,520 --> 00:16:31,460
tools which probably already existed

497
00:16:30,200 --> 00:16:33,650
they didn't want to pay us to reinvent

498
00:16:31,460 --> 00:16:35,780
the wheel and so we talked about some

499
00:16:33,650 --> 00:16:37,520
ideas including using a self-contained

500
00:16:35,780 --> 00:16:39,230
anti-virus package something that could

501
00:16:37,520 --> 00:16:41,360
live inside of a folder wouldn't require

502
00:16:39,230 --> 00:16:42,860
being installed but that could run on

503
00:16:41,360 --> 00:16:44,510
these computers could then dump the

504
00:16:42,860 --> 00:16:46,190
output to a text file and we could

505
00:16:44,510 --> 00:16:47,960
gather up all the output data and we

506
00:16:46,190 --> 00:16:50,150
could do a manual analysis or we could

507
00:16:47,960 --> 00:16:51,410
sort them and sift through them but we

508
00:16:50,150 --> 00:16:53,569
wouldn't necessarily see something

509
00:16:51,410 --> 00:16:55,400
unique what we would see is an antivirus

510
00:16:53,570 --> 00:16:56,660
agent saying yep nope we're good or hey

511
00:16:55,400 --> 00:17:00,020
I found something you might want to look

512
00:16:56,660 --> 00:17:02,689
at this so we talked about it with our

513
00:17:00,020 --> 00:17:04,189
offensive security team and we realized

514
00:17:02,690 --> 00:17:06,410
that they could threat model methods

515
00:17:04,189 --> 00:17:08,360
that they would employ to put something

516
00:17:06,410 --> 00:17:09,949
like a timed logic bomb on a network and

517
00:17:08,359 --> 00:17:11,329
we could use those models as a

518
00:17:09,949 --> 00:17:12,890
jumping-off point so we would

519
00:17:11,329 --> 00:17:14,659
essentially say hey how would you guys

520
00:17:12,890 --> 00:17:16,520
hack this how would you do this and then

521
00:17:14,660 --> 00:17:19,040
we could use that to continue moving

522
00:17:16,520 --> 00:17:21,079
into our threat hunting scenario but

523
00:17:19,040 --> 00:17:22,220
both of those options the antivirus and

524
00:17:21,079 --> 00:17:24,319
the custom threat hunting there's

525
00:17:22,220 --> 00:17:25,699
super-complex they're highly customized

526
00:17:24,319 --> 00:17:27,709
and they would have a high probability

527
00:17:25,699 --> 00:17:30,260
of missing something very critical or

528
00:17:27,709 --> 00:17:31,610
unique to this particular attack but as

529
00:17:30,260 --> 00:17:33,379
we were working through this something

530
00:17:31,610 --> 00:17:35,000
happened I got a call about an internal

531
00:17:33,380 --> 00:17:37,010
control issue which came up that needed

532
00:17:35,000 --> 00:17:38,780
eyes on it so I hopped over to our

533
00:17:37,010 --> 00:17:40,160
defender ATP instance which we had

534
00:17:38,780 --> 00:17:41,600
rolled out internally some time before

535
00:17:40,160 --> 00:17:43,340
to take a look at whatever was going on

536
00:17:41,600 --> 00:17:44,899
and again this is our computers on our

537
00:17:43,340 --> 00:17:46,310
network that I'm looking at it was a

538
00:17:44,900 --> 00:17:46,610
false positive that day that was no big

539
00:17:46,310 --> 00:17:48,950
deal

540
00:17:46,610 --> 00:17:51,080
but as I'm doing this it hit me what I

541
00:17:48,950 --> 00:17:52,940
was looking at and in this moment I

542
00:17:51,080 --> 00:17:54,649
literally have one proposal scope of

543
00:17:52,940 --> 00:17:56,600
work up on one screen and I've got ATP

544
00:17:54,650 --> 00:17:57,740
up on the other eye

545
00:17:56,600 --> 00:17:59,570
we realized that I was staring at a

546
00:17:57,740 --> 00:18:02,420
cloud-based telemetry threat hunting

547
00:17:59,570 --> 00:18:04,129
system baked into office 365 integer

548
00:18:02,420 --> 00:18:06,230
which we know that they were already at

549
00:18:04,130 --> 00:18:07,820
least partly tied into and we in

550
00:18:06,230 --> 00:18:09,590
particular had rolled it out to all of

551
00:18:07,820 --> 00:18:11,990
our computers with a simple PowerShell

552
00:18:09,590 --> 00:18:14,270
script it was super easy to roll out and

553
00:18:11,990 --> 00:18:17,390
it gave us remarkably rich data for all

554
00:18:14,270 --> 00:18:19,220
told very little effort it gives you

555
00:18:17,390 --> 00:18:21,410
insanely great threat hunting

556
00:18:19,220 --> 00:18:23,060
capabilities again for actual actually

557
00:18:21,410 --> 00:18:24,440
very little labor effort compared to

558
00:18:23,060 --> 00:18:27,139
deploying something like a sim or a

559
00:18:24,440 --> 00:18:28,910
whole new antivirus environment to 800

560
00:18:27,140 --> 00:18:30,530
servers and again we had to make sure

561
00:18:28,910 --> 00:18:32,090
that we didn't reboot these servers now

562
00:18:30,530 --> 00:18:34,010
I don't know any antivirus agent you can

563
00:18:32,090 --> 00:18:35,720
deployed 800 systems without rebooting

564
00:18:34,010 --> 00:18:36,740
at least one of them and in our case

565
00:18:35,720 --> 00:18:39,050
that was probably gonna be something

566
00:18:36,740 --> 00:18:40,670
critical like a domain controller so we

567
00:18:39,050 --> 00:18:43,820
reach back out to sky heart and we say

568
00:18:40,670 --> 00:18:47,630
hey we know you guys have office 365 but

569
00:18:43,820 --> 00:18:49,820
do you have ATP here a voice on the

570
00:18:47,630 --> 00:18:50,930
other end of the line go yeah they

571
00:18:49,820 --> 00:18:52,730
weren't sure where we were going with

572
00:18:50,930 --> 00:18:54,260
this because all they had seen was ATP

573
00:18:52,730 --> 00:18:56,480
working at the domain level covering

574
00:18:54,260 --> 00:18:59,420
things like email anti-phishing and safe

575
00:18:56,480 --> 00:19:01,780
links scanning so I say are your servers

576
00:18:59,420 --> 00:19:04,880
running Windows Defender by any chance

577
00:19:01,780 --> 00:19:05,870
yeah most of them actually so we talked

578
00:19:04,880 --> 00:19:07,730
with them about what this could look

579
00:19:05,870 --> 00:19:09,379
like they would push a simple PowerShell

580
00:19:07,730 --> 00:19:11,240
script out to their servers it starts

581
00:19:09,380 --> 00:19:13,160
sending the defender telemetry up to ATP

582
00:19:11,240 --> 00:19:14,870
and then we can go spelunking through

583
00:19:13,160 --> 00:19:16,130
the data to find malware that might or

584
00:19:14,870 --> 00:19:18,620
might not be hidden on their servers

585
00:19:16,130 --> 00:19:19,880
that's all inside the browser there

586
00:19:18,620 --> 00:19:21,469
wouldn't even need to be a VPN

587
00:19:19,880 --> 00:19:22,670
connection back over to their their data

588
00:19:21,470 --> 00:19:24,380
center because it would handle the

589
00:19:22,670 --> 00:19:25,820
rollout there and so we would be able to

590
00:19:24,380 --> 00:19:28,520
look at all the data that we needed to

591
00:19:25,820 --> 00:19:30,230
from the comfort of our desks right in a

592
00:19:28,520 --> 00:19:32,620
web browser this this is phenomenal the

593
00:19:30,230 --> 00:19:34,820
the future in this instance is amazing

594
00:19:32,620 --> 00:19:36,739
so we talked them through this and they

595
00:19:34,820 --> 00:19:38,450
push out the the no reboot PowerShell

596
00:19:36,740 --> 00:19:40,010
script to their system and then we get

597
00:19:38,450 --> 00:19:44,060
to go swim in a data Lake without even

598
00:19:40,010 --> 00:19:46,040
leaving our chairs fortunately most of

599
00:19:44,060 --> 00:19:47,860
the search queries that we ran came back

600
00:19:46,040 --> 00:19:50,090
like this so we could verify that their

601
00:19:47,860 --> 00:19:52,070
product like it was untouched that

602
00:19:50,090 --> 00:19:54,350
appeared in this instance the incident

603
00:19:52,070 --> 00:19:56,720
was limited to fishing within office 365

604
00:19:54,350 --> 00:19:59,379
and the hallowed halls of higher

605
00:19:56,720 --> 00:20:02,030
education remained open yet another day

606
00:19:59,380 --> 00:20:03,470
so looking back at this one we had

607
00:20:02,030 --> 00:20:04,910
several options for how to achieve this

608
00:20:03,470 --> 00:20:06,800
some were super complex and technical

609
00:20:04,910 --> 00:20:09,740
some were very straightforward and high

610
00:20:06,800 --> 00:20:10,040
level but only one was quick easy loads

611
00:20:09,740 --> 00:20:11,930
for

612
00:20:10,040 --> 00:20:14,149
and gave us a ridiculous amount of data

613
00:20:11,930 --> 00:20:16,250
that we could ask super broad or very

614
00:20:14,150 --> 00:20:18,080
refined questions of all without

615
00:20:16,250 --> 00:20:20,030
requiring travel which we would have to

616
00:20:18,080 --> 00:20:22,370
bill for thus increasing client costs

617
00:20:20,030 --> 00:20:24,680
and so this to me is the direction that

618
00:20:22,370 --> 00:20:27,229
Incident Response is going I don't care

619
00:20:24,680 --> 00:20:29,270
if you're on a juror AWS Google Cloud

620
00:20:27,230 --> 00:20:31,760
Salesforce or whatever your platform is

621
00:20:29,270 --> 00:20:33,800
the data necessary for incident response

622
00:20:31,760 --> 00:20:35,930
and investigations is shifting from

623
00:20:33,800 --> 00:20:37,879
on-premise systems up to those cloud

624
00:20:35,930 --> 00:20:40,700
environments now that's both good and

625
00:20:37,880 --> 00:20:42,950
bad it's good because it means that you

626
00:20:40,700 --> 00:20:44,720
can quickly and easily get huge amounts

627
00:20:42,950 --> 00:20:46,940
of data from large numbers of systems

628
00:20:44,720 --> 00:20:49,430
and you can ask big questions of that

629
00:20:46,940 --> 00:20:51,470
data without trying very hard you don't

630
00:20:49,430 --> 00:20:53,300
need to go and ask ten thousand servers

631
00:20:51,470 --> 00:20:54,980
individual questions and then sift

632
00:20:53,300 --> 00:20:56,840
through ten thousand answers you can ask

633
00:20:54,980 --> 00:20:58,070
one database one question and you can

634
00:20:56,840 --> 00:21:00,439
see all the servers that you need to be

635
00:20:58,070 --> 00:21:02,419
concerned about these logs are also

636
00:21:00,440 --> 00:21:03,650
stored in systems which can be very

637
00:21:02,420 --> 00:21:05,750
difficult for an attacker to reach

638
00:21:03,650 --> 00:21:07,880
meaning the actual log evidence itself

639
00:21:05,750 --> 00:21:10,580
can be protected from tampering or a

640
00:21:07,880 --> 00:21:11,780
deletion and especially when you look at

641
00:21:10,580 --> 00:21:13,790
this against something like a syslog

642
00:21:11,780 --> 00:21:15,980
server which is just storing local text

643
00:21:13,790 --> 00:21:17,899
files on a file server we also have Sims

644
00:21:15,980 --> 00:21:19,990
which are using big database servers and

645
00:21:17,900 --> 00:21:22,580
systems but those are ultimately

646
00:21:19,990 --> 00:21:24,260
potentially reachable by an attacker and

647
00:21:22,580 --> 00:21:25,870
they could be edited or modified which

648
00:21:24,260 --> 00:21:28,010
would spoil evidence and make

649
00:21:25,870 --> 00:21:30,590
investigations even further further

650
00:21:28,010 --> 00:21:33,320
difficult but it also means that systems

651
00:21:30,590 --> 00:21:35,030
like ATP can use the data in telemetry

652
00:21:33,320 --> 00:21:36,950
coming out from endpoint agents that are

653
00:21:35,030 --> 00:21:39,410
already widely in use like Windows

654
00:21:36,950 --> 00:21:41,480
Defender so we don't need to install yet

655
00:21:39,410 --> 00:21:42,860
another endpoint agent on some systems

656
00:21:41,480 --> 00:21:44,690
which are probably already overloaded

657
00:21:42,860 --> 00:21:47,500
just running line of business types of

658
00:21:44,690 --> 00:21:50,690
apps so this is great this is fantastic

659
00:21:47,500 --> 00:21:52,910
but there's a shadow side to this it's

660
00:21:50,690 --> 00:21:54,320
bad because it means that not only is

661
00:21:52,910 --> 00:21:56,120
each system a little different the

662
00:21:54,320 --> 00:21:58,340
differences between us your Google Cloud

663
00:21:56,120 --> 00:21:59,659
or AWS the functions are all very

664
00:21:58,340 --> 00:22:01,340
similar but the ways that they're going

665
00:21:59,660 --> 00:22:01,880
about it are all very different from

666
00:22:01,340 --> 00:22:04,550
each other

667
00:22:01,880 --> 00:22:06,560
the data can also be hard to extract

668
00:22:04,550 --> 00:22:08,570
like when you need a lot of data for a

669
00:22:06,560 --> 00:22:10,760
big client who's generating way more

670
00:22:08,570 --> 00:22:14,840
than 50 thousand events per day this can

671
00:22:10,760 --> 00:22:16,220
be problematic for investigators now it

672
00:22:14,840 --> 00:22:18,649
also means that clients and customers

673
00:22:16,220 --> 00:22:20,480
have to push buttons and turn knobs in

674
00:22:18,650 --> 00:22:21,920
order to stop Ukraine from being able to

675
00:22:20,480 --> 00:22:24,470
log into their email in north

676
00:22:21,920 --> 00:22:27,590
Carolina or to get signals and alerts

677
00:22:24,470 --> 00:22:30,260
from Azure to ATP to power bi and back

678
00:22:27,590 --> 00:22:31,850
again it also means that small

679
00:22:30,260 --> 00:22:34,100
businesses who are using these platforms

680
00:22:31,850 --> 00:22:36,260
and who probably don't have much in the

681
00:22:34,100 --> 00:22:38,540
way of IT staff let alone security staff

682
00:22:36,260 --> 00:22:40,940
they don't know what they don't know

683
00:22:38,540 --> 00:22:42,520
they just know they pay a bill the email

684
00:22:40,940 --> 00:22:44,390
comes and business keeps turning

685
00:22:42,520 --> 00:22:47,150
sometimes they only realize what they

686
00:22:44,390 --> 00:22:50,150
don't know after they get hacked now

687
00:22:47,150 --> 00:22:53,390
I've got one more quick story going back

688
00:22:50,150 --> 00:22:55,700
to stargazer so stargazer already had

689
00:22:53,390 --> 00:22:57,350
office 365 and they decided to turn on

690
00:22:55,700 --> 00:22:59,780
ATP for their domain so they were

691
00:22:57,350 --> 00:23:02,780
running the email scanning and the safe

692
00:22:59,780 --> 00:23:04,520
link scanning they knew that it could do

693
00:23:02,780 --> 00:23:06,800
more but they weren't exactly sure how

694
00:23:04,520 --> 00:23:08,750
they also wanted to know every time

695
00:23:06,800 --> 00:23:11,300
somebody on one of their endpoints ran

696
00:23:08,750 --> 00:23:13,040
an installer or any exe they were very

697
00:23:11,300 --> 00:23:14,600
concerned about apps that ran only in

698
00:23:13,040 --> 00:23:18,139
user land and did not require

699
00:23:14,600 --> 00:23:19,850
administrative credentials to install so

700
00:23:18,140 --> 00:23:21,320
we showed them defender ATP and the

701
00:23:19,850 --> 00:23:23,179
telemetry and all the data it provides

702
00:23:21,320 --> 00:23:24,649
and we walked them through what this can

703
00:23:23,180 --> 00:23:26,750
look like during investigations and

704
00:23:24,650 --> 00:23:29,240
remediation and the very rich data set

705
00:23:26,750 --> 00:23:30,680
that it provides then we showed them the

706
00:23:29,240 --> 00:23:33,080
PowerShell script to deploy it

707
00:23:30,680 --> 00:23:34,730
so whoops excuse me we showed them the

708
00:23:33,080 --> 00:23:36,169
PowerShell script to deploy it the one

709
00:23:34,730 --> 00:23:37,640
that Microsoft makes nice and easy and

710
00:23:36,170 --> 00:23:39,350
pre packages for you to download and

711
00:23:37,640 --> 00:23:41,660
they loved it they loved the whole idea

712
00:23:39,350 --> 00:23:42,830
so just like with Sky Heart University

713
00:23:41,660 --> 00:23:44,030
we walked them through deploying this

714
00:23:42,830 --> 00:23:46,760
and then we showed them the threat

715
00:23:44,030 --> 00:23:49,639
hunting console now this was the the big

716
00:23:46,760 --> 00:23:51,350
moment for me here the day after they

717
00:23:49,640 --> 00:23:52,760
had pushed this PowerShell script out to

718
00:23:51,350 --> 00:23:54,320
all of their computers and again this is

719
00:23:52,760 --> 00:23:56,060
a Salesforce which is distributed across

720
00:23:54,320 --> 00:23:58,580
the country the better part of 800 or so

721
00:23:56,060 --> 00:24:02,330
people including some on-premise systems

722
00:23:58,580 --> 00:24:04,909
but mostly field users one person from a

723
00:24:02,330 --> 00:24:07,550
four-person IT team of which two were

724
00:24:04,910 --> 00:24:09,080
actually helpdesk this one individual

725
00:24:07,550 --> 00:24:11,270
starts digging around through telemetry

726
00:24:09,080 --> 00:24:12,620
from their full environment to find

727
00:24:11,270 --> 00:24:14,960
events in their network that were going

728
00:24:12,620 --> 00:24:16,969
to be a threat to their operations that

729
00:24:14,960 --> 00:24:19,160
to me is the future of security that we

730
00:24:16,970 --> 00:24:20,720
should all be driving for and so with

731
00:24:19,160 --> 00:24:22,190
that on behalf of myself from the team

732
00:24:20,720 --> 00:24:23,960
at CI security I'd like to say a very

733
00:24:22,190 --> 00:24:25,790
special thank you to Kimberly grace

734
00:24:23,960 --> 00:24:27,440
Microsoft and the blue hat team for

735
00:24:25,790 --> 00:24:28,760
inviting me today and I'd like to thank

736
00:24:27,440 --> 00:24:30,620
you all for your time and attention day

737
00:24:28,760 --> 00:24:31,490
it is truly an honor to be here and I

738
00:24:30,620 --> 00:24:34,989
hope you enjoy the rest of the

739
00:24:31,490 --> 00:24:34,990
presentations thank you

740
00:24:37,760 --> 00:24:39,820
you

