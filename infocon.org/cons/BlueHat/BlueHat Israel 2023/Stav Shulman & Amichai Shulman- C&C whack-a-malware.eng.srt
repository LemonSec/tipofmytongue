1
00:00:00,000 --> 00:00:08,700
[Music]

2
00:00:09,679 --> 00:00:11,440
thank you

3
00:00:11,440 --> 00:00:13,440
[Music]

4
00:00:13,440 --> 00:00:16,020
hello everyone Welcome to our session

5
00:00:16,020 --> 00:00:20,100
welcome malware my name is Shulman and

6
00:00:20,100 --> 00:00:21,900
I'm honored to share the stage with

7
00:00:21,900 --> 00:00:24,799
staff Schulman

8
00:00:25,080 --> 00:00:28,920
we will be telling you today about very

9
00:00:28,920 --> 00:00:32,880
resilient botnets that never die

10
00:00:32,880 --> 00:00:36,239
we'll start our session with a little

11
00:00:36,239 --> 00:00:39,840
bit of motivation for our research and

12
00:00:39,840 --> 00:00:41,460
then we'll dive into a short

13
00:00:41,460 --> 00:00:44,100
introduction to botnet and how we are

14
00:00:44,100 --> 00:00:46,260
fighting them today

15
00:00:46,260 --> 00:00:49,920
then we will show you the botnets that

16
00:00:49,920 --> 00:00:52,559
never die and we'll talk a little bit

17
00:00:52,559 --> 00:00:54,660
about further research and some

18
00:00:54,660 --> 00:00:56,340
conclusions

19
00:00:56,340 --> 00:00:59,340
so without further Ado why did we go

20
00:00:59,340 --> 00:01:02,760
after botnets and the reason is that

21
00:01:02,760 --> 00:01:07,220
modern cyber crime at scale requires

22
00:01:07,220 --> 00:01:11,640
botnet whether you want to just ditto

23
00:01:11,640 --> 00:01:16,140
someone or launch a carding attack or a

24
00:01:16,140 --> 00:01:18,600
credential stuffing attack or or even

25
00:01:18,600 --> 00:01:21,479
play an SQL injection and you want to do

26
00:01:21,479 --> 00:01:23,880
it at scale you need a functioning

27
00:01:23,880 --> 00:01:25,500
botnet

28
00:01:25,500 --> 00:01:28,320
so there are organizations and

29
00:01:28,320 --> 00:01:31,500
individuals out there that make a living

30
00:01:31,500 --> 00:01:34,500
out of creating those botnets

31
00:01:34,500 --> 00:01:37,079
maintaining them and either using them

32
00:01:37,079 --> 00:01:40,380
for their own operations or renting

33
00:01:40,380 --> 00:01:43,079
pieces of them for other people other

34
00:01:43,079 --> 00:01:46,200
organizations for their operations

35
00:01:46,200 --> 00:01:50,220
and it seems that these robust botnets

36
00:01:50,220 --> 00:01:54,420
are the key to the success or failure of

37
00:01:54,420 --> 00:01:57,560
cyber crime operations

38
00:01:57,960 --> 00:01:59,540
so

39
00:01:59,540 --> 00:02:01,860
researchers figured out that

40
00:02:01,860 --> 00:02:05,040
neutralizing a botnet is practically

41
00:02:05,040 --> 00:02:08,580
destroying the operations so the

42
00:02:08,580 --> 00:02:11,819
question we came up with is can we build

43
00:02:11,819 --> 00:02:15,239
a botnet that survives neutralizing

44
00:02:15,239 --> 00:02:19,680
and can this resilient botnet be cost

45
00:02:19,680 --> 00:02:21,000
effective

46
00:02:21,000 --> 00:02:22,620
and of course the biggest question of

47
00:02:22,620 --> 00:02:24,060
all can the father and daughter

48
00:02:24,060 --> 00:02:26,819
relationship survive this joint research

49
00:02:26,819 --> 00:02:27,440
okay

50
00:02:27,440 --> 00:02:30,239
[Applause]

51
00:02:30,239 --> 00:02:32,879
to begin our journey I would like to

52
00:02:32,879 --> 00:02:35,099
start with giving a bit of background on

53
00:02:35,099 --> 00:02:37,140
something that is very near and dear to

54
00:02:37,140 --> 00:02:40,379
my heart malware infrastructures

55
00:02:40,379 --> 00:02:43,319
during my day today as a researcher I

56
00:02:43,319 --> 00:02:45,480
happened to stumble upon a very broad

57
00:02:45,480 --> 00:02:47,400
range of different thread actors

58
00:02:47,400 --> 00:02:50,099
utilizing different malwares and

59
00:02:50,099 --> 00:02:52,319
implementing different approaches for

60
00:02:52,319 --> 00:02:56,400
cncs generally speaking I think we can

61
00:02:56,400 --> 00:02:59,160
take all of them and divide into three

62
00:02:59,160 --> 00:03:02,280
main difficulty level of infrastructure

63
00:03:02,280 --> 00:03:03,840
implementations

64
00:03:03,840 --> 00:03:07,260
the very first one is obviously the one

65
00:03:07,260 --> 00:03:10,080
that's most basic and thread actor is

66
00:03:10,080 --> 00:03:13,019
using this level would rely on domain

67
00:03:13,019 --> 00:03:15,720
names they will have to acquire

68
00:03:15,720 --> 00:03:18,300
dedicated domain names or that they can

69
00:03:18,300 --> 00:03:20,700
abuse some compromised infrastructure

70
00:03:20,700 --> 00:03:23,879
they got access to in order to manually

71
00:03:23,879 --> 00:03:27,360
maintain a pool of servers they will

72
00:03:27,360 --> 00:03:29,940
initially deliver these servers inside

73
00:03:29,940 --> 00:03:32,340
victims environment by literally

74
00:03:32,340 --> 00:03:35,159
embedding them inside mild or binary

75
00:03:35,159 --> 00:03:38,280
samples or inside dedicated config files

76
00:03:38,280 --> 00:03:41,280
that will come with these malwares

77
00:03:41,280 --> 00:03:44,459
now for threat actors to choose this

78
00:03:44,459 --> 00:03:47,700
approach even though it's basic they

79
00:03:47,700 --> 00:03:49,680
still have a little bit of range of

80
00:03:49,680 --> 00:03:52,739
motion because they can do things like

81
00:03:52,739 --> 00:03:55,200
update their pull of domains from time

82
00:03:55,200 --> 00:03:58,319
to time but they will have to do so by

83
00:03:58,319 --> 00:04:00,120
relying on an already known and

84
00:04:00,120 --> 00:04:02,760
functioning domain

85
00:04:02,760 --> 00:04:06,360
now the second level of difficulty is

86
00:04:06,360 --> 00:04:08,400
for threat actors still relying on

87
00:04:08,400 --> 00:04:10,980
domain names but kind of wake up in the

88
00:04:10,980 --> 00:04:14,220
morning feeling a tad more creative and

89
00:04:14,220 --> 00:04:17,880
they will usually use dgas now a domain

90
00:04:17,880 --> 00:04:20,220
generation algorithm means that inside

91
00:04:20,220 --> 00:04:23,220
the malware instead of finding a pool of

92
00:04:23,220 --> 00:04:26,240
servers will encounter just one function

93
00:04:26,240 --> 00:04:29,639
and this function will contain a pattern

94
00:04:29,639 --> 00:04:32,280
then a set of prefixes symbols and

95
00:04:32,280 --> 00:04:34,680
characters that will be used to Generate

96
00:04:34,680 --> 00:04:37,199
random domain names during the malware's

97
00:04:37,199 --> 00:04:39,900
execution meaning that we can't actually

98
00:04:39,900 --> 00:04:42,180
predict which domain is going to be used

99
00:04:42,180 --> 00:04:43,919
next

100
00:04:43,919 --> 00:04:47,759
now I believe that the most advanced

101
00:04:47,759 --> 00:04:50,400
practice that we currently experience in

102
00:04:50,400 --> 00:04:53,580
the wild is thread groups that

103
00:04:53,580 --> 00:04:56,580
completely ditch the use of these domain

104
00:04:56,580 --> 00:04:59,400
names and move forward for utilizing

105
00:04:59,400 --> 00:05:02,040
completely publicly available legitimate

106
00:05:02,040 --> 00:05:04,440
services and utilities for their

107
00:05:04,440 --> 00:05:06,180
malicious infrastructures

108
00:05:06,180 --> 00:05:09,900
so we see actors that rely on social

109
00:05:09,900 --> 00:05:13,440
media platforms for creating malicious

110
00:05:13,440 --> 00:05:15,840
profiles in places like Facebook Twitter

111
00:05:15,840 --> 00:05:18,900
or Instagram to deliver their malicious

112
00:05:18,900 --> 00:05:21,780
content using that we see attackers

113
00:05:21,780 --> 00:05:24,840
abuse cloud-based file share services so

114
00:05:24,840 --> 00:05:27,660
things like Google Drive and Dropbox

115
00:05:27,660 --> 00:05:30,840
and we even see a rise of threat groups

116
00:05:30,840 --> 00:05:33,960
that take completely legitimate

117
00:05:33,960 --> 00:05:37,139
utilities so things like Remote Control

118
00:05:37,139 --> 00:05:40,080
software that was originally intended

119
00:05:40,080 --> 00:05:42,960
for I.T Personnel for instance to tackle

120
00:05:42,960 --> 00:05:45,660
thoughts and incidents and abuse its

121
00:05:45,660 --> 00:05:50,280
capabilities for full-blown malowers

122
00:05:50,280 --> 00:05:52,560
so we can really see that this usage of

123
00:05:52,560 --> 00:05:56,280
the publicly available utilities is on

124
00:05:56,280 --> 00:05:59,820
the rise and it's an ongoing Trend

125
00:05:59,820 --> 00:06:03,240
because we see some of the trendiest

126
00:06:03,240 --> 00:06:07,680
stuff like AI powered malwares that rely

127
00:06:07,680 --> 00:06:10,500
on the Microsoft teams platform for

128
00:06:10,500 --> 00:06:13,199
channeling their C2 communication

129
00:06:13,199 --> 00:06:16,139
we even see huge malware Distributors

130
00:06:16,139 --> 00:06:19,440
such as agent Tesla and raccoon stealer

131
00:06:19,440 --> 00:06:22,259
that rely on the Discord CDN to deliver

132
00:06:22,259 --> 00:06:25,139
malicious payloads

133
00:06:25,139 --> 00:06:27,600
now that we've covered the means

134
00:06:27,600 --> 00:06:29,639
available for threat actors today

135
00:06:29,639 --> 00:06:33,060
against us let's see what we actually as

136
00:06:33,060 --> 00:06:35,699
Defenders can do against them

137
00:06:35,699 --> 00:06:38,039
so obviously we can and we should

138
00:06:38,039 --> 00:06:40,620
identify those resources used by the

139
00:06:40,620 --> 00:06:43,560
threat groups we can analyze any

140
00:06:43,560 --> 00:06:46,800
malowers that we get we can enrich data

141
00:06:46,800 --> 00:06:49,380
we've collected and lastly we should

142
00:06:49,380 --> 00:06:52,199
respond and act

143
00:06:52,199 --> 00:06:55,259
how do we even identify those malicious

144
00:06:55,259 --> 00:06:57,900
network resources used by thread groups

145
00:06:57,900 --> 00:07:00,780
well there are the good old traditional

146
00:07:00,780 --> 00:07:04,580
ways so Network anomalies non-standard

147
00:07:04,580 --> 00:07:07,860
ports large packets high volume of

148
00:07:07,860 --> 00:07:11,819
traffic and even registration of strange

149
00:07:11,819 --> 00:07:14,819
domain names like the greatest Google

150
00:07:14,819 --> 00:07:16,740
with a zero

151
00:07:16,740 --> 00:07:19,380
today we even have some more advanced

152
00:07:19,380 --> 00:07:22,199
practices to do that so things like EDR

153
00:07:22,199 --> 00:07:24,660
alerts which allows us to see

154
00:07:24,660 --> 00:07:27,539
communication inside the context of

155
00:07:27,539 --> 00:07:30,120
process execution which helps us gain

156
00:07:30,120 --> 00:07:32,580
some more clever conclusions on what we

157
00:07:32,580 --> 00:07:33,840
see

158
00:07:33,840 --> 00:07:37,620
now if we're lucky enough we could have

159
00:07:37,620 --> 00:07:40,979
captured the actual malware samples that

160
00:07:40,979 --> 00:07:43,139
are associated with this infrastructure

161
00:07:43,139 --> 00:07:45,120
we just tracked the malwares that should

162
00:07:45,120 --> 00:07:48,720
connect to it so when we have a malware

163
00:07:48,720 --> 00:07:51,120
sample we obviously want to analyze it

164
00:07:51,120 --> 00:07:54,360
so we can do anything from the great

165
00:07:54,360 --> 00:07:57,720
basic static analysis onto full very

166
00:07:57,720 --> 00:08:00,060
complex reverse engineering anything

167
00:08:00,060 --> 00:08:02,479
that we can do just to see what's inside

168
00:08:02,479 --> 00:08:06,300
and inside of it we can find additional

169
00:08:06,300 --> 00:08:09,599
domains naming conventions for a CNC

170
00:08:09,599 --> 00:08:11,940
commands supported by this

171
00:08:11,940 --> 00:08:15,300
infrastructure and in case for dgas we

172
00:08:15,300 --> 00:08:17,759
can actually extract the algorithm and

173
00:08:17,759 --> 00:08:19,919
attempt to predict additional servers in

174
00:08:19,919 --> 00:08:22,500
the wild that can match it

175
00:08:22,500 --> 00:08:25,919
now naturally because we are very

176
00:08:25,919 --> 00:08:28,440
curious beings we are researchers after

177
00:08:28,440 --> 00:08:32,520
all we would like to go ahead and enrich

178
00:08:32,520 --> 00:08:35,580
on all the data we've just collected so

179
00:08:35,580 --> 00:08:38,159
we can identify domain registration

180
00:08:38,159 --> 00:08:40,799
patterns and attempt to find more

181
00:08:40,799 --> 00:08:44,640
servers if we see the use of strange

182
00:08:44,640 --> 00:08:47,519
certificates we can go ahead and search

183
00:08:47,519 --> 00:08:50,100
for additional infrastructures that use

184
00:08:50,100 --> 00:08:53,040
them and we can attempt to detect

185
00:08:53,040 --> 00:08:55,680
additional servers that can support some

186
00:08:55,680 --> 00:08:57,959
of the naming conventions for the

187
00:08:57,959 --> 00:09:00,779
commands that we've seen or some unique

188
00:09:00,779 --> 00:09:04,440
and distinct URI past or parameter that

189
00:09:04,440 --> 00:09:06,360
we've seen on the infrastructure we've

190
00:09:06,360 --> 00:09:08,760
just researched

191
00:09:08,760 --> 00:09:11,940
after doing all of these things we now

192
00:09:11,940 --> 00:09:13,500
just have to act

193
00:09:13,500 --> 00:09:16,740
now these days most of our actions most

194
00:09:16,740 --> 00:09:18,779
of our responses to cyber security

195
00:09:18,779 --> 00:09:21,779
incidents involving infrastructure which

196
00:09:21,779 --> 00:09:26,279
consists mainly of iocs now in ioc for

197
00:09:26,279 --> 00:09:29,519
her case can be anything from a file

198
00:09:29,519 --> 00:09:32,880
hash domain name my IP address URI pass

199
00:09:32,880 --> 00:09:36,180
or parameter or any naming conventions

200
00:09:36,180 --> 00:09:38,339
on the server that we found

201
00:09:38,339 --> 00:09:41,519
we can sinkhole malicious infrastructure

202
00:09:41,519 --> 00:09:43,680
so we can attempt to take over

203
00:09:43,680 --> 00:09:47,399
completely unprotected c2s or we can

204
00:09:47,399 --> 00:09:50,399
attempt to register domain names used by

205
00:09:50,399 --> 00:09:51,899
thread groups

206
00:09:51,899 --> 00:09:54,600
in case we have access and we've

207
00:09:54,600 --> 00:09:55,700
identified

208
00:09:55,700 --> 00:09:58,740
accounts used by thread actors so things

209
00:09:58,740 --> 00:10:01,680
like social media profiles accounts used

210
00:10:01,680 --> 00:10:04,320
for Google Drive or Dropbox registration

211
00:10:04,320 --> 00:10:07,140
we can go ahead and get them banned and

212
00:10:07,140 --> 00:10:09,839
removed from the platforms and we can

213
00:10:09,839 --> 00:10:11,640
attempt to identify all infected

214
00:10:11,640 --> 00:10:14,580
machines in our organizations and clean

215
00:10:14,580 --> 00:10:17,420
them up I guess

216
00:10:18,779 --> 00:10:21,959
whoa everything is nice and dendy

217
00:10:21,959 --> 00:10:24,120
researchers are winning the battle

218
00:10:24,120 --> 00:10:26,060
against botnets

219
00:10:26,060 --> 00:10:30,779
because domain registration at scale is

220
00:10:30,779 --> 00:10:33,480
still expensive uh

221
00:10:33,480 --> 00:10:36,420
it is certainly traceable when you do it

222
00:10:36,420 --> 00:10:39,660
on large scale if you are trying to use

223
00:10:39,660 --> 00:10:42,959
accounts on Google or or draw books or

224
00:10:42,959 --> 00:10:45,959
other social media Facebook Twitter well

225
00:10:45,959 --> 00:10:48,540
maybe not Twitter uh

226
00:10:48,540 --> 00:10:52,079
then then this is still very labor

227
00:10:52,079 --> 00:10:55,140
intensive to create the account and

228
00:10:55,140 --> 00:10:57,200
maintain them because these platforms

229
00:10:57,200 --> 00:11:02,399
really try to avoid bot registration and

230
00:11:02,399 --> 00:11:06,060
certainly do their best to remove uh

231
00:11:06,060 --> 00:11:09,240
fake accounts from their platforms

232
00:11:09,240 --> 00:11:12,120
and and once you're confined for example

233
00:11:12,120 --> 00:11:15,779
to specific domains or specific accounts

234
00:11:15,779 --> 00:11:18,180
or folders in Google Docs or whatnot

235
00:11:18,180 --> 00:11:21,540
then then the traffic can unique can be

236
00:11:21,540 --> 00:11:24,240
uniquely identified and then what

237
00:11:24,240 --> 00:11:27,120
researchers do is just capture the

238
00:11:27,120 --> 00:11:29,880
samples analyze them

239
00:11:29,880 --> 00:11:32,820
prevent further infections by that same

240
00:11:32,820 --> 00:11:35,820
malware sample and then create iocs

241
00:11:35,820 --> 00:11:38,880
which gets distributed to the security

242
00:11:38,880 --> 00:11:41,339
mechanisms out there be those firewalls

243
00:11:41,339 --> 00:11:44,220
web gateways so on that look at the

244
00:11:44,220 --> 00:11:46,920
requests coming from the infected

245
00:11:46,920 --> 00:11:49,380
machines and block them

246
00:11:49,380 --> 00:11:53,760
and then when the servers themselves are

247
00:11:53,760 --> 00:11:58,260
taken down there is no way for the new

248
00:11:58,260 --> 00:12:01,440
control infrastructure created by the

249
00:12:01,440 --> 00:12:04,560
attackers and and yes they create the

250
00:12:04,560 --> 00:12:06,600
new infrastructure because that's how

251
00:12:06,600 --> 00:12:07,920
they make the living

252
00:12:07,920 --> 00:12:10,740
but that new infrastructure cannot

253
00:12:10,740 --> 00:12:14,820
communicate with the already infected

254
00:12:14,820 --> 00:12:16,140
machines

255
00:12:16,140 --> 00:12:20,240
creating them useless

256
00:12:21,060 --> 00:12:23,040
but researchers

257
00:12:23,040 --> 00:12:25,019
are still losing

258
00:12:25,019 --> 00:12:28,140
to nation-state actors

259
00:12:28,140 --> 00:12:30,959
those actors have a lot of resources

260
00:12:30,959 --> 00:12:34,380
both in terms of endless budgets and a

261
00:12:34,380 --> 00:12:36,839
lot of head count and using those

262
00:12:36,839 --> 00:12:39,740
resources they are able to Defy Gravity

263
00:12:39,740 --> 00:12:45,000
by creating huge numbers of for example

264
00:12:45,000 --> 00:12:48,600
Google accounts or Facebook accounts or

265
00:12:48,600 --> 00:12:50,880
LinkedIn accounts and maintaining them

266
00:12:50,880 --> 00:12:52,200
over time

267
00:12:52,200 --> 00:12:55,200
so they can keep

268
00:12:55,200 --> 00:12:57,839
the Abundant running for a very long

269
00:12:57,839 --> 00:13:00,660
time even though some of these accounts

270
00:13:00,660 --> 00:13:04,139
are being detected and and now being set

271
00:13:04,139 --> 00:13:08,040
up as iocs in all security mechanisms

272
00:13:08,040 --> 00:13:11,579
now that doesn't seem fair for the

273
00:13:11,579 --> 00:13:13,740
criminal hackers who do not have budgets

274
00:13:13,740 --> 00:13:15,660
and do not have head counts

275
00:13:15,660 --> 00:13:17,519
so we want to give back power to the

276
00:13:17,519 --> 00:13:18,300
people

277
00:13:18,300 --> 00:13:20,579
we want to create abundant

278
00:13:20,579 --> 00:13:22,639
infrastructure for your everyday hacker

279
00:13:22,639 --> 00:13:25,320
and of course it has to rely on public

280
00:13:25,320 --> 00:13:27,240
infrastructure so it should be

281
00:13:27,240 --> 00:13:29,940
indistinguishable from normal Network

282
00:13:29,940 --> 00:13:31,860
traffic

283
00:13:31,860 --> 00:13:34,320
and we want the individual votes to

284
00:13:34,320 --> 00:13:38,779
never die even when the central

285
00:13:38,779 --> 00:13:41,639
infrastructure is taken down

286
00:13:41,639 --> 00:13:45,540
and we want it to be cheap really cheap

287
00:13:45,540 --> 00:13:47,940
so we started thinking of ways to do

288
00:13:47,940 --> 00:13:51,300
that and here are some of the ways we

289
00:13:51,300 --> 00:13:54,060
just crossed out blockchain based

290
00:13:54,060 --> 00:13:56,700
infrastructure for botnet

291
00:13:56,700 --> 00:13:59,760
it's possible but it's very noisy it's

292
00:13:59,760 --> 00:14:01,519
very expensive

293
00:14:01,519 --> 00:14:04,200
we thought of an infrastructure in which

294
00:14:04,200 --> 00:14:06,240
the individual bhagnet would try to

295
00:14:06,240 --> 00:14:09,420
create accounts with the service like

296
00:14:09,420 --> 00:14:12,060
Google like Facebook but again this is

297
00:14:12,060 --> 00:14:14,579
complex this is way too expensive we

298
00:14:14,579 --> 00:14:17,040
talked about how complex it is to create

299
00:14:17,040 --> 00:14:19,920
an account with these services and if

300
00:14:19,920 --> 00:14:21,959
you go to off-brand services

301
00:14:21,959 --> 00:14:25,139
think of WeChat which are easier to

302
00:14:25,139 --> 00:14:26,540
register to

303
00:14:26,540 --> 00:14:29,339
they would be identified in any normal

304
00:14:29,339 --> 00:14:31,160
Network

305
00:14:31,160 --> 00:14:34,019
so let's see if we can do a little bit

306
00:14:34,019 --> 00:14:38,279
better and another idea that we had is

307
00:14:38,279 --> 00:14:41,279
to have a single account

308
00:14:41,279 --> 00:14:43,980
a bootstrap account included in the

309
00:14:43,980 --> 00:14:47,880
initial malware that would be used by

310
00:14:47,880 --> 00:14:49,260
the bot

311
00:14:49,260 --> 00:14:52,620
upon registration to receive an

312
00:14:52,620 --> 00:14:54,360
individual account

313
00:14:54,360 --> 00:14:58,560
from a pool that is created in the back

314
00:14:58,560 --> 00:15:02,040
office of the botnet control

315
00:15:02,040 --> 00:15:04,560
okay and then that individual account

316
00:15:04,560 --> 00:15:06,360
would be used for further Communications

317
00:15:06,360 --> 00:15:10,440
with the infrastructure uh now that

318
00:15:10,440 --> 00:15:13,260
provides us with an easy way for two-way

319
00:15:13,260 --> 00:15:16,920
Communications uh the Bots Will Survive

320
00:15:16,920 --> 00:15:18,720
a takedown of the bootstrap account

321
00:15:18,720 --> 00:15:20,279
because they already have their

322
00:15:20,279 --> 00:15:22,199
individual accounts

323
00:15:22,199 --> 00:15:25,139
they can even survive a takedown of

324
00:15:25,139 --> 00:15:28,079
their own individual account by for

325
00:15:28,079 --> 00:15:30,240
example using a beca account that was

326
00:15:30,240 --> 00:15:33,360
created upon registration

327
00:15:33,360 --> 00:15:34,820
however

328
00:15:34,820 --> 00:15:37,620
once the initial malware sample is

329
00:15:37,620 --> 00:15:40,320
captured that bootstrap account

330
00:15:40,320 --> 00:15:44,399
would be closed and would not be used

331
00:15:44,399 --> 00:15:48,240
anymore and we will have to replace the

332
00:15:48,240 --> 00:15:51,240
initial malware uh

333
00:15:51,240 --> 00:15:54,240
account creation although it's being

334
00:15:54,240 --> 00:15:57,540
done in the back office of the botnet

335
00:15:57,540 --> 00:16:00,240
controller it's still a hassle

336
00:16:00,240 --> 00:16:02,040
and what's worse

337
00:16:02,040 --> 00:16:05,040
is that researchers could actually

338
00:16:05,040 --> 00:16:07,980
attack this infrastructure with an

339
00:16:07,980 --> 00:16:10,560
account exhaustion attack

340
00:16:10,560 --> 00:16:14,279
so they would drive the botnet

341
00:16:14,279 --> 00:16:16,380
controller crazy with constantly asking

342
00:16:16,380 --> 00:16:18,839
for new accounts

343
00:16:18,839 --> 00:16:22,920
well we're not happy with that so we sat

344
00:16:22,920 --> 00:16:25,680
down and say oh we don't know what to do

345
00:16:25,680 --> 00:16:30,319
and when you do not know what to do

346
00:16:30,600 --> 00:16:33,800
you just Google it

347
00:16:33,959 --> 00:16:36,839
and that was our aha moment

348
00:16:36,839 --> 00:16:40,620
or Epiphany if you'd say

349
00:16:40,620 --> 00:16:43,019
we should build

350
00:16:43,019 --> 00:16:47,160
a system in which the Bots do not know

351
00:16:47,160 --> 00:16:50,220
the CNC however the Bots know how to

352
00:16:50,220 --> 00:16:53,579
search for the CNC and they know a CNC

353
00:16:53,579 --> 00:16:57,319
when they see one see

354
00:16:57,480 --> 00:16:58,980
and of course

355
00:16:58,980 --> 00:17:02,459
we have to choose our Search terms in a

356
00:17:02,459 --> 00:17:03,360
way

357
00:17:03,360 --> 00:17:07,799
that they cannot be used as iocs

358
00:17:07,799 --> 00:17:13,799
think cats cute pink

359
00:17:14,579 --> 00:17:17,220
now that we have an idea on how to

360
00:17:17,220 --> 00:17:19,020
become a malware Lord

361
00:17:19,020 --> 00:17:20,760
we needed a guide

362
00:17:20,760 --> 00:17:23,280
to how to do that and the guide for

363
00:17:23,280 --> 00:17:24,900
becoming a malware load starts with

364
00:17:24,900 --> 00:17:27,900
gather your minions

365
00:17:27,900 --> 00:17:29,820
so what we did

366
00:17:29,820 --> 00:17:32,640
is we recruited undergraduate students

367
00:17:32,640 --> 00:17:35,720
from the technion

368
00:17:36,299 --> 00:17:39,419
and explain the system to them

369
00:17:39,419 --> 00:17:40,980
and the system

370
00:17:40,980 --> 00:17:43,440
should be based on a service that

371
00:17:43,440 --> 00:17:46,220
supports Anonymous data consumption okay

372
00:17:46,220 --> 00:17:49,980
so I can consume data without

373
00:17:49,980 --> 00:17:52,140
registering an account

374
00:17:52,140 --> 00:17:55,320
it should offer a flexible and diverse

375
00:17:55,320 --> 00:17:57,600
search functionality

376
00:17:57,600 --> 00:18:00,780
pretty much everyone does day-to-day

377
00:18:00,780 --> 00:18:04,020
and content Creation in the platform

378
00:18:04,020 --> 00:18:08,039
may require registration but the content

379
00:18:08,039 --> 00:18:11,820
itself is not scrutinized so we gave

380
00:18:11,820 --> 00:18:13,380
them these instructions this

381
00:18:13,380 --> 00:18:15,600
specification and said go and find

382
00:18:15,600 --> 00:18:19,440
platforms go and create pocs

383
00:18:19,440 --> 00:18:22,919
they created great things uh they used

384
00:18:22,919 --> 00:18:25,760
YouTube they used Reddit

385
00:18:25,760 --> 00:18:29,100
they relied on comments on content

386
00:18:29,100 --> 00:18:31,860
posted by other people

387
00:18:31,860 --> 00:18:36,539
and uh really within the time frame of a

388
00:18:36,539 --> 00:18:39,480
single semester we're able to come with

389
00:18:39,480 --> 00:18:42,120
pocs on top of these Platforms in the

390
00:18:42,120 --> 00:18:43,320
meanwhile

391
00:18:43,320 --> 00:18:45,720
we took a different platform which we'll

392
00:18:45,720 --> 00:18:47,760
show you today

393
00:18:47,760 --> 00:18:51,240
so now I am really thrilled to introduce

394
00:18:51,240 --> 00:18:53,600
you with the POC that we've executed

395
00:18:53,600 --> 00:18:57,960
SpotBot which obviously is a bot

396
00:18:57,960 --> 00:18:59,580
communicating over Spotify

397
00:18:59,580 --> 00:19:02,160
infrastructure

398
00:19:02,160 --> 00:19:05,220
now why we specifically chose Spotify

399
00:19:05,220 --> 00:19:08,400
for this demonstration was really a

400
00:19:08,400 --> 00:19:09,900
no-brainer

401
00:19:09,900 --> 00:19:12,840
it's because Spotify is just the perfect

402
00:19:12,840 --> 00:19:15,840
match to all the criteria we've

403
00:19:15,840 --> 00:19:18,240
mentioned and said that is absolutely

404
00:19:18,240 --> 00:19:20,340
crucial for the success of this

405
00:19:20,340 --> 00:19:21,900
infrastructure

406
00:19:21,900 --> 00:19:24,480
all types of media that are available on

407
00:19:24,480 --> 00:19:27,780
Spotify can be consumed anonymously

408
00:19:27,780 --> 00:19:31,200
Spotify also offers a great abundance of

409
00:19:31,200 --> 00:19:33,120
Search terms and modifiers to be

410
00:19:33,120 --> 00:19:37,020
performed on said media anonymously

411
00:19:37,020 --> 00:19:39,539
and the most important thing when

412
00:19:39,539 --> 00:19:41,520
creating and hosting a malware

413
00:19:41,520 --> 00:19:42,780
infrastructure

414
00:19:42,780 --> 00:19:47,220
is that for Spotify podcasts all data is

415
00:19:47,220 --> 00:19:50,660
not scrutinized in any way nor for

416
00:19:50,660 --> 00:19:55,140
copyrights or for offensive content

417
00:19:55,140 --> 00:19:56,700
so if you've ever found yourself

418
00:19:56,700 --> 00:19:59,820
wondering of how can one start its own

419
00:19:59,820 --> 00:20:03,840
Spotify podcast then Wonder no more

420
00:20:03,840 --> 00:20:06,600
because delivering podcasts via Spotify

421
00:20:06,600 --> 00:20:10,380
is relatively easy all you have to do is

422
00:20:10,380 --> 00:20:13,080
register to a thing called a Content

423
00:20:13,080 --> 00:20:15,480
distribution platform we've used one

424
00:20:15,480 --> 00:20:18,120
that's named castos and it costs less

425
00:20:18,120 --> 00:20:20,100
than twenty dollars a month which is

426
00:20:20,100 --> 00:20:23,160
quite cheap and then into this platform

427
00:20:23,160 --> 00:20:27,000
you upload your podcasts content so

428
00:20:27,000 --> 00:20:30,539
episodes images titles transcripts and

429
00:20:30,539 --> 00:20:33,740
descriptions then simply go to

430
00:20:33,740 --> 00:20:36,179
podcasters.spotify.com link it with this

431
00:20:36,179 --> 00:20:38,100
distribution platform and

432
00:20:38,100 --> 00:20:42,179
congratulations you now own a podcast

433
00:20:42,179 --> 00:20:45,179
now that we have a brand new podcast

434
00:20:45,179 --> 00:20:48,240
started live and on the air let's see

435
00:20:48,240 --> 00:20:50,880
how we can actually utilize it to send

436
00:20:50,880 --> 00:20:54,419
CNC commands and so the first approach

437
00:20:54,419 --> 00:20:57,960
we can take here is to encode data

438
00:20:57,960 --> 00:21:01,140
inside the podcast audio streams or the

439
00:21:01,140 --> 00:21:04,260
images that are associated with it and

440
00:21:04,260 --> 00:21:06,780
to do that we'll have to encode and then

441
00:21:06,780 --> 00:21:09,360
decode the data on the other end using

442
00:21:09,360 --> 00:21:11,940
something like an OCR or a naughty

443
00:21:11,940 --> 00:21:13,919
modulation program

444
00:21:13,919 --> 00:21:17,880
now the second approach that we chose is

445
00:21:17,880 --> 00:21:21,140
to encode short data messages inside

446
00:21:21,140 --> 00:21:24,480
podcasts episodes descriptions now

447
00:21:24,480 --> 00:21:26,640
you'll be surprised with how much you

448
00:21:26,640 --> 00:21:29,640
can fit inside just one description

449
00:21:29,640 --> 00:21:31,860
so for instance we can put their short

450
00:21:31,860 --> 00:21:35,340
short command we can put URLs for

451
00:21:35,340 --> 00:21:38,460
fetching further payloads we can insert

452
00:21:38,460 --> 00:21:41,820
the ID of an additional Spotify object

453
00:21:41,820 --> 00:21:43,799
in our malicious chain

454
00:21:43,799 --> 00:21:48,480
and we can even fit a 64 by DSA digital

455
00:21:48,480 --> 00:21:52,500
signature inside the description

456
00:21:52,500 --> 00:21:56,340
now that we covered how the spotbot's

457
00:21:56,340 --> 00:21:59,039
controller side can look like and can

458
00:21:59,039 --> 00:22:02,340
operate let's see how the spotbot's

459
00:22:02,340 --> 00:22:05,159
client so the victims themselves can

460
00:22:05,159 --> 00:22:07,320
create their initial contact with the

461
00:22:07,320 --> 00:22:08,940
Spotify C2

462
00:22:08,940 --> 00:22:12,240
and to do that will rely on those Search

463
00:22:12,240 --> 00:22:14,940
terms we've mentioned earlier it's

464
00:22:14,940 --> 00:22:18,000
because each SpotBot distribution will

465
00:22:18,000 --> 00:22:20,520
be packaged with a set of keywords

466
00:22:20,520 --> 00:22:23,460
referring to the malicious podcast name

467
00:22:23,460 --> 00:22:26,460
upon initial execution SpotBot will

468
00:22:26,460 --> 00:22:28,440
search Spotify for these keywords

469
00:22:28,440 --> 00:22:31,100
receiving back many many results

470
00:22:31,100 --> 00:22:34,580
including podcasts episodes songs

471
00:22:34,580 --> 00:22:37,020
playlists artists and essentially

472
00:22:37,020 --> 00:22:39,600
anything available on the platform that

473
00:22:39,600 --> 00:22:42,960
can match either of the keywords

474
00:22:42,960 --> 00:22:46,080
poor SpotBot now has to determine which

475
00:22:46,080 --> 00:22:49,980
of these results is the right one and to

476
00:22:49,980 --> 00:22:53,280
do that he will attempt to match the

477
00:22:53,280 --> 00:22:56,280
description of all of the results with

478
00:22:56,280 --> 00:22:58,620
an additional set of either keywords or

479
00:22:58,620 --> 00:23:00,780
patterns that are embedded inside the

480
00:23:00,780 --> 00:23:02,460
malware

481
00:23:02,460 --> 00:23:05,580
note the right episode with the right

482
00:23:05,580 --> 00:23:07,380
description

483
00:23:07,380 --> 00:23:10,380
shouldn't only match spotbot's keywords

484
00:23:10,380 --> 00:23:13,159
and patterns but must also match

485
00:23:13,159 --> 00:23:16,500
spotbot's digital signature because

486
00:23:16,500 --> 00:23:18,900
we've said that we can fit one inside

487
00:23:18,900 --> 00:23:20,940
the malicious description

488
00:23:20,940 --> 00:23:24,600
Now using the signature helps SpotBot

489
00:23:24,600 --> 00:23:27,500
verify that it got the right content

490
00:23:27,500 --> 00:23:31,980
while also helping us make sure that our

491
00:23:31,980 --> 00:23:34,140
infrastructure and our Bots are not

492
00:23:34,140 --> 00:23:36,960
being sinkholed

493
00:23:36,960 --> 00:23:39,240
so as you can see inside the description

494
00:23:39,240 --> 00:23:41,700
we can put things like commands to be

495
00:23:41,700 --> 00:23:44,400
executed on the victim's host machine or

496
00:23:44,400 --> 00:23:47,520
that we can put their the ID of an

497
00:23:47,520 --> 00:23:50,280
additional episode of our podcast that

498
00:23:50,280 --> 00:23:53,039
will eventually lead SpotBot to things

499
00:23:53,039 --> 00:23:56,460
it has to execute

500
00:23:56,460 --> 00:24:00,059
now let's all assume for a moment that

501
00:24:00,059 --> 00:24:02,120
the absolute worst of all that happened

502
00:24:02,120 --> 00:24:05,520
in a researcher happened to track down

503
00:24:05,520 --> 00:24:08,419
the links to all of our episodes

504
00:24:08,419 --> 00:24:12,120
blocking them even getting them removed

505
00:24:12,120 --> 00:24:15,299
from Spotify in an attempt to defeat us

506
00:24:15,299 --> 00:24:17,940
and disable all the Bots

507
00:24:17,940 --> 00:24:19,679
well in this case

508
00:24:19,679 --> 00:24:22,140
we'll just simply upload new and fresh

509
00:24:22,140 --> 00:24:25,860
content into Spotify because we're still

510
00:24:25,860 --> 00:24:27,780
aware of the keywords that are embedded

511
00:24:27,780 --> 00:24:30,600
inside spot but distributions and

512
00:24:30,600 --> 00:24:34,320
SpotBot will forever continue to look up

513
00:24:34,320 --> 00:24:37,260
their keyword in case they received no

514
00:24:37,260 --> 00:24:40,320
additional command leaving us and a

515
00:24:40,320 --> 00:24:42,960
researcher playing a very vicious game

516
00:24:42,960 --> 00:24:46,140
of guacamole with Spotify content and

517
00:24:46,140 --> 00:24:49,799
SpotBot Reviving

518
00:24:49,940 --> 00:24:54,720
now we want to present just a quick demo

519
00:24:54,720 --> 00:24:58,740
of how spotbot's execution can actually

520
00:24:58,740 --> 00:25:02,820
look like so on this side you can see

521
00:25:02,820 --> 00:25:05,280
the console output of a SpotBot

522
00:25:05,280 --> 00:25:08,460
execution so what a bot is doing what is

523
00:25:08,460 --> 00:25:10,320
he looking for in Spotify what did he

524
00:25:10,320 --> 00:25:13,799
find and attempting to do next and on

525
00:25:13,799 --> 00:25:16,799
this side you can see the actual content

526
00:25:16,799 --> 00:25:22,140
on Spotify that the bot is consuming

527
00:25:22,140 --> 00:25:24,059
so

528
00:25:24,059 --> 00:25:26,520
we can see that

529
00:25:26,520 --> 00:25:30,000
the boat is attempting to start it is

530
00:25:30,000 --> 00:25:32,220
not starting

531
00:25:32,220 --> 00:25:35,720
to simulate the boat

532
00:25:38,059 --> 00:25:41,480
he's not working

533
00:25:42,080 --> 00:25:47,340
so it was evident that we could easily

534
00:25:47,340 --> 00:25:48,900
create

535
00:25:48,900 --> 00:25:51,179
a running functioning bonded

536
00:25:51,179 --> 00:25:54,720
infrastructure on top of various

537
00:25:54,720 --> 00:25:57,059
Platforms in

538
00:25:57,059 --> 00:25:59,720
a very minimal cost

539
00:25:59,720 --> 00:26:04,740
and it was easy to deliver command from

540
00:26:04,740 --> 00:26:07,200
the controller to the bot

541
00:26:07,200 --> 00:26:10,980
on this infrastructure but as you've

542
00:26:10,980 --> 00:26:11,940
noticed

543
00:26:11,940 --> 00:26:15,000
it's not that trivial to do the other

544
00:26:15,000 --> 00:26:17,700
way around so of course we could use

545
00:26:17,700 --> 00:26:19,799
some of the commands to for example

546
00:26:19,799 --> 00:26:23,400
include temporary links or URLs to

547
00:26:23,400 --> 00:26:26,640
servers that we've taken over and can

548
00:26:26,640 --> 00:26:29,580
now be used for a limited time by the

549
00:26:29,580 --> 00:26:32,700
Bots to upload their content but this is

550
00:26:32,700 --> 00:26:35,580
still somewhat inconvenient so in terms

551
00:26:35,580 --> 00:26:38,100
of further research we've tried to find

552
00:26:38,100 --> 00:26:39,539
a way to make this channel

553
00:26:39,539 --> 00:26:41,659
bi-directional

554
00:26:41,659 --> 00:26:45,059
one of the methods we thought of was

555
00:26:45,059 --> 00:26:48,840
looking into the analytics that the

556
00:26:48,840 --> 00:26:51,900
platforms offer think of YouTube

557
00:26:51,900 --> 00:26:54,299
analytics who's watching the movie where

558
00:26:54,299 --> 00:26:56,640
are they coming from and so on who's

559
00:26:56,640 --> 00:26:58,799
listening to my music and podcast on

560
00:26:58,799 --> 00:27:03,059
Spotify and what we try to do was

561
00:27:03,059 --> 00:27:05,240
to insert information

562
00:27:05,240 --> 00:27:09,900
into HTTP headers for example in a way

563
00:27:09,900 --> 00:27:12,140
that would show up

564
00:27:12,140 --> 00:27:16,980
in the analytics screens

565
00:27:17,220 --> 00:27:20,779
alas we're not very successful with that

566
00:27:20,779 --> 00:27:24,840
there was anecdotally one thing we're

567
00:27:24,840 --> 00:27:28,860
able to do with YouTube so we're able to

568
00:27:28,860 --> 00:27:32,340
see which language

569
00:27:32,340 --> 00:27:35,820
a movie was consumed in

570
00:27:35,820 --> 00:27:37,679
so we could have

571
00:27:37,679 --> 00:27:40,380
different Bots trying to ask for

572
00:27:40,380 --> 00:27:43,620
different language versions of the

573
00:27:43,620 --> 00:27:47,159
podcast for example or of a movie and

574
00:27:47,159 --> 00:27:49,679
and and then you know track them a

575
00:27:49,679 --> 00:27:50,880
little bit but

576
00:27:50,880 --> 00:27:53,159
not a lot of information could be sent

577
00:27:53,159 --> 00:27:56,580
that way uh so that's that's certainly

578
00:27:56,580 --> 00:28:00,840
one area that deserves for the research

579
00:28:00,840 --> 00:28:04,860
another idea that we looked into was

580
00:28:04,860 --> 00:28:06,480
instead of the

581
00:28:06,480 --> 00:28:10,500
bot searching for their controller have

582
00:28:10,500 --> 00:28:14,880
the controller find the Bots and the

583
00:28:14,880 --> 00:28:17,460
best infrastructure for doing that

584
00:28:17,460 --> 00:28:21,059
is ADS based botnet

585
00:28:21,059 --> 00:28:25,440
think about all those services that

586
00:28:25,440 --> 00:28:29,520
just know that you're planning a trip to

587
00:28:29,520 --> 00:28:32,960
Kenya or all those

588
00:28:32,960 --> 00:28:35,640
advertisers that just happen to know

589
00:28:35,640 --> 00:28:37,860
that you were talking about a new car

590
00:28:37,860 --> 00:28:40,740
you want to purchase okay so these are

591
00:28:40,740 --> 00:28:43,799
very powerful Platforms in terms of uh

592
00:28:43,799 --> 00:28:47,000
targeting machines targeting individuals

593
00:28:47,000 --> 00:28:51,539
uh so definitely an idea to look at and

594
00:28:51,539 --> 00:28:53,340
of course one of the most obvious ones

595
00:28:53,340 --> 00:28:56,340
that deserves attention is how can we

596
00:28:56,340 --> 00:28:59,760
use existing accounts on the inflected

597
00:28:59,760 --> 00:29:02,000
infected platforms

598
00:29:02,000 --> 00:29:05,220
to communicate with our botnet

599
00:29:05,220 --> 00:29:07,940
infrastructure

600
00:29:08,760 --> 00:29:13,320
so I think that we've proved that many

601
00:29:13,320 --> 00:29:15,960
public platforms provide the opportunity

602
00:29:15,960 --> 00:29:19,820
for attackers to create a very resilient

603
00:29:19,820 --> 00:29:23,880
botnet That Never Dies and all these

604
00:29:23,880 --> 00:29:25,620
platforms

605
00:29:25,620 --> 00:29:27,960
can be easily put to work because of

606
00:29:27,960 --> 00:29:30,659
their apis because of their simple web

607
00:29:30,659 --> 00:29:34,980
access so the cost of maintaining this

608
00:29:34,980 --> 00:29:37,620
infrastructure alive

609
00:29:37,620 --> 00:29:41,640
is dramatically dropping not only that

610
00:29:41,640 --> 00:29:45,539
because you are not losing the

611
00:29:45,539 --> 00:29:49,320
individual Bots when you're being

612
00:29:49,320 --> 00:29:51,480
detected at one place

613
00:29:51,480 --> 00:29:55,919
it becomes even more cost effective

614
00:29:55,919 --> 00:29:58,320
so what's the conclusion of all this the

615
00:29:58,320 --> 00:30:01,740
conclusion is that the current Defender

616
00:30:01,740 --> 00:30:03,000
toolbox

617
00:30:03,000 --> 00:30:06,480
is no longer doing the work and it must

618
00:30:06,480 --> 00:30:09,600
change the generic defenses that are

619
00:30:09,600 --> 00:30:13,260
based on ioc's applied

620
00:30:13,260 --> 00:30:16,559
to the traffic going out of the boats to

621
00:30:16,559 --> 00:30:17,760
the controller

622
00:30:17,760 --> 00:30:21,480
just fail to protect us

623
00:30:21,480 --> 00:30:24,720
and we got to the point where you can

624
00:30:24,720 --> 00:30:27,539
achieve cheap and simple construction of

625
00:30:27,539 --> 00:30:30,779
this botnet however it's a very

626
00:30:30,779 --> 00:30:33,659
expensive and complex process to

627
00:30:33,659 --> 00:30:35,640
dismantle them

628
00:30:35,640 --> 00:30:39,539
and it seems like we need a new breed of

629
00:30:39,539 --> 00:30:44,100
tools here that are able to look at the

630
00:30:44,100 --> 00:30:47,820
content delivered by the platforms and

631
00:30:47,820 --> 00:30:50,820
at the same time be somewhat platform

632
00:30:50,820 --> 00:30:52,799
agnostic

633
00:30:52,799 --> 00:30:56,600
and until we have this breed of tools

634
00:30:56,600 --> 00:31:00,240
we'll keep losing the game of guacamole

635
00:31:00,240 --> 00:31:01,679
thank you

636
00:31:01,679 --> 00:31:02,850
thank you

637
00:31:02,850 --> 00:31:09,738
[Music]

