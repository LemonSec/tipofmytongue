1
00:00:02,830 --> 00:00:20,040
[Music]

2
00:00:20,390 --> 00:00:27,930
so<font color="#E5E5E5"> travel Hudson who is</font><font color="#CCCCCC"> standing here</font>

3
00:00:24,180 --> 00:00:31,410
he's<font color="#E5E5E5"> taking things apart don't worry</font>

4
00:00:27,930 --> 00:00:35,100
not life on stage<font color="#CCCCCC"> but</font><font color="#E5E5E5"> he will give us a</font>

5
00:00:31,410 --> 00:00:37,620
proof of concept<font color="#CCCCCC"> and some details and</font>

6
00:00:35,100 --> 00:00:39,570
functionalities about<font color="#E5E5E5"> hardware implants</font>

7
00:00:37,620 --> 00:00:42,629
<font color="#E5E5E5">so the same things</font><font color="#CCCCCC"> that we heard</font><font color="#E5E5E5"> from</font>

8
00:00:39,570 --> 00:00:45,270
Bloomberg article talking<font color="#E5E5E5"> about Apple</font>

9
00:00:42,629 --> 00:00:50,339
and Super Micro computers with implants

10
00:00:45,270 --> 00:00:52,980
<font color="#E5E5E5">that yeah</font><font color="#CCCCCC"> were implanted into</font><font color="#E5E5E5"> those into</font>

11
00:00:50,340 --> 00:00:55,890
those computers<font color="#E5E5E5"> and I'm really excited</font>

12
00:00:52,980 --> 00:00:58,209
<font color="#E5E5E5">to see this in action please give a warm</font>

13
00:00:55,890 --> 00:01:01,630
<font color="#E5E5E5">round of applause to</font><font color="#CCCCCC"> trauma</font><font color="#E5E5E5"> Hudson</font>

14
00:00:58,210 --> 00:01:04,819
[Applause]

15
00:01:01,630 --> 00:01:04,819
[Music]

16
00:01:07,560 --> 00:01:12,700
before we begin<font color="#E5E5E5"> talking about</font><font color="#CCCCCC"> hardware</font>

17
00:01:10,060 --> 00:01:14,740
implants<font color="#CCCCCC"> just two quick disclaimers</font><font color="#E5E5E5"> the</font>

18
00:01:12,700 --> 00:01:16,360
first from my employer to Sigma

19
00:01:14,740 --> 00:01:17,979
<font color="#E5E5E5">investments as it says there are</font>

20
00:01:16,360 --> 00:01:21,340
<font color="#E5E5E5">chocolate bars this is not</font><font color="#CCCCCC"> investment</font>

21
00:01:17,980 --> 00:01:23,560
advice<font color="#E5E5E5"> and secondly I don't</font><font color="#CCCCCC"> actually</font>

22
00:01:21,340 --> 00:01:25,630
know what the<font color="#CCCCCC"> story is behind</font><font color="#E5E5E5"> the</font>

23
00:01:23,560 --> 00:01:28,930
<font color="#CCCCCC">Supermicro story no one outside</font><font color="#E5E5E5"> of</font>

24
00:01:25,630 --> 00:01:30,640
<font color="#E5E5E5">Bloomberg and their sources do but I</font>

25
00:01:28,930 --> 00:01:33,490
have spent a<font color="#E5E5E5"> lot of time thinking about</font>

26
00:01:30,640 --> 00:01:36,430
Hardware implants starting with the

27
00:01:33,490 --> 00:01:38,800
Thunderstrike<font color="#E5E5E5"> firmware attack against</font>

28
00:01:36,430 --> 00:01:42,430
<font color="#E5E5E5">Mac books as well as the Thunderstrike</font>

29
00:01:38,800 --> 00:01:46,170
<font color="#CCCCCC">to where we were able to get software to</font>

30
00:01:42,430 --> 00:01:48,490
write into the<font color="#E5E5E5"> firmware on the Mac books</font>

31
00:01:46,170 --> 00:01:50,800
I've also been thinking<font color="#CCCCCC"> a lot about how</font>

32
00:01:48,490 --> 00:01:52,449
<font color="#CCCCCC">to defend</font><font color="#E5E5E5"> against Hardware implants with</font>

33
00:01:50,800 --> 00:01:55,179
things like the<font color="#E5E5E5"> heads firmware for</font>

34
00:01:52,450 --> 00:01:57,880
slightly more<font color="#CCCCCC"> secure laptops and also as</font>

35
00:01:55,180 --> 00:01:59,650
<font color="#E5E5E5">part of my co-lead on the Linux boot</font>

36
00:01:57,880 --> 00:02:03,399
project we're thinking about<font color="#E5E5E5"> how to</font>

37
00:01:59,650 --> 00:02:09,790
protect<font color="#E5E5E5"> servers from physical and</font>

38
00:02:03,400 --> 00:02:11,170
software attacks so with all<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> you</font>

39
00:02:09,789 --> 00:02:13,660
<font color="#CCCCCC">know concentrated thinking about</font>

40
00:02:11,170 --> 00:02:16,570
firmware and hardware attacks<font color="#E5E5E5"> I was</font>

41
00:02:13,660 --> 00:02:19,480
really excited<font color="#E5E5E5"> when I saw the Bloomberg</font>

42
00:02:16,570 --> 00:02:22,570
story<font color="#E5E5E5"> back in October but what really</font>

43
00:02:19,480 --> 00:02:24,130
intrigued me was<font color="#E5E5E5"> the the animated image</font>

44
00:02:22,570 --> 00:02:28,230
that they had at the header<font color="#E5E5E5"> that</font>

45
00:02:24,130 --> 00:02:31,060
<font color="#E5E5E5">highlighted one small part of the board</font>

46
00:02:28,230 --> 00:02:32,950
<font color="#E5E5E5">as where the implant was but what I</font>

47
00:02:31,060 --> 00:02:35,230
found really interesting<font color="#E5E5E5"> is that is</font>

48
00:02:32,950 --> 00:02:39,089
exactly<font color="#CCCCCC"> where I would install a hardware</font>

49
00:02:35,230 --> 00:02:42,250
implant as they described on the spy bus

50
00:02:39,090 --> 00:02:44,410
a lot of other people in the hardware

51
00:02:42,250 --> 00:02:46,989
and firmware security community thought

52
00:02:44,410 --> 00:02:49,299
it<font color="#E5E5E5"> sounded plausible other people</font>

53
00:02:46,989 --> 00:02:51,550
pointed out<font color="#E5E5E5"> that supply</font><font color="#CCCCCC"> chain attacks</font>

54
00:02:49,300 --> 00:02:54,400
<font color="#CCCCCC">come up periodically and they are</font>

55
00:02:51,550 --> 00:02:58,030
definitely a concern some people thought

56
00:02:54,400 --> 00:03:01,989
the attack as described was was entirely

57
00:02:58,030 --> 00:03:03,989
implausible<font color="#E5E5E5"> and in general you know we</font>

58
00:03:01,989 --> 00:03:06,400
sort<font color="#E5E5E5"> of had a whiskey-tango-foxtrot</font>

59
00:03:03,989 --> 00:03:07,840
moment is everybody scrambled to figure

60
00:03:06,400 --> 00:03:11,890
out what's going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> inside their</font>

61
00:03:07,840 --> 00:03:13,569
machines so let's step<font color="#E5E5E5"> back</font><font color="#CCCCCC"> write</font>

62
00:03:11,890 --> 00:03:16,049
<font color="#E5E5E5">quickly and review what the key claims</font>

63
00:03:13,569 --> 00:03:20,489
<font color="#E5E5E5">that Bloomberg alleged</font>

64
00:03:16,050 --> 00:03:23,760
happened first<font color="#E5E5E5"> they said that Amazon's</font>

65
00:03:20,490 --> 00:03:24,720
testers found a tiny microchip<font color="#CCCCCC"> that</font>

66
00:03:23,760 --> 00:03:27,329
<font color="#E5E5E5">wasn't part of the board's original</font>

67
00:03:24,720 --> 00:03:29,760
<font color="#E5E5E5">design that had been disguised to look</font>

68
00:03:27,330 --> 00:03:32,970
like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> signaling condition signal</font>

69
00:03:29,760 --> 00:03:35,220
conditioning coupler<font color="#E5E5E5"> and that these</font>

70
00:03:32,970 --> 00:03:37,410
<font color="#E5E5E5">illicit chips were connected to the</font><font color="#CCCCCC"> base</font>

71
00:03:35,220 --> 00:03:40,710
<font color="#E5E5E5">board base board management controller</font>

72
00:03:37,410 --> 00:03:43,380
or the<font color="#E5E5E5"> BMC which gave them</font><font color="#CCCCCC"> access to</font>

73
00:03:40,710 --> 00:03:44,970
machines that<font color="#CCCCCC"> were turned</font><font color="#E5E5E5"> off that might</font>

74
00:03:43,380 --> 00:03:47,359
sound kind<font color="#CCCCCC"> of extreme</font><font color="#E5E5E5"> but that's</font>

75
00:03:44,970 --> 00:03:51,540
actually<font color="#E5E5E5"> what the role of the BMC is</font>

76
00:03:47,360 --> 00:03:53,220
that in<font color="#E5E5E5"> most servers the BMC is running</font>

77
00:03:51,540 --> 00:03:55,590
<font color="#CCCCCC">anytime the</font><font color="#E5E5E5"> machine is hooked up to</font>

78
00:03:53,220 --> 00:03:57,720
<font color="#E5E5E5">power and it's connected</font><font color="#CCCCCC"> to the power</font>

79
00:03:55,590 --> 00:04:02,100
<font color="#E5E5E5">supplies so that it can turn the machine</font>

80
00:03:57,720 --> 00:04:04,020
on and<font color="#E5E5E5"> turn</font><font color="#CCCCCC"> it off frequently you</font><font color="#E5E5E5"> want</font>

81
00:04:02,100 --> 00:04:06,930
to be able<font color="#E5E5E5"> to do this over</font><font color="#CCCCCC"> a network</font><font color="#E5E5E5"> so</font>

82
00:04:04,020 --> 00:04:09,480
it has a its own dedicated<font color="#E5E5E5"> land port but</font>

83
00:04:06,930 --> 00:04:14,040
it can also share the land port with<font color="#CCCCCC"> the</font>

84
00:04:09,480 --> 00:04:16,349
with the main system serial<font color="#E5E5E5"> over LAN is</font>

85
00:04:14,040 --> 00:04:19,200
a really<font color="#CCCCCC"> useful way to</font><font color="#E5E5E5"> debug the systems</font>

86
00:04:16,350 --> 00:04:22,260
<font color="#CCCCCC">so it provides that functionality</font><font color="#E5E5E5"> it can</font>

87
00:04:19,200 --> 00:04:26,240
also provide fake USB volumes to allow

88
00:04:22,260 --> 00:04:29,370
you<font color="#E5E5E5"> to do unattended OS installation</font><font color="#CCCCCC"> a</font>

89
00:04:26,240 --> 00:04:32,940
lot of sites also<font color="#E5E5E5"> want remote</font><font color="#CCCCCC"> KVM</font><font color="#E5E5E5"> so it</font>

90
00:04:29,370 --> 00:04:35,580
has<font color="#CCCCCC"> VGA</font><font color="#E5E5E5"> but that VGA support means that</font>

91
00:04:32,940 --> 00:04:39,080
<font color="#E5E5E5">it's on the PCIe bus</font><font color="#CCCCCC"> and because it's on</font>

92
00:04:35,580 --> 00:04:42,539
PCIe<font color="#CCCCCC"> it can do DMA into main memory</font>

93
00:04:39,080 --> 00:04:45,270
it also has typically must into the spy

94
00:04:42,540 --> 00:04:49,320
<font color="#CCCCCC">flash for</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> host firmware which allows</font>

95
00:04:45,270 --> 00:04:51,539
it<font color="#CCCCCC"> to modify it and on some systems it's</font>

96
00:04:49,320 --> 00:04:55,130
even connected to<font color="#E5E5E5"> the TPM which allows</font>

97
00:04:51,540 --> 00:04:58,650
it to circumvent<font color="#E5E5E5"> the</font><font color="#CCCCCC"> core root of</font><font color="#E5E5E5"> trust</font>

98
00:04:55,130 --> 00:05:01,880
so with all of<font color="#E5E5E5"> this capability</font><font color="#CCCCCC"> inside</font>

99
00:04:58,650 --> 00:05:05,729
this chip<font color="#E5E5E5"> it's really unfortunate that</font>

100
00:05:01,880 --> 00:05:09,120
<font color="#E5E5E5">they are really not well put together</font><font color="#CCCCCC"> at</font>

101
00:05:05,730 --> 00:05:11,190
the head<font color="#CCCCCC"> of</font><font color="#E5E5E5"> your security says they have</font>

102
00:05:09,120 --> 00:05:12,990
no protection<font color="#E5E5E5"> against attacks there's no</font>

103
00:05:11,190 --> 00:05:14,550
ability<font color="#CCCCCC"> to detect if an attack has</font>

104
00:05:12,990 --> 00:05:18,870
happened<font color="#CCCCCC"> and</font><font color="#E5E5E5"> there's no ability</font><font color="#CCCCCC"> to</font>

105
00:05:14,550 --> 00:05:21,990
<font color="#E5E5E5">recover from</font><font color="#CCCCCC"> an attack</font><font color="#E5E5E5"> so having a</font>

106
00:05:18,870 --> 00:05:24,860
hardware implant on<font color="#E5E5E5"> the BMC is a really</font>

107
00:05:21,990 --> 00:05:24,860
big<font color="#CCCCCC"> concern</font>

108
00:05:25,389 --> 00:05:31,369
the other claim<font color="#E5E5E5"> in the article is that</font>

109
00:05:29,119 --> 00:05:36,649
it affected 30 different companies

110
00:05:31,369 --> 00:05:39,049
<font color="#E5E5E5">including</font><font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> and Bloomberg</font><font color="#CCCCCC"> alleges</font>

111
00:05:36,649 --> 00:05:40,729
that<font color="#E5E5E5"> Apple found malicious chips</font>

112
00:05:39,049 --> 00:05:42,938
independently on<font color="#CCCCCC"> their super micro</font>

113
00:05:40,729 --> 00:05:46,159
boards<font color="#CCCCCC"> they</font><font color="#E5E5E5"> went to the FBI</font><font color="#CCCCCC"> about it and</font>

114
00:05:42,939 --> 00:05:51,049
that<font color="#E5E5E5"> they then severed ties with Super</font>

115
00:05:46,159 --> 00:05:52,998
<font color="#E5E5E5">Micro this particular claim was</font>

116
00:05:51,049 --> 00:05:55,248
interesting because<font color="#E5E5E5"> it corroborated</font><font color="#CCCCCC"> a</font>

117
00:05:52,999 --> 00:05:58,069
story that had shown up back in early

118
00:05:55,249 --> 00:06:01,339
2017<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Apple had removed</font><font color="#CCCCCC"> Super Micro</font>

119
00:05:58,069 --> 00:06:03,649
<font color="#E5E5E5">from their data centers</font><font color="#CCCCCC"> Apple denied</font>

120
00:06:01,339 --> 00:06:05,689
that there was<font color="#CCCCCC"> a firmware issue but it</font>

121
00:06:03,649 --> 00:06:10,509
<font color="#CCCCCC">censoring that perhaps</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> two were</font>

122
00:06:05,689 --> 00:06:13,429
<font color="#E5E5E5">related the third set</font><font color="#CCCCCC"> of claims is that</font>

123
00:06:10,509 --> 00:06:16,159
<font color="#E5E5E5">on some</font><font color="#CCCCCC"> of these implants</font><font color="#E5E5E5"> they were</font>

124
00:06:13,429 --> 00:06:19,489
actually put between the layers on the

125
00:06:16,159 --> 00:06:23,179
PCB<font color="#E5E5E5"> and then the most explosive claim is</font>

126
00:06:19,489 --> 00:06:25,878
that this was done by operatives from

127
00:06:23,179 --> 00:06:33,109
<font color="#E5E5E5">China the Chinese People's Liberation</font>

128
00:06:25,879 --> 00:06:36,229
Army with the story with this you know

129
00:06:33,110 --> 00:06:39,439
this many claims and this significant of

130
00:06:36,229 --> 00:06:41,568
<font color="#E5E5E5">of allegations we'd hope that</font><font color="#CCCCCC"> it'd be</font>

131
00:06:39,439 --> 00:06:44,839
really<font color="#CCCCCC"> well sourced and for a normal</font>

132
00:06:41,569 --> 00:06:48,110
story<font color="#E5E5E5"> 17 independent sources that</font>

133
00:06:44,839 --> 00:06:50,779
Bloomberg editors agreed to grant<font color="#E5E5E5"> an</font>

134
00:06:48,110 --> 00:06:53,929
<font color="#E5E5E5">amenity</font><font color="#CCCCCC"> to including</font><font color="#E5E5E5"> six national</font>

135
00:06:50,779 --> 00:06:56,509
<font color="#E5E5E5">security to people inside of AWS and</font>

136
00:06:53,929 --> 00:06:59,448
three senior insiders an<font color="#E5E5E5"> apple seems</font>

137
00:06:56,509 --> 00:07:00,979
like pretty solid source in except as

138
00:06:59,449 --> 00:07:03,409
soon as this<font color="#E5E5E5"> article was published</font>

139
00:07:00,979 --> 00:07:05,089
everyone denied it the Director of

140
00:07:03,409 --> 00:07:09,438
<font color="#E5E5E5">National Intelligence said they'd seen</font>

141
00:07:05,089 --> 00:07:11,599
no evidence<font color="#CCCCCC"> of this Amazon said that</font>

142
00:07:09,439 --> 00:07:13,819
<font color="#E5E5E5">they've never found any issues of</font>

143
00:07:11,599 --> 00:07:16,719
<font color="#E5E5E5">modified</font><font color="#CCCCCC"> hardware</font><font color="#E5E5E5"> nor have they been</font>

144
00:07:13,819 --> 00:07:20,299
<font color="#E5E5E5">engaged with the government</font><font color="#CCCCCC"> over it</font>

145
00:07:16,719 --> 00:07:22,909
Apple was even more blunt CEO Tim Cook

146
00:07:20,299 --> 00:07:26,989
said this did not happen<font color="#E5E5E5"> there is no</font>

147
00:07:22,909 --> 00:07:30,199
truth to<font color="#E5E5E5"> this and</font><font color="#CCCCCC"> Supermicro</font><font color="#E5E5E5"> wrote a</font>

148
00:07:26,989 --> 00:07:32,209
fairly lengthy letter about what they do

149
00:07:30,199 --> 00:07:36,069
to<font color="#CCCCCC"> protect the supply chain and why they</font>

150
00:07:32,209 --> 00:07:38,590
<font color="#CCCCCC">think this</font><font color="#E5E5E5"> attack did not happen</font><font color="#CCCCCC"> and</font>

151
00:07:36,069 --> 00:07:39,880
<font color="#E5E5E5">it's worth going through to look at</font>

152
00:07:38,590 --> 00:07:41,500
some of the things that<font color="#E5E5E5"> they they say</font>

153
00:07:39,880 --> 00:07:47,409
that they do to<font color="#E5E5E5"> protect their supply</font>

154
00:07:41,500 --> 00:07:50,080
chain<font color="#E5E5E5"> they point out</font><font color="#CCCCCC"> that if there's any</font>

155
00:07:47,410 --> 00:07:52,510
unauthorized<font color="#CCCCCC"> physical alterations during</font>

156
00:07:50,080 --> 00:07:54,280
the manufacturing process<font color="#E5E5E5"> other design</font>

157
00:07:52,510 --> 00:07:57,280
<font color="#CCCCCC">elements</font><font color="#E5E5E5"> would not match and those</font>

158
00:07:54,280 --> 00:08:00,609
things<font color="#E5E5E5"> would be detected to sort of</font>

159
00:07:57,280 --> 00:08:03,580
understand how<font color="#E5E5E5"> circuit boards are made</font><font color="#CCCCCC"> I</font>

160
00:08:00,610 --> 00:08:06,400
recently visited<font color="#E5E5E5"> a PCB Factory in</font>

161
00:08:03,580 --> 00:08:10,930
Guangzhou<font color="#CCCCCC"> this is not a super mikro</font>

162
00:08:06,400 --> 00:08:13,479
<font color="#CCCCCC">Factory</font><font color="#E5E5E5"> this is just a</font><font color="#CCCCCC"> holiday photos so</font>

163
00:08:10,930 --> 00:08:16,600
in<font color="#CCCCCC"> order to add new vias they would have</font>

164
00:08:13,480 --> 00:08:19,120
to<font color="#E5E5E5"> modify the drill files which would</font>

165
00:08:16,600 --> 00:08:21,310
then get electroplated if they had to

166
00:08:19,120 --> 00:08:23,980
add new traces they would have to be

167
00:08:21,310 --> 00:08:28,690
<font color="#CCCCCC">able to subvert</font><font color="#E5E5E5"> the masking and etching</font>

168
00:08:23,980 --> 00:08:31,120
process<font color="#E5E5E5"> and any changes to either the</font>

169
00:08:28,690 --> 00:08:34,030
drills<font color="#E5E5E5"> or the etching on individual</font>

170
00:08:31,120 --> 00:08:36,280
layers would<font color="#E5E5E5"> be caught by the</font><font color="#CCCCCC"> optical</font>

171
00:08:34,030 --> 00:08:40,480
inspection<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> done on</font><font color="#CCCCCC"> those bare</font>

172
00:08:36,280 --> 00:08:42,069
circuit boards additionally the

173
00:08:40,480 --> 00:08:44,800
allegation that<font color="#CCCCCC"> things were inserted</font>

174
00:08:42,070 --> 00:08:47,560
between circuit boards<font color="#CCCCCC"> would require</font>

175
00:08:44,800 --> 00:08:51,430
that<font color="#CCCCCC"> the lamination process be subverted</font>

176
00:08:47,560 --> 00:08:55,930
<font color="#CCCCCC">and the the</font><font color="#E5E5E5"> implants somehow aligned</font>

177
00:08:51,430 --> 00:08:57,880
<font color="#E5E5E5">into the system if that implant changes</font>

178
00:08:55,930 --> 00:09:00,459
any of the connectivity<font color="#E5E5E5"> the flying probe</font>

179
00:08:57,880 --> 00:09:03,070
testers would pick it up<font color="#E5E5E5"> or the bed of</font>

180
00:09:00,460 --> 00:09:06,040
nails<font color="#E5E5E5"> testers which checks all</font><font color="#CCCCCC"> of the</font>

181
00:09:03,070 --> 00:09:07,600
connectivity<font color="#CCCCCC"> of all the</font><font color="#E5E5E5"> traces to make</font>

182
00:09:06,040 --> 00:09:08,709
sure that<font color="#E5E5E5"> there are no shorts and to</font>

183
00:09:07,600 --> 00:09:11,940
make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that everything that</font><font color="#CCCCCC"> is</font>

184
00:09:08,710 --> 00:09:15,220
<font color="#E5E5E5">supposed to be connected</font><font color="#CCCCCC"> is electrically</font>

185
00:09:11,940 --> 00:09:19,750
conductive so it would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> very difficult</font>

186
00:09:15,220 --> 00:09:21,790
<font color="#CCCCCC">to circumvent</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> production process at</font>

187
00:09:19,750 --> 00:09:25,060
this<font color="#E5E5E5"> stage and it's also would be very</font>

188
00:09:21,790 --> 00:09:26,949
difficult to contain because the PCB

189
00:09:25,060 --> 00:09:30,719
factory<font color="#E5E5E5"> doesn't know which customers are</font>

190
00:09:26,950 --> 00:09:33,850
<font color="#E5E5E5">going to receive</font><font color="#CCCCCC"> those circuit boards</font>

191
00:09:30,720 --> 00:09:35,860
<font color="#CCCCCC">Supermicro also points out that</font><font color="#E5E5E5"> during</font>

192
00:09:33,850 --> 00:09:37,950
<font color="#E5E5E5">the assembly</font><font color="#CCCCCC"> process</font><font color="#E5E5E5"> when the parts are</font>

193
00:09:35,860 --> 00:09:42,640
<font color="#CCCCCC">installed</font><font color="#E5E5E5"> they have their employees</font>

194
00:09:37,950 --> 00:09:45,460
<font color="#CCCCCC">on-site the whole time</font><font color="#E5E5E5"> on my same</font>

195
00:09:42,640 --> 00:09:47,949
holiday trip I also visited some PCB

196
00:09:45,460 --> 00:09:50,590
assembly companies and spoke<font color="#E5E5E5"> with</font>

197
00:09:47,950 --> 00:09:52,990
companies that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> using</font>

198
00:09:50,590 --> 00:09:55,590
doing contract manufacturing<font color="#E5E5E5"> and they</font>

199
00:09:52,990 --> 00:09:58,780
said that they also send their<font color="#CCCCCC"> employees</font>

200
00:09:55,590 --> 00:10:00,550
<font color="#CCCCCC">to the production</font><font color="#E5E5E5"> line</font><font color="#CCCCCC"> to observe the</font>

201
00:09:58,780 --> 00:10:02,680
pick-and-place machines and the reflow

202
00:10:00,550 --> 00:10:04,569
and the rest of the<font color="#E5E5E5"> surface</font><font color="#CCCCCC"> mount</font>

203
00:10:02,680 --> 00:10:07,180
assembly

204
00:10:04,570 --> 00:10:09,610
their big concern<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that if they don't</font>

205
00:10:07,180 --> 00:10:11,109
<font color="#E5E5E5">have</font><font color="#CCCCCC"> someone there</font><font color="#E5E5E5"> the parts that are</font>

206
00:10:09,610 --> 00:10:13,990
fed into the picking place will be

207
00:10:11,110 --> 00:10:18,160
replaced with either<font color="#E5E5E5"> counterfeits</font><font color="#CCCCCC"> or</font>

208
00:10:13,990 --> 00:10:20,550
with salvaged parts<font color="#CCCCCC"> I visited the</font>

209
00:10:18,160 --> 00:10:23,620
electronics market<font color="#E5E5E5"> in Washington Bay</font>

210
00:10:20,550 --> 00:10:26,589
<font color="#CCCCCC">where there</font><font color="#E5E5E5"> are people disorder and a</font>

211
00:10:23,620 --> 00:10:28,660
waste<font color="#E5E5E5"> and then sorting the the parts and</font>

212
00:10:26,590 --> 00:10:31,870
the bins<font color="#E5E5E5"> and selling these salvaged</font>

213
00:10:28,660 --> 00:10:33,400
components by the kilo<font color="#CCCCCC"> and for a few</font>

214
00:10:31,870 --> 00:10:35,680
extra<font color="#E5E5E5"> from</font><font color="#CCCCCC"> NIMBY they'll put them on</font>

215
00:10:33,400 --> 00:10:39,630
<font color="#CCCCCC">reels</font><font color="#E5E5E5"> for you so that you can save a few</font>

216
00:10:35,680 --> 00:10:42,370
<font color="#E5E5E5">pennies on your</font><font color="#CCCCCC"> production process the</font>

217
00:10:39,630 --> 00:10:44,710
<font color="#CCCCCC">other concern that</font><font color="#E5E5E5"> these companies have</font>

218
00:10:42,370 --> 00:10:46,750
is not just salvaged parts but

219
00:10:44,710 --> 00:10:48,790
straight-up counterfeits<font color="#E5E5E5"> especially for</font>

220
00:10:46,750 --> 00:10:54,100
<font color="#E5E5E5">things that cost more than a few</font><font color="#CCCCCC"> dollars</font>

221
00:10:48,790 --> 00:10:56,079
each<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Arduino community was hit a</font><font color="#E5E5E5"> few</font>

222
00:10:54,100 --> 00:10:58,930
years ago<font color="#E5E5E5"> with a bunch of counterfeit</font>

223
00:10:56,080 --> 00:11:02,950
<font color="#CCCCCC">FTDI chips where the internal</font>

224
00:10:58,930 --> 00:11:03,370
construction<font color="#E5E5E5"> was entirely different in</font>

225
00:11:02,950 --> 00:11:07,840
this<font color="#E5E5E5"> case</font>

226
00:11:03,370 --> 00:11:09,880
it caused<font color="#E5E5E5"> reliability issues but you can</font>

227
00:11:07,840 --> 00:11:12,340
<font color="#CCCCCC">imagine from</font><font color="#E5E5E5"> a security perspective this</font>

228
00:11:09,880 --> 00:11:14,050
<font color="#E5E5E5">is really worrisome that parts that look</font>

229
00:11:12,340 --> 00:11:18,060
identical<font color="#CCCCCC"> might have completely</font>

230
00:11:14,050 --> 00:11:18,060
different functionality<font color="#CCCCCC"> inside of them</font>

231
00:11:19,380 --> 00:11:25,140
<font color="#CCCCCC">Supermicro also mentions that</font><font color="#E5E5E5"> they they</font>

232
00:11:22,330 --> 00:11:29,830
x-ray their main boards to look for

233
00:11:25,140 --> 00:11:31,900
<font color="#E5E5E5">anomalies and I wasn't able to take any</font>

234
00:11:29,830 --> 00:11:35,440
photos inside<font color="#E5E5E5"> a factory</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> was doing</font>

235
00:11:31,900 --> 00:11:37,959
x-rays<font color="#CCCCCC"> but</font><font color="#E5E5E5"> in this Wikipedia photo we</font>

236
00:11:35,440 --> 00:11:40,900
<font color="#CCCCCC">can clearly see</font><font color="#E5E5E5"> active components like</font>

237
00:11:37,960 --> 00:11:43,210
this SOI<font color="#E5E5E5"> see chip</font><font color="#CCCCCC"> are different from</font>

238
00:11:40,900 --> 00:11:46,000
<font color="#E5E5E5">things</font><font color="#CCCCCC"> like the SMD resistors and</font>

239
00:11:43,210 --> 00:11:49,450
capacitors<font color="#E5E5E5"> so if an attacker we're</font>

240
00:11:46,000 --> 00:11:51,430
trying to subvert the supply chain<font color="#CCCCCC"> by</font>

241
00:11:49,450 --> 00:11:54,100
<font color="#E5E5E5">putting a disguised component it could</font>

242
00:11:51,430 --> 00:11:55,989
be detected at this step another

243
00:11:54,100 --> 00:11:59,320
interesting thing in<font color="#E5E5E5"> this photo are</font>

244
00:11:55,990 --> 00:12:02,500
these these inductors<font color="#E5E5E5"> that are encased</font>

245
00:11:59,320 --> 00:12:03,650
in dip packages<font color="#CCCCCC"> this is really common in</font>

246
00:12:02,500 --> 00:12:06,589
a<font color="#CCCCCC"> lot of Ethernet board</font>

247
00:12:03,650 --> 00:12:08,029
and<font color="#E5E5E5"> occasionally people have thought</font>

248
00:12:06,589 --> 00:12:10,279
they had some sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> hardware implant</font>

249
00:12:08,029 --> 00:12:13,760
than they<font color="#E5E5E5"> found inductors and their</font>

250
00:12:10,279 --> 00:12:15,500
ethernet jacks but<font color="#E5E5E5"> it's pretty it's</font>

251
00:12:13,760 --> 00:12:19,790
fairly common<font color="#CCCCCC"> and it shows it pretty</font>

252
00:12:15,500 --> 00:12:23,900
clearly<font color="#E5E5E5"> on the x-ray some other</font><font color="#CCCCCC"> security</font>

253
00:12:19,790 --> 00:12:26,029
researchers like<font color="#CCCCCC"> Sophia - Antoine did an</font>

254
00:12:23,900 --> 00:12:29,600
extensive teardown<font color="#CCCCCC"> of Super Micro boards</font>

255
00:12:26,029 --> 00:12:33,470
<font color="#E5E5E5">including x-ray analysis and her group</font>

256
00:12:29,600 --> 00:12:35,420
found a few oddities<font color="#CCCCCC"> but nothing</font><font color="#E5E5E5"> they</font>

257
00:12:33,470 --> 00:12:37,810
didn't find anything<font color="#CCCCCC"> malicious there are</font>

258
00:12:35,420 --> 00:12:41,180
no smoking guns<font color="#E5E5E5"> they just appeared to be</font>

259
00:12:37,810 --> 00:12:42,770
sort of<font color="#E5E5E5"> supply chain type things</font><font color="#CCCCCC"> you can</font>

260
00:12:41,180 --> 00:12:45,609
read her blog<font color="#E5E5E5"> post for more details</font>

261
00:12:42,770 --> 00:12:48,350
<font color="#E5E5E5">about where they found things that</font>

262
00:12:45,610 --> 00:12:50,720
shouldn't have been<font color="#CCCCCC"> there but turned</font><font color="#E5E5E5"> out</font>

263
00:12:48,350 --> 00:12:59,720
to be<font color="#CCCCCC"> just actual signal conditioning</font>

264
00:12:50,720 --> 00:13:02,180
<font color="#E5E5E5">components so</font><font color="#CCCCCC"> super micro</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> their super</font>

265
00:12:59,720 --> 00:13:05,330
<font color="#CCCCCC">markers letter</font><font color="#E5E5E5"> they keep reinforcing</font>

266
00:13:02,180 --> 00:13:07,609
that the manufacturing process that<font color="#CCCCCC"> it's</font>

267
00:13:05,330 --> 00:13:10,370
the assembly process<font color="#E5E5E5"> it's during the</font>

268
00:13:07,610 --> 00:13:11,959
manufacturing process<font color="#CCCCCC"> and I agree with</font>

269
00:13:10,370 --> 00:13:15,500
<font color="#E5E5E5">them it would be</font><font color="#CCCCCC"> very difficult to</font>

270
00:13:11,959 --> 00:13:17,390
circumvent<font color="#E5E5E5"> their security in a</font>

271
00:13:15,500 --> 00:13:19,880
reasonable way<font color="#E5E5E5"> in that part of the</font>

272
00:13:17,390 --> 00:13:21,520
<font color="#CCCCCC">process but</font><font color="#E5E5E5"> that's not the only place</font>

273
00:13:19,880 --> 00:13:24,550
<font color="#E5E5E5">this could happen</font>

274
00:13:21,520 --> 00:13:26,990
we know that national security<font color="#CCCCCC"> agencies</font>

275
00:13:24,550 --> 00:13:31,130
<font color="#E5E5E5">intercept shipments of computer hardware</font>

276
00:13:26,990 --> 00:13:35,690
and then have<font color="#CCCCCC"> their tailored access</font>

277
00:13:31,130 --> 00:13:38,209
operations<font color="#E5E5E5"> open the computers install</font>

278
00:13:35,690 --> 00:13:39,680
<font color="#E5E5E5">Hardware implants reseal them and then</font>

279
00:13:38,209 --> 00:13:44,479
have them<font color="#E5E5E5"> continue on their</font><font color="#CCCCCC"> way in</font>

280
00:13:39,680 --> 00:13:49,029
<font color="#CCCCCC">shipment the NSA even has a catalogue of</font>

281
00:13:44,480 --> 00:13:51,920
<font color="#CCCCCC">hardware implants like this JTAG implant</font>

282
00:13:49,029 --> 00:13:54,830
ethernet jacks with embedded computers

283
00:13:51,920 --> 00:13:58,279
in them<font color="#E5E5E5"> as well as firmware specific</font>

284
00:13:54,830 --> 00:14:01,010
ones that<font color="#E5E5E5"> target servers</font><font color="#CCCCCC"> SMM and then</font>

285
00:13:58,279 --> 00:14:04,590
some that can do data exfiltration<font color="#CCCCCC"> via</font>

286
00:14:01,010 --> 00:14:06,480
RF so

287
00:14:04,590 --> 00:14:08,400
<font color="#E5E5E5">that sort of tailored access operations</font>

288
00:14:06,480 --> 00:14:10,590
is really ideal<font color="#E5E5E5"> for this supply chain</font>

289
00:14:08,400 --> 00:14:15,240
attack<font color="#E5E5E5"> because it allows them to contain</font>

290
00:14:10,590 --> 00:14:17,760
the the exploit<font color="#E5E5E5"> to a single customer</font><font color="#CCCCCC"> it</font>

291
00:14:15,240 --> 00:14:19,950
allows them fairly<font color="#E5E5E5"> good concealment</font>

292
00:14:17,760 --> 00:14:21,810
as well as good cover<font color="#E5E5E5"> that if it's</font>

293
00:14:19,950 --> 00:14:24,600
discovered<font color="#CCCCCC"> it's really hard to attribute</font>

294
00:14:21,810 --> 00:14:26,630
where things went<font color="#E5E5E5"> wrong unlike if</font><font color="#CCCCCC"> you</font>

295
00:14:24,600 --> 00:14:28,920
find something<font color="#CCCCCC"> inside your motherboard</font>

296
00:14:26,630 --> 00:14:38,550
<font color="#E5E5E5">between the layers you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> that had to</font>

297
00:14:28,920 --> 00:14:41,310
have happened<font color="#CCCCCC"> at</font><font color="#E5E5E5"> the factory so</font><font color="#CCCCCC"> super</font>

298
00:14:38,550 --> 00:14:47,099
<font color="#CCCCCC">micro also claimed that this was</font>

299
00:14:41,310 --> 00:14:49,319
technically implausible<font color="#E5E5E5"> that it was</font>

300
00:14:47,100 --> 00:14:52,230
highly<font color="#CCCCCC"> unlikely</font><font color="#E5E5E5"> that unauthorized</font>

301
00:14:49,320 --> 00:14:54,270
<font color="#E5E5E5">Hardware would</font><font color="#CCCCCC"> function properly because</font>

302
00:14:52,230 --> 00:14:58,580
a third party with lack complete

303
00:14:54,270 --> 00:15:03,660
knowledge of the<font color="#E5E5E5"> design</font><font color="#CCCCCC"> I think that's</font>

304
00:14:58,580 --> 00:15:09,290
inaccurate<font color="#E5E5E5"> both because we</font><font color="#CCCCCC"> know the</font><font color="#E5E5E5"> NSA</font>

305
00:15:03,660 --> 00:15:09,290
does it and also because<font color="#E5E5E5"> i-i've done it</font>

306
00:15:10,110 --> 00:15:16,050
really<font color="#E5E5E5"> all that you need to know is that</font>

307
00:15:13,350 --> 00:15:18,180
<font color="#E5E5E5">these are common components these flash</font>

308
00:15:16,050 --> 00:15:19,529
chips show up on all the boards<font color="#E5E5E5"> you can</font>

309
00:15:18,180 --> 00:15:23,069
<font color="#CCCCCC">search the internet</font><font color="#E5E5E5"> for the datasheet</font>

310
00:15:19,529 --> 00:15:25,740
<font color="#CCCCCC">and find exactly how its wired</font><font color="#E5E5E5"> into the</font>

311
00:15:23,070 --> 00:15:27,540
rest of the system<font color="#E5E5E5"> and the only thing</font>

312
00:15:25,740 --> 00:15:30,660
that we<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to know to communicate to</font>

313
00:15:27,540 --> 00:15:37,620
the BMC<font color="#E5E5E5"> is the serial output</font><font color="#CCCCCC"> pen from</font>

314
00:15:30,660 --> 00:15:41,100
this component so the BMC<font color="#E5E5E5"> flash is</font>

315
00:15:37,620 --> 00:15:43,769
connected over<font color="#E5E5E5"> to the BMC CPU</font><font color="#CCCCCC"> via the</font>

316
00:15:41,100 --> 00:15:47,010
serial output<font color="#CCCCCC"> and it goes through a</font>

317
00:15:43,769 --> 00:15:51,930
small series resistor and that<font color="#CCCCCC"> is where</font>

318
00:15:47,010 --> 00:15:55,230
my implant goes in<font color="#CCCCCC"> mine's a little bit</font>

319
00:15:51,930 --> 00:15:57,870
<font color="#E5E5E5">larger than</font><font color="#CCCCCC"> that resistor</font><font color="#E5E5E5"> it clips</font><font color="#CCCCCC"> on to</font>

320
00:15:55,230 --> 00:16:01,200
the board<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it has a small</font><font color="#CCCCCC"> FPGA</font><font color="#E5E5E5"> that</font>

321
00:15:57,870 --> 00:16:03,450
hangs off off side but it's<font color="#CCCCCC"> completely</font>

322
00:16:01,200 --> 00:16:09,089
plausible<font color="#E5E5E5"> to fit it</font><font color="#CCCCCC"> into something that</font>

323
00:16:03,450 --> 00:16:13,350
<font color="#E5E5E5">small</font><font color="#CCCCCC"> in fact</font><font color="#E5E5E5"> a modern arm m0 fits in</font>

324
00:16:09,089 --> 00:16:15,660
the<font color="#E5E5E5"> space of two</font><font color="#CCCCCC"> transistors from</font><font color="#E5E5E5"> a 6502</font>

325
00:16:13,350 --> 00:16:18,240
from a few years ago<font color="#E5E5E5"> you know the</font>

326
00:16:15,660 --> 00:16:21,089
Moore's law<font color="#E5E5E5"> means we can pack an amazing</font>

327
00:16:18,240 --> 00:16:26,579
amount<font color="#E5E5E5"> of CPU into a very very small</font>

328
00:16:21,089 --> 00:16:28,770
<font color="#CCCCCC">amount of space so you know on that that</font>

329
00:16:26,579 --> 00:16:31,620
zero<font color="#E5E5E5"> six zero</font><font color="#CCCCCC"> three resistor could fit</font>

330
00:16:28,770 --> 00:16:33,779
<font color="#CCCCCC">around a hundred</font><font color="#E5E5E5"> cortex-m</font><font color="#CCCCCC"> zeroes</font><font color="#E5E5E5"> would</font>

331
00:16:31,620 --> 00:16:37,800
be plenty<font color="#E5E5E5"> powerful</font><font color="#CCCCCC"> for it for</font><font color="#E5E5E5"> this</font>

332
00:16:33,779 --> 00:16:41,550
system the<font color="#E5E5E5"> problem is we only have those</font>

333
00:16:37,800 --> 00:16:44,219
two<font color="#E5E5E5"> pins</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> ordinarily on the spy flash</font>

334
00:16:41,550 --> 00:16:46,260
<font color="#CCCCCC">you need at least six pins but we don't</font>

335
00:16:44,220 --> 00:16:49,410
have power and<font color="#E5E5E5"> ground</font><font color="#CCCCCC"> so we have to</font>

336
00:16:46,260 --> 00:16:52,319
passively power<font color="#E5E5E5"> this through the the</font>

337
00:16:49,410 --> 00:16:54,660
data signal<font color="#CCCCCC"> that's passing through it we</font>

338
00:16:52,320 --> 00:16:57,060
don't<font color="#CCCCCC"> have the chip select pen</font><font color="#E5E5E5"> so we</font>

339
00:16:54,660 --> 00:17:00,569
have to guess when this chip is being

340
00:16:57,060 --> 00:17:03,899
talked to we<font color="#E5E5E5"> don't have the data input</font>

341
00:17:00,570 --> 00:17:05,280
pin<font color="#CCCCCC"> so we don't know what addresses are</font>

342
00:17:03,899 --> 00:17:07,589
being read or what commands are<font color="#E5E5E5"> being</font>

343
00:17:05,280 --> 00:17:11,369
sent<font color="#E5E5E5"> we have to reconstruct it</font><font color="#CCCCCC"> from the</font>

344
00:17:07,589 --> 00:17:13,800
data output pen<font color="#CCCCCC"> and we also don't have a</font>

345
00:17:11,369 --> 00:17:17,359
clock pen<font color="#E5E5E5"> so we have to figure</font><font color="#CCCCCC"> out how</font>

346
00:17:13,800 --> 00:17:17,359
<font color="#E5E5E5">to synchronize to that clock</font>

347
00:17:17,530 --> 00:17:22,930
lastly<font color="#E5E5E5"> we don't have the</font><font color="#CCCCCC"> ability to make</font>

348
00:17:20,770 --> 00:17:25,900
arbitrary<font color="#E5E5E5"> data changes all we can do is</font>

349
00:17:22,930 --> 00:17:28,180
disconnect<font color="#E5E5E5"> the</font><font color="#CCCCCC"> pen from the BMC</font><font color="#E5E5E5"> so we</font>

350
00:17:25,900 --> 00:17:31,360
can only turn<font color="#E5E5E5"> one bits into zero bits we</font>

351
00:17:28,180 --> 00:17:34,450
can't go the other<font color="#CCCCCC"> way</font><font color="#E5E5E5"> around</font><font color="#CCCCCC"> so with</font>

352
00:17:31,360 --> 00:17:37,379
these limitations<font color="#CCCCCC"> you know we we can</font>

353
00:17:34,450 --> 00:17:39,310
still do some pretty interesting<font color="#CCCCCC"> things</font>

354
00:17:37,380 --> 00:17:42,130
<font color="#CCCCCC">recovering</font><font color="#E5E5E5"> the clock is actually pretty</font>

355
00:17:39,310 --> 00:17:46,929
<font color="#E5E5E5">easy we can look at the data stream and</font>

356
00:17:42,130 --> 00:17:50,410
find the shortest bit<font color="#E5E5E5"> transitions from 0</font>

357
00:17:46,930 --> 00:17:53,950
1 0 or 1<font color="#CCCCCC"> 0 1 2 estimate what</font><font color="#E5E5E5"> the clock</font>

358
00:17:50,410 --> 00:17:57,240
<font color="#E5E5E5">is which allows us to then reconstruct</font>

359
00:17:53,950 --> 00:18:00,010
that data stream be<font color="#E5E5E5"> incident to the BMC</font>

360
00:17:57,240 --> 00:18:02,160
<font color="#CCCCCC">if we look at the flash contents</font><font color="#E5E5E5"> we can</font>

361
00:18:00,010 --> 00:18:06,040
see that<font color="#CCCCCC"> a lot of it is you know</font><font color="#E5E5E5"> fairly</font>

362
00:18:02,160 --> 00:18:07,960
random noise but a lot of<font color="#CCCCCC"> it is is all</font>

363
00:18:06,040 --> 00:18:12,550
white<font color="#E5E5E5"> which in this case would</font><font color="#CCCCCC"> mean</font><font color="#E5E5E5"> that</font>

364
00:18:07,960 --> 00:18:14,980
it's all 1 bits<font color="#CCCCCC"> so if we if we look</font><font color="#E5E5E5"> at</font>

365
00:18:12,550 --> 00:18:16,270
the<font color="#E5E5E5"> the way the flash is organized we</font>

366
00:18:14,980 --> 00:18:18,550
can see there's the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> u-boot</font>

367
00:18:16,270 --> 00:18:20,920
<font color="#CCCCCC">bootloader and that's executable that's</font>

368
00:18:18,550 --> 00:18:24,850
kind of<font color="#E5E5E5"> difficult to</font><font color="#CCCCCC"> make useful changes</font>

369
00:18:20,920 --> 00:18:27,790
then the kernel and<font color="#E5E5E5"> the root filesystem</font>

370
00:18:24,850 --> 00:18:31,030
are both compressed<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that they look</font>

371
00:18:27,790 --> 00:18:36,720
effectively like random noise but the

372
00:18:31,030 --> 00:18:40,240
<font color="#CCCCCC">NVRAM region is a JFS</font><font color="#E5E5E5"> to file system and</font>

373
00:18:36,720 --> 00:18:42,550
this file<font color="#E5E5E5"> system it's three Meg's</font><font color="#CCCCCC"> it's</font>

374
00:18:40,240 --> 00:18:46,360
<font color="#E5E5E5">mostly empty and all that empty space is</font>

375
00:18:42,550 --> 00:18:50,470
FF which is all ones<font color="#CCCCCC"> so this is</font><font color="#E5E5E5"> plenty</font>

376
00:18:46,360 --> 00:18:53,310
of<font color="#CCCCCC"> ones for</font><font color="#E5E5E5"> us to work on additionally</font>

377
00:18:50,470 --> 00:18:55,660
it has<font color="#E5E5E5"> fairly nice headers that</font><font color="#CCCCCC"> we can</font>

378
00:18:53,310 --> 00:18:57,760
we<font color="#E5E5E5"> can match on so when we see these</font>

379
00:18:55,660 --> 00:19:00,580
magic bit masks<font color="#E5E5E5"> we know when we've</font>

380
00:18:57,760 --> 00:19:04,840
entered different parts of the file

381
00:19:00,580 --> 00:19:06,879
system<font color="#E5E5E5"> so given that we</font><font color="#CCCCCC"> can now</font>

382
00:19:04,840 --> 00:19:09,280
reconstruct the clock we can figure out

383
00:19:06,880 --> 00:19:13,030
where we<font color="#CCCCCC"> are in the file system this</font>

384
00:19:09,280 --> 00:19:16,080
<font color="#E5E5E5">hardware implant can start to inject new</font>

385
00:19:13,030 --> 00:19:18,970
data<font color="#E5E5E5"> we're into what was the empty space</font>

386
00:19:16,080 --> 00:19:22,000
<font color="#E5E5E5">so this this short file that we put in</font>

387
00:19:18,970 --> 00:19:24,670
<font color="#E5E5E5">here is a small shell script</font>

388
00:19:22,000 --> 00:19:28,180
and it is one<font color="#CCCCCC"> of the network</font>

389
00:19:24,670 --> 00:19:33,130
configuration scripts<font color="#E5E5E5"> so this is where</font>

390
00:19:28,180 --> 00:19:38,470
I'm going<font color="#E5E5E5"> to try a live demo and I hope</font>

391
00:19:33,130 --> 00:19:40,080
this works<font color="#CCCCCC"> we're running in qmu since I</font>

392
00:19:38,470 --> 00:19:44,980
didn't bring a super<font color="#CCCCCC"> micro board</font><font color="#E5E5E5"> and</font>

393
00:19:40,080 --> 00:19:47,770
what we have on the left is the flash

394
00:19:44,980 --> 00:19:49,660
console<font color="#E5E5E5"> do</font><font color="#CCCCCC"> you need the hardware implant</font>

395
00:19:47,770 --> 00:19:52,780
console<font color="#E5E5E5"> and then on the right</font><font color="#CCCCCC"> we have</font>

396
00:19:49,660 --> 00:19:55,840
the serial console from the BMC<font color="#CCCCCC"> so we</font>

397
00:19:52,780 --> 00:19:58,840
can see I just<font color="#CCCCCC"> loaded the</font><font color="#E5E5E5"> the kernel and</font>

398
00:19:55,840 --> 00:20:01,990
then in a second<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> going to we</font><font color="#CCCCCC"> should</font>

399
00:19:58,840 --> 00:20:04,090
see a bunch<font color="#E5E5E5"> of traffic</font><font color="#CCCCCC"> okay so the</font>

400
00:20:01,990 --> 00:20:08,470
<font color="#E5E5E5">implant is active it has replaced the</font>

401
00:20:04,090 --> 00:20:11,290
data<font color="#CCCCCC"> when when that in vram filesystem</font>

402
00:20:08,470 --> 00:20:15,190
was mounted the BMC is now<font color="#E5E5E5"> continuing on</font>

403
00:20:11,290 --> 00:20:20,080
doing it<font color="#E5E5E5"> set up</font><font color="#CCCCCC"> it's going to load a</font>

404
00:20:15,190 --> 00:20:21,490
bunch<font color="#E5E5E5"> of device drivers for the video it</font>

405
00:20:20,080 --> 00:20:24,280
pauses here for some<font color="#E5E5E5"> reason that I</font>

406
00:20:21,490 --> 00:20:26,700
haven't diagnosed<font color="#E5E5E5"> because it's that's</font>

407
00:20:24,280 --> 00:20:26,700
not<font color="#CCCCCC"> my job</font>

408
00:20:28,120 --> 00:20:32,928
and eventually<font color="#E5E5E5"> it's going to configure</font>

409
00:20:30,590 --> 00:20:34,820
<font color="#E5E5E5">the networks and it does that by</font><font color="#CCCCCC"> running</font>

410
00:20:32,929 --> 00:20:41,590
that shell script<font color="#CCCCCC"> off of the NVRAM</font>

411
00:20:34,820 --> 00:20:46,270
partition<font color="#CCCCCC"> okay it starts the</font><font color="#E5E5E5"> KPM stuff</font>

412
00:20:41,590 --> 00:20:46,270
brings up some things<font color="#CCCCCC"> all right</font>

413
00:20:46,530 --> 00:20:49,649
[Music]

414
00:20:52,380 --> 00:20:55,370
[Applause]

415
00:20:52,480 --> 00:20:58,799
[Music]

416
00:20:55,370 --> 00:21:01,830
<font color="#E5E5E5">okay so</font><font color="#CCCCCC"> luckily</font><font color="#E5E5E5"> we got</font><font color="#CCCCCC"> to that point</font>

417
00:20:58,799 --> 00:21:04,070
without<font color="#CCCCCC"> you having</font><font color="#E5E5E5"> to fake the demo in</font>

418
00:21:01,830 --> 00:21:06,649
the hardware it's really flaky<font color="#CCCCCC"> my</font>

419
00:21:04,070 --> 00:21:09,600
<font color="#E5E5E5">version works about</font><font color="#CCCCCC"> one in eight times</font>

420
00:21:06,649 --> 00:21:11,309
<font color="#CCCCCC">but it doesn't typically cause a crash</font>

421
00:21:09,600 --> 00:21:13,199
so that's actually<font color="#E5E5E5"> good for concealment</font>

422
00:21:11,309 --> 00:21:16,710
<font color="#CCCCCC">because it</font><font color="#E5E5E5"> becomes now much harder to</font>

423
00:21:13,200 --> 00:21:18,750
determine<font color="#E5E5E5"> which machines are affected in</font>

424
00:21:16,710 --> 00:21:20,159
<font color="#E5E5E5">qmu because</font><font color="#CCCCCC"> it's simulating</font><font color="#E5E5E5"> it's a</font>

425
00:21:18,750 --> 00:21:24,269
little more reliable<font color="#E5E5E5"> but</font><font color="#CCCCCC"> it's still</font><font color="#E5E5E5"> it's</font>

426
00:21:20,159 --> 00:21:26,009
only<font color="#E5E5E5"> two out of three if we let the BMC</font>

427
00:21:24,269 --> 00:21:27,870
boot a little<font color="#CCCCCC"> bit further</font><font color="#E5E5E5"> it actually</font>

428
00:21:26,009 --> 00:21:30,570
prints out this<font color="#E5E5E5"> message and if you hit</font>

429
00:21:27,870 --> 00:21:32,850
<font color="#CCCCCC">enter it drops you to a shell with no</font>

430
00:21:30,570 --> 00:21:35,789
<font color="#CCCCCC">password</font><font color="#E5E5E5"> and you can then just run</font>

431
00:21:32,850 --> 00:21:38,549
commands<font color="#E5E5E5"> as root on</font><font color="#CCCCCC"> the BMC</font><font color="#E5E5E5"> and that's a</font>

432
00:21:35,789 --> 00:21:40,200
lot easier<font color="#E5E5E5"> than all this stuff with the</font>

433
00:21:38,549 --> 00:21:43,620
spy bus if you wanted to build<font color="#E5E5E5"> a</font>

434
00:21:40,200 --> 00:21:46,200
hardware implant against it<font color="#CCCCCC"> I don't know</font>

435
00:21:43,620 --> 00:21:48,508
where<font color="#E5E5E5"> the serial port is on the on the</font>

436
00:21:46,200 --> 00:21:51,690
<font color="#CCCCCC">super micro</font><font color="#E5E5E5"> but on a different tier one</font>

437
00:21:48,509 --> 00:21:53,730
<font color="#E5E5E5">server</font><font color="#CCCCCC"> mainboard I was able to probe</font>

438
00:21:51,690 --> 00:21:56,309
around with the<font color="#E5E5E5"> oscilloscope</font><font color="#CCCCCC"> and locate</font>

439
00:21:53,730 --> 00:22:00,090
the<font color="#E5E5E5"> serial console for the BMC figure</font>

440
00:21:56,309 --> 00:22:02,009
out it's 115<font color="#CCCCCC"> killa baud and it has the</font>

441
00:22:00,090 --> 00:22:05,759
same code<font color="#CCCCCC"> that you hit enter and you can</font>

442
00:22:02,009 --> 00:22:10,139
<font color="#E5E5E5">run commands there so that's a much</font>

443
00:22:05,759 --> 00:22:11,519
<font color="#CCCCCC">easier</font><font color="#E5E5E5"> way to do it</font><font color="#CCCCCC"> a big</font><font color="#E5E5E5"> question a lot</font>

444
00:22:10,139 --> 00:22:14,820
<font color="#E5E5E5">of people have is how</font><font color="#CCCCCC"> would we actually</font>

445
00:22:11,519 --> 00:22:17,129
detect this sort of flash implant<font color="#CCCCCC"> a lot</font>

446
00:22:14,820 --> 00:22:19,139
of high assurance sites replace all of

447
00:22:17,129 --> 00:22:22,019
<font color="#CCCCCC">their roms</font><font color="#E5E5E5"> with ones that they flash</font>

448
00:22:19,139 --> 00:22:24,539
themselves<font color="#E5E5E5"> but that doesn't give her</font><font color="#CCCCCC"> the</font>

449
00:22:22,019 --> 00:22:26,639
implant<font color="#E5E5E5"> because it's outside</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the ROM</font>

450
00:22:24,539 --> 00:22:28,830
chip

451
00:22:26,639 --> 00:22:31,860
likewise reading the<font color="#E5E5E5"> ROM chip it doesn't</font>

452
00:22:28,830 --> 00:22:35,220
show anything<font color="#E5E5E5"> because it's not in the</font>

453
00:22:31,860 --> 00:22:37,320
ROM itself<font color="#E5E5E5"> it sits outside of it even</font>

454
00:22:35,220 --> 00:22:40,080
<font color="#E5E5E5">hooking</font><font color="#CCCCCC"> up a logic analyzer to the bus</font>

455
00:22:37,320 --> 00:22:41,850
<font color="#E5E5E5">and watching as the machine boots</font><font color="#CCCCCC"> and</font>

456
00:22:40,080 --> 00:22:44,759
seeing the data<font color="#E5E5E5"> stream coming out of the</font>

457
00:22:41,850 --> 00:22:46,918
flash<font color="#E5E5E5"> won't</font><font color="#CCCCCC"> actually reveal the implant</font>

458
00:22:44,759 --> 00:22:50,490
<font color="#CCCCCC">because you would have</font><font color="#E5E5E5"> to put the logic</font>

459
00:22:46,919 --> 00:22:52,649
probes on the BGA pads<font color="#E5E5E5"> on the flat on</font>

460
00:22:50,490 --> 00:22:54,950
the<font color="#E5E5E5"> BMC itself and that's</font><font color="#CCCCCC"> a much harder</font>

461
00:22:52,649 --> 00:22:54,949
task

462
00:22:55,110 --> 00:22:59,409
some people think<font color="#E5E5E5"> oh well we can see the</font>

463
00:22:57,700 --> 00:23:02,560
<font color="#E5E5E5">the weird network traffic when the BMC</font>

464
00:22:59,410 --> 00:23:04,540
tries to exfiltrate the data but<font color="#CCCCCC"> that</font>

465
00:23:02,560 --> 00:23:06,850
would be<font color="#CCCCCC"> that's only one way for the for</font>

466
00:23:04,540 --> 00:23:09,310
the BMC to affect things<font color="#E5E5E5"> there's a great</font>

467
00:23:06,850 --> 00:23:11,669
talk<font color="#CCCCCC"> a few</font><font color="#E5E5E5"> years ago at</font><font color="#CCCCCC"> Def Con</font><font color="#E5E5E5"> from</font>

468
00:23:09,310 --> 00:23:13,629
<font color="#E5E5E5">Intel ATR where they showed how</font>

469
00:23:11,670 --> 00:23:16,300
something that<font color="#E5E5E5"> can control the system</font>

470
00:23:13,630 --> 00:23:18,580
<font color="#E5E5E5">firmware can backdoor hypervisors and</font>

471
00:23:16,300 --> 00:23:22,030
then they<font color="#CCCCCC"> give a use case where a</font>

472
00:23:18,580 --> 00:23:25,629
unprivileged guest on a cloud system

473
00:23:22,030 --> 00:23:27,280
could read all<font color="#CCCCCC"> of the rest of physical</font>

474
00:23:25,630 --> 00:23:33,610
memory<font color="#E5E5E5"> so you could see all of the other</font>

475
00:23:27,280 --> 00:23:35,740
<font color="#CCCCCC">guest memory so what do we do</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> you</font>

476
00:23:33,610 --> 00:23:38,020
know<font color="#E5E5E5"> it's the big problem is the BMC has</font>

477
00:23:35,740 --> 00:23:40,050
<font color="#E5E5E5">way too many privileges</font><font color="#CCCCCC"> it's connected</font>

478
00:23:38,020 --> 00:23:44,680
<font color="#CCCCCC">to pretty much everything</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> system</font>

479
00:23:40,050 --> 00:23:47,110
but the BMC is not our only concern<font color="#CCCCCC"> as</font>

480
00:23:44,680 --> 00:23:48,700
white<font color="#CCCCCC"> quark said our PCs are just a</font>

481
00:23:47,110 --> 00:23:52,300
bunch<font color="#CCCCCC"> of embedded devices in a trench</font>

482
00:23:48,700 --> 00:23:54,460
coat<font color="#E5E5E5"> and they all have firmware in fact</font>

483
00:23:52,300 --> 00:23:56,560
pretty<font color="#CCCCCC"> much everything on</font><font color="#E5E5E5"> your system</font>

484
00:23:54,460 --> 00:23:58,450
more complex<font color="#E5E5E5"> than a resistor probably</font>

485
00:23:56,560 --> 00:24:01,210
has firmware and<font color="#E5E5E5"> if you have one of</font>

486
00:23:58,450 --> 00:24:04,920
<font color="#E5E5E5">those</font><font color="#CCCCCC"> super micro implants maybe even</font>

487
00:24:01,210 --> 00:24:04,920
your resistors have firmware as well

488
00:24:05,220 --> 00:24:10,890
<font color="#CCCCCC">I've found</font><font color="#E5E5E5"> that the firmware and things</font>

489
00:24:08,350 --> 00:24:13,570
like the<font color="#E5E5E5"> power supplies can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> used to</font>

490
00:24:10,890 --> 00:24:16,150
gain code execution on the<font color="#E5E5E5"> BMC you know</font>

491
00:24:13,570 --> 00:24:19,540
it's<font color="#E5E5E5"> really interesting how tightly</font>

492
00:24:16,150 --> 00:24:21,820
connected all of<font color="#CCCCCC"> our systems are and as</font>

493
00:24:19,540 --> 00:24:24,149
<font color="#E5E5E5">Joe Fitz pointed out in his black head</font>

494
00:24:21,820 --> 00:24:26,620
<font color="#CCCCCC">to you talk you know these are not</font>

495
00:24:24,150 --> 00:24:29,650
<font color="#E5E5E5">multi-million dollar attacks that these</font>

496
00:24:26,620 --> 00:24:32,340
<font color="#E5E5E5">are</font><font color="#CCCCCC"> five euro</font><font color="#E5E5E5"> bits of hardware that</font><font color="#CCCCCC"> we</font>

497
00:24:29,650 --> 00:24:36,370
now have to really be worried about<font color="#E5E5E5"> I</font>

498
00:24:32,340 --> 00:24:38,530
really<font color="#E5E5E5"> like the guidelines that the NIST</font>

499
00:24:36,370 --> 00:24:40,209
is published<font color="#E5E5E5"> that</font><font color="#CCCCCC"> suggests that</font><font color="#E5E5E5"> we think</font>

500
00:24:38,530 --> 00:24:43,450
about our systems more<font color="#E5E5E5"> in this holistic</font>

501
00:24:40,210 --> 00:24:46,380
<font color="#E5E5E5">manner although</font><font color="#CCCCCC"> they end up Rudi and</font>

502
00:24:43,450 --> 00:24:49,450
pretty much everything into the TPM<font color="#CCCCCC"> is</font>

503
00:24:46,380 --> 00:24:53,380
<font color="#CCCCCC">the trusted</font><font color="#E5E5E5"> platform module for doing</font>

504
00:24:49,450 --> 00:24:55,060
this attestation<font color="#CCCCCC"> and I think we as a</font>

505
00:24:53,380 --> 00:24:56,620
community need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do more to use the</font>

506
00:24:55,060 --> 00:25:00,070
TPMS<font color="#E5E5E5"> they're actually a really good tool</font>

507
00:24:56,620 --> 00:25:01,870
for securing<font color="#E5E5E5"> our systems</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> they are</font>

508
00:25:00,070 --> 00:25:05,169
also potentially subject<font color="#CCCCCC"> to their own</font>

509
00:25:01,870 --> 00:25:07,559
<font color="#CCCCCC">Hardware implants the NCC</font><font color="#E5E5E5"> group TPM</font><font color="#CCCCCC"> geni</font>

510
00:25:05,170 --> 00:25:10,740
<font color="#E5E5E5">is able to subvert the</font>

511
00:25:07,559 --> 00:25:14,428
the core root of trust<font color="#E5E5E5"> by interposing on</font>

512
00:25:10,740 --> 00:25:16,049
the TPM so a lot<font color="#E5E5E5"> of folks are proposing</font>

513
00:25:14,429 --> 00:25:18,480
<font color="#E5E5E5">we should move to</font><font color="#CCCCCC"> other trusted</font>

514
00:25:16,049 --> 00:25:20,759
execution<font color="#E5E5E5"> environments like</font><font color="#CCCCCC"> SGX or trust</font>

515
00:25:18,480 --> 00:25:23,399
<font color="#CCCCCC">owned</font><font color="#E5E5E5"> and I think these have a lot of</font>

516
00:25:20,759 --> 00:25:27,629
promise<font color="#CCCCCC"> especially for for trusted cloud</font>

517
00:25:23,399 --> 00:25:29,908
computing<font color="#CCCCCC"> there also there's a lot of</font>

518
00:25:27,629 --> 00:25:31,918
innovation<font color="#CCCCCC"> in Hardware roots of</font><font color="#E5E5E5"> trust</font>

519
00:25:29,909 --> 00:25:33,600
<font color="#E5E5E5">going</font><font color="#CCCCCC"> on right now</font><font color="#E5E5E5"> between the</font><font color="#CCCCCC"> Google</font>

520
00:25:31,919 --> 00:25:35,039
Titan which initially was<font color="#E5E5E5"> for their</font>

521
00:25:33,600 --> 00:25:37,320
servers and<font color="#E5E5E5"> there's now showing up in</font>

522
00:25:35,039 --> 00:25:39,840
all<font color="#CCCCCC"> of their Chromebooks</font><font color="#E5E5E5"> the Microsoft</font>

523
00:25:37,320 --> 00:25:44,189
Cerberus chip which again is<font color="#E5E5E5"> the is your</font>

524
00:25:39,840 --> 00:25:46,678
<font color="#E5E5E5">system</font><font color="#CCCCCC"> they're actually publishing</font><font color="#E5E5E5"> their</font>

525
00:25:44,190 --> 00:25:47,940
<font color="#E5E5E5">firmware and the ASIC design</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font>

526
00:25:46,679 --> 00:25:49,619
people can have<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> more faith in</font>

527
00:25:47,940 --> 00:25:53,369
<font color="#E5E5E5">it and they hope it</font><font color="#CCCCCC"> will become</font><font color="#E5E5E5"> an open</font>

528
00:25:49,619 --> 00:25:56,129
standard in companies<font color="#E5E5E5"> like Apple have</font>

529
00:25:53,369 --> 00:25:58,499
<font color="#CCCCCC">also gone their own</font><font color="#E5E5E5"> way with</font><font color="#CCCCCC"> the t2 and</font>

530
00:25:56,129 --> 00:26:00,539
the teachers are<font color="#CCCCCC"> really amazing ship for</font>

531
00:25:58,499 --> 00:26:04,860
securing systems<font color="#E5E5E5"> but it does so at the</font>

532
00:26:00,539 --> 00:26:06,658
expense of user<font color="#E5E5E5"> freedom and that gets in</font>

533
00:26:04,860 --> 00:26:09,508
the<font color="#E5E5E5"> way</font><font color="#CCCCCC"> of what I think</font><font color="#E5E5E5"> the real way</font>

534
00:26:06,659 --> 00:26:11,100
<font color="#CCCCCC">that we need</font><font color="#E5E5E5"> to we need to solve this</font>

535
00:26:09,509 --> 00:26:15,539
problems we need<font color="#E5E5E5"> to get rid</font><font color="#CCCCCC"> of a lot of</font>

536
00:26:11,100 --> 00:26:18,779
these secrets counter to what the<font color="#E5E5E5"> super</font>

537
00:26:15,539 --> 00:26:20,309
<font color="#CCCCCC">micro CEO said having a secret</font>

538
00:26:18,779 --> 00:26:22,590
motherboard design does not<font color="#CCCCCC"> make you</font>

539
00:26:20,309 --> 00:26:24,899
more secure things like the Open Compute

540
00:26:22,590 --> 00:26:26,850
<font color="#CCCCCC">Hardware I think is a good vision</font><font color="#E5E5E5"> for</font>

541
00:26:24,899 --> 00:26:29,610
how we<font color="#E5E5E5"> can move forward</font><font color="#CCCCCC"> that when you</font>

542
00:26:26,850 --> 00:26:32,399
buy an Open Compute server it comes with

543
00:26:29,610 --> 00:26:35,340
the<font color="#CCCCCC"> full schematics and Gerber files so</font>

544
00:26:32,399 --> 00:26:37,649
<font color="#CCCCCC">that motivated customers can verify that</font>

545
00:26:35,340 --> 00:26:40,379
<font color="#E5E5E5">the systems that they're buying are the</font>

546
00:26:37,649 --> 00:26:41,998
ones<font color="#E5E5E5"> that they think they that they're</font>

547
00:26:40,379 --> 00:26:43,110
buying<font color="#E5E5E5"> that all of the components are</font>

548
00:26:41,999 --> 00:26:47,369
what<font color="#E5E5E5"> they think they</font><font color="#CCCCCC"> should</font><font color="#E5E5E5"> be</font>

549
00:26:43,110 --> 00:26:49,949
I think the firmware<font color="#E5E5E5"> also needs more</font>

550
00:26:47,369 --> 00:26:53,549
openness<font color="#E5E5E5"> Ron Minich at Google is my</font>

551
00:26:49,950 --> 00:26:55,950
co-lead<font color="#E5E5E5"> on Linux</font><font color="#CCCCCC"> boot project</font><font color="#E5E5E5"> and we</font>

552
00:26:53,549 --> 00:26:59,070
think that Linux in the firmware<font color="#E5E5E5"> is a</font>

553
00:26:55,950 --> 00:27:03,869
way forward<font color="#CCCCCC"> to get a more secure more</font>

554
00:26:59,070 --> 00:27:06,330
flexible and<font color="#E5E5E5"> more resilient system we're</font>

555
00:27:03,869 --> 00:27:09,959
working with a<font color="#E5E5E5"> spin-off project called</font>

556
00:27:06,330 --> 00:27:13,439
micro<font color="#CCCCCC"> BMC that is using the Linux boot</font>

557
00:27:09,960 --> 00:27:14,100
tools to build BMC firmware<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is</font>

558
00:27:13,440 --> 00:27:17,429
<font color="#E5E5E5">open source</font>

559
00:27:14,100 --> 00:27:19,529
<font color="#E5E5E5">it's reproducibly built it can work with</font>

560
00:27:17,429 --> 00:27:20,540
roots of<font color="#E5E5E5"> trust for attestation it's</font>

561
00:27:19,529 --> 00:27:23,060
written<font color="#E5E5E5"> in a</font>

562
00:27:20,540 --> 00:27:25,700
you memory safe language<font color="#E5E5E5"> since it's a</font>

563
00:27:23,060 --> 00:27:27,830
<font color="#E5E5E5">Google</font><font color="#CCCCCC"> collaboration</font><font color="#E5E5E5"> and go and more</font>

564
00:27:25,700 --> 00:27:30,140
importantly we've thrown<font color="#CCCCCC"> away all of</font><font color="#E5E5E5"> the</font>

565
00:27:27,830 --> 00:27:32,350
legacy features that have been<font color="#CCCCCC"> a source</font>

566
00:27:30,140 --> 00:27:38,930
<font color="#E5E5E5">of a</font><font color="#CCCCCC"> lot of security vulnerabilities in</font>

567
00:27:32,350 --> 00:27:42,020
these systems<font color="#E5E5E5"> so did it happen I don't</font>

568
00:27:38,930 --> 00:27:42,380
<font color="#CCCCCC">know</font><font color="#E5E5E5"> is it technically possible</font><font color="#CCCCCC"> I think</font>

569
00:27:42,020 --> 00:27:44,150
so

570
00:27:42,380 --> 00:27:45,680
I hope I've convinced all<font color="#E5E5E5"> of you that</font>

571
00:27:44,150 --> 00:27:47,060
this is<font color="#E5E5E5"> definitely a technical</font>

572
00:27:45,680 --> 00:27:51,680
possibility that<font color="#E5E5E5"> we need to be concerned</font>

573
00:27:47,060 --> 00:27:54,830
<font color="#CCCCCC">about and I hope that the way forward</font>

574
00:27:51,680 --> 00:27:57,020
through<font color="#CCCCCC"> Hardware roots of trust with</font>

575
00:27:54,830 --> 00:27:59,929
attestation<font color="#E5E5E5"> and</font><font color="#CCCCCC"> more importantly with</font>

576
00:27:57,020 --> 00:28:01,790
open<font color="#E5E5E5"> hardware so that</font><font color="#CCCCCC"> we know that what</font>

577
00:27:59,930 --> 00:28:04,970
the machines were running<font color="#E5E5E5"> are running</font>

578
00:28:01,790 --> 00:28:07,399
code that we know<font color="#E5E5E5"> the code that we built</font>

579
00:28:04,970 --> 00:28:10,460
<font color="#E5E5E5">that we understand and that we can</font>

580
00:28:07,400 --> 00:28:13,730
actually<font color="#E5E5E5"> have</font><font color="#CCCCCC"> a good chance of be</font><font color="#E5E5E5"> able</font>

581
00:28:10,460 --> 00:28:15,890
to take<font color="#E5E5E5"> control back of</font><font color="#CCCCCC"> them if you're</font>

582
00:28:13,730 --> 00:28:18,320
interested<font color="#CCCCCC"> in more discussion on</font><font color="#E5E5E5"> this</font>

583
00:28:15,890 --> 00:28:22,070
<font color="#E5E5E5">and also an open firmware there's an</font>

584
00:28:18,320 --> 00:28:23,600
assembly<font color="#E5E5E5"> here in this hall</font><font color="#CCCCCC"> that has a</font>

585
00:28:22,070 --> 00:28:26,240
<font color="#E5E5E5">bunch of folks working on</font><font color="#CCCCCC"> coreboot and</font>

586
00:28:23,600 --> 00:28:29,000
Linux boot and a lot of<font color="#CCCCCC"> these projects</font>

587
00:28:26,240 --> 00:28:31,760
where you<font color="#CCCCCC"> can help contribute</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

588
00:28:29,000 --> 00:28:36,710
can help also<font color="#E5E5E5"> pressure vendors to make</font>

589
00:28:31,760 --> 00:28:39,860
these this<font color="#E5E5E5"> a standard and a way forward</font>

590
00:28:36,710 --> 00:28:41,750
<font color="#E5E5E5">for a more secure computing so thank you</font>

591
00:28:39,860 --> 00:28:45,479
all<font color="#CCCCCC"> for coming and</font><font color="#E5E5E5"> I really</font><font color="#CCCCCC"> enjoyed the</font>

592
00:28:41,750 --> 00:28:45,630
chance to show off<font color="#CCCCCC"> my</font><font color="#E5E5E5"> MA up of the state</font>

593
00:28:45,480 --> 00:28:53,550
[Applause]

594
00:28:45,630 --> 00:28:56,700
[Music]

595
00:28:53,550 --> 00:28:56,700
[Applause]

596
00:28:57,190 --> 00:29:02,899
create<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> thank you very</font><font color="#E5E5E5"> much trouble</font>

597
00:29:00,109 --> 00:29:04,820
<font color="#CCCCCC">now we have 10 minutes</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> questions so</font>

598
00:29:02,899 --> 00:29:10,248
please line up at<font color="#E5E5E5"> the microphones if you</font>

599
00:29:04,820 --> 00:29:12,499
<font color="#CCCCCC">have questions and</font><font color="#E5E5E5"> we also have the</font>

600
00:29:10,249 --> 00:29:18,009
signalization<font color="#E5E5E5"> problems with questions</font>

601
00:29:12,499 --> 00:29:18,009
from the<font color="#CCCCCC"> internet so</font>

602
00:29:20,290 --> 00:29:36,820
any questions microphone number<font color="#E5E5E5"> three</font>

603
00:29:26,910 --> 00:29:39,310
yes -<font color="#CCCCCC"> pc-based once so the question is</font>

604
00:29:36,820 --> 00:29:42,129
about the<font color="#E5E5E5"> Tallis power</font><font color="#CCCCCC"> nine based</font>

605
00:29:39,310 --> 00:29:46,690
systems<font color="#CCCCCC"> paradigm is a really interesting</font>

606
00:29:42,130 --> 00:29:49,270
architecture the<font color="#E5E5E5"> it is using a open</font>

607
00:29:46,690 --> 00:29:52,870
firmware<font color="#CCCCCC"> very similar to Linux boot</font>

608
00:29:49,270 --> 00:29:56,379
called a<font color="#E5E5E5"> pedi boot that moves</font><font color="#CCCCCC"> Linux into</font>

609
00:29:52,870 --> 00:29:57,310
the<font color="#E5E5E5"> bootloader</font><font color="#CCCCCC"> I'm a big fan there's a</font>

610
00:29:56,380 --> 00:30:00,000
lot of folks in the open-source

611
00:29:57,310 --> 00:30:04,540
<font color="#E5E5E5">community who are very excited about it</font>

612
00:30:00,000 --> 00:30:07,900
<font color="#CCCCCC">I'm hoping that there</font><font color="#E5E5E5"> would be more more</font>

613
00:30:04,540 --> 00:30:10,210
power<font color="#E5E5E5"> 9 systems coming out</font><font color="#CCCCCC"> I'm also</font><font color="#E5E5E5"> very</font>

614
00:30:07,900 --> 00:30:15,010
excited<font color="#E5E5E5"> about the risk</font><font color="#CCCCCC"> 5 systems I think</font>

615
00:30:10,210 --> 00:30:18,160
having<font color="#CCCCCC"> open-source CPUs is a real way</font>

616
00:30:15,010 --> 00:30:22,090
that<font color="#CCCCCC"> we can have more</font><font color="#E5E5E5"> assurance that our</font>

617
00:30:18,160 --> 00:30:30,370
<font color="#E5E5E5">systems are what we</font><font color="#CCCCCC"> think they are</font><font color="#E5E5E5"> thank</font>

618
00:30:22,090 --> 00:30:32,830
you - please scope probe over<font color="#CCCCCC"> this</font>

619
00:30:30,370 --> 00:30:35,260
<font color="#E5E5E5">serial because it's just a series</font>

620
00:30:32,830 --> 00:30:36,970
resistor which<font color="#E5E5E5"> were replacing if you</font>

621
00:30:35,260 --> 00:30:38,650
just put<font color="#CCCCCC"> - scope probes on there and</font>

622
00:30:36,970 --> 00:30:40,090
measure<font color="#E5E5E5"> the voltage over it in your</font>

623
00:30:38,650 --> 00:30:43,750
situation<font color="#E5E5E5"> you would see a voltage change</font>

624
00:30:40,090 --> 00:30:46,560
there once in a while<font color="#E5E5E5"> yes normal case</font>

625
00:30:43,750 --> 00:30:50,350
which is actually quite constant current

626
00:30:46,560 --> 00:30:53,280
<font color="#E5E5E5">so if you lower</font><font color="#CCCCCC"> the input impedance of</font>

627
00:30:50,350 --> 00:30:56,050
<font color="#E5E5E5">the</font><font color="#CCCCCC"> BMC chip you might already have</font>

628
00:30:53,280 --> 00:30:58,120
already have seen you we already might

629
00:30:56,050 --> 00:30:59,649
have already<font color="#E5E5E5"> have fixed part of the</font>

630
00:30:58,120 --> 00:31:02,080
attack<font color="#E5E5E5"> because the output sourcing</font>

631
00:30:59,650 --> 00:31:04,810
<font color="#CCCCCC">current of your export is probably</font>

632
00:31:02,080 --> 00:31:11,800
limited<font color="#E5E5E5"> due to</font><font color="#CCCCCC"> the limited supply you</font>

633
00:31:04,810 --> 00:31:13,990
<font color="#E5E5E5">only case</font><font color="#CCCCCC"> but do you see a way to</font>

634
00:31:11,800 --> 00:31:16,419
actually get<font color="#E5E5E5"> more power into your set it</font>

635
00:31:13,990 --> 00:31:19,150
<font color="#CCCCCC">may be using about other power sources</font>

636
00:31:16,420 --> 00:31:23,770
other than the<font color="#E5E5E5"> two pins or maybe there's</font>

637
00:31:19,150 --> 00:31:26,190
<font color="#E5E5E5">some</font><font color="#CCCCCC"> way of would would it</font><font color="#E5E5E5"> be a way</font><font color="#CCCCCC"> to</font>

638
00:31:23,770 --> 00:31:28,700
do more<font color="#E5E5E5"> arbitrary changes through</font>

639
00:31:26,190 --> 00:31:31,250
<font color="#E5E5E5">redesigning the implant</font>

640
00:31:28,700 --> 00:31:34,100
one of the goals<font color="#CCCCCC"> was to fit with</font><font color="#E5E5E5"> only</font>

641
00:31:31,250 --> 00:31:36,290
those two pins<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that a single piece on</font>

642
00:31:34,100 --> 00:31:37,340
the motherboard could be<font color="#E5E5E5"> replaced</font><font color="#CCCCCC"> you</font>

643
00:31:36,290 --> 00:31:39,320
know with it with the dual probe

644
00:31:37,340 --> 00:31:41,209
soldering iron you<font color="#CCCCCC"> can pop it out and</font>

645
00:31:39,320 --> 00:31:46,159
stick a new one down<font color="#E5E5E5"> in a matter of</font>

646
00:31:41,210 --> 00:31:49,160
seconds<font color="#CCCCCC"> so yes if you have more if you</font>

647
00:31:46,160 --> 00:31:51,080
have<font color="#E5E5E5"> more pins where you can get more</font>

648
00:31:49,160 --> 00:31:55,700
power<font color="#E5E5E5"> from you can do much more</font>

649
00:31:51,080 --> 00:31:57,260
interesting things<font color="#E5E5E5"> but</font><font color="#CCCCCC"> that would</font>

650
00:31:55,700 --> 00:31:59,770
require<font color="#E5E5E5"> a different</font><font color="#CCCCCC"> set of changes</font><font color="#E5E5E5"> to</font>

651
00:31:57,260 --> 00:32:03,910
the motherboard

652
00:31:59,770 --> 00:32:03,910
<font color="#E5E5E5">thank you microphone</font><font color="#CCCCCC"> one please</font>

653
00:32:05,950 --> 00:32:11,390
arguments<font color="#E5E5E5"> that these implants were</font><font color="#CCCCCC"> not</font>

654
00:32:08,660 --> 00:32:12,890
feasible<font color="#E5E5E5"> by a</font><font color="#CCCCCC"> super microworld we also</font>

655
00:32:11,390 --> 00:32:14,900
showed the pictures from the fab that

656
00:32:12,890 --> 00:32:17,720
you have to<font color="#E5E5E5"> change the edging and the</font>

657
00:32:14,900 --> 00:32:22,700
optical inspection and so on and so on

658
00:32:17,720 --> 00:32:27,170
<font color="#E5E5E5">but how</font><font color="#CCCCCC"> paavo would you</font><font color="#E5E5E5"> wait the fact</font>

659
00:32:22,700 --> 00:32:29,360
that some actor just<font color="#E5E5E5"> intercepted the</font>

660
00:32:27,170 --> 00:32:31,370
manufacturing files and<font color="#CCCCCC"> added that</font>

661
00:32:29,360 --> 00:32:33,740
<font color="#E5E5E5">component</font><font color="#CCCCCC"> over a new</font><font color="#E5E5E5"> file because then</font>

662
00:32:31,370 --> 00:32:36,050
all the<font color="#E5E5E5"> in</font><font color="#CCCCCC"> an optical optical inspection</font>

663
00:32:33,740 --> 00:32:38,690
and that would all say well that matches

664
00:32:36,050 --> 00:32:41,090
<font color="#E5E5E5">what was sent to us but</font><font color="#CCCCCC"> that is</font><font color="#E5E5E5"> not</font>

665
00:32:38,690 --> 00:32:43,730
necessarily what<font color="#CCCCCC"> went Micro</font><font color="#E5E5E5"> sent to the</font>

666
00:32:41,090 --> 00:32:45,439
<font color="#E5E5E5">family so the question is could someone</font>

667
00:32:43,730 --> 00:32:47,060
have<font color="#E5E5E5"> modified all of the manufacturing</font>

668
00:32:45,440 --> 00:32:49,280
files that went to the<font color="#E5E5E5"> factory and</font>

669
00:32:47,060 --> 00:32:51,350
<font color="#E5E5E5">that's absolutely</font><font color="#CCCCCC"> a possibility</font><font color="#E5E5E5"> but</font>

670
00:32:49,280 --> 00:32:54,830
<font color="#E5E5E5">that's also very likely that that would</font>

671
00:32:51,350 --> 00:32:57,889
be detected by<font color="#E5E5E5"> the super</font><font color="#CCCCCC"> micro itself</font>

672
00:32:54,830 --> 00:33:00,740
that<font color="#E5E5E5"> in a lot of cases you don't</font>

673
00:32:57,890 --> 00:33:02,570
<font color="#E5E5E5">necessarily want</font><font color="#CCCCCC"> to trust the the</font>

674
00:33:00,740 --> 00:33:05,030
company that is making<font color="#E5E5E5"> the product to</font>

675
00:33:02,570 --> 00:33:07,129
also test<font color="#CCCCCC"> it you know you probably</font><font color="#E5E5E5"> want</font>

676
00:33:05,030 --> 00:33:09,830
<font color="#CCCCCC">to have a separate company that does</font>

677
00:33:07,130 --> 00:33:11,840
random spot checks<font color="#E5E5E5"> to verify that the</font>

678
00:33:09,830 --> 00:33:14,810
boards are<font color="#CCCCCC"> actually being produced</font><font color="#E5E5E5"> to</font>

679
00:33:11,840 --> 00:33:18,610
the specification<font color="#E5E5E5"> that you that you</font>

680
00:33:14,810 --> 00:33:21,350
desire so it's<font color="#E5E5E5"> certainly possible and</font>

681
00:33:18,610 --> 00:33:24,110
you<font color="#E5E5E5"> know I really</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> wanna speculate</font>

682
00:33:21,350 --> 00:33:27,620
as to you know<font color="#E5E5E5"> the accuracy</font><font color="#CCCCCC"> of that</font><font color="#E5E5E5"> part</font>

683
00:33:24,110 --> 00:33:31,070
<font color="#E5E5E5">of the story but yeah it would require</font>

684
00:33:27,620 --> 00:33:33,080
<font color="#E5E5E5">quite a bit more changes and</font><font color="#CCCCCC"> also would</font>

685
00:33:31,070 --> 00:33:35,590
<font color="#CCCCCC">be much more likely to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> detected in</font>

686
00:33:33,080 --> 00:33:35,590
<font color="#E5E5E5">the spot check</font>

687
00:33:35,980 --> 00:33:42,510
created microphone number<font color="#E5E5E5"> two please yes</font>

688
00:33:39,730 --> 00:33:45,250
a lot<font color="#E5E5E5"> of motherboards they are also</font>

689
00:33:42,510 --> 00:33:48,490
quite<font color="#CCCCCC"> a</font><font color="#E5E5E5"> few components not populated</font>

690
00:33:45,250 --> 00:33:53,890
<font color="#E5E5E5">some of which are on which you could</font>

691
00:33:48,490 --> 00:33:55,240
consider sensitive<font color="#CCCCCC"> myths</font><font color="#E5E5E5"> wouldn't that</font>

692
00:33:53,890 --> 00:33:57,010
<font color="#E5E5E5">make it yeah</font>

693
00:33:55,240 --> 00:33:59,620
exactly it is<font color="#CCCCCC"> but wouldn't that make it</font>

694
00:33:57,010 --> 00:34:02,169
<font color="#CCCCCC">very easy to to</font><font color="#E5E5E5"> just pop something on</font>

695
00:33:59,620 --> 00:34:04,540
there in parallel with one of the

696
00:34:02,169 --> 00:34:05,890
components<font color="#E5E5E5"> and not have it be detected</font>

697
00:34:04,540 --> 00:34:07,809
because<font color="#CCCCCC"> it's like the board isn't</font>

698
00:34:05,890 --> 00:34:09,790
modified there is a component<font color="#E5E5E5"> error you</font>

699
00:34:07,809 --> 00:34:13,540
have<font color="#CCCCCC"> no way of telling whether it had to</font>

700
00:34:09,790 --> 00:34:16,600
be<font color="#E5E5E5"> populated or not</font><font color="#CCCCCC"> supermicro puts a</font>

701
00:34:13,540 --> 00:34:20,020
lot<font color="#CCCCCC"> of extra pads on the</font><font color="#E5E5E5"> board in the</font>

702
00:34:16,600 --> 00:34:24,029
<font color="#E5E5E5">this one particular one they have both</font>

703
00:34:20,020 --> 00:34:28,929
<font color="#CCCCCC">eight pin and</font><font color="#E5E5E5"> sixteen pin flash chip</font>

704
00:34:24,030 --> 00:34:31,210
<font color="#E5E5E5">pads that</font><font color="#CCCCCC"> are just in parallel together</font>

705
00:34:28,929 --> 00:34:32,950
<font color="#E5E5E5">so depending on which</font><font color="#CCCCCC"> shape</font><font color="#E5E5E5"> is cheaper</font>

706
00:34:31,210 --> 00:34:36,100
that day of the week<font color="#E5E5E5"> or who knows what</font>

707
00:34:32,949 --> 00:34:37,928
they will populate one or the other<font color="#CCCCCC"> so</font>

708
00:34:36,100 --> 00:34:43,960
that's<font color="#E5E5E5"> why in this particular photo</font>

709
00:34:37,929 --> 00:34:46,750
<font color="#E5E5E5">having the position</font><font color="#CCCCCC"> of that that</font><font color="#E5E5E5"> circle</font>

710
00:34:43,960 --> 00:34:49,800
<font color="#E5E5E5">on the data output pin you know</font><font color="#CCCCCC"> is very</font>

711
00:34:46,750 --> 00:34:49,800
<font color="#CCCCCC">very</font><font color="#E5E5E5"> interesting</font>

712
00:34:52,370 --> 00:34:56,639
question answered<font color="#E5E5E5"> okay so one more</font>

713
00:34:55,050 --> 00:34:57,120
<font color="#CCCCCC">question the microphone number</font><font color="#E5E5E5"> two</font>

714
00:34:56,639 --> 00:35:00,390
please

715
00:34:57,120 --> 00:35:04,440
how far can a<font color="#E5E5E5"> signing</font><font color="#CCCCCC"> of Lima be a</font>

716
00:35:00,390 --> 00:35:08,220
solution<font color="#E5E5E5"> to this problem said signing</font>

717
00:35:04,440 --> 00:35:12,480
firmware solves a lot of<font color="#CCCCCC"> the issues it</font>

718
00:35:08,220 --> 00:35:15,770
does<font color="#E5E5E5"> however not all typically not all</font>

719
00:35:12,480 --> 00:35:17,880
of the firmware assigned specifically

720
00:35:15,770 --> 00:35:21,330
you boot is probably going to<font color="#E5E5E5"> be signed</font>

721
00:35:17,880 --> 00:35:23,280
in in a modern BMC the<font color="#E5E5E5"> kernel and maybe</font>

722
00:35:21,330 --> 00:35:25,920
the root file system might be signed

723
00:35:23,280 --> 00:35:29,550
but the<font color="#E5E5E5"> envy of</font><font color="#CCCCCC"> RAM</font><font color="#E5E5E5"> file system in this</font>

724
00:35:25,920 --> 00:35:31,560
BMC is designed to be user modifiable<font color="#CCCCCC"> so</font>

725
00:35:29,550 --> 00:35:36,000
it can't<font color="#E5E5E5"> be signed by the manufacturer</font>

726
00:35:31,560 --> 00:35:40,020
<font color="#E5E5E5">so this this sort of attack would work</font>

727
00:35:36,000 --> 00:35:43,470
against a signed BMC just as well<font color="#CCCCCC"> also</font>

728
00:35:40,020 --> 00:35:44,730
<font color="#E5E5E5">the hit enter to get a serial console</font>

729
00:35:43,470 --> 00:35:48,990
attack

730
00:35:44,730 --> 00:35:50,970
you know<font color="#CCCCCC"> circumvent</font><font color="#E5E5E5"> any sign in there</font>

731
00:35:48,990 --> 00:35:53,970
are things<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the host firmware on the</font>

732
00:35:50,970 --> 00:35:57,839
<font color="#E5E5E5">x86 like boot guard that do a really</font>

733
00:35:53,970 --> 00:35:59,299
<font color="#CCCCCC">good job of making it harder to to get</font>

734
00:35:57,840 --> 00:36:03,030
<font color="#E5E5E5">code execution</font><font color="#CCCCCC"> during the boot process</font>

735
00:35:59,300 --> 00:36:05,550
<font color="#CCCCCC">but there have been several</font><font color="#E5E5E5"> CBE's where</font>

736
00:36:03,030 --> 00:36:08,330
it has been implemented<font color="#E5E5E5"> poorly</font><font color="#CCCCCC"> so even</font>

737
00:36:05,550 --> 00:36:10,440
though signatures<font color="#E5E5E5"> the firmware is signed</font>

738
00:36:08,330 --> 00:36:16,529
<font color="#E5E5E5">people have still managed to get code</font>

739
00:36:10,440 --> 00:36:19,470
execution<font color="#E5E5E5"> during that process hey thank</font>

740
00:36:16,530 --> 00:36:20,460
you travel<font color="#CCCCCC"> hudson again walmart</font><font color="#E5E5E5"> applause</font>

741
00:36:19,470 --> 00:36:25,069
thank you very<font color="#E5E5E5"> much</font>

742
00:36:20,460 --> 00:36:38,850
[Applause]

743
00:36:25,070 --> 00:36:38,850
[Music]

744
00:36:40,920 --> 00:36:53,590
[Music]

