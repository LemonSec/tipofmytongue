1
00:00:02,830 --> 00:00:15,470
[Music]

2
00:00:17,359 --> 00:00:26,279
<font color="#E5E5E5">okay so this talk is called a deep dive</font>

3
00:00:21,689 --> 00:00:30,810
<font color="#CCCCCC">into the</font><font color="#E5E5E5"> world of</font><font color="#CCCCCC"> dos viruses and if you</font>

4
00:00:26,279 --> 00:00:33,809
<font color="#E5E5E5">happen to be at the AC at the</font><font color="#CCCCCC"> 8c3 that</font>

5
00:00:30,810 --> 00:00:36,750
is<font color="#E5E5E5"> 27 years</font><font color="#CCCCCC"> ago</font><font color="#E5E5E5"> you would have</font><font color="#CCCCCC"> seen a</font>

6
00:00:33,809 --> 00:00:38,760
very young and awkward<font color="#CCCCCC"> even more awkward</font>

7
00:00:36,750 --> 00:00:41,280
<font color="#CCCCCC">than I am at the</font><font color="#E5E5E5"> moment</font><font color="#CCCCCC"> version</font><font color="#E5E5E5"> of</font>

8
00:00:38,760 --> 00:00:46,050
myself<font color="#CCCCCC"> speaking on basically the same</font>

9
00:00:41,280 --> 00:00:47,879
subject<font color="#CCCCCC"> the stage</font><font color="#E5E5E5"> of course was a lot</font>

10
00:00:46,050 --> 00:00:50,459
<font color="#E5E5E5">smaller than this this would have really</font>

11
00:00:47,879 --> 00:00:52,140
intimidated me back then<font color="#CCCCCC"> but I was</font>

12
00:00:50,460 --> 00:00:53,520
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about a university project</font><font color="#E5E5E5"> that</font>

13
00:00:52,140 --> 00:00:57,770
we had running<font color="#E5E5E5"> or had run for about</font>

14
00:00:53,520 --> 00:01:00,230
<font color="#E5E5E5">three years at that point and our</font>

15
00:00:57,770 --> 00:01:05,010
possibilities are very limited

16
00:01:00,230 --> 00:01:09,270
<font color="#E5E5E5">meanwhiles 27 years later</font><font color="#CCCCCC"> our speaker</font><font color="#E5E5E5"> in</font>

17
00:01:05,010 --> 00:01:12,960
between fighting battleships<font color="#E5E5E5"> over the</font>

18
00:01:09,270 --> 00:01:17,039
public bgp network<font color="#E5E5E5"> and trying to encode</font>

19
00:01:12,960 --> 00:01:18,658
data<font color="#CCCCCC"> and dubstep</font><font color="#E5E5E5"> music was able</font><font color="#CCCCCC"> to</font>

20
00:01:17,040 --> 00:01:22,439
actually<font color="#E5E5E5"> do</font><font color="#CCCCCC"> all of</font><font color="#E5E5E5"> the stuff</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we are</font>

21
00:01:18,659 --> 00:01:24,840
<font color="#E5E5E5">trying</font><font color="#CCCCCC"> to do with a lot of with a lot of</font>

22
00:01:22,439 --> 00:01:27,289
<font color="#E5E5E5">effort basically and I guess four hours</font>

23
00:01:24,840 --> 00:01:31,439
<font color="#CCCCCC">of CPU time or</font><font color="#E5E5E5"> something like that</font>

24
00:01:27,290 --> 00:01:35,150
<font color="#CCCCCC">please help me in welcoming Ben to our</font>

25
00:01:31,439 --> 00:01:35,149
stage to talk<font color="#CCCCCC"> about a bygone</font><font color="#E5E5E5"> era</font>

26
00:01:42,100 --> 00:01:47,330
thank you

27
00:01:43,610 --> 00:01:51,440
hi I'm<font color="#CCCCCC"> Cara</font><font color="#E5E5E5"> Cox as the slide</font><font color="#CCCCCC"> suggests so</font>

28
00:01:47,330 --> 00:01:56,390
I have an<font color="#CCCCCC"> admission to make so this is a</font>

29
00:01:51,440 --> 00:02:02,600
thing to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> aware of and</font><font color="#CCCCCC"> you know things</font>

30
00:01:56,390 --> 00:02:06,890
also<font color="#E5E5E5"> to be aware</font><font color="#CCCCCC"> of anyway so what is</font>

31
00:02:02,600 --> 00:02:08,210
<font color="#CCCCCC">dose to get straight</font><font color="#E5E5E5"> into it</font><font color="#CCCCCC"> you could</font>

32
00:02:06,890 --> 00:02:10,310
<font color="#E5E5E5">do it in a bullet points way you know</font>

33
00:02:08,210 --> 00:02:12,890
<font color="#E5E5E5">dose is an upgrade</font><font color="#CCCCCC"> from CPM</font><font color="#E5E5E5"> another very</font>

34
00:02:10,310 --> 00:02:14,360
old legacy system<font color="#CCCCCC"> but a fellow</font><font color="#E5E5E5"> thing to</font>

35
00:02:12,890 --> 00:02:16,160
be<font color="#CCCCCC"> aware of is that dose covers a wide</font>

36
00:02:14,360 --> 00:02:19,850
<font color="#CCCCCC">range of vendors it might not just be</font>

37
00:02:16,160 --> 00:02:21,579
like those old<font color="#E5E5E5"> IBM</font><font color="#CCCCCC"> pcs some of the doses</font>

38
00:02:19,850 --> 00:02:23,359
have compatibility<font color="#E5E5E5"> with each other</font>

39
00:02:21,580 --> 00:02:27,740
<font color="#CCCCCC">meaning that some of the doses had</font>

40
00:02:23,360 --> 00:02:30,140
shared malware with each other<font color="#CCCCCC"> but to be</font>

41
00:02:27,740 --> 00:02:33,020
honest most people<font color="#E5E5E5"> know</font><font color="#CCCCCC"> DOS as these</font>

42
00:02:30,140 --> 00:02:36,109
lovely old beige boxes<font color="#CCCCCC"> the same arrow</font>

43
00:02:33,020 --> 00:02:39,370
gave us our loved<font color="#E5E5E5"> model M keyboard hated</font>

44
00:02:36,110 --> 00:02:41,870
by some loved by<font color="#CCCCCC"> others for the sound</font>

45
00:02:39,370 --> 00:02:44,570
well you know most people's knowledge<font color="#E5E5E5"> of</font>

46
00:02:41,870 --> 00:02:50,320
<font color="#CCCCCC">DOS came from computers a user</font><font color="#E5E5E5"> interface</font>

47
00:02:44,570 --> 00:02:50,320
that<font color="#CCCCCC"> looked like this yeah</font><font color="#E5E5E5"> pretty basic</font>

48
00:02:52,250 --> 00:02:55,250
see

49
00:02:56,890 --> 00:03:02,410
there we go okay so<font color="#CCCCCC"> this is WordStar</font>

50
00:03:00,150 --> 00:03:04,180
<font color="#CCCCCC">some of you may</font><font color="#E5E5E5"> not know that Game of</font>

51
00:03:02,410 --> 00:03:06,820
Thrones<font color="#E5E5E5"> was written on words</font><font color="#CCCCCC"> WordStar</font>

52
00:03:04,180 --> 00:03:09,340
<font color="#E5E5E5">george RR martin is apparently not a big</font>

53
00:03:06,820 --> 00:03:10,780
fan of<font color="#E5E5E5"> modern word processing he</font>

54
00:03:09,340 --> 00:03:15,250
admitted he had some issue with

55
00:03:10,780 --> 00:03:17,080
disliking<font color="#E5E5E5"> how</font><font color="#CCCCCC"> spell checking worked</font><font color="#E5E5E5"> so</font>

56
00:03:15,250 --> 00:03:18,340
just<font color="#E5E5E5"> users</font><font color="#CCCCCC"> and I</font><font color="#E5E5E5"> also guess it's a good</font>

57
00:03:17,080 --> 00:03:20,170
<font color="#E5E5E5">security point of</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> you can't get</font>

58
00:03:18,340 --> 00:03:24,550
hacked if it literally has no internet

59
00:03:20,170 --> 00:03:26,350
<font color="#CCCCCC">access so</font><font color="#E5E5E5"> also for a lot of people</font><font color="#CCCCCC"> this</font>

60
00:03:24,550 --> 00:03:28,270
<font color="#CCCCCC">is also their first experience into</font>

61
00:03:26,350 --> 00:03:30,430
<font color="#CCCCCC">programming for the some of</font><font color="#E5E5E5"> the older</font>

62
00:03:28,270 --> 00:03:33,730
<font color="#E5E5E5">crowd</font><font color="#CCCCCC"> this is also the invention of</font>

63
00:03:30,430 --> 00:03:38,620
<font color="#CCCCCC">QBasic which you know gave a very</font><font color="#E5E5E5"> basic</font>

64
00:03:33,730 --> 00:03:40,420
basic<font color="#E5E5E5"> language to program creatively</font><font color="#CCCCCC"> in</font>

65
00:03:38,620 --> 00:03:42,070
<font color="#CCCCCC">DOS for some people this was the gateway</font>

66
00:03:40,420 --> 00:03:44,260
<font color="#E5E5E5">drug</font><font color="#CCCCCC"> into programming</font><font color="#E5E5E5"> and perhaps the</font>

67
00:03:42,070 --> 00:03:49,060
gateway<font color="#CCCCCC"> drug into what they started</font><font color="#E5E5E5"> as a</font>

68
00:03:44,260 --> 00:03:51,429
career<font color="#CCCCCC"> for other</font><font color="#E5E5E5"> people though the</font>

69
00:03:49,060 --> 00:03:53,350
experience<font color="#CCCCCC"> of dos was not so great for</font>

70
00:03:51,430 --> 00:03:56,440
<font color="#CCCCCC">example you know let's just</font><font color="#E5E5E5"> say you were</font>

71
00:03:53,350 --> 00:04:00,209
<font color="#E5E5E5">doing some work in an infinite loop</font><font color="#CCCCCC"> and</font>

72
00:03:56,440 --> 00:04:00,209
at some<font color="#E5E5E5"> point stuff like this happens</font>

73
00:04:00,720 --> 00:04:04,330
<font color="#CCCCCC">unfortunately I don't</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> sound for</font>

74
00:04:02,440 --> 00:04:07,150
this<font color="#E5E5E5"> one but you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> just in your head</font>

75
00:04:04,330 --> 00:04:09,280
<font color="#E5E5E5">imagine like your PC speakers playing</font>

76
00:04:07,150 --> 00:04:12,640
some small techno music<font color="#CCCCCC"> unlike you</font><font color="#E5E5E5"> know</font>

77
00:04:09,280 --> 00:04:13,900
<font color="#CCCCCC">but</font><font color="#E5E5E5"> only one frequency at a time</font><font color="#CCCCCC"> this</font>

78
00:04:12,640 --> 00:04:14,829
might<font color="#E5E5E5"> get especially incredibly</font>

79
00:04:13,900 --> 00:04:18,790
embarrassing if you're in an office

80
00:04:14,830 --> 00:04:21,250
<font color="#CCCCCC">environment just slowly beeping away you</font>

81
00:04:18,790 --> 00:04:22,720
can't exit this<font color="#CCCCCC"> it has to finish fully</font>

82
00:04:21,250 --> 00:04:23,710
and if you touch<font color="#E5E5E5"> the keyboard it reminds</font>

83
00:04:22,720 --> 00:04:28,720
you not<font color="#E5E5E5"> to touch the keyboard and</font>

84
00:04:23,710 --> 00:04:31,239
continues<font color="#E5E5E5"> Plagueis music so you know</font>

85
00:04:28,720 --> 00:04:32,590
this<font color="#E5E5E5"> this would be fun but this would</font>

86
00:04:31,240 --> 00:04:33,790
this wouldn't<font color="#CCCCCC"> be fun especially for an</font>

87
00:04:32,590 --> 00:04:37,690
office environment<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> know</font>

88
00:04:33,790 --> 00:04:40,180
ultimately it's not<font color="#E5E5E5"> malicious and and</font>

89
00:04:37,690 --> 00:04:41,740
that trend continues<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is another a</font>

90
00:04:40,180 --> 00:04:44,620
good<font color="#E5E5E5"> example of a</font><font color="#CCCCCC"> DOS virus</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

91
00:04:41,740 --> 00:04:46,990
<font color="#E5E5E5">ambulance</font><font color="#CCCCCC"> for when you run it and</font>

92
00:04:44,620 --> 00:04:48,610
ambulance just<font color="#E5E5E5"> drives past and then you</font>

93
00:04:46,990 --> 00:04:51,220
<font color="#E5E5E5">can feel normal program just continues</font>

94
00:04:48,610 --> 00:04:55,020
running<font color="#E5E5E5"> I think this is amazing</font><font color="#CCCCCC"> it's an</font>

95
00:04:51,220 --> 00:04:57,400
interesting era of viruses<font color="#E5E5E5"> it was all</font>

96
00:04:55,020 --> 00:04:58,930
the history<font color="#E5E5E5"> of</font><font color="#CCCCCC"> it was collected very</font>

97
00:04:57,400 --> 00:05:01,150
well by a<font color="#E5E5E5"> website called VX heavens</font>

98
00:04:58,930 --> 00:05:03,520
which sort of still lives<font color="#CCCCCC"> but</font>

99
00:05:01,150 --> 00:05:06,640
<font color="#E5E5E5">unfortunately at one point was raided by</font>

100
00:05:03,520 --> 00:05:08,590
<font color="#CCCCCC">the Ukrainian police</font><font color="#E5E5E5"> for what is the</font>

101
00:05:06,640 --> 00:05:10,539
fantastic wording they used<font color="#E5E5E5"> plate</font>

102
00:05:08,590 --> 00:05:11,700
<font color="#E5E5E5">basically that someone</font><font color="#CCCCCC"> to</font>

103
00:05:10,540 --> 00:05:13,600
they were distributing malware

104
00:05:11,700 --> 00:05:17,530
<font color="#E5E5E5">unfortunately not malware there operates</font>

105
00:05:13,600 --> 00:05:20,020
in this<font color="#E5E5E5"> century</font><font color="#CCCCCC"> but I</font><font color="#E5E5E5"> guess that's good</font>

106
00:05:17,530 --> 00:05:21,580
<font color="#CCCCCC">enough for a raid but</font><font color="#E5E5E5"> luckily for the</font>

107
00:05:20,020 --> 00:05:24,159
archivists there are archivists of

108
00:05:21,580 --> 00:05:28,180
archivists<font color="#CCCCCC"> and so we have a saved</font>

109
00:05:24,160 --> 00:05:29,230
<font color="#E5E5E5">capture</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> X heavens this is</font>

110
00:05:28,180 --> 00:05:31,510
actually an old snapshot there are way

111
00:05:29,230 --> 00:05:33,520
more modern snapshots but thankfully the

112
00:05:31,510 --> 00:05:36,760
<font color="#E5E5E5">ms-dos virus</font><font color="#CCCCCC"> era</font><font color="#E5E5E5"> doesn't move very</font>

113
00:05:33,520 --> 00:05:39,070
<font color="#E5E5E5">quickly so but the interesting thing</font>

114
00:05:36,760 --> 00:05:41,980
<font color="#E5E5E5">here is like there's 66,000 items in</font>

115
00:05:39,070 --> 00:05:45,099
this<font color="#E5E5E5"> tar ball and it's</font><font color="#CCCCCC"> 6.6 gigabytes of</font>

116
00:05:41,980 --> 00:05:47,620
code<font color="#CCCCCC"> and these viruses are like super</font>

117
00:05:45,100 --> 00:05:48,850
dense<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> not much to them like they</font>

118
00:05:47,620 --> 00:05:50,350
are<font color="#CCCCCC"> just blobs</font><font color="#E5E5E5"> of machine code they're</font>

119
00:05:48,850 --> 00:05:52,920
not like your electron app<font color="#E5E5E5"> these days</font>

120
00:05:50,350 --> 00:05:55,380
that ships an entire Chrome browser<font color="#E5E5E5"> and</font>

121
00:05:52,920 --> 00:05:57,970
<font color="#CCCCCC">normally an outer date</font><font color="#E5E5E5"> Chrome browser</font>

122
00:05:55,380 --> 00:05:59,950
<font color="#CCCCCC">you know this is just basically you</font><font color="#E5E5E5"> know</font>

123
00:05:57,970 --> 00:06:02,620
how to draw an ambulance<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> know</font>

124
00:05:59,950 --> 00:06:04,300
some infection routines<font color="#CCCCCC"> the normal</font>

125
00:06:02,620 --> 00:06:07,870
<font color="#E5E5E5">distribution also changes with</font><font color="#CCCCCC"> it as</font>

126
00:06:04,300 --> 00:06:09,370
well for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> the normal life cycle</font>

127
00:06:07,870 --> 00:06:11,500
of an ms-dos virus is you know you

128
00:06:09,370 --> 00:06:14,820
download or for some other reason and

129
00:06:11,500 --> 00:06:17,590
run an infected program that you

130
00:06:14,820 --> 00:06:19,390
presumably<font color="#E5E5E5"> does nothing to</font><font color="#CCCCCC"> you it</font><font color="#E5E5E5"> looks</font>

131
00:06:17,590 --> 00:06:22,330
<font color="#E5E5E5">like it does nothing</font><font color="#CCCCCC"> so you know remains</font>

132
00:06:19,390 --> 00:06:25,390
roughly undetected<font color="#CCCCCC"> that then you go</font><font color="#E5E5E5"> and</font>

133
00:06:22,330 --> 00:06:27,820
<font color="#E5E5E5">run more files the</font><font color="#CCCCCC"> DOS virus infects</font>

134
00:06:25,390 --> 00:06:29,440
<font color="#E5E5E5">more files</font><font color="#CCCCCC"> and at some</font><font color="#E5E5E5"> point you're</font>

135
00:06:27,820 --> 00:06:31,060
probably<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to give one of those XP</font>

136
00:06:29,440 --> 00:06:33,370
tools to some other computer or<font color="#CCCCCC"> some</font>

137
00:06:31,060 --> 00:06:35,350
other person<font color="#E5E5E5"> whether it was by giving</font>

138
00:06:33,370 --> 00:06:36,940
<font color="#CCCCCC">someone or copying a floppy disk of some</font>

139
00:06:35,350 --> 00:06:38,440
<font color="#CCCCCC">software maybe some expensive software</font>

140
00:06:36,940 --> 00:06:40,360
so they didn't<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to pay for it</font>

141
00:06:38,440 --> 00:06:44,890
or uploading it to<font color="#CCCCCC"> a BBS where it could</font>

142
00:06:40,360 --> 00:06:46,900
be<font color="#CCCCCC"> downloaded by</font><font color="#E5E5E5"> many people so the</font>

143
00:06:44,890 --> 00:06:49,450
distribution mechanism is<font color="#CCCCCC"> a far</font><font color="#E5E5E5"> cry from</font>

144
00:06:46,900 --> 00:06:50,979
<font color="#CCCCCC">the eternal blues of this era</font><font color="#E5E5E5"> where you</font>

145
00:06:49,450 --> 00:06:52,539
<font color="#CCCCCC">know we can have an</font><font color="#E5E5E5"> amount piece of</font>

146
00:06:50,980 --> 00:06:56,590
strain of malware spread across<font color="#CCCCCC"> the</font>

147
00:06:52,540 --> 00:06:59,280
<font color="#CCCCCC">world very brutally very quickly</font>

148
00:06:56,590 --> 00:07:02,260
so most<font color="#CCCCCC"> dos viruses are pretty</font><font color="#E5E5E5"> simple</font>

149
00:06:59,280 --> 00:07:03,969
<font color="#CCCCCC">they start</font><font color="#E5E5E5"> and they say have my payload</font>

150
00:07:02,260 --> 00:07:06,550
conditions been met

151
00:07:03,970 --> 00:07:07,960
if not then they'll go and display<font color="#E5E5E5"> if</font>

152
00:07:06,550 --> 00:07:10,090
they<font color="#E5E5E5"> arm it they'll go and display the</font>

153
00:07:07,960 --> 00:07:14,229
payload and the payloads are definitely

154
00:07:10,090 --> 00:07:16,210
more<font color="#E5E5E5"> no nice</font><font color="#CCCCCC"> you know you have stuff</font>

155
00:07:14,230 --> 00:07:18,190
like<font color="#CCCCCC"> this which is pretty in it you know</font>

156
00:07:16,210 --> 00:07:20,140
<font color="#E5E5E5">users</font><font color="#CCCCCC"> VGA colors and all sorts of really</font>

157
00:07:18,190 --> 00:07:21,910
<font color="#E5E5E5">nice stuff you get also</font><font color="#CCCCCC"> some very demo</font>

158
00:07:20,140 --> 00:07:24,520
scene vibes<font color="#E5E5E5"> from this another good</font>

159
00:07:21,910 --> 00:07:26,979
example<font color="#E5E5E5"> is this like VGA like super trip</font>

160
00:07:24,520 --> 00:07:29,109
thing<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> really impressive because</font>

161
00:07:26,979 --> 00:07:30,818
<font color="#E5E5E5">this is really</font><font color="#CCCCCC"> small this is</font><font color="#E5E5E5"> less than</font>

162
00:07:29,110 --> 00:07:34,720
<font color="#CCCCCC">one kilobyte of</font><font color="#E5E5E5"> code it's in fact way</font>

163
00:07:30,819 --> 00:07:36,280
less<font color="#CCCCCC"> than one kilobyte 64k or you just</font>

164
00:07:34,720 --> 00:07:38,530
<font color="#E5E5E5">get like interesting screen effects as</font>

165
00:07:36,280 --> 00:07:40,000
well<font color="#E5E5E5"> for example it's quick</font><font color="#CCCCCC"> but like you</font>

166
00:07:38,530 --> 00:07:43,359
can<font color="#CCCCCC"> just watch the</font><font color="#E5E5E5"> entire computer just</font>

167
00:07:40,000 --> 00:07:45,930
dissolve away<font color="#CCCCCC"> which also</font><font color="#E5E5E5"> might</font><font color="#CCCCCC"> be quite</font>

168
00:07:43,360 --> 00:07:47,889
worrying if you weren't<font color="#CCCCCC"> expecting that</font>

169
00:07:45,930 --> 00:07:50,080
alternatively if<font color="#CCCCCC"> the payload conditions</font>

170
00:07:47,889 --> 00:07:52,840
are not met<font color="#E5E5E5"> then you know you hook</font>

171
00:07:50,080 --> 00:07:53,979
<font color="#CCCCCC">syscalls</font><font color="#E5E5E5"> and you or alternatively if you</font>

172
00:07:52,840 --> 00:07:56,770
want to be way<font color="#CCCCCC"> more aggressive</font><font color="#E5E5E5"> as a</font>

173
00:07:53,979 --> 00:07:59,650
malware offer<font color="#E5E5E5"> you scan for files on the</font>

174
00:07:56,770 --> 00:08:02,080
<font color="#CCCCCC">system to infect proactively</font><font color="#E5E5E5"> and the way</font>

175
00:07:59,650 --> 00:08:04,840
you<font color="#E5E5E5"> infect programs is pretty simple</font>

176
00:08:02,080 --> 00:08:06,940
<font color="#CCCCCC">a</font><font color="#E5E5E5"> imagining you have like one giant tape</font>

177
00:08:04,840 --> 00:08:09,219
of all the codes<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have for the target</font>

178
00:08:06,940 --> 00:08:10,810
program<font color="#CCCCCC"> most of them work like this</font><font color="#E5E5E5"> and</font>

179
00:08:09,220 --> 00:08:13,389
<font color="#CCCCCC">that they</font><font color="#E5E5E5"> replace the first</font><font color="#CCCCCC"> free bytes</font>

180
00:08:10,810 --> 00:08:15,069
<font color="#E5E5E5">of the program with a x86 jump they</font>

181
00:08:13,389 --> 00:08:17,289
<font color="#CCCCCC">upend their malware</font><font color="#E5E5E5"> onto</font><font color="#CCCCCC"> the end of</font><font color="#E5E5E5"> the</font>

182
00:08:15,069 --> 00:08:18,849
<font color="#E5E5E5">executable</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so the first</font><font color="#CCCCCC"> thing that</font>

183
00:08:17,289 --> 00:08:19,870
<font color="#E5E5E5">you do when you run the executable is it</font>

184
00:08:18,849 --> 00:08:22,389
jumps to<font color="#CCCCCC"> the end of the file</font>

185
00:08:19,870 --> 00:08:25,389
effectively<font color="#CCCCCC"> runs the malware</font><font color="#E5E5E5"> chunk and</font>

186
00:08:22,389 --> 00:08:29,409
<font color="#E5E5E5">then</font><font color="#CCCCCC"> it optionally will return</font><font color="#E5E5E5"> control</font>

187
00:08:25,389 --> 00:08:33,060
<font color="#E5E5E5">back</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the original program</font><font color="#CCCCCC"> but there's</font>

188
00:08:29,409 --> 00:08:36,279
also a thing about<font color="#E5E5E5"> hooking Cisco's right</font>

189
00:08:33,059 --> 00:08:38,949
<font color="#CCCCCC">so you know ms-dos is an</font><font color="#E5E5E5"> operating</font>

190
00:08:36,279 --> 00:08:40,510
<font color="#E5E5E5">system it does have</font><font color="#CCCCCC"> sis calls</font><font color="#E5E5E5"> the</font>

191
00:08:38,950 --> 00:08:43,779
<font color="#E5E5E5">programs can reach out to ms-dos to do</font>

192
00:08:40,510 --> 00:08:46,089
things<font color="#E5E5E5"> like file access and stuff so as</font>

193
00:08:43,779 --> 00:08:48,970
you expect<font color="#CCCCCC"> you</font><font color="#E5E5E5"> run a software interrupt</font>

194
00:08:46,089 --> 00:08:53,290
<font color="#E5E5E5">to get there</font><font color="#CCCCCC"> thankfully though ms-dos</font>

195
00:08:48,970 --> 00:08:55,600
does also allow you<font color="#E5E5E5"> to extend ms-dos</font><font color="#CCCCCC"> by</font>

196
00:08:53,290 --> 00:08:57,730
adding handlers itself or even

197
00:08:55,600 --> 00:08:59,079
<font color="#E5E5E5">overwriting existing handlers which is</font>

198
00:08:57,730 --> 00:09:01,029
very convenient<font color="#CCCCCC"> if you're</font><font color="#E5E5E5"> trying to</font>

199
00:08:59,079 --> 00:09:02,050
write drivers<font color="#E5E5E5"> but it's also incredibly</font>

200
00:09:01,029 --> 00:09:06,850
convenient if you're trying<font color="#E5E5E5"> to write</font>

201
00:09:02,050 --> 00:09:08,770
malware for some of the examples of the

202
00:09:06,850 --> 00:09:12,220
<font color="#CCCCCC">sis course most of them that relevant</font>

203
00:09:08,770 --> 00:09:13,899
for<font color="#E5E5E5"> towards</font><font color="#CCCCCC"> dos a virus making here is a</font>

204
00:09:12,220 --> 00:09:15,970
decent<font color="#CCCCCC"> example of the things that dos</font>

205
00:09:13,899 --> 00:09:18,930
will provide you a lot of<font color="#CCCCCC"> them</font><font color="#E5E5E5"> are just</font>

206
00:09:15,970 --> 00:09:21,550
very useful in in general<font color="#E5E5E5"> for producing</font>

207
00:09:18,930 --> 00:09:24,219
functional executables<font color="#CCCCCC"> that end users</font>

208
00:09:21,550 --> 00:09:25,779
want<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> this is what the nav rage</font>

209
00:09:24,220 --> 00:09:28,060
<font color="#E5E5E5">program looks like this is almost</font><font color="#CCCCCC"> the</font>

210
00:09:25,779 --> 00:09:29,620
shortest hello world you can make<font color="#E5E5E5"> - the</font>

211
00:09:28,060 --> 00:09:31,390
actual hello world string in fact the

212
00:09:29,620 --> 00:09:33,840
hello world string might be the largest

213
00:09:31,390 --> 00:09:36,210
<font color="#CCCCCC">part of</font><font color="#E5E5E5"> this binary</font>

214
00:09:33,840 --> 00:09:38,279
it's a pretty simple binary<font color="#CCCCCC"> here</font><font color="#E5E5E5"> we're</font>

215
00:09:36,210 --> 00:09:42,180
moving<font color="#CCCCCC"> a pointer to the to the message</font>

216
00:09:38,279 --> 00:09:46,650
we just<font color="#E5E5E5"> set we then set the aah register</font>

217
00:09:42,180 --> 00:09:50,579
to<font color="#CCCCCC"> nine or hex nine</font><font color="#E5E5E5"> that's the</font><font color="#CCCCCC"> assist</font>

218
00:09:46,650 --> 00:09:54,150
<font color="#E5E5E5">call for printing your string and</font><font color="#CCCCCC"> then</font>

219
00:09:50,580 --> 00:09:57,600
we run<font color="#E5E5E5"> a software</font><font color="#CCCCCC"> interrupts</font><font color="#E5E5E5"> 21h which</font>

220
00:09:54,150 --> 00:10:00,990
<font color="#E5E5E5">is short for</font><font color="#CCCCCC"> twenty one</font><font color="#E5E5E5"> hex and we</font>

221
00:09:57,600 --> 00:10:03,779
continue on<font color="#E5E5E5"> aah we then set</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> H again to</font>

222
00:10:00,990 --> 00:10:06,420
four C which is<font color="#E5E5E5"> returned with an exit</font>

223
00:10:03,779 --> 00:10:10,350
exit with a return code<font color="#E5E5E5"> and the program</font>

224
00:10:06,420 --> 00:10:12,719
will return so in the meantime this<font color="#CCCCCC"> is</font>

225
00:10:10,350 --> 00:10:15,029
roughly<font color="#E5E5E5"> the loop that</font><font color="#CCCCCC"> just happened you</font>

226
00:10:12,720 --> 00:10:18,210
have your program<font color="#E5E5E5"> code that calls an</font>

227
00:10:15,029 --> 00:10:20,400
interrupt<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> gets passed over to</font>

228
00:10:18,210 --> 00:10:22,170
the<font color="#E5E5E5"> interrupt handler</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> process of</font>

229
00:10:20,400 --> 00:10:23,699
doing this the CPU<font color="#CCCCCC"> has quickly</font><font color="#E5E5E5"> looked at</font>

230
00:10:22,170 --> 00:10:25,740
the first<font color="#E5E5E5"> 100 bytes of memory in the</font>

231
00:10:23,700 --> 00:10:30,089
interrupt<font color="#CCCCCC"> vector table</font><font color="#E5E5E5"> ivt as it's</font>

232
00:10:25,740 --> 00:10:31,980
abbreviated<font color="#E5E5E5"> and then it's effectively a</font>

233
00:10:30,089 --> 00:10:33,630
<font color="#CCCCCC">Ruta if anyone has</font><font color="#E5E5E5"> written like a small</font>

234
00:10:31,980 --> 00:10:35,100
piece<font color="#CCCCCC"> of</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> to route HTTP</font><font color="#E5E5E5"> requests or</font>

235
00:10:33,630 --> 00:10:38,700
anything it's basically like that but in

236
00:10:35,100 --> 00:10:40,380
the 80s<font color="#CCCCCC"> we've</font><font color="#E5E5E5"> Siskel's so it's just</font>

237
00:10:38,700 --> 00:10:43,770
basically<font color="#CCCCCC"> saying compare</font><font color="#E5E5E5"> this compare</font>

238
00:10:40,380 --> 00:10:46,290
<font color="#E5E5E5">that jump jump that then the thing gets</font>

239
00:10:43,770 --> 00:10:47,579
passed to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> call handler it goes and</font>

240
00:10:46,290 --> 00:10:49,290
does<font color="#E5E5E5"> the</font><font color="#CCCCCC"> sits call the thing that was</font>

241
00:10:47,580 --> 00:10:52,740
<font color="#E5E5E5">required normally it will leave some</font>

242
00:10:49,290 --> 00:10:55,170
registers behind as<font color="#CCCCCC"> State or results of</font>

243
00:10:52,740 --> 00:10:56,790
<font color="#CCCCCC">actions it has performed and it returns</font>

244
00:10:55,170 --> 00:10:59,250
<font color="#CCCCCC">control back to the</font><font color="#E5E5E5"> back to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> program</font>

245
00:10:56,790 --> 00:11:00,599
<font color="#E5E5E5">so theoretically speaking if we wanted</font>

246
00:10:59,250 --> 00:11:02,700
<font color="#CCCCCC">to go and</font><font color="#E5E5E5"> look at what a program</font>

247
00:11:00,600 --> 00:11:04,589
actually does we need<font color="#E5E5E5"> to set a</font>

248
00:11:02,700 --> 00:11:08,220
breakpoint<font color="#CCCCCC"> here because</font><font color="#E5E5E5"> this is the only</font>

249
00:11:04,589 --> 00:11:11,130
<font color="#E5E5E5">place</font><font color="#CCCCCC"> that we can be</font><font color="#E5E5E5"> sure the location</font>

250
00:11:08,220 --> 00:11:13,020
<font color="#CCCCCC">and exists because this is way before</font>

251
00:11:11,130 --> 00:11:15,420
<font color="#E5E5E5">the</font><font color="#CCCCCC"> area of a SLR address space</font>

252
00:11:13,020 --> 00:11:16,970
randomization<font color="#E5E5E5"> and this is wave of way</font>

253
00:11:15,420 --> 00:11:19,349
before<font color="#E5E5E5"> the</font><font color="#CCCCCC"> area of kernel space</font>

254
00:11:16,970 --> 00:11:22,140
randomization in fact ms-dos has almost

255
00:11:19,350 --> 00:11:23,850
no memory protection whatsoever<font color="#CCCCCC"> once</font><font color="#E5E5E5"> you</font>

256
00:11:22,140 --> 00:11:26,010
run a<font color="#CCCCCC"> program you are basically</font><font color="#E5E5E5"> putting</font>

257
00:11:23,850 --> 00:11:28,500
the full<font color="#E5E5E5"> control of the</font><font color="#CCCCCC"> system to</font><font color="#E5E5E5"> that</font>

258
00:11:26,010 --> 00:11:30,750
<font color="#CCCCCC">program which means</font><font color="#E5E5E5"> you can happily also</font>

259
00:11:28,500 --> 00:11:33,779
boot<font color="#E5E5E5"> things like Linux directly from a</font>

260
00:11:30,750 --> 00:11:35,360
comm file which is handy if<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font>

261
00:11:33,779 --> 00:11:37,210
upgrade

262
00:11:35,360 --> 00:11:41,660
[Music]

263
00:11:37,210 --> 00:11:43,940
so if we look<font color="#E5E5E5"> at certain files we can</font><font color="#CCCCCC"> go</font>

264
00:11:41,660 --> 00:11:48,350
and<font color="#E5E5E5"> see what they do so in this case</font>

265
00:11:43,940 --> 00:11:50,180
<font color="#E5E5E5">here is one example</font><font color="#CCCCCC"> this is a goat file</font>

266
00:11:48,350 --> 00:11:52,010
a goat file is like a sacrificial<font color="#E5E5E5"> goat</font>

267
00:11:50,180 --> 00:11:54,530
<font color="#CCCCCC">it is a file that</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> purely designed</font><font color="#E5E5E5"> to</font>

268
00:11:52,010 --> 00:11:56,510
be infected<font color="#E5E5E5"> so what you do is you you</font>

269
00:11:54,530 --> 00:11:58,459
bring<font color="#E5E5E5"> a virus</font><font color="#CCCCCC"> into inter memory in the</font>

270
00:11:56,510 --> 00:12:00,830
<font color="#CCCCCC">system and then</font><font color="#E5E5E5"> you run it you run a</font>

271
00:11:58,460 --> 00:12:02,450
goat file<font color="#E5E5E5"> in the vague hope that the</font>

272
00:12:00,830 --> 00:12:05,150
virus will<font color="#CCCCCC"> infect it and then you have a</font>

273
00:12:02,450 --> 00:12:07,120
nice clean sample<font color="#E5E5E5"> of just that virus and</font>

274
00:12:05,150 --> 00:12:09,260
<font color="#E5E5E5">not another program inside the virus</font>

275
00:12:07,120 --> 00:12:11,330
<font color="#CCCCCC">which makes it way easier to</font><font color="#E5E5E5"> test and</font>

276
00:12:09,260 --> 00:12:13,069
reverse-engineer<font color="#CCCCCC"> so we can see things</font>

277
00:12:11,330 --> 00:12:15,620
are happening here<font color="#CCCCCC"> for example we can</font>

278
00:12:13,070 --> 00:12:17,120
see it opening<font color="#E5E5E5"> a file moving like where</font>

279
00:12:15,620 --> 00:12:18,650
it's<font color="#CCCCCC"> looking in towards the file</font><font color="#E5E5E5"> reading</font>

280
00:12:17,120 --> 00:12:21,170
some data<font color="#E5E5E5"> from the file</font><font color="#CCCCCC"> just 2 bytes</font>

281
00:12:18,650 --> 00:12:22,970
though and it closes<font color="#CCCCCC"> a file we see the</font>

282
00:12:21,170 --> 00:12:24,410
same<font color="#CCCCCC"> sort of thing repeat</font><font color="#E5E5E5"> itself except</font>

283
00:12:22,970 --> 00:12:26,300
at one<font color="#E5E5E5"> point it reads a large amount of</font>

284
00:12:24,410 --> 00:12:28,969
data<font color="#E5E5E5"> removes the file pointer writes</font>

285
00:12:26,300 --> 00:12:31,189
another<font color="#E5E5E5"> large amount of data does some</font>

286
00:12:28,970 --> 00:12:32,660
more stuff and you know this we<font color="#E5E5E5"> pass</font>

287
00:12:31,190 --> 00:12:35,260
some file names<font color="#E5E5E5"> we display a string</font>

288
00:12:32,660 --> 00:12:39,260
which is<font color="#E5E5E5"> almost</font><font color="#CCCCCC"> definitely the go file</font>

289
00:12:35,260 --> 00:12:41,420
<font color="#E5E5E5">message and yeah we pretty much exit</font>

290
00:12:39,260 --> 00:12:42,950
after<font color="#E5E5E5"> that so there were a few</font><font color="#CCCCCC"> Siskel's</font>

291
00:12:41,420 --> 00:12:47,120
here that we would<font color="#E5E5E5"> really like</font><font color="#CCCCCC"> to know</font>

292
00:12:42,950 --> 00:12:48,470
more about<font color="#E5E5E5"> so for that it's the open</font>

293
00:12:47,120 --> 00:12:50,900
files we'd really like to<font color="#E5E5E5"> know what</font>

294
00:12:48,470 --> 00:12:52,490
files were<font color="#E5E5E5"> being opened</font><font color="#CCCCCC"> we would also</font>

295
00:12:50,900 --> 00:12:53,990
<font color="#CCCCCC">want to know</font><font color="#E5E5E5"> what you'd</font><font color="#CCCCCC"> like to</font><font color="#E5E5E5"> know</font>

296
00:12:52,490 --> 00:12:55,700
what data<font color="#E5E5E5"> was being written to the file</font>

297
00:12:53,990 --> 00:12:59,030
<font color="#E5E5E5">rather than having to fish it out of the</font>

298
00:12:55,700 --> 00:13:00,170
virtual<font color="#CCCCCC"> machine later and we'd also just</font>

299
00:12:59,030 --> 00:13:01,579
out of<font color="#E5E5E5"> curiousity really want to know</font>

300
00:13:00,170 --> 00:13:04,969
what file names it was asking<font color="#E5E5E5"> ms-dos</font>

301
00:13:01,580 --> 00:13:07,460
<font color="#CCCCCC">Depaz display string is also a nice test</font>

302
00:13:04,970 --> 00:13:08,360
<font color="#E5E5E5">to know where your code</font><font color="#CCCCCC"> is working so to</font>

303
00:13:07,460 --> 00:13:10,310
do this<font color="#E5E5E5"> you're gonna have to look a</font>

304
00:13:08,360 --> 00:13:13,310
little bit deeper<font color="#CCCCCC"> into how the ms-dos</font>

305
00:13:10,310 --> 00:13:16,989
<font color="#CCCCCC">runtime</font><font color="#E5E5E5"> and by proxy how the x86</font><font color="#CCCCCC"> in</font>

306
00:13:13,310 --> 00:13:19,489
16-bit mode<font color="#E5E5E5"> works or legacy mode I guess</font>

307
00:13:16,990 --> 00:13:21,800
this is basically all<font color="#CCCCCC"> the registers you</font>

308
00:13:19,490 --> 00:13:23,390
have in 16-bit mode and some<font color="#E5E5E5"> nice</font>

309
00:13:21,800 --> 00:13:28,540
computations at the bottom to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> it</font>

310
00:13:23,390 --> 00:13:28,540
easier to<font color="#CCCCCC"> read so as we mentioned</font>

311
00:13:28,630 --> 00:13:33,560
aah-aah is the one that you use to

312
00:13:31,010 --> 00:13:35,420
<font color="#E5E5E5">specify which disk all you want and</font>

313
00:13:33,560 --> 00:13:39,800
you'll notice it's not<font color="#E5E5E5"> there aah is</font>

314
00:13:35,420 --> 00:13:42,380
actually the upper<font color="#E5E5E5"> half</font><font color="#CCCCCC"> of ax</font><font color="#E5E5E5"> a H is a 8</font>

315
00:13:39,800 --> 00:13:45,560
bit<font color="#CCCCCC"> register</font><font color="#E5E5E5"> because sometimes people</font>

316
00:13:42,380 --> 00:13:49,310
really<font color="#E5E5E5"> just wanted only 8 bits</font><font color="#CCCCCC"> it's a</font>

317
00:13:45,560 --> 00:13:50,930
very obscure<font color="#E5E5E5"> that we were saving</font><font color="#CCCCCC"> that</font>

318
00:13:49,310 --> 00:13:53,599
<font color="#E5E5E5">much space</font>

319
00:13:50,930 --> 00:13:55,399
and so this is what a this is the

320
00:13:53,600 --> 00:13:57,589
definition<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Cisco</font><font color="#E5E5E5"> of a</font><font color="#CCCCCC"> prince ring</font>

321
00:13:55,399 --> 00:13:59,509
<font color="#CCCCCC">so you</font><font color="#E5E5E5"> have a H needs to be set to</font><font color="#CCCCCC"> nine</font>

322
00:13:57,589 --> 00:14:01,790
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> once you've took in</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> to</font>

323
00:13:59,509 --> 00:14:04,100
call the<font color="#CCCCCC"> sis call for printing string</font>

324
00:14:01,790 --> 00:14:06,769
<font color="#CCCCCC">and</font><font color="#E5E5E5"> just say H to nine and then you need</font>

325
00:14:04,100 --> 00:14:09,199
to<font color="#E5E5E5"> set D s and</font><font color="#CCCCCC"> D X to a pointer to a</font>

326
00:14:06,769 --> 00:14:11,089
string that ends in a dollar<font color="#CCCCCC"> and that</font>

327
00:14:09,199 --> 00:14:12,199
doesn't make<font color="#E5E5E5"> a lot of sense or it didn't</font>

328
00:14:11,089 --> 00:14:14,720
<font color="#CCCCCC">make a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of sense to</font><font color="#E5E5E5"> me when I first</font>

329
00:14:12,199 --> 00:14:16,069
read<font color="#E5E5E5"> that</font><font color="#CCCCCC"> and so to do this we need to</font>

330
00:14:14,720 --> 00:14:19,100
learn<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit more</font><font color="#E5E5E5"> about how memory</font>

331
00:14:16,069 --> 00:14:20,899
works on these old CPUs or the the CPUs

332
00:14:19,100 --> 00:14:23,980
are probably in<font color="#E5E5E5"> your laptops but running</font>

333
00:14:20,899 --> 00:14:26,180
<font color="#E5E5E5">in a holder mode</font><font color="#CCCCCC"> so for</font><font color="#E5E5E5"> this is</font>

334
00:14:23,980 --> 00:14:28,879
effectively<font color="#CCCCCC"> what it</font><font color="#E5E5E5"> looks like they have</font>

335
00:14:26,180 --> 00:14:31,609
a 16-bit CPU<font color="#CCCCCC"> to to the 16 is 64</font>

336
00:14:28,879 --> 00:14:33,980
kilobytes<font color="#CCCCCC"> and we have a 20-bit</font><font color="#E5E5E5"> memory</font>

337
00:14:31,610 --> 00:14:35,149
address in space<font color="#CCCCCC"> two to the</font><font color="#E5E5E5"> twenty is</font>

338
00:14:33,980 --> 00:14:36,980
one megabyte<font color="#E5E5E5"> so if you ever see</font><font color="#CCCCCC"> an</font>

339
00:14:35,149 --> 00:14:38,569
ms-dos<font color="#E5E5E5"> machine like limiting at one</font>

340
00:14:36,980 --> 00:14:40,009
megabyte<font color="#E5E5E5"> or some old operating</font><font color="#CCCCCC"> system</font>

341
00:14:38,569 --> 00:14:41,660
saying like the<font color="#E5E5E5"> maximum memory you can</font>

342
00:14:40,009 --> 00:14:44,389
have is<font color="#E5E5E5"> one megabyte</font><font color="#CCCCCC"> so because it's</font>

343
00:14:41,660 --> 00:14:48,350
<font color="#E5E5E5">running in 16-bit mode and the</font><font color="#CCCCCC"> maximum</font>

344
00:14:44,389 --> 00:14:50,589
<font color="#CCCCCC">it can</font><font color="#E5E5E5"> physically see is 20 20 bits</font><font color="#CCCCCC"> so</font>

345
00:14:48,350 --> 00:14:53,600
the question is how do we address

346
00:14:50,589 --> 00:14:57,259
<font color="#E5E5E5">anything above 64 K if the</font><font color="#CCCCCC"> CPU can only</font>

347
00:14:53,600 --> 00:14:59,779
fundamentally see 16 bits

348
00:14:57,259 --> 00:15:02,360
so this is where segment registers come

349
00:14:59,779 --> 00:15:03,379
in<font color="#CCCCCC"> we have 4 segment registers actually</font>

350
00:15:02,360 --> 00:15:05,929
we might<font color="#E5E5E5"> have more but they're the ones</font>

351
00:15:03,379 --> 00:15:07,339
<font color="#CCCCCC">you need</font><font color="#E5E5E5"> to care about</font><font color="#CCCCCC"> there's the code</font>

352
00:15:05,929 --> 00:15:09,470
segment the<font color="#CCCCCC"> data segment</font><font color="#E5E5E5"> the stack</font>

353
00:15:07,339 --> 00:15:11,240
segment and the extra statement<font color="#E5E5E5"> a</font>

354
00:15:09,470 --> 00:15:14,569
segment<font color="#E5E5E5"> for in case you need just</font>

355
00:15:11,240 --> 00:15:15,829
another one so anyway with<font color="#CCCCCC"> that in mind</font>

356
00:15:14,569 --> 00:15:18,079
<font color="#CCCCCC">let's have a</font><font color="#E5E5E5"> quick crash course on</font>

357
00:15:15,829 --> 00:15:23,089
segment<font color="#E5E5E5"> registers so imagine if you have</font>

358
00:15:18,079 --> 00:15:26,479
a very long piece of memory<font color="#CCCCCC"> and we can</font>

359
00:15:23,089 --> 00:15:31,040
<font color="#E5E5E5">only see 16 bits at the time so however</font>

360
00:15:26,480 --> 00:15:34,220
<font color="#E5E5E5">we can move the sliding</font><font color="#CCCCCC"> window</font><font color="#E5E5E5"> around in</font>

361
00:15:31,040 --> 00:15:36,439
the memory<font color="#E5E5E5"> to go and see like to move</font>

362
00:15:34,220 --> 00:15:39,589
our view of where it<font color="#E5E5E5"> is so we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> do</font>

363
00:15:36,439 --> 00:15:42,949
<font color="#E5E5E5">this and put data around the system</font><font color="#CCCCCC"> and</font>

364
00:15:39,589 --> 00:15:45,559
we can<font color="#E5E5E5"> use the final pointer to specify</font>

365
00:15:42,949 --> 00:15:47,779
how far in to the memory address into

366
00:15:45,559 --> 00:15:51,589
<font color="#E5E5E5">the memory segment we should go so the</font>

367
00:15:47,779 --> 00:15:55,069
DSM<font color="#CCCCCC"> DX really just means a multiplier so</font>

368
00:15:51,589 --> 00:15:58,220
where the data segment<font color="#CCCCCC"> is 100 you need</font>

369
00:15:55,069 --> 00:15:59,829
to just<font color="#E5E5E5"> move 16 100 times 16 to get to</font>

370
00:15:58,220 --> 00:16:03,610
the correct<font color="#E5E5E5"> place in memory and then</font>

371
00:15:59,829 --> 00:16:03,609
da/dx is the offset

372
00:16:04,040 --> 00:16:09,509
this continues on<font color="#E5E5E5"> so where we have</font>

373
00:16:07,019 --> 00:16:10,800
16-bit CPU<font color="#CCCCCC"> we have a bunch of general</font>

374
00:16:09,509 --> 00:16:12,980
<font color="#CCCCCC">used</font><font color="#E5E5E5"> registers or general purpose</font>

375
00:16:10,800 --> 00:16:14,910
<font color="#E5E5E5">registers they're quite</font><font color="#CCCCCC"> useful for</font>

376
00:16:12,980 --> 00:16:17,399
<font color="#E5E5E5">ensuring you don't</font><font color="#CCCCCC"> need to touch Ram too</font>

377
00:16:14,910 --> 00:16:21,180
often x86 actually has a fairly<font color="#E5E5E5"> small</font>

378
00:16:17,399 --> 00:16:22,680
amount<font color="#E5E5E5"> of of of general-purpose</font>

379
00:16:21,180 --> 00:16:25,859
registers some architectures<font color="#CCCCCC"> have way</font>

380
00:16:22,680 --> 00:16:28,439
more<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> modern more modern ships</font>

381
00:16:25,860 --> 00:16:32,310
like GPUs have<font color="#E5E5E5"> hundreds what hundreds</font>

382
00:16:28,439 --> 00:16:33,899
maybe thousands<font color="#CCCCCC"> however this doesn't</font>

383
00:16:32,310 --> 00:16:35,758
<font color="#E5E5E5">really change over time in x86 because</font>

384
00:16:33,899 --> 00:16:37,259
we have to force backwards<font color="#E5E5E5"> capacity so</font>

385
00:16:35,759 --> 00:16:39,209
really what actually hands up happening

386
00:16:37,259 --> 00:16:41,790
when<font color="#E5E5E5"> we move up the</font><font color="#CCCCCC"> bit egde</font><font color="#E5E5E5"> is that the</font>

387
00:16:39,209 --> 00:16:43,290
same registers just get wider<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we add</font>

388
00:16:41,790 --> 00:16:44,790
<font color="#CCCCCC">some more ones for the programmers that</font>

389
00:16:43,290 --> 00:16:46,860
want them and the exact same thing

390
00:16:44,790 --> 00:16:51,810
<font color="#CCCCCC">happened to 64-bit the registers got</font>

391
00:16:46,860 --> 00:16:54,899
wider so thinking about<font color="#CCCCCC"> it we have a lot</font>

392
00:16:51,810 --> 00:16:56,128
of malware now what if we want to<font color="#E5E5E5"> know</font>

393
00:16:54,899 --> 00:16:58,860
<font color="#CCCCCC">everything that's happened in this</font>

394
00:16:56,129 --> 00:17:00,540
entire archive<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we've kind</font><font color="#CCCCCC"> of want to</font>

395
00:16:58,860 --> 00:17:01,740
trace all<font color="#E5E5E5"> of these automatically but we</font>

396
00:17:00,540 --> 00:17:02,939
might not know what we're<font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> so</font>

397
00:17:01,740 --> 00:17:04,799
<font color="#CCCCCC">let's</font><font color="#E5E5E5"> go through the checklist of</font><font color="#CCCCCC"> what</font>

398
00:17:02,939 --> 00:17:07,859
we need to do to trace all of this

399
00:17:04,799 --> 00:17:10,679
<font color="#E5E5E5">malware we need a</font><font color="#CCCCCC"> breakpoint</font><font color="#E5E5E5"> on the on</font>

400
00:17:07,859 --> 00:17:11,849
the<font color="#CCCCCC"> Cisco</font><font color="#E5E5E5"> handler when we get that</font>

401
00:17:10,679 --> 00:17:13,289
breakpoint<font color="#CCCCCC"> we need to save all the</font>

402
00:17:11,849 --> 00:17:15,089
registers so we know which this call was

403
00:17:13,289 --> 00:17:20,039
run and potentially what data is<font color="#E5E5E5"> being</font>

404
00:17:15,089 --> 00:17:22,049
<font color="#CCCCCC">given to</font><font color="#E5E5E5"> the system to</font><font color="#CCCCCC"> the Cisco</font><font color="#E5E5E5"> ideally</font>

405
00:17:20,039 --> 00:17:24,869
<font color="#E5E5E5">we're gonna save 100 bytes from that</font>

406
00:17:22,049 --> 00:17:26,280
data pointer<font color="#E5E5E5"> not especially because we</font>

407
00:17:24,869 --> 00:17:28,109
need it<font color="#E5E5E5"> but it's quite handy</font><font color="#CCCCCC"> in a lot of</font>

408
00:17:26,280 --> 00:17:30,750
registers<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> lobstah schools</font><font color="#E5E5E5"> it's</font>

409
00:17:28,109 --> 00:17:33,260
for<font color="#E5E5E5"> example that what you use</font><font color="#CCCCCC"> to get the</font>

410
00:17:30,750 --> 00:17:35,460
open<font color="#E5E5E5"> file path when you're opening files</font>

411
00:17:33,260 --> 00:17:36,809
<font color="#CCCCCC">we should also</font><font color="#E5E5E5"> probably record the</font>

412
00:17:35,460 --> 00:17:40,740
screen<font color="#E5E5E5"> for quick analysis rather than</font>

413
00:17:36,809 --> 00:17:42,450
<font color="#E5E5E5">just staring at HTML tables and so we</font>

414
00:17:40,740 --> 00:17:44,610
can do that we burn a lot<font color="#E5E5E5"> of CPU time</font>

415
00:17:42,450 --> 00:17:49,640
<font color="#CCCCCC">and</font><font color="#E5E5E5"> probably call some minor amount of</font>

416
00:17:44,610 --> 00:17:52,709
<font color="#CCCCCC">environmental damage</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we get nothing</font>

417
00:17:49,640 --> 00:17:54,750
<font color="#CCCCCC">we just run a bunch of stuff and most of</font>

418
00:17:52,710 --> 00:17:56,820
them don't return anything<font color="#E5E5E5"> at best they</font>

419
00:17:54,750 --> 00:18:01,470
return a goat file string<font color="#E5E5E5"> and they just</font>

420
00:17:56,820 --> 00:18:03,480
do<font color="#E5E5E5"> nothing so if we look deeper into the</font>

421
00:18:01,470 --> 00:18:05,039
reason why<font color="#E5E5E5"> it's sort of a smoking</font><font color="#CCCCCC"> gun</font>

422
00:18:03,480 --> 00:18:07,350
<font color="#CCCCCC">here so we can see the Siskel's that run</font>

423
00:18:05,039 --> 00:18:09,299
on<font color="#E5E5E5"> this file that does nothing and the</font>

424
00:18:07,350 --> 00:18:10,889
<font color="#E5E5E5">smoking gun here</font><font color="#CCCCCC"> is the date so it's</font>

425
00:18:09,299 --> 00:18:14,370
asking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the date from the system and</font>

426
00:18:10,890 --> 00:18:16,110
this sort of<font color="#CCCCCC"> Flags out the first issue</font>

427
00:18:14,370 --> 00:18:17,699
is that<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of ms-dos</font>

428
00:18:16,110 --> 00:18:18,959
viruses don't really have a lot<font color="#E5E5E5"> to go</font><font color="#CCCCCC"> on</font>

429
00:18:17,700 --> 00:18:21,269
<font color="#CCCCCC">because they</font><font color="#E5E5E5"> have no internet connection</font>

430
00:18:18,960 --> 00:18:24,840
<font color="#E5E5E5">and there's not</font><font color="#CCCCCC"> really any other state</font>

431
00:18:21,269 --> 00:18:27,269
they can<font color="#E5E5E5"> decide to activate on so the</font>

432
00:18:24,840 --> 00:18:28,830
date<font color="#CCCCCC"> Cisco is pretty</font><font color="#E5E5E5"> simple</font><font color="#CCCCCC"> the get date</font>

433
00:18:27,269 --> 00:18:31,740
and gate time just<font color="#CCCCCC"> returned all of their</font>

434
00:18:28,830 --> 00:18:36,570
values as registers and you know<font color="#CCCCCC"> some</font>

435
00:18:31,740 --> 00:18:42,779
<font color="#E5E5E5">using the</font><font color="#CCCCCC"> 8-bit</font><font color="#E5E5E5"> halves</font><font color="#CCCCCC"> to save</font><font color="#E5E5E5"> space</font><font color="#CCCCCC"> so</font>

436
00:18:36,570 --> 00:18:45,299
a a naive<font color="#CCCCCC"> way of doing this is what we</font>

437
00:18:42,779 --> 00:18:48,870
do is we would run<font color="#E5E5E5"> the sample</font><font color="#CCCCCC"> we'd wait</font>

438
00:18:45,299 --> 00:18:50,549
for the<font color="#E5E5E5"> Cisco</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> date or time we would</font>

439
00:18:48,870 --> 00:18:52,320
<font color="#E5E5E5">just fit all the values because in this</font>

440
00:18:50,549 --> 00:18:53,490
case we're<font color="#CCCCCC"> using a debugger so we can</font>

441
00:18:52,320 --> 00:18:55,320
<font color="#E5E5E5">automatically change all the state of</font>

442
00:18:53,490 --> 00:18:56,639
the registers<font color="#CCCCCC"> are and we can then</font>

443
00:18:55,320 --> 00:18:58,470
observe<font color="#E5E5E5"> to</font><font color="#CCCCCC"> see if any of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> SIS</font><font color="#E5E5E5"> calls</font>

444
00:18:56,639 --> 00:18:59,580
of the program ran<font color="#CCCCCC"> changed</font><font color="#E5E5E5"> which is</font><font color="#CCCCCC"> a</font>

445
00:18:58,470 --> 00:19:03,029
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> good indication</font><font color="#E5E5E5"> that you've hit</font>

446
00:18:59,580 --> 00:19:04,379
some behavior<font color="#E5E5E5"> that is different and then</font>

447
00:19:03,029 --> 00:19:06,870
<font color="#E5E5E5">you know we can</font><font color="#CCCCCC"> say hooray we found a</font>

448
00:19:04,380 --> 00:19:08,220
new test case<font color="#E5E5E5"> the downside</font><font color="#CCCCCC"> is running</font>

449
00:19:06,870 --> 00:19:10,379
every<font color="#CCCCCC"> one of these samples</font><font color="#E5E5E5"> takes 15</font>

450
00:19:08,220 --> 00:19:13,950
seconds<font color="#E5E5E5"> of CPU</font><font color="#CCCCCC"> time because I messed us</font>

451
00:19:10,380 --> 00:19:15,690
or<font color="#CCCCCC"> 15 seconds of</font><font color="#E5E5E5"> wall time which when</font>

452
00:19:13,950 --> 00:19:18,450
your emulator ms-dos is 15 seconds<font color="#CCCCCC"> of</font>

453
00:19:15,690 --> 00:19:19,679
CPU time<font color="#E5E5E5"> because of the</font><font color="#CCCCCC"> fact that ms-dos</font>

454
00:19:18,450 --> 00:19:20,850
doesn't have power saving mode so<font color="#E5E5E5"> when</font>

455
00:19:19,679 --> 00:19:22,529
it's<font color="#E5E5E5"> not doing anything it just goes</font>

456
00:19:20,850 --> 00:19:26,730
into<font color="#E5E5E5"> a busy loop which makes it very</font>

457
00:19:22,529 --> 00:19:30,260
<font color="#E5E5E5">hard to optimize or we could take</font><font color="#CCCCCC"> a</font>

458
00:19:26,730 --> 00:19:33,059
cleverer look so when we think about it

459
00:19:30,260 --> 00:19:34,769
<font color="#CCCCCC">we</font><font color="#E5E5E5"> are in the interrupt handler</font>

460
00:19:33,059 --> 00:19:36,029
<font color="#E5E5E5">we'll all we ever see is the insides of</font>

461
00:19:34,769 --> 00:19:38,909
the<font color="#E5E5E5"> interrupt handler because we don't</font>

462
00:19:36,029 --> 00:19:40,350
know where the program code is the

463
00:19:38,909 --> 00:19:42,990
interrupt<font color="#E5E5E5"> handler is the only place that</font>

464
00:19:40,350 --> 00:19:44,939
<font color="#E5E5E5">we know is consistent because ms-dos</font>

465
00:19:42,990 --> 00:19:48,330
could potentially load<font color="#E5E5E5"> the code for the</font>

466
00:19:44,940 --> 00:19:50,340
<font color="#E5E5E5">malware or the program anywhere but we</font>

467
00:19:48,330 --> 00:19:51,960
want to<font color="#E5E5E5"> know where the code is it would</font>

468
00:19:50,340 --> 00:19:53,939
be<font color="#E5E5E5"> really handy to know what the code is</font>

469
00:19:51,960 --> 00:19:56,340
<font color="#CCCCCC">that</font><font color="#E5E5E5"> would be</font><font color="#CCCCCC"> about to run so for this</font>

470
00:19:53,940 --> 00:19:57,840
we need<font color="#E5E5E5"> to look towards</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> stack just</font>

471
00:19:56,340 --> 00:19:59,850
like the<font color="#CCCCCC"> DSM D X registers the stacks</font>

472
00:19:57,840 --> 00:20:02,039
are located on a stack segment<font color="#E5E5E5"> and a</font>

473
00:19:59,850 --> 00:20:04,559
stack pointer luckily the first two

474
00:20:02,039 --> 00:20:06,149
<font color="#E5E5E5">values is the interrupt the interrupt</font>

475
00:20:04,559 --> 00:20:08,190
pointer in the stack segment<font color="#CCCCCC"> so we can</font>

476
00:20:06,149 --> 00:20:10,199
use<font color="#E5E5E5"> that to grab exactly where what the</font>

477
00:20:08,190 --> 00:20:11,279
code will<font color="#CCCCCC"> be round afterwards</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> just</font>

478
00:20:10,200 --> 00:20:12,960
need<font color="#E5E5E5"> add a few things to our</font><font color="#CCCCCC"> checklist</font>

479
00:20:11,279 --> 00:20:15,000
<font color="#CCCCCC">we just need to grab</font><font color="#E5E5E5"> four bytes from the</font>

480
00:20:12,960 --> 00:20:17,850
stack pointer<font color="#CCCCCC"> and then using that we can</font>

481
00:20:15,000 --> 00:20:20,429
<font color="#E5E5E5">calculate the destination that the</font><font color="#CCCCCC"> Sisko</font>

482
00:20:17,850 --> 00:20:22,529
will return to and<font color="#CCCCCC"> if we look at</font><font color="#E5E5E5"> some of</font>

483
00:20:20,429 --> 00:20:24,990
them we can look an<font color="#CCCCCC"> example here with</font>

484
00:20:22,529 --> 00:20:26,760
this is what a piece would<font color="#E5E5E5"> have one of</font>

485
00:20:24,990 --> 00:20:27,900
the calls<font color="#CCCCCC"> returned as so we see we're</font>

486
00:20:26,760 --> 00:20:32,430
running<font color="#CCCCCC"> a compare</font>

487
00:20:27,900 --> 00:20:36,570
on DL against the<font color="#E5E5E5"> hex of</font><font color="#CCCCCC"> 0x1 e</font><font color="#E5E5E5"> and then</font>

488
00:20:32,430 --> 00:20:38,910
if the if that<font color="#CCCCCC"> comparison is equal it</font>

489
00:20:36,570 --> 00:20:43,050
will jump to<font color="#E5E5E5"> one memory address and if</font>

490
00:20:38,910 --> 00:20:45,000
<font color="#E5E5E5">not it will jump to another so if we</font>

491
00:20:43,050 --> 00:20:49,980
look at<font color="#E5E5E5"> back at our definition</font><font color="#CCCCCC"> of values</font>

492
00:20:45,000 --> 00:20:54,240
<font color="#E5E5E5">Siskel's we can see that dear</font><font color="#CCCCCC"> l is</font><font color="#E5E5E5"> the</font>

493
00:20:49,980 --> 00:20:59,520
day<font color="#E5E5E5"> so with this we can conclude that</font><font color="#CCCCCC"> d</font>

494
00:20:54,240 --> 00:21:01,860
if if 0<font color="#CCCCCC"> x</font><font color="#E5E5E5"> 1 e</font><font color="#CCCCCC"> is 30 dl</font><font color="#E5E5E5"> is the day this</font>

495
00:20:59,520 --> 00:21:03,720
malware<font color="#E5E5E5"> effectively is saying if the day</font>

496
00:21:01,860 --> 00:21:07,649
of month is<font color="#E5E5E5"> 30</font><font color="#CCCCCC"> we need to go down a</font>

497
00:21:03,720 --> 00:21:09,179
different<font color="#E5E5E5"> path if we run these all</font><font color="#CCCCCC"> over</font>

498
00:21:07,650 --> 00:21:12,480
time<font color="#E5E5E5"> across the whole dataset what we</font>

499
00:21:09,179 --> 00:21:17,970
see is roughly this as a poorly drawn

500
00:21:12,480 --> 00:21:21,000
bar chart we<font color="#CCCCCC"> see out of the 17,500</font>

501
00:21:17,970 --> 00:21:23,070
samples we<font color="#CCCCCC"> have around</font><font color="#E5E5E5"> 4700 of them</font>

502
00:21:21,000 --> 00:21:24,090
<font color="#E5E5E5">check for the date and time and these</font>

503
00:21:23,070 --> 00:21:25,649
<font color="#E5E5E5">are the ones that are really tricky</font>

504
00:21:24,090 --> 00:21:27,300
<font color="#CCCCCC">because they're</font><font color="#E5E5E5"> really hard to activate</font>

505
00:21:25,650 --> 00:21:28,380
they're also the<font color="#CCCCCC"> most interesting though</font>

506
00:21:27,300 --> 00:21:33,090
because<font color="#E5E5E5"> those are the ones trying</font><font color="#CCCCCC"> to</font>

507
00:21:28,380 --> 00:21:34,920
hide<font color="#E5E5E5"> so with that in</font><font color="#CCCCCC"> mind</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> need to we</font>

508
00:21:33,090 --> 00:21:37,379
have the code segment<font color="#E5E5E5"> that we're about</font>

509
00:21:34,920 --> 00:21:38,580
<font color="#E5E5E5">to</font><font color="#CCCCCC"> run when we</font><font color="#E5E5E5"> return and we can't</font>

510
00:21:37,380 --> 00:21:40,950
really brute force because<font color="#E5E5E5"> it takes a</font>

511
00:21:38,580 --> 00:21:44,159
lot<font color="#CCCCCC"> of CPU time but we can't brute force</font>

512
00:21:40,950 --> 00:21:46,020
it<font color="#E5E5E5"> inside a real a</font><font color="#CCCCCC"> real or emulated</font>

513
00:21:44,160 --> 00:21:47,610
machine but we can brute force it in a

514
00:21:46,020 --> 00:21:49,379
significantly<font color="#E5E5E5"> more interesting way</font><font color="#CCCCCC"> we</font>

515
00:21:47,610 --> 00:21:54,240
need to build<font color="#CCCCCC"> something we need</font><font color="#E5E5E5"> to build</font>

516
00:21:49,380 --> 00:21:58,440
<font color="#E5E5E5">the world's worst x86 emulator so dubbed</font>

517
00:21:54,240 --> 00:22:01,200
Ben X Ben x86<font color="#CCCCCC"> it's 16-bit</font><font color="#E5E5E5"> meant 16-bit</font>

518
00:21:58,440 --> 00:22:03,780
only any attempt<font color="#E5E5E5"> to access memory</font>

519
00:22:01,200 --> 00:22:05,010
effectively ends the simulation<font color="#CCCCCC"> it's got</font>

520
00:22:03,780 --> 00:22:06,480
a fake stack if you try<font color="#E5E5E5"> and push</font>

521
00:22:05,010 --> 00:22:08,309
something<font color="#E5E5E5"> onto the stack it says sure</font>

522
00:22:06,480 --> 00:22:09,570
fine if you try<font color="#E5E5E5"> and pop it it's like</font><font color="#CCCCCC"> oh</font>

523
00:22:08,309 --> 00:22:10,920
actually I never hold<font color="#E5E5E5"> it held any of</font>

524
00:22:09,570 --> 00:22:13,649
that data anyway sorry<font color="#CCCCCC"> we're ending the</font>

525
00:22:10,920 --> 00:22:15,900
simulation<font color="#CCCCCC"> 80 opcodes most of them a</font>

526
00:22:13,650 --> 00:22:18,900
jumps because<font color="#E5E5E5"> there's that's the primary</font>

527
00:22:15,900 --> 00:22:20,730
<font color="#CCCCCC">purpose is comparing in jumps it the</font>

528
00:22:18,900 --> 00:22:23,580
difference is it logs every opcode every

529
00:22:20,730 --> 00:22:25,679
address<font color="#E5E5E5"> that it went through and it can</font>

530
00:22:23,580 --> 00:22:28,559
be run with<font color="#E5E5E5"> just a small x86 code</font>

531
00:22:25,679 --> 00:22:30,059
segment and<font color="#CCCCCC"> a register snapshot this</font>

532
00:22:28,559 --> 00:22:33,059
means that we can<font color="#E5E5E5"> test all days from</font>

533
00:22:30,059 --> 00:22:35,879
1980 to<font color="#E5E5E5"> 2005 in a roughly about 100</font>

534
00:22:33,059 --> 00:22:38,250
<font color="#E5E5E5">milliseconds</font><font color="#CCCCCC"> and most</font><font color="#E5E5E5"> programs ended up</font>

535
00:22:35,880 --> 00:22:41,789
<font color="#E5E5E5">having just three</font><font color="#CCCCCC"> different code paths</font>

536
00:22:38,250 --> 00:22:44,869
<font color="#E5E5E5">on average so that yields us with 17</font>

537
00:22:41,789 --> 00:22:47,789
and virus samples and about<font color="#CCCCCC"> 10,000</font><font color="#E5E5E5"> of</font>

538
00:22:44,869 --> 00:22:51,090
samples that<font color="#E5E5E5"> had date variations as in</font>

539
00:22:47,789 --> 00:22:53,850
once you explode the complexity so I'm

540
00:22:51,090 --> 00:22:57,539
<font color="#E5E5E5">gonna now use my final remaining</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> to</font>

541
00:22:53,850 --> 00:22:59,759
go<font color="#E5E5E5"> through some</font><font color="#CCCCCC"> of my</font><font color="#E5E5E5"> favorite so this</font>

542
00:22:57,539 --> 00:23:01,830
<font color="#E5E5E5">is an example of a virus</font><font color="#CCCCCC"> that just</font>

543
00:22:59,759 --> 00:23:04,139
<font color="#E5E5E5">doesn't do</font><font color="#CCCCCC"> anything on the</font><font color="#E5E5E5"> first of 1980</font>

544
00:23:01,830 --> 00:23:05,820
<font color="#E5E5E5">however if you would happen</font><font color="#CCCCCC"> to be</font>

545
00:23:04,139 --> 00:23:09,478
<font color="#E5E5E5">running</font><font color="#CCCCCC"> this on Newsday</font><font color="#E5E5E5"> New Year's Day</font>

546
00:23:05,820 --> 00:23:11,220
<font color="#CCCCCC">you would get this no matter what you do</font>

547
00:23:09,479 --> 00:23:14,159
every program<font color="#E5E5E5"> you can't exit out of this</font>

548
00:23:11,220 --> 00:23:15,720
your machine is hung<font color="#E5E5E5"> this might be great</font>

549
00:23:14,159 --> 00:23:16,889
<font color="#E5E5E5">break you might be like oh</font><font color="#CCCCCC"> cool</font><font color="#E5E5E5"> I don't</font>

550
00:23:15,720 --> 00:23:19,019
<font color="#CCCCCC">need to do work</font><font color="#E5E5E5"> anymore because my</font>

551
00:23:16,889 --> 00:23:20,279
<font color="#CCCCCC">computer will literally</font><font color="#E5E5E5"> not let me</font><font color="#CCCCCC"> this</font>

552
00:23:19,019 --> 00:23:22,369
<font color="#E5E5E5">also might be terrible</font><font color="#CCCCCC"> because you might</font>

553
00:23:20,279 --> 00:23:25,859
need to do<font color="#CCCCCC"> some work on New Year's Day</font>

554
00:23:22,369 --> 00:23:28,559
<font color="#E5E5E5">here's</font><font color="#CCCCCC"> another example this does nothing</font>

555
00:23:25,859 --> 00:23:32,189
<font color="#CCCCCC">as well</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> another innocent comm file</font>

556
00:23:28,559 --> 00:23:33,479
<font color="#E5E5E5">of course reminding that these pieces of</font>

557
00:23:32,190 --> 00:23:35,039
malware will be act<font color="#E5E5E5"> wrapped around</font>

558
00:23:33,479 --> 00:23:37,109
something<font color="#E5E5E5"> else so you know</font><font color="#CCCCCC"> almost</font>

559
00:23:35,039 --> 00:23:38,759
<font color="#CCCCCC">anything could</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> infected in here</font><font color="#E5E5E5"> in</font>

560
00:23:37,109 --> 00:23:43,369
this case though these binaries are nice

561
00:23:38,759 --> 00:23:47,759
and<font color="#CCCCCC"> shaped down however</font><font color="#E5E5E5"> instead we get</font>

562
00:23:43,369 --> 00:23:50,789
this which i think is super<font color="#CCCCCC"> interesting</font>

563
00:23:47,759 --> 00:23:53,820
in this basically the author is aware

564
00:23:50,789 --> 00:23:55,590
the<font color="#CCCCCC"> they're telling you they're</font><font color="#E5E5E5"> actually</font>

565
00:23:53,820 --> 00:23:57,239
like<font color="#E5E5E5"> self disclosing they're saying the</font>

566
00:23:55,590 --> 00:24:01,978
previous year<font color="#CCCCCC"> i've infected your</font>

567
00:23:57,239 --> 00:24:03,840
<font color="#E5E5E5">computer</font><font color="#CCCCCC"> and for some reason it's</font>

568
00:24:01,979 --> 00:24:06,509
they're being nice<font color="#CCCCCC"> they're just saying</font>

569
00:24:03,840 --> 00:24:09,209
<font color="#E5E5E5">yeah actually</font><font color="#CCCCCC"> you have been</font><font color="#E5E5E5"> infected and</font>

570
00:24:06,509 --> 00:24:12,359
as a I guess a pity<font color="#E5E5E5"> I'm just</font><font color="#CCCCCC"> gonna</font>

571
00:24:09,210 --> 00:24:14,070
<font color="#CCCCCC">remove myself now I don't really</font><font color="#E5E5E5"> for</font>

572
00:24:12,359 --> 00:24:16,408
some reason it's also encouraging<font color="#CCCCCC"> you to</font>

573
00:24:14,070 --> 00:24:18,658
buy McAfee

574
00:24:16,409 --> 00:24:22,759
this was back in<font color="#CCCCCC"> the day when John</font>

575
00:24:18,659 --> 00:24:22,759
McAfee himself<font color="#E5E5E5"> actually wrote McAfee</font>

576
00:24:22,970 --> 00:24:32,099
interesting times<font color="#E5E5E5"> definitely interesting</font>

577
00:24:26,399 --> 00:24:37,469
times<font color="#CCCCCC"> here is another example</font><font color="#E5E5E5"> this one I</font>

578
00:24:32,099 --> 00:24:40,559
found particularly obscure on the 8th of

579
00:24:37,470 --> 00:24:43,289
November in 1980<font color="#E5E5E5"> or any year I think</font>

580
00:24:40,559 --> 00:24:44,999
<font color="#CCCCCC">actually it turns all zeros on the</font>

581
00:24:43,289 --> 00:24:47,269
system into tiny little glyphs that<font color="#E5E5E5"> say</font>

582
00:24:44,999 --> 00:24:47,269
hate

583
00:24:49,900 --> 00:24:54,290
if anyone understands<font color="#E5E5E5"> this I'd really</font>

584
00:24:52,309 --> 00:24:56,389
<font color="#CCCCCC">like to know</font><font color="#E5E5E5"> like I've been thinking</font>

585
00:24:54,290 --> 00:24:59,690
about<font color="#CCCCCC"> this a lot</font><font color="#E5E5E5"> like what does it</font><font color="#CCCCCC"> mean</font>

586
00:24:56,390 --> 00:25:05,450
is it an artistic<font color="#CCCCCC"> statement is it I wish</font>

587
00:24:59,690 --> 00:25:09,920
I knew there could be a CCC<font color="#CCCCCC"> Varian</font><font color="#E5E5E5"> that</font>

588
00:25:05,450 --> 00:25:11,929
says<font color="#CCCCCC"> Marte another good</font><font color="#E5E5E5"> one in that it's</font>

589
00:25:09,920 --> 00:25:15,320
the<font color="#E5E5E5"> last thing</font><font color="#CCCCCC"> I ever want to</font><font color="#E5E5E5"> see any</font>

590
00:25:11,929 --> 00:25:17,150
program<font color="#CCCCCC"> tell me is this one here where</font>

591
00:25:15,320 --> 00:25:21,439
you run it and<font color="#CCCCCC"> it says error</font><font color="#E5E5E5"> eating</font>

592
00:25:17,150 --> 00:25:23,750
<font color="#E5E5E5">drive see I never</font><font color="#CCCCCC"> ever want to err on</font>

593
00:25:21,440 --> 00:25:25,910
any program<font color="#CCCCCC"> that unexpected</font><font color="#E5E5E5"> leader says</font>

594
00:25:23,750 --> 00:25:29,240
sorry<font color="#E5E5E5"> almost I failed to remove your</font>

595
00:25:25,910 --> 00:25:30,950
root<font color="#E5E5E5"> filesystem</font><font color="#CCCCCC"> don't know why could you</font>

596
00:25:29,240 --> 00:25:35,120
like change your<font color="#E5E5E5"> settings so I can</font>

597
00:25:30,950 --> 00:25:37,100
remove<font color="#E5E5E5"> it</font><font color="#CCCCCC"> chairs and finally this is</font><font color="#E5E5E5"> one</font>

598
00:25:35,120 --> 00:25:40,639
of<font color="#CCCCCC"> my absolute favorites in that it's</font>

599
00:25:37,100 --> 00:25:42,439
<font color="#E5E5E5">just brilliant</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> that it also stops you</font>

600
00:25:40,640 --> 00:25:45,830
from<font color="#CCCCCC"> running the program you want</font><font color="#E5E5E5"> to run</font>

601
00:25:42,440 --> 00:25:50,030
it exits prematurely<font color="#CCCCCC"> this is the virus</font>

602
00:25:45,830 --> 00:25:53,059
version of the Navy SEAL<font color="#E5E5E5"> copypasta says</font>

603
00:25:50,030 --> 00:25:55,790
I am an assassin<font color="#CCCCCC"> I want to and I shall</font>

604
00:25:53,059 --> 00:25:58,610
kill you<font color="#CCCCCC"> I also hate Aladdin</font><font color="#E5E5E5"> and I also</font>

605
00:25:55,790 --> 00:26:01,850
will kill it<font color="#E5E5E5"> I will eliminate you with</font>

606
00:25:58,610 --> 00:26:03,949
and we know where this<font color="#E5E5E5"> is going</font><font color="#CCCCCC"> it says</font>

607
00:26:01,850 --> 00:26:05,659
it's fear fear the virus it is more

608
00:26:03,950 --> 00:26:08,710
powerful<font color="#E5E5E5"> than God</font><font color="#CCCCCC"> it only activates</font><font color="#E5E5E5"> on</font>

609
00:26:05,660 --> 00:26:08,710
one day though so it's fine

610
00:26:08,720 --> 00:26:14,090
thank you for<font color="#E5E5E5"> your time</font><font color="#CCCCCC"> I know it's late</font>

611
00:26:10,760 --> 00:26:15,740
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I will happily take any questions</font><font color="#CCCCCC"> or</font>

612
00:26:14,090 --> 00:26:17,360
<font color="#E5E5E5">Corrections if you know this topic</font>

613
00:26:15,740 --> 00:26:18,140
better<font color="#E5E5E5"> than me</font>

614
00:26:17,360 --> 00:26:26,399
[Applause]

615
00:26:18,140 --> 00:26:29,409
[Music]

616
00:26:26,399 --> 00:26:33,428
this totally brings tears to my<font color="#CCCCCC"> eyes was</font>

617
00:26:29,409 --> 00:26:35,409
nostalgia<font color="#E5E5E5"> so</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> if there is any</font>

618
00:26:33,429 --> 00:26:37,120
questions we have<font color="#E5E5E5"> microphones just</font><font color="#CCCCCC"> do it</font>

619
00:26:35,409 --> 00:26:39,309
<font color="#E5E5E5">around the room there's like one two</font>

620
00:26:37,120 --> 00:26:41,620
<font color="#CCCCCC">three four and</font><font color="#E5E5E5"> one in the back we also</font>

621
00:26:39,309 --> 00:26:43,990
have<font color="#E5E5E5"> questions perhaps from the</font><font color="#CCCCCC"> internet</font>

622
00:26:41,620 --> 00:26:46,959
<font color="#CCCCCC">if</font><font color="#E5E5E5"> you want to ask a question come</font><font color="#CCCCCC"> up to</font>

623
00:26:43,990 --> 00:26:49,480
the microphone<font color="#E5E5E5"> ask a question just as a</font>

624
00:26:46,960 --> 00:26:51,909
reminder<font color="#E5E5E5"> a question is one or two</font>

625
00:26:49,480 --> 00:26:57,549
sentences with a question<font color="#CCCCCC"> mark behind</font><font color="#E5E5E5"> it</font>

626
00:26:51,909 --> 00:26:58,360
<font color="#E5E5E5">and not a life story attached so let's</font>

627
00:26:57,549 --> 00:27:00,220
see what we<font color="#E5E5E5"> have</font>

628
00:26:58,360 --> 00:27:02,439
I'm going to start<font color="#E5E5E5"> with microphone</font>

629
00:27:00,220 --> 00:27:06,190
<font color="#E5E5E5">number one just because</font><font color="#CCCCCC"> I can see it</font>

630
00:27:02,440 --> 00:27:08,740
easiest<font color="#E5E5E5"> hi Ben thanks for the talk</font>

631
00:27:06,190 --> 00:27:13,179
<font color="#E5E5E5">really</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> my question would be</font>

632
00:27:08,740 --> 00:27:16,269
did<font color="#E5E5E5"> you do any analysis on what</font><font color="#CCCCCC"> ratio</font><font color="#E5E5E5"> of</font>

633
00:27:13,179 --> 00:27:19,690
the viruses was or<font color="#E5E5E5"> artistic and which</font>

634
00:27:16,269 --> 00:27:21,879
one<font color="#CCCCCC"> actually did damage so most of them</font>

635
00:27:19,690 --> 00:27:25,210
<font color="#E5E5E5">surprisingly don't do damage I actually</font>

636
00:27:21,879 --> 00:27:27,820
really struggled to find a date varying

637
00:27:25,210 --> 00:27:29,409
sample that's specifically activate on a

638
00:27:27,820 --> 00:27:31,389
certain day and<font color="#CCCCCC"> decided to delete every</font>

639
00:27:29,409 --> 00:27:34,059
file there<font color="#E5E5E5"> are some very</font><font color="#CCCCCC"> good</font><font color="#E5E5E5"> ones in</font>

640
00:27:31,389 --> 00:27:36,008
the some of<font color="#E5E5E5"> them are like virus scanning</font>

641
00:27:34,059 --> 00:27:37,480
utilities that<font color="#E5E5E5"> just don't do anything on</font>

642
00:27:36,009 --> 00:27:38,259
certain<font color="#E5E5E5"> dates and in one day like while</font>

643
00:27:37,480 --> 00:27:39,340
they're<font color="#E5E5E5"> telling you all the files</font>

644
00:27:38,259 --> 00:27:42,009
they're scanning it's actually telling

645
00:27:39,340 --> 00:27:43,360
<font color="#E5E5E5">you all the files they're deleting so</font>

646
00:27:42,009 --> 00:27:45,480
that's<font color="#E5E5E5"> particularly cruel but it's</font>

647
00:27:43,360 --> 00:27:48,639
actually surprisingly hard<font color="#E5E5E5"> to find a</font>

648
00:27:45,480 --> 00:27:50,350
virus sample that actually was brutally

649
00:27:48,639 --> 00:27:51,699
malicious<font color="#CCCCCC"> there was some that would just</font>

650
00:27:50,350 --> 00:27:53,199
you<font color="#CCCCCC"> know in fact fineries but it's very</font>

651
00:27:51,700 --> 00:27:55,779
<font color="#E5E5E5">hard</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> find one</font><font color="#CCCCCC"> that will I think</font><font color="#E5E5E5"> was</font>

652
00:27:53,200 --> 00:27:57,730
brutally malicious<font color="#CCCCCC"> which is a far cry</font>

653
00:27:55,779 --> 00:28:00,429
from<font color="#E5E5E5"> the days well from the days that we</font>

654
00:27:57,730 --> 00:28:03,779
live in<font color="#CCCCCC"> right now</font><font color="#E5E5E5"> where you</font><font color="#CCCCCC"> know we're</font>

655
00:28:00,429 --> 00:28:06,669
taking<font color="#E5E5E5"> down hospitals with</font><font color="#CCCCCC"> Windows bugs</font>

656
00:28:03,779 --> 00:28:09,159
as<font color="#E5E5E5"> everybody is leaving the room please</font>

657
00:28:06,669 --> 00:28:11,230
do<font color="#E5E5E5"> it quietly</font><font color="#CCCCCC"> I have a question at three</font>

658
00:28:09,159 --> 00:28:13,259
<font color="#E5E5E5">on that side</font><font color="#CCCCCC"> yes</font>

659
00:28:11,230 --> 00:28:17,769
since a lot of<font color="#E5E5E5"> industrial control</font>

660
00:28:13,259 --> 00:28:20,860
<font color="#CCCCCC">systems still run Doss what's the threat</font>

661
00:28:17,769 --> 00:28:26,190
from<font color="#E5E5E5"> DOS malware that might be written</font>

662
00:28:20,860 --> 00:28:28,570
<font color="#CCCCCC">today it's probably unlikely</font><font color="#E5E5E5"> the</font>

663
00:28:26,190 --> 00:28:30,340
industrial control system that's running

664
00:28:28,570 --> 00:28:32,370
<font color="#CCCCCC">dos would come into</font><font color="#E5E5E5"> contact with DOS</font>

665
00:28:30,340 --> 00:28:35,350
malware<font color="#E5E5E5"> the only way I can think</font><font color="#CCCCCC"> is if</font>

666
00:28:32,370 --> 00:28:37,000
one<font color="#E5E5E5"> vendor was</font><font color="#CCCCCC"> or like a factory or</font>

667
00:28:35,350 --> 00:28:39,070
supply or whatever was basically

668
00:28:37,000 --> 00:28:40,000
downloading<font color="#E5E5E5"> or we're basically</font><font color="#CCCCCC"> where's</font>

669
00:28:39,070 --> 00:28:43,509
on

670
00:28:40,000 --> 00:28:45,190
industrial control boxes<font color="#CCCCCC"> I wouldn't be</font>

671
00:28:43,509 --> 00:28:47,860
surprised<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it would be pretty</font>

672
00:28:45,190 --> 00:28:49,990
irresponsible<font color="#CCCCCC"> but it would be quiet</font>

673
00:28:47,860 --> 00:28:52,840
<font color="#E5E5E5">quite surprising</font><font color="#CCCCCC"> to find ms-dos malware</font>

674
00:28:49,990 --> 00:28:54,909
<font color="#E5E5E5">today on industrial controllers that was</font>

675
00:28:52,840 --> 00:28:56,889
installed recently<font color="#E5E5E5"> and not just a</font>

676
00:28:54,909 --> 00:29:01,570
lingering infection<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the last you</font>

677
00:28:56,889 --> 00:29:03,299
know<font color="#E5E5E5"> 20 years</font><font color="#CCCCCC"> microphone - did you</font><font color="#E5E5E5"> find</font>

678
00:29:01,570 --> 00:29:06,580
any conditions that<font color="#E5E5E5"> weren't date based</font>

679
00:29:03,299 --> 00:29:08,580
some of them do attempt<font color="#CCCCCC"> - some of</font><font color="#E5E5E5"> them</font>

680
00:29:06,580 --> 00:29:10,658
try and<font color="#E5E5E5"> circumvent the date recognition</font>

681
00:29:08,580 --> 00:29:12,519
unfortunates very hard to<font color="#CCCCCC"> brute-force</font>

682
00:29:10,659 --> 00:29:13,870
those some of<font color="#E5E5E5"> them install</font><font color="#CCCCCC"> themselves as</font>

683
00:29:12,519 --> 00:29:17,259
what's called<font color="#CCCCCC"> TSR terminate and stay</font>

684
00:29:13,870 --> 00:29:20,590
resident<font color="#E5E5E5"> which basically means that they</font>

685
00:29:17,259 --> 00:29:22,480
will exit out<font color="#E5E5E5"> run in the background and</font>

686
00:29:20,590 --> 00:29:24,490
<font color="#E5E5E5">continuously ask the actual system timer</font>

687
00:29:22,480 --> 00:29:26,409
<font color="#E5E5E5">what time it is it's a bit of a more</font>

688
00:29:24,490 --> 00:29:28,299
risky strategy<font color="#E5E5E5"> because the system time</font>

689
00:29:26,409 --> 00:29:30,610
it<font color="#E5E5E5"> might not exist</font><font color="#CCCCCC"> which would be</font>

690
00:29:28,299 --> 00:29:31,870
<font color="#CCCCCC">unfortunate for</font><font color="#E5E5E5"> the virus</font><font color="#CCCCCC"> so definitely</font>

691
00:29:30,610 --> 00:29:35,189
there<font color="#CCCCCC"> are viruses</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> have way more</font>

692
00:29:31,870 --> 00:29:38,320
complicated<font color="#CCCCCC"> execution of conditions I</font>

693
00:29:35,190 --> 00:29:40,299
observed one<font color="#CCCCCC"> sample</font><font color="#E5E5E5"> that only activated</font>

694
00:29:38,320 --> 00:29:43,779
<font color="#CCCCCC">after I believe it</font><font color="#E5E5E5"> was something silly</font>

695
00:29:40,299 --> 00:29:45,940
like 100 key presses which is very hard

696
00:29:43,779 --> 00:29:47,440
to<font color="#E5E5E5"> automatically test those sort of that</font>

697
00:29:45,940 --> 00:29:51,399
those sort of viruses require static

698
00:29:47,440 --> 00:29:54,909
<font color="#CCCCCC">analysis and statically analyzing 17,000</font>

699
00:29:51,399 --> 00:29:59,229
samples is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> consuming task</font><font color="#E5E5E5"> so we</font>

700
00:29:54,909 --> 00:30:02,529
have a question<font color="#E5E5E5"> from the internet and do</font>

701
00:29:59,230 --> 00:30:05,440
you have the source or what is the<font color="#CCCCCC"> soul</font>

702
00:30:02,529 --> 00:30:08,559
of<font color="#CCCCCC"> the malware that you</font><font color="#E5E5E5"> analyzed here</font>

703
00:30:05,440 --> 00:30:11,620
and is it published somewhere<font color="#CCCCCC"> you can</font>

704
00:30:08,559 --> 00:30:13,299
still find dumps of VX heavens<font color="#E5E5E5"> on and</font>

705
00:30:11,620 --> 00:30:16,989
probably<font color="#CCCCCC"> more modern dumps of</font><font color="#E5E5E5"> VX heavens</font>

706
00:30:13,299 --> 00:30:18,158
<font color="#E5E5E5">I'm on popular torrent websites</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> I'm</font>

707
00:30:16,990 --> 00:30:22,379
<font color="#E5E5E5">sure there are</font><font color="#CCCCCC"> also copies floating</font>

708
00:30:18,159 --> 00:30:22,379
<font color="#E5E5E5">about on non popular torrent websites</font>

709
00:30:22,470 --> 00:30:29,889
over<font color="#E5E5E5"> there microphone</font><font color="#CCCCCC"> 1 I've been I'm</font>

710
00:30:27,220 --> 00:30:33,070
<font color="#CCCCCC">job thank you</font><font color="#E5E5E5"> for your talk I was</font>

711
00:30:29,889 --> 00:30:35,139
wondering<font color="#E5E5E5"> did you learn anything from</font>

712
00:30:33,070 --> 00:30:37,389
<font color="#E5E5E5">your studies of these viruses that</font>

713
00:30:35,139 --> 00:30:41,258
should be taught in modern day computer

714
00:30:37,389 --> 00:30:44,408
science<font color="#CCCCCC"> asses like or efficient sorting</font>

715
00:30:41,259 --> 00:30:47,019
algorithm or some<font color="#E5E5E5"> hidden gem that</font><font color="#CCCCCC"> they</font>

716
00:30:44,409 --> 00:30:49,659
should<font color="#E5E5E5"> be part of coach computer</font><font color="#CCCCCC"> stays</font>

717
00:30:47,019 --> 00:30:52,019
my primary takeaway was x86 was a

718
00:30:49,659 --> 00:30:52,019
mistake

719
00:30:53,080 --> 00:30:57,939
[Applause]

720
00:30:53,470 --> 00:30:57,940
[Music]

721
00:30:58,480 --> 00:31:03,020
so I'm<font color="#E5E5E5"> not seeing any</font><font color="#CCCCCC"> more questions</font>

722
00:31:01,370 --> 00:31:05,899
which I<font color="#CCCCCC"> would know there is okay one</font>

723
00:31:03,020 --> 00:31:09,200
<font color="#E5E5E5">more</font><font color="#CCCCCC"> question from the internet have you</font>

724
00:31:05,900 --> 00:31:12,230
found malware<font color="#CCCCCC"> samples</font><font color="#E5E5E5"> that did like try</font>

725
00:31:09,200 --> 00:31:14,450
<font color="#E5E5E5">to this detect dummy binaries or</font>

726
00:31:12,230 --> 00:31:15,950
whatever<font color="#CCCCCC"> to avoid easy analysis oh</font>

727
00:31:14,450 --> 00:31:19,850
actually<font color="#E5E5E5"> that's a</font><font color="#CCCCCC"> really good question</font>

728
00:31:15,950 --> 00:31:23,780
<font color="#CCCCCC">so it is it's complicated</font>

729
00:31:19,850 --> 00:31:25,429
so some<font color="#E5E5E5"> virus is</font><font color="#CCCCCC"> word so maybe that's</font>

730
00:31:23,780 --> 00:31:26,389
let's just be dangerous that's<font color="#E5E5E5"> try and</font>

731
00:31:25,430 --> 00:31:32,800
go backwards on<font color="#E5E5E5"> my home written</font>

732
00:31:26,390 --> 00:31:39,980
presentation software<font color="#E5E5E5"> so</font><font color="#CCCCCC"> don't come on</font>

733
00:31:32,800 --> 00:31:42,050
<font color="#E5E5E5">too many slides I have regrets yeah okay</font>

734
00:31:39,980 --> 00:31:43,850
here<font color="#E5E5E5"> we are</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> slide</font><font color="#CCCCCC"> okay so you know</font>

735
00:31:42,050 --> 00:31:45,500
<font color="#E5E5E5">here how I'm saying that the malware</font>

736
00:31:43,850 --> 00:31:47,689
infection goes to the end<font color="#E5E5E5"> well some</font>

737
00:31:45,500 --> 00:31:49,640
samples are really cool<font color="#E5E5E5"> in the they</font>

738
00:31:47,690 --> 00:31:51,740
don't change<font color="#E5E5E5"> the size of the file they</font>

739
00:31:49,640 --> 00:31:54,320
just find areas the files<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are full</font>

740
00:31:51,740 --> 00:31:56,630
of null<font color="#E5E5E5"> bytes and just say this is</font>

741
00:31:54,320 --> 00:31:58,550
<font color="#CCCCCC">probably fine I'm just gonna</font><font color="#E5E5E5"> plot myself</font>

742
00:31:56,630 --> 00:32:01,040
here<font color="#CCCCCC"> which may</font><font color="#E5E5E5"> have unintended</font>

743
00:31:58,550 --> 00:32:02,450
<font color="#CCCCCC">consequences it may</font><font color="#E5E5E5"> mean that if a</font>

744
00:32:01,040 --> 00:32:05,210
program<font color="#E5E5E5"> is like a statically type</font>

745
00:32:02,450 --> 00:32:08,060
statically defined<font color="#E5E5E5"> byte array of like a</font>

746
00:32:05,210 --> 00:32:09,950
certain size and<font color="#E5E5E5"> the program is relying</font>

747
00:32:08,060 --> 00:32:11,419
on it being<font color="#E5E5E5"> zeros when the accesses it</font>

748
00:32:09,950 --> 00:32:13,270
for the first time<font color="#E5E5E5"> it may get very</font>

749
00:32:11,420 --> 00:32:16,640
surprised<font color="#E5E5E5"> to</font><font color="#CCCCCC"> find there's a some malware</font>

750
00:32:13,270 --> 00:32:19,550
code in there<font color="#CCCCCC"> but</font><font color="#E5E5E5"> generally</font><font color="#CCCCCC"> speaking as</font>

751
00:32:16,640 --> 00:32:21,050
<font color="#CCCCCC">far as the underwear these this this</font>

752
00:32:19,550 --> 00:32:23,000
deployment procedure works pretty well

753
00:32:21,050 --> 00:32:26,810
and the actually is very<font color="#E5E5E5"> good at</font>

754
00:32:23,000 --> 00:32:28,400
avoiding antivirus of the era<font color="#E5E5E5"> which</font>

755
00:32:26,810 --> 00:32:30,409
would just be<font color="#CCCCCC"> checking like common</font>

756
00:32:28,400 --> 00:32:32,240
system files and<font color="#E5E5E5"> its size and you know</font>

757
00:32:30,410 --> 00:32:36,830
<font color="#E5E5E5">if the size</font><font color="#CCCCCC"> increases of command comm</font>

758
00:32:32,240 --> 00:32:42,670
then that's clearly bad news we have a

759
00:32:36,830 --> 00:32:46,760
<font color="#E5E5E5">question on microphone</font><font color="#CCCCCC"> one try to</font>

760
00:32:42,670 --> 00:32:48,980
eliminate or manipulate a virus today oh

761
00:32:46,760 --> 00:32:51,020
yeah<font color="#E5E5E5"> there so a lot of the samples will</font>

762
00:32:48,980 --> 00:32:54,320
<font color="#CCCCCC">actively go and look for</font><font color="#E5E5E5"> files of other</font>

763
00:32:51,020 --> 00:32:55,910
antiviruses but<font color="#E5E5E5"> I am generally under the</font>

764
00:32:54,320 --> 00:32:57,889
impression in the it's<font color="#E5E5E5"> kind of hard to</font>

765
00:32:55,910 --> 00:33:00,710
<font color="#E5E5E5">find them there weren't actually</font><font color="#CCCCCC"> that</font>

766
00:32:57,890 --> 00:33:03,740
<font color="#E5E5E5">many antivirus products back in the day</font>

767
00:33:00,710 --> 00:33:04,760
I wasn't<font color="#E5E5E5"> really I feel like there's a</font>

768
00:33:03,740 --> 00:33:06,860
bit<font color="#CCCCCC"> of a niche</font><font color="#E5E5E5"> thing to be running</font>

769
00:33:04,760 --> 00:33:10,010
Microsoft did for<font color="#E5E5E5"> awhile ship</font><font color="#CCCCCC"> their NT</font>

770
00:33:06,860 --> 00:33:10,800
own antivirus with ms-dos so I guess you

771
00:33:10,010 --> 00:33:14,730
<font color="#E5E5E5">know what</font>

772
00:33:10,800 --> 00:33:16,139
years old so there were there<font color="#E5E5E5"> were anti</font>

773
00:33:14,730 --> 00:33:22,170
viruses<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there I don't think many of</font>

774
00:33:16,140 --> 00:33:26,010
them were<font color="#CCCCCC"> very effective any</font><font color="#E5E5E5"> more</font>

775
00:33:22,170 --> 00:33:27,420
<font color="#E5E5E5">questions there where oh right</font>

776
00:33:26,010 --> 00:33:28,740
another one from<font color="#CCCCCC"> the engine</font><font color="#E5E5E5"> is</font>

777
00:33:27,420 --> 00:33:30,380
interesting<font color="#CCCCCC"> that the engine has querying</font>

778
00:33:28,740 --> 00:33:34,710
ms-dos all the time

779
00:33:30,380 --> 00:33:39,230
go<font color="#E5E5E5"> ahead did you do the diagnosis by</font>

780
00:33:34,710 --> 00:33:41,400
hand<font color="#CCCCCC"> or do you have</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> to so</font><font color="#E5E5E5"> many hours</font>

781
00:33:39,230 --> 00:33:41,970
<font color="#E5E5E5">no so there's a couple of good tools to</font>

782
00:33:41,400 --> 00:33:44,430
<font color="#E5E5E5">do it</font>

783
00:33:41,970 --> 00:33:46,380
<font color="#E5E5E5">ASCII float</font><font color="#CCCCCC"> org I think is a fantastic</font>

784
00:33:44,430 --> 00:33:50,330
tool<font color="#CCCCCC"> I would highly recommend it I think</font>

785
00:33:46,380 --> 00:33:50,330
it's not maintained very<font color="#E5E5E5"> well though</font>

786
00:33:51,230 --> 00:33:56,970
<font color="#CCCCCC">microphone 1 are you publishing the tool</font>

787
00:33:54,780 --> 00:34:02,370
you wrote<font color="#E5E5E5"> I will be publishing the tools</font>

788
00:33:56,970 --> 00:34:04,500
at some point<font color="#E5E5E5"> when they are less when</font>

789
00:34:02,370 --> 00:34:07,199
they are less<font color="#CCCCCC"> ugly</font><font color="#E5E5E5"> I will be definitely</font>

790
00:34:04,500 --> 00:34:09,239
<font color="#E5E5E5">publishing all of the automatic malware</font>

791
00:34:07,200 --> 00:34:11,909
runs and the<font color="#CCCCCC"> the gifts generated by them</font>

792
00:34:09,239 --> 00:34:13,409
<font color="#E5E5E5">so that people</font><font color="#CCCCCC"> can easily effects based</font>

793
00:34:11,909 --> 00:34:15,178
<font color="#CCCCCC">google for the virus names and get</font><font color="#E5E5E5"> like</font>

794
00:34:13,409 --> 00:34:17,279
actual<font color="#CCCCCC"> real-time versions</font><font color="#E5E5E5"> the hardest</font>

795
00:34:15,179 --> 00:34:19,350
thing that<font color="#CCCCCC"> I found is when</font><font color="#E5E5E5"> looking at</font>

796
00:34:17,280 --> 00:34:21,570
virus names was literally<font color="#E5E5E5"> just finding</font>

797
00:34:19,350 --> 00:34:22,889
any information about them<font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of</font>

798
00:34:21,570 --> 00:34:25,169
the things I really wish existed<font color="#CCCCCC"> at the</font>

799
00:34:22,889 --> 00:34:26,940
<font color="#CCCCCC">time</font><font color="#E5E5E5"> of writing this talk was being able</font>

800
00:34:25,168 --> 00:34:29,750
to<font color="#E5E5E5"> just query a</font><font color="#CCCCCC"> name and be like oh yeah</font>

801
00:34:26,940 --> 00:34:32,310
this virus it looks like it does<font color="#E5E5E5"> this</font>

802
00:34:29,750 --> 00:34:35,699
<font color="#E5E5E5">since I saw a microphone one first and</font>

803
00:34:32,310 --> 00:34:38,009
it<font color="#E5E5E5"> was</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> with that</font><font color="#CCCCCC"> did you find any</font>

804
00:34:35,699 --> 00:34:40,799
viruses that<font color="#E5E5E5"> had signage in them not</font>

805
00:34:38,010 --> 00:34:42,929
funny stuff today but the name of the

806
00:34:40,800 --> 00:34:45,540
author<font color="#E5E5E5"> like was very proud</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> what he</font>

807
00:34:42,929 --> 00:34:47,639
wrote<font color="#E5E5E5"> yeah there's some notable examples</font>

808
00:34:45,540 --> 00:34:50,000
<font color="#CCCCCC">quite a few</font><font color="#E5E5E5"> of them we'll try and name</font>

809
00:34:47,639 --> 00:34:52,109
so Joseph<font color="#CCCCCC"> viruses dude like have</font>

810
00:34:50,000 --> 00:34:54,659
obviously sample names in the same way

811
00:34:52,110 --> 00:34:57,060
that you know we'd still today like give

812
00:34:54,659 --> 00:34:59,069
viruses names all the<font color="#E5E5E5"> time you will</font><font color="#CCCCCC"> just</font>

813
00:34:57,060 --> 00:35:00,840
encode<font color="#CCCCCC"> a string that you want the virus</font>

814
00:34:59,070 --> 00:35:02,460
to be<font color="#E5E5E5"> named</font><font color="#CCCCCC"> it's you know somewhere</font><font color="#E5E5E5"> in</font>

815
00:35:00,840 --> 00:35:04,230
the file<font color="#CCCCCC"> just a random string doing</font>

816
00:35:02,460 --> 00:35:07,680
nothing it's like<font color="#CCCCCC"> okay they clearly</font>

817
00:35:04,230 --> 00:35:09,660
wanted to be called<font color="#CCCCCC"> tempest so that does</font>

818
00:35:07,680 --> 00:35:12,480
happen<font color="#CCCCCC"> one of the favorite examples is</font>

819
00:35:09,660 --> 00:35:14,879
<font color="#CCCCCC">the brain malware which literally</font>

820
00:35:12,480 --> 00:35:15,870
encodes an address and phone number<font color="#E5E5E5"> of</font>

821
00:35:14,880 --> 00:35:18,960
the author

822
00:35:15,870 --> 00:35:21,350
<font color="#CCCCCC">I believe in Pakistan and there's a</font>

823
00:35:18,960 --> 00:35:23,520
fantastic<font color="#E5E5E5"> mini documentary by f-secure</font>

824
00:35:21,350 --> 00:35:24,470
<font color="#CCCCCC">where they go and</font><font color="#E5E5E5"> visit the people who</font>

825
00:35:23,520 --> 00:35:25,849
wrote it it's a

826
00:35:24,470 --> 00:35:32,149
for interesting watch and I would really

827
00:35:25,849 --> 00:35:34,160
<font color="#E5E5E5">recommend it indeed yes</font><font color="#CCCCCC"> microphone</font><font color="#E5E5E5"> - do</font>

828
00:35:32,150 --> 00:35:37,099
you have any chance to<font color="#CCCCCC"> look at any kind</font>

829
00:35:34,160 --> 00:35:39,920
of viruses<font color="#E5E5E5"> that did not modify the file</font>

830
00:35:37,099 --> 00:35:42,590
files<font color="#CCCCCC"> themselves</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the</font>

831
00:35:39,920 --> 00:35:45,530
largest virus infection<font color="#CCCCCC"> I</font><font color="#E5E5E5"> am was a virus</font>

832
00:35:42,590 --> 00:35:49,369
called niemelä which modified the Master

833
00:35:45,530 --> 00:35:51,080
Boot Record<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> master bee record</font><font color="#E5E5E5"> I did</font>

834
00:35:49,369 --> 00:35:53,240
<font color="#E5E5E5">consider it was more of a time</font><font color="#CCCCCC"> problem</font>

835
00:35:51,080 --> 00:35:55,250
that I had in that<font color="#E5E5E5"> getting to the point</font>

836
00:35:53,240 --> 00:35:57,830
<font color="#E5E5E5">where</font><font color="#CCCCCC"> you could brute force</font><font color="#E5E5E5"> time and</font>

837
00:35:55,250 --> 00:36:00,260
date combinations and looking for<font color="#E5E5E5"> Master</font>

838
00:35:57,830 --> 00:36:02,509
Boot Record<font color="#E5E5E5"> changes</font><font color="#CCCCCC"> I was really hard</font>

839
00:36:00,260 --> 00:36:05,780
I am super interested in reviewing

840
00:36:02,510 --> 00:36:07,190
<font color="#E5E5E5">effectively the root kits of the era but</font>

841
00:36:05,780 --> 00:36:13,099
<font color="#CCCCCC">yes</font><font color="#E5E5E5"> that's definitely something I will</font>

842
00:36:07,190 --> 00:36:15,680
look into<font color="#E5E5E5"> in the future and we have yet</font>

843
00:36:13,099 --> 00:36:20,440
<font color="#CCCCCC">another question</font><font color="#E5E5E5"> from the</font><font color="#CCCCCC"> internet it's</font>

844
00:36:15,680 --> 00:36:23,990
even<font color="#E5E5E5"> from the same guy oh and it's the</font>

845
00:36:20,440 --> 00:36:26,510
<font color="#E5E5E5">x86 software open source or can it</font><font color="#CCCCCC"> be</font>

846
00:36:23,990 --> 00:36:27,259
found on the web somewhere<font color="#E5E5E5"> it probably</font>

847
00:36:26,510 --> 00:36:29,270
will be

848
00:36:27,260 --> 00:36:32,300
I wouldn't expect<font color="#E5E5E5"> it to work in well in</font>

849
00:36:29,270 --> 00:36:33,980
any use case though it's it's

850
00:36:32,300 --> 00:36:36,140
effectively designed to like not work

851
00:36:33,980 --> 00:36:37,849
<font color="#E5E5E5">correctly right like you</font><font color="#CCCCCC"> know what's</font><font color="#E5E5E5"> the</font>

852
00:36:36,140 --> 00:36:40,549
what was the spec<font color="#E5E5E5"> it basically like</font>

853
00:36:37,849 --> 00:36:42,050
fails at every single anything<font color="#CCCCCC"> awkward I</font>

854
00:36:40,550 --> 00:36:44,770
just went<font color="#E5E5E5"> like</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> that's fine</font><font color="#CCCCCC"> we're</font>

855
00:36:42,050 --> 00:36:47,150
probably<font color="#E5E5E5"> far</font><font color="#CCCCCC"> enough down</font><font color="#E5E5E5"> there anyway</font>

856
00:36:44,770 --> 00:36:50,599
<font color="#E5E5E5">yeah like be aware this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the feature</font>

857
00:36:47,150 --> 00:36:53,300
list so is<font color="#E5E5E5"> that a follow-up question</font>

858
00:36:50,599 --> 00:36:53,720
<font color="#CCCCCC">from the internet and no it's a</font><font color="#E5E5E5"> new</font>

859
00:36:53,300 --> 00:36:57,230
world

860
00:36:53,720 --> 00:37:02,060
I heard anyone good<font color="#CCCCCC"> with</font><font color="#E5E5E5"> know how</font>

861
00:36:57,230 --> 00:37:04,869
serious is this butt or a good idea to

862
00:37:02,060 --> 00:37:09,520
use machine learn to create new<font color="#E5E5E5"> and</font>

863
00:37:04,869 --> 00:37:09,520
<font color="#CCCCCC">malware from</font><font color="#E5E5E5"> the existing samples</font>

864
00:37:14,780 --> 00:37:23,910
it would not<font color="#CCCCCC"> be a</font><font color="#E5E5E5"> good idea but I like</font>

865
00:37:17,280 --> 00:37:26,850
how you think actually I saw<font color="#E5E5E5"> somebody</font>

866
00:37:23,910 --> 00:37:28,920
trying<font color="#E5E5E5"> to use NLP to generate viruses</font>

867
00:37:26,850 --> 00:37:31,710
but<font color="#E5E5E5"> okay you could probably do Markov</font>

868
00:37:28,920 --> 00:37:34,770
chains of x86 to be honest<font color="#E5E5E5"> please don't</font>

869
00:37:31,710 --> 00:37:36,030
do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> please don't try this at</font><font color="#CCCCCC"> high I</font>

870
00:37:34,770 --> 00:37:39,330
have seen things I have seen<font color="#CCCCCC"> just</font>

871
00:37:36,030 --> 00:37:42,780
<font color="#E5E5E5">pleased I do that so I think we've run</font>

872
00:37:39,330 --> 00:37:44,930
out of<font color="#CCCCCC"> questions going once going twice</font>

873
00:37:42,780 --> 00:37:46,210
<font color="#CCCCCC">let's thank Ben for this marvelous</font>

874
00:37:44,930 --> 00:37:47,270
retrospective

875
00:37:46,210 --> 00:38:13,780
[Applause]

876
00:37:47,270 --> 00:38:13,780
[Music]

