1
00:00:02,830 --> 00:00:27,119
[Music]

2
00:00:19,220 --> 00:00:31,850
so<font color="#CCCCCC"> Janice</font><font color="#E5E5E5"> biomass is a software engineer</font>

3
00:00:27,119 --> 00:00:34,140
and he started tinkering with<font color="#E5E5E5"> Commodore</font>

4
00:00:31,850 --> 00:00:37,170
<font color="#CCCCCC">64 when he was</font><font color="#E5E5E5"> 8 years old</font>

5
00:00:34,140 --> 00:00:39,450
<font color="#E5E5E5">and he</font><font color="#CCCCCC"> was kind of a teenage hacker of</font>

6
00:00:37,170 --> 00:00:42,300
<font color="#E5E5E5">games as well and now he's in the</font>

7
00:00:39,450 --> 00:00:46,320
security field<font color="#CCCCCC"> and he got interested</font><font color="#E5E5E5"> in</font>

8
00:00:42,300 --> 00:00:49,589
the fax machine together<font color="#CCCCCC"> with his friend</font>

9
00:00:46,320 --> 00:00:52,770
<font color="#E5E5E5">al it kin who is also a security guy and</font>

10
00:00:49,590 --> 00:00:55,800
<font color="#E5E5E5">malware researcher and together they're</font>

11
00:00:52,770 --> 00:00:59,219
gonna tell<font color="#E5E5E5"> us about the fax machines and</font>

12
00:00:55,800 --> 00:01:01,680
what the facts were still using<font color="#E5E5E5"> people</font>

13
00:00:59,219 --> 00:01:04,979
those machines<font color="#E5E5E5"> and it's gonna be really</font>

14
00:01:01,680 --> 00:01:07,530
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> and the title is</font>

15
00:01:04,979 --> 00:01:09,720
<font color="#E5E5E5">also hacking your network like it's 1980</font>

16
00:01:07,530 --> 00:01:12,220
again<font color="#E5E5E5"> and really excited please give a</font>

17
00:01:09,720 --> 00:01:19,930
warm<font color="#E5E5E5"> round of applause to those two guys</font>

18
00:01:12,220 --> 00:01:19,929
[Applause]

19
00:01:30,520 --> 00:01:36,410
thank you thank<font color="#CCCCCC"> you guys</font>

20
00:01:32,600 --> 00:01:40,399
hi<font color="#E5E5E5"> CCC</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> probably know this sound</font>

21
00:01:36,410 --> 00:01:41,600
right<font color="#CCCCCC"> and now get to know us</font><font color="#E5E5E5"> so my name</font>

22
00:01:40,400 --> 00:01:44,240
<font color="#CCCCCC">is Jenny</font><font color="#E5E5E5"> Varmus I'm a security</font>

23
00:01:41,600 --> 00:01:48,110
<font color="#CCCCCC">researcher I walk a checkpoint research</font>

24
00:01:44,240 --> 00:01:49,789
and with me here<font color="#E5E5E5"> today is a</font><font color="#CCCCCC"> Aladin also</font>

25
00:01:48,110 --> 00:01:52,280
a security<font color="#CCCCCC"> researcher also it's a</font>

26
00:01:49,790 --> 00:01:54,710
checkpoint research and let's begin<font color="#E5E5E5"> with</font>

27
00:01:52,280 --> 00:01:57,259
talking<font color="#CCCCCC"> a bit about the history</font><font color="#E5E5E5"> of facts</font>

28
00:01:54,710 --> 00:01:59,750
<font color="#E5E5E5">so I guess that not many of you know</font>

29
00:01:57,259 --> 00:02:03,200
<font color="#CCCCCC">that stack started it was first</font><font color="#E5E5E5"> invented</font>

30
00:01:59,750 --> 00:02:06,229
in 1846<font color="#E5E5E5"> by</font><font color="#CCCCCC"> a scientist called</font><font color="#E5E5E5"> Alexander</font>

31
00:02:03,200 --> 00:02:07,820
<font color="#CCCCCC">Bane fun fact this was this happened 20</font>

32
00:02:06,229 --> 00:02:11,420
<font color="#CCCCCC">years before</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> invention of</font><font color="#E5E5E5"> the light</font>

33
00:02:07,820 --> 00:02:13,459
bulb<font color="#CCCCCC"> and then it had some more advances</font>

34
00:02:11,420 --> 00:02:14,988
<font color="#E5E5E5">to it this is</font><font color="#CCCCCC"> the actual first</font><font color="#E5E5E5"> thing</font>

35
00:02:13,459 --> 00:02:16,760
that looked like effects machine<font color="#E5E5E5"> like a</font>

36
00:02:14,989 --> 00:02:19,010
standard fax machine<font color="#E5E5E5"> and again this</font>

37
00:02:16,760 --> 00:02:20,149
<font color="#E5E5E5">thing was invented 20 years before</font><font color="#CCCCCC"> the</font>

38
00:02:19,010 --> 00:02:22,850
<font color="#CCCCCC">invention of</font><font color="#E5E5E5"> the telephone</font>

39
00:02:20,150 --> 00:02:24,739
<font color="#E5E5E5">so humanity was sending faxes before we</font>

40
00:02:22,850 --> 00:02:26,690
had light or talked over the<font color="#E5E5E5"> phone and</font>

41
00:02:24,739 --> 00:02:29,959
and then there was some more

42
00:02:26,690 --> 00:02:33,049
advancements like radio fax<font color="#E5E5E5"> and another</font>

43
00:02:29,959 --> 00:02:35,120
report<font color="#E5E5E5"> important point in time is 1966</font>

44
00:02:33,049 --> 00:02:38,480
were a small unknown<font color="#E5E5E5"> company called</font>

45
00:02:35,120 --> 00:02:40,040
Xerox<font color="#CCCCCC"> invented came out with the first</font>

46
00:02:38,480 --> 00:02:44,390
commercial fax machine<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the</font>

47
00:02:40,040 --> 00:02:47,450
advertisement<font color="#CCCCCC"> for it and in 1980</font><font color="#E5E5E5"> strange</font>

48
00:02:44,390 --> 00:02:50,000
organization called ITU defined the

49
00:02:47,450 --> 00:02:54,619
current standards for fax<font color="#E5E5E5"> name leads</font>

50
00:02:50,000 --> 00:02:56,750
<font color="#E5E5E5">teetered 84 86</font><font color="#CCCCCC"> and those standards are</font>

51
00:02:54,620 --> 00:02:59,269
still the<font color="#E5E5E5"> same standards that we use</font>

52
00:02:56,750 --> 00:03:03,200
today<font color="#E5E5E5"> basically with</font><font color="#CCCCCC"> just minor changes</font>

53
00:02:59,269 --> 00:03:05,870
<font color="#CCCCCC">to them</font><font color="#E5E5E5"> so this was all in the past but</font>

54
00:03:03,200 --> 00:03:08,720
what's happening today<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> today we</font>

55
00:03:05,870 --> 00:03:11,060
have far better ways<font color="#CCCCCC"> to send electronic</font>

56
00:03:08,720 --> 00:03:13,880
documents<font color="#E5E5E5"> from one to the other right</font>

57
00:03:11,060 --> 00:03:15,650
you know let's compare fax<font color="#E5E5E5"> to just I</font>

58
00:03:13,880 --> 00:03:18,310
<font color="#E5E5E5">don't know off the top of my head</font><font color="#CCCCCC"> just</font>

59
00:03:15,650 --> 00:03:21,950
you know one method like let's say email

60
00:03:18,310 --> 00:03:26,299
<font color="#E5E5E5">and just</font><font color="#CCCCCC"> to you know remind you we are</font>

61
00:03:21,950 --> 00:03:28,190
comparing this to<font color="#CCCCCC"> this okay so let's</font>

62
00:03:26,299 --> 00:03:32,750
<font color="#E5E5E5">look at some of the features here in</font>

63
00:03:28,190 --> 00:03:34,260
terms<font color="#E5E5E5"> of quality yeah okay</font><font color="#CCCCCC"> in terms of</font>

64
00:03:32,750 --> 00:03:36,060
accessibility<font color="#CCCCCC"> I'm</font>

65
00:03:34,260 --> 00:03:39,328
be sure<font color="#CCCCCC"> that all of</font><font color="#E5E5E5"> you here</font><font color="#CCCCCC"> you here</font>

66
00:03:36,060 --> 00:03:41,340
have<font color="#E5E5E5"> 24 by 7 access</font><font color="#CCCCCC"> to emails</font><font color="#E5E5E5"> not so</font>

67
00:03:39,329 --> 00:03:43,620
<font color="#E5E5E5">sure you're carrying</font><font color="#CCCCCC"> around your fax</font>

68
00:03:41,340 --> 00:03:47,459
machines with you<font color="#CCCCCC"> in</font><font color="#E5E5E5"> terms of</font>

69
00:03:43,620 --> 00:03:48,840
reliability<font color="#CCCCCC"> well you know when you send</font>

70
00:03:47,459 --> 00:03:50,900
a fax you don't<font color="#E5E5E5"> really know if it got</font>

71
00:03:48,840 --> 00:03:53,430
received or not<font color="#CCCCCC"> yes there is this</font>

72
00:03:50,900 --> 00:03:54,959
strange confirmation page but it doesn't

73
00:03:53,430 --> 00:03:57,180
really<font color="#E5E5E5"> mean anything</font><font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> if there's</font>

74
00:03:54,959 --> 00:04:00,870
no paper<font color="#CCCCCC"> in the receiving fax</font><font color="#E5E5E5"> you still</font>

75
00:03:57,180 --> 00:04:02,489
get it<font color="#E5E5E5"> if the dog</font><font color="#CCCCCC"> ate</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> date</font><font color="#E5E5E5"> you still</font>

76
00:04:00,870 --> 00:04:06,750
get it so there's absolutely<font color="#E5E5E5"> no</font>

77
00:04:02,489 --> 00:04:08,700
reliability<font color="#CCCCCC"> in facts and regarding</font>

78
00:04:06,750 --> 00:04:10,950
authenticity well we can argue<font color="#E5E5E5"> about</font>

79
00:04:08,700 --> 00:04:13,078
emails if it's authenticated<font color="#E5E5E5"> or not it</font>

80
00:04:10,950 --> 00:04:15,030
could<font color="#E5E5E5"> be forged of course but we do have</font>

81
00:04:13,079 --> 00:04:17,070
<font color="#CCCCCC">public key crypto cryptography and</font><font color="#E5E5E5"> stuff</font>

82
00:04:15,030 --> 00:04:19,440
<font color="#E5E5E5">like that that will help us when talking</font>

83
00:04:17,070 --> 00:04:21,418
<font color="#CCCCCC">about emails what we don't</font><font color="#E5E5E5"> have we</font><font color="#CCCCCC"> don't</font>

84
00:04:19,440 --> 00:04:24,389
have<font color="#E5E5E5"> nothing when it comes to fax</font>

85
00:04:21,418 --> 00:04:26,430
absolutely no authenticity<font color="#CCCCCC"> so if we're</font>

86
00:04:24,389 --> 00:04:29,400
<font color="#CCCCCC">looking</font><font color="#E5E5E5"> at this table</font><font color="#CCCCCC"> one might think to</font>

87
00:04:26,430 --> 00:04:31,949
himself<font color="#CCCCCC"> okay so who the hell</font><font color="#E5E5E5"> still</font><font color="#CCCCCC"> use</font>

88
00:04:29,400 --> 00:04:34,560
<font color="#CCCCCC">this fax today it's 2018</font><font color="#E5E5E5"> I mean it</font>

89
00:04:31,949 --> 00:04:36,810
deserves a place in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Museum of great</font>

90
00:04:34,560 --> 00:04:39,810
technologies and that's it

91
00:04:36,810 --> 00:04:44,190
so nobody is using<font color="#E5E5E5"> fax</font><font color="#CCCCCC"> today right yeah</font>

92
00:04:39,810 --> 00:04:46,590
<font color="#E5E5E5">wrong everybody are using fax today</font><font color="#CCCCCC"> and</font>

93
00:04:44,190 --> 00:04:50,550
and you see<font color="#E5E5E5"> fax is used like to</font><font color="#CCCCCC"> send</font>

94
00:04:46,590 --> 00:04:54,750
<font color="#E5E5E5">this very critical</font><font color="#CCCCCC"> maritime maps to see</font>

95
00:04:50,550 --> 00:04:56,580
ships<font color="#E5E5E5"> that open seas</font><font color="#CCCCCC"> 90% of the</font><font color="#E5E5E5"> Japanese</font>

96
00:04:54,750 --> 00:04:59,820
<font color="#CCCCCC">population uses fax according to</font>

97
00:04:56,580 --> 00:05:02,099
Wikipedia at least and if you<font color="#E5E5E5"> google any</font>

98
00:04:59,820 --> 00:05:04,020
kind<font color="#E5E5E5"> of combos like contact us and</font><font color="#CCCCCC"> facts</font>

99
00:05:02,099 --> 00:05:07,919
<font color="#E5E5E5">or stuff</font><font color="#CCCCCC"> like that</font><font color="#E5E5E5"> you will come up with</font>

100
00:05:04,020 --> 00:05:10,169
something like 300 million results<font color="#E5E5E5"> 300</font>

101
00:05:07,919 --> 00:05:11,880
million published fax numbers in<font color="#E5E5E5"> Google</font>

102
00:05:10,169 --> 00:05:13,948
and that's<font color="#E5E5E5"> not counting the unpublished</font>

103
00:05:11,880 --> 00:05:16,919
<font color="#E5E5E5">numbers right that's a huge amount of</font>

104
00:05:13,949 --> 00:05:18,750
numbers<font color="#E5E5E5"> but it's not all about numbers I</font>

105
00:05:16,919 --> 00:05:21,510
mean<font color="#E5E5E5"> it's not how many fax machines are</font>

106
00:05:18,750 --> 00:05:23,820
<font color="#CCCCCC">out there but it's also who is</font><font color="#E5E5E5"> using fax</font>

107
00:05:21,510 --> 00:05:26,159
you see<font color="#E5E5E5"> if you're a small cooperate and</font>

108
00:05:23,820 --> 00:05:28,650
medium cooperate<font color="#CCCCCC"> a huge cooperate you</font>

109
00:05:26,159 --> 00:05:30,389
have fax<font color="#E5E5E5"> not necessarily anybody is</font>

110
00:05:28,650 --> 00:05:32,190
sending fax to this<font color="#E5E5E5"> number but there is</font>

111
00:05:30,389 --> 00:05:35,280
a fax machine sitting<font color="#E5E5E5"> there waiting to</font>

112
00:05:32,190 --> 00:05:39,360
for effects to<font color="#E5E5E5"> be received</font><font color="#CCCCCC"> if you're a</font>

113
00:05:35,280 --> 00:05:41,250
bank<font color="#E5E5E5"> you simply love faxes this is Bank</font>

114
00:05:39,360 --> 00:05:43,289
of China the biggest<font color="#CCCCCC"> banker of</font><font color="#E5E5E5"> the world</font>

115
00:05:41,250 --> 00:05:46,469
in the<font color="#E5E5E5"> world and that's the fax number</font>

116
00:05:43,289 --> 00:05:47,960
of it<font color="#E5E5E5"> and I think most importantly if</font>

117
00:05:46,469 --> 00:05:50,780
you're a government

118
00:05:47,960 --> 00:05:52,909
you simply wake up in the morning and

119
00:05:50,780 --> 00:05:55,549
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want to have</font><font color="#E5E5E5"> more facts so this is</font>

120
00:05:52,910 --> 00:05:57,590
Donald Trump's<font color="#E5E5E5"> fax number if anybody</font>

121
00:05:55,550 --> 00:06:00,650
wants to<font color="#E5E5E5"> send in the fax go ahead that's</font>

122
00:05:57,590 --> 00:06:02,750
<font color="#E5E5E5">it it's not a secret it's from Google so</font>

123
00:06:00,650 --> 00:06:05,989
we<font color="#CCCCCC"> should</font><font color="#E5E5E5"> send him something</font><font color="#CCCCCC"> by the way</font>

124
00:06:02,750 --> 00:06:07,870
<font color="#CCCCCC">yeah so yeah</font><font color="#E5E5E5"> and the thing is that</font><font color="#CCCCCC"> you</font>

125
00:06:05,990 --> 00:06:11,509
know<font color="#E5E5E5"> those banks and government</font>

126
00:06:07,870 --> 00:06:13,699
<font color="#E5E5E5">institutions they don't only support</font><font color="#CCCCCC"> Fox</font>

127
00:06:11,509 --> 00:06:15,590
<font color="#E5E5E5">allow you to send fax the funny thing</font><font color="#CCCCCC"> is</font>

128
00:06:13,699 --> 00:06:17,870
that<font color="#E5E5E5"> actually most of the time it's</font>

129
00:06:15,590 --> 00:06:19,758
mandatory to<font color="#E5E5E5"> send fax there is no other</font>

130
00:06:17,870 --> 00:06:22,190
way<font color="#CCCCCC"> you can either post I'll mail it or</font>

131
00:06:19,759 --> 00:06:24,650
fax it<font color="#CCCCCC"> they didn't hear</font><font color="#E5E5E5"> about anything</font>

132
00:06:22,190 --> 00:06:26,960
else so we<font color="#CCCCCC"> looked at</font><font color="#E5E5E5"> this state of</font>

133
00:06:24,650 --> 00:06:29,419
<font color="#E5E5E5">affairs</font><font color="#CCCCCC"> strange state of</font><font color="#E5E5E5"> affairs and set</font>

134
00:06:26,960 --> 00:06:31,969
ourselves<font color="#CCCCCC"> you know this looks strange</font><font color="#E5E5E5"> I</font>

135
00:06:29,419 --> 00:06:34,280
mean it can it can<font color="#CCCCCC"> be</font><font color="#E5E5E5"> true</font><font color="#CCCCCC"> the humanity</font>

136
00:06:31,970 --> 00:06:37,639
came so far and we are<font color="#CCCCCC"> still</font><font color="#E5E5E5"> using these</font>

137
00:06:34,280 --> 00:06:40,489
<font color="#E5E5E5">old technologies so what the facts and</font>

138
00:06:37,639 --> 00:06:43,220
like we decided to try and<font color="#CCCCCC"> do something</font>

139
00:06:40,490 --> 00:06:47,030
<font color="#E5E5E5">about it and we started a very long</font>

140
00:06:43,220 --> 00:06:50,090
research to try and find some security

141
00:06:47,030 --> 00:06:53,090
vulnerabilities in<font color="#CCCCCC"> fact and before we do</font>

142
00:06:50,090 --> 00:06:56,388
that let me<font color="#E5E5E5"> just you need to explain</font><font color="#CCCCCC"> how</font>

143
00:06:53,090 --> 00:06:58,489
fax looks like today<font color="#CCCCCC"> you see today if X</font>

144
00:06:56,389 --> 00:07:01,010
doesn't<font color="#E5E5E5"> look like it looked</font><font color="#CCCCCC"> 20 or 30</font>

145
00:06:58,490 --> 00:07:02,180
<font color="#E5E5E5">years ago</font><font color="#CCCCCC"> then it was just standalone</font>

146
00:07:01,010 --> 00:07:05,840
fax machines<font color="#E5E5E5"> right</font>

147
00:07:02,180 --> 00:07:08,449
today<font color="#E5E5E5"> fax is mostly all technology</font>

148
00:07:05,840 --> 00:07:11,299
<font color="#E5E5E5">embedded within newer technologies so I</font>

149
00:07:08,449 --> 00:07:15,139
mean we have fax to email services or

150
00:07:11,300 --> 00:07:17,750
email to fax services<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have like as I</font>

151
00:07:15,139 --> 00:07:20,060
<font color="#E5E5E5">said before radio facts and facts over</font>

152
00:07:17,750 --> 00:07:23,030
<font color="#E5E5E5">satellite and stuff like that and I</font>

153
00:07:20,060 --> 00:07:26,030
think most commonly we have<font color="#CCCCCC"> these</font><font color="#E5E5E5"> these</font>

154
00:07:23,030 --> 00:07:28,580
machines<font color="#CCCCCC"> all-in-one printers like you</font>

155
00:07:26,030 --> 00:07:31,039
buy them they scan the<font color="#E5E5E5"> print and they</font>

156
00:07:28,580 --> 00:07:32,930
fax it actually comes with a phone cable

157
00:07:31,039 --> 00:07:36,169
out of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> box so you can connect I</font>

158
00:07:32,930 --> 00:07:37,550
guess most people connected<font color="#E5E5E5"> and I also</font>

159
00:07:36,169 --> 00:07:40,130
think<font color="#CCCCCC"> that</font><font color="#E5E5E5"> this is the most common</font>

160
00:07:37,550 --> 00:07:42,710
faxing solution today<font color="#E5E5E5"> so we decided to</font>

161
00:07:40,130 --> 00:07:46,750
<font color="#E5E5E5">take a look at these machines these fax</font>

162
00:07:42,710 --> 00:07:49,940
machines<font color="#E5E5E5"> and if you look at these boxes</font>

163
00:07:46,750 --> 00:07:51,470
<font color="#CCCCCC">from a</font><font color="#E5E5E5"> security point of</font><font color="#CCCCCC"> view</font><font color="#E5E5E5"> you can</font>

164
00:07:49,940 --> 00:07:53,000
imagine them to<font color="#CCCCCC"> be just black boxes</font>

165
00:07:51,470 --> 00:07:55,820
right and those black boxes has

166
00:07:53,000 --> 00:07:57,490
interfaces so in one side of<font color="#CCCCCC"> the box we</font>

167
00:07:55,820 --> 00:07:59,870
have interfaces<font color="#E5E5E5"> like Wi-Fi Bluetooth</font>

168
00:07:57,490 --> 00:08:01,400
<font color="#E5E5E5">internet stuff like that these</font>

169
00:07:59,870 --> 00:08:03,620
interfaces connects the

170
00:08:01,400 --> 00:08:05,448
printer<font color="#E5E5E5"> to the internal</font><font color="#CCCCCC"> network the</font>

171
00:08:03,620 --> 00:08:07,880
external<font color="#E5E5E5"> network basically it connected</font>

172
00:08:05,449 --> 00:08:09,440
<font color="#E5E5E5">to the world right and on the other side</font>

173
00:08:07,880 --> 00:08:12,680
<font color="#CCCCCC">of this box there's this little</font>

174
00:08:09,440 --> 00:08:16,190
interface<font color="#E5E5E5"> here that connects the this</font>

175
00:08:12,680 --> 00:08:19,789
black box to somewhere to<font color="#CCCCCC"> the 1970s</font><font color="#E5E5E5"> I</font>

176
00:08:16,190 --> 00:08:21,680
would say so<font color="#CCCCCC"> yeah that</font><font color="#E5E5E5"> that's pretty</font>

177
00:08:19,789 --> 00:08:24,409
funny<font color="#E5E5E5"> and and you know if you remember</font>

178
00:08:21,680 --> 00:08:26,479
<font color="#CCCCCC">that</font><font color="#E5E5E5"> at the end</font><font color="#CCCCCC"> the end of the day</font><font color="#E5E5E5"> these</font>

179
00:08:24,410 --> 00:08:28,759
printers<font color="#CCCCCC"> are basically nothing but</font>

180
00:08:26,479 --> 00:08:30,469
computers I mean they have CPUs they

181
00:08:28,759 --> 00:08:32,630
have memories<font color="#E5E5E5"> they have operating</font>

182
00:08:30,470 --> 00:08:35,120
systems there<font color="#CCCCCC"> are computers</font><font color="#E5E5E5"> not standard</font>

183
00:08:32,630 --> 00:08:37,250
ones but they are computers and we were

184
00:08:35,120 --> 00:08:38,659
<font color="#E5E5E5">thinking to ourselves</font><font color="#CCCCCC"> imagine this</font>

185
00:08:37,250 --> 00:08:41,419
<font color="#E5E5E5">scenario right there's an attacker</font>

186
00:08:38,659 --> 00:08:44,779
sitting somewhere<font color="#CCCCCC"> in the world all he</font>

187
00:08:41,419 --> 00:08:47,360
has<font color="#E5E5E5"> is access</font><font color="#CCCCCC"> to a phone line and his</font>

188
00:08:44,779 --> 00:08:49,910
targets fax number what will happen if

189
00:08:47,360 --> 00:08:52,970
this attacker this guy would be<font color="#CCCCCC"> able to</font>

190
00:08:49,910 --> 00:08:54,770
send<font color="#E5E5E5"> a malicious fax and with this</font>

191
00:08:52,970 --> 00:08:57,200
malicious fax he will be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> exploit</font>

192
00:08:54,770 --> 00:08:59,120
the printer<font color="#E5E5E5"> then he's completely as</font>

193
00:08:57,200 --> 00:09:02,390
complete control over the printer right

194
00:08:59,120 --> 00:09:04,790
if<font color="#E5E5E5"> it does</font><font color="#CCCCCC"> that he could then maybe</font>

195
00:09:02,390 --> 00:09:06,670
pivot<font color="#E5E5E5"> through any one of those other</font>

196
00:09:04,790 --> 00:09:09,920
interfaces let's say the<font color="#E5E5E5"> internet and</font>

197
00:09:06,670 --> 00:09:11,920
<font color="#E5E5E5">jump from this printer</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> rest of</font>

198
00:09:09,920 --> 00:09:14,120
<font color="#E5E5E5">the network</font><font color="#CCCCCC"> that the internal network</font>

199
00:09:11,920 --> 00:09:15,800
<font color="#E5E5E5">effectively creating like a bridge</font>

200
00:09:14,120 --> 00:09:18,260
between<font color="#CCCCCC"> the</font><font color="#E5E5E5"> external world in the</font>

201
00:09:15,800 --> 00:09:21,589
internal network through the phone line

202
00:09:18,260 --> 00:09:23,720
that's<font color="#E5E5E5"> 1980s</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> game so we thought</font><font color="#CCCCCC"> that</font>

203
00:09:21,589 --> 00:09:26,930
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> a really cool at attack scenario</font>

204
00:09:23,720 --> 00:09:29,480
and we decided<font color="#E5E5E5"> to accept this</font><font color="#CCCCCC"> challenge</font>

205
00:09:26,930 --> 00:09:33,079
<font color="#E5E5E5">and go for it</font><font color="#CCCCCC"> and try</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> actually show</font>

206
00:09:29,480 --> 00:09:35,029
<font color="#E5E5E5">this thing happening in</font><font color="#CCCCCC"> reality we were</font>

207
00:09:33,080 --> 00:09:38,330
really<font color="#CCCCCC"> excited</font><font color="#E5E5E5"> about this but then after</font>

208
00:09:35,029 --> 00:09:40,790
we slept a bit<font color="#E5E5E5"> and drank a bit and sat</font>

209
00:09:38,330 --> 00:09:43,220
down<font color="#E5E5E5"> and talked about it we kind of</font>

210
00:09:40,790 --> 00:09:44,930
<font color="#E5E5E5">found out that there is like a lot</font><font color="#CCCCCC"> of</font>

211
00:09:43,220 --> 00:09:47,330
<font color="#E5E5E5">challenges really hard challenges in</font>

212
00:09:44,930 --> 00:09:49,430
<font color="#E5E5E5">front of us and it's we're not really</font>

213
00:09:47,330 --> 00:09:53,270
<font color="#E5E5E5">sure how to deal</font><font color="#CCCCCC"> with them</font><font color="#E5E5E5"> let me</font><font color="#CCCCCC"> name</font>

214
00:09:49,430 --> 00:09:55,160
just just a few<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> so one of the</font>

215
00:09:53,270 --> 00:09:57,319
challenges<font color="#CCCCCC"> is how do</font><font color="#E5E5E5"> we obtain the</font><font color="#CCCCCC"> fewer</font>

216
00:09:55,160 --> 00:09:59,810
the code that this printer runs it's not

217
00:09:57,320 --> 00:10:01,900
like you have it everywhere<font color="#CCCCCC"> and after we</font>

218
00:09:59,810 --> 00:10:03,979
get it how do we<font color="#E5E5E5"> analyze this framework</font>

219
00:10:01,900 --> 00:10:06,170
<font color="#E5E5E5">have to analyze that we need to</font>

220
00:10:03,980 --> 00:10:08,630
understand what<font color="#E5E5E5"> operating</font><font color="#CCCCCC"> systems are</font>

221
00:10:06,170 --> 00:10:10,040
those printers running and then<font color="#E5E5E5"> we need</font>

222
00:10:08,630 --> 00:10:11,630
<font color="#E5E5E5">to understand how to debug a</font><font color="#CCCCCC"> brick I</font>

223
00:10:10,040 --> 00:10:12,829
never debug the printer before<font color="#E5E5E5"> and I</font>

224
00:10:11,630 --> 00:10:14,010
need to understand<font color="#E5E5E5"> how to debug a</font>

225
00:10:12,829 --> 00:10:16,020
printer and after

226
00:10:14,010 --> 00:10:19,050
we do all that<font color="#E5E5E5"> we need to understand how</font>

227
00:10:16,020 --> 00:10:21,240
<font color="#CCCCCC">does</font><font color="#E5E5E5"> Fox even work</font><font color="#CCCCCC"> we only know the</font>

228
00:10:19,050 --> 00:10:24,750
beeping sounds like most of<font color="#E5E5E5"> us I think</font>

229
00:10:21,240 --> 00:10:25,920
<font color="#E5E5E5">and after we did all</font><font color="#CCCCCC"> that we can start</font>

230
00:10:24,750 --> 00:10:27,960
talking about<font color="#E5E5E5"> where can we find</font>

231
00:10:25,920 --> 00:10:31,050
vulnerabilities inside this big big big

232
00:10:27,960 --> 00:10:33,360
<font color="#CCCCCC">ecosystem and today we</font><font color="#E5E5E5"> will try</font><font color="#CCCCCC"> to take</font>

233
00:10:31,050 --> 00:10:35,400
you through<font color="#E5E5E5"> these challenges</font><font color="#CCCCCC"> one by</font><font color="#E5E5E5"> one</font>

234
00:10:33,360 --> 00:10:37,530
<font color="#E5E5E5">and explain how to do it and till we'll</font>

235
00:10:35,400 --> 00:10:39,780
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to actually do the thing that</font><font color="#CCCCCC"> we</font>

236
00:10:37,530 --> 00:10:42,720
<font color="#CCCCCC">just the</font><font color="#E5E5E5"> scenario that we just showed</font>

237
00:10:39,780 --> 00:10:45,150
<font color="#CCCCCC">you so let's start with</font><font color="#E5E5E5"> the first</font>

238
00:10:42,720 --> 00:10:50,910
challenge<font color="#CCCCCC"> how do we</font><font color="#E5E5E5"> obtain the fever for</font>

239
00:10:45,150 --> 00:10:53,459
the printer yeah so<font color="#E5E5E5"> meet our nice</font>

240
00:10:50,910 --> 00:10:56,579
printer<font color="#CCCCCC"> it's an HP printer</font><font color="#E5E5E5"> printer</font><font color="#CCCCCC"> and</font>

241
00:10:53,460 --> 00:10:59,190
<font color="#E5E5E5">an HP Officejet printer</font><font color="#CCCCCC"> we chose this</font>

242
00:10:56,580 --> 00:11:01,590
model for first<font color="#E5E5E5"> of all we chose HP</font>

243
00:10:59,190 --> 00:11:03,150
<font color="#E5E5E5">because it has like I think</font><font color="#CCCCCC"> 40% of the</font>

244
00:11:01,590 --> 00:11:05,730
market share<font color="#E5E5E5"> so it's not that we dislike</font>

245
00:11:03,150 --> 00:11:06,840
<font color="#E5E5E5">HP we really like them but</font><font color="#CCCCCC"> unfortunately</font>

246
00:11:05,730 --> 00:11:09,470
for<font color="#CCCCCC"> them they are just the biggest</font>

247
00:11:06,840 --> 00:11:11,700
<font color="#CCCCCC">target out there</font><font color="#E5E5E5"> and this specific model</font>

248
00:11:09,470 --> 00:11:14,550
<font color="#E5E5E5">well we have a lot</font><font color="#CCCCCC"> of reasons why we</font>

249
00:11:11,700 --> 00:11:19,710
<font color="#CCCCCC">chose</font><font color="#E5E5E5"> this printer but</font><font color="#CCCCCC"> basically it's</font>

250
00:11:14,550 --> 00:11:21,660
<font color="#E5E5E5">the cheapest one yes so</font><font color="#CCCCCC"> we bought that</font>

251
00:11:19,710 --> 00:11:23,210
<font color="#E5E5E5">we didn't have a lot of</font><font color="#CCCCCC"> budget we bought</font>

252
00:11:21,660 --> 00:11:27,390
it and we abused it for a lot<font color="#E5E5E5"> of time</font>

253
00:11:23,210 --> 00:11:29,910
<font color="#E5E5E5">and our goal</font><font color="#CCCCCC"> was to break the plain</font><font color="#E5E5E5"> the</font>

254
00:11:27,390 --> 00:11:32,400
<font color="#E5E5E5">break</font><font color="#CCCCCC"> facts right</font><font color="#E5E5E5"> but before we do that</font>

255
00:11:29,910 --> 00:11:36,510
we had to<font color="#E5E5E5"> break the printer and I mean</font>

256
00:11:32,400 --> 00:11:38,699
<font color="#E5E5E5">literally break the printer so yeah that</font>

257
00:11:36,510 --> 00:11:41,610
<font color="#E5E5E5">was</font><font color="#CCCCCC"> the fun part</font><font color="#E5E5E5"> of the project we broke</font>

258
00:11:38,700 --> 00:11:44,610
it<font color="#CCCCCC"> and inside the</font><font color="#E5E5E5"> printer we find this</font>

259
00:11:41,610 --> 00:11:46,440
<font color="#E5E5E5">thing the main PCB</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> brains behind the</font>

260
00:11:44,610 --> 00:11:49,950
printer and it looks<font color="#CCCCCC"> like this let's</font>

261
00:11:46,440 --> 00:11:53,010
<font color="#CCCCCC">snap the critical components</font><font color="#E5E5E5"> of it</font><font color="#CCCCCC"> so we</font>

262
00:11:49,950 --> 00:11:55,890
have here<font color="#E5E5E5"> a flash</font><font color="#CCCCCC"> romance pension some</font>

263
00:11:53,010 --> 00:11:58,770
model<font color="#E5E5E5"> and then we have some more memory</font>

264
00:11:55,890 --> 00:12:00,990
here this might<font color="#E5E5E5"> look like not a lot</font>

265
00:11:58,770 --> 00:12:03,960
because<font color="#E5E5E5"> the PCB has two sides to it</font>

266
00:12:00,990 --> 00:12:05,130
of course<font color="#CCCCCC"> and on the on the other side</font>

267
00:12:03,960 --> 00:12:07,530
of<font color="#CCCCCC"> it we have</font><font color="#E5E5E5"> the more interesting</font>

268
00:12:05,130 --> 00:12:10,110
components like<font color="#E5E5E5"> USB Wi-Fi electricity</font>

269
00:12:07,530 --> 00:12:11,699
SRAM battery<font color="#E5E5E5"> probably for the memory but</font>

270
00:12:10,110 --> 00:12:13,500
who knows

271
00:12:11,700 --> 00:12:16,020
and now we have two very interesting

272
00:12:13,500 --> 00:12:19,640
components here one of them is the main

273
00:12:16,020 --> 00:12:22,380
CPU<font color="#CCCCCC"> it's a Marvel CPU</font><font color="#E5E5E5"> and it's probably</font>

274
00:12:19,640 --> 00:12:24,180
<font color="#E5E5E5">manufactured for HP so we can't you know</font>

275
00:12:22,380 --> 00:12:27,210
<font color="#E5E5E5">tell anything about there's no available</font>

276
00:12:24,180 --> 00:12:30,209
specs nothing<font color="#E5E5E5"> we can just find bits of</font>

277
00:12:27,210 --> 00:12:34,320
information<font color="#E5E5E5"> here and there and then we</font>

278
00:12:30,210 --> 00:12:37,590
have<font color="#E5E5E5"> the fax modem it's located here</font><font color="#CCCCCC"> and</font>

279
00:12:34,320 --> 00:12:41,160
it's a<font color="#E5E5E5"> it's a CSP</font><font color="#CCCCCC"> 1040 and</font><font color="#E5E5E5"> what we need</font>

280
00:12:37,590 --> 00:12:43,050
<font color="#E5E5E5">to understand now is how does these two</font>

281
00:12:41,160 --> 00:12:44,880
components<font color="#CCCCCC"> operate and what is the</font>

282
00:12:43,050 --> 00:12:47,729
relationship<font color="#CCCCCC"> between them</font><font color="#E5E5E5"> if we do that</font>

283
00:12:44,880 --> 00:12:50,430
we one step further<font color="#CCCCCC"> so that's what we</font>

284
00:12:47,730 --> 00:12:52,080
try<font color="#E5E5E5"> to do and as I said the challenge is</font>

285
00:12:50,430 --> 00:12:54,510
to the first challenge<font color="#CCCCCC"> at least</font><font color="#E5E5E5"> is to</font>

286
00:12:52,080 --> 00:12:56,520
get the<font color="#CCCCCC"> femur of</font><font color="#E5E5E5"> this thing and when</font>

287
00:12:54,510 --> 00:12:59,250
we're<font color="#CCCCCC"> looking a bit closer</font><font color="#E5E5E5"> into this PCB</font>

288
00:12:56,520 --> 00:13:01,740
<font color="#CCCCCC">we find this</font><font color="#E5E5E5"> very -</font><font color="#CCCCCC"> very interesting</font>

289
00:12:59,250 --> 00:13:05,400
interfaces one<font color="#E5E5E5"> of them is a serial debug</font>

290
00:13:01,740 --> 00:13:06,960
the other is<font color="#CCCCCC"> JTAG so if</font><font color="#E5E5E5"> you familiar</font>

291
00:13:05,400 --> 00:13:09,510
<font color="#CCCCCC">with</font><font color="#E5E5E5"> them so you know that they give you</font>

292
00:13:06,960 --> 00:13:11,640
like<font color="#E5E5E5"> debugging capabilities or at least</font>

293
00:13:09,510 --> 00:13:13,290
memory read memory<font color="#E5E5E5"> right exactly what we</font>

294
00:13:11,640 --> 00:13:15,060
need to get the film<font color="#CCCCCC"> were</font><font color="#E5E5E5"> so we're</font>

295
00:13:13,290 --> 00:13:17,310
smiling<font color="#E5E5E5"> to</font><font color="#CCCCCC"> ourself</font><font color="#E5E5E5"> saying huh that's</font>

296
00:13:15,060 --> 00:13:19,650
gonna be really<font color="#E5E5E5"> easy but unfortunately</font>

297
00:13:17,310 --> 00:13:21,569
it's<font color="#E5E5E5"> not because the JTAG of course is</font>

298
00:13:19,650 --> 00:13:24,240
disabled completely we can do anything

299
00:13:21,570 --> 00:13:26,430
<font color="#E5E5E5">with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and the serial port</font><font color="#CCCCCC"> well we</font>

300
00:13:24,240 --> 00:13:29,490
managed to<font color="#E5E5E5"> connect to it and we get this</font>

301
00:13:26,430 --> 00:13:32,099
terminal that for<font color="#E5E5E5"> almost every</font>

302
00:13:29,490 --> 00:13:33,570
instruction<font color="#E5E5E5"> we type gives us this evil I</font>

303
00:13:32,100 --> 00:13:37,020
<font color="#CCCCCC">don't understand well we don't</font>

304
00:13:33,570 --> 00:13:39,900
understand either<font color="#CCCCCC"> but it looks like</font><font color="#E5E5E5"> this</font>

305
00:13:37,020 --> 00:13:41,939
<font color="#E5E5E5">terminal is not gonna get us very far</font><font color="#CCCCCC"> so</font>

306
00:13:39,900 --> 00:13:44,420
we<font color="#CCCCCC"> dropped this pet and and try and look</font>

307
00:13:41,940 --> 00:13:47,280
<font color="#CCCCCC">for other ways to get</font><font color="#E5E5E5"> the film work and</font>

308
00:13:44,420 --> 00:13:50,300
<font color="#E5E5E5">obviously one of the most common ways</font><font color="#CCCCCC"> is</font>

309
00:13:47,280 --> 00:13:53,370
<font color="#CCCCCC">to try and get grab the film or upgrade</font>

310
00:13:50,300 --> 00:13:57,420
and we<font color="#CCCCCC"> after looking</font><font color="#E5E5E5"> a bit in the inner</font>

311
00:13:53,370 --> 00:14:00,450
<font color="#CCCCCC">Internet we find</font><font color="#E5E5E5"> this jewel this FTP</font>

312
00:13:57,420 --> 00:14:02,849
site by HP that contains every finger

313
00:14:00,450 --> 00:14:05,850
version for every HP<font color="#E5E5E5"> product ever</font>

314
00:14:02,850 --> 00:14:08,250
produced in the history of HP<font color="#E5E5E5"> n and the</font>

315
00:14:05,850 --> 00:14:10,260
<font color="#E5E5E5">internet and a lot</font><font color="#CCCCCC"> of other stuff</font><font color="#E5E5E5"> and it</font>

316
00:14:08,250 --> 00:14:12,240
actually<font color="#E5E5E5"> took</font><font color="#CCCCCC"> us like about I think</font><font color="#E5E5E5"> two</font>

317
00:14:10,260 --> 00:14:18,689
<font color="#CCCCCC">weeks to find our theme</font><font color="#E5E5E5"> were within this</font>

318
00:14:12,240 --> 00:14:21,360
mess of<font color="#E5E5E5"> favors but once we did we had we</font>

319
00:14:18,690 --> 00:14:23,100
had a few<font color="#E5E5E5"> more upgrade file yes thank</font>

320
00:14:21,360 --> 00:14:24,780
you it's still alive so you<font color="#CCCCCC"> can go</font><font color="#E5E5E5"> there</font>

321
00:14:23,100 --> 00:14:27,150
look for<font color="#E5E5E5"> something there's a lot of</font>

322
00:14:24,780 --> 00:14:29,400
<font color="#E5E5E5">interesting stuff</font><font color="#CCCCCC"> in there and now</font><font color="#E5E5E5"> we</font>

323
00:14:27,150 --> 00:14:31,980
<font color="#E5E5E5">got ourselves a file</font><font color="#CCCCCC"> this file</font><font color="#E5E5E5"> is a few</font>

324
00:14:29,400 --> 00:14:34,110
more upgrade file<font color="#E5E5E5"> it's not an executable</font>

325
00:14:31,980 --> 00:14:36,900
file it's<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the binary and now we</font>

326
00:14:34,110 --> 00:14:38,820
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> need to understand how do you</font>

327
00:14:36,900 --> 00:14:40,860
<font color="#E5E5E5">even upgrade the printer</font><font color="#CCCCCC"> fumer I</font><font color="#E5E5E5"> mean I</font>

328
00:14:38,820 --> 00:14:43,940
<font color="#CCCCCC">never did it before anybody did anybody</font>

329
00:14:40,860 --> 00:14:48,210
<font color="#E5E5E5">upgraded</font><font color="#CCCCCC"> this a</font><font color="#E5E5E5"> few more lately good</font>

330
00:14:43,940 --> 00:14:50,670
<font color="#E5E5E5">good for you but for you anyway the</font>

331
00:14:48,210 --> 00:14:54,080
answer<font color="#CCCCCC"> to this question is surprisingly</font>

332
00:14:50,670 --> 00:14:57,000
funny<font color="#CCCCCC"> I would say yeah you just</font><font color="#E5E5E5"> print it</font>

333
00:14:54,080 --> 00:14:58,380
<font color="#CCCCCC">yeah that's because you see a printer</font>

334
00:14:57,000 --> 00:14:59,940
receives a few more<font color="#CCCCCC"> upgrades</font>

335
00:14:58,380 --> 00:15:03,390
just the same way<font color="#E5E5E5"> as it receives a</font>

336
00:14:59,940 --> 00:15:04,830
normal print job<font color="#E5E5E5"> then that's that</font><font color="#CCCCCC"> thing</font>

337
00:15:03,390 --> 00:15:08,819
it's<font color="#E5E5E5"> actually pretty nice and it's</font>

338
00:15:04,830 --> 00:15:10,440
defined<font color="#CCCCCC"> in</font><font color="#E5E5E5"> HP protocol it's called PCL</font>

339
00:15:08,820 --> 00:15:12,750
<font color="#CCCCCC">Excel future reference protocol class</font>

340
00:15:10,440 --> 00:15:14,760
<font color="#E5E5E5">2.1 supplement that if you are still</font>

341
00:15:12,750 --> 00:15:18,870
<font color="#CCCCCC">sane after reading this</font><font color="#E5E5E5"> like 300 pages</font>

342
00:15:14,760 --> 00:15:20,370
of insanity<font color="#CCCCCC"> you understand</font><font color="#E5E5E5"> that this</font>

343
00:15:18,870 --> 00:15:22,620
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> defines something</font><font color="#E5E5E5"> called a</font><font color="#CCCCCC"> pjl a</font>

344
00:15:20,370 --> 00:15:24,810
print job language if you<font color="#E5E5E5"> ever scanned</font>

345
00:15:22,620 --> 00:15:28,380
the printer to the<font color="#E5E5E5"> network you see this</font>

346
00:15:24,810 --> 00:15:30,300
port I think<font color="#E5E5E5"> 9100 something like that</font>

347
00:15:28,380 --> 00:15:31,740
<font color="#E5E5E5">open that's the</font><font color="#CCCCCC"> pour that</font><font color="#E5E5E5"> you send print</font>

348
00:15:30,300 --> 00:15:34,439
<font color="#CCCCCC">jobs to and that's the</font><font color="#E5E5E5"> same port that</font>

349
00:15:31,740 --> 00:15:36,240
<font color="#E5E5E5">you send the</font><font color="#CCCCCC"> film or upgrade to</font><font color="#E5E5E5"> and</font>

350
00:15:34,440 --> 00:15:37,500
that's that's<font color="#E5E5E5"> nice so when we look at</font>

351
00:15:36,240 --> 00:15:39,150
the file it actually confirms this

352
00:15:37,500 --> 00:15:41,820
<font color="#E5E5E5">because it</font><font color="#CCCCCC"> actually begins with the</font>

353
00:15:39,150 --> 00:15:43,230
words pjl printing<font color="#CCCCCC"> print job language so</font>

354
00:15:41,820 --> 00:15:45,060
that's<font color="#E5E5E5"> nice so now we know it's a</font>

355
00:15:43,230 --> 00:15:47,280
printer of language<font color="#E5E5E5"> but unfortunately</font>

356
00:15:45,060 --> 00:15:50,520
this document doesn't document<font color="#E5E5E5"> anything</font>

357
00:15:47,280 --> 00:15:52,650
about the few more upgrade<font color="#E5E5E5"> a protocol or</font>

358
00:15:50,520 --> 00:15:54,900
anything because kind<font color="#E5E5E5"> of HP proprietary</font>

359
00:15:52,650 --> 00:15:57,780
so unfortunately<font color="#E5E5E5"> we had</font><font color="#CCCCCC"> to like do it</font>

360
00:15:54,900 --> 00:16:00,110
<font color="#E5E5E5">ourselves and analyze this</font><font color="#CCCCCC"> thing now I'm</font>

361
00:15:57,780 --> 00:16:03,839
not I'm not<font color="#E5E5E5"> going to take you through</font>

362
00:16:00,110 --> 00:16:05,430
the<font color="#CCCCCC"> entire process of unwrapping this</font>

363
00:16:03,840 --> 00:16:07,620
<font color="#CCCCCC">fumarole</font><font color="#E5E5E5"> because frankly it's quite</font>

364
00:16:05,430 --> 00:16:09,239
boring<font color="#CCCCCC"> but I'll just tell you that</font><font color="#E5E5E5"> it's</font>

365
00:16:07,620 --> 00:16:11,430
composed of several layers of

366
00:16:09,240 --> 00:16:13,200
compression<font color="#CCCCCC"> one of them is called an al</font>

367
00:16:11,430 --> 00:16:15,439
decoder the other is called<font color="#CCCCCC"> TIF decoder</font>

368
00:16:13,200 --> 00:16:18,900
and another one called as<font color="#CCCCCC"> a</font><font color="#E5E5E5"> row decoder</font>

369
00:16:15,440 --> 00:16:21,420
<font color="#CCCCCC">and the thing is that these things do</font>

370
00:16:18,900 --> 00:16:23,610
something like you know if the previous

371
00:16:21,420 --> 00:16:25,680
<font color="#CCCCCC">line was all blanks then if this line is</font>

372
00:16:23,610 --> 00:16:28,020
also<font color="#E5E5E5"> all blanks just</font><font color="#CCCCCC"> write one instead</font>

373
00:16:25,680 --> 00:16:30,000
of<font color="#CCCCCC"> the line</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> that gives you some kind</font>

374
00:16:28,020 --> 00:16:31,290
of compression<font color="#E5E5E5"> and it makes really a lot</font>

375
00:16:30,000 --> 00:16:33,630
<font color="#E5E5E5">of sense</font><font color="#CCCCCC"> when you're talking</font><font color="#E5E5E5"> about print</font>

376
00:16:31,290 --> 00:16:35,520
jobs because you know print paper has a

377
00:16:33,630 --> 00:16:36,899
lot of<font color="#E5E5E5"> spaces</font><font color="#CCCCCC"> in it but when</font><font color="#E5E5E5"> you're</font>

378
00:16:35,520 --> 00:16:39,689
talking<font color="#E5E5E5"> about binary file</font>

379
00:16:36,899 --> 00:16:42,600
it makes absolutely<font color="#CCCCCC"> no sense to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> it</font>

380
00:16:39,689 --> 00:16:45,240
this way<font color="#E5E5E5"> but still you know it</font><font color="#CCCCCC"> just</font>

381
00:16:42,600 --> 00:16:47,220
works this way so we often understand

382
00:16:45,240 --> 00:16:49,079
<font color="#E5E5E5">this that we were able to decode</font>

383
00:16:47,220 --> 00:16:50,879
everything they compress everything<font color="#E5E5E5"> and</font>

384
00:16:49,079 --> 00:16:51,868
we're talking<font color="#E5E5E5"> to us selves and laughing</font>

385
00:16:50,879 --> 00:16:53,220
<font color="#CCCCCC">that you know when you're a hammer</font>

386
00:16:51,869 --> 00:16:54,959
<font color="#CCCCCC">everything looks like a nail and when</font>

387
00:16:53,220 --> 00:17:00,089
your printer<font color="#CCCCCC"> everything looks</font><font color="#E5E5E5"> like a</font>

388
00:16:54,959 --> 00:17:01,920
print job<font color="#CCCCCC"> so yeah</font><font color="#E5E5E5"> that was nice and now</font>

389
00:17:00,089 --> 00:17:05,490
<font color="#E5E5E5">after we did that we</font><font color="#CCCCCC"> have a big file</font>

390
00:17:01,920 --> 00:17:08,398
that hopefully now it's our<font color="#E5E5E5"> framework</font><font color="#CCCCCC"> so</font>

391
00:17:05,490 --> 00:17:10,079
how do<font color="#E5E5E5"> we analyze it</font><font color="#CCCCCC"> so looking at this</font>

392
00:17:08,398 --> 00:17:11,729
thing<font color="#E5E5E5"> right</font><font color="#CCCCCC"> at the beginning of the</font>

393
00:17:10,079 --> 00:17:14,099
<font color="#E5E5E5">filer something that really looks like a</font>

394
00:17:11,730 --> 00:17:16,079
table<font color="#E5E5E5"> and it's not doesn't</font><font color="#CCCCCC"> really only</font>

395
00:17:14,099 --> 00:17:18,029
<font color="#E5E5E5">look like</font><font color="#CCCCCC"> a tablet</font><font color="#E5E5E5"> it is</font><font color="#CCCCCC"> a table</font><font color="#E5E5E5"> we</font>

396
00:17:16,079 --> 00:17:20,849
define it it looks like<font color="#E5E5E5"> this and what</font>

397
00:17:18,029 --> 00:17:23,549
<font color="#E5E5E5">this table defines is like a loading</font>

398
00:17:20,849 --> 00:17:25,139
address section name and location in

399
00:17:23,549 --> 00:17:27,839
binary<font color="#E5E5E5"> so what did that means that our</font>

400
00:17:25,140 --> 00:17:30,360
big file is<font color="#E5E5E5"> actually split into several</font>

401
00:17:27,839 --> 00:17:32,668
<font color="#E5E5E5">sections and this table just defines</font>

402
00:17:30,360 --> 00:17:34,740
those sections so now we are able<font color="#CCCCCC"> to</font>

403
00:17:32,669 --> 00:17:38,159
split this big file into several smaller

404
00:17:34,740 --> 00:17:39,840
chunks<font color="#CCCCCC"> and inspect</font><font color="#E5E5E5"> each chunk and the</font>

405
00:17:38,159 --> 00:17:42,179
most important chunk the most the one

406
00:17:39,840 --> 00:17:44,549
that looks most<font color="#E5E5E5"> promising looks like it</font>

407
00:17:42,179 --> 00:17:47,580
contains<font color="#E5E5E5"> our</font><font color="#CCCCCC"> framework so we took a</font>

408
00:17:44,549 --> 00:17:50,760
closer look<font color="#E5E5E5"> into that and that's what we</font>

409
00:17:47,580 --> 00:17:52,980
saw<font color="#E5E5E5"> I mean it actually looks like our</font>

410
00:17:50,760 --> 00:17:54,720
framework that's because you see that's

411
00:17:52,980 --> 00:17:58,080
<font color="#E5E5E5">like one of</font><font color="#CCCCCC"> the strings</font><font color="#E5E5E5"> that we see in</font>

412
00:17:54,720 --> 00:18:00,270
it yeah we saw we all saw<font color="#CCCCCC"> that before</font>

413
00:17:58,080 --> 00:18:01,860
<font color="#CCCCCC">right</font><font color="#E5E5E5"> it's a oh I don't understand but</font>

414
00:18:00,270 --> 00:18:03,240
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> not completely Aero I don't</font>

415
00:18:01,860 --> 00:18:06,928
understand<font color="#E5E5E5"> right there's some missing</font>

416
00:18:03,240 --> 00:18:08,429
bytes in here<font color="#E5E5E5"> and we actually those</font>

417
00:18:06,929 --> 00:18:11,190
missing bytes are pretty consistent

418
00:18:08,429 --> 00:18:12,720
<font color="#E5E5E5">throughout</font><font color="#CCCCCC"> the entire chunk</font><font color="#E5E5E5"> so although</font>

419
00:18:11,190 --> 00:18:15,390
<font color="#E5E5E5">we know</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> looking at the code</font>

420
00:18:12,720 --> 00:18:17,549
<font color="#E5E5E5">we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> actually see the code until we</font>

421
00:18:15,390 --> 00:18:19,980
have those missing by its field<font color="#E5E5E5"> we need</font>

422
00:18:17,549 --> 00:18:22,649
to understand why are they there and

423
00:18:19,980 --> 00:18:23,850
what were they replaced with so let's

424
00:18:22,649 --> 00:18:27,029
try<font color="#E5E5E5"> to analyze this thing together</font>

425
00:18:23,850 --> 00:18:29,279
<font color="#E5E5E5">quickly</font><font color="#CCCCCC"> now but first</font><font color="#E5E5E5"> let's start to</font>

426
00:18:27,029 --> 00:18:31,890
understand<font color="#CCCCCC"> what is this thing</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> have a</font>

427
00:18:29,279 --> 00:18:34,470
lot<font color="#CCCCCC"> of things in</font><font color="#E5E5E5"> mind everyone looked</font>

428
00:18:31,890 --> 00:18:36,419
<font color="#E5E5E5">seem crazy but I think the least</font>

429
00:18:34,470 --> 00:18:38,820
craziest option was that<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is yet</font>

430
00:18:36,419 --> 00:18:41,640
another form<font color="#E5E5E5"> of compression</font><font color="#CCCCCC"> a really bad</font>

431
00:18:38,820 --> 00:18:43,678
<font color="#E5E5E5">one again because when we try to</font>

432
00:18:41,640 --> 00:18:45,090
compress<font color="#E5E5E5"> this thing with</font><font color="#CCCCCC"> dilip for</font>

433
00:18:43,679 --> 00:18:47,880
example we get<font color="#E5E5E5"> like 80% better</font>

434
00:18:45,090 --> 00:18:49,139
compression<font color="#E5E5E5"> than</font><font color="#CCCCCC"> it currently is so and</font>

435
00:18:47,880 --> 00:18:49,830
we know<font color="#CCCCCC"> that the printer has really</font>

436
00:18:49,139 --> 00:18:52,590
because we see

437
00:18:49,830 --> 00:18:53,580
<font color="#E5E5E5">zip strings in there so why not use a</font>

438
00:18:52,590 --> 00:18:55,439
lip I don't know

439
00:18:53,580 --> 00:18:57,629
but still we are left with<font color="#CCCCCC"> the challenge</font>

440
00:18:55,440 --> 00:18:59,640
so this<font color="#E5E5E5"> is one snippet of</font><font color="#CCCCCC"> the code</font><font color="#E5E5E5"> that</font>

441
00:18:57,630 --> 00:19:01,799
you<font color="#CCCCCC"> just saw</font><font color="#E5E5E5"> and let's try to decompress</font>

442
00:18:59,640 --> 00:19:03,330
this so first of all you<font color="#E5E5E5"> need to</font>

443
00:19:01,799 --> 00:19:05,519
understand this<font color="#E5E5E5"> thing is composed of two</font>

444
00:19:03,330 --> 00:19:07,199
<font color="#CCCCCC">types of characters one our ASCII</font>

445
00:19:05,519 --> 00:19:10,289
<font color="#CCCCCC">character stuff that you can read and</font>

446
00:19:07,200 --> 00:19:13,320
some other<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> that you can't read non</font>

447
00:19:10,289 --> 00:19:15,570
ASCII characters and those non ASCII

448
00:19:13,320 --> 00:19:17,370
characters are<font color="#E5E5E5"> actually those missing</font>

449
00:19:15,570 --> 00:19:18,809
bytes<font color="#E5E5E5"> that we have so we need to</font>

450
00:19:17,370 --> 00:19:21,539
understand what they<font color="#CCCCCC"> are so let's take a</font>

451
00:19:18,809 --> 00:19:23,039
closer look<font color="#E5E5E5"> at them and if you stir this</font>

452
00:19:21,539 --> 00:19:25,260
thing long enough<font color="#CCCCCC"> you will start</font><font color="#E5E5E5"> seeing</font>

453
00:19:23,039 --> 00:19:27,809
some<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> pattern and</font><font color="#E5E5E5"> I'll save you</font>

454
00:19:25,260 --> 00:19:30,450
the trouble<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> show</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> that it</font>

455
00:19:27,809 --> 00:19:33,120
<font color="#E5E5E5">codes composed of like these one single</font>

456
00:19:30,450 --> 00:19:34,950
bytes and then those double bytes<font color="#E5E5E5"> in</font>

457
00:19:33,120 --> 00:19:37,469
there<font color="#E5E5E5"> and if the distance between the</font>

458
00:19:34,950 --> 00:19:40,169
single bytes looks suspiciously pattern

459
00:19:37,470 --> 00:19:42,240
is<font color="#E5E5E5"> 8 bytes 9 bytes 9 bytes</font><font color="#CCCCCC"> 8 bytes</font><font color="#E5E5E5"> over</font>

460
00:19:40,169 --> 00:19:45,029
and<font color="#E5E5E5"> over again</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> what does this mean</font>

461
00:19:42,240 --> 00:19:46,649
where is the pattern here<font color="#E5E5E5"> if you look at</font>

462
00:19:45,029 --> 00:19:48,600
<font color="#E5E5E5">this from a different angle</font>

463
00:19:46,649 --> 00:19:51,510
maybe<font color="#E5E5E5"> the pattern will look a</font><font color="#CCCCCC"> bit</font>

464
00:19:48,600 --> 00:19:53,730
clearer<font color="#CCCCCC"> you see the</font><font color="#E5E5E5"> F 7 and F 7 they</font>

465
00:19:51,510 --> 00:19:54,658
look the<font color="#CCCCCC"> same the</font><font color="#E5E5E5"> FF</font><font color="#CCCCCC"> &</font><font color="#E5E5E5"> FF they look the</font>

466
00:19:53,730 --> 00:19:56,429
same something<font color="#E5E5E5"> here looks really</font>

467
00:19:54,659 --> 00:19:58,769
patination<font color="#E5E5E5"> in order to understand this</font>

468
00:19:56,429 --> 00:20:00,570
pattern<font color="#E5E5E5"> you need to sharpen your binary</font>

469
00:19:58,769 --> 00:20:04,559
view of it a bit and<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you understand</font>

470
00:20:00,570 --> 00:20:06,269
that<font color="#E5E5E5"> FF is just 1/8 one bit</font><font color="#CCCCCC"> and if</font>

471
00:20:04,559 --> 00:20:07,950
you'll do this consistently<font color="#E5E5E5"> for all of</font>

472
00:20:06,269 --> 00:20:09,510
these chunks<font color="#E5E5E5"> then you'll start seeing</font>

473
00:20:07,950 --> 00:20:12,389
<font color="#E5E5E5">the pattern you see the pattern is that</font>

474
00:20:09,510 --> 00:20:15,059
<font color="#E5E5E5">the zero bit always falls within this</font><font color="#CCCCCC"> 2</font>

475
00:20:12,389 --> 00:20:17,219
byte hole<font color="#E5E5E5"> and what this means it's</font>

476
00:20:15,059 --> 00:20:18,870
consistent what the file<font color="#E5E5E5"> what this means</font>

477
00:20:17,220 --> 00:20:21,269
is that the<font color="#E5E5E5"> first byte is just a bitmap</font>

478
00:20:18,870 --> 00:20:23,668
<font color="#E5E5E5">describing the following</font><font color="#CCCCCC"> 8 bytes</font><font color="#E5E5E5"> after</font>

479
00:20:21,269 --> 00:20:25,649
<font color="#E5E5E5">it</font><font color="#CCCCCC"> there what it means</font><font color="#E5E5E5"> and that's</font>

480
00:20:23,669 --> 00:20:28,110
perfect because<font color="#CCCCCC"> now we understand</font><font color="#E5E5E5"> what</font>

481
00:20:25,649 --> 00:20:30,059
is this single byte but we still<font color="#E5E5E5"> don't</font>

482
00:20:28,110 --> 00:20:32,549
<font color="#E5E5E5">understand what are those double bytes</font>

483
00:20:30,059 --> 00:20:35,850
<font color="#E5E5E5">and they will be placed with something</font>

484
00:20:32,549 --> 00:20:37,769
but<font color="#E5E5E5"> with what</font><font color="#CCCCCC"> so if you know anything</font>

485
00:20:35,850 --> 00:20:40,049
<font color="#CCCCCC">about</font><font color="#E5E5E5"> compression you know that there's</font>

486
00:20:37,769 --> 00:20:41,639
not a<font color="#E5E5E5"> lot of options</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> really it</font>

487
00:20:40,049 --> 00:20:43,980
could be either a forward<font color="#E5E5E5"> or backward</font>

488
00:20:41,639 --> 00:20:46,529
pointer<font color="#CCCCCC"> it could be a dictionary of some</font>

489
00:20:43,980 --> 00:20:48,510
sort<font color="#CCCCCC"> or it could be a sliding window</font><font color="#E5E5E5"> now</font>

490
00:20:46,529 --> 00:20:49,769
we can pretty easily confirm that it's

491
00:20:48,510 --> 00:20:52,200
not a forward<font color="#E5E5E5"> backward pointer just</font>

492
00:20:49,769 --> 00:20:53,639
<font color="#E5E5E5">because we try to follow the references</font>

493
00:20:52,200 --> 00:20:56,639
in<font color="#E5E5E5"> the file we see nothing that we</font>

494
00:20:53,639 --> 00:20:58,649
should be there<font color="#CCCCCC"> same goes for dictionary</font>

495
00:20:56,639 --> 00:21:00,270
we can't find<font color="#CCCCCC"> anything that's consistent</font>

496
00:20:58,649 --> 00:21:02,129
enough to be a dictionary<font color="#E5E5E5"> so it leaves</font>

497
00:21:00,270 --> 00:21:03,120
<font color="#E5E5E5">us</font><font color="#CCCCCC"> with only with the option of sliding</font>

498
00:21:02,130 --> 00:21:04,830
<font color="#E5E5E5">window</font>

499
00:21:03,120 --> 00:21:07,049
and once we were equipped with<font color="#E5E5E5"> this</font>

500
00:21:04,830 --> 00:21:10,168
information<font color="#CCCCCC"> we go to our favorite place</font>

501
00:21:07,049 --> 00:21:12,389
to Google and try to find some similar

502
00:21:10,169 --> 00:21:14,519
implementations to this<font color="#E5E5E5"> and luckily</font><font color="#CCCCCC"> for</font>

503
00:21:12,389 --> 00:21:18,870
us in some very dark corner of<font color="#E5E5E5"> the</font>

504
00:21:14,519 --> 00:21:20,370
<font color="#CCCCCC">Internet we find this wiki page defined</font>

505
00:21:18,870 --> 00:21:24,418
<font color="#E5E5E5">something called soft</font><font color="#CCCCCC"> disc library</font>

506
00:21:20,370 --> 00:21:26,399
format and I would I won't ask if

507
00:21:24,419 --> 00:21:28,620
anybody knows<font color="#CCCCCC"> who what something</font><font color="#E5E5E5"> is soft</font>

508
00:21:26,399 --> 00:21:32,189
<font color="#E5E5E5">disc is because probably somebody knows</font>

509
00:21:28,620 --> 00:21:34,018
here<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> CCC after all</font><font color="#E5E5E5"> but inside this</font>

510
00:21:32,190 --> 00:21:35,700
thing<font color="#CCCCCC"> it defines some kind</font><font color="#E5E5E5"> of</font>

511
00:21:34,019 --> 00:21:40,259
compression algorithm that<font color="#CCCCCC"> looks very</font>

512
00:21:35,700 --> 00:21:41,669
similar<font color="#CCCCCC"> to ours</font><font color="#E5E5E5"> it looks actually really</font>

513
00:21:40,259 --> 00:21:45,659
really like ours actually<font color="#CCCCCC"> it's exactly</font>

514
00:21:41,669 --> 00:21:48,000
<font color="#E5E5E5">our compression algorithm so so yeah</font>

515
00:21:45,659 --> 00:21:50,399
that's<font color="#E5E5E5"> nice and I think</font><font color="#CCCCCC"> the funny thing</font>

516
00:21:48,000 --> 00:21:53,669
here is that<font color="#CCCCCC"> this compression</font><font color="#E5E5E5"> algorithm</font>

517
00:21:50,399 --> 00:21:59,668
was used in the<font color="#E5E5E5"> past</font><font color="#CCCCCC"> somewhere</font><font color="#E5E5E5"> and only</font>

518
00:21:53,669 --> 00:22:03,120
there<font color="#E5E5E5"> can you guess well yeah somebody</font>

519
00:21:59,669 --> 00:22:04,980
who didn't see the<font color="#E5E5E5"> I didn't see this</font>

520
00:22:03,120 --> 00:22:07,289
<font color="#E5E5E5">presentation before yeah</font><font color="#CCCCCC"> it was used in</font>

521
00:22:04,980 --> 00:22:08,759
Commander Keen<font color="#E5E5E5"> and soft disk is</font><font color="#CCCCCC"> the</font>

522
00:22:07,289 --> 00:22:10,980
company who produced Commander Keen so

523
00:22:08,759 --> 00:22:14,370
the<font color="#E5E5E5"> compression algorithm</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> Commander</font>

524
00:22:10,980 --> 00:22:19,159
Keen<font color="#E5E5E5"> made its way somehow into the HP</font>

525
00:22:14,370 --> 00:22:19,158
the entire HP a line of products

526
00:22:22,140 --> 00:22:27,550
how I don't<font color="#E5E5E5"> know you can check</font><font color="#CCCCCC"> if there</font>

527
00:22:25,630 --> 00:22:29,650
was anybody<font color="#E5E5E5"> who was fired from</font><font color="#CCCCCC"> salts of</font>

528
00:22:27,550 --> 00:22:33,340
<font color="#E5E5E5">this can hired in HP probably that would</font>

529
00:22:29,650 --> 00:22:35,080
be my guess but we'll never know<font color="#CCCCCC"> so now</font>

530
00:22:33,340 --> 00:22:36,850
we understand<font color="#CCCCCC"> exactly what is this thing</font>

531
00:22:35,080 --> 00:22:38,260
<font color="#E5E5E5">and how does this compression work we</font>

532
00:22:36,850 --> 00:22:40,600
have the missing data<font color="#E5E5E5"> that we need and</font>

533
00:22:38,260 --> 00:22:42,430
this<font color="#E5E5E5"> data means that those two bytes are</font>

534
00:22:40,600 --> 00:22:44,439
actually composed of<font color="#CCCCCC"> window.location and</font>

535
00:22:42,430 --> 00:22:46,720
<font color="#E5E5E5">data</font><font color="#CCCCCC"> linked and that's all we need and</font>

536
00:22:44,440 --> 00:22:48,460
let me show you like<font color="#E5E5E5"> really quickly how</font>

537
00:22:46,720 --> 00:22:49,960
this<font color="#E5E5E5"> compression works so we have an</font>

538
00:22:48,460 --> 00:22:51,850
<font color="#CCCCCC">input text output</font><font color="#E5E5E5"> text and</font>

539
00:22:49,960 --> 00:22:53,800
<font color="#CCCCCC">sliding-window we want to compress this</font>

540
00:22:51,850 --> 00:22:55,810
string over<font color="#E5E5E5"> here and let's try and do it</font>

541
00:22:53,800 --> 00:22:57,730
so first<font color="#E5E5E5"> byte is the bitmap</font><font color="#CCCCCC"> I remind you</font>

542
00:22:55,810 --> 00:23:00,639
so we<font color="#E5E5E5"> leave it empty for</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> and then</font>

543
00:22:57,730 --> 00:23:02,170
second byte we start with a so we place

544
00:23:00,640 --> 00:23:04,450
<font color="#E5E5E5">it both</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the output</font><font color="#CCCCCC"> text and in the</font>

545
00:23:02,170 --> 00:23:07,390
<font color="#E5E5E5">sliding window and then we</font><font color="#CCCCCC"> go to B same</font>

546
00:23:04,450 --> 00:23:09,640
thing<font color="#CCCCCC"> C same thing D again and now we</font>

547
00:23:07,390 --> 00:23:11,170
get to a but a<font color="#CCCCCC"> is already present in the</font>

548
00:23:09,640 --> 00:23:13,600
<font color="#E5E5E5">sliding window so we don't need to write</font>

549
00:23:11,170 --> 00:23:16,630
<font color="#E5E5E5">it in the output</font><font color="#CCCCCC"> text you know we can</font>

550
00:23:13,600 --> 00:23:18,310
<font color="#CCCCCC">just write</font><font color="#E5E5E5"> just do nothing and then go</font>

551
00:23:16,630 --> 00:23:20,200
to be same thing is<font color="#E5E5E5"> just the following</font>

552
00:23:18,310 --> 00:23:22,899
character in the sliding window<font color="#E5E5E5"> and then</font>

553
00:23:20,200 --> 00:23:25,480
when we get to<font color="#CCCCCC"> e we just write 0 0</font><font color="#E5E5E5"> 0 2</font>

554
00:23:22,900 --> 00:23:27,640
that<font color="#E5E5E5"> means go to the sliding</font><font color="#CCCCCC"> window at</font>

555
00:23:25,480 --> 00:23:29,590
position 0<font color="#E5E5E5"> and take the first</font><font color="#CCCCCC"> two bytes</font>

556
00:23:27,640 --> 00:23:32,500
<font color="#E5E5E5">that's what it means</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we</font>

557
00:23:29,590 --> 00:23:35,139
continue to e FG<font color="#E5E5E5"> after we did that</font><font color="#CCCCCC"> we</font>

558
00:23:32,500 --> 00:23:37,990
<font color="#CCCCCC">put our bitmap here and now we know the</font>

559
00:23:35,140 --> 00:23:39,280
<font color="#CCCCCC">bitmap bitmap value and that's all there</font>

560
00:23:37,990 --> 00:23:41,620
is<font color="#E5E5E5"> to it that's the compression</font>

561
00:23:39,280 --> 00:23:43,780
algorithm it's pretty easy<font color="#CCCCCC"> looking at at</font>

562
00:23:41,620 --> 00:23:47,649
it this way right<font color="#E5E5E5"> looking at it it</font>

563
00:23:43,780 --> 00:23:49,780
reverse is a bit more<font color="#E5E5E5"> difficult</font><font color="#CCCCCC"> but yes</font>

564
00:23:47,650 --> 00:23:51,280
now we<font color="#E5E5E5"> can do that and now we completely</font>

565
00:23:49,780 --> 00:23:53,200
open everything<font color="#E5E5E5"> and yes we have our</font>

566
00:23:51,280 --> 00:23:56,080
<font color="#E5E5E5">frame where we</font><font color="#CCCCCC"> can read</font><font color="#E5E5E5"> everything it's</font>

567
00:23:53,200 --> 00:23:57,580
actual code<font color="#CCCCCC"> and now we need</font><font color="#E5E5E5"> to</font>

568
00:23:56,080 --> 00:23:59,320
understand what does this code mean and

569
00:23:57,580 --> 00:24:01,169
basically<font color="#E5E5E5"> first of all we need to</font>

570
00:23:59,320 --> 00:24:03,669
understand what architecture is<font color="#E5E5E5"> this</font>

571
00:24:01,170 --> 00:24:04,780
<font color="#E5E5E5">what is the operating</font><font color="#CCCCCC"> system and</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> on</font>

572
00:24:03,670 --> 00:24:06,430
and so on

573
00:24:04,780 --> 00:24:09,070
<font color="#E5E5E5">so it took us quite</font><font color="#CCCCCC"> some time to do that</font>

574
00:24:06,430 --> 00:24:11,560
<font color="#CCCCCC">but let</font><font color="#E5E5E5"> me give you a brief explanation</font>

575
00:24:09,070 --> 00:24:13,210
<font color="#E5E5E5">first of all the operating system is</font>

576
00:24:11,560 --> 00:24:16,210
called<font color="#E5E5E5"> tread X it's a real-time</font>

577
00:24:13,210 --> 00:24:19,840
<font color="#CCCCCC">operating system the CPU the processor</font>

578
00:24:16,210 --> 00:24:21,580
is<font color="#CCCCCC"> armed line</font><font color="#E5E5E5"> big in the end</font><font color="#CCCCCC"> and then it</font>

579
00:24:19,840 --> 00:24:24,280
has<font color="#CCCCCC"> like</font><font color="#E5E5E5"> several components</font><font color="#CCCCCC"> to it like</font>

580
00:24:21,580 --> 00:24:26,879
stuff that's<font color="#CCCCCC"> related to system some</font>

581
00:24:24,280 --> 00:24:29,800
common libraries and tasks tests are the

582
00:24:26,880 --> 00:24:33,040
common the<font color="#E5E5E5"> equivalent of processes in</font>

583
00:24:29,800 --> 00:24:35,470
normal<font color="#E5E5E5"> operating systems</font><font color="#CCCCCC"> so in the</font>

584
00:24:33,040 --> 00:24:37,149
system<font color="#CCCCCC"> stuff we have like boot loaders</font>

585
00:24:35,470 --> 00:24:39,669
some networking functionality and some

586
00:24:37,149 --> 00:24:43,209
other stuff<font color="#CCCCCC"> common libraries we have a</font>

587
00:24:39,669 --> 00:24:44,799
lot of<font color="#E5E5E5"> common libraries and tasks once</font>

588
00:24:43,210 --> 00:24:46,659
we are<font color="#CCCCCC"> able to isolate</font><font color="#E5E5E5"> them we can</font>

589
00:24:44,799 --> 00:24:49,299
understand exactly<font color="#E5E5E5"> the</font><font color="#CCCCCC"> tests and once we</font>

590
00:24:46,659 --> 00:24:52,419
do that we now know<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we all we need</font>

591
00:24:49,299 --> 00:24:54,250
<font color="#E5E5E5">to do is like to focus on these tasks</font>

592
00:24:52,419 --> 00:24:55,539
because<font color="#CCCCCC"> they are the tasks relevant to</font>

593
00:24:54,250 --> 00:24:57,820
<font color="#CCCCCC">fax protocols we can leave everything</font>

594
00:24:55,539 --> 00:25:01,269
<font color="#E5E5E5">else</font><font color="#CCCCCC"> aside</font><font color="#E5E5E5"> it will make our work much</font>

595
00:24:57,820 --> 00:25:03,189
more easy<font color="#CCCCCC"> and we don't we</font><font color="#E5E5E5"> want to start</font>

596
00:25:01,269 --> 00:25:06,250
<font color="#E5E5E5">doing that but just a second before we</font>

597
00:25:03,190 --> 00:25:09,789
<font color="#E5E5E5">do that</font><font color="#CCCCCC"> looking at this we see</font><font color="#E5E5E5"> something</font>

598
00:25:06,250 --> 00:25:11,470
<font color="#CCCCCC">that looks not</font><font color="#E5E5E5"> really I don't know it</font>

599
00:25:09,789 --> 00:25:15,070
<font color="#CCCCCC">doesn't make sense a lot and</font><font color="#E5E5E5"> this thing</font>

600
00:25:11,470 --> 00:25:17,620
is<font color="#E5E5E5"> SpiderMonkey the printer</font><font color="#CCCCCC"> every HP</font>

601
00:25:15,070 --> 00:25:18,759
<font color="#E5E5E5">printer contains a SpiderMonkey library</font>

602
00:25:17,620 --> 00:25:20,739
<font color="#CCCCCC">I don't know if you know what</font>

603
00:25:18,759 --> 00:25:22,659
<font color="#CCCCCC">SpiderMonkey is but</font><font color="#E5E5E5"> basically it's the</font>

604
00:25:20,740 --> 00:25:25,330
JavaScript implementation by Mozilla

605
00:25:22,659 --> 00:25:27,070
it's used in Firefox<font color="#CCCCCC"> for example and we</font>

606
00:25:25,330 --> 00:25:29,500
were thinking<font color="#CCCCCC"> to ourselves why does a</font>

607
00:25:27,070 --> 00:25:31,720
printer<font color="#E5E5E5"> need to render JavaScript it</font>

608
00:25:29,500 --> 00:25:34,269
makes no sense<font color="#CCCCCC"> I mean yeah it has a web</font>

609
00:25:31,720 --> 00:25:36,100
server<font color="#CCCCCC"> but it's not a web client</font><font color="#E5E5E5"> we</font>

610
00:25:34,269 --> 00:25:37,840
couldn't<font color="#E5E5E5"> think of any situation in</font><font color="#CCCCCC"> which</font>

611
00:25:36,100 --> 00:25:40,449
a printer needs<font color="#E5E5E5"> to render JavaScript it</font>

612
00:25:37,840 --> 00:25:43,029
looked really<font color="#E5E5E5"> strange to</font><font color="#CCCCCC"> us so we</font>

613
00:25:40,450 --> 00:25:45,460
<font color="#E5E5E5">decided to like try</font><font color="#CCCCCC"> and see where is</font>

614
00:25:43,029 --> 00:25:48,009
<font color="#E5E5E5">this printer exactly using javascript</font><font color="#CCCCCC"> so</font>

615
00:25:45,460 --> 00:25:50,590
we went back<font color="#CCCCCC"> a bit and checked</font><font color="#E5E5E5"> and we</font>

616
00:25:48,009 --> 00:25:52,360
found that javascript is<font color="#CCCCCC"> used in a</font>

617
00:25:50,590 --> 00:25:53,199
feature called<font color="#CCCCCC"> PAC proxy</font>

618
00:25:52,360 --> 00:25:56,289
<font color="#CCCCCC">auto-configuration</font>

619
00:25:53,200 --> 00:25:57,970
it's apparently something no it's it's

620
00:25:56,289 --> 00:26:02,919
<font color="#E5E5E5">pretty common</font><font color="#CCCCCC"> it's a common thing it's</font><font color="#E5E5E5"> a</font>

621
00:25:57,970 --> 00:26:04,779
good protocol<font color="#CCCCCC"> and it like defines proxy</font>

622
00:26:02,919 --> 00:26:07,809
when you're doing a<font color="#E5E5E5"> DHCP or something</font>

623
00:26:04,779 --> 00:26:10,090
like<font color="#E5E5E5"> that the thing is that the top</font>

624
00:26:07,809 --> 00:26:12,879
layer<font color="#E5E5E5"> functionality of this entire pack</font>

625
00:26:10,090 --> 00:26:15,699
<font color="#E5E5E5">functionality was written by by HP and</font>

626
00:26:12,879 --> 00:26:16,990
<font color="#E5E5E5">when we were looking at that we see all</font>

627
00:26:15,700 --> 00:26:19,320
this<font color="#E5E5E5"> functionality and we see this</font>

628
00:26:16,990 --> 00:26:21,850
<font color="#E5E5E5">strange thing</font><font color="#CCCCCC"> here the printer</font>

629
00:26:19,320 --> 00:26:24,460
once it does<font color="#E5E5E5"> this patch functionality it</font>

630
00:26:21,850 --> 00:26:26,230
tries to<font color="#CCCCCC"> connect this domain</font><font color="#E5E5E5"> fake</font><font color="#CCCCCC"> URL</font>

631
00:26:24,460 --> 00:26:28,419
<font color="#E5E5E5">one two three four</font><font color="#CCCCCC"> com just connect to</font>

632
00:26:26,230 --> 00:26:30,850
it and<font color="#E5E5E5"> do nothing with it some sort of</font>

633
00:26:28,419 --> 00:26:34,720
sanity test<font color="#CCCCCC"> I guess I don't really</font><font color="#E5E5E5"> know</font>

634
00:26:30,850 --> 00:26:37,059
why<font color="#CCCCCC"> but</font><font color="#E5E5E5"> the interesting</font><font color="#CCCCCC"> thing here is</font>

635
00:26:34,720 --> 00:26:42,190
that do you<font color="#CCCCCC"> know who owns</font><font color="#E5E5E5"> the domain</font>

636
00:26:37,059 --> 00:26:43,710
fake URL<font color="#CCCCCC"> one two three four com no it's</font>

637
00:26:42,190 --> 00:26:49,110
not<font color="#E5E5E5"> HP</font>

638
00:26:43,710 --> 00:26:56,220
<font color="#CCCCCC">a check point is kind</font><font color="#E5E5E5"> of yeah yeah I own</font>

639
00:26:49,110 --> 00:26:59,820
it<font color="#E5E5E5"> yeah it just wasn't registered so we</font>

640
00:26:56,220 --> 00:27:09,750
registered<font color="#CCCCCC"> it for $5.00 and now every HP</font>

641
00:26:59,820 --> 00:27:12,000
<font color="#CCCCCC">printer is connecting to my domain so if</font>

642
00:27:09,750 --> 00:27:14,070
anybody<font color="#E5E5E5"> wants</font><font color="#CCCCCC"> to buy the domain</font><font color="#E5E5E5"> I have a</font>

643
00:27:12,000 --> 00:27:16,590
very<font color="#E5E5E5"> good price for you more than five</font>

644
00:27:14,070 --> 00:27:21,000
dollars<font color="#E5E5E5"> and now</font><font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> hand it over to</font><font color="#CCCCCC"> Al</font>

645
00:27:16,590 --> 00:27:23,279
to continue<font color="#CCCCCC"> okay thank you</font>

646
00:27:21,000 --> 00:27:25,289
after we finished messing<font color="#CCCCCC"> around with</font>

647
00:27:23,279 --> 00:27:28,770
<font color="#CCCCCC">spidermonkey it's time to</font><font color="#E5E5E5"> focus back on</font>

648
00:27:25,289 --> 00:27:31,679
<font color="#E5E5E5">facts or t30</font><font color="#CCCCCC"> t 13 it's full name its</font>

649
00:27:28,770 --> 00:27:34,710
itu-t recommendation<font color="#CCCCCC"> T 30</font><font color="#E5E5E5"> he's the son</font>

650
00:27:31,679 --> 00:27:38,130
of<font color="#E5E5E5"> the defines the fax protocol actually</font>

651
00:27:34,710 --> 00:27:40,140
<font color="#CCCCCC">it's a very very long PDF more than 300</font>

652
00:27:38,130 --> 00:27:42,029
<font color="#E5E5E5">pages</font><font color="#CCCCCC"> but defines all of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> faces and</font>

653
00:27:40,140 --> 00:27:45,240
<font color="#E5E5E5">messages we need in order to send and</font>

654
00:27:42,029 --> 00:27:48,419
receive a fax document it was for design

655
00:27:45,240 --> 00:27:51,510
very long ago<font color="#E5E5E5"> 1985 and was last updated</font>

656
00:27:48,419 --> 00:27:53,330
more<font color="#E5E5E5"> than a decade ago some from our</font>

657
00:27:51,510 --> 00:27:55,740
perspective<font color="#E5E5E5"> that's a very good idea</font>

658
00:27:53,330 --> 00:27:58,710
<font color="#CCCCCC">because we want</font><font color="#E5E5E5"> to find vulnerabilities</font>

659
00:27:55,740 --> 00:28:01,909
<font color="#E5E5E5">in an old and complicated for</font><font color="#CCCCCC"> the call</font>

660
00:27:58,710 --> 00:28:04,380
<font color="#E5E5E5">we are most probably going to find some</font>

661
00:28:01,909 --> 00:28:07,380
after we read through the standard we

662
00:28:04,380 --> 00:28:11,279
started to dynamically<font color="#CCCCCC"> look at it you</font>

663
00:28:07,380 --> 00:28:14,700
open<font color="#E5E5E5"> it in</font><font color="#CCCCCC"> Ida</font><font color="#E5E5E5"> and look up on the</font><font color="#CCCCCC"> t30</font>

664
00:28:11,279 --> 00:28:16,980
<font color="#CCCCCC">task</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can see that the state</font>

665
00:28:14,700 --> 00:28:20,070
machine is<font color="#E5E5E5"> quite huge as you can see</font>

666
00:28:16,980 --> 00:28:22,470
here in Ida<font color="#E5E5E5"> and actually that's</font><font color="#CCCCCC"> a small</font>

667
00:28:20,070 --> 00:28:24,149
state machine because most<font color="#E5E5E5"> of the code</font>

668
00:28:22,470 --> 00:28:26,190
blocks you can<font color="#E5E5E5"> see over</font><font color="#CCCCCC"> here contains</font>

669
00:28:24,149 --> 00:28:28,739
<font color="#E5E5E5">additional state machines inside them</font>

670
00:28:26,190 --> 00:28:30,720
meaning that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to be a very</font>

671
00:28:28,740 --> 00:28:33,720
<font color="#E5E5E5">very huge and complicated state machine</font>

672
00:28:30,720 --> 00:28:36,510
<font color="#E5E5E5">to reverse and if that wasn't enough it</font>

673
00:28:33,720 --> 00:28:38,250
<font color="#E5E5E5">turns out that HP really likes to use a</font>

674
00:28:36,510 --> 00:28:40,860
<font color="#E5E5E5">function pointers and global variables</font>

675
00:28:38,250 --> 00:28:43,740
<font color="#CCCCCC">in</font><font color="#E5E5E5"> their code meaning that statically</font>

676
00:28:40,860 --> 00:28:47,389
<font color="#CCCCCC">reverse engineering this huge task is</font>

677
00:28:43,740 --> 00:28:49,830
going<font color="#E5E5E5"> to be very complicated</font><font color="#CCCCCC"> although I</font>

678
00:28:47,390 --> 00:28:52,320
<font color="#E5E5E5">personally prefer to statically</font>

679
00:28:49,830 --> 00:28:55,139
<font color="#CCCCCC">reverse-engineer this time we had</font><font color="#E5E5E5"> to</font>

680
00:28:52,320 --> 00:28:56,350
choose a different<font color="#E5E5E5"> tactic</font><font color="#CCCCCC"> we'll need to</font>

681
00:28:55,139 --> 00:28:58,750
dynamically<font color="#CCCCCC"> reversing</font>

682
00:28:56,350 --> 00:29:02,289
this thing and for<font color="#E5E5E5"> this we need to have</font>

683
00:28:58,750 --> 00:29:05,650
<font color="#CCCCCC">a debugger and I didn't</font><font color="#E5E5E5"> even mentioned</font>

684
00:29:02,289 --> 00:29:08,919
earlier<font color="#E5E5E5"> nobody</font><font color="#CCCCCC"> knows how can we debug it</font>

685
00:29:05,650 --> 00:29:13,090
<font color="#E5E5E5">polenta</font><font color="#CCCCCC"> we already tried the built-in</font>

686
00:29:08,919 --> 00:29:15,160
<font color="#CCCCCC">JTAG and serial port and</font><font color="#E5E5E5"> that failed</font><font color="#CCCCCC"> we</font>

687
00:29:13,090 --> 00:29:17,830
then searched for built in gdb<font color="#E5E5E5"> stuff we</font>

688
00:29:15,160 --> 00:29:21,070
could use but<font color="#E5E5E5"> I couldn't find any such</font>

689
00:29:17,830 --> 00:29:23,230
stuff<font color="#E5E5E5"> at this point it's very important</font>

690
00:29:21,070 --> 00:29:26,980
to<font color="#E5E5E5"> remember that</font><font color="#CCCCCC"> even if we could</font>

691
00:29:23,230 --> 00:29:28,809
control<font color="#E5E5E5"> the execution flow no one can</font>

692
00:29:26,980 --> 00:29:31,539
put a debugger without<font color="#E5E5E5"> controlling the</font>

693
00:29:28,809 --> 00:29:34,240
execution flow<font color="#E5E5E5"> and we can't do anything</font>

694
00:29:31,539 --> 00:29:37,900
that's<font color="#CCCCCC"> a black box I can</font><font color="#E5E5E5"> send papers and</font>

695
00:29:34,240 --> 00:29:39,909
that's<font color="#E5E5E5"> it and even if I could control</font>

696
00:29:37,900 --> 00:29:42,760
the execution flow and load<font color="#CCCCCC"> my debugger</font>

697
00:29:39,909 --> 00:29:44,799
<font color="#CCCCCC">the pointer uses a hard will watchdog</font>

698
00:29:42,760 --> 00:29:46,990
<font color="#E5E5E5">and this is an external hardware</font>

699
00:29:44,799 --> 00:29:49,870
mechanism<font color="#E5E5E5"> but monitor is the main CPU</font>

700
00:29:46,990 --> 00:29:53,289
<font color="#E5E5E5">and whenever many</font><font color="#CCCCCC"> CPU enters an endless</font>

701
00:29:49,870 --> 00:29:57,479
loop or halts<font color="#E5E5E5"> the watchdog reboots the</font>

702
00:29:53,289 --> 00:30:00,908
entire film<font color="#CCCCCC"> window and this means that</font>

703
00:29:57,480 --> 00:30:03,850
<font color="#E5E5E5">since essentially a breakpoint halts the</font>

704
00:30:00,909 --> 00:30:06,730
program whenever<font color="#CCCCCC"> will hit a breakpoint</font>

705
00:30:03,850 --> 00:30:10,178
<font color="#CCCCCC">the watchdog will kill</font><font color="#E5E5E5"> us</font><font color="#CCCCCC"> so we need to</font>

706
00:30:06,730 --> 00:30:12,100
find<font color="#E5E5E5"> a way around this thing and this is</font>

707
00:30:10,179 --> 00:30:15,100
this way we could<font color="#E5E5E5"> find out is to speed</font>

708
00:30:12,100 --> 00:30:17,260
this<font color="#CCCCCC"> enormous task into chunks if</font><font color="#E5E5E5"> we</font>

709
00:30:15,100 --> 00:30:19,689
could find any code execution

710
00:30:17,260 --> 00:30:21,580
vulnerability<font color="#E5E5E5"> we could try</font><font color="#CCCCCC"> to execute</font>

711
00:30:19,690 --> 00:30:24,400
<font color="#E5E5E5">code over the</font><font color="#CCCCCC"> printer</font><font color="#E5E5E5"> and load the own</font>

712
00:30:21,580 --> 00:30:27,100
debugger<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the disease stage we had</font>

713
00:30:24,400 --> 00:30:30,450
luck and we<font color="#CCCCCC"> believe that luck is an</font>

714
00:30:27,100 --> 00:30:30,449
important part in every<font color="#CCCCCC"> research project</font>

715
00:30:31,500 --> 00:30:36,370
<font color="#CCCCCC">Stanley on the</font><font color="#E5E5E5"> night of the 19th of July</font>

716
00:30:34,419 --> 00:30:38,919
<font color="#CCCCCC">central publish</font><font color="#E5E5E5"> the vulnerability called</font>

717
00:30:36,370 --> 00:30:41,889
<font color="#E5E5E5">David's</font><font color="#CCCCCC"> IV</font><font color="#E5E5E5"> David's IV is a remote code</font>

718
00:30:38,919 --> 00:30:44,409
execution in<font color="#E5E5E5"> G soap and many embedded</font>

719
00:30:41,890 --> 00:30:46,360
<font color="#E5E5E5">devices and our printer included tend to</font>

720
00:30:44,409 --> 00:30:49,299
implement a web server for management

721
00:30:46,360 --> 00:30:52,000
<font color="#E5E5E5">and configuration and in our case this</font>

722
00:30:49,299 --> 00:30:55,600
web server uses G soap and it even uses

723
00:30:52,000 --> 00:30:57,760
<font color="#E5E5E5">a vulnerable version of G so so we now</font>

724
00:30:55,600 --> 00:31:00,969
have our vulnerability and we'll need to

725
00:30:57,760 --> 00:31:03,220
<font color="#E5E5E5">exploit it for</font><font color="#CCCCCC"> others of you are not</font>

726
00:31:00,970 --> 00:31:05,520
familiar we have<font color="#E5E5E5"> Devas IV here is the</font>

727
00:31:03,220 --> 00:31:09,220
code<font color="#CCCCCC"> and here's the vulnerability itself</font>

728
00:31:05,520 --> 00:31:11,320
<font color="#CCCCCC">devil's</font><font color="#E5E5E5"> IV is an</font><font color="#CCCCCC"> signed integer</font>

729
00:31:09,220 --> 00:31:14,669
<font color="#E5E5E5">the flow</font><font color="#CCCCCC"> of vulnerability meaning</font><font color="#E5E5E5"> that</font>

730
00:31:11,320 --> 00:31:17,439
<font color="#E5E5E5">we'll need</font><font color="#CCCCCC"> to send enough data for</font><font color="#E5E5E5"> the</font>

731
00:31:14,669 --> 00:31:19,990
variable to go from negative back to

732
00:31:17,440 --> 00:31:22,240
positive<font color="#CCCCCC"> and that means we</font><font color="#E5E5E5"> need to send</font>

733
00:31:19,990 --> 00:31:22,809
Rafi to<font color="#E5E5E5"> jjigae bytes of data to the</font>

734
00:31:22,240 --> 00:31:25,360
printer

735
00:31:22,809 --> 00:31:27,490
so<font color="#CCCCCC"> HP really pride itself on the</font>

736
00:31:25,360 --> 00:31:30,809
printing speed of the printers but not

737
00:31:27,490 --> 00:31:33,220
on the<font color="#E5E5E5"> network speed after many</font>

738
00:31:30,809 --> 00:31:36,700
<font color="#E5E5E5">optimization rounds we managed to reduce</font>

739
00:31:33,220 --> 00:31:40,960
<font color="#E5E5E5">the exploit time to roughly</font><font color="#CCCCCC"> seven</font>

740
00:31:36,700 --> 00:31:43,480
minutes<font color="#E5E5E5"> so you start the exploit you</font>

741
00:31:40,960 --> 00:31:46,900
wait and after seven minutes<font color="#CCCCCC"> you have</font>

742
00:31:43,480 --> 00:31:50,260
your exploit and here<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> stock of good</font>

743
00:31:46,900 --> 00:31:53,110
luck ended<font color="#E5E5E5"> because we had the side</font>

744
00:31:50,260 --> 00:31:54,309
effect<font color="#E5E5E5"> in our exploit and after two to</font>

745
00:31:53,110 --> 00:31:56,889
<font color="#E5E5E5">ten minutes</font>

746
00:31:54,309 --> 00:31:58,870
<font color="#E5E5E5">the printer will crash and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> means</font>

747
00:31:56,890 --> 00:32:01,929
we'll need to wait an additional<font color="#CCCCCC"> seven</font>

748
00:31:58,870 --> 00:32:05,379
minutes<font color="#E5E5E5"> we'll have two minutes to debug</font>

749
00:32:01,929 --> 00:32:07,360
it<font color="#E5E5E5"> and then it will crash again so we're</font>

750
00:32:05,380 --> 00:32:12,130
<font color="#E5E5E5">waiting a lot we waited a lot of seven</font>

751
00:32:07,360 --> 00:32:14,408
<font color="#E5E5E5">minutes in our research if we recall we</font>

752
00:32:12,130 --> 00:32:15,970
wanted a debugger<font color="#E5E5E5"> so we could</font>

753
00:32:14,409 --> 00:32:18,340
dynamically reverse-engineer the film

754
00:32:15,970 --> 00:32:20,440
well we wanted<font color="#E5E5E5"> to read</font><font color="#CCCCCC"> memory and write</font>

755
00:32:18,340 --> 00:32:21,789
memory and now we have a<font color="#E5E5E5"> debugging</font>

756
00:32:20,440 --> 00:32:24,490
vulnerability so we could<font color="#E5E5E5"> load a</font>

757
00:32:21,789 --> 00:32:26,379
debugger<font color="#E5E5E5"> we need to execute this</font>

758
00:32:24,490 --> 00:32:29,590
debugger so we'll need execute

759
00:32:26,380 --> 00:32:31,419
permissions and to load it<font color="#E5E5E5"> and the most</font>

760
00:32:29,590 --> 00:32:33,399
if<font color="#CCCCCC"> noted thing is</font><font color="#E5E5E5"> that we need</font><font color="#CCCCCC"> to</font>

761
00:32:31,419 --> 00:32:35,559
execute our debugger without<font color="#CCCCCC"> crashing</font>

762
00:32:33,400 --> 00:32:38,679
the<font color="#E5E5E5"> funeral because we want</font><font color="#CCCCCC"> the debugger</font>

763
00:32:35,559 --> 00:32:42,280
to run and in<font color="#CCCCCC"> favor to debug</font><font color="#E5E5E5"> and we want</font>

764
00:32:38,679 --> 00:32:44,380
them<font color="#CCCCCC"> to blend</font><font color="#E5E5E5"> inside the virtual</font><font color="#CCCCCC"> address</font>

765
00:32:42,280 --> 00:32:47,590
space of<font color="#E5E5E5"> the printer living happily</font>

766
00:32:44,380 --> 00:32:51,280
together we couldn't find any debugger

767
00:32:47,590 --> 00:32:54,399
that achieved these goals<font color="#CCCCCC"> so I did what</font>

768
00:32:51,280 --> 00:32:58,780
my<font color="#CCCCCC"> brother usually</font><font color="#E5E5E5"> tells me not</font><font color="#CCCCCC"> to do we</font>

769
00:32:54,400 --> 00:33:00,700
actually<font color="#CCCCCC"> wrote our own</font><font color="#E5E5E5"> debugger so this</font>

770
00:32:58,780 --> 00:33:02,918
is<font color="#CCCCCC"> Celt</font><font color="#E5E5E5"> Scout is an instruction based</font>

771
00:33:00,700 --> 00:33:05,169
debugger it supports Intel CPUs and arm

772
00:33:02,919 --> 00:33:07,330
CPUs because we have an album<font color="#CCCCCC"> printer</font>

773
00:33:05,169 --> 00:33:09,220
yeah as a prototype<font color="#E5E5E5"> we had a Linux</font>

774
00:33:07,330 --> 00:33:11,730
kernel driver and this time we're going

775
00:33:09,220 --> 00:33:14,110
<font color="#CCCCCC">to</font><font color="#E5E5E5"> use it in its in embedded mode</font>

776
00:33:11,730 --> 00:33:15,929
<font color="#E5E5E5">embedded mode we compile it to be fully</font>

777
00:33:14,110 --> 00:33:18,309
positioned in the<font color="#E5E5E5"> parent because we</font>

778
00:33:15,929 --> 00:33:19,600
essentially throw it<font color="#E5E5E5"> somewhere inside</font>

779
00:33:18,309 --> 00:33:21,490
the<font color="#E5E5E5"> framework and we expect it to</font>

780
00:33:19,600 --> 00:33:24,699
execute

781
00:33:21,490 --> 00:33:27,760
we equip it with useful<font color="#CCCCCC"> address spaces</font>

782
00:33:24,700 --> 00:33:30,760
like<font color="#E5E5E5"> mem copy socket by listen we find</font>

783
00:33:27,760 --> 00:33:34,110
using Ida<font color="#E5E5E5"> and</font><font color="#CCCCCC"> whenever twice to call</font>

784
00:33:30,760 --> 00:33:37,660
these functions<font color="#CCCCCC"> it goes to its own God</font>

785
00:33:34,110 --> 00:33:41,139
<font color="#CCCCCC">finds</font><font color="#E5E5E5"> the address and jumps to it so</font>

786
00:33:37,660 --> 00:33:43,809
<font color="#E5E5E5">after we compile it we use it in our</font>

787
00:33:41,140 --> 00:33:46,900
exploit<font color="#E5E5E5"> we jumped in we jump into this</font>

788
00:33:43,809 --> 00:33:48,970
blob<font color="#E5E5E5"> and it starts up</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> TCP server we</font>

789
00:33:46,900 --> 00:33:51,280
can<font color="#CCCCCC"> now connect to to send instructions</font>

790
00:33:48,970 --> 00:33:54,760
to read<font color="#CCCCCC"> memory to write memory</font><font color="#E5E5E5"> and</font>

791
00:33:51,280 --> 00:33:58,450
whatever we want<font color="#E5E5E5"> you can find Scout in a</font>

792
00:33:54,760 --> 00:34:00,250
github with the examples for<font color="#CCCCCC"> Linux</font>

793
00:33:58,450 --> 00:34:02,140
kernel driver and embedded mode<font color="#E5E5E5"> and</font>

794
00:34:00,250 --> 00:34:07,330
we're actually<font color="#E5E5E5"> using it for some cities</font>

795
00:34:02,140 --> 00:34:09,580
now so it's highly<font color="#E5E5E5"> recommended now that</font>

796
00:34:07,330 --> 00:34:11,710
we<font color="#E5E5E5"> read this point in our talk we</font>

797
00:34:09,580 --> 00:34:14,739
haven't<font color="#E5E5E5"> yet described to you how</font><font color="#CCCCCC"> effects</font>

798
00:34:11,710 --> 00:34:16,899
actually<font color="#CCCCCC"> works so</font><font color="#E5E5E5"> we with we've scaled</font>

799
00:34:14,739 --> 00:34:18,638
we dynamically<font color="#CCCCCC"> reverse-engineer</font><font color="#E5E5E5"> the film</font>

800
00:34:16,899 --> 00:34:22,060
<font color="#E5E5E5">we're and now we can actually describe</font>

801
00:34:18,639 --> 00:34:24,730
to you how effects<font color="#E5E5E5"> actually works in</font>

802
00:34:22,060 --> 00:34:27,369
order<font color="#CCCCCC"> to</font><font color="#E5E5E5"> set of facts we need a sending</font>

803
00:34:24,730 --> 00:34:29,830
machine we need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> send it</font><font color="#CCCCCC"> to some modem</font>

804
00:34:27,369 --> 00:34:32,770
the packets form the modem will be

805
00:34:29,830 --> 00:34:34,389
processed in the<font color="#E5E5E5"> CPU and afterwards the</font>

806
00:34:32,770 --> 00:34:39,540
data is going<font color="#CCCCCC"> to be processed and</font>

807
00:34:34,389 --> 00:34:42,659
probably printed<font color="#CCCCCC"> let's see how it starts</font>

808
00:34:39,540 --> 00:34:46,509
we start with<font color="#E5E5E5"> network introduction</font>

809
00:34:42,659 --> 00:34:49,270
probing and raging<font color="#CCCCCC"> take over Eliza echo</font>

810
00:34:46,510 --> 00:34:51,100
<font color="#E5E5E5">canceling more training and you actually</font>

811
00:34:49,270 --> 00:34:54,719
<font color="#E5E5E5">need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be quite familiar with these</font>

812
00:34:51,100 --> 00:34:54,719
<font color="#E5E5E5">steps because</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> sound</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> this</font>

813
00:34:54,980 --> 00:35:01,109
with these beeps we actually created<font color="#E5E5E5"> an</font>

814
00:34:58,859 --> 00:35:04,710
<font color="#CCCCCC">HDL seat tunnel through this tunnel</font>

815
00:35:01,109 --> 00:35:07,890
<font color="#E5E5E5">we're going to send our</font><font color="#CCCCCC"> t30</font><font color="#E5E5E5"> messages to</font>

816
00:35:04,710 --> 00:35:09,599
the<font color="#CCCCCC"> cpu in T 30 you have faced a</font><font color="#E5E5E5"> we</font>

817
00:35:07,890 --> 00:35:12,990
which<font color="#CCCCCC"> we send the caller idea which is</font>

818
00:35:09,599 --> 00:35:15,240
<font color="#CCCCCC">this wing in phase B you negotiate</font><font color="#E5E5E5"> the</font>

819
00:35:12,990 --> 00:35:16,879
capabilities so I send my capabilities

820
00:35:15,240 --> 00:35:19,379
and<font color="#E5E5E5"> received</font><font color="#CCCCCC"> apprentice capabilities</font>

821
00:35:16,880 --> 00:35:22,650
<font color="#CCCCCC">tracy is the important</font><font color="#E5E5E5"> step because you</font>

822
00:35:19,380 --> 00:35:25,319
<font color="#E5E5E5">actually send our</font><font color="#CCCCCC"> fax data line of the</font>

823
00:35:22,650 --> 00:35:27,930
line page of the page<font color="#E5E5E5"> in</font><font color="#CCCCCC"> phase B we</font>

824
00:35:25,319 --> 00:35:30,720
finish<font color="#CCCCCC"> I</font><font color="#E5E5E5"> send an ACK I receive an ACK</font>

825
00:35:27,930 --> 00:35:32,700
and that's it let<font color="#E5E5E5"> us now see how</font><font color="#CCCCCC"> a</font>

826
00:35:30,720 --> 00:35:35,430
<font color="#E5E5E5">normal black and white fax document is</font>

827
00:35:32,700 --> 00:35:37,259
going<font color="#CCCCCC"> to be sent for the protocol so</font><font color="#E5E5E5"> we</font>

828
00:35:35,430 --> 00:35:39,660
have our document<font color="#CCCCCC"> is going to be sent</font>

829
00:35:37,260 --> 00:35:42,240
over<font color="#E5E5E5"> the hdl-c tunnel using 230 messages</font>

830
00:35:39,660 --> 00:35:45,180
over<font color="#CCCCCC"> phase C and the</font><font color="#E5E5E5"> received document</font>

831
00:35:42,240 --> 00:35:48,049
is actually<font color="#E5E5E5"> the body of a tiff file</font>

832
00:35:45,180 --> 00:35:51,180
<font color="#E5E5E5">compressed in g3 g4 compressions</font>

833
00:35:48,049 --> 00:35:52,500
from our perspective<font color="#E5E5E5"> that's partial good</font>

834
00:35:51,180 --> 00:35:54,240
news<font color="#E5E5E5"> because there are many</font>

835
00:35:52,500 --> 00:35:57,240
vulnerabilities when parsing<font color="#CCCCCC"> TIFF</font>

836
00:35:54,240 --> 00:35:59,399
headers<font color="#E5E5E5"> and we only control the data of</font>

837
00:35:57,240 --> 00:36:01,200
the file<font color="#E5E5E5"> the headers themselves are</font>

838
00:35:59,400 --> 00:36:03,240
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> constructed by the printer</font>

839
00:36:01,200 --> 00:36:06,899
<font color="#CCCCCC">itself using messages from phase a and</font>

840
00:36:03,240 --> 00:36:11,009
phase B so we partially control<font color="#CCCCCC"> a tiff</font>

841
00:36:06,900 --> 00:36:14,700
file<font color="#E5E5E5"> and after</font><font color="#CCCCCC"> it's done</font><font color="#E5E5E5"> and ready that</font>

842
00:36:11,010 --> 00:36:16,529
the file is<font color="#CCCCCC"> going to be</font><font color="#E5E5E5"> printed like</font>

843
00:36:14,700 --> 00:36:19,799
every good<font color="#CCCCCC"> water call and here's gums</font>

844
00:36:16,529 --> 00:36:21,869
<font color="#E5E5E5">very interesting</font><font color="#CCCCCC"> t30 supports many</font>

845
00:36:19,799 --> 00:36:23,549
extensions<font color="#CCCCCC"> can</font><font color="#E5E5E5"> you guess what</font>

846
00:36:21,869 --> 00:36:28,619
interesting extensions there are in the

847
00:36:23,549 --> 00:36:31,288
protocol so<font color="#E5E5E5"> it was a security extension</font>

848
00:36:28,619 --> 00:36:34,859
but no one uses it so<font color="#E5E5E5"> the</font><font color="#CCCCCC"> other</font>

849
00:36:31,289 --> 00:36:36,990
extension is color extension actually

850
00:36:34,859 --> 00:36:39,480
<font color="#CCCCCC">you can send</font><font color="#E5E5E5"> colorful faxes</font><font color="#CCCCCC"> and the</font>

851
00:36:36,990 --> 00:36:42,299
<font color="#E5E5E5">British use it in hospitals for some</font>

852
00:36:39,480 --> 00:36:45,240
reason let's see how a fact that<font color="#E5E5E5"> you</font>

853
00:36:42,299 --> 00:36:48,690
have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> colorful</font><font color="#CCCCCC"> fax works</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> send a</font>

854
00:36:45,240 --> 00:36:51,479
document<font color="#CCCCCC"> for</font><font color="#E5E5E5"> hdl-c tunnel over</font><font color="#CCCCCC"> face</font><font color="#E5E5E5"> C</font>

855
00:36:48,690 --> 00:36:54,150
and the<font color="#CCCCCC"> received document is</font><font color="#E5E5E5"> actually a</font>

856
00:36:51,480 --> 00:36:56,309
<font color="#CCCCCC">jpg file this</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> you control the</font>

857
00:36:54,150 --> 00:36:58,529
header and the date<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the file</font><font color="#CCCCCC"> and we</font>

858
00:36:56,309 --> 00:37:01,289
<font color="#CCCCCC">can do whatever we want with</font><font color="#E5E5E5"> it and send</font>

859
00:36:58,529 --> 00:37:03,329
<font color="#E5E5E5">it for painting now that we know how</font><font color="#CCCCCC"> a</font>

860
00:37:01,289 --> 00:37:06,089
fax actually works<font color="#E5E5E5"> where should we look</font>

861
00:37:03,329 --> 00:37:07,710
for vulnerabilities<font color="#E5E5E5"> in it well we have</font>

862
00:37:06,089 --> 00:37:11,099
complicated<font color="#E5E5E5"> state machine</font>

863
00:37:07,710 --> 00:37:12,839
<font color="#CCCCCC">withstand</font><font color="#E5E5E5"> strings though several</font><font color="#CCCCCC"> fine</font>

864
00:37:11,099 --> 00:37:15,359
layers but the<font color="#CCCCCC"> most convenient layer is</font>

865
00:37:12,839 --> 00:37:17,960
duplicative<font color="#E5E5E5"> one and most importantly</font>

866
00:37:15,359 --> 00:37:20,759
<font color="#E5E5E5">JPEG because we control the entire file</font>

867
00:37:17,960 --> 00:37:22,650
<font color="#E5E5E5">we can if we look on a</font><font color="#CCCCCC"> JPEG file it</font>

868
00:37:20,760 --> 00:37:25,380
mainly consists of markers we<font color="#CCCCCC"> have a</font>

869
00:37:22,650 --> 00:37:27,119
start of<font color="#CCCCCC"> market application market we've</font>

870
00:37:25,380 --> 00:37:29,599
lengthened data more markers we've

871
00:37:27,119 --> 00:37:33,810
lengthened data and so<font color="#E5E5E5"> on and so on</font>

872
00:37:29,599 --> 00:37:35,520
<font color="#CCCCCC">if we</font><font color="#E5E5E5"> zoom in on</font><font color="#CCCCCC"> one such marker we can</font>

873
00:37:33,810 --> 00:37:36,960
see that in this<font color="#CCCCCC"> market we</font><font color="#E5E5E5"> have a</font>

874
00:37:35,520 --> 00:37:39,150
compression table<font color="#CCCCCC"> a four before</font>

875
00:37:36,960 --> 00:37:42,480
<font color="#E5E5E5">compression matrix for the exact</font>

876
00:37:39,150 --> 00:37:45,000
document we send we have a header length

877
00:37:42,480 --> 00:37:48,089
field for<font color="#CCCCCC"> before matrix and the data</font>

878
00:37:45,000 --> 00:37:52,140
itself<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> zoom</font><font color="#E5E5E5"> in a bit</font><font color="#CCCCCC"> deeper</font><font color="#E5E5E5"> we</font>

879
00:37:48,089 --> 00:37:53,910
can<font color="#CCCCCC"> see</font><font color="#E5E5E5"> that here we get the matrix we</font>

880
00:37:52,140 --> 00:37:56,609
sum up<font color="#CCCCCC"> all</font><font color="#E5E5E5"> of the values this matrix</font>

881
00:37:53,910 --> 00:37:59,399
<font color="#CCCCCC">should</font><font color="#E5E5E5"> be rather sparse with zeros ones</font>

882
00:37:56,609 --> 00:38:01,650
and twos<font color="#E5E5E5"> the accumulated value is going</font>

883
00:37:59,400 --> 00:38:03,780
<font color="#E5E5E5">to be a length field in this case</font><font color="#CCCCCC"> six</font>

884
00:38:01,650 --> 00:38:05,700
bytes<font color="#E5E5E5"> and six bytes are going to be</font>

885
00:38:03,780 --> 00:38:10,140
copied<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the data to a local small</font>

886
00:38:05,700 --> 00:38:11,669
stock buffer like this so if you can see

887
00:38:10,140 --> 00:38:14,250
the vocal ability at this point we were

888
00:38:11,670 --> 00:38:16,740
like what effects because what doesn't

889
00:38:14,250 --> 00:38:19,859
make<font color="#E5E5E5"> sense</font><font color="#CCCCCC"> we control</font><font color="#E5E5E5"> the entire header</font>

890
00:38:16,740 --> 00:38:22,799
<font color="#E5E5E5">if we put huge values in our</font><font color="#CCCCCC"> matrix like</font>

891
00:38:19,859 --> 00:38:26,930
so we'll have<font color="#E5E5E5"> a 4 kilobyte length field</font>

892
00:38:22,800 --> 00:38:29,160
<font color="#CCCCCC">copied into</font><font color="#E5E5E5"> a stack buffer 256 bytes</font>

893
00:38:26,930 --> 00:38:34,259
effectively having<font color="#E5E5E5"> a stack-based buffer</font>

894
00:38:29,160 --> 00:38:36,750
overflow<font color="#E5E5E5"> in a pointer it's a trivial</font>

895
00:38:34,260 --> 00:38:38,670
<font color="#E5E5E5">stack buffer overflow we have no bite</font>

896
00:38:36,750 --> 00:38:40,890
constraints<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can use whatever</font><font color="#E5E5E5"> we want</font>

897
00:38:38,670 --> 00:38:44,130
<font color="#CCCCCC">null by its non ASCII by</font><font color="#E5E5E5"> its whatever we</font>

898
00:38:40,890 --> 00:38:47,790
want<font color="#E5E5E5"> and</font><font color="#CCCCCC"> 4 kilobyte refusal control</font>

899
00:38:44,130 --> 00:38:49,740
later that's moving enough to exploit on

900
00:38:47,790 --> 00:38:51,089
this<font color="#E5E5E5"> point we had to</font><font color="#CCCCCC"> bypass several</font>

901
00:38:49,740 --> 00:38:54,379
<font color="#CCCCCC">operating system and security</font>

902
00:38:51,089 --> 00:38:57,930
<font color="#E5E5E5">mitigations now and not exactly it's</font>

903
00:38:54,380 --> 00:39:00,510
it's an<font color="#CCCCCC"> outdoors</font><font color="#E5E5E5"> fixed</font><font color="#CCCCCC"> art spaces no</font>

904
00:38:57,930 --> 00:39:04,430
Canaries<font color="#E5E5E5"> it's the ideas it's really</font>

905
00:39:00,510 --> 00:39:06,599
simple<font color="#CCCCCC"> we've got the CVS from HP 9.8</font>

906
00:39:04,430 --> 00:39:09,720
<font color="#CCCCCC">critical you should really perch</font><font color="#E5E5E5"> up</font>

907
00:39:06,599 --> 00:39:11,640
<font color="#CCCCCC">Windows now and here you can see the</font>

908
00:39:09,720 --> 00:39:13,500
<font color="#E5E5E5">response</font><font color="#CCCCCC"> received</font><font color="#E5E5E5"> from HP after we</font>

909
00:39:11,640 --> 00:39:15,990
worked with them<font color="#CCCCCC"> to catch</font><font color="#E5E5E5"> these</font>

910
00:39:13,500 --> 00:39:19,099
vulnerabilities<font color="#CCCCCC"> which is a good time</font><font color="#E5E5E5"> for</font>

911
00:39:15,990 --> 00:39:19,098
<font color="#CCCCCC">our know</font>

912
00:39:37,580 --> 00:39:40,659
[Music]

913
00:39:46,599 --> 00:39:51,859
<font color="#CCCCCC">taxes on slope yeah yeah</font>

914
00:39:48,910 --> 00:39:55,098
so from even a taker<font color="#CCCCCC"> of course we can</font>

915
00:39:51,859 --> 00:39:59,150
forge this easily<font color="#CCCCCC"> and now the printer is</font>

916
00:39:55,099 --> 00:40:01,699
receiving the<font color="#CCCCCC"> fax and processing it and</font>

917
00:39:59,150 --> 00:40:03,619
<font color="#E5E5E5">now it's obviously a color</font><font color="#CCCCCC"> colorful fax</font>

918
00:40:01,699 --> 00:40:06,079
<font color="#E5E5E5">and now we have full</font><font color="#CCCCCC"> control over the</font>

919
00:40:03,619 --> 00:40:07,910
<font color="#E5E5E5">printer so it's ours</font><font color="#CCCCCC"> but that's not</font>

920
00:40:06,079 --> 00:40:10,789
enough<font color="#E5E5E5"> because we want to show</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

921
00:40:07,910 --> 00:40:12,739
can propagate to<font color="#E5E5E5"> another computer so our</font>

922
00:40:10,789 --> 00:40:16,069
tax our malicious facts contained

923
00:40:12,739 --> 00:40:18,049
eternal blue in it<font color="#CCCCCC"> so once</font><font color="#E5E5E5"> any computer</font>

924
00:40:16,069 --> 00:40:20,359
is<font color="#CCCCCC"> connected to the network that the tax</font>

925
00:40:18,049 --> 00:40:24,279
now will recognize it and we<font color="#CCCCCC"> try</font><font color="#E5E5E5"> to</font>

926
00:40:20,359 --> 00:40:24,279
exploit it<font color="#E5E5E5"> and here you go</font>

927
00:40:30,720 --> 00:40:37,950
yeah yeah yeah so so<font color="#E5E5E5"> we've made it</font><font color="#CCCCCC"> after</font>

928
00:40:34,950 --> 00:40:40,470
<font color="#CCCCCC">all it was a long way some conclusions</font>

929
00:40:37,950 --> 00:40:41,850
we have to tell you<font color="#CCCCCC"> first PSTN seems to</font>

930
00:40:40,470 --> 00:40:44,700
still be<font color="#E5E5E5"> a valley the tech surface in</font>

931
00:40:41,850 --> 00:40:46,710
2018<font color="#E5E5E5"> facts</font><font color="#CCCCCC"> can be used as a gateway</font><font color="#E5E5E5"> to</font>

932
00:40:44,700 --> 00:40:48,600
internal networks<font color="#CCCCCC"> then olden outdated</font>

933
00:40:46,710 --> 00:40:51,510
protocols<font color="#E5E5E5"> probably not so good for you</font>

934
00:40:48,600 --> 00:40:53,250
so try<font color="#CCCCCC"> not to</font><font color="#E5E5E5"> use them if you can</font><font color="#CCCCCC"> what</font>

935
00:40:51,510 --> 00:40:55,950
<font color="#E5E5E5">can you do to defend yourself against</font>

936
00:40:53,250 --> 00:40:57,300
<font color="#E5E5E5">this catastrophe</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of things first</font>

937
00:40:55,950 --> 00:40:59,850
<font color="#E5E5E5">of all you can</font><font color="#CCCCCC"> patch your printer's as</font>

938
00:40:57,300 --> 00:41:02,340
we all said this link will you know just

939
00:40:59,850 --> 00:41:05,850
tell you<font color="#E5E5E5"> if your printer</font><font color="#CCCCCC"> is multiple</font><font color="#E5E5E5"> by</font>

940
00:41:02,340 --> 00:41:07,920
<font color="#CCCCCC">the</font><font color="#E5E5E5"> way every HP inkjet or</font><font color="#CCCCCC"> obviously</font>

941
00:41:05,850 --> 00:41:09,540
<font color="#E5E5E5">printer is vulnerable to this thing</font>

942
00:41:07,920 --> 00:41:13,320
that's the biggest line<font color="#CCCCCC"> of printers from</font>

943
00:41:09,540 --> 00:41:15,150
HP over<font color="#E5E5E5"> I think 200 300 300 300 models</font>

944
00:41:13,320 --> 00:41:19,050
are vulnerable to<font color="#E5E5E5"> this thing so really</font>

945
00:41:15,150 --> 00:41:20,430
going update<font color="#CCCCCC"> another another</font><font color="#E5E5E5"> thing I can</font>

946
00:41:19,050 --> 00:41:24,180
tell<font color="#E5E5E5"> you</font><font color="#CCCCCC"> is if you</font><font color="#E5E5E5"> don't need facts</font>

947
00:41:20,430 --> 00:41:26,910
<font color="#E5E5E5">don't use it and also if you do need to</font>

948
00:41:24,180 --> 00:41:28,830
use<font color="#CCCCCC"> fax</font><font color="#E5E5E5"> after all try and make sure your</font>

949
00:41:26,910 --> 00:41:30,779
printers I<font color="#E5E5E5"> cannot segregate it from the</font>

950
00:41:28,830 --> 00:41:32,310
<font color="#E5E5E5">rest of the network</font><font color="#CCCCCC"> so you know even</font><font color="#E5E5E5"> if</font>

951
00:41:30,780 --> 00:41:33,690
somebody<font color="#E5E5E5"> takes off with the printers it</font>

952
00:41:32,310 --> 00:41:35,520
will just be confined to<font color="#E5E5E5"> the printers</font>

953
00:41:33,690 --> 00:41:38,910
<font color="#CCCCCC">and won't be able</font><font color="#E5E5E5"> to take over your</font>

954
00:41:35,520 --> 00:41:41,100
entire<font color="#E5E5E5"> network</font><font color="#CCCCCC"> so guys these are really</font>

955
00:41:38,910 --> 00:41:42,839
good suggestions<font color="#CCCCCC"> all of them but really</font>

956
00:41:41,100 --> 00:41:47,540
<font color="#E5E5E5">the best suggestion I</font><font color="#CCCCCC"> have to give you</font>

957
00:41:42,840 --> 00:41:47,540
<font color="#E5E5E5">today</font><font color="#CCCCCC"> is please stop using sax</font>

958
00:41:52,230 --> 00:41:58,770
thank you thank you just just one<font color="#E5E5E5"> second</font>

959
00:41:56,400 --> 00:42:00,510
before we finish<font color="#E5E5E5"> this was a long way a</font>

960
00:41:58,770 --> 00:42:02,130
<font color="#CCCCCC">long journey and</font><font color="#E5E5E5"> through this journey we</font>

961
00:42:00,510 --> 00:42:04,440
had some very good<font color="#CCCCCC"> friends that helped</font>

962
00:42:02,130 --> 00:42:08,010
us a lot along the<font color="#E5E5E5"> way</font><font color="#CCCCCC"> physically</font>

963
00:42:04,440 --> 00:42:10,410
<font color="#E5E5E5">mentally technically so we must mention</font>

964
00:42:08,010 --> 00:42:12,150
them these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> guys here some of</font>

965
00:42:10,410 --> 00:42:17,250
<font color="#E5E5E5">them are in the crowd so they deserve</font>

966
00:42:12,150 --> 00:42:19,859
<font color="#E5E5E5">some some claps and one special</font><font color="#CCCCCC"> guy at</font>

967
00:42:17,250 --> 00:42:23,579
the<font color="#E5E5E5"> telecast is Ian I live now and he</font>

968
00:42:19,859 --> 00:42:25,410
<font color="#E5E5E5">also deserves this</font><font color="#CCCCCC"> and that's it</font>

969
00:42:23,579 --> 00:42:28,020
basically guys so if you<font color="#E5E5E5"> want to follow</font>

970
00:42:25,410 --> 00:42:32,240
more<font color="#CCCCCC"> of a warp</font><font color="#E5E5E5"> you can find us here</font>

971
00:42:28,020 --> 00:42:32,240
follow us<font color="#E5E5E5"> thank you</font><font color="#CCCCCC"> very much</font>

972
00:42:42,380 --> 00:42:47,269
we have<font color="#E5E5E5"> five minutes for Q&A so</font><font color="#CCCCCC"> please</font>

973
00:42:45,259 --> 00:42:49,309
line up at the microphones if<font color="#E5E5E5"> you wanna</font>

974
00:42:47,269 --> 00:42:52,129
leave now<font color="#CCCCCC"> please do it</font><font color="#E5E5E5"> to your right</font>

975
00:42:49,309 --> 00:42:53,869
side<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> side from the stage is the</font>

976
00:42:52,130 --> 00:42:55,849
left<font color="#E5E5E5"> side but for you it's the right</font>

977
00:42:53,869 --> 00:42:56,869
side so<font color="#E5E5E5"> please line up at the</font>

978
00:42:55,849 --> 00:43:36,140
microphones

979
00:42:56,869 --> 00:43:39,859
I think<font color="#CCCCCC"> microphone so basically those</font>

980
00:43:36,140 --> 00:43:42,710
services<font color="#CCCCCC"> use t30 as</font><font color="#E5E5E5"> well we look at</font><font color="#CCCCCC"> that</font>

981
00:43:39,859 --> 00:43:44,598
frankly<font color="#E5E5E5"> we had so much work</font><font color="#CCCCCC"> to do with</font>

982
00:43:42,710 --> 00:43:47,499
the<font color="#E5E5E5"> printer that we didn't look at any</font>

983
00:43:44,599 --> 00:43:50,809
other printers or any other services<font color="#CCCCCC"> but</font>

984
00:43:47,499 --> 00:43:52,700
I can't say for sure<font color="#CCCCCC"> but</font><font color="#E5E5E5"> if you're</font>

985
00:43:50,809 --> 00:43:55,420
looking<font color="#E5E5E5"> for vulnerabilities</font><font color="#CCCCCC"> I would</font>

986
00:43:52,700 --> 00:43:58,390
recommend to<font color="#CCCCCC"> go look there as well</font>

987
00:43:55,420 --> 00:44:02,029
great microphone number<font color="#E5E5E5"> five please</font>

988
00:43:58,390 --> 00:44:06,739
what can you disclose about<font color="#E5E5E5"> the data</font>

989
00:44:02,029 --> 00:44:09,049
that's sitting<font color="#CCCCCC"> URL can you disclose</font>

990
00:44:06,739 --> 00:44:12,460
<font color="#E5E5E5">about the machines that are knocking on</font>

991
00:44:09,049 --> 00:44:15,170
your<font color="#CCCCCC"> Royal to take you want</font><font color="#E5E5E5"> to perform</font>

992
00:44:12,460 --> 00:44:19,140
<font color="#CCCCCC">there are a lot of HP printers out there</font>

993
00:44:15,170 --> 00:44:19,140
[Laughter]

994
00:44:19,150 --> 00:44:26,230
<font color="#E5E5E5">that's all I</font><font color="#CCCCCC"> can sorry</font>

995
00:44:23,560 --> 00:44:36,700
so we have one<font color="#E5E5E5"> question from</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> signal</font>

996
00:44:26,230 --> 00:44:38,830
<font color="#CCCCCC">angel</font><font color="#E5E5E5"> please</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> try to use the data we</font>

997
00:44:36,700 --> 00:44:42,370
<font color="#CCCCCC">think it's disabled</font><font color="#E5E5E5"> from the factory</font>

998
00:44:38,830 --> 00:44:45,069
lines<font color="#CCCCCC"> it was too much</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> so we decided</font>

999
00:44:42,370 --> 00:44:47,980
to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> VINs IV it's a good</font>

1000
00:44:45,070 --> 00:44:50,200
vulnerability<font color="#E5E5E5"> once we have</font><font color="#CCCCCC"> devil's IV</font>

1001
00:44:47,980 --> 00:44:54,580
and<font color="#E5E5E5"> we can use scout scout is more than</font>

1002
00:44:50,200 --> 00:44:58,540
<font color="#CCCCCC">enough for debugging essentially after</font>

1003
00:44:54,580 --> 00:45:01,509
we used the<font color="#E5E5E5"> JPEG of vulnerability and we</font>

1004
00:44:58,540 --> 00:45:03,730
<font color="#E5E5E5">loaded up scout scout</font><font color="#CCCCCC"> survived</font><font color="#E5E5E5"> for weeks</font>

1005
00:45:01,510 --> 00:45:07,780
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> pointer without</font><font color="#E5E5E5"> any crash so</font>

1006
00:45:03,730 --> 00:45:09,910
that's more<font color="#E5E5E5"> than enough</font><font color="#CCCCCC"> great we go with</font>

1007
00:45:07,780 --> 00:45:12,640
microphone number<font color="#CCCCCC"> two please yes so</font>

1008
00:45:09,910 --> 00:45:14,319
thank you for<font color="#E5E5E5"> the nice talk and I think</font>

1009
00:45:12,640 --> 00:45:17,230
you're<font color="#CCCCCC"> completely right we can't have</font>

1010
00:45:14,320 --> 00:45:20,590
many problems<font color="#E5E5E5"> with legacy protocols</font><font color="#CCCCCC"> we</font>

1011
00:45:17,230 --> 00:45:23,410
only<font color="#E5E5E5"> think I do not really get was the</font>

1012
00:45:20,590 --> 00:45:26,560
<font color="#CCCCCC">part how you then</font><font color="#E5E5E5"> can automatically</font>

1013
00:45:23,410 --> 00:45:29,649
successfully take your laptop<font color="#E5E5E5"> on the</font>

1014
00:45:26,560 --> 00:45:34,090
<font color="#E5E5E5">network my point would</font><font color="#CCCCCC"> be my laptop is</font>

1015
00:45:29,650 --> 00:45:36,370
as secure<font color="#CCCCCC"> as I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to the L so you</font>

1016
00:45:34,090 --> 00:45:39,160
would not<font color="#E5E5E5"> be able with your HP printer</font>

1017
00:45:36,370 --> 00:45:42,339
to start the calculator<font color="#E5E5E5"> on my Linux or</font>

1018
00:45:39,160 --> 00:45:44,410
even my<font color="#CCCCCC"> Windows well hey yo</font><font color="#E5E5E5"> wait your</font>

1019
00:45:42,340 --> 00:45:47,950
laptop might be secure I'm sure it is

1020
00:45:44,410 --> 00:45:50,680
<font color="#CCCCCC">but many others are not we try to show</font>

1021
00:45:47,950 --> 00:45:52,930
this using<font color="#E5E5E5"> the eternal blue exploit as</font>

1022
00:45:50,680 --> 00:45:54,940
you know<font color="#CCCCCC"> wanna</font><font color="#E5E5E5"> cry stuff like that you</font>

1023
00:45:52,930 --> 00:45:56,859
<font color="#E5E5E5">know this thing created a lot of and</font>

1024
00:45:54,940 --> 00:46:00,460
there were patches<font color="#E5E5E5"> out there and still</font>

1025
00:45:56,860 --> 00:46:01,840
it was so we're not here to attack

1026
00:46:00,460 --> 00:46:03,490
<font color="#E5E5E5">anyone we're just saying that</font>

1027
00:46:01,840 --> 00:46:04,780
theoretically if somebody wants to<font color="#E5E5E5"> get</font>

1028
00:46:03,490 --> 00:46:06,520
into<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network and he has a</font>

1029
00:46:04,780 --> 00:46:08,860
vulnerability<font color="#E5E5E5"> that you're maybe</font><font color="#CCCCCC"> not</font>

1030
00:46:06,520 --> 00:46:12,580
patched or secured<font color="#CCCCCC"> fax</font><font color="#E5E5E5"> would be a bad</font>

1031
00:46:08,860 --> 00:46:16,320
<font color="#CCCCCC">idea but</font><font color="#E5E5E5"> it was not it was nothing which</font>

1032
00:46:12,580 --> 00:46:18,250
was part of<font color="#E5E5E5"> torrent of it sorry</font>

1033
00:46:16,320 --> 00:46:22,020
<font color="#E5E5E5">unfortunately we don't have more time</font>

1034
00:46:18,250 --> 00:46:24,350
<font color="#CCCCCC">for Q&A so thank you again</font><font color="#E5E5E5"> very much</font>

1035
00:46:22,020 --> 00:46:28,740
thank you

1036
00:46:24,350 --> 00:46:30,009
[Music]

1037
00:46:28,740 --> 00:46:31,580
it's really<font color="#E5E5E5"> nice</font>

1038
00:46:30,010 --> 00:46:41,890
[Applause]

1039
00:46:31,580 --> 00:46:41,890
[Music]

1040
00:46:43,960 --> 00:46:56,620
[Music]

