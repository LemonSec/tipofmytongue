1
00:00:01,500 --> 00:00:10,520
[Music]

2
00:00:07,350 --> 00:00:10,520
[Applause]

3
00:00:12,639 --> 00:00:17,439
now our next talk

4
00:00:14,080 --> 00:00:19,600
is hacking german elections

5
00:00:17,440 --> 00:00:21,520
insecure electronic voting count vote

6
00:00:19,600 --> 00:00:25,039
counting how it returned and

7
00:00:21,520 --> 00:00:28,080
why you don't even know about it

8
00:00:25,039 --> 00:00:28,800
um for the germans listening here do you

9
00:00:28,080 --> 00:00:31,839
notice

10
00:00:28,800 --> 00:00:34,559
did you notice that in germany

11
00:00:31,840 --> 00:00:35,120
voting became more electronic recently

12
00:00:34,559 --> 00:00:36,879
um

13
00:00:35,120 --> 00:00:38,399
in case you're promoting family i do

14
00:00:36,880 --> 00:00:40,079
live in germany and i did not notice

15
00:00:38,399 --> 00:00:42,640
that myself

16
00:00:40,079 --> 00:00:44,079
however both of our speakers volunteered

17
00:00:42,640 --> 00:00:47,360
as election workers in germany

18
00:00:44,079 --> 00:00:50,640
and research on the topic of security

19
00:00:47,360 --> 00:00:52,399
for um elections and they promised to

20
00:00:50,640 --> 00:00:54,559
tell us

21
00:00:52,399 --> 00:00:56,719
how this can be how elections can be

22
00:00:54,559 --> 00:00:59,280
made more secure again

23
00:00:56,719 --> 00:01:01,039
our speakers are tobias he's an i.t

24
00:00:59,280 --> 00:01:03,440
security researcher focusing on

25
00:01:01,039 --> 00:01:03,680
offensive security automotive security

26
00:01:03,440 --> 00:01:06,640
and

27
00:01:03,680 --> 00:01:08,560
capture flight challenges and johannes

28
00:01:06,640 --> 00:01:10,720
he's a postdoctoral

29
00:01:08,560 --> 00:01:12,880
i.t security researcher and both work

30
00:01:10,720 --> 00:01:17,920
together at the fraunhofer

31
00:01:12,880 --> 00:01:17,920
isak institute enjoy the talk

32
00:01:24,479 --> 00:01:29,520
hello and welcome to our presentation on

33
00:01:27,200 --> 00:01:31,759
hacking german elections

34
00:01:29,520 --> 00:01:33,840
insecure electronic mode counting how it

35
00:01:31,759 --> 00:01:34,560
return and why you don't even know about

36
00:01:33,840 --> 00:01:37,360
it

37
00:01:34,560 --> 00:01:38,560
my name is johannes ubermeier and i'm to

38
00:01:37,360 --> 00:01:41,119
be as marvel

39
00:01:38,560 --> 00:01:43,280
we are both very much involved in

40
00:01:41,119 --> 00:01:44,320
elections in bavaria because we are

41
00:01:43,280 --> 00:01:47,280
election workers

42
00:01:44,320 --> 00:01:47,679
and often support here in germany and we

43
00:01:47,280 --> 00:01:51,439
are

44
00:01:47,680 --> 00:01:53,040
offensive id security researchers

45
00:01:51,439 --> 00:01:54,559
first of all we want to talk about the

46
00:01:53,040 --> 00:01:57,200
scope we are

47
00:01:54,560 --> 00:01:58,320
to presenting today we got our

48
00:01:57,200 --> 00:02:00,240
information and

49
00:01:58,320 --> 00:02:02,398
the software from today from the

50
00:02:00,240 --> 00:02:05,520
municipal elections in bavaria

51
00:02:02,399 --> 00:02:08,239
happening in the early 2020 and

52
00:02:05,520 --> 00:02:09,758
it was a computer-based wound counting

53
00:02:08,239 --> 00:02:12,080
technology

54
00:02:09,758 --> 00:02:13,279
so we were very concerned when we

55
00:02:12,080 --> 00:02:16,160
interacted with it

56
00:02:13,280 --> 00:02:19,840
and in the end we featured the questions

57
00:02:16,160 --> 00:02:19,840
are elections still secure

58
00:02:20,160 --> 00:02:23,599
next i present you the outline we are

59
00:02:22,239 --> 00:02:25,440
talking about today

60
00:02:23,599 --> 00:02:28,000
and first of all we are looking at the

61
00:02:25,440 --> 00:02:31,680
electronic vote counting system

62
00:02:28,000 --> 00:02:32,560
and next we identified some conceptual

63
00:02:31,680 --> 00:02:36,080
and practical

64
00:02:32,560 --> 00:02:38,640
issues with this technology afterwards

65
00:02:36,080 --> 00:02:40,560
we also inspected the software and found

66
00:02:38,640 --> 00:02:44,160
some insecurities

67
00:02:40,560 --> 00:02:47,280
and in the end we summary and conclude

68
00:02:44,160 --> 00:02:49,280
our presentation

69
00:02:47,280 --> 00:02:50,319
to understand why we need electronic

70
00:02:49,280 --> 00:02:52,400
vote counting

71
00:02:50,319 --> 00:02:54,560
let's just have a look at the voting

72
00:02:52,400 --> 00:02:57,760
ballot this voting palette

73
00:02:54,560 --> 00:03:00,800
is in its paper form about 1 meter wide

74
00:02:57,760 --> 00:03:02,480
and 50 centimeters high so that's a

75
00:03:00,800 --> 00:03:04,560
quite a large ballot with a lot of

76
00:03:02,480 --> 00:03:07,920
candidates let's just

77
00:03:04,560 --> 00:03:11,599
sum up the facts so we have a total

78
00:03:07,920 --> 00:03:13,518
of 599 candidates that are spread out

79
00:03:11,599 --> 00:03:16,640
over nine parties

80
00:03:13,519 --> 00:03:18,879
each citizen is allowed to cast up to 70

81
00:03:16,640 --> 00:03:21,599
votes in this election

82
00:03:18,879 --> 00:03:23,760
so that sounds simple but it gets even

83
00:03:21,599 --> 00:03:26,959
more complicated now because you can

84
00:03:23,760 --> 00:03:28,959
cast up to three votes per candidate

85
00:03:26,959 --> 00:03:31,280
and you can even choose multiple

86
00:03:28,959 --> 00:03:34,239
candidates of different parties

87
00:03:31,280 --> 00:03:35,680
up to your 70 votes and even if you

88
00:03:34,239 --> 00:03:38,560
decide yourself

89
00:03:35,680 --> 00:03:40,159
to vote for a single party you can still

90
00:03:38,560 --> 00:03:42,159
strike out candidates

91
00:03:40,159 --> 00:03:43,920
that you personally don't like and so

92
00:03:42,159 --> 00:03:45,280
they don't get any votes from your

93
00:03:43,920 --> 00:03:47,920
ballot

94
00:03:45,280 --> 00:03:49,040
that means this voting system gives a

95
00:03:47,920 --> 00:03:52,319
lot of power

96
00:03:49,040 --> 00:03:55,040
to the citizens and voting is fun

97
00:03:52,319 --> 00:03:56,958
however counting out those ballots is

98
00:03:55,040 --> 00:03:59,519
very difficult because you need

99
00:03:56,959 --> 00:04:00,879
to know a lot of special rules in this

100
00:03:59,519 --> 00:04:03,680
voting system

101
00:04:00,879 --> 00:04:04,640
to really count each ballot correctly

102
00:04:03,680 --> 00:04:07,040
that's the reason

103
00:04:04,640 --> 00:04:08,000
that a software such as ok mode has been

104
00:04:07,040 --> 00:04:10,159
developed

105
00:04:08,000 --> 00:04:12,159
ok vote is a typical software for

106
00:04:10,159 --> 00:04:13,679
elections that's also used in the

107
00:04:12,159 --> 00:04:16,880
polling stations

108
00:04:13,680 --> 00:04:18,160
for vote counting so ok mode has a quite

109
00:04:16,880 --> 00:04:21,279
large market share

110
00:04:18,160 --> 00:04:22,479
they say they have a like 75 percent in

111
00:04:21,279 --> 00:04:25,520
germany so that

112
00:04:22,479 --> 00:04:27,120
software is used in several states ok

113
00:04:25,520 --> 00:04:29,680
mode has several different

114
00:04:27,120 --> 00:04:30,560
modules for organizing election for

115
00:04:29,680 --> 00:04:33,840
example

116
00:04:30,560 --> 00:04:34,240
but what we will have a look at in this

117
00:04:33,840 --> 00:04:38,000
talk

118
00:04:34,240 --> 00:04:40,960
is only the vote counting module

119
00:04:38,000 --> 00:04:42,000
of ok vote where the election voters

120
00:04:40,960 --> 00:04:45,039
insert

121
00:04:42,000 --> 00:04:48,160
each paper ballot and manually

122
00:04:45,040 --> 00:04:50,720
type it in all the votes in each ballot

123
00:04:48,160 --> 00:04:51,520
and then they are stored in the computer

124
00:04:50,720 --> 00:04:54,080
system

125
00:04:51,520 --> 00:04:54,799
so and the task of otay vote is to

126
00:04:54,080 --> 00:04:57,280
process

127
00:04:54,800 --> 00:04:58,160
each pallet to count the votes to find

128
00:04:57,280 --> 00:05:00,559
out if the

129
00:04:58,160 --> 00:05:02,400
ballot is correct then it stores all the

130
00:05:00,560 --> 00:05:04,400
ballots into its database

131
00:05:02,400 --> 00:05:06,960
and finally it does some magic and

132
00:05:04,400 --> 00:05:09,599
computes the final result

133
00:05:06,960 --> 00:05:11,520
so this sounds quite similar to what a

134
00:05:09,600 --> 00:05:15,280
voting machine does

135
00:05:11,520 --> 00:05:18,400
but wait a moment voting machines

136
00:05:15,280 --> 00:05:21,919
in my germany wait

137
00:05:18,400 --> 00:05:23,599
that's illegal is it really illegal

138
00:05:21,919 --> 00:05:25,680
let's have a look at the legal

139
00:05:23,600 --> 00:05:29,280
regulations about them

140
00:05:25,680 --> 00:05:32,320
so yes in 2009 there was an

141
00:05:29,280 --> 00:05:33,840
important decision by the german federal

142
00:05:32,320 --> 00:05:35,919
constitutional court

143
00:05:33,840 --> 00:05:38,239
and they said that the use of working

144
00:05:35,919 --> 00:05:41,120
computers in the 2005 bundestag

145
00:05:38,240 --> 00:05:42,160
election was unconstitutional because

146
00:05:41,120 --> 00:05:44,000
for example

147
00:05:42,160 --> 00:05:46,000
devoting computers were not

148
00:05:44,000 --> 00:05:49,120
transparently enough

149
00:05:46,000 --> 00:05:51,520
so that is very

150
00:05:49,120 --> 00:05:53,360
similar to that but we have also found

151
00:05:51,520 --> 00:05:55,680
for the municipal elections

152
00:05:53,360 --> 00:05:56,960
but wait we are here talking about the

153
00:05:55,680 --> 00:05:59,520
bundesliga selection

154
00:05:56,960 --> 00:06:01,120
but this is the municipal election and

155
00:05:59,520 --> 00:06:02,799
we have different rules for the

156
00:06:01,120 --> 00:06:06,400
municipal elections

157
00:06:02,800 --> 00:06:10,240
for example there is the glk rwo

158
00:06:06,400 --> 00:06:12,638
that's the mind and bayern

159
00:06:10,240 --> 00:06:15,199
which basically translates to the

160
00:06:12,639 --> 00:06:18,800
bavarian municipal election rules

161
00:06:15,199 --> 00:06:22,080
and those rules say that we are indeed

162
00:06:18,800 --> 00:06:24,080
not allowed to use a computer for voting

163
00:06:22,080 --> 00:06:25,359
but computers can be used for both

164
00:06:24,080 --> 00:06:28,479
counting

165
00:06:25,360 --> 00:06:31,199
so and in this situation i would expect

166
00:06:28,479 --> 00:06:32,639
that we have some sort of security

167
00:06:31,199 --> 00:06:36,080
requirements there

168
00:06:32,639 --> 00:06:36,400
in those regulations but i try to find

169
00:06:36,080 --> 00:06:38,479
them

170
00:06:36,400 --> 00:06:40,560
and i was really surprised they are

171
00:06:38,479 --> 00:06:43,599
exactly zero

172
00:06:40,560 --> 00:06:45,919
so if there are no legal requirements

173
00:06:43,600 --> 00:06:48,160
are there at least any software side

174
00:06:45,919 --> 00:06:48,719
requirements or certifications for ok

175
00:06:48,160 --> 00:06:52,000
vote

176
00:06:48,720 --> 00:06:54,160
which promised some security yes there

177
00:06:52,000 --> 00:06:56,479
are so i had a look at the website

178
00:06:54,160 --> 00:06:58,479
and i saw this nice little paragraph

179
00:06:56,479 --> 00:07:01,758
here and it says

180
00:06:58,479 --> 00:07:04,639
elections with security and

181
00:07:01,759 --> 00:07:05,199
doing the development of okay vote they

182
00:07:04,639 --> 00:07:09,120
put the

183
00:07:05,199 --> 00:07:11,720
highest emphasis on the topic security

184
00:07:09,120 --> 00:07:14,080
they follow the bsi and ovs

185
00:07:11,720 --> 00:07:16,400
recommendations on security

186
00:07:14,080 --> 00:07:19,280
and they have a certified data center

187
00:07:16,400 --> 00:07:22,159
with very high security standards

188
00:07:19,280 --> 00:07:23,919
and how does it look in practice well i

189
00:07:22,160 --> 00:07:24,240
i rather would not show you this here

190
00:07:23,919 --> 00:07:27,120
it's

191
00:07:24,240 --> 00:07:28,560
it's really scary this was what i have

192
00:07:27,120 --> 00:07:30,240
seen here

193
00:07:28,560 --> 00:07:32,479
when i walked in the direction room this

194
00:07:30,240 --> 00:07:33,680
is not a stop photo i took this photo

195
00:07:32,479 --> 00:07:35,680
myself

196
00:07:33,680 --> 00:07:37,199
and this is the reality so i walked up

197
00:07:35,680 --> 00:07:40,479
to the guys and said

198
00:07:37,199 --> 00:07:42,479
well shall we really use

199
00:07:40,479 --> 00:07:44,159
these computers to counter the election

200
00:07:42,479 --> 00:07:46,400
and say that yes that are the computers

201
00:07:44,160 --> 00:07:49,199
that are available here

202
00:07:46,400 --> 00:07:50,638
so and i pray to god that this for some

203
00:07:49,199 --> 00:07:53,440
reason does not work out

204
00:07:50,639 --> 00:07:54,000
and windows xp did not disappoint me

205
00:07:53,440 --> 00:07:56,479
because

206
00:07:54,000 --> 00:07:57,440
when i tried to start the software it

207
00:07:56,479 --> 00:08:00,400
failed

208
00:07:57,440 --> 00:08:00,879
because that's our 32-bit system and ok

209
00:08:00,400 --> 00:08:04,080
mode

210
00:08:00,879 --> 00:08:06,000
needs 64 bits so

211
00:08:04,080 --> 00:08:07,120
yeah that was that was great so we did

212
00:08:06,000 --> 00:08:10,879
not use that

213
00:08:07,120 --> 00:08:12,479
windows xp machine so instead we had

214
00:08:10,879 --> 00:08:14,560
to search for another machine and came

215
00:08:12,479 --> 00:08:15,039
across this one here that's a windows 10

216
00:08:14,560 --> 00:08:17,680
machine

217
00:08:15,039 --> 00:08:18,400
that's fine however uh it has an

218
00:08:17,680 --> 00:08:21,599
outdated

219
00:08:18,400 --> 00:08:23,758
virus scanner so well it's

220
00:08:21,599 --> 00:08:25,520
it's better than nothing so this machine

221
00:08:23,759 --> 00:08:28,479
was used instead then

222
00:08:25,520 --> 00:08:30,318
so but just let's keep in mind what they

223
00:08:28,479 --> 00:08:33,279
are promising us

224
00:08:30,319 --> 00:08:34,880
election the security we really doubt

225
00:08:33,279 --> 00:08:36,958
that

226
00:08:34,880 --> 00:08:38,958
let's uh now look at the idea

227
00:08:36,958 --> 00:08:40,319
environment and why it came to that

228
00:08:38,958 --> 00:08:42,319
situation

229
00:08:40,320 --> 00:08:44,159
so first of all this is not fully the

230
00:08:42,320 --> 00:08:46,880
fault of okay vote

231
00:08:44,159 --> 00:08:47,920
because it's the task for the local

232
00:08:46,880 --> 00:08:50,800
administration

233
00:08:47,920 --> 00:08:51,439
to provide hardware for vote counting

234
00:08:50,800 --> 00:08:56,000
and the

235
00:08:51,440 --> 00:08:57,920
akdb so the vendors of okay vote say

236
00:08:56,000 --> 00:08:59,839
that they recommend to use secure

237
00:08:57,920 --> 00:09:02,959
administration computers

238
00:08:59,839 --> 00:09:04,959
that's fine so far but we simply don't

239
00:09:02,959 --> 00:09:06,959
have enough secure administration

240
00:09:04,959 --> 00:09:08,719
computers for that purpose

241
00:09:06,959 --> 00:09:10,479
so for example in the town where i'm

242
00:09:08,720 --> 00:09:12,880
from we needed around

243
00:09:10,480 --> 00:09:14,160
eight computers to count out this

244
00:09:12,880 --> 00:09:16,160
election

245
00:09:14,160 --> 00:09:17,519
and we simply did not even have nothing

246
00:09:16,160 --> 00:09:21,439
a town hall

247
00:09:17,519 --> 00:09:23,519
and what's even more the election room

248
00:09:21,440 --> 00:09:25,519
it was in a school and there are already

249
00:09:23,519 --> 00:09:28,480
school pcs available there

250
00:09:25,519 --> 00:09:29,760
so they were just using the screw pcs so

251
00:09:28,480 --> 00:09:32,720
and those were even

252
00:09:29,760 --> 00:09:34,560
elementary school computers so i'm not

253
00:09:32,720 --> 00:09:37,200
really sure about if all the

254
00:09:34,560 --> 00:09:38,880
pupils know which link they are allowed

255
00:09:37,200 --> 00:09:40,800
to click and which one they should

256
00:09:38,880 --> 00:09:43,920
rather not click on

257
00:09:40,800 --> 00:09:45,279
so this systems might be insecure they

258
00:09:43,920 --> 00:09:48,240
might be more rewritten

259
00:09:45,279 --> 00:09:50,080
and even it is possible that someone had

260
00:09:48,240 --> 00:09:54,080
manipulated them in advance

261
00:09:50,080 --> 00:09:56,720
we cannot really exclude that however

262
00:09:54,080 --> 00:09:57,200
i don't want to blame the administration

263
00:09:56,720 --> 00:09:59,680
here

264
00:09:57,200 --> 00:10:01,040
because it did a great job in organizing

265
00:09:59,680 --> 00:10:03,199
this election is a

266
00:10:01,040 --> 00:10:04,240
it's really much to do for them and they

267
00:10:03,200 --> 00:10:07,040
did really well

268
00:10:04,240 --> 00:10:07,920
so everything that worked out well at

269
00:10:07,040 --> 00:10:10,240
the end

270
00:10:07,920 --> 00:10:11,279
however they are no i.t security

271
00:10:10,240 --> 00:10:14,720
specialists

272
00:10:11,279 --> 00:10:17,920
and we cannot demand from them that they

273
00:10:14,720 --> 00:10:20,079
know each detail on how to set up a

274
00:10:17,920 --> 00:10:20,640
system correctly and what are the risks

275
00:10:20,079 --> 00:10:22,719
that are

276
00:10:20,640 --> 00:10:24,480
associated with insecure computer

277
00:10:22,720 --> 00:10:27,920
systems in elections

278
00:10:24,480 --> 00:10:28,240
that's just not that job so however we

279
00:10:27,920 --> 00:10:30,800
still

280
00:10:28,240 --> 00:10:31,360
ended up with untrustworthy systems here

281
00:10:30,800 --> 00:10:34,079
because

282
00:10:31,360 --> 00:10:34,560
as we have seen before there are no

283
00:10:34,079 --> 00:10:37,760
legal

284
00:10:34,560 --> 00:10:41,279
regulations against that now let's see

285
00:10:37,760 --> 00:10:44,560
how we create a digital result exactly

286
00:10:41,279 --> 00:10:47,760
so we went to our voting places

287
00:10:44,560 --> 00:10:50,719
we were presented with each one

288
00:10:47,760 --> 00:10:52,000
got a pc and we got the ballot stack we

289
00:10:50,720 --> 00:10:54,399
had to count and then

290
00:10:52,000 --> 00:10:55,360
enter the results so johannes is team

291
00:10:54,399 --> 00:10:58,640
two

292
00:10:55,360 --> 00:11:01,200
and i was team one and we started

293
00:10:58,640 --> 00:11:02,959
entering the ballots in the pc and from

294
00:11:01,200 --> 00:11:06,399
this on david ditches ois

295
00:11:02,959 --> 00:11:08,399
team one in green and team two in blue

296
00:11:06,399 --> 00:11:10,079
as soon as i was finished entering my

297
00:11:08,399 --> 00:11:12,640
ballots i put them

298
00:11:10,079 --> 00:11:13,760
on a usb drive and handed them over to

299
00:11:12,640 --> 00:11:17,439
team one

300
00:11:13,760 --> 00:11:20,480
exactly i imported these votes because

301
00:11:17,440 --> 00:11:22,880
i was the master machine at this time

302
00:11:20,480 --> 00:11:23,760
and the okay vote software then

303
00:11:22,880 --> 00:11:26,880
finalized

304
00:11:23,760 --> 00:11:30,079
these voting elections and exported the

305
00:11:26,880 --> 00:11:32,079
results finally again on an usb stick

306
00:11:30,079 --> 00:11:35,359
and these were then delivered on for

307
00:11:32,079 --> 00:11:37,439
further processing

308
00:11:35,360 --> 00:11:40,160
what is the problem with that all first

309
00:11:37,440 --> 00:11:42,079
of all there's a lot of in transparency

310
00:11:40,160 --> 00:11:43,839
so for example the software that is

311
00:11:42,079 --> 00:11:46,560
being used for volt counting

312
00:11:43,839 --> 00:11:48,160
okay mode it's not an open source

313
00:11:46,560 --> 00:11:52,079
software it's closed source

314
00:11:48,160 --> 00:11:54,480
and nobody was able to analyze this yet

315
00:11:52,079 --> 00:11:55,199
so and since this is closed source

316
00:11:54,480 --> 00:11:57,760
software

317
00:11:55,200 --> 00:11:59,680
it is also very hard to understand how

318
00:11:57,760 --> 00:12:00,959
the software works and if it really

319
00:11:59,680 --> 00:12:02,800
counts correctly

320
00:12:00,959 --> 00:12:04,479
because we have in the end we have

321
00:12:02,800 --> 00:12:07,040
hundreds of ballots there

322
00:12:04,480 --> 00:12:07,680
and it's really difficult to tell if

323
00:12:07,040 --> 00:12:10,800
they have

324
00:12:07,680 --> 00:12:13,439
indeed been counted correctly so

325
00:12:10,800 --> 00:12:14,399
and also we have seen this before there

326
00:12:13,440 --> 00:12:17,200
is no

327
00:12:14,399 --> 00:12:19,519
basis for a secure vote counting if we

328
00:12:17,200 --> 00:12:22,399
have possibly rigged computer system

329
00:12:19,519 --> 00:12:24,880
so we cannot exclude that someone has

330
00:12:22,399 --> 00:12:27,519
manipulated them three

331
00:12:24,880 --> 00:12:28,399
election-wise so if there is some

332
00:12:27,519 --> 00:12:30,720
manipulation

333
00:12:28,399 --> 00:12:31,600
this would hardly be detectable by a

334
00:12:30,720 --> 00:12:34,720
standard

335
00:12:31,600 --> 00:12:36,800
uh election worker so this means that

336
00:12:34,720 --> 00:12:40,000
the entire election process

337
00:12:36,800 --> 00:12:42,160
becomes very untransparent and hard

338
00:12:40,000 --> 00:12:44,160
to understand for a person who just

339
00:12:42,160 --> 00:12:47,360
wants to observe the election so

340
00:12:44,160 --> 00:12:50,959
that is strictly against the idea

341
00:12:47,360 --> 00:12:53,200
of a public counting of votes

342
00:12:50,959 --> 00:12:54,479
so now let's talk about the step that

343
00:12:53,200 --> 00:12:56,800
happens after

344
00:12:54,480 --> 00:12:58,399
where we finish counting in each of the

345
00:12:56,800 --> 00:13:00,079
teams

346
00:12:58,399 --> 00:13:02,000
so what do you do after you have

347
00:13:00,079 --> 00:13:03,359
exported the final election results how

348
00:13:02,000 --> 00:13:04,480
did they come to the central

349
00:13:03,360 --> 00:13:07,760
administration

350
00:13:04,480 --> 00:13:10,160
yeah i've just entered my vehicle and

351
00:13:07,760 --> 00:13:11,360
took the usb sticks in my pocket and

352
00:13:10,160 --> 00:13:14,880
drove

353
00:13:11,360 --> 00:13:17,279
to to the master pc but as you maybe

354
00:13:14,880 --> 00:13:18,000
know election day is always very busy

355
00:13:17,279 --> 00:13:20,880
day

356
00:13:18,000 --> 00:13:22,399
and my some teams are slower at counting

357
00:13:20,880 --> 00:13:25,279
some teams are faster

358
00:13:22,399 --> 00:13:27,519
so the master team doesn't know when

359
00:13:25,279 --> 00:13:29,600
these usb sticks arrive if they take

360
00:13:27,519 --> 00:13:31,600
two or three hours or half an hour they

361
00:13:29,600 --> 00:13:34,240
don't know really so i could just go

362
00:13:31,600 --> 00:13:34,639
and grab something to eat on my way or i

363
00:13:34,240 --> 00:13:37,120
can

364
00:13:34,639 --> 00:13:38,160
manipulate the votes i i mean deliver

365
00:13:37,120 --> 00:13:40,320
the votes

366
00:13:38,160 --> 00:13:42,399
and yeah in the end when they when i

367
00:13:40,320 --> 00:13:43,680
arrive at the master pc i just skip to

368
00:13:42,399 --> 00:13:45,360
my usb6 they

369
00:13:43,680 --> 00:13:48,000
enter it and they take the data that is

370
00:13:45,360 --> 00:13:49,920
stored on there and nothing else and

371
00:13:48,000 --> 00:13:52,800
afterwards they just uploaded

372
00:13:49,920 --> 00:13:54,000
the final results on the page now you

373
00:13:52,800 --> 00:13:56,800
might think

374
00:13:54,000 --> 00:13:58,639
why is it possible for him to manipulate

375
00:13:56,800 --> 00:14:01,279
election results

376
00:13:58,639 --> 00:14:03,040
because there is no authenticity there's

377
00:14:01,279 --> 00:14:05,360
only integrity protection

378
00:14:03,040 --> 00:14:07,279
of the pilot that he is transporting so

379
00:14:05,360 --> 00:14:10,000
there's some clc 32

380
00:14:07,279 --> 00:14:11,600
and a shower hash but nothing like a

381
00:14:10,000 --> 00:14:13,760
cryptographic signature

382
00:14:11,600 --> 00:14:14,959
so even if he alters the data he can

383
00:14:13,760 --> 00:14:17,360
just regenerate

384
00:14:14,959 --> 00:14:18,239
all the integrity protection data and

385
00:14:17,360 --> 00:14:21,120
the data will

386
00:14:18,240 --> 00:14:22,079
just be accepted so the main issue here

387
00:14:21,120 --> 00:14:25,040
is also

388
00:14:22,079 --> 00:14:26,399
that this is one of the few spots where

389
00:14:25,040 --> 00:14:29,199
only a single person

390
00:14:26,399 --> 00:14:31,440
has unsupervised access to the data

391
00:14:29,199 --> 00:14:34,719
during transport or to voting data at

392
00:14:31,440 --> 00:14:37,120
all and date makes manipulations

393
00:14:34,720 --> 00:14:38,160
possible and easily feasible in this

394
00:14:37,120 --> 00:14:41,320
case and that

395
00:14:38,160 --> 00:14:45,839
should not be the case especially in a

396
00:14:41,320 --> 00:14:45,839
electronically supported election

397
00:14:46,320 --> 00:14:50,000
now let's have a look at the vote

398
00:14:48,560 --> 00:14:52,000
counting software itself

399
00:14:50,000 --> 00:14:54,320
because there we found even more

400
00:14:52,000 --> 00:14:56,160
interesting in results

401
00:14:54,320 --> 00:14:57,440
exactly let's begin with the system

402
00:14:56,160 --> 00:14:59,600
architecture

403
00:14:57,440 --> 00:15:01,199
first of all this is the local or

404
00:14:59,600 --> 00:15:04,320
decentralized

405
00:15:01,199 --> 00:15:06,479
version of this software system so

406
00:15:04,320 --> 00:15:08,240
all this is taking place on the local

407
00:15:06,480 --> 00:15:09,920
host and the machine where i encountered

408
00:15:08,240 --> 00:15:11,920
in the election rooms

409
00:15:09,920 --> 00:15:14,079
and on these machines where was an

410
00:15:11,920 --> 00:15:17,279
apache tomcat web server running

411
00:15:14,079 --> 00:15:18,959
which was connected to a mariah db and

412
00:15:17,279 --> 00:15:21,839
the user was interacting with the

413
00:15:18,959 --> 00:15:24,800
boating system via a portable firefox

414
00:15:21,839 --> 00:15:27,199
and as the academy said in before they

415
00:15:24,800 --> 00:15:31,120
were very concerned with security

416
00:15:27,199 --> 00:15:33,599
so let's think about what

417
00:15:31,120 --> 00:15:34,880
attackers are they had in mind when they

418
00:15:33,600 --> 00:15:38,160
designed the system

419
00:15:34,880 --> 00:15:39,040
and from which the system is to protect

420
00:15:38,160 --> 00:15:41,519
from

421
00:15:39,040 --> 00:15:43,839
is it the user that maybe attacks the

422
00:15:41,519 --> 00:15:46,000
the the system the vote count system

423
00:15:43,839 --> 00:15:48,399
which is normally just election workers

424
00:15:46,000 --> 00:15:50,560
that are

425
00:15:48,399 --> 00:15:52,160
on their free time there to help

426
00:15:50,560 --> 00:15:55,920
executing the election

427
00:15:52,160 --> 00:15:57,519
or are they having the network attackers

428
00:15:55,920 --> 00:15:59,040
in mind that come from completely

429
00:15:57,519 --> 00:16:02,000
different places

430
00:15:59,040 --> 00:16:03,839
and try to manipulate the network from

431
00:16:02,000 --> 00:16:06,720
outside

432
00:16:03,839 --> 00:16:07,360
first of all we we took the user as one

433
00:16:06,720 --> 00:16:10,560
of the

434
00:16:07,360 --> 00:16:12,160
possible attackers and even if in this

435
00:16:10,560 --> 00:16:14,319
environment we found some

436
00:16:12,160 --> 00:16:16,000
really broken stuff first of all the

437
00:16:14,320 --> 00:16:18,880
broken access control

438
00:16:16,000 --> 00:16:20,880
but how it's uh how it's all about well

439
00:16:18,880 --> 00:16:22,480
that's the login page when we just

440
00:16:20,880 --> 00:16:24,320
logged in our

441
00:16:22,480 --> 00:16:25,680
voting system and clicked on

442
00:16:24,320 --> 00:16:28,240
administration page

443
00:16:25,680 --> 00:16:29,279
where we can change our password edit

444
00:16:28,240 --> 00:16:31,120
our profile

445
00:16:29,279 --> 00:16:32,800
these are the buttons on the left and as

446
00:16:31,120 --> 00:16:34,240
you can see we are clearly logged in as

447
00:16:32,800 --> 00:16:36,479
the user 42

448
00:16:34,240 --> 00:16:37,279
and there is no more things to do than

449
00:16:36,480 --> 00:16:40,079
select which

450
00:16:37,279 --> 00:16:40,800
counting uh part we want to do the

451
00:16:40,079 --> 00:16:43,439
general

452
00:16:40,800 --> 00:16:44,800
uh regional boat or the municipal

453
00:16:43,440 --> 00:16:47,360
municipal boats

454
00:16:44,800 --> 00:16:48,839
and that's all we can do in this page

455
00:16:47,360 --> 00:16:50,240
now let's switch to the system

456
00:16:48,839 --> 00:16:52,000
administrator

457
00:16:50,240 --> 00:16:53,360
there we have the admin account as you

458
00:16:52,000 --> 00:16:56,560
can see on the left

459
00:16:53,360 --> 00:16:59,279
upper side where we can now do

460
00:16:56,560 --> 00:17:01,439
very much more than the normal user we

461
00:16:59,279 --> 00:17:03,839
are again on the administration page

462
00:17:01,440 --> 00:17:06,319
but now we have the user administration

463
00:17:03,839 --> 00:17:10,000
where you can create or delete users

464
00:17:06,319 --> 00:17:13,039
we have to reopen or close

465
00:17:10,000 --> 00:17:14,959
voting mechanisms we have imports we

466
00:17:13,039 --> 00:17:17,039
have exports and also

467
00:17:14,959 --> 00:17:19,439
what's not included in the screenshots

468
00:17:17,039 --> 00:17:23,119
um sub menus like deleting

469
00:17:19,439 --> 00:17:25,520
uh finalized results or and so on

470
00:17:23,119 --> 00:17:26,879
so we picked out two very interesting

471
00:17:25,520 --> 00:17:29,840
urls for you

472
00:17:26,880 --> 00:17:31,679
first of all we are taking the bezier

473
00:17:29,840 --> 00:17:34,159
guidance which is

474
00:17:31,679 --> 00:17:35,840
translated just to reopen election after

475
00:17:34,160 --> 00:17:38,480
election is closed at normal

476
00:17:35,840 --> 00:17:40,480
it's normally finalized so no more votes

477
00:17:38,480 --> 00:17:43,200
can be entered in the system

478
00:17:40,480 --> 00:17:45,120
and the other link is election so this

479
00:17:43,200 --> 00:17:47,120
translates to delete data

480
00:17:45,120 --> 00:17:49,199
which then in the end deletes all the

481
00:17:47,120 --> 00:17:52,320
data from from the machine

482
00:17:49,200 --> 00:17:55,679
so no more private or

483
00:17:52,320 --> 00:17:56,320
secure data is stored on there and this

484
00:17:55,679 --> 00:17:58,400
is what they

485
00:17:56,320 --> 00:18:00,399
look like when we open we open them on

486
00:17:58,400 --> 00:18:02,880
the left side we see the reopen

487
00:18:00,400 --> 00:18:03,760
dialog on the right side we see the data

488
00:18:02,880 --> 00:18:07,440
delete

489
00:18:03,760 --> 00:18:10,799
but wait this is not the admin view

490
00:18:07,440 --> 00:18:13,360
this is the user view so they

491
00:18:10,799 --> 00:18:14,160
did not check if this user is even

492
00:18:13,360 --> 00:18:16,240
allowed

493
00:18:14,160 --> 00:18:18,640
and we also have to say that this is not

494
00:18:16,240 --> 00:18:20,559
just the the view of it it is fully

495
00:18:18,640 --> 00:18:22,240
working and this completely functional

496
00:18:20,559 --> 00:18:26,720
when we just go through the process of

497
00:18:22,240 --> 00:18:26,720
deleting or reopening as election

498
00:18:27,200 --> 00:18:30,400
what's the problem with that yeah as you

499
00:18:29,919 --> 00:18:32,799
maybe

500
00:18:30,400 --> 00:18:33,440
already guessed reopening elections

501
00:18:32,799 --> 00:18:35,360
could

502
00:18:33,440 --> 00:18:37,200
create a probability of sneaking in some

503
00:18:35,360 --> 00:18:40,240
additional votes for the candidate

504
00:18:37,200 --> 00:18:43,520
i favor and additionally if i

505
00:18:40,240 --> 00:18:44,480
want to mess with all of their voting i

506
00:18:43,520 --> 00:18:46,480
could just delete

507
00:18:44,480 --> 00:18:48,160
all election data and we would have

508
00:18:46,480 --> 00:18:51,440
start from the beginning

509
00:18:48,160 --> 00:18:54,480
and completely delay or deny the voting

510
00:18:51,440 --> 00:18:55,600
but why is this even possible um yeah we

511
00:18:54,480 --> 00:18:58,480
found out that

512
00:18:55,600 --> 00:18:59,439
this is their access control check in

513
00:18:58,480 --> 00:19:03,200
their software

514
00:18:59,440 --> 00:19:05,600
and this uh function is called getsucral

515
00:19:03,200 --> 00:19:07,360
which translates to get access roles so

516
00:19:05,600 --> 00:19:09,600
normally there will also be the

517
00:19:07,360 --> 00:19:12,240
software in place to check if this role

518
00:19:09,600 --> 00:19:13,918
is allowed to access this kind of site

519
00:19:12,240 --> 00:19:16,160
but they just returned null and not

520
00:19:13,919 --> 00:19:20,240
implemented it and that's also a

521
00:19:16,160 --> 00:19:23,679
nice work to implement access control

522
00:19:20,240 --> 00:19:25,360
however i think we can propose some

523
00:19:23,679 --> 00:19:26,720
mechanisms that could have prevented

524
00:19:25,360 --> 00:19:29,520
this first of all

525
00:19:26,720 --> 00:19:30,559
hidden information is nothing you could

526
00:19:29,520 --> 00:19:32,400
rely on

527
00:19:30,559 --> 00:19:35,120
if you just don't show where you can

528
00:19:32,400 --> 00:19:38,000
click to get to this url or to this page

529
00:19:35,120 --> 00:19:40,000
that's not really secret because maybe

530
00:19:38,000 --> 00:19:42,559
you find some leaked source code

531
00:19:40,000 --> 00:19:43,840
or you make sure serving at an admin or

532
00:19:42,559 --> 00:19:46,160
you just by

533
00:19:43,840 --> 00:19:48,159
accident type in the wrong will and get

534
00:19:46,160 --> 00:19:50,720
to the hidden information or you

535
00:19:48,160 --> 00:19:51,679
exactly use software scanner to find

536
00:19:50,720 --> 00:19:54,640
something hidden

537
00:19:51,679 --> 00:19:55,919
so hidden data is just not secure and on

538
00:19:54,640 --> 00:19:58,000
the other hand you should

539
00:19:55,919 --> 00:19:59,120
finalize your implementation of access

540
00:19:58,000 --> 00:20:00,960
control to be

541
00:19:59,120 --> 00:20:02,879
to have access control and even test it

542
00:20:00,960 --> 00:20:04,400
once to be sure that it works

543
00:20:02,880 --> 00:20:07,440
so in the end we can conclude that

544
00:20:04,400 --> 00:20:09,360
hidden data is not protected data

545
00:20:07,440 --> 00:20:11,760
let's now come to another type of

546
00:20:09,360 --> 00:20:13,918
attacks cross-site attacks

547
00:20:11,760 --> 00:20:16,080
a cross-site attack is a sort of

548
00:20:13,919 --> 00:20:17,760
interference between two websites where

549
00:20:16,080 --> 00:20:19,760
one website for example

550
00:20:17,760 --> 00:20:22,080
tries to do something on behalf of the

551
00:20:19,760 --> 00:20:22,640
other the goal is often to decept the

552
00:20:22,080 --> 00:20:26,080
user

553
00:20:22,640 --> 00:20:26,480
or to trigger the manipulations first of

554
00:20:26,080 --> 00:20:28,639
all

555
00:20:26,480 --> 00:20:29,520
we were quite sure that have thought of

556
00:20:28,640 --> 00:20:32,720
cross site

557
00:20:29,520 --> 00:20:35,039
attacks because during our testing

558
00:20:32,720 --> 00:20:36,000
we saw that they included some http

559
00:20:35,039 --> 00:20:40,000
headers that

560
00:20:36,000 --> 00:20:42,559
target a wide range of attack vectors

561
00:20:40,000 --> 00:20:43,760
that use cross-set scripting attacks for

562
00:20:42,559 --> 00:20:47,280
example here we have an

563
00:20:43,760 --> 00:20:50,480
x-frame options same origin that means

564
00:20:47,280 --> 00:20:53,120
that other pages can not include

565
00:20:50,480 --> 00:20:55,280
the voting software into own frames and

566
00:20:53,120 --> 00:20:56,799
so on and also crosstalk's uh scripting

567
00:20:55,280 --> 00:21:00,559
protection is enabled

568
00:20:56,799 --> 00:21:03,200
via xss protection so this looks

569
00:21:00,559 --> 00:21:05,120
quite good because this already excludes

570
00:21:03,200 --> 00:21:07,679
several attack vectors

571
00:21:05,120 --> 00:21:08,879
well but how about crossfire request

572
00:21:07,679 --> 00:21:11,600
fortunately

573
00:21:08,880 --> 00:21:12,240
when we first tested this we found out

574
00:21:11,600 --> 00:21:14,799
that

575
00:21:12,240 --> 00:21:16,320
the vote counting system is not fully

576
00:21:14,799 --> 00:21:18,960
protected against it

577
00:21:16,320 --> 00:21:21,200
what is cross-site request forgery so in

578
00:21:18,960 --> 00:21:23,200
the first step the election worker uses

579
00:21:21,200 --> 00:21:26,159
the integrated firefox browser

580
00:21:23,200 --> 00:21:29,120
to access a malicious website so the

581
00:21:26,159 --> 00:21:31,679
user is triggered to visit this website

582
00:21:29,120 --> 00:21:32,719
for example someone sent him a link

583
00:21:31,679 --> 00:21:35,280
triggered him

584
00:21:32,720 --> 00:21:36,400
uh to click on the link by the promise

585
00:21:35,280 --> 00:21:38,320
for example of

586
00:21:36,400 --> 00:21:39,600
cute and email pictures or some sort of

587
00:21:38,320 --> 00:21:42,320
that and then

588
00:21:39,600 --> 00:21:43,120
the user visits this website and this

589
00:21:42,320 --> 00:21:45,918
website

590
00:21:43,120 --> 00:21:48,000
contains form fields that resemble the

591
00:21:45,919 --> 00:21:49,360
formulas of the actual vote counting

592
00:21:48,000 --> 00:21:51,679
software

593
00:21:49,360 --> 00:21:52,559
and the malicious website now triggers

594
00:21:51,679 --> 00:21:55,520
triborosa

595
00:21:52,559 --> 00:21:56,799
to submit this form data not to the

596
00:21:55,520 --> 00:21:59,440
original website

597
00:21:56,799 --> 00:22:00,960
but rather to the vote counting software

598
00:21:59,440 --> 00:22:03,679
and as soon as it reaches

599
00:22:00,960 --> 00:22:04,960
the tomcat web server the web server is

600
00:22:03,679 --> 00:22:08,159
confused because

601
00:22:04,960 --> 00:22:10,640
the web server cannot discern

602
00:22:08,159 --> 00:22:12,880
the input from the crosstalk attack from

603
00:22:10,640 --> 00:22:13,360
the malicious website from original user

604
00:22:12,880 --> 00:22:15,520
input

605
00:22:13,360 --> 00:22:16,399
and then the apache tomcats dollar just

606
00:22:15,520 --> 00:22:18,879
thinks

607
00:22:16,400 --> 00:22:19,679
that this is original user input and

608
00:22:18,880 --> 00:22:21,840
will process

609
00:22:19,679 --> 00:22:23,760
it and that's called a cross site

610
00:22:21,840 --> 00:22:26,320
request virtually attack

611
00:22:23,760 --> 00:22:28,799
so we saw that there is sometimes a

612
00:22:26,320 --> 00:22:31,360
protection against this sort of attacks

613
00:22:28,799 --> 00:22:32,879
but many pages are not protected against

614
00:22:31,360 --> 00:22:36,158
it and that is very

615
00:22:32,880 --> 00:22:38,840
concerning because that's a 2001

616
00:22:36,159 --> 00:22:41,360
vulnerability it's almost 20 years old

617
00:22:38,840 --> 00:22:43,840
now and it's still present

618
00:22:41,360 --> 00:22:45,678
in such a software so this is quite

619
00:22:43,840 --> 00:22:47,760
unsettling here

620
00:22:45,679 --> 00:22:48,960
now let's sum this up what we can do

621
00:22:47,760 --> 00:22:51,520
with it

622
00:22:48,960 --> 00:22:54,000
so first of all the issue is that they

623
00:22:51,520 --> 00:22:56,000
have missing csrf tokens for any

624
00:22:54,000 --> 00:22:58,480
other good counter-measure against

625
00:22:56,000 --> 00:23:01,360
cross-site request for cherry attacks

626
00:22:58,480 --> 00:23:03,280
and the second point is here that only

627
00:23:01,360 --> 00:23:05,918
minimal user interaction is required

628
00:23:03,280 --> 00:23:07,678
the user often doesn't even see that a

629
00:23:05,919 --> 00:23:08,640
cross-site request fortunately attack is

630
00:23:07,679 --> 00:23:11,440
purely

631
00:23:08,640 --> 00:23:11,760
currently being executed on his behalf

632
00:23:11,440 --> 00:23:13,919
so

633
00:23:11,760 --> 00:23:15,679
it's almost undetectable by the user and

634
00:23:13,919 --> 00:23:17,120
it's very simple to trick a user into

635
00:23:15,679 --> 00:23:19,600
clicking a link

636
00:23:17,120 --> 00:23:21,199
so the impact is very devastating

637
00:23:19,600 --> 00:23:23,360
because

638
00:23:21,200 --> 00:23:25,200
we can now manipulate settings in the

639
00:23:23,360 --> 00:23:30,399
vote counting software

640
00:23:25,200 --> 00:23:30,400
and we can even insert fake balance here

641
00:23:31,440 --> 00:23:35,760
so what's what's what's the result of

642
00:23:34,240 --> 00:23:38,080
this what we can do with it

643
00:23:35,760 --> 00:23:39,120
well we can manipulate the entire

644
00:23:38,080 --> 00:23:41,840
election with this

645
00:23:39,120 --> 00:23:43,439
let's just use a demo how we do this

646
00:23:41,840 --> 00:23:45,520
nice

647
00:23:43,440 --> 00:23:47,039
we are already logged in into the vote

648
00:23:45,520 --> 00:23:51,440
counting system

649
00:23:47,039 --> 00:23:55,039
our username is admin 321934

650
00:23:51,440 --> 00:23:55,039
now let's count some votes

651
00:23:55,120 --> 00:23:59,039
as we can see here these are all the

652
00:23:57,039 --> 00:24:00,879
ballots that we can enter

653
00:23:59,039 --> 00:24:03,039
they are still empty since we haven't

654
00:24:00,880 --> 00:24:05,840
entered any ballots yet

655
00:24:03,039 --> 00:24:05,840
so let's start

656
00:24:06,080 --> 00:24:09,279
for simplicity we just have two parties

657
00:24:08,559 --> 00:24:11,120
here

658
00:24:09,279 --> 00:24:13,200
on the left hand side we have the good

659
00:24:11,120 --> 00:24:14,000
party who wants the best for their

660
00:24:13,200 --> 00:24:15,919
people

661
00:24:14,000 --> 00:24:18,320
on the right hand side we have the bad

662
00:24:15,919 --> 00:24:19,760
party who wants to take power and is

663
00:24:18,320 --> 00:24:22,960
willing to even commit

664
00:24:19,760 --> 00:24:24,960
election fraud let us begin and enter

665
00:24:22,960 --> 00:24:27,440
the first paper ballot

666
00:24:24,960 --> 00:24:28,480
the person has voted for the good party

667
00:24:27,440 --> 00:24:34,000
so we entered this

668
00:24:28,480 --> 00:24:37,520
into the software now we save the ballot

669
00:24:34,000 --> 00:24:37,520
and go to the next one

670
00:24:37,600 --> 00:24:42,000
again it's a vote for the good party

671
00:24:40,559 --> 00:24:46,639
let's enter it

672
00:24:42,000 --> 00:24:49,760
and save it and go to the third ballot

673
00:24:46,640 --> 00:24:50,240
and again it's for the good party let's

674
00:24:49,760 --> 00:24:53,679
save

675
00:24:50,240 --> 00:24:54,559
our third ballot now we go to the ballot

676
00:24:53,679 --> 00:24:58,159
overview

677
00:24:54,559 --> 00:25:00,399
and we look what has happened

678
00:24:58,159 --> 00:25:03,039
as you can see we now have three ballots

679
00:25:00,400 --> 00:25:05,600
that have successfully been entered

680
00:25:03,039 --> 00:25:08,240
and next let's check the preliminary

681
00:25:05,600 --> 00:25:10,158
election results

682
00:25:08,240 --> 00:25:12,159
as we can see here we have a total of

683
00:25:10,159 --> 00:25:13,520
three ballots that have been entered

684
00:25:12,159 --> 00:25:16,559
into the system

685
00:25:13,520 --> 00:25:19,039
that's correct three ballots contain

686
00:25:16,559 --> 00:25:19,760
votes for the good party that's also

687
00:25:19,039 --> 00:25:21,440
correct

688
00:25:19,760 --> 00:25:25,120
and zero votes have been given to the

689
00:25:21,440 --> 00:25:27,200
bad party that's fine so far

690
00:25:25,120 --> 00:25:29,039
next i will show you what happens if i

691
00:25:27,200 --> 00:25:32,000
open my malicious website

692
00:25:29,039 --> 00:25:34,640
this website will execute a csrf attack

693
00:25:32,000 --> 00:25:36,400
and manipulate the election results

694
00:25:34,640 --> 00:25:43,840
let's just assume we want to take a

695
00:25:36,400 --> 00:25:43,840
break and simply browse twitter

696
00:25:44,130 --> 00:25:47,380
[Music]

697
00:25:49,279 --> 00:25:52,640
okay here we are there's a cute cact

698
00:25:51,840 --> 00:25:55,039
picture

699
00:25:52,640 --> 00:25:56,960
and there's a link to even more of them

700
00:25:55,039 --> 00:26:00,158
let's just play along and get tweaked

701
00:25:56,960 --> 00:26:00,159
into clicking that link

702
00:26:00,799 --> 00:26:04,320
oh look at all those cute animal

703
00:26:03,440 --> 00:26:07,440
pictures

704
00:26:04,320 --> 00:26:10,639
look a hungry rabbit a monkey

705
00:26:07,440 --> 00:26:12,000
a little hedgehog and two queued goats

706
00:26:10,640 --> 00:26:13,919
and so on

707
00:26:12,000 --> 00:26:15,039
and when we are done browsing we close

708
00:26:13,919 --> 00:26:19,279
those tabs again

709
00:26:15,039 --> 00:26:19,279
and return to our word counting software

710
00:26:21,360 --> 00:26:25,039
what we notice now is that our username

711
00:26:23,840 --> 00:26:28,158
has been altered

712
00:26:25,039 --> 00:26:30,480
and we just got pawned we were tricked

713
00:26:28,159 --> 00:26:33,120
into visiting this malicious website

714
00:26:30,480 --> 00:26:34,640
the website executed a csrf attack on

715
00:26:33,120 --> 00:26:37,678
the vote counting software

716
00:26:34,640 --> 00:26:40,880
and did some manipulations let's see

717
00:26:37,679 --> 00:26:40,880
what else has changed

718
00:26:41,120 --> 00:26:44,158
however our three ballots are still

719
00:26:43,279 --> 00:26:45,919
there

720
00:26:44,159 --> 00:26:49,279
but now we take a look at the

721
00:26:45,919 --> 00:26:51,120
preliminary election results

722
00:26:49,279 --> 00:26:53,279
what you can see here is that the number

723
00:26:51,120 --> 00:26:55,678
of ballots that are in the system

724
00:26:53,279 --> 00:26:57,200
has been increased to eight we now have

725
00:26:55,679 --> 00:26:59,840
five additional ballots

726
00:26:57,200 --> 00:27:00,559
that were not entered by us as you can

727
00:26:59,840 --> 00:27:02,799
see

728
00:27:00,559 --> 00:27:04,639
the good party still has three votes

729
00:27:02,799 --> 00:27:07,840
that is what we have entered

730
00:27:04,640 --> 00:27:10,960
but now the bad party has taken the lead

731
00:27:07,840 --> 00:27:13,520
to have five votes now this attack

732
00:27:10,960 --> 00:27:14,960
has indeed manipulated the election

733
00:27:13,520 --> 00:27:17,440
results

734
00:27:14,960 --> 00:27:18,399
this is really bad because we cannot

735
00:27:17,440 --> 00:27:20,720
even see

736
00:27:18,399 --> 00:27:22,399
those additional fake bailouts that have

737
00:27:20,720 --> 00:27:24,880
been injected

738
00:27:22,399 --> 00:27:27,760
however we are lucky because we noticed

739
00:27:24,880 --> 00:27:32,320
it since we have expected this attack

740
00:27:27,760 --> 00:27:32,320
but we won't notice it in every case

741
00:27:33,520 --> 00:27:37,679
but what happens if we don't notice well

742
00:27:36,480 --> 00:27:40,559
that happens

743
00:27:37,679 --> 00:27:42,159
so for this example we just assume that

744
00:27:40,559 --> 00:27:44,399
team one has three ballots

745
00:27:42,159 --> 00:27:45,760
that they have entered into the computer

746
00:27:44,399 --> 00:27:47,678
system and team two

747
00:27:45,760 --> 00:27:49,840
has six followers that have been entered

748
00:27:47,679 --> 00:27:52,320
into their computer system

749
00:27:49,840 --> 00:27:52,959
now team one visits their malicious

750
00:27:52,320 --> 00:27:56,158
websites

751
00:27:52,960 --> 00:27:57,679
and five fake ballots are injected into

752
00:27:56,159 --> 00:28:00,559
the election results

753
00:27:57,679 --> 00:28:02,320
in this case the attacker is very smart

754
00:28:00,559 --> 00:28:05,200
and injects the balance

755
00:28:02,320 --> 00:28:07,600
at the location where the temp ii values

756
00:28:05,200 --> 00:28:11,120
will be expected in the future

757
00:28:07,600 --> 00:28:12,320
so what happens now is team 2 exports

758
00:28:11,120 --> 00:28:14,959
their ballots

759
00:28:12,320 --> 00:28:16,240
and team 1 tries to import the ballots

760
00:28:14,960 --> 00:28:19,600
of team 2

761
00:28:16,240 --> 00:28:21,279
and now the following thing happens

762
00:28:19,600 --> 00:28:23,678
because there are already ballots

763
00:28:21,279 --> 00:28:25,600
present at the location where the team 2

764
00:28:23,679 --> 00:28:28,000
balance should go to

765
00:28:25,600 --> 00:28:29,039
the input process is not fully

766
00:28:28,000 --> 00:28:31,120
successful

767
00:28:29,039 --> 00:28:32,158
and only a subset of the ballots are

768
00:28:31,120 --> 00:28:34,799
imported

769
00:28:32,159 --> 00:28:35,840
so at the majority of the ballots in

770
00:28:34,799 --> 00:28:38,320
this case

771
00:28:35,840 --> 00:28:40,158
five of six ballots are just discarded

772
00:28:38,320 --> 00:28:40,960
because they don't fit in the database

773
00:28:40,159 --> 00:28:43,360
anymore

774
00:28:40,960 --> 00:28:45,039
because that location is already taken

775
00:28:43,360 --> 00:28:47,840
by the fake balance

776
00:28:45,039 --> 00:28:49,279
so usually we would expect that this can

777
00:28:47,840 --> 00:28:51,520
generate an error message

778
00:28:49,279 --> 00:28:53,919
or at least a warning but this does not

779
00:28:51,520 --> 00:28:54,879
happen this is a silent failure of the

780
00:28:53,919 --> 00:28:58,080
software

781
00:28:54,880 --> 00:29:01,039
and what's even worse is now that the

782
00:28:58,080 --> 00:29:02,158
sums finally are correct so that means

783
00:29:01,039 --> 00:29:04,879
we have now have

784
00:29:02,159 --> 00:29:05,279
nine ballots present in the system and

785
00:29:04,880 --> 00:29:07,520
nine

786
00:29:05,279 --> 00:29:09,520
paper ballots that were initially

787
00:29:07,520 --> 00:29:10,960
available so this looks like we have

788
00:29:09,520 --> 00:29:12,960
entered all the ballots

789
00:29:10,960 --> 00:29:14,559
and everything seems to be fine so we

790
00:29:12,960 --> 00:29:16,799
will now close the election

791
00:29:14,559 --> 00:29:18,240
and generate the final result and that

792
00:29:16,799 --> 00:29:20,639
is what happens now

793
00:29:18,240 --> 00:29:22,640
as you can see we have only four boats

794
00:29:20,640 --> 00:29:25,520
for the good party

795
00:29:22,640 --> 00:29:26,399
but five boats for the bad party so the

796
00:29:25,520 --> 00:29:29,440
bad party

797
00:29:26,399 --> 00:29:30,559
has won the election by manipulating the

798
00:29:29,440 --> 00:29:33,600
voting system

799
00:29:30,559 --> 00:29:36,639
using this csrf attack and that

800
00:29:33,600 --> 00:29:39,199
should never be possible because

801
00:29:36,640 --> 00:29:40,880
this is not what we expect from a voting

802
00:29:39,200 --> 00:29:44,720
software and in this case

803
00:29:40,880 --> 00:29:46,640
say result is rigged

804
00:29:44,720 --> 00:29:48,320
so have you also thought about network

805
00:29:46,640 --> 00:29:50,480
vulnerabilities

806
00:29:48,320 --> 00:29:51,760
yeah sure that's exactly the other side

807
00:29:50,480 --> 00:29:54,559
of the coin first we checked the

808
00:29:51,760 --> 00:29:56,879
election worker site for attacks but now

809
00:29:54,559 --> 00:29:58,879
we checked the network side and scanned

810
00:29:56,880 --> 00:30:01,600
and analyzed the system

811
00:29:58,880 --> 00:30:02,960
at first and then we looked like this

812
00:30:01,600 --> 00:30:06,158
open ports

813
00:30:02,960 --> 00:30:08,720
everywhere and as you can see

814
00:30:06,159 --> 00:30:10,559
they fully expose the apache tomcat and

815
00:30:08,720 --> 00:30:14,000
the mariah the beat to each

816
00:30:10,559 --> 00:30:15,760
available network on the system and

817
00:30:14,000 --> 00:30:18,399
with this we thought yeah let's maybe

818
00:30:15,760 --> 00:30:21,679
try some newly discovered vulnerability

819
00:30:18,399 --> 00:30:22,639
which was currently recently found in

820
00:30:21,679 --> 00:30:24,640
2020

821
00:30:22,640 --> 00:30:27,279
called ghost cat and ghost kit is an

822
00:30:24,640 --> 00:30:30,559
attack against ahp protocol from

823
00:30:27,279 --> 00:30:32,880
apache but let's check the apache system

824
00:30:30,559 --> 00:30:33,678
and how it's built first the apache has

825
00:30:32,880 --> 00:30:37,039
a web route

826
00:30:33,679 --> 00:30:38,240
which serves static resources and html

827
00:30:37,039 --> 00:30:40,720
or gsp files

828
00:30:38,240 --> 00:30:42,320
and additionally it can include class

829
00:30:40,720 --> 00:30:44,960
files or class servlets

830
00:30:42,320 --> 00:30:45,520
which are combined with these jsps or

831
00:30:44,960 --> 00:30:48,480
itml

832
00:30:45,520 --> 00:30:49,279
files and then serve to the user so we

833
00:30:48,480 --> 00:30:52,640
prepared our

834
00:30:49,279 --> 00:30:53,440
adhp shooter with the well of the web

835
00:30:52,640 --> 00:30:56,159
application

836
00:30:53,440 --> 00:30:57,039
edit the port added a file to re file we

837
00:30:56,159 --> 00:30:59,200
wanted to read

838
00:30:57,039 --> 00:31:00,399
in our case it's a private test class

839
00:30:59,200 --> 00:31:02,000
file because

840
00:31:00,399 --> 00:31:04,879
where maybe what we could leak about

841
00:31:02,000 --> 00:31:06,960
this but we'll see and then we

842
00:31:04,880 --> 00:31:08,880
said we only want to read it because

843
00:31:06,960 --> 00:31:11,679
there would even be the possibility to

844
00:31:08,880 --> 00:31:14,880
evaluate it and execute the code in it

845
00:31:11,679 --> 00:31:17,360
so we've done this attack and tada we

846
00:31:14,880 --> 00:31:18,080
got a result and this is the bytecode of

847
00:31:17,360 --> 00:31:21,279
the private

848
00:31:18,080 --> 00:31:22,320
test class so let's just drop this

849
00:31:21,279 --> 00:31:25,679
bytecode in

850
00:31:22,320 --> 00:31:27,678
our cup of coffee and maybe we can pull

851
00:31:25,679 --> 00:31:31,360
out some source code from it

852
00:31:27,679 --> 00:31:33,919
and yeah that's what we fret out because

853
00:31:31,360 --> 00:31:34,879
why not just test your encryption

854
00:31:33,919 --> 00:31:37,760
mechanism

855
00:31:34,880 --> 00:31:38,240
with the string but this is not a common

856
00:31:37,760 --> 00:31:40,799
string

857
00:31:38,240 --> 00:31:41,600
as you later found out this is the real

858
00:31:40,799 --> 00:31:44,799
root

859
00:31:41,600 --> 00:31:47,840
productive password of the mariah db and

860
00:31:44,799 --> 00:31:47,840
this was like

861
00:31:49,200 --> 00:31:52,720
so what's the problem as you maybe

862
00:31:51,840 --> 00:31:55,918
clearly see

863
00:31:52,720 --> 00:31:58,399
with this attack we could leak out uh

864
00:31:55,919 --> 00:32:00,559
the login of the mariah db and probably

865
00:31:58,399 --> 00:32:03,360
even more logins or passwords

866
00:32:00,559 --> 00:32:05,200
and additionally we could leak the whole

867
00:32:03,360 --> 00:32:08,158
source code over the network without

868
00:32:05,200 --> 00:32:10,799
ever accessing the pc

869
00:32:08,159 --> 00:32:11,840
in the in the election room and this was

870
00:32:10,799 --> 00:32:16,000
only possible

871
00:32:11,840 --> 00:32:19,199
because they completely exposed all

872
00:32:16,000 --> 00:32:21,360
machines and applications to the network

873
00:32:19,200 --> 00:32:22,880
and this should never be the case

874
00:32:21,360 --> 00:32:24,000
certain results how can this

875
00:32:22,880 --> 00:32:25,760
pre-prevented

876
00:32:24,000 --> 00:32:27,679
first you should never expose these

877
00:32:25,760 --> 00:32:28,158
unneeded ports to the head because they

878
00:32:27,679 --> 00:32:30,799
don't

879
00:32:28,159 --> 00:32:31,679
even use the hp project proxy in their

880
00:32:30,799 --> 00:32:34,799
application

881
00:32:31,679 --> 00:32:36,159
but just left it on the zero zero zero

882
00:32:34,799 --> 00:32:37,679
zero interface

883
00:32:36,159 --> 00:32:39,919
next is keep you it should keep your

884
00:32:37,679 --> 00:32:42,000
software up to date that if you fi if

885
00:32:39,919 --> 00:32:45,039
some chival abilities were found

886
00:32:42,000 --> 00:32:47,279
you should not be a vulnerable to it

887
00:32:45,039 --> 00:32:49,519
and last but not least never use

888
00:32:47,279 --> 00:32:52,399
productive passwords as your unit tests

889
00:32:49,519 --> 00:32:54,320
because that's not the best idea to do

890
00:32:52,399 --> 00:32:57,518
in the end to sum it up

891
00:32:54,320 --> 00:32:58,320
avoid at all costs any additional attack

892
00:32:57,519 --> 00:33:00,720
surface

893
00:32:58,320 --> 00:33:03,120
to prevent these kind of attacks even if

894
00:33:00,720 --> 00:33:04,799
you don't know about them yet

895
00:33:03,120 --> 00:33:06,479
after toby has shown us a lot of

896
00:33:04,799 --> 00:33:09,200
interesting apache stuff

897
00:33:06,480 --> 00:33:10,799
i tested the database for its security

898
00:33:09,200 --> 00:33:13,200
for the first analysis

899
00:33:10,799 --> 00:33:15,600
i was just starting with the same pc

900
00:33:13,200 --> 00:33:17,679
where also the software was installed

901
00:33:15,600 --> 00:33:20,158
and i tried to gain access to the

902
00:33:17,679 --> 00:33:22,960
database so i was coming from the host

903
00:33:20,159 --> 00:33:23,679
localhost i tried to use the username

904
00:33:22,960 --> 00:33:25,840
root

905
00:33:23,679 --> 00:33:27,600
and then i saw that i mask for a

906
00:33:25,840 --> 00:33:29,120
password before i'm allowed to connect

907
00:33:27,600 --> 00:33:31,279
to the database

908
00:33:29,120 --> 00:33:32,639
however finding the password was quite

909
00:33:31,279 --> 00:33:34,720
trivial to do

910
00:33:32,640 --> 00:33:35,919
because all the stuff i needed to know

911
00:33:34,720 --> 00:33:38,720
for that was

912
00:33:35,919 --> 00:33:39,760
included in a class file and i was able

913
00:33:38,720 --> 00:33:42,480
to decrypt

914
00:33:39,760 --> 00:33:44,720
the password without any issue here and

915
00:33:42,480 --> 00:33:45,440
that moment i realized that also the

916
00:33:44,720 --> 00:33:47,760
password

917
00:33:45,440 --> 00:33:50,000
that toby has shown us before that he

918
00:33:47,760 --> 00:33:53,679
found with the ghostgate vulnerability

919
00:33:50,000 --> 00:33:57,200
is indeed the mysql root password here

920
00:33:53,679 --> 00:34:00,640
so after i have access to the mysql

921
00:33:57,200 --> 00:34:02,799
system i tried to dump the user table

922
00:34:00,640 --> 00:34:04,559
to look which users are allowed to

923
00:34:02,799 --> 00:34:07,039
access the database

924
00:34:04,559 --> 00:34:08,000
so and that is how your user table looks

925
00:34:07,039 --> 00:34:11,119
like

926
00:34:08,000 --> 00:34:13,280
we have four times the user root and

927
00:34:11,119 --> 00:34:14,960
the user root requires a password if i'm

928
00:34:13,280 --> 00:34:16,960
coming from localhost

929
00:34:14,960 --> 00:34:18,839
but wait a moment here we also have the

930
00:34:16,960 --> 00:34:21,679
host pci

931
00:34:18,839 --> 00:34:24,719
1939 and as you can see here

932
00:34:21,679 --> 00:34:27,760
there is no mysql password statement

933
00:34:24,719 --> 00:34:30,638
that means that someone coming from host

934
00:34:27,760 --> 00:34:33,760
pca 1939

935
00:34:30,639 --> 00:34:34,800
is always allowed to connect as root and

936
00:34:33,760 --> 00:34:37,839
does not even need

937
00:34:34,800 --> 00:34:41,119
to provide any password for that and

938
00:34:37,839 --> 00:34:41,119
that's really strange

939
00:34:42,879 --> 00:34:49,839
so what could happen from this

940
00:34:46,800 --> 00:34:50,159
well now someone on the network can now

941
00:34:49,839 --> 00:34:52,480
do

942
00:34:50,159 --> 00:34:53,359
just some voting manipulation that's

943
00:34:52,480 --> 00:34:56,399
quite trivial

944
00:34:53,359 --> 00:34:59,119
because as soon as i set my host to the

945
00:34:56,399 --> 00:35:00,160
correct host name i get full access to

946
00:34:59,119 --> 00:35:02,079
the database

947
00:35:00,160 --> 00:35:03,759
where all my local watching results were

948
00:35:02,079 --> 00:35:05,520
stored and since i moved

949
00:35:03,760 --> 00:35:07,280
i can interfere with them i can change

950
00:35:05,520 --> 00:35:10,000
them however i want to

951
00:35:07,280 --> 00:35:10,480
and this vulnerability is so damn weird

952
00:35:10,000 --> 00:35:13,359
and

953
00:35:10,480 --> 00:35:13,599
trivial it takes me no effort to do this

954
00:35:13,359 --> 00:35:16,720
at

955
00:35:13,599 --> 00:35:17,280
all and so we won't even go into a demo

956
00:35:16,720 --> 00:35:20,319
here

957
00:35:17,280 --> 00:35:21,119
because it's so stupid simple in this

958
00:35:20,320 --> 00:35:23,280
case

959
00:35:21,119 --> 00:35:24,480
usually i would say that's enough for

960
00:35:23,280 --> 00:35:26,800
today because

961
00:35:24,480 --> 00:35:27,839
we already have full access to the

962
00:35:26,800 --> 00:35:30,000
voting system

963
00:35:27,839 --> 00:35:32,078
and can change whatever we want to

964
00:35:30,000 --> 00:35:32,960
however this time we decided to go

965
00:35:32,079 --> 00:35:36,880
deeper

966
00:35:32,960 --> 00:35:37,920
because we saw pci 1939 as a real door

967
00:35:36,880 --> 00:35:41,920
opener

968
00:35:37,920 --> 00:35:42,720
so we have access to the voting results

969
00:35:41,920 --> 00:35:44,960
we can change

970
00:35:42,720 --> 00:35:47,040
them but we still don't have access to

971
00:35:44,960 --> 00:35:49,440
the entire voting system

972
00:35:47,040 --> 00:35:50,560
so what about the pc might it be

973
00:35:49,440 --> 00:35:52,560
possible

974
00:35:50,560 --> 00:35:54,240
with that mood access to the database

975
00:35:52,560 --> 00:35:57,759
server to gain

976
00:35:54,240 --> 00:36:00,078
remote code execution at that machine

977
00:35:57,760 --> 00:36:01,200
so for this experiment i use the

978
00:36:00,079 --> 00:36:03,040
following setup

979
00:36:01,200 --> 00:36:05,919
on the right hand side we have the

980
00:36:03,040 --> 00:36:07,680
voting system with the exposed my irdb

981
00:36:05,920 --> 00:36:10,240
database base server

982
00:36:07,680 --> 00:36:11,200
in the left hand side that's my system i

983
00:36:10,240 --> 00:36:14,640
named myself

984
00:36:11,200 --> 00:36:17,200
tci 1939 just because i can do it

985
00:36:14,640 --> 00:36:18,720
and i establish a connection to the my

986
00:36:17,200 --> 00:36:21,759
mariah db server

987
00:36:18,720 --> 00:36:22,959
i use root as a username i don't need

988
00:36:21,760 --> 00:36:26,400
any password

989
00:36:22,960 --> 00:36:28,079
and it is immediately accepted so now

990
00:36:26,400 --> 00:36:30,800
that i am connected

991
00:36:28,079 --> 00:36:33,280
i am allowed to issue commands for

992
00:36:30,800 --> 00:36:36,160
example i can now instruct my irdb

993
00:36:33,280 --> 00:36:38,000
to enable one of its plug-ins this

994
00:36:36,160 --> 00:36:40,399
plugin is called ha connect

995
00:36:38,000 --> 00:36:42,640
it's one of the plugins that usually

996
00:36:40,400 --> 00:36:45,839
come directly with mobile db

997
00:36:42,640 --> 00:36:47,200
and this is a very powerful mysql

998
00:36:45,839 --> 00:36:50,160
storage driver

999
00:36:47,200 --> 00:36:50,879
so i now i will show you what i can do

1000
00:36:50,160 --> 00:36:54,000
with that

1001
00:36:50,880 --> 00:36:57,119
storage driver so at next i will now

1002
00:36:54,000 --> 00:36:59,280
create a table that's called pwn

1003
00:36:57,119 --> 00:37:00,240
and i'm using the h a connect storage

1004
00:36:59,280 --> 00:37:02,560
driver

1005
00:37:00,240 --> 00:37:06,319
and i instruct the storage driver to

1006
00:37:02,560 --> 00:37:08,799
create a file that's called pwn.dll

1007
00:37:06,320 --> 00:37:10,720
and to place it right into that plug-in

1008
00:37:08,800 --> 00:37:12,160
folder there is nothing that stops me

1009
00:37:10,720 --> 00:37:14,078
from doing so

1010
00:37:12,160 --> 00:37:15,359
so that is one of the special features

1011
00:37:14,079 --> 00:37:18,079
of the h8 connect

1012
00:37:15,359 --> 00:37:18,799
storage driver that i can just say this

1013
00:37:18,079 --> 00:37:20,880
table

1014
00:37:18,800 --> 00:37:22,320
is mapped to that file in the file

1015
00:37:20,880 --> 00:37:24,320
system

1016
00:37:22,320 --> 00:37:25,599
however this file is still empty because

1017
00:37:24,320 --> 00:37:27,920
the table is empty

1018
00:37:25,599 --> 00:37:28,640
but since this is a database i can now

1019
00:37:27,920 --> 00:37:31,359
just

1020
00:37:28,640 --> 00:37:32,560
issue insert into statements and load

1021
00:37:31,359 --> 00:37:35,598
whatever data

1022
00:37:32,560 --> 00:37:38,160
i want to for example some malicious dll

1023
00:37:35,599 --> 00:37:39,520
i can just load into the table via that

1024
00:37:38,160 --> 00:37:42,078
insert into statement

1025
00:37:39,520 --> 00:37:43,880
and then it is directly written into our

1026
00:37:42,079 --> 00:37:47,520
malicious dll

1027
00:37:43,880 --> 00:37:50,079
pwn.ell ok so at next

1028
00:37:47,520 --> 00:37:51,440
i after i've finished writing i will

1029
00:37:50,079 --> 00:37:54,000
instruct mariah db

1030
00:37:51,440 --> 00:37:54,960
to enable this plugin that i have just

1031
00:37:54,000 --> 00:37:57,520
uploaded

1032
00:37:54,960 --> 00:37:59,119
and enabling a plugin means that we are

1033
00:37:57,520 --> 00:38:02,240
executing the code

1034
00:37:59,119 --> 00:38:02,960
that is stored in this dll file so what

1035
00:38:02,240 --> 00:38:07,040
that means

1036
00:38:02,960 --> 00:38:07,040
we have remote code execution

1037
00:38:08,160 --> 00:38:11,598
i don't even ask what you can do with

1038
00:38:09,839 --> 00:38:14,320
remote code execution

1039
00:38:11,599 --> 00:38:15,520
well i can do everything so that means i

1040
00:38:14,320 --> 00:38:17,920
have now gained

1041
00:38:15,520 --> 00:38:18,960
full control over the entire vote

1042
00:38:17,920 --> 00:38:21,520
counting system

1043
00:38:18,960 --> 00:38:22,800
so i'm not only talking about the data

1044
00:38:21,520 --> 00:38:25,200
in the database

1045
00:38:22,800 --> 00:38:27,040
i'm talking about the entire computer

1046
00:38:25,200 --> 00:38:28,000
that i cannot fully control and

1047
00:38:27,040 --> 00:38:30,640
manipulate

1048
00:38:28,000 --> 00:38:31,760
however i want to and that's possible

1049
00:38:30,640 --> 00:38:34,960
only by using

1050
00:38:31,760 --> 00:38:36,880
devoting software and accessing it over

1051
00:38:34,960 --> 00:38:37,920
the network interfaces that it has

1052
00:38:36,880 --> 00:38:40,160
exposed

1053
00:38:37,920 --> 00:38:42,800
and now i will show you how simple this

1054
00:38:40,160 --> 00:38:47,680
is to execute a arbitrary program

1055
00:38:42,800 --> 00:38:49,520
on the system

1056
00:38:47,680 --> 00:38:50,720
this is the vote counting computer

1057
00:38:49,520 --> 00:38:53,440
system

1058
00:38:50,720 --> 00:38:56,000
to begin let's start the vote counting

1059
00:38:53,440 --> 00:38:56,000
software

1060
00:38:59,119 --> 00:39:02,480
now the apache tomcat web server and the

1061
00:39:02,000 --> 00:39:06,960
mri

1062
00:39:02,480 --> 00:39:11,040
db database server are being launched

1063
00:39:06,960 --> 00:39:14,320
finally the firefox portable is started

1064
00:39:11,040 --> 00:39:17,359
the system is now ready for operation

1065
00:39:14,320 --> 00:39:22,000
but beware the attacker becomes active

1066
00:39:17,359 --> 00:39:23,839
his host name is the infamous pci 1939

1067
00:39:22,000 --> 00:39:25,040
immediately he launches the python

1068
00:39:23,839 --> 00:39:29,680
attack script

1069
00:39:25,040 --> 00:39:32,320
fun dot pi it connects to the mariah db

1070
00:39:29,680 --> 00:39:34,799
server as root without password and

1071
00:39:32,320 --> 00:39:36,640
uploads a malicious dll plugin

1072
00:39:34,800 --> 00:39:40,560
when the upload has been finished the

1073
00:39:36,640 --> 00:39:40,560
malicious plugin is executed

1074
00:39:40,720 --> 00:39:46,000
as we can see the calculator was started

1075
00:39:43,839 --> 00:39:47,119
thus remote code execution was

1076
00:39:46,000 --> 00:39:49,920
successful

1077
00:39:47,119 --> 00:39:51,440
the vote counting computer system is now

1078
00:39:49,920 --> 00:39:53,920
under control of the

1079
00:39:51,440 --> 00:39:53,920
attacker

1080
00:39:55,040 --> 00:40:00,320
after we have found those devastating

1081
00:39:58,320 --> 00:40:04,319
issues with the vote counting software

1082
00:40:00,320 --> 00:40:06,319
we immediately notified the vendor akdb

1083
00:40:04,319 --> 00:40:08,560
and they were very professional about it

1084
00:40:06,319 --> 00:40:12,160
and responded very quickly to our

1085
00:40:08,560 --> 00:40:13,520
initial emails so we really liked

1086
00:40:12,160 --> 00:40:16,560
working together with them

1087
00:40:13,520 --> 00:40:18,880
and telling them our results and they

1088
00:40:16,560 --> 00:40:19,599
were always always always positive about

1089
00:40:18,880 --> 00:40:22,880
it

1090
00:40:19,599 --> 00:40:25,359
so they also recommended some fixes

1091
00:40:22,880 --> 00:40:27,440
so for example they told us you should

1092
00:40:25,359 --> 00:40:29,279
only use that voting software in a

1093
00:40:27,440 --> 00:40:31,040
secure environment like in an

1094
00:40:29,280 --> 00:40:33,760
administration

1095
00:40:31,040 --> 00:40:35,440
network however we don't really believe

1096
00:40:33,760 --> 00:40:37,200
that this is a good solution

1097
00:40:35,440 --> 00:40:39,119
exactly and we're not very happy about

1098
00:40:37,200 --> 00:40:41,359
this proposal because

1099
00:40:39,119 --> 00:40:43,280
um we have two problems that still arise

1100
00:40:41,359 --> 00:40:46,400
even if it's in a secure environment

1101
00:40:43,280 --> 00:40:48,640
first of all an administrative pc

1102
00:40:46,400 --> 00:40:50,880
could still be infected with some

1103
00:40:48,640 --> 00:40:54,160
malware or it could be manipulated

1104
00:40:50,880 --> 00:40:55,119
for the election takes place and in the

1105
00:40:54,160 --> 00:40:56,879
second hand

1106
00:40:55,119 --> 00:40:58,480
we had this buck with the broken access

1107
00:40:56,880 --> 00:41:00,960
control you remember

1108
00:40:58,480 --> 00:41:03,200
and even if you would have been in a

1109
00:41:00,960 --> 00:41:04,960
secure environment this bug would have

1110
00:41:03,200 --> 00:41:07,359
been totally worked and you could have

1111
00:41:04,960 --> 00:41:09,359
completely deleted all data work

1112
00:41:07,359 --> 00:41:11,279
or re-opened elections or something like

1113
00:41:09,359 --> 00:41:13,598
this but we are still

1114
00:41:11,280 --> 00:41:14,400
quite happy that they took us seriously

1115
00:41:13,599 --> 00:41:16,880
because

1116
00:41:14,400 --> 00:41:17,680
they even have announced updates so for

1117
00:41:16,880 --> 00:41:19,680
example

1118
00:41:17,680 --> 00:41:21,919
they wrote us that they are planning on

1119
00:41:19,680 --> 00:41:24,200
adding csrf tokens

1120
00:41:21,920 --> 00:41:25,520
for the pages where we found cross-site

1121
00:41:24,200 --> 00:41:27,759
vulnerabilities

1122
00:41:25,520 --> 00:41:29,040
so that's already a good step into the

1123
00:41:27,760 --> 00:41:32,560
right direction

1124
00:41:29,040 --> 00:41:34,079
so now let's summarize what we have

1125
00:41:32,560 --> 00:41:37,040
presented today

1126
00:41:34,079 --> 00:41:39,440
so first of all we discovered several

1127
00:41:37,040 --> 00:41:41,680
problematic aspects in the concept

1128
00:41:39,440 --> 00:41:44,000
and its practical implementation so

1129
00:41:41,680 --> 00:41:44,799
first of all the entire voting system

1130
00:41:44,000 --> 00:41:47,920
it's running

1131
00:41:44,800 --> 00:41:50,400
on untrustworthy computer systems they

1132
00:41:47,920 --> 00:41:53,599
could have been manipulated beforehand

1133
00:41:50,400 --> 00:41:54,000
they could have malware on them or they

1134
00:41:53,599 --> 00:41:56,160
just

1135
00:41:54,000 --> 00:41:58,160
could not just function correctly so

1136
00:41:56,160 --> 00:41:58,879
that's already very problematic from the

1137
00:41:58,160 --> 00:42:01,598
beginning

1138
00:41:58,880 --> 00:42:02,000
because we have no underlying trust that

1139
00:42:01,599 --> 00:42:04,480
we can

1140
00:42:02,000 --> 00:42:05,520
put into those systems and we are using

1141
00:42:04,480 --> 00:42:08,240
them to count

1142
00:42:05,520 --> 00:42:09,599
out our votes to count out the entire

1143
00:42:08,240 --> 00:42:12,799
election

1144
00:42:09,599 --> 00:42:14,800
so what's even more is that even if we

1145
00:42:12,800 --> 00:42:18,800
use the software and the pc

1146
00:42:14,800 --> 00:42:22,240
uh that lies beyond it is secure

1147
00:42:18,800 --> 00:42:24,160
it still has not enough transparency

1148
00:42:22,240 --> 00:42:25,839
it's very hard to understand what the

1149
00:42:24,160 --> 00:42:28,960
software is exactly doing

1150
00:42:25,839 --> 00:42:30,240
and how is it doing this so i cannot

1151
00:42:28,960 --> 00:42:32,720
really understand how

1152
00:42:30,240 --> 00:42:34,319
does it come to its results please keep

1153
00:42:32,720 --> 00:42:37,200
in mind that we have

1154
00:42:34,319 --> 00:42:39,119
almost 600 candidates and several

1155
00:42:37,200 --> 00:42:42,319
hundreds of ballots that have all

1156
00:42:39,119 --> 00:42:44,400
to be input into that computer system

1157
00:42:42,319 --> 00:42:45,759
and then some magic happens and it spits

1158
00:42:44,400 --> 00:42:47,760
out its result

1159
00:42:45,760 --> 00:42:49,040
so then we just have to take this result

1160
00:42:47,760 --> 00:42:52,240
because it's

1161
00:42:49,040 --> 00:42:54,160
just impossible to check if really each

1162
00:42:52,240 --> 00:42:56,000
vote has been counted correctly

1163
00:42:54,160 --> 00:42:59,040
or if there anything strange has

1164
00:42:56,000 --> 00:43:01,680
happened or any manipulation took place

1165
00:42:59,040 --> 00:43:02,079
and this is also possible because we

1166
00:43:01,680 --> 00:43:05,040
found

1167
00:43:02,079 --> 00:43:07,040
lots of vulnerable software and not just

1168
00:43:05,040 --> 00:43:09,520
the system security was affected

1169
00:43:07,040 --> 00:43:12,640
but it was also absolutely possible to

1170
00:43:09,520 --> 00:43:15,680
manipulate the whole election from

1171
00:43:12,640 --> 00:43:19,040
very many parts in the network

1172
00:43:15,680 --> 00:43:21,279
and this lets us to conclude that these

1173
00:43:19,040 --> 00:43:22,880
elections are at a high risk with this

1174
00:43:21,280 --> 00:43:25,520
technology

1175
00:43:22,880 --> 00:43:26,240
so and this is the reason that we want

1176
00:43:25,520 --> 00:43:28,640
you

1177
00:43:26,240 --> 00:43:29,839
as election worker the more eyes are

1178
00:43:28,640 --> 00:43:32,319
looking at the election

1179
00:43:29,839 --> 00:43:33,920
the more secure it becomes and if you

1180
00:43:32,319 --> 00:43:34,640
are interested in becoming an election

1181
00:43:33,920 --> 00:43:36,480
worker

1182
00:43:34,640 --> 00:43:38,720
just get into contact with your local

1183
00:43:36,480 --> 00:43:39,280
administration they are always very

1184
00:43:38,720 --> 00:43:42,399
happy

1185
00:43:39,280 --> 00:43:45,200
to have volunteers who want to take part

1186
00:43:42,400 --> 00:43:46,240
as election workers so and from my

1187
00:43:45,200 --> 00:43:48,000
personal experience

1188
00:43:46,240 --> 00:43:50,160
i'm doing this for several years now

1189
00:43:48,000 --> 00:43:52,880
it's also a lot of fun you get into

1190
00:43:50,160 --> 00:43:55,440
contact with a lot of people so i enjoy

1191
00:43:52,880 --> 00:43:58,880
this a lot and i can just recommend it

1192
00:43:55,440 --> 00:43:59,359
and this is a good way how every one of

1193
00:43:58,880 --> 00:44:02,000
us

1194
00:43:59,359 --> 00:44:03,440
can support the democracy in their

1195
00:44:02,000 --> 00:44:06,079
country

1196
00:44:03,440 --> 00:44:08,240
so to conclude our talk we found out

1197
00:44:06,079 --> 00:44:12,720
that security in this technology is

1198
00:44:08,240 --> 00:44:15,040
really bad and that's not all of it

1199
00:44:12,720 --> 00:44:17,200
so this is just the tip of the iceberg

1200
00:44:15,040 --> 00:44:19,200
because we looked only at one of the

1201
00:44:17,200 --> 00:44:20,078
solutions that is available for vote

1202
00:44:19,200 --> 00:44:21,680
counting

1203
00:44:20,079 --> 00:44:23,280
and this was also in a special

1204
00:44:21,680 --> 00:44:26,640
configuration

1205
00:44:23,280 --> 00:44:30,319
so what is even more difficult to see

1206
00:44:26,640 --> 00:44:31,839
is what happens behind all the stuff we

1207
00:44:30,319 --> 00:44:34,960
have seen today because

1208
00:44:31,839 --> 00:44:37,040
when we uh export the data and

1209
00:44:34,960 --> 00:44:39,200
bring it to the central administration

1210
00:44:37,040 --> 00:44:41,359
and the data is imported and uploaded

1211
00:44:39,200 --> 00:44:43,520
so where does all this data go where are

1212
00:44:41,359 --> 00:44:45,598
all the results from all these data

1213
00:44:43,520 --> 00:44:46,560
from all um the polling station are

1214
00:44:45,599 --> 00:44:48,480
summarized

1215
00:44:46,560 --> 00:44:50,078
we don't know that how this works we

1216
00:44:48,480 --> 00:44:51,040
don't have the software that we can

1217
00:44:50,079 --> 00:44:53,200
analyze

1218
00:44:51,040 --> 00:44:54,640
so there is still a lot of work that has

1219
00:44:53,200 --> 00:44:57,118
to be done

1220
00:44:54,640 --> 00:44:57,680
here to really check the entire system

1221
00:44:57,119 --> 00:45:00,160
we just

1222
00:44:57,680 --> 00:45:00,799
took a look at a very small portion and

1223
00:45:00,160 --> 00:45:04,000
that is

1224
00:45:00,800 --> 00:45:06,720
just devote counting software here next

1225
00:45:04,000 --> 00:45:08,560
we were very shocked that this

1226
00:45:06,720 --> 00:45:09,759
information that vote counting is

1227
00:45:08,560 --> 00:45:11,759
already

1228
00:45:09,760 --> 00:45:14,079
shifted to software is not publicly

1229
00:45:11,760 --> 00:45:16,800
known and this is also why we

1230
00:45:14,079 --> 00:45:18,960
we created this talk today as this is an

1231
00:45:16,800 --> 00:45:22,160
information that is crucial for

1232
00:45:18,960 --> 00:45:24,400
the democracy that uh there is already

1233
00:45:22,160 --> 00:45:25,680
this software in use and it is not

1234
00:45:24,400 --> 00:45:29,280
really secure

1235
00:45:25,680 --> 00:45:32,799
so this was a big uh thing for us to

1236
00:45:29,280 --> 00:45:35,119
to keep uh bring it out to the people

1237
00:45:32,800 --> 00:45:35,920
so and one other thing is everything

1238
00:45:35,119 --> 00:45:39,520
that we have

1239
00:45:35,920 --> 00:45:41,920
seen today is entirely legal because

1240
00:45:39,520 --> 00:45:42,640
at least in bahrain we don't have any

1241
00:45:41,920 --> 00:45:45,680
rules

1242
00:45:42,640 --> 00:45:47,759
or any laws against the use of unsecured

1243
00:45:45,680 --> 00:45:49,200
computer systems of unsecured vote

1244
00:45:47,760 --> 00:45:51,520
counting software

1245
00:45:49,200 --> 00:45:52,640
so as we've seen in the beginning we

1246
00:45:51,520 --> 00:45:54,880
only have very

1247
00:45:52,640 --> 00:45:56,879
rough legal guidelines where it says

1248
00:45:54,880 --> 00:45:57,520
well you can just use computers for vote

1249
00:45:56,880 --> 00:46:00,000
counting

1250
00:45:57,520 --> 00:46:00,960
but we need stricter guidelines here

1251
00:46:00,000 --> 00:46:03,280
because

1252
00:46:00,960 --> 00:46:04,079
it cannot continue as we've seen it

1253
00:46:03,280 --> 00:46:06,720
today

1254
00:46:04,079 --> 00:46:07,440
and in other states in germany there is

1255
00:46:06,720 --> 00:46:09,839
sometimes

1256
00:46:07,440 --> 00:46:12,800
sometimes something like let's say

1257
00:46:09,839 --> 00:46:15,520
guidelines or even certification process

1258
00:46:12,800 --> 00:46:17,440
for such digital software but in most

1259
00:46:15,520 --> 00:46:20,079
states that i had a look at

1260
00:46:17,440 --> 00:46:21,760
there are no rules at all and that is

1261
00:46:20,079 --> 00:46:25,200
nothing that should continue

1262
00:46:21,760 --> 00:46:28,400
in the next years that way additionally

1263
00:46:25,200 --> 00:46:31,200
in the end before any of this software

1264
00:46:28,400 --> 00:46:32,240
to electronically count the votes should

1265
00:46:31,200 --> 00:46:35,118
go live

1266
00:46:32,240 --> 00:46:36,240
unbiased tests for everyone should be

1267
00:46:35,119 --> 00:46:38,720
available

1268
00:46:36,240 --> 00:46:40,640
to prove themselves that this software

1269
00:46:38,720 --> 00:46:42,959
is secure and this software is

1270
00:46:40,640 --> 00:46:44,000
doing what it's promising to us because

1271
00:46:42,960 --> 00:46:46,960
it is directly

1272
00:46:44,000 --> 00:46:48,400
influencing our democracy and if this

1273
00:46:46,960 --> 00:46:51,119
software is manipulated

1274
00:46:48,400 --> 00:46:52,560
it manipulates our voting our election

1275
00:46:51,119 --> 00:46:54,560
in our democracy

1276
00:46:52,560 --> 00:46:56,160
so in the end we can just leave you with

1277
00:46:54,560 --> 00:46:58,960
two questions

1278
00:46:56,160 --> 00:46:59,680
how much digital support is required and

1279
00:46:58,960 --> 00:47:11,839
how much

1280
00:46:59,680 --> 00:47:11,839
is tolerable

1281
00:47:19,520 --> 00:47:23,839
thank you very much for the interesting

1282
00:47:21,119 --> 00:47:26,960
talk johannes and

1283
00:47:23,839 --> 00:47:30,720
and thank you very much for your work

1284
00:47:26,960 --> 00:47:32,000
on the topic uh i hope you do have time

1285
00:47:30,720 --> 00:47:36,078
for a little q a as

1286
00:47:32,000 --> 00:47:38,880
we have quite a few questions actually

1287
00:47:36,079 --> 00:47:39,760
sure that is okay all right um so the

1288
00:47:38,880 --> 00:47:42,079
first question

1289
00:47:39,760 --> 00:47:43,040
from the internet is is there any

1290
00:47:42,079 --> 00:47:45,280
suspicion

1291
00:47:43,040 --> 00:47:48,160
that these vulnerabilities have been

1292
00:47:45,280 --> 00:47:51,599
actively used

1293
00:47:48,160 --> 00:47:52,000
well it's very hard to tell so at least

1294
00:47:51,599 --> 00:47:56,079
for the

1295
00:47:52,000 --> 00:47:59,440
town that i'm from i did not notice

1296
00:47:56,079 --> 00:48:02,480
any um yeah special occurrences there

1297
00:47:59,440 --> 00:48:03,680
so however i don't have an overview over

1298
00:48:02,480 --> 00:48:05,839
entire bavaria

1299
00:48:03,680 --> 00:48:07,598
so that's quite hard to tell i think

1300
00:48:05,839 --> 00:48:10,960
it's even impossible to tell

1301
00:48:07,599 --> 00:48:14,400
if there were any manipulations so far

1302
00:48:10,960 --> 00:48:17,599
so unfortunately we cannot say that

1303
00:48:14,400 --> 00:48:19,680
additionally we just uh at one place in

1304
00:48:17,599 --> 00:48:22,160
in this whole system so we don't have an

1305
00:48:19,680 --> 00:48:25,680
overview if there was any

1306
00:48:22,160 --> 00:48:27,440
mismatching numbers or there any other

1307
00:48:25,680 --> 00:48:29,118
influences that happened but that we

1308
00:48:27,440 --> 00:48:31,359
didn't see at the moment

1309
00:48:29,119 --> 00:48:33,200
because we were just at one position in

1310
00:48:31,359 --> 00:48:36,960
this system at one station of the

1311
00:48:33,200 --> 00:48:39,279
of the election okay

1312
00:48:36,960 --> 00:48:41,280
uh thank you for the answer ah do you

1313
00:48:39,280 --> 00:48:42,559
believe that it is possible to have a

1314
00:48:41,280 --> 00:48:45,520
digital boat that is

1315
00:48:42,559 --> 00:48:48,240
as secure and trustworthy as physical or

1316
00:48:45,520 --> 00:48:51,280
paper-based voting is

1317
00:48:48,240 --> 00:48:53,279
well in my opinion that's not

1318
00:48:51,280 --> 00:48:55,599
possible if you want to have this same

1319
00:48:53,280 --> 00:48:57,680
sort of transparency

1320
00:48:55,599 --> 00:48:58,720
that we have in the paper based voting

1321
00:48:57,680 --> 00:49:01,359
system because

1322
00:48:58,720 --> 00:49:02,160
when we have paper-based voting we can

1323
00:49:01,359 --> 00:49:04,558
just go

1324
00:49:02,160 --> 00:49:05,520
into the voting room and watch what's

1325
00:49:04,559 --> 00:49:07,680
going on there

1326
00:49:05,520 --> 00:49:09,040
we can see the ballots that are handed

1327
00:49:07,680 --> 00:49:11,919
in the ballots

1328
00:49:09,040 --> 00:49:13,440
that come out of the box then they are

1329
00:49:11,920 --> 00:49:16,160
counted are summed up

1330
00:49:13,440 --> 00:49:17,599
i can really try to find out what's

1331
00:49:16,160 --> 00:49:20,160
going on there

1332
00:49:17,599 --> 00:49:21,200
i can have a look at that understand

1333
00:49:20,160 --> 00:49:23,520
what the people are

1334
00:49:21,200 --> 00:49:25,919
doing there but the moment that we i

1335
00:49:23,520 --> 00:49:29,280
have only a digital vote

1336
00:49:25,920 --> 00:49:30,000
i cannot really find out if the computer

1337
00:49:29,280 --> 00:49:32,559
is doing the right

1338
00:49:30,000 --> 00:49:33,200
thing if there were some manipulations

1339
00:49:32,559 --> 00:49:36,240
so

1340
00:49:33,200 --> 00:49:37,279
in terms of transparency i don't think

1341
00:49:36,240 --> 00:49:40,399
it is possible

1342
00:49:37,280 --> 00:49:44,319
in the same uh yeah in the same way as

1343
00:49:40,400 --> 00:49:47,440
any paper-based dialogues for example

1344
00:49:44,319 --> 00:49:48,079
i would have to add to this if there

1345
00:49:47,440 --> 00:49:50,400
would be

1346
00:49:48,079 --> 00:49:52,640
the possibility to get the same

1347
00:49:50,400 --> 00:49:56,000
traceability and

1348
00:49:52,640 --> 00:49:58,960
visibility that we can always see which

1349
00:49:56,000 --> 00:50:00,000
results came from from which position

1350
00:49:58,960 --> 00:50:02,960
and if they're

1351
00:50:00,000 --> 00:50:04,559
signed very transparent then it would

1352
00:50:02,960 --> 00:50:07,680
maybe be possible in any

1353
00:50:04,559 --> 00:50:12,319
future but not with any kind of

1354
00:50:07,680 --> 00:50:15,680
this software we saw there

1355
00:50:12,319 --> 00:50:17,839
all right thank you um

1356
00:50:15,680 --> 00:50:20,000
do you by any chance know which states

1357
00:50:17,839 --> 00:50:23,119
in germany use the software um

1358
00:50:20,000 --> 00:50:25,920
okay both as far

1359
00:50:23,119 --> 00:50:27,920
we cannot directly say which states

1360
00:50:25,920 --> 00:50:29,760
actively use them because we only

1361
00:50:27,920 --> 00:50:32,240
took place in the elections here in

1362
00:50:29,760 --> 00:50:35,359
munich or bavaria

1363
00:50:32,240 --> 00:50:37,839
but we can tell that we found very much

1364
00:50:35,359 --> 00:50:41,440
hints in the source code that they were

1365
00:50:37,839 --> 00:50:44,799
also used in for example hamburg bremen

1366
00:50:41,440 --> 00:50:48,240
hessen or renland fan files

1367
00:50:44,800 --> 00:50:50,720
but we don't know if they were already

1368
00:50:48,240 --> 00:50:51,359
used there or if it's planned to be to

1369
00:50:50,720 --> 00:50:54,000
be used

1370
00:50:51,359 --> 00:50:54,558
there or if they did already use them in

1371
00:50:54,000 --> 00:50:57,280
the past

1372
00:50:54,559 --> 00:50:58,800
elections and decided against them for

1373
00:50:57,280 --> 00:51:02,000
future ones we don't know

1374
00:50:58,800 --> 00:51:03,599
about this exactly okay

1375
00:51:02,000 --> 00:51:06,240
maybe you can stay for a second on your

1376
00:51:03,599 --> 00:51:09,760
job as a election

1377
00:51:06,240 --> 00:51:12,959
worker um the process of manually

1378
00:51:09,760 --> 00:51:14,480
um entering data into the system um is

1379
00:51:12,960 --> 00:51:15,280
there a process for this do you have an

1380
00:51:14,480 --> 00:51:18,559
idea on the

1381
00:51:15,280 --> 00:51:21,359
on the risk of this part here yes so

1382
00:51:18,559 --> 00:51:22,000
it's basically the thing that there are

1383
00:51:21,359 --> 00:51:24,558
at least

1384
00:51:22,000 --> 00:51:26,880
two or three people sitting in front of

1385
00:51:24,559 --> 00:51:27,920
each computer and then they are entering

1386
00:51:26,880 --> 00:51:30,000
each ballot

1387
00:51:27,920 --> 00:51:31,040
so people are really cross-checking that

1388
00:51:30,000 --> 00:51:34,000
the ballot has

1389
00:51:31,040 --> 00:51:36,160
been entered correctly so it's like one

1390
00:51:34,000 --> 00:51:36,880
person has developed in front of him or

1391
00:51:36,160 --> 00:51:40,078
her

1392
00:51:36,880 --> 00:51:41,680
and the other person reads the votes and

1393
00:51:40,079 --> 00:51:43,760
the other person types it in

1394
00:51:41,680 --> 00:51:45,759
and they are cross-checking each other

1395
00:51:43,760 --> 00:51:48,960
so that there isn't any

1396
00:51:45,760 --> 00:51:52,160
error during typing in those election

1397
00:51:48,960 --> 00:51:52,160
results in your computer

1398
00:51:52,800 --> 00:51:55,920
all right thank you for the elaboration

1399
00:51:55,520 --> 00:51:58,319
um

1400
00:51:55,920 --> 00:52:00,240
someone is asking are the systems

1401
00:51:58,319 --> 00:52:00,800
connected to the internet or some other

1402
00:52:00,240 --> 00:52:02,720
network

1403
00:52:00,800 --> 00:52:04,160
um if the understanding of your talk was

1404
00:52:02,720 --> 00:52:06,720
correctly received

1405
00:52:04,160 --> 00:52:08,558
by that person the results are written

1406
00:52:06,720 --> 00:52:11,759
to some physical medium which is

1407
00:52:08,559 --> 00:52:14,079
turned in to transmit um the results so

1408
00:52:11,760 --> 00:52:16,559
you sense something physically

1409
00:52:14,079 --> 00:52:17,520
so why care for the windows version or

1410
00:52:16,559 --> 00:52:19,839
the uh

1411
00:52:17,520 --> 00:52:21,280
that is running on these machines is

1412
00:52:19,839 --> 00:52:24,319
that correct understanding

1413
00:52:21,280 --> 00:52:26,000
well the problem with that is

1414
00:52:24,319 --> 00:52:28,160
that it depends on the local

1415
00:52:26,000 --> 00:52:31,440
administration how they set up their

1416
00:52:28,160 --> 00:52:33,598
computer systems so i also read this in

1417
00:52:31,440 --> 00:52:36,240
the chat here someone has uh

1418
00:52:33,599 --> 00:52:37,040
written that they had their voting

1419
00:52:36,240 --> 00:52:40,959
software

1420
00:52:37,040 --> 00:52:44,079
in an yeah in a very limited network

1421
00:52:40,960 --> 00:52:46,720
connectivity so the computer

1422
00:52:44,079 --> 00:52:47,440
was not connected to the internet

1423
00:52:46,720 --> 00:52:49,520
however

1424
00:52:47,440 --> 00:52:51,200
it depends very on the administration

1425
00:52:49,520 --> 00:52:52,559
and on the computer network that is

1426
00:52:51,200 --> 00:52:54,558
being used there

1427
00:52:52,559 --> 00:52:57,200
so it is entirely possible that

1428
00:52:54,559 --> 00:53:00,079
computers are connected to the internet

1429
00:52:57,200 --> 00:53:01,118
because there are no guidelines on how

1430
00:53:00,079 --> 00:53:03,680
these computers

1431
00:53:01,119 --> 00:53:04,480
are allowed to be set up so i cannot

1432
00:53:03,680 --> 00:53:06,879
fully

1433
00:53:04,480 --> 00:53:08,480
exclude this so and if someone for

1434
00:53:06,880 --> 00:53:11,359
example just enables

1435
00:53:08,480 --> 00:53:12,640
the wireless network or connects to some

1436
00:53:11,359 --> 00:53:15,520
unsecured hotspot

1437
00:53:12,640 --> 00:53:16,879
they are connected then so it's it's

1438
00:53:15,520 --> 00:53:19,920
hard to tell here but

1439
00:53:16,880 --> 00:53:22,720
i would not exclude this possibility

1440
00:53:19,920 --> 00:53:24,800
to extend the answer we even try to find

1441
00:53:22,720 --> 00:53:26,399
out if there is any software site

1442
00:53:24,800 --> 00:53:27,119
protections that checks if there is

1443
00:53:26,400 --> 00:53:29,599
inter

1444
00:53:27,119 --> 00:53:30,960
connection present and would then deny

1445
00:53:29,599 --> 00:53:32,800
this voting system but

1446
00:53:30,960 --> 00:53:34,079
uh there wasn't or at least we couldn't

1447
00:53:32,800 --> 00:53:36,400
find one so

1448
00:53:34,079 --> 00:53:37,119
even if the administration was not

1449
00:53:36,400 --> 00:53:40,720
advised

1450
00:53:37,119 --> 00:53:43,119
uh if the pt pcs should be disconnected

1451
00:53:40,720 --> 00:53:45,040
from this uh from the network

1452
00:53:43,119 --> 00:53:46,880
there isn't even a security mission in

1453
00:53:45,040 --> 00:53:47,119
place that would check this and stop it

1454
00:53:46,880 --> 00:53:49,119
or

1455
00:53:47,119 --> 00:53:50,319
even show a warning that this is

1456
00:53:49,119 --> 00:53:51,920
connected and they should be

1457
00:53:50,319 --> 00:53:54,960
disconnected from the internet before

1458
00:53:51,920 --> 00:53:54,960
the counting can begin

1459
00:53:55,680 --> 00:54:01,440
interesting all right um

1460
00:53:58,720 --> 00:54:02,959
we have one message on the irc from

1461
00:54:01,440 --> 00:54:04,640
someone who worked with these

1462
00:54:02,960 --> 00:54:06,319
uh this particular piece of software in

1463
00:54:04,640 --> 00:54:08,799
demo mode um

1464
00:54:06,319 --> 00:54:10,000
by themselves obviously and the question

1465
00:54:08,800 --> 00:54:14,240
they have is

1466
00:54:10,000 --> 00:54:14,880
um did you notice a possibility to enter

1467
00:54:14,240 --> 00:54:18,078
negative

1468
00:54:14,880 --> 00:54:21,040
votes for a candidate so saying minus

1469
00:54:18,079 --> 00:54:21,040
two votes for instance

1470
00:54:22,400 --> 00:54:28,559
well that's that's difficult to tell i

1471
00:54:25,680 --> 00:54:29,520
thought about if this is possible so

1472
00:54:28,559 --> 00:54:31,119
perhaps

1473
00:54:29,520 --> 00:54:32,960
you might have to manipulate the

1474
00:54:31,119 --> 00:54:36,079
database directly

1475
00:54:32,960 --> 00:54:38,480
um so i'm not entirely sure i'm not sure

1476
00:54:36,079 --> 00:54:41,920
if i tried this out this one

1477
00:54:38,480 --> 00:54:44,319
so but however as soon as i data

1478
00:54:41,920 --> 00:54:46,079
as i have database access it's entirely

1479
00:54:44,319 --> 00:54:49,839
possible to manipulate

1480
00:54:46,079 --> 00:54:51,200
anything so well we could try this out

1481
00:54:49,839 --> 00:54:53,119
again

1482
00:54:51,200 --> 00:54:55,200
however i don't think that it changes

1483
00:54:53,119 --> 00:54:58,240
much in our result

1484
00:54:55,200 --> 00:55:00,078
so yeah that's an interesting question

1485
00:54:58,240 --> 00:55:03,279
so far i cannot answer this

1486
00:55:00,079 --> 00:55:06,640
right now so i'm not sure to be have you

1487
00:55:03,280 --> 00:55:10,000
tried out something like that

1488
00:55:06,640 --> 00:55:10,720
we've tried manipulating um some already

1489
00:55:10,000 --> 00:55:13,599
submitted

1490
00:55:10,720 --> 00:55:15,200
uh votes but i think this was not was

1491
00:55:13,599 --> 00:55:18,000
not really possible

1492
00:55:15,200 --> 00:55:20,558
however as you showed when you export

1493
00:55:18,000 --> 00:55:23,200
the data and import into the main pc

1494
00:55:20,559 --> 00:55:25,040
the votes that were already in place

1495
00:55:23,200 --> 00:55:27,359
possibly by an attacker

1496
00:55:25,040 --> 00:55:28,640
would then discard the newly imported

1497
00:55:27,359 --> 00:55:30,960
votes so this would

1498
00:55:28,640 --> 00:55:32,400
probably replace this data and put these

1499
00:55:30,960 --> 00:55:35,200
votes

1500
00:55:32,400 --> 00:55:36,559
but via the web interface i think it was

1501
00:55:35,200 --> 00:55:38,558
not possible

1502
00:55:36,559 --> 00:55:40,240
however we found enough vulnerabilities

1503
00:55:38,559 --> 00:55:42,319
with database access that

1504
00:55:40,240 --> 00:55:44,720
um you could do it by this way if you

1505
00:55:42,319 --> 00:55:44,720
want to

1506
00:55:44,880 --> 00:55:51,680
all right thank you for your explanation

1507
00:55:48,319 --> 00:55:54,319
um out of pure curiosity people ask

1508
00:55:51,680 --> 00:55:55,520
how did you get access to the soap in

1509
00:55:54,319 --> 00:55:56,720
the first place to carry out your

1510
00:55:55,520 --> 00:55:58,720
analysis

1511
00:55:56,720 --> 00:56:01,279
well that that's a good question here

1512
00:55:58,720 --> 00:56:04,480
because that's a nice story behind that

1513
00:56:01,280 --> 00:56:08,079
so i was election worker and i was

1514
00:56:04,480 --> 00:56:10,640
supporting setting up the system and

1515
00:56:08,079 --> 00:56:12,559
doing some id support in the evening and

1516
00:56:10,640 --> 00:56:14,558
at some point we tried to merge our

1517
00:56:12,559 --> 00:56:16,319
results so we exported

1518
00:56:14,559 --> 00:56:17,599
the results from one computer to move

1519
00:56:16,319 --> 00:56:20,720
them to the other one

1520
00:56:17,599 --> 00:56:22,720
however the import failed because there

1521
00:56:20,720 --> 00:56:24,799
is some artificial limitation in

1522
00:56:22,720 --> 00:56:27,040
software so as soon as your

1523
00:56:24,799 --> 00:56:28,880
export files are larger than 10

1524
00:56:27,040 --> 00:56:30,400
megabytes they cannot be imported

1525
00:56:28,880 --> 00:56:32,640
anymore

1526
00:56:30,400 --> 00:56:34,640
so this happens quite quickly when you

1527
00:56:32,640 --> 00:56:36,879
have a few hundreds of roads

1528
00:56:34,640 --> 00:56:38,799
or a few hundreds of ballots and then

1529
00:56:36,880 --> 00:56:40,720
the input doesn't work anymore and i had

1530
00:56:38,799 --> 00:56:42,720
a look at this file and was just a json

1531
00:56:40,720 --> 00:56:44,399
file with a lot of white space

1532
00:56:42,720 --> 00:56:45,919
so i copied all this stuff to my

1533
00:56:44,400 --> 00:56:48,000
computer to fix this

1534
00:56:45,920 --> 00:56:49,839
and there was also later on a software

1535
00:56:48,000 --> 00:56:51,760
fix that was published by the software

1536
00:56:49,839 --> 00:56:53,359
vendor

1537
00:56:51,760 --> 00:56:55,440
however then i had the software on my

1538
00:56:53,359 --> 00:56:56,480
computer just because i wanted to fix

1539
00:56:55,440 --> 00:56:58,079
this election

1540
00:56:56,480 --> 00:56:59,920
and it was very late at night then i

1541
00:56:58,079 --> 00:57:01,599
returned home and i noticed oh i still

1542
00:56:59,920 --> 00:57:04,400
have that software on my computer let's

1543
00:57:01,599 --> 00:57:04,400
have a look at this

1544
00:57:04,799 --> 00:57:08,880
so yeah it was just by by chance so i

1545
00:57:07,200 --> 00:57:11,040
tried to fix something

1546
00:57:08,880 --> 00:57:12,640
got all the software on my pc and then i

1547
00:57:11,040 --> 00:57:15,279
had it ready to analyze

1548
00:57:12,640 --> 00:57:15,920
even with some yeah data on that though

1549
00:57:15,280 --> 00:57:18,240
that i

1550
00:57:15,920 --> 00:57:18,960
really knew how this works in practice

1551
00:57:18,240 --> 00:57:22,319
and

1552
00:57:18,960 --> 00:57:24,319
yes but if someone would

1553
00:57:22,319 --> 00:57:25,599
try to gain access to that software

1554
00:57:24,319 --> 00:57:27,599
that's quite simple

1555
00:57:25,599 --> 00:57:29,680
because they could just restore the

1556
00:57:27,599 --> 00:57:30,799
deleted data from one of the computers

1557
00:57:29,680 --> 00:57:33,279
that are in the schools

1558
00:57:30,799 --> 00:57:35,759
perhaps someone doesn't even delete the

1559
00:57:33,280 --> 00:57:38,480
election software from a computer

1560
00:57:35,760 --> 00:57:40,640
in the school or some person could just

1561
00:57:38,480 --> 00:57:42,559
steal one of the usb sticks that have

1562
00:57:40,640 --> 00:57:45,920
been used for installation

1563
00:57:42,559 --> 00:57:48,799
so i don't even think that that would

1564
00:57:45,920 --> 00:57:48,799
be noticed then

1565
00:57:50,400 --> 00:57:54,160
interesting indeed you mentioned in your

1566
00:57:53,599 --> 00:57:56,720
talk

1567
00:57:54,160 --> 00:57:58,720
that uh the software is certified by the

1568
00:57:56,720 --> 00:58:00,640
bsi and that they claim to be certified

1569
00:57:58,720 --> 00:58:01,439
by the oblivion web application security

1570
00:58:00,640 --> 00:58:04,160
project

1571
00:58:01,440 --> 00:58:05,440
but uh how could such a broken system be

1572
00:58:04,160 --> 00:58:07,680
certified by these

1573
00:58:05,440 --> 00:58:09,359
parties in the first place and what's

1574
00:58:07,680 --> 00:58:11,200
wrong with the certification process yes

1575
00:58:09,359 --> 00:58:14,558
this obviously happened

1576
00:58:11,200 --> 00:58:15,919
i mean like why not use a certified

1577
00:58:14,559 --> 00:58:17,280
school

1578
00:58:15,920 --> 00:58:19,520
why do we certify itself in the first

1579
00:58:17,280 --> 00:58:22,960
place if it gets certified

1580
00:58:19,520 --> 00:58:24,559
even if it's broken i think the first

1581
00:58:22,960 --> 00:58:25,680
point about this is that we already

1582
00:58:24,559 --> 00:58:27,680
mentioned in the talk

1583
00:58:25,680 --> 00:58:30,000
that there are no legal requirements you

1584
00:58:27,680 --> 00:58:32,399
don't need any certification that you

1585
00:58:30,000 --> 00:58:33,760
software can be used in our voting in

1586
00:58:32,400 --> 00:58:36,799
our elections here

1587
00:58:33,760 --> 00:58:40,000
in germany or in most parts of germany

1588
00:58:36,799 --> 00:58:42,160
and additionally this uh this

1589
00:58:40,000 --> 00:58:43,599
this screenshot we show where with the

1590
00:58:42,160 --> 00:58:46,799
west and the bsi

1591
00:58:43,599 --> 00:58:47,680
was just a promotion of the academy for

1592
00:58:46,799 --> 00:58:50,000
their software

1593
00:58:47,680 --> 00:58:51,200
but i think there was no real

1594
00:58:50,000 --> 00:58:53,040
certification

1595
00:58:51,200 --> 00:58:54,480
attached so we don't know if the bse

1596
00:58:53,040 --> 00:58:56,720
ever saw this software

1597
00:58:54,480 --> 00:58:58,400
for real or if they just put it on there

1598
00:58:56,720 --> 00:59:01,200
and said yeah because he certified

1599
00:58:58,400 --> 00:59:01,760
certified or uh with the bse standards

1600
00:59:01,200 --> 00:59:03,919
in mind

1601
00:59:01,760 --> 00:59:05,280
like um they already have the the i.t

1602
00:59:03,920 --> 00:59:07,359
gunshots and they maybe

1603
00:59:05,280 --> 00:59:08,319
tried to implement after after this

1604
00:59:07,359 --> 00:59:11,759
technology

1605
00:59:08,319 --> 00:59:14,880
after the system architecture but

1606
00:59:11,760 --> 00:59:15,760
the bsi never checked on it so i don't

1607
00:59:14,880 --> 00:59:18,319
think there is

1608
00:59:15,760 --> 00:59:21,200
any real certification for the software

1609
00:59:18,319 --> 00:59:23,119
so just to add a few details here

1610
00:59:21,200 --> 00:59:26,078
that's not really a certification there

1611
00:59:23,119 --> 00:59:27,760
they just said that they follow the bsi

1612
00:59:26,079 --> 00:59:29,440
and os guidelines

1613
00:59:27,760 --> 00:59:30,799
i think that was also the wording that

1614
00:59:29,440 --> 00:59:33,359
was used on the website

1615
00:59:30,799 --> 00:59:36,160
so there's no real certification behind

1616
00:59:33,359 --> 00:59:36,160
that so far

1617
00:59:36,559 --> 00:59:42,559
thank you for the answer um

1618
00:59:39,920 --> 00:59:43,680
do you know by chance how the

1619
00:59:42,559 --> 00:59:47,119
municipalities

1620
00:59:43,680 --> 00:59:51,279
published the election results

1621
00:59:47,119 --> 00:59:51,760
well i don't know in detail how it works

1622
00:59:51,280 --> 00:59:54,640
so

1623
00:59:51,760 --> 00:59:55,280
when we handed in our election results

1624
00:59:54,640 --> 00:59:58,879
they got

1625
00:59:55,280 --> 01:00:02,000
uploaded onto some other software

1626
00:59:58,880 --> 01:00:03,280
and that's also the end that i've seen

1627
01:00:02,000 --> 01:00:05,119
so they are entered in the computer

1628
01:00:03,280 --> 01:00:06,079
system and they are electronically

1629
01:00:05,119 --> 01:00:08,400
transmitted

1630
01:00:06,079 --> 01:00:09,760
and that first of all it generates a

1631
01:00:08,400 --> 01:00:12,079
preliminary result

1632
01:00:09,760 --> 01:00:13,280
and finally there's a final result

1633
01:00:12,079 --> 01:00:15,359
generated but

1634
01:00:13,280 --> 01:00:17,599
however i don't really know how this

1635
01:00:15,359 --> 01:00:20,078
works but the election results that were

1636
01:00:17,599 --> 01:00:22,720
generated this okay vote

1637
01:00:20,079 --> 01:00:25,200
are definitely going into the final

1638
01:00:22,720 --> 01:00:25,200
result

1639
01:00:25,599 --> 01:00:29,920
so perhaps there's also some paper based

1640
01:00:28,480 --> 01:00:31,359
protocol between that

1641
01:00:29,920 --> 01:00:33,520
i don't really know if they're using

1642
01:00:31,359 --> 01:00:35,839
this the data that's in the computer

1643
01:00:33,520 --> 01:00:36,640
or the data that is on the paper but

1644
01:00:35,839 --> 01:00:40,078
however

1645
01:00:36,640 --> 01:00:43,839
it doesn't change very much here

1646
01:00:40,079 --> 01:00:43,839
okay um

1647
01:00:44,559 --> 01:00:48,000
jumping over here um the last

1648
01:00:46,160 --> 01:00:50,160
question would be um what

1649
01:00:48,000 --> 01:00:51,200
in your experience how practical and

1650
01:00:50,160 --> 01:00:54,839
expensive are

1651
01:00:51,200 --> 01:00:56,240
hand recounts here and did you observe

1652
01:00:54,839 --> 01:00:59,359
these

1653
01:00:56,240 --> 01:01:01,040
i think this is very different from uh

1654
01:00:59,359 --> 01:01:02,640
election to election and from city to

1655
01:01:01,040 --> 01:01:05,040
city if this is

1656
01:01:02,640 --> 01:01:06,960
a rather small town you could probably

1657
01:01:05,040 --> 01:01:11,200
easily re-elect all this or

1658
01:01:06,960 --> 01:01:13,040
all the votes and um i recount the votes

1659
01:01:11,200 --> 01:01:14,399
but if this is a big city like munich

1660
01:01:13,040 --> 01:01:17,520
for example with

1661
01:01:14,400 --> 01:01:19,920
millions of

1662
01:01:17,520 --> 01:01:21,040
votes and you would have to recount this

1663
01:01:19,920 --> 01:01:23,520
this would

1664
01:01:21,040 --> 01:01:24,079
particularly delay the the voting or the

1665
01:01:23,520 --> 01:01:26,960
result

1666
01:01:24,079 --> 01:01:28,960
pretty much and this could have really

1667
01:01:26,960 --> 01:01:30,960
bad influences if this would happen that

1668
01:01:28,960 --> 01:01:33,920
the software has shown that

1669
01:01:30,960 --> 01:01:35,440
it has kind of manipulation happened and

1670
01:01:33,920 --> 01:01:38,079
they had to recount all the stuff by

1671
01:01:35,440 --> 01:01:40,079
hand again

1672
01:01:38,079 --> 01:01:41,119
counting this by hand is indeed very

1673
01:01:40,079 --> 01:01:43,760
very effortful

1674
01:01:41,119 --> 01:01:44,559
because they have like 70 votes per

1675
01:01:43,760 --> 01:01:47,440
ballot

1676
01:01:44,559 --> 01:01:48,960
and even summing up all that is still

1677
01:01:47,440 --> 01:01:51,920
error-prone if it's

1678
01:01:48,960 --> 01:01:52,559
done by hand so it's difficult to do

1679
01:01:51,920 --> 01:01:54,799
that

1680
01:01:52,559 --> 01:01:56,559
and up to my knowledge it's not

1681
01:01:54,799 --> 01:01:59,359
generally recounted

1682
01:01:56,559 --> 01:02:01,520
after the election so i tried to find

1683
01:01:59,359 --> 01:02:06,078
something in the internet um

1684
01:02:01,520 --> 01:02:10,079
regarding that and i just found some pdf

1685
01:02:06,079 --> 01:02:11,760
but they said well it's not practically

1686
01:02:10,079 --> 01:02:14,160
feasible to recount

1687
01:02:11,760 --> 01:02:14,960
all the election results and all the

1688
01:02:14,160 --> 01:02:18,160
ballots

1689
01:02:14,960 --> 01:02:18,720
so let's just rather do a meter level

1690
01:02:18,160 --> 01:02:22,000
check

1691
01:02:18,720 --> 01:02:24,160
on is the protocol complete how about

1692
01:02:22,000 --> 01:02:25,359
special ballots that were not really

1693
01:02:24,160 --> 01:02:28,078
clear and so on

1694
01:02:25,359 --> 01:02:32,000
but it's not like every ballot will be

1695
01:02:28,079 --> 01:02:32,000
recounted as far as i understand

1696
01:02:32,640 --> 01:02:37,200
okay oh thank you very much to mrs

1697
01:02:35,599 --> 01:02:39,760
johannes for answering all the questions

1698
01:02:37,200 --> 01:02:49,839
thank you again for your talk

1699
01:02:39,760 --> 01:02:49,839
thank you thank you

1700
01:03:14,839 --> 01:03:17,839
wow

