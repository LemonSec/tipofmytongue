1
00:00:00,000 --> 00:00:03,959
probably be the shortest one that you've

2
00:00:01,319 --> 00:00:06,830
seen all day they got about 20-25

3
00:00:03,959 --> 00:00:09,150
minutes max take questions afterwards

4
00:00:06,830 --> 00:00:12,210
get everybody out to the casino floor

5
00:00:09,150 --> 00:00:15,599
where you rather be I'm just kidding my

6
00:00:12,210 --> 00:00:18,510
name is Megan Willis the topic of this

7
00:00:15,599 --> 00:00:20,430
presentation is more like a PSA for

8
00:00:18,510 --> 00:00:22,650
organizations that have no dedicated

9
00:00:20,430 --> 00:00:25,320
security staff or maybe they do but they

10
00:00:22,650 --> 00:00:26,759
don't have a formulated IR plan or don't

11
00:00:25,320 --> 00:00:29,960
really have experience responding to

12
00:00:26,760 --> 00:00:32,279
incidents it's most likely going to be a

13
00:00:29,960 --> 00:00:33,930
receive as a PSA for those types of

14
00:00:32,279 --> 00:00:35,370
companies for those of you that work in

15
00:00:33,930 --> 00:00:37,829
large companies that have dedicated

16
00:00:35,370 --> 00:00:39,449
security staff routinely handle

17
00:00:37,829 --> 00:00:46,200
incidents some of the stuff's going to

18
00:00:39,450 --> 00:00:48,660
be you know pretty lame for you but to

19
00:00:46,200 --> 00:00:52,230
back up so the whole idea behind this

20
00:00:48,660 --> 00:00:55,440
talk is you know as parameter security

21
00:00:52,230 --> 00:00:57,828
we do a lot of Incident Response and

22
00:00:55,440 --> 00:00:59,968
digital forensic cases everything from

23
00:00:57,829 --> 00:01:02,100
supporting civil litigation in the court

24
00:00:59,969 --> 00:01:04,949
you know in any kind of civil court case

25
00:01:02,100 --> 00:01:07,159
we may do any discovery we may go in and

26
00:01:04,949 --> 00:01:10,770
just snatch evidence on a court order

27
00:01:07,159 --> 00:01:12,630
where we just get what we can we also do

28
00:01:10,770 --> 00:01:16,020
quite a bit instance Incident Response

29
00:01:12,630 --> 00:01:18,449
for mid-level companies that never think

30
00:01:16,020 --> 00:01:22,710
about this prior to their hair being on

31
00:01:18,450 --> 00:01:24,390
fire we find very regularly that there

32
00:01:22,710 --> 00:01:26,908
are some very basic things they can do

33
00:01:24,390 --> 00:01:28,590
to prepare for a potential incident we

34
00:01:26,909 --> 00:01:29,520
have some historical data to show that

35
00:01:28,590 --> 00:01:31,020
pretty much everybody's gonna get

36
00:01:29,520 --> 00:01:32,899
breached everybody already knows that a

37
00:01:31,020 --> 00:01:36,020
lot of these companies may be run by

38
00:01:32,900 --> 00:01:39,420
severe civilian boards such as banks

39
00:01:36,020 --> 00:01:41,009
they may be run by IT folks that have

40
00:01:39,420 --> 00:01:42,869
just been admins their whole life and

41
00:01:41,009 --> 00:01:45,299
they've never really put any emphasis on

42
00:01:42,869 --> 00:01:47,970
security so that's kind of the whole

43
00:01:45,299 --> 00:01:48,990
topic here my name is Vader Willis give

44
00:01:47,970 --> 00:01:53,009
you little bit background background

45
00:01:48,990 --> 00:01:56,429
about myself I've been in InfoSec for

46
00:01:53,009 --> 00:01:59,009
guys since 1998 right out of high school

47
00:01:56,430 --> 00:01:59,930
in 1991 I joined the Army Reserves did

48
00:01:59,009 --> 00:02:01,790
that old thing

49
00:01:59,930 --> 00:02:04,100
I became a state trooper in Oklahoma in

50
00:02:01,790 --> 00:02:06,350
1995 my rookie year was when the bomb

51
00:02:04,100 --> 00:02:07,880
went off downtown I did that for five

52
00:02:06,350 --> 00:02:10,519
years and decided I was tired of

53
00:02:07,880 --> 00:02:12,260
fighting for my paycheck and like every

54
00:02:10,520 --> 00:02:13,850
other cop that I knew at the time and

55
00:02:12,260 --> 00:02:16,010
you probably know now you have to have a

56
00:02:13,850 --> 00:02:18,260
second job to support yourself I was

57
00:02:16,010 --> 00:02:19,060
lucky enough at the time that in

58
00:02:18,260 --> 00:02:21,739
Oklahoma City

59
00:02:19,060 --> 00:02:24,200
AOL if you remember them had opened a

60
00:02:21,740 --> 00:02:25,610
call center and they were hiring just

61
00:02:24,200 --> 00:02:27,500
about anybody that could answer a phone

62
00:02:25,610 --> 00:02:29,960
and figure out how to read a script and

63
00:02:27,500 --> 00:02:32,600
click some buttons so they taught me how

64
00:02:29,960 --> 00:02:35,030
to be that dreaded help desk guy at the

65
00:02:32,600 --> 00:02:36,320
other end of the phone at AOL so what

66
00:02:35,030 --> 00:02:38,630
was cool about that as I would come in

67
00:02:36,320 --> 00:02:39,829
off from my shift full trooper uniform

68
00:02:38,630 --> 00:02:42,590
gun everything

69
00:02:39,830 --> 00:02:44,240
walk right in badge in sit down at the

70
00:02:42,590 --> 00:02:45,320
desk take my hat off and dial up and

71
00:02:44,240 --> 00:02:47,000
start talking to people all over the

72
00:02:45,320 --> 00:02:51,200
United States that hated their product

73
00:02:47,000 --> 00:02:52,640
as much as I did so I was grateful for

74
00:02:51,200 --> 00:02:53,958
that opportunity because it gave me an

75
00:02:52,640 --> 00:02:55,760
opportunity to make money and it also

76
00:02:53,959 --> 00:02:58,970
got me out of law enforcement which

77
00:02:55,760 --> 00:03:00,260
oddly enough my career choices down the

78
00:02:58,970 --> 00:03:02,870
down the road have put me right back

79
00:03:00,260 --> 00:03:04,489
into supporting law enforcement and

80
00:03:02,870 --> 00:03:05,720
training with law enforcement and all

81
00:03:04,489 --> 00:03:09,500
that so it's been kind of a really cool

82
00:03:05,720 --> 00:03:11,300
full circle thing but so got an IIT in

83
00:03:09,500 --> 00:03:13,040
1998 I've worked for

84
00:03:11,300 --> 00:03:15,500
gosh build-a-bear workshops whole

85
00:03:13,040 --> 00:03:17,299
corporate headquarters as IT guy network

86
00:03:15,500 --> 00:03:18,920
engineer that sort of stuff I cut my

87
00:03:17,300 --> 00:03:20,090
teeth and network from there I've worked

88
00:03:18,920 --> 00:03:22,609
for mastercards corporate headquarters

89
00:03:20,090 --> 00:03:25,459
that at the data center no felon on a

90
00:03:22,610 --> 00:03:28,640
central site engineering team I got into

91
00:03:25,459 --> 00:03:31,910
the dark side of IT I call it the Fira

92
00:03:28,640 --> 00:03:33,260
back in 2006 and work for a small

93
00:03:31,910 --> 00:03:35,989
company called the spiri and computer

94
00:03:33,260 --> 00:03:38,570
forensics out of Chesterfield the owner

95
00:03:35,989 --> 00:03:40,190
of that company really put a lot of

96
00:03:38,570 --> 00:03:42,859
effort and money into training me up to

97
00:03:40,190 --> 00:03:44,750
be a really good dfi our guy he

98
00:03:42,860 --> 00:03:46,430
ultimately retired and sold me that

99
00:03:44,750 --> 00:03:50,090
company which I owned until December of

100
00:03:46,430 --> 00:03:51,830
last year parameter acquired me and now

101
00:03:50,090 --> 00:03:54,200
I'm the director of DF IR for parameter

102
00:03:51,830 --> 00:03:55,940
so I've got a lot of experience in the

103
00:03:54,200 --> 00:03:58,329
digital forensics side and Incident

104
00:03:55,940 --> 00:04:03,650
Response side hardly any Red Team side

105
00:03:58,330 --> 00:04:05,720
but the focus that I've always excuse me

106
00:04:03,650 --> 00:04:07,340
that I've always had is on the blue team

107
00:04:05,720 --> 00:04:08,750
side and I really love it like the red

108
00:04:07,340 --> 00:04:12,320
team side stuff you guys think you're

109
00:04:08,750 --> 00:04:13,670
cool but you know after the fact trying

110
00:04:12,320 --> 00:04:16,969
to piece the puzzle pieces together

111
00:04:13,670 --> 00:04:18,500
is where my brain really kicks in so

112
00:04:16,970 --> 00:04:20,030
getting into this that's a little bit

113
00:04:18,500 --> 00:04:23,510
about me but getting into the whole

114
00:04:20,029 --> 00:04:24,799
point of this saying so 71% of companies

115
00:04:23,510 --> 00:04:26,810
have said they've been breached and this

116
00:04:24,800 --> 00:04:28,460
is probably a BS number because that's

117
00:04:26,810 --> 00:04:29,750
the 71 percent that decided they were

118
00:04:28,460 --> 00:04:31,700
going to actually admit they were

119
00:04:29,750 --> 00:04:33,080
reached right out of twelve hundred

120
00:04:31,700 --> 00:04:34,909
companies this is just from a survey

121
00:04:33,080 --> 00:04:38,750
that I pulled up to kind of get some

122
00:04:34,910 --> 00:04:40,550
perspective on how often companies do

123
00:04:38,750 --> 00:04:41,630
get breached it was so we know it's we

124
00:04:40,550 --> 00:04:42,050
know it's coming everybody knows it's

125
00:04:41,630 --> 00:04:43,969
coming

126
00:04:42,050 --> 00:04:47,510
if you're not preparing for that

127
00:04:43,970 --> 00:04:48,860
eventuality you're just already failing

128
00:04:47,510 --> 00:04:50,800
your instant response that's going to

129
00:04:48,860 --> 00:04:54,380
inevitably happen down the road

130
00:04:50,800 --> 00:04:55,940
typically 191 days is the average length

131
00:04:54,380 --> 00:04:58,520
of time before somebody realizes that

132
00:04:55,940 --> 00:05:00,200
they've been breached the problem with

133
00:04:58,520 --> 00:05:02,900
that is is that that's an average so

134
00:05:00,200 --> 00:05:07,340
there's plenty of cases where it's more

135
00:05:02,900 --> 00:05:09,789
than 191 days personally we've had cases

136
00:05:07,340 --> 00:05:13,130
where in fact I just had one recently

137
00:05:09,790 --> 00:05:15,919
where we discovered we finally figured

138
00:05:13,130 --> 00:05:18,130
out where patient zero was and we were

139
00:05:15,919 --> 00:05:20,659
able to pull from the master file tables

140
00:05:18,130 --> 00:05:24,890
malicious file entries dating back to

141
00:05:20,660 --> 00:05:28,400
years but they only realized they had a

142
00:05:24,890 --> 00:05:30,260
breach because that one was well far

143
00:05:28,400 --> 00:05:32,150
gone and the new ones started up and

144
00:05:30,260 --> 00:05:33,890
they happen to have some stuff in place

145
00:05:32,150 --> 00:05:36,650
to kind of give them a little bit of

146
00:05:33,890 --> 00:05:38,210
visibility on that and so anyway as I'm

147
00:05:36,650 --> 00:05:41,150
saying you know it can be here already

148
00:05:38,210 --> 00:05:44,810
and if you're not taking steps to

149
00:05:41,150 --> 00:05:47,539
prepare for it you're already losing 66

150
00:05:44,810 --> 00:05:49,310
days is the average for pulling out of a

151
00:05:47,540 --> 00:05:53,030
data breach and patching that out or

152
00:05:49,310 --> 00:05:57,110
mediating it that I've seen longer in

153
00:05:53,030 --> 00:05:58,640
our some of our cases we've seen some

154
00:05:57,110 --> 00:06:01,880
you know where it's a pretty easy fix

155
00:05:58,640 --> 00:06:03,560
and then the it's the organization's

156
00:06:01,880 --> 00:06:06,440
really small so it's easy to get them

157
00:06:03,560 --> 00:06:09,620
fixed up in 30 days but 66 days we've

158
00:06:06,440 --> 00:06:11,469
had them over 100 days before and the

159
00:06:09,620 --> 00:06:13,669
last boring stat slide that you'll see

160
00:06:11,470 --> 00:06:14,870
77 percent has three-quarters of all

161
00:06:13,669 --> 00:06:16,760
companies that are surveyed out of

162
00:06:14,870 --> 00:06:18,919
twenty hundred say they don't even have

163
00:06:16,760 --> 00:06:20,240
an incident response plan considering as

164
00:06:18,919 --> 00:06:23,390
fast plans can range from everything

165
00:06:20,240 --> 00:06:23,840
from something ad hoc where your plan is

166
00:06:23,390 --> 00:06:26,270
call

167
00:06:23,840 --> 00:06:28,659
your vendor like parameter and say hey

168
00:06:26,270 --> 00:06:31,280
we got a problem come in here and

169
00:06:28,660 --> 00:06:34,340
unscrew this situation for us all the

170
00:06:31,280 --> 00:06:35,809
way to a dedicated resource chart who's

171
00:06:34,340 --> 00:06:38,539
going to be notified all the way through

172
00:06:35,810 --> 00:06:40,100
to media and press depending on how

173
00:06:38,540 --> 00:06:43,010
large your organization is and what your

174
00:06:40,100 --> 00:06:44,780
reporting requirements are what I find

175
00:06:43,010 --> 00:06:48,500
interesting about this stat is that even

176
00:06:44,780 --> 00:06:50,119
the people that have the incident

177
00:06:48,500 --> 00:06:51,919
response plan they don't even use it

178
00:06:50,120 --> 00:06:53,540
dusted off when something happens we

179
00:06:51,919 --> 00:06:55,820
come across that quite a bit

180
00:06:53,540 --> 00:06:57,650
where well I had a company I'll tell you

181
00:06:55,820 --> 00:06:58,909
I'm not I'm not gonna name any companies

182
00:06:57,650 --> 00:07:02,150
in here because who knows who's in the

183
00:06:58,910 --> 00:07:05,630
room right but we had a company with a I

184
00:07:02,150 --> 00:07:07,520
our plan they got hit they dusted it off

185
00:07:05,630 --> 00:07:09,080
and the turnover rate at that company

186
00:07:07,520 --> 00:07:10,700
was so great over the last couple of

187
00:07:09,080 --> 00:07:12,859
years that nobody in the plant even work

188
00:07:10,700 --> 00:07:14,210
there anymore right and so they were

189
00:07:12,860 --> 00:07:22,550
scrambling to figure out who they need

190
00:07:14,210 --> 00:07:24,469
to do to notify so the bottom line is

191
00:07:22,550 --> 00:07:25,280
have a plan and it can be anything and

192
00:07:24,470 --> 00:07:26,960
I'm going to go through some things

193
00:07:25,280 --> 00:07:29,270
that'll kind of give you an idea of your

194
00:07:26,960 --> 00:07:31,549
small shop and medium shop some basic

195
00:07:29,270 --> 00:07:34,370
stuff that you can do that'll give us a

196
00:07:31,550 --> 00:07:36,410
fighting edge or anybody else you call

197
00:07:34,370 --> 00:07:39,380
for that matter if we show up on site

198
00:07:36,410 --> 00:07:41,660
and you can give us these five things we

199
00:07:39,380 --> 00:07:43,310
should be able to at least get an idea

200
00:07:41,660 --> 00:07:46,039
of what's going on and those five things

201
00:07:43,310 --> 00:07:48,200
are gonna require a couple of a couple

202
00:07:46,039 --> 00:07:49,550
of levels of effort from your company to

203
00:07:48,200 --> 00:07:52,219
be able to accomplish in there minimal

204
00:07:49,550 --> 00:07:53,990
but we'll get to that so the top ten

205
00:07:52,220 --> 00:07:55,910
mistakes or the top mistakes now this

206
00:07:53,990 --> 00:07:57,950
was called top 10 or 8 ways to screw up

207
00:07:55,910 --> 00:07:59,210
your IRA investigation I'm gonna throw

208
00:07:57,950 --> 00:08:02,210
five up there and talk a little bit

209
00:07:59,210 --> 00:08:04,789
about failure to have a solid ire plan

210
00:08:02,210 --> 00:08:07,130
we just talked about that any plan will

211
00:08:04,789 --> 00:08:08,900
work and I'm gonna give you kind of an

212
00:08:07,130 --> 00:08:11,479
ad-hoc alternative to look at and think

213
00:08:08,900 --> 00:08:14,390
about failure to know your environment

214
00:08:11,479 --> 00:08:19,010
so we've been involved in some incidents

215
00:08:14,390 --> 00:08:22,340
here recently even that when we go in

216
00:08:19,010 --> 00:08:24,500
we've got we're asking this the IT guys

217
00:08:22,340 --> 00:08:26,750
you know hey where's your logs do you

218
00:08:24,500 --> 00:08:28,669
have syslog e saying no centralized

219
00:08:26,750 --> 00:08:31,250
logging okay great pull all the logs

220
00:08:28,669 --> 00:08:33,919
from the from the domain controller or

221
00:08:31,250 --> 00:08:35,390
ad server whatever and we go in and look

222
00:08:33,919 --> 00:08:36,718
and it's like well they're not even

223
00:08:35,390 --> 00:08:38,429
login failed

224
00:08:36,719 --> 00:08:39,449
logon attempts you know they're not they

225
00:08:38,429 --> 00:08:40,620
haven't even taken the time to go

226
00:08:39,448 --> 00:08:42,508
through their environment say hey if we

227
00:08:40,620 --> 00:08:44,519
do get kicked in the ass this is the

228
00:08:42,509 --> 00:08:46,139
stuff we want to know and hey if we do

229
00:08:44,519 --> 00:08:47,730
let's go ahead and push that stuff off

230
00:08:46,139 --> 00:08:49,589
site so that the attacker doesn't just

231
00:08:47,730 --> 00:08:51,180
wipe the security logs when he gets in

232
00:08:49,589 --> 00:08:52,379
because we've seen that right everybody

233
00:08:51,180 --> 00:08:55,170
in here has probably seen something to

234
00:08:52,379 --> 00:08:58,709
that effect so failure to know your

235
00:08:55,170 --> 00:09:00,329
environment is key I'll give you a

236
00:08:58,709 --> 00:09:02,250
really good example of this it's

237
00:09:00,329 --> 00:09:05,040
something I worked on last year for six

238
00:09:02,250 --> 00:09:06,300
months and they'll come up again

239
00:09:05,040 --> 00:09:07,829
probably later in the slide but there's

240
00:09:06,300 --> 00:09:11,459
a very large healthcare company in the

241
00:09:07,829 --> 00:09:14,430
United States that has a kick-ass I our

242
00:09:11,459 --> 00:09:15,388
staff and team right they have all the

243
00:09:14,430 --> 00:09:16,529
money in the world to spend on

244
00:09:15,389 --> 00:09:18,779
everything and I mean they have

245
00:09:16,529 --> 00:09:21,540
dedicated people that do nothing but

246
00:09:18,779 --> 00:09:23,069
revise this ir plan every quarter make

247
00:09:21,540 --> 00:09:25,319
sure it's up to date every time somebody

248
00:09:23,069 --> 00:09:29,128
leaves the organization they're on top

249
00:09:25,319 --> 00:09:30,839
of it they had an event or a breach if

250
00:09:29,129 --> 00:09:33,569
you will it was a crypto ransomware it

251
00:09:30,839 --> 00:09:37,160
gotten into one of their vendor managed

252
00:09:33,569 --> 00:09:39,509
what they would call a peripheral device

253
00:09:37,160 --> 00:09:40,740
so imagine in hospitals all over the

254
00:09:39,509 --> 00:09:42,569
United States their entire IT

255
00:09:40,740 --> 00:09:47,459
infrastructure these guys manage that

256
00:09:42,569 --> 00:09:49,920
hands down like like NFL sports team

257
00:09:47,459 --> 00:09:53,489
nothing no stone unturned the problem is

258
00:09:49,920 --> 00:09:57,599
is they have over like 140,000 devices

259
00:09:53,490 --> 00:10:00,420
like pill counters kidney machines you

260
00:09:57,600 --> 00:10:02,309
know kidney blood pumps take something

261
00:10:00,420 --> 00:10:05,550
it could be a surgical robot it could be

262
00:10:02,309 --> 00:10:08,430
the item that in the room if you code

263
00:10:05,550 --> 00:10:10,319
sends the alert to the desk of the

264
00:10:08,430 --> 00:10:13,019
nurses to have them run down the hall

265
00:10:10,319 --> 00:10:16,079
and revive you that stuff was not in

266
00:10:13,019 --> 00:10:18,779
their IT universe their plan did not

267
00:10:16,079 --> 00:10:21,809
cover that so they basically had a third

268
00:10:18,779 --> 00:10:25,160
party device get compromised well while

269
00:10:21,809 --> 00:10:27,449
they had visibility of these devices

270
00:10:25,160 --> 00:10:30,569
logically they didn't know what they

271
00:10:27,449 --> 00:10:32,939
were so crypto ransomware gets in and

272
00:10:30,569 --> 00:10:35,729
encrypts this box is running a version

273
00:10:32,939 --> 00:10:36,389
of Windows and they're like well that's

274
00:10:35,730 --> 00:10:38,939
bad

275
00:10:36,389 --> 00:10:41,879
we need to act within 14 minutes that

276
00:10:38,939 --> 00:10:46,019
had gone to 30 different 31 different

277
00:10:41,879 --> 00:10:47,220
devices somebody in that ir staff the

278
00:10:46,019 --> 00:10:49,589
gentleman I'd know him personally

279
00:10:47,220 --> 00:10:52,240
actually

280
00:10:49,589 --> 00:10:55,569
had to make a decision to start blocking

281
00:10:52,240 --> 00:10:57,730
ports without knowing if that device was

282
00:10:55,569 --> 00:11:00,040
critical for patient care or if it was

283
00:10:57,730 --> 00:11:02,470
gonna kill somebody or if it was going

284
00:11:00,040 --> 00:11:04,509
to just be a pill counter right so he

285
00:11:02,470 --> 00:11:07,060
made the decision and killed all 31

286
00:11:04,509 --> 00:11:11,519
patients I'm kidding no see he killed

287
00:11:07,060 --> 00:11:14,589
off 31 they killed off 31 devices one

288
00:11:11,519 --> 00:11:15,750
effected patient care in a non-critical

289
00:11:14,589 --> 00:11:17,889
manner

290
00:11:15,750 --> 00:11:19,329
wasn't putting anybody at risk but it

291
00:11:17,889 --> 00:11:21,490
was the biggest wake-up call that

292
00:11:19,329 --> 00:11:22,959
organizations ever faced so they

293
00:11:21,490 --> 00:11:26,319
immediately put five million dollars

294
00:11:22,959 --> 00:11:28,680
aside in four years to identify all this

295
00:11:26,319 --> 00:11:30,579
stuff create a framework to be able to

296
00:11:28,680 --> 00:11:32,229
implement new devices into the

297
00:11:30,579 --> 00:11:34,508
environment and you got six thousand

298
00:11:32,230 --> 00:11:36,519
vendors selling medical equipment to you

299
00:11:34,509 --> 00:11:38,470
and the vendors don't typically put any

300
00:11:36,519 --> 00:11:40,540
security controls in place it's a

301
00:11:38,470 --> 00:11:45,569
daunting task but first what we did for

302
00:11:40,540 --> 00:11:48,310
six months was identify the level of of

303
00:11:45,569 --> 00:11:51,310
patient care that the device required or

304
00:11:48,310 --> 00:11:53,378
provided and it kind of ranked that out

305
00:11:51,310 --> 00:11:54,790
to determine an SLA of hey can we pull

306
00:11:53,379 --> 00:11:56,589
the plug on this kind of thing right now

307
00:11:54,790 --> 00:11:57,939
if something comes up or do we have to

308
00:11:56,589 --> 00:12:01,029
give it 24 hours and make sure somebody

309
00:11:57,939 --> 00:12:02,769
gets plugged into another machine so

310
00:12:01,029 --> 00:12:03,879
this heart keeps pumping so that's a

311
00:12:02,769 --> 00:12:06,550
good example of knowing your environment

312
00:12:03,879 --> 00:12:08,920
right another minor example for

313
00:12:06,550 --> 00:12:11,170
mid-sized companies would be make sure

314
00:12:08,920 --> 00:12:13,959
your backups are running you know we

315
00:12:11,170 --> 00:12:15,339
come in and on a crypto mining or a

316
00:12:13,959 --> 00:12:16,809
crypto ransomware case where they're

317
00:12:15,339 --> 00:12:18,459
like man we need all our stuff back well

318
00:12:16,809 --> 00:12:19,870
yeah let's go to your backups

319
00:12:18,459 --> 00:12:20,888
nobody's even check to see if these

320
00:12:19,870 --> 00:12:23,319
things are running for the last six

321
00:12:20,889 --> 00:12:25,540
months and they're not stuff like that

322
00:12:23,319 --> 00:12:29,170
logging same thing go in try to find

323
00:12:25,540 --> 00:12:31,449
some logs they're not there another

324
00:12:29,170 --> 00:12:33,040
mistake is that corporations and midsize

325
00:12:31,449 --> 00:12:35,439
companies tend to take an IT centric

326
00:12:33,040 --> 00:12:37,329
approach to malicious activity if they

327
00:12:35,439 --> 00:12:38,889
identify a computer or host or any kind

328
00:12:37,329 --> 00:12:39,819
of system for that matter that appears

329
00:12:38,889 --> 00:12:41,920
to be compromised

330
00:12:39,819 --> 00:12:43,930
it's a knee-jerk reaction of the IT

331
00:12:41,920 --> 00:12:46,899
staff that's typically in charge of that

332
00:12:43,930 --> 00:12:49,420
stuff to run malwarebytes on it clean it

333
00:12:46,899 --> 00:12:51,790
up if that doesn't work wipe it reimage

334
00:12:49,420 --> 00:12:54,878
it whatever they get the production

335
00:12:51,790 --> 00:12:57,250
environment fixed they take care of the

336
00:12:54,879 --> 00:12:59,259
fear part of that but then two three

337
00:12:57,250 --> 00:13:00,090
days later somebody's calling us going

338
00:12:59,259 --> 00:13:01,710
hey man we were here

339
00:13:00,090 --> 00:13:04,200
we realize now looking at some things

340
00:13:01,710 --> 00:13:06,720
that this is a bigger deal it's on 47

341
00:13:04,200 --> 00:13:09,060
computers worth in the what's on these

342
00:13:06,720 --> 00:13:10,410
computers it's very sensitive

343
00:13:09,060 --> 00:13:12,750
we need you to come in and do a full

344
00:13:10,410 --> 00:13:14,610
review well you guys have already wiped

345
00:13:12,750 --> 00:13:15,810
all the data that we're gonna need well

346
00:13:14,610 --> 00:13:17,400
we can get some logs out of malware

347
00:13:15,810 --> 00:13:18,599
bytes or kind of put some things

348
00:13:17,400 --> 00:13:20,790
together but we're not going to be able

349
00:13:18,600 --> 00:13:23,520
to hash it sandbox it tell you exactly

350
00:13:20,790 --> 00:13:24,719
what flavor it is and who did it and all

351
00:13:23,520 --> 00:13:26,280
that stuff you because you don't have

352
00:13:24,720 --> 00:13:27,240
any logs you're not gonna we're not

353
00:13:26,280 --> 00:13:29,550
going to be able to see ingress/egress

354
00:13:27,240 --> 00:13:31,470
self your peripherals but I'm sorry off

355
00:13:29,550 --> 00:13:33,240
your firewalls and your perimeter

356
00:13:31,470 --> 00:13:34,800
devices things like that so there's a

357
00:13:33,240 --> 00:13:37,620
few things that again we'll get to that

358
00:13:34,800 --> 00:13:39,510
will help out this is a big one that

359
00:13:37,620 --> 00:13:40,860
leads to the last one coming up is a

360
00:13:39,510 --> 00:13:42,840
failure to designate and string first

361
00:13:40,860 --> 00:13:44,190
responders and the primary focus of this

362
00:13:42,840 --> 00:13:46,800
and the thing I'm trying to pound into

363
00:13:44,190 --> 00:13:49,740
people's heads clients of ours I talked

364
00:13:46,800 --> 00:13:51,810
to them about this all the time and we

365
00:13:49,740 --> 00:13:54,570
help them for free to understand what

366
00:13:51,810 --> 00:13:57,089
they need to get in place but basically

367
00:13:54,570 --> 00:13:59,760
somebody that understands hey if the

368
00:13:57,090 --> 00:14:01,950
whatever criteria is determined or is

369
00:13:59,760 --> 00:14:05,280
set up to determine if something is is

370
00:14:01,950 --> 00:14:07,590
compromised whether it's a virus crypto

371
00:14:05,280 --> 00:14:10,410
ransomware crypto mining ransom or

372
00:14:07,590 --> 00:14:13,410
crypto mining mutt malware that's using

373
00:14:10,410 --> 00:14:15,870
up cycles on a server or whatever there

374
00:14:13,410 --> 00:14:18,120
is a way to approach that without

375
00:14:15,870 --> 00:14:20,970
hurting the production environment at

376
00:14:18,120 --> 00:14:23,610
that time and also capturing the five

377
00:14:20,970 --> 00:14:26,430
things we need to be able to go in and

378
00:14:23,610 --> 00:14:29,310
try to to accomplish a very successful

379
00:14:26,430 --> 00:14:30,900
incident response investigation that

380
00:14:29,310 --> 00:14:33,750
starts with failure to preserve evidence

381
00:14:30,900 --> 00:14:34,920
right that's there's a failure to

382
00:14:33,750 --> 00:14:36,480
preserve evidence because there's a

383
00:14:34,920 --> 00:14:39,569
failure to designate anybody even those

384
00:14:36,480 --> 00:14:41,610
how what to treat as evidence or how to

385
00:14:39,570 --> 00:14:45,090
treat the the host PC that they find

386
00:14:41,610 --> 00:14:47,340
compromised as evidence in a way that a

387
00:14:45,090 --> 00:14:49,470
may even need to be used in court down

388
00:14:47,340 --> 00:14:51,690
the road the Secret Service routinely

389
00:14:49,470 --> 00:14:53,970
comes to us on our financial side

390
00:14:51,690 --> 00:14:56,670
clients when we do an instant response

391
00:14:53,970 --> 00:14:58,230
if they're required to report and we're

392
00:14:56,670 --> 00:14:59,849
sitting there with two or three items of

393
00:14:58,230 --> 00:15:01,710
evidence on a major breach I got one

394
00:14:59,850 --> 00:15:04,910
right now three hundred ninety million

395
00:15:01,710 --> 00:15:08,970
dollars dollars I think Tabac $390,000

396
00:15:04,910 --> 00:15:11,490
fraudulent ACH transfers the bank was a

397
00:15:08,970 --> 00:15:12,870
very ill-prepared for

398
00:15:11,490 --> 00:15:15,300
any kind of investigation that would

399
00:15:12,870 --> 00:15:17,550
happen afterwards they don't know where

400
00:15:15,300 --> 00:15:20,640
the the people that called the social

401
00:15:17,550 --> 00:15:23,760
engineer the the bank did not know they

402
00:15:20,640 --> 00:15:26,459
do not know at all where these people

403
00:15:23,760 --> 00:15:28,380
would have gotten the five criteria of

404
00:15:26,459 --> 00:15:30,989
knowledge that a client would have to

405
00:15:28,380 --> 00:15:34,830
know to authorize over the phone

406
00:15:30,990 --> 00:15:37,890
a $390,000 ACH transfer on a home equity

407
00:15:34,830 --> 00:15:40,950
loan but they did so they're like well

408
00:15:37,890 --> 00:15:42,630
it resides here so it has to be on this

409
00:15:40,950 --> 00:15:45,839
and we need you to look at this and see

410
00:15:42,630 --> 00:15:48,660
if we're breached well you look at that

411
00:15:45,839 --> 00:15:52,380
system no logging it's hosting a third

412
00:15:48,660 --> 00:15:55,649
party web facing mortgage application

413
00:15:52,380 --> 00:15:57,420
tool and all their PII is stored on that

414
00:15:55,649 --> 00:16:00,709
damn thing and there's no way to tell

415
00:15:57,420 --> 00:16:03,360
and so talking with the board who's not

416
00:16:00,709 --> 00:16:04,979
technologically centric trying to

417
00:16:03,360 --> 00:16:06,180
explain to them that we're not able to

418
00:16:04,980 --> 00:16:07,320
tell you one way or the other that

419
00:16:06,180 --> 00:16:08,969
you're breached or not because you're

420
00:16:07,320 --> 00:16:11,760
just so porous let's just assume you

421
00:16:08,970 --> 00:16:12,990
work well their hair catches on fire and

422
00:16:11,760 --> 00:16:15,319
they yell at you and say that's not good

423
00:16:12,990 --> 00:16:17,459
enough you know we need we need answers

424
00:16:15,320 --> 00:16:20,490
so anyway longer sort of it these are

425
00:16:17,459 --> 00:16:23,790
the five things we want all five of

426
00:16:20,490 --> 00:16:27,149
these things although very valuable only

427
00:16:23,790 --> 00:16:29,370
a couple of them require people to do

428
00:16:27,149 --> 00:16:33,240
any kind of advanced auditing or just

429
00:16:29,370 --> 00:16:35,760
verifying their condition in your

430
00:16:33,240 --> 00:16:37,980
network so we'll start with RAM and

431
00:16:35,760 --> 00:16:39,630
we'll go all the way to logs ram

432
00:16:37,980 --> 00:16:40,820
volatile data and files and hard drives

433
00:16:39,630 --> 00:16:42,689
that's all gonna be on the host system

434
00:16:40,820 --> 00:16:44,130
there are things that the first

435
00:16:42,690 --> 00:16:45,270
responders need to know to be able to

436
00:16:44,130 --> 00:16:47,250
preserve those things when they're

437
00:16:45,270 --> 00:16:49,949
dealing with what they believe to be a

438
00:16:47,250 --> 00:16:53,459
compromised system the peak apps and

439
00:16:49,950 --> 00:16:55,529
logs that stuff that prior to any first

440
00:16:53,459 --> 00:16:57,779
responder activity prior to any breach

441
00:16:55,529 --> 00:16:59,430
those two things if I could get every

442
00:16:57,779 --> 00:17:00,839
client of mine to go in and make sure

443
00:16:59,430 --> 00:17:03,359
they have the ability to pull peak apps

444
00:17:00,839 --> 00:17:04,800
and centralize their logging and lock

445
00:17:03,360 --> 00:17:06,360
that down so they can't be wife to make

446
00:17:04,800 --> 00:17:09,359
sure that they are auditing what's being

447
00:17:06,359 --> 00:17:11,178
logged so that we have the best type of

448
00:17:09,359 --> 00:17:13,800
logging available for our investigation

449
00:17:11,179 --> 00:17:15,329
even if we even if they didn't know how

450
00:17:13,800 --> 00:17:18,270
anything happened or if we've had a hard

451
00:17:15,329 --> 00:17:19,530
time look you know capturing firewall

452
00:17:18,270 --> 00:17:20,609
logs that's where stuff or whatever if

453
00:17:19,530 --> 00:17:22,199
there are any difficulties if we get

454
00:17:20,609 --> 00:17:24,809
these five things we have a

455
00:17:22,199 --> 00:17:28,230
chants so just a couple of free tools

456
00:17:24,809 --> 00:17:30,629
for the RAM Mandy in redline and dunk a

457
00:17:28,230 --> 00:17:33,090
soft Ram captured imagine taking just a

458
00:17:30,630 --> 00:17:35,190
hard drive or a thumb drive throwing a

459
00:17:33,090 --> 00:17:37,590
couple free tools on it training a guy

460
00:17:35,190 --> 00:17:38,940
how to use those tools so that once he

461
00:17:37,590 --> 00:17:41,158
sees something malicious in his

462
00:17:38,940 --> 00:17:43,019
environment he treats that computer or

463
00:17:41,159 --> 00:17:46,019
that host as evidence and he runs one of

464
00:17:43,019 --> 00:17:48,269
these grabs the RAM runs this vault a

465
00:17:46,019 --> 00:17:50,130
data script that either you can find

466
00:17:48,269 --> 00:17:53,850
online you can get WMI scripts

467
00:17:50,130 --> 00:17:56,250
PowerShell scripts I'm lazy and I don't

468
00:17:53,850 --> 00:17:59,189
want to guess - first of all I don't

469
00:17:56,250 --> 00:18:01,139
like I don't like running host level

470
00:17:59,190 --> 00:18:03,570
stuff right I like everything to be

471
00:18:01,139 --> 00:18:04,678
running off a thumb drive in RAM I don't

472
00:18:03,570 --> 00:18:07,559
want to start a powershell on the

473
00:18:04,679 --> 00:18:09,179
computer so i use this with this what

474
00:18:07,559 --> 00:18:15,149
looks to be very simple and it's very

475
00:18:09,179 --> 00:18:18,419
awesome it's called a win on it p PG PG

476
00:18:15,149 --> 00:18:19,739
e or peat I'll find it for its param X

477
00:18:18,419 --> 00:18:22,019
or something is the name of the company

478
00:18:19,740 --> 00:18:23,429
this is free this thing interrogate it's

479
00:18:22,019 --> 00:18:26,159
everything on your computer in about two

480
00:18:23,429 --> 00:18:28,500
minutes it creates a PDF or HTML report

481
00:18:26,159 --> 00:18:30,149
it's easier for me to actually dig

482
00:18:28,500 --> 00:18:32,220
through this on site really quickly then

483
00:18:30,149 --> 00:18:33,209
it then even load the RAM image into

484
00:18:32,220 --> 00:18:36,750
volatility and get the same information

485
00:18:33,210 --> 00:18:39,059
I get both in RAM first because this

486
00:18:36,750 --> 00:18:43,320
will show up in RAM it after you run it

487
00:18:39,059 --> 00:18:45,029
and so I used both because I will use

488
00:18:43,320 --> 00:18:46,559
volatility and subscripts that I have

489
00:18:45,029 --> 00:18:48,240
when I get back to lab but on side I can

490
00:18:46,559 --> 00:18:49,889
whip this out start digging to see what

491
00:18:48,240 --> 00:18:52,649
ports are open what services are talking

492
00:18:49,889 --> 00:18:54,090
to whatever what processes are running

493
00:18:52,649 --> 00:18:56,039
and if there's any outbound connections

494
00:18:54,090 --> 00:18:59,699
to IPS I can pull those out in geolocate

495
00:18:56,039 --> 00:19:02,610
and real quick on-site files and hard

496
00:18:59,700 --> 00:19:04,220
drives typically we try not to image the

497
00:19:02,610 --> 00:19:07,740
entire hard drive if we're triage in a

498
00:19:04,220 --> 00:19:09,750
couple of compromised systems we may

499
00:19:07,740 --> 00:19:11,970
just want the journal record the master

500
00:19:09,750 --> 00:19:13,889
file table and a couple other things in

501
00:19:11,970 --> 00:19:16,320
the logs and I can basically load from

502
00:19:13,889 --> 00:19:20,250
that thumb drive one of these two tools

503
00:19:16,320 --> 00:19:22,799
ftk imager or ex ways imager and target

504
00:19:20,250 --> 00:19:24,750
the things that I want and get those in

505
00:19:22,799 --> 00:19:27,360
10 minutes versus a 4-hour image of a

506
00:19:24,750 --> 00:19:29,070
one terabyte hard drive and I don't have

507
00:19:27,360 --> 00:19:31,260
to take the system down it's still

508
00:19:29,070 --> 00:19:33,510
running I can do this live everything

509
00:19:31,260 --> 00:19:35,700
I've shown you so far I can do live so

510
00:19:33,510 --> 00:19:36,640
the system's still in production if we

511
00:19:35,700 --> 00:19:38,200
know it's

512
00:19:36,640 --> 00:19:39,780
system it's completely compromised will

513
00:19:38,200 --> 00:19:42,550
obviously unplug it from the network

514
00:19:39,780 --> 00:19:46,540
after we run all the stuff that least to

515
00:19:42,550 --> 00:19:50,409
the at least the RAM and the bottle data

516
00:19:46,540 --> 00:19:51,820
stuff but that's it so your guy that is

517
00:19:50,410 --> 00:19:54,100
gonna be your first responder those are

518
00:19:51,820 --> 00:19:57,550
the three sets of tools he has on his

519
00:19:54,100 --> 00:20:00,730
thumb drive you can get a 75 or what is

520
00:19:57,550 --> 00:20:01,690
that two three four three-fifths of what

521
00:20:00,730 --> 00:20:03,850
we need to get started

522
00:20:01,690 --> 00:20:05,740
pcaps a lot of organizations would come

523
00:20:03,850 --> 00:20:07,240
into they don't have the ability to span

524
00:20:05,740 --> 00:20:09,460
a port they're using consumer levels

525
00:20:07,240 --> 00:20:11,230
switches they don't even understand what

526
00:20:09,460 --> 00:20:14,290
that is we have some devices we can just

527
00:20:11,230 --> 00:20:16,740
unplug them and go in line and dump

528
00:20:14,290 --> 00:20:19,600
these things to a external hard drive

529
00:20:16,740 --> 00:20:21,610
those are very easy to make or cheap or

530
00:20:19,600 --> 00:20:23,740
like you show you how to make them but

531
00:20:21,610 --> 00:20:25,540
that way you have that capability but

532
00:20:23,740 --> 00:20:27,400
you got to have it first right before

533
00:20:25,540 --> 00:20:29,530
the incident happens so that you can

534
00:20:27,400 --> 00:20:31,780
start grabbing stuff it's a lot easier

535
00:20:29,530 --> 00:20:33,790
if I can call them say hey requisition

536
00:20:31,780 --> 00:20:37,930
this pamphlet for me throw Wireshark on

537
00:20:33,790 --> 00:20:40,570
it give me ten gigs of pcaps but if they

538
00:20:37,930 --> 00:20:43,240
can't like a retail location a store a

539
00:20:40,570 --> 00:20:44,399
gas station or something we used to use

540
00:20:43,240 --> 00:20:46,120
a little inline box

541
00:20:44,400 --> 00:20:48,550
NetFlow data if you're a big

542
00:20:46,120 --> 00:20:50,320
organization and you have like net amp

543
00:20:48,550 --> 00:20:53,200
from Cisco or you got any other kind of

544
00:20:50,320 --> 00:20:55,240
net flow solution mounted in your rack

545
00:20:53,200 --> 00:20:57,310
in the back that's awesome but if you if

546
00:20:55,240 --> 00:20:59,350
you don't have it very it we got it and

547
00:20:57,310 --> 00:21:03,750
we gotta get down and dirty we at least

548
00:20:59,350 --> 00:21:07,959
try to span a port or drop that in line

549
00:21:03,750 --> 00:21:10,690
that's just Wireshark free tool also so

550
00:21:07,960 --> 00:21:12,760
you can have peak apps and logs we

551
00:21:10,690 --> 00:21:14,560
prefer these companies have centralized

552
00:21:12,760 --> 00:21:16,450
logging if they don't we get what we can

553
00:21:14,560 --> 00:21:19,000
but if I can get everybody on the same

554
00:21:16,450 --> 00:21:20,380
page going forward at least when I when

555
00:21:19,000 --> 00:21:22,840
clients call me and they have one

556
00:21:20,380 --> 00:21:24,640
incident after that's over with this is

557
00:21:22,840 --> 00:21:26,500
the stuff they're doing to prepare for

558
00:21:24,640 --> 00:21:28,170
the next one especially when we can't

559
00:21:26,500 --> 00:21:30,760
answer their questions we say here's why

560
00:21:28,170 --> 00:21:32,770
but you know even something as simple as

561
00:21:30,760 --> 00:21:37,180
event log viewer or I'm sorry this is a

562
00:21:32,770 --> 00:21:40,889
event log Explorer also free and you can

563
00:21:37,180 --> 00:21:44,680
query on any kind of term in there so if

564
00:21:40,890 --> 00:21:46,150
somebody brute forces RDP and it's

565
00:21:44,680 --> 00:21:47,890
coming from a certain IP address and

566
00:21:46,150 --> 00:21:49,419
you're you find one you just query the

567
00:21:47,890 --> 00:21:52,749
one IP address you get all

568
00:21:49,419 --> 00:21:53,829
failed RDP brute-force attempts you know

569
00:21:52,749 --> 00:21:55,329
and that helps try to answer the

570
00:21:53,829 --> 00:21:56,499
question of how this is going on then we

571
00:21:55,329 --> 00:21:59,229
had we've had it quite a few of those

572
00:21:56,499 --> 00:22:00,940
come across our desks so a very short

573
00:21:59,229 --> 00:22:02,469
presentation because I'll take questions

574
00:22:00,940 --> 00:22:05,049
obviously and I can sit and talk to you

575
00:22:02,469 --> 00:22:06,969
guys afterwards and plus it's 4:30 and

576
00:22:05,049 --> 00:22:08,649
it's been a long day so if you want to

577
00:22:06,969 --> 00:22:13,089
go and we can but the idea behind this

578
00:22:08,649 --> 00:22:15,728
is is prepare ahead of time with some

579
00:22:13,089 --> 00:22:16,989
very simple things you can always talk

580
00:22:15,729 --> 00:22:18,190
to me I'll be out by the booth after

581
00:22:16,989 --> 00:22:21,039
this to you by the way if nobody wants

582
00:22:18,190 --> 00:22:22,989
to talk up here but you know we don't

583
00:22:21,039 --> 00:22:24,700
offer this as like formal training I'm

584
00:22:22,989 --> 00:22:26,709
not trying to sell you anything but I'll

585
00:22:24,700 --> 00:22:29,440
give you this slide deck and you can

586
00:22:26,709 --> 00:22:31,179
just take it back and run with it I mean

587
00:22:29,440 --> 00:22:32,559
if it will help but if you have

588
00:22:31,179 --> 00:22:33,909
questions you want to talk about it if

589
00:22:32,559 --> 00:22:36,190
you're out in the field or you're back

590
00:22:33,909 --> 00:22:38,139
at your organization and a couple weeks

591
00:22:36,190 --> 00:22:39,159
and you decide you want to start looking

592
00:22:38,139 --> 00:22:40,779
at some of this stuff you can always

593
00:22:39,159 --> 00:22:42,940
call me email me and I'll be happy to

594
00:22:40,779 --> 00:22:45,159
help at the end of the day it's all for

595
00:22:42,940 --> 00:22:46,359
the greater good not to like I said not

596
00:22:45,159 --> 00:22:48,909
trying to sell anybody anything but

597
00:22:46,359 --> 00:22:51,820
trying to make my life easier and get

598
00:22:48,909 --> 00:23:06,809
some more questions for the clients does

599
00:22:51,820 --> 00:23:06,809
anybody have any questions yeah yeah

600
00:23:08,579 --> 00:23:14,739
well I'll give you the site for that

601
00:23:12,039 --> 00:23:16,719
I've tested it I've loaded it on a on a

602
00:23:14,739 --> 00:23:17,919
system and sandboxed it and I do that

603
00:23:16,719 --> 00:23:20,200
with all the stuff that I get for free

604
00:23:17,919 --> 00:23:21,909
make sure it's not opening backdoors for

605
00:23:20,200 --> 00:23:25,209
me or doing anything crazy but that

606
00:23:21,909 --> 00:23:27,879
one's trustworthy they don't offer a md5

607
00:23:25,209 --> 00:23:30,429
hash on that site though but you can if

608
00:23:27,879 --> 00:23:31,869
you makes you feel better you know fire

609
00:23:30,429 --> 00:23:33,759
up a virtual machine throw it on there

610
00:23:31,869 --> 00:23:36,939
and see what process has changed before

611
00:23:33,759 --> 00:23:38,769
and after diff on the registry that kind

612
00:23:36,940 --> 00:23:40,119
of stuff with red shot and just you'll

613
00:23:38,769 --> 00:23:47,849
see there it doesn't change anything

614
00:23:40,119 --> 00:23:47,849
maliciously yep anybody else yep

615
00:23:51,539 --> 00:23:57,700
man go out that hallway there's about

616
00:23:56,289 --> 00:24:00,400
five sloughs no I'm just kidding I mean

617
00:23:57,700 --> 00:24:02,500
you know there's all kinds of products

618
00:24:00,400 --> 00:24:03,820
that you can even use spunk there are

619
00:24:02,500 --> 00:24:06,190
people that organizations we've gone

620
00:24:03,820 --> 00:24:08,168
into the apps punk deployed and they all

621
00:24:06,190 --> 00:24:11,470
float all that to a spunk server that's

622
00:24:08,169 --> 00:24:13,480
awesome most companies don't do that I

623
00:24:11,470 --> 00:24:15,280
mean it there's a thousand solutions out

624
00:24:13,480 --> 00:24:18,070
there I don't try to I try to stay

625
00:24:15,280 --> 00:24:19,690
vendor agnostic but from if I were

626
00:24:18,070 --> 00:24:21,668
consulting with a client after an

627
00:24:19,690 --> 00:24:23,289
incident and they wanted a gap analysis

628
00:24:21,669 --> 00:24:25,510
and they want and usually in my reports

629
00:24:23,289 --> 00:24:28,510
I put recommendations that we've learned

630
00:24:25,510 --> 00:24:29,860
from this incident how to shore up for

631
00:24:28,510 --> 00:24:32,350
the next one or how to shore up your

632
00:24:29,860 --> 00:24:34,330
response times and just do people make

633
00:24:32,350 --> 00:24:37,449
those best practices I just point out

634
00:24:34,330 --> 00:24:38,980
you need this logging solution you don't

635
00:24:37,450 --> 00:24:42,159
need order this type of logging solution

636
00:24:38,980 --> 00:24:45,400
I try to stay vendor agnostic but but

637
00:24:42,159 --> 00:24:47,230
it's definitely it's all I'd say it's in

638
00:24:45,400 --> 00:24:49,179
almost 99% of my reports because

639
00:24:47,230 --> 00:25:02,470
typically they do their host based logs

640
00:24:49,179 --> 00:25:03,669
oh in turn a tional II so chain of

641
00:25:02,470 --> 00:25:05,200
custody for instance and that's actually

642
00:25:03,669 --> 00:25:06,250
a good point like so even your first

643
00:25:05,200 --> 00:25:08,049
responders one of the things I'll be

644
00:25:06,250 --> 00:25:09,400
trained up on his property into custody

645
00:25:08,049 --> 00:25:11,379
improper documentation of what they've

646
00:25:09,400 --> 00:25:12,940
done so if they go in and they tell you

647
00:25:11,380 --> 00:25:14,440
and they run those tools and they get

648
00:25:12,940 --> 00:25:16,539
all those images they should have a

649
00:25:14,440 --> 00:25:18,039
notepad somewhere even even a digital

650
00:25:16,539 --> 00:25:19,750
one there's just some note just notepad

651
00:25:18,039 --> 00:25:20,908
up even they just type in at this time I

652
00:25:19,750 --> 00:25:22,960
did this is tell me did that

653
00:25:20,909 --> 00:25:24,520
internationally if you're collecting

654
00:25:22,960 --> 00:25:29,470
evidence remotely you mean or do you

655
00:25:24,520 --> 00:25:33,158
going over yep so if you're shipping

656
00:25:29,470 --> 00:25:36,970
something FedEx and UPS are approved

657
00:25:33,159 --> 00:25:38,679
links in chain of custody so as long as

658
00:25:36,970 --> 00:25:40,900
somebody fills out the FedEx tracking

659
00:25:38,679 --> 00:25:43,360
number on that side and when you get it

660
00:25:40,900 --> 00:25:45,640
I take a picture of it and then that

661
00:25:43,360 --> 00:25:47,439
goes in my file and then the tracking

662
00:25:45,640 --> 00:25:49,750
number I verify that and then I sign off

663
00:25:47,440 --> 00:25:51,400
that I received that because there is a

664
00:25:49,750 --> 00:25:54,130
record between that person that shipped

665
00:25:51,400 --> 00:25:57,340
it to you and you held by FedEx that can

666
00:25:54,130 --> 00:25:58,630
be subpoenaed so they never do if it's

667
00:25:57,340 --> 00:25:59,360
you got a picture of it they're like

668
00:25:58,630 --> 00:26:04,900
yeah

669
00:25:59,360 --> 00:26:04,899
it's good but anymore

670
00:26:06,430 --> 00:26:12,650
you guys are exciting now I told you it

671
00:26:10,670 --> 00:26:19,070
was gonna be a simple one but I'm gonna

672
00:26:12,650 --> 00:26:21,590
go back here first yep they're a whole

673
00:26:19,070 --> 00:26:23,570
different animal yeah yeah they're so

674
00:26:21,590 --> 00:26:27,470
you typically need your own AWS instance

675
00:26:23,570 --> 00:26:28,850
and we this is something that would have

676
00:26:27,470 --> 00:26:31,180
been a better talk than this probably

677
00:26:28,850 --> 00:26:34,129
but but yeah we can talk about it

678
00:26:31,180 --> 00:26:37,100
offline if you want to it's yeah we do

679
00:26:34,130 --> 00:26:39,050
it from Amazon to other Amazon instances

680
00:26:37,100 --> 00:26:41,780
it's faster that way we just pay for the

681
00:26:39,050 --> 00:26:44,000
cycles we host our own environment there

682
00:26:41,780 --> 00:26:52,100
that doesn't that we use for doing that

683
00:26:44,000 --> 00:26:57,020
would you sir like incident like

684
00:26:52,100 --> 00:26:58,879
indicators are compromised well clients

685
00:26:57,020 --> 00:27:00,440
typically come to us with a number of

686
00:26:58,880 --> 00:27:03,710
things right now the new hotness seems

687
00:27:00,440 --> 00:27:04,880
to be o365 breaches you're using

688
00:27:03,710 --> 00:27:07,670
federated credentials in your

689
00:27:04,880 --> 00:27:09,950
environment spear phishing attack or a

690
00:27:07,670 --> 00:27:11,720
phishing attack somebody inevitably and

691
00:27:09,950 --> 00:27:13,940
I got two right now in my office that

692
00:27:11,720 --> 00:27:18,650
there were both attacked the exact same

693
00:27:13,940 --> 00:27:20,540
way and the the common human denominator

694
00:27:18,650 --> 00:27:23,060
was while they were implementing to

695
00:27:20,540 --> 00:27:24,590
factor the last person that demanded to

696
00:27:23,060 --> 00:27:26,750
be last to do it because he didn't want

697
00:27:24,590 --> 00:27:28,850
to be bothered by it as a CEO and both

698
00:27:26,750 --> 00:27:30,910
of these company CEOs both clicked on

699
00:27:28,850 --> 00:27:34,939
the bad link gave up their credentials

700
00:27:30,910 --> 00:27:37,370
one of which a third company we had last

701
00:27:34,940 --> 00:27:39,560
week that you know they just passed the

702
00:27:37,370 --> 00:27:41,090
credentials into two-factor that was

703
00:27:39,560 --> 00:27:44,290
implemented in it dinged the person's

704
00:27:41,090 --> 00:27:47,389
phone and you know and they were in so

705
00:27:44,290 --> 00:27:49,220
gone but anyway that's so they know

706
00:27:47,390 --> 00:27:51,020
pretty quickly when they start getting

707
00:27:49,220 --> 00:27:53,900
bounce-back emails from China saying oh

708
00:27:51,020 --> 00:27:55,879
and address that exists and maybe they

709
00:27:53,900 --> 00:27:57,710
didn't set the rule up right inside that

710
00:27:55,880 --> 00:27:59,890
particular account that they compromised

711
00:27:57,710 --> 00:28:02,180
so what they'll typically do is come in

712
00:27:59,890 --> 00:28:03,950
compromised that account do their recon

713
00:28:02,180 --> 00:28:05,510
figure out who all the players are in

714
00:28:03,950 --> 00:28:07,550
the organization they'll know the

715
00:28:05,510 --> 00:28:10,250
the bank bank presidents name who's in

716
00:28:07,550 --> 00:28:12,110
charge of financial transfers who

717
00:28:10,250 --> 00:28:13,340
handles this type of loan who are the

718
00:28:12,110 --> 00:28:15,439
power players and then they'll go

719
00:28:13,340 --> 00:28:17,810
offline and just call them and they'll

720
00:28:15,440 --> 00:28:18,920
scam them right or maybe though maybe

721
00:28:17,810 --> 00:28:20,300
there's personally identifiable

722
00:28:18,920 --> 00:28:22,790
information or account information in

723
00:28:20,300 --> 00:28:24,950
those people's emails one case and one

724
00:28:22,790 --> 00:28:26,470
of the banks they're freely emailing

725
00:28:24,950 --> 00:28:29,660
back and forth they know 365

726
00:28:26,470 --> 00:28:32,090
applications for HELOC loans home equity

727
00:28:29,660 --> 00:28:33,470
lines of credit and so all the

728
00:28:32,090 --> 00:28:35,780
personally identifiable information is

729
00:28:33,470 --> 00:28:37,160
in there so once you once you click on

730
00:28:35,780 --> 00:28:40,460
that link you just gave up everything

731
00:28:37,160 --> 00:28:43,160
like it could because you had poor data

732
00:28:40,460 --> 00:28:45,770
handling practices prior to that that's

733
00:28:43,160 --> 00:28:47,240
just one example I mean we've got I mean

734
00:28:45,770 --> 00:28:49,820
just think of anything I mean we had one

735
00:28:47,240 --> 00:28:51,350
server filled up one time and they're

736
00:28:49,820 --> 00:28:52,790
like well why is a server full well it

737
00:28:51,350 --> 00:28:55,790
turns out somebody's hosting a bunch of

738
00:28:52,790 --> 00:28:58,370
porn and in games and stuff on it wears

739
00:28:55,790 --> 00:29:00,379
and stuff and they just filled it up so

740
00:28:58,370 --> 00:29:03,020
that's how they found out you know a

741
00:29:00,380 --> 00:29:04,700
thousand ways + edr solutions and other

742
00:29:03,020 --> 00:29:06,740
alerts that might go off they if they do

743
00:29:04,700 --> 00:29:16,750
take the time and - to implement that

744
00:29:06,740 --> 00:29:16,750
stuff that good anybody else back there

745
00:29:18,640 --> 00:29:22,310
ransomware text yep typically all you're

746
00:29:21,320 --> 00:29:25,370
doing there is picking up the pieces

747
00:29:22,310 --> 00:29:29,000
telling them how it happened all the

748
00:29:25,370 --> 00:29:30,679
attacks that we've seen all that well

749
00:29:29,000 --> 00:29:32,960
I'd say a majority of the texts that

750
00:29:30,680 --> 00:29:36,170
I've seen over the last seven eight

751
00:29:32,960 --> 00:29:38,570
years has been a combination of not

752
00:29:36,170 --> 00:29:39,920
patch to your third-party software back

753
00:29:38,570 --> 00:29:41,570
in the day where there was a case this

754
00:29:39,920 --> 00:29:46,780
was cool this is actually kind of a cool

755
00:29:41,570 --> 00:29:50,689
thing I had a case here where I was

756
00:29:46,780 --> 00:29:53,480
crypto wall 3.0 dropped on the system it

757
00:29:50,690 --> 00:29:55,930
spreads over four or five right so every

758
00:29:53,480 --> 00:29:58,370
the file said the file server was was

759
00:29:55,930 --> 00:29:59,840
encrypted and everything so we went in

760
00:29:58,370 --> 00:30:01,790
and they had and they had a Palo Alto a

761
00:29:59,840 --> 00:30:04,639
log or I'm sorry Palo Alto firewall

762
00:30:01,790 --> 00:30:05,750
system and they had logs and so I put

763
00:30:04,640 --> 00:30:09,530
everything together and it turned out

764
00:30:05,750 --> 00:30:13,330
that they went to STL today.com very

765
00:30:09,530 --> 00:30:16,660
benign web site and some bad guys had

766
00:30:13,330 --> 00:30:20,439
had bought Google ad space and in their

767
00:30:16,660 --> 00:30:21,940
flash ad they embedded some code that

768
00:30:20,440 --> 00:30:25,330
would interrogate the browser and find

769
00:30:21,940 --> 00:30:28,330
out what CVE it was vulnerable to and

770
00:30:25,330 --> 00:30:30,100
then as soon as it found that CVE he

771
00:30:28,330 --> 00:30:32,320
goes oh great that's this exploit kit

772
00:30:30,100 --> 00:30:36,100
BAM and then it goes out and pulls down

773
00:30:32,320 --> 00:30:38,110
the executable creates the the public

774
00:30:36,100 --> 00:30:40,409
key and then starts ripping through

775
00:30:38,110 --> 00:30:42,939
everything no kidding

776
00:30:40,410 --> 00:30:43,840
awesome great company great security but

777
00:30:42,940 --> 00:30:45,400
they just couldn't figure out how it

778
00:30:43,840 --> 00:30:46,000
happened right so that's how that

779
00:30:45,400 --> 00:30:47,620
happened

780
00:30:46,000 --> 00:30:49,570
I had the date and time stamps and I had

781
00:30:47,620 --> 00:30:52,659
the randomly generated URLs that I used

782
00:30:49,570 --> 00:30:56,139
a week later I went out to Arizona for a

783
00:30:52,660 --> 00:30:57,820
company that everybody sees on TV and I

784
00:30:56,140 --> 00:30:59,560
went in their wool room there the same

785
00:30:57,820 --> 00:31:04,530
situation and when I got into it it was

786
00:30:59,560 --> 00:31:07,240
the exact same down to the second ad and

787
00:31:04,530 --> 00:31:09,340
URLs because anybody that was looking at

788
00:31:07,240 --> 00:31:11,010
it in the United States that day when

789
00:31:09,340 --> 00:31:13,689
that ad flashed up for however many

790
00:31:11,010 --> 00:31:16,660
impressions that they bought and if they

791
00:31:13,690 --> 00:31:18,430
weren't fully patched they got it so it

792
00:31:16,660 --> 00:31:19,780
was kind of cool to see you know

793
00:31:18,430 --> 00:31:23,260
thousand miles apart

794
00:31:19,780 --> 00:31:25,330
same exact tech but yeah so basically

795
00:31:23,260 --> 00:31:27,790
the answer I mean to get deeper internet

796
00:31:25,330 --> 00:31:28,270
question is usually the damage is

797
00:31:27,790 --> 00:31:30,129
already done

798
00:31:28,270 --> 00:31:31,389
by the time that we get called they're

799
00:31:30,130 --> 00:31:34,300
done like they're like none of our

800
00:31:31,390 --> 00:31:36,520
stuffs working what do we do so then

801
00:31:34,300 --> 00:31:38,590
it's the back up conversation and if

802
00:31:36,520 --> 00:31:40,480
they're if they have any kind of logging

803
00:31:38,590 --> 00:31:42,639
in place then we can typically kind of

804
00:31:40,480 --> 00:31:44,200
explain to them how it happened if they

805
00:31:42,640 --> 00:31:45,520
haven't cleaned everything they because

806
00:31:44,200 --> 00:31:47,530
typically they'll try to like clean

807
00:31:45,520 --> 00:31:49,270
everything we can at least tell them

808
00:31:47,530 --> 00:31:50,590
what flavor or what variant the crypto

809
00:31:49,270 --> 00:31:55,240
ransomware is you know what campaign

810
00:31:50,590 --> 00:31:57,429
we'll get the the crypto currency wallet

811
00:31:55,240 --> 00:31:59,020
ID we'll get some information just put a

812
00:31:57,430 --> 00:32:01,090
report together that explains to the sea

813
00:31:59,020 --> 00:32:03,940
level what happened we're not fixing it

814
00:32:01,090 --> 00:32:05,139
I mean there's a unless it's a older

815
00:32:03,940 --> 00:32:07,720
weaker one that's already been popped

816
00:32:05,140 --> 00:32:10,090
and then we can point him to you you

817
00:32:07,720 --> 00:32:11,710
know helping them decrypt that but that

818
00:32:10,090 --> 00:32:14,770
I think happened one time since I've

819
00:32:11,710 --> 00:32:16,330
ever been doing this it was like it was

820
00:32:14,770 --> 00:32:18,330
the one that encrypted Xbox video games

821
00:32:16,330 --> 00:32:20,919
and they had broke it

822
00:32:18,330 --> 00:32:21,870
Tesla something rather Tesla crypt or

823
00:32:20,920 --> 00:32:24,700
something but

824
00:32:21,870 --> 00:32:25,600
that that wasn't so easily I said

825
00:32:24,700 --> 00:32:28,530
picking up the pieces and just

826
00:32:25,600 --> 00:32:33,820
explaining to him how they get screwed

827
00:32:28,530 --> 00:32:34,210
anybody else I'm taking all questions no

828
00:32:33,820 --> 00:32:39,490
way

829
00:32:34,210 --> 00:32:41,640
all right I got more yeah for what

830
00:32:39,490 --> 00:32:41,640
exactly

831
00:32:44,100 --> 00:32:49,929
well it depends on if you have any

832
00:32:46,510 --> 00:32:51,670
regulatory compliance issues like if it

833
00:32:49,930 --> 00:32:55,390
depends on what happened and so for

834
00:32:51,670 --> 00:32:57,300
instance the $390,000 deal FDIC only

835
00:32:55,390 --> 00:32:59,230
covers up to 250 thousand right so

836
00:32:57,300 --> 00:33:00,580
somebody's heads going to be on the spit

837
00:32:59,230 --> 00:33:02,230
and it's probably going to you know

838
00:33:00,580 --> 00:33:04,330
everybody points to the person that

839
00:33:02,230 --> 00:33:06,280
authorized it which is like a person

840
00:33:04,330 --> 00:33:10,570
internally to the agency but then it

841
00:33:06,280 --> 00:33:13,000
right away she becomes a suspect as soon

842
00:33:10,570 --> 00:33:14,620
as I say we can't tell you whether this

843
00:33:13,000 --> 00:33:15,850
was an inside job or a breach from

844
00:33:14,620 --> 00:33:18,370
outside we can't tell you because you're

845
00:33:15,850 --> 00:33:22,149
logging in your infrastructures crap so

846
00:33:18,370 --> 00:33:25,239
it could be anything there like rule you

847
00:33:22,150 --> 00:33:28,930
know might be her right so anyway at

848
00:33:25,240 --> 00:33:31,240
that point they call in the feds and

849
00:33:28,930 --> 00:33:32,740
then Secret Service that's their purview

850
00:33:31,240 --> 00:33:34,690
they call the FBI but so your survey all

851
00:33:32,740 --> 00:33:36,130
that stuff what kind of we can talk

852
00:33:34,690 --> 00:33:38,620
later about what kind of data it is and

853
00:33:36,130 --> 00:33:40,360
that can tell you more but typically it

854
00:33:38,620 --> 00:33:42,790
just depends on your threshold of pain

855
00:33:40,360 --> 00:33:44,379
and whether or not you it's whether or

856
00:33:42,790 --> 00:33:46,870
not you have a due diligence to call in

857
00:33:44,380 --> 00:33:48,370
law enforcement if you're privately held

858
00:33:46,870 --> 00:33:49,959
company and everybody signed a waiver

859
00:33:48,370 --> 00:33:51,070
that you can lose all their money and

860
00:33:49,960 --> 00:33:56,490
their information and they can't do

861
00:33:51,070 --> 00:33:59,879
anything and like all right anybody else

862
00:33:56,490 --> 00:33:59,880
got one back here

863
00:34:03,140 --> 00:34:07,790
all the time so even in the level of

864
00:34:06,500 --> 00:34:09,800
like we deploy on some of these

865
00:34:07,790 --> 00:34:11,119
incidents where if we have like say

866
00:34:09,800 --> 00:34:12,800
three four hundred computers they don't

867
00:34:11,119 --> 00:34:14,359
know what's going on they say it seems

868
00:34:12,800 --> 00:34:17,000
to be affecting the entire environment

869
00:34:14,359 --> 00:34:19,750
we'll deployed carbon black which uses

870
00:34:17,000 --> 00:34:22,609
thread Intel feeds from sands and

871
00:34:19,750 --> 00:34:25,010
silence and alienvault and all that

872
00:34:22,609 --> 00:34:27,109
stuff so I mean you know those made

873
00:34:25,010 --> 00:34:29,030
available through that tool set is one

874
00:34:27,109 --> 00:34:31,399
thing and then we have other threat

875
00:34:29,030 --> 00:34:33,679
feeds that we can attach to that that

876
00:34:31,399 --> 00:34:35,960
our subscriber based but yeah I mean

877
00:34:33,679 --> 00:34:38,510
anytime especially if we're using a EDR

878
00:34:35,960 --> 00:34:41,629
solution to get visibility on a large

879
00:34:38,510 --> 00:34:43,460
data set or a large set of hosts you

880
00:34:41,629 --> 00:34:45,799
have to use so I could sit on one

881
00:34:43,460 --> 00:34:47,740
computer and just poke around looking

882
00:34:45,800 --> 00:34:50,210
for the anomalies for two days by myself

883
00:34:47,739 --> 00:34:52,580
but I need 200 of them done and I didn't

884
00:34:50,210 --> 00:34:54,440
have done now and so held that threat

885
00:34:52,580 --> 00:34:55,730
intelligence integration and they're not

886
00:34:54,440 --> 00:34:58,190
the only product that does that I'm not

887
00:34:55,730 --> 00:34:59,480
trying to focus on them I'm saying any

888
00:34:58,190 --> 00:35:02,119
easier or any kind of an endpoint

889
00:34:59,480 --> 00:35:03,619
solution that that does use act any kind

890
00:35:02,119 --> 00:35:04,880
of active threat feed or any kind of

891
00:35:03,619 --> 00:35:06,890
intelligence endgame I've been through

892
00:35:04,880 --> 00:35:08,890
all their training they're great they do

893
00:35:06,890 --> 00:35:12,109
some cool stuff that nobody else does

894
00:35:08,890 --> 00:35:15,109
but any of that all the time we use that

895
00:35:12,109 --> 00:35:17,060
stuff because you know I only got some

896
00:35:15,109 --> 00:35:22,240
of the people and numbers or computers

897
00:35:17,060 --> 00:35:36,640
usually outnumber us ten to one but

898
00:35:22,240 --> 00:35:36,640
anybody else is ready for a beer yeah

899
00:35:37,390 --> 00:35:41,420
right yeah and when we see that kind of

900
00:35:39,920 --> 00:35:43,280
stuff we might not understand what they

901
00:35:41,420 --> 00:35:45,109
explode was it got the that got the

902
00:35:43,280 --> 00:35:46,340
compromise accomplished though we'll

903
00:35:45,109 --> 00:35:47,900
find the ancillary stuff like the

904
00:35:46,340 --> 00:35:49,550
communications for seek for command

905
00:35:47,900 --> 00:35:51,650
control how about we might find data

906
00:35:49,550 --> 00:35:53,180
exfiltration we'll find some privilege

907
00:35:51,650 --> 00:35:55,130
escalation we'll find all the stuff that

908
00:35:53,180 --> 00:35:56,569
happened after we may not understand the

909
00:35:55,130 --> 00:35:58,700
vulnerability or how they got there but

910
00:35:56,570 --> 00:36:00,650
we'll find all the other stuff and then

911
00:35:58,700 --> 00:36:02,240
we backtrack to the angle well looks

912
00:36:00,650 --> 00:36:05,750
like it's might be this binary and then

913
00:36:02,240 --> 00:36:06,618
there's no known you know analysis of it

914
00:36:05,750 --> 00:36:08,480
it's not virustotal

915
00:36:06,619 --> 00:36:11,869
or anything like that but we'll hold

916
00:36:08,480 --> 00:36:13,100
onto it and see a lot of these these

917
00:36:11,869 --> 00:36:16,490
companies I can't remember which one it

918
00:36:13,100 --> 00:36:17,038
is I know Cisco does it but anytime they

919
00:36:16,490 --> 00:36:19,529
see something

920
00:36:17,039 --> 00:36:22,469
in one of their solutions like fire amp

921
00:36:19,529 --> 00:36:25,109
or net amp they flag all those those

922
00:36:22,469 --> 00:36:26,749
hash values and if later something pops

923
00:36:25,109 --> 00:36:29,249
up on the radar six months from now that

924
00:36:26,749 --> 00:36:32,160
that device has seen it'll automatically

925
00:36:29,249 --> 00:36:35,519
go hey you had this last December you

926
00:36:32,160 --> 00:36:37,618
know but so a lot of those were those

927
00:36:35,519 --> 00:36:40,410
platforms are doing that now where

928
00:36:37,619 --> 00:36:42,209
they're keeping that data it's good

929
00:36:40,410 --> 00:36:46,049
stuff at Cisco I'm trying to think of

930
00:36:42,209 --> 00:36:49,140
the last one I think the last time I saw

931
00:36:46,049 --> 00:36:50,160
that did that but yeah I mean some

932
00:36:49,140 --> 00:36:52,169
things you're not going to be able to

933
00:36:50,160 --> 00:36:53,489
identify quickly but it's everybody's

934
00:36:52,169 --> 00:36:55,739
got the same cyber kill chain

935
00:36:53,489 --> 00:36:57,029
everybody's got the same behavior

936
00:36:55,739 --> 00:36:59,339
afterwards if you're lucky enough to

937
00:36:57,029 --> 00:37:00,929
catch it while it's going on you're

938
00:36:59,339 --> 00:37:01,979
gonna find those ancillary things that

939
00:37:00,929 --> 00:37:04,140
are gonna tell you that you have a

940
00:37:01,979 --> 00:37:13,468
problem so you get most of the questions

941
00:37:04,140 --> 00:37:16,609
answered anybody else all right that's

942
00:37:13,469 --> 00:37:16,609
it game over

