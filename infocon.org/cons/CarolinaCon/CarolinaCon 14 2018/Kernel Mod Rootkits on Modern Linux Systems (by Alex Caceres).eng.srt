1
00:00:00,360 --> 00:00:02,760
[Applause]

2
00:00:04,040 --> 00:00:11,040
hello<font color="#E5E5E5"> everybody</font>

3
00:00:06,230 --> 00:00:14,240
how's everybody done very cool I'm

4
00:00:11,040 --> 00:00:18,150
<font color="#E5E5E5">wasting time while I get the</font><font color="#CCCCCC"> slides</font><font color="#E5E5E5"> up</font>

5
00:00:14,240 --> 00:00:24,539
but I do care how you guys are<font color="#E5E5E5"> all right</font>

6
00:00:18,150 --> 00:00:29,130
<font color="#E5E5E5">so like let's just what's his name like</font>

7
00:00:24,539 --> 00:00:35,730
John whatever<font color="#E5E5E5"> but look like John said</font>

8
00:00:29,130 --> 00:00:38,790
<font color="#CCCCCC">I'm Alejandro Sarris slash Alex I am</font>

9
00:00:35,730 --> 00:00:41,279
<font color="#CCCCCC">with a company called Hyperion gray this</font>

10
00:00:38,790 --> 00:00:44,730
<font color="#E5E5E5">stock is on</font><font color="#CCCCCC"> rootkits and malware on</font>

11
00:00:41,280 --> 00:00:48,950
modern<font color="#CCCCCC"> root kits on on modern</font><font color="#E5E5E5"> Linux</font>

12
00:00:44,730 --> 00:00:52,980
systems<font color="#CCCCCC"> sorry I have</font><font color="#E5E5E5"> been drinking so</font>

13
00:00:48,950 --> 00:00:54,989
the main thing<font color="#CCCCCC"> TLDR of this talk</font><font color="#E5E5E5"> is it</font>

14
00:00:52,980 --> 00:00:57,360
you know if you get<font color="#E5E5E5"> absolutely</font><font color="#CCCCCC"> nothing</font>

15
00:00:54,989 --> 00:01:02,788
else out of<font color="#E5E5E5"> this talk it's basically</font>

16
00:00:57,360 --> 00:01:06,210
that malware exists<font color="#E5E5E5"> first of all malware</font>

17
00:01:02,789 --> 00:01:09,210
exists for modern linux<font color="#CCCCCC"> kernel's</font><font color="#E5E5E5"> and at</font>

18
00:01:06,210 --> 00:01:11,729
the same<font color="#E5E5E5"> time it has a problem in</font><font color="#CCCCCC"> that</font>

19
00:01:09,210 --> 00:01:13,020
it's very<font color="#CCCCCC"> loud right</font><font color="#E5E5E5"> like if any of you</font>

20
00:01:11,729 --> 00:01:16,158
are<font color="#E5E5E5"> familiar with how many of you guys</font>

21
00:01:13,020 --> 00:01:20,130
use<font color="#CCCCCC"> linux</font><font color="#E5E5E5"> got guys</font><font color="#CCCCCC"> i use that loosely</font>

22
00:01:16,159 --> 00:01:22,530
<font color="#E5E5E5">cool</font><font color="#CCCCCC"> so you know if you</font><font color="#E5E5E5"> run like a</font><font color="#CCCCCC"> PSA</font>

23
00:01:20,130 --> 00:01:24,240
<font color="#CCCCCC">ux you're gonna see</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the processes</font>

24
00:01:22,530 --> 00:01:26,820
<font color="#CCCCCC">bash</font><font color="#E5E5E5"> is really friendly with all that</font>

25
00:01:24,240 --> 00:01:29,939
kind of<font color="#CCCCCC"> stuff so if you run a piece</font><font color="#E5E5E5"> of</font>

26
00:01:26,820 --> 00:01:31,949
malware<font color="#E5E5E5"> that has no ability</font><font color="#CCCCCC"> to hide</font>

27
00:01:29,939 --> 00:01:35,008
<font color="#E5E5E5">itself you're gonna run into serious</font>

28
00:01:31,950 --> 00:01:37,229
<font color="#E5E5E5">problems so the rootkit</font>

29
00:01:35,009 --> 00:01:39,180
part<font color="#E5E5E5"> of it is the part that's gonna let</font>

30
00:01:37,229 --> 00:01:42,150
you hide the malware<font color="#CCCCCC"> as you're running</font>

31
00:01:39,180 --> 00:01:44,420
<font color="#E5E5E5">it</font><font color="#CCCCCC"> and basically</font><font color="#E5E5E5"> what this talk is gonna</font>

32
00:01:42,150 --> 00:01:47,180
<font color="#E5E5E5">do is</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> gonna run a piece of</font><font color="#CCCCCC"> malware</font>

33
00:01:44,420 --> 00:01:51,420
that's custom written<font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> keylogger</font>

34
00:01:47,180 --> 00:01:53,640
<font color="#E5E5E5">spoiler alert</font><font color="#CCCCCC"> and then i'm gonna run a</font>

35
00:01:51,420 --> 00:01:57,060
rootkit such that you can no longer<font color="#E5E5E5"> see</font>

36
00:01:53,640 --> 00:01:58,799
that key logger<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then some other</font>

37
00:01:57,060 --> 00:02:02,600
little<font color="#E5E5E5"> things</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the side if I have time</font>

38
00:01:58,799 --> 00:02:06,710
so anyway that's the TLDR of this talk

39
00:02:02,600 --> 00:02:08,940
<font color="#CCCCCC">let me</font><font color="#E5E5E5"> go ahead and get</font><font color="#CCCCCC"> to the slides so</font>

40
00:02:06,710 --> 00:02:11,068
<font color="#CCCCCC">the malware that I'm</font><font color="#E5E5E5"> gonna be talking</font>

41
00:02:08,940 --> 00:02:13,200
about<font color="#E5E5E5"> I know we're talking</font><font color="#CCCCCC"> about root</font>

42
00:02:11,068 --> 00:02:13,630
<font color="#CCCCCC">kits</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> a rootkit really needs a</font>

43
00:02:13,200 --> 00:02:20,190
<font color="#E5E5E5">purpose</font>

44
00:02:13,630 --> 00:02:20,190
right<font color="#CCCCCC"> I did not okay</font>

45
00:02:20,470 --> 00:02:25,720
<font color="#CCCCCC">malware really needs a purpose right</font>

46
00:02:22,930 --> 00:02:28,840
sorry yeah malware needs a

47
00:02:25,720 --> 00:02:37,440
<font color="#E5E5E5">purpose</font><font color="#CCCCCC"> rootkits what am</font><font color="#E5E5E5"> I talking</font><font color="#CCCCCC"> about</font>

48
00:02:28,840 --> 00:02:37,440
<font color="#CCCCCC">a rootkit needs a</font><font color="#E5E5E5"> purpose</font>

49
00:02:37,560 --> 00:02:45,760
so does malware and so do all of us like

50
00:02:40,690 --> 00:02:49,450
in life but yeah

51
00:02:45,760 --> 00:02:51,220
so a rootkit needs a<font color="#CCCCCC"> purpose and really</font>

52
00:02:49,450 --> 00:02:54,160
<font color="#E5E5E5">that purpose</font><font color="#CCCCCC"> that we're gonna use today</font>

53
00:02:51,220 --> 00:02:57,550
<font color="#CCCCCC">there</font><font color="#E5E5E5"> can be any number of purposes for</font>

54
00:02:54,160 --> 00:03:01,109
rootkits<font color="#CCCCCC"> today we're gonna we're gonna</font>

55
00:02:57,550 --> 00:03:04,030
see hiding a file hiding itself<font color="#E5E5E5"> and just</font>

56
00:03:01,110 --> 00:03:07,030
doing evil right so like things like

57
00:03:04,030 --> 00:03:09,820
connect backs<font color="#CCCCCC"> reverse shells whenever</font>

58
00:03:07,030 --> 00:03:13,690
any system calls are<font color="#CCCCCC"> being done</font><font color="#E5E5E5"> and I'll</font>

59
00:03:09,820 --> 00:03:14,859
explain<font color="#CCCCCC"> exactly what I mean</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> that so</font>

60
00:03:13,690 --> 00:03:17,260
we're gonna kind<font color="#E5E5E5"> of route this</font>

61
00:03:14,860 --> 00:03:22,600
presentation in<font color="#E5E5E5"> a piece of malware that</font>

62
00:03:17,260 --> 00:03:25,060
I call<font color="#CCCCCC"> Keaney logins I'm glad that I</font><font color="#E5E5E5"> got</font>

63
00:03:22,600 --> 00:03:26,950
<font color="#E5E5E5">a couple laughs because if it didn't</font><font color="#CCCCCC"> I</font>

64
00:03:25,060 --> 00:03:29,320
<font color="#E5E5E5">was gonna have</font><font color="#CCCCCC"> to explain that uh</font>

65
00:03:26,950 --> 00:03:30,579
<font color="#E5E5E5">there's actually</font><font color="#CCCCCC"> three jokes in there</font>

66
00:03:29,320 --> 00:03:32,799
actually I'm gonna explain it<font color="#E5E5E5"> anyway</font>

67
00:03:30,580 --> 00:03:35,200
there's actually three jokes in<font color="#E5E5E5"> there</font>

68
00:03:32,800 --> 00:03:39,580
right<font color="#E5E5E5"> so one is</font><font color="#CCCCCC"> that it's a</font><font color="#E5E5E5"> keylogger</font>

69
00:03:35,200 --> 00:03:42,100
<font color="#E5E5E5">obviously one is that keylogging will</font>

70
00:03:39,580 --> 00:03:46,270
help you log<font color="#CCCCCC"> in to something and the</font>

71
00:03:42,100 --> 00:03:49,140
other one is<font color="#CCCCCC"> kenny loggins who wrote you</font>

72
00:03:46,270 --> 00:03:52,360
know highway to the danger zone

73
00:03:49,140 --> 00:03:56,440
so really important part of<font color="#CCCCCC"> the</font>

74
00:03:52,360 --> 00:03:59,920
presentation<font color="#E5E5E5"> there</font><font color="#CCCCCC"> so Kenny Loggins is a</font>

75
00:03:56,440 --> 00:04:01,959
pretty basic key logger for<font color="#E5E5E5"> Linux</font><font color="#CCCCCC"> but I</font>

76
00:03:59,920 --> 00:04:05,109
<font color="#E5E5E5">am actually gonna get into</font><font color="#CCCCCC"> all of the</font>

77
00:04:01,959 --> 00:04:07,780
internals of how this works<font color="#E5E5E5"> on a Linux</font>

78
00:04:05,110 --> 00:04:12,380
system<font color="#E5E5E5"> so we'll check</font><font color="#CCCCCC"> that out here</font><font color="#E5E5E5"> in</font>

79
00:04:07,780 --> 00:04:14,540
just<font color="#CCCCCC"> a second</font><font color="#E5E5E5"> all right</font>

80
00:04:12,380 --> 00:04:17,149
so keylogging let's look at the anatomy

81
00:04:14,540 --> 00:04:21,079
of this all we're<font color="#CCCCCC"> really doing is</font>

82
00:04:17,149 --> 00:04:25,669
<font color="#E5E5E5">reading a file</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know actually how</font>

83
00:04:21,079 --> 00:04:28,099
<font color="#E5E5E5">keylogging works in Windows</font><font color="#CCCCCC"> but in</font><font color="#E5E5E5"> Linux</font>

84
00:04:25,670 --> 00:04:29,180
it's basically just a file<font color="#E5E5E5"> that records</font>

85
00:04:28,100 --> 00:04:34,040
every keystroke

86
00:04:29,180 --> 00:04:36,890
<font color="#E5E5E5">that you are ever doing anywhere</font><font color="#CCCCCC"> and we</font>

87
00:04:34,040 --> 00:04:40,490
read that<font color="#E5E5E5"> file</font><font color="#CCCCCC"> so let me go</font><font color="#E5E5E5"> ahead and</font>

88
00:04:36,890 --> 00:04:41,930
show you that<font color="#E5E5E5"> actually and it's not yeah</font>

89
00:04:40,490 --> 00:04:48,370
well you know what I'm<font color="#CCCCCC"> just gonna</font><font color="#E5E5E5"> show</font>

90
00:04:41,930 --> 00:04:52,580
<font color="#E5E5E5">you and I have a little problem</font><font color="#CCCCCC"> here</font>

91
00:04:48,370 --> 00:04:55,520
where I cannot mirror my displays<font color="#E5E5E5"> so I'm</font>

92
00:04:52,580 --> 00:04:57,859
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> go ahead and put my VM over here</font>

93
00:04:55,520 --> 00:05:00,979
but I can't<font color="#E5E5E5"> see on my own machine</font>

94
00:04:57,860 --> 00:05:03,530
<font color="#E5E5E5">so I'm just gonna have</font><font color="#CCCCCC"> to like look this</font>

95
00:05:00,980 --> 00:05:05,660
way<font color="#CCCCCC"> and hope</font><font color="#E5E5E5"> that everything</font><font color="#CCCCCC"> works out</font>

96
00:05:03,530 --> 00:05:17,799
really really well

97
00:05:05,660 --> 00:05:17,800
<font color="#CCCCCC">oh that's that's</font><font color="#E5E5E5"> like the spoiler</font>

98
00:05:19,870 --> 00:05:27,980
<font color="#E5E5E5">okay so how does this malware work right</font>

99
00:05:22,870 --> 00:05:31,370
<font color="#E5E5E5">so I have this file here by the way can</font>

100
00:05:27,980 --> 00:05:34,730
everybody see that yeah okay

101
00:05:31,370 --> 00:05:38,500
very cool<font color="#E5E5E5"> so I have this file Hilliker</font><font color="#CCCCCC"> I</font>

102
00:05:34,730 --> 00:05:41,840
<font color="#CCCCCC">have this file here project here I'm</font>

103
00:05:38,500 --> 00:05:43,550
anyway<font color="#CCCCCC"> I hope this file here called</font>

104
00:05:41,840 --> 00:05:46,969
<font color="#CCCCCC">Keeney login</font><font color="#E5E5E5"> so if you see</font><font color="#CCCCCC"> that</font>

105
00:05:43,550 --> 00:05:48,950
executable<font color="#E5E5E5"> file the one in green</font><font color="#CCCCCC"> that's</font>

106
00:05:46,970 --> 00:05:50,600
Kenny Loggins<font color="#CCCCCC"> all this going</font><font color="#E5E5E5"> to do is</font>

107
00:05:48,950 --> 00:05:56,990
log key so let's just go ahead<font color="#CCCCCC"> and run</font>

108
00:05:50,600 --> 00:06:00,940
<font color="#E5E5E5">that</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> it outputs the</font><font color="#CCCCCC"> number four</font>

109
00:05:56,990 --> 00:06:00,940
I don't remember why

110
00:06:04,410 --> 00:06:08,910
just trying<font color="#E5E5E5"> to be honest with all of you</font>

111
00:06:09,600 --> 00:06:14,650
sorry<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> here we</font><font color="#CCCCCC"> go</font>

112
00:06:11,770 --> 00:06:18,280
now let's<font color="#E5E5E5"> look into</font><font color="#CCCCCC"> it kind</font><font color="#E5E5E5"> of a deep</font>

113
00:06:14,650 --> 00:06:20,530
dive<font color="#E5E5E5"> that's not it let's just</font><font color="#CCCCCC"> do</font>

114
00:06:18,280 --> 00:06:32,289
kind<font color="#CCCCCC"> of a deep dive</font><font color="#E5E5E5"> on what the hell is</font>

115
00:06:20,530 --> 00:06:35,530
going on here<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so let</font><font color="#E5E5E5"> me see wait</font>

116
00:06:32,290 --> 00:06:36,600
what<font color="#CCCCCC"> oh yeah no I'm sorry I don't know</font>

117
00:06:35,530 --> 00:06:39,070
how to<font color="#E5E5E5"> Linux</font>

118
00:06:36,600 --> 00:06:45,610
feel<font color="#E5E5E5"> free to correct me at any time by</font>

119
00:06:39,070 --> 00:06:48,840
<font color="#E5E5E5">the way hey thank you hey there</font>

120
00:06:45,610 --> 00:06:53,950
everybody see<font color="#CCCCCC"> that sign that's</font><font color="#E5E5E5"> very nice</font>

121
00:06:48,840 --> 00:06:56,679
super sweet<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so I have this</font>

122
00:06:53,950 --> 00:06:59,229
<font color="#E5E5E5">little file called Carolina context and</font>

123
00:06:56,680 --> 00:07:04,360
the first command<font color="#CCCCCC"> that I want is right</font>

124
00:06:59,230 --> 00:07:06,730
<font color="#CCCCCC">here and again this is how</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> key logger</font>

125
00:07:04,360 --> 00:07:11,620
works on Linux we're not yet to the

126
00:07:06,730 --> 00:07:13,990
rootkit portion of it<font color="#CCCCCC"> alright so what</font>

127
00:07:11,620 --> 00:07:16,810
I'm<font color="#CCCCCC"> doing is I'm reading</font><font color="#E5E5E5"> this file over</font>

128
00:07:13,990 --> 00:07:19,420
<font color="#CCCCCC">here called</font><font color="#E5E5E5"> slash dev slash input slash</font>

129
00:07:16,810 --> 00:07:22,510
by path slash platform blah blah blah

130
00:07:19,420 --> 00:07:25,050
-<font color="#E5E5E5"> KVD right so what we're doing is we're</font>

131
00:07:22,510 --> 00:07:28,480
looking<font color="#E5E5E5"> within the dev input by path</font>

132
00:07:25,050 --> 00:07:30,970
folder directory actually<font color="#E5E5E5"> in Linux if</font>

133
00:07:28,480 --> 00:07:34,930
you want to get technical<font color="#CCCCCC"> and looking</font>

134
00:07:30,970 --> 00:07:40,870
for anything<font color="#E5E5E5"> with -</font><font color="#CCCCCC"> kbd in it right</font><font color="#E5E5E5"> -</font><font color="#CCCCCC"> kb</font>

135
00:07:34,930 --> 00:07:43,140
d stands for keyboard<font color="#CCCCCC"> and one particular</font>

136
00:07:40,870 --> 00:07:48,070
key that<font color="#E5E5E5"> I wanted to show you that</font>

137
00:07:43,140 --> 00:07:49,870
<font color="#CCCCCC">fuck's my mouse is the Escape key</font>

138
00:07:48,070 --> 00:07:51,760
<font color="#E5E5E5">the reason I wanted to</font><font color="#CCCCCC"> show you</font><font color="#E5E5E5"> logging</font>

139
00:07:49,870 --> 00:07:56,290
of<font color="#E5E5E5"> the Escape key is because the Escape</font>

140
00:07:51,760 --> 00:08:00,310
key is<font color="#E5E5E5"> one in this particular</font><font color="#CCCCCC"> code right</font>

141
00:07:56,290 --> 00:08:04,540
here<font color="#E5E5E5"> so we see that we</font><font color="#CCCCCC"> have one right</font>

142
00:08:00,310 --> 00:08:07,060
<font color="#CCCCCC">here</font><font color="#E5E5E5"> one again right there</font><font color="#CCCCCC"> exactly where</font>

143
00:08:04,540 --> 00:08:10,780
my<font color="#E5E5E5"> mouse cursor is</font><font color="#CCCCCC"> but keep</font><font color="#E5E5E5"> having ones</font>

144
00:08:07,060 --> 00:08:13,450
and then now extremely confusingly

145
00:08:10,780 --> 00:08:14,090
<font color="#CCCCCC">I'm going to press the number one on my</font>

146
00:08:13,450 --> 00:08:19,810
key

147
00:08:14,090 --> 00:08:22,669
and the code<font color="#CCCCCC"> for the number 1 is 2 I</font>

148
00:08:19,810 --> 00:08:25,040
don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> why they did that</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> there</font>

149
00:08:22,670 --> 00:08:26,330
it is<font color="#E5E5E5"> right</font><font color="#CCCCCC"> there the rest</font><font color="#E5E5E5"> of the stuff</font>

150
00:08:25,040 --> 00:08:29,330
<font color="#CCCCCC">that</font><font color="#E5E5E5"> comes out here</font><font color="#CCCCCC"> is kind</font><font color="#E5E5E5"> of</font>

151
00:08:26,330 --> 00:08:31,010
boilerplate<font color="#E5E5E5"> Linux stuff</font><font color="#CCCCCC"> so when you're</font>

152
00:08:29,330 --> 00:08:35,840
parsing this follow you do kind of have

153
00:08:31,010 --> 00:08:38,270
<font color="#E5E5E5">to look for basically the</font><font color="#CCCCCC"> information</font>

154
00:08:35,840 --> 00:08:40,700
that you want<font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> really how</font><font color="#CCCCCC"> key</font>

155
00:08:38,270 --> 00:08:52,930
<font color="#CCCCCC">logging works I'll show you a little bit</font>

156
00:08:40,700 --> 00:08:52,930
more regarding<font color="#E5E5E5"> that don't do that to me</font>

157
00:09:02,050 --> 00:09:12,740
yeah no actually<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to switch</font>

158
00:09:04,460 --> 00:09:18,200
back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> my slides right now apologies</font>

159
00:09:12,740 --> 00:09:20,060
<font color="#CCCCCC">for all</font><font color="#E5E5E5"> the delays</font><font color="#CCCCCC"> alright so what did</font>

160
00:09:18,200 --> 00:09:23,330
we see<font color="#CCCCCC"> right there we saw lots of hacks</font>

161
00:09:20,060 --> 00:09:26,569
<font color="#CCCCCC">lots of zeros and stuff right</font><font color="#E5E5E5"> kind of</font>

162
00:09:23,330 --> 00:09:29,060
<font color="#E5E5E5">annoying</font><font color="#CCCCCC"> but here's a diagram</font><font color="#E5E5E5"> of</font>

163
00:09:26,570 --> 00:09:32,360
essentially what<font color="#CCCCCC"> Keeney logins is going</font>

164
00:09:29,060 --> 00:09:35,780
to do<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so really simple diagram</font>

165
00:09:32,360 --> 00:09:40,310
right here<font color="#E5E5E5"> your keyboard is sending</font>

166
00:09:35,780 --> 00:09:43,160
- star -<font color="#CCCCCC"> KBD as</font><font color="#E5E5E5"> I showed you</font><font color="#CCCCCC"> right and</font>

167
00:09:40,310 --> 00:09:45,589
then star -<font color="#CCCCCC"> KVD is being read by</font><font color="#E5E5E5"> the</font>

168
00:09:43,160 --> 00:09:49,219
system<font color="#E5E5E5"> for processing essentially</font>

169
00:09:45,590 --> 00:09:51,650
anything<font color="#CCCCCC"> that requires</font><font color="#E5E5E5"> keys which is</font>

170
00:09:49,220 --> 00:09:56,690
almost<font color="#E5E5E5"> anything unless you're using your</font>

171
00:09:51,650 --> 00:09:59,840
mouse<font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> that's that was kind of</font>

172
00:09:56,690 --> 00:10:02,210
<font color="#E5E5E5">like a normal view</font><font color="#CCCCCC"> of what Linux does so</font>

173
00:09:59,840 --> 00:10:04,160
in this particular<font color="#CCCCCC"> case we're</font><font color="#E5E5E5"> gonna run</font>

174
00:10:02,210 --> 00:10:07,550
a program that reads those keyboard

175
00:10:04,160 --> 00:10:09,500
events it's gonna decode them<font color="#E5E5E5"> in that</font>

176
00:10:07,550 --> 00:10:12,170
you know all that funny hex<font color="#E5E5E5"> that was</font>

177
00:10:09,500 --> 00:10:13,990
happening<font color="#CCCCCC"> it's actually going</font><font color="#E5E5E5"> to decode</font>

178
00:10:12,170 --> 00:10:16,040
them and turn them<font color="#CCCCCC"> into something</font><font color="#E5E5E5"> useful</font>

179
00:10:13,990 --> 00:10:20,870
<font color="#CCCCCC">and it's</font><font color="#E5E5E5"> gonna store them on the</font>

180
00:10:16,040 --> 00:10:24,349
<font color="#E5E5E5">filesystem</font><font color="#CCCCCC"> in a hidden folder and it</font>

181
00:10:20,870 --> 00:10:26,900
will extract<font color="#E5E5E5"> it off to a remote server</font>

182
00:10:24,350 --> 00:10:27,870
<font color="#E5E5E5">which doesn't need to be done you can</font>

183
00:10:26,900 --> 00:10:30,120
always<font color="#E5E5E5"> like kind</font><font color="#CCCCCC"> of</font>

184
00:10:27,870 --> 00:10:33,690
persistent access and store it locally

185
00:10:30,120 --> 00:10:36,150
but you know it's always nice<font color="#CCCCCC"> to get</font>

186
00:10:33,690 --> 00:10:38,220
remote things just so you can like sit

187
00:10:36,150 --> 00:10:39,890
at your computer<font color="#CCCCCC"> and not</font><font color="#E5E5E5"> have to worry</font>

188
00:10:38,220 --> 00:10:42,510
about<font color="#E5E5E5"> it</font>

189
00:10:39,890 --> 00:10:45,530
<font color="#CCCCCC">alright so a demo of</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> Kenny Loggins</font>

190
00:10:42,510 --> 00:10:53,520
<font color="#E5E5E5">is actually doing is coming up right</font>

191
00:10:45,530 --> 00:10:57,780
about<font color="#CCCCCC"> now so as I showed you before</font>

192
00:10:53,520 --> 00:11:00,689
<font color="#CCCCCC">Kimmy Loggins should be running should</font>

193
00:10:57,780 --> 00:11:02,970
be<font color="#E5E5E5"> running right</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> again outputting</font>

194
00:11:00,690 --> 00:11:07,170
the<font color="#E5E5E5"> number</font><font color="#CCCCCC"> four for a inexplicable</font>

195
00:11:02,970 --> 00:11:11,400
reason<font color="#CCCCCC"> and what I wanted</font><font color="#E5E5E5"> to show you</font>

196
00:11:07,170 --> 00:11:15,240
with Kenny Loggins<font color="#E5E5E5"> is well actually</font>

197
00:11:11,400 --> 00:11:21,209
<font color="#E5E5E5">first of all yeah now let me show you</font>

198
00:11:15,240 --> 00:11:24,810
<font color="#E5E5E5">exactly what it does</font><font color="#CCCCCC"> and for those of</font>

199
00:11:21,210 --> 00:11:28,110
<font color="#CCCCCC">you familiar with Linux what I'm doing</font>

200
00:11:24,810 --> 00:11:30,750
<font color="#CCCCCC">right there that dot dot dot that's</font>

201
00:11:28,110 --> 00:11:34,890
actually a perfectly<font color="#E5E5E5"> valid name for a</font>

202
00:11:30,750 --> 00:11:38,160
directory<font color="#E5E5E5"> it's just a really mean one so</font>

203
00:11:34,890 --> 00:11:40,740
I'm in slash<font color="#E5E5E5"> Etsy right but I'm making a</font>

204
00:11:38,160 --> 00:11:44,850
hidden<font color="#CCCCCC"> folder which is</font><font color="#E5E5E5"> the first dot and</font>

205
00:11:40,740 --> 00:11:47,700
that<font color="#E5E5E5"> hidden folder is a dot dot dot</font><font color="#CCCCCC"> dot</font>

206
00:11:44,850 --> 00:11:50,190
is reserved for going back a directory

207
00:11:47,700 --> 00:11:52,590
<font color="#E5E5E5">except in this case it's just like a</font>

208
00:11:50,190 --> 00:11:54,330
normal directory and I'm<font color="#E5E5E5"> doing it in</font>

209
00:11:52,590 --> 00:11:57,480
slash Etsy which<font color="#E5E5E5"> is a place where</font>

210
00:11:54,330 --> 00:12:00,960
there's<font color="#E5E5E5"> a ton of files right so unless</font>

211
00:11:57,480 --> 00:12:02,910
you're actually<font color="#CCCCCC"> looking for this file</font>

212
00:12:00,960 --> 00:12:05,390
<font color="#E5E5E5">you're never gonna find it which is</font>

213
00:12:02,910 --> 00:12:05,390
pretty sweet

214
00:12:05,780 --> 00:12:13,520
so let's actually<font color="#E5E5E5"> you know before I do</font>

215
00:12:08,970 --> 00:12:13,520
<font color="#E5E5E5">this</font><font color="#CCCCCC"> let me copy this command</font><font color="#E5E5E5"> does</font>

216
00:12:14,030 --> 00:12:17,839
<font color="#CCCCCC">anybody</font><font color="#E5E5E5"> see my mouse</font>

217
00:12:22,880 --> 00:12:29,280
thank you guys

218
00:12:24,590 --> 00:12:31,080
much appreciated<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so before we</font>

219
00:12:29,280 --> 00:12:37,550
<font color="#E5E5E5">see any of</font><font color="#CCCCCC"> that let's go ahead and type</font>

220
00:12:31,080 --> 00:12:50,520
a<font color="#CCCCCC"> message to ourselves like I don't</font><font color="#E5E5E5"> know</font>

221
00:12:37,550 --> 00:12:56,819
<font color="#E5E5E5">this is a message self</font><font color="#CCCCCC"> whatever</font><font color="#E5E5E5"> you guys</font>

222
00:12:50,520 --> 00:12:59,730
know what I'm getting<font color="#CCCCCC"> at so some people</font>

223
00:12:56,820 --> 00:13:02,220
wonder like why do why do you like

224
00:12:59,730 --> 00:13:04,530
presenters forget how to<font color="#E5E5E5"> use computers</font>

225
00:13:02,220 --> 00:13:07,260
<font color="#E5E5E5">just all of a sudden like</font><font color="#CCCCCC"> when once they</font>

226
00:13:04,530 --> 00:13:10,230
get like up on you know<font color="#E5E5E5"> this stage or</font>

227
00:13:07,260 --> 00:13:12,210
whatever<font color="#CCCCCC"> and a big reason</font><font color="#E5E5E5"> is first of</font>

228
00:13:10,230 --> 00:13:15,780
<font color="#CCCCCC">all we're always like a</font><font color="#E5E5E5"> little nervous I</font>

229
00:13:12,210 --> 00:13:18,480
think<font color="#CCCCCC"> oh by the way this is a message to</font>

230
00:13:15,780 --> 00:13:20,189
<font color="#CCCCCC">myself</font><font color="#E5E5E5"> shows up right there there's some</font>

231
00:13:18,480 --> 00:13:21,930
repeated characters and<font color="#E5E5E5"> that's just a</font>

232
00:13:20,190 --> 00:13:23,730
bug in<font color="#E5E5E5"> kenny loggins but let's just</font>

233
00:13:21,930 --> 00:13:27,630
pretend<font color="#E5E5E5"> that never happened</font><font color="#CCCCCC"> and we'll</font>

234
00:13:23,730 --> 00:13:29,850
move on from<font color="#CCCCCC"> there and I'll go back to</font>

235
00:13:27,630 --> 00:13:32,970
what I was<font color="#E5E5E5"> saying before about why we</font>

236
00:13:29,850 --> 00:13:36,240
forget how to<font color="#E5E5E5"> use computers</font><font color="#CCCCCC"> so first of</font>

237
00:13:32,970 --> 00:13:39,420
<font color="#E5E5E5">all that VM I'm not seeing that here I</font>

238
00:13:36,240 --> 00:13:41,130
have<font color="#E5E5E5"> my slides</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> my VM there my</font>

239
00:13:39,420 --> 00:13:44,610
keyboard<font color="#CCCCCC"> here which</font><font color="#E5E5E5"> I you don't</font><font color="#CCCCCC"> really</font>

240
00:13:41,130 --> 00:13:45,960
<font color="#E5E5E5">use an external keyboard so that's kind</font>

241
00:13:44,610 --> 00:13:47,940
of what and sometimes you're using

242
00:13:45,960 --> 00:13:50,010
somebody else's computer<font color="#E5E5E5"> which is why I</font>

243
00:13:47,940 --> 00:13:51,990
like<font color="#CCCCCC"> you automatic like</font><font color="#E5E5E5"> it looks like</font>

244
00:13:50,010 --> 00:13:54,830
you're an idiot<font color="#CCCCCC"> like like it's like</font><font color="#E5E5E5"> you</font>

245
00:13:51,990 --> 00:13:57,870
know I don't know how to use a computer

246
00:13:54,830 --> 00:14:09,180
<font color="#E5E5E5">but that's cool you know because now you</font>

247
00:13:57,870 --> 00:14:12,420
guys understand<font color="#E5E5E5"> what</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> shift f5 okay so</font>

248
00:14:09,180 --> 00:14:14,459
I<font color="#CCCCCC"> already showed you all that yeah so</font>

249
00:14:12,420 --> 00:14:18,060
you might be<font color="#CCCCCC"> wondering</font><font color="#E5E5E5"> if it's annoying</font>

250
00:14:14,460 --> 00:14:20,640
<font color="#E5E5E5">to have</font><font color="#CCCCCC"> to add all this keystroke</font><font color="#E5E5E5"> codes</font>

251
00:14:18,060 --> 00:14:23,219
manually like that zero zero zero one

252
00:14:20,640 --> 00:14:28,260
zero zero zero two zero zero zero three

253
00:14:23,220 --> 00:14:31,310
and the answer<font color="#CCCCCC"> really is yes you have to</font>

254
00:14:28,260 --> 00:14:33,560
essentially<font color="#E5E5E5"> map</font><font color="#CCCCCC"> each one of those</font>

255
00:14:31,310 --> 00:14:35,000
actual key<font color="#CCCCCC"> I was going to show you that</font>

256
00:14:33,560 --> 00:14:36,770
but<font color="#CCCCCC"> I think I'm gonna</font><font color="#E5E5E5"> skip that right</font>

257
00:14:35,000 --> 00:14:40,640
now because we're<font color="#E5E5E5"> probably running short</font>

258
00:14:36,770 --> 00:14:46,449
on time<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know okay</font>

259
00:14:40,640 --> 00:14:46,449
guys like whatever<font color="#CCCCCC"> I'll give</font><font color="#E5E5E5"> you</font>

260
00:14:47,210 --> 00:14:57,350
so that yes let<font color="#CCCCCC"> me show you know</font><font color="#E5E5E5"> let me</font>

261
00:14:51,650 --> 00:15:00,980
<font color="#E5E5E5">not show you that</font><font color="#CCCCCC"> oh I went</font>

262
00:14:57,350 --> 00:15:01,700
<font color="#CCCCCC">backwards demo</font><font color="#E5E5E5"> Keaney logins already did</font>

263
00:15:00,980 --> 00:15:03,500
<font color="#CCCCCC">all of that</font>

264
00:15:01,700 --> 00:15:06,110
<font color="#CCCCCC">alright so</font><font color="#E5E5E5"> finally we get to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> rootkit</font>

265
00:15:03,500 --> 00:15:09,260
portion of it<font color="#CCCCCC"> not</font><font color="#E5E5E5"> much less than the</font>

266
00:15:06,110 --> 00:15:12,680
<font color="#E5E5E5">presentation</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> but a kernel-mode</font>

267
00:15:09,260 --> 00:15:14,750
rootkit also known as an<font color="#E5E5E5"> lkm rootkit lkm</font>

268
00:15:12,680 --> 00:15:16,939
stands for loadable kernel module

269
00:15:14,750 --> 00:15:18,170
rootkit<font color="#E5E5E5"> it's probably the simplest type</font>

270
00:15:16,940 --> 00:15:22,730
of<font color="#E5E5E5"> rootkit but it's still extremely</font>

271
00:15:18,170 --> 00:15:24,529
<font color="#E5E5E5">effective</font><font color="#CCCCCC"> it works</font><font color="#E5E5E5"> on the four</font><font color="#CCCCCC"> decks</font>

272
00:15:22,730 --> 00:15:29,420
<font color="#E5E5E5">Linux kernel which is</font><font color="#CCCCCC"> the most</font><font color="#E5E5E5"> modern</font>

273
00:15:24,529 --> 00:15:31,670
one<font color="#CCCCCC"> I should say they work on four dot X</font>

274
00:15:29,420 --> 00:15:35,209
Linux kernels<font color="#E5E5E5"> the most modern Linux</font>

275
00:15:31,670 --> 00:15:39,020
kernel<font color="#CCCCCC"> so they still work</font><font color="#E5E5E5"> they're hard</font>

276
00:15:35,210 --> 00:15:41,240
<font color="#CCCCCC">to detect and</font><font color="#E5E5E5"> it's called a rootkit for</font>

277
00:15:39,020 --> 00:15:43,550
one<font color="#E5E5E5"> really important reason it assumes</font>

278
00:15:41,240 --> 00:15:46,700
that you've<font color="#E5E5E5"> already done all of the</font>

279
00:15:43,550 --> 00:15:49,550
privilege escalation stuff and you're

280
00:15:46,700 --> 00:15:52,670
just<font color="#E5E5E5"> trying to persist access hide files</font>

281
00:15:49,550 --> 00:15:55,280
and do other really malicious things<font color="#E5E5E5"> so</font>

282
00:15:52,670 --> 00:15:57,800
here's like a<font color="#E5E5E5"> diagram of exactly what</font>

283
00:15:55,280 --> 00:16:00,860
I'm talking about<font color="#E5E5E5"> so this is a normal</font>

284
00:15:57,800 --> 00:16:04,810
Linux system right<font color="#CCCCCC"> so let's start at the</font>

285
00:16:00,860 --> 00:16:07,580
top<font color="#E5E5E5"> right</font><font color="#CCCCCC"> there where it says process</font>

286
00:16:04,810 --> 00:16:10,760
<font color="#E5E5E5">process is a user</font><font color="#CCCCCC"> right so that's user</font>

287
00:16:07,580 --> 00:16:13,490
space that we're working with<font color="#E5E5E5"> process</font>

288
00:16:10,760 --> 00:16:16,550
calls a system call handler which means

289
00:16:13,490 --> 00:16:18,500
that for<font color="#CCCCCC"> example we want</font><font color="#E5E5E5"> to open a file</font>

290
00:16:16,550 --> 00:16:20,959
<font color="#CCCCCC">right or let's use the example of</font>

291
00:16:18,500 --> 00:16:22,910
writing<font color="#E5E5E5"> a file so we want to write</font><font color="#CCCCCC"> a</font>

292
00:16:20,959 --> 00:16:25,430
file it calls the system call<font color="#E5E5E5"> handler</font>

293
00:16:22,910 --> 00:16:31,339
<font color="#E5E5E5">that</font><font color="#CCCCCC"> system call handler is exposed as a</font>

294
00:16:25,430 --> 00:16:32,930
function for a user<font color="#E5E5E5"> generally well yeah</font>

295
00:16:31,339 --> 00:16:36,440
generally<font color="#E5E5E5"> you would be writing</font><font color="#CCCCCC"> this in C</font>

296
00:16:32,930 --> 00:16:38,630
code because Linux is natively C<font color="#CCCCCC"> so it</font>

297
00:16:36,440 --> 00:16:41,750
calls<font color="#E5E5E5"> the system call handler the system</font>

298
00:16:38,630 --> 00:16:44,390
call handler<font color="#CCCCCC"> looks up where the right</font>

299
00:16:41,750 --> 00:16:46,670
system call is on the<font color="#E5E5E5"> system called</font>

300
00:16:44,390 --> 00:16:52,130
<font color="#CCCCCC">Abell which is just a table that holds</font>

301
00:16:46,670 --> 00:16:58,189
all system calls<font color="#E5E5E5"> obviously so it's got</font>

302
00:16:52,130 --> 00:17:00,800
stuff<font color="#CCCCCC"> like right open/close mkdir</font><font color="#E5E5E5"> all of</font>

303
00:16:58,190 --> 00:17:04,339
those things<font color="#CCCCCC"> our Linux system calls</font>

304
00:17:00,800 --> 00:17:07,099
right<font color="#CCCCCC"> and in this</font><font color="#E5E5E5"> case we're doing a</font>

305
00:17:04,339 --> 00:17:10,669
right sis call and then you see at the

306
00:17:07,099 --> 00:17:16,730
<font color="#CCCCCC">very right</font><font color="#E5E5E5"> of the diagram</font><font color="#CCCCCC"> we're doing it</font>

307
00:17:10,670 --> 00:17:18,550
right which is<font color="#CCCCCC"> cool</font><font color="#E5E5E5"> so now</font><font color="#CCCCCC"> you see</font>

308
00:17:16,730 --> 00:17:21,380
pretty much<font color="#CCCCCC"> the</font><font color="#E5E5E5"> exact same diagram</font>

309
00:17:18,550 --> 00:17:24,050
<font color="#E5E5E5">except we have that loadable kernel</font>

310
00:17:21,380 --> 00:17:26,449
module right<font color="#E5E5E5"> in between the system call</font>

311
00:17:24,050 --> 00:17:28,940
handler<font color="#E5E5E5"> and the right</font><font color="#CCCCCC"> sis call</font><font color="#E5E5E5"> we have</font>

312
00:17:26,449 --> 00:17:31,580
this loadable kernel module<font color="#E5E5E5"> so what does</font>

313
00:17:28,940 --> 00:17:33,470
that do right it replaces<font color="#E5E5E5"> the address in</font>

314
00:17:31,580 --> 00:17:37,429
<font color="#E5E5E5">the system call table with the location</font>

315
00:17:33,470 --> 00:17:40,360
<font color="#CCCCCC">of our own</font><font color="#E5E5E5"> right function so what we're</font>

316
00:17:37,430 --> 00:17:43,340
doing<font color="#E5E5E5"> is the system call table is</font>

317
00:17:40,360 --> 00:17:46,100
looking for a function right<font color="#E5E5E5"> let's say</font>

318
00:17:43,340 --> 00:17:48,139
we call the right function<font color="#E5E5E5"> it's looking</font>

319
00:17:46,100 --> 00:17:51,500
for where that<font color="#E5E5E5"> right function is in</font>

320
00:17:48,140 --> 00:17:53,840
<font color="#CCCCCC">memory and what we're doing is we're</font>

321
00:17:51,500 --> 00:17:56,900
<font color="#E5E5E5">overwriting that system call table and</font>

322
00:17:53,840 --> 00:17:59,149
saying no<font color="#E5E5E5"> don't look for this don't look</font>

323
00:17:56,900 --> 00:18:01,610
for it in this address<font color="#CCCCCC"> space</font><font color="#E5E5E5"> actually</font>

324
00:17:59,150 --> 00:18:03,470
<font color="#CCCCCC">look for it in this</font><font color="#E5E5E5"> other address space</font>

325
00:18:01,610 --> 00:18:07,270
and that other address space is

326
00:18:03,470 --> 00:18:09,290
somewhere<font color="#CCCCCC"> that we control</font><font color="#E5E5E5"> and we can</font><font color="#CCCCCC"> do</font>

327
00:18:07,270 --> 00:18:12,830
whatever<font color="#E5E5E5"> the we want</font>

328
00:18:09,290 --> 00:18:14,720
which is<font color="#E5E5E5"> really cool</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is kind of</font>

329
00:18:12,830 --> 00:18:17,419
what it looks<font color="#E5E5E5"> like right so we replaced</font>

330
00:18:14,720 --> 00:18:20,600
the address in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> system call table</font><font color="#CCCCCC"> it</font>

331
00:18:17,420 --> 00:18:24,890
does the<font color="#CCCCCC"> evil right right which is just</font>

332
00:18:20,600 --> 00:18:30,260
<font color="#E5E5E5">kind of our new</font><font color="#CCCCCC"> write function evil</font>

333
00:18:24,890 --> 00:18:32,780
right is executed we typically will do

334
00:18:30,260 --> 00:18:36,379
the evil right<font color="#E5E5E5"> and then call the actual</font>

335
00:18:32,780 --> 00:18:39,230
right<font color="#CCCCCC"> so that it's not detected right so</font>

336
00:18:36,380 --> 00:18:41,450
we're actually calling the the<font color="#E5E5E5"> assist</font>

337
00:18:39,230 --> 00:18:44,770
call at the very end of whatever

338
00:18:41,450 --> 00:18:47,510
malicious thing it is<font color="#CCCCCC"> that we're doing</font>

339
00:18:44,770 --> 00:18:49,790
so here's some syscall examples just<font color="#CCCCCC"> to</font>

340
00:18:47,510 --> 00:18:53,840
give you an idea<font color="#E5E5E5"> of what exactly</font><font color="#CCCCCC"> in lkm</font>

341
00:18:49,790 --> 00:18:56,300
<font color="#CCCCCC">kit can do right</font><font color="#E5E5E5"> so we have process</font>

342
00:18:53,840 --> 00:18:57,959
control we can load execute and abort

343
00:18:56,300 --> 00:19:01,260
create process termina

344
00:18:57,960 --> 00:19:04,740
process file management delete file open

345
00:19:01,260 --> 00:19:06,510
<font color="#CCCCCC">close read/write reposition get slash</font>

346
00:19:04,740 --> 00:19:07,860
<font color="#CCCCCC">that file attributes in particular</font>

347
00:19:06,510 --> 00:19:10,350
here's where we can<font color="#CCCCCC"> with</font>

348
00:19:07,860 --> 00:19:13,949
permissions which is pretty<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> device</font>

349
00:19:10,350 --> 00:19:16,770
<font color="#CCCCCC">management we can</font><font color="#E5E5E5"> logically attach or or</font>

350
00:19:13,950 --> 00:19:19,679
detach devices which<font color="#E5E5E5"> is awesome</font>

351
00:19:16,770 --> 00:19:22,039
release device<font color="#CCCCCC"> read write reposition</font>

352
00:19:19,679 --> 00:19:25,470
again<font color="#E5E5E5"> get set device attributes</font>

353
00:19:22,039 --> 00:19:29,580
information<font color="#E5E5E5"> maintenance</font><font color="#CCCCCC"> so this is where</font>

354
00:19:25,470 --> 00:19:39,059
we<font color="#E5E5E5"> can really start to do some like anti</font>

355
00:19:29,580 --> 00:19:47,639
forensics<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> where we can</font><font color="#E5E5E5"> I lost my</font>

356
00:19:39,059 --> 00:19:59,330
train of thought<font color="#E5E5E5"> give me one second my</font>

357
00:19:47,640 --> 00:20:02,520
spinach right so what we can<font color="#CCCCCC"> do with all</font>

358
00:19:59,330 --> 00:20:05,070
what we can do with anti forensics is we

359
00:20:02,520 --> 00:20:07,620
can<font color="#E5E5E5"> change time stamps on piles right so</font>

360
00:20:05,070 --> 00:20:09,600
we write a<font color="#E5E5E5"> file and then we say now this</font>

361
00:20:07,620 --> 00:20:11,820
was created like<font color="#E5E5E5"> a year</font><font color="#CCCCCC"> ago</font><font color="#E5E5E5"> like</font>

362
00:20:09,600 --> 00:20:14,610
<font color="#CCCCCC">that you don't need to worry about it</font>

363
00:20:11,820 --> 00:20:15,960
but in reality you actually do need to

364
00:20:14,610 --> 00:20:19,830
worry<font color="#E5E5E5"> about it because it's a horrible</font>

365
00:20:15,960 --> 00:20:22,500
<font color="#E5E5E5">file</font><font color="#CCCCCC"> did I get to communication no</font>

366
00:20:19,830 --> 00:20:25,379
communication<font color="#E5E5E5"> so you can open TCP</font>

367
00:20:22,500 --> 00:20:27,870
connections open UDP connections<font color="#CCCCCC"> all</font>

368
00:20:25,380 --> 00:20:30,360
kinds of stuff so<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> actually exfil</font>

369
00:20:27,870 --> 00:20:32,699
traffic very<font color="#E5E5E5"> easily and</font><font color="#CCCCCC"> we can</font><font color="#E5E5E5"> also hide</font>

370
00:20:30,360 --> 00:20:37,110
<font color="#CCCCCC">the exfil of that traffic which is</font>

371
00:20:32,700 --> 00:20:41,309
pretty cool<font color="#CCCCCC"> another kind</font><font color="#E5E5E5"> of class of</font>

372
00:20:37,110 --> 00:20:43,080
<font color="#E5E5E5">syscalls is tom fuckery</font><font color="#CCCCCC"> you can</font>

373
00:20:41,309 --> 00:20:48,059
generally<font color="#E5E5E5"> just about with the</font>

374
00:20:43,080 --> 00:20:49,830
system real category so let's go ahead

375
00:20:48,059 --> 00:20:50,970
and<font color="#CCCCCC"> see</font><font color="#E5E5E5"> rootkits in action right</font><font color="#CCCCCC"> I'm</font>

376
00:20:49,830 --> 00:20:51,750
going<font color="#E5E5E5"> to show you a rootkit called</font>

377
00:20:50,970 --> 00:20:54,270
diamorphine

378
00:20:51,750 --> 00:20:58,200
<font color="#E5E5E5">is anybody familiar with diet</font><font color="#CCCCCC"> what</font>

379
00:20:54,270 --> 00:21:03,418
diamorphine<font color="#E5E5E5"> actually like is not not the</font>

380
00:20:58,200 --> 00:21:06,120
<font color="#CCCCCC">program but like the word</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> who knows</font>

381
00:21:03,419 --> 00:21:16,860
heroin and how do<font color="#E5E5E5"> I get to</font><font color="#CCCCCC"> know you</font>

382
00:21:06,120 --> 00:21:28,049
oh my god get to<font color="#E5E5E5"> meet Jimmy the out</font>

383
00:21:16,860 --> 00:21:30,500
of<font color="#CCCCCC"> Emax I swear to god I'm gonna</font><font color="#E5E5E5"> you</font>

384
00:21:28,049 --> 00:21:33,629
know what new terminal

385
00:21:30,500 --> 00:21:38,309
okay so we have Kenny Loggins running

386
00:21:33,630 --> 00:21:45,000
right<font color="#E5E5E5"> so if we do</font><font color="#CCCCCC"> PSA UX grab</font><font color="#E5E5E5"> kini we</font>

387
00:21:38,309 --> 00:21:47,250
see yes<font color="#E5E5E5"> so we see a number of processes</font>

388
00:21:45,000 --> 00:21:49,890
<font color="#E5E5E5">related to kini</font><font color="#CCCCCC"> Loggins I think I were</font>

389
00:21:47,250 --> 00:21:51,990
in it with with with sudo which means

390
00:21:49,890 --> 00:21:53,789
that you'll see two<font color="#E5E5E5"> processes one of</font>

391
00:21:51,990 --> 00:21:56,970
them<font color="#CCCCCC"> pseudo and one of the not pseudo is</font>

392
00:21:53,789 --> 00:21:59,070
that correct now<font color="#CCCCCC"> no I'm</font><font color="#E5E5E5"> actually legit</font>

393
00:21:56,970 --> 00:22:03,120
<font color="#E5E5E5">just running to Keaney logins processes</font>

394
00:21:59,070 --> 00:22:06,500
which by the way is why that message was

395
00:22:03,120 --> 00:22:12,590
all up<font color="#E5E5E5"> because it was double</font>

396
00:22:06,500 --> 00:22:12,590
<font color="#E5E5E5">doubling up on the key logging yeah</font>

397
00:22:13,340 --> 00:22:23,299
that's right<font color="#E5E5E5"> my software works</font><font color="#CCCCCC"> it's just</font>

398
00:22:16,590 --> 00:22:23,299
the implementation<font color="#CCCCCC"> details are not</font><font color="#E5E5E5"> great</font>

399
00:22:25,700 --> 00:22:32,039
anybody<font color="#E5E5E5"> still good already already</font>

400
00:22:28,590 --> 00:22:40,439
<font color="#E5E5E5">fallen</font><font color="#CCCCCC"> off good ok cool just</font><font color="#E5E5E5"> interesting</font>

401
00:22:32,039 --> 00:22:43,529
<font color="#E5E5E5">anybody I could just stop okay actually</font>

402
00:22:40,440 --> 00:22:46,039
<font color="#CCCCCC">I might do that</font><font color="#E5E5E5"> yeah you know what I'm</font>

403
00:22:43,529 --> 00:22:46,039
not<font color="#E5E5E5"> gonna do that</font>

404
00:22:48,670 --> 00:22:59,570
yeah yeah<font color="#CCCCCC"> no I appreciate the</font><font color="#E5E5E5"> hand</font><font color="#CCCCCC"> to</font>

405
00:22:53,570 --> 00:23:05,929
keeps me working<font color="#E5E5E5"> okay so let's see what</font>

406
00:22:59,570 --> 00:23:09,830
we can<font color="#E5E5E5"> do with a rootkit nope that's not</font>

407
00:23:05,930 --> 00:23:12,500
<font color="#CCCCCC">what I wanted what I say I was gonna</font>

408
00:23:09,830 --> 00:23:14,689
<font color="#E5E5E5">show you diamorphine</font><font color="#CCCCCC"> slash heroin</font><font color="#E5E5E5"> which</font>

409
00:23:12,500 --> 00:23:20,540
<font color="#E5E5E5">was it was</font><font color="#CCCCCC"> it the new</font><font color="#E5E5E5"> heroin</font><font color="#CCCCCC"> yeah you</font>

410
00:23:14,690 --> 00:23:23,870
<font color="#CCCCCC">knew heroin</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so in</font><font color="#CCCCCC"> order to</font>

411
00:23:20,540 --> 00:23:25,610
actually<font color="#E5E5E5"> use this kernel module we have</font>

412
00:23:23,870 --> 00:23:29,899
to use in a command called<font color="#E5E5E5"> the in smog</font>

413
00:23:25,610 --> 00:23:33,379
which is just insert module and we're

414
00:23:29,900 --> 00:23:38,050
gonna do diamorphine<font color="#CCCCCC"> dot</font><font color="#E5E5E5"> Ko Ko stands</font>

415
00:23:33,380 --> 00:23:44,270
for kernel something anybody know

416
00:23:38,050 --> 00:23:46,610
anybody<font color="#E5E5E5"> what's that kernel operations</font><font color="#CCCCCC"> I</font>

417
00:23:44,270 --> 00:23:49,190
don't know I actually don't know<font color="#E5E5E5"> I was</font>

418
00:23:46,610 --> 00:23:51,500
<font color="#E5E5E5">what I was literally asking if anybody</font>

419
00:23:49,190 --> 00:24:01,430
<font color="#E5E5E5">knew because I have no clue</font>

420
00:23:51,500 --> 00:24:04,700
I apologize<font color="#E5E5E5"> just for myself</font><font color="#CCCCCC"> so</font>

421
00:24:01,430 --> 00:24:07,220
diamorphine has been<font color="#E5E5E5"> loaded right</font><font color="#CCCCCC"> if I</font>

422
00:24:04,700 --> 00:24:09,890
do LS mod which is just listing all of

423
00:24:07,220 --> 00:24:13,340
<font color="#CCCCCC">the modules</font><font color="#E5E5E5"> and I do a grep for</font>

424
00:24:09,890 --> 00:24:14,630
diamorphine<font color="#E5E5E5"> and it shows absolutely</font>

425
00:24:13,340 --> 00:24:17,060
nothing<font color="#CCCCCC"> right</font>

426
00:24:14,630 --> 00:24:19,780
so the rootkit has actually already

427
00:24:17,060 --> 00:24:22,639
hidden itself just by the just by the

428
00:24:19,780 --> 00:24:25,040
operation of loading itself<font color="#E5E5E5"> it hides</font>

429
00:24:22,640 --> 00:24:28,730
itself automatically<font color="#CCCCCC"> and we're gonna</font>

430
00:24:25,040 --> 00:24:30,740
actually go to the readme for this<font color="#E5E5E5"> which</font>

431
00:24:28,730 --> 00:24:32,150
I know it's super<font color="#CCCCCC"> exciting in a</font>

432
00:24:30,740 --> 00:24:35,960
<font color="#E5E5E5">presentation that's what you want to see</font>

433
00:24:32,150 --> 00:24:38,060
his read<font color="#CCCCCC"> meas</font><font color="#E5E5E5"> but in this case it's</font>

434
00:24:35,960 --> 00:24:39,440
actually<font color="#E5E5E5"> pretty cool</font><font color="#CCCCCC"> there's a couple</font>

435
00:24:38,060 --> 00:24:40,820
things we<font color="#CCCCCC"> can do with</font><font color="#E5E5E5"> that that I wanted</font>

436
00:24:39,440 --> 00:24:43,340
<font color="#E5E5E5">to show you so files or directories</font>

437
00:24:40,820 --> 00:24:45,290
starting with the magic prefix become

438
00:24:43,340 --> 00:24:46,970
invisible<font color="#E5E5E5"> that's one thing that I'm</font>

439
00:24:45,290 --> 00:24:49,399
going<font color="#E5E5E5"> to show you the other thing is</font>

440
00:24:46,970 --> 00:24:52,250
<font color="#CCCCCC">that we can hide and unhide any process</font>

441
00:24:49,400 --> 00:24:58,430
by sending<font color="#CCCCCC"> it signal 31 so how do we</font>

442
00:24:52,250 --> 00:25:00,470
<font color="#E5E5E5">send it signal 31 right so we do</font><font color="#CCCCCC"> PS aux</font>

443
00:24:58,430 --> 00:25:02,659
<font color="#CCCCCC">crap Keaney logins</font>

444
00:25:00,470 --> 00:25:04,100
and what we're gonna do here is we're

445
00:25:02,659 --> 00:25:04,789
<font color="#E5E5E5">gonna hide the</font><font color="#CCCCCC"> keaney log in</font><font color="#E5E5E5"> this</font>

446
00:25:04,100 --> 00:25:12,740
process

447
00:25:04,789 --> 00:25:18,340
so that's<font color="#CCCCCC"> 22 816 so kill</font><font color="#E5E5E5"> - 31 oh</font>

448
00:25:12,740 --> 00:25:25,659
you<font color="#CCCCCC"> guys can't see that so</font><font color="#E5E5E5"> kill - 31 and</font>

449
00:25:18,340 --> 00:25:32,209
we're gonna do<font color="#E5E5E5"> what really what was it</font>

450
00:25:25,659 --> 00:25:34,190
<font color="#CCCCCC">22</font><font color="#E5E5E5"> 8 16 yeah 22 8 16 so we're not</font>

451
00:25:32,210 --> 00:25:38,030
actually<font color="#CCCCCC"> killing this process so all</font>

452
00:25:34,190 --> 00:25:40,490
<font color="#E5E5E5">that kill does is it sends a signal</font>

453
00:25:38,030 --> 00:25:42,500
handler to it right so a lot of<font color="#E5E5E5"> you</font>

454
00:25:40,490 --> 00:25:47,059
might<font color="#E5E5E5"> be familiar with kill</font><font color="#CCCCCC"> - 9 which</font>

455
00:25:42,500 --> 00:25:50,000
<font color="#CCCCCC">means kill right now or</font><font color="#E5E5E5"> just the</font>

456
00:25:47,059 --> 00:25:52,879
regular kill command<font color="#CCCCCC"> which I</font><font color="#E5E5E5"> think makes</font>

457
00:25:50,000 --> 00:25:56,230
<font color="#E5E5E5">it exit with an exit code of 1</font><font color="#CCCCCC"> in this</font>

458
00:25:52,880 --> 00:26:00,770
<font color="#CCCCCC">case we're just sending</font><font color="#E5E5E5"> it a code</font><font color="#CCCCCC"> of 31</font>

459
00:25:56,230 --> 00:26:08,240
so let's see if 22<font color="#E5E5E5"> 816 exists after we</font>

460
00:26:00,770 --> 00:26:13,100
have sent it that signal<font color="#CCCCCC"> alright so one</font>

461
00:26:08,240 --> 00:26:15,140
of our key<font color="#CCCCCC"> Neos</font><font color="#E5E5E5"> Jesus</font><font color="#CCCCCC"> I'm sorry so</font>

462
00:26:13,100 --> 00:26:20,320
one of our<font color="#CCCCCC"> key me logins processes has</font>

463
00:26:15,140 --> 00:26:22,970
been killed where's my mouse<font color="#CCCCCC"> okay</font>

464
00:26:20,320 --> 00:26:24,500
one of our key me logins processes has

465
00:26:22,970 --> 00:26:27,110
been killed but<font color="#E5E5E5"> we want to hide all</font><font color="#CCCCCC"> of</font>

466
00:26:24,500 --> 00:26:33,919
them right<font color="#E5E5E5"> so let's go</font><font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and hide</font>

467
00:26:27,110 --> 00:26:38,240
the other<font color="#CCCCCC"> one alright</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> we go</font>

468
00:26:33,919 --> 00:26:41,600
<font color="#CCCCCC">let's see if BAM there we go so there's</font>

469
00:26:38,240 --> 00:26:43,820
<font color="#E5E5E5">nothing in there that says</font><font color="#CCCCCC"> Keeney logins</font>

470
00:26:41,600 --> 00:26:46,428
anymore<font color="#E5E5E5"> right so anybody looking for</font>

471
00:26:43,820 --> 00:26:48,620
<font color="#E5E5E5">Kenny Loggins with the PS</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> UX or</font>

472
00:26:46,429 --> 00:26:50,780
actually with anything this is<font color="#CCCCCC"> going</font>

473
00:26:48,620 --> 00:26:53,719
down all the<font color="#CCCCCC"> way to the</font><font color="#E5E5E5"> base the</font><font color="#CCCCCC"> core of</font>

474
00:26:50,780 --> 00:26:55,668
<font color="#CCCCCC">the operating system</font><font color="#E5E5E5"> so anything trying</font>

475
00:26:53,720 --> 00:26:57,020
to look for Kenny Loggins can no longer

476
00:26:55,669 --> 00:26:59,750
see it

477
00:26:57,020 --> 00:27:03,830
there's rootkit detectors out there I

478
00:26:59,750 --> 00:27:06,200
haven't<font color="#CCCCCC"> found them to actually work I've</font>

479
00:27:03,830 --> 00:27:09,799
you know I've actually<font color="#E5E5E5"> like made a</font>

480
00:27:06,200 --> 00:27:11,630
rootkit<font color="#E5E5E5"> with the name rootkit</font><font color="#CCCCCC"> run the</font>

481
00:27:09,799 --> 00:27:12,950
rootkit detector and<font color="#E5E5E5"> it just doesn't</font>

482
00:27:11,630 --> 00:27:14,739
<font color="#E5E5E5">find it and it's the most obvious</font>

483
00:27:12,950 --> 00:27:18,729
rootkit

484
00:27:14,739 --> 00:27:20,710
so they<font color="#E5E5E5"> don't work that well</font><font color="#CCCCCC"> and the</font>

485
00:27:18,729 --> 00:27:24,309
second thing<font color="#CCCCCC"> about it is one</font><font color="#E5E5E5"> of them is</font>

486
00:27:20,710 --> 00:27:26,440
like called<font color="#CCCCCC"> RK hunter rootkit hunter the</font>

487
00:27:24,309 --> 00:27:28,090
other thing is<font color="#CCCCCC"> that once</font><font color="#E5E5E5"> somebody calls</font>

488
00:27:26,440 --> 00:27:30,639
RK hunter

489
00:27:28,090 --> 00:27:33,279
if you already have root access<font color="#CCCCCC"> beak or</font>

490
00:27:30,639 --> 00:27:36,820
before all of<font color="#CCCCCC"> that you can just</font><font color="#E5E5E5"> replace</font>

491
00:27:33,279 --> 00:27:38,999
RK<font color="#CCCCCC"> hunter with something else right</font><font color="#E5E5E5"> so</font>

492
00:27:36,820 --> 00:27:41,139
you can<font color="#CCCCCC"> just say like are okay</font><font color="#E5E5E5"> hunter</font>

493
00:27:38,999 --> 00:27:43,469
<font color="#E5E5E5">processing and then have a little</font>

494
00:27:41,139 --> 00:27:46,389
progress<font color="#CCCCCC"> bar that</font><font color="#E5E5E5"> doesn't do jack</font>

495
00:27:43,469 --> 00:27:48,399
<font color="#CCCCCC">and then you're</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then you say</font>

496
00:27:46,389 --> 00:27:54,330
hey your system totally clean you're

497
00:27:48,399 --> 00:27:54,330
good<font color="#E5E5E5"> I love you and that kind</font><font color="#CCCCCC"> of thing</font>

498
00:27:58,019 --> 00:28:12,879
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so back</font><font color="#CCCCCC"> to the presentation for</font>

499
00:28:03,219 --> 00:28:14,499
just a minute<font color="#CCCCCC"> I have one slide</font><font color="#E5E5E5"> left no</font>

500
00:28:12,879 --> 00:28:16,478
actually I have no slides<font color="#E5E5E5"> left this is</font>

501
00:28:14,499 --> 00:28:20,219
great<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so the last</font><font color="#E5E5E5"> thing that I</font>

502
00:28:16,479 --> 00:28:21,609
wanted to show you<font color="#E5E5E5"> was a rootkit that I</font>

503
00:28:20,219 --> 00:28:25,869
wrote

504
00:28:21,609 --> 00:28:28,478
that's called<font color="#CCCCCC"> its</font><font color="#E5E5E5"> house is also called</font>

505
00:28:25,869 --> 00:28:32,168
<font color="#CCCCCC">Keeney logins</font><font color="#E5E5E5"> which is really</font><font color="#CCCCCC"> confusing</font>

506
00:28:28,479 --> 00:28:35,859
but they're all meant to<font color="#CCCCCC"> be called part</font>

507
00:28:32,169 --> 00:28:39,599
of<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the same ecosystem</font><font color="#CCCCCC"> give me</font>

508
00:28:35,859 --> 00:28:39,599
<font color="#E5E5E5">just one second I thought I had this</font>

509
00:28:53,969 --> 00:28:57,210
<font color="#CCCCCC">alright guys</font>

510
00:29:05,220 --> 00:29:16,420
well<font color="#E5E5E5"> apparently I'm not connected to the</font>

511
00:29:07,630 --> 00:29:24,490
<font color="#CCCCCC">internet so that is</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> anyway just</font>

512
00:29:16,420 --> 00:29:26,260
<font color="#E5E5E5">drag this virtual machine</font><font color="#CCCCCC"> on over feel</font>

513
00:29:24,490 --> 00:29:31,950
<font color="#E5E5E5">free to talk amongst yourselves while I</font>

514
00:29:26,260 --> 00:29:31,950
do this where the<font color="#E5E5E5"> is my mouse again</font>

515
00:29:48,360 --> 00:29:53,290
there we<font color="#E5E5E5"> go and the last thing that</font><font color="#CCCCCC"> I</font>

516
00:29:51,700 --> 00:30:14,950
wanted to show you was on this<font color="#E5E5E5"> other</font>

517
00:29:53,290 --> 00:30:18,399
<font color="#CCCCCC">machine oh my god this is so awkward all</font>

518
00:30:14,950 --> 00:30:21,070
right so we<font color="#CCCCCC"> have Keaney logins and what</font>

519
00:30:18,400 --> 00:30:24,670
I really wanted to show you in this

520
00:30:21,070 --> 00:30:40,419
particular<font color="#E5E5E5"> rootkit is one thing is just</font>

521
00:30:24,670 --> 00:30:42,100
<font color="#E5E5E5">how simple it is right so really again</font>

522
00:30:40,420 --> 00:30:45,190
<font color="#E5E5E5">like I said</font><font color="#CCCCCC"> we forget how</font><font color="#E5E5E5"> to use</font>

523
00:30:42,100 --> 00:30:48,189
computers<font color="#CCCCCC"> so one thing is just</font><font color="#E5E5E5"> exactly</font>

524
00:30:45,190 --> 00:30:50,890
how simple it is<font color="#E5E5E5"> but the other thing I</font>

525
00:30:48,190 --> 00:30:53,140
wanted to show is a couple of really

526
00:30:50,890 --> 00:30:55,420
important things<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so what we're</font>

527
00:30:53,140 --> 00:30:57,880
doing<font color="#E5E5E5"> is we're</font><font color="#CCCCCC"> really all we're doing is</font>

528
00:30:55,420 --> 00:31:00,310
we're reading a file right so this<font color="#E5E5E5"> slash</font>

529
00:30:57,880 --> 00:31:03,150
<font color="#E5E5E5">boot slash system</font><font color="#CCCCCC"> map if I can copy this</font>

530
00:31:00,310 --> 00:31:03,149
really quick

531
00:31:18,900 --> 00:31:24,640
so what<font color="#E5E5E5"> that</font><font color="#CCCCCC"> boot /system app that we're</font>

532
00:31:22,120 --> 00:31:26,439
<font color="#E5E5E5">reading within</font><font color="#CCCCCC"> that file is is that's</font>

533
00:31:24,640 --> 00:31:28,390
<font color="#E5E5E5">where we're actually finding the syscall</font>

534
00:31:26,440 --> 00:31:31,000
table right so<font color="#E5E5E5"> what like I mentioned</font>

535
00:31:28,390 --> 00:31:33,400
<font color="#CCCCCC">that's where we find the address of it</font>

536
00:31:31,000 --> 00:31:36,280
so you can<font color="#CCCCCC"> see the address</font><font color="#E5E5E5"> right here</font>

537
00:31:33,400 --> 00:31:40,450
<font color="#E5E5E5">it's F F F F F F F F F eight one eight</font>

538
00:31:36,280 --> 00:31:44,530
<font color="#E5E5E5">zero one four zero zero I think I nailed</font>

539
00:31:40,450 --> 00:31:48,700
that<font color="#CCCCCC"> by the way or pail is probably</font><font color="#E5E5E5"> like</font>

540
00:31:44,530 --> 00:31:50,350
<font color="#CCCCCC">19 too many FS but what I wanted</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> show</font>

541
00:31:48,700 --> 00:31:55,270
you<font color="#E5E5E5"> is this is where we actually get</font>

542
00:31:50,350 --> 00:31:59,080
<font color="#CCCCCC">that address</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so KS ka SLR is</font><font color="#E5E5E5"> on a</font>

543
00:31:55,270 --> 00:32:02,650
SLR<font color="#E5E5E5"> is on all kind of address space</font>

544
00:31:59,080 --> 00:32:05,620
<font color="#E5E5E5">layout randomization of all kinds is on</font>

545
00:32:02,650 --> 00:32:09,690
but every<font color="#E5E5E5"> time we read it from</font><font color="#CCCCCC"> here</font>

546
00:32:05,620 --> 00:32:15,070
right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> it really doesn't matter</font><font color="#CCCCCC"> that</font>

547
00:32:09,690 --> 00:32:27,850
KS @<font color="#E5E5E5"> ka SLR is on at all</font><font color="#CCCCCC"> and the</font><font color="#E5E5E5"> other</font>

548
00:32:15,070 --> 00:32:34,919
thing I wanted to show<font color="#E5E5E5"> you was what</font>

549
00:32:27,850 --> 00:32:34,919
we're actually doing<font color="#E5E5E5"> to the system calls</font>

550
00:32:36,000 --> 00:32:46,180
was<font color="#CCCCCC"> that up there with the right</font><font color="#E5E5E5"> oh yeah</font>

551
00:32:42,580 --> 00:32:48,909
<font color="#CCCCCC">so this new mkdir</font><font color="#E5E5E5"> right so this is what</font>

552
00:32:46,180 --> 00:32:53,530
we're actually pointing that<font color="#E5E5E5"> writes or</font>

553
00:32:48,910 --> 00:32:57,000
I'm<font color="#E5E5E5"> sorry that mkdir system call</font><font color="#CCCCCC"> too so</font>

554
00:32:53,530 --> 00:33:00,160
if you<font color="#E5E5E5"> can just take a short look at it</font>

555
00:32:57,000 --> 00:33:01,780
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> worry about all this stuff</font><font color="#CCCCCC"> all I'm</font>

556
00:33:00,160 --> 00:33:03,160
<font color="#E5E5E5">doing is basically this function does</font>

557
00:33:01,780 --> 00:33:04,899
<font color="#E5E5E5">absolute</font>

558
00:33:03,160 --> 00:33:07,510
this function does absolutely<font color="#E5E5E5"> nothing</font>

559
00:33:04,900 --> 00:33:13,690
<font color="#CCCCCC">right so when</font><font color="#E5E5E5"> I try</font><font color="#CCCCCC"> to make a directory</font>

560
00:33:07,510 --> 00:33:17,379
<font color="#E5E5E5">it should fail</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is all open</font>

561
00:33:13,690 --> 00:33:18,150
source by the<font color="#E5E5E5"> way you can go online you</font>

562
00:33:17,380 --> 00:33:22,559
<font color="#E5E5E5">can</font>

563
00:33:18,150 --> 00:33:26,190
go on github<font color="#CCCCCC"> copy this and it</font><font color="#E5E5E5"> actually</font>

564
00:33:22,559 --> 00:33:28,289
<font color="#E5E5E5">shows you how to use how to make other</font>

565
00:33:26,190 --> 00:33:30,870
system calls how to hijack<font color="#E5E5E5"> other system</font>

566
00:33:28,289 --> 00:33:32,158
calls as well<font color="#CCCCCC"> and like I said</font><font color="#E5E5E5"> it's</font>

567
00:33:30,870 --> 00:33:35,850
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> not that many lines of code</font>

568
00:33:32,159 --> 00:33:40,549
it's maybe a hundred which<font color="#E5E5E5"> 4c is like</font>

569
00:33:35,850 --> 00:33:44,490
 amazing<font color="#CCCCCC"> so what are</font><font color="#E5E5E5"> we gonna do</font>

570
00:33:40,549 --> 00:34:03,090
we are going<font color="#E5E5E5"> to enable this particular</font>

571
00:33:44,490 --> 00:34:07,080
rootkit<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> oh that does</font><font color="#E5E5E5"> that work that</font>

572
00:34:03,090 --> 00:34:10,460
worked<font color="#E5E5E5"> okay so we're gonna LS here and</font>

573
00:34:07,080 --> 00:34:10,460
let's go ahead and try to<font color="#CCCCCC"> make</font><font color="#E5E5E5"> something</font>

574
00:34:15,530 --> 00:34:18,980
nothing happened right

575
00:34:20,449 --> 00:34:26,609
again<font color="#E5E5E5"> nothing happens</font><font color="#CCCCCC"> so we've</font>

576
00:34:23,460 --> 00:34:29,000
effectively<font color="#CCCCCC"> hooked the mkdir system call</font>

577
00:34:26,609 --> 00:34:31,230
to make it do absolutely nothing

578
00:34:29,000 --> 00:34:33,480
<font color="#E5E5E5">obviously this can be much more</font>

579
00:34:31,230 --> 00:34:35,280
malicious<font color="#E5E5E5"> than that we</font><font color="#CCCCCC"> are in kernel</font>

580
00:34:33,480 --> 00:34:37,500
space which<font color="#E5E5E5"> means we have full control</font>

581
00:34:35,280 --> 00:34:41,669
<font color="#E5E5E5">of the core of the operating system we</font>

582
00:34:37,500 --> 00:34:44,969
can do connect backs<font color="#E5E5E5"> we can do key</font>

583
00:34:41,668 --> 00:34:45,480
logging<font color="#E5E5E5"> we can do I don't know sky's the</font>

584
00:34:44,969 --> 00:34:48,629
limit

585
00:34:45,480 --> 00:34:52,050
honestly<font color="#CCCCCC"> so that's pretty much</font><font color="#E5E5E5"> my</font>

586
00:34:48,629 --> 00:34:54,949
<font color="#E5E5E5">presentation</font><font color="#CCCCCC"> hope you guys oh yes yes</font>

587
00:34:52,050 --> 00:34:58,520
ma'am I have a shill in the audience

588
00:34:54,949 --> 00:34:58,520
<font color="#E5E5E5">what's going O</font>

589
00:35:00,060 --> 00:35:05,299
sudo password<font color="#E5E5E5"> no that's</font><font color="#CCCCCC"> okay</font>

590
00:35:08,750 --> 00:35:13,740
<font color="#CCCCCC">that whole thing</font><font color="#E5E5E5"> was basically</font><font color="#CCCCCC"> I'm</font>

591
00:35:11,250 --> 00:35:17,640
keylogging on the other one<font color="#E5E5E5"> I'm showing</font>

592
00:35:13,740 --> 00:35:19,140
<font color="#E5E5E5">that the</font><font color="#CCCCCC"> keylogger was hidden but I</font>

593
00:35:17,640 --> 00:35:23,759
didn't show<font color="#CCCCCC"> you guys that the keylogger</font>

594
00:35:19,140 --> 00:35:25,830
<font color="#E5E5E5">was still working</font><font color="#CCCCCC"> after that so I can do</font>

595
00:35:23,760 --> 00:35:27,720
that<font color="#E5E5E5"> but you know you can also just</font>

596
00:35:25,830 --> 00:35:30,210
trust me<font color="#CCCCCC"> that it's actually working I</font>

597
00:35:27,720 --> 00:35:34,919
look I mean like this face is a<font color="#E5E5E5"> very</font>

598
00:35:30,210 --> 00:35:39,920
trustworthy face<font color="#CCCCCC"> so you know so any</font>

599
00:35:34,920 --> 00:35:39,920
questions about things

600
00:35:53,870 --> 00:36:01,589
yeah so yes and<font color="#E5E5E5"> yes</font><font color="#CCCCCC"> I believe that</font>

601
00:35:58,980 --> 00:36:04,890
that's<font color="#E5E5E5"> how a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> kind of rootkit</font>

602
00:36:01,590 --> 00:36:07,560
hunter stuff works is by checking<font color="#E5E5E5"> the</font>

603
00:36:04,890 --> 00:36:09,830
integrity<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this syscall table</font><font color="#CCCCCC"> I'm not</font>

604
00:36:07,560 --> 00:36:13,049
sure why it wouldn't detect my rootkit

605
00:36:09,830 --> 00:36:15,660
<font color="#CCCCCC">but but yes definitely that's probably</font>

606
00:36:13,050 --> 00:36:19,410
one of the one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the leading ways to</font>

607
00:36:15,660 --> 00:36:21,960
check<font color="#E5E5E5"> to not to check</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> uh yeah to</font>

608
00:36:19,410 --> 00:36:25,859
check to detect a rootkit<font color="#CCCCCC"> and your</font>

609
00:36:21,960 --> 00:36:28,310
second<font color="#CCCCCC"> question I think actually</font><font color="#E5E5E5"> also</font>

610
00:36:25,860 --> 00:36:30,930
plays<font color="#E5E5E5"> into the first question and that</font>

611
00:36:28,310 --> 00:36:34,980
there's a ton<font color="#E5E5E5"> of legitimate processes</font>

612
00:36:30,930 --> 00:36:36,569
that do rootkit like like stuff<font color="#CCCCCC"> where</font>

613
00:36:34,980 --> 00:36:39,300
they're hooking this is the<font color="#E5E5E5"> syscall</font>

614
00:36:36,570 --> 00:36:42,090
table and doing other<font color="#E5E5E5"> things like hiding</font>

615
00:36:39,300 --> 00:36:44,610
themselves<font color="#CCCCCC"> especially in Windows you</font>

616
00:36:42,090 --> 00:36:46,830
know<font color="#CCCCCC"> you see like all</font><font color="#E5E5E5"> that that</font>

617
00:36:44,610 --> 00:36:48,480
<font color="#E5E5E5">comes pre-installed</font>

618
00:36:46,830 --> 00:36:50,759
there's also<font color="#E5E5E5"> root kits that come</font>

619
00:36:48,480 --> 00:36:54,810
pre-installed sometimes that's<font color="#E5E5E5"> not rare</font>

620
00:36:50,760 --> 00:36:59,370
it's been<font color="#E5E5E5"> found in the</font><font color="#CCCCCC"> wild so if you</font>

621
00:36:54,810 --> 00:37:02,130
like basically ban<font color="#E5E5E5"> everything</font><font color="#CCCCCC"> that does</font>

622
00:36:59,370 --> 00:37:03,420
<font color="#E5E5E5">anything</font><font color="#CCCCCC"> that looks rootkit like you're</font>

623
00:37:02,130 --> 00:37:06,600
going<font color="#E5E5E5"> to kind of over your own</font>

624
00:37:03,420 --> 00:37:08,910
system right<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's what</font><font color="#E5E5E5"> makes it</font>

625
00:37:06,600 --> 00:37:12,350
<font color="#E5E5E5">hard</font><font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> so yeah it's a great</font>

626
00:37:08,910 --> 00:37:12,350
<font color="#E5E5E5">question</font><font color="#CCCCCC"> huh</font><font color="#E5E5E5"> yes sir</font>

627
00:37:26,830 --> 00:37:32,630
that's a great<font color="#E5E5E5"> question so the question</font>

628
00:37:28,910 --> 00:37:37,220
<font color="#CCCCCC">was if I know about</font><font color="#E5E5E5"> any Linux</font><font color="#CCCCCC"> rootkits</font>

629
00:37:32,630 --> 00:37:40,790
<font color="#CCCCCC">or rootkits in general that have kind of</font>

630
00:37:37,220 --> 00:37:45,379
famously done something evil<font color="#CCCCCC"> if</font><font color="#E5E5E5"> I'm not</font>

631
00:37:40,790 --> 00:37:49,070
<font color="#CCCCCC">mistaken asus rootkit there was an asus</font>

632
00:37:45,380 --> 00:37:52,400
rootkit<font color="#E5E5E5"> on asus laptops like I mentioned</font>

633
00:37:49,070 --> 00:37:54,350
what they're like spyware<font color="#CCCCCC"> that was</font>

634
00:37:52,400 --> 00:37:57,950
actually sending<font color="#E5E5E5"> data back</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> Asus</font>

635
00:37:54,350 --> 00:38:01,640
without the user knowing which is<font color="#CCCCCC"> bad</font>

636
00:37:57,950 --> 00:38:03,890
so<font color="#E5E5E5"> that was technically that was</font>

637
00:38:01,640 --> 00:38:05,450
definitely a<font color="#E5E5E5"> root I mean I can't say</font>

638
00:38:03,890 --> 00:38:06,609
<font color="#CCCCCC">even technically a rootkit that was</font>

639
00:38:05,450 --> 00:38:09,020
definitely a rootkit

640
00:38:06,610 --> 00:38:11,450
<font color="#CCCCCC">and that it's trying to</font><font color="#E5E5E5"> hide from the</font>

641
00:38:09,020 --> 00:38:13,310
user<font color="#CCCCCC"> in terms of</font><font color="#E5E5E5"> something like super</font>

642
00:38:11,450 --> 00:38:15,169
<font color="#E5E5E5">malicious I don't know of any famous</font>

643
00:38:13,310 --> 00:38:19,730
cases<font color="#CCCCCC"> unfortunately I wish I could give</font>

644
00:38:15,170 --> 00:38:32,110
<font color="#CCCCCC">you a</font><font color="#E5E5E5"> better one but go</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> have other</font>

645
00:38:19,730 --> 00:38:35,690
<font color="#CCCCCC">questions oh</font><font color="#E5E5E5"> yeah so the</font><font color="#CCCCCC"> question is</font>

646
00:38:32,110 --> 00:38:37,700
wouldn't<font color="#E5E5E5"> it be a be easy to make the</font>

647
00:38:35,690 --> 00:38:40,700
<font color="#E5E5E5">syscall table look</font><font color="#CCCCCC"> like the original</font>

648
00:38:37,700 --> 00:38:42,350
syscall table<font color="#E5E5E5"> so that it didn't look</font>

649
00:38:40,700 --> 00:38:43,580
<font color="#CCCCCC">like a rootkit and that's a really</font><font color="#E5E5E5"> good</font>

650
00:38:42,350 --> 00:38:46,700
question

651
00:38:43,580 --> 00:38:49,790
the problem is that you do need to<font color="#E5E5E5"> edit</font>

652
00:38:46,700 --> 00:39:08,509
the syscall table<font color="#CCCCCC"> to</font><font color="#E5E5E5"> point to a new</font>

653
00:38:49,790 --> 00:39:10,460
address<font color="#CCCCCC"> right oh yeah yes you're</font>

654
00:39:08,510 --> 00:39:14,330
absolutely<font color="#E5E5E5"> right and most rootkits will</font>

655
00:39:10,460 --> 00:39:16,460
actually do<font color="#E5E5E5"> that they will bill edit the</font>

656
00:39:14,330 --> 00:39:19,040
<font color="#CCCCCC">Cisco table</font><font color="#E5E5E5"> but then eventually</font><font color="#CCCCCC"> they'll</font>

657
00:39:16,460 --> 00:39:23,240
call the actual thing so like that right

658
00:39:19,040 --> 00:39:25,250
<font color="#E5E5E5">Cisco or like let's say the mkdir</font><font color="#CCCCCC"> Cisco</font>

659
00:39:23,240 --> 00:39:30,290
that<font color="#CCCCCC"> I showed I kind of and</font>

660
00:39:25,250 --> 00:39:32,599
didn't work<font color="#CCCCCC"> by the way there it is mkdir</font>

661
00:39:30,290 --> 00:39:37,460
<font color="#E5E5E5">be hooked my can't</font><font color="#CCCCCC"> me I'm Canyon</font>

662
00:39:32,599 --> 00:39:39,680
<font color="#CCCCCC">ok nothing so what I could have that do</font>

663
00:39:37,460 --> 00:39:41,330
is instead of<font color="#CCCCCC"> a instead of doing</font>

664
00:39:39,680 --> 00:39:44,419
<font color="#E5E5E5">absolutely nothing I could actually have</font>

665
00:39:41,330 --> 00:39:45,830
<font color="#CCCCCC">it call the real mkdir sis call</font><font color="#E5E5E5"> and then</font>

666
00:39:44,420 --> 00:39:48,410
the users none the wiser is that

667
00:39:45,830 --> 00:39:51,680
something is<font color="#CCCCCC"> going on</font><font color="#E5E5E5"> so yes that does</font>

668
00:39:48,410 --> 00:39:53,029
<font color="#CCCCCC">happen all the time</font><font color="#E5E5E5"> so good question is</font>

669
00:39:51,680 --> 00:39:56,960
<font color="#E5E5E5">that does that answer your question sort</font>

670
00:39:53,030 --> 00:40:01,520
of yes<font color="#E5E5E5"> sort of</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> sorry it's</font><font color="#CCCCCC"> we'll</font>

671
00:39:56,960 --> 00:40:04,400
talk<font color="#E5E5E5"> about it</font><font color="#CCCCCC"> oh yeah we have a free</font>

672
00:40:01,520 --> 00:40:11,650
shirts<font color="#CCCCCC"> it's this same shirt</font><font color="#E5E5E5"> right here</font>

673
00:40:04,400 --> 00:40:15,659
<font color="#E5E5E5">we got coasters and that's it I'm out</font>

674
00:40:11,650 --> 00:40:15,659
[Applause]

