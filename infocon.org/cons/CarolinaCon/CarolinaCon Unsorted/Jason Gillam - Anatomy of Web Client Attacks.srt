1
00:00:00,339 --> 00:00:04,400
cross-site request forgery that's a long
lines were tied K

2
00:00:04,400 --> 00:00:08,850
re: had an introduction I want to point
out a couple of other things on the sly

3
00:00:08,850 --> 00:00:10,490
specifically at the very bottom

4
00:00:10,490 --> 00:00:15,460
I'll I'm a runner I'm actually training
for my first half marathon

5
00:00:15,460 --> 00:00:18,980
the picture on here its me doing my
first Tough Mudder

6
00:00:18,980 --> 00:00:22,720
any top honors in and/or got a couple

7
00:00:22,720 --> 00:00:26,710
fine my brother is 10 years younger than
me actually

8
00:00:26,710 --> 00:00:30,480
roped into this he's does alter
Americans I don't know what I was

9
00:00:30,480 --> 00:00:30,960
thinking

10
00:00:30,960 --> 00:00:34,300
thanks again all was

11
00:00:34,300 --> 00:00:37,519
was cool actually signed up again for
this year

12
00:00:37,519 --> 00:00:41,460
also homer any homers in the room

13
00:00:41,460 --> 00:00:46,859
better be brings okay I'm

14
00:00:46,859 --> 00:00:51,239
so why are you here what's this

15
00:00:51,239 --> 00:00:54,949
talk about so maybe you've heard about
the terms cross-site scripting cross a

16
00:00:54,949 --> 00:00:56,219
request for your not

17
00:00:56,219 --> 00:00:59,440
tireless sure we're all me maybe some
the other ones like course

18
00:00:59,440 --> 00:01:02,969
be here course you really know what that
means on

19
00:01:02,969 --> 00:01:06,600
so I'm going to actually go through
walkthrough with some these terms mean

20
00:01:06,600 --> 00:01:07,010
some

21
00:01:07,010 --> 00:01:10,180
and and hopefully give you a better idea

22
00:01:10,180 --> 00:01:15,370
white when you can do it and

23
00:01:15,370 --> 00:01:20,180
in which ways taking be used or or which
was a limited on

24
00:01:20,180 --> 00:01:25,070
maybe you need some help explaining some
these terms to

25
00:01:25,070 --> 00:01:28,190
you're not so technical business
partners I'll

26
00:01:28,190 --> 00:01:30,560
or maybe you're just looking for
inspiration on different ways you can

27
00:01:30,560 --> 00:01:31,320
use these things

28
00:01:31,320 --> 00:01:35,340
so on or maybe you're just

29
00:01:35,340 --> 00:01:41,280
getting antsy first burgers tacos were
in such a small

30
00:01:41,280 --> 00:01:41,680
okay

31
00:01:41,680 --> 00:01:44,790
anyway when every reason is okay

32
00:01:44,790 --> 00:01:49,400
I'm gonna focus on three of the Aus up
to so if you're getting into web

33
00:01:49,400 --> 00:01:51,520
application and testing or if you do

34
00:01:51,520 --> 00:01:54,540
web development and you haven't actually

35
00:01:54,540 --> 00:01:58,790
on looked at a loss that something you
really need to do

36
00:01:58,790 --> 00:02:02,420
que lost on our website it's not just
the Los

37
00:02:02,420 --> 00:02:06,970
top and that's on there as a whole bunch
of other stuff lotsa

38
00:02:06,970 --> 00:02:10,670
cheat sheets and tools all it's free

39
00:02:10,670 --> 00:02:13,940
I'm totally worth taking some time to
look at it

40
00:02:13,940 --> 00:02:18,820
haven't done that alright so

41
00:02:18,820 --> 00:02:21,790
let's get into the first time in talk
across a scripting first this is gonna

42
00:02:21,790 --> 00:02:22,880
take the most time

43
00:02:22,880 --> 00:02:26,060
on and its

44
00:02:26,060 --> 00:02:30,360
because this is probably the most
important one so

45
00:02:30,360 --> 00:02:33,390
been around for a really long time but
it's pervasive

46
00:02:33,390 --> 00:02:38,250
its still all over the place and in some
ways it's actually may be getting worse

47
00:02:38,250 --> 00:02:42,330
I'm is a cornerstone of a lot of
phishing attacks

48
00:02:42,330 --> 00:02:47,070
so once we get away from the on you know
someone just lately trying to convince

49
00:02:47,070 --> 00:02:48,510
you to enter your credentials

50
00:02:48,510 --> 00:02:51,640
time across a scripting that's the ok
and I

51
00:02:51,640 --> 00:02:55,030
get you somewhere where I can
potentially steal your credentials rate

52
00:02:55,030 --> 00:02:55,350
outta

53
00:02:55,350 --> 00:02:58,350
how to perform or on

54
00:02:58,350 --> 00:03:04,070
or its your session or something like
that there's some mechanisms built an

55
00:03:04,070 --> 00:03:08,070
to the whole age me to the web browsers

56
00:03:08,070 --> 00:03:13,850
that will help prevent some arms across
a script but none of them have ever

57
00:03:13,850 --> 00:03:17,280
proven to be a hundred percent effective
hell circle back on that

58
00:03:17,280 --> 00:03:21,380
on but yes just like anything else right
there's nothing that's ever

59
00:03:21,380 --> 00:03:25,579
100 percent secures so

60
00:03:25,579 --> 00:03:28,900
on some examples out there now what I
did at the beginning of this year

61
00:03:28,900 --> 00:03:32,810
I wanted to get a a better be on what
sort so

62
00:03:32,810 --> 00:03:36,290
cross-site scripting is out there and
how bad is the problem so I set up a

63
00:03:36,290 --> 00:03:37,160
Google Alert

64
00:03:37,160 --> 00:03:39,049
and Google thing

65
00:03:39,049 --> 00:03:42,319
I'm Google Alert say daily

66
00:03:42,319 --> 00:03:45,909
I get out basically a digestive all the
newly reported

67
00:03:45,909 --> 00:03:50,450
articles out there that mention
cross-site scripting and I actually get

68
00:03:50,450 --> 00:03:53,870
out I was hoping that it would be some
huge number

69
00:03:53,870 --> 00:03:57,110
I can really wow you with but it's
actually not that bad it's more like

70
00:03:57,110 --> 00:04:00,319
from an average five or six today but
it's still quite a bit

71
00:04:00,319 --> 00:04:03,519
and they'll stack up on so here's some

72
00:04:03,519 --> 00:04:06,879
that are from just I just picked a few
randomly

73
00:04:06,879 --> 00:04:10,040
on that I recognize better

74
00:04:10,040 --> 00:04:14,090
just this month these are things and
just come at this month so I am TV had a

75
00:04:14,090 --> 00:04:15,690
crisis gripping on going on

76
00:04:15,690 --> 00:04:19,410
that's something we've probably all seen
anybody not heard a by Andy

77
00:04:19,410 --> 00:04:23,930
on Word Press so there's a word press

78
00:04:23,930 --> 00:04:27,479
plugin where Press everyone says a word
press is not secure

79
00:04:27,479 --> 00:04:32,610
here's an example its it's the were
pressed plugins that are really insecure

80
00:04:32,610 --> 00:04:36,030
have a lot of problems in fact there's a
whole tool dedicated to scanning

81
00:04:36,030 --> 00:04:38,220
WordPress plugins looking for
vulnerabilities

82
00:04:38,220 --> 00:04:42,100
WP scan stuff here not incorporating
that and we have a

83
00:04:42,100 --> 00:04:46,599
and tests and this may be something to
look at

84
00:04:46,599 --> 00:04:50,590
so anyway on this particular one

85
00:04:50,590 --> 00:04:53,720
I took a look at the World Press website
there's actually

86
00:04:53,720 --> 00:04:56,800
over a million active installs up this

87
00:04:56,800 --> 00:05:01,030
again it has a crisis gripping lot built
into it so all those with WordPress

88
00:05:01,030 --> 00:05:02,060
sites that have this

89
00:05:02,060 --> 00:05:05,370
I'm are potentially vulnerable process
gripping

90
00:05:05,370 --> 00:05:09,490
and buns oh I know it's an oldie but a
goodie PC software that

91
00:05:09,490 --> 00:05:13,070
for by on track so that's a

92
00:05:13,070 --> 00:05:17,370
another one its very recent if you're
not into Jess

93
00:05:17,370 --> 00:05:22,630
random miller nichols looking for this
sort of thing we can also look at CDs

94
00:05:22,630 --> 00:05:26,260
and how to print on these are really
small so on this on

95
00:05:26,260 --> 00:05:29,340
just highlight a couple in these here
and again these are all

96
00:05:29,340 --> 00:05:33,050
really recent so we have I DM Rational
Quality Manager

97
00:05:33,050 --> 00:05:36,720
care probably not gonna run across this
on the internet but

98
00:05:36,720 --> 00:05:40,389
and core inside a corporate environment
this is a fairly popular 21 were talking

99
00:05:40,389 --> 00:05:40,770
about

100
00:05:40,770 --> 00:05:44,560
clients who can actually afford IBM
products to would be normal

101
00:05:44,560 --> 00:05:48,960
this one up next on their makes our
SharePoint as I sound like a big deal

102
00:05:48,960 --> 00:05:53,610
anybody know any SharePoint good place
to find a crisis gripping

103
00:05:53,610 --> 00:05:58,290
alright and the last one on here I kinda
cheated this one doesn't really belong

104
00:05:58,290 --> 00:05:59,340
on this list but

105
00:05:59,340 --> 00:06:02,570
it is is mentioning process for being so

106
00:06:02,570 --> 00:06:07,050
Internet Explorer it's actually Nani
cross site scripting

107
00:06:07,050 --> 00:06:10,950
clients a flying one other protections
for crisis getting in on get

108
00:06:10,950 --> 00:06:14,229
i'll circle back on this explain a bit
more detail

109
00:06:14,229 --> 00:06:17,700
so

110
00:06:17,700 --> 00:06:21,300
what is prostate scripting all heard the
term

111
00:06:21,300 --> 00:06:24,770
a lot of us have this idea in her head
and what it is I'm

112
00:06:24,770 --> 00:06:28,330
wikipedia says no mystery this year
cross-site scripting

113
00:06:28,330 --> 00:06:31,760
is a type of computer security
vulnerability typically found in web

114
00:06:31,760 --> 00:06:32,710
applications

115
00:06:32,710 --> 00:06:35,729
XSS enables attackers to inject

116
00:06:35,729 --> 00:06:38,880
client-side scripts into web pages
viewed by other users

117
00:06:38,880 --> 00:06:42,100
this is correct I mean it's it's an
accurate description

118
00:06:42,100 --> 00:06:45,880
but when we hear the words cross-site
scripting is that really what we're

119
00:06:45,880 --> 00:06:46,380
thinking

120
00:06:46,380 --> 00:06:49,720
are we thinking that maybe there's a
script on one side

121
00:06:49,720 --> 00:06:53,610
that somehow talking to content on
another site somewhere

122
00:06:53,610 --> 00:06:56,970
I'm that s to me when I first heard
process

123
00:06:56,970 --> 00:07:01,550
and that's what I was thinking so the
term itself is a bit of a misnomer

124
00:07:01,550 --> 00:07:05,440
and it doesn't actually require scripts
to be on two different sites in fact

125
00:07:05,440 --> 00:07:06,630
there's a whole

126
00:07:06,630 --> 00:07:09,850
on flavor cross-site scripting store

127
00:07:09,850 --> 00:07:10,800
or

128
00:07:10,800 --> 00:07:14,519
persistent probably heard that one at
some point that

129
00:07:14,519 --> 00:07:17,610
is all on one side you injected on that
site and

130
00:07:17,610 --> 00:07:21,099
you the victims are going to that same
site so there's no second site at all

131
00:07:21,099 --> 00:07:21,749
involved

132
00:07:21,749 --> 00:07:26,259
so I prefer to think of it as browser
script injection that's really what

133
00:07:26,259 --> 00:07:27,119
we're talking about

134
00:07:27,119 --> 00:07:32,249
so when we talk in a browser script
injection

135
00:07:32,249 --> 00:07:36,139
what typeof script are we talking about

136
00:07:36,139 --> 00:07:40,599
gonna be JavaScript usually right
normally JavaScript were talking about

137
00:07:40,599 --> 00:07:41,239
that stay

138
00:07:41,239 --> 00:07:44,869
the universe a scripting language on the
web that's what

139
00:07:44,869 --> 00:07:49,069
on you know every browser out there that
you're going to counter these days they

140
00:07:49,069 --> 00:07:50,009
all support

141
00:07:50,009 --> 00:07:53,050
JavaScript but don't forget about
VBScript

142
00:07:53,050 --> 00:07:56,389
especially if you're doing tests in a
corporate environment work and explores

143
00:07:56,389 --> 00:07:57,039
a standard

144
00:07:57,039 --> 00:08:00,869
on in those cases you

145
00:08:00,869 --> 00:08:04,269
it is possible right into to situations
where

146
00:08:04,269 --> 00:08:08,919
your JavaScript payload may not work but
VBScript payload will

147
00:08:08,919 --> 00:08:12,789
so there are some differences a special
characters there they want to pay

148
00:08:12,789 --> 00:08:17,899
attention to him so

149
00:08:17,899 --> 00:08:22,119
browser scripting injection how do we
get that to work

150
00:08:22,119 --> 00:08:25,899
requires two things

151
00:08:25,899 --> 00:08:29,300
to be in place for brothers for
injection cross-site scripting

152
00:08:29,300 --> 00:08:33,000
to actually work the first is you have
to get your injection

153
00:08:33,000 --> 00:08:36,799
into the right context and what I mean
by that is

154
00:08:36,800 --> 00:08:40,219
caspian execute a book tax does no good
to

155
00:08:40,219 --> 00:08:43,479
to have on you know due to

156
00:08:43,479 --> 00:08:47,889
encoding or whatever to have a script X
injected they don't actually

157
00:08:47,889 --> 00:08:51,899
execute this it still considers the the
page to consider that to be

158
00:08:51,899 --> 00:08:55,230
data so we have to get your injection to
be considered something

159
00:08:55,230 --> 00:08:59,680
actually execute second thing is you
have to have execution and this becomes

160
00:08:59,680 --> 00:09:02,110
really important especially when you're
looking at

161
00:09:02,110 --> 00:09:05,680
and on-base cross a scripting attacks
out over the differences

162
00:09:05,680 --> 00:09:09,660
a bit later I'm sodom based on

163
00:09:09,660 --> 00:09:15,510
it actually you run into situations
often where you be able to maybe get

164
00:09:15,510 --> 00:09:19,480
on your here injection into some piece
of code

165
00:09:19,480 --> 00:09:23,589
by it's cold never actually gets call on
a page or it's been called before gets

166
00:09:23,589 --> 00:09:24,180
injected

167
00:09:24,180 --> 00:09:27,529
not after cell on that ends up being

168
00:09:27,529 --> 00:09:30,459
something that you have to resolve a
small but once you have those two things

169
00:09:30,459 --> 00:09:33,230
in place you can have a successful
injection so

170
00:09:33,230 --> 00:09:36,380
for those who haven't seen cross a
scripting before

171
00:09:36,380 --> 00:09:40,540
less take let's back up a boat in this
is the simplest example out there

172
00:09:40,540 --> 00:09:43,610
okay how does injection work this is
just

173
00:09:43,610 --> 00:09:48,480
I'm not I'm on injecting in bad at this
point I'm just saying

174
00:09:48,480 --> 00:09:51,760
okay we have and in play right name

175
00:09:51,760 --> 00:09:57,560
able Bob okay and the response I comes
back inside the nation on Don

176
00:09:57,560 --> 00:10:01,089
includes the same thing that we put in
him of

177
00:10:01,089 --> 00:10:05,670
so in essence all we're doing crosses
fingers were taking

178
00:10:05,670 --> 00:10:09,010
Bob were saying okay well let's add some

179
00:10:09,010 --> 00:10:12,320
something that breaks us out-of-date a
contest

180
00:10:12,320 --> 00:10:15,420
as for the script and us and put this
into

181
00:10:15,420 --> 00:10:19,350
a context for the browser says hey I at
something I can actually run now have

182
00:10:19,350 --> 00:10:20,029
some code

183
00:10:20,029 --> 00:10:23,550
and this case here's the simplest
example we have which is alert 1

184
00:10:23,550 --> 00:10:27,949
so what happens when this page writers
course we have a pop-up box once in a

185
00:10:27,949 --> 00:10:29,079
pop-up box before

186
00:10:29,079 --> 00:10:33,220
we get in trouble for putting these on
report sometimes because managers

187
00:10:33,220 --> 00:10:36,670
like I don't know I don't see anything
wrong with pop-up box how's that hacking

188
00:10:36,670 --> 00:10:41,269
so get will get back to some better
ideas there

189
00:10:41,269 --> 00:10:45,370
said a pop-up boxes

190
00:10:45,370 --> 00:10:46,520
but before we do that

191
00:10:46,520 --> 00:10:50,860
let's just take a look take a second
take a step back I'm not gonna read this

192
00:10:50,860 --> 00:10:51,570
whole slide

193
00:10:51,570 --> 00:10:56,850
take a look and JavaScript so this is a
brief history of JavaScript wacho

194
00:10:56,850 --> 00:10:57,890
notices

195
00:10:57,890 --> 00:11:02,770
JavaScript has been around since May
1995

196
00:11:02,770 --> 00:11:07,240
okay its twenty years all this is

197
00:11:07,240 --> 00:11:11,310
ancient technology why do we have such a
pervasive problem

198
00:11:11,310 --> 00:11:17,050
and twenty-year-old technology but it's
there there are probably some people in

199
00:11:17,050 --> 00:11:17,950
this room

200
00:11:17,950 --> 00:11:22,740
who are younger than JavaScript as

201
00:11:22,740 --> 00:11:25,940
cases around that long the other piece
of information I want to bring attention

202
00:11:25,940 --> 00:11:26,660
to

203
00:11:26,660 --> 00:11:29,950
is the a the

204
00:11:29,950 --> 00:11:34,110
the last one on there so 2005 so this in
new html5

205
00:11:34,110 --> 00:11:39,620
thing called a jackass is really not
that the term was coined in 2005

206
00:11:39,620 --> 00:11:43,120
so that's ten-years-old and believe it
or not you can actually do all that

207
00:11:43,120 --> 00:11:43,550
stuff

208
00:11:43,550 --> 00:11:46,850
long before the terms even quite it

209
00:11:46,850 --> 00:11:50,840
the whole when promoting capability that
was around before 2005

210
00:11:50,840 --> 00:11:54,580
so this is not news on so

211
00:11:54,580 --> 00:11:58,770
this kinda leads into we have this and
on-base cross-site scripting

212
00:11:58,770 --> 00:12:02,960
its actually not that new we only just
starting to discover it there but it's

213
00:12:02,960 --> 00:12:03,750
been around for

214
00:12:03,750 --> 00:12:09,910
really really long time so

215
00:12:09,910 --> 00:12:14,710
back to the pop-up box we don't like
pop-up boxes by themselves we need some

216
00:12:14,710 --> 00:12:15,660
better ideas

217
00:12:15,660 --> 00:12:18,810
so what are some other things we can do
with JavaScript because if we can do a

218
00:12:18,810 --> 00:12:21,690
pop-up box we could probably do just
about anything else

219
00:12:21,690 --> 00:12:26,310
me doing jobs so let's just look at a
couple the things you can

220
00:12:26,310 --> 00:12:30,420
read from and write to the Document
Object Model docking object model that's

221
00:12:30,420 --> 00:12:31,370
basically

222
00:12:31,370 --> 00:12:35,880
the HTML it comes back and the request
it's interpreted into a tree like

223
00:12:35,880 --> 00:12:37,249
model

224
00:12:37,249 --> 00:12:42,879
all the elements and that's we can
manipulate that with JavaScript on

225
00:12:42,879 --> 00:12:47,309
you can read cookies and headers okay so
this is how

226
00:12:47,309 --> 00:12:51,519
we do on this is how we still sessions

227
00:12:51,519 --> 00:12:54,529
when we don't have met in the middle
usually done through

228
00:12:54,529 --> 00:12:58,160
through JavaScript on

229
00:12:58,160 --> 00:13:02,359
we can detect keystrokes and mouse
clicks so

230
00:13:02,359 --> 00:13:08,419
we can do a rudimentary keylogger in
javascript i stream media now

231
00:13:08,419 --> 00:13:12,199
I keep wondering if this is

232
00:13:12,199 --> 00:13:15,359
I mean it doesn't really seem like a big
deal you can turn on the webcam by I

233
00:13:15,359 --> 00:13:17,749
keep thinking that this might actually
make some really

234
00:13:17,749 --> 00:13:22,429
compelling examples Anne especially if
you're doing a test in a corporate

235
00:13:22,429 --> 00:13:23,109
environment

236
00:13:23,109 --> 00:13:26,350
is I mean if you get a snapshot at the
CP

237
00:13:26,350 --> 00:13:29,600
if the CEO of a company that's that's
going to be a

238
00:13:29,600 --> 00:13:34,019
pretty compelling I think but I was also
thinking about

239
00:13:34,019 --> 00:13:37,079
the other type media might have access
to

240
00:13:37,079 --> 00:13:40,649
I'm there's I mean for one there's a
microphone

241
00:13:40,649 --> 00:13:44,499
so you could eavesdrop and I don't know
for sure that

242
00:13:44,499 --> 00:13:49,529
accessing the microphone will actually
turn on that little light right so

243
00:13:49,529 --> 00:13:53,509
there's a possibility there doesn't turn
on the light you can eavesdrop on

244
00:13:53,509 --> 00:13:54,189
somebody and

245
00:13:54,189 --> 00:13:59,410
have no idea it no indication on and I
was also thinking that it would be kinda

246
00:13:59,410 --> 00:14:03,100
fine at some point haven't done this but
it might be fun to actually make you sit

247
00:14:03,100 --> 00:14:03,929
the speakers

248
00:14:03,929 --> 00:14:08,090
so when bombs computer starts talking to
him in a search going

249
00:14:08,090 --> 00:14:11,620
us we have some

250
00:14:11,620 --> 00:14:15,540
some evidence there I thought I would be
kinda fun I'm in this range shots you

251
00:14:15,540 --> 00:14:16,110
can do

252
00:14:16,110 --> 00:14:19,670
on fetch more stuff three jack so on
this allows you to do

253
00:14:19,670 --> 00:14:23,420
have staged attacks maybe you can only
put in a small payload initially

254
00:14:23,420 --> 00:14:26,740
you can use that bring in on larger
payload to do more

255
00:14:26,740 --> 00:14:30,130
on this whole tools dedicated to this
whole circle back on that as well

256
00:14:30,130 --> 00:14:33,620
on open when socket there's a hole in a
second if you really wanna know all the

257
00:14:33,620 --> 00:14:36,050
things you can do a javascript you
really need to learn JavaScript

258
00:14:36,050 --> 00:14:41,460
so

259
00:14:41,460 --> 00:14:45,130
alright a

260
00:14:45,130 --> 00:14:48,330
so with all this stuff that we can do
weekend

261
00:14:48,330 --> 00:14:53,430
we can make requests oh the things we
can turn on webcams on this stuff you

262
00:14:53,430 --> 00:14:54,680
have to wonder why

263
00:14:54,680 --> 00:14:57,690
every like a whole internet was a
compromise just through cross a

264
00:14:57,690 --> 00:14:58,830
scripting attacks along

265
00:14:58,830 --> 00:15:02,810
any answer the main answer for this

266
00:15:02,810 --> 00:15:07,460
is something called same origin policy
probably all heard the term I'm going to

267
00:15:07,460 --> 00:15:08,800
explain it for those EU

268
00:15:08,800 --> 00:15:12,440
who use the term not really sure what it
means on

269
00:15:12,440 --> 00:15:15,990
so for some all this talk about an
orange

270
00:15:15,990 --> 00:15:20,200
this is important understand because
this is when you're trying to do you

271
00:15:20,200 --> 00:15:21,640
cross a scripting attacks

272
00:15:21,640 --> 00:15:24,660
and for some reason it's not working the
way are expecting

273
00:15:24,660 --> 00:15:27,670
your quest is not getting through or the
information is not coming back

274
00:15:27,670 --> 00:15:31,000
this is something you need to really
consider take a close look at her and

275
00:15:31,000 --> 00:15:31,410
her

276
00:15:31,410 --> 00:15:34,440
remind yourself okay so the

277
00:15:34,440 --> 00:15:38,529
the origin is made up of three pieces
have your protocol

278
00:15:38,529 --> 00:15:42,390
or scheme army have your post annual
report

279
00:15:42,390 --> 00:15:47,070
okay in any one of those is different
that is considered a different word

280
00:15:47,070 --> 00:15:50,459
not the same word on and this is

281
00:15:50,459 --> 00:15:55,370
k to remember especially I mean you have
cases we have the same content served

282
00:15:55,370 --> 00:15:57,550
over HTTP and HTTPS

283
00:15:57,550 --> 00:16:00,829
K street from ports and 2 protocols on
its

284
00:16:00,829 --> 00:16:04,209
those are considered completely severed
stars the problems

285
00:16:04,209 --> 00:16:09,209
can the policy itself so it's enforced
on the browser

286
00:16:09,209 --> 00:16:12,450
and according to this policy

287
00:16:12,450 --> 00:16:16,430
code running in one origin is not
allowed to access

288
00:16:16,430 --> 00:16:21,190
be Document Object Model

289
00:16:21,190 --> 00:16:24,269
on okay so can actually

290
00:16:24,269 --> 00:16:27,709
access the data can't I manipulated in
any way

291
00:16:27,709 --> 00:16:31,339
I'm so it's is this nicely and stand

292
00:16:31,339 --> 00:16:34,430
capability within the

293
00:16:34,430 --> 00:16:37,770
within the browser to make sure that he

294
00:16:37,770 --> 00:16:41,670
he had you're accessing content on
different origins you have

295
00:16:41,670 --> 00:16:45,250
your code running and one it's not able
actually get to another one so this is

296
00:16:45,250 --> 00:16:45,649
why

297
00:16:45,649 --> 00:16:48,950
you can't have a cross-site scripting
attack

298
00:16:48,950 --> 00:16:54,110
on one or gin goes out and fetches a
cookie of another one what's preventing

299
00:16:54,110 --> 00:16:54,870
that from happening

300
00:16:54,870 --> 00:16:58,450
which is

301
00:16:58,450 --> 00:17:02,170
pretty awesome for security feature and
it really helps a good things

302
00:17:02,170 --> 00:17:06,189
except Sep in cases like this

303
00:17:06,189 --> 00:17:09,760
so know this is probably very small

304
00:17:09,760 --> 00:17:14,199
I'm missus that same CV

305
00:17:14,199 --> 00:17:18,559
I i popped up earlier so it's i think is
2015 0072

306
00:17:18,559 --> 00:17:19,640
me

307
00:17:19,640 --> 00:17:24,970
i'm looking up later on so and I want to
spend a little bit I'm talking about

308
00:17:24,970 --> 00:17:27,160
this we have Internet Explorer

309
00:17:27,160 --> 00:17:31,660
nine through 11 if it's on Patch because
the past just came out last week

310
00:17:31,660 --> 00:17:35,810
this was announced at the end in January
so there's a whole month and a half that

311
00:17:35,810 --> 00:17:38,810
went by where there's no patch available
and what this does

312
00:17:38,810 --> 00:17:42,100
this farm bill this is a vulnerability
just

313
00:17:42,100 --> 00:17:45,700
any on you can

314
00:17:45,700 --> 00:17:49,760
you can basically works on JavaScript
magic to get around the same origin

315
00:17:49,760 --> 00:17:50,540
policy

316
00:17:50,540 --> 00:17:53,950
so that you can inject cross-eyed

317
00:17:53,950 --> 00:17:57,190
use process scripting I'm

318
00:17:57,190 --> 00:18:01,490
across multiple origins and just
thinking or completely ignore same

319
00:18:01,490 --> 00:18:02,260
margin policy

320
00:18:02,260 --> 00:18:06,090
re so when you're doing your pen test
and I don't know

321
00:18:06,090 --> 00:18:09,560
any exploits out there yet for this but
it wouldn't be so

322
00:18:09,560 --> 00:18:13,210
will be at all surprised someone started
developing some when you're doing a

323
00:18:13,210 --> 00:18:14,010
penthouse

324
00:18:14,010 --> 00:18:17,120
and you find browsers that are unpatched

325
00:18:17,120 --> 00:18:20,900
against this you're probably going to be
able to

326
00:18:20,900 --> 00:18:23,770
you probably gonna be golden for for
being able to do things like black

327
00:18:23,770 --> 00:18:24,710
session cookies

328
00:18:24,710 --> 00:18:27,900
on the cookies are not set correctly
which usually are

329
00:18:27,900 --> 00:18:32,580
in camp to cell on

330
00:18:32,580 --> 00:18:35,760
was definitely something to look at
their so there are some

331
00:18:35,760 --> 00:18:39,420
some exceptions the same margin calls
because we can't have everything box of

332
00:18:39,420 --> 00:18:40,740
like that the internet just

333
00:18:40,740 --> 00:18:45,020
wouldn't work the way people wanted I'm
so there's a few things first serve all

334
00:18:45,020 --> 00:18:50,510
there's the script eg mean SE obvious on
so if the way the script aim works you

335
00:18:50,510 --> 00:18:52,250
can grab scripts from other places

336
00:18:52,250 --> 00:18:56,450
that's are the way the internet works
for everyone has jQuery libraries and

337
00:18:56,450 --> 00:18:57,270
other places

338
00:18:57,270 --> 00:19:00,500
and a load them onto their page in and
are able to actually run so there is

339
00:19:00,500 --> 00:19:00,770
some

340
00:19:00,770 --> 00:19:03,860
interaction out between scripts but
scripts are

341
00:19:03,860 --> 00:19:07,390
day on the way that you can interact
with data

342
00:19:07,390 --> 00:19:11,410
wanna one of the main ways that's come
out as a html5

343
00:19:11,410 --> 00:19:14,640
is the course policies across

344
00:19:14,640 --> 00:19:17,880
origin resource sharing and this is

345
00:19:17,880 --> 00:19:22,440
this is basically the magic that makes
each team of five as we know it today

346
00:19:22,440 --> 00:19:26,190
actually work so instead of just
bringing content from different places

347
00:19:26,190 --> 00:19:27,830
and putting them into into different

348
00:19:27,830 --> 00:19:32,190
iframes your developers can now take
content from different places

349
00:19:32,190 --> 00:19:36,870
and easily actually have that content in
Iraq so they can take data from one

350
00:19:36,870 --> 00:19:41,379
area and data from another area and do
some arithmetic between them for the

351
00:19:41,379 --> 00:19:42,090
resultant

352
00:19:42,090 --> 00:19:46,330
on page all that actually works so

353
00:19:46,330 --> 00:19:49,340
on the the way

354
00:19:49,340 --> 00:19:52,759
that it set up is its a.m. it's a policy

355
00:19:52,759 --> 00:19:57,169
for it so basically it's for removing
same origin policy restrictions on a

356
00:19:57,169 --> 00:19:58,429
case by case basis

357
00:19:58,429 --> 00:20:01,519
so a particular server can say

358
00:20:01,519 --> 00:20:05,139
okay in general we have same origin
policy but I want to

359
00:20:05,139 --> 00:20:09,259
allow connections from a specific origin
or maybe I won't allow them

360
00:20:09,259 --> 00:20:11,879
from all because I have some kind of
public service out there and I don't

361
00:20:11,879 --> 00:20:12,889
care who s

362
00:20:12,889 --> 00:20:16,200
I'm that's the the global policy

363
00:20:16,200 --> 00:20:21,440
which I'll fairly and the interesting
thing okay so I did some experimentation

364
00:20:21,440 --> 00:20:25,399
same origin policy in the fall last year
and

365
00:20:25,399 --> 00:20:28,700
I found a couple of things it's okay to
find on the server

366
00:20:28,700 --> 00:20:33,529
but its the enforcement the role in
force mint is only on the browser

367
00:20:33,529 --> 00:20:37,649
on at least that's the way it's written

368
00:20:37,649 --> 00:20:41,559
specs so it it possible and this was the
for

369
00:20:41,559 --> 00:20:45,210
for what I tested on the

370
00:20:45,210 --> 00:20:48,509
which I just tested under cherry pie
mostly

371
00:20:48,509 --> 00:20:52,860
and what I found was although you can
define the policy on the server side the

372
00:20:52,860 --> 00:20:53,279
server

373
00:20:53,279 --> 00:20:56,669
didn't enforce its own policy so what I
mean by that is

374
00:20:56,669 --> 00:21:02,080
if some Ajax actually made a request to
a server that had

375
00:21:02,080 --> 00:21:05,080
the the course policy in place

376
00:21:05,080 --> 00:21:09,629
even if the origin didn't match what are
the origins on their it still respond

377
00:21:09,629 --> 00:21:13,710
it still sends a response back with the
content that was

378
00:21:13,710 --> 00:21:17,279
that was asking for in left it up to the
browser on the other end

379
00:21:17,279 --> 00:21:20,529
to say no way I'm not actually supposed
to receive this

380
00:21:20,529 --> 00:21:21,190
I'm gonna throw

381
00:21:21,190 --> 00:21:24,770
way which is kind of interesting many
really start thinking about are there

382
00:21:24,770 --> 00:21:25,860
other ways that you can

383
00:21:25,860 --> 00:21:30,610
maybe trick the JavaScript into going
into a successful %ah can actually

384
00:21:30,610 --> 00:21:31,210
accessing

385
00:21:31,210 --> 00:21:35,360
contact I'm found one yet so if anyone
doesn't really like to know

386
00:21:35,360 --> 00:21:39,310
so let me illustrate this a little bit
more cuz I know

387
00:21:39,310 --> 00:21:42,350
course is something that's kinda
nebulous people

388
00:21:42,350 --> 00:21:45,760
you spend a lot of time looking at I'm
so

389
00:21:45,760 --> 00:21:49,780
basically we have to serve reserve have
to and we have bar

390
00:21:49,780 --> 00:21:54,410
okay who incited some javascript

391
00:21:54,410 --> 00:21:57,820
says ok aimed at creating it XML HT aids

392
00:21:57,820 --> 00:22:04,430
XML HTTP request object and it's going
to request some content from bar

393
00:22:04,430 --> 00:22:07,520
when it does this in

394
00:22:07,520 --> 00:22:11,200
the browser is going to add me origin
header

395
00:22:11,200 --> 00:22:14,830
just to say hey I'm making a course
request here's my orange

396
00:22:14,830 --> 00:22:18,780
better that's the only indicator that
that is a course requests there's

397
00:22:18,780 --> 00:22:19,770
nothing else

398
00:22:19,770 --> 00:22:23,920
in that request that tells a server that
it's an across origin

399
00:22:23,920 --> 00:22:29,790
request except for that origin header so
when the server sees

400
00:22:29,790 --> 00:22:33,770
an origin header its gonna respond back
with its policy which is

401
00:22:33,770 --> 00:22:37,610
on the bottom left there on so we have
access control

402
00:22:37,610 --> 00:22:41,060
allow origin that's that's the main

403
00:22:41,060 --> 00:22:44,270
our response header that we're going to
see the other ones are optional

404
00:22:44,270 --> 00:22:48,760
but but that's the name on it we're
gonna see so sorry

405
00:22:48,760 --> 00:22:53,400
respond with its normal response like I
said before a relieves the browser to do

406
00:22:53,400 --> 00:22:53,780
the

407
00:22:53,780 --> 00:22:56,800
the actual enforcement of the policy and

408
00:22:56,800 --> 00:23:00,100
and whatever the party headers are on
there's another

409
00:23:00,100 --> 00:23:03,680
the other interesting one on here is the
allow credentials

410
00:23:03,680 --> 00:23:07,820
what you mean by credentials is cookies
we're talking about sessions

411
00:23:07,820 --> 00:23:11,060
thats that's what credentials are are
considered

412
00:23:11,060 --> 00:23:15,140
course policy so if I make a request

413
00:23:15,140 --> 00:23:18,960
I say there is this request is with
credentials then it's going to also send

414
00:23:18,960 --> 00:23:19,790
any cookies

415
00:23:19,790 --> 00:23:20,840
any

416
00:23:20,840 --> 00:23:25,020
currently active valid cookies
associated with are in this case

417
00:23:25,020 --> 00:23:28,600
on that request so it's a ends up being
an authenticator request

418
00:23:28,600 --> 00:23:32,190
there is one exception to this and
missus

419
00:23:32,190 --> 00:23:35,770
an important for us to realize
especially if you've been running scams

420
00:23:35,770 --> 00:23:39,540
and you get that warning hey there's a
global course

421
00:23:39,540 --> 00:23:42,980
all seem weird you know that his star as
the as the

422
00:23:42,980 --> 00:23:47,020
allowed origin I'm the browsers will
actually

423
00:23:47,020 --> 00:23:50,450
nor the credential sending if there's a
global

424
00:23:50,450 --> 00:23:54,260
policy in place so it's really not as
bad as the scanner say

425
00:23:54,260 --> 00:23:57,440
I actually tested this out us

426
00:23:57,440 --> 00:24:01,510
that's the way it works the brother says
away you have a global policy in place

427
00:24:01,510 --> 00:24:07,299
I'm forget the credentials I believe
that she still send somebody always a

428
00:24:07,299 --> 00:24:10,390
resounding on when he gets back so once
it comes time to enforcement

429
00:24:10,390 --> 00:24:15,710
it's gonna it's gonna sell on so really
where everyone a lot during

430
00:24:15,710 --> 00:24:18,830
and tests and I don't know any scanners
that actually do anything like this

431
00:24:18,830 --> 00:24:22,309
right now so this is gonna be some your
manual testing occurred anywhere

432
00:24:22,309 --> 00:24:25,480
and testing is take a close look at

433
00:24:25,480 --> 00:24:30,320
when he lookbook for course policies and
take a close look at which servers

434
00:24:30,320 --> 00:24:35,230
are actually on allowed on according to
the course policy because

435
00:24:35,230 --> 00:24:39,400
it's those holes if you find a
cross-site scripting flaw

436
00:24:39,400 --> 00:24:43,480
any of those holes then you'll be able
to use that plot against that target

437
00:24:43,480 --> 00:24:45,010
server that hosts in court

438
00:24:45,010 --> 00:24:49,380
as if it's as if it's within the same
origins basically

439
00:24:49,380 --> 00:24:52,740
stretching out it's a margin policy to
include additional

440
00:24:52,740 --> 00:24:55,799
Poseidon so keep that in mind

441
00:24:55,799 --> 00:24:59,360
test so three types a cross

442
00:24:59,360 --> 00:25:02,900
three flavors cross-site scripting
there's actually

443
00:25:02,900 --> 00:25:06,490
is really only the first two the third
one is is kinda

444
00:25:06,490 --> 00:25:10,740
a different spin on the first so we have
reflected

445
00:25:10,740 --> 00:25:14,669
which we went over that moderate Bob
came back on the page along with the

446
00:25:14,669 --> 00:25:17,440
with the

447
00:25:17,440 --> 00:25:19,760
the tagged with the alert one box on
their

448
00:25:19,760 --> 00:25:22,770
I'm and then we have stored so

449
00:25:22,770 --> 00:25:25,670
first-order persisted it's called
different things what we're really

450
00:25:25,670 --> 00:25:27,160
talking about here this is the

451
00:25:27,160 --> 00:25:31,200
like I don't on the blog comment right
where you get some script

452
00:25:31,200 --> 00:25:35,420
onto the page somewhere and as Asbury's
people visit that page

453
00:25:35,420 --> 00:25:38,920
you don't have to re inject the script
every time like bob would have to

454
00:25:38,920 --> 00:25:42,290
as reflected on it just

455
00:25:42,290 --> 00:25:45,370
shows up for everybody an excuse for
them then there's Don

456
00:25:45,370 --> 00:25:49,090
case and this is the 1i think a lot of
people have a really hard time wrapping

457
00:25:49,090 --> 00:25:49,940
my head around

458
00:25:49,940 --> 00:25:54,550
how does this work I'm I actually had a
very hard time coming up with anyway

459
00:25:54,550 --> 00:25:55,650
illustrate this

460
00:25:55,650 --> 00:25:58,840
so I'll try to explain it basically

461
00:25:58,840 --> 00:26:02,640
dawn based what it means is the response
that comes back

462
00:26:02,640 --> 00:26:06,930
does not include the payload that you
put in okay so normally in reflected

463
00:26:06,930 --> 00:26:08,540
remember we had bought me

464
00:26:08,540 --> 00:26:13,050
holes script alert one on you put that
initially employed

465
00:26:13,050 --> 00:26:17,790
but then the output that comes back that
script eg isn't there

466
00:26:17,790 --> 00:26:22,520
but it still ends up in the dog and the
reason it ends up and down this because

467
00:26:22,520 --> 00:26:24,290
there's some script running

468
00:26:24,290 --> 00:26:27,450
is my idea there's some

469
00:26:27,450 --> 00:26:31,790
javascript running I'll somewhere down
the line

470
00:26:31,790 --> 00:26:37,570
that actually polls content from various
different places maybe headers

471
00:26:37,570 --> 00:26:41,690
I may be cookies maybe on maybe a URL
parameter

472
00:26:41,690 --> 00:26:45,780
and puts that it actually shows that
into the dark and we're actually seeing

473
00:26:45,780 --> 00:26:49,320
more and more applications do this this
is the way they're built now

474
00:26:49,320 --> 00:26:52,560
aged him off I you take a look at the
res V

475
00:26:52,560 --> 00:26:56,470
initial response back you know we have
those those applications where

476
00:26:56,470 --> 00:27:02,250
basically the page comes back almost
empty there's very little content on it

477
00:27:02,250 --> 00:27:06,450
in a good populated with with all kinds
of over content dynamically

478
00:27:06,450 --> 00:27:10,060
that's how that's working that's weird
on-base process TripAdvisor

479
00:27:10,060 --> 00:27:17,060
can be in those types and applications

480
00:27:21,090 --> 00:27:28,090
yeah

481
00:27:32,600 --> 00:27:39,600
yeah

482
00:27:42,340 --> 00:27:46,140
know you're so looking at the right
thing so when he's when he said saying

483
00:27:46,140 --> 00:27:46,470
is

484
00:27:46,470 --> 00:27:49,670
is is trying to figure out how do you
find this stuff on

485
00:27:49,670 --> 00:27:54,700
where to look an e-verify I fortunately
it's really hard to verify

486
00:27:54,700 --> 00:27:59,780
on any really her it's really hard to
find in there are fine that's that's the

487
00:27:59,780 --> 00:28:02,000
big challenge with I mean like I said
before

488
00:28:02,000 --> 00:28:05,040
it's been around for over 10 years
occasionally do this

489
00:28:05,040 --> 00:28:08,960
but we still don't have really robust
ways to detect it is getting better

490
00:28:08,960 --> 00:28:15,960
their scanners that they're getting
there yeah

491
00:28:37,880 --> 00:28:41,110
right

492
00:28:41,110 --> 00:28:44,980
yeah on I met with you afterwards we can
go over some more

493
00:28:44,980 --> 00:28:48,620
I'm

494
00:28:48,620 --> 00:28:52,300
but yeah basically II finding it is
getting

495
00:28:52,300 --> 00:28:55,920
starting to get a little bit easier
tools are out there that better

496
00:28:55,920 --> 00:28:58,970
that are able to find it

497
00:28:58,970 --> 00:29:02,900
either through static analysis on

498
00:29:02,900 --> 00:29:06,930
or by actually asking JavaScript because
if you look at and most the scanners out

499
00:29:06,930 --> 00:29:07,930
there they do what I

500
00:29:07,930 --> 00:29:12,720
miss basically same for me a try am
quite so they basically do fighting on

501
00:29:12,720 --> 00:29:13,040
your

502
00:29:13,040 --> 00:29:16,660
on your IM points and Andy look at the
response

503
00:29:16,660 --> 00:29:20,160
just a response each you know when it
comes back PC the payload and the

504
00:29:20,160 --> 00:29:22,460
response center says hey Alex like
process scripting

505
00:29:22,460 --> 00:29:26,820
go check it out on by and on-base you're
not gonna find that less is actually

506
00:29:26,820 --> 00:29:28,000
executing JavaScript

507
00:29:28,000 --> 00:29:31,120
cell on now I will

508
00:29:31,120 --> 00:29:34,990
I will say this: if you are

509
00:29:34,990 --> 00:29:38,900
playing around with Don base a lot want
all that's really helpful for that

510
00:29:38,900 --> 00:29:43,160
is Firebug so on that

511
00:29:43,160 --> 00:29:46,920
with Firebug you can actually do
JavaScript debugging which allows you to

512
00:29:46,920 --> 00:29:49,650
set a breakpoint summer in your
javascript and you can start raising

513
00:29:49,650 --> 00:29:50,650
your way through

514
00:29:50,650 --> 00:29:53,910
emmys here it's very manual process but
you can

515
00:29:53,910 --> 00:29:57,440
you can start racing on value through
seeing

516
00:29:57,440 --> 00:30:00,520
kinda see higher payload is getting
somewhere on which

517
00:30:00,520 --> 00:30:04,010
becomes fairly important especially have
those really really heavy

518
00:30:04,010 --> 00:30:09,500
JavaScript lean pages okay

519
00:30:09,500 --> 00:30:13,280
I so are a pop-up boxes

520
00:30:13,280 --> 00:30:17,520
want some other ideas I gave you some
ideas already if you're looking for more

521
00:30:17,520 --> 00:30:20,910
on strongly recommended take a look at p

522
00:30:20,910 --> 00:30:21,880
have not

523
00:30:21,880 --> 00:30:25,200
that this even if you have to go take a
look at it again because

524
00:30:25,200 --> 00:30:29,280
the the browser exploitation framework
is a framework that has all these

525
00:30:29,280 --> 00:30:30,040
modules and

526
00:30:30,040 --> 00:30:33,930
I wake I slot space over here I'm

527
00:30:33,930 --> 00:30:37,530
at

528
00:30:37,530 --> 00:30:41,190
cell there's there's a lot of

529
00:30:41,190 --> 00:30:44,320
a has a lot of models in there to do a
lot and think so

530
00:30:44,320 --> 00:30:48,720
so deftly pull that off take a look at
it I'm has some other really interesting

531
00:30:48,720 --> 00:30:52,730
I capabilities and their during a pen
test there's the

532
00:30:52,730 --> 00:30:56,220
s X SS raise which

533
00:30:56,220 --> 00:30:59,650
is a cross-site scripting scanner

534
00:30:59,650 --> 00:31:02,920
that's written all in javascript so
basically you

535
00:31:02,920 --> 00:31:06,290
compromise I'm a browser

536
00:31:06,290 --> 00:31:09,900
and then you make you so that browser to
do additional scanning for other classic

537
00:31:09,900 --> 00:31:12,770
stripping a scandal

538
00:31:12,770 --> 00:31:16,530
on also it does there's a timeline proxy
capability and there i mean there's some

539
00:31:16,530 --> 00:31:17,590
limitations Acworth

540
00:31:17,590 --> 00:31:22,780
because margin policy but on and allow
you to do some level up

541
00:31:22,780 --> 00:31:28,070
processing your request so you think
about a scenario where

542
00:31:28,070 --> 00:31:31,900
your your victim is inside a firewall

543
00:31:31,900 --> 00:31:35,670
here Manish Manish actually compromises
are able to communicate with their

544
00:31:35,670 --> 00:31:36,300
browser

545
00:31:36,300 --> 00:31:39,320
you can then use that connection to is a

546
00:31:39,320 --> 00:31:42,580
other web sites internally that's pretty
cool

547
00:31:42,580 --> 00:31:46,190
amina install it in fact I recommend you
try not to

548
00:31:46,190 --> 00:31:49,440
run into a situation we have to install
it because it is Ruby

549
00:31:49,440 --> 00:31:52,540
to I'm fame had experienced Friday

550
00:31:52,540 --> 00:31:55,620
install ruby stuff on

551
00:31:55,620 --> 00:31:59,320
I know I of people are perfectly fine I
was always have trouble

552
00:31:59,320 --> 00:32:04,400
never seems to work for me I was looking
for the wrong jamming yes

553
00:32:04,400 --> 00:32:08,290
I'm anyway it is available on Kali and
and Sam rice so you can just pull up

554
00:32:08,290 --> 00:32:11,940
either one of those live environments
and its in just launch rate insider

555
00:32:11,940 --> 00:32:12,260
there

556
00:32:12,260 --> 00:32:15,800
play with alright

557
00:32:15,800 --> 00:32:20,430
up next we have redirection for its so
redirects affords are very normal part

558
00:32:20,430 --> 00:32:21,500
of how the way it works

559
00:32:21,500 --> 00:32:25,430
right we gold we try to go to web page

560
00:32:25,430 --> 00:32:29,220
on a web application it says hey you're
not logged in I'm gonna redirects you to

561
00:32:29,220 --> 00:32:31,750
your login page this is where all your
300 scum and

562
00:32:31,750 --> 00:32:35,380
are you 30 300 301 on

563
00:32:35,380 --> 00:32:39,960
and you and then you also have the

564
00:32:39,960 --> 00:32:43,030
okay mall now that I've logged in bring
me back to where I was trying to get in

565
00:32:43,030 --> 00:32:44,940
first place and then we have another
redirect

566
00:32:44,940 --> 00:32:48,050
on there's also various redirects for
things like oh

567
00:32:48,050 --> 00:32:51,970
going to affiliate site are going to get
content another place or we have mashups

568
00:32:51,970 --> 00:32:54,980
multiple applications that are trying to
look like it's all one application

569
00:32:54,980 --> 00:32:58,150
so we have a lot in that kinda stuff
happening on

570
00:32:58,150 --> 00:33:02,950
redress a very straightforward here's a
a very typical example we find this in a

571
00:33:02,950 --> 00:33:03,470
lot about

572
00:33:03,470 --> 00:33:07,430
locations right where he have your login
page it says hey the URL

573
00:33:07,430 --> 00:33:10,870
you can try to get to want you finish
logging in is this one here

574
00:33:10,870 --> 00:33:15,250
cell wrong login we're gonna look for
account on

575
00:33:15,250 --> 00:33:18,420
now I'm I'm validated is when

576
00:33:18,420 --> 00:33:22,070
the server doesn't actually check to see
wearing their

577
00:33:22,070 --> 00:33:25,530
sending the years or so it's actually
trusting that URL parameter

578
00:33:25,530 --> 00:33:28,660
on from that's coming from the browser
and saying hey

579
00:33:28,660 --> 00:33:32,310
I'm alright you wanna go there after
this from a seventy

580
00:33:32,310 --> 00:33:35,350
on Sun disc going to

581
00:33:35,350 --> 00:33:38,860
I'm evil hacker word on

582
00:33:38,860 --> 00:33:43,360
so what can you do with this I mean if
user clicks on a link so this would be

583
00:33:43,360 --> 00:33:45,910
something that's probably going to be
distributed in a phishing attack click

584
00:33:45,910 --> 00:33:46,540
on a link

585
00:33:46,540 --> 00:33:49,550
a log in and they end up

586
00:33:49,550 --> 00:33:53,940
on this evil hacker .org say and they're
gonna know hey something went wrong and

587
00:33:53,940 --> 00:33:54,870
wrong place right

588
00:33:54,870 --> 00:34:00,770
or will day so this is where I like to
do something call an evil twin login

589
00:34:00,770 --> 00:34:05,170
so how bout bail on me and and and on
the evil hacker site

590
00:34:05,170 --> 00:34:08,790
basic have a replica of their login
screen looks the same

591
00:34:08,790 --> 00:34:12,140
maybe actually put a a message on this
is how you screwed up

592
00:34:12,140 --> 00:34:15,880
fingertip try logging in again on

593
00:34:15,880 --> 00:34:20,020
so what happens is the a log in the
second time could it be just

594
00:34:20,020 --> 00:34:24,080
with okay whenever in people not pay
attention to the you're all second time

595
00:34:24,080 --> 00:34:27,080
around right and any redirect them back
to the same

596
00:34:27,080 --> 00:34:30,110
their racial identity so they don't know
that anything went wrong

597
00:34:30,110 --> 00:34:32,900
but somewhere along the way they
actually typed in their username and

598
00:34:32,900 --> 00:34:34,220
password on your website

599
00:34:34,220 --> 00:34:37,290
so guess who has a username and password
really

600
00:34:37,290 --> 00:34:40,770
really cool place to find this is on
single sign-on

601
00:34:40,770 --> 00:34:44,350
pages going to corporate organization
cuz me

602
00:34:44,350 --> 00:34:47,360
people don't really think about it
single sign-on type it again

603
00:34:47,360 --> 00:34:51,010
are going to happen again in areas
something about so on

604
00:34:51,010 --> 00:34:54,510
that's that's a really great place to to
find this kinda

605
00:34:54,510 --> 00:34:57,710
law combine

606
00:34:57,710 --> 00:35:02,100
combine redirects with cross site
scripting where you get

607
00:35:02,100 --> 00:35:06,089
personal you can make more convincing
fishing maybe

608
00:35:06,090 --> 00:35:09,840
okay I'm but the other thing is as you
can

609
00:35:09,840 --> 00:35:13,840
get your cross a scripting payload you
can make sure that it gets

610
00:35:13,840 --> 00:35:18,580
into actually and I indicated pardon
application because you may be able to

611
00:35:18,580 --> 00:35:22,630
pass your cross site scripting payload
in its part to that URL parameter

612
00:35:22,630 --> 00:35:26,650
so that's that's a place where you want
to look at that too

613
00:35:26,650 --> 00:35:29,850
you're looking for crisis gripping flies
inside the authenticated space in the

614
00:35:29,850 --> 00:35:31,950
application and make use

615
00:35:31,950 --> 00:35:35,480
be open redirect to

616
00:35:35,480 --> 00:35:40,700
it actually getting right place okay

617
00:35:40,700 --> 00:35:44,970
on the last thing I wanna cover is
crossing request forgery

618
00:35:44,970 --> 00:35:49,020
so this is another one that's been
around for a long time on

619
00:35:49,020 --> 00:35:53,070
it's been around as long as browsers
have been able to handle

620
00:35:53,070 --> 00:35:56,500
various different concurrence on
sessions

621
00:35:56,500 --> 00:36:01,020
different website at the same time which
was probably before browser tabs

622
00:36:01,020 --> 00:36:01,590
racially

623
00:36:01,590 --> 00:36:04,920
like to think about it as browser tabs
because I see diseases where you can see

624
00:36:04,920 --> 00:36:05,280
this

625
00:36:05,280 --> 00:36:08,590
so basically as long as urban multiple
browser tabs out there

626
00:36:08,590 --> 00:36:13,050
we've been able to do cross over
cross-border it's a very normal part of

627
00:36:13,050 --> 00:36:14,180
the way when works

628
00:36:14,180 --> 00:36:18,910
we have on web pages all the time that
are doing things like going out and

629
00:36:18,910 --> 00:36:19,920
getting an iframe

630
00:36:19,920 --> 00:36:23,190
and bringing in content from somewhere
else is playing on a page are you

631
00:36:23,190 --> 00:36:25,310
bringing in images from other places

632
00:36:25,310 --> 00:36:29,480
or scripts we have no likes honor
whatever favorite social media is

633
00:36:29,480 --> 00:36:34,610
I'm so that's cross a request now its
hot start talking about 40

634
00:36:34,610 --> 00:36:39,160
how does that work starts with the fact
that we have things called cookies

635
00:36:39,160 --> 00:36:43,730
and cookies are usually these days for
their sessions and they're used to

636
00:36:43,730 --> 00:36:47,290
on basically the gatekeepers the

637
00:36:47,290 --> 00:36:50,980
for accessing your the content you

638
00:36:50,980 --> 00:36:54,440
you've logged in our be able to get to
search for more sense if functionality

639
00:36:54,440 --> 00:36:57,490
on and so

640
00:36:57,490 --> 00:37:01,050
what we do is we're gonna make use the
fact that

641
00:37:01,050 --> 00:37:05,340
that if you have multiple tabs open in
your browser

642
00:37:05,340 --> 00:37:09,100
and requests originates from any of
those tabs goes to one that you

643
00:37:09,100 --> 00:37:13,120
already have an active session on the
Browns are still gonna send cookies to

644
00:37:13,120 --> 00:37:14,040
that one even know

645
00:37:14,040 --> 00:37:17,420
here started on another page its

646
00:37:17,420 --> 00:37:20,840
that's just the way it behaves the other
aspect

647
00:37:20,840 --> 00:37:24,420
across a request forgery is something
called predictability right so we need

648
00:37:24,420 --> 00:37:27,640
to make sure that the parameters are
parameters that your attack

649
00:37:27,640 --> 00:37:31,920
actually on guess so

650
00:37:31,920 --> 00:37:34,800
an example like the

651
00:37:34,800 --> 00:37:38,430
let's see have a stock application: and
her to buy stocks

652
00:37:38,430 --> 00:37:42,170
all you need to know is a stock symbol
and the

653
00:37:42,170 --> 00:37:46,500
number about stocks that are being
purchase okay so it's just two primers

654
00:37:46,500 --> 00:37:50,240
that's all that's required then that
would be a process request forgery

655
00:37:50,240 --> 00:37:54,740
type scenario so it's some piece of
functionality

656
00:37:54,740 --> 00:37:59,020
interesting thing across a request
forgery there's

657
00:37:59,020 --> 00:38:02,560
it doesn't require any scripting I just
said we can use image tags we can use

658
00:38:02,560 --> 00:38:03,210
iframes

659
00:38:03,210 --> 00:38:07,000
for crossing request there's no need to
scripting which means

660
00:38:07,000 --> 00:38:11,250
because there's no code running it's not
subject same origin policy

661
00:38:11,250 --> 00:38:14,950
so this is something that you can do
cross different sites

662
00:38:14,950 --> 00:38:18,000
so what happens if you combine crossing

663
00:38:18,000 --> 00:38:22,730
Press forgery with cross site scripting
becomes extremely useful

664
00:38:22,730 --> 00:38:26,170
if if you have a crisis gripping

665
00:38:26,170 --> 00:38:30,380
law that on the same origin you're
crossing across

666
00:38:30,380 --> 00:38:35,770
forgery far or member Esther I was
talking about course how course

667
00:38:35,770 --> 00:38:37,240
basically extends

668
00:38:37,240 --> 00:38:41,180
your your same way is considered under
same origin policy

669
00:38:41,180 --> 00:38:44,560
on if it's if it falls into

670
00:38:44,560 --> 00:38:47,670
a policy is actual out there then you
can basically

671
00:38:47,670 --> 00:38:51,119
bypass probably the most common
cross-site request forgery

672
00:38:51,119 --> 00:38:56,160
on prevention out there which is the
tokens because you can

673
00:38:56,160 --> 00:39:00,530
you can make a request and because isn't
it's considered same origin

674
00:39:00,530 --> 00:39:04,430
I'm your script can actually access the
response to that request

675
00:39:04,430 --> 00:39:07,579
so you can you can make one request get
the token

676
00:39:07,579 --> 00:39:10,100
make another request with that token

677
00:39:10,100 --> 00:39:13,740
basically bypass whatever protection was
there and

678
00:39:13,740 --> 00:39:17,480
and run whenever the the SS a
functionally one

679
00:39:17,480 --> 00:39:20,960
on

680
00:39:20,960 --> 00:39:25,880
in fact if you look at be and you look
down the

681
00:39:25,880 --> 00:39:29,630
listed it's under the I think it's the
exploits

682
00:39:29,630 --> 00:39:33,150
tab under there and this is just a small
like a

683
00:39:33,150 --> 00:39:37,770
small snapshot of it so going back to be
you find that a large percentage

684
00:39:37,770 --> 00:39:40,940
the beef exports are actually crossing
as perjury

685
00:39:40,940 --> 00:39:45,740
payloads goes to work really well
together

686
00:39:45,740 --> 00:39:50,240
on and there's there's one other
scenario that

687
00:39:50,240 --> 00:39:54,000
that I wanna mention before I wrap up
and that is the

688
00:39:54,000 --> 00:39:57,610
using cross a request forgery along with

689
00:39:57,610 --> 00:40:01,490
and validated redirector open redirect
on

690
00:40:01,490 --> 00:40:05,580
so here's a here's another interesting
idea so this consider this

691
00:40:05,580 --> 00:40:08,660
user clicks on a link because users
click on links

692
00:40:08,660 --> 00:40:11,980
I'm a good the ghetto login page

693
00:40:11,980 --> 00:40:16,030
the login and them what you do is you

694
00:40:16,030 --> 00:40:21,600
redirected to a page where you have
through the redirect redirected to a

695
00:40:21,600 --> 00:40:23,870
page where you had your process request
forgery

696
00:40:23,870 --> 00:40:28,180
I'm aus station ready to go they

697
00:40:28,180 --> 00:40:32,840
basically activate across a request
forgery and then they get redirected

698
00:40:32,840 --> 00:40:35,890
immediately back to on

699
00:40:35,890 --> 00:40:39,420
the site that they were trying to log
into so from the user's perspective

700
00:40:39,420 --> 00:40:44,420
all they did was log in they're nothing
special happened I'll second login page

701
00:40:44,420 --> 00:40:45,140
showed up

702
00:40:45,140 --> 00:40:48,890
their browser seem to Flickr to use
different site but then it came back to

703
00:40:48,890 --> 00:40:50,870
where they were supposed to go to anyway
so

704
00:40:50,870 --> 00:40:54,270
you know that doesn't seem like a big
deal on and

705
00:40:54,270 --> 00:40:58,060
you were able actually activate crossing
as forgery answer to me

706
00:40:58,060 --> 00:41:01,540
disguised yes so that's something that's

707
00:41:01,540 --> 00:41:05,590
I'm that's worth considering as well
define those two together

708
00:41:05,590 --> 00:41:09,530
no scripting required this something you
can do with their credit crisis gripping

709
00:41:09,530 --> 00:41:13,130
your javascript

710
00:41:13,130 --> 00:41:17,070
so in summary this is all things we went
over

711
00:41:17,070 --> 00:41:21,619
little chichi here we have cross a
scripting are invalidated redirects

712
00:41:21,619 --> 00:41:25,730
CSR a we talked about the same origin
policy talk to

713
00:41:25,730 --> 00:41:30,260
cross origin resource sharing our course
and we talked about what do something

714
00:41:30,260 --> 00:41:31,890
different things we can do it combines

715
00:41:31,890 --> 00:41:36,010
cell hopefully everybody learns

716
00:41:36,010 --> 00:41:39,010
a little bit %uh something here there
got some ideas of this

717
00:41:39,010 --> 00:41:46,010
on any and having questions

718
00:41:53,230 --> 00:41:55,840
at search i-ii

719
00:41:55,840 --> 00:41:59,380
okay so I'm actually I meant to go over
this at the very beginning

720
00:41:59,380 --> 00:42:03,110
something a few lesson Charlotte
recently put together is a Charlotte

721
00:42:03,110 --> 00:42:06,500
hackers Anonymous group which is not so
anonymous you know who we are

722
00:42:06,500 --> 00:42:10,190
on but that basically

723
00:42:10,190 --> 00:42:14,830
on we just get together I want someone
do some packing on a Saturday morning

724
00:42:14,830 --> 00:42:15,610
for a bit

725
00:42:15,610 --> 00:42:18,800
and then and then we have a social

726
00:42:18,800 --> 00:42:22,720
afterwards we have lunch have a couple
beers is

727
00:42:22,720 --> 00:42:26,040
have a good time so if you and it's all
free exxon

728
00:42:26,040 --> 00:42:30,200
not sponsored by anybody we just kinda
get together on our own for

729
00:42:30,200 --> 00:42:33,240
so if that's something that you're
interested in your in the Charlotte area

730
00:42:33,240 --> 00:42:36,220
especially if you're having trouble
getting to some of the other

731
00:42:36,220 --> 00:42:38,990
organization offense because they're too
far away from really have

732
00:42:38,990 --> 00:42:42,680
weenie the in South Charlotte so

733
00:42:42,680 --> 00:42:46,460
Charlotte folks who are live in that
area

734
00:42:46,460 --> 00:42:49,770
feel free to join us website Chad

735
00:42:49,770 --> 00:42:56,770
or that com china shop

736
00:43:23,310 --> 00:43:30,310
winning

737
00:43:31,200 --> 00:43:36,820
yeah

738
00:43:36,820 --> 00:43:40,370
so way to make the process of pulling in
tokens

739
00:43:40,370 --> 00:43:47,370
any approve they have protection on

740
00:43:53,230 --> 00:44:00,230
all

741
00:44:03,259 --> 00:44:06,469
II now I can't think of anything else me
I

742
00:44:06,469 --> 00:44:13,299
usually do because

743
00:44:13,299 --> 00:44:16,539
not not that I know of anybody else now

744
00:44:16,539 --> 00:44:21,499
hand just you

745
00:44:21,499 --> 00:44:26,140
detail thanks a lot

746
00:44:26,140 --> 00:44:26,529
all

