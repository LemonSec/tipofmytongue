1
00:00:00,299 --> 00:00:04,930
re-live for are but first offer anyone
has a drink

2
00:00:04,930 --> 00:00:08,450
a toast to the last Carolina Khan as we
know it Cheers

3
00:00:08,450 --> 00:00:15,450
so this is our talk on a drilling people
vares build powerful

4
00:00:15,969 --> 00:00:19,300
can is going over the framework in from
a new addition how you doing

5
00:00:19,300 --> 00:00:22,359
you're here I'm sick stuff ago via

6
00:00:22,359 --> 00:00:26,160
I'm just order I professor at the word
up the press division

7
00:00:26,160 --> 00:00:29,679
do a lot a reverse engineering kinda
keeping up with bad guys are doing come

8
00:00:29,679 --> 00:00:31,560
from a little bit of a defensive
background

9
00:00:31,560 --> 00:00:34,630
and try to apply that knowledge on to
the offense I D

10
00:00:34,630 --> 00:00:38,120
people for all assessment make them make
them work money

11
00:00:38,120 --> 00:00:42,850
anarchy factor developer on the bill
Pryor pretty recently and specifically

12
00:00:42,850 --> 00:00:44,290
on a powerful fighting

13
00:00:44,290 --> 00:00:47,600
diving and PowerShell partial
capabilities of

14
00:00:47,600 --> 00:00:52,140
again and no thanks to the great
introduction

15
00:00:52,140 --> 00:00:55,840
I'm well-armed joy I won't repeat all
this stuff but I was here last year

16
00:00:55,840 --> 00:00:56,940
Christopher Tranter

17
00:00:56,940 --> 00:01:00,449
on the other main developers to the bill
framework we talkin AB vision with the

18
00:01:00,449 --> 00:01:00,980
offering

19
00:01:00,980 --> 00:01:05,930
really great time Chris up very seventy
can be this year he's out how to engage

20
00:01:05,930 --> 00:01:06,350
ment

21
00:01:06,350 --> 00:01:09,880
he sends his regards so of we've got
another call talk lineup

22
00:01:09,880 --> 00:01:15,189
something going to be going over
basically I

23
00:01:15,189 --> 00:01:17,650
highlighting the different features that
are currently there's also for the new

24
00:01:17,650 --> 00:01:18,250
features

25
00:01:18,250 --> 00:01:22,299
I am we're gonna in this talk basically
going through actual

26
00:01:22,299 --> 00:01:25,909
like a real-world scenario for you
Wachter entirely using our framework

27
00:01:25,909 --> 00:01:29,990
and PowerShell offensively awfully kind
together some other things you might

28
00:01:29,990 --> 00:01:32,100
have seemed like you know like it might
have heard of power

29
00:01:32,100 --> 00:01:35,810
you specifically hear one of features I
show you how to walk from

30
00:01:35,810 --> 00:01:40,770
no access all the way through having
admin access just one thing dimension on

31
00:01:40,770 --> 00:01:44,060
the sides are actually live inside sure
now they're tweeted out on my hand or

32
00:01:44,060 --> 00:01:45,540
arm joy and has tweeted at

33
00:01:45,540 --> 00:01:50,240
Carolina contact as all hope

34
00:01:50,240 --> 00:01:53,299
the introduction kinda how we got here
to avail Fri Mar an hour

35
00:01:53,299 --> 00:01:57,610
well over there the veil framers start
with the talk ovale vision

36
00:01:57,610 --> 00:02:00,700
which we wanted to have a come in
generic way to generate

37
00:02:00,700 --> 00:02:02,820
ABV execute a Baltimore on

38
00:02:02,820 --> 00:02:06,159
test economy involved in this offense at
orchid

39
00:02:06,159 --> 00:02:09,600
started the you can aim to bridge the
gap between pen testing in writing

40
00:02:09,600 --> 00:02:10,470
capabilities

41
00:02:10,470 --> 00:02:13,670
expand from bill vision there is i
catapult which are coming payload

42
00:02:13,670 --> 00:02:14,560
delivery to all

43
00:02:14,560 --> 00:02:18,080
they'll pillage which was present at com
which has come before the floods pose

44
00:02:18,080 --> 00:02:20,350
exploitation premark kinda like us on
the exact

45
00:02:20,350 --> 00:02:24,290
and also be a power you which I spoke
briefly about last year

46
00:02:24,290 --> 00:02:27,340
on power play all these kind of
additional tools we can adding an

47
00:02:27,340 --> 00:02:30,200
so they're not all you know kinda one
single tool they don't quite make sense

48
00:02:30,200 --> 00:02:33,220
but we think they make sense as a
collection that we use offensively

49
00:02:33,220 --> 00:02:36,380
on again last year Carolina con

50
00:02:36,380 --> 00:02:43,310
2014 are revision with the real bills
PowerTel so we kinda had this

51
00:02:43,310 --> 00:02:46,600
you know schizophrenic division for the
veil stuff now we have

52
00:02:46,600 --> 00:02:50,340
basically to repose is what we're going
to be maintaining on the veil repo it

53
00:02:50,340 --> 00:02:51,590
has all the offense the power

54
00:02:51,590 --> 00:02:55,720
of it the Python stuff bill vision
catapult villagers such things

55
00:02:55,720 --> 00:02:59,010
rattling the Mets are doing my
chemical-based rewrite to combine

56
00:02:59,010 --> 00:02:59,550
everything

57
00:02:59,550 --> 00:03:03,630
and the second repo is a collection all
the offense a powershell stuff that

58
00:03:03,630 --> 00:03:04,310
we've got into

59
00:03:04,310 --> 00:03:07,820
so they'll power tools kinda what we
call that into

60
00:03:07,820 --> 00:03:12,590
no remain the primary source for all of
its a powershell work that we do

61
00:03:12,590 --> 00:03:15,750
with the everything and Python remain in
the Vale

62
00:03:15,750 --> 00:03:21,500
really quick no my workmates make funny
cuz I want shut up about PowerShell

63
00:03:21,500 --> 00:03:22,650
all-time

64
00:03:22,650 --> 00:03:27,100
solved on last year arm but PowerShell
real quick out the box like why you

65
00:03:27,100 --> 00:03:27,670
should use it

66
00:03:27,670 --> 00:03:31,070
it provides 4.8 access application
whitelisting and

67
00:03:31,070 --> 00:03:35,880
EV evasion kinda bypass natively direct
access to the windows 32 H

68
00:03:35,880 --> 00:03:40,570
API which will go over you can execute
everything purely memory that touching

69
00:03:40,570 --> 00:03:41,880
desk and its

70
00:03:41,880 --> 00:03:45,060
installed on every machine when our
windows 7 and up

71
00:03:45,060 --> 00:03:48,489
if you're not using powershell as an
offense if operator you

72
00:03:48,489 --> 00:03:52,420
absolution no reason not to there's this
great post from

73
00:03:52,420 --> 00:03:55,690
Mac raver on the power switch authors
call watchers ourselves an attack

74
00:03:55,690 --> 00:03:56,320
platform

75
00:03:56,320 --> 00:03:59,440
pointer also back guys are using it

76
00:03:59,440 --> 00:04:02,459
for power links are now where you know
deep and

77
00:04:02,459 --> 00:04:06,239
bad guys and red team are using
powershell

78
00:04:06,239 --> 00:04:06,550
not

79
00:04:06,550 --> 00:04:09,730
a reason not to if you want to do %uh
Pentastar red team

80
00:04:09,730 --> 00:04:13,040
and simulate real adversaries you need
to step up your tree crap with this

81
00:04:13,040 --> 00:04:13,410
stuff

82
00:04:13,410 --> 00:04:18,180
and no Mac reversal tweet saying I sent
a powershell awareness campaign can wind

83
00:04:18,180 --> 00:04:18,820
down now

84
00:04:18,820 --> 00:04:22,140
it was seen that the criminals and state
sponsor actors have it from here

85
00:04:22,140 --> 00:04:25,610
yeah there's been a really a major
uptick in Las your social account:

86
00:04:25,610 --> 00:04:26,220
exploded

87
00:04:26,220 --> 00:04:29,580
Manian Amir Khan actually had a really
cool talk on kinda

88
00:04:29,580 --> 00:04:32,640
triage instant response occurs often too
powerful

89
00:04:32,640 --> 00:04:36,340
and also how to put this code in
PowerShell

90
00:04:36,340 --> 00:04:40,820
space in my transpose exploitation
language on 1i farrakhan's our

91
00:04:40,820 --> 00:04:44,780
from obscure sec another one the power
switch off their so to get the guy in

92
00:04:44,780 --> 00:04:45,030
there

93
00:04:45,030 --> 00:04:49,310
the power to you this is kinda wanna the
first tools

94
00:04:49,310 --> 00:04:52,900
introduced are into the veil free-market
PowerShell based

95
00:04:52,900 --> 00:04:56,720
it started actually think I spoke on
this are couple slides last year

96
00:04:56,720 --> 00:05:02,280
I guess all that talk but it started
with the real motivation for it was we

97
00:05:02,280 --> 00:05:04,100
had a client that blocked all

98
00:05:04,100 --> 00:05:08,150
net died EXE commands so you know we had
a box we start running to our normal

99
00:05:08,150 --> 00:05:10,020
Ottawa menopause exploitation

100
00:05:10,020 --> 00:05:13,380
like and what the hell like we can to
work more like you know him is he who is

101
00:05:13,380 --> 00:05:14,790
in the demand and I kinda stuff

102
00:05:14,790 --> 00:05:19,010
I went back and we can arrange coded a
bunch of stuff up in PowerShell the new

103
00:05:19,010 --> 00:05:21,080
for replacements for net ID XE

104
00:05:21,080 --> 00:05:25,390
the real economy emerges as yes wear a
condom on steroids

105
00:05:25,390 --> 00:05:29,020
on anything you want to do for getting
users group trust

106
00:05:29,020 --> 00:05:32,650
my first fifty-plus functions and it's
not and it now it's been one my primary

107
00:05:32,650 --> 00:05:33,220
dove

108
00:05:33,220 --> 00:05:38,080
focuses over the last year otherwise it
was inspired by Rob for movie extra's

109
00:05:38,080 --> 00:05:39,400
poker last year

110
00:05:39,400 --> 00:05:42,610
here's a talk on nephew died EXE which
is a see

111
00:05:42,610 --> 00:05:47,440
plus post please call to enumerate like
shares users in all its kinda stuff on a

112
00:05:47,440 --> 00:05:48,250
Windows domain

113
00:05:48,250 --> 00:05:51,510
start taking some that functionality in
Concord and over

114
00:05:51,510 --> 00:05:55,419
on invoke NetView I believe is the
command line I'll

115
00:05:55,419 --> 00:05:58,610
courts allow that functionality 12

116
00:05:58,610 --> 00:06:02,400
the uses we've had for power users on
every single gauge

117
00:06:02,400 --> 00:06:07,500
now arm so whenever where we're
operating we have to figure out

118
00:06:07,500 --> 00:06:10,600
where users are logged in on specific
machines

119
00:06:10,600 --> 00:06:14,140
I sing in a fire talk on this topic
specifically schmoke on call

120
00:06:14,140 --> 00:06:19,460
Kansas men's on so for Gary specifically
those two main functions will use

121
00:06:19,460 --> 00:06:23,000
invoke user hunter will query domain for
all the machines down

122
00:06:23,000 --> 00:06:26,350
good each machine and enumerate the
logged in users and sessions

123
00:06:26,350 --> 00:06:29,950
and mashed up against a target list by
default like domain admins

124
00:06:29,950 --> 00:06:33,860
they can push this button you get a nice
list every single place for domain and

125
00:06:33,860 --> 00:06:34,510
as for Dan

126
00:06:34,510 --> 00:06:38,220
you can even check to see if you
actually have local admin access to

127
00:06:38,220 --> 00:06:41,690
are the target machine define invokes Lt
zahar

128
00:06:41,690 --> 00:06:45,390
as a reading trick where naturally gets
all the file shares in a network

129
00:06:45,390 --> 00:06:49,500
it doesn't sessions against those remote
sessions on matters that up against a

130
00:06:49,500 --> 00:06:50,200
target list

131
00:06:50,200 --> 00:06:54,460
so bear you call very few traffic you
can get a really good mapping were a lot

132
00:06:54,460 --> 00:06:57,870
water users are logged and lot less
traffic than the

133
00:06:57,870 --> 00:07:02,970
another cool thing I got ad in recently
because this guy

134
00:07:02,970 --> 00:07:06,460
offenses and parsing so if you get
domain administrator

135
00:07:06,460 --> 00:07:09,940
it doesn't mean you're done DA is not
the goal and goals access

136
00:07:09,940 --> 00:07:14,550
are showing impact an investigation a
lot of times want to get your day

137
00:07:14,550 --> 00:07:17,890
they can be this really nice means to
facilitate when you're in target is

138
00:07:17,890 --> 00:07:21,500
so you want reir guys finance guys one
examines whatever

139
00:07:21,500 --> 00:07:26,070
rate arm we give India getting DA but
you do things like we re all the event

140
00:07:26,070 --> 00:07:27,250
logs on a domain controller

141
00:07:27,250 --> 00:07:30,480
so argues get user logon events

142
00:07:30,480 --> 00:07:35,210
lets you extract all the 464 log on it
and I decided to make controller

143
00:07:35,210 --> 00:07:39,340
filtering for specific user me by
default it restricts last three days

144
00:07:39,340 --> 00:07:43,450
invoke user Ventana Raptors all open to
weaponize form

145
00:07:43,450 --> 00:07:48,180
you run this with DA give a specific
user target group or something like that

146
00:07:48,180 --> 00:07:48,710
will tell you

147
00:07:48,710 --> 00:07:51,730
exactly where he's person montana what
time so

148
00:07:51,730 --> 00:07:56,300
for you this really effectively on some
also did

149
00:07:56,300 --> 00:08:01,670
ok sorry you so kinda breaking into the
domain trust up obviously we're doing

150
00:08:01,670 --> 00:08:02,020
stuff

151
00:08:02,020 --> 00:08:06,300
our you worry me on a query domain truck
been and so how are using get

152
00:08:06,300 --> 00:08:09,810
not doing try thinking that force the
main we're able to kinda map out a

153
00:08:09,810 --> 00:08:10,410
network

154
00:08:10,410 --> 00:08:14,070
on in order to we can get all the
domains and then the domains are trust

155
00:08:14,070 --> 00:08:16,660
the way then we go to those dimming
controller that their trust the way than

156
00:08:16,660 --> 00:08:17,750
we do the same query

157
00:08:17,750 --> 00:08:22,170
effectively sputtering domain looking at
the different trust when I came onto the

158
00:08:22,170 --> 00:08:25,360
project the way we are visualizing this
like Ralph E S B of A

159
00:08:25,360 --> 00:08:28,760
well you know or understand 200,000
employees now work

160
00:08:28,760 --> 00:08:32,560
our customers like spread
internationally get this thing 100000

161
00:08:32,560 --> 00:08:34,970
the line TSP and it just wasn't very
useful

162
00:08:34,970 --> 00:08:38,130
and so I wrote a quick postscript out a
lot to

163
00:08:38,130 --> 00:08:41,600
on in Python import all this data and
actually graph it

164
00:08:41,600 --> 00:08:45,490
and know now kinda format so and UConn
taking some

165
00:08:45,490 --> 00:08:48,830
data analysis or Big Data techniques and
applying it to the

166
00:08:48,830 --> 00:08:51,850
enumeration we're doing what there is of
it and was

167
00:08:51,850 --> 00:08:55,120
pretty little girl and so you could
actually you know kinda

168
00:08:55,120 --> 00:08:58,680
dropping to a customer environment map
all domain trust and spit it out to a

169
00:08:58,680 --> 00:09:00,140
pretty picture so you can stay

170
00:09:00,140 --> 00:09:03,820
I would like to go here said that at the
center of a hundred-plus domain trust

171
00:09:03,820 --> 00:09:04,250
you then

172
00:09:04,250 --> 00:09:09,080
and likely would be able to crawl across
those domains the colors all here have a

173
00:09:09,080 --> 00:09:11,440
different meaning depending on the
specific domain trust

174
00:09:11,440 --> 00:09:16,200
and it obviously there's different ways
the graphic is a pretty complex topic

175
00:09:16,200 --> 00:09:20,670
arm we both have a couple wipers about
this but on my like the 100 at No

176
00:09:20,670 --> 00:09:23,860
there's a really intense really long
week step-by-step

177
00:09:23,860 --> 00:09:28,160
pose for numeration enumeration
visualization and abusive the set up a

178
00:09:28,160 --> 00:09:29,080
trust relationship

179
00:09:29,080 --> 00:09:32,160
or after the talk goes on come talk to
us for Journal

180
00:09:32,160 --> 00:09:36,470
on so-called won the last things a
barrier

181
00:09:36,470 --> 00:09:40,530
is data mining arm one other really
comin

182
00:09:40,530 --> 00:09:43,770
methods have access we've gone lately
are in secured

183
00:09:43,770 --> 00:09:47,840
a Windows file shares so and used to be
you know kind of a pain a lot I read

184
00:09:47,840 --> 00:09:51,080
teams would be like re: we're gonna have
a new guys in your mind every share and

185
00:09:51,080 --> 00:09:53,920
every file in triage everything can take
weeks or months

186
00:09:53,920 --> 00:09:57,510
but now a power you can you invoke share
finer check access

187
00:09:57,510 --> 00:10:01,800
missile spit out every single share
network that your user has read access

188
00:10:01,800 --> 00:10:02,290
to

189
00:10:02,290 --> 00:10:05,720
just dump it on to list taking it one
step further

190
00:10:05,720 --> 00:10:09,450
you can you invoke file finder missile
do kind of an equivalent of a juror

191
00:10:09,450 --> 00:10:09,880
slash

192
00:10:09,880 --> 00:10:12,910
ass recursive listing but it filters for

193
00:10:12,910 --> 00:10:17,760
file name to a specific wild card terms
things like password config

194
00:10:17,760 --> 00:10:21,890
admin things like that she can run this
in every single share that you have

195
00:10:21,890 --> 00:10:25,330
access to an entire Windows network
it'll dump out a CSV file

196
00:10:25,330 --> 00:10:28,280
telling you these are all the
interesting policy should go check out

197
00:10:28,280 --> 00:10:29,640
you can also sort them I like

198
00:10:29,640 --> 00:10:33,030
last access time in creation time and
stuff to triage on

199
00:10:33,030 --> 00:10:37,720
know what you up to wanna go after ok

200
00:10:37,720 --> 00:10:42,130
the power-up arm on me when mister was
escalation romario go there

201
00:10:42,130 --> 00:10:46,650
there is another tool that was made
because my boss pretty much

202
00:10:46,650 --> 00:10:49,910
many do all the stuff mainly on the red
team engagement

203
00:10:49,910 --> 00:10:52,970
go to every single service and got
everything will serve as executing check

204
00:10:52,970 --> 00:10:54,520
the permissions for every single one

205
00:10:54,520 --> 00:10:58,310
see if there's actually a problem the
progress so you know we had a process on

206
00:10:58,310 --> 00:11:00,860
this particular engagement scrum likes
boys won't work

207
00:11:00,860 --> 00:11:04,630
fall back to doing them go back to doing
it manually arm

208
00:11:04,630 --> 00:11:07,990
you know the started ticking like a day
day-and-a-half for me to do

209
00:11:07,990 --> 00:11:11,340
like this is this there's no reason this
can be done our show on

210
00:11:11,340 --> 00:11:15,850
Don significantly easier more quickly
and later on so important and more stuff

211
00:11:15,850 --> 00:11:18,390
from there is a great encyclopedia
professor

212
00:11:18,390 --> 00:11:23,240
other grow quick gonna go over a couple
other common profess factors

213
00:11:23,240 --> 00:11:27,540
10 services this is really kind of old
school people use to

214
00:11:27,540 --> 00:11:31,860
abuse like the bottle service permission
from cells was much more common to us

215
00:11:31,860 --> 00:11:35,310
are the permissions for the executors
also see with the service

216
00:11:35,310 --> 00:11:38,570
so if it's not install the c:\program
files are see when does

217
00:11:38,570 --> 00:11:41,870
not installed like see custom service
whatever

218
00:11:41,870 --> 00:11:45,460
those permissions art walk down by
default more users so if you can over

219
00:11:45,460 --> 00:11:46,650
right that execute all

220
00:11:46,650 --> 00:11:49,900
restart the service you know either
through the Service Control Manager

221
00:11:49,900 --> 00:11:53,580
or rebooting the box and you can profess
there's you know the get

222
00:11:53,580 --> 00:11:59,440
service firms again service EXE primes
an up arrow real hijacking

223
00:11:59,440 --> 00:12:03,350
as another super super common method so
many programs and services will search

224
00:12:03,350 --> 00:12:04,650
for multiple locations

225
00:12:04,650 --> 00:12:08,180
for the low they need to load for of
proper execution

226
00:12:08,180 --> 00:12:12,040
the very in up this search will be the
PATH variable

227
00:12:12,040 --> 00:12:15,450
Windows the end result is if there's any
folder

228
00:12:15,450 --> 00:12:19,580
in your Windows system pasa like C++
Python 27 C Perl C

229
00:12:19,580 --> 00:12:23,190
you know are totally not Lotus Notes I
promise that doesn't happen on

230
00:12:23,190 --> 00:12:27,190
there's you can escalate on a Windows
machine on a person the time at least

231
00:12:27,190 --> 00:12:28,240
for 107

232
00:12:28,240 --> 00:12:32,150
pretty sure there's a couple methods for
Owen is a small so

233
00:12:32,150 --> 00:12:36,600
invoke find at the Ojai Jack while new
rain all the folders in your path

234
00:12:36,600 --> 00:12:39,610
are it will check to see if you can
actually right to it

235
00:12:39,610 --> 00:12:44,310
no report back everything ghastly para

236
00:12:44,310 --> 00:12:48,060
wrapped everything wrap all this stuff
together you can execute any number

237
00:12:48,060 --> 00:12:49,510
these checks me knowing

238
00:12:49,510 --> 00:12:52,740
or you can run the info call tax to run
all the contracts

239
00:12:52,740 --> 00:12:56,400
give you nice report out will do this in
the demo right at the very end

240
00:12:56,400 --> 00:13:00,370
there's actually a couple abuse
functions you can use like you can write

241
00:13:00,370 --> 00:13:01,110
out the service

242
00:13:01,110 --> 00:13:06,230
EXE our working on a deal I'll no right
MSI dad to use on my kinda stuff

243
00:13:06,230 --> 00:13:10,100
all that's completely contained in the
script so you don't have to manually

244
00:13:10,100 --> 00:13:12,650
create a service like patch everything
and whatever else

245
00:13:12,650 --> 00:13:16,310
is kinda all 11 Windows professed
auditing tool

246
00:13:16,310 --> 00:13:19,430
has been super super effective I think
probably like seventy percent

247
00:13:19,430 --> 00:13:22,220
engagements wrong we usually find
something asleep

248
00:13:22,220 --> 00:13:25,530
that they were the first things we doing
it on you know to gauge how we have a

249
00:13:25,530 --> 00:13:26,950
weaker couple weeks we've all

250
00:13:26,950 --> 00:13:30,380
I with a local images to give give us
one on this trip

251
00:13:30,380 --> 00:13:35,380
often hi Lori find one we find it on
everything the next up is a power-packed

252
00:13:35,380 --> 00:13:40,760
so I came on the project we started to
have this fear that someday our

253
00:13:40,760 --> 00:13:44,300
favor framework are favored scripting
language many people

254
00:13:44,300 --> 00:13:47,550
Sunday administrators can figure out how
to block PowerShell

255
00:13:47,550 --> 00:13:51,330
on and so we we realized that my
piercing a power failure and we actually

256
00:13:51,330 --> 00:13:52,450
ended up on an engagement

257
00:13:52,450 --> 00:13:55,390
the right upper started working where
the administrators in the network

258
00:13:55,390 --> 00:13:55,970
defenders

259
00:13:55,970 --> 00:13:59,070
affectively you hip on to

260
00:13:59,070 --> 00:14:03,550
flag on PS that PowerShell and so we
started to see the possibility more more

261
00:14:03,550 --> 00:14:03,990
real

262
00:14:03,990 --> 00:14:08,380
and we wanted to actually prepare for
situations like this and so I develop

263
00:14:08,380 --> 00:14:08,920
our pic

264
00:14:08,920 --> 00:14:13,410
kinda as a not you know all perfect
solution but a demonstration

265
00:14:13,410 --> 00:14:17,850
if not quite so easy to do this and so I
actually used on that in c-sharp

266
00:14:17,850 --> 00:14:18,780
specifically

267
00:14:18,780 --> 00:14:21,839
to implement like the system dot
management automation which allows you

268
00:14:21,839 --> 00:14:22,280
to

269
00:14:22,280 --> 00:14:26,490
the fine run spaces in like PowerShell
runs basis and fish are

270
00:14:26,490 --> 00:14:30,020
and I wanted to see if like what the
deal

271
00:14:30,020 --> 00:14:34,030
what that look like on indicator level
over a blog post on this is came out a

272
00:14:34,030 --> 00:14:35,240
couple months ago

273
00:14:35,240 --> 00:14:39,890
I were a lot of discussion was generated
and effectively what a lot to do with

274
00:14:39,890 --> 00:14:42,290
the feet blacklist whitelist

275
00:14:42,290 --> 00:14:46,310
are you know the best way to go
obviously more ideal than a block block

276
00:14:46,310 --> 00:14:47,990
with the when there's been lots of talk

277
00:14:47,990 --> 00:14:51,440
showing how black fell but it still use
we always seem

278
00:14:51,440 --> 00:14:54,560
customers and and if requirements
blacklist neck

279
00:14:54,560 --> 00:14:58,029
and blacklist our health typically on
the tap water

280
00:14:58,029 --> 00:15:01,440
all there's this little trick with
officially allows you to

281
00:15:01,440 --> 00:15:05,540
use the supply dot management automation
call a run space

282
00:15:05,540 --> 00:15:08,700
which doesn't ever star Powershot
actually

283
00:15:08,700 --> 00:15:11,920
actual utilizes the back and like global
assembly cache

284
00:15:11,920 --> 00:15:15,940
call the doc you so in the process left
are selecting ever start

285
00:15:15,940 --> 00:15:21,370
and effectively block all bypass so this
is kinda screenshot to show that if

286
00:15:21,370 --> 00:15:24,339
you're an app Locker and you go to look
at the low block like you're trying to

287
00:15:24,339 --> 00:15:25,370
block the low

288
00:15:25,370 --> 00:15:29,100
you can't even access the deal
associated with the global assembly

289
00:15:29,100 --> 00:15:32,740
cache by default in the Explorer anyway
when you pull up a nice pretty

290
00:15:32,740 --> 00:15:35,779
do you like like the all the while block
any

291
00:15:35,779 --> 00:15:39,540
anything in a few and assembly
directorial like Microsoft rise

292
00:15:39,540 --> 00:15:41,320
obviously the deal all the way from you

293
00:15:41,320 --> 00:15:45,100
you know are you messing with them user
there's a registry hack what you can

294
00:15:45,100 --> 00:15:48,570
implement like allow you to see that the
law but rather complicated

295
00:15:48,570 --> 00:15:52,350
actually block this technically and
ended up implementing

296
00:15:52,350 --> 00:15:55,360
we call that sharp echoes it's been out
for a little bit

297
00:15:55,360 --> 00:16:00,450
in the future stuff push today so when I
put this out I had a whole 12 discussion

298
00:16:00,450 --> 00:16:03,600
from the office powerful community
saying that was really cool

299
00:16:03,600 --> 00:16:07,200
like it's kinda need to demonstrate the
impact in like demonstrate the Microsoft

300
00:16:07,200 --> 00:16:08,240
we should probably block

301
00:16:08,240 --> 00:16:13,040
by it's not that sexy like it but a
binary this committee sharpen

302
00:16:13,040 --> 00:16:16,460
there are still ways the block it and so
really they wanted to

303
00:16:16,460 --> 00:16:20,500
execute PowerShell from unmanaged code
so if you can do this and fears people

304
00:16:20,500 --> 00:16:21,880
plus the better

305
00:16:21,880 --> 00:16:25,650
right like packard like that language
better sure and so

306
00:16:25,650 --> 00:16:29,040
early Christians and get a handle to
Afghan actually put on a project

307
00:16:29,040 --> 00:16:32,600
following a discussion on managed are
shell it allows you to

308
00:16:32,600 --> 00:16:36,280
use the feel RM or a dot head assembly
in

309
00:16:36,280 --> 00:16:40,440
from memory and actually execute
PowerShell code from fierce people plus

310
00:16:40,440 --> 00:16:42,200
and I

311
00:16:42,200 --> 00:16:45,700
the easy job taking all this Cody
Panerai and made into a pretty

312
00:16:45,700 --> 00:16:46,280
reflective

313
00:16:46,280 --> 00:16:49,820
lol what I basically allowed me to do

314
00:16:49,820 --> 00:16:54,980
was allowed me to inject that feel well
incurable process which with then

315
00:16:54,980 --> 00:16:58,630
run PowerShell an hour or more
profitable dollar starting also like the

316
00:16:58,630 --> 00:17:02,839
and a whatever I would you know whatever
power 2001 attacks you'd be in the

317
00:17:02,839 --> 00:17:05,600
contact that profit and of course

318
00:17:05,600 --> 00:17:10,459
to add more power shelter more we had a
powershell script that actually

319
00:17:10,459 --> 00:17:13,589
does it for you job I like reflective
injection

320
00:17:13,589 --> 00:17:17,130
to inject are reflected the along to
their a process was thinking offered on

321
00:17:17,130 --> 00:17:17,459
that

322
00:17:17,459 --> 00:17:21,490
I run mall show the power in this in the
demo like this by not all

323
00:17:21,490 --> 00:17:25,189
completely make sense on why exactly you
want to do this but shona

324
00:17:25,189 --> 00:17:29,540
water about slides pretty awesome for
this diagram break down a lil you there

325
00:17:29,540 --> 00:17:33,080
basically we have RPS injector script
which injects into

326
00:17:33,080 --> 00:17:36,190
the executors will you want to target
what they explore you're either

327
00:17:36,190 --> 00:17:39,670
which then all they reflect the pic DLL
injector

328
00:17:39,670 --> 00:17:44,470
even-steven your happen and then all the
dot assembly for member Lee

329
00:17:44,470 --> 00:17:49,290
memory and then executed allocate over
reach out to remote host then pour the

330
00:17:49,290 --> 00:17:51,290
secondary stage in that process

331
00:17:51,290 --> 00:17:54,450
and so when you when you combine that
with other

332
00:17:54,450 --> 00:17:59,320
for the become really really affected
again them and then the obligatory mean

333
00:17:59,320 --> 00:18:02,380
are shown PowerShell PowerShell

334
00:18:02,380 --> 00:18:05,440
dawg I heard you like PowerShell I got
trolled quite a bit after putting this

335
00:18:05,440 --> 00:18:07,560
out of how many layers can we go

336
00:18:07,560 --> 00:18:11,310
call next door pew pew pew

337
00:18:11,310 --> 00:18:15,800
my boss love the style he says really
awesome so this is the obligatory mean

338
00:18:15,800 --> 00:18:17,810
for this her big fat American Cup

339
00:18:17,810 --> 00:18:21,750
America so

340
00:18:21,750 --> 00:18:24,780
okay arm the whole thing with few ppl

341
00:18:24,780 --> 00:18:29,940
is kinda a it's our kinda like a design
pattern I guess would be the best way to

342
00:18:29,940 --> 00:18:30,340
say it

343
00:18:30,340 --> 00:18:35,880
so this invoke masses I'm as a model to
run PowerShell scripts on a mass number

344
00:18:35,880 --> 00:18:39,240
machines and and retrieve the results

345
00:18:39,240 --> 00:18:42,810
all without needing r when R M or PS
from owning

346
00:18:42,810 --> 00:18:46,929
enable years where PS from owning this
really awesome way that you can run like

347
00:18:46,929 --> 00:18:47,980
PowerShell scripts like

348
00:18:47,980 --> 00:18:51,830
broke many cats remote machines without
having to

349
00:18:51,830 --> 00:18:55,310
you know do any download cradles or
anything else in this running natively

350
00:18:55,310 --> 00:18:56,210
in remotely

351
00:18:56,210 --> 00:19:00,760
a problem with that is is when R M is
not enabled by default on pretty much

352
00:19:00,760 --> 00:19:01,590
anything

353
00:19:01,590 --> 00:19:05,920
I think except when does summer 2012 and
most in a price point is that we speak

354
00:19:05,920 --> 00:19:07,879
are you know just now decommissioning

355
00:19:07,879 --> 00:19:10,999
your Windows 2003 servers and having
2008

356
00:19:10,999 --> 00:19:14,779
goes everybody always keeps up with all
the Microsoft Updates

357
00:19:14,779 --> 00:19:19,509
totally like somethings anyway so we
wanted a way that we can execute stuffy

358
00:19:19,509 --> 00:19:20,969
W mine get the results

359
00:19:20,969 --> 00:19:24,199
and rum whatever powershell script we
wanted on a mass number

360
00:19:24,199 --> 00:19:28,429
pose it was i think on like our own
internal blog about this about

361
00:19:28,429 --> 00:19:33,109
using my bat files and you know like a
punch in different parts all web server

362
00:19:33,109 --> 00:19:33,719
to run all

363
00:19:33,719 --> 00:19:38,009
all this stuff and there is a blog post
webster sec talking about a

364
00:19:38,009 --> 00:19:41,389
down-and-dirty PowerShell web server
like I combine all the approaches

365
00:19:41,389 --> 00:19:45,269
the end result is a job if I web servers
kicked off in the background on a

366
00:19:45,269 --> 00:19:46,769
specific portly any

367
00:19:46,769 --> 00:19:51,969
year whatever you wanna specified on W
my is used to execute below I yet to

368
00:19:51,969 --> 00:19:52,919
download cradle

369
00:19:52,919 --> 00:19:57,469
on any number target machines download
cradle will come back your pillow box

370
00:19:57,469 --> 00:20:01,449
execute a host a powershell script on
get all the result

371
00:20:01,449 --> 00:20:05,579
and then all host those results back to
that same more locally hosted web server

372
00:20:05,579 --> 00:20:08,839
all the results are gonna be saved out
to a file and you can run

373
00:20:08,839 --> 00:20:13,199
whatever parsing and stuff you want
afterwards three new stuff like

374
00:20:13,199 --> 00:20:16,789
invoke mass many cats which'll execute
PowerSuite awesome

375
00:20:16,789 --> 00:20:20,239
and broke many cat script you guys are
aware this you can arm

376
00:20:20,239 --> 00:20:24,149
run mini cabs and get injected Alsace
and you know your plaintext passwords

377
00:20:24,149 --> 00:20:24,909
without

378
00:20:24,909 --> 00:20:28,389
having to run in agent like interpreter
something else on without having to drop

379
00:20:28,389 --> 00:20:29,049
a binary

380
00:20:29,049 --> 00:20:34,039
disc now with this approach you can run
the script on a mass number machines we

381
00:20:34,039 --> 00:20:34,409
done

382
00:20:34,409 --> 00:20:37,579
you know dozens I think it should work
up to you know hundreds

383
00:20:37,579 --> 00:20:41,799
get all the result is up yes remotely
results are parsed of

384
00:20:41,799 --> 00:20:45,219
on a server credential object is gonna
look like this

385
00:20:45,219 --> 00:20:49,079
you know as a demo just gonna run out
you know to the servers I'm doing the

386
00:20:49,079 --> 00:20:49,839
verbose

387
00:20:49,839 --> 00:20:53,359
things you can see the output you're
going to get you know the server and the

388
00:20:53,359 --> 00:20:56,649
credentials are gonna just are coming
back for the Allan hashes also like the

389
00:20:56,649 --> 00:20:57,379
plaintext

390
00:20:57,379 --> 00:21:03,149
so its cool are one caveat is you do
need on admin access on the box

391
00:21:03,149 --> 00:21:10,149
in a box you're using so you can
actually grab the porn sample letter

392
00:21:14,070 --> 00:21:18,250
yeah I mean you have to have it's a you
know the scenario is you asked me to

393
00:21:18,250 --> 00:21:21,530
local admin the same some kinda in a
local admin are you so you grab me like

394
00:21:21,530 --> 00:21:21,880
a

395
00:21:21,880 --> 00:21:25,730
ADESA bad manners some ramen token this
is a way that you can

396
00:21:25,730 --> 00:21:29,960
you know triage very quickly a large
number machines and remaining on the

397
00:21:29,960 --> 00:21:30,810
pointer

398
00:21:30,810 --> 00:21:33,930
a potentially whatever scripture taking
over to the remote host

399
00:21:33,930 --> 00:21:36,970
depends on that so if you're not doing
any cat are you doing like a

400
00:21:36,970 --> 00:21:39,970
a simple download Prado largest you know
writing out a file

401
00:21:39,970 --> 00:21:44,000
you potentially don't need admin on
those hoes depend on on

402
00:21:44,000 --> 00:21:48,200
so one step further Microsoft as urs
other awesome get for us

403
00:21:48,200 --> 00:21:51,790
a call the Microsoft Search Indexing
Service

404
00:21:51,790 --> 00:21:55,300
so we talked about know kinda the file
finder and

405
00:21:55,300 --> 00:21:59,290
doing a essentially equivalent avatar
slash ass and prepping for specific

406
00:21:59,290 --> 00:21:59,800
names

407
00:21:59,800 --> 00:22:03,240
well my boss and I said that my boss
Mike this is awesome

408
00:22:03,240 --> 00:22:05,950
his response was will come back to me
when you can actually search inside the

409
00:22:05,950 --> 00:22:06,590
file

410
00:22:06,590 --> 00:22:10,450
cap water so microsoft does this for you

411
00:22:10,450 --> 00:22:13,880
I'm Windows seven work stations right
now all Search indexer you go be search

412
00:22:13,880 --> 00:22:14,470
for stuff

413
00:22:14,470 --> 00:22:17,840
so if you have an access to punching
machines

414
00:22:17,840 --> 00:22:21,000
you can run invoke mass search it all

415
00:22:21,000 --> 00:22:24,330
run a powershell script on any number
arbitrary number machines

416
00:22:24,330 --> 00:22:28,780
we're in the search indexer for any
terms you want password your specific

417
00:22:28,780 --> 00:22:29,850
search terms or something

418
00:22:29,850 --> 00:22:33,510
and posole the results back the really
cool thing is there's a little feel

419
00:22:33,510 --> 00:22:34,710
called auto summary

420
00:22:34,710 --> 00:22:37,710
which will give you the snippet of text
that it flagged on

421
00:22:37,710 --> 00:22:41,030
you know you like to block a like two
paragraphs attacked you don't even have

422
00:22:41,030 --> 00:22:42,900
to download the file from a machine

423
00:22:42,900 --> 00:22:46,350
in his run this on you know a crapload
have when you know

424
00:22:46,350 --> 00:22:49,990
server admin machines are you know
that's a bad machines for specific

425
00:22:49,990 --> 00:22:51,440
things like passwords or

426
00:22:51,440 --> 00:22:54,970
you know like sensitive you know project
terms or something like that

427
00:22:54,970 --> 00:22:58,560
and get all this result data back
without actually having to download the

428
00:22:58,560 --> 00:22:59,060
files

429
00:22:59,060 --> 00:23:06,060
arm i think is pretty cool i dont most
people don't think p1 really good

430
00:23:06,470 --> 00:23:09,590
and this is a the newest addition is
just a shot to get up this morning

431
00:23:09,590 --> 00:23:13,240
when I came on the project basically I
have identified all the stuff like

432
00:23:13,240 --> 00:23:14,640
manage project for a strong

433
00:23:14,640 --> 00:23:17,850
where the we know where the home I can
contribute here new guy came to guide

434
00:23:17,850 --> 00:23:21,880
the project and I i kinda identify that
the one last area that we had in touch

435
00:23:21,880 --> 00:23:22,290
in

436
00:23:22,290 --> 00:23:27,480
likely because it kinda been talk about
heavily another project was but the idea

437
00:23:27,480 --> 00:23:31,130
back doors oftentimes would be an
engagement and you know we do all these

438
00:23:31,130 --> 00:23:34,299
crazy powerful capabilities and often
stop we never deployed for

439
00:23:34,299 --> 00:23:37,549
and I get to the point where we like
want to maintain access on hosting like

440
00:23:37,549 --> 00:23:39,510
well I guess I gotta push up in a
janitor

441
00:23:39,510 --> 00:23:43,179
I guess I just gotta you dislike a
synchronization keep it running at all

442
00:23:43,179 --> 00:23:46,299
I'm when you end up with a couple
hundred hosts on the network like

443
00:23:46,299 --> 00:23:48,390
keeping all these a synchronization
straight come

444
00:23:48,390 --> 00:23:53,370
and so I i wanted to identify a way that
allowed us to

445
00:23:53,370 --> 00:23:56,669
either remain every resident regain
access the system that we have

446
00:23:56,669 --> 00:23:57,990
previously compromise

447
00:23:57,990 --> 00:24:02,160
and do in kinda a very way we say the
softened up by

448
00:24:02,160 --> 00:24:05,360
buzzword bingo here like we want to we
won't have multiple

449
00:24:05,360 --> 00:24:08,520
a technique for the network we don't
want to ever have a single on a billion

450
00:24:08,520 --> 00:24:11,169
people heard the defense and at the
white don't have

451
00:24:11,169 --> 00:24:14,320
no one piece be the single point of
failure you like that the offense and

452
00:24:14,320 --> 00:24:15,000
that is

453
00:24:15,000 --> 00:24:18,580
don't have a single point of failure
attacks if I can a one-piece

454
00:24:18,580 --> 00:24:22,110
know you want or fails you're one binary
fails you don't want your hole

455
00:24:22,110 --> 00:24:26,820
to be complete cash Center learning car
so I thought why not do it

456
00:24:26,820 --> 00:24:30,169
again are helping powerful product we
shoulda said

457
00:24:30,169 --> 00:24:33,429
and a drinking game is if we say power
PowerShell than everybody else to drink

458
00:24:33,429 --> 00:24:35,850
so you're probably be wasted by the end
of October

459
00:24:35,850 --> 00:24:39,220
you know have fun and basically what I
do with this project is my goal was to

460
00:24:39,220 --> 00:24:40,020
autonomy

461
00:24:40,020 --> 00:24:43,970
a a bunch of non-persistent back towards
meaning not renew persist that

462
00:24:43,970 --> 00:24:48,490
you could put down on a host to regain
access you come back about 95 percent of

463
00:24:48,490 --> 00:24:49,970
our more dancing a trance-like

464
00:24:49,970 --> 00:24:53,410
95 I'm during an engagement we don't
like about ol one death

465
00:24:53,410 --> 00:24:57,429
we've definitely move to a memory only
like operating standard and because

466
00:24:57,429 --> 00:24:57,830
inter

467
00:24:57,830 --> 00:25:01,230
honors our allies Martin we have to
answer phone or something memory of all

468
00:25:01,230 --> 00:25:02,059
time out to

469
00:25:02,059 --> 00:25:06,120
so its it's tough going concern for us
so we want to raise to be memory only

470
00:25:06,120 --> 00:25:10,890
and and have variant rikers that that
called very actions to occur

471
00:25:10,890 --> 00:25:14,160
so we actually broke out the back door
to be like trigger verse action actually

472
00:25:14,160 --> 00:25:14,750
very

473
00:25:14,750 --> 00:25:18,840
both for them and the environment and so
we're gonna talk about so many call +1

474
00:25:18,840 --> 00:25:22,320
from the one we thought would be most
apopka more most usable

475
00:25:22,320 --> 00:25:26,560
across engagement and saw this idea
actually started really early on before

476
00:25:26,560 --> 00:25:27,620
as ever

477
00:25:27,620 --> 00:25:31,660
wherever in the private industry I N
actually it came from the

478
00:25:31,660 --> 00:25:35,500
wipe the drive talk by Mark Duggan
Jekyll & but those guys like I get

479
00:25:35,500 --> 00:25:39,530
all here a and so we actually using this

480
00:25:39,530 --> 00:25:43,070
this the this back or use get one team
and PowerShell

481
00:25:43,070 --> 00:25:46,240
the costly monitor the windows event log
we do so in a way

482
00:25:46,240 --> 00:25:50,090
we monitor only the event logs that we
checked since the previous I will check

483
00:25:50,090 --> 00:25:54,350
so it's not not so intensive on the
system it's fairly and what we look for

484
00:25:54,350 --> 00:25:57,820
sale a blog on the bench assuming that
they're turned on an auditing

485
00:25:57,820 --> 00:26:01,500
I have a certain trigger username and so
this

486
00:26:01,500 --> 00:26:05,710
this back to run on a system and as an
attacker if you want to regain access

487
00:26:05,710 --> 00:26:07,450
all you have to do is RTP with a

488
00:26:07,450 --> 00:26:10,870
values in it generate the value that
other the stock or trigger

489
00:26:10,870 --> 00:26:14,020
and fire home a download cradle article
haunt your thing

490
00:26:14,020 --> 00:26:17,230
and so it's kinda funny technique that
entire owners of

491
00:26:17,230 --> 00:26:20,970
catch doesn't quite follow the entire
team in the white drive talk as they

492
00:26:20,970 --> 00:26:23,880
really focused on having think that
we're in memory in general

493
00:26:23,880 --> 00:26:29,390
doing this in power so obviously I have
to have an execution way to run it and

494
00:26:29,390 --> 00:26:29,900
so

495
00:26:29,900 --> 00:26:34,420
a the next one was the porn of back-door
so I got the event log but this really

496
00:26:34,420 --> 00:26:35,820
cool or what else can I do

497
00:26:35,820 --> 00:26:39,540
I wanted a way to actually use it
network triggering scenario

498
00:26:39,540 --> 00:26:43,580
our way to call you back oraclehome but
without being identified

499
00:26:43,580 --> 00:26:47,950
the city view for civically for and
their response astonished when you cough

500
00:26:47,950 --> 00:26:49,640
only like you know the first thing to do

501
00:26:49,640 --> 00:26:52,980
minority that works like protect their
own for them they don't wanna coming to

502
00:26:52,980 --> 00:26:53,430
get them

503
00:26:53,430 --> 00:26:57,060
and so we wanted a way to remain resin
on that system without getting

504
00:26:57,060 --> 00:27:00,590
like their and see if we use this get
packets for probably self

505
00:27:00,590 --> 00:27:04,040
blog he was using basically powerful to
do with never

506
00:27:04,040 --> 00:27:07,990
start up a raw socket promiscuously
across all the fourth

507
00:27:07,990 --> 00:27:11,500
are the firehall fires out

508
00:27:11,500 --> 00:27:13,280
what about that here and then

509
00:27:13,280 --> 00:27:17,870
I took that sniffer and I what every day
to pack into every packet hitting the

510
00:27:17,870 --> 00:27:18,460
system

511
00:27:18,460 --> 00:27:21,840
and look for a magic trick or value so
basically some value that the hacker

512
00:27:21,840 --> 00:27:22,470
define

513
00:27:22,470 --> 00:27:26,150
is a way to trigger the back door when I
think that your value

514
00:27:26,150 --> 00:27:29,830
I call home art for this allows you to
use it.

515
00:27:29,830 --> 00:27:33,260
unity or ICMP to trigger a system

516
00:27:33,260 --> 00:27:37,110
so it's a much more flexible network way
to call have your back or call

517
00:27:37,110 --> 00:27:41,020
san one paying to your admin system that
you want to regain access

518
00:27:41,020 --> 00:27:44,470
no download trigger back inside

519
00:27:44,470 --> 00:27:47,650
and MPTP view they don't feel like a
bound or

520
00:27:47,650 --> 00:27:50,920
something really obvious flashes red the
they might feel like a all

521
00:27:50,920 --> 00:27:53,990
because at the raw socket they might be
something down like local Hosur

522
00:27:53,990 --> 00:27:58,050
you know other think out blendon and
then a

523
00:27:58,050 --> 00:28:01,300
when we knew penetration test a lot of
time ever call a method

524
00:28:01,300 --> 00:28:05,760
like oh yeah you you yeah you know I'm
in accessing you merely out a back door

525
00:28:05,760 --> 00:28:06,350
user

526
00:28:06,350 --> 00:28:10,030
or you take your user data provided by
the customer and you elevated to the

527
00:28:10,030 --> 00:28:10,780
domain at

528
00:28:10,780 --> 00:28:15,170
and that's how you maintain access well
when you do that obviously like when

529
00:28:15,170 --> 00:28:18,840
they catch in a lot about mentor for a
run script monitor the domain under

530
00:28:18,840 --> 00:28:22,920
in prepaid byron they kill that and they
kill everything you have if you don't

531
00:28:22,920 --> 00:28:23,560
play thing

532
00:28:23,560 --> 00:28:27,240
and so I wrote a script that can look
for either local users

533
00:28:27,240 --> 00:28:30,800
or domain user and if it didn't find the
president about user

534
00:28:30,800 --> 00:28:33,800
within phone hoe for you to place all to

535
00:28:33,800 --> 00:28:37,290
a dollar twenty or thirty machines on
the network and whenever those answers

536
00:28:37,290 --> 00:28:39,470
honors catch you and I delete your user

537
00:28:39,470 --> 00:28:42,470
it trips all a backdoor the network in
the offer calling

538
00:28:42,470 --> 00:28:46,350
mall and actually good because it's like
a

539
00:28:46,350 --> 00:28:49,370
attacker idea like i havent ponder on

540
00:28:49,370 --> 00:28:53,570
have always called back really like it
it's a it's a way to help us on

541
00:28:53,570 --> 00:28:56,950
working penetration tougher I still
wanna have

542
00:28:56,950 --> 00:29:01,370
the call back for the trigger for
wannabes be re at the user that will

543
00:29:01,370 --> 00:29:04,980
they just deleted so every 10 seconds
they tried deleting users magically

544
00:29:04,980 --> 00:29:06,550
reenter the domain

545
00:29:06,550 --> 00:29:10,230
we having gone to do that yet I said I
still wanna maybe someday or messing

546
00:29:10,230 --> 00:29:11,140
with my our guys

547
00:29:11,140 --> 00:29:14,550
typically are engaging are kinda various
tactics like

548
00:29:14,550 --> 00:29:17,770
thing iraq securing the action is
significantly different than the thing

549
00:29:17,770 --> 00:29:20,930
that we are using at the back door in
the first place we all want to stick out

550
00:29:20,930 --> 00:29:24,280
but petrolia kinda entertaining to do
that sometime

551
00:29:24,280 --> 00:29:28,110
washed them wonder from a remote machine
running within 20 for them out

552
00:29:28,110 --> 00:29:33,670
user not only have we call the resolver
backdoor

553
00:29:33,670 --> 00:29:37,620
on this is this a little healthier and
really tight network situation we have a

554
00:29:37,620 --> 00:29:38,750
couple customers I have

555
00:29:38,750 --> 00:29:43,100
really good network monitoring for take
packet capture on all around a reason

556
00:29:43,100 --> 00:29:43,470
all

557
00:29:43,470 --> 00:29:48,840
%um between enclave and this is what we
use in that case basically you provided

558
00:29:48,840 --> 00:29:49,760
the UNESCO same

559
00:29:49,760 --> 00:29:53,400
you know logged on attacker dot com and

560
00:29:53,400 --> 00:29:57,790
you give it a IP address that it should
be set and this thing will on a certain

561
00:29:57,790 --> 00:29:58,530
interval

562
00:29:58,530 --> 00:30:02,110
just a simple ass look up are resolved
and about a record

563
00:30:02,110 --> 00:30:05,650
and went to look for the IP address if
it matches the value that you defined it

564
00:30:05,650 --> 00:30:06,310
does nothing

565
00:30:06,310 --> 00:30:09,470
just you know remains dormant if it
changes

566
00:30:09,470 --> 00:30:13,330
to a different IP address you know I
actually called PowerShell to call home

567
00:30:13,330 --> 00:30:14,260
that IP address

568
00:30:14,260 --> 00:30:17,490
so it's basically using DNS %uh the
trigger

569
00:30:17,490 --> 00:30:21,180
to signify that you're ready for all
your call back to come and obviously

570
00:30:21,180 --> 00:30:22,280
right now

571
00:30:22,280 --> 00:30:25,340
this is kinda per because at the end
that our call back to release the fury

572
00:30:25,340 --> 00:30:29,430
yes we have enough taxol back on

573
00:30:29,430 --> 00:30:32,650
in the future with different action you
can essentially making an ass you're

574
00:30:32,650 --> 00:30:33,250
only you

575
00:30:33,250 --> 00:30:37,320
RealNetworks signature here to catch I
minutes depending on whatever you set a

576
00:30:37,320 --> 00:30:38,650
record request to be

577
00:30:38,650 --> 00:30:44,100
or whatever you resolve forget that all
these back towards a non-persistent

578
00:30:44,100 --> 00:30:48,060
we typically don't find any due process
and when you have a couple hundred hosts

579
00:30:48,060 --> 00:30:48,770
on the network

580
00:30:48,770 --> 00:30:52,519
usually 1 a.m. stays up overnight not
all of them are shutting down

581
00:30:52,519 --> 00:30:56,320
overall we can maintain active me but if
you're in the process

582
00:30:56,320 --> 00:31:00,649
something you really like it we like to
do on sketch of its really easy thing

583
00:31:00,649 --> 00:31:03,809
blamed for most part obviously
administrators and

584
00:31:03,809 --> 00:31:08,099
are funner catching on this but not when
you combine it with registry storage

585
00:31:08,099 --> 00:31:11,209
and so when you're not actually putting
a file on the file

586
00:31:11,209 --> 00:31:15,699
by Yuri encoding your PowerShell payload
into some random registry key

587
00:31:15,699 --> 00:31:20,659
and then your sketch task all it does is
ass but their registry key is execute

588
00:31:20,659 --> 00:31:23,669
with an IE act really nice because you
actually have no file

589
00:31:23,669 --> 00:31:27,149
artifact on the file and you want to get
really tricky you can do you can

590
00:31:27,149 --> 00:31:28,409
basically foreign Cody

591
00:31:28,409 --> 00:31:31,709
you by entering code it you can do you
like an abasic X or encryption

592
00:31:31,709 --> 00:31:35,699
you can do things like give a very large
file you can store different Chuck seven

593
00:31:35,699 --> 00:31:38,999
different registry keys now Michael
hopper Daniel hopped around

594
00:31:38,999 --> 00:31:42,979
recompiled everything like your
imaginations come out the limit with I

595
00:31:42,979 --> 00:31:46,209
can to get it by consulate in this
actually came in

596
00:31:46,209 --> 00:31:49,449
was inspired by a lot on our over power
like stuff

597
00:31:49,449 --> 00:31:52,829
how I like them a lot on our nowadays
like the start of the reports come out

598
00:31:52,829 --> 00:31:54,549
on from all the big print or like

599
00:31:54,549 --> 00:31:58,829
if the firm star-news registering
coating it not not necessarily a new

600
00:31:58,829 --> 00:31:59,769
technique but it

601
00:31:59,769 --> 00:32:04,779
still works quite well because the
registry is the wild wild west a vis dar

602
00:32:04,779 --> 00:32:08,190
release can and so

603
00:32:08,190 --> 00:32:12,249
I guess the so what here a highlight the
fact like when you for combining these

604
00:32:12,249 --> 00:32:14,649
polls when you think a PS injector

605
00:32:14,649 --> 00:32:18,049
up power pic ability combined with power

606
00:32:18,049 --> 00:32:21,199
reach you now have the ability stage a
powershell backdoor

607
00:32:21,199 --> 00:32:24,619
into remote processes without ever
running power call a taxi

608
00:32:24,619 --> 00:32:28,029
you could %uh put this event log back
Tauren to explore

609
00:32:28,029 --> 00:32:31,699
and you know when you do a quick process
list mister

610
00:32:31,699 --> 00:32:35,019
don't know no another better for

611
00:32:35,019 --> 00:32:38,119
and then they a you know you do if they
call on

612
00:32:38,119 --> 00:32:41,190
triggers you can release are combining
different techniques pew pew pew for

613
00:32:41,190 --> 00:32:41,799
example

614
00:32:41,799 --> 00:32:44,979
you could shoot out a hold on to power
retract or salsa from the fact that

615
00:32:44,979 --> 00:32:45,479
still

616
00:32:45,479 --> 00:32:49,269
you have to worry about hitting the
system one by one did at the back doors

617
00:32:49,269 --> 00:32:52,549
and you're pretty well positioned for
when the answer pondered does finally

618
00:32:52,549 --> 00:32:57,119
over any kind you are too thin

619
00:32:57,119 --> 00:33:00,459
we we like to have %uh the Penn fight
obviously

620
00:33:00,459 --> 00:33:04,279
and this is short because this is a
rather naturally of into talk but we'll

621
00:33:04,279 --> 00:33:05,180
be happy again

622
00:33:05,180 --> 00:33:08,200
fears are talk with you about like
defensive ideas we've seen

623
00:33:08,200 --> 00:33:11,840
in general hips and whitelisting has
really been painful

624
00:33:11,840 --> 00:33:15,730
for us I gave it the customer does have
right rightful role for the tech most

625
00:33:15,730 --> 00:33:20,450
things and is properly in a white
listening environment this is rather

626
00:33:20,450 --> 00:33:22,610
complicated even text you with
PowerShell

627
00:33:22,610 --> 00:33:26,200
it stop on without being said

628
00:33:26,200 --> 00:33:29,720
there needs to be a better way to
restrict PowerShell

629
00:33:29,720 --> 00:33:34,020
to certain users specifically not just
powerful a taxi or something or thing

630
00:33:34,020 --> 00:33:38,300
but the entire you something to
symbolise the framework and interacting

631
00:33:38,300 --> 00:33:42,510
with these different spaces we don't we
don't really like the fact that you know

632
00:33:42,510 --> 00:33:42,910
in

633
00:33:42,910 --> 00:33:46,300
generic its kinda a puzzle to figure out
how to do this

634
00:33:46,300 --> 00:33:49,670
enterprise environment and so with this
is you know that's what we're trying to

635
00:33:49,670 --> 00:33:51,470
push by doing all these capabilities

636
00:33:51,470 --> 00:33:54,930
fire different and if you got new
techniques that for did

637
00:33:54,930 --> 00:33:59,450
block the stuff we would love to see
them because was the people we ask the

638
00:33:59,450 --> 00:34:01,090
number one thing if we asked they say

639
00:34:01,090 --> 00:34:05,000
no blood Powershot app Locker again you
we kinda we went really fast over the

640
00:34:05,000 --> 00:34:07,070
stuff but the key with automation de lo

641
00:34:07,070 --> 00:34:11,640
is that ourselves essentially a wrapper
for dotnet even if you enroll PowerShell

642
00:34:11,640 --> 00:34:13,230
that he exceeded ap Walker

643
00:34:13,230 --> 00:34:17,460
you don't stop the ability to run
PowerShell Co I was kinda big point have

644
00:34:17,460 --> 00:34:18,500
all the power fixed up

645
00:34:18,500 --> 00:34:22,010
the automation deal on the back end on a
mission to ninety allow

646
00:34:22,010 --> 00:34:25,640
actually what runs all those components
that you can load up that the loan to

647
00:34:25,640 --> 00:34:27,140
another process whether through

648
00:34:27,140 --> 00:34:30,370
a C sharp minor with the PS and check
stuff then

649
00:34:30,370 --> 00:34:33,630
you're not actually stop and we like to
say another defense flight is like

650
00:34:33,630 --> 00:34:34,320
obviously

651
00:34:34,320 --> 00:34:37,870
it says the perfectly on

652
00:34:37,870 --> 00:34:42,120
ourselves brokered a memory after so if
you import a script in PowerShell

653
00:34:42,120 --> 00:34:45,590
you don't the memory space that process
you have the roster so nothing nada

654
00:34:45,590 --> 00:34:48,460
going on here actually makes a really
good for reading environment we're

655
00:34:48,460 --> 00:34:52,930
trying to train and responders it's not
some magic that impossible discover

656
00:34:52,930 --> 00:34:53,760
what's going on

657
00:34:53,760 --> 00:34:57,470
but it's magic enough to make it make
them work for an actually you memory and

658
00:34:57,470 --> 00:34:58,050
spot

659
00:34:58,050 --> 00:35:01,150
I'm which is what we're trying to push
our our customers

660
00:35:01,150 --> 00:35:04,270
on major you there's no that next up and
just all

661
00:35:04,270 --> 00:35:08,040
the run-up a lesser log highlight on me
like actually take the time to analyze

662
00:35:08,040 --> 00:35:08,630
memory

663
00:35:08,630 --> 00:35:12,880
figure out what's going on and implement
signatures based on there's no reversing

664
00:35:12,880 --> 00:35:15,960
with any kinda like this powerful stuff
if they don't the memory space you can

665
00:35:15,960 --> 00:35:16,350
get

666
00:35:16,350 --> 00:35:19,620
everything that was wrong so really cool
colonel training

667
00:35:19,620 --> 00:35:24,810
quite make about our real World Hockey
make a real difference so we're gonna

668
00:35:24,810 --> 00:35:28,460
stop in a couple different demos we
might start with just the demo for

669
00:35:28,460 --> 00:35:35,460
individual up

670
00:35:40,650 --> 00:35:43,800
with orders are in power reach I and
we're gonna demo three-minute for back

671
00:35:43,800 --> 00:35:46,810
door as we talk about all three of them
basically run a show here that I have my

672
00:35:46,810 --> 00:35:47,780
alley system

673
00:35:47,780 --> 00:35:51,690
I have Apache started and I have a
powershell script

674
00:35:51,690 --> 00:35:56,170
are basically popped a message box
anything coated in basically for my web

675
00:35:56,170 --> 00:35:57,640
servers with available remotely

676
00:35:57,640 --> 00:36:01,190
super small the first runner to do with
the event log back door so you can see

677
00:36:01,190 --> 00:36:04,090
our star the event log back door looking
for the user name a packer

678
00:36:04,090 --> 00:36:07,120
and so I'm gonna pop a little are to
stop on my calendar sheen

679
00:36:07,120 --> 00:36:10,240
and we're gonna wait for the event log
back door to trigger it actually fleet

680
00:36:10,240 --> 00:36:11,560
for certain amount of time so the

681
00:36:11,560 --> 00:36:15,280
over talked with the summer thought you
know if the on obviously to watch prop

682
00:36:15,280 --> 00:36:18,450
Mon or something the events occurring
tonight wanna do it like every second

683
00:36:18,450 --> 00:36:20,780
and whatever it sees the actual

684
00:36:20,780 --> 00:36:24,670
event occur you're gonna see it trip of
a whole bunch over both information from

685
00:36:24,670 --> 00:36:26,060
running you know when they were both

686
00:36:26,060 --> 00:36:30,510
and then you're gonna see a call home
until should be a message box that's

687
00:36:30,510 --> 00:36:31,470
back door number one

688
00:36:31,470 --> 00:36:35,960
I can remember to you we're gonna do the
dead use our back door

689
00:36:35,960 --> 00:36:40,290
this backdoor thankfully again looking
for the present the user doesn't exist

690
00:36:40,290 --> 00:36:43,340
die I don't have the user place to start
to show you that

691
00:36:43,340 --> 00:36:47,140
backdoor backward we're gonna come to
another prop we're gonna at the user

692
00:36:47,140 --> 00:36:54,140
at Frank really really bad my manager
and then we're going to actually start

693
00:36:54,250 --> 00:36:55,280
the back to work again

694
00:36:55,280 --> 00:36:59,340
and you're gonna see that's it's because
the users there an hour to simulate and

695
00:36:59,340 --> 00:37:03,810
never defender blocking that user or
deleting a user of

696
00:37:03,810 --> 00:37:06,930
it could be either the local system or
the domain controller real functions for

697
00:37:06,930 --> 00:37:07,970
both there's a fly again

698
00:37:07,970 --> 00:37:12,440
%uh that your back door but if I don't
mean whenever the poll interval happened

699
00:37:12,440 --> 00:37:14,170
you're gonna see another message
stockpile

700
00:37:14,170 --> 00:37:17,840
a message box is that what you do on a
gauge right make

701
00:37:17,840 --> 00:37:21,150
like popping Cal you might yet the cop
in calcutta that way

702
00:37:21,150 --> 00:37:26,000
you might use it to a I donald of the
system remind you that you and i really

703
00:37:26,000 --> 00:37:28,540
gave me my you the call home to pick up
a secondary

704
00:37:28,540 --> 00:37:32,700
Metasploit payload I'm and inject a
martyr for using like ago

705
00:37:32,700 --> 00:37:36,030
or something and the final act or
respond is really good

706
00:37:36,030 --> 00:37:39,700
sorry respond a I the phone on back door
the raw socket

707
00:37:39,700 --> 00:37:42,990
and we came over to our Cali links
machine and we ran a little controller

708
00:37:42,990 --> 00:37:46,000
code that I included in the rebound
adjust and one you the packet

709
00:37:46,000 --> 00:37:47,560
which caused up to

710
00:37:47,560 --> 00:37:54,560
her

711
00:37:54,829 --> 00:37:56,200
alive yeah

712
00:37:56,200 --> 00:38:00,539
so rated the demo gods that we have
their it actually works is about fifty

713
00:38:00,539 --> 00:38:01,839
moving parcels

714
00:38:01,839 --> 00:38:06,119
so we have a videotape available now if
we mess up we

715
00:38:06,119 --> 00:38:12,430
yeah we've learned okay and so we're
going to start my basically showing who

716
00:38:12,430 --> 00:38:15,230
you are as a user and we're going to
show you that he is not part of the

717
00:38:15,230 --> 00:38:16,349
local measures for

718
00:38:16,349 --> 00:38:23,349
we're starting from a non-public contact
on a local system our show

719
00:38:24,109 --> 00:38:27,519
a lot on a power shower favor and talk
by Rep

720
00:38:27,519 --> 00:38:33,009
or ask you what we call the download
credo it's basically a method to

721
00:38:33,009 --> 00:38:38,359
executing code that comes from a
download or

722
00:38:38,359 --> 00:38:43,240
there were some UN if we had no eye
contact or cat already come loaded up on

723
00:38:43,240 --> 00:38:44,579
an external jump server

724
00:38:44,579 --> 00:38:48,249
and again we're not using agent on here
you know we're doing everything neatly

725
00:38:48,249 --> 00:38:53,069
right now there's on their several tools
that I had a partial script that all

726
00:38:53,069 --> 00:38:54,019
loaded up now

727
00:38:54,019 --> 00:39:00,869
one on system thread doing ok I'll check
for power up little basically look at

728
00:39:00,869 --> 00:39:03,019
all the different methods a privilege
escalation

729
00:39:03,019 --> 00:39:06,119
you'll see a couple here specifically
the service user

730
00:39:06,119 --> 00:39:09,460
add and the path the law

731
00:39:09,460 --> 00:39:12,900
hijack the service actually is much
easier to exploit and if you don't have

732
00:39:12,900 --> 00:39:14,420
to do any removing anything

733
00:39:14,420 --> 00:39:17,749
so we're gonna system without a quick
tour & ok service at

734
00:39:17,749 --> 00:39:24,749
actually that justly from our building
got them

735
00:39:25,089 --> 00:39:32,089
user name

736
00:39:32,390 --> 00:39:35,079
this will actually create a service
actually feel more hot Packers over

737
00:39:35,079 --> 00:39:36,070
there was this is

738
00:39:36,070 --> 00:39:41,040
the bottle sources of all

739
00:39:41,040 --> 00:39:44,280
at the user to local measures for
directly

740
00:39:44,280 --> 00:39:48,570
and so now you should see where local
admin

741
00:39:48,570 --> 00:39:53,099
a profess though the next

742
00:39:53,099 --> 00:39:58,160
run as an admin

743
00:39:58,160 --> 00:40:03,310
admin compensate them bypassed you see
all that

744
00:40:03,310 --> 00:40:09,650
organ executors download credo getting
that new

745
00:40:09,650 --> 00:40:12,869
this new session the region are talking
back in the memory and as an admin

746
00:40:12,869 --> 00:40:13,530
contact

747
00:40:13,530 --> 00:40:20,530
now we'll add it all up in the memory

748
00:40:23,130 --> 00:40:26,280
and we're gonna find

749
00:40:26,280 --> 00:40:30,109
all work stations on the local network
that where we where our current user has

750
00:40:30,109 --> 00:40:31,400
local admin access

751
00:40:31,400 --> 00:40:35,359
this will actually go system the system
and check what we're able to access on

752
00:40:35,359 --> 00:40:36,119
that system

753
00:40:36,119 --> 00:40:39,609
the SB so you'll see them these two
different systems

754
00:40:39,609 --> 00:40:45,170
on being yourself is the is the targets
in which we have local admin access and

755
00:40:45,170 --> 00:40:48,140
now we're gonna move on to targeting not
system at the local administrator

756
00:40:48,140 --> 00:40:52,240
we're gonna do this using both passing
the cats were I think that system we're

757
00:40:52,240 --> 00:40:53,349
gonna dump point extra

758
00:40:53,349 --> 00:41:00,349
take the second actually initiates the
web server so it ended up buying through

759
00:41:00,780 --> 00:41:01,510
local poor

760
00:41:01,510 --> 00:41:04,990
serves up both the file and wait for the
post responses

761
00:41:04,990 --> 00:41:08,359
to come in with the credential a column
about a minute

762
00:41:08,359 --> 00:41:12,300
execute it depends yeah like the the
time inside a condom in this way if

763
00:41:12,300 --> 00:41:13,680
you're running on mars number

764
00:41:13,680 --> 00:41:20,680
machine to try to take spacing between
each one sister stop

765
00:41:21,790 --> 00:41:24,600
with the Lord are

766
00:41:24,600 --> 00:41:31,600
think about a hundred what's going on
right now is it actually served up a

767
00:41:31,900 --> 00:41:35,450
using W my call the download cradle to
come back for a local server

768
00:41:35,450 --> 00:41:39,020
all in both math invoking a cat script
execute it

769
00:41:39,020 --> 00:41:42,090
and posters all thou here

770
00:41:42,090 --> 00:41:45,940
iraq it also gives you hell now we're
going to use up after that we just don't

771
00:41:45,940 --> 00:41:47,560
belong in the system with RT

772
00:41:47,560 --> 00:41:51,920
a super-secret Rd we find all the time

773
00:41:51,920 --> 00:41:56,650
where all our interactive on that system

774
00:41:56,650 --> 00:42:01,780
Republic of anger so you can see the

775
00:42:01,780 --> 00:42:06,070
injection part coming in order to start
up a command propping up our show up

776
00:42:06,070 --> 00:42:07,910
again so an hour on a remote system

777
00:42:07,910 --> 00:42:11,750
we just got access to a our view

778
00:42:11,750 --> 00:42:16,510
had a credential for power up and we're
gonna download this time we're gonna

779
00:42:16,510 --> 00:42:18,210
download the PSN Jack

780
00:42:18,210 --> 00:42:25,210
script in memory

781
00:42:30,830 --> 00:42:31,920
work

782
00:42:31,920 --> 00:42:33,290
you

783
00:42:33,290 --> 00:42:36,760
as an hour gonna execute a PS injects
crap to inject into

784
00:42:36,760 --> 00:42:40,110
first work

785
00:42:40,110 --> 00:42:44,340
all checked in the VMware Tools and when
we inject this

786
00:42:44,340 --> 00:42:48,460
appears injecting to be more toward the
cycling and execute another download

787
00:42:48,460 --> 00:42:52,680
and Paul the secondary stager we're
serving up here when you're gonna see is

788
00:42:52,680 --> 00:42:54,440
reserve a power reach back door

789
00:42:54,440 --> 00:42:57,550
and so were simulating right now if we
were leaving the system for a long

790
00:42:57,550 --> 00:42:58,590
period of time

791
00:42:58,590 --> 00:43:01,700
and planning on coming back later to
retrieve whatever we needed

792
00:43:01,700 --> 00:43:06,230
doesn't want to embrace upload all the
required DLL

793
00:43:06,230 --> 00:43:10,970
and injector for this is where real
demagogue the company either

794
00:43:10,970 --> 00:43:16,430
so you see here now there's no partial
running all

795
00:43:16,430 --> 00:43:19,770
and we're point 0

796
00:43:19,770 --> 00:43:23,500
also here with us are going to be
running so on

797
00:43:23,500 --> 00:43:27,440
this is a script that we actually served
up so its power breach

798
00:43:27,440 --> 00:43:31,410
with just a single command at the end
actually run the specific model that you

799
00:43:31,410 --> 00:43:32,090
want to run

800
00:43:32,090 --> 00:43:36,060
so this is a domain controller and

801
00:43:36,060 --> 00:43:39,070
we're sitting here now that answer
funders have caught us

802
00:43:39,070 --> 00:43:42,280
and that they're going to lead our back
door user cleverly came back door

803
00:43:42,280 --> 00:43:47,280
and hopefully we have happened is a
shell pop-up

804
00:43:47,280 --> 00:43:52,650
we have to wait for the whole animal
obviously if so could take some time

805
00:43:52,650 --> 00:43:56,190
if not I'll give you a pretty damn well
on a video fair

806
00:43:56,190 --> 00:44:00,020
a so that was triggered simply because
the answer spawners believe that our

807
00:44:00,020 --> 00:44:00,680
back door

808
00:44:00,680 --> 00:44:04,900
now we have interpreter shell on the
system may be on the domain admin system

809
00:44:04,900 --> 00:44:07,470
that would allow it to go in Iraq again
readmore

810
00:44:07,470 --> 00:44:14,470
implement I'm back toward

811
00:44:16,780 --> 00:44:18,710
and so if you to contact info where

812
00:44:18,710 --> 00:44:21,780
were super open to chatting all the
stuff we love we had like a community

813
00:44:21,780 --> 00:44:23,940
participation at all and you have other
today

814
00:44:23,940 --> 00:44:27,620
and so people have ideas for Collado
local actions definitely go check it out

815
00:44:27,620 --> 00:44:28,410
and I'll

816
00:44:28,410 --> 00:44:31,940
summit for questioning we love for
people to help out orchards have

817
00:44:31,940 --> 00:44:34,850
questions about how to use at your own
operation on an engagement you're like

818
00:44:34,850 --> 00:44:35,340
me and I'm

819
00:44:35,340 --> 00:44:39,590
can feed even is not working trying to
use your tallest tower in please reach

820
00:44:39,590 --> 00:44:41,460
out we satire see in the

821
00:44:41,460 --> 00:44:44,600
the veil channel as well as armitage on
and we're

822
00:44:44,600 --> 00:44:47,140
were pretty re and will be in the
hallway for love it right after this in

823
00:44:47,140 --> 00:44:48,430
case we wanna talk of wine

824
00:44:48,430 --> 00:44:55,430
you know

825
00:44:56,620 --> 00:45:01,180
yeah I mean unless you so eminent are
the question was do the script work

826
00:45:01,180 --> 00:45:01,560
against

827
00:45:01,560 --> 00:45:05,750
I met so by default I'm a dozen more
power shown covers not a normal initial

828
00:45:05,750 --> 00:45:09,140
exploitation backers emits an online
design to

829
00:45:09,140 --> 00:45:12,390
blocked those initial exploitation
components to get into a system

830
00:45:12,390 --> 00:45:15,990
it's not going to stop post exploitation
we have done a little bit have

831
00:45:15,990 --> 00:45:19,590
our experiment with and and rowing
PowerShell and a mint which in stop

832
00:45:19,590 --> 00:45:20,950
things like choker injection

833
00:45:20,950 --> 00:45:25,690
for like RPS is that psh but for all
these kind of actions as hijacking shoko

834
00:45:25,690 --> 00:45:29,510
to those brought chain components are
can I come into it there's no memory car

835
00:45:29,510 --> 00:45:33,360
corruption talking to injection so far
as we know we've done extensive testing

836
00:45:33,360 --> 00:45:33,750
but

837
00:45:33,750 --> 00:45:40,750
don't think there should be stopping I

838
00:45:46,900 --> 00:45:47,630
signing

839
00:45:47,630 --> 00:45:50,770
so the question is have we Karen
environment where sin is required for

840
00:45:50,770 --> 00:45:51,660
PowerShell scripts

841
00:45:51,660 --> 00:45:55,420
so signing is not a security boundary
people think it is

842
00:45:55,420 --> 00:45:58,420
so even if you require sign in when you
launch PowerShell

843
00:45:58,420 --> 00:46:01,510
you do dash exact bypass it turns off
all the signing requirements

844
00:46:01,510 --> 00:46:05,280
and actually here we don't even care
about doing exactly I haz

845
00:46:05,280 --> 00:46:08,440
you did you do that little that only
matters if you're loading

846
00:46:08,440 --> 00:46:12,160
ps1 scripts of the machine like you know
into the into the process

847
00:46:12,160 --> 00:46:15,490
so if you do that low I X down one
cradle from a different location

848
00:46:15,490 --> 00:46:18,559
execution policy doesn't come into play

849
00:46:18,559 --> 00:46:22,220
any way whatsoever so and thinking
Microsoft for doing something execution

850
00:46:22,220 --> 00:46:24,859
policy in the doing of like that says
turn of execution

851
00:46:24,859 --> 00:46:28,890
at totally makes sense I mean it
everyone Iran people get confused the

852
00:46:28,890 --> 00:46:30,020
salon admits think

853
00:46:30,020 --> 00:46:34,430
I'm Securities Act signing its
absolutely not security down during any

854
00:46:34,430 --> 00:46:38,790
way whatsoever and its current
implementation any magic power Schottky

855
00:46:38,790 --> 00:46:42,599
or something actually do it correctly in
a question

856
00:46:42,599 --> 00:46:47,069
cool find a topic gonna go here

857
00:46:47,069 --> 00:46:48,020
yep thank you

