1
00:00:00,970 --> 00:00:05,819
make news thank you thank you thank you
I have taken in about 10 say of their

2
00:00:05,819 --> 00:00:10,970
take that off I alright well thanks for
comin

3
00:00:10,970 --> 00:00:15,540
looks like a tranquilize the field
sparse crowd people it's must be third a

4
00:00:15,540 --> 00:00:16,730
right there they can

5
00:00:16,730 --> 00:00:20,220
people kinda tired curtain

6
00:00:20,220 --> 00:00:23,429
year

7
00:00:23,429 --> 00:00:28,060
year where and other two hours to
recover afterwards probably depending on

8
00:00:28,060 --> 00:00:28,739
which a

9
00:00:28,739 --> 00:00:31,970
for me anymore so

10
00:00:31,970 --> 00:00:35,280
I was gonna jump right in and i got I
got some fun stuff to give away

11
00:00:35,280 --> 00:00:40,710
I am my company sends me out with these
little things I'm not even sure what to

12
00:00:40,710 --> 00:00:43,720
think about but it's a little bug stuck
in a sec grants can supposed to

13
00:00:43,720 --> 00:00:46,100
represent Canada Mauer's trapped in

14
00:00:46,100 --> 00:00:49,520
wanna technology that we created
problems are more I wants a lot about

15
00:00:49,520 --> 00:00:52,540
them but I might throw an anti a badass
questions and you can you're brave

16
00:00:52,540 --> 00:00:55,100
enough to answer out aspin and I'll
leave a whole bunch down here if you

17
00:00:55,100 --> 00:00:56,410
want someone is gonna leave here

18
00:00:56,410 --> 00:01:00,140
freedom I am does anybody know

19
00:01:00,140 --> 00:01:04,860
the name in a class I teach in black at
is brave enough to say anything

20
00:01:04,860 --> 00:01:09,770
like to say blah blah I

21
00:01:09,770 --> 00:01:14,860
I he's at it yeah are now it's called
applications caper hackers and

22
00:01:14,860 --> 00:01:15,550
developers

23
00:01:15,550 --> 00:01:19,520
and I go over five innings or scarring
reverse engineer explain development

24
00:01:19,520 --> 00:01:22,320
stuff like that said anything about
taking a class a bike at this year

25
00:01:22,320 --> 00:01:25,590
on that's kinda wanna the random trivia

26
00:01:25,590 --> 00:01:30,810
fax I guess about me on does anybody
have a gas

27
00:01:30,810 --> 00:01:35,799
where and when I gave my first talk in a
conference start a gas

28
00:01:35,799 --> 00:01:42,799
I am I remember the number but yeah I
was def can years ago

29
00:01:43,430 --> 00:01:46,640
I 2000 five or something like that sell

30
00:01:46,640 --> 00:01:50,130
a while ago I guess so anyway enough
about me

31
00:01:50,130 --> 00:01:53,549
on I'll do I would like to point out

32
00:01:53,549 --> 00:01:56,560
amis my laser pointer somebody special
in the back right away

33
00:01:56,560 --> 00:01:59,900
back there I actually get my wife to
come and listen to me is the first time

34
00:01:59,900 --> 00:02:02,080
she's coming listen to it I can I have
ever

35
00:02:02,080 --> 00:02:07,970
I've done so you're a given up for my
wife until around trying to bear sir

36
00:02:07,970 --> 00:02:12,319
you now because I even though I'm a
security researcher how many you know if

37
00:02:12,319 --> 00:02:13,830
you work in technology

38
00:02:13,830 --> 00:02:17,930
you end up as somebody's like personal
printer repair man or something like

39
00:02:17,930 --> 00:02:20,740
that kinda what I am in the house at
home I'll I says I can't get the

40
00:02:20,740 --> 00:02:21,760
computer to print

41
00:02:21,760 --> 00:02:25,260
or whatever and I'm like I don't know
what's going on with you

42
00:02:25,260 --> 00:02:28,470
it worked for me they were I was fine

43
00:02:28,470 --> 00:02:31,750
but in now it's not so anyway I am

44
00:02:31,750 --> 00:02:34,810
yeah I'm sure you guys at have had that
issue

45
00:02:34,810 --> 00:02:38,180
or that joined by anyway I'm

46
00:02:38,180 --> 00:02:41,620
give me a little background on this
project I am

47
00:02:41,620 --> 00:02:47,910
2012 Microsoft did a contest called the
blue half price contest many people

48
00:02:47,910 --> 00:02:48,730
heard about that

49
00:02:48,730 --> 00:02:52,050
in here about that if you if you you
heard about that and I decided to enter

50
00:02:52,050 --> 00:02:54,870
that I thought to be fine the kennedy
something the defense & space because

51
00:02:54,870 --> 00:02:55,590
the the

52
00:02:55,590 --> 00:02:59,500
idea with the contest was whoever can
come up with the

53
00:02:59,500 --> 00:03:03,010
best you like memory corruption

54
00:03:03,010 --> 00:03:06,870
exploit prevention to a technology
basically how to stop rob was kinda

55
00:03:06,870 --> 00:03:07,450
really what

56
00:03:07,450 --> 00:03:10,050
what I think they were trying again
that's that's what my protection was it

57
00:03:10,050 --> 00:03:13,160
was so I submitted an idea Microsoft's
on

58
00:03:13,160 --> 00:03:16,849
on you know I can technological idea it
would approve a concept in some code in

59
00:03:16,849 --> 00:03:18,840
a paper in separate spending how I would

60
00:03:18,840 --> 00:03:22,099
you know make tweaks to the operating
system to stop

61
00:03:22,099 --> 00:03:27,590
this this II packard's plate known as
Robert stanza returning programming

62
00:03:27,590 --> 00:03:31,890
on and mine actually I got selected one
of three finalists

63
00:03:31,890 --> 00:03:35,730
and they wouldn't tell you though if you
like first play second place third place

64
00:03:35,730 --> 00:03:38,310
in the cat made a big difference in the
first place want winner

65
00:03:38,310 --> 00:03:41,500
got a nice prize in the third place
winner which is what I ended up as

66
00:03:41,500 --> 00:03:45,790
didn't gotta get a prize that was a very
good prize been a way it was still fun

67
00:03:45,790 --> 00:03:49,890
to be a part of the NBN you know they
they took this holiday is and everything

68
00:03:49,890 --> 00:03:50,480
like that

69
00:03:50,480 --> 00:03:54,159
announced to the winner was a couple
years back sir anyway long story short

70
00:03:54,159 --> 00:03:56,390
the reason I give you their background
is

71
00:03:56,390 --> 00:03:59,530
on the second place winner his ideas are
what

72
00:03:59,530 --> 00:04:03,250
mostly made it into and as far as the
five crop protection so

73
00:04:03,250 --> 00:04:08,030
a.m. EDT does two things: three really
but a couple hours I'll talk about

74
00:04:08,030 --> 00:04:12,930
in parted it basically choices if you
start like am an older like XP back sick

75
00:04:12,930 --> 00:04:14,400
and it brings the XP back

76
00:04:14,400 --> 00:04:17,970
up to sort a win7 standards by forcing a
SORN DEP

77
00:04:17,970 --> 00:04:21,510
on all the processes that may not have
it they were compiled with the ever so

78
00:04:21,510 --> 00:04:22,380
that's wonderful

79
00:04:22,380 --> 00:04:26,340
arm this talk is not a.m. EDT bashing
talk by the way I did come up with ways

80
00:04:26,340 --> 00:04:28,199
to bypass all the protections but

81
00:04:28,199 --> 00:04:32,169
its I think I still think it's it's free
tool so I'm not like down and raining I

82
00:04:32,169 --> 00:04:35,090
guess they don't take that away from the
stock that's not what I'm here talking

83
00:04:35,090 --> 00:04:38,710
I'm not trying to say that it's better
it's great but you know like India and

84
00:04:38,710 --> 00:04:40,060
I'll explain why

85
00:04:40,060 --> 00:04:43,270
it has certain architectural imitation
but anyway

86
00:04:43,270 --> 00:04:46,780
army side so there's 12 till protections
in rapid-fire

87
00:04:46,780 --> 00:04:50,260
in Emmett in five of them are specific
to rock these ones

88
00:04:50,260 --> 00:04:54,180
I think in the end this man prague
callers stacked

89
00:04:54,180 --> 00:04:58,210
whatever I can even read it sells more
units by Carrie from the back but

90
00:04:58,210 --> 00:05:01,440
are below average miles by basically how
to bypass each one

91
00:05:01,440 --> 00:05:06,150
but on I kinda started this project is
is sort of like it well

92
00:05:06,150 --> 00:05:10,130
my my idea didn't make it into the tools
I wonder how hard it would be to beat up

93
00:05:10,130 --> 00:05:13,810
you know the second place winners idea
that made it and its okay that's I kinda

94
00:05:13,810 --> 00:05:17,610
had a personal motivation the so to beat
up on this a little bit

95
00:05:17,610 --> 00:05:22,680
China as sort of a maybe you should pick
me up his first place Cara I had fun

96
00:05:22,680 --> 00:05:23,630
with it

97
00:05:23,630 --> 00:05:26,870
I kinda had a little bit of fun with
their so I am

98
00:05:26,870 --> 00:05:29,960
but you know to do the right thing to do
this project in November

99
00:05:29,960 --> 00:05:34,820
up 2013 and gave the results Microsoft
at the start of the year

100
00:05:34,820 --> 00:05:38,930
December relay at 513 cell they had like
three mines to

101
00:05:38,930 --> 00:05:42,479
try to upgrade and that before I started
talking about this publicly around Rs a

102
00:05:42,479 --> 00:05:42,940
time

103
00:05:42,940 --> 00:05:47,590
February so arm did the right thing in
terms are responsible disclosure and

104
00:05:47,590 --> 00:05:50,060
everything like that so

105
00:05:50,060 --> 00:05:53,320
that i think is good and worked well
they were they were fine to work with

106
00:05:53,320 --> 00:05:56,430
and and so that was that was good

107
00:05:56,430 --> 00:05:59,520
and they did actually make some changes
based on his research by well talk about

108
00:05:59,520 --> 00:06:00,990
that

109
00:06:00,990 --> 00:06:04,500
they're easy release to 5.0 tech preview
at the same time I start talking about

110
00:06:04,500 --> 00:06:05,410
it arce

111
00:06:05,410 --> 00:06:09,110
account like corn and their release or
whatever some

112
00:06:09,110 --> 00:06:12,940
sorta kinda start the project I said all
right let me try met Metasploit which is

113
00:06:12,940 --> 00:06:14,610
you know as you guys know in their

114
00:06:14,610 --> 00:06:18,729
like them main Penn testers framework or
whatever

115
00:06:18,729 --> 00:06:22,310
maniskas it's free and stuff like that
and just start by

116
00:06:22,310 --> 00:06:25,930
if I have on a machine and I have a
working exploit

117
00:06:25,930 --> 00:06:28,979
it works okay so I started with that
said the assumption

118
00:06:28,979 --> 00:06:32,789
the starting assumption is and I i have
a I have a working exploit that

119
00:06:32,789 --> 00:06:36,020
actually works but then I installed a.m.
et

120
00:06:36,020 --> 00:06:39,729
and now it doesn't work so that's kinda
my my focus is not necessarily on

121
00:06:39,729 --> 00:06:43,539
writing the new exploit are finding
anybody would ever to exploit its more

122
00:06:43,539 --> 00:06:47,009
upgrading a working exploit to also
bypass and that's kinda that was the

123
00:06:47,009 --> 00:06:47,930
focus

124
00:06:47,930 --> 00:06:51,650
okay and so this little guy he said

125
00:06:51,650 --> 00:06:55,000
oranges orange is the color might come
as my company colors everything's kinda

126
00:06:55,000 --> 00:06:56,770
oranges to follow that theme

127
00:06:56,770 --> 00:07:00,470
when I can I tried the standard
Metasploit payload

128
00:07:00,470 --> 00:07:04,910
emmitt blacks those on for a couple main
reasons first bar

129
00:07:04,910 --> 00:07:08,240
the browser exploits that are in
Metasploit are very good

130
00:07:08,240 --> 00:07:11,949
because they cannot depend on like older

131
00:07:11,949 --> 00:07:15,690
techniques to bypass is lined up like
they data hand

132
00:07:15,690 --> 00:07:20,500
on a DLL that's at a fixed location it
wasn't compile lists are densely

133
00:07:20,500 --> 00:07:22,009
essentially she'd

134
00:07:22,009 --> 00:07:26,030
to bite his SR so I really have to do is
for Cecil R

135
00:07:26,030 --> 00:07:30,990
and breaks Canada the free exploits as
it is as it is anyway so

136
00:07:30,990 --> 00:07:35,130
but even if that weren't the case and it
would still stop

137
00:07:35,130 --> 00:07:38,949
the Rob based exploits because those
special 5 I'm

138
00:07:38,949 --> 00:07:42,270
right medications that are inside and so

139
00:07:42,270 --> 00:07:45,789
to to you know to be clear even know

140
00:07:45,789 --> 00:07:49,169
you know I found ways to upgrade an
exploit to bypass and

141
00:07:49,169 --> 00:07:52,990
emmitt stops like 90 eight-percent
everything that's out there because

142
00:07:52,990 --> 00:07:53,789
although

143
00:07:53,789 --> 00:07:58,080
sorta public domain exploits have can a
well-known techniques in terms of how

144
00:07:58,080 --> 00:07:59,800
they do they're Rob and stuff

145
00:07:59,800 --> 00:08:04,099
in and it was kinda bill with that in
mind so it sorta shut those down call

146
00:08:04,099 --> 00:08:09,470
right so that's good other was sad for
me because I was trying to bypass it

147
00:08:09,470 --> 00:08:13,479
so if you find yourself right making
powerpoints incinerating code you gotta

148
00:08:13,479 --> 00:08:16,599
try to come up with funny pictures I
know that everybody but

149
00:08:16,599 --> 00:08:20,169
at im used me when I was when I was
raining so the

150
00:08:20,169 --> 00:08:23,889
five key rat mitigations is what we'll
talk about

151
00:08:23,889 --> 00:08:27,759
and as I restated the assumption is that
we have a good buy

152
00:08:27,759 --> 00:08:30,880
and what I do when I was first trying to
bypass

153
00:08:30,880 --> 00:08:34,860
each 125 is I can to bypass them each in
serve isolationists

154
00:08:34,860 --> 00:08:37,969
contrived toy programs so I use this MS

155
00:08:37,969 --> 00:08:41,569
VCRs everyone that they are as my text
idea well

156
00:08:41,569 --> 00:08:44,850
it was an unknown location it's I didn't
have to worry about it and so I was just

157
00:08:44,850 --> 00:08:47,139
trying to bypass the rock negations

158
00:08:47,139 --> 00:08:50,550
so I can she did in my can try programs
and then later

159
00:08:50,550 --> 00:08:53,809
for the real world example at the end I
i'm

160
00:08:53,809 --> 00:08:57,989
dynamically find a base address a venti
deal I'll and create a rock chain

161
00:08:57,989 --> 00:09:02,899
and everything like that I'll which I'll
explain those terms I guess in a second

162
00:09:02,899 --> 00:09:05,019
real quick I have time to talk about

163
00:09:05,019 --> 00:09:08,439
10 years I've exploit history and I
don't think I'm going to Olive but I'll

164
00:09:08,439 --> 00:09:09,579
explain

165
00:09:09,579 --> 00:09:14,019
stagnating engine rock changed several
quick in just a second

166
00:09:14,019 --> 00:09:17,199
so the first time the

167
00:09:17,199 --> 00:09:20,350
5 propagation call caller

168
00:09:20,350 --> 00:09:23,899
and know what that does is basically

169
00:09:23,899 --> 00:09:27,290
when certain key or critical

170
00:09:27,290 --> 00:09:32,470
API's which are functions that the
operating system provides are called

171
00:09:32,470 --> 00:09:35,739
and there's about 50 upon that and it's
configurable that Microsoft is deemed as

172
00:09:35,739 --> 00:09:37,300
these are sort of critical

173
00:09:37,300 --> 00:09:41,139
when those are call then certain things
are check

174
00:09:41,139 --> 00:09:44,360
okay and sell

175
00:09:44,360 --> 00:09:47,439
even as I get into the technical bits
and bytes in the TOC you don't

176
00:09:47,439 --> 00:09:47,920
understand

177
00:09:47,920 --> 00:09:51,689
anything I'm talking about you can at
least understand from a high-level

178
00:09:51,689 --> 00:09:55,519
that there's kinda two main problems

179
00:09:55,519 --> 00:09:59,839
with the protection in general they have
a lot of benefits and pros and cons to

180
00:09:59,839 --> 00:10:02,670
like it's quick and it's bass and
installs an old stuff that you want to

181
00:10:02,670 --> 00:10:04,589
recompile Scala batted

182
00:10:04,589 --> 00:10:08,559
but it's got some drawbacks into it
those are the fact that

183
00:10:08,559 --> 00:10:11,809
really and it is basically just a DLL
that is injected

184
00:10:11,809 --> 00:10:15,179
you know running process okay and an
exploit

185
00:10:15,179 --> 00:10:18,749
is code it's injected into a running
process so there

186
00:10:18,749 --> 00:10:22,369
competing on a level ground right to
architecturally

187
00:10:22,369 --> 00:10:26,279
this defense in you know you don't need
a kernel exploit to get out at a young

188
00:10:26,279 --> 00:10:28,980
age hypervisor exploit to break out in a
virtual machine you know

189
00:10:28,980 --> 00:10:32,610
you're already you're basically
competing on level ground so that's

190
00:10:32,610 --> 00:10:37,350
now really ideal arm in terms of an
architecturally sound protection if you

191
00:10:37,350 --> 00:10:39,369
understand what i'm talking about. but
it you know

192
00:10:39,369 --> 00:10:42,799
is better certainly better than nothin
so I'm that's one problem the other

193
00:10:42,799 --> 00:10:44,040
problem with these

194
00:10:44,040 --> 00:10:48,119
with what on with the second-place
winners ideas that get

195
00:10:48,119 --> 00:10:52,509
put in the AM is their they don't
actually stop rock

196
00:10:52,509 --> 00:10:57,059
they basically are heuristic checks at
key points

197
00:10:57,059 --> 00:11:01,529
so the analogy I can be used throughout
my talk is imagine

198
00:11:01,529 --> 00:11:05,689
you're kinda you know your going into a
country you're coming from your drive in

199
00:11:05,689 --> 00:11:08,790
from jordan israel or something like
that you got all kinda contraband in

200
00:11:08,790 --> 00:11:09,790
your car

201
00:11:09,790 --> 00:11:14,199
in as soon as you hit the border check
use gotta like stash it all

202
00:11:14,199 --> 00:11:17,040
you know is about to get checked that's
what's going to happen about to get

203
00:11:17,040 --> 00:11:17,699
checked

204
00:11:17,699 --> 00:11:21,519
when you hit a certain papi but then
before after that you can break it all

205
00:11:21,519 --> 00:11:23,939
back on me doing whatever you're doing
in the car okay

206
00:11:23,939 --> 00:11:27,850
so that's kinda my a sort of non techie
an Audi is best I could come up with I'm

207
00:11:27,850 --> 00:11:28,519
not really a

208
00:11:28,519 --> 00:11:31,709
analogy wizard that was something I
China

209
00:11:31,709 --> 00:11:34,879
come up with to explain kinda how this
collar check works

210
00:11:34,879 --> 00:11:38,519
okay and I I'll talk about it more but
first I wanted to show you but I can't

211
00:11:38,519 --> 00:11:41,649
read their real well in the back home

212
00:11:41,649 --> 00:11:45,949
if you go to our technical blog labs
doubt bro named acecomm you can download

213
00:11:45,949 --> 00:11:47,279
the whole white paper that

214
00:11:47,279 --> 00:11:50,699
goes into more the code if you wanna
kinda dig into the bits and bytes

215
00:11:50,699 --> 00:11:53,819
more than I have time to to sink Anna on

216
00:11:53,819 --> 00:11:56,559
and you can see a lot of other great
technical stuff that we blogged about it

217
00:11:56,559 --> 00:11:59,889
well this is just one thing that we
blogged about

218
00:11:59,889 --> 00:12:03,009
over the past a year and a half or
whatever

219
00:12:03,009 --> 00:12:07,009
so anyway this is just giving you can
have a picture of a typical rock change

220
00:12:07,009 --> 00:12:07,259
so

221
00:12:07,230 --> 00:12:10,299
Robin talking about their return REM
programming

222
00:12:10,299 --> 00:12:14,639
basically what that is that's kinda code
reuse attacked it became popular when

223
00:12:14,639 --> 00:12:18,470
debt became popular right so in the old
days of exploitation

224
00:12:18,470 --> 00:12:22,389
I had to do was injection show code on
the stack jump directly to and you can

225
00:12:22,389 --> 00:12:22,829
execute

226
00:12:22,829 --> 00:12:26,329
show right on the stack at hebrew
everywhere and then

227
00:12:26,329 --> 00:12:30,749
operating system maintainers prevent you
know security type people

228
00:12:30,749 --> 00:12:34,259
thought well you know if we can get
smart each memory pages

229
00:12:34,259 --> 00:12:38,869
as appropriately another word if a page
on the needs to be read write wise

230
00:12:38,869 --> 00:12:42,410
mark rewrite execute about let's remove
the execute women just mark them pages

231
00:12:42,410 --> 00:12:43,389
read/write

232
00:12:43,389 --> 00:12:47,189
in that prevents this whole category

233
00:12:47,189 --> 00:12:50,559
injecting in running code from a
particular page memory where should be

234
00:12:50,559 --> 00:12:51,899
okay

235
00:12:51,899 --> 00:12:55,749
and so then people in our kisses
cat-and-mouse game I would explain

236
00:12:55,749 --> 00:12:57,790
defense so then the attacker said well

237
00:12:57,790 --> 00:13:02,589
will just find a way to disable or
rename all the executed on that page

238
00:13:02,589 --> 00:13:05,339
whatever and that's kinda born all code
reuse

239
00:13:05,339 --> 00:13:09,660
right thing and that's basically what I
rock chain does is each one is the words

240
00:13:09,660 --> 00:13:13,029
so this is this is meant for 32-bit code
because and it doesn't really protect

241
00:13:13,029 --> 00:13:14,269
64-bit code

242
00:13:14,269 --> 00:13:18,179
the five projects are basically for 30
tunica I so that the work I did the

243
00:13:18,179 --> 00:13:19,179
30-minute

244
00:13:19,179 --> 00:13:22,689
so I wrote this in Python you can see my
rock gadgets equal

245
00:13:22,689 --> 00:13:26,109
opposed to just starting a string in
Python and Iraq gadgets plus equal

246
00:13:26,109 --> 00:13:27,739
struck that pack

247
00:13:27,739 --> 00:13:30,869
will less than at all and Anna D word so
what

248
00:13:30,869 --> 00:13:34,699
me know it struck top actors encoders in
here

249
00:13:34,699 --> 00:13:39,029
yes

250
00:13:39,029 --> 00:13:46,029
israeli all at their it but

251
00:13:53,600 --> 00:13:58,570
yes so you're taking this the word I
guess the the less than L is kinda the

252
00:13:58,570 --> 00:14:01,699
Kia what struck that packed as an imino
the less than elders

253
00:14:01,699 --> 00:14:05,600
some leeway that they're out thanks bro
fr

254
00:14:05,600 --> 00:14:08,899
in oh that was money

255
00:14:08,899 --> 00:14:12,160
come on that was a good throw at let's

256
00:14:12,160 --> 00:14:19,160
let's call that like it is

257
00:14:22,060 --> 00:14:24,920
right so that's the key so I wanna read
my address is

258
00:14:24,920 --> 00:14:27,839
left to right like you normally would
return address but when you actually

259
00:14:27,839 --> 00:14:29,160
create a string

260
00:14:29,160 --> 00:14:32,209
they need to go in reverse order so like
this it needs to be like

261
00:14:32,209 --> 00:14:36,860
80-72 3471 it needs to go in backwards
to this home while

262
00:14:36,860 --> 00:14:40,620
that I'm creating and I'm gonna deliver
to the Bonneville application right so

263
00:14:40,620 --> 00:14:43,170
you can use truck Tupac and that
reverses the byte order

264
00:14:43,170 --> 00:14:46,170
that's all it does simple little Python
tricks

265
00:14:46,170 --> 00:14:49,240
if you don't know pipe and this is great
it's makes it super easy to do this

266
00:14:49,240 --> 00:14:49,800
kinda stuff

267
00:14:49,800 --> 00:14:53,600
so you get this series d words and

268
00:14:53,600 --> 00:14:57,240
really with those are as those addresses
so in normal execution lawn

269
00:14:57,240 --> 00:15:01,449
your instruction pointer is moving
forward and your stack pointer is kinda

270
00:15:01,449 --> 00:15:02,870
up and down on the stack frame

271
00:15:02,870 --> 00:15:06,310
wherein drop world what we're doing is
we're returning

272
00:15:06,310 --> 00:15:10,180
to a series have the words are addresses
so your stack pointers like moving

273
00:15:10,180 --> 00:15:10,750
forward

274
00:15:10,750 --> 00:15:13,370
like your new construction point in
Armley winning instruction pointer is

275
00:15:13,370 --> 00:15:16,269
kinda all over place hit me nd the tail
and all these function

276
00:15:16,269 --> 00:15:20,050
was like push push rat pop pop Brett Bob
Lowry et

277
00:15:20,050 --> 00:15:23,209
blah blah right you're hitting all these
things in reading which when you read it

278
00:15:23,209 --> 00:15:24,190
when you return

279
00:15:24,190 --> 00:15:28,120
you you basically pop the next the word
of the stack and you move forward

280
00:15:28,120 --> 00:15:31,610
so that's kinda how and what you do the
whole point Iran chain is to basically

281
00:15:31,610 --> 00:15:32,540
remark

282
00:15:32,540 --> 00:15:36,130
the page that Iran is executed well and
then you com

283
00:15:36,130 --> 00:15:39,380
run your normal standard minutes but
pale or whatever so that's kinda how if

284
00:15:39,380 --> 00:15:40,050
you don't know

285
00:15:40,050 --> 00:15:43,370
if you've heard this term and nobody
took the time to

286
00:15:43,370 --> 00:15:47,110
you know take three seconds to explain
to you hopefully I just an open-ended

287
00:15:47,110 --> 00:15:50,949
so a few terms you know Robex player

288
00:15:50,949 --> 00:15:54,019
gadget where my thing go an Engadget

289
00:15:54,019 --> 00:15:58,300
chain and then one other thing is called
a stack payment is a male perspective it

290
00:15:58,300 --> 00:15:58,589
is

291
00:15:58,589 --> 00:16:04,630
as the thing you do right before you run
iraq chain merest activity brave so on

292
00:16:04,630 --> 00:16:05,800
take a guess at what I mean

293
00:16:05,800 --> 00:16:09,269
wait so long stack so

294
00:16:09,269 --> 00:16:14,120
if if your stack pointer is going to be
hit me twenties d words as you read the

295
00:16:14,120 --> 00:16:16,930
first thing you need to do is you need
to readjust your stack pointer to that

296
00:16:16,930 --> 00:16:19,459
it points to the same book is normally a
stack pointer is like

297
00:16:19,459 --> 00:16:23,399
in the stacks Mr in a pure malicious
input is this rock chain and that

298
00:16:23,399 --> 00:16:24,569
happens to be and he'd

299
00:16:24,569 --> 00:16:27,740
you basically need to pay the point in
the stack pointer to the heat

300
00:16:27,740 --> 00:16:30,699
first and then you run your app chain
and then you run your show character is

301
00:16:30,699 --> 00:16:32,079
kinda like three steps that

302
00:16:32,079 --> 00:16:35,620
process as Coast act itself anyhoo

303
00:16:35,620 --> 00:16:38,620
I am this seven-c_ address

304
00:16:38,620 --> 00:16:44,149
is basically going to college virtue I
like her order to protect

305
00:16:44,149 --> 00:16:47,350
or some protected critical API

306
00:16:47,350 --> 00:16:50,769
that and it's going to be watching
because that is the critical thing

307
00:16:50,769 --> 00:16:51,750
that's gonna remark

308
00:16:51,750 --> 00:16:54,949
changed paid commissions okay that's the
naughty thing we're about to do is call

309
00:16:54,949 --> 00:16:56,569
and we can to be doing what everyone

310
00:16:56,569 --> 00:17:00,559
Intel we call and then we're gonna get
checked at that point okay

311
00:17:00,559 --> 00:17:06,939
and that's our right to a job and so if
you do if you run that standard payload:

312
00:17:06,939 --> 00:17:08,179
that I just did

313
00:17:08,179 --> 00:17:12,400
I you'll see that in your bed viewer

314
00:17:12,400 --> 00:17:16,079
and Windows you'll see something like
when you try to call their

315
00:17:16,079 --> 00:17:21,890
kernel32 doubt virtual I like and it
busted this program bong ProGuide EXE

316
00:17:21,890 --> 00:17:26,100
be a the collar check which is the first
to the prior obligations on time right

317
00:17:26,100 --> 00:17:26,459
now

318
00:17:26,459 --> 00:17:31,090
because the standard normal looking rock
payload

319
00:17:31,090 --> 00:17:36,610
directly rats to some API that's watched
indirectly reading the something that's

320
00:17:36,610 --> 00:17:37,390
watched as

321
00:17:37,390 --> 00:17:40,480
a known bad here at stake so there's a

322
00:17:40,480 --> 00:17:44,470
0 instead of calling this legitimately
somebody just ride directed its API or

323
00:17:44,470 --> 00:17:45,610
whatever that's ninety

324
00:17:45,610 --> 00:17:50,370
busted to YouTube contraband your car
put away quick enough or whatever

325
00:17:50,370 --> 00:17:54,880
hi everyone I think that an Audi so in
terms are bypassing

326
00:17:54,880 --> 00:17:58,770
Tom you may have a thaw

327
00:17:58,770 --> 00:18:02,409
where I'm going with this light before I
finish my my what's a way you can think

328
00:18:02,409 --> 00:18:05,309
about how I might you bypass the
protection like that

329
00:18:05,309 --> 00:18:08,630
if you can ret to this critically

330
00:18:08,630 --> 00:18:12,290
yeah but you need to call I need to call
this API but they're kinda watching to

331
00:18:12,290 --> 00:18:13,580
make sure I'm not reading today

332
00:18:13,580 --> 00:18:19,890
letter says

333
00:18:19,890 --> 00:18:26,890
the I am doing is coming to you yes

334
00:18:28,230 --> 00:18:31,210
maybe there's something direction you
could do and see how far back the

335
00:18:31,210 --> 00:18:34,480
checker something that's a good idea the
idea I had was well I wanna call virtue

336
00:18:34,480 --> 00:18:35,110
I like

337
00:18:35,110 --> 00:18:38,630
and like normal programs cover try like

338
00:18:38,630 --> 00:18:42,540
has two word because otherwise it would
break every program that runs on your

339
00:18:42,540 --> 00:18:43,250
computer

340
00:18:43,250 --> 00:18:47,680
so what if I just threat to us about
this seven-c_ bubble up 59

341
00:18:47,680 --> 00:18:51,210
what I just read to a place that I
recall that legitimately like that has

342
00:18:51,210 --> 00:18:51,810
to work

343
00:18:51,810 --> 00:18:56,350
otherwise is programs gonna fail so that
was my like bypass idea for this is like

344
00:18:56,350 --> 00:18:58,230
what if I just right to this location

345
00:18:58,230 --> 00:19:05,230
that's gotta work and it did so I did
was I changed the right to a card to

346
00:19:06,110 --> 00:19:09,600
this threat to a location etc calls it
legitimately basically we just we get a

347
00:19:09,600 --> 00:19:10,230
little bit

348
00:19:10,230 --> 00:19:13,670
so I can i stash my contraband at the
checkpoint everything's fine

349
00:19:13,670 --> 00:19:16,960
so I sail past the first rock check met
up in

350
00:19:16,960 --> 00:19:20,360
is won't be so bad Africa that I know I
for starters how hard is it going to be

351
00:19:20,360 --> 00:19:21,250
is can take me

352
00:19:21,250 --> 00:19:25,660
mines weeks now so

353
00:19:25,660 --> 00:19:30,530
then I got past that in the next update
up the five rock checks is constant exec

354
00:19:30,530 --> 00:19:31,640
flow which is a

355
00:19:31,640 --> 00:19:35,760
like cattle on confusing name that
basically does the same thing that the

356
00:19:35,760 --> 00:19:37,610
first when Justin but it doesn't on exit

357
00:19:37,610 --> 00:19:41,210
so when you exit my knees critical API's
it checks to make sure that you're going

358
00:19:41,210 --> 00:19:41,900
back

359
00:19:41,900 --> 00:19:45,700
to a location that legitimately call the
API

360
00:19:45,700 --> 00:19:49,470
and so at first I was like man this is
and even hit now realize

361
00:19:49,470 --> 00:19:52,910
now I don't need to do anything externa
bypass this because

362
00:19:52,910 --> 00:19:56,590
that has to work already because at the
same reason that the first one has to

363
00:19:56,590 --> 00:19:59,690
work i'm i'm calling from a legitimate
location so it's gonna return to a

364
00:19:59,690 --> 00:20:01,150
legitimate location code

365
00:20:01,150 --> 00:20:05,830
and and that location is basically just
the long gadget it was the car the API

366
00:20:05,830 --> 00:20:08,690
and did some stuff men to read it I just
made needed to make sure that whatever

367
00:20:08,690 --> 00:20:09,750
didn't mean

368
00:20:09,750 --> 00:20:14,500
breaking so that that was knowing how
about that was it took me awhile to

369
00:20:14,500 --> 00:20:16,440
figure out why I was already bypassing

370
00:20:16,440 --> 00:20:21,640
I didn't have to do next year to bypass
that okay so now

371
00:20:21,640 --> 00:20:25,380
I have quote-unquote My heck CC

372
00:20:25,380 --> 00:20:28,430
see price you definitely can't really
but the instruction pointer is pointing

373
00:20:28,430 --> 00:20:30,610
to a he page because I called virtual
allied

374
00:20:30,610 --> 00:20:34,170
to protect and I put one heck CC

375
00:20:34,170 --> 00:20:37,440
as my first thing XQ

376
00:20:37,440 --> 00:20:40,640
because this page this this he page that
I just allocated

377
00:20:40,640 --> 00:20:45,300
I allocated it with mean right execute
you know you can see if you can

378
00:20:45,300 --> 00:20:48,920
I can read it but I did a a virgin
protectors to show

379
00:20:48,920 --> 00:20:52,630
bank be prime the IP to show that these
pages

380
00:20:52,630 --> 00:20:57,480
is marked with rewrite execute which is
what I need to execute legitimate shoko

381
00:20:57,480 --> 00:21:00,690
so what is actually sees a me now

382
00:21:00,690 --> 00:21:04,340
why would I put that there any thoughts

383
00:21:04,340 --> 00:21:09,360
coding mean actually see translates to
an

384
00:21:09,360 --> 00:21:13,410
3 which is basically a software break
point so basically

385
00:21:13,410 --> 00:21:17,050
when you're writing and explain you take
it you you car use or to build your

386
00:21:17,050 --> 00:21:19,330
explaining stages just like you would
software

387
00:21:19,330 --> 00:21:22,340
so you don't try to build your whole
explain it once but your show go in and

388
00:21:22,340 --> 00:21:24,130
do it all from the get go cuz it'll
break

389
00:21:24,130 --> 00:21:27,290
you will be honored by whites breaking
is it because I shall code not working

390
00:21:27,290 --> 00:21:29,500
right you're never getting your show
character

391
00:21:29,500 --> 00:21:33,660
it gets kinda confusing so if you start
with just one cc at the very top where

392
00:21:33,660 --> 00:21:34,480
shoko be

393
00:21:34,480 --> 00:21:38,760
it stopped raining debugger you can go
area you can check step Age mansions and

394
00:21:38,760 --> 00:21:42,990
okay now now I can put in some real
shocker

395
00:21:42,990 --> 00:21:48,710
so you can I liked about it stages so to
speak Rs so it's so that's working so

396
00:21:48,710 --> 00:21:49,310
the next

397
00:21:49,310 --> 00:21:52,370
the five ararat protections as Carlo
library

398
00:21:52,370 --> 00:21:56,010
and that would be you know something
that you would wanna check because a lot

399
00:21:56,010 --> 00:21:58,000
of exploit pay those may wanna

400
00:21:58,000 --> 00:22:01,860
load some other library to do whatever
it is they do if they wanna

401
00:22:01,860 --> 00:22:05,120
call out to the web or something like
that depending on what this malicious

402
00:22:05,120 --> 00:22:09,550
payload is doing to me want to leverage
existing code so it seems like the

403
00:22:09,550 --> 00:22:13,140
a good check to have to see if libraries
allowing the promise libraries load all

404
00:22:13,140 --> 00:22:15,740
the time so it can't really stop

405
00:22:15,740 --> 00:22:19,070
d dll's from power loading and unloading
because that's a normal thing that

406
00:22:19,070 --> 00:22:22,160
process is due to the I think this check
really does it checks to make sure that

407
00:22:22,160 --> 00:22:22,890
deals are

408
00:22:22,890 --> 00:22:25,900
are being loaded from a remote happy UNC

409
00:22:25,900 --> 00:22:28,900
share a bathroom no situation so

410
00:22:28,900 --> 00:22:32,880
and you definitely don't need to do that
legit shoko to the I think I did a

411
00:22:32,880 --> 00:22:35,880
bypass this would just make sure that my
shoko didn't do that

412
00:22:35,880 --> 00:22:40,820
so that's can about really don't need do
anything so to speak to bypass this

413
00:22:40,820 --> 00:22:43,970
as protection just don't do that arm

414
00:22:43,970 --> 00:22:47,580
there was something else that messed me
up Cartier after this

415
00:22:47,580 --> 00:22:52,530
address export filtering and we'll talk
about that later that that actually

416
00:22:52,530 --> 00:22:56,230
messed me up when I first tried my shoko
cuz I i put in a a

417
00:22:56,230 --> 00:23:00,000
I like a standard Metasploit shoko where
the heck CC was

418
00:23:00,000 --> 00:23:03,280
and first about it died right here at
this

419
00:23:03,280 --> 00:23:06,910
load library and I thought oh no the
load library check is working

420
00:23:06,910 --> 00:23:10,640
now I realize no it has nothing to do
with just one load labor is being called

421
00:23:10,640 --> 00:23:13,910
we're jumping to instead a calling to it
was actually collar check again

422
00:23:13,910 --> 00:23:17,150
very first the rejection is messed me up
there

423
00:23:17,150 --> 00:23:21,690
so I change that to a car on cinema job
and I got my connect back shall see you

424
00:23:21,690 --> 00:23:23,040
can see I ran the spread this

425
00:23:23,040 --> 00:23:26,360
my my toy program to start his car bomb
program txt

426
00:23:26,360 --> 00:23:30,190
and that the Python code is generating
this explained that been

427
00:23:30,190 --> 00:23:34,340
and then I I got my remote shell and
then my tape exit

428
00:23:34,340 --> 00:23:37,730
it actually crash and the bus hit me
with this EF mitigation at wanna

429
00:23:37,730 --> 00:23:41,290
it someone on the other now under fire
up protection it's like a sixth

430
00:23:41,290 --> 00:23:44,550
on the 12 total is one of the other
protections

431
00:23:44,550 --> 00:23:48,980
Ando will talk about what that is in a
minute and how to bypass them but for

432
00:23:48,980 --> 00:23:51,420
now I thought well as the use in a
standard measure

433
00:23:51,420 --> 00:23:55,250
play pouch meh display shoko algis

434
00:23:55,250 --> 00:23:57,990
write a custom shoko cuz that's one
other ways to get around these as you

435
00:23:57,990 --> 00:24:00,980
can just write your own custom show good
cause what they do with his gf is

436
00:24:00,980 --> 00:24:02,010
they're keying in on

437
00:24:02,010 --> 00:24:05,550
I'm on something that a lot of show
codes

438
00:24:05,550 --> 00:24:09,400
can show coach do may result functions

439
00:24:09,400 --> 00:24:12,430
by looking at the the export table up

440
00:24:12,430 --> 00:24:16,320
the deal I'll sell you can just not do
that as party shakur's you have you can

441
00:24:16,320 --> 00:24:17,390
write custom

442
00:24:17,390 --> 00:24:20,660
shower curtains are ideal though is
running show opens campaign raised

443
00:24:20,660 --> 00:24:23,080
better issues the ones that I missed by
so we'll show

444
00:24:23,080 --> 00:24:26,130
and second how you can get you can
bypassed and

445
00:24:26,130 --> 00:24:30,340
you just a regular shower again cuz
writing your own campaign

446
00:24:30,340 --> 00:24:33,980
but I wrote a little one here and it's
just a message box that pops up a little

447
00:24:33,980 --> 00:24:34,970
message

448
00:24:34,970 --> 00:24:38,230
saying something like sorry been put on
by lab that but I mean that com

449
00:24:38,230 --> 00:24:41,770
and as the title says you to pick me as
first place is kinda

450
00:24:41,770 --> 00:24:46,350
para just to have fun with their so
that's all that all that custom shoko

451
00:24:46,350 --> 00:24:47,250
does

452
00:24:47,250 --> 00:24:50,470
and I keep cash on this this is just the
rock chain its

453
00:24:50,470 --> 00:24:54,040
is basically the same as it was but I
i've changed a few things

454
00:24:54,040 --> 00:24:56,990
you the addresses and stuff and I guess
and you can see the white paper and a

455
00:24:56,990 --> 00:24:58,970
pen a look there are layers

456
00:24:58,970 --> 00:25:02,690
to figure out what's going on at so when
I now when I run bomb prone than txt

457
00:25:02,690 --> 00:25:04,280
with us explain that band yep

458
00:25:04,280 --> 00:25:08,700
my custom shoko round which is fine so
that means

459
00:25:08,700 --> 00:25:12,200
I've got past the first 3 the

460
00:25:12,200 --> 00:25:16,240
the protection and Mon Mar the EF is
well liked by writing my own soccer in

461
00:25:16,240 --> 00:25:18,380
that case but

462
00:25:18,380 --> 00:25:22,000
okay there's a couple more though
there's one called men Prada and what

463
00:25:22,000 --> 00:25:24,160
this does is this basically make sure
that you don't

464
00:25:24,160 --> 00:25:27,620
use the API birch protect this is like a
super ninety

465
00:25:27,620 --> 00:25:32,130
API that they like watched like a hawk
because this is the one that's used by

466
00:25:32,130 --> 00:25:34,900
most to the rock payload out there to
change

467
00:25:34,900 --> 00:25:38,890
paid commissions and the current stack
page to run a regular shoko

468
00:25:38,890 --> 00:25:42,100
okay so if you're going to use for to
protect

469
00:25:42,100 --> 00:25:45,830
to change paid commissions a page on the
stack

470
00:25:45,830 --> 00:25:52,000
you'll get busted by this this
protection so how how to bypass that

471
00:25:52,000 --> 00:25:56,100
well I we can use virtual ally can make
a whole new page in a heap

472
00:25:56,100 --> 00:25:58,610
that three wrecks you that's what I've
been doing all along cuz I just had a

473
00:25:58,610 --> 00:26:00,920
feeling that was gonna be a better idea
cuz I know that that

474
00:26:00,920 --> 00:26:03,990
at something that has to work a lot of
programs do that

475
00:26:03,990 --> 00:26:08,260
they need allocated new page somewhere
in the middle like project a code for

476
00:26:08,260 --> 00:26:11,390
JV and stuff like that they need to be
able actually runco

477
00:26:11,390 --> 00:26:14,820
dynamically for something so I kinda had
a feeling that's going to be something

478
00:26:14,820 --> 00:26:15,970
that's tough for them to really

479
00:26:15,970 --> 00:26:19,630
stop all the time as some programs may
need

480
00:26:19,630 --> 00:26:22,930
or Tom maybe there's some

481
00:26:22,930 --> 00:26:26,070
other API that works just like virtual
protect but its

482
00:26:26,070 --> 00:26:30,620
a quote unquote deeper API and there's
there's a notion I'm

483
00:26:30,620 --> 00:26:34,530
how lower level APIs cuz allot API's
call another program function which

484
00:26:34,530 --> 00:26:38,190
cause another function which caused the
real punch that actually does

485
00:26:38,190 --> 00:26:42,060
what the top level API is doing so
depending on where they hook

486
00:26:42,060 --> 00:26:46,070
up that function call chain okay

487
00:26:46,070 --> 00:26:49,550
or arm you can check use Virginia Tech
to change

488
00:26:49,550 --> 00:26:53,450
he pages just not the stack so there's
like a number different ways you can get

489
00:26:53,450 --> 00:26:54,470
around this

490
00:26:54,470 --> 00:26:57,910
protection okay and I chose the first

491
00:26:57,910 --> 00:27:01,610
I'm as well as the second in the real
world example so

492
00:27:01,610 --> 00:27:04,620
just to give you can have a look at two
different ways to do it so we can just

493
00:27:04,620 --> 00:27:05,670
allocating new page

494
00:27:05,670 --> 00:27:08,930
or we can find a deeper level function
and not checking

495
00:27:08,930 --> 00:27:12,360
both those ideas actually work

496
00:27:12,360 --> 00:27:16,500
and then finally on the stack minute
okay so what is this was his fifth rock

497
00:27:16,500 --> 00:27:17,920
protection cover stack paper

498
00:27:17,920 --> 00:27:21,740
how does that work well as I was
explaining earlier

499
00:27:21,740 --> 00:27:25,020
wanna cam and things have to do before
you run your %ah change if the pit

500
00:27:25,020 --> 00:27:28,080
the stack pointer which is normally
point in the stack that's why it's

501
00:27:28,080 --> 00:27:29,350
called the stack pointer

502
00:27:29,350 --> 00:27:32,270
you you'd change it to point to the
Hebrew some other place that should

503
00:27:32,270 --> 00:27:33,980
never point you

504
00:27:33,980 --> 00:27:37,340
so what they do is when you call

505
00:27:37,340 --> 00:27:40,910
when these critically PI's they check to
make sure that the stack pointer isn't

506
00:27:40,910 --> 00:27:42,520
the point is that

507
00:27:42,520 --> 00:27:46,400
so what's a way we can get around that
got

508
00:27:46,400 --> 00:27:50,660
I can you like can gain that system

509
00:27:50,660 --> 00:27:54,710
again the key is the fact that when you
call a critical API the stack pointer

510
00:27:54,710 --> 00:27:56,760
need to be pointed stack

511
00:27:56,760 --> 00:27:59,850
otherwise it can be wherever it needs to
be wherever you want it to be is not

512
00:27:59,850 --> 00:28:03,020
really stopping it all together they're
just kinda checking in at key points

513
00:28:03,020 --> 00:28:07,690
right tonight at my dear was well

514
00:28:07,690 --> 00:28:10,690
let's play then so I can pay that I can
do that they don't stop me from doing

515
00:28:10,690 --> 00:28:11,750
that they just

516
00:28:11,750 --> 00:28:15,750
check in at certain key checkpoint I can
give it to the and I can copy my whole

517
00:28:15,750 --> 00:28:18,460
bit on the heat to the stack

518
00:28:18,460 --> 00:28:22,680
I can un p'tit and then I can come I
critical API do whatever I need to do

519
00:28:22,680 --> 00:28:26,210
because then it'll be on the stack again
when they check it right

520
00:28:26,210 --> 00:28:29,670
so I can do not a stop in between I just
got a stash the goods when we get to the

521
00:28:29,670 --> 00:28:30,790
checkpoint

522
00:28:30,790 --> 00:28:34,310
that same sort of ID I guess or arm

523
00:28:34,310 --> 00:28:37,500
if you've already got a stack exploit it
really doesn't matter cuz you're

524
00:28:37,500 --> 00:28:40,910
malicious input eruption are to be
honest actors kinda been an issue but

525
00:28:40,910 --> 00:28:42,270
I'm assuming

526
00:28:42,270 --> 00:28:46,360
that year you know that this check
relates to stuff that comes in today he

527
00:28:46,360 --> 00:28:49,230
cell there's a couple different ways
that may or may not matter depending on

528
00:28:49,230 --> 00:28:53,290
where comes in in the first place but

529
00:28:53,290 --> 00:28:56,340
so again showing this prochaine

530
00:28:56,340 --> 00:28:59,770
on they're gonna suckers to me has to
come get them cuz I'm not taking me when

531
00:28:59,770 --> 00:29:00,660
I leave

532
00:29:00,660 --> 00:29:04,870
a here's the here's the rub: chain
here's the payday

533
00:29:04,870 --> 00:29:08,370
here some other stuff I do and then
basically I just output a blob

534
00:29:08,370 --> 00:29:11,680
to a file and by and that's all my
exploiters right now so it's just a

535
00:29:11,680 --> 00:29:12,980
simple little thing

536
00:29:12,980 --> 00:29:18,350
the cana and I cheat a little bit when I
do this stacked in a protection

537
00:29:18,350 --> 00:29:23,630
I'm I a directly rights in assembly code
which copies my stuff from the heat to

538
00:29:23,630 --> 00:29:24,720
the stack

539
00:29:24,720 --> 00:29:28,180
and then from the stack to them
virtually allocated page now

540
00:29:28,180 --> 00:29:31,820
okay so I can achieve a little bit there
and I'll talk about what we have to do

541
00:29:31,820 --> 00:29:33,890
not she later

542
00:29:33,890 --> 00:29:38,010
and then this bong pro heat now txt

543
00:29:38,010 --> 00:29:41,010
with this malicious input this exploit
not been or whatever

544
00:29:41,010 --> 00:29:44,870
then it works to you so I kinda wanna
make sure so what I did with for my

545
00:29:44,870 --> 00:29:47,490
research was as I we doing this project
is II

546
00:29:47,490 --> 00:29:51,190
through contrived problem I made sure
that I can come up with ideas

547
00:29:51,190 --> 00:29:55,550
improve those ideas out with toy
problems for each one to five

548
00:29:55,550 --> 00:29:58,850
protection right and now I'm kinda put
them all together in a real-world

549
00:29:58,850 --> 00:30:02,830
explain that's kinda how I wanted to be
a so

550
00:30:02,830 --> 00:30:07,990
you should wonder yes but those were all
I can try problems right

551
00:30:07,990 --> 00:30:11,230
can you actually do it against the real
world so 2222

552
00:30:11,230 --> 00:30:14,780
for the main event and members Israel
exploit

553
00:30:14,780 --> 00:30:17,940
I wanted some call music but I don't
have any sale I scare

554
00:30:17,940 --> 00:30:22,690
to my aunts and fax I'm so we need you
need a

555
00:30:22,690 --> 00:30:26,020
real exploit their really works so and
I'm not in the business

556
00:30:26,020 --> 00:30:29,780
you know I'm drop in on a rainy I got so
this is not my own air anything like

557
00:30:29,780 --> 00:30:31,590
that but this is an ex play

558
00:30:31,590 --> 00:30:36,320
meh display has one for it CV 2012
whatever it and I E

559
00:30:36,320 --> 00:30:39,050
its it was current at the time when I
was doing this work but it's like a

560
00:30:39,050 --> 00:30:42,590
little older now I guess it's a couple
years old now but

561
00:30:42,590 --> 00:30:45,620
I am and a mess but one was very good at
all because again

562
00:30:45,620 --> 00:30:49,570
it depends on an on-air nah nah Salar de
allow for it to work

563
00:30:49,570 --> 00:30:52,490
so I needed a better version OS X by
which I got from a friend of mine in

564
00:30:52,490 --> 00:30:53,430
Peter

565
00:30:53,430 --> 00:30:58,680
so I have then what we are saying at the
beginning I have a working exploit

566
00:30:58,680 --> 00:31:02,140
I have assistants farmland in this case
on patch machine

567
00:31:02,140 --> 00:31:06,740
and then so everything's fine and then
I'm starting a

568
00:31:06,740 --> 00:31:10,370
so-and-so are deaf or not par the
problem we have that's all

569
00:31:10,370 --> 00:31:13,370
BR exploit begin with the problem is

570
00:31:13,370 --> 00:31:16,680
animals 5 rock checks cuz I have to do a
rock chain

571
00:31:16,680 --> 00:31:20,740
to disabled at to run my paleo okay so
the problem is bypassing these five

572
00:31:20,740 --> 00:31:22,630
things that i've been talking about

573
00:31:22,630 --> 00:31:26,210
so maybe on the diapers basics

574
00:31:26,210 --> 00:31:29,280
as that they would find it allows like
googling for random pictures that

575
00:31:29,280 --> 00:31:32,230
related to bypass this was the other
picture I found for bypass like some

576
00:31:32,230 --> 00:31:33,180
kinda

577
00:31:33,180 --> 00:31:38,410
plumbing bypass I found a heart bypass
pitcher to me was kinda creepy same put

578
00:31:38,410 --> 00:31:40,650
that one up there

579
00:31:40,650 --> 00:31:43,540
anyway so we need a we need to do you
want the main things you need to do is

580
00:31:43,540 --> 00:31:47,150
that holst activity bypassing the last
time out is this

581
00:31:47,150 --> 00:31:51,820
I he the bug is actually he paced back
and I E

582
00:31:51,820 --> 00:31:55,800
so the the militias input iraq chain
will be coming in and heaps I do have to

583
00:31:55,800 --> 00:31:57,160
do that whole

584
00:31:57,160 --> 00:32:01,460
you know pity copy to the stack unpaid
running from the stack had texted you

585
00:32:01,460 --> 00:32:04,820
and i cant she like I did before cuz I
cheated when I first met

586
00:32:04,820 --> 00:32:08,490
a little bit by just writing some
assembly al capping

587
00:32:08,490 --> 00:32:11,690
so actually have to find new gadgets for
my chain that do the capping

588
00:32:11,690 --> 00:32:16,920
for me and that's not very hard so as
partly explain I really resolve the base

589
00:32:16,920 --> 00:32:17,550
address a

590
00:32:17,550 --> 00:32:21,390
NTD allow dynamically see you see all
the gadgets are an offset int and TD

591
00:32:21,390 --> 00:32:23,470
allow so it's like

592
00:32:23,470 --> 00:32:26,660
when you when you see that well on the
sea and the next when you see a every

593
00:32:26,660 --> 00:32:28,260
gadget looks like

594
00:32:28,260 --> 00:32:31,830
may gather NTD a low base plus some %ah
said that's the

595
00:32:31,830 --> 00:32:34,940
dress up the gadget in on this deal and
then

596
00:32:34,940 --> 00:32:39,500
okay and this is our age you now
JavaScript code breakers

597
00:32:39,500 --> 00:32:42,740
client-side project so

598
00:32:42,740 --> 00:32:46,310
although are you really have to do to
copy from the heat to the stack is you

599
00:32:46,310 --> 00:32:48,510
just need my car park have gadget

600
00:32:48,510 --> 00:32:51,990
which basically just pops whatever's

601
00:32:51,990 --> 00:32:55,460
you know safer stupid here pointing to
your malicious input

602
00:32:55,460 --> 00:32:58,460
and then you pop you load I D word in or
register

603
00:32:58,460 --> 00:33:02,390
and then you move your D word to sum
address the bridge square brackets TX

604
00:33:02,390 --> 00:33:03,040
means

605
00:33:03,040 --> 00:33:07,260
at the location point to buy your Xbox
happened appointed a stack

606
00:33:07,260 --> 00:33:11,720
and the increment four times because I
need to move the stack pointer forward

607
00:33:11,720 --> 00:33:16,200
four bytes and I by this is at the very
end i restore and you basically just do

608
00:33:16,200 --> 00:33:18,520
it I went to time so

609
00:33:18,520 --> 00:33:22,110
for everyone have my legitimate gadgets
where

610
00:33:22,110 --> 00:33:25,940
have been like this is one again did
they actually need to run I have to do

611
00:33:25,940 --> 00:33:30,200
six more gadgets to basically copy that
gadget from the heat in the stack

612
00:33:30,200 --> 00:33:33,740
I do that a whole bunch in time I put
all these gadgets that I really need to

613
00:33:33,740 --> 00:33:34,620
run with my

614
00:33:34,620 --> 00:33:38,540
pre rock chain to get my actual rockin
Iran stack

615
00:33:38,540 --> 00:33:42,960
so it does make your a total attack size
basically six times longer than it was

616
00:33:42,960 --> 00:33:44,630
to begin with having to do this

617
00:33:44,630 --> 00:33:48,050
which in this case wasn't a problem he
had there is like arbitrary unlimited

618
00:33:48,050 --> 00:33:49,440
space

619
00:33:49,440 --> 00:33:56,030
so it was no worries on that I'm with my
time check on it and I am

620
00:33:56,030 --> 00:33:59,130
15 minutes okay call I

621
00:33:59,130 --> 00:34:02,340
so that was no problem and then the
other thing was this the AF ing us

622
00:34:02,340 --> 00:34:06,110
talking about so like I said a lot of
shellcode what they do is they resolve

623
00:34:06,110 --> 00:34:07,840
other functions by looking at the

624
00:34:07,840 --> 00:34:11,550
export address like and TDI colonel

625
00:34:11,550 --> 00:34:16,210
various various ways you can do it but
that's kinda the common way to do it

626
00:34:16,210 --> 00:34:19,210
and what the EF checked as inside a.m.
EDT

627
00:34:19,210 --> 00:34:22,230
is it basically set to hardware
breakpoint

628
00:34:22,230 --> 00:34:27,390
on this table inside India on it's as if
anybody tries to read or write

629
00:34:27,390 --> 00:34:31,780
this address then we'll know that
they're trying to do this not a thang

630
00:34:31,780 --> 00:34:34,919
this program should never touch in this
spot in this way

631
00:34:34,919 --> 00:34:38,560
okay so it's kinda like don't touch me
there so that's kinda that's kinda hole

632
00:34:38,560 --> 00:34:39,030
that's

633
00:34:39,030 --> 00:34:42,610
that's how they're checking for that and
the hardware breakpoint and

634
00:34:42,610 --> 00:34:45,860
I thought well if they're you know

635
00:34:45,860 --> 00:34:49,919
checking in with a break point in terms
i bypass can we just clear every point

636
00:34:49,919 --> 00:34:52,850
and it shouldn't be too hard to like
write some code clears all the existing

637
00:34:52,850 --> 00:34:54,500
break point and then run a normal

638
00:34:54,500 --> 00:34:58,150
that's all I D so I had to basically
we're come up with this whole

639
00:34:58,150 --> 00:35:02,640
what I kardia bypass stab so I Q real
show coach starts here in its

640
00:35:02,640 --> 00:35:05,410
however long it is and that's something
that you can just grab the blob for

641
00:35:05,410 --> 00:35:06,280
Metasploit

642
00:35:06,280 --> 00:35:11,270
and he basically just stick this bit I'm
doing and it's compiled in as a writer

643
00:35:11,270 --> 00:35:12,250
doesn't look like

644
00:35:12,250 --> 00:35:16,010
there's it looks like a buncha bites
when you compile madame

645
00:35:16,010 --> 00:35:19,920
but basically all it does is it calls a
syscall this anti second text read it

646
00:35:19,920 --> 00:35:22,550
looks like a lot a code but it's not
it's just one call

647
00:35:22,550 --> 00:35:25,630
and all our estimate is setting up for
this car so that it clears on a break

648
00:35:25,630 --> 00:35:27,420
point that exist America

649
00:35:27,420 --> 00:35:31,470
so that's all you had to do to bypass
the abject so that was

650
00:35:31,470 --> 00:35:35,410
not not really that hard actually I was
a lot easier than I thought it would be

651
00:35:35,410 --> 00:35:40,230
I thought I was gonna really hard by
pastel so just add that stuff

652
00:35:40,230 --> 00:35:44,120
and oh yeah to point out my earlier
point there is actually this

653
00:35:44,120 --> 00:35:49,130
NTD allow anti protect virtual memory is
a lower level version virtual protect

654
00:35:49,130 --> 00:35:50,440
the higher-level EPNS

655
00:35:50,440 --> 00:35:54,720
AP I did they check and so makers up
knew that this was an issue they knew

656
00:35:54,720 --> 00:35:56,690
that they weren't watching this other

657
00:35:56,690 --> 00:36:00,010
function that they wanted to watch and
there's actually a there's actually a

658
00:36:00,010 --> 00:36:02,010
check inside and it called The Perks

659
00:36:02,010 --> 00:36:05,550
and you can check that and then it will
watches too but by default they down in

660
00:36:05,550 --> 00:36:06,790
the reason they didn't

661
00:36:06,790 --> 00:36:10,910
was for compatibility reasons they were
breaking stuff by watching this to you

662
00:36:10,910 --> 00:36:14,780
so they kinda it wasn't that they were
ignorant to the fact that that this

663
00:36:14,780 --> 00:36:17,600
you know lowered the security but not
watching this lower level version at

664
00:36:17,600 --> 00:36:18,670
that same car

665
00:36:18,670 --> 00:36:21,670
it's just that they made a conscious
design decision to not do that by the

666
00:36:21,670 --> 00:36:24,010
fall and so now one of the things
they've done based on our

667
00:36:24,010 --> 00:36:25,200
recommendations

668
00:36:25,200 --> 00:36:28,830
was in there 5.0 tech reviews they
enabled the box by Paul

669
00:36:28,830 --> 00:36:33,550
that help so I feel like we made a
difference in turn to pushing

670
00:36:33,550 --> 00:36:38,020
and it to be a better product is pros
research which is kinda cool benefit

671
00:36:38,020 --> 00:36:41,430
I'm doing this anyway that's how in this
case instead a

672
00:36:41,430 --> 00:36:44,930
doing virtually to allocate a new page
it was really an excuse I just use this

673
00:36:44,930 --> 00:36:48,970
Laurel overs number to protect a remark
the stack pages after I shovel my steps

674
00:36:48,970 --> 00:36:49,770
right kneecap

675
00:36:49,770 --> 00:36:53,500
again from the stack and heap I just
executed stacked

676
00:36:53,500 --> 00:36:58,000
because I so various ways you can do
that so bring it all together

677
00:36:58,000 --> 00:37:01,370
I know you as a starter falsely buy it
for so how many have seen an exploit

678
00:37:01,370 --> 00:37:03,740
demo before we do every explained mr.

679
00:37:03,740 --> 00:37:07,080
use pot Calgary that's all it does is
just no big deal it's an

680
00:37:07,080 --> 00:37:11,500
I don't know why that became the candy
factory exploit standard so

681
00:37:11,500 --> 00:37:16,310
basically to set up for a client side
explain all you'll see me do is you see

682
00:37:16,310 --> 00:37:17,920
me start a python server

683
00:37:17,920 --> 00:37:21,320
which is hosting the militias page and
then we browse to

684
00:37:21,320 --> 00:37:25,070
with Internet Explorer and you'll see
the Cal pop up which means exploit word

685
00:37:25,070 --> 00:37:29,600
then OnStar a.m. et and then I do the
same explain you see that won't work I

686
00:37:29,600 --> 00:37:33,270
you actually crash which should mention
report but sometimes it can because

687
00:37:33,270 --> 00:37:34,760
again fighting an a-level

688
00:37:34,760 --> 00:37:37,710
playing field so depending on what's
corrupted it can report correctly every

689
00:37:37,710 --> 00:37:38,520
case

690
00:37:38,520 --> 00:37:41,530
in an hour on the upgraded version of
the exploit which

691
00:37:41,530 --> 00:37:44,750
that bypasses and its that's all the
demo there's

692
00:37:44,750 --> 00:37:49,220
now

693
00:37:49,220 --> 00:37:53,080
months if I get to play here I was brave
enough to try life

694
00:37:53,080 --> 00:37:56,380
sends me a video so this is this is all
the

695
00:37:56,380 --> 00:38:00,650
HD now is it a big long ugly HTML page
which is the

696
00:38:00,650 --> 00:38:04,300
exploit so I host that by using the

697
00:38:04,300 --> 00:38:08,540
I'd done simply to be server and just
basically host whatever's in that

698
00:38:08,540 --> 00:38:10,260
directory when you run that command byte
on

699
00:38:10,260 --> 00:38:13,850
okay see you got a web server running
Iran I burned parts Co

700
00:38:13,850 --> 00:38:17,220
okay many see the county's running under
IE which

701
00:38:17,220 --> 00:38:20,320
Sarah proved that actually there was an
actual life but I didn't just hit the

702
00:38:20,320 --> 00:38:21,050
calculated by

703
00:38:21,050 --> 00:38:24,540
or something and then I i close at out
because it

704
00:38:24,540 --> 00:38:28,000
me that would be cool to cheat erases
can it is all but now I keyboards and

705
00:38:28,000 --> 00:38:28,380
Papa

706
00:38:28,380 --> 00:38:32,150
County be like work i just bided to
explain the calculator jumps out

707
00:38:32,150 --> 00:38:35,170
accident everybody here i will like low
back legs ran

708
00:38:35,170 --> 00:38:38,830
a kidney here like oh and now I just I'm
so

709
00:38:38,830 --> 00:38:42,060
I now saw this is basically just
installing and

710
00:38:42,060 --> 00:38:47,170
and it takes two seconds so sing and
dance or something

711
00:38:47,170 --> 00:38:50,880
while I worked and then you see see me
running again like I said this time I

712
00:38:50,880 --> 00:38:54,990
will actually closer crash which isn't
really good community in properly report

713
00:38:54,990 --> 00:38:55,600
your logs

714
00:38:55,600 --> 00:38:59,259
the next play was attempted but you
still protected okay and that's a good

715
00:38:59,260 --> 00:39:01,350
thing

716
00:39:01,350 --> 00:39:04,359
Sony try again here run the same exploit

717
00:39:04,359 --> 00:39:10,050
and instead of popping cow crashes I

718
00:39:10,050 --> 00:39:13,710
which it should pop up the Emmett backs
and I'ma protected you with check number

719
00:39:13,710 --> 00:39:15,170
for whatever like that

720
00:39:15,170 --> 00:39:18,380
like I said depending on what's actually
getting corrupted space it's not always

721
00:39:18,380 --> 00:39:19,840
able to do that because it's not

722
00:39:19,840 --> 00:39:24,530
like doing it from a kernel level or I
provide worry architecture higher points

723
00:39:24,530 --> 00:39:27,660
and the same space men irony upgraded
exploit any

724
00:39:27,660 --> 00:39:34,660
and get the Kalka again so yea everybody
clap we saw calculator

725
00:39:37,510 --> 00:39:42,880
okay so that's

726
00:39:42,880 --> 00:39:46,320
have areas and if you pop it up with

727
00:39:46,320 --> 00:39:50,150
packs in the fall it's even more Lee and
apparently I'm not the only cuz mine

728
00:39:50,150 --> 00:39:51,180
came up as

729
00:39:51,180 --> 00:39:54,260
like that smaller the banjo said there's
a donde

730
00:39:54,260 --> 00:39:58,340
don't worry about it ignore what I just
said are so summery

731
00:39:58,340 --> 00:40:02,960
I'm to get past callers in EXEC don't
directly read to inject API instead you

732
00:40:02,960 --> 00:40:04,170
could call

733
00:40:04,170 --> 00:40:07,390
a legitimate version it's %uh exists
already incurred some

734
00:40:07,390 --> 00:40:10,070
I was the way I approach it is probably
other ways to rate these are all here

735
00:40:10,070 --> 00:40:10,850
istics

736
00:40:10,850 --> 00:40:14,140
the problem when he restriction
detection is kinda thing is that

737
00:40:14,140 --> 00:40:17,540
you think a clever idea similar things
have a clever idea to feature clever

738
00:40:17,540 --> 00:40:17,950
idea

739
00:40:17,950 --> 00:40:21,280
it's it's there's nothing sound that's
happening there it's just kinda like it

740
00:40:21,280 --> 00:40:23,080
back and forth

741
00:40:23,080 --> 00:40:27,340
arm in terms in the low labor protection
just don't use UNC pass

742
00:40:27,340 --> 00:40:30,810
in terms of the stacked in a protection
just make sure that the stack pointer

743
00:40:30,810 --> 00:40:34,380
on the stack at the time to check that's
what I did in for the AF

744
00:40:34,380 --> 00:40:37,870
check I just disable hardware
breakpoints so I

745
00:40:37,870 --> 00:40:41,359
in conclusion I try to find some funny
pictures that sorta

746
00:40:41,359 --> 00:40:45,210
wrap up this protection but on a fine
air

747
00:40:45,210 --> 00:40:48,720
prominent very funny okay never done

748
00:40:48,720 --> 00:40:52,060
ir so I

749
00:40:52,060 --> 00:40:56,030
to it to wrap up you know they didn't
really scare the cold so to speak they

750
00:40:56,030 --> 00:40:59,020
saw a try to treat the symptoms and
that's not necessarily a bad thing and

751
00:40:59,020 --> 00:41:02,790
it's a free tool that stops a lot of the
existing exploit so I'm not down I'm

752
00:41:02,790 --> 00:41:03,430
just

753
00:41:03,430 --> 00:41:06,690
giving you the whole picture right
because sometimes if you look at all the

754
00:41:06,690 --> 00:41:07,940
CDs that came out for like

755
00:41:07,940 --> 00:41:11,030
the current o'day you re but microsoft
says the new to me

756
00:41:11,030 --> 00:41:13,820
like before you can patch up to camp at
right now one thing you can do is

757
00:41:13,820 --> 00:41:16,109
install and that officers out there

758
00:41:16,109 --> 00:41:19,310
it's like probably well although
depending on whether or not

759
00:41:19,310 --> 00:41:22,390
if they actually took the time to
upgrade it maybe not rights such as

760
00:41:22,390 --> 00:41:25,590
I'm more just like you need it now
that's it I'm not saying it's bad or

761
00:41:25,590 --> 00:41:28,730
anything like that understand you know
it at least possible

762
00:41:28,730 --> 00:41:31,580
so that that was really my only point I
wasn't trying to beat up on anything

763
00:41:31,580 --> 00:41:33,820
like that

764
00:41:33,820 --> 00:41:37,280
furthermore there's other user land

765
00:41:37,280 --> 00:41:40,370
protection so anytime somebody is gonna
start talking about an endpoint security

766
00:41:40,370 --> 00:41:41,359
solution

767
00:41:41,359 --> 00:41:45,080
you need to know what where does this
run it is isn't usually a protection is

768
00:41:45,080 --> 00:41:48,550
it a kernel driver is a hypervisor idea
what are we talking about because

769
00:41:48,550 --> 00:41:50,990
there's those are three different things
that are out there

770
00:41:50,990 --> 00:41:54,530
and I'll give you a different level up
soundness

771
00:41:54,530 --> 00:41:58,060
depending on how they approached it so
these presumably have the same issues

772
00:41:58,060 --> 00:42:00,920
that and it does although I didn't look
at these other technologies are other

773
00:42:00,920 --> 00:42:05,880
usual and level type protection then
injected deal or whatever

774
00:42:05,880 --> 00:42:09,780
and surgeons a fix is what we did we
suggested to make use of some pictures

775
00:42:09,780 --> 00:42:11,650
they can do for their 5.0 precht

776
00:42:11,650 --> 00:42:15,810
tech preview is a kid you neighbor those
depots by Paul

777
00:42:15,810 --> 00:42:19,310
maybe come up with some better EF deal
so it's not so easy to just like clear

778
00:42:19,310 --> 00:42:20,920
break points

779
00:42:20,920 --> 00:42:26,080
maybe somehow check more than one called
deep that you came from a genetic code

780
00:42:26,080 --> 00:42:27,880
in terms of the first to you and maybe

781
00:42:27,880 --> 00:42:31,050
try to expand propagation to cover 64
bit is coated well

782
00:42:31,050 --> 00:42:35,570
incident just 32 and so they did
actually neighbor the perk so that was

783
00:42:35,570 --> 00:42:37,790
good we got some progress there

784
00:42:37,790 --> 00:42:40,320
needed a little bit with the air but I
don't think they went far enough in

785
00:42:40,320 --> 00:42:41,330
terms upgrading

786
00:42:41,330 --> 00:42:45,920
I in a taking this whole new thing which
didn't really did all the work we did it

787
00:42:45,920 --> 00:42:47,359
was called a Sr

788
00:42:47,359 --> 00:42:50,510
which is super confusing to the sounds a
lot like a SLR which have already been

789
00:42:50,510 --> 00:42:53,960
saying suffice asar ansel are you know
I'm talking about

790
00:42:53,960 --> 00:42:57,359
but this is a whole different thing a
solarz the whole renovation

791
00:42:57,359 --> 00:43:00,800
the allows right this is attack surface
reduction which is just a good idea in

792
00:43:00,800 --> 00:43:01,520
general

793
00:43:01,520 --> 00:43:04,440
which is basically saying like do you
really need Flash to run for office

794
00:43:04,440 --> 00:43:07,430
documents goodbye to call it can flash
can run inside

795
00:43:07,430 --> 00:43:11,390
like Excel or something and so they
handed this new bit timid to say that

796
00:43:11,390 --> 00:43:12,410
you can disable

797
00:43:12,410 --> 00:43:15,930
you can kinda pick and choose and say no
I don't want flash ever run in office

798
00:43:15,930 --> 00:43:16,490
back

799
00:43:16,490 --> 00:43:20,089
which is probably a good idea in general
you probably don't need maybe you do but

800
00:43:20,089 --> 00:43:23,710
probably get away without without
needing that and that would that lowers

801
00:43:23,710 --> 00:43:28,350
you know that cuts off hot actor price I
think that's a good idea

802
00:43:28,350 --> 00:43:33,200
so thanks to some people that help me
out my crew FBI labs

803
00:43:33,200 --> 00:43:36,920
to get some guys I work with thanks to
the people and they were

804
00:43:36,920 --> 00:43:39,960
they were going to work with actually
met with my house at the conference

805
00:43:39,960 --> 00:43:44,220
and then other people that have done
research in this field about bypassing

806
00:43:44,220 --> 00:43:47,640
there's been some other people that have
done some work in this field

807
00:43:47,640 --> 00:43:50,790
and peer pressure given me a better
bring the I exploited a

808
00:43:50,790 --> 00:43:54,380
kinda needed for the real world example
so

809
00:43:54,380 --> 00:43:57,510
and how much time we have to if we had
some time now

810
00:43:57,510 --> 00:44:00,750
take our many questions if if we have
questions

811
00:44:00,750 --> 00:44:04,130
that we have time forces anybody ever
thought our questioner

812
00:44:04,130 --> 00:44:10,230
some burning comment just like to make

813
00:44:10,230 --> 00:44:15,150
so the question was have have and it
bypasses been seen in awhile then it's

814
00:44:15,150 --> 00:44:17,240
actually good question

815
00:44:17,240 --> 00:44:20,370
I mean so I don't have a whole picture
the wild right i mean

816
00:44:20,370 --> 00:44:24,700
obviously so I I can't really answer I
but I can say what has been seen in

817
00:44:24,700 --> 00:44:26,730
there have been a few exploits lately

818
00:44:26,730 --> 00:44:30,890
that if emmett was installed they would
detected and they would actually bailout

819
00:44:30,890 --> 00:44:32,100
they would not try to run

820
00:44:32,100 --> 00:44:35,570
so they can bypass it but they acted
differently if it was in style with

821
00:44:35,570 --> 00:44:38,650
which in that case was a good thing to
be nm install US are protected

822
00:44:38,650 --> 00:44:42,220
yes but was sort of scared to be in that
case so

823
00:44:42,220 --> 00:44:45,359
we went from not seeing that sort of
thing to now the exploits may be

824
00:44:45,359 --> 00:44:47,730
detected and it's their ballot if it is
to

825
00:44:47,730 --> 00:44:51,320
probably that's coming is my guess that
bypasses are

826
00:44:51,320 --> 00:44:55,220
because what happens is like all the
good stuff happens for years before the

827
00:44:55,220 --> 00:44:57,190
stuff that bubble down the wild happened
right

828
00:44:57,190 --> 00:45:00,180
nation-states and all the big boys in
the field so to speak that are doing

829
00:45:00,180 --> 00:45:01,230
exploitation

830
00:45:01,230 --> 00:45:04,400
you stuff that you won't see for a
couple years so they probably meant by

831
00:45:04,400 --> 00:45:05,120
passing an

832
00:45:05,120 --> 00:45:10,100
for like who knows 23 years or whatever
in st. eventually bubbles in to use or

833
00:45:10,100 --> 00:45:13,010
have you know exploit kids and matt is
playing things like that and then

834
00:45:13,010 --> 00:45:14,630
eventually it bubbles out to

835
00:45:14,630 --> 00:45:17,690
kinda crap where right there malware
that

836
00:45:17,690 --> 00:45:22,570
Eastern European scam now where types
that are you know sort of like targeted

837
00:45:22,570 --> 00:45:26,530
outdated stuff so it takes a while for
these techniques to really buckle down

838
00:45:26,530 --> 00:45:27,930
to tandem mass

839
00:45:27,930 --> 00:45:31,020
now where I would say just in my
personal experience

840
00:45:31,020 --> 00:45:35,460
that Cisco as Kanye since I would
predict its calming and hopefully not

841
00:45:35,460 --> 00:45:40,370
just because my research but because it
was probably come in anyway right

842
00:45:40,370 --> 00:45:47,370
any other dots yet going back there

843
00:46:02,149 --> 00:46:03,000
no

844
00:46:03,000 --> 00:46:06,339
no so like this would help against
hardly at all is hardly was to your

845
00:46:06,339 --> 00:46:06,829
point

846
00:46:06,829 --> 00:46:11,150
a very different into into Hartley's a
very interesting but because there's

847
00:46:11,150 --> 00:46:11,730
kinda

848
00:46:11,730 --> 00:46:15,270
three different categories Raiders the
memory corruption bugs they do a lot of

849
00:46:15,270 --> 00:46:18,760
stuff in memory changing stack pointers
in the eye peas and all this kind of

850
00:46:18,760 --> 00:46:21,720
stuff to run a payload everything like
that that's kinda the typical

851
00:46:21,720 --> 00:46:25,040
memory corruption exploitation and helps
with that

852
00:46:25,040 --> 00:46:28,240
and then there's on the other side in
the extreme there's like this whole more

853
00:46:28,240 --> 00:46:29,700
social engineering like just

854
00:46:29,700 --> 00:46:33,420
tricking people into running a job app
letter calling on been asking for the

855
00:46:33,420 --> 00:46:35,069
user and pass mean there's this whole

856
00:46:35,069 --> 00:46:38,069
thing that you just can't it's hard to
protect against right technologically

857
00:46:38,069 --> 00:46:42,480
in in in the middle there's stuff like
hardly which was kinda be unique deal

858
00:46:42,480 --> 00:46:44,079
because it was actually

859
00:46:44,079 --> 00:46:47,740
a memory leak right so you use in a size
that was bigger

860
00:46:47,740 --> 00:46:51,300
then when it was actually needed or
whatever sense to getting back like a

861
00:46:51,300 --> 00:46:54,250
hundred bites you got back like three
thousand my to whatever it is I figured

862
00:46:54,250 --> 00:46:55,280
out at my head how much

863
00:46:55,280 --> 00:46:59,200
so you weren't actually changing memory
you weren't changing the stack pointer

864
00:46:59,200 --> 00:47:02,230
the instruction point where you were
just kinda reading memory

865
00:47:02,230 --> 00:47:05,780
and getting it back and based on that
you were able to get their certificates

866
00:47:05,780 --> 00:47:07,250
their credentials or whatever right

867
00:47:07,250 --> 00:47:13,089
arm I actually disc a little off topic
but if you go again go to our blog labs

868
00:47:13,089 --> 00:47:16,369
that brought him back home I did a whole
a little blog on why

869
00:47:16,369 --> 00:47:19,380
sizing or other app Sep

870
00:47:19,380 --> 00:47:23,319
techniques might have missed that bike
during casting is ideally that

871
00:47:23,319 --> 00:47:26,720
budget and cut during testing I call but
should be got during testing but they

872
00:47:26,720 --> 00:47:30,020
bugs slip through for various reasons
and

873
00:47:30,020 --> 00:47:34,010
you know I had two thoughts on that in
terms of why

874
00:47:34,010 --> 00:47:37,809
that one slip through to sum up my blog
entry basically my first thought was

875
00:47:37,809 --> 00:47:38,339
just

876
00:47:38,339 --> 00:47:41,589
the heartbeat extension is toward the
end the protocol

877
00:47:41,589 --> 00:47:45,380
and so testers who are developing visors
and things like that

878
00:47:45,380 --> 00:47:49,730
they can retool their entire toolset
every time somebody pushes new code to a

879
00:47:49,730 --> 00:47:52,559
code base right so that might have just
not been tested

880
00:47:52,559 --> 00:47:55,930
I mean I could be party or the other
thing is it might not have been tested

881
00:47:55,930 --> 00:47:58,930
properly because you can actually detect
memorex if you enable

882
00:47:58,930 --> 00:48:02,349
something like and when as it's called
page even basically what it does is it

883
00:48:02,349 --> 00:48:06,740
puts a on now on map page behind every
allocation

884
00:48:06,740 --> 00:48:10,230
so if you try to read out a boundary
allocation even by one by

885
00:48:10,230 --> 00:48:14,540
in a page bomb crash the at basically
but heaps don't normally run like that

886
00:48:14,540 --> 00:48:16,589
you have to intentionally enable that
sorta

887
00:48:16,589 --> 00:48:21,069
debug he when you do testing to have
that behavior happened to catch those

888
00:48:21,069 --> 00:48:22,280
are about so maybe

889
00:48:22,280 --> 00:48:25,460
in my mind as you to reason why they
miss it maybe they just didn't test it

890
00:48:25,460 --> 00:48:28,609
right for one reason other or they
tested it but they failed to test it

891
00:48:28,609 --> 00:48:29,250
properly

892
00:48:29,250 --> 00:48:34,099
basically so that's kinda it's a little
bit long-winded answer your question

893
00:48:34,099 --> 00:48:40,119
go ahead so I had a

894
00:48:40,119 --> 00:48:44,250
had a slide that mention some other
things and if I can find it again but

895
00:48:44,250 --> 00:48:47,660
I'm basically they did mediate remedial

896
00:48:47,660 --> 00:48:51,390
because similar images can see
architecture you can't fix some of those

897
00:48:51,390 --> 00:48:52,859
problems really very well

898
00:48:52,859 --> 00:48:58,450
but they did do some stuff having fun is
lying or was it

899
00:48:58,450 --> 00:49:03,559
this is the one that had they did some
stuff like they enabled

900
00:49:03,559 --> 00:49:08,099
ID perks by the fall which was not by
far than they did some stuff with the

901
00:49:08,099 --> 00:49:11,049
af2 may get a little better doesn't
really the only two things they did

902
00:49:11,049 --> 00:49:15,000
in do anything as far as I know to me
remediate any other issues like

903
00:49:15,000 --> 00:49:18,099
calling legitimate code in states and
the other things I talked about

904
00:49:18,099 --> 00:49:23,720
is tough to because the problem is you
can't break real programs you know you

905
00:49:23,720 --> 00:49:26,619
can do all the sorry he restriction
things as long as you don't break stuff

906
00:49:26,619 --> 00:49:27,500
but a lot of

907
00:49:27,500 --> 00:49:31,880
a lot here istics either a break stuff
or be there to performance

908
00:49:31,880 --> 00:49:36,020
impacted so you're kinda left with
whatever's left which are a bunch of

909
00:49:36,020 --> 00:49:38,170
good ideas but not necessarily

910
00:49:38,170 --> 00:49:42,270
for proof my dears you know I mean so
it's it's tough with and within

911
00:49:42,270 --> 00:49:45,480
with a solution that's not our are
potentially sound if you're

912
00:49:45,480 --> 00:49:48,109
protecting at the same level as an
attacking there's only so much you can

913
00:49:48,109 --> 00:49:55,109
do

914
00:49:58,690 --> 00:50:02,530
yeah

915
00:50:02,530 --> 00:50:04,309
yeah

916
00:50:04,309 --> 00:50:07,599
yeah it's it's tough to protect against
can completely

917
00:50:07,599 --> 00:50:14,599
I think you have a question your
question

918
00:50:24,210 --> 00:50:31,210
right

919
00:50:37,270 --> 00:50:38,490
yeah now I'm having

920
00:50:38,490 --> 00:50:42,320
right much less Romanow

921
00:50:42,320 --> 00:50:46,740
yep good questions as question is why
isn't MN

922
00:50:46,740 --> 00:50:49,980
and Microsoft by the fall why make you
go and download some even though it's

923
00:50:49,980 --> 00:50:53,000
free and you can download in stone it's
not super hard line stance that when

924
00:50:53,000 --> 00:50:56,650
people do that when I just put in the US
and to answer to their first about the

925
00:50:56,650 --> 00:50:59,870
sort of have to some extent you know if
you look at the protections an 8-1

926
00:50:59,870 --> 00:51:00,910
verses XP

927
00:51:00,910 --> 00:51:05,030
a lot of the stuff like the force a SORN
always step in our stuff that Emmett

928
00:51:05,030 --> 00:51:08,370
makes XP do is already there once a
summit is

929
00:51:08,370 --> 00:51:12,800
making its way into the operating system
the five projects have not made it and I

930
00:51:12,800 --> 00:51:13,930
think because a

931
00:51:13,930 --> 00:51:17,760
published be incompatible you're bound
there's bound it's bound to break some

932
00:51:17,760 --> 00:51:18,090
at

933
00:51:18,090 --> 00:51:21,230
you know so if you're going to install
and you definitely need to check to make

934
00:51:21,230 --> 00:51:24,050
sure that whatever business-critical at
you have worked fine with install

935
00:51:24,050 --> 00:51:24,560
because

936
00:51:24,560 --> 00:51:27,820
some other thing so many heuristics to
his point that they do it's like well

937
00:51:27,820 --> 00:51:29,910
why don't they do better here is to keep
those didn't work

938
00:51:29,910 --> 00:51:33,760
well because they can't some cases it
may break stuff that needs to be done

939
00:51:33,760 --> 00:51:35,700
stupid stuff like it wants the bronco

940
00:51:35,700 --> 00:51:39,130
stacked like I'm in a while program we
need to do that but if you got some

941
00:51:39,130 --> 00:51:40,890
legacy at that needs to do that

942
00:51:40,890 --> 00:51:44,410
you can still unable emmitt you may have
to just on select that particular check

943
00:51:44,410 --> 00:51:46,850
so that when the cool things about him
and you can get it going

944
00:51:46,850 --> 00:51:49,850
and if it's crashing a certain that you
can actually do but I can figure out all

945
00:51:49,850 --> 00:51:50,730
why is it crash

946
00:51:50,730 --> 00:51:55,960
poets crashing because I the man project
just let me disable that for bloody xeno

947
00:51:55,960 --> 00:51:59,270
work for the other checks years doing
some level of protection so

948
00:51:59,270 --> 00:52:03,030
that's kinda why I think that so

949
00:52:03,030 --> 00:52:10,030
yes there is this polemics

950
00:52:11,250 --> 00:52:14,420
know this is just windows this is all

951
00:52:14,420 --> 00:52:18,210
and it's a Microsoft only to all those
same ideas

952
00:52:18,210 --> 00:52:22,420
you could do in latex with some other to
learn you know protection or some

953
00:52:22,420 --> 00:52:24,700
programs and about this this is all
Windows

954
00:52:24,700 --> 00:52:29,400
my at a time okay and I time so

955
00:52:29,400 --> 00:52:30,950
thanks everyone I'm have a good track

