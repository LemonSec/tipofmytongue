1
00:00:00,570 --> 00:00:07,490
simple network management phone okay

2
00:00:07,490 --> 00:00:10,519
a start out with my name's their
Highland MA a scene security

3
00:00:10,519 --> 00:00:14,160
consulting with rapid seven a and as

4
00:00:14,160 --> 00:00:17,800
they could mention I've been doing this
for number years

5
00:00:17,800 --> 00:00:22,440
this my six-time speaking so thanks a
lot for having me I love coming here's a

6
00:00:22,440 --> 00:00:22,960
great

7
00:00:22,960 --> 00:00:26,019
and Mac

8
00:00:26,019 --> 00:00:29,170
I'm yourself engine manana

9
00:00:29,170 --> 00:00:33,429
building designing secure software
solutions

10
00:00:33,429 --> 00:00:37,510
I'll researching breaking them who

11
00:00:37,510 --> 00:00:41,299
so we like to change the way you think
about

12
00:00:41,299 --> 00:00:46,549
simple network management protocol on
bed want to move beyond

13
00:00:46,549 --> 00:00:53,209
simple metrics and monitoring we're
going to you

14
00:00:53,209 --> 00:00:56,440
explore you major up here First Minister
in

15
00:00:56,440 --> 00:01:00,129
foundational understanding home

16
00:01:00,129 --> 00:01:03,909
this emblem management protocol and

17
00:01:03,909 --> 00:01:07,100
then we're going to or used devices

18
00:01:07,100 --> 00:01:10,820
research did had information exposure

19
00:01:10,820 --> 00:01:14,140
on emigrants were

20
00:01:14,140 --> 00:01:17,170
process as well automation

21
00:01:17,170 --> 00:01:20,649
and in mitigation

22
00:01:20,649 --> 00:01:25,219
mitigation so why

23
00:01:25,219 --> 00:01:29,619
a the big question is why do we do this
typically when I speak at these

24
00:01:29,619 --> 00:01:30,499
conferences

25
00:01:30,499 --> 00:01:34,039
always try to let people know why I'm
actually doing

26
00:01:34,039 --> 00:01:38,130
any this type of stuff so this is Ken
innocence as a security consultant pen

27
00:01:38,130 --> 00:01:39,289
tester we often

28
00:01:39,289 --> 00:01:43,270
going to companies were you assessments
and testy

29
00:01:43,270 --> 00:01:46,609
and we discover S&P enable numbered my
sis

30
00:01:46,609 --> 00:01:49,829
so what we typically do we basically
noted

31
00:01:49,829 --> 00:01:53,039
and we write and report you know if this
is a bad thing

32
00:01:53,039 --> 00:01:56,259
probably shouldn't do this really don't
go any further

33
00:01:56,259 --> 00:02:00,689
X Lion so lets out a new option that

34
00:02:00,689 --> 00:02:04,219
and the new option is what's actually
start taking a look at this stuff

35
00:02:04,219 --> 00:02:08,670
so what is actually being exposed the
S&P this critical issue to the customer

36
00:02:08,670 --> 00:02:12,480
cannot be used by an attacker to do some
even bad stuff

37
00:02:12,480 --> 00:02:16,909
so that's how this whole thing got
started so I started looking at some

38
00:02:16,909 --> 00:02:17,489
stuff

39
00:02:17,489 --> 00:02:21,239
and I continue to do that so we have
some and and that's how this talk got

40
00:02:21,239 --> 00:02:21,920
started

41
00:02:21,920 --> 00:02:25,540
what's actually out there it's bad when
he means bet

42
00:02:25,540 --> 00:02:29,840
let's explain re:

43
00:02:29,840 --> 00:02:33,640
so we have vendors that are creating new
devices time

44
00:02:33,640 --> 00:02:37,769
and they want to provide a means of
managing and

45
00:02:37,769 --> 00:02:41,099
their clients that are purchasing and
adding

46
00:02:41,099 --> 00:02:44,400
networks to be networks growing in size

47
00:02:44,400 --> 00:02:50,379
and diversity know if there were
independence

48
00:02:50,379 --> 00:02:53,720
management solution provide been

49
00:02:53,720 --> 00:02:57,239
word to

50
00:02:57,239 --> 00:03:04,239
months even need the simplified with a
common management with a co

51
00:03:05,970 --> 00:03:09,340
network management you've never

52
00:03:09,340 --> 00:03:13,610
manager this is a software system
responsible

53
00:03:13,610 --> 00:03:18,829
from now on monitoring and managing
network and network element

54
00:03:18,829 --> 00:03:21,959
is any device people running he's

55
00:03:21,959 --> 00:03:26,200
this could be anything servers and
workstations

56
00:03:26,200 --> 00:03:32,099
few routers printers now

57
00:03:32,099 --> 00:03:35,739
and regions is a software system running
on

58
00:03:35,739 --> 00:03:40,000
in this offer system

59
00:03:40,000 --> 00:03:45,099
is responsible for monetary and track

60
00:03:45,099 --> 00:03:48,189
variable

61
00:03:48,189 --> 00:03:51,349
her so she did various logical subsystem

62
00:03:51,349 --> 00:03:58,349
on and storing them look normal

63
00:04:02,999 --> 00:04:03,829
the number with

64
00:04:03,829 --> 00:04:06,930
manager simplified

65
00:04:06,930 --> 00:04:10,219
you the manager and Europe

66
00:04:10,219 --> 00:04:13,920
variables on an agent an aging for
information

67
00:04:13,920 --> 00:04:19,720
manager lookin

68
00:04:19,720 --> 00:04:23,570
article standardizing communication

69
00:04:23,570 --> 00:04:26,680
reform proto no Transfer Protocol

70
00:04:26,680 --> 00:04:30,020
normally UT over other comparable

71
00:04:30,020 --> 00:04:33,099
use it was not strictly specified

72
00:04:33,099 --> 00:04:36,210
Bijan listens

73
00:04:36,210 --> 00:04:39,870
on 16 and

74
00:04:39,870 --> 00:04:45,550
men thing

75
00:04:45,550 --> 00:04:48,570
version 1 provides ample

76
00:04:48,570 --> 00:04:53,220
messages is me divided based on the
direction

77
00:04:53,220 --> 00:04:56,340
unification than the first

78
00:04:56,340 --> 00:05:00,509
for messages here share the same

79
00:05:00,509 --> 00:05:03,830
a GET request message

80
00:05:03,830 --> 00:05:07,289
used to request the value one more very

81
00:05:07,289 --> 00:05:10,699
and get next similar

82
00:05:10,699 --> 00:05:14,620
never and requesting severe I think
about him

83
00:05:14,620 --> 00:05:18,150
next is used for exploring

84
00:05:18,150 --> 00:05:21,889
he will be not all makes sense

85
00:05:21,889 --> 00:05:27,050
stress pictured in WEO

86
00:05:27,050 --> 00:05:31,380
for instance look at

87
00:05:31,380 --> 00:05:35,310
never dinner on you have more

88
00:05:35,310 --> 00:05:39,080
at version each never you

89
00:05:39,080 --> 00:05:42,259
you have a description interface name
and you

90
00:05:42,259 --> 00:05:46,389
and the music

91
00:05:46,389 --> 00:05:53,389
separate questions used upbeat the value
in response to those

92
00:05:53,690 --> 00:05:57,180
three messages and agent will send
response

93
00:05:57,180 --> 00:06:02,370
message this carries back value man

94
00:06:02,370 --> 00:06:06,699
and then trap which is for
identification

95
00:06:06,699 --> 00:06:11,289
missus outsider and region needs to
notify the manager

96
00:06:11,289 --> 00:06:18,289
something happened on that network
element else in a trap message

97
00:06:21,919 --> 00:06:24,900
taking a quick look at structure message

98
00:06:24,900 --> 00:06:27,919
the portion in top right the top

99
00:06:27,919 --> 00:06:31,120
3 in ever-present the S&M he

100
00:06:31,120 --> 00:06:34,930
comment no the community

101
00:06:34,930 --> 00:06:38,810
this element is the

102
00:06:38,810 --> 00:06:45,810
weird to Bali use for them

103
00:06:46,430 --> 00:06:50,009
kinda funny the vein centers

104
00:06:50,009 --> 00:06:53,330
the get better and values at the bottom

105
00:06:53,330 --> 00:06:56,560
magenta the variable bindings this is

106
00:06:56,560 --> 00:07:00,740
list the one an object identifier:

107
00:07:00,740 --> 00:07:05,849
all and the other messages I mentioned

108
00:07:05,849 --> 00:07:08,879
or was track this is again shares

109
00:07:08,879 --> 00:07:13,080
similar structure exception Center
represents the

110
00:07:13,080 --> 00:07:19,920
track

111
00:07:19,920 --> 00:07:23,500
looking quickly at major instance
version

112
00:07:23,500 --> 00:07:27,930
who the added two important message the
first

113
00:07:27,930 --> 00:07:31,280
all whereas

114
00:07:31,280 --> 00:07:35,320
you would use get next request retrieve
the value more

115
00:07:35,320 --> 00:07:38,890
variable now using DEP that sends

116
00:07:38,890 --> 00:07:42,750
single and retrieve more value mall

117
00:07:42,750 --> 00:07:48,320
words single and we have former

118
00:07:48,320 --> 00:07:53,940
and acknowledging vision this is used
for management

119
00:07:53,940 --> 00:07:59,120
communication to as well as providing

120
00:07:59,120 --> 00:08:02,500
creating a trap

121
00:08:02,500 --> 00:08:06,870
with the Ben delivery warren burger one

122
00:08:06,870 --> 00:08:10,230
when agent track message had no way of
knowing

123
00:08:10,230 --> 00:08:13,480
manager within

124
00:08:13,480 --> 00:08:17,010
former need now no im

125
00:08:17,010 --> 00:08:20,170
manager and it wasn't

126
00:08:20,170 --> 00:08:24,910
and unions were defined

127
00:08:24,910 --> 00:08:28,470
again there's some around

128
00:08:28,470 --> 00:08:33,340
manager and finally some security the

129
00:08:33,340 --> 00:08:37,270
the party based system however due to
the complexity

130
00:08:37,270 --> 00:08:40,490
many favored community version see

131
00:08:40,490 --> 00:08:44,350
this theme playing your text community

132
00:08:44,350 --> 00:08:48,340
1 and a little later

133
00:08:48,340 --> 00:08:51,800
user base model implemented you

134
00:08:51,800 --> 00:08:55,380
over version you see mood

135
00:08:55,380 --> 00:08:58,880
version

136
00:08:58,880 --> 00:09:04,720
3 finally provided your team between his
security model that provided

137
00:09:04,720 --> 00:09:08,560
authentication encryption integrity well
access control

138
00:09:08,560 --> 00:09:11,560
for actual variable

139
00:09:11,560 --> 00:09:15,250
yet changes

140
00:09:15,250 --> 00:09:22,160
creation administration I'm gonna turn
over their own

141
00:09:22,160 --> 00:09:25,820
he's been in permission thank you
Matthew

142
00:09:25,820 --> 00:09:30,920
awesome at his government

143
00:09:30,920 --> 00:09:33,410
S&P protocol and

144
00:09:33,410 --> 00:09:36,460
variations I'll that particular protocol

145
00:09:36,460 --> 00:09:42,720
here soma talk about the

146
00:09:42,720 --> 00:09:48,200
lives so what is 'em I'm is pretty
straightforward a

147
00:09:48,200 --> 00:09:51,660
maybe his management information base
but it's nothing more than a

148
00:09:51,660 --> 00:09:57,590
database so that its stores information
on the actual device or

149
00:09:57,590 --> 00:10:02,730
hardware device where the which is
referred to as the agent we're talking

150
00:10:02,730 --> 00:10:03,760
about protocols

151
00:10:03,760 --> 00:10:07,240
in the manager can make request to the
particular mere

152
00:10:07,240 --> 00:10:10,510
to extract the data Prince to report
next line

153
00:10:10,510 --> 00:10:13,970
so a couple

154
00:10:13,970 --> 00:10:18,050
keep things remember we're talking about
as we go through here is the all I D

155
00:10:18,050 --> 00:10:22,060
the object in a fire so the object
identifiers

156
00:10:22,060 --> 00:10:27,220
up basically is how the MIB is actually
laid out and in structure and that's how

157
00:10:27,220 --> 00:10:27,670
you make

158
00:10:27,670 --> 00:10:31,280
request to it or identify key elements
within it

159
00:10:31,280 --> 00:10:35,540
the mir bitte oh I D is laid out in a
tree design structure

160
00:10:35,540 --> 00:10:39,770
so when the manager makes request the
agent he uses that

161
00:10:39,770 --> 00:10:44,120
oh I D to Corey specific key pieces the
data out

162
00:10:44,120 --> 00:10:47,140
this database the MIP thanks

163
00:10:47,140 --> 00:10:51,090
so the OI D's a reference into

164
00:10:51,090 --> 00:10:56,420
two's typical fashions one other
fashions is a documentation

165
00:10:56,420 --> 00:11:00,180
as we see here 1.3 down 6.1 that too
whatever

166
00:11:00,180 --> 00:11:03,510
all the way down to the key element you
try and extract

167
00:11:03,510 --> 00:11:06,700
another method is with a human-readable

168
00:11:06,700 --> 00:11:10,220
name which I absolutely hate heat at

169
00:11:10,220 --> 00:11:14,420
a cure shit now is like totally screwed
up so I like the numbers

170
00:11:14,420 --> 00:11:17,460
which is much better I'm a numbers guy

171
00:11:17,460 --> 00:11:21,930
I can remember freakin ridiculous my
numbers so it's easy for me to remember

172
00:11:21,930 --> 00:11:23,670
the number to walk down through that

173
00:11:23,670 --> 00:11:27,230
gon so here is the the tree structure

174
00:11:27,230 --> 00:11:30,740
general it's kinda like okay to

175
00:11:30,740 --> 00:11:36,030
a tree that fell down but it's a tree
structure and we have been a 1.3 dot 6.1

176
00:11:36,030 --> 00:11:37,040
is the key

177
00:11:37,040 --> 00:11:41,020
hi elements are high structure this and
then you have all the other

178
00:11:41,020 --> 00:11:45,340
a some categories 1 I'm interested in we
can talk about today

179
00:11:45,340 --> 00:11:50,890
is dealing with the private enterprise
which is at 1.3 dot 6.1 that 4.1

180
00:11:50,890 --> 00:11:54,330
okay got that on the rise we tested the
end next line

181
00:11:54,330 --> 00:11:57,840
so we're talking about the private

182
00:11:57,840 --> 00:12:00,860
enterprise mid location im

183
00:12:00,860 --> 00:12:05,010
and this is a a number are that as a
sign to

184
00:12:05,010 --> 00:12:08,090
every vendor who want to create his own
custom

185
00:12:08,090 --> 00:12:14,770
amid for his product and that may be for
product I've also seen it so she headed

186
00:12:14,770 --> 00:12:15,480
down to you

187
00:12:15,480 --> 00:12:21,130
chipsets and stuff like that so that's
what we're interested in 1.3 dot 6.1 but

188
00:12:21,130 --> 00:12:24,640
4.1 which is the private enterprise MIP

189
00:12:24,640 --> 00:12:27,990
these numbers are actually assigned by
the internet assigned number in

190
00:12:27,990 --> 00:12:32,220
40 Diana its easy to get one of these I
have wanted these

191
00:12:32,220 --> 00:12:36,300
I got it about a month ago my number is
43

192
00:12:36,300 --> 00:12:40,020
by by by remember that number

193
00:12:40,020 --> 00:12:44,040
it'll be important in your life if you
ever encounter that number

194
00:12:44,040 --> 00:12:49,680
shut your damn system down and leave
because I assure you

195
00:12:49,680 --> 00:12:55,670
you'll find no good by stay in there
actually so here

196
00:12:55,670 --> 00:13:00,110
here is a a couple numbers and like I
said my number is 435 by partners been a

197
00:13:00,110 --> 00:13:00,950
number numbers

198
00:13:00,950 --> 00:13:04,810
at that's it was quite a few these
everyone can get these and hear some

199
00:13:04,810 --> 00:13:08,520
some interesting ones I threw appear
just because I wanted to apply

200
00:13:08,520 --> 00:13:14,140
and some looked interesting ones are the
ones down here toward a bottle

201
00:13:14,140 --> 00:13:17,670
these are the ones you're gonna counter
later on presentations will we do some

202
00:13:17,670 --> 00:13:18,370
over

203
00:13:18,370 --> 00:13:23,040
sure demos and their deal with those
from various products that we found

204
00:13:23,040 --> 00:13:29,140
issues in so next slide so we're talking
about the idea we try to make reference

205
00:13:29,140 --> 00:13:30,370
to the database

206
00:13:30,370 --> 00:13:35,020
there's two structures that we encounter
with the management information base

207
00:13:35,020 --> 00:13:39,150
one of them happens to be a variable
value

208
00:13:39,150 --> 00:13:44,050
so you make a request to the object or
ID in any request the variable value

209
00:13:44,050 --> 00:13:49,060
a with a zero it's a single instance the
data that can be actually quarried

210
00:13:49,060 --> 00:13:52,420
and you pull the information associated
with that at that

211
00:13:52,420 --> 00:13:57,870
data point xlite there's a more complex
structure in this is dealing with table

212
00:13:57,870 --> 00:13:58,540
indexing

213
00:13:58,540 --> 00:14:02,390
so instead of having a single value its
structure in it

214
00:14:02,390 --> 00:14:06,200
index structure the purpose that is
let's say that

215
00:14:06,200 --> 00:14:11,220
we're dealing with a things within the
device that fall in a standard category

216
00:14:11,220 --> 00:14:11,670
getter

217
00:14:11,670 --> 00:14:16,730
so I get like network interface card so
you may have you know the into UT

218
00:14:16,730 --> 00:14:20,030
TTL the IP address maybe some other

219
00:14:20,030 --> 00:14:23,100
key things these would all be structured
into a table

220
00:14:23,100 --> 00:14:26,339
index and those a reference to you know

221
00:14:26,339 --> 00:14:29,850
the same way a in a structured format
but not with the 0ther

222
00:14:29,850 --> 00:14:34,640
their referenced and call be on the
table index in this is a very simple

223
00:14:34,640 --> 00:14:35,490
structure

224
00:14:35,490 --> 00:14:38,790
representation in this it can be very
complex

225
00:14:38,790 --> 00:14:42,209
just let you know a lot more complex
than that so next slide

226
00:14:42,209 --> 00:14:46,089
so so at this point you know

227
00:14:46,089 --> 00:14:50,320
we talk to you about the protocol so we
got there earlier

228
00:14:50,320 --> 00:14:54,060
you know we talked about the management
information base so he should have an

229
00:14:54,060 --> 00:14:55,020
understanding

230
00:14:55,020 --> 00:14:59,390
the manager the agent the general
communication process that takes place

231
00:14:59,390 --> 00:15:03,580
how the court is amazing is oh I D to be
able to pull data on this database

232
00:15:03,580 --> 00:15:07,570
now we're gonna show you how to still
shit we like stealing shit

233
00:15:07,570 --> 00:15:11,440
still chisels so I'll

234
00:15:11,440 --> 00:15:15,470
some some high-level information sows
par this research

235
00:15:15,470 --> 00:15:19,190
you know it's all about hey S&P's
exposed out there

236
00:15:19,190 --> 00:15:23,080
and like Matthew talked about the
community strings by default devices

237
00:15:23,080 --> 00:15:23,620
have

238
00:15:23,620 --> 00:15:28,540
public and private is a standard
community strings that by default her

239
00:15:28,540 --> 00:15:29,510
neighbor one

240
00:15:29,510 --> 00:15:33,030
most S&P installs wall our data

241
00:15:33,030 --> 00:15:37,089
we at without their look to we found
that showed an

242
00:15:37,089 --> 00:15:41,280
there is over nearly while the numbers 0
hardness 17 plus

243
00:15:41,280 --> 00:15:44,620
million devices on the internet exposing

244
00:15:44,620 --> 00:15:48,410
as an MP that you can Korean poll data

245
00:15:48,410 --> 00:15:51,630
the quarter that's according to shoot
into some that may be devices that are

246
00:15:51,630 --> 00:15:53,160
age dealt

247
00:15:53,160 --> 00:15:56,550
I mean all week currents let's say fifty
percent it's no good

248
00:15:56,550 --> 00:16:02,020
so we're still looking 8 to nine million
devices on the Internet

249
00:16:02,020 --> 00:16:07,290
so we're gonna show you how to steal
data from what two million

250
00:16:07,290 --> 00:16:11,530
so let's go ahead and I'm a turnover to
Matthew and he's going to talk to you

251
00:16:11,530 --> 00:16:15,350
about this was that the device and he's
gonna show you some the data that were

252
00:16:15,350 --> 00:16:17,190
able to extract aloe this

253
00:16:17,190 --> 00:16:21,100
and some interesting methods related to
that

254
00:16:21,100 --> 00:16:24,900
thank you we took a look at it Aires
Motorola Netopia move

255
00:16:24,900 --> 00:16:29,240
modem net hope you with purchased by
Motorola

256
00:16:29,240 --> 00:16:34,040
and Motorola modem correct recently his
players this year

257
00:16:34,040 --> 00:16:41,040
during my research I was able to acquire

258
00:16:41,490 --> 00:16:45,290
take a look at showtimes all we found
almost a quarter-million

259
00:16:45,290 --> 00:16:49,790
devices with S&M exposed

260
00:16:49,790 --> 00:16:53,310
and little over 12,000 Motorola

261
00:16:53,310 --> 00:16:58,640
you model with well

262
00:16:58,640 --> 00:17:02,440
during our research shows that the choir
to Motorola modem

263
00:17:02,440 --> 00:17:06,179
for evaluation and SPG 65

264
00:17:06,179 --> 00:17:09,510
was found to expose information

265
00:17:09,510 --> 00:17:13,699
your public communities

266
00:17:13,699 --> 00:17:20,699
we're gonna do them

267
00:17:31,650 --> 00:17:38,650
been

268
00:17:46,260 --> 00:17:53,260
good

269
00:18:01,850 --> 00:18:05,660
very logical some systems on these
devices

270
00:18:05,660 --> 00:18:08,680
and one such system

271
00:18:08,680 --> 00:18:11,700
is owned by the Broadcom Corporation
their mid-table

272
00:18:11,700 --> 00:18:17,980
by was unable to locate him for the it
in important allotted

273
00:18:17,980 --> 00:18:22,150
exploration store

274
00:18:22,150 --> 00:18:25,380
by on a walk from him

275
00:18:25,380 --> 00:18:29,150
point and you get a lot of for example

276
00:18:29,150 --> 00:18:33,300
you and I think you walk lying version
to see

277
00:18:33,300 --> 00:18:38,450
with public communities more pointed

278
00:18:38,450 --> 00:18:41,560
the IP address the modem on land

279
00:18:41,560 --> 00:18:46,120
up role at the 13

280
00:18:46,120 --> 00:18:50,980
one no mention as you can see

281
00:18:50,980 --> 00:18:54,390
there's a lot of data sorting through

282
00:18:54,390 --> 00:18:57,650
he do injures and hex values

283
00:18:57,650 --> 00:19:01,910
do little to you sometimes

284
00:19:01,910 --> 00:19:05,350
value pop out you might be really
obvious and

285
00:19:05,350 --> 00:19:09,240
not so much involves love interaction
with the device changing settings

286
00:19:09,240 --> 00:19:12,640
and evaluating the difference between
two executions

287
00:19:12,640 --> 00:19:17,460
dole actually performing demonstration
shortly just to give you an example what

288
00:19:17,460 --> 00:19:17,910
you can

289
00:19:17,910 --> 00:19:21,700
back I'm interest in a single value

290
00:19:21,700 --> 00:19:25,160
now I'm going to use SNMP man

291
00:19:25,160 --> 00:19:29,710
and this is going to use get request
message to mention

292
00:19:29,710 --> 00:19:33,210
early and configure for to see

293
00:19:33,210 --> 00:19:40,210
public community pointed

294
00:19:42,399 --> 00:19:47,909
in year we see

295
00:19:47,909 --> 00:19:54,909
the SSID return

296
00:19:58,920 --> 00:20:03,330
pulling the same process we will find
some more values

297
00:20:03,330 --> 00:20:10,330
under the same object right

298
00:20:11,420 --> 00:20:14,980
here we have the BPA pre-shared

299
00:20:14,980 --> 00:20:18,870
in cleartext non-lawyer

300
00:20:18,870 --> 00:20:24,549
that's also available via the public
community string which is enabled by

301
00:20:24,549 --> 00:20:31,549
default on the and the other interesting

302
00:20:31,880 --> 00:20:35,110
here belongs you the

303
00:20:35,110 --> 00:20:38,510
evil corporation

304
00:20:38,510 --> 00:20:41,880
no I was actually able to acquire

305
00:20:41,880 --> 00:20:47,090
mid-table for this so I can burn more
about what the values actually means

306
00:20:47,090 --> 00:20:48,080
reversing am

307
00:20:48,080 --> 00:20:53,679
from making configuration changes but
I'm interested in a larger bloc about

308
00:20:53,679 --> 00:20:54,720
one

309
00:20:54,720 --> 00:20:58,980
I'm going to use with you the SNMP or
walk

310
00:20:58,980 --> 00:21:04,070
now this is going to use

311
00:21:04,070 --> 00:21:07,309
yesen debt all request method

312
00:21:07,309 --> 00:21:12,980
mentioned earlier

313
00:21:12,980 --> 00:21:16,410
again configuring perversion to see
Republic community

314
00:21:16,410 --> 00:21:23,410
pointed rap

315
00:21:29,950 --> 00:21:33,860
little bunnies has made a big scene we
see here the first value

316
00:21:33,860 --> 00:21:36,980
in plain text is

317
00:21:36,980 --> 00:21:40,270
the username

318
00:21:40,270 --> 00:21:44,020
or the device this is people labs

319
00:21:44,020 --> 00:21:47,730
portal services its standard

320
00:21:47,730 --> 00:21:50,920
to provide the user name for the device
by

321
00:21:50,920 --> 00:21:54,120
followed by the password

322
00:21:54,120 --> 00:21:57,900
and third value their is interesting

323
00:21:57,900 --> 00:22:01,720
represents manufacturer local

324
00:22:01,720 --> 00:22:05,010
one stands for this is mean

325
00:22:05,010 --> 00:22:10,010
the many factual device user interface
they're actually other options for

326
00:22:10,010 --> 00:22:13,160
custom images mode urals as well

327
00:22:13,160 --> 00:22:20,160
disabling injuries

328
00:22:27,490 --> 00:22:31,430
again just rehash the values that
upholding you can see a screenshot of

329
00:22:31,430 --> 00:22:32,150
the interface

330
00:22:32,150 --> 00:22:39,150
devices with actual does anyone live in
Raleigh

331
00:22:39,250 --> 00:22:43,530
do you happen to have a Netopia device
at home

332
00:22:43,530 --> 00:22:47,270
we decide to run showed in search

333
00:22:47,270 --> 00:22:52,040
narrowing it down to a single I S p an
interview devices with SNMP

334
00:22:52,040 --> 00:22:55,610
expose the Internet we found a little
over five hundred

335
00:22:55,610 --> 00:23:00,820
now it's important to know I ask you
some ice teaser

336
00:23:00,820 --> 00:23:05,210
good about this they're locking down S&P
on the Internet but not all of them are

337
00:23:05,210 --> 00:23:10,160
obviously in turn over their old you
demonstrate you be

338
00:23:10,160 --> 00:23:17,160
embed

339
00:23:20,570 --> 00:23:24,070
to reemphasize what Matthew showed you

340
00:23:24,070 --> 00:23:28,360
years initially gimme a sly worries that
there's a quarter-million

341
00:23:28,360 --> 00:23:31,530
devices out there as a quarter million
devices

342
00:23:31,530 --> 00:23:35,260
that potentially it the wireless is
configured give up their

343
00:23:35,260 --> 00:23:38,420
pre-shared keys over the Internet

344
00:23:38,420 --> 00:23:41,890
and as 500 E machines here in rally

345
00:23:41,890 --> 00:23:45,390
potentially give up their passwords

346
00:23:45,390 --> 00:23:49,420
their pre-shared keys and also the web
keys

347
00:23:49,420 --> 00:23:52,929
it's an able web is if you need them

348
00:23:52,929 --> 00:23:58,410
atom so moving on to another series of
devices in this is the

349
00:23:58,410 --> 00:24:01,940
me in but devices these particular
devices

350
00:24:01,940 --> 00:24:05,660
we found pretty much the same issues

351
00:24:05,660 --> 00:24:08,860
okay up but these devices

352
00:24:08,860 --> 00:24:11,950
good next slide these devices

353
00:24:11,950 --> 00:24:16,220
the embed which is pretty much getting
close to its complete in the life has

354
00:24:16,220 --> 00:24:19,640
been removed off the internet we still
have about 12,000 devices

355
00:24:19,640 --> 00:24:24,270
so if you happen to be in North Dakota
South Dakota

356
00:24:24,270 --> 00:24:28,490
and you want to get free wireless

357
00:24:28,490 --> 00:24:32,190
these devices give up their

358
00:24:32,190 --> 00:24:36,630
information also they give up their
pre-shared keys their web he's in there

359
00:24:36,630 --> 00:24:41,030
passwords so most of these devices in
the US or in North Dakota South Dakota

360
00:24:41,030 --> 00:24:42,570
and Wyoming Area

361
00:24:42,570 --> 00:24:46,020
getting over to the movie devices be

362
00:24:46,020 --> 00:24:50,530
is a manufacturer up cable modem devices
and most the devices or

363
00:24:50,530 --> 00:24:54,770
only and my sister getting your hands on
the device is

364
00:24:54,770 --> 00:24:58,300
is difficult least the latest current
devices:

365
00:24:58,300 --> 00:25:01,559
most other devices are used in foreign
places

366
00:25:01,559 --> 00:25:06,190
South America Central America but again
we're looking at

367
00:25:06,190 --> 00:25:09,960
nearly a quarter million devices that
are exposing a

368
00:25:09,960 --> 00:25:13,750
SNMP with the public community string
enable

369
00:25:13,750 --> 00:25:19,300
to the Internet according to show them
so

370
00:25:19,300 --> 00:25:23,830
next line so when a good demo here but
we're gonna do something a little

371
00:25:23,830 --> 00:25:26,110
different since we were showed you how
to get the

372
00:25:26,110 --> 00:25:30,260
the keys were gonna show you how to do
some quick comparisons

373
00:25:30,260 --> 00:25:37,260
when you're looking at data

374
00:25:46,550 --> 00:25:53,550
might shrink says downstair

375
00:25:55,630 --> 00:25:58,630
so as an example for go ahead and

376
00:25:58,630 --> 00:26:01,950
as math teacher is some the various
commands that you can actually use

377
00:26:01,950 --> 00:26:05,640
if we do as an MP

378
00:26:05,640 --> 00:26:12,640
koshen cross-eyed

379
00:26:18,860 --> 00:26:20,759
public

380
00:26:20,759 --> 00:26:24,240
and then we're gonna go against the Hui
device we have years at DTE

381
00:26:24,240 --> 00:26:27,369
DTW a 3611 device

382
00:26:27,369 --> 00:26:31,289
hopefully it's

383
00:26:31,289 --> 00:26:35,529
up running okay now this is a test

384
00:26:35,529 --> 00:26:39,700
was a community or what was the Leidy
that I gave you

385
00:26:39,700 --> 00:26:43,059
2.2 the Privett need location

386
00:26:43,059 --> 00:26:47,460
bingo

387
00:26:47,460 --> 00:26:50,590
one 3

388
00:26:50,590 --> 00:26:54,869
6 through one 4.1

389
00:26:54,869 --> 00:26:59,690
should be in so we can easily dump

390
00:26:59,690 --> 00:27:03,409
the status so if you want to look at the
most important stuff we found that

391
00:27:03,409 --> 00:27:06,350
typically like we mentioned earlier
that's going to be located at the

392
00:27:06,350 --> 00:27:07,899
private enterprise location

393
00:27:07,899 --> 00:27:12,360
so during analysis of the device you
never know what

394
00:27:12,360 --> 00:27:16,610
a is available on the device and if
you're able to make modifications

395
00:27:16,610 --> 00:27:21,470
device the cool thing is take a snapshot
of that make modification take another

396
00:27:21,470 --> 00:27:22,230
snapshot

397
00:27:22,230 --> 00:27:26,590
as Matthew mention a lot of times the
date is quite obvious when you're

398
00:27:26,590 --> 00:27:28,299
looking through the area you see

399
00:27:28,299 --> 00:27:32,200
you know keep things in there you go hey
that's probably something important you

400
00:27:32,200 --> 00:27:32,619
know

401
00:27:32,619 --> 00:27:36,749
if if the name route is an errand and
after that is a

402
00:27:36,749 --> 00:27:41,409
ash hey we may have a user name and a
password

403
00:27:41,409 --> 00:27:45,539
type thing but a lot of times I it may
not be quite as

404
00:27:45,539 --> 00:27:48,700
obviously you need to do some
comparisons so

405
00:27:48,700 --> 00:27:52,700
the purposive love this quick little
demo is like okay let's

406
00:27:52,700 --> 00:27:56,529
let's go ahead and do a quick comparison
NC

407
00:27:56,529 --> 00:28:01,259
see how we can identify stuff so in this
case here let's go ahead in

408
00:28:01,259 --> 00:28:08,259
capture the state out so we'll go ahead
and just

409
00:28:08,289 --> 00:28:12,110
San this data over to a file called
example one

410
00:28:12,110 --> 00:28:18,249
sewing capture that out quickly and then
then we have access to the device and

411
00:28:18,249 --> 00:28:19,159
here's a

412
00:28:19,159 --> 00:28:22,470
what beautiful be device

413
00:28:22,470 --> 00:28:29,470
and we can come over here we can see
that in this case the WPA pre-shared key

414
00:28:29,690 --> 00:28:36,690
is a that be

415
00:28:45,289 --> 00:28:52,289
where to go ahead and change that and
we're gonna quickly save it out

416
00:29:01,529 --> 00:29:05,860
knowing go ahead and say that I'll
hopefully I actually see so we set the

417
00:29:05,860 --> 00:29:06,419
example

418
00:29:06,419 --> 00:29:09,470
example to and then we can easily just
do it if

419
00:29:09,470 --> 00:29:13,049
if we spell accorded

420
00:29:13,049 --> 00:29:20,049
did stiffly don't work

421
00:29:20,900 --> 00:29:24,280
in area sewing compare these quickly

422
00:29:24,280 --> 00:29:27,380
and as we can see we have a number up to

423
00:29:27,380 --> 00:29:31,390
things that have actually changed it's
common to see things like counters and

424
00:29:31,390 --> 00:29:32,670
stuff like that are

425
00:29:32,670 --> 00:29:36,140
conflict changer anchormen you're gonna
show those but we can quickly find

426
00:29:36,140 --> 00:29:37,100
something

427
00:29:37,100 --> 00:29:40,460
in this case here which is the
pre-shared key

428
00:29:40,460 --> 00:29:46,220
that is actually changed that's kinda
cool

429
00:29:46,220 --> 00:29:53,220
not do that to me

430
00:29:54,559 --> 00:29:57,549
track that down a little bit more sewing
is gone so

431
00:29:57,549 --> 00:30:03,719
let's do another quick just for the sake
of doing something different

432
00:30:03,719 --> 00:30:08,320
as we've seen the BPA's already let's go
ahead and a

433
00:30:08,320 --> 00:30:13,999
we can disable this and mice for the
Sega something different

434
00:30:13,999 --> 00:30:17,339
let's go ahead and do the web keys

435
00:30:17,339 --> 00:30:20,859
just in case you encounter some it's too
easy way up

436
00:30:20,859 --> 00:30:27,859
we can apply that

437
00:30:39,260 --> 00:30:46,260
sale three

438
00:30:53,310 --> 00:30:56,700
and we can run that broke work and we
can see its worst showed up at the top

439
00:30:56,700 --> 00:30:57,550
of the screen

440
00:30:57,550 --> 00:31:00,920
so you see that they're these devices
also give up the web keys

441
00:31:00,920 --> 00:31:05,260
so by doing this compare to you can see
all simple as with the simple def

442
00:31:05,260 --> 00:31:09,220
with SNMP walk S&P ball Walker S&P gives

443
00:31:09,220 --> 00:31:13,810
for various values we can go back and
forth in quickly discover devices that

444
00:31:13,810 --> 00:31:14,460
have been all

445
00:31:14,460 --> 00:31:17,790
a a key pieces data were stored in
device

446
00:31:17,790 --> 00:31:21,370
this is a good bet especially be dealing
with data that may be

447
00:31:21,370 --> 00:31:25,890
encoder cryptid maybe not obvious just
look into the device

448
00:31:25,890 --> 00:31:29,000
but this makes a method for actually
being able to do that

449
00:31:29,000 --> 00:31:32,950
anyone have any questions that kinda at
this point is everyone understand what

450
00:31:32,950 --> 00:31:33,860
we're talking about

451
00:31:33,860 --> 00:31:37,210
and we've actually proven that

452
00:31:37,210 --> 00:31:44,210
up there's a one dumb shit out there

453
00:31:47,010 --> 00:31:48,410
I've yet to figure that one out

454
00:31:48,410 --> 00:31:52,460
you know typically we expect by nine
data in the

455
00:31:52,460 --> 00:31:57,260
within them within the S&P Mid tables we
won by nine days day to use for

456
00:31:57,260 --> 00:31:59,600
management we check temperatures you
know hey

457
00:31:59,600 --> 00:32:03,040
you know as a configured right things
like that

458
00:32:03,040 --> 00:32:07,980
but unfortunately as you see in this so
for other actually exposing

459
00:32:07,980 --> 00:32:13,030
things that we would actually consider
things you know one exposed

460
00:32:13,030 --> 00:32:16,260
but they were dealing with other things
not owns the vendor doing this but as

461
00:32:16,260 --> 00:32:18,920
we've shown we worry showed you a half
million

462
00:32:18,920 --> 00:32:22,420
a half million devices we were told
you're on the internet

463
00:32:22,420 --> 00:32:26,720
and trust me there's a lot more where
you can pull WPA pre-shared keys

464
00:32:26,720 --> 00:32:31,500
the web keys remotely over the Internet
what about the ISP's

465
00:32:31,500 --> 00:32:38,500
damn you know thats pretty bad

466
00:32:46,840 --> 00:32:50,940
yes he did and no they have not given me
an answer and yes I vast

467
00:32:50,940 --> 00:32:55,620
inner and their answer was well the
devices that you showed us are

468
00:32:55,620 --> 00:32:58,620
and the wife so we really don't care and
were like

469
00:32:58,620 --> 00:33:02,360
heavy bothered I actually asked one time
I said have you actually because it

470
00:33:02,360 --> 00:33:03,880
would be actually it'd be on phone

471
00:33:03,880 --> 00:33:07,910
and I said yeah but you know you bring
me up tables forward

472
00:33:07,910 --> 00:33:13,310
or are they still in your current
devices and silence okay

473
00:33:13,310 --> 00:33:17,320
and I goes what are your most current
supported devices that I can actually

474
00:33:17,320 --> 00:33:18,440
get my hands on

475
00:33:18,440 --> 00:33:22,310
and then they claim they would even tell
me where I can get my hands on device

476
00:33:22,310 --> 00:33:26,560
a and then a vaguely accuse me of
extortion

477
00:33:26,560 --> 00:33:30,420
I'm like extortion what like

478
00:33:30,420 --> 00:33:33,560
this is like extortion we don't want
nothing from you

479
00:33:33,560 --> 00:33:36,720
trying to help you

480
00:33:36,720 --> 00:33:41,720
K so was getting restless come move
let's come we won't get through the rest

481
00:33:41,720 --> 00:33:42,300
this

482
00:33:42,300 --> 00:33:46,770
so here from from the a demo stuff here
is that okay

483
00:33:46,770 --> 00:33:50,590
are re: here are the permission where he
should de muscle

484
00:33:50,590 --> 00:33:53,830
act in the slide though problem

485
00:33:53,830 --> 00:33:57,290
even prepared getting into up

486
00:33:57,290 --> 00:34:02,150
up on participation at the one you think
is being poured

487
00:34:02,150 --> 00:34:05,540
scope what complete aptly this

488
00:34:05,540 --> 00:34:12,540
you up

489
00:34:14,530 --> 00:34:18,430
it the number years ago was really
written to pull data via

490
00:34:18,430 --> 00:34:21,770
multifunction printers and it's like it
tolley best

491
00:34:21,770 --> 00:34:25,660
okay least buy things so it's up

492
00:34:25,660 --> 00:34:28,580
freight is Latin for plunder booty
spoils the war that's what it is we're

493
00:34:28,580 --> 00:34:30,390
stealing data that's what purposes

494
00:34:30,390 --> 00:34:34,500
currently it pulls a bunch of stuff you
can be downloaded from right there

495
00:34:34,500 --> 00:34:38,630
a all the stuff we showed you the day is
not out there yet

496
00:34:38,630 --> 00:34:42,350
it will be before the weekends over with
seeing Paul new version down

497
00:34:42,350 --> 00:34:45,510
and will be able to attack the specific
nato peers

498
00:34:45,510 --> 00:34:51,610
you when she hears over there need to be
who we devices and stuff like that

499
00:34:51,610 --> 00:34:54,820
next slide to move on from there

500
00:34:54,820 --> 00:34:58,900
we all know I work for at seven right
there were no I work for a bit some

501
00:34:58,900 --> 00:35:02,820
okay cool I work for a so we got a new
project going on call

502
00:35:02,820 --> 00:35:06,540
I'll pray at us boy call me

503
00:35:06,540 --> 00:35:09,880
the goal is is we're migrating prieta

504
00:35:09,880 --> 00:35:14,880
over to Metasploit all the modules over
to medal sport we started to

505
00:35:14,880 --> 00:35:18,360
fred is not going to go away completely
it's still going to be written as a

506
00:35:18,360 --> 00:35:21,710
ski and search engine thinkin
fingerprint embedded devices that

507
00:35:21,710 --> 00:35:23,580
contain data that you want to steal

508
00:35:23,580 --> 00:35:27,590
and it'll be nice enough to pass that
over to you Metasploit to steal it for

509
00:35:27,590 --> 00:35:29,610
you that's ongoing

510
00:35:29,610 --> 00:35:33,070
I'll so

511
00:35:33,070 --> 00:35:37,860
we don't know where that's going to be
right now so next the SPG 65

512
00:35:37,860 --> 00:35:41,840
evil bottom there under my grammar

513
00:35:41,840 --> 00:35:48,840
later we actually put that in there
Tauranga passed down

514
00:35:50,360 --> 00:35:51,540
so we actually have a couple

515
00:35:51,540 --> 00:35:55,740
demos here a Metis ploy in a Predator
demo that we're gonna do

516
00:35:55,740 --> 00:35:59,530
so jump over there do that I'm gonna
demonstrate

517
00:35:59,530 --> 00:36:03,170
is good bombs I'm

518
00:36:03,170 --> 00:36:06,730
them BSB 65 mod

519
00:36:06,730 --> 00:36:13,730
so

520
00:36:14,790 --> 00:36:18,640
first thing to do gonna load the model
under

521
00:36:18,640 --> 00:36:23,070
scanners director

522
00:36:23,070 --> 00:36:27,680
check the information

523
00:36:27,680 --> 00:36:32,430
with you your both are

524
00:36:32,430 --> 00:36:36,220
Hildreth

525
00:36:36,220 --> 00:36:43,220
sp6 MIDI on our land confirming

526
00:36:44,190 --> 00:36:49,800
figured and did a lotta

527
00:36:49,800 --> 00:36:53,120
information about nicely formatted

528
00:36:53,120 --> 00:36:57,680
and without all the work thinking Boyd

529
00:36:57,680 --> 00:37:00,700
this will also anne-marie morley

530
00:37:00,700 --> 00:37:04,590
when use all wireless encryption

531
00:37:04,590 --> 00:37:07,690
creation radius back

532
00:37:07,690 --> 00:37:14,690
really server and Yemen

533
00:37:16,030 --> 00:37:20,160
Donegan delivered okay so it's like to
legal

534
00:37:20,160 --> 00:37:24,260
okay by Yuri so now you can eventually
presso you print

535
00:37:24,260 --> 00:37:27,960
still BPA key author offered places
especially

536
00:37:27,960 --> 00:37:33,590
if you use an ISP is published their
public S&P to the Internet

537
00:37:33,590 --> 00:37:37,830
when they me caller so so with the
Netopia

538
00:37:37,830 --> 00:37:41,550
I'll in this particular one

539
00:37:41,550 --> 00:37:45,120
the SPG 65 E models mott in

540
00:37:45,120 --> 00:37:48,360
but it's available you can down you
you'll be able to download it right

541
00:37:48,360 --> 00:37:52,370
it'll be available on and or or

542
00:37:52,370 --> 00:37:56,810
the minute on which will eventually be

543
00:37:56,810 --> 00:38:00,100
incorporated in all models for the be

544
00:38:00,100 --> 00:38:03,790
gambit in the Toby are in the current
down version

545
00:38:03,790 --> 00:38:06,840
sports download as a plan when

546
00:38:06,840 --> 00:38:13,840
an actual for now

547
00:38:15,890 --> 00:38:18,439
so now we get it demo the ultimate be

548
00:38:18,439 --> 00:38:25,439
guber cool too prieta hopefully it
actually works so many contests as we

549
00:38:26,789 --> 00:38:27,429
have it here

550
00:38:27,429 --> 00:38:31,479
we got one have you ever use pre and I
have you ever

551
00:38:31,479 --> 00:38:34,749
if you use it call

552
00:38:34,749 --> 00:38:38,059
can with the recommend given try

553
00:38:38,059 --> 00:38:41,489
we use this turnover pen test and a

554
00:38:41,489 --> 00:38:46,169
prado's capable a and and successfully
pools

555
00:38:46,169 --> 00:38:49,659
Active Directory credentials of number

556
00:38:49,659 --> 00:38:53,419
multifunction printer devices probably
on

557
00:38:53,419 --> 00:38:56,979
upwards of 50 personally engagement
someone so

558
00:38:56,979 --> 00:39:01,739
so we look at this real quick we can see
there's a

559
00:39:01,739 --> 00:39:06,599
some command structure you get either
passe in map GM ap output file right

560
00:39:06,599 --> 00:39:07,179
into it

561
00:39:07,179 --> 00:39:12,630
for scanning I used pass a target file
ring pass a sighter into it

562
00:39:12,630 --> 00:39:16,219
in this case here we're actually going
to

563
00:39:16,219 --> 00:39:23,219
Paso cider

564
00:39:24,990 --> 00:39:29,310
we recommend put a port number n we
fingerprint you since couple different

565
00:39:29,310 --> 00:39:31,520
things almost all better devices have
web

566
00:39:31,520 --> 00:39:35,950
services enable so that's easy enough to
you use that information typically to

567
00:39:35,950 --> 00:39:36,780
fingerprint

568
00:39:36,780 --> 00:39:40,610
would create a project name call CC 10

569
00:39:40,610 --> 00:39:45,070
and then give it a log be will call test
one's example

570
00:39:45,070 --> 00:39:51,390
and then we run it and hopefully it
works here

571
00:39:51,390 --> 00:39:55,400
there your number 12 waste site not to
work

572
00:39:55,400 --> 00:39:58,690
for some reason so I think it's the

573
00:39:58,690 --> 00:40:02,320
ambit are grabbed the wrong one drunks
tubers

574
00:40:02,320 --> 00:40:05,900
morning sowwy

575
00:40:05,900 --> 00:40:09,580
goes through it what it does is a
fingerprints the device and it calls a

576
00:40:09,580 --> 00:40:13,350
it's all pearl base calls a module that
it finds

577
00:40:13,350 --> 00:40:17,120
wanted fingerprints knows what modular
call

578
00:40:17,120 --> 00:40:21,900
and it carries out these various attacks
and

579
00:40:21,900 --> 00:40:25,290
commemorate state of the device is here
cells

580
00:40:25,290 --> 00:40:29,000
and stop it at that point and we can
change over the CC 10 folder that it

581
00:40:29,000 --> 00:40:29,620
created

582
00:40:29,620 --> 00:40:33,860
and legacy created a number files a
warmer interesting here is the

583
00:40:33,860 --> 00:40:39,460
test 1.0 log and as we quickly see

584
00:40:39,460 --> 00:40:42,920
I'll it fingerprints the device it

585
00:40:42,920 --> 00:40:47,900
accuse you information about it device
your YouTube PA pulls the EPA keys

586
00:40:47,900 --> 00:40:53,710
this when his username password tell you
what the SSID is it also says Webzen

587
00:40:53,710 --> 00:40:54,340
able

588
00:40:54,340 --> 00:40:58,790
it pools web keys also tell you what's
the act with key this be

589
00:40:58,790 --> 00:41:02,920
he lies right now and also the Motorola
device

590
00:41:02,920 --> 00:41:07,030
same thing actually gives you pre-shared
key information or web key information

591
00:41:07,030 --> 00:41:08,450
on the device ever house actually

592
00:41:08,450 --> 00:41:13,470
figured Asus and I thought or you can
typically under an assessment you can

593
00:41:13,470 --> 00:41:14,790
just kick it off in Iran

594
00:41:14,790 --> 00:41:18,030
and it will if it detects any devices

595
00:41:18,030 --> 00:41:24,000
and in these consumer grade modems and
ES cells were talking about I think wall

596
00:41:24,000 --> 00:41:28,340
where where would that come into play on
a these are home base system see a

597
00:41:28,340 --> 00:41:32,520
yearly our home base systems typically
but I often find

598
00:41:32,520 --> 00:41:36,000
I'm these devices deployed in small
business are in biz

599
00:41:36,000 --> 00:41:39,160
small businesses in large business
satellite offices

600
00:41:39,160 --> 00:41:42,510
CDU stone counter these things so

601
00:41:42,510 --> 00:41:45,570
that's why we build in these pen test
tools because

602
00:41:45,570 --> 00:41:50,040
even though some these are into life
they're gonna be around for another 45

603
00:41:50,040 --> 00:41:50,850
years

604
00:41:50,850 --> 00:41:54,780
at least and we do find these in
businesses and corporations

605
00:41:54,780 --> 00:42:01,780
on on a number occasions

606
00:42:06,589 --> 00:42:11,280
or as i won enterprise bro enterprise
surprise are you

607
00:42:11,280 --> 00:42:15,430
looked know we just demonstrate a lotta

608
00:42:15,430 --> 00:42:19,859
you consumer grade hard that's because
formal

609
00:42:19,859 --> 00:42:23,330
to start a research but I don't want you

610
00:42:23,330 --> 00:42:26,869
what review thinking that on the devices
like this

611
00:42:26,869 --> 00:42:30,630
honorable information exposure yesen

612
00:42:30,630 --> 00:42:33,790
the Darrell found good example during

613
00:42:33,790 --> 00:42:37,000
and injured explode

614
00:42:37,000 --> 00:42:41,080
so during the contest an external
contest

615
00:42:41,080 --> 00:42:45,710
are I discovered a company that had a
deployed a brocade

616
00:42:45,710 --> 00:42:49,589
load balancer very popular brown sir and
the cost

617
00:42:49,589 --> 00:42:53,190
around twenty thousand dollars so i cant
demo one today

618
00:42:53,190 --> 00:42:58,380
no was nice enough to give me a twenty
thousand dollar device to screw with

619
00:42:58,380 --> 00:43:02,020
that's won the pen tester unpaid disc
with the devices

620
00:43:02,020 --> 00:43:06,180
when they don't expect so turns out the

621
00:43:06,180 --> 00:43:10,150
looking at brocade there's actually a
upwards of nine thousand

622
00:43:10,150 --> 00:43:14,250
these exposing S&P to the Internet the
enterprise-level devices and large

623
00:43:14,250 --> 00:43:15,190
corporations

624
00:43:15,190 --> 00:43:18,330
during my pen test we discovered a

625
00:43:18,330 --> 00:43:23,890
as an MP expose the Internet I Paul is
an S&P walk the entire tree structure

626
00:43:23,890 --> 00:43:29,760
other device and I took the time to look
through it turns out what I found was

627
00:43:29,760 --> 00:43:33,280
I could pull the username and the
password hashes all configured on that

628
00:43:33,280 --> 00:43:34,660
device for the ministers

629
00:43:34,660 --> 00:43:38,349
so a pretty big so it is a password hash

630
00:43:38,349 --> 00:43:41,520
see at the crack and offline but

631
00:43:41,520 --> 00:43:45,570
if people have not realize there's these
things called GP use

632
00:43:45,570 --> 00:43:50,200
you can speed this process up fairly
quickly especially if it's not a very

633
00:43:50,200 --> 00:43:51,290
long or

634
00:43:51,290 --> 00:43:55,070
extremely complex password and in this
case here

635
00:43:55,070 --> 00:43:59,730
I was able to crack the password on our
device from less than 24 hours

636
00:43:59,730 --> 00:44:03,359
which eventually gave me for
administrative access

637
00:44:03,359 --> 00:44:06,400
into their load balancer over the
Internet

638
00:44:06,400 --> 00:44:10,700
like you said 9000 these expose out
there

639
00:44:10,700 --> 00:44:16,030
go to the next line so we do have a
misplay module is deployed out there

640
00:44:16,030 --> 00:44:20,800
without yesterday that is available to
do that also so this example here

641
00:44:20,800 --> 00:44:24,030
so the this is kinda funny so

642
00:44:24,030 --> 00:44:27,770
this example here was was a snapshot of
a real

643
00:44:27,770 --> 00:44:31,140
assessment choc okay but this has been
cooked

644
00:44:31,140 --> 00:44:35,180
sawwy people taking pictures this and
try to crack the passwords

645
00:44:35,180 --> 00:44:38,410
if you crack one these let me know
causes

646
00:44:38,410 --> 00:44:42,099
police fabricated obviously I don't want
to put something out there that's real

647
00:44:42,099 --> 00:44:42,609
world

648
00:44:42,609 --> 00:44:47,609
reality but this is the rule ski and the
only thing I did was switch a lot of

649
00:44:47,609 --> 00:44:50,060
things around so the they're kinda cook
numbers

650
00:44:50,060 --> 00:44:54,080
so that I wouldn't compromise a customer
or

651
00:44:54,080 --> 00:44:57,550
or something like that the names have
been altered a little bit but the tools

652
00:44:57,550 --> 00:44:58,490
kinda cool

653
00:44:58,490 --> 00:45:03,300
if you can pull the state about down a
the key thing what you think about a

654
00:45:03,300 --> 00:45:04,119
whole thing is

655
00:45:04,119 --> 00:45:07,140
so I can get access to the Brocade low
bouncer

656
00:45:07,140 --> 00:45:10,520
if I cracked these passwords what else I
get access to

657
00:45:10,520 --> 00:45:13,859
more likely only get access to all other

658
00:45:13,859 --> 00:45:17,450
network infrastructure switches routers
firewalls

659
00:45:17,450 --> 00:45:22,430
because these are typically gonna be
network administrators that have put

660
00:45:22,430 --> 00:45:23,690
this device is out there

661
00:45:23,690 --> 00:45:27,880
at least some others accounts will be so
you can see the the critical nature

662
00:45:27,880 --> 00:45:31,109
I love this phone ability

663
00:45:31,109 --> 00:45:35,010
you know and I have had people come to
me and go well you know

664
00:45:35,010 --> 00:45:38,500
its S&P public you know in

665
00:45:38,500 --> 00:45:41,900
and you know ish turn it off yes

666
00:45:41,900 --> 00:45:45,310
but what do I say earlier we got
seventeen thousand people

667
00:45:45,310 --> 00:45:48,510
that a are $17 million people

668
00:45:48,510 --> 00:45:52,530
seventy million instances the not turned
it off exposed to the Internet around

669
00:45:52,530 --> 00:45:53,050
the world

670
00:45:53,050 --> 00:45:57,020
I going to companies and organizations
and you can ask the pen tester back here

671
00:45:57,020 --> 00:45:57,780
to

672
00:45:57,780 --> 00:46:01,650
how often do you find devices with SNMP

673
00:46:01,650 --> 00:46:05,420
public community string enable and I
have to admit

674
00:46:05,420 --> 00:46:09,680
I can count on one hand the number of
companies that I've found that

675
00:46:09,680 --> 00:46:14,280
do not have occurrences that on their
network I find it every

676
00:46:14,280 --> 00:46:19,790
case and it's very critical it's very
concerning to me is a pen tester

677
00:46:19,790 --> 00:46:23,030
and that's where this whole project
started from so it's kinda cool hope you

678
00:46:23,030 --> 00:46:23,839
guys enjoy it

679
00:46:23,839 --> 00:46:27,220
art me

680
00:46:27,220 --> 00:46:30,280
mid for the vendor's

681
00:46:30,280 --> 00:46:33,569
bender should stop placing sensitive

682
00:46:33,569 --> 00:46:36,750
im public community at the naval by to

683
00:46:36,750 --> 00:46:40,660
all how many people agree with that

684
00:46:40,660 --> 00:46:44,790
okay get a consensus and we should
probably move away

685
00:46:44,790 --> 00:46:48,230
version 1&2 see community

686
00:46:48,230 --> 00:46:52,359
in fever stronger security model

687
00:46:52,359 --> 00:46:59,359
there what should and user amid

688
00:47:01,310 --> 00:47:04,330
was turned off you know

689
00:47:04,330 --> 00:47:09,130
you as technologists when you go back to
your company

690
00:47:09,130 --> 00:47:13,050
the things that I want you to consider
doing in your organization is

691
00:47:13,050 --> 00:47:17,310
your bill processes and policies that
control and deployment in new

692
00:47:17,310 --> 00:47:18,569
technologies in your

693
00:47:18,569 --> 00:47:22,940
company so as part of the deployment
process

694
00:47:22,940 --> 00:47:27,400
you need to create a process that says
before any device goes out

695
00:47:27,400 --> 00:47:30,619
we have a checkbox is SNMP enable

696
00:47:30,619 --> 00:47:34,060
to use it no turn it off

697
00:47:34,060 --> 00:47:37,970
to use it yes said it to a complex
community string

698
00:47:37,970 --> 00:47:43,630
but not only said to complex securities
tree send different security levels

699
00:47:43,630 --> 00:47:48,700
I can I've lost count of the number of
routers switches and firewalls

700
00:47:48,700 --> 00:47:52,839
a Cisco that I've compromised in an
organization

701
00:47:52,839 --> 00:47:56,819
because I was able to strip the S&P
community string that they were using

702
00:47:56,819 --> 00:48:00,400
of a camera on the network okay

703
00:48:00,400 --> 00:48:05,020
those are different security level
devices do not use the same password

704
00:48:05,020 --> 00:48:08,750
okay it's no different you do not give
everyone in your company

705
00:48:08,750 --> 00:48:12,740
the same password you settle a domain
admin account you

706
00:48:12,740 --> 00:48:15,770
so don't do that with your devices
either

707
00:48:15,770 --> 00:48:20,819
also do not expose the Internet so if
you follow the first two rules

708
00:48:20,819 --> 00:48:24,310
you're probably not going to expose it
to the internet access can be turned off

709
00:48:24,310 --> 00:48:28,440
but also think about devices that he
deployed to the Internet

710
00:48:28,440 --> 00:48:32,740
somewhere 9,000 people decided hey we're
putting up a

711
00:48:32,740 --> 00:48:36,050
broke a load balancer and we need people
to

712
00:48:36,050 --> 00:48:40,400
get access to our web servers or
applications that were load balancing

713
00:48:40,400 --> 00:48:43,560
so what should we put in a room or the
firewall how about any

714
00:48:43,560 --> 00:48:47,830
any to that device that way we won't
have any do problems

715
00:48:47,830 --> 00:48:52,480
bullshit think about what you're doing
do not do those things

716
00:48:52,480 --> 00:48:57,290
actually configure your firewall to
block everything but what's needed

717
00:48:57,290 --> 00:49:01,290
anatole help resolve some these issues
also

718
00:49:01,290 --> 00:49:06,160
so up that is our presentation I hope
you enjoy it he had some fun out of it

719
00:49:06,160 --> 00:49:07,950
is really questions

720
00:49:07,950 --> 00:49:11,250
yessir

721
00:49:11,250 --> 00:49:14,420
some devices do long these request a

722
00:49:14,420 --> 00:49:18,060
and it's interesting deal with logging
on these devices we found I found a

723
00:49:18,060 --> 00:49:19,280
number devices

724
00:49:19,280 --> 00:49:23,319
that long everything on S&P so

725
00:49:23,319 --> 00:49:26,359
it is also possible haven't

726
00:49:26,359 --> 00:49:29,950
haven't found it yet but I'm working
where someone could log on to a device

727
00:49:29,950 --> 00:49:33,790
in in a burly entered the user password
and the username slot

728
00:49:33,790 --> 00:49:37,220
and actually have it law into the
longest

729
00:49:37,220 --> 00:49:41,260
because I found them log in the
usernames a people but not the password

730
00:49:41,260 --> 00:49:42,580
from the devices

731
00:49:42,580 --> 00:49:47,089
to the whole login a and I i don't think
it's on every currents

732
00:49:47,089 --> 00:49:51,869
I am validated that but a I do believe
some devices

733
00:49:51,869 --> 00:49:55,560
appear to log those type transactions

734
00:49:55,560 --> 00:50:02,560
yessir

735
00:50:04,000 --> 00:50:07,619
actually this is the entry point for
larger project

736
00:50:07,619 --> 00:50:11,630
okay that be met you're working on so
expect some

737
00:50:11,630 --> 00:50:15,980
that's one of the reasons why I got
myself an i an assigned number

738
00:50:15,980 --> 00:50:20,900
so we can actually the goal is to
actually create

739
00:50:20,900 --> 00:50:24,349
hell you know if you're still a little
thing from usership the goal is to be

740
00:50:24,349 --> 00:50:26,990
actually be able to create a device

741
00:50:26,990 --> 00:50:30,410
a a small device with its own bed tables

742
00:50:30,410 --> 00:50:33,650
so that it can be used to attack

743
00:50:33,650 --> 00:50:40,650
management control agents that's the
goal

744
00:51:05,450 --> 00:51:08,610
in

745
00:51:08,610 --> 00:51:11,290
day

746
00:51:11,290 --> 00:51:14,120
in

747
00:51:14,120 --> 00:51:19,070
like

748
00:51:19,070 --> 00:51:21,290
to look into the further so

749
00:51:21,290 --> 00:51:24,820
I think a lot of those like the web
interface isn't

750
00:51:24,820 --> 00:51:27,840
recent blog but it's Lee the last 103

751
00:51:27,840 --> 00:51:34,840
again

752
00:51:46,940 --> 00:51:50,280
all of the you know it you know

753
00:51:50,280 --> 00:51:55,110
I'll tell you straight up who cares by
any cable modem you one who cares what

754
00:51:55,110 --> 00:51:55,780
they do

755
00:51:55,780 --> 00:51:59,440
just don't use their wireless services
of the cable modem you'll be fine will

756
00:51:59,440 --> 00:52:00,000
be on

757
00:52:00,000 --> 00:52:03,470
I mean check your ISP some right or

758
00:52:03,470 --> 00:52:07,080
down a lot of the new stuff has been
shut down

759
00:52:07,080 --> 00:52:12,270
and by default a by default S&P is not
can be enabled on the uplink

760
00:52:12,270 --> 00:52:16,830
love these devices the vendor or the ISP
has to enable on the up

761
00:52:16,830 --> 00:52:21,390
so be by default these devices not been
able by default half the devices we

762
00:52:21,390 --> 00:52:22,050
talked about

763
00:52:22,050 --> 00:52:27,010
S&P's enable only downing the inside
side with the states but not the

764
00:52:27,010 --> 00:52:30,900
uplink side so we're actually seeing a
lot of vendors at least the current

765
00:52:30,900 --> 00:52:31,380
stuff

766
00:52:31,380 --> 00:52:35,210
seem to either be disabling it or set it
very complex

767
00:52:35,210 --> 00:52:38,730
community string that they control but
we're dealing with

768
00:52:38,730 --> 00:52:42,270
to a lot of legacy water that's legacy
issues

769
00:52:42,270 --> 00:52:47,310
BellSouth the AT&T literally I I think

770
00:52:47,310 --> 00:52:50,850
II I think ahead over a hundred thousand

771
00:52:50,850 --> 00:52:55,200
in the US that copious that allow an
SNMP over the

772
00:52:55,200 --> 00:52:58,230
Internet and other generally BellSouth

773
00:52:58,230 --> 00:53:01,730
so everyone here in Raleigh yet have a
Netopia

774
00:53:01,730 --> 00:53:05,360
I can probably pretty much cutie if you
use in the wireless

775
00:53:05,360 --> 00:53:09,490
so does everybody else are

776
00:53:09,490 --> 00:53:12,690
I think you're pretty much finished his
round time we're gonna be around today

777
00:53:12,690 --> 00:53:13,280
in

778
00:53:13,280 --> 00:53:17,780
parted tomorrow so feel free to grab us
if you have any more questions you want

779
00:53:17,780 --> 00:53:18,390
to talk

780
00:53:18,390 --> 00:53:19,670
thank you very much

