1
00:00:00,000 --> 00:00:05,270
<font color="#E5E5E5">that please</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> stop</font>

2
00:00:05,660 --> 00:00:15,870
<font color="#E5E5E5">okay so I'm going to be talking about</font>

3
00:00:12,120 --> 00:00:18,529
return oh I'm<font color="#E5E5E5"> pin track for those that</font>

4
00:00:15,870 --> 00:00:23,390
didn't come into the hardware hacking<font color="#CCCCCC"> oh</font>

5
00:00:18,529 --> 00:00:23,390
it's going it still<font color="#CCCCCC"> is</font>

6
00:00:36,920 --> 00:00:42,290
so I can't walk around<font color="#E5E5E5"> it's probably</font>

7
00:00:39,660 --> 00:00:42,290
<font color="#CCCCCC">better that way</font>

8
00:00:42,650 --> 00:00:54,720
so I'm<font color="#CCCCCC"> panda</font><font color="#E5E5E5"> tracks</font><font color="#CCCCCC"> oh yeah I know</font><font color="#E5E5E5"> I</font>

9
00:00:51,690 --> 00:00:56,849
<font color="#CCCCCC">know and I'm going</font><font color="#E5E5E5"> to be</font><font color="#CCCCCC"> talking about</font>

10
00:00:54,720 --> 00:01:00,570
<font color="#CCCCCC">return-oriented programming this morning</font>

11
00:00:56,850 --> 00:01:03,750
and which is a great topic first thing

12
00:01:00,570 --> 00:01:09,300
on a Sunday did you guys<font color="#E5E5E5"> just wake up</font>

13
00:01:03,750 --> 00:01:11,100
that's awesome<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> now yeah well there</font>

14
00:01:09,300 --> 00:01:15,390
you go<font color="#E5E5E5"> that that probably is what I</font>

15
00:01:11,100 --> 00:01:24,210
<font color="#E5E5E5">should</font><font color="#CCCCCC"> have done so return-oriented</font>

16
00:01:15,390 --> 00:01:27,930
programming<font color="#E5E5E5"> first</font><font color="#CCCCCC"> - am i i'm</font><font color="#E5E5E5"> pen tracks</font>

17
00:01:24,210 --> 00:01:31,080
<font color="#CCCCCC">i like</font><font color="#E5E5E5"> to tear things</font><font color="#CCCCCC"> apart i don't</font>

18
00:01:27,930 --> 00:01:33,810
build<font color="#E5E5E5"> things but they asked me to write</font>

19
00:01:31,080 --> 00:01:37,020
the code<font color="#CCCCCC"> for the badges and you</font><font color="#E5E5E5"> get what</font>

20
00:01:33,810 --> 00:01:40,979
you paid for<font color="#CCCCCC"> right my god because i</font>

21
00:01:37,020 --> 00:01:43,470
<font color="#E5E5E5">don't build things</font><font color="#CCCCCC"> I also teach an</font>

22
00:01:40,979 --> 00:01:45,690
exploit<font color="#E5E5E5"> develop development class which</font>

23
00:01:43,470 --> 00:01:47,908
it you know<font color="#E5E5E5"> some people seem to a lot of</font>

24
00:01:45,690 --> 00:01:51,179
<font color="#E5E5E5">people seem to like so check me out on</font>

25
00:01:47,909 --> 00:01:52,380
Twitter what's<font color="#E5E5E5"> that</font><font color="#CCCCCC"> oh thank</font><font color="#E5E5E5"> you Ray</font>

26
00:01:51,180 --> 00:01:54,119
<font color="#E5E5E5">yeah Thank You Man</font>

27
00:01:52,380 --> 00:01:55,560
I appreciate it yeah I just<font color="#E5E5E5"> taught my</font>

28
00:01:54,119 --> 00:01:58,820
intermediate class for the first<font color="#E5E5E5"> time</font>

29
00:01:55,560 --> 00:02:02,189
and I<font color="#CCCCCC"> think I finished</font><font color="#E5E5E5"> the material like</font>

30
00:01:58,820 --> 00:02:07,439
at<font color="#E5E5E5"> four o'clock in the morning the day</font>

31
00:02:02,189 --> 00:02:10,619
<font color="#CCCCCC">before</font><font color="#E5E5E5"> maybe okay so today we're going</font>

32
00:02:07,439 --> 00:02:13,739
to talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> rock and the reason why</font>

33
00:02:10,619 --> 00:02:15,360
that we want<font color="#E5E5E5"> to use something something</font>

34
00:02:13,739 --> 00:02:19,519
<font color="#E5E5E5">called rock which is</font><font color="#CCCCCC"> return oriented</font>

35
00:02:15,360 --> 00:02:22,500
programming is because we have new

36
00:02:19,519 --> 00:02:24,870
exploit mitigations<font color="#E5E5E5"> in place on</font>

37
00:02:22,500 --> 00:02:28,200
operating systems in our applications

38
00:02:24,870 --> 00:02:31,170
<font color="#E5E5E5">and normally whenever you take or look</font>

39
00:02:28,200 --> 00:02:33,268
at any type of<font color="#E5E5E5"> you know exploit writing</font>

40
00:02:31,170 --> 00:02:36,149
course<font color="#E5E5E5"> you're starting out and you're</font>

41
00:02:33,269 --> 00:02:38,610
writing an exploit where you are

42
00:02:36,150 --> 00:02:42,540
executing<font color="#E5E5E5"> code on the stack without</font>

43
00:02:38,610 --> 00:02:44,639
<font color="#CCCCCC">having</font><font color="#E5E5E5"> to do anything right</font><font color="#CCCCCC"> pretty much</font>

44
00:02:42,540 --> 00:02:46,739
<font color="#E5E5E5">you're going to find it jump ESP or</font>

45
00:02:44,639 --> 00:02:48,520
something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> that you put the shell</font>

46
00:02:46,739 --> 00:02:51,880
code on the stack

47
00:02:48,520 --> 00:02:53,980
you know you run your spoi<font color="#E5E5E5"> execute its</font>

48
00:02:51,880 --> 00:02:56,470
code on the stack<font color="#CCCCCC"> and you're like yeah</font>

49
00:02:53,980 --> 00:02:59,410
I'm done right but in the real world

50
00:02:56,470 --> 00:03:01,270
<font color="#E5E5E5">these days</font><font color="#CCCCCC"> that's not</font><font color="#E5E5E5"> really the way</font>

51
00:02:59,410 --> 00:03:03,670
things are<font color="#E5E5E5"> right</font>

52
00:03:01,270 --> 00:03:05,830
there's mitigation techniques<font color="#E5E5E5"> they're in</font>

53
00:03:03,670 --> 00:03:09,730
play<font color="#CCCCCC"> that</font><font color="#E5E5E5"> prevents you from doing such</font>

54
00:03:05,830 --> 00:03:12,250
<font color="#CCCCCC">things</font><font color="#E5E5E5"> so you know whenever you do that</font>

55
00:03:09,730 --> 00:03:15,010
<font color="#CCCCCC">type of an example</font><font color="#E5E5E5"> you're talking</font><font color="#CCCCCC"> about</font>

56
00:03:12,250 --> 00:03:17,680
<font color="#E5E5E5">you know the way the</font><font color="#CCCCCC"> world was back in</font>

57
00:03:15,010 --> 00:03:23,790
and out<font color="#E5E5E5"> 50 years ago or</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know</font>

58
00:03:17,680 --> 00:03:28,360
1988<font color="#CCCCCC"> something like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> so what is back</font>

59
00:03:23,790 --> 00:03:34,870
<font color="#E5E5E5">prevent stack execution prevention</font><font color="#CCCCCC"> it</font>

60
00:03:28,360 --> 00:03:38,250
takes advantage<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> cpu</font><font color="#E5E5E5"> and there's a</font>

61
00:03:34,870 --> 00:03:42,310
flag in<font color="#E5E5E5"> the CPU</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> tells the CPU that</font>

62
00:03:38,250 --> 00:03:44,530
<font color="#CCCCCC">areas</font><font color="#E5E5E5"> of memory are not executable right</font>

63
00:03:42,310 --> 00:03:47,440
<font color="#E5E5E5">so if you put code there and</font><font color="#CCCCCC"> try to</font>

64
00:03:44,530 --> 00:03:48,700
<font color="#CCCCCC">execute it it's just not going</font><font color="#E5E5E5"> to do</font>

65
00:03:47,440 --> 00:03:50,560
anything it's actually<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to seg</font>

66
00:03:48,700 --> 00:03:52,780
fault the application it's<font color="#CCCCCC"> going to</font>

67
00:03:50,560 --> 00:03:59,590
crash because it can't execute that

68
00:03:52,780 --> 00:04:02,530
memory<font color="#CCCCCC"> so when the application like sets</font>

69
00:03:59,590 --> 00:04:05,260
up<font color="#E5E5E5"> its memory different areas get set</font>

70
00:04:02,530 --> 00:04:08,290
this way non-executable<font color="#E5E5E5"> one of the areas</font>

71
00:04:05,260 --> 00:04:09,880
of<font color="#E5E5E5"> memory</font><font color="#CCCCCC"> that gets set</font><font color="#E5E5E5"> this way is the</font>

72
00:04:08,290 --> 00:04:14,220
stack<font color="#E5E5E5"> right because you shouldn't be</font>

73
00:04:09,880 --> 00:04:14,220
executing code off the stack amen

74
00:04:16,950 --> 00:04:22,960
so there's different<font color="#E5E5E5"> ways</font><font color="#CCCCCC"> that you know</font>

75
00:04:20,608 --> 00:04:25,780
this mitigation technique has been

76
00:04:22,960 --> 00:04:29,380
implemented over<font color="#E5E5E5"> different os's right</font>

77
00:04:25,780 --> 00:04:33,760
<font color="#E5E5E5">hat as</font><font color="#CCCCCC"> exact</font><font color="#E5E5E5"> shield other Linux has had</font>

78
00:04:29,380 --> 00:04:37,450
<font color="#CCCCCC">pax open BSD has you know whatever</font><font color="#E5E5E5"> that</font>

79
00:04:33,760 --> 00:04:39,159
<font color="#CCCCCC">is and then Windows</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> dint and</font>

80
00:04:37,450 --> 00:04:41,200
everybody<font color="#CCCCCC"> seem you know everybody's</font>

81
00:04:39,160 --> 00:04:45,100
heard of<font color="#E5E5E5"> death right because that's how</font>

82
00:04:41,200 --> 00:04:47,020
Microsoft<font color="#E5E5E5"> saved the world</font><font color="#CCCCCC"> okay and we're</font>

83
00:04:45,100 --> 00:04:49,000
going to talk<font color="#CCCCCC"> about you know</font><font color="#E5E5E5"> how we can</font>

84
00:04:47,020 --> 00:04:53,380
<font color="#E5E5E5">get</font><font color="#CCCCCC"> around death and</font><font color="#E5E5E5"> execute</font><font color="#CCCCCC"> our code</font>

85
00:04:49,000 --> 00:04:57,490
anyway so this<font color="#E5E5E5"> is going to be pretty</font>

86
00:04:53,380 --> 00:05:00,010
<font color="#CCCCCC">much</font><font color="#E5E5E5"> a demo so I did not</font><font color="#CCCCCC"> pray to the</font>

87
00:04:57,490 --> 00:05:02,050
demo gods this morning so I am sure them

88
00:05:00,010 --> 00:05:04,060
my<font color="#CCCCCC"> Windows VM is going to</font>

89
00:05:02,050 --> 00:05:07,330
crash or reboot<font color="#CCCCCC"> right in the middle</font><font color="#E5E5E5"> of</font>

90
00:05:04,060 --> 00:05:10,740
this<font color="#E5E5E5"> that this is</font><font color="#CCCCCC"> fine</font><font color="#E5E5E5"> if you can't read</font>

91
00:05:07,330 --> 00:05:13,900
any that hex<font color="#E5E5E5"> either it's okay because</font>

92
00:05:10,740 --> 00:05:16,509
<font color="#E5E5E5">you probably don't care but or you might</font>

93
00:05:13,900 --> 00:05:19,448
<font color="#CCCCCC">want to</font><font color="#E5E5E5"> care and move forward because I</font>

94
00:05:16,509 --> 00:05:24,009
can't make this any bigger<font color="#CCCCCC"> because of</font>

95
00:05:19,449 --> 00:05:29,740
<font color="#CCCCCC">the resolution</font><font color="#E5E5E5"> okay so I've got</font><font color="#CCCCCC"> a</font>

96
00:05:24,009 --> 00:05:34,590
<font color="#E5E5E5">machine here and oh yeah my machine</font>

97
00:05:29,740 --> 00:05:34,590
rebooted so let's see how<font color="#E5E5E5"> to</font><font color="#CCCCCC"> setup</font>

98
00:05:41,810 --> 00:05:46,310
<font color="#CCCCCC">I had this all set up beforehand</font><font color="#E5E5E5"> and of</font>

99
00:05:44,630 --> 00:05:49,790
course it had<font color="#CCCCCC"> to reboot because I've got</font>

100
00:05:46,310 --> 00:05:52,490
like an<font color="#E5E5E5"> unlicensed copy of Windows</font><font color="#CCCCCC"> so</font>

101
00:05:49,790 --> 00:05:55,490
here what I've done<font color="#CCCCCC"> is I've told Windows</font>

102
00:05:52,490 --> 00:05:58,040
I want to turn<font color="#CCCCCC"> DEP on for everything</font>

103
00:05:55,490 --> 00:06:01,550
<font color="#E5E5E5">except for the application</font><font color="#CCCCCC"> that I'm</font>

104
00:05:58,040 --> 00:06:05,270
allowed to<font color="#E5E5E5"> execute</font><font color="#CCCCCC"> right now by</font><font color="#E5E5E5"> by</font>

105
00:06:01,550 --> 00:06:07,250
<font color="#E5E5E5">default Windows</font><font color="#CCCCCC"> seven came with turn-on</font>

106
00:06:05,270 --> 00:06:09,169
depth for essential<font color="#E5E5E5"> Windows programs and</font>

107
00:06:07,250 --> 00:06:10,790
services only<font color="#E5E5E5"> which meant every other</font>

108
00:06:09,169 --> 00:06:13,190
application<font color="#CCCCCC"> that was running</font><font color="#E5E5E5"> on your</font>

109
00:06:10,790 --> 00:06:16,130
machine didn't have<font color="#E5E5E5"> that turned out good</font>

110
00:06:13,190 --> 00:06:18,200
<font color="#E5E5E5">job Microsoft right so you actually have</font>

111
00:06:16,130 --> 00:06:20,479
to go in this<font color="#E5E5E5"> and which is funny because</font>

112
00:06:18,200 --> 00:06:22,849
<font color="#E5E5E5">I don't know if you saw what I</font><font color="#CCCCCC"> just did</font>

113
00:06:20,479 --> 00:06:25,550
but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> went into like I right clicked on</font>

114
00:06:22,850 --> 00:06:27,919
computer I got into the<font color="#E5E5E5"> system settings</font>

115
00:06:25,550 --> 00:06:29,630
<font color="#E5E5E5">I hit advanced system settings that kind</font>

116
00:06:27,919 --> 00:06:32,260
<font color="#E5E5E5">of makes sense and then I went to the</font>

117
00:06:29,630 --> 00:06:35,719
Advanced tab<font color="#E5E5E5"> and then I went to</font>

118
00:06:32,260 --> 00:06:37,219
performance settings I've never really

119
00:06:35,720 --> 00:06:39,950
understanding where we're going right

120
00:06:37,220 --> 00:06:42,650
<font color="#CCCCCC">because I'm trying</font><font color="#E5E5E5"> to keep code from</font>

121
00:06:39,950 --> 00:06:44,659
executing on<font color="#CCCCCC"> the stack and then I</font><font color="#E5E5E5"> find</font>

122
00:06:42,650 --> 00:06:46,400
over<font color="#CCCCCC"> here in this tab</font><font color="#E5E5E5"> that's kind of</font>

123
00:06:44,660 --> 00:06:49,700
hidden you know data execution

124
00:06:46,400 --> 00:06:52,609
prevention<font color="#E5E5E5"> and then I have to turn it on</font>

125
00:06:49,700 --> 00:06:57,940
then I have to reboot my<font color="#E5E5E5"> machine yeah go</font>

126
00:06:52,610 --> 00:07:01,669
ahead I mean it's completely<font color="#CCCCCC"> different</font>

127
00:06:57,940 --> 00:07:04,430
<font color="#CCCCCC">but I</font><font color="#E5E5E5"> think that you can have em at turn</font>

128
00:07:01,669 --> 00:07:09,710
<font color="#E5E5E5">turn death on on the application yeah</font>

129
00:07:04,430 --> 00:07:11,690
<font color="#E5E5E5">yep yeah yeah you want death on because</font>

130
00:07:09,710 --> 00:07:14,060
you don't<font color="#E5E5E5"> want people</font><font color="#CCCCCC"> to send exploits</font>

131
00:07:11,690 --> 00:07:15,530
to<font color="#E5E5E5"> your application and execute off the</font>

132
00:07:14,060 --> 00:07:18,440
stack<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I'll show</font><font color="#CCCCCC"> that show you that</font>

133
00:07:15,530 --> 00:07:20,210
<font color="#E5E5E5">happening in a minute so for my</font><font color="#CCCCCC"> pony</font>

134
00:07:18,440 --> 00:07:23,750
server<font color="#E5E5E5"> and I think I spelled the name</font>

135
00:07:20,210 --> 00:07:26,210
<font color="#E5E5E5">wrong but whatever</font><font color="#CCCCCC"> I turned deaf off</font>

136
00:07:23,750 --> 00:07:29,150
<font color="#CCCCCC">okay so I checked</font><font color="#E5E5E5"> the box I had to</font>

137
00:07:26,210 --> 00:07:30,620
reboot my machine<font color="#CCCCCC"> to get this to</font><font color="#E5E5E5"> work</font>

138
00:07:29,150 --> 00:07:33,620
right good job

139
00:07:30,620 --> 00:07:41,270
<font color="#E5E5E5">Microsoft and I'm going to now that's</font>

140
00:07:33,620 --> 00:07:44,330
turned on I'm going<font color="#E5E5E5"> to go and start up</font>

141
00:07:41,270 --> 00:07:46,070
<font color="#E5E5E5">my service so I wrote this service it's</font>

142
00:07:44,330 --> 00:07:49,900
got tons of vulnerabilities in it it's

143
00:07:46,070 --> 00:07:55,370
for my a class right and I'm going<font color="#CCCCCC"> to</font>

144
00:07:49,900 --> 00:07:56,179
take<font color="#E5E5E5"> as Floyd and send it to the</font>

145
00:07:55,370 --> 00:08:00,140
<font color="#E5E5E5">application</font>

146
00:07:56,180 --> 00:08:02,780
and then if I go and<font color="#E5E5E5"> look at my machine</font>

147
00:08:00,140 --> 00:08:12,070
<font color="#E5E5E5">or my machine my server hasn't crashed</font>

148
00:08:02,780 --> 00:08:20,900
yet but if I go<font color="#CCCCCC"> into and connect to the</font>

149
00:08:12,070 --> 00:08:26,690
<font color="#E5E5E5">gear let me connect to the server right</font>

150
00:08:20,900 --> 00:08:30,169
<font color="#CCCCCC">and see and I</font><font color="#E5E5E5"> think it was</font><font color="#CCCCCC"> 4 4 4 4</font><font color="#E5E5E5"> let's</font>

151
00:08:26,690 --> 00:08:33,830
do that I've got<font color="#CCCCCC"> a shell ok</font>

152
00:08:30,170 --> 00:08:36,260
and all I did<font color="#E5E5E5"> so for those that can't</font>

153
00:08:33,830 --> 00:08:39,500
see it this<font color="#CCCCCC"> is a window</font><font color="#E5E5E5"> show I just</font>

154
00:08:36,260 --> 00:08:44,059
<font color="#CCCCCC">connected to</font><font color="#E5E5E5"> the port on the</font><font color="#CCCCCC"> Box</font><font color="#E5E5E5"> on 4 4</font>

155
00:08:39,500 --> 00:08:46,580
4 4 and I opened up a<font color="#E5E5E5"> bind show right in</font>

156
00:08:44,059 --> 00:08:49,790
the way I did it<font color="#E5E5E5"> if I look at my script</font>

157
00:08:46,580 --> 00:08:54,770
<font color="#CCCCCC">let's stop that let's look at the script</font>

158
00:08:49,790 --> 00:08:59,810
<font color="#E5E5E5">all I did was here I have a jump</font><font color="#CCCCCC"> DSP</font>

159
00:08:54,770 --> 00:09:03,079
right there's jump<font color="#CCCCCC"> ESPs all over your</font>

160
00:08:59,810 --> 00:09:07,939
application<font color="#CCCCCC"> I overwrite the</font><font color="#E5E5E5"> save the IP</font>

161
00:09:03,080 --> 00:09:10,430
<font color="#E5E5E5">to then go to the jump</font><font color="#CCCCCC"> PSP in it jumps</font>

162
00:09:07,940 --> 00:09:13,970
back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> where my coat my</font><font color="#CCCCCC"> shellcode</font><font color="#E5E5E5"> is on</font>

163
00:09:10,430 --> 00:09:15,800
the stack it executes it so depth is not

164
00:09:13,970 --> 00:09:18,860
turned<font color="#E5E5E5"> on and it's a pretty simple</font>

165
00:09:15,800 --> 00:09:22,540
script<font color="#CCCCCC"> I mean that's pretty</font><font color="#E5E5E5"> much it and</font>

166
00:09:18,860 --> 00:09:25,820
<font color="#E5E5E5">I exploit my my script my application so</font>

167
00:09:22,540 --> 00:09:28,490
<font color="#CCCCCC">Deb</font><font color="#E5E5E5"> what came out and you know they were</font>

168
00:09:25,820 --> 00:09:31,160
like we're<font color="#E5E5E5"> going to make</font><font color="#CCCCCC"> it so that</font><font color="#E5E5E5"> that</font>

169
00:09:28,490 --> 00:09:37,840
<font color="#E5E5E5">doesn't happen</font><font color="#CCCCCC"> right so</font><font color="#E5E5E5"> let's let's go</font>

170
00:09:31,160 --> 00:09:37,839
in and turn<font color="#CCCCCC"> it off and</font><font color="#E5E5E5"> see if it works</font>

171
00:09:40,790 --> 00:09:48,709
performance settings up yep<font color="#E5E5E5"> execution</font>

172
00:09:44,460 --> 00:09:52,650
prevention and check this these boxes

173
00:09:48,710 --> 00:09:54,360
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> now Deb has been turned off</font><font color="#CCCCCC"> from my</font>

174
00:09:52,650 --> 00:09:56,010
application<font color="#CCCCCC"> so I'm going to</font><font color="#E5E5E5"> start</font>

175
00:09:54,360 --> 00:09:58,470
anything<font color="#E5E5E5"> that's been turned down</font><font color="#CCCCCC"> right</font>

176
00:09:56,010 --> 00:10:01,439
<font color="#CCCCCC">so it's going</font><font color="#E5E5E5"> to keep me from executing</font>

177
00:09:58,470 --> 00:10:09,950
code<font color="#CCCCCC"> up side so if I go in</font><font color="#E5E5E5"> execute</font><font color="#CCCCCC"> that</font>

178
00:10:01,440 --> 00:10:13,290
again get out<font color="#E5E5E5"> of that though not not</font><font color="#CCCCCC"> too</font>

179
00:10:09,950 --> 00:10:15,390
<font color="#CCCCCC">if you change</font><font color="#E5E5E5"> the bullet to make it so</font>

180
00:10:13,290 --> 00:10:17,699
that<font color="#CCCCCC"> def turn on for all your apps</font><font color="#E5E5E5"> you</font>

181
00:10:15,390 --> 00:10:19,800
don't<font color="#E5E5E5"> have to reboot but once you have</font>

182
00:10:17,700 --> 00:10:22,730
<font color="#E5E5E5">it turned on then you can turn on and</font>

183
00:10:19,800 --> 00:10:29,609
<font color="#E5E5E5">off debt for individual applications</font>

184
00:10:22,730 --> 00:10:39,020
right<font color="#E5E5E5"> so now I'm going to run the</font>

185
00:10:29,610 --> 00:10:43,050
<font color="#CCCCCC">non-drop</font><font color="#E5E5E5"> again right and I just</font><font color="#CCCCCC"> lost my</font>

186
00:10:39,020 --> 00:10:45,810
window and<font color="#E5E5E5"> I'm going to</font><font color="#CCCCCC"> execute or try</font>

187
00:10:43,050 --> 00:10:49,620
<font color="#E5E5E5">actually let's go</font><font color="#CCCCCC"> back to the Windows</font>

188
00:10:45,810 --> 00:10:54,150
machine<font color="#CCCCCC"> and we see that crashed right so</font>

189
00:10:49,620 --> 00:10:56,010
now if I go<font color="#CCCCCC"> back to my netcat and try to</font>

190
00:10:54,150 --> 00:10:56,880
connect<font color="#E5E5E5"> to the listener that I opened up</font>

191
00:10:56,010 --> 00:11:00,510
<font color="#E5E5E5">just a minute ago</font>

192
00:10:56,880 --> 00:11:02,160
it shouldn't connect right nothing

193
00:11:00,510 --> 00:11:06,300
happens<font color="#E5E5E5"> because</font><font color="#CCCCCC"> they bought the bind</font>

194
00:11:02,160 --> 00:11:08,790
port didn't like open up so I<font color="#CCCCCC"> pushed the</font>

195
00:11:06,300 --> 00:11:12,329
shell code<font color="#CCCCCC"> onto the stack but then when</font>

196
00:11:08,790 --> 00:11:14,490
I use my jump ESB it jumped<font color="#E5E5E5"> onto the</font>

197
00:11:12,330 --> 00:11:16,110
<font color="#E5E5E5">stack</font><font color="#CCCCCC"> and then the code was prevented</font>

198
00:11:14,490 --> 00:11:20,250
<font color="#CCCCCC">from executing so let's look at that</font><font color="#E5E5E5"> in</font>

199
00:11:16,110 --> 00:11:22,550
the debugger<font color="#E5E5E5"> so I'm going</font><font color="#CCCCCC"> to start up</font>

200
00:11:20,250 --> 00:11:22,550
<font color="#E5E5E5">the app</font>

201
00:11:25,390 --> 00:11:33,420
<font color="#E5E5E5">connect immunity to it and I'm</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

202
00:11:37,320 --> 00:11:48,620
oh man I keep<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> that sorry and I'm</font>

203
00:11:43,949 --> 00:11:48,620
going<font color="#CCCCCC"> to set a breakpoint</font><font color="#E5E5E5"> at my</font><font color="#CCCCCC"> jumpy SP</font>

204
00:11:53,120 --> 00:12:00,180
so here's my<font color="#E5E5E5"> jumpy SP right so I'm going</font>

205
00:11:57,149 --> 00:12:03,750
to set a breakpoint<font color="#E5E5E5"> there and then start</font>

206
00:12:00,180 --> 00:12:06,269
the<font color="#E5E5E5"> application</font><font color="#CCCCCC"> backup gun now when I go</font>

207
00:12:03,750 --> 00:12:09,930
and execute my script we're going to

208
00:12:06,269 --> 00:12:12,209
stop and<font color="#E5E5E5"> see</font><font color="#CCCCCC"> what happens so back in the</font>

209
00:12:09,930 --> 00:12:15,000
debugger<font color="#E5E5E5"> our application is crashed we</font>

210
00:12:12,209 --> 00:12:17,550
can see that the debugger<font color="#CCCCCC"> pause done in</font>

211
00:12:15,000 --> 00:12:19,800
the bottom<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we can</font><font color="#CCCCCC"> see in the</font><font color="#E5E5E5"> status</font>

212
00:12:17,550 --> 00:12:22,889
bar at the<font color="#CCCCCC"> bottom that we hit</font><font color="#E5E5E5"> that pit</font>

213
00:12:19,800 --> 00:12:27,149
or bug point in the brain point is<font color="#CCCCCC"> jumpy</font>

214
00:12:22,889 --> 00:12:29,550
<font color="#CCCCCC">SP</font><font color="#E5E5E5"> if we look at the stack over in the</font>

215
00:12:27,149 --> 00:12:32,490
bottom<font color="#E5E5E5"> what is it for you</font><font color="#CCCCCC"> guys right</font>

216
00:12:29,550 --> 00:12:35,609
hand<font color="#E5E5E5"> right we see that ESP is pointing</font>

217
00:12:32,490 --> 00:12:38,160
<font color="#CCCCCC">at the</font><font color="#E5E5E5"> button</font><font color="#CCCCCC"> ship X</font><font color="#E5E5E5"> 90s right those are</font>

218
00:12:35,610 --> 00:12:40,259
no<font color="#E5E5E5"> ops so it's kind of like a no</font><font color="#CCCCCC"> ops log</font>

219
00:12:38,160 --> 00:12:42,449
if I hit it it's<font color="#E5E5E5"> just going to slide</font>

220
00:12:40,259 --> 00:12:45,300
<font color="#CCCCCC">down and</font><font color="#E5E5E5"> then below the 90s is my</font>

221
00:12:42,449 --> 00:12:47,490
<font color="#E5E5E5">shellcode before I turned up on I would</font>

222
00:12:45,300 --> 00:12:50,099
be able<font color="#E5E5E5"> to go and just execute those 90s</font>

223
00:12:47,490 --> 00:12:54,810
<font color="#E5E5E5">until I hit my shellcode but if I go and</font>

224
00:12:50,100 --> 00:12:56,850
<font color="#E5E5E5">jump right now right now</font><font color="#CCCCCC"> you can see the</font>

225
00:12:54,810 --> 00:13:00,029
instruction<font color="#E5E5E5"> pane where it's changed and</font>

226
00:12:56,850 --> 00:13:03,149
I have my no ups in<font color="#CCCCCC"> the upper</font><font color="#E5E5E5"> left hand</font>

227
00:13:00,029 --> 00:13:05,279
corner<font color="#E5E5E5"> for you guys right</font><font color="#CCCCCC"> and of if it</font>

228
00:13:03,149 --> 00:13:07,529
depth was turned off I'd start executing

229
00:13:05,279 --> 00:13:09,750
those instructions but now whenever I

230
00:13:07,529 --> 00:13:12,680
hit<font color="#E5E5E5"> I step through</font><font color="#CCCCCC"> it I get access</font>

231
00:13:09,750 --> 00:13:16,740
<font color="#E5E5E5">violations down below</font><font color="#CCCCCC"> DEP is working</font>

232
00:13:12,680 --> 00:13:20,638
right see how<font color="#CCCCCC"> that is if I had turn this</font>

233
00:13:16,740 --> 00:13:22,459
off I'll just execute<font color="#E5E5E5"> those and execute</font>

234
00:13:20,639 --> 00:13:25,949
my shell and<font color="#E5E5E5"> that's how I was</font><font color="#CCCCCC"> able to</font>

235
00:13:22,459 --> 00:13:28,589
bind to<font color="#E5E5E5"> the support previously but now I</font>

236
00:13:25,949 --> 00:13:31,439
can't<font color="#E5E5E5"> right it's broken</font><font color="#CCCCCC"> so how do we get</font>

237
00:13:28,589 --> 00:13:34,290
<font color="#CCCCCC">around it</font><font color="#E5E5E5"> let's go back to</font><font color="#CCCCCC"> Who am I</font>

238
00:13:31,439 --> 00:13:36,269
talks about<font color="#E5E5E5"> right so we observed for</font>

239
00:13:34,290 --> 00:13:38,310
<font color="#CCCCCC">this slide we observe the</font><font color="#E5E5E5"> access</font>

240
00:13:36,269 --> 00:13:46,260
violation<font color="#E5E5E5"> so what is return-oriented</font>

241
00:13:38,310 --> 00:13:48,569
programming<font color="#E5E5E5"> it is a way of chaining sets</font>

242
00:13:46,260 --> 00:13:50,120
of instructions<font color="#CCCCCC"> there in the application</font>

243
00:13:48,569 --> 00:13:54,290
already

244
00:13:50,120 --> 00:13:56,060
and to do what you want<font color="#E5E5E5"> to do so in the</font>

245
00:13:54,290 --> 00:13:58,760
application

246
00:13:56,060 --> 00:14:01,339
there's sets of instructions which we

247
00:13:58,760 --> 00:14:05,029
will call gadgets right<font color="#E5E5E5"> and they are all</font>

248
00:14:01,339 --> 00:14:09,680
followed up by a return right<font color="#E5E5E5"> when you</font>

249
00:14:05,029 --> 00:14:11,900
overwrite<font color="#CCCCCC"> yeah II I</font><font color="#E5E5E5"> P the safety IP and</font>

250
00:14:09,680 --> 00:14:15,469
make it so like<font color="#E5E5E5"> I was going to the jump</font>

251
00:14:11,900 --> 00:14:17,870
<font color="#CCCCCC">TSP what's happening is is you're</font>

252
00:14:15,470 --> 00:14:22,580
returning<font color="#E5E5E5"> out of a function right and</font>

253
00:14:17,870 --> 00:14:25,730
then that memory address is executed<font color="#CCCCCC"> so</font>

254
00:14:22,580 --> 00:14:29,120
I find a jump<font color="#E5E5E5"> ESP whenever that return</font>

255
00:14:25,730 --> 00:14:32,570
hits<font color="#CCCCCC"> I go to that that instruction and</font>

256
00:14:29,120 --> 00:14:34,370
execute the instruction in Rob we're

257
00:14:32,570 --> 00:14:42,040
kind of doing<font color="#E5E5E5"> that type of thing yep</font>

258
00:14:34,370 --> 00:14:45,650
oh I'll get<font color="#E5E5E5"> there yep yep so whatever I</font>

259
00:14:42,040 --> 00:14:49,670
oh I completely lost my<font color="#CCCCCC"> train of thought</font>

260
00:14:45,650 --> 00:14:52,100
thank you<font color="#CCCCCC"> very</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> so before I can't</font>

261
00:14:49,670 --> 00:14:54,890
hit that I was<font color="#CCCCCC"> at</font><font color="#E5E5E5"> City this morning I</font>

262
00:14:52,100 --> 00:14:59,029
have<font color="#E5E5E5"> to say this morning I'm sipping my</font>

263
00:14:54,890 --> 00:15:03,980
coffee<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> wake</font><font color="#CCCCCC"> up my head hurts</font>

264
00:14:59,029 --> 00:15:06,279
<font color="#CCCCCC">like something fierce</font><font color="#E5E5E5"> and Jennifer sits</font>

265
00:15:03,980 --> 00:15:09,110
down in front of<font color="#E5E5E5"> me with her oatmeal</font>

266
00:15:06,279 --> 00:15:12,439
<font color="#E5E5E5">right and she's like I'm going</font><font color="#CCCCCC"> to heckle</font>

267
00:15:09,110 --> 00:15:14,000
you today right here<font color="#E5E5E5"> so thanks I</font>

268
00:15:12,440 --> 00:15:14,900
appreciate that<font color="#CCCCCC"> because</font><font color="#E5E5E5"> I completely</font>

269
00:15:14,000 --> 00:15:19,610
threw<font color="#CCCCCC"> me off</font>

270
00:15:14,900 --> 00:15:22,100
I keep<font color="#CCCCCC"> going</font><font color="#E5E5E5"> good this is fine</font><font color="#CCCCCC"> okay so</font>

271
00:15:19,610 --> 00:15:24,140
<font color="#E5E5E5">I'll answer</font><font color="#CCCCCC"> your here question because I</font>

272
00:15:22,100 --> 00:15:29,120
have no<font color="#E5E5E5"> idea what I was talking</font><font color="#CCCCCC"> about</font>

273
00:15:24,140 --> 00:15:31,189
so<font color="#E5E5E5"> turing-complete means with gadgets</font><font color="#CCCCCC"> if</font>

274
00:15:29,120 --> 00:15:32,959
you have enough gadgets and<font color="#E5E5E5"> we'll talk</font>

275
00:15:31,190 --> 00:15:35,510
about what they are<font color="#E5E5E5"> in a</font><font color="#CCCCCC"> minute you can</font>

276
00:15:32,959 --> 00:15:38,029
<font color="#CCCCCC">pretty much write any application right</font>

277
00:15:35,510 --> 00:15:41,180
<font color="#E5E5E5">if you have enough gadgets to work with</font>

278
00:15:38,029 --> 00:15:44,060
you<font color="#E5E5E5"> can pretty much</font><font color="#CCCCCC"> write at you know an</font>

279
00:15:41,180 --> 00:15:48,050
application based<font color="#E5E5E5"> on all the gadgets</font>

280
00:15:44,060 --> 00:15:52,910
<font color="#E5E5E5">that you find in the application okay</font>

281
00:15:48,050 --> 00:15:55,699
and the nice<font color="#CCCCCC"> thing about using</font><font color="#E5E5E5"> Rob is</font>

282
00:15:52,910 --> 00:15:57,439
you're not executing code off the stack

283
00:15:55,700 --> 00:15:59,390
all you're<font color="#E5E5E5"> doing is you're pushing</font>

284
00:15:57,440 --> 00:16:01,260
instructions<font color="#CCCCCC"> onto the stack and then</font>

285
00:15:59,390 --> 00:16:03,930
utilizing<font color="#E5E5E5"> the the behavior</font><font color="#CCCCCC"> of</font>

286
00:16:01,260 --> 00:16:06,240
right<font color="#E5E5E5"> to jump to these sets of</font>

287
00:16:03,930 --> 00:16:08,130
<font color="#CCCCCC">instructions to execute</font><font color="#E5E5E5"> what you want</font>

288
00:16:06,240 --> 00:16:10,170
but<font color="#E5E5E5"> the sets of</font><font color="#CCCCCC"> instructions are</font>

289
00:16:08,130 --> 00:16:12,570
actually in executable space<font color="#E5E5E5"> of memory</font>

290
00:16:10,170 --> 00:16:16,439
<font color="#E5E5E5">right and then at the very end there's a</font>

291
00:16:12,570 --> 00:16:19,410
rag<font color="#E5E5E5"> well</font><font color="#CCCCCC"> what a ret does</font><font color="#E5E5E5"> if all it does</font>

292
00:16:16,440 --> 00:16:21,930
<font color="#E5E5E5">is it pops a memory address off the</font>

293
00:16:19,410 --> 00:16:24,209
stack<font color="#CCCCCC"> and then it jumps to it right</font>

294
00:16:21,930 --> 00:16:28,349
that's all it does so if you put a bunch

295
00:16:24,210 --> 00:16:30,900
<font color="#E5E5E5">of memory addresses</font><font color="#CCCCCC"> onto the stack that</font>

296
00:16:28,350 --> 00:16:33,600
<font color="#E5E5E5">lead</font><font color="#CCCCCC"> to a read</font><font color="#E5E5E5"> at some point you're</font>

297
00:16:30,900 --> 00:16:35,220
going<font color="#E5E5E5"> to hit the rack</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then pop off</font>

298
00:16:33,600 --> 00:16:37,590
the next<font color="#E5E5E5"> memory address off the stack</font>

299
00:16:35,220 --> 00:16:40,740
and<font color="#CCCCCC"> then jump to</font><font color="#E5E5E5"> that and I'll</font><font color="#CCCCCC"> have you</font>

300
00:16:37,590 --> 00:16:42,510
know examples in a<font color="#E5E5E5"> minute so what is a</font>

301
00:16:40,740 --> 00:16:46,080
gadget<font color="#CCCCCC"> pretty much kind of</font><font color="#E5E5E5"> went through</font>

302
00:16:42,510 --> 00:16:48,540
it<font color="#E5E5E5"> it's like it's all over in your</font>

303
00:16:46,080 --> 00:16:50,370
instruction space and they're just sets

304
00:16:48,540 --> 00:16:53,490
of instructions<font color="#E5E5E5"> followed by your</font><font color="#CCCCCC"> read</font>

305
00:16:50,370 --> 00:16:56,040
right there's other types<font color="#E5E5E5"> of gadgets</font>

306
00:16:53,490 --> 00:16:58,290
<font color="#CCCCCC">that</font><font color="#E5E5E5"> end in other instructions what</font>

307
00:16:56,040 --> 00:17:00,449
we're going<font color="#E5E5E5"> to only talk about the ones</font>

308
00:16:58,290 --> 00:17:02,099
<font color="#E5E5E5">that end in the rest so you'll have</font>

309
00:17:00,450 --> 00:17:06,750
instruction<font color="#E5E5E5"> instruction and instruction</font>

310
00:17:02,100 --> 00:17:11,490
instruction<font color="#E5E5E5"> and then a rat okay now the</font>

311
00:17:06,750 --> 00:17:15,089
nice thing<font color="#CCCCCC"> about x86 is it's a</font><font color="#E5E5E5"> variable</font>

312
00:17:11,490 --> 00:17:17,670
length<font color="#E5E5E5"> instruction set so</font><font color="#CCCCCC"> a no op is one</font>

313
00:17:15,089 --> 00:17:23,040
byte in size it's a hex<font color="#E5E5E5"> 90 but then an</font>

314
00:17:17,670 --> 00:17:26,089
<font color="#CCCCCC">ADD</font><font color="#E5E5E5"> ESP</font><font color="#CCCCCC"> like add 92 ESP is a longer</font>

315
00:17:23,040 --> 00:17:29,490
instruction it might be<font color="#CCCCCC"> for 6 bytes long</font>

316
00:17:26,089 --> 00:17:32,010
this allows<font color="#CCCCCC"> us to find even more gadgets</font>

317
00:17:29,490 --> 00:17:36,390
in the instruction space because of<font color="#CCCCCC"> the</font>

318
00:17:32,010 --> 00:17:38,820
<font color="#CCCCCC">way</font><font color="#E5E5E5"> you can jump to</font><font color="#CCCCCC"> the memory addresses</font>

319
00:17:36,390 --> 00:17:40,740
in the middle of may be existing

320
00:17:38,820 --> 00:17:42,889
<font color="#E5E5E5">instructions and I'll show</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> that in</font><font color="#CCCCCC"> a</font>

321
00:17:40,740 --> 00:17:42,890
minute

322
00:17:42,980 --> 00:17:50,340
like I was saying I was getting ahead<font color="#E5E5E5"> of</font>

323
00:17:46,500 --> 00:17:54,570
myself<font color="#E5E5E5"> as far as the gadgets normally a</font>

324
00:17:50,340 --> 00:17:58,350
program has all the instructions<font color="#CCCCCC"> set up</font>

325
00:17:54,570 --> 00:18:01,560
in memory<font color="#E5E5E5"> based on a</font><font color="#CCCCCC"> four byte you know</font>

326
00:17:58,350 --> 00:18:04,590
boundary right but if you jump<font color="#CCCCCC"> into the</font>

327
00:18:01,560 --> 00:18:07,169
<font color="#E5E5E5">middle of the instruction then what gets</font>

328
00:18:04,590 --> 00:18:09,340
<font color="#E5E5E5">executed might look</font><font color="#CCCCCC"> very different from</font>

329
00:18:07,170 --> 00:18:12,490
what the real instructions<font color="#E5E5E5"> are</font>

330
00:18:09,340 --> 00:18:14,500
so that adds<font color="#E5E5E5"> the number of gadgets that</font>

331
00:18:12,490 --> 00:18:16,300
you<font color="#E5E5E5"> might end up using being able to use</font>

332
00:18:14,500 --> 00:18:21,120
and<font color="#CCCCCC"> you're the application</font><font color="#E5E5E5"> that you're</font>

333
00:18:16,300 --> 00:18:25,260
targeting<font color="#CCCCCC"> one note due to popularity of</font>

334
00:18:21,120 --> 00:18:29,050
<font color="#E5E5E5">Rob</font><font color="#CCCCCC"> there's been a lot of research</font><font color="#E5E5E5"> into</font>

335
00:18:25,260 --> 00:18:31,000
trying<font color="#E5E5E5"> to keep this from</font><font color="#CCCCCC"> happening I</font>

336
00:18:29,050 --> 00:18:33,220
know that there's a<font color="#E5E5E5"> couple</font><font color="#CCCCCC"> universities</font>

337
00:18:31,000 --> 00:18:35,680
<font color="#CCCCCC">have been working very</font><font color="#E5E5E5"> hard to</font><font color="#CCCCCC"> figure</font>

338
00:18:33,220 --> 00:18:38,980
<font color="#E5E5E5">out ways</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> keep</font><font color="#CCCCCC"> people from</font><font color="#E5E5E5"> using raw</font>

339
00:18:35,680 --> 00:18:42,340
<font color="#E5E5E5">to execute show code on on their in</font>

340
00:18:38,980 --> 00:18:45,700
application space<font color="#E5E5E5"> so here's a really</font>

341
00:18:42,340 --> 00:18:47,889
good<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of gadgets that are</font><font color="#CCCCCC"> hidden</font>

342
00:18:45,700 --> 00:18:51,370
within the instructions in an

343
00:18:47,890 --> 00:18:54,630
<font color="#CCCCCC">application so in the top example I</font><font color="#E5E5E5"> had</font>

344
00:18:51,370 --> 00:18:58,810
the original<font color="#E5E5E5"> instructions</font><font color="#CCCCCC"> I have an or</font>

345
00:18:54,630 --> 00:19:02,380
instruction and it starts with 80 83<font color="#E5E5E5"> 0 D</font>

346
00:18:58,810 --> 00:19:06,310
0<font color="#E5E5E5"> C yada yada</font><font color="#CCCCCC"> yada</font><font color="#E5E5E5"> right and then</font>

347
00:19:02,380 --> 00:19:10,960
there's a test<font color="#CCCCCC"> EDX</font><font color="#E5E5E5"> right now if I jump</font>

348
00:19:06,310 --> 00:19:14,530
to where<font color="#E5E5E5"> the</font><font color="#CCCCCC"> zero D is right and start</font>

349
00:19:10,960 --> 00:19:17,170
<font color="#E5E5E5">executing from there I get a completely</font>

350
00:19:14,530 --> 00:19:21,580
<font color="#CCCCCC">different set of instructions here</font><font color="#E5E5E5"> right</font>

351
00:19:17,170 --> 00:19:23,920
<font color="#E5E5E5">so the the or instruction turns into a</font>

352
00:19:21,580 --> 00:19:28,120
<font color="#E5E5E5">different or instruction it becomes an</font>

353
00:19:23,920 --> 00:19:32,440
or<font color="#CCCCCC"> EAX and</font><font color="#E5E5E5"> a number and then the next</font>

354
00:19:28,120 --> 00:19:36,040
instruction<font color="#E5E5E5"> after that is an</font><font color="#CCCCCC"> ADD al so</font>

355
00:19:32,440 --> 00:19:39,580
if you look<font color="#E5E5E5"> at the top</font><font color="#CCCCCC"> you have 0 d and</font>

356
00:19:36,040 --> 00:19:41,649
then this part right here<font color="#E5E5E5"> then the</font>

357
00:19:39,580 --> 00:19:45,250
hidden gadget down below<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> my first</font>

358
00:19:41,650 --> 00:19:48,310
instruction<font color="#E5E5E5"> you see how that is</font><font color="#CCCCCC"> and then</font>

359
00:19:45,250 --> 00:19:51,130
the second instruction is 0 4 and then

360
00:19:48,310 --> 00:19:56,500
this<font color="#CCCCCC"> f7</font><font color="#E5E5E5"> down here right and that becomes</font>

361
00:19:51,130 --> 00:19:58,960
the<font color="#CCCCCC"> add and then my return becomes this</font>

362
00:19:56,500 --> 00:20:01,660
here<font color="#CCCCCC"> this c2 and the bus a bunch of</font>

363
00:19:58,960 --> 00:20:05,230
<font color="#CCCCCC">zeros you see how that is so I just</font>

364
00:20:01,660 --> 00:20:07,660
created new gadgets<font color="#CCCCCC"> or instructions</font><font color="#E5E5E5"> by</font>

365
00:20:05,230 --> 00:20:10,570
jumping<font color="#CCCCCC"> to the address</font><font color="#E5E5E5"> of the in the</font>

366
00:20:07,660 --> 00:20:13,950
<font color="#E5E5E5">middle of an existing instruction any</font>

367
00:20:10,570 --> 00:20:13,950
questions about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> yeah go</font><font color="#E5E5E5"> ahead</font>

368
00:20:17,250 --> 00:20:20,250
yep

369
00:20:30,119 --> 00:20:34,619
it's more it's sort of like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it's</font>

370
00:20:32,580 --> 00:20:36,389
<font color="#E5E5E5">more</font><font color="#CCCCCC"> like you</font><font color="#E5E5E5"> had let's say you have a</font>

371
00:20:34,619 --> 00:20:38,759
function<font color="#CCCCCC"> and there's a bunch</font><font color="#E5E5E5"> of</font>

372
00:20:36,389 --> 00:20:40,559
<font color="#E5E5E5">instructions inside the function right</font>

373
00:20:38,759 --> 00:20:44,519
<font color="#E5E5E5">first thing that a function will do is</font>

374
00:20:40,559 --> 00:20:46,799
save EVP right<font color="#E5E5E5"> so there is a move you</font>

375
00:20:44,519 --> 00:20:51,379
know push EBP<font color="#E5E5E5"> on stack and then you move</font>

376
00:20:46,799 --> 00:20:53,850
<font color="#E5E5E5">ESP to EBP</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> function has those</font>

377
00:20:51,379 --> 00:20:56,158
instructions<font color="#E5E5E5"> and then the instruction</font>

378
00:20:53,850 --> 00:20:58,439
<font color="#E5E5E5">has since the function has the</font>

379
00:20:56,159 --> 00:21:01,739
instructions to do whatever<font color="#E5E5E5"> it's</font>

380
00:20:58,440 --> 00:21:06,779
<font color="#CCCCCC">supposed to do right so what I'm talking</font>

381
00:21:01,739 --> 00:21:10,979
<font color="#CCCCCC">about is if there is any Rex in that you</font>

382
00:21:06,779 --> 00:21:12,119
know<font color="#E5E5E5"> ret opcodes</font><font color="#CCCCCC"> in that function</font><font color="#E5E5E5"> then</font>

383
00:21:10,979 --> 00:21:15,690
what<font color="#E5E5E5"> we're doing</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> we're building</font>

384
00:21:12,119 --> 00:21:18,749
backwards from that<font color="#E5E5E5"> C to spot and seeing</font>

385
00:21:15,690 --> 00:21:24,450
if there's any<font color="#E5E5E5"> valid instructions that</font>

386
00:21:18,749 --> 00:21:30,779
we could utilize<font color="#E5E5E5"> yes yes in this example</font>

387
00:21:24,450 --> 00:21:35,009
yep<font color="#E5E5E5"> does that make sense</font><font color="#CCCCCC"> okay so what</font>

388
00:21:30,779 --> 00:21:37,649
<font color="#CCCCCC">are gadgets you ask so a gadget can be</font>

389
00:21:35,009 --> 00:21:39,599
anything<font color="#CCCCCC"> like let's say I need</font><font color="#E5E5E5"> to pop</font>

390
00:21:37,649 --> 00:21:44,428
something<font color="#CCCCCC"> off the stack and put it into</font>

391
00:21:39,599 --> 00:21:46,649
a register<font color="#CCCCCC"> I can have a poppy ax</font><font color="#E5E5E5"> a poppy</font>

392
00:21:44,429 --> 00:21:48,929
<font color="#E5E5E5">DX and then we</font><font color="#CCCCCC"> return it's a</font><font color="#E5E5E5"> pop pop</font>

393
00:21:46,649 --> 00:21:49,349
right<font color="#E5E5E5"> you probably hear</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> pop up</font>

394
00:21:48,929 --> 00:21:53,909
<font color="#CCCCCC">Brett's</font>

395
00:21:49,349 --> 00:21:57,450
when you're doing<font color="#CCCCCC"> SCH exploitation</font><font color="#E5E5E5"> right</font>

396
00:21:53,909 --> 00:22:00,629
<font color="#E5E5E5">in this example maybe I need to put</font>

397
00:21:57,450 --> 00:22:02,849
something<font color="#E5E5E5"> into EDX like you know a</font>

398
00:22:00,629 --> 00:22:07,408
memory address or a<font color="#E5E5E5"> number or</font><font color="#CCCCCC"> something</font>

399
00:22:02,849 --> 00:22:10,590
<font color="#CCCCCC">I'll put it under</font><font color="#E5E5E5"> the the memory address</font>

400
00:22:07,409 --> 00:22:12,210
for this<font color="#CCCCCC"> gadget</font><font color="#E5E5E5"> and then whenever I go</font>

401
00:22:10,590 --> 00:22:14,488
and execute<font color="#E5E5E5"> it the next thing</font><font color="#CCCCCC"> that will</font>

402
00:22:12,210 --> 00:22:17,940
be on the stack is<font color="#E5E5E5"> the value I want to</font>

403
00:22:14,489 --> 00:22:20,820
pop<font color="#E5E5E5"> into ETA X right and then I might</font>

404
00:22:17,940 --> 00:22:23,009
not<font color="#E5E5E5"> care what I put into EDX and then</font>

405
00:22:20,820 --> 00:22:25,619
you know I'll put some junk<font color="#E5E5E5"> in my</font>

406
00:22:23,009 --> 00:22:28,830
exploring and then whenever<font color="#E5E5E5"> this gadget</font>

407
00:22:25,619 --> 00:22:30,959
executes it will pop what<font color="#E5E5E5"> the</font><font color="#CCCCCC"> value that</font>

408
00:22:28,830 --> 00:22:33,629
I<font color="#E5E5E5"> want to put into EAX</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it will do</font>

409
00:22:30,960 --> 00:22:35,700
that<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> just pop junk into</font>

410
00:22:33,629 --> 00:22:38,129
<font color="#E5E5E5">EDX because I don't care and then it</font>

411
00:22:35,700 --> 00:22:40,499
will return<font color="#E5E5E5"> on my stack I'll have</font>

412
00:22:38,129 --> 00:22:43,139
another memory address for the next

413
00:22:40,499 --> 00:22:43,470
gadget<font color="#E5E5E5"> it's going to pop that off</font><font color="#CCCCCC"> into</font>

414
00:22:43,139 --> 00:22:47,580
yeah

415
00:22:43,470 --> 00:22:49,259
P and then execute<font color="#CCCCCC"> the next gadget</font><font color="#E5E5E5"> the</font>

416
00:22:47,580 --> 00:22:54,000
next<font color="#E5E5E5"> example is a little</font><font color="#CCCCCC"> bit different</font>

417
00:22:49,259 --> 00:22:55,740
<font color="#CCCCCC">let's say</font><font color="#E5E5E5"> that I need to pop or add you</font>

418
00:22:54,000 --> 00:22:59,250
know<font color="#E5E5E5"> 10 to ESP this is a bad</font><font color="#CCCCCC"> example</font>

419
00:22:55,740 --> 00:23:01,980
because<font color="#CCCCCC"> you know normally</font><font color="#E5E5E5"> you don't add</font>

420
00:22:59,250 --> 00:23:05,580
something to ESP<font color="#E5E5E5"> but</font><font color="#CCCCCC"> let's</font><font color="#E5E5E5"> pretend</font>

421
00:23:01,980 --> 00:23:08,639
that's like I had<font color="#E5E5E5"> just put a negative</font>

422
00:23:05,580 --> 00:23:12,149
<font color="#E5E5E5">number into EAX and</font><font color="#CCCCCC"> I want to make it</font>

423
00:23:08,639 --> 00:23:16,049
<font color="#CCCCCC">seven if I add</font><font color="#E5E5E5"> earth you know</font><font color="#CCCCCC"> nine if I</font>

424
00:23:12,149 --> 00:23:18,059
add 10<font color="#E5E5E5"> to</font><font color="#CCCCCC"> EAX instead of the ESP in this</font>

425
00:23:16,049 --> 00:23:20,190
slide<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that would give me</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> nine men</font>

426
00:23:18,059 --> 00:23:23,340
looking<font color="#CCCCCC"> forward and then I have to deal</font>

427
00:23:20,190 --> 00:23:26,789
<font color="#CCCCCC">with these pops right</font><font color="#E5E5E5"> I have to put junk</font>

428
00:23:23,340 --> 00:23:29,250
into<font color="#CCCCCC"> EBX in the SI after that and then I</font>

429
00:23:26,789 --> 00:23:31,470
<font color="#CCCCCC">get my return I have</font><font color="#E5E5E5"> my next</font><font color="#CCCCCC"> memory and</font>

430
00:23:29,250 --> 00:23:33,480
my next<font color="#E5E5E5"> gadget that you</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to execute</font>

431
00:23:31,470 --> 00:23:34,620
<font color="#CCCCCC">it'll get popped off off</font><font color="#E5E5E5"> the second I'm</font>

432
00:23:33,480 --> 00:23:39,360
off to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> races</font>

433
00:23:34,620 --> 00:23:43,139
<font color="#E5E5E5">does that make sense any questions cool</font>

434
00:23:39,360 --> 00:23:45,299
so<font color="#CCCCCC"> you're probably</font><font color="#E5E5E5"> wondering</font><font color="#CCCCCC"> Doug how do</font>

435
00:23:43,139 --> 00:23:48,570
you how do<font color="#E5E5E5"> you build rap chains or how</font>

436
00:23:45,299 --> 00:23:51,720
do you<font color="#E5E5E5"> find gadgets right there's tools</font>

437
00:23:48,570 --> 00:23:54,928
for<font color="#E5E5E5"> that right</font><font color="#CCCCCC"> Mona</font><font color="#E5E5E5"> is a really good</font>

438
00:23:51,720 --> 00:23:56,840
<font color="#E5E5E5">tool for finding gadgets in a building</font>

439
00:23:54,929 --> 00:23:59,519
rap chains<font color="#CCCCCC"> and</font><font color="#E5E5E5"> on the Windows platform</font>

440
00:23:56,840 --> 00:24:01,529
<font color="#CCCCCC">there's a bunch of Python scripts like</font>

441
00:23:59,519 --> 00:24:04,289
<font color="#CCCCCC">lot gadget that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> down from</font>

442
00:24:01,529 --> 00:24:09,990
download from github to build rap chains

443
00:24:04,289 --> 00:24:11,970
and<font color="#E5E5E5"> fun gadgets on the Linux platform so</font>

444
00:24:09,990 --> 00:24:14,370
what we want to<font color="#E5E5E5"> do is we've</font><font color="#CCCCCC"> got all</font>

445
00:24:11,970 --> 00:24:16,500
these gadgets that are in<font color="#E5E5E5"> our memory</font>

446
00:24:14,370 --> 00:24:19,110
space<font color="#E5E5E5"> and we want to start creating</font>

447
00:24:16,500 --> 00:24:21,389
chains of different gadgets to do the

448
00:24:19,110 --> 00:24:24,809
things that<font color="#E5E5E5"> we want to do right we want</font>

449
00:24:21,389 --> 00:24:28,799
<font color="#E5E5E5">to we</font><font color="#CCCCCC"> have a destination in mind but</font><font color="#E5E5E5"> we</font>

450
00:24:24,809 --> 00:24:31,379
have to<font color="#E5E5E5"> get there right for example</font>

451
00:24:28,799 --> 00:24:33,509
<font color="#CCCCCC">depp's</font><font color="#E5E5E5"> turned on in this case right I</font>

452
00:24:31,379 --> 00:24:36,029
want to<font color="#E5E5E5"> turn that off right I want to</font>

453
00:24:33,509 --> 00:24:38,129
execute stuff on the stack<font color="#E5E5E5"> why don't</font><font color="#CCCCCC"> we</font>

454
00:24:36,029 --> 00:24:40,350
<font color="#E5E5E5">just turn that off for the memory space</font>

455
00:24:38,129 --> 00:24:43,289
that we put the<font color="#CCCCCC"> shellcode</font><font color="#E5E5E5"> in right that</font>

456
00:24:40,350 --> 00:24:47,789
would<font color="#E5E5E5"> be cool</font><font color="#CCCCCC"> right so I'm going to</font>

457
00:24:43,289 --> 00:24:52,500
build<font color="#E5E5E5"> a</font><font color="#CCCCCC"> rock chain to go and turn turn</font>

458
00:24:47,789 --> 00:24:55,190
off<font color="#CCCCCC"> that</font><font color="#E5E5E5"> great job mitigation techniques</font>

459
00:24:52,500 --> 00:24:55,190
or hate

460
00:24:55,409 --> 00:25:00,740
another thing that<font color="#CCCCCC"> we have to deal with</font>

461
00:24:56,970 --> 00:25:04,440
<font color="#E5E5E5">is SLR a SLR is the randomization of</font>

462
00:25:00,740 --> 00:25:08,429
memory space<font color="#E5E5E5"> right this stack is</font>

463
00:25:04,440 --> 00:25:10,380
normally under our control<font color="#E5E5E5"> so</font><font color="#CCCCCC"> things are</font>

464
00:25:08,429 --> 00:25:12,929
always changing<font color="#CCCCCC"> at the memory</font><font color="#E5E5E5"> addresses</font>

465
00:25:10,380 --> 00:25:14,460
are always changing on the<font color="#E5E5E5"> stack</font><font color="#CCCCCC"> we want</font>

466
00:25:12,929 --> 00:25:16,890
to make<font color="#CCCCCC"> sure that that's</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> happening</font>

467
00:25:14,460 --> 00:25:19,860
with our gadgets<font color="#CCCCCC"> right because when I</font>

468
00:25:16,890 --> 00:25:24,630
<font color="#E5E5E5">write my spoi if the memory address for</font>

469
00:25:19,860 --> 00:25:29,340
<font color="#CCCCCC">um</font><font color="#E5E5E5"> you know my first gadgets 1 2 3 4 5 6</font>

470
00:25:24,630 --> 00:25:31,950
<font color="#E5E5E5">7 8</font><font color="#CCCCCC"> right and the next time I start up</font>

471
00:25:29,340 --> 00:25:34,949
the application<font color="#CCCCCC"> SLR is under control</font>

472
00:25:31,950 --> 00:25:38,669
<font color="#CCCCCC">yeah is in play it randomizes the</font><font color="#E5E5E5"> memory</font>

473
00:25:34,950 --> 00:25:40,500
addresses<font color="#CCCCCC"> then it's 9 8 7 6 5 4 3</font><font color="#E5E5E5"> 2 1</font>

474
00:25:38,669 --> 00:25:44,909
I'm kind of screwed because<font color="#E5E5E5"> then I can't</font>

475
00:25:40,500 --> 00:25:47,700
execute my my gadget<font color="#E5E5E5"> and you have to</font>

476
00:25:44,909 --> 00:25:50,309
have control<font color="#CCCCCC"> over ESP</font><font color="#E5E5E5"> right because ESP</font>

477
00:25:47,700 --> 00:25:52,260
is where we<font color="#E5E5E5"> are putting</font><font color="#CCCCCC"> away</font><font color="#E5E5E5"> we're</font>

478
00:25:50,309 --> 00:25:55,710
<font color="#E5E5E5">putting these gadgets out in the stack</font>

479
00:25:52,260 --> 00:25:59,010
and<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have to be able</font><font color="#E5E5E5"> to point ESP to</font>

480
00:25:55,710 --> 00:26:01,200
our gadgets or I<font color="#E5E5E5"> mean our chain to be</font>

481
00:25:59,010 --> 00:26:03,870
able<font color="#E5E5E5"> to do the</font><font color="#CCCCCC"> rats</font><font color="#E5E5E5"> right because the</font>

482
00:26:01,200 --> 00:26:07,500
rent is just<font color="#E5E5E5"> popping you know popping</font>

483
00:26:03,870 --> 00:26:12,479
<font color="#E5E5E5">that value off the stack for us so</font>

484
00:26:07,500 --> 00:26:15,690
here's an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> I need</font><font color="#CCCCCC"> to put 2 C into</font>

485
00:26:12,480 --> 00:26:19,950
EAX<font color="#E5E5E5"> and hex</font><font color="#CCCCCC"> zero zero is a bad character</font>

486
00:26:15,690 --> 00:26:23,340
<font color="#E5E5E5">right so I can't just put zero zero zero</font>

487
00:26:19,950 --> 00:26:26,610
zero zero zero to<font color="#CCCCCC"> C into my exploit</font>

488
00:26:23,340 --> 00:26:28,340
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the first four six</font><font color="#E5E5E5"> zeros are</font>

489
00:26:26,610 --> 00:26:33,899
going to just break my<font color="#E5E5E5"> spoiler right</font>

490
00:26:28,340 --> 00:26:37,649
because<font color="#E5E5E5"> hex 0 0 is a bad character so</font>

491
00:26:33,899 --> 00:26:38,908
what I do is I build<font color="#E5E5E5"> a chain first thing</font>

492
00:26:37,649 --> 00:26:43,709
I'm going to do is I'm going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find a</font>

493
00:26:38,909 --> 00:26:46,289
pop<font color="#CCCCCC"> EAX</font><font color="#E5E5E5"> right that's at the top of the</font>

494
00:26:43,710 --> 00:26:50,370
chain and<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to pop a value into</font>

495
00:26:46,289 --> 00:26:53,279
<font color="#E5E5E5">the X register I'm going to choose ffff</font>

496
00:26:50,370 --> 00:26:59,158
<font color="#E5E5E5">ffff anybody know what value that is in</font>

497
00:26:53,279 --> 00:27:02,039
decimal okay<font color="#CCCCCC"> minus</font><font color="#E5E5E5"> 1 yep it's negative 1</font>

498
00:26:59,159 --> 00:27:04,830
I didn't have to use any zeros put that

499
00:27:02,039 --> 00:27:07,600
into the register<font color="#E5E5E5"> as soon as I execute</font>

500
00:27:04,830 --> 00:27:10,210
that pop<font color="#E5E5E5"> you can take that value</font><font color="#CCCCCC"> of s</font>

501
00:27:07,600 --> 00:27:13,330
put it into EAX<font color="#CCCCCC"> and now have -</font><font color="#E5E5E5"> one in</font>

502
00:27:10,210 --> 00:27:17,289
<font color="#E5E5E5">EAX</font><font color="#CCCCCC"> so how do you</font><font color="#E5E5E5"> think I might get</font><font color="#CCCCCC"> - to</font>

503
00:27:13,330 --> 00:27:21,159
see I just find an ad right<font color="#CCCCCC"> a gadget</font>

504
00:27:17,289 --> 00:27:23,890
<font color="#E5E5E5">that has an</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> Dax</font><font color="#CCCCCC"> and then I just start</font>

505
00:27:21,160 --> 00:27:26,980
executed executing them until I get<font color="#CCCCCC"> to</font>

506
00:27:23,890 --> 00:27:29,260
<font color="#CCCCCC">that value - to see and then it's</font>

507
00:27:26,980 --> 00:27:30,370
followed up by a rat because all gadgets

508
00:27:29,260 --> 00:27:32,770
are followed up<font color="#CCCCCC"> by a rat or something</font>

509
00:27:30,370 --> 00:27:36,549
<font color="#E5E5E5">that's similar right some type</font><font color="#CCCCCC"> of jump</font>

510
00:27:32,770 --> 00:27:40,090
whatever you see what's going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> so now</font>

511
00:27:36,549 --> 00:27:42,820
<font color="#E5E5E5">I have to see in EAX and I didn't have</font>

512
00:27:40,090 --> 00:27:45,789
to use my<font color="#CCCCCC"> bad character which was</font><font color="#E5E5E5"> X zero</font>

513
00:27:42,820 --> 00:27:49,870
<font color="#E5E5E5">zero which would would</font><font color="#CCCCCC"> it broke my</font>

514
00:27:45,789 --> 00:27:52,480
gadget so now I have a chain of<font color="#E5E5E5"> gadgets</font>

515
00:27:49,870 --> 00:27:53,219
that did what I<font color="#E5E5E5"> needed it to do make</font>

516
00:27:52,480 --> 00:27:57,220
sense

517
00:27:53,220 --> 00:28:00,100
<font color="#E5E5E5">cool yeah yeah we can do</font><font color="#CCCCCC"> it again</font><font color="#E5E5E5"> let's</font>

518
00:27:57,220 --> 00:28:01,929
<font color="#E5E5E5">let's</font><font color="#CCCCCC"> just rewind wait who's awake right</font>

519
00:28:00,100 --> 00:28:04,299
now<font color="#E5E5E5"> because I think that</font><font color="#CCCCCC"> Bill was</font>

520
00:28:01,929 --> 00:28:06,760
<font color="#CCCCCC">falling asleep oh good there's a couple</font>

521
00:28:04,299 --> 00:28:10,240
<font color="#E5E5E5">hands could I'm glad that's good I'm not</font>

522
00:28:06,760 --> 00:28:12,908
<font color="#CCCCCC">sure if I'm awake</font><font color="#E5E5E5"> so that's good okay so</font>

523
00:28:10,240 --> 00:28:15,070
I<font color="#CCCCCC"> said that Mona</font><font color="#E5E5E5"> would be a good tool to</font>

524
00:28:12,909 --> 00:28:19,000
find gadgets<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> Windows platform</font>

525
00:28:15,070 --> 00:28:21,668
<font color="#CCCCCC">right so I'm</font><font color="#E5E5E5"> just gonna go</font><font color="#CCCCCC"> into hey Mona</font>

526
00:28:19,000 --> 00:28:27,039
<font color="#CCCCCC">rock for me</font><font color="#E5E5E5"> right and she's going to go</font>

527
00:28:21,669 --> 00:28:29,620
out and find gadgets she's also going to

528
00:28:27,039 --> 00:28:31,510
go out and build you know try<font color="#CCCCCC"> to build</font>

529
00:28:29,620 --> 00:28:33,399
chains for me<font color="#E5E5E5"> she would tell me</font><font color="#CCCCCC"> about</font>

530
00:28:31,510 --> 00:28:36,370
interesting gadgets that<font color="#E5E5E5"> I might be in</font>

531
00:28:33,400 --> 00:28:38,830
trip you<font color="#CCCCCC"> might be able to use she'll get</font>

532
00:28:36,370 --> 00:28:41,260
all done that you<font color="#E5E5E5"> can find right</font><font color="#CCCCCC"> in the</font>

533
00:28:38,830 --> 00:28:44,860
app application<font color="#CCCCCC"> and she'll put them in</font>

534
00:28:41,260 --> 00:28:47,590
files for me so like<font color="#CCCCCC"> rock text will have</font>

535
00:28:44,860 --> 00:28:50,408
all the rot sets you found right very

536
00:28:47,590 --> 00:28:52,120
<font color="#E5E5E5">cool if you go and do this and you have</font>

537
00:28:50,409 --> 00:28:55,750
a big<font color="#CCCCCC"> application like let's say</font>

538
00:28:52,120 --> 00:28:58,600
Wireshark<font color="#E5E5E5"> right and you say just rock it</font>

539
00:28:55,750 --> 00:29:02,860
<font color="#CCCCCC">motor</font><font color="#E5E5E5"> wrong right sometimes</font><font color="#CCCCCC"> Monet</font>

540
00:28:58,600 --> 00:29:05,320
doesn't look and see which libraries<font color="#CCCCCC"> it</font>

541
00:29:02,860 --> 00:29:09,879
might need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> and it will go and try</font>

542
00:29:05,320 --> 00:29:12,990
<font color="#E5E5E5">to find</font><font color="#CCCCCC"> Roth's</font><font color="#E5E5E5"> fullerene gadgets for all</font>

543
00:29:09,880 --> 00:29:17,110
the libraries that<font color="#E5E5E5"> are being loaded into</font>

544
00:29:12,990 --> 00:29:19,450
Wireshark<font color="#E5E5E5"> and when that happens your VM</font>

545
00:29:17,110 --> 00:29:21,159
is going to lock up really hard and your

546
00:29:19,450 --> 00:29:22,240
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> is going to lock up really hard</font>

547
00:29:21,160 --> 00:29:24,850
and you're going to<font color="#E5E5E5"> be like I need</font>

548
00:29:22,240 --> 00:29:27,700
<font color="#CCCCCC">coffee and I</font><font color="#E5E5E5"> won't be able to use my</font>

549
00:29:24,850 --> 00:29:30,399
<font color="#CCCCCC">machine for hours right so if you do</font>

550
00:29:27,700 --> 00:29:32,950
that<font color="#CCCCCC"> just be</font><font color="#E5E5E5"> aware of what you're doing</font>

551
00:29:30,400 --> 00:29:35,680
<font color="#CCCCCC">and just</font><font color="#E5E5E5"> tell Mona I'm interested in</font>

552
00:29:32,950 --> 00:29:38,440
looking<font color="#CCCCCC"> for gadgets in these yellows</font><font color="#E5E5E5"> and</font>

553
00:29:35,680 --> 00:29:40,540
just you know<font color="#E5E5E5"> zero down but unless you</font>

554
00:29:38,440 --> 00:29:42,760
<font color="#E5E5E5">want your machine</font><font color="#CCCCCC"> to get real hot</font><font color="#E5E5E5"> and</font>

555
00:29:40,540 --> 00:29:46,450
you know not<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to use it for a</font>

556
00:29:42,760 --> 00:29:48,629
long time<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but oh I've done it</font>

557
00:29:46,450 --> 00:29:54,130
plenty of times<font color="#E5E5E5"> yeah it's aggravating</font>

558
00:29:48,630 --> 00:29:55,960
<font color="#E5E5E5">that's why I'm warning you okay</font><font color="#CCCCCC"> so you</font>

559
00:29:54,130 --> 00:30:01,770
might<font color="#CCCCCC"> be thinking okay Doug you just</font>

560
00:29:55,960 --> 00:30:06,040
said let's<font color="#E5E5E5"> turn</font><font color="#CCCCCC"> rap off</font><font color="#E5E5E5"> right well on</font>

561
00:30:01,770 --> 00:30:07,510
Windows<font color="#E5E5E5"> there is a bunch of functions</font>

562
00:30:06,040 --> 00:30:09,490
<font color="#E5E5E5">but we're going to pick on virtual</font>

563
00:30:07,510 --> 00:30:13,690
protect right now<font color="#E5E5E5"> they'll be</font><font color="#CCCCCC"> able to</font>

564
00:30:09,490 --> 00:30:16,530
<font color="#E5E5E5">help us turn</font><font color="#CCCCCC"> death off in a specific</font>

565
00:30:13,690 --> 00:30:20,800
<font color="#E5E5E5">area of memory virtual will protect</font>

566
00:30:16,530 --> 00:30:26,500
modifies the permissions of memory<font color="#E5E5E5"> right</font>

567
00:30:20,800 --> 00:30:29,950
and<font color="#E5E5E5"> Mona is really nice because she will</font>

568
00:30:26,500 --> 00:30:32,010
<font color="#E5E5E5">try to create a chain utilizing</font><font color="#CCCCCC"> virtual</font>

569
00:30:29,950 --> 00:30:34,960
product so she does the work for<font color="#E5E5E5"> you</font>

570
00:30:32,010 --> 00:30:37,570
<font color="#E5E5E5">sometimes she might not be</font><font color="#CCCCCC"> able to find</font>

571
00:30:34,960 --> 00:30:42,340
the correct gadgets<font color="#CCCCCC"> that she needs</font><font color="#E5E5E5"> to be</font>

572
00:30:37,570 --> 00:30:43,870
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> turn you know Deb</font><font color="#E5E5E5"> off of</font><font color="#CCCCCC"> that</font>

573
00:30:42,340 --> 00:30:46,000
area<font color="#CCCCCC"> so you're going to</font><font color="#E5E5E5"> have to go and</font>

574
00:30:43,870 --> 00:30:48,280
fix fix the chain but she does a<font color="#E5E5E5"> really</font>

575
00:30:46,000 --> 00:30:50,500
good job<font color="#E5E5E5"> of setting things up for you so</font>

576
00:30:48,280 --> 00:30:53,200
here you<font color="#E5E5E5"> can kind of see an example of</font>

577
00:30:50,500 --> 00:30:54,730
<font color="#E5E5E5">this down below it kind of took a</font>

578
00:30:53,200 --> 00:30:57,220
snippet out of the beginning of the

579
00:30:54,730 --> 00:30:58,810
chain<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can see how the very first</font>

580
00:30:57,220 --> 00:31:01,780
thing<font color="#CCCCCC"> that she</font><font color="#E5E5E5"> does is she finds a</font>

581
00:30:58,810 --> 00:31:05,530
pointer<font color="#CCCCCC"> to virtual to protect in the</font>

582
00:31:01,780 --> 00:31:07,570
application<font color="#E5E5E5"> itself right and then what</font>

583
00:31:05,530 --> 00:31:09,399
she<font color="#E5E5E5"> does is she figures out a</font><font color="#CCCCCC"> way so</font>

584
00:31:07,570 --> 00:31:12,070
that<font color="#CCCCCC"> you can pivot on the pointer</font><font color="#E5E5E5"> and</font>

585
00:31:09,400 --> 00:31:16,450
then call virtual protect directly from

586
00:31:12,070 --> 00:31:18,310
the kernel to disable that<font color="#E5E5E5"> virtual</font>

587
00:31:16,450 --> 00:31:21,130
protect is so cool because you<font color="#CCCCCC"> can go</font>

588
00:31:18,310 --> 00:31:24,040
you know I've got this<font color="#E5E5E5"> area of memory</font>

589
00:31:21,130 --> 00:31:26,710
<font color="#E5E5E5">like the stack</font><font color="#CCCCCC"> and right now it's only</font>

590
00:31:24,040 --> 00:31:29,290
<font color="#E5E5E5">read right and I want to be able to</font>

591
00:31:26,710 --> 00:31:32,740
<font color="#E5E5E5">execute off the sack Vergil protect can</font>

592
00:31:29,290 --> 00:31:34,680
you like take these<font color="#E5E5E5"> 100 bytes and just</font>

593
00:31:32,740 --> 00:31:38,320
make make<font color="#E5E5E5"> it executable for me</font>

594
00:31:34,680 --> 00:31:44,140
sure<font color="#E5E5E5"> we'll do that that's cool we can do</font>

595
00:31:38,320 --> 00:31:47,980
that<font color="#E5E5E5"> right thanks Microsoft so here's a</font>

596
00:31:44,140 --> 00:31:50,020
bunch of different<font color="#E5E5E5"> functions that we</font>

597
00:31:47,980 --> 00:31:52,120
could use let's say<font color="#E5E5E5"> virtual protect</font>

598
00:31:50,020 --> 00:31:54,879
isn't<font color="#CCCCCC"> available</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> application but</font>

599
00:31:52,120 --> 00:31:56,020
virtual virtual<font color="#E5E5E5"> Alec is there's</font>

600
00:31:54,880 --> 00:31:57,370
<font color="#E5E5E5">different ways</font><font color="#CCCCCC"> to do it</font>

601
00:31:56,020 --> 00:31:58,930
<font color="#E5E5E5">but we're going to pick out virtual</font>

602
00:31:57,370 --> 00:32:03,879
protect right now<font color="#E5E5E5"> normally virtual</font>

603
00:31:58,930 --> 00:32:05,710
protect is very reliable<font color="#E5E5E5"> right we're</font>

604
00:32:03,880 --> 00:32:07,480
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> Windows here if you're</font>

605
00:32:05,710 --> 00:32:09,700
looking<font color="#CCCCCC"> at Linux</font><font color="#E5E5E5"> if you like to pick on</font>

606
00:32:07,480 --> 00:32:11,650
Linux<font color="#E5E5E5"> and protect it a good thing to do</font>

607
00:32:09,700 --> 00:32:13,750
yeah that's that's<font color="#E5E5E5"> a function you might</font>

608
00:32:11,650 --> 00:32:16,800
want<font color="#CCCCCC"> to do man on ok</font>

609
00:32:13,750 --> 00:32:20,590
so virtual product is a kernel<font color="#CCCCCC"> function</font>

610
00:32:16,800 --> 00:32:24,090
<font color="#E5E5E5">is it whit I have to say when XP was</font>

611
00:32:20,590 --> 00:32:26,740
awesome<font color="#CCCCCC"> I loved</font><font color="#E5E5E5"> when XP because</font>

612
00:32:24,090 --> 00:32:29,020
everything was static<font color="#CCCCCC"> there was no ASL</font>

613
00:32:26,740 --> 00:32:32,110
are turned on and<font color="#CCCCCC"> a lot of the OS</font>

614
00:32:29,020 --> 00:32:35,320
libraries right including the kernel

615
00:32:32,110 --> 00:32:37,719
right so you could<font color="#CCCCCC"> just say</font><font color="#E5E5E5"> you know</font>

616
00:32:35,320 --> 00:32:40,300
<font color="#E5E5E5">call virtual protect directly from the</font>

617
00:32:37,720 --> 00:32:41,980
kernel because there's no<font color="#CCCCCC"> ASLR there's</font>

618
00:32:40,300 --> 00:32:45,669
no randomization there you could always

619
00:32:41,980 --> 00:32:48,280
reliably use<font color="#CCCCCC"> that function well</font><font color="#E5E5E5"> Windows</font>

620
00:32:45,670 --> 00:32:50,920
<font color="#CCCCCC">7 came along to galuwa</font><font color="#E5E5E5"> smarter and now</font>

621
00:32:48,280 --> 00:32:51,879
you know<font color="#E5E5E5"> a SLR is turned on on those OS</font>

622
00:32:50,920 --> 00:32:54,220
<font color="#E5E5E5">dll's</font>

623
00:32:51,880 --> 00:32:57,220
so we all we do is we<font color="#E5E5E5"> look</font><font color="#CCCCCC"> for the</font>

624
00:32:54,220 --> 00:32:59,650
pointer that<font color="#CCCCCC"> is being used within</font><font color="#E5E5E5"> our</font>

625
00:32:57,220 --> 00:33:01,810
<font color="#CCCCCC">application to</font><font color="#E5E5E5"> point to it because it's</font>

626
00:32:59,650 --> 00:33:03,730
always<font color="#CCCCCC"> going to be</font><font color="#E5E5E5"> dynamically created</font>

627
00:33:01,810 --> 00:33:06,600
every time<font color="#E5E5E5"> that application runs and</font>

628
00:33:03,730 --> 00:33:09,760
then we can<font color="#E5E5E5"> just pivot off that pointer</font>

629
00:33:06,600 --> 00:33:11,219
<font color="#E5E5E5">good job a SLR right thank you for</font>

630
00:33:09,760 --> 00:33:17,710
<font color="#CCCCCC">protecting me</font>

631
00:33:11,220 --> 00:33:21,400
awesome yeah so here<font color="#E5E5E5"> we are we</font><font color="#CCCCCC"> have the</font>

632
00:33:17,710 --> 00:33:23,920
<font color="#CCCCCC">layout of how to call virtual protect in</font>

633
00:33:21,400 --> 00:33:27,700
a function all<font color="#E5E5E5"> right I mean the virtual</font>

634
00:33:23,920 --> 00:33:30,040
<font color="#CCCCCC">production so on the stack I need to</font>

635
00:33:27,700 --> 00:33:31,630
have the<font color="#E5E5E5"> address of virtual to protect</font>

636
00:33:30,040 --> 00:33:34,240
at the top right because I'm<font color="#E5E5E5"> going to</font>

637
00:33:31,630 --> 00:33:37,510
<font color="#E5E5E5">call them get a return to it remember we</font>

638
00:33:34,240 --> 00:33:38,560
were we need<font color="#E5E5E5"> to return to our gadgets</font>

639
00:33:37,510 --> 00:33:40,240
and stuff<font color="#E5E5E5"> we're going to do the same</font>

640
00:33:38,560 --> 00:33:41,500
thing with virtual to protect<font color="#CCCCCC"> so the</font>

641
00:33:40,240 --> 00:33:44,530
first thing<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to happen is</font>

642
00:33:41,500 --> 00:33:45,990
we're going<font color="#E5E5E5"> to return to that you know</font>

643
00:33:44,530 --> 00:33:48,928
the memory<font color="#E5E5E5"> address</font><font color="#CCCCCC"> of</font>

644
00:33:45,990 --> 00:33:51,090
virtual<font color="#E5E5E5"> product then the nice thing</font>

645
00:33:48,929 --> 00:33:54,330
that's on the stack is going to be the

646
00:33:51,090 --> 00:33:57,480
<font color="#CCCCCC">address that</font><font color="#E5E5E5"> we go to after the function</font>

647
00:33:54,330 --> 00:34:00,889
<font color="#E5E5E5">is done right we're kind of taking</font>

648
00:33:57,480 --> 00:34:04,620
<font color="#CCCCCC">advantage</font><font color="#E5E5E5"> of how functions are called</font>

649
00:34:00,890 --> 00:34:08,340
<font color="#E5E5E5">especially on the x86</font><font color="#CCCCCC"> architecture here</font>

650
00:34:04,620 --> 00:34:10,618
<font color="#E5E5E5">right because when in whenever functions</font>

651
00:34:08,340 --> 00:34:13,649
<font color="#E5E5E5">really get</font><font color="#CCCCCC"> called and you're</font><font color="#E5E5E5"> not messing</font>

652
00:34:10,619 --> 00:34:16,530
<font color="#E5E5E5">around with it with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> boy</font><font color="#CCCCCC"> the last</font><font color="#E5E5E5"> thing</font>

653
00:34:13,649 --> 00:34:18,210
that gets pushed<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> the stack</font><font color="#CCCCCC"> when we</font>

654
00:34:16,530 --> 00:34:21,480
call a function is the address<font color="#CCCCCC"> that</font>

655
00:34:18,210 --> 00:34:23,730
we're going<font color="#E5E5E5"> to return to right so in</font>

656
00:34:21,480 --> 00:34:26,940
this case<font color="#CCCCCC"> we're going</font><font color="#E5E5E5"> to put the address</font>

657
00:34:23,730 --> 00:34:29,820
<font color="#E5E5E5">of the shellcode that we want to jump to</font>

658
00:34:26,940 --> 00:34:32,820
after virtual protect<font color="#E5E5E5"> turns off the</font>

659
00:34:29,820 --> 00:34:35,760
error<font color="#E5E5E5"> turns on execution for that you</font>

660
00:34:32,820 --> 00:34:38,730
know<font color="#E5E5E5"> area of memory then we're going to</font>

661
00:34:35,760 --> 00:34:41,820
tell<font color="#E5E5E5"> it</font><font color="#CCCCCC"> how many bytes we want to you</font>

662
00:34:38,730 --> 00:34:44,659
<font color="#E5E5E5">know change</font><font color="#CCCCCC"> the permissions for so you</font>

663
00:34:41,820 --> 00:34:49,260
<font color="#E5E5E5">know we might how big is our shellcode</font>

664
00:34:44,659 --> 00:34:54,629
<font color="#CCCCCC">100 bytes</font><font color="#E5E5E5"> maybe on on a</font><font color="#CCCCCC"> linux ploy maybe</font>

665
00:34:49,260 --> 00:34:57,300
like<font color="#E5E5E5"> 500 to 700 pipes for Windows shell</font>

666
00:34:54,629 --> 00:34:59,130
<font color="#E5E5E5">code right we were going to have to tell</font>

667
00:34:57,300 --> 00:35:02,700
virtual<font color="#CCCCCC"> protect we want this much space</font>

668
00:34:59,130 --> 00:35:08,520
<font color="#E5E5E5">that has the executable bit turned on</font>

669
00:35:02,700 --> 00:35:09,868
let's say<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> and then um we want to</font>

670
00:35:08,520 --> 00:35:13,350
tell<font color="#CCCCCC"> it you know what the new</font>

671
00:35:09,869 --> 00:35:16,470
permissions are right so hex<font color="#E5E5E5"> for 0 on</font>

672
00:35:13,350 --> 00:35:18,089
<font color="#CCCCCC">windows is you know the value you</font><font color="#E5E5E5"> want</font>

673
00:35:16,470 --> 00:35:20,819
you<font color="#E5E5E5"> just</font><font color="#CCCCCC"> have to remember</font><font color="#E5E5E5"> that or take a</font>

674
00:35:18,090 --> 00:35:23,220
<font color="#E5E5E5">picture of this slide whatever on Linux</font>

675
00:35:20,820 --> 00:35:26,130
<font color="#E5E5E5">it's going to be pretty easy everybody</font>

676
00:35:23,220 --> 00:35:28,470
knows about<font color="#E5E5E5"> schmod right how do you make</font>

677
00:35:26,130 --> 00:35:31,920
something executable<font color="#E5E5E5"> in Linux</font><font color="#CCCCCC"> you say</font><font color="#E5E5E5"> to</font>

678
00:35:28,470 --> 00:35:34,980
mod<font color="#E5E5E5"> 7 whatever right it's the</font><font color="#CCCCCC"> same thing</font>

679
00:35:31,920 --> 00:35:38,460
<font color="#CCCCCC">we need some m protect on Linux to</font>

680
00:35:34,980 --> 00:35:40,740
change the<font color="#E5E5E5"> permissions set to 7 right so</font>

681
00:35:38,460 --> 00:35:42,450
we get read write execute<font color="#E5E5E5"> and then it's</font>

682
00:35:40,740 --> 00:35:45,359
<font color="#E5E5E5">something really weird about virtual</font>

683
00:35:42,450 --> 00:35:48,779
product and I<font color="#E5E5E5"> am NOT a</font><font color="#CCCCCC"> developer I said</font>

684
00:35:45,359 --> 00:35:53,430
that at<font color="#CCCCCC"> the beginning is</font><font color="#E5E5E5"> that you have</font>

685
00:35:48,780 --> 00:35:55,920
to take the permissions<font color="#E5E5E5"> of the page</font><font color="#CCCCCC"> that</font>

686
00:35:53,430 --> 00:35:57,790
you're<font color="#E5E5E5"> making the change to and then</font>

687
00:35:55,920 --> 00:36:01,390
apply that<font color="#E5E5E5"> the</font>

688
00:35:57,790 --> 00:36:03,790
current permissions<font color="#E5E5E5"> to some other area</font>

689
00:36:01,390 --> 00:36:06,700
of<font color="#CCCCCC"> memory</font><font color="#E5E5E5"> so you just choose something</font>

690
00:36:03,790 --> 00:36:09,700
<font color="#E5E5E5">randomly that's in the address space of</font>

691
00:36:06,700 --> 00:36:12,129
<font color="#CCCCCC">the application and just say</font><font color="#E5E5E5"> do it to</font>

692
00:36:09,700 --> 00:36:16,240
<font color="#E5E5E5">that and I don't really know why virtual</font>

693
00:36:12,130 --> 00:36:18,520
protect has that in its parameters but

694
00:36:16,240 --> 00:36:20,140
you<font color="#E5E5E5"> just have to deal with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so you</font>

695
00:36:18,520 --> 00:36:23,110
<font color="#E5E5E5">just choose something randomly and it</font>

696
00:36:20,140 --> 00:36:26,650
goes and<font color="#E5E5E5"> makes it read right I don't</font>

697
00:36:23,110 --> 00:36:27,760
know<font color="#E5E5E5"> okay so let's let's test this out</font>

698
00:36:26,650 --> 00:36:29,710
let's check<font color="#E5E5E5"> it out</font>

699
00:36:27,760 --> 00:36:31,540
let's go back to demo and hope<font color="#E5E5E5"> that my</font>

700
00:36:29,710 --> 00:36:34,060
Windows machine just<font color="#E5E5E5"> didn't reboot on it</font>

701
00:36:31,540 --> 00:36:36,880
oh good<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> back okay that's that's</font>

702
00:36:34,060 --> 00:36:41,560
<font color="#E5E5E5">always good and what we're going to do</font>

703
00:36:36,880 --> 00:36:43,930
is instead of instead<font color="#E5E5E5"> of using my</font>

704
00:36:41,560 --> 00:36:46,420
<font color="#E5E5E5">regular spoil you exploit where I was</font>

705
00:36:43,930 --> 00:36:49,750
using the jump<font color="#CCCCCC"> ESP</font><font color="#E5E5E5"> I'm going to now</font>

706
00:36:46,420 --> 00:36:51,070
utilize a chain that<font color="#CCCCCC"> Mona created so</font>

707
00:36:49,750 --> 00:36:54,550
first thing I'm going to do is I'm going

708
00:36:51,070 --> 00:36:56,260
<font color="#E5E5E5">to fire up</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> application</font><font color="#CCCCCC"> fire up</font>

709
00:36:54,550 --> 00:36:58,720
immunity<font color="#E5E5E5"> I'm going to</font><font color="#CCCCCC"> bot</font><font color="#E5E5E5"> you know</font>

710
00:36:56,260 --> 00:37:00,820
<font color="#E5E5E5">attached to the running process</font><font color="#CCCCCC"> I'm</font>

711
00:36:58,720 --> 00:37:04,359
going<font color="#CCCCCC"> to start it up stop it and then</font>

712
00:37:00,820 --> 00:37:08,320
<font color="#E5E5E5">I'm going to say Mona right Mona please</font>

713
00:37:04,360 --> 00:37:10,960
<font color="#CCCCCC">find Rob for</font><font color="#E5E5E5"> me right and oh wait while</font>

714
00:37:08,320 --> 00:37:16,120
you're<font color="#E5E5E5"> doing it</font><font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> make sure that</font>

715
00:37:10,960 --> 00:37:19,960
let's see - yep make sure<font color="#E5E5E5"> that you don't</font>

716
00:37:16,120 --> 00:37:21,790
<font color="#E5E5E5">find any addresses with hex</font><font color="#CCCCCC"> zero zero in</font>

717
00:37:19,960 --> 00:37:25,630
it<font color="#E5E5E5"> this route this</font><font color="#CCCCCC"> is small I'm sorry</font>

718
00:37:21,790 --> 00:37:27,490
but I'm telling Mona to ignore any a

719
00:37:25,630 --> 00:37:29,860
memory addresses with a hex<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> zero</font>

720
00:37:27,490 --> 00:37:32,470
<font color="#CCCCCC">okay because heck zero zero will break</font>

721
00:37:29,860 --> 00:37:35,260
my exploit remember in my example I said

722
00:37:32,470 --> 00:37:37,509
that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> application has a problem with</font>

723
00:37:35,260 --> 00:37:39,910
hex zero zero<font color="#CCCCCC"> so she's going</font><font color="#E5E5E5"> to go off</font>

724
00:37:37,510 --> 00:37:42,220
she's going<font color="#E5E5E5"> to go find it and she didn't</font>

725
00:37:39,910 --> 00:37:44,350
hang my machine<font color="#E5E5E5"> right because this is</font><font color="#CCCCCC"> a</font>

726
00:37:42,220 --> 00:37:46,680
really<font color="#E5E5E5"> small application I wrote it</font><font color="#CCCCCC"> and</font>

727
00:37:44,350 --> 00:37:50,319
<font color="#E5E5E5">then</font><font color="#CCCCCC"> as a developer so it's even smaller</font>

728
00:37:46,680 --> 00:37:53,319
<font color="#CCCCCC">okay and if I go into</font><font color="#E5E5E5"> where Mona's</font>

729
00:37:50,320 --> 00:37:57,940
writing her logs<font color="#CCCCCC"> I can go and</font><font color="#E5E5E5"> look and</font>

730
00:37:53,320 --> 00:38:00,430
sure enough<font color="#E5E5E5"> here's my</font><font color="#CCCCCC"> rot file right if</font>

731
00:37:57,940 --> 00:38:03,640
you can see that small here's my<font color="#CCCCCC"> Rob</font>

732
00:38:00,430 --> 00:38:05,350
chains and then she has gives me Rob's

733
00:38:03,640 --> 00:38:06,970
suggestions that's pretty cool

734
00:38:05,350 --> 00:38:09,730
so if I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want to dig through every</font>

735
00:38:06,970 --> 00:38:11,259
single Rob I mean gadget<font color="#CCCCCC"> I can at least</font>

736
00:38:09,730 --> 00:38:13,420
<font color="#E5E5E5">look at the suggestions to see</font>

737
00:38:11,260 --> 00:38:15,670
what she<font color="#CCCCCC"> thinks</font><font color="#E5E5E5"> is good or not</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> but</font>

738
00:38:13,420 --> 00:38:18,850
<font color="#E5E5E5">let's look at the</font><font color="#CCCCCC"> change</font><font color="#E5E5E5"> see what's in</font>

739
00:38:15,670 --> 00:38:22,300
there so if<font color="#E5E5E5"> I scroll down</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit</font>

740
00:38:18,850 --> 00:38:24,970
you will<font color="#CCCCCC"> see that the first</font><font color="#E5E5E5"> thing that</font>

741
00:38:22,300 --> 00:38:28,960
<font color="#E5E5E5">she does is tried</font><font color="#CCCCCC"> to make a chain for</font>

742
00:38:24,970 --> 00:38:31,209
virtual product let me just move that

743
00:38:28,960 --> 00:38:32,350
<font color="#CCCCCC">over so</font><font color="#E5E5E5"> you can see</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and what she's</font>

744
00:38:31,210 --> 00:38:35,440
<font color="#E5E5E5">going to do is she's going to use a</font>

745
00:38:32,350 --> 00:38:39,759
<font color="#E5E5E5">method of that utilizes push a deed</font>

746
00:38:35,440 --> 00:38:44,620
<font color="#E5E5E5">anybody know what push ad does on an</font>

747
00:38:39,760 --> 00:38:49,060
Intel processor<font color="#CCCCCC"> it takes the registers</font>

748
00:38:44,620 --> 00:38:51,460
and pushes them<font color="#CCCCCC"> onto the stack so all</font>

749
00:38:49,060 --> 00:38:53,230
that<font color="#E5E5E5"> Mona needs to do is put all</font><font color="#CCCCCC"> the</font>

750
00:38:51,460 --> 00:38:55,810
values<font color="#CCCCCC"> that she needs to</font><font color="#E5E5E5"> call virtual</font>

751
00:38:53,230 --> 00:38:58,900
<font color="#CCCCCC">protect and put them in the right</font>

752
00:38:55,810 --> 00:39:01,120
registers and then<font color="#CCCCCC"> one push ad is called</font>

753
00:38:58,900 --> 00:39:02,950
it's going to take all that<font color="#E5E5E5"> stuff and</font>

754
00:39:01,120 --> 00:39:05,350
push it onto the stack<font color="#E5E5E5"> and then she's</font>

755
00:39:02,950 --> 00:39:07,120
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> turn around and</font><font color="#E5E5E5"> call you know</font>

756
00:39:05,350 --> 00:39:09,339
the function<font color="#CCCCCC"> just like we</font><font color="#E5E5E5"> just talked</font>

757
00:39:07,120 --> 00:39:12,819
<font color="#CCCCCC">about the way it will</font><font color="#E5E5E5"> be set up exactly</font>

758
00:39:09,340 --> 00:39:15,790
<font color="#E5E5E5">the way we were just you know talking</font>

759
00:39:12,820 --> 00:39:17,560
<font color="#CCCCCC">about and then if you scroll down</font><font color="#E5E5E5"> a</font>

760
00:39:15,790 --> 00:39:19,540
little<font color="#CCCCCC"> bit and I'm going to have to move</font>

761
00:39:17,560 --> 00:39:24,160
this over<font color="#E5E5E5"> again</font><font color="#CCCCCC"> because my windows too</font>

762
00:39:19,540 --> 00:39:27,490
<font color="#CCCCCC">vague she gives an example in Ruby</font><font color="#E5E5E5"> the</font>

763
00:39:24,160 --> 00:39:30,730
example<font color="#CCCCCC"> and C and my favorite the</font>

764
00:39:27,490 --> 00:39:34,109
example in Python<font color="#CCCCCC"> right so I can take</font>

765
00:39:30,730 --> 00:39:37,480
this gadget<font color="#CCCCCC"> or chain of gadgets</font><font color="#E5E5E5"> and</font>

766
00:39:34,110 --> 00:39:44,890
copying them into my script<font color="#CCCCCC"> and utilize</font>

767
00:39:37,480 --> 00:39:47,830
that<font color="#E5E5E5"> so let's let's look at my script if</font>

768
00:39:44,890 --> 00:39:50,230
<font color="#E5E5E5">I scroll down here's my chain the same</font>

769
00:39:47,830 --> 00:39:54,520
chain<font color="#E5E5E5"> that we just saw sorry for those</font>

770
00:39:50,230 --> 00:39:59,530
in the back<font color="#CCCCCC"> I trust me</font><font color="#E5E5E5"> there's stuff</font>

771
00:39:54,520 --> 00:40:01,840
here because<font color="#E5E5E5"> somebody</font><font color="#CCCCCC"> said highlight</font><font color="#E5E5E5"> it</font>

772
00:39:59,530 --> 00:40:06,310
<font color="#E5E5E5">I was again I can highlight</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> there you</font>

773
00:40:01,840 --> 00:40:12,310
<font color="#E5E5E5">go can you see it better yeah yeah</font>

774
00:40:06,310 --> 00:40:14,980
that's<font color="#E5E5E5"> good this is fine okay so this is</font>

775
00:40:12,310 --> 00:40:17,770
the chain<font color="#CCCCCC"> that she made</font><font color="#E5E5E5"> for me I was</font>

776
00:40:14,980 --> 00:40:20,650
<font color="#E5E5E5">really lucky well kind of that she was</font>

777
00:40:17,770 --> 00:40:23,290
<font color="#CCCCCC">able to</font><font color="#E5E5E5"> create a chain to do everything</font>

778
00:40:20,650 --> 00:40:24,970
<font color="#CCCCCC">she needed some applications</font><font color="#E5E5E5"> like this</font>

779
00:40:23,290 --> 00:40:29,050
application before<font color="#CCCCCC"> I started</font>

780
00:40:24,970 --> 00:40:32,140
like developing it had a lot of parts of

781
00:40:29,050 --> 00:40:32,830
the chain<font color="#E5E5E5"> that she can figure out so</font>

782
00:40:32,140 --> 00:40:34,720
what did I do

783
00:40:32,830 --> 00:40:38,410
<font color="#CCCCCC">I went and started</font><font color="#E5E5E5"> creating these</font>

784
00:40:34,720 --> 00:40:40,540
gadgets I was like okay I need<font color="#E5E5E5"> a pop EBP</font>

785
00:40:38,410 --> 00:40:43,240
<font color="#CCCCCC">I'll just create</font><font color="#E5E5E5"> one put it into the</font>

786
00:40:40,540 --> 00:40:44,950
code and then recompile<font color="#E5E5E5"> and then all</font><font color="#CCCCCC"> the</font>

787
00:40:43,240 --> 00:40:46,540
<font color="#CCCCCC">Sun goes there</font><font color="#E5E5E5"> and Mona was like hey</font><font color="#CCCCCC"> I</font>

788
00:40:44,950 --> 00:40:50,649
<font color="#CCCCCC">just felt a change for you that's</font>

789
00:40:46,540 --> 00:40:55,390
<font color="#CCCCCC">awesome okay but then down below instead</font>

790
00:40:50,650 --> 00:40:57,450
<font color="#CCCCCC">of my jumpy SP remember here</font><font color="#E5E5E5"> I'm going</font>

791
00:40:55,390 --> 00:41:03,098
to put my chain in in there instead

792
00:40:57,450 --> 00:41:04,990
<font color="#E5E5E5">right so I'm replacing the</font><font color="#CCCCCC"> jumpy</font><font color="#E5E5E5"> SP so</font>

793
00:41:03,099 --> 00:41:07,480
because I can't jump back to<font color="#E5E5E5"> the stack</font>

794
00:41:04,990 --> 00:41:11,229
it's not executable<font color="#E5E5E5"> and putting my chain</font>

795
00:41:07,480 --> 00:41:13,570
there<font color="#E5E5E5"> of gadgets but my entire script</font>

796
00:41:11,230 --> 00:41:16,780
the rest of it is exactly<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> the</font>

797
00:41:13,570 --> 00:41:18,190
<font color="#CCCCCC">shellcode is</font><font color="#E5E5E5"> afterwards the script is</font>

798
00:41:16,780 --> 00:41:21,880
<font color="#CCCCCC">the same except for</font><font color="#E5E5E5"> the fact that I'm</font>

799
00:41:18,190 --> 00:41:24,190
using<font color="#CCCCCC"> wrap to turn off debt in that area</font>

800
00:41:21,880 --> 00:41:26,470
instead of you<font color="#CCCCCC"> know just jumping to the</font>

801
00:41:24,190 --> 00:41:29,950
code at the<font color="#CCCCCC"> shellcode itself really</font>

802
00:41:26,470 --> 00:41:32,020
really cool<font color="#E5E5E5"> right nice okay cool</font><font color="#CCCCCC"> so</font>

803
00:41:29,950 --> 00:41:35,080
<font color="#CCCCCC">let's let's see what happens in the</font>

804
00:41:32,020 --> 00:41:37,990
debugger<font color="#CCCCCC"> just you know see exactly how</font>

805
00:41:35,080 --> 00:41:42,250
the chain is working so I'm going<font color="#CCCCCC"> to</font>

806
00:41:37,990 --> 00:41:45,040
fire I'm going to be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> you know</font>

807
00:41:42,250 --> 00:41:47,710
<font color="#E5E5E5">try to figure out how to use</font><font color="#CCCCCC"> gin now</font>

808
00:41:45,040 --> 00:41:49,660
that I do<font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> start this back</font>

809
00:41:47,710 --> 00:41:51,640
up<font color="#CCCCCC"> and I'm going to take the first</font>

810
00:41:49,660 --> 00:41:53,830
memory<font color="#E5E5E5"> address actually let's look at</font>

811
00:41:51,640 --> 00:41:58,509
this real<font color="#CCCCCC"> quick</font><font color="#E5E5E5"> the first memory address</font>

812
00:41:53,830 --> 00:42:00,040
is of the chain is I know<font color="#E5E5E5"> you guys can</font>

813
00:41:58,510 --> 00:42:02,830
read it back there can somebody read it

814
00:42:00,040 --> 00:42:05,770
it's<font color="#E5E5E5"> six yeah whatever I don't care</font>

815
00:42:02,830 --> 00:42:08,440
I'm just getting copy it whatever<font color="#CCCCCC"> and</font>

816
00:42:05,770 --> 00:42:11,790
I'm going to set a<font color="#CCCCCC"> breakpoint in the</font>

817
00:42:08,440 --> 00:42:11,790
debugger<font color="#E5E5E5"> so</font>

818
00:42:17,990 --> 00:42:25,020
area so the first thing that happens<font color="#E5E5E5"> is</font>

819
00:42:22,010 --> 00:42:27,840
it<font color="#E5E5E5"> I want to pop</font><font color="#CCCCCC"> EAX</font>

820
00:42:25,020 --> 00:42:29,430
so that's the first gadget in the chain

821
00:42:27,840 --> 00:42:33,390
so I'm going<font color="#CCCCCC"> to set a breakpoint there</font>

822
00:42:29,430 --> 00:42:35,609
in<font color="#E5E5E5"> it the instruction just turned light</font>

823
00:42:33,390 --> 00:42:36,960
blue right so I know<font color="#CCCCCC"> that there</font><font color="#E5E5E5"> is a</font>

824
00:42:35,610 --> 00:42:38,490
<font color="#E5E5E5">breakpoint there and I'm going</font><font color="#CCCCCC"> to go</font>

825
00:42:36,960 --> 00:42:42,960
back<font color="#CCCCCC"> to my I'm going</font><font color="#E5E5E5"> to fire up the</font>

826
00:42:38,490 --> 00:42:45,379
application<font color="#E5E5E5"> again f9 and now I'm going</font>

827
00:42:42,960 --> 00:42:50,430
to send my<font color="#CCCCCC"> spoiied</font>

828
00:42:45,380 --> 00:42:52,140
so Rob<font color="#CCCCCC"> okay I</font><font color="#E5E5E5"> just sent my exploit okay</font>

829
00:42:50,430 --> 00:42:54,149
if I go back and<font color="#CCCCCC"> look at my debugger</font>

830
00:42:52,140 --> 00:42:57,089
<font color="#CCCCCC">sure now it's down in the bottom I know</font>

831
00:42:54,150 --> 00:42:59,400
you can see it it<font color="#CCCCCC"> says break a hit a</font>

832
00:42:57,090 --> 00:43:01,560
breakpoint<font color="#E5E5E5"> it's the number of</font><font color="#CCCCCC"> the</font>

833
00:42:59,400 --> 00:43:05,100
<font color="#CCCCCC">address that I said so it's that poppy</font>

834
00:43:01,560 --> 00:43:08,970
<font color="#CCCCCC">ax</font><font color="#E5E5E5"> so if we look at the stack over on</font>

835
00:43:05,100 --> 00:43:10,230
the left<font color="#E5E5E5"> hand side we see</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know</font>

836
00:43:08,970 --> 00:43:13,200
<font color="#E5E5E5">if you can see it I'll make this a</font>

837
00:43:10,230 --> 00:43:15,930
little bit bigger<font color="#CCCCCC"> that there's the</font>

838
00:43:13,200 --> 00:43:17,250
pointer to virtual protect<font color="#E5E5E5"> on the top of</font>

839
00:43:15,930 --> 00:43:19,049
the stack<font color="#CCCCCC"> I put that there</font>

840
00:43:17,250 --> 00:43:21,090
<font color="#CCCCCC">oh wait I didn't look</font><font color="#E5E5E5"> right there Mona</font>

841
00:43:19,050 --> 00:43:23,850
put that there right<font color="#CCCCCC"> I didn't put it</font>

842
00:43:21,090 --> 00:43:26,160
<font color="#E5E5E5">that third I put it in my script so now</font>

843
00:43:23,850 --> 00:43:28,830
if<font color="#E5E5E5"> you look if you compare the stack</font>

844
00:43:26,160 --> 00:43:30,569
<font color="#E5E5E5">from that point down all the values</font>

845
00:43:28,830 --> 00:43:33,359
there on the stack are the stacks

846
00:43:30,570 --> 00:43:34,859
<font color="#CCCCCC">they're in my chain right now we're</font>

847
00:43:33,359 --> 00:43:42,210
<font color="#E5E5E5">going to start</font><font color="#CCCCCC"> executing these at</font>

848
00:43:34,859 --> 00:43:44,369
gadgets<font color="#E5E5E5"> based on my chain do we know how</font>

849
00:43:42,210 --> 00:43:48,590
we got<font color="#CCCCCC"> here anybody</font><font color="#E5E5E5"> know just just so</font>

850
00:43:44,369 --> 00:43:48,590
that we cover that<font color="#E5E5E5"> yeah go ahead</font>

851
00:43:59,050 --> 00:44:02,050
<font color="#CCCCCC">yep</font>

852
00:44:08,500 --> 00:44:13,569
other stuff<font color="#E5E5E5"> yeah yeah perfect</font><font color="#CCCCCC"> yeah</font>

853
00:44:12,000 --> 00:44:16,510
exactly

854
00:44:13,569 --> 00:44:18,670
the other thing to know is I<font color="#E5E5E5"> over wrote</font>

855
00:44:16,510 --> 00:44:20,680
<font color="#E5E5E5">so I have a function</font><font color="#CCCCCC"> that has</font><font color="#E5E5E5"> I've on a</font>

856
00:44:18,670 --> 00:44:24,160
Rodian<font color="#CCCCCC"> right this one has a stack of</font>

857
00:44:20,680 --> 00:44:26,680
buffer overflow vulnerability in it some

858
00:44:24,160 --> 00:44:28,868
string copy doesn't<font color="#CCCCCC"> have bounds on it</font>

859
00:44:26,680 --> 00:44:32,710
right and I can overflow<font color="#E5E5E5"> the buffer</font><font color="#CCCCCC"> I</font>

860
00:44:28,869 --> 00:44:35,650
over every every function when it's<font color="#CCCCCC"> done</font>

861
00:44:32,710 --> 00:44:37,180
it returns back<font color="#E5E5E5"> like we said to specific</font>

862
00:44:35,650 --> 00:44:39,339
<font color="#CCCCCC">you know that to the calling function</font>

863
00:44:37,180 --> 00:44:43,118
<font color="#E5E5E5">right it needs to know how to get back</font>

864
00:44:39,339 --> 00:44:45,839
<font color="#CCCCCC">there that rat i</font><font color="#E5E5E5"> over row you know that</font>

865
00:44:43,119 --> 00:44:50,140
i overwrote the<font color="#CCCCCC"> say</font><font color="#E5E5E5"> VIP and that rat is</font>

866
00:44:45,839 --> 00:44:53,619
<font color="#E5E5E5">executing my my first gadget that's how</font>

867
00:44:50,140 --> 00:44:56,770
I<font color="#E5E5E5"> got here just so that I'm clear about</font>

868
00:44:53,619 --> 00:45:00,250
<font color="#E5E5E5">that so now</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> about to execute my</font>

869
00:44:56,770 --> 00:45:02,980
first gadget<font color="#CCCCCC"> so I need to take the</font>

870
00:45:00,250 --> 00:45:05,170
memory address<font color="#E5E5E5"> of the pointer to virtual</font>

871
00:45:02,980 --> 00:45:08,349
would protect and put it in EAX so if I

872
00:45:05,170 --> 00:45:11,410
step through look at<font color="#CCCCCC"> EAX it just changed</font>

873
00:45:08,349 --> 00:45:15,369
<font color="#E5E5E5">it's now got the pro tool of protect</font>

874
00:45:11,410 --> 00:45:17,379
address in<font color="#E5E5E5"> EAX right the next</font><font color="#CCCCCC"> thing that</font>

875
00:45:15,369 --> 00:45:19,960
<font color="#CCCCCC">Moana is</font><font color="#E5E5E5"> going to do is it's going to</font><font color="#CCCCCC"> do</font>

876
00:45:17,380 --> 00:45:22,000
some trickery<font color="#E5E5E5"> to switch it so that it's</font>

877
00:45:19,960 --> 00:45:24,250
not<font color="#E5E5E5"> the pointer anymore but it's the</font>

878
00:45:22,000 --> 00:45:26,290
<font color="#CCCCCC">actual memory</font><font color="#E5E5E5"> address of virtual protect</font>

879
00:45:24,250 --> 00:45:27,780
in the kernel<font color="#E5E5E5"> okay so we're going to</font>

880
00:45:26,290 --> 00:45:31,329
<font color="#E5E5E5">just step</font><font color="#CCCCCC"> through that quick oh I just</font>

881
00:45:27,780 --> 00:45:34,750
executed the<font color="#E5E5E5"> return if you noticed at</font>

882
00:45:31,329 --> 00:45:36,700
the<font color="#E5E5E5"> top of the stack the memory address</font>

883
00:45:34,750 --> 00:45:38,890
for the pointer<font color="#CCCCCC"> of virtual protect is</font>

884
00:45:36,700 --> 00:45:45,578
gone because<font color="#E5E5E5"> it's been popped off right</font>

885
00:45:38,890 --> 00:45:48,250
and we've gone<font color="#E5E5E5"> in return to a different</font>

886
00:45:45,579 --> 00:45:50,530
gadget so now we have a move a gadget

887
00:45:48,250 --> 00:45:52,690
that<font color="#E5E5E5"> has a move instruction in it and</font>

888
00:45:50,530 --> 00:45:55,089
this<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> trickery that's going on by</font>

889
00:45:52,690 --> 00:45:57,670
now in a place<font color="#E5E5E5"> where</font><font color="#CCCCCC"> there's a new</font>

890
00:45:55,089 --> 00:46:00,040
gadget being executed<font color="#CCCCCC"> so</font><font color="#E5E5E5"> I execute the</font>

891
00:45:57,670 --> 00:46:02,560
first instruction which is<font color="#E5E5E5"> the move and</font>

892
00:46:00,040 --> 00:46:05,079
then here I'm at the<font color="#E5E5E5"> return it's going</font>

893
00:46:02,560 --> 00:46:08,529
to pop that memory address I have on the

894
00:46:05,079 --> 00:46:10,150
stack next off and jump to it so it's

895
00:46:08,530 --> 00:46:12,640
some other gadget<font color="#CCCCCC"> that we're going</font><font color="#E5E5E5"> to</font>

896
00:46:10,150 --> 00:46:13,470
jump to<font color="#E5E5E5"> alright so now we have a pop up</font>

897
00:46:12,640 --> 00:46:17,078
<font color="#E5E5E5">Brett</font>

898
00:46:13,470 --> 00:46:20,560
right<font color="#CCCCCC"> she wants to pop the</font><font color="#E5E5E5"> next values</font>

899
00:46:17,079 --> 00:46:21,710
off the stack and<font color="#CCCCCC"> put them in</font><font color="#E5E5E5"> the</font>

900
00:46:20,560 --> 00:46:24,680
<font color="#E5E5E5">different registers</font>

901
00:46:21,710 --> 00:46:27,380
sometimes you<font color="#E5E5E5"> have to deal with gadgets</font>

902
00:46:24,680 --> 00:46:30,440
<font color="#CCCCCC">they have junk</font><font color="#E5E5E5"> instructions in it so</font>

903
00:46:27,380 --> 00:46:34,040
more than<font color="#E5E5E5"> likely she needs to push</font><font color="#CCCCCC"> yeah</font>

904
00:46:30,440 --> 00:46:37,130
<font color="#E5E5E5">do the push this might be a bad</font><font color="#CCCCCC"> example</font>

905
00:46:34,040 --> 00:46:39,200
but she needs to let's get back to<font color="#E5E5E5"> that</font>

906
00:46:37,130 --> 00:46:40,820
<font color="#E5E5E5">because this is</font><font color="#CCCCCC"> actually good</font><font color="#E5E5E5"> these are</font>

907
00:46:39,200 --> 00:46:43,580
all good instructions what she's doing

908
00:46:40,820 --> 00:46:46,430
here<font color="#CCCCCC"> is she's</font><font color="#E5E5E5"> going to push</font><font color="#CCCCCC"> EAX</font><font color="#E5E5E5"> onto the</font>

909
00:46:43,580 --> 00:46:48,740
stack which is<font color="#E5E5E5"> that pointer and then</font>

910
00:46:46,430 --> 00:46:50,180
she's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> pop it into ESI because</font>

911
00:46:48,740 --> 00:46:52,759
that's where<font color="#CCCCCC"> she really needs it right</font>

912
00:46:50,180 --> 00:46:59,270
<font color="#CCCCCC">so when</font><font color="#E5E5E5"> we push it onto the stack it's</font>

913
00:46:52,760 --> 00:47:01,850
going to push my chain down<font color="#E5E5E5"> right so now</font>

914
00:46:59,270 --> 00:47:03,680
that<font color="#CCCCCC"> value is now back onto</font><font color="#E5E5E5"> the stack</font>

915
00:47:01,850 --> 00:47:08,920
and<font color="#E5E5E5"> then what she's going to do is pop</font>

916
00:47:03,680 --> 00:47:12,410
it into ESI right it didn't affect my

917
00:47:08,920 --> 00:47:14,750
chain at all<font color="#CCCCCC"> in my class I tried</font><font color="#E5E5E5"> to do</font>

918
00:47:12,410 --> 00:47:16,490
<font color="#E5E5E5">this example right and I think</font><font color="#CCCCCC"> I might</font>

919
00:47:14,750 --> 00:47:20,840
<font color="#CCCCCC">throw my back out</font><font color="#E5E5E5"> if I try to do it here</font>

920
00:47:16,490 --> 00:47:25,399
<font color="#E5E5E5">but I like said pretend that you are you</font>

921
00:47:20,840 --> 00:47:29,360
have<font color="#E5E5E5"> painted lines on the road right and</font>

922
00:47:25,400 --> 00:47:33,890
those<font color="#E5E5E5"> are your your if that's your chain</font>

923
00:47:29,360 --> 00:47:37,130
<font color="#E5E5E5">right</font><font color="#CCCCCC"> and every time</font><font color="#E5E5E5"> you want to</font><font color="#CCCCCC"> execute</font>

924
00:47:33,890 --> 00:47:39,080
a new<font color="#E5E5E5"> gadget you just freshly</font><font color="#CCCCCC"> painted</font>

925
00:47:37,130 --> 00:47:41,330
right<font color="#E5E5E5"> so every time you jump on a new</font>

926
00:47:39,080 --> 00:47:45,670
line you're going<font color="#CCCCCC"> to get like footprints</font>

927
00:47:41,330 --> 00:47:48,590
in your new line right<font color="#E5E5E5"> and pretend that</font>

928
00:47:45,670 --> 00:47:50,780
every time you execute a<font color="#E5E5E5"> new gadget</font><font color="#CCCCCC"> you</font>

929
00:47:48,590 --> 00:47:55,640
kind<font color="#E5E5E5"> of jump this way I'm going to go</font>

930
00:47:50,780 --> 00:47:59,270
right<font color="#CCCCCC"> through this stage and put your</font>

931
00:47:55,640 --> 00:48:01,490
foot on the next line<font color="#E5E5E5"> right but then if</font>

932
00:47:59,270 --> 00:48:03,770
you need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> move things around with</font><font color="#E5E5E5"> push</font>

933
00:48:01,490 --> 00:48:06,830
pops<font color="#CCCCCC"> it's kind of like jumping backwards</font>

934
00:48:03,770 --> 00:48:09,170
right you're not<font color="#CCCCCC"> every time</font><font color="#E5E5E5"> that you</font>

935
00:48:06,830 --> 00:48:11,900
jump on a new line<font color="#CCCCCC"> you're kind of</font>

936
00:48:09,170 --> 00:48:13,820
utilizing<font color="#E5E5E5"> the next gadget in the chain</font>

937
00:48:11,900 --> 00:48:15,350
<font color="#E5E5E5">but if you're doing something</font><font color="#CCCCCC"> like this</font>

938
00:48:13,820 --> 00:48:16,850
where you're<font color="#CCCCCC"> pushing and</font><font color="#E5E5E5"> popping you're</font>

939
00:48:15,350 --> 00:48:18,560
kind of<font color="#E5E5E5"> jumping backwards onto lines</font>

940
00:48:16,850 --> 00:48:20,029
that you've already jumped on and I

941
00:48:18,560 --> 00:48:21,529
would<font color="#E5E5E5"> love to do</font><font color="#CCCCCC"> that right now</font><font color="#E5E5E5"> but I'm</font>

942
00:48:20,030 --> 00:48:24,200
really<font color="#CCCCCC"> scared that goes right through</font>

943
00:48:21,530 --> 00:48:26,810
the<font color="#E5E5E5"> floor here and then whenever you're</font>

944
00:48:24,200 --> 00:48:29,149
ready to start<font color="#E5E5E5"> X you know executing new</font>

945
00:48:26,810 --> 00:48:32,360
gadgets<font color="#E5E5E5"> you have to make sure</font><font color="#CCCCCC"> that on</font>

946
00:48:29,150 --> 00:48:33,560
the<font color="#E5E5E5"> stack you're back to the next gadget</font>

947
00:48:32,360 --> 00:48:36,010
<font color="#E5E5E5">that you want to execute</font>

948
00:48:33,560 --> 00:48:39,320
a stack<font color="#E5E5E5"> right so if you do a couple pops</font>

949
00:48:36,010 --> 00:48:40,820
<font color="#E5E5E5">or I mean a couple pushes right you're</font>

950
00:48:39,320 --> 00:48:42,680
pushing data<font color="#E5E5E5"> onto the stack like this</font>

951
00:48:40,820 --> 00:48:45,010
<font color="#E5E5E5">one is doing one you have to have the</font>

952
00:48:42,680 --> 00:48:47,990
same<font color="#E5E5E5"> number of pops to get back to where</font>

953
00:48:45,010 --> 00:48:48,710
<font color="#E5E5E5">you were</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> to the next gadget</font><font color="#CCCCCC"> does</font>

954
00:48:47,990 --> 00:48:50,569
that make sense

955
00:48:48,710 --> 00:48:53,720
I would<font color="#E5E5E5"> love</font><font color="#CCCCCC"> to jump back</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> forth but</font>

956
00:48:50,570 --> 00:48:57,920
I<font color="#CCCCCC"> oh yeah I can jump down there after</font>

957
00:48:53,720 --> 00:48:59,419
after okay<font color="#E5E5E5"> so then we have a bunch of</font>

958
00:48:57,920 --> 00:49:03,320
other things<font color="#E5E5E5"> that she's doing this</font>

959
00:48:59,420 --> 00:49:06,230
<font color="#CCCCCC">trickery</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be able to you</font><font color="#E5E5E5"> know figure</font>

960
00:49:03,320 --> 00:49:08,810
out you know where virtual protect is

961
00:49:06,230 --> 00:49:12,050
and I<font color="#E5E5E5"> just went to pass the gadget but</font>

962
00:49:08,810 --> 00:49:15,890
if you look in EAX right now the<font color="#E5E5E5"> value</font>

963
00:49:12,050 --> 00:49:17,780
has<font color="#E5E5E5"> changed for virtual product to the</font>

964
00:49:15,890 --> 00:49:21,920
kernel<font color="#E5E5E5"> all right she did her trickery</font>

965
00:49:17,780 --> 00:49:24,950
now she's<font color="#E5E5E5"> in the the mode of trying to</font>

966
00:49:21,920 --> 00:49:27,680
set a<font color="#CCCCCC"> specific number probably</font><font color="#E5E5E5"> you know</font>

967
00:49:24,950 --> 00:49:30,350
the permissions<font color="#E5E5E5"> is I think it</font><font color="#CCCCCC"> x40 was</font>

968
00:49:27,680 --> 00:49:34,129
permissions<font color="#E5E5E5"> right she's going</font><font color="#CCCCCC"> to go I</font>

969
00:49:30,350 --> 00:49:35,120
think<font color="#CCCCCC"> that</font><font color="#E5E5E5"> she</font><font color="#CCCCCC"> just pushed a value</font><font color="#E5E5E5"> into</font>

970
00:49:34,130 --> 00:49:39,560
<font color="#CCCCCC">EBX</font>

971
00:49:35,120 --> 00:49:42,109
what is a<font color="#E5E5E5"> ffffff DFS right and now we're</font>

972
00:49:39,560 --> 00:49:44,420
going to negate<font color="#CCCCCC"> that kind</font><font color="#E5E5E5"> of like what I</font>

973
00:49:42,110 --> 00:49:48,050
did<font color="#E5E5E5"> before I</font><font color="#CCCCCC"> had at negative 1 which is</font>

974
00:49:44,420 --> 00:49:50,060
<font color="#E5E5E5">FF FF FF FF and then I</font><font color="#CCCCCC"> added to it right</font>

975
00:49:48,050 --> 00:49:52,460
to get a<font color="#E5E5E5"> number that had nose in it</font>

976
00:49:50,060 --> 00:49:55,430
she's doing the<font color="#CCCCCC"> same type</font><font color="#E5E5E5"> of thing but</font>

977
00:49:52,460 --> 00:49:58,640
she hasn't nagged instruction to be able

978
00:49:55,430 --> 00:50:01,009
<font color="#E5E5E5">to just do two's complement to that</font>

979
00:49:58,640 --> 00:50:04,430
<font color="#E5E5E5">value to get the positive number without</font>

980
00:50:01,010 --> 00:50:06,950
<font color="#E5E5E5">putting hex 0 0 into the</font><font color="#CCCCCC"> floyd make</font>

981
00:50:04,430 --> 00:50:10,339
sense<font color="#E5E5E5"> and if you look at EDX right now</font>

982
00:50:06,950 --> 00:50:13,279
and then execute that instruction<font color="#E5E5E5"> we now</font>

983
00:50:10,340 --> 00:50:15,920
have 201 so 201 is the size of<font color="#E5E5E5"> our</font>

984
00:50:13,280 --> 00:50:21,350
shellcode<font color="#E5E5E5"> must</font><font color="#CCCCCC"> be right</font><font color="#E5E5E5"> it's hex tool</font>

985
00:50:15,920 --> 00:50:23,570
<font color="#CCCCCC">whatnot</font><font color="#E5E5E5"> 201 just be aware that</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so now</font>

986
00:50:21,350 --> 00:50:25,040
if I just<font color="#E5E5E5"> keep on stepping through you</font>

987
00:50:23,570 --> 00:50:29,800
can see that she's putting different

988
00:50:25,040 --> 00:50:32,810
<font color="#E5E5E5">things into each register right and</font>

989
00:50:29,800 --> 00:50:35,510
here's our push ID so now if we<font color="#CCCCCC"> look at</font>

990
00:50:32,810 --> 00:50:38,090
<font color="#E5E5E5">the registers and</font><font color="#CCCCCC"> we go back</font><font color="#E5E5E5"> to that</font>

991
00:50:35,510 --> 00:50:43,960
slide that<font color="#CCCCCC"> I had before right they</font>

992
00:50:38,090 --> 00:50:45,770
should line up we have in<font color="#E5E5E5"> EDX hex</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> 0</font>

993
00:50:43,960 --> 00:50:50,390
<font color="#E5E5E5">right we have</font>

994
00:50:45,770 --> 00:50:55,190
have in<font color="#CCCCCC"> EBX</font><font color="#E5E5E5"> hex 201 before</font><font color="#CCCCCC"> zero is the</font>

995
00:50:50,390 --> 00:50:58,069
permissions the 201 is the size of<font color="#E5E5E5"> the</font>

996
00:50:55,190 --> 00:51:01,790
page<font color="#E5E5E5"> that's going</font><font color="#CCCCCC"> to be you know changed</font>

997
00:50:58,070 --> 00:51:04,400
<font color="#CCCCCC">make sense she's doing</font><font color="#E5E5E5"> that using</font>

998
00:51:01,790 --> 00:51:08,230
<font color="#CCCCCC">gadgets she has not executed anything</font>

999
00:51:04,400 --> 00:51:10,850
off the stack yet<font color="#E5E5E5"> now we're about to</font>

1000
00:51:08,230 --> 00:51:11,960
<font color="#E5E5E5">execute virtual protect so the next</font>

1001
00:51:10,850 --> 00:51:14,299
<font color="#E5E5E5">thing that we're going to do is we're</font>

1002
00:51:11,960 --> 00:51:16,190
<font color="#CCCCCC">going to use</font><font color="#E5E5E5"> push ad push all those</font>

1003
00:51:14,300 --> 00:51:19,340
values<font color="#CCCCCC"> onto the stack let's do that now</font>

1004
00:51:16,190 --> 00:51:22,400
<font color="#CCCCCC">now if you look at</font><font color="#E5E5E5"> the stack down in the</font>

1005
00:51:19,340 --> 00:51:27,910
lower<font color="#E5E5E5"> right hand</font><font color="#CCCCCC"> corner you can</font><font color="#E5E5E5"> kind of</font>

1006
00:51:22,400 --> 00:51:31,670
see in through here right there's our

1007
00:51:27,910 --> 00:51:35,770
virtual protect this is the memory

1008
00:51:31,670 --> 00:51:35,770
address<font color="#E5E5E5"> that we wanted to jump back to</font>

1009
00:51:35,860 --> 00:51:43,010
here's our value<font color="#E5E5E5"> of the size of the area</font>

1010
00:51:40,730 --> 00:51:44,810
<font color="#E5E5E5">that</font><font color="#CCCCCC"> we're going to</font><font color="#E5E5E5"> change and this is</font>

1011
00:51:43,010 --> 00:51:47,570
<font color="#CCCCCC">the</font><font color="#E5E5E5"> permission</font><font color="#CCCCCC"> right here</font><font color="#E5E5E5"> make sense</font>

1012
00:51:44,810 --> 00:51:51,020
<font color="#E5E5E5">that's pretty cool right yeah</font>

1013
00:51:47,570 --> 00:51:53,210
thanks Mona<font color="#CCCCCC"> I mean you can build these</font>

1014
00:51:51,020 --> 00:51:56,900
change yourself<font color="#E5E5E5"> and it's great exercise</font>

1015
00:51:53,210 --> 00:52:00,470
<font color="#CCCCCC">by you you like the rubik's cube</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

1016
00:51:56,900 --> 00:52:03,560
<font color="#CCCCCC">just like the rubik's cube right or</font>

1017
00:52:00,470 --> 00:52:05,930
maybe worse or<font color="#CCCCCC"> i</font><font color="#E5E5E5"> don't know</font><font color="#CCCCCC"> i I'm</font>

1018
00:52:03,560 --> 00:52:08,660
horrible at the<font color="#CCCCCC"> rubik's cube when my son</font>

1019
00:52:05,930 --> 00:52:11,930
can do it in a minute<font color="#CCCCCC"> and I'm like what</font>

1020
00:52:08,660 --> 00:52:14,359
<font color="#E5E5E5">just happened he's like I did it and I'm</font>

1021
00:52:11,930 --> 00:52:16,700
like yeah<font color="#CCCCCC"> but how</font><font color="#E5E5E5"> like I</font><font color="#CCCCCC"> don't even</font><font color="#E5E5E5"> know</font>

1022
00:52:14,360 --> 00:52:20,210
how you<font color="#E5E5E5"> can look at it fat and like know</font>

1023
00:52:16,700 --> 00:52:21,200
what's going on<font color="#E5E5E5"> I don't know so maybe</font>

1024
00:52:20,210 --> 00:52:24,470
it's a little<font color="#E5E5E5"> bit harder</font><font color="#CCCCCC"> than</font><font color="#E5E5E5"> the</font>

1025
00:52:21,200 --> 00:52:28,100
<font color="#CCCCCC">rubik's</font><font color="#E5E5E5"> cube for some people okay so</font>

1026
00:52:24,470 --> 00:52:33,020
<font color="#E5E5E5">then what I need to do now is I am</font><font color="#CCCCCC"> going</font>

1027
00:52:28,100 --> 00:52:35,120
to<font color="#CCCCCC"> Mona's</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to set it</font><font color="#E5E5E5"> up now</font><font color="#CCCCCC"> so now</font>

1028
00:52:33,020 --> 00:52:36,980
we are ready<font color="#E5E5E5"> to call virtual production</font>

1029
00:52:35,120 --> 00:52:38,870
<font color="#CCCCCC">you can kind of see it on the stack</font>

1030
00:52:36,980 --> 00:52:40,940
immunity<font color="#E5E5E5"> is kind of trying</font><font color="#CCCCCC"> to figure</font><font color="#E5E5E5"> out</font>

1031
00:52:38,870 --> 00:52:43,670
<font color="#CCCCCC">oh we have a function that's</font><font color="#E5E5E5"> about to be</font>

1032
00:52:40,940 --> 00:52:45,680
called<font color="#E5E5E5"> right and you can see how it says</font>

1033
00:52:43,670 --> 00:52:48,230
called a virtual protect and then the

1034
00:52:45,680 --> 00:52:51,230
address equals it knows immunity knows

1035
00:52:48,230 --> 00:52:53,300
what the virtual protect parameters are

1036
00:52:51,230 --> 00:52:55,580
and she's like helping me out she's<font color="#CCCCCC"> like</font>

1037
00:52:53,300 --> 00:52:56,960
oh yeah look at<font color="#E5E5E5"> this your immunity</font><font color="#CCCCCC"> is</font>

1038
00:52:55,580 --> 00:52:58,220
<font color="#E5E5E5">like yeah you're going to call virtual</font>

1039
00:52:56,960 --> 00:52:58,760
protect and these are all the<font color="#E5E5E5"> parameters</font>

1040
00:52:58,220 --> 00:53:01,220
<font color="#E5E5E5">for</font>

1041
00:52:58,760 --> 00:53:03,020
that good job<font color="#E5E5E5"> and I can look and I'm</font>

1042
00:53:01,220 --> 00:53:06,770
like<font color="#CCCCCC"> oh yeah look</font><font color="#E5E5E5"> at that the address</font>

1043
00:53:03,020 --> 00:53:09,890
and the size the new protection<font color="#CCCCCC"> yeah</font>

1044
00:53:06,770 --> 00:53:11,830
like you eat right yeah that's cool in

1045
00:53:09,890 --> 00:53:16,160
the old protect which I don't<font color="#E5E5E5"> understand</font>

1046
00:53:11,830 --> 00:53:20,150
<font color="#E5E5E5">right next thing</font><font color="#CCCCCC"> I do</font><font color="#E5E5E5"> is I'm going to</font>

1047
00:53:16,160 --> 00:53:21,740
call it there's<font color="#E5E5E5"> a there's a bunch of</font>

1048
00:53:20,150 --> 00:53:23,900
little<font color="#E5E5E5"> things that</font><font color="#CCCCCC"> happens I'm kind of</font>

1049
00:53:21,740 --> 00:53:26,450
stepping through like virtual Pracht and

1050
00:53:23,900 --> 00:53:28,280
some other things<font color="#E5E5E5"> right but let's get</font><font color="#CCCCCC"> to</font>

1051
00:53:26,450 --> 00:53:31,779
<font color="#E5E5E5">the point</font><font color="#CCCCCC"> where oh here's there's the</font>

1052
00:53:28,280 --> 00:53:35,030
actual called virtual<font color="#CCCCCC"> tracked</font><font color="#E5E5E5"> right and</font>

1053
00:53:31,780 --> 00:53:38,060
now whenever we return<font color="#E5E5E5"> we have a jump</font>

1054
00:53:35,030 --> 00:53:42,710
<font color="#CCCCCC">PSP this is this</font><font color="#E5E5E5"> is a memory address</font>

1055
00:53:38,060 --> 00:53:44,870
that<font color="#E5E5E5"> Mona found and she put</font><font color="#CCCCCC"> onto into</font>

1056
00:53:42,710 --> 00:53:46,520
<font color="#CCCCCC">her chain and we're back to</font><font color="#E5E5E5"> the</font>

1057
00:53:44,870 --> 00:53:48,380
beginning<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> back where we started</font>

1058
00:53:46,520 --> 00:53:51,290
right before<font color="#CCCCCC"> we started talking about</font>

1059
00:53:48,380 --> 00:53:53,540
<font color="#E5E5E5">Rob we're ready to jump to ESD</font><font color="#CCCCCC"> and</font>

1060
00:53:51,290 --> 00:53:56,180
execute code the<font color="#CCCCCC"> shell code if you look</font>

1061
00:53:53,540 --> 00:54:00,529
on the stack<font color="#CCCCCC"> there's a bunch of hex</font><font color="#E5E5E5"> 90s</font>

1062
00:53:56,180 --> 00:54:02,720
right hex<font color="#E5E5E5"> 90 is that no up so you have</font><font color="#CCCCCC"> a</font>

1063
00:54:00,530 --> 00:54:06,410
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit of</font><font color="#CCCCCC"> a no ops lot sled there</font>

1064
00:54:02,720 --> 00:54:09,020
slide whatever<font color="#E5E5E5"> right and we're going to</font>

1065
00:54:06,410 --> 00:54:11,120
see remember what happened here when we

1066
00:54:09,020 --> 00:54:12,860
had depth turned down at this<font color="#E5E5E5"> point we</font>

1067
00:54:11,120 --> 00:54:14,450
couldn't we got an access<font color="#CCCCCC"> violation</font>

1068
00:54:12,860 --> 00:54:20,450
right<font color="#E5E5E5"> let's see what happens</font>

1069
00:54:14,450 --> 00:54:23,480
oh no ops on the in the staff<font color="#CCCCCC"> I mean</font>

1070
00:54:20,450 --> 00:54:25,549
executions<font color="#CCCCCC"> through right let's see if we</font>

1071
00:54:23,480 --> 00:54:29,030
get the<font color="#E5E5E5"> access violation</font><font color="#CCCCCC"> nope</font>

1072
00:54:25,550 --> 00:54:31,190
I'm executing<font color="#CCCCCC"> no ops right now</font><font color="#E5E5E5"> oh yeah</font>

1073
00:54:29,030 --> 00:54:34,160
that's excellent<font color="#E5E5E5"> right</font><font color="#CCCCCC"> I'm getting</font>

1074
00:54:31,190 --> 00:54:37,520
<font color="#E5E5E5">really</font><font color="#CCCCCC"> excited now</font><font color="#E5E5E5"> look really really oh</font>

1075
00:54:34,160 --> 00:54:40,730
there's my shell cut oh<font color="#CCCCCC"> okay</font>

1076
00:54:37,520 --> 00:54:44,480
do you see what happened we just<font color="#CCCCCC"> turned</font>

1077
00:54:40,730 --> 00:54:49,310
off<font color="#E5E5E5"> that that mitigation is no longer in</font>

1078
00:54:44,480 --> 00:54:52,700
play<font color="#CCCCCC"> right so let's see this in reality</font>

1079
00:54:49,310 --> 00:54:55,910
<font color="#CCCCCC">like</font><font color="#E5E5E5"> let's see if it really works</font><font color="#CCCCCC"> this</font>

1080
00:54:52,700 --> 00:55:00,529
<font color="#E5E5E5">is where I should have like prayed to</font>

1081
00:54:55,910 --> 00:55:01,970
the demo gods right and said<font color="#CCCCCC"> please work</font>

1082
00:55:00,530 --> 00:55:05,240
just do it<font color="#E5E5E5"> please</font>

1083
00:55:01,970 --> 00:55:08,000
and I'm<font color="#E5E5E5"> guessing that when I am about</font><font color="#CCCCCC"> to</font>

1084
00:55:05,240 --> 00:55:09,229
<font color="#CCCCCC">do this</font><font color="#E5E5E5"> Microsoft is going to give me</font>

1085
00:55:08,000 --> 00:55:13,369
the<font color="#E5E5E5"> finger and</font>

1086
00:55:09,230 --> 00:55:14,990
say<font color="#E5E5E5"> and like reboot windows on me or</font>

1087
00:55:13,369 --> 00:55:16,340
something<font color="#CCCCCC"> like that I don't know but</font>

1088
00:55:14,990 --> 00:55:23,209
let's see let's see<font color="#E5E5E5"> if it works</font>

1089
00:55:16,340 --> 00:55:27,140
oh and let's make<font color="#CCCCCC"> sure I wasn't</font><font color="#E5E5E5"> messing</font>

1090
00:55:23,210 --> 00:55:29,300
with you and had virtual yep<font color="#E5E5E5"> I have it I</font>

1091
00:55:27,140 --> 00:55:31,730
have it<font color="#E5E5E5"> turned off good or I mean turned</font>

1092
00:55:29,300 --> 00:55:34,160
on so<font color="#CCCCCC"> Debbie's turned</font><font color="#E5E5E5"> out good</font><font color="#CCCCCC"> I just</font>

1093
00:55:31,730 --> 00:55:38,180
want to make<font color="#E5E5E5"> sure okay</font><font color="#CCCCCC"> so now I'm</font><font color="#E5E5E5"> going</font>

1094
00:55:34,160 --> 00:55:41,420
<font color="#E5E5E5">to execute this</font><font color="#CCCCCC"> drop right</font>

1095
00:55:38,180 --> 00:55:44,299
did anything happen<font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> if I</font>

1096
00:55:41,420 --> 00:55:46,220
look at the running process<font color="#E5E5E5"> it's still</font>

1097
00:55:44,300 --> 00:55:48,290
running<font color="#CCCCCC"> so I didn't crash you remember</font>

1098
00:55:46,220 --> 00:55:50,689
before when<font color="#E5E5E5"> I</font><font color="#CCCCCC"> did this it crashed the</font>

1099
00:55:48,290 --> 00:55:54,050
process<font color="#E5E5E5"> the only thing I did</font><font color="#CCCCCC"> was then</font>

1100
00:55:50,690 --> 00:55:57,380
<font color="#E5E5E5">turn step on a crash my process but now</font>

1101
00:55:54,050 --> 00:55:59,030
he didn't<font color="#E5E5E5"> so let's go</font><font color="#CCCCCC"> back and just</font>

1102
00:55:57,380 --> 00:56:03,760
double<font color="#E5E5E5"> check and</font><font color="#CCCCCC"> see what's going</font><font color="#E5E5E5"> on</font>

1103
00:55:59,030 --> 00:56:08,440
<font color="#E5E5E5">here I have</font><font color="#CCCCCC"> my neck neck</font><font color="#E5E5E5"> cat</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> poor 404</font>

1104
00:56:03,760 --> 00:56:14,180
connect to it boom here's her felt<font color="#E5E5E5"> okay</font>

1105
00:56:08,440 --> 00:56:17,060
thank you<font color="#CCCCCC"> very much so I'll go back to</font>

1106
00:56:14,180 --> 00:56:22,450
my slides<font color="#CCCCCC"> and go away to the end any</font>

1107
00:56:17,060 --> 00:56:22,450
questions yeah yeah go ahead

1108
00:56:26,630 --> 00:56:33,529
no no<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> turn</font><font color="#E5E5E5"> deaf right now on my</font>

1109
00:56:31,670 --> 00:56:36,650
machine<font color="#CCCCCC"> jet designed for all running</font>

1110
00:56:33,529 --> 00:56:38,989
<font color="#CCCCCC">processes</font><font color="#E5E5E5"> so it that will not there's</font>

1111
00:56:36,650 --> 00:56:42,650
nothing else<font color="#E5E5E5"> I mean oh if you turn it</font>

1112
00:56:38,989 --> 00:56:47,049
off yeah so I think<font color="#E5E5E5"> that's that's a good</font>

1113
00:56:42,650 --> 00:56:51,170
<font color="#E5E5E5">question if you turned up off yeah yeah</font>

1114
00:56:47,049 --> 00:56:55,160
<font color="#CCCCCC">Rolly yeah I'd love</font><font color="#E5E5E5"> it right right I</font>

1115
00:56:51,170 --> 00:56:57,789
wouldn't<font color="#E5E5E5"> have my show anymore but if you</font>

1116
00:56:55,160 --> 00:57:00,529
have<font color="#CCCCCC"> depth turned off</font><font color="#E5E5E5"> I've had certain</font>

1117
00:56:57,789 --> 00:57:02,989
situations where this<font color="#E5E5E5"> bullet won't work</font>

1118
00:57:00,529 --> 00:57:04,910
because virtual protects is like<font color="#E5E5E5"> I think</font>

1119
00:57:02,989 --> 00:57:07,130
<font color="#CCCCCC">it might throw</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> error and say I can't</font>

1120
00:57:04,910 --> 00:57:08,749
do this<font color="#E5E5E5"> because it's already executable</font>

1121
00:57:07,130 --> 00:57:10,640
right<font color="#E5E5E5"> or something like</font><font color="#CCCCCC"> that so</font>

1122
00:57:08,749 --> 00:57:13,279
<font color="#E5E5E5">sometimes your target might be</font>

1123
00:57:10,640 --> 00:57:15,739
<font color="#CCCCCC">vulnerable anyway and then when you go</font>

1124
00:57:13,279 --> 00:57:18,049
to<font color="#CCCCCC"> the user op it might not work</font><font color="#E5E5E5"> because</font>

1125
00:57:15,739 --> 00:57:20,900
you're trying<font color="#E5E5E5"> to do you</font><font color="#CCCCCC"> know turn</font>

1126
00:57:18,049 --> 00:57:23,749
something off that's<font color="#CCCCCC"> already off so it's</font>

1127
00:57:20,900 --> 00:57:25,729
yeah maybe you<font color="#E5E5E5"> have to play around with</font>

1128
00:57:23,749 --> 00:57:29,089
it<font color="#E5E5E5"> but then you can just go back to</font><font color="#CCCCCC"> my</font>

1129
00:57:25,729 --> 00:57:39,339
first script right and just execute<font color="#CCCCCC"> that</font>

1130
00:57:29,089 --> 00:57:39,339
done<font color="#CCCCCC"> dang any other questions</font>

1131
00:57:42,240 --> 00:57:49,689
yeah yeah I guess<font color="#CCCCCC"> she does a good</font>

1132
00:57:46,210 --> 00:57:52,390
<font color="#E5E5E5">question</font><font color="#CCCCCC"> I like</font><font color="#E5E5E5"> that nice so that's</font><font color="#CCCCCC"> my</font>

1133
00:57:49,690 --> 00:57:56,070
talk<font color="#CCCCCC"> hope you liked it hope</font><font color="#E5E5E5"> they woke</font>

1134
00:57:52,390 --> 00:57:56,069
you up<font color="#E5E5E5"> thank you</font>

