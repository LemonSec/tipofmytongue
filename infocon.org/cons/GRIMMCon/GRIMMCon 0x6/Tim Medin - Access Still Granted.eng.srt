1
00:00:00,000 --> 00:00:03,129
[Music]

2
00:00:05,620 --> 00:00:09,599
[Music]

3
00:00:12,980 --> 00:00:17,279
[Music]

4
00:00:17,279 --> 00:00:19,199
hi i'm tim medine

5
00:00:19,199 --> 00:00:20,800
we're going to be talking today a little

6
00:00:20,800 --> 00:00:22,160
bit about

7
00:00:22,160 --> 00:00:25,039
using the access we have to have a high

8
00:00:25,039 --> 00:00:27,920
value test right to demonstrate the risk

9
00:00:27,920 --> 00:00:30,560
inside a particular organization uh my

10
00:00:30,560 --> 00:00:34,559
name is tim medine i am in uh the ceo

11
00:00:34,559 --> 00:00:37,280
and founder of red siege we do

12
00:00:37,280 --> 00:00:39,360
offensive things we do pen testing red

13
00:00:39,360 --> 00:00:42,320
teaming uh frankly all kinds of a pen

14
00:00:42,320 --> 00:00:44,960
testing i'm a senior instructor with the

15
00:00:44,960 --> 00:00:47,920
sands institute and i am the author of

16
00:00:47,920 --> 00:00:50,719
the sand the pen test course at sands

17
00:00:50,719 --> 00:00:54,640
560. sec 560 you may have heard of that

18
00:00:54,640 --> 00:00:57,120
formerly known as network penetration

19
00:00:57,120 --> 00:00:58,480
testing and ethical hacking we are

20
00:00:58,480 --> 00:01:00,960
actually going to rename it rebrand it i

21
00:01:00,960 --> 00:01:02,079
think i'm getting a little bit ahead of

22
00:01:02,079 --> 00:01:04,319
myself here don't tell sans it's okay

23
00:01:04,319 --> 00:01:06,080
i'm also ian's faculty and i've been

24
00:01:06,080 --> 00:01:08,400
doing this kind of stuff for a long time

25
00:01:08,400 --> 00:01:10,479
so we'll try to bring in some real world

26
00:01:10,479 --> 00:01:13,040
examples in fact we will discuss some

27
00:01:13,040 --> 00:01:16,000
real world examples here uh in our pen

28
00:01:16,000 --> 00:01:17,200
test

29
00:01:17,200 --> 00:01:20,080
remember here the bad guys they have

30
00:01:20,080 --> 00:01:21,439
goals

31
00:01:21,439 --> 00:01:23,680
right the bad guys

32
00:01:23,680 --> 00:01:26,799
are trying to get into your network

33
00:01:26,799 --> 00:01:30,159
and take an action that's engineers for

34
00:01:30,159 --> 00:01:31,360
them

35
00:01:31,360 --> 00:01:32,880
right it used to be that they would get

36
00:01:32,880 --> 00:01:34,720
into your network they would steal

37
00:01:34,720 --> 00:01:36,400
credit card information because that's

38
00:01:36,400 --> 00:01:39,680
relatively easy to turn into money for

39
00:01:39,680 --> 00:01:41,520
the bad guys

40
00:01:41,520 --> 00:01:42,960
there are some things that are a little

41
00:01:42,960 --> 00:01:45,680
bit harder to monetize

42
00:01:45,680 --> 00:01:48,320
right it's harder for a bad guy to take

43
00:01:48,320 --> 00:01:49,920
health information

44
00:01:49,920 --> 00:01:52,000
and monetize that now of course if

45
00:01:52,000 --> 00:01:53,759
you've been frankly paying attention at

46
00:01:53,759 --> 00:01:54,479
all

47
00:01:54,479 --> 00:01:55,600
we've seen

48
00:01:55,600 --> 00:01:57,119
ransomware

49
00:01:57,119 --> 00:01:58,960
this is a big game changer right and

50
00:01:58,960 --> 00:02:00,799
it's been around for you know quite some

51
00:02:00,799 --> 00:02:02,880
time now a number of years it's been

52
00:02:02,880 --> 00:02:03,840
getting

53
00:02:03,840 --> 00:02:05,600
bigger and bigger having greater and

54
00:02:05,600 --> 00:02:07,280
greater impact in our industry and

55
00:02:07,280 --> 00:02:09,119
frankly our lives

56
00:02:09,119 --> 00:02:10,959
but now

57
00:02:10,959 --> 00:02:13,520
any organization is now a valuable

58
00:02:13,520 --> 00:02:14,720
target

59
00:02:14,720 --> 00:02:16,640
because they can take the entire system

60
00:02:16,640 --> 00:02:18,959
offline those health records that a bad

61
00:02:18,959 --> 00:02:21,440
guy couldn't easily monetize

62
00:02:21,440 --> 00:02:23,040
now that bad guy

63
00:02:23,040 --> 00:02:24,319
can take that

64
00:02:24,319 --> 00:02:26,800
take the access away from in this case

65
00:02:26,800 --> 00:02:28,560
maybe a hospital

66
00:02:28,560 --> 00:02:30,080
make them pay

67
00:02:30,080 --> 00:02:32,879
right so the game very much has changed

68
00:02:32,879 --> 00:02:34,720
it's always important that we have to

69
00:02:34,720 --> 00:02:38,560
understand what do the bad folks want

70
00:02:38,560 --> 00:02:40,879
what are they trying to do what what

71
00:02:40,879 --> 00:02:44,160
goals are they trying to accomplish

72
00:02:44,160 --> 00:02:46,160
right could it be ransomware

73
00:02:46,160 --> 00:02:48,160
do they want to steal your intellectual

74
00:02:48,160 --> 00:02:50,640
property right do you have some kind of

75
00:02:50,640 --> 00:02:51,920
ip

76
00:02:51,920 --> 00:02:54,400
that i'm just gonna say you know the

77
00:02:54,400 --> 00:02:56,319
proverbial china

78
00:02:56,319 --> 00:02:58,560
wants to steal

79
00:02:58,560 --> 00:03:00,239
right we have to understand to some

80
00:03:00,239 --> 00:03:02,480
degree what other real threat actors

81
00:03:02,480 --> 00:03:04,879
what are they doing in the world right

82
00:03:04,879 --> 00:03:07,040
what are they trying to get from you

83
00:03:07,040 --> 00:03:09,360
what actions are they going to take on

84
00:03:09,360 --> 00:03:11,200
your network what are they trying to

85
00:03:11,200 --> 00:03:12,640
grab right if you've got credit card

86
00:03:12,640 --> 00:03:13,599
information that's pretty

87
00:03:13,599 --> 00:03:16,080
straightforward right as we discussed

88
00:03:16,080 --> 00:03:18,560
much easier to monetize

89
00:03:18,560 --> 00:03:21,120
than other sort of information maybe

90
00:03:21,120 --> 00:03:22,480
they want

91
00:03:22,480 --> 00:03:25,440
data about your users right it's under

92
00:03:25,440 --> 00:03:27,680
it's important to understand what is the

93
00:03:27,680 --> 00:03:30,560
risk to you and your organization right

94
00:03:30,560 --> 00:03:33,040
so we need to frame our pen test our red

95
00:03:33,040 --> 00:03:36,000
team whatever it might be in the context

96
00:03:36,000 --> 00:03:38,239
of the organization

97
00:03:38,239 --> 00:03:40,799
not just

98
00:03:41,120 --> 00:03:43,599
the data right not not just

99
00:03:43,599 --> 00:03:46,400
getting access to computers it's much

100
00:03:46,400 --> 00:03:47,760
bigger than that we have to understand

101
00:03:47,760 --> 00:03:49,440
the entire organization we need to

102
00:03:49,440 --> 00:03:52,159
understand what are those bad folks

103
00:03:52,159 --> 00:03:53,920
trying to do

104
00:03:53,920 --> 00:03:55,760
one of the things that we call

105
00:03:55,760 --> 00:03:57,360
a win

106
00:03:57,360 --> 00:03:58,560
in a test

107
00:03:58,560 --> 00:03:59,280
is

108
00:03:59,280 --> 00:04:01,680
getting domain admin

109
00:04:01,680 --> 00:04:03,519
that's cool that's a great that's

110
00:04:03,519 --> 00:04:05,760
interesting goal

111
00:04:05,760 --> 00:04:08,239
but it's still

112
00:04:08,239 --> 00:04:10,640
one step at least

113
00:04:10,640 --> 00:04:13,519
away from the important

114
00:04:13,519 --> 00:04:17,120
it is a tool it is not a destination yes

115
00:04:17,120 --> 00:04:19,519
it is great yes we still call it a win

116
00:04:19,519 --> 00:04:21,519
it feels good to get that level of

117
00:04:21,519 --> 00:04:25,280
access when i as a pen tester get in

118
00:04:25,280 --> 00:04:26,800
but sometimes

119
00:04:26,800 --> 00:04:29,600
we don't need that access in fact

120
00:04:29,600 --> 00:04:32,160
getting that access could be detrimental

121
00:04:32,160 --> 00:04:34,880
could work against our test and actually

122
00:04:34,880 --> 00:04:36,720
make it less

123
00:04:36,720 --> 00:04:37,759
valuable

124
00:04:37,759 --> 00:04:39,280
so we always need to think about that

125
00:04:39,280 --> 00:04:41,120
when we're performing our tests we need

126
00:04:41,120 --> 00:04:42,880
to understand

127
00:04:42,880 --> 00:04:44,560
what is the end goal

128
00:04:44,560 --> 00:04:46,560
right what is the goal of our test well

129
00:04:46,560 --> 00:04:49,040
the goal of our test is to

130
00:04:49,040 --> 00:04:53,120
model the real world attacker

131
00:04:53,120 --> 00:04:55,360
when the attacker gets in

132
00:04:55,360 --> 00:04:56,960
what are they going to do

133
00:04:56,960 --> 00:04:58,240
right what are they going to be going

134
00:04:58,240 --> 00:05:01,520
after it's not simply getting in

135
00:05:01,520 --> 00:05:03,840
once the bad guys get in they need to

136
00:05:03,840 --> 00:05:06,479
access data right expand their access

137
00:05:06,479 --> 00:05:08,160
lateral movement privilege escalation

138
00:05:08,160 --> 00:05:11,759
whatever it might be to steal sensitive

139
00:05:11,759 --> 00:05:14,400
information deploy malware

140
00:05:14,400 --> 00:05:16,000
maybe they're a hacktivist

141
00:05:16,000 --> 00:05:18,160
and they will take your systems offline

142
00:05:18,160 --> 00:05:19,520
right

143
00:05:19,520 --> 00:05:20,639
getting in

144
00:05:20,639 --> 00:05:23,280
is not simply enough

145
00:05:23,280 --> 00:05:25,520
now i've taken this quote here from uh

146
00:05:25,520 --> 00:05:27,520
from my 560 class city of you students

147
00:05:27,520 --> 00:05:29,600
who have taken that may recognize this

148
00:05:29,600 --> 00:05:30,800
piece

149
00:05:30,800 --> 00:05:33,039
what is pen testing well pen testing

150
00:05:33,039 --> 00:05:34,560
what we want to do is we want to

151
00:05:34,560 --> 00:05:36,720
identify the vulnerabilities right

152
00:05:36,720 --> 00:05:40,000
identify issues inside

153
00:05:40,000 --> 00:05:42,320
the target

154
00:05:42,320 --> 00:05:44,080
well that's great but that's just the

155
00:05:44,080 --> 00:05:46,720
beginning and we want to exploit those

156
00:05:46,720 --> 00:05:50,639
flaws right demonstrate the risk

157
00:05:50,639 --> 00:05:53,280
if we find a vulnerability what does it

158
00:05:53,280 --> 00:05:54,160
mean

159
00:05:54,160 --> 00:05:56,319
now quick aside here

160
00:05:56,319 --> 00:05:58,400
just because you can't take an advantage

161
00:05:58,400 --> 00:06:00,400
of a vulnerability doesn't mean it's

162
00:06:00,400 --> 00:06:02,479
actually not vulnerable

163
00:06:02,479 --> 00:06:03,680
right

164
00:06:03,680 --> 00:06:05,360
it could be that

165
00:06:05,360 --> 00:06:07,759
the payload we're using is caught by a

166
00:06:07,759 --> 00:06:10,639
defensive product or uh it's somehow

167
00:06:10,639 --> 00:06:14,000
getting is is a bad payload or the

168
00:06:14,000 --> 00:06:16,000
configuration is just a little off or if

169
00:06:16,000 --> 00:06:18,080
we encoded it a little bit differently

170
00:06:18,080 --> 00:06:19,600
it might work

171
00:06:19,600 --> 00:06:21,680
so we need to also need to understand

172
00:06:21,680 --> 00:06:22,880
some of that now

173
00:06:22,880 --> 00:06:25,440
the reverse right if i if i am able to

174
00:06:25,440 --> 00:06:27,360
take advantage of a vulnerability in a

175
00:06:27,360 --> 00:06:28,400
system

176
00:06:28,400 --> 00:06:30,960
and i can get you know our famous remote

177
00:06:30,960 --> 00:06:33,440
code execution or rce we have

178
00:06:33,440 --> 00:06:36,000
demonstrated the system is indeed

179
00:06:36,000 --> 00:06:38,639
vulnerable it's not really debatable

180
00:06:38,639 --> 00:06:39,680
even though sometimes you'll have

181
00:06:39,680 --> 00:06:42,080
targets they'll push back be like yeah

182
00:06:42,080 --> 00:06:44,400
we need to downgrade that issue

183
00:06:44,400 --> 00:06:47,360
i mean but it worked like no it didn't

184
00:06:47,360 --> 00:06:49,680
i mean i screenshots in the whole rest

185
00:06:49,680 --> 00:06:51,840
of the test keys on that whatever right

186
00:06:51,840 --> 00:06:54,639
so find the vulnerabilities exploit

187
00:06:54,639 --> 00:06:57,759
those now the difference between us

188
00:06:57,759 --> 00:06:59,599
and the real bad guys

189
00:06:59,599 --> 00:07:03,599
is what happens next right we have a

190
00:07:03,599 --> 00:07:05,599
scope and the rules of engagement that's

191
00:07:05,599 --> 00:07:07,199
good folks

192
00:07:07,199 --> 00:07:08,800
the bad guys

193
00:07:08,800 --> 00:07:10,479
not so much

194
00:07:10,479 --> 00:07:12,400
right i'm not going to just take piles

195
00:07:12,400 --> 00:07:15,440
and piles of data and take it back to my

196
00:07:15,440 --> 00:07:17,919
systems because i'm responsible for that

197
00:07:17,919 --> 00:07:19,919
i don't i don't want to be responsible

198
00:07:19,919 --> 00:07:20,880
for that

199
00:07:20,880 --> 00:07:23,039
i'm not going to deploy real world

200
00:07:23,039 --> 00:07:25,759
malware so we are to some degree

201
00:07:25,759 --> 00:07:27,039
handcuffed

202
00:07:27,039 --> 00:07:27,840
right

203
00:07:27,840 --> 00:07:32,080
us as the the ethical offensive people

204
00:07:32,080 --> 00:07:34,560
we need to follow the rules

205
00:07:34,560 --> 00:07:36,479
and you know people complain about the

206
00:07:36,479 --> 00:07:37,599
scope

207
00:07:37,599 --> 00:07:39,759
it's a fact of life the bad guys they

208
00:07:39,759 --> 00:07:42,160
don't have a scope true

209
00:07:42,160 --> 00:07:43,120
but

210
00:07:43,120 --> 00:07:45,680
i can't risk taking entire organization

211
00:07:45,680 --> 00:07:47,360
offline as part of a test i know this is

212
00:07:47,360 --> 00:07:50,319
a very long sort of discussion

213
00:07:50,319 --> 00:07:52,240
we can wrap this up as we have to follow

214
00:07:52,240 --> 00:07:54,639
the rules we have to follow the agreed

215
00:07:54,639 --> 00:07:57,360
upon rules related to the scope and some

216
00:07:57,360 --> 00:07:59,199
of the other rules as engagement

217
00:07:59,199 --> 00:08:00,800
ultimately we're going to get here to

218
00:08:00,800 --> 00:08:04,400
the important piece the final piece here

219
00:08:04,400 --> 00:08:08,000
our goal here is to understand

220
00:08:08,000 --> 00:08:10,080
help quantify

221
00:08:10,080 --> 00:08:12,960
help figure out what is the real

222
00:08:12,960 --> 00:08:16,400
risk to the organization

223
00:08:16,400 --> 00:08:19,039
right the risk here and identifying that

224
00:08:19,039 --> 00:08:22,479
presenting that helping the organization

225
00:08:22,479 --> 00:08:24,639
make better business decisions whether

226
00:08:24,639 --> 00:08:27,280
they should accept the risk mitigate

227
00:08:27,280 --> 00:08:29,280
patch remove the system whatever it

228
00:08:29,280 --> 00:08:30,720
might be

229
00:08:30,720 --> 00:08:34,000
our goal is to help them make better

230
00:08:34,000 --> 00:08:35,360
decisions

231
00:08:35,360 --> 00:08:36,958
now you'll notice here in this

232
00:08:36,958 --> 00:08:38,479
definition

233
00:08:38,479 --> 00:08:41,039
it doesn't say we need to get to domain

234
00:08:41,039 --> 00:08:42,719
admin

235
00:08:42,719 --> 00:08:45,279
we need to demonstrate the risk

236
00:08:45,279 --> 00:08:47,760
understand the risk

237
00:08:47,760 --> 00:08:48,640
right

238
00:08:48,640 --> 00:08:49,600
so

239
00:08:49,600 --> 00:08:51,920
it is important

240
00:08:51,920 --> 00:08:54,480
but it's not the be-all

241
00:08:54,480 --> 00:08:55,839
end-all

242
00:08:55,839 --> 00:08:58,800
right the domain admin access is very

243
00:08:58,800 --> 00:09:01,120
important now what if we can't get

244
00:09:01,120 --> 00:09:03,200
domain admin

245
00:09:03,200 --> 00:09:04,959
right what if we can't get that

246
00:09:04,959 --> 00:09:06,880
well

247
00:09:06,880 --> 00:09:08,880
do we even need it is a separate sort of

248
00:09:08,880 --> 00:09:11,839
discussion remember focus on the data

249
00:09:11,839 --> 00:09:14,399
let's say we've got a test and we we

250
00:09:14,399 --> 00:09:15,360
fish

251
00:09:15,360 --> 00:09:17,200
right let's let's actually let's let's

252
00:09:17,200 --> 00:09:19,839
pretend a real world actor

253
00:09:19,839 --> 00:09:23,200
has fished an engineer inside your

254
00:09:23,200 --> 00:09:24,880
organization let's say

255
00:09:24,880 --> 00:09:27,360
it's a manufacturing facility

256
00:09:27,360 --> 00:09:29,680
fish the engineer

257
00:09:29,680 --> 00:09:31,920
that engineer has access to

258
00:09:31,920 --> 00:09:35,279
probably a lot of drawings

259
00:09:35,279 --> 00:09:37,519
intellectual property

260
00:09:37,519 --> 00:09:39,760
the bad guy might not

261
00:09:39,760 --> 00:09:41,120
need to pivot

262
00:09:41,120 --> 00:09:45,279
to steal that intellectual property or

263
00:09:45,279 --> 00:09:47,279
encrypt it all

264
00:09:47,279 --> 00:09:48,800
right

265
00:09:48,800 --> 00:09:52,160
so and more importantly here if we were

266
00:09:52,160 --> 00:09:54,480
to land as as the pen tester as the

267
00:09:54,480 --> 00:09:56,800
offensive person and frankly in a way

268
00:09:56,800 --> 00:09:58,320
misguidedly

269
00:09:58,320 --> 00:10:00,880
try to chase domain admin

270
00:10:00,880 --> 00:10:02,079
we might

271
00:10:02,079 --> 00:10:04,880
be doing a disservice

272
00:10:04,880 --> 00:10:06,720
right because if i as the attacker can

273
00:10:06,720 --> 00:10:08,480
land on that system and immediately

274
00:10:08,480 --> 00:10:10,880
access the sensitive data

275
00:10:10,880 --> 00:10:13,680
why do we need to escalate

276
00:10:13,680 --> 00:10:16,000
why why does that matter

277
00:10:16,000 --> 00:10:16,959
right

278
00:10:16,959 --> 00:10:18,959
why do we care

279
00:10:18,959 --> 00:10:21,600
if we can to get this other access if we

280
00:10:21,600 --> 00:10:23,440
don't need it in fact

281
00:10:23,440 --> 00:10:26,000
it might hide

282
00:10:26,000 --> 00:10:28,880
how critical that initial access and

283
00:10:28,880 --> 00:10:31,680
maybe over permissions of file shares it

284
00:10:31,680 --> 00:10:34,720
might hide the criticality of something

285
00:10:34,720 --> 00:10:36,720
like that right let's say we've got

286
00:10:36,720 --> 00:10:39,120
steve or sally in marketing

287
00:10:39,120 --> 00:10:40,880
they too have access to those sensitive

288
00:10:40,880 --> 00:10:42,320
drawings

289
00:10:42,320 --> 00:10:44,079
right they have access to those

290
00:10:44,079 --> 00:10:45,600
sensitive drawings

291
00:10:45,600 --> 00:10:47,440
that can be a problem

292
00:10:47,440 --> 00:10:49,120
because now marketing why does marketing

293
00:10:49,120 --> 00:10:51,279
need access to these sensitive drawings

294
00:10:51,279 --> 00:10:53,519
any breach of those accounts

295
00:10:53,519 --> 00:10:55,440
would be of a significant impact and

296
00:10:55,440 --> 00:10:57,839
again if we landed on those computers

297
00:10:57,839 --> 00:11:00,480
moved to domain admin it might hide the

298
00:11:00,480 --> 00:11:03,360
fact that hey you've got very important

299
00:11:03,360 --> 00:11:06,399
data left all over the place

300
00:11:06,399 --> 00:11:09,920
right the analogy here to some degree

301
00:11:09,920 --> 00:11:11,519
would be

302
00:11:11,519 --> 00:11:13,440
thieves

303
00:11:13,440 --> 00:11:15,279
in to rob a bank all they care about is

304
00:11:15,279 --> 00:11:16,800
the money they don't care how they get

305
00:11:16,800 --> 00:11:17,519
it

306
00:11:17,519 --> 00:11:19,680
get the money right if the vault is wide

307
00:11:19,680 --> 00:11:20,560
open

308
00:11:20,560 --> 00:11:22,079
run into the vault

309
00:11:22,079 --> 00:11:23,760
put the money in your pants and shirts

310
00:11:23,760 --> 00:11:25,440
whatever and then run

311
00:11:25,440 --> 00:11:27,040
they don't need to figure out the

312
00:11:27,040 --> 00:11:29,200
combination and get the key to the vault

313
00:11:29,200 --> 00:11:31,279
or however the heck those things work

314
00:11:31,279 --> 00:11:34,720
right that's not the important piece

315
00:11:34,720 --> 00:11:36,720
so we got to think at it think of it

316
00:11:36,720 --> 00:11:38,000
that way

317
00:11:38,000 --> 00:11:40,079
so we need to use our access right use

318
00:11:40,079 --> 00:11:42,399
the access we have

319
00:11:42,399 --> 00:11:45,760
and use that to access that data so

320
00:11:45,760 --> 00:11:47,519
we're going to target maybe specific

321
00:11:47,519 --> 00:11:50,079
users but always keep our

322
00:11:50,079 --> 00:11:50,800
our

323
00:11:50,800 --> 00:11:52,639
mind on the prize

324
00:11:52,639 --> 00:11:55,120
of that data or process that's important

325
00:11:55,120 --> 00:11:58,000
to the organization now you know

326
00:11:58,000 --> 00:11:59,839
fun things we always see right password

327
00:11:59,839 --> 00:12:01,920
passwords are terrible passwords from a

328
00:12:01,920 --> 00:12:04,800
pen tester red teamers perspective

329
00:12:04,800 --> 00:12:07,760
still the gift that keeps on giving

330
00:12:07,760 --> 00:12:09,680
right we've got so many organizations

331
00:12:09,680 --> 00:12:11,519
where

332
00:12:11,519 --> 00:12:13,600
users inside the organization use their

333
00:12:13,600 --> 00:12:16,720
passwords internally they use that same

334
00:12:16,720 --> 00:12:19,040
password at some other site that other

335
00:12:19,040 --> 00:12:22,079
site let's say is compromised the bad

336
00:12:22,079 --> 00:12:24,160
folks dump those passwords we crack

337
00:12:24,160 --> 00:12:26,560
those then use those to log in

338
00:12:26,560 --> 00:12:28,800
to the initial organization because the

339
00:12:28,800 --> 00:12:30,720
user reused passwords remember password

340
00:12:30,720 --> 00:12:32,560
reuse is terrible you probably all heard

341
00:12:32,560 --> 00:12:34,000
this before just want to go over it real

342
00:12:34,000 --> 00:12:36,720
quick lots of different resources here

343
00:12:36,720 --> 00:12:39,680
for this dehash is relatively cheap that

344
00:12:39,680 --> 00:12:41,279
can be great resource plenty of other

345
00:12:41,279 --> 00:12:43,440
source resources out there

346
00:12:43,440 --> 00:12:44,560
to

347
00:12:44,560 --> 00:12:45,600
find

348
00:12:45,600 --> 00:12:47,600
these breached credentials we might be

349
00:12:47,600 --> 00:12:49,519
able to use those in our tests related

350
00:12:49,519 --> 00:12:50,880
to that

351
00:12:50,880 --> 00:12:52,560
we can try those passwords that have

352
00:12:52,560 --> 00:12:54,480
been breached

353
00:12:54,480 --> 00:12:56,240
we can um

354
00:12:56,240 --> 00:12:58,959
try common bad passwords

355
00:12:58,959 --> 00:13:01,519
right the gift that keeps on

356
00:13:01,519 --> 00:13:03,680
giving

357
00:13:03,680 --> 00:13:06,959
season and year the reason is we sort of

358
00:13:06,959 --> 00:13:10,800
uh have this idea in security in i.t or

359
00:13:10,800 --> 00:13:12,480
in

360
00:13:12,480 --> 00:13:13,360
um

361
00:13:13,360 --> 00:13:15,120
i don't know i guess the world that

362
00:13:15,120 --> 00:13:16,720
passwords should be rotated every 90

363
00:13:16,720 --> 00:13:19,360
days because somebody came up with that

364
00:13:19,360 --> 00:13:22,800
idea in the 80s and we're stuck with it

365
00:13:22,800 --> 00:13:24,399
right and users have figured out like

366
00:13:24,399 --> 00:13:25,600
you know what i can just look out the

367
00:13:25,600 --> 00:13:27,440
window here

368
00:13:27,440 --> 00:13:29,440
and i can figure out my password and i

369
00:13:29,440 --> 00:13:31,279
don't have to call those annoying it

370
00:13:31,279 --> 00:13:32,720
help desk people to figure out my

371
00:13:32,720 --> 00:13:34,399
password

372
00:13:34,399 --> 00:13:37,040
those types of passwords or you know

373
00:13:37,040 --> 00:13:38,880
season and year so right now we've got

374
00:13:38,880 --> 00:13:41,760
winter 2021

375
00:13:41,760 --> 00:13:43,279
or if you're really secure an

376
00:13:43,279 --> 00:13:45,680
exclamation point to the end

377
00:13:45,680 --> 00:13:47,199
right realistically

378
00:13:47,199 --> 00:13:49,440
a little tip for the defenders ban the

379
00:13:49,440 --> 00:13:51,839
word winter fall autumn spring and

380
00:13:51,839 --> 00:13:54,079
summer in your passwords

381
00:13:54,079 --> 00:13:56,880
some of the stuff kind of uh disappears

382
00:13:56,880 --> 00:13:58,880
great tools for things like this invoke

383
00:13:58,880 --> 00:14:01,279
domain password spray by bo bullock from

384
00:14:01,279 --> 00:14:03,440
black hills uh this will actually

385
00:14:03,440 --> 00:14:05,519
extract the

386
00:14:05,519 --> 00:14:07,279
fine grain password policy from your

387
00:14:07,279 --> 00:14:09,600
organization we can give it our list the

388
00:14:09,600 --> 00:14:11,920
goal here is to prevent any sort of uh

389
00:14:11,920 --> 00:14:13,040
lockout

390
00:14:13,040 --> 00:14:13,839
right

391
00:14:13,839 --> 00:14:16,480
defensive detection here look on some of

392
00:14:16,480 --> 00:14:19,360
the uh the uh the logon failures the

393
00:14:19,360 --> 00:14:21,440
hard part here is

394
00:14:21,440 --> 00:14:22,800
realistically your organization is

395
00:14:22,800 --> 00:14:25,440
defended if you get a log in failure

396
00:14:25,440 --> 00:14:28,000
the piece that's interesting is a lot of

397
00:14:28,000 --> 00:14:31,600
login failures followed by a success

398
00:14:31,600 --> 00:14:33,199
that's the uh the interesting thing

399
00:14:33,199 --> 00:14:34,880
right here uh interesting conversation

400
00:14:34,880 --> 00:14:38,079
here i had with my friend derek banks

401
00:14:38,079 --> 00:14:40,000
a little bit of an old screenshot still

402
00:14:40,000 --> 00:14:42,000
love this we were working together on a

403
00:14:42,000 --> 00:14:43,040
test

404
00:14:43,040 --> 00:14:46,160
and uh the defender was really good like

405
00:14:46,160 --> 00:14:47,839
really really good

406
00:14:47,839 --> 00:14:49,360
and um

407
00:14:49,360 --> 00:14:50,959
literally like the next week it's like

408
00:14:50,959 --> 00:14:53,600
hey i found a password of uh season and

409
00:14:53,600 --> 00:14:56,160
year single factor on the vpn and got in

410
00:14:56,160 --> 00:14:57,519
kerber roasted

411
00:14:57,519 --> 00:14:59,519
off to uh to the races

412
00:14:59,519 --> 00:15:01,920
so does this stuff work yeah

413
00:15:01,920 --> 00:15:03,199
it still

414
00:15:03,199 --> 00:15:04,160
works

415
00:15:04,160 --> 00:15:06,560
right this still absolutely works sorry

416
00:15:06,560 --> 00:15:08,160
i had the the screen there a little bit

417
00:15:08,160 --> 00:15:10,639
backwards you forgot about that

418
00:15:10,639 --> 00:15:12,160
still absolutely works yes this

419
00:15:12,160 --> 00:15:14,000
screenshot's a little bit old the key

420
00:15:14,000 --> 00:15:17,519
here is remember i don't need

421
00:15:17,519 --> 00:15:21,040
all the passwords i just need one right

422
00:15:21,040 --> 00:15:23,120
i just need one let's talk through a

423
00:15:23,120 --> 00:15:25,760
couple of uh various case studies here

424
00:15:25,760 --> 00:15:28,000
these are from real world tests no i'm

425
00:15:28,000 --> 00:15:29,199
not going to tell you the real

426
00:15:29,199 --> 00:15:30,880
organization

427
00:15:30,880 --> 00:15:32,639
we'll kind of keep it we've only got so

428
00:15:32,639 --> 00:15:34,480
much time here

429
00:15:34,480 --> 00:15:36,240
we'll kind of keep it high level just

430
00:15:36,240 --> 00:15:38,639
talk you through common ways that we've

431
00:15:38,639 --> 00:15:39,920
seen

432
00:15:39,920 --> 00:15:41,759
tests go

433
00:15:41,759 --> 00:15:44,000
where

434
00:15:44,240 --> 00:15:46,880
we had a high impact and didn't

435
00:15:46,880 --> 00:15:49,279
need a domain admin level access so

436
00:15:49,279 --> 00:15:50,800
here's an example here at an

437
00:15:50,800 --> 00:15:52,399
organization

438
00:15:52,399 --> 00:15:55,759
this was a financial institution

439
00:15:55,759 --> 00:15:58,240
um so spray right the password spray we

440
00:15:58,240 --> 00:16:01,440
tried some common bad passwords found a

441
00:16:01,440 --> 00:16:03,279
user

442
00:16:03,279 --> 00:16:06,240
with a a bad password

443
00:16:06,240 --> 00:16:07,120
um

444
00:16:07,120 --> 00:16:10,880
use that to log in to the vpn

445
00:16:10,880 --> 00:16:13,600
no did not have 2fa

446
00:16:13,600 --> 00:16:14,880
these days you should definitely have

447
00:16:14,880 --> 00:16:18,560
2fa especially with the the big move to

448
00:16:18,560 --> 00:16:20,800
work from home

449
00:16:20,800 --> 00:16:23,120
at that point

450
00:16:23,120 --> 00:16:24,880
once we were in

451
00:16:24,880 --> 00:16:27,199
we jumped to sharepoint now sharepoint

452
00:16:27,199 --> 00:16:28,160
is just

453
00:16:28,160 --> 00:16:30,720
a web version of a file share that's

454
00:16:30,720 --> 00:16:32,959
frankly a little bit harder to audit

455
00:16:32,959 --> 00:16:34,000
right

456
00:16:34,000 --> 00:16:36,560
we've got sharepoint everywhere

457
00:16:36,560 --> 00:16:38,959
no escalation necessary right we had

458
00:16:38,959 --> 00:16:41,360
access as that user with the bad

459
00:16:41,360 --> 00:16:44,160
password logged in with the vpn

460
00:16:44,160 --> 00:16:47,040
immediately found pii

461
00:16:47,040 --> 00:16:50,880
on the sharepoint server that was it

462
00:16:50,880 --> 00:16:53,519
no escalation needed the the interesting

463
00:16:53,519 --> 00:16:55,519
thing here if we go back to business

464
00:16:55,519 --> 00:16:56,959
risk

465
00:16:56,959 --> 00:16:58,480
this is simple

466
00:16:58,480 --> 00:17:00,240
this is dead simple right it's a

467
00:17:00,240 --> 00:17:02,000
password to

468
00:17:02,000 --> 00:17:05,119
all the sensitive data is gone

469
00:17:05,119 --> 00:17:07,119
right if we had tried to and i'm not

470
00:17:07,119 --> 00:17:08,880
saying don't try it but i'm saying if we

471
00:17:08,880 --> 00:17:11,439
had tried to get domain admin which i

472
00:17:11,439 --> 00:17:13,520
remember correctly on this one we did

473
00:17:13,520 --> 00:17:15,039
um

474
00:17:15,039 --> 00:17:17,439
it could have sort of hidden that the

475
00:17:17,439 --> 00:17:19,919
risk is really really big here

476
00:17:19,919 --> 00:17:21,839
right random user access to all this

477
00:17:21,839 --> 00:17:23,919
data the permissions were incorrect on

478
00:17:23,919 --> 00:17:25,119
sharepoint

479
00:17:25,119 --> 00:17:27,359
and it was just gone

480
00:17:27,359 --> 00:17:30,640
right it demonstrates the tremendous

481
00:17:30,640 --> 00:17:33,039
impact from a breach should just this

482
00:17:33,039 --> 00:17:36,960
lowly user be impacted

483
00:17:36,960 --> 00:17:39,280
kerber roasting one of my favorites so

484
00:17:39,280 --> 00:17:41,520
if we can get the

485
00:17:41,520 --> 00:17:43,039
if we can get

486
00:17:43,039 --> 00:17:45,280
access we just need access as a single

487
00:17:45,280 --> 00:17:47,840
user frankly any user not a privileged

488
00:17:47,840 --> 00:17:49,600
user

489
00:17:49,600 --> 00:17:53,280
what we can do here is we can request

490
00:17:53,280 --> 00:17:54,320
tickets

491
00:17:54,320 --> 00:17:57,440
so we can request tickets here

492
00:17:57,440 --> 00:18:00,080
pull those back to our system and we can

493
00:18:00,080 --> 00:18:03,280
do offline cracking

494
00:18:03,280 --> 00:18:04,960
the interesting thing here is because

495
00:18:04,960 --> 00:18:07,200
they're service accounts the passwords

496
00:18:07,200 --> 00:18:10,320
are probably not ever going to change

497
00:18:10,320 --> 00:18:12,240
right or if they do it's probably very

498
00:18:12,240 --> 00:18:13,280
rare

499
00:18:13,280 --> 00:18:15,520
they may have been um

500
00:18:15,520 --> 00:18:17,600
the accounts passwords may not have been

501
00:18:17,600 --> 00:18:20,880
changed in a very long time

502
00:18:20,880 --> 00:18:23,200
so we might not be compliant with modern

503
00:18:23,200 --> 00:18:24,640
password policies and the reason why

504
00:18:24,640 --> 00:18:27,679
this works is the tickets are

505
00:18:27,679 --> 00:18:29,360
encrypted

506
00:18:29,360 --> 00:18:32,880
using the password hash of the target

507
00:18:32,880 --> 00:18:34,559
service

508
00:18:34,559 --> 00:18:36,160
lots of great tools out there there's

509
00:18:36,160 --> 00:18:39,200
powershell scripts

510
00:18:39,200 --> 00:18:41,120
you know built into all sorts of c2

511
00:18:41,120 --> 00:18:43,200
frameworks here i've got an example with

512
00:18:43,200 --> 00:18:45,200
from from empire where we're grabbing

513
00:18:45,200 --> 00:18:48,559
the invoke kerberos

514
00:18:48,559 --> 00:18:51,039
grab that pull the tickets back throw it

515
00:18:51,039 --> 00:18:53,280
into hash cat let it run and again

516
00:18:53,280 --> 00:18:54,960
because these service accounts don't

517
00:18:54,960 --> 00:18:57,679
typically follow that same sort of

518
00:18:57,679 --> 00:18:59,600
normal 90-day

519
00:18:59,600 --> 00:19:00,960
rotation

520
00:19:00,960 --> 00:19:02,559
by the way the whole separate discussion

521
00:19:02,559 --> 00:19:05,120
which is the 90-day rotation is bad for

522
00:19:05,120 --> 00:19:07,039
users because users pick

523
00:19:07,039 --> 00:19:10,720
worse passwords anyway

524
00:19:10,720 --> 00:19:13,039
but this gives us a long time to crack

525
00:19:13,039 --> 00:19:14,960
these passwords

526
00:19:14,960 --> 00:19:17,360
case study two

527
00:19:17,360 --> 00:19:21,440
so we had a a laptop so we were um on

528
00:19:21,440 --> 00:19:23,760
the internal network just to begin this

529
00:19:23,760 --> 00:19:25,600
test

530
00:19:25,600 --> 00:19:28,240
we were on on the network to begin this

531
00:19:28,240 --> 00:19:31,280
test guessed a password

532
00:19:31,280 --> 00:19:32,720
did the

533
00:19:32,720 --> 00:19:35,360
kerberos style attack right we've got

534
00:19:35,360 --> 00:19:37,679
access to the computer access as that

535
00:19:37,679 --> 00:19:38,799
user

536
00:19:38,799 --> 00:19:41,360
we grab a number of tickets

537
00:19:41,360 --> 00:19:43,360
one of the things that we commonly see

538
00:19:43,360 --> 00:19:46,080
in organizations is sql servers are tied

539
00:19:46,080 --> 00:19:48,400
to kerberos now the the issue isn't

540
00:19:48,400 --> 00:19:50,480
kerberos per se

541
00:19:50,480 --> 00:19:53,120
it's the passwords people select the

542
00:19:53,120 --> 00:19:55,840
admins in this case selected for this

543
00:19:55,840 --> 00:19:57,520
service account

544
00:19:57,520 --> 00:19:59,440
crack this password we've got access to

545
00:19:59,440 --> 00:20:00,799
the database

546
00:20:00,799 --> 00:20:02,640
you'll notice here

547
00:20:02,640 --> 00:20:04,320
short steps

548
00:20:04,320 --> 00:20:08,400
access to the laptop laptop to sql two

549
00:20:08,400 --> 00:20:10,880
simple steps

550
00:20:10,880 --> 00:20:13,760
and we didn't have to get domain admin

551
00:20:13,760 --> 00:20:15,440
here right we're demonstrating that the

552
00:20:15,440 --> 00:20:17,120
risk

553
00:20:17,120 --> 00:20:19,919
it's there in fact it's a significant

554
00:20:19,919 --> 00:20:22,799
risk because the number of steps here

555
00:20:22,799 --> 00:20:24,799
right pretty small don't need to get

556
00:20:24,799 --> 00:20:26,480
access as a user and then move and

557
00:20:26,480 --> 00:20:28,480
lateral move and then escalate and then

558
00:20:28,480 --> 00:20:30,080
get access to the database it's

559
00:20:30,080 --> 00:20:33,440
essentially user straight to the

560
00:20:33,440 --> 00:20:35,120
database

561
00:20:35,120 --> 00:20:35,919
right

562
00:20:35,919 --> 00:20:39,360
remember what do the bad guys want what

563
00:20:39,360 --> 00:20:42,240
is the important thing for them

564
00:20:42,240 --> 00:20:45,360
they want the information that can make

565
00:20:45,360 --> 00:20:47,280
them money what does that mean

566
00:20:47,280 --> 00:20:49,600
right do you have credit cards take that

567
00:20:49,600 --> 00:20:54,000
easily monetize that uh is it ransomware

568
00:20:54,000 --> 00:20:56,720
right where they want the access

569
00:20:56,720 --> 00:20:58,240
that's a much bigger thing these days

570
00:20:58,240 --> 00:21:00,240
right we get a lot of client calls

571
00:21:00,240 --> 00:21:05,360
discussing uh ransomware and and such

572
00:21:05,360 --> 00:21:08,159
if it's just some of the data

573
00:21:08,159 --> 00:21:10,799
look around your network

574
00:21:10,799 --> 00:21:12,720
what we have seen

575
00:21:12,720 --> 00:21:14,480
almost and this isn't even really

576
00:21:14,480 --> 00:21:16,640
hyperbole i think my guys would back me

577
00:21:16,640 --> 00:21:20,000
up on this but 100 of organizations

578
00:21:20,000 --> 00:21:21,120
there's

579
00:21:21,120 --> 00:21:25,120
at least one file server file share

580
00:21:25,120 --> 00:21:27,280
sharepoint cms whatever you want to call

581
00:21:27,280 --> 00:21:29,679
it that has

582
00:21:29,679 --> 00:21:31,280
some of the sensitive data floating

583
00:21:31,280 --> 00:21:33,280
around

584
00:21:33,280 --> 00:21:35,840
right excessively shared we've got steve

585
00:21:35,840 --> 00:21:37,280
or sally in marketing that don't need

586
00:21:37,280 --> 00:21:39,840
access to that floating around we're in

587
00:21:39,840 --> 00:21:42,320
one organization

588
00:21:42,320 --> 00:21:44,720
very good defensively very very good

589
00:21:44,720 --> 00:21:46,240
spot on

590
00:21:46,240 --> 00:21:48,159
had a very tough time doing lateral

591
00:21:48,159 --> 00:21:49,200
movement

592
00:21:49,200 --> 00:21:51,679
um getting access to other accounts and

593
00:21:51,679 --> 00:21:53,360
it turned out

594
00:21:53,360 --> 00:21:54,240
that

595
00:21:54,240 --> 00:21:56,159
users were creating their own file

596
00:21:56,159 --> 00:21:58,480
shares on their own computers and using

597
00:21:58,480 --> 00:22:01,280
that to share information

598
00:22:01,280 --> 00:22:02,559
so all we had to do is look around and

599
00:22:02,559 --> 00:22:04,000
then just start grabbing some of this

600
00:22:04,000 --> 00:22:07,440
was it all of the sensitive data no

601
00:22:07,440 --> 00:22:09,280
but it was bank accounts and routing

602
00:22:09,280 --> 00:22:10,400
numbers

603
00:22:10,400 --> 00:22:11,840
for some uh

604
00:22:11,840 --> 00:22:14,080
very wealthy individuals

605
00:22:14,080 --> 00:22:17,039
i i don't need many of those

606
00:22:17,039 --> 00:22:18,960
to retire very comfortably frankly

607
00:22:18,960 --> 00:22:21,440
probably like one of those to retire

608
00:22:21,440 --> 00:22:22,880
very comfortably

609
00:22:22,880 --> 00:22:24,559
also think about it from the

610
00:22:24,559 --> 00:22:27,360
organization's perspective

611
00:22:27,360 --> 00:22:29,360
how many of those are yet to be lost

612
00:22:29,360 --> 00:22:30,480
before

613
00:22:30,480 --> 00:22:32,480
breach notification

614
00:22:32,480 --> 00:22:35,600
and what you don't want at a

615
00:22:35,600 --> 00:22:38,240
institution that is caters to the very

616
00:22:38,240 --> 00:22:39,280
wealthy

617
00:22:39,280 --> 00:22:41,280
is to be in the news because you lost

618
00:22:41,280 --> 00:22:42,480
data

619
00:22:42,480 --> 00:22:44,320
those wealthy people will split very

620
00:22:44,320 --> 00:22:46,960
quickly they have the resources to do so

621
00:22:46,960 --> 00:22:48,320
they've got the

622
00:22:48,320 --> 00:22:50,320
money that they very much want to

623
00:22:50,320 --> 00:22:51,760
protect

624
00:22:51,760 --> 00:22:55,600
have a significant significant impact

625
00:22:55,600 --> 00:22:58,400
right from the good guys perspective

626
00:22:58,400 --> 00:23:00,240
you know in that situation all they

627
00:23:00,240 --> 00:23:01,760
wanted to do all these users wanted to

628
00:23:01,760 --> 00:23:03,520
do was to quickly

629
00:23:03,520 --> 00:23:05,360
share the data

630
00:23:05,360 --> 00:23:08,200
and frankly what they did was

631
00:23:08,200 --> 00:23:10,799
ingenious in a way

632
00:23:10,799 --> 00:23:13,120
right there might be other restrictions

633
00:23:13,120 --> 00:23:15,600
on the network that prevented a more

634
00:23:15,600 --> 00:23:17,600
secure sharing and they're like you know

635
00:23:17,600 --> 00:23:18,960
what we'll just share it this other way

636
00:23:18,960 --> 00:23:21,120
because it's easier and faster

637
00:23:21,120 --> 00:23:23,280
of course we saw that that can create

638
00:23:23,280 --> 00:23:25,679
issues i'm not sorry i'm not saying that

639
00:23:25,679 --> 00:23:28,000
they should have done it i'm just saying

640
00:23:28,000 --> 00:23:29,760
users will do what they need to do to

641
00:23:29,760 --> 00:23:31,520
get their job done and security

642
00:23:31,520 --> 00:23:34,640
sometimes it seems as inefficiency or

643
00:23:34,640 --> 00:23:36,640
we'll do it like this this one time it's

644
00:23:36,640 --> 00:23:38,640
quick it's easy

645
00:23:38,640 --> 00:23:42,000
right and that's not necessarily always

646
00:23:42,000 --> 00:23:43,279
the case

647
00:23:43,279 --> 00:23:44,400
right where

648
00:23:44,400 --> 00:23:47,679
this can be a significant significant

649
00:23:47,679 --> 00:23:48,720
impact

650
00:23:48,720 --> 00:23:50,240
right especially when we get the overlap

651
00:23:50,240 --> 00:23:52,320
here on the good guy once and the bad

652
00:23:52,320 --> 00:23:54,559
guy wants and the the good the good guys

653
00:23:54,559 --> 00:23:57,360
are exposing too much data what are some

654
00:23:57,360 --> 00:24:00,480
ways to find some of this i love me some

655
00:24:00,480 --> 00:24:05,039
power view power of you fantastic tool

656
00:24:05,039 --> 00:24:07,919
we can use the find interesting domain

657
00:24:07,919 --> 00:24:10,159
share file

658
00:24:10,159 --> 00:24:12,400
what this does is it will enumerate the

659
00:24:12,400 --> 00:24:14,559
systems inside the network

660
00:24:14,559 --> 00:24:17,600
look for open file shares and then look

661
00:24:17,600 --> 00:24:20,000
at the names of those files

662
00:24:20,000 --> 00:24:22,080
for things containing words like

663
00:24:22,080 --> 00:24:25,279
passwords or admin or or login right

664
00:24:25,279 --> 00:24:26,559
interesting files now this is all

665
00:24:26,559 --> 00:24:28,960
customizable

666
00:24:28,960 --> 00:24:32,000
but this helps us more quickly identify

667
00:24:32,000 --> 00:24:33,520
some of that so in that organization i

668
00:24:33,520 --> 00:24:35,200
was talking about where they've got

669
00:24:35,200 --> 00:24:37,919
these big bank accounts

670
00:24:37,919 --> 00:24:39,760
right how do we find this literally

671
00:24:39,760 --> 00:24:41,679
quite literally with this tool we found

672
00:24:41,679 --> 00:24:44,240
these shares all over the place

673
00:24:44,240 --> 00:24:45,600
if you're a defender

674
00:24:45,600 --> 00:24:47,440
run this in your organization see what's

675
00:24:47,440 --> 00:24:48,400
out there

676
00:24:48,400 --> 00:24:51,120
lock the ones down that don't need to be

677
00:24:51,120 --> 00:24:52,720
there and the ones that do

678
00:24:52,720 --> 00:24:54,480
audit those permissions very carefully

679
00:24:54,480 --> 00:24:56,400
to make sure that

680
00:24:56,400 --> 00:24:58,080
steve and sally in marketing don't have

681
00:24:58,080 --> 00:25:00,000
access to credit card information they

682
00:25:00,000 --> 00:25:01,520
just don't need that

683
00:25:01,520 --> 00:25:02,400
right

684
00:25:02,400 --> 00:25:04,240
another great situation this was a mike

685
00:25:04,240 --> 00:25:08,159
saunders on my team he was doing a test

686
00:25:08,159 --> 00:25:08,880
these

687
00:25:08,880 --> 00:25:11,360
these folks are are pretty amazing

688
00:25:11,360 --> 00:25:12,640
um

689
00:25:12,640 --> 00:25:14,960
we have we we go back to them and they

690
00:25:14,960 --> 00:25:16,640
they get better and better and they were

691
00:25:16,640 --> 00:25:19,279
all ready they're probably if not the

692
00:25:19,279 --> 00:25:21,200
most difficult one we have

693
00:25:21,200 --> 00:25:22,320
um

694
00:25:22,320 --> 00:25:23,679
close to it

695
00:25:23,679 --> 00:25:26,880
meaning they got some foot fantastic

696
00:25:26,880 --> 00:25:28,559
security practices

697
00:25:28,559 --> 00:25:29,520
um

698
00:25:29,520 --> 00:25:30,320
what

699
00:25:30,320 --> 00:25:32,159
happened here is same thing i talked

700
00:25:32,159 --> 00:25:33,279
about before this is actually a

701
00:25:33,279 --> 00:25:34,880
different organization

702
00:25:34,880 --> 00:25:37,600
where there was um we had a tough time

703
00:25:37,600 --> 00:25:39,039
doing lateral movement privilege

704
00:25:39,039 --> 00:25:41,120
escalation it just just it just wasn't

705
00:25:41,120 --> 00:25:43,039
working for us

706
00:25:43,039 --> 00:25:46,720
um so we ended up finding very similarly

707
00:25:46,720 --> 00:25:48,159
sensitive data floating around in file

708
00:25:48,159 --> 00:25:50,960
shares no this is not real client data

709
00:25:50,960 --> 00:25:52,480
i'm not that dumb

710
00:25:52,480 --> 00:25:54,000
we took some random screenshot off the

711
00:25:54,000 --> 00:25:56,159
internet but it had like checking

712
00:25:56,159 --> 00:25:58,720
account information and checks

713
00:25:58,720 --> 00:26:00,640
that were floating around

714
00:26:00,640 --> 00:26:01,679
again

715
00:26:01,679 --> 00:26:04,240
overly exposed accessible by a wire

716
00:26:04,240 --> 00:26:07,600
large number of users

717
00:26:07,600 --> 00:26:09,279
and this this

718
00:26:09,279 --> 00:26:11,360
case i think it was uh these were linux

719
00:26:11,360 --> 00:26:13,440
systems

720
00:26:13,440 --> 00:26:17,120
we can use um you know power power power

721
00:26:17,120 --> 00:26:20,400
view is fine it works on windows systems

722
00:26:20,400 --> 00:26:21,360
um

723
00:26:21,360 --> 00:26:23,200
on linux we're going to get a little bit

724
00:26:23,200 --> 00:26:24,960
more creative use a little command line

725
00:26:24,960 --> 00:26:26,240
kung fu

726
00:26:26,240 --> 00:26:28,559
with like the find command so here's an

727
00:26:28,559 --> 00:26:30,480
example where we're looking for

728
00:26:30,480 --> 00:26:32,880
writable configuration files maybe we

729
00:26:32,880 --> 00:26:35,840
can change configurations so they run

730
00:26:35,840 --> 00:26:37,600
less securely

731
00:26:37,600 --> 00:26:39,520
or give us passwords whatever it might

732
00:26:39,520 --> 00:26:42,159
be we can find ways to it to escalate on

733
00:26:42,159 --> 00:26:44,960
some of these uh these systems

734
00:26:44,960 --> 00:26:47,200
all right another case study here case

735
00:26:47,200 --> 00:26:48,799
study four

736
00:26:48,799 --> 00:26:50,320
we were in an organization looking

737
00:26:50,320 --> 00:26:51,360
around

738
00:26:51,360 --> 00:26:53,760
using that a little bit of linux

739
00:26:53,760 --> 00:26:56,559
linux command line kung fu we found

740
00:26:56,559 --> 00:26:58,720
backups

741
00:26:58,720 --> 00:27:01,279
so backups for

742
00:27:01,279 --> 00:27:03,120
users

743
00:27:03,120 --> 00:27:04,640
all over the network in fact they're

744
00:27:04,640 --> 00:27:07,440
servers and stuff from all over the

745
00:27:07,440 --> 00:27:09,039
network

746
00:27:09,039 --> 00:27:10,960
inside those backups that were

747
00:27:10,960 --> 00:27:13,679
overexposed you see this here the read

748
00:27:13,679 --> 00:27:16,320
write sorry read and execute

749
00:27:16,320 --> 00:27:19,120
is in the last position which means any

750
00:27:19,120 --> 00:27:21,840
user can read

751
00:27:21,840 --> 00:27:24,640
this directory and uh and go into the

752
00:27:24,640 --> 00:27:26,240
directory that's what the x means for

753
00:27:26,240 --> 00:27:28,960
direct this directory

754
00:27:28,960 --> 00:27:31,600
we found all sorts of sensitive data in

755
00:27:31,600 --> 00:27:34,480
there from insecured backups

756
00:27:34,480 --> 00:27:36,240
now they weren't writable

757
00:27:36,240 --> 00:27:38,240
so i couldn't destroy them if i was a

758
00:27:38,240 --> 00:27:41,120
ransomware actor but we took that back

759
00:27:41,120 --> 00:27:43,360
looked inside those we found

760
00:27:43,360 --> 00:27:45,200
sensitive data that

761
00:27:45,200 --> 00:27:47,760
passwords that gave us access to the

762
00:27:47,760 --> 00:27:50,799
database server with you know tons and

763
00:27:50,799 --> 00:27:53,679
tons and tons of uh of rows of data that

764
00:27:53,679 --> 00:27:55,600
was in there sensitive data on top of

765
00:27:55,600 --> 00:27:56,480
this

766
00:27:56,480 --> 00:27:58,399
right look around the network

767
00:27:58,399 --> 00:28:00,960
find this file share with with backups

768
00:28:00,960 --> 00:28:05,039
exposed grab the passwords once again

769
00:28:05,039 --> 00:28:07,840
without domain admin remember here and i

770
00:28:07,840 --> 00:28:09,360
keep hitting this over and over again

771
00:28:09,360 --> 00:28:11,840
the important thing here is determining

772
00:28:11,840 --> 00:28:13,919
and communicating the business

773
00:28:13,919 --> 00:28:16,640
risk great quote here from tim malcolm

774
00:28:16,640 --> 00:28:19,279
vetter i can't believe pen testers and

775
00:28:19,279 --> 00:28:21,760
red teamers are still focusing on domain

776
00:28:21,760 --> 00:28:23,840
admin d a is in

777
00:28:23,840 --> 00:28:26,720
most cases a waste of access it's

778
00:28:26,720 --> 00:28:28,799
inefficient if you're modeling a

779
00:28:28,799 --> 00:28:31,039
sophisticated attacker whatever that

780
00:28:31,039 --> 00:28:32,000
means

781
00:28:32,000 --> 00:28:35,039
abuse the path of least privilege

782
00:28:35,039 --> 00:28:38,320
usually the path of least noise

783
00:28:38,320 --> 00:28:40,960
completely agree with this now

784
00:28:40,960 --> 00:28:43,279
don't say don't go for d.a but maybe

785
00:28:43,279 --> 00:28:45,440
after you try it through some of these

786
00:28:45,440 --> 00:28:48,320
you know stealthier quieter simpler

787
00:28:48,320 --> 00:28:49,520
methods

788
00:28:49,520 --> 00:28:51,840
come back and then

789
00:28:51,840 --> 00:28:54,000
get d a another great quote here from

790
00:28:54,000 --> 00:28:55,600
jeff mcjunkin

791
00:28:55,600 --> 00:28:57,919
periodic reminder gaining a

792
00:28:57,919 --> 00:29:00,640
domain admit is the equivalent of taking

793
00:29:00,640 --> 00:29:04,960
a screenshot of script alert xsx it

794
00:29:04,960 --> 00:29:07,600
implies impact but it doesn't do

795
00:29:07,600 --> 00:29:09,520
anything to actually

796
00:29:09,520 --> 00:29:12,399
demonstrate the impact

797
00:29:12,399 --> 00:29:14,720
right imagine if we take this uh our pen

798
00:29:14,720 --> 00:29:18,080
test report to some sort of c level

799
00:29:18,080 --> 00:29:19,840
like they got domain admin cool what

800
00:29:19,840 --> 00:29:22,000
does that mean how's our data

801
00:29:22,000 --> 00:29:25,440
right we need to focus on the data or

802
00:29:25,440 --> 00:29:28,080
the process that is the important thing

803
00:29:28,080 --> 00:29:28,960
here

804
00:29:28,960 --> 00:29:30,000
right

805
00:29:30,000 --> 00:29:30,720
uh

806
00:29:30,720 --> 00:29:33,279
feel free to contact me tim at red siege

807
00:29:33,279 --> 00:29:35,600
dot com contact redstitch.com you can

808
00:29:35,600 --> 00:29:37,919
find us all over the internets on the

809
00:29:37,919 --> 00:29:40,880
tweeters facebook linkedin

810
00:29:40,880 --> 00:29:42,480
and with that we're going to wrap up the

811
00:29:42,480 --> 00:29:43,840
presentation

812
00:29:43,840 --> 00:29:45,679
if you want a copy of these slides go to

813
00:29:45,679 --> 00:29:48,320
redsiege.com

814
00:29:48,320 --> 00:29:50,960
access but thank you all for attending

815
00:29:50,960 --> 00:29:53,440
and hopefully enjoy some time off over

816
00:29:53,440 --> 00:29:58,440
these next few days thanks again

817
00:30:04,020 --> 00:30:07,990
[Music]

818
00:30:11,380 --> 00:30:17,639
[Music]

819
00:30:18,480 --> 00:30:20,559
you

