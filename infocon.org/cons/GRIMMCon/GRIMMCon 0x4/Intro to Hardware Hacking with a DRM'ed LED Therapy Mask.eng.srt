1
00:00:00,560 --> 00:00:02,560
hey everyone and welcome to my talk

2
00:00:02,560 --> 00:00:04,640
intro to hardware hacking with a drm

3
00:00:04,640 --> 00:00:07,839
led therapy mask my name is jamie my

4
00:00:07,839 --> 00:00:09,920
background is in electrical engineering

5
00:00:09,920 --> 00:00:12,320
uh specifically embedded systems

6
00:00:12,320 --> 00:00:14,639
i kind of accidentally became a software

7
00:00:14,639 --> 00:00:17,039
engineer for a little bit and

8
00:00:17,039 --> 00:00:19,680
now i work as a security researcher on

9
00:00:19,680 --> 00:00:20,240
grim's

10
00:00:20,240 --> 00:00:23,519
sci-fi team taking apart cards and

11
00:00:23,519 --> 00:00:26,320
hacking other cool things

12
00:00:26,320 --> 00:00:30,000
so this story begins quite a while

13
00:00:30,000 --> 00:00:33,120
ago in the pre-coveted before time i was

14
00:00:33,120 --> 00:00:35,120
actually at a bar

15
00:00:35,120 --> 00:00:38,559
and a friend texted me about this really

16
00:00:38,559 --> 00:00:40,000
i didn't know at the time but really

17
00:00:40,000 --> 00:00:42,160
creepy led face mask

18
00:00:42,160 --> 00:00:44,480
that she bought that stopped working

19
00:00:44,480 --> 00:00:46,239
pretty soon after she bought it

20
00:00:46,239 --> 00:00:48,399
and she needed some help so i'm like

21
00:00:48,399 --> 00:00:51,280
yeah you know that sounds fun sign me up

22
00:00:51,280 --> 00:00:54,000
um i was actually still at the bar doing

23
00:00:54,000 --> 00:00:55,840
research on my phone and reading about

24
00:00:55,840 --> 00:00:56,480
it

25
00:00:56,480 --> 00:00:58,320
uh the idea is that the inside of the

26
00:00:58,320 --> 00:00:59,920
mask has

27
00:00:59,920 --> 00:01:03,520
um red and blue leds that light up

28
00:01:03,520 --> 00:01:05,519
and the idea is that it you know treats

29
00:01:05,519 --> 00:01:07,680
her skin i don't really know if it works

30
00:01:07,680 --> 00:01:10,000
but that's not the point of this talk

31
00:01:10,000 --> 00:01:13,439
um so of course there's this part

32
00:01:13,439 --> 00:01:15,840
and then there's a little activator kind

33
00:01:15,840 --> 00:01:17,840
of remote that it plugs into

34
00:01:17,840 --> 00:01:21,040
um this has two parts to it one

35
00:01:21,040 --> 00:01:22,960
it powers the mask because of the

36
00:01:22,960 --> 00:01:24,640
batteries in the back

37
00:01:24,640 --> 00:01:26,799
uh and then the second part is that it

38
00:01:26,799 --> 00:01:27,920
shows you

39
00:01:27,920 --> 00:01:30,880
how many uses you have left it um it

40
00:01:30,880 --> 00:01:32,560
starts a timer and then it shows you how

41
00:01:32,560 --> 00:01:34,400
many uses you have left

42
00:01:34,400 --> 00:01:36,799
and i don't mean how many uses you have

43
00:01:36,799 --> 00:01:38,079
left before the batteries

44
00:01:38,079 --> 00:01:40,880
run out i mean how many uses you have

45
00:01:40,880 --> 00:01:41,439
left

46
00:01:41,439 --> 00:01:45,520
before the activator bricks itself and

47
00:01:45,520 --> 00:01:48,240
you have to go and buy a new one for 15

48
00:01:48,240 --> 00:01:50,159
throw away the old one

49
00:01:50,159 --> 00:01:54,320
otherwise the your little mask thing is

50
00:01:54,320 --> 00:01:57,360
doesn't work anymore

51
00:01:57,520 --> 00:01:59,920
and you're supposed to use one 10-minute

52
00:01:59,920 --> 00:02:02,240
session a day you get 30 uses

53
00:02:02,240 --> 00:02:03,759
which means that you're going to have to

54
00:02:03,759 --> 00:02:06,320
throw one of these out and buy a new one

55
00:02:06,320 --> 00:02:09,598
every month which i think is

56
00:02:09,598 --> 00:02:13,120
is kind of right um

57
00:02:13,120 --> 00:02:14,560
you know you've already got this kind of

58
00:02:14,560 --> 00:02:17,040
creepy friday the 13th

59
00:02:17,040 --> 00:02:20,560
mask and you've got planned obsolescence

60
00:02:20,560 --> 00:02:23,840
built into it such that you're throwing

61
00:02:23,840 --> 00:02:26,000
away perfectly good electronics

62
00:02:26,000 --> 00:02:29,040
just to make a little bit more money um

63
00:02:29,040 --> 00:02:30,879
so needless to say

64
00:02:30,879 --> 00:02:33,840
i pretty quickly started disliking this

65
00:02:33,840 --> 00:02:34,239
mask

66
00:02:34,239 --> 00:02:36,239
before i ever even saw in person and i

67
00:02:36,239 --> 00:02:38,080
got drawn into the idea of figuring out

68
00:02:38,080 --> 00:02:40,480
what was going on with it

69
00:02:40,480 --> 00:02:42,319
so it turns out there are plenty of

70
00:02:42,319 --> 00:02:44,480
guides online that tell you

71
00:02:44,480 --> 00:02:47,680
how to bypass the check in

72
00:02:47,680 --> 00:02:51,920
software just a quick hardware fix where

73
00:02:51,920 --> 00:02:52,560
you

74
00:02:52,560 --> 00:02:54,319
take two of the pins and you short them

75
00:02:54,319 --> 00:02:55,920
together and it it

76
00:02:55,920 --> 00:02:57,840
completely bypasses the whole software

77
00:02:57,840 --> 00:02:59,760
part of the device

78
00:02:59,760 --> 00:03:01,440
um and that want to fix the problem in

79
00:03:01,440 --> 00:03:03,120
like five minutes but i

80
00:03:03,120 --> 00:03:04,560
didn't want to take that approach i

81
00:03:04,560 --> 00:03:06,080
wanted to do something a little bit more

82
00:03:06,080 --> 00:03:07,680
complicated

83
00:03:07,680 --> 00:03:11,120
and time-consuming um i got to say on

84
00:03:11,120 --> 00:03:12,159
brand

85
00:03:12,159 --> 00:03:16,239
um so i you know i wanted to take a

86
00:03:16,239 --> 00:03:17,519
different approach i wanted to see what

87
00:03:17,519 --> 00:03:18,239
was happening

88
00:03:18,239 --> 00:03:20,239
happening in software and if i couldn't

89
00:03:20,239 --> 00:03:21,280
change

90
00:03:21,280 --> 00:03:24,799
um you know what what was going on there

91
00:03:24,799 --> 00:03:27,120
the product has since been recalled due

92
00:03:27,120 --> 00:03:29,040
to eye damage reasons

93
00:03:29,040 --> 00:03:31,519
so by the time i finished this side

94
00:03:31,519 --> 00:03:33,519
project

95
00:03:33,519 --> 00:03:35,040
my friend didn't want to use it anymore

96
00:03:35,040 --> 00:03:37,120
which is you know fine it wasn't very

97
00:03:37,120 --> 00:03:39,120
practical project but i still learned a

98
00:03:39,120 --> 00:03:40,080
lot and it was

99
00:03:40,080 --> 00:03:44,080
is pretty fun it's a pretty simple

100
00:03:44,080 --> 00:03:44,879
design

101
00:03:44,879 --> 00:03:48,159
but it works as a neat little example

102
00:03:48,159 --> 00:03:48,560
for

103
00:03:48,560 --> 00:03:50,879
hardware hacking in general which is why

104
00:03:50,879 --> 00:03:53,439
i'm sharing in a talk today

105
00:03:53,439 --> 00:03:55,920
so step number one you need to find

106
00:03:55,920 --> 00:03:57,920
something to hack

107
00:03:57,920 --> 00:04:01,360
this probably won't come as a difficult

108
00:04:01,360 --> 00:04:03,439
step to most people but i want to cover

109
00:04:03,439 --> 00:04:06,720
anyway i already told you what i

110
00:04:06,720 --> 00:04:09,760
chose for this step my motivation was

111
00:04:09,760 --> 00:04:11,200
helping my friend out

112
00:04:11,200 --> 00:04:13,200
learning a little bit i wasn't really

113
00:04:13,200 --> 00:04:15,599
trying to save money

114
00:04:15,599 --> 00:04:17,759
and i imagine that most of you aren't

115
00:04:17,759 --> 00:04:19,358
you know motivated to

116
00:04:19,358 --> 00:04:22,320
save 15 a month to go through all this

117
00:04:22,320 --> 00:04:23,120
work

118
00:04:23,120 --> 00:04:27,199
there are other motivations happening

119
00:04:27,199 --> 00:04:28,880
for example you might be looking for

120
00:04:28,880 --> 00:04:30,639
some kind of vulnerability that gives

121
00:04:30,639 --> 00:04:31,440
you

122
00:04:31,440 --> 00:04:35,199
unintended access or control

123
00:04:35,199 --> 00:04:37,360
and because that usually means code

124
00:04:37,360 --> 00:04:38,800
execution we think of that

125
00:04:38,800 --> 00:04:41,280
as an exercise in software engineering

126
00:04:41,280 --> 00:04:42,080
or software

127
00:04:42,080 --> 00:04:44,479
reverse engineering but in order to get

128
00:04:44,479 --> 00:04:45,759
to that point you need to do some

129
00:04:45,759 --> 00:04:48,000
hardware hacking first

130
00:04:48,000 --> 00:04:50,720
um in this talk i only had one copy of

131
00:04:50,720 --> 00:04:51,840
the device

132
00:04:51,840 --> 00:04:53,360
which you'll see kind of turned out to

133
00:04:53,360 --> 00:04:54,960
be a little bit of a hindrance

134
00:04:54,960 --> 00:04:56,479
if you're doing this for work or

135
00:04:56,479 --> 00:04:58,080
security research

136
00:04:58,080 --> 00:05:00,639
hopefully you have access to multiple

137
00:05:00,639 --> 00:05:01,600
copies

138
00:05:01,600 --> 00:05:03,680
so that if you break on an accident it

139
00:05:03,680 --> 00:05:05,440
isn't a big deal or you might need to

140
00:05:05,440 --> 00:05:06,479
break one on purpose

141
00:05:06,479 --> 00:05:08,400
for example you might want to pull off a

142
00:05:08,400 --> 00:05:09,919
memory chip

143
00:05:09,919 --> 00:05:13,280
and then dump the contents so if you

144
00:05:13,280 --> 00:05:14,960
don't get one of these or you don't get

145
00:05:14,960 --> 00:05:17,520
enough from your customer or whatever

146
00:05:17,520 --> 00:05:21,840
there are other ways of of buying parts

147
00:05:21,919 --> 00:05:24,400
you can you know just buy them off the

148
00:05:24,400 --> 00:05:25,919
shelf like a normal person

149
00:05:25,919 --> 00:05:27,600
if you're trying to do something that's

150
00:05:27,600 --> 00:05:29,039
iot or

151
00:05:29,039 --> 00:05:31,120
you know consumer products if you're

152
00:05:31,120 --> 00:05:33,360
looking for more specialized equipment

153
00:05:33,360 --> 00:05:36,000
you can check out ebay this photo here

154
00:05:36,000 --> 00:05:36,479
is

155
00:05:36,479 --> 00:05:39,120
a search for trucking ecu's but i've

156
00:05:39,120 --> 00:05:40,479
seen a lot of other stuff

157
00:05:40,479 --> 00:05:43,199
on ebay that that seems like it really

158
00:05:43,199 --> 00:05:46,320
shouldn't be for sale

159
00:05:46,720 --> 00:05:50,000
so step two is to take it apart

160
00:05:50,000 --> 00:05:52,000
once you have the thing you want to hack

161
00:05:52,000 --> 00:05:54,400
you need to get full physical access

162
00:05:54,400 --> 00:05:57,600
to the board inside on on both sides

163
00:05:57,600 --> 00:05:59,680
in this case i only needed to take out a

164
00:05:59,680 --> 00:06:00,639
couple of screws

165
00:06:00,639 --> 00:06:04,160
and i just use a screwdriver if it's a

166
00:06:04,160 --> 00:06:05,759
complicated process

167
00:06:05,759 --> 00:06:08,800
i recommend that you take photos or if

168
00:06:08,800 --> 00:06:10,800
there are

169
00:06:10,800 --> 00:06:14,720
outside connectors that kind of

170
00:06:16,000 --> 00:06:18,880
attach in a difficult to remember way

171
00:06:18,880 --> 00:06:19,199
just

172
00:06:19,199 --> 00:06:22,240
take photos help yourself out later

173
00:06:22,240 --> 00:06:23,919
and then also hold on to the casing

174
00:06:23,919 --> 00:06:25,840
because you might want to use it later

175
00:06:25,840 --> 00:06:28,800
for example i partially reassembled mine

176
00:06:28,800 --> 00:06:31,120
because the battery holder was

177
00:06:31,120 --> 00:06:34,160
very useful but you might not be so

178
00:06:34,160 --> 00:06:35,039
lucky

179
00:06:35,039 --> 00:06:37,120
um for example if you do a lot of work

180
00:06:37,120 --> 00:06:39,840
with ruggedized automotive equipment

181
00:06:39,840 --> 00:06:42,000
um you're gonna have to go through more

182
00:06:42,000 --> 00:06:44,160
work um

183
00:06:44,160 --> 00:06:46,720
for example in this video uh which is

184
00:06:46,720 --> 00:06:47,199
from

185
00:06:47,199 --> 00:06:50,240
searching remove epoxy on youtube

186
00:06:50,240 --> 00:06:52,319
it shows how for certain types of epoxy

187
00:06:52,319 --> 00:06:54,080
you can heat it up such as in boiling

188
00:06:54,080 --> 00:06:55,120
water and then either

189
00:06:55,120 --> 00:06:58,479
peel or chip away the epoxy in another

190
00:06:58,479 --> 00:06:59,120
example

191
00:06:59,120 --> 00:07:01,759
last year one of my co-workers helped me

192
00:07:01,759 --> 00:07:02,560
sawzall

193
00:07:02,560 --> 00:07:04,560
a ruggedized case apart which

194
00:07:04,560 --> 00:07:05,599
unfortunately i

195
00:07:05,599 --> 00:07:09,680
can't share photos of in this talk

196
00:07:10,560 --> 00:07:13,520
so once you have the board free and you

197
00:07:13,520 --> 00:07:15,599
can see both sides

198
00:07:15,599 --> 00:07:18,160
step three is to identify components

199
00:07:18,160 --> 00:07:21,039
which is a two-part process

200
00:07:21,039 --> 00:07:23,360
but before we get into the deals the

201
00:07:23,360 --> 00:07:25,280
details of that

202
00:07:25,280 --> 00:07:26,800
we need to talk about reference

203
00:07:26,800 --> 00:07:29,440
designators first

204
00:07:29,440 --> 00:07:31,520
so when pcbs are designed and

205
00:07:31,520 --> 00:07:33,759
manufactured the engineers put markings

206
00:07:33,759 --> 00:07:35,680
on the silk screen layer to help

207
00:07:35,680 --> 00:07:37,120
identify parts for

208
00:07:37,120 --> 00:07:40,160
troubleshooting um design review things

209
00:07:40,160 --> 00:07:41,360
like that

210
00:07:41,360 --> 00:07:44,960
um for each uh

211
00:07:44,960 --> 00:07:48,080
reference designator there is a

212
00:07:48,080 --> 00:07:51,280
letter and a number each letter is going

213
00:07:51,280 --> 00:07:52,879
to correspond to a certain type of part

214
00:07:52,879 --> 00:07:54,720
and these are standardized across

215
00:07:54,720 --> 00:07:57,759
almost all boards um so c

216
00:07:57,759 --> 00:08:00,879
is for capacitor so anything with c

217
00:08:00,879 --> 00:08:02,879
and then a number you can assume it's a

218
00:08:02,879 --> 00:08:04,560
capacitor

219
00:08:04,560 --> 00:08:06,560
so for example in this first picture we

220
00:08:06,560 --> 00:08:09,280
have c8

221
00:08:09,440 --> 00:08:12,319
resistors use r jumpers or connectors

222
00:08:12,319 --> 00:08:12,800
use

223
00:08:12,800 --> 00:08:16,240
j and then integrated circuits use u

224
00:08:16,240 --> 00:08:19,199
so for of all the types of components

225
00:08:19,199 --> 00:08:20,800
the u components are going to be the

226
00:08:20,800 --> 00:08:21,280
most

227
00:08:21,280 --> 00:08:23,440
interesting to us because that's where

228
00:08:23,440 --> 00:08:24,319
the software

229
00:08:24,319 --> 00:08:26,960
um the logic and the the control is

230
00:08:26,960 --> 00:08:29,280
implemented

231
00:08:29,280 --> 00:08:31,520
so uh here's the whole board with the

232
00:08:31,520 --> 00:08:33,599
parts identified

233
00:08:33,599 --> 00:08:35,279
the top side only there's nothing really

234
00:08:35,279 --> 00:08:37,919
going on on the back side of this board

235
00:08:37,919 --> 00:08:39,679
in general we want to focus on the

236
00:08:39,679 --> 00:08:41,039
components that involve

237
00:08:41,039 --> 00:08:43,919
logic or communication and that is

238
00:08:43,919 --> 00:08:46,000
highly correlated with the u reference

239
00:08:46,000 --> 00:08:49,279
designator so

240
00:08:49,279 --> 00:08:51,760
the first half of step three is to get

241
00:08:51,760 --> 00:08:54,000
photos

242
00:08:54,000 --> 00:08:55,600
obviously i already have them because i

243
00:08:55,600 --> 00:08:57,440
just showed them to you

244
00:08:57,440 --> 00:08:59,839
but now we want to zoom in on the parts

245
00:08:59,839 --> 00:09:00,720
that are most

246
00:09:00,720 --> 00:09:02,320
interesting like the micro controller

247
00:09:02,320 --> 00:09:04,880
memory chips communication related chips

248
00:09:04,880 --> 00:09:06,160
all of the you reference

249
00:09:06,160 --> 00:09:08,560
designators that we just talked about uh

250
00:09:08,560 --> 00:09:09,360
but if you get

251
00:09:09,360 --> 00:09:11,120
you know photos of other things too

252
00:09:11,120 --> 00:09:13,839
that's that's totally fine

253
00:09:13,839 --> 00:09:15,839
um so reference designators tell us

254
00:09:15,839 --> 00:09:17,120
which type of part

255
00:09:17,120 --> 00:09:18,800
we already found those on our boards

256
00:09:18,800 --> 00:09:21,040
just by you know holding in our hands

257
00:09:21,040 --> 00:09:21,360
and

258
00:09:21,360 --> 00:09:22,720
and looking at it but now we want

259
00:09:22,720 --> 00:09:24,399
close-up photos

260
00:09:24,399 --> 00:09:26,399
these photos need to have high enough

261
00:09:26,399 --> 00:09:28,240
resolution to see the markings

262
00:09:28,240 --> 00:09:30,800
on the electronic components in this

263
00:09:30,800 --> 00:09:32,720
arduino example here you can see like

264
00:09:32,720 --> 00:09:34,240
the really faint

265
00:09:34,240 --> 00:09:37,600
uh tan text on the components that is

266
00:09:37,600 --> 00:09:40,160
what we're after

267
00:09:40,160 --> 00:09:42,240
uh so you don't need to say enhance when

268
00:09:42,240 --> 00:09:43,680
you zoom in on these but i

269
00:09:43,680 --> 00:09:46,959
i think it helps i circled the the u

270
00:09:46,959 --> 00:09:50,240
components on our board uh in this photo

271
00:09:50,240 --> 00:09:51,760
and we're going to take really close up

272
00:09:51,760 --> 00:09:53,600
photos of each of those if you have

273
00:09:53,600 --> 00:09:55,360
uh jumpers or connectors or other

274
00:09:55,360 --> 00:09:57,279
interesting parts get photos of those

275
00:09:57,279 --> 00:09:59,680
too if you have a lot of parts on your

276
00:09:59,680 --> 00:10:00,880
board

277
00:10:00,880 --> 00:10:02,480
which isn't really the case here we only

278
00:10:02,480 --> 00:10:05,680
have like a dozen

279
00:10:05,680 --> 00:10:08,480
then consider making a spreadsheet to

280
00:10:08,480 --> 00:10:11,440
keep track of things

281
00:10:11,839 --> 00:10:14,160
so now that you have the pictures you

282
00:10:14,160 --> 00:10:15,120
said enhanced

283
00:10:15,120 --> 00:10:17,839
when you zoomed in you've got a clear

284
00:10:17,839 --> 00:10:19,680
view of the markings

285
00:10:19,680 --> 00:10:21,600
which in this photo are only a few

286
00:10:21,600 --> 00:10:23,680
millimeters in width it's actually this

287
00:10:23,680 --> 00:10:25,519
part right here which you can see is

288
00:10:25,519 --> 00:10:27,760
tiny um

289
00:10:27,760 --> 00:10:31,120
so it says atml

290
00:10:31,120 --> 00:10:34,079
six h44046d etc uh kind of like an eye

291
00:10:34,079 --> 00:10:34,880
exam

292
00:10:34,880 --> 00:10:38,320
um so now that you have those except

293
00:10:38,320 --> 00:10:41,519
uh step three b is going to be just

294
00:10:41,519 --> 00:10:43,920
googling things which i know pretty

295
00:10:43,920 --> 00:10:45,839
sophisticated

296
00:10:45,839 --> 00:10:47,279
and this is a little bit more of an art

297
00:10:47,279 --> 00:10:49,440
than a science which we'll

298
00:10:49,440 --> 00:10:52,720
we'll get to in the next slide

299
00:10:52,720 --> 00:10:56,000
on this the atml atmel

300
00:10:56,000 --> 00:10:58,640
is a brand you might have a logo instead

301
00:10:58,640 --> 00:10:59,920
you have the part number and then you

302
00:10:59,920 --> 00:11:00,560
have

303
00:11:00,560 --> 00:11:02,399
some kind of variation information or

304
00:11:02,399 --> 00:11:03,839
maybe or maybe batch

305
00:11:03,839 --> 00:11:07,200
information for for that part

306
00:11:07,200 --> 00:11:09,440
so when you go and google this you don't

307
00:11:09,440 --> 00:11:10,240
want to just put

308
00:11:10,240 --> 00:11:11,839
the numbers in by themselves you want to

309
00:11:11,839 --> 00:11:14,320
put something in like smd for a surface

310
00:11:14,320 --> 00:11:15,519
mount device

311
00:11:15,519 --> 00:11:17,680
or data sheet after it and then play

312
00:11:17,680 --> 00:11:20,000
around with how much of it you include

313
00:11:20,000 --> 00:11:21,920
you might not need to include the brand

314
00:11:21,920 --> 00:11:23,440
you might not need to include the batch

315
00:11:23,440 --> 00:11:24,000
name

316
00:11:24,000 --> 00:11:26,320
uh just play around like i said it's not

317
00:11:26,320 --> 00:11:28,880
really science um

318
00:11:28,880 --> 00:11:32,640
so in this case it turns out that the

319
00:11:32,640 --> 00:11:35,279
part number looks like it corresponds to

320
00:11:35,279 --> 00:11:36,079
an atmel

321
00:11:36,079 --> 00:11:38,160
doubly prom chip which i think makes

322
00:11:38,160 --> 00:11:39,920
sense here

323
00:11:39,920 --> 00:11:43,600
which is external memory for the

324
00:11:43,600 --> 00:11:46,640
for the microcontroller there's also a

325
00:11:46,640 --> 00:11:48,120
website called

326
00:11:48,120 --> 00:11:51,680
smdmark.com you don't always get hits on

327
00:11:51,680 --> 00:11:53,600
here but i find it it is still worth

328
00:11:53,600 --> 00:11:55,040
looking

329
00:11:55,040 --> 00:11:58,880
in this example i googled 7533 which is

330
00:11:58,880 --> 00:12:03,040
actually this even smaller part here

331
00:12:03,200 --> 00:12:06,320
and i got some results back that suggest

332
00:12:06,320 --> 00:12:08,639
that it is a ldo which is voltage

333
00:12:08,639 --> 00:12:09,440
regulator

334
00:12:09,440 --> 00:12:11,040
all right so the important thing to keep

335
00:12:11,040 --> 00:12:13,279
in mind here is that there are a lot of

336
00:12:13,279 --> 00:12:14,880
very similar parts

337
00:12:14,880 --> 00:12:17,120
and you're going to waste a lot of time

338
00:12:17,120 --> 00:12:19,440
and effort if you go into the next steps

339
00:12:19,440 --> 00:12:21,279
using the wrong data sheet so you want

340
00:12:21,279 --> 00:12:23,360
to do some kind of due diligence

341
00:12:23,360 --> 00:12:26,560
to make sure that you have the right one

342
00:12:26,560 --> 00:12:27,760
and that doesn't mean that you need to

343
00:12:27,760 --> 00:12:30,240
read the whole thing top to bottom

344
00:12:30,240 --> 00:12:32,079
you might look for information in the

345
00:12:32,079 --> 00:12:34,480
data sheet about what

346
00:12:34,480 --> 00:12:37,040
markings it says will be on the parts to

347
00:12:37,040 --> 00:12:38,000
kind of cross reference

348
00:12:38,000 --> 00:12:40,880
that but what i like to do is measure

349
00:12:40,880 --> 00:12:42,880
the power and ground pin to see if they

350
00:12:42,880 --> 00:12:44,399
match up

351
00:12:44,399 --> 00:12:47,120
with the data sheet so for example if

352
00:12:47,120 --> 00:12:49,760
the if the data sheet says that pin 4

353
00:12:49,760 --> 00:12:52,320
is going to have is going to be ground

354
00:12:52,320 --> 00:12:53,760
and then pin

355
00:12:53,760 --> 00:12:56,880
um 8 is going to be power or 3.3 volts

356
00:12:56,880 --> 00:12:58,240
measure that and be sure

357
00:12:58,240 --> 00:12:59,600
if they don't match up you don't have

358
00:12:59,600 --> 00:13:00,800
the right data sheet and you need to

359
00:13:00,800 --> 00:13:01,920
keep looking

360
00:13:01,920 --> 00:13:03,680
uh if they do match that doesn't

361
00:13:03,680 --> 00:13:06,079
necessarily mean that you did it right

362
00:13:06,079 --> 00:13:07,839
but if they don't match you probably did

363
00:13:07,839 --> 00:13:09,600
it wrong so in this case

364
00:13:09,600 --> 00:13:11,360
i thought i had the right one i measured

365
00:13:11,360 --> 00:13:13,920
it i traced the pins to power and ground

366
00:13:13,920 --> 00:13:16,480
they didn't match up so i kept looking i

367
00:13:16,480 --> 00:13:16,959
ended up

368
00:13:16,959 --> 00:13:20,160
finding it it's kind of a uncommon

369
00:13:20,160 --> 00:13:23,519
and now end of life part um

370
00:13:23,519 --> 00:13:25,519
but i didn't end up end up finding a

371
00:13:25,519 --> 00:13:27,360
data sheet that matched

372
00:13:27,360 --> 00:13:30,000
so as best as i can tell these are the

373
00:13:30,000 --> 00:13:32,079
components that our board has

374
00:13:32,079 --> 00:13:35,600
um so a atmel doubleeprim

375
00:13:35,600 --> 00:13:39,040
holtec ldo voltage regulator uh seacoast

376
00:13:39,040 --> 00:13:40,399
mosfet and then

377
00:13:40,399 --> 00:13:41,680
i don't know what kind of

378
00:13:41,680 --> 00:13:43,920
microcontroller it has um

379
00:13:43,920 --> 00:13:46,480
because it is covered with epoxy and in

380
00:13:46,480 --> 00:13:47,760
this case

381
00:13:47,760 --> 00:13:50,000
it is only covered with epoxy so if i

382
00:13:50,000 --> 00:13:51,920
were to um

383
00:13:51,920 --> 00:13:54,079
try and remove this there wouldn't be

384
00:13:54,079 --> 00:13:54,959
any

385
00:13:54,959 --> 00:13:56,880
plastic packaging underneath it would

386
00:13:56,880 --> 00:13:58,800
just be the bare silicon

387
00:13:58,800 --> 00:14:02,480
uh and i don't really want to risk

388
00:14:02,480 --> 00:14:06,800
destroying it or damaging it

389
00:14:07,120 --> 00:14:08,800
and normally the microcontroller is one

390
00:14:08,800 --> 00:14:11,519
of the most important things to identify

391
00:14:11,519 --> 00:14:13,600
and on almost any other project i would

392
00:14:13,600 --> 00:14:15,199
find a way to identify it but i thought

393
00:14:15,199 --> 00:14:16,160
maybe in this case

394
00:14:16,160 --> 00:14:18,880
i didn't need to for the other

395
00:14:18,880 --> 00:14:20,079
components

396
00:14:20,079 --> 00:14:23,040
the ldo tells us that the doubly prom

397
00:14:23,040 --> 00:14:24,880
and the microcontroller are powered off

398
00:14:24,880 --> 00:14:28,000
of 3.3 volts

399
00:14:28,480 --> 00:14:31,920
the mosfet is part of that circuitry too

400
00:14:31,920 --> 00:14:33,839
uh i have a way of powering the board

401
00:14:33,839 --> 00:14:35,120
through the batteries

402
00:14:35,120 --> 00:14:37,839
so that information isn't super useful

403
00:14:37,839 --> 00:14:39,839
um but it's good that i know it and if i

404
00:14:39,839 --> 00:14:41,839
had to for some reason power the board

405
00:14:41,839 --> 00:14:42,320
off

406
00:14:42,320 --> 00:14:48,240
of a power part of the board off of

407
00:14:48,240 --> 00:14:50,160
something besides the original power

408
00:14:50,160 --> 00:14:53,120
source then that would be pretty useful

409
00:14:53,120 --> 00:14:55,920
step four is more data sheet reading

410
00:14:55,920 --> 00:14:57,040
lucky you

411
00:14:57,040 --> 00:14:59,040
um you still need your multimeter you

412
00:14:59,040 --> 00:15:00,639
probably want some coffee

413
00:15:00,639 --> 00:15:02,160
um you have the data sheets that you

414
00:15:02,160 --> 00:15:04,880
have before and now we're going to

415
00:15:04,880 --> 00:15:07,440
um read them in more depth you already

416
00:15:07,440 --> 00:15:09,199
you know did a cursory check to see if

417
00:15:09,199 --> 00:15:10,959
they fit now we're going to really dig

418
00:15:10,959 --> 00:15:13,760
in so earlier we looked at all the

419
00:15:13,760 --> 00:15:15,120
components on the board

420
00:15:15,120 --> 00:15:17,279
we narrowed it down to the u reference

421
00:15:17,279 --> 00:15:18,880
designator ones

422
00:15:18,880 --> 00:15:21,040
we found the part numbers for each of

423
00:15:21,040 --> 00:15:22,240
those well

424
00:15:22,240 --> 00:15:24,720
not quite not in my case but we tried to

425
00:15:24,720 --> 00:15:26,720
find the part numbers for each of those

426
00:15:26,720 --> 00:15:28,639
uh we read some data sheets and then we

427
00:15:28,639 --> 00:15:30,480
narrowed it down further

428
00:15:30,480 --> 00:15:32,800
to the most important one so for example

429
00:15:32,800 --> 00:15:34,320
we decided the ldo

430
00:15:34,320 --> 00:15:37,440
not not that useful to us

431
00:15:37,440 --> 00:15:40,000
so for the remaining things on our list

432
00:15:40,000 --> 00:15:41,839
we're going to read as much about them

433
00:15:41,839 --> 00:15:43,519
as possible for each one we're going to

434
00:15:43,519 --> 00:15:44,240
think

435
00:15:44,240 --> 00:15:46,639
about what the purpose of the component

436
00:15:46,639 --> 00:15:47,519
is

437
00:15:47,519 --> 00:15:49,759
you know can you summarize uh what it

438
00:15:49,759 --> 00:15:51,360
does within the context

439
00:15:51,360 --> 00:15:53,920
of the board how does it communicate

440
00:15:53,920 --> 00:15:54,399
what

441
00:15:54,399 --> 00:15:56,800
parts is it communicating to what what

442
00:15:56,800 --> 00:15:58,800
data do you think it might be sending

443
00:15:58,800 --> 00:16:01,360
uh does it have any security features uh

444
00:16:01,360 --> 00:16:03,440
are there measurable pins that determine

445
00:16:03,440 --> 00:16:04,320
some kind of

446
00:16:04,320 --> 00:16:06,480
hardware configuration like a write

447
00:16:06,480 --> 00:16:08,160
protect pin

448
00:16:08,160 --> 00:16:10,160
is there anything else important about

449
00:16:10,160 --> 00:16:11,839
the chip or unique about the chip that

450
00:16:11,839 --> 00:16:13,279
you should make note of

451
00:16:13,279 --> 00:16:15,680
for example the double eprom in our case

452
00:16:15,680 --> 00:16:17,199
as shown in this

453
00:16:17,199 --> 00:16:20,480
photo here it has its own instruction

454
00:16:20,480 --> 00:16:23,199
set that we need to understand

455
00:16:23,199 --> 00:16:26,079
in order to talk to it so at this point

456
00:16:26,079 --> 00:16:27,759
you want to look at the pin out

457
00:16:27,759 --> 00:16:31,839
and manually or mentally or physically

458
00:16:31,839 --> 00:16:33,120
with a dmm

459
00:16:33,120 --> 00:16:36,160
trace the connections uh this might be

460
00:16:36,160 --> 00:16:36,720
difficult

461
00:16:36,720 --> 00:16:38,399
due to how the board is made if you have

462
00:16:38,399 --> 00:16:40,639
a expensive board it might have internal

463
00:16:40,639 --> 00:16:42,480
layers it might have ball grid array

464
00:16:42,480 --> 00:16:43,440
parts

465
00:16:43,440 --> 00:16:45,440
that make it kind of hard to trace and

466
00:16:45,440 --> 00:16:47,440
you might have to get creative

467
00:16:47,440 --> 00:16:49,360
we don't have this problem uh because

468
00:16:49,360 --> 00:16:51,680
this is a this is a pretty inexpensive

469
00:16:51,680 --> 00:16:53,199
board

470
00:16:53,199 --> 00:16:56,160
so because it's so simple we could

471
00:16:56,160 --> 00:16:58,320
probably reconstruct the whole circuit

472
00:16:58,320 --> 00:17:00,560
diagram in this

473
00:17:00,560 --> 00:17:03,680
for this part or for this board but

474
00:17:03,680 --> 00:17:05,439
that usually isn't feasible and it's

475
00:17:05,439 --> 00:17:07,919
often not necessary either so we want to

476
00:17:07,919 --> 00:17:08,480
focus

477
00:17:08,480 --> 00:17:10,959
on how the board is powered and kind of

478
00:17:10,959 --> 00:17:13,439
represent that

479
00:17:13,439 --> 00:17:15,199
communication between the components and

480
00:17:15,199 --> 00:17:17,199
then into and out of the board

481
00:17:17,199 --> 00:17:19,439
where memory might be where logic is

482
00:17:19,439 --> 00:17:21,359
implemented in microcontours and things

483
00:17:21,359 --> 00:17:22,079
like that

484
00:17:22,079 --> 00:17:24,319
and then specialize areas like maybe you

485
00:17:24,319 --> 00:17:26,640
have a can transceiver

486
00:17:26,640 --> 00:17:28,079
which has some overlap with a

487
00:17:28,079 --> 00:17:30,559
communication part

488
00:17:30,559 --> 00:17:32,720
so put all of that into a block diagram

489
00:17:32,720 --> 00:17:34,000
to help yourself out or if you're

490
00:17:34,000 --> 00:17:35,440
working with other people

491
00:17:35,440 --> 00:17:37,360
uh for most of this you don't need to

492
00:17:37,360 --> 00:17:39,360
understand it to a double e level

493
00:17:39,360 --> 00:17:41,360
uh back to our power example you don't

494
00:17:41,360 --> 00:17:42,960
really need to know the electrical

495
00:17:42,960 --> 00:17:45,039
details of the power regulation

496
00:17:45,039 --> 00:17:47,919
circuitry just that you know you have

497
00:17:47,919 --> 00:17:50,320
batteries that are between five and

498
00:17:50,320 --> 00:17:52,400
and six volts and you want to regulate

499
00:17:52,400 --> 00:17:54,160
that down to a lower voltage because

500
00:17:54,160 --> 00:17:56,640
that's what the other parts run on

501
00:17:56,640 --> 00:17:58,840
we want to focus on communication

502
00:17:58,840 --> 00:18:00,080
protocols

503
00:18:00,080 --> 00:18:03,280
and where the software and logic is so

504
00:18:03,280 --> 00:18:03,840
for this

505
00:18:03,840 --> 00:18:06,640
board the way that you talk to the

506
00:18:06,640 --> 00:18:07,520
double eprom

507
00:18:07,520 --> 00:18:11,760
is through a three wire spy protocol

508
00:18:11,760 --> 00:18:13,360
and the double e prime is there for a

509
00:18:13,360 --> 00:18:15,120
reason um

510
00:18:15,120 --> 00:18:16,960
since there isn't a whole lot else going

511
00:18:16,960 --> 00:18:18,880
on on this board i think we can probably

512
00:18:18,880 --> 00:18:20,160
safely assume

513
00:18:20,160 --> 00:18:22,799
that the microcontroller is storing the

514
00:18:22,799 --> 00:18:24,640
count of remaining uses

515
00:18:24,640 --> 00:18:28,400
for the mask in the memory in the double

516
00:18:28,400 --> 00:18:30,320
e prom

517
00:18:30,320 --> 00:18:32,400
so from the data sheet i identified

518
00:18:32,400 --> 00:18:33,840
which specific pins

519
00:18:33,840 --> 00:18:37,280
on the double eprom uh correspond to

520
00:18:37,280 --> 00:18:39,600
the three wire spy communication i added

521
00:18:39,600 --> 00:18:42,320
those to my diagram

522
00:18:42,320 --> 00:18:44,880
obviously this example is pretty pretty

523
00:18:44,880 --> 00:18:47,200
simple but having the blocks

524
00:18:47,200 --> 00:18:49,360
maybe the part numbers and then the pins

525
00:18:49,360 --> 00:18:50,559
are going to make things

526
00:18:50,559 --> 00:18:53,520
easier on your your future self unless

527
00:18:53,520 --> 00:18:54,799
you're able to do

528
00:18:54,799 --> 00:18:57,840
side projects in one sitting which

529
00:18:57,840 --> 00:19:00,320
you know in in that case hats off to you

530
00:19:00,320 --> 00:19:01,919
i i definitely took a while

531
00:19:01,919 --> 00:19:04,559
getting this one done so now we're

532
00:19:04,559 --> 00:19:06,240
finally getting to the fun part

533
00:19:06,240 --> 00:19:08,400
or the more fun part uh we're going to

534
00:19:08,400 --> 00:19:09,520
need a few more

535
00:19:09,520 --> 00:19:12,160
more tools for this step part of the

536
00:19:12,160 --> 00:19:14,160
reason why we spent so much time talking

537
00:19:14,160 --> 00:19:14,559
about

538
00:19:14,559 --> 00:19:16,960
communication protocols is because it's

539
00:19:16,960 --> 00:19:19,200
going to help determine our strategy

540
00:19:19,200 --> 00:19:24,480
and then also the tools that we need

541
00:19:24,480 --> 00:19:26,559
so now that we kind of have a good idea

542
00:19:26,559 --> 00:19:29,200
of what is happening on this board

543
00:19:29,200 --> 00:19:31,039
we want to talk about or we want to

544
00:19:31,039 --> 00:19:33,280
think about how we might gain access

545
00:19:33,280 --> 00:19:35,200
via methods of communication that we

546
00:19:35,200 --> 00:19:36,799
find on the data sheet in our case

547
00:19:36,799 --> 00:19:38,960
it's pretty much just that three wire

548
00:19:38,960 --> 00:19:41,840
spy uh in other cases you might have

549
00:19:41,840 --> 00:19:43,520
you know a whole list of ideas so make a

550
00:19:43,520 --> 00:19:46,799
list uh prioritize it by likelihood by

551
00:19:46,799 --> 00:19:48,000
the tools that you have

552
00:19:48,000 --> 00:19:52,400
by um uh

553
00:19:52,400 --> 00:19:55,600
what what the likely benefit or end

554
00:19:55,600 --> 00:19:57,520
result might be and then worked on your

555
00:19:57,520 --> 00:19:58,320
list

556
00:19:58,320 --> 00:20:00,240
uh but we don't have that here we

557
00:20:00,240 --> 00:20:01,760
narrowed it down to

558
00:20:01,760 --> 00:20:03,679
to two components one of them is covered

559
00:20:03,679 --> 00:20:05,360
in epoxy

560
00:20:05,360 --> 00:20:07,520
my overall goal is to re-enable the

561
00:20:07,520 --> 00:20:09,360
functionality of the mask by either

562
00:20:09,360 --> 00:20:11,440
altering the device logic in the

563
00:20:11,440 --> 00:20:12,640
microcontroller

564
00:20:12,640 --> 00:20:15,919
or increasing the stored number of uses

565
00:20:15,919 --> 00:20:17,360
left count so we can't get to the

566
00:20:17,360 --> 00:20:19,039
microcontroller right now

567
00:20:19,039 --> 00:20:22,880
um but we have pretty easy access

568
00:20:22,880 --> 00:20:26,320
to the um the doubly uh the double e

569
00:20:26,320 --> 00:20:27,520
prom

570
00:20:27,520 --> 00:20:30,480
we know how it works uh we think that it

571
00:20:30,480 --> 00:20:30,960
is

572
00:20:30,960 --> 00:20:33,520
storing what we want to uh alter so

573
00:20:33,520 --> 00:20:34,000
let's go

574
00:20:34,000 --> 00:20:38,320
with that so if this were a different

575
00:20:38,320 --> 00:20:40,480
board there'd probably be more options

576
00:20:40,480 --> 00:20:42,080
uh there might be a serial line there

577
00:20:42,080 --> 00:20:44,720
might be jtag or other debugging things

578
00:20:44,720 --> 00:20:48,000
and the reason that those methods exist

579
00:20:48,000 --> 00:20:51,280
on boards is because engineers

580
00:20:51,280 --> 00:20:52,720
usually don't get things right on the

581
00:20:52,720 --> 00:20:55,520
first time and they build in methods

582
00:20:55,520 --> 00:20:58,240
so that they can get access and debug

583
00:20:58,240 --> 00:20:59,679
things

584
00:20:59,679 --> 00:21:02,320
and hopefully hopefully for them

585
00:21:02,320 --> 00:21:04,080
hopefully for them they have turned it

586
00:21:04,080 --> 00:21:05,840
off in production

587
00:21:05,840 --> 00:21:08,720
in a way that isn't easily reversible um

588
00:21:08,720 --> 00:21:10,960
if they forgot to do that then lucky you

589
00:21:10,960 --> 00:21:13,280
um if they have done that then you need

590
00:21:13,280 --> 00:21:15,440
to find some kind of secondary flaw

591
00:21:15,440 --> 00:21:17,679
or some kind of flaw in the security of

592
00:21:17,679 --> 00:21:19,919
that access method

593
00:21:19,919 --> 00:21:23,919
to get to get to

594
00:21:23,919 --> 00:21:27,760
your get closer to your goal

595
00:21:28,640 --> 00:21:31,039
so back to our board we want to talk to

596
00:21:31,039 --> 00:21:33,120
the double eprom with three wire spy

597
00:21:33,120 --> 00:21:35,760
um we need to find a tool that does that

598
00:21:35,760 --> 00:21:37,840
the boss pirate which costs about

599
00:21:37,840 --> 00:21:41,039
20 uh does that

600
00:21:41,039 --> 00:21:42,720
so and i have one on hand so we're going

601
00:21:42,720 --> 00:21:44,799
to use that

602
00:21:44,799 --> 00:21:46,320
there are other tools depending on what

603
00:21:46,320 --> 00:21:48,159
you're trying to do for example a jtag

604
00:21:48,159 --> 00:21:49,679
later is going to look for

605
00:21:49,679 --> 00:21:52,799
some on on chip debug interfaces

606
00:21:52,799 --> 00:21:54,799
and interact with them i have a link at

607
00:21:54,799 --> 00:21:57,120
the end that

608
00:21:57,120 --> 00:21:59,360
that helps you kind of narrow down what

609
00:21:59,360 --> 00:22:01,679
you're looking for

610
00:22:01,679 --> 00:22:03,919
so the end goal on most of the devices

611
00:22:03,919 --> 00:22:05,840
not this one but most devices will be

612
00:22:05,840 --> 00:22:08,159
code execution so like i said

613
00:22:08,159 --> 00:22:10,320
um come up with a list of options and

614
00:22:10,320 --> 00:22:12,000
then prioritize them and then work your

615
00:22:12,000 --> 00:22:13,520
way down the list

616
00:22:13,520 --> 00:22:16,640
um so for this one we are going to try

617
00:22:16,640 --> 00:22:18,320
and change the account to a higher

618
00:22:18,320 --> 00:22:20,240
number and then if we can do that

619
00:22:20,240 --> 00:22:22,000
kind of build on our success and see if

620
00:22:22,000 --> 00:22:23,679
we can remove the software check all

621
00:22:23,679 --> 00:22:25,200
together

622
00:22:25,200 --> 00:22:27,679
so i know the chip i know the pins i

623
00:22:27,679 --> 00:22:29,120
soldered leads on

624
00:22:29,120 --> 00:22:31,120
which is before i got smart and ordered

625
00:22:31,120 --> 00:22:33,360
a chip clip which makes your life much

626
00:22:33,360 --> 00:22:34,710
easier

627
00:22:34,710 --> 00:22:36,480
[Music]

628
00:22:36,480 --> 00:22:39,440
anyway i don't want to go into specific

629
00:22:39,440 --> 00:22:41,200
settings here i have a blog post for

630
00:22:41,200 --> 00:22:42,240
that

631
00:22:42,240 --> 00:22:44,400
but i wanted to just read everything

632
00:22:44,400 --> 00:22:45,280
first

633
00:22:45,280 --> 00:22:47,200
so i read the data sheet figured out how

634
00:22:47,200 --> 00:22:49,520
to send a read request

635
00:22:49,520 --> 00:22:52,960
i found that everything in memory was ff

636
00:22:52,960 --> 00:22:55,120
except for four bytes

637
00:22:55,120 --> 00:22:57,679
two of them were either zero or close to

638
00:22:57,679 --> 00:22:58,880
zero so i thought that's

639
00:22:58,880 --> 00:23:01,919
probably my count the other two i wasn't

640
00:23:01,919 --> 00:23:04,480
sure about

641
00:23:04,720 --> 00:23:06,159
i read the data sheet some more i

642
00:23:06,159 --> 00:23:08,720
learned how to send a write enable

643
00:23:08,720 --> 00:23:11,280
a write message and then a write disable

644
00:23:11,280 --> 00:23:13,280
so here i'm reading location hex

645
00:23:13,280 --> 00:23:15,120
50 which was one of the count variables

646
00:23:15,120 --> 00:23:18,559
there are actually two count variables

647
00:23:18,559 --> 00:23:21,600
and then the second

648
00:23:21,600 --> 00:23:24,159
part there i am writing to the two count

649
00:23:24,159 --> 00:23:25,280
locations

650
00:23:25,280 --> 00:23:27,840
uh book ended by the write enable and

651
00:23:27,840 --> 00:23:29,280
then write disable

652
00:23:29,280 --> 00:23:31,360
um so if your first attempt doesn't work

653
00:23:31,360 --> 00:23:32,559
keep moving down the list

654
00:23:32,559 --> 00:23:35,520
this actually worked um pretty quickly

655
00:23:35,520 --> 00:23:37,440
once i figured out the protocol

656
00:23:37,440 --> 00:23:40,640
here is a photo of uh having 98 uses

657
00:23:40,640 --> 00:23:41,520
left so

658
00:23:41,520 --> 00:23:44,720
um mission accomplished

659
00:23:44,720 --> 00:23:46,240
um and i was feeling pretty good about

660
00:23:46,240 --> 00:23:48,799
my progress i made some changes

661
00:23:48,799 --> 00:23:50,320
and then i ended up in this weird air

662
00:23:50,320 --> 00:23:52,240
state where i just had two dashes on the

663
00:23:52,240 --> 00:23:54,720
display and i wouldn't turn the mask on

664
00:23:54,720 --> 00:23:56,559
um i tried programming again with

665
00:23:56,559 --> 00:23:57,919
something that worked before and it

666
00:23:57,919 --> 00:23:58,880
still didn't work

667
00:23:58,880 --> 00:24:01,200
um i read through a bunch of neutrogena

668
00:24:01,200 --> 00:24:04,240
documentation which was uh thrilling

669
00:24:04,240 --> 00:24:06,320
to trying to figure out how to reset the

670
00:24:06,320 --> 00:24:07,360
device

671
00:24:07,360 --> 00:24:08,799
um i pulled the batteries out i

672
00:24:08,799 --> 00:24:10,720
disconnected the bus pirate i waited i

673
00:24:10,720 --> 00:24:12,960
plugged it back in it still didn't work

674
00:24:12,960 --> 00:24:14,960
and what it ended up being the issue was

675
00:24:14,960 --> 00:24:16,400
that there's a capacitor

676
00:24:16,400 --> 00:24:18,480
that was charged up and i just wasn't

677
00:24:18,480 --> 00:24:19,760
waiting long enough

678
00:24:19,760 --> 00:24:22,000
for it to discharge so the system was

679
00:24:22,000 --> 00:24:25,039
never actually fully powered down

680
00:24:25,039 --> 00:24:26,559
i mean i was still working off the

681
00:24:26,559 --> 00:24:28,720
previous error state

682
00:24:28,720 --> 00:24:31,679
i realized this by measuring the doubly

683
00:24:31,679 --> 00:24:32,240
proms

684
00:24:32,240 --> 00:24:36,159
uh a power pin um so

685
00:24:36,159 --> 00:24:38,880
i shorted it out to you know fully power

686
00:24:38,880 --> 00:24:40,559
it down and then

687
00:24:40,559 --> 00:24:42,880
i was back on track so the point of the

688
00:24:42,880 --> 00:24:44,240
story isn't just to

689
00:24:44,240 --> 00:24:47,200
you know share my moment of panic but to

690
00:24:47,200 --> 00:24:48,480
point out a couple ideas that will

691
00:24:48,480 --> 00:24:50,640
probably help you later

692
00:24:50,640 --> 00:24:52,480
so the previous sections talked a lot

693
00:24:52,480 --> 00:24:54,159
about understanding things at the

694
00:24:54,159 --> 00:24:55,760
individual component level

695
00:24:55,760 --> 00:24:57,600
but you also need to understand how the

696
00:24:57,600 --> 00:24:59,840
product works as a whole

697
00:24:59,840 --> 00:25:01,760
and there might be documentation kind of

698
00:25:01,760 --> 00:25:04,799
aimed at consumers that will help you

699
00:25:04,799 --> 00:25:07,200
once you have something working you want

700
00:25:07,200 --> 00:25:08,640
to stop and write down

701
00:25:08,640 --> 00:25:11,919
exactly what you took if applicable you

702
00:25:11,919 --> 00:25:13,679
want to have a known good state that you

703
00:25:13,679 --> 00:25:14,799
can back up

704
00:25:14,799 --> 00:25:18,240
uh that you can you know revert to

705
00:25:18,240 --> 00:25:19,840
and then for electrical things you need

706
00:25:19,840 --> 00:25:21,360
to prove it out with a

707
00:25:21,360 --> 00:25:24,480
with a dmm you know if you have

708
00:25:24,480 --> 00:25:25,840
capacitors on the board

709
00:25:25,840 --> 00:25:27,360
then powering it down isn't going to be

710
00:25:27,360 --> 00:25:30,400
instantaneous and even if you know this

711
00:25:30,400 --> 00:25:32,480
uh you might forget or you might just be

712
00:25:32,480 --> 00:25:34,720
really impatient like i am

713
00:25:34,720 --> 00:25:36,960
um and harper really only cares about

714
00:25:36,960 --> 00:25:38,640
the physical reality of things so you

715
00:25:38,640 --> 00:25:41,120
need to measure it and be sure

716
00:25:41,120 --> 00:25:43,200
so at this point we're able to alter the

717
00:25:43,200 --> 00:25:45,120
double e prom and restore our activator

718
00:25:45,120 --> 00:25:46,799
to a working state

719
00:25:46,799 --> 00:25:49,840
um but if i have 98 uses left that that

720
00:25:49,840 --> 00:25:51,760
only gives me three months

721
00:25:51,760 --> 00:25:55,200
um and you know because of the bite

722
00:25:55,200 --> 00:25:57,840
and the the display that's i'm kind of

723
00:25:57,840 --> 00:25:59,120
capped at 98

724
00:25:59,120 --> 00:26:03,200
or 90 99 98. um

725
00:26:03,200 --> 00:26:04,960
so i'm trying to figure out how i can

726
00:26:04,960 --> 00:26:07,039
permanently bypass this check so i don't

727
00:26:07,039 --> 00:26:07,840
have to

728
00:26:07,840 --> 00:26:09,440
you know get out my bus prior again in

729
00:26:09,440 --> 00:26:11,360
three months and update it

730
00:26:11,360 --> 00:26:14,960
um so this is what i mean by persistence

731
00:26:14,960 --> 00:26:17,440
um if this were another device i might

732
00:26:17,440 --> 00:26:19,600
try to get to a step where

733
00:26:19,600 --> 00:26:21,120
i don't have to go through a really

734
00:26:21,120 --> 00:26:23,679
error-prone or tedious

735
00:26:23,679 --> 00:26:27,200
setup process like glitching i want to

736
00:26:27,200 --> 00:26:28,720
do something that would

737
00:26:28,720 --> 00:26:31,760
make future access for myself easier so

738
00:26:31,760 --> 00:26:34,480
i might re-enable a currently disabled

739
00:26:34,480 --> 00:26:36,720
communication method like a serial line

740
00:26:36,720 --> 00:26:37,520
or something

741
00:26:37,520 --> 00:26:40,480
i might add my own user i might use

742
00:26:40,480 --> 00:26:41,679
access for one

743
00:26:41,679 --> 00:26:43,919
component to get into a different

744
00:26:43,919 --> 00:26:46,480
component

745
00:26:47,039 --> 00:26:48,960
so for this case i didn't have quite as

746
00:26:48,960 --> 00:26:51,600
many options i didn't actually get

747
00:26:51,600 --> 00:26:53,840
persistence in the way that i wanted uh

748
00:26:53,840 --> 00:26:55,679
but i did try

749
00:26:55,679 --> 00:26:58,640
quite a few things um i looked for a

750
00:26:58,640 --> 00:26:59,600
write protect pin

751
00:26:59,600 --> 00:27:02,960
but this uh this one doesn't have it

752
00:27:02,960 --> 00:27:05,200
um i tried to cause logic errors with

753
00:27:05,200 --> 00:27:07,200
the two count values

754
00:27:07,200 --> 00:27:09,520
to see if you know maybe they they

755
00:27:09,520 --> 00:27:12,640
didn't check for some things but

756
00:27:12,640 --> 00:27:14,799
that that's actually how i got into a

757
00:27:14,799 --> 00:27:17,120
bunch of error states

758
00:27:17,120 --> 00:27:18,640
i can't do the software write protect

759
00:27:18,640 --> 00:27:20,000
because each message from the

760
00:27:20,000 --> 00:27:22,399
microcontroller is book ended

761
00:27:22,399 --> 00:27:26,880
by by the write enable and write disable

762
00:27:26,880 --> 00:27:29,200
messages i tried shorting out different

763
00:27:29,200 --> 00:27:31,039
pins one at a time to see if i could

764
00:27:31,039 --> 00:27:32,960
create some kind of unusual

765
00:27:32,960 --> 00:27:36,159
failure state um

766
00:27:36,159 --> 00:27:37,919
and i also tried changing the other two

767
00:27:37,919 --> 00:27:40,480
doubly prime values

768
00:27:40,480 --> 00:27:43,120
so what else i could have tried was to

769
00:27:43,120 --> 00:27:44,960
remove the epoxy on the micro

770
00:27:44,960 --> 00:27:46,799
controller identify it see if i could

771
00:27:46,799 --> 00:27:48,399
reprogram it

772
00:27:48,399 --> 00:27:50,720
see if i could uh dump out some of the

773
00:27:50,720 --> 00:27:52,159
information

774
00:27:52,159 --> 00:27:54,720
or you know at this point i have put

775
00:27:54,720 --> 00:27:56,640
enough work into it that maybe i should

776
00:27:56,640 --> 00:27:58,159
just like

777
00:27:58,159 --> 00:28:01,279
use a harper jumper because that will

778
00:28:01,279 --> 00:28:02,480
have uh

779
00:28:02,480 --> 00:28:05,440
solved you know my my goal of

780
00:28:05,440 --> 00:28:07,039
persistence

781
00:28:07,039 --> 00:28:09,039
so of course this section would have

782
00:28:09,039 --> 00:28:10,880
been way cooler if i actually

783
00:28:10,880 --> 00:28:13,919
um you know got persistence

784
00:28:13,919 --> 00:28:16,480
but uh i think i've reached my

785
00:28:16,480 --> 00:28:17,919
educational goal my friend didn't really

786
00:28:17,919 --> 00:28:19,200
want to use it anymore

787
00:28:19,200 --> 00:28:21,200
i'm going to chalk it up to a win and if

788
00:28:21,200 --> 00:28:23,120
i'm going to start replacing hardware

789
00:28:23,120 --> 00:28:24,799
components i might as well just put a

790
00:28:24,799 --> 00:28:26,320
switch in

791
00:28:26,320 --> 00:28:30,480
and reverse engineer some of my other

792
00:28:30,480 --> 00:28:33,039
side projects that have been lying in

793
00:28:33,039 --> 00:28:34,559
weight

794
00:28:34,559 --> 00:28:37,200
so altogether those steps are find

795
00:28:37,200 --> 00:28:38,159
something to hack

796
00:28:38,159 --> 00:28:40,000
see if you can't get multiple copies of

797
00:28:40,000 --> 00:28:41,279
it

798
00:28:41,279 --> 00:28:43,520
take it apart so you can get access to

799
00:28:43,520 --> 00:28:44,320
it

800
00:28:44,320 --> 00:28:46,720
identify what is on the board using

801
00:28:46,720 --> 00:28:48,399
reference designators

802
00:28:48,399 --> 00:28:52,320
close up photos and then googling

803
00:28:52,320 --> 00:28:54,399
read the data sheets and come up with

804
00:28:54,399 --> 00:28:57,360
some ideas of how you might get access

805
00:28:57,360 --> 00:29:00,159
make a list and just work your way down

806
00:29:00,159 --> 00:29:02,080
try to avoid the pit of despair by

807
00:29:02,080 --> 00:29:04,000
taking good notes and doing what you can

808
00:29:04,000 --> 00:29:06,240
to help you fuse yourself out

809
00:29:06,240 --> 00:29:08,159
and then see if you can't establish

810
00:29:08,159 --> 00:29:10,640
persistence or gain access to something

811
00:29:10,640 --> 00:29:12,799
else on the board and if you walk away

812
00:29:12,799 --> 00:29:13,360
from

813
00:29:13,360 --> 00:29:15,279
with nothing else from this talk

814
00:29:15,279 --> 00:29:18,000
remember to take a lot of good notes

815
00:29:18,000 --> 00:29:20,880
and get your data sheets right to help

816
00:29:20,880 --> 00:29:22,880
save time later

817
00:29:22,880 --> 00:29:25,520
so here are a couple other resources we

818
00:29:25,520 --> 00:29:27,200
have the hardware hacking village at

819
00:29:27,200 --> 00:29:28,480
defcon

820
00:29:28,480 --> 00:29:30,960
this github link which has a ton of

821
00:29:30,960 --> 00:29:32,960
great resources

822
00:29:32,960 --> 00:29:34,799
there is a book called hardware hacker

823
00:29:34,799 --> 00:29:36,159
by bunny

824
00:29:36,159 --> 00:29:38,240
grand idea studio has a bunch of cool

825
00:29:38,240 --> 00:29:39,200
guides

826
00:29:39,200 --> 00:29:41,279
if you work on your own electronic

827
00:29:41,279 --> 00:29:43,279
projects that will help as well because

828
00:29:43,279 --> 00:29:44,399
if you can

829
00:29:44,399 --> 00:29:46,480
understand how something is built it is

830
00:29:46,480 --> 00:29:48,320
way easier to break it

831
00:29:48,320 --> 00:29:50,640
um and then maybe you can try out some

832
00:29:50,640 --> 00:29:52,399
of these ideas with some hardware that

833
00:29:52,399 --> 00:29:54,880
you have lying around your house

834
00:29:54,880 --> 00:29:57,279
so that is all i hope you enjoyed this

835
00:29:57,279 --> 00:29:59,880
talk and thank you everyone so much for

836
00:29:59,880 --> 00:30:02,880
watching

