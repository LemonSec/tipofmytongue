1
00:00:11,190 --> 00:00:16,599
hi up my name is Ben Schmitt I am the
war commander security researcher

2
00:00:16,599 --> 00:00:20,250
North industries and this is Pawlikowski

3
00:00:20,250 --> 00:00:24,090
II my name is Paul Makowski

4
00:00:24,090 --> 00:00:27,210
somehow ban flipped

5
00:00:27,210 --> 00:00:31,050
into the presentation that I am
assistant to the professor

6
00:00:31,050 --> 00:00:34,160
to the present I my

7
00:00:34,160 --> 00:00:37,469
title that are industries is director

8
00:00:37,469 --> 00:00:41,950
world domination I so hopefully I'm not

9
00:00:41,950 --> 00:00:45,199
I too much of an assistant I

10
00:00:45,199 --> 00:00:48,539
and I can actually contribute on

11
00:00:48,539 --> 00:00:51,839
today we're gonna be talking about a
embedded security

12
00:00:51,839 --> 00:00:56,519
in Japanese home routers we

13
00:00:56,519 --> 00:01:00,210
that's on service a various devices and
pounce on

14
00:01:00,210 --> 00:01:05,470
we think interesting abilities or so

15
00:01:05,470 --> 00:01:08,840
the the the reason why it's kinda funny
that I missed

16
00:01:08,840 --> 00:01:13,530
this insertion on the slide about how
I'm the assistant is

17
00:01:13,530 --> 00:01:16,810
we've gone through of or revisions to
the slides

18
00:01:16,810 --> 00:01:20,000
on we've been asked to amid

19
00:01:20,000 --> 00:01:23,660
some details some bar bodies that

20
00:01:23,660 --> 00:01:27,180
I are still being coordinated with the
affected

21
00:01:27,180 --> 00:01:30,690
vendors I so

22
00:01:30,690 --> 00:01:33,890
I missed the fact that he added and the
assistant

23
00:01:33,890 --> 00:01:37,550
online four times the slides

24
00:01:37,550 --> 00:01:40,700
so still came out in the and

25
00:01:40,700 --> 00:01:44,430
worked perfectly going hand in hand with
that

26
00:01:44,430 --> 00:01:48,490
you'll see a lot of black bars in this
presentation

27
00:01:48,490 --> 00:01:51,659
I which we hope our

28
00:01:51,659 --> 00:01:55,680
I entertaining on but not as informative

29
00:01:55,680 --> 00:01:59,000
as we would have hoped we hope
eventually to

30
00:01:59,000 --> 00:02:02,220
fully release details that were on the
slide what

31
00:02:02,220 --> 00:02:06,290
for now weekend so

32
00:02:06,290 --> 00:02:10,240
in this talk we're going to cover for
the motivation behind with

33
00:02:10,240 --> 00:02:13,580
why we started doing this mostly just
because we're interested in it seemed

34
00:02:13,580 --> 00:02:17,180
on but

35
00:02:17,180 --> 00:02:22,480
we we also wanted to explore

36
00:02:22,480 --> 00:02:25,620
how fast you could go from

37
00:02:25,620 --> 00:02:29,660
absolutely no knowledge about the
embedded devices

38
00:02:29,660 --> 00:02:33,010
in a given country up to

39
00:02:33,010 --> 00:02:36,310
having remote code execution as ru

40
00:02:36,310 --> 00:02:42,750
on on many of these devices we wanted to
do this simply as an exercise that's

41
00:02:42,750 --> 00:02:44,400
what it demonstrates the

42
00:02:44,400 --> 00:02:48,980
stay a embedded security today so

43
00:02:48,980 --> 00:02:52,410
we're gonna cover sort of the landscape
as it is today

44
00:02:52,410 --> 00:02:59,400
while specifically in Japan we're going
to analyze some the attack services

45
00:02:59,400 --> 00:03:01,980
that we discovered

46
00:03:01,980 --> 00:03:05,290
some other many vulnerabilities that we
found

47
00:03:05,290 --> 00:03:08,880
during our research I and get some demos

48
00:03:08,880 --> 00:03:11,959
a how these exports work how easy they
are use

49
00:03:11,959 --> 00:03:15,069
and how powerful they are

50
00:03:15,069 --> 00:03:18,569
the access the area but again and then

51
00:03:18,569 --> 00:03:22,230
we're going to talk about all the
remediation steps that

52
00:03:22,230 --> 00:03:25,790
we hope affected thunders and really any

53
00:03:25,790 --> 00:03:30,230
embedded device manufacturers should be
used

54
00:03:30,230 --> 00:03:36,300
and should start using a certain spot so

55
00:03:36,300 --> 00:03:41,890
what did we decide to up look and act to
a Japanese routers

56
00:03:41,890 --> 00:03:45,299
well for one we we did some looking
around

57
00:03:45,299 --> 00:03:49,150
and we couldn't find very much public
research

58
00:03:49,150 --> 00:03:54,220
on the top we're only been able to find
a single blog

59
00:03:54,220 --> 00:03:57,370
that even took these devices apart

60
00:03:57,370 --> 00:04:00,880
a and posted pictures of it online

61
00:04:00,880 --> 00:04:04,989
we this is Sourav of for someone from

62
00:04:04,989 --> 00:04:08,390
the United States because we see a but

63
00:04:08,390 --> 00:04:12,690
pretty much any router that get shipped
there that you could purchase in

64
00:04:12,690 --> 00:04:17,489
in a store someone somewhere toward now
with the FCC released

65
00:04:17,489 --> 00:04:20,840
up tear down pictures that you can then
inspected

66
00:04:20,840 --> 00:04:24,700
look at by we couldn't find very much
information at all

67
00:04:24,700 --> 00:04:28,210
in are searching and also

68
00:04:28,210 --> 00:04:31,240
we're we're kind of lovers I'll junk
acting we

69
00:04:31,240 --> 00:04:34,460
take things apart because their
interesting have

70
00:04:34,460 --> 00:04:37,760
I'll some people don't

71
00:04:37,760 --> 00:04:43,380
20 a but I think it's actually very
useful exercise

72
00:04:43,380 --> 00:04:46,740
in this case it actually as very severe

73
00:04:46,740 --> 00:04:50,610
consequences these

74
00:04:50,610 --> 00:04:53,279
these routers matter a lot

75
00:04:53,279 --> 00:04:56,770
many of them listen on the way and
they're very slow

76
00:04:56,770 --> 00:05:00,419
updated they're all lot thunders
involved

77
00:05:00,419 --> 00:05:04,819
with updating they have to go through
sometimes 567

78
00:05:04,819 --> 00:05:09,279
different vendors before pat is actually
get

79
00:05:09,279 --> 00:05:13,339
implemented and then shipped back to all
those vendors before they actually get

80
00:05:13,339 --> 00:05:16,680
released to consumers and their

81
00:05:16,680 --> 00:05:21,240
are notoriously insecure Japan

82
00:05:21,240 --> 00:05:25,089
a bit mostly what we're going to focus
on during this talk is

83
00:05:25,089 --> 00:05:28,589
are you keep people are the ones that we
discover because it is one of the most

84
00:05:28,589 --> 00:05:29,749
common services

85
00:05:29,749 --> 00:05:32,949
expose on the on the way

86
00:05:32,949 --> 00:05:35,999
on the win so so

87
00:05:35,999 --> 00:05:39,580
China has an exceptional number appease

88
00:05:39,580 --> 00:05:43,809
part japan still has an impressive
numbers specially by population

89
00:05:43,809 --> 00:05:46,870
that are exposed remotely two attackers

90
00:05:46,870 --> 00:05:51,610
but we'll talk a little more about you

91
00:05:51,610 --> 00:05:55,800
so when we started this research

92
00:05:55,800 --> 00:06:00,050
we new nothing other than we thought it
might be interesting

93
00:06:00,050 --> 00:06:03,800
to look at some of these we look at
other

94
00:06:03,800 --> 00:06:07,279
embedded devices before nothing

95
00:06:07,279 --> 00:06:10,349
from Japan so this was

96
00:06:10,349 --> 00:06:13,930
new territory for us and we did this
research

97
00:06:13,930 --> 00:06:17,589
in the US where we did have ready

98
00:06:17,589 --> 00:06:21,249
access to Japanese infrastructure or

99
00:06:21,249 --> 00:06:25,769
devices so we started out I just taking
a look at for Mars

100
00:06:25,769 --> 00:06:30,099
yes a and we were in the United States

101
00:06:30,099 --> 00:06:33,199
during all this so we did not have any
access

102
00:06:33,199 --> 00:06:37,709
to hardware to play with all we had
access to

103
00:06:37,709 --> 00:06:41,039
really were for more images we were able
to

104
00:06:41,039 --> 00:06:44,399
find score and there are many barriers
that

105
00:06:44,399 --> 00:06:47,759
make it difficult to study foreign
devices

106
00:06:47,759 --> 00:06:51,430
one is very much the language it

107
00:06:51,430 --> 00:06:55,040
you need to know how to search for what
you want you need to know out

108
00:06:55,040 --> 00:06:58,300
find what you want thankfully couple
people

109
00:06:58,300 --> 00:07:01,470
at our company that could translate for
us

110
00:07:01,470 --> 00:07:05,550
but it it was somewhat difficult getting
started

111
00:07:05,550 --> 00:07:08,850
infrastructure very vary widely

112
00:07:08,850 --> 00:07:11,980
as do the devices themselves from
country to country

113
00:07:11,980 --> 00:07:15,460
others up what the internals look like
how

114
00:07:15,460 --> 00:07:18,540
how secure a they are

115
00:07:18,540 --> 00:07:22,280
how much research has been done and
obviously acquiring

116
00:07:22,280 --> 00:07:26,240
hardware things for testing was very
difficult

117
00:07:26,240 --> 00:07:29,250
especially in Japan where most of the
routers

118
00:07:29,250 --> 00:07:32,520
used by people at home or East

119
00:07:32,520 --> 00:07:35,650
rather purchased which is not the case

120
00:07:35,650 --> 00:07:39,030
in many other countries and

121
00:07:39,030 --> 00:07:42,970
all those things came together to make
it much more difficult

122
00:07:42,970 --> 00:07:46,410
study some these devices I'll and

123
00:07:46,410 --> 00:07:49,540
we did have some difficulties with power
trying

124
00:07:49,540 --> 00:07:53,300
not to set my apartment on fire we

125
00:07:53,300 --> 00:07:56,990
only little bit smokin no to plastic

126
00:07:56,990 --> 00:08:00,880
book up a power supplies soap

127
00:08:00,880 --> 00:08:04,310
your we we started with just

128
00:08:04,310 --> 00:08:07,810
firmwares by as I'll explain later

129
00:08:07,810 --> 00:08:11,090
when we tore apart the firmwares

130
00:08:11,090 --> 00:08:15,220
we decided which devices worth acquiring

131
00:08:15,220 --> 00:08:19,070
shipping to the US so

132
00:08:19,070 --> 00:08:22,200
these devices came with warning labels
like to see

133
00:08:22,200 --> 00:08:27,290
on the slide I'll and yes we kinda print
a few

134
00:08:27,290 --> 00:08:31,000
our power specs are exactly the same

135
00:08:31,000 --> 00:08:35,289
as Japanese are specs

136
00:08:35,289 --> 00:08:41,639
so I have to be more careful but
thankfully nothing

137
00:08:41,639 --> 00:08:48,470
to bat from

138
00:08:48,470 --> 00:08:51,880
from our initial looks through these
devices

139
00:08:51,880 --> 00:08:55,680
and honestly most of our prior work with
embedded devices

140
00:08:55,680 --> 00:08:59,589
there's usually very few technical

141
00:08:59,589 --> 00:09:03,829
obstacles to exportation very rarely

142
00:09:03,829 --> 00:09:07,269
do you have a hassle or address space
layout randomization

143
00:09:07,269 --> 00:09:11,089
which makes it much more difficult

144
00:09:11,089 --> 00:09:14,230
to exploit memory corruption
vulnerability is because you

145
00:09:14,230 --> 00:09:17,329
don't no where existing wise

146
00:09:17,329 --> 00:09:21,139
most of them do not have

147
00:09:21,139 --> 00:09:24,389
DEP no execute in use

148
00:09:24,389 --> 00:09:27,990
and if they do it's not complete so it's
actual way

149
00:09:27,990 --> 00:09:31,620
rather ineffective many of them

150
00:09:31,620 --> 00:09:35,130
do have stack or heap gotti's by its

151
00:09:35,130 --> 00:09:38,260
probably just because of their tool
chain

152
00:09:38,260 --> 00:09:41,630
more recent versions GCC or

153
00:09:41,630 --> 00:09:45,139
any other compilers are using should be
putting those in by the pool

154
00:09:45,139 --> 00:09:49,740
occasionally manufacturers will disable
those for Speed reasons which is

155
00:09:49,740 --> 00:09:53,810
a horrible decision by it often to

156
00:09:53,810 --> 00:09:58,899
very very often those are sometimes

157
00:09:58,899 --> 00:10:02,480
save on linking he pardoning verifying

158
00:10:02,480 --> 00:10:05,860
the he meditator that could be corrupted

159
00:10:05,860 --> 00:10:10,319
if they keep offers over 400 sometimes
unable

160
00:10:10,319 --> 00:10:14,230
it of an accidental an entirely based on

161
00:10:14,230 --> 00:10:17,420
what version I'll Lipsy or

162
00:10:17,420 --> 00:10:20,790
Lipsy the ended up using a and

163
00:10:20,790 --> 00:10:24,600
oftentimes don't use older versions
because why update

164
00:10:24,600 --> 00:10:28,380
it still works if us if it's not broken

165
00:10:28,380 --> 00:10:34,130
by exit the important thing to take away
from this slide

166
00:10:34,130 --> 00:10:38,680
is any exploit medications that are
present on these devices

167
00:10:38,680 --> 00:10:42,699
is typically accidental rather than
intentional

168
00:10:42,699 --> 00:10:46,180
day happened to you manufactures

169
00:10:46,180 --> 00:10:49,950
open to use recent GCC or

170
00:10:49,950 --> 00:10:54,550
like against reason Lipsy up but they
are not

171
00:10:54,550 --> 00:10:59,160
proactively going out try use these
medications

172
00:10:59,160 --> 00:11:02,160
I like to see on workstations us

173
00:11:02,160 --> 00:11:06,130
very different and up almost across the
board

174
00:11:06,130 --> 00:11:09,980
everything runs as we're for Speed

175
00:11:09,980 --> 00:11:14,230
a because it's much faster you do not
need to check

176
00:11:14,230 --> 00:11:17,230
permissions before you do things it so
much easier

177
00:11:17,230 --> 00:11:20,950
just run everything this is not

178
00:11:20,950 --> 00:11:25,930
good and they should be using a water
sandboxing especially

179
00:11:25,930 --> 00:11:29,529
network exposed processes and its

180
00:11:29,529 --> 00:11:32,550
also important to note that this is not
just

181
00:11:32,550 --> 00:11:37,200
on japanese embedded devices this is
kind of common across

182
00:11:37,200 --> 00:11:40,440
on that devices really

183
00:11:40,440 --> 00:11:43,930
on internationally they're very

184
00:11:43,930 --> 00:11:47,060
in a water respects but difficult or
costly

185
00:11:47,060 --> 00:11:50,830
up day and like I said if it's not
broken

186
00:11:50,830 --> 00:11:54,580
why fix it a lot of people don't feel

187
00:11:54,580 --> 00:11:57,900
need up a us there under activate ac

188
00:11:57,900 --> 00:12:01,880
unfortunately as you hear in the news
today

189
00:12:01,880 --> 00:12:05,440
a lot of times people simply art where

190
00:12:05,440 --> 00:12:08,529
under attack I so

191
00:12:08,529 --> 00:12:11,970
we're hoping I this sorter research

192
00:12:11,970 --> 00:12:15,000
Spurs I on

193
00:12:15,000 --> 00:12:18,750
in in encourages by embedded device
manufacturers

194
00:12:18,750 --> 00:12:22,330
I to you think more seriously about

195
00:12:22,330 --> 00:12:25,490
some this low-cost medications

196
00:12:25,490 --> 00:12:29,050
a

197
00:12:29,050 --> 00:12:32,470
and the landscape love embedded devices
a

198
00:12:32,470 --> 00:12:35,700
in Japan but really all over the world
about

199
00:12:35,700 --> 00:12:39,450
is what you would expect from the
Internet of Things

200
00:12:39,450 --> 00:12:44,339
a term I'm not particularly fond of but
I felt like I had to use

201
00:12:44,339 --> 00:12:47,430
the there are routers

202
00:12:47,430 --> 00:12:50,820
obviously but there's also a

203
00:12:50,820 --> 00:12:54,950
moto anything from all rooms to wifi
hotspot

204
00:12:54,950 --> 00:12:59,470
two webcams as I'm sure many people seen
at that looked at the news recently

205
00:12:59,470 --> 00:13:02,910
a even things like internet-connected
picture frames

206
00:13:02,910 --> 00:13:07,810
which surprisingly some people hooked
directly up to the internet

207
00:13:07,810 --> 00:13:10,959
and let wet

208
00:13:10,959 --> 00:13:14,290
various people do whatever they want
there's many other

209
00:13:14,290 --> 00:13:18,690
examples but these devices and there too
numerous to count and

210
00:13:18,690 --> 00:13:22,170
in the future there they're only going
to that number

211
00:13:22,170 --> 00:13:27,019
a devices ongoing to increase we even
have

212
00:13:27,019 --> 00:13:30,250
webcam in the audience back there
somebody is

213
00:13:30,250 --> 00:13:34,360
up telepresence I so these things are
ubiquitous

214
00:13:34,360 --> 00:13:38,550
I they're everywhere I so

215
00:13:38,550 --> 00:13:42,420
here is the first many black boxes

216
00:13:42,420 --> 00:13:45,589
I that you'll see in this presentation

217
00:13:45,589 --> 00:13:50,399
on so what we did is and I mention this
before

218
00:13:50,399 --> 00:13:54,079
we grabbed as many I firmwares

219
00:13:54,079 --> 00:13:59,000
as we could I from as many devices as we
could find

220
00:13:59,000 --> 00:14:02,600
I and different river revisions the
firmware

221
00:14:02,600 --> 00:14:07,560
as well op and because we didn't have
any Japanese devices on hand

222
00:14:07,560 --> 00:14:10,779
I we first set out to try to find

223
00:14:10,779 --> 00:14:13,800
out what might be the easiest to pull
apart

224
00:14:13,800 --> 00:14:17,180
firmwares and the easiest to analyze

225
00:14:17,180 --> 00:14:20,550
I and so on the

226
00:14:20,550 --> 00:14:23,829
on this live in the next one issue few
examples I

227
00:14:23,829 --> 00:14:27,020
on now these are not these are not

228
00:14:27,020 --> 00:14:31,700
the firmware second came I love our
abilities will discuss later

229
00:14:31,700 --> 00:14:35,430
I but these are just some a firmwares

230
00:14:35,430 --> 00:14:39,140
that we call the part I'm and these
farmers

231
00:14:39,140 --> 00:14:42,920
very are widely and how difficult they
are to you

232
00:14:42,920 --> 00:14:46,380
extract and allies on so on

233
00:14:46,380 --> 00:14:51,320
the easy end of the spectrum you have a
particular class a former

234
00:14:51,320 --> 00:14:54,410
I from okay I I

235
00:14:54,410 --> 00:14:56,880
this firmware I

236
00:14:56,880 --> 00:14:59,090
is distributed as a top 10

237
00:14:59,090 --> 00:15:02,730
which is actually adopt are not easy

238
00:15:02,730 --> 00:15:06,880
I just call the doc and when you
extracted

239
00:15:06,880 --> 00:15:10,360
it's just you partitions I and you can

240
00:15:10,360 --> 00:15:13,900
now these partitions and relax I and
take a look at

241
00:15:13,900 --> 00:15:17,140
all the programs and settings

242
00:15:17,140 --> 00:15:20,850
that better distributed with this with
us for more

243
00:15:20,850 --> 00:15:24,370
on now that's

244
00:15:24,370 --> 00:15:28,310
that's simple I N actually a lot of that
process is automated

245
00:15:28,310 --> 00:15:32,740
by tools like up and walk if you've ever
used

246
00:15:32,740 --> 00:15:36,080
the file I command on

247
00:15:36,080 --> 00:15:39,120
lacks systems the way that that works

248
00:15:39,120 --> 00:15:42,910
is it just looks for some magic bites

249
00:15:42,910 --> 00:15:45,990
in the file I and then we'll tell you

250
00:15:45,990 --> 00:15:49,940
what type of file it is what been walked
us

251
00:15:49,940 --> 00:15:53,480
is you will hand it a large binary blob

252
00:15:53,480 --> 00:15:57,220
and it will go bite by bite into that
blob

253
00:15:57,220 --> 00:16:00,360
and run the same file sequence

254
00:16:00,360 --> 00:16:04,080
over each by on so you may have

255
00:16:04,080 --> 00:16:07,890
a binary blob that you don't know what
it is I

256
00:16:07,890 --> 00:16:11,940
but say a hundred bites and is a TARDIS
up

257
00:16:11,940 --> 00:16:15,270
I so been walk knows

258
00:16:15,270 --> 00:16:20,000
how to extract that part in the file I
just take a look at that

259
00:16:20,000 --> 00:16:23,250
part I and then extract that

260
00:16:23,250 --> 00:16:28,150
I am and it automates the whole process

261
00:16:28,150 --> 00:16:31,580
including even mounting the filesystem
and pulling the files out

262
00:16:31,580 --> 00:16:35,730
server very simple I'm I

263
00:16:35,730 --> 00:16:39,990
so that that's on the easy side spectrum
I slightly more difficult

264
00:16:39,990 --> 00:16:43,220
is I there is a from where from

265
00:16:43,220 --> 00:16:46,280
INEC I that

266
00:16:46,280 --> 00:16:49,530
appeared as though is accredited I'm so
one

267
00:16:49,530 --> 00:16:53,960
I one recurring theme that you'll see in
this presentation is

268
00:16:53,960 --> 00:16:58,690
we did this research for fun I in our
spare time

269
00:16:58,690 --> 00:17:02,110
us we're going for the lowest hanging

270
00:17:02,110 --> 00:17:02,510
for

271
00:17:02,510 --> 00:17:05,429
the easiest margolies I

272
00:17:05,429 --> 00:17:08,730
a firmware that is and crafted

273
00:17:08,730 --> 00:17:12,280
is not the easiest our abilities to find

274
00:17:12,280 --> 00:17:16,880
I so we didn't look as hardware that's
not to say

275
00:17:16,880 --> 00:17:20,010
that there are car bilities in those
firmwares

276
00:17:20,010 --> 00:17:24,559
I but it just simply wasn't path at
least resistance

277
00:17:24,559 --> 00:17:28,209
so in that case

278
00:17:28,209 --> 00:17:31,410
I there's likely some from where that
secreted

279
00:17:31,410 --> 00:17:35,150
on now the way that you typically get
around

280
00:17:35,150 --> 00:17:38,820
back kind of scenario if you don't
understand the encryption

281
00:17:38,820 --> 00:17:41,850
is you get a device you open it up

282
00:17:41,850 --> 00:17:45,010
I and a lot of times there'll be

283
00:17:45,010 --> 00:17:48,890
Syria leads you aren't leads that you
can probe

284
00:17:48,890 --> 00:17:53,330
I and many these devices are the ones
that we tested at least

285
00:17:53,330 --> 00:17:57,150
I will simply give you a root shell on

286
00:17:57,150 --> 00:18:01,860
if you hook up to II and if there's no
serial

287
00:18:01,860 --> 00:18:05,049
a lot of times there's che tak I

288
00:18:05,049 --> 00:18:08,280
so very handy so a lot less fun

289
00:18:08,280 --> 00:18:13,640
but very on so if you're unsure how this

290
00:18:13,640 --> 00:18:17,070
firmwares encrypt it you can dump a
current installation

291
00:18:17,070 --> 00:18:21,830
I and then take a look at the algorithms
and reverse them that's not something we

292
00:18:21,830 --> 00:18:23,370
did simply because

293
00:18:23,370 --> 00:18:27,070
why try harder I'm

294
00:18:27,070 --> 00:18:30,549
I in

295
00:18:30,549 --> 00:18:35,169
in one case we took a look at a class
Buffalo firmwares

296
00:18:35,169 --> 00:18:38,750
that used I that tried to use encryption

297
00:18:38,750 --> 00:18:43,660
they didn't do it quite right I'm if
they're actually trying to protect the

298
00:18:43,660 --> 00:18:44,460
contents

299
00:18:44,460 --> 00:18:48,030
I used a modified rc4 cipher

300
00:18:48,030 --> 00:18:54,850
with a static key mackie's Buffalo

301
00:18:54,850 --> 00:18:56,740
so all of their firmware yes

302
00:18:56,740 --> 00:18:59,740
is in cryptid technically technically

303
00:18:59,740 --> 00:19:02,910
I by

304
00:19:02,910 --> 00:19:06,380
realistically it doesn't deter us

305
00:19:06,380 --> 00:19:11,429
well that's not true it can get the ball
to waste a lot of his own pot

306
00:19:11,429 --> 00:19:15,710
so I A initially tried to reverse
engineer

307
00:19:15,710 --> 00:19:19,090
this encryption on an ida

308
00:19:19,090 --> 00:19:22,190
thank you by and

309
00:19:22,190 --> 00:19:26,409
II I got to the point that I realized
that this was

310
00:19:26,409 --> 00:19:29,600
rc4 and I realized with the key was

311
00:19:29,600 --> 00:19:32,980
and it wasn't working when I try to be
crafted

312
00:19:32,980 --> 00:19:36,190
turns out a just use two more rounds

313
00:19:36,190 --> 00:19:41,100
than the normal rc4 I and we ended up
finding

314
00:19:41,100 --> 00:19:45,030
open wrt has encrypt the crips tool

315
00:19:45,030 --> 00:19:48,929
for these firmwares so I spent several
days

316
00:19:48,929 --> 00:19:52,110
trying to understand this aggression

317
00:19:52,110 --> 00:19:55,559
and there's a tool out there that did it
for us

318
00:19:55,559 --> 00:19:58,919
its open-source op

319
00:19:58,919 --> 00:20:03,010
that was my prefer yet so we use the
tool

320
00:20:03,010 --> 00:20:09,730
from then on on so this is a very small
sample

321
00:20:09,730 --> 00:20:13,870
up the different types firmware sweep
over par

322
00:20:13,870 --> 00:20:18,000
I we're going to talk about some
vulnerabilities later

323
00:20:18,000 --> 00:20:21,179
I these these examples are

324
00:20:21,179 --> 00:20:24,250
affected by those on abilities I

325
00:20:24,250 --> 00:20:27,830
and there's going to be a we're hoping
that when

326
00:20:27,830 --> 00:20:31,390
are we have a coordinated release I
later

327
00:20:31,390 --> 00:20:34,870
that we can release more information on
other firmwares

328
00:20:34,870 --> 00:20:38,220
us that people can replicate I

329
00:20:38,220 --> 00:20:44,830
the extraction process and do the right
now

330
00:20:44,830 --> 00:20:49,149
so as far as the attack surface we found
on these devices

331
00:20:49,149 --> 00:20:52,830
it's what you would expect from pretty
much

332
00:20:52,830 --> 00:20:56,840
any normal better router a you've got
HTTP

333
00:20:56,840 --> 00:21:00,240
a farce most common way to

334
00:21:00,240 --> 00:21:05,340
a configure and manage these devices in

335
00:21:05,340 --> 00:21:08,840
our research in Japan most

336
00:21:08,840 --> 00:21:12,659
these HTTP servers are actually not
exposed on the lawn

337
00:21:12,659 --> 00:21:17,049
however which greatly reduces the attack
surface

338
00:21:17,049 --> 00:21:20,470
of the routers however some

339
00:21:20,470 --> 00:21:24,519
a FTP servers were exposed which

340
00:21:24,519 --> 00:21:27,519
is a problem by UPnP by far

341
00:21:27,519 --> 00:21:32,000
was the most common better or that was
remotely exposed

342
00:21:32,000 --> 00:21:35,630
and when when facing this is

343
00:21:35,630 --> 00:21:39,289
an extremely that pro because oftentimes

344
00:21:39,289 --> 00:21:43,460
almost across the board these servers or
not well written

345
00:21:43,460 --> 00:21:47,649
they're not well tested and simply
exposing it

346
00:21:47,649 --> 00:21:51,799
on amanpour opens you up to up

347
00:21:51,799 --> 00:21:55,510
attacks that involve forwarding internal
ports

348
00:21:55,510 --> 00:21:59,929
to external interfaces which can allow
you to not only

349
00:21:59,929 --> 00:22:03,100
attack internal services on the routers

350
00:22:03,100 --> 00:22:06,309
but also attack other hoes

351
00:22:06,309 --> 00:22:09,779
inside of the network which great which

352
00:22:09,779 --> 00:22:13,110
oftentimes these hoes are not
well-protected

353
00:22:13,110 --> 00:22:16,519
they're not patch because people or why
on

354
00:22:16,519 --> 00:22:20,269
nap to protect them for all remote
attackers

355
00:22:20,269 --> 00:22:24,750
and i no longer have that barrier
between which makes it

356
00:22:24,750 --> 00:22:28,649
okay huge problems so you have file
shares the

357
00:22:28,649 --> 00:22:32,159
suddenly become expose you certainly can
exploit

358
00:22:32,159 --> 00:22:34,510
on Patch abilities

359
00:22:34,510 --> 00:22:37,810
and you can access internal web servers

360
00:22:37,810 --> 00:22:41,070
you can do what some of the really bad
things

361
00:22:41,070 --> 00:22:44,140
simply because that exposed without
actually exporting

362
00:22:44,140 --> 00:22:48,890
had a mini real so

363
00:22:48,890 --> 00:22:52,800
where definitely not the

364
00:22:52,800 --> 00:22:55,900
first people to work

365
00:22:55,900 --> 00:22:59,840
UPnP rapid7 did and awesome report

366
00:22:59,840 --> 00:23:04,470
on UPS you security couple years ago

367
00:23:04,470 --> 00:23:08,400
and their findings were definitely

368
00:23:08,400 --> 00:23:13,640
quite severe day focused on the most
widely used

369
00:23:13,640 --> 00:23:16,640
SDK is for UPnP

370
00:23:16,640 --> 00:23:22,060
up Intel many UPnP and a couple other
unknown Stks

371
00:23:22,060 --> 00:23:25,300
that basically you're Broadcom Stks

372
00:23:25,300 --> 00:23:28,700
and these a

373
00:23:28,700 --> 00:23:32,540
each one that they looked at people
found on her abilities and

374
00:23:32,540 --> 00:23:36,670
I'll and there's probably more store
existing and neck

375
00:23:36,670 --> 00:23:40,140
been looked at more that had been
previously

376
00:23:40,140 --> 00:23:43,340
but it still very dangerous to expose
that

377
00:23:43,340 --> 00:23:47,840
on the lamp or however

378
00:23:47,840 --> 00:23:51,780
we decided that not enough people looked
at

379
00:23:51,780 --> 00:23:55,780
the other category it's a very large
song for florida's

380
00:23:55,780 --> 00:23:58,920
a and oftentimes

381
00:23:58,920 --> 00:24:02,180
the is on our abilities or

382
00:24:02,180 --> 00:24:06,780
these servers have vulnerabilities and
on because no one has ever looked at

383
00:24:06,780 --> 00:24:07,250
them

384
00:24:07,250 --> 00:24:10,400
to analyze their secure no one

385
00:24:10,400 --> 00:24:13,470
has ever even tried to figure out

386
00:24:13,470 --> 00:24:16,690
who wrote the software oftentimes it's
not maintain any more

387
00:24:16,690 --> 00:24:21,100
its and all these things are still
exposed

388
00:24:21,100 --> 00:24:26,440
on up

389
00:24:26,440 --> 00:24:29,510
so up to get an idea

390
00:24:29,510 --> 00:24:33,080
a just how exposed Japan

391
00:24:33,080 --> 00:24:35,870
in particular is

392
00:24:35,870 --> 00:24:38,120
to the services we used

393
00:24:38,120 --> 00:24:41,610
sure and if you haven't heard of it
before its

394
00:24:41,610 --> 00:24:44,840
basically a search engine for for all
devices

395
00:24:44,840 --> 00:24:48,650
a you can search on common ports that

396
00:24:48,650 --> 00:24:51,680
added devices use a finds

397
00:24:51,680 --> 00:24:56,510
poor country I where these services are

398
00:24:56,510 --> 00:24:59,840
Leslie so in the case so

399
00:24:59,840 --> 00:25:04,280
are black box UPnP Dane we found

400
00:25:04,280 --> 00:25:07,650
over 3 million posts Japan

401
00:25:07,650 --> 00:25:11,060
searching for UPnP running

402
00:25:11,060 --> 00:25:14,360
running disdain and almost non

403
00:25:14,360 --> 00:25:18,070
anywhere else Columbia for some reason
has 63,000

404
00:25:18,070 --> 00:25:22,350
reported on no idea what a

405
00:25:22,350 --> 00:25:25,500
we founders to be

406
00:25:25,500 --> 00:25:28,720
very interesting because it meant that
there was a

407
00:25:28,720 --> 00:25:33,180
native a UPnP damn in that is used in
Japan

408
00:25:33,180 --> 00:25:37,970
and nowhere else which means it probably
hasn't been well

409
00:25:37,970 --> 00:25:41,000
a lot of countries show

410
00:25:41,000 --> 00:25:44,270
this very unique fingerprint

411
00:25:44,270 --> 00:25:48,340
a when it comes to be home routers used
in there

412
00:25:48,340 --> 00:25:51,840
countries because oftentimes eyes peas

413
00:25:51,840 --> 00:25:55,240
source from native manufacturers because
it's

414
00:25:55,240 --> 00:25:59,210
easier with the language barriers and

415
00:25:59,210 --> 00:26:02,660
its quicker to get whatever devices that
need

416
00:26:02,660 --> 00:26:07,280
into the country so up oftentimes what
this means is

417
00:26:07,280 --> 00:26:10,410
countries ISP infrastructure is very
unique

418
00:26:10,410 --> 00:26:14,060
to their country and it means that it
exposes

419
00:26:14,060 --> 00:26:17,400
very unique vulnerabilities that may be
overlooked

420
00:26:17,400 --> 00:26:23,170
by people looking at global however it's
very important for countries

421
00:26:23,170 --> 00:26:26,600
to will at these devices that are on it

422
00:26:26,600 --> 00:26:30,390
on their infrastructure and their
infrastructure only

423
00:26:30,390 --> 00:26:34,259
because it's someone wants to

424
00:26:34,259 --> 00:26:37,789
attack your country for some reason
there

425
00:26:37,789 --> 00:26:41,159
very definitely going to be looking for
the sport pearls

426
00:26:41,159 --> 00:26:44,820
up our own research with

427
00:26:44,820 --> 00:26:49,220
a just because showdown can sometimes
overestimate

428
00:26:49,220 --> 00:26:54,099
the number of hosts because IP addresses
may be dynamic

429
00:26:54,099 --> 00:26:57,190
change on are own research

430
00:26:57,190 --> 00:27:00,999
indicated that there were significantly
less but these devices

431
00:27:00,999 --> 00:27:04,029
them what showdown reports arm between

432
00:27:04,029 --> 00:27:07,169
to 300,000 pose however

433
00:27:07,169 --> 00:27:10,690
this is still a very very large number
I'll

434
00:27:10,690 --> 00:27:14,340
and there's any number of things that
you can do

435
00:27:14,340 --> 00:27:17,700
with a partner that is very easy to
build up

436
00:27:17,700 --> 00:27:24,700
of that size and cool talk about some so

437
00:27:24,739 --> 00:27:28,210
as you as you probably notice

438
00:27:28,210 --> 00:27:32,099
another one of the things we had to you
black box

439
00:27:32,099 --> 00:27:35,389
is the means to you identify

440
00:27:35,389 --> 00:27:38,889
this particular payment I

441
00:27:38,889 --> 00:27:42,580
so we will refer to this is the black
box

442
00:27:42,580 --> 00:27:46,489
UPnP dement I hopefully

443
00:27:46,489 --> 00:27:49,529
by in the coming months we can release

444
00:27:49,529 --> 00:27:52,979
for details up but this

445
00:27:52,979 --> 00:27:56,090
this UPnP Damon is really

446
00:27:56,090 --> 00:28:00,399
computer science security 101 I

447
00:28:00,399 --> 00:28:04,460
it is the type a program that you it
hands to you

448
00:28:04,460 --> 00:28:08,669
undergraduate students I we're learning
about buffer overflows

449
00:28:08,669 --> 00:28:11,720
are learning about for mastery tax

450
00:28:11,720 --> 00:28:15,179
and or even looking or

451
00:28:15,179 --> 00:28:18,669
logic box I pretty much

452
00:28:18,669 --> 00:28:22,529
every type upon our ability is
represented in a statement

453
00:28:22,529 --> 00:28:26,049
I and we just had fun

454
00:28:26,049 --> 00:28:30,009
trying to find as sacred

455
00:28:30,009 --> 00:28:33,940
I it turned out to be shockingly

456
00:28:33,940 --> 00:28:37,729
easy I now

457
00:28:37,729 --> 00:28:41,669
this wouldn't be so big a deal here this
Damen

458
00:28:41,669 --> 00:28:45,419
wasn't running on somewhere by our by
our research

459
00:28:45,419 --> 00:28:48,690
somewhere between two hundred and

460
00:28:48,690 --> 00:28:51,999
300,000 host in Japan

461
00:28:51,999 --> 00:28:55,409
I and listening I

462
00:28:55,409 --> 00:28:59,970
on the Internet I so without bad number
oppose

463
00:28:59,970 --> 00:29:03,299
in Japan II you know you could cause

464
00:29:03,299 --> 00:29:06,960
water damaged Japanese infrastructure
and we'll talk about

465
00:29:06,960 --> 00:29:10,159
what exactly you could do you with that
number

466
00:29:10,159 --> 00:29:14,669
posts if you met but this

467
00:29:14,669 --> 00:29:19,239
this day man has it has it has
everything I at scotts

468
00:29:19,239 --> 00:29:22,710
buffer overflows on the stack I

469
00:29:22,710 --> 00:29:26,029
if you're more into explaining offer
close on the heap it's got that

470
00:29:26,029 --> 00:29:29,849
for you too I Italian logic bogs

471
00:29:29,849 --> 00:29:34,749
I and a bunch other problems

472
00:29:34,749 --> 00:29:41,749
elsewhere other dams on the same device
services fun slide

473
00:29:42,440 --> 00:29:44,269
hack

474
00:29:44,269 --> 00:29:48,160
on

475
00:29:48,160 --> 00:29:51,440
initially this slide actually showed
some code

476
00:29:51,440 --> 00:29:57,150
I'll can you guys bought the
vulnerability its

477
00:29:57,150 --> 00:30:00,520
its more difficult now to spot the
vulnerabilities

478
00:30:00,520 --> 00:30:04,340
I so this is an

479
00:30:04,340 --> 00:30:07,460
this UPnP Damon on

480
00:30:07,460 --> 00:30:12,150
now you don't really need to know a
whole lot else

481
00:30:12,150 --> 00:30:16,810
behind those black bars I receive God's

482
00:30:16,810 --> 00:30:19,960
I an attacker control strain

483
00:30:19,960 --> 00:30:23,460
going into a sprint out I

484
00:30:23,460 --> 00:30:26,660
now this one in particular is not
bondable

485
00:30:26,660 --> 00:30:30,770
to a format string blog I because it's
going into work

486
00:30:30,770 --> 00:30:34,470
percent after are sorry percent ass I

487
00:30:34,470 --> 00:30:39,450
by you'll notice it's a sprint at I am
NOT an ass and print a

488
00:30:39,450 --> 00:30:43,190
or anything that checks bounce I

489
00:30:43,190 --> 00:30:47,130
so that's the format string equivalent I
V

490
00:30:47,130 --> 00:30:50,200
a stir copy it's just going to keep
copying

491
00:30:50,200 --> 00:30:54,380
I into its an all boy checking links

492
00:30:54,380 --> 00:30:58,060
slows you down yes I yeah

493
00:30:58,060 --> 00:31:02,030
when when you're developing an embedded
device a lot of times

494
00:31:02,030 --> 00:31:05,470
there's pressure that's BS
cost-effective

495
00:31:05,470 --> 00:31:08,970
as possible and a lot of time security
checks

496
00:31:08,970 --> 00:31:12,450
slowing down I in the financial sector

497
00:31:12,450 --> 00:31:15,980
I it actually intentional a lottery
specs

498
00:31:15,980 --> 00:31:19,470
to ignore I security checks

499
00:31:19,470 --> 00:31:23,020
I also GP use and

500
00:31:23,020 --> 00:31:26,080
and desktops what not their drivers

501
00:31:26,080 --> 00:31:29,340
potentially I met security checks in
this case

502
00:31:29,340 --> 00:31:33,770
I don't think it was it intentionally
omitted this damn and listens to

503
00:31:33,770 --> 00:31:34,790
Internet traffic

504
00:31:34,790 --> 00:31:40,560
so if it was intentional it should not
so

505
00:31:40,560 --> 00:31:43,259
I the next

506
00:31:43,259 --> 00:31:48,799
talk about though at alright so

507
00:31:48,799 --> 00:31:52,220
behind this black are right there
there's a offer

508
00:31:52,220 --> 00:31:56,399
I an app offers on the stack so

509
00:31:56,399 --> 00:31:59,940
this sprint F is going to you copy

510
00:31:59,940 --> 00:32:03,419
an attacker control black onto a stack
buffer

511
00:32:03,419 --> 00:32:07,860
and we all know what kinda fun you can
have with that

512
00:32:07,860 --> 00:32:11,990
so thats that's one of our abilities

513
00:32:11,990 --> 00:32:16,289
I'm gonna telling you the answers here
because we blacked out

514
00:32:16,289 --> 00:32:19,710
of the actual code up

515
00:32:19,710 --> 00:32:24,039
I yes so there's

516
00:32:24,039 --> 00:32:27,940
a so the attacker controls to different
spread ass

517
00:32:27,940 --> 00:32:31,450
overflows two different offers I'll

518
00:32:31,450 --> 00:32:34,850
so that's that's fine and you can use
this

519
00:32:34,850 --> 00:32:38,119
these on abilities to gain code
execution I

520
00:32:38,119 --> 00:32:41,230
bytes what you don't see in

521
00:32:41,230 --> 00:32:46,289
it's covered in black is this particular
function has stack Okies

522
00:32:46,289 --> 00:32:49,499
I'm so you you have to have some kind of
evasion

523
00:32:49,499 --> 00:32:54,119
stack news and that's hard and we are
trying really hard

524
00:32:54,119 --> 00:32:58,039
we wanted to you get easy

525
00:32:58,039 --> 00:33:01,899
when on so why try harder

526
00:33:01,899 --> 00:33:04,980
up Soria

527
00:33:04,980 --> 00:33:08,080
great I so why try harder I

528
00:33:08,080 --> 00:33:11,279
the string that's being sprint after
into you

529
00:33:11,279 --> 00:33:15,330
is passed directly to system I

530
00:33:15,330 --> 00:33:19,090
so this day manuel take traffic from the
internet

531
00:33:19,090 --> 00:33:23,519
stamens running as root and we'll pass
it directly

532
00:33:23,519 --> 00:33:26,710
into you system and it will XQ

533
00:33:26,710 --> 00:33:29,879
any command that you get and

534
00:33:29,879 --> 00:33:33,350
we found this function initially the
first thing we do

535
00:33:33,350 --> 00:33:37,669
was search for calls to system and the
first one we looked at

536
00:33:37,669 --> 00:33:40,720
with this

537
00:33:40,720 --> 00:33:42,630
so ahead again so

538
00:33:42,630 --> 00:33:47,330
a and also there so

539
00:33:47,330 --> 00:33:51,230
you've got to buffer overflows I

540
00:33:51,230 --> 00:33:54,560
to command injections and it one more
time

541
00:33:54,560 --> 00:33:58,510
in four lines Co I

542
00:33:58,510 --> 00:34:01,960
so I

543
00:34:01,960 --> 00:34:06,130
year wide why try harder this this is
the easiest

544
00:34:06,130 --> 00:34:11,600
I these are the easiest box to exploit
and this is how we initially

545
00:34:11,600 --> 00:34:14,690
gained code execution on this particular

546
00:34:14,690 --> 00:34:19,120
or mobile device I and we use that code
execution if I'm

547
00:34:19,120 --> 00:34:22,900
more so the vulnerabilities don't stop
here

548
00:34:22,900 --> 00:34:26,000
I including there's more vulnerabilities

549
00:34:26,000 --> 00:34:29,100
and UPnP Damon itself

550
00:34:29,100 --> 00:34:32,319
I by weary

551
00:34:32,320 --> 00:34:35,940
one on the UPnP damn why try to find
more

552
00:34:35,940 --> 00:34:39,170
us so we started looking at the other
demands

553
00:34:39,170 --> 00:34:43,500
that were less I and that includes an
HTTP

554
00:34:43,500 --> 00:34:47,260
so

555
00:34:47,260 --> 00:34:51,250
before we get to the HTTP box I wanna
show you a little

556
00:34:51,250 --> 00:34:55,310
down now in this is going to be

557
00:34:55,310 --> 00:34:59,430
I because we're omitting the details of
the viability

558
00:34:59,430 --> 00:35:03,370
and how to trigger this is going to be

559
00:35:03,370 --> 00:35:06,910
a very plane very boring

560
00:35:06,910 --> 00:35:10,660
it here you have to trust us

561
00:35:10,660 --> 00:35:16,290
we are actually running export okay so
what we're doing here

562
00:35:16,290 --> 00:35:21,830
if you can say okay so we have an
exploit call

563
00:35:21,830 --> 00:35:25,950
shelled out here why we had acquired

564
00:35:25,950 --> 00:35:29,710
this Japanese I device and

565
00:35:29,710 --> 00:35:33,820
it is on our local network I we're not
doing this over the Internet

566
00:35:33,820 --> 00:35:36,059
you

567
00:35:36,059 --> 00:35:39,270
I and we're on our expert against it

568
00:35:39,270 --> 00:35:43,440
and

569
00:35:43,440 --> 00:35:47,250
we get a root shell I so

570
00:35:47,250 --> 00:35:51,349
back to just a few seconds I and what
we're exporting their

571
00:35:51,349 --> 00:35:55,440
is the vulnerabilities we just discussed
where

572
00:35:55,440 --> 00:35:58,450
we have command injection I

573
00:35:58,450 --> 00:36:01,540
so we we're on a few commands to
demonstrate

574
00:36:01,540 --> 00:36:05,170
that we are in fact a rear on this
device

575
00:36:05,170 --> 00:36:10,730
I and that's it for that demo

576
00:36:10,730 --> 00:36:14,050
should pop

577
00:36:14,050 --> 00:36:17,430
I you know I if I did show you

578
00:36:17,430 --> 00:36:20,869
dick exploit code it would be really
boring as well

579
00:36:20,869 --> 00:36:25,220
on because it is so simple I

580
00:36:25,220 --> 00:36:28,740
its that's how many wines

581
00:36:28,740 --> 00:36:33,079
at the axe the exploit is also probably
about four lines

582
00:36:33,079 --> 00:36:36,579
aka alright a

583
00:36:36,579 --> 00:36:40,150
so the fun doesn't stop there though I
am

584
00:36:40,150 --> 00:36:43,869
there's other demands running on this
device I'll

585
00:36:43,869 --> 00:36:48,290
why don't we take a look at that so now
that we have

586
00:36:48,290 --> 00:36:51,410
a virtual on this device we can try

587
00:36:51,410 --> 00:36:54,619
probing other dams I and

588
00:36:54,619 --> 00:36:58,020
dynamically executing them I

589
00:36:58,020 --> 00:37:01,790
the vendor who by built this device was
kind enough

590
00:37:01,790 --> 00:37:06,150
to include GDP server on the device

591
00:37:06,150 --> 00:37:09,609
so we can even set up Remo GDP

592
00:37:09,609 --> 00:37:12,970
debugging connections I

593
00:37:12,970 --> 00:37:16,910
to these dams that's very helpful I'm

594
00:37:16,910 --> 00:37:21,230
now this this device had an HTTP server
as well

595
00:37:21,230 --> 00:37:24,549
this HTTP Server was not listening on
the Internet

596
00:37:24,549 --> 00:37:29,270
by the fall I but that doesn't matter

597
00:37:29,270 --> 00:37:33,680
so much I so like ban had said before

598
00:37:33,680 --> 00:37:37,849
the fact that this device is listening
to the Internet

599
00:37:37,849 --> 00:37:41,480
I for UPnP I means that's

600
00:37:41,480 --> 00:37:44,890
this device can potentially be
reconfigured

601
00:37:44,890 --> 00:37:48,070
are 24 courts

602
00:37:48,070 --> 00:37:51,060
out to the internal network including
its own course

603
00:37:51,060 --> 00:37:54,610
I so you have this HTTP Server

604
00:37:54,610 --> 00:37:58,350
running that supposed to only be
listening on the lawn

605
00:37:58,350 --> 00:38:03,630
you have you can't P server that's
listening to commands from the internet

606
00:38:03,630 --> 00:38:07,810
you can instruct the UPnP server 24

607
00:38:07,810 --> 00:38:11,690
Lamport to the Internet so

608
00:38:11,690 --> 00:38:15,010
this HTTP server by default is not
listening

609
00:38:15,010 --> 00:38:18,490
to your by you can cause it

610
00:38:18,490 --> 00:38:22,680
to us I so we found several bar

611
00:38:22,680 --> 00:38:27,250
odious I in this damn and as well this
Damen

612
00:38:27,250 --> 00:38:31,110
is another I indigenous

613
00:38:31,110 --> 00:38:34,210
a very unique I to Japan

614
00:38:34,210 --> 00:38:38,270
I Damon I anyways

615
00:38:38,270 --> 00:38:41,470
it was clearly Britain it was
purpose-built

616
00:38:41,470 --> 00:38:46,230
I for these invented devices it wasn't

617
00:38:46,230 --> 00:38:50,230
it's not a patchy it's not and jacks
it's not I S

618
00:38:50,230 --> 00:38:54,390
or anything famous II it was actually a
pretty

619
00:38:54,390 --> 00:38:58,080
difficult I and we spent some time
trying to figure out

620
00:38:58,080 --> 00:39:01,500
are who the vendor was that wrote
stammen

621
00:39:01,500 --> 00:39:04,940
and the UPnP dan because we wanted to
tell them about these

622
00:39:04,940 --> 00:39:08,360
Ellis I and they can put their name
anywhere

623
00:39:08,360 --> 00:39:12,370
in the buyers so it's very difficult to
track down

624
00:39:12,370 --> 00:39:15,840
on said this

625
00:39:15,840 --> 00:39:20,570
this bug I it's an interesting blog I so
in this case

626
00:39:20,570 --> 00:39:23,930
a seemingly actually tried I

627
00:39:23,930 --> 00:39:27,660
for security I by day

628
00:39:27,660 --> 00:39:32,130
made a mistake so the HTTP Damen

629
00:39:32,130 --> 00:39:35,140
I if you issue a get command

630
00:39:35,140 --> 00:39:38,670
I to the HD again it will copy

631
00:39:38,670 --> 00:39:41,850
the on path that you requested

632
00:39:41,850 --> 00:39:45,640
into a heap buffer the problem is

633
00:39:45,640 --> 00:39:48,960
that heap buffer is sized according to
you

634
00:39:48,960 --> 00:39:53,410
the content black header you pass to the
device

635
00:39:53,410 --> 00:39:56,890
as part of the request

636
00:39:56,890 --> 00:39:59,590
so there's a sanity check that checks to
see

637
00:39:59,590 --> 00:40:03,710
whether or not the Bosphorus
sufficiently sized

638
00:40:03,710 --> 00:40:07,470
to Whole the path that's going to be
copied into it

639
00:40:07,470 --> 00:40:12,200
the problem is on after that sanity
check

640
00:40:12,200 --> 00:40:15,310
the size is promoted from unsigned
integer

641
00:40:15,310 --> 00:40:18,830
unsigned integer and Battlax

642
00:40:18,830 --> 00:40:22,030
the unsigned like is copied into the
buffer

643
00:40:22,030 --> 00:40:25,410
on so II

644
00:40:25,410 --> 00:40:29,310
causes massive overflow

645
00:40:29,310 --> 00:40:33,380
and just destroys the process space I so

646
00:40:33,380 --> 00:40:37,440
the up for the reason we decided to

647
00:40:37,440 --> 00:40:43,570
show this one is because X portability
is difficult in this case

648
00:40:43,570 --> 00:40:46,570
however a it the

649
00:40:46,570 --> 00:40:50,250
per concert so sure that it gives you an
idea

650
00:40:50,250 --> 00:40:53,330
how many vulnerabilities are present

651
00:40:53,330 --> 00:40:57,000
stay at it should be noted all of these

652
00:40:57,000 --> 00:41:00,100
a on abilities state been reported

653
00:41:00,100 --> 00:41:03,200
I and where we've

654
00:41:03,200 --> 00:41:07,460
coordinated disclosure with the affected
parties party that

655
00:41:07,460 --> 00:41:11,130
is all the black bars you see today on

656
00:41:11,130 --> 00:41:15,220
I and where omitting details about how
you

657
00:41:15,220 --> 00:41:18,470
arm fingerprint the stands I

658
00:41:18,470 --> 00:41:22,500
so we don't want people to take
malicious use of this information

659
00:41:22,500 --> 00:41:27,210
but we wanted to provide you with some
kind idea of this is there any

660
00:41:27,210 --> 00:41:30,310
issues playing these devices

661
00:41:30,310 --> 00:41:33,450
on so like I mentioned before

662
00:41:33,450 --> 00:41:36,920
I there is a sinus comparison issue

663
00:41:36,920 --> 00:41:40,380
in the content-length header so specify

664
00:41:40,380 --> 00:41:44,460
and negative content black it's going to
you

665
00:41:44,460 --> 00:41:49,090
improperly allocate keep offer and then
it's going to you

666
00:41:49,090 --> 00:41:52,970
copy I way too much data

667
00:41:52,970 --> 00:41:56,140
finisher so this this is

668
00:41:56,140 --> 00:42:01,260
this is slightly longer than our other
proof of concept this is pipelines

669
00:42:01,260 --> 00:42:05,150
our previous exploit was for

670
00:42:05,150 --> 00:42:12,150
I'll so we're getting into really
complex territory here

671
00:42:13,120 --> 00:42:15,880
so we have a demo of this one well

672
00:42:15,880 --> 00:42:19,310
drop

673
00:42:19,310 --> 00:42:26,310
we jump now good so this one is slightly
more interesting

674
00:42:27,170 --> 00:42:30,280
I we have previously shown you getting

675
00:42:30,280 --> 00:42:34,430
a root shell buyer UPnP vulnerability

676
00:42:34,430 --> 00:42:38,850
I now we're going to use that same
vulnerability to get the average shell

677
00:42:38,850 --> 00:42:42,500
I am never going to do more things with
it

678
00:42:42,500 --> 00:42:48,110
okay

679
00:42:48,110 --> 00:42:51,350
so in the top the top left

680
00:42:51,350 --> 00:42:56,290
we have that we're showing an and that
was the UPnP viability

681
00:42:56,290 --> 00:43:01,830
I now in the bottom left I'll

682
00:43:01,830 --> 00:43:05,030
we are setting up by GDP on

683
00:43:05,030 --> 00:43:09,200
are I on our testing laptop

684
00:43:09,200 --> 00:43:14,180
switching back to the top left we do a
process

685
00:43:14,180 --> 00:43:17,890
spank and determine what the

686
00:43:17,890 --> 00:43:21,050
process ID is love the

687
00:43:21,050 --> 00:43:28,050
HTTP server

688
00:43:32,050 --> 00:43:35,810
so what we have in the top left is we
had attached

689
00:43:35,810 --> 00:43:39,470
I on gdb server

690
00:43:39,470 --> 00:43:43,160
to the affected by Aaron I

691
00:43:43,160 --> 00:43:47,580
and in the bottom left we are doing a
remote

692
00:43:47,580 --> 00:43:54,580
debugging session with the device

693
00:43:58,970 --> 00:44:02,140
and as you can probably tell from
previous lights

694
00:44:02,140 --> 00:44:05,660
this particular device in our device a

695
00:44:05,660 --> 00:44:09,220
so were using say

696
00:44:09,220 --> 00:44:12,570
version up GDP compile

697
00:44:12,570 --> 00:44:16,500
our support alright so

698
00:44:16,500 --> 00:44:21,000
we have up we have control over

699
00:44:21,000 --> 00:44:24,800
the execution of this damn and now we
open at

700
00:44:24,800 --> 00:44:30,490
last term all and we sand the contents
of what was on the previous slide

701
00:44:30,490 --> 00:44:33,540
which is and he overflowed up by:

702
00:44:33,540 --> 00:44:37,700
I and as you can see in the bottom left
slide

703
00:44:37,700 --> 00:44:41,750
we cause a sec fall in a damn

704
00:44:41,750 --> 00:44:44,930
we can actually

705
00:44:44,930 --> 00:44:49,520
time we can actually take this too

706
00:44:49,520 --> 00:44:52,750
for code execution I because we already
had ok

707
00:44:52,750 --> 00:44:59,750
execution so again why try harder

708
00:45:01,630 --> 00:45:06,510
occur

709
00:45:06,510 --> 00:45:09,280
so this http Damen I

710
00:45:09,280 --> 00:45:12,730
I mentioned there was some logic on
abilities as well

711
00:45:12,730 --> 00:45:16,640
I and I this is just your standard

712
00:45:16,640 --> 00:45:20,500
lol after rehearsal our ability I so

713
00:45:20,500 --> 00:45:24,780
I this is another computer science
security 101 problem

714
00:45:24,780 --> 00:45:28,010
on if you specify

715
00:45:28,010 --> 00:45:32,620
a path that you're going to request that
is outside

716
00:45:32,620 --> 00:45:35,720
HTTP route on the

717
00:45:35,720 --> 00:45:39,710
HTTP Damen should not serve you that
path I

718
00:45:39,710 --> 00:45:43,880
this damon does on and the proof of
concept

719
00:45:43,880 --> 00:45:47,220
offer this far Billy is our shortest one
yet

720
00:45:47,220 --> 00:45:50,260
I it is two lines

721
00:45:50,260 --> 00:45:54,330
so what we have here

722
00:45:54,330 --> 00:45:57,850
is I you just import pipe on request

723
00:45:57,850 --> 00:46:00,930
and then what we're requesting is
outsider

724
00:46:00,930 --> 00:46:05,420
a the HTTP rear we use the dot dot slash
to get outside a bit

725
00:46:05,420 --> 00:46:08,780
and then requesting this XML file

726
00:46:08,780 --> 00:46:12,740
and that at XML file contains passwords

727
00:46:12,740 --> 00:46:15,930
I'm so if you're on the local network

728
00:46:15,930 --> 00:46:20,920
I or if your remote attacker but if
you're on a local network

729
00:46:20,920 --> 00:46:24,500
you can make this request to your
friends

730
00:46:24,500 --> 00:46:27,920
I or your enemies I

731
00:46:27,920 --> 00:46:32,720
I router and I get there

732
00:46:32,720 --> 00:46:37,340
admin password for the router so

733
00:46:37,340 --> 00:46:40,860
that's not good you I and we have

734
00:46:40,860 --> 00:46:44,460
a demo for this as well miss our last

735
00:46:44,460 --> 00:46:48,200
so we don't

736
00:46:48,200 --> 00:46:51,570
actually request the file I showed you

737
00:46:51,570 --> 00:46:55,460
I again this is just getting an
interactive rich shell

738
00:46:55,460 --> 00:46:58,910
now in this case

739
00:46:58,910 --> 00:47:02,710
we echo to into you slashed am

740
00:47:02,710 --> 00:47:08,780
slash bar just as a demo and then in our
other terminal

741
00:47:08,780 --> 00:47:13,370
we issue what I showed on the last slide

742
00:47:13,370 --> 00:47:18,070
and we get the contents slash champs
last part

743
00:47:18,070 --> 00:47:21,150
this becomes even more fun when you
start dumping

744
00:47:21,150 --> 00:47:25,910
things like def came which is

745
00:47:25,910 --> 00:47:32,910
directly dumping culinary jazz on so

746
00:47:35,450 --> 00:47:40,340
why does this matter well you can do a
lot of things with

747
00:47:40,340 --> 00:47:44,540
to under to 300,000 and

748
00:47:44,540 --> 00:47:48,640
even more so when they're when they're
home routers that are protecting

749
00:47:48,640 --> 00:47:53,590
a large number of other devices on at
work first of all

750
00:47:53,590 --> 00:47:57,980
you can very clearly violate the privacy
thousands of people

751
00:47:57,980 --> 00:48:01,119
and capture all the traffic

752
00:48:01,119 --> 00:48:05,450
entering and leaving this also allows
you to

753
00:48:05,450 --> 00:48:09,600
impersonate the people who are using
these devices

754
00:48:09,600 --> 00:48:14,090
you can man in the middle there
connections exploit

755
00:48:14,090 --> 00:48:17,540
and hosts on the network so that you can
build in

756
00:48:17,540 --> 00:48:21,390
larger partner you could

757
00:48:21,390 --> 00:48:25,300
use this as a way to hide the true
source

758
00:48:25,300 --> 00:48:28,750
other attacks by routing them through
these devices

759
00:48:28,750 --> 00:48:32,190
make it appear that innocent

760
00:48:32,190 --> 00:48:36,710
home a a all voters and

761
00:48:36,710 --> 00:48:39,720
people with these devices a

762
00:48:39,720 --> 00:48:43,040
are initiating attacks that they're
coming from Japan

763
00:48:43,040 --> 00:48:46,609
when they could be coming from anywhere
in the world and

764
00:48:46,609 --> 00:48:50,200
possibly worsen worse the ball it could
very well

765
00:48:50,200 --> 00:48:53,900
cripple national infrastructure because
at this year about

766
00:48:53,900 --> 00:48:57,010
a data that you're able to send

767
00:48:57,010 --> 00:49:00,420
from these devices japan is very lucky
to have

768
00:49:00,420 --> 00:49:04,140
very many many high-speed connections

769
00:49:04,140 --> 00:49:07,619
to the Internet however this creates
problems when

770
00:49:07,619 --> 00:49:11,840
many hosts on those networks are
compromised

771
00:49:11,840 --> 00:49:15,950
because very quickly you can gather a
large amount a band with

772
00:49:15,950 --> 00:49:20,130
that could takeout a for even very very
large

773
00:49:20,130 --> 00:49:24,290
website for important important

774
00:49:24,290 --> 00:49:30,170
a sites across the world just a few more

775
00:49:30,170 --> 00:49:35,330
Japanese statistics that we gather as
we've said many times

776
00:49:35,330 --> 00:49:38,470
two to three hundred thousand these are
running

777
00:49:38,470 --> 00:49:43,880
the viral UPnP service on the lawn
upwards of 500,000

778
00:49:43,880 --> 00:49:47,010
are running just any UPnP server

779
00:49:47,010 --> 00:49:51,359
which as we've said many times is very
dangerous to do

780
00:49:51,359 --> 00:49:56,040
we did we did notice the most common
service

781
00:49:56,040 --> 00:50:01,090
that was exposed is http however the
vast majority of the servers

782
00:50:01,090 --> 00:50:05,010
are normal web servers for your favorite
web sites

783
00:50:05,010 --> 00:50:08,310
aren't very few of them are actually
modems

784
00:50:08,310 --> 00:50:14,820
or router that expose the services so

785
00:50:14,820 --> 00:50:19,500
so where do you go from here a yes

786
00:50:19,500 --> 00:50:22,590
so as discussed before I'm

787
00:50:22,590 --> 00:50:26,030
the UPnP Damen particular has

788
00:50:26,030 --> 00:50:31,630
every type on our ability in the book
we're

789
00:50:31,630 --> 00:50:35,700
which recommends to people building
these devices that

790
00:50:35,700 --> 00:50:40,450
you know there there are open source
ready to use

791
00:50:40,450 --> 00:50:43,830
stacks out there programs out there

792
00:50:43,830 --> 00:50:47,150
for doing you can pay I'll and they're
well

793
00:50:47,150 --> 00:50:50,810
much much better study I so

794
00:50:50,810 --> 00:50:54,400
II and like we said before

795
00:50:54,400 --> 00:50:57,609
our bill is that we found in talked
about here

796
00:50:57,609 --> 00:51:01,390
I literally we threw into

797
00:51:01,390 --> 00:51:08,180
IDA Pro and control for system

798
00:51:08,180 --> 00:51:09,040
so it's

799
00:51:09,040 --> 00:51:13,520
its its its I came here gonna win

800
00:51:13,520 --> 00:51:17,740
trying to patch these marvelous I
frankly somebody's Damon's

801
00:51:17,740 --> 00:51:21,900
you just need to start over %ah

802
00:51:21,900 --> 00:51:26,370
another thing you can do

803
00:51:26,370 --> 00:51:29,510
I to shore up the defense's

804
00:51:29,510 --> 00:51:33,640
is employing modern exploit medications

805
00:51:33,640 --> 00:51:37,040
there's been a lot of development in
this realm

806
00:51:37,040 --> 00:51:41,490
workstation space desktops laptops

807
00:51:41,490 --> 00:51:44,680
I you know when you're browsing the
internet I

808
00:51:44,680 --> 00:51:48,420
and you're using for example chrome I

809
00:51:48,420 --> 00:51:51,620
web pages are rendered and a

810
00:51:51,620 --> 00:51:54,870
the privileged process their sandbox

811
00:51:54,870 --> 00:51:58,110
these concepts do not

812
00:51:58,110 --> 00:52:02,970
appear any embedded world but there's no
reason why they couldn't

813
00:52:02,970 --> 00:52:06,430
so there's

814
00:52:06,430 --> 00:52:10,140
so make it more difficult to exploit in
the first place

815
00:52:10,140 --> 00:52:13,290
and any in userspace that

816
00:52:13,290 --> 00:52:16,810
amounts to no excuse I

817
00:52:16,810 --> 00:52:20,850
keep using this tack and keep cookies
employ

818
00:52:20,850 --> 00:52:26,440
to lasso are or one one problem that a
lot of people run into is

819
00:52:26,440 --> 00:52:29,560
I they think they've been able ass or

820
00:52:29,560 --> 00:52:33,200
enabling it on when X I

821
00:52:33,200 --> 00:52:36,610
in the kernel is actually insufficient I

822
00:52:36,610 --> 00:52:41,060
you also have to compile binaries that
you want to randomize

823
00:52:41,060 --> 00:52:44,820
as PI as position independent excusable

824
00:52:44,820 --> 00:52:48,310
if you don't do that the dot text

825
00:52:48,310 --> 00:52:51,560
segment the program is not randomized
and

826
00:52:51,560 --> 00:52:54,800
less than full ass OR is

827
00:52:54,800 --> 00:52:58,060
about as useful as an OS or

828
00:52:58,060 --> 00:53:02,160
and then in the kernel space

829
00:53:02,160 --> 00:53:06,070
I we're actually having a discussion
about this last night

830
00:53:06,070 --> 00:53:09,680
there's a series of patches if using wax

831
00:53:09,680 --> 00:53:14,560
that we recommend we're on

832
00:53:14,560 --> 00:53:18,630
frankly I that at a lot of these
medications

833
00:53:18,630 --> 00:53:22,300
to you stock man limewax

834
00:53:22,300 --> 00:53:26,040
and there's a lot to be said on that and
if you're curious

835
00:53:26,040 --> 00:53:29,410
talk to you after for hours for hours

836
00:53:29,410 --> 00:53:32,730
I but another thing to do

837
00:53:32,730 --> 00:53:38,070
is fail closed use UPnP tenants are
listening on the Internet

838
00:53:38,070 --> 00:53:42,500
I we kinda doubt that that's actually
necessary

839
00:53:42,500 --> 00:53:46,450
I it's not they had separate

840
00:53:46,450 --> 00:53:50,770
update mechanisms UPnP Damen is not
there update mechanism

841
00:53:50,770 --> 00:53:54,810
frankly the update mechanism should
probably be

842
00:53:54,810 --> 00:53:57,960
only thing if if anything at all

843
00:53:57,960 --> 00:54:02,740
I the update mechanism should be the
only thing listening on the Internet

844
00:54:02,740 --> 00:54:05,940
and

845
00:54:05,940 --> 00:54:09,580
I if you do you have I update systems if
you have

846
00:54:09,580 --> 00:54:12,840
if you happen need to do remote
administration

847
00:54:12,840 --> 00:54:16,620
ISP sometimes require this I

848
00:54:16,620 --> 00:54:20,900
then do so with you know key based
authentication

849
00:54:20,900 --> 00:54:27,900
and there's proven options out there

850
00:54:29,029 --> 00:54:32,920
up like we said before there's no reason
to run everything is root

851
00:54:32,920 --> 00:54:35,970
I you know II

852
00:54:35,970 --> 00:54:39,099
even with those command injection
vulnerabilities

853
00:54:39,099 --> 00:54:42,769
if that UPnP game and risk running as
the user

854
00:54:42,769 --> 00:54:46,749
nobody I'll we probably wouldn't be able
to do a lot

855
00:54:46,749 --> 00:54:50,730
but it's running as root I

856
00:54:50,730 --> 00:54:55,849
as much as possible sandbox thanks
chrome does this

857
00:54:55,849 --> 00:54:59,759
spreading to a lot of other programs
Adobe Reader

858
00:54:59,759 --> 00:55:02,960
does this actually uses crimes

859
00:55:02,960 --> 00:55:06,039
sandbox to a certain extent I

860
00:55:06,039 --> 00:55:09,170
on 1x this is implemented a sec cop

861
00:55:09,170 --> 00:55:12,460
PPF I on Windows

862
00:55:12,460 --> 00:55:15,569
I actually have a proper sandboxing

863
00:55:15,569 --> 00:55:20,200
some people might are you with me on
that they have

864
00:55:20,200 --> 00:55:24,829
integrity levels which is close I

865
00:55:24,829 --> 00:55:29,759
and then on our stand there's seatbelt
profiles and then

866
00:55:29,759 --> 00:55:32,779
finally I if there is an open source

867
00:55:32,779 --> 00:55:36,369
tool that you can use it FTP HTTP

868
00:55:36,369 --> 00:55:39,499
UPnP game in I

869
00:55:39,499 --> 00:55:43,599
use that often they're more on it

870
00:55:43,599 --> 00:55:47,430
I and more importantly I as the vendor

871
00:55:47,430 --> 00:55:50,690
you get burned because there's a
viability

872
00:55:50,690 --> 00:55:54,660
in shared code I it doesn't look as bad

873
00:55:54,660 --> 00:56:01,660
because everyone ransack

874
00:56:02,920 --> 00:56:04,630
okay I guess a few more

875
00:56:04,630 --> 00:56:08,059
suggestions I on

876
00:56:08,059 --> 00:56:12,769
John wills here encrypt

877
00:56:12,769 --> 00:56:16,739
ensign firmware that would make it more
difficult for us to do this analysis

878
00:56:16,739 --> 00:56:21,469
I better physical access don't allow us
to get

879
00:56:21,469 --> 00:56:24,670
rich shells by just plugging into you
arts

880
00:56:24,670 --> 00:56:28,150
I don't activist attack

881
00:56:28,150 --> 00:56:31,359
I and

882
00:56:31,359 --> 00:56:35,459
II whenever possible don't right things
and

883
00:56:35,459 --> 00:56:41,099
memory on safe languages right in Python
or

884
00:56:41,099 --> 00:56:44,789
in Japan reviews very popular read it in
Ruby

885
00:56:44,789 --> 00:56:48,109
there are fewer classes abilities

886
00:56:48,109 --> 00:56:55,109
that you might expose a

887
00:56:58,469 --> 00:57:02,259
what doesn't work is I trying to you

888
00:57:02,259 --> 00:57:07,509
make it difficult to extract from wheres
on that will just the way people

889
00:57:07,509 --> 00:57:11,630
and by

890
00:57:11,630 --> 00:57:15,099
owning in first packing infrastructure
is very much

891
00:57:15,099 --> 00:57:18,430
invoke now very popular I

892
00:57:18,430 --> 00:57:22,160
as endpoints as workstations have become
more hardened

893
00:57:22,160 --> 00:57:25,779
it's important to you also take a look
at what sits between

894
00:57:25,779 --> 00:57:32,779
you and their I'm

895
00:57:33,049 --> 00:57:36,369
before we the of up

896
00:57:36,369 --> 00:57:40,660
borrow everything off protector that
protect everything in your internal

897
00:57:40,660 --> 00:57:41,219
network

898
00:57:41,219 --> 00:57:44,420
because NAT is not

899
00:57:44,420 --> 00:57:48,229
really sufficient I know probably not a
buzzword

900
00:57:48,229 --> 00:57:51,829
anymore but defense in-depth protect
everything

901
00:57:51,829 --> 00:57:55,039
on the inside network I am because

902
00:57:55,039 --> 00:57:58,160
things can and will fail especially
things like

903
00:57:58,160 --> 00:58:01,579
embedded ices whenever possible

904
00:58:01,579 --> 00:58:05,969
run your own firmware things like open
wrt

905
00:58:05,969 --> 00:58:09,279
dd-wrt or very a

906
00:58:09,279 --> 00:58:12,299
much more Martin have been analyzed a
lot more

907
00:58:12,299 --> 00:58:15,519
and/or general safer let someone else be

908
00:58:15,519 --> 00:58:19,930
the listing for so

909
00:58:19,930 --> 00:58:23,319
in conclusion we're hoping that there is
more interest

910
00:58:23,319 --> 00:58:26,969
I and we can maybe help answer some
questions

911
00:58:26,969 --> 00:58:30,130
about I researching Japanese

912
00:58:30,130 --> 00:58:33,809
modems and routers we hope to release
more data

913
00:58:33,809 --> 00:58:37,819
in the coming months on how to pull
parties firmwares

914
00:58:37,819 --> 00:58:40,940
I and I although

915
00:58:40,940 --> 00:58:45,369
neither bus speak more than a few
phrases and Japanese

916
00:58:45,369 --> 00:58:48,459
I we were still able to

917
00:58:48,459 --> 00:58:52,699
understand how to attack these devices
the cultural barriers

918
00:58:52,699 --> 00:58:55,769
are not high enough I

919
00:58:55,769 --> 00:58:58,829
and finally the fixes arts simple

920
00:58:58,829 --> 00:59:01,890
but we listed a few different things

921
00:59:01,890 --> 00:59:05,230
I that can help

922
00:59:05,230 --> 00:59:07,060
I would like to thank you will translate

923
00:59:07,060 --> 00:59:12,140
good I Yahoo auctions and

924
00:59:12,140 --> 00:59:16,110
take any questions if anyone has any

925
00:59:16,110 --> 00:59:20,150
have the vendors committed to providing

926
00:59:20,150 --> 00:59:24,370
excess ISO

927
00:59:24,370 --> 00:59:28,590
iight the I'm yes to the question is

928
00:59:28,590 --> 00:59:32,250
how have the vendors committed to
providing fixes

929
00:59:32,250 --> 00:59:35,480
I so somebody's it depends on our
ability

930
00:59:35,480 --> 00:59:39,830
frankly I so the UPnP vulnerabilities

931
00:59:39,830 --> 00:59:43,820
we let them know about months ago I

932
00:59:43,820 --> 00:59:47,530
the HD PVR abilities which is why we
were more

933
00:59:47,530 --> 00:59:51,080
I kg we really revealed

934
00:59:51,080 --> 00:59:54,470
last information about those are more
recent

935
00:59:54,470 --> 00:59:57,980
us were hoping to stick to you arm

936
00:59:57,980 --> 01:00:01,250
you know this three-month ish I'm prime

937
01:00:01,250 --> 01:00:05,940
I bites I you know where understanding

938
01:00:05,940 --> 01:00:10,640
that the process in Japan is different
and the process in the US

939
01:00:10,640 --> 01:00:14,020
and hatching that it devices in general

940
01:00:14,020 --> 01:00:17,070
very slow to begin with up it

941
01:00:17,070 --> 01:00:21,000
its you you definitely are risking by
remotely patching things

942
01:00:21,000 --> 01:00:24,570
your entire Internet infrastructure
going down that's

943
01:00:24,570 --> 01:00:28,850
scary for very good reasons

944
01:00:28,850 --> 01:00:31,930
yet we have at are

945
01:00:31,930 --> 01:00:37,190
industries dot com slash code 20 40 we
hope to add more

946
01:00:37,190 --> 01:00:40,250
information in the coming months on

947
01:00:40,250 --> 01:00:47,250
does I

948
01:00:49,160 --> 01:00:52,690
I interested in doing research for any
other country

949
01:00:52,690 --> 01:00:57,650
after Japan which one will be next so

950
01:00:57,650 --> 01:01:00,900
a I don't wanna speak for Paul

951
01:01:00,900 --> 01:01:04,500
but I've been looking a repeat the
question our the

952
01:01:04,500 --> 01:01:08,000
question is all outside Japan

953
01:01:08,000 --> 01:01:11,140
what other countries are we looking at
researching

954
01:01:11,140 --> 01:01:14,430
next arm I personally a

955
01:01:14,430 --> 01:01:18,210
during some my research find a lot of
the devices in China

956
01:01:18,210 --> 01:01:23,170
very interesting up there a they have a
wide variety of services and it's

957
01:01:23,170 --> 01:01:24,410
actually very disjointed

958
01:01:24,410 --> 01:01:29,260
so I think there's a lot of interesting
things there but I also

959
01:01:29,260 --> 01:01:32,680
would like to look at some Russian
devices which is

960
01:01:32,680 --> 01:01:35,820
similar but there are less remotely
expose

961
01:01:35,820 --> 01:01:40,260
services so I think it would be
interesting the reason why

962
01:01:40,260 --> 01:01:43,339
we looked at Japanese devices is are

963
01:01:43,339 --> 01:01:46,500
company has an office in Tokyo I

964
01:01:46,500 --> 01:01:51,849
and we were curious I'll what kinda code
was running between us and the Internet

965
01:01:51,849 --> 01:01:55,319
unfortunately our expectations prove
true

966
01:01:55,319 --> 01:01:59,099
I in that week didn't think code was
very

967
01:01:59,099 --> 01:02:03,510
secure on bytes we want to reiterate
that

968
01:02:03,510 --> 01:02:06,839
if we were I if we had an office in
another country

969
01:02:06,839 --> 01:02:10,099
I we would expect the exact same outcome

970
01:02:10,099 --> 01:02:13,480
this is an international problem I

971
01:02:13,480 --> 01:02:16,540
not just the Japanese one but we're
hoping that there's more

972
01:02:16,540 --> 01:02:20,319
interest in the Japanese sector thank
you

973
01:02:20,319 --> 01:02:24,050
so it's a bit more

974
01:02:24,050 --> 01:02:28,400
tin bucket on wall technique one
additional question

975
01:02:28,400 --> 01:02:32,109
which country do you think then

976
01:02:32,109 --> 01:02:35,140
has the best practice at the practicing
times home router

977
01:02:35,140 --> 01:02:39,710
which countries and more secure than
others

978
01:02:39,710 --> 01:02:42,430
so up

979
01:02:42,430 --> 01:02:46,570
across the questionnaire question is
I'll

980
01:02:46,570 --> 01:02:50,320
which country do we think has the best

981
01:02:50,320 --> 01:02:53,680
security track record II

982
01:02:53,680 --> 01:02:56,750
for embedded devices and II

983
01:02:56,750 --> 01:03:00,190
in my opinion that's up like that like

984
01:03:00,190 --> 01:03:03,790
you know the best of the worst I

985
01:03:03,790 --> 01:03:07,200
everyone still has these problems I'll

986
01:03:07,200 --> 01:03:12,030
its all that the

987
01:03:12,030 --> 01:03:13,560
I countries

988
01:03:13,560 --> 01:03:17,270
where more a reverse engineering of
these devices

989
01:03:17,270 --> 01:03:21,720
research has been performed generally
the devices are somewhat harder

990
01:03:21,720 --> 01:03:26,620
to attack all by by and large a

991
01:03:26,620 --> 01:03:30,190
yet so the United States for instance
has had people per cent

992
01:03:30,190 --> 01:03:33,580
at many many black hats and DEF Kong's

993
01:03:33,580 --> 01:03:38,590
vulnerabilities Ian the rise in routers
and Comcast router

994
01:03:38,590 --> 01:03:43,600
all the major ISP's really and we still
have these vulnerabilities

995
01:03:43,600 --> 01:03:48,080
I'll they're slightly there there
sometimes harder to exploit but not all

996
01:03:48,080 --> 01:03:48,670
the time

997
01:03:48,670 --> 01:03:51,850
so it really no one

998
01:03:51,850 --> 01:03:55,630
is the most secure right now up it helps
to

999
01:03:55,630 --> 01:03:59,650
though I think to have a healthy up
security

1000
01:03:59,650 --> 01:04:02,690
research our community attacking

1001
01:04:02,690 --> 01:04:05,940
I your own infrastructure

1002
01:04:05,940 --> 01:04:09,590
I and that's common in the US

1003
01:04:09,590 --> 01:04:13,980
its common in the European Union I and
perhaps we were just

1004
01:04:13,980 --> 01:04:17,920
googling poorly but it didn't seem as
common

1005
01:04:17,920 --> 01:04:21,210
in Japan I bites

1006
01:04:21,210 --> 01:04:25,950
at the end of the day everyone keeps
making the same mistakes

1007
01:04:25,950 --> 01:04:30,360
embedded devices and so are suggestions
for fixing the problem

1008
01:04:30,360 --> 01:04:34,320
are not to try to patch all the
vulnerabilities

1009
01:04:34,320 --> 01:04:40,920
its to you make them more costly to
exploit

1010
01:04:40,920 --> 01:04:43,630
I don't eleventh thank you very much

