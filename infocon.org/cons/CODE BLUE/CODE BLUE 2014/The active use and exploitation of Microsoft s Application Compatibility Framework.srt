1
00:00:11,210 --> 00:00:12,810
good afternoon

2
00:00:12,810 --> 00:00:15,960
as David said yesterday its

3
00:00:15,960 --> 00:00:19,119
speaker up I'm sure you're tired I'm

4
00:00:19,119 --> 00:00:22,300
exhausted its the 3m in my head right
now

5
00:00:22,300 --> 00:00:25,590
and the the let's get this

6
00:00:25,590 --> 00:00:29,490
the mice lies are not on created in MS
Paint

7
00:00:29,490 --> 00:00:32,720
I wish layer would have done that and
have enough time the last night

8
00:00:32,720 --> 00:00:37,720
but I me next time a little bit about me

9
00:00:37,720 --> 00:00:41,780
I I'm an engineer at ice I partners

10
00:00:41,780 --> 00:00:46,450
I've been there for three have here
prior to that

11
00:00:46,450 --> 00:00:50,000
I worked at The MITRE Corporation I

12
00:00:50,000 --> 00:00:54,320
may be through with mitre they'd do CE a

13
00:00:54,320 --> 00:00:58,920
prior to mitre I aidid some work for
defense contractors

14
00:00:58,920 --> 00:01:02,179
and I know the US military

15
00:01:02,179 --> 00:01:05,590
for that I my primary tasks at work

16
00:01:05,590 --> 00:01:08,940
are a reverse engineering now where

17
00:01:08,940 --> 00:01:13,430
looking at security patches and

18
00:01:13,430 --> 00:01:17,900
just random tasks so you may have heard

19
00:01:17,900 --> 00:01:21,770
me before but you're actually probably
thinking up this other guy

20
00:01:21,770 --> 00:01:27,000
that wrote the are exploitation this is
not me

21
00:01:27,000 --> 00:01:30,609
up if you brought your copy of your book
criticizing I will sign it for you

22
00:01:30,609 --> 00:01:31,049
though

23
00:01:31,049 --> 00:01:33,840
yes

24
00:01:33,840 --> 00:01:39,520
up a

25
00:01:39,520 --> 00:01:42,649
just briefly I say Partners is a

26
00:01:42,649 --> 00:01:46,829
threatened tellers provider if you're
interested please visit our website for

27
00:01:46,829 --> 00:01:47,979
complete to me

28
00:01:47,979 --> 00:01:52,039
after this talk court today

29
00:01:52,039 --> 00:01:55,170
we are going to be talking about up
getting compatibility

30
00:01:55,170 --> 00:02:00,350
I'm going to define not and I'm going to
discuss some tools it can use to

31
00:02:00,350 --> 00:02:03,549
analyze and create your own

32
00:02:03,549 --> 00:02:07,369
talk about differ prior works out there
I

33
00:02:07,369 --> 00:02:10,440
and talk about Microsoft's he met

34
00:02:10,440 --> 00:02:13,660
and go over so real-world examples where

35
00:02:13,660 --> 00:02:19,569
now where is using these tactics today
so

36
00:02:19,569 --> 00:02:23,670
application compatibility is something
that Microsoft introduced

37
00:02:23,670 --> 00:02:27,890
in Windows XP and its to address

38
00:02:27,890 --> 00:02:30,959
compatibility issues from going from

39
00:02:30,959 --> 00:02:34,239
a Windows 2000 an anti

40
00:02:34,239 --> 00:02:37,810
XP in XP to win7 except right covers

41
00:02:37,810 --> 00:02:42,170
many different issues one simple example
if this is

42
00:02:42,170 --> 00:02:46,239
if you consider going from a XP to
Windows 7

43
00:02:46,239 --> 00:02:50,280
if you've got an application that's been
compiled with hardcoded

44
00:02:50,280 --> 00:02:54,200
up I'll pass so if you have C call and

45
00:02:54,200 --> 00:02:57,430
documents and settings that would be

46
00:02:57,430 --> 00:03:02,319
up for XP and on Windows 7 ABC calling
user so

47
00:03:02,319 --> 00:03:06,170
if you got a forever that's developed
code for

48
00:03:06,170 --> 00:03:09,959
Windows XP Nate Ryan is run under
Windows seven box it's not going to work

49
00:03:09,959 --> 00:03:10,599
so

50
00:03:10,599 --> 00:03:15,639
Microsoft has invented this application
compatibility layer that sits between

51
00:03:15,639 --> 00:03:18,980
operating system and a target
application

52
00:03:18,980 --> 00:03:22,829
that could intercept lots of different
coaching calls

53
00:03:22,829 --> 00:03:26,549
and provide a way and mechanism for you
too

54
00:03:26,549 --> 00:03:29,569
fix these problems without recompiling

55
00:03:29,569 --> 00:03:32,950
the code to work for these a pretty
popular apps

56
00:03:32,950 --> 00:03:36,599
Microsoft has a whole website dedicated
to

57
00:03:36,599 --> 00:03:40,970
exits to go read the documentation is
kind of a snippet up

58
00:03:40,970 --> 00:03:44,580
the words that they have to describe it

59
00:03:44,580 --> 00:03:47,210
I for graphical issues a

60
00:03:47,210 --> 00:03:51,400
file who's read a few issues cetera and
that the big eight

61
00:03:51,400 --> 00:03:54,470
word on the page over and over again is
failure

62
00:03:54,470 --> 00:03:57,600
so whenever there's a failure case they
have a

63
00:03:57,600 --> 00:04:01,550
fix it for that there's thousands of
them

64
00:04:01,550 --> 00:04:05,260
the a I think they called the Microsoft
Fix It center

65
00:04:05,260 --> 00:04:08,630
here's an example I'll

66
00:04:08,630 --> 00:04:13,660
a a game I've never played before but I
came across its

67
00:04:13,660 --> 00:04:17,109
a fix when I was do my research

68
00:04:17,109 --> 00:04:20,250
and when you play this game I guess it

69
00:04:20,250 --> 00:04:23,350
it's an older gay men you bring into
Windows seven yr mister

70
00:04:23,350 --> 00:04:26,720
I it will crash when you perform in all

71
00:04:26,720 --> 00:04:31,240
up I and so either the creators of this
game

72
00:04:31,240 --> 00:04:34,310
or a big fan of this game traded

73
00:04:34,310 --> 00:04:37,890
a Microsoft fix it to

74
00:04:37,890 --> 00:04:41,380
address this and the particular him that
they used here

75
00:04:41,380 --> 00:04:45,320
was something called fourth direct draw
and the elation

76
00:04:45,320 --> 00:04:49,240
and the purpose of this is just you
forced the direct

77
00:04:49,240 --> 00:04:52,350
drawl function into some emulation early

78
00:04:52,350 --> 00:04:55,610
under Senate Sunport but there are

79
00:04:55,610 --> 00:04:58,870
like hundreds and hundreds of different
shins and

80
00:04:58,870 --> 00:05:02,980
these guys had some random graphics
crash

81
00:05:02,980 --> 00:05:08,160
when doing all top so there's a fix for
that so let's get into some tools they

82
00:05:08,160 --> 00:05:09,210
can use to look at these

83
00:05:09,210 --> 00:05:12,990
a

84
00:05:12,990 --> 00:05:17,720
5 microsoft has the application
compatibility

85
00:05:17,720 --> 00:05:22,490
talk it a STB to XML which is actually
from the likes of

86
00:05:22,490 --> 00:05:26,000
employees CDT is Alex I

87
00:05:26,000 --> 00:05:29,100
sq a students

88
00:05:29,100 --> 00:05:32,560
is a friend want to leave Microsoft and

89
00:05:32,560 --> 00:05:36,490
STB explores the tool that I created
during my research

90
00:05:36,490 --> 00:05:40,150
and unfortunately I named it STB explore

91
00:05:40,150 --> 00:05:43,460
which Google that you'll find lots up
its for

92
00:05:43,460 --> 00:05:47,040
I Amazon's simple database

93
00:05:47,040 --> 00:05:52,190
so whereas TV in this case dispersion
database

94
00:05:52,190 --> 00:05:56,209
I amazon has way more the way more hits
than be four

95
00:05:56,209 --> 00:06:02,839
simple Davis 0 just kinda hard to find
up so here's a screenshot

96
00:06:02,839 --> 00:06:06,099
a Microsoft application compatibility
toolkit

97
00:06:06,099 --> 00:06:09,809
a this is freely available

98
00:06:09,809 --> 00:06:13,669
they provide documentation on how to use
it it's not great

99
00:06:13,669 --> 00:06:17,959
its is fairly limited but they do
provide information on how

100
00:06:17,959 --> 00:06:21,179
administrators can go ahead and

101
00:06:21,179 --> 00:06:24,199
you can create your own medically fixes
for

102
00:06:24,199 --> 00:06:28,039
products I've got two examples here that
I've proven myself

103
00:06:28,039 --> 00:06:32,349
both are tardy in Internet Explorer and

104
00:06:32,349 --> 00:06:35,439
the picture on the left is a

105
00:06:35,439 --> 00:06:38,699
for compatibility fix called shame VAT

106
00:06:38,699 --> 00:06:41,919
which means it's going to provide a

107
00:06:41,919 --> 00:06:45,759
method to cook functions be a and export
address table

108
00:06:45,759 --> 00:06:50,119
on the rights is a compatibility mode

109
00:06:50,119 --> 00:06:54,119
call the hell they create process so
therefore it will

110
00:06:54,119 --> 00:06:58,379
elevate up to administrator privileges

111
00:06:58,379 --> 00:07:02,559
one important thing to do to get the
slide here is this

112
00:07:02,559 --> 00:07:07,899
the thing below those is this matching
files sources matching files

113
00:07:07,899 --> 00:07:11,559
hikes for a XE and others several
categories for its size

114
00:07:11,559 --> 00:07:15,099
been television product version: product
name

115
00:07:15,099 --> 00:07:18,419
company name I when this

116
00:07:18,419 --> 00:07:21,990
layer that's between the operating
system and

117
00:07:21,990 --> 00:07:25,139
application has been wrong that layer

118
00:07:25,139 --> 00:07:28,860
is what reads these STB files and a half
to

119
00:07:28,860 --> 00:07:33,349
make sure that the criteria have been
met before it applies this

120
00:07:33,349 --> 00:07:37,439
sex so when it reaches us to be file say
for the left one

121
00:07:37,439 --> 00:07:40,719
if it's this particular version explore

122
00:07:40,719 --> 00:07:45,059
then it's going to apply this Shin BIA e
86

123
00:07:45,059 --> 00:07:48,429
a

124
00:07:48,429 --> 00:07:53,179
next it OK by Microsoft employees called
estimate XML

125
00:07:53,179 --> 00:07:56,269
and the name a says what does it takes

126
00:07:56,269 --> 00:08:00,289
a shame database file in converted that
banner

127
00:08:00,289 --> 00:08:04,810
file into an XML law on

128
00:08:04,810 --> 00:08:09,310
I I got some lines on here that say does
not parks

129
00:08:09,310 --> 00:08:13,990
a in memory fix its peak not dump patch
misinformation that

130
00:08:13,990 --> 00:08:18,130
its related to you a previous talking to
this year

131
00:08:18,130 --> 00:08:22,300
which was solely focused on the in
memory patching

132
00:08:22,300 --> 00:08:25,770
features up this heavily from work

133
00:08:25,770 --> 00:08:29,720
I this that

134
00:08:29,720 --> 00:08:34,750
patch misinformation is basically that
big blob pay 60 for the top

135
00:08:34,750 --> 00:08:38,959
and that blog a is what actually got me
started in this

136
00:08:38,959 --> 00:08:42,520
trying to fear 0 what is that what does
do and

137
00:08:42,520 --> 00:08:48,380
how can I analyze that CD

138
00:08:48,380 --> 00:08:53,420
sane sq these other command line options
that are available

139
00:08:53,420 --> 00:08:57,540
but for sure the stools never released
but

140
00:08:57,540 --> 00:09:01,220
he's got screenshots a bit you know
being used for

141
00:09:01,220 --> 00:09:05,740
showing shameless and executed balls and
patties

142
00:09:05,740 --> 00:09:08,930
I was most interested in his option for
showing patches

143
00:09:08,930 --> 00:09:15,510
but it was never released so

144
00:09:15,510 --> 00:09:19,430
a tool for installing for a tool for
installing

145
00:09:19,430 --> 00:09:23,500
St files is a command line utility that

146
00:09:23,500 --> 00:09:26,850
is on your Windows boxes right now
called abstinence

147
00:09:26,850 --> 00:09:31,410
and you just pass it

148
00:09:31,410 --> 00:09:36,000
AF to be filing and one thing to note is
that

149
00:09:36,000 --> 00:09:39,330
requires administrator privileges and
the

150
00:09:39,330 --> 00:09:42,550
the reason it does it will be more
prepared for the next slide get into

151
00:09:42,550 --> 00:09:43,230
that but

152
00:09:43,230 --> 00:09:48,540
I'll a reminder set this are

153
00:09:48,540 --> 00:09:51,800
a I'm so tired that the street on the
bottom

154
00:09:51,800 --> 00:09:53,980
it

155
00:09:53,980 --> 00:09:57,140
a is a side effect to this program when
you stop

156
00:09:57,140 --> 00:10:00,410
I'll as to be files through this
mechanism

157
00:10:00,410 --> 00:10:03,810
they will show up in the add/remove
programs dialog box

158
00:10:03,810 --> 00:10:06,980
so in this case I've installed

159
00:10:06,980 --> 00:10:10,710
a to fix its that fix on

160
00:10:10,710 --> 00:10:14,020
to prevent exploitation up these two
particular CDs

161
00:10:14,020 --> 00:10:17,650
and so they show up in that area group
parents dialog box

162
00:10:17,650 --> 00:10:21,420
so

163
00:10:21,420 --> 00:10:24,750
the reason that you have to be
administrator to run

164
00:10:24,750 --> 00:10:29,520
that tool is because it needs to be able
to write to you

165
00:10:29,520 --> 00:10:33,529
XP local machine and these windows

166
00:10:33,529 --> 00:10:36,839
a directly house in those require

167
00:10:36,839 --> 00:10:41,360
administrator so that she will air

168
00:10:41,360 --> 00:10:45,750
will first look at the stopper tricky up
compact

169
00:10:45,750 --> 00:10:49,120
flags custom there will be a list

170
00:10:49,120 --> 00:10:52,610
up keys each he will be a name

171
00:10:52,610 --> 00:10:56,740
love inexcusable so you might find I X
480 X

172
00:10:56,740 --> 00:11:01,310
he under there you might find when word
I XE Firefox to EXE

173
00:11:01,310 --> 00:11:05,339
except for if there's an Associated
entry in there

174
00:11:05,339 --> 00:11:09,860
you then grab a you went from there and
then you match that

175
00:11:09,860 --> 00:11:13,820
to you this other power hear this up to
pat plugs

176
00:11:13,820 --> 00:11:17,760
installed St Bees but if there's agree
with their

177
00:11:17,760 --> 00:11:21,110
than you get this picture that I have on
the bottom

178
00:11:21,110 --> 00:11:24,589
this for the CV

179
00:11:24,589 --> 00:11:28,020
the 2012 1889

180
00:11:28,020 --> 00:11:32,560
this was released by Microsoft you can
see that

181
00:11:32,560 --> 00:11:36,550
has the Davies timestamp when I install
it

182
00:11:36,550 --> 00:11:40,180
the the database power is the full path
to where

183
00:11:40,180 --> 00:11:43,839
this file with the this dot STP tension
exists

184
00:11:43,839 --> 00:11:47,740
on my hard drive and the fall

185
00:11:47,740 --> 00:11:52,930
politicians listed here pet costume and
ask pass

186
00:11:52,930 --> 00:11:56,880
custom custom 64 these are just a fault

187
00:11:56,880 --> 00:12:00,100
for the st. install that I been talking
about

188
00:12:00,100 --> 00:12:03,830
it's not a requirement that they are in
that location

189
00:12:03,830 --> 00:12:08,660
just by convention

190
00:12:08,660 --> 00:12:09,040
a

191
00:12:09,040 --> 00:12:13,000
so when I was 13 my research I

192
00:12:13,000 --> 00:12:16,850
looking into how this work tonight
decide to you the

193
00:12:16,850 --> 00:12:20,890
this feature out installing a registry
in a FTP files

194
00:12:20,890 --> 00:12:25,700
and so the register the through it to
explore

195
00:12:25,700 --> 00:12:30,040
does not have the side effect up showing
up in add/remove programs

196
00:12:30,040 --> 00:12:35,200
and it does not copy these St files to
you that the politicians

197
00:12:35,200 --> 00:12:38,600
I'm so then its it

198
00:12:38,600 --> 00:12:42,760
if you do that you have to be aware that
if you're dealing with

199
00:12:42,760 --> 00:12:48,890
64-bit patches the path somewhere in the
path needs to be

200
00:12:48,890 --> 00:12:52,370
the work custom 64 and

201
00:12:52,370 --> 00:12:55,920
my part was not immune to the Minister

202
00:12:55,920 --> 00:12:59,279
would have required anyways either way
need to be

203
00:12:59,279 --> 00:13:02,640
mystery rights to be able to you
register all these

204
00:13:02,640 --> 00:13:07,200
house soca 2012

205
00:13:07,200 --> 00:13:11,250
us a prior work I'm talk about these
particular

206
00:13:11,250 --> 00:13:14,500
items Alex the ISP's

207
00:13:14,500 --> 00:13:18,010
blog series mark bad it's presentation
to work on

208
00:13:18,010 --> 00:13:21,010
my previous talk I did this year at

209
00:13:21,010 --> 00:13:24,110
a like it Asia and scan

210
00:13:24,110 --> 00:13:27,570
360 and I Chris Brown's like this

211
00:13:27,570 --> 00:13:31,370
the first a

212
00:13:31,370 --> 00:13:34,820
else ASU releases blog series

213
00:13:34,820 --> 00:13:39,450
I was supposed to be nine parts he
didn't its tiny stopped after four

214
00:13:39,450 --> 00:13:42,709
unfortunately or fortunately for me it

215
00:13:42,709 --> 00:13:45,800
if you were to finish I probably would
have never got started in the topic to

216
00:13:45,800 --> 00:13:46,920
begin with so

217
00:13:46,920 --> 00:13:51,770
I guess it's good for me I'm going to
talk about the ones a pilot in the red

218
00:13:51,770 --> 00:13:56,190
about systems which she considers the
most interesting

219
00:13:56,190 --> 00:14:00,570
and I was also interested and

220
00:14:00,570 --> 00:14:05,320
runtime: in every patron and that was
the whole focus of my

221
00:14:05,320 --> 00:14:11,339
mccurry top

222
00:14:11,339 --> 00:14:12,559
so that's assumptions

223
00:14:12,559 --> 00:14:16,119
can be found in this directory on

224
00:14:16,119 --> 00:14:20,040
sis made a STB driver main that's BS I
mean

225
00:14:20,040 --> 00:14:23,860
peace amen I'm going to be talking about
this personal

226
00:14:23,860 --> 00:14:27,220
so

227
00:14:27,220 --> 00:14:31,089
a if you use as to explore or

228
00:14:31,089 --> 00:14:34,749
you have to beat XML either way you'll
get the same a

229
00:14:34,749 --> 00:14:39,689
output but it my particular program
might pass

230
00:14:39,689 --> 00:14:43,230
my ft option that basically prince that
review

231
00:14:43,230 --> 00:14:47,629
love up there has to be a file a

232
00:14:47,629 --> 00:14:52,670
in this particular example I'm showing
the show when do I V Shem

233
00:14:52,670 --> 00:14:56,309
and shrinker shim and

234
00:14:56,309 --> 00:15:00,610
I purse all these names i no idea what
they meant as

235
00:15:00,610 --> 00:15:05,199
I doubt anyone here knows that and so
where'd you go to find information out

236
00:15:05,199 --> 00:15:09,889
a there's actually this thing how late
it in the red box

237
00:15:09,889 --> 00:15:13,240
its a the description resource ID

238
00:15:13,240 --> 00:15:17,149
so we can go find that resource ID

239
00:15:17,149 --> 00:15:21,240
to get the description of this
particular a

240
00:15:21,240 --> 00:15:25,620
so on on the GOP side

241
00:15:25,620 --> 00:15:29,269
that's your power at Patch flash on

242
00:15:29,269 --> 00:15:33,230
GAAP JP

243
00:15:33,230 --> 00:15:37,249
that particular muoi file and donning
the side

244
00:15:37,249 --> 00:15:40,420
its suárez deal I'm you like

245
00:15:40,420 --> 00:15:43,660
so these two resources if you go into
the

246
00:15:43,660 --> 00:15:47,949
string table you'll find these I'll the
show went to a PI

247
00:15:47,949 --> 00:15:51,699
in this case is just use for fixing
problems to choose tabs

248
00:15:51,699 --> 00:15:55,509
I i don't really understand that fully
that's not the point

249
00:15:55,509 --> 00:15:58,910
I'll and the second one here is

250
00:15:58,910 --> 00:16:03,230
that shrinker was related to

251
00:16:03,230 --> 00:16:06,819
shrinker resource compression library

252
00:16:06,819 --> 00:16:10,339
but this is just a method for you

253
00:16:10,339 --> 00:16:14,699
to be able to you figure out the
descriptions of the shims if you're not

254
00:16:14,699 --> 00:16:15,670
familiar

255
00:16:15,670 --> 00:16:21,769
with them when you're performing on
research in this area

256
00:16:21,769 --> 00:16:23,200
a mark bet

257
00:16:23,200 --> 00:16:28,260
presented that tariq on a when is owned
by default

258
00:16:28,260 --> 00:16:31,500
and his his focus was

259
00:16:31,500 --> 00:16:34,850
taking a look at the application
compatibility framework a

260
00:16:34,850 --> 00:16:38,459
from the point of view attacker he's
interested in doing a rootkit

261
00:16:38,459 --> 00:16:41,709
type behaviors like process execution

262
00:16:41,709 --> 00:16:46,329
redirection API mccain hiding in the
filesystem

263
00:16:46,329 --> 00:16:51,230
hiding the registry to say when security
features such as death in a Salar

264
00:16:51,230 --> 00:16:54,230
and executing back doors so

265
00:16:54,230 --> 00:16:59,820
he took a look at that live whole long
list of shame that are available two

266
00:16:59,820 --> 00:17:00,410
years

267
00:17:00,410 --> 00:17:04,689
he said which if these can I use as an
attacker

268
00:17:04,689 --> 00:17:09,470
to perform my duties and so one we saw

269
00:17:09,470 --> 00:17:13,890
right away was inject deal I'll and if
you take this

270
00:17:13,890 --> 00:17:17,160
resource studying go I get the
description as we just

271
00:17:17,160 --> 00:17:20,720
asahara do you'll find that basically to
fix

272
00:17:20,720 --> 00:17:24,140
for programs that require

273
00:17:24,140 --> 00:17:29,450
a de lo to be loaded but there wasn't a
previous call to all the library

274
00:17:29,450 --> 00:17:32,610
and so this shame will take care

275
00:17:32,610 --> 00:17:35,690
loading this labor for you before the
process starts

276
00:17:35,690 --> 00:17:38,940
so a

277
00:17:38,940 --> 00:17:44,510
to figure out how the film's worker what
they actually do other implemented

278
00:17:44,510 --> 00:17:47,799
yep underneath the the name

279
00:17:47,799 --> 00:17:50,919
the neighbors inject a little underneath
it deal

280
00:17:50,919 --> 00:17:54,570
file AC general that DLL if you bring
that

281
00:17:54,570 --> 00:17:58,880
into up in tighter you can go look for
this

282
00:17:58,880 --> 00:18:02,620
a NS inject the loaner by at than method

283
00:18:02,620 --> 00:18:07,240
and if you look in there it's literally
just a call to load library

284
00:18:07,240 --> 00:18:12,419
so all attacker have to do

285
00:18:12,419 --> 00:18:16,460
is created a deal I'll with the Coton de
la main

286
00:18:16,460 --> 00:18:21,929
and tell the inject your shame that it
should load

287
00:18:21,929 --> 00:18:25,440
the deal of it up this the gate code

288
00:18:25,440 --> 00:18:30,550
exactly enough and a process varies

289
00:18:30,550 --> 00:18:33,520
a second when he talked about was
redirect txt

290
00:18:33,520 --> 00:18:37,540
and again this is docked implemented in
the AC

291
00:18:37,540 --> 00:18:42,800
General de lo you look at that it will
just do a crate process

292
00:18:42,800 --> 00:18:48,070
close handles the process and exit
itself so

293
00:18:48,070 --> 00:18:51,890
let's say you were going to redirect

294
00:18:51,890 --> 00:18:56,160
help ok to new iPad so you

295
00:18:56,160 --> 00:19:00,340
double-click talk to later calculator
starts to come up

296
00:19:00,340 --> 00:19:04,260
the windows loader is doing this process
up looking into memory

297
00:19:04,260 --> 00:19:07,960
says okay I need to apply a shame
because someone is registered

298
00:19:07,960 --> 00:19:12,720
installed ashamed for cartilage and so
it starts up

299
00:19:12,720 --> 00:19:16,840
before art Windows main hits and
calculator

300
00:19:16,840 --> 00:19:21,050
it does a crate process for new iPad 2
the new iPad 3rd sup

301
00:19:21,050 --> 00:19:25,800
and then talk this tournament and that's
how redirect works

302
00:19:25,800 --> 00:19:30,300
this could be useful and you'll see it
is very useful

303
00:19:30,300 --> 00:19:34,800
later protectors other ones he talked
about

304
00:19:34,800 --> 00:19:39,600
a was registry

305
00:19:39,600 --> 00:19:44,200
virtualization so say you want to hide
something in the registry

306
00:19:44,200 --> 00:19:48,480
you could creation for reg at it

307
00:19:48,480 --> 00:19:52,690
so that if someone is going to look for
specific key value within the

308
00:19:52,690 --> 00:19:56,220
looking to the registry editor bill
actually redirect to a different

309
00:19:56,220 --> 00:19:57,800
location in the registry

310
00:19:57,800 --> 00:20:01,050
to place that doesn't exist or Mike Dean
false information

311
00:20:01,050 --> 00:20:06,310
two projects like that alright

312
00:20:06,310 --> 00:20:10,220
a so that this is but might

313
00:20:10,220 --> 00:20:13,300
talk which is mainly about

314
00:20:13,300 --> 00:20:17,320
the in every patch structure and so like
I said before

315
00:20:17,320 --> 00:20:21,800
up part of my my job is performing the

316
00:20:21,800 --> 00:20:24,830
defend else is up at his mostly
concerned about

317
00:20:24,830 --> 00:20:29,130
looking for security-related changes and
so this is an example

318
00:20:29,130 --> 00:20:32,240
love I to an offender for

319
00:20:32,240 --> 00:20:36,070
two different versions a message you
know the OL and

320
00:20:36,070 --> 00:20:36,940
been diff

321
00:20:36,940 --> 00:20:39,919
identified 465 a different match

322
00:20:39,919 --> 00:20:45,289
functions which means there's 465 places
I need to go look at

323
00:20:45,289 --> 00:20:48,320
and figure out is that a

324
00:20:48,320 --> 00:20:52,169
securely changers out just that a
compiler optimization where they

325
00:20:52,169 --> 00:20:55,690
change you know the reason he be
expressed EC AXR

326
00:20:55,690 --> 00:21:00,840
is it something you know more severe so
it's a very long process

327
00:21:00,840 --> 00:21:03,950
I can be funny can be awful

328
00:21:03,950 --> 00:21:07,200
a in but the

329
00:21:07,200 --> 00:21:10,940
Microsoft releases a fix it in memory
pouch

330
00:21:10,940 --> 00:21:15,009
for this particular see it up with here
there is to change its

331
00:21:15,009 --> 00:21:19,799
there was basically for bikes that
change total

332
00:21:19,799 --> 00:21:24,059
for what which relate to you taking some
upgrades

333
00:21:24,059 --> 00:21:27,539
and so for me doing the you know

334
00:21:27,539 --> 00:21:32,470
pattern else it's much easier to look at
two things some quarters 55 things

335
00:21:32,470 --> 00:21:36,159
and that's what was my initial
motivation and getting

336
00:21:36,159 --> 00:21:40,529
I started in this topic so

337
00:21:40,529 --> 00:21:43,549
this in memory patch feature is bending

338
00:21:43,549 --> 00:21:46,849
Windows a years exp

339
00:21:46,849 --> 00:21:50,309
and I've only found five cases where
they've used

340
00:21:50,309 --> 00:21:53,549
in memory patch feature its a

341
00:21:53,549 --> 00:21:58,529
not document it all I'll I've documented
in my

342
00:21:58,529 --> 00:22:02,320
my previous work but up on that's not a

343
00:22:02,320 --> 00:22:05,960
today we were talking about this the CV
2014

344
00:22:05,960 --> 00:22:10,190
for for and its related CV that

345
00:22:10,190 --> 00:22:15,769
for the bypass sobil called only pactor

346
00:22:15,769 --> 00:22:19,460
on a boat my previous work I talk about
a

347
00:22:19,460 --> 00:22:22,789
the second cust which was no I

348
00:22:22,789 --> 00:22:27,499
use after free able to build it so

349
00:22:27,499 --> 00:22:30,979
and a quick background I'll how this a

350
00:22:30,979 --> 00:22:35,609
only packager own ability works there's
a PowerPoint lower

351
00:22:35,609 --> 00:22:39,429
this somehow convince you that you need
to you open this PowerPoint

352
00:22:39,429 --> 00:22:43,980
its got good stuff in it and within that
PowerPoint

353
00:22:43,980 --> 00:22:47,410
a is a evil

354
00:22:47,410 --> 00:22:50,730
lineup that's packaged in with a
packager object

355
00:22:50,730 --> 00:22:53,730
then somehow

356
00:22:53,730 --> 00:22:57,320
this I know file somewhere right clicks

357
00:22:57,320 --> 00:23:00,330
click Install and this I not to fall

358
00:23:00,330 --> 00:23:04,660
installer program runs and uses this
user controlled

359
00:23:04,660 --> 00:23:10,320
evil though I know file to execute code
so how's this work

360
00:23:10,320 --> 00:23:13,470
first PowerPoint says

361
00:23:13,470 --> 00:23:17,920
okay summers in bed a a packager object

362
00:23:17,920 --> 00:23:22,060
in this our point so it needs to load
the packager deal L

363
00:23:22,060 --> 00:23:26,420
into the process memory space at that
point the Packer deal I'll

364
00:23:26,420 --> 00:23:30,330
is responsible for copying that I know
if I'll

365
00:23:30,330 --> 00:23:34,760
into that temple than

366
00:23:34,760 --> 00:23:38,390
there's a PowerPoint animation in this
invokes

367
00:23:38,390 --> 00:23:41,730
do for command this duper

368
00:23:41,730 --> 00:23:45,490
trend is associated with the winner
right click context menu

369
00:23:45,490 --> 00:23:49,280
for I know file and so

370
00:23:49,280 --> 00:23:54,610
the right click do verb action was
actually to do the second one in the

371
00:23:54,610 --> 00:23:55,900
list which is to

372
00:23:55,900 --> 00:23:59,240
to install when you right-click lineup

373
00:23:59,240 --> 00:24:02,490
click Install it launches sign up the
fall stole

374
00:24:02,490 --> 00:24:06,760
and uses up is a control line up I'll
and at that point

375
00:24:06,760 --> 00:24:10,670
you've got code execution because it's
running that tucker

376
00:24:10,670 --> 00:24:13,740
so Microsoft Access

377
00:24:13,740 --> 00:24:17,770
October 2014 a

378
00:24:17,770 --> 00:24:21,240
what they did was that took care of this
first thing that I've

379
00:24:21,240 --> 00:24:25,120
how did here red when it copies

380
00:24:25,120 --> 00:24:28,400
the evil dot I know file into the temple
there

381
00:24:28,400 --> 00:24:33,160
they've set a a meditative flying on the
file they said Mark file

382
00:24:33,160 --> 00:24:36,800
on say so later on this

383
00:24:36,800 --> 00:24:40,040
in this chain of events when the lineup
to fall

384
00:24:40,040 --> 00:24:43,640
install program starts up wanna its jobs
is to say

385
00:24:43,640 --> 00:24:47,360
hey I need to make sure that any I know
files I'm going to be

386
00:24:47,360 --> 00:24:52,240
and we need to be safe so it by default
checks is there an unsafe like that

387
00:24:52,240 --> 00:24:55,760
I know file in this case there is an
unsafe

388
00:24:55,760 --> 00:25:01,800
flag in their fourth going to prompt the
user so you can see that same path

389
00:25:01,800 --> 00:25:03,450
events and now is prompting me

390
00:25:03,450 --> 00:25:07,080
opened file security warning are you
sure you really want to do this

391
00:25:07,080 --> 00:25:12,140
and I'm going to say no aka

392
00:25:12,140 --> 00:25:17,050
shortly after the patch there was a
bypass

393
00:25:17,050 --> 00:25:20,800
a very quickly a hyphae levy

394
00:25:20,800 --> 00:25:26,490
was a blogging about that he founded by
past business but Microsoft

395
00:25:26,490 --> 00:25:31,630
and than Google phone exploitation in a
while the bypass

396
00:25:31,630 --> 00:25:35,020
so the way they worked was a goal

397
00:25:35,020 --> 00:25:38,420
found that someone in bed a

398
00:25:38,420 --> 00:25:41,800
EXE instead of an I know file

399
00:25:41,800 --> 00:25:46,090
and when they did the right click action
they did the right thing action for run

400
00:25:46,090 --> 00:25:47,260
as administrator

401
00:25:47,260 --> 00:25:50,330
in that action causes

402
00:25:50,330 --> 00:25:54,179
USA prompt and if the user clicks yes

403
00:25:54,179 --> 00:25:57,800
you've got good execution and it's
running at high privilege

404
00:25:57,800 --> 00:26:01,340
I'll but that's kinda obvious that

405
00:26:01,340 --> 00:26:05,770
you know something bad might be
happening so maybe it's not as reliable

406
00:26:05,770 --> 00:26:09,360
I P lease thou not

407
00:26:09,360 --> 00:26:12,590
if someone has installed a Python on
their

408
00:26:12,590 --> 00:26:15,710
system in you in bed a python file

409
00:26:15,710 --> 00:26:19,990
PowerPoint the right click context menu
for that the second one is

410
00:26:19,990 --> 00:26:23,150
at it with idle and when

411
00:26:23,150 --> 00:26:28,280
that editor starts up harvest job is to
look in that same directory where the

412
00:26:28,280 --> 00:26:29,360
Python pollack this

413
00:26:29,360 --> 00:26:32,370
it looks for files with a specific a

414
00:26:32,370 --> 00:26:37,720
file name: and if those files are there
you've got codex

415
00:26:37,720 --> 00:26:42,050
exact running within the pipe I thought
process and so

416
00:26:42,050 --> 00:26:45,160
senator in bed in just evil that P Y

417
00:26:45,160 --> 00:26:49,230
happily a seeded

418
00:26:49,230 --> 00:26:52,450
that temp folder with pollens the

419
00:26:52,450 --> 00:26:56,559
for the names but not to pull their then
put you hold up to you why

420
00:26:56,559 --> 00:27:02,390
right click could

421
00:27:02,390 --> 00:27:04,680
so surely thereafter

422
00:27:04,680 --> 00:27:08,400
Microsoft Lisa except this is a snippet

423
00:27:08,400 --> 00:27:12,020
a up wit from st. be explore

424
00:27:12,020 --> 00:27:16,280
doing st. Paul that they released I'll

425
00:27:16,280 --> 00:27:20,450
the holiday here and bowl this

426
00:27:20,450 --> 00:27:23,700
the showing the matching file

427
00:27:23,700 --> 00:27:29,460
entries in this particular case is
looking for packard ideal L

428
00:27:29,460 --> 00:27:33,610
so PowerPoint starts this

429
00:27:33,610 --> 00:27:38,010
doesn't actually do anything it waits
until packager dot deal I'll

430
00:27:38,010 --> 00:27:41,170
been loaded into the Park point
processes memory space

431
00:27:41,170 --> 00:27:44,330
if it does that there is going to apply
those Patra

432
00:27:44,330 --> 00:27:48,510
Petra arts plan for this

433
00:27:48,510 --> 00:27:51,740
information comes from surely but

434
00:27:51,740 --> 00:27:55,590
this Patra is for the following things

435
00:27:55,590 --> 00:27:58,710
it's going to first look a a particular

436
00:27:58,710 --> 00:28:02,910
role to virtual dress in the packard ID
law

437
00:28:02,910 --> 00:28:07,940
this case is looking for a call
instruction is going to replace it with

438
00:28:07,940 --> 00:28:14,150
assisi butts for up a report those

439
00:28:14,150 --> 00:28:17,930
as a of fact that this morning it this
is great

440
00:28:17,930 --> 00:28:21,650
somewhere but without some balls that's
kinda kinda useless

441
00:28:21,650 --> 00:28:24,700
was like all doing so

442
00:28:24,700 --> 00:28:28,670
to bring packager into and i dont look
at we can see that

443
00:28:28,670 --> 00:28:31,930
the Pickler call that they are hatching
out

444
00:28:31,930 --> 00:28:34,930
a was the call to get context menu

445
00:28:34,930 --> 00:28:38,400
and their have replaced it with the
suffering

446
00:28:38,400 --> 00:28:42,490
so now if if you got this installed

447
00:28:42,490 --> 00:28:45,870
and you were to double-click qualities
people power points

448
00:28:45,870 --> 00:28:49,590
in so doing the right click context menu
is going to do the supper break point

449
00:28:49,590 --> 00:28:50,000
which

450
00:28:50,000 --> 00:28:57,000
if you're not the bar at this point to
terminate the process so

451
00:28:57,200 --> 00:29:01,150
the real fix happen in november and what
they've done now

452
00:29:01,150 --> 00:29:04,770
is this a every time you

453
00:29:04,770 --> 00:29:08,640
go to do it do for right click context
menu

454
00:29:08,640 --> 00:29:13,410
it's not going to prompt the user and so

455
00:29:13,410 --> 00:29:18,700
the package you're about to open it will
run a program contained

456
00:29:18,700 --> 00:29:22,720
in the package that program can do
anything it may harm your computer

457
00:29:22,720 --> 00:29:26,580
unless you're absolutely certain about
the nature sourced press cancel

458
00:29:26,580 --> 00:29:31,060
so I read that I say okay I'm Press
Council some users like to click OK

459
00:29:31,060 --> 00:29:36,960
so aka

460
00:29:36,960 --> 00:29:40,950
so 100 how I figure out that

461
00:29:40,950 --> 00:29:44,380
the information that I had before I I
showed you

462
00:29:44,380 --> 00:29:47,640
it's going to do a look for these

463
00:29:47,640 --> 00:29:51,680
call instruction and it's going to
replace that with cc bikes

464
00:29:51,680 --> 00:29:55,310
I had to write my own talk to do that

465
00:29:55,310 --> 00:29:58,770
because know the existing tools out
there

466
00:29:58,770 --> 00:30:03,900
provided a any information on in memory
patches

467
00:30:03,900 --> 00:30:08,330
so for example if you take 1 I've the St
Paul's associated with

468
00:30:08,330 --> 00:30:13,240
the CV here which is 0322

469
00:30:13,240 --> 00:30:16,460
it targets in explore

470
00:30:16,460 --> 00:30:20,160
it's got matching felling trees for

471
00:30:20,160 --> 00:30:23,460
specific version so this been Paul
version as for I

472
00:30:23,460 --> 00:30:27,650
10 with this particular p check some and
then

473
00:30:27,650 --> 00:30:32,290
if that matches what happens it doesn't
nothing here there's no

474
00:30:32,290 --> 00:30:35,310
compatibility fixes no compatibility
mode

475
00:30:35,310 --> 00:30:39,050
so what the active thing do not very
helpful

476
00:30:39,050 --> 00:30:44,610
and on that the same matching files

477
00:30:44,610 --> 00:30:48,330
concept I added option to STB explore

478
00:30:48,330 --> 00:30:52,420
you got my nifty option and that will
show you all

479
00:30:52,420 --> 00:30:56,300
up the since the targets for the patch

480
00:30:56,300 --> 00:30:59,920
that's good go through those magical
entries and show you

481
00:30:59,920 --> 00:31:04,130
which particular deal else is gonna go
after so in this case for

482
00:31:04,130 --> 00:31:07,790
this 6253

483
00:31:07,790 --> 00:31:11,890
the Pixies going to target if that
particular

484
00:31:11,890 --> 00:31:15,470
version and check some packager dotted
dealers loaded

485
00:31:15,470 --> 00:31:18,920
and so if you don't have those
particular versions your in you've got

486
00:31:18,920 --> 00:31:19,850
the shame install

487
00:31:19,850 --> 00:31:26,850
is pretty much useless I

488
00:31:27,840 --> 00:31:31,530
show that yes there were up before but a
with my nifty

489
00:31:31,530 --> 00:31:34,800
prints the tree for this particular

490
00:31:34,800 --> 00:31:41,390
PowerPoint and what we see here is that

491
00:31:41,390 --> 00:31:44,520
it's got the message all entries at the
bottom

492
00:31:44,520 --> 00:31:47,630
has this dispatch tag ID

493
00:31:47,630 --> 00:31:51,120
number 746 and so that's

494
00:31:51,120 --> 00:31:54,150
I'm interested what is 746

495
00:31:54,150 --> 00:31:58,820
and on the in the left hand column all
these rows

496
00:31:58,820 --> 00:32:02,630
that's actually a tag ID

497
00:32:02,630 --> 00:32:06,610
in a tag ID is also the offset within

498
00:32:06,610 --> 00:32:09,620
the file so if you want to play around
30

499
00:32:09,620 --> 00:32:12,630
the files in bring them into a hex
editor

500
00:32:12,630 --> 00:32:17,600
that number relates to where it exists
in the filing also happens to be the tag

501
00:32:17,600 --> 00:32:18,220
ID

502
00:32:18,220 --> 00:32:22,700
so when I say patsy ID some 46

503
00:32:22,700 --> 00:32:27,340
or impacts to EA that's three to look
for that

504
00:32:27,340 --> 00:32:30,900
website when you're on

505
00:32:30,900 --> 00:32:34,330
a s2b to XML it all from

506
00:32:34,330 --> 00:32:37,760
that mike is a ploy the ther

507
00:32:37,760 --> 00:32:43,000
you're going to see 746 but if you take
the whole up with that they provided

508
00:32:43,000 --> 00:32:46,020
no word you see the numbers some 46 so

509
00:32:46,020 --> 00:32:49,340
I needed something to create the linkage

510
00:32:49,340 --> 00:32:52,440
you know this tag ID is related this

511
00:32:52,440 --> 00:32:56,390
Pat section within the same St pile and
so

512
00:32:56,390 --> 00:33:00,140
I did that here is the

513
00:33:00,140 --> 00:33:03,760
example a the top part

514
00:33:03,760 --> 00:33:07,720
a is for a pageantry can see that it
starts

515
00:33:07,720 --> 00:33:10,460
with to EA

516
00:33:10,460 --> 00:33:13,010
and then there's an associative patch
pics

517
00:33:13,010 --> 00:33:17,270
a section down the bottom

518
00:33:17,270 --> 00:33:21,300
you have P check some a pet reference

519
00:33:21,300 --> 00:33:25,840
and a patch i Gatti these all the things
that piloted in the red box

520
00:33:25,840 --> 00:33:29,850
are different ways that you can used
I'll

521
00:33:29,850 --> 00:33:34,220
they can pass to my program to print out
the patch details for you

522
00:33:34,220 --> 00:33:38,070
so here miss next slide

523
00:33:38,070 --> 00:33:41,560
I'm passing the ID to EA

524
00:33:41,560 --> 00:33:46,990
and I'm giving the mine is P option and
then that this will print out the

525
00:33:46,990 --> 00:33:48,760
details for that particular

526
00:33:48,760 --> 00:33:51,830
a version that I i've specified

527
00:33:51,830 --> 00:33:55,610
and we see that same up with that we saw
before its

528
00:33:55,610 --> 00:33:59,240
going to do a I'm match opcode

529
00:33:59,240 --> 00:34:03,510
I at a specific r-va within the Packers
that the low

530
00:34:03,510 --> 00:34:09,320
for those pie bites and then do a
replacement with those

531
00:34:09,320 --> 00:34:15,720
bites like I said before it's not very
useful without somebody else

532
00:34:15,720 --> 00:34:20,840
cited a a-minus I option and this
instead it will print out

533
00:34:20,840 --> 00:34:24,740
a i'd a Python script for you so then

534
00:34:24,740 --> 00:34:29,250
it's your job to go get that that
particular deal that you want you

535
00:34:29,250 --> 00:34:29,700
wouldn't

536
00:34:29,700 --> 00:34:34,919
I the the print out the associate script
that you want and we can take this

537
00:34:34,919 --> 00:34:41,919
its copy and paste it right into the I
don't skip window

538
00:34:42,790 --> 00:34:45,930
um services cover summary

539
00:34:45,930 --> 00:34:49,750
up my previous talk I I

540
00:34:49,750 --> 00:34:53,070
I explained all the features I'll the

541
00:34:53,070 --> 00:34:56,170
has to be explored tool that I wrote

542
00:34:56,170 --> 00:35:00,190
explain in very very

543
00:35:00,190 --> 00:35:03,460
detailed the in memory Pat file format

544
00:35:03,460 --> 00:35:07,500
and how I went down the path a figuring
it all out

545
00:35:07,500 --> 00:35:11,990
there's lotsa pictures affects don't
think cetera

546
00:35:11,990 --> 00:35:15,740
a if you're interested you can find the
stalking you too

547
00:35:15,740 --> 00:35:18,760
to search my name in block at find it

548
00:35:18,760 --> 00:35:22,390
a I showed how to

549
00:35:22,390 --> 00:35:25,660
I analyzed districts as I can assure you
that today as well

550
00:35:25,660 --> 00:35:30,280
and what I didn't read today is and
there's no tool

551
00:35:30,280 --> 00:35:34,700
out there size mind I'll allows you to
create your own injury

552
00:35:34,700 --> 00:35:37,930
patches and so

553
00:35:37,930 --> 00:35:42,210
II created a mechanism where you can
create conflict file

554
00:35:42,210 --> 00:35:45,240
where you specify the the program name

555
00:35:45,240 --> 00:35:49,900
the the model that you want to target
our view is that you want to target

556
00:35:49,900 --> 00:35:53,090
the bites that you want to search for
the bus that you want to replace ill

557
00:35:53,090 --> 00:35:54,930
take that information it will spit out

558
00:35:54,930 --> 00:35:58,450
a don't have to be fall for you if they
can then go

559
00:35:58,450 --> 00:36:04,450
I register I'm moving on to

560
00:36:04,450 --> 00:36:08,090
Chris Graham she made her way past you
AC

561
00:36:08,090 --> 00:36:12,430
so

562
00:36:12,430 --> 00:36:17,120
Windows has a sign files with

563
00:36:17,120 --> 00:36:21,190
was called auto elevate permission
example this is

564
00:36:21,190 --> 00:36:24,520
sound volume txt so

565
00:36:24,520 --> 00:36:29,310
I think early on Microsoft figured out
that people are getting annoyed by

566
00:36:29,310 --> 00:36:32,550
you a seat prompt happy in of time

567
00:36:32,550 --> 00:36:36,880
so every time you want to go change your
volume their Buse prompt

568
00:36:36,880 --> 00:36:40,020
the USC prompt and so Microsoft

569
00:36:40,020 --> 00:36:45,210
I traders auto elevate permission and
they say okay 10 sound volume assay

570
00:36:45,210 --> 00:36:49,990
now automatically wanted to elevate to
administrator privileges

571
00:36:49,990 --> 00:36:52,910
so Chris

572
00:36:52,910 --> 00:36:57,060
I noticed this and said okay wall if I
used to read

573
00:36:57,060 --> 00:37:01,540
redirect Exce shame type maybe I can

574
00:37:01,540 --> 00:37:04,950
redirect a an elevator process

575
00:37:04,950 --> 00:37:08,609
and then have my own process be elevated
and that's exactly

576
00:37:08,609 --> 00:37:11,650
what happens so

577
00:37:11,650 --> 00:37:16,730
the crater shame for some value that is
a redirect

578
00:37:16,730 --> 00:37:20,980
Exce to evil txt you register it

579
00:37:20,980 --> 00:37:24,430
using either ESPNs or a

580
00:37:24,430 --> 00:37:28,890
some other mechanism and you start some
value

581
00:37:28,890 --> 00:37:31,890
so some volume is

582
00:37:31,890 --> 00:37:35,839
been started by the windows loader the
winners lawyer says OK

583
00:37:35,839 --> 00:37:40,000
I I need to elevated well that's it

584
00:37:40,000 --> 00:37:43,020
and that is that okay well there's a
share money to apply and then place the

585
00:37:43,020 --> 00:37:43,470
ship

586
00:37:43,470 --> 00:37:46,599
missions as okay dupay process to evil

587
00:37:46,599 --> 00:37:50,250
evils elevated and then someone goes
away

588
00:37:50,250 --> 00:37:53,510
so a

589
00:37:53,510 --> 00:37:57,160
one other note is that there's a

590
00:37:57,160 --> 00:38:00,760
here with the whole list the processes
that have this article they prefer

591
00:38:00,760 --> 00:38:04,910
the STB instal buy microsoft has auto

592
00:38:04,910 --> 00:38:08,520
Ave permission so you can install

593
00:38:08,520 --> 00:38:12,200
shims using esta bien ce

594
00:38:12,200 --> 00:38:16,290
you know or I'll it's a long either has
ability to come

595
00:38:16,290 --> 00:38:19,710
administrator it will automatically do
that without prompting these are

596
00:38:19,710 --> 00:38:24,240
cycle about

597
00:38:24,240 --> 00:38:29,440
he met Microsoft's

598
00:38:29,440 --> 00:38:32,740
enhance medication experience ok it's I
believe the current version is

599
00:38:32,740 --> 00:38:36,630
a by .1 provides

600
00:38:36,630 --> 00:38:41,390
a whole suite of features a enables DUP

601
00:38:41,390 --> 00:38:45,680
I does military is a law are does some

602
00:38:45,680 --> 00:38:49,589
filtering in proper technique cetera and

603
00:38:49,589 --> 00:38:54,240
it's not that your whole system is
protected when you run he met

604
00:38:54,240 --> 00:38:58,839
there's a specific mister processes that
it actually works for

605
00:38:58,839 --> 00:39:01,480
and pretty sure this process is he could

606
00:39:01,480 --> 00:39:05,500
enable and disable these these features
so

607
00:39:05,500 --> 00:39:09,220
im it is actually

608
00:39:09,220 --> 00:39:12,740
are run through this shipment

609
00:39:12,740 --> 00:39:16,660
this application to bed early from work
and

610
00:39:16,660 --> 00:39:20,520
the same directory here this up patches
where the

611
00:39:20,520 --> 00:39:25,020
we had our system shame that we talked
about very early on with the outside of

612
00:39:25,020 --> 00:39:25,810
his work

613
00:39:25,810 --> 00:39:29,420
here they've ok

614
00:39:29,420 --> 00:39:34,730
Microsoft is create their own emit ideal
L and placed in this at Pats rectory

615
00:39:34,730 --> 00:39:38,060
and there's an associate 64 there as
well

616
00:39:38,060 --> 00:39:43,130
and so a few looked in the registry at
the locations we talked about before

617
00:39:43,130 --> 00:39:46,450
up for like say to explore which isn't

618
00:39:46,450 --> 00:39:51,310
and protected you'll find this entry it
says the davises for a minute

619
00:39:51,310 --> 00:39:55,060
and this is where the the file discs
exists

620
00:39:55,060 --> 00:39:58,310
Sophia look at that as to be file

621
00:39:58,310 --> 00:40:02,430
using has to be too so as to explore

622
00:40:02,430 --> 00:40:06,370
I'm on the bottom I'm showin

623
00:40:06,370 --> 00:40:09,410
Adobe Reader and

624
00:40:09,410 --> 00:40:14,150
there's a matching files entry for
abstract so doesn't care

625
00:40:14,150 --> 00:40:17,930
what version of Adobe Reader doesn't
care he checked some

626
00:40:17,930 --> 00:40:21,310
it's just going to match based on the
name

627
00:40:21,310 --> 00:40:24,500
it that matches going to apply this

628
00:40:24,500 --> 00:40:27,850
particular sham with the name is image
him and

629
00:40:27,850 --> 00:40:30,900
Tai Chi di is a to 8

630
00:40:30,900 --> 00:40:34,140
and there's two after eight

631
00:40:34,140 --> 00:40:37,890
the name again and the deal Elysium in
64

632
00:40:37,890 --> 00:40:41,030
that DLL so

633
00:40:41,030 --> 00:40:45,440
let's say I a double click Adobe Reader

634
00:40:45,440 --> 00:40:48,830
well as lower starts up it is OK theres

635
00:40:48,830 --> 00:40:53,090
share money to apply and said okay all
actually need to you

636
00:40:53,090 --> 00:40:56,570
load minutes 54 and so it loads

637
00:40:56,570 --> 00:41:00,050
emit 64 not deal well into the computer
process

638
00:41:00,050 --> 00:41:03,910
and then that de los responsible for
determining

639
00:41:03,910 --> 00:41:07,920
or on and foreseen the features that
have been enabled or disabled

640
00:41:07,920 --> 00:41:13,240
for that particular process in one thing

641
00:41:13,240 --> 00:41:16,720
a to note is that the

642
00:41:16,720 --> 00:41:21,050
this is I'll talk about that a minute

643
00:41:21,050 --> 00:41:25,970
talk about a couple on real-world
examples

644
00:41:25,970 --> 00:41:32,970
kept a surge protector

645
00:41:34,250 --> 00:41:37,450
like energy and the for fly

646
00:41:37,450 --> 00:41:41,340
so Cirque protects

647
00:41:41,340 --> 00:41:44,830
a potentially unwanted program a

648
00:41:44,830 --> 00:41:48,330
ad-aware a other actually

649
00:41:48,330 --> 00:41:52,380
use this I don't like at work but I'll
I've heard that

650
00:41:52,380 --> 00:41:55,850
it gives you lot serve advertisements
and the

651
00:41:55,850 --> 00:41:59,050
may be modified your search terms on

652
00:41:59,050 --> 00:42:02,850
this is actually I thought you seen a
pakistani paramilitary

653
00:42:02,850 --> 00:42:07,920
to a process so

654
00:42:07,920 --> 00:42:11,270
it's not it's not like this

655
00:42:11,270 --> 00:42:15,250
per room has a monitor process that's
constantly looking forward to kill the

656
00:42:15,250 --> 00:42:16,070
malware

657
00:42:16,070 --> 00:42:20,570
to restart itself this is actually using
optician dependability if I were to

658
00:42:20,570 --> 00:42:21,120
persist

659
00:42:21,120 --> 00:42:24,450
so uses you was the inject the lotion

660
00:42:24,450 --> 00:42:29,690
and it registers at four iron Explorer
and Firefox

661
00:42:29,690 --> 00:42:33,110
so if you double-click I E I starts

662
00:42:33,110 --> 00:42:38,390
witnesses okay there's a should money to
apply it does inject deal well with the

663
00:42:38,390 --> 00:42:41,210
search protect library right into the
IEEE

664
00:42:41,210 --> 00:42:46,740
process so every time mister I your
Firefox at Los steelo that deal I'll

665
00:42:46,740 --> 00:42:50,670
but took some functions provides
additional features for you

666
00:42:50,670 --> 00:42:54,320
on and it's currently

667
00:42:54,320 --> 00:42:58,570
I do it in a way that now re

668
00:42:58,570 --> 00:43:02,960
hasn't really done the past wanting to
know what the

669
00:43:02,960 --> 00:43:05,970
inject the lawless that a

670
00:43:05,970 --> 00:43:09,950
as far as I know it only works for
32-bit processors

671
00:43:09,950 --> 00:43:14,910
so if you're targeting 64 processes

672
00:43:14,910 --> 00:43:19,770
a its I don't think this could work for

673
00:43:19,770 --> 00:43:23,220
next up like energy this

674
00:43:23,220 --> 00:43:26,890
isn't everything from a obscure white
paper like energy

675
00:43:26,890 --> 00:43:30,800
where they say that the been recently
targeting the

676
00:43:30,800 --> 00:43:35,480
triggering and

677
00:43:35,480 --> 00:43:39,920
they used a USC bypassing think

678
00:43:39,920 --> 00:43:45,020
it's the same exact technique that Chris
Graham documented and I'm not sure

679
00:43:45,020 --> 00:43:49,599
exactly which will happen first tip like
energy didn't think I saw and talked

680
00:43:49,599 --> 00:43:50,599
about it or

681
00:43:50,599 --> 00:43:54,109
Crist you know published this blog in
the black and the authors

682
00:43:54,109 --> 00:43:59,650
figure it out and decide to use it they
also mentioned

683
00:43:59,650 --> 00:44:03,250
in the the paper that they did that
driver sunny bypass and

684
00:44:03,250 --> 00:44:07,380
my first initial thought was that they
were using shams 2

685
00:44:07,380 --> 00:44:11,170
to do this but a I talked with the

686
00:44:11,170 --> 00:44:15,530
Anton comment here in a minute and he
said that's not the case basically

687
00:44:15,530 --> 00:44:18,940
to do their driver sunny bypass is
possible to

688
00:44:18,940 --> 00:44:22,020
put your computer into developer mode

689
00:44:22,020 --> 00:44:25,050
and then its you have the ability to
load

690
00:44:25,050 --> 00:44:28,260
unsigned drivers but a side effect a
beautiful

691
00:44:28,260 --> 00:44:32,900
road as they provide this notification
on the bottom I look inside your screen

692
00:44:32,900 --> 00:44:33,690
saying that

693
00:44:33,690 --> 00:44:36,800
you are in developer mode and obviously
user

694
00:44:36,800 --> 00:44:40,609
might be confused by that time I think
something's up so

695
00:44:40,609 --> 00:44:44,540
the authors of this now where a new

696
00:44:44,540 --> 00:44:49,080
that the string this is the open road is
just and a resource file

697
00:44:49,080 --> 00:44:53,349
so they went that prefer file for every
language and pass out that string with

698
00:44:53,349 --> 00:44:58,200
dunno whats so

699
00:44:58,200 --> 00:45:01,240
and Tom the city over there

700
00:45:01,240 --> 00:45:05,330
from your city reported as your nights
and

701
00:45:05,330 --> 00:45:08,830
a November about

702
00:45:08,830 --> 00:45:13,530
the this very adult park-like and

703
00:45:13,530 --> 00:45:16,570
he show that the

704
00:45:16,570 --> 00:45:20,570
the malware itself dropped to piles into
the Windows

705
00:45:20,570 --> 00:45:24,119
up at structure 10 which is called

706
00:45:24,119 --> 00:45:26,920
AC protected the low

707
00:45:26,920 --> 00:45:29,900
then it also dropped a shame database
file

708
00:45:29,900 --> 00:45:33,940
into up at custom directory and record
it

709
00:45:33,940 --> 00:45:37,160
we take a look at the st. Paul

710
00:45:37,160 --> 00:45:41,780
using to explore we could see that

711
00:45:41,780 --> 00:45:44,910
a there's actually two a

712
00:45:44,910 --> 00:45:49,000
processes names that are listed here 132
to EXE

713
00:45:49,000 --> 00:45:52,650
and exporter XD %uh the first one

714
00:45:52,650 --> 00:45:56,650
you can see that again it's got that
matching files

715
00:45:56,650 --> 00:46:00,770
Astrix so as long as the process name
matches it's going to apply

716
00:46:00,770 --> 00:46:04,170
this particular shim and then

717
00:46:04,170 --> 00:46:07,550
the shame is listed as AC protect that
deal

718
00:46:07,550 --> 00:46:13,250
and so this is the same exact style and
we just talk about the minute

719
00:46:13,250 --> 00:46:17,980
tell you that works and the advantage of
this technique

720
00:46:17,980 --> 00:46:21,180
over inject de Lollis

721
00:46:21,180 --> 00:46:24,220
we saw the email at work for both 32-bit
and 64-bit

722
00:46:24,220 --> 00:46:28,030
a process so you could provide a

723
00:46:28,030 --> 00:46:32,970
in this case a secret act for a third to
bitburg love it into private 64-bit

724
00:46:32,970 --> 00:46:33,730
version of it

725
00:46:33,730 --> 00:46:37,410
and then you have a STB file which will

726
00:46:37,410 --> 00:46:40,680
one for 32-bit for 64-bit annual

727
00:46:40,680 --> 00:46:47,580
you know magic they just work for for
their own so

728
00:46:47,580 --> 00:46:52,770
this all sounds bad which we do about it

729
00:46:52,770 --> 00:46:57,180
I'll its it's possible to disable the
same engine

730
00:46:57,180 --> 00:47:00,250
I don't recommend this though

731
00:47:00,250 --> 00:47:03,920
its gonna break a minute and

732
00:47:03,920 --> 00:47:07,480
you no one knows like all the things we
talked about today

733
00:47:07,480 --> 00:47:11,510
are all threw up his incompatibility so
if you

734
00:47:11,510 --> 00:47:17,220
to disable this you disable the good and
disable about so

735
00:47:17,220 --> 00:47:20,830
I think there's there's better

736
00:47:20,830 --> 00:47:25,780
there's a better gains from having it in
your system so

737
00:47:25,780 --> 00:47:30,050
I don't recommend disabling it if you do
want to disable it

738
00:47:30,050 --> 00:47:32,800
a provide the path there to do that
through

739
00:47:32,800 --> 00:47:38,609
Group Policy Editor and

740
00:47:38,609 --> 00:47:42,030
so

741
00:47:42,030 --> 00:47:45,349
I think everyone should be you know

742
00:47:45,349 --> 00:47:49,119
is no to get here be aware of %uh this
technique out there

743
00:47:49,119 --> 00:47:52,619
and like I said all these

744
00:47:52,619 --> 00:47:55,820
different think they talked about today
all require

745
00:47:55,820 --> 00:48:00,030
on those those to registry entries that
I mentioned

746
00:48:00,030 --> 00:48:03,530
i rly on the top seeking go search their

747
00:48:03,530 --> 00:48:07,780
you know is something there that
shouldn't be in further investigate from

748
00:48:07,780 --> 00:48:10,050
that path I'll

749
00:48:10,050 --> 00:48:14,930
the Sysinternals tool all the wrongs
does not currently consider

750
00:48:14,930 --> 00:48:17,940
a application compatibility fixes

751
00:48:17,940 --> 00:48:20,980
as a method for processes for talkers
and

752
00:48:20,980 --> 00:48:24,270
but they're working on it I

753
00:48:24,270 --> 00:48:29,300
spoke with Mark our son a bitch and he
know it back it said

754
00:48:29,300 --> 00:48:32,369
while I'm shot this didn't happen five
years ago

755
00:48:32,369 --> 00:48:36,950
and he said he'll try to get something
together in a couple months

756
00:48:36,950 --> 00:48:40,170
I think that Microsoft at

757
00:48:40,170 --> 00:48:45,010
center support sirs at signatures that
we file so that

758
00:48:45,010 --> 00:48:48,040
if I run into explore and the

759
00:48:48,040 --> 00:48:52,560
Windows OS is about to inject a a deal
or

760
00:48:52,560 --> 00:48:55,650
run a shame that's posted provide some

761
00:48:55,650 --> 00:48:59,300
additional features to my browser I want
to be aware that but

762
00:48:59,300 --> 00:49:03,940
I only wanna be where if it's something
that Microsoft interpreters

763
00:49:03,940 --> 00:49:09,430
thats should be doable

764
00:49:09,430 --> 00:49:13,830
so the this is a new method

765
00:49:13,830 --> 00:49:18,970
attackers are using today this is not a
vulnerability

766
00:49:18,970 --> 00:49:22,890
this is not really exploit their just
exploding

767
00:49:22,890 --> 00:49:27,490
feature this feature that has been in
Windows and Windows XP

768
00:49:27,490 --> 00:49:30,560
and defenders for

769
00:49:30,560 --> 00:49:34,620
should for sure peace still looking for
this on your computer's

770
00:49:34,620 --> 00:49:38,840
and again that has to be

771
00:49:38,840 --> 00:49:42,370
a s2000

772
00:49:42,370 --> 00:49:45,380
fire Minister Bob it in stock so

773
00:49:45,380 --> 00:49:49,220
restrict users so that they can a or
will that

774
00:49:49,220 --> 00:49:53,610
and require a attackers have to

775
00:49:53,610 --> 00:49:57,370
first two some type elevation of
privilege attack to be able to you

776
00:49:57,370 --> 00:50:02,980
install these three balls I hear some
references

777
00:50:02,980 --> 00:50:06,050
but I used I like to

778
00:50:06,050 --> 00:50:10,210
think my family friends and F lee the
code blue

779
00:50:10,210 --> 00:50:14,970
stop a and before questions

780
00:50:14,970 --> 00:50:18,700
a a quote day from yesterday I'm ready
to party

781
00:50:18,700 --> 00:50:22,130
so a

782
00:50:22,130 --> 00:50:25,440
the source code for SB explores on the
harp

783
00:50:25,440 --> 00:50:29,880
I'll a playoff team soon I had no idea
anyone actually

784
00:50:29,880 --> 00:50:33,280
was aware that are used to it and I
spoke with Anton

785
00:50:33,280 --> 00:50:36,730
and he used to eat only couple bugs and
I was like oh

786
00:50:36,730 --> 00:50:39,730
I was aware and it was actually using my
coat so

787
00:50:39,730 --> 00:50:44,030
if you have any questions comments about
it please let me know so I can

788
00:50:44,030 --> 00:50:47,050
maintain otherwise it's gonna sit there
and do nothing so

789
00:50:47,050 --> 00:50:51,060
I will be fixing the bug sees the
disclosed me and

790
00:50:51,060 --> 00:50:54,170
provide some updates will have time

791
00:50:54,170 --> 00:50:58,650
here by email a she questions over email

792
00:50:58,650 --> 00:51:04,110
right here or tonight up to you you
there

793
00:51:04,110 --> 00:51:07,190
a new reason why there is no
authentication

794
00:51:07,190 --> 00:51:08,420
in the

795
00:51:08,420 --> 00:51:13,549
STB files other than administrator but
like you my presentation issue meets

796
00:51:13,549 --> 00:51:17,039
okay and ir other companies

797
00:51:17,039 --> 00:51:21,420
using these files to fix or is just a
Microsoft thing and they are not

798
00:51:21,420 --> 00:51:24,569
doing code signing but because they

799
00:51:24,569 --> 00:51:29,170
been sought about these so why Microsoft
chose not to

800
00:51:29,170 --> 00:51:33,710
at us type authentication I I don't know

801
00:51:33,710 --> 00:51:37,029
group

802
00:51:37,029 --> 00:51:40,079
any comment on that a their

803
00:51:40,079 --> 00:51:44,809
nuon using this for I'll matches because
it

804
00:51:44,809 --> 00:51:48,829
it's a very powerful tool for doing
temporary patches

805
00:51:48,829 --> 00:51:53,329
went to fix temporary staff I I haven't
seen many examples

806
00:51:53,329 --> 00:51:58,690
I besides you know there's a there's a
few games out there that

807
00:51:58,690 --> 00:52:01,809
uses for sure I'll and

808
00:52:01,809 --> 00:52:04,940
but i i do think this might be a good

809
00:52:04,940 --> 00:52:09,450
mechanism for maybe antivirus vendors to
inject code into processes are you know

810
00:52:09,450 --> 00:52:10,009
different the

811
00:52:10,009 --> 00:52:15,039
for for debugging purposes but not a lot
of people out there talking about right

812
00:52:15,039 --> 00:52:15,289
now

