1
00:00:00,359 --> 00:00:03,540
good evening it's nice to be back

2
00:00:03,540 --> 00:00:05,759
the three years

3
00:00:05,759 --> 00:00:07,560
um I really missed all of you I missed

4
00:00:07,560 --> 00:00:09,660
the city and I missed us coming together

5
00:00:09,660 --> 00:00:11,519
as a community

6
00:00:11,519 --> 00:00:14,099
um and on that note happy anniversary

7
00:00:14,099 --> 00:00:15,360
Code Blue

8
00:00:15,360 --> 00:00:18,720
thank you so much for Kana kentaro and

9
00:00:18,720 --> 00:00:20,340
of course Tessie whoever they might be

10
00:00:20,340 --> 00:00:22,260
hiding right now for for starting this

11
00:00:22,260 --> 00:00:23,699
10 years ago

12
00:00:23,699 --> 00:00:26,300
um I always loved coming here and

13
00:00:26,300 --> 00:00:28,980
connecting with the same people

14
00:00:28,980 --> 00:00:31,260
um on that note I'm speaking yet again

15
00:00:31,260 --> 00:00:34,440
on Telco Security today

16
00:00:34,440 --> 00:00:38,520
um 5G last time I forget what network

17
00:00:38,520 --> 00:00:41,100
generation I spoke on probably 4G so we

18
00:00:41,100 --> 00:00:43,500
keep finding new vulnerabilities and in

19
00:00:43,500 --> 00:00:45,600
each new technology that's added to

20
00:00:45,600 --> 00:00:47,280
mobile networks

21
00:00:47,280 --> 00:00:49,140
specifically today though I want to

22
00:00:49,140 --> 00:00:51,420
focus on the elements of a 5G Network

23
00:00:51,420 --> 00:00:54,600
that can act as a case study for all

24
00:00:54,600 --> 00:00:56,520
other technology that we're rolling out

25
00:00:56,520 --> 00:00:59,340
right now 5G networks are converging

26
00:00:59,340 --> 00:01:01,379
with other Technologies they're becoming

27
00:01:01,379 --> 00:01:03,719
Cloud environments they're becoming

28
00:01:03,719 --> 00:01:06,900
highly automated and so are your systems

29
00:01:06,900 --> 00:01:08,640
it doesn't matter what industry you're

30
00:01:08,640 --> 00:01:11,100
working in you are also going into the

31
00:01:11,100 --> 00:01:12,840
cloud and you're adding a lot of

32
00:01:12,840 --> 00:01:15,420
automation so there's some lessons to be

33
00:01:15,420 --> 00:01:18,540
learned from from how telcos roll out

34
00:01:18,540 --> 00:01:21,240
mobile networks today lessons that you

35
00:01:21,240 --> 00:01:23,460
want to apply to whatever infrastructure

36
00:01:23,460 --> 00:01:25,560
you're working on

37
00:01:25,560 --> 00:01:26,520
um

38
00:01:26,520 --> 00:01:29,220
my name is carsten I've been working as

39
00:01:29,220 --> 00:01:31,979
a mobile security hacker for for many

40
00:01:31,979 --> 00:01:33,840
years through through my company in

41
00:01:33,840 --> 00:01:35,579
Berlin and Germany

42
00:01:35,579 --> 00:01:38,040
um but I've also regularly been asked to

43
00:01:38,040 --> 00:01:40,740
help make mobile networks more secure

44
00:01:40,740 --> 00:01:43,200
from the inside so and I can tell you

45
00:01:43,200 --> 00:01:45,060
hacking mobile networks is not easy but

46
00:01:45,060 --> 00:01:47,520
trying to make them secure that's

47
00:01:47,520 --> 00:01:50,360
another challenge entirely and

48
00:01:50,360 --> 00:01:52,680
my team and I will we love going back

49
00:01:52,680 --> 00:01:54,960
and forth between breaking something and

50
00:01:54,960 --> 00:01:57,960
then thinking about what it takes to

51
00:01:57,960 --> 00:02:00,840
structurally fix those issues and we've

52
00:02:00,840 --> 00:02:02,399
been basically doing this through

53
00:02:02,399 --> 00:02:04,680
through all the technology Generations

54
00:02:04,680 --> 00:02:08,520
that today make up mobile networks that

55
00:02:08,520 --> 00:02:10,619
are basically patchworks of all of this

56
00:02:10,619 --> 00:02:12,540
none of this has ever been switched off

57
00:02:12,540 --> 00:02:15,060
as far as I can tell and of course I'm

58
00:02:15,060 --> 00:02:18,060
not doing this alone and even this is

59
00:02:18,060 --> 00:02:20,940
just a small subset of of the Geniuses

60
00:02:20,940 --> 00:02:23,879
I'm working with in Berlin

61
00:02:23,879 --> 00:02:27,660
um today 5G so what is a 5G Network

62
00:02:27,660 --> 00:02:30,959
um there's different versions of of 5G

63
00:02:30,959 --> 00:02:33,060
infrastructure depending on where the

64
00:02:33,060 --> 00:02:34,260
company

65
00:02:34,260 --> 00:02:36,420
um is when they start rolling out the 5G

66
00:02:36,420 --> 00:02:39,480
Network most companies let's say here in

67
00:02:39,480 --> 00:02:41,940
Japan there would be SoftBank kddi and

68
00:02:41,940 --> 00:02:43,620
docomo they already have a mobile

69
00:02:43,620 --> 00:02:46,260
network so the first step in rolling it

70
00:02:46,260 --> 00:02:49,379
out is to take the 4G network and just

71
00:02:49,379 --> 00:02:52,080
put some 5G antennas on it so the actual

72
00:02:52,080 --> 00:02:54,360
technology doesn't change just the the

73
00:02:54,360 --> 00:02:56,459
radio waves change so to speak right

74
00:02:56,459 --> 00:03:00,000
that does not do much about security

75
00:03:00,000 --> 00:03:02,760
risk so whatever security risk you had

76
00:03:02,760 --> 00:03:04,980
in 4G you still have in 5G then on the

77
00:03:04,980 --> 00:03:07,739
core side what's more interesting to me

78
00:03:07,739 --> 00:03:09,900
is if you build a network completely

79
00:03:09,900 --> 00:03:12,780
from scratch I believe here in Japan for

80
00:03:12,780 --> 00:03:14,760
instance Rakuten mobile is doing that

81
00:03:14,760 --> 00:03:17,280
they did not have an old mobile network

82
00:03:17,280 --> 00:03:20,280
so they basically don't have anything to

83
00:03:20,280 --> 00:03:22,739
to latch on to in terms of Legacy

84
00:03:22,739 --> 00:03:24,360
instead of building it completely from

85
00:03:24,360 --> 00:03:27,659
scratch and that is where everybody will

86
00:03:27,659 --> 00:03:30,599
ultimately be heading building real 5G

87
00:03:30,599 --> 00:03:32,819
networks where the core and the radio

88
00:03:32,819 --> 00:03:34,940
waves are 5G

89
00:03:34,940 --> 00:03:37,620
some of those will be more open than

90
00:03:37,620 --> 00:03:40,379
others and today generally we want to

91
00:03:40,379 --> 00:03:42,840
focus on those but I'll say a little bit

92
00:03:42,840 --> 00:03:45,959
about these upgraded Legacy networks as

93
00:03:45,959 --> 00:03:47,220
well

94
00:03:47,220 --> 00:03:47,940
um

95
00:03:47,940 --> 00:03:51,239
starting in fact with with

96
00:03:51,239 --> 00:03:53,400
model Legacy and then going more into

97
00:03:53,400 --> 00:03:55,319
what we currently see and what all

98
00:03:55,319 --> 00:03:57,180
mobile networks at some point will look

99
00:03:57,180 --> 00:04:00,060
like and like I said before this has a

100
00:04:00,060 --> 00:04:01,680
lot of lessons to be learned for us

101
00:04:01,680 --> 00:04:03,659
infrastructure everybody who goes into

102
00:04:03,659 --> 00:04:05,519
the cloud everybody who adopts

103
00:04:05,519 --> 00:04:08,120
automation

104
00:04:08,280 --> 00:04:09,060
um

105
00:04:09,060 --> 00:04:10,980
yeah but why do we have to speak about

106
00:04:10,980 --> 00:04:13,500
mobile security at all anymore

107
00:04:13,500 --> 00:04:16,019
um thanks to very good research and and

108
00:04:16,019 --> 00:04:18,959
the gsma and three gpp's efforts to

109
00:04:18,959 --> 00:04:21,298
respond to it today mobile security

110
00:04:21,298 --> 00:04:24,060
standards uh um as far as I can tell

111
00:04:24,060 --> 00:04:26,100
pretty much free of security issues

112
00:04:26,100 --> 00:04:27,900
there's good encryption there's good

113
00:04:27,900 --> 00:04:31,020
authentication so why do we still worry

114
00:04:31,020 --> 00:04:33,660
about mobile security in fact the type

115
00:04:33,660 --> 00:04:36,120
of hacking that we did around 2G where

116
00:04:36,120 --> 00:04:37,979
you just take up an antenna and you

117
00:04:37,979 --> 00:04:39,960
listen to your neighbor's phone call

118
00:04:39,960 --> 00:04:42,300
that had already been eradicated with 3G

119
00:04:42,300 --> 00:04:44,280
so it were multiple Network Generations

120
00:04:44,280 --> 00:04:48,060
better than easily hackable networks and

121
00:04:48,060 --> 00:04:50,000
not just listening on your neighbor

122
00:04:50,000 --> 00:04:52,320
intercepting has become more difficult

123
00:04:52,320 --> 00:04:54,960
the other threats like uh impersonation

124
00:04:54,960 --> 00:04:57,600
which is related to fraud has become

125
00:04:57,600 --> 00:05:00,780
much more difficult and so has denial of

126
00:05:00,780 --> 00:05:02,580
service denial of server is never going

127
00:05:02,580 --> 00:05:04,740
to go away entirely this is a radio

128
00:05:04,740 --> 00:05:07,500
technology so you can always jam it but

129
00:05:07,500 --> 00:05:10,320
with that remaining risk the the mobile

130
00:05:10,320 --> 00:05:12,660
security standards we have today are

131
00:05:12,660 --> 00:05:15,240
pretty much as good as we need it and I

132
00:05:15,240 --> 00:05:16,620
believe the same is true for for

133
00:05:16,620 --> 00:05:18,380
instance Wi-Fi

134
00:05:18,380 --> 00:05:21,060
wpa3 which is now being rolled out looks

135
00:05:21,060 --> 00:05:23,580
like the standard to keep right

136
00:05:23,580 --> 00:05:26,699
but mobile networks are not just these

137
00:05:26,699 --> 00:05:28,620
good ideas of how to improve the

138
00:05:28,620 --> 00:05:30,660
standards I'm just showing these uh

139
00:05:30,660 --> 00:05:33,479
illness as illustrative all of these uh

140
00:05:33,479 --> 00:05:35,580
ideas that were introduced with 5G to

141
00:05:35,580 --> 00:05:37,500
make these networks even even more

142
00:05:37,500 --> 00:05:39,780
secure mobile network

143
00:05:39,780 --> 00:05:43,680
um first of all are very complex in it

144
00:05:43,680 --> 00:05:45,539
environments and that's what we're going

145
00:05:45,539 --> 00:05:47,880
to focus on today uh to then ultimately

146
00:05:47,880 --> 00:05:51,600
show how you can go through a 5G Network

147
00:05:51,600 --> 00:05:55,139
um to again impersonate users to listen

148
00:05:55,139 --> 00:05:57,060
to the phone calls or read their text

149
00:05:57,060 --> 00:05:58,979
messages much more interesting in a

150
00:05:58,979 --> 00:06:00,840
world of two-factor authentication text

151
00:06:00,840 --> 00:06:03,840
message is a Great Theft Target how you

152
00:06:03,840 --> 00:06:06,180
can take down the network so in about 20

153
00:06:06,180 --> 00:06:08,580
minutes we'll have seen how all of this

154
00:06:08,580 --> 00:06:12,120
is possible even though the 5G standards

155
00:06:12,120 --> 00:06:14,639
are so much better than previous

156
00:06:14,639 --> 00:06:17,479
standards and in fact

157
00:06:17,479 --> 00:06:21,600
these these uh this Evolution towards

158
00:06:21,600 --> 00:06:24,060
better mobile standards should not

159
00:06:24,060 --> 00:06:26,639
distract from other Technologies running

160
00:06:26,639 --> 00:06:29,160
in mobile networks that are sometimes

161
00:06:29,160 --> 00:06:32,280
heavily outdated when 2G was introduced

162
00:06:32,280 --> 00:06:35,160
in the late 80s it was introduced

163
00:06:35,160 --> 00:06:37,080
together with ss7 in interconnect

164
00:06:37,080 --> 00:06:40,259
standard we're still using ss7 today for

165
00:06:40,259 --> 00:06:42,720
5G networks it's just no Alternatives

166
00:06:42,720 --> 00:06:46,259
that have quite a quite the same Global

167
00:06:46,259 --> 00:06:48,360
rollout

168
00:06:48,360 --> 00:06:49,380
um

169
00:06:49,380 --> 00:06:51,479
but

170
00:06:51,479 --> 00:06:53,039
even that we're not going to talk about

171
00:06:53,039 --> 00:06:55,199
today but we want to focus on the

172
00:06:55,199 --> 00:06:57,060
technical infrastructure underpinning

173
00:06:57,060 --> 00:06:59,340
these networks so a mobile network even

174
00:06:59,340 --> 00:07:01,560
with the best standards has to be built

175
00:07:01,560 --> 00:07:04,020
somehow needs to run on some I.T

176
00:07:04,020 --> 00:07:05,220
environments

177
00:07:05,220 --> 00:07:07,259
um and our team environments are now

178
00:07:07,259 --> 00:07:09,960
moving into the cloud so most of what

179
00:07:09,960 --> 00:07:12,479
we're going to talk about today

180
00:07:12,479 --> 00:07:14,539
um

181
00:07:14,639 --> 00:07:16,740
will be around those Technologies let's

182
00:07:16,740 --> 00:07:18,000
start though

183
00:07:18,000 --> 00:07:21,780
um was was a the present state so a 4G

184
00:07:21,780 --> 00:07:24,360
network that was upgraded to 5G when we

185
00:07:24,360 --> 00:07:26,940
do panthers in those environments we

186
00:07:26,940 --> 00:07:30,180
find them to be heavily behind the curve

187
00:07:30,180 --> 00:07:33,120
in terms of I.T security missing patches

188
00:07:33,120 --> 00:07:36,020
missing missing hardening settings

189
00:07:36,020 --> 00:07:38,759
weak authentication

190
00:07:38,759 --> 00:07:41,160
um basically like you would have built a

191
00:07:41,160 --> 00:07:43,440
normal it Network in the 90s or early

192
00:07:43,440 --> 00:07:44,639
2000s

193
00:07:44,639 --> 00:07:47,460
mobile networks that we have today are

194
00:07:47,460 --> 00:07:49,319
suffering from those same issues and

195
00:07:49,319 --> 00:07:50,759
they're not going to go away like we

196
00:07:50,759 --> 00:07:52,500
said those networks just get new

197
00:07:52,500 --> 00:07:54,000
antennas now

198
00:07:54,000 --> 00:07:55,860
um and they become accessible to all of

199
00:07:55,860 --> 00:07:59,160
you so mobile networks basically rely in

200
00:07:59,160 --> 00:08:01,680
their security on being shielded away

201
00:08:01,680 --> 00:08:03,360
from everybody as soon as you have

202
00:08:03,360 --> 00:08:04,860
access to those

203
00:08:04,860 --> 00:08:07,620
IP networks that run those components

204
00:08:07,620 --> 00:08:12,000
you can usually use standard exploits

205
00:08:12,000 --> 00:08:13,979
weak passwords and all that that

206
00:08:13,979 --> 00:08:15,660
standard pen testing stuff to to

207
00:08:15,660 --> 00:08:18,360
penetrate the network right so let's

208
00:08:18,360 --> 00:08:20,280
let's look forward what uh what's what's

209
00:08:20,280 --> 00:08:23,039
the evolution now what's changing

210
00:08:23,039 --> 00:08:24,840
um two things are mostly changing well

211
00:08:24,840 --> 00:08:27,240
three but I'm not really interested in

212
00:08:27,240 --> 00:08:29,520
in this aspect here that makes networks

213
00:08:29,520 --> 00:08:31,379
basically cheaper everybody else's

214
00:08:31,379 --> 00:08:33,179
though right cheaper is always a good

215
00:08:33,179 --> 00:08:35,339
reason for rollout but cheaper in this

216
00:08:35,339 --> 00:08:38,099
case comes packaged with

217
00:08:38,099 --> 00:08:40,559
Cloud Technologies so virtualization

218
00:08:40,559 --> 00:08:43,020
often in form of containers running on

219
00:08:43,020 --> 00:08:46,080
kubernetes as well as Automation and

220
00:08:46,080 --> 00:08:48,240
there's a there's a good reason you

221
00:08:48,240 --> 00:08:50,459
would want to use both of those in fact

222
00:08:50,459 --> 00:08:52,920
you can't really deliver on the Promises

223
00:08:52,920 --> 00:08:55,380
of 5G without a high level of

224
00:08:55,380 --> 00:08:57,600
virtualization and automation

225
00:08:57,600 --> 00:09:01,080
and one of those main Promises of 5G of

226
00:09:01,080 --> 00:09:04,680
course is low latency low latency means

227
00:09:04,680 --> 00:09:07,440
you need data centers very close to the

228
00:09:07,440 --> 00:09:10,019
user so having a central data center

229
00:09:10,019 --> 00:09:12,779
some of our country isn't enough anymore

230
00:09:12,779 --> 00:09:14,459
um in Germany they're building a mobile

231
00:09:14,459 --> 00:09:18,060
network right now it takes 500 data

232
00:09:18,060 --> 00:09:21,120
centers for a small country like Germany

233
00:09:21,120 --> 00:09:23,100
to deliver on the low latency promises

234
00:09:23,100 --> 00:09:27,300
right so the old Paradigm of building an

235
00:09:27,300 --> 00:09:28,860
operating mobile networks doesn't work

236
00:09:28,860 --> 00:09:31,019
anymore and let's remind ourselves what

237
00:09:31,019 --> 00:09:33,480
was that old Paradigm you build out

238
00:09:33,480 --> 00:09:36,420
infrastructure slowly across an entire

239
00:09:36,420 --> 00:09:39,420
country and then some a small team of

240
00:09:39,420 --> 00:09:41,700
really experienced let's call them Linux

241
00:09:41,700 --> 00:09:44,160
administrators locks into each of those

242
00:09:44,160 --> 00:09:46,800
boxes and configures them this is a once

243
00:09:46,800 --> 00:09:48,540
in a generation thing right you're

244
00:09:48,540 --> 00:09:50,820
rolling out this network one step at a

245
00:09:50,820 --> 00:09:52,680
time and then you never touch the

246
00:09:52,680 --> 00:09:54,720
running system anymore right I mean you

247
00:09:54,720 --> 00:09:56,459
might touch it maybe once or twice a

248
00:09:56,459 --> 00:09:59,459
year to install software updates at most

249
00:09:59,459 --> 00:10:02,880
right and you do this on a few dozen

250
00:10:02,880 --> 00:10:04,980
notes in your core Network most of the

251
00:10:04,980 --> 00:10:07,019
time right everything is centralized

252
00:10:07,019 --> 00:10:09,240
everything is stable

253
00:10:09,240 --> 00:10:12,060
now let's come back to the 5G World 500

254
00:10:12,060 --> 00:10:14,279
data centers each of those running

255
00:10:14,279 --> 00:10:17,339
multiple functions so we're talking tens

256
00:10:17,339 --> 00:10:18,959
of thousands of functional units

257
00:10:18,959 --> 00:10:21,420
deployed in the country and all of those

258
00:10:21,420 --> 00:10:24,660
constantly changing because the another

259
00:10:24,660 --> 00:10:28,440
promise of 5G is of smart Edge so

260
00:10:28,440 --> 00:10:31,019
computation happening closer to the

261
00:10:31,019 --> 00:10:33,740
customer gaming

262
00:10:33,740 --> 00:10:36,480
Automotive something more industrial

263
00:10:36,480 --> 00:10:38,640
focused whatever you can think of as a

264
00:10:38,640 --> 00:10:40,620
future application of 5G you don't have

265
00:10:40,620 --> 00:10:42,660
to build it into the network today you

266
00:10:42,660 --> 00:10:44,760
can just roll it out as you need it so

267
00:10:44,760 --> 00:10:47,220
tens of thousands of of functional units

268
00:10:47,220 --> 00:10:49,560
that are changing regularly

269
00:10:49,560 --> 00:10:51,779
so you can't manually with that small

270
00:10:51,779 --> 00:10:54,180
team of Linux admins administrated and

271
00:10:54,180 --> 00:10:57,380
in more instead this is all scripted

272
00:10:57,380 --> 00:11:00,060
mobile networks are today built in

273
00:11:00,060 --> 00:11:02,160
clouds using Scripts

274
00:11:02,160 --> 00:11:03,839
so that's the first component that is

275
00:11:03,839 --> 00:11:05,820
highly virtualized the second component

276
00:11:05,820 --> 00:11:07,620
is that these scripts of course need to

277
00:11:07,620 --> 00:11:10,260
be created in some kind of automated

278
00:11:10,260 --> 00:11:13,200
Pipeline and now the attack service of

279
00:11:13,200 --> 00:11:16,200
course has changed dramatically what the

280
00:11:16,200 --> 00:11:18,240
first big changes you go from dozens of

281
00:11:18,240 --> 00:11:20,279
units to tens of thousands that

282
00:11:20,279 --> 00:11:22,079
potentially have some security issues

283
00:11:22,079 --> 00:11:24,180
and you go from a small group of

284
00:11:24,180 --> 00:11:26,640
experienced people to literally hundreds

285
00:11:26,640 --> 00:11:28,740
of developers that are somehow involved

286
00:11:28,740 --> 00:11:32,160
in in this automation scripts right so a

287
00:11:32,160 --> 00:11:35,040
much much broader set of both technology

288
00:11:35,040 --> 00:11:37,620
and people that impact the technology of

289
00:11:37,620 --> 00:11:40,079
your mobile network and again substitute

290
00:11:40,079 --> 00:11:41,459
mobile network with whatever

291
00:11:41,459 --> 00:11:44,040
infrastructure you're involved in and I

292
00:11:44,040 --> 00:11:45,959
think the same lesson still stick where

293
00:11:45,959 --> 00:11:49,320
we're broadening the trust base so to

294
00:11:49,320 --> 00:11:50,160
speak

295
00:11:50,160 --> 00:11:52,260
so let's look at each of those in turn

296
00:11:52,260 --> 00:11:53,880
first

297
00:11:53,880 --> 00:11:54,660
um

298
00:11:54,660 --> 00:11:58,140
virtualization and then Automation and

299
00:11:58,140 --> 00:11:59,339
remind ourselves what security

300
00:11:59,339 --> 00:12:01,320
implications that has

301
00:12:01,320 --> 00:12:03,360
um starting with virtualization and

302
00:12:03,360 --> 00:12:05,100
specifically

303
00:12:05,100 --> 00:12:08,519
um containers running in kubernetes

304
00:12:08,519 --> 00:12:10,579
um

305
00:12:11,220 --> 00:12:13,740
in theory this is a security upgrade

306
00:12:13,740 --> 00:12:16,680
because you can have very fine grade

307
00:12:16,680 --> 00:12:20,940
software controls over over what each of

308
00:12:20,940 --> 00:12:23,040
those containers can do right each of

309
00:12:23,040 --> 00:12:24,660
them lives in their own little sandbox

310
00:12:24,660 --> 00:12:27,060
kind of like an iOS application you can

311
00:12:27,060 --> 00:12:29,760
imagine and so the operating system in

312
00:12:29,760 --> 00:12:32,279
this case kubernetes can put very heavy

313
00:12:32,279 --> 00:12:34,800
restrictions on them unlike before where

314
00:12:34,800 --> 00:12:36,720
everybody was running in a flat IP

315
00:12:36,720 --> 00:12:38,880
network right so in theory this is a

316
00:12:38,880 --> 00:12:41,579
security upgrade if it went for

317
00:12:41,579 --> 00:12:43,920
container escapes so if your little

318
00:12:43,920 --> 00:12:46,500
container is heavily constrained

319
00:12:46,500 --> 00:12:48,540
if you find a way of breaking out of

320
00:12:48,540 --> 00:12:50,220
that container and taking over the

321
00:12:50,220 --> 00:12:52,860
kubernetes running underneath then you

322
00:12:52,860 --> 00:12:54,600
get much higher access rights than

323
00:12:54,600 --> 00:12:56,399
you're supposed to have and

324
00:12:56,399 --> 00:12:58,620
um that sounds like science fiction

325
00:12:58,620 --> 00:13:00,660
breaking out of containers at least with

326
00:13:00,660 --> 00:13:02,579
virtual machines running in in more

327
00:13:02,579 --> 00:13:05,100
traditional Cloud environments we don't

328
00:13:05,100 --> 00:13:07,620
usually see virtual machine escapes

329
00:13:07,620 --> 00:13:10,260
these are very rare and require heavy

330
00:13:10,260 --> 00:13:12,779
screw-ups by whatever manufacturer of

331
00:13:12,779 --> 00:13:14,339
the hypervisor

332
00:13:14,339 --> 00:13:16,260
was Docker containers is actually

333
00:13:16,260 --> 00:13:20,459
relatively common to see escapes there's

334
00:13:20,459 --> 00:13:22,079
a whole range of configuration settings

335
00:13:22,079 --> 00:13:24,360
I'm just listing the ones that we find

336
00:13:24,360 --> 00:13:27,779
to be insecure regularly here and each

337
00:13:27,779 --> 00:13:30,000
of these configuration settings can make

338
00:13:30,000 --> 00:13:32,519
your one Docker container the possible

339
00:13:32,519 --> 00:13:34,860
Escape point for somebody to take over

340
00:13:34,860 --> 00:13:37,620
your entire network

341
00:13:37,620 --> 00:13:39,899
um some of these are obvious I mean it's

342
00:13:39,899 --> 00:13:41,220
it's in the name if you give the

343
00:13:41,220 --> 00:13:43,500
privileged container attribute to a

344
00:13:43,500 --> 00:13:45,060
container of course you're you're

345
00:13:45,060 --> 00:13:46,680
allowing it in this case to speak

346
00:13:46,680 --> 00:13:48,839
directly to the Linux kernel of the host

347
00:13:48,839 --> 00:13:51,420
operating system it's an it's an easy

348
00:13:51,420 --> 00:13:53,100
shortcut if you're moving something from

349
00:13:53,100 --> 00:13:55,260
a virtual machine to a docking container

350
00:13:55,260 --> 00:13:57,480
you want you want the software to still

351
00:13:57,480 --> 00:13:58,980
kind of behave like in a virtual machine

352
00:13:58,980 --> 00:14:00,660
you just give it all access rights

353
00:14:00,660 --> 00:14:02,040
basically speak directly to the

354
00:14:02,040 --> 00:14:04,260
operating system that gives you a root

355
00:14:04,260 --> 00:14:06,180
shell right away through multiple ways

356
00:14:06,180 --> 00:14:07,620
right

357
00:14:07,620 --> 00:14:10,260
um for other other attributes it's it's

358
00:14:10,260 --> 00:14:13,260
not that obvious that they're insecure

359
00:14:13,260 --> 00:14:14,880
um and they're color shading here

360
00:14:14,880 --> 00:14:16,980
suggests how often we find them the the

361
00:14:16,980 --> 00:14:20,760
lighter shaded ones we find sometimes

362
00:14:20,760 --> 00:14:23,100
um the the darker shaded ones almost all

363
00:14:23,100 --> 00:14:25,500
the time so for instance this host PID

364
00:14:25,500 --> 00:14:28,320
attribute it's set at least in some

365
00:14:28,320 --> 00:14:30,120
Docker containers in almost all the

366
00:14:30,120 --> 00:14:31,980
environments that we're scanning and

367
00:14:31,980 --> 00:14:35,040
this is basically a way to query the

368
00:14:35,040 --> 00:14:36,660
process space of the host operator

369
00:14:36,660 --> 00:14:40,199
system not necessarily to do much with

370
00:14:40,199 --> 00:14:42,480
those processes but just to to basically

371
00:14:42,480 --> 00:14:44,220
query what all is running and

372
00:14:44,220 --> 00:14:46,500
information wise that's relatively

373
00:14:46,500 --> 00:14:48,959
boring you can predict what's running in

374
00:14:48,959 --> 00:14:51,060
a kubernetes cluster right mostly

375
00:14:51,060 --> 00:14:53,399
kubernetes and nothing else right but

376
00:14:53,399 --> 00:14:56,040
this gives you the the side effect of

377
00:14:56,040 --> 00:14:57,720
all the being able to kill those

378
00:14:57,720 --> 00:15:00,060
processes now the host processes right

379
00:15:00,060 --> 00:15:02,100
so you're sitting anywhere in this

380
00:15:02,100 --> 00:15:04,620
mobile network on some test machines say

381
00:15:04,620 --> 00:15:07,199
that's running uh that's running next to

382
00:15:07,199 --> 00:15:09,060
production machines you can kill every

383
00:15:09,060 --> 00:15:10,500
single one of these production machines

384
00:15:10,500 --> 00:15:13,440
if this attribute is set so for critical

385
00:15:13,440 --> 00:15:16,680
Nationwide infrastructure that of course

386
00:15:16,680 --> 00:15:18,420
is close to Doomsday

387
00:15:18,420 --> 00:15:20,820
if then other attributes are set in

388
00:15:20,820 --> 00:15:22,800
addition for instance this P trays you

389
00:15:22,800 --> 00:15:24,959
can also take over the processes so

390
00:15:24,959 --> 00:15:26,760
start reading the information and

391
00:15:26,760 --> 00:15:28,680
whatnot right

392
00:15:28,680 --> 00:15:30,180
um let me just give you one more example

393
00:15:30,180 --> 00:15:32,279
before moving on the one that that I

394
00:15:32,279 --> 00:15:34,320
found the most surprising being somebody

395
00:15:34,320 --> 00:15:35,940
who has worked more with virtual

396
00:15:35,940 --> 00:15:38,639
machines than with Docker containers and

397
00:15:38,639 --> 00:15:40,260
that's the last one here network access

398
00:15:40,260 --> 00:15:42,360
so in Virtual machines how do you give

399
00:15:42,360 --> 00:15:44,399
network access you usually just bridge

400
00:15:44,399 --> 00:15:45,600
to the

401
00:15:45,600 --> 00:15:47,040
um to the network that the host has

402
00:15:47,040 --> 00:15:49,019
access to and it's almost as if the

403
00:15:49,019 --> 00:15:50,699
virtual machine sits next to a computer

404
00:15:50,699 --> 00:15:52,740
on the same network they have separate

405
00:15:52,740 --> 00:15:54,180
interfaces they have their own IP

406
00:15:54,180 --> 00:15:56,820
addresses and all of this in kubernetes

407
00:15:56,820 --> 00:15:58,740
with Docker it doesn't work like this if

408
00:15:58,740 --> 00:16:01,620
you bridge to the to the host Network

409
00:16:01,620 --> 00:16:03,779
you're sharing an interface you're

410
00:16:03,779 --> 00:16:05,519
sharing an IP address

411
00:16:05,519 --> 00:16:09,180
right so just by bridging you allow

412
00:16:09,180 --> 00:16:11,040
um for instance the the container that

413
00:16:11,040 --> 00:16:12,120
the guest

414
00:16:12,120 --> 00:16:13,560
to

415
00:16:13,560 --> 00:16:17,639
um to P trace or to to network capture

416
00:16:17,639 --> 00:16:19,380
um all the communication of the host

417
00:16:19,380 --> 00:16:21,899
right and then because kubernetes are

418
00:16:21,899 --> 00:16:24,540
trusted environment internal networks uh

419
00:16:24,540 --> 00:16:26,459
a lot a lot of communication happens

420
00:16:26,459 --> 00:16:29,279
unencrypted so just by giving network

421
00:16:29,279 --> 00:16:30,660
access

422
00:16:30,660 --> 00:16:33,660
um to a container you basically

423
00:16:33,660 --> 00:16:36,240
um let the guests sniff all kinds of

424
00:16:36,240 --> 00:16:38,100
privileged information that's sent to

425
00:16:38,100 --> 00:16:41,160
and from the host and also you allow it

426
00:16:41,160 --> 00:16:45,180
to connect to interfaces

427
00:16:45,180 --> 00:16:46,920
um that are only bound to a local host

428
00:16:46,920 --> 00:16:48,720
for instance the kubernetes admin

429
00:16:48,720 --> 00:16:51,360
console and up until pretty recently

430
00:16:51,360 --> 00:16:53,940
that was not authenticated at all right

431
00:16:53,940 --> 00:16:55,800
so you connect to something that is only

432
00:16:55,800 --> 00:16:58,139
bound to localhost no authentication you

433
00:16:58,139 --> 00:17:00,240
take over the entire kubernetes cluster

434
00:17:00,240 --> 00:17:01,320
right

435
00:17:01,320 --> 00:17:02,820
so of course that raises the question

436
00:17:02,820 --> 00:17:04,980
how do you give network access in a

437
00:17:04,980 --> 00:17:07,199
secure way to Docker containers and we

438
00:17:07,199 --> 00:17:08,880
won't have time to go into that in

439
00:17:08,880 --> 00:17:10,799
detail now but basically you have to

440
00:17:10,799 --> 00:17:12,540
build your own software-defined networks

441
00:17:12,540 --> 00:17:14,400
build your own firewalls into that it's

442
00:17:14,400 --> 00:17:16,679
complicated right so

443
00:17:16,679 --> 00:17:18,480
um long story short as you're moving

444
00:17:18,480 --> 00:17:19,919
from virtual machines to Docker

445
00:17:19,919 --> 00:17:21,540
containers

446
00:17:21,540 --> 00:17:24,240
if you're not touching your software you

447
00:17:24,240 --> 00:17:26,160
have to set some of these attributes and

448
00:17:26,160 --> 00:17:27,480
they basically break your entire

449
00:17:27,480 --> 00:17:29,160
security model so there's a lot more

450
00:17:29,160 --> 00:17:31,679
work involved in that in that transition

451
00:17:31,679 --> 00:17:34,559
then lift and shift into kubernetes and

452
00:17:34,559 --> 00:17:36,179
many vendors don't do this and if

453
00:17:36,179 --> 00:17:37,620
there's just a single vendor in your

454
00:17:37,620 --> 00:17:39,059
deployment who doesn't do that that's

455
00:17:39,059 --> 00:17:41,700
the Escape point to then break out of

456
00:17:41,700 --> 00:17:43,860
the docker container right so for the

457
00:17:43,860 --> 00:17:45,840
hacking journalists we'll look at in a

458
00:17:45,840 --> 00:17:47,640
couple minutes this will be one of the

459
00:17:47,640 --> 00:17:50,220
key elements breaking out of a Docker

460
00:17:50,220 --> 00:17:51,840
container

461
00:17:51,840 --> 00:17:54,000
um the other aspect was briefly touching

462
00:17:54,000 --> 00:17:56,580
on it uh we said automation is key now

463
00:17:56,580 --> 00:17:58,320
right those hundreds of developers

464
00:17:58,320 --> 00:18:00,539
creating scripts that then build tens of

465
00:18:00,539 --> 00:18:02,640
thousands of functional units in those

466
00:18:02,640 --> 00:18:06,539
500 data centers right some threats

467
00:18:06,539 --> 00:18:09,000
theoretically go away you can't fish a

468
00:18:09,000 --> 00:18:10,980
Linux admin anymore now that there is

469
00:18:10,980 --> 00:18:12,660
nobody who has basically super power

470
00:18:12,660 --> 00:18:14,760
control over an entire network that was

471
00:18:14,760 --> 00:18:17,520
replaced by automation but other risks

472
00:18:17,520 --> 00:18:20,059
become more pronounced

473
00:18:20,059 --> 00:18:23,039
especially risk of accidental data

474
00:18:23,039 --> 00:18:25,500
leakage there's a lot more software

475
00:18:25,500 --> 00:18:28,740
Happening Now stuff gets uploaded to

476
00:18:28,740 --> 00:18:30,660
public repositories sometimes

477
00:18:30,660 --> 00:18:32,000
accidentally

478
00:18:32,000 --> 00:18:35,640
stuff gets literally pasted in the wrong

479
00:18:35,640 --> 00:18:37,080
places

480
00:18:37,080 --> 00:18:38,640
um you know I have a problem with this

481
00:18:38,640 --> 00:18:40,080
code can somebody help me with the

482
00:18:40,080 --> 00:18:42,299
sniplet and then you see some password

483
00:18:42,299 --> 00:18:43,980
in there and whatnot right we've all

484
00:18:43,980 --> 00:18:46,559
seen this and mistakes happen but

485
00:18:46,559 --> 00:18:48,720
mistakes happen more often if several

486
00:18:48,720 --> 00:18:50,640
hundred people are involved in creating

487
00:18:50,640 --> 00:18:52,320
your software every single one of them

488
00:18:52,320 --> 00:18:54,720
has some likelihood of making a mistake

489
00:18:54,720 --> 00:18:57,059
so keep that in mind as kind of the

490
00:18:57,059 --> 00:18:58,980
second ingredient as we're now talking

491
00:18:58,980 --> 00:19:01,919
about the results of of us Testing

492
00:19:01,919 --> 00:19:04,080
mobile networks in what's usually

493
00:19:04,080 --> 00:19:06,900
referred to as rectum exercises so this

494
00:19:06,900 --> 00:19:09,960
is when uh when a company invites us to

495
00:19:09,960 --> 00:19:12,900
break into the infrastructure with no

496
00:19:12,900 --> 00:19:14,700
prior information other than I guess the

497
00:19:14,700 --> 00:19:17,160
name of the company right so really the

498
00:19:17,160 --> 00:19:19,020
the same perspective that a criminal

499
00:19:19,020 --> 00:19:21,360
would start from right and we do this

500
00:19:21,360 --> 00:19:23,820
regularly and the results I'm going to

501
00:19:23,820 --> 00:19:26,280
share next are from real exercises but I

502
00:19:26,280 --> 00:19:27,480
should point out they're not from one

503
00:19:27,480 --> 00:19:29,400
company I'm kind of blurring the results

504
00:19:29,400 --> 00:19:32,820
of multiple exercises to respect the uh

505
00:19:32,820 --> 00:19:35,520
the the confidentiality of each one of

506
00:19:35,520 --> 00:19:36,660
them

507
00:19:36,660 --> 00:19:37,679
um

508
00:19:37,679 --> 00:19:39,780
so far so good

509
00:19:39,780 --> 00:19:41,580
by the way before getting into this I

510
00:19:41,580 --> 00:19:43,620
want to make sure that no questions stay

511
00:19:43,620 --> 00:19:46,140
unanswered today and haven't spoken in

512
00:19:46,140 --> 00:19:47,880
Japan a few times before I know you

513
00:19:47,880 --> 00:19:50,160
don't like to to ask questions in front

514
00:19:50,160 --> 00:19:53,400
of everybody else take a note send me a

515
00:19:53,400 --> 00:19:55,919
message later find me later whatever way

516
00:19:55,919 --> 00:19:58,620
I want your questions to get answered

517
00:19:58,620 --> 00:20:00,900
right so make sure if if anything is

518
00:20:00,900 --> 00:20:03,299
unclear note it down we'll talk about it

519
00:20:03,299 --> 00:20:04,679
later right

520
00:20:04,679 --> 00:20:07,559
okay so red team results

521
00:20:07,559 --> 00:20:08,460
um

522
00:20:08,460 --> 00:20:10,380
each of these Journeys will will happen

523
00:20:10,380 --> 00:20:12,480
from left to right basically starting

524
00:20:12,480 --> 00:20:15,240
from nothing at all to achieving

525
00:20:15,240 --> 00:20:18,360
um whatever hacking objective you had in

526
00:20:18,360 --> 00:20:20,400
this case spy on the customer so

527
00:20:20,400 --> 00:20:23,820
basically gain back that capability that

528
00:20:23,820 --> 00:20:26,340
on the radio side we lost when 2G

529
00:20:26,340 --> 00:20:28,080
networks were upgraded to 3G where we

530
00:20:28,080 --> 00:20:29,280
couldn't easily spawn people anymore

531
00:20:29,280 --> 00:20:32,520
let's gain that back somehow right

532
00:20:32,520 --> 00:20:34,500
um

533
00:20:34,500 --> 00:20:36,679
in this particular Journey what happened

534
00:20:36,679 --> 00:20:40,520
we find some development web portal

535
00:20:40,520 --> 00:20:44,160
somebody trying out whatever new code

536
00:20:44,160 --> 00:20:45,660
they know it's not going to be

537
00:20:45,660 --> 00:20:47,580
necessarily secure but this application

538
00:20:47,580 --> 00:20:49,559
is access to absolutely nothing it's

539
00:20:49,559 --> 00:20:51,660
specifically segregated on the internal

540
00:20:51,660 --> 00:20:53,640
Network so that it can't access any

541
00:20:53,640 --> 00:20:55,559
customer data it can't even access any

542
00:20:55,559 --> 00:20:58,260
other machines right it's uh from the

543
00:20:58,260 --> 00:21:00,660
perspective of the developer completely

544
00:21:00,660 --> 00:21:03,179
safe to to put experimental code in

545
00:21:03,179 --> 00:21:05,520
there right so of course we we hacked

546
00:21:05,520 --> 00:21:06,960
this machine and we're stuck it's

547
00:21:06,960 --> 00:21:08,460
basically a dead end there's nothing we

548
00:21:08,460 --> 00:21:10,620
can do from this machine

549
00:21:10,620 --> 00:21:12,900
if it when deployed as a Docker

550
00:21:12,900 --> 00:21:15,600
container on kubernetes right so of

551
00:21:15,600 --> 00:21:18,240
course one of all of those attributes we

552
00:21:18,240 --> 00:21:20,700
listed earlier was set in this machine

553
00:21:20,700 --> 00:21:23,220
as it would be I mean they didn't give

554
00:21:23,220 --> 00:21:25,140
it much thought uh what you need to

555
00:21:25,140 --> 00:21:27,419
configure so we break out

556
00:21:27,419 --> 00:21:30,840
of this one container and then all of a

557
00:21:30,840 --> 00:21:31,980
sudden have access to everything

558
00:21:31,980 --> 00:21:34,380
kubernetes is access to which needs to

559
00:21:34,380 --> 00:21:36,720
be at least the superset of everything

560
00:21:36,720 --> 00:21:38,820
any of the docker containers running in

561
00:21:38,820 --> 00:21:41,039
it has access to right so very

562
00:21:41,039 --> 00:21:43,500
far-reaching exit on the internal

563
00:21:43,500 --> 00:21:45,360
Network now I should point out this is

564
00:21:45,360 --> 00:21:47,760
the the it side of this mobile network

565
00:21:47,760 --> 00:21:49,919
not yet the Telco side often there's a

566
00:21:49,919 --> 00:21:51,720
big barrier between it but we'll we'll

567
00:21:51,720 --> 00:21:53,700
get to that later you turns out you can

568
00:21:53,700 --> 00:21:55,799
spy on customers Telco customers without

569
00:21:55,799 --> 00:21:58,980
even touching the Telco Network so we

570
00:21:58,980 --> 00:22:01,860
break out of of the container

571
00:22:01,860 --> 00:22:03,659
um and we we start scanning the internal

572
00:22:03,659 --> 00:22:06,179
Network there's a modern Enterprise so

573
00:22:06,179 --> 00:22:08,460
it has plenty of apis we start messing

574
00:22:08,460 --> 00:22:11,159
with those apis one of them uh if you

575
00:22:11,159 --> 00:22:13,740
send it wrong data sends you a nice

576
00:22:13,740 --> 00:22:16,020
debug clock and that debug clock had

577
00:22:16,020 --> 00:22:18,360
enough information in it to basically

578
00:22:18,360 --> 00:22:20,220
give you admin access somewhere else

579
00:22:20,220 --> 00:22:22,440
right and say oh why don't you try this

580
00:22:22,440 --> 00:22:24,780
to debug whatever mistake mistakes

581
00:22:24,780 --> 00:22:27,720
happen right so we look around

582
00:22:27,720 --> 00:22:29,640
um where where do these credentials work

583
00:22:29,640 --> 00:22:33,120
on and we find some data warehouse not a

584
00:22:33,120 --> 00:22:36,179
production system more a let's create

585
00:22:36,179 --> 00:22:38,820
some statistics for we don't know

586
00:22:38,820 --> 00:22:41,039
marketing purposes could be

587
00:22:41,039 --> 00:22:43,620
um not sure uh what the system was but

588
00:22:43,620 --> 00:22:45,240
it was outside of the Telco domain

589
00:22:45,240 --> 00:22:47,340
getting a stream of information from the

590
00:22:47,340 --> 00:22:49,559
Telco nodes we look into that and we see

591
00:22:49,559 --> 00:22:51,659
all the customer SMS flying by so

592
00:22:51,659 --> 00:22:54,059
somebody can build statistics custom SMS

593
00:22:54,059 --> 00:22:56,880
of course is enough to break into online

594
00:22:56,880 --> 00:22:58,380
banking whatever else two-factor

595
00:22:58,380 --> 00:23:00,240
authentication right so

596
00:23:00,240 --> 00:23:03,059
um really good hacking objective met and

597
00:23:03,059 --> 00:23:06,059
again only using uh relatively

598
00:23:06,059 --> 00:23:08,700
straightforward techniques that as a red

599
00:23:08,700 --> 00:23:10,080
teamer you would have used in a

600
00:23:10,080 --> 00:23:12,299
non-telco environment as well right so

601
00:23:12,299 --> 00:23:14,940
first hacking objective met let's look

602
00:23:14,940 --> 00:23:16,140
at the

603
00:23:16,140 --> 00:23:16,860
um

604
00:23:16,860 --> 00:23:19,860
look at the next one accessing customers

605
00:23:19,860 --> 00:23:22,679
private information so not not the

606
00:23:22,679 --> 00:23:24,419
dynamic information like text messages

607
00:23:24,419 --> 00:23:27,179
that flies by more their their static

608
00:23:27,179 --> 00:23:28,799
information their registration data

609
00:23:28,799 --> 00:23:32,159
right so this hacking Journey reuses

610
00:23:32,159 --> 00:23:34,080
some of the components we we already had

611
00:23:34,080 --> 00:23:36,600
from earlier and then adds to it so

612
00:23:36,600 --> 00:23:39,059
we're still broken out of this container

613
00:23:39,059 --> 00:23:40,980
we can still scan the internal Network

614
00:23:40,980 --> 00:23:43,520
so one of the other things we're finding

615
00:23:43,520 --> 00:23:46,200
is an internal source code repository

616
00:23:46,200 --> 00:23:48,600
everybody has them you're not supposed

617
00:23:48,600 --> 00:23:50,760
to put anything like passwords in there

618
00:23:50,760 --> 00:23:53,280
in this case they kind of did they kind

619
00:23:53,280 --> 00:23:54,419
of didn't

620
00:23:54,419 --> 00:23:56,760
um so this was a repository basically

621
00:23:56,760 --> 00:23:59,520
you used to to build new machines and

622
00:23:59,520 --> 00:24:01,799
one of the things you need is a is an

623
00:24:01,799 --> 00:24:04,140
Etc Shadow file right it's not passwords

624
00:24:04,140 --> 00:24:06,240
but it's password hashes one of them was

625
00:24:06,240 --> 00:24:08,640
crackable so now we have a password that

626
00:24:08,640 --> 00:24:11,220
is deployed to all the new machines they

627
00:24:11,220 --> 00:24:13,140
could change it they don't necessarily

628
00:24:13,140 --> 00:24:15,900
so we use that to log into another

629
00:24:15,900 --> 00:24:18,260
database still

630
00:24:18,260 --> 00:24:20,760
in this case that includes all the

631
00:24:20,760 --> 00:24:22,380
registration information the bank

632
00:24:22,380 --> 00:24:24,000
accounts the address everything people

633
00:24:24,000 --> 00:24:27,900
put down when the first sign up for this

634
00:24:27,900 --> 00:24:29,520
company right

635
00:24:29,520 --> 00:24:31,740
so again no magic here this is very

636
00:24:31,740 --> 00:24:34,919
straightforward it hacking and

637
00:24:34,919 --> 00:24:35,700
um

638
00:24:35,700 --> 00:24:38,039
arising from the cloudification on

639
00:24:38,039 --> 00:24:40,559
automation of this network

640
00:24:40,559 --> 00:24:42,360
next hiking Journey

641
00:24:42,360 --> 00:24:43,799
um

642
00:24:43,799 --> 00:24:46,380
we want to actually finally get to the

643
00:24:46,380 --> 00:24:47,880
Telco Network right which we haven't

644
00:24:47,880 --> 00:24:49,440
touched at all

645
00:24:49,440 --> 00:24:50,280
um

646
00:24:50,280 --> 00:24:53,840
we find on the internet a description of

647
00:24:53,840 --> 00:24:57,900
how you can VPN into you know generally

648
00:24:57,900 --> 00:24:59,700
Telco elements and turns out they're

649
00:24:59,700 --> 00:25:01,559
using this technology now it's not bad

650
00:25:01,559 --> 00:25:03,179
to put the source code on the internet

651
00:25:03,179 --> 00:25:05,159
of course in fact that's incurred right

652
00:25:05,159 --> 00:25:07,260
so the more people look at it the fewer

653
00:25:07,260 --> 00:25:08,280
bugs

654
00:25:08,280 --> 00:25:10,860
um happen in for instance a VPN software

655
00:25:10,860 --> 00:25:14,400
but a VPN is only uh secure as long as

656
00:25:14,400 --> 00:25:16,500
you don't give somebody the credentials

657
00:25:16,500 --> 00:25:18,299
to log into it which we already had from

658
00:25:18,299 --> 00:25:19,740
from an earlier step in this hacking

659
00:25:19,740 --> 00:25:21,960
Journey so put these things together and

660
00:25:21,960 --> 00:25:24,960
understanding of how this VPN Works to

661
00:25:24,960 --> 00:25:27,720
to log into the mobile network outside

662
00:25:27,720 --> 00:25:29,580
of things plastic credential from

663
00:25:29,580 --> 00:25:31,919
earlier so we do that and we're again

664
00:25:31,919 --> 00:25:34,679
kind of in a dead end in kind of some

665
00:25:34,679 --> 00:25:37,740
some statistic monitoring server uh this

666
00:25:37,740 --> 00:25:39,240
wasn't a very good credential so we're

667
00:25:39,240 --> 00:25:41,039
not allowed to access any actual Telco

668
00:25:41,039 --> 00:25:44,400
elements this is uh yeah we are in the

669
00:25:44,400 --> 00:25:46,200
right network but again in the dead end

670
00:25:46,200 --> 00:25:48,779
so you know what happens next of course

671
00:25:48,779 --> 00:25:51,480
we break out of that container again

672
00:25:51,480 --> 00:25:53,340
using one of those settings that are

673
00:25:53,340 --> 00:25:55,320
that are known to be insecure and yet

674
00:25:55,320 --> 00:25:58,100
found everywhere and that gives us

675
00:25:58,100 --> 00:26:00,419
control of everything running in this

676
00:26:00,419 --> 00:26:02,820
kubernetes and that happens to be one of

677
00:26:02,820 --> 00:26:05,220
those let's say 500 data centers right

678
00:26:05,220 --> 00:26:07,260
anything running in that

679
00:26:07,260 --> 00:26:09,059
we can access now and this of course

680
00:26:09,059 --> 00:26:10,740
works for every single one of these 500

681
00:26:10,740 --> 00:26:14,400
data centers so you can do whatever you

682
00:26:14,400 --> 00:26:16,440
want on any of these devices including

683
00:26:16,440 --> 00:26:18,059
everything we said earlier like reading

684
00:26:18,059 --> 00:26:20,159
text messages right

685
00:26:20,159 --> 00:26:22,860
and then finally of course you know it

686
00:26:22,860 --> 00:26:25,039
doesn't require any any other ingredient

687
00:26:25,039 --> 00:26:27,179
you can take down the entire mobile

688
00:26:27,179 --> 00:26:29,159
network from that right

689
00:26:29,159 --> 00:26:30,720
um either by just you know killing the

690
00:26:30,720 --> 00:26:33,000
processes or maybe more destructively

691
00:26:33,000 --> 00:26:34,860
you know ransomware and everything and

692
00:26:34,860 --> 00:26:37,260
making sure that people in this

693
00:26:37,260 --> 00:26:39,059
environment don't have mobile access for

694
00:26:39,059 --> 00:26:41,039
some time right

695
00:26:41,039 --> 00:26:42,600
so

696
00:26:42,600 --> 00:26:45,120
all the way to the end we didn't do

697
00:26:45,120 --> 00:26:47,880
anything Telco specific right this is

698
00:26:47,880 --> 00:26:50,580
just hacking websites breaking out of

699
00:26:50,580 --> 00:26:53,100
containers finding credentials laying

700
00:26:53,100 --> 00:26:55,500
around and all of those mistakes will be

701
00:26:55,500 --> 00:26:57,960
made and not just in telcos right which

702
00:26:57,960 --> 00:27:00,240
is why I think this is a good guiding

703
00:27:00,240 --> 00:27:03,059
story uh for whatever industry that you

704
00:27:03,059 --> 00:27:05,580
are in cloudifying and automating right

705
00:27:05,580 --> 00:27:07,320
now

706
00:27:07,320 --> 00:27:10,380
um so what's what's next and what do we

707
00:27:10,380 --> 00:27:13,200
need to do to uh to fix those problems

708
00:27:13,200 --> 00:27:14,520
um I mean

709
00:27:14,520 --> 00:27:16,320
first and foremost and and kind of

710
00:27:16,320 --> 00:27:17,640
obviously

711
00:27:17,640 --> 00:27:20,400
um fix those container configuration

712
00:27:20,400 --> 00:27:22,799
issues right that that list I gave you

713
00:27:22,799 --> 00:27:24,659
as insecure you can just make that an

714
00:27:24,659 --> 00:27:27,240
audit list and if any container has any

715
00:27:27,240 --> 00:27:29,400
of those settings uh don't allow them

716
00:27:29,400 --> 00:27:31,500
into your kubernetes right in fact

717
00:27:31,500 --> 00:27:33,840
that's relatively easy given that all of

718
00:27:33,840 --> 00:27:35,940
these these containers come through some

719
00:27:35,940 --> 00:27:39,000
kind of clcd Pipeline and then

720
00:27:39,000 --> 00:27:41,880
um some some repository for artifacts

721
00:27:41,880 --> 00:27:43,620
under deployed relatively automatically

722
00:27:43,620 --> 00:27:45,539
at any of those points can you check for

723
00:27:45,539 --> 00:27:47,220
that configuration and just say no this

724
00:27:47,220 --> 00:27:49,320
is not allowed in our environment right

725
00:27:49,320 --> 00:27:51,059
make sure to include your test

726
00:27:51,059 --> 00:27:53,940
environments because like we saw the

727
00:27:53,940 --> 00:27:56,520
line between blurry between testing and

728
00:27:56,520 --> 00:27:58,679
and production is relatively blur in

729
00:27:58,679 --> 00:28:00,059
this environment so even your test

730
00:28:00,059 --> 00:28:02,340
environment need to meet some minimum

731
00:28:02,340 --> 00:28:05,299
standard but generally getting

732
00:28:05,299 --> 00:28:08,460
containers to secure is is relatively

733
00:28:08,460 --> 00:28:11,580
straightforward everything else though

734
00:28:11,580 --> 00:28:12,960
um is a little bit more difficult and

735
00:28:12,960 --> 00:28:15,240
not just for for Telco Networks

736
00:28:15,240 --> 00:28:18,059
um easy to put advice like this on a on

737
00:28:18,059 --> 00:28:19,440
a slide

738
00:28:19,440 --> 00:28:21,539
um you know I guess today the people

739
00:28:21,539 --> 00:28:23,880
would call this zero trust but that's

740
00:28:23,880 --> 00:28:26,700
hard right we we we it's easy to speak

741
00:28:26,700 --> 00:28:28,500
about it at a conference but it's

742
00:28:28,500 --> 00:28:30,419
actually hard to implement any of this

743
00:28:30,419 --> 00:28:33,240
advice consistently and like like I've

744
00:28:33,240 --> 00:28:36,120
shown you if from your 10 000 elements

745
00:28:36,120 --> 00:28:38,340
one of them uh deviates from the

746
00:28:38,340 --> 00:28:41,039
standard that's your weakest link so

747
00:28:41,039 --> 00:28:43,020
let's start a little bit more

748
00:28:43,020 --> 00:28:45,419
um bottom up what are security controls

749
00:28:45,419 --> 00:28:48,120
that we as red teamers hate that make

750
00:28:48,120 --> 00:28:51,059
our life a lot harder and we're really

751
00:28:51,059 --> 00:28:53,460
going back to the very Basics here

752
00:28:53,460 --> 00:28:56,400
Patcher systems and Harden them make

753
00:28:56,400 --> 00:28:58,740
sure access to to administrative

754
00:28:58,740 --> 00:29:01,740
interfaces is more restricted than just

755
00:29:01,740 --> 00:29:04,020
connecting to the network and do

756
00:29:04,020 --> 00:29:05,820
something around monitoring on the

757
00:29:05,820 --> 00:29:07,080
endpoint or in the network doesn't

758
00:29:07,080 --> 00:29:09,260
matter but have some visibility

759
00:29:09,260 --> 00:29:12,120
that that maybe somebody is in the

760
00:29:12,120 --> 00:29:15,000
process of hacking you now these are so

761
00:29:15,000 --> 00:29:17,820
old you you would think uh we jump back

762
00:29:17,820 --> 00:29:20,640
to the first code blue 10 years ago but

763
00:29:20,640 --> 00:29:22,679
still today we need to talk about these

764
00:29:22,679 --> 00:29:24,600
topics because they're not implemented

765
00:29:24,600 --> 00:29:26,520
in networks and especially not in mobile

766
00:29:26,520 --> 00:29:29,460
networks and starting with the first one

767
00:29:29,460 --> 00:29:31,820
here patching and hardening is actually

768
00:29:31,820 --> 00:29:33,840
surprisingly hard to do patching and

769
00:29:33,840 --> 00:29:36,899
hardening both in Old networks and in

770
00:29:36,899 --> 00:29:38,940
the networks of the future for

771
00:29:38,940 --> 00:29:40,620
completely different reasons though in

772
00:29:40,620 --> 00:29:43,020
the old networks those are running on

773
00:29:43,020 --> 00:29:44,820
just standard Linux boxes and we were

774
00:29:44,820 --> 00:29:46,980
talking 4G network I'm not going all the

775
00:29:46,980 --> 00:29:48,659
way back to 3G networks that was a

776
00:29:48,659 --> 00:29:50,640
little bit more proprietor but 4G

777
00:29:50,640 --> 00:29:51,899
networks today

778
00:29:51,899 --> 00:29:54,419
their normal Linux boxes

779
00:29:54,419 --> 00:29:56,580
and then the vendor put some software on

780
00:29:56,580 --> 00:29:58,320
it so the patches are available

781
00:29:58,320 --> 00:30:00,960
everybody knows what Souza Linux patches

782
00:30:00,960 --> 00:30:03,240
or whatever flavor you have you need to

783
00:30:03,240 --> 00:30:04,260
install

784
00:30:04,260 --> 00:30:06,539
but the the vendors

785
00:30:06,539 --> 00:30:09,600
of those all of them you know Ericsson

786
00:30:09,600 --> 00:30:12,720
Nokia Huawei ZTE wherever you look in

787
00:30:12,720 --> 00:30:14,640
the world they're very reluctant

788
00:30:14,640 --> 00:30:16,919
changing their systems they have jobs

789
00:30:16,919 --> 00:30:20,159
once at most twice per year and

790
00:30:20,159 --> 00:30:21,899
sometimes they include security patches

791
00:30:21,899 --> 00:30:24,480
but even creating such a build sometimes

792
00:30:24,480 --> 00:30:26,880
can take six months so you're always one

793
00:30:26,880 --> 00:30:29,159
year behind on Linux patching if you're

794
00:30:29,159 --> 00:30:30,960
one year behind you might just as well

795
00:30:30,960 --> 00:30:33,000
not patch there's always a critical bug

796
00:30:33,000 --> 00:30:35,640
every single year right so it's a

797
00:30:35,640 --> 00:30:37,440
reluctance of the vendors that made

798
00:30:37,440 --> 00:30:39,779
mobile networks so far basically

799
00:30:39,779 --> 00:30:42,419
unpatched now that all goes away right

800
00:30:42,419 --> 00:30:45,000
now you as the operator become the

801
00:30:45,000 --> 00:30:46,440
vendor you're pushing everything into

802
00:30:46,440 --> 00:30:49,320
this cicd pipelines and artifactory you

803
00:30:49,320 --> 00:30:51,419
deploy yourself under those 10 000 units

804
00:30:51,419 --> 00:30:53,880
So in theory you can do any patching you

805
00:30:53,880 --> 00:30:55,260
want

806
00:30:55,260 --> 00:30:57,299
the problem is each of those 10 000

807
00:30:57,299 --> 00:30:59,760
functional units is very very specific

808
00:30:59,760 --> 00:31:02,820
it's a very stripped down uh Linux

809
00:31:02,820 --> 00:31:05,399
flavor that's just fit for purpose for

810
00:31:05,399 --> 00:31:07,080
whatever that one little thing is it's

811
00:31:07,080 --> 00:31:09,059
doing so there are no patches available

812
00:31:09,059 --> 00:31:11,100
it's not Susie Linux anymore it's not

813
00:31:11,100 --> 00:31:13,679
redhead it's none of the the maintained

814
00:31:13,679 --> 00:31:16,380
distros somebody created this for one

815
00:31:16,380 --> 00:31:19,679
purpose and that team probably doesn't

816
00:31:19,679 --> 00:31:20,880
have the knowledge of a Linux

817
00:31:20,880 --> 00:31:23,399
distribution to keep pushing patches so

818
00:31:23,399 --> 00:31:26,640
today you can patch easily but nobody's

819
00:31:26,640 --> 00:31:29,940
giving you patches anymore right so for

820
00:31:29,940 --> 00:31:32,760
the foreseeable future mobile networks

821
00:31:32,760 --> 00:31:35,820
at least in parts will stay entirely

822
00:31:35,820 --> 00:31:38,399
unpatched right so segregation is key

823
00:31:38,399 --> 00:31:41,460
again and segregation comes through good

824
00:31:41,460 --> 00:31:43,320
container configuration like we said

825
00:31:43,320 --> 00:31:45,000
earlier

826
00:31:45,000 --> 00:31:46,860
um let's look at one counter example

827
00:31:46,860 --> 00:31:48,840
though something that was always easy

828
00:31:48,840 --> 00:31:51,240
remains easy and that is privileged

829
00:31:51,240 --> 00:31:53,039
access management I mean if you take

830
00:31:53,039 --> 00:31:55,559
nothing away from from today

831
00:31:55,559 --> 00:31:57,480
um container configuration and privilege

832
00:31:57,480 --> 00:31:58,740
access management those are the two

833
00:31:58,740 --> 00:32:00,240
things you need to do whatever industry

834
00:32:00,240 --> 00:32:01,860
whatever infrastructure is completely

835
00:32:01,860 --> 00:32:04,799
agnostic do those two things right

836
00:32:04,799 --> 00:32:06,120
um privileged exercise management

837
00:32:06,120 --> 00:32:09,840
basically means intermediating between

838
00:32:09,840 --> 00:32:12,840
um where all the users are all the

839
00:32:12,840 --> 00:32:15,120
hackers are and the most privileged

840
00:32:15,120 --> 00:32:17,039
parts so the SSH ports or whatever

841
00:32:17,039 --> 00:32:19,140
proprietary configuration pods you have

842
00:32:19,140 --> 00:32:22,799
and there's uh really uh mature systems

843
00:32:22,799 --> 00:32:24,659
out there they used to cost a lot of

844
00:32:24,659 --> 00:32:26,880
money uh nowadays even open source

845
00:32:26,880 --> 00:32:29,340
Alternatives the Apache Foundation what

846
00:32:29,340 --> 00:32:31,440
says called guacamole I think right

847
00:32:31,440 --> 00:32:34,620
please make sure just use that right if

848
00:32:34,620 --> 00:32:36,120
you don't already have a Pam system

849
00:32:36,120 --> 00:32:38,580
because five years ago somebody told you

850
00:32:38,580 --> 00:32:40,440
there's no budget for it available now

851
00:32:40,440 --> 00:32:43,200
it's free do it now right and yeah it

852
00:32:43,200 --> 00:32:44,700
was easy before it's easy now again

853
00:32:44,700 --> 00:32:46,320
everything is just Linux right you're

854
00:32:46,320 --> 00:32:49,320
this intermediate between user networks

855
00:32:49,320 --> 00:32:52,940
and SSH ports as easy as that

856
00:32:52,940 --> 00:32:56,419
last example endpoint detection

857
00:32:56,419 --> 00:32:58,740
surprisingly that has gotten harder now

858
00:32:58,740 --> 00:33:01,200
that we got more modern for the same

859
00:33:01,200 --> 00:33:02,820
reason we mentioned with the patching

860
00:33:02,820 --> 00:33:06,179
right so deploying a a good

861
00:33:06,179 --> 00:33:08,640
um good endpoint detection tool or even

862
00:33:08,640 --> 00:33:10,440
just a good logging solution let's say

863
00:33:10,440 --> 00:33:13,740
wazoo people like Wazoo here I love it

864
00:33:13,740 --> 00:33:15,779
right so if you have a fleet of Linux

865
00:33:15,779 --> 00:33:17,580
computers just put vazoo on there

866
00:33:17,580 --> 00:33:20,039
download some some best practice rule

867
00:33:20,039 --> 00:33:21,960
Set uh you're already in order of

868
00:33:21,960 --> 00:33:23,820
magnitude more likely to to detect

869
00:33:23,820 --> 00:33:26,640
hacking attacks now that again doesn't

870
00:33:26,640 --> 00:33:28,919
work if you're running some stripped

871
00:33:28,919 --> 00:33:30,600
down version of Linux and different in

872
00:33:30,600 --> 00:33:32,880
every single of these containers right

873
00:33:32,880 --> 00:33:34,980
was you won't even know where to start

874
00:33:34,980 --> 00:33:37,019
collecting data from of what's relevant

875
00:33:37,019 --> 00:33:39,480
so again you earn control if your

876
00:33:39,480 --> 00:33:41,220
infrastructure now

877
00:33:41,220 --> 00:33:43,799
but you also are responsible for now

878
00:33:43,799 --> 00:33:45,659
building the security tooling that works

879
00:33:45,659 --> 00:33:47,580
in that infrastructure it's it's not

880
00:33:47,580 --> 00:33:50,399
that straightforward so overall some

881
00:33:50,399 --> 00:33:52,200
things have remained hard some have

882
00:33:52,200 --> 00:33:54,240
always been easy some things have gotten

883
00:33:54,240 --> 00:33:57,299
surprisingly harder so as you're moving

884
00:33:57,299 --> 00:33:59,100
into these Cloud environments as you're

885
00:33:59,100 --> 00:34:01,820
adding those hundreds of people in some

886
00:34:01,820 --> 00:34:03,960
third-party companies adding automation

887
00:34:03,960 --> 00:34:06,539
to you don't forget to also add security

888
00:34:06,539 --> 00:34:09,599
competence at really that that eagerness

889
00:34:09,599 --> 00:34:11,879
to to stay up to date and

890
00:34:11,879 --> 00:34:13,679
um if you don't know where you stand yet

891
00:34:13,679 --> 00:34:16,379
uh red teaming from my experience is the

892
00:34:16,379 --> 00:34:18,540
way to find out which of those apply to

893
00:34:18,540 --> 00:34:21,179
you chances are all of them right but as

894
00:34:21,179 --> 00:34:25,320
you mature maybe patching or use access

895
00:34:25,320 --> 00:34:27,060
or whatever else will will move more

896
00:34:27,060 --> 00:34:28,980
into the foreground because it it keeps

897
00:34:28,980 --> 00:34:31,679
them coming up in these exercises

898
00:34:31,679 --> 00:34:34,320
and with all of this I hope I've updated

899
00:34:34,320 --> 00:34:37,918
you not just on on how 5G networks uh do

900
00:34:37,918 --> 00:34:40,320
require a lot of security testing and uh

901
00:34:40,320 --> 00:34:41,639
if you're looking for for a new

902
00:34:41,639 --> 00:34:43,560
challenge uh do look into that there's

903
00:34:43,560 --> 00:34:45,480
definitely more testing to be done right

904
00:34:45,480 --> 00:34:47,879
now than there's testers available and

905
00:34:47,879 --> 00:34:49,859
that's globally right

906
00:34:49,859 --> 00:34:51,719
um but also if you're not interested in

907
00:34:51,719 --> 00:34:53,159
mobile networks at all and focus on

908
00:34:53,159 --> 00:34:55,440
something else these Lessons Learned

909
00:34:55,440 --> 00:34:57,780
hopefully uh will allow you to build

910
00:34:57,780 --> 00:34:59,940
more secure infrastructures and and test

911
00:34:59,940 --> 00:35:01,260
them very thoroughly

912
00:35:01,260 --> 00:35:02,460
and

913
00:35:02,460 --> 00:35:05,580
with that I'll conclude and I hope that

914
00:35:05,580 --> 00:35:08,099
some of you will be brave enough to ask

915
00:35:08,099 --> 00:35:09,839
some questions but first of all thank

916
00:35:09,839 --> 00:35:12,259
you very much

