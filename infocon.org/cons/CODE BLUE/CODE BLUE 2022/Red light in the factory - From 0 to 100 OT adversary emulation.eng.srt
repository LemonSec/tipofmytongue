1
00:00:00,420 --> 00:00:03,720
so um hello everyone and thanks for

2
00:00:03,720 --> 00:00:05,279
coming

3
00:00:05,279 --> 00:00:07,319
and today we are going to share the

4
00:00:07,319 --> 00:00:10,679
topic uh Red Line in the factory from 0

5
00:00:10,679 --> 00:00:12,599
to 100

6
00:00:12,599 --> 00:00:15,920
OT adversary emulation

7
00:00:16,980 --> 00:00:20,220
so before we start I would like to

8
00:00:20,220 --> 00:00:23,400
introduce ourselves I'm Vic Huang which

9
00:00:23,400 --> 00:00:26,939
is a security engineer and uh also a

10
00:00:26,939 --> 00:00:30,660
independent researcher and this is my

11
00:00:30,660 --> 00:00:33,360
first time to speak in the venue since

12
00:00:33,360 --> 00:00:37,500
2020 is my pressure and he is so young

13
00:00:37,500 --> 00:00:41,579
he is a associate Engineers from triple

14
00:00:41,579 --> 00:00:44,239
I and he also

15
00:00:44,239 --> 00:00:48,660
interested in OT security and crypto and

16
00:00:48,660 --> 00:00:51,440
also he shared his research in the

17
00:00:51,440 --> 00:00:53,700
conference before

18
00:00:53,700 --> 00:00:55,879
foreign

19
00:00:58,879 --> 00:01:02,640
first I will quickly go through the

20
00:01:02,640 --> 00:01:07,619
introduction of ICS it and OT and also

21
00:01:07,619 --> 00:01:09,900
adversaling emulation

22
00:01:09,900 --> 00:01:13,920
next we will review and analyze the ICS

23
00:01:13,920 --> 00:01:16,380
malware defined by miter

24
00:01:16,380 --> 00:01:20,000
and make a conclusion for our automation

25
00:01:20,000 --> 00:01:24,180
then we will use this conclusion to make

26
00:01:24,180 --> 00:01:25,140
our

27
00:01:25,140 --> 00:01:28,920
OT adversary emulation tool

28
00:01:28,920 --> 00:01:31,979
and in the last part we will have demos

29
00:01:31,979 --> 00:01:35,840
about two examples

30
00:01:37,740 --> 00:01:39,960
so

31
00:01:39,960 --> 00:01:42,540
for the ICS

32
00:01:42,540 --> 00:01:43,380
um

33
00:01:43,380 --> 00:01:47,520
there are two important parts in ICS

34
00:01:47,520 --> 00:01:50,460
scada and DCs

35
00:01:50,460 --> 00:01:53,820
so the main difference between DCS and

36
00:01:53,820 --> 00:01:57,439
ICS is first

37
00:01:57,439 --> 00:02:00,899
DCS is more complicated and delete case

38
00:02:00,899 --> 00:02:06,060
on device control and access control

39
00:02:06,060 --> 00:02:07,459
the second

40
00:02:07,459 --> 00:02:11,700
instead of using a private or you can

41
00:02:11,700 --> 00:02:15,260
say customized control protocols

42
00:02:15,260 --> 00:02:18,440
scada is mostly using

43
00:02:18,440 --> 00:02:23,280
public Control Systems so most of the

44
00:02:23,280 --> 00:02:27,060
research is in the scada and because

45
00:02:27,060 --> 00:02:29,760
it's easier to get information and

46
00:02:29,760 --> 00:02:31,319
devices

47
00:02:31,319 --> 00:02:34,458
on scada

48
00:02:34,560 --> 00:02:37,800
next it's itnot

49
00:02:37,800 --> 00:02:42,900
so generally people use Purdue model to

50
00:02:42,900 --> 00:02:48,660
Define the it and OT in ICS Network

51
00:02:48,660 --> 00:02:52,080
so from there for level four and level

52
00:02:52,080 --> 00:02:55,260
five the top of the graph

53
00:02:55,260 --> 00:03:01,260
is it so there are PC and also the like

54
00:03:01,260 --> 00:03:02,879
a web server

55
00:03:02,879 --> 00:03:06,959
and from the level three below is

56
00:03:06,959 --> 00:03:09,420
operational technology system

57
00:03:09,420 --> 00:03:10,860
OT

58
00:03:10,860 --> 00:03:15,720
so especially from they both to below

59
00:03:15,720 --> 00:03:18,180
um they are special

60
00:03:18,180 --> 00:03:20,700
um they are devices and controlled by

61
00:03:20,700 --> 00:03:25,339
special uh control protocols

62
00:03:27,239 --> 00:03:30,959
and then uh I will introduce about

63
00:03:30,959 --> 00:03:33,659
adversary emulations and the existing

64
00:03:33,659 --> 00:03:35,459
tool

65
00:03:35,459 --> 00:03:40,019
first this is the major ATT and CK ICS

66
00:03:40,019 --> 00:03:44,819
Matrix so it's similar to the ATT and CK

67
00:03:44,819 --> 00:03:48,959
metrics but it focus on it attack iics

68
00:03:48,959 --> 00:03:51,599
attack

69
00:03:51,599 --> 00:03:55,099
they use the same

70
00:03:55,099 --> 00:04:00,720
same architecture ttps so from the

71
00:04:00,720 --> 00:04:04,500
highest level to describe the attacks

72
00:04:04,500 --> 00:04:07,560
the um usually is a target of the

73
00:04:07,560 --> 00:04:10,080
behavior to the lowest

74
00:04:10,080 --> 00:04:11,280
um

75
00:04:11,280 --> 00:04:14,360
part is lowest level is the procedure

76
00:04:14,360 --> 00:04:18,000
it's the details about the attacks to

77
00:04:18,000 --> 00:04:21,139
achieve a behavior

78
00:04:21,358 --> 00:04:25,160
so one way to use the ICC

79
00:04:25,160 --> 00:04:30,660
ATT and ckics Matrix is to do adversary

80
00:04:30,660 --> 00:04:32,280
emulation

81
00:04:32,280 --> 00:04:36,000
so what is adversary emulation

82
00:04:36,000 --> 00:04:40,320
it used the known threat skills and also

83
00:04:40,320 --> 00:04:43,680
automation to fight vulnerabilities in

84
00:04:43,680 --> 00:04:45,660
Enterprise

85
00:04:45,660 --> 00:04:49,320
and for adversary emulation tools is as

86
00:04:49,320 --> 00:04:52,020
known as a bridge and attack simulation

87
00:04:52,020 --> 00:04:54,960
BAS

88
00:04:54,960 --> 00:04:57,680
so different from the attack

89
00:04:57,680 --> 00:05:02,400
Frameworks like meta exploit ICS modules

90
00:05:02,400 --> 00:05:06,540
and IC exploit they are more like two

91
00:05:06,540 --> 00:05:08,100
kids

92
00:05:08,100 --> 00:05:12,060
the adversary emulation tools focus more

93
00:05:12,060 --> 00:05:16,919
on automating the whole attack process

94
00:05:16,919 --> 00:05:21,120
so they are dozens of existing adversary

95
00:05:21,120 --> 00:05:22,919
emulation tools

96
00:05:22,919 --> 00:05:26,600
in I.T and there are very few in OT

97
00:05:26,600 --> 00:05:30,360
because the devices and

98
00:05:30,360 --> 00:05:30,900
um

99
00:05:30,900 --> 00:05:32,120
brand

100
00:05:32,120 --> 00:05:35,520
manufacturers are different so they are

101
00:05:35,520 --> 00:05:40,560
more complex in the environment

102
00:05:41,220 --> 00:05:43,979
so as we as I mentioned

103
00:05:43,979 --> 00:05:47,220
um we want to make a

104
00:05:47,220 --> 00:05:50,400
OT adversary and so before that we have

105
00:05:50,400 --> 00:05:52,740
to get the knowledge from the known

106
00:05:52,740 --> 00:05:57,479
threats so we review and analyze the ICS

107
00:05:57,479 --> 00:06:01,440
malware in decades defined by miter and

108
00:06:01,440 --> 00:06:03,840
we will have a conclusion about the

109
00:06:03,840 --> 00:06:07,940
whole attack process in this part

110
00:06:08,820 --> 00:06:10,340
so first

111
00:06:10,340 --> 00:06:14,820
this is the overview the of the ICS

112
00:06:14,820 --> 00:06:16,520
malware from

113
00:06:16,520 --> 00:06:19,620
2010 to 2022.

114
00:06:19,620 --> 00:06:23,639
it starts from the famous one star Nets

115
00:06:23,639 --> 00:06:25,139
to

116
00:06:25,139 --> 00:06:29,039
um to the ice PLC Blaster which is

117
00:06:29,039 --> 00:06:33,840
shared in blackhead us 2016 is focused

118
00:06:33,840 --> 00:06:38,720
on POC proxy attack and then the latest

119
00:06:38,720 --> 00:06:42,300
malware like pipe dream and Industrial

120
00:06:42,300 --> 00:06:44,840
2.

121
00:06:46,440 --> 00:06:50,280
so for its behavior and purpose we

122
00:06:50,280 --> 00:06:53,940
divide it to four groups the first is

123
00:06:53,940 --> 00:06:58,380
start from 2011. they focus on data

124
00:06:58,380 --> 00:06:59,699
Steel

125
00:06:59,699 --> 00:07:02,039
and then

126
00:07:02,039 --> 00:07:05,340
um the malware started to have a modular

127
00:07:05,340 --> 00:07:10,080
design to Target the multiple protocols

128
00:07:10,080 --> 00:07:13,680
device and also beautiful functions in

129
00:07:13,680 --> 00:07:17,639
the same protocols like Triton

130
00:07:17,639 --> 00:07:21,840
and next it starts from 2017 there are

131
00:07:21,840 --> 00:07:24,960
dozens of Ransom wears which is focused

132
00:07:24,960 --> 00:07:28,020
on try to equip or to break the

133
00:07:28,020 --> 00:07:32,819
operations in it and OT and focus on

134
00:07:32,819 --> 00:07:38,840
their Windows devices in itunot

135
00:07:39,479 --> 00:07:42,720
in 2022 they are pipe during an

136
00:07:42,720 --> 00:07:44,940
industrial 2 which is more complicated

137
00:07:44,940 --> 00:07:47,699
than before we have seen

138
00:07:47,699 --> 00:07:50,940
is carry a lot of uh different kind of

139
00:07:50,940 --> 00:07:54,599
modules in inside so it's like Thief

140
00:07:54,599 --> 00:07:58,940
with more Tools in his backpack

141
00:07:59,940 --> 00:08:03,660
and if we focus on the control protocols

142
00:08:03,660 --> 00:08:05,160
they use

143
00:08:05,160 --> 00:08:08,880
here's the trend for ICS malware from

144
00:08:08,880 --> 00:08:14,180
2011 from a single protocols Target to

145
00:08:14,180 --> 00:08:18,000
multiple protocols targets so it's more

146
00:08:18,000 --> 00:08:22,199
like a modular design toolkits

147
00:08:24,780 --> 00:08:28,740
and then besides the summary we

148
00:08:28,740 --> 00:08:32,940
mentioned we also uh focus on the attack

149
00:08:32,940 --> 00:08:35,520
patterns of these malware

150
00:08:35,520 --> 00:08:38,159
so they basically they have two main

151
00:08:38,159 --> 00:08:40,919
targets first

152
00:08:40,919 --> 00:08:44,520
um information collections on the device

153
00:08:44,520 --> 00:08:47,940
and the second break the factory or

154
00:08:47,940 --> 00:08:51,260
field operation

155
00:08:51,300 --> 00:08:54,740
and we and if we talk about the

156
00:08:54,740 --> 00:08:58,860
behaviors of this SCS malware there are

157
00:08:58,860 --> 00:09:03,180
three kind of ICS malwares first is worm

158
00:09:03,180 --> 00:09:06,899
his focus on spreading and information

159
00:09:06,899 --> 00:09:10,680
collection like Star Nets and harvest

160
00:09:10,680 --> 00:09:14,160
and even POC blasters

161
00:09:14,160 --> 00:09:17,339
and also the second one is ransomware it

162
00:09:17,339 --> 00:09:19,680
focuses on finding the specific process

163
00:09:19,680 --> 00:09:23,399
on HMI and also

164
00:09:23,399 --> 00:09:26,940
it and OT Windows process and try to

165
00:09:26,940 --> 00:09:31,560
recrypt it to stop the factory operation

166
00:09:31,560 --> 00:09:35,040
and the last one is two kids so it's

167
00:09:35,040 --> 00:09:38,339
built in several scripts or you can say

168
00:09:38,339 --> 00:09:42,300
modules to attack different protocols on

169
00:09:42,300 --> 00:09:44,480
different devices

170
00:09:44,480 --> 00:09:47,660
backpipe dream

171
00:09:51,120 --> 00:09:55,200
and then combined with our experience in

172
00:09:55,200 --> 00:09:58,740
incident investigation and a security

173
00:09:58,740 --> 00:10:01,500
check on the real factory there are four

174
00:10:01,500 --> 00:10:03,779
points we want to share

175
00:10:03,779 --> 00:10:05,580
first

176
00:10:05,580 --> 00:10:09,120
um only some malware's really attack or

177
00:10:09,120 --> 00:10:10,980
impact the devices

178
00:10:10,980 --> 00:10:15,959
like POC and IEDs I think most of you is

179
00:10:15,959 --> 00:10:17,940
already know about it

180
00:10:17,940 --> 00:10:21,180
and rest of them focus on Windows

181
00:10:21,180 --> 00:10:22,560
attacks

182
00:10:22,560 --> 00:10:24,120
and also

183
00:10:24,120 --> 00:10:28,320
we saw some hard-coded IP address and

184
00:10:28,320 --> 00:10:31,860
the tech name in The Source Code which

185
00:10:31,860 --> 00:10:35,040
is not normal because it means there

186
00:10:35,040 --> 00:10:38,100
should be a data leakage or some or

187
00:10:38,100 --> 00:10:41,700
Insider before the malware start to

188
00:10:41,700 --> 00:10:43,880
attack

189
00:10:44,279 --> 00:10:46,079
and the next

190
00:10:46,079 --> 00:10:49,620
um actually PLC have three or four mode

191
00:10:49,620 --> 00:10:54,420
depends on the manufacturers and mostly

192
00:10:54,420 --> 00:10:57,060
is like a wrong only mode and program

193
00:10:57,060 --> 00:11:01,920
only mode and also you can program and

194
00:11:01,920 --> 00:11:04,200
run at the same time

195
00:11:04,200 --> 00:11:07,680
but or some of them need users to

196
00:11:07,680 --> 00:11:10,140
physically change the mode with the

197
00:11:10,140 --> 00:11:14,940
buttons so if the POC is well configured

198
00:11:14,940 --> 00:11:18,899
in the wrong mode this malware would

199
00:11:18,899 --> 00:11:22,640
have less operations to control them by

200
00:11:22,640 --> 00:11:26,640
for example try to download the

201
00:11:26,640 --> 00:11:30,480
malicious program on the POC

202
00:11:30,480 --> 00:11:33,079
and the last one we want to share is

203
00:11:33,079 --> 00:11:35,839
normally in the factory

204
00:11:35,839 --> 00:11:40,680
HMI a human interface to POC is deployed

205
00:11:40,680 --> 00:11:43,800
as one to one or one to multiple IP

206
00:11:43,800 --> 00:11:48,240
address binding so which means the POC

207
00:11:48,240 --> 00:11:50,880
proxy like attack

208
00:11:50,880 --> 00:11:54,140
like uh POC blasters

209
00:11:54,140 --> 00:11:57,660
in blackhead us

210
00:11:57,660 --> 00:12:01,740
may not work because there is a IP

211
00:12:01,740 --> 00:12:04,519
address binding

212
00:12:04,980 --> 00:12:09,560
so we pick six of them

213
00:12:09,560 --> 00:12:13,920
which Target uh OT attacks especially on

214
00:12:13,920 --> 00:12:16,680
protocol attacks and map it on the

215
00:12:16,680 --> 00:12:21,720
Matrix so we try to reproduce and

216
00:12:21,720 --> 00:12:25,920
reconstruct their attack to make the

217
00:12:25,920 --> 00:12:28,279
tool

218
00:12:28,940 --> 00:12:33,180
so for the summary of their behaviors

219
00:12:33,180 --> 00:12:36,779
and patterns we make our own conclusions

220
00:12:36,779 --> 00:12:39,980
to extend the sense I see a skill chain

221
00:12:39,980 --> 00:12:44,540
stage two the execute

222
00:12:44,880 --> 00:12:46,500
solo

223
00:12:46,500 --> 00:12:49,740
um the main targets of this attack

224
00:12:49,740 --> 00:12:54,480
process is for the data targeting

225
00:12:54,480 --> 00:12:58,760
if you try attacker can try to ruin the

226
00:12:58,760 --> 00:13:02,519
data that shows in a

227
00:13:02,519 --> 00:13:05,000
human interface

228
00:13:05,000 --> 00:13:08,579
to make the human to make bad decisions

229
00:13:08,579 --> 00:13:12,839
or to trigger some protective actions

230
00:13:12,839 --> 00:13:17,579
and for controlled targeting you can try

231
00:13:17,579 --> 00:13:22,860
to send the mail form comment or other

232
00:13:22,860 --> 00:13:24,380
kind of

233
00:13:24,380 --> 00:13:28,860
resent the comments to ruin the devices

234
00:13:28,860 --> 00:13:32,459
and to make the devices to do strange

235
00:13:32,459 --> 00:13:35,060
actions

236
00:13:35,639 --> 00:13:38,160
and then we start from the first stages

237
00:13:38,160 --> 00:13:40,019
that

238
00:13:40,019 --> 00:13:40,620
um

239
00:13:40,620 --> 00:13:43,620
first we want to discover a specific

240
00:13:43,620 --> 00:13:45,720
targets

241
00:13:45,720 --> 00:13:50,160
so you can use the different method to

242
00:13:50,160 --> 00:13:51,420
achieve it

243
00:13:51,420 --> 00:13:54,620
and the first for the data

244
00:13:54,620 --> 00:13:58,019
targeting you can find your targets by

245
00:13:58,019 --> 00:14:02,700
recognize the response of the packet for

246
00:14:02,700 --> 00:14:05,459
example Triton broadcasts the specific

247
00:14:05,459 --> 00:14:07,800
packet and wait for the specific

248
00:14:07,800 --> 00:14:11,940
response to fight the device that you

249
00:14:11,940 --> 00:14:14,480
want to attack

250
00:14:14,519 --> 00:14:18,180
and for control targeting you can use a

251
00:14:18,180 --> 00:14:20,760
known function code to find the target

252
00:14:20,760 --> 00:14:23,820
for example if you want to find a mobile

253
00:14:23,820 --> 00:14:28,019
device you can use a function called 17

254
00:14:28,019 --> 00:14:33,560
or 42 to find your target

255
00:14:34,440 --> 00:14:38,160
and in the next stage collections uh the

256
00:14:38,160 --> 00:14:42,120
attacker will collect the data or the

257
00:14:42,120 --> 00:14:47,000
status of the device to to do the

258
00:14:47,000 --> 00:14:51,000
further attack for example like uh in

259
00:14:51,000 --> 00:14:53,760
the star net it sniff the centrifuge

260
00:14:53,760 --> 00:14:56,339
speed for two weeks try to break the

261
00:14:56,339 --> 00:15:00,720
centrifuge so and in the hobex he

262
00:15:00,720 --> 00:15:03,480
enumerates the OPC attack

263
00:15:03,480 --> 00:15:06,420
so try to steal the attack

264
00:15:06,420 --> 00:15:10,260
a value and also in the VPN filters is

265
00:15:10,260 --> 00:15:14,839
Sniff and Records the uh the packets

266
00:15:14,839 --> 00:15:19,279
from the mobiles protocols

267
00:15:19,560 --> 00:15:23,160
and in the third stages there is a

268
00:15:23,160 --> 00:15:28,019
manipulation so for data targeting

269
00:15:28,019 --> 00:15:28,560
um

270
00:15:28,560 --> 00:15:32,459
you can try to manipulate the data on

271
00:15:32,459 --> 00:15:36,480
the HMI screen to let human make uh

272
00:15:36,480 --> 00:15:39,660
wrong decisions or to manipulate the

273
00:15:39,660 --> 00:15:43,519
alarm to make the wrong protective

274
00:15:43,519 --> 00:15:47,839
actions triggered and also you can

275
00:15:47,839 --> 00:15:52,740
manipulate the data to let pocs to do a

276
00:15:52,740 --> 00:15:55,440
wrong code execution

277
00:15:55,440 --> 00:15:58,440
for the control targeting you can use

278
00:15:58,440 --> 00:16:01,560
cves or you can use some Pro some

279
00:16:01,560 --> 00:16:03,600
functions from the protocols to Upper

280
00:16:03,600 --> 00:16:06,000
use or to damage or to stop the

281
00:16:06,000 --> 00:16:08,339
operations of the factories

282
00:16:08,339 --> 00:16:14,779
so for example in 2016 Industrials use

283
00:16:14,779 --> 00:16:20,540
MMS in ICS uh in sorry in IEC

284
00:16:20,540 --> 00:16:24,800
61850 to damage the devices and also

285
00:16:24,800 --> 00:16:29,040
Triton use the tri-station protocol to

286
00:16:29,040 --> 00:16:34,260
deploy the malicious code on the pocs

287
00:16:34,260 --> 00:16:38,839
and the last stage is check and invasion

288
00:16:38,839 --> 00:16:40,440
so

289
00:16:40,440 --> 00:16:44,699
um attackers might try to check the the

290
00:16:44,699 --> 00:16:49,980
device status to make sure the attack is

291
00:16:49,980 --> 00:16:54,480
a c or try to hide the fingerprint from

292
00:16:54,480 --> 00:17:00,000
the text so uh for data targeting for

293
00:17:00,000 --> 00:17:03,300
example black energy use kill disk to

294
00:17:03,300 --> 00:17:07,099
clean up the Windows data and Triton

295
00:17:07,099 --> 00:17:11,220
writes mean List code to overwrite the

296
00:17:11,220 --> 00:17:14,660
written malicious code

297
00:17:14,699 --> 00:17:15,419
um

298
00:17:15,419 --> 00:17:19,140
uh for control targeting malware will

299
00:17:19,140 --> 00:17:24,720
check the POC status so Triton did

300
00:17:24,720 --> 00:17:29,000
um check the POC mode before and after

301
00:17:29,000 --> 00:17:33,440
it do the attack process

302
00:17:33,900 --> 00:17:36,960
so we got this four stages conclusion

303
00:17:36,960 --> 00:17:41,460
and then we used this conclusion to make

304
00:17:41,460 --> 00:17:45,660
a open source our diversary emulation

305
00:17:45,660 --> 00:17:50,780
Tools in OT so it's a Scarlett OT

306
00:17:51,480 --> 00:17:54,360
so here's the POC marketing ranks they

307
00:17:54,360 --> 00:17:57,780
are different POC manufacturers and they

308
00:17:57,780 --> 00:18:00,840
Pro and they support different protocols

309
00:18:00,840 --> 00:18:04,980
and our goal to is to support most of

310
00:18:04,980 --> 00:18:08,960
the protocols on this table

311
00:18:10,740 --> 00:18:16,020
so the design core of the Scarlet OT as

312
00:18:16,020 --> 00:18:18,660
we mentioned for the four stages attack

313
00:18:18,660 --> 00:18:22,940
process and also we are inspired by the

314
00:18:22,940 --> 00:18:27,539
monitor ATD and CK evaluations for ICS

315
00:18:27,539 --> 00:18:32,160
in 2021 so we reconstruct and reproduce

316
00:18:32,160 --> 00:18:35,820
the malware actions by the same

317
00:18:35,820 --> 00:18:40,020
protocols or by other protocols

318
00:18:40,020 --> 00:18:41,700
and also

319
00:18:41,700 --> 00:18:43,860
um I think uh

320
00:18:43,860 --> 00:18:47,400
generally if you want to do uh you want

321
00:18:47,400 --> 00:18:51,660
to simulate uh the red team's process or

322
00:18:51,660 --> 00:18:53,700
you try to automate the rating process

323
00:18:53,700 --> 00:18:56,460
the coverage will be super bad because

324
00:18:56,460 --> 00:19:01,140
human can make the decision or to to do

325
00:19:01,140 --> 00:19:05,460
the attacks by their experience or

326
00:19:05,460 --> 00:19:09,620
knowledge but if you do the automation

327
00:19:09,620 --> 00:19:15,000
it's all just only the fixed logic so

328
00:19:15,000 --> 00:19:15,660
um

329
00:19:15,660 --> 00:19:18,660
what we want to do is we want to make a

330
00:19:18,660 --> 00:19:21,960
flexible tools that you could do like

331
00:19:21,960 --> 00:19:26,820
pause or insert your manual comments in

332
00:19:26,820 --> 00:19:31,380
the any time State time points in the

333
00:19:31,380 --> 00:19:34,919
whole process or you can customize and

334
00:19:34,919 --> 00:19:38,520
add your own payloads and also

335
00:19:38,520 --> 00:19:41,520
you can try to combine the different

336
00:19:41,520 --> 00:19:45,799
attacks because in the same environment

337
00:19:45,799 --> 00:19:48,720
or in the different environments the

338
00:19:48,720 --> 00:19:52,039
combination of the devices and the IIT

339
00:19:52,039 --> 00:19:55,940
architecture are different

340
00:19:56,240 --> 00:19:59,700
and also we want these tools is for

341
00:19:59,700 --> 00:20:03,059
general purpose that we can uh you can

342
00:20:03,059 --> 00:20:07,400
use it to test or your defense Solutions

343
00:20:07,400 --> 00:20:11,039
and also it is mapping to the ICS Matrix

344
00:20:11,039 --> 00:20:17,299
so it's very super uh nice for training

345
00:20:18,059 --> 00:20:20,100
so um

346
00:20:20,100 --> 00:20:23,400
at first we want to make a framework by

347
00:20:23,400 --> 00:20:26,000
ourselves but

348
00:20:26,000 --> 00:20:29,580
after we think about the all

349
00:20:29,580 --> 00:20:33,059
requirements we want we make it on the

350
00:20:33,059 --> 00:20:36,840
uh as a Caldera plugin which Caldera is

351
00:20:36,840 --> 00:20:38,600
developed by

352
00:20:38,600 --> 00:20:41,220
monitor it's an open source I.T

353
00:20:41,220 --> 00:20:44,780
adversary emulation so we build a plugin

354
00:20:44,780 --> 00:20:49,740
to that's the Caldera can do the OT

355
00:20:49,740 --> 00:20:51,660
attacks

356
00:20:51,660 --> 00:20:54,840
and we for now we support 10 protocols

357
00:20:54,840 --> 00:20:58,280
and 23 techniques

358
00:20:59,160 --> 00:21:03,120
so here's a Easy Screenshot that we have

359
00:21:03,120 --> 00:21:06,240
made for this is the example of the

360
00:21:06,240 --> 00:21:10,260
crisis attack that we have several Steps

361
00:21:10,260 --> 00:21:13,220
From the Discover to collection to

362
00:21:13,220 --> 00:21:18,179
manipulations and also checking invasion

363
00:21:18,179 --> 00:21:19,679
and then

364
00:21:19,679 --> 00:21:23,760
in the next part I will invite my

365
00:21:23,760 --> 00:21:26,520
partner so young he will introduce that

366
00:21:26,520 --> 00:21:29,520
we try to extend and reconstruct the

367
00:21:29,520 --> 00:21:33,900
whole uh the attack from the malwares

368
00:21:33,900 --> 00:21:37,020
and also we will have two Demos in this

369
00:21:37,020 --> 00:21:39,200
part

370
00:21:42,360 --> 00:21:45,120
and next we will show through a test

371
00:21:45,120 --> 00:21:48,000
using two different ICS protocols and

372
00:21:48,000 --> 00:21:50,340
every color explanation we will show our

373
00:21:50,340 --> 00:21:52,020
demo video

374
00:21:52,020 --> 00:21:55,100
first we want Google about is

375
00:21:55,100 --> 00:21:58,080
ic-61850 is a standard used in

376
00:21:58,080 --> 00:22:00,480
electronical environment and have a

377
00:22:00,480 --> 00:22:02,700
swimming pool cost in yeast one is a

378
00:22:02,700 --> 00:22:04,620
nice protocol useful controller device

379
00:22:04,620 --> 00:22:08,100
another is SV protocol used to make sure

380
00:22:08,100 --> 00:22:10,620
the device value and the other is good

381
00:22:10,620 --> 00:22:13,320
protocol useful paste the event alert

382
00:22:13,320 --> 00:22:16,020
Bitcoin ID device

383
00:22:16,020 --> 00:22:19,260
here we use schools as an example it is

384
00:22:19,260 --> 00:22:21,659
a protocol for broadcasting event when

385
00:22:21,659 --> 00:22:25,440
no event happened the SQL will increase

386
00:22:25,440 --> 00:22:28,919
but it will it will process the all

387
00:22:28,919 --> 00:22:32,100
event order can and lay the value of xq9

388
00:22:32,100 --> 00:22:34,860
increase when new event happen

389
00:22:34,860 --> 00:22:37,679
the SQL will be safe too little and as

390
00:22:37,679 --> 00:22:40,620
K9 will increase what we want to do here

391
00:22:40,620 --> 00:22:43,380
is fact these two values

392
00:22:43,380 --> 00:22:45,900
this is the structural diagram of goose

393
00:22:45,900 --> 00:22:48,659
fan because we need because we want to

394
00:22:48,659 --> 00:22:52,320
fake the value of x key now and SQL so

395
00:22:52,320 --> 00:22:54,480
we need to know its position in the

396
00:22:54,480 --> 00:22:58,260
goods pdu on the right side of the slide

397
00:22:58,260 --> 00:23:00,840
and goods will put some information in

398
00:23:00,840 --> 00:23:02,820
all day car we also need this

399
00:23:02,820 --> 00:23:06,000
information but it is hard to know the

400
00:23:06,000 --> 00:23:08,820
whole data means without analysis

401
00:23:08,820 --> 00:23:12,240
but we know the goods will pass the

402
00:23:12,240 --> 00:23:14,580
event but Goods will pass where the

403
00:23:14,580 --> 00:23:17,220
event happened or not and we'll use the

404
00:23:17,220 --> 00:23:19,980
Boolean vehicle display so we can simply

405
00:23:19,980 --> 00:23:22,260
by sniffing the Chevy for a period of

406
00:23:22,260 --> 00:23:24,900
time and Filipino content of the Boolean

407
00:23:24,900 --> 00:23:28,260
values could trigger along and in our

408
00:23:28,260 --> 00:23:30,840
past practical experience when you

409
00:23:30,840 --> 00:23:32,820
triggering an alarm you will lay the

410
00:23:32,820 --> 00:23:36,120
Upstream device to some control because

411
00:23:36,120 --> 00:23:38,880
in general the factory will do some

412
00:23:38,880 --> 00:23:41,280
control Kool-Aid could handle the

413
00:23:41,280 --> 00:23:44,280
session so it means that we can

414
00:23:44,280 --> 00:23:46,980
intellectually affect the operation of

415
00:23:46,980 --> 00:23:50,100
the factory by triggering an error

416
00:23:50,100 --> 00:23:53,580
and each time when we finish the first

417
00:23:53,580 --> 00:23:56,580
emulation we will think about attack and

418
00:23:56,580 --> 00:23:58,020
defense

419
00:23:58,020 --> 00:24:01,200
here we use schools as an example fund

420
00:24:01,200 --> 00:24:03,539
and occasion point of review you can

421
00:24:03,539 --> 00:24:06,000
just set a love Peggy or change the

422
00:24:06,000 --> 00:24:09,720
value of sq9 sq9 or odeha in micro

423
00:24:09,720 --> 00:24:13,500
attack ICS is called spoof the Pokemon

424
00:24:13,500 --> 00:24:16,500
message and from a defensive point of

425
00:24:16,500 --> 00:24:20,100
view you can just check whether a

426
00:24:20,100 --> 00:24:24,780
disorder OBP Bitcoin Gooseberry or check

427
00:24:24,780 --> 00:24:27,480
source of package

428
00:24:27,480 --> 00:24:30,600
and this is our attack chain and we will

429
00:24:30,600 --> 00:24:33,740
show our demo video

430
00:24:40,559 --> 00:24:44,580
and this is our case pay

431
00:24:44,580 --> 00:24:46,799
and now we start our anniversary

432
00:24:46,799 --> 00:24:48,720
emulation

433
00:24:48,720 --> 00:24:51,539
first we will sniff the piggy for a few

434
00:24:51,539 --> 00:24:52,919
of can

435
00:24:52,919 --> 00:24:56,400
and when we find the goose Peggy we will

436
00:24:56,400 --> 00:25:00,360
do some analysis and change the value

437
00:25:00,360 --> 00:25:03,900
and you will let it and you will have a

438
00:25:03,900 --> 00:25:05,580
lung

439
00:25:05,580 --> 00:25:08,280
when a long happen the button device

440
00:25:08,280 --> 00:25:11,400
will be doing like the median device

441
00:25:11,400 --> 00:25:13,260
so now

442
00:25:13,260 --> 00:25:15,600
along happened the button device

443
00:25:15,600 --> 00:25:16,860
Speedway

444
00:25:16,860 --> 00:25:19,260
and we can see all of the first

445
00:25:19,260 --> 00:25:21,120
emulation

446
00:25:21,120 --> 00:25:24,419
it will show our attack finish

447
00:25:24,419 --> 00:25:27,480
and what a long happen it will lay

448
00:25:27,480 --> 00:25:29,820
Upstream device to some control like

449
00:25:29,820 --> 00:25:30,370
this

450
00:25:30,370 --> 00:25:33,439
[Music]

451
00:25:36,900 --> 00:25:37,980
thank you

452
00:25:37,980 --> 00:25:41,700
now we introduce another case Bay is

453
00:25:41,700 --> 00:25:44,580
Mitsubishi electricity device on the

454
00:25:44,580 --> 00:25:46,740
right side of the slide is the official

455
00:25:46,740 --> 00:25:50,940
website is the product diagram of the

456
00:25:50,940 --> 00:25:53,760
official website from left crew line the

457
00:25:53,760 --> 00:25:55,679
product functions are the least cooler

458
00:25:55,679 --> 00:25:58,559
mode company and the device we use is IQ

459
00:25:58,559 --> 00:26:01,320
Dash R series and the protocol in is is

460
00:26:01,320 --> 00:26:02,640
music

461
00:26:02,640 --> 00:26:05,820
and here we use Music could briefly

462
00:26:05,820 --> 00:26:10,260
introduce our process of

463
00:26:10,260 --> 00:26:13,260
cool introduce the process of our

464
00:26:13,260 --> 00:26:16,620
analysis of ICS protocol first we will

465
00:26:16,620 --> 00:26:18,720
read the official user menu and then

466
00:26:18,720 --> 00:26:21,120
make the function of each field cool

467
00:26:21,120 --> 00:26:24,360
technique divided by Michael okay ICS

468
00:26:24,360 --> 00:26:28,020
we generally Focus cool paths one is how

469
00:26:28,020 --> 00:26:31,140
to identify the ICS protocol which is

470
00:26:31,140 --> 00:26:33,600
the green part of the slide and the

471
00:26:33,600 --> 00:26:36,480
other is how to use the function of the

472
00:26:36,480 --> 00:26:39,000
protocol controller device which is the

473
00:26:39,000 --> 00:26:40,860
yellow part of the slide

474
00:26:40,860 --> 00:26:44,400
the weapon here is the yellow part we

475
00:26:44,400 --> 00:26:46,860
mentioned on the previous page there

476
00:26:46,860 --> 00:26:48,960
will be three parts one is the function

477
00:26:48,960 --> 00:26:51,659
called another is device address and the

478
00:26:51,659 --> 00:26:53,460
other is the Haku place

479
00:26:53,460 --> 00:26:56,520
and what I want to explain here is how

480
00:26:56,520 --> 00:26:58,559
difficult we have in building automation

481
00:26:58,559 --> 00:27:00,480
because

482
00:27:00,480 --> 00:27:02,340
device or address will be different

483
00:27:02,340 --> 00:27:04,559
according to your cashback environment

484
00:27:04,559 --> 00:27:08,220
so for the convenience of demo we print

485
00:27:08,220 --> 00:27:11,340
analysis the protocol and know which

486
00:27:11,340 --> 00:27:13,820
value represent which device address

487
00:27:13,820 --> 00:27:16,860
this is like most ICS psychological

488
00:27:16,860 --> 00:27:19,340
incidents not happen in the past because

489
00:27:19,340 --> 00:27:22,919
some incidents you can some incidents

490
00:27:22,919 --> 00:27:25,740
hackers can precisely okay what they

491
00:27:25,740 --> 00:27:28,260
want to attack so it means the hackers

492
00:27:28,260 --> 00:27:31,020
know some specific information in

493
00:27:31,020 --> 00:27:33,840
advance but if you stand from the point

494
00:27:33,840 --> 00:27:36,539
of the view of automation under the

495
00:27:36,539 --> 00:27:37,980
condition like you don't know anything

496
00:27:37,980 --> 00:27:40,500
you have include a numerator or possible

497
00:27:40,500 --> 00:27:42,539
value proof case

498
00:27:42,539 --> 00:27:45,120
and have no way of knowing what will

499
00:27:45,120 --> 00:27:46,220
happen

500
00:27:46,220 --> 00:27:48,120
okay

501
00:27:48,120 --> 00:27:50,159
and here we will go through the famous

502
00:27:50,159 --> 00:27:53,279
ICS Security in the past which then it

503
00:27:53,279 --> 00:27:55,500
started we choose to use starness

504
00:27:55,500 --> 00:27:58,260
because it is a common attraction on the

505
00:27:58,260 --> 00:28:01,500
ICS Sanctuary incidence the main account

506
00:28:01,500 --> 00:28:04,260
process of starness is first to find

507
00:28:04,260 --> 00:28:06,960
quality then check version and read or

508
00:28:06,960 --> 00:28:09,539
write device address and finally do some

509
00:28:09,539 --> 00:28:12,419
control correlated device to some of

510
00:28:12,419 --> 00:28:14,940
normal operation and we will use Music

511
00:28:14,940 --> 00:28:17,820
could produce it and this is our

512
00:28:17,820 --> 00:28:20,880
connection and now we show our demo

513
00:28:20,880 --> 00:28:23,120
video

514
00:28:26,100 --> 00:28:29,640
and this is our case back

515
00:28:29,640 --> 00:28:33,480
and here is our HDMI and we start our

516
00:28:33,480 --> 00:28:36,059
diversary emulation

517
00:28:36,059 --> 00:28:39,240
first we will scan local network and one

518
00:28:39,240 --> 00:28:41,820
could find our copy

519
00:28:41,820 --> 00:28:44,520
and each kind we find the Kaki we will

520
00:28:44,520 --> 00:28:48,559
record its IP for the next attack

521
00:28:50,340 --> 00:28:54,740
and then we check the type

522
00:28:54,900 --> 00:29:00,600
and we know is IQR series then we will

523
00:29:00,600 --> 00:29:03,659
device or address value

524
00:29:03,659 --> 00:29:06,480
and we will recall it

525
00:29:06,480 --> 00:29:09,539
is the device address value

526
00:29:09,539 --> 00:29:12,179
and then we want to write something

527
00:29:12,179 --> 00:29:15,179
here we want to change is SV SV is the

528
00:29:15,179 --> 00:29:18,059
upper limit of device pressure we want

529
00:29:18,059 --> 00:29:21,480
to let it higher solar when the value of

530
00:29:21,480 --> 00:29:24,960
pressure increase it will over the limit

531
00:29:24,960 --> 00:29:28,020
and will lay the device broken so now

532
00:29:28,020 --> 00:29:31,460
it's cool Point nicely

533
00:29:31,860 --> 00:29:34,640
and

534
00:29:34,640 --> 00:29:39,419
cool Point nicely will be 6.72

535
00:29:39,419 --> 00:29:41,520
and finally we want to open the air

536
00:29:41,520 --> 00:29:43,020
compressor

537
00:29:43,020 --> 00:29:46,260
and when you open it will be late

538
00:29:46,260 --> 00:29:48,480
so air compressor is open

539
00:29:48,480 --> 00:29:51,360
and we can see the value of pressure now

540
00:29:51,360 --> 00:29:53,700
is

541
00:29:53,700 --> 00:29:55,080
uh

542
00:29:55,080 --> 00:29:57,240
0.6

543
00:29:57,240 --> 00:30:00,059
and it will slowly increase and when you

544
00:30:00,059 --> 00:30:02,460
over the limit it will let the device

545
00:30:02,460 --> 00:30:04,880
broken

546
00:30:08,460 --> 00:30:11,039
and finally with one cool call about our

547
00:30:11,039 --> 00:30:15,720
opinion of use such cools by company we

548
00:30:15,720 --> 00:30:17,940
believe that no maker what emulator you

549
00:30:17,940 --> 00:30:20,399
use there are basically three kinds of

550
00:30:20,399 --> 00:30:23,279
attack one is cve another is used some

551
00:30:23,279 --> 00:30:25,860
way Kool-Aid device cannot work and the

552
00:30:25,860 --> 00:30:28,620
other is use the function of ICS Pro

553
00:30:28,620 --> 00:30:31,440
called kudusa abnormal abbreviation and

554
00:30:31,440 --> 00:30:35,000
when you use such cools

555
00:30:38,179 --> 00:30:41,100
maybe you can use digital queen as a

556
00:30:41,100 --> 00:30:42,960
column of the vehicle

557
00:30:42,960 --> 00:30:45,720
and cook help you with the first

558
00:30:45,720 --> 00:30:47,039
emulation

559
00:30:47,039 --> 00:30:49,380
although there are still many challenges

560
00:30:49,380 --> 00:30:51,299
we think it will be a trend in the

561
00:30:51,299 --> 00:30:52,440
future

562
00:30:52,440 --> 00:30:54,840
and here is a summary of our speech

563
00:30:54,840 --> 00:30:57,380
first we call about

564
00:30:57,380 --> 00:31:00,840
ICS and other fossil emulation then we

565
00:31:00,840 --> 00:31:03,779
summarize the behavior of ICS malware

566
00:31:03,779 --> 00:31:07,380
then we propose fourth stage and use

567
00:31:07,380 --> 00:31:10,679
data and control these two parts on the

568
00:31:10,679 --> 00:31:13,140
point of a vehicle is planned then we

569
00:31:13,140 --> 00:31:16,140
use cool different ICS protocol could

570
00:31:16,140 --> 00:31:18,779
demo all of the first emulation and

571
00:31:18,779 --> 00:31:21,600
finally we show recall about our few

572
00:31:21,600 --> 00:31:23,820
unused such cools

573
00:31:23,820 --> 00:31:26,890
and thank you for your listening

574
00:31:26,890 --> 00:31:34,999
[Applause]

