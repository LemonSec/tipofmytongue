1
00:00:00,359 --> 00:00:02,580
hello good morning

2
00:00:02,580 --> 00:00:04,380
so

3
00:00:04,380 --> 00:00:06,420
this is going to be a slightly different

4
00:00:06,420 --> 00:00:09,720
keynote than you may be used to

5
00:00:09,720 --> 00:00:10,620
um

6
00:00:10,620 --> 00:00:12,599
I will

7
00:00:12,599 --> 00:00:15,120
I will not be giving you a hand wavy

8
00:00:15,120 --> 00:00:18,660
inspirational uh type of talk I will not

9
00:00:18,660 --> 00:00:21,779
be trying to scare you into action I

10
00:00:21,779 --> 00:00:23,939
feel like those Keynotes like much about

11
00:00:23,939 --> 00:00:25,920
what I'm going to talk about don't

12
00:00:25,920 --> 00:00:28,380
really solve anything so we're going to

13
00:00:28,380 --> 00:00:31,500
talk about what actually matters

14
00:00:31,500 --> 00:00:34,079
but first I'll introduce myself

15
00:00:34,079 --> 00:00:37,559
so hi my name is Neil Weiler in the

16
00:00:37,559 --> 00:00:39,120
information security Community or the

17
00:00:39,120 --> 00:00:40,800
hacker Community I am better known as

18
00:00:40,800 --> 00:00:43,860
grifter I am the global lead of active

19
00:00:43,860 --> 00:00:46,739
threat assessments for IBM X-Force

20
00:00:46,739 --> 00:00:50,100
um I do that by day right that means

21
00:00:50,100 --> 00:00:53,340
that essentially my entire day job is

22
00:00:53,340 --> 00:00:55,440
focused around IBM's threat hunting

23
00:00:55,440 --> 00:00:56,760
practice

24
00:00:56,760 --> 00:00:59,219
I've been a threat Hunter for about a

25
00:00:59,219 --> 00:01:03,000
decade now full time and again that's

26
00:01:03,000 --> 00:01:05,700
what I do by day by night I run all the

27
00:01:05,700 --> 00:01:07,260
technical operations for the black hat

28
00:01:07,260 --> 00:01:09,060
security briefings so I set up the black

29
00:01:09,060 --> 00:01:10,740
hat knock at all the conferences around

30
00:01:10,740 --> 00:01:13,320
the world I'm also one of the main

31
00:01:13,320 --> 00:01:15,780
organizers of Defcon the largest hacker

32
00:01:15,780 --> 00:01:18,360
convention in the world I'm on the

33
00:01:18,360 --> 00:01:21,500
review boards for black hat and Defcon

34
00:01:21,500 --> 00:01:25,140
I have helped run the RSA conference

35
00:01:25,140 --> 00:01:28,080
security operations center as well I've

36
00:01:28,080 --> 00:01:29,880
written some books I speak at places

37
00:01:29,880 --> 00:01:32,159
around the world and all of that's not

38
00:01:32,159 --> 00:01:34,920
supposed to be braggy it's things that

39
00:01:34,920 --> 00:01:37,560
make my mom proud but at the end of the

40
00:01:37,560 --> 00:01:39,540
day what it means is that I love

41
00:01:39,540 --> 00:01:43,560
security like I live security I would do

42
00:01:43,560 --> 00:01:45,420
this for free is what I tell people all

43
00:01:45,420 --> 00:01:47,040
the time but I'm really happy that they

44
00:01:47,040 --> 00:01:48,840
pay me to do it

45
00:01:48,840 --> 00:01:49,680
um

46
00:01:49,680 --> 00:01:51,540
so

47
00:01:51,540 --> 00:01:53,939
again what we're going to to talk about

48
00:01:53,939 --> 00:01:56,460
today is the unique position that I've

49
00:01:56,460 --> 00:01:59,420
been put in where for the last 10 years

50
00:01:59,420 --> 00:02:01,979
I have gone into some of the largest

51
00:02:01,979 --> 00:02:04,920
companies in the world and been asked

52
00:02:04,920 --> 00:02:07,560
are we doing the right things are the

53
00:02:07,560 --> 00:02:10,619
attackers already here can you tell us

54
00:02:10,619 --> 00:02:12,780
does this program work the right way

55
00:02:12,780 --> 00:02:14,819
what have you learned from your

56
00:02:14,819 --> 00:02:16,920
experience in defending

57
00:02:16,920 --> 00:02:18,300
um and I'll put in quotes one of the

58
00:02:18,300 --> 00:02:20,340
most hostile networks in the world at

59
00:02:20,340 --> 00:02:22,560
black hat and are we doing the right

60
00:02:22,560 --> 00:02:23,819
things

61
00:02:23,819 --> 00:02:26,340
and so again when I have those

62
00:02:26,340 --> 00:02:29,160
conversations no one says to me can you

63
00:02:29,160 --> 00:02:30,660
tell me something to inspire my

64
00:02:30,660 --> 00:02:33,720
employees they say is my threat hunting

65
00:02:33,720 --> 00:02:36,480
program good am I using the right

66
00:02:36,480 --> 00:02:39,720
technology what should I be doing and

67
00:02:39,720 --> 00:02:41,819
what am I missing those are the

68
00:02:41,819 --> 00:02:43,260
questions they ask

69
00:02:43,260 --> 00:02:44,940
and so

70
00:02:44,940 --> 00:02:47,700
being in the position of of spending the

71
00:02:47,700 --> 00:02:50,819
last 20 plus years that

72
00:02:50,819 --> 00:02:53,760
conferences like like black hat and and

73
00:02:53,760 --> 00:02:55,980
RSA conference where you go out onto the

74
00:02:55,980 --> 00:02:59,400
Expo floor and vendors come to you and

75
00:02:59,400 --> 00:03:01,440
promise you the world right there are

76
00:03:01,440 --> 00:03:03,239
banners and posters and blinking lights

77
00:03:03,239 --> 00:03:06,500
and signs that all say

78
00:03:06,500 --> 00:03:09,540
this will solve everything right this is

79
00:03:09,540 --> 00:03:12,300
the next thing you just get this and all

80
00:03:12,300 --> 00:03:14,700
of your security problems will go away

81
00:03:14,700 --> 00:03:18,260
and that is just not the truth right

82
00:03:18,260 --> 00:03:22,080
vendors are not going to save us

83
00:03:22,080 --> 00:03:25,019
putting another Blinky box in in your

84
00:03:25,019 --> 00:03:26,700
environment is not going to be the

85
00:03:26,700 --> 00:03:29,519
solution for your security problems

86
00:03:29,519 --> 00:03:30,120
um

87
00:03:30,120 --> 00:03:32,280
we're often told now that machine

88
00:03:32,280 --> 00:03:34,440
learning will do that right AI is going

89
00:03:34,440 --> 00:03:37,080
to do that we're going to have these

90
00:03:37,080 --> 00:03:38,280
things solve for us because everything

91
00:03:38,280 --> 00:03:40,799
will be automated well

92
00:03:40,799 --> 00:03:43,440
automation only works for you to a

93
00:03:43,440 --> 00:03:46,799
certain extent mechanics still are

94
00:03:46,799 --> 00:03:48,480
required to use the tools right somebody

95
00:03:48,480 --> 00:03:51,599
has to turn the wrench right when you

96
00:03:51,599 --> 00:03:53,280
could say that it's a sprinkler system

97
00:03:53,280 --> 00:03:56,280
and a building is automated right if it

98
00:03:56,280 --> 00:03:58,200
gets hot enough it will start spraying

99
00:03:58,200 --> 00:04:00,840
water everywhere but we don't say we

100
00:04:00,840 --> 00:04:01,739
don't need to worry about the fire

101
00:04:01,739 --> 00:04:04,519
department the sprinkler system's got it

102
00:04:04,519 --> 00:04:08,519
so humans are still a very necessary

103
00:04:08,519 --> 00:04:11,340
part of our program and they will be for

104
00:04:11,340 --> 00:04:13,500
a significant amount of time this is not

105
00:04:13,500 --> 00:04:15,180
something we just set and forget and

106
00:04:15,180 --> 00:04:17,639
walk away

107
00:04:17,639 --> 00:04:20,940
um security is complex right we

108
00:04:20,940 --> 00:04:21,720
um

109
00:04:21,720 --> 00:04:24,000
as as these new technologies come out

110
00:04:24,000 --> 00:04:25,560
we're told no this is the one that you

111
00:04:25,560 --> 00:04:27,300
need no this is the one you need a

112
00:04:27,300 --> 00:04:28,919
little sprinkling of this a little bit

113
00:04:28,919 --> 00:04:30,300
more of that

114
00:04:30,300 --> 00:04:33,479
um and the reality is is that we kind of

115
00:04:33,479 --> 00:04:36,540
lose our way we get distracted by all

116
00:04:36,540 --> 00:04:38,100
the shiny things by all the blinking

117
00:04:38,100 --> 00:04:40,259
things the things we're told will fix it

118
00:04:40,259 --> 00:04:42,780
all and in the end it's the foundations

119
00:04:42,780 --> 00:04:45,060
that really matter and I'll show you

120
00:04:45,060 --> 00:04:47,340
what I mean

121
00:04:47,340 --> 00:04:51,979
so it's Story Time with grifter

122
00:04:52,860 --> 00:04:54,540
um so I'm going to share with you

123
00:04:54,540 --> 00:04:56,759
several stories about things that I've

124
00:04:56,759 --> 00:04:59,220
found while hunting in different

125
00:04:59,220 --> 00:05:02,040
organizations around the world some of

126
00:05:02,040 --> 00:05:04,560
them large some of them small in this

127
00:05:04,560 --> 00:05:06,419
case one of the largest financial

128
00:05:06,419 --> 00:05:08,780
organizations in the world

129
00:05:08,780 --> 00:05:12,419
we were asked to go in and assess their

130
00:05:12,419 --> 00:05:14,520
hunting program show them best practices

131
00:05:14,520 --> 00:05:16,740
discuss with them what

132
00:05:16,740 --> 00:05:19,259
it is that they could do to improve

133
00:05:19,259 --> 00:05:22,400
I sat down with their um their director

134
00:05:22,400 --> 00:05:24,780
of security

135
00:05:24,780 --> 00:05:27,060
um and they said

136
00:05:27,060 --> 00:05:28,860
okay what are you going to do how are

137
00:05:28,860 --> 00:05:31,139
you going to start evaluating us and I

138
00:05:31,139 --> 00:05:32,759
said all right well

139
00:05:32,759 --> 00:05:35,160
let's just show you let's let's sit down

140
00:05:35,160 --> 00:05:37,139
and give you an example of what it is

141
00:05:37,139 --> 00:05:39,479
that we're going to do this is a major

142
00:05:39,479 --> 00:05:41,580
organization hundreds of security staff

143
00:05:41,580 --> 00:05:44,160
in that building alone 38 people working

144
00:05:44,160 --> 00:05:47,880
in the sock actively at that time

145
00:05:47,880 --> 00:05:48,800
um

146
00:05:48,800 --> 00:05:50,940
incredibly mature right incredibly

147
00:05:50,940 --> 00:05:51,960
mature

148
00:05:51,960 --> 00:05:54,539
we sit down and I say well let's look at

149
00:05:54,539 --> 00:05:55,620
some of the sessions that are going

150
00:05:55,620 --> 00:05:56,639
through here we're going to look for

151
00:05:56,639 --> 00:05:58,020
outliers things where there's a low

152
00:05:58,020 --> 00:06:00,419
number something that we can

153
00:06:00,419 --> 00:06:04,979
um you know quickly uh assess by just

154
00:06:04,979 --> 00:06:06,960
you know tabbing through it is that is

155
00:06:06,960 --> 00:06:08,820
that good is that bad

156
00:06:08,820 --> 00:06:10,259
for instance let's look at this FTP

157
00:06:10,259 --> 00:06:13,440
traffic and he says I'm sorry uh we

158
00:06:13,440 --> 00:06:15,660
don't use FTP I was like oh well perfect

159
00:06:15,660 --> 00:06:17,940
because there's FTP traffic here and if

160
00:06:17,940 --> 00:06:19,979
you're saying you don't use it that is a

161
00:06:19,979 --> 00:06:21,180
great thing to go and look at and he

162
00:06:21,180 --> 00:06:23,880
says no you don't understand we don't

163
00:06:23,880 --> 00:06:25,560
allow FTP

164
00:06:25,560 --> 00:06:27,840
is it did you lose the signal

165
00:06:27,840 --> 00:06:29,699
let me try

166
00:06:29,699 --> 00:06:33,259
sorry technical difficulties

167
00:06:37,440 --> 00:06:38,639
um

168
00:06:38,639 --> 00:06:41,180
good

169
00:06:41,180 --> 00:06:42,740
no

170
00:06:42,740 --> 00:06:46,199
I'll take a drink while they look okay

171
00:06:46,199 --> 00:06:47,520
thank you

172
00:06:47,520 --> 00:06:49,560
if I have to do that every three minutes

173
00:06:49,560 --> 00:06:52,080
just let me know

174
00:06:52,080 --> 00:06:53,039
um

175
00:06:53,039 --> 00:06:56,280
all right so um so I say well let's look

176
00:06:56,280 --> 00:06:58,020
at that then let's let's see he says no

177
00:06:58,020 --> 00:06:59,520
we don't we don't allow it and I was

178
00:06:59,520 --> 00:07:02,880
like again great let's just take a look

179
00:07:02,880 --> 00:07:04,620
what we find is a small amount of

180
00:07:04,620 --> 00:07:08,160
traffic clear text right FTP going to a

181
00:07:08,160 --> 00:07:10,860
server that ends in dot Ru right these

182
00:07:10,860 --> 00:07:13,039
attackers were not even trying to hide

183
00:07:13,039 --> 00:07:15,479
consistent Behavior every day one

184
00:07:15,479 --> 00:07:17,400
o'clock in the morning a file was sent

185
00:07:17,400 --> 00:07:19,440
out and

186
00:07:19,440 --> 00:07:21,180
I say well do you want to look at that

187
00:07:21,180 --> 00:07:22,979
they had full packet capture so we could

188
00:07:22,979 --> 00:07:24,960
extract that file from the packets

189
00:07:24,960 --> 00:07:27,000
rebuild it and take a look he said yeah

190
00:07:27,000 --> 00:07:28,440
I want to look I said will you open it

191
00:07:28,440 --> 00:07:30,000
this is your network

192
00:07:30,000 --> 00:07:32,340
opens it up looks at it

193
00:07:32,340 --> 00:07:34,560
I can only describe it as like getting

194
00:07:34,560 --> 00:07:36,240
the wind knocked out of you like this

195
00:07:36,240 --> 00:07:39,539
like like but also panic oh like the

196
00:07:39,539 --> 00:07:41,639
sound came out and then he closed the

197
00:07:41,639 --> 00:07:43,259
file and I said and he said you didn't

198
00:07:43,259 --> 00:07:44,940
see that and I said all right great out

199
00:07:44,940 --> 00:07:47,280
of curiosity what did I not see

200
00:07:47,280 --> 00:07:48,660
he was like that is every financial

201
00:07:48,660 --> 00:07:50,580
transaction and trade that we have made

202
00:07:50,580 --> 00:07:52,979
in the last 24 hours

203
00:07:52,979 --> 00:07:55,500
so

204
00:07:55,500 --> 00:07:58,080
very large very

205
00:07:58,080 --> 00:08:00,000
um mature sock

206
00:08:00,000 --> 00:08:04,020
a lot of Staff all kinds of Technology a

207
00:08:04,020 --> 00:08:06,419
clear text protocol going to Russia

208
00:08:06,419 --> 00:08:10,139
every night looking at their logs for at

209
00:08:10,139 --> 00:08:13,020
least six months every night in an

210
00:08:13,020 --> 00:08:14,819
environment that should have been able

211
00:08:14,819 --> 00:08:16,380
to find that

212
00:08:16,380 --> 00:08:19,800
so was it a technology failure no it

213
00:08:19,800 --> 00:08:21,240
just was the fact that they weren't

214
00:08:21,240 --> 00:08:23,639
looking they were completely reliant on

215
00:08:23,639 --> 00:08:26,039
the technology and they weren't using it

216
00:08:26,039 --> 00:08:27,780
as a tool they were using it as a

217
00:08:27,780 --> 00:08:30,720
replacement for for that effort for the

218
00:08:30,720 --> 00:08:32,940
time spent looking

219
00:08:32,940 --> 00:08:35,580
this is a U.S state a large state in the

220
00:08:35,580 --> 00:08:37,799
in the United States a mature security

221
00:08:37,799 --> 00:08:40,860
staff great documentation actually such

222
00:08:40,860 --> 00:08:42,779
great documentation it's still the best

223
00:08:42,779 --> 00:08:45,540
network documentation I've ever seen and

224
00:08:45,540 --> 00:08:48,300
they were using great best practices but

225
00:08:48,300 --> 00:08:50,580
we saw traffic to an outlier region that

226
00:08:50,580 --> 00:08:51,959
shouldn't have been there again small

227
00:08:51,959 --> 00:08:54,779
amounts of data but consistently between

228
00:08:54,779 --> 00:08:57,839
every 8 to 30 seconds

229
00:08:57,839 --> 00:09:00,120
records were being sent out in the clear

230
00:09:00,120 --> 00:09:02,100
again and this was personally

231
00:09:02,100 --> 00:09:03,779
identifiable information of the

232
00:09:03,779 --> 00:09:05,959
individuals who lived in this state

233
00:09:05,959 --> 00:09:08,880
it was one mistake they had a test web

234
00:09:08,880 --> 00:09:10,920
server sitting off in a corner and they

235
00:09:10,920 --> 00:09:12,779
had forgotten about it one of the most

236
00:09:12,779 --> 00:09:15,300
impeccably documented networks I've ever

237
00:09:15,300 --> 00:09:18,360
seen a single web server at the time

238
00:09:18,360 --> 00:09:21,720
Apache struts had come out they had you

239
00:09:21,720 --> 00:09:23,880
know been exploited by that and they

240
00:09:23,880 --> 00:09:26,160
were losing data again consistently for

241
00:09:26,160 --> 00:09:28,200
about six months

242
00:09:28,200 --> 00:09:31,380
so you forget about one web server but

243
00:09:31,380 --> 00:09:33,560
China did not

244
00:09:33,560 --> 00:09:35,160
uh

245
00:09:35,160 --> 00:09:38,880
now this one a foreign government this

246
00:09:38,880 --> 00:09:40,860
was not they were understaffed they had

247
00:09:40,860 --> 00:09:42,660
outdated practices they were trying to

248
00:09:42,660 --> 00:09:44,760
do their best but as soon as we get on

249
00:09:44,760 --> 00:09:45,839
the network and we start looking around

250
00:09:45,839 --> 00:09:47,580
we see incredibly noisy traffic

251
00:09:47,580 --> 00:09:50,160
incredibly noisy we say what is this

252
00:09:50,160 --> 00:09:52,140
like is this something that you're doing

253
00:09:52,140 --> 00:09:53,760
are you scanning for vulnerabilities now

254
00:09:53,760 --> 00:09:55,680
is this whatever can you go back and

255
00:09:55,680 --> 00:09:57,540
check and see what this IP address maps

256
00:09:57,540 --> 00:09:59,580
to and he was like yeah I'm sure that's

257
00:09:59,580 --> 00:10:01,200
just our security team running some

258
00:10:01,200 --> 00:10:02,760
scans and doing whatever and then he

259
00:10:02,760 --> 00:10:04,980
goes oh no

260
00:10:04,980 --> 00:10:07,500
that's an exchange server we're like

261
00:10:07,500 --> 00:10:09,839
well it's not just an exchange server

262
00:10:09,839 --> 00:10:13,320
anymore so they had it very externally

263
00:10:13,320 --> 00:10:15,480
focused security bias they were worried

264
00:10:15,480 --> 00:10:17,640
about keeping attackers out they didn't

265
00:10:17,640 --> 00:10:19,320
ask the question what if they're already

266
00:10:19,320 --> 00:10:21,060
here so they weren't looking at

267
00:10:21,060 --> 00:10:22,800
East-West traffic they weren't looking

268
00:10:22,800 --> 00:10:24,720
at the things that were going on inside

269
00:10:24,720 --> 00:10:26,160
their Network they were only worried

270
00:10:26,160 --> 00:10:28,440
about well what how do we keep them out

271
00:10:28,440 --> 00:10:30,660
how do we keep them out not what do we

272
00:10:30,660 --> 00:10:32,700
do if they're if they're getting if they

273
00:10:32,700 --> 00:10:35,459
get inside excuse me

274
00:10:35,459 --> 00:10:38,459
a major game developer mature security

275
00:10:38,459 --> 00:10:40,860
staff a lot of different solutions

276
00:10:40,860 --> 00:10:42,540
deployed a lot of different Technologies

277
00:10:42,540 --> 00:10:45,180
and open to trying out new things they

278
00:10:45,180 --> 00:10:46,920
were like tell us what else we need we'd

279
00:10:46,920 --> 00:10:48,240
love to know what else we need to keep

280
00:10:48,240 --> 00:10:50,040
these people out we're like all right

281
00:10:50,040 --> 00:10:51,899
great let's take a look

282
00:10:51,899 --> 00:10:53,760
but they had incredibly poor Network

283
00:10:53,760 --> 00:10:57,000
segmentation everything was open as soon

284
00:10:57,000 --> 00:10:58,500
as you got on the network you could see

285
00:10:58,500 --> 00:11:00,360
everything

286
00:11:00,360 --> 00:11:02,220
clear text credentials flying around

287
00:11:02,220 --> 00:11:04,500
everywhere credentials to their GitHub

288
00:11:04,500 --> 00:11:06,899
Docker management Confluence artifactory

289
00:11:06,899 --> 00:11:09,240
all of the things that if an attacker

290
00:11:09,240 --> 00:11:12,959
even breached one layer of that security

291
00:11:12,959 --> 00:11:15,240
they would have the keys to the kingdom

292
00:11:15,240 --> 00:11:17,339
in that organization now they were not

293
00:11:17,339 --> 00:11:19,019
breached there was no evidence of an

294
00:11:19,019 --> 00:11:20,160
attacker there

295
00:11:20,160 --> 00:11:22,500
but had they been someone could have

296
00:11:22,500 --> 00:11:24,660
made updates to their code and pushed

297
00:11:24,660 --> 00:11:26,640
them and the next time somebody updated

298
00:11:26,640 --> 00:11:29,760
a game on Steam or their game on Steam

299
00:11:29,760 --> 00:11:31,140
they'd be delivered whatever that

300
00:11:31,140 --> 00:11:33,480
attacker wanted when we discussed it

301
00:11:33,480 --> 00:11:34,620
with them

302
00:11:34,620 --> 00:11:36,600
they just said look

303
00:11:36,600 --> 00:11:38,399
um we're just like one big happy family

304
00:11:38,399 --> 00:11:40,140
like we're just like we trust each other

305
00:11:40,140 --> 00:11:41,640
or whatever and I'm like that's great

306
00:11:41,640 --> 00:11:45,000
like for you guys but it's not so great

307
00:11:45,000 --> 00:11:48,180
if somebody comes in from the outside so

308
00:11:48,180 --> 00:11:50,760
some changes were made there

309
00:11:50,760 --> 00:11:52,200
thank you

310
00:11:52,200 --> 00:11:54,800
okay

311
00:11:55,019 --> 00:11:59,220
in this case this was during black hat

312
00:11:59,220 --> 00:12:01,380
we have a significant amount of threat

313
00:12:01,380 --> 00:12:04,380
hunters in the black hat knock during

314
00:12:04,380 --> 00:12:06,839
black hat because there's a lot to look

315
00:12:06,839 --> 00:12:09,480
through again blackout is often deemed

316
00:12:09,480 --> 00:12:11,160
as one of the most hostile networks in

317
00:12:11,160 --> 00:12:12,959
the world and that's true if you look at

318
00:12:12,959 --> 00:12:15,300
just the traffic at face value

319
00:12:15,300 --> 00:12:18,360
it's not so true once you start to dig

320
00:12:18,360 --> 00:12:20,160
into that traffic right it looks scary

321
00:12:20,160 --> 00:12:22,200
because there's a lot of malicious

322
00:12:22,200 --> 00:12:23,519
traffic going on but it's somebody

323
00:12:23,519 --> 00:12:25,260
showing their friend a demo in the

324
00:12:25,260 --> 00:12:27,240
hallway or it's somebody working in a

325
00:12:27,240 --> 00:12:28,860
training class and trying out something

326
00:12:28,860 --> 00:12:30,959
that they just learn they're working in

327
00:12:30,959 --> 00:12:33,540
a lab or doing something like that the

328
00:12:33,540 --> 00:12:35,820
the challenge that we have at Black Hat

329
00:12:35,820 --> 00:12:38,339
is finding the bad within the bad right

330
00:12:38,339 --> 00:12:40,260
when everything is the type of traffic

331
00:12:40,260 --> 00:12:42,180
that would normally cause a declared

332
00:12:42,180 --> 00:12:43,380
incident

333
00:12:43,380 --> 00:12:45,600
then how how do you determine what you

334
00:12:45,600 --> 00:12:47,339
actually need to worry about and so

335
00:12:47,339 --> 00:12:49,380
there's a lot of hunters in the knock at

336
00:12:49,380 --> 00:12:51,839
black hat and they're just looking for

337
00:12:51,839 --> 00:12:53,459
something anomalous something that is

338
00:12:53,459 --> 00:12:55,680
targeted at a specific individual on the

339
00:12:55,680 --> 00:12:57,300
network or a specific piece of

340
00:12:57,300 --> 00:12:58,740
infrastructure maybe the core

341
00:12:58,740 --> 00:13:00,540
infrastructure the registration Network

342
00:13:00,540 --> 00:13:03,480
things like that it is searching for a

343
00:13:03,480 --> 00:13:05,940
needle in a needle stack and it's a

344
00:13:05,940 --> 00:13:07,380
challenge but we love it and that's why

345
00:13:07,380 --> 00:13:10,380
we keep doing it at black hat this

346
00:13:10,380 --> 00:13:12,720
particular year we saw

347
00:13:12,720 --> 00:13:15,120
some odd traffic going just direct to an

348
00:13:15,120 --> 00:13:17,880
IP address now humans don't often say I

349
00:13:17,880 --> 00:13:19,680
found a really great site you should

350
00:13:19,680 --> 00:13:22,100
check it out it's

351
00:13:22,100 --> 00:13:25,860
64.223.18. whatever right we say here is

352
00:13:25,860 --> 00:13:28,139
a host name to go to so we just look to

353
00:13:28,139 --> 00:13:29,459
see well what's going what's at the

354
00:13:29,459 --> 00:13:31,740
other end of this IP address

355
00:13:31,740 --> 00:13:34,320
and what we found was there was a 404

356
00:13:34,320 --> 00:13:35,880
page being returned but every time it

357
00:13:35,880 --> 00:13:37,139
returned it came back with a different

358
00:13:37,139 --> 00:13:39,180
type of traffic we were like well that's

359
00:13:39,180 --> 00:13:41,279
odd different amounts different things

360
00:13:41,279 --> 00:13:43,680
different data inside and as we dug in

361
00:13:43,680 --> 00:13:46,200
what we discovered was that there was

362
00:13:46,200 --> 00:13:48,300
somebody on the network who was actively

363
00:13:48,300 --> 00:13:50,579
trying to attack the infrastructure as

364
00:13:50,579 --> 00:13:53,519
well as other attendees using an exploit

365
00:13:53,519 --> 00:13:55,079
for a vulnerability that had been

366
00:13:55,079 --> 00:13:57,660
disclosed from the stage only 12 hours

367
00:13:57,660 --> 00:13:58,920
before

368
00:13:58,920 --> 00:14:02,220
so somebody the day prior had said hey

369
00:14:02,220 --> 00:14:03,300
where

370
00:14:03,300 --> 00:14:05,339
uh we found this vulnerability we've let

371
00:14:05,339 --> 00:14:07,860
the vendor know blah blah blah here's my

372
00:14:07,860 --> 00:14:10,200
talk at black hat and someone in that

373
00:14:10,200 --> 00:14:13,079
audience went cool and walked out into

374
00:14:13,079 --> 00:14:14,940
the hallway sat down and started writing

375
00:14:14,940 --> 00:14:16,980
an exploit for it and within less than

376
00:14:16,980 --> 00:14:19,740
24 hours was actively trying to exploit

377
00:14:19,740 --> 00:14:22,620
that on the network and that's what

378
00:14:22,620 --> 00:14:24,959
we're up against so this wasn't a zero

379
00:14:24,959 --> 00:14:26,040
day right the vulnerability had been

380
00:14:26,040 --> 00:14:28,139
disclosed but it's the same day

381
00:14:28,139 --> 00:14:31,160
that's a challenge

382
00:14:32,420 --> 00:14:37,320
also at black hat what we see is a lot

383
00:14:37,320 --> 00:14:39,180
of traffic that comes through if we're

384
00:14:39,180 --> 00:14:41,820
if we see executables dlls PDFs whatever

385
00:14:41,820 --> 00:14:43,920
we automatically take those things

386
00:14:43,920 --> 00:14:46,040
assign them a risk score throw them into

387
00:14:46,040 --> 00:14:48,300
Cisco threat grid like into a Sandbox

388
00:14:48,300 --> 00:14:50,639
open it up see what it does try to

389
00:14:50,639 --> 00:14:52,260
interact with it so sometimes things are

390
00:14:52,260 --> 00:14:54,899
popping up on the screen

391
00:14:54,899 --> 00:14:56,940
we're like what's that and in this case

392
00:14:56,940 --> 00:14:59,820
we saw the Wells Fargo logo come across

393
00:14:59,820 --> 00:15:01,139
and I was like those are financial

394
00:15:01,139 --> 00:15:02,940
documents we should take a look at that

395
00:15:02,940 --> 00:15:05,699
when we looked at it it was a

396
00:15:05,699 --> 00:15:07,019
significant amount of sensitive

397
00:15:07,019 --> 00:15:08,880
information on a particular individual

398
00:15:08,880 --> 00:15:11,339
who was in a training class and normally

399
00:15:11,339 --> 00:15:13,740
we don't have the bandwidth to walk down

400
00:15:13,740 --> 00:15:16,320
to every person who is experiencing some

401
00:15:16,320 --> 00:15:18,300
kind of problem but in this case it was

402
00:15:18,300 --> 00:15:20,279
severe enough that I thought we should

403
00:15:20,279 --> 00:15:23,399
go and talk to this person so I had

404
00:15:23,399 --> 00:15:26,699
their name so I went down to the class

405
00:15:26,699 --> 00:15:28,199
and said to them

406
00:15:28,199 --> 00:15:30,899
hey um I I need to talk to you about

407
00:15:30,899 --> 00:15:32,820
something can can we talk in the back of

408
00:15:32,820 --> 00:15:34,920
the class I said hey you're sending out

409
00:15:34,920 --> 00:15:37,680
a significant amount of sensitive

410
00:15:37,680 --> 00:15:39,660
information on the network what's going

411
00:15:39,660 --> 00:15:40,860
on and

412
00:15:40,860 --> 00:15:42,480
and often at black hat when we tell

413
00:15:42,480 --> 00:15:44,579
people that they already are sending

414
00:15:44,579 --> 00:15:45,959
command and control traffic when they

415
00:15:45,959 --> 00:15:48,120
get on the network or we're detected

416
00:15:48,120 --> 00:15:50,339
crypto mining activity coming from their

417
00:15:50,339 --> 00:15:52,740
device they're resistant to that right

418
00:15:52,740 --> 00:15:54,720
I've been in security for this many

419
00:15:54,720 --> 00:15:56,519
years and this was the case here as well

420
00:15:56,519 --> 00:15:58,320
they did not want to accept that

421
00:15:58,320 --> 00:16:00,660
something was wrong until I said you

422
00:16:00,660 --> 00:16:03,779
have this much left on your mortgage

423
00:16:03,779 --> 00:16:06,899
suddenly his attitude changed he said no

424
00:16:06,899 --> 00:16:10,260
no wait I I swear I'm using a VPN I know

425
00:16:10,260 --> 00:16:12,120
I've been doing this forever went and

426
00:16:12,120 --> 00:16:14,040
got his laptop points to the system tray

427
00:16:14,040 --> 00:16:15,540
and sure enough there's the little green

428
00:16:15,540 --> 00:16:17,399
icon showing that he's connected to the

429
00:16:17,399 --> 00:16:20,639
VPN unfortunately split tunneling wasn't

430
00:16:20,639 --> 00:16:23,639
configured correctly and so some of his

431
00:16:23,639 --> 00:16:25,260
information was flying out into the

432
00:16:25,260 --> 00:16:26,459
clear

433
00:16:26,459 --> 00:16:28,260
I asked why would you do that at black

434
00:16:28,260 --> 00:16:30,720
hat anyway and he said well my kid is

435
00:16:30,720 --> 00:16:33,000
going to University in the fall and they

436
00:16:33,000 --> 00:16:35,880
needed information for financial aid

437
00:16:35,880 --> 00:16:39,420
and uh apparently the site that for this

438
00:16:39,420 --> 00:16:41,759
University also was not encrypting

439
00:16:41,759 --> 00:16:43,740
traffic as it received these files for

440
00:16:43,740 --> 00:16:46,259
upload so now we let this individual

441
00:16:46,259 --> 00:16:47,940
know that they were sending clear text

442
00:16:47,940 --> 00:16:49,440
traffic and we also contacted the

443
00:16:49,440 --> 00:16:52,139
university to let them know hey you are

444
00:16:52,139 --> 00:16:54,899
in fact having some issues so that's the

445
00:16:54,899 --> 00:16:57,360
thing about black hat often build as one

446
00:16:57,360 --> 00:16:58,620
of the most hostile networks in the

447
00:16:58,620 --> 00:17:00,060
world but we like to think we've gotten

448
00:17:00,060 --> 00:17:02,100
to to the point where some people

449
00:17:02,100 --> 00:17:03,779
actually leave more secure than when

450
00:17:03,779 --> 00:17:06,900
they came right we're able to see

451
00:17:06,900 --> 00:17:08,400
activity like I said clear text

452
00:17:08,400 --> 00:17:10,500
credentials if we see those crypto

453
00:17:10,500 --> 00:17:12,540
mining or any kind of confirmed command

454
00:17:12,540 --> 00:17:14,880
and control traffic to known C2 servers

455
00:17:14,880 --> 00:17:17,160
we'll throw up a captive portal to those

456
00:17:17,160 --> 00:17:18,959
individuals and let them know we've

457
00:17:18,959 --> 00:17:21,359
detected this type of activity on your

458
00:17:21,359 --> 00:17:23,220
device if you want more information

459
00:17:23,220 --> 00:17:26,400
please stop by the knock right so

460
00:17:26,400 --> 00:17:28,439
um sure people probably get into some

461
00:17:28,439 --> 00:17:29,760
trouble there but we like to think that

462
00:17:29,760 --> 00:17:32,760
some people walk away better off

463
00:17:32,760 --> 00:17:35,400
this happened at RSA conference

464
00:17:35,400 --> 00:17:37,760
and the RSA conference sock

465
00:17:37,760 --> 00:17:40,320
we also have a group of threat hunters

466
00:17:40,320 --> 00:17:42,059
and they're looking through traffic now

467
00:17:42,059 --> 00:17:43,620
it's different in the RSA conference

468
00:17:43,620 --> 00:17:45,000
talk because we don't control the

469
00:17:45,000 --> 00:17:46,679
infrastructure

470
00:17:46,679 --> 00:17:50,640
wear a black hat um we we remove every

471
00:17:50,640 --> 00:17:53,520
piece of equipment that is is in the

472
00:17:53,520 --> 00:17:55,799
venue we bypass it all so at Mandalay

473
00:17:55,799 --> 00:17:58,380
Bay in Las Vegas we replace every router

474
00:17:58,380 --> 00:18:00,720
every switch every firewall every access

475
00:18:00,720 --> 00:18:02,760
point all of it the only thing that we

476
00:18:02,760 --> 00:18:04,860
use is the wires in the wall and we do

477
00:18:04,860 --> 00:18:06,720
that for two reasons one I'm a control

478
00:18:06,720 --> 00:18:10,140
freak two it gives us accountability and

479
00:18:10,140 --> 00:18:13,140
also the the ability to do mitigation if

480
00:18:13,140 --> 00:18:15,720
that's necessary right so

481
00:18:15,720 --> 00:18:18,900
at RSA conference we just get a mirror

482
00:18:18,900 --> 00:18:20,940
of the traffic from the venue we don't

483
00:18:20,940 --> 00:18:23,340
have the ability to do mitigation

484
00:18:23,340 --> 00:18:25,700
um so it's more of an educational

485
00:18:25,700 --> 00:18:29,640
exhibit essentially but we do see that

486
00:18:29,640 --> 00:18:31,799
traffic and so a Junior Hunter had come

487
00:18:31,799 --> 00:18:33,419
to me and said hey I think there might

488
00:18:33,419 --> 00:18:34,980
be some kind of like worm it's like

489
00:18:34,980 --> 00:18:36,960
going out across the network it's trying

490
00:18:36,960 --> 00:18:38,640
to hit all these different devices some

491
00:18:38,640 --> 00:18:40,679
of them are are responding some are not

492
00:18:40,679 --> 00:18:42,660
can you take a look at this and I look

493
00:18:42,660 --> 00:18:44,640
and I'm like that's actually not a worm

494
00:18:44,640 --> 00:18:45,780
at all

495
00:18:45,780 --> 00:18:49,080
what you're looking at is a MacBook in

496
00:18:49,080 --> 00:18:51,120
the center the

497
00:18:51,120 --> 00:18:52,980
um the large Circle in the center is a

498
00:18:52,980 --> 00:18:54,780
MacBook that is just shouting onto the

499
00:18:54,780 --> 00:18:57,780
network anybody have any open shares

500
00:18:57,780 --> 00:19:00,000
that I can look at and all of the little

501
00:19:00,000 --> 00:19:01,980
circles on the outside are people who

502
00:19:01,980 --> 00:19:03,780
said yes

503
00:19:03,780 --> 00:19:05,580
here you go

504
00:19:05,580 --> 00:19:06,299
um

505
00:19:06,299 --> 00:19:09,419
so the network at the venue where RSA

506
00:19:09,419 --> 00:19:11,640
conferences is a flat network with no

507
00:19:11,640 --> 00:19:15,480
host isolation right which is just

508
00:19:15,480 --> 00:19:18,720
absolutely insane in today's day and age

509
00:19:18,720 --> 00:19:21,299
but what it means is you don't know

510
00:19:21,299 --> 00:19:23,280
what's happening on networks unless you

511
00:19:23,280 --> 00:19:24,900
take a look right so unless you go and

512
00:19:24,900 --> 00:19:26,220
look you don't know that it's a flat

513
00:19:26,220 --> 00:19:28,320
Network where you can see everybody you

514
00:19:28,320 --> 00:19:31,380
don't know whether there is something

515
00:19:31,380 --> 00:19:33,000
that you should be worried about you

516
00:19:33,000 --> 00:19:34,919
don't know whether your VPN is connected

517
00:19:34,919 --> 00:19:37,260
correctly unless you take the time to go

518
00:19:37,260 --> 00:19:39,480
and look at the traffic and see what is

519
00:19:39,480 --> 00:19:41,100
it that's being sent those applications

520
00:19:41,100 --> 00:19:43,200
you install on your phone what data are

521
00:19:43,200 --> 00:19:45,780
they sending do yourself a favor connect

522
00:19:45,780 --> 00:19:47,820
your phone to your Wi-Fi fire up

523
00:19:47,820 --> 00:19:50,760
Wireshark take a look you know verify

524
00:19:50,760 --> 00:19:53,820
that it's doing what it says it's doing

525
00:19:53,820 --> 00:19:55,919
so what do we see in these stories right

526
00:19:55,919 --> 00:19:58,380
these are foundational things we have a

527
00:19:58,380 --> 00:20:00,299
company that had tunnel vision they said

528
00:20:00,299 --> 00:20:03,120
that that protocol shouldn't exist

529
00:20:03,120 --> 00:20:05,400
so just because you say you don't use it

530
00:20:05,400 --> 00:20:07,080
or you don't allow it doesn't mean it

531
00:20:07,080 --> 00:20:10,020
isn't there go and verify Asset

532
00:20:10,020 --> 00:20:12,600
Management right so a single web server

533
00:20:12,600 --> 00:20:15,120
but exfiltration to China

534
00:20:15,120 --> 00:20:18,419
East-West complacency just

535
00:20:18,419 --> 00:20:21,419
yeah we're um we're worried about the

536
00:20:21,419 --> 00:20:23,280
outside tax once somebody's in they're

537
00:20:23,280 --> 00:20:25,380
scanning the network at a very very loud

538
00:20:25,380 --> 00:20:27,960
very noisy way and nobody is looking and

539
00:20:27,960 --> 00:20:30,299
no one's detecting it because they just

540
00:20:30,299 --> 00:20:32,480
don't care about that kind of traffic

541
00:20:32,480 --> 00:20:34,740
poor credential control clear text

542
00:20:34,740 --> 00:20:36,059
credentials flying around the network

543
00:20:36,059 --> 00:20:38,520
direct to IP communication misconfigured

544
00:20:38,520 --> 00:20:42,380
vpns no host isolation these are not

545
00:20:42,380 --> 00:20:46,440
difficult problems right and yet here we

546
00:20:46,440 --> 00:20:47,580
are

547
00:20:47,580 --> 00:20:50,100
we're here still fighting the same types

548
00:20:50,100 --> 00:20:51,660
of things that we've been fighting since

549
00:20:51,660 --> 00:20:55,500
19 whatever right so again

550
00:20:55,500 --> 00:20:57,840
all of these Technologies exist all of

551
00:20:57,840 --> 00:20:58,919
these things we've been told are

552
00:20:58,919 --> 00:21:01,320
solutions all of these you know

553
00:21:01,320 --> 00:21:03,600
different types of of Blinky boxes and

554
00:21:03,600 --> 00:21:05,220
pieces of software that were supposed to

555
00:21:05,220 --> 00:21:06,840
solve all these things for us and some

556
00:21:06,840 --> 00:21:08,340
of the largest financial organizations

557
00:21:08,340 --> 00:21:10,200
in the world some of the largest

558
00:21:10,200 --> 00:21:13,200
manufacturers developers

559
00:21:13,200 --> 00:21:13,980
um

560
00:21:13,980 --> 00:21:16,020
folks who should know better people who

561
00:21:16,020 --> 00:21:17,700
are at security conferences and we're

562
00:21:17,700 --> 00:21:21,419
still not getting it right so how do we

563
00:21:21,419 --> 00:21:24,600
do that what how do we fix the

564
00:21:24,600 --> 00:21:27,720
foundational things what are the areas

565
00:21:27,720 --> 00:21:29,820
that we should be focused on and how do

566
00:21:29,820 --> 00:21:32,940
we do that well when we're when we're

567
00:21:32,940 --> 00:21:35,700
combating this threat I should pause for

568
00:21:35,700 --> 00:21:38,580
a moment and say there's a lot of text

569
00:21:38,580 --> 00:21:41,340
on these slides and that's on purpose I

570
00:21:41,340 --> 00:21:43,260
know that you're not supposed to put a

571
00:21:43,260 --> 00:21:45,120
lot of text in a PowerPoint and you're

572
00:21:45,120 --> 00:21:47,039
supposed to just have cute little bullet

573
00:21:47,039 --> 00:21:48,900
points or little pictures that make

574
00:21:48,900 --> 00:21:51,480
remind you what you want to say but I

575
00:21:51,480 --> 00:21:53,039
like to build my decks as a reference

576
00:21:53,039 --> 00:21:54,960
that you can use later so you don't have

577
00:21:54,960 --> 00:21:57,240
to watch this on YouTube later and be

578
00:21:57,240 --> 00:21:59,340
like where's the part where he said that

579
00:21:59,340 --> 00:22:02,700
I should do this or do that so

580
00:22:02,700 --> 00:22:04,500
I'm not going to read those things word

581
00:22:04,500 --> 00:22:06,360
for word but I want you to be able to

582
00:22:06,360 --> 00:22:09,240
have that for later so

583
00:22:09,240 --> 00:22:11,159
what we're talking about here is how are

584
00:22:11,159 --> 00:22:13,860
we setting up like an actual defense a

585
00:22:13,860 --> 00:22:16,260
sock that matters and I have a unique

586
00:22:16,260 --> 00:22:17,940
perspective on that being that I have

587
00:22:17,940 --> 00:22:21,240
worked in black cats knock running it

588
00:22:21,240 --> 00:22:23,820
for the last 20 years we've had to adapt

589
00:22:23,820 --> 00:22:26,820
we've had to adjust as things continue

590
00:22:26,820 --> 00:22:30,720
to evolve not only on the network but

591
00:22:30,720 --> 00:22:32,700
the type and scale of the attacks the

592
00:22:32,700 --> 00:22:34,860
scale of the show as well

593
00:22:34,860 --> 00:22:38,400
so what are the things that we use what

594
00:22:38,400 --> 00:22:40,980
have we decided works when I go into

595
00:22:40,980 --> 00:22:43,980
these companies whether it is you know

596
00:22:43,980 --> 00:22:46,200
giant energy companies

597
00:22:46,200 --> 00:22:48,600
um or or governments around the world

598
00:22:48,600 --> 00:22:50,460
what are the things that they're doing

599
00:22:50,460 --> 00:22:53,460
that work and where are they falling

600
00:22:53,460 --> 00:22:56,580
down so that's what we're going to talk

601
00:22:56,580 --> 00:23:00,000
about again so here just in like a a

602
00:23:00,000 --> 00:23:03,240
before type of summary we'll talk about

603
00:23:03,240 --> 00:23:06,000
what what matters as far as logs packets

604
00:23:06,000 --> 00:23:09,240
endpoint right giving people a full a

605
00:23:09,240 --> 00:23:11,220
full scope a full picture of the attack

606
00:23:11,220 --> 00:23:12,900
making sure you have the data sources

607
00:23:12,900 --> 00:23:15,960
that are necessary to actually defend

608
00:23:15,960 --> 00:23:18,240
the network see what's there know where

609
00:23:18,240 --> 00:23:20,360
your gaps are those types of things

610
00:23:20,360 --> 00:23:23,039
using Automation in a way that actually

611
00:23:23,039 --> 00:23:26,340
matters versus just looking at it as a

612
00:23:26,340 --> 00:23:28,140
solution that will

613
00:23:28,140 --> 00:23:30,600
will fix all of your problems it won't

614
00:23:30,600 --> 00:23:32,280
do that but it can do things like give

615
00:23:32,280 --> 00:23:35,700
you more actionable data using threat

616
00:23:35,700 --> 00:23:37,500
Hunters alongside your analysts or

617
00:23:37,500 --> 00:23:40,080
giving your analysts time to hunt and um

618
00:23:40,080 --> 00:23:43,200
and this last Point here on this slide

619
00:23:43,200 --> 00:23:46,860
is leveraging outside help it's okay to

620
00:23:46,860 --> 00:23:49,440
ask for help right it's okay to

621
00:23:49,440 --> 00:23:52,980
understand we have a skills Gap here we

622
00:23:52,980 --> 00:23:55,559
don't have the ability to do this

623
00:23:55,559 --> 00:23:58,500
particular type of activity or we just

624
00:23:58,500 --> 00:24:00,780
don't have the um

625
00:24:00,780 --> 00:24:02,940
the folks who can do that at this point

626
00:24:02,940 --> 00:24:04,980
and until we get there we need some

627
00:24:04,980 --> 00:24:07,559
outside help or honestly you just don't

628
00:24:07,559 --> 00:24:09,419
care about that thing and you want to

629
00:24:09,419 --> 00:24:12,539
Outsource it to somebody else so work

630
00:24:12,539 --> 00:24:14,580
with managed service providers work with

631
00:24:14,580 --> 00:24:16,320
somebody who can

632
00:24:16,320 --> 00:24:18,600
offload some of the pain for you so that

633
00:24:18,600 --> 00:24:19,980
you can get to the things that actually

634
00:24:19,980 --> 00:24:21,860
matter

635
00:24:21,860 --> 00:24:23,820
so I said we're going to get

636
00:24:23,820 --> 00:24:25,500
foundational it doesn't get more

637
00:24:25,500 --> 00:24:28,700
foundational than logs

638
00:24:28,760 --> 00:24:31,740
logs have been the gold standard for

639
00:24:31,740 --> 00:24:33,360
decades and will be the gold standard

640
00:24:33,360 --> 00:24:35,580
for decades to come

641
00:24:35,580 --> 00:24:36,299
um

642
00:24:36,299 --> 00:24:37,679
so

643
00:24:37,679 --> 00:24:39,960
what you should be doing is logging

644
00:24:39,960 --> 00:24:42,600
everything that's possible Right If it

645
00:24:42,600 --> 00:24:45,720
creates a log log it like storage is

646
00:24:45,720 --> 00:24:47,760
cheap I'm not saying you have to ingest

647
00:24:47,760 --> 00:24:50,640
it into your your sim and that you like

648
00:24:50,640 --> 00:24:52,140
it could be potentially expensive for

649
00:24:52,140 --> 00:24:54,840
you whatever and you don't even like

650
00:24:54,840 --> 00:24:57,120
have to look at it I I implore you

651
00:24:57,120 --> 00:25:00,480
please look at your logs but just having

652
00:25:00,480 --> 00:25:02,100
them means that if at a certain point

653
00:25:02,100 --> 00:25:04,500
you get into a situation where you

654
00:25:04,500 --> 00:25:06,299
experience a breach

655
00:25:06,299 --> 00:25:08,880
and a team comes in from the outside to

656
00:25:08,880 --> 00:25:11,700
do ir and you can say I've got the last

657
00:25:11,700 --> 00:25:15,720
year or six months or 14 days of Vlogs

658
00:25:15,720 --> 00:25:17,159
like they'll take whatever they can have

659
00:25:17,159 --> 00:25:19,320
but if they come and you say yeah we

660
00:25:19,320 --> 00:25:21,900
have partial coverage it's not really

661
00:25:21,900 --> 00:25:25,500
it's not great some of the logs are kept

662
00:25:25,500 --> 00:25:27,080
in this system some of them are here

663
00:25:27,080 --> 00:25:30,600
invest in it in a Sim that matters pull

664
00:25:30,600 --> 00:25:33,179
all of that data into one place but make

665
00:25:33,179 --> 00:25:34,679
sure that it's something that your

666
00:25:34,679 --> 00:25:37,260
analyst that your team wants to use if

667
00:25:37,260 --> 00:25:39,240
it's slow if it's difficult to use you

668
00:25:39,240 --> 00:25:40,679
might as well not own it all you're

669
00:25:40,679 --> 00:25:44,159
doing is throwing money out the window

670
00:25:44,159 --> 00:25:46,500
make sure that it's a solution that

671
00:25:46,500 --> 00:25:47,600
works

672
00:25:47,600 --> 00:25:50,940
as many log sources as possible pull

673
00:25:50,940 --> 00:25:53,400
them all into one place and start

674
00:25:53,400 --> 00:25:55,500
digging through them

675
00:25:55,500 --> 00:25:57,360
when it comes to network on the network

676
00:25:57,360 --> 00:26:00,419
side of House Network analytics ndrs are

677
00:26:00,419 --> 00:26:02,580
great right Network analytics is great

678
00:26:02,580 --> 00:26:05,340
but also full packet capture

679
00:26:05,340 --> 00:26:07,679
if you're not doing full packet capture

680
00:26:07,679 --> 00:26:09,559
in your environment today

681
00:26:09,559 --> 00:26:13,380
I recommend that you strongly consider

682
00:26:13,380 --> 00:26:14,400
it

683
00:26:14,400 --> 00:26:16,500
had I gone into that Financial

684
00:26:16,500 --> 00:26:19,500
organization who was experiencing uh you

685
00:26:19,500 --> 00:26:20,940
know a document leaving their

686
00:26:20,940 --> 00:26:22,200
environment or file leaving their

687
00:26:22,200 --> 00:26:24,659
environment every night I would have

688
00:26:24,659 --> 00:26:27,000
known that there was a file leaving had

689
00:26:27,000 --> 00:26:28,799
I just had you know logs or maybe even

690
00:26:28,799 --> 00:26:30,360
Network analytics I know that there was

691
00:26:30,360 --> 00:26:32,220
a file leaving every night I'd know what

692
00:26:32,220 --> 00:26:33,720
its name was and I'd know where it was

693
00:26:33,720 --> 00:26:35,820
going and that would seem bad

694
00:26:35,820 --> 00:26:37,860
but having full packet capture allowed

695
00:26:37,860 --> 00:26:40,440
me to rebuild that file and see what was

696
00:26:40,440 --> 00:26:42,720
taken it gives you a different way of

697
00:26:42,720 --> 00:26:44,580
looking at exfiltration if you are

698
00:26:44,580 --> 00:26:46,500
unfortunate enough to experience a

699
00:26:46,500 --> 00:26:47,460
breach

700
00:26:47,460 --> 00:26:50,400
but you have the ability to say we know

701
00:26:50,400 --> 00:26:52,080
that this is what left

702
00:26:52,080 --> 00:26:54,960
that is huge it's huge legally it's huge

703
00:26:54,960 --> 00:26:57,179
about and how you disclose that breach

704
00:26:57,179 --> 00:27:00,059
so having the ability to say this is

705
00:27:00,059 --> 00:27:03,179
what was taken is I cannot stress the

706
00:27:03,179 --> 00:27:05,039
importance of that enough

707
00:27:05,039 --> 00:27:06,840
um

708
00:27:06,840 --> 00:27:09,240
it's essentially video surveillance for

709
00:27:09,240 --> 00:27:11,279
your network we would never build a

710
00:27:11,279 --> 00:27:13,200
building like this today and then say

711
00:27:13,200 --> 00:27:15,360
you know what it's expensive and it's a

712
00:27:15,360 --> 00:27:18,720
lot of storage for all of that video so

713
00:27:18,720 --> 00:27:20,820
I'm we're just not gonna do it like

714
00:27:20,820 --> 00:27:23,220
we'll find a different way we'll take a

715
00:27:23,220 --> 00:27:25,559
picture every five minutes or something

716
00:27:25,559 --> 00:27:27,480
like that we wouldn't do that

717
00:27:27,480 --> 00:27:29,940
so why do we do that with our Networks

718
00:27:29,940 --> 00:27:32,400
put full packet capture in place find a

719
00:27:32,400 --> 00:27:34,080
way

720
00:27:34,080 --> 00:27:37,020
um to start small if you have to and as

721
00:27:37,020 --> 00:27:39,299
you show the value of having that

722
00:27:39,299 --> 00:27:42,379
continue to grow

723
00:27:42,840 --> 00:27:45,000
on the end point right endpoints where

724
00:27:45,000 --> 00:27:47,039
the rubber meets the road as a threat

725
00:27:47,039 --> 00:27:49,559
Hunter if I had only one thing that I

726
00:27:49,559 --> 00:27:51,299
could actually hunt and if you said one

727
00:27:51,299 --> 00:27:53,580
data source what would it be it would be

728
00:27:53,580 --> 00:27:55,380
endpoint right I want to know what's

729
00:27:55,380 --> 00:27:57,539
taking place on the actual devices the

730
00:27:57,539 --> 00:27:58,860
hosts and the servers and everything

731
00:27:58,860 --> 00:28:01,980
that's in that environment right so

732
00:28:01,980 --> 00:28:06,059
going in and understanding what is what

733
00:28:06,059 --> 00:28:08,820
is going on on these devices why do we

734
00:28:08,820 --> 00:28:10,140
have

735
00:28:10,140 --> 00:28:12,120
um why do we have these applications on

736
00:28:12,120 --> 00:28:15,000
here how often are they used what other

737
00:28:15,000 --> 00:28:17,520
things do they spawn what processes are

738
00:28:17,520 --> 00:28:19,559
running what are our scheduled tasks

739
00:28:19,559 --> 00:28:20,880
what's going on understanding your

740
00:28:20,880 --> 00:28:23,360
endpoints is huge

741
00:28:23,360 --> 00:28:25,740
being able to

742
00:28:25,740 --> 00:28:28,440
also take the things that that cross

743
00:28:28,440 --> 00:28:30,240
those endpoints and throw them again

744
00:28:30,240 --> 00:28:32,760
into a Sandbox malware analysis of some

745
00:28:32,760 --> 00:28:34,620
kind you see something Shady on an

746
00:28:34,620 --> 00:28:36,600
endpoint you want to be able to take it

747
00:28:36,600 --> 00:28:39,360
throw it into a Sandbox somewhere and

748
00:28:39,360 --> 00:28:41,340
see what it does and hopefully interact

749
00:28:41,340 --> 00:28:45,080
with it if possible Right

750
00:28:45,120 --> 00:28:47,480
how threat intelligence

751
00:28:47,480 --> 00:28:52,039
so threat intelligence is incredibly

752
00:28:52,039 --> 00:28:55,020
incredibly important to your security

753
00:28:55,020 --> 00:28:56,940
program but

754
00:28:56,940 --> 00:28:59,520
valuable threat intelligence I will add

755
00:28:59,520 --> 00:29:02,100
a caveat to that and say valuable threat

756
00:29:02,100 --> 00:29:03,600
intelligence

757
00:29:03,600 --> 00:29:04,679
um

758
00:29:04,679 --> 00:29:08,760
getting 36 different feeds of IP

759
00:29:08,760 --> 00:29:10,980
addresses host names and file hashes

760
00:29:10,980 --> 00:29:12,900
every day and calling that threat

761
00:29:12,900 --> 00:29:15,360
intelligence is not

762
00:29:15,360 --> 00:29:18,419
um is not the way to do it uh I believe

763
00:29:18,419 --> 00:29:24,120
it was Joe slowik who said that iocs are

764
00:29:24,120 --> 00:29:27,240
um essentially security junk food they

765
00:29:27,240 --> 00:29:28,980
make you feel good they make you feel

766
00:29:28,980 --> 00:29:30,360
like you're doing something right

767
00:29:30,360 --> 00:29:33,000
they're easy to ingest but in the end

768
00:29:33,000 --> 00:29:35,340
you're left kind of feeling gross all

769
00:29:35,340 --> 00:29:37,320
right it doesn't really do a lot for you

770
00:29:37,320 --> 00:29:41,279
and ultimately you're like um I don't

771
00:29:41,279 --> 00:29:42,240
um

772
00:29:42,240 --> 00:29:43,860
I don't know if we actually did anything

773
00:29:43,860 --> 00:29:46,140
there and that's the truth what we

774
00:29:46,140 --> 00:29:47,940
should be focused on are tactics

775
00:29:47,940 --> 00:29:50,760
techniques and procedures right ttps but

776
00:29:50,760 --> 00:29:53,700
not just ttps for every group that's out

777
00:29:53,700 --> 00:29:55,500
there what we want to do when it comes

778
00:29:55,500 --> 00:29:57,059
to threat intelligence is take a look at

779
00:29:57,059 --> 00:29:59,760
our organization and say who is most

780
00:29:59,760 --> 00:30:02,539
likely to attack me who's coming for us

781
00:30:02,539 --> 00:30:06,360
if I'm in energy or or I know I'm an oil

782
00:30:06,360 --> 00:30:07,919
and gas or I'm in financial I'm in

783
00:30:07,919 --> 00:30:10,320
healthcare well if I'm in health care

784
00:30:10,320 --> 00:30:12,059
what are the most likely threat actor

785
00:30:12,059 --> 00:30:14,460
groups to Target Healthcare organization

786
00:30:14,460 --> 00:30:17,640
okay well I've now narrowed down the you

787
00:30:17,640 --> 00:30:19,500
know hundreds of different threat actor

788
00:30:19,500 --> 00:30:23,640
groups out there to six that Target

789
00:30:23,640 --> 00:30:26,460
you know Healthcare how do they conduct

790
00:30:26,460 --> 00:30:28,740
their campaigns all right well they come

791
00:30:28,740 --> 00:30:30,600
at you this way they use these

792
00:30:30,600 --> 00:30:33,179
techniques they use these tools here are

793
00:30:33,179 --> 00:30:35,220
the artifacts that are left by those

794
00:30:35,220 --> 00:30:38,520
tools right understanding who is most

795
00:30:38,520 --> 00:30:42,000
likely to come for you means that you

796
00:30:42,000 --> 00:30:44,640
actually are going to have an impact on

797
00:30:44,640 --> 00:30:46,399
the amount of risk to your organization

798
00:30:46,399 --> 00:30:51,380
and you know drive that risk down so

799
00:30:51,380 --> 00:30:54,480
we wouldn't necessarily be like oh okay

800
00:30:54,480 --> 00:30:56,460
I um

801
00:30:56,460 --> 00:30:58,620
I'm going to make sure that if let's say

802
00:30:58,620 --> 00:31:00,659
we're here we're in Tokyo right we

803
00:31:00,659 --> 00:31:02,640
probably wouldn't spend a ton of money

804
00:31:02,640 --> 00:31:05,520
on making sure that we were protected

805
00:31:05,520 --> 00:31:07,620
against a tornado let's say but if we

806
00:31:07,620 --> 00:31:10,620
spent no money on preparing for an

807
00:31:10,620 --> 00:31:13,320
earthquake that would that would be odd

808
00:31:13,320 --> 00:31:15,600
right so we don't want to spend a bunch

809
00:31:15,600 --> 00:31:18,000
of money preparing for an attack for

810
00:31:18,000 --> 00:31:19,799
some attack group that just gets a lot

811
00:31:19,799 --> 00:31:22,380
of press when the likelihood that

812
00:31:22,380 --> 00:31:24,360
they're going to attack us is relatively

813
00:31:24,360 --> 00:31:27,000
small where we want to spend that money

814
00:31:27,000 --> 00:31:29,039
and spend those resources and that

815
00:31:29,039 --> 00:31:31,559
precious time is on the individuals who

816
00:31:31,559 --> 00:31:36,020
we know are likely to come for us

817
00:31:36,299 --> 00:31:36,899
um

818
00:31:36,899 --> 00:31:40,320
it's also this is another area where

819
00:31:40,320 --> 00:31:42,720
there's a significant amount of data out

820
00:31:42,720 --> 00:31:44,159
there there's plenty of Open Source

821
00:31:44,159 --> 00:31:46,020
feeds you can go out and subscribe to

822
00:31:46,020 --> 00:31:48,299
things but that's a lot and they overlap

823
00:31:48,299 --> 00:31:50,100
each other quite a bit right if there

824
00:31:50,100 --> 00:31:51,480
was a Venn diagram of threat

825
00:31:51,480 --> 00:31:53,520
intelligence the overlapping would be

826
00:31:53,520 --> 00:31:55,559
absolutely insane

827
00:31:55,559 --> 00:31:58,799
um if you don't have the ability to

828
00:31:58,799 --> 00:32:00,419
curate that threat intelligence yourself

829
00:32:00,419 --> 00:32:02,760
it's fine to go out and find an

830
00:32:02,760 --> 00:32:04,140
organization who does that for you

831
00:32:04,140 --> 00:32:05,640
actually it might be better because then

832
00:32:05,640 --> 00:32:08,880
you can just say to them tell me who the

833
00:32:08,880 --> 00:32:11,039
most likely groups to Target me are

834
00:32:11,039 --> 00:32:14,700
tell me what the ttps are and then I can

835
00:32:14,700 --> 00:32:16,200
go and look and see if I even have

836
00:32:16,200 --> 00:32:18,899
visibility into those types of

837
00:32:18,899 --> 00:32:21,360
techniques right and that again is where

838
00:32:21,360 --> 00:32:25,260
you're going to make an actual impact so

839
00:32:25,260 --> 00:32:25,799
um

840
00:32:25,799 --> 00:32:27,659
if you don't have the ability to do that

841
00:32:27,659 --> 00:32:30,419
seek outside help it's okay to ask for

842
00:32:30,419 --> 00:32:33,600
help if you think about how much a

843
00:32:33,600 --> 00:32:35,279
budget of a budget you would need to

844
00:32:35,279 --> 00:32:38,580
create a new team to do something that

845
00:32:38,580 --> 00:32:39,659
you could

846
00:32:39,659 --> 00:32:42,000
pay another organization to do for you

847
00:32:42,000 --> 00:32:44,279
again making sure they do it well of

848
00:32:44,279 --> 00:32:45,779
course you want to get something quality

849
00:32:45,779 --> 00:32:47,340
out of it but

850
00:32:47,340 --> 00:32:49,919
make sure that

851
00:32:49,919 --> 00:32:52,740
um that they're spending that uh you

852
00:32:52,740 --> 00:32:54,960
know uh time those resources that you

853
00:32:54,960 --> 00:32:56,279
are spending that time and resources on

854
00:32:56,279 --> 00:32:58,020
something that matters

855
00:32:58,020 --> 00:32:59,940
hunting so

856
00:32:59,940 --> 00:33:01,440
um as a hunter this is pretty selfish

857
00:33:01,440 --> 00:33:04,080
but this is going out and proactively

858
00:33:04,080 --> 00:33:06,059
searching for attackers in your

859
00:33:06,059 --> 00:33:08,279
environment being able to

860
00:33:08,279 --> 00:33:10,200
answer the question is there somebody

861
00:33:10,200 --> 00:33:12,539
already here in my opinion again

862
00:33:12,539 --> 00:33:14,159
selfishly

863
00:33:14,159 --> 00:33:16,380
is the most important question that you

864
00:33:16,380 --> 00:33:17,880
can answer about your environment

865
00:33:17,880 --> 00:33:19,860
because if you go out and start to

866
00:33:19,860 --> 00:33:21,779
deploy new technologies an attacker is

867
00:33:21,779 --> 00:33:23,159
already in your environment they're

868
00:33:23,159 --> 00:33:25,260
watching you deploy it

869
00:33:25,260 --> 00:33:27,299
they're likely going to figure out a way

870
00:33:27,299 --> 00:33:29,760
to get around it or persist if you

871
00:33:29,760 --> 00:33:31,919
decide to do a pen test or an adversary

872
00:33:31,919 --> 00:33:34,080
simulation a red team exercise and there

873
00:33:34,080 --> 00:33:36,600
is an attacker already there you're

874
00:33:36,600 --> 00:33:38,880
giving them a class on how to move

875
00:33:38,880 --> 00:33:40,860
throughout your network they're just

876
00:33:40,860 --> 00:33:42,419
going to watch the other pen testers

877
00:33:42,419 --> 00:33:44,340
come in and maybe they're siled into a

878
00:33:44,340 --> 00:33:45,659
certain part of the network they've been

879
00:33:45,659 --> 00:33:48,000
stuck in for months but now you hired a

880
00:33:48,000 --> 00:33:49,260
different team to come in and they're

881
00:33:49,260 --> 00:33:50,880
running around doing their their

882
00:33:50,880 --> 00:33:53,880
assessment and the attacker went I did

883
00:33:53,880 --> 00:33:56,100
not think of that and follows them

884
00:33:56,100 --> 00:33:57,360
through the door

885
00:33:57,360 --> 00:33:59,279
so being able to know that an attacker

886
00:33:59,279 --> 00:34:01,260
is not in your environment is a critical

887
00:34:01,260 --> 00:34:03,240
question to be able to answer and your

888
00:34:03,240 --> 00:34:06,179
threat Hunters help you answer that

889
00:34:06,179 --> 00:34:07,919
but it's not just about finding

890
00:34:07,919 --> 00:34:10,260
attackers threat Hunters also help you

891
00:34:10,260 --> 00:34:13,139
find what I call enablers of compromise

892
00:34:13,139 --> 00:34:15,119
an enabler of compromise is something

893
00:34:15,119 --> 00:34:16,739
that gives the attacker a leg up when

894
00:34:16,739 --> 00:34:18,780
they get in or gives them an opportunity

895
00:34:18,780 --> 00:34:22,520
to get into that environment so if we're

896
00:34:22,520 --> 00:34:24,839
if we're focused on only finding

897
00:34:24,839 --> 00:34:26,520
attacker with threat Hunters we're

898
00:34:26,520 --> 00:34:28,260
probably going to be disappointed we

899
00:34:28,260 --> 00:34:31,199
also don't want to find them every day

900
00:34:31,199 --> 00:34:34,020
all the time that would be terrible

901
00:34:34,020 --> 00:34:37,199
um but but the reality is being able to

902
00:34:37,199 --> 00:34:39,780
identify as you're out there hunting hey

903
00:34:39,780 --> 00:34:41,639
this portion of the network isn't

904
00:34:41,639 --> 00:34:43,619
segmented off from here or why does this

905
00:34:43,619 --> 00:34:45,960
application exist on our golden images

906
00:34:45,960 --> 00:34:48,899
and answer those questions allows you to

907
00:34:48,899 --> 00:34:51,060
reduce your overall attack surface and

908
00:34:51,060 --> 00:34:52,980
reduce risk and Hunters are going to

909
00:34:52,980 --> 00:34:55,760
help you do that

910
00:34:55,980 --> 00:34:59,099
automation right so again we can't

911
00:34:59,099 --> 00:35:01,740
despite what we're told on Expo floors

912
00:35:01,740 --> 00:35:04,500
at black hat and RSA conference and and

913
00:35:04,500 --> 00:35:07,080
security conferences everywhere you

914
00:35:07,080 --> 00:35:08,339
can't just automate the pain away

915
00:35:08,339 --> 00:35:10,680
nothing's going to automate it all for

916
00:35:10,680 --> 00:35:13,140
you but it can give you more actionable

917
00:35:13,140 --> 00:35:15,480
data you can build playbooks that allow

918
00:35:15,480 --> 00:35:17,940
you to get data out of it that makes it

919
00:35:17,940 --> 00:35:19,440
so that the limited time that you have

920
00:35:19,440 --> 00:35:21,000
or the resources that you have in your

921
00:35:21,000 --> 00:35:24,540
sock allow you to focus on actionable

922
00:35:24,540 --> 00:35:26,820
things things that matter rather than

923
00:35:26,820 --> 00:35:29,700
noise so automation can help you find

924
00:35:29,700 --> 00:35:33,060
the signal in the noise or it can do

925
00:35:33,060 --> 00:35:34,740
things like how we use it at black hat

926
00:35:34,740 --> 00:35:36,839
where the scale of the show got to a

927
00:35:36,839 --> 00:35:39,480
point where it was like oh this is a

928
00:35:39,480 --> 00:35:41,880
really a lot of data to ingest it's hard

929
00:35:41,880 --> 00:35:43,680
for us to hunt through all this we've

930
00:35:43,680 --> 00:35:45,000
got to collect data from all these

931
00:35:45,000 --> 00:35:47,280
different areas now if we haven't

932
00:35:47,280 --> 00:35:49,500
incident we just say pull the data from

933
00:35:49,500 --> 00:35:51,780
every device in here around that time

934
00:35:51,780 --> 00:35:54,720
frame and around these devices and it

935
00:35:54,720 --> 00:35:56,460
all gets pulled into one nice

936
00:35:56,460 --> 00:35:58,980
package for us so automation is great

937
00:35:58,980 --> 00:36:00,480
for things like that but like I said

938
00:36:00,480 --> 00:36:01,859
it's not going to be something where you

939
00:36:01,859 --> 00:36:03,240
just click a button and suddenly

940
00:36:03,240 --> 00:36:05,339
security is there

941
00:36:05,339 --> 00:36:08,520
Now red teaming so red teams are great

942
00:36:08,520 --> 00:36:10,200
um but there's a difference between

943
00:36:10,200 --> 00:36:12,240
different types of of red team or

944
00:36:12,240 --> 00:36:14,400
offensive activity there's vulnerability

945
00:36:14,400 --> 00:36:16,200
scanning which is just software you're

946
00:36:16,200 --> 00:36:18,240
clicking a button and off it goes and it

947
00:36:18,240 --> 00:36:19,680
tells you oh here are some things that

948
00:36:19,680 --> 00:36:22,020
you should care about this is not a pen

949
00:36:22,020 --> 00:36:25,320
test this is clicking a button

950
00:36:25,320 --> 00:36:27,599
pen testing is performed by an actual

951
00:36:27,599 --> 00:36:29,400
human not a piece of software right they

952
00:36:29,400 --> 00:36:31,200
might use software but this is a skilled

953
00:36:31,200 --> 00:36:33,000
professional with varied skill set but

954
00:36:33,000 --> 00:36:34,619
it's a numbers game they're going out

955
00:36:34,619 --> 00:36:35,880
and trying to hit as many things as

956
00:36:35,880 --> 00:36:37,440
possible get as deep as they can in as

957
00:36:37,440 --> 00:36:39,000
many different ways

958
00:36:39,000 --> 00:36:40,500
and then they'll give you something at

959
00:36:40,500 --> 00:36:41,820
the end and say Here's all the stuff

960
00:36:41,820 --> 00:36:43,320
that we found

961
00:36:43,320 --> 00:36:45,839
and then there's red teaming and red

962
00:36:45,839 --> 00:36:46,980
teaming

963
00:36:46,980 --> 00:36:49,680
is where you take both tools and people

964
00:36:49,680 --> 00:36:51,480
and you put them together and what you

965
00:36:51,480 --> 00:36:54,119
want a red team to do is emulate how an

966
00:36:54,119 --> 00:36:55,380
attacker will move through that

967
00:36:55,380 --> 00:36:57,839
environment give them a goal tell them

968
00:36:57,839 --> 00:36:59,700
where they should focus and see if they

969
00:36:59,700 --> 00:37:01,079
can get there

970
00:37:01,079 --> 00:37:03,480
and if they can what do you do about

971
00:37:03,480 --> 00:37:05,579
that right okay well they were able to

972
00:37:05,579 --> 00:37:08,640
get past our defenses here and here they

973
00:37:08,640 --> 00:37:10,619
were emulating this attack group who we

974
00:37:10,619 --> 00:37:13,500
know is likely to attack us

975
00:37:13,500 --> 00:37:15,060
let's see let's get those things

976
00:37:15,060 --> 00:37:16,980
mitigated let's get those things fixed a

977
00:37:16,980 --> 00:37:19,980
Red Team should have a using the threat

978
00:37:19,980 --> 00:37:21,240
intelligence that's so important to your

979
00:37:21,240 --> 00:37:23,520
organization they should have a goal to

980
00:37:23,520 --> 00:37:26,640
be working in a way that says they are

981
00:37:26,640 --> 00:37:28,500
emulating this group

982
00:37:28,500 --> 00:37:30,000
they are emulating these types of

983
00:37:30,000 --> 00:37:32,220
attacks let's see if they're successful

984
00:37:32,220 --> 00:37:34,560
doing that just saying we're hiring a

985
00:37:34,560 --> 00:37:35,880
red team they're going to come in and do

986
00:37:35,880 --> 00:37:36,900
some stuff

987
00:37:36,900 --> 00:37:39,420
there's no value there give them Focus

988
00:37:39,420 --> 00:37:42,240
give them something to do and then they

989
00:37:42,240 --> 00:37:44,760
will deliver results that will turn your

990
00:37:44,760 --> 00:37:47,540
hair white probably

991
00:37:47,579 --> 00:37:50,220
all right so what do we do now

992
00:37:50,220 --> 00:37:53,760
well you need to build a program that

993
00:37:53,760 --> 00:37:56,940
builds on itself so where where do we go

994
00:37:56,940 --> 00:37:58,380
what do we do

995
00:37:58,380 --> 00:37:59,880
um and this is the question that I get

996
00:37:59,880 --> 00:38:02,160
asked the most where should I start I've

997
00:38:02,160 --> 00:38:03,960
said it several times start with threat

998
00:38:03,960 --> 00:38:05,940
intelligence right know who your most

999
00:38:05,940 --> 00:38:08,160
likely attackers are and know how

1000
00:38:08,160 --> 00:38:10,859
they're going to attack you and once you

1001
00:38:10,859 --> 00:38:12,780
know how they're going to attack you go

1002
00:38:12,780 --> 00:38:14,520
and see if you have the data sources

1003
00:38:14,520 --> 00:38:16,680
available to see those types of attacks

1004
00:38:16,680 --> 00:38:19,800
do you have the network visibility do

1005
00:38:19,800 --> 00:38:21,060
you have the visibility into the

1006
00:38:21,060 --> 00:38:23,280
endpoints that you need and if you don't

1007
00:38:23,280 --> 00:38:26,220
have those things be sure to communicate

1008
00:38:26,220 --> 00:38:28,079
that up to leadership up to the board

1009
00:38:28,079 --> 00:38:30,359
hey we need budget we need additional

1010
00:38:30,359 --> 00:38:32,700
head count we're blind to these things

1011
00:38:32,700 --> 00:38:35,220
here and these are things that the most

1012
00:38:35,220 --> 00:38:37,020
likely groups to attack us are going to

1013
00:38:37,020 --> 00:38:39,780
do and we can't see it being able to

1014
00:38:39,780 --> 00:38:42,720
communicate that will likely get you the

1015
00:38:42,720 --> 00:38:44,460
budget that you're looking for versus

1016
00:38:44,460 --> 00:38:47,460
just always saying I need more budget

1017
00:38:47,460 --> 00:38:49,380
right

1018
00:38:49,380 --> 00:38:52,320
so look for that um where you're blind

1019
00:38:52,320 --> 00:38:54,180
so that you know like you can you can

1020
00:38:54,180 --> 00:38:55,980
Shore up your defenses threat hunting

1021
00:38:55,980 --> 00:38:58,260
again so once you've done that once you

1022
00:38:58,260 --> 00:39:00,480
have all those data sources in place is

1023
00:39:00,480 --> 00:39:02,579
there somebody already here give Hunters

1024
00:39:02,579 --> 00:39:04,740
access to that those data sources and

1025
00:39:04,740 --> 00:39:06,720
tell them to get to work

1026
00:39:06,720 --> 00:39:09,060
if they if they're looking and they

1027
00:39:09,060 --> 00:39:11,220
don't find somebody well what are the

1028
00:39:11,220 --> 00:39:12,839
other things in there that might enable

1029
00:39:12,839 --> 00:39:15,359
an attacker to stay if they do get in or

1030
00:39:15,359 --> 00:39:18,859
give them a leg up if they do

1031
00:39:20,460 --> 00:39:23,280
again Hunters are going to find things

1032
00:39:23,280 --> 00:39:25,680
they always find things I have never

1033
00:39:25,680 --> 00:39:27,000
been on an engagement where I haven't

1034
00:39:27,000 --> 00:39:31,680
found something I always find something

1035
00:39:31,680 --> 00:39:34,020
so if you're

1036
00:39:34,020 --> 00:39:35,880
um if you're given those things from

1037
00:39:35,880 --> 00:39:38,460
your threat Hunters say all right this

1038
00:39:38,460 --> 00:39:39,240
is

1039
00:39:39,240 --> 00:39:41,579
um this is what we need to fix now let's

1040
00:39:41,579 --> 00:39:43,200
go in there and take care of that reduce

1041
00:39:43,200 --> 00:39:45,839
that attack surface again and move move

1042
00:39:45,839 --> 00:39:48,240
things forward make it a little bit more

1043
00:39:48,240 --> 00:39:49,920
difficult when the attackers eventually

1044
00:39:49,920 --> 00:39:51,780
do come go in and do those things

1045
00:39:51,780 --> 00:39:53,520
proactively have them thinking like

1046
00:39:53,520 --> 00:39:55,920
attackers going out finding those things

1047
00:39:55,920 --> 00:39:58,020
and then mitigate them make sure that

1048
00:39:58,020 --> 00:39:59,760
you actually solve them knowing it's a

1049
00:39:59,760 --> 00:40:01,640
problem and doing nothing about it

1050
00:40:01,640 --> 00:40:03,660
doesn't help

1051
00:40:03,660 --> 00:40:05,520
and then

1052
00:40:05,520 --> 00:40:06,780
please

1053
00:40:06,780 --> 00:40:08,940
um all right my recommendation is don't

1054
00:40:08,940 --> 00:40:11,099
move straight to Red teaming right don't

1055
00:40:11,099 --> 00:40:14,119
move straight to adversary simulation

1056
00:40:14,119 --> 00:40:17,400
discuss with whoever your red team that

1057
00:40:17,400 --> 00:40:18,780
you're talking to whether they're

1058
00:40:18,780 --> 00:40:21,240
internal or external discuss doing a

1059
00:40:21,240 --> 00:40:22,740
purple team exercise with them having

1060
00:40:22,740 --> 00:40:24,660
them actually sit down the red team

1061
00:40:24,660 --> 00:40:26,280
sitting down next to the blue team and

1062
00:40:26,280 --> 00:40:28,380
saying today we're going to emulate the

1063
00:40:28,380 --> 00:40:30,240
attacks of this group

1064
00:40:30,240 --> 00:40:32,579
we're going to do that now

1065
00:40:32,579 --> 00:40:36,480
click did you see that did we get an

1066
00:40:36,480 --> 00:40:37,440
alert

1067
00:40:37,440 --> 00:40:40,140
do we have visibility into what I just

1068
00:40:40,140 --> 00:40:42,359
did it allows them to collaborate and

1069
00:40:42,359 --> 00:40:44,160
work as a team rather than coming in

1070
00:40:44,160 --> 00:40:46,440
adversarially and feeling like they're

1071
00:40:46,440 --> 00:40:48,540
just getting beat up do not beat up your

1072
00:40:48,540 --> 00:40:50,820
Defenders they get beat up enough

1073
00:40:50,820 --> 00:40:52,920
have them work side by side with the red

1074
00:40:52,920 --> 00:40:55,260
team discover what things again that

1075
00:40:55,260 --> 00:40:56,579
they didn't see when they were working

1076
00:40:56,579 --> 00:40:58,680
through that purple team exercise and

1077
00:40:58,680 --> 00:41:00,960
then come back later and do a pen test

1078
00:41:00,960 --> 00:41:03,480
or a red team exercise or adversary

1079
00:41:03,480 --> 00:41:06,119
simulation and see what happens but

1080
00:41:06,119 --> 00:41:07,920
build that relationship first through

1081
00:41:07,920 --> 00:41:09,839
purple teaming

1082
00:41:09,839 --> 00:41:11,520
and then

1083
00:41:11,520 --> 00:41:14,720
rinse and repeat keep getting more Intel

1084
00:41:14,720 --> 00:41:16,920
make sure your data sources are there

1085
00:41:16,920 --> 00:41:20,040
hunt through it mitigate It Go in have

1086
00:41:20,040 --> 00:41:22,320
somebody emulate it and see if you can

1087
00:41:22,320 --> 00:41:24,480
see it and just do it over and over and

1088
00:41:24,480 --> 00:41:27,660
over again security is repetitive but

1089
00:41:27,660 --> 00:41:29,460
it's necessary

1090
00:41:29,460 --> 00:41:31,680
and I know I said that Blinky boxes

1091
00:41:31,680 --> 00:41:33,540
weren't going to fix everything but here

1092
00:41:33,540 --> 00:41:36,540
are the technologies that matter these

1093
00:41:36,540 --> 00:41:39,660
are the ones that enable your folks to

1094
00:41:39,660 --> 00:41:42,119
make a difference right these are the

1095
00:41:42,119 --> 00:41:44,700
ones that are in our experience at

1096
00:41:44,700 --> 00:41:46,920
places like black hat or say conference

1097
00:41:46,920 --> 00:41:49,200
or again in organizations that I've been

1098
00:41:49,200 --> 00:41:50,940
in all over the world in World

1099
00:41:50,940 --> 00:41:52,859
governments and those things these are

1100
00:41:52,859 --> 00:41:55,020
the ones that actually matter oh that's

1101
00:41:55,020 --> 00:41:58,260
like boom you're cut off so

1102
00:41:58,260 --> 00:42:00,119
um well you can't see it now but there's

1103
00:42:00,119 --> 00:42:02,220
a slide that says thank you

1104
00:42:02,220 --> 00:42:05,959
um and that's the end thank you

1105
00:42:06,079 --> 00:42:07,200
thank you

1106
00:42:07,200 --> 00:42:09,750
[Applause]

