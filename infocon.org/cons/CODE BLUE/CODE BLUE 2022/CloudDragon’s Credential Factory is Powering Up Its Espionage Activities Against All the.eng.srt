1
00:00:00,780 --> 00:00:03,000
hey quick quick announcement from the

2
00:00:03,000 --> 00:00:05,279
operations team uh there will be a

3
00:00:05,279 --> 00:00:07,200
television crew walking around for this

4
00:00:07,200 --> 00:00:09,599
talk so if you do not want like the back

5
00:00:09,599 --> 00:00:11,400
of your head filmed

6
00:00:11,400 --> 00:00:14,580
um go towards the back thank you

7
00:00:14,580 --> 00:00:17,420
oh okay

8
00:00:18,600 --> 00:00:21,960
uh hello everyone thank you for joining

9
00:00:21,960 --> 00:00:26,160
this talk uh we are tnt5 today our topic

10
00:00:26,160 --> 00:00:29,699
is cloud dragon's credential Factory is

11
00:00:29,699 --> 00:00:32,460
powering up its Espionage activities

12
00:00:32,460 --> 00:00:36,980
again all the policy makers

13
00:00:38,100 --> 00:00:42,840
and shindeer also known as Stark LL now

14
00:00:42,840 --> 00:00:46,559
I work at tnt5 as a senior 3 intention

15
00:00:46,559 --> 00:00:49,800
researcher I have been invited by

16
00:00:49,800 --> 00:00:52,079
International conferences such as

17
00:00:52,079 --> 00:00:57,360
blackhead hrtb hikong and Kabul also I

18
00:00:57,360 --> 00:01:01,940
am the core member of UCCU hacker

19
00:01:04,159 --> 00:01:06,960
I work at Team divide as a straight

20
00:01:06,960 --> 00:01:09,840
intelligence researcher my research

21
00:01:09,840 --> 00:01:14,760
focused on Cyber Street in Apec region

22
00:01:14,760 --> 00:01:16,320
okay

23
00:01:16,320 --> 00:01:18,320
so

24
00:01:18,320 --> 00:01:22,259
this is our agenda first we will briefly

25
00:01:22,259 --> 00:01:25,860
introduce the basic information of cloud

26
00:01:25,860 --> 00:01:27,299
dragon

27
00:01:27,299 --> 00:01:29,880
second we will introduce the key point

28
00:01:29,880 --> 00:01:33,360
of this talk credential Factory

29
00:01:33,360 --> 00:01:37,560
sir we will share a real world case of

30
00:01:37,560 --> 00:01:41,400
from our instant response investigation

31
00:01:41,400 --> 00:01:44,880
finally in conclusion we will give some

32
00:01:44,880 --> 00:01:48,740
key takeaway and medication

33
00:01:48,780 --> 00:01:50,820
thank you

34
00:01:50,820 --> 00:01:54,180
I'm going to make an introduction of APG

35
00:01:54,180 --> 00:01:57,920
group claw dragon

36
00:01:58,500 --> 00:02:02,100
before starting we should know apt group

37
00:02:02,100 --> 00:02:03,979
kinsuki first

38
00:02:03,979 --> 00:02:07,979
kinsuki is very active North Korean apt

39
00:02:07,979 --> 00:02:11,700
and Cloud Dragon is a subgroup of

40
00:02:11,700 --> 00:02:15,060
kinsuki defined by identify

41
00:02:15,060 --> 00:02:18,620
we found that cloud dragon uh

42
00:02:18,620 --> 00:02:21,959
launched not only uh several Espionage

43
00:02:21,959 --> 00:02:24,540
campaigns but also cyber crime

44
00:02:24,540 --> 00:02:25,860
activities

45
00:02:25,860 --> 00:02:29,640
they engage in a lot of phishing attacks

46
00:02:29,640 --> 00:02:32,099
they developed a lot of our unique

47
00:02:32,099 --> 00:02:35,459
malware such as Jam Park baby shark

48
00:02:35,459 --> 00:02:40,520
piano store and kgh grade

49
00:02:42,480 --> 00:02:45,780
in the past we see that cloud dragon

50
00:02:45,780 --> 00:02:48,780
mainly charges South Korea

51
00:02:48,780 --> 00:02:50,519
in recent years

52
00:02:50,519 --> 00:02:54,660
we have observed that cloud dragon scope

53
00:02:54,660 --> 00:02:59,280
is expanding including a text and at the

54
00:02:59,280 --> 00:03:02,459
United Nation the United States and

55
00:03:02,459 --> 00:03:03,840
Japan

56
00:03:03,840 --> 00:03:07,739
the targeted industry include government

57
00:03:07,739 --> 00:03:13,019
education Research Institute NGO media

58
00:03:13,019 --> 00:03:16,940
and technology companies

59
00:03:19,140 --> 00:03:22,980
next is today's key Point credential

60
00:03:22,980 --> 00:03:24,720
Factory

61
00:03:24,720 --> 00:03:27,080
foreign

62
00:03:28,519 --> 00:03:31,440
workflow of cloud dragon's credential

63
00:03:31,440 --> 00:03:32,640
Factory

64
00:03:32,640 --> 00:03:36,060
we believe this credential Factory is

65
00:03:36,060 --> 00:03:39,180
cloud dragon's special attack cycle

66
00:03:39,180 --> 00:03:41,640
cloud dragon can use this credential

67
00:03:41,640 --> 00:03:45,239
Factory to keep feeling its massive

68
00:03:45,239 --> 00:03:46,860
attacks

69
00:03:46,860 --> 00:03:49,799
we build a specialized cyber kill chain

70
00:03:49,799 --> 00:03:54,060
to illustrate credential Factory

71
00:03:54,060 --> 00:03:56,700
you can see that there are three small

72
00:03:56,700 --> 00:03:59,580
cycle from top to bottom

73
00:03:59,580 --> 00:04:03,720
daily cycle campaign cycle and policy

74
00:04:03,720 --> 00:04:05,220
story cycle

75
00:04:05,220 --> 00:04:09,120
next we will introduce each cycle one by

76
00:04:09,120 --> 00:04:11,360
one

77
00:04:13,260 --> 00:04:17,160
first is the daily cycle the core of the

78
00:04:17,160 --> 00:04:19,798
daily cycle is efficient

79
00:04:19,798 --> 00:04:22,680
actor get a lot of mail credential

80
00:04:22,680 --> 00:04:24,720
through fission

81
00:04:24,720 --> 00:04:27,479
lost content from compromise account

82
00:04:27,479 --> 00:04:30,540
will be the next Target

83
00:04:30,540 --> 00:04:34,220
what will be the next Vision Target

84
00:04:34,220 --> 00:04:37,680
can use compromise account and private

85
00:04:37,680 --> 00:04:41,220
document to do social engineering and

86
00:04:41,220 --> 00:04:44,300
deploy malware

87
00:04:45,780 --> 00:04:49,620
so next we are going to introduce three

88
00:04:49,620 --> 00:04:51,060
kinds of vision

89
00:04:51,060 --> 00:04:57,680
basic Vision proxy mirror and vision bot

90
00:05:00,479 --> 00:05:03,979
in the past we observed a lot of vision

91
00:05:03,979 --> 00:05:07,979
Targets on the two Korean portal number

92
00:05:07,979 --> 00:05:10,440
and down

93
00:05:10,440 --> 00:05:13,940
and now there are more fishing websites

94
00:05:13,940 --> 00:05:17,180
decide for to be used on International

95
00:05:17,180 --> 00:05:23,419
targets like Google Yahoo and L

96
00:05:25,020 --> 00:05:28,020
it's a basic Vision we continually

97
00:05:28,020 --> 00:05:31,800
observe Advanced fishing techniques

98
00:05:31,800 --> 00:05:34,620
here we have an advanced fishing

99
00:05:34,620 --> 00:05:37,680
technique called process mirror

100
00:05:37,680 --> 00:05:41,039
process mirror is a fishing skill used

101
00:05:41,039 --> 00:05:42,660
by cloud dragon

102
00:05:42,660 --> 00:05:46,080
the Pagan our fish inside will fetch the

103
00:05:46,080 --> 00:05:50,220
patch from the real website immediately

104
00:05:50,220 --> 00:05:52,940
this technique can make fish inside

105
00:05:52,940 --> 00:05:56,759
after automatically and make lost Vision

106
00:05:56,759 --> 00:06:00,060
side since legitimate

107
00:06:00,060 --> 00:06:03,300
also the fish inside can take the

108
00:06:03,300 --> 00:06:06,720
account and password entered by the user

109
00:06:06,720 --> 00:06:11,660
to the real website for verification

110
00:06:14,220 --> 00:06:17,699
and other Advanced fishing techniques is

111
00:06:17,699 --> 00:06:19,500
a fishing boat

112
00:06:19,500 --> 00:06:23,520
the fish inside passes users input to

113
00:06:23,520 --> 00:06:27,600
bot wire address the bot wrong the

114
00:06:27,600 --> 00:06:30,539
linear to control a browser

115
00:06:30,539 --> 00:06:33,360
all users operations will be

116
00:06:33,360 --> 00:06:36,419
synchronized to the bot browser in real

117
00:06:36,419 --> 00:06:38,719
time

118
00:06:40,860 --> 00:06:44,880
let's see how the fishing part works

119
00:06:44,880 --> 00:06:48,300
when the victim improve their username

120
00:06:48,300 --> 00:06:51,479
and password to the vision patch

121
00:06:51,479 --> 00:06:55,500
the path will open a browser and try to

122
00:06:55,500 --> 00:06:57,120
login

123
00:06:57,120 --> 00:07:00,360
if it's successfully logging the real

124
00:07:00,360 --> 00:07:04,080
website in let browser will show the OTP

125
00:07:04,080 --> 00:07:05,520
patch

126
00:07:05,520 --> 00:07:09,120
after part conference the victim will be

127
00:07:09,120 --> 00:07:13,020
redirected to affect OTP patch

128
00:07:13,020 --> 00:07:16,680
the victim will input the OTP code

129
00:07:16,680 --> 00:07:19,319
received from their cell phone

130
00:07:19,319 --> 00:07:22,139
the part will enter the OTP code into

131
00:07:22,139 --> 00:07:26,160
the browser and login successfully

132
00:07:26,160 --> 00:07:29,639
finally the part with the red the user

133
00:07:29,639 --> 00:07:32,099
page to the real website

134
00:07:32,099 --> 00:07:36,120
so if the return is already logged in in

135
00:07:36,120 --> 00:07:39,360
the real website the victim cannot

136
00:07:39,360 --> 00:07:43,440
identify the login step was done by

137
00:07:43,440 --> 00:07:45,780
fishing bot

138
00:07:45,780 --> 00:07:48,900
the fission bar can easily access the

139
00:07:48,900 --> 00:07:52,199
account protected by two Factor

140
00:07:52,199 --> 00:07:54,300
Authentication

141
00:07:54,300 --> 00:07:57,720
more about Vision you can see our credit

142
00:07:57,720 --> 00:08:01,139
are our Cloud dragons research operation

143
00:08:01,139 --> 00:08:06,560
fisherman published at hittb last year

144
00:08:06,960 --> 00:08:10,500
okay uh let's tackle to introduce the

145
00:08:10,500 --> 00:08:12,919
next part

146
00:08:14,940 --> 00:08:18,900
okay then this is the campaign cycle

147
00:08:18,900 --> 00:08:21,060
when cloud dragon starts a targeted

148
00:08:21,060 --> 00:08:24,900
attack the first step is reconnaissance

149
00:08:24,900 --> 00:08:28,460
the target they target employees use

150
00:08:28,460 --> 00:08:32,700
malicious document and deploys mower

151
00:08:32,700 --> 00:08:35,640
or they can develop a customized

152
00:08:35,640 --> 00:08:39,179
efficient site to get some credentials

153
00:08:39,179 --> 00:08:42,539
if targeting employees doesn't work

154
00:08:42,539 --> 00:08:45,779
they will Target external service such

155
00:08:45,779 --> 00:08:47,339
as mail

156
00:08:47,339 --> 00:08:52,019
VPN mdn and website

157
00:08:52,019 --> 00:08:55,100
if no relevant vulnerability are found

158
00:08:55,100 --> 00:08:59,459
the actor will transfer the target to

159
00:08:59,459 --> 00:09:02,940
the vendors of those service

160
00:09:02,940 --> 00:09:06,779
if those vendors are compromised actors

161
00:09:06,779 --> 00:09:09,660
may get the credential oh sorry actors

162
00:09:09,660 --> 00:09:11,820
may get the maintenance document

163
00:09:11,820 --> 00:09:14,580
maintenance documents and review the

164
00:09:14,580 --> 00:09:16,320
source code

165
00:09:16,320 --> 00:09:21,420
finally with those credentials or the

166
00:09:21,420 --> 00:09:24,420
rotate variant ability to invention the

167
00:09:24,420 --> 00:09:27,199
original Target

168
00:09:29,580 --> 00:09:32,700
so we will show what kind of the code

169
00:09:32,700 --> 00:09:36,480
they used and introduce two new mowers

170
00:09:36,480 --> 00:09:40,220
F Mill and dust

171
00:09:43,080 --> 00:09:46,260
as we mentioned in campaign cycle cloud

172
00:09:46,260 --> 00:09:49,800
dragon delivers uh mowers with efficient

173
00:09:49,800 --> 00:09:51,480
documents

174
00:09:51,480 --> 00:09:54,720
the actors will discuss themselves as

175
00:09:54,720 --> 00:09:57,180
journalists and send the fiction

176
00:09:57,180 --> 00:09:59,760
document to the victims

177
00:09:59,760 --> 00:10:02,640
the content of these documents might be

178
00:10:02,640 --> 00:10:04,800
professional questions interview

179
00:10:04,800 --> 00:10:09,560
manuscripts and study reports

180
00:10:12,240 --> 00:10:15,779
here I'm going to introduce baby shark

181
00:10:15,779 --> 00:10:18,899
one of the top movies used by

182
00:10:18,899 --> 00:10:22,200
cloudragon's fishing documents

183
00:10:22,200 --> 00:10:24,779
the fission documents are usually filled

184
00:10:24,779 --> 00:10:26,399
with Scarborough tax

185
00:10:26,399 --> 00:10:30,240
and ask victim to enable the macro

186
00:10:30,240 --> 00:10:32,760
let me grow first downloads the cleared

187
00:10:32,760 --> 00:10:34,200
koi

188
00:10:34,200 --> 00:10:37,620
then the Explorers the process running

189
00:10:37,620 --> 00:10:42,440
process and detects antivirus software

190
00:10:42,720 --> 00:10:44,760
it detects antivirus software for

191
00:10:44,760 --> 00:10:48,000
downloading corresponding components and

192
00:10:48,000 --> 00:10:50,579
these components use different file type

193
00:10:50,579 --> 00:10:53,640
and different persistence to bypass the

194
00:10:53,640 --> 00:10:55,740
detection

195
00:10:55,740 --> 00:10:59,700
finally they fetch another VB script or

196
00:10:59,700 --> 00:11:02,700
pet file from the C2 server

197
00:11:02,700 --> 00:11:06,060
and usually they are used to to install

198
00:11:06,060 --> 00:11:09,140
another mower

199
00:11:12,240 --> 00:11:15,600
in baby shark cloud dragon use a unique

200
00:11:15,600 --> 00:11:18,120
transfer position Cipher

201
00:11:18,120 --> 00:11:21,380
this encryption might use on strings

202
00:11:21,380 --> 00:11:26,100
payloads or communication

203
00:11:26,100 --> 00:11:29,339
the value of the key D might change in

204
00:11:29,339 --> 00:11:32,899
different in different case

205
00:11:36,420 --> 00:11:39,360
in this picture we could see how the

206
00:11:39,360 --> 00:11:43,260
macro detect antivirus software

207
00:11:43,260 --> 00:11:45,420
the maker checks the running process

208
00:11:45,420 --> 00:11:46,500
then

209
00:11:46,500 --> 00:11:48,839
to find out which antivirus software is

210
00:11:48,839 --> 00:11:50,279
running

211
00:11:50,279 --> 00:11:52,980
then it downloads corresponding

212
00:11:52,980 --> 00:11:55,640
components

213
00:11:59,040 --> 00:12:02,959
this year we found a new mower F Mill

214
00:12:02,959 --> 00:12:05,760
deployed by baby shark

215
00:12:05,760 --> 00:12:10,019
F Mill is a malicious browser extensions

216
00:12:10,019 --> 00:12:12,899
since the web mails since the Webmail

217
00:12:12,899 --> 00:12:15,300
becomes more and more popular

218
00:12:15,300 --> 00:12:17,700
clothes we can develop develop this

219
00:12:17,700 --> 00:12:20,700
small world for male labs

220
00:12:20,700 --> 00:12:25,519
usually F mail can still mail attachment

221
00:12:25,519 --> 00:12:29,480
or browsing history

222
00:12:32,519 --> 00:12:34,140
at the beginning

223
00:12:34,140 --> 00:12:36,899
actor gathers some information for f

224
00:12:36,899 --> 00:12:39,240
mail installation

225
00:12:39,240 --> 00:12:42,600
they deploy a VB script to handle this

226
00:12:42,600 --> 00:12:45,060
information gathering

227
00:12:45,060 --> 00:12:47,579
it downloads Powershell script like get

228
00:12:47,579 --> 00:12:52,019
Chrome the PS1 to collect browser info

229
00:12:52,019 --> 00:12:54,860
these browser info will be written into

230
00:12:54,860 --> 00:12:56,820
several.net file

231
00:12:56,820 --> 00:13:01,279
and finally upload to C2 server

232
00:13:04,440 --> 00:13:07,200
the process stores extension meta in

233
00:13:07,200 --> 00:13:09,779
preference and generates a signature in

234
00:13:09,779 --> 00:13:11,579
Secure preference

235
00:13:11,579 --> 00:13:15,660
so in order to install the extension in

236
00:13:15,660 --> 00:13:18,180
order to install the extension actors

237
00:13:18,180 --> 00:13:21,720
must modify the preference and secure

238
00:13:21,720 --> 00:13:23,700
preference

239
00:13:23,700 --> 00:13:25,380
in this picture

240
00:13:25,380 --> 00:13:28,260
get chrome.ps1 will upload these two

241
00:13:28,260 --> 00:13:32,959
preference files to C2 server

242
00:13:37,500 --> 00:13:40,019
after the malicious preference files are

243
00:13:40,019 --> 00:13:41,220
ready

244
00:13:41,220 --> 00:13:45,600
actor deploys F mail with baby shark

245
00:13:45,600 --> 00:13:48,660
the installer transfer change preference

246
00:13:48,660 --> 00:13:51,660
files and launch a Powershell as a

247
00:13:51,660 --> 00:13:53,339
watchdog

248
00:13:53,339 --> 00:13:57,240
this Watchdog will open that tool page

249
00:13:57,240 --> 00:14:00,660
therefore fmail can capture the network

250
00:14:00,660 --> 00:14:05,240
activity through Dev tools

251
00:14:05,579 --> 00:14:08,540
the two JavaScript will fetch additional

252
00:14:08,540 --> 00:14:12,560
payloads from C2 server

253
00:14:15,720 --> 00:14:19,860
this is the Manifest of fmail

254
00:14:19,860 --> 00:14:22,500
we can see that it sets up a background

255
00:14:22,500 --> 00:14:25,740
script and devtool page

256
00:14:25,740 --> 00:14:28,920
we call this more F mail because of its

257
00:14:28,920 --> 00:14:30,839
name field

258
00:14:30,839 --> 00:14:33,839
we also observe let extension use effect

259
00:14:33,839 --> 00:14:38,000
icon of BNS

260
00:14:41,699 --> 00:14:46,139
okay this is the cd2js which is fetched

261
00:14:46,139 --> 00:14:48,240
by Dev Js

262
00:14:48,240 --> 00:14:51,360
if users active page match the white

263
00:14:51,360 --> 00:14:55,320
list data will be sent to cd1js

264
00:14:55,320 --> 00:14:57,120
in this picture

265
00:14:57,120 --> 00:15:03,139
the wireless is Gmail and Outlook

266
00:15:07,320 --> 00:15:11,820
the cd1js is faced by bgjs it will

267
00:15:11,820 --> 00:15:15,480
extract the male meta contents and

268
00:15:15,480 --> 00:15:18,899
attachment from the raw data

269
00:15:18,899 --> 00:15:20,639
in this picture

270
00:15:20,639 --> 00:15:24,260
the function get mail underscore Google

271
00:15:24,260 --> 00:15:27,240
use a hardcore index to find

272
00:15:27,240 --> 00:15:30,240
corresponding elements

273
00:15:30,240 --> 00:15:32,360
thank you

274
00:15:36,240 --> 00:15:39,180
next we will introduce

275
00:15:39,180 --> 00:15:43,079
dust the new Vector of call dragon

276
00:15:43,079 --> 00:15:46,680
we discovered it on this February

277
00:15:46,680 --> 00:15:49,199
dust is a show called best modular

278
00:15:49,199 --> 00:15:52,620
backdoor this is the first time we

279
00:15:52,620 --> 00:15:54,600
observed that cloud dragon use Circle

280
00:15:54,600 --> 00:15:57,600
base vector

281
00:15:57,600 --> 00:16:00,839
it's named from its pdb strings

282
00:16:00,839 --> 00:16:03,060
and you suppose different communication

283
00:16:03,060 --> 00:16:05,459
modes sorry it suppose different

284
00:16:05,459 --> 00:16:09,120
communication method by changing models

285
00:16:09,120 --> 00:16:12,000
there are two versions of dust

286
00:16:12,000 --> 00:16:16,399
DNS and http

287
00:16:19,560 --> 00:16:23,399
dust will be start by by our registry

288
00:16:23,399 --> 00:16:27,779
server 32. this is a user method of call

289
00:16:27,779 --> 00:16:31,560
trigger just like jump back

290
00:16:31,560 --> 00:16:34,500
after startup it will launch a show

291
00:16:34,500 --> 00:16:36,720
called loader

292
00:16:36,720 --> 00:16:39,360
the circle loader will decrypt the

293
00:16:39,360 --> 00:16:43,199
embedded payload with one byte xor and

294
00:16:43,199 --> 00:16:46,079
run dust in memory

295
00:16:46,079 --> 00:16:49,079
thus will initialize lots of runtime

296
00:16:49,079 --> 00:16:52,860
variables and stores in structure

297
00:16:52,860 --> 00:16:56,040
with this structure thus can dynamically

298
00:16:56,040 --> 00:17:00,540
dynamically call Windows API easily

299
00:17:00,540 --> 00:17:03,120
in the DNS version

300
00:17:03,120 --> 00:17:05,819
thus communicates with C2

301
00:17:05,819 --> 00:17:09,240
by our DNS tunnel

302
00:17:09,240 --> 00:17:12,660
the different type of communication will

303
00:17:12,660 --> 00:17:16,040
take different prefix

304
00:17:16,079 --> 00:17:19,140
all the data will be encrypted and

305
00:17:19,140 --> 00:17:23,400
encoded with back 16.

306
00:17:23,400 --> 00:17:25,799
here is an example

307
00:17:25,799 --> 00:17:30,860
the data will be put on the sub domain

308
00:17:35,039 --> 00:17:39,600
okay the data encryption is as follow

309
00:17:39,600 --> 00:17:43,860
it is a simple one byte operation

310
00:17:43,860 --> 00:17:48,740
addition with a key and less result

311
00:17:53,760 --> 00:17:56,700
the HTTP version only differs in

312
00:17:56,700 --> 00:17:58,580
Communications

313
00:17:58,580 --> 00:18:03,299
dust will put the PHP code in the HTTP

314
00:18:03,299 --> 00:18:07,740
header and then csrf token

315
00:18:07,740 --> 00:18:11,220
the encryption is sent is the same as

316
00:18:11,220 --> 00:18:12,539
DNS version

317
00:18:12,539 --> 00:18:15,360
but the encoded method is changed to

318
00:18:15,360 --> 00:18:18,620
back 64.

319
00:18:22,440 --> 00:18:25,679
the C2 server of dust will execute the

320
00:18:25,679 --> 00:18:29,520
PHP code in the HTTP header

321
00:18:29,520 --> 00:18:32,580
this is a very weird design

322
00:18:32,580 --> 00:18:35,940
from the PHP code we can summarize the

323
00:18:35,940 --> 00:18:40,760
logic of dust C2 server communication

324
00:18:45,660 --> 00:18:48,780
there is a spatial mechanism in the

325
00:18:48,780 --> 00:18:52,980
communication of task HTTP version

326
00:18:52,980 --> 00:18:56,660
more will check the existence of a

327
00:18:56,660 --> 00:19:01,740
specific session file on the C2 server

328
00:19:01,740 --> 00:19:04,440
data will be transferred if only the

329
00:19:04,440 --> 00:19:07,500
section file exists

330
00:19:07,500 --> 00:19:10,380
and the data will delete itself after

331
00:19:10,380 --> 00:19:12,840
few minutes

332
00:19:12,840 --> 00:19:15,960
we summarize that this is a dial and

333
00:19:15,960 --> 00:19:18,179
connect mechanism

334
00:19:18,179 --> 00:19:21,480
the controller and more must connect to

335
00:19:21,480 --> 00:19:24,120
C2 at the same time

336
00:19:24,120 --> 00:19:27,419
if one of them disconnects the

337
00:19:27,419 --> 00:19:30,780
communication will be terminated

338
00:19:30,780 --> 00:19:33,440
this ensures that

339
00:19:33,440 --> 00:19:36,299
commands and victim data will not be

340
00:19:36,299 --> 00:19:39,860
left on C2 server

341
00:19:43,679 --> 00:19:46,200
the pector function of thus is as

342
00:19:46,200 --> 00:19:47,880
follows

343
00:19:47,880 --> 00:19:50,820
include common factor such as show

344
00:19:50,820 --> 00:19:53,940
command and file operations

345
00:19:53,940 --> 00:19:56,520
it also supports communication with

346
00:19:56,520 --> 00:20:00,200
plugins through pipe

347
00:20:04,020 --> 00:20:07,500
in addition to that Spector we also

348
00:20:07,500 --> 00:20:09,720
found the actor combined cobal strike

349
00:20:09,720 --> 00:20:12,660
with related components

350
00:20:12,660 --> 00:20:14,039
besides

351
00:20:14,039 --> 00:20:17,640
we observed the actual abuse Public

352
00:20:17,640 --> 00:20:21,120
Service like using GitHub as a download

353
00:20:21,120 --> 00:20:24,600
site and hiding the real IP with and

354
00:20:24,600 --> 00:20:27,020
growth

355
00:20:31,500 --> 00:20:35,700
and final one is the pulse is polycycle

356
00:20:35,700 --> 00:20:39,000
it shows the operation after actor gets

357
00:20:39,000 --> 00:20:41,760
the excess of Intranet

358
00:20:41,760 --> 00:20:44,220
we have seen cloud dragon in this cycle

359
00:20:44,220 --> 00:20:47,460
get more credential and data through

360
00:20:47,460 --> 00:20:49,740
lateral movement

361
00:20:49,740 --> 00:20:51,539
in this stage

362
00:20:51,539 --> 00:20:54,299
call Dragon prefers to use hacking tool

363
00:20:54,299 --> 00:20:58,760
rather than their spatial vector

364
00:21:02,039 --> 00:21:05,220
Karl Dragon used lots of hacking tool in

365
00:21:05,220 --> 00:21:08,039
policies policycle we divide them into

366
00:21:08,039 --> 00:21:09,780
three parts

367
00:21:09,780 --> 00:21:12,960
they are Public public hacking tools

368
00:21:12,960 --> 00:21:15,900
Cloud Reagan develop tools and remote

369
00:21:15,900 --> 00:21:19,700
desktop tool any desk

370
00:21:22,740 --> 00:21:25,679
we found public hacking tools they are

371
00:21:25,679 --> 00:21:28,679
tgcd port forwarding tool

372
00:21:28,679 --> 00:21:32,940
and grog a reverse plastic tool that

373
00:21:32,940 --> 00:21:35,640
allows actors as a machine in private

374
00:21:35,640 --> 00:21:36,900
name work

375
00:21:36,900 --> 00:21:40,500
and the last one is SM reek it's a

376
00:21:40,500 --> 00:21:44,360
crippled uh it's a crypto Miner

377
00:21:47,100 --> 00:21:49,440
we also found that they view their

378
00:21:49,440 --> 00:21:52,320
hacking tools with script language

379
00:21:52,320 --> 00:21:56,220
they are screenshot tool keylogger and

380
00:21:56,220 --> 00:21:59,360
credential stealer

381
00:22:02,940 --> 00:22:05,640
the Powershell loader will decode the

382
00:22:05,640 --> 00:22:08,400
payload and run the snapshot tool in

383
00:22:08,400 --> 00:22:09,659
memory

384
00:22:09,659 --> 00:22:12,720
this tool will text screenshot and

385
00:22:12,720 --> 00:22:16,100
upload to C2 server

386
00:22:19,260 --> 00:22:21,539
same as screenshot tool

387
00:22:21,539 --> 00:22:24,720
the Powershell loader decodes and SQ key

388
00:22:24,720 --> 00:22:26,039
logger

389
00:22:26,039 --> 00:22:28,860
this key logo just write key log files

390
00:22:28,860 --> 00:22:32,580
and the key log files will will be

391
00:22:32,580 --> 00:22:36,740
uploaded by another VB script

392
00:22:40,260 --> 00:22:42,659
the credential stealer is triggered as

393
00:22:42,659 --> 00:22:44,280
user logging

394
00:22:44,280 --> 00:22:48,480
if it pops out a dialog box to ask the

395
00:22:48,480 --> 00:22:53,360
victims to enter their credentials

396
00:22:56,400 --> 00:22:59,340
now I'm going to introduce the Third

397
00:22:59,340 --> 00:23:02,340
Kind of hacking tool remote desktop tool

398
00:23:02,340 --> 00:23:04,740
any desk

399
00:23:04,740 --> 00:23:08,100
people can use any task to access the

400
00:23:08,100 --> 00:23:11,780
computer without public IP

401
00:23:15,059 --> 00:23:17,880
we observe that cloud so you can abuse

402
00:23:17,880 --> 00:23:20,640
any task as a backdoor

403
00:23:20,640 --> 00:23:23,220
that develops some related components

404
00:23:23,220 --> 00:23:28,200
like installer loader hiding tool

405
00:23:28,200 --> 00:23:33,620
Watchdog and modify config files

406
00:23:36,120 --> 00:23:38,940
here I'm going to introduce the tool

407
00:23:38,940 --> 00:23:42,659
used by cloud dragon to hide any desk

408
00:23:42,659 --> 00:23:46,200
there are two components I observed and

409
00:23:46,200 --> 00:23:47,880
I update

410
00:23:47,880 --> 00:23:51,360
I absurd will reduce the I update as a

411
00:23:51,360 --> 00:23:54,240
service for persistence

412
00:23:54,240 --> 00:23:58,320
and I update hides any task uh height

413
00:23:58,320 --> 00:24:02,760
any desk Windows system tray and notify

414
00:24:02,760 --> 00:24:05,120
icon

415
00:24:08,640 --> 00:24:12,059
as the picture shows I update codes show

416
00:24:12,059 --> 00:24:16,280
window function to hide the window

417
00:24:20,039 --> 00:24:22,919
and this picture shows how a high system

418
00:24:22,919 --> 00:24:27,260
tray and notify icon

419
00:24:32,220 --> 00:24:35,340
the Watchdog deploys customized config

420
00:24:35,340 --> 00:24:38,159
files and launch any disk

421
00:24:38,159 --> 00:24:41,880
besides it can fetch additional commands

422
00:24:41,880 --> 00:24:44,900
from C2 server

423
00:24:49,740 --> 00:24:52,559
the Watchdog will put two config files

424
00:24:52,559 --> 00:24:55,620
system config and service config to

425
00:24:55,620 --> 00:25:00,799
program data backslash and desk

426
00:25:00,960 --> 00:25:04,500
we can see the ID is in system config

427
00:25:04,500 --> 00:25:07,679
and the paste work password H and the

428
00:25:07,679 --> 00:25:11,659
salt are in service config

429
00:25:16,140 --> 00:25:19,980
okay we summarized that actor might set

430
00:25:19,980 --> 00:25:23,760
up the ID and password in their any desk

431
00:25:23,760 --> 00:25:25,860
and therefore

432
00:25:25,860 --> 00:25:29,059
the existing ID and customize password

433
00:25:29,059 --> 00:25:32,820
will be written into the config

434
00:25:32,820 --> 00:25:36,440
then they deploy these config files to

435
00:25:36,440 --> 00:25:38,820
victim's computer

436
00:25:38,820 --> 00:25:40,500
finally

437
00:25:40,500 --> 00:25:43,200
actor might use any text to access

438
00:25:43,200 --> 00:25:47,900
victim's computer with known credential

439
00:25:51,059 --> 00:25:52,020
okay

440
00:25:52,020 --> 00:25:55,879
I will show the case study

441
00:25:55,980 --> 00:25:59,220
okay let's take a look at the real world

442
00:25:59,220 --> 00:26:01,860
cast how cloud dragon leverage

443
00:26:01,860 --> 00:26:05,159
credential Factory to launch a series of

444
00:26:05,159 --> 00:26:07,580
attack

445
00:26:08,159 --> 00:26:12,179
this is cloud dragons campaign through a

446
00:26:12,179 --> 00:26:15,539
VPN zero day this campaign happened last

447
00:26:15,539 --> 00:26:18,960
year we divided this campaign into three

448
00:26:18,960 --> 00:26:22,260
parts fishing operation zero de

449
00:26:22,260 --> 00:26:26,820
vulnerability and malware main zip rate

450
00:26:26,820 --> 00:26:30,360
and sorry that in the following talk we

451
00:26:30,360 --> 00:26:33,059
will skip some technical detail because

452
00:26:33,059 --> 00:26:36,299
the cve number is under the application

453
00:26:36,299 --> 00:26:38,840
process

454
00:26:39,000 --> 00:26:43,620
last year Korea Atomic Energy Research

455
00:26:43,620 --> 00:26:46,080
Institute k-a-e-r-i

456
00:26:46,080 --> 00:26:49,200
published an announcement that has been

457
00:26:49,200 --> 00:26:52,320
hacked and found some suspicious VPN

458
00:26:52,320 --> 00:26:53,640
access

459
00:26:53,640 --> 00:26:57,000
and I believe that attacker is from

460
00:26:57,000 --> 00:26:59,100
North Korea

461
00:26:59,100 --> 00:27:02,279
at the moment we got a case of instant

462
00:27:02,279 --> 00:27:05,700
response using the same VPN product

463
00:27:05,700 --> 00:27:09,299
we will disclose how our plan how our

464
00:27:09,299 --> 00:27:11,940
planner was gone compromised by the same

465
00:27:11,940 --> 00:27:15,360
VPN product but it is important to know

466
00:27:15,360 --> 00:27:18,539
that we didn't know the detail of attack

467
00:27:18,539 --> 00:27:22,559
against Kei the following investigation

468
00:27:22,559 --> 00:27:26,960
is not related to Kei

469
00:27:27,659 --> 00:27:31,260
it inch it is interesting that we have

470
00:27:31,260 --> 00:27:35,460
seen a fishing attack again a VPN vendor

471
00:27:35,460 --> 00:27:39,059
and the fission side is related to cloud

472
00:27:39,059 --> 00:27:40,860
dragon C2

473
00:27:40,860 --> 00:27:45,059
and after two months the VPN 0-day

474
00:27:45,059 --> 00:27:49,760
Instinct uh instant happened

475
00:27:51,900 --> 00:27:55,080
after our investigation we found some

476
00:27:55,080 --> 00:27:58,320
some suspicious web assets a web show

477
00:27:58,320 --> 00:28:01,700
named session underscore

478
00:28:01,700 --> 00:28:05,580
check.csp was found on the VPN server

479
00:28:05,580 --> 00:28:10,340
this is a very simple JSP web show

480
00:28:10,340 --> 00:28:13,740
attacker can easily execute show command

481
00:28:13,740 --> 00:28:17,940
on the website what is the worst is that

482
00:28:17,940 --> 00:28:21,480
the permission of web service is the

483
00:28:21,480 --> 00:28:22,620
root

484
00:28:22,620 --> 00:28:26,460
the root account can access all the VPN

485
00:28:26,460 --> 00:28:31,500
data such as password hash as a slog and

486
00:28:31,500 --> 00:28:32,820
database

487
00:28:32,820 --> 00:28:36,299
of course the VPN can access the

488
00:28:36,299 --> 00:28:41,159
internet of the company attackers can

489
00:28:41,159 --> 00:28:44,220
leverage the VPN server to do little

490
00:28:44,220 --> 00:28:45,720
movements

491
00:28:45,720 --> 00:28:47,900
foreign

492
00:28:55,780 --> 00:28:56,940
[Music]

493
00:28:56,940 --> 00:29:00,059
after reviewing the source code we found

494
00:29:00,059 --> 00:29:02,520
a zero day vulnerability

495
00:29:02,520 --> 00:29:05,580
the source code is shown us below

496
00:29:05,580 --> 00:29:08,760
there is a file upload function but

497
00:29:08,760 --> 00:29:11,039
without Authentication

498
00:29:11,039 --> 00:29:15,320
this is a very common web vulnerability

499
00:29:15,320 --> 00:29:17,640
arbitrary up though

500
00:29:17,640 --> 00:29:20,460
and there's no file check in this

501
00:29:20,460 --> 00:29:24,240
function the actor can upload a web show

502
00:29:24,240 --> 00:29:27,559
with this vulnerability

503
00:29:30,360 --> 00:29:33,179
based on the version information

504
00:29:33,179 --> 00:29:37,500
there may be 117 public server

505
00:29:37,500 --> 00:29:39,419
with this vulnerability

506
00:29:39,419 --> 00:29:44,659
most often are located in South Korea

507
00:29:47,820 --> 00:29:51,120
a new better mainly Brave was also

508
00:29:51,120 --> 00:29:54,299
discovered during our investigation

509
00:29:54,299 --> 00:29:59,220
this Vector is used in lateral movements

510
00:29:59,220 --> 00:30:02,880
the C2 server augmented Ray is actually

511
00:30:02,880 --> 00:30:06,179
the compromise VPN server

512
00:30:06,179 --> 00:30:09,600
the installer will drop the loader and

513
00:30:09,600 --> 00:30:12,899
write a zip file as a blob to the

514
00:30:12,899 --> 00:30:14,279
registry

515
00:30:14,279 --> 00:30:17,179
the loader will read the registry value

516
00:30:17,179 --> 00:30:22,640
on zip and load the main deep rate

517
00:30:22,640 --> 00:30:26,580
will also read the configuration which

518
00:30:26,580 --> 00:30:29,820
is unlocked from the same resource

519
00:30:29,820 --> 00:30:31,679
in communication

520
00:30:31,679 --> 00:30:35,640
data will be encrypted encoded and

521
00:30:35,640 --> 00:30:39,620
packed to a zip file

522
00:30:42,059 --> 00:30:45,539
the name augmentative is from is debug

523
00:30:45,539 --> 00:30:50,399
log get module from CND main zip

524
00:30:50,399 --> 00:30:54,600
all comments impairments are packed in

525
00:30:54,600 --> 00:30:56,399
this format

526
00:30:56,399 --> 00:30:59,700
in addition to show command and Egyptian

527
00:30:59,700 --> 00:31:02,220
function many different

528
00:31:02,220 --> 00:31:06,179
supports lots of modules we observe much

529
00:31:06,179 --> 00:31:10,279
some modules such as injector key locker

530
00:31:10,279 --> 00:31:14,100
and kilogram screenshot and remote

531
00:31:14,100 --> 00:31:16,699
desktop

532
00:31:18,179 --> 00:31:21,360
let's recap the campaign timeline

533
00:31:21,360 --> 00:31:24,360
cloud dragon built a customized Vision

534
00:31:24,360 --> 00:31:27,299
site for VPN vendor

535
00:31:27,299 --> 00:31:29,760
from the fission side actors

536
00:31:29,760 --> 00:31:32,460
successfully got some credentials from

537
00:31:32,460 --> 00:31:33,840
employees

538
00:31:33,840 --> 00:31:36,299
using those credential

539
00:31:36,299 --> 00:31:39,840
feature can access the internet of VPN

540
00:31:39,840 --> 00:31:41,580
company

541
00:31:41,580 --> 00:31:45,120
after lateral movements they reveal the

542
00:31:45,120 --> 00:31:47,640
source code and found a zero day

543
00:31:47,640 --> 00:31:50,100
vulnerability

544
00:31:50,100 --> 00:31:52,919
let's use this to use availability to

545
00:31:52,919 --> 00:31:57,419
break into customer of the VPN product

546
00:31:57,419 --> 00:32:01,860
the the deployment display and sound

547
00:32:01,860 --> 00:32:04,380
hacking tool to control the compromise

548
00:32:04,380 --> 00:32:06,799
host

549
00:32:09,360 --> 00:32:13,140
okay in conclusion let's quickly recap

550
00:32:13,140 --> 00:32:15,860
our talks

551
00:32:16,980 --> 00:32:20,279
we introduce cloudtrack's malicious

552
00:32:20,279 --> 00:32:21,840
activities

553
00:32:21,840 --> 00:32:24,899
we found that their recent targets are

554
00:32:24,899 --> 00:32:28,260
international policy maker such as Think

555
00:32:28,260 --> 00:32:32,520
Tank universities and media

556
00:32:32,520 --> 00:32:36,000
the credential Factory consists of three

557
00:32:36,000 --> 00:32:39,899
Cycles in Daily cycle they like to use

558
00:32:39,899 --> 00:32:43,380
fishing and social engineering to get a

559
00:32:43,380 --> 00:32:46,620
lot of credential and private documents

560
00:32:46,620 --> 00:32:49,320
and using those private documents in the

561
00:32:49,320 --> 00:32:50,460
campaign cycle

562
00:32:50,460 --> 00:32:54,299
we understand their tactic and malware

563
00:32:54,299 --> 00:32:56,279
they used

564
00:32:56,279 --> 00:33:00,539
Import Cycle we can see variance hacking

565
00:33:00,539 --> 00:33:05,700
tool and overuse of remote desktop tool

566
00:33:05,700 --> 00:33:09,480
finally we present how to use credential

567
00:33:09,480 --> 00:33:13,140
Factory to establish a critical Campaign

568
00:33:13,140 --> 00:33:15,779
which is a VPN zero day vulnerability

569
00:33:15,779 --> 00:33:18,799
campaign yeah

570
00:33:19,440 --> 00:33:23,940
so here we provide some medication

571
00:33:23,940 --> 00:33:27,000
first phishing email may be sent from

572
00:33:27,000 --> 00:33:30,360
trusted contacts people should verify

573
00:33:30,360 --> 00:33:32,760
the information when opening some

574
00:33:32,760 --> 00:33:35,940
special file or website

575
00:33:35,940 --> 00:33:38,399
browser have become the confidential

576
00:33:38,399 --> 00:33:40,980
place on our computer

577
00:33:40,980 --> 00:33:44,100
so there will be more and more apt

578
00:33:44,100 --> 00:33:46,620
groups developing malicious browser

579
00:33:46,620 --> 00:33:48,240
extension

580
00:33:48,240 --> 00:33:51,299
therefore it is necessary to check

581
00:33:51,299 --> 00:33:54,779
whether any malicious browser extensions

582
00:33:54,779 --> 00:33:58,260
are installed regularly

583
00:33:58,260 --> 00:34:01,679
it is recommend to bend the use of

584
00:34:01,679 --> 00:34:05,399
remote desktop tool in Enterprise

585
00:34:05,399 --> 00:34:08,520
the remote desktop tool may become a

586
00:34:08,520 --> 00:34:11,219
Chrono will hacker height

587
00:34:11,219 --> 00:34:14,760
ensure that the maintenance account and

588
00:34:14,760 --> 00:34:18,418
password are changed a vendor should not

589
00:34:18,418 --> 00:34:21,540
design a backdoor for maintenance

590
00:34:21,540 --> 00:34:24,179
you should update all the service and

591
00:34:24,179 --> 00:34:26,940
device to the latest version

592
00:34:26,940 --> 00:34:30,839
let's finally following our research for

593
00:34:30,839 --> 00:34:34,639
update apt activities

594
00:34:35,159 --> 00:34:38,040
okay this is our reference

595
00:34:38,040 --> 00:34:41,760
uh oh okay so this has been our

596
00:34:41,760 --> 00:34:44,580
presentation today may you have any

597
00:34:44,580 --> 00:34:48,719
question please contact us via email and

598
00:34:48,719 --> 00:34:50,610
thank you

599
00:34:50,610 --> 00:34:53,800
[Applause]

