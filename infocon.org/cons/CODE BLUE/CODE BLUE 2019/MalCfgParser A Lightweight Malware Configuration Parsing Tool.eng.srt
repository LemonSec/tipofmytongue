1
00:00:04,919 --> 00:00:11,170
hello everyone today I'm going to

2
00:00:08,440 --> 00:00:12,280
introduce you our - oh man we're a

3
00:00:11,170 --> 00:00:14,529
complete tosser

4
00:00:12,280 --> 00:00:18,669
it's a lightweight networking diversion

5
00:00:14,529 --> 00:00:21,730
talking to load because of we malware

6
00:00:18,670 --> 00:00:24,610
researcher we reverse engineering every

7
00:00:21,730 --> 00:00:28,779
day every day so the design purpose of

8
00:00:24,610 --> 00:00:32,590
this choice to make malware researcher

9
00:00:28,779 --> 00:00:34,570
or response evolve life's more easier or

10
00:00:32,590 --> 00:00:37,199
the ecology I have more time to spend

11
00:00:34,570 --> 00:00:37,199
with their families

12
00:00:39,239 --> 00:00:48,218
so here the speaker based on chalks and

13
00:00:44,319 --> 00:00:51,819
chief analyst for twenty five and this

14
00:00:48,219 --> 00:00:56,229
is y dy and this is doc both of them are

15
00:00:51,819 --> 00:00:59,170
aware researcher and we do male we're

16
00:00:56,229 --> 00:01:01,299
reversing with event tracking we track

17
00:00:59,170 --> 00:01:07,390
reactor around the world

18
00:01:01,299 --> 00:01:11,770
that's our daily back and we are from

19
00:01:07,390 --> 00:01:16,180
Kim T 525 is a threat intelligence

20
00:01:11,770 --> 00:01:21,119
company based in type one yeah and we

21
00:01:16,180 --> 00:01:24,780
have 60 clients in asia-pacific region

22
00:01:21,120 --> 00:01:29,010
including a message the government

23
00:01:24,780 --> 00:01:32,170
telecom fiber in three intelligence firm

24
00:01:29,010 --> 00:01:34,780
accountant semiconductor

25
00:01:32,170 --> 00:01:38,710
international trading company all of

26
00:01:34,780 --> 00:01:44,110
them are our customers and compared with

27
00:01:38,710 --> 00:01:48,639
other US value the most unique story of

28
00:01:44,110 --> 00:01:51,789
kinky bias we perform APEC and we speak

29
00:01:48,640 --> 00:01:55,950
for APEC we believe we are Korean of

30
00:01:51,790 --> 00:02:01,020
APEC are very confident about our

31
00:01:55,950 --> 00:02:02,340
straight miss purity in this region and

32
00:02:01,020 --> 00:02:06,039
cutified

33
00:02:02,340 --> 00:02:14,489
interested in tracking fibers reactor

34
00:02:06,039 --> 00:02:14,489
around so here's the agenda for today

35
00:02:15,300 --> 00:02:23,830
so yeah yes we are track 14 of trade for

36
00:02:21,120 --> 00:02:26,140
trade in the Asia Pacific so in the

37
00:02:23,830 --> 00:02:30,640
following demonstration we will show

38
00:02:26,140 --> 00:02:33,970
some traits that that that malware

39
00:02:30,640 --> 00:02:36,700
that's actually targeting a Pacific

40
00:02:33,970 --> 00:02:40,600
so here's Chanda we are going to show

41
00:02:36,700 --> 00:02:44,500
that first what is our can take a parser

42
00:02:40,600 --> 00:02:48,100
and why we designed is why we designed

43
00:02:44,500 --> 00:02:50,440
is twelve and then tell about the

44
00:02:48,100 --> 00:02:53,709
architectural design and then we will

45
00:02:50,440 --> 00:02:56,560
have a demo so first why smell can't a

46
00:02:53,709 --> 00:03:01,650
parser and malware can take parser and

47
00:02:56,560 --> 00:03:05,080
it's a we introduce Yara and also

48
00:03:01,650 --> 00:03:05,680
against most of people is familiar with

49
00:03:05,080 --> 00:03:08,290
Yara

50
00:03:05,680 --> 00:03:11,680
and the second is not hide hide hide

51
00:03:08,290 --> 00:03:15,390
hide is finally ultimate park passer

52
00:03:11,680 --> 00:03:19,950
tool and we use this to a particle

53
00:03:15,390 --> 00:03:23,078
configuration now work and also

54
00:03:19,950 --> 00:03:26,798
basically right now we use our from the

55
00:03:23,079 --> 00:03:30,250
parser to support kuku sandbox and Pat's

56
00:03:26,799 --> 00:03:33,450
body other malware detection product and

57
00:03:30,250 --> 00:03:36,670
can use our tool to extract the

58
00:03:33,450 --> 00:03:40,988
configuration and because these well we

59
00:03:36,670 --> 00:03:45,010
already stores in will be open source so

60
00:03:40,989 --> 00:03:49,239
and everyone can access it so in a

61
00:03:45,010 --> 00:03:52,959
further I would like to person quick

62
00:03:49,239 --> 00:03:56,019
show this scenario for real quick thing

63
00:03:52,959 --> 00:03:59,040
this is a memory dump skin of a malware

64
00:03:56,019 --> 00:04:03,670
can take parser so essentially this is

65
00:03:59,040 --> 00:04:06,700
malware that's called let's call plot X

66
00:04:03,670 --> 00:04:08,768
and this is some variant from a curb

67
00:04:06,700 --> 00:04:11,850
that will track it as a bouleris

68
00:04:08,769 --> 00:04:12,970
viruses in its it's partly name is

69
00:04:11,850 --> 00:04:16,060
called

70
00:04:12,970 --> 00:04:17,560
Mastan panda is from I guess this work

71
00:04:16,060 --> 00:04:21,570
or crosswise name

72
00:04:17,560 --> 00:04:23,080
and we already tracked Polaris these

73
00:04:21,570 --> 00:04:26,680
2013

74
00:04:23,080 --> 00:04:31,150
so and this is a recent new products

75
00:04:26,680 --> 00:04:32,520
they use so in this memory skin maritime

76
00:04:31,150 --> 00:04:37,060
skin scenario

77
00:04:32,520 --> 00:04:42,370
let me show after I click the malware

78
00:04:37,060 --> 00:04:47,169
here and then a process start here or we

79
00:04:42,370 --> 00:04:50,340
stack up dat and I have to load a dump

80
00:04:47,169 --> 00:04:50,340
file on this process

81
00:04:54,840 --> 00:05:06,479
enemy switch to console I will do a scan

82
00:04:59,700 --> 00:05:10,110
on this memory block and here we see the

83
00:05:06,480 --> 00:05:15,590
malware here is its install name and

84
00:05:10,110 --> 00:05:18,750
it's a c2 server is shown in a council

85
00:05:15,590 --> 00:05:22,229
so there sanada-san around there we

86
00:05:18,750 --> 00:05:25,110
always encountered so the left side is a

87
00:05:22,230 --> 00:05:28,919
console come counsel and the right side

88
00:05:25,110 --> 00:05:38,700
is worth the n-word so in the video

89
00:05:28,919 --> 00:05:42,719
where we have our malware here as we

90
00:05:38,700 --> 00:05:47,250
click we can see there's new process in

91
00:05:42,720 --> 00:05:51,419
TCP view here's a new connection and the

92
00:05:47,250 --> 00:05:58,070
PID is here and then we switch to

93
00:05:51,419 --> 00:05:58,070
console and input the process ID here

94
00:06:03,660 --> 00:06:12,490
then the configuration is strict so it

95
00:06:08,319 --> 00:06:16,780
was either to that actually is

96
00:06:12,490 --> 00:06:19,180
configured to C&C server here but

97
00:06:16,780 --> 00:06:27,549
actually and with different port and

98
00:06:19,180 --> 00:06:29,650
also its new tax this year so in the

99
00:06:27,550 --> 00:06:32,830
second part we are going to talk about

100
00:06:29,650 --> 00:06:36,000
the challenges we worked at and why we

101
00:06:32,830 --> 00:06:41,440
designed is of this port

102
00:06:36,000 --> 00:06:46,000
so here it's flex this is a baron we

103
00:06:41,440 --> 00:06:48,130
call it all x36 a 4 is actually the

104
00:06:46,000 --> 00:06:50,440
computer restaurant size of these

105
00:06:48,130 --> 00:06:54,370
projects and we do a string on it

106
00:06:50,440 --> 00:06:57,880
slaughter and in the left side and here

107
00:06:54,370 --> 00:07:00,970
is what x loader

108
00:06:57,880 --> 00:07:04,360
it's from apt 20 will track into

109
00:07:00,970 --> 00:07:10,360
something 15 and its spring societies

110
00:07:04,360 --> 00:07:15,300
and also any a year people after and in

111
00:07:10,360 --> 00:07:19,300
2000 to 2015 and there's another power

112
00:07:15,300 --> 00:07:21,340
there's another pot except that actually

113
00:07:19,300 --> 00:07:24,520
is the stem Vibram apply X but from

114
00:07:21,340 --> 00:07:27,969
different who call tracking okay and you

115
00:07:24,520 --> 00:07:33,370
can could you see that the two two

116
00:07:27,969 --> 00:07:35,530
Springs of is very very different and we

117
00:07:33,370 --> 00:07:39,159
moved to on the third the third one that

118
00:07:35,530 --> 00:07:41,710
we track it at as actually mom did this

119
00:07:39,159 --> 00:07:46,150
is actually another a public group and

120
00:07:41,710 --> 00:07:49,419
we tried it this one acts in 2017 and

121
00:07:46,150 --> 00:07:51,669
the street is look like very different

122
00:07:49,419 --> 00:07:54,690
from the previous two one and he

123
00:07:51,669 --> 00:07:58,990
switched to other side

124
00:07:54,690 --> 00:08:02,130
three of them are quite different so

125
00:07:58,990 --> 00:08:04,830
it's it's very hard for us that we

126
00:08:02,130 --> 00:08:09,280
encounter in new projects and we do a

127
00:08:04,830 --> 00:08:14,380
new description or new decoding method

128
00:08:09,280 --> 00:08:16,448
for each different loader it's it's

129
00:08:14,380 --> 00:08:19,449
really worth our time so but because

130
00:08:16,449 --> 00:08:21,729
it's fun we switch to a situation in a

131
00:08:19,449 --> 00:08:25,240
new memory you'll see the memory

132
00:08:21,729 --> 00:08:30,550
actually actually said so we decide to

133
00:08:25,240 --> 00:08:35,700
do it in a in a memory and here is

134
00:08:30,550 --> 00:08:39,250
another challenge we face that is when

135
00:08:35,700 --> 00:08:42,940
we know there's a tool that useful are

136
00:08:39,250 --> 00:08:46,420
guilty too dumb to Australia

137
00:08:42,940 --> 00:08:48,670
configuration but mostly we work this in

138
00:08:46,420 --> 00:08:52,390
a lab environment we only focus on a

139
00:08:48,670 --> 00:08:56,020
single process and if we would like to

140
00:08:52,390 --> 00:08:59,170
turn the whole virtual machines memory

141
00:08:56,020 --> 00:09:02,770
in these four gigabytes for single

142
00:08:59,170 --> 00:09:04,060
process is really what we feel had a gun

143
00:09:02,770 --> 00:09:07,600
on itself

144
00:09:04,060 --> 00:09:10,290
yeah that's why we designed this malware

145
00:09:07,600 --> 00:09:13,709
may work on fake cancer

146
00:09:10,290 --> 00:09:20,560
okay I'm going to introduce its

147
00:09:13,709 --> 00:09:24,880
application so how does it work

148
00:09:20,560 --> 00:09:28,140
so first you need a virtual machine to

149
00:09:24,880 --> 00:09:33,640
from the well and after you identify

150
00:09:28,140 --> 00:09:39,880
well process you can manually

151
00:09:33,640 --> 00:09:45,819
tom is processed memory and or PID

152
00:09:39,880 --> 00:09:50,430
pepper to the to our tool and our McAfee

153
00:09:45,820 --> 00:09:55,810
capacitor will detect malware type and

154
00:09:50,430 --> 00:10:01,870
past the configured into context

155
00:09:55,810 --> 00:10:06,619
next inside the mobile can be passer we

156
00:10:01,870 --> 00:10:10,420
use euro the famous signature scanner to

157
00:10:06,620 --> 00:10:15,410
detach from the malware type edges and

158
00:10:10,420 --> 00:10:19,189
for the fuzzy face in the pacifist we

159
00:10:15,410 --> 00:10:23,319
use high high high time is a data

160
00:10:19,189 --> 00:10:29,660
structure framework and it can be

161
00:10:23,319 --> 00:10:34,628
defined many many structures like fire

162
00:10:29,660 --> 00:10:40,160
hunter and they were paper and so on so

163
00:10:34,629 --> 00:10:45,500
the title is llamo pet so you can use it

164
00:10:40,160 --> 00:10:54,939
online IDE for activity to edit the

165
00:10:45,500 --> 00:10:58,870
configure phantom function improved

166
00:10:54,939 --> 00:11:01,069
profiles to pass the config if the

167
00:10:58,870 --> 00:11:05,600
configuration is not in the fifth

168
00:11:01,069 --> 00:11:08,839
position and you can build your own many

169
00:11:05,600 --> 00:11:15,170
function to make the configuration is

170
00:11:08,839 --> 00:11:18,589
corner like use hosting domain or civil

171
00:11:15,170 --> 00:11:21,949
service and appear or not and if the

172
00:11:18,589 --> 00:11:26,720
configuration in the memory is still

173
00:11:21,949 --> 00:11:32,859
equal you can you can define your echo

174
00:11:26,720 --> 00:11:36,829
function to handle and to handle it next

175
00:11:32,860 --> 00:11:41,990
how the integral with the

176
00:11:36,829 --> 00:11:45,439
koukousei pass in cash machine if the

177
00:11:41,990 --> 00:11:50,420
mobile process is recreate its momentum

178
00:11:45,439 --> 00:11:55,219
will be done using the NASA Vanessa will

179
00:11:50,420 --> 00:11:57,139
damage memory into the host machine okay

180
00:11:55,220 --> 00:11:59,540
so in the host machine

181
00:11:57,139 --> 00:12:03,350
in the process memory

182
00:11:59,540 --> 00:12:08,120
then our tool where detention tomorrow

183
00:12:03,350 --> 00:12:13,610
type and pass you can see the result in

184
00:12:08,120 --> 00:12:17,089
the web server interface okay next is

185
00:12:13,610 --> 00:12:21,440
the demo time here we are going to demo

186
00:12:17,089 --> 00:12:24,529
we integrate this tool into Google

187
00:12:21,440 --> 00:12:30,769
sandbox and also our company's product

188
00:12:24,529 --> 00:12:36,939
it's called very so now so in this part

189
00:12:30,769 --> 00:12:40,579
we work how you work work with cuckoo

190
00:12:36,940 --> 00:12:45,350
and first thing a web server just

191
00:12:40,579 --> 00:12:47,508
stopped me Wow and this malware is

192
00:12:45,350 --> 00:12:52,100
called water fair

193
00:12:47,509 --> 00:12:55,339
it's a malware that from the bursary

194
00:12:52,100 --> 00:12:59,019
called a fleet or black hat and this

195
00:12:55,339 --> 00:13:03,259
this group usually really talk to see

196
00:12:59,019 --> 00:13:12,019
Taiwan and Japan a lot and so we used

197
00:13:03,259 --> 00:13:16,040
its malware Afghanistan so staying back

198
00:13:12,019 --> 00:13:20,329
strongly after a Romney was it is

199
00:13:16,040 --> 00:13:26,199
there's a new tab that's called my work

200
00:13:20,329 --> 00:13:26,199
at a quarter after we click on it

201
00:13:29,140 --> 00:13:37,149
and compression is extracted then we can

202
00:13:33,519 --> 00:13:45,490
see its pattern and also see the server

203
00:13:37,149 --> 00:13:49,269
and its new tax in its version and let's

204
00:13:45,490 --> 00:13:51,550
move on another scenario that's we would

205
00:13:49,269 --> 00:13:54,220
like to show this because it's possible

206
00:13:51,550 --> 00:13:57,969
that everyone's malware detection

207
00:13:54,220 --> 00:14:00,130
product can use our at all and to

208
00:13:57,970 --> 00:14:09,250
provide a further information on the

209
00:14:00,130 --> 00:14:18,370
straights so let's start the malware and

210
00:14:09,250 --> 00:14:20,950
also skin virus trace ona in there moved

211
00:14:18,370 --> 00:14:25,540
here and this is a dashboard person I

212
00:14:20,950 --> 00:14:32,500
will show the straight on the this

213
00:14:25,540 --> 00:14:38,380
environment and the skin it's and

214
00:14:32,500 --> 00:14:41,320
there's level one malware in there were

215
00:14:38,380 --> 00:14:44,560
one al devil files right here and here

216
00:14:41,320 --> 00:14:50,490
is a tray with this in this environment

217
00:14:44,560 --> 00:14:54,910
and we got a demo files right here and

218
00:14:50,490 --> 00:14:58,140
here is a detection then it's water pair

219
00:14:54,910 --> 00:15:01,140
then we moved to the this part its

220
00:14:58,140 --> 00:15:01,140
configuration

221
00:15:04,510 --> 00:15:08,650
configuration of this water fair

222
00:15:13,750 --> 00:15:20,110
yes so in summary yeah

223
00:15:17,350 --> 00:15:22,959
Tristana is one of 25 commercial

224
00:15:20,110 --> 00:15:26,439
products and in the previous demo we

225
00:15:22,959 --> 00:15:29,138
show that we integrate it with the

226
00:15:26,439 --> 00:15:31,240
malware configure parser to extract a

227
00:15:29,139 --> 00:15:33,839
malware complete our information

228
00:15:31,240 --> 00:15:33,839
automatically

229
00:15:38,200 --> 00:15:47,139
yeah I mean here's the way you can use

230
00:15:43,269 --> 00:15:50,110
these malware comic posture and yeah

231
00:15:47,139 --> 00:15:52,420
here's the URL you can skim by QR code

232
00:15:50,110 --> 00:15:56,019
and yes then thank you for your

233
00:15:52,420 --> 00:15:58,269
attention and we're from King t5 yeah if

234
00:15:56,019 --> 00:16:01,260
you would have any question you can come

235
00:15:58,269 --> 00:16:01,260
here and exes

