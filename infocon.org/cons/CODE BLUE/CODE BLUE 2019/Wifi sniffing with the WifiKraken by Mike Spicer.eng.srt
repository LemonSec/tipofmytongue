1
00:00:04,590 --> 00:00:10,020
I'm sure I can get started I don't know

2
00:00:07,080 --> 00:00:13,440
who's in charge of code blue but I think

3
00:00:10,020 --> 00:00:15,809
that I could probably begin I've got a

4
00:00:13,440 --> 00:00:18,810
lot of things to show you very excited

5
00:00:15,809 --> 00:00:22,799
to show you that so welcome welcome to

6
00:00:18,810 --> 00:00:24,779
my blue box as I go through this after

7
00:00:22,800 --> 00:00:27,180
we finish it you can feel free to come

8
00:00:24,780 --> 00:00:29,460
up and look inside and you can take

9
00:00:27,180 --> 00:00:32,128
pictures you can take pictures of this

10
00:00:29,460 --> 00:00:34,770
as well so pictures are fine by me so

11
00:00:32,128 --> 00:00:39,748
thank you so much for your interest and

12
00:00:34,770 --> 00:00:41,879
for coming my name is Mike Spicer I'm

13
00:00:39,749 --> 00:00:47,460
also known as dark matter on the

14
00:00:41,879 --> 00:00:50,879
internet so I'm I'm really passionate

15
00:00:47,460 --> 00:00:54,510
about wireless I think of myself as a

16
00:00:50,879 --> 00:00:59,729
mad scientist and also I think of myself

17
00:00:54,510 --> 00:01:01,550
as a hacker and creator these pictures

18
00:00:59,729 --> 00:01:04,470
that you see on the screen right here

19
00:01:01,550 --> 00:01:06,420
one of them was from my talk I did a

20
00:01:04,470 --> 00:01:09,840
talk at Def Con this year on the

21
00:01:06,420 --> 00:01:13,259
mainstage there and then the one on the

22
00:01:09,840 --> 00:01:16,490
right hand side is the picture of this

23
00:01:13,259 --> 00:01:19,710
my new project the Wi-Fi kraken which is

24
00:01:16,490 --> 00:01:21,570
the first this is the second time that

25
00:01:19,710 --> 00:01:24,360
I've presented this project so this is

26
00:01:21,570 --> 00:01:27,990
the new system that I'm very excited to

27
00:01:24,360 --> 00:01:31,049
show you all so if anyone has questions

28
00:01:27,990 --> 00:01:33,030
or things throughout the presentation I

29
00:01:31,049 --> 00:01:37,950
want this to be interactive so feel free

30
00:01:33,030 --> 00:01:42,359
to raise your hand and ask questions so

31
00:01:37,950 --> 00:01:44,490
this all started with me being curious

32
00:01:42,359 --> 00:01:46,619
I started off being curious and wanting

33
00:01:44,490 --> 00:01:50,310
to know what's going on on the Wi-Fi and

34
00:01:46,619 --> 00:01:53,520
the Box on the left it was my very first

35
00:01:50,310 --> 00:01:57,479
project it was essentially a Raspberry

36
00:01:53,520 --> 00:02:00,060
Pi with two wireless radios

37
00:01:57,479 --> 00:02:02,460
and you can see those the wireless

38
00:02:00,060 --> 00:02:04,140
radios one is here and one is here with

39
00:02:02,460 --> 00:02:07,020
some batteries and I put that in my

40
00:02:04,140 --> 00:02:09,320
backpack started carrying it around with

41
00:02:07,020 --> 00:02:09,320
me

42
00:02:09,758 --> 00:02:14,470
and then I was able to collect some data

43
00:02:11,980 --> 00:02:18,159
but I learned a lot of lessons from

44
00:02:14,470 --> 00:02:20,700
doing that and I didn't catch very much

45
00:02:18,159 --> 00:02:23,379
data I was missing a lot of information

46
00:02:20,700 --> 00:02:26,170
and the reason is is because I was using

47
00:02:23,379 --> 00:02:30,790
the wrong software so it's very much a

48
00:02:26,170 --> 00:02:34,149
lesson to be to use the correct software

49
00:02:30,790 --> 00:02:36,340
and hardware together so that project

50
00:02:34,150 --> 00:02:38,829
turned out to be a little bit bigger so

51
00:02:36,340 --> 00:02:41,470
if you look on this other side I then

52
00:02:38,829 --> 00:02:44,769
built with the help of my friends all of

53
00:02:41,470 --> 00:02:47,440
these boxes so it was a big improvement

54
00:02:44,769 --> 00:02:50,230
over the previous one box in my backpack

55
00:02:47,440 --> 00:02:53,950
and we ended up placing those around a

56
00:02:50,230 --> 00:02:56,980
conference Def Con in Las Vegas and also

57
00:02:53,950 --> 00:02:58,810
blackhat in Las Vegas and deployed those

58
00:02:56,980 --> 00:03:02,619
sensors throughout the conference and

59
00:02:58,810 --> 00:03:06,819
gathers data there this was a very big

60
00:03:02,620 --> 00:03:09,639
learning experience because first of all

61
00:03:06,819 --> 00:03:11,619
they were little suitcases and security

62
00:03:09,639 --> 00:03:16,199
was very concerned that they could be

63
00:03:11,620 --> 00:03:21,519
some sort of harmful devices maybe bombs

64
00:03:16,199 --> 00:03:24,250
so it was it was interesting only one

65
00:03:21,519 --> 00:03:26,079
though got confiscated and I ultimately

66
00:03:24,250 --> 00:03:30,910
got it back after I explained what the

67
00:03:26,079 --> 00:03:32,709
project was but it's interesting when

68
00:03:30,910 --> 00:03:35,260
you're putting things around places

69
00:03:32,709 --> 00:03:39,340
people start to notice them I want to

70
00:03:35,260 --> 00:03:42,250
know what's going on with your boxes so

71
00:03:39,340 --> 00:03:44,470
I have been around the world this is my

72
00:03:42,250 --> 00:03:47,199
first time to Japan I'm very excited

73
00:03:44,470 --> 00:03:49,540
this has definitely been on my my bucket

74
00:03:47,199 --> 00:03:51,609
list my lifelong goal list to come to

75
00:03:49,540 --> 00:03:53,500
Japan so thank you so much for having me

76
00:03:51,609 --> 00:03:56,470
as it's absolutely been a pleasure I

77
00:03:53,500 --> 00:03:59,560
love it here but as you can see I've

78
00:03:56,470 --> 00:04:02,440
been with the Wi-Fi cactus my first

79
00:03:59,560 --> 00:04:05,290
project to all of these locations and

80
00:04:02,440 --> 00:04:07,989
there's still more I want to go to so

81
00:04:05,290 --> 00:04:09,280
and I'm very happy to add a code blue

82
00:04:07,989 --> 00:04:11,680
here on this

83
00:04:09,280 --> 00:04:17,260
this has been an absolute treatment so

84
00:04:11,680 --> 00:04:20,048
thank you so much you might have seen me

85
00:04:17,260 --> 00:04:21,730
with Darrin kitchen on episode of hack 5

86
00:04:20,048 --> 00:04:25,150
if you're familiar with that YouTube

87
00:04:21,730 --> 00:04:27,910
channel Darrin and me are really good

88
00:04:25,150 --> 00:04:30,880
friends and he actually provided me the

89
00:04:27,910 --> 00:04:34,000
the main devices the hack 5 pineapple

90
00:04:30,880 --> 00:04:36,520
Tetris that make up each of the each of

91
00:04:34,000 --> 00:04:38,830
the devices that are being used in the

92
00:04:36,520 --> 00:04:42,310
Wi-Fi cactus there's 25 of those and the

93
00:04:38,830 --> 00:04:44,050
cactus and so is through a sponsorship

94
00:04:42,310 --> 00:04:46,360
through hack 5 so I'm very appreciative

95
00:04:44,050 --> 00:04:49,690
to them and I've been on the show a

96
00:04:46,360 --> 00:04:51,460
number of times and done interviews last

97
00:04:49,690 --> 00:04:54,370
year I had the opportunity to go to

98
00:04:51,460 --> 00:04:57,669
DEFCON China for the first time for its

99
00:04:54,370 --> 00:05:03,760
beta role at home and that was very

100
00:04:57,669 --> 00:05:06,490
interesting bringing this to China so

101
00:05:03,760 --> 00:05:08,289
yeah it's very interesting and bringing

102
00:05:06,490 --> 00:05:11,650
that to China but I made it and

103
00:05:08,290 --> 00:05:16,330
everything is ok now I'm here to talk to

104
00:05:11,650 --> 00:05:20,049
you guys so I learned a lot of lessons I

105
00:05:16,330 --> 00:05:21,729
learned a lot of things from building

106
00:05:20,050 --> 00:05:24,520
these different projects and building

107
00:05:21,729 --> 00:05:27,010
these things up and the things that I

108
00:05:24,520 --> 00:05:29,650
learned is that I need to get more

109
00:05:27,010 --> 00:05:32,080
throughput so one of the disadvantages

110
00:05:29,650 --> 00:05:34,200
of the Wi-Fi cactus let me just give you

111
00:05:32,080 --> 00:05:37,030
a quick introduction on the Wi-Fi cactus

112
00:05:34,200 --> 00:05:39,640
it's made up of the 25 pineapple tetras

113
00:05:37,030 --> 00:05:41,260
the hack - apple tetras it then takes

114
00:05:39,640 --> 00:05:44,020
all that data and it takes it over

115
00:05:41,260 --> 00:05:46,630
Ethernet and brings it back to the Intel

116
00:05:44,020 --> 00:05:52,359
nook at the top so this is an i5 Intel

117
00:05:46,630 --> 00:05:55,030
nook I said 8th gen Intel chip and then

118
00:05:52,360 --> 00:05:57,220
it also has an nvme storage device so

119
00:05:55,030 --> 00:05:58,719
for all four hard drive so that's all

120
00:05:57,220 --> 00:06:00,940
coming back through Ethernet

121
00:05:58,720 --> 00:06:02,889
these are gigabit switches two gigabit

122
00:06:00,940 --> 00:06:06,550
switches and I chose these switch

123
00:06:02,889 --> 00:06:10,150
is because they support DC input DC

124
00:06:06,550 --> 00:06:11,770
power so the data is coming from all

125
00:06:10,150 --> 00:06:14,169
these aggregated through the switches to

126
00:06:11,770 --> 00:06:17,830
the Newark so that means that I have a

127
00:06:14,169 --> 00:06:21,159
single Hunt one gigabit bottleneck on

128
00:06:17,830 --> 00:06:22,870
this system and I wanted more because if

129
00:06:21,159 --> 00:06:27,310
you look at the capability each of these

130
00:06:22,870 --> 00:06:29,110
devices has two wireless radios and

131
00:06:27,310 --> 00:06:35,590
essentially each of those wireless

132
00:06:29,110 --> 00:06:38,740
radios is capable of doing up to 600

133
00:06:35,590 --> 00:06:41,438
megabits apiece so two radios can can

134
00:06:38,740 --> 00:06:44,199
saturate the gigabit depending on how

135
00:06:41,439 --> 00:06:46,029
busy the environment is and so as I'm

136
00:06:44,199 --> 00:06:50,020
aggravated the data back I'm going to

137
00:06:46,029 --> 00:06:52,539
inevitably have lost but this Oh an

138
00:06:50,020 --> 00:06:55,330
other thing too is there's this cool

139
00:06:52,539 --> 00:06:58,509
board right here this board it's an

140
00:06:55,330 --> 00:07:00,400
antenna aggregator our signal aggregator

141
00:06:58,509 --> 00:07:03,310
so it's taking the input from two

142
00:07:00,400 --> 00:07:06,188
signals two antennas and it's putting it

143
00:07:03,310 --> 00:07:08,319
out into eight radios and so it reduces

144
00:07:06,189 --> 00:07:11,710
the overall number of antennas this

145
00:07:08,319 --> 00:07:17,789
originally had 100 antennas and now it's

146
00:07:11,710 --> 00:07:19,750
down to 86 so we're making progress

147
00:07:17,789 --> 00:07:21,969
let's see the other thing that I've

148
00:07:19,750 --> 00:07:24,879
upgraded on this in the first iterations

149
00:07:21,969 --> 00:07:30,789
of it I was using a lead-acid car

150
00:07:24,879 --> 00:07:33,460
battery which weighed about eight to ten

151
00:07:30,789 --> 00:07:36,460
kilos right is that right no yeah eight

152
00:07:33,460 --> 00:07:39,188
to ten kilos for a total weight of about

153
00:07:36,460 --> 00:07:41,489
thirty kilos and so now I've changed

154
00:07:39,189 --> 00:07:44,649
those to lithium ion and now that's

155
00:07:41,490 --> 00:07:47,110
approximately about fifteen kilos now so

156
00:07:44,649 --> 00:07:50,020
it's a lot less weight and it makes my

157
00:07:47,110 --> 00:07:52,389
back less sore and I can carry it around

158
00:07:50,020 --> 00:07:54,430
longer also the duration is up it'll be

159
00:07:52,389 --> 00:07:56,740
lasted about 30 minutes with the lead

160
00:07:54,430 --> 00:07:59,710
acid battery with the litany of ions

161
00:07:56,740 --> 00:08:02,879
it's about three hours of run time that

162
00:07:59,710 --> 00:08:06,250
I can walk around I could go places so

163
00:08:02,879 --> 00:08:07,899
yeah I'm actually gonna see about maybe

164
00:08:06,250 --> 00:08:11,069
walking around the streets of Tokyo do

165
00:08:07,899 --> 00:08:11,069
you guys think that that's a good idea

166
00:08:11,710 --> 00:08:20,900
the consensus is yes thank you also one

167
00:08:19,039 --> 00:08:22,820
other thing at the bottom of it is I do

168
00:08:20,900 --> 00:08:25,008
have an AC power supply because

169
00:08:22,820 --> 00:08:26,630
sometimes when I'm doing presentations

170
00:08:25,009 --> 00:08:28,699
or demonstrations or have it sitting

171
00:08:26,630 --> 00:08:30,800
someplace for a long time it's nice to

172
00:08:28,699 --> 00:08:33,649
have it plugged in so that that way I'm

173
00:08:30,800 --> 00:08:38,089
not just using the batteries oh and then

174
00:08:33,649 --> 00:08:40,399
I do have an Arduino here the Arduino is

175
00:08:38,089 --> 00:08:43,190
powering the lights these are neopixel

176
00:08:40,399 --> 00:08:45,800
lights from Adafruit so you always have

177
00:08:43,190 --> 00:08:48,920
to add lights to your project so that

178
00:08:45,800 --> 00:08:51,439
way it looks pretty it's important to

179
00:08:48,920 --> 00:08:54,979
have pretty then the pineapple on top is

180
00:08:51,440 --> 00:08:58,220
homage to the the hak5 pineapple tetras

181
00:08:54,980 --> 00:09:02,330
that this device is made up of so yes

182
00:08:58,220 --> 00:09:04,490
and now thanks to my friend kentaro who

183
00:09:02,330 --> 00:09:06,380
is one of the hard-working organizers of

184
00:09:04,490 --> 00:09:10,130
this event there is now a duct on here

185
00:09:06,380 --> 00:09:15,439
as well so thank you can taro for the

186
00:09:10,130 --> 00:09:18,470
duck duck army okay so that is the Wi-Fi

187
00:09:15,440 --> 00:09:20,180
cactus and then the lesson learned from

188
00:09:18,470 --> 00:09:22,940
the Wi-Fi cactus was the throughput and

189
00:09:20,180 --> 00:09:24,739
bandwidth issues so after this is over

190
00:09:22,940 --> 00:09:26,120
you feel free to come up and you can

191
00:09:24,740 --> 00:09:28,459
take a look but essentially what I've

192
00:09:26,120 --> 00:09:30,529
done is I've taken I've got less radios

193
00:09:28,459 --> 00:09:33,920
so this is 50 radios this is one only

194
00:09:30,529 --> 00:09:37,130
has 14 radios so it's a bit less radios

195
00:09:33,920 --> 00:09:40,459
but there each of the radios is going to

196
00:09:37,130 --> 00:09:43,400
a unique into two different unique USB

197
00:09:40,459 --> 00:09:49,760
3.0 room hubs and I'm doing that by

198
00:09:43,400 --> 00:09:52,880
having two USB 2 PCI Express 7 port USB

199
00:09:49,760 --> 00:09:56,420
hub so I'm able to get more throughput

200
00:09:52,880 --> 00:09:59,930
from the adapters directly to the solid

201
00:09:56,420 --> 00:10:01,849
state hard drive and which which

202
00:09:59,930 --> 00:10:05,719
completely bypasses the ethernet issue

203
00:10:01,850 --> 00:10:07,620
that I was having here the other thing

204
00:10:05,720 --> 00:10:10,250
too is this device the hack

205
00:10:07,620 --> 00:10:15,000
pineapple tetra is a fantastic device

206
00:10:10,250 --> 00:10:19,470
however its uses only the 802 11 N

207
00:10:15,000 --> 00:10:22,590
wireless radios and more recently we're

208
00:10:19,470 --> 00:10:25,770
already on Wi-Fi 6 which is 802 11 ax

209
00:10:22,590 --> 00:10:27,990
and I'm not there yet so my next project

210
00:10:25,770 --> 00:10:32,460
will be an 802 11 ax project this

211
00:10:27,990 --> 00:10:35,010
project is 802 11 AC capable so the

212
00:10:32,460 --> 00:11:05,250
chipsets in this the wireless adapters

213
00:10:35,010 --> 00:11:07,500
are called mediatek mt6752 do wireless

214
00:11:05,250 --> 00:11:11,660
monitoring this is definitely the best

215
00:11:07,500 --> 00:11:29,010
place to start right now is the the

216
00:11:11,660 --> 00:11:34,260
mediatek mt6752 this the other advantage

217
00:11:29,010 --> 00:11:36,240
of this is I close the lid I lock the

218
00:11:34,260 --> 00:11:39,540
hand the lock the locks and then I check

219
00:11:36,240 --> 00:11:42,720
it at luggage and then it ships with me

220
00:11:39,540 --> 00:11:44,819
and it's easy this takes about an hour

221
00:11:42,720 --> 00:11:47,130
and a half to disassemble everything and

222
00:11:44,820 --> 00:11:49,800
put it into two separate cases because

223
00:11:47,130 --> 00:11:53,250
by itself that weighs too much to travel

224
00:11:49,800 --> 00:11:57,000
with so it's a little this one is a lot

225
00:11:53,250 --> 00:11:59,130
easier to travel with also it too is

226
00:11:57,000 --> 00:12:01,850
battery-powered there are these

227
00:11:59,130 --> 00:12:04,140
batteries called talent cell batteries

228
00:12:01,850 --> 00:12:05,880
you just have to come up and look at

229
00:12:04,140 --> 00:12:07,470
them essentially it gives this device

230
00:12:05,880 --> 00:12:09,100
about three and a half to four hours of

231
00:12:07,470 --> 00:12:12,790
runtime on those batteries

232
00:12:09,100 --> 00:12:14,740
and they're also rated at just under a

233
00:12:12,790 --> 00:12:17,860
hundred watt hour so you can bring them

234
00:12:14,740 --> 00:12:21,760
on a plane so and I have three of those

235
00:12:17,860 --> 00:12:26,470
and I brought them here with me on my

236
00:12:21,760 --> 00:12:28,090
flight from the United States okay also

237
00:12:26,470 --> 00:12:33,010
the the picture on the right that you

238
00:12:28,090 --> 00:12:35,800
see there is at blackhat in Las Vegas I

239
00:12:33,010 --> 00:12:39,460
was able to set this device up and was

240
00:12:35,800 --> 00:12:41,859
able to monitor the traffic for a number

241
00:12:39,460 --> 00:12:44,980
of hours and days there so they've

242
00:12:41,860 --> 00:12:46,720
always been so great to me and allowed

243
00:12:44,980 --> 00:12:49,180
me to set up my projects to be able to

244
00:12:46,720 --> 00:12:51,460
do analysis there and so it gives me a

245
00:12:49,180 --> 00:12:54,640
lot of opportunity to get data and if

246
00:12:51,460 --> 00:12:57,820
you can see the the monkey right there

247
00:12:54,640 --> 00:13:00,939
next to him while he's he's the he's the

248
00:12:57,820 --> 00:13:03,010
network operation center monkey and so

249
00:13:00,940 --> 00:13:08,080
he's always there and interested in my

250
00:13:03,010 --> 00:13:09,970
projects I'm gonna view some live demos

251
00:13:08,080 --> 00:13:11,080
we're gonna get into some live data and

252
00:13:09,970 --> 00:13:12,460
what's going on in the environment

253
00:13:11,080 --> 00:13:14,920
around us but first I wanted to show you

254
00:13:12,460 --> 00:13:18,070
some of the data that I've captured in

255
00:13:14,920 --> 00:13:19,360
the past so being able to go around the

256
00:13:18,070 --> 00:13:21,910
world and travel the different

257
00:13:19,360 --> 00:13:24,330
conferences it enables me to do graphs

258
00:13:21,910 --> 00:13:27,819
like this and what this graph shows is

259
00:13:24,330 --> 00:13:30,550
each of the small dots is a unique MAC

260
00:13:27,820 --> 00:13:32,620
address and so this could be of your

261
00:13:30,550 --> 00:13:34,329
cell phone this could be of laptops this

262
00:13:32,620 --> 00:13:36,100
could be of different devices that I see

263
00:13:34,330 --> 00:13:38,050
in the environment and I'm taking that

264
00:13:36,100 --> 00:13:39,820
MAC address and I'm correlating it to

265
00:13:38,050 --> 00:13:42,849
the different locations where I've seen

266
00:13:39,820 --> 00:13:46,780
them so for example you can see black

267
00:13:42,850 --> 00:13:48,430
hat in 2017 to black hat 2018 you can

268
00:13:46,780 --> 00:13:49,810
see the lines in the layover where

269
00:13:48,430 --> 00:13:51,489
there's there's the correlation and

270
00:13:49,810 --> 00:13:53,469
there's the oh yeah

271
00:13:51,490 --> 00:13:55,540
winter you can see the group here the

272
00:13:53,470 --> 00:13:57,730
grouping so these these are people who

273
00:13:55,540 --> 00:13:59,500
have gone to both of those and so I'm

274
00:13:57,730 --> 00:14:02,020
essentially filtering by edge now it's

275
00:13:59,500 --> 00:14:03,430
greater than two and then also we can

276
00:14:02,020 --> 00:14:06,579
see that there's a lot of people who

277
00:14:03,430 --> 00:14:08,260
came from black hat to Def Con 2017 and

278
00:14:06,580 --> 00:14:12,240
we can also see this one's an

279
00:14:08,260 --> 00:14:14,920
interesting Def Con 2018 or Def Con 26

280
00:14:12,240 --> 00:14:17,050
and Def Con 25 so there's a big

281
00:14:14,920 --> 00:14:19,000
clustering of people who went back the

282
00:14:17,050 --> 00:14:20,979
next year so it's interesting to be able

283
00:14:19,000 --> 00:14:24,730
to see this and of course you see this

284
00:14:20,980 --> 00:14:26,950
huge following from black hat 17 to Def

285
00:14:24,730 --> 00:14:30,790
Con 25 because it's at the end of the

286
00:14:26,950 --> 00:14:32,500
week so I anticipate here I'll see some

287
00:14:30,790 --> 00:14:35,980
people at code blue that hopefully I'll

288
00:14:32,500 --> 00:14:37,630
see also at Tokyo AV Tokyo so we'll see

289
00:14:35,980 --> 00:14:41,709
something similar on this type of graph

290
00:14:37,630 --> 00:14:43,630
for next year and and so it's really

291
00:14:41,709 --> 00:14:46,510
neat to see this and it really gives us

292
00:14:43,630 --> 00:14:48,850
a sense that our community is global

293
00:14:46,510 --> 00:14:50,589
with like I see them very similar people

294
00:14:48,850 --> 00:14:52,300
with in all the different places it's

295
00:14:50,589 --> 00:14:54,220
really neat to see the community and the

296
00:14:52,300 --> 00:14:58,349
global nests and to see kind of the

297
00:14:54,220 --> 00:15:00,700
mapping of how this all comes together

298
00:14:58,350 --> 00:15:02,649
another interesting thing is the data

299
00:15:00,700 --> 00:15:07,320
leaks that's one of the most fascinating

300
00:15:02,649 --> 00:15:10,360
things to me we look at we look at our

301
00:15:07,320 --> 00:15:13,300
we look at apps and we look at our web

302
00:15:10,360 --> 00:15:14,920
sites and things and luckily our web

303
00:15:13,300 --> 00:15:17,050
sites have the little lock right the

304
00:15:14,920 --> 00:15:19,170
tell us that there's SSL happening and

305
00:15:17,050 --> 00:15:21,849
that things are our TSL that's happening

306
00:15:19,170 --> 00:15:24,520
there our TLS is happening in that we

307
00:15:21,850 --> 00:15:26,589
have some level of encryption right but

308
00:15:24,520 --> 00:15:28,240
apps there's no way to see them there's

309
00:15:26,589 --> 00:15:31,000
no information that says this

310
00:15:28,240 --> 00:15:33,880
communication is happening encrypted and

311
00:15:31,000 --> 00:15:37,930
here's an example from the Def Con 26

312
00:15:33,880 --> 00:15:40,180
data set that I had where a été phone

313
00:15:37,930 --> 00:15:43,029
and it was a desktop weather widget

314
00:15:40,180 --> 00:15:47,050
which had access to the phone's

315
00:15:43,029 --> 00:15:51,970
geolocation was doing an API call over

316
00:15:47,050 --> 00:15:54,130
HTTP with knows encryption so and if you

317
00:15:51,970 --> 00:15:55,560
can see oh yeah I keep wanting to go

318
00:15:54,130 --> 00:15:59,579
over here I keep wanting to

319
00:15:55,560 --> 00:16:01,050
um if you if you can see the latitude

320
00:15:59,579 --> 00:16:03,060
and longitude there that's a part of

321
00:16:01,050 --> 00:16:05,040
this so I've essentially gotten this

322
00:16:03,060 --> 00:16:06,959
device's MAC address and I've got their

323
00:16:05,040 --> 00:16:10,319
latitude and longitude as soon as they

324
00:16:06,959 --> 00:16:11,479
make the post request to the API so what

325
00:16:10,319 --> 00:16:14,248
could go wrong with that

326
00:16:11,480 --> 00:16:16,639
essentially it's a people tractor at

327
00:16:14,249 --> 00:16:18,839
that point so anytime that person is

328
00:16:16,639 --> 00:16:20,639
looking for their weather and then this

329
00:16:18,839 --> 00:16:23,360
could be something benign is I want to

330
00:16:20,639 --> 00:16:27,089
know if it's gonna be raining tonight

331
00:16:23,360 --> 00:16:29,189
it's it's leaking my information and in

332
00:16:27,089 --> 00:16:31,910
most cases on phones that's privileged

333
00:16:29,189 --> 00:16:35,399
information you have to specifically say

334
00:16:31,910 --> 00:16:37,319
I give permission to my location data

335
00:16:35,399 --> 00:16:39,509
right because location data is

336
00:16:37,319 --> 00:16:44,279
privileged information on most devices

337
00:16:39,509 --> 00:16:47,279
now also when I checked this data that

338
00:16:44,279 --> 00:16:48,959
that API call is still valid so you

339
00:16:47,279 --> 00:16:52,079
could type that in on your phone right

340
00:16:48,959 --> 00:16:55,589
now and get the get the weather for that

341
00:16:52,079 --> 00:16:57,779
location and it's still using HTTP so

342
00:16:55,589 --> 00:16:58,970
I'm still I'm concerned that you know

343
00:16:57,779 --> 00:17:02,420
people are still doing things

344
00:16:58,970 --> 00:17:05,760
unencrypted so yay for information leaks

345
00:17:02,420 --> 00:17:06,928
I here's some of my contact info I just

346
00:17:05,760 --> 00:17:08,760
want to give that to you guys right now

347
00:17:06,929 --> 00:17:10,740
we still have some bit more time I'm

348
00:17:08,760 --> 00:17:12,839
gonna go into the actual software and go

349
00:17:10,740 --> 00:17:14,459
to the live demo portion of this but

350
00:17:12,839 --> 00:17:16,049
yeah feel free to take a picture of this

351
00:17:14,459 --> 00:17:19,110
and then in a moment I'll bring this

352
00:17:16,049 --> 00:17:22,859
back up I also wrote a tool called P

353
00:17:19,109 --> 00:17:27,079
Kappa Nader on my github and basically

354
00:17:22,859 --> 00:17:30,418
it's a tool to basically parallel eyes

355
00:17:27,079 --> 00:17:32,158
pcap analysis so it tears the P cap into

356
00:17:30,419 --> 00:17:37,919
multiple pieces or breaks it into

357
00:17:32,159 --> 00:17:39,570
multiple smaller pieces and then it will

358
00:17:37,919 --> 00:17:42,480
then process those based on how many

359
00:17:39,570 --> 00:17:44,939
cores you have on your system and then

360
00:17:42,480 --> 00:17:47,580
then we'll reassemble the results at the

361
00:17:44,940 --> 00:17:50,039
end and so that's it's a very useful

362
00:17:47,580 --> 00:17:52,289
tool for when you're dealing with large

363
00:17:50,039 --> 00:17:54,030
amounts of data like my data collection

364
00:17:52,289 --> 00:17:56,379
from all the different locations has

365
00:17:54,030 --> 00:18:00,010
been way over a terabyte at this

366
00:17:56,380 --> 00:18:03,100
so lots of data okay let's take a look

367
00:18:00,010 --> 00:18:05,020
at actually the software so first up I

368
00:18:03,100 --> 00:18:07,149
just wanted to do a shout out this look

369
00:18:05,020 --> 00:18:08,950
okay so we've got two different services

370
00:18:07,150 --> 00:18:10,390
running so we've got the Wi-Fi crack in

371
00:18:08,950 --> 00:18:12,220
so this screen we're looking at right

372
00:18:10,390 --> 00:18:14,049
now is the Wi-Fi crack in it's this one

373
00:18:12,220 --> 00:18:16,120
then we've got the Wi-Fi cactus and I'll

374
00:18:14,049 --> 00:18:18,070
show you that one in a moment so this

375
00:18:16,120 --> 00:18:22,320
one this screen that you see on right

376
00:18:18,070 --> 00:18:25,629
now is a mobile dashboard developed by

377
00:18:22,320 --> 00:18:27,879
your own Alcantar oh he built this and

378
00:18:25,630 --> 00:18:30,100
it's on his github the software that I'm

379
00:18:27,880 --> 00:18:33,370
using is a software called kismet have

380
00:18:30,100 --> 00:18:36,600
any of you heard of kismet a couple of

381
00:18:33,370 --> 00:18:40,090
you so kismet is turning into a wireless

382
00:18:36,600 --> 00:18:42,309
analysis software all completely open

383
00:18:40,090 --> 00:18:46,000
source free to use you can install it on

384
00:18:42,309 --> 00:18:48,700
your laptop and this is what you end up

385
00:18:46,000 --> 00:18:50,440
getting you're able to then see what's

386
00:18:48,700 --> 00:18:52,240
going on in the environment the read

387
00:18:50,440 --> 00:18:54,640
don't be worried the read isn't anything

388
00:18:52,240 --> 00:18:58,059
to be concerned of it just means that we

389
00:18:54,640 --> 00:18:59,500
have captured the WPA handshake and I've

390
00:18:58,059 --> 00:19:01,299
been able to monitor and watch the

391
00:18:59,500 --> 00:19:02,710
communication enough to be able to get

392
00:19:01,299 --> 00:19:07,090
the wpa handshakes

393
00:19:02,710 --> 00:19:11,710
on each of these access points so that's

394
00:19:07,090 --> 00:19:14,470
cool back to the dashboard umm Kintaro

395
00:19:11,710 --> 00:19:16,870
made this dashboard which is super handy

396
00:19:14,470 --> 00:19:19,659
and provides summary information for

397
00:19:16,870 --> 00:19:23,379
what's going on in the wireless around

398
00:19:19,659 --> 00:19:26,470
us so right now this device is seeing 89

399
00:19:23,380 --> 00:19:28,990
active channels I do have 13 out of 13

400
00:19:26,470 --> 00:19:30,789
this actually does 14 devices I've only

401
00:19:28,990 --> 00:19:32,860
got 13 one of them's being a little

402
00:19:30,789 --> 00:19:35,350
finicky that's one of the problems of

403
00:19:32,860 --> 00:19:39,010
using USB wireless devices and so many

404
00:19:35,350 --> 00:19:42,100
of them you get a little bit of a little

405
00:19:39,010 --> 00:19:44,830
bit of issue and so 13 are active and

406
00:19:42,100 --> 00:19:47,139
working right now the 14th is not but

407
00:19:44,830 --> 00:19:49,860
we're seeing data on 89 channels

408
00:19:47,140 --> 00:19:53,860
currently we're recording data at about

409
00:19:49,860 --> 00:19:56,559
3 kilobytes per second or 3 Killah

410
00:19:53,860 --> 00:20:01,090
packets per second and then also I've

411
00:19:56,559 --> 00:20:03,760
seen so far 24,000 unique devices in the

412
00:20:01,090 --> 00:20:05,830
environment which is a lot a lot of

413
00:20:03,760 --> 00:20:08,290
devices and so we're probably seeing

414
00:20:05,830 --> 00:20:08,860
also devices of people driving by we're

415
00:20:08,290 --> 00:20:11,260
probably

416
00:20:08,860 --> 00:20:13,149
people up above us below us you know

417
00:20:11,260 --> 00:20:16,000
people all around us are probably seeing

418
00:20:13,150 --> 00:20:19,179
a lot of additional communication

419
00:20:16,000 --> 00:20:21,610
because Wireless is magical and it just

420
00:20:19,179 --> 00:20:23,830
goes everywhere it's all around us it

421
00:20:21,610 --> 00:20:25,360
doesn't stop at walls right it's some

422
00:20:23,830 --> 00:20:28,928
walls it does if they're concrete and

423
00:20:25,360 --> 00:20:31,540
lead-lined but for the most part if were

424
00:20:28,929 --> 00:20:33,760
able to see wireless all around us and

425
00:20:31,540 --> 00:20:36,490
this can pick up basically for around a

426
00:20:33,760 --> 00:20:40,000
hundred meters is what it's capable of

427
00:20:36,490 --> 00:20:43,179
it seen we can also see which channels

428
00:20:40,000 --> 00:20:46,090
seem to have the most devices on them so

429
00:20:43,179 --> 00:20:49,210
we can see here it looks like five point

430
00:20:46,090 --> 00:20:51,220
one eight gigahertz has you know 73 and

431
00:20:49,210 --> 00:20:52,960
we can also see as people are moving

432
00:20:51,220 --> 00:20:54,880
around the building that's gonna change

433
00:20:52,960 --> 00:20:57,460
because of what access point they are on

434
00:20:54,880 --> 00:20:59,799
also if you're using something like a

435
00:20:57,460 --> 00:21:01,960
rubra or something that has like the

436
00:20:59,799 --> 00:21:03,840
Cisco Aero Nets that have cloud

437
00:21:01,960 --> 00:21:06,700
controller it's actually going to

438
00:21:03,840 --> 00:21:10,330
strategize your wireless access point

439
00:21:06,700 --> 00:21:11,919
channels throughout the the environment

440
00:21:10,330 --> 00:21:14,168
as the environment changes to try to

441
00:21:11,919 --> 00:21:15,520
offload load to make sure that areas are

442
00:21:14,169 --> 00:21:17,650
getting the best throughput that they

443
00:21:15,520 --> 00:21:20,350
can and so it's really nice to be able

444
00:21:17,650 --> 00:21:22,330
to have this many radios so that you can

445
00:21:20,350 --> 00:21:23,649
watch those types of things happen you

446
00:21:22,330 --> 00:21:25,240
can see what's going on in the

447
00:21:23,650 --> 00:21:27,549
environment and watch those transitions

448
00:21:25,240 --> 00:21:32,710
happen and be able to capture that

449
00:21:27,549 --> 00:21:36,490
communication let's see it looks like

450
00:21:32,710 --> 00:21:39,040
currently we have 485 unique access

451
00:21:36,490 --> 00:21:41,710
points in the environment like I said

452
00:21:39,040 --> 00:21:45,129
we've got 22,000 clients on those access

453
00:21:41,710 --> 00:21:48,450
points or that our client devices and

454
00:21:45,130 --> 00:21:51,450
then we've got what are these ones so

455
00:21:48,450 --> 00:21:51,450
here's

456
00:21:53,430 --> 00:21:58,630
it's it's so many it might take a moment

457
00:21:55,960 --> 00:22:02,290
to load will leave that will let's see

458
00:21:58,630 --> 00:22:04,690
if I can open a new one yeah there we go

459
00:22:02,290 --> 00:22:06,580
okay so and we can start seeing all the

460
00:22:04,690 --> 00:22:08,560
individual devices that are listed in

461
00:22:06,580 --> 00:22:10,149
here we can immediately click on a

462
00:22:08,560 --> 00:22:12,399
device I don't know who this device this

463
00:22:10,150 --> 00:22:14,230
is but we can get some basic information

464
00:22:12,400 --> 00:22:16,720
about this device who the manufacturer

465
00:22:14,230 --> 00:22:19,330
is this based off of the MAC address

466
00:22:16,720 --> 00:22:21,280
this one is currently unknown

467
00:22:19,330 --> 00:22:24,270
and we can see just some base

468
00:22:21,280 --> 00:22:26,860
information so it's really nice kids met

469
00:22:24,270 --> 00:22:33,389
so this is this information is pulling

470
00:22:26,860 --> 00:22:33,389
from kismet using the API interesting

471
00:22:34,740 --> 00:22:42,790
server crash wait no it's still running

472
00:22:38,730 --> 00:22:45,820
in the world okay there we go

473
00:22:42,790 --> 00:22:48,490
okay just need to reload the page so

474
00:22:45,820 --> 00:22:49,780
this is the full UI so that dashboard I

475
00:22:48,490 --> 00:22:53,290
was showing you is just a plug in the

476
00:22:49,780 --> 00:22:56,970
Kintaro had made this is the full UI the

477
00:22:53,290 --> 00:23:00,580
full user interface for kismet and

478
00:22:56,970 --> 00:23:02,980
basically the creator of kids mint has

479
00:23:00,580 --> 00:23:04,780
done a really good job of allowing us to

480
00:23:02,980 --> 00:23:06,940
quickly access very important

481
00:23:04,780 --> 00:23:11,110
information about our network whether

482
00:23:06,940 --> 00:23:13,180
you're a blue team or if you're doing

483
00:23:11,110 --> 00:23:15,610
red team activities so a red team type

484
00:23:13,180 --> 00:23:18,040
of activity would be trying to capture

485
00:23:15,610 --> 00:23:19,780
the the the handshake or trying to

486
00:23:18,040 --> 00:23:23,950
understand what clients there are try to

487
00:23:19,780 --> 00:23:25,629
enumerate or get information about who's

488
00:23:23,950 --> 00:23:27,610
in the environment and then figuring out

489
00:23:25,630 --> 00:23:29,830
a way to manipulate them into connecting

490
00:23:27,610 --> 00:23:32,290
to your home network

491
00:23:29,830 --> 00:23:33,730
Mendon middle them or maybe denial

492
00:23:32,290 --> 00:23:35,170
service so then they'll connect to

493
00:23:33,730 --> 00:23:37,150
something else you'll want to do those

494
00:23:35,170 --> 00:23:40,360
types of behaviors as a red team and

495
00:23:37,150 --> 00:23:42,010
this tool allows us to quickly figure

496
00:23:40,360 --> 00:23:44,830
out that type of information so let's

497
00:23:42,010 --> 00:23:48,330
click on an access point this this one

498
00:23:44,830 --> 00:23:51,159
for code blue currently has 693

499
00:23:48,330 --> 00:23:53,230
connected devices that's a lot of

500
00:23:51,160 --> 00:23:54,730
devices on one access point we can see

501
00:23:53,230 --> 00:23:57,280
that the majority of the communication

502
00:23:54,730 --> 00:23:59,650
is happening on five to six in a little

503
00:23:57,280 --> 00:24:01,820
bleed over on to five to eight which

504
00:23:59,650 --> 00:24:04,520
it's probably it might be

505
00:24:01,820 --> 00:24:06,530
20 or 40 megahertz channel with I'm not

506
00:24:04,520 --> 00:24:07,879
sure I'd have to look at the packets but

507
00:24:06,530 --> 00:24:11,060
we can see the majority of the

508
00:24:07,880 --> 00:24:12,980
communication is data packets and so

509
00:24:11,060 --> 00:24:14,740
based on that we know that people are

510
00:24:12,980 --> 00:24:17,780
using that and getting a lot of

511
00:24:14,740 --> 00:24:19,850
communication streaming stuff probably

512
00:24:17,780 --> 00:24:22,190
pulling up things on their phone and

513
00:24:19,850 --> 00:24:23,840
then there's the LLC or management

514
00:24:22,190 --> 00:24:26,300
frames which are telling how the

515
00:24:23,840 --> 00:24:30,800
communication works and that's as much

516
00:24:26,300 --> 00:24:32,659
smaller portion so someone is doing bad

517
00:24:30,800 --> 00:24:35,570
things if somebody's trying to hack this

518
00:24:32,660 --> 00:24:39,050
or do something we might see these LLC

519
00:24:35,570 --> 00:24:40,610
frames much much higher because that

520
00:24:39,050 --> 00:24:42,409
would be someone trying to do like a

521
00:24:40,610 --> 00:24:43,969
deal indication attack or

522
00:24:42,410 --> 00:24:45,830
man-in-the-middle attack we're trying to

523
00:24:43,970 --> 00:24:48,110
do something to you to try to convince

524
00:24:45,830 --> 00:24:50,000
you to connect to their stuff or to get

525
00:24:48,110 --> 00:24:51,590
you to disconnect and that all happens

526
00:24:50,000 --> 00:24:54,020
at the management level so we would see

527
00:24:51,590 --> 00:24:55,760
a significant important of the

528
00:24:54,020 --> 00:24:59,000
management frames but this just looks

529
00:24:55,760 --> 00:25:02,990
like people are using the Wi-Fi so use

530
00:24:59,000 --> 00:25:05,960
on and then here if we look at the 802

531
00:25:02,990 --> 00:25:07,610
11 we can see that it's the SSID has

532
00:25:05,960 --> 00:25:10,370
been beacon doubt is this this is the

533
00:25:07,610 --> 00:25:13,939
bssid which is the MAC address of the

534
00:25:10,370 --> 00:25:19,669
broadcasting radio we can see that it's

535
00:25:13,940 --> 00:25:21,830
beacons a ton of times so we know that

536
00:25:19,670 --> 00:25:23,930
that's happening we can look at the

537
00:25:21,830 --> 00:25:25,760
different types of packets we can see if

538
00:25:23,930 --> 00:25:28,100
there's been data or if we've got

539
00:25:25,760 --> 00:25:29,210
fragmentation or if we have retry so

540
00:25:28,100 --> 00:25:32,120
that could be something that blue

541
00:25:29,210 --> 00:25:33,740
teamers use or just your IT staff use to

542
00:25:32,120 --> 00:25:35,239
be able to do analysis on your wireless

543
00:25:33,740 --> 00:25:37,130
infrastructure perhaps your wireless

544
00:25:35,240 --> 00:25:38,480
infrastructure is struggling you're

545
00:25:37,130 --> 00:25:41,450
having slow bandwidth you're having

546
00:25:38,480 --> 00:25:43,520
issues you can see all of that with an

547
00:25:41,450 --> 00:25:45,530
external tool now and be able to

548
00:25:43,520 --> 00:25:46,879
determine that and be able to track down

549
00:25:45,530 --> 00:25:48,920
those issues maybe it's a specific

550
00:25:46,880 --> 00:25:51,020
client that keeps having a lot of

551
00:25:48,920 --> 00:25:53,810
retries we'd be able to track that down

552
00:25:51,020 --> 00:25:58,639
like I said before one of the most handy

553
00:25:53,810 --> 00:26:00,590
things is to be able to do the WPA be

554
00:25:58,640 --> 00:26:02,450
able to capture the WPA handshake and

555
00:26:00,590 --> 00:26:05,060
since it's highlighted in red that means

556
00:26:02,450 --> 00:26:06,890
it's already accessible and since it's

557
00:26:05,060 --> 00:26:08,840
accessible I can just one click it

558
00:26:06,890 --> 00:26:09,929
download it and pull it open in

559
00:26:08,840 --> 00:26:13,619
Wireshark just

560
00:26:09,929 --> 00:26:15,690
quick and this is the EA pol of the

561
00:26:13,619 --> 00:26:18,959
handshake that took their that I

562
00:26:15,690 --> 00:26:21,360
captured and so from here it's now one

563
00:26:18,960 --> 00:26:23,700
step to be able to take this and put it

564
00:26:21,360 --> 00:26:25,799
into hash CAD to be able to be in begin

565
00:26:23,700 --> 00:26:28,679
cracking it so if I was doing a pen test

566
00:26:25,799 --> 00:26:31,320
on this infrastructure that quick for me

567
00:26:28,679 --> 00:26:33,210
to get this access point and try to get

568
00:26:31,320 --> 00:26:36,509
the password so that's why I always

569
00:26:33,210 --> 00:26:39,269
recommend if you do use WPA personal

570
00:26:36,509 --> 00:26:42,600
with a passphrase make sure that it is

571
00:26:39,269 --> 00:26:44,419
at least 12 to 15 characters to 12 or

572
00:26:42,600 --> 00:26:48,360
longer characters so that that way

573
00:26:44,419 --> 00:26:52,559
you're able to avoid someone like me

574
00:26:48,360 --> 00:26:54,928
that's gonna crack your network also we

575
00:26:52,559 --> 00:26:58,110
can see channel utilization so we can

576
00:26:54,929 --> 00:27:00,869
see how much Wireless is based on the QB

577
00:26:58,110 --> 00:27:02,789
ESS see how much the clients are

578
00:27:00,869 --> 00:27:05,610
communicating in a single time and as

579
00:27:02,789 --> 00:27:07,259
you can see it is doing HT 40 mode so

580
00:27:05,610 --> 00:27:11,219
that means it's 40 megahertz channel

581
00:27:07,259 --> 00:27:13,200
width on this channel if we can also see

582
00:27:11,220 --> 00:27:14,580
what the beacon rate is we can like just

583
00:27:13,200 --> 00:27:16,169
lots of really cool stuff we can see we

584
00:27:14,580 --> 00:27:18,360
can also see what the country code is

585
00:27:16,169 --> 00:27:22,320
set to obviously we're in Japan but

586
00:27:18,360 --> 00:27:24,360
that's useful for let's say we're in the

587
00:27:22,320 --> 00:27:25,860
United States and someone has their

588
00:27:24,360 --> 00:27:27,360
country code set to Japan and there's

589
00:27:25,860 --> 00:27:29,070
specific channels that are illegal to

590
00:27:27,360 --> 00:27:32,729
broadcast on I could then detect that

591
00:27:29,070 --> 00:27:35,158
just using the software here and then in

592
00:27:32,730 --> 00:27:37,549
addition to this we can also see shared

593
00:27:35,159 --> 00:27:42,389
hardware so this means that these are

594
00:27:37,549 --> 00:27:44,519
access points or devices that are likely

595
00:27:42,389 --> 00:27:47,879
connected because they're doing similar

596
00:27:44,519 --> 00:27:50,610
types of behavior so for example they're

597
00:27:47,879 --> 00:27:53,459
doing virtual access points as far as I

598
00:27:50,610 --> 00:27:54,658
can tell with the code blue private Culp

599
00:27:53,460 --> 00:27:58,110
code blue

600
00:27:54,659 --> 00:28:01,679
the free Wi-Fi and the core ok I don't

601
00:27:58,110 --> 00:28:04,110
know how you say that but essentially

602
00:28:01,679 --> 00:28:07,950
they are all seemingly coming from very

603
00:28:04,110 --> 00:28:10,019
similar MAC addresses this 0 0 for e CBE

604
00:28:07,950 --> 00:28:13,539
for 3 and I believe that's a rubra MAC

605
00:28:10,019 --> 00:28:16,120
address if we go and look at

606
00:28:13,539 --> 00:28:18,039
the view that APD tells it's saying

607
00:28:16,120 --> 00:28:19,870
hewlett-packard but I do believe HP

608
00:28:18,039 --> 00:28:21,520
bought Aruba or something like that or

609
00:28:19,870 --> 00:28:25,239
somehow it's in that in that oh you I

610
00:28:21,520 --> 00:28:27,158
for that so we can now look like I just

611
00:28:25,240 --> 00:28:30,460
took one hop over and we can look at

612
00:28:27,159 --> 00:28:31,900
this device see what its beaconing see

613
00:28:30,460 --> 00:28:33,820
what's happening and then see what the

614
00:28:31,900 --> 00:28:37,090
analysis thought is on this access point

615
00:28:33,820 --> 00:28:40,539
so it's very handy very useful for

616
00:28:37,090 --> 00:28:43,449
breaking down and doing the analysis we

617
00:28:40,539 --> 00:28:46,419
can further then look at the different

618
00:28:43,450 --> 00:28:48,850
clients so we have Wi-Fi behavior which

619
00:28:46,419 --> 00:28:51,909
is when you have a client using multiple

620
00:28:48,850 --> 00:28:53,500
networks over time and it's also nice

621
00:28:51,909 --> 00:28:54,549
there's all these little help buttons so

622
00:28:53,500 --> 00:28:56,470
if you don't know what something is you

623
00:28:54,549 --> 00:28:58,600
can just click on it too and we can also

624
00:28:56,470 --> 00:29:00,159
see the Associated clients so these

625
00:28:58,600 --> 00:29:02,830
clients are like clients that are

626
00:29:00,159 --> 00:29:04,929
roaming and these clients are like our

627
00:29:02,830 --> 00:29:07,720
phones laptops and all sorts of devices

628
00:29:04,929 --> 00:29:12,820
that are connected so let's say that

629
00:29:07,720 --> 00:29:14,950
this device is causing problems we can

630
00:29:12,820 --> 00:29:19,470
immediately click View client details we

631
00:29:14,950 --> 00:29:19,470
can add a note that potential issue

632
00:29:20,810 --> 00:29:26,120
and then we can save that note and we

633
00:29:23,930 --> 00:29:27,770
can now like keep track of who this is

634
00:29:26,120 --> 00:29:30,469
and what they're doing and we can see

635
00:29:27,770 --> 00:29:33,379
then we look at the 802 11 graph here

636
00:29:30,470 --> 00:29:35,690
let's see what it's done client behavior

637
00:29:33,380 --> 00:29:38,180
- all of these access points okay so

638
00:29:35,690 --> 00:29:41,720
what are these access points we didn't

639
00:29:38,180 --> 00:29:44,120
capture which one that one was we're not

640
00:29:41,720 --> 00:29:46,190
sure which one that one was and see

641
00:29:44,120 --> 00:29:48,080
there's see how it's zero bytes I just

642
00:29:46,190 --> 00:29:49,370
saw them beginning or communicating but

643
00:29:48,080 --> 00:29:51,439
I didn't actually see any data

644
00:29:49,370 --> 00:29:54,699
communicated throughout them so this

645
00:29:51,440 --> 00:29:54,700
one's actually kind of a bad example

646
00:29:59,020 --> 00:30:08,120
Intel - ah here we go so this one probed

647
00:30:06,470 --> 00:30:10,940
for a code blue

648
00:30:08,120 --> 00:30:13,820
and it also probed a broadcast so this

649
00:30:10,940 --> 00:30:17,450
one based on probing to broadcast it

650
00:30:13,820 --> 00:30:20,240
might be susceptible to a karma attack

651
00:30:17,450 --> 00:30:22,220
or basically a man-in-the-middle attack

652
00:30:20,240 --> 00:30:24,200
where I could set up an access point

653
00:30:22,220 --> 00:30:27,410
because it basically is broadcasting and

654
00:30:24,200 --> 00:30:30,080
probing and saying hey is any network

655
00:30:27,410 --> 00:30:31,610
available that I want to connect to and

656
00:30:30,080 --> 00:30:33,199
so that might be a device that we could

657
00:30:31,610 --> 00:30:36,439
manipulate if you were trying to do man

658
00:30:33,200 --> 00:30:39,440
in the middle attack on that okay let's

659
00:30:36,440 --> 00:30:41,900
back out at this just a little bit and

660
00:30:39,440 --> 00:30:44,360
so I'm going to show you we already saw

661
00:30:41,900 --> 00:30:46,040
the devices the data sources so we can

662
00:30:44,360 --> 00:30:48,530
see that the 13 devices and which

663
00:30:46,040 --> 00:30:51,680
devices are pushing the most traffic so

664
00:30:48,530 --> 00:30:53,450
one of the things I've done is based on

665
00:30:51,680 --> 00:30:56,180
the environment I looked at the number

666
00:30:53,450 --> 00:30:59,570
of clients that we have and I've looked

667
00:30:56,180 --> 00:31:01,220
at the channel so channel 52 132 60

668
00:30:59,570 --> 00:31:06,139
these ones are pretty heavily used

669
00:31:01,220 --> 00:31:09,110
channels so I decided to fix some of the

670
00:31:06,140 --> 00:31:11,660
channels so some of the radios are

671
00:31:09,110 --> 00:31:13,610
bouncing between channels or channel

672
00:31:11,660 --> 00:31:16,730
hopping is what it's referred to as and

673
00:31:13,610 --> 00:31:19,340
then I've fixed some of these others you

674
00:31:16,730 --> 00:31:22,220
can see this one here is fixed and this

675
00:31:19,340 --> 00:31:24,020
one here is fixed so basically what that

676
00:31:22,220 --> 00:31:26,330
means is I'm going to be listening on

677
00:31:24,020 --> 00:31:29,799
those channels constantly so that that

678
00:31:26,330 --> 00:31:34,120
way I get the most amount of information

679
00:31:29,799 --> 00:31:36,700
and so the the advantage of that is that

680
00:31:34,120 --> 00:31:38,500
I can get more communication because

681
00:31:36,700 --> 00:31:40,600
it's not switching channels because

682
00:31:38,500 --> 00:31:41,980
every time you switch channels you're

683
00:31:40,600 --> 00:31:44,230
going to miss out on some of the

684
00:31:41,980 --> 00:31:45,520
communication so that's one of the new

685
00:31:44,230 --> 00:31:48,160
things that I'm working on I'm actually

686
00:31:45,520 --> 00:31:50,260
last night with Kent Aras help started

687
00:31:48,160 --> 00:31:52,150
building a script where I want to do

688
00:31:50,260 --> 00:31:54,070
this automatically

689
00:31:52,150 --> 00:31:56,410
where I'm able to do the auto

690
00:31:54,070 --> 00:31:59,110
identifying of a network identify the

691
00:31:56,410 --> 00:32:01,450
highest use channels and then have it

692
00:31:59,110 --> 00:32:03,100
switch maybe three or four radios on to

693
00:32:01,450 --> 00:32:05,590
the top highest channels so I can get

694
00:32:03,100 --> 00:32:07,689
the most amount of data captured for my

695
00:32:05,590 --> 00:32:09,939
analysis because that's always been an

696
00:32:07,690 --> 00:32:13,120
issue and I'll show you the reason why

697
00:32:09,940 --> 00:32:17,620
this is the Wi-Fi cactus now we'll look

698
00:32:13,120 --> 00:32:19,780
at the same graph the channel hopping so

699
00:32:17,620 --> 00:32:21,729
it's a much bigger swath of connection

700
00:32:19,780 --> 00:32:24,580
that's happening because currently

701
00:32:21,730 --> 00:32:26,290
there's 48 radios that are active two of

702
00:32:24,580 --> 00:32:28,000
them are not up for some reason I'm not

703
00:32:26,290 --> 00:32:34,510
sure what's going on looks like maybe

704
00:32:28,000 --> 00:32:36,669
the top one is kind of sleepy so

705
00:32:34,510 --> 00:32:38,669
basically there's 48 radios currently

706
00:32:36,669 --> 00:32:40,900
out of the 50 that are currently

707
00:32:38,669 --> 00:32:45,910
capturing things the goal with the

708
00:32:40,900 --> 00:32:49,030
cactus was to not have any radios to the

709
00:32:45,910 --> 00:32:51,940
excuse me to have as much wireless

710
00:32:49,030 --> 00:32:54,040
spectrum coverage as possible and as you

711
00:32:51,940 --> 00:32:58,230
can see if we compare this channel

712
00:32:54,040 --> 00:32:58,230
hopping graph to this one

713
00:32:59,270 --> 00:33:17,129
it's quite a difference so yeah so the

714
00:33:14,490 --> 00:33:19,590
the cactus solves that problem but like

715
00:33:17,130 --> 00:33:22,380
I said before it's the problem is with

716
00:33:19,590 --> 00:33:24,149
the cactus is the bandwidth limitations

717
00:33:22,380 --> 00:33:29,340
the throughput limitations of the

718
00:33:24,150 --> 00:33:31,200
Ethernet ports so alright let's see how

719
00:33:29,340 --> 00:33:35,909
are we on time I think I've got 20 more

720
00:33:31,200 --> 00:33:40,530
minutes is that right okay alright so on

721
00:33:35,910 --> 00:33:42,390
the Wi-Fi cactus so essentially we've

722
00:33:40,530 --> 00:33:44,700
got the same type of interface here but

723
00:33:42,390 --> 00:33:48,240
I'm basically capturing data at a much

724
00:33:44,700 --> 00:33:52,170
higher rate because of all of the radios

725
00:33:48,240 --> 00:33:53,970
that are in here and so let's see the

726
00:33:52,170 --> 00:33:58,559
other thing too I want to show you as

727
00:33:53,970 --> 00:34:01,620
well down here in the messages we'll see

728
00:33:58,559 --> 00:34:03,770
if anything pops up kismet also has

729
00:34:01,620 --> 00:34:06,629
built into it something called a

730
00:34:03,770 --> 00:34:10,199
intrusion detection system or IDs and

731
00:34:06,630 --> 00:34:12,570
there are certain signatures that it's

732
00:34:10,199 --> 00:34:15,000
built to identify some of those

733
00:34:12,570 --> 00:34:17,940
signatures are if someone does a

734
00:34:15,000 --> 00:34:22,230
man-in-the-middle attack or if they do a

735
00:34:17,940 --> 00:34:24,389
deal and occasionally what are some of

736
00:34:22,230 --> 00:34:27,330
the other ones if someone were to launch

737
00:34:24,389 --> 00:34:29,159
a cracks attack cracked the key in story

738
00:34:27,330 --> 00:34:32,279
installation attack it will do

739
00:34:29,159 --> 00:34:33,750
identification for that broad pone the

740
00:34:32,280 --> 00:34:35,820
broad common corner ability wireless

741
00:34:33,750 --> 00:34:39,629
vulnerability it does have support to

742
00:34:35,820 --> 00:34:42,659
identify that it also looks for other

743
00:34:39,629 --> 00:34:45,540
weird things weird cases - such as if

744
00:34:42,659 --> 00:34:49,740
someone uses an SSID that is longer than

745
00:34:45,540 --> 00:34:53,340
32 bytes that's that's something that it

746
00:34:49,739 --> 00:34:54,959
could show malformed behavior or it

747
00:34:53,340 --> 00:34:58,350
could do some damage because that's

748
00:34:54,960 --> 00:35:00,150
longer than the spec and so that's some

749
00:34:58,350 --> 00:35:02,040
way that's a way that

750
00:35:00,150 --> 00:35:03,480
if they can be identified and to see if

751
00:35:02,040 --> 00:35:04,830
someone's trying to do something tricky

752
00:35:03,480 --> 00:35:08,220
maybe they're trying to do an injection

753
00:35:04,830 --> 00:35:11,880
based off of SSID yeah so for example

754
00:35:08,220 --> 00:35:12,660
right there we just got a nonce I went

755
00:35:11,880 --> 00:35:14,820
by too quick

756
00:35:12,660 --> 00:35:17,848
there's too many devices I'll have to go

757
00:35:14,820 --> 00:35:19,920
back and look in the logs basically that

758
00:35:17,849 --> 00:35:21,150
was a I believe it was a nonce recycles

759
00:35:19,920 --> 00:35:23,930
so that could have been legitimate

760
00:35:21,150 --> 00:35:27,960
behavior of a wireless access point

761
00:35:23,930 --> 00:35:29,399
renewing its encryption or it could have

762
00:35:27,960 --> 00:35:30,780
been somebody doing it on purpose the

763
00:35:29,400 --> 00:35:32,280
fact that we're not seeing a ton of them

764
00:35:30,780 --> 00:35:34,890
that's the thing about Wireless attacks

765
00:35:32,280 --> 00:35:36,599
they're usually very noisy they're

766
00:35:34,890 --> 00:35:38,460
usually doing a lot of things at once

767
00:35:36,599 --> 00:35:41,010
the fact that we only see it once is

768
00:35:38,460 --> 00:35:42,630
probably benign behavior it's probably

769
00:35:41,010 --> 00:35:46,410
something built into the access point

770
00:35:42,630 --> 00:35:47,970
yeah WPA the apol are SN reuse yeah so

771
00:35:46,410 --> 00:35:49,379
that's probably just something that's

772
00:35:47,970 --> 00:35:51,720
happening with the access point that's

773
00:35:49,380 --> 00:35:54,240
throwing out that warning but if someone

774
00:35:51,720 --> 00:35:57,839
had a pony gachi has anyone heard of the

775
00:35:54,240 --> 00:36:02,729
pony gotchas a couple hands I think do

776
00:35:57,840 --> 00:36:05,010
you have one sir not yet the pony gachi

777
00:36:02,730 --> 00:36:07,740
essentially what it is is have you heard

778
00:36:05,010 --> 00:36:11,790
of Tamagotchis of course you have n

779
00:36:07,740 --> 00:36:14,609
right it's it's it's this cute little

780
00:36:11,790 --> 00:36:16,770
device that was created to do T

781
00:36:14,609 --> 00:36:19,859
authentication attacks as you walk

782
00:36:16,770 --> 00:36:22,470
around it uses a Raspberry Pi and Inc

783
00:36:19,859 --> 00:36:25,259
print screen and it's got a cute little

784
00:36:22,470 --> 00:36:27,089
face and all it does is D authenticate a

785
00:36:25,260 --> 00:36:34,650
wireless network and then capture the

786
00:36:27,089 --> 00:36:36,359
handshake silly people and so if someone

787
00:36:34,650 --> 00:36:38,460
were to bring one of those in here and

788
00:36:36,359 --> 00:36:40,560
launch that our Wi-Fi might stop working

789
00:36:38,460 --> 00:36:42,450
but I would be able to see that that

790
00:36:40,560 --> 00:36:45,359
attack took place so I'd be able to see

791
00:36:42,450 --> 00:36:48,868
it of hone agachi take place in this

792
00:36:45,359 --> 00:36:50,339
environment okay I definitely want to

793
00:36:48,869 --> 00:36:51,900
leave time for questions and for you

794
00:36:50,339 --> 00:36:53,700
guys to come up and look at things and

795
00:36:51,900 --> 00:36:54,790
and stuff like that so I'm gonna go

796
00:36:53,700 --> 00:36:58,600
ahead and end

797
00:36:54,790 --> 00:37:00,490
formal portion of the this presentation

798
00:36:58,600 --> 00:37:02,799
and then will will allow the questions

799
00:37:00,490 --> 00:37:04,540
and you guys can come up and look and I

800
00:37:02,800 --> 00:37:07,480
do have some stickers I don't have

801
00:37:04,540 --> 00:37:09,100
enough for everyone I apologize but I

802
00:37:07,480 --> 00:37:10,720
will hand out as many as I can and if

803
00:37:09,100 --> 00:37:13,000
you're coming to AV Tokyo I'll have some

804
00:37:10,720 --> 00:37:21,310
more there so thank you so much for your

805
00:37:13,000 --> 00:37:39,160
time I appreciate it thank you okay

806
00:37:21,310 --> 00:37:41,290
questions yes I would love to cellular

807
00:37:39,160 --> 00:37:43,180
it's already built in I just don't have

808
00:37:41,290 --> 00:37:45,820
the modules activated I don't have a

809
00:37:43,180 --> 00:37:48,730
card for this a Bluetooth card you just

810
00:37:45,820 --> 00:37:50,860
need a UD 100 or just a dumb Bluetooth

811
00:37:48,730 --> 00:37:52,330
device to be able to capture it's

812
00:37:50,860 --> 00:37:56,380
basically looking for Bluetooth and

813
00:37:52,330 --> 00:37:57,850
believe beacons on the cactus I did have

814
00:37:56,380 --> 00:38:00,280
it with I don't have it currently the

815
00:37:57,850 --> 00:38:02,080
Nook actually has Bluetooth built in but

816
00:38:00,280 --> 00:38:04,480
I don't have this dashboard on that on

817
00:38:02,080 --> 00:38:08,529
the cactus but that's built into kismet

818
00:38:04,480 --> 00:38:10,810
in addition to that you can do RTL 433

819
00:38:08,530 --> 00:38:13,540
so if you hook up an SDR to kismet it

820
00:38:10,810 --> 00:38:16,360
will start gathering 433 and decode

821
00:38:13,540 --> 00:38:19,810
those packets for different IOT devices

822
00:38:16,360 --> 00:38:23,800
that are on 433 megahertz in addition a

823
00:38:19,810 --> 00:38:27,370
DSP was just added to I don't have an a

824
00:38:23,800 --> 00:38:29,920
DSP adapter but a DSP is the signal that

825
00:38:27,370 --> 00:38:33,180
airplanes send out to be able to test

826
00:38:29,920 --> 00:38:35,590
tell their geolocation their altitude

827
00:38:33,180 --> 00:38:38,080
latitude longitude all that good stuff

828
00:38:35,590 --> 00:38:41,560
and then it will map it inside of here

829
00:38:38,080 --> 00:38:44,860
so kismet really is turning into a full

830
00:38:41,560 --> 00:38:50,500
wireless analysis software so through

831
00:38:44,860 --> 00:38:53,770
rtl-sdr a DSP Bluetooth Wi-Fi basically

832
00:38:50,500 --> 00:38:55,300
the whole spectrum I

833
00:38:53,770 --> 00:38:57,220
the cellular is a little bit more

834
00:38:55,300 --> 00:38:59,170
difficult to do monitoring on because

835
00:38:57,220 --> 00:39:00,520
you need an active connection to be able

836
00:38:59,170 --> 00:39:03,310
to do monitoring has been my experience

837
00:39:00,520 --> 00:39:05,770
so that's an area of interest I have

838
00:39:03,310 --> 00:39:07,630
definitely am working towards because I

839
00:39:05,770 --> 00:39:09,520
get that question a lot on that I want

840
00:39:07,630 --> 00:39:10,420
to know what's going on in itself so but

841
00:39:09,520 --> 00:39:12,670
I'm not there yet

842
00:39:10,420 --> 00:39:15,640
so hopefully in the future I could have

843
00:39:12,670 --> 00:39:20,490
some research in the 4G 5g arena that's

844
00:39:15,640 --> 00:39:20,490
my goal so thank you other questions

845
00:39:25,920 --> 00:39:30,940
okay the question is how much does it

846
00:39:28,660 --> 00:39:32,680
cost to create the Kraken and the cactus

847
00:39:30,940 --> 00:39:33,970
the cactus was a little bit more

848
00:39:32,680 --> 00:39:36,819
expensive but luckily it was a

849
00:39:33,970 --> 00:39:41,950
sponsorship but the retail cost on that

850
00:39:36,820 --> 00:39:46,060
would be about $6,000 u.s. u.s. was that

851
00:39:41,950 --> 00:39:48,189
six hundred six hundred thousand yen is

852
00:39:46,060 --> 00:39:49,450
that right I don't know I can't remember

853
00:39:48,190 --> 00:39:52,450
what the conversion rate is something

854
00:39:49,450 --> 00:39:55,270
like that and then this one is a lot

855
00:39:52,450 --> 00:39:59,080
cheaper the motherboard is actually an

856
00:39:55,270 --> 00:40:02,050
old fourth chin Intel processor so

857
00:39:59,080 --> 00:40:04,119
that's probably like $50 on eBay the

858
00:40:02,050 --> 00:40:07,510
wireless adapters are about twenty-five

859
00:40:04,119 --> 00:40:09,130
dollars each so I would say maybe four

860
00:40:07,510 --> 00:40:10,750
to five hundred dollars to build this

861
00:40:09,130 --> 00:40:12,340
and then and then the case was about a

862
00:40:10,750 --> 00:40:14,619
hundred and fifty dollars for this

863
00:40:12,340 --> 00:40:16,960
hardened it's not even a Pelican case

864
00:40:14,619 --> 00:40:19,210
it's a ripoff case called condition one

865
00:40:16,960 --> 00:40:22,960
but it works pretty well so it's a bit

866
00:40:19,210 --> 00:40:25,359
cheaper the batteries are $45 a piece as

867
00:40:22,960 --> 00:40:27,730
well for the batteries so I would say

868
00:40:25,359 --> 00:40:29,980
five to six hundred dollars to build

869
00:40:27,730 --> 00:40:32,680
something like this and if you want to

870
00:40:29,980 --> 00:40:35,680
get started you could take a laptop one

871
00:40:32,680 --> 00:40:37,839
of these adapters and run Linux pen to

872
00:40:35,680 --> 00:40:40,629
Linux or a bun to the latest version of

873
00:40:37,840 --> 00:40:42,880
a bun to plug the adapter in installed

874
00:40:40,630 --> 00:40:44,560
kismet and you could get started and do

875
00:40:42,880 --> 00:40:47,140
the similar things that I'm doing here

876
00:40:44,560 --> 00:40:49,290
so it's that if that easy for you to

877
00:40:47,140 --> 00:40:51,569
start doing analysis on the white line

878
00:40:49,290 --> 00:40:56,820
thank you for your question

879
00:40:51,570 --> 00:40:58,740
any other questions other questions feel

880
00:40:56,820 --> 00:41:03,590
free to come up here and if you think of

881
00:40:58,740 --> 00:41:03,589
anything else just shout it out at name

882
00:41:03,620 --> 00:41:07,069
thank you so much

