1
00:00:06,630 --> 00:00:11,670
hi everyone welcome to my talk

2
00:00:08,900 --> 00:00:14,309
leveraging Yahoo's to hunt for abuse

3
00:00:11,670 --> 00:00:16,410
telegram accounts I want to start by

4
00:00:14,309 --> 00:00:19,110
asking you all how many of you are

5
00:00:16,410 --> 00:00:23,939
members of illegal groups all channels

6
00:00:19,110 --> 00:00:27,570
on telegram okay I understand why nobody

7
00:00:23,939 --> 00:00:30,300
raises their hands let's begin in my

8
00:00:27,570 --> 00:00:32,970
research I found that almost 50% of the

9
00:00:30,300 --> 00:00:36,590
telegram accounts that I checked abuse

10
00:00:32,970 --> 00:00:38,850
the Platt phone in one way or the other

11
00:00:36,590 --> 00:00:41,370
let's start by telling you the six

12
00:00:38,850 --> 00:00:43,680
takeaways for my talk the first thing is

13
00:00:41,370 --> 00:00:46,110
that I will show you how you can use IOT

14
00:00:43,680 --> 00:00:48,690
global search engine for your own

15
00:00:46,110 --> 00:00:51,750
purpose in my case I use it to hunt for

16
00:00:48,690 --> 00:00:53,430
abuse telegram accounts the second thing

17
00:00:51,750 --> 00:00:55,500
is that you will understand how to

18
00:00:53,430 --> 00:00:58,920
leverage our rules to hunt anything you

19
00:00:55,500 --> 00:01:01,050
want and not only malware for the ones

20
00:00:58,920 --> 00:01:03,539
of you that work is Redeemers I will

21
00:01:01,050 --> 00:01:06,810
show you how to use telegram to create a

22
00:01:03,539 --> 00:01:09,060
community control server and for those

23
00:01:06,810 --> 00:01:10,830
that are on the blue side I will show

24
00:01:09,060 --> 00:01:14,490
you how to protect yourself from such

25
00:01:10,830 --> 00:01:16,560
kind of threat and what nesting I hope

26
00:01:14,490 --> 00:01:21,119
you'll get ideas for next talk just like

27
00:01:16,560 --> 00:01:23,880
happened to me I'm opposed by the head

28
00:01:21,119 --> 00:01:26,759
of research of repose of I reported an

29
00:01:23,880 --> 00:01:28,949
IOT global search engine which protects

30
00:01:26,759 --> 00:01:32,400
company's assets by scanning all of the

31
00:01:28,950 --> 00:01:34,079
global internet on a daily base to

32
00:01:32,400 --> 00:01:37,259
perform that research I had to take

33
00:01:34,079 --> 00:01:38,850
advantage of raposa feist data I am

34
00:01:37,259 --> 00:01:41,759
passionate about helping the community

35
00:01:38,850 --> 00:01:44,039
especially with Charles you can find

36
00:01:41,759 --> 00:01:47,100
some of my created rules on the fish of

37
00:01:44,040 --> 00:01:49,079
github of URLs I'm the creator of the

38
00:01:47,100 --> 00:01:52,469
known tool coffee shot which I was

39
00:01:49,079 --> 00:01:54,899
presented at blackhat us 8 2018 and

40
00:01:52,469 --> 00:01:58,219
lastly I'm excited to be here for my

41
00:01:54,899 --> 00:02:01,200
first time at code blue Japan

42
00:01:58,219 --> 00:02:04,140
what is cybercrime cybercrime is

43
00:02:01,200 --> 00:02:06,030
criminal in a chronica a cyber crime and

44
00:02:04,140 --> 00:02:08,660
criminal activity that involves a

45
00:02:06,030 --> 00:02:11,070
computer or other networking device

46
00:02:08,660 --> 00:02:14,940
there is a long list of cyber crimes

47
00:02:11,070 --> 00:02:17,540
such as fraud money laundering identity

48
00:02:14,940 --> 00:02:20,180
theft as well as many others

49
00:02:17,540 --> 00:02:22,099
in the past if you wanted to get into

50
00:02:20,180 --> 00:02:25,040
the cybercrime districts you'll have to

51
00:02:22,099 --> 00:02:27,230
be in hacker or colder over the years it

52
00:02:25,040 --> 00:02:29,239
has become easier to enter the darknet

53
00:02:27,230 --> 00:02:32,569
and it's come to the point of using

54
00:02:29,239 --> 00:02:34,700
Google to find darknets darknets markets

55
00:02:32,569 --> 00:02:36,859
or website that publishes the latest

56
00:02:34,700 --> 00:02:39,290
darknet market links on the darknet

57
00:02:36,860 --> 00:02:42,860
however the darknet is a difficult place

58
00:02:39,290 --> 00:02:44,358
to navigate it is complex and risky it

59
00:02:42,860 --> 00:02:47,150
is correct that anyone with the tor

60
00:02:44,359 --> 00:02:49,010
browser can get in the dark net but it

61
00:02:47,150 --> 00:02:51,049
will take them some time to find the

62
00:02:49,010 --> 00:02:53,030
phones with the close chat rooms where

63
00:02:51,049 --> 00:02:56,900
people are selling the most evilest

64
00:02:53,030 --> 00:02:59,389
items the dark that is the hive of

65
00:02:56,900 --> 00:03:02,180
illegal activities start starting from

66
00:02:59,389 --> 00:03:05,269
drug dealing selling of guns stolen

67
00:03:02,180 --> 00:03:08,599
credit cards ransomware service and

68
00:03:05,269 --> 00:03:11,180
illegal pornography buyers and sellers

69
00:03:08,599 --> 00:03:15,379
use this medium to trade and exchange

70
00:03:11,180 --> 00:03:16,970
both knowledge and products this is of

71
00:03:15,379 --> 00:03:21,048
course and killed the wrong game of the

72
00:03:16,970 --> 00:03:23,000
law comes in and shut them down the

73
00:03:21,049 --> 00:03:26,780
takedown of such darkness marketplaces

74
00:03:23,000 --> 00:03:29,510
hence a market alpha bay a dream market

75
00:03:26,780 --> 00:03:32,030
by the law across the world made Halen

76
00:03:29,510 --> 00:03:34,910
news from time to time and served as the

77
00:03:32,030 --> 00:03:38,030
latest example of how this cat-and-mouse

78
00:03:34,910 --> 00:03:40,340
game works while there are still

79
00:03:38,030 --> 00:03:43,129
numerous websites operating under the

80
00:03:40,340 --> 00:03:46,549
same premises in both clear net and dark

81
00:03:43,129 --> 00:03:51,138
net the previous examples just indicate

82
00:03:46,549 --> 00:03:53,329
how vulnerable these sites can be for

83
00:03:51,139 --> 00:03:55,519
mahaki will be into a capitalist market

84
00:03:53,329 --> 00:03:57,739
as long as there are illegal products

85
00:03:55,519 --> 00:04:00,349
and money to be made there will always

86
00:03:57,739 --> 00:04:04,000
be criminal invaders developing new ways

87
00:04:00,349 --> 00:04:06,709
to trade the darknet users customers

88
00:04:04,000 --> 00:04:09,440
seem safe rich to the same conclusion -

89
00:04:06,709 --> 00:04:13,760
as well as migrating to more secure and

90
00:04:09,440 --> 00:04:15,440
easily accessible platform from the

91
00:04:13,760 --> 00:04:17,209
criminal perspective it wasn't long

92
00:04:15,440 --> 00:04:19,430
before the shifted to new channels on

93
00:04:17,209 --> 00:04:22,970
the surface to evade the law and

94
00:04:19,430 --> 00:04:24,860
continue their cybercrime an example of

95
00:04:22,970 --> 00:04:26,479
such a channel is the increased lip

96
00:04:24,860 --> 00:04:30,380
popular mobile and messaging app

97
00:04:26,479 --> 00:04:31,430
telegram to continue their cybercrime in

98
00:04:30,380 --> 00:04:33,409
my research I found

99
00:04:31,430 --> 00:04:36,110
Telecom has become a popular tool for

100
00:04:33,410 --> 00:04:38,390
delivering cybercrime so let's dive in

101
00:04:36,110 --> 00:04:40,100
into the presentation and understand why

102
00:04:38,390 --> 00:04:44,750
telecom becomes so popular for

103
00:04:40,100 --> 00:04:46,940
cybercrime Telecom itself launched in

104
00:04:44,750 --> 00:04:49,790
2013 and it's encrypted instant

105
00:04:46,940 --> 00:04:53,540
messaging application with 200 million

106
00:04:49,790 --> 00:04:54,440
active users monthly however what sets

107
00:04:53,540 --> 00:04:57,260
telecom apart

108
00:04:54,440 --> 00:04:59,500
among other features is the pride place

109
00:04:57,260 --> 00:05:02,180
on their approved security capabilities

110
00:04:59,500 --> 00:05:06,680
included prevent end-to-end encrypted

111
00:05:02,180 --> 00:05:08,950
chats the telegram app allows you to

112
00:05:06,680 --> 00:05:11,780
create groups with up to 30,000 members

113
00:05:08,950 --> 00:05:14,360
goofs can be best described as close

114
00:05:11,780 --> 00:05:18,200
chat rooms in which all members can read

115
00:05:14,360 --> 00:05:20,530
comment and post in Marisa found is the

116
00:05:18,200 --> 00:05:22,820
place where cyber criminals advertise

117
00:05:20,530 --> 00:05:25,669
connect and share knowledge and

118
00:05:22,820 --> 00:05:28,390
compromised information just like what

119
00:05:25,670 --> 00:05:30,800
happens in the close dark web phones

120
00:05:28,390 --> 00:05:32,810
telecom also is a nice feature called

121
00:05:30,800 --> 00:05:34,670
channels that can be used to broadcast

122
00:05:32,810 --> 00:05:37,580
messages to an unlimited number of

123
00:05:34,670 --> 00:05:40,670
subscribers and their aunt an amazing

124
00:05:37,580 --> 00:05:42,349
history can be viewed atticus many news

125
00:05:40,670 --> 00:05:45,830
telecom channels to advertise fraud

126
00:05:42,350 --> 00:05:47,990
services and products another thing is

127
00:05:45,830 --> 00:05:50,270
that the implementation sorry another

128
00:05:47,990 --> 00:05:52,940
thing is that by using telegram you have

129
00:05:50,270 --> 00:05:55,460
the option to share files of nearly any

130
00:05:52,940 --> 00:05:58,550
type in my research I found malicious

131
00:05:55,460 --> 00:06:00,739
use of that feature by telegram command

132
00:05:58,550 --> 00:06:03,110
control servers that contain zip files

133
00:06:00,740 --> 00:06:06,770
with the stolen data from the victim

134
00:06:03,110 --> 00:06:09,320
computer another benefit of using

135
00:06:06,770 --> 00:06:12,140
telegram from cybercrime is that anyone

136
00:06:09,320 --> 00:06:14,570
with a shady offer can enjoy encrypted

137
00:06:12,140 --> 00:06:16,669
chats and hidden identity instead of the

138
00:06:14,570 --> 00:06:19,280
exposed threat that are seen in all in

139
00:06:16,670 --> 00:06:21,290
the online web forms if in the past

140
00:06:19,280 --> 00:06:23,750
several steps were required to ensure

141
00:06:21,290 --> 00:06:26,170
anonymous connection to all today

142
00:06:23,750 --> 00:06:29,180
any telegram user can easily and quickly

143
00:06:26,170 --> 00:06:32,210
join channels with a single tap on their

144
00:06:29,180 --> 00:06:35,090
phone and start to receive notifications

145
00:06:32,210 --> 00:06:37,940
of secret conversations and shady offers

146
00:06:35,090 --> 00:06:41,560
directly to their smartphone all while

147
00:06:37,940 --> 00:06:44,330
keeping their identity completely hidden

148
00:06:41,560 --> 00:06:45,330
so I already told you about the telegram

149
00:06:44,330 --> 00:06:47,460
channels

150
00:06:45,330 --> 00:06:49,590
groups but the most known telegram

151
00:06:47,460 --> 00:06:51,229
feature for cybercrime in the telecom

152
00:06:49,590 --> 00:06:53,188
bots

153
00:06:51,229 --> 00:06:55,409
telecom bots are a couple of feature

154
00:06:53,189 --> 00:06:57,569
allowing third-party apps to run within

155
00:06:55,409 --> 00:07:01,500
the platform they have a rich set of

156
00:06:57,569 --> 00:07:03,599
features and quick adoption BOTS can be

157
00:07:01,500 --> 00:07:06,330
set up for specific tasks and legitimate

158
00:07:03,599 --> 00:07:08,878
uses our automatic file converters daily

159
00:07:06,330 --> 00:07:12,780
weather as well as many other legitimate

160
00:07:08,879 --> 00:07:15,210
services the telecom bots are cyber

161
00:07:12,780 --> 00:07:18,000
criminals next step because they include

162
00:07:15,210 --> 00:07:20,219
several significant benefits such as

163
00:07:18,000 --> 00:07:22,949
automatic cybercrime and remain

164
00:07:20,219 --> 00:07:24,599
invisible no need to register a host and

165
00:07:22,949 --> 00:07:26,490
a domain which eliminates all of the

166
00:07:24,599 --> 00:07:29,490
typical security challenges that might

167
00:07:26,490 --> 00:07:32,639
impact a website DDoS style attacks

168
00:07:29,490 --> 00:07:34,979
become irrelevant what someone will try

169
00:07:32,639 --> 00:07:39,629
to ddos telecom web servers in order to

170
00:07:34,979 --> 00:07:41,729
take down some telegram user using

171
00:07:39,629 --> 00:07:44,099
telecom bots also eliminates the need of

172
00:07:41,729 --> 00:07:45,979
cyber criminals to protect and hide

173
00:07:44,099 --> 00:07:48,539
their website from law enforcement

174
00:07:45,979 --> 00:07:50,699
anyway it is also what I thought before

175
00:07:48,539 --> 00:07:52,710
my research another thing is the

176
00:07:50,699 --> 00:07:55,020
implementation of telecom bots in the

177
00:07:52,710 --> 00:07:57,029
fraud contest is relatively new which

178
00:07:55,020 --> 00:08:01,049
makes the law enforcement unaware for

179
00:07:57,029 --> 00:08:05,099
that as a result telegram has become a

180
00:08:01,050 --> 00:08:06,779
valuable alternative to the darknet in

181
00:08:05,099 --> 00:08:08,909
my research I found that malware that

182
00:08:06,779 --> 00:08:11,550
uses telegram is a command control civil

183
00:08:08,909 --> 00:08:14,759
uses the telegram bot API for sending

184
00:08:11,550 --> 00:08:17,219
commands and communication the phone

185
00:08:14,759 --> 00:08:19,229
link is an example of the bot API

186
00:08:17,219 --> 00:08:21,659
request that used by malware in the wild

187
00:08:19,229 --> 00:08:24,029
as you can see the request contains the

188
00:08:21,659 --> 00:08:27,270
bot API token which is built from the

189
00:08:24,029 --> 00:08:29,069
API key an API hash and there is also

190
00:08:27,270 --> 00:08:32,728
the Gately function which coloured in

191
00:08:29,069 --> 00:08:36,589
blue I will explain the purpose of the

192
00:08:32,729 --> 00:08:39,570
get me function in the next few slides

193
00:08:36,589 --> 00:08:42,449
the latest malware which uses telecom

194
00:08:39,570 --> 00:08:45,089
bots as a command control server called

195
00:08:42,448 --> 00:08:46,589
Mossad stealer the Mossad stealer is all

196
00:08:45,089 --> 00:08:48,600
this off-the-shelf malware and

197
00:08:46,589 --> 00:08:51,660
advertised in other ground hacking

198
00:08:48,600 --> 00:08:53,160
phones and dedicated telegram groups it

199
00:08:51,660 --> 00:08:54,750
is still a meme malware

200
00:08:53,160 --> 00:08:57,660
capable of stealing browser data

201
00:08:54,750 --> 00:08:58,750
including safe credentials Lauren Logan

202
00:08:57,660 --> 00:09:03,160
forums and

203
00:08:58,750 --> 00:09:04,930
card information they even have support

204
00:09:03,160 --> 00:09:09,550
groups on telegram in English and

205
00:09:04,930 --> 00:09:11,229
Russian the Mossad still sends all the

206
00:09:09,550 --> 00:09:13,329
information it collects and also

207
00:09:11,230 --> 00:09:15,010
receives comments from a telegram bot

208
00:09:13,330 --> 00:09:16,750
that controlled by the attacker

209
00:09:15,010 --> 00:09:20,050
this is screenshot of the malicious

210
00:09:16,750 --> 00:09:21,790
pickup that I captured using burp as you

211
00:09:20,050 --> 00:09:24,310
can see the request contains the bot API

212
00:09:21,790 --> 00:09:27,130
token and they get me function as I

213
00:09:24,310 --> 00:09:29,349
explained you before in that case the

214
00:09:27,130 --> 00:09:31,150
get me function is used to verify that

215
00:09:29,350 --> 00:09:33,820
the command and control server is up and

216
00:09:31,150 --> 00:09:36,459
ready to get the stolen data from the

217
00:09:33,820 --> 00:09:38,410
victim computer if it will be up the

218
00:09:36,460 --> 00:09:41,410
response from the command control server

219
00:09:38,410 --> 00:09:43,740
will contain the board details which

220
00:09:41,410 --> 00:09:47,880
looks like that and contains the bot I D

221
00:09:43,740 --> 00:09:47,880
first name and username

222
00:09:48,330 --> 00:09:52,720
once the mossad still made sure the

223
00:09:50,890 --> 00:09:54,970
command control server is up it will

224
00:09:52,720 --> 00:09:58,120
send it will use the same document

225
00:09:54,970 --> 00:09:59,860
telegram API function to send a zip file

226
00:09:58,120 --> 00:10:02,980
with the stolen data from the victim

227
00:09:59,860 --> 00:10:05,640
computer as you can see there is the zip

228
00:10:02,980 --> 00:10:07,990
file with the file name

229
00:10:05,640 --> 00:10:09,730
there are also at the frameworks to

230
00:10:07,990 --> 00:10:11,710
create telegram comment control channel

231
00:10:09,730 --> 00:10:13,900
for malware and can be found on github

232
00:10:11,710 --> 00:10:16,030
and Google this one is called brain

233
00:10:13,900 --> 00:10:18,160
damage and it's written in Python you

234
00:10:16,030 --> 00:10:20,079
can scan the barcode if you want for the

235
00:10:18,160 --> 00:10:25,689
links for the framework for direct link

236
00:10:20,080 --> 00:10:28,150
for the framework this is another

237
00:10:25,690 --> 00:10:30,040
frameworks for telegram common control

238
00:10:28,150 --> 00:10:32,800
channel and as you can understand by its

239
00:10:30,040 --> 00:10:34,420
name it's written in C sharp you can

240
00:10:32,800 --> 00:10:36,750
also scan the barcode if you want for

241
00:10:34,420 --> 00:10:36,750
the link

242
00:10:43,280 --> 00:10:47,579
those are screenshots of the comments

243
00:10:45,840 --> 00:10:50,040
the telecom bots command control several

244
00:10:47,580 --> 00:10:52,410
supports as you can see the c2 comments

245
00:10:50,040 --> 00:10:55,949
are very similar to regular c2 server

246
00:10:52,410 --> 00:11:01,079
that we all know such as this info who

247
00:10:55,950 --> 00:11:03,330
in my reverse shell this one is another

248
00:11:01,080 --> 00:11:05,580
example of how looks telecom boats c2

249
00:11:03,330 --> 00:11:07,350
from the attackers perspective on the

250
00:11:05,580 --> 00:11:10,080
right side is the seat to lock terminal

251
00:11:07,350 --> 00:11:11,940
and on the left side is the c2 bot

252
00:11:10,080 --> 00:11:19,140
executing commands on the victim

253
00:11:11,940 --> 00:11:20,970
computer like get a CR so leveraging

254
00:11:19,140 --> 00:11:22,970
yowls to hunt for abuse telegram

255
00:11:20,970 --> 00:11:26,100
accounts on the Internet

256
00:11:22,970 --> 00:11:26,960
let's talk about the research itself how

257
00:11:26,100 --> 00:11:29,370
did it start

258
00:11:26,960 --> 00:11:32,100
before a couple of months ago I attended

259
00:11:29,370 --> 00:11:34,320
the talk at the besides TLV conference

260
00:11:32,100 --> 00:11:37,440
the talk presented a fish eat kid

261
00:11:34,320 --> 00:11:40,650
campaign the twos telecom bots as a CNC

262
00:11:37,440 --> 00:11:43,410
server during the talk I had a spark and

263
00:11:40,650 --> 00:11:46,680
wondered to myself is it possible to

264
00:11:43,410 --> 00:11:50,610
hunt for telegrams c2 severals using IOT

265
00:11:46,680 --> 00:11:53,130
global search engine so I started my

266
00:11:50,610 --> 00:11:55,620
research and my first obstacle was the

267
00:11:53,130 --> 00:11:58,439
need to hunt for a specific string in a

268
00:11:55,620 --> 00:12:00,780
large number of web pages as we all know

269
00:11:58,440 --> 00:12:03,390
the using of Python operators or reg X

270
00:12:00,780 --> 00:12:05,850
on such a large amount means slow

271
00:12:03,390 --> 00:12:10,800
performance which take us a long time to

272
00:12:05,850 --> 00:12:13,710
get some relevant results because of

273
00:12:10,800 --> 00:12:15,630
that I decided to use the are rules my

274
00:12:13,710 --> 00:12:17,790
affair with Charles started a couple of

275
00:12:15,630 --> 00:12:21,120
years ago when I started to walk for a

276
00:12:17,790 --> 00:12:22,860
large AV company since then I published

277
00:12:21,120 --> 00:12:25,680
a couple of sophisticated Yahoo's to

278
00:12:22,860 --> 00:12:28,400
hunt malware and I thought it can be a

279
00:12:25,680 --> 00:12:30,989
great idea to use it for my research

280
00:12:28,400 --> 00:12:32,810
also using yarra compared to other

281
00:12:30,990 --> 00:12:35,070
metals has proven to be more effective

282
00:12:32,810 --> 00:12:37,859
with high performance when dealing with

283
00:12:35,070 --> 00:12:40,350
mass amount of data to scan including

284
00:12:37,860 --> 00:12:42,720
options to create unique combinations

285
00:12:40,350 --> 00:12:46,740
and involve heavy reg X to hunt for

286
00:12:42,720 --> 00:12:48,540
specific data just for you understand

287
00:12:46,740 --> 00:12:49,980
the size of difference I tested the

288
00:12:48,540 --> 00:12:52,860
performance between Java and Python

289
00:12:49,980 --> 00:12:55,170
operators and the result where that with

290
00:12:52,860 --> 00:12:55,860
the Python operators it took me about 22

291
00:12:55,170 --> 00:12:59,660
seconds

292
00:12:55,860 --> 00:13:02,519
32 seconds sorry with 150 function calls

293
00:12:59,660 --> 00:13:07,290
compared to using owls where it took me

294
00:13:02,519 --> 00:13:10,080
only 0.008 seconds with only 10 function

295
00:13:07,290 --> 00:13:12,510
calls I tried to create a graph to show

296
00:13:10,080 --> 00:13:14,910
you that but because the difference in

297
00:13:12,510 --> 00:13:16,350
the performance in difference in the

298
00:13:14,910 --> 00:13:18,360
numbers of the performance was too big

299
00:13:16,350 --> 00:13:22,829
you will not see any colors in the our

300
00:13:18,360 --> 00:13:25,100
rules column my next step in my research

301
00:13:22,829 --> 00:13:27,930
was to write sophisticated ER rules

302
00:13:25,100 --> 00:13:30,029
which involve heavier eggox for

303
00:13:27,930 --> 00:13:32,579
capturing telegram join links telegram

304
00:13:30,029 --> 00:13:34,939
account web pages and exposed telegram

305
00:13:32,579 --> 00:13:37,800
API tokens on the global Internet

306
00:13:34,940 --> 00:13:42,180
although in my research I created three

307
00:13:37,800 --> 00:13:43,800
our rules for the first year will I

308
00:13:42,180 --> 00:13:46,140
analyzed the source code of the telegram

309
00:13:43,800 --> 00:13:48,300
web pages accounts which looks like that

310
00:13:46,140 --> 00:13:50,670
then I use the source code of the send

311
00:13:48,300 --> 00:13:54,540
message button to capture the telegram

312
00:13:50,670 --> 00:13:56,430
user name this is the HTML source code

313
00:13:54,540 --> 00:13:58,019
of that button as you can see it

314
00:13:56,430 --> 00:14:00,329
contains the name of the boat of the

315
00:13:58,019 --> 00:14:02,250
telegram account in that case the

316
00:14:00,329 --> 00:14:06,120
telling the name of the boat was a

317
00:14:02,250 --> 00:14:09,029
repulsive fight bot this is screenshot

318
00:14:06,120 --> 00:14:10,950
for the of the folder created to hunt

319
00:14:09,029 --> 00:14:13,529
for telegram account web pages on the

320
00:14:10,950 --> 00:14:17,760
Internet you can as you can see it

321
00:14:13,529 --> 00:14:19,649
contains some heavy relics for the

322
00:14:17,760 --> 00:14:21,839
second Yahoo I wanted to expand my

323
00:14:19,649 --> 00:14:23,790
research by capturing telegram links

324
00:14:21,839 --> 00:14:26,520
that were published on the Internet

325
00:14:23,790 --> 00:14:28,529
some of the most malicious ones that I

326
00:14:26,520 --> 00:14:30,600
found were posted on comments for

327
00:14:28,529 --> 00:14:34,020
YouTube videos that people that people

328
00:14:30,600 --> 00:14:36,240
can easily and quickly join this is an

329
00:14:34,020 --> 00:14:37,890
example in the green text is an example

330
00:14:36,240 --> 00:14:41,160
for the link structure for joining a

331
00:14:37,890 --> 00:14:43,170
telegram account and this is a

332
00:14:41,160 --> 00:14:45,149
screenshot of the second Yahoo that I

333
00:14:43,170 --> 00:14:47,630
created to hunt for telegram links on

334
00:14:45,149 --> 00:14:47,630
the Internet

335
00:14:50,480 --> 00:14:56,279
as I explained a few slides ago Mel watt

336
00:14:53,730 --> 00:14:59,190
that uses telegram is c2 common control

337
00:14:56,279 --> 00:15:01,800
server uses the telegram Telecom API

338
00:14:59,190 --> 00:15:05,339
function for communication the following

339
00:15:01,800 --> 00:15:07,740
link is an example for that HTTP API

340
00:15:05,339 --> 00:15:09,180
requests I was very curious if I could

341
00:15:07,740 --> 00:15:11,580
capture such as exposed

342
00:15:09,180 --> 00:15:13,650
Telecom API on the global Internet so

343
00:15:11,580 --> 00:15:18,060
for that purpose I created my third and

344
00:15:13,650 --> 00:15:20,130
last yahoo and here is it my turtle

345
00:15:18,060 --> 00:15:23,069
to hunt for exposed telegram api's on

346
00:15:20,130 --> 00:15:24,600
the Internet don't worry in the end of

347
00:15:23,070 --> 00:15:26,790
my talk I will present a link to my

348
00:15:24,600 --> 00:15:32,430
github well where those are wolves will

349
00:15:26,790 --> 00:15:34,680
be published so once I had my our rules

350
00:15:32,430 --> 00:15:37,050
written I combined it with repulsive I

351
00:15:34,680 --> 00:15:39,810
ret Scannell to hunt for exposed

352
00:15:37,050 --> 00:15:42,209
telegram stuff on all over the internet

353
00:15:39,810 --> 00:15:43,949
I stopped the scanner after a couple of

354
00:15:42,210 --> 00:15:48,060
minutes because the list was big enough

355
00:15:43,950 --> 00:15:49,710
for my research you can also scan the

356
00:15:48,060 --> 00:15:54,390
internet yourself and combine through

357
00:15:49,710 --> 00:15:56,880
Charles if it is by using the API of one

358
00:15:54,390 --> 00:15:59,640
of the non global IOT search engines or

359
00:15:56,880 --> 00:16:01,830
using open source tools like that Matt I

360
00:15:59,640 --> 00:16:03,060
commend you to do that you will be

361
00:16:01,830 --> 00:16:07,520
surprised by the things you will find

362
00:16:03,060 --> 00:16:10,349
using yowls and exposed to the Internet

363
00:16:07,520 --> 00:16:12,060
following getting an output list of a

364
00:16:10,350 --> 00:16:13,980
long list that contains telegram

365
00:16:12,060 --> 00:16:18,030
accounts I started my next step in my

366
00:16:13,980 --> 00:16:20,040
research by utilizing peloton telethon

367
00:16:18,030 --> 00:16:23,130
is Python 3 library to interact with

368
00:16:20,040 --> 00:16:25,680
telegram API as a user or through both

369
00:16:23,130 --> 00:16:27,960
account and publicly available on github

370
00:16:25,680 --> 00:16:32,939
you can scan the barcode if you want for

371
00:16:27,960 --> 00:16:34,920
the link so let's stop for a minute and

372
00:16:32,940 --> 00:16:37,230
take a look at the steps that involved

373
00:16:34,920 --> 00:16:41,400
in my research until now and how it

374
00:16:37,230 --> 00:16:43,590
worked the first step was to create an

375
00:16:41,400 --> 00:16:46,560
leveraged Yahoo to hunt for telegram web

376
00:16:43,590 --> 00:16:47,840
pages links na P is that exposed to the

377
00:16:46,560 --> 00:16:51,229
Internet

378
00:16:47,840 --> 00:16:54,480
step 2 scan the internet with miles

379
00:16:51,230 --> 00:16:58,170
step 3 gain an output list of telegram

380
00:16:54,480 --> 00:17:01,350
usernames step 4 using teletón to divide

381
00:16:58,170 --> 00:17:06,329
those usernames into groups channels

382
00:17:01,350 --> 00:17:08,520
bots and users at this point I ran into

383
00:17:06,329 --> 00:17:15,270
another obstacle that I was blocked by

384
00:17:08,520 --> 00:17:17,760
telegram because of API limit at this

385
00:17:15,270 --> 00:17:19,589
point I ran into I ran into another

386
00:17:17,760 --> 00:17:22,440
obstacle that I was blocked by telegram

387
00:17:19,589 --> 00:17:29,429
because of API limits

388
00:17:22,440 --> 00:17:32,400
I tried to manipulate telecom API and

389
00:17:29,430 --> 00:17:37,220
founded telecom block you for 24 hours

390
00:17:32,400 --> 00:17:40,770
after doing about 200 API requests

391
00:17:37,220 --> 00:17:44,250
meaning checking only 200 telecom

392
00:17:40,770 --> 00:17:52,200
accounts daily it that wasn't enough for

393
00:17:44,250 --> 00:17:54,690
me so I overcome the ape the telecom API

394
00:17:52,200 --> 00:17:57,450
limit by purchasing a large amount of

395
00:17:54,690 --> 00:17:59,490
SIM cards I found that once you created

396
00:17:57,450 --> 00:18:01,860
an API for a SIM card

397
00:17:59,490 --> 00:18:06,360
you don't need an active telecom session

398
00:18:01,860 --> 00:18:10,500
later meaning that you can create a

399
00:18:06,360 --> 00:18:12,840
config file with telecom api's and when

400
00:18:10,500 --> 00:18:15,780
it will get an API in limit exception

401
00:18:12,840 --> 00:18:19,169
the script will continue by using the

402
00:18:15,780 --> 00:18:26,160
next API from the config file that you

403
00:18:19,170 --> 00:18:29,100
created after overcoming the API limit I

404
00:18:26,160 --> 00:18:31,410
insert to my POC code some suspicious

405
00:18:29,100 --> 00:18:33,330
identifier based on the telecom

406
00:18:31,410 --> 00:18:35,790
command-and-control open source

407
00:18:33,330 --> 00:18:38,070
frameworks and from malware in the in

408
00:18:35,790 --> 00:18:41,580
the wild the tie found which uses

409
00:18:38,070 --> 00:18:44,370
telegram as command control server the

410
00:18:41,580 --> 00:18:47,220
following screenshot is the result it

411
00:18:44,370 --> 00:18:56,459
contains multiple languages such as

412
00:18:47,220 --> 00:18:58,800
Arabic Persian English and Russian at

413
00:18:56,460 --> 00:19:00,900
that point I started hunting for abuse

414
00:18:58,800 --> 00:19:04,110
telegram accounts by the following

415
00:19:00,900 --> 00:19:06,930
diagram using one of the many features

416
00:19:04,110 --> 00:19:09,590
the telethon has I was able to discover

417
00:19:06,930 --> 00:19:13,470
whether some telegram account is a bot

418
00:19:09,590 --> 00:19:17,490
channel group or regular user in tech

419
00:19:13,470 --> 00:19:20,010
action currently in one case where

420
00:19:17,490 --> 00:19:23,370
identified a group or a channel I use

421
00:19:20,010 --> 00:19:26,070
telethon again to iterate on all over

422
00:19:23,370 --> 00:19:27,479
the history messages and captured those

423
00:19:26,070 --> 00:19:29,040
who have matched to one of the

424
00:19:27,480 --> 00:19:32,580
suspicious and deadly fires that I

425
00:19:29,040 --> 00:19:34,460
insert earlier in another case where I

426
00:19:32,580 --> 00:19:36,210
identified the account as a bot I

427
00:19:34,460 --> 00:19:39,150
utilized telephone

428
00:19:36,210 --> 00:19:43,430
to send message comments such a start

429
00:19:39,150 --> 00:19:46,470
and help to the bot analyze the output

430
00:19:43,430 --> 00:19:49,110
and capture those who matched one of the

431
00:19:46,470 --> 00:19:54,180
suspicious identifiers that I insert

432
00:19:49,110 --> 00:19:56,610
earlier at the end of my talk if you

433
00:19:54,180 --> 00:19:58,770
will have time I will show you what

434
00:19:56,610 --> 00:20:01,560
happened when at the beginning of my

435
00:19:58,770 --> 00:20:08,310
research I accidently detected regular

436
00:20:01,560 --> 00:20:11,250
users as a bot it will be funny this is

437
00:20:08,310 --> 00:20:14,370
a screenshot of my PLC tool in action as

438
00:20:11,250 --> 00:20:17,520
you can see I started by connected with

439
00:20:14,370 --> 00:20:20,100
some sim card then it tested the first

440
00:20:17,520 --> 00:20:22,950
telecom account in the list send him

441
00:20:20,100 --> 00:20:25,980
message comments and waited 30 seconds

442
00:20:22,950 --> 00:20:30,450
before it analyzed it response in that

443
00:20:25,980 --> 00:20:33,360
case it discovered a malicious boot in

444
00:20:30,450 --> 00:20:35,790
testing number 2 the tool detected a

445
00:20:33,360 --> 00:20:37,560
malicious channel or group by searching

446
00:20:35,790 --> 00:20:40,649
for one of the malicious intent Affairs

447
00:20:37,560 --> 00:20:48,240
that I insert earlier in its history

448
00:20:40,650 --> 00:20:51,900
messages in my research I found telecom

449
00:20:48,240 --> 00:20:54,780
bots that leveraged the app to perform

450
00:20:51,900 --> 00:20:57,150
malicious functions starting from human

451
00:20:54,780 --> 00:20:59,790
control servers in polkas to create a

452
00:20:57,150 --> 00:21:02,600
bot that helped use of stay low and

453
00:20:59,790 --> 00:21:05,460
order the perfect woman for a night

454
00:21:02,600 --> 00:21:10,080
based on the options we chose like hell

455
00:21:05,460 --> 00:21:13,350
weight and area I also found black

456
00:21:10,080 --> 00:21:20,010
market channels and some closed hacking

457
00:21:13,350 --> 00:21:22,860
groups here you can see a screenshot of

458
00:21:20,010 --> 00:21:28,129
the mossad stellar that uses telegram as

459
00:21:22,860 --> 00:21:28,129
a c2 server and got haunted by my script

460
00:21:33,159 --> 00:21:37,509
is another malicious telecom both see to

461
00:21:35,109 --> 00:21:40,029
channel of the Mossad stiller that also

462
00:21:37,509 --> 00:21:41,139
got hunted my my script you can see all

463
00:21:40,029 --> 00:21:44,289
the stolen data

464
00:21:41,139 --> 00:21:51,879
did the victim stole that the attacker

465
00:21:44,289 --> 00:21:54,309
stole from the victim computer and here

466
00:21:51,879 --> 00:21:56,830
is another man well we choose Telecom is

467
00:21:54,309 --> 00:22:03,668
command control server and looks like

468
00:21:56,830 --> 00:22:06,189
another variant of the Mossad still in

469
00:22:03,669 --> 00:22:08,830
the Forex screenshot i hunted a persian

470
00:22:06,190 --> 00:22:12,099
darknet channel which publishes a rat

471
00:22:08,830 --> 00:22:19,539
for Windows the rat as you can see

472
00:22:12,099 --> 00:22:22,330
called spy note this one is an automatic

473
00:22:19,539 --> 00:22:29,739
bot for buying stolen credit cards and

474
00:22:22,330 --> 00:22:32,799
has already been deleted here you can

475
00:22:29,739 --> 00:22:35,049
see the bots with by pressing any one of

476
00:22:32,799 --> 00:22:38,440
the buttons you can order a woman

477
00:22:35,049 --> 00:22:46,509
foreign Knight based on the age hair

478
00:22:38,440 --> 00:22:48,609
color and weight this is a bot folder in

479
00:22:46,509 --> 00:22:54,849
drugs to your home just like what

480
00:22:48,609 --> 00:22:57,340
happens in the darknet so we already

481
00:22:54,849 --> 00:22:59,710
talked about how I used my two Yahoo's

482
00:22:57,340 --> 00:23:02,949
to capture telegram links and accounts

483
00:22:59,710 --> 00:23:05,080
on the internet however I didn't talk

484
00:23:02,950 --> 00:23:07,389
yet about the money about the results

485
00:23:05,080 --> 00:23:10,928
for my third year all that I created

486
00:23:07,389 --> 00:23:12,719
hunt for exposed telegram api's on the

487
00:23:10,929 --> 00:23:15,759
Internet

488
00:23:12,720 --> 00:23:17,919
once I hunted the telegram API tokens

489
00:23:15,759 --> 00:23:21,190
that belong to a malicious to attacked

490
00:23:17,919 --> 00:23:24,099
oh if it was on virustotal

491
00:23:21,190 --> 00:23:26,769
or hybrid analysis or other threat

492
00:23:24,099 --> 00:23:30,129
intelligence websites I was able to

493
00:23:26,769 --> 00:23:32,950
access to all of its history messages by

494
00:23:30,129 --> 00:23:35,109
abusing the forward message API to

495
00:23:32,950 --> 00:23:40,809
forward all the body story messages to

496
00:23:35,109 --> 00:23:44,259
my account the forward message API

497
00:23:40,809 --> 00:23:46,239
structure looks like that it is built

498
00:23:44,259 --> 00:23:46,860
from the chat ID that you want to

499
00:23:46,239 --> 00:23:50,460
forward them

500
00:23:46,860 --> 00:23:53,969
- in that case my jet ID was in the

501
00:23:50,460 --> 00:23:58,830
green and the chat ID of the malicious

502
00:23:53,970 --> 00:24:02,490
BOTS itself in orange but as you can see

503
00:23:58,830 --> 00:24:05,010
there is also the message ID which in

504
00:24:02,490 --> 00:24:08,670
red and contains the number of the

505
00:24:05,010 --> 00:24:10,679
message to forward in my research I used

506
00:24:08,670 --> 00:24:13,260
that I used that to write a simple

507
00:24:10,679 --> 00:24:16,049
Python script that will iterate on all

508
00:24:13,260 --> 00:24:18,120
of all the numbers starting from not one

509
00:24:16,049 --> 00:24:20,879
and in until it will get an exception

510
00:24:18,120 --> 00:24:23,340
and by that I got all of the bots

511
00:24:20,880 --> 00:24:29,460
history messages from the first one

512
00:24:23,340 --> 00:24:31,678
until the last one so when I forward the

513
00:24:29,460 --> 00:24:34,860
fourth myth the first message from the

514
00:24:31,679 --> 00:24:36,809
command control server the boat I got

515
00:24:34,860 --> 00:24:42,389
the start command that the attacker

516
00:24:36,809 --> 00:24:44,820
executed to start the sea to the next

517
00:24:42,390 --> 00:24:52,500
messages contained details of the

518
00:24:44,820 --> 00:24:54,389
victims with their stolen data in order

519
00:24:52,500 --> 00:24:56,940
to protect your organization from

520
00:24:54,390 --> 00:25:00,059
malware that uses telegram is a command

521
00:24:56,940 --> 00:25:01,799
control server and find its way out for

522
00:25:00,059 --> 00:25:03,720
out from out of your network

523
00:25:01,799 --> 00:25:07,860
I'll community to block the domain

524
00:25:03,720 --> 00:25:10,200
address API dot telegram dot o on your

525
00:25:07,860 --> 00:25:13,379
firewall or in your other networking

526
00:25:10,200 --> 00:25:18,110
security systems so the stolen data will

527
00:25:13,380 --> 00:25:18,110
not reach to the command control server

528
00:25:19,340 --> 00:25:25,590
so as I said for a couple of slides in a

529
00:25:23,250 --> 00:25:27,870
case that I detected an account as a

530
00:25:25,590 --> 00:25:30,209
real users I skipped it and move to the

531
00:25:27,870 --> 00:25:32,668
next username but at the beginning of my

532
00:25:30,210 --> 00:25:34,919
research I made a small mistake when I

533
00:25:32,669 --> 00:25:36,809
sent message command to real users and

534
00:25:34,919 --> 00:25:39,150
as you will see the result was funny

535
00:25:36,809 --> 00:25:40,470
here you see someone that certainly did

536
00:25:39,150 --> 00:25:42,450
that he isn't a bot

537
00:25:40,470 --> 00:25:45,120
and he is a programmer and wanted that I

538
00:25:42,450 --> 00:25:47,400
will hire him in the end

539
00:25:45,120 --> 00:25:53,250
it tried to stop me by sending me a stop

540
00:25:47,400 --> 00:25:55,679
command in that screenshot you can see

541
00:25:53,250 --> 00:25:57,690
that someone got enough for me and sent

542
00:25:55,679 --> 00:26:00,679
for my message comment send me funny

543
00:25:57,690 --> 00:26:00,679
gifts to show me that

544
00:26:02,290 --> 00:26:07,340
and here you can see that someone went

545
00:26:04,850 --> 00:26:09,500
crazy for not understanding what I want

546
00:26:07,340 --> 00:26:17,300
from him in the end he tried also to

547
00:26:09,500 --> 00:26:18,310
call me I didn't answer him so taking

548
00:26:17,300 --> 00:26:20,570
out the trash

549
00:26:18,310 --> 00:26:23,090
cybercriminals that leverage telegram

550
00:26:20,570 --> 00:26:26,659
for conducting cybercrime is not as it's

551
00:26:23,090 --> 00:26:28,280
not necessarily new as I speak my script

552
00:26:26,660 --> 00:26:30,500
is Lanting for more varieties of

553
00:26:28,280 --> 00:26:32,810
cybercrime on different types of

554
00:26:30,500 --> 00:26:36,530
telegram accounts it doesn't matter if

555
00:26:32,810 --> 00:26:40,399
it's a bot channel or group everything

556
00:26:36,530 --> 00:26:42,440
is taken into account through my

557
00:26:40,400 --> 00:26:45,140
research and the tool that I created I

558
00:26:42,440 --> 00:26:48,110
reported to abuse at telecom not all on

559
00:26:45,140 --> 00:26:52,990
such abused accounts to help to help to

560
00:26:48,110 --> 00:26:55,580
shut them down so what's next

561
00:26:52,990 --> 00:26:57,790
improving my script you can also have

562
00:26:55,580 --> 00:26:59,960
helped me by sending me pull requests I

563
00:26:57,790 --> 00:27:02,930
will continue hunting for telecom

564
00:26:59,960 --> 00:27:04,670
accounts that abusing the platform for

565
00:27:02,930 --> 00:27:07,580
my stuff and trying to make it a better

566
00:27:04,670 --> 00:27:11,030
place and the last thing I want to focus

567
00:27:07,580 --> 00:27:13,159
on hunting for expose telecom API is on

568
00:27:11,030 --> 00:27:14,990
specific threat intelligence websites

569
00:27:13,160 --> 00:27:18,170
such as virustotal

570
00:27:14,990 --> 00:27:22,670
and hybrid analysis and also other

571
00:27:18,170 --> 00:27:25,040
sandbox websites because I found in my

572
00:27:22,670 --> 00:27:30,100
research that this way hiding I had more

573
00:27:25,040 --> 00:27:30,100
chances to hunt for telecom c2 servers

574
00:27:30,640 --> 00:27:35,360
thank you anyone everyone the POC code

575
00:27:33,470 --> 00:27:37,490
for my Anne Meyer rules can be found at

576
00:27:35,360 --> 00:27:39,020
the following link you can also scan the

577
00:27:37,490 --> 00:27:43,990
barcode for the link or take a picture

578
00:27:39,020 --> 00:27:47,059
of it if you want so thanks to everyone

579
00:27:43,990 --> 00:27:47,059
[Applause]

