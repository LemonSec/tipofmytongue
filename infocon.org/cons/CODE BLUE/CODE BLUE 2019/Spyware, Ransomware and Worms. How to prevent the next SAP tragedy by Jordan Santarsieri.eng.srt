1
00:00:07,029 --> 00:00:13,129
hello everyone thank you for being here

2
00:00:10,960 --> 00:00:15,860
let's start Oh

3
00:00:13,129 --> 00:00:17,448
first of all this is a disclaimer that I

4
00:00:15,860 --> 00:00:19,880
had to put it there and no one reads it

5
00:00:17,449 --> 00:00:22,730
anyways but basically it says that I

6
00:00:19,880 --> 00:00:25,580
don't try to take the rights that a city

7
00:00:22,730 --> 00:00:29,089
has over their brands okay

8
00:00:25,580 --> 00:00:30,948
so Who am I my name is Jordan Center

9
00:00:29,089 --> 00:00:34,280
Siri I am the founder of a company

10
00:00:30,949 --> 00:00:36,590
called mixer my background my regional

11
00:00:34,280 --> 00:00:40,430
background was as a pen tester retainer

12
00:00:36,590 --> 00:00:44,320
and then I started to specialize on this

13
00:00:40,430 --> 00:00:47,810
kind of ERP systems especially in SA P

14
00:00:44,320 --> 00:00:50,420
when I can I like to speak on different

15
00:00:47,810 --> 00:00:52,670
security confidences like blackhat or

16
00:00:50,420 --> 00:00:55,730
wasps and now the code blue

17
00:00:52,670 --> 00:00:57,680
thank you so much for that and I have

18
00:00:55,730 --> 00:01:02,449
been dealing with this IP for quite a

19
00:00:57,680 --> 00:01:05,930
while I have experience dealing with you

20
00:01:02,450 --> 00:01:09,320
name it like OMGs military institutions

21
00:01:05,930 --> 00:01:11,090
and fortune 500 companies that's my

22
00:01:09,320 --> 00:01:14,719
Twitter right there in case you wanna

23
00:01:11,090 --> 00:01:17,539
and what I have for you today will be

24
00:01:14,719 --> 00:01:19,969
divided in four different chapters first

25
00:01:17,539 --> 00:01:22,549
we have a brief introduction to s AP

26
00:01:19,969 --> 00:01:25,339
again this originally was like a

27
00:01:22,549 --> 00:01:28,340
one-hour talk I had to trim it down a

28
00:01:25,340 --> 00:01:30,590
little bit to fit this 40 minutes so

29
00:01:28,340 --> 00:01:33,049
will be a very very brief introduction

30
00:01:30,590 --> 00:01:35,600
to ACP then I will tell you what is the

31
00:01:33,049 --> 00:01:37,639
project our SAP I'm going to be

32
00:01:35,600 --> 00:01:41,149
releasing something exclusively for code

33
00:01:37,639 --> 00:01:43,490
blue in terms of the project our shop we

34
00:01:41,149 --> 00:01:46,399
are going to start getting more tangled

35
00:01:43,490 --> 00:01:48,289
on chapter 3 and chapter 4 where we're

36
00:01:46,399 --> 00:01:51,829
going to see malware distribution on s

37
00:01:48,289 --> 00:01:55,459
IP and how well are the ESP systems that

38
00:01:51,829 --> 00:01:58,309
are currently on the Internet ok so

39
00:01:55,459 --> 00:02:01,280
let's start with the introduction many

40
00:01:58,310 --> 00:02:04,249
of you may be thinking ok so what is s

41
00:02:01,280 --> 00:02:07,880
IP let me tell you that I say P is like

42
00:02:04,249 --> 00:02:08,750
the main financial system in the war is

43
00:02:07,880 --> 00:02:10,609
huge

44
00:02:08,750 --> 00:02:15,019
it's a German company that was founded

45
00:02:10,610 --> 00:02:18,590
in 1972 by X IBM employees those guys

46
00:02:15,019 --> 00:02:20,460
were working on an ERP for IBM the

47
00:02:18,590 --> 00:02:22,890
pressure gets canceled antennas

48
00:02:20,460 --> 00:02:25,610
to quit and starker into their own

49
00:02:22,890 --> 00:02:28,200
company and well one of the most

50
00:02:25,610 --> 00:02:30,570
successful business decision in the

51
00:02:28,200 --> 00:02:33,209
modern history of software why because

52
00:02:30,570 --> 00:02:36,840
these guys have nowadays more than 98

53
00:02:33,210 --> 00:02:39,900
thousand employees worldwide they have

54
00:02:36,840 --> 00:02:43,740
more than 400,000 customers out there

55
00:02:39,900 --> 00:02:45,900
there in almost every single country on

56
00:02:43,740 --> 00:02:47,940
this planet and I think the most

57
00:02:45,900 --> 00:02:51,330
representative number is the one that

58
00:02:47,940 --> 00:02:54,480
you will see at the end for the total of

59
00:02:51,330 --> 00:02:59,790
Forbes Global 2000 that means like the

60
00:02:54,480 --> 00:03:03,329
richest 2000 companies out there 92% is

61
00:02:59,790 --> 00:03:08,070
currently using s IP they totally

62
00:03:03,330 --> 00:03:10,080
dominate the market so what solutions

63
00:03:08,070 --> 00:03:12,420
what type of sa persistence you might

64
00:03:10,080 --> 00:03:14,070
find again for this really brief

65
00:03:12,420 --> 00:03:16,619
introduction we're going to divide this

66
00:03:14,070 --> 00:03:18,799
into who have the enterprise solutions

67
00:03:16,620 --> 00:03:22,970
those solutions will be the ones that

68
00:03:18,800 --> 00:03:26,670
will be providing support to end-users

69
00:03:22,970 --> 00:03:28,320
customers and from the other one so we

70
00:03:26,670 --> 00:03:30,089
have the supporting solutions those

71
00:03:28,320 --> 00:03:33,000
solutions will provide support to the

72
00:03:30,090 --> 00:03:35,910
enterprise solutions if in your company

73
00:03:33,000 --> 00:03:38,520
only have one sa p system that will be

74
00:03:35,910 --> 00:03:42,660
the SI p erp or you might hear about the

75
00:03:38,520 --> 00:03:46,410
enterprise resource planning that is the

76
00:03:42,660 --> 00:03:48,900
heart of the SMP implementation if your

77
00:03:46,410 --> 00:03:51,270
company process credit cards is going to

78
00:03:48,900 --> 00:03:53,360
be there if payroll information is

79
00:03:51,270 --> 00:03:57,510
handled in sa p is going to be their

80
00:03:53,360 --> 00:04:00,390
vacations white ram first etc all that

81
00:03:57,510 --> 00:04:01,980
will be on the ERP system and then you

82
00:04:00,390 --> 00:04:06,440
have many more you have the business

83
00:04:01,980 --> 00:04:09,720
intelligence is how companies apply

84
00:04:06,440 --> 00:04:12,480
intelligence to sell more and faster to

85
00:04:09,720 --> 00:04:14,670
the customers CRM where the

86
00:04:12,480 --> 00:04:17,010
relationships between the companies and

87
00:04:14,670 --> 00:04:19,469
the customers are store and so on as you

88
00:04:17,010 --> 00:04:24,000
can tell is pretty sensitive information

89
00:04:19,470 --> 00:04:25,920
in terms of a monetary value everything

90
00:04:24,000 --> 00:04:27,930
that we're going to see for this

91
00:04:25,920 --> 00:04:30,030
presentation corresponds to what is

92
00:04:27,930 --> 00:04:33,060
called as a pin and Weaver is happening

93
00:04:30,030 --> 00:04:33,780
Weaver is the framework where s a piece

94
00:04:33,060 --> 00:04:36,000
bill

95
00:04:33,780 --> 00:04:39,630
in its the most important technology

96
00:04:36,000 --> 00:04:41,940
that they say be has the technology will

97
00:04:39,630 --> 00:04:45,719
be divided into from one side you have

98
00:04:41,940 --> 00:04:48,900
the a bap it's mainly focused or you can

99
00:04:45,720 --> 00:04:51,750
see it more as a back end and you have

100
00:04:48,900 --> 00:04:54,388
the Java side that sa be slowly Sun

101
00:04:51,750 --> 00:04:57,300
setting that is mainly intended for

102
00:04:54,389 --> 00:04:59,130
front-end services how you differentiate

103
00:04:57,300 --> 00:04:59,760
between one another well it's very

104
00:04:59,130 --> 00:05:03,330
simple

105
00:04:59,760 --> 00:05:06,630
Ava is worth the money is Java is the

106
00:05:03,330 --> 00:05:09,270
front-end this graph that I have created

107
00:05:06,630 --> 00:05:11,419
for you is more or less how s ap is

108
00:05:09,270 --> 00:05:14,400
divided against like a very big picture

109
00:05:11,419 --> 00:05:17,219
each one of the stocks that I mentioned

110
00:05:14,400 --> 00:05:19,859
will have its own set of services with

111
00:05:17,220 --> 00:05:22,140
its own set of protocols in the ERP war

112
00:05:19,860 --> 00:05:24,540
is very common that the protocols are

113
00:05:22,140 --> 00:05:27,030
private re most of them are private re

114
00:05:24,540 --> 00:05:29,100
and for most of them you don't have

115
00:05:27,030 --> 00:05:30,929
technical information basically you need

116
00:05:29,100 --> 00:05:32,639
to sit on your chair and start reverse

117
00:05:30,930 --> 00:05:37,919
engineer to figure it out how actually

118
00:05:32,639 --> 00:05:39,690
works and how people connect to this s a

119
00:05:37,919 --> 00:05:41,909
resistance well taken many ways

120
00:05:39,690 --> 00:05:44,669
depending from where you are connecting

121
00:05:41,910 --> 00:05:47,400
to if you are on the HSN network most

122
00:05:44,669 --> 00:05:49,950
likely you will have the sub GUI this is

123
00:05:47,400 --> 00:05:52,409
how you connect to a bap basically this

124
00:05:49,950 --> 00:05:54,900
is a client that this ap has created for

125
00:05:52,410 --> 00:05:57,419
us and I'd like to say that it's like an

126
00:05:54,900 --> 00:06:01,380
extra thick client just for a client is

127
00:05:57,419 --> 00:06:03,450
one port for gigawatts tiny to dona then

128
00:06:01,380 --> 00:06:05,010
from the systems that are on the

129
00:06:03,450 --> 00:06:06,750
internet or when you want to connect to

130
00:06:05,010 --> 00:06:09,539
the web application server you connect

131
00:06:06,750 --> 00:06:11,880
to something that is called ICM there is

132
00:06:09,539 --> 00:06:14,340
a proprietary web application server for

133
00:06:11,880 --> 00:06:19,050
a but or if you want to connect to java

134
00:06:14,340 --> 00:06:21,960
is the java HTTP it's just that the name

135
00:06:19,050 --> 00:06:24,020
they didn't create any significant in

136
00:06:21,960 --> 00:06:26,460
name for this web application server

137
00:06:24,020 --> 00:06:28,469
unlike their own ECP's creating

138
00:06:26,460 --> 00:06:31,950
something new is actually an evolution

139
00:06:28,470 --> 00:06:34,620
of the s apic-em that is called the X s

140
00:06:31,950 --> 00:06:36,960
a they're creating something new that is

141
00:06:34,620 --> 00:06:39,840
called Hana is that the recent memory

142
00:06:36,960 --> 00:06:42,780
that they are fusion as well with this

143
00:06:39,840 --> 00:06:45,190
web application server but for the point

144
00:06:42,780 --> 00:06:48,880
of this talk it doesn't matter

145
00:06:45,190 --> 00:06:51,160
a new beginning let me tell you about

146
00:06:48,880 --> 00:06:53,830
this project our SAP as I told you

147
00:06:51,160 --> 00:06:56,530
before and with a company called mixer

148
00:06:53,830 --> 00:07:00,729
that specializes in security on the ERP

149
00:06:56,530 --> 00:07:02,859
ASAP Oracle e-business suite civil you

150
00:07:00,730 --> 00:07:05,020
name it where we depend this when our

151
00:07:02,860 --> 00:07:07,630
leader salesman trainings and so on I'm

152
00:07:05,020 --> 00:07:09,849
many forensics I love the forensics but

153
00:07:07,630 --> 00:07:11,770
I always like to joke that whatever I

154
00:07:09,850 --> 00:07:16,390
had to do the forensics I use two years

155
00:07:11,770 --> 00:07:18,849
of my life so we were a relatively new

156
00:07:16,390 --> 00:07:20,950
company right and we had the challenges

157
00:07:18,850 --> 00:07:24,850
that every relatively new company has

158
00:07:20,950 --> 00:07:26,890
how do we find customers most people

159
00:07:24,850 --> 00:07:30,460
would will do is take just by a list of

160
00:07:26,890 --> 00:07:33,159
s IP customers tastes I start doing cold

161
00:07:30,460 --> 00:07:36,250
calling and they get a success rate of

162
00:07:33,160 --> 00:07:38,800
more or less 1% that is exactly what

163
00:07:36,250 --> 00:07:41,230
spammers get so I don't think it's a

164
00:07:38,800 --> 00:07:43,330
coin sense we said no wait a second I

165
00:07:41,230 --> 00:07:45,760
mean we are hackers we have technical

166
00:07:43,330 --> 00:07:48,550
knowledge we should be able to do better

167
00:07:45,760 --> 00:07:52,450
and that's how this project our sub was

168
00:07:48,550 --> 00:07:54,250
born we say okay let's scan every single

169
00:07:52,450 --> 00:07:58,780
data sources that we have for example

170
00:07:54,250 --> 00:08:01,030
sure than Google being su my even some

171
00:07:58,780 --> 00:08:04,659
sketchy resources on the Deep Web and

172
00:08:01,030 --> 00:08:06,969
let's try to use those guys to find SMP

173
00:08:04,660 --> 00:08:10,120
systems that are listening on the

174
00:08:06,970 --> 00:08:12,220
Internet it's exactly what we did we

175
00:08:10,120 --> 00:08:15,400
wanted every single system that we could

176
00:08:12,220 --> 00:08:18,040
find like Arab systems Java systems and

177
00:08:15,400 --> 00:08:20,049
air all the other technologies that we

178
00:08:18,040 --> 00:08:22,330
don't care at least for now so what we

179
00:08:20,050 --> 00:08:24,370
did we created a structure basically a

180
00:08:22,330 --> 00:08:26,409
script that will be interacting with

181
00:08:24,370 --> 00:08:30,640
each one of the data sources and we

182
00:08:26,410 --> 00:08:33,039
extracted the information why we needed

183
00:08:30,640 --> 00:08:35,169
extra tool because we knew that that map

184
00:08:33,039 --> 00:08:38,348
that we were creating was going to be

185
00:08:35,169 --> 00:08:41,218
live and then we got many other

186
00:08:38,349 --> 00:08:43,810
surprises for example we got a lot of

187
00:08:41,219 --> 00:08:46,690
companies actually publishing not just

188
00:08:43,809 --> 00:08:49,239
the productive ASAP system if not dev

189
00:08:46,690 --> 00:08:54,250
and QA so we definitely need something

190
00:08:49,240 --> 00:08:57,730
to keep the live map alive so once we

191
00:08:54,250 --> 00:08:58,570
have all that bulky information it was a

192
00:08:57,730 --> 00:09:00,730
lot of

193
00:08:58,570 --> 00:09:03,490
terrabytes actually so what we needed to

194
00:09:00,730 --> 00:09:06,040
do is to make it a smarter we need to

195
00:09:03,490 --> 00:09:08,710
filter that info so how we could do that

196
00:09:06,040 --> 00:09:11,699
well lucky for us and as you can see on

197
00:09:08,710 --> 00:09:14,440
the screen is a piece quite verbose on

198
00:09:11,700 --> 00:09:17,080
the banners of the web application

199
00:09:14,440 --> 00:09:18,520
servers look at it I mean it has no

200
00:09:17,080 --> 00:09:20,290
doubt that you're dealing with an NCP

201
00:09:18,520 --> 00:09:22,569
system it's a big net we were an

202
00:09:20,290 --> 00:09:25,420
application server 7:21 application

203
00:09:22,570 --> 00:09:27,490
server Java 731 you have the reason is

204
00:09:25,420 --> 00:09:30,189
AP system you had the type of s AP

205
00:09:27,490 --> 00:09:34,240
system and you also have the version of

206
00:09:30,190 --> 00:09:37,900
the system of course we did more than

207
00:09:34,240 --> 00:09:40,870
that we got even a smarter we started to

208
00:09:37,900 --> 00:09:43,410
review the SSL Certificates if they were

209
00:09:40,870 --> 00:09:45,490
any oh you won't believe how many

210
00:09:43,410 --> 00:09:47,980
productivity systems are out there that

211
00:09:45,490 --> 00:09:50,260
they don't even have SSL certificates or

212
00:09:47,980 --> 00:09:54,340
even when the certificates are self

213
00:09:50,260 --> 00:09:56,950
signed so we get this mortar and we

214
00:09:54,340 --> 00:09:58,510
started dividing that knowledge that we

215
00:09:56,950 --> 00:10:02,770
were gaining because we wanted to know

216
00:09:58,510 --> 00:10:05,110
first of all we wanted to know who was

217
00:10:02,770 --> 00:10:08,770
the owner of that asset we wanted to

218
00:10:05,110 --> 00:10:11,200
know where that asset was being host so

219
00:10:08,770 --> 00:10:14,260
basically what we did we started to add

220
00:10:11,200 --> 00:10:18,700
tags to the systems that we were

221
00:10:14,260 --> 00:10:21,400
discovering and we went even a little

222
00:10:18,700 --> 00:10:24,490
bit ahead we started identifying okay

223
00:10:21,400 --> 00:10:27,520
those assets are belonging to an OMG

224
00:10:24,490 --> 00:10:30,340
those assets are belonging to a company

225
00:10:27,520 --> 00:10:32,140
because I always like to joke like ASAP

226
00:10:30,340 --> 00:10:35,410
is so expensive it's like a roll right

227
00:10:32,140 --> 00:10:37,990
and there is no such thing as an orphan

228
00:10:35,410 --> 00:10:39,310
roll boys so it's a reasonably system

229
00:10:37,990 --> 00:10:41,350
out there in the Internet in this

230
00:10:39,310 --> 00:10:45,069
because a big company or a big

231
00:10:41,350 --> 00:10:49,000
organization is behind it and also

232
00:10:45,070 --> 00:10:51,310
remember we had the version so as we had

233
00:10:49,000 --> 00:10:53,320
the version we compared that version

234
00:10:51,310 --> 00:10:56,739
against the knowledge base that we have

235
00:10:53,320 --> 00:11:00,010
of it was a combination of the internal

236
00:10:56,740 --> 00:11:01,990
research that we do plus what is called

237
00:11:00,010 --> 00:11:03,790
ESP security notes like the one

238
00:11:01,990 --> 00:11:06,640
abilities that were reported by CP

239
00:11:03,790 --> 00:11:09,490
itself or other researchers and we did

240
00:11:06,640 --> 00:11:12,490
sense of reverse process to know exactly

241
00:11:09,490 --> 00:11:14,770
what of those si positions that were

242
00:11:12,490 --> 00:11:17,980
on the internet we're vulnerable to

243
00:11:14,770 --> 00:11:21,730
attacks are you intrigued with the

244
00:11:17,980 --> 00:11:26,680
results I have some to share with you

245
00:11:21,730 --> 00:11:28,600
for example we found about 14,000 s IP

246
00:11:26,680 --> 00:11:30,609
services exposed directly to the

247
00:11:28,600 --> 00:11:34,570
Internet right there

248
00:11:30,610 --> 00:11:37,570
I knew my meeting well Matt maybe there

249
00:11:34,570 --> 00:11:39,940
is a wife there maybe some ideas maybe

250
00:11:37,570 --> 00:11:43,660
son IPS well let me tell you that

251
00:11:39,940 --> 00:11:46,690
unfortunately an ACP is so neat

252
00:11:43,660 --> 00:11:49,689
most of these providers have no

253
00:11:46,690 --> 00:11:51,910
signatures whatsoever for s AP son

254
00:11:49,690 --> 00:11:54,010
doesn't matter if you have an IPS an IPS

255
00:11:51,910 --> 00:11:56,260
out there if I can reach the web

256
00:11:54,010 --> 00:12:00,550
application server I can start trying my

257
00:11:56,260 --> 00:12:02,730
attacks and also remember that I was

258
00:12:00,550 --> 00:12:06,339
telling you that we wanted to identify

259
00:12:02,730 --> 00:12:09,310
the companies behind the assets well for

260
00:12:06,339 --> 00:12:12,160
almost 40 percent of the ESL positions

261
00:12:09,310 --> 00:12:16,660
that we found we were able to identify

262
00:12:12,160 --> 00:12:19,920
exactly who was the owner of those SAV

263
00:12:16,660 --> 00:12:22,480
systems and where it was has been hast

264
00:12:19,920 --> 00:12:23,910
it's quite interesting here in the

265
00:12:22,480 --> 00:12:28,450
region

266
00:12:23,910 --> 00:12:30,240
you guys were quite right quite okay in

267
00:12:28,450 --> 00:12:33,250
comparison with some other countries

268
00:12:30,240 --> 00:12:35,649
there are tons and tons of assistance

269
00:12:33,250 --> 00:12:39,190
being hosted in Singapore because AWS

270
00:12:35,649 --> 00:12:41,829
there has a big cluster and also a lot

271
00:12:39,190 --> 00:12:44,260
of SAV systems in Korea like Korea

272
00:12:41,829 --> 00:12:47,319
telecom but in terms of the region you

273
00:12:44,260 --> 00:12:49,390
guys terms of security and in terms of

274
00:12:47,320 --> 00:12:53,170
the many assets are there you guys were

275
00:12:49,390 --> 00:12:55,120
quite good so I told you that I have a

276
00:12:53,170 --> 00:12:58,300
little bit of a surprise for you today

277
00:12:55,120 --> 00:13:01,029
something exclusively for CodeBlue the

278
00:12:58,300 --> 00:13:04,829
analysis that we create that we have put

279
00:13:01,029 --> 00:13:07,480
it in form of a paper and we are

280
00:13:04,829 --> 00:13:09,790
releasing it right now for the very

281
00:13:07,480 --> 00:13:11,950
first time if you want to get a copy of

282
00:13:09,790 --> 00:13:15,910
that you have to go to our website is

283
00:13:11,950 --> 00:13:20,140
like HTTPS double dot slash slash mixer

284
00:13:15,910 --> 00:13:23,890
comm slash research slash situation dot

285
00:13:20,140 --> 00:13:26,380
HTML basically you have a more detail of

286
00:13:23,890 --> 00:13:28,780
what we did how we did it

287
00:13:26,380 --> 00:13:31,660
which one were of the results we have

288
00:13:28,780 --> 00:13:33,160
divided the resource per continent so it

289
00:13:31,660 --> 00:13:39,880
would be easier for you if you want to

290
00:13:33,160 --> 00:13:42,760
focus only in Asia so a pair of that a

291
00:13:39,880 --> 00:13:46,360
pair of knowing who was behind years

292
00:13:42,760 --> 00:13:50,740
existence annoying the versions the tax

293
00:13:46,360 --> 00:13:54,940
etc we wanted to go a little bit ahead

294
00:13:50,740 --> 00:13:57,250
and unfortunately we discover without

295
00:13:54,940 --> 00:14:00,370
touching this existence and this is very

296
00:13:57,250 --> 00:14:02,770
important by just knowing the version of

297
00:14:00,370 --> 00:14:04,420
the asset we didn't send any of the

298
00:14:02,770 --> 00:14:06,850
attacks to the systems that were on the

299
00:14:04,420 --> 00:14:09,339
internet without touching them we were

300
00:14:06,850 --> 00:14:11,710
able to figure it out that 27% of the

301
00:14:09,340 --> 00:14:15,810
systems that we found were vulnerable to

302
00:14:11,710 --> 00:14:19,450
critical or high criticism own abilities

303
00:14:15,810 --> 00:14:21,400
basically for most of them you could do

304
00:14:19,450 --> 00:14:24,070
remote command execution directly

305
00:14:21,400 --> 00:14:28,060
transversal file upload find a load etc

306
00:14:24,070 --> 00:14:31,780
you can literally own the asset from the

307
00:14:28,060 --> 00:14:34,270
internet we were highly surprised by

308
00:14:31,780 --> 00:14:38,620
this number actually personally I was

309
00:14:34,270 --> 00:14:40,870
expecting someone around the 10% we got

310
00:14:38,620 --> 00:14:44,790
almost three times more that we were

311
00:14:40,870 --> 00:14:47,740
expecting and we say okay oh my god

312
00:14:44,790 --> 00:14:51,640
those numbers are so high someone with

313
00:14:47,740 --> 00:14:54,850
the necessary level of a skill wants to

314
00:14:51,640 --> 00:14:58,569
create a warm it would be a tragedy will

315
00:14:54,850 --> 00:15:02,470
be a carnage we wanted to help for sure

316
00:14:58,570 --> 00:15:04,990
but before that we need to understand

317
00:15:02,470 --> 00:15:07,350
how someone can actually approach how

318
00:15:04,990 --> 00:15:10,210
how someone could actually try to

319
00:15:07,350 --> 00:15:11,770
overcome the security of the assistance

320
00:15:10,210 --> 00:15:15,790
that that were exposed to the Internet

321
00:15:11,770 --> 00:15:19,390
I'm going to start with a real example

322
00:15:15,790 --> 00:15:21,370
this is an attack that was suffered from

323
00:15:19,390 --> 00:15:23,490
one of our customers of course I'm not

324
00:15:21,370 --> 00:15:25,840
going to give any details about that

325
00:15:23,490 --> 00:15:27,610
same on the paper you will find the

326
00:15:25,840 --> 00:15:28,960
paper you will find the distribution of

327
00:15:27,610 --> 00:15:31,150
the companies that we were able to

328
00:15:28,960 --> 00:15:35,830
attack that of course no names are going

329
00:15:31,150 --> 00:15:38,840
to be disclosed whatsoever so this is an

330
00:15:35,830 --> 00:15:43,010
attack that one of our customers suffer

331
00:15:38,840 --> 00:15:45,050
this was through email campaigns and you

332
00:15:43,010 --> 00:15:48,620
will see that it will be quite similar

333
00:15:45,050 --> 00:15:53,209
to what you guys have to deal on their

334
00:15:48,620 --> 00:15:56,680
everyday basis at your jobs but you have

335
00:15:53,210 --> 00:16:00,320
a little twist for ACP now I want to

336
00:15:56,680 --> 00:16:03,709
make a very important classification and

337
00:16:00,320 --> 00:16:07,120
it will be that clarification will be

338
00:16:03,710 --> 00:16:10,130
applicable through all my presentation

339
00:16:07,120 --> 00:16:13,010
when I was finding myself creating the

340
00:16:10,130 --> 00:16:14,960
demos I have several live demos on live

341
00:16:13,010 --> 00:16:17,080
asleep assistants ha here on this

342
00:16:14,960 --> 00:16:20,840
machine that I'm going to show you I

343
00:16:17,080 --> 00:16:24,590
said oh my god I'm actually showing

344
00:16:20,840 --> 00:16:26,630
something very powerful and very it

345
00:16:24,590 --> 00:16:30,230
would be very easily to replicate to do

346
00:16:26,630 --> 00:16:32,720
bad stuff so I have added a few twists

347
00:16:30,230 --> 00:16:34,310
so it's not that simple to take the

348
00:16:32,720 --> 00:16:37,070
content of this presentation and create

349
00:16:34,310 --> 00:16:38,540
an actual malware just an FYI I'm going

350
00:16:37,070 --> 00:16:41,300
to make the clarifications whenever I

351
00:16:38,540 --> 00:16:42,560
find myself a little bit downgrading the

352
00:16:41,300 --> 00:16:44,660
attack I'm going to make the

353
00:16:42,560 --> 00:16:49,160
clarification so we can all be on the

354
00:16:44,660 --> 00:16:52,550
same page so put yourself in the mindset

355
00:16:49,160 --> 00:16:56,329
of an attacker let's suppose that you

356
00:16:52,550 --> 00:16:58,609
did the same task that I did that you

357
00:16:56,330 --> 00:17:01,880
were scouting the internet for ASAP

358
00:16:58,610 --> 00:17:04,160
systems you got the versions of the SAV

359
00:17:01,880 --> 00:17:05,829
systems and you want a point you're an

360
00:17:04,160 --> 00:17:09,260
attacker that wants to compromise a

361
00:17:05,829 --> 00:17:14,119
particular company that is running the

362
00:17:09,260 --> 00:17:17,500
ASAP systems what do you do well first

363
00:17:14,119 --> 00:17:21,139
then you start doing some of sindh right

364
00:17:17,500 --> 00:17:23,810
first you know the company you know that

365
00:17:21,140 --> 00:17:25,699
they use ap if they use AP you can

366
00:17:23,810 --> 00:17:28,610
suppose that they say be will be across

367
00:17:25,699 --> 00:17:32,270
the board right because you don't just

368
00:17:28,610 --> 00:17:35,090
buy one model you buy quite a lot if you

369
00:17:32,270 --> 00:17:39,440
know that if you know that the running

370
00:17:35,090 --> 00:17:41,720
is AP you can also infer that the

371
00:17:39,440 --> 00:17:44,240
company has a lot of people actually

372
00:17:41,720 --> 00:17:46,880
working there and when you have a lot of

373
00:17:44,240 --> 00:17:48,740
people work in a single company normally

374
00:17:46,880 --> 00:17:50,480
what you do you implement single sign-on

375
00:17:48,740 --> 00:17:51,830
so they don't have to remember like a

376
00:17:50,480 --> 00:17:54,140
thousand different password

377
00:17:51,830 --> 00:17:56,659
they can't just deal with one and login

378
00:17:54,140 --> 00:17:58,910
to multiple systems so you have multiple

379
00:17:56,660 --> 00:18:01,550
things that uses ap they have a lot of

380
00:17:58,910 --> 00:18:04,880
resources most likely a lot of Sapa

381
00:18:01,550 --> 00:18:06,860
assets and they use single sign-on what

382
00:18:04,880 --> 00:18:10,610
do you do and what happened to this

383
00:18:06,860 --> 00:18:14,300
customer well they send by email what is

384
00:18:10,610 --> 00:18:16,159
called SAP GUI scripts sub GUI scripting

385
00:18:14,300 --> 00:18:19,220
is a preparatory language that ACP has

386
00:18:16,160 --> 00:18:23,660
created that it will allow you to do for

387
00:18:19,220 --> 00:18:27,860
example stress testing on sa P it's very

388
00:18:23,660 --> 00:18:32,270
similar to we solve basic scripting if

389
00:18:27,860 --> 00:18:35,000
you send that on an attachment and I

390
00:18:32,270 --> 00:18:37,820
user double clicks on it it will

391
00:18:35,000 --> 00:18:41,270
automatically open your recipe Cline and

392
00:18:37,820 --> 00:18:43,879
I will start taking steps inside the SMP

393
00:18:41,270 --> 00:18:47,240
system ask the privilege of the victim

394
00:18:43,880 --> 00:18:50,240
that double-click at that attack in

395
00:18:47,240 --> 00:18:52,940
terms of analyzing the content of that

396
00:18:50,240 --> 00:18:55,100
file maybe you are thinking ok yeah but

397
00:18:52,940 --> 00:18:58,280
my antivirus should be able to handle

398
00:18:55,100 --> 00:19:00,980
that right well again remember that when

399
00:18:58,280 --> 00:19:03,410
we are on this ERP ward stylish

400
00:19:00,980 --> 00:19:05,360
solutions that were very well for the

401
00:19:03,410 --> 00:19:08,450
regular desktop afford a regular server

402
00:19:05,360 --> 00:19:10,159
will not do the trick on sa P so this is

403
00:19:08,450 --> 00:19:12,710
the scenario the attacker is going to

404
00:19:10,160 --> 00:19:15,140
same a malicious email that someone

405
00:19:12,710 --> 00:19:18,380
inside the users villain and being very

406
00:19:15,140 --> 00:19:21,170
generous here normally and unfortunately

407
00:19:18,380 --> 00:19:23,900
the users villain and the server villain

408
00:19:21,170 --> 00:19:25,929
on the es AP war well let's say that

409
00:19:23,900 --> 00:19:29,480
second leg of the firewall doesn't exist

410
00:19:25,929 --> 00:19:32,240
well let's be kind the user is on a

411
00:19:29,480 --> 00:19:33,740
separate VLAN that the server's the user

412
00:19:32,240 --> 00:19:35,770
will receive the detacher

413
00:19:33,740 --> 00:19:39,290
it will double click and it will trigger

414
00:19:35,770 --> 00:19:41,809
an action on the ESP system even though

415
00:19:39,290 --> 00:19:43,820
if you have a second firewall here still

416
00:19:41,809 --> 00:19:45,800
the firewall who had to allow access to

417
00:19:43,820 --> 00:19:47,480
the sa peep or because otherwise the

418
00:19:45,800 --> 00:19:51,470
roller people will not be able to work

419
00:19:47,480 --> 00:19:56,300
with it so let me show you what you will

420
00:19:51,470 --> 00:20:00,800
see on the ESP system this is the s AP

421
00:19:56,300 --> 00:20:02,780
system that I have for you I'm spilling

422
00:20:00,800 --> 00:20:04,610
a little bit the demo because we don't

423
00:20:02,780 --> 00:20:08,030
have a lot of time but this

424
00:20:04,610 --> 00:20:11,479
is the client that you see let me -

425
00:20:08,030 --> 00:20:14,559
let's see how much time you have to take

426
00:20:11,480 --> 00:20:14,559
that something wrong is happening

427
00:20:17,020 --> 00:20:22,610
basically what it does here I mean you

428
00:20:19,640 --> 00:20:24,559
can trigger any action whatsoever but

429
00:20:22,610 --> 00:20:27,379
basically what I'm doing here is I'm

430
00:20:24,559 --> 00:20:29,928
deleting and completely resetting the

431
00:20:27,380 --> 00:20:32,540
value of a table that was supposed to

432
00:20:29,929 --> 00:20:34,790
contain public debt you can do whatever

433
00:20:32,540 --> 00:20:37,010
you want here as long as you can put it

434
00:20:34,790 --> 00:20:38,928
on the attachment and if the user that

435
00:20:37,010 --> 00:20:41,780
is executing the stuff has enough

436
00:20:38,929 --> 00:20:43,610
privileges you can do pretty much

437
00:20:41,780 --> 00:20:45,590
whatever you want with the system you

438
00:20:43,610 --> 00:20:50,510
can even try to shut down the system if

439
00:20:45,590 --> 00:20:53,449
you can't you what this is too obvious

440
00:20:50,510 --> 00:20:55,910
right if someone wants to do something

441
00:20:53,450 --> 00:20:58,390
bad if someone's to do a real malware

442
00:20:55,910 --> 00:21:00,830
they had to do much better than this

443
00:20:58,390 --> 00:21:02,870
first of all you might be wondering okay

444
00:21:00,830 --> 00:21:05,149
how we can stop this scenario when

445
00:21:02,870 --> 00:21:09,739
someone sends me something malicious and

446
00:21:05,150 --> 00:21:11,990
at the same time I can keep my my stress

447
00:21:09,740 --> 00:21:14,570
testing going well you can keep the

448
00:21:11,990 --> 00:21:16,400
subdue scripting enable but you need to

449
00:21:14,570 --> 00:21:19,580
activate a profile parameter to this

450
00:21:16,400 --> 00:21:22,100
script / user scripting / user to true

451
00:21:19,580 --> 00:21:24,020
and once you do that only the user that

452
00:21:22,100 --> 00:21:27,860
has a particular Ettore session will be

453
00:21:24,020 --> 00:21:30,020
able to execute the scripts saying you

454
00:21:27,860 --> 00:21:33,199
can configure the ps-aguié to alert you

455
00:21:30,020 --> 00:21:41,059
whatever someone is trying to invoke one

456
00:21:33,200 --> 00:21:43,280
of those scripts so let's get more

457
00:21:41,059 --> 00:21:44,870
technical here let's see how a real man

458
00:21:43,280 --> 00:21:47,330
work could affect the systems that are

459
00:21:44,870 --> 00:21:49,939
exposed on the Internet

460
00:21:47,330 --> 00:21:52,010
as I told you before we wanted to help

461
00:21:49,940 --> 00:21:53,960
but we need to put ourself in the

462
00:21:52,010 --> 00:21:57,140
mindset of an attacker before we can

463
00:21:53,960 --> 00:21:58,940
actually try to help we need to

464
00:21:57,140 --> 00:22:01,429
understand the threat before we can

465
00:21:58,940 --> 00:22:04,760
recommend a solution so what we did is

466
00:22:01,429 --> 00:22:06,980
we studied mal words in the past and we

467
00:22:04,760 --> 00:22:09,590
started to get some common patterns that

468
00:22:06,980 --> 00:22:11,480
all of those malware share they were

469
00:22:09,590 --> 00:22:14,330
designed to hit fast and they were

470
00:22:11,480 --> 00:22:17,200
designed to hit a car for a malware

471
00:22:14,330 --> 00:22:19,149
lateral movement was goal

472
00:22:17,200 --> 00:22:22,420
the main objective was to spread as fast

473
00:22:19,150 --> 00:22:25,420
as they can and most of the time making

474
00:22:22,420 --> 00:22:29,010
noise avoid making noise was not a

475
00:22:25,420 --> 00:22:32,500
priority also and this is very common

476
00:22:29,010 --> 00:22:34,450
the MAL war itself the framework is not

477
00:22:32,500 --> 00:22:37,450
necessarily attached to a vulnerability

478
00:22:34,450 --> 00:22:38,890
what happens here is that in general the

479
00:22:37,450 --> 00:22:40,530
attackers especially the most

480
00:22:38,890 --> 00:22:43,540
sophisticated ones they already have a

481
00:22:40,530 --> 00:22:46,180
framework for the malware distribution

482
00:22:43,540 --> 00:22:48,129
and then they put them in ability on top

483
00:22:46,180 --> 00:22:51,460
to create that point of access it's the

484
00:22:48,130 --> 00:22:52,990
same as having a gun and a bullet not

485
00:22:51,460 --> 00:22:57,840
necessarily have to be the same thing

486
00:22:52,990 --> 00:23:01,600
and these will be or a scenario again

487
00:22:57,840 --> 00:23:03,820
the attacker will be connecting through

488
00:23:01,600 --> 00:23:06,610
the internet to a front end system that

489
00:23:03,820 --> 00:23:08,350
system will be on Java the front end

490
00:23:06,610 --> 00:23:10,719
system will be speaking to another

491
00:23:08,350 --> 00:23:14,560
back-end system on the DMZ this is a

492
00:23:10,720 --> 00:23:16,960
very common setup and look at this that

493
00:23:14,560 --> 00:23:19,179
back in a bad system is also connected

494
00:23:16,960 --> 00:23:21,640
to tones of a safe assistance on the

495
00:23:19,180 --> 00:23:23,260
internal network that might sound a

496
00:23:21,640 --> 00:23:25,480
little bit strange to you if you're not

497
00:23:23,260 --> 00:23:27,879
that familiar with s IP let me tell you

498
00:23:25,480 --> 00:23:32,230
that this ap has been designed to be

499
00:23:27,880 --> 00:23:34,120
highly interconnected all the ESP

500
00:23:32,230 --> 00:23:36,490
systems will be talking to each other

501
00:23:34,120 --> 00:23:38,409
how we don't care we don't have time to

502
00:23:36,490 --> 00:23:39,490
learn that but you had to take my word

503
00:23:38,410 --> 00:23:42,070
that these systems will be

504
00:23:39,490 --> 00:23:44,670
interconnected an attacker that wants to

505
00:23:42,070 --> 00:23:47,350
attack a nice abcs thing will know that

506
00:23:44,670 --> 00:23:49,660
so what do we do what we're going to

507
00:23:47,350 --> 00:23:52,409
break it on steps first we're going to

508
00:23:49,660 --> 00:23:55,120
break in on the front-end Java system

509
00:23:52,410 --> 00:23:58,240
then we're gonna get some credentials

510
00:23:55,120 --> 00:24:00,820
for the system we're going to try to do

511
00:23:58,240 --> 00:24:04,540
lateral movement with that we're going

512
00:24:00,820 --> 00:24:06,220
to escape the DMC and also finally we

513
00:24:04,540 --> 00:24:08,649
are going to give an example of how you

514
00:24:06,220 --> 00:24:10,420
can even attack the clients the

515
00:24:08,650 --> 00:24:13,570
workstation that are connected to the

516
00:24:10,420 --> 00:24:16,120
ASAP system at that moment again a full

517
00:24:13,570 --> 00:24:18,879
malware will not be shown of course for

518
00:24:16,120 --> 00:24:22,479
obvious reasons but I will show you some

519
00:24:18,880 --> 00:24:24,460
code of a as well and not release it but

520
00:24:22,480 --> 00:24:25,930
I will show you later on after this

521
00:24:24,460 --> 00:24:28,390
presentation if you have doubts or

522
00:24:25,930 --> 00:24:30,360
questions about the code let me know and

523
00:24:28,390 --> 00:24:34,659
I can show you a little bit

524
00:24:30,360 --> 00:24:37,360
so we're going to heat that front end

525
00:24:34,659 --> 00:24:40,630
ASAP system we have different ways to do

526
00:24:37,360 --> 00:24:42,520
it this is the time when I'm degrading

527
00:24:40,630 --> 00:24:44,590
myself the attack I'm going to show you

528
00:24:42,520 --> 00:24:47,260
with an exploit that is relatively all

529
00:24:44,590 --> 00:24:49,629
there is one exploit and it's only three

530
00:24:47,260 --> 00:24:51,730
months all the words like a charm it's a

531
00:24:49,630 --> 00:24:54,100
remote command execution but for obvious

532
00:24:51,730 --> 00:24:56,679
reason I'm not going to show you we're

533
00:24:54,100 --> 00:24:59,320
going to do it with an exploit that

534
00:24:56,679 --> 00:25:02,740
still works very well by our

535
00:24:59,320 --> 00:25:04,899
calculations 20% of the java systems

536
00:25:02,740 --> 00:25:08,710
that we found still are vulnerable a

537
00:25:04,899 --> 00:25:12,428
little bit more almost 30% let me show

538
00:25:08,710 --> 00:25:13,990
you and this one in particular it

539
00:25:12,429 --> 00:25:17,740
doesn't matter even if you have a waffle

540
00:25:13,990 --> 00:25:19,630
there it will still work like a charm so

541
00:25:17,740 --> 00:25:23,890
look at this this is the URL that we're

542
00:25:19,630 --> 00:25:26,320
going to use by just knowing the URL we

543
00:25:23,890 --> 00:25:28,270
can literally send the command that we

544
00:25:26,320 --> 00:25:30,639
want to execute and it's going to be

545
00:25:28,270 --> 00:25:33,970
executed under the privileges of the

546
00:25:30,640 --> 00:25:35,679
user that is running the ASAP system I'm

547
00:25:33,970 --> 00:25:38,620
going to show you real quick because we

548
00:25:35,679 --> 00:25:40,690
don't have tones of time but basically

549
00:25:38,620 --> 00:25:42,520
you can do whatever you want as you can

550
00:25:40,690 --> 00:25:45,820
see we're running under the service

551
00:25:42,520 --> 00:25:48,370
account that is being used by ASAP we

552
00:25:45,820 --> 00:25:51,039
can execute the net users we can do

553
00:25:48,370 --> 00:25:53,289
whatever we want in terms of the SOPs

554
00:25:51,039 --> 00:25:56,020
then we can shut down the system or we

555
00:25:53,289 --> 00:25:57,908
can jump to the database we are using of

556
00:25:56,020 --> 00:26:00,460
the trust relationship that always

557
00:25:57,909 --> 00:26:02,049
always the web application servers will

558
00:26:00,460 --> 00:26:05,950
maintain with the database without

559
00:26:02,049 --> 00:26:10,658
providing any username password so

560
00:26:05,950 --> 00:26:14,409
pretty much at this point if we go back

561
00:26:10,659 --> 00:26:17,940
to this scenario the front-end system

562
00:26:14,409 --> 00:26:23,260
Java is completely compromised we had

563
00:26:17,940 --> 00:26:25,809
command execution there we won now

564
00:26:23,260 --> 00:26:30,760
harvest credentials are start jumping

565
00:26:25,809 --> 00:26:33,070
around so what you can do to stop the

566
00:26:30,760 --> 00:26:35,529
attacker at this point before we move

567
00:26:33,070 --> 00:26:37,570
forward well this one ability in

568
00:26:35,529 --> 00:26:39,700
particular is something that is called

569
00:26:37,570 --> 00:26:41,500
invoker servlet basically Sonny said

570
00:26:39,700 --> 00:26:43,090
it's an application that they say P will

571
00:26:41,500 --> 00:26:46,270
ship by default but

572
00:26:43,090 --> 00:26:48,189
ASAP uses to install itself that's why

573
00:26:46,270 --> 00:26:50,050
it's so powerful that's why it's so

574
00:26:48,190 --> 00:26:51,580
simple that it just paste the common

575
00:26:50,050 --> 00:26:54,310
there and gets executed without

576
00:26:51,580 --> 00:26:56,290
credentials that an in combination of an

577
00:26:54,310 --> 00:27:01,060
attack maybe some of you have heard

578
00:26:56,290 --> 00:27:03,070
about the verb tampering attacks you can

579
00:27:01,060 --> 00:27:05,950
combine these with those bird tampering

580
00:27:03,070 --> 00:27:07,419
techniques basically the servlet is

581
00:27:05,950 --> 00:27:10,000
configured that if you'll receive our

582
00:27:07,420 --> 00:27:13,930
requests through get or pause should ask

583
00:27:10,000 --> 00:27:16,710
for authentication but that vision of

584
00:27:13,930 --> 00:27:19,930
the HTTP verbs is so nighties

585
00:27:16,710 --> 00:27:22,300
some of you might know that yet can

586
00:27:19,930 --> 00:27:26,590
actually be replaced by here and pause

587
00:27:22,300 --> 00:27:28,300
can actually be replaced by put so guess

588
00:27:26,590 --> 00:27:30,370
what happens when you set ahead instead

589
00:27:28,300 --> 00:27:33,190
of again you get a command execution

590
00:27:30,370 --> 00:27:38,050
without authentication directly on the s

591
00:27:33,190 --> 00:27:40,450
AP works very well so we compromised

592
00:27:38,050 --> 00:27:42,760
this java system we want credentials

593
00:27:40,450 --> 00:27:45,190
what do we do now there is something

594
00:27:42,760 --> 00:27:47,770
again this is a default built-in

595
00:27:45,190 --> 00:27:50,410
mechanism unless a P that is called

596
00:27:47,770 --> 00:27:52,960
secure storage basically is a file on

597
00:27:50,410 --> 00:27:56,830
the file system and created with Triple

598
00:27:52,960 --> 00:27:59,170
DES that will hold the complete JDBC the

599
00:27:56,830 --> 00:28:01,179
connection chain to the database so we

600
00:27:59,170 --> 00:28:04,120
will hide the database password and it

601
00:28:01,180 --> 00:28:08,110
will also contain the SIV administrators

602
00:28:04,120 --> 00:28:10,120
password by itself it doesn't say

603
00:28:08,110 --> 00:28:12,610
anything you might be thinking okay so

604
00:28:10,120 --> 00:28:16,989
what's the deal there well the pronin is

605
00:28:12,610 --> 00:28:19,449
that this a Triple DES secure file has a

606
00:28:16,990 --> 00:28:22,210
hard-coded key so if you reverse

607
00:28:19,450 --> 00:28:24,850
engineer that and you get the hard coded

608
00:28:22,210 --> 00:28:27,550
key guess what you can get their

609
00:28:24,850 --> 00:28:31,959
credentials and it's exactly what we're

610
00:28:27,550 --> 00:28:35,110
going to do and of course this is Java

611
00:28:31,960 --> 00:28:38,500
so is very trivial to just get the jar

612
00:28:35,110 --> 00:28:41,830
reverse engineer you will need a key you

613
00:28:38,500 --> 00:28:44,980
will need that key the hard coded key

614
00:28:41,830 --> 00:28:46,960
and once you have that there are many

615
00:28:44,980 --> 00:28:50,500
ways to open the secure storage

616
00:28:46,960 --> 00:28:52,780
this tool is actually open source I have

617
00:28:50,500 --> 00:28:55,180
for a long time but if you google on the

618
00:28:52,780 --> 00:28:56,740
internet you will find it basically gets

619
00:28:55,180 --> 00:29:00,130
the file system

620
00:28:56,740 --> 00:29:01,990
the Crips it and there is you get the

621
00:29:00,130 --> 00:29:08,200
most important passwords on the ASAP

622
00:29:01,990 --> 00:29:09,490
system the security stores just this is

623
00:29:08,200 --> 00:29:11,860
for you for your reference because we

624
00:29:09,490 --> 00:29:14,110
know sometime those are the two files

625
00:29:11,860 --> 00:29:17,139
that we have there and basically will

626
00:29:14,110 --> 00:29:21,459
contain the master password we're going

627
00:29:17,140 --> 00:29:24,070
to see one master password is so we have

628
00:29:21,460 --> 00:29:25,779
compromised the DSA P system we want to

629
00:29:24,070 --> 00:29:28,418
compromise the evap system that is on

630
00:29:25,779 --> 00:29:30,789
the DM see how we do it we could do SMB

631
00:29:28,419 --> 00:29:33,580
we can do SSH trying to realize the

632
00:29:30,789 --> 00:29:36,730
credentials that we have or we can use a

633
00:29:33,580 --> 00:29:38,740
built-in mechanism called jzo basically

634
00:29:36,730 --> 00:29:40,840
jco is the way to this ap has

635
00:29:38,740 --> 00:29:44,830
implemented for a Java system to be able

636
00:29:40,840 --> 00:29:47,320
to speak with the a verb system it is

637
00:29:44,830 --> 00:29:51,158
the JCL destination will end up in the

638
00:29:47,320 --> 00:29:54,158
database encrypted but unfortunately

639
00:29:51,159 --> 00:29:57,450
they use exactly the same algorithm that

640
00:29:54,159 --> 00:30:00,490
we saw before on the secure storage and

641
00:29:57,450 --> 00:30:02,380
unfortunately they use the same hard

642
00:30:00,490 --> 00:30:05,020
coded key that we saw with the same

643
00:30:02,380 --> 00:30:07,899
algorithm so if you had that you choose

644
00:30:05,020 --> 00:30:09,789
can perform a remote connection with

645
00:30:07,899 --> 00:30:12,340
something that is called alpha Sita is a

646
00:30:09,789 --> 00:30:15,669
proprietary protocol that is a big Hoss

647
00:30:12,340 --> 00:30:19,899
and executes other commands on the

648
00:30:15,669 --> 00:30:22,960
remote system that's it you didn't touch

649
00:30:19,899 --> 00:30:25,389
much you choose execute something that

650
00:30:22,960 --> 00:30:28,570
is called RF EC some remote function

651
00:30:25,390 --> 00:30:32,740
call directly towards the ASAP system

652
00:30:28,570 --> 00:30:35,260
and for example here I'm obtaining the

653
00:30:32,740 --> 00:30:38,950
user tables of the system that is on the

654
00:30:35,260 --> 00:30:41,529
DMZ as well with the hashes you just put

655
00:30:38,950 --> 00:30:45,970
that on G on the Reaper and you make a

656
00:30:41,529 --> 00:30:47,980
disaster so what is this master password

657
00:30:45,970 --> 00:30:50,980
that I am quickly mentioning about well

658
00:30:47,980 --> 00:30:54,309
this is this is quite bad

659
00:30:50,980 --> 00:30:56,500
to be honest I'm going to speed up when

660
00:30:54,309 --> 00:30:58,539
you install an SCP system ASAP is going

661
00:30:56,500 --> 00:31:01,779
to tell you a do you want to use some

662
00:30:58,539 --> 00:31:03,520
master password or do you want to set a

663
00:31:01,779 --> 00:31:05,649
password for each one of the SAV

664
00:31:03,520 --> 00:31:10,269
accounts if you choose the master

665
00:31:05,649 --> 00:31:13,718
password the biggest our most powerful

666
00:31:10,269 --> 00:31:17,830
Sebby application users the operating

667
00:31:13,719 --> 00:31:21,129
system user and the database user will

668
00:31:17,830 --> 00:31:23,199
share will all share that same password

669
00:31:21,129 --> 00:31:24,820
that you configure it will be pretty

670
00:31:23,200 --> 00:31:26,549
much everywhere on the most important

671
00:31:24,820 --> 00:31:29,708
layers that you have out there and

672
00:31:26,549 --> 00:31:32,440
unfortunately this is the option that

673
00:31:29,709 --> 00:31:35,379
comes by default if you are a CEO on

674
00:31:32,440 --> 00:31:37,959
next clicker if you do next next next

675
00:31:35,379 --> 00:31:39,580
next next next you will end up with a

676
00:31:37,959 --> 00:31:41,169
master password and according to my

677
00:31:39,580 --> 00:31:43,928
research and according to the author

678
00:31:41,169 --> 00:31:46,269
pentesters that I do 95% of the

679
00:31:43,929 --> 00:31:47,799
customers use the master password it's

680
00:31:46,269 --> 00:31:50,619
unfortunate because if you break one

681
00:31:47,799 --> 00:31:54,789
layer all the other layers will fall

682
00:31:50,619 --> 00:31:57,879
apart I'm pretty much once you have the

683
00:31:54,789 --> 00:32:00,309
master password you can start doing what

684
00:31:57,879 --> 00:32:03,149
is called the RF EC destination once for

685
00:32:00,309 --> 00:32:06,639
you even you can choose put there SMB

686
00:32:03,149 --> 00:32:07,869
Remote Desktop SSH whatever you want

687
00:32:06,639 --> 00:32:10,418
because you know that the master

688
00:32:07,869 --> 00:32:12,728
password is being used and you know that

689
00:32:10,419 --> 00:32:15,159
you can utilize those privilege pretty

690
00:32:12,729 --> 00:32:23,379
much everywhere or at least you can

691
00:32:15,159 --> 00:32:24,940
infer thinking in your attacks so bonus

692
00:32:23,379 --> 00:32:28,178
track because we're running out of time

693
00:32:24,940 --> 00:32:30,639
I told you that a part of compromising

694
00:32:28,179 --> 00:32:32,799
the DMC a part of compromising the first

695
00:32:30,639 --> 00:32:35,589
system Java system a pair of currents

696
00:32:32,799 --> 00:32:38,709
harvesting the credentials I told you

697
00:32:35,589 --> 00:32:41,139
that you could do stuff to the customers

698
00:32:38,709 --> 00:32:45,609
that are currently connecting to the

699
00:32:41,139 --> 00:32:47,738
ASAP system well I decided to make it a

700
00:32:45,609 --> 00:32:49,928
truce on title is called soap or FEC

701
00:32:47,739 --> 00:32:51,759
basically it's an application that is a

702
00:32:49,929 --> 00:32:55,299
web application that is IP has out there

703
00:32:51,759 --> 00:32:57,399
that you can consume on the internet it

704
00:32:55,299 --> 00:33:00,190
doesn't calm anybody fall but is quite

705
00:32:57,399 --> 00:33:03,758
popular that basically will translate a

706
00:33:00,190 --> 00:33:06,549
soap message a so packet into orefici

707
00:33:03,759 --> 00:33:10,179
into this private area ref ec protocol

708
00:33:06,549 --> 00:33:14,259
basically what we're going to do here is

709
00:33:10,179 --> 00:33:19,779
use an RPC application that will send

710
00:33:14,259 --> 00:33:22,089
messages to the ASAP users I'm not sure

711
00:33:19,779 --> 00:33:23,980
if you can see it very well here but

712
00:33:22,089 --> 00:33:26,139
that is the so message that you

713
00:33:23,980 --> 00:33:28,720
to use basically what I'm going to do

714
00:33:26,139 --> 00:33:31,209
here is just for a user Jordan but you

715
00:33:28,720 --> 00:33:33,159
can definitely apply this to all the

716
00:33:31,210 --> 00:33:35,669
user that are connecting to the ASAP

717
00:33:33,159 --> 00:33:40,690
system I think nachos are in an asterisk

718
00:33:35,669 --> 00:33:44,139
what we're going to tell them what we're

719
00:33:40,690 --> 00:33:46,120
going to tell basically to the user that

720
00:33:44,139 --> 00:33:49,269
is connected right now at the moment to

721
00:33:46,120 --> 00:33:51,489
the ASAP system as I am right here we're

722
00:33:49,269 --> 00:33:54,610
going to tell them a something is wrong

723
00:33:51,490 --> 00:34:01,090
with your SAV GUI configuration in order

724
00:33:54,610 --> 00:34:03,908
to fix it you need to go to this sketchy

725
00:34:01,090 --> 00:34:06,010
URL and download the package basically

726
00:34:03,909 --> 00:34:11,770
what you will do is some sort of an

727
00:34:06,010 --> 00:34:13,929
advanced social engineer message you can

728
00:34:11,770 --> 00:34:15,849
push it through all the cysts all day a

729
00:34:13,929 --> 00:34:18,129
clients all the human beings that are

730
00:34:15,849 --> 00:34:21,040
connecting right now to the s IP system

731
00:34:18,129 --> 00:34:25,440
and the message will come as if it comes

732
00:34:21,040 --> 00:34:31,109
from the SP system itself so you have

733
00:34:25,440 --> 00:34:33,940
you have some sort of fake certainty or

734
00:34:31,109 --> 00:34:39,909
fake validation that it comes from the

735
00:34:33,940 --> 00:34:44,649
server okay so for my last three minutes

736
00:34:39,909 --> 00:34:50,470
I going to do a wrap-up so what do we

737
00:34:44,649 --> 00:34:53,379
learn today the only if you are going to

738
00:34:50,469 --> 00:34:57,250
take one thing from this talk I wanted

739
00:34:53,379 --> 00:35:01,000
to take this particular question do you

740
00:34:57,250 --> 00:35:03,550
need do you actually need to expose your

741
00:35:01,000 --> 00:35:04,990
recipe systems to the Internet it's the

742
00:35:03,550 --> 00:35:07,599
very first question that you need to ask

743
00:35:04,990 --> 00:35:10,390
yourself those he had to be directly

744
00:35:07,599 --> 00:35:12,130
exposed to the Internet why not the BPM

745
00:35:10,390 --> 00:35:15,609
why not some sort of Citrix environment

746
00:35:12,130 --> 00:35:18,579
also be very careful with this ids/ips

747
00:35:15,609 --> 00:35:20,799
wofe because my give you a false sense

748
00:35:18,579 --> 00:35:22,480
of security if you're gonna put

749
00:35:20,800 --> 00:35:25,210
something putana say beware dispatcher

750
00:35:22,480 --> 00:35:27,880
there is a free utility dice if he gives

751
00:35:25,210 --> 00:35:31,300
you to restrict access to the name the

752
00:35:27,880 --> 00:35:33,609
web pages apply patches apply patches

753
00:35:31,300 --> 00:35:36,280
apply patches it's very controlled

754
00:35:33,609 --> 00:35:37,840
assuring SAV because even as I be very

755
00:35:36,280 --> 00:35:39,460
thick as a bit patches have

756
00:35:37,840 --> 00:35:41,320
known to cause disruption on the

757
00:35:39,460 --> 00:35:45,670
subsistence but you still need to apply

758
00:35:41,320 --> 00:35:50,200
them be sure that your sock is si be

759
00:35:45,670 --> 00:35:52,420
aware more often than not they will not

760
00:35:50,200 --> 00:35:54,250
I always like to joke that it's like a

761
00:35:52,420 --> 00:35:56,140
Venn diagram that never intercepts from

762
00:35:54,250 --> 00:35:58,420
one say you have IT security and from

763
00:35:56,140 --> 00:36:01,600
other side you have a city security but

764
00:35:58,420 --> 00:36:04,420
they not usually know the job of the

765
00:36:01,600 --> 00:36:07,270
other I'm think I finally prevent

766
00:36:04,420 --> 00:36:10,870
prevent prevent if we get to do a phone

767
00:36:07,270 --> 00:36:13,360
and 16s ap we are too late and more

768
00:36:10,870 --> 00:36:16,359
often than not we will not have all the

769
00:36:13,360 --> 00:36:19,210
information that we need okay so I think

770
00:36:16,360 --> 00:36:21,970
we are right on time thank you very much

771
00:36:19,210 --> 00:36:23,650
for assisting my presentation and I

772
00:36:21,970 --> 00:36:25,509
think we have time for one more question

773
00:36:23,650 --> 00:36:27,060
so thank you very much thank you for

774
00:36:25,510 --> 00:36:32,869
your time

775
00:36:27,060 --> 00:36:32,869
[Applause]

