1
00:00:07,300 --> 00:00:13,270
everyone once you are Wawa

2
00:00:15,190 --> 00:00:23,029
this are the presentation let's talk a

3
00:00:19,850 --> 00:00:27,769
bit about a presentation I'm going to

4
00:00:23,029 --> 00:00:30,500
present a cool whatever you want to

5
00:00:27,769 --> 00:00:35,089
pronounce it if a network implant design

6
00:00:30,500 --> 00:00:37,399
for Cisco and we go into details what

7
00:00:35,090 --> 00:00:40,129
you see just here before the person

8
00:00:37,399 --> 00:00:42,289
estar is I need to simulate the network

9
00:00:40,129 --> 00:00:45,500
infrastructure so this is actually a

10
00:00:42,289 --> 00:00:51,920
network in the box when power switches

11
00:00:45,500 --> 00:00:55,609
BOE DNS DSP Internet as well so you will

12
00:00:51,920 --> 00:01:01,129
see that little yellow box sorry blue

13
00:00:55,609 --> 00:01:02,600
box is my internet server there's also a

14
00:01:01,129 --> 00:01:03,890
phone connected in the network like you

15
00:01:02,600 --> 00:01:07,250
would see in any other network and I'd

16
00:01:03,890 --> 00:01:10,190
be fun pou so this is currently how it

17
00:01:07,250 --> 00:01:12,009
is set up so let me start a presentation

18
00:01:10,190 --> 00:01:18,979
[Music]

19
00:01:12,009 --> 00:01:22,189
first my name I'm a media media both

20
00:01:18,979 --> 00:01:24,799
ways works I like to play with packets a

21
00:01:22,189 --> 00:01:28,880
lot electronics and 3d printers just for

22
00:01:24,799 --> 00:01:32,530
fun I did present a couple of tools the

23
00:01:28,880 --> 00:01:37,330
Paris conference each one are Americans

24
00:01:32,530 --> 00:01:42,880
no immediate programmer neither Japanese

25
00:01:37,330 --> 00:01:45,940
speaker but combined mass alright this

26
00:01:42,880 --> 00:01:49,449
is version 1.5 of the tune so what is

27
00:01:45,940 --> 00:01:52,600
new in this version is that now we are

28
00:01:49,450 --> 00:01:54,910
how to integrate the phone and the

29
00:01:52,600 --> 00:01:57,610
implant at the same time inversions

30
00:01:54,910 --> 00:01:58,770
before you once you use that the phone

31
00:01:57,610 --> 00:02:01,620
stopped working

32
00:01:58,770 --> 00:02:04,570
also we graph all packets with the

33
00:02:01,620 --> 00:02:06,610
natives copy and we had another

34
00:02:04,570 --> 00:02:10,329
expectation technique through MTP

35
00:02:06,610 --> 00:02:13,750
protocol we also blue to encryption for

36
00:02:10,330 --> 00:02:19,000
preventing forensic and self destroy

37
00:02:13,750 --> 00:02:20,050
switch we bypass snack now so knock will

38
00:02:19,000 --> 00:02:23,590
not find out anymore

39
00:02:20,050 --> 00:02:25,150
and in intraday adventures integration

40
00:02:23,590 --> 00:02:28,960
into feral I which is a different tool

41
00:02:25,150 --> 00:02:32,320
right so this this is the persons that

42
00:02:28,960 --> 00:02:34,930
we look to target maybe your automation

43
00:02:32,320 --> 00:02:37,180
sisters like I just named a few of them

44
00:02:34,930 --> 00:02:39,250
they all work very similar the concept

45
00:02:37,180 --> 00:02:41,410
is when you plug a new switch into the

46
00:02:39,250 --> 00:02:43,390
network the information so they will

47
00:02:41,410 --> 00:02:46,450
discover the new switch and connected to

48
00:02:43,390 --> 00:02:49,179
pull inventory configurations this is

49
00:02:46,450 --> 00:02:51,760
how to mention worked in many Enterprise

50
00:02:49,180 --> 00:02:54,120
so these are an example of the tools

51
00:02:51,760 --> 00:02:57,010
probably no knack for example is a

52
00:02:54,120 --> 00:02:58,989
network access control and the idea is

53
00:02:57,010 --> 00:03:02,019
to prevent you connecting a like a

54
00:02:58,989 --> 00:03:05,350
Raspberry Pi or a laptop that is not

55
00:03:02,019 --> 00:03:07,209
part of the company and of course you

56
00:03:05,350 --> 00:03:09,970
can manually also connect to the device

57
00:03:07,209 --> 00:03:12,360
they fake switch and we want to

58
00:03:09,970 --> 00:03:12,359
implement

59
00:03:12,610 --> 00:03:20,550
devolution how this all started right

60
00:03:16,690 --> 00:03:24,160
let me talk in memory lane so we start

61
00:03:20,550 --> 00:03:26,260
with version demo box version 1 which

62
00:03:24,160 --> 00:03:26,859
was was literally built on a cardboard

63
00:03:26,260 --> 00:03:31,359
box

64
00:03:26,860 --> 00:03:32,230
we tied up pipes and it was a POC and it

65
00:03:31,360 --> 00:03:35,320
actually work

66
00:03:32,230 --> 00:03:38,280
fine and then we move into version 1.4

67
00:03:35,320 --> 00:03:41,769
the jumper thing and we managed to put

68
00:03:38,280 --> 00:03:45,100
the components inside a network outlet

69
00:03:41,770 --> 00:03:48,870
so they look like this you probably saw

70
00:03:45,100 --> 00:03:48,870
them under your desk in your companies

71
00:03:49,350 --> 00:03:55,690
these boxes see so what I managed to do

72
00:03:53,860 --> 00:03:57,970
is inside these boxes to put electronic

73
00:03:55,690 --> 00:04:01,109
donuts and the problem we have in

74
00:03:57,970 --> 00:04:04,209
version 4 was a POA problem because I

75
00:04:01,110 --> 00:04:06,190
can take the PUA from the phone but the

76
00:04:04,209 --> 00:04:08,080
phone will not work anymore so that was

77
00:04:06,190 --> 00:04:10,109
the problem with rushing for as you can

78
00:04:08,080 --> 00:04:14,350
see only one cable can connect at a time

79
00:04:10,110 --> 00:04:16,359
now in version 1.5 this version I'm

80
00:04:14,350 --> 00:04:18,159
going to show you are able to keep the

81
00:04:16,358 --> 00:04:21,820
phone working and use the network

82
00:04:18,160 --> 00:04:25,690
implant at the same time so how this is

83
00:04:21,820 --> 00:04:27,640
all built is well they say power

84
00:04:25,690 --> 00:04:29,410
component are we going to do this and

85
00:04:27,640 --> 00:04:31,870
they say software component the

86
00:04:29,410 --> 00:04:34,419
component we have is basically three

87
00:04:31,870 --> 00:04:37,060
main components one is our software

88
00:04:34,419 --> 00:04:39,700
component in the infinite EPS maybe just

89
00:04:37,060 --> 00:04:45,010
right and so forth which is this blue

90
00:04:39,700 --> 00:04:49,510
box here which is a VPS in the Amazon a

91
00:04:45,010 --> 00:04:51,610
public internet server software holy so

92
00:04:49,510 --> 00:04:53,650
then we have the cilco itself which is

93
00:04:51,610 --> 00:04:54,850
the Harvard component is designed you to

94
00:04:53,650 --> 00:04:57,429
go to

95
00:04:54,850 --> 00:04:57,850
funny in a meeting room in a reception

96
00:04:57,430 --> 00:05:00,040
area

97
00:04:57,850 --> 00:05:02,230
whatever you say might be fun that's why

98
00:05:00,040 --> 00:05:04,890
you want an empty desk so this is what I

99
00:05:02,230 --> 00:05:07,600
want to do you want to put this box here

100
00:05:04,890 --> 00:05:10,030
why if for me because the phones run on

101
00:05:07,600 --> 00:05:11,440
Tue so I need the period to power up

102
00:05:10,030 --> 00:05:13,750
this this doesn't run on batteries

103
00:05:11,440 --> 00:05:16,060
there's no battery here and there's one

104
00:05:13,750 --> 00:05:17,980
more component of Paola which is it

105
00:05:16,060 --> 00:05:21,090
again software component and is designed

106
00:05:17,980 --> 00:05:24,820
for exfiltration technique via wireless

107
00:05:21,090 --> 00:05:28,419
is it main Python - and is currently

108
00:05:24,820 --> 00:05:30,400
under Python 3 ongoing migration and

109
00:05:28,420 --> 00:05:32,890
it's basically this behaviour a honeypot

110
00:05:30,400 --> 00:05:35,109
so you will actually trade your

111
00:05:32,890 --> 00:05:37,060
automation systems in to believe there's

112
00:05:35,110 --> 00:05:39,010
a new Cisco switch in the middle they

113
00:05:37,060 --> 00:05:40,870
will connect to me they will give me the

114
00:05:39,010 --> 00:05:43,240
credentials they use for all network

115
00:05:40,870 --> 00:05:45,550
because they're optimation systems and

116
00:05:43,240 --> 00:05:48,040
what once I get that data users and

117
00:05:45,550 --> 00:05:50,560
passwords I would actually try to cut

118
00:05:48,040 --> 00:05:52,450
back which is the way incumbent so it's

119
00:05:50,560 --> 00:05:54,310
a combination of a honeypot pretending

120
00:05:52,450 --> 00:05:56,560
to be a Cisco switch and expectation

121
00:05:54,310 --> 00:05:59,110
techniques and we go into the details

122
00:05:56,560 --> 00:06:01,210
but just to give you an overview the

123
00:05:59,110 --> 00:06:06,520
kind of edge filtration techniques we

124
00:06:01,210 --> 00:06:09,820
use the ICMP traceroute MTP HTTP HTTP

125
00:06:06,520 --> 00:06:12,340
DNS proxy and wireless those are

126
00:06:09,820 --> 00:06:14,260
currently the ones that each box is

127
00:06:12,340 --> 00:06:18,489
supported so you can choose which one

128
00:06:14,260 --> 00:06:20,770
you want all of them there's an extra

129
00:06:18,490 --> 00:06:23,380
thing going on that because sometimes

130
00:06:20,770 --> 00:06:26,229
you plug a PC to a phone it's commenting

131
00:06:23,380 --> 00:06:28,060
the components to say taking so now what

132
00:06:26,230 --> 00:06:30,400
happen is I can also get all the

133
00:06:28,060 --> 00:06:32,380
credentials from the PC going to the

134
00:06:30,400 --> 00:06:36,460
network as well so that is coming on a

135
00:06:32,380 --> 00:06:40,240
different release just to mention it at

136
00:06:36,460 --> 00:06:42,549
any time you can ask questions right

137
00:06:40,240 --> 00:06:44,200
what is the Harry Potter we create but

138
00:06:42,550 --> 00:06:47,350
we need to pretend to be a Cisco switch

139
00:06:44,200 --> 00:06:51,630
so CBP need to be able to community CDB

140
00:06:47,350 --> 00:06:54,070
and LDP need to be SNMP responsible

141
00:06:51,630 --> 00:06:57,230
yeah need to respond like a Cisco switch

142
00:06:54,070 --> 00:06:59,900
SNMP you need to have a talent interface

143
00:06:57,230 --> 00:07:04,400
have a iOS commands we do have an ssh

144
00:06:59,900 --> 00:07:06,830
interface and also when nak found this

145
00:07:04,400 --> 00:07:08,690
new switch not with actually the

146
00:07:06,830 --> 00:07:10,729
fingerprint always fingerprint and

147
00:07:08,690 --> 00:07:13,670
service fingerprint and those need to

148
00:07:10,730 --> 00:07:16,550
reply back as a Cisco switch remember if

149
00:07:13,670 --> 00:07:20,360
not not will block us with realizing is

150
00:07:16,550 --> 00:07:22,250
not the Cisco switch so this is a

151
00:07:20,360 --> 00:07:24,740
high-level overview because everyone

152
00:07:22,250 --> 00:07:26,170
want to see the demo right miss you okay

153
00:07:24,740 --> 00:07:29,480
let's see

154
00:07:26,170 --> 00:07:32,570
demo funny right before we go into the

155
00:07:29,480 --> 00:07:35,420
demo I will show the lab just to give

156
00:07:32,570 --> 00:07:39,740
you an idea where we stand him so this

157
00:07:35,420 --> 00:07:41,450
is a phone call victim this is the

158
00:07:39,740 --> 00:07:44,600
infrastructure itself with as a real

159
00:07:41,450 --> 00:07:48,140
switch Cisco switch and I fall switch

160
00:07:44,600 --> 00:07:50,600
Tokyo 0 1 there's an actual EPO injected

161
00:07:48,140 --> 00:07:52,370
while and they say internet DHCP etc

162
00:07:50,600 --> 00:07:54,650
cetera and my internet service is a blue

163
00:07:52,370 --> 00:07:56,990
box which is a raspberry fiber we any

164
00:07:54,650 --> 00:07:58,460
software running Python I also have a

165
00:07:56,990 --> 00:08:01,390
snot but unfortunately I don't really

166
00:07:58,460 --> 00:08:06,039
see anything in its northern you know so

167
00:08:01,390 --> 00:08:06,039
let's go into deep into the dim

168
00:08:11,330 --> 00:08:19,710
all right so first of all on the bottom

169
00:08:16,110 --> 00:08:21,960
is my internet Kolkata blue box in the

170
00:08:19,710 --> 00:08:25,280
internet so when I do find data the

171
00:08:21,960 --> 00:08:28,888
options I can configure at the moment we

172
00:08:25,280 --> 00:08:30,989
can set it up with disable verbose mode

173
00:08:28,889 --> 00:08:32,940
will actually display the credentials

174
00:08:30,990 --> 00:08:35,339
that he received this is the box that

175
00:08:32,940 --> 00:08:38,250
will receive the credentials from from

176
00:08:35,339 --> 00:08:40,469
this box also we have the integration

177
00:08:38,250 --> 00:08:43,770
into Farah line which is a vulnerability

178
00:08:40,469 --> 00:08:45,060
management and per test in tool which is

179
00:08:43,770 --> 00:08:46,649
this is how I look

180
00:08:45,060 --> 00:08:48,390
and within far away there is something

181
00:08:46,649 --> 00:08:49,860
called credentials which currently

182
00:08:48,390 --> 00:08:51,540
there's no no credentials you can

183
00:08:49,860 --> 00:08:53,910
manually add or through API credentials

184
00:08:51,540 --> 00:08:59,689
this is for vulnerability and testable

185
00:08:53,910 --> 00:08:59,689
point so we will integrate with Ferrara

186
00:09:01,510 --> 00:09:06,250
and also I need to specify my interface

187
00:09:04,120 --> 00:09:11,850
internet zero and which is the

188
00:09:06,250 --> 00:09:11,850
destination file i/o no great no fix

189
00:09:13,920 --> 00:09:18,939
justify where the output will go but we

190
00:09:16,660 --> 00:09:21,010
put Peugeot so we will explain the in

191
00:09:18,940 --> 00:09:26,380
the screen as well so once you start

192
00:09:21,010 --> 00:09:28,649
this on the internet give you never any

193
00:09:26,380 --> 00:09:28,649
second

194
00:09:33,080 --> 00:09:36,239
[Music]

195
00:09:49,930 --> 00:09:53,680
yeah because you will no work because

196
00:09:51,700 --> 00:09:55,270
I'm not connected a company this summer

197
00:09:53,680 --> 00:10:03,189
is not here let me remove the

198
00:09:55,270 --> 00:10:05,530
integration right so now on the other

199
00:10:03,190 --> 00:10:07,660
hand and now it's listen right so now

200
00:10:05,530 --> 00:10:10,000
the other hand I have the box so what

201
00:10:07,660 --> 00:10:10,900
I'm going to do is I mean I even extra

202
00:10:10,000 --> 00:10:14,680
cable right

203
00:10:10,900 --> 00:10:16,480
the box has cell phone and LAN cables so

204
00:10:14,680 --> 00:10:19,349
I'm going to unplug the phone and put

205
00:10:16,480 --> 00:10:19,350
this box in the middle

206
00:10:27,570 --> 00:10:30,639
[Music]

207
00:10:31,420 --> 00:10:35,110
we want to put the phone back

208
00:10:36,980 --> 00:10:39,910
place a phone

209
00:10:46,990 --> 00:10:52,060
right so the box is designed to run by

210
00:10:49,780 --> 00:10:54,040
itself if you want to but because he

211
00:10:52,060 --> 00:10:58,239
said my you want to see how we run I can

212
00:10:54,040 --> 00:11:00,339
actually win access manually so first of

213
00:10:58,240 --> 00:11:07,810
all let me go to the actual real Cisco

214
00:11:00,340 --> 00:11:11,830
switch its cause each tokyo's you know

215
00:11:07,810 --> 00:11:14,079
one if I do so CDP neighbors say come on

216
00:11:11,830 --> 00:11:15,460
they I see no neighbors nothing

217
00:11:14,080 --> 00:11:25,030
connected fully switched so far all at

218
00:11:15,460 --> 00:11:26,980
least speak CDP or LDP well now I can

219
00:11:25,030 --> 00:11:33,480
first to see a phone actually through

220
00:11:26,980 --> 00:11:33,480
led people go to the box

221
00:11:49,810 --> 00:11:56,359
so now I'm the actual box I have a back

222
00:11:53,870 --> 00:11:58,970
here SSH - maybe a wireless just for

223
00:11:56,360 --> 00:12:02,030
demo purposes but this is the menu you

224
00:11:58,970 --> 00:12:04,160
get I spoke before so we will put at the

225
00:12:02,030 --> 00:12:04,520
top their votes you can see what we're

226
00:12:04,160 --> 00:12:07,250
doing

227
00:12:04,520 --> 00:12:09,380
also we put in bridge mode bridge mode

228
00:12:07,250 --> 00:12:10,940
is the new version 1.5 which allowed me

229
00:12:09,380 --> 00:12:13,070
to have the phone and the box in the

230
00:12:10,940 --> 00:12:15,470
middle you want to go back to just one

231
00:12:13,070 --> 00:12:19,180
device not funny anymore you can put in

232
00:12:15,470 --> 00:12:21,470
single mode also I can specify which

233
00:12:19,180 --> 00:12:23,989
expectation protocol so technique

234
00:12:21,470 --> 00:12:34,640
algorithm so I can select ping I can say

235
00:12:23,990 --> 00:12:41,480
that empty p I gotta proxy so let's just

236
00:12:34,640 --> 00:12:43,250
start to run it let's see so these are

237
00:12:41,480 --> 00:12:45,320
the steps when you put their goals it

238
00:12:43,250 --> 00:12:46,670
will tell you what it's doing but the

239
00:12:45,320 --> 00:12:48,440
first thing this box will do is to

240
00:12:46,670 --> 00:12:50,329
change the MAC address to a Cisco

241
00:12:48,440 --> 00:12:52,400
mcalary's before actually starting the

242
00:12:50,330 --> 00:12:54,500
interface you will configure the bridge

243
00:12:52,400 --> 00:12:56,270
interface to bridge the phone's with the

244
00:12:54,500 --> 00:12:59,030
network so it's basically if the

245
00:12:56,270 --> 00:13:01,579
material incident one bridge so it will

246
00:12:59,030 --> 00:13:04,100
also start to do a discovery phase to

247
00:13:01,580 --> 00:13:06,860
see if what is the device name this is

248
00:13:04,100 --> 00:13:09,620
close my work when I'm connected in this

249
00:13:06,860 --> 00:13:11,150
guy Tokyo's switch 0 1 why I'm doing

250
00:13:09,620 --> 00:13:13,430
this coverage is to pick up a similar

251
00:13:11,150 --> 00:13:16,189
manner so based on the name that I found

252
00:13:13,430 --> 00:13:19,069
through CDP and NADP I will put myself a

253
00:13:16,190 --> 00:13:21,440
name similar if I don't find that I can

254
00:13:19,070 --> 00:13:24,140
always go to switch 0 1 test or whatever

255
00:13:21,440 --> 00:13:26,840
you want to put also we get an IP

256
00:13:24,140 --> 00:13:28,880
address configuring ARBs gateway you

257
00:13:26,840 --> 00:13:30,980
will true to do because I select proxy

258
00:13:28,880 --> 00:13:34,280
for expectation technique there's three

259
00:13:30,980 --> 00:13:37,430
ways to exfiltrate proxy one is w / yes

260
00:13:34,280 --> 00:13:40,069
dhcp option 252 and the other one is

261
00:13:37,430 --> 00:13:41,989
guessing DNS guessing we're going to

262
00:13:40,070 --> 00:13:44,660
delete this now you see that I found

263
00:13:41,990 --> 00:13:48,140
actually proxy fight in this URL through

264
00:13:44,660 --> 00:13:50,270
option 252 DHCP between the names and

265
00:13:48,140 --> 00:13:53,060
everything so now if I go to the I'm the

266
00:13:50,270 --> 00:13:55,660
real switch 0 1 so if I do so CDP I

267
00:13:53,060 --> 00:13:58,569
actually see a phone connected

268
00:13:55,660 --> 00:14:03,069
and actually switch cold 0-3 if I don't

269
00:13:58,570 --> 00:14:05,320
you CDP never details I can see that

270
00:14:03,070 --> 00:14:07,750
there is a switch called Co 3 with an IP

271
00:14:05,320 --> 00:14:10,510
address 1 5 1 this is the capability on

272
00:14:07,750 --> 00:14:15,300
the model this is the version etc center

273
00:14:10,510 --> 00:14:21,700
ok that's an IP address right for those

274
00:14:15,300 --> 00:14:24,250
tables I can also see a similar thing

275
00:14:21,700 --> 00:14:28,500
but through the different protocol as

276
00:14:24,250 --> 00:14:28,500
you switch to Utley and then IP address

277
00:14:29,910 --> 00:14:35,980
right so now I'm going to leave the real

278
00:14:33,190 --> 00:14:39,040
switch pango is the automation system or

279
00:14:35,980 --> 00:14:45,280
the administrator PC so all happen if I

280
00:14:39,040 --> 00:14:55,800
turn it that box 1 Phi 1 I get the same

281
00:14:45,280 --> 00:14:58,180
from pass the 1 and I can put possible

282
00:14:55,800 --> 00:15:00,609
actually you can put any user or any

283
00:14:58,180 --> 00:15:03,040
possible I think that's it greatest in

284
00:15:00,610 --> 00:15:05,260
effect honeypot so everything's ok and I

285
00:15:03,040 --> 00:15:09,969
get a prompt like a Cisco switch so if I

286
00:15:05,260 --> 00:15:13,330
do so very soon ok now give me the

287
00:15:09,970 --> 00:15:17,670
version of a Cisco switch so interface

288
00:15:13,330 --> 00:15:17,670
description this has all Cisco commands

289
00:15:23,760 --> 00:15:30,490
so I give up so all these are cisco

290
00:15:29,020 --> 00:15:32,199
command that automation system

291
00:15:30,490 --> 00:15:34,680
automatically will try to get your

292
00:15:32,200 --> 00:15:34,680
inventory

293
00:15:35,800 --> 00:15:41,920
yeah I get the description now so as you

294
00:15:39,189 --> 00:15:45,219
can see on the bottom the screen because

295
00:15:41,920 --> 00:15:47,498
I select ping and I think was provenance

296
00:15:45,220 --> 00:15:50,829
and proxy user data you will see on the

297
00:15:47,499 --> 00:15:52,899
bottom of the screen that the the

298
00:15:50,829 --> 00:15:55,089
credentials that I just type already

299
00:15:52,899 --> 00:15:57,189
start to be next to sprinkle the T is

300
00:15:55,089 --> 00:16:00,459
time for telling the username and

301
00:15:57,189 --> 00:16:03,248
password and the source IP in thermal of

302
00:16:00,459 --> 00:16:06,279
the actual PC or automation system that

303
00:16:03,249 --> 00:16:08,049
connect me the IP external is the one

304
00:16:06,279 --> 00:16:09,629
that the foul is nothing to go to the

305
00:16:08,049 --> 00:16:12,129
Internet

306
00:16:09,629 --> 00:16:14,290
nothing the proxy or nothing whatever so

307
00:16:12,129 --> 00:16:18,220
you will see that this P DNS which is

308
00:16:14,290 --> 00:16:21,368
proxy DNS expectation technique ping ntp

309
00:16:18,220 --> 00:16:23,470
and this is get repeated in cycle so you

310
00:16:21,369 --> 00:16:26,499
can kill how often you want to send it

311
00:16:23,470 --> 00:16:29,499
or one or send every 10 minutes or 15

312
00:16:26,499 --> 00:16:36,129
minutes all the time is can get you so

313
00:16:29,499 --> 00:16:39,040
happened if I do enable another password

314
00:16:36,129 --> 00:16:40,869
I get in a neighbor mode right however

315
00:16:39,040 --> 00:16:41,170
if I want to do I want to configure the

316
00:16:40,869 --> 00:16:44,920
switch

317
00:16:41,170 --> 00:16:47,740
I'm not allowed however I can do it so

318
00:16:44,920 --> 00:16:49,299
run and I can get the configuration and

319
00:16:47,740 --> 00:16:50,860
this configuration is dynamically

320
00:16:49,299 --> 00:16:54,220
created so for example in the

321
00:16:50,860 --> 00:16:58,059
configuration you will see the username

322
00:16:54,220 --> 00:17:01,119
is exactly the same onus just type so

323
00:16:58,059 --> 00:17:03,809
this is be attended all right what about

324
00:17:01,119 --> 00:17:03,809
if I SSH

325
00:17:24,910 --> 00:17:30,020
[Music]

326
00:17:27,010 --> 00:17:31,790
BIA the telnet or SSH were exactly the

327
00:17:30,020 --> 00:17:35,060
same the same commands are allow it I

328
00:17:31,790 --> 00:17:37,850
can also do so CDP neighbors from the

329
00:17:35,060 --> 00:17:39,830
fixed reach and I can see the real

330
00:17:37,850 --> 00:17:43,929
switch like exactly a Cisco will be

331
00:17:39,830 --> 00:17:43,929
because each other same with the people

332
00:17:45,340 --> 00:17:51,949
so they can see each other same concept

333
00:17:49,460 --> 00:17:54,380
the only difference Winx now using the

334
00:17:51,950 --> 00:17:56,990
bottom they say T and E and they say

335
00:17:54,380 --> 00:17:59,030
hola that means that the is time for

336
00:17:56,990 --> 00:18:01,910
enable when I type the enable password

337
00:17:59,030 --> 00:18:03,620
the attendance that is the way to expect

338
00:18:01,910 --> 00:18:07,150
late so they all eyes the password I'll

339
00:18:03,620 --> 00:18:10,550
just type for the enable mode access

340
00:18:07,150 --> 00:18:13,310
when you use this through SSH instead of

341
00:18:10,550 --> 00:18:15,440
D instead of T you will see an S here

342
00:18:13,310 --> 00:18:19,639
with a user password whatever you use

343
00:18:15,440 --> 00:18:21,590
right so okay so permit an SSH and CDP

344
00:18:19,640 --> 00:18:25,720
and I will be your pretend to be Cisco

345
00:18:21,590 --> 00:18:25,720
switch what about send a peep

346
00:18:38,860 --> 00:18:42,540
is that a random community

347
00:18:55,499 --> 00:19:00,220
so when I talk a random community it

348
00:18:58,629 --> 00:19:03,309
doesn't it doesn't

349
00:19:00,220 --> 00:19:06,610
response however that community you can

350
00:19:03,309 --> 00:19:08,200
see then is is it going to get extra

351
00:19:06,610 --> 00:19:10,748
treated so even that you put the

352
00:19:08,200 --> 00:19:12,249
community using your network automation

353
00:19:10,749 --> 00:19:14,740
systems will tend to do is they use the

354
00:19:12,249 --> 00:19:16,659
community that using your company maybe

355
00:19:14,740 --> 00:19:19,090
a few communities and then if they

356
00:19:16,659 --> 00:19:21,639
cannot no response they we try with the

357
00:19:19,090 --> 00:19:29,019
default which is public right just in

358
00:19:21,639 --> 00:19:33,219
case just I just cut it this incidence

359
00:19:29,019 --> 00:19:36,039
so if I tried public I actually get that

360
00:19:33,220 --> 00:19:38,139
is the name the version they have times

361
00:19:36,039 --> 00:19:42,399
and all the information like a Cisco

362
00:19:38,139 --> 00:19:45,459
switch snmpwalk will reply as you can

363
00:19:42,399 --> 00:19:47,918
see on the bottom the P stand for SNMP

364
00:19:45,460 --> 00:19:50,049
and this is a community even a TV did

365
00:19:47,919 --> 00:19:51,249
not work actually I still actually

366
00:19:50,049 --> 00:19:52,769
attracted because it's a ballad

367
00:19:51,249 --> 00:19:57,490
community that you use in your network

368
00:19:52,769 --> 00:20:00,639
so well so closing this with the

369
00:19:57,490 --> 00:20:03,279
centipede telnet and ssh CVP another DP

370
00:20:00,639 --> 00:20:05,559
it all pretend as a Cisco switch however

371
00:20:03,279 --> 00:20:08,110
what about knock-knock

372
00:20:05,559 --> 00:20:10,629
the way that works max has a filtering

373
00:20:08,110 --> 00:20:12,789
by MAC address somewhat analyst for

374
00:20:10,629 --> 00:20:16,209
example the microphones are generic

375
00:20:12,789 --> 00:20:18,009
ranges open but when it's very difficult

376
00:20:16,210 --> 00:20:19,600
to filter to have an inventory of all

377
00:20:18,009 --> 00:20:21,580
the MAC address and keep updated of

378
00:20:19,600 --> 00:20:24,850
everyone in your neighborhood because

379
00:20:21,580 --> 00:20:27,610
you have TVs fridges you have a leaders

380
00:20:24,850 --> 00:20:30,309
says too much and they get 1204

381
00:20:27,610 --> 00:20:32,949
so what Marx does is the current they

382
00:20:30,309 --> 00:20:34,840
may quarantine it and they were doing

383
00:20:32,950 --> 00:20:36,970
fingerprinting koundak does

384
00:20:34,840 --> 00:20:41,619
fingerprinting well they didn't reinvent

385
00:20:36,970 --> 00:20:44,039
the wheel they just use a tool called a

386
00:20:41,619 --> 00:20:44,039
map

387
00:20:49,200 --> 00:20:55,720
so what do they do is this careful they

388
00:20:52,390 --> 00:20:57,940
do a service identification and always

389
00:20:55,720 --> 00:20:59,110
fingerprinting that's a very be sure

390
00:20:57,940 --> 00:21:01,780
you're all familiar with this command

391
00:20:59,110 --> 00:21:04,330
the SV is for survey service even

392
00:21:01,780 --> 00:21:06,670
defecation based on the service response

393
00:21:04,330 --> 00:21:08,409
of each telnet SSH or whatever demon you

394
00:21:06,670 --> 00:21:11,679
have they will try to classify which

395
00:21:08,410 --> 00:21:13,960
device is it and the - always in TCP UDP

396
00:21:11,679 --> 00:21:16,720
icmp fingerprinting based on the

397
00:21:13,960 --> 00:21:18,309
response of the OS kernel the whatever

398
00:21:16,720 --> 00:21:21,820
box is running they will know if the

399
00:21:18,309 --> 00:21:31,830
windows the UNIX or Cisco so this is

400
00:21:21,820 --> 00:21:36,129
something that enmity nak will do so

401
00:21:31,830 --> 00:21:38,649
when mark do when not bad if this is the

402
00:21:36,130 --> 00:21:43,030
valid switch or is a Raspberry Pi or is

403
00:21:38,650 --> 00:21:45,309
a valid device so this is what nak or in

404
00:21:43,030 --> 00:21:48,190
my actually report you say there's two

405
00:21:45,309 --> 00:21:50,500
demos 23:22 open they actually Cisco

406
00:21:48,190 --> 00:21:53,410
most SSH daemon and tendencies close

407
00:21:50,500 --> 00:21:57,549
with demo this is one image 12 point X

408
00:21:53,410 --> 00:22:00,549
iOS and it's designed to be always

409
00:21:57,549 --> 00:22:03,129
people as a Cisco they give you various

410
00:22:00,549 --> 00:22:08,500
option right in this case is a catalyst

411
00:22:03,130 --> 00:22:13,090
2960 so if we come full and full SNMP

412
00:22:08,500 --> 00:22:15,669
telnet SSH lldp CDP there's no reason

413
00:22:13,090 --> 00:22:19,659
for any device tell us that this is not

414
00:22:15,669 --> 00:22:22,600
the Cisco switch so this is how it works

415
00:22:19,660 --> 00:22:24,460
right now one more thing what about if

416
00:22:22,600 --> 00:22:27,399
someone find this box and it's a very

417
00:22:24,460 --> 00:22:31,419
smart guy and say wait a minute that box

418
00:22:27,400 --> 00:22:33,460
is not look like ours and they open it

419
00:22:31,419 --> 00:22:35,350
because that's a tricky thing

420
00:22:33,460 --> 00:22:37,270
now if you do forensics there's two

421
00:22:35,350 --> 00:22:40,510
things you do first you don't unplug the

422
00:22:37,270 --> 00:22:42,580
cables because that's not the way to do

423
00:22:40,510 --> 00:22:45,340
forensic you cool now what you just

424
00:22:42,580 --> 00:22:48,850
going to do is unscrew it remove the

425
00:22:45,340 --> 00:22:50,409
screws and see because this box looks

426
00:22:48,850 --> 00:22:53,189
suspicious actually wasn't much

427
00:22:50,410 --> 00:22:53,190
different style

428
00:22:54,159 --> 00:23:01,970
so we will open the box to see was what

429
00:22:57,139 --> 00:23:05,570
the hell this box is inside once you

430
00:23:01,970 --> 00:23:11,989
open the box it is good once you open

431
00:23:05,570 --> 00:23:16,549
this box you if you look the screen you

432
00:23:11,989 --> 00:23:19,909
will see here this little line so one

433
00:23:16,549 --> 00:23:23,149
this box they say actually magnets which

434
00:23:19,909 --> 00:23:25,820
here that once you open the lid as you

435
00:23:23,149 --> 00:23:28,580
can see that but the yellow thing is a

436
00:23:25,820 --> 00:23:31,460
magnet this is a magnet switch so once

437
00:23:28,580 --> 00:23:33,978
you detected someone like in a Windows

438
00:23:31,460 --> 00:23:35,809
alarm at home one detect the lead was

439
00:23:33,979 --> 00:23:39,729
opened you will automatically shut down

440
00:23:35,809 --> 00:23:44,629
all good you can destroy to turn on fire

441
00:23:39,729 --> 00:23:46,580
and also actually it will inform the

442
00:23:44,629 --> 00:23:48,559
same time the last thing he does is send

443
00:23:46,580 --> 00:23:50,178
a beacon say like someone open the case

444
00:23:48,559 --> 00:23:52,369
so if you're doing a person test in

445
00:23:50,179 --> 00:23:54,859
assessment okay now it's time to tell

446
00:23:52,369 --> 00:23:57,168
the guys that I was you actually so the

447
00:23:54,859 --> 00:24:01,970
way that it works one of the steps that

448
00:23:57,169 --> 00:24:04,369
based on time this work perfect respect

449
00:24:01,970 --> 00:24:05,179
by inside so you can get a SD card and

450
00:24:04,369 --> 00:24:08,779
to forensics

451
00:24:05,179 --> 00:24:11,330
well not really because the way it works

452
00:24:08,779 --> 00:24:14,119
is at the moment

453
00:24:11,330 --> 00:24:19,989
this box will start up it's looking for

454
00:24:14,119 --> 00:24:22,220
my phone I have a bluetooth service

455
00:24:19,989 --> 00:24:26,210
bluetooth service you can't really gonna

456
00:24:22,220 --> 00:24:28,489
pick it up what it does is you create

457
00:24:26,210 --> 00:24:33,049
the same service virtual service in blue

458
00:24:28,489 --> 00:24:35,059
tu gustas device you can enable it and

459
00:24:33,049 --> 00:24:37,940
you can create an ID right

460
00:24:35,059 --> 00:24:41,269
au ID so I when I put this box into the

461
00:24:37,940 --> 00:24:43,519
network I have this on in my pocket so

462
00:24:41,269 --> 00:24:45,859
what this box first boot the first thing

463
00:24:43,519 --> 00:24:48,440
it does is look for the this specific

464
00:24:45,859 --> 00:24:51,049
blue to IT services and the UID is

465
00:24:48,440 --> 00:24:53,950
hundred twenty eight bits and that is

466
00:24:51,049 --> 00:24:57,580
the encryption key for the actual

467
00:24:53,950 --> 00:24:59,769
addition so once you take the power and

468
00:24:57,580 --> 00:25:02,199
I'm not close by where you open the case

469
00:24:59,769 --> 00:25:03,960
and I'm not close by this box

470
00:25:02,200 --> 00:25:06,490
the hard drive is increased with looks

471
00:25:03,960 --> 00:25:09,309
so even you get the SD card you have it

472
00:25:06,490 --> 00:25:10,659
a simple raspberry and raspberry with an

473
00:25:09,309 --> 00:25:13,690
encryption partition that you can see

474
00:25:10,659 --> 00:25:17,320
really unless you collect hundred twenty

475
00:25:13,690 --> 00:25:18,940
eight bits of UID so that ties the

476
00:25:17,320 --> 00:25:21,549
reason the two reasons why we want this

477
00:25:18,940 --> 00:25:24,250
magnetic switch turn off to kill the box

478
00:25:21,549 --> 00:25:31,110
itself and also to actually prevent

479
00:25:24,250 --> 00:25:31,110
forensics so let me go back to the slice

480
00:25:32,100 --> 00:25:37,779
so how the exfiltration work as I

481
00:25:35,529 --> 00:25:42,309
mentioned before these are the syntax

482
00:25:37,779 --> 00:25:43,480
format for the filtration so we got to

483
00:25:42,309 --> 00:25:46,000
tell it tell it the name

484
00:25:43,480 --> 00:25:48,760
I'm sending username password and source

485
00:25:46,000 --> 00:25:51,639
IP that's a previous I'm sending to from

486
00:25:48,760 --> 00:25:53,590
this box to the Internet same for SSH or

487
00:25:51,639 --> 00:25:56,949
well it's gonna be actually the

488
00:25:53,590 --> 00:26:00,970
community and society and coming up soon

489
00:25:56,950 --> 00:26:03,309
will be the net credits option so these

490
00:26:00,970 --> 00:26:05,049
are they how do I actually same packet

491
00:26:03,309 --> 00:26:06,760
from this box to the internet well

492
00:26:05,049 --> 00:26:09,789
depend a protocol for each protocol

493
00:26:06,760 --> 00:26:12,908
remember I have around 15 20 bytes of

494
00:26:09,789 --> 00:26:17,158
encrypted with aes-256 credentials now

495
00:26:12,909 --> 00:26:20,260
what I do is split those 20 bytes into

496
00:26:17,159 --> 00:26:23,769
two by two each so I have cam packet the

497
00:26:20,260 --> 00:26:26,200
same so I will send ten packets from

498
00:26:23,769 --> 00:26:28,179
this box to the Internet just one way

499
00:26:26,200 --> 00:26:30,039
packet this box in the Internet has

500
00:26:28,179 --> 00:26:32,980
filters you will never replace any

501
00:26:30,039 --> 00:26:35,260
packets know TCP received no SNP nothing

502
00:26:32,980 --> 00:26:38,049
no DNS query nothing these box in the

503
00:26:35,260 --> 00:26:40,510
Internet is dead from a point of view so

504
00:26:38,049 --> 00:26:42,730
nothing come back so from our point of

505
00:26:40,510 --> 00:26:45,129
view or IPS point of view you always see

506
00:26:42,730 --> 00:26:47,440
time on set timeout sessions there's

507
00:26:45,130 --> 00:26:49,059
nothing establishes both way and you can

508
00:26:47,440 --> 00:26:49,809
team how often you want to send those

509
00:26:49,059 --> 00:26:52,120
ten packets

510
00:26:49,809 --> 00:26:53,620
maybe every one minute six minute you

511
00:26:52,120 --> 00:26:55,809
can put randomly the moment is

512
00:26:53,620 --> 00:26:57,610
configurable randomly every 30 seconds

513
00:26:55,809 --> 00:27:01,330
we say one so there's not really a

514
00:26:57,610 --> 00:27:04,779
pattern to follow so for ICMP which is

515
00:27:01,330 --> 00:27:07,720
I'm using IP ID headers in the IP hello

516
00:27:04,779 --> 00:27:08,529
I'm using the IP identification those

517
00:27:07,720 --> 00:27:10,960
two bytes

518
00:27:08,529 --> 00:27:14,049
I'm putting they are my chunk from the

519
00:27:10,960 --> 00:27:16,360
encryption on also using ICMP sequence

520
00:27:14,049 --> 00:27:18,999
number again two bytes where I can use

521
00:27:16,360 --> 00:27:21,189
to put a downer similar for trace Rob

522
00:27:18,999 --> 00:27:23,799
I'm using IP ID and I'm using the player

523
00:27:21,190 --> 00:27:27,369
the last four and last four digits of

524
00:27:23,799 --> 00:27:30,158
the payload for HTTP or HTTPS actually

525
00:27:27,369 --> 00:27:32,439
any TCP protocol the way to exfiltrate

526
00:27:30,159 --> 00:27:35,830
data is I put in my two bytes

527
00:27:32,440 --> 00:27:39,369
I'm sending ten TCP syn packets just

528
00:27:35,830 --> 00:27:44,859
sing with using TCP window size this is

529
00:27:39,369 --> 00:27:47,230
a two by two byte size so I'm putting

530
00:27:44,859 --> 00:27:49,119
two bytes of my crypto which is my

531
00:27:47,230 --> 00:27:51,809
passwords well she made my data to

532
00:27:49,119 --> 00:27:54,488
expertly basically using TCP window size

533
00:27:51,809 --> 00:27:57,580
ntp are using a stratum and different

534
00:27:54,489 --> 00:28:00,249
variables in ntp DNS and DNS is the

535
00:27:57,580 --> 00:28:01,960
easier you just query a simple DNS with

536
00:28:00,249 --> 00:28:04,090
your crypto table but me

537
00:28:01,960 --> 00:28:06,220
however remember the NS doesn't work

538
00:28:04,090 --> 00:28:08,168
this box goes to the Internet you will

539
00:28:06,220 --> 00:28:09,789
go to your thermal units and you

540
00:28:08,169 --> 00:28:13,809
internal DNS will you do an NS query

541
00:28:09,789 --> 00:28:15,669
type proxy proxy interests because most

542
00:28:13,809 --> 00:28:16,269
of the companies allow direct access to

543
00:28:15,669 --> 00:28:18,100
the Internet

544
00:28:16,269 --> 00:28:19,299
maybe bingo traceroute for

545
00:28:18,100 --> 00:28:21,759
troubleshooting

546
00:28:19,299 --> 00:28:24,429
maybe DNS but let's say that is a very

547
00:28:21,759 --> 00:28:25,809
key D she doesn't know anything so if

548
00:28:24,429 --> 00:28:27,340
you browse the internet from internal

549
00:28:25,809 --> 00:28:28,960
company you go to proxy only

550
00:28:27,340 --> 00:28:32,408
authenticate project

551
00:28:28,960 --> 00:28:34,480
ok sure so perhaps you have three

552
00:28:32,409 --> 00:28:37,149
different techniques and also the

553
00:28:34,480 --> 00:28:40,210
wireless is using because so it's so

554
00:28:37,149 --> 00:28:42,729
nice to avoid whips to get detected so

555
00:28:40,210 --> 00:28:44,889
just to put it into a diagram this is

556
00:28:42,730 --> 00:28:46,779
how the C first of all to to send the

557
00:28:44,889 --> 00:28:49,869
information I need to tell the receiver

558
00:28:46,779 --> 00:28:51,759
how long is the bytes themselves in 25

559
00:28:49,869 --> 00:28:52,658
so I need to tell them you are expected

560
00:28:51,759 --> 00:28:55,659
to get 20

561
00:28:52,659 --> 00:28:57,220
I'm also need to tell them the sequence

562
00:28:55,659 --> 00:29:00,070
this is not bad this is packet number

563
00:28:57,220 --> 00:29:01,570
one this is part number six because they

564
00:29:00,070 --> 00:29:03,809
could arrive in the different order so

565
00:29:01,570 --> 00:29:07,529
sequence numbers I

566
00:29:03,809 --> 00:29:09,450
and actually so the first pink icing

567
00:29:07,529 --> 00:29:11,730
contain that information and the

568
00:29:09,450 --> 00:29:14,100
following so I will sing 11 packets

569
00:29:11,730 --> 00:29:16,679
right tank with the crypto by the first

570
00:29:14,100 --> 00:29:18,238
packet will be actually the first one or

571
00:29:16,679 --> 00:29:22,710
two packet will be actually information

572
00:29:18,239 --> 00:29:26,070
of what is to be expected right trace

573
00:29:22,710 --> 00:29:27,450
well they all work similar so I can't go

574
00:29:26,070 --> 00:29:31,439
into details if you want to but they'll

575
00:29:27,450 --> 00:29:37,200
this is for UDP so I have the process I

576
00:29:31,440 --> 00:29:40,379
wish you can see yes yeah I can see so

577
00:29:37,200 --> 00:29:42,659
you have actually this I will explain

578
00:29:40,379 --> 00:29:45,779
you what is doing and the receiver what

579
00:29:42,659 --> 00:29:49,889
is doing so this is as long as a foul

580
00:29:45,779 --> 00:29:52,049
allowed Trevor party TTP HTTP to be

581
00:29:49,889 --> 00:29:53,939
honest could be any TCP packet because

582
00:29:52,049 --> 00:29:56,190
any protocol because I'm just sending a

583
00:29:53,940 --> 00:29:57,779
simple there's nothing coming back

584
00:29:56,190 --> 00:30:01,830
there's no communication so it's not

585
00:29:57,779 --> 00:30:04,619
even HTTP but port 80 or a 4 4 3 may be

586
00:30:01,830 --> 00:30:09,210
open from the internet or to the

587
00:30:04,619 --> 00:30:12,119
Internet maybe ntp this is a funny one

588
00:30:09,210 --> 00:30:15,450
because NTP they say transmit timestamp

589
00:30:12,119 --> 00:30:19,019
field in the MTP protocol which is has

590
00:30:15,450 --> 00:30:22,799
64 bits as nice it's not a classic Sarah

591
00:30:19,019 --> 00:30:25,289
- so what I'm doing is the first 32 are

592
00:30:22,799 --> 00:30:29,039
actually the timestamps and the next 32

593
00:30:25,289 --> 00:30:33,269
bits are actually a fraction so I'm

594
00:30:29,039 --> 00:30:35,850
hiding my 4 bytes in the last 32 bits in

595
00:30:33,269 --> 00:30:37,889
the fraction so you will see the time

596
00:30:35,850 --> 00:30:40,738
style correct but the number on the

597
00:30:37,889 --> 00:30:44,789
fraction is what varies on the bite that

598
00:30:40,739 --> 00:30:46,739
I am sending again similar concept I've

599
00:30:44,789 --> 00:30:47,940
used struttin important and precision

600
00:30:46,739 --> 00:30:50,039
just to tell first

601
00:30:47,940 --> 00:30:51,869
how many packet are you expecting how

602
00:30:50,039 --> 00:30:54,059
long is the sequence because there's

603
00:30:51,869 --> 00:30:56,639
part in sometimes let's say that you I'm

604
00:30:54,059 --> 00:30:59,700
saying that 2 by 2 pi but your crypto is

605
00:30:56,639 --> 00:31:00,988
13 so I need to do poly I need to do 14

606
00:30:59,700 --> 00:31:02,730
so to send seven

607
00:31:00,989 --> 00:31:04,760
so I also need to tell that listen i'm

608
00:31:02,730 --> 00:31:07,130
send you seven

609
00:31:04,760 --> 00:31:11,480
but realistically you're suspecting 13

610
00:31:07,130 --> 00:31:14,060
so once must be paladin up concept and

611
00:31:11,480 --> 00:31:18,680
the sequence number this is no 1 2 3 so

612
00:31:14,060 --> 00:31:21,590
you can assemble the other side DNS DNS

613
00:31:18,680 --> 00:31:23,750
is they wander this is simplest but this

614
00:31:21,590 --> 00:31:26,060
one does not require direct access from

615
00:31:23,750 --> 00:31:29,510
Cisco to carpet it goes to your internal

616
00:31:26,060 --> 00:31:32,600
DNS or DMZ DNS right so in this case I'm

617
00:31:29,510 --> 00:31:35,120
using any type query because image gets

618
00:31:32,600 --> 00:31:38,300
forwarded to the change of the actual

619
00:31:35,120 --> 00:31:40,580
domain of the domain so that allows that

620
00:31:38,300 --> 00:31:42,800
guarantee that query even got nothing

621
00:31:40,580 --> 00:31:45,500
reply back he get forwarded to the

622
00:31:42,800 --> 00:31:48,169
dot-com and then the blood comb and then

623
00:31:45,500 --> 00:31:50,270
my sub domain sylco dot blood con

624
00:31:48,170 --> 00:31:52,130
because it's an enhanced type of query

625
00:31:50,270 --> 00:31:55,460
so you will get forwarded from the root

626
00:31:52,130 --> 00:31:57,830
down to the actual carpet carpet members

627
00:31:55,460 --> 00:32:00,680
in the internet public IP and he only

628
00:31:57,830 --> 00:32:05,000
the way he configured self register DNS

629
00:32:00,680 --> 00:32:07,610
record of that domain or subdomain proxy

630
00:32:05,000 --> 00:32:10,580
this is really interesting because proxy

631
00:32:07,610 --> 00:32:11,060
everything is close proximity one way

632
00:32:10,580 --> 00:32:12,980
out

633
00:32:11,060 --> 00:32:14,990
problem with proxies you need to find

634
00:32:12,980 --> 00:32:19,070
the proxy so there's two methods which

635
00:32:14,990 --> 00:32:21,560
is DHCP of 2252 which gives you back

636
00:32:19,070 --> 00:32:22,909
five URL for your PC to set it up as

637
00:32:21,560 --> 00:32:25,429
Windows

638
00:32:22,910 --> 00:32:27,110
some companies put it there so what I'm

639
00:32:25,430 --> 00:32:28,520
doing is I'm putting the DHCP server

640
00:32:27,110 --> 00:32:32,330
with DHCP inform

641
00:32:28,520 --> 00:32:34,460
together parameter if exists right once

642
00:32:32,330 --> 00:32:36,590
I get something I will go connect to

643
00:32:34,460 --> 00:32:40,310
that proxy file get the prop Mac file

644
00:32:36,590 --> 00:32:42,770
parser for the proxy IP and port then I

645
00:32:40,310 --> 00:32:45,290
will connect to the proxy and this is

646
00:32:42,770 --> 00:32:47,330
interesting because the proxy itself is

647
00:32:45,290 --> 00:32:49,700
I don't know any company has an open

648
00:32:47,330 --> 00:32:51,620
proxy to be honest they all authenticate

649
00:32:49,700 --> 00:32:53,840
you need to technically win the window

650
00:32:51,620 --> 00:32:56,179
screens are most likely and they fun the

651
00:32:53,840 --> 00:32:57,980
funny part here is that I don't have any

652
00:32:56,180 --> 00:32:59,450
credential for Windows right I got it

653
00:32:57,980 --> 00:33:01,150
yeah the network credentials but

654
00:32:59,450 --> 00:33:05,620
definitely though

655
00:33:01,150 --> 00:33:10,750
so if I connect to the proxy and I do a

656
00:33:05,620 --> 00:33:13,590
get of my crypto the evil domain the

657
00:33:10,750 --> 00:33:16,270
proxy itself will reply back with a 403

658
00:33:13,590 --> 00:33:18,490
authentication required and that's the

659
00:33:16,270 --> 00:33:20,710
end of the story however every

660
00:33:18,490 --> 00:33:24,220
commercial proxy out there like big

661
00:33:20,710 --> 00:33:26,380
brands if names what they do is they

662
00:33:24,220 --> 00:33:28,810
will log an entry in the locks of the

663
00:33:26,380 --> 00:33:32,410
proxy let's say that this source IP

664
00:33:28,810 --> 00:33:35,169
tried to go to this this domain at this

665
00:33:32,410 --> 00:33:37,540
time and go the 403 the half million of

666
00:33:35,170 --> 00:33:41,110
those entries right but to look at entry

667
00:33:37,540 --> 00:33:43,330
the proxy logs to put in the column

668
00:33:41,110 --> 00:33:45,310
called IP address so they know they want

669
00:33:43,330 --> 00:33:47,199
to go to something crypto dog even

670
00:33:45,310 --> 00:33:50,200
domain but there's a column called

671
00:33:47,200 --> 00:33:54,520
ideology so the proxy will do an

672
00:33:50,200 --> 00:33:57,850
nslookup of that URL just to put the IP

673
00:33:54,520 --> 00:34:00,430
address if there is any and essentially

674
00:33:57,850 --> 00:34:06,550
what the proxy is doing is sending via

675
00:34:00,430 --> 00:34:09,490
dns decrypted to me thanks so tom new

676
00:34:06,550 --> 00:34:11,889
pad similar exercise again i just

677
00:34:09,489 --> 00:34:14,080
queried a DNS server for the w path that

678
00:34:11,889 --> 00:34:16,418
company that conceived a FX's many

679
00:34:14,080 --> 00:34:20,440
people still use it but it's going down

680
00:34:16,418 --> 00:34:22,839
the path so the most common is dns

681
00:34:20,440 --> 00:34:25,270
guessing so what that means is companies

682
00:34:22,840 --> 00:34:28,030
use GPO so that means that the profiles

683
00:34:25,270 --> 00:34:30,159
get pushed the proxy derail a pack file

684
00:34:28,030 --> 00:34:32,830
URL in the Internet Explorer it just get

685
00:34:30,159 --> 00:34:34,899
pushed by GPO a deep low profile right

686
00:34:32,830 --> 00:34:38,080
say the group cheap you're pushing that

687
00:34:34,900 --> 00:34:41,530
to users so the only way that I come out

688
00:34:38,080 --> 00:34:45,130
without is to find that proxy pack proxy

689
00:34:41,530 --> 00:34:49,660
server your name so I generally the list

690
00:34:45,130 --> 00:34:50,169
maybe with 15 words like proxy er X in

691
00:34:49,659 --> 00:34:54,009
it

692
00:34:50,168 --> 00:34:56,679
GW so you generally see a list of 15 or

693
00:34:54,010 --> 00:34:59,980
whatever your names and I will make a

694
00:34:56,679 --> 00:35:01,990
dictionary combining together with the -

695
00:34:59,980 --> 00:35:06,400
with the underscore I come forward

696
00:35:01,990 --> 00:35:07,330
so generally so using 12 I will get 250

697
00:35:06,400 --> 00:35:09,460
entries or

698
00:35:07,330 --> 00:35:11,740
candidate and I will query that the

699
00:35:09,460 --> 00:35:14,380
internal DNS to see what actually will

700
00:35:11,740 --> 00:35:16,569
play whatever reply I would try to

701
00:35:14,380 --> 00:35:18,640
connect to see if it's a proxy but if

702
00:35:16,570 --> 00:35:19,210
it's a proxy part great if no I keep

703
00:35:18,640 --> 00:35:21,580
trying

704
00:35:19,210 --> 00:35:23,410
so this is the same technique as the one

705
00:35:21,580 --> 00:35:25,870
the three proxy technique 283 it is the

706
00:35:23,410 --> 00:35:27,549
same this is just a way to try to find

707
00:35:25,870 --> 00:35:31,900
the proxy in the company without having

708
00:35:27,550 --> 00:35:34,330
the GPO logins and the last one is a

709
00:35:31,900 --> 00:35:36,280
wireless a filtration in this concept

710
00:35:34,330 --> 00:35:37,840
what I do is you do need proximity you

711
00:35:36,280 --> 00:35:40,540
need to be close hundred meters or less

712
00:35:37,840 --> 00:35:43,750
to be honest but what I do is I do

713
00:35:40,540 --> 00:35:46,090
pickles or an SSID specific and within

714
00:35:43,750 --> 00:35:49,120
the because of the this is a common

715
00:35:46,090 --> 00:35:52,090
Japanese brand of a home routers called

716
00:35:49,120 --> 00:35:54,310
from na na see a term so you will see

717
00:35:52,090 --> 00:35:57,250
those things to have four or six

718
00:35:54,310 --> 00:35:59,470
sometimes a Excel which is the last my

719
00:35:57,250 --> 00:36:01,210
hardest numbers of the router so I'm

720
00:35:59,470 --> 00:36:04,000
taking the opportunity to put my crypto

721
00:36:01,210 --> 00:36:07,000
which is X on the data within those

722
00:36:04,000 --> 00:36:09,730
names so first I send a beacon one to

723
00:36:07,000 --> 00:36:12,490
make to I will tell my device that I'm

724
00:36:09,730 --> 00:36:14,230
is my wireless device paola to tell them

725
00:36:12,490 --> 00:36:16,330
listen I'm I'm going to send you

726
00:36:14,230 --> 00:36:20,170
something and I send beacons because

727
00:36:16,330 --> 00:36:22,390
because don't not come up in the WIPs

728
00:36:20,170 --> 00:36:23,800
wireless they are not actually accessed

729
00:36:22,390 --> 00:36:26,080
by they it's like your phone is

730
00:36:23,800 --> 00:36:27,850
beaconing from your home wireless but

731
00:36:26,080 --> 00:36:30,730
you're in the office so definitely not

732
00:36:27,850 --> 00:36:33,640
connecting so there's a lot of noise on

733
00:36:30,730 --> 00:36:36,970
beacons so that's the reason W wireless

734
00:36:33,640 --> 00:36:39,069
IPS don't actually love because and

735
00:36:36,970 --> 00:36:41,980
itself beacons send the beacons and

736
00:36:39,070 --> 00:36:47,170
short bursts and the miss appear to be

737
00:36:41,980 --> 00:36:49,620
combine different SSID name so far any

738
00:36:47,170 --> 00:36:52,980
questions

739
00:36:49,620 --> 00:36:57,330
Wow everyone understood or nobody

740
00:36:52,980 --> 00:36:58,890
industry so that's it

741
00:36:57,330 --> 00:37:02,220
there's three stickers for everyone

742
00:36:58,890 --> 00:37:05,480
thank you for listening and hope you

743
00:37:02,220 --> 00:37:05,480
enjoy it

