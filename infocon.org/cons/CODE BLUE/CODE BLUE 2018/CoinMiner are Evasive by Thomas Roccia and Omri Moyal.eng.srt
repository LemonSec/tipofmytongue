1
00:00:04,790 --> 00:00:10,709
almost every enterprise suffered at

2
00:00:07,650 --> 00:00:13,740
least one coin Meyer incident in the

3
00:00:10,709 --> 00:00:16,439
past year how many of you here have

4
00:00:13,740 --> 00:00:18,540
experienced with malicious coin miners

5
00:00:16,440 --> 00:00:22,320
before before this talk raised your hand

6
00:00:18,540 --> 00:00:23,849
anyone that's cool I see some coolant so

7
00:00:22,320 --> 00:00:25,770
that's good

8
00:00:23,850 --> 00:00:28,860
so basically it's a problem it's an

9
00:00:25,770 --> 00:00:32,278
issue and when we started the research

10
00:00:28,860 --> 00:00:35,450
our main goal was to analyze understand

11
00:00:32,279 --> 00:00:39,420
this threat so we can give some

12
00:00:35,450 --> 00:00:42,210
defensive tactics in order to prevent it

13
00:00:39,420 --> 00:00:44,489
my name is Omri Segev morale and i'm the

14
00:00:42,210 --> 00:00:46,770
co-founder and out of research admin

15
00:00:44,489 --> 00:00:48,989
'evil apps my friend and colleague

16
00:00:46,770 --> 00:00:51,660
Thomas Rowe Kia sadly couldn't make it

17
00:00:48,989 --> 00:00:54,750
is from McAfee advanced research team

18
00:00:51,660 --> 00:00:59,160
and together we did this coin miners are

19
00:00:54,750 --> 00:01:01,290
evasive research so what we are going to

20
00:00:59,160 --> 00:01:03,690
speak about today we're going to speak

21
00:01:01,290 --> 00:01:06,270
about the frontlets cave landscape and

22
00:01:03,690 --> 00:01:09,450
the rise of coin miners we are going to

23
00:01:06,270 --> 00:01:11,908
deep dive into the evasive tactics

24
00:01:09,450 --> 00:01:14,580
employed by this friend we're going to

25
00:01:11,909 --> 00:01:17,159
look at the gang territorial wars

26
00:01:14,580 --> 00:01:19,380
between competing coin miner Fred actors

27
00:01:17,159 --> 00:01:21,990
and we're going to suggest and recommend

28
00:01:19,380 --> 00:01:24,509
some defensive tactics because it's not

29
00:01:21,990 --> 00:01:25,798
a true security talk if you can't get

30
00:01:24,510 --> 00:01:27,150
some security out of it

31
00:01:25,799 --> 00:01:29,840
and we've got to look at some

32
00:01:27,150 --> 00:01:32,790
predictions of one of the things we are

33
00:01:29,840 --> 00:01:35,700
expecting to see in the future from coal

34
00:01:32,790 --> 00:01:38,360
miners so sit back and hopefully you

35
00:01:35,700 --> 00:01:38,360
will enjoy it

36
00:01:38,420 --> 00:01:44,490
probably you've probably heard about

37
00:01:41,159 --> 00:01:46,950
either legitimate coin miners but there

38
00:01:44,490 --> 00:01:48,479
is also a lot of news recently in the

39
00:01:46,950 --> 00:01:50,850
past year and a half related to

40
00:01:48,479 --> 00:01:54,270
malicious coin mining just in the past

41
00:01:50,850 --> 00:01:57,589
month we've seen malicious coin miner

42
00:01:54,270 --> 00:02:00,780
disguises the flesh update that has been

43
00:01:57,590 --> 00:02:03,210
spreading in a lot of organization we

44
00:02:00,780 --> 00:02:07,399
have seen reports about massive increase

45
00:02:03,210 --> 00:02:11,090
in Mac OS 6 coin miners and a bit more

46
00:02:07,399 --> 00:02:15,210
recently we've seen a new attack again

47
00:02:11,090 --> 00:02:18,750
exploiting docker images to deploy coin

48
00:02:15,210 --> 00:02:21,810
- so basically you up every doctor would

49
00:02:18,750 --> 00:02:24,690
have upload a malicious image already

50
00:02:21,810 --> 00:02:26,310
with a coin miner inside and then the

51
00:02:24,690 --> 00:02:29,100
victims would just go to the dollar

52
00:02:26,310 --> 00:02:31,890
store and download it and that's it a

53
00:02:29,100 --> 00:02:33,989
really good as innovative supply chain

54
00:02:31,890 --> 00:02:37,470
attack to deploy coin miners so

55
00:02:33,990 --> 00:02:39,420
basically we want to understand how this

56
00:02:37,470 --> 00:02:42,450
fret works what are the key features

57
00:02:39,420 --> 00:02:44,970
behind it and how they keep evading our

58
00:02:42,450 --> 00:02:47,130
defenses what are the evasive techniques

59
00:02:44,970 --> 00:02:52,950
they are using so we'll explore that in

60
00:02:47,130 --> 00:02:54,570
this talk so to better understand it we

61
00:02:52,950 --> 00:02:56,910
first need to understand a few things

62
00:02:54,570 --> 00:02:59,310
and the one of the most important things

63
00:02:56,910 --> 00:03:01,700
that what is the business module and

64
00:02:59,310 --> 00:03:05,400
also what is the motive of attackers

65
00:03:01,700 --> 00:03:08,399
using coin miners so basically the way

66
00:03:05,400 --> 00:03:12,840
coin mining works is that you are using

67
00:03:08,400 --> 00:03:15,450
computer resources CPU GPU and asacs to

68
00:03:12,840 --> 00:03:18,210
mine cryptocurrency

69
00:03:15,450 --> 00:03:21,209
now originally it was intended to be

70
00:03:18,210 --> 00:03:25,640
used by legitimate people trying to make

71
00:03:21,210 --> 00:03:28,920
income from the fields of mining they

72
00:03:25,640 --> 00:03:31,649
like a taxation in blockchain technology

73
00:03:28,920 --> 00:03:35,600
but attackers have quickly understood

74
00:03:31,650 --> 00:03:39,800
that they can hijack victims resources

75
00:03:35,600 --> 00:03:44,579
servers endpoints routers mobile phones

76
00:03:39,800 --> 00:03:50,940
browsers to make a profit from other

77
00:03:44,580 --> 00:03:53,970
people's resources also mining so low on

78
00:03:50,940 --> 00:03:55,500
your hardware it's almost no longer

79
00:03:53,970 --> 00:03:58,410
profitable maybe if you've got really

80
00:03:55,500 --> 00:04:00,120
big farms but attackers don't need to

81
00:03:58,410 --> 00:04:02,220
pay electricity bills

82
00:04:00,120 --> 00:04:06,480
they don't need to buy Hardware all they

83
00:04:02,220 --> 00:04:09,810
need to do is hijack a system basically

84
00:04:06,480 --> 00:04:12,600
also we have noticed that attackers like

85
00:04:09,810 --> 00:04:15,900
legitimate miners are using what it's

86
00:04:12,600 --> 00:04:19,469
called mining pools mining pools is like

87
00:04:15,900 --> 00:04:23,520
the Communist way for miners to share

88
00:04:19,470 --> 00:04:26,100
the resources to gain more profit a more

89
00:04:23,520 --> 00:04:28,430
steady profit that will be divided by

90
00:04:26,100 --> 00:04:31,039
how much resource they donate to this

91
00:04:28,430 --> 00:04:38,300
this network that concept is called

92
00:04:31,039 --> 00:04:41,000
mining pools public mining pools so also

93
00:04:38,300 --> 00:04:44,289
what we've discovered is almost I don't

94
00:04:41,000 --> 00:04:47,840
wanna say 100% but around 99% of

95
00:04:44,289 --> 00:04:50,719
malicious crypto mining is based on

96
00:04:47,840 --> 00:04:54,888
Manero Manero also in a shelter for

97
00:04:50,720 --> 00:04:59,419
excess XMR is relatively newer coined

98
00:04:54,889 --> 00:05:01,940
and bitcoin and litecoin etc Bernero he

99
00:04:59,419 --> 00:05:05,419
has some really strong features that

100
00:05:01,940 --> 00:05:08,419
makes it almost perfect for attackers so

101
00:05:05,419 --> 00:05:11,900
first of all it has really strong and

102
00:05:08,419 --> 00:05:13,549
non image based algorithms so for

103
00:05:11,900 --> 00:05:16,190
example if you compare it to Bitcoin

104
00:05:13,550 --> 00:05:18,650
let's look at the Bitcoin wallet address

105
00:05:16,190 --> 00:05:21,080
it's somewhat like the equivalent of

106
00:05:18,650 --> 00:05:24,380
your your home address your physical

107
00:05:21,080 --> 00:05:28,370
home address Manero is a wallet address

108
00:05:24,380 --> 00:05:31,849
is more of like your p.o box or virtual

109
00:05:28,370 --> 00:05:35,630
pure box where it's not so easy to track

110
00:05:31,849 --> 00:05:37,969
also Bitcoin it's like walking walking

111
00:05:35,630 --> 00:05:40,130
around the street with your wallet open

112
00:05:37,970 --> 00:05:42,979
and everybody can see how much money you

113
00:05:40,130 --> 00:05:45,530
have in Manero it's much more harder to

114
00:05:42,979 --> 00:05:47,900
see each wallet and how much there is in

115
00:05:45,530 --> 00:05:50,659
there it's also transactions are much

116
00:05:47,900 --> 00:05:55,750
more harder to monitor

117
00:05:50,659 --> 00:05:59,360
in addition venero is also optimized to

118
00:05:55,750 --> 00:06:01,909
mine with CPU we're in Bitcoin and other

119
00:05:59,360 --> 00:06:04,250
GPU and a6 is what you need

120
00:06:01,909 --> 00:06:07,430
so for attackers it's much more easy to

121
00:06:04,250 --> 00:06:12,530
get old of CPU systems than other type

122
00:06:07,430 --> 00:06:14,750
of processors in addition venero has a

123
00:06:12,530 --> 00:06:19,880
really strong community and a really

124
00:06:14,750 --> 00:06:22,370
strong and good open source free tools

125
00:06:19,880 --> 00:06:24,440
that both legitimate and attackers can

126
00:06:22,370 --> 00:06:27,409
utilize and we'll see it a few examples

127
00:06:24,440 --> 00:06:30,039
of it soon now don't get it wrong

128
00:06:27,409 --> 00:06:33,800
Mineiro is not a malicious technology

129
00:06:30,039 --> 00:06:35,870
Manero is actually natural like money

130
00:06:33,800 --> 00:06:37,760
money can be used for good and can be

131
00:06:35,870 --> 00:06:40,550
used for bad same way as drug dealers

132
00:06:37,760 --> 00:06:42,539
are using money malicious actors can use

133
00:06:40,550 --> 00:06:44,340
Manero now a good thing

134
00:06:42,540 --> 00:06:46,770
the community of Manero the people

135
00:06:44,340 --> 00:06:48,330
behind it finally started to realize but

136
00:06:46,770 --> 00:06:51,539
there is a problem here

137
00:06:48,330 --> 00:06:53,219
monaro got a big bad reputation so they

138
00:06:51,540 --> 00:06:56,430
created what they called the marrow

139
00:06:53,220 --> 00:06:58,790
response team and the memory response

140
00:06:56,430 --> 00:07:02,340
team has a really good set of resources

141
00:06:58,790 --> 00:07:04,320
and team behind it to help any incidents

142
00:07:02,340 --> 00:07:05,369
of crypto mining malicious script a

143
00:07:04,320 --> 00:07:07,290
mining using Manero

144
00:07:05,370 --> 00:07:09,540
so you can google it up and check if you

145
00:07:07,290 --> 00:07:13,050
want they actually on IRC but I have an

146
00:07:09,540 --> 00:07:16,950
email contact if you want now

147
00:07:13,050 --> 00:07:19,170
our these malicious coin miners actually

148
00:07:16,950 --> 00:07:23,460
infect our systems how are they getting

149
00:07:19,170 --> 00:07:26,280
to the enterprises to the computer

150
00:07:23,460 --> 00:07:29,489
machines so first of all for my wizard

151
00:07:26,280 --> 00:07:31,950
we've seen a lot of them are pretty much

152
00:07:29,490 --> 00:07:33,990
similar to traditional malware

153
00:07:31,950 --> 00:07:38,490
traditional infection vector tactics

154
00:07:33,990 --> 00:07:42,900
like spam mail spam malicious documents

155
00:07:38,490 --> 00:07:45,210
exploit kids children I software they

156
00:07:42,900 --> 00:07:49,020
are not much different than what of the

157
00:07:45,210 --> 00:07:53,580
typical marrow you see but they are also

158
00:07:49,020 --> 00:07:56,789
heavily relying on warm abilities a bit

159
00:07:53,580 --> 00:08:00,479
similar to run somewhere in in coin

160
00:07:56,790 --> 00:08:03,470
miners you are subject to see much more

161
00:08:00,480 --> 00:08:06,480
frequent warm abilities now why is that

162
00:08:03,470 --> 00:08:08,640
typical Trojan doesn't need to install

163
00:08:06,480 --> 00:08:10,680
on all of your own organization computer

164
00:08:08,640 --> 00:08:14,250
it just needs to get the right ones that

165
00:08:10,680 --> 00:08:16,890
have all the data coin miner pretty much

166
00:08:14,250 --> 00:08:19,020
similar to run summer make money per

167
00:08:16,890 --> 00:08:21,000
machine they are infecting if France

168
00:08:19,020 --> 00:08:24,090
summer is encrypting and then you pay

169
00:08:21,000 --> 00:08:26,310
each machine in coin mining each machine

170
00:08:24,090 --> 00:08:28,830
the in fact that's the CPU they get and

171
00:08:26,310 --> 00:08:30,590
that's how they make more profit so warm

172
00:08:28,830 --> 00:08:34,949
is really really important factor here

173
00:08:30,590 --> 00:08:37,530
in addition unique to coin miners they

174
00:08:34,950 --> 00:08:42,419
have the what we call the web mining or

175
00:08:37,530 --> 00:08:45,120
crypto jacking and basically any machine

176
00:08:42,419 --> 00:08:49,560
that can run a JavaScript for example

177
00:08:45,120 --> 00:08:53,210
that has a browser or some way to browse

178
00:08:49,560 --> 00:08:56,250
URLs are subject to be attacked by

179
00:08:53,210 --> 00:08:56,460
malicious JavaScript that are going to

180
00:08:56,250 --> 00:09:00,060
you

181
00:08:56,460 --> 00:09:02,790
that computer resources for mining vast

182
00:09:00,060 --> 00:09:04,890
majority behind it it's a service called

183
00:09:02,790 --> 00:09:07,469
coin hive you might want to read about

184
00:09:04,890 --> 00:09:11,069
it but basically a framework that anyone

185
00:09:07,470 --> 00:09:15,660
can sorry

186
00:09:11,070 --> 00:09:17,250
that anyone can use take that JavaScript

187
00:09:15,660 --> 00:09:21,089
put it in a website in any malicious

188
00:09:17,250 --> 00:09:24,450
website and utilize that for making

189
00:09:21,090 --> 00:09:25,920
profit now what you're asking yourself

190
00:09:24,450 --> 00:09:28,050
what is the big deal

191
00:09:25,920 --> 00:09:29,550
behind coin mining what is the damage

192
00:09:28,050 --> 00:09:32,189
what can you actually do to my machines

193
00:09:29,550 --> 00:09:33,959
why should I care about it so I mean

194
00:09:32,190 --> 00:09:36,450
it's not around somewhere it's not gonna

195
00:09:33,960 --> 00:09:38,820
encrypt my data but what is actually

196
00:09:36,450 --> 00:09:41,280
doing so first of all it's almost

197
00:09:38,820 --> 00:09:43,110
similar as a denial of service attack if

198
00:09:41,280 --> 00:09:46,680
your machine is infected with the coin

199
00:09:43,110 --> 00:09:48,750
miner most of them are not nice they are

200
00:09:46,680 --> 00:09:51,239
using all the resources they can and

201
00:09:48,750 --> 00:09:54,000
your machine will start one slow if you

202
00:09:51,240 --> 00:09:56,070
ever encounter a data center and trust

203
00:09:54,000 --> 00:09:58,230
me it's not a pleasant sight it has his

204
00:09:56,070 --> 00:10:00,780
entire service infected with coin mining

205
00:09:58,230 --> 00:10:04,890
one of the first obvious thing you will

206
00:10:00,780 --> 00:10:07,560
see even before the denial of service is

207
00:10:04,890 --> 00:10:10,530
the electricity bill electricity bill

208
00:10:07,560 --> 00:10:12,630
jumps really behind those data centers

209
00:10:10,530 --> 00:10:13,430
because the machines are working really

210
00:10:12,630 --> 00:10:16,260
really hard

211
00:10:13,430 --> 00:10:18,900
another problem is a lot of people are

212
00:10:16,260 --> 00:10:21,510
using the cloud now and in the cloud you

213
00:10:18,900 --> 00:10:23,550
actually pay for what CPU you use so if

214
00:10:21,510 --> 00:10:26,790
you got infected with the coin mind that

215
00:10:23,550 --> 00:10:30,839
that damage is really very direct and

216
00:10:26,790 --> 00:10:33,480
right away now the main focus of this

217
00:10:30,840 --> 00:10:35,820
talk is the evasiveness of coin miners

218
00:10:33,480 --> 00:10:38,940
but let's first understand and define

219
00:10:35,820 --> 00:10:40,710
what an evasive tactic is basically

220
00:10:38,940 --> 00:10:43,010
there's a really good definition here

221
00:10:40,710 --> 00:10:45,690
but if you put it in a short sentence

222
00:10:43,010 --> 00:10:48,360
evasive evasive tactics evasive

223
00:10:45,690 --> 00:10:51,510
techniques are the tools and methods

224
00:10:48,360 --> 00:10:55,200
that attacted use in order to evade

225
00:10:51,510 --> 00:10:58,110
security tools the fan defenses

226
00:10:55,200 --> 00:11:00,930
monitoring etc they are broken to

227
00:10:58,110 --> 00:11:02,850
several categories like antis and boxing

228
00:11:00,930 --> 00:11:05,760
the ability to evade sandboxing

229
00:11:02,850 --> 00:11:08,790
technology and to debugging the ability

230
00:11:05,760 --> 00:11:09,990
to evade debuggers etc this is why

231
00:11:08,790 --> 00:11:11,939
attackers actually

232
00:11:09,990 --> 00:11:13,529
calling them auntie's if you look at any

233
00:11:11,940 --> 00:11:18,720
dark form something this is how they

234
00:11:13,529 --> 00:11:21,750
describe it so it's pretty cool now the

235
00:11:18,720 --> 00:11:23,550
way we constructed is by case studies we

236
00:11:21,750 --> 00:11:25,890
think a star is a really good way to

237
00:11:23,550 --> 00:11:28,920
show examples of the frequent evasive

238
00:11:25,890 --> 00:11:31,080
tactics that we found in the wild this

239
00:11:28,920 --> 00:11:34,050
is an example of a coin miner called

240
00:11:31,080 --> 00:11:40,010
water miner water miner was discovered

241
00:11:34,050 --> 00:11:40,010
by a team at Minerva it is a Trojan eyes

242
00:11:40,339 --> 00:11:46,740
GTA online game mode basically the

243
00:11:43,890 --> 00:11:48,899
author of that cheat mode implemented a

244
00:11:46,740 --> 00:11:51,779
coal miner inside the mode and tricked

245
00:11:48,899 --> 00:11:53,370
all its users while using the mode to

246
00:11:51,779 --> 00:11:54,689
run and make profit from him in the

247
00:11:53,370 --> 00:11:58,350
background

248
00:11:54,690 --> 00:12:02,399
water miner was first pale of what they

249
00:11:58,350 --> 00:12:05,630
did is soon as the mode it was installed

250
00:12:02,399 --> 00:12:08,399
it would have run a script that

251
00:12:05,630 --> 00:12:11,010
downloaded a secondary payload which was

252
00:12:08,399 --> 00:12:13,620
the coal miner and then that coal miner

253
00:12:11,010 --> 00:12:17,100
would have ran in the background like a

254
00:12:13,620 --> 00:12:20,670
fake Oracle or Intel processes so it was

255
00:12:17,100 --> 00:12:22,649
harder to detect now I remember I

256
00:12:20,670 --> 00:12:25,589
mentioned that monaro has a really good

257
00:12:22,649 --> 00:12:28,050
set of open-source tool and one of the

258
00:12:25,589 --> 00:12:33,029
most frequent use by attackers is a tool

259
00:12:28,050 --> 00:12:35,790
called XM eric XM rig is basically a

260
00:12:33,029 --> 00:12:39,089
very efficient tool to mine and connect

261
00:12:35,790 --> 00:12:42,599
to public polls so what the author here

262
00:12:39,089 --> 00:12:46,050
did the way you run XM rig is by adding

263
00:12:42,600 --> 00:12:49,649
command line parameters to connect the

264
00:12:46,050 --> 00:12:51,750
tool to the public polls give it to the

265
00:12:49,649 --> 00:12:53,610
wallet address the protocol you want to

266
00:12:51,750 --> 00:12:55,380
use and the threads you want to run him

267
00:12:53,610 --> 00:12:57,690
but that makes it really really

268
00:12:55,380 --> 00:13:00,959
suspicious and really really easy to

269
00:12:57,690 --> 00:13:02,490
detect by defenders so the attacker took

270
00:13:00,959 --> 00:13:04,739
the code changed it a bit

271
00:13:02,490 --> 00:13:08,430
so those parameters would have been

272
00:13:04,740 --> 00:13:11,940
embedded inside the code before

273
00:13:08,430 --> 00:13:14,609
executing now really really clever thing

274
00:13:11,940 --> 00:13:17,399
that they did and followed by a lot of

275
00:13:14,610 --> 00:13:20,760
coal miners as well let me ask you a

276
00:13:17,399 --> 00:13:23,520
question if you think about it the

277
00:13:20,760 --> 00:13:25,860
victims of water miner are pretty soon

278
00:13:23,520 --> 00:13:27,900
for users this is either kids or people

279
00:13:25,860 --> 00:13:29,610
who play computer games and cheat they

280
00:13:27,900 --> 00:13:32,640
downloaded cheats and downloading modes

281
00:13:29,610 --> 00:13:35,390
now what do you do what a super user

282
00:13:32,640 --> 00:13:39,030
does when their machine is running slow

283
00:13:35,390 --> 00:13:40,949
any suggestions you what do you do if

284
00:13:39,030 --> 00:13:42,750
your machine starts to run slow you work

285
00:13:40,950 --> 00:13:49,260
with your laptop it doesn't work

286
00:13:42,750 --> 00:13:52,440
something gets stuck it suggestions cool

287
00:13:49,260 --> 00:13:55,770
so basically you either reboot but if it

288
00:13:52,440 --> 00:13:58,620
stays then you probably open something

289
00:13:55,770 --> 00:14:03,120
like a task manager or process Explorer

290
00:13:58,620 --> 00:14:06,480
or in Russia where this this mode was

291
00:14:03,120 --> 00:14:09,210
operating you open a program called and

292
00:14:06,480 --> 00:14:11,580
view now what the author of motor minor

293
00:14:09,210 --> 00:14:14,430
did is as soon as you open a task

294
00:14:11,580 --> 00:14:16,650
manager or antivir the mining process

295
00:14:14,430 --> 00:14:19,469
would have went to a halt no longer

296
00:14:16,650 --> 00:14:21,209
taking a lot of CPU and any you probably

297
00:14:19,470 --> 00:14:23,490
would have blame your Chrome or the game

298
00:14:21,210 --> 00:14:25,260
or any other software killed it and then

299
00:14:23,490 --> 00:14:27,180
you shut down your motor testimonial

300
00:14:25,260 --> 00:14:29,430
monitoring tool and it would have came

301
00:14:27,180 --> 00:14:33,599
back so it's really really small and was

302
00:14:29,430 --> 00:14:36,229
deployed by a lot of coin miners another

303
00:14:33,600 --> 00:14:39,120
coin miner fred is called everyone

304
00:14:36,230 --> 00:14:42,210
everyone has other than being a coin

305
00:14:39,120 --> 00:14:46,500
miner it has a really cool unique

306
00:14:42,210 --> 00:14:48,930
features targeting cryptocurrency users

307
00:14:46,500 --> 00:14:51,210
other than just being a coin miner

308
00:14:48,930 --> 00:14:54,120
so first of all it was heavily packed so

309
00:14:51,210 --> 00:14:55,650
it wasn't that easy to analyze but after

310
00:14:54,120 --> 00:14:58,020
you manage to unpack it you can see some

311
00:14:55,650 --> 00:15:01,550
really interesting features so first

312
00:14:58,020 --> 00:15:04,620
thing they would hook your keyboard and

313
00:15:01,550 --> 00:15:08,910
after hooking your keyboard they have a

314
00:15:04,620 --> 00:15:11,250
few relics that whenever someone copy a

315
00:15:08,910 --> 00:15:13,980
wallet address of either a Bitcoin

316
00:15:11,250 --> 00:15:16,110
litecoin XMR and some other coin

317
00:15:13,980 --> 00:15:21,030
cryptocurrencies they would have

318
00:15:16,110 --> 00:15:23,670
switched the the copy wallet address to

319
00:15:21,030 --> 00:15:25,890
their own wallet address and let's say

320
00:15:23,670 --> 00:15:27,599
you give an example I got a friend my

321
00:15:25,890 --> 00:15:29,280
mate loves Bitcoin and you know he

322
00:15:27,600 --> 00:15:32,340
wanted me to send him like 20 bitcoins

323
00:15:29,280 --> 00:15:35,100
because I lost in a bet I copy as I copy

324
00:15:32,340 --> 00:15:37,410
his Bitcoin address and I paste it I

325
00:15:35,100 --> 00:15:41,040
think I pasted his address but actually

326
00:15:37,410 --> 00:15:42,660
you know just very very few users will

327
00:15:41,040 --> 00:15:45,029
actually notice that especially if

328
00:15:42,660 --> 00:15:47,339
you're not familiar with the address so

329
00:15:45,029 --> 00:15:49,860
it's really clever to see I believe it

330
00:15:47,339 --> 00:15:51,779
was successful I lived in numbers other

331
00:15:49,860 --> 00:15:54,750
things they did was looking at the

332
00:15:51,779 --> 00:15:58,920
register of the machine looking for wore

333
00:15:54,750 --> 00:16:00,930
a wallet software like Bitcoin QT etc

334
00:15:58,920 --> 00:16:04,290
and they would have grabbed the wallet

335
00:16:00,930 --> 00:16:05,758
and send it to the attacker and they

336
00:16:04,290 --> 00:16:08,009
were not stopping with that they were

337
00:16:05,759 --> 00:16:10,170
actually stealing cookies related to

338
00:16:08,009 --> 00:16:13,470
crypto currencies as well so this factor

339
00:16:10,170 --> 00:16:15,660
was first using your machine to hijack

340
00:16:13,470 --> 00:16:19,459
and make some crypto currency but also

341
00:16:15,660 --> 00:16:21,660
steal your wallets so it's really cool

342
00:16:19,459 --> 00:16:27,329
you can see here there are few examples

343
00:16:21,660 --> 00:16:30,300
of the code of this attack now me last

344
00:16:27,329 --> 00:16:33,569
year it was a very diverse state of

345
00:16:30,300 --> 00:16:35,128
attack ransomware attack in the world he

346
00:16:33,569 --> 00:16:37,139
was using around somewhere called wanna

347
00:16:35,129 --> 00:16:39,899
cry wanna cry it was a really vicious

348
00:16:37,139 --> 00:16:43,050
warm run somewhere there was spread via

349
00:16:39,899 --> 00:16:45,480
the leaked NSA exploit eternal blue

350
00:16:43,050 --> 00:16:49,560
double poster if you heard about them

351
00:16:45,480 --> 00:16:53,009
but at the same time what a cry was

352
00:16:49,560 --> 00:16:55,138
morning there was another massive coin

353
00:16:53,009 --> 00:16:57,870
miner using the same exploits and almost

354
00:16:55,139 --> 00:17:00,540
the same warm capabilities called UI w

355
00:16:57,870 --> 00:17:02,220
IX up for the I pronounce it right how

356
00:17:00,540 --> 00:17:07,649
many people hear about one a crime

357
00:17:02,220 --> 00:17:12,720
before yeah how many people heard about

358
00:17:07,650 --> 00:17:14,909
you AI WI X before this talk yeah the

359
00:17:12,720 --> 00:17:18,120
reason not so many people heard about it

360
00:17:14,909 --> 00:17:21,720
is because it was employing over 200

361
00:17:18,119 --> 00:17:24,349
evasion tactics it was basically putting

362
00:17:21,720 --> 00:17:27,630
everything in the categories we've seen

363
00:17:24,349 --> 00:17:30,059
into the code copy and pasted some of

364
00:17:27,630 --> 00:17:32,340
their own innovative and a lot of

365
00:17:30,059 --> 00:17:34,559
researchers that deployed honey pots to

366
00:17:32,340 --> 00:17:38,879
capture water cry actually captured you

367
00:17:34,559 --> 00:17:40,649
iwi X but it was self destructive and

368
00:17:38,880 --> 00:17:42,210
basically you couldn't analyze it they

369
00:17:40,650 --> 00:17:44,789
wouldn't find and they went on to one

370
00:17:42,210 --> 00:17:47,370
cry some of them even put a honeypot

371
00:17:44,789 --> 00:17:49,250
received you iwi X but then received

372
00:17:47,370 --> 00:17:50,559
water cry so didn't even bother with

373
00:17:49,250 --> 00:17:53,320
wi-wo

374
00:17:50,559 --> 00:17:56,529
was published our team analyzed that and

375
00:17:53,320 --> 00:17:58,720
we've we've did very D gave very good

376
00:17:56,529 --> 00:18:01,690
details on the friend I think it was

377
00:17:58,720 --> 00:18:05,919
first discovered by Trend Micro company

378
00:18:01,690 --> 00:18:07,269
from Japan so good work and if you want

379
00:18:05,919 --> 00:18:09,779
to go to the blog there's a really good

380
00:18:07,269 --> 00:18:12,519
description of all those evasive tactics

381
00:18:09,779 --> 00:18:15,100
it was using things like avoiding

382
00:18:12,519 --> 00:18:17,440
virtual machines looking for debuggers

383
00:18:15,100 --> 00:18:18,998
and forensics tools avoiding Eastern

384
00:18:17,440 --> 00:18:21,730
Europe countries which might suggest

385
00:18:18,999 --> 00:18:23,529
where it's coming from and if even

386
00:18:21,730 --> 00:18:27,700
looking for cool sandbox and trying to

387
00:18:23,529 --> 00:18:30,190
evade it now another threat I honestly

388
00:18:27,700 --> 00:18:34,149
don't know how to pronounce a thing Shyu

389
00:18:30,190 --> 00:18:36,639
box I Oba it's a Fed from originally

390
00:18:34,149 --> 00:18:39,610
probably emerging from China it was

391
00:18:36,639 --> 00:18:42,629
originated ransomware that evolved to be

392
00:18:39,610 --> 00:18:46,059
evolved or changed to be to a coin miner

393
00:18:42,629 --> 00:18:49,090
but it kept some of its run Sumer

394
00:18:46,059 --> 00:18:51,668
features to become more successful coin

395
00:18:49,090 --> 00:18:55,209
miner so first a couple of evasions they

396
00:18:51,669 --> 00:18:57,330
use they used really frequent icons to

397
00:18:55,210 --> 00:19:01,360
lure some of the people to click on it

398
00:18:57,330 --> 00:19:02,710
really smart they infected they using

399
00:19:01,360 --> 00:19:05,529
the same code from the ransomware

400
00:19:02,710 --> 00:19:08,830
looking for HTML file and JavaScript

401
00:19:05,529 --> 00:19:11,830
files and instead of encrypting them

402
00:19:08,830 --> 00:19:13,658
they injected JavaScript mining code

403
00:19:11,830 --> 00:19:17,049
into them so let's say it's a web

404
00:19:13,659 --> 00:19:19,600
browser a web server and you infect it

405
00:19:17,049 --> 00:19:22,960
then any visitor of that web server will

406
00:19:19,600 --> 00:19:26,168
also be mining with the JavaScript miner

407
00:19:22,960 --> 00:19:29,559
for the for the attackers they will also

408
00:19:26,169 --> 00:19:31,539
redirecting AV domains to it in the

409
00:19:29,559 --> 00:19:34,149
local host really an old trick but it

410
00:19:31,539 --> 00:19:37,360
still works addley they say disabling

411
00:19:34,149 --> 00:19:39,129
safe booth the registry deleting some

412
00:19:37,360 --> 00:19:41,459
specific insofar as it was still around

413
00:19:39,129 --> 00:19:44,289
somewhere and it was also infecting

414
00:19:41,460 --> 00:19:48,009
every portable executable in the system

415
00:19:44,289 --> 00:19:49,860
with the same miner wasn't that

416
00:19:48,009 --> 00:19:55,299
successful because that specific thing

417
00:19:49,860 --> 00:19:57,729
actually crashed most systems so you can

418
00:19:55,299 --> 00:20:00,309
see here the localhost you can see the

419
00:19:57,730 --> 00:20:04,350
HTML they infected with the JavaScript

420
00:20:00,309 --> 00:20:07,720
you can also see their icon etc

421
00:20:04,350 --> 00:20:11,530
cool so other than being really really

422
00:20:07,720 --> 00:20:14,680
evasive there is also a quite of feature

423
00:20:11,530 --> 00:20:16,840
that we've looked at coin miners and we

424
00:20:14,680 --> 00:20:19,510
discovered that they are very very

425
00:20:16,840 --> 00:20:21,850
competitive anyone who's done instant

426
00:20:19,510 --> 00:20:25,000
response for a long time probably found

427
00:20:21,850 --> 00:20:27,969
a machine with like five six malware

428
00:20:25,000 --> 00:20:29,410
fisting from the same end point all

429
00:20:27,970 --> 00:20:31,750
living together for like three years

430
00:20:29,410 --> 00:20:33,960
nobody cares it's all good we are all

431
00:20:31,750 --> 00:20:37,000
like a nice big happy family here but

432
00:20:33,960 --> 00:20:40,690
coin miners really similar to ransomware

433
00:20:37,000 --> 00:20:43,210
are very very strict about gaining

434
00:20:40,690 --> 00:20:45,880
exclusivity in their victim machine why

435
00:20:43,210 --> 00:20:47,950
is that look at it - coin miners running

436
00:20:45,880 --> 00:20:49,810
on the same machine first of course

437
00:20:47,950 --> 00:20:51,760
they're gonna share the resources so

438
00:20:49,810 --> 00:20:53,370
they're gonna generate less income but

439
00:20:51,760 --> 00:20:56,020
also the probably gotta crush the system

440
00:20:53,370 --> 00:20:58,060
so some of them and the most

441
00:20:56,020 --> 00:21:01,030
sophisticated ones have developed a

442
00:20:58,060 --> 00:21:04,149
really cool features to kill their

443
00:21:01,030 --> 00:21:07,780
competitors so ghost miner is another

444
00:21:04,150 --> 00:21:10,300
threat we have first found it where we

445
00:21:07,780 --> 00:21:14,110
got a an alert preventing a file s

446
00:21:10,300 --> 00:21:16,540
attacks in Minerva and we quickly went

447
00:21:14,110 --> 00:21:19,209
and investigated and we found a complete

448
00:21:16,540 --> 00:21:22,090
file as framework built out of

449
00:21:19,210 --> 00:21:25,300
PowerShell and some memory injections it

450
00:21:22,090 --> 00:21:27,639
was using a couple of warm capabilities

451
00:21:25,300 --> 00:21:33,820
like using exploiting Oracle WebLogic

452
00:21:27,640 --> 00:21:36,400
attack ms SQL SMB recent versions also

453
00:21:33,820 --> 00:21:38,500
started to use mimic ads so it was

454
00:21:36,400 --> 00:21:42,490
really propagating in the network you

455
00:21:38,500 --> 00:21:44,980
can see here a task task bar open and

456
00:21:42,490 --> 00:21:47,230
how many network activity does trying to

457
00:21:44,980 --> 00:21:49,450
find more machines and you can see here

458
00:21:47,230 --> 00:21:52,800
in the network capture it was actually

459
00:21:49,450 --> 00:21:55,510
using XM rig which we described earlier

460
00:21:52,800 --> 00:21:59,980
basically ghost miner was really basic

461
00:21:55,510 --> 00:22:02,200
was using quite a cool part of power

462
00:21:59,980 --> 00:22:04,060
sploit power spot is a files framework

463
00:22:02,200 --> 00:22:07,750
and they're using a command called

464
00:22:04,060 --> 00:22:10,149
invoke reflective p injection we've let

465
00:22:07,750 --> 00:22:13,500
a reflective originally it's reflective

466
00:22:10,150 --> 00:22:16,930
DLL injection but it's a way to execute

467
00:22:13,500 --> 00:22:18,250
foreign code in remote process without

468
00:22:16,930 --> 00:22:22,299
register

469
00:22:18,250 --> 00:22:25,090
registrated the dll or the PE itself so

470
00:22:22,299 --> 00:22:29,830
it's a way to bypass most anti viruses

471
00:22:25,090 --> 00:22:33,220
today etc so an example the first

472
00:22:29,830 --> 00:22:35,678
generation of ghost miner was using a

473
00:22:33,220 --> 00:22:37,179
file on disk and we found it after we

474
00:22:35,679 --> 00:22:40,059
found the ghost miner we were able to

475
00:22:37,179 --> 00:22:42,250
track down in and in virustotal to find

476
00:22:40,059 --> 00:22:44,350
some key features it was used earlier

477
00:22:42,250 --> 00:22:46,169
and you can see the first generation was

478
00:22:44,350 --> 00:22:48,939
heavily detected by the antivirus

479
00:22:46,169 --> 00:22:51,460
community but the second generation was

480
00:22:48,940 --> 00:22:55,179
not detected at all at least at the

481
00:22:51,460 --> 00:22:59,080
start but other than being really

482
00:22:55,179 --> 00:23:02,159
evasive course miner the authors did an

483
00:22:59,080 --> 00:23:05,620
amazing research on their competitors

484
00:23:02,159 --> 00:23:09,279
they analyzed them and they created

485
00:23:05,620 --> 00:23:11,918
amazing set of tools to kill competition

486
00:23:09,279 --> 00:23:13,899
so what we did with reverse engineering

487
00:23:11,919 --> 00:23:16,480
the obfuscated the code making it a bit

488
00:23:13,899 --> 00:23:20,439
more safe and we shared a script called

489
00:23:16,480 --> 00:23:22,510
miner killer miner killer can you be

490
00:23:20,440 --> 00:23:25,480
used by inside response team and

491
00:23:22,510 --> 00:23:29,710
defenders to actually go and hunt and

492
00:23:25,480 --> 00:23:31,450
kill coin miners in their network if you

493
00:23:29,710 --> 00:23:33,000
do decide to use it please use with

494
00:23:31,450 --> 00:23:35,950
caution it's actually used to kill

495
00:23:33,000 --> 00:23:38,669
application sir but go ahead and look

496
00:23:35,950 --> 00:23:42,519
she'll be very educational

497
00:23:38,669 --> 00:23:48,309
so here's an example of ghost miner in

498
00:23:42,519 --> 00:23:51,039
action basically you can see here

499
00:23:48,309 --> 00:23:53,168
there's an exome rig process running in

500
00:23:51,039 --> 00:23:56,049
the background in the left side we're

501
00:23:53,169 --> 00:23:58,120
gonna execute the PowerShell and as soon

502
00:23:56,049 --> 00:24:01,179
as will execute the PowerShell it will

503
00:23:58,120 --> 00:24:03,399
basically use techniques used by ghost

504
00:24:01,179 --> 00:24:05,019
mire at the start looking for specific

505
00:24:03,399 --> 00:24:07,330
names and then it will kill the exome

506
00:24:05,019 --> 00:24:09,580
rate it has also other features it will

507
00:24:07,330 --> 00:24:13,000
look for scheduled tasks services

508
00:24:09,580 --> 00:24:17,980
network traffic stuff like that so it's

509
00:24:13,000 --> 00:24:20,919
pretty effective alright another very

510
00:24:17,980 --> 00:24:22,659
very competitive coin miner is addict

511
00:24:20,919 --> 00:24:26,529
use and again probably I'm not

512
00:24:22,659 --> 00:24:29,080
pronouncing it right so but addict use

513
00:24:26,529 --> 00:24:31,820
was a coal miner started around April

514
00:24:29,080 --> 00:24:34,340
last year but then

515
00:24:31,820 --> 00:24:36,710
merge big after the NSA exploit were

516
00:24:34,340 --> 00:24:41,540
released after wanna cry and in but

517
00:24:36,710 --> 00:24:44,360
unlike you I WI X and wanna cry it was

518
00:24:41,540 --> 00:24:46,129
using it was using the exploits manually

519
00:24:44,360 --> 00:24:48,439
the attack actually went machine by

520
00:24:46,130 --> 00:24:50,630
machine and trying to exploit them the

521
00:24:48,440 --> 00:24:55,340
team Thomas and the team at McAfee have

522
00:24:50,630 --> 00:24:57,530
analyzed and compared samples before the

523
00:24:55,340 --> 00:24:59,659
experts were released and after and they

524
00:24:57,530 --> 00:25:03,710
found very interesting bit and that bit

525
00:24:59,660 --> 00:25:07,640
is that the new mesh the new samples

526
00:25:03,710 --> 00:25:12,170
have been using a bad script batch file

527
00:25:07,640 --> 00:25:13,820
to patch the systems that they infected

528
00:25:12,170 --> 00:25:17,570
so before running the corn miner

529
00:25:13,820 --> 00:25:19,429
first thing they did let's exploit the

530
00:25:17,570 --> 00:25:21,560
system get a hold of it and then let's

531
00:25:19,430 --> 00:25:23,780
patch it why would they patch it they

532
00:25:21,560 --> 00:25:26,629
don't want anyone else to get into that

533
00:25:23,780 --> 00:25:31,430
system as well so it's quite funny I was

534
00:25:26,630 --> 00:25:36,380
thinking why do I prefer run somewhere

535
00:25:31,430 --> 00:25:38,470
or a coal miner I don't know I bet it's

536
00:25:36,380 --> 00:25:43,580
a coin miner

537
00:25:38,470 --> 00:25:45,920
so those evasive tactics are not the

538
00:25:43,580 --> 00:25:48,850
only one you can see in coin miners but

539
00:25:45,920 --> 00:25:51,580
the main features the used coin miner

540
00:25:48,850 --> 00:25:56,840
evasive techniques in coal miners is

541
00:25:51,580 --> 00:25:59,330
that they want to not be discovered and

542
00:25:56,840 --> 00:26:03,080
usually how coin miners are discovered

543
00:25:59,330 --> 00:26:05,330
is by generating a lot of CPU overload

544
00:26:03,080 --> 00:26:07,220
so one of the recent thing we're

545
00:26:05,330 --> 00:26:09,889
starting to see for example a coin miner

546
00:26:07,220 --> 00:26:13,430
we call nice miner so that nice but it's

547
00:26:09,890 --> 00:26:15,710
nicer than others it's using a single

548
00:26:13,430 --> 00:26:19,400
friend to run so they probably gonna

549
00:26:15,710 --> 00:26:21,620
make less income or less coins at the

550
00:26:19,400 --> 00:26:25,400
start but in the long term they're gonna

551
00:26:21,620 --> 00:26:26,780
be less detected so they might make you

552
00:26:25,400 --> 00:26:30,080
know longer to run they're gonna make

553
00:26:26,780 --> 00:26:32,600
more money also we've seen some really

554
00:26:30,080 --> 00:26:34,730
clever techniques to only monitor on

555
00:26:32,600 --> 00:26:36,679
specific work in ours like using the

556
00:26:34,730 --> 00:26:38,930
domain log on and working hours and

557
00:26:36,680 --> 00:26:41,120
whenever those are over they will start

558
00:26:38,930 --> 00:26:43,460
mining and even more clever and more

559
00:26:41,120 --> 00:26:45,139
effective I believe is to monitor for

560
00:26:43,460 --> 00:26:47,930
user inactivity so

561
00:26:45,140 --> 00:26:50,230
for example they will hook the mouse

562
00:26:47,930 --> 00:26:52,760
functions the keyboard functions and

563
00:26:50,230 --> 00:26:55,760
screens function related functions and

564
00:26:52,760 --> 00:26:57,890
whenever it is a movement or stroking or

565
00:26:55,760 --> 00:27:00,710
changes in the screens that will stop

566
00:26:57,890 --> 00:27:04,160
executing the coin miner user goes to

567
00:27:00,710 --> 00:27:06,020
grab a coffee go to lunch go to sleep go

568
00:27:04,160 --> 00:27:09,080
to the wheel over the weekend there will

569
00:27:06,020 --> 00:27:11,900
one so it's really really effective in

570
00:27:09,080 --> 00:27:14,000
related to web mining we started to see

571
00:27:11,900 --> 00:27:16,790
some other clever techniques like using

572
00:27:14,000 --> 00:27:17,780
a really really small pixel in the tab

573
00:27:16,790 --> 00:27:19,580
of the browser

574
00:27:17,780 --> 00:27:21,889
so basically user don't see it and

575
00:27:19,580 --> 00:27:24,800
actually don't exit it and also things

576
00:27:21,890 --> 00:27:26,840
like popping under under taskbar in

577
00:27:24,800 --> 00:27:34,060
other places so users won't be able to

578
00:27:26,840 --> 00:27:37,790
see those frames now we took the most

579
00:27:34,060 --> 00:27:39,470
common evasive tactics of coin miners

580
00:27:37,790 --> 00:27:41,690
and we put it was actually a really huge

581
00:27:39,470 --> 00:27:44,330
table at the start but we decided to

582
00:27:41,690 --> 00:27:46,310
minimize it to the ones case the case we

583
00:27:44,330 --> 00:27:50,360
showed here but it's really really

584
00:27:46,310 --> 00:27:52,879
obvious to see two features there are

585
00:27:50,360 --> 00:27:55,459
almost in more there are in most coin

586
00:27:52,880 --> 00:27:58,340
miners the first of them is anti

587
00:27:55,460 --> 00:28:01,460
monitoring and the second is injection

588
00:27:58,340 --> 00:28:04,370
memory injection now if my talk was

589
00:28:01,460 --> 00:28:05,990
right and I was a bit educated here some

590
00:28:04,370 --> 00:28:08,929
of your own and all of you are already

591
00:28:05,990 --> 00:28:10,910
kind of understanding why this is are

592
00:28:08,930 --> 00:28:14,900
the basic features or the most use

593
00:28:10,910 --> 00:28:18,910
evasive tactics in coin miners ante

594
00:28:14,900 --> 00:28:22,930
monitoring it's because you want to hide

595
00:28:18,910 --> 00:28:26,030
the fact that you are using a lot of CPU

596
00:28:22,930 --> 00:28:28,280
from system it means for super users or

597
00:28:26,030 --> 00:28:31,010
anyone who looks and look for why their

598
00:28:28,280 --> 00:28:35,170
computers are running slow like in the

599
00:28:31,010 --> 00:28:39,020
case of water miner the other thing that

600
00:28:35,170 --> 00:28:44,180
using memory injection is because they

601
00:28:39,020 --> 00:28:47,690
can run their malicious coin mining

602
00:28:44,180 --> 00:28:51,170
inside a process for example like SVC

603
00:28:47,690 --> 00:28:53,420
host all others that are really prone to

604
00:28:51,170 --> 00:28:56,170
use a lot of CPU so it wouldn't raise

605
00:28:53,420 --> 00:28:58,850
suspicious a lot of logics in both

606
00:28:56,170 --> 00:29:01,370
analyst human analyst and some

607
00:28:58,850 --> 00:29:04,189
even some of the product is going

608
00:29:01,370 --> 00:29:06,770
basically like that if it's using a lot

609
00:29:04,190 --> 00:29:09,230
of CPU and it's an unknown process then

610
00:29:06,770 --> 00:29:11,450
it's probably a malware if it's using a

611
00:29:09,230 --> 00:29:12,350
lot of CPU and it's a known process then

612
00:29:11,450 --> 00:29:14,180
it's probably some really bad

613
00:29:12,350 --> 00:29:15,350
application and with a lot of attackers

614
00:29:14,180 --> 00:29:18,440
want to be like a better application

615
00:29:15,350 --> 00:29:19,580
nobody deletes a better application so

616
00:29:18,440 --> 00:29:23,020
this is why they are using memory

617
00:29:19,580 --> 00:29:29,199
injections as well process injections

618
00:29:23,020 --> 00:29:31,720
now as I said it's not a really

619
00:29:29,200 --> 00:29:35,530
educative talk if we didn't give some

620
00:29:31,720 --> 00:29:38,690
tools to mitigate the fret your own or

621
00:29:35,530 --> 00:29:42,020
give some defensive tactics so one of

622
00:29:38,690 --> 00:29:45,650
the first tactics will suggest is to use

623
00:29:42,020 --> 00:29:48,020
monitoring tools to look for high CPU

624
00:29:45,650 --> 00:29:50,750
when I say monitoring tools don't be

625
00:29:48,020 --> 00:29:52,850
confused with task manager and then tell

626
00:29:50,750 --> 00:29:55,220
your users once a day to open test me

627
00:29:52,850 --> 00:29:57,230
and then read out the printout I'm

628
00:29:55,220 --> 00:30:00,110
looking for things like in data centers

629
00:29:57,230 --> 00:30:03,650
to use things like always query or you

630
00:30:00,110 --> 00:30:05,209
know a stack of elastic to look for CPU

631
00:30:03,650 --> 00:30:07,940
activity

632
00:30:05,210 --> 00:30:10,010
there are also some built-in tools in

633
00:30:07,940 --> 00:30:12,800
the operation system that are less prone

634
00:30:10,010 --> 00:30:15,020
to be manipulated by anti monitoring -

635
00:30:12,800 --> 00:30:17,870
by monitoring or anti monitoring tactics

636
00:30:15,020 --> 00:30:19,970
I will share some on my Twitter in the

637
00:30:17,870 --> 00:30:23,449
next couple of hours after this talk

638
00:30:19,970 --> 00:30:27,530
here's a link to the minor killer we've

639
00:30:23,450 --> 00:30:29,450
released don't just use it as a script

640
00:30:27,530 --> 00:30:33,350
kiddie and run and hope that it will

641
00:30:29,450 --> 00:30:37,040
kill coin miners study it like we did

642
00:30:33,350 --> 00:30:39,919
study what ghost miner of research and

643
00:30:37,040 --> 00:30:42,409
what they found is effective against

644
00:30:39,920 --> 00:30:45,140
miners you're probably gonna find some

645
00:30:42,410 --> 00:30:47,630
really cool insights out of it if you do

646
00:30:45,140 --> 00:30:50,570
have your own additions please feel free

647
00:30:47,630 --> 00:30:54,680
to do comets and and pull requests we'll

648
00:30:50,570 --> 00:30:57,860
be happy to add some the good folks at

649
00:30:54,680 --> 00:31:01,280
McAfee and Thomas have shared a nice set

650
00:30:57,860 --> 00:31:04,939
of yarra rules to detect XM ring and

651
00:31:01,280 --> 00:31:06,020
other coin mining related frets it's

652
00:31:04,940 --> 00:31:09,050
really good list

653
00:31:06,020 --> 00:31:12,690
it keeps frequently updating so please

654
00:31:09,050 --> 00:31:15,659
use that also we really recommend you

655
00:31:12,690 --> 00:31:16,560
monitoring traffic using tools like

656
00:31:15,660 --> 00:31:19,410
sericata

657
00:31:16,560 --> 00:31:23,899
and snort and other you know even more

658
00:31:19,410 --> 00:31:26,400
commercial tools coin - can mostly be

659
00:31:23,900 --> 00:31:29,400
easily detected in the network

660
00:31:26,400 --> 00:31:32,760
especially if they use mining pools mine

661
00:31:29,400 --> 00:31:35,480
impose traffic and protocols are pretty

662
00:31:32,760 --> 00:31:37,500
unique to them and also pretty standard

663
00:31:35,480 --> 00:31:40,380
which bring me to the last

664
00:31:37,500 --> 00:31:43,230
recommendation but not least there is a

665
00:31:40,380 --> 00:31:45,390
fret in toe sauce the best for coin

666
00:31:43,230 --> 00:31:48,030
miners which is called coin blocker

667
00:31:45,390 --> 00:31:52,620
lists coin blocker list is maintained by

668
00:31:48,030 --> 00:31:54,629
zero no there's a link here and quite

669
00:31:52,620 --> 00:31:56,699
blocker lease is really really effective

670
00:31:54,630 --> 00:31:59,870
and a lot of research constantly

671
00:31:56,700 --> 00:32:03,270
updating it looking at domains and IPS

672
00:31:59,870 --> 00:32:06,540
related to coin miners you can use it in

673
00:32:03,270 --> 00:32:10,230
many ways here's a quick demo as an

674
00:32:06,540 --> 00:32:12,720
example what we did we have took coin

675
00:32:10,230 --> 00:32:16,260
blocker list and used little snitch

676
00:32:12,720 --> 00:32:18,300
block list and join them together in a

677
00:32:16,260 --> 00:32:20,910
Mac environment and in here is an

678
00:32:18,300 --> 00:32:23,940
example you can see on the top it's a

679
00:32:20,910 --> 00:32:26,610
website infected with coin high and you

680
00:32:23,940 --> 00:32:29,430
can see it using a lot of CPU as soon as

681
00:32:26,610 --> 00:32:31,649
you enable a little snitch to block any

682
00:32:29,430 --> 00:32:34,770
coin blocker lists domains you see the

683
00:32:31,650 --> 00:32:36,660
CPU drops because it doesn't let connect

684
00:32:34,770 --> 00:32:38,550
to acorn hive if you are managing the

685
00:32:36,660 --> 00:32:40,950
firewall of your organization this is

686
00:32:38,550 --> 00:32:43,590
going to be very very effective vast

687
00:32:40,950 --> 00:32:45,780
majority of coin - at least today they

688
00:32:43,590 --> 00:32:48,360
are moving a bit away from it are still

689
00:32:45,780 --> 00:32:51,510
using mining pools and those domains and

690
00:32:48,360 --> 00:32:52,229
IPS don't change that frequent so fret

691
00:32:51,510 --> 00:32:54,660
Intel

692
00:32:52,230 --> 00:32:57,060
unlike most malware attacks today is

693
00:32:54,660 --> 00:32:58,230
still quite effective they are moving

694
00:32:57,060 --> 00:32:59,899
from it I'll spoke about it in a

695
00:32:58,230 --> 00:33:03,780
prediction

696
00:32:59,900 --> 00:33:08,490
another thing that recently did I wrote

697
00:33:03,780 --> 00:33:10,470
a really easy search bar for coin block

698
00:33:08,490 --> 00:33:13,020
your list on my website so if you look

699
00:33:10,470 --> 00:33:15,000
you look at the domain and it's using a

700
00:33:13,020 --> 00:33:17,340
lot of CPU you want to check if it's

701
00:33:15,000 --> 00:33:19,110
already in the coin blocker list you can

702
00:33:17,340 --> 00:33:21,959
check it here it's actually using an API

703
00:33:19,110 --> 00:33:25,530
there's also an API for it and this is

704
00:33:21,960 --> 00:33:26,490
gonna be more sophisticated soon you can

705
00:33:25,530 --> 00:33:28,678
actually add domain

706
00:33:26,490 --> 00:33:30,540
- coin block your list you can distract

707
00:33:28,679 --> 00:33:31,830
take out domains if you think it's a

708
00:33:30,540 --> 00:33:33,990
false positive

709
00:33:31,830 --> 00:33:39,240
etc so and we're gonna automate that as

710
00:33:33,990 --> 00:33:42,059
well so stay tuned now I'm not a big

711
00:33:39,240 --> 00:33:44,640
gambler but I think we can already see

712
00:33:42,059 --> 00:33:47,370
some future trends in coin miners

713
00:33:44,640 --> 00:33:50,520
it's a new fear it's a new fret but it's

714
00:33:47,370 --> 00:33:52,050
moving rapidly fast so we are actually

715
00:33:50,520 --> 00:33:54,450
predicting it's going to increase even

716
00:33:52,050 --> 00:33:55,230
more when we first research it it wasn't

717
00:33:54,450 --> 00:33:58,320
that big

718
00:33:55,230 --> 00:34:00,450
now we've seen major shift from ransom

719
00:33:58,320 --> 00:34:02,300
erectors to coin miners we seen

720
00:34:00,450 --> 00:34:07,050
Frederick's was jumping on that wagon

721
00:34:02,300 --> 00:34:10,710
even both huge Boyd miners like necrose

722
00:34:07,050 --> 00:34:13,529
and old Zeus are now deploying add-ons -

723
00:34:10,710 --> 00:34:16,409
whenever they decide to run coin corn

724
00:34:13,530 --> 00:34:18,869
miners so it's gonna be even bigger and

725
00:34:16,409 --> 00:34:20,429
another thing of it being big we're

726
00:34:18,869 --> 00:34:21,929
already starting to see but it's not

727
00:34:20,429 --> 00:34:24,810
that big but it's gonna be much more

728
00:34:21,929 --> 00:34:27,389
frequent soon I believe is they're going

729
00:34:24,810 --> 00:34:31,350
to attack more different unattended

730
00:34:27,389 --> 00:34:33,300
devices like routers IOT light bulbs air

731
00:34:31,350 --> 00:34:35,129
conditioning basically everything that

732
00:34:33,300 --> 00:34:37,770
connects to the Internet and the reason

733
00:34:35,129 --> 00:34:40,710
for it it's really hard to monitor those

734
00:34:37,770 --> 00:34:42,750
devices and also they have a lot of

735
00:34:40,710 --> 00:34:45,470
vulnerabilities so they can get in there

736
00:34:42,750 --> 00:34:48,600
and today what do you do with a

737
00:34:45,469 --> 00:34:50,399
vulnerable or hijacked IOT device if

738
00:34:48,600 --> 00:34:52,139
it's an organization maybe you can use

739
00:34:50,399 --> 00:34:55,259
it as a pivot point to get into the

740
00:34:52,139 --> 00:34:57,090
organization maybe send spam not easy

741
00:34:55,260 --> 00:34:59,070
if you run coin minor this is a really

742
00:34:57,090 --> 00:35:04,080
good use case for those kind of devices

743
00:34:59,070 --> 00:35:06,180
even cars we are going to see and we

744
00:35:04,080 --> 00:35:09,480
started to see the really small size of

745
00:35:06,180 --> 00:35:11,399
it of instead of using mining pools we

746
00:35:09,480 --> 00:35:13,470
are starting to see malicious mining

747
00:35:11,400 --> 00:35:18,450
pools that were built in the sole

748
00:35:13,470 --> 00:35:20,819
intention to provide a secure Eden home

749
00:35:18,450 --> 00:35:22,290
for malicious crypto miners so instead

750
00:35:20,820 --> 00:35:24,300
of the use the public pools which use

751
00:35:22,290 --> 00:35:25,830
similar domains IPs

752
00:35:24,300 --> 00:35:28,290
they actually gonna use the things like

753
00:35:25,830 --> 00:35:30,630
proxy and domain generation algorithms

754
00:35:28,290 --> 00:35:33,930
and gonna change the IPS etc to make it

755
00:35:30,630 --> 00:35:35,910
much more harder to detect and it's a

756
00:35:33,930 --> 00:35:38,790
prediction but probably well if you're

757
00:35:35,910 --> 00:35:39,810
gonna see that and we also believe there

758
00:35:38,790 --> 00:35:41,970
gonna be we innovate

759
00:35:39,810 --> 00:35:44,400
some of their evasive tactics may be

760
00:35:41,970 --> 00:35:48,660
also because they say they stock and

761
00:35:44,400 --> 00:35:51,300
they need to improve alright so just a

762
00:35:48,660 --> 00:35:54,450
quick recap of what we discussed in this

763
00:35:51,300 --> 00:35:57,660
talk we have looked at the landscape the

764
00:35:54,450 --> 00:35:59,730
rise of coal miners what are the basic

765
00:35:57,660 --> 00:36:02,940
features of you things like XMR and

766
00:35:59,730 --> 00:36:06,450
mining pools we have deep dive into some

767
00:36:02,940 --> 00:36:09,060
of the more frequent evasive tactics and

768
00:36:06,450 --> 00:36:11,580
tools we have looked at some of the

769
00:36:09,060 --> 00:36:14,400
competition behind the coal miners and

770
00:36:11,580 --> 00:36:16,980
how they actually operate we offered

771
00:36:14,400 --> 00:36:20,970
awfully some good and defensive tactics

772
00:36:16,980 --> 00:36:23,090
that you might use and we have explored

773
00:36:20,970 --> 00:36:25,470
some future trends and prediction that

774
00:36:23,090 --> 00:36:27,090
hopefully will never go but if they do

775
00:36:25,470 --> 00:36:33,209
it might say we right or maybe they go

776
00:36:27,090 --> 00:36:36,510
using something else so how do I talk

777
00:36:33,210 --> 00:36:40,629
when I must thank you

778
00:36:36,510 --> 00:36:40,629
[Applause]

