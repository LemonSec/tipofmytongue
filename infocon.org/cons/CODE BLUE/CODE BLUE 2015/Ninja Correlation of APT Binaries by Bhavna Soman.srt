1
00:00:11,450 --> 00:00:13,820
ladies and gentlemen

2
00:00:13,820 --> 00:00:16,329
here

3
00:00:16,329 --> 00:00:30,979
and I'm excited to share with my team
has done this is my first time in Japan

4
00:00:30,980 --> 00:00:37,400
and am very excited to be here let me
introduce myself my name is Bob national

5
00:00:37,400 --> 00:00:43,500
men and I work for Intel Corporation in
the United States my team is going

6
00:00:43,500 --> 00:00:49,049
advanced countermeasures intrusion and
response we deal with the advanced

7
00:00:49,049 --> 00:00:54,949
adversary of the target Intel and my
specific areas of focus on trade

8
00:00:54,949 --> 00:01:01,970
intelligence and data analytics today I
will be talking about thread actors and

9
00:01:01,970 --> 00:01:06,630
how we can use funny hashing techniques
to cluster minorities by the Trek actor

10
00:01:06,630 --> 00:01:11,070
who created them in a way this
presentation is about the journey of my

11
00:01:11,070 --> 00:01:15,570
teen when we were trying to solve the
critical challenge in deciphering

12
00:01:15,570 --> 00:01:22,369
malware by Andys in a short amount of
time before we continue I will give you

13
00:01:22,370 --> 00:01:26,600
a few disclaimers research India
presented here on my own and do not

14
00:01:26,600 --> 00:01:31,720
represent intel and the other one is
just a long form legally saying no

15
00:01:31,720 --> 00:01:38,890
computer system can be absolutely secure
just into lawyers I write this is the

16
00:01:38,890 --> 00:01:44,310
agenda that were gonna work on today but
I'll give you some background on white

17
00:01:44,310 --> 00:01:50,560
can be valuable to focus on trade actors
to improve incident response how we can

18
00:01:50,560 --> 00:01:55,360
help us improve the process and the
defensive stance of an organization and

19
00:01:55,360 --> 00:01:59,280
we will talk about what we can do what
we want to focus on my mind at ease and

20
00:01:59,280 --> 00:02:04,020
tried actors we will look at some
algorithms that can be used to connect

21
00:02:04,020 --> 00:02:08,179
minorities and we will see how we can
get some data and ground troops to death

22
00:02:08,179 --> 00:02:13,340
those methods I'll show you the result
the day God and found the clusters that

23
00:02:13,340 --> 00:02:20,780
we found and finally we conclude with
the takeaways in future direction so I'm

24
00:02:20,780 --> 00:02:25,980
gonna talk a fair bit about trend actors
today and referred to apt research that

25
00:02:25,980 --> 00:02:26,700
has been done

26
00:02:26,700 --> 00:02:33,319
done by security companies leg McAfee of
course keep in mind that etcetera but a

27
00:02:33,319 --> 00:02:37,869
lot of my peers in the incident response
community don't believe in the

28
00:02:37,870 --> 00:02:42,730
importance of identifying trend actors
according to them the only important

29
00:02:42,730 --> 00:02:48,569
thing is detection and eviction I would
like to disagree with them when we talk

30
00:02:48,569 --> 00:02:52,929
about attribution we're not heading to
law enforcement style identification

31
00:02:52,930 --> 00:02:58,720
what we're talking about creating
intelligence around actor profiles we

32
00:02:58,720 --> 00:03:03,590
want to identify the motive of an
adversary we want to identify the tools

33
00:03:03,590 --> 00:03:09,860
than the commonly used availability of
that they go after what example one

34
00:03:09,860 --> 00:03:14,239
particular actor group might have to
focus on MS Word or internet exploded

35
00:03:14,239 --> 00:03:19,230
related vulnerabilities whereas another
actor might focus on PDF and flash

36
00:03:19,230 --> 00:03:24,480
exploits so this kind of information can
help us identify what are the specific

37
00:03:24,480 --> 00:03:31,810
research that the activist doing and the
final response accordingly such

38
00:03:31,810 --> 00:03:35,220
information can also help us make
strategic investments in our own defense

39
00:03:35,220 --> 00:03:39,720
what are the sort of product we want to
install in our environment and when do

40
00:03:39,720 --> 00:03:44,269
we want to invest in our research and
finally it can help us refine I didn't

41
00:03:44,269 --> 00:03:50,000
respond let me let me share a little bit
about how we can do that how can knowing

42
00:03:50,000 --> 00:03:53,329
the origins of the militias binary give
you an advantage in the incident

43
00:03:53,329 --> 00:04:02,489
response process what is the value of
connecting on my 99 bad actor in

44
00:04:02,489 --> 00:04:07,260
connecting a binding to an actor give
you an advantage in your response

45
00:04:07,260 --> 00:04:16,469
process yet first if we can find
minorities in our environment that

46
00:04:16,470 --> 00:04:21,849
connected to a thread group that we've
previously look bad then we can apply

47
00:04:21,849 --> 00:04:26,950
our existing knowledge about the
motivations and capability of adversity

48
00:04:26,950 --> 00:04:35,050
but I response but example if I know
that a particular tobacco is likely to

49
00:04:35,050 --> 00:04:37,950
find a fishing message to steal
credentials

50
00:04:37,950 --> 00:04:43,450
and then attacks the mail so vote than
15 feet away from that attack I know

51
00:04:43,450 --> 00:04:50,490
where to look for next and secondly if
we can connect the different malware by

52
00:04:50,490 --> 00:04:56,160
no means found in the environment to
think that after the nineteen billion a

53
00:04:56,160 --> 00:05:01,940
complete picture of a concerted attack
against my organization instead of just

54
00:05:01,940 --> 00:05:11,450
seemed random isolated infections so how
can we make those connections best that

55
00:05:11,450 --> 00:05:15,780
is the question that we were trying to
answer tonight own team and automation

56
00:05:15,780 --> 00:05:21,520
with a big factor in this and you all
know reversing is a very time-consuming

57
00:05:21,520 --> 00:05:26,349
and tedious process and in the short
amount of time that is available for

58
00:05:26,350 --> 00:05:30,340
responding to an incident detailed
reverse engineering is not always

59
00:05:30,340 --> 00:05:38,679
possible so what we wanted to do was
build a database of APT deleted by

60
00:05:38,680 --> 00:05:43,670
native related actor that we have
analyzed in the past and then have a

61
00:05:43,670 --> 00:05:49,070
short guide new minority to those
methods we also wanted to collaborate

62
00:05:49,070 --> 00:05:53,960
with industry friends and peers so that
they could we could use the same metric

63
00:05:53,960 --> 00:05:57,510
when talking to each other and having
conversations such as have you seen this

64
00:05:57,510 --> 00:06:01,650
adversity on this mining before and can
you share information with us about it

65
00:06:01,650 --> 00:06:08,929
so I first candidate in such an
algorithm was the impact of them into

66
00:06:08,930 --> 00:06:14,820
the pretty simple algorithm it is just
calculate the md5 hash of the import

67
00:06:14,820 --> 00:06:20,890
address table after P E minor if it was
proposed by us- company called mandiant

68
00:06:20,890 --> 00:06:28,580
in 2014 and the premise of that threat
groups like apt one they use the same

69
00:06:28,580 --> 00:06:33,229
tools and environments to build their
militias mind at ease so that is a

70
00:06:33,230 --> 00:06:36,970
software development team almost that
sitting there and building on this

71
00:06:36,970 --> 00:06:43,230
malicious code and they end up using the
same compilers the same libraries etc

72
00:06:43,230 --> 00:06:46,910
the import address table can be
indicative of the binary having

73
00:06:46,910 --> 00:06:52,940
originated from the same threat actor
and quick checks with this message heard

74
00:06:52,940 --> 00:06:58,310
and it seemed to have relations and a
lot of false positives so I decided to

75
00:06:58,310 --> 00:07:03,290
look outside of that mattered under
algorithms that have been traditionally

76
00:07:03,290 --> 00:07:08,060
used to measure court similarity this
group of technique is quite funny

77
00:07:08,060 --> 00:07:17,400
hashing and I looked at two specific
algorithms and steve is commonly used in

78
00:07:17,400 --> 00:07:22,520
forensic applications it measures the
similarity between two files instead of

79
00:07:22,520 --> 00:07:26,870
just creating one half of the entire
file it breaks the file into smaller

80
00:07:26,870 --> 00:07:33,850
chunks each piece and then create the
combined hash of the whole file and then

81
00:07:33,850 --> 00:07:37,630
similarity can be calculated by
comparing each of the smaller chunks

82
00:07:37,630 --> 00:07:43,300
between two files in fact there was some
interesting research done by an

83
00:07:43,300 --> 00:07:48,040
organization called shadow so when it
was found that finally have that had a

84
00:07:48,040 --> 00:07:56,180
high similarity scored using excess deep
we're likely from the same family so

85
00:07:56,180 --> 00:08:00,800
limited that we looked at was St hash in
this was proposed by a researcher

86
00:08:00,800 --> 00:08:06,720
capacity to serve in 2010 it uses
probabilistic feature extraction extract

87
00:08:06,720 --> 00:08:12,590
features they don't occur randomly it
has been put them in a Bloom filter

88
00:08:12,590 --> 00:08:17,000
which is another probabilistically the
structure to compare the similarity

89
00:08:17,000 --> 00:08:22,760
between two files the Hamming distance
between two computers is calculated so

90
00:08:22,760 --> 00:08:26,920
the idea behind that is that if the
files are similar in a statistically

91
00:08:26,920 --> 00:08:32,960
significant way then they were probably
created by the same threat after each

92
00:08:32,960 --> 00:08:38,360
treatment holds they calculate semantics
in a very different way in past years of

93
00:08:38,360 --> 00:08:43,270
the quality of the other to use
similarity distance to get to be any

94
00:08:43,270 --> 00:08:48,120
involvement could have walked away in
connecting apt miners to each other but

95
00:08:48,120 --> 00:08:53,560
we didn't know which and to find that
out we had two major problems

96
00:08:53,560 --> 00:09:02,800
the first one was there where can we get
a day decide significant data set of

97
00:09:02,800 --> 00:09:08,130
binary of related to apt campaigns as
you all know companies are hesitant to

98
00:09:08,130 --> 00:09:13,300
share this data because of privacy and
legal concerns but it also makes it

99
00:09:13,300 --> 00:09:17,609
difficult for researchers to get this
data and run algorithms on so that was a

100
00:09:17,610 --> 00:09:21,470
foot problem and the second problem was
that if we do get a native of

101
00:09:21,470 --> 00:09:29,900
non-trivial say how do we have hundreds
on mine it is then we have about 5,000

102
00:09:29,900 --> 00:09:33,430
Art Basel Miami is to check and we can't
manually go through all of this data

103
00:09:33,430 --> 00:09:37,689
manually classify each of the
correlations as a positive or negative

104
00:09:37,690 --> 00:09:45,430
to conduct any research on it so this is
what we tackle these problems the first

105
00:09:45,430 --> 00:09:50,560
one of gathering the data we collected
all the apt white papers that were

106
00:09:50,560 --> 00:09:56,439
created by various researchers from
January to March 2015 we got $0.25

107
00:09:56,440 --> 00:10:00,360
research people as in we used text
analysis techniques to extract oil hash

108
00:10:00,360 --> 00:10:05,680
things mentioned in those papers really
created that can extract I receive from

109
00:10:05,680 --> 00:10:09,010
several different from different file
formats and that's good hopefully you

110
00:10:09,010 --> 00:10:16,760
guys do find so we had only five and we
downloaded everything that had greater

111
00:10:16,760 --> 00:10:22,550
than 10% maliciousness score from
vitals.com is a popular website that has

112
00:10:22,550 --> 00:10:27,620
a huge database of militias and
suspicious files so now we had to do to

113
00:10:27,620 --> 00:10:33,260
be related to busty beauty campaign
through testing methods on and since we

114
00:10:33,260 --> 00:10:38,290
know which research paper each binary
had come from we knew which actor that

115
00:10:38,290 --> 00:10:41,900
was connected with my family which
campaign etcetera

116
00:10:41,900 --> 00:10:46,439
so what we did we had these minorities
we calculated the tree similarity hashes

117
00:10:46,440 --> 00:10:52,110
and then we use some Python to connect
to make all possible connections it

118
00:10:52,110 --> 00:10:55,350
might hurt cluster in the binary
differently and the next step was to

119
00:10:55,350 --> 00:11:02,339
judge which connections were true and
which connections before we do that

120
00:11:02,339 --> 00:11:07,329
here's what we did each hash with
extracted from one or more white papers

121
00:11:07,329 --> 00:11:13,219
and eat white paper talks about a mile a
malicious actor Mel at Hamleys campaign

122
00:11:13,220 --> 00:11:14,749
etcetera

123
00:11:14,749 --> 00:11:18,660
so we manually analyze this data from
white papers and created a dictionary

124
00:11:18,660 --> 00:11:24,389
out of them if the correlation binary of
shared an actor campaign or malware

125
00:11:24,389 --> 00:11:29,009
family the correlation was judged as
true for instance if we know that to my

126
00:11:29,009 --> 00:11:33,930
knees were used for use by the film
actor at some point then we can say that

127
00:11:33,930 --> 00:11:42,258
they're connected and the coalition was
judged to be a true positive this graph

128
00:11:42,259 --> 00:11:47,860
plots the recall and precision of the
connections are made by each method of

129
00:11:47,860 --> 00:11:51,839
the percentage of true positives that
was found by each met code and we can

130
00:11:51,839 --> 00:11:56,610
see its new house which is the blue
column that had the highest recoil at

131
00:11:56,610 --> 00:12:01,779
ninety percent and impact which is the
red column had the lowest recoil at 25%

132
00:12:01,779 --> 00:12:06,350
precision which is which is the
autograph that is the percentage of

133
00:12:06,350 --> 00:12:10,519
correlations of true positives vs false
positive if his team had perfect

134
00:12:10,519 --> 00:12:14,899
precision a hundred percent and St has
had near perfect precision with only

135
00:12:14,899 --> 00:12:23,589
three false positives let us look at the
results from each individual method but

136
00:12:23,589 --> 00:12:28,870
I'll show you what we got from in
patches this is the score distribution

137
00:12:28,870 --> 00:12:33,620
of the impassioned heard since import
hashes use equality of you can see only

138
00:12:33,620 --> 00:12:39,129
one score bar 800 we can see they regard
about 580 correlations from this

139
00:12:39,129 --> 00:12:46,069
mattered and only four hundred and eight
were true the 2012 high fidelity by

140
00:12:46,069 --> 00:12:49,670
which I mean that the bindings that had
the same impact work very closely

141
00:12:49,670 --> 00:12:54,319
connected they were the female version
of the similar just different samples

142
00:12:54,319 --> 00:12:58,839
some of the other things we looked at
was whether this method could connect

143
00:12:58,839 --> 00:13:01,100
mine it is used in the same campaign

144
00:13:01,100 --> 00:13:05,040
used by the female actor in different
campaigns the impasse had two

145
00:13:05,040 --> 00:13:10,530
correlations of this time we also asked
if this method can connect binaries that

146
00:13:10,530 --> 00:13:16,260
are different versions of the same lol
compassionate goodnight and we aren't

147
00:13:16,260 --> 00:13:20,380
inclined any connections whereby nearly
that good news by the same actor in

148
00:13:20,380 --> 00:13:25,630
different parts of the kill chain what
connected by this method so some of the

149
00:13:25,630 --> 00:13:29,490
criteria we had been evacuations and
you'll see that the other matters did a

150
00:13:29,490 --> 00:13:36,320
little bit better than the impassioned
echoed these clusters made by this

151
00:13:36,320 --> 00:13:36,890
method

152
00:13:36,890 --> 00:13:42,530
this is a force directed graph made
using a software co going to be treated

153
00:13:42,530 --> 00:13:47,750
Jess each point is a single malware
finally and they are color coded by the

154
00:13:47,750 --> 00:13:52,010
research paper from which they were
extracted this leptin let us get a

155
00:13:52,010 --> 00:13:56,790
visual image of the connections made by
amp ashes we can see here that the

156
00:13:56,790 --> 00:14:01,750
connections are pretty sparse six
clusters with more than seven wineries

157
00:14:01,750 --> 00:14:05,980
and there were several false positives
those are the the clusters with red legs

158
00:14:05,980 --> 00:14:14,590
let me show you these clusters in detail
on the left in blue we have four samples

159
00:14:14,590 --> 00:14:19,180
of Comrade this was a remote
administration tool that was used by the

160
00:14:19,180 --> 00:14:24,150
Tory attack group in cyber espionage
campaign against the government entities

161
00:14:24,150 --> 00:14:29,300
in Europe Middle East and the us-
research has shown that the smell it has

162
00:14:29,300 --> 00:14:34,650
been used since 2008 in different forms
it was first known as agent not be easy

163
00:14:34,650 --> 00:14:39,770
and comrade and now it has this same
code base has evolved into a street kid

164
00:14:39,770 --> 00:14:46,270
the family discussed in this specific
last overall version 1.5 of Comrade and

165
00:14:46,270 --> 00:14:50,720
they were all compiled on the 25th of
March 2008 and all the fort Campbell's

166
00:14:50,720 --> 00:14:53,750
of this particular malware that would
indicate effects were in this cluster

167
00:14:53,750 --> 00:14:58,400
and under different versions of Comrade
that will preserve president the data

168
00:14:58,400 --> 00:15:03,329
said and the phone different clusters
using the compassionate own so while

169
00:15:03,330 --> 00:15:07,360
this method can connect minor these data
from the same version it can connect

170
00:15:07,360 --> 00:15:08,600
across the oceans

171
00:15:08,600 --> 00:15:12,120
and this is a limitation in the incident
response process so if I get a new

172
00:15:12,120 --> 00:15:15,170
mining and I want to see if this is a
new version of the malware that I'm

173
00:15:15,170 --> 00:15:21,229
already feeling that this method won't
be able to help me right we see the

174
00:15:21,230 --> 00:15:27,019
large red cluster which is a group of
samples of my work out we plot the

175
00:15:27,019 --> 00:15:32,800
sample had the timestamp of $50 2013 and
this was used as a first day to drop by

176
00:15:32,800 --> 00:15:43,649
the Walkabout that group would also
linked together by the impressions

177
00:15:43,649 --> 00:15:49,499
we have two cases where import hashes
matched by nearly across campaign the

178
00:15:49,499 --> 00:15:53,939
founder of the left are both comrade one
of them was used by the water pump group

179
00:15:53,939 --> 00:15:58,939
and the other one is from the toilet
campaign on the right we have samples of

180
00:15:58,939 --> 00:16:02,829
the Commonwealth which is an
intermediate droplet one of the samples

181
00:16:02,829 --> 00:16:15,329
with a used in the project Cobra and the
other one is from the carbon analysis of

182
00:16:15,329 --> 00:16:19,219
false positives that were found by the
impassioned heard all of the one hundred

183
00:16:19,220 --> 00:16:24,119
and seventy-two false-positive these two
clusters in the damp stopped last only

184
00:16:24,119 --> 00:16:27,990
have nine it is from six different
campaigns including operation desert

185
00:16:27,990 --> 00:16:33,170
Falcon the inception apt framework and
attacks on the Tibetan activist and a

186
00:16:33,170 --> 00:16:40,319
few others between all of these campaign
there is no commonly nor Attribution no

187
00:16:40,319 --> 00:16:44,309
common malware family used and the
samples were from different parts of the

188
00:16:44,309 --> 00:16:48,370
kitchen as well so somehow they all
shared think import hash which is a

189
00:16:48,370 --> 00:16:52,300
false positive in the lower class till
we can see samples from two different

190
00:16:52,300 --> 00:16:57,059
actors one-third of minorities was used
as a credential steal it and dropped by

191
00:16:57,059 --> 00:17:02,160
operation added Viper and on attack from
the israeli government and then import

192
00:17:02,160 --> 00:17:07,319
ashes that connected to an attack on the
Syrian government one possible reason

193
00:17:07,319 --> 00:17:12,500
for these false positives can be Packers
Packers are programs that are used by a

194
00:17:12,500 --> 00:17:17,809
malicious actors to evade antivirus
detection that the signature based in

195
00:17:17,809 --> 00:17:22,918
freeport hash method looks only at the
import able it is possible that it can

196
00:17:22,919 --> 00:17:28,559
be misled by applications using the same
factor we will notice that other methods

197
00:17:28,559 --> 00:17:38,720
don't have the struck back we got from
steep this is the score distribution we

198
00:17:38,720 --> 00:17:42,850
can see that we got 856 good relations
which is almost twice as much as what we

199
00:17:42,850 --> 00:17:47,250
got from impact and there were no
false-positive so that's pretty good we

200
00:17:47,250 --> 00:17:50,730
found one correlation connecting
binaries used by the same actor in

201
00:17:50,730 --> 00:17:54,720
different campaigns and there were
several instances of correlation

202
00:17:54,720 --> 00:18:00,880
between minor versions of the same hour
and there were no good relations where

203
00:18:00,880 --> 00:18:06,450
this method could connect minorities
used across parts of the calgene so we

204
00:18:06,450 --> 00:18:09,919
see that it is deep short a definite
improvement over the impassioned at home

205
00:18:09,919 --> 00:18:15,159
but it has some downside from the
perspective of wanting to create a

206
00:18:15,159 --> 00:18:19,960
database of previously analyzed apt
minor Eve and compelling new ones with

207
00:18:19,960 --> 00:18:23,929
this method the impression that is
relatively easy because you only need to

208
00:18:23,929 --> 00:18:29,330
compare our search for the MB five
string of the impact to a database on

209
00:18:29,330 --> 00:18:33,870
the other hand with SSD you have to run
the distance function between every two

210
00:18:33,870 --> 00:18:38,699
pairs of files to determine whether you
have seen this file or something similar

211
00:18:38,700 --> 00:18:45,210
in the past and this can have a
computational overhead so this might not

212
00:18:45,210 --> 00:18:48,620
be a problem for different organizations
depending on your infrastructure but

213
00:18:48,620 --> 00:18:54,610
this is a drawback of this method for
the graph the overall connections made

214
00:18:54,610 --> 00:18:59,729
by the compassionate heard we can see
several large clusters let me show you

215
00:18:59,730 --> 00:19:05,090
some in detail I wanna point in the
large cluster and the bottom that's in

216
00:19:05,090 --> 00:19:09,870
blue that consists of samples of Comrade
which we had mentioned earlier was used

217
00:19:09,870 --> 00:19:14,830
by the toilet actors with the
impassioned heard we saw small clusters

218
00:19:14,830 --> 00:19:17,960
of the smell with each cluster
containing only the same version of

219
00:19:17,960 --> 00:19:23,700
technology we have a giant cluster of
different across different versions here

220
00:19:23,700 --> 00:19:26,659
we have sixteen different varieties of
different versions of the comrade

221
00:19:26,659 --> 00:19:28,640
compiled over a period of three years

222
00:19:28,640 --> 00:19:32,280
connected together by the food court
similarity

223
00:19:32,280 --> 00:19:37,559
incident responded looking for
information about an unknown binding if

224
00:19:37,559 --> 00:19:42,059
steve is more likely to be able to tell
you which malware or which passed sample

225
00:19:42,059 --> 00:19:47,290
is your new sample connected to

226
00:19:47,290 --> 00:19:55,090
somewhat correlations made by the St
Medford as you can see the cluster that

227
00:19:55,090 --> 00:19:57,959
significantly bigger which means that
your chances of being able to get

228
00:19:57,960 --> 00:20:02,940
information about a new binary I hired
the clusters and green are sampled of a

229
00:20:02,940 --> 00:20:06,480
back door that was used in operation
desert Falcon that was researched by

230
00:20:06,480 --> 00:20:11,800
Kaspersky there were 680 correlations
related to this matter that was found in

231
00:20:11,800 --> 00:20:17,840
our dataset and the average score was
25.13 and at the bottom we have three

232
00:20:17,840 --> 00:20:21,919
minor is connected together these were
different versions of the carbonyl our

233
00:20:21,920 --> 00:20:27,620
that were used in project Cobra and the
watermark campaign this was an example

234
00:20:27,620 --> 00:20:32,030
of SSDs being able to make connections
between minorities used by the famous

235
00:20:32,030 --> 00:20:40,240
actor in different campaigns and
mentioned there were no false positives

236
00:20:40,240 --> 00:20:44,870
that were found by a steep

237
00:20:44,870 --> 00:20:51,419
bahash that the final method this is the
score distribution for St hash this is

238
00:20:51,420 --> 00:20:56,360
the method that give maximum
correlations about 1,400 and had only

239
00:20:56,360 --> 00:20:58,459
three false-positive

240
00:20:58,460 --> 00:21:02,470
basically we found that threshold at 10
so all the connections with a score of

241
00:21:02,470 --> 00:21:07,300
less than 10 were disregarded this
method found connections between binary

242
00:21:07,300 --> 00:21:11,340
is used in different campaigns by the
same actor it was able to find

243
00:21:11,340 --> 00:21:16,220
connections between different versions
of the same away and it was able to

244
00:21:16,220 --> 00:21:22,290
connect my money is used in different
parts of the kill chain on the flip side

245
00:21:22,290 --> 00:21:28,409
it has the same drawback as a fifty if
we want to create a database of known by

246
00:21:28,410 --> 00:21:33,360
now leads and compared a new one against
that we have to calculate the distance

247
00:21:33,360 --> 00:21:39,469
between every pedophiles additionally if
this team generate the hash which is no

248
00:21:39,470 --> 00:21:43,190
longer than in defining how she just
loved limited-length

249
00:21:43,190 --> 00:21:47,800
St hash generate some stores doom
figures which are significantly longer

250
00:21:47,800 --> 00:21:52,629
their length is typically about two to
three percent of the input file that can

251
00:21:52,630 --> 00:21:56,280
again be a drawback depending on the
infrastructure that's the organizer

252
00:21:56,280 --> 00:22:02,389
haitian season two clusters that were
found you think if the ash we can feel

253
00:22:02,390 --> 00:22:09,460
bad that we don't sit and have a little
connections leaving the customers that I

254
00:22:09,460 --> 00:22:15,020
found most interesting that was created
using esli eshe the larger red cluster

255
00:22:15,020 --> 00:22:19,639
contains of twenty different samples of
Baroda through cared for by the span of

256
00:22:19,640 --> 00:22:25,580
three months in 2013 and the second
cluster on the right that's really nice

257
00:22:25,580 --> 00:22:32,399
the samples info booth at the drop of
the stage 1 stage do and the injected

258
00:22:32,400 --> 00:22:38,310
library of the Cobra system described to
be used by the toilet actors and the

259
00:22:38,310 --> 00:22:42,020
sample the red and those used by the
carbon tool used by the Whataburger

260
00:22:42,020 --> 00:22:47,620
attackers there have been some research
that suggests that Cobra and Carmen are

261
00:22:47,620 --> 00:22:52,370
actually just one of our framework with
various plugins that can be used to

262
00:22:52,370 --> 00:22:55,719
generate by Moody's for different parts
of the killing four different parts of

263
00:22:55,720 --> 00:23:00,150
the attack and the Etihad method with
able to identify enough for two

264
00:23:00,150 --> 00:23:04,340
melodically between those finally that
have different functions to link them to

265
00:23:04,340 --> 00:23:09,030
each other so in the incident response
process that can be a very useful to

266
00:23:09,030 --> 00:23:16,800
have and this was done by the only
people in the investigation to build a

267
00:23:16,800 --> 00:23:22,440
better time line of an incident

268
00:23:22,440 --> 00:23:27,950
leaving the false positives that were
found in the SSE has never heard one

269
00:23:27,950 --> 00:23:32,929
comment back those used in operation
desert Falcon to the scan box tool that

270
00:23:32,929 --> 00:23:37,230
was used in the anthem attacks and the
other one is another binder from the

271
00:23:37,230 --> 00:23:41,679
anthem attack that got into the car been
a key bTW there is no known link between

272
00:23:41,679 --> 00:23:50,750
these two minor leaguers for this is
just a false positive so we looked at

273
00:23:50,750 --> 00:23:57,830
the results of the evaluation and the
clusters generated from each method for

274
00:23:57,830 --> 00:24:02,720
what do their conclusion I started this
discussion with high-level strategic

275
00:24:02,720 --> 00:24:08,899
question about why we want to connect
minorities detractors and then we did a

276
00:24:08,899 --> 00:24:14,830
deep dive into the technical methods now
let me come back up again the goal of

277
00:24:14,830 --> 00:24:20,399
this research was not merely to find
which method is best for connecting

278
00:24:20,399 --> 00:24:23,879
wineries what we really want to do it

279
00:24:23,879 --> 00:24:29,240
engineer systems and algorithms to do
this for us we want to be able to

280
00:24:29,240 --> 00:24:34,019
visualize the actions of an adversary
and thereby simplify the process of

281
00:24:34,019 --> 00:24:39,690
investigations and incident response the
stock is really about automation we want

282
00:24:39,690 --> 00:24:44,909
to create a lookup table for the two
that bad guys use a big push is to set

283
00:24:44,909 --> 00:24:54,429
up such systems group constantly realize
they're told they create new versions of

284
00:24:54,429 --> 00:24:57,379
the malware that have used in the past

285
00:24:57,379 --> 00:25:02,629
in fact there was an excellent people by
fire I talked about how eleven different

286
00:25:02,629 --> 00:25:07,809
targeted campaigns had used towards
creating my by one thing the group of

287
00:25:07,809 --> 00:25:13,820
torment so-called can be automatically
can be an excellent way to connect those

288
00:25:13,820 --> 00:25:21,230
two attackers and lastly it is important
to know your adversary if you know that

289
00:25:21,230 --> 00:25:25,889
you know where to focus our intelligence
effort you can monitor for all data

290
00:25:25,889 --> 00:25:30,008
about their tools and tactics you can
learn about the types of vulnerability

291
00:25:30,009 --> 00:25:34,129
of the go after and that can help you
make strategic investments about the

292
00:25:34,129 --> 00:25:35,090
defense of it open

293
00:25:35,090 --> 00:25:44,919
elation and not just to chase the next
infection that is all I have for you I

294
00:25:44,920 --> 00:25:48,390
would like to thank my colleagues Jeff
and Chris for guiding me in making this

295
00:25:48,390 --> 00:25:53,120
presentation and I would like to thank
all security officials who do apt

296
00:25:53,120 --> 00:25:58,040
related research particularly kidding
bundle of networks with the maintainer

297
00:25:58,040 --> 00:26:03,280
for apt notes and lastly I would like to
thank my love story that have made their

298
00:26:03,280 --> 00:26:08,399
data available free of charge to
security features my email address and

299
00:26:08,400 --> 00:26:11,940
Twitter handle it up there if you want
to share ideas comments thoughts in the

300
00:26:11,940 --> 00:26:23,299
future and that I open up your questions

301
00:26:23,299 --> 00:26:34,779
mundhanai you need to do is to invest
that are targeted at kmart.com I gotta

302
00:26:34,779 --> 00:26:50,419
say I gotta get this study must I do to
question the first you mention and you

303
00:26:50,419 --> 00:26:56,369
use a cheeky man where you were like I
want to know if this matter can be

304
00:26:56,369 --> 00:27:05,049
applied to other ways as well and the
second question is I think three message

305
00:27:05,049 --> 00:27:13,070
you mentioned in this stock only applied
to state that they are static ways to

306
00:27:13,070 --> 00:27:21,259
correlate anywhere but we know that they
are some where who retain show code

307
00:27:21,259 --> 00:27:27,919
which can be abused skated easy so
regarding this kind of malware do you

308
00:27:27,919 --> 00:27:36,970
have other method to Coronation the
first one first

309
00:27:36,970 --> 00:27:42,259
you asked if this these matters will
also be similarly applicable to non

310
00:27:42,259 --> 00:27:48,080
educated binaries and while I have not
done the data analysis behind that my

311
00:27:48,080 --> 00:27:50,480
estimate would be that would be true

312
00:27:50,480 --> 00:27:56,239
research done by shadows over which did
say which which limited the SST method

313
00:27:56,239 --> 00:28:00,830
specifically and it's that bad if to
remind me of highschool internet

314
00:28:00,830 --> 00:28:05,168
esteemed then they are likely from the
same ballot so yeah some of these

315
00:28:05,169 --> 00:28:10,090
methods might help coordinate based on
mallet family for different first crime

316
00:28:10,090 --> 00:28:17,570
readily to mind you and your second
question was if there is a show called

317
00:28:17,570 --> 00:28:23,309
or some other well something that we
cannot statically analyzed do you've met

318
00:28:23,309 --> 00:28:26,809
her they look into bite pattern of

319
00:28:26,809 --> 00:28:31,168
the file that is covered in in the case
of an investigation on an incident that

320
00:28:31,169 --> 00:28:38,629
is life so if we can if you paying that
those types of connectors have a bite

321
00:28:38,629 --> 00:28:43,998
pattern which in judging the familiarity
of which will be helped with Danielle we

322
00:28:43,999 --> 00:28:54,720
can use these methods but that also in a
limited sense but for the second time I

323
00:28:54,720 --> 00:29:00,460
mean those this show called me know
where they are they can they can be

324
00:29:00,460 --> 00:29:09,789
easily upgraded the same poem called in
for example just acts or or something

325
00:29:09,789 --> 00:29:24,940
like that though I don't think this will
weigh on this matter is always so the

326
00:29:24,940 --> 00:29:29,330
opposition party is valid for all
different types of minorities if a

327
00:29:29,330 --> 00:29:33,340
particular credit a codified stay with a
new method of application something

328
00:29:33,340 --> 00:29:37,168
custom perhaps or encryption then none
of these methods will work in that case

329
00:29:37,169 --> 00:29:43,039
and that holds for smaller files as well
anytime any other type button because

330
00:29:43,039 --> 00:29:46,499
their fight back and we'll get up get
down and then these methods in that case

331
00:29:46,499 --> 00:30:05,410
thank you gotta see myself everyday this
month

332
00:30:05,410 --> 00:30:32,260
get there so that she could you call you
wouldn't be that if you do not want your

333
00:30:32,260 --> 00:31:22,190
ID

334
00:31:22,190 --> 00:31:38,730
you're trying to differentiate between
militias have been much higher than what

335
00:31:38,730 --> 00:31:49,759
we found with it because here we have
more than 10 percent so if you want to

336
00:31:49,759 --> 00:31:54,049
apply this method heard in India life
one would have to have some checkpoint

337
00:31:54,049 --> 00:31:58,289
or some heuristic the judge that the
file is militias and then these methods

338
00:31:58,289 --> 00:32:04,259
can be used to cluster either by malware
family or by AP writer dr. simply to use

339
00:32:04,259 --> 00:32:10,879
this method for judging malicious files
versus good Windows files would result

340
00:32:10,879 --> 00:32:19,159
in high false-positive did I answer your
question

341
00:32:19,160 --> 00:32:58,750
through the vast majority of the door of
the difference between if we could be if

342
00:32:58,750 --> 00:33:03,150
we can do that then this would start
acting like another antivirus product

343
00:33:03,150 --> 00:33:19,370
and that's not what we're trying to do
here with a look at the same as you are

344
00:33:19,370 --> 00:33:24,580
talking about anyone else do you want to
convert a pretty but I was not it didn't

345
00:33:24,580 --> 00:33:39,179
give a damn I must say nothing

346
00:33:39,180 --> 00:33:45,040
thank you for your issue thank you for
sharing I just happened

347
00:33:45,040 --> 00:33:51,379
simple question if I were an attacker
and I would like to reuse Michael the to

348
00:33:51,380 --> 00:33:56,140
any suggestions about how to record this
season

349
00:33:56,140 --> 00:34:06,950
thank you a lot of this research is
based on the fact that apt trade actors

350
00:34:06,950 --> 00:34:11,990
that often companies and their dead leg
enterprises and because they don't want

351
00:34:11,989 --> 00:34:16,779
to reinvest the time that they have
spent in building one piece of code and

352
00:34:16,780 --> 00:34:20,410
that is why the continued modifying it
and creating different versions because

353
00:34:20,409 --> 00:34:25,060
that that's a hard job to create good
rootkits and that is what we're playing

354
00:34:25,060 --> 00:34:30,929
on if put instance one apt group had a
lot of resources and they decided to

355
00:34:30,929 --> 00:34:36,239
scrap their old code base and start a
new the bike pattern similarity with

356
00:34:36,239 --> 00:34:41,250
keys to exist and these methods would
fail these methods are not doing a

357
00:34:41,250 --> 00:34:46,469
dynamic analysis of the functions or the
actions taken by the binary on hosts on

358
00:34:46,469 --> 00:34:51,069
the network they are literally analyzing
the bike back on and those rely on the

359
00:34:51,070 --> 00:34:54,690
same code base being used again and
again though if you if you were an

360
00:34:54,690 --> 00:34:58,650
attack on you wanted to work around this
you just have to you would have to

361
00:34:58,650 --> 00:35:03,430
create your audio drop it from scratch

362
00:35:03,430 --> 00:35:21,660
okay thank you I set up here I was
really scared

