1
00:00:02,750 --> 00:00:12,410
thank you very much for the introduction
i'm talking about the insecurity of

2
00:00:12,410 --> 00:00:16,759
medical devices or the security in the
most critical infrastructure as you have

3
00:00:16,759 --> 00:00:23,930
seen I have set up two of my friends
that I was bringing with me to research

4
00:00:23,930 --> 00:00:29,849
projects these are two patient monitors
right there and I'm going to show a few

5
00:00:29,849 --> 00:00:36,059
demos on these two patient monitors life
I will show you some more demos by video

6
00:00:36,059 --> 00:00:42,000
because obviously some of the medical
devices that we have tested it's not

7
00:00:42,000 --> 00:00:45,620
possible to kind of bring them to an
airplane or something so if you imagine

8
00:00:45,620 --> 00:00:50,640
an x-ray machine for example that's
pretty hard to transport rights and

9
00:00:50,640 --> 00:00:55,899
operates so we're not talking about
these ones but I brought a couple of

10
00:00:55,899 --> 00:01:01,350
videos so far so I'm actually I'm pretty
happy to speak at goldblum because when

11
00:01:01,350 --> 00:01:07,140
you're looking at Madison you will have
this term Code Blue is used in the you s

12
00:01:07,140 --> 00:01:11,040
preliminary and they are using and
foreign really really critical the event

13
00:01:11,040 --> 00:01:15,600
so this is kind of cool because it when
you're looking at matts in and you're

14
00:01:15,600 --> 00:01:20,009
looking at the code blue that normally
means that there is a patient who is

15
00:01:20,009 --> 00:01:25,900
really suffering and who might need help
so he might require resuscitation or

16
00:01:25,900 --> 00:01:30,090
whatever so this is a

17
00:01:30,090 --> 00:01:35,500
I think for the conference and for this
topic this topic is one that I really

18
00:01:35,500 --> 00:01:40,399
care about because I think that medical
device vendors need to put security on

19
00:01:40,399 --> 00:01:46,689
the agenda this is why i'm talking about
this topic right now here in Japan I

20
00:01:46,689 --> 00:01:54,229
actually have no real clue what security
of medical devices in japan is about I

21
00:01:54,229 --> 00:01:57,619
hope that some of you guys will approach
me afterwards and we can talk a little

22
00:01:57,619 --> 00:02:01,560
bit about this topic because I think
that is really important and I think

23
00:02:01,560 --> 00:02:05,959
that worldwide all of the vendors have
problems implementing security in the

24
00:02:05,959 --> 00:02:12,049
devices as I'm going to show you so i'm
following one or just approached me if

25
00:02:12,049 --> 00:02:16,629
you have anything during the conference
I leave here for the conference I'm from

26
00:02:16,629 --> 00:02:21,290
germany from the beautiful city of
Heidelberg and I'm working at your own W

27
00:02:21,290 --> 00:02:26,370
which is the company this is the agenda
I'm going to talk about the motivation

28
00:02:26,370 --> 00:02:30,500
why I'm doing this stuff it's a research
project I'm researching medical devices

29
00:02:30,500 --> 00:02:35,639
so it's not my day business for medical
devices I do penetration testing medical

30
00:02:35,639 --> 00:02:42,359
devices is my research and I will go
over some of the publications that have

31
00:02:42,359 --> 00:02:46,780
been done so far from other people in
the field of medical devices I would

32
00:02:46,780 --> 00:02:53,329
state the problem why our vendors going
this way why either not implementing

33
00:02:53,329 --> 00:02:58,049
security and why is this a problem in
combination with how all hospitals

34
00:02:58,049 --> 00:03:04,549
operate I will show you or give you a
clue if you want to get your hands on

35
00:03:04,549 --> 00:03:09,470
these devices to test them for
yourselves on how to get

36
00:03:09,470 --> 00:03:13,130
these devices because they're difficult
to get obviously x-ray machines cannot

37
00:03:13,130 --> 00:03:18,440
be bought like just like that and so you
need some kind of trick to get your

38
00:03:18,440 --> 00:03:22,270
hands on their devices I will then
present the findings that we have so far

39
00:03:22,270 --> 00:03:26,050
including the two devices in front and
then we will have hopefully have time

40
00:03:26,050 --> 00:03:31,420
for questions afterwards ok so if you
see any product names I've stripped them

41
00:03:31,420 --> 00:03:36,970
out I guess or company names of
Brennan's or whatever that's the

42
00:03:36,970 --> 00:03:41,820
disclaimer I asked to do why am I doing
this is like the first part although the

43
00:03:41,820 --> 00:03:45,579
really important part in this
presentation we have your own W have

44
00:03:45,580 --> 00:03:50,320
this kind of model which is make the
world a safer place and I could not

45
00:03:50,320 --> 00:03:57,959
imagine a topic more relevant to safety
and security than medical devices so the

46
00:03:57,959 --> 00:04:03,010
importance of this research is that we
trust these devices if you're going to a

47
00:04:03,010 --> 00:04:08,230
hospital if you're in a hospital bad and
you're really really sick and you're not

48
00:04:08,230 --> 00:04:12,100
starting to think about if you can
question this device you trust the data

49
00:04:12,100 --> 00:04:15,950
letters on the device and the doctor is
trusting the data that is on the device

50
00:04:15,950 --> 00:04:21,430
so this is the first part we are not
going to crest question this because if

51
00:04:21,430 --> 00:04:26,180
we in a critical condition we kind of
need to rely on these devices and the

52
00:04:26,180 --> 00:04:31,290
doctors to do this too so concerning the
technology part this is a really awesome

53
00:04:31,290 --> 00:04:36,020
stuff if you look at the devices none of
them are in the same way every Windows

54
00:04:36,020 --> 00:04:41,630
implementing proprietary protocols they
are having like machines like MRIs or

55
00:04:41,630 --> 00:04:45,560
something which is real rocket science
for me and I really really enjoy just

56
00:04:45,560 --> 00:04:51,200
looking into these technologies to play
around with these technologies so this

57
00:04:51,200 --> 00:04:58,120
for the motivation why am I doing this
publication so far so there is pretty

58
00:04:58,120 --> 00:05:02,550
important publication from the FDA from
the food and drug administration in the

59
00:05:02,550 --> 00:05:09,780
us- they have put out a recommendation
for all medical device vendors in 2013

60
00:05:09,780 --> 00:05:17,299
2013 it took like 2013 for the FDA to
come up or they have to come up with a

61
00:05:17,300 --> 00:05:21,360
recommendation to tell the device
vendors to look

62
00:05:21,360 --> 00:05:27,900
into cyber attacks and to kind of loop
or or have a focus on on cyber attacks

63
00:05:27,900 --> 00:05:33,429
and put safeguards into the machine so
you can imagine up to 2013 none of the

64
00:05:33,430 --> 00:05:40,949
vendors really kind of had the
impression on what could happen in

65
00:05:40,949 --> 00:05:49,659
concerning cybersecurity ok so the next
one you might probably know is a

66
00:05:49,659 --> 00:05:53,900
publication from Barnaby Jack who passed
away a few years ago he has done

67
00:05:53,900 --> 00:05:59,710
intensive research on medical devices
for example cardiac defibrillators

68
00:05:59,710 --> 00:06:06,029
implantable cardiac defibrillators or
medtronic palms which is an insulin pump

69
00:06:06,029 --> 00:06:13,580
that could be hacked and he was able to
kind of adjust the dose from the outside

70
00:06:13,580 --> 00:06:19,550
then we have publication or an alert
which is quite interesting too because

71
00:06:19,550 --> 00:06:23,370
this sums are pretty much where we are
with security in the medical device

72
00:06:23,370 --> 00:06:32,560
field researchers have looked at a 300
medical devices and they found from from

73
00:06:32,560 --> 00:06:38,080
like forty year $41 and they are found
hardcoded passwords and all of them so

74
00:06:38,080 --> 00:06:41,628
this is pretty much where we r which
this is the status of medical device

75
00:06:41,629 --> 00:06:46,909
security right now so we're not talking
about I T security rocket science we're

76
00:06:46,909 --> 00:06:52,650
not talking about that there are like
exploits that only 10 people in the

77
00:06:52,650 --> 00:06:57,169
world can exploit we're talking about
stuff like hardcoded passwords

78
00:06:57,169 --> 00:07:01,789
or no passwords at all in these devices
that are starting to talk over the

79
00:07:01,789 --> 00:07:07,279
network we have more research concerning
pacemakers or implantable cardiac

80
00:07:07,279 --> 00:07:14,939
defibrillators and we have another
another warning to say so from the FDA

81
00:07:14,939 --> 00:07:19,580
or publication from the FDA and in 2014

82
00:07:19,580 --> 00:07:23,800
they were telling us that they are now
working with the Department of Homeland

83
00:07:23,800 --> 00:07:28,569
Security to kind of get into the problem
of vulnerabilities investigating

84
00:07:28,569 --> 00:07:34,999
vulnerabilities in medical devices to
kind of prevent these attacks from

85
00:07:34,999 --> 00:07:36,169
happening in the future

86
00:07:36,169 --> 00:07:42,150
ok so let's go into the problem
statement a little bit so where is the

87
00:07:42,150 --> 00:07:47,748
problem so if you look at the old days
you will have devices like these

88
00:07:47,749 --> 00:07:52,069
this is the Messiah customers one and
it's basically an oscilloscope so there

89
00:07:52,069 --> 00:07:52,999
is like this

90
00:07:52,999 --> 00:07:59,710
stopped on the screen going up and down
and it's basically showing data from the

91
00:07:59,710 --> 00:08:04,930
patient it has a needle that is working
and it's like going up and down like on

92
00:08:04,930 --> 00:08:10,149
the collar and its I think it's built in
1975 and 1979 or something that is quite

93
00:08:10,149 --> 00:08:16,189
old but this is the technology medical
device vendors are coming from so this

94
00:08:16,189 --> 00:08:19,399
is where they started from if you look
at the back of the device you can see

95
00:08:19,399 --> 00:08:23,719
like there is nothing much there a
parallel port maybe to a just a printer

96
00:08:23,719 --> 00:08:31,289
or something maybe do some debugging but
there is no communication whatsoever so

97
00:08:31,289 --> 00:08:34,899
this is another example it's a new
encoding nor effects eg

98
00:08:34,899 --> 00:08:40,659
and it is used to measure your brain
waves so there is basically a needle

99
00:08:40,659 --> 00:08:47,250
that is using ink to write on a paper so
this is like far away from digital of

100
00:08:47,250 --> 00:08:51,060
far away from anything that you can
imagine what what these devices to

101
00:08:51,060 --> 00:08:55,099
nowadays and if you look at this this
device right here this device has been

102
00:08:55,100 --> 00:09:01,709
used like I think five or six years ago
in hospitals so this is what a German

103
00:09:01,709 --> 00:09:06,268
hospitals sometimes have as equipment
they are using it until it basically

104
00:09:06,269 --> 00:09:09,440
falls apart and then they're going to
buy new stuff

105
00:09:09,440 --> 00:09:17,060
and the new stuff kind of always
implements this new technology that is

106
00:09:17,060 --> 00:09:24,290
known as the internet so coming from the
world of how do we do signal processing

107
00:09:24,290 --> 00:09:28,260
how do we do hardware how do we do other
stuff we are now at the point where

108
00:09:28,260 --> 00:09:31,960
medical device vendors kind of
discovered the internet so we have a

109
00:09:31,960 --> 00:09:35,900
change right here they are doing this
because they want to optimize staff they

110
00:09:35,900 --> 00:09:41,140
want to kind of optimized processes they
want to lower costs so for example if

111
00:09:41,140 --> 00:09:46,050
you're going to buy and anesthesia
device some of these anesthesia devices

112
00:09:46,050 --> 00:09:53,109
have mandatory access to VPN so
basically you hook up your device to the

113
00:09:53,110 --> 00:09:57,640
network will open up a VPN connection
and communicated to the vendor so the

114
00:09:57,640 --> 00:10:01,319
vendor can look into the device and see
what's happening there there is a

115
00:10:01,320 --> 00:10:02,740
problem or something like that

116
00:10:02,740 --> 00:10:08,860
so this is a special especially critical
for intensive care units sold the

117
00:10:08,860 --> 00:10:13,340
patient monitors that you see right here
and they get hooked up to a patient than

118
00:10:13,340 --> 00:10:16,950
you normally have a software with it and
this software kind of gave us the data

119
00:10:16,950 --> 00:10:21,070
over the network and then displace all
of the data all of the like 12 patient

120
00:10:21,070 --> 00:10:25,310
monitors at work or how many you have on
the screen so there's only one person

121
00:10:25,310 --> 00:10:31,030
needed to kind of monitor twelve of
these things which kind of makes

122
00:10:31,030 --> 00:10:36,699
processors a little bit more optimal for
the hospital we in addition have stuff

123
00:10:36,700 --> 00:10:39,890
like interoperability these devices need
to talk to each other

124
00:10:39,890 --> 00:10:43,290
an MRI must push the daytime to a file
server

125
00:10:43,290 --> 00:10:48,689
additional software must be able to read
this the state and interpret this data

126
00:10:48,690 --> 00:10:54,519
so we are now talking not only about the
devices isolated devices itself but

127
00:10:54,519 --> 00:10:59,500
they're starting to communicate over the
network so this is a standard anesthesia

128
00:10:59,500 --> 00:11:06,279
device right here so you see you kind of
talent which is the lower part right

129
00:11:06,279 --> 00:11:09,920
here and on the upper part you have a
patient monitor which is the typical set

130
00:11:09,920 --> 00:11:13,790
up one of the patient mitoses is this
one right here for the for the right

131
00:11:13,790 --> 00:11:18,300
hand side right here so this is the
number setup artist procedure these

132
00:11:18,300 --> 00:11:22,508
devices are basically in in in standby
so behind these walls there's an

133
00:11:22,509 --> 00:11:26,199
operation room and if something fails if
something goes wrong then you kind of

134
00:11:26,199 --> 00:11:30,639
need to pull out the one device go to
the other devices push back the device

135
00:11:30,639 --> 00:11:35,649
into the operation room attached all the
cables to the patient the device

136
00:11:35,649 --> 00:11:39,029
override the test procedure which takes
like ninety seconds

137
00:11:39,029 --> 00:11:43,250
up to two to three minutes and then
you're ready to go so this is how

138
00:11:43,250 --> 00:11:47,139
they're working all of these devices
have communication enabled so as well as

139
00:11:47,139 --> 00:11:52,850
the the patient monitors as well as the
anesthesia device so the problem now is

140
00:11:52,850 --> 00:11:57,720
that if we consider this change that
medical device vendors are trying to

141
00:11:57,720 --> 00:12:02,760
push out these features and maybe even
hospitals one piece features we need to

142
00:12:02,760 --> 00:12:09,019
consider two things like the the vendor
side and our side basically which is the

143
00:12:09,019 --> 00:12:12,760
customer side on the hospital and the
patient site so I'll be ready for this

144
00:12:12,760 --> 00:12:17,560
is the question so looking at ITN
hospitals we always at least in Germany

145
00:12:17,560 --> 00:12:22,550
or in europe we have the problem that
there are is the lack of resources we

146
00:12:22,550 --> 00:12:25,149
have like if you look at a hospital and
at work

147
00:12:25,149 --> 00:12:29,790
hospital networks are consisting of
different types of networks so they're

148
00:12:29,790 --> 00:12:34,040
quite complicated to manage and if you
have a lack of resource this always goes

149
00:12:34,040 --> 00:12:38,060
on the cost of security ok we all know
that basically is that this is just like

150
00:12:38,060 --> 00:12:43,008
a natural law so looking at the
complexity on how they need to kind of

151
00:12:43,009 --> 00:12:47,589
adjust all of the stuff on manage all of
the networks they have they kind of now

152
00:12:47,589 --> 00:12:52,199
being approached by the vendors of these
devices that say like ok open up your

153
00:12:52,199 --> 00:12:54,189
networks we need to communicate a little
bit

154
00:12:54,190 --> 00:12:59,630
more we need access to these devices
from other networks for example and this

155
00:12:59,630 --> 00:13:06,870
basically leads to errors and this leads
to problems I would come back to this a

156
00:13:06,870 --> 00:13:11,420
little later so talking about us as the
patients there is an interesting

157
00:13:11,420 --> 00:13:14,610
question because all of the technology
that is on the rise

158
00:13:14,610 --> 00:13:20,400
considering home monitoring we should
ask start asking some some of the

159
00:13:20,400 --> 00:13:24,230
questions so I have a toothbrush and
this toothbrush ascending like the

160
00:13:24,230 --> 00:13:29,610
wireless data over the network and I can
monitor how hard I push and if I'm going

161
00:13:29,610 --> 00:13:34,530
too fast or too slow or whatever so home
monitoring or personal you have devices

162
00:13:34,530 --> 00:13:39,120
are on the rise rise and we should
consider stuff like privacy and security

163
00:13:39,120 --> 00:13:44,300
in these devices too because they they
are usually hooked up to our network so

164
00:13:44,300 --> 00:13:48,410
the first device I'm going to show you
this smart scale we have been taking a

165
00:13:48,410 --> 00:13:53,870
look at this scale it's basically is to
scale you step on your weight is

166
00:13:53,870 --> 00:13:58,450
measured you have an application on your
phone and you can put all of the data

167
00:13:58,450 --> 00:14:02,880
into the cloud so basically year
depending on on on what they tell you

168
00:14:02,880 --> 00:14:07,540
measure this is all going to the cloud
provider so the attacks office for this

169
00:14:07,540 --> 00:14:11,650
scale is quite low because the only
boots up if you step on it so it's not

170
00:14:11,650 --> 00:14:17,880
an always-on device on the time you step
on the scale the scale up and do some

171
00:14:17,880 --> 00:14:22,380
measuring and push the data to the cloud
so we have been looking at what kind of

172
00:14:22,380 --> 00:14:27,380
data is being pushed to the crowd as you
can see probably not but this is an HTTP

173
00:14:27,380 --> 00:14:32,100
request and it's quite big and if you
look at it a little bit closely you'll

174
00:14:32,100 --> 00:14:36,480
see that there is basically acts right
so that the data is going to be pushed

175
00:14:36,480 --> 00:14:43,050
into the cloud from the scale so this is
basically part of a measurement and it's

176
00:14:43,050 --> 00:14:48,050
going first of all it's going why HTTP
which is like okay so everybody knows

177
00:14:48,050 --> 00:14:49,050
how sad I am

178
00:14:49,050 --> 00:14:53,649
might be a problem might not be a
problem depends on if you care about

179
00:14:53,649 --> 00:14:57,990
this or not but in this case we kind of
recognized this and if you're familiar

180
00:14:57,990 --> 00:15:01,880
with hex and ASCII a little bit you see
that this is perfectly in the ASCII

181
00:15:01,880 --> 00:15:07,950
range and if you translate it to ASCII
then this will fall out of it so we were

182
00:15:07,950 --> 00:15:13,660
thinking about we know this ring from
somewhere and this string is the wifi

183
00:15:13,660 --> 00:15:19,649
PSK of the wireless network that we have
hooked up the skates too so the scale is

184
00:15:19,649 --> 00:15:27,709
sending our P escaped via HTTP into the
cloud of the provider the provider now

185
00:15:27,709 --> 00:15:31,640
has all of the key is that this scale
has been attached to so this is a real

186
00:15:31,640 --> 00:15:38,579
privacy issue and so for us this is like
a finding that the show is where we are

187
00:15:38,579 --> 00:15:45,050
going with awareness considering devices
health devices in dispute for personal

188
00:15:45,050 --> 00:15:51,949
monitoring ok so we have been talking
about the patients we have been talking

189
00:15:51,950 --> 00:15:56,360
about the hospital's what about the
vendors so from my perspective the

190
00:15:56,360 --> 00:16:00,779
vendors are doing the same mistakes
again so there is no learning curve like

191
00:16:00,779 --> 00:16:07,050
we've gone through this with wifi WEP we
have gone through this with Cherokee is

192
00:16:07,050 --> 00:16:11,300
that could be replayed the industry
learned so it feels a little bit like

193
00:16:11,300 --> 00:16:15,479
exploding in the old days and sometimes
it's it's it's really easy to get into

194
00:16:15,480 --> 00:16:20,550
these devices so again I'm not talking
about zero day stuff that needs training

195
00:16:20,550 --> 00:16:27,189
of 345 privilege escalation exploits to
do something on these devices it is so

196
00:16:27,190 --> 00:16:30,820
simple US hooking up tonight and going
into the device and doing whatever you

197
00:16:30,820 --> 00:16:40,230
want to do if you ask the defenders you
get interesting results so I was on

198
00:16:40,230 --> 00:16:45,560
fair and I was talking to medical device
vendors and I was astounded device that

199
00:16:45,560 --> 00:16:49,569
had a network plug a network ports on
the back of it and I was asking the

200
00:16:49,570 --> 00:16:54,520
defender ok this device has a number of
what are you doing with it and the

201
00:16:54,520 --> 00:16:58,780
answer he came up with was like yeah
we're not really using this part right

202
00:16:58,780 --> 00:17:04,379
now it just came bundled with the board
that we implemented in there we're not

203
00:17:04,380 --> 00:17:08,990
using it at all that we have no idea so
I bet if you just told there and hook up

204
00:17:08,990 --> 00:17:13,490
and go on to the revised and you're
basically can manage the board that is

205
00:17:13,490 --> 00:17:18,710
built into these devices some of the
vendors there's one one who is

206
00:17:18,710 --> 00:17:27,260
developing anesthesia devices and they
are supplying the new anesthesia devices

207
00:17:27,260 --> 00:17:31,030
with Internet Explorer us so they are
you have like this normal you are awake

208
00:17:31,030 --> 00:17:35,670
and do your stuff as an anesthesiologist
and then you have an Internet Explorer

209
00:17:35,670 --> 00:17:40,920
running and you can like I don't ask
some questions if you're in problem

210
00:17:40,920 --> 00:17:44,850
during an operation or whatever and they
are stating ok that's no problem we have

211
00:17:44,850 --> 00:17:48,679
internet explorer on it yes we know this
but it's not a problem we have liked to

212
00:17:48,680 --> 00:17:52,300
network interfaces wonderful the trusted
communication into the hospital network

213
00:17:52,300 --> 00:17:55,610
in one is for the internet so we are
fine we don't need nothing to do

214
00:17:55,610 --> 00:18:01,110
everything is fine so this is the state
where medical device vendors are right

215
00:18:01,110 --> 00:18:06,010
now they they are pretty good in
developing all this crazy stuff to

216
00:18:06,010 --> 00:18:12,510
measure your your your data to to get
out all of the data and process this

217
00:18:12,510 --> 00:18:16,210
stage are this is where they're coming
from a really really good at doing this

218
00:18:16,210 --> 00:18:21,000
and now this new thing internet is
showing up and they need to come up with

219
00:18:21,000 --> 00:18:23,910
features for it and they are not really
thinking into the right direction

220
00:18:23,910 --> 00:18:30,490
especially considering security from my
perspective at least so you might ask

221
00:18:30,490 --> 00:18:34,620
the question don't you need to be
compliant somehow is like security

222
00:18:34,620 --> 00:18:40,270
should be related to safety so is there
not like something include compliance

223
00:18:40,270 --> 00:18:44,210
that you need to fulfil to kind of throw
these devices are old and its security

224
00:18:44,210 --> 00:18:46,300
not one of these things

225
00:18:46,300 --> 00:18:52,379
well the problem is it is not actually
so normally safety and security should

226
00:18:52,380 --> 00:18:56,650
go together if you cannot provide
security you cannot provide safety in

227
00:18:56,650 --> 00:19:00,940
Germany we have this one problem that we
don't even have these words security and

228
00:19:00,940 --> 00:19:06,510
safety we only have one word for post
which is called it so we do not even

229
00:19:06,510 --> 00:19:11,660
distinguish between security and safety
and if you approach them inventors of

230
00:19:11,660 --> 00:19:15,900
the guys working in hospitals and you
were asking them questions about ok how

231
00:19:15,900 --> 00:19:20,700
do you do this you hide in your devices
they will come up with ya we are

232
00:19:20,700 --> 00:19:22,840
redundant we have carbs

233
00:19:22,840 --> 00:19:28,090
that's no problem we are completely
compliant but nobody's thinking about

234
00:19:28,090 --> 00:19:33,149
the security aspect of the show hide the
German words the side so that's one

235
00:19:33,150 --> 00:19:39,330
problem in Germany I thought that when I
was starting this research that safety

236
00:19:39,330 --> 00:19:45,580
will work in these devices I'm not sure
anymore actually because I had this one

237
00:19:45,580 --> 00:19:52,010
thing where I was looking at a high and
patient monitor which costs like I don't

238
00:19:52,010 --> 00:19:58,050
know fifteen thousand euros or something
and it's a patient monitor that is is it

239
00:19:58,050 --> 00:20:04,669
like state of the art and it has this
one market they did was showing him as a

240
00:20:04,670 --> 00:20:10,460
stole alarm which basically means your
heart just stopped when the patient was

241
00:20:10,460 --> 00:20:14,710
actually fine so the patient was
perfectly fine and the monitor was

242
00:20:14,710 --> 00:20:20,020
displaying oh my god cards like Code
Blue go out and do something because the

243
00:20:20,020 --> 00:20:24,230
patient is dying right now so and they
were just like when I was asking about

244
00:20:24,230 --> 00:20:27,520
this but they were just like yeah we
have despite we will fix it in like

245
00:20:27,520 --> 00:20:31,860
three months or something we will have a
release and it will be no problem so

246
00:20:31,860 --> 00:20:38,159
considering that features increase in
medical devices also the attack surface

247
00:20:38,160 --> 00:20:44,040
increases and also these devices will go
into will be going to favor because it's

248
00:20:44,040 --> 00:20:48,070
not even like that it's not the Oscar
oscilloscope anymore it's like a real

249
00:20:48,070 --> 00:20:55,189
complex system ok so safety mostly works
I would say does security concerning

250
00:20:55,190 --> 00:21:02,300
compliance there are only a few days
only few things that you need to do to

251
00:21:02,300 --> 00:21:06,210
it will be compliant so the first one is
have a proper authorization mechanism

252
00:21:06,210 --> 00:21:09,920
whatever that means right so a proper
authorization mechanism could be there

253
00:21:09,920 --> 00:21:15,690
is 10 it on there I'm fine and what you
always hear from vendors is yeah we've

254
00:21:15,690 --> 00:21:19,050
just like we don't care about that
because like if you're a hacker you will

255
00:21:19,050 --> 00:21:23,840
always find a way there is no problem in
getting to any device so we don't need

256
00:21:23,840 --> 00:21:28,750
to protect because hackers will always
find a way to get in in the USU have to

257
00:21:28,750 --> 00:21:34,050
fill out the form to get your device
onto the market and looking into

258
00:21:34,050 --> 00:21:36,220
compliance this fight and KFOR

259
00:21:36,220 --> 00:21:40,340
is called always assumes that there is
no hostile environment for the device so

260
00:21:40,340 --> 00:21:43,959
it just preliminary assumes the doctor
will not harm the patient the patient

261
00:21:43,960 --> 00:21:48,260
will not harm himself all the doctor and
there is no hostile environment so the

262
00:21:48,260 --> 00:21:54,809
devices just like considered for itself
and looking at certification stuff like

263
00:21:54,809 --> 00:22:00,470
that the focus on safety to a clear
focus on safety so to sum up the problem

264
00:22:00,470 --> 00:22:04,210
a little bit we have little resources on
the customer size

265
00:22:04,210 --> 00:22:09,330
the patient who is like Google cannot
consider which devices Sakura not

266
00:22:09,330 --> 00:22:14,330
because if he is confronted with a
device he probably is sick or seriously

267
00:22:14,330 --> 00:22:18,510
injured and he's not going to think
about how secure is this device that I'm

268
00:22:18,510 --> 00:22:22,150
going to be hooked up to end the
customer on the other hand is the

269
00:22:22,150 --> 00:22:27,700
hospital too so hospitals have a lack of
resource and they are basically also

270
00:22:27,700 --> 00:22:32,929
left alone with this issue so a hospital
in Europe is not able to kind of patch

271
00:22:32,929 --> 00:22:37,190
the devices for themselves if they see
there is no antivirus installed on one

272
00:22:37,190 --> 00:22:42,510
of the devices they cannot install
antivirus because if they do this by law

273
00:22:42,510 --> 00:22:47,679
they will be liable for everything that
happens with this device so you are not

274
00:22:47,679 --> 00:22:54,220
you cannot change this device because
you're liable afterwards safety razor

275
00:22:54,220 --> 00:22:58,400
security is another topic to they tried
to do safety well but they forget the

276
00:22:58,400 --> 00:23:03,299
security impact safety too so
considering all of these facts this is

277
00:23:03,299 --> 00:23:06,730
really serious in my opinion and this
could actually kill you

278
00:23:06,730 --> 00:23:11,919
so we will be looking at some of the
targets what have we been looking at so

279
00:23:11,919 --> 00:23:16,669
far and what is on the horizon what are
we looking at if you are wondering how

280
00:23:16,669 --> 00:23:20,690
does it look like if you're doing a
penetration testing the hospital this is

281
00:23:20,690 --> 00:23:26,570
basically how it looks like normally we
get to sit inside the rooms and it's

282
00:23:26,570 --> 00:23:30,678
pretty loud and cold looking at
hospitals

283
00:23:30,679 --> 00:23:34,090
this is a little bit more relaxed you
considered the patient's bad and then

284
00:23:34,090 --> 00:23:38,959
just took the devices up and start
testing from them so what we're looking

285
00:23:38,960 --> 00:23:42,179
at is like I mean it's clear medical
devices with a neighbor to come

286
00:23:42,179 --> 00:23:45,889
anything that's communicating over the
network communication is in places you

287
00:23:45,889 --> 00:23:54,758
would never suspect there are prosthetic
limbs that have a nap and you can do a

288
00:23:54,759 --> 00:23:58,909
Bluetooth connection from your phone to
your prosthetic limb to kind of adjust

289
00:23:58,909 --> 00:24:04,450
the limit little bit as I told you my
toothbrush has enabled come there are

290
00:24:04,450 --> 00:24:09,230
external cardiac defibrillators that
have communication enabled wireless

291
00:24:09,230 --> 00:24:14,570
proprietary wireless communication so
you there is communication in places you

292
00:24:14,570 --> 00:24:20,299
wouldn't have a suspect if you want you
could do a security rating so all of the

293
00:24:20,299 --> 00:24:24,799
stuff that is used for monitoring
basically is a low-security because it

294
00:24:24,799 --> 00:24:31,399
does not directly harm the patient media
stuff like diagnostics so if you're

295
00:24:31,399 --> 00:24:34,869
going into an x-ray machine or something
and you can adjust the doors as an

296
00:24:34,869 --> 00:24:39,610
attacker this could be critical to and
high is everything that has a feedback

297
00:24:39,610 --> 00:24:44,439
to the patient for example syringe palms
cardiac defibrillator stuff like that

298
00:24:44,440 --> 00:24:48,740
this is really critical stuff so
monitoring devices two of them are right

299
00:24:48,740 --> 00:24:51,559
here there are more on the market

300
00:24:51,559 --> 00:24:57,340
diagnostic devices most interesting so
far it has been the MRI which you see on

301
00:24:57,340 --> 00:25:02,309
the left side on the right hand side is
an x-ray machine I would not recommend

302
00:25:02,309 --> 00:25:08,029
testing an x-ray machine unless you know
exactly what you're doing because it's

303
00:25:08,029 --> 00:25:12,440
an x-ray machine and you can harm
yourself if you kind of miss adjust

304
00:25:12,440 --> 00:25:16,149
doses or something if you test an MRI
and the only thing that can really

305
00:25:16,149 --> 00:25:21,100
happen is basically that you would crash
the MRI and that the MRI dies and that

306
00:25:21,100 --> 00:25:25,610
will cost like one or two million bucks
but at least nobody gets harmed ok so if

307
00:25:25,610 --> 00:25:28,418
you're going into this stick to the

308
00:25:28,419 --> 00:25:35,399
radiology stuff that is not used not
using x-ray we have done stuff that is

309
00:25:35,399 --> 00:25:40,649
having feedback to the patient for
example in turn into implanted cardiac

310
00:25:40,649 --> 00:25:44,488
defibrillators anesthesia device in the
middle and a syringe pump on the top

311
00:25:44,489 --> 00:25:49,169
right so it's for us to test these
devices it's quite hard to get their

312
00:25:49,169 --> 00:25:55,369
hands on these devices because now
vendors have little interest that you

313
00:25:55,369 --> 00:26:01,699
test these devices I'm in a lawsuit
right now because I was reporting a

314
00:26:01,700 --> 00:26:03,120
security issue in

315
00:26:03,120 --> 00:26:08,809
medical device one of the demos that I'm
going to show is about this device and

316
00:26:08,809 --> 00:26:12,860
so it's really really hard to get your
hands on this stuff is expensive it

317
00:26:12,860 --> 00:26:16,449
really really costs a lot as I said
there are patient monitors to go up to

318
00:26:16,450 --> 00:26:21,170
fifteen twenty thousand bucks so this is
not something that you do in your spare

319
00:26:21,170 --> 00:26:27,830
time when you go to Amazon click buy
something and then tested so this is not

320
00:26:27,830 --> 00:26:32,699
working so what we do when we test
medical devices and we try to get into

321
00:26:32,700 --> 00:26:37,820
corporations with hospitals so we ask
the hospital's ok we test your stuff for

322
00:26:37,820 --> 00:26:43,040
free you give this stuff to us we can
consult you if we think that we might

323
00:26:43,040 --> 00:26:46,340
encounter problems stuff like that
because we need to interpret the data

324
00:26:46,340 --> 00:26:50,730
that you see is a pen tester you can't
just let go for it you need to know what

325
00:26:50,730 --> 00:26:55,940
this device is doing and on the other
hand the hospital kind of gives us the

326
00:26:55,940 --> 00:27:01,740
right to publish the research or or keep
the research and go get in touch get in

327
00:27:01,740 --> 00:27:04,710
contact with the vendors so this is a
dealer we are having with three

328
00:27:04,710 --> 00:27:10,480
hospitals right now in Germany and this
is working out pretty well so you can

329
00:27:10,480 --> 00:27:14,179
imagine these devices are hard to test
but there are a lot of fun to test and

330
00:27:14,179 --> 00:27:19,270
it's it's really really amazing stuff so
we are going into the targets that we

331
00:27:19,270 --> 00:27:23,879
have been looking into so far so this is
just a quick wrap up to kind of give you

332
00:27:23,880 --> 00:27:28,990
an impression on hull medical device
vendors through design and architecture

333
00:27:28,990 --> 00:27:35,210
in their devices this is nothing that is
really security critical but this is how

334
00:27:35,210 --> 00:27:39,920
basically all of the other security
critical devices work to so many gb is

335
00:27:39,920 --> 00:27:46,100
used to measure your brain waves and
it's basically just a great box and a

336
00:27:46,100 --> 00:27:52,080
software on a host system so you have a
normal PC and this gray box that you see

337
00:27:52,080 --> 00:27:57,189
right here and this box is basically
communicating over the network with

338
00:27:57,190 --> 00:28:01,580
with the host system and it's doing this
by UDP so it's just sending out the data

339
00:28:01,580 --> 00:28:06,580
and the host disease sending command
strings to the UGA to kind of adjust the

340
00:28:06,580 --> 00:28:09,870
measurement start measuring and stuff
like that there is no authentication

341
00:28:09,870 --> 00:28:16,120
encryption of all so this is not
critical because the data that has that

342
00:28:16,120 --> 00:28:21,729
is going over the over the line is not
that critical that it like impacts the

343
00:28:21,730 --> 00:28:27,070
patient safety directly but this shows
how these vendors kind of thing when

344
00:28:27,070 --> 00:28:32,179
they are implementing this stuff because
you could apply the same pattern to the

345
00:28:32,180 --> 00:28:35,720
patient monitor that I have right here
this is pretty much working the same way

346
00:28:35,720 --> 00:28:42,260
if you're interested in G's in doing
this stuff yourselves doing crazy

347
00:28:42,260 --> 00:28:48,430
biofeedback stuff like controlling your
laptop in a restricted way with just

348
00:28:48,430 --> 00:28:53,400
your mind then you can take a look at
the OpenID project you can build your

349
00:28:53,400 --> 00:28:58,550
only eg which you can see right there
the black box in the middle and you can

350
00:28:58,550 --> 00:29:02,540
basically use it to do basic stuff on
the laptop and

351
00:29:02,540 --> 00:29:08,170
move stuff around something like this
pretty amazing stuff so concerning the

352
00:29:08,170 --> 00:29:12,520
vulnerabilities that we have found I
will not do a full disclosure here

353
00:29:12,520 --> 00:29:18,129
obviously because the patch process for
these devices is critical and most of

354
00:29:18,130 --> 00:29:23,040
the times some of the vendors are not
able to catch these devices so I will

355
00:29:23,040 --> 00:29:27,950
not do full disclosure here and tell you
how every attack works I can promise you

356
00:29:27,950 --> 00:29:33,980
that most of the attacks on not rocket
science right but I'm not going to do

357
00:29:33,980 --> 00:29:38,930
any details here on on what will be
happening so I would start with the

358
00:29:38,930 --> 00:29:43,840
first patient monitor that I've it's
widely used in hospitals saw the normal

359
00:29:43,840 --> 00:29:46,649
stuff that you do with the patient
morning tour is you hook up a patient

360
00:29:46,650 --> 00:29:51,450
and then you it will display some vital
signs for example the oxygen saturation

361
00:29:51,450 --> 00:29:55,930
in your blood which is one of the most
critical patient data that you can have

362
00:29:55,930 --> 00:30:01,300
blood pressure pressure temperature and
respiration stuff like that so what I'm

363
00:30:01,300 --> 00:30:12,129
going to do now all is I'm going to
attack on this monitor right here for

364
00:30:12,130 --> 00:30:21,130
this is it possible that you turn off
this light on the first line is it

365
00:30:21,130 --> 00:30:27,610
possible to do this a little bit down
this is ok but you should be able to see

366
00:30:27,610 --> 00:30:31,530
ya you know it's ok now it's ok so you
see the patient monitor right here i

367
00:30:31,530 --> 00:30:36,340
will go a little bit more full screen
and you see that it is working so it

368
00:30:36,340 --> 00:30:40,159
says like there is some data there
there's no patient hooked up right now

369
00:30:40,160 --> 00:30:44,800
so there's no data in coming but it's
it's working even turning this not you

370
00:30:44,800 --> 00:30:49,889
see that there's something happening on
the device I can click and its does what

371
00:30:49,890 --> 00:30:51,260
it is supposed to do

372
00:30:51,260 --> 00:31:01,490
ok so what I'm going to do now is show
you a basic attack that can be used to

373
00:31:01,490 --> 00:31:06,590
this device of the network so we are
talking about a classic denial of

374
00:31:06,590 --> 00:31:11,260
service attack right here but denial of
service on medical devices kind of as

375
00:31:11,260 --> 00:31:12,120
you can imagine

376
00:31:12,120 --> 00:31:16,570
has a large impact than on any other
infrastructure that I can imagine as I

377
00:31:16,570 --> 00:31:21,370
told you if it is possible to kind of
nuclear device of the network and to

378
00:31:21,370 --> 00:31:26,020
make like the data that is displayed on
our make the data just disappear you

379
00:31:26,020 --> 00:31:30,210
will be running into problems if you are
doing in the middle of an operation and

380
00:31:30,210 --> 00:31:40,840
you need this later to kind of do your
stuff okay so ok let me think for a

381
00:31:40,840 --> 00:31:41,399
second

382
00:31:41,400 --> 00:31:58,340
first up to the manager just launched
the denial of service what you should

383
00:31:58,340 --> 00:32:00,580
see now if this is working

384
00:32:00,580 --> 00:32:03,679
is that the mantra basically three
groups there you go

385
00:32:03,680 --> 00:32:08,190
so this is happening all over the
network and its even working by

386
00:32:08,190 --> 00:32:11,820
broadcast so it's not even a direct
attack I'm just flooding the network

387
00:32:11,820 --> 00:32:16,290
with broadcast messages that are used
for these devices to communicate with

388
00:32:16,290 --> 00:32:21,659
each other and as you see the device
reboots and as you can see now the

389
00:32:21,660 --> 00:32:27,080
device to reboot but it's not usable so
there's nothing I can click anything I

390
00:32:27,080 --> 00:32:31,590
want it's it's just not usable so you
can see that there is like some streams

391
00:32:31,590 --> 00:32:36,530
on the top of the screen devices frozen
its not usable again so what you would

392
00:32:36,530 --> 00:32:42,570
need to do is reboot the device but as
long as my attack is running there will

393
00:32:42,570 --> 00:32:47,939
be no doubt are displayed on this device
so if I stop the attack it comes up

394
00:32:47,940 --> 00:32:54,150
again and there it is again and it is
perfectly fine again so you see that

395
00:32:54,150 --> 00:33:00,160
with like small effort you can use one
of these devices on the network and as

396
00:33:00,160 --> 00:33:04,540
it is a broadcast attack you can even
you got all of the devices that are in

397
00:33:04,540 --> 00:33:10,420
the network I just running this one
small python script ok so there is

398
00:33:10,420 --> 00:33:13,149
another thing that I was going to show
you

399
00:33:13,149 --> 00:33:17,189
what we managed to do on this device I'm
not going to show this because it takes

400
00:33:17,190 --> 00:33:23,320
a little bit more time and I have more
demos that I want to show your so the

401
00:33:23,320 --> 00:33:29,289
next thing that we did was there is on
the upper right corner there are alarmed

402
00:33:29,289 --> 00:33:35,200
boundaries these alarm boundaries are
now set to like alleged values like 120

403
00:33:35,200 --> 00:33:40,489
for the upper boundary and 64 the lower
boundary and they kind of described the

404
00:33:40,489 --> 00:33:45,629
alarm boundary where it's an alarm will
be triggered when your heart rate goes

405
00:33:45,629 --> 00:33:51,899
too slow or your heart rate goes too
fast right so legit case if the greatest

406
00:33:51,899 --> 00:33:55,379
too fast or too slow something is wrong
I want the device to trigger an alarm

407
00:33:55,379 --> 00:34:00,178
and we managed to set these higher and
lower alarm boundaries to like it's an

408
00:34:00,179 --> 00:34:04,210
integer overflow and you can see that
we've reset it you're more than 30,000

409
00:34:04,210 --> 00:34:07,799
for the upper boundary more than minus
thirty thousand for the lower boundary

410
00:34:07,799 --> 00:34:09,918
and you can imagine that you're hired

411
00:34:09,918 --> 00:34:16,839
well there is nothing like negative
heartbeats right so your hardware stop

412
00:34:16,839 --> 00:34:23,319
by zero and if like there is no hydrated
will be zero which is perfectly in the

413
00:34:23,319 --> 00:34:28,299
upper and lower alarm boundaries which
means that if you're dead no alarm will

414
00:34:28,299 --> 00:34:33,379
ever trigger on this device so we
managed to set this alarm boundary over

415
00:34:33,379 --> 00:34:34,609
the network

416
00:34:34,609 --> 00:34:41,569
ok so the next thing I'm going to show
you is my MRI MRI but I wish it was

417
00:34:41,569 --> 00:34:47,440
because it's pretty cool stuff so if you
have the chance to visit and Mariah look

418
00:34:47,440 --> 00:34:51,149
at this device it's really really cool
so what you see right here is the

419
00:34:51,149 --> 00:34:55,638
control station on the MRI so there's
this lady sitting configuring the MRI

420
00:34:55,639 --> 00:35:00,140
looking at the data that is coming in
and you see the magnet and the coils in

421
00:35:00,140 --> 00:35:06,819
this cycle in the background where the
patient is is so it consists technically

422
00:35:06,819 --> 00:35:12,529
simply as like these three parts it's a
whole system the whole system is running

423
00:35:12,529 --> 00:35:17,230
a Windows PC then you have an image
processing system which retrieves the

424
00:35:17,230 --> 00:35:22,990
data from the magnets and from the cause
and the control system which kind of

425
00:35:22,990 --> 00:35:27,160
does all the hard Westhoff contra
controlling the caller's putting the

426
00:35:27,160 --> 00:35:31,788
table in an hour with the patient will
be lying on stuff like that so we have

427
00:35:31,789 --> 00:35:36,329
these three parts so if you look look at
it by a network diagram it looks a

428
00:35:36,329 --> 00:35:40,369
little bit like this post-pc you have a
Linux box which is used for image

429
00:35:40,369 --> 00:35:45,529
processing which will put the data on
and H

430
00:35:45,529 --> 00:35:49,420
doctors and you have something like the
ex-works that is controlling the

431
00:35:49,420 --> 00:35:55,029
hardware of the MRI itself so we looked
at this device we were pretty

432
00:35:55,029 --> 00:35:59,980
conservative without testing because of
one this thing is always on right the

433
00:35:59,980 --> 00:36:03,930
magnitude of this device is always on if
you manage to switch of the day the

434
00:36:03,930 --> 00:36:08,240
magnet then bad things are going to
happen and it costs a lot of money for

435
00:36:08,240 --> 00:36:13,930
the hospital so we were really really
careful when we were doing this first of

436
00:36:13,930 --> 00:36:18,589
all we took it we broke out of the
kindness of the MRI of the control

437
00:36:18,589 --> 00:36:22,819
station and we will have we are now
looking at the Security Center of the

438
00:36:22,819 --> 00:36:28,720
configuration of the Windows XP box so
the controller PC is a Windows XP and

439
00:36:28,720 --> 00:36:32,220
you see the firewall automatic updates
and virus protection of basically turned

440
00:36:32,220 --> 00:36:39,490
off which is in this case whether it's a
Windows XP with Service Pack 2 but the

441
00:36:39,490 --> 00:36:44,288
benders dated they will have no problems
with wireless ones or trojans or

442
00:36:44,289 --> 00:36:50,510
whatever because they are using 64 bit
Windows XP so no problem at all

443
00:36:50,510 --> 00:36:57,600
we did a port scan of the whole system
and you can see right here like this is

444
00:36:57,600 --> 00:36:59,920
just an example because it didn't fit on
the screen

445
00:36:59,920 --> 00:37:04,280
we have like one hundred and fourteen
open ports on the control system I just

446
00:37:04,280 --> 00:37:10,680
saw the control computer has 114 ports
open HTTP even there is an HTTP server

447
00:37:10,680 --> 00:37:18,770
running what happens when you do this so
if you are parts getting an MRI bad

448
00:37:18,770 --> 00:37:23,830
things can happen in this case the
application on the MRI crashed so what

449
00:37:23,830 --> 00:37:29,250
you see right here i mean this is after
reports Kim it is a port scan we did and

450
00:37:29,250 --> 00:37:33,720
map and we just send it to the device
and the device crashed so this is like

451
00:37:33,720 --> 00:37:40,640
the backtrace of the crash right here
which is pretty serious because like bob

452
00:37:40,640 --> 00:37:43,879
is able to crash it and welcome to the
nineties by the way if any others is

453
00:37:43,880 --> 00:37:50,620
able to crash this thing if we would
have started a father would have blown

454
00:37:50,620 --> 00:37:56,549
away I guess the complete box so getting
into the whole species no problem at all

455
00:37:56,550 --> 00:38:01,210
and if you're once you're on the host PC
than the network is open to the Linux

456
00:38:01,210 --> 00:38:06,260
box and two VxWorks you basically just
go to the network and use your favorite

457
00:38:06,260 --> 00:38:11,900
come on like 10 announced with no
password and stuff like that and just a

458
00:38:11,900 --> 00:38:14,350
run into the machines and then there you
go

459
00:38:14,350 --> 00:38:17,900
this is especially critical for this
component on here for the Xbox thing

460
00:38:17,900 --> 00:38:22,250
because this controls the coil and a
magnet and once you're on there and you

461
00:38:22,250 --> 00:38:25,880
can perfectly destroy the whole thing
and that would cost millions to the

462
00:38:25,880 --> 00:38:32,330
hospital so we were able to do all of
this

463
00:38:32,330 --> 00:38:39,230
not through the network of the hospital
like the security closed down hospital

464
00:38:39,230 --> 00:38:45,660
network but we were able to do all of
this through the cast why fire that was

465
00:38:45,660 --> 00:38:49,990
unencrypted and everybody had access to
so everybody running a port scan and

466
00:38:49,990 --> 00:38:54,959
this hospital in the guest wifi to this
IP address would have crashed the

467
00:38:54,960 --> 00:39:00,700
arrived basically ok so the next thing
I'm going to so I need to look at how

468
00:39:00,700 --> 00:39:12,240
much am I it's thirty minutes I should
anyways whatever

469
00:39:12,240 --> 00:39:43,640
that we have been looking into so on the
left side with toilet paper obfuscator

470
00:39:43,640 --> 00:39:49,240
to syringe pump we opted for skated with
toilet paper because we were not able to

471
00:39:49,240 --> 00:39:52,759
get it out of the hospital to kind of
the demos and we had to film this in the

472
00:39:52,760 --> 00:39:56,600
session right away so what we did was
kind of opera skated so you don't know

473
00:39:56,600 --> 00:40:01,420
exactly if you're into a medical devices
you you know what when did it is because

474
00:40:01,420 --> 00:40:06,080
it's one of the few vendors that has
some of the features that I'm going to

475
00:40:06,080 --> 00:40:10,750
show you now ok so what happens is if
you look at the video then you have like

476
00:40:10,750 --> 00:40:14,060
the syringe pump the syringe pump is
working right now it's it's pumping

477
00:40:14,060 --> 00:40:17,670
stuff into the patient and if you want
to change something on the device

478
00:40:17,670 --> 00:40:21,230
Unicode there is a security code which
is like perfectly valid because you

479
00:40:21,230 --> 00:40:25,920
don't want anybody to kind of switch on
the doses or put them higher so what we

480
00:40:25,920 --> 00:40:29,790
did you see there is a cold missing so
what we do right now it's a little bit

481
00:40:29,790 --> 00:40:34,670
bad to see on the right side is attached
to the pump over the network and we are

482
00:40:34,670 --> 00:40:38,520
trying to retrieve the pain of the
nature of the pump there are actually

483
00:40:38,520 --> 00:40:42,800
two times right now one is above you can
see this because it's up for skated the

484
00:40:42,800 --> 00:40:48,150
yellow one right there you see that we
have to extract the pin over the network

485
00:40:48,150 --> 00:40:54,590
right now I'm entering the pin or at
least trying to enter the PIN right now

486
00:40:54,590 --> 00:40:59,060
you see it's perfectly unlocked right
now and I can adjust the dogs to like a

487
00:40:59,060 --> 00:41:00,980
lethal dose for the patient

488
00:41:00,980 --> 00:41:04,720
going from zero point three to two
hundred milliliters per hour whatever

489
00:41:04,720 --> 00:41:08,750
and you see that the pump is not
configured and ready to work and this is

490
00:41:08,750 --> 00:41:10,640
all done over the network

491
00:41:10,640 --> 00:41:16,799
ok so next next target

492
00:41:16,800 --> 00:41:21,540
so the next target I'm going to show is
an anesthesia devices anesthesia devices

493
00:41:21,540 --> 00:41:26,580
are from my perspective the most
critical stuff that you can get your

494
00:41:26,580 --> 00:41:30,600
hands on because its controlling your
breathing during an operation and if you

495
00:41:30,600 --> 00:41:34,779
are able to stop this or influence this
is an attack her that means instant

496
00:41:34,780 --> 00:41:41,300
injury to to the patient thank you

497
00:41:41,300 --> 00:41:50,500
ok so going to show this ok so what you
see right here maybe I will try to turn

498
00:41:50,500 --> 00:41:56,650
on those I don't know if this is working
so what you see right here is the

499
00:41:56,650 --> 00:42:04,960
anesthesia device and

500
00:42:04,960 --> 00:42:13,530
so what you see right here is that don't
belong there is like the patient is so

501
00:42:13,530 --> 00:42:17,450
there is oxygen delivered to the patient
you see that there is a pump going up

502
00:42:17,450 --> 00:42:33,430
and down everything's fine if you look
at it is OK I would go back

503
00:42:33,430 --> 00:42:55,490
audio right there on the audio maybe I
need to know

504
00:42:55,490 --> 00:43:04,600
perfect ok so we'll do it like this

505
00:43:04,600 --> 00:43:12,130
ok so what's happening right now is now
I'm going to show you that the device is

506
00:43:12,130 --> 00:43:16,630
working you see that there is data on
the screen so we are in the normal

507
00:43:16,630 --> 00:43:22,220
operation date on the screen no problem
at all my colleagues going to attack the

508
00:43:22,220 --> 00:43:23,870
device over the network

509
00:43:23,870 --> 00:43:32,930
you might hear some typing that was the
return and if we go back to the device

510
00:43:32,930 --> 00:43:42,779
we see that it is frozen so the device
is not working anymore and you don't

511
00:43:42,780 --> 00:43:48,020
hear an alarm so what the
anesthesiologist is doing if he's not

512
00:43:48,020 --> 00:43:51,759
looking at the device right now he won't
recognize that something's happening

513
00:43:51,760 --> 00:43:52,380
right now

514
00:43:52,380 --> 00:43:58,250
ok so this device has something like
well luckily I don't know because if you

515
00:43:58,250 --> 00:44:03,870
look at the device can you see that
grieving is still working alright so the

516
00:44:03,870 --> 00:44:10,529
the backup still working the UI is
frozen no data is displayed but they

517
00:44:10,530 --> 00:44:16,640
still breathing is working and what not
what happens now is that we exhausted so

518
00:44:16,640 --> 00:44:20,339
many system resources on this device
that even this fall back is not working

519
00:44:20,340 --> 00:44:26,090
anymore you will see that the brunt of
the great pomp would drop down

520
00:44:26,090 --> 00:44:35,250
and then it hangs in the locker room and
basically the devices unusable know you

521
00:44:35,250 --> 00:44:38,200
need to switch it off to kind of get it
back to work again

522
00:44:38,200 --> 00:44:47,830
ok so as I told you in this situation
this is pretty pretty bad right because

523
00:44:47,830 --> 00:44:52,110
you're in the middle of an operation
just don't realize for a few seconds

524
00:44:52,110 --> 00:44:55,070
that the patient that there's something
wrong with the device is malfunctioning

525
00:44:55,070 --> 00:44:59,860
and then all of a sudden the device just
freezers and you can't do nothing so the

526
00:44:59,860 --> 00:45:03,600
only chance that you have right now is
unplug the device reboot the device that

527
00:45:03,600 --> 00:45:08,839
takes up to nineteen seconds even if you
are not going to if you override the

528
00:45:08,840 --> 00:45:13,280
machine if you override like the tests
that the machine has to do before it is

529
00:45:13,280 --> 00:45:18,620
coming up and this takes a lot of time
so you can imagine how does what this

530
00:45:18,620 --> 00:45:26,440
means during an operation for the
anesthesiologist

531
00:45:26,440 --> 00:45:33,849
ok so now we're going to look at the
second device that I have with me

532
00:45:33,849 --> 00:45:41,720
the second device is also a patient
monitor and it basically consists of two

533
00:45:41,720 --> 00:45:50,450
parts one part is basically to our
boards that are built into this patient

534
00:45:50,450 --> 00:45:57,339
monitor one of it is used for signal
processing and the other one is used for

535
00:45:57,339 --> 00:46:01,900
like displaying the UI and stuff like
that so they both look like this

536
00:46:01,900 --> 00:46:07,950
22 bar it's one here one here and they
have like different stuff to do so

537
00:46:07,950 --> 00:46:13,629
basically the setup of this device is
the same as the one shown you before ok

538
00:46:13,630 --> 00:46:18,630
so now we're going to do a few demos on
these devices and for this demo I need

539
00:46:18,630 --> 00:46:28,599
my volunteer because I knew vital signs
to show you will sit down right here and

540
00:46:28,599 --> 00:46:36,839
just let let me your vital signs just
one finger peace ok so I would switch to

541
00:46:36,839 --> 00:46:49,500
the camera ok so what you see right here
is the device the patient monitoring you

542
00:46:49,500 --> 00:46:55,000
see an oxygen saturation of 99 or 100
which is pretty good so you're doing

543
00:46:55,000 --> 00:46:58,289
good policy is a little bit higher

544
00:46:58,289 --> 00:47:04,279
I don't know why this is okay so what
I'm going to do now is a short

545
00:47:04,279 --> 00:47:12,069
demonstration of what I call the James
Bond scenario so realistic scenario that

546
00:47:12,069 --> 00:47:15,419
we need to care about time I can't
stress this enough is like the stuff

547
00:47:15,419 --> 00:47:20,749
that I've shown before denial of service
we liked by a port scan or stuff like

548
00:47:20,749 --> 00:47:26,718
that that may be happening bye bye bye
incident is something that we need to

549
00:47:26,719 --> 00:47:33,009
care about we can go or we can push this
a little bit more to kind of go into a

550
00:47:33,009 --> 00:47:37,719
James Bond scenario so imagine this
young lady right here is a VIP and she

551
00:47:37,719 --> 00:47:41,869
is on an intensive care unit right now
which I hope it doesn't happen to you

552
00:47:41,869 --> 00:47:47,880
but anyways we were just think about
this for a second so she's protected by

553
00:47:47,880 --> 00:47:54,459
guards at the front door and the kind of
wants to sneak in and kill her

554
00:47:54,459 --> 00:48:00,009
sorry and does not want anybody to
recognize this on the system

555
00:48:00,009 --> 00:48:06,760
ok so what I'm going to do right now is

556
00:48:06,760 --> 00:48:34,410
what I'm going to do so what I'm going
to do I'm basically just going into the

557
00:48:34,410 --> 00:48:41,450
device right now and I'm going to record
her vital signs so the moment that I

558
00:48:41,450 --> 00:48:45,750
would kill her I would just replay the
vital signs and hope that nobody will

559
00:48:45,750 --> 00:48:51,580
recognize so I was started recording
right now which takes a few seconds

560
00:48:51,580 --> 00:48:53,920
should be fine right now

561
00:48:53,920 --> 00:48:59,360
ok so I would detach the patient so
which is this is basically when she's

562
00:48:59,360 --> 00:49:04,720
debussy flatline right so this should be
the case when she's dead and everything

563
00:49:04,720 --> 00:49:08,200
if everything goes fine I will blank the
monitor so you can see something's

564
00:49:08,200 --> 00:49:11,870
happening now on the money tour and I
will shortly

565
00:49:11,870 --> 00:49:17,100
real play a vital signs so everything's
fine again even if there's no patient

566
00:49:17,100 --> 00:49:21,460
hooked up to this device you can see
that it is perfectly working okay so

567
00:49:21,460 --> 00:49:24,210
this is a classic replay attack on the
device

568
00:49:24,210 --> 00:49:34,850
thank you very much so what else can we
do so I will show you a little bit more

569
00:49:34,850 --> 00:49:37,808
what I can do with this device

570
00:49:37,809 --> 00:49:57,910
I need to I would just you activate my
I'll put first second ok so so that you

571
00:49:57,910 --> 00:50:03,118
see that we not only able to replay this
stuff and replay something on the device

572
00:50:03,119 --> 00:50:44,520
I'm going to go a little bit further
right now thank you I'm going to

573
00:50:44,520 --> 00:50:53,770
full control over this I'm going to try
to do additional stuff which a few

574
00:50:53,770 --> 00:50:59,800
seconds there you go so we even can play
videos on this device and even regrow

575
00:50:59,800 --> 00:51:04,300
like the anesthesiologist during an
operation and and display like whatever

576
00:51:04,300 --> 00:51:05,280
we want on it

577
00:51:05,280 --> 00:51:20,090
ok so that means we have full control
over the device ok so there is more we

578
00:51:20,090 --> 00:51:25,110
have their software with this device
that comes with this device we can

579
00:51:25,110 --> 00:51:29,550
inject into this software so if you're
if you're going to use the legitimate

580
00:51:29,550 --> 00:51:33,970
software and display your vital signs
that you see right here it is possible

581
00:51:33,970 --> 00:51:37,399
for us to kind of get into the data
stream not off the device of the network

582
00:51:37,400 --> 00:51:43,110
like we can do an additional denial of
service for this device to like black

583
00:51:43,110 --> 00:51:47,560
for the other one and we can inject our
own stream to display whatever we want

584
00:51:47,560 --> 00:51:51,140
on the screens that are running on the
intensive care unit

585
00:51:51,140 --> 00:51:59,060
ok so looking at the targets read this
is active research we're doing a lot of

586
00:51:59,060 --> 00:52:02,700
research we have a hospital that has
like over a one hundred and eleven

587
00:52:02,700 --> 00:52:08,609
hospitals in in Germany and we would
like to run through all of them and grab

588
00:52:08,610 --> 00:52:12,370
the equipment and then to look into
these devices keep in mind that if you

589
00:52:12,370 --> 00:52:16,650
are going to test these devices that
they are expensive and they need to get

590
00:52:16,650 --> 00:52:21,650
hooked up to a patient afterwards
probably so if you do stuff relief back

591
00:52:21,650 --> 00:52:25,050
doors they're our stuff like that don't
do this you really really conservative

592
00:52:25,050 --> 00:52:29,130
when you're doing testing because this
could harm a patient even if you're just

593
00:52:29,130 --> 00:52:31,510
intended to do this stuff for good

594
00:52:31,510 --> 00:52:38,970
be conservative with what you do so I
think in my opinion we need to test

595
00:52:38,970 --> 00:52:42,450
these devices you need to get your hands
on these devices and we need to create

596
00:52:42,450 --> 00:52:47,759
awareness for this problem in this case
I think the responsible disclosure is a

597
00:52:47,760 --> 00:52:52,340
critical process it it it should be used
there should be no full disclosure on

598
00:52:52,340 --> 00:52:56,100
how experts working how this stuff works
because at the end of the day depending

599
00:52:56,100 --> 00:52:57,560
on the technology that you are you

600
00:52:57,560 --> 00:53:03,690
adding you can harm patients with these
things it's not about a few bucks are

601
00:53:03,690 --> 00:53:09,410
thousands of dollars or whatever it's
about the life of a patient so go out

602
00:53:09,410 --> 00:53:12,740
there and get your hands dirty I heard
there's a hospital around here right

603
00:53:12,740 --> 00:53:17,490
it's just a few hundred metres away or
something like that so next time you are

604
00:53:17,490 --> 00:53:24,470
in a hospital room just take a look
around take a glance around and network

605
00:53:24,470 --> 00:53:29,470
plucks we were definitely put up more
publications and models most of the come

606
00:53:29,470 --> 00:53:33,419
from our side so stay tuned on this
topic do some awareness on this topic

607
00:53:33,420 --> 00:53:40,760
and I am now open for questions if there
should be any I think that I have like

608
00:53:40,760 --> 00:53:44,440
how much do we have left seven minutes
five minutes something like that

609
00:53:44,440 --> 00:53:57,160
five minutes left ok so should we go
into questions from my side I'm done any

610
00:53:57,160 --> 00:54:04,700
questions in the room was your night
this Muskegon Mona Michael what you need

611
00:54:04,700 --> 00:54:12,839
to kind of hook up my translator i'm ok
just give me a second thanks

612
00:54:12,839 --> 00:54:24,259
okay thank you very much there was very
scary it's kinda reminded me

613
00:54:24,259 --> 00:54:28,719
research report card and I don't know if
you've heard of it

614
00:54:28,719 --> 00:54:37,969
terrorists human have you heard of that
research now not really like it said

615
00:54:37,969 --> 00:54:50,559
that the you s Avenida 17050 150,000
patients diet human human error if I can

616
00:54:50,559 --> 00:54:55,029
can go into this topic because this is
pretty interesting so one thing that I

617
00:54:55,029 --> 00:54:59,440
forgot to mention is that if you look at
the statistics then you can see that

618
00:54:59,440 --> 00:55:05,589
there is a steep increase of patients
getting injured by medical devices so

619
00:55:05,589 --> 00:55:09,089
it's not that they're sick and they are
dying because they're sick because they

620
00:55:09,089 --> 00:55:13,558
are dying or being injured because of
the use of an invalid use of medical

621
00:55:13,559 --> 00:55:19,859
devices and we don't have any numbers
right now to kind of see is this because

622
00:55:19,859 --> 00:55:24,499
the devices fail is this because there
wasn't a coroner is their security

623
00:55:24,499 --> 00:55:28,649
problem or whatever so this is the thing
that we need to tackle we have no

624
00:55:28,650 --> 00:55:32,489
monitoring it all if there is something
happening right now or not so sorry to

625
00:55:32,489 --> 00:55:33,269
interrupt you

626
00:55:33,269 --> 00:55:42,749
yes that's kind of the line I wanted yes
so I haven't heard any like major like a

627
00:55:42,749 --> 00:55:48,640
hacking you know and people a lot of
people dying I just happy in a small

628
00:55:48,640 --> 00:55:53,879
scale in reality you're okay so what
what you can say is as I said there is

629
00:55:53,880 --> 00:55:57,920
absolutely no monitoring on the devices
so the attacks that i've shown your

630
00:55:57,920 --> 00:56:03,400
would would probably go undetermined so
there's no chance to kind of see why the

631
00:56:03,400 --> 00:56:09,769
device failed was it because somebody
militias was going into the device or

632
00:56:09,769 --> 00:56:12,930
was it just like a network failure or
whatever so we don't have this data

633
00:56:12,930 --> 00:56:17,779
right now what I can say that is that
the James Bond scenario that I was

634
00:56:17,779 --> 00:56:18,650
showing

635
00:56:18,650 --> 00:56:23,860
now is not the one that we need to
consider because this is a targeted

636
00:56:23,860 --> 00:56:29,510
attack and to make this feasible kind of
you need to know who's the attacker I

637
00:56:29,510 --> 00:56:35,430
mean if you're a VIP year and you like
the vice-president deactivated wireless

638
00:56:35,430 --> 00:56:40,100
communication protocols on his implanted
cardiac defibrillator in the you s right

639
00:56:40,100 --> 00:56:45,350
because he feared that an attacker my
target this to to kill him if you are

640
00:56:45,350 --> 00:56:49,560
the vice president you might care about
this scenario I guess that for all of us

641
00:56:49,560 --> 00:56:54,860
this does not apply it so the things
that needs that we need to look into is

642
00:56:54,860 --> 00:56:59,180
to make these devices a little bit more
stable so for example a denial of

643
00:56:59,180 --> 00:57:04,799
service attack on the networks Dec
should not like kind of compromise the

644
00:57:04,800 --> 00:57:08,780
system or give or shut down the system
it's a case of the network step is going

645
00:57:08,780 --> 00:57:14,290
down and if this ones like broken but
the data should be displayed anyways so

646
00:57:14,290 --> 00:57:18,910
I cannot say that if there is something
happening there was like I think four or

647
00:57:18,910 --> 00:57:25,140
five weeks ago a presentation by some of
them some guys who did a honey pot with

648
00:57:25,140 --> 00:57:29,609
medical devices and they just put it
into the internet and just like were

649
00:57:29,610 --> 00:57:33,740
looking into who is coming by what are
they doing on their devices and most of

650
00:57:33,740 --> 00:57:36,660
the times the attacker just went in

651
00:57:36,660 --> 00:57:40,910
dropped his back door and then left
again and you could see that the

652
00:57:40,910 --> 00:57:45,500
attackers don't really know what they're
dealing with right now so there is a

653
00:57:45,500 --> 00:57:50,220
time frame that we have where we can
patch and like get create awareness and

654
00:57:50,220 --> 00:57:55,060
do stuff because I don't see that we
have like a big peak that we need to

655
00:57:55,060 --> 00:57:58,950
care about because people are starving
hacking into medical devices and doing

656
00:57:58,950 --> 00:58:03,700
crazy stuff right we're not at the point
yet but there are medical devices that

657
00:58:03,700 --> 00:58:08,500
get compromised but their normal used as
the usual for the usual stuff like what

658
00:58:08,500 --> 00:58:11,690
nights

659
00:58:11,690 --> 00:58:32,549
questions must get this message

660
00:58:32,549 --> 00:58:42,199
encourages societal penetration testing
this is used to know it put on a tank

661
00:58:42,199 --> 00:58:44,130
able to sustain it

662
00:58:44,130 --> 00:58:52,150
viewing 909 angel can you get I

663
00:58:52,150 --> 00:59:03,880
important email can take you start to
use the most recently released today so

664
00:59:03,880 --> 00:59:08,339
if I understand correctly that that is
correct so what I did was so all of

665
00:59:08,339 --> 00:59:11,170
these devices need to get hooked up to
the network to the hospital network

666
00:59:11,170 --> 00:59:14,849
because you want the data attribute like
available in all of the rooms to just

667
00:59:14,849 --> 00:59:21,180
play them on your laptop or whatever so
what we did was we hooked up to the

668
00:59:21,180 --> 00:59:27,730
hospital network and then like in our
case we did we did not do like it black

669
00:59:27,730 --> 00:59:31,990
box penetration testing just like
enumeration and look what kind of

670
00:59:31,990 --> 00:59:36,680
devices are then just tried to get in
them we had like a lab setup because we

671
00:59:36,680 --> 00:59:41,118
don't want to see that the MRIs crashing
because you're doing a port scan that's

672
00:59:41,119 --> 00:59:45,420
bad and we don't want that right so we
are not scanning like the entire range

673
00:59:45,420 --> 00:59:50,430
of the hospital we had a lab setup and
in this lab we had like dedicated

674
00:59:50,430 --> 00:59:55,740
devices to targeted attack but all of
these attacks are perfectly feasible if

675
00:59:55,740 --> 00:59:59,520
you just plug into the right network
plaque and then start looking around so

676
00:59:59,520 --> 01:00:04,940
this is what we we did once we just did
like a scan to see what devices are

677
01:00:04,940 --> 01:00:08,819
available and then we basically picked
the devices if they look interesting and

678
01:00:08,819 --> 01:00:12,520
and put them into a lab so we have them
in a controlled environment because we

679
01:00:12,520 --> 01:00:17,910
make sure what kind of the allies are we
taking and can we clean up the stuff

680
01:00:17,910 --> 01:00:21,808
that we did afterwards that's that's
critical for us so we always do this in

681
01:00:21,809 --> 01:00:30,750
a lab environment does that answer your
question I said it was a mass audience

682
01:00:30,750 --> 01:00:32,289
and dividing otherwise I must stop

