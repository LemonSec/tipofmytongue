1
00:00:00,680 --> 00:00:08,460
hi everyone so next talk is about

2
00:00:05,029 --> 00:00:14,219
monitoring AWS in this year so I'm gonna

3
00:00:08,460 --> 00:00:16,740
let me see if this works okay so a very

4
00:00:14,219 --> 00:00:19,198
basic agenda I'm going to briefly

5
00:00:16,740 --> 00:00:22,500
introduce myself no I promise to keep it

6
00:00:19,199 --> 00:00:24,330
short and boring anyway why monitor

7
00:00:22,500 --> 00:00:26,849
anything what monitor how do we do it

8
00:00:24,330 --> 00:00:29,639
for sure and AWS and and then some

9
00:00:26,849 --> 00:00:33,050
options on integrating a AWS and it's

10
00:00:29,640 --> 00:00:37,380
your logs into sim solutions and

11
00:00:33,050 --> 00:00:39,390
potentially MSS piece mmm so my name is

12
00:00:37,380 --> 00:00:41,579
Alfred I know as you can tell from my

13
00:00:39,390 --> 00:00:44,700
accent I'm Spanish although I live here

14
00:00:41,579 --> 00:00:47,100
in the UK and been working in

15
00:00:44,700 --> 00:00:50,969
information security and IT security for

16
00:00:47,100 --> 00:00:53,579
a few years now that's my twitter name

17
00:00:50,969 --> 00:00:55,379
and email address in case you have any

18
00:00:53,579 --> 00:00:58,859
anything to say to me hmm

19
00:00:55,379 --> 00:01:00,960
I work as a security security architect

20
00:00:58,859 --> 00:01:03,899
although in the past I've done many

21
00:01:00,960 --> 00:01:07,500
different things in incident responder

22
00:01:03,899 --> 00:01:09,780
on forensics I was briefly a pen tester

23
00:01:07,500 --> 00:01:12,330
for for few months but I didn't really

24
00:01:09,780 --> 00:01:14,130
like it I was too slow at it so I

25
00:01:12,330 --> 00:01:15,740
thought it would be better at there you

26
00:01:14,130 --> 00:01:19,530
know they're really intelligent people

27
00:01:15,740 --> 00:01:21,030
deleting stuff so but these days I'm

28
00:01:19,530 --> 00:01:26,689
doing mostly security architect

29
00:01:21,030 --> 00:01:29,430
architecture and an advisory so why

30
00:01:26,689 --> 00:01:30,929
monitor anything I mean if you have a

31
00:01:29,430 --> 00:01:33,780
security background it's probably a

32
00:01:30,930 --> 00:01:35,250
stupid question to ask I mean what why

33
00:01:33,780 --> 00:01:38,100
monitor anything of course you need to

34
00:01:35,250 --> 00:01:42,540
monitor everything you need to be able

35
00:01:38,100 --> 00:01:45,509
to to detect attacks or incidents or

36
00:01:42,540 --> 00:01:48,000
threats in a reactive way potentially

37
00:01:45,509 --> 00:01:50,700
even in a proactive way if you if you

38
00:01:48,000 --> 00:01:53,759
have if you have the free time to do it

39
00:01:50,700 --> 00:01:55,710
and and you have the skill set and and

40
00:01:53,759 --> 00:01:56,909
the tool set to do practice threat

41
00:01:55,710 --> 00:01:59,789
hunting

42
00:01:56,909 --> 00:02:02,969
if you want to do any kind of incident

43
00:01:59,790 --> 00:02:05,850
response or forensics obviously you need

44
00:02:02,969 --> 00:02:08,579
to have some some proper monitoring some

45
00:02:05,850 --> 00:02:11,970
ideally some logs and plus other other

46
00:02:08,580 --> 00:02:13,680
information related to the practice rat

47
00:02:11,970 --> 00:02:15,599
hunting anything related

48
00:02:13,680 --> 00:02:18,659
data mining anomaly detection building

49
00:02:15,599 --> 00:02:19,649
baselines and and detecting deviations

50
00:02:18,659 --> 00:02:22,290
from it

51
00:02:19,650 --> 00:02:24,629
you-you-you need a unique historical

52
00:02:22,290 --> 00:02:26,939
data and I mean they can come in in

53
00:02:24,629 --> 00:02:29,730
different forms but logs are usually a

54
00:02:26,939 --> 00:02:33,120
part of it especially when we're talking

55
00:02:29,730 --> 00:02:36,510
about performance metrics like through

56
00:02:33,120 --> 00:02:40,200
pools or CPU usage and other things like

57
00:02:36,510 --> 00:02:42,450
that everyone at some point in their

58
00:02:40,200 --> 00:02:45,629
professional lives needs to do reporting

59
00:02:42,450 --> 00:02:47,608
and contribute to dashboards if you

60
00:02:45,629 --> 00:02:52,950
don't you're in a good place don't

61
00:02:47,609 --> 00:02:57,209
change your job reporting to management

62
00:02:52,950 --> 00:02:59,819
for example on activity incidence

63
00:02:57,209 --> 00:03:02,489
performance etc it usually requires some

64
00:02:59,819 --> 00:03:05,399
having some kind of log monitoring of

65
00:03:02,489 --> 00:03:07,019
course there's policy and regulatory

66
00:03:05,400 --> 00:03:09,599
requirements for example if you're

67
00:03:07,019 --> 00:03:11,939
subject to PCI PCI D and then obviously

68
00:03:09,599 --> 00:03:14,159
you need not only to monitor things but

69
00:03:11,939 --> 00:03:16,379
you also have to look at the things

70
00:03:14,159 --> 00:03:18,569
you're monitoring which is it's one of

71
00:03:16,379 --> 00:03:21,569
the requirements and of course anything

72
00:03:18,569 --> 00:03:25,048
related to even non security related

73
00:03:21,569 --> 00:03:26,879
related activities such as glucose root

74
00:03:25,049 --> 00:03:31,109
cause analysis and troubleshooting of

75
00:03:26,879 --> 00:03:32,698
any application or system helps so but

76
00:03:31,109 --> 00:03:37,049
the thing is there are many reasons to

77
00:03:32,699 --> 00:03:38,939
monitor to do log monitoring but not for

78
00:03:37,049 --> 00:03:41,280
every reason you need the same kind of

79
00:03:38,939 --> 00:03:43,709
detail you need the same kind of logs

80
00:03:41,280 --> 00:03:45,959
for example if you if you only concern

81
00:03:43,709 --> 00:03:47,759
is regulatory requirements you probably

82
00:03:45,959 --> 00:03:49,379
should if it's the only thing you should

83
00:03:47,759 --> 00:03:53,399
probably stick to whatever they're

84
00:03:49,379 --> 00:03:55,138
asking of you and not try to go beyond

85
00:03:53,400 --> 00:03:56,729
that but of course if you're serious

86
00:03:55,139 --> 00:03:59,489
about threat detection whether it's

87
00:03:56,729 --> 00:04:01,650
reactive or proactive and doing Incident

88
00:03:59,489 --> 00:04:05,250
Response and then you need obviously a

89
00:04:01,650 --> 00:04:11,699
bit more so what the monitor ideally

90
00:04:05,250 --> 00:04:14,970
everything anything not everything is is

91
00:04:11,699 --> 00:04:16,949
able to be monitored monitoring

92
00:04:14,970 --> 00:04:20,039
everything might be expensive the

93
00:04:16,949 --> 00:04:21,359
depending on on the size of the of the

94
00:04:20,039 --> 00:04:23,820
infrastructure or the applications

95
00:04:21,358 --> 00:04:27,270
you're monitoring it might be expensive

96
00:04:23,820 --> 00:04:30,539
due to storage requirements

97
00:04:27,270 --> 00:04:32,818
some logs I mean it's technically

98
00:04:30,539 --> 00:04:35,818
possible to get logs for certain things

99
00:04:32,819 --> 00:04:38,520
but maybe there you cannot make sense of

100
00:04:35,819 --> 00:04:42,060
it or they are not really useful or you

101
00:04:38,520 --> 00:04:43,740
know nobody knows what it means and of

102
00:04:42,060 --> 00:04:45,599
course you need to have the I mean the

103
00:04:43,740 --> 00:04:48,180
ability to use them you need to have the

104
00:04:45,599 --> 00:04:51,419
tools or the skills or the time or and

105
00:04:48,180 --> 00:04:55,380
the motivation to use those logs for

106
00:04:51,419 --> 00:04:56,880
whatever reason so a the idea is to come

107
00:04:55,380 --> 00:04:59,520
up with a list of priorities and say

108
00:04:56,880 --> 00:05:01,949
okay if we want to have third detection

109
00:04:59,520 --> 00:05:05,008
what's the minimum logs that we need and

110
00:05:01,949 --> 00:05:08,070
go for it and then you know maybe do it

111
00:05:05,009 --> 00:05:09,240
in in stages and eventually get to the

112
00:05:08,070 --> 00:05:11,130
point where you are monitoring

113
00:05:09,240 --> 00:05:14,039
everything you need when you we're

114
00:05:11,130 --> 00:05:18,210
talking about threat detection whether

115
00:05:14,039 --> 00:05:20,610
is its proactive or reactive I find it

116
00:05:18,210 --> 00:05:23,460
useful to to look at the kill chain

117
00:05:20,610 --> 00:05:25,229
model you know this one is from Dell

118
00:05:23,460 --> 00:05:27,388
SecureWorks there are many different

119
00:05:25,229 --> 00:05:29,818
ones and they deal they look similar I

120
00:05:27,389 --> 00:05:32,159
like this one because it's a bit more

121
00:05:29,819 --> 00:05:38,220
granular than the rest at the scene and

122
00:05:32,159 --> 00:05:40,289
and they you know you can actually model

123
00:05:38,220 --> 00:05:42,979
it depending on the threat type whether

124
00:05:40,289 --> 00:05:46,500
it's a commodity threat or a PT or

125
00:05:42,979 --> 00:05:47,729
whatever just disclaimers to work with

126
00:05:46,500 --> 00:05:51,150
secure works in the past but that

127
00:05:47,729 --> 00:05:53,449
doesn't mean I'm favoring this this kill

128
00:05:51,150 --> 00:05:56,820
chain model because because of that so

129
00:05:53,449 --> 00:05:58,919
so it's it's important to to have this

130
00:05:56,820 --> 00:06:01,830
this model or a similar model in mind

131
00:05:58,919 --> 00:06:04,889
when when deciding what to log because

132
00:06:01,830 --> 00:06:06,810
for every step I mean not forever you

133
00:06:04,889 --> 00:06:10,759
cannot really monitor for every step

134
00:06:06,810 --> 00:06:15,270
there are things like the adversary is

135
00:06:10,759 --> 00:06:17,909
creating exploit before after doing

136
00:06:15,270 --> 00:06:20,520
recon about before trying to infect you

137
00:06:17,909 --> 00:06:23,759
or trying to infiltrate you that part is

138
00:06:20,520 --> 00:06:25,109
outside your your stated outside of your

139
00:06:23,759 --> 00:06:27,750
scope and you cannot do anything about

140
00:06:25,110 --> 00:06:29,039
it but for most things happening inside

141
00:06:27,750 --> 00:06:32,190
your perimeter you can do something

142
00:06:29,039 --> 00:06:35,460
about it and if you know the useful ways

143
00:06:32,190 --> 00:06:37,289
that adversaries act for every step of

144
00:06:35,460 --> 00:06:40,109
the kill chain you can you can make a

145
00:06:37,289 --> 00:06:41,580
list of you know what what's a good look

146
00:06:40,110 --> 00:06:45,450
to have

147
00:06:41,580 --> 00:06:47,280
what's a good tool to monitor to be able

148
00:06:45,450 --> 00:06:49,890
to get information for that step of the

149
00:06:47,280 --> 00:06:53,159
kill chain so it's it's it's a nice way

150
00:06:49,890 --> 00:06:56,490
of structuring your your priorities when

151
00:06:53,160 --> 00:06:59,820
deciding or creating a login plan so

152
00:06:56,490 --> 00:07:01,410
simplifying the kill chain we have recon

153
00:06:59,820 --> 00:07:03,240
delivery exploitation installation

154
00:07:01,410 --> 00:07:05,100
actions on target this is just a

155
00:07:03,240 --> 00:07:08,490
collapsed version of the one in the

156
00:07:05,100 --> 00:07:10,200
previous slide and then this is the

157
00:07:08,490 --> 00:07:13,230
generic one this is not specific to

158
00:07:10,200 --> 00:07:15,450
cloud services or pass or yes or as your

159
00:07:13,230 --> 00:07:17,970
AWS or whatever this is just a generic

160
00:07:15,450 --> 00:07:20,430
one and and these are the typical things

161
00:07:17,970 --> 00:07:22,800
you you look at I mean for example for

162
00:07:20,430 --> 00:07:25,620
delivery use of vectors are inbound

163
00:07:22,800 --> 00:07:27,510
email web browsing removable media and

164
00:07:25,620 --> 00:07:30,150
people with credentials or people

165
00:07:27,510 --> 00:07:33,210
exploiting a vulnerability in internal

166
00:07:30,150 --> 00:07:37,130
facing service however when we were

167
00:07:33,210 --> 00:07:41,310
talking about AWS or assure or any other

168
00:07:37,130 --> 00:07:44,250
cloud infrastructure provider not

169
00:07:41,310 --> 00:07:46,320
everything is relevant for example all

170
00:07:44,250 --> 00:07:48,810
everything to do with user interaction

171
00:07:46,320 --> 00:07:50,969
and user interaction such as inbound

172
00:07:48,810 --> 00:07:53,460
email web browsing removable media

173
00:07:50,970 --> 00:07:56,790
doesn't really apply or just doesn't

174
00:07:53,460 --> 00:07:59,250
typically apply so there's a number of

175
00:07:56,790 --> 00:08:02,640
things you can monitor but not

176
00:07:59,250 --> 00:08:04,290
everything so it actually simplifies in

177
00:08:02,640 --> 00:08:06,539
a way it simplifies the the kind of

178
00:08:04,290 --> 00:08:08,700
information you need but you will find

179
00:08:06,540 --> 00:08:10,620
that most cloud providers they don't

180
00:08:08,700 --> 00:08:12,840
give you everything else so there's

181
00:08:10,620 --> 00:08:17,940
really a gap on on what you can do with

182
00:08:12,840 --> 00:08:20,940
it so also there's the issue of of the

183
00:08:17,940 --> 00:08:24,420
share responsibility model for a is and

184
00:08:20,940 --> 00:08:26,100
pass this is the and the one left is the

185
00:08:24,420 --> 00:08:31,230
one from Microsoft the one on the right

186
00:08:26,100 --> 00:08:35,040
it's from Amazon basically they they

187
00:08:31,230 --> 00:08:37,470
take care of part of all the activities

188
00:08:35,039 --> 00:08:40,079
or all the aspects of the infrastructure

189
00:08:37,470 --> 00:08:42,840
and you need to take care of everything

190
00:08:40,080 --> 00:08:46,410
else so depending on if you look at the

191
00:08:42,840 --> 00:08:52,080
model on the Left if you look at pass or

192
00:08:46,410 --> 00:08:55,329
SAS or ayahs you know the level of two

193
00:08:52,080 --> 00:08:57,250
the threshold between what you have to

194
00:08:55,330 --> 00:09:00,060
take care of and what the provider takes

195
00:08:57,250 --> 00:09:02,820
care of a changes so typically in ayahs

196
00:09:00,060 --> 00:09:05,290
you need to do more things you're

197
00:09:02,820 --> 00:09:09,490
responsible for more things in case of

198
00:09:05,290 --> 00:09:11,560
pure SAS it's really about a user access

199
00:09:09,490 --> 00:09:13,030
and Identity Management and littles you

200
00:09:11,560 --> 00:09:14,829
can do I mean you cannot do patching you

201
00:09:13,030 --> 00:09:18,390
can monitor innovation infrastructure

202
00:09:14,830 --> 00:09:20,710
it's possibly multi-tenant and and

203
00:09:18,390 --> 00:09:22,990
there's nothing you can do and then you

204
00:09:20,710 --> 00:09:25,500
need to trust the provider that they're

205
00:09:22,990 --> 00:09:29,320
doing the things they they say they do

206
00:09:25,500 --> 00:09:31,060
so the the amount of things you can log

207
00:09:29,320 --> 00:09:34,470
and monitor will depend whether we're

208
00:09:31,060 --> 00:09:37,060
talking about ayahs or path of course

209
00:09:34,470 --> 00:09:39,460
what's good to monitor in cloud

210
00:09:37,060 --> 00:09:43,660
environments of course if you have any

211
00:09:39,460 --> 00:09:47,800
virtual machines any is instances or

212
00:09:43,660 --> 00:09:49,689
worker roles you can you should monitor

213
00:09:47,800 --> 00:09:51,880
operating system logs and I mean that's

214
00:09:49,690 --> 00:09:53,950
like traditional monitoring you you

215
00:09:51,880 --> 00:09:57,189
could log from Windows Linux or whatever

216
00:09:53,950 --> 00:10:03,030
anything also coming from web servers

217
00:09:57,190 --> 00:10:03,030
databases and other application layer

218
00:10:03,330 --> 00:10:10,210
software then you should monitor it to

219
00:10:06,130 --> 00:10:12,760
if you can performance metrics are maybe

220
00:10:10,210 --> 00:10:15,610
not so relevant from the point of view

221
00:10:12,760 --> 00:10:20,980
of security such as things like CPU

222
00:10:15,610 --> 00:10:23,020
memory through pods etc but if you have

223
00:10:20,980 --> 00:10:26,440
it and you have a storage for it you

224
00:10:23,020 --> 00:10:28,540
might be able to to baseline the

225
00:10:26,440 --> 00:10:30,490
activity of your of your systems and you

226
00:10:28,540 --> 00:10:32,530
can detect deviations like could

227
00:10:30,490 --> 00:10:36,280
correspond to denial of service attacks

228
00:10:32,530 --> 00:10:38,319
or someone exfiltrate information from

229
00:10:36,280 --> 00:10:44,230
your database because and then suddenly

230
00:10:38,320 --> 00:10:48,070
the outgoing network throughput is too

231
00:10:44,230 --> 00:10:50,590
high or peaking and then you need to do

232
00:10:48,070 --> 00:10:52,660
something about it network traffic if

233
00:10:50,590 --> 00:10:54,910
you can not always possible and

234
00:10:52,660 --> 00:10:57,160
sometimes if you can do it at the

235
00:10:54,910 --> 00:10:59,319
interface level or across across

236
00:10:57,160 --> 00:11:00,910
boundaries such as a network security

237
00:10:59,320 --> 00:11:02,800
group between subnets and things like

238
00:11:00,910 --> 00:11:05,639
that if you can monitor it then it's

239
00:11:02,800 --> 00:11:09,128
really a good source of information

240
00:11:05,639 --> 00:11:12,759
any other solutions you deploy on Azure

241
00:11:09,129 --> 00:11:15,639
or AWS such as Wow or AV or file

242
00:11:12,759 --> 00:11:17,170
integrity monitoring or IDS's if you're

243
00:11:15,639 --> 00:11:20,649
deploying that I mean it's tricky to

244
00:11:17,170 --> 00:11:23,349
deploy ideas in or IPSS in in cloud but

245
00:11:20,649 --> 00:11:24,910
if any any security solution you're

246
00:11:23,350 --> 00:11:28,749
deploying of course you need to get the

247
00:11:24,910 --> 00:11:31,569
logs anything generated by the vendor or

248
00:11:28,749 --> 00:11:35,619
the provider itself all the management

249
00:11:31,569 --> 00:11:38,799
log service fabric logs I user access to

250
00:11:35,619 --> 00:11:41,019
the to the management portal or usage of

251
00:11:38,799 --> 00:11:43,029
the API or the command line tools or

252
00:11:41,019 --> 00:11:47,649
whatever anything anything you can get

253
00:11:43,029 --> 00:11:50,769
especially related to authentication

254
00:11:47,649 --> 00:11:53,559
that that's usually interesting and then

255
00:11:50,769 --> 00:11:58,600
blob storage or stream in the case of

256
00:11:53,559 --> 00:12:02,858
AWS you know access to critical storage

257
00:11:58,600 --> 00:12:05,230
pockets is usually very very useful also

258
00:12:02,859 --> 00:12:08,889
at the fact that many many of the

259
00:12:05,230 --> 00:12:10,929
providers seem to lock things to blob

260
00:12:08,889 --> 00:12:14,459
storage or s3 so you need to be able to

261
00:12:10,929 --> 00:12:18,369
get information from there too so for

262
00:12:14,459 --> 00:12:21,069
AWS there's a number of options we can

263
00:12:18,369 --> 00:12:21,730
monitor this cloud trail there's cloud

264
00:12:21,069 --> 00:12:26,349
watch

265
00:12:21,730 --> 00:12:28,749
there's VPC flow logs and so on I'm not

266
00:12:26,350 --> 00:12:33,819
going to read the whole thing but

267
00:12:28,749 --> 00:12:37,059
basically in its the different

268
00:12:33,819 --> 00:12:42,719
mechanisms that AWS uses to provide you

269
00:12:37,059 --> 00:12:45,939
with with activity monitoring there's

270
00:12:42,720 --> 00:12:49,389
it's not I mean if you're familiar with

271
00:12:45,939 --> 00:12:51,699
AWS it's not they don't have a really a

272
00:12:49,389 --> 00:12:53,799
unified system of pulling everything

273
00:12:51,699 --> 00:12:57,219
into into one place it's a similar thing

274
00:12:53,799 --> 00:12:59,410
with other with other providers but if

275
00:12:57,220 --> 00:13:02,829
you can get cloud trail and cloud watch

276
00:12:59,410 --> 00:13:04,689
and VPC flow logs and VPC will flow to

277
00:13:02,829 --> 00:13:08,128
cloud watch and then possibly you can

278
00:13:04,689 --> 00:13:10,089
forward that to s3 storage blob then

279
00:13:08,129 --> 00:13:12,399
that that's a good thing I mean the

280
00:13:10,089 --> 00:13:14,169
ideas ideally you want everything in one

281
00:13:12,399 --> 00:13:18,230
place so you can pull it from a third

282
00:13:14,169 --> 00:13:22,550
party tool cloud trail is

283
00:13:18,230 --> 00:13:24,590
easy as just configuring configuring it

284
00:13:22,550 --> 00:13:28,430
and an especially finalized three bucket

285
00:13:24,590 --> 00:13:29,900
to put the logs into it and and then all

286
00:13:28,430 --> 00:13:33,290
the logs will automatically start

287
00:13:29,900 --> 00:13:36,079
flowing into into these files they they

288
00:13:33,290 --> 00:13:38,140
end up in the s3 bucket you can use it

289
00:13:36,080 --> 00:13:40,120
directly from there but that's not very

290
00:13:38,140 --> 00:13:42,560
convenient

291
00:13:40,120 --> 00:13:44,990
normally you would want to pull those

292
00:13:42,560 --> 00:13:46,880
those files and ingest them into some a

293
00:13:44,990 --> 00:13:50,900
sim tool or lock my I'm a lock

294
00:13:46,880 --> 00:13:54,140
management tool or whatever if you look

295
00:13:50,900 --> 00:13:57,860
at this this is the content of one of

296
00:13:54,140 --> 00:13:59,390
the JSON decide files this is the kind

297
00:13:57,860 --> 00:14:02,270
of information you see so it's you can

298
00:13:59,390 --> 00:14:04,880
see it's JSON format and if you you want

299
00:14:02,270 --> 00:14:09,310
to maybe you need to convert it to

300
00:14:04,880 --> 00:14:12,830
syslog or or CEF or whatever it's your

301
00:14:09,310 --> 00:14:14,300
sim tool uses and then either there's a

302
00:14:12,830 --> 00:14:16,520
connector or you have to write it

303
00:14:14,300 --> 00:14:18,709
yourself using I mean this simple Python

304
00:14:16,520 --> 00:14:22,760
script can convert this tool into into

305
00:14:18,710 --> 00:14:26,390
anything VPC it's very useful basically

306
00:14:22,760 --> 00:14:28,040
it it will give you all the net flow

307
00:14:26,390 --> 00:14:34,100
information or net flow like information

308
00:14:28,040 --> 00:14:37,310
in your virtual private network in AWS

309
00:14:34,100 --> 00:14:39,740
and you just need to configure it this

310
00:14:37,310 --> 00:14:42,199
time instead of going to cloud trail it

311
00:14:39,740 --> 00:14:44,770
goes to to cloud watch so you have to

312
00:14:42,200 --> 00:14:47,840
watch it from there but again this is

313
00:14:44,770 --> 00:14:49,760
this is easily forwardable to to some

314
00:14:47,840 --> 00:14:52,940
some other place um as three backup so

315
00:14:49,760 --> 00:14:55,100
you can pull it from a sim - so you can

316
00:14:52,940 --> 00:14:58,580
see there you would see any accept and

317
00:14:55,100 --> 00:15:00,920
reject network logs that might be useful

318
00:14:58,580 --> 00:15:04,760
for troubleshooting or determining and

319
00:15:00,920 --> 00:15:07,040
an incident or whatever there's a

320
00:15:04,760 --> 00:15:09,890
additional tools you can you can use if

321
00:15:07,040 --> 00:15:13,579
you want to once you enable all the logs

322
00:15:09,890 --> 00:15:17,380
you can try to put everything in one

323
00:15:13,580 --> 00:15:21,140
place and then having a nice nice tool

324
00:15:17,380 --> 00:15:23,360
sim tool or retention lock management

325
00:15:21,140 --> 00:15:26,420
tool where their own premises or in the

326
00:15:23,360 --> 00:15:30,860
cloud or access providers as a service

327
00:15:26,420 --> 00:15:31,910
from from the vendor itself I I have a

328
00:15:30,860 --> 00:15:34,660
list here that

329
00:15:31,910 --> 00:15:38,030
doesn't mean that these are better than

330
00:15:34,660 --> 00:15:40,089
others just just the ones I know the

331
00:15:38,030 --> 00:15:42,199
ones I've used so I'm not really

332
00:15:40,090 --> 00:15:44,930
endorsing any or any of them

333
00:15:42,200 --> 00:15:46,520
commercially but things like Zuma logic

334
00:15:44,930 --> 00:15:51,920
or Splunk

335
00:15:46,520 --> 00:15:54,430
for AWS or ALK a will typically do the

336
00:15:51,920 --> 00:15:57,860
trick and there's there's more of course

337
00:15:54,430 --> 00:15:59,719
for sure we're going to go into a show

338
00:15:57,860 --> 00:16:03,350
for a moment but basically we have the

339
00:15:59,720 --> 00:16:06,980
same the same kind of tools except I've

340
00:16:03,350 --> 00:16:08,720
added one which is a native tool which

341
00:16:06,980 --> 00:16:11,060
is actually log analytics which is part

342
00:16:08,720 --> 00:16:13,820
of OMS this is this is something you can

343
00:16:11,060 --> 00:16:15,709
you can enable on the shore as your

344
00:16:13,820 --> 00:16:17,960
subscription and it will automatically

345
00:16:15,710 --> 00:16:20,720
start collecting all the information for

346
00:16:17,960 --> 00:16:22,520
Windows and Linux you need to install an

347
00:16:20,720 --> 00:16:25,730
agent on the virtual machines and then

348
00:16:22,520 --> 00:16:28,790
it will start collecting logs and and

349
00:16:25,730 --> 00:16:32,270
giving you really actionable information

350
00:16:28,790 --> 00:16:36,230
on the state or the status of the of the

351
00:16:32,270 --> 00:16:38,990
virtual infrastructure what other sim

352
00:16:36,230 --> 00:16:43,700
tools we can we can use there are

353
00:16:38,990 --> 00:16:47,570
connectors for people like oxide HP

354
00:16:43,700 --> 00:16:51,350
arcsight or HPE ArcSight whatever the

355
00:16:47,570 --> 00:16:53,570
name is these days and there's it's a

356
00:16:51,350 --> 00:16:55,400
really flexible tool you can deploy it

357
00:16:53,570 --> 00:16:57,080
in many different ways this is just one

358
00:16:55,400 --> 00:17:00,680
option where you can deploy the

359
00:16:57,080 --> 00:17:04,670
connector to to the cloud instances and

360
00:17:00,680 --> 00:17:07,849
our cloud subnets and then pull all the

361
00:17:04,670 --> 00:17:11,090
logs together and send it to to the ARC

362
00:17:07,849 --> 00:17:13,280
side yes M on-premises this of course

363
00:17:11,089 --> 00:17:15,260
means that you need to open a port for

364
00:17:13,280 --> 00:17:17,690
inbound connections into the sm and

365
00:17:15,260 --> 00:17:19,879
maybe this something against your

366
00:17:17,690 --> 00:17:22,910
security architecture principles maybe

367
00:17:19,880 --> 00:17:25,220
but there's a there's different options

368
00:17:22,910 --> 00:17:29,240
you can put a logger a DSM in the cloud

369
00:17:25,220 --> 00:17:34,700
to or using VPNs whatever I mean there's

370
00:17:29,240 --> 00:17:37,130
it's very very flexible to deploy QRadar

371
00:17:34,700 --> 00:17:38,510
is also one which is very simple to

372
00:17:37,130 --> 00:17:40,880
deploy so if you have cube rather

373
00:17:38,510 --> 00:17:43,220
already there are connectors for for

374
00:17:40,880 --> 00:17:45,460
example AWS you just need to configure

375
00:17:43,220 --> 00:17:47,620
the s3 bucket and credential

376
00:17:45,460 --> 00:17:51,070
and then we'll stop pull pull in every

377
00:17:47,620 --> 00:17:53,610
log which is stored in this s3 bucket

378
00:17:51,070 --> 00:17:53,610
from AWS

379
00:17:54,179 --> 00:18:03,279
Splunk it's basically the same thing so

380
00:18:01,090 --> 00:18:07,270
if you have Splunk either Splunk light

381
00:18:03,279 --> 00:18:09,730
or Splunk sorry Splunk enterprise you

382
00:18:07,270 --> 00:18:11,860
can deploy this blank for AWS app and

383
00:18:09,730 --> 00:18:13,750
the Splunk add-on for Amazon Web

384
00:18:11,860 --> 00:18:15,729
Services that you would think it's the

385
00:18:13,750 --> 00:18:19,330
same thing but actually you need both

386
00:18:15,730 --> 00:18:22,480
for one one of them provides dashboard

387
00:18:19,330 --> 00:18:25,418
and reports and queries and so on and

388
00:18:22,480 --> 00:18:27,850
the other one provides to the the

389
00:18:25,419 --> 00:18:29,649
communication for understanding and

390
00:18:27,850 --> 00:18:34,178
collecting and understanding the logs

391
00:18:29,649 --> 00:18:38,408
coming from AWS so basically the way it

392
00:18:34,179 --> 00:18:43,360
works is it collects events from a SQS

393
00:18:38,409 --> 00:18:46,240
queue in AWS that subscribes to NS and

394
00:18:43,360 --> 00:18:48,250
notification service from AWS config so

395
00:18:46,240 --> 00:18:50,950
the actual like the actual configuration

396
00:18:48,250 --> 00:18:53,890
and AWS before you can even pull the

397
00:18:50,950 --> 00:18:55,929
logs into Splunk is it's a bit involved

398
00:18:53,890 --> 00:18:58,570
but I mean it's something can be done in

399
00:18:55,929 --> 00:19:00,340
a few days if you're careful and don't

400
00:18:58,570 --> 00:19:05,490
skip any any of the steps and getting

401
00:19:00,340 --> 00:19:05,490
the permissions right and everything so

402
00:19:07,049 --> 00:19:13,899
yeah okay

403
00:19:09,179 --> 00:19:15,850
same basically same thing I mean I've

404
00:19:13,899 --> 00:19:20,199
used the one which is offered as a

405
00:19:15,850 --> 00:19:22,299
service by log file and Jesus selecting

406
00:19:20,200 --> 00:19:24,850
from the kind of technology used that

407
00:19:22,299 --> 00:19:27,279
you select a sewer or AWS or whatever

408
00:19:24,850 --> 00:19:30,299
and then it will it will give you a ways

409
00:19:27,279 --> 00:19:34,419
of connecting to s3 buckets or TTC flow

410
00:19:30,299 --> 00:19:37,899
and things like that and same thing for

411
00:19:34,419 --> 00:19:39,490
same thing for sure so it's really once

412
00:19:37,899 --> 00:19:42,820
you have it up and running connecting to

413
00:19:39,490 --> 00:19:46,630
to the cloud than provider to to get the

414
00:19:42,820 --> 00:19:48,700
locks it's quite easy so this is just a

415
00:19:46,630 --> 00:19:54,789
an example of collecting things from

416
00:19:48,700 --> 00:19:57,010
from s3 for sure we have everything with

417
00:19:54,789 --> 00:19:58,990
copper so far so you can use oxide you

418
00:19:57,010 --> 00:20:02,679
can use cube radar you can use spline

419
00:19:58,990 --> 00:20:05,950
you can use lk all of them work there's

420
00:20:02,679 --> 00:20:09,130
one nice thing that Microsoft released a

421
00:20:05,950 --> 00:20:11,260
few weeks or months ago is I think it's

422
00:20:09,130 --> 00:20:13,450
Celine in public preview which is the

423
00:20:11,260 --> 00:20:14,890
same integrator so it's really a piece

424
00:20:13,450 --> 00:20:18,490
of software you can download it install

425
00:20:14,890 --> 00:20:20,920
it on a on a Windows machine and if you

426
00:20:18,490 --> 00:20:23,290
give it credentials it will connect to

427
00:20:20,920 --> 00:20:26,500
the cloud and pull the logs I into a

428
00:20:23,290 --> 00:20:29,770
folder in JSON format and then if in the

429
00:20:26,500 --> 00:20:35,050
same server same machine or whatever you

430
00:20:29,770 --> 00:20:39,000
install the your sim windows collector

431
00:20:35,050 --> 00:20:43,389
agent then you can able pull logs so

432
00:20:39,000 --> 00:20:46,480
basically you deploy it's called as log

433
00:20:43,390 --> 00:20:48,429
integrator on a Windows Server you

434
00:20:46,480 --> 00:20:52,120
install either Splunk on Universal for

435
00:20:48,429 --> 00:20:55,840
water or oxide even collector or curator

436
00:20:52,120 --> 00:20:57,669
windows collect and it will you know it

437
00:20:55,840 --> 00:20:59,649
will just pull the logs into folder and

438
00:20:57,670 --> 00:21:01,390
the agent the same agent will collect

439
00:20:59,650 --> 00:21:03,420
those logs and and convert it to

440
00:21:01,390 --> 00:21:06,940
whatever format it's needed for they

441
00:21:03,420 --> 00:21:11,080
seem to ingest it so there is a nice

442
00:21:06,940 --> 00:21:12,670
blog post at MSDN describing all the

443
00:21:11,080 --> 00:21:13,240
different options and how to configure

444
00:21:12,670 --> 00:21:16,420
it for

445
00:21:13,240 --> 00:21:18,820
arcsight Splunk and cube Raider I'm sure

446
00:21:16,420 --> 00:21:22,420
you can do the same for I mean once you

447
00:21:18,820 --> 00:21:25,330
have the logs in the folder in JSON

448
00:21:22,420 --> 00:21:27,070
format it's I mean if your same of

449
00:21:25,330 --> 00:21:30,490
choice is not supported it's very easy

450
00:21:27,070 --> 00:21:32,620
to to create to create an agent or to

451
00:21:30,490 --> 00:21:35,890
create a parser to convert it to

452
00:21:32,620 --> 00:21:37,899
whatever you need doesn't seem to be

453
00:21:35,890 --> 00:21:41,290
very efficient in terms of performance

454
00:21:37,900 --> 00:21:45,520
I've seen that you need eight cores to

455
00:21:41,290 --> 00:21:48,159
get less than 300 events per second so I

456
00:21:45,520 --> 00:21:53,139
mean it depends on on the years the size

457
00:21:48,160 --> 00:21:55,990
of your infrastructure but it might you

458
00:21:53,140 --> 00:21:59,020
might need more than more than one agent

459
00:21:55,990 --> 00:22:03,400
if if you are you generating lots of

460
00:21:59,020 --> 00:22:07,330
logs so this is basically how it's done

461
00:22:03,400 --> 00:22:11,169
you configure in sure you go to the to

462
00:22:07,330 --> 00:22:12,879
the virtual machines and select the

463
00:22:11,169 --> 00:22:15,610
diagnostic settings

464
00:22:12,880 --> 00:22:19,120
the logs you you want to export and the

465
00:22:15,610 --> 00:22:21,570
storage account where they go then on

466
00:22:19,120 --> 00:22:25,570
the server were you were you install the

467
00:22:21,570 --> 00:22:28,389
as log integrator and seems sim agent

468
00:22:25,570 --> 00:22:29,950
then you just provided the credentials

469
00:22:28,390 --> 00:22:31,690
don't worry about the credentials that

470
00:22:29,950 --> 00:22:35,230
that's cropped image so that's not a

471
00:22:31,690 --> 00:22:39,400
full string so don't bother taking

472
00:22:35,230 --> 00:22:41,490
pictures of it and and then you just you

473
00:22:39,400 --> 00:22:45,670
just tell in this this example this is

474
00:22:41,490 --> 00:22:48,640
Splunk agent just tell them well folder

475
00:22:45,670 --> 00:22:51,130
is with logs and restarts blanc and and

476
00:22:48,640 --> 00:22:53,680
then you start seeing the logs in Splunk

477
00:22:51,130 --> 00:22:56,230
sorry it takes literally ten minutes to

478
00:22:53,680 --> 00:23:00,130
pull the logs into Splunk once you want

479
00:22:56,230 --> 00:23:03,130
to use the the agent interesting things

480
00:23:00,130 --> 00:23:07,120
to have one your doing monitoring having

481
00:23:03,130 --> 00:23:09,160
good i you see threat Intel feeds can be

482
00:23:07,120 --> 00:23:11,709
very very very useful if you're doing

483
00:23:09,160 --> 00:23:15,250
incident response and reactive or

484
00:23:11,710 --> 00:23:19,180
practice threat detection because you

485
00:23:15,250 --> 00:23:21,160
can you can pull the the threat in to

486
00:23:19,180 --> 00:23:24,880
feed into your sim tool and it will

487
00:23:21,160 --> 00:23:26,860
start tagging IPS or host names or

488
00:23:24,880 --> 00:23:28,450
hashes or file names or whatever it's

489
00:23:26,860 --> 00:23:30,760
there that much is one of the indicators

490
00:23:28,450 --> 00:23:33,790
of compromised and then you can quickly

491
00:23:30,760 --> 00:23:36,550
run queries or reports to to look for

492
00:23:33,790 --> 00:23:39,820
suspicious activity so if you have one

493
00:23:36,550 --> 00:23:42,730
or more into feeds then that's that's a

494
00:23:39,820 --> 00:23:45,580
really good thing to have for increased

495
00:23:42,730 --> 00:23:48,580
value if you you're willing to go that

496
00:23:45,580 --> 00:23:52,449
extra maturity step if you maintain your

497
00:23:48,580 --> 00:23:54,159
own threat or I IOC repository and and

498
00:23:52,450 --> 00:23:55,870
Inter feed then then that's very good

499
00:23:54,160 --> 00:23:58,120
because you can you can pull different

500
00:23:55,870 --> 00:24:00,760
feeds from different sources and and add

501
00:23:58,120 --> 00:24:03,669
your own and then share maybe with your

502
00:24:00,760 --> 00:24:05,260
peers or other companies or whatever

503
00:24:03,670 --> 00:24:09,880
sharing threat intelligence is always

504
00:24:05,260 --> 00:24:12,160
good and then lastly one one nice

505
00:24:09,880 --> 00:24:13,780
addition to monitoring things in the

506
00:24:12,160 --> 00:24:16,840
cloud especially for virtual machines

507
00:24:13,780 --> 00:24:19,030
not obviously not pass resources is

508
00:24:16,840 --> 00:24:21,429
having some kind of endpoint activity

509
00:24:19,030 --> 00:24:23,470
monitoring I'm thinking things like

510
00:24:21,430 --> 00:24:25,760
carbon block because it's the one I know

511
00:24:23,470 --> 00:24:28,040
but there is

512
00:24:25,760 --> 00:24:32,020
there's different solutions out there

513
00:24:28,040 --> 00:24:36,889
who which do similar things basically it

514
00:24:32,020 --> 00:24:39,080
it monitors the operating system for

515
00:24:36,890 --> 00:24:41,360
process activities or any process being

516
00:24:39,080 --> 00:24:43,550
create determinated or spawning child

517
00:24:41,360 --> 00:24:45,830
processors and so on and for every

518
00:24:43,550 --> 00:24:48,110
process what are they doing they write

519
00:24:45,830 --> 00:24:50,899
into the field file system are they

520
00:24:48,110 --> 00:24:54,080
changing system configuration knowledge

521
00:24:50,900 --> 00:24:55,670
or the registry or are they accepting or

522
00:24:54,080 --> 00:24:57,889
making network connections and it will

523
00:24:55,670 --> 00:25:01,160
keep the relationship between everything

524
00:24:57,890 --> 00:25:04,550
and then a for example column that can

525
00:25:01,160 --> 00:25:07,610
do 13 to feed integration so it will tag

526
00:25:04,550 --> 00:25:10,639
anything which matches indicator of

527
00:25:07,610 --> 00:25:12,139
compromise so you can really build you

528
00:25:10,640 --> 00:25:13,700
can go back in time it's like a flag

529
00:25:12,140 --> 00:25:14,990
recorder or black box from a plane

530
00:25:13,700 --> 00:25:16,790
except you know everything is in a

531
00:25:14,990 --> 00:25:18,470
central place you don't have to go look

532
00:25:16,790 --> 00:25:21,230
for it in mountains when when crosses

533
00:25:18,470 --> 00:25:23,750
and and and and then you can see the

534
00:25:21,230 --> 00:25:24,350
whole process tree at any point in the

535
00:25:23,750 --> 00:25:26,900
past

536
00:25:24,350 --> 00:25:30,139
typically for 60 or 90 days or whatever

537
00:25:26,900 --> 00:25:32,780
it is and the nice thing is I mean if

538
00:25:30,140 --> 00:25:35,870
this is a great forensic readiness tool

539
00:25:32,780 --> 00:25:39,170
for insulin response it must have a this

540
00:25:35,870 --> 00:25:41,570
one or something similar and then you

541
00:25:39,170 --> 00:25:45,920
can use the carbon black API or the

542
00:25:41,570 --> 00:25:47,960
whatever tool a API to integrate or some

543
00:25:45,920 --> 00:25:51,560
kind of manual integration so you can

544
00:25:47,960 --> 00:25:52,940
integrate your log solution with with

545
00:25:51,560 --> 00:25:54,950
the endpoint activity monitoring

546
00:25:52,940 --> 00:25:59,450
solution so that if you detect something

547
00:25:54,950 --> 00:26:02,900
you have a rule watching for specific

548
00:25:59,450 --> 00:26:05,450
logs or events you can query this too

549
00:26:02,900 --> 00:26:07,040
and say okay give me the process tree at

550
00:26:05,450 --> 00:26:10,010
that point two weeks ago for that

551
00:26:07,040 --> 00:26:12,830
endpoint and and flag me any any any

552
00:26:10,010 --> 00:26:15,830
connections to this IP or whatever so

553
00:26:12,830 --> 00:26:17,780
it's it's great for for incident

554
00:26:15,830 --> 00:26:21,320
response and and threat hunting and

555
00:26:17,780 --> 00:26:26,290
that's all I wanted to say I think just

556
00:26:21,320 --> 00:26:26,290
in in time so hope you like this

