1
00:00:00,070 --> 00:00:03,399
works for Travis I in the last few weeks
I

2
00:00:03,399 --> 00:00:07,200
what are the things that I crazy for
this conference I

3
00:00:07,200 --> 00:00:12,509
talks starting am what things are crazy
for this conference

4
00:00:12,509 --> 00:00:15,580
I'll was an eight stage for the Huntsman

5
00:00:15,580 --> 00:00:18,800
very loosely based on some clues that
agreement passed a mighty

6
00:00:18,800 --> 00:00:23,400
I missed results and the first two clues
are embedded in the firmware

7
00:00:23,400 --> 00:00:28,470
botch I but i've seen greater uptake in
VA third and further rounds because I

8
00:00:28,470 --> 00:00:30,390
guess people just don't know it's there

9
00:00:30,390 --> 00:00:33,820
and the issue is that it's only in the
be

10
00:00:33,820 --> 00:00:37,239
firmer by just correct yes if you look
at your badge

11
00:00:37,239 --> 00:00:40,390
and if you look at us said the serial
number and HB

12
00:00:40,390 --> 00:00:43,480
12 and you'll either have a BA or you
won't

13
00:00:43,480 --> 00:00:46,910
if you have a B don't the firmware over
J tyke

14
00:00:46,910 --> 00:00:50,230
on say you'll see the beginning of the
work I put in

15
00:00:50,230 --> 00:00:54,629
some fitzwater's if there was any
questions they're free to ask me if you

16
00:00:54,629 --> 00:00:55,280
asked for

17
00:00:55,280 --> 00:00:58,329
where his neck

18
00:00:58,329 --> 00:01:01,829
go get a beer

19
00:01:01,829 --> 00:01:08,659
never

20
00:01:08,659 --> 00:01:10,850
okay serve other a

21
00:01:10,850 --> 00:01:14,770
giving everybody a um be different than
the first day of

22
00:01:14,770 --> 00:01:19,369
Asher than alright this is my very good
and neighborly friend Travis Goodspeed

23
00:01:19,370 --> 00:01:22,540
who is responsible forward

24
00:01:22,540 --> 00:01:29,540
this awesome batch happening so just for
that given a round of applause

25
00:01:32,350 --> 00:01:36,000
if there's anything wrong with it I can
guarantee you it's not Travis this fall

26
00:01:36,000 --> 00:01:39,250
its next fall it's my fault everything
is my fault

27
00:01:39,250 --> 00:01:42,829
and because of that we're going to
demonstrate something that we've been

28
00:01:42,829 --> 00:01:44,079
spreading it harder cons

29
00:01:44,079 --> 00:01:47,689
all over the world it's a new protocol

30
00:01:47,689 --> 00:01:52,860
not know that that there but its if you
ever have been irreconcilable difference

31
00:01:52,860 --> 00:01:56,250
something that you know you're never
going to work out with somebody who you

32
00:01:56,250 --> 00:01:58,270
should remain on neighborly terms with

33
00:01:58,270 --> 00:02:01,350
you issue a fuck you packet

34
00:02:01,350 --> 00:02:05,500
like this fuck you neighbor and that

35
00:02:05,500 --> 00:02:09,380
to which there is a reply packet a fuck
you to neighbor Pacha

36
00:02:09,380 --> 00:02:12,980
so %uh suppose that Nick comes up to me

37
00:02:12,980 --> 00:02:16,220
and he says Travis my badge keeps
turning off

38
00:02:16,220 --> 00:02:20,910
what do I do I told the battery but this
still a little grudge left

39
00:02:20,910 --> 00:02:25,049
so here's how we solve it fuck you
neighbor fuck you do never

40
00:02:25,049 --> 00:02:29,310
and you shake hands and the handshake is
important that's what is the neighbor

41
00:02:29,310 --> 00:02:32,769
%uh neighborliness it's on now over and
everything can be neighborly

42
00:02:32,769 --> 00:02:36,880
neighborliness abounds and we need a
round of applause for that

43
00:02:36,880 --> 00:02:43,880
recover so that any further ado Travis
Goodspeed

44
00:02:44,840 --> 00:02:48,760
building and breaking the next hope
batch shoot a round of applause this

45
00:02:48,760 --> 00:02:49,179
time

46
00:02:49,180 --> 00:02:56,180
route

47
00:02:57,070 --> 00:02:57,500
okay

48
00:02:57,500 --> 00:03:01,670
so I could either give you a lecture
about how the badge works here

49
00:03:01,670 --> 00:03:05,010
which I assume you're all familiar with
after the panel yesterday

50
00:03:05,010 --> 00:03:09,600
and from walking around said a there on
the open mic and protocol

51
00:03:09,600 --> 00:03:12,870
there is the website and you can view
the maps maps and I working

52
00:03:12,870 --> 00:03:17,390
II to do a second hour-long lecture on
that a

53
00:03:17,390 --> 00:03:21,030
pissing off everyone else's you worked
in a for

54
00:03:21,030 --> 00:03:24,350
because it behind the stage into that
stuff or I could show you how to do

55
00:03:24,350 --> 00:03:25,690
something new with a batch

56
00:03:25,690 --> 00:03:28,880
so in this talk I'm barely going to
mention

57
00:03:28,880 --> 00:03:32,709
open beacon I'm barely going to mention
its animated at a project this are both

58
00:03:32,709 --> 00:03:33,520
very big

59
00:03:33,520 --> 00:03:36,800
very complicated projects that do
incredible things but they're not the

60
00:03:36,800 --> 00:03:37,810
topic of this lecture

61
00:03:37,810 --> 00:03:42,400
a instead I'm going to tell you how to
break into electronics

62
00:03:42,400 --> 00:03:45,840
like the whole batch and what are these
projects nearly got me sued

63
00:03:45,840 --> 00:03:49,040
so nevertheless abounded in that in that
I did not

64
00:03:49,040 --> 00:03:52,260
I the a idea is that

65
00:03:52,260 --> 00:03:55,320
in this lecture I'm going to be telling
you about 8- and 16-bit embedded systems

66
00:03:55,320 --> 00:03:56,549
and how to reverse engineer them

67
00:03:56,550 --> 00:03:59,610
the computer inside your home badge

68
00:03:59,610 --> 00:04:04,080
is about as powerful as I get an Asus
admiring a little bit faster

69
00:04:04,080 --> 00:04:07,320
might run a little bit slower better
animal's location better power

70
00:04:07,320 --> 00:04:08,010
efficiency

71
00:04:08,010 --> 00:04:11,769
but it is a computer you can write a new
program for it you can flash

72
00:04:11,769 --> 00:04:15,390
that program into the badge you can
reverse engineer the code that's already

73
00:04:15,390 --> 00:04:16,239
there

74
00:04:16,239 --> 00:04:21,280
I'm and you can also start playing
around with the radios

75
00:04:21,280 --> 00:04:25,169
you can start broadcasting a message is
receiving messages

76
00:04:25,169 --> 00:04:28,419
or you can start receiving messages that
you're not supposed to which

77
00:04:28,419 --> 00:04:33,419
as we all know is a lot of fun a to

78
00:04:33,419 --> 00:04:38,320
see the target hardware that we talk as
assorted stuff used in ZigBee

79
00:04:38,320 --> 00:04:43,020
ants edited up fifteen up for a its
technology is also known as

80
00:04:43,020 --> 00:04:47,070
wireless sensor networks it's Mike read
it seized in sports medical equipment

81
00:04:47,070 --> 00:04:50,710
it is a very often he wants to broadcast
a radio signal

82
00:04:50,710 --> 00:04:53,930
but you don't wanna waste a lot of power
on and at the same time you don't need

83
00:04:53,930 --> 00:04:55,490
to send a lot of data in a trance

84
00:04:55,490 --> 00:04:59,970
dream video here all you want to do is a
little chirp it says here I am

85
00:04:59,970 --> 00:05:03,039
as your badges do a

86
00:05:03,039 --> 00:05:06,190
sick a quick show of hands

87
00:05:06,190 --> 00:05:09,539
how many of you are there very familiar
soldering

88
00:05:09,539 --> 00:05:16,330
awesome how many we know about the
intelligent 51

89
00:05:16,330 --> 00:05:20,190
that I have any reviews a familiar with
risk assembly language

90
00:05:20,190 --> 00:05:23,380
as opposed x86 or anything on x86 I

91
00:05:23,380 --> 00:05:29,950
Corp and how many have you understand
the finer analog points radio go cuz I

92
00:05:29,950 --> 00:05:30,349
don't

93
00:05:30,349 --> 00:05:34,960
a if you measure the antenna I'm sure
you figure this out already

94
00:05:34,960 --> 00:05:38,299
a this is the next 20 badge

95
00:05:38,300 --> 00:05:44,060
and I'm sure you've all got them a if
you don't security less gray outside and

96
00:05:44,060 --> 00:05:47,680
paychecks and all that fun stuff for the
fed to do a

97
00:05:47,680 --> 00:05:50,770
on this 3 have a laser pointer

98
00:05:50,770 --> 00:05:54,469
I so it how many have you lived

99
00:05:54,470 --> 00:05:57,940
taking a look at the design grab the
schematics of a source for john started

100
00:05:57,940 --> 00:05:59,729
to play around with a batch

101
00:05:59,729 --> 00:06:04,310
Rep for those of you who haven't this
chips here

102
00:06:04,310 --> 00:06:08,330
is the amnesty for 30 microcontroller
Texas Instruments was kind enough to

103
00:06:08,330 --> 00:06:11,280
donate twenty five thousand dollars with
these to the conference

104
00:06:11,280 --> 00:06:18,280
give them around

105
00:06:19,360 --> 00:06:22,360
their corporate web filter has also
banned the conference website

106
00:06:22,360 --> 00:06:27,660
as i hack a website yeah for

107
00:06:27,660 --> 00:06:30,729
so it goes a over here is a

108
00:06:30,729 --> 00:06:34,000
Nordic RF radio chip this is used

109
00:06:34,000 --> 00:06:38,210
in a variety of devices one of which
I'll go into a bit of detail about later

110
00:06:38,210 --> 00:06:43,660
a this really speaks on any frequency
from 2.40

111
00:06:43,660 --> 00:06:46,960
gigahertz 22.5 28 gigahertz

112
00:06:46,960 --> 00:06:51,620
the JIT you just have a 7-bit field that
describes the numbers megahertz above

113
00:06:51,620 --> 00:06:52,930
2.4 gigahertz

114
00:06:52,930 --> 00:06:56,000
that the channels on a

115
00:06:56,000 --> 00:07:00,930
on the back you can hack your badge with
that I can get being sold by Mitchell

116
00:07:00,930 --> 00:07:02,510
minute and also violated a

117
00:07:02,510 --> 00:07:06,450
this ship here is an FTDI USB to serial
converter

118
00:07:06,450 --> 00:07:10,110
it's the same thing that you have within
an FTDI cable your stride reno's

119
00:07:10,110 --> 00:07:13,210
and then over the edge there is a USB
plug

120
00:07:13,210 --> 00:07:17,570
if you like starts occurring when you
try to install this it's because

121
00:07:17,570 --> 00:07:21,550
the now power plug on the USB plug

122
00:07:21,550 --> 00:07:25,479
that's the line for this to the left is
Miss honored

123
00:07:25,479 --> 00:07:29,880
it doesn't work at all you probably
messed up to these things

124
00:07:29,880 --> 00:07:32,780
it's not a soldering project for
beginners but if you do it it's quite

125
00:07:32,780 --> 00:07:33,479
rewarding

126
00:07:33,479 --> 00:07:36,500
and you get to do all sorts of fun stuff
and

127
00:07:36,500 --> 00:07:40,590
for fun they've the stuff this year

128
00:07:40,590 --> 00:07:46,460
is the a the cat file design that was
used for manufacturing the badge

129
00:07:46,460 --> 00:07:50,789
although this is in the SourceForge
project you can check it out by seán

130
00:07:50,789 --> 00:07:55,180
the project name is NH batch and later
on I sinasabi

131
00:07:55,180 --> 00:07:58,770
rolled into a distribution or something
but for now grab SVN

132
00:07:58,770 --> 00:08:02,389
that way when I fix things you can get
the update immediately a

133
00:08:02,389 --> 00:08:05,870
down here at the bottom there is a
general purpose i/o port

134
00:08:05,870 --> 00:08:10,139
I don't need to impose but if someone to
grab a beer

135
00:08:10,139 --> 00:08:15,870
or tomato very much appreciate that a

136
00:08:15,870 --> 00:08:19,660
yet said this general purpose i/o port
is used as a touch sensor if you hold

137
00:08:19,660 --> 00:08:20,389
the

138
00:08:20,389 --> 00:08:24,520
Creek the crystal on your board with one
hand thumb and forefinger

139
00:08:24,520 --> 00:08:27,640
and then you also with your other thumb
and forefinger touch

140
00:08:27,640 --> 00:08:30,880
along this road you'll see the lights
respond I

141
00:08:30,880 --> 00:08:34,900
you can get red green and blue agreed a
blue cannot be laid at the same time

142
00:08:34,900 --> 00:08:38,598
green will take precedence so electronic
thing

143
00:08:38,599 --> 00:08:42,659
appear at the top is the Jaytech port
this is what was used for commissioning

144
00:08:42,659 --> 00:08:44,229
the badges on the assembly line

145
00:08:44,229 --> 00:08:48,070
and this is also used for copying
software

146
00:08:48,070 --> 00:08:51,980
out both the Dutch if perhaps there is
some secrets here such as the one that

147
00:08:51,980 --> 00:08:54,520
David was alluding to that might or
might not only be in the

148
00:08:54,520 --> 00:08:58,949
12 the model a here we have a nice

149
00:08:58,950 --> 00:09:02,070
port this was broken out not because

150
00:09:02,070 --> 00:09:05,750
an expectation that you would need it
but because it display similar property

151
00:09:05,750 --> 00:09:07,610
which is that you can wiretap the
connection

152
00:09:07,610 --> 00:09:11,190
between the microcontroller and the
radio and I'll be

153
00:09:11,190 --> 00:09:15,079
talking about the details that a minute
but watching this connection you can see

154
00:09:15,079 --> 00:09:16,440
exactly which channel

155
00:09:16,440 --> 00:09:20,420
the badges reading on or exactly which
packets sending out a receiving

156
00:09:20,420 --> 00:09:24,110
exactly which Mac addresses its
listening on which is for this

157
00:09:24,110 --> 00:09:28,870
ship rather big deal the only thing
preventing you from sleeping all traffic

158
00:09:28,870 --> 00:09:31,950
is that the chip has no promiscuous mode
there is no way

159
00:09:31,950 --> 00:09:35,730
with this radio to Steph traffic aimed
at every Mac Address

160
00:09:35,730 --> 00:09:38,829
you need to know at least the first
three bites a

161
00:09:38,829 --> 00:09:42,050
up here is a the SL connector

162
00:09:42,050 --> 00:09:46,990
this is used for collecting a polluter a
an FTDI cable

163
00:09:46,990 --> 00:09:51,170
for talking to the butler its its order
the poor man's way of doing the

164
00:09:51,170 --> 00:09:54,829
that second kid on the back I've not
tested this but I know that

165
00:09:54,829 --> 00:09:58,170
at least my crush on perhaps others have
it working a

166
00:09:58,170 --> 00:10:03,800
said this cat file is enough to have
boards manufactured they were sent off

167
00:10:03,800 --> 00:10:04,540
to China

168
00:10:04,540 --> 00:10:07,550
we got to %uh they're penalized

169
00:10:07,550 --> 00:10:11,640
and then there it is files would come
back to me

170
00:10:11,640 --> 00:10:16,630
this is a machine translation very poor
one mike is ours I manufacturing contact

171
00:10:16,630 --> 00:10:17,279
in China

172
00:10:17,279 --> 00:10:20,700
was a chosen by

173
00:10:20,700 --> 00:10:25,089
much open is very neighborly a Mike took
care of taking

174
00:10:25,089 --> 00:10:28,380
the Chinese the Google could not
understand and translating at and also

175
00:10:28,380 --> 00:10:29,790
making sure that this whole thing

176
00:10:29,790 --> 00:10:33,930
actually came out of the assembly line
on time lot of that involved harassing

177
00:10:33,930 --> 00:10:35,660
me for which I am terribly grateful

178
00:10:35,660 --> 00:10:41,829
otherwise this would not a shipped on
time: so this lecture will be in three

179
00:10:41,829 --> 00:10:42,459
parts

180
00:10:42,459 --> 00:10:45,490
%uh the first part was simply show you
how to stiffen SPI bus

181
00:10:45,490 --> 00:10:48,640
the second part will describe how every
verse engineered a

182
00:10:48,640 --> 00:10:52,069
another device which is compatible with
the whole batch and then the third part

183
00:10:52,069 --> 00:10:57,490
will describe how to Steph inject
traffic from that device

184
00:10:57,490 --> 00:10:59,940
and then if there's time at the end
though she is in a little tricks that

185
00:10:59,940 --> 00:11:02,130
you can do

186
00:11:02,130 --> 00:11:05,250
the party this lecture will be the good
fit which is a

187
00:11:05,250 --> 00:11:08,569
an open-source Jaytech debugger so
product line

188
00:11:08,569 --> 00:11:11,770
this is sort of an open source clone of
both the

189
00:11:11,770 --> 00:11:15,010
proprietary Texas Instruments J talked
about her which

190
00:11:15,010 --> 00:11:18,930
was very happy with the Nets the tech
support at the time and also the

191
00:11:18,930 --> 00:11:20,230
Hockaday best pirate

192
00:11:20,230 --> 00:11:24,790
30 unless that made this is the best
player don't share code base

193
00:11:24,790 --> 00:11:29,260
maybe it sometime they will but for now
it's best to have both devices

194
00:11:29,260 --> 00:11:32,839
down and its best a lot of different
protocols so in a bucket a51

195
00:11:32,839 --> 00:11:35,370
microcontrollers they're asking for $38
byr about

196
00:11:35,370 --> 00:11:39,970
that arm support you can read and write
SPI and i2c proms

197
00:11:39,970 --> 00:11:43,690
you can talk through radios if you have
a Nordic RF chip

198
00:11:43,690 --> 00:11:46,850
or any other Japan devices

199
00:11:46,850 --> 00:11:51,720
and should to assign you a port for free
if you send a plate email and perhaps

200
00:11:51,720 --> 00:11:53,530
five bucks but it up

201
00:11:53,530 --> 00:11:58,970
a the papers optional the people that do
pay more than a cup for people to

202
00:11:58,970 --> 00:12:02,690
this is what it looks like gut the FTDI
chip

203
00:12:02,690 --> 00:12:06,440
on the left the amnesty for thirty in
the middle and the airports the right

204
00:12:06,440 --> 00:12:09,480
if this look similar to the whole batch
as far as the

205
00:12:09,480 --> 00:12:13,030
shift raises goats because they're
almost identical if you added

206
00:12:13,030 --> 00:12:16,310
the FTDI chip your badge in also USB
plug

207
00:12:16,310 --> 00:12:20,319
you can run the good fit for which
instead does peeking out

208
00:12:20,319 --> 00:12:23,800
as the default that's from where does
just gives your computer access through

209
00:12:23,800 --> 00:12:26,319
Python to the radio

210
00:12:26,319 --> 00:12:29,680
a having access is radio you can Steph
injects

211
00:12:29,680 --> 00:12:33,579
you can jam it's one command to hold a
carrier wave in any given frequency

212
00:12:33,579 --> 00:12:37,310
with the hope that down

213
00:12:37,310 --> 00:12:40,569
to but first you need to figure out
before you consider something

214
00:12:40,569 --> 00:12:44,560
is which actresses using which frequency
is using otherwise you're jumping around

215
00:12:44,560 --> 00:12:45,850
in a sea of noise

216
00:12:45,850 --> 00:12:49,140
and as you're doing it with check
something disabled which is necessary

217
00:12:49,140 --> 00:12:51,650
when you don't yet know it actually
feels are

218
00:12:51,650 --> 00:12:56,220
you wind up with a lot of packets that
look kinda right but art

219
00:12:56,220 --> 00:12:59,640
to think it def got in the last mystery
challenge where

220
00:12:59,640 --> 00:13:02,140
I had every day it was just feeling
garbage whatever was in there a

221
00:13:02,140 --> 00:13:03,150
transmitter

222
00:13:03,150 --> 00:13:07,130
and I had this fighting into xterm

223
00:13:07,130 --> 00:13:10,530
exterminate receives garbage does not
crash for the crab strings around in

224
00:13:10,530 --> 00:13:11,770
there is a memory

225
00:13:11,770 --> 00:13:14,790
a lot of which happen to be English or
function names

226
00:13:14,790 --> 00:13:18,230
so I kept thinking that I was getting
legitimate traffic as actual getting

227
00:13:18,230 --> 00:13:20,160
further away from the transmitter

228
00:13:20,160 --> 00:13:23,900
need to watch out for confusing parts
like this a and take you for any radio

229
00:13:23,900 --> 00:13:26,319
you've got to identify the antenna

230
00:13:26,319 --> 00:13:29,400
the radio chip itself the
microcontroller

231
00:13:29,400 --> 00:13:33,030
sometimes these two are combined they
will be in the subject comes later

232
00:13:33,030 --> 00:13:37,199
in order to use diphtheria traffic you
have to identify where the

233
00:13:37,199 --> 00:13:40,360
to report between is this is what's on
the ice

234
00:13:40,360 --> 00:13:43,670
connector on your badge and

235
00:13:43,670 --> 00:13:46,670
in this case you just need to identify
the radio chip and then

236
00:13:46,670 --> 00:13:50,350
you look at the Penn labels in this case
we want

237
00:13:50,350 --> 00:13:54,170
the Sarah Clark lines are allowed the
serial input and also grabbed

238
00:13:54,170 --> 00:13:58,780
and they happen to all be in this nice
little ring around the edge

239
00:13:58,780 --> 00:14:02,410
the say you identify the signals and
then

240
00:14:02,410 --> 00:14:06,829
having found them on the board you can
figure out exactly where to tap on the

241
00:14:06,829 --> 00:14:08,209
board as a whole

242
00:14:08,209 --> 00:14:12,160
I like to use hypodermic syringes for
these thank their

243
00:14:12,160 --> 00:14:15,209
a kind thanks Derek showed forgetting my
dear

244
00:14:15,209 --> 00:14:20,030
appreciate it

245
00:14:20,030 --> 00:14:23,199
as

246
00:14:23,199 --> 00:14:28,130
I'm sure this beer will cost me in court
later

247
00:14:28,130 --> 00:14:31,750
right so the down a a pecan topping
point

248
00:14:31,750 --> 00:14:35,860
which should be here and the new show
syringes into the board were

249
00:14:35,860 --> 00:14:41,250
aiming at very high gauge a wire wrapped
wire which can be fed through the fires

250
00:14:41,250 --> 00:14:43,180
that are only intended to move

251
00:14:43,180 --> 00:14:46,189
so the copper that from one side or the
other a

252
00:14:46,189 --> 00:14:49,199
supplier in their attack capitan with a
bit a solder

253
00:14:49,199 --> 00:14:52,640
and get a clean connection on an
oscilloscope

254
00:14:52,640 --> 00:14:55,630
this is what the clock line looks like
here you have two bites being

255
00:14:55,630 --> 00:14:56,480
transferred

256
00:14:56,480 --> 00:15:00,079
is a pause in between them the clock is
idling low and then the

257
00:15:00,079 --> 00:15:03,429
contents job jumps high save and low the
clock line

258
00:15:03,429 --> 00:15:06,939
to indicate when the data line should be
sampled or bitten

259
00:15:06,939 --> 00:15:10,110
this is what one of the data lines looks
like byline the two up and then reading

260
00:15:10,110 --> 00:15:10,400
on

261
00:15:10,400 --> 00:15:13,850
every rising edge every falling edge
spending a public speaker

262
00:15:13,850 --> 00:15:17,579
you can then she got the fight is

263
00:15:17,579 --> 00:15:21,299
no it's not it's not the question is is
it Manchester encoded

264
00:15:21,299 --> 00:15:24,750
and know it's just at the instant the
clock edge

265
00:15:24,750 --> 00:15:28,709
the value of the data line gets latched
into

266
00:15:28,709 --> 00:15:31,949
flip-flop and help their I'm so the

267
00:15:31,949 --> 00:15:35,650
this is so low noise that there's no
need for Manchester encoding or other

268
00:15:35,650 --> 00:15:36,709
error correction

269
00:15:36,709 --> 00:15:40,420
measures I'll it happens Ceramiche

270
00:15:40,420 --> 00:15:43,949
if you'd rather not use wires this is
generally helpful if you're just trying

271
00:15:43,949 --> 00:15:45,189
to company from

272
00:15:45,189 --> 00:15:48,459
this is a she talked about her for Texas
Instruments and the

273
00:15:48,459 --> 00:15:51,900
USB device firmware resides in this chip

274
00:15:51,900 --> 00:15:56,910
being executed on this trip it's rather
calm and its

275
00:15:56,910 --> 00:16:00,770
a new chips will pick from an external

276
00:16:00,770 --> 00:16:05,520
from chip because the a from silicon is
more difficult to make

277
00:16:05,520 --> 00:16:08,939
and when you're also trying to make a
radio or USB devices and minerals

278
00:16:08,939 --> 00:16:10,370
complicated analog

279
00:16:10,370 --> 00:16:14,339
fines it's best to keep them separate
rough

280
00:16:14,339 --> 00:16:18,280
and if the matter I like this idea

281
00:16:18,280 --> 00:16:22,480
a having a tap to this there is a great
series of tools

282
00:16:22,480 --> 00:16:28,880
from total phase at this is one of very
few proprietary tools that he is

283
00:16:28,880 --> 00:16:32,260
but they make you a better product for
this than any of the open-source

284
00:16:32,260 --> 00:16:37,350
stuff thus far here you can see the
different transactions

285
00:16:37,350 --> 00:16:40,910
a Macy's master and slave n is the data

286
00:16:40,910 --> 00:16:44,640
is written here and then there data
comes on the other side that these bites

287
00:16:44,640 --> 00:16:45,819
or in pairs

288
00:16:45,819 --> 00:16:50,910
because in SPI a single bite is
transferred for every bite it's received

289
00:16:50,910 --> 00:16:54,819
the is have to come at the same time but
because

290
00:16:54,819 --> 00:16:58,209
that's very rarely useful in a protocol
very often

291
00:16:58,209 --> 00:17:01,829
a one side the day will either be
ignored or will be

292
00:17:01,829 --> 00:17:05,419
irrelevant or all one's

293
00:17:05,419 --> 00:17:08,809
handicap is it is it too late for the
useful things in the

294
00:17:08,809 --> 00:17:12,959
quite often the radio in two months more
than just radio stuff

295
00:17:12,959 --> 00:17:16,329
as: acceleration is 10 the best to these
so if you

296
00:17:16,329 --> 00:17:21,319
wiretap a it's a chick on 24 2009 early
ZigBee prototype

297
00:17:21,319 --> 00:17:25,199
yield that she spots and RAM that
actually house if they ask is written to

298
00:17:25,199 --> 00:17:25,669
them

299
00:17:25,669 --> 00:17:29,510
and each you can just watch the key get
written over the line

300
00:17:29,510 --> 00:17:32,710
you cuz im not the original host awful
the bus

301
00:17:32,710 --> 00:17:36,600
and read that RAM out at these chips
6800

302
00:17:36,600 --> 00:17:39,950
shucks I forgot what I A S key is could
you please remind me

303
00:17:39,950 --> 00:17:43,570
and then you get a copy from what you
can't accept any tech like

304
00:17:43,570 --> 00:17:46,980
it's also very useful four channel
hopping devices because you can tap one

305
00:17:46,980 --> 00:17:47,660
device

306
00:17:47,660 --> 00:17:52,040
watch its orders to change channels and
then follow the channel hopping

307
00:17:52,040 --> 00:17:55,059
knowing which channel to snuff even
though you're not

308
00:17:55,059 --> 00:18:00,530
yet aware of exactly what the channel
hopping over the Mets

309
00:18:00,530 --> 00:18:03,820
so that's an oven abstract theory let's
take an actual product apart

310
00:18:03,820 --> 00:18:07,879
this is a turning point quicker to any
university students the audience

311
00:18:07,880 --> 00:18:12,299
a particularly those in now freshman
astronomy or chemistry

312
00:18:12,299 --> 00:18:15,668
on these devices it physically you don't
have to

313
00:18:15,669 --> 00:18:19,679
suffer such tough are used for
attendance taking an in class quiz is an

314
00:18:19,679 --> 00:18:20,620
in class polling

315
00:18:20,620 --> 00:18:24,740
it's also used in some large corporate
meetings it is that you press one of the

316
00:18:24,740 --> 00:18:25,240
buttons

317
00:18:25,240 --> 00:18:28,390
that label 1234 abcd

318
00:18:28,390 --> 00:18:32,280
and it will broadcast your serial number
that's these three bites here

319
00:18:32,280 --> 00:18:35,520
followed by the fight the the

320
00:18:35,520 --> 00:18:38,520
but be impressed as ASCII as if he had
the one button

321
00:18:38,520 --> 00:18:41,879
it'll do 31 hacks which is asking for
one

322
00:18:41,880 --> 00:18:45,840
to is 32 X all the way to the question
mark which is three FX

323
00:18:45,840 --> 00:18:52,840
a to pop this open just by peeling the
keypad of its not actually screwed in

324
00:18:53,179 --> 00:18:57,500
you'll find either phillips or Nintendo
screws here

325
00:18:57,500 --> 00:19:02,070
if just buy it intended we screw driver
and you can police right out

326
00:19:02,070 --> 00:19:06,418
was it on the board you have a a radio
which is also a microcontroller

327
00:19:06,419 --> 00:19:11,130
this is an 8051 clone it's very early
and tell chip that everyone is copied

328
00:19:11,130 --> 00:19:15,480
big because the fans expired some stuff
a

329
00:19:15,480 --> 00:19:19,549
down here you have a spire on and the
spy ron is actually used

330
00:19:19,549 --> 00:19:24,668
former putting the 8051 ship because if
if you want ship includes the radio

331
00:19:24,669 --> 00:19:27,960
it was very difficult for them to also
include a problem and therefore this is

332
00:19:27,960 --> 00:19:30,429
necessary to

333
00:19:30,429 --> 00:19:33,790
to have permanent storage so there's a
little bit ive permanent memory that

334
00:19:33,790 --> 00:19:34,290
boots

335
00:19:34,290 --> 00:19:37,918
from this extra memory there also is
handed to but

336
00:19:37,919 --> 00:19:40,980
cans which are accessible from outside
the case

337
00:19:40,980 --> 00:19:44,130
set up the firmware you just have to
read up on these chips

338
00:19:44,130 --> 00:19:47,590
discovered the protocol at 24 °c 32 and
then

339
00:19:47,590 --> 00:19:51,659
reading a state issue write a little
good for a driver for dumping

340
00:19:51,660 --> 00:19:55,730
3 itself is a 251 containing an
autograph 2401

341
00:19:55,730 --> 00:19:59,590
radio the hope that is is a 24 lol 01

342
00:19:59,590 --> 00:20:02,889
if that's any foreshadowing down

343
00:20:02,890 --> 00:20:07,179
they speak at one egg per second 2.4 2.5
gigahertz one mega channel spacing

344
00:20:07,179 --> 00:20:09,890
almost exactly the same as the about
this except the hope that is where the

345
00:20:09,890 --> 00:20:11,740
two megabits per second

346
00:20:11,740 --> 00:20:15,610
down it to dump the firmware

347
00:20:15,610 --> 00:20:18,900
all you have to do is run this cable at
the side what if they had any good fit

348
00:20:18,900 --> 00:20:19,570
ports

349
00:20:19,570 --> 00:20:25,090
and value SPDR bad you can right on that
as well

350
00:20:25,090 --> 00:20:29,270
having dumped it is under the command 03
low by the address the high by the

351
00:20:29,270 --> 00:20:29,770
address

352
00:20:29,770 --> 00:20:34,960
and any dummy by the chip will reply
with three bites thats

353
00:20:34,960 --> 00:20:38,900
and then the fourth fight will be the
fight at that address so

354
00:20:38,900 --> 00:20:42,780
this is the exact Python code that I
wrote to dump the firmware

355
00:20:42,780 --> 00:20:47,418
all it does is send the four bytes and
read the 4th Fighter their reply

356
00:20:47,419 --> 00:20:52,919
is the opposite he is these are the only
commence at the Membership supports

357
00:20:52,919 --> 00:20:56,230
having dumped it this is the firmware

358
00:20:56,230 --> 00:20:59,520
it begins with some blank fields out
here

359
00:20:59,520 --> 00:21:03,750
and then it has the mac Address in this
region and seven fight is actually the

360
00:21:03,750 --> 00:21:08,990
default channel on which broadcasts
cited by

361
00:21:08,990 --> 00:21:14,350
the 8051 could begin this immediately
after that

362
00:21:14,350 --> 00:21:19,020
to dump the firmware you do good fit
that's by 25 seed up could I fix this is

363
00:21:19,020 --> 00:21:21,410
the exact command the run today

364
00:21:21,410 --> 00:21:25,090
it copy all that the first few bites
into a binary file

365
00:21:25,090 --> 00:21:28,590
you then load that into IDA Pro and you

366
00:21:28,590 --> 00:21:31,678
open it at index 0

367
00:21:31,679 --> 00:21:35,130
is our love the functions properly named

368
00:21:35,130 --> 00:21:39,110
I'll 8 the names and sells cap their
coverage for example files as they would

369
00:21:39,110 --> 00:21:41,450
be with in the a PC application

370
00:21:41,450 --> 00:21:45,330
so instead you have to look for port
names which are documented

371
00:21:45,330 --> 00:21:50,399
own there included in the data sheet and
you could very quickly import them

372
00:21:50,400 --> 00:21:51,220
indict a pro

373
00:21:51,220 --> 00:21:54,590
because there's a Maxwell about 100 m
far fewer

374
00:21:54,590 --> 00:21:57,799
which are actually is these by data
exchange function

375
00:21:57,799 --> 00:22:02,270
which is open source is sparta Nordic RF
reference design it was copied by a

376
00:22:02,270 --> 00:22:04,639
turning point in the clicker

377
00:22:04,640 --> 00:22:07,570
this is legitimate copy and by the way
it's a couple the two main thing for

378
00:22:07,570 --> 00:22:09,760
them to copy

379
00:22:09,760 --> 00:22:13,110
it all it does is move the input into

380
00:22:13,110 --> 00:22:17,730
the day to register so by searching for
this exact line assembly code

381
00:22:17,730 --> 00:22:21,419
followed by a while loop for that that
waits until the reply comes and

382
00:22:21,419 --> 00:22:25,270
and then something that was the results
into an output variable

383
00:22:25,270 --> 00:22:29,918
you can identify the spy transaction
function this is

384
00:22:29,919 --> 00:22:34,289
what's is Chu read and write memory and
sure enough this is this and we could

385
00:22:34,289 --> 00:22:36,760
hear

386
00:22:36,760 --> 00:22:40,700
internally a in SPI port even though
there isn't an external one for talking

387
00:22:40,700 --> 00:22:41,610
the radio

388
00:22:41,610 --> 00:22:46,200
is used to communicate between the
microcontroller insiders the

389
00:22:46,200 --> 00:22:49,400
chip and the radio inside the chip there
too are right next to each other

390
00:22:49,400 --> 00:22:52,730
maturing at the bus so you can

391
00:22:52,730 --> 00:22:57,299
look using these registers and actually
identify exactly where the

392
00:22:57,299 --> 00:23:00,900
radio code is these are the two fun to
look like

393
00:23:00,900 --> 00:23:04,030
you're either setting the third bit does
the register

394
00:23:04,030 --> 00:23:07,559
work clearing the first bit both port 0

395
00:23:07,559 --> 00:23:10,889
and then you'd reading writing a fight's
and then

396
00:23:10,890 --> 00:23:14,929
you flip that it back to end the
transaction

397
00:23:14,929 --> 00:23:18,620
this is the function that sets up the
radio

398
00:23:18,620 --> 00:23:21,660
if you look deeper into it you see all
these move instructions followed by

399
00:23:21,660 --> 00:23:24,279
local calls this is how

400
00:23:24,279 --> 00:23:28,799
functions ascent so it's ending 8 8 000
bunches ears

401
00:23:28,799 --> 00:23:32,360
and then the condoms and every at 1b 1c
1d

402
00:23:32,360 --> 00:23:35,769
than these magic Constance than twice
the value

403
00:23:35,769 --> 00:23:39,929
a one day that's written incorrectly

404
00:23:39,929 --> 00:23:43,179
you can then look up the format love

405
00:23:43,179 --> 00:23:46,500
this configuration string within the
datasheet

406
00:23:46,500 --> 00:23:51,169
you can figure out where the with is for
the addresses that just whipped the

407
00:23:51,169 --> 00:23:54,679
check something the configuration the
channel number

408
00:23:54,679 --> 00:23:57,990
and you can start running for the code
identifying

409
00:23:57,990 --> 00:24:01,539
because it's just a lotta reads and
writes this tells us that the channel

410
00:24:01,539 --> 00:24:05,639
number which is the this the frequency
megahertz about 2.4 gigahertz

411
00:24:05,639 --> 00:24:08,990
is started when a you've got a Mac
address: and these bites

412
00:24:08,990 --> 00:24:12,740
I've got for by today to being cents and
then one by

413
00:24:12,740 --> 00:24:16,049
took some reading a transaction

414
00:24:16,049 --> 00:24:19,360
you'll see in figure out that these
three fights the destination mac Address

415
00:24:19,360 --> 00:24:22,440
and these three are the source mac
Address

416
00:24:22,440 --> 00:24:25,840
at these are registered names by the way
it this ship has

417
00:24:25,840 --> 00:24:29,149
a lot is internal RAM which is

418
00:24:29,149 --> 00:24:32,190
sort like a register and sort of like
ramps at

419
00:24:32,190 --> 00:24:35,320
any case it whether this is a unique
identifiers for a place in memory it's

420
00:24:35,320 --> 00:24:36,029
not

421
00:24:36,029 --> 00:24:39,889
other a constant a but you can search
for these things to find the

422
00:24:39,889 --> 00:24:41,009
instructions that load them

423
00:24:41,009 --> 00:24:44,669
and this tells us that every single
packet is addressed to you

424
00:24:44,669 --> 00:24:47,990
on 12 X 34 X 36 X

425
00:24:47,990 --> 00:24:51,169
this is this number the channel and the
data rate are all that you need to

426
00:24:51,169 --> 00:24:54,639
receive packets

427
00:24:54,639 --> 00:24:58,279
these are packets being stepped on day

428
00:24:58,279 --> 00:25:01,289
next a batch this final column

429
00:25:01,289 --> 00:25:05,389
is the number five being pressed here
you have the serial number

430
00:25:05,389 --> 00:25:08,679
if it is in a classroom you can actually
get a histogram Chris answers as they're

431
00:25:08,679 --> 00:25:13,259
being placed

432
00:25:13,259 --> 00:25:18,080
and this is art whether it's you can
wire up your own badge when two commands

433
00:25:18,080 --> 00:25:23,610
and be sniffing the same traffic

434
00:25:23,610 --> 00:25:26,690
said jumping ahead II is

435
00:25:26,690 --> 00:25:33,690
similar bid more powerful for up yes

436
00:25:33,919 --> 00:25:37,139
to the question is what happens if the
cricket since 2 answers in rapid-fire

437
00:25:37,139 --> 00:25:38,259
succession

438
00:25:38,259 --> 00:25:41,700
such as if one with a legitimate answer
and the other where forgery

439
00:25:41,700 --> 00:25:45,429
out there are only two ways to do this
you can either accept the first value or

440
00:25:45,429 --> 00:25:46,789
the most recent value

441
00:25:46,789 --> 00:25:50,519
if either way you can sniff the mac
Address is primarily in the class period

442
00:25:50,519 --> 00:25:51,649
and use it to

443
00:25:51,649 --> 00:25:56,259
beat them to the punch of course the
softer should scream holy murder when it

444
00:25:56,259 --> 00:25:59,830
sees this but it probably won't

445
00:25:59,830 --> 00:26:03,658
a especially the but might be hit
multiple times

446
00:26:03,659 --> 00:26:06,730
to cause a legitimate rebroadcast

447
00:26:06,730 --> 00:26:10,200
a the radio chain is just copied
reference design

448
00:26:10,200 --> 00:26:14,710
to I I don't really understand any the
analog prior to the radio except that if

449
00:26:14,710 --> 00:26:16,720
you place these components these places

450
00:26:16,720 --> 00:26:20,090
magic stuff happens and it runs out in
the open be confirmed where

451
00:26:20,090 --> 00:26:23,960
which is wet I love you with thinking
LED's are running

452
00:26:23,960 --> 00:26:27,309
being tracked and I'll get to the
meta-data stuff

453
00:26:27,309 --> 00:26:30,450
or it runs the goods that former

454
00:26:30,450 --> 00:26:33,570
which allows you to stay fit and this
whole thing is built like a new tool

455
00:26:33,570 --> 00:26:34,210
chain

456
00:26:34,210 --> 00:26:38,240
so cheesy was used to build the firmware
for all these badges:

457
00:26:38,240 --> 00:26:41,330
they're also programmed by good fats
actually on the assembly line every

458
00:26:41,330 --> 00:26:42,519
single one your badges

459
00:26:42,519 --> 00:26:46,320
was hooked up to that fact which flashed
its firmware and also ran every a test

460
00:26:46,320 --> 00:26:46,799
case

461
00:26:46,799 --> 00:26:51,779
which is why only four units or so had
that radius

462
00:26:51,779 --> 00:26:55,519
at a 1800 it's a decent yield the good
fit

463
00:26:55,519 --> 00:26:59,210
firmware exposes the regular USB so you
want to talk with it

464
00:26:59,210 --> 00:27:02,789
you just right place anchored in the
same way that to dump the

465
00:27:02,789 --> 00:27:07,980
a prom earlier and lecture I only had to
write a little bit Python code

466
00:27:07,980 --> 00:27:11,909
comparing the radio settings to hear the
right got up and began on the left

467
00:27:11,909 --> 00:27:15,679
you've got the

468
00:27:15,679 --> 00:27:19,409
clicker think that check something as
little bit different as I the mac

469
00:27:19,409 --> 00:27:20,749
Address is in their Lancs

470
00:27:20,749 --> 00:27:25,149
but other than that the largely
compatible the price on client

471
00:27:25,149 --> 00:27:30,090
is a separate class from us the other
particles

472
00:27:30,090 --> 00:27:34,059
and it needs a little bit a seeker to
actually wait for an incoming packet to

473
00:27:34,059 --> 00:27:34,629
arrive

474
00:27:34,629 --> 00:27:37,769
but other than that it's entirely
self-contained with and Python

475
00:27:37,769 --> 00:27:41,899
there are only two functions you need to
the radio within the

476
00:27:41,899 --> 00:27:44,909
the that's effing firmer a

477
00:27:44,909 --> 00:27:48,070
within the radio every single thing is a
register

478
00:27:48,070 --> 00:27:53,450
so have in order to say set the
frequency all I'm doing is taking the

479
00:27:53,450 --> 00:27:55,830
value that's given and I'm poking it
into memory

480
00:27:55,830 --> 00:27:59,080
at the fifth register sixth register

481
00:27:59,080 --> 00:28:04,949
but 56 within the radio and then I start
asking for packets

482
00:28:04,950 --> 00:28:08,200
the the client driver just feeds cue

483
00:28:08,200 --> 00:28:11,029
set up the radio in the right way and
after the raid has been set up it's the

484
00:28:11,029 --> 00:28:12,720
same code to Steph packets

485
00:28:12,720 --> 00:28:16,159
so if you're stiffing open beacon
traffic where sniffing turning point

486
00:28:16,159 --> 00:28:20,440
clicker traffic the vast majority the
code is the same leave the

487
00:28:20,440 --> 00:28:24,649
register setup is different and that's
if you want to add support for something

488
00:28:24,649 --> 00:28:26,740
news which is what are the spark fun
kits

489
00:28:26,740 --> 00:28:32,240
is this radio it's just a matter of
tweaking a couple registers

490
00:28:32,240 --> 00:28:35,299
on this is the complete function

491
00:28:35,299 --> 00:28:38,610
body for dumping firmware and printing
at

492
00:28:38,610 --> 00:28:43,159
I say dumping radio packets and putting
them properly and all that fun stuff

493
00:28:43,159 --> 00:28:48,850
and that's all in 82 step traffic and
crackers that stuff

494
00:28:48,850 --> 00:28:52,730
you can is similar techniques to hack
into other devices such as toys the

495
00:28:52,730 --> 00:28:55,929
smart grid sports equipment medical
equipment

496
00:28:55,929 --> 00:28:59,919
this is one of my favorites this and we
have what it is his hands

497
00:28:59,919 --> 00:29:02,950
there it is here this is the girl tech I
am

498
00:29:02,950 --> 00:29:06,669
it is an instant messaging toy for
children manufactured by Mattel into the

499
00:29:06,669 --> 00:29:08,539
girl tech brand

500
00:29:08,539 --> 00:29:12,029
I think had another brand associated
with it just forget about it the justice

501
00:29:12,029 --> 00:29:14,269
that you've got a keyboard and an LCD

502
00:29:14,269 --> 00:29:17,850
and 92 megahertz radio

503
00:29:17,850 --> 00:29:21,990
you can then that connects to a server
which is running on your home PC by

504
00:29:21,990 --> 00:29:22,830
radio

505
00:29:22,830 --> 00:29:26,289
and start instant messaging with your
friends without being exposed to

506
00:29:26,289 --> 00:29:31,749
internet data files or more importantly
hogging the home computer

507
00:29:31,749 --> 00:29:35,499
mattel is an issue with toys and most to
a manufacturers do which is that

508
00:29:35,499 --> 00:29:38,559
there are occasionally extra

509
00:29:38,559 --> 00:29:41,678
production runs you know the the factual
stay open at night roll-up

510
00:29:41,679 --> 00:29:44,850
couple extra units which then gets older
the black market and

511
00:29:44,850 --> 00:29:48,129
when the telecos the toys R Us to sell
their new Miami

512
00:29:48,129 --> 00:29:52,070
addresses oh sorry we already bought a
bunch of them

513
00:29:52,070 --> 00:29:55,580
even if the for sale so the

514
00:29:55,580 --> 00:29:59,668
as these things were a lot of the first
factory haven't then fully programs

515
00:29:59,669 --> 00:30:03,539
instead they have these test points
beneath the battery compartment will see

516
00:30:03,539 --> 00:30:03,899
these

517
00:30:03,899 --> 00:30:09,460
in almost every cell phone is also exist
in their turn if i clicker

518
00:30:09,460 --> 00:30:14,720
you can wired is up a using just a
little jumper wires run them into a good

519
00:30:14,720 --> 00:30:16,289
fat

520
00:30:16,289 --> 00:30:21,450
here it is and then you can reflash it
to be anything

521
00:30:21,450 --> 00:30:25,929
michael has been made a spectrum
analyzer

522
00:30:25,929 --> 00:30:32,929
a round of applause read it online

523
00:30:35,149 --> 00:30:37,919
he could it be here but see every talkie
guess

524
00:30:37,919 --> 00:30:43,090
the very good he doesn't more obscure
stuff this is a

525
00:30:43,090 --> 00:30:48,730
to smart water meter for the city of
Paris IQ and devices this is a

526
00:30:48,730 --> 00:30:52,890
Garmin watch former joggers that will
actually track

527
00:30:52,890 --> 00:30:57,110
the GPS coordinates love the jogger as
well as heart rate

528
00:30:57,110 --> 00:31:00,510
from this heart monitor here and then

529
00:31:00,510 --> 00:31:04,950
after the jog all this data can be
downloaded to a computer through the

530
00:31:04,950 --> 00:31:08,600
USB plug this protocol is

531
00:31:08,600 --> 00:31:12,669
open at the higher layers all the
application their stuff

532
00:31:12,669 --> 00:31:15,919
although that is open you can get a free
then Enda those times for example code

533
00:31:15,919 --> 00:31:19,159
the only thing proprietary here is the
lake where

534
00:31:19,159 --> 00:31:24,490
other the filers is enough to figure out
like most everything it's an autograph

535
00:31:24,490 --> 00:31:24,850
chip

536
00:31:24,850 --> 00:31:29,100
running at 1 megabit per second daily
difficulties in the mac address that I

537
00:31:29,100 --> 00:31:29,559
mention

538
00:31:29,559 --> 00:31:32,889
knowing quite knows what the first

539
00:31:32,890 --> 00:31:36,720
packets are addressed to you because
that's been left out other documentation

540
00:31:36,720 --> 00:31:40,179
by reverse-engineering these devices we
can figure that out

541
00:31:40,179 --> 00:31:43,179
and then because all of the higher
layers identified

542
00:31:43,179 --> 00:31:46,809
will then be possible to make a
completely open at stack

543
00:31:46,809 --> 00:31:51,658
I think I'll be doing this tomorrow
during the best that checking

544
00:31:51,659 --> 00:31:54,690
workshop just for fun also

545
00:31:54,690 --> 00:31:58,270
vulnerabilities run by Chip rather than

546
00:31:58,270 --> 00:32:02,168
by application as in the same way that
you can find a vulnerability for an

547
00:32:02,169 --> 00:32:03,190
operating system

548
00:32:03,190 --> 00:32:06,600
with in the PC world you can also

549
00:32:06,600 --> 00:32:09,669
identify I chipas expert expert care for
example

550
00:32:09,669 --> 00:32:13,200
every ember 200 series radio lacks

551
00:32:13,200 --> 00:32:16,529
a security fits so you can plug right
into it

552
00:32:16,529 --> 00:32:20,010
and say please give me a copy volatile
memory keys

553
00:32:20,010 --> 00:32:26,440
and I will happily be a budget a olive a
check on a 251 devices including the

554
00:32:26,440 --> 00:32:27,450
girl tech i ami

555
00:32:27,450 --> 00:32:31,630
protect their RAM from a debugger but
they don't protect flash

556
00:32:31,630 --> 00:32:36,820
so you can connects to a chip and erase
it

557
00:32:36,820 --> 00:32:40,549
and copy ran out and have a copy follows
the radio configurations

558
00:32:40,549 --> 00:32:45,770
including keys and channels and coatings
all that other stuff

559
00:32:45,770 --> 00:32:50,870
down you also wind up with problems with
that random number generators

560
00:32:50,870 --> 00:32:56,770
in our essay which is used for
asymmetric photography in the IT world

561
00:32:56,770 --> 00:33:00,158
it's not such a big deal if you're read
a number generator is bad

562
00:33:00,159 --> 00:33:03,950
because announces can be repeated as I
they can be

563
00:33:03,950 --> 00:33:07,110
decibel are known to an attacker they
just cannot be repeated

564
00:33:07,110 --> 00:33:10,450
in elliptic curve

565
00:33:10,450 --> 00:33:14,789
MTV which is the public key cryptography
system used by this market

566
00:33:14,789 --> 00:33:18,120
if the nonce is predictable the private

567
00:33:18,120 --> 00:33:22,389
static key can be removed which is
sufficient to impersonate a device on

568
00:33:22,389 --> 00:33:22,990
the network

569
00:33:22,990 --> 00:33:26,409
and the sole purpose in this catastrophe
is to keep devices from being

570
00:33:26,409 --> 00:33:27,649
impersonated by Others

571
00:33:27,649 --> 00:33:33,909
summer the third generations which have
this right but every single second

572
00:33:33,909 --> 00:33:35,340
generations agree chip

573
00:33:35,340 --> 00:33:38,770
screws up there in a number generator
one way or another I get back to that

574
00:33:38,770 --> 00:33:39,120
man

575
00:33:39,120 --> 00:33:43,010
as for a member exposure

576
00:33:43,010 --> 00:33:46,710
because the access controls exist for
protecting

577
00:33:46,710 --> 00:33:50,909
code and not data they just trying to
keep you from copping a product they

578
00:33:50,909 --> 00:33:52,000
don't really care

579
00:33:52,000 --> 00:33:56,970
if you can figure out which radio
channel it uses reprogramming is almost

580
00:33:56,970 --> 00:33:57,760
always allowed

581
00:33:57,760 --> 00:34:00,830
before you're allowed to reprogram the
chip

582
00:34:00,830 --> 00:34:04,950
it wants to make sure that they're ext
so an unprivileged user is allowed to

583
00:34:04,950 --> 00:34:06,309
raise the entire device

584
00:34:06,309 --> 00:34:10,489
and nothing else we can also do is a
race in and up

585
00:34:10,490 --> 00:34:13,929
if you want to get a copy %uh love the
memory the girl tech i'ma

586
00:34:13,929 --> 00:34:17,589
that's in RAM that is every key every
global variable

587
00:34:17,589 --> 00:34:21,080
I love the radio configuration registers
all that stuff

588
00:34:21,080 --> 00:34:24,960
it is run these two commands a good fit
you could fit that ship can erase

589
00:34:24,960 --> 00:34:28,129
and I could fit that chip kahn dump data
file name:

590
00:34:28,129 --> 00:34:31,310
from 0 to the end and you get this nice
little niche

591
00:34:31,310 --> 00:34:34,529
you can look at it and the down I a
region

592
00:34:34,530 --> 00:34:37,679
and sure enough there is a complete copy
does

593
00:34:37,679 --> 00:34:43,310
every key annie is there is you only get
the presently tuned frequency

594
00:34:43,310 --> 00:34:46,859
but you can sort it guess at what the
center frequencies might be or at least

595
00:34:46,859 --> 00:34:48,529
get some packets if not all of

596
00:34:48,530 --> 00:34:53,399
should channel hopping involved you to
stack buffer overflow exploits

597
00:34:53,399 --> 00:34:56,500
just as you can on the PC except that
they're

598
00:34:56,500 --> 00:35:00,080
nose tackle troll mechanisms except for
example except we're

599
00:35:00,080 --> 00:35:05,490
excellence down sometimes RAM is an
executable

600
00:35:05,490 --> 00:35:09,339
but that's okay because your real goal
is to get a copy of the software out of

601
00:35:09,339 --> 00:35:09,849
the chip

602
00:35:09,849 --> 00:35:13,700
when you're doing experts against these
if you're talking this badge in you try

603
00:35:13,700 --> 00:35:15,630
to do a stack overflow expert on it

604
00:35:15,630 --> 00:35:18,810
you would be doing so because you want
to copy the badge firmware not because

605
00:35:18,810 --> 00:35:23,270
you're trying to remotely change with
the LCD is due

606
00:35:23,270 --> 00:35:27,569
so if you do it returned from attack in
the same way they fit to return to Lipsy

607
00:35:27,569 --> 00:35:28,930
attack

608
00:35:28,930 --> 00:35:32,529
and very in France and research it
worked with

609
00:35:32,530 --> 00:35:36,530
who used to be in grub but is now in
Switzerland his ability to a complete

610
00:35:36,530 --> 00:35:38,380
return I did Prof programming

611
00:35:38,380 --> 00:35:41,480
attack framework for these chips so you
can actually give it

612
00:35:41,480 --> 00:35:44,050
a firmer image and haven't searched
through and find all the gadgets

613
00:35:44,050 --> 00:35:45,109
necessary

614
00:35:45,109 --> 00:35:48,130
to move brown

615
00:35:48,130 --> 00:35:52,069
into flash memory to later be executed
even though the chip does not allow the

616
00:35:52,069 --> 00:35:53,900
execution avram

617
00:35:53,900 --> 00:35:57,680
it's quite nice attack because the buses
serving I can connect

618
00:35:57,680 --> 00:36:01,500
a good fit to the SPI bus you can't put
the target device

619
00:36:01,500 --> 00:36:04,819
and then you can hope the
microcontroller the target device

620
00:36:04,819 --> 00:36:08,790
just by pulling its reset underground
having done this

621
00:36:08,790 --> 00:36:11,940
the microcontroller the target stops
executing

622
00:36:11,940 --> 00:36:15,450
and it also let's offer the wires said
that you the attacker

623
00:36:15,450 --> 00:36:20,040
now control the radio and all love the
RAM remains intact

624
00:36:20,040 --> 00:36:23,750
although the registers and the radio men
attacked CNN just copy the configuration

625
00:36:23,750 --> 00:36:25,390
out

626
00:36:25,390 --> 00:36:29,440
and the case application processes these
are chips which implement a sockets

627
00:36:29,440 --> 00:36:30,920
library annex was over

628
00:36:30,920 --> 00:36:35,369
SPI port the entire socket library
remains open and accessible

629
00:36:35,369 --> 00:36:38,839
so you can then continue sockets which
is that opened by the previous device

630
00:36:38,839 --> 00:36:39,849
after hijacking

631
00:36:39,849 --> 00:36:43,080
all a bit sections in the case a

632
00:36:43,080 --> 00:36:46,279
love sickly protocols and things like
that which are quite complicated this is

633
00:36:46,280 --> 00:36:48,810
very handy because it means that you
don't have to understand all the

634
00:36:48,810 --> 00:36:51,000
handshaking and all the girls poverty

635
00:36:51,000 --> 00:36:54,940
and all that stuff it's already done for
you and you're just left with an open

636
00:36:54,940 --> 00:36:59,650
and already running interface

637
00:36:59,650 --> 00:37:03,430
it is look brand anyone here

638
00:37:03,430 --> 00:37:07,009
says snowflake pattern which is
generated by a the near future actions

639
00:37:07,010 --> 00:37:09,020
register

640
00:37:09,020 --> 00:37:12,619
this is the what are the worst record
numbers generators i've seen

641
00:37:12,619 --> 00:37:16,720
the entire stated this is determined by
a 16-bit

642
00:37:16,720 --> 00:37:22,310
register that's fed by real random fiber
data

643
00:37:22,310 --> 00:37:27,830
thats then shuffle around repeatedly to
produce the same sequence as 65,000

644
00:37:27,830 --> 00:37:30,950
samples so if you plot

645
00:37:30,950 --> 00:37:34,760
the first bite that you get along with
the second bite to get

646
00:37:34,760 --> 00:37:38,599
in order continuously you whatever the
snowflake pattern

647
00:37:38,599 --> 00:37:41,849
and given any by within the x-axis

648
00:37:41,849 --> 00:37:44,800
you know that only eight colliding
position on the y-axis can be the

649
00:37:44,800 --> 00:37:46,500
following by

650
00:37:46,500 --> 00:37:51,020
because they're only 65,000 different
positions they're only 65,000

651
00:37:51,020 --> 00:37:54,119
sequences around a numbers that can come
from any starting point which means that

652
00:37:54,119 --> 00:37:57,530
they're only 65,000 ephemeral keys that
can be used when this device is

653
00:37:57,530 --> 00:37:59,859
implementing elliptic curve cryptography

654
00:37:59,859 --> 00:38:03,250
which means that you look up table for
every key that might possibly be

655
00:38:03,250 --> 00:38:04,040
generated

656
00:38:04,040 --> 00:38:07,710
is 25 megabytes

657
00:38:07,710 --> 00:38:12,349
I which makes searching trivial I was
also a great paper that came out years

658
00:38:12,349 --> 00:38:15,630
ago it says that if you know four but
four bits

659
00:38:15,630 --> 00:38:18,800
ephemeral k you can recover the rest
here you know all of them

660
00:38:18,800 --> 00:38:22,800
and you can also recover the private
static

661
00:38:22,800 --> 00:38:26,359
as far as tools go I is the good fit for
everything and

662
00:38:26,359 --> 00:38:29,770
the next to a conference badge for I
love the radio work is the telophase

663
00:38:29,770 --> 00:38:30,369
beagle

664
00:38:30,369 --> 00:38:34,490
for SPI sniffing I i've got a a couple
luv

665
00:38:34,490 --> 00:38:39,140
boring conclusions here but if you
prefer I'd like to show you something ft

666
00:38:39,140 --> 00:38:43,839
that I hope someone who can one-up

667
00:38:43,839 --> 00:38:47,290
that is have a test from our image which
can find the source code that actually

668
00:38:47,290 --> 00:38:50,060
receives packets

669
00:38:50,060 --> 00:38:53,890
so I took this resident robot the my
mother made out a stain glass

670
00:38:53,890 --> 00:39:00,890
at shares my mother

671
00:39:03,020 --> 00:39:08,190
fed-up break this

672
00:39:08,190 --> 00:39:13,310
every time it's Isaac linking it's
receiving a factor

673
00:39:13,310 --> 00:39:17,790
a see if I can cover this up

674
00:39:17,790 --> 00:39:22,060
yeah as a no traffic traffic your hands
will block the

675
00:39:22,060 --> 00:39:25,140
radio signals by the way it right

676
00:39:25,140 --> 00:39:32,140
yeah yeah just like a ya

677
00:39:33,840 --> 00:39:35,070
ain't nothing like it once was

678
00:39:35,070 --> 00:39:38,610
yes %ah to that's about it

679
00:39:38,610 --> 00:39:41,950
for this lecture there any questions
quickly I've only got

680
00:39:41,950 --> 00:39:45,910
it minutes left just come up to the
microphone and

681
00:39:45,910 --> 00:39:52,910
save this

682
00:39:53,369 --> 00:39:57,859
I had lol I'm gonna had a brief question
about the arm

683
00:39:57,859 --> 00:40:02,058
shorting out these two to make the blue
light stay on on that

684
00:40:02,059 --> 00:40:05,059
interfere with the operation other
anything

685
00:40:05,059 --> 00:40:08,769
shooting at which to the ones in the
bottom appear over-the-top

686
00:40:08,769 --> 00:40:13,339
these the vertical line goes up and now
oh that

687
00:40:13,339 --> 00:40:17,249
that's that %uh I'm doing a bad thing
then

688
00:40:17,249 --> 00:40:21,069
yes so the the vertical column is
actually the serial port between the

689
00:40:21,069 --> 00:40:22,239
mackerel in the radio

690
00:40:22,239 --> 00:40:26,919
if you tried this together is the radio
will enter in a remote

691
00:40:26,919 --> 00:40:32,519
in which all the lights stay on to tell
you that the radio is bad that so that's

692
00:40:32,519 --> 00:40:34,459
if you would like to keep the

693
00:40:34,459 --> 00:40:39,049
blue light on you can't I wanna the pins
in the Air Force on all

694
00:40:39,049 --> 00:40:43,999
line at the bottom to ground and that
will keep any flights your choice on

695
00:40:43,999 --> 00:40:48,959
at any further questions yes

696
00:40:48,959 --> 00:40:52,448
is going to be a slightly targeted

697
00:40:52,449 --> 00:40:57,849
and I rather following question but I
how hard is it to permanently damage the

698
00:40:57,849 --> 00:40:58,390
badge

699
00:40:58,390 --> 00:41:01,499
say if you had a bad soldering job or
randomly

700
00:41:01,499 --> 00:41:06,089
started wire things together I if you
miss other wires together

701
00:41:06,089 --> 00:41:09,619
the chip can't actually supply enough
current from the battery to cause damage

702
00:41:09,619 --> 00:41:13,369
and with USB its possible the rather
difficult cause damage

703
00:41:13,369 --> 00:41:18,909
if you take a soldering iron annie is it
is a chisel I guarantee that bad things

704
00:41:18,909 --> 00:41:19,329
will happen

705
00:41:19,329 --> 00:41:24,179
but you eat shouldn't worry about
permanent electrical damage this is

706
00:41:24,179 --> 00:41:27,749
very well secured against other
electricity and its

707
00:41:27,749 --> 00:41:34,749
voltages and the 3- to 5-inch any
further questions

708
00:41:37,400 --> 00:41:40,390
about using two badges has wireless
radios

709
00:41:40,390 --> 00:41:43,779
killing two laptops txt.att.net yet
certainly a

710
00:41:43,780 --> 00:41:46,840
there wasn't time to finish decoded
advances

711
00:41:46,840 --> 00:41:51,380
this conference this thinking about
making our chat room that ran for the

712
00:41:51,380 --> 00:41:52,670
bad as the USB

713
00:41:52,670 --> 00:41:56,220
where every message that you sent is
then relayed by the prisoners which had

714
00:41:56,220 --> 00:41:58,270
seen at 2:11 mesh networking between
them

715
00:41:58,270 --> 00:42:01,290
and in this manner you can have laptops
throughout

716
00:42:01,290 --> 00:42:05,750
each the entire batch area that
communicated and because I love the

717
00:42:05,750 --> 00:42:10,070
packets are sniffed by a the a bad I
forget our network

718
00:42:10,070 --> 00:42:13,700
this could then be fed into chat log for
later

719
00:42:13,700 --> 00:42:17,350
monitoring for

720
00:42:17,350 --> 00:42:22,580
we're watching you I did this the other
victim as arm

721
00:42:22,580 --> 00:42:27,759
how much does the how much just the CPU
and other chips on a sport cost

722
00:42:27,760 --> 00:42:30,970
and it's because I mean I don't pick
programming those cities are very very

723
00:42:30,970 --> 00:42:32,940
cheap how these compare to us

724
00:42:32,940 --> 00:42:36,980
the Megatron is this project is rather
expensive

725
00:42:36,980 --> 00:42:40,840
on the order as eight ten dollars per
chip thankfully we didn't have to pay

726
00:42:40,840 --> 00:42:43,550
any of that because Texas Instruments
found it within their kind heart to help

727
00:42:43,550 --> 00:42:44,000
us

728
00:42:44,000 --> 00:42:51,000
yes around here

729
00:42:51,730 --> 00:42:54,830
the radio chip I believe is just over
two dollars in bulk

730
00:42:54,830 --> 00:42:58,650
maybe 225 and the other components fire

731
00:42:58,650 --> 00:43:03,150
quite small and cheap the assembly cost
actually

732
00:43:03,150 --> 00:43:07,810
accounts for the majority the Casa
production but

733
00:43:07,810 --> 00:43:12,290
any further questions yes

734
00:43:12,290 --> 00:43:16,200
we'll be real tomorrow I i know you're
there

735
00:43:16,200 --> 00:43:22,020
workshop for to set their people signed
up yes is it the workshop is full

736
00:43:22,020 --> 00:43:25,500
if you come to me with a cool badge
hacking project by noon tomorrow

737
00:43:25,500 --> 00:43:28,760
apush UN otherwise there

738
00:43:28,760 --> 00:43:33,070
physically is no room for more i
apologize. but

739
00:43:33,070 --> 00:43:36,740
that's the way that it goes if you
receive an e-mail from a telling me that

740
00:43:36,740 --> 00:43:37,470
you're in the group

741
00:43:37,470 --> 00:43:42,320
than you are otherwise I don't know
either

742
00:43:42,320 --> 00:43:45,440
either bring an impressive that second
project or finds a black male on me

743
00:43:45,440 --> 00:43:49,770
now they should be terribly difficult
the night is to offer

744
00:43:49,770 --> 00:43:53,150
either I like beer if you could bring
the IPA

745
00:43:53,150 --> 00:43:56,640
that India Pale Ale to america

746
00:43:56,640 --> 00:44:01,490
should get as much as I can you up
briefly showed a

747
00:44:01,490 --> 00:44:05,610
French water smart grid application 'em

748
00:44:05,610 --> 00:44:08,920
I'm a little concerned about the smart
grid infrastructure here in the US

749
00:44:08,920 --> 00:44:13,740
a have you seen a wide adoption in this
country if so

750
00:44:13,740 --> 00:44:17,080
what general region that the US is more
advanced than others in

751
00:44:17,080 --> 00:44:21,460
implementing smart grid so there a lot
of tests that works

752
00:44:21,460 --> 00:44:24,610
a there is a a point in time in which

753
00:44:24,610 --> 00:44:29,250
it looked as if these bikers were going
to be rolled out overnight and its

754
00:44:29,250 --> 00:44:32,780
poorly at that but now there's
significant effort being made into doing

755
00:44:32,780 --> 00:44:33,900
a proper rollout

756
00:44:33,900 --> 00:44:37,010
so I'm a lot more optimistic

757
00:44:37,010 --> 00:44:40,620
about the successes security this marker
that I was

758
00:44:40,620 --> 00:44:44,350
year ago on

759
00:44:44,350 --> 00:44:48,319
do you have any one's gotten this radio
working with at Mellor

760
00:44:48,320 --> 00:44:51,690
on pic based processors yes the

761
00:44:51,690 --> 00:44:55,660
original open beacon batch used a pic
microcontroller

762
00:44:55,660 --> 00:44:59,810
and some of the competing clicker brands
use an electric controller

763
00:44:59,810 --> 00:45:03,020
I also the device or smart from spark
fun

764
00:45:03,020 --> 00:45:06,190
that uses an Atmel microcontroller
inside the key fob

765
00:45:06,190 --> 00:45:09,790
I'll very soon be adding support to the
good fight for that so you'll be able to

766
00:45:09,790 --> 00:45:12,870
see if you keep up to your computer to
add remote-control items

767
00:45:12,870 --> 00:45:19,310
or anything else you might choose to
script if anyone is funnest a glass and

768
00:45:19,310 --> 00:45:21,730
would like to purchase visit the robot
fees

769
00:45:21,730 --> 00:45:24,730
come in contact me i think thats all the

770
00:45:24,730 --> 00:45:31,730
time that I have etc

771
00:45:34,200 --> 00:45:34,950
out a

772
00:45:34,950 --> 00:45:38,300
one quick further announcement
productive has been turned off for this

773
00:45:38,300 --> 00:45:38,910
conference

774
00:45:38,910 --> 00:45:42,399
so you have all sorts of fun with about
network and when you re flash them

775
00:45:42,400 --> 00:45:46,400
be sure to add a serial number and
figure out how that works like it

776
00:45:46,400 --> 00:45:53,400
yes

