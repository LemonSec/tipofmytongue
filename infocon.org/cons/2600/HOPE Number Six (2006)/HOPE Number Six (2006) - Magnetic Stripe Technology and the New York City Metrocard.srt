1
00:00:04,980 --> 00:00:05,609
all started

2
00:00:05,609 --> 00:00:08,720
max is not a fan of it's one dude I

3
00:00:08,720 --> 00:00:11,970
this is mag stripe technology and the
New York City metro card

4
00:00:11,970 --> 00:00:15,580
just a reminder all the sessions are
being recorded

5
00:00:15,580 --> 00:00:20,600
and DVD's finalized after the session
and then not duplicated in some kinda

6
00:00:20,600 --> 00:00:21,930
with imaging machine

7
00:00:21,930 --> 00:00:26,670
I so you'll be able to purchase them
moments after the session souter

8
00:00:26,670 --> 00:00:27,800
something that you like

9
00:00:27,800 --> 00:00:32,810
they kept them at the low low price at
10 box so you can grab line and now

10
00:00:32,810 --> 00:00:39,210
give it to your friends I alright let's
move on to the New York City metro card

11
00:00:39,210 --> 00:00:44,350
with Joseph battalion up

12
00:00:44,350 --> 00:00:47,360
okay so this discussion is going to be
on magnetic stripe technology

13
00:00:47,360 --> 00:00:50,899
and the New York City metro card I'm
gonna discuss a little bit about

14
00:00:50,899 --> 00:00:54,890
what magnetic stripe technology is what
sort of

15
00:00:54,890 --> 00:00:59,620
information you could find a magnetic
stripes work argues magnetic stripes hey

16
00:00:59,620 --> 00:01:00,700
can build your own reader

17
00:01:00,700 --> 00:01:05,089
and a little bit about reverse
engineering proprietary formats based on

18
00:01:05,089 --> 00:01:06,200
what I did for the MetroCard

19
00:01:06,200 --> 00:01:11,399
so I'll talk a little bit about how I
first got started in this

20
00:01:11,399 --> 00:01:14,609
how many of you guys are from this area
near city so lucky

21
00:01:14,609 --> 00:01:18,149
so a year and a half ago or so you
probably saw

22
00:01:18,149 --> 00:01:21,189
a bunch of stuff on the news about

23
00:01:21,189 --> 00:01:24,630
these guys in the subway who were
selling fares rain

24
00:01:24,630 --> 00:01:27,850
so there are a lotta allowed news
reports about that

25
00:01:27,850 --> 00:01:31,340
and what they were saying was don't buy
fares from these guys because what

26
00:01:31,340 --> 00:01:34,200
they're doing is taking part of the
ground doing something

27
00:01:34,200 --> 00:01:38,539
to them bending them and some magical
way getting free fares from

28
00:01:38,539 --> 00:01:41,630
cars that they found on the ground and
became a problem

29
00:01:41,630 --> 00:01:45,109
that made the news because what they
started doing was putting up the vending

30
00:01:45,109 --> 00:01:45,740
machines

31
00:01:45,740 --> 00:01:49,630
taking government going sites in on a
bill slots and so that he couldn't

32
00:01:49,630 --> 00:01:52,979
actually buy a card if he needed on and
sell

33
00:01:52,979 --> 00:01:57,499
this obviously com I interest in how how
could you possibly Ben the card and get

34
00:01:57,499 --> 00:01:58,009
a free

35
00:01:58,009 --> 00:02:02,630
ride from has that how does that work
and it actually came up as a topic at

36
00:02:02,630 --> 00:02:03,939
one in the 2600 meetings

37
00:02:03,939 --> 00:02:07,439
and had a discussion with a couple
people about it nobody really knew

38
00:02:07,439 --> 00:02:11,460
exactly what was happening and so I try
to find out more information about it I

39
00:02:11,460 --> 00:02:13,220
talk to someone the guys who are doing
it

40
00:02:13,220 --> 00:02:17,020
and some other alike are not you know
don't want to talk about in some form or

41
00:02:17,020 --> 00:02:19,800
just like em and it works you know you
just gotta do this and then when they

42
00:02:19,800 --> 00:02:21,350
would attempt to demonstrate when Mark

43
00:02:21,350 --> 00:02:26,710
and I'm and so you I don't really
believe that it could actually happen

44
00:02:26,710 --> 00:02:29,420
but you know there's a lot of press
about wilde on

45
00:02:29,420 --> 00:02:32,760
so I wanted to look into it and so I

46
00:02:32,760 --> 00:02:35,700
I've been I had been trying to read
metro card and see if I could find out

47
00:02:35,700 --> 00:02:36,870
exactly what's on them

48
00:02:36,870 --> 00:02:41,580
see if maybe there's some clue there
about how it worked and just about how

49
00:02:41,580 --> 00:02:42,690
the system work in general

50
00:02:42,690 --> 00:02:46,290
and you'll find if you try to read them
in standard readers

51
00:02:46,290 --> 00:02:50,390
he'd own you don't get any valuable
barely get either strain is euros

52
00:02:50,390 --> 00:02:53,540
where you get and I read error for those
readers that check

53
00:02:53,540 --> 00:02:57,900
check sums which is most readers and you
just can't do anything with it

54
00:02:57,900 --> 00:03:03,470
so my next route was to look and see how
can I possibly build the reader and

55
00:03:03,470 --> 00:03:07,190
maybe you know obviously learn more
about many did strike technology

56
00:03:07,190 --> 00:03:11,240
but also possibly be able to read the
MetroCard NC

57
00:03:11,240 --> 00:03:14,540
well can't what I can find out about it
and ultimately Howard

58
00:03:14,540 --> 00:03:19,160
how exactly these people are bending
cards to get free fares so

59
00:03:19,160 --> 00:03:22,840
I fiddling around and and and learning
more about how they worked

60
00:03:22,840 --> 00:03:26,630
I realize that most love the magnetic
stripe readers

61
00:03:26,630 --> 00:03:30,079
all they had was a simple readhead

62
00:03:30,080 --> 00:03:33,200
and some TTL logic circuitry that red

63
00:03:33,200 --> 00:03:36,630
the peaks at that they got when an ounce
by more about exactly how it works in

64
00:03:36,630 --> 00:03:37,170
the second

65
00:03:37,170 --> 00:03:40,640
that they got from swiping the card
across a magnetic head

66
00:03:40,640 --> 00:03:44,330
they figure well there's there's nothing
really unique about the magnetic head

67
00:03:44,330 --> 00:03:47,920
and looking up the specifications for
magnetic stripe cards

68
00:03:47,920 --> 00:03:52,500
you'll find that track with is actually
very similar to what you find on a

69
00:03:52,500 --> 00:03:53,170
cassette tape

70
00:03:53,170 --> 00:03:56,560
so you can take a cassette tape head at
ever

71
00:03:56,560 --> 00:04:00,670
at a standard walkman or other cassette
tape player and play around with it

72
00:04:00,670 --> 00:04:04,709
and so that's what I was doing and at
the first thing I did was look at the

73
00:04:04,709 --> 00:04:06,100
way for money source com

74
00:04:06,100 --> 00:04:10,140
and found that looks very similar to an
audio waveform

75
00:04:10,140 --> 00:04:13,930
so then I have been up to Mike amplifier
and listen to what I heard and it

76
00:04:13,930 --> 00:04:14,780
sounded

77
00:04:14,780 --> 00:04:19,459
very similar to what you hear you know
when you pick up the phone when a modem

78
00:04:19,459 --> 00:04:22,219
is online or something but very
forfeiture period of time and

79
00:04:22,219 --> 00:04:25,419
a play if the idea is working %uh play
what it sounds like this is going to be

80
00:04:25,419 --> 00:04:27,310
unpleasant

81
00:04:27,310 --> 00:04:30,430
sound okay so it's not allowed but

82
00:04:30,430 --> 00:04:33,580
that's what it sounds like Seagate is
very short burst

83
00:04:33,580 --> 00:04:37,400
love audio information and

84
00:04:37,400 --> 00:04:40,699
that was that was perfect because I have
this very nice analog to digital

85
00:04:40,699 --> 00:04:42,930
converter in my laptop

86
00:04:42,930 --> 00:04:47,490
also known as a sound card and so I was
able to write

87
00:04:47,490 --> 00:04:52,319
some just some very simple DSP code to
because that stuff

88
00:04:52,319 --> 00:04:56,520
and that's that's where the idea came
from so I'm gonna start talking a little

89
00:04:56,520 --> 00:04:58,068
bit about magnetism

90
00:04:58,069 --> 00:05:01,599
try to make a quick kiss for those of
you who aren't exactly sure what's going

91
00:05:01,599 --> 00:05:02,669
on when you're

92
00:05:02,669 --> 00:05:05,808
actually swiping the card and sell

93
00:05:05,809 --> 00:05:09,319
some magnetism basics every magnet has
two poles

94
00:05:09,319 --> 00:05:12,460
I'm sure all if you've played with them
posing on

95
00:05:12,460 --> 00:05:16,109
similar polls repel each other and thus
you note

96
00:05:16,110 --> 00:05:19,349
opposite poles attract each other

97
00:05:19,349 --> 00:05:22,558
cell easing using this principle

98
00:05:22,559 --> 00:05:26,050
ferromagnetic materials which are
materials that

99
00:05:26,050 --> 00:05:29,360
will reteam magnetism

100
00:05:29,360 --> 00:05:33,270
when presented with magnetic field when
present with an external magnet

101
00:05:33,270 --> 00:05:37,289
magnetic field so you can basically take
Feb met ferromagnetic materials

102
00:05:37,289 --> 00:05:40,979
expose them to a field and set them up
as a magnet

103
00:05:40,979 --> 00:05:44,620
for whatever orientation you want one in

104
00:05:44,620 --> 00:05:49,189
like very common example this is iron a
term that I'm going to be using leader

105
00:05:49,189 --> 00:05:53,300
coercivity is just a measure of how
strong that magnetic field has to be

106
00:05:53,300 --> 00:05:58,080
to magnetize the material and that's
measured in use a force that

107
00:05:58,080 --> 00:06:02,139
but solenoids are very simply oil
suppliers

108
00:06:02,139 --> 00:06:05,689
when current is passed through the
squirrels a essentially become

109
00:06:05,689 --> 00:06:09,069
a magnet depending on which way to turn
is following in the quayle

110
00:06:09,069 --> 00:06:12,599
you can change the polarization of the
magnet

111
00:06:12,599 --> 00:06:16,520
okay so magnetic field lines look
exactly like what you see there

112
00:06:16,520 --> 00:06:19,930
for the bar magnet very very close to
the surface

113
00:06:19,930 --> 00:06:24,080
a bar magnet you find that all the
magnetic field lines are pretty much

114
00:06:24,080 --> 00:06:28,120
entirely horizontal one and that one of
the things about solenoids

115
00:06:28,120 --> 00:06:31,569
is the the same concept where you

116
00:06:31,569 --> 00:06:34,789
which when you introduce current to it
produces a magnet

117
00:06:34,789 --> 00:06:38,169
works in reverse so if you were to
insert a magnet into

118
00:06:38,169 --> 00:06:42,128
into a so annoyed you would be able to
get turnout it and it only happens when

119
00:06:42,129 --> 00:06:44,110
he's magnetic field lines

120
00:06:44,110 --> 00:06:47,229
are perpendicular to that quayle so

121
00:06:47,229 --> 00:06:50,619
if not you'll notice that with the
standard bar magnet all the magnetic

122
00:06:50,619 --> 00:06:53,029
field lines are very close to the
surface

123
00:06:53,029 --> 00:06:56,490
and all run horizontal at the end to the

124
00:06:56,490 --> 00:07:00,800
at the into the magnet you noticed that
they become very vertical

125
00:07:00,800 --> 00:07:03,830
and so if you were to put a bar magnet
into a sauna you would

126
00:07:03,830 --> 00:07:07,688
find that you get two peaks one is when
you insert and when is when you remove

127
00:07:07,689 --> 00:07:08,289
it

128
00:07:08,289 --> 00:07:11,289
because it works on the concept of
changing magnetic up a changing magnetic

129
00:07:11,289 --> 00:07:12,808
field

130
00:07:12,809 --> 00:07:16,719
okay so on an equity mag stripe looks
almost exactly like

131
00:07:16,719 --> 00:07:19,990
a very on powerful barman

132
00:07:19,990 --> 00:07:23,400
okay so this is what you get when you
bring to manage together this these are

133
00:07:23,400 --> 00:07:24,839
the flux lines that occur

134
00:07:24,839 --> 00:07:28,080
and when you have opposing poles next to
each other

135
00:07:28,080 --> 00:07:31,830
you'll notice that that the flux lines
are very similar to a standard Bartman

136
00:07:31,830 --> 00:07:33,998
anywhere across

137
00:07:33,999 --> 00:07:38,029
its surface and so you can't really tell
the difference if you're

138
00:07:38,029 --> 00:07:42,619
if you've got two magnets stuck together
in winter solenoid

139
00:07:42,619 --> 00:07:45,729
you want you won't notice a difference
it'll look as if it's once big bar

140
00:07:45,729 --> 00:07:46,449
magnet

141
00:07:46,449 --> 00:07:49,460
but when you have holes that repel each
other

142
00:07:49,460 --> 00:07:53,449
the flux lines are are perpendicular to
the coil

143
00:07:53,449 --> 00:07:57,629
and so you'll get another peak apparent
when he passed their

144
00:07:57,629 --> 00:08:01,020
okay so magnetic stripes are made by
taking

145
00:08:01,020 --> 00:08:04,139
a whole bunch a little tiny
ferromagnetic particles combining them

146
00:08:04,139 --> 00:08:05,389
with the glue

147
00:08:05,389 --> 00:08:09,020
we told them all together sort of
painting them on service at the card

148
00:08:09,020 --> 00:08:12,448
holding them in place so that their
polls

149
00:08:12,449 --> 00:08:15,919
are all aligned with an external
magnetic field

150
00:08:15,919 --> 00:08:20,029
and then allowing that binder too dry
and

151
00:08:20,029 --> 00:08:23,069
putting a layer of protective coating
over in

152
00:08:23,069 --> 00:08:26,759
so that's a magnet structure actually
made okay so there

153
00:08:26,759 --> 00:08:32,190
so they're in Coden by taking the
concept of the so annoyed

154
00:08:32,190 --> 00:08:35,570
where you can create your own magnet
running at over

155
00:08:35,570 --> 00:08:39,200
this magnetic stripe whatever track you
wanna in code an

156
00:08:39,200 --> 00:08:42,510
flipping the polarization and as you
flip the polarization love

157
00:08:42,510 --> 00:08:45,210
the solenoid you're actually flipping a
polarization of the ferromagnetic

158
00:08:45,210 --> 00:08:49,170
materials and you're calling them some
sort of data

159
00:08:49,170 --> 00:08:52,390
so wanna one of the difficult things
about making on writer

160
00:08:52,390 --> 00:08:56,520
were using writers is that very careful
timing has to be observed if you try to

161
00:08:56,520 --> 00:08:58,079
buy writer the very expensive

162
00:08:58,080 --> 00:09:02,110
and ally I mean generally speaking
expensive

163
00:09:02,110 --> 00:09:05,360
so you can you can use different
techniques in want the most common ones

164
00:09:05,360 --> 00:09:06,030
are

165
00:09:06,030 --> 00:09:08,900
just inserting it into a machine that
has rollers and it'll make sure

166
00:09:08,900 --> 00:09:09,930
everything's at

167
00:09:09,930 --> 00:09:13,630
constant velocity it'll now the cracked
I need to get everything

168
00:09:13,630 --> 00:09:17,120
so that you don't either over run Magna
strike

169
00:09:17,120 --> 00:09:21,290
where run too short a bit okay cell

170
00:09:21,290 --> 00:09:24,319
the next thing is how is this stuff
encoded

171
00:09:24,320 --> 00:09:27,370
how do you how do you actually encoded
in this way

172
00:09:27,370 --> 00:09:30,940
some what's used to encode magnetic
stripes is a former frequency shift

173
00:09:30,940 --> 00:09:31,460
keying

174
00:09:31,460 --> 00:09:34,910
called taken by phase which basically
uses two frequencies

175
00:09:34,910 --> 00:09:38,589
to Dino binary 10

176
00:09:38,590 --> 00:09:42,260
so one frequency would be zero and half
that frequency

177
00:09:42,260 --> 00:09:45,870
would be a one and you'll get a better
idea for this one show you the demo

178
00:09:45,870 --> 00:09:49,380
some output frequencies forehand swipe
reader which is

179
00:09:49,380 --> 00:09:53,380
just me running a card across a magnetic
stripe

180
00:09:53,380 --> 00:09:58,030
is well within the idea range you have
no problem interface now the

181
00:09:58,030 --> 00:10:01,550
with a sound card in getting away from
that you can look at it and sell

182
00:10:01,550 --> 00:10:04,180
this is the reader designed they see
right there it's not much of a schematic

183
00:10:04,180 --> 00:10:05,290
but

184
00:10:05,290 --> 00:10:08,620
you have the read head directly
interfaces

185
00:10:08,620 --> 00:10:12,240
didn't directly interface with 3.5
millimeter Jack

186
00:10:12,240 --> 00:10:15,350
and that just goes right into your sound
card so it's very simple

187
00:10:15,350 --> 00:10:18,550
the first a the first reader that I
actually made

188
00:10:18,550 --> 00:10:22,400
was this thing and that I mean it's
exactly what you're seeing

189
00:10:22,400 --> 00:10:26,200
it's a it said it's that tape had that I
together that old walkman

190
00:10:26,200 --> 00:10:29,660
and it's it's taped around like I said
just that

191
00:10:29,660 --> 00:10:33,670
3.5 millimeter jack with some standard
headphone wire

192
00:10:33,670 --> 00:10:37,469
and that worked actually pretty well if
I wanted to get away from I can use in

193
00:10:37,470 --> 00:10:39,520
this demo because it's a pain but

194
00:10:39,520 --> 00:10:42,680
but when I had what I use now when I'm
using for this demo

195
00:10:42,680 --> 00:10:45,550
is a surplus magnetic stripe reader
which you can pick up for like five

196
00:10:45,550 --> 00:10:46,440
bucks

197
00:10:46,440 --> 00:10:51,030
and usually when you buy them you'll
find that inside there's a buncha TTL

198
00:10:51,030 --> 00:10:52,000
circuitry in

199
00:10:52,000 --> 00:10:56,720
logic stuff for reading standard cards
but i bypass all that. and

200
00:10:56,720 --> 00:10:59,820
interface directly with the read head so
all that's coming out here right now

201
00:10:59,820 --> 00:11:04,660
is two conductors and it's all audio
directly coming from three and

202
00:11:04,660 --> 00:11:11,300
so let me get let me show you guys what
it looks like

203
00:11:11,300 --> 00:11:17,630
so many actually I'm an easy eggs a
standard kart example here

204
00:11:17,630 --> 00:11:24,530
so I've got I love that is a Starbucks
card don't think there's any value on it

205
00:11:24,530 --> 00:11:28,060
that's not something okay it'll be
better

206
00:11:28,060 --> 00:11:33,110
I so so this is what you get this is the
way form that you get

207
00:11:33,110 --> 00:11:37,110
and looks a lot like what you saw before
with the on

208
00:11:37,110 --> 00:11:40,810
are fighting

209
00:11:40,810 --> 00:11:44,569
so at the beginning %uh this way you'll
notice

210
00:11:44,569 --> 00:11:48,599
that all the peaks are relatively
equidistant from each other

211
00:11:48,600 --> 00:11:52,709
and he's actually call clocking bits and
this is what the standard

212
00:11:52,709 --> 00:11:56,660
reader secretary uses to time what you
see

213
00:11:56,660 --> 00:12:00,420
%ah what what the time this year amid is
what I mention before

214
00:12:00,420 --> 00:12:06,759
is that one frequency will be no 20 and
have that frequency will be no 21 some

215
00:12:06,759 --> 00:12:11,470
from here to here is here a bit from
here here's his ear bitten so on

216
00:12:11,470 --> 00:12:15,589
so if you go a little bit further you'll
start to see when data is actually

217
00:12:15,589 --> 00:12:16,120
present

218
00:12:16,120 --> 00:12:19,209
so here is easier a bit

219
00:12:19,209 --> 00:12:22,740
this is double that frequency range so
that's one did

220
00:12:22,740 --> 00:12:26,949
again another one bit and their bit and
so you can go long like this and

221
00:12:26,949 --> 00:12:30,120
actually because the entire magnetic
stripe by hand if you wanted to

222
00:12:30,120 --> 00:12:37,120
and what you end up with is the string
of zeros and ones

223
00:12:37,879 --> 00:12:42,290
so it's pretty cool and very simple
hardware and it's and it's really easy

224
00:12:42,290 --> 00:12:44,309
to build and really easy to play with

225
00:12:44,309 --> 00:12:48,559
so obviously the benefits how these
things are

226
00:12:48,559 --> 00:12:51,559
that it's not dependent on any sort of
availability are

227
00:12:51,559 --> 00:12:56,670
you know serial port ps/2 port a game
port or anything else that

228
00:12:56,670 --> 00:13:01,139
laptops usually don't have anymore all
the decoding is done in software so you

229
00:13:01,139 --> 00:13:03,610
not dependent on any hardware specific
design

230
00:13:03,610 --> 00:13:07,649
if you want to play with a new
proprietary format your welcome to

231
00:13:07,649 --> 00:13:11,129
with the source code and modify it and
see if you can get it to read you can

232
00:13:11,129 --> 00:13:13,279
also look at the way for very easily and

233
00:13:13,279 --> 00:13:17,019
try to pick up clues about how things
are included you know there's probably a

234
00:13:17,019 --> 00:13:17,779
couple other

235
00:13:17,779 --> 00:13:22,569
magnetic stripe said don't use standard
encodings South it's very easy to play

236
00:13:22,569 --> 00:13:22,959
with

237
00:13:22,959 --> 00:13:26,889
on and it's free really really cheap
some

238
00:13:26,889 --> 00:13:30,040
this is a standard encoding for a

239
00:13:30,040 --> 00:13:34,118
regular cars that you're able that
you're likely to come across every day

240
00:13:34,119 --> 00:13:38,139
my credit card ATM cards gift cards not
certain stuff so

241
00:13:38,139 --> 00:13:41,990
you could find all this information
actually in those I so specifications

242
00:13:41,990 --> 00:13:46,079
and there you know not so exciting to
read on

243
00:13:46,079 --> 00:13:50,379
the magnetic stripe has three tracks a
standard minutes right this is an

244
00:13:50,379 --> 00:13:51,910
attacking about the MetroCard to later

245
00:13:51,910 --> 00:13:55,939
but track number one is

246
00:13:55,939 --> 00:13:59,059
in I ATA format and that's a

247
00:13:59,059 --> 00:14:02,389
and that's actually not the numeric
track so you can actually store

248
00:14:02,389 --> 00:14:06,509
uppercase on and numeric data on their

249
00:14:06,509 --> 00:14:09,519
and most the common stuff that you'll
find on here

250
00:14:09,519 --> 00:14:12,929
is your account number your name

251
00:14:12,929 --> 00:14:17,799
a couple other things expiration date da
service codes and stuff like that

252
00:14:17,799 --> 00:14:22,769
and so when you are you know when you're
at a kiosk you're at it check out or

253
00:14:22,769 --> 00:14:25,610
something you put your credit card and
we see no surname immediately

254
00:14:25,610 --> 00:14:29,660
it's because it included on the magnetic
stripe the second track

255
00:14:29,660 --> 00:14:34,009
also contains the same information
generally speaking except it's not often

256
00:14:34,009 --> 00:14:34,839
numeric cell

257
00:14:34,839 --> 00:14:38,149
the name is omitted but mostly the other
fields are usually identical to what you

258
00:14:38,149 --> 00:14:39,059
find in track one

259
00:14:39,059 --> 00:14:42,279
track three is very rarely use anymore

260
00:14:42,279 --> 00:14:46,319
I think the original use for track three
was back when ATM machines are offline

261
00:14:46,319 --> 00:14:49,869
and and some sort of encoded pin

262
00:14:49,869 --> 00:14:53,589
was in store launch was stored on track
three in a couple other things and so

263
00:14:53,589 --> 00:14:55,259
that didn't work out so well for them

264
00:14:55,259 --> 00:14:59,629
and most systems now are online actually
all systems our online I can find enough

265
00:14:59,629 --> 00:15:00,629
I know ATM

266
00:15:00,629 --> 00:15:04,929
and it turns out actually that the bits
per inch aren't really

267
00:15:04,929 --> 00:15:10,249
all that important and often violated
but it doesn't really matter

268
00:15:10,249 --> 00:15:13,379
because when you when he swiped you
never swiping at the same

269
00:15:13,379 --> 00:15:17,970
velocity and so the encoding skied the
decoding software actually has to take

270
00:15:17,970 --> 00:15:20,399
account for that so the difference
really aren't that important

271
00:15:20,399 --> 00:15:24,949
on and then the last that the last feel
that you'll see their

272
00:15:24,949 --> 00:15:28,129
is approximately how many characters can
actually store on them

273
00:15:28,129 --> 00:15:31,249
and I see more and I've seen a lot less
so it's it's not

274
00:15:31,249 --> 00:15:34,399
it's dependent upon bits per inch and
it's not really that important

275
00:15:34,399 --> 00:15:38,869
Tom like I said the alphanumeric attract
is encoded

276
00:15:38,869 --> 00:15:42,459
using seven bits per character and six
in those

277
00:15:42,459 --> 00:15:46,079
are I define the actual character

278
00:15:46,079 --> 00:15:49,839
and it's actually a quiz went to ASCII
with with an offset say can very easily

279
00:15:49,839 --> 00:15:50,660
decoded

280
00:15:50,660 --> 00:15:55,809
I just have to add whatever %ah said is
that I remember off the top my head

281
00:15:55,809 --> 00:15:59,579
and then the side the 7-bit is just a
CRC check some

282
00:15:59,579 --> 00:16:04,059
seeking actually verify independently
that each character's red crackling

283
00:16:04,059 --> 00:16:07,110
are typical financial car data

284
00:16:07,110 --> 00:16:10,490
which is when I mention before your
credit cards or ATM cards

285
00:16:10,490 --> 00:16:13,860
gift cards and stuff like that all it
exactly like this

286
00:16:13,860 --> 00:16:18,929
the first characters always starts at No
and depending on the track using

287
00:16:18,929 --> 00:16:22,329
you know the characters different
seeking very easily

288
00:16:22,329 --> 00:16:26,189
see that you've read either track wanna
track to our track three

289
00:16:26,189 --> 00:16:29,730
after that you'll find a the format code

290
00:16:29,730 --> 00:16:33,160
and that basically says okay this is a
bang Carter this is

291
00:16:33,160 --> 00:16:36,469
you know a debit card or this is you
know certain type of card

292
00:16:36,470 --> 00:16:39,549
after that your primary account number I

293
00:16:39,549 --> 00:16:43,689
your credit card number your ATM number
whatever it is another field separator

294
00:16:43,689 --> 00:16:45,029
which basically

295
00:16:45,029 --> 00:16:48,149
says okay this is getting the feel
they're going to be going into something

296
00:16:48,149 --> 00:16:48,679
new now

297
00:16:48,679 --> 00:16:52,309
your name on the alphanumeric track but
not on the

298
00:16:52,309 --> 00:16:55,899
numeric track and additional data and
discretionary data

299
00:16:55,899 --> 00:16:59,499
additional data it usually is the same
it usually the expiration date and then

300
00:16:59,499 --> 00:17:00,720
some service code

301
00:17:00,720 --> 00:17:04,309
and the service coca mutually be looked
up in the manuals if you have

302
00:17:04,309 --> 00:17:07,908
a access to that sort of stuff usually

303
00:17:07,909 --> 00:17:11,270
its somewhat confidential and not easy
to get a hold of

304
00:17:11,270 --> 00:17:14,429
and in discretionary data is totally
proprietary

305
00:17:14,429 --> 00:17:19,689
a and you'll you know you really have to
be working at that company probably be

306
00:17:19,689 --> 00:17:20,319
able to

307
00:17:20,319 --> 00:17:23,559
find out what it is but there's actually
documents online love people sort of

308
00:17:23,559 --> 00:17:25,689
reverse engineering the stuff in looking
at.

309
00:17:25,689 --> 00:17:28,649
what exactly the service codes mean and
some documents are you floating out

310
00:17:28,649 --> 00:17:30,799
there from the companies which they came
from some

311
00:17:30,799 --> 00:17:34,610
you can very easily find find out what
they mean

312
00:17:34,610 --> 00:17:38,159
McKay so now sort of interesting is

313
00:17:38,159 --> 00:17:42,409
how do you how do you go about reverse
engineering a former I mean it's it's

314
00:17:42,409 --> 00:17:43,700
it's kinda cool to read

315
00:17:43,700 --> 00:17:47,200
these cards and and one that I'll show
you some other stuff that you find on

316
00:17:47,200 --> 00:17:48,080
these cards

317
00:17:48,080 --> 00:17:52,980
you know has opened

318
00:17:52,980 --> 00:17:56,929
so when when I'm reading right now is a
Starbucks card and this is exactly what

319
00:17:56,929 --> 00:17:57,990
I showed you before

320
00:17:57,990 --> 00:18:02,169
on when I when I showed either way form
and don't let me show you happen to dab

321
00:18:02,169 --> 00:18:02,970
dab is

322
00:18:02,970 --> 00:18:07,890
an application I wrote to take the
output from the microphone input

323
00:18:07,890 --> 00:18:13,279
and basically do some very simple DSP
work on it detected peaks

324
00:18:13,279 --> 00:18:18,880
and do some simple decoding of that data
so that I don't have to go by and say

325
00:18:18,880 --> 00:18:20,440
this is your 0110

326
00:18:20,440 --> 00:18:24,470
so let me show you what the Apple that
is you just takes the input from the

327
00:18:24,470 --> 00:18:25,039
sound card

328
00:18:25,039 --> 00:18:29,649
as a source okay so you see that exactly
what I said before you get

329
00:18:29,649 --> 00:18:33,840
a whole series zeros and ones and that's
not really very exciting

330
00:18:33,840 --> 00:18:37,480
cell DMSP

331
00:18:37,480 --> 00:18:41,649
is an application that basically go
through the standard financial cards

332
00:18:41,649 --> 00:18:44,750
tries to figure out what track it is and
then just because it from there

333
00:18:44,750 --> 00:18:48,220
so I bit into that program do it again

334
00:18:48,220 --> 00:18:51,260
and what you see right here is

335
00:18:51,260 --> 00:18:54,908
is the card information and that's
exactly what is

336
00:18:54,909 --> 00:18:58,799
I stored on the card and it's verified
that that is what start on the car

337
00:18:58,799 --> 00:19:01,270
because there's check sums for every
character and then there's a checksum at

338
00:19:01,270 --> 00:19:01,799
the end

339
00:19:01,799 --> 00:19:05,168
and and and that's it that's the number
that's in the cards

340
00:19:05,169 --> 00:19:10,820
here's here's another example this is a
this is a Sony connect card

341
00:19:10,820 --> 00:19:13,710
and it's it's another sort of
stored-value card I would show you a

342
00:19:13,710 --> 00:19:14,490
credit card but

343
00:19:14,490 --> 00:19:18,299
I don't want to um

344
00:19:18,299 --> 00:19:21,929
and and you get the same sort of thing a

345
00:19:21,929 --> 00:19:26,610
and it's not very exciting and it's that
this looked up in Sony's database to see

346
00:19:26,610 --> 00:19:27,429
if you have enough

347
00:19:27,429 --> 00:19:31,850
value but that's what standard cards
look like

348
00:19:31,850 --> 00:19:35,820
um proprietary formats so

349
00:19:35,820 --> 00:19:39,610
the New York City metro card obviously
doesn't do this

350
00:19:39,610 --> 00:19:43,130
if you try to read it in that would give
you an era when decoding

351
00:19:43,130 --> 00:19:48,149
checksums not valid it doesn't really
have any of that

352
00:19:48,149 --> 00:19:51,520
seem sorta features that standard cards
do

353
00:19:51,520 --> 00:19:55,129
on in the beginning of the at the
beginning of the first way for my show

354
00:19:55,130 --> 00:19:55,799
you guys

355
00:19:55,799 --> 00:20:01,210
I mention how their are all those
clocking bitstream so

356
00:20:01,210 --> 00:20:05,480
let me show you again

357
00:20:05,480 --> 00:20:08,820
with a major crimes that so

358
00:20:08,820 --> 00:20:12,860
I have a standard MetroCard everybody
seen it before

359
00:20:12,860 --> 00:20:17,210
it's just a standard one day on the
metro card and I'm going to swipe

360
00:20:17,210 --> 00:20:18,570
defender by the way so

361
00:20:18,570 --> 00:20:22,389
what I'm using is just a bunch of I
electrical tape inside

362
00:20:22,390 --> 00:20:25,980
the reader so that I can get it wrapping
up much closer to the magnetic head

363
00:20:25,980 --> 00:20:30,890
some felt best

364
00:20:30,890 --> 00:20:36,750
that's a MetroCard

365
00:20:36,750 --> 00:20:41,060
and it looks very similar and in fact it
actually does use this the same coding

366
00:20:41,060 --> 00:20:41,610
scheme

367
00:20:41,610 --> 00:20:48,000
frequency shift and what's different it
doesn't have a clock in bits

368
00:20:48,000 --> 00:20:51,490
so most love that TTL the coding

369
00:20:51,490 --> 00:20:54,820
logic and I other decoding logic
circuits

370
00:20:54,820 --> 00:20:59,060
depend on the clock in bits to read the
cards

371
00:20:59,060 --> 00:21:02,590
and and what they do is they look at a
certain number and I

372
00:21:02,590 --> 00:21:06,250
there might be a standard but I don't
know what it is because you can't really

373
00:21:06,250 --> 00:21:07,040
find out

374
00:21:07,040 --> 00:21:10,320
how the how the chips are designed
usually just i sees that

375
00:21:10,320 --> 00:21:13,340
echoed match i'd that they called
magnetic stripe data

376
00:21:13,340 --> 00:21:17,209
and it's not really that much
information about how they work by Tom

377
00:21:17,210 --> 00:21:21,670
what you see there is media single
talking that maybe not

378
00:21:21,670 --> 00:21:25,680
it's not really it's not really
dependable

379
00:21:25,680 --> 00:21:29,770
from the standpoint I love knowing for
sure how long it is

380
00:21:29,770 --> 00:21:35,060
you know what if somebody the inside you
know what's %uh made inside with a

381
00:21:35,060 --> 00:21:36,610
concert last year something some

382
00:21:36,610 --> 00:21:41,090
you can depend on the clock in its also
I don't often we will find it

383
00:21:41,090 --> 00:21:48,090
somewhere in the middle of the card
users funky looking a bit

384
00:21:50,889 --> 00:21:57,889
even take my word for Nigeria's later if
you're curious today

385
00:21:58,250 --> 00:22:04,450
yet its its I'm blind but if

386
00:22:04,450 --> 00:22:07,470
okay anyway its it's all it is is a I

387
00:22:07,470 --> 00:22:11,490
it's a bit that looks like happen for
one bit and so it's not really

388
00:22:11,490 --> 00:22:14,740
it's not really dependable from the
standpoint of knowing

389
00:22:14,740 --> 00:22:18,260
what binary number that is another Alex
without actually explain

390
00:22:18,260 --> 00:22:21,440
with that sees for a second so it's not

391
00:22:21,440 --> 00:22:24,460
it's not standard you're not going to be
able to get any standard credit card

392
00:22:24,460 --> 00:22:25,180
readers to

393
00:22:25,180 --> 00:22:29,100
to read this however if you're writing
your own software

394
00:22:29,100 --> 00:22:32,800
you can tweak it and you can modify and
you can say hey don't depend on

395
00:22:32,800 --> 00:22:37,360
10 clocking its are 15 pockets we know
that the first one is going to be 0

396
00:22:37,360 --> 00:22:40,920
cell it's a little bit more finicky

397
00:22:40,920 --> 00:22:45,320
when you try to read a MetroCard with
this but it usually works pretty well

398
00:22:45,320 --> 00:22:49,460
and so what all I do is depend I think I
dropped the first key can depend on the

399
00:22:49,460 --> 00:22:50,650
second P can say that

400
00:22:50,650 --> 00:22:54,270
that's definitely easier a bit for 220
MetroCards

401
00:22:54,270 --> 00:22:57,560
and it actually works fine with regular
cards to

402
00:22:57,560 --> 00:23:00,830
teas at Assumption so

403
00:23:00,830 --> 00:23:07,110
if I tried to swipe a MetroCard

404
00:23:07,110 --> 00:23:09,150
I should run over to show you what it
looks like when

405
00:23:09,150 --> 00:23:13,230
when you don't make assumptions but so
you'll notice that

406
00:23:13,230 --> 00:23:16,650
a it goes right away 0110 right so
there's no

407
00:23:16,650 --> 00:23:19,690
series of talking to 20 Dakota and you
have to make the assumption that the

408
00:23:19,690 --> 00:23:21,130
first one is going to be 0

409
00:23:21,130 --> 00:23:24,720
so

410
00:23:24,720 --> 00:23:28,370
now let's see I have a slide

411
00:23:28,370 --> 00:23:34,020
that shows you sorry followed the fields
on a major car that so far

412
00:23:34,020 --> 00:23:37,730
accorded on track three

413
00:23:37,730 --> 00:23:41,090
okay let the first let me explain the
format the MetroCard but

414
00:23:41,090 --> 00:23:44,459
a mitten the MetroCard has when the
white magnetic stripe which means that

415
00:23:44,460 --> 00:23:45,970
it's actually three track card

416
00:23:45,970 --> 00:23:49,260
the track number three witches

417
00:23:49,260 --> 00:23:53,160
at the top of the card is all static
data so all this stuff does

418
00:23:53,160 --> 00:23:57,490
does never I'm sorry all this all the
stuff that you see here never changes

419
00:23:57,490 --> 00:24:02,530
this is all the same from when you buy
the card when US used car nothing ever

420
00:24:02,530 --> 00:24:03,200
changes here

421
00:24:03,200 --> 00:24:06,380
and you find stuff like the car type the
expiration date

422
00:24:06,380 --> 00:24:10,010
serial number stuff like that there's a
lot of stuff that I don't

423
00:24:10,010 --> 00:24:15,470
exactly know what is for a unfortunately
it's not easy to find that out because

424
00:24:15,470 --> 00:24:16,210
this

425
00:24:16,210 --> 00:24:20,430
it never changes on now and I'll explain
how I found out

426
00:24:20,430 --> 00:24:23,460
what's on track 12 later but

427
00:24:23,460 --> 00:24:28,130
starts at No time the time feels kinda
weird there's thirst

428
00:24:28,130 --> 00:24:31,890
there's two time fields and I sort of
have to be you can eat together to get

429
00:24:31,890 --> 00:24:33,080
an actual time reading

430
00:24:33,080 --> 00:24:37,149
how the card subtype which is different
from the car type

431
00:24:37,150 --> 00:24:40,840
which is switches track which is number
two on here

432
00:24:40,840 --> 00:24:44,550
and car type basically says okay this is
a standard metro card that you can buy

433
00:24:44,550 --> 00:24:45,669
from a vending machine

434
00:24:45,670 --> 00:24:48,930
other car types to be employee cards or
student cards

435
00:24:48,930 --> 00:24:54,090
arm stuff that major at cart subtype
basically says

436
00:24:54,090 --> 00:24:57,590
okay this is a one-day eliminate or this
is

437
00:24:57,590 --> 00:25:01,409
a full fare card or 230 damn a mini car
to basically tells you what type of card

438
00:25:01,410 --> 00:25:01,820
is

439
00:25:01,820 --> 00:25:05,860
time is at the last time you used it

440
00:25:05,860 --> 00:25:10,210
the day is same thing lest they use it

441
00:25:10,210 --> 00:25:13,920
number six is the number of times he's
the car so every time you go through

442
00:25:13,920 --> 00:25:15,430
again that number gets incremented

443
00:25:15,430 --> 00:25:21,090
seven is the expiration date 8 is the
transfer bit which means

444
00:25:21,090 --> 00:25:25,280
did you use the less weight as a trance
for got as a transfer and this is what

445
00:25:25,280 --> 00:25:29,860
allows the turnstiles to know that
you're not transferring twice nine is

446
00:25:29,860 --> 00:25:31,140
the last used I D

447
00:25:31,140 --> 00:25:34,360
which basically is

448
00:25:34,360 --> 00:25:39,240
unique to each turnstile or bus aids the
card value

449
00:25:39,240 --> 00:25:42,910
which is an interesting field but be is
the purchase ID

450
00:25:42,910 --> 00:25:46,780
which is unique to each any machine or
both a bite from

451
00:25:46,780 --> 00:25:50,750
actually you know what I can get back I
don't know if the booths are unique or

452
00:25:50,750 --> 00:25:51,570
if thats

453
00:25:51,570 --> 00:25:55,320
a separate identifiers but each vending
machine is definitely unique

454
00:25:55,320 --> 00:25:58,810
and see I don't really know what it is
on

455
00:25:58,810 --> 00:26:02,460
a couple of the unknown fields could be
checksums I don't I don't know

456
00:26:02,460 --> 00:26:05,630
it would help if I knew because then I
could verify that this white it is

457
00:26:05,630 --> 00:26:08,880
actually valid on but I don't know

458
00:26:08,880 --> 00:26:11,920
what C is here and I don't know a whole
bunch of what's on track three

459
00:26:11,920 --> 00:26:14,930
so the weight the way that i won about

460
00:26:14,930 --> 00:26:18,930
reverse engineering a MetroCard is
basically buying a whole lotta

461
00:26:18,930 --> 00:26:19,690
MetroCards

462
00:26:19,690 --> 00:26:25,330
and take taking each card in comparing
to each other based on what I know about

463
00:26:25,330 --> 00:26:25,970
the card

464
00:26:25,970 --> 00:26:29,200
so for track to be for example I knew
the car type

465
00:26:29,200 --> 00:26:32,980
and every single card that I would get
was pretty much all the same types on

466
00:26:32,980 --> 00:26:36,960
I didn't really know what that was until
people started sending me different

467
00:26:36,960 --> 00:26:38,300
cards like student cards and

468
00:26:38,300 --> 00:26:41,820
employee cards and stuff like that um

469
00:26:41,820 --> 00:26:46,200
the expiration date is related to

470
00:26:46,200 --> 00:26:49,670
when the card expires it so I

471
00:26:49,670 --> 00:26:53,290
there's there's some algorithm that I
was playing around with and I have a

472
00:26:53,290 --> 00:26:56,970
bunch of conditionals in a bunch of
stuff that sort of works and I could

473
00:26:56,970 --> 00:26:58,670
sort of get the expiration date but

474
00:26:58,670 --> 00:27:02,880
arm its it's pretty closely related to
the expiration date

475
00:27:02,880 --> 00:27:05,890
a month n year and

476
00:27:05,890 --> 00:27:10,240
they always expire unless they the month
I i can.

477
00:27:10,240 --> 00:27:13,690
I can talk about the source code may be
a bit later or word answer questions

478
00:27:13,690 --> 00:27:15,530
about if I have time I don't know if I
have time

479
00:27:15,530 --> 00:27:18,760
but 65 is unknown

480
00:27:18,760 --> 00:27:23,410
I don't know what that's for six is
always constant seven is also unknown

481
00:27:23,410 --> 00:27:27,170
it is the serial number which is just a
binary representation of the decimal

482
00:27:27,170 --> 00:27:28,450
serial number that's on

483
00:27:28,450 --> 00:27:31,640
on the back of the card and then a
couple of other

484
00:27:31,640 --> 00:27:37,280
unknown fields and the inset know any
intent not always the same

485
00:27:37,280 --> 00:27:40,700
offer track 1&2 I when I did it was

486
00:27:40,700 --> 00:27:44,690
by a whole which you've a metro card for
example for the serial number I can

487
00:27:44,690 --> 00:27:45,480
explain that

488
00:27:45,480 --> 00:27:49,600
I would buy off a bridge card from the
same she nor from the same clerk

489
00:27:49,600 --> 00:27:52,600
and the serial numbers would be but

490
00:27:52,600 --> 00:27:56,200
adjacent to each other so for he and for
example here dancin 303 the National be

491
00:27:56,200 --> 00:27:57,679
three or four in 305

492
00:27:57,679 --> 00:28:01,590
and so I was very easily able to compare
the data on

493
00:28:01,590 --> 00:28:04,650
on those track number 3 in C okay you

494
00:28:04,650 --> 00:28:08,090
where in this holster in a binary
numbers in mind for many buy one every

495
00:28:08,090 --> 00:28:09,640
time

496
00:28:09,640 --> 00:28:14,170
and it was very easy to see okay so this
field is a serial number from there so K

497
00:28:14,170 --> 00:28:18,130
that once done for the expiration date I

498
00:28:18,130 --> 00:28:21,080
you know that took a little longer
because he had you had to get card that

499
00:28:21,080 --> 00:28:22,149
expired on different I

500
00:28:22,150 --> 00:28:25,600
at different times and and notice that
that's the piece of information I was

501
00:28:25,600 --> 00:28:28,360
changed to as you will as you eliminate
more and more fuel to get easier to

502
00:28:28,360 --> 00:28:29,570
narrow it down

503
00:28:29,570 --> 00:28:32,689
I since I knew that tractor was that
again it never changed

504
00:28:32,690 --> 00:28:36,870
um you know I was very easy it was very
easy to guess that's probably the

505
00:28:36,870 --> 00:28:40,710
expiration dates privacy on ambers
probably other stuff that never changes

506
00:28:40,710 --> 00:28:44,120
check 1&2 it was all a bit harder by

507
00:28:44,120 --> 00:28:47,150
I had to buy a lot more MetroCards

508
00:28:47,150 --> 00:28:51,700
and and and use them at know for for no
reason really I don't have to go

509
00:28:51,700 --> 00:28:52,530
anywhere

510
00:28:52,530 --> 00:28:56,330
um 7 so site I use the MetroCards

511
00:28:56,330 --> 00:28:59,840
and immediately after use them I read
them

512
00:28:59,840 --> 00:29:03,320
and I was able to guide the first thing
that was that was apparent was at the

513
00:29:03,320 --> 00:29:05,330
card values actually start on the card

514
00:29:05,330 --> 00:29:08,879
it's a it's pretty obvious where it is
so that was siddig

515
00:29:08,880 --> 00:29:13,200
to that was decreased by you know two
dollars or dollar fee might have in a

516
00:29:13,200 --> 00:29:15,610
dollar fifty when I was working on
several every time

517
00:29:15,610 --> 00:29:19,140
that the card to swipe so I knew that
was the car value and

518
00:29:19,140 --> 00:29:22,230
I was pretty stunned at that a

519
00:29:22,230 --> 00:29:26,400
I found the purchase ID I knew that
everything that I bought from

520
00:29:26,400 --> 00:29:29,429
the same monitor carbon emissions the
same I

521
00:29:29,429 --> 00:29:32,750
I was able to find the transfer bit
which is just one single binary

522
00:29:32,750 --> 00:29:36,340
digit which basically says have used his
card for transfer

523
00:29:36,340 --> 00:29:41,170
the expiration date this is use for on
the many cards

524
00:29:41,170 --> 00:29:44,890
it's not the expiration date that's on
the back of the card which is different

525
00:29:44,890 --> 00:29:48,090
and the number of times you that was
increased by one every time I use the

526
00:29:48,090 --> 00:29:49,070
card

527
00:29:49,070 --> 00:29:52,340
and and explain what with everything
else was

528
00:29:52,340 --> 00:29:55,450
okay so some the summer the interesting
stuff about the MetroCard

529
00:29:55,450 --> 00:30:01,260
I like I said before the that the values
actually start on the card there's no

530
00:30:01,260 --> 00:30:04,530
this is not an online system in the
sense that your card

531
00:30:04,530 --> 00:30:08,320
is authenticated with any server as soon
as you use it because it's not

532
00:30:08,320 --> 00:30:11,700
not from from what I've been told by

533
00:30:11,700 --> 00:30:15,420
MTA employees and and this isn't really
verified so

534
00:30:15,420 --> 00:30:19,390
I could be wrong and maybe there's some
key employees here who can crack me or

535
00:30:19,390 --> 00:30:21,240
maybe not

536
00:30:21,240 --> 00:30:24,750
but I the also

537
00:30:24,750 --> 00:30:29,450
there I'm sorry there's don't there's
also patents on line the people who

538
00:30:29,450 --> 00:30:33,750
need this technology are is a company
called cubic transportation systems

539
00:30:33,750 --> 00:30:37,070
he be transportation systems have filed
other patents

540
00:30:37,070 --> 00:30:40,730
with a pretty good representations at
how the systems work

541
00:30:40,730 --> 00:30:44,210
so a lot the other information and i got
was from the patents which is a pretty

542
00:30:44,210 --> 00:30:46,900
valuable resource if you trying to
reverse engineer things

543
00:30:46,900 --> 00:30:52,179
they're not very technically in-depth
but you can get a pre

544
00:30:52,179 --> 00:30:55,890
pretty pretty good representation of how
the system works and and where you sort

545
00:30:55,890 --> 00:30:57,440
of want to focus

546
00:30:57,440 --> 00:31:00,970
cell from the pens and from what I've
been told for men came ploys the system

547
00:31:00,970 --> 00:31:01,800
is

548
00:31:01,800 --> 00:31:04,940
a is is semi online

549
00:31:04,940 --> 00:31:09,800
the turnstiles synchronize with as a
station computer and the station

550
00:31:09,800 --> 00:31:11,250
computer synchronizes

551
00:31:11,250 --> 00:31:15,480
with maybe region computer and then all
those computers are synchronized

552
00:31:15,480 --> 00:31:18,870
with on I mean server that's located

553
00:31:18,870 --> 00:31:22,310
on J Street in Brooklyn or something I
okay so

554
00:31:22,310 --> 00:31:25,510
what what that gives them the ability to
do is disable certain

555
00:31:25,510 --> 00:31:28,810
serial numbers so you see those
advertisements all the time if you've

556
00:31:28,810 --> 00:31:32,260
lost your card and pay with a credit
card you can very easily

557
00:31:32,260 --> 00:31:36,190
get refund in Seoul they look it up with
your credit card also know exactly where

558
00:31:36,190 --> 00:31:37,190
you've been

559
00:31:37,190 --> 00:31:40,460
I and then they're able to disable the
serial number

560
00:31:40,460 --> 00:31:44,040
so that's that's one convenient thing I

561
00:31:44,040 --> 00:31:47,820
unfortunately that doesn't work so well
for buses so

562
00:31:47,820 --> 00:31:51,210
the buses are only synchronized when the
when the doc again

563
00:31:51,210 --> 00:31:55,100
at the station so I'm told and

564
00:31:55,100 --> 00:31:58,510
that's when their databases are updated
so there's no sorta verification of how

565
00:31:58,510 --> 00:32:01,408
much money is actually on the card

566
00:32:01,409 --> 00:32:04,650
which is which is interesting and and is
one of the clues

567
00:32:04,650 --> 00:32:08,210
as to how this card many things working
cell

568
00:32:08,210 --> 00:32:12,150
okay so also what you're fine the on the
MetroCard

569
00:32:12,150 --> 00:32:16,590
is what I mentioned before about that
strange bit and that's changed is

570
00:32:16,590 --> 00:32:20,050
almost exactly in the center the card
and

571
00:32:20,050 --> 00:32:23,610
it's there because it's separating two
different records track three is just

572
00:32:23,610 --> 00:32:24,490
one single record

573
00:32:24,490 --> 00:32:27,620
but tracks 1&2 I which are identical

574
00:32:27,620 --> 00:32:32,590
it's just basically one big lie track
actually stores to records

575
00:32:32,590 --> 00:32:35,700
they are one other records is the
current transaction and

576
00:32:35,700 --> 00:32:39,280
another one the record is the last
transaction so for example if I were to

577
00:32:39,280 --> 00:32:41,200
swipe my card

578
00:32:41,200 --> 00:32:45,419
I have a ten dollar prepaid card both
those tracks both those records on track

579
00:32:45,419 --> 00:32:46,220
1&2

580
00:32:46,220 --> 00:32:49,950
would basically say okay you have you
have ten dollars you bought it here you

581
00:32:49,950 --> 00:32:51,110
can use it yet

582
00:32:51,110 --> 00:32:54,540
I you know you haven't used it for
transfer and all this other stuff based

583
00:32:54,540 --> 00:32:54,879
on

584
00:32:54,880 --> 00:32:58,690
the data that start on the tracks the
first time I use it

585
00:32:58,690 --> 00:33:02,290
the the information from the current
feel this push back to the last feel so

586
00:33:02,290 --> 00:33:03,940
that's identical to what he said

587
00:33:03,940 --> 00:33:06,800
and in the current field has all this
new information that says okay I just

588
00:33:06,800 --> 00:33:08,290
used it at this turnstile

589
00:33:08,290 --> 00:33:12,280
I had this much money left and all the
other things

590
00:33:12,280 --> 00:33:16,129
what happens next is a use it again that
day to get pushed back again so

591
00:33:16,130 --> 00:33:20,520
record 12 record one says I have eight
dollars and record to says I have six

592
00:33:20,520 --> 00:33:21,260
dollars

593
00:33:21,260 --> 00:33:24,580
and goes on and goes on and goes on
recently

594
00:33:24,580 --> 00:33:27,620
I okay so im gonna gonna explain now is
exactly how that

595
00:33:27,620 --> 00:33:32,150
exploit worked I think must have you
probably got it by now

596
00:33:32,150 --> 00:33:36,030
when you get to when you get to a point
where you don't have any

597
00:33:36,030 --> 00:33:40,500
value remaining on your card legit value
on your card

598
00:33:40,500 --> 00:33:44,230
track I mean that the second record
still says you have two dollars on it

599
00:33:44,230 --> 00:33:48,000
so what people were doing and I don't
think anybody technique we knew how it

600
00:33:48,000 --> 00:33:49,260
worked but

601
00:33:49,260 --> 00:33:52,330
he probably had a kink in a car and say
wait a second I don't have any value on

602
00:33:52,330 --> 00:33:53,290
our card

603
00:33:53,290 --> 00:33:56,800
I so they got in for free and

604
00:33:56,800 --> 00:34:00,720
tried it again and probably kept doing
until they got it

605
00:34:00,720 --> 00:34:04,690
so what happened was money the records
and has two dollars one of them says it

606
00:34:04,690 --> 00:34:05,929
has your dollar if

607
00:34:05,929 --> 00:34:09,290
if you if you remember back when they
had the Blue Magic card system

608
00:34:09,290 --> 00:34:12,500
the before before the Gold Cards they
had a blue card system

609
00:34:12,500 --> 00:34:16,839
I have been really done analysis at that
but my guess is that they were having a

610
00:34:16,839 --> 00:34:17,879
lot of issues

611
00:34:17,879 --> 00:34:21,219
where mom it was it was very apparent
that we're having

612
00:34:21,220 --> 00:34:24,460
a lot of problems sliding into the
turnstiles and he would stand up for a

613
00:34:24,460 --> 00:34:25,679
lot longer than her standing there

614
00:34:25,679 --> 00:34:29,020
now to try to get into this turns out
because they can read the card

615
00:34:29,020 --> 00:34:32,629
and so this is this is sort of their new
revision of that

616
00:34:32,629 --> 00:34:35,199
and my guess is that they wanted some
sort of redundancy but didn't do a very

617
00:34:35,200 --> 00:34:36,169
well

618
00:34:36,168 --> 00:34:39,710
um what what happens is

619
00:34:39,710 --> 00:34:44,399
you put a kink in the card that only
that only goes up to track three you

620
00:34:44,399 --> 00:34:46,480
can't destroy track three

621
00:34:46,480 --> 00:34:49,580
he destroy tractor you eat it doesn't
work I

622
00:34:49,580 --> 00:34:52,620
you put a kink in the card on tracks 1&2

623
00:34:52,620 --> 00:34:58,600
only and you and your under the
assumption that where you put that kink

624
00:34:58,600 --> 00:35:02,109
prevent it from reading the previous but
the previous record

625
00:35:02,109 --> 00:35:05,359
so you do that you swipe it and it turns
out says

626
00:35:05,359 --> 00:35:08,980
know your card not good because I could
be both tracks you type it again and it

627
00:35:08,980 --> 00:35:09,790
says OK

628
00:35:09,790 --> 00:35:13,600
pre-strike again at this turnstile he's
like that again

629
00:35:13,600 --> 00:35:18,270
actually so I began Yuanqing get so that
it can rewrite data back to the card

630
00:35:18,270 --> 00:35:21,300
and so that you don't get it right there
you don't get a writer

631
00:35:21,300 --> 00:35:24,600
arm and that's it and then the turnstile
opens

632
00:35:24,600 --> 00:35:28,339
and so what they obviously did was they
put some sort of redundancy

633
00:35:28,339 --> 00:35:32,799
in there that look at the previous
record and sort of trusted

634
00:35:32,800 --> 00:35:36,420
hoping that maybe was a current record
because you're not you because if you

635
00:35:36,420 --> 00:35:39,120
destroy the second record you're not
able to read how many times card was

636
00:35:39,120 --> 00:35:40,350
used in

637
00:35:40,350 --> 00:35:43,279
things of that nature that would allow
you to say okay this is the car not the

638
00:35:43,280 --> 00:35:44,270
last record

639
00:35:44,270 --> 00:35:47,800
I different different turn not different
turns out but buses

640
00:35:47,800 --> 00:35:52,100
turnstiles and the path turnstiles
treated differently I don't know exactly

641
00:35:52,100 --> 00:35:53,080
which do what

642
00:35:53,080 --> 00:35:56,799
but some love them right the times
you've got right the current record to a

643
00:35:56,800 --> 00:35:58,040
different side to the card

644
00:35:58,040 --> 00:36:01,550
than the other one so it's not
necessarily always easy to know exactly

645
00:36:01,550 --> 00:36:03,310
where to fold it

646
00:36:03,310 --> 00:36:08,630
but the MTA has recently done something
about that particular exploit which was

647
00:36:08,630 --> 00:36:13,410
to update all their firmware and what
happens is when you swipe your card now

648
00:36:13,410 --> 00:36:17,140
up probably most have you have had to do
this when you reach

649
00:36:17,140 --> 00:36:21,440
two dollars in your bout you but deplete
your card

650
00:36:21,440 --> 00:36:24,589
yes to dislike it again and what it does
is

651
00:36:24,589 --> 00:36:27,970
it copies that they'd over again
basically runs the same routine edited

652
00:36:27,970 --> 00:36:29,250
the first time he's liked it

653
00:36:29,250 --> 00:36:33,609
and copies the data to their comps the
last record so the last record now when

654
00:36:33,609 --> 00:36:34,450
you swipe it

655
00:36:34,450 --> 00:36:38,170
says that there's no money remaining on
the card

656
00:36:38,170 --> 00:36:45,170
I the only do that when you have two
dollars remaining on the card

657
00:36:45,390 --> 00:36:47,069
okay

658
00:36:47,070 --> 00:36:50,880
so anyway I some some places still don't
do that

659
00:36:50,880 --> 00:36:54,630
I you the path turnstiles don't do that
yet

660
00:36:54,630 --> 00:36:59,350
maybe they will now um and and a couple
other places I

661
00:36:59,350 --> 00:37:02,400
the only reason I ever use this was to
play around because I want to learn how

662
00:37:02,400 --> 00:37:05,660
to work its it okay so tell your story

663
00:37:05,660 --> 00:37:10,379
I the for the first time the first time
that I heard this is possible

664
00:37:10,380 --> 00:37:13,410
was when I was young and I even

665
00:37:13,410 --> 00:37:18,270
playing in the Union Station station I
was with I was actually with a friend a

666
00:37:18,270 --> 00:37:20,590
minor like dollars can possibly work
happened

667
00:37:20,590 --> 00:37:24,220
you get a free ride with you know
spending by Ben Cardin

668
00:37:24,220 --> 00:37:27,670
we were we were there for 10 minutes and
I

669
00:37:27,670 --> 00:37:30,970
didn't look up at the ceilings that the
cameras that I didn't know where their

670
00:37:30,970 --> 00:37:34,840
and and we're just playing with the
turnstile and not doing anything wrong

671
00:37:34,840 --> 00:37:35,310
burden

672
00:37:35,310 --> 00:37:39,480
you know we weren't blocking traffic or
anything but this was actually before

673
00:37:39,480 --> 00:37:43,850
I even believe that it worked and so I
was playing I was playing out by we

674
00:37:43,850 --> 00:37:45,680
pride there for maybe 10-15 minutes

675
00:37:45,680 --> 00:37:48,730
and and finally the turnstile and I was
like well

676
00:37:48,730 --> 00:37:51,910
so I I was like wow this is really cool
so I

677
00:37:51,910 --> 00:37:55,299
go around the turnstile like you know
those big

678
00:37:55,300 --> 00:37:58,610
turnstiles reaching go around if you
really want to but that's to be because

679
00:37:58,610 --> 00:37:59,010
these

680
00:37:59,010 --> 00:38:02,320
whose affair well I did then the cost
probably thought that was kinda strange

681
00:38:02,320 --> 00:38:06,760
so the Indian so two officers came down
and they're like wat you know what you

682
00:38:06,760 --> 00:38:09,670
doing any idea and i got a 75 that

683
00:38:09,670 --> 00:38:12,960
$75 dollar ticket for turnstile
manipulation cell

684
00:38:12,960 --> 00:38:16,850
the so their 30 like they know about
this stuff don't do it

685
00:38:16,850 --> 00:38:20,330
i mean you could still get away with it
under certain circumstances but

686
00:38:20,330 --> 00:38:25,200
its it's one of those vulnerabilities
that just don't do it

687
00:38:25,200 --> 00:38:28,220
um its it's it's nice to learn how the
system works

688
00:38:28,220 --> 00:38:31,960
and by the way there

689
00:38:31,960 --> 00:38:36,070
they're looking to implementing our
fight the a system as well

690
00:38:36,070 --> 00:38:39,480
so I i'm

691
00:38:39,480 --> 00:38:42,590
I'm looking forward to seeing how that
works I think the first people that are

692
00:38:42,590 --> 00:38:44,440
actually going to do if you're curious
about it

693
00:38:44,440 --> 00:38:47,640
are the have people make

694
00:38:47,640 --> 00:38:51,900
who hasn't really

695
00:38:51,900 --> 00:38:56,910
they have that they have them

696
00:38:56,910 --> 00:39:00,808
yeah okay so so ATI I know you talking
about they have I think they have some

697
00:39:00,809 --> 00:39:02,640
are fighting readers for the handicapped

698
00:39:02,640 --> 00:39:07,279
entries is that right okay so

699
00:39:07,279 --> 00:39:12,069
right so right

700
00:39:12,069 --> 00:39:15,979
okay no I don't think right okay so so
they're starting to do this and I think

701
00:39:15,979 --> 00:39:18,579
they're they're playing within some
experimental stage but the first people

702
00:39:18,579 --> 00:39:20,210
where you're probably gonna be able the

703
00:39:20,210 --> 00:39:24,289
by I a cartoonist is with the

704
00:39:24,289 --> 00:39:27,880
with the path people let me let me show
you an example love I love

705
00:39:27,880 --> 00:39:32,619
what happens when you slight matter car
because I'm to demo than

706
00:39:32,619 --> 00:39:36,609
so pppp okay

707
00:39:36,609 --> 00:39:39,749
so let me show you an example love

708
00:39:39,749 --> 00:39:43,099
unfortunate thing I brought exploit
workers here but these are all these are

709
00:39:43,099 --> 00:39:44,819
these are these are back when

710
00:39:44,819 --> 00:39:47,700
they didn't update the firmware yet so
this is just an example what used to be

711
00:39:47,700 --> 00:39:48,289
able to do

712
00:39:48,289 --> 00:39:52,670
okay so this is this is a seven day
unlimited

713
00:39:52,670 --> 00:39:55,829
7a expressed some eminent on

714
00:39:55,829 --> 00:39:59,229
and you can see that here a

715
00:39:59,229 --> 00:40:04,609
you can see someone here this is just
the prospect that I wrote to take all

716
00:40:04,609 --> 00:40:06,499
that binary data and the code and

717
00:40:06,499 --> 00:40:10,890
look look at in the next few and the the
hexadecimal visa really handy when

718
00:40:10,890 --> 00:40:12,109
you're trying to figure out which

719
00:40:12,109 --> 00:40:16,630
each field means by the but then I have
a parse field which

720
00:40:16,630 --> 00:40:21,119
makes it sort of human readable and you
can see the times when this card is last

721
00:40:21,119 --> 00:40:23,819
year's and also how many times it was
used in

722
00:40:23,819 --> 00:40:28,420
it's really funny when you find like 30
Day cards on the for the Havanese twice

723
00:40:28,420 --> 00:40:32,059
expired expired today they find song I
don't know some people don't know what

724
00:40:32,059 --> 00:40:32,609
they're buying

725
00:40:32,609 --> 00:40:36,799
but a well

726
00:40:36,799 --> 00:40:40,700
well yeah but but only

727
00:40:40,700 --> 00:40:46,229
only been used twice L mind again any

728
00:40:46,229 --> 00:40:49,880
okay so anyway yet our gal get you there
on

729
00:40:49,880 --> 00:40:53,960
the did so you can you can basically see
everything about this car and it would

730
00:40:53,960 --> 00:40:54,210
be

731
00:40:54,150 --> 00:40:58,069
its its kinda convenient because the
only other way to get to know what's on

732
00:40:58,069 --> 00:41:01,558
your card is to go to a subway station
where they have won these things

733
00:41:01,559 --> 00:41:06,849
to to learn about it and I it's so so
this this is just the proof that all the

734
00:41:06,849 --> 00:41:07,339
data

735
00:41:07,339 --> 00:41:11,099
that you're getting from those kiosks
are actually all offline data

736
00:41:11,099 --> 00:41:14,559
and let me show you an example love what
you get see

737
00:41:14,559 --> 00:41:17,999
what's right so this is this is a full
fare card

738
00:41:17,999 --> 00:41:21,279
that was used before they had the
firmware update which was done

739
00:41:21,279 --> 00:41:24,420
lots for five months ago maybe a little

740
00:41:24,420 --> 00:41:28,380
longer mmm something around that time
and

741
00:41:28,380 --> 00:41:32,279
the last time you used the card this is
it this is what i'm talking about.

742
00:41:32,279 --> 00:41:33,210
record to

743
00:41:33,210 --> 00:41:36,479
shows that you have two dollars
remaining but record one shows that you

744
00:41:36,479 --> 00:41:37,089
have no

745
00:41:37,089 --> 00:41:43,269
value on the card sign so what happens
is he take

746
00:41:43,269 --> 00:41:46,299
you take the first record and and that's
what was happening they were destroying

747
00:41:46,299 --> 00:41:47,109
the first record

748
00:41:47,109 --> 00:41:49,739
and that's how the end and didn't really
know what they're doing but they're

749
00:41:49,739 --> 00:41:51,690
getting free rides on

750
00:41:51,690 --> 00:41:54,890
some summer the at sea ahead of paths

751
00:41:54,890 --> 00:41:58,460
having so so the path people should fix
this please

752
00:41:58,460 --> 00:42:02,619
this is what happens on the PATH train
this I just use this

753
00:42:02,619 --> 00:42:05,940
some the dollar 50

754
00:42:05,940 --> 00:42:09,829
it's cheaper than the MTA so you can't
so even though it's exploitable

755
00:42:09,829 --> 00:42:13,910
you can't really do the Bands thing
anymore anyway because

756
00:42:13,910 --> 00:42:17,460
you feed them into the machine to numb
the stuff I'm showing you can actually

757
00:42:17,460 --> 00:42:18,450
still be used anymore

758
00:42:18,450 --> 00:42:21,509
but you the the path

759
00:42:21,509 --> 00:42:25,509
turnstiles actually suck your card and I
don't know how many views them

760
00:42:25,509 --> 00:42:28,789
but there's not there's no way to really
put a kink in it manipulated the way you

761
00:42:28,789 --> 00:42:30,410
would have to tease the old explain

762
00:42:30,410 --> 00:42:35,549
but they still they still don't do this
we still don't take this value and

763
00:42:35,549 --> 00:42:39,529
right over it without a you know when on
upon the last use

764
00:42:39,529 --> 00:42:43,579
um Nazi

765
00:42:43,579 --> 00:42:46,670
Okanagan showing more cards are you it's
all it's all very similar it's all very

766
00:42:46,670 --> 00:42:47,229
boring

767
00:42:47,229 --> 00:42:51,229
um but it's it's basically all this
offline data that you can find on the

768
00:42:51,229 --> 00:42:51,819
MetroCard

769
00:42:51,819 --> 00:42:55,150
I'm not I some cool things you can do
with the reader a

770
00:42:55,150 --> 00:42:59,140
when I was when I was doing all this
research into how you actually

771
00:42:59,140 --> 00:43:03,038
reverse engineer the MetroCard and and
and finding all those fields and stuff

772
00:43:03,039 --> 00:43:06,079
it wasn't very convenient to take my
laptop that every time I wanted to

773
00:43:06,079 --> 00:43:09,579
swipe a card so what what's what sort of
convening about this interface is that

774
00:43:09,579 --> 00:43:12,549
it's just a standard 3.5 millimeter Jack
in all it is is audio

775
00:43:12,549 --> 00:43:16,329
so if you have an mp3 player with with
recording capabilities

776
00:43:16,329 --> 00:43:19,599
you can take you can take this interface
is here

777
00:43:19,599 --> 00:43:22,960
mp3 recorder and 10 the last versions
have

778
00:43:22,960 --> 00:43:27,670
this offer can actually read

779
00:43:27,670 --> 00:43:30,930
any file that would sound file supports
how much time okay I have

780
00:43:30,930 --> 00:43:34,410
I'm gonna leave it open to question and
answers now but that there's some cool

781
00:43:34,410 --> 00:43:35,569
things that you can do

782
00:43:35,569 --> 00:43:40,589
I and and and make really portable
readers based on this design and

783
00:43:40,589 --> 00:43:44,710
and you know it's its its interesting
because

784
00:43:44,710 --> 00:43:47,999
you realize when when using something
small to record

785
00:43:47,999 --> 00:43:52,089
raw data of a magnetic stripe out how
easy it is when you give your credit

786
00:43:52,089 --> 00:43:53,119
card here

787
00:43:53,119 --> 00:43:57,739
a or debit card to a cashier or
restaurant waiter and waitress

788
00:43:57,739 --> 00:44:00,869
that you know they can possibly have a
device like this and just grab all the

789
00:44:00,869 --> 00:44:01,739
information

790
00:44:01,739 --> 00:44:04,479
of it so this is this is just one of
those cool things that you can do with

791
00:44:04,479 --> 00:44:05,809
it there's a bunch of other stuff

792
00:44:05,809 --> 00:44:09,049
but I'm running at a time is always
happens on opening up to Q&A now because

793
00:44:09,049 --> 00:44:10,199
I see people are

794
00:44:10,199 --> 00:44:17,199
lining up

795
00:44:21,300 --> 00:44:24,690
I have two questions one is a plus since
track 1&2 are regrettable

796
00:44:24,690 --> 00:44:27,920
right keeps replay attacks from
occurring on this okay so you couldn't

797
00:44:27,920 --> 00:44:28,530
you can

798
00:44:28,530 --> 00:44:32,200
you can probably copy cards I

799
00:44:32,200 --> 00:44:36,570
the okay so these are very heiko cards
which means that you need a very mixed

800
00:44:36,570 --> 00:44:38,030
on magnetic fields right to you

801
00:44:38,030 --> 00:44:41,730
and it's nothing that I can do with I'm

802
00:44:41,730 --> 00:44:45,650
with this sort of thing I can feed the
output was down hard into a writer and

803
00:44:45,650 --> 00:44:49,080
and time it correctly due out and other
stuff and right to heiko card

804
00:44:49,080 --> 00:44:52,799
if you wanted to do something like quick
our reader and writer adjacent to each

805
00:44:52,800 --> 00:44:54,560
other sort of TP cars together

806
00:44:54,560 --> 00:44:59,210
and then you could probably use any any
audio amplifier IC views like probably

807
00:44:59,210 --> 00:45:01,570
SLI retailers writers are available

808
00:45:01,570 --> 00:45:04,110
commercially and they're not that
expensive right but there but their

809
00:45:04,110 --> 00:45:06,650
commercial writers and their depending
on reading the data

810
00:45:06,650 --> 00:45:09,800
parsing it and then rewriting it with
the with a clocking bits and stuff like

811
00:45:09,800 --> 00:45:14,470
that I recently received from Citibank a
little device called a paper gas

812
00:45:14,470 --> 00:45:18,780
okay okay which is linked to my Citibank
credit card bank sent me a promotion

813
00:45:18,780 --> 00:45:22,530
a piece a paper in the mail recently
that said I could use it

814
00:45:22,530 --> 00:45:27,160
three times for free on the 45 and six
lines where they have RFID

815
00:45:27,160 --> 00:45:31,839
really tag readers and if I pre register
in order a refill my

816
00:45:31,840 --> 00:45:35,230
prepaid account they'll give me six free
rights

817
00:45:35,230 --> 00:45:39,930
circle yeah I know citibank in look
there a lot of chips carts that people

818
00:45:39,930 --> 00:45:40,180
are

819
00:45:40,110 --> 00:45:43,250
starting to use right now for this kind
of thing people who pay taxes

820
00:45:43,250 --> 00:45:47,510
ship you have to use the microphone yes
I V a VIP began here you know he's my

821
00:45:47,510 --> 00:45:47,780
guy

822
00:45:47,780 --> 00:45:52,390
on you in particular so on so

823
00:45:52,390 --> 00:45:55,540
yes sorry about that I am so that that's
very cool I didn't

824
00:45:55,540 --> 00:45:58,240
actually looking to the our fight the
system yet I'm looking forward to

825
00:45:58,240 --> 00:45:59,500
getting some other path hearts

826
00:45:59,500 --> 00:46:02,720
there just are thirty-point by six
megahertz are fighting a very standard

827
00:46:02,720 --> 00:46:03,170
stuff

828
00:46:03,170 --> 00:46:07,270
so I don't know of any I any actual

829
00:46:07,270 --> 00:46:10,150
crypto stuff that's been developed for
use with that so should be interesting

830
00:46:10,150 --> 00:46:11,110
to see how they

831
00:46:11,110 --> 00:46:15,360
manage that since most to the MTA system
right as far as I know right now is

832
00:46:15,360 --> 00:46:15,970
offline

833
00:46:15,970 --> 00:46:20,730
on its mission um very basic question
maybe but can you explain how you make

834
00:46:20,730 --> 00:46:21,540
you read it again

835
00:46:21,540 --> 00:46:24,960
out that the readers very very simple so
the one that's that's the

836
00:46:24,960 --> 00:46:28,330
easiest to use is a surplus reader right
here

837
00:46:28,330 --> 00:46:31,390
are you can get these for like two box
five but something like that you don't

838
00:46:31,390 --> 00:46:32,990
really do anything because

839
00:46:32,990 --> 00:46:36,210
there's there's no interface that's
convenient to use just etiological ap

840
00:46:36,210 --> 00:46:37,480
witness you wanna make your own

841
00:46:37,480 --> 00:46:40,520
I reader or actually there's another
there's another

842
00:46:40,520 --> 00:46:43,920
I open source project called and strike

843
00:46:43,920 --> 00:46:47,830
Snooper something like that I stripes
you may be and

844
00:46:47,830 --> 00:46:51,890
the allow interfacing the TTL logic of
the sort of things to

845
00:46:51,890 --> 00:46:55,040
the game portly still can't read the
Metroparks with them so

846
00:46:55,040 --> 00:46:58,190
what you did what you do which is
basically take the surface reader I

847
00:46:58,190 --> 00:47:01,620
brought all the electronic components
because you don't need them and

848
00:47:01,620 --> 00:47:05,920
cider on a 3.5 millimeter connector
that's that's that's all you have to do

849
00:47:05,920 --> 00:47:06,770
is just too

850
00:47:06,770 --> 00:47:12,000
two conductors they have to solder on
I'm not so sure on in your

851
00:47:12,000 --> 00:47:16,220
in your researching a bit different
cards be like 30 day MetroCard

852
00:47:16,220 --> 00:47:19,350
it actually is a value on it that goes
down into tears that there's no value

853
00:47:19,350 --> 00:47:20,140
it's just %uh i

854
00:47:20,140 --> 00:47:24,690
it's just there's just an expiration
date yeah thank you um

855
00:47:24,690 --> 00:47:28,760
when you swipe the pet your path card
before did that actually take dollar 50

856
00:47:28,760 --> 00:47:30,730
offers or something specific special
about

857
00:47:30,730 --> 00:47:34,500
the reader an MTA that takes that use
the value Kapisa from

858
00:47:34,500 --> 00:47:37,900
track one or no cost to you well the
these the same

859
00:47:37,900 --> 00:47:41,710
these the same II once a protocol but

860
00:47:41,710 --> 00:47:46,010
these these the same system as the MTA
now so that you can use MasterCard in

861
00:47:46,010 --> 00:47:46,540
the path

862
00:47:46,540 --> 00:47:49,670
turnstiles I it's it's not a fixed value

863
00:47:49,670 --> 00:47:53,480
so that they can increase the fares and
and whatnot but also all they do after

864
00:47:53,480 --> 00:47:56,650
without me even understand agree my
question actually is is something

865
00:47:56,650 --> 00:47:58,070
specific about the reader

866
00:47:58,070 --> 00:48:01,510
that takes the that that takes the value
of the Met recorders its wiping the

867
00:48:01,510 --> 00:48:02,710
MetroCard to anything like

868
00:48:02,710 --> 00:48:06,210
when you just like your path toward the
to take the DOL no no no no no I on

869
00:48:06,210 --> 00:48:07,450
doing is reading too with the

870
00:48:07,450 --> 00:48:11,440
actual MTA turnstiles have a whole bunch
of reading right heads inside and see

871
00:48:11,440 --> 00:48:12,090
can actually

872
00:48:12,090 --> 00:48:15,260
take a flashlight and look in there and
you'll notice although we heading right

873
00:48:15,260 --> 00:48:16,130
heads that are in there

874
00:48:16,130 --> 00:48:19,570
so there's a bunch on and its writing
simultaneously

875
00:48:19,570 --> 00:48:24,860
values like to do to read it thanks this
question is regarding

876
00:48:24,860 --> 00:48:29,030
some other it possible data on the card
for example

877
00:48:29,030 --> 00:48:32,880
with this year River with a bunch of
friends and you were to buyer

878
00:48:32,880 --> 00:48:36,900
from like a twenty your MetroCard you
were to keeps if you receive swiping

879
00:48:36,900 --> 00:48:37,810
eventually

880
00:48:37,810 --> 00:48:42,830
I like to think about five or six times
I a week dis allow you to continue

881
00:48:42,830 --> 00:48:46,620
right while the I mean there's probably
there's probably checks on the

882
00:48:46,620 --> 00:48:49,759
on the servers for this sort of behavior
and like I said they have the ability to

883
00:48:49,760 --> 00:48:50,480
disable

884
00:48:50,480 --> 00:48:54,630
they have the ability to disable the
serial numbers so it's not

885
00:48:54,630 --> 00:48:57,730
it's not something that's practical to
do i mean I'd be interested the

886
00:48:57,730 --> 00:49:01,320
if wait for example also view have you
just have one friend he swiped the

887
00:49:01,320 --> 00:49:02,860
MetroCard twice

888
00:49:02,860 --> 00:49:07,070
able then you go to a different location
it will remember to transfers

889
00:49:07,070 --> 00:49:10,550
right now I know you're saying I I think
right I have and I haven't actually

890
00:49:10,550 --> 00:49:12,840
looked into that because that cost a lot
money to

891
00:49:12,840 --> 00:49:16,440
my a lot more money to play with and
just a single transfer also

892
00:49:16,440 --> 00:49:20,300
I I'm totally willing to play with it if
you guys

893
00:49:20,300 --> 00:49:24,440
we have to use a microphone I'm sorry on
there's there's there's

894
00:49:24,440 --> 00:49:27,460
a lot of stuff like to play with and
that if I wanted to spend a lot of money

895
00:49:27,460 --> 00:49:28,050
on

896
00:49:28,050 --> 00:49:30,270
playing with the reverse engineer stuff
I could find out like I said there's a

897
00:49:30,270 --> 00:49:31,870
lot of unknown tracks on here

898
00:49:31,870 --> 00:49:35,630
so that data can be stored somewhere
else if he could have been unused

899
00:49:35,630 --> 00:49:39,040
track so when the implemented this
feature I know they

900
00:49:39,040 --> 00:49:42,130
they started utilizing those tracks so
there's still a lot of work to be done

901
00:49:42,130 --> 00:49:45,860
on this this this is BC basically good
outline of how the system works

902
00:49:45,860 --> 00:49:49,260
and and and where you can start if you
want to learn more about it

903
00:49:49,260 --> 00:49:52,270
but I have a feeling in a couple years
it's probably not going to be as why

904
00:49:52,270 --> 00:49:52,990
these anymore

905
00:49:52,990 --> 00:49:57,150
they'd really do implement the RFID
stuff I Yahoo

906
00:49:57,150 --> 00:50:00,910
I was under the impression that the
whole systems not stored value but

907
00:50:00,910 --> 00:50:02,120
basically

908
00:50:02,120 --> 00:50:05,400
defenders that the baby was stored on
the main system this guy looks like it's

909
00:50:05,400 --> 00:50:06,140
a little of both

910
00:50:06,140 --> 00:50:10,150
I'm I think it may be both I think
they're probably storing records

911
00:50:10,150 --> 00:50:14,320
are all this transaction data on the
main server and then

912
00:50:14,320 --> 00:50:18,150
doing comparisons p.m. but the point is
that meant from what I understood that

913
00:50:18,150 --> 00:50:21,970
copping a car that the other person
that's what basically be useless

914
00:50:21,970 --> 00:50:25,360
he just up with two cars at the same
value but when you took it off one with

915
00:50:25,360 --> 00:50:27,880
the of the other automatically give the
server with

916
00:50:27,880 --> 00:50:31,390
work or from the server see you wouldn't
gain anything right but they but if they

917
00:50:31,390 --> 00:50:34,609
see this crazy stuff happening they're
gonna disable are consuming dated let's

918
00:50:34,610 --> 00:50:35,180
say you had

919
00:50:35,180 --> 00:50:38,339
a card and you copy that Cartwright is
51

920
00:50:38,340 --> 00:50:41,670
this if you're able to go down by the
same amount as well and the study

921
00:50:41,670 --> 00:50:44,860
now not really as a Christian I got to
that what you

922
00:50:44,860 --> 00:50:48,470
%uh their records which show that this
serial number has its value on it but

923
00:50:48,470 --> 00:50:49,720
you can't magically

924
00:50:49,720 --> 00:50:52,620
recommend some magnetic getting
somebody's wallet near but in other

925
00:50:52,620 --> 00:50:55,650
words a system in his fight to get its
not going to look at the records in the

926
00:50:55,650 --> 00:50:59,070
system: it's a way to if not online it's
not a real time

927
00:50:59,070 --> 00:51:02,450
system 13 on the train is in the bus
it's not now I

928
00:51:02,450 --> 00:51:05,860
not on the train either neither are now

929
00:51:05,860 --> 00:51:11,240
rain timex how do you tell if a stream
the three tracks you only have one had

930
00:51:11,240 --> 00:51:11,770
reading

931
00:51:11,770 --> 00:51:15,470
I have I have yes I have one reader had
the one everything that I showed you

932
00:51:15,470 --> 00:51:19,670
this stuff right here is only tracks 1&2
I have to unscrew it and move the read

933
00:51:19,670 --> 00:51:20,730
head if I wanna read

934
00:51:20,730 --> 00:51:23,620
track three by its three is really
exciting either because it's all static

935
00:51:23,620 --> 00:51:25,350
data it's not that never changes

936
00:51:25,350 --> 00:51:28,440
from the time that you get the car to
the time they throw it out

937
00:51:28,440 --> 00:51:31,510
so yes you can I you can use the same
the

938
00:51:31,510 --> 00:51:34,860
script I don't know if I have it on my
putting on my no I you can use the same

939
00:51:34,860 --> 00:51:35,460
script

940
00:51:35,460 --> 00:51:38,490
to the coat rack treats its not a
problem well

941
00:51:38,490 --> 00:51:43,940
only put the at website up

942
00:51:43,940 --> 00:51:47,580
I okay so implications you know you
could you you could be the stuff I I

943
00:51:47,580 --> 00:51:48,390
mention it already

944
00:51:48,390 --> 00:51:51,250
this is where this is where the articles
are and this is where I can get the

945
00:51:51,250 --> 00:51:52,360
softer and

946
00:51:52,360 --> 00:51:55,570
the articles which describe how to make
this if you want there's a couple

947
00:51:55,570 --> 00:51:56,780
pictures of these readers

948
00:51:56,780 --> 00:52:00,030
in and I'm on the web page question

949
00:52:00,030 --> 00:52:04,080
yeahh I am first we'll all the scripts
be available

950
00:52:04,080 --> 00:52:07,490
I can definitely making them all the
software is available with Dad decoder

951
00:52:07,490 --> 00:52:10,180
and not the MSP which decodes the
binaries this

952
00:52:10,180 --> 00:52:13,200
all available online and when he saw the
read head to the a.m

953
00:52:13,200 --> 00:52:17,090
wires apply reasons alone is a1 clarity
sensitive

954
00:52:17,090 --> 00:52:19,770
no not at all thank you the pics you
would just go in the other direction

955
00:52:19,770 --> 00:52:22,500
snot

956
00:52:22,500 --> 00:52:27,440
okay question thanks it was a difference
between swipe again and swipe again at

957
00:52:27,440 --> 00:52:28,470
this turnstile

958
00:52:28,470 --> 00:52:33,170
what point does the switchover okay size
that's why to get this turn south means

959
00:52:33,170 --> 00:52:33,720
that

960
00:52:33,720 --> 00:52:37,070
irregular heart and might have done a
partial right or

961
00:52:37,070 --> 00:52:40,980
might've written on some other card and
then you screwed up or something so

962
00:52:40,980 --> 00:52:44,520
if you don't slightly to get that same
time at the same turnstile because that

963
00:52:44,520 --> 00:52:45,220
firmware

964
00:52:45,220 --> 00:52:48,640
is what has the accurate data for your
card so that it can rewrite it began

965
00:52:48,640 --> 00:52:49,470
with the correct data

966
00:52:49,470 --> 00:52:52,960
you're gonna lose your fair where you
gonna corrupt your heart so slight begin

967
00:52:52,960 --> 00:52:55,730
at this turns down means that it
probably already did a partial right

968
00:52:55,730 --> 00:53:01,400
from what I can tell next I have you
done any experimentation with

969
00:53:01,400 --> 00:53:05,050
writing to MetroCards I i've I haven't
done it with writing

970
00:53:05,050 --> 00:53:08,170
MetroCard because like I said it's a
very heiko card

971
00:53:08,170 --> 00:53:12,780
um I played a little bit with the same
sort of thing using a sound card to

972
00:53:12,780 --> 00:53:14,440
create a way for me to write to you

973
00:53:14,440 --> 00:53:19,650
and other car but my problem with that
is it's hard to get the velocity crack

974
00:53:19,650 --> 00:53:22,640
and it's hard to make sure that you're
not reading of the into the card in its

975
00:53:22,640 --> 00:53:23,310
heart n

976
00:53:23,310 --> 00:53:26,730
it's hard to get it so that your date
expense for the full card if I was able

977
00:53:26,730 --> 00:53:27,170
them

978
00:53:27,170 --> 00:53:30,230
make something which I didn't have time
to do that had a roller ended and I

979
00:53:30,230 --> 00:53:32,000
could time it to see along to back in

980
00:53:32,000 --> 00:53:36,140
tweet away form to actually write it so
it's definitely possible misconduct

981
00:53:36,140 --> 00:53:39,140
definitely be developed but it's not as
simple as you know

982
00:53:39,140 --> 00:53:43,049
this project was with a higher budget
then write like for five dollars and

983
00:53:43,050 --> 00:53:45,590
needed to write my car right but it's
definitely possible

984
00:53:45,590 --> 00:53:49,900
now I've been able to I have some %uh
those cards after talk

985
00:53:49,900 --> 00:53:53,520
you know like maybe half hour an hour
playing around it to get it just right

986
00:53:53,520 --> 00:53:55,030
to be able to regain self

987
00:53:55,030 --> 00:53:58,590
it it's definitely possible you if you
use a local card that doesn't require

988
00:53:58,590 --> 00:54:02,950
much power to rate him thanks

989
00:54:02,950 --> 00:54:06,620
um just thinking about TCP sequence
numbers in a hollow

990
00:54:06,620 --> 00:54:09,810
so it could be a vulnerability in
seeking perhaps with the serial numbers

991
00:54:09,810 --> 00:54:10,779
of these cards

992
00:54:10,780 --> 00:54:14,130
and they have a high probability that a
new card

993
00:54:14,130 --> 00:54:17,940
has a large value to think that supply
ability: I don't think

994
00:54:17,940 --> 00:54:21,390
I don't think it's a vulnerability
because I while he could eventually

995
00:54:21,390 --> 00:54:23,089
become a vulnerability because I'd

996
00:54:23,090 --> 00:54:26,320
don't have a full I spec

997
00:54:26,320 --> 00:54:29,170
for the MetroCard I don't know what a
lot of the unknown fields are so it's

998
00:54:29,170 --> 00:54:30,130
not possible

999
00:54:30,130 --> 00:54:33,240
as far as I know right now to create
your own MetroCard

1000
00:54:33,240 --> 00:54:36,320
I don't know if I want that to be
possible because

1001
00:54:36,320 --> 00:54:40,070
the only thing that people are going to
be easy using it for is you know for

1002
00:54:40,070 --> 00:54:41,970
fighting these bites it's definitely

1003
00:54:41,970 --> 00:54:45,070
it's definitely observable that this
could be a vulnerability if you were

1004
00:54:45,070 --> 00:54:46,040
able to predict

1005
00:54:46,040 --> 00:54:49,400
a serial number and you will be able to
print and you were able to you

1006
00:54:49,400 --> 00:54:53,470
guess that okay it's most likely one of
the common values like its most likely

1007
00:54:53,470 --> 00:54:55,450
attend a card or twenty dollar hard

1008
00:54:55,450 --> 00:54:59,520
and and and that's that's certainly a
possibility next question

1009
00:54:59,520 --> 00:55:05,410
yet another time on I for male heir was
cards used another subway systems

1010
00:55:05,410 --> 00:55:10,690
I I i havent done any work on them I
know cubic also does she have a system

1011
00:55:10,690 --> 00:55:13,920
the Chicago cards look almost identical
you the MetroCard

1012
00:55:13,920 --> 00:55:18,300
I same exact physical format I'm running
at I'm sorry

1013
00:55:18,300 --> 00:55:21,880
%uh same exact physical format the data
structure is slightly different

1014
00:55:21,880 --> 00:55:26,420
I i have I have them I just I just
didn't do any work I reverse engineering

1015
00:55:26,420 --> 00:55:31,820
RT and fine or I was the Moscow subway
system had unexplained for a very long

1016
00:55:31,820 --> 00:55:32,450
time

1017
00:55:32,450 --> 00:55:37,180
where they also had redundant data but
hitter for tizzy I do it was completely

1018
00:55:37,180 --> 00:55:37,960
redundant

1019
00:55:37,960 --> 00:55:41,740
solviva race I guess a to guard against
damages a card

1020
00:55:41,740 --> 00:55:45,260
right right for that yet that would make
sense but then there's also explains for

1021
00:55:45,260 --> 00:55:46,280
that in which I N

1022
00:55:46,280 --> 00:55:49,260
you can yeah play with it when it's
running back to the card said when it's

1023
00:55:49,260 --> 00:55:53,140
right people with very low would just
tape over exactly right so that you can

1024
00:55:53,140 --> 00:55:54,420
write back to the car by

1025
00:55:54,420 --> 00:55:57,970
when you want a beer able to read that
data also one small question: I might

1026
00:55:57,970 --> 00:56:01,200
have missus have you looked into a
single right and bus transfers

1027
00:56:01,200 --> 00:56:05,060
I've got the I put in a single rides I
they a corrupt all their data

1028
00:56:05,060 --> 00:56:08,450
where they make it unreadable to me
after you use it the first time

1029
00:56:08,450 --> 00:56:12,420
so I don't I don't know much about those
cards

1030
00:56:12,420 --> 00:56:15,540
there's it's it's it's hard to do
analysis of something that straight

1031
00:56:15,540 --> 00:56:18,560
south after you use it so I haven't
really played with it that much

1032
00:56:18,560 --> 00:56:21,670
for camp sorry we're at a time

1033
00:56:21,670 --> 00:56:25,260
about us aren't if I anyways questions
can now

1034
00:56:25,260 --> 00:56:27,660
the chill factor thanks

