1
00:00:00,900 --> 00:00:03,480
please enjoy taking a bite out of logs
were thinkin

2
00:00:03,480 --> 00:00:06,500
I present to you the beef checkoff the
third

3
00:00:06,500 --> 00:00:10,980
thank you

4
00:00:10,980 --> 00:00:14,049
alright through this together

5
00:00:14,049 --> 00:00:18,390
work sometime in here from Steve us so
many jim Kerr Cairo

6
00:00:18,390 --> 00:00:22,680
do little project called Sagan so sick
and basically the log analysis engine

7
00:00:22,680 --> 00:00:26,259
and if you're interested in it these are
the website you can go to don the bottom

8
00:00:26,260 --> 00:00:27,099
there in the yellow

9
00:00:27,099 --> 00:00:30,920
to get more information about them the
top one is the main site where

10
00:00:30,920 --> 00:00:34,040
source code and think that rule sets and
stuff like that can be

11
00:00:34,040 --> 00:00:38,870
found I am so one thing and you gonna
mention before I get started

12
00:00:38,870 --> 00:00:42,899
among the founding members have these
guys downstairs this year

13
00:00:42,899 --> 00:00:46,789
we have a GSM network setup but actually
that's largely do you

14
00:00:46,789 --> 00:00:49,950
to jay Park and effort so basically it's
a GSM network

15
00:00:49,950 --> 00:00:54,129
that you can use to make calls through
to your cell phone you just need a call

16
00:00:54,129 --> 00:00:57,789
tele for exam like that and you find it
goes downstairs

17
00:00:57,789 --> 00:01:03,190
a to talking generally called you up for
that oh and yes im pay phones are set up

18
00:01:03,190 --> 00:01:03,910
and what not

19
00:01:03,910 --> 00:01:08,740
and the tell a freak area so did reveal
Who Am I am a security researcher I work

20
00:01:08,740 --> 00:01:10,570
for a quarter information security

21
00:01:10,570 --> 00:01:13,979
I did a couple bucks a while back mostly
an ass trick are

22
00:01:13,979 --> 00:01:18,880
that a lot a modem device because
vintage museum Voice over IP and things

23
00:01:18,880 --> 00:01:19,600
of that nature

24
00:01:19,600 --> 00:01:23,479
and I freaking but this year and kinda
changing it up a little bit by

25
00:01:23,479 --> 00:01:27,400
they said they found their toll free:
I'm also elsa rensberg into the open VMs

26
00:01:27,400 --> 00:01:28,729
death row cluster

27
00:01:28,729 --> 00:01:33,130
in allows people to connect to employees
with open be a mess operating system

28
00:01:33,130 --> 00:01:36,839
which is they older operating system
I'll

29
00:01:36,840 --> 00:01:41,530
that not as many organizations use
nowadays everybody's gonna moved over to

30
00:01:41,530 --> 00:01:44,750
unix-based I and was used for DEFCON

31
00:01:44,750 --> 00:01:48,689
C chip brick walls this year and all
kinds of stuff and I'm kinda into

32
00:01:48,689 --> 00:01:51,710
defensive computing whenever I say that
what I'm talking about

33
00:01:51,710 --> 00:01:55,970
is writing software that helps you
detect a attacks happening in a network

34
00:01:55,970 --> 00:01:57,119
arm

35
00:01:57,119 --> 00:02:01,619
the is good to hear arm to witness a
contains a open source projects

36
00:02:01,619 --> 00:02:03,390
multi-threaded runs on

37
00:02:03,390 --> 00:02:06,430
a Unix type: environment be at Lenox

38
00:02:06,430 --> 00:02:11,510
OpenBSD what now we don't currently
support Windows sweet we don't

39
00:02:11,510 --> 00:02:16,390
do use windows in our environment so the
plans importing it over but should be

40
00:02:16,390 --> 00:02:20,110
fully fully possible and open source GPL
version 2

41
00:02:20,110 --> 00:02:23,190
arm and it's a multi-threaded

42
00:02:23,190 --> 00:02:28,300
engine to analyze logs and we do
multi-threaded to keep it so that it

43
00:02:28,300 --> 00:02:32,390
whenever has two do you think that right
to a database rain fade that

44
00:02:32,390 --> 00:02:37,140
stake in the primary engine can monitor
logs as thousands lockerbie incoming you

45
00:02:37,140 --> 00:02:37,920
coming in

46
00:02:37,920 --> 00:02:41,590
and in turn around a bill to insert into
a database or what not without having to

47
00:02:41,590 --> 00:02:42,720
interrupt the process

48
00:02:42,720 --> 00:02:46,310
analyzing those locks and there's
another you

49
00:02:46,310 --> 00:02:49,750
systems out there is other software that
you very similar things

50
00:02:49,750 --> 00:02:53,879
but we kind of do it with a little bit
worse what we're trying to do is write

51
00:02:53,879 --> 00:02:56,709
the best log houses engine that we can
come up with

52
00:02:56,709 --> 00:03:00,430
so we're trying not to reinvent the
wheel

53
00:03:00,430 --> 00:03:03,930
and it won't be the best blog houses
engine that we can do

54
00:03:03,930 --> 00:03:07,769
in with that we try to prevent
reinventing the wheel

55
00:03:07,769 --> 00:03:12,400
as we leverage are a lot of stuff that's
already been done and so are sparse nor

56
00:03:12,400 --> 00:03:16,590
now Sagan other than think that'll go
into

57
00:03:16,590 --> 00:03:21,340
we'll share source code with your and
how many people are familiar with snore

58
00:03:21,340 --> 00:03:24,780
yeah I kinda figured that would be the
case I am

59
00:03:24,780 --> 00:03:28,959
so its it's for the people who aren't
familiar with the

60
00:03:28,959 --> 00:03:32,459
a snore is a packet analysis

61
00:03:32,459 --> 00:03:37,129
engine basically I D S engine intrusion
detection and so it has rules and if

62
00:03:37,129 --> 00:03:39,230
rules get triggered in the network

63
00:03:39,230 --> 00:03:42,920
I i can. fired awful were and whatnot he
uses preprocessor

64
00:03:42,920 --> 00:03:47,390
so they can take some other ideas from
snort bender some very similar

65
00:03:47,390 --> 00:03:50,390
things a a transfer

66
00:03:50,390 --> 00:03:55,819
up idea what wise using but they're not
the same code base tonight anything

67
00:03:55,819 --> 00:03:59,030
related other than a few little things
so

68
00:03:59,030 --> 00:04:02,720
well the reason that we use the same
structures that we can log to

69
00:04:02,720 --> 00:04:06,239
a SQL database in SQL databases that's
more uses

70
00:04:06,239 --> 00:04:09,680
but I'll get a little bit later we can
write to unify to

71
00:04:09,680 --> 00:04:14,420
output which is good for things like
ewing if you're smart guy these turned

72
00:04:14,420 --> 00:04:16,310
on make complete sense to you

73
00:04:16,310 --> 00:04:20,668
and another thing to build a rule sets
for a log analysis isn't very similar to

74
00:04:20,668 --> 00:04:21,358
sports

75
00:04:21,358 --> 00:04:24,570
and in that way we can utilize a

76
00:04:24,570 --> 00:04:28,699
tools out there for rule management into
my point is we're trying to do things

77
00:04:28,699 --> 00:04:31,990
their way so that we can concentrate on
writing a good log analysis

78
00:04:31,990 --> 00:04:35,830
engine and not worry about where the
data goes or

79
00:04:35,830 --> 00:04:40,150
if our how to manage rules with the word
so we're going to use a lot about the

80
00:04:40,150 --> 00:04:41,360
same technology

81
00:04:41,360 --> 00:04:44,389
and we do this primarily for correlation

82
00:04:44,389 --> 00:04:48,520
so they said so us they can come right
to you the same database is a store

83
00:04:48,520 --> 00:04:51,889
anyway I D St data goes to your
intrusion detection data

84
00:04:51,889 --> 00:04:55,090
sayin can write to that same tech
database and that makes it kinda

85
00:04:55,090 --> 00:04:56,250
interesting because

86
00:04:56,250 --> 00:04:59,750
then if you have reports for anything
that you run are

87
00:04:59,750 --> 00:05:02,860
you have not only in your packet level
information but you have your log

88
00:05:02,860 --> 00:05:04,590
information in there as well

89
00:05:04,590 --> 00:05:07,830
and we can cross reference if we can
show me show me just that

90
00:05:07,830 --> 00:05:11,400
types logs that look like a tax or show
me just the

91
00:05:11,400 --> 00:05:14,660
packets that but like just got attacked
by showing them together and get some

92
00:05:14,660 --> 00:05:15,919
kind of correlation

93
00:05:15,919 --> 00:05:19,849
and I'm we cross reference stuff like if
you block normalization but

94
00:05:19,850 --> 00:05:23,550
we we cross reference things like a
source IP address the destination IP

95
00:05:23,550 --> 00:05:24,690
address

96
00:05:24,690 --> 00:05:28,630
the protocol being used things of that
nature or you can buy the classification

97
00:05:28,630 --> 00:05:33,699
so for instance if us nor classifies a
packet as an attempted user and we have

98
00:05:33,699 --> 00:05:35,169
a log that can be generated

99
00:05:35,169 --> 00:05:39,650
will also classify it as area attempted
to user

100
00:05:39,650 --> 00:05:42,940
so basically the idea behind it is you
have

101
00:05:42,940 --> 00:05:47,460
arm all the blog at: Sagan works best in
a centralized logging apartment so

102
00:05:47,460 --> 00:05:51,520
if you think about all your network here
and all your machines and whatnot

103
00:05:51,520 --> 00:05:55,698
they're sending it also centralize point
well all the logger aggregated

104
00:05:55,699 --> 00:05:59,080
and that can be for archiving or what
not and what we used to collect those

105
00:05:59,080 --> 00:06:01,020
logs can be syslog-ng

106
00:06:01,020 --> 00:06:04,229
Arsis log and basically a feed Sagan

107
00:06:04,229 --> 00:06:07,280
the the logs that are coming in arm

108
00:06:07,280 --> 00:06:11,220
thinking of Cassidy this committee thing
so so you already have a nearby remit

109
00:06:11,220 --> 00:06:16,569
AR centralized logging set up well
cigarette going kinda sniffer mad

110
00:06:16,569 --> 00:06:19,740
and basically sniff the wire likely
service pay import

111
00:06:19,740 --> 00:06:23,780
arm and Steph the working poor the logs
of the wire as they're going to your

112
00:06:23,780 --> 00:06:25,139
situate back n

113
00:06:25,139 --> 00:06:28,600
and the reason that kinda interesting it
because people might buy a

114
00:06:28,600 --> 00:06:32,280
ArcSight or something that's very very
expensive and redesigning the entire

115
00:06:32,280 --> 00:06:33,479
network isn't

116
00:06:33,479 --> 00:06:37,219
something that they want to do so what
this allows you to do is sniff the log

117
00:06:37,220 --> 00:06:40,900
not change anything in a network this
guy when nifty feature

118
00:06:40,900 --> 00:06:47,400
are an so we can do correlation between
log stuff in the IDS to

119
00:06:47,400 --> 00:06:51,139
across several Starpoints obviously
times dance being

120
00:06:51,139 --> 00:06:54,250
one of them course I'm sure everybody
run something like

121
00:06:54,250 --> 00:06:57,449
you know Network Time Protocol NTP are

122
00:06:57,449 --> 00:07:00,539
you can do as a by source and
destination of Dubai protocol I'm gonna

123
00:07:00,539 --> 00:07:01,259
get into this

124
00:07:01,259 --> 00:07:04,949
the pretty quickly sometimes the poor
the target port the source port

125
00:07:04,949 --> 00:07:09,110
and the I the classifications so

126
00:07:09,110 --> 00:07:13,810
how are these events a actually
normalize stores give me correlated

127
00:07:13,810 --> 00:07:17,849
and that's actually to log normalization
we use several different techniques to

128
00:07:17,849 --> 00:07:20,819
extract useful information out a blog
because

129
00:07:20,819 --> 00:07:24,840
typically in syslog and talk about
traditional syslog like the

130
00:07:24,840 --> 00:07:28,199
I'm how it works the source and
destinations just like her a lot times

131
00:07:28,199 --> 00:07:29,389
gonna be useless

132
00:07:29,389 --> 00:07:32,400
arm now all the time but a lotta cases

133
00:07:32,400 --> 00:07:36,250
so if we take a Gerber are fake company
here

134
00:07:36,250 --> 00:07:39,340
they have a centralized logging
environment and all the logs in the

135
00:07:39,340 --> 00:07:42,880
company other Windows servers are
routers everything is going to turn out

136
00:07:42,880 --> 00:07:44,300
to not sure to 5

137
00:07:44,300 --> 00:07:49,229
and the I target IP address its who the
attackers

138
00:07:49,229 --> 00:07:55,159
attacking is tender tender $0.10 and the
attackers real IP addresses 192 168 1

139
00:07:55,160 --> 00:07:56,199
that fifty

140
00:07:56,199 --> 00:07:59,419
arm and so what becomes the syslog

141
00:07:59,419 --> 00:08:03,109
source and destination well in a regular
syslog message

142
00:08:03,110 --> 00:08:06,810
it's gonna be the sources the machine
that generated the log event tender

143
00:08:06,810 --> 00:08:09,349
tender 05 I know this is kinda confusing

144
00:08:09,349 --> 00:08:13,310
are and the destination will be to the
centralized logging server

145
00:08:13,310 --> 00:08:17,000
tender tender $0.10 well thats very
interesting

146
00:08:17,000 --> 00:08:20,460
but it doesn't tell you where the
attackers IP address

147
00:08:20,460 --> 00:08:23,460
and basically I consider that kinda
blame

148
00:08:23,460 --> 00:08:28,139
so overall loss though because there's
information nice actually inside the

149
00:08:28,139 --> 00:08:30,220
message is gonna crucial net with a blog

150
00:08:30,220 --> 00:08:34,209
normalization comes in so if we look
assay

151
00:08:34,209 --> 00:08:37,240
just for instance if this is our attack
messages

152
00:08:37,240 --> 00:08:41,039
what will call okay there's what a good
information in here and marry most you

153
00:08:41,039 --> 00:08:43,549
can probably figure out which
information that is

154
00:08:43,549 --> 00:08:48,760
now the traditional syslog source and
destination are fairly much useless but

155
00:08:48,760 --> 00:08:49,899
as we can see in here

156
00:08:49,899 --> 00:08:54,500
we have some other data that shows us
that 192 168 1 that fifty

157
00:08:54,500 --> 00:08:58,110
is attacking this a this machine and
figure out how to extract this

158
00:08:58,110 --> 00:08:59,149
information

159
00:08:59,149 --> 00:09:02,370
and basically use in such a way that is
actually usable so

160
00:09:02,370 --> 00:09:05,860
whenever you want to go through and find
events in your are

161
00:09:05,860 --> 00:09:10,490
your database you'll find the real
source of the attack not this the syslog

162
00:09:10,490 --> 00:09:11,160
source

163
00:09:11,160 --> 00:09:14,339
and you can extract out a lot of people
information up

164
00:09:14,339 --> 00:09:19,130
up just basically the slide for instance
we are in a record time steps we are you

165
00:09:19,130 --> 00:09:21,080
know we have a correlation point right
there

166
00:09:21,080 --> 00:09:24,899
are it knows that this attack is TCP it
also knows

167
00:09:24,899 --> 00:09:28,880
report is likely 422 because that's what
open SSH uses

168
00:09:28,880 --> 00:09:32,589
are the source for the 6500 about
blogging and the bee

169
00:09:32,589 --> 00:09:36,580
the true spew source at the attack 9165

170
00:09:36,580 --> 00:09:41,580
161 up fifty destination and then we
just have to do the classifications

171
00:09:41,580 --> 00:09:44,930
so beryllium I ask why or how do you
know that you know

172
00:09:44,930 --> 00:09:48,500
are just from that little bit
information well as he said

173
00:09:48,500 --> 00:09:51,440
will notice a narcissist log message
right here the program that actually

174
00:09:51,440 --> 00:09:54,089
generating the event is as shud

175
00:09:54,089 --> 00:09:58,190
again we know the TCP protocol it's
typically poor 22

176
00:09:58,190 --> 00:10:02,649
that are that would be being equal
attacked in this case

177
00:10:02,649 --> 00:10:06,899
arm and the rule second the rules that
actually to find that it will be

178
00:10:06,899 --> 00:10:11,829
port 22 so if you actually run SSH on
port 2222 you can just change the rules

179
00:10:11,829 --> 00:10:12,769
that

180
00:10:12,769 --> 00:10:16,430
are and the Restless up we can pull out
and said like the

181
00:10:16,430 --> 00:10:19,760
are the source the source actually
becomes a destination was kinda strange

182
00:10:19,760 --> 00:10:20,550
but

183
00:10:20,550 --> 00:10:24,029
and then we store all this information
and who you are

184
00:10:24,029 --> 00:10:28,899
are store database the same place that
we're storing Rits events

185
00:10:28,899 --> 00:10:32,839
are and why would we want to do that
well

186
00:10:32,839 --> 00:10:36,420
for one thing give Maya i'm talking
about. not reinventing the wheel

187
00:10:36,420 --> 00:10:40,439
so we can take advantage for instance
consoles that are already use

188
00:10:40,440 --> 00:10:43,670
and the IDS and IPS for personal or be
its

189
00:10:43,670 --> 00:10:47,899
proprietary consoles or open source
Council so basically

190
00:10:47,899 --> 00:10:51,730
if the console works with nor in the
rights to store data

191
00:10:51,730 --> 00:10:54,899
Sagan can utilize that you don't have to
do any retooling

192
00:10:54,899 --> 00:10:58,220
arm so just like france for instance arm

193
00:10:58,220 --> 00:11:01,810
this is a reminder some webber's project
is called snore be

194
00:11:01,810 --> 00:11:05,040
which is a great are are the front and

195
00:11:05,040 --> 00:11:08,839
for looking at ideas into my personal
page by one the best

196
00:11:08,839 --> 00:11:12,829
arm so if we looking here it looks like
right off the bat that

197
00:11:12,829 --> 00:11:15,959
this information is just saw your if
you're familiar story

198
00:11:15,959 --> 00:11:19,130
that this information is I D S repeated
related

199
00:11:19,130 --> 00:11:22,470
but you'll notice in the green actually
the greens that was actually log base

200
00:11:22,470 --> 00:11:23,269
events

201
00:11:23,269 --> 00:11:26,860
and in all the other stuff all the other
colors are basically your ID s offense

202
00:11:26,860 --> 00:11:30,510
so we can take advantage we don't have
to worry about now writing consoles for

203
00:11:30,510 --> 00:11:31,160
this

204
00:11:31,160 --> 00:11:33,850
and then you can break it down like we
was not to make more sense out-of-date

205
00:11:33,850 --> 00:11:34,779
about

206
00:11:34,779 --> 00:11:38,029
what the threat priorities were or what
not

207
00:11:38,029 --> 00:11:42,640
or even break it down to what kinda
signatures were being

208
00:11:42,640 --> 00:11:46,310
triggered like a princess a lot of these
are actually are are seeking such

209
00:11:46,310 --> 00:11:49,680
signature so you taking the data and
you're putting him into the same place

210
00:11:49,680 --> 00:11:51,519
so that you can correlate them

211
00:11:51,519 --> 00:11:55,399
look at them different different ways
arm

212
00:11:55,399 --> 00:11:59,050
I'm from the the standpoint like in this
particular slide

213
00:11:59,050 --> 00:12:03,779
were actually you looking at log data to
a person who's familiar with more or

214
00:12:03,779 --> 00:12:05,130
store be or what not

215
00:12:05,130 --> 00:12:09,139
at first glance you would say this looks
like IDS data but this is actually both

216
00:12:09,139 --> 00:12:09,970
but this is

217
00:12:09,970 --> 00:12:13,950
in this particular case I'm only looking
at log data is not IPS

218
00:12:13,950 --> 00:12:17,829
and that's kinda the the point arm

219
00:12:17,829 --> 00:12:21,860
so basically what happens is sega and
whenever he sees an event he create a

220
00:12:21,860 --> 00:12:23,110
pseudo packet

221
00:12:23,110 --> 00:12:26,880
and inserted into the database the
snorted a Miss Universe

222
00:12:26,880 --> 00:12:30,560
nor an IDS stuff like that we're gonna
packet level we're dealing with a log

223
00:12:30,560 --> 00:12:31,170
level

224
00:12:31,170 --> 00:12:34,680
so we actually do some trickery to
create a

225
00:12:34,680 --> 00:12:38,170
packet that goes into the database in
your notice

226
00:12:38,170 --> 00:12:43,029
in the payload area is actually the log
message that trip the event

227
00:12:43,029 --> 00:12:47,139
and then we also add in our source
address our destination time sims are

228
00:12:47,139 --> 00:12:47,980
you given

229
00:12:47,980 --> 00:12:51,899
and classification and obviously we're
budging some other stuff because we're

230
00:12:51,899 --> 00:12:53,839
dealing with a log event and not

231
00:12:53,839 --> 00:12:57,519
a network event so we don't have for
instance you know

232
00:12:57,519 --> 00:13:01,630
time to live in this paper packet so
obvious we set something up to 20

233
00:13:01,630 --> 00:13:05,209
arm and you know so a

234
00:13:05,209 --> 00:13:08,540
it doesn't really matter so for instance
if you want to use a

235
00:13:08,540 --> 00:13:12,079
squeal arm you could do the same thing
so basically my

236
00:13:12,079 --> 00:13:15,680
my point is all your stuff goes into one
place and that you can

237
00:13:15,680 --> 00:13:20,079
you can correlated in use it and from
our standpoint

238
00:13:20,079 --> 00:13:23,639
the security council doesn't matter to
us so again we can always concentrate

239
00:13:23,639 --> 00:13:24,529
just on

240
00:13:24,529 --> 00:13:27,959
being a better are log analysis engine

241
00:13:27,959 --> 00:13:31,430
and again we don't worry about for
instance this is a order project

242
00:13:31,430 --> 00:13:33,709
preserve your familiar snore

243
00:13:33,709 --> 00:13:38,450
I remember base so base is one of those
out there but Kevin Johnson's no longer

244
00:13:38,450 --> 00:13:41,779
really maintained anymore because people
still use it a lot

245
00:13:41,779 --> 00:13:45,920
arm and what we have is this is actually
a wireless idea system that I was using

246
00:13:45,920 --> 00:13:47,529
but still insist log data

247
00:13:47,529 --> 00:13:50,779
my point as whenever you look at this
it's not

248
00:13:50,779 --> 00:13:55,820
it's not the log a ticket Street account
like I D St Tickets is inserted into

249
00:13:55,820 --> 00:14:00,470
the database again here's our paler arco
paler which is actually the log event

250
00:14:00,470 --> 00:14:04,750
that triggered the event or you have
things like prelude baby preludes more

251
00:14:04,750 --> 00:14:05,660
USB which says

252
00:14:05,660 --> 00:14:09,310
some really nice grouping and things of
that nature arm

253
00:14:09,310 --> 00:14:12,540
and again once again you know the
payload becomes the

254
00:14:12,540 --> 00:14:17,589
is the log message: that generated the
event so what we're trying to do here

255
00:14:17,589 --> 00:14:20,630
is it doesn't matter which console that
you want to use

256
00:14:20,630 --> 00:14:24,329
you just pick your favorite one and move
on even if his even if it's appropriate

257
00:14:24,329 --> 00:14:26,040
proprietary console

258
00:14:26,040 --> 00:14:29,930
it's something that you ruined house
only for you use the query

259
00:14:29,930 --> 00:14:33,630
your ideas back and generate pretty
reports that the managers can use it

260
00:14:33,630 --> 00:14:36,949
it doesn't matter you can use the exact
same software to generate now

261
00:14:36,949 --> 00:14:41,070
reports that go of log data to generate
pretty pictures so you can have them to

262
00:14:41,070 --> 00:14:41,959
a manager

263
00:14:41,959 --> 00:14:45,459
and he's really happy about so

264
00:14:45,459 --> 00:14:49,449
but the other thing that I am we do we
also keep

265
00:14:49,449 --> 00:14:52,589
are rules it's very very similar to

266
00:14:52,589 --> 00:14:55,600
house nor does it he's a very similar
structure

267
00:14:55,600 --> 00:14:58,639
a reason that we do that again at the
arm the management

268
00:14:58,639 --> 00:15:03,339
the rules a force nor people a you might
remember there's

269
00:15:03,339 --> 00:15:07,540
programs like pulled pork annoyed master
for downloading rules every night and

270
00:15:07,540 --> 00:15:09,630
disabling certain rule sets in

271
00:15:09,630 --> 00:15:13,490
doing all this you know kinda cool stuff
to customize the rules for Environment

272
00:15:13,490 --> 00:15:16,660
you don't have to retool he is the exact
same software

273
00:15:16,660 --> 00:15:20,760
to manage to say controls again trying
not to reinvent too much of the wheel

274
00:15:20,760 --> 00:15:24,870
I so if we look at something like this

275
00:15:24,870 --> 00:15:28,560
are are to do it hack arm will

276
00:15:28,560 --> 00:15:31,570
we can write a alway really basic rule
for

277
00:15:31,570 --> 00:15:34,800
now actually I was showing up reminders
talk

278
00:15:34,800 --> 00:15:37,820
and he got really confused because he
looked at this particular

279
00:15:37,820 --> 00:15:41,399
this is a rule this is a say in what he
look at this and thought it was a snort

280
00:15:41,399 --> 00:15:42,070
rule

281
00:15:42,070 --> 00:15:46,070
yup that's actually the idea is that it
they should but very similar

282
00:15:46,070 --> 00:15:48,920
but it was confusing as hell to him cuz
he didn't realize we were talking about

283
00:15:48,920 --> 00:15:49,930
locks

284
00:15:49,930 --> 00:15:54,190
so I am this is like them about most
basic you can get with

285
00:15:54,190 --> 00:15:59,300
Sagan rule arm one thing that I'd like
to point out

286
00:15:59,300 --> 00:16:02,690
so in the Snort world the very top part

287
00:16:02,690 --> 00:16:05,740
and a packet level your set your telling
store

288
00:16:05,740 --> 00:16:09,220
when a I wanna watch 40 CP traffic

289
00:16:09,220 --> 00:16:14,389
going to port 22 in my home at obviously
we're dealing with logs so this is a

290
00:16:14,389 --> 00:16:15,339
little bit different

291
00:16:15,339 --> 00:16:18,949
what we're saying is when this this part
of the ruled

292
00:16:18,949 --> 00:16:22,440
gets triggered and Sagan we are telling
Sagan

293
00:16:22,440 --> 00:16:28,149
that this is considered a a log message
that was generated by a program that is

294
00:16:28,149 --> 00:16:31,630
PCP protocol and the poor is usually

295
00:16:31,630 --> 00:16:35,079
port 22 job BC could change bomb

296
00:16:35,079 --> 00:16:39,779
the idea is that you kept telling 23
actually kind of looking around

297
00:16:39,779 --> 00:16:43,019
and the sexy confuses the hell out of
people so if you have questions about

298
00:16:43,019 --> 00:16:44,060
where maybe

299
00:16:44,060 --> 00:16:47,699
asked me on the side are but we can't
flip around the meeting up how this

300
00:16:47,699 --> 00:16:48,639
works

301
00:16:48,639 --> 00:16:53,579
arm so yes I was basically saying no
that is poor 22

302
00:16:53,579 --> 00:16:57,120
I from looking at this so

303
00:16:57,120 --> 00:17:01,160
we look are first part is the message is
to be human readable format this is the

304
00:17:01,160 --> 00:17:03,089
alert that pops up that my get

305
00:17:03,089 --> 00:17:06,569
emailed to you are put into a database
is the part that you know

306
00:17:06,569 --> 00:17:10,178
tells the and operator or what not
looking at a console

307
00:17:10,179 --> 00:17:14,980
that this was a invalid user tapped arm

308
00:17:14,980 --> 00:17:18,110
and the next part is actually what we're
looking for were looking for

309
00:17:18,110 --> 00:17:21,630
the term invalid user pretty simple
basically

310
00:17:21,630 --> 00:17:25,569
just as a possible string match we can
use PCR your excuse me are

311
00:17:25,569 --> 00:17:28,820
regular expressions arm we're talking to
a bit later

312
00:17:28,820 --> 00:17:33,010
but a little extra overhead whenever
using regular expressions like a

313
00:17:33,010 --> 00:17:37,390
PCR you kinda libraries and we're trying
to make this really pass cuz we in some

314
00:17:37,390 --> 00:17:38,760
cases where we use it

315
00:17:38,760 --> 00:17:41,919
we're doing with ten to fifteen thousand
log on to second

316
00:17:41,919 --> 00:17:46,299
and we don't have to you know we gotta
make it very fitted is my entire point

317
00:17:46,299 --> 00:17:49,049
and then this is the program that
actually generated message remember

318
00:17:49,049 --> 00:17:50,440
early so we know

319
00:17:50,440 --> 00:17:54,900
we're only gonna search the logs that
are generated by the program sshd

320
00:17:54,900 --> 00:17:57,940
in some cases you my only wanna search

321
00:17:57,940 --> 00:18:01,539
certain types of locks for certain types
of events so

322
00:18:01,539 --> 00:18:05,500
its that it takes more CPU time to sit
around and in life every log

323
00:18:05,500 --> 00:18:09,650
for some type of event if in it for
stuff that you're not interested in so

324
00:18:09,650 --> 00:18:11,320
you can actually breaking down teller

325
00:18:11,320 --> 00:18:15,250
I only want to search for are this type
of program generating this type of the

326
00:18:15,250 --> 00:18:16,289
event

327
00:18:16,289 --> 00:18:19,200
arm and other stuff too and also makes a
little bit more efficient if you can

328
00:18:19,200 --> 00:18:20,470
break it down that way

329
00:18:20,470 --> 00:18:24,429
and then we give it a priority level are
which is priority number one the highest

330
00:18:24,429 --> 00:18:26,450
level priority

331
00:18:26,450 --> 00:18:31,950
and then we have a you unique signature
ID all seeking rule star at five million

332
00:18:31,950 --> 00:18:37,200
I to keep away from Snort rules and so I
guess we start at $5 million

333
00:18:37,200 --> 00:18:41,090
our store of course you know started
rule bro low I think

334
00:18:41,090 --> 00:18:45,330
emerging threat rules started like two
million are so are also start five

335
00:18:45,330 --> 00:18:47,799
million think you can have still
everything kinda separated

336
00:18:47,799 --> 00:18:51,139
and and obviously we have a rule
revisions every time you make a

337
00:18:51,140 --> 00:18:52,340
modification you

338
00:18:52,340 --> 00:18:56,889
implement your revision so hello is the
backend database and everything know

339
00:18:56,890 --> 00:18:59,440
that the rule revisions changed nah
maybe

340
00:18:59,440 --> 00:19:02,020
you know you look at things differently
you can keep track of what the hell's

341
00:19:02,020 --> 00:19:03,000
going on

342
00:19:03,000 --> 00:19:06,890
so for basic rule for what we did that's
pretty much it

343
00:19:06,890 --> 00:19:11,000
but in reality arm

344
00:19:11,000 --> 00:19:15,850
life is more complicated nap and
obviously with pork $22 you see things

345
00:19:15,850 --> 00:19:18,000
like brute force attacks and stuff like
that

346
00:19:18,000 --> 00:19:22,270
so what we're gonna do just briefly this
can have get this

347
00:19:22,270 --> 00:19:26,320
I just threw in a few extra I directives
into the rule

348
00:19:26,320 --> 00:19:30,370
so I remember we have the content user
you'll notice the no case now

349
00:19:30,370 --> 00:19:33,370
basically if I'm searching for content
it's gonna be

350
00:19:33,370 --> 00:19:37,880
search for case-insensitive we change
our priority we've removed

351
00:19:37,880 --> 00:19:41,030
and we made our classification types I
remember as i said

352
00:19:41,030 --> 00:19:45,990
store my extort might it if it has a
kind of a similar kind of arm

353
00:19:45,990 --> 00:19:50,280
are idea signature and we can try to
match it up with a log signature

354
00:19:50,280 --> 00:19:54,490
it might classify as it shifted user we
had to do the same thing

355
00:19:54,490 --> 00:19:58,500
attempted user happens to adopt the
priority about that particular

356
00:19:58,500 --> 00:19:59,870
classification

357
00:19:59,870 --> 00:20:04,210
arm and they said we can't do regular
expressions

358
00:20:04,210 --> 00:20:08,260
ever in and and then those are great arm
but a lot of times

359
00:20:08,260 --> 00:20:12,158
are it makes things your rules with
really really ugly and so what you can

360
00:20:12,159 --> 00:20:12,789
do

361
00:20:12,789 --> 00:20:18,360
is mix and match your content PCRE kind
of stuff your regular expressions

362
00:20:18,360 --> 00:20:22,020
arm sometimes you need to have read your
expression because it is easier

363
00:20:22,020 --> 00:20:25,658
to get the rule to do what you want to
to our thing is accused cop

364
00:20:25,659 --> 00:20:29,690
use content when you can use regular
expressions whenever you have to

365
00:20:29,690 --> 00:20:33,760
arm he said in its for more speed factor
because whenever you get

366
00:20:33,760 --> 00:20:37,480
into dealing with thousands on the blog
lines you want to

367
00:20:37,480 --> 00:20:40,890
basis miss bassett your suspicion as
possible are

368
00:20:40,890 --> 00:20:44,179
so this are always doing regular
expressions that the problem isn't

369
00:20:44,179 --> 00:20:44,919
always the

370
00:20:44,919 --> 00:20:49,580
the best thing so what I'm gonna do here
just to keep things going to simple

371
00:20:49,580 --> 00:20:54,370
as world issues the I are pro compatible
regular expressions to the PCR he stands

372
00:20:54,370 --> 00:20:54,870
for

373
00:20:54,870 --> 00:20:59,419
and what does look for invalid user or
any legal user just to keep a kind of

374
00:20:59,419 --> 00:20:59,919
simple

375
00:20:59,919 --> 00:21:05,200
now as I said are this is the kind of
thing that we also share with the

376
00:21:05,200 --> 00:21:08,520
sore people brute force as a seed all
the friggin time

377
00:21:08,520 --> 00:21:12,179
so in previous rules if you had put that
near

378
00:21:12,179 --> 00:21:15,179
in an environment so you had a a pen
tester come by

379
00:21:15,179 --> 00:21:18,470
or I an external facing piece of
hardware

380
00:21:18,470 --> 00:21:21,669
you're gonna get as a teacher terms all
the time and then you're going to your

381
00:21:21,669 --> 00:21:23,049
console and you'll have

382
00:21:23,049 --> 00:21:26,230
20,000 events or somebody trying to ssh
in

383
00:21:26,230 --> 00:21:30,570
well the problem with that is that now
um you have these twenty thousand events

384
00:21:30,570 --> 00:21:32,860
in your having a sift through those
defined

385
00:21:32,860 --> 00:21:37,390
to that you actually care about so what
we can do is think thresholding so we

386
00:21:37,390 --> 00:21:38,280
can actually say

387
00:21:38,280 --> 00:21:42,720
if you see this event and it happens
more than five times within a

388
00:21:42,720 --> 00:21:44,230
five-minute period

389
00:21:44,230 --> 00:21:48,090
threshold you tell me five times is
probably about max I need to know that

390
00:21:48,090 --> 00:21:50,330
something's going on probably react to
it

391
00:21:50,330 --> 00:21:53,830
so there's no reason for me to fill up
my console with Botsa

392
00:21:53,830 --> 00:21:57,480
lots of data arm and then after five
minutes that that

393
00:21:57,480 --> 00:22:00,809
think it's cleared out and then you know
princess I could say they stop attacking

394
00:22:00,809 --> 00:22:02,520
you then you come back

395
00:22:02,520 --> 00:22:05,668
they come back a little bit later the
next day then it'll start back up again

396
00:22:05,669 --> 00:22:09,289
and that's pretty good that helps limit
some things but then we also added and

397
00:22:09,289 --> 00:22:11,230
this is one thing that princess nor does
it have

398
00:22:11,230 --> 00:22:15,870
is a after directive which basically
says after you think it might happen

399
00:22:15,870 --> 00:22:19,120
bay with after you've had this if that
happens to me time so

400
00:22:19,120 --> 00:22:22,409
then send off an alert so for instance
if

401
00:22:22,409 --> 00:22:26,760
I A it with the previous example is is
still going to capture every

402
00:22:26,760 --> 00:22:30,549
you every time somebody logs in five
times it's going to generate this by

403
00:22:30,549 --> 00:22:31,289
events

404
00:22:31,289 --> 00:22:35,140
but the fact is I missed I password I'm
sure everybody does at some point

405
00:22:35,140 --> 00:22:38,720
so what you want to say here is
basically don't tell me

406
00:22:38,720 --> 00:22:42,429
until it happened three times and then
after that threshold it once you get

407
00:22:42,429 --> 00:22:43,850
past the five-point

408
00:22:43,850 --> 00:22:48,870
so if bob the developer try to log into
machine any fat fingers as password

409
00:22:48,870 --> 00:22:51,919
then you don't get alerted but bob is it
three times

410
00:22:51,919 --> 00:22:55,220
there might be something else going on
about the data I was in time well shit

411
00:22:55,220 --> 00:22:57,049
there's obviously something

412
00:22:57,049 --> 00:23:00,780
arm but as you might notice in all this

413
00:23:00,780 --> 00:23:04,850
there's auto detection talk with there's
not really any log normalization

414
00:23:04,850 --> 00:23:09,669
so far we've only talked about how to
detect somebody's typeof s

415
00:23:09,669 --> 00:23:14,409
basically what we use is our a the
normalized directive so

416
00:23:14,409 --> 00:23:17,929
basically whenever you add this to a
rule you create

417
00:23:17,929 --> 00:23:21,409
a I'll into the your rules file

418
00:23:21,409 --> 00:23:25,030
you create another possible a rule-based
file and basically says

419
00:23:25,030 --> 00:23:28,730
arm that paper event that I'm trippin
attempt to normalize them a chip that

420
00:23:28,730 --> 00:23:31,429
trip extract useful information our

421
00:23:31,429 --> 00:23:34,929
are the log message with are is gonna be
SSH

422
00:23:34,929 --> 00:23:39,690
open SSH arm and then win so that way
said had to go through its entire wall

423
00:23:39,690 --> 00:23:40,169
base

424
00:23:40,169 --> 00:23:44,200
saying was a Cisco login visible or you
can actually say

425
00:23:44,200 --> 00:23:47,620
now this is going to be for can ssh just
look for that so

426
00:23:47,620 --> 00:23:50,460
and there's other ways that we can to
you our normalization but this is

427
00:23:50,460 --> 00:23:52,549
probably like one of the better ones we
have some

428
00:23:52,549 --> 00:23:56,450
directors where you could do you are are
dynamically fine

429
00:23:56,450 --> 00:24:00,330
IP's in a particular logging but those
have a lot more overhead then

430
00:24:00,330 --> 00:24:04,750
and using this weblog norm and live like
norm was started by

431
00:24:04,750 --> 00:24:08,419
regarding reiter he's he's author Mar
syslog and

432
00:24:08,419 --> 00:24:11,740
which is great because I was looking at
writing %uh various

433
00:24:11,740 --> 00:24:15,029
somewhere utility and was thinking this
is gonna suck

434
00:24:15,029 --> 00:24:19,110
in he already started out so that was
great are and it can work up a masking

435
00:24:19,110 --> 00:24:20,270
system

436
00:24:20,270 --> 00:24:23,840
so if you if you look at it you take

437
00:24:23,840 --> 00:24:28,689
in a bit like this so you know where the
information is no so these are these are

438
00:24:28,690 --> 00:24:31,340
really good for a very dynamic type a
blog event

439
00:24:31,340 --> 00:24:34,799
you know like visually you can look at
it and get a good idea of where the

440
00:24:34,799 --> 00:24:35,740
events are

441
00:24:35,740 --> 00:24:39,419
but the way that the live blog norm rule
base loads that works for participating

442
00:24:39,419 --> 00:24:40,110
in

443
00:24:40,110 --> 00:24:43,200
it'll look more like this so it's
basically saying

444
00:24:43,200 --> 00:24:48,400
is the invalid user in your nose to
percent sign user Colin were

445
00:24:48,400 --> 00:24:52,370
me percent sign and basically be
username

446
00:24:52,370 --> 00:24:56,320
is the variable and I'm telling the blog
norm it's going to be a word

447
00:24:56,320 --> 00:24:59,510
and the same thing with the source IP
said saying

448
00:24:59,510 --> 00:25:02,980
I'm story into a variable call source IP

449
00:25:02,980 --> 00:25:06,740
and it's going to be ipv4 to look for
something ipv4

450
00:25:06,740 --> 00:25:09,990
and then number they have several
different takes a very able to what we

451
00:25:09,990 --> 00:25:11,039
try to do

452
00:25:11,039 --> 00:25:15,350
anybody who's really can ever into
logging we tried to keep up with the

453
00:25:15,350 --> 00:25:20,190
are common event expression to see we
can to try to use the same thing so that

454
00:25:20,190 --> 00:25:22,480
later on hopefully we'll have to change
a buncha crap

455
00:25:22,480 --> 00:25:25,679
arm and right now we have

456
00:25:25,679 --> 00:25:29,460
a a pretty good about a rule sets and
that's actually where

457
00:25:29,460 --> 00:25:34,049
people who are interested in log
analysis are they're coming from syslog

458
00:25:34,049 --> 00:25:37,500
orbit logs are being sent from the
Windows Server to their centralized back

459
00:25:37,500 --> 00:25:38,130
in

460
00:25:38,130 --> 00:25:42,760
arm can help us with every time that we
have a new rule set for instance I had

461
00:25:42,760 --> 00:25:43,390
somebody

462
00:25:43,390 --> 00:25:48,049
donate some HP ProCurve rules we can add
that to our arsenal

463
00:25:48,049 --> 00:25:52,330
and then we put it in and then maybe you
have that similar physical mister you

464
00:25:52,330 --> 00:25:53,710
gain from his

465
00:25:53,710 --> 00:25:57,049
X-ray to break the rules at and we add
in step as we go along we have thousands

466
00:25:57,049 --> 00:25:58,740
rules that out there

467
00:25:58,740 --> 00:26:02,000
are if you'll notice we have even things
like bash

468
00:26:02,000 --> 00:26:05,279
which is the Comanchero back shell

469
00:26:05,279 --> 00:26:09,049
you can do something really cool bashing
that you can tell instead of storing

470
00:26:09,049 --> 00:26:09,990
your are

471
00:26:09,990 --> 00:26:14,570
your history File where all your command
to even type its restoring it to a file

472
00:26:14,570 --> 00:26:18,250
sin all that information or to syslog
server and what's interesting about that

473
00:26:18,250 --> 00:26:18,789
then

474
00:26:18,789 --> 00:26:22,179
if somebody goes in and says while the
Swype army history words too late it's

475
00:26:22,179 --> 00:26:23,320
already being said

476
00:26:23,320 --> 00:26:26,520
and so from our standpoint if we have
for instance

477
00:26:26,520 --> 00:26:29,940
a I a production environment

478
00:26:29,940 --> 00:26:33,340
we can say if you ever see somebody
running in map in our production

479
00:26:33,340 --> 00:26:34,529
environment

480
00:26:34,529 --> 00:26:37,929
maybe tell me about that because
nobody's supposed to be doing that in

481
00:26:37,929 --> 00:26:39,090
this production environment

482
00:26:39,090 --> 00:26:42,520
or running are at a outfile

483
00:26:42,520 --> 00:26:46,590
out the temp directory yell that could
maybe be a little bit strange you're

484
00:26:46,590 --> 00:26:48,000
strange character 60

485
00:26:48,000 --> 00:26:51,520
we can kind of keep an eye on our using
things like bash event but as you can

486
00:26:51,520 --> 00:26:52,260
see we have

487
00:26:52,260 --> 00:26:56,580
everything from of our wall vents
Windows rule sets

488
00:26:56,580 --> 00:26:59,710
switches routers are

489
00:26:59,710 --> 00:27:02,789
some some fun stuff like web elaborate

490
00:27:02,789 --> 00:27:07,210
up all kinds of stuff so if if you do
decide that you want to get into

491
00:27:07,210 --> 00:27:12,100
log analysis and and so like that you
want to use a can we we'd

492
00:27:12,100 --> 00:27:15,429
really like you to donate any kinda
rules that you come up with because they

493
00:27:15,429 --> 00:27:16,610
turned round and helps

494
00:27:16,610 --> 00:27:20,789
bill are also a and the community can
use in and what not

495
00:27:20,789 --> 00:27:24,929
and then awning I'm a go for a quick is
output plugin so whenever I see out the

496
00:27:24,929 --> 00:27:25,549
plugins

497
00:27:25,549 --> 00:27:29,168
a said a saying can write to a database

498
00:27:29,169 --> 00:27:34,020
or a continuing email or it kid do all
sorts of things

499
00:27:34,020 --> 00:27:38,110
I and we have a few these out the
plugins that are that people like to use

500
00:27:38,110 --> 00:27:42,470
arm probably one other 12 you always get
out or you can you get it to email me

501
00:27:42,470 --> 00:27:44,100
when something bad happens

502
00:27:44,100 --> 00:27:47,240
which is OK are so you can use

503
00:27:47,240 --> 00:27:51,779
and the I just like its periods again
very similar to how store lays out its

504
00:27:51,779 --> 00:27:54,710
configuration file on this is in the
same configuration file

505
00:27:54,710 --> 00:27:59,260
you can actually tell it when you see an
event and it's a this priority above

506
00:27:59,260 --> 00:28:02,850
email it to you the administrators or
you can say

507
00:28:02,850 --> 00:28:06,140
if you have a Windows event and it goes
wrong

508
00:28:06,140 --> 00:28:09,740
there something happens and we detect
something sin that Windows went to the

509
00:28:09,740 --> 00:28:12,299
Windows administrators were not the UNIX
administrator

510
00:28:12,299 --> 00:28:16,929
you can actually based out of the rule
so basically a as a boy SMTP plugin that

511
00:28:16,929 --> 00:28:18,750
you can kinda tweak to get

512
00:28:18,750 --> 00:28:22,720
you make sure like when those guys get
their stuff 1x guys get their stuff and

513
00:28:22,720 --> 00:28:23,669
whatnot

514
00:28:23,669 --> 00:28:26,850
arm we also can do you

515
00:28:26,850 --> 00:28:30,940
I'll where you can call your own program
so basically arm

516
00:28:30,940 --> 00:28:35,010
I when an event happens I and dancing
and multi-threaded

517
00:28:35,010 --> 00:28:38,340
what they can do is handed over to your

518
00:28:38,340 --> 00:28:42,110
software you can write them per or pipe
on her whatever that you want

519
00:28:42,110 --> 00:28:46,130
and the reason I bring up since is
multi-threaded if your program takes

520
00:28:46,130 --> 00:28:49,899
two or three seconds to actually do
execution from our standpoint we're

521
00:28:49,899 --> 00:28:50,860
still running

522
00:28:50,860 --> 00:28:54,460
or stall collecting log still working we
just handed that

523
00:28:54,460 --> 00:28:58,049
that dreaded process over to your
program then you turn around he might be

524
00:28:58,049 --> 00:28:59,080
able to do something like

525
00:28:59,080 --> 00:29:04,000
you know arm I pace the IP address on a
web page or

526
00:29:04,000 --> 00:29:07,990
are as guess a like adevarul to my
firewall

527
00:29:07,990 --> 00:29:12,220
to block this type of event but actually
I have a better way of doing that

528
00:29:12,220 --> 00:29:15,830
so basically you can write your own
customized software and can mean sea or

529
00:29:15,830 --> 00:29:18,840
any language that you want as long as
it'll take input from Standard &

530
00:29:18,840 --> 00:29:22,649
then then you're pretty much set arm

531
00:29:22,649 --> 00:29:25,840
that obviously we can write directly I
wanted to bring this up we can write

532
00:29:25,840 --> 00:29:26,970
directly to

533
00:29:26,970 --> 00:29:30,529
are your snort database that is are

534
00:29:30,529 --> 00:29:34,000
I mexicans celebrate actually spun off
at the Red ago

535
00:29:34,000 --> 00:29:38,419
right to the database 3 they bring it up
is if you look and the Snort world

536
00:29:38,419 --> 00:29:42,309
a store I D S world it's not really
multi-threaded so what it

537
00:29:42,309 --> 00:29:46,860
if it has to go out and do an answer I
see have packets that are coming in

538
00:29:46,860 --> 00:29:50,649
it actually actually stop what it's
doing go over do an answer to the

539
00:29:50,649 --> 00:29:52,409
database then come back into

540
00:29:52,409 --> 00:29:56,490
start watching for information you know
packets that are coming that might be

541
00:29:56,490 --> 00:29:57,039
bad

542
00:29:57,039 --> 00:30:00,230
you're losing possible been said that
standpoint

543
00:30:00,230 --> 00:30:04,620
they got around it with our kinda cool
way we empower my point we all had a

544
00:30:04,620 --> 00:30:07,799
problem with saying cuz we actually have
more to go to actually go out

545
00:30:07,799 --> 00:30:11,200
and insert these events for you and then
keep income separated so your main

546
00:30:11,200 --> 00:30:12,890
engines to analog analysis

547
00:30:12,890 --> 00:30:17,909
the other one is doing the SQL INSERT
way to get around as they use a unified

548
00:30:17,909 --> 00:30:18,460
to

549
00:30:18,460 --> 00:30:22,000
output format and store so basically
what it does

550
00:30:22,000 --> 00:30:25,159
is in the store all it right out to a
file

551
00:30:25,159 --> 00:30:28,720
the event happens write to a file then
you have another program

552
00:30:28,720 --> 00:30:32,399
like barnyard or something like that
that reads that belies its been written

553
00:30:32,399 --> 00:30:32,870
to

554
00:30:32,870 --> 00:30:35,940
and then turns around and insert into
the database are

555
00:30:35,940 --> 00:30:39,830
we can actually do the same thing we it
there's another advantage to using

556
00:30:39,830 --> 00:30:41,590
things like unify to

557
00:30:41,590 --> 00:30:46,179
and that you get cuing so for instance
you bring your database down for

558
00:30:46,179 --> 00:30:47,169
maintenance

559
00:30:47,169 --> 00:30:51,470
the event still get written to the file
and then whatever your database comes

560
00:30:51,470 --> 00:30:53,700
back up the read-back and then they can

561
00:30:53,700 --> 00:30:58,169
in certain to the basic database just
hey ive kinda a queuing mechanism out a

562
00:30:58,169 --> 00:30:58,669
bit

563
00:30:58,669 --> 00:31:02,269
so are so we can to support the same
thing as I said we're trying to do a lot

564
00:31:02,269 --> 00:31:04,240
of this very similar things as a

565
00:31:04,240 --> 00:31:08,010
as a snorters arm tell

566
00:31:08,010 --> 00:31:12,220
as I said earlier we have the external
output format and I said you can right

567
00:31:12,220 --> 00:31:16,100
your own are rule set there are excuse
me external program that would go

568
00:31:16,100 --> 00:31:16,789
through

569
00:31:16,789 --> 00:31:20,120
and add a firewall rule set well 30
saying that

570
00:31:20,120 --> 00:31:23,750
that's fine art but there's actually a
project already out there it's called

571
00:31:23,750 --> 00:31:24,700
snort Sam

572
00:31:24,700 --> 00:31:27,919
and I don't has anybody ever gotten a
chance to play with that

573
00:31:27,919 --> 00:31:31,240
it always amazes me that nobody uses
this more basically takes

574
00:31:31,240 --> 00:31:35,710
the I do you think this nor engine it
turns into an IPS

575
00:31:35,710 --> 00:31:39,110
both sports am what's interesting about
it it going communicate with your

576
00:31:39,110 --> 00:31:40,240
printer gear

577
00:31:40,240 --> 00:31:43,929
so if you if you have a an event happen

578
00:31:43,929 --> 00:31:47,730
store same will actually communicate
your Cisco and then drop in NaCl

579
00:31:47,730 --> 00:31:51,320
or go to your you know are

580
00:31:51,320 --> 00:31:55,610
your ASA what your essay and drop in AC
or your Linux box if you use Linux box

581
00:31:55,610 --> 00:31:56,000
for

582
00:31:56,000 --> 00:31:59,450
so it can go out to your perimeter and
blockers

583
00:31:59,450 --> 00:32:02,909
one say can we actually use the exact
same thing so if the log message comes

584
00:32:02,909 --> 00:32:03,460
in

585
00:32:03,460 --> 00:32:07,000
in you deem it that holy crap this is so
bad did

586
00:32:07,000 --> 00:32:10,799
if this gets triggered this rule set I
have to have the stop baby to be

587
00:32:10,799 --> 00:32:11,750
proactive

588
00:32:11,750 --> 00:32:14,880
where you can do is you can use this to
tell Sagan to

589
00:32:14,880 --> 00:32:18,260
go out here for me to hear your Cisco
ASA is or whatever your

590
00:32:18,260 --> 00:32:22,440
juniper boxes or whatever and Spencer
firewall in the way that you do that

591
00:32:22,440 --> 00:32:25,850
again we go back to our rules we simply
at an the

592
00:32:25,850 --> 00:32:28,929
the source am direct there we tell it

593
00:32:28,929 --> 00:32:32,260
fire walk by the source IP address at
the destination

594
00:32:32,260 --> 00:32:35,590
and then you give it the time that you
want it to be firewall for

595
00:32:35,590 --> 00:32:38,679
an R it automatically got into this way

596
00:32:38,679 --> 00:32:43,080
and the same thing with smart but so
rather than using the external plug into

597
00:32:43,080 --> 00:32:46,769
write your own I think this is a better
way to do it or even tested people

598
00:32:46,769 --> 00:32:50,490
actually are you use it arm I'm gonna go
through

599
00:32:50,490 --> 00:32:53,679
preprocessor this is gonna be a fairly
new things everything they've talked

600
00:32:53,679 --> 00:32:54,909
about so far

601
00:32:54,909 --> 00:32:58,380
is based off a rule sets and rules that
define

602
00:32:58,380 --> 00:33:02,870
arm the you need to invest a lot of time
in research in the tech hardware whatnot

603
00:33:02,870 --> 00:33:04,380
that you want to write rules for

604
00:33:04,380 --> 00:33:07,929
are preprocessor allow us to do
interesting things there are also

605
00:33:07,929 --> 00:33:11,200
base I am up for instance

606
00:33:11,200 --> 00:33:14,779
probably one of the most simple
preprocess is that we can do

607
00:33:14,779 --> 00:33:18,669
is to track the I systems that are
reporting to us

608
00:33:18,669 --> 00:33:23,000
if I have an environment have 50 servers
and they're all logging information over

609
00:33:23,000 --> 00:33:23,830
to me

610
00:33:23,830 --> 00:33:27,340
and then one of them goes away so now I
have 49 I need some sort of mechanism

611
00:33:27,340 --> 00:33:28,549
the tell me

612
00:33:28,549 --> 00:33:32,120
hey somebody just isn't logging so the
busted one

613
00:33:32,120 --> 00:33:35,890
is the is the say contract class a base
you what it does

614
00:33:35,890 --> 00:33:40,529
who says if you don't hear from the
particular machine and 360 minutes

615
00:33:40,529 --> 00:33:43,809
give me an alert is that based on rules
and that is a really kinda

616
00:33:43,809 --> 00:33:47,379
a simple example but then you get a
ruling on whether those consoles X nor

617
00:33:47,380 --> 00:33:47,820
be

618
00:33:47,820 --> 00:33:50,950
or whatever thing else to hey I haven't
heard from this guy and while there

619
00:33:50,950 --> 00:33:53,559
whenever you go there you say oh shit to
me turn it off

620
00:33:53,559 --> 00:33:56,658
in turn it back on right whenever he
sees a log information he says

621
00:33:56,659 --> 00:34:00,500
hey by the way I'm starting see him
again everybody's everybody's good

622
00:34:00,500 --> 00:34:03,860
but what you can do with that is then
you can start doing are

623
00:34:03,860 --> 00:34:08,320
are anomaly detection and things of that
nature in statistical stuff so for

624
00:34:08,320 --> 00:34:09,359
instance

625
00:34:09,359 --> 00:34:12,739
maybe it's an event that is arm

626
00:34:12,740 --> 00:34:17,010
coming in ten thousand times a second it
is not tripping up any rules

627
00:34:17,010 --> 00:34:20,510
that kind of an anomaly might not might
wanna know about that

628
00:34:20,510 --> 00:34:24,879
so what they can do is actually say well
I'm getting this event a whole crap time

629
00:34:24,879 --> 00:34:27,969
so maybe I'll go ahead and generate in a
bit saying hey I'm not sure this is

630
00:34:27,970 --> 00:34:28,980
important to you but

631
00:34:28,980 --> 00:34:32,940
this particular message keeps coming up
so you can do things like that

632
00:34:32,940 --> 00:34:36,720
arm we also did a project where we're
doing

633
00:34:36,720 --> 00:34:39,899
some work with our web since Websense
has a

634
00:34:39,899 --> 00:34:43,819
thing called the threat seeker network
and basically what it is you can

635
00:34:43,820 --> 00:34:47,849
you think worry there that work and find
out reputation

636
00:34:47,849 --> 00:34:50,899
base stuff like british-based by Pierre
wud

637
00:34:50,899 --> 00:34:55,418
and what we can do with Sagan is
racially connection that procedure

638
00:34:55,418 --> 00:34:56,078
network

639
00:34:56,079 --> 00:35:00,140
and even before its got into a part
where it might trigger a rule

640
00:35:00,140 --> 00:35:04,020
were already looking at the information
like IP addresses what type operations

641
00:35:04,020 --> 00:35:06,210
coming from the log message by itself

642
00:35:06,210 --> 00:35:09,210
to figure out maybe it's something bad
so

643
00:35:09,210 --> 00:35:13,180
for instance one OVR the demonstrations
that I gave was to go to a command line

644
00:35:13,180 --> 00:35:15,410
and type in paying in the typing in on
botnet

645
00:35:15,410 --> 00:35:18,890
and in the bathroom would trigger what
up Bashara but since the bash

646
00:35:18,890 --> 00:35:22,598
logs are being sent to a centralized
server it would automatically say he's

647
00:35:22,599 --> 00:35:23,040
paying

648
00:35:23,040 --> 00:35:26,640
it wouldn't pick out the IP address and
tel aviv you know set up an alarm that

649
00:35:26,640 --> 00:35:27,650
basically says

650
00:35:27,650 --> 00:35:30,930
somebody's you know trying to
communicate with other norm but that

651
00:35:30,930 --> 00:35:33,200
network or IP address that is a a known

652
00:35:33,200 --> 00:35:36,240
but that network but abortion with the
threat stickers stuff

653
00:35:36,240 --> 00:35:39,240
I am its I though the close or plugin

654
00:35:39,240 --> 00:35:42,680
forsaken and but it's not really that
big a video being

655
00:35:42,680 --> 00:35:46,390
Ramage website crap you have a home mean
problem

656
00:35:46,390 --> 00:35:49,750
so people hero who want to use the web
since to

657
00:35:49,750 --> 00:35:55,109
are are typically I'm already a lot
invested in it

658
00:35:55,109 --> 00:35:58,369
arm and then there's other stuff too we
can take a lot of this to go about pre

659
00:35:58,369 --> 00:35:59,349
processors

660
00:35:59,349 --> 00:36:02,660
and turnaround in use in other places
for it is like taking

661
00:36:02,660 --> 00:36:07,020
ID she'll information and utilizing that
or

662
00:36:07,020 --> 00:36:10,259
are just 100 places you can get attacked
leader from across the inner

663
00:36:10,260 --> 00:36:13,540
important to say cuz they were seeing
their all in real time

664
00:36:13,540 --> 00:36:17,410
be it rule-based or not rule based in
and stuff like that

665
00:36:17,410 --> 00:36:22,230
arm and that was pretty much just gonna
try to get through to the didn't know

666
00:36:22,230 --> 00:36:26,089
with the 0 well that works out pretty
good arm

667
00:36:26,089 --> 00:36:29,140
I with the the last speaker he's

668
00:36:29,140 --> 00:36:33,589
chemical in which is fine are going to
get a public place through this year a

669
00:36:33,589 --> 00:36:34,119
quick

670
00:36:34,119 --> 00:36:38,030
but I am to what I like to do now is
just a real quick Q&A any kinda

671
00:36:38,030 --> 00:36:43,010
questions or anything like that

672
00:36:43,010 --> 00:36:45,440
I could have explained that while

673
00:36:45,440 --> 00:36:49,680
there's no way I hardly understand
anything it's I

674
00:36:49,680 --> 00:36:53,799
I know what a curly taking that played a

675
00:36:53,800 --> 00:36:57,070
their I'm were basically taking it
either

676
00:36:57,070 --> 00:37:01,070
syslog event logger yeah events from
Window System

677
00:37:01,070 --> 00:37:04,350
you can do SNMP SNMP 30 the SNMP trap

678
00:37:04,350 --> 00:37:08,569
because basically with SNMP trap in his
record to syslog message we can

679
00:37:08,570 --> 00:37:11,830
we can do stuff like that we're not
really doing anything when Apple is over

680
00:37:11,830 --> 00:37:13,299
Central syslog server with

681
00:37:13,300 --> 00:37:17,750
ninety days worth of stuff what do I
need to arm

682
00:37:17,750 --> 00:37:22,120
you know put a week's worth in here run
it's been up me to spend on a

683
00:37:22,120 --> 00:37:25,150
know what I need to spend it what do I
need to set up to okok

684
00:37:25,150 --> 00:37:28,340
I well basically if your gonna be using
the

685
00:37:28,340 --> 00:37:33,910
ideas back and and whatnot I got okay
perfect perfect there are no it doesn't

686
00:37:33,910 --> 00:37:37,870
take part in kind of person who will be
learning to her or about how to install

687
00:37:37,870 --> 00:37:38,440
Sagan

688
00:37:38,440 --> 00:37:42,110
this very much like the Configure make
make install are gonna get weaker

689
00:37:42,110 --> 00:37:43,410
configuration file

690
00:37:43,410 --> 00:37:46,640
then you have to figure how you to place
it into your network

691
00:37:46,640 --> 00:37:50,160
that is it is your centralized
environment might be set up in such a

692
00:37:50,160 --> 00:37:50,759
way that

693
00:37:50,760 --> 00:37:53,870
there's no compromise for changing that
environment

694
00:37:53,870 --> 00:37:57,049
so what you might be able to do is that
if it's going to take an arc site or

695
00:37:57,050 --> 00:37:58,780
something some for a centralized system

696
00:37:58,780 --> 00:38:02,880
is sent from that situation system back
over to the second box or you might have

697
00:38:02,880 --> 00:38:04,180
seen Smith the wire

698
00:38:04,180 --> 00:38:07,299
import logs off by himself we try to
make it so that

699
00:38:07,300 --> 00:38:10,590
if you already have like this blog or
something Rd in there

700
00:38:10,590 --> 00:38:14,690
that you don't necessarily have to rip
it out re investor redo all your network

701
00:38:14,690 --> 00:38:15,490
to try to make it

702
00:38:15,490 --> 00:38:18,680
so it's purely friendly with that so
that would be the other step is figuring

703
00:38:18,680 --> 00:38:21,060
out how to implement a interior

704
00:38:21,060 --> 00:38:28,060
hope that if that helps judy

705
00:38:35,339 --> 00:38:40,680
right I am

706
00:38:40,680 --> 00:38:45,160
so it so you have the question was you
have Arsis login is going up to heart

707
00:38:45,160 --> 00:38:49,379
so I'm assuming have are syslog singing
to another are syslog which seems a

708
00:38:49,380 --> 00:38:56,039
since it out well I mean actually I have
not really run into the

709
00:38:56,039 --> 00:38:59,969
problem but I am what I would probably
say as long as you're

710
00:38:59,969 --> 00:39:03,289
arm the information is I'm assuming

711
00:39:03,289 --> 00:39:08,710
exist and a DP 514 canister I spoofing
the addresses have to go through

712
00:39:08,710 --> 00:39:12,650
Excel the device that reports to isn't
is all the data in check

713
00:39:12,650 --> 00:39:19,150
and I would take the very end right

714
00:39:19,150 --> 00:39:25,119
right to use in July server

715
00:39:25,119 --> 00:39:29,049
I would say at where probably as long as
your data is intact

716
00:39:29,049 --> 00:39:32,059
prolly where the centralized server is
probably your best bet

717
00:39:32,059 --> 00:39:35,450
because everything's gonna party getting
over there anyways eighty per putting it

718
00:39:35,450 --> 00:39:39,489
out at the different areas and yes %uh
model sagen sie a multiple sensors and

719
00:39:39,489 --> 00:39:44,249
at what I would think going to talk
about that more kinda from

720
00:39:44,249 --> 00:39:47,759
uphill cool

721
00:39:47,759 --> 00:39:52,239
any more questions me actually goes

722
00:39:52,239 --> 00:39:54,299
plays into that crap

723
00:39:54,299 --> 00:40:01,299
I'm bout you very much either

724
00:40:01,300 --> 00:40:05,220
ok and a CPA may need to use the mic I i
think is a look at a CPU load

725
00:40:05,220 --> 00:40:09,910
to use so like a snort whenever you put
into an environment

726
00:40:09,910 --> 00:40:13,899
are with IDS you typically wanted to
return on just the rule sets for you

727
00:40:13,900 --> 00:40:14,720
want so

728
00:40:14,720 --> 00:40:19,180
for instance if you don't have any MS
SQL databases in your network key turn

729
00:40:19,180 --> 00:40:20,930
off the MSSQL rules

730
00:40:20,930 --> 00:40:24,859
the be your Oracle rules which may be
used you leave those on you do the same

731
00:40:24,860 --> 00:40:26,480
thing was taken you actually say

732
00:40:26,480 --> 00:40:30,000
either take a system that I know that
are in my network so I'm only gonna turn

733
00:40:30,000 --> 00:40:30,450
on the

734
00:40:30,450 --> 00:40:34,110
to protect the rule set I pointed that
is going to get people who dis load up

735
00:40:34,110 --> 00:40:35,050
all the rule sets

736
00:40:35,050 --> 00:40:38,140
you know in there it's just ridiculous
and then

737
00:40:38,140 --> 00:40:41,819
has taken has to be the extra work to go
through the figure out that these events

738
00:40:41,820 --> 00:40:44,990
are happy so what you wanna do is
customize your environment you can't we

739
00:40:44,990 --> 00:40:46,550
tune it down fairly well

740
00:40:46,550 --> 00:40:50,920
and i said i mean on sewing garments
were intended 15,000 are going to second

741
00:40:50,920 --> 00:40:52,890
this is a moderate hardness in like

742
00:40:52,890 --> 00:40:56,730
like super badass machines it's a big
decent machines

743
00:40:56,730 --> 00:41:00,980
but arm so it largely depends how the
law and you're getting how can a CPU

744
00:41:00,980 --> 00:41:01,850
time Perry

745
00:41:01,850 --> 00:41:06,110
you have how many rule sets are you
enable enabling them all you need is a

746
00:41:06,110 --> 00:41:06,510
few

747
00:41:06,510 --> 00:41:10,020
so it's it's largely tunable vietnam but
basically

748
00:41:10,020 --> 00:41:13,380
any other ones

749
00:41:13,380 --> 00:41:18,050
I have five more minutes but

750
00:41:18,050 --> 00:41:21,100
if well

751
00:41:21,100 --> 00:41:24,280
okay so Islam together

752
00:41:24,280 --> 00:41:28,060
image in Rayners live the live blog

753
00:41:28,060 --> 00:41:32,330
Nora log norm right I'm was that part of
his login opposition

754
00:41:32,330 --> 00:41:35,430
well analysis nom no he

755
00:41:35,430 --> 00:41:41,490
up a it's not really for log analysis it
was more take this extract data I'll

756
00:41:41,490 --> 00:41:45,120
logs to make it useful so he started
also writing

757
00:41:45,120 --> 00:41:49,049
like the web run in for our syslog lets
you search but reblogged you can

758
00:41:49,050 --> 00:41:51,240
actually had a web Brennan

759
00:41:51,240 --> 00:41:55,070
that let you go through everything you
know go through all your login desert

760
00:41:55,070 --> 00:42:00,270
arm his he wanted to use that to extract
certain types of information

761
00:42:00,270 --> 00:42:02,920
base not using a guy like in the same
way this thing is we're doing everything

762
00:42:02,920 --> 00:42:05,070
all in real time as it happens

763
00:42:05,070 --> 00:42:08,760
yeah he wants to be a little like
eventually take a an extract up so that

764
00:42:08,760 --> 00:42:10,370
you can go to use web interface ago

765
00:42:10,370 --> 00:42:14,130
show me the users who log in three
months ago or show me the second event

766
00:42:14,130 --> 00:42:17,620
Sagan really hard the concentrates on
security-related events that are

767
00:42:17,620 --> 00:42:18,480
happening in logs

768
00:42:18,480 --> 00:42:21,800
in real time and getting into that
everything in react better

769
00:42:21,800 --> 00:42:25,600
1 okay so my real question was is there
any

770
00:42:25,600 --> 00:42:29,630
integration overlap between sayin and no
less actually if you could ask for in a

771
00:42:29,630 --> 00:42:29,920
bit

772
00:42:29,920 --> 00:42:35,420
he actually started the live blog norm I
would say that they can use it more than

773
00:42:35,420 --> 00:42:38,420
are syslog nice I we have been

774
00:42:38,420 --> 00:42:41,520
it was something that was kinda jumped
on right whenever he

775
00:42:41,520 --> 00:42:46,610
made it so he's even told me he's a guy
you

776
00:42:46,610 --> 00:42:50,120
you we try to use have a good got you
gave you the hell so

777
00:42:50,120 --> 00:42:54,350
am glad that we can help ummm thank you
thank you

778
00:42:54,350 --> 00:43:00,870
yes I do not

779
00:43:00,870 --> 00:43:05,310
arm but you know i mean well I didn't
see that in the future

780
00:43:05,310 --> 00:43:10,060
for store either right right in the BRT
rules that I think it's the right now

781
00:43:10,060 --> 00:43:13,790
me now now I don't I don't see any but I

782
00:43:13,790 --> 00:43:19,420
you know i cant never say never but I
don't see that happening now especially

783
00:43:19,420 --> 00:43:22,420
with the girls now i cant I mean their
GP overs to

784
00:43:22,420 --> 00:43:26,870
I mean we can now but the genie back in
you know to those rules are

785
00:43:26,870 --> 00:43:30,569
their by I don't see there being any

786
00:43:30,570 --> 00:43:34,450
any anti-big commercialization of the
rules it's

787
00:43:34,450 --> 00:43:37,870
you know there's this at easy
information getting write your own

788
00:43:37,870 --> 00:43:38,759
family were

789
00:43:38,760 --> 00:43:43,390
my opinion a more

790
00:43:43,390 --> 00:43:47,350
cool why I really appreciate you guys

791
00:43:47,350 --> 00:43:49,670
thanks for coming out thank you

