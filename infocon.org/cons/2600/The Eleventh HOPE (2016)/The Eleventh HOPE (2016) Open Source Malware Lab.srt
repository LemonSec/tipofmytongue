1
00:00:00,000 --> 00:00:06,810
<font color="#CCCCCC">one away awesome alright so hello this</font>

2
00:00:03,990 --> 00:00:10,320
is<font color="#CCCCCC"> talking about open source</font><font color="#E5E5E5"> of our labs</font>

3
00:00:06,810 --> 00:00:11,428
and this is going to be<font color="#E5E5E5"> not necessarily</font>

4
00:00:10,320 --> 00:00:13,679
<font color="#CCCCCC">reverse</font><font color="#E5E5E5"> engineering but basically</font>

5
00:00:11,429 --> 00:00:14,910
malware analysis and then<font color="#E5E5E5"> automation</font>

6
00:00:13,679 --> 00:00:17,820
<font color="#E5E5E5">thereof</font>

7
00:00:14,910 --> 00:00:20,550
<font color="#E5E5E5">so who am i</font><font color="#CCCCCC"> I'm the</font><font color="#E5E5E5"> director of research</font>

8
00:00:17,820 --> 00:00:25,619
innovation at threat<font color="#E5E5E5"> connect</font><font color="#CCCCCC"> i'm on the</font>

9
00:00:20,550 --> 00:00:28,529
research team and the basic<font color="#E5E5E5"> you know</font>

10
00:00:25,619 --> 00:00:30,240
<font color="#E5E5E5">premise of my talk is is malware</font>

11
00:00:28,529 --> 00:00:31,800
analysis labs but<font color="#CCCCCC"> i need to answer the</font>

12
00:00:30,240 --> 00:00:34,410
question why do I need a malware

13
00:00:31,800 --> 00:00:35,969
analysis lab so<font color="#CCCCCC"> their number of reasons</font>

14
00:00:34,410 --> 00:00:38,760
why you would need a malware analysis

15
00:00:35,969 --> 00:00:42,180
lab so if you're doing<font color="#E5E5E5"> our analysis as</font>

16
00:00:38,760 --> 00:00:43,980
from a research perspective<font color="#CCCCCC"> you need to</font>

17
00:00:42,180 --> 00:00:47,039
have an automated<font color="#CCCCCC"> Mauer</font><font color="#E5E5E5"> and also system</font>

18
00:00:43,980 --> 00:00:49,288
to work on your samples because there's

19
00:00:47,039 --> 00:00:50,820
a problem scaling in the world that we

20
00:00:49,289 --> 00:00:53,309
live in there's more<font color="#E5E5E5"> people producing</font>

21
00:00:50,820 --> 00:00:55,170
malware<font color="#CCCCCC"> than</font><font color="#E5E5E5"> there are</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> you know</font>

22
00:00:53,309 --> 00:00:57,660
<font color="#E5E5E5">analyzing</font><font color="#CCCCCC"> malware so you need</font><font color="#E5E5E5"> to have</font>

23
00:00:55,170 --> 00:01:00,719
something that automates the many of the

24
00:00:57,660 --> 00:01:03,269
<font color="#CCCCCC">grunt work</font><font color="#E5E5E5"> components of</font><font color="#CCCCCC"> automated</font>

25
00:01:00,719 --> 00:01:07,590
<font color="#CCCCCC">malware analysis or malware analysis</font><font color="#E5E5E5"> so</font>

26
00:01:03,270 --> 00:01:10,439
<font color="#E5E5E5">what you see on the the right side</font><font color="#CCCCCC"> this</font>

27
00:01:07,590 --> 00:01:13,500
<font color="#E5E5E5">is</font><font color="#CCCCCC"> from Lenny Seltzer's stages of</font><font color="#E5E5E5"> our</font>

28
00:01:10,439 --> 00:01:16,649
<font color="#E5E5E5">analysis and so at the bottom you can</font>

29
00:01:13,500 --> 00:01:18,509
see there is fully automated analysis

30
00:01:16,650 --> 00:01:20,640
and then you have static properties

31
00:01:18,509 --> 00:01:22,170
analysis and then interactive behavior

32
00:01:20,640 --> 00:01:26,220
analysis so this is actually either

33
00:01:22,170 --> 00:01:28,229
instrumenting<font color="#E5E5E5"> a binary or using a</font>

34
00:01:26,220 --> 00:01:31,408
debugger and stepping through the code

35
00:01:28,229 --> 00:01:33,119
and then at the top in difficulty<font color="#E5E5E5"> level</font>

36
00:01:31,409 --> 00:01:36,030
<font color="#E5E5E5">so we're actually rising a difficulty</font>

37
00:01:33,119 --> 00:01:39,329
level here you have a manual code

38
00:01:36,030 --> 00:01:41,280
reversing<font color="#CCCCCC"> so this is using either pro or</font>

39
00:01:39,329 --> 00:01:44,008
hopper something like<font color="#E5E5E5"> that and looking</font>

40
00:01:41,280 --> 00:01:47,369
at the assembly code and understanding

41
00:01:44,009 --> 00:01:48,630
what the capabilities of<font color="#CCCCCC"> our</font><font color="#E5E5E5"> are so what</font>

42
00:01:47,369 --> 00:01:51,060
we're going to talk about today is

43
00:01:48,630 --> 00:01:53,729
actually not the two top harder by

44
00:01:51,060 --> 00:01:56,009
stages<font color="#CCCCCC"> we're going</font><font color="#E5E5E5"> to talk about the top</font>

45
00:01:53,729 --> 00:01:58,110
<font color="#E5E5E5">but the the bottom two and these are</font>

46
00:01:56,009 --> 00:02:01,200
ones that you can completely automate<font color="#E5E5E5"> so</font>

47
00:01:58,110 --> 00:02:04,289
<font color="#E5E5E5">one of the things by the way is that the</font>

48
00:02:01,200 --> 00:02:05,759
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> automated</font><font color="#CCCCCC"> our analysis systems</font>

49
00:02:04,290 --> 00:02:07,909
traditionally<font color="#CCCCCC"> you know people think of</font>

50
00:02:05,759 --> 00:02:11,989
them as

51
00:02:07,909 --> 00:02:13,849
<font color="#E5E5E5">behavioral and not static but actually</font>

52
00:02:11,989 --> 00:02:15,440
you can do static analysis as well you

53
00:02:13,849 --> 00:02:19,640
get that kind of<font color="#E5E5E5"> for free will see that</font>

54
00:02:15,440 --> 00:02:22,430
moment<font color="#CCCCCC"> so what can you do with automated</font>

55
00:02:19,640 --> 00:02:24,470
<font color="#E5E5E5">our analysis system so you can use it to</font>

56
00:02:22,430 --> 00:02:26,269
enhance a threat intelligence program if

57
00:02:24,470 --> 00:02:28,400
you have<font color="#E5E5E5"> you know if your organization</font>

58
00:02:26,269 --> 00:02:31,250
has like<font color="#CCCCCC"> threatened tell people like</font>

59
00:02:28,400 --> 00:02:32,750
they're going to be consumers of the day

60
00:02:31,250 --> 00:02:35,989
that comes out of an automated<font color="#E5E5E5"> malware</font>

61
00:02:32,750 --> 00:02:38,030
analysis system<font color="#E5E5E5"> there's also the concept</font>

62
00:02:35,989 --> 00:02:43,340
it's a very new concept of a hunt team

63
00:02:38,030 --> 00:02:45,920
<font color="#E5E5E5">where you have things that go bad or</font>

64
00:02:43,340 --> 00:02:49,910
things that alert<font color="#E5E5E5"> in your organization</font>

65
00:02:45,920 --> 00:02:52,010
and then<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> incident</font>

66
00:02:49,910 --> 00:02:54,530
<font color="#CCCCCC">response ER incident</font><font color="#E5E5E5"> responders will go</font>

67
00:02:52,010 --> 00:02:56,328
and look at what happened<font color="#E5E5E5"> so</font><font color="#CCCCCC"> hunt</font><font color="#E5E5E5"> team</font>

68
00:02:54,530 --> 00:02:58,010
is actually proactive

69
00:02:56,329 --> 00:03:01,220
so what they do is<font color="#CCCCCC"> not kind of the same</font>

70
00:02:58,010 --> 00:03:02,720
thing that in<font color="#E5E5E5"> and I our team will do but</font>

71
00:03:01,220 --> 00:03:04,790
they're not responding to an incident

72
00:03:02,720 --> 00:03:06,829
<font color="#CCCCCC">they're actually digging into different</font>

73
00:03:04,790 --> 00:03:11,090
things in your<font color="#E5E5E5"> organization and looking</font>

74
00:03:06,829 --> 00:03:14,269
for malware and looking for adversaries

75
00:03:11,090 --> 00:03:16,340
so<font color="#E5E5E5"> you any team like that</font><font color="#CCCCCC"> if they find a</font>

76
00:03:14,269 --> 00:03:18,200
piece of malware that hasn't been

77
00:03:16,340 --> 00:03:21,799
alerted they need to have some system

78
00:03:18,200 --> 00:03:25,459
<font color="#CCCCCC">they can do the you know the easy stuff</font>

79
00:03:21,799 --> 00:03:28,250
for them also<font color="#CCCCCC"> network</font><font color="#E5E5E5"> defense</font><font color="#CCCCCC"> so if you</font>

80
00:03:25,459 --> 00:03:29,299
have a<font color="#E5E5E5"> network defense system and you</font>

81
00:03:28,250 --> 00:03:32,840
know there's many different flavors

82
00:03:29,299 --> 00:03:35,840
thereof<font color="#CCCCCC"> but when</font><font color="#E5E5E5"> you have something that</font>

83
00:03:32,840 --> 00:03:38,599
does<font color="#E5E5E5"> network intrusion detection many</font>

84
00:03:35,840 --> 00:03:42,019
<font color="#E5E5E5">need systems will have a way to carve</font>

85
00:03:38,599 --> 00:03:43,668
files out of the network traffic and so

86
00:03:42,019 --> 00:03:45,950
you need to have something that will

87
00:03:43,669 --> 00:03:48,500
look automatically at those different

88
00:03:45,950 --> 00:03:52,069
files<font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> one position that an</font><font color="#CCCCCC"> ama</font>

89
00:03:48,500 --> 00:03:54,769
<font color="#E5E5E5">will have also if you have a email</font>

90
00:03:52,069 --> 00:03:56,839
server you have a lot of attachments<font color="#E5E5E5"> and</font>

91
00:03:54,769 --> 00:03:59,510
so<font color="#E5E5E5"> the attachments that come into your</font>

92
00:03:56,840 --> 00:04:02,209
<font color="#E5E5E5">organization</font><font color="#CCCCCC"> need to be analyzed using</font>

93
00:03:59,510 --> 00:04:04,310
an<font color="#CCCCCC"> AMA</font><font color="#E5E5E5"> and then finally host-based</font>

94
00:04:02,209 --> 00:04:06,440
intrusion detection systems and so you

95
00:04:04,310 --> 00:04:08,870
know other<font color="#CCCCCC"> this is the kind of medical</font>

96
00:04:06,440 --> 00:04:11,239
term but endpoint protection<font color="#E5E5E5"> so many</font>

97
00:04:08,870 --> 00:04:14,450
endpoint protection systems will report

98
00:04:11,239 --> 00:04:16,548
<font color="#E5E5E5">a binary back to their</font><font color="#CCCCCC"> mothership and</font><font color="#E5E5E5"> so</font>

99
00:04:14,450 --> 00:04:19,298
that<font color="#CCCCCC"> binary needs to be analyzed if</font><font color="#E5E5E5"> it's</font>

100
00:04:16,548 --> 00:04:21,008
not detected by that his system

101
00:04:19,298 --> 00:04:23,770
<font color="#E5E5E5">and then finally this is the thing that</font>

102
00:04:21,009 --> 00:04:28,750
<font color="#E5E5E5">I use</font><font color="#CCCCCC"> that everything</font><font color="#E5E5E5"> for because</font><font color="#CCCCCC"> i love</font>

103
00:04:23,770 --> 00:04:31,180
<font color="#E5E5E5">our analysis and it's a lot of fun</font><font color="#CCCCCC"> so my</font>

104
00:04:28,750 --> 00:04:35,979
talk today is about our analysis as a

105
00:04:31,180 --> 00:04:37,810
process but<font color="#E5E5E5"> entry points so you have a</font>

106
00:04:35,979 --> 00:04:41,318
number of different things that you can

107
00:04:37,810 --> 00:04:44,349
<font color="#E5E5E5">analyze and so</font><font color="#CCCCCC"> I've picked the top four</font>

108
00:04:41,319 --> 00:04:48,400
<font color="#CCCCCC">I think of entry points into the system</font>

109
00:04:44,349 --> 00:04:51,669
and<font color="#E5E5E5"> I file is the obvious</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> so these</font>

110
00:04:48,400 --> 00:04:54,159
are executables<font color="#E5E5E5"> it also encompasses</font><font color="#CCCCCC"> a</font>

111
00:04:51,669 --> 00:04:56,229
<font color="#E5E5E5">java jar files anything that is</font>

112
00:04:54,159 --> 00:04:59,169
executable<font color="#E5E5E5"> in</font><font color="#CCCCCC"> a system</font><font color="#E5E5E5"> it also</font>

113
00:04:56,229 --> 00:05:04,360
<font color="#E5E5E5">encompasses documents so you have rich</font>

114
00:04:59,169 --> 00:05:07,780
text files<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> word docs excel you</font>

115
00:05:04,360 --> 00:05:10,629
<font color="#E5E5E5">also have PDF and then the next entry</font>

116
00:05:07,780 --> 00:05:12,489
point<font color="#CCCCCC"> i'm talking about is URL so you</font>

117
00:05:10,629 --> 00:05:15,340
have<font color="#CCCCCC"> drive-by URLs you also have</font>

118
00:05:12,490 --> 00:05:17,620
<font color="#E5E5E5">download</font><font color="#CCCCCC"> urls for malware payloads</font><font color="#E5E5E5"> and</font>

119
00:05:15,340 --> 00:05:19,989
so these need to be analyzed in a

120
00:05:17,620 --> 00:05:22,210
different way than a file<font color="#CCCCCC"> you</font><font color="#E5E5E5"> also have</font>

121
00:05:19,990 --> 00:05:23,919
<font color="#E5E5E5">pcap and so we'll talk about what pcap</font>

122
00:05:22,210 --> 00:05:27,609
is<font color="#CCCCCC"> but basically</font><font color="#E5E5E5"> this is network traffic</font>

123
00:05:23,919 --> 00:05:29,440
so you may have a small amount of

124
00:05:27,610 --> 00:05:33,250
network traffic that you want to analyze

125
00:05:29,440 --> 00:05:35,710
and<font color="#CCCCCC"> analyzed for malware analysis and</font>

126
00:05:33,250 --> 00:05:38,169
then<font color="#CCCCCC"> Matt</font><font color="#E5E5E5"> a memory image so when you run</font>

127
00:05:35,710 --> 00:05:39,279
malware<font color="#E5E5E5"> a really good way to find out</font>

128
00:05:38,169 --> 00:05:41,919
what it's doing and what it's thinking

129
00:05:39,279 --> 00:05:44,710
is basically looking at the memory image

130
00:05:41,919 --> 00:05:46,900
while it's running<font color="#E5E5E5"> so each one of these</font>

131
00:05:44,710 --> 00:05:49,628
particular entry points in our analysis

132
00:05:46,900 --> 00:05:52,750
process has an<font color="#CCCCCC"> open source tool you can</font>

133
00:05:49,629 --> 00:05:54,879
use<font color="#E5E5E5"> their</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> and by the way</font><font color="#CCCCCC"> I don't</font>

134
00:05:52,750 --> 00:05:56,379
want to start any fights as far as like

135
00:05:54,879 --> 00:05:59,050
which<font color="#E5E5E5"> tools better than another</font>

136
00:05:56,379 --> 00:06:02,650
<font color="#CCCCCC">I</font><font color="#E5E5E5"> just chose the ones that</font><font color="#CCCCCC"> I use and so</font>

137
00:05:59,050 --> 00:06:05,469
when you're analyzing<font color="#CCCCCC"> a file i use</font><font color="#E5E5E5"> cout</font>

138
00:06:02,650 --> 00:06:08,409
sandbox and there are<font color="#CCCCCC"> no paid solutions</font>

139
00:06:05,469 --> 00:06:10,270
but the thing is for this talk<font color="#CCCCCC"> I'm only</font>

140
00:06:08,409 --> 00:06:13,810
going<font color="#E5E5E5"> to talk about things that are</font>

141
00:06:10,270 --> 00:06:17,109
either a open source or be something

142
00:06:13,810 --> 00:06:18,520
that you can login<font color="#E5E5E5"> to for free and so</font>

143
00:06:17,110 --> 00:06:19,930
you know there's some systems<font color="#E5E5E5"> that</font><font color="#CCCCCC"> i'm</font>

144
00:06:18,520 --> 00:06:21,639
going<font color="#E5E5E5"> to talk about you may need to</font>

145
00:06:19,930 --> 00:06:26,560
actually register<font color="#E5E5E5"> for but they are free</font>

146
00:06:21,639 --> 00:06:30,160
and then thug<font color="#CCCCCC"> this is probably the least</font>

147
00:06:26,560 --> 00:06:33,160
famous of all these tools but thug is

148
00:06:30,160 --> 00:06:36,910
<font color="#CCCCCC">a low interaction</font><font color="#E5E5E5"> honey client that</font><font color="#CCCCCC"> dot</font>

149
00:06:33,160 --> 00:06:39,880
looks at<font color="#CCCCCC"> urls and analyzes</font><font color="#E5E5E5"> the URL bro</font>

150
00:06:36,910 --> 00:06:42,580
is<font color="#CCCCCC"> a network</font><font color="#E5E5E5"> security monitoring tool</font>

151
00:06:39,880 --> 00:06:45,640
and there's a<font color="#CCCCCC"> nuanced</font><font color="#E5E5E5"> and what</font><font color="#CCCCCC"> I'm</font>

152
00:06:42,580 --> 00:06:48,640
talking about today because bro can be

153
00:06:45,640 --> 00:06:51,310
used as a traditional network security

154
00:06:48,640 --> 00:06:53,710
monitoring tool to look<font color="#CCCCCC"> at in a broad</font>

155
00:06:51,310 --> 00:06:57,370
network capture<font color="#CCCCCC"> i'm going to talk about</font>

156
00:06:53,710 --> 00:06:59,950
it as a<font color="#CCCCCC"> malware analysis tool will get</font>

157
00:06:57,370 --> 00:07:02,710
<font color="#E5E5E5">into the details of</font><font color="#CCCCCC"> that in a moment and</font>

158
00:06:59,950 --> 00:07:06,610
then volatility volatility is a memory

159
00:07:02,710 --> 00:07:09,400
analysis tool<font color="#CCCCCC"> so first let's look at</font><font color="#E5E5E5"> KU</font>

160
00:07:06,610 --> 00:07:12,700
sandbox and actually earlier today I

161
00:07:09,400 --> 00:07:15,280
included a lot of very new information

162
00:07:12,700 --> 00:07:18,250
in my talk so we're going to look at

163
00:07:15,280 --> 00:07:22,000
some malware that is very fresh within

164
00:07:18,250 --> 00:07:24,160
the<font color="#E5E5E5"> past two weeks so the</font><font color="#CCCCCC"> coup sandbox</font>

165
00:07:22,000 --> 00:07:25,660
part of this talk is<font color="#E5E5E5"> has some of the</font>

166
00:07:24,160 --> 00:07:27,940
older stuff and so<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to kind of</font>

167
00:07:25,660 --> 00:07:30,940
you know move quickly over this<font color="#E5E5E5"> to get</font>

168
00:07:27,940 --> 00:07:34,150
into the really the new stuff in my talk

169
00:07:30,940 --> 00:07:36,610
so<font color="#E5E5E5"> I a sandbox</font><font color="#CCCCCC"> if you don't know what it</font>

170
00:07:34,150 --> 00:07:38,859
is is a controlled environment where the

171
00:07:36,610 --> 00:07:40,570
you can execute execute malware and

172
00:07:38,860 --> 00:07:44,650
controlled environment and then observe

173
00:07:40,570 --> 00:07:47,680
its behavior and<font color="#E5E5E5"> I you at the same time</font>

174
00:07:44,650 --> 00:07:52,479
<font color="#E5E5E5">you're able to run that particular file</font>

175
00:07:47,680 --> 00:07:56,410
<font color="#CCCCCC">thru static analysis tools</font><font color="#E5E5E5"> so one of the</font>

176
00:07:52,480 --> 00:07:58,540
things that dynamic analysis<font color="#CCCCCC"> you know</font>

177
00:07:56,410 --> 00:08:02,080
has is that it's very sexy

178
00:07:58,540 --> 00:08:05,560
you get a lot of uh you know<font color="#CCCCCC"> network</font>

179
00:08:02,080 --> 00:08:07,419
indicators out of it<font color="#E5E5E5"> so I kind of think</font>

180
00:08:05,560 --> 00:08:09,490
that you know because it's sexy it's

181
00:08:07,419 --> 00:08:11,620
something that you probably already know

182
00:08:09,490 --> 00:08:12,640
so<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to talk more right now and</font>

183
00:08:11,620 --> 00:08:14,110
<font color="#CCCCCC">i'm going</font><font color="#E5E5E5"> to highlight some of the</font>

184
00:08:12,640 --> 00:08:16,390
things that you can get from the static

185
00:08:14,110 --> 00:08:21,250
analysis components of<font color="#CCCCCC"> cuckoo</font>

186
00:08:16,390 --> 00:08:25,360
so this is actually from a mac OS piece

187
00:08:21,250 --> 00:08:30,220
of malware that this was and you may

188
00:08:25,360 --> 00:08:34,780
have heard of this event<font color="#CCCCCC"> but there</font><font color="#E5E5E5"> is a</font>

189
00:08:30,220 --> 00:08:38,650
there's a torrent downloader<font color="#E5E5E5"> called</font>

190
00:08:34,780 --> 00:08:42,059
transmission and the 2.90 version of

191
00:08:38,650 --> 00:08:45,480
transmission was actually<font color="#CCCCCC"> Mac malware</font>

192
00:08:42,059 --> 00:08:48,930
<font color="#E5E5E5">the adversary head in</font><font color="#CCCCCC"> you know basically</font>

193
00:08:45,480 --> 00:08:53,160
pound the<font color="#E5E5E5"> trend you know transmissions</font>

194
00:08:48,930 --> 00:08:56,189
<font color="#E5E5E5">systems and so transmission was serving</font>

195
00:08:53,160 --> 00:08:57,870
this particular piece of our<font color="#CCCCCC"> so when I</font>

196
00:08:56,190 --> 00:08:59,940
want to<font color="#E5E5E5"> reverse engineer this malware</font>

197
00:08:57,870 --> 00:09:01,830
<font color="#CCCCCC">one of the things that you need to do</font>

198
00:08:59,940 --> 00:09:05,279
before you get to that stage is

199
00:09:01,830 --> 00:09:08,790
understand what<font color="#E5E5E5"> Packer is being used by</font>

200
00:09:05,279 --> 00:09:10,620
the adversary<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I have tools that i</font>

201
00:09:08,790 --> 00:09:13,290
can look<font color="#E5E5E5"> at this piece of</font><font color="#CCCCCC"> our and find</font>

202
00:09:10,620 --> 00:09:18,420
out what<font color="#CCCCCC"> packers being used but i always</font>

203
00:09:13,290 --> 00:09:20,640
like<font color="#E5E5E5"> to find a shortcut and cheat so I</font>

204
00:09:18,420 --> 00:09:23,699
ran this through strings and you can see

205
00:09:20,640 --> 00:09:25,350
here that it's been packed with<font color="#CCCCCC"> upx</font><font color="#E5E5E5"> and</font>

206
00:09:23,700 --> 00:09:29,040
in addition<font color="#E5E5E5"> it's been packed with a</font>

207
00:09:25,350 --> 00:09:32,430
particular<font color="#E5E5E5"> upx version so I of course</font>

208
00:09:29,040 --> 00:09:33,900
<font color="#CCCCCC">this</font><font color="#E5E5E5"> data can be forged by the</font><font color="#CCCCCC"> hour</font>

209
00:09:32,430 --> 00:09:35,489
author but you know<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> just going to</font>

210
00:09:33,900 --> 00:09:37,860
say like maybe they're not<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font>

211
00:09:35,490 --> 00:09:39,690
to try and<font color="#E5E5E5"> I've shortcut my analysis</font>

212
00:09:37,860 --> 00:09:41,790
process so<font color="#CCCCCC"> i know the packer that I need</font>

213
00:09:39,690 --> 00:09:45,570
to use to look at this piece of malware

214
00:09:41,790 --> 00:09:48,240
and find the<font color="#E5E5E5"> unpacked source code</font><font color="#CCCCCC"> and so</font>

215
00:09:45,570 --> 00:09:50,190
if you don't know what a<font color="#E5E5E5"> packer is so a</font>

216
00:09:48,240 --> 00:09:53,640
<font color="#CCCCCC">packer</font><font color="#E5E5E5"> is a weight of two packaged</font>

217
00:09:50,190 --> 00:09:57,900
software and it's either encoded<font color="#E5E5E5"> or</font>

218
00:09:53,640 --> 00:10:00,810
encrypted<font color="#E5E5E5"> and so the when you run that</font>

219
00:09:57,900 --> 00:10:03,180
when<font color="#E5E5E5"> when you run a</font><font color="#CCCCCC"> pact binary</font><font color="#E5E5E5"> through</font>

220
00:10:00,810 --> 00:10:05,910
a disassembler<font color="#E5E5E5"> you're only going to get</font>

221
00:10:03,180 --> 00:10:07,650
the assembly code for the packer<font color="#CCCCCC"> you're</font>

222
00:10:05,910 --> 00:10:09,390
not going to get the actual executed

223
00:10:07,650 --> 00:10:14,130
code because<font color="#E5E5E5"> that's actually contained</font>

224
00:10:09,390 --> 00:10:16,830
in a<font color="#E5E5E5"> encoded or encrypted area of the PE</font>

225
00:10:14,130 --> 00:10:18,300
file<font color="#E5E5E5"> so you need to know what</font><font color="#CCCCCC"> packer it</font>

226
00:10:16,830 --> 00:10:21,450
is and then run it through<font color="#CCCCCC"> a non packer</font>

227
00:10:18,300 --> 00:10:24,209
and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> analyzed the unpacked binary so</font>

228
00:10:21,450 --> 00:10:27,720
again this is the same binary and<font color="#CCCCCC"> i</font>

229
00:10:24,210 --> 00:10:29,580
consider<font color="#CCCCCC"> AV detection zaz a type of</font>

230
00:10:27,720 --> 00:10:31,080
static analysis because you're not

231
00:10:29,580 --> 00:10:34,050
looking at the behavior of the<font color="#CCCCCC"> Mallory</font>

232
00:10:31,080 --> 00:10:35,790
looking at the signatures<font color="#E5E5E5"> and so one of</font>

233
00:10:34,050 --> 00:10:38,279
the things that is very good about<font color="#E5E5E5"> AV</font>

234
00:10:35,790 --> 00:10:40,770
detection some<font color="#CCCCCC"> AV engines do actually</font>

235
00:10:38,279 --> 00:10:44,790
have very highly<font color="#E5E5E5"> you know targeted</font>

236
00:10:40,770 --> 00:10:47,069
<font color="#E5E5E5">signatures and so I you run your binary</font>

237
00:10:44,790 --> 00:10:49,500
through that and you may get a<font color="#E5E5E5"> head</font>

238
00:10:47,070 --> 00:10:51,600
<font color="#E5E5E5">start as to what this thing is that</font>

239
00:10:49,500 --> 00:10:54,930
you're<font color="#E5E5E5"> looking at and you can basically</font>

240
00:10:51,600 --> 00:10:55,620
<font color="#CCCCCC">Google this so this is key Ranger</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> and</font>

241
00:10:54,930 --> 00:10:58,739
so

242
00:10:55,620 --> 00:11:00,630
<font color="#E5E5E5">you can get from the</font><font color="#CCCCCC"> Navy detection a</font>

243
00:10:58,740 --> 00:11:03,690
<font color="#E5E5E5">head start on what it is that you want</font>

244
00:11:00,630 --> 00:11:05,610
to analyze<font color="#CCCCCC"> so I'm gonna kind of change</font>

245
00:11:03,690 --> 00:11:08,279
lanes here and this is actually data

246
00:11:05,610 --> 00:11:12,450
about a PE file we were just looking at

247
00:11:08,279 --> 00:11:14,279
a<font color="#E5E5E5"> mock</font><font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> binary for mac OS and now</font>

248
00:11:12,450 --> 00:11:16,320
we're going to look at<font color="#CCCCCC"> windows binary</font>

249
00:11:14,279 --> 00:11:17,490
and so<font color="#CCCCCC"> windows binary has certain</font>

250
00:11:16,320 --> 00:11:19,020
features of it

251
00:11:17,490 --> 00:11:21,960
<font color="#CCCCCC">student</font><font color="#E5E5E5"> static features that you can</font>

252
00:11:19,020 --> 00:11:24,720
<font color="#E5E5E5">analyze and so one of the things is a</font><font color="#CCCCCC"> pc</font>

253
00:11:21,960 --> 00:11:27,960
sections<font color="#E5E5E5"> and so this is the</font><font color="#CCCCCC"> rsr</font>

254
00:11:24,720 --> 00:11:32,250
<font color="#E5E5E5">c-section and because</font><font color="#CCCCCC"> it's malware if it</font>

255
00:11:27,960 --> 00:11:34,230
were a you know a benign binary<font color="#E5E5E5"> the</font>

256
00:11:32,250 --> 00:11:38,040
sections may actually correspond to

257
00:11:34,230 --> 00:11:39,870
things that are correct<font color="#E5E5E5"> or usable but</font>

258
00:11:38,040 --> 00:11:42,870
sometimes like<font color="#E5E5E5"> malware authors will just</font>

259
00:11:39,870 --> 00:11:45,180
make things up<font color="#CCCCCC"> and so the rsrc may not</font>

260
00:11:42,870 --> 00:11:47,460
actually be a resource section it<font color="#E5E5E5"> may be</font>

261
00:11:45,180 --> 00:11:51,089
something else<font color="#CCCCCC"> in</font><font color="#E5E5E5"> our author wants to do</font>

262
00:11:47,460 --> 00:11:55,980
<font color="#E5E5E5">but you can take an md5 of that section</font>

263
00:11:51,089 --> 00:11:57,839
using a sandbox and<font color="#E5E5E5"> then you can take</font>

264
00:11:55,980 --> 00:11:59,040
<font color="#E5E5E5">this section you can pivot around in</font>

265
00:11:57,839 --> 00:12:01,050
data sets in

266
00:11:59,040 --> 00:12:04,740
I you know other malware that you've

267
00:12:01,050 --> 00:12:07,260
collected you can see what this section

268
00:12:04,740 --> 00:12:09,180
refers to<font color="#E5E5E5"> that is the same as other</font>

269
00:12:07,260 --> 00:12:13,050
pieces of malware<font color="#CCCCCC"> that you've</font><font color="#E5E5E5"> previously</font>

270
00:12:09,180 --> 00:12:15,000
previously<font color="#E5E5E5"> collected and so</font><font color="#CCCCCC"> I found</font>

271
00:12:13,050 --> 00:12:18,510
<font color="#E5E5E5">their 52 files that are similar to this</font>

272
00:12:15,000 --> 00:12:20,610
one<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so now</font><font color="#CCCCCC"> i can then take those 52</font>

273
00:12:18,510 --> 00:12:24,209
files and<font color="#E5E5E5"> compare and find other things</font>

274
00:12:20,610 --> 00:12:27,660
that are the similar and see if there's

275
00:12:24,209 --> 00:12:30,180
any<font color="#E5E5E5"> like you know</font><font color="#CCCCCC"> thread that connects</font>

276
00:12:27,660 --> 00:12:32,490
these<font color="#E5E5E5"> with a previous piece of malware</font>

277
00:12:30,180 --> 00:12:36,239
and then therefore<font color="#CCCCCC"> find figure out like</font>

278
00:12:32,490 --> 00:12:38,910
what<font color="#CCCCCC"> I'm our family it is etc etc and so</font>

279
00:12:36,240 --> 00:12:41,459
also resources<font color="#CCCCCC"> or</font><font color="#E5E5E5"> resources or another</font>

280
00:12:38,910 --> 00:12:45,390
one so this is the<font color="#CCCCCC"> RT underscore version</font>

281
00:12:41,459 --> 00:12:47,369
and<font color="#E5E5E5"> I you know taking the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> shock to</font>

282
00:12:45,390 --> 00:12:50,310
be<font color="#CCCCCC"> six of this particular resource I</font>

283
00:12:47,370 --> 00:12:53,250
find<font color="#E5E5E5"> 99 files that are the same as the</font>

284
00:12:50,310 --> 00:12:56,430
<font color="#E5E5E5">PE that</font><font color="#CCCCCC"> i'm looking at as my target so</font>

285
00:12:53,250 --> 00:13:00,540
<font color="#E5E5E5">resources and sections are very similar</font>

286
00:12:56,430 --> 00:13:03,479
<font color="#E5E5E5">and this is this is actually really cool</font>

287
00:13:00,540 --> 00:13:06,150
technique by the way so what you're

288
00:13:03,480 --> 00:13:09,000
looking at here is the compilation or

289
00:13:06,150 --> 00:13:12,390
linking<font color="#E5E5E5"> timestamp of the PE file so</font>

290
00:13:09,000 --> 00:13:15,030
<font color="#CCCCCC">p file will have a timestamp this can be</font>

291
00:13:12,390 --> 00:13:17,850
stomped on by the adversary<font color="#CCCCCC"> so it could</font>

292
00:13:15,030 --> 00:13:19,500
say like<font color="#CCCCCC"> zero I've seen that a lot so it</font>

293
00:13:17,850 --> 00:13:22,920
<font color="#CCCCCC">will be you know january first nineteen</font>

294
00:13:19,500 --> 00:13:24,780
<font color="#CCCCCC">seventy</font><font color="#E5E5E5"> but if they don't</font><font color="#CCCCCC"> you have the</font>

295
00:13:22,920 --> 00:13:27,540
<font color="#CCCCCC">time stamp that they compiled and Link</font>

296
00:13:24,780 --> 00:13:30,600
the binary and so what you can do is you

297
00:13:27,540 --> 00:13:33,599
can compare that<font color="#CCCCCC"> timestamp</font><font color="#E5E5E5"> to the time</font>

298
00:13:30,600 --> 00:13:37,050
that something was submitted to like

299
00:13:33,600 --> 00:13:39,960
malware or virus total or any of these

300
00:13:37,050 --> 00:13:41,699
things that you can submit files to<font color="#CCCCCC"> and</font>

301
00:13:39,960 --> 00:13:44,640
<font color="#CCCCCC">adversaries submit files to these</font>

302
00:13:41,700 --> 00:13:49,320
systems to see if the system is able to

303
00:13:44,640 --> 00:13:52,530
flag it as bad<font color="#CCCCCC"> and so as you can see you</font>

304
00:13:49,320 --> 00:13:55,380
know this was<font color="#CCCCCC"> a 941 and 34 seconds and</font>

305
00:13:52,530 --> 00:13:59,370
then it was submitted<font color="#CCCCCC"> 942 and</font><font color="#E5E5E5"> 47 seconds</font>

306
00:13:55,380 --> 00:14:02,040
on<font color="#E5E5E5"> it is i would say impossible for this</font>

307
00:13:59,370 --> 00:14:06,090
to go and infect someone and come back

308
00:14:02,040 --> 00:14:09,510
<font color="#E5E5E5">so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> what you get here is I know the</font>

309
00:14:06,090 --> 00:14:12,390
submitter<font color="#E5E5E5"> to virustotal of this</font>

310
00:14:09,510 --> 00:14:14,189
particular file and so from now on<font color="#CCCCCC"> I can</font>

311
00:14:12,390 --> 00:14:17,880
<font color="#E5E5E5">watch the submitter hash</font><font color="#CCCCCC"> at virustotal</font>

312
00:14:14,190 --> 00:14:20,010
<font color="#E5E5E5">and find every single file</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this</font>

313
00:14:17,880 --> 00:14:23,640
malware authors submits<font color="#CCCCCC"> and I know that</font>

314
00:14:20,010 --> 00:14:25,140
it's bad<font color="#E5E5E5"> so</font><font color="#CCCCCC"> cool</font><font color="#E5E5E5"> sandbox comes in a</font>

315
00:14:23,640 --> 00:14:27,089
number of<font color="#E5E5E5"> flavors it has</font><font color="#CCCCCC"> plain-vanilla</font>

316
00:14:25,140 --> 00:14:28,500
<font color="#E5E5E5">this is the current stable version</font>

317
00:14:27,089 --> 00:14:30,990
<font color="#E5E5E5">there's a next generation right now</font>

318
00:14:28,500 --> 00:14:33,540
release candidate<font color="#E5E5E5"> one of two point i was</font>

319
00:14:30,990 --> 00:14:35,460
out there is also cool modified which

320
00:14:33,540 --> 00:14:36,810
has a bunch of features<font color="#E5E5E5"> that will go</font>

321
00:14:35,460 --> 00:14:41,460
into in just a moment

322
00:14:36,810 --> 00:14:42,989
<font color="#CCCCCC">soku modified does</font><font color="#E5E5E5"> normalization of</font>

323
00:14:41,460 --> 00:14:44,520
files and registry<font color="#CCCCCC"> paths</font><font color="#E5E5E5"> this is</font>

324
00:14:42,990 --> 00:14:46,470
<font color="#E5E5E5">actually really important and</font><font color="#CCCCCC"> i'm going</font>

325
00:14:44,520 --> 00:14:48,689
<font color="#E5E5E5">to talk about this in just a moment</font>

326
00:14:46,470 --> 00:14:51,810
it also<font color="#E5E5E5"> does</font><font color="#CCCCCC"> 64-bit analysis service</font>

327
00:14:48,690 --> 00:14:54,270
monitoring has an extended API you can

328
00:14:51,810 --> 00:14:57,630
do tour for outbound<font color="#E5E5E5"> network connections</font>

329
00:14:54,270 --> 00:15:00,540
and it has a male here integration<font color="#CCCCCC"> but</font>

330
00:14:57,630 --> 00:15:02,820
why is normalization important<font color="#CCCCCC"> so if</font>

331
00:15:00,540 --> 00:15:06,569
you're doing data analysis across a lot

332
00:15:02,820 --> 00:15:08,070
of<font color="#CCCCCC"> data sets and so some of the people</font>

333
00:15:06,570 --> 00:15:10,110
that you work with like you know in the

334
00:15:08,070 --> 00:15:12,270
malware analysis community<font color="#CCCCCC"> i get data</font>

335
00:15:10,110 --> 00:15:14,400
from other people that do our analysis

336
00:15:12,270 --> 00:15:16,710
<font color="#E5E5E5">and so they may actually be using a</font>

337
00:15:14,400 --> 00:15:19,079
different<font color="#E5E5E5"> flavor of windows for their vm</font>

338
00:15:16,710 --> 00:15:21,660
than<font color="#CCCCCC"> i am</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> so the top and the bottom</font>

339
00:15:19,080 --> 00:15:22,649
and<font color="#E5E5E5"> I apologize don't remember which one</font>

340
00:15:21,660 --> 00:15:25,559
is windows<font color="#CCCCCC"> 7</font><font color="#E5E5E5"> and</font>

341
00:15:22,649 --> 00:15:27,480
XP but one of these strings is<font color="#CCCCCC"> windows 7</font>

342
00:15:25,559 --> 00:15:30,629
and<font color="#E5E5E5"> the other is XP and so obviously</font>

343
00:15:27,480 --> 00:15:33,569
these you can't do analysis across a lot

344
00:15:30,629 --> 00:15:35,610
of<font color="#E5E5E5"> sand boxes with this but if you</font>

345
00:15:33,569 --> 00:15:38,368
normalize the data and replace that with

346
00:15:35,610 --> 00:15:40,949
a<font color="#E5E5E5"> environment variable</font><font color="#CCCCCC"> appdata</font><font color="#E5E5E5"> you can</font>

347
00:15:38,369 --> 00:15:43,319
now do and you can now do analysis

348
00:15:40,949 --> 00:15:46,199
across a number of different sandbox

349
00:15:43,319 --> 00:15:49,259
<font color="#E5E5E5">flavors depending you know but not</font>

350
00:15:46,199 --> 00:15:51,300
depending on the type of<font color="#CCCCCC"> windows that</font>

351
00:15:49,259 --> 00:15:52,439
was used<font color="#CCCCCC"> so</font><font color="#E5E5E5"> this is really important if</font>

352
00:15:51,300 --> 00:15:55,709
<font color="#E5E5E5">you're getting data from a lot of</font>

353
00:15:52,439 --> 00:15:57,509
different sources<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> cuckoo</font>

354
00:15:55,709 --> 00:16:00,628
<font color="#CCCCCC">next-generation those two point O has a</font>

355
00:15:57,509 --> 00:16:01,920
lot of new features on<font color="#E5E5E5"> Mac</font><font color="#CCCCCC"> os10 linux</font>

356
00:16:00,629 --> 00:16:04,949
<font color="#CCCCCC">android or both</font>

357
00:16:01,920 --> 00:16:08,309
all of these are<font color="#E5E5E5"> sandbox</font><font color="#CCCCCC"> Abel has</font>

358
00:16:04,949 --> 00:16:11,069
<font color="#CCCCCC">suricata</font><font color="#E5E5E5"> snort</font><font color="#CCCCCC"> Moloch integration</font><font color="#E5E5E5"> SSL</font>

359
00:16:08,309 --> 00:16:13,199
decryption<font color="#E5E5E5"> VPN support so if you need to</font>

360
00:16:11,069 --> 00:16:15,329
go from a different specific country or

361
00:16:13,199 --> 00:16:19,019
hide your traffic you can go from<font color="#CCCCCC"> a VPN</font>

362
00:16:15,329 --> 00:16:22,589
<font color="#CCCCCC">64-bit analysis and the new version of</font>

363
00:16:19,019 --> 00:16:24,899
<font color="#E5E5E5">cuckoo is awesome so what if you're what</font>

364
00:16:22,589 --> 00:16:26,339
if<font color="#CCCCCC"> you're malware is a</font><font color="#E5E5E5"> vm aware so</font>

365
00:16:24,899 --> 00:16:29,639
there's two things that you can do to

366
00:16:26,339 --> 00:16:33,569
prevent<font color="#CCCCCC"> or to</font><font color="#E5E5E5"> protect yourself or help</font>

367
00:16:29,639 --> 00:16:35,910
yourself a<font color="#CCCCCC"> analyzed vmware malware so</font>

368
00:16:33,569 --> 00:16:39,839
<font color="#E5E5E5">one is paranoid fish so paranoid fish</font>

369
00:16:35,910 --> 00:16:42,899
takes the perspective of figuring out

370
00:16:39,839 --> 00:16:45,600
what malware in the wild uses to detect

371
00:16:42,899 --> 00:16:48,269
whether it's being debugged<font color="#CCCCCC"> whether it's</font>

372
00:16:45,600 --> 00:16:51,329
in a vm<font color="#E5E5E5"> whether it's being it you know</font>

373
00:16:48,269 --> 00:16:52,980
whether it's in a sandbox and so what it

374
00:16:51,329 --> 00:16:54,989
will do is it has all these

375
00:16:52,980 --> 00:16:57,689
<font color="#CCCCCC">operationalize</font><font color="#E5E5E5"> in an executable that you</font>

376
00:16:54,990 --> 00:17:00,839
run through your sandbox and<font color="#E5E5E5"> then it</font>

377
00:16:57,689 --> 00:17:01,920
<font color="#E5E5E5">will tell you</font><font color="#CCCCCC"> i found x</font><font color="#E5E5E5"> y&z and then</font>

378
00:17:00,839 --> 00:17:04,919
these are the things that you need to

379
00:17:01,920 --> 00:17:06,480
correct to improve your sandbox<font color="#CCCCCC"> vm cloak</font>

380
00:17:04,919 --> 00:17:09,659
is another piece of software that's

381
00:17:06,480 --> 00:17:14,010
actually authored by one of the authors

382
00:17:09,659 --> 00:17:15,539
of<font color="#CCCCCC"> cuckoo sandbox and what it does is it</font>

383
00:17:14,010 --> 00:17:17,579
takes a different perspective what it

384
00:17:15,539 --> 00:17:21,359
does is it actually<font color="#E5E5E5"> uh you know</font>

385
00:17:17,579 --> 00:17:24,359
automatically builds your vm and it also

386
00:17:21,359 --> 00:17:26,369
obvious<font color="#E5E5E5"> gates all the things that</font>

387
00:17:24,359 --> 00:17:28,799
something like paranoid fish or malware

388
00:17:26,369 --> 00:17:32,639
<font color="#CCCCCC">will look for to find out if it's in a</font>

389
00:17:28,799 --> 00:17:34,500
vm<font color="#E5E5E5"> and so it creates these automated vm</font>

390
00:17:32,639 --> 00:17:34,928
that you can use with<font color="#CCCCCC"> coup that are</font>

391
00:17:34,500 --> 00:17:37,389
pretty

392
00:17:34,929 --> 00:17:40,539
acted from many of the anti analysis

393
00:17:37,389 --> 00:17:44,469
techniques<font color="#E5E5E5"> so</font><font color="#CCCCCC"> cuckoo has a number of</font>

394
00:17:40,539 --> 00:17:47,289
different outputs<font color="#E5E5E5"> HTML</font><font color="#CCCCCC"> json baba so it</font>

395
00:17:44,470 --> 00:17:49,360
has<font color="#E5E5E5"> drop files and you want to you know</font>

396
00:17:47,289 --> 00:17:51,908
if there's a drop file<font color="#CCCCCC"> often you want to</font>

397
00:17:49,360 --> 00:17:55,178
<font color="#CCCCCC">resend box that drop file</font><font color="#E5E5E5"> it will</font>

398
00:17:51,909 --> 00:17:56,470
produce<font color="#E5E5E5"> pcap which you can analyze with</font>

399
00:17:55,179 --> 00:17:58,929
the software that<font color="#CCCCCC"> i'm going to talk</font>

400
00:17:56,470 --> 00:18:01,840
about in just a moment and then<font color="#E5E5E5"> memory</font>

401
00:17:58,929 --> 00:18:05,440
images but there's a<font color="#CCCCCC"> nuance</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> coos</font>

402
00:18:01,840 --> 00:18:08,199
memory image that it produces<font color="#CCCCCC"> so it uses</font>

403
00:18:05,440 --> 00:18:11,200
techniques that basically dirty the

404
00:18:08,200 --> 00:18:14,019
memory image so<font color="#E5E5E5"> the memory image that</font>

405
00:18:11,200 --> 00:18:17,409
<font color="#CCCCCC">coo produces is good for coos own</font>

406
00:18:14,019 --> 00:18:20,740
analysis<font color="#E5E5E5"> of it but</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> suggest that you</font>

407
00:18:17,409 --> 00:18:23,350
need to create a clean memory image to

408
00:18:20,740 --> 00:18:26,289
use volatility on it separately from<font color="#CCCCCC"> ku</font>

409
00:18:23,350 --> 00:18:29,199
and<font color="#CCCCCC"> it also produces visited URLs that</font>

410
00:18:26,289 --> 00:18:32,408
<font color="#CCCCCC">you would want to</font><font color="#E5E5E5"> look at with</font><font color="#CCCCCC"> thug</font>

411
00:18:29,200 --> 00:18:34,240
so let's look at<font color="#E5E5E5"> Thug thug is a low</font>

412
00:18:32,409 --> 00:18:36,940
interaction<font color="#E5E5E5"> honey client and what is</font>

413
00:18:34,240 --> 00:18:40,389
that<font color="#E5E5E5"> it pretends to be a browser is</font>

414
00:18:36,940 --> 00:18:42,820
triggered by a drive-by download or on

415
00:18:40,389 --> 00:18:46,629
<font color="#E5E5E5">you know it you would feed a URL that</font>

416
00:18:42,820 --> 00:18:49,809
has just a malware payload<font color="#CCCCCC"> uh</font><font color="#E5E5E5"> download</font>

417
00:18:46,629 --> 00:18:52,269
<font color="#E5E5E5">and the goal is to capture the payload</font>

418
00:18:49,809 --> 00:18:55,690
<font color="#CCCCCC">so that you can</font><font color="#E5E5E5"> analyze it</font><font color="#CCCCCC"> gives me</font>

419
00:18:52,269 --> 00:18:57,730
analyze it further<font color="#E5E5E5"> so thug is a wolf in</font>

420
00:18:55,690 --> 00:19:00,129
sheep's clothing because it is entirely

421
00:18:57,730 --> 00:19:03,399
written in<font color="#CCCCCC"> python and</font><font color="#E5E5E5"> it basically</font>

422
00:19:00,129 --> 00:19:03,850
pretends to be any type of browser you'd

423
00:19:03,399 --> 00:19:07,479
like

424
00:19:03,850 --> 00:19:11,110
via<font color="#CCCCCC"> user-agent</font><font color="#E5E5E5"> strings</font><font color="#CCCCCC"> and it also feeds</font>

425
00:19:07,480 --> 00:19:13,480
<font color="#CCCCCC">are you know it has a v8 as the</font>

426
00:19:11,110 --> 00:19:16,508
<font color="#CCCCCC">JavaScript engine so it will actually</font>

427
00:19:13,480 --> 00:19:18,879
feed the the drive-by download the

428
00:19:16,509 --> 00:19:23,379
correct version<font color="#E5E5E5"> and you know that you've</font>

429
00:19:18,879 --> 00:19:26,709
<font color="#E5E5E5">that you've told it</font><font color="#CCCCCC"> of java</font><font color="#E5E5E5"> PDF flash</font>

430
00:19:23,379 --> 00:19:30,549
etc and so it pretends to be the version

431
00:19:26,710 --> 00:19:34,360
of<font color="#CCCCCC"> Java</font><font color="#E5E5E5"> or whatever that that drive-by</font>

432
00:19:30,549 --> 00:19:36,220
wants to infect you with<font color="#E5E5E5"> so there are a</font>

433
00:19:34,360 --> 00:19:38,918
number of available user agents and

434
00:19:36,220 --> 00:19:43,659
ranges from windows it includes you<font color="#E5E5E5"> know</font>

435
00:19:38,919 --> 00:19:45,820
<font color="#CCCCCC">android devices</font><font color="#E5E5E5"> iOS</font><font color="#CCCCCC"> iPads and so you</font>

436
00:19:43,659 --> 00:19:47,890
know it has a<font color="#E5E5E5"> a wide range of things</font>

437
00:19:45,820 --> 00:19:51,340
that you can pretend to be

438
00:19:47,890 --> 00:19:53,710
<font color="#E5E5E5">so that the output of thug it has</font>

439
00:19:51,340 --> 00:19:55,929
<font color="#E5E5E5">payload files and that's like the you</font>

440
00:19:53,710 --> 00:19:58,030
know that that's the the gold<font color="#E5E5E5"> that</font>

441
00:19:55,930 --> 00:20:00,640
<font color="#E5E5E5">you're getting out of this and you would</font>

442
00:19:58,030 --> 00:20:02,260
use<font color="#CCCCCC"> cout to then look at those</font><font color="#E5E5E5"> payload</font>

443
00:20:00,640 --> 00:20:04,240
files and execute them

444
00:20:02,260 --> 00:20:06,760
it has other content files<font color="#CCCCCC"> that</font><font color="#E5E5E5"> shows</font>

445
00:20:04,240 --> 00:20:10,270
the visit<font color="#CCCCCC"> URLs</font><font color="#E5E5E5"> has a number of different</font>

446
00:20:06,760 --> 00:20:15,370
<font color="#E5E5E5">output formats and it has its own native</font>

447
00:20:10,270 --> 00:20:17,980
<font color="#E5E5E5">output format so now this is like my</font>

448
00:20:15,370 --> 00:20:21,429
<font color="#E5E5E5">honestly is my favorite part of this</font>

449
00:20:17,980 --> 00:20:23,800
talk because<font color="#CCCCCC"> i love bro i know</font><font color="#E5E5E5"> that many</font>

450
00:20:21,430 --> 00:20:25,540
of you love bro because you do<font color="#E5E5E5"> use it as</font>

451
00:20:23,800 --> 00:20:28,659
a network security monitoring tool but

452
00:20:25,540 --> 00:20:31,000
if I may<font color="#E5E5E5"> I would love to to convert</font><font color="#CCCCCC"> you</font>

453
00:20:28,660 --> 00:20:33,700
<font color="#CCCCCC">ended loving it as a malware analysis</font>

454
00:20:31,000 --> 00:20:37,540
tool<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that the difference here is that</font>

455
00:20:33,700 --> 00:20:39,130
the bro that you would use in<font color="#E5E5E5"> in network</font>

456
00:20:37,540 --> 00:20:42,129
security monitoring you're looking at a

457
00:20:39,130 --> 00:20:44,020
large amount of traffic for<font color="#CCCCCC"> you're</font>

458
00:20:42,130 --> 00:20:46,270
looking for bad things in a large amount

459
00:20:44,020 --> 00:20:48,280
of traffic<font color="#CCCCCC"> i'm actually executing a</font>

460
00:20:46,270 --> 00:20:50,350
piece of malware and only looking at the

461
00:20:48,280 --> 00:20:55,420
traffic that piece of<font color="#CCCCCC"> network</font><font color="#E5E5E5"> produces</font>

462
00:20:50,350 --> 00:20:58,090
so<font color="#CCCCCC"> bro can</font><font color="#E5E5E5"> do two types of packet</font>

463
00:20:55,420 --> 00:21:00,250
capture it could do life<font color="#E5E5E5"> live packet</font>

464
00:20:58,090 --> 00:21:03,010
capture it can also look at recorded

465
00:21:00,250 --> 00:21:05,440
packet capture which is a pcap<font color="#CCCCCC"> so</font><font color="#E5E5E5"> a pcap</font>

466
00:21:03,010 --> 00:21:09,400
is a recording of network traffic from

467
00:21:05,440 --> 00:21:11,620
two points in time<font color="#E5E5E5"> bro is made up of a</font>

468
00:21:09,400 --> 00:21:14,530
number of scripts<font color="#CCCCCC"> it allows you to write</font>

469
00:21:11,620 --> 00:21:17,560
your own scripts if you want but by the

470
00:21:14,530 --> 00:21:19,660
way the talk that<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> giving here</font><font color="#CCCCCC"> i'm</font>

471
00:21:17,560 --> 00:21:21,250
<font color="#E5E5E5">only using the the scripts that are</font>

472
00:21:19,660 --> 00:21:25,210
built into bro

473
00:21:21,250 --> 00:21:31,300
so I want to take a little exercise here

474
00:21:25,210 --> 00:21:34,750
and<font color="#E5E5E5"> look at what can I learn from a pcap</font>

475
00:21:31,300 --> 00:21:37,480
only<font color="#CCCCCC"> and so I kind of conceptualize</font><font color="#E5E5E5"> this</font>

476
00:21:34,750 --> 00:21:39,460
as having the malware in a different

477
00:21:37,480 --> 00:21:41,710
room and I can't look at the malware

478
00:21:39,460 --> 00:21:44,650
file itself<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I can kind of listen to</font>

479
00:21:41,710 --> 00:21:47,530
what it's doing and so what can I learn

480
00:21:44,650 --> 00:21:48,790
from pcap only and this is the<font color="#CCCCCC"> sha-1</font><font color="#E5E5E5"> of</font>

481
00:21:47,530 --> 00:21:49,750
what we're going to look at and that's

482
00:21:48,790 --> 00:21:52,540
where<font color="#CCCCCC"> i got</font><font color="#E5E5E5"> it</font>

483
00:21:49,750 --> 00:21:55,810
hybrid analysis<font color="#E5E5E5"> good friends of ours and</font>

484
00:21:52,540 --> 00:21:59,050
<font color="#E5E5E5">so you can download this piece of mail</font>

485
00:21:55,810 --> 00:21:59,379
your<font color="#E5E5E5"> malware yourself and you can you</font>

486
00:21:59,050 --> 00:22:02,230
know

487
00:21:59,380 --> 00:22:05,740
<font color="#CCCCCC">a look at what I've done and</font><font color="#E5E5E5"> and</font>

488
00:22:02,230 --> 00:22:08,740
validated<font color="#CCCCCC"> so first thing you want to</font>

489
00:22:05,740 --> 00:22:10,780
look at is the<font color="#CCCCCC"> conlogue so this is a log</font>

490
00:22:08,740 --> 00:22:13,600
of all the connections that are made

491
00:22:10,780 --> 00:22:15,820
that bro has observed in that<font color="#E5E5E5"> pcap</font><font color="#CCCCCC"> so</font>

492
00:22:13,600 --> 00:22:18,010
there's a variety of things going on

493
00:22:15,820 --> 00:22:20,320
here so<font color="#CCCCCC"> i kind of want to split this out</font>

494
00:22:18,010 --> 00:22:22,900
into different categories<font color="#E5E5E5"> and so the</font>

495
00:22:20,320 --> 00:22:24,550
first category is the garbage<font color="#E5E5E5"> so the</font>

496
00:22:22,900 --> 00:22:27,190
<font color="#CCCCCC">garbage is stuff that</font><font color="#E5E5E5"> you don't want to</font>

497
00:22:24,550 --> 00:22:29,740
care about this is stuff that is<font color="#E5E5E5"> uh you</font>

498
00:22:27,190 --> 00:22:31,780
know benign traffic<font color="#E5E5E5"> your operating</font>

499
00:22:29,740 --> 00:22:35,200
system is producing<font color="#CCCCCC"> so we throw away</font>

500
00:22:31,780 --> 00:22:38,080
<font color="#E5E5E5">this stuff then we have</font><font color="#CCCCCC"> DNS traffic so</font>

501
00:22:35,200 --> 00:22:39,340
this is this is very good rich data so

502
00:22:38,080 --> 00:22:42,520
we want to look at<font color="#E5E5E5"> dns</font><font color="#CCCCCC"> resolution</font>

503
00:22:39,340 --> 00:22:45,159
<font color="#CCCCCC">because</font><font color="#E5E5E5"> the malware asking for the IP</font>

504
00:22:42,520 --> 00:22:50,770
address of the domain name that<font color="#E5E5E5"> it's</font>

505
00:22:45,160 --> 00:22:53,650
reaching out to these are HTTP requests

506
00:22:50,770 --> 00:22:56,860
and so this is something going on<font color="#CCCCCC"> via</font>

507
00:22:53,650 --> 00:22:59,410
<font color="#CCCCCC">HTTP</font><font color="#E5E5E5"> will look into what that is and</font>

508
00:22:56,860 --> 00:23:01,780
then these<font color="#CCCCCC"> where the service is a dash i</font>

509
00:22:59,410 --> 00:23:04,990
like<font color="#E5E5E5"> to call this the WTF traffic</font><font color="#CCCCCC"> this</font>

510
00:23:01,780 --> 00:23:07,720
<font color="#E5E5E5">is the stuff that is definitely see to</font>

511
00:23:04,990 --> 00:23:10,120
<font color="#E5E5E5">command</font><font color="#CCCCCC"> control traffic because it</font><font color="#E5E5E5"> bro</font>

512
00:23:07,720 --> 00:23:14,860
is very smart and if<font color="#CCCCCC"> bro doesn't know</font>

513
00:23:10,120 --> 00:23:18,669
what the service is probably bad<font color="#E5E5E5"> and so</font>

514
00:23:14,860 --> 00:23:20,409
by the way<font color="#E5E5E5"> this is a word document so if</font>

515
00:23:18,670 --> 00:23:23,860
your word document is reaching out to

516
00:23:20,410 --> 00:23:31,030
the<font color="#CCCCCC"> internet and making</font><font color="#E5E5E5"> queries on HTTP</font>

517
00:23:23,860 --> 00:23:33,580
<font color="#E5E5E5">then your macaroni is infected</font><font color="#CCCCCC"> so let's</font>

518
00:23:31,030 --> 00:23:36,580
<font color="#E5E5E5">look at the</font><font color="#CCCCCC"> dns log first</font><font color="#E5E5E5"> and so like i</font>

519
00:23:33,580 --> 00:23:39,669
said earlier<font color="#CCCCCC"> bros output is made up of a</font>

520
00:23:36,580 --> 00:23:42,760
number of<font color="#E5E5E5"> text-based logs and so this is</font>

521
00:23:39,670 --> 00:23:46,330
one and the the incantation that<font color="#CCCCCC"> I have</font>

522
00:23:42,760 --> 00:23:49,000
the top arm is and<font color="#CCCCCC"> I but these are all</font>

523
00:23:46,330 --> 00:23:51,280
going to be published in my github which

524
00:23:49,000 --> 00:23:55,450
<font color="#E5E5E5">you all show you the link for a moment</font>

525
00:23:51,280 --> 00:23:58,030
<font color="#E5E5E5">but these incantations will not</font><font color="#CCCCCC"> boil</font>

526
00:23:55,450 --> 00:24:00,970
<font color="#E5E5E5">down the brow logs to just what you want</font>

527
00:23:58,030 --> 00:24:05,110
<font color="#E5E5E5">and so here we have a number of</font>

528
00:24:00,970 --> 00:24:06,820
different<font color="#E5E5E5"> dns queries and so this again</font>

529
00:24:05,110 --> 00:24:09,580
this is like the the good traffic

530
00:24:06,820 --> 00:24:11,299
<font color="#E5E5E5">obviously reaching out</font><font color="#CCCCCC"> to google google</font>

531
00:24:09,580 --> 00:24:15,439
<font color="#CCCCCC">is probably not</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> c2</font>

532
00:24:11,299 --> 00:24:17,658
microsoft also known as<font color="#E5E5E5"> c2 but here we</font>

533
00:24:15,440 --> 00:24:19,429
have traffic that we want to analyze so

534
00:24:17,659 --> 00:24:20,989
these are some indicators that we want

535
00:24:19,429 --> 00:24:23,809
to kind of put in our back pocket and

536
00:24:20,989 --> 00:24:25,399
think about<font color="#E5E5E5"> and also you know thinking</font>

537
00:24:23,809 --> 00:24:26,869
about this from the automation

538
00:24:25,399 --> 00:24:29,119
perspective these are the things that

539
00:24:26,869 --> 00:24:34,220
you want to kind of set aside when

540
00:24:29,119 --> 00:24:36,139
you're automating things so<font color="#E5E5E5"> I and i will</font>

541
00:24:34,220 --> 00:24:39,080
not name<font color="#E5E5E5"> names but there are certain</font>

542
00:24:36,139 --> 00:24:41,449
<font color="#E5E5E5">nonprofit organizations that changed</font>

543
00:24:39,080 --> 00:24:44,570
their tune and now sell what they were

544
00:24:41,450 --> 00:24:47,720
giving away in the past so<font color="#CCCCCC"> I'm going to</font>

545
00:24:44,570 --> 00:24:52,009
give<font color="#E5E5E5"> you a way to do poor man's</font><font color="#CCCCCC"> dns</font><font color="#E5E5E5"> the</font>

546
00:24:47,720 --> 00:24:53,629
<font color="#CCCCCC">PDS</font><font color="#E5E5E5"> so passive DNS is what domain names</font>

547
00:24:52,009 --> 00:25:00,889
have been resolved to a particular IP

548
00:24:53,629 --> 00:25:06,320
address<font color="#E5E5E5"> and so this is a you know the</font><font color="#CCCCCC"> m1</font>

549
00:25:00,889 --> 00:25:10,850
<font color="#CCCCCC">sorry</font><font color="#E5E5E5"> make this a little easier to see</font>

550
00:25:06,320 --> 00:25:12,710
so this is IP on 56 you<font color="#E5E5E5"> blah blah and</font><font color="#CCCCCC"> I</font>

551
00:25:10,850 --> 00:25:15,529
you<font color="#E5E5E5"> know there's the the word</font><font color="#CCCCCC"> Google</font>

552
00:25:12,710 --> 00:25:19,820
dork<font color="#CCCCCC"> but this is actually a big dork</font><font color="#E5E5E5"> so</font>

553
00:25:15,529 --> 00:25:22,999
<font color="#CCCCCC">Bing</font><font color="#E5E5E5"> you can use to find everything that</font>

554
00:25:19,820 --> 00:25:25,100
being has seen that is on this

555
00:25:22,999 --> 00:25:28,759
particular IP address so this is poor

556
00:25:25,100 --> 00:25:31,580
<font color="#E5E5E5">man's</font><font color="#CCCCCC"> p dns so i can see that many many</font>

557
00:25:28,759 --> 00:25:33,320
domain names have resolved during things

558
00:25:31,580 --> 00:25:36,859
you know crawling history to this

559
00:25:33,320 --> 00:25:39,590
particular IP address<font color="#E5E5E5"> so this leads me</font>

560
00:25:36,859 --> 00:25:42,678
to believe that this is a compromised IP

561
00:25:39,590 --> 00:25:45,019
address<font color="#E5E5E5"> so let's look at the</font><font color="#CCCCCC"> Whois data</font>

562
00:25:42,679 --> 00:25:47,929
and so we go<font color="#E5E5E5"> to domaintools on another</font>

563
00:25:45,019 --> 00:25:52,879
<font color="#CCCCCC">to you</font><font color="#E5E5E5"> know site that i really love and</font>

564
00:25:47,929 --> 00:25:56,480
this hooked outdoors<font color="#CCCCCC"> dot-com we can see</font>

565
00:25:52,879 --> 00:25:58,340
the creation date is<font color="#E5E5E5"> 2007 so chances are</font>

566
00:25:56,480 --> 00:26:02,210
malware<font color="#CCCCCC"> see to</font><font color="#E5E5E5"> that are owned by the</font>

567
00:25:58,340 --> 00:26:05,539
adversary are not created in 2007<font color="#CCCCCC"> this</font>

568
00:26:02,210 --> 00:26:09,169
is probably compromised so<font color="#CCCCCC"> I look at the</font>

569
00:26:05,539 --> 00:26:11,119
hut<font color="#E5E5E5"> the site content and you know this</font>

570
00:26:09,169 --> 00:26:13,309
is someone's<font color="#E5E5E5"> I you know fishing lure</font>

571
00:26:11,119 --> 00:26:15,259
<font color="#E5E5E5">site whatever but it's something that's</font>

572
00:26:13,309 --> 00:26:19,549
interesting is<font color="#CCCCCC"> I see that it's got that</font>

573
00:26:15,259 --> 00:26:22,070
little<font color="#CCCCCC"> a fav icon for drupal</font><font color="#E5E5E5"> so I have a</font>

574
00:26:19,549 --> 00:26:24,110
pretty good idea how the adversary got

575
00:26:22,070 --> 00:26:28,580
into this particular website

576
00:26:24,110 --> 00:26:31,040
<font color="#E5E5E5">so let's move on and look at the rest of</font>

577
00:26:28,580 --> 00:26:32,870
the<font color="#CCCCCC"> dns</font><font color="#E5E5E5"> log so we've got the you know</font>

578
00:26:31,040 --> 00:26:35,750
hooked outdoors and then we have this

579
00:26:32,870 --> 00:26:38,419
dent<font color="#E5E5E5"> to</font><font color="#CCCCCC"> bogota</font><font color="#E5E5E5"> dot-com and then s</font><font color="#CCCCCC"> web</font>

580
00:26:35,750 --> 00:26:40,640
<font color="#CCCCCC">comms</font><font color="#E5E5E5"> dot-com and if any of you are you</font>

581
00:26:38,420 --> 00:26:42,650
know hardcore<font color="#CCCCCC"> our analysis or threatened</font>

582
00:26:40,640 --> 00:26:46,429
tell<font color="#E5E5E5"> people you know exactly what we're</font>

583
00:26:42,650 --> 00:26:49,220
looking at here but we will get there<font color="#CCCCCC"> so</font>

584
00:26:46,429 --> 00:26:50,540
we're<font color="#E5E5E5"> going to look at the next IP</font>

585
00:26:49,220 --> 00:26:54,110
address and by the way this is the

586
00:26:50,540 --> 00:26:59,570
<font color="#CCCCCC">didn't know go dot com</font><font color="#E5E5E5"> IP address 77 not</font>

587
00:26:54,110 --> 00:27:02,120
<font color="#E5E5E5">246</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> has no poor man's</font><font color="#CCCCCC"> pns so this is</font>

588
00:26:59,570 --> 00:27:05,000
not shared web server this is a single

589
00:27:02,120 --> 00:27:07,010
IP address<font color="#E5E5E5"> so you know this is something</font>

590
00:27:05,000 --> 00:27:09,200
that you know leads me to think that

591
00:27:07,010 --> 00:27:14,120
there's something more nefarious going

592
00:27:09,200 --> 00:27:16,429
on here<font color="#E5E5E5"> so i look at the</font><font color="#CCCCCC"> Whois data and</font>

593
00:27:14,120 --> 00:27:19,820
<font color="#E5E5E5">lo and behold</font><font color="#CCCCCC"> this was created on the 12</font>

594
00:27:16,429 --> 00:27:22,880
<font color="#E5E5E5">of this month and then we've got a a</font>

595
00:27:19,820 --> 00:27:27,049
registered email address where we can

596
00:27:22,880 --> 00:27:29,510
actually dig into what this email

597
00:27:27,049 --> 00:27:34,580
address is<font color="#E5E5E5"> and and what's going on here</font>

598
00:27:29,510 --> 00:27:38,210
but this registers<font color="#E5E5E5"> biz CN</font><font color="#CCCCCC"> china and you</font>

599
00:27:34,580 --> 00:27:41,360
know that<font color="#E5E5E5"> we've got polish</font><font color="#CCCCCC"> uh you know I</font>

600
00:27:38,210 --> 00:27:43,610
<font color="#CCCCCC">I don't</font><font color="#E5E5E5"> mean to be you know the singling</font>

601
00:27:41,360 --> 00:27:47,449
out anyone but<font color="#CCCCCC"> East Europe is you know a</font>

602
00:27:43,610 --> 00:27:49,040
font of malware<font color="#CCCCCC"> so we're looking at</font>

603
00:27:47,450 --> 00:27:53,630
something that is probably a little bit

604
00:27:49,040 --> 00:27:57,590
more suspicious so<font color="#E5E5E5"> I look at poor man's</font>

605
00:27:53,630 --> 00:28:01,820
reverse who is<font color="#E5E5E5"> and so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> googled the</font>

606
00:27:57,590 --> 00:28:04,040
email address and so<font color="#E5E5E5"> lo and behold like</font>

607
00:28:01,820 --> 00:28:07,760
you know the top<font color="#CCCCCC"> three here are from</font>

608
00:28:04,040 --> 00:28:09,889
<font color="#E5E5E5">threat crowd threat minor and scam scam</font>

609
00:28:07,760 --> 00:28:12,830
<font color="#CCCCCC">Warner's dot-com so I think there's</font>

610
00:28:09,890 --> 00:28:15,350
definitely<font color="#E5E5E5"> something going on here so</font><font color="#CCCCCC"> i</font>

611
00:28:12,830 --> 00:28:16,460
look at the site content and there's

612
00:28:15,350 --> 00:28:19,100
nothing there

613
00:28:16,460 --> 00:28:23,150
imagine that you know<font color="#CCCCCC"> your c2 why why</font>

614
00:28:19,100 --> 00:28:25,459
put content on your<font color="#CCCCCC"> c2 so let's go back</font>

615
00:28:23,150 --> 00:28:27,950
to the<font color="#CCCCCC"> dns log and let's move to the</font>

616
00:28:25,460 --> 00:28:29,480
next part and look at<font color="#CCCCCC"> s</font><font color="#E5E5E5"> web</font><font color="#CCCCCC"> comms</font>

617
00:28:27,950 --> 00:28:31,669
<font color="#CCCCCC">dot-com this is where it gets very</font>

618
00:28:29,480 --> 00:28:36,950
interesting<font color="#E5E5E5"> and you'll see there were</font>

619
00:28:31,669 --> 00:28:39,950
two requests for resolution of<font color="#E5E5E5"> s web com</font>

620
00:28:36,950 --> 00:28:41,899
<font color="#E5E5E5">and both of them and I know this looks a</font>

621
00:28:39,950 --> 00:28:44,480
little bit like you know<font color="#E5E5E5"> number salad</font>

622
00:28:41,899 --> 00:28:46,518
for you<font color="#CCCCCC"> but these are the same</font><font color="#E5E5E5"> three IP</font>

623
00:28:44,480 --> 00:28:50,389
addresses and<font color="#CCCCCC"> they're just rotated</font><font color="#E5E5E5"> so</font>

624
00:28:46,519 --> 00:28:53,570
you know this looks like this looks like

625
00:28:50,389 --> 00:28:55,820
something fairly nefarious<font color="#E5E5E5"> or this looks</font>

626
00:28:53,570 --> 00:28:57,289
<font color="#E5E5E5">like a legitimate website</font><font color="#CCCCCC"> you know there</font>

627
00:28:55,820 --> 00:29:00,620
are legitimate websites that want to

628
00:28:57,289 --> 00:29:04,490
have no backup IP addresses and then do

629
00:29:00,620 --> 00:29:07,789
round robin DNS among them<font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> gonna</font>

630
00:29:04,490 --> 00:29:11,389
<font color="#E5E5E5">go with it not being legitimate so we</font>

631
00:29:07,789 --> 00:29:14,090
look at the the<font color="#E5E5E5"> who is data and the</font>

632
00:29:11,389 --> 00:29:16,340
creation date is on the<font color="#E5E5E5"> sixteenth of</font>

633
00:29:14,090 --> 00:29:19,039
this month<font color="#CCCCCC"> so by the way things that are</font>

634
00:29:16,340 --> 00:29:20,899
created within the past month<font color="#E5E5E5"> are things</font>

635
00:29:19,039 --> 00:29:25,730
that are suspicious to me

636
00:29:20,899 --> 00:29:28,639
<font color="#E5E5E5">also the</font><font color="#CCCCCC"> Santa @s</font><font color="#E5E5E5"> webcams</font><font color="#CCCCCC"> dot-com the</font>

637
00:29:25,730 --> 00:29:30,320
<font color="#E5E5E5">registered address</font><font color="#CCCCCC"> I will</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> kind</font>

638
00:29:28,639 --> 00:29:33,709
<font color="#E5E5E5">of put that</font><font color="#CCCCCC"> in my back pocket but now</font>

639
00:29:30,320 --> 00:29:36,980
<font color="#E5E5E5">I'm thinking because this is looking</font>

640
00:29:33,710 --> 00:29:38,929
like something that is not legitimate

641
00:29:36,980 --> 00:29:40,760
<font color="#CCCCCC">I want to look at the</font><font color="#E5E5E5"> nameserver so</font><font color="#CCCCCC"> I</font>

642
00:29:38,929 --> 00:29:43,519
want to keep<font color="#E5E5E5"> those nameservers in my</font>

643
00:29:40,760 --> 00:29:45,408
back pocket and you know there are and

644
00:29:43,519 --> 00:29:46,880
by the way like<font color="#CCCCCC"> I'm saying there</font><font color="#E5E5E5"> you</font>

645
00:29:45,409 --> 00:29:50,059
know everything<font color="#CCCCCC"> i'm talking about is</font>

646
00:29:46,880 --> 00:29:52,940
free access<font color="#E5E5E5"> but there are services out</font>

647
00:29:50,059 --> 00:29:56,600
there that can find domains that<font color="#E5E5E5"> were</font>

648
00:29:52,940 --> 00:29:58,940
<font color="#CCCCCC">respond that are from this particular</font>

649
00:29:56,600 --> 00:30:00,709
<font color="#E5E5E5">dns service so i won't go into those but</font>

650
00:29:58,940 --> 00:30:03,380
you know if you want to look at reverse

651
00:30:00,710 --> 00:30:06,200
<font color="#E5E5E5">nameserver</font><font color="#CCCCCC"> probably there's some nasty</font>

652
00:30:03,380 --> 00:30:10,940
stuff<font color="#E5E5E5"> comes out of this triumph</font><font color="#CCCCCC"> verde</font>

653
00:30:06,200 --> 00:30:12,649
<font color="#CCCCCC">dot-com so we've got</font><font color="#E5E5E5"> uh you know we've</font>

654
00:30:10,940 --> 00:30:15,860
got a number of things that<font color="#CCCCCC"> I want to do</font>

655
00:30:12,649 --> 00:30:17,809
<font color="#E5E5E5">but one thing is</font><font color="#CCCCCC"> P</font><font color="#E5E5E5"> dns and like</font><font color="#CCCCCC"> I said</font>

656
00:30:15,860 --> 00:30:19,729
free services you can go to our website

657
00:30:17,809 --> 00:30:22,460
this is all<font color="#CCCCCC"> freeze in our common</font>

658
00:30:19,730 --> 00:30:27,950
community so I loaded this IP address in

659
00:30:22,460 --> 00:30:34,490
you know our<font color="#CCCCCC"> PDAs</font><font color="#E5E5E5"> service and</font><font color="#CCCCCC"> I find</font>

660
00:30:27,950 --> 00:30:38,240
down here<font color="#E5E5E5"> all of these are you know July</font>

661
00:30:34,490 --> 00:30:41,179
thirteenth 2016<font color="#CCCCCC"> July sixteenth</font><font color="#E5E5E5"> 2016 and</font>

662
00:30:38,240 --> 00:30:44,480
all these are kind of you know<font color="#CCCCCC"> a</font><font color="#E5E5E5"> red</font>

663
00:30:41,179 --> 00:30:48,110
<font color="#E5E5E5">flag ish domain names like</font><font color="#CCCCCC"> EJ</font>

664
00:30:44,480 --> 00:30:52,730
<font color="#CCCCCC">d qz KD sounds like a domain generation</font>

665
00:30:48,110 --> 00:30:55,399
algorithm to me also<font color="#CCCCCC"> ln x y blah</font><font color="#E5E5E5"> blah</font>

666
00:30:52,730 --> 00:31:00,740
<font color="#E5E5E5">and then they were registered July</font>

667
00:30:55,400 --> 00:31:05,450
thirteenth<font color="#CCCCCC"> july 1613 13th 1917 1914 1913</font>

668
00:31:00,740 --> 00:31:10,669
all<font color="#E5E5E5"> this is bad</font><font color="#CCCCCC"> you know just died I i</font>

669
00:31:05,450 --> 00:31:12,919
would flag<font color="#E5E5E5"> all of this so let's move on</font>

670
00:31:10,669 --> 00:31:16,610
to the next like stage of bro so you're

671
00:31:12,919 --> 00:31:18,260
looking at<font color="#CCCCCC"> also</font><font color="#E5E5E5"> the httpd log and so bro</font>

672
00:31:16,610 --> 00:31:20,689
will not only show you the connections

673
00:31:18,260 --> 00:31:24,379
<font color="#CCCCCC">it</font><font color="#E5E5E5"> will show you deeper into the network</font>

674
00:31:20,690 --> 00:31:27,410
stack in<font color="#E5E5E5"> show you are you know HTTP</font>

675
00:31:24,380 --> 00:31:31,040
connections and so we've got this set of

676
00:31:27,410 --> 00:31:35,210
HTTP connections and so we're looking

677
00:31:31,040 --> 00:31:40,399
here at<font color="#E5E5E5"> 77 blah</font><font color="#CCCCCC"> blah</font><font color="#E5E5E5"> at didn't</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> go</font>

678
00:31:35,210 --> 00:31:43,850
<font color="#E5E5E5">dot com</font><font color="#CCCCCC"> boy gate dot PHP so</font><font color="#E5E5E5"> I being a</font>

679
00:31:40,400 --> 00:31:47,900
<font color="#CCCCCC">rishta file and you know fluent in</font>

680
00:31:43,850 --> 00:31:51,080
<font color="#E5E5E5">Russian</font><font color="#CCCCCC"> I know the words a</font><font color="#E5E5E5"> boy so the</font>

681
00:31:47,900 --> 00:31:53,809
<font color="#CCCCCC">point is a term used in Russia and other</font>

682
00:31:51,080 --> 00:31:56,990
post-soviet<font color="#CCCCCC"> States to describe alcohol</font>

683
00:31:53,809 --> 00:32:00,200
abuse<font color="#E5E5E5"> behavior resulting in two or more</font>

684
00:31:56,990 --> 00:32:02,929
days of continuous drunkenness<font color="#CCCCCC"> so I</font>

685
00:32:00,200 --> 00:32:05,990
would imagine that most of us are on a

686
00:32:02,929 --> 00:32:07,370
<font color="#CCCCCC">support at the moment but this is</font>

687
00:32:05,990 --> 00:32:09,440
something actually put<font color="#E5E5E5"> in your back</font>

688
00:32:07,370 --> 00:32:11,928
pocket and think about because now we

689
00:32:09,440 --> 00:32:16,880
know that the adversary is probably

690
00:32:11,929 --> 00:32:19,850
<font color="#CCCCCC">rissa phone</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> sorry and and by the</font>

691
00:32:16,880 --> 00:32:23,270
<font color="#E5E5E5">way so I'm on some secret squirrel you</font>

692
00:32:19,850 --> 00:32:25,219
know<font color="#E5E5E5"> lists</font><font color="#CCCCCC"> fight club sort of things and</font>

693
00:32:23,270 --> 00:32:27,679
<font color="#CCCCCC">I had to reach out to some friends and</font>

694
00:32:25,220 --> 00:32:30,740
get some more information and so from

695
00:32:27,679 --> 00:32:34,220
people that<font color="#CCCCCC"> I can't cite the</font><font color="#E5E5E5"> poi</font><font color="#CCCCCC"> Kate</font>

696
00:32:30,740 --> 00:32:36,590
that PHP is an indicator of<font color="#CCCCCC"> pony so pony</font>

697
00:32:34,220 --> 00:32:42,440
is a loader module<font color="#E5E5E5"> and a password</font>

698
00:32:36,590 --> 00:32:45,379
stealer and<font color="#CCCCCC"> at</font><font color="#E5E5E5"> of our family again</font><font color="#CCCCCC"> let's</font>

699
00:32:42,440 --> 00:32:46,970
look at the next piece of httpd logs and

700
00:32:45,380 --> 00:32:50,210
<font color="#CCCCCC">I know</font><font color="#E5E5E5"> where we're skipping over that</font>

701
00:32:46,970 --> 00:32:51,980
<font color="#E5E5E5">install.exe and</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> that's really cool</font>

702
00:32:50,210 --> 00:32:54,770
stuff<font color="#CCCCCC"> will come</font><font color="#E5E5E5"> back to</font><font color="#CCCCCC"> that but so this</font>

703
00:32:51,980 --> 00:32:58,730
<font color="#E5E5E5">is sort of a random string / index dot</font>

704
00:32:54,770 --> 00:33:00,830
PHP and<font color="#E5E5E5"> lo and behold those same secret</font>

705
00:32:58,730 --> 00:33:01,549
<font color="#E5E5E5">squirrel friends of mine say this is</font><font color="#CCCCCC"> my</font>

706
00:33:00,830 --> 00:33:04,790
<font color="#E5E5E5">name</font>

707
00:33:01,549 --> 00:33:06,350
<font color="#E5E5E5">alright so</font><font color="#CCCCCC"> nine Man plus</font><font color="#E5E5E5"> pony</font><font color="#CCCCCC"> we're</font>

708
00:33:04,790 --> 00:33:08,149
<font color="#E5E5E5">going to see this in a moment we're</font>

709
00:33:06,350 --> 00:33:11,330
going to see<font color="#E5E5E5"> where we're actually going</font>

710
00:33:08,150 --> 00:33:13,730
to go from understanding what this is to

711
00:33:11,330 --> 00:33:15,230
finding out kind of not necessarily who

712
00:33:13,730 --> 00:33:18,740
the adversary is but knowing who the

713
00:33:15,230 --> 00:33:20,929
adversary group is so we're<font color="#E5E5E5"> going to</font>

714
00:33:18,740 --> 00:33:26,090
look at these now these are really fun

715
00:33:20,929 --> 00:33:27,710
so<font color="#CCCCCC"> i</font><font color="#E5E5E5"> nst 1.exe are both hooked outdoors</font>

716
00:33:26,090 --> 00:33:29,780
and so remember this is a<font color="#E5E5E5"> compromise</font>

717
00:33:27,710 --> 00:33:32,240
website<font color="#E5E5E5"> and so this is how</font><font color="#CCCCCC"> they're</font>

718
00:33:29,780 --> 00:33:36,620
serving their executables the payloads

719
00:33:32,240 --> 00:33:39,320
and so let's look at the first one so

720
00:33:36,620 --> 00:33:42,080
this is the log from bro called the<font color="#E5E5E5"> PE</font>

721
00:33:39,320 --> 00:33:44,480
log<font color="#CCCCCC"> p log gives you some really inform a</font>

722
00:33:42,080 --> 00:33:47,870
<font color="#E5E5E5">good information so by the way you'll</font>

723
00:33:44,480 --> 00:33:50,720
see here there's the<font color="#E5E5E5"> f8</font><font color="#CCCCCC"> k that first one</font>

724
00:33:47,870 --> 00:33:53,030
this is the awesome thing about<font color="#CCCCCC"> bros it</font>

725
00:33:50,720 --> 00:33:58,130
will allow you to connect log from log

726
00:33:53,030 --> 00:34:02,600
using you<font color="#CCCCCC"> IE u</font><font color="#E5E5E5"> IDs</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> IDs and so that</font><font color="#CCCCCC"> f8</font>

727
00:33:58,130 --> 00:34:07,880
<font color="#CCCCCC">kaid is findable in other logs and I can</font>

728
00:34:02,600 --> 00:34:11,389
grab for that particular uh<font color="#CCCCCC"> uid and I</font>

729
00:34:07,880 --> 00:34:13,490
can see in the<font color="#CCCCCC"> PE log the the</font><font color="#E5E5E5"> line in</font>

730
00:34:11,389 --> 00:34:16,250
that<font color="#CCCCCC"> p</font><font color="#E5E5E5"> log refers to that particular</font>

731
00:34:13,489 --> 00:34:19,549
file<font color="#E5E5E5"> so we can see here it's a windows</font>

732
00:34:16,250 --> 00:34:22,879
GUI<font color="#E5E5E5"> we get a few section names</font><font color="#CCCCCC"> we also</font>

733
00:34:19,550 --> 00:34:25,730
get the compiles the<font color="#CCCCCC"> timestamp</font><font color="#E5E5E5"> so all</font>

734
00:34:22,879 --> 00:34:28,250
very good information<font color="#CCCCCC"> so now let's look</font>

735
00:34:25,730 --> 00:34:30,949
at the files log and so anything that is

736
00:34:28,250 --> 00:34:32,929
a file will be put into the files log

737
00:34:30,949 --> 00:34:35,629
and so<font color="#CCCCCC"> i can</font><font color="#E5E5E5"> if you look</font><font color="#CCCCCC"> at the</font>

738
00:34:32,929 --> 00:34:37,668
incantation those two particular<font color="#E5E5E5"> you</font>

739
00:34:35,629 --> 00:34:40,100
ideas are in there<font color="#E5E5E5"> and so I'm looking at</font>

740
00:34:37,668 --> 00:34:43,100
the<font color="#E5E5E5"> you ideas for this one and</font><font color="#CCCCCC"> I get out</font>

741
00:34:40,100 --> 00:34:45,409
of the files<font color="#E5E5E5"> law get all the</font><font color="#CCCCCC"> file hashes</font>

742
00:34:43,100 --> 00:34:48,830
and the total bytes for the<font color="#E5E5E5"> these files</font>

743
00:34:45,409 --> 00:34:51,020
<font color="#CCCCCC">so this</font><font color="#E5E5E5"> is the point where we kind of</font>

744
00:34:48,830 --> 00:34:53,719
back away from using the tool and we do

745
00:34:51,020 --> 00:34:57,380
some open source intelligence and I've

746
00:34:53,719 --> 00:35:00,259
got you know my name<font color="#CCCCCC"> pony and you know</font>

747
00:34:57,380 --> 00:35:02,510
now when the past<font color="#E5E5E5"> month so</font><font color="#CCCCCC"> I go look</font>

748
00:35:00,260 --> 00:35:05,510
around and see if other people you know

749
00:35:02,510 --> 00:35:08,300
other people that the do what<font color="#CCCCCC"> I do our</font>

750
00:35:05,510 --> 00:35:09,960
talking<font color="#E5E5E5"> about what</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> at and lo</font>

751
00:35:08,300 --> 00:35:13,320
and behold so the man<font color="#CCCCCC"> 1</font>

752
00:35:09,960 --> 00:35:19,470
<font color="#CCCCCC">krypter gang these are variously known</font>

753
00:35:13,320 --> 00:35:21,599
as<font color="#CCCCCC"> fought track of</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> track gang</font><font color="#E5E5E5"> never</font>

754
00:35:19,470 --> 00:35:23,399
quest<font color="#CCCCCC"> you might be familiar with all</font>

755
00:35:21,599 --> 00:35:27,150
them but they they use all of these

756
00:35:23,400 --> 00:35:29,190
things together and so I you know<font color="#E5E5E5"> threat</font>

757
00:35:27,150 --> 00:35:33,060
geek.com<font color="#E5E5E5"> which is fidelis cybersecurity</font>

758
00:35:29,190 --> 00:35:36,780
<font color="#E5E5E5">is blog wrote a really good review of</font>

759
00:35:33,060 --> 00:35:39,330
all of this stuff<font color="#CCCCCC"> so now</font><font color="#E5E5E5"> I have not only</font>

760
00:35:36,780 --> 00:35:40,800
<font color="#E5E5E5">the stuff that</font><font color="#CCCCCC"> I'm looking at and now i</font>

761
00:35:39,330 --> 00:35:43,890
have<font color="#E5E5E5"> some open source intelligence</font><font color="#CCCCCC"> i</font>

762
00:35:40,800 --> 00:35:48,869
compare compare my results<font color="#CCCCCC"> to</font><font color="#E5E5E5"> and by the</font>

763
00:35:43,890 --> 00:35:50,759
<font color="#E5E5E5">way we haven't left a pcap yet</font><font color="#CCCCCC"> so what</font>

764
00:35:48,869 --> 00:35:52,410
<font color="#E5E5E5">can you learn from pcap only so we know</font>

765
00:35:50,760 --> 00:35:55,230
that the<font color="#CCCCCC"> adversaries likely rissa phone</font>

766
00:35:52,410 --> 00:35:57,118
<font color="#CCCCCC">you have an office document generating</font>

767
00:35:55,230 --> 00:36:00,450
network traffic by the way your macaroni

768
00:35:57,119 --> 00:36:03,119
is infected<font color="#CCCCCC"> we have multistage malware</font>

769
00:36:00,450 --> 00:36:05,939
<font color="#E5E5E5">because it has different things that</font>

770
00:36:03,119 --> 00:36:08,880
<font color="#E5E5E5">it's installing one of the payloads we</font>

771
00:36:05,940 --> 00:36:11,940
know now is<font color="#CCCCCC"> pony</font><font color="#E5E5E5"> one of the note</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> of</font>

772
00:36:08,880 --> 00:36:14,339
the<font color="#CCCCCC"> payloads is nine aim-9 name we also</font>

773
00:36:11,940 --> 00:36:15,480
know from looking at the infrastructure

774
00:36:14,339 --> 00:36:17,759
we know that has dedicated

775
00:36:15,480 --> 00:36:21,240
infrastructure and it contains a rogue

776
00:36:17,760 --> 00:36:24,990
DNS server<font color="#CCCCCC"> the dropper uses compromised</font>

777
00:36:21,240 --> 00:36:27,779
or<font color="#CCCCCC"> Drupal websites and you know by doing</font>

778
00:36:24,990 --> 00:36:31,950
<font color="#E5E5E5">a little bit of due diligence</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> found</font>

779
00:36:27,780 --> 00:36:34,290
that the adversary is<font color="#E5E5E5"> man</font><font color="#CCCCCC"> 1 so</font><font color="#E5E5E5"> we've</font>

780
00:36:31,950 --> 00:36:38,970
collected a lot of indicators and all

781
00:36:34,290 --> 00:36:40,980
<font color="#E5E5E5">zoom in on these</font><font color="#CCCCCC"> for you</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> i think i</font>

782
00:36:38,970 --> 00:36:44,160
think<font color="#CCCCCC"> i can so we've got a lot of</font>

783
00:36:40,980 --> 00:36:48,030
indicators<font color="#CCCCCC"> we got a bunch of URLs we and</font>

784
00:36:44,160 --> 00:36:49,049
we have a bunch of<font color="#CCCCCC"> a</font><font color="#E5E5E5"> group that didn't</font>

785
00:36:48,030 --> 00:36:52,109
work<font color="#CCCCCC"> sorry</font>

786
00:36:49,050 --> 00:36:54,180
so we have a bunch of indicators that

787
00:36:52,109 --> 00:36:57,150
<font color="#CCCCCC">we've collected</font><font color="#E5E5E5"> from just the pcap and</font>

788
00:36:54,180 --> 00:36:58,770
this is a very good<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> image</font>

789
00:36:57,150 --> 00:37:00,570
of what the malware is doing without

790
00:36:58,770 --> 00:37:05,190
actually looking at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> malware itself</font>

791
00:37:00,570 --> 00:37:08,580
<font color="#E5E5E5">so of course</font><font color="#CCCCCC"> I I want</font><font color="#E5E5E5"> to help you do</font>

792
00:37:05,190 --> 00:37:10,470
what<font color="#CCCCCC"> I do and so local dot bro is the</font>

793
00:37:08,580 --> 00:37:13,109
configuration file for bro

794
00:37:10,470 --> 00:37:16,000
and so these are<font color="#E5E5E5"> and</font><font color="#CCCCCC"> i spent a lot of</font>

795
00:37:13,109 --> 00:37:18,340
time going over

796
00:37:16,000 --> 00:37:20,500
<font color="#E5E5E5">how to do the best configuration file</font>

797
00:37:18,340 --> 00:37:23,260
possible<font color="#E5E5E5"> form our analysis so this is</font>

798
00:37:20,500 --> 00:37:27,130
here and<font color="#CCCCCC"> I know you know</font><font color="#E5E5E5"> that's a lot of</font>

799
00:37:23,260 --> 00:37:29,830
<font color="#E5E5E5">word salad</font><font color="#CCCCCC"> but there it is</font>

800
00:37:27,130 --> 00:37:34,030
so I<font color="#CCCCCC"> i am working on publishing the</font>

801
00:37:29,830 --> 00:37:36,700
entire system<font color="#E5E5E5"> but some of the components</font>

802
00:37:34,030 --> 00:37:38,650
including my local bro which people

803
00:37:36,700 --> 00:37:43,060
<font color="#E5E5E5">requested because they want to work on</font>

804
00:37:38,650 --> 00:37:46,360
it now<font color="#CCCCCC"> that's available right there</font><font color="#E5E5E5"> so</font>

805
00:37:43,060 --> 00:37:47,980
of<font color="#CCCCCC"> course i am curious</font><font color="#E5E5E5"> about what</font>

806
00:37:46,360 --> 00:37:50,410
actually happened so we're going to

807
00:37:47,980 --> 00:37:52,720
cheat and not necessarily cheap in the

808
00:37:50,410 --> 00:37:54,819
context of an<font color="#CCCCCC"> open-source</font><font color="#E5E5E5"> our lab what</font>

809
00:37:52,720 --> 00:37:58,060
<font color="#CCCCCC">I'm talking about is sending that</font>

810
00:37:54,820 --> 00:38:01,900
particular file over to<font color="#CCCCCC"> KU</font><font color="#E5E5E5"> to see what's</font>

811
00:37:58,060 --> 00:38:04,390
happening there<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so this is the</font>

812
00:38:01,900 --> 00:38:07,360
dropper<font color="#E5E5E5"> and so the droppers cuddlesome</font>

813
00:38:04,390 --> 00:38:11,560
dot exe and it's a<font color="#CCCCCC"> ruck drug rug of</font>

814
00:38:07,360 --> 00:38:15,130
<font color="#E5E5E5">dropper</font><font color="#CCCCCC"> alright which also reinforces</font>

815
00:38:11,560 --> 00:38:18,279
the fact that<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> man</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> so bro output</font>

816
00:38:15,130 --> 00:38:21,430
<font color="#E5E5E5">you have</font><font color="#CCCCCC"> conlogue DSD NS log HTTP blah</font>

817
00:38:18,280 --> 00:38:24,070
<font color="#E5E5E5">blah you get extracted files also you</font>

818
00:38:21,430 --> 00:38:25,390
can change the output to have<font color="#CCCCCC"> json so</font>

819
00:38:24,070 --> 00:38:28,540
that you can consume it with

820
00:38:25,390 --> 00:38:31,450
<font color="#CCCCCC">elasticsearch very easily</font><font color="#E5E5E5"> now we're</font>

821
00:38:28,540 --> 00:38:33,670
going to move to volatility<font color="#E5E5E5"> and</font>

822
00:38:31,450 --> 00:38:37,299
volatility another<font color="#E5E5E5"> favorite tool of mine</font>

823
00:38:33,670 --> 00:38:39,190
very awesome<font color="#CCCCCC"> so what is volatility so</font>

824
00:38:37,300 --> 00:38:42,130
volatility extracts artifacts from

825
00:38:39,190 --> 00:38:44,920
samples of volatile memory

826
00:38:42,130 --> 00:38:46,960
hence<font color="#E5E5E5"> volatility so it gives you an</font>

827
00:38:44,920 --> 00:38:49,750
amazing view into<font color="#E5E5E5"> what the malware is</font>

828
00:38:46,960 --> 00:38:51,310
doing and like<font color="#CCCCCC"> I said where you know</font>

829
00:38:49,750 --> 00:38:52,960
you're holding the cup against the wall

830
00:38:51,310 --> 00:38:54,850
and listening to what the malware is

831
00:38:52,960 --> 00:38:59,140
saying<font color="#E5E5E5"> when you're looking at a pcap</font>

832
00:38:54,850 --> 00:39:01,150
<font color="#E5E5E5">volatility allows you to look at what</font>

833
00:38:59,140 --> 00:39:03,640
the malware is thinking because it's

834
00:39:01,150 --> 00:39:08,440
using memory pages and you're looking at

835
00:39:03,640 --> 00:39:09,910
what it is<font color="#E5E5E5"> safe to memory so as you know</font>

836
00:39:08,440 --> 00:39:13,750
all the major operating<font color="#CCCCCC"> systems</font><font color="#E5E5E5"> support</font>

837
00:39:09,910 --> 00:39:16,149
<font color="#CCCCCC">Windows Mac</font><font color="#E5E5E5"> OS</font><font color="#CCCCCC"> Linux blah blah and then</font>

838
00:39:13,750 --> 00:39:17,590
what<font color="#CCCCCC"> I want to do is kind of lead you</font>

839
00:39:16,150 --> 00:39:20,440
down the same

840
00:39:17,590 --> 00:39:22,450
<font color="#CCCCCC">I</font><font color="#E5E5E5"> mean a process that i did with bro and</font>

841
00:39:20,440 --> 00:39:25,810
look at volatility<font color="#E5E5E5"> in action by the way</font>

842
00:39:22,450 --> 00:39:32,560
if you receive<font color="#E5E5E5"> a file that is a single</font>

843
00:39:25,810 --> 00:39:34,570
letter or number<font color="#CCCCCC"> two exe it's malware so</font>

844
00:39:32,560 --> 00:39:38,350
this<font color="#E5E5E5"> is the strong one you can follow</font>

845
00:39:34,570 --> 00:39:39,970
along again with my analysis<font color="#E5E5E5"> and by the</font>

846
00:39:38,350 --> 00:39:43,299
way<font color="#E5E5E5"> you know one of the things I like to</font>

847
00:39:39,970 --> 00:39:45,910
do is I<font color="#E5E5E5"> when when</font><font color="#CCCCCC"> I look</font><font color="#E5E5E5"> at stuff like</font>

848
00:39:43,300 --> 00:39:48,160
this<font color="#CCCCCC"> i beat my head against a brick wall</font>

849
00:39:45,910 --> 00:39:50,109
trying to figure out when things don't

850
00:39:48,160 --> 00:39:52,330
work so<font color="#CCCCCC"> I don't want you</font><font color="#E5E5E5"> to beat your</font>

851
00:39:50,110 --> 00:39:55,240
head against the same brick wall

852
00:39:52,330 --> 00:39:57,460
so if you use virtualbox<font color="#E5E5E5"> these are the</font>

853
00:39:55,240 --> 00:39:59,470
incantations that you need to use to

854
00:39:57,460 --> 00:40:02,710
dump a memory image from<font color="#E5E5E5"> virtual</font><font color="#CCCCCC"> locks</font>

855
00:39:59,470 --> 00:40:05,379
and have it usable with volatility<font color="#E5E5E5"> these</font>

856
00:40:02,710 --> 00:40:10,480
slides will be published<font color="#E5E5E5"> so you know</font><font color="#CCCCCC"> no</font>

857
00:40:05,380 --> 00:40:12,610
<font color="#E5E5E5">need to to memorize it now so</font><font color="#CCCCCC"> peel PS</font>

858
00:40:10,480 --> 00:40:14,740
<font color="#E5E5E5">list and PS scan or tools that you can</font>

859
00:40:12,610 --> 00:40:18,100
use to look<font color="#E5E5E5"> the processes that are</font>

860
00:40:14,740 --> 00:40:20,290
running in a memory image<font color="#E5E5E5"> and so what I</font>

861
00:40:18,100 --> 00:40:23,110
did was I took a memory image of the

862
00:40:20,290 --> 00:40:25,900
<font color="#CCCCCC">clean</font><font color="#E5E5E5"> vm</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> I compared it to a memory</font>

863
00:40:23,110 --> 00:40:28,270
image of the<font color="#E5E5E5"> vm after the malware had</font>

864
00:40:25,900 --> 00:40:30,820
run<font color="#E5E5E5"> and so there's a there there's a</font>

865
00:40:28,270 --> 00:40:32,920
point here where the top<font color="#E5E5E5"> 10 search</font>

866
00:40:30,820 --> 00:40:34,480
protocol search filter service host

867
00:40:32,920 --> 00:40:37,180
these are things that are naturally

868
00:40:34,480 --> 00:40:40,360
occurring in an operating system but<font color="#CCCCCC"> i</font>

869
00:40:37,180 --> 00:40:42,580
<font color="#CCCCCC">double-clicked on a piece of malware and</font>

870
00:40:40,360 --> 00:40:45,850
it wasn't<font color="#E5E5E5"> internet explorer but now</font>

871
00:40:42,580 --> 00:40:47,200
<font color="#E5E5E5">explored</font><font color="#CCCCCC"> exe is running</font><font color="#E5E5E5"> so something is</font>

872
00:40:45,850 --> 00:40:50,170
going on

873
00:40:47,200 --> 00:40:53,350
so what<font color="#CCCCCC"> I what next thing you want to do</font>

874
00:40:50,170 --> 00:40:55,480
is use mal find which is a<font color="#E5E5E5"> plug-in for</font>

875
00:40:53,350 --> 00:40:57,520
<font color="#CCCCCC">for volatility and all the things that</font>

876
00:40:55,480 --> 00:41:00,550
<font color="#CCCCCC">I'm talking about</font><font color="#E5E5E5"> right now all of these</font>

877
00:40:57,520 --> 00:41:03,070
come with the default standard version

878
00:41:00,550 --> 00:41:05,260
of the software<font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'm looking at</font><font color="#E5E5E5"> mal</font>

879
00:41:03,070 --> 00:41:07,870
fine<font color="#E5E5E5"> and I can find two processes that</font>

880
00:41:05,260 --> 00:41:11,620
<font color="#E5E5E5">mal find is telling me have been</font>

881
00:41:07,870 --> 00:41:16,089
injected with<font color="#CCCCCC"> uh you know</font><font color="#E5E5E5"> the executable</font>

882
00:41:11,620 --> 00:41:18,730
that isn't that thing<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> didn't</font><font color="#E5E5E5"> what</font>

883
00:41:16,090 --> 00:41:20,890
you can do is dump those processes into

884
00:41:18,730 --> 00:41:23,230
a file and then what<font color="#E5E5E5"> I did was</font><font color="#CCCCCC"> I</font>

885
00:41:20,890 --> 00:41:27,009
actually<font color="#E5E5E5"> ran those</font><font color="#CCCCCC"> dump files</font><font color="#E5E5E5"> through</font>

886
00:41:23,230 --> 00:41:29,680
<font color="#CCCCCC">coo</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> i found via</font>

887
00:41:27,010 --> 00:41:32,890
<font color="#CCCCCC">AV scanner results</font><font color="#E5E5E5"> both of these</font>

888
00:41:29,680 --> 00:41:34,899
processes are flagged as malware for

889
00:41:32,890 --> 00:41:37,990
variety of reasons

890
00:41:34,900 --> 00:41:41,560
so the next<font color="#CCCCCC"> thing i want to do is look</font>

891
00:41:37,990 --> 00:41:43,750
at the<font color="#CCCCCC"> Nets cancer Nets</font><font color="#E5E5E5"> can can look at</font>

892
00:41:41,560 --> 00:41:46,120
the memory image and find out what

893
00:41:43,750 --> 00:41:50,980
network connections have been made out

894
00:41:46,120 --> 00:41:54,190
<font color="#E5E5E5">outbound so we see here explored exe and</font>

895
00:41:50,980 --> 00:41:57,310
by the way<font color="#E5E5E5"> I didn't run explorer but it</font>

896
00:41:54,190 --> 00:42:00,010
reached out to these to these two times

897
00:41:57,310 --> 00:42:01,660
<font color="#E5E5E5">the same IP address and port 80</font><font color="#CCCCCC"> so</font>

898
00:42:00,010 --> 00:42:04,270
that's bad

899
00:42:01,660 --> 00:42:05,290
<font color="#CCCCCC">uh</font><font color="#E5E5E5"> so what can we learn what have we</font>

900
00:42:04,270 --> 00:42:07,180
learned from this

901
00:42:05,290 --> 00:42:10,570
<font color="#CCCCCC">I</font><font color="#E5E5E5"> we've learned that the sample uses</font>

902
00:42:07,180 --> 00:42:14,140
process<font color="#CCCCCC"> injection</font><font color="#E5E5E5"> we know what it</font>

903
00:42:10,570 --> 00:42:16,000
targets<font color="#CCCCCC"> targets</font><font color="#E5E5E5"> explorer.exe and we've</font>

904
00:42:14,140 --> 00:42:19,810
also pulled out a command-and-control<font color="#E5E5E5"> IP</font>

905
00:42:16,000 --> 00:42:22,300
address so<font color="#E5E5E5"> volatilities output</font><font color="#CCCCCC"> you know</font>

906
00:42:19,810 --> 00:42:25,299
you get files from extracted services

907
00:42:22,300 --> 00:42:29,980
from injection<font color="#E5E5E5"> deal</font><font color="#CCCCCC"> all extracted IP</font>

908
00:42:25,300 --> 00:42:32,800
addresses this one so I<font color="#CCCCCC"> by E history is</font>

909
00:42:29,980 --> 00:42:36,730
interesting so<font color="#CCCCCC"> i can actually see on the</font>

910
00:42:32,800 --> 00:42:39,940
history of all of the<font color="#CCCCCC"> URLs that a user</font>

911
00:42:36,730 --> 00:42:43,900
or malware has visited if they are using

912
00:42:39,940 --> 00:42:47,410
<font color="#CCCCCC">IE so eight URLs extracted</font><font color="#E5E5E5"> from our</font>

913
00:42:43,900 --> 00:42:50,680
configuration so<font color="#CCCCCC"> in our config if it's</font>

914
00:42:47,410 --> 00:42:53,290
loaded into memory<font color="#CCCCCC"> i can pull URLs out</font>

915
00:42:50,680 --> 00:42:55,990
of that<font color="#E5E5E5"> and then also suspicious mutexes</font>

916
00:42:53,290 --> 00:42:57,610
<font color="#E5E5E5">and by the way</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> in volatility it's</font>

917
00:42:55,990 --> 00:42:59,379
like turtles all the way down into

918
00:42:57,610 --> 00:43:02,980
infinity there's so much stuff that you

919
00:42:59,380 --> 00:43:05,860
can get out of it<font color="#E5E5E5"> like I could have</font><font color="#CCCCCC"> 820</font>

920
00:43:02,980 --> 00:43:07,240
<font color="#E5E5E5">our talk about volatility alone</font><font color="#CCCCCC"> there's</font>

921
00:43:05,860 --> 00:43:10,690
so<font color="#E5E5E5"> much more stuff that you can get</font>

922
00:43:07,240 --> 00:43:16,060
these are some of the major things so

923
00:43:10,690 --> 00:43:18,190
<font color="#E5E5E5">tying it all together</font><font color="#CCCCCC"> the end and by the</font>

924
00:43:16,060 --> 00:43:20,710
way so<font color="#CCCCCC"> i've i've made a few</font><font color="#E5E5E5"> swimlanes</font>

925
00:43:18,190 --> 00:43:24,640
here and<font color="#CCCCCC"> I wanted</font><font color="#E5E5E5"> originally to have all</font>

926
00:43:20,710 --> 00:43:28,420
four tools in one set of<font color="#CCCCCC"> swim lanes</font><font color="#E5E5E5"> but</font>

927
00:43:24,640 --> 00:43:32,740
when you throw all of these together the

928
00:43:28,420 --> 00:43:35,560
<font color="#E5E5E5">the spaghetti starts to to confuse the</font>

929
00:43:32,740 --> 00:43:36,279
swim lanes so what I've done here is

930
00:43:35,560 --> 00:43:40,420
done

931
00:43:36,280 --> 00:43:43,930
<font color="#CCCCCC">koo sandbox and so you upload a file</font>

932
00:43:40,420 --> 00:43:45,400
to sandbox you do the analysis you send

933
00:43:43,930 --> 00:43:47,319
all<font color="#E5E5E5"> of your indicators to threat</font>

934
00:43:45,400 --> 00:43:50,140
<font color="#E5E5E5">intelligence platform and you have a</font>

935
00:43:47,320 --> 00:43:52,300
thug instance which<font color="#E5E5E5"> will process any of</font>

936
00:43:50,140 --> 00:43:54,430
the<font color="#CCCCCC"> URLs that come out of cuckoo</font><font color="#E5E5E5"> you</font>

937
00:43:52,300 --> 00:43:56,980
have bro that will process<font color="#E5E5E5"> pcap that</font>

938
00:43:54,430 --> 00:44:01,839
comes out of<font color="#CCCCCC"> cuckoo</font><font color="#E5E5E5"> and if you have seen</font>

939
00:43:56,980 --> 00:44:03,880
the file before<font color="#E5E5E5"> I you want to say no and</font>

940
00:44:01,840 --> 00:44:05,620
then send your data to<font color="#CCCCCC"> threat</font><font color="#E5E5E5"> to your</font>

941
00:44:03,880 --> 00:44:07,180
tip<font color="#E5E5E5"> and then if you haven't seen the</font>

942
00:44:05,620 --> 00:44:09,310
file before you want to kind of go back

943
00:44:07,180 --> 00:44:11,560
to the top and throw<font color="#E5E5E5"> it into the top of</font>

944
00:44:09,310 --> 00:44:14,410
the hopper and then this is the same

945
00:44:11,560 --> 00:44:16,090
thing with volatility and kind of

946
00:44:14,410 --> 00:44:18,520
conceptually marry these two together

947
00:44:16,090 --> 00:44:20,350
with the same concept and<font color="#CCCCCC"> I know like</font>

948
00:44:18,520 --> 00:44:22,570
you know upload<font color="#E5E5E5"> URL has a little piece</font>

949
00:44:20,350 --> 00:44:25,660
of spaghetti that<font color="#CCCCCC"> i was unable to kind</font>

950
00:44:22,570 --> 00:44:27,100
of you know<font color="#E5E5E5"> do right but basically</font>

951
00:44:25,660 --> 00:44:30,250
you're you're you're taking the inputs

952
00:44:27,100 --> 00:44:32,799
and outputs are that one particular tool

953
00:44:30,250 --> 00:44:35,770
uses<font color="#E5E5E5"> and if you've seen that particular</font>

954
00:44:32,800 --> 00:44:37,510
thing before<font color="#E5E5E5"> you want to just consume</font>

955
00:44:35,770 --> 00:44:38,860
the data that comes out<font color="#E5E5E5"> and if you</font>

956
00:44:37,510 --> 00:44:42,340
haven't seen it before you want to

957
00:44:38,860 --> 00:44:46,270
process it with another tool<font color="#E5E5E5"> and by the</font>

958
00:44:42,340 --> 00:44:48,640
<font color="#E5E5E5">way one nuance here if you see a file</font>

959
00:44:46,270 --> 00:44:51,400
that drops a file<font color="#E5E5E5"> the drops a file that</font>

960
00:44:48,640 --> 00:44:55,690
drops<font color="#E5E5E5"> a file you want to actually have a</font>

961
00:44:51,400 --> 00:44:58,450
stop at like<font color="#CCCCCC"> I choose six generations of</font>

962
00:44:55,690 --> 00:45:01,030
drop<font color="#E5E5E5"> because you can cause an infinite</font>

963
00:44:58,450 --> 00:45:05,410
loop and kind of you know<font color="#CCCCCC"> my gum up your</font>

964
00:45:01,030 --> 00:45:08,080
<font color="#CCCCCC">cuckoo instance so for orchestra</font>

965
00:45:05,410 --> 00:45:10,359
orchestration and automation<font color="#E5E5E5"> you know</font>

966
00:45:08,080 --> 00:45:15,130
it's up to you what<font color="#E5E5E5"> flavor of message</font>

967
00:45:10,360 --> 00:45:19,240
queue<font color="#E5E5E5"> you like</font><font color="#CCCCCC"> redness rabbitmq i use</font>

968
00:45:15,130 --> 00:45:21,370
<font color="#CCCCCC">zeromq</font><font color="#E5E5E5"> because it's awesome</font><font color="#CCCCCC"> and then</font>

969
00:45:19,240 --> 00:45:22,629
also like you know the concept of

970
00:45:21,370 --> 00:45:25,420
hitting your head against a brick wall

971
00:45:22,630 --> 00:45:28,630
in one of my other projects<font color="#E5E5E5"> plague</font>

972
00:45:25,420 --> 00:45:32,620
scanner<font color="#E5E5E5"> i ran into the brick wall of</font>

973
00:45:28,630 --> 00:45:34,960
using zeromq<font color="#CCCCCC"> transmit files don't</font><font color="#E5E5E5"> do</font>

974
00:45:32,620 --> 00:45:37,839
<font color="#CCCCCC">that what you</font><font color="#E5E5E5"> should do is use engine</font><font color="#CCCCCC"> ex</font>

975
00:45:34,960 --> 00:45:41,470
<font color="#CCCCCC">dumped the files to engine X and then</font>

976
00:45:37,840 --> 00:45:43,660
serve them out using that web server and

977
00:45:41,470 --> 00:45:46,750
then just use the message queue to send

978
00:45:43,660 --> 00:45:49,450
the location to the next tool so that it

979
00:45:46,750 --> 00:45:51,940
downloads the file itself using engine X

980
00:45:49,450 --> 00:45:53,480
because<font color="#E5E5E5"> engine X is built better for</font>

981
00:45:51,940 --> 00:45:55,790
serving files

982
00:45:53,480 --> 00:46:00,619
zeromq built better for serving<font color="#E5E5E5"> you know</font>

983
00:45:55,790 --> 00:46:03,590
small text strings<font color="#CCCCCC"> i prefer</font><font color="#E5E5E5"> to keep all</font>

984
00:46:00,619 --> 00:46:06,230
<font color="#E5E5E5">of my output in elasticsearch</font><font color="#CCCCCC"> cuckoo</font>

985
00:46:03,590 --> 00:46:08,780
<font color="#E5E5E5">right now needs to be</font><font color="#CCCCCC"> koo modified to</font>

986
00:46:06,230 --> 00:46:12,380
have an output plugin for<font color="#E5E5E5"> elasticsearch</font>

987
00:46:08,780 --> 00:46:15,500
<font color="#E5E5E5">i'm personally working on developing a</font>

988
00:46:12,380 --> 00:46:20,060
<font color="#E5E5E5">elasticsearch</font><font color="#CCCCCC"> plugin for the main</font><font color="#E5E5E5"> you</font>

989
00:46:15,500 --> 00:46:23,780
know a<font color="#E5E5E5"> KU lug thug</font><font color="#CCCCCC"> uses elasticsearch</font>

990
00:46:20,060 --> 00:46:26,090
natively<font color="#E5E5E5"> bro has an option to export</font>

991
00:46:23,780 --> 00:46:28,609
logs in<font color="#CCCCCC"> JSON format which can be easily</font>

992
00:46:26,090 --> 00:46:32,000
consumed by<font color="#E5E5E5"> elasticsearch as does</font>

993
00:46:28,609 --> 00:46:34,700
volatility<font color="#CCCCCC"> i prefer</font><font color="#E5E5E5"> to glue everything</font>

994
00:46:32,000 --> 00:46:37,790
together with<font color="#CCCCCC"> python 3 because i hate</font>

995
00:46:34,700 --> 00:46:40,640
<font color="#CCCCCC">python</font><font color="#E5E5E5"> to it needs to die and go away</font>

996
00:46:37,790 --> 00:46:43,730
mainly because of text processing and

997
00:46:40,640 --> 00:46:46,400
the idiocy of<font color="#CCCCCC"> and it was just it was</font>

998
00:46:43,730 --> 00:46:48,740
historical mistake they didn't know how

999
00:46:46,400 --> 00:46:53,390
to do it right yet but it needs to die

1000
00:46:48,740 --> 00:46:55,879
and go away<font color="#CCCCCC"> so</font><font color="#E5E5E5"> by the way</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> we're</font>

1001
00:46:53,390 --> 00:46:59,569
we're<font color="#E5E5E5"> getting towards the question</font>

1002
00:46:55,880 --> 00:47:02,660
<font color="#E5E5E5">component but i wanted to say like</font>

1003
00:46:59,570 --> 00:47:05,930
there's more<font color="#E5E5E5"> more fun we can have with</font>

1004
00:47:02,660 --> 00:47:09,049
<font color="#CCCCCC">me our analysis and the week after next</font>

1005
00:47:05,930 --> 00:47:11,810
<font color="#CCCCCC">i'm giving this</font><font color="#E5E5E5"> talk as a</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> hour</font>

1006
00:47:09,050 --> 00:47:15,619
workshop<font color="#E5E5E5"> at</font><font color="#CCCCCC"> DEFCON</font><font color="#E5E5E5"> and so each of these</font>

1007
00:47:11,810 --> 00:47:18,259
tools will have basically you can you

1008
00:47:15,619 --> 00:47:20,420
<font color="#E5E5E5">know sleep through the teaching part</font>

1009
00:47:18,260 --> 00:47:23,000
because you've seen it but the<font color="#CCCCCC"> fifth the</font>

1010
00:47:20,420 --> 00:47:25,490
45 minutes of hands-on training for each

1011
00:47:23,000 --> 00:47:28,640
one of these tools<font color="#E5E5E5"> i'll be giving in Def</font>

1012
00:47:25,490 --> 00:47:31,580
<font color="#E5E5E5">Con and then please</font>

1013
00:47:28,640 --> 00:47:33,890
that evening<font color="#E5E5E5"> so I'm giving it thursday</font>

1014
00:47:31,580 --> 00:47:36,170
<font color="#E5E5E5">the first day of</font><font color="#CCCCCC"> DEFCON please come to</font>

1015
00:47:33,890 --> 00:47:40,910
our party and get drunk with me that day

1016
00:47:36,170 --> 00:47:44,090
at 6pm to 9pm<font color="#CCCCCC"> I know if you go visit</font>

1017
00:47:40,910 --> 00:47:46,339
this URL it says<font color="#E5E5E5"> black</font><font color="#CCCCCC"> hat party and you</font>

1018
00:47:44,090 --> 00:47:48,020
have to come to our<font color="#E5E5E5"> black</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> booth</font><font color="#CCCCCC"> not</font>

1019
00:47:46,340 --> 00:47:50,750
<font color="#E5E5E5">completely true</font>

1020
00:47:48,020 --> 00:47:54,590
come find me<font color="#CCCCCC"> i'll give you an invite i</font>

1021
00:47:50,750 --> 00:47:56,359
<font color="#E5E5E5">also</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> going to be in</font><font color="#CCCCCC"> Serbia</font><font color="#E5E5E5"> talking</font>

1022
00:47:54,590 --> 00:47:58,760
about another completely different

1023
00:47:56,359 --> 00:48:01,940
concept that<font color="#CCCCCC"> i have called predictive</font>

1024
00:47:58,760 --> 00:48:03,750
<font color="#CCCCCC">CDE hunting and</font><font color="#E5E5E5"> i'll be presenting that</font>

1025
00:48:01,940 --> 00:48:06,150
<font color="#CCCCCC">balkon and then</font>

1026
00:48:03,750 --> 00:48:08,370
<font color="#CCCCCC">I will be wrapping up everything about</font>

1027
00:48:06,150 --> 00:48:20,130
the<font color="#E5E5E5"> open source</font><font color="#CCCCCC"> of our</font><font color="#E5E5E5"> lab virus</font>

1028
00:48:08,370 --> 00:48:25,799
bulletin in<font color="#CCCCCC"> Denver</font><font color="#E5E5E5"> so questions three</font>

1029
00:48:20,130 --> 00:48:28,410
minutes for questions

1030
00:48:25,800 --> 00:48:34,980
<font color="#CCCCCC">I can't even see you because</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> there</font>

1031
00:48:28,410 --> 00:48:37,109
we go<font color="#CCCCCC"> it s so how did you like really</font>

1032
00:48:34,980 --> 00:48:38,280
get into<font color="#E5E5E5"> malware analysis in the</font>

1033
00:48:37,110 --> 00:48:39,450
beginning like<font color="#CCCCCC"> how did you get good at</font>

1034
00:48:38,280 --> 00:48:44,100
all of this stuff<font color="#E5E5E5"> it's really</font>

1035
00:48:39,450 --> 00:48:46,649
complicated<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> mean there's many long</font>

1036
00:48:44,100 --> 00:48:49,650
stories<font color="#CCCCCC"> i encourage you to come to</font>

1037
00:48:46,650 --> 00:48:52,800
<font color="#CCCCCC">blarney rock with me and</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> continue to</font>

1038
00:48:49,650 --> 00:48:56,160
vibe tonight<font color="#CCCCCC"> i'll give you</font><font color="#E5E5E5"> the full</font>

1039
00:48:52,800 --> 00:49:01,260
story but it involves being a landscaper

1040
00:48:56,160 --> 00:49:02,850
and then after being<font color="#E5E5E5"> at that I i'm</font>

1041
00:49:01,260 --> 00:49:04,860
actually not joking<font color="#E5E5E5"> but</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so it</font>

1042
00:49:02,850 --> 00:49:08,100
involves being a landscaper and then

1043
00:49:04,860 --> 00:49:11,220
having someone on my landscaping team

1044
00:49:08,100 --> 00:49:13,740
<font color="#CCCCCC">talk to me and say you know what the</font>

1045
00:49:11,220 --> 00:49:15,060
fuck you doing<font color="#E5E5E5"> as a landscaper you</font>

1046
00:49:13,740 --> 00:49:17,189
should come

1047
00:49:15,060 --> 00:49:19,380
send your resume to the place where<font color="#E5E5E5"> he</font>

1048
00:49:17,190 --> 00:49:24,690
<font color="#E5E5E5">was moonlighting as a landscaper</font><font color="#CCCCCC"> I was</font>

1049
00:49:19,380 --> 00:49:28,410
not<font color="#CCCCCC"> but yet so</font><font color="#E5E5E5"> yeah and then I worked in</font>

1050
00:49:24,690 --> 00:49:36,030
a sock and<font color="#E5E5E5"> did malware analysis and</font>

1051
00:49:28,410 --> 00:49:37,620
<font color="#E5E5E5">fishing analysis and now</font><font color="#CCCCCC"> I'm here so if</font>

1052
00:49:36,030 --> 00:49:41,790
you could elaborate a little bit more

1053
00:49:37,620 --> 00:49:43,710
<font color="#E5E5E5">something as the privacy conscious</font>

1054
00:49:41,790 --> 00:49:46,650
person who<font color="#CCCCCC"> kinda likes to roll my own</font>

1055
00:49:43,710 --> 00:49:48,450
stuff but doesn't always have the time

1056
00:49:46,650 --> 00:49:51,150
passive DNS stuff<font color="#E5E5E5"> you were talking about</font>

1057
00:49:48,450 --> 00:49:54,480
<font color="#CCCCCC">that's something that I</font><font color="#E5E5E5"> just see like</font>

1058
00:49:51,150 --> 00:49:57,090
highly useful to figure out what apps in

1059
00:49:54,480 --> 00:50:00,810
services are doing behind your back

1060
00:49:57,090 --> 00:50:04,230
so is<font color="#CCCCCC"> there</font><font color="#E5E5E5"> recommend every time I think</font>

1061
00:50:00,810 --> 00:50:06,270
of configuring bind<font color="#CCCCCC"> i</font><font color="#E5E5E5"> don't know go and</font>

1062
00:50:04,230 --> 00:50:09,510
do something else<font color="#E5E5E5"> is there like a sort</font>

1063
00:50:06,270 --> 00:50:11,910
of like<font color="#E5E5E5"> one-stop shop for configuring a</font>

1064
00:50:09,510 --> 00:50:13,710
reasonable<font color="#E5E5E5"> dns server that will give you</font>

1065
00:50:11,910 --> 00:50:17,129
nice logs of

1066
00:50:13,710 --> 00:50:19,650
everything that's<font color="#E5E5E5"> hitting it yes so I</font>

1067
00:50:17,130 --> 00:50:24,180
<font color="#CCCCCC">the answer</font><font color="#E5E5E5"> to your question is much</font>

1068
00:50:19,650 --> 00:50:28,380
longer<font color="#CCCCCC"> but</font><font color="#E5E5E5"> i can say go to</font><font color="#CCCCCC"> meet go to</font>

1069
00:50:24,180 --> 00:50:29,910
<font color="#CCCCCC">ISC website and look up p dns ok on</font>

1070
00:50:28,380 --> 00:50:31,680
there are ways<font color="#E5E5E5"> that you can configure it</font>

1071
00:50:29,910 --> 00:50:35,009
to do that<font color="#E5E5E5"> do what you want</font>

1072
00:50:31,680 --> 00:50:37,529
<font color="#CCCCCC">ok thanks and actually if i can plug</font>

1073
00:50:35,010 --> 00:50:41,130
<font color="#E5E5E5">some you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> good friends of mine</font><font color="#CCCCCC"> uh</font>

1074
00:50:37,530 --> 00:50:43,890
<font color="#E5E5E5">circle which is one of the certs in</font>

1075
00:50:41,130 --> 00:50:45,660
<font color="#CCCCCC">Luxembourg provides as long as you are</font>

1076
00:50:43,890 --> 00:50:47,700
one of the good people and you can prove

1077
00:50:45,660 --> 00:50:49,830
prove to them that<font color="#CCCCCC"> you are like an hour</font>

1078
00:50:47,700 --> 00:50:52,859
analysis person or<font color="#CCCCCC"> a security person</font>

1079
00:50:49,830 --> 00:50:58,710
<font color="#CCCCCC">they'll give you access to their PDAs</font>

1080
00:50:52,859 --> 00:51:01,200
<font color="#E5E5E5">system</font><font color="#CCCCCC"> obviously</font><font color="#E5E5E5"> this malware as part of</font>

1081
00:50:58,710 --> 00:51:03,750
your analysis you liked it punch out<font color="#CCCCCC"> i'm</font>

1082
00:51:01,200 --> 00:51:06,540
<font color="#E5E5E5">curious do you completely sandbox</font>

1083
00:51:03,750 --> 00:51:09,869
isolate that<font color="#E5E5E5"> that</font><font color="#CCCCCC"> network like literally</font>

1084
00:51:06,540 --> 00:51:13,410
<font color="#E5E5E5">no</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> I guess it is completely</font>

1085
00:51:09,869 --> 00:51:15,630
isolated<font color="#E5E5E5"> it's actually living on a</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> by</font>

1086
00:51:13,410 --> 00:51:18,779
the way<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> when you do malware analysis</font>

1087
00:51:15,630 --> 00:51:22,140
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> very rare to find a hosting company</font>

1088
00:51:18,780 --> 00:51:24,480
that does not use the word malware or

1089
00:51:22,140 --> 00:51:27,240
virus in their terms of service so<font color="#CCCCCC"> I</font>

1090
00:51:24,480 --> 00:51:30,180
will not tell<font color="#E5E5E5"> you where</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> am hosting my</font>

1091
00:51:27,240 --> 00:51:32,580
stuff<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> not violating their terms</font>

1092
00:51:30,180 --> 00:51:37,230
of service but<font color="#CCCCCC"> I am isolating it from my</font>

1093
00:51:32,580 --> 00:51:39,210
network<font color="#E5E5E5"> you know completely and just on</font>

1094
00:51:37,230 --> 00:51:41,310
that note<font color="#CCCCCC"> like</font><font color="#E5E5E5"> are we talking like</font><font color="#CCCCCC"> your</font>

1095
00:51:39,210 --> 00:51:43,650
<font color="#CCCCCC">v landing it or we're talking when we</font>

1096
00:51:41,310 --> 00:51:46,170
literally<font color="#E5E5E5"> hardware isolated on it is</font>

1097
00:51:43,650 --> 00:51:50,040
sitting on a dedicated server in X

1098
00:51:46,170 --> 00:51:51,839
location and it has all of this software

1099
00:51:50,040 --> 00:51:56,369
that we just talked about running on it

1100
00:51:51,839 --> 00:51:59,820
and<font color="#E5E5E5"> I</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> is interfaces vapi and</font><font color="#CCCCCC"> UI</font>

1101
00:51:56,369 --> 00:52:02,670
<font color="#E5E5E5">and that's it</font><font color="#CCCCCC"> like it then goes out i do</font>

1102
00:51:59,820 --> 00:52:05,070
<font color="#CCCCCC">i am a good</font><font color="#E5E5E5"> citizen so I</font><font color="#CCCCCC"> block port 25</font>

1103
00:52:02,670 --> 00:52:08,280
and all the other submission<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know so</font>

1104
00:52:05,070 --> 00:52:11,760
it's<font color="#E5E5E5"> not just you know</font><font color="#CCCCCC"> a spamming stuff</font>

1105
00:52:08,280 --> 00:52:15,780
from what<font color="#CCCCCC"> I'm doing so and then do you</font>

1106
00:52:11,760 --> 00:52:18,300
do<font color="#CCCCCC"> and if</font><font color="#E5E5E5"> you do how do you</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> set it</font>

1107
00:52:15,780 --> 00:52:20,430
up<font color="#CCCCCC"> arm where you're going to have like a</font>

1108
00:52:18,300 --> 00:52:22,770
like a<font color="#E5E5E5"> networked environment because a</font>

1109
00:52:20,430 --> 00:52:25,230
lot of times malware will reach out to

1110
00:52:22,770 --> 00:52:26,360
your nearest<font color="#E5E5E5"> neighbor and so how do you</font>

1111
00:52:25,230 --> 00:52:30,860
model<font color="#CCCCCC"> lat</font>

1112
00:52:26,360 --> 00:52:33,800
I<font color="#E5E5E5"> in your</font><font color="#CCCCCC"> setup on</font><font color="#E5E5E5"> so there is no land</font>

1113
00:52:30,860 --> 00:52:36,440
situation involved so it's basically raw

1114
00:52:33,800 --> 00:52:38,120
<font color="#E5E5E5">internet and so you know there's no</font>

1115
00:52:36,440 --> 00:52:40,310
difference between it reaching out to

1116
00:52:38,120 --> 00:52:42,770
his neighbor in my sandbox and reaching

1117
00:52:40,310 --> 00:52:45,200
out to his neighbor just you know<font color="#E5E5E5"> out</font>

1118
00:52:42,770 --> 00:52:46,730
there in the raw internet<font color="#E5E5E5"> so you know</font>

1119
00:52:45,200 --> 00:52:50,299
it's not<font color="#E5E5E5"> no it's not in the local area</font>

1120
00:52:46,730 --> 00:52:54,590
network and you know obviously we're

1121
00:52:50,300 --> 00:52:56,180
doing<font color="#E5E5E5"> our analysis so it's up to the</font>

1122
00:52:54,590 --> 00:52:57,590
other entities on the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> to</font>

1123
00:52:56,180 --> 00:53:00,230
protect themselves from the things that

1124
00:52:57,590 --> 00:53:07,490
<font color="#CCCCCC">emit from</font><font color="#E5E5E5"> my box and sorry</font><font color="#CCCCCC"> i need to do</font>

1125
00:53:00,230 --> 00:53:10,670
<font color="#E5E5E5">the</font><font color="#CCCCCC"> malware analysis work but</font><font color="#E5E5E5"> so there</font>

1126
00:53:07,490 --> 00:53:13,189
are<font color="#CCCCCC"> actually have a configuration for a</font>

1127
00:53:10,670 --> 00:53:17,360
<font color="#CCCCCC">coup that allows me to use what's called</font>

1128
00:53:13,190 --> 00:53:19,100
<font color="#CCCCCC">I netsim</font><font color="#E5E5E5"> and I you know fake dns and so</font>

1129
00:53:17,360 --> 00:53:20,840
<font color="#CCCCCC">i can run things and these are actually</font>

1130
00:53:19,100 --> 00:53:23,540
really important when you're doing<font color="#CCCCCC"> our</font>

1131
00:53:20,840 --> 00:53:26,630
analysis because sometimes a lot of<font color="#E5E5E5"> time</font>

1132
00:53:23,540 --> 00:53:28,730
i will look at a piece of malware<font color="#CCCCCC"> and</font>

1133
00:53:26,630 --> 00:53:29,960
the<font color="#CCCCCC"> c2 has been taken down by the isp</font>

1134
00:53:28,730 --> 00:53:32,000
but I still want to know what's

1135
00:53:29,960 --> 00:53:34,010
happening<font color="#CCCCCC"> so I want to have that see to</font>

1136
00:53:32,000 --> 00:53:37,670
pretend to respond to<font color="#E5E5E5"> them</font><font color="#CCCCCC"> our so i'll</font>

1137
00:53:34,010 --> 00:53:40,490
have it<font color="#E5E5E5"> reach out the different network</font>

1138
00:53:37,670 --> 00:53:46,460
you know<font color="#E5E5E5"> it's completely closed and have</font>

1139
00:53:40,490 --> 00:53:52,850
<font color="#E5E5E5">I netsim and fake</font><font color="#CCCCCC"> dns</font><font color="#E5E5E5"> running</font><font color="#CCCCCC"> all right</font>

1140
00:53:46,460 --> 00:53:54,590
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> done by the way I don't want to</font>

1141
00:53:52,850 --> 00:53:58,130
interrupt the next speaker but<font color="#CCCCCC"> i have a</font>

1142
00:53:54,590 --> 00:54:00,170
butt ton of t-shirts and<font color="#CCCCCC"> I'll just hang</font>

1143
00:53:58,130 --> 00:54:06,430
out back there and throw<font color="#CCCCCC"> them</font><font color="#E5E5E5"> in the</font>

1144
00:54:00,170 --> 00:54:06,430
given to whoever<font color="#CCCCCC"> wants</font><font color="#E5E5E5"> some</font>

