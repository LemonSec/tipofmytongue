1
00:00:00,050 --> 00:00:05,069
all right welcome everyone I'm Chris

2
00:00:03,240 --> 00:00:07,049
Corbin this is my colleague Cody Thomas

3
00:00:05,069 --> 00:00:08,610
and today we'll be talking to you guys

4
00:00:07,049 --> 00:00:10,800
about how to attack with threat

5
00:00:08,610 --> 00:00:12,629
intelligence

6
00:00:10,800 --> 00:00:15,179
first things first a little bit about us

7
00:00:12,630 --> 00:00:16,890
I'm a cyber security engineer I do

8
00:00:15,179 --> 00:00:19,109
research and development for an

9
00:00:16,890 --> 00:00:21,060
organization called mitre for those of

10
00:00:19,109 --> 00:00:22,260
you not familiar mitre is a federally

11
00:00:21,060 --> 00:00:24,930
funded research and development center

12
00:00:22,260 --> 00:00:27,330
where we try to tackle subjects and

13
00:00:24,930 --> 00:00:28,920
problems that are industry-wide in an

14
00:00:27,330 --> 00:00:30,000
effort to bring you know the level of

15
00:00:28,920 --> 00:00:33,300
safety for everyone

16
00:00:30,000 --> 00:00:35,760
higher I've been working with attack in

17
00:00:33,300 --> 00:00:37,349
one some shape way or form for the past

18
00:00:35,760 --> 00:00:40,260
five or so years pretty much my entire

19
00:00:37,350 --> 00:00:42,329
time at mitre and most recently I've

20
00:00:40,260 --> 00:00:44,099
been creating a using attack to create

21
00:00:42,329 --> 00:00:45,329
adversary munition plans and that's what

22
00:00:44,100 --> 00:00:46,559
we'll be talking about today how to use

23
00:00:45,329 --> 00:00:48,210
it how to create these adversary

24
00:00:46,559 --> 00:00:49,739
emulation plans how to use them and how

25
00:00:48,210 --> 00:00:53,550
to effectively become a better red team

26
00:00:49,739 --> 00:00:55,709
or blue team or for that matter I'm Cody

27
00:00:53,550 --> 00:00:58,858
Thomas also working at mitre with Chris

28
00:00:55,710 --> 00:01:00,510
only for about two years though before

29
00:00:58,859 --> 00:01:02,070
we've had attack focused largely on

30
00:01:00,510 --> 00:01:03,989
Windows so I went ahead and pushed for

31
00:01:02,070 --> 00:01:07,560
it to come out into more of Mac and

32
00:01:03,989 --> 00:01:09,270
Linux domain okay and then so most of my

33
00:01:07,560 --> 00:01:10,590
background is more in red teaming and

34
00:01:09,270 --> 00:01:11,700
tool development and so that you'll see

35
00:01:10,590 --> 00:01:13,830
that kind of pop up throughout the

36
00:01:11,700 --> 00:01:16,619
presentation as we get kind of hands-on

37
00:01:13,830 --> 00:01:20,220
technical details of using this to be

38
00:01:16,619 --> 00:01:24,990
more of a red team and active active all

39
00:01:20,220 --> 00:01:28,289
networked awesome so first things first

40
00:01:24,990 --> 00:01:30,089
I wanted to start with what we think the

41
00:01:28,290 --> 00:01:32,100
root cause or the problem or root

42
00:01:30,090 --> 00:01:34,799
problem really is for a lot of the

43
00:01:32,100 --> 00:01:36,839
issues that we're trying to solve and as

44
00:01:34,799 --> 00:01:39,090
you can see above that what we think

45
00:01:36,840 --> 00:01:40,829
that is is this traditional offensive

46
00:01:39,090 --> 00:01:43,710
testing workflow so any sort of you know

47
00:01:40,829 --> 00:01:46,829
cyber game or maybe a pen test or a red

48
00:01:43,710 --> 00:01:49,020
team blue team we tend to see way more

49
00:01:46,829 --> 00:01:51,119
often than we would hope this sort of

50
00:01:49,020 --> 00:01:52,740
traditional workflow where you have red

51
00:01:51,119 --> 00:01:55,350
doing their own thing blue doing their

52
00:01:52,740 --> 00:01:56,729
own thing not a lot of interaction a lot

53
00:01:55,350 --> 00:01:58,829
of times they're butting heads there's

54
00:01:56,729 --> 00:02:00,179
some politics involved and there's a lot

55
00:01:58,829 --> 00:02:03,929
of problems here that we really needed

56
00:02:00,180 --> 00:02:05,759
aim to solve in order to you know take

57
00:02:03,930 --> 00:02:08,849
these games to the next level you have

58
00:02:05,759 --> 00:02:10,348
red and blue events become more valuable

59
00:02:08,848 --> 00:02:12,119
so yeah you read will typically come in

60
00:02:10,348 --> 00:02:13,709
and you know after determining scope

61
00:02:12,120 --> 00:02:15,239
with the network owner and you know the

62
00:02:13,709 --> 00:02:16,920
objectives they'll start going through

63
00:02:15,239 --> 00:02:20,430
their kill chain they'll start doing

64
00:02:16,920 --> 00:02:22,170
their discovery then maybe their initial

65
00:02:20,430 --> 00:02:24,420
access trying to get onto the machine a

66
00:02:22,170 --> 00:02:26,220
single machine and then moving laterally

67
00:02:24,420 --> 00:02:26,809
from there maybe escalating privileges

68
00:02:26,220 --> 00:02:29,730
if needed

69
00:02:26,810 --> 00:02:32,159
laying persistence down and then finally

70
00:02:29,730 --> 00:02:33,599
maybe exfiltration or you know attempt

71
00:02:32,159 --> 00:02:36,390
to get to domain admin or something

72
00:02:33,599 --> 00:02:37,950
along those lines at the end they

73
00:02:36,390 --> 00:02:39,510
basically just take all everything they

74
00:02:37,950 --> 00:02:41,069
did and everything they tried what

75
00:02:39,510 --> 00:02:42,899
worked and what didn't they'll throw

76
00:02:41,069 --> 00:02:45,000
that all into a report and just toss it

77
00:02:42,900 --> 00:02:47,400
over the fence the blue team at the

78
00:02:45,000 --> 00:02:49,639
other hand if they even know red team is

79
00:02:47,400 --> 00:02:51,629
going on and usually they may or may not

80
00:02:49,639 --> 00:02:52,819
they're doing they're just regular day

81
00:02:51,629 --> 00:02:55,500
job they're you know collecting

82
00:02:52,819 --> 00:02:56,608
protecting collect the it off their

83
00:02:55,500 --> 00:02:59,549
network they're trying to protect their

84
00:02:56,609 --> 00:03:01,409
network as well detecting anything any

85
00:02:59,549 --> 00:03:06,269
malicious behavior and triaging any

86
00:03:01,409 --> 00:03:08,189
alerts that pop up and whatnot so when

87
00:03:06,269 --> 00:03:10,650
this happens we end up with some of

88
00:03:08,189 --> 00:03:13,198
these traditional outcomes if we're

89
00:03:10,650 --> 00:03:15,239
measuring Reds success on how far they

90
00:03:13,199 --> 00:03:17,669
were able to penetrate into a network or

91
00:03:15,239 --> 00:03:20,340
basically how far they were able or how

92
00:03:17,669 --> 00:03:22,530
many things are able to steal what this

93
00:03:20,340 --> 00:03:24,870
does is cause a certain problem and that

94
00:03:22,530 --> 00:03:26,639
they're not necessarily testing the blue

95
00:03:24,870 --> 00:03:29,940
team they're testing the network and the

96
00:03:26,639 --> 00:03:31,590
blue team's maybe defenses as a whole

97
00:03:29,940 --> 00:03:35,400
instead of maybe fighting them slightly

98
00:03:31,590 --> 00:03:37,979
better and more focused results or

99
00:03:35,400 --> 00:03:39,540
things for them and look out for

100
00:03:37,979 --> 00:03:40,919
they basically in that report they write

101
00:03:39,540 --> 00:03:42,209
at the end I'll just put again they'll

102
00:03:40,919 --> 00:03:44,459
put all the techniques and they'll put

103
00:03:42,209 --> 00:03:45,750
any IOC syndicators compromise or all

104
00:03:44,459 --> 00:03:47,970
the stuff they did so these are your

105
00:03:45,750 --> 00:03:49,799
file hashes your file names what IPS and

106
00:03:47,970 --> 00:03:52,650
domain names they came from and their c2

107
00:03:49,799 --> 00:03:55,049
and whatnot so if depending on who's

108
00:03:52,650 --> 00:03:56,639
responsible for cleanup boo team can

109
00:03:55,049 --> 00:03:59,970
make sure that none of that still in

110
00:03:56,639 --> 00:04:01,859
their environment and like I said if

111
00:03:59,970 --> 00:04:03,329
Fred's measured on how you know many

112
00:04:01,859 --> 00:04:04,650
documents they're able to steal or

113
00:04:03,329 --> 00:04:06,780
anything like that next year they're

114
00:04:04,650 --> 00:04:07,769
gonna make sure that they are not next

115
00:04:06,780 --> 00:04:08,909
year button to the next time they come

116
00:04:07,769 --> 00:04:11,129
in they really want to make sure that

117
00:04:08,909 --> 00:04:12,720
they're able to win again next time and

118
00:04:11,129 --> 00:04:14,478
this is the mentality that I think is

119
00:04:12,720 --> 00:04:16,079
really the whole win-lose mentality is

120
00:04:14,479 --> 00:04:18,690
something that we're trying to target

121
00:04:16,079 --> 00:04:20,250
here blue on the other hand once they

122
00:04:18,690 --> 00:04:21,660
receive that report

123
00:04:20,250 --> 00:04:23,070
they just you know they're just doing

124
00:04:21,660 --> 00:04:24,390
their daily job and dealing where their

125
00:04:23,070 --> 00:04:26,490
their daily incident response they get

126
00:04:24,390 --> 00:04:28,169
this huge massive report from bread that

127
00:04:26,490 --> 00:04:31,260
hey this is all the whales ways that you

128
00:04:28,170 --> 00:04:33,090
guys failed at your job obviously you

129
00:04:31,260 --> 00:04:35,310
know that's pretty much sucks to hear

130
00:04:33,090 --> 00:04:36,119
and you know you're not as a blue team

131
00:04:35,310 --> 00:04:37,620
or you're not really going to enjoy

132
00:04:36,120 --> 00:04:38,700
working with the right team or and you

133
00:04:37,620 --> 00:04:42,210
know this is gonna start fading and

134
00:04:38,700 --> 00:04:43,740
divide so what would the blue team are

135
00:04:42,210 --> 00:04:45,659
at this case do with the report that was

136
00:04:43,740 --> 00:04:47,280
generated well they would go through see

137
00:04:45,660 --> 00:04:50,700
what work that their team tried and

138
00:04:47,280 --> 00:04:52,440
tried to remediate that stuff you know

139
00:04:50,700 --> 00:04:55,200
no one has them as much time as they

140
00:04:52,440 --> 00:04:56,610
want these days especially in this area

141
00:04:55,200 --> 00:04:59,280
so what did they end up doing is just

142
00:04:56,610 --> 00:05:01,080
basically creating static detections for

143
00:04:59,280 --> 00:05:03,809
the red team's tools and what not things

144
00:05:01,080 --> 00:05:05,400
that are very fragile and things that

145
00:05:03,810 --> 00:05:07,680
may stop this red team if they were to

146
00:05:05,400 --> 00:05:09,780
do the exact same thing again but the

147
00:05:07,680 --> 00:05:13,020
next time right theme comes that may not

148
00:05:09,780 --> 00:05:16,020
mean stop anything or let alone a real

149
00:05:13,020 --> 00:05:18,780
adversary if they didn't want to go the

150
00:05:16,020 --> 00:05:20,370
next step up and sort of take a look at

151
00:05:18,780 --> 00:05:23,640
the actual behavior that the red

152
00:05:20,370 --> 00:05:26,130
whatever a team was in implementing or

153
00:05:23,640 --> 00:05:29,490
doing on their environment or in their

154
00:05:26,130 --> 00:05:32,250
environment they don't have the amount

155
00:05:29,490 --> 00:05:33,900
of a really good sample size they really

156
00:05:32,250 --> 00:05:34,950
only have that one you know if they

157
00:05:33,900 --> 00:05:36,239
didn't know the right thing was going on

158
00:05:34,950 --> 00:05:37,770
they just have you know what they've

159
00:05:36,240 --> 00:05:39,240
collected historically and they need to

160
00:05:37,770 --> 00:05:40,440
go through that and comb through it so

161
00:05:39,240 --> 00:05:42,270
if they do create a defense in this case

162
00:05:40,440 --> 00:05:44,280
they can't really test it for the false

163
00:05:42,270 --> 00:05:46,049
positives or tweak it because you can't

164
00:05:44,280 --> 00:05:48,109
bring them in being the right team in as

165
00:05:46,050 --> 00:05:54,590
often as you'd like it would this set up

166
00:05:48,110 --> 00:05:54,590
and have them test your defenses

167
00:05:55,860 --> 00:06:00,810
so how does the red team in this case

168
00:05:57,750 --> 00:06:03,300
and the blue team progress so as we said

169
00:06:00,810 --> 00:06:06,000
there's fragile detection that are being

170
00:06:03,300 --> 00:06:07,860
created static ones as well so blue seas

171
00:06:06,000 --> 00:06:09,570
that Red's been using this one tool with

172
00:06:07,860 --> 00:06:10,710
a specific hash on all the other

173
00:06:09,570 --> 00:06:12,510
machines they compromised

174
00:06:10,710 --> 00:06:14,130
that's an easy one they'll just find the

175
00:06:12,510 --> 00:06:15,630
hash and label it as bad and have

176
00:06:14,130 --> 00:06:18,360
whatever mechanism they have to remove

177
00:06:15,630 --> 00:06:19,890
that and go ahead and remove that red

178
00:06:18,360 --> 00:06:21,420
however next time they come they try it

179
00:06:19,890 --> 00:06:24,289
they see that as soon as their file hits

180
00:06:21,420 --> 00:06:27,510
disk it disappears well they just read

181
00:06:24,290 --> 00:06:29,370
recycle that and they just up recompile

182
00:06:27,510 --> 00:06:31,380
that with a very minor modification or

183
00:06:29,370 --> 00:06:35,790
any sort of obfuscation and they're

184
00:06:31,380 --> 00:06:37,530
passed that one file has checked next

185
00:06:35,790 --> 00:06:38,880
time booth takes a look at the report

186
00:06:37,530 --> 00:06:41,010
and sees what they didn't like okay well

187
00:06:38,880 --> 00:06:43,140
maybe we can't focus on hashes let's see

188
00:06:41,010 --> 00:06:44,460
about maybe strings maybe a rule of some

189
00:06:43,140 --> 00:06:48,030
sort or something along those lines they

190
00:06:44,460 --> 00:06:49,710
see me me cats in the tool okay Brett

191
00:06:48,030 --> 00:06:50,609
team does the sees the same thing as

192
00:06:49,710 --> 00:06:53,280
well when they're running their tool

193
00:06:50,610 --> 00:06:54,870
they see that so they remove that maybe

194
00:06:53,280 --> 00:06:56,729
the debug strings are just to change up

195
00:06:54,870 --> 00:06:59,430
the strings orbs again some sort of

196
00:06:56,730 --> 00:07:01,200
obfuscation and they just keep

197
00:06:59,430 --> 00:07:02,970
alternating back and forth this way and

198
00:07:01,200 --> 00:07:04,800
as I said these you know when they're in

199
00:07:02,970 --> 00:07:06,750
the traditional red and blue these

200
00:07:04,800 --> 00:07:08,100
aren't happening very quick after these

201
00:07:06,750 --> 00:07:09,120
aren't iterative these are you know

202
00:07:08,100 --> 00:07:11,220
there's significant amount of time

203
00:07:09,120 --> 00:07:13,650
happening between the red or after the

204
00:07:11,220 --> 00:07:15,840
red events after the and you know with

205
00:07:13,650 --> 00:07:17,700
the blue dealing with red and then the

206
00:07:15,840 --> 00:07:19,530
cycle continues that way so in reality

207
00:07:17,700 --> 00:07:21,630
there's a lot of time that this is

208
00:07:19,530 --> 00:07:24,150
taking for us not to really progress as

209
00:07:21,630 --> 00:07:25,620
both red or blue we're not focusing in

210
00:07:24,150 --> 00:07:27,469
what we need to be focusing here the

211
00:07:25,620 --> 00:07:32,010
defense of the network isn't really

212
00:07:27,470 --> 00:07:33,600
increasing that well finally you know

213
00:07:32,010 --> 00:07:35,550
maybe blue takes a little bit of time

214
00:07:33,600 --> 00:07:37,530
they step back and they realize okay so

215
00:07:35,550 --> 00:07:39,780
they saw that the red team was using PS

216
00:07:37,530 --> 00:07:41,159
exec for the lateral movement maybe they

217
00:07:39,780 --> 00:07:42,479
already have some plate the sensors in

218
00:07:41,160 --> 00:07:44,250
place on their network they can tell

219
00:07:42,480 --> 00:07:45,480
that yes exactly really isn't used in

220
00:07:44,250 --> 00:07:47,160
this India in our environment

221
00:07:45,480 --> 00:07:49,230
legitimately so let's go ahead and shut

222
00:07:47,160 --> 00:07:51,090
that down so now we're starting to think

223
00:07:49,230 --> 00:07:53,550
with some like sort of TTP or behavior

224
00:07:51,090 --> 00:07:56,489
that we're now killing for the red team

225
00:07:53,550 --> 00:07:58,080
as an actual TTP they can use the right

226
00:07:56,490 --> 00:07:59,640
team will realize this and if one that

227
00:07:58,080 --> 00:08:01,229
stops working they'll have to find some

228
00:07:59,640 --> 00:08:02,700
other way that a lot of early move it

229
00:08:01,230 --> 00:08:06,540
was that's the only way they knew how to

230
00:08:02,700 --> 00:08:08,830
there and you pretty much in a situation

231
00:08:06,540 --> 00:08:10,990
where they find themselves needing to

232
00:08:08,830 --> 00:08:14,919
find a different way and pretty much do

233
00:08:10,990 --> 00:08:20,200
it live so what can we do at this point

234
00:08:14,920 --> 00:08:23,640
to really help red and blue skip maybe

235
00:08:20,200 --> 00:08:26,409
have a shortcut to thinking to TTP's

236
00:08:23,640 --> 00:08:29,380
instead of maybe just some of the like a

237
00:08:26,410 --> 00:08:32,890
hashes or the strings well with that we

238
00:08:29,380 --> 00:08:34,419
have this diagram here for those you

239
00:08:32,890 --> 00:08:36,640
thought not familiar with this this is

240
00:08:34,419 --> 00:08:38,699
David Bianco's pyramid of pain it's

241
00:08:36,640 --> 00:08:42,460
usually presented as a way to prioritize

242
00:08:38,700 --> 00:08:45,490
blue defenses basically all it's trying

243
00:08:42,460 --> 00:08:47,530
to try to illustrate is starting at the

244
00:08:45,490 --> 00:08:49,360
bottom those are the easiest things for

245
00:08:47,530 --> 00:08:51,579
an adversary to change it won't cost

246
00:08:49,360 --> 00:08:53,050
them much time or resources those are

247
00:08:51,580 --> 00:08:55,060
things like your hash values your IP

248
00:08:53,050 --> 00:08:56,650
addresses domain names there's always

249
00:08:55,060 --> 00:08:59,319
you know you can always register new

250
00:08:56,650 --> 00:09:02,260
domains or you compromise easy domains

251
00:08:59,320 --> 00:09:03,880
that already exist but as we traverse

252
00:09:02,260 --> 00:09:05,680
this pyramid to the top we start seeing

253
00:09:03,880 --> 00:09:07,240
things like Network and host artifacts

254
00:09:05,680 --> 00:09:10,030
starting to get a little annoying the

255
00:09:07,240 --> 00:09:11,500
change and also tools and the hardest

256
00:09:10,030 --> 00:09:13,780
thing the toughest thing for an

257
00:09:11,500 --> 00:09:16,300
advertised adversary to change are their

258
00:09:13,780 --> 00:09:17,890
TTP's there are several reasons for this

259
00:09:16,300 --> 00:09:19,270
but I mean simply put there's a finite

260
00:09:17,890 --> 00:09:22,510
amount of ways that Windows will allow

261
00:09:19,270 --> 00:09:27,430
you to do remote execution of code for

262
00:09:22,510 --> 00:09:30,430
example now even so as I said this is

263
00:09:27,430 --> 00:09:32,739
usually presented with a blue sort of

264
00:09:30,430 --> 00:09:36,310
shade but as a red teamer how can you

265
00:09:32,740 --> 00:09:39,820
also use this everything in the bottom

266
00:09:36,310 --> 00:09:40,930
of half of this the bottom half maybe

267
00:09:39,820 --> 00:09:43,000
all the way up to network in host

268
00:09:40,930 --> 00:09:45,760
artifacts you this is the stuff you want

269
00:09:43,000 --> 00:09:47,080
to be varying you know byte as a second

270
00:09:45,760 --> 00:09:49,000
nature by now so every time you're all

271
00:09:47,080 --> 00:09:50,800
new see to make sure you change all your

272
00:09:49,000 --> 00:09:53,470
defaults and you know maybe set up some

273
00:09:50,800 --> 00:09:54,609
backup protocols and whatnot and let

274
00:09:53,470 --> 00:09:56,020
alone hash values that you should be

275
00:09:54,610 --> 00:09:59,080
randomizing pretty much every time you

276
00:09:56,020 --> 00:10:00,579
create a new payload of some sort but

277
00:09:59,080 --> 00:10:02,620
more importantly we need a focus at the

278
00:10:00,580 --> 00:10:04,120
top right that's where the most

279
00:10:02,620 --> 00:10:06,340
important thing so that's if you get

280
00:10:04,120 --> 00:10:08,020
caught where your TTP's get caught you

281
00:10:06,340 --> 00:10:09,820
basically have the potential to get

282
00:10:08,020 --> 00:10:12,819
hamstrung and stuck in a sticky

283
00:10:09,820 --> 00:10:15,190
situation so again if you only have like

284
00:10:12,820 --> 00:10:17,200
one TTP for a lateral movement maybe you

285
00:10:15,190 --> 00:10:20,800
need to you know expand on that look

286
00:10:17,200 --> 00:10:22,420
into what else is out there so one of

287
00:10:20,800 --> 00:10:25,359
the things we realized

288
00:10:22,420 --> 00:10:28,329
as a good way to have red and blue both

289
00:10:25,360 --> 00:10:30,490
of them together focus on the top of

290
00:10:28,329 --> 00:10:32,888
this pyramid in what how they prioritize

291
00:10:30,490 --> 00:10:34,870
their work and also help them work

292
00:10:32,889 --> 00:10:39,930
together is to provide them with a

293
00:10:34,870 --> 00:10:39,930
common language that is based on TTP's

294
00:10:39,959 --> 00:10:45,849
it's based on TTP's and also provides

295
00:10:43,839 --> 00:10:48,699
them several things that enables them to

296
00:10:45,850 --> 00:10:49,720
do their job easier together so what are

297
00:10:48,699 --> 00:10:52,269
these things that we need from this

298
00:10:49,720 --> 00:10:54,100
language for to provide that for us well

299
00:10:52,269 --> 00:10:55,990
first and foremost we need to be able to

300
00:10:54,100 --> 00:10:58,360
communicate and articulate exactly what

301
00:10:55,990 --> 00:11:01,899
happened in a in an actual event and

302
00:10:58,360 --> 00:11:03,790
what was responded to so as the Red Team

303
00:11:01,899 --> 00:11:05,470
you have these amounts of TTP's that

304
00:11:03,790 --> 00:11:07,180
you've tried and you you know you go

305
00:11:05,470 --> 00:11:08,320
ahead and you say okay well this kind of

306
00:11:07,180 --> 00:11:09,939
lateral movement work this kind of

307
00:11:08,320 --> 00:11:11,860
privilege escalation work this kind of

308
00:11:09,940 --> 00:11:14,500
persistence work and all these others

309
00:11:11,860 --> 00:11:16,930
didn't at the same time the blue team

310
00:11:14,500 --> 00:11:18,910
can then focus their work okay we see

311
00:11:16,930 --> 00:11:20,290
that this TTP for a lot of movement has

312
00:11:18,910 --> 00:11:21,490
been used and it's actually a fairly

313
00:11:20,290 --> 00:11:25,990
common one so maybe we should be

314
00:11:21,490 --> 00:11:27,490
prioritizing some defenses there and

315
00:11:25,990 --> 00:11:29,860
that's what mu helps them move away from

316
00:11:27,490 --> 00:11:33,269
the hashes and all that sort of you know

317
00:11:29,860 --> 00:11:35,949
they easily I guess pretty fragile

318
00:11:33,269 --> 00:11:37,810
detections that one would automatically

319
00:11:35,949 --> 00:11:39,040
go to if they were you know in a you

320
00:11:37,810 --> 00:11:41,079
know Jamie didn't have enough time to

321
00:11:39,040 --> 00:11:44,170
properly step back and take a look at

322
00:11:41,079 --> 00:11:45,489
what the problem was second thing we

323
00:11:44,170 --> 00:11:48,069
need from this common language is we

324
00:11:45,490 --> 00:11:50,560
need to be able to have it articulate at

325
00:11:48,070 --> 00:11:52,839
a specific enough level that it's

326
00:11:50,560 --> 00:11:54,790
repeatable so what was what happened has

327
00:11:52,839 --> 00:11:57,339
to be repeatable from one event to the

328
00:11:54,790 --> 00:11:59,349
next and in doing so we're sort of

329
00:11:57,339 --> 00:12:01,060
moving away from like the art of this to

330
00:11:59,350 --> 00:12:03,430
this more science and repeatable fashion

331
00:12:01,060 --> 00:12:07,000
so now we can start creating metrics for

332
00:12:03,430 --> 00:12:09,010
ourselves how we how we performed last

333
00:12:07,000 --> 00:12:11,140
year versus this year what new things we

334
00:12:09,010 --> 00:12:12,550
introduced into our environment if it

335
00:12:11,140 --> 00:12:16,240
worked or didn't and basically see how

336
00:12:12,550 --> 00:12:19,870
well we're doing so how what what do we

337
00:12:16,240 --> 00:12:22,180
use personally for this common language

338
00:12:19,870 --> 00:12:25,180
well we use miters adversarial tactics

339
00:12:22,180 --> 00:12:28,300
techniques and common language or more

340
00:12:25,180 --> 00:12:29,529
commonly referred to as attack so just a

341
00:12:28,300 --> 00:12:32,680
quick show of hands you cannot can't

342
00:12:29,529 --> 00:12:34,470
really see too many people who here's at

343
00:12:32,680 --> 00:12:39,000
least familiar with attack or

344
00:12:34,470 --> 00:12:42,120
use dinner okay awesome thanks so what

345
00:12:39,000 --> 00:12:44,399
is attack attack is a globally

346
00:12:42,120 --> 00:12:48,199
accessible knowledge base of adversary

347
00:12:44,399 --> 00:12:52,079
tactics techniques and common knowledge

348
00:12:48,199 --> 00:12:54,149
but it's based on things we've seen in

349
00:12:52,079 --> 00:12:55,949
the wild that adversaries have actually

350
00:12:54,149 --> 00:12:58,769
done so things we see in threat Intel

351
00:12:55,949 --> 00:13:00,449
reports I think you know if specific a

352
00:12:58,769 --> 00:13:03,360
PT's been known to do something or maybe

353
00:13:00,449 --> 00:13:05,310
someones reverse engineered a piece of

354
00:13:03,360 --> 00:13:07,439
malware and it was known and performed

355
00:13:05,310 --> 00:13:09,268
like function a B and C that is what

356
00:13:07,439 --> 00:13:10,790
ends up in the tack we take a look at

357
00:13:09,269 --> 00:13:14,040
that and with the help of the community

358
00:13:10,790 --> 00:13:16,500
we've created this this framework where

359
00:13:14,040 --> 00:13:19,079
you can find across 11 tactics and I'll

360
00:13:16,500 --> 00:13:21,750
explain that in a quick second how it's

361
00:13:19,079 --> 00:13:23,489
organized but but yeah basically our

362
00:13:21,750 --> 00:13:26,579
real-world observations of adversaries

363
00:13:23,490 --> 00:13:28,290
and increasingly more and more so the

364
00:13:26,579 --> 00:13:29,910
communities has been starting to use

365
00:13:28,290 --> 00:13:31,019
this as a common language and we've

366
00:13:29,910 --> 00:13:35,550
already started to see some really good

367
00:13:31,019 --> 00:13:37,740
results oh and it is also available at

368
00:13:35,550 --> 00:13:43,829
attacked at mitre or publicly released

369
00:13:37,740 --> 00:13:45,329
and everything so once you actually go

370
00:13:43,829 --> 00:13:48,630
there you're presented with this attack

371
00:13:45,329 --> 00:13:50,910
matrix over here across the top in the

372
00:13:48,630 --> 00:13:53,100
blue row the first row that is what a

373
00:13:50,910 --> 00:13:56,130
tactic is that's basically the

374
00:13:53,100 --> 00:13:57,689
adversaries technical goal or the why so

375
00:13:56,130 --> 00:13:58,199
why is it they're doing what they're

376
00:13:57,689 --> 00:14:00,839
doing

377
00:13:58,199 --> 00:14:03,479
now under each tactic you have a series

378
00:14:00,839 --> 00:14:05,610
of so along the columns you have the

379
00:14:03,480 --> 00:14:08,220
series of techniques this is basically

380
00:14:05,610 --> 00:14:12,600
what the adversary is actually doing to

381
00:14:08,220 --> 00:14:14,370
achieve that goal so that's the what we

382
00:14:12,600 --> 00:14:17,790
have 11 different texts across the top

383
00:14:14,370 --> 00:14:20,899
and we have I believe over 217

384
00:14:17,790 --> 00:14:24,449
techniques at this point and it's just

385
00:14:20,899 --> 00:14:27,000
growing by the day but up until recently

386
00:14:24,449 --> 00:14:29,519
our most recent added tactic was the

387
00:14:27,000 --> 00:14:31,050
initial access tactic but before that it

388
00:14:29,519 --> 00:14:32,730
was all and I'll read some of these

389
00:14:31,050 --> 00:14:34,829
across the top this you have execution

390
00:14:32,730 --> 00:14:36,899
persistence privilege escalation defense

391
00:14:34,829 --> 00:14:39,120
evasion credential access discovery

392
00:14:36,899 --> 00:14:42,500
lateral movement collection exfiltration

393
00:14:39,120 --> 00:14:42,500
and finally command and control

394
00:14:42,520 --> 00:14:46,180
you could start to see a pattern

395
00:14:43,990 --> 00:14:48,760
emerging from that in that this is all

396
00:14:46,180 --> 00:14:50,199
mostly post exploit with you know

397
00:14:48,760 --> 00:14:51,790
basically taking an assumed breach

398
00:14:50,200 --> 00:14:53,410
mentality so the vet verse area is

399
00:14:51,790 --> 00:14:55,510
already in your network this is how you

400
00:14:53,410 --> 00:14:57,699
can move about as an adversary within

401
00:14:55,510 --> 00:14:59,380
the network or you know persist or you

402
00:14:57,700 --> 00:15:02,200
know perform your actions and object

403
00:14:59,380 --> 00:15:07,360
list and the initial axis starts to blur

404
00:15:02,200 --> 00:15:08,970
that sort of post exploit line but if we

405
00:15:07,360 --> 00:15:11,590
were to click on one of the techniques

406
00:15:08,970 --> 00:15:14,920
specifically the new service under

407
00:15:11,590 --> 00:15:16,570
persistence this is what you start to

408
00:15:14,920 --> 00:15:17,949
see this is just a brief amount of data

409
00:15:16,570 --> 00:15:19,870
there's much more in the actual website

410
00:15:17,950 --> 00:15:22,510
but the first thing we start off is

411
00:15:19,870 --> 00:15:25,330
describing how this actual technique so

412
00:15:22,510 --> 00:15:28,000
a new service within Windows how that is

413
00:15:25,330 --> 00:15:29,260
actually used legitimately why it's

414
00:15:28,000 --> 00:15:30,910
actually brought out and windows why

415
00:15:29,260 --> 00:15:33,040
it's there and like how someone like

416
00:15:30,910 --> 00:15:36,040
maybe an IT admin or the Windows system

417
00:15:33,040 --> 00:15:38,170
itself uses us legitimately we then move

418
00:15:36,040 --> 00:15:41,469
into how adversaries actually have used

419
00:15:38,170 --> 00:15:42,610
this for their own gain we have some

420
00:15:41,470 --> 00:15:43,870
data about there about like what

421
00:15:42,610 --> 00:15:45,820
platforms you find this what the

422
00:15:43,870 --> 00:15:47,440
required permissions and effective

423
00:15:45,820 --> 00:15:49,180
permissions and then we move into the

424
00:15:47,440 --> 00:15:52,060
detection and mitigation how you would

425
00:15:49,180 --> 00:15:55,000
detect or mitigate this specific TTP as

426
00:15:52,060 --> 00:15:56,859
a red teamer this is a really good place

427
00:15:55,000 --> 00:15:58,990
for you to be paying attention to

428
00:15:56,860 --> 00:16:00,820
because this is you could start to see

429
00:15:58,990 --> 00:16:03,070
what the you know what the blue team's

430
00:16:00,820 --> 00:16:04,600
PlayBook would be against a specific TTP

431
00:16:03,070 --> 00:16:07,090
of yours this is basically building into

432
00:16:04,600 --> 00:16:09,910
your OPSEC and providing you who means

433
00:16:07,090 --> 00:16:12,310
to sort of maybe measure up against a

434
00:16:09,910 --> 00:16:13,449
one TTP over another and you know how

435
00:16:12,310 --> 00:16:15,280
easy it is you think you'll be the

436
00:16:13,450 --> 00:16:18,310
detect depending on how mature that

437
00:16:15,280 --> 00:16:19,870
network is of course furthermore if you

438
00:16:18,310 --> 00:16:21,729
look at a specific tactic let's say

439
00:16:19,870 --> 00:16:23,080
lateral movement and you realize that

440
00:16:21,730 --> 00:16:24,550
you only know how to do when you only

441
00:16:23,080 --> 00:16:26,260
have the tooling and tested the tooling

442
00:16:24,550 --> 00:16:27,790
for one of them you can see what else is

443
00:16:26,260 --> 00:16:28,870
available there and see whether or not

444
00:16:27,790 --> 00:16:30,730
that works in the environment that

445
00:16:28,870 --> 00:16:33,400
you're going up against so it provides

446
00:16:30,730 --> 00:16:38,500
you that sort of wet and breadth and

447
00:16:33,400 --> 00:16:40,240
width of techniques in this case finally

448
00:16:38,500 --> 00:16:42,160
and also really interesting and

449
00:16:40,240 --> 00:16:44,800
importantly to me at least are the

450
00:16:42,160 --> 00:16:46,240
examples as I said all this is based on

451
00:16:44,800 --> 00:16:49,390
real adversaries what we've seen them

452
00:16:46,240 --> 00:16:50,650
really do so in this case we point we

453
00:16:49,390 --> 00:16:53,260
have you know all the way recite

454
00:16:50,650 --> 00:16:55,040
backwards to all the different reports

455
00:16:53,260 --> 00:16:56,360
that we've seen different

456
00:16:55,040 --> 00:16:58,730
groups and different adversaries

457
00:16:56,360 --> 00:17:00,860
actually use this technique whether they

458
00:16:58,730 --> 00:17:02,389
did it on the command line or a piece of

459
00:17:00,860 --> 00:17:04,730
their software actually has it as a

460
00:17:02,389 --> 00:17:07,459
built in as a function but either way we

461
00:17:04,730 --> 00:17:10,040
have this we have them all linked at the

462
00:17:07,459 --> 00:17:11,390
example sort of section and if you go

463
00:17:10,040 --> 00:17:13,609
where to go there and follow that thread

464
00:17:11,390 --> 00:17:15,410
you'll start to see exactly how they

465
00:17:13,609 --> 00:17:16,969
implemented this technique and that'll

466
00:17:15,410 --> 00:17:18,140
give you guys information on how you

467
00:17:16,970 --> 00:17:19,790
would be able to implement that

468
00:17:18,140 --> 00:17:21,199
technique as well there's a lot of ways

469
00:17:19,790 --> 00:17:23,928
to implement the technique it's not just

470
00:17:21,199 --> 00:17:25,220
all one and this is one of the places

471
00:17:23,929 --> 00:17:32,059
where you can start building out that

472
00:17:25,220 --> 00:17:33,260
arsenal of yours so so far what we've

473
00:17:32,059 --> 00:17:34,760
seen so far is mostly been just for

474
00:17:33,260 --> 00:17:38,410
enterprise windows

475
00:17:34,760 --> 00:17:41,450
basically like a Active Directory domain

476
00:17:38,410 --> 00:17:44,770
focused but we also thanks to Cody have

477
00:17:41,450 --> 00:17:47,480
now Linux and Mac attack also we've

478
00:17:44,770 --> 00:17:50,570
released the the Android and iOS and

479
00:17:47,480 --> 00:17:53,030
also even more so we went a little bit

480
00:17:50,570 --> 00:17:54,678
left of exploit and focused on some of

481
00:17:53,030 --> 00:17:56,928
those behaviors with gtps with pre

482
00:17:54,679 --> 00:17:58,940
attack so those are some of the extra

483
00:17:56,929 --> 00:18:03,350
ones that are the extra domains that

484
00:17:58,940 --> 00:18:04,970
attack focus is on there's many

485
00:18:03,350 --> 00:18:06,260
different use cases for attack but I'm

486
00:18:04,970 --> 00:18:08,270
not really going to go into many of them

487
00:18:06,260 --> 00:18:09,530
and I'm gonna just sort of jump to that

488
00:18:08,270 --> 00:18:12,408
fourth one right there which is

489
00:18:09,530 --> 00:18:15,080
adversary emulation how can we use

490
00:18:12,409 --> 00:18:17,570
attack to actually emulate adversaries

491
00:18:15,080 --> 00:18:19,340
and emulate specific adversaries and

492
00:18:17,570 --> 00:18:25,428
that's gonna be the what the rest of our

493
00:18:19,340 --> 00:18:28,459
presentations actually about so what is

494
00:18:25,429 --> 00:18:29,870
adversary emulation there's a lot of

495
00:18:28,460 --> 00:18:32,600
different you there's a lot of different

496
00:18:29,870 --> 00:18:34,729
you know words or names for you know

497
00:18:32,600 --> 00:18:36,260
some of the newest flavor of offensive

498
00:18:34,730 --> 00:18:39,140
testing can be and you know penetration

499
00:18:36,260 --> 00:18:41,210
testing or you know red teaming or

500
00:18:39,140 --> 00:18:43,130
purple teaming or adversary simulation

501
00:18:41,210 --> 00:18:45,200
emulation etc what we really mean by

502
00:18:43,130 --> 00:18:47,510
adversary emulation is just sort of

503
00:18:45,200 --> 00:18:49,370
honest-to-goodness threat based red

504
00:18:47,510 --> 00:18:50,960
teaming so when we perform our red

505
00:18:49,370 --> 00:18:55,239
actions we're coming in with a threat

506
00:18:50,960 --> 00:18:59,750
flavour this provides us quite a bit of

507
00:18:55,240 --> 00:19:01,700
benefits in doing so the first one is as

508
00:18:59,750 --> 00:19:04,100
I said there was about 200 overtone

509
00:19:01,700 --> 00:19:06,610
techniques in attack this provides both

510
00:19:04,100 --> 00:19:08,590
red and blue a way to start prioritizing

511
00:19:06,610 --> 00:19:12,010
what defenses to start building out

512
00:19:08,590 --> 00:19:14,678
against which techniques if you realize

513
00:19:12,010 --> 00:19:16,450
if you were to for example be really

514
00:19:14,679 --> 00:19:18,460
interested in a specific apt you could

515
00:19:16,450 --> 00:19:20,350
follow their MO and try to understand

516
00:19:18,460 --> 00:19:22,360
how they're actually you know

517
00:19:20,350 --> 00:19:23,980
transitioning from the initial access

518
00:19:22,360 --> 00:19:25,570
all the way through their action on an

519
00:19:23,980 --> 00:19:27,520
objective all the way at the end and

520
00:19:25,570 --> 00:19:30,399
what their objective actually is because

521
00:19:27,520 --> 00:19:31,809
I mean not everyone's final objectives

522
00:19:30,400 --> 00:19:33,340
to get domain admin they could be

523
00:19:31,809 --> 00:19:35,139
they're just a steal data for example or

524
00:19:33,340 --> 00:19:40,889
just persist and wait until something

525
00:19:35,140 --> 00:19:44,140
happens at a later time but the but and

526
00:19:40,890 --> 00:19:46,750
basically when you enter when you would

527
00:19:44,140 --> 00:19:48,309
when you're approached with the task of

528
00:19:46,750 --> 00:19:51,070
adversary emulation you don't want to

529
00:19:48,309 --> 00:19:53,470
just show up as just a general regular

530
00:19:51,070 --> 00:19:56,080
you know advanced adversary or like you

531
00:19:53,470 --> 00:20:00,940
know maybe act like an apt we want to be

532
00:19:56,080 --> 00:20:03,428
a very specific one and a very specific

533
00:20:00,940 --> 00:20:06,820
apt because there's also something to

534
00:20:03,429 --> 00:20:08,980
gain from doing that and that is you'd

535
00:20:06,820 --> 00:20:11,500
be able to map that or you'd be able to

536
00:20:08,980 --> 00:20:13,030
give the blue team experience I guess an

537
00:20:11,500 --> 00:20:15,370
adversary they may actually be up

538
00:20:13,030 --> 00:20:16,960
against so for example if they're in a

539
00:20:15,370 --> 00:20:19,719
specific industry that's known to be

540
00:20:16,960 --> 00:20:22,150
targeted by a specific type of apt maybe

541
00:20:19,720 --> 00:20:24,280
or an adversary like maybe a country

542
00:20:22,150 --> 00:20:27,820
specific one I try and identify what

543
00:20:24,280 --> 00:20:30,100
that specific adversary does in terms of

544
00:20:27,820 --> 00:20:31,990
TTP's and their mo you can be able to

545
00:20:30,100 --> 00:20:34,600
give your blue team's you can be able to

546
00:20:31,990 --> 00:20:38,260
exercise them you know without actually

547
00:20:34,600 --> 00:20:43,030
detonating some real apt binaries on

548
00:20:38,260 --> 00:20:45,040
your machines so speaking of which

549
00:20:43,030 --> 00:20:46,570
something we've released to basically

550
00:20:45,040 --> 00:20:50,409
help everyone bootstrap into this

551
00:20:46,570 --> 00:20:52,689
adversarial relationship or o-type for

552
00:20:50,410 --> 00:20:54,669
adversary emulation this is an A to Z

553
00:20:52,690 --> 00:20:56,470
plan that you guys can take it'll give

554
00:20:54,669 --> 00:20:59,440
you all information you need well most

555
00:20:56,470 --> 00:21:02,080
of it on how to emulate apt three within

556
00:20:59,440 --> 00:21:04,480
your network so we go through identify

557
00:21:02,080 --> 00:21:05,379
all the tooling that they've used or

558
00:21:04,480 --> 00:21:08,799
most of the tooling that they've used

559
00:21:05,380 --> 00:21:10,150
and we go through all the Intel our

560
00:21:08,799 --> 00:21:11,799
about you know the different kinds of

561
00:21:10,150 --> 00:21:14,940
reverse engineering and you know what's

562
00:21:11,799 --> 00:21:17,710
been seen by the incident response teams

563
00:21:14,940 --> 00:21:19,070
responding to this apt and we also

564
00:21:17,710 --> 00:21:21,230
present you guys

565
00:21:19,070 --> 00:21:23,090
are present in the emulation plan

566
00:21:21,230 --> 00:21:24,830
different ways to emulate that with your

567
00:21:23,090 --> 00:21:27,620
own tooling be it on the command line or

568
00:21:24,830 --> 00:21:29,750
open source things and it's available

569
00:21:27,620 --> 00:21:31,729
over here under the on the attack

570
00:21:29,750 --> 00:21:33,620
website under adversary emulation plans

571
00:21:31,730 --> 00:21:35,600
and that is actually what Cody will be

572
00:21:33,620 --> 00:21:38,629
going into a little more detail after I

573
00:21:35,600 --> 00:21:40,908
start there are after I hand it over but

574
00:21:38,630 --> 00:21:42,620
all right so now we we've provided you

575
00:21:40,909 --> 00:21:44,539
guys with apt 3 but what if that's not

576
00:21:42,620 --> 00:21:46,779
necessarily you know something you're

577
00:21:44,539 --> 00:21:49,340
interested in maybe you work for a

578
00:21:46,779 --> 00:21:52,669
financial company or in the financial

579
00:21:49,340 --> 00:21:54,439
sector maybe one of the fin sticks the

580
00:21:52,669 --> 00:21:56,539
Financial Group's off in six or sinston

581
00:21:54,440 --> 00:21:59,360
the fin seven would be more apt for you

582
00:21:56,539 --> 00:22:01,610
to actually emulate this gives you a

583
00:21:59,360 --> 00:22:04,070
better story to be able to actually sell

584
00:22:01,610 --> 00:22:06,529
it is what is sell you're basically what

585
00:22:04,070 --> 00:22:08,330
your job is but you know again go

586
00:22:06,529 --> 00:22:10,159
eluding back to being able to exercise

587
00:22:08,330 --> 00:22:12,860
the blue team against a potential real

588
00:22:10,159 --> 00:22:15,140
threat and do things as the apt would

589
00:22:12,860 --> 00:22:17,330
specifically do so you don't identify

590
00:22:15,140 --> 00:22:19,340
what adversary would actually be

591
00:22:17,330 --> 00:22:21,520
targeting the networks that you're

592
00:22:19,340 --> 00:22:24,080
targeting and attempt to match that up

593
00:22:21,520 --> 00:22:25,429
so once you've actually done this and

594
00:22:24,080 --> 00:22:29,600
once you've identified the adversary

595
00:22:25,429 --> 00:22:30,740
that you want to emulate I'm gonna hand

596
00:22:29,600 --> 00:22:33,289
it open to Cody and he's gonna show you

597
00:22:30,740 --> 00:22:35,899
how through with five steps go ahead and

598
00:22:33,289 --> 00:22:37,279
emulate that adversary so Chris has

599
00:22:35,899 --> 00:22:38,779
already kind of talked to you about the

600
00:22:37,279 --> 00:22:40,460
background of attack how we go about

601
00:22:38,779 --> 00:22:42,620
approaching this what is adversary

602
00:22:40,460 --> 00:22:44,210
emulation all that sort of stuff but I

603
00:22:42,620 --> 00:22:46,279
like to kind of ground everything in

604
00:22:44,210 --> 00:22:48,409
examples and kind of walk you through it

605
00:22:46,279 --> 00:22:50,299
so over the next rest this presentation

606
00:22:48,409 --> 00:22:52,460
I'm gonna be going through Rab t3

607
00:22:50,299 --> 00:22:54,168
emulation plan how he came about it what

608
00:22:52,460 --> 00:22:55,669
steps you need to consider how you might

609
00:22:54,169 --> 00:22:57,500
do your tooling and all that sort of

610
00:22:55,669 --> 00:22:59,299
stuff so the first thing as you go

611
00:22:57,500 --> 00:23:01,520
through say you want to emulate a be t3

612
00:22:59,299 --> 00:23:03,529
so now you need to kind of go out and

613
00:23:01,520 --> 00:23:07,490
get the threat Intel on that adversary

614
00:23:03,529 --> 00:23:08,720
it's a little bit hard based off of just

615
00:23:07,490 --> 00:23:10,549
kind of the threat landscape that's out

616
00:23:08,720 --> 00:23:12,080
there right now so there's a couple

617
00:23:10,549 --> 00:23:15,139
things that you have to consider as you

618
00:23:12,080 --> 00:23:16,668
go about doing this so for example if

619
00:23:15,140 --> 00:23:18,230
you want to look for apt three you can

620
00:23:16,669 --> 00:23:20,000
google for abt three or look at your

621
00:23:18,230 --> 00:23:23,029
paid for Intel feeds or anything like

622
00:23:20,000 --> 00:23:25,010
that but you can't just stop there so

623
00:23:23,029 --> 00:23:26,390
there's kind of a hot topic in the

624
00:23:25,010 --> 00:23:29,030
threat Intel community right now about

625
00:23:26,390 --> 00:23:31,159
aliases for different adversaries and

626
00:23:29,030 --> 00:23:31,840
groups and operations and all the sorts

627
00:23:31,159 --> 00:23:33,430
of stuff

628
00:23:31,840 --> 00:23:35,020
so you have to keep that in mind as you

629
00:23:33,430 --> 00:23:37,180
go through and do your research into the

630
00:23:35,020 --> 00:23:39,850
specific adversaries because one

631
00:23:37,180 --> 00:23:41,410
adversary may be known by 15 different

632
00:23:39,850 --> 00:23:43,719
aliases across different companies that

633
00:23:41,410 --> 00:23:45,730
are reporting on it additionally as you

634
00:23:43,720 --> 00:23:49,030
go through and see that okay you're

635
00:23:45,730 --> 00:23:50,950
looking at abt 3 but apt 3 uses plug X

636
00:23:49,030 --> 00:23:52,990
and / P and PS exec and all these

637
00:23:50,950 --> 00:23:54,640
different tools you need to continue

638
00:23:52,990 --> 00:23:56,530
doing research into those tools

639
00:23:54,640 --> 00:23:58,090
themselves to kind of get the most bang

640
00:23:56,530 --> 00:24:01,210
for your buck out of what adversary is

641
00:23:58,090 --> 00:24:03,970
doing and of course with the associated

642
00:24:01,210 --> 00:24:06,220
campaigns not only our adversaries tied

643
00:24:03,970 --> 00:24:08,260
to specific instances specific events

644
00:24:06,220 --> 00:24:10,510
but sometimes they're broadened out into

645
00:24:08,260 --> 00:24:12,129
these larger campaigns describing how

646
00:24:10,510 --> 00:24:14,379
they're operating so I'll go ahead and

647
00:24:12,130 --> 00:24:15,550
give an example of this but one thing to

648
00:24:14,380 --> 00:24:17,080
keep in mind as you start googling

649
00:24:15,550 --> 00:24:19,090
around and looking for information is

650
00:24:17,080 --> 00:24:21,250
when these reports are released so

651
00:24:19,090 --> 00:24:22,929
people have been putting out reports and

652
00:24:21,250 --> 00:24:24,280
adversaries for years and years now as

653
00:24:22,930 --> 00:24:26,110
you go through and you start pulling

654
00:24:24,280 --> 00:24:27,610
this threats Intel information to kind

655
00:24:26,110 --> 00:24:29,530
of build your profile for the adversary

656
00:24:27,610 --> 00:24:31,780
you need to think about when the report

657
00:24:29,530 --> 00:24:33,910
was released just like us adversaries

658
00:24:31,780 --> 00:24:36,160
change their tactics over time so if all

659
00:24:33,910 --> 00:24:37,510
of your reports are seven years ago when

660
00:24:36,160 --> 00:24:39,580
you're trying to emulate the adversary

661
00:24:37,510 --> 00:24:40,870
now kind of keep that in mind and try

662
00:24:39,580 --> 00:24:43,419
and think of how things may have changed

663
00:24:40,870 --> 00:24:46,540
over time so if we start actually

664
00:24:43,420 --> 00:24:48,660
looking at some threat reports you will

665
00:24:46,540 --> 00:24:51,370
see here is a simple one from Symantec

666
00:24:48,660 --> 00:24:54,010
and here all I did was Google for apt 3

667
00:24:51,370 --> 00:24:56,679
but right away you can see that they're

668
00:24:54,010 --> 00:25:00,129
also known as Buckeye gothic panda UPS

669
00:24:56,680 --> 00:25:01,630
team threat group 0 1 1 0 if you look if

670
00:25:00,130 --> 00:25:03,580
you start googling even those you'll see

671
00:25:01,630 --> 00:25:06,670
operation double tap operation

672
00:25:03,580 --> 00:25:09,129
clandestine Fox UPS like all these sorts

673
00:25:06,670 --> 00:25:12,070
of things start quickly bubbling up to

674
00:25:09,130 --> 00:25:14,620
the front of each other so even as you

675
00:25:12,070 --> 00:25:17,260
keep going you'll see sometimes here's

676
00:25:14,620 --> 00:25:19,179
an example where a BT 3 gothic panda we

677
00:25:17,260 --> 00:25:21,730
already saw but they're also referring

678
00:25:19,180 --> 00:25:24,970
to this group as per P now per P is

679
00:25:21,730 --> 00:25:26,470
actually one of 83 malware samples so

680
00:25:24,970 --> 00:25:28,660
there's already some completing going on

681
00:25:26,470 --> 00:25:30,520
between what the the group is doing and

682
00:25:28,660 --> 00:25:31,570
what the tools can do so this is just

683
00:25:30,520 --> 00:25:33,250
something you have to kind of keep in

684
00:25:31,570 --> 00:25:36,149
mind and really research as you go

685
00:25:33,250 --> 00:25:39,040
through looking at these these reports

686
00:25:36,150 --> 00:25:40,840
so once you get all these reports you

687
00:25:39,040 --> 00:25:42,700
start googling you follow the name look

688
00:25:40,840 --> 00:25:45,399
at Google this other term you get all

689
00:25:42,700 --> 00:25:46,260
this stuff together now what what are

690
00:25:45,400 --> 00:25:48,400
you supposed to do from

691
00:25:46,260 --> 00:25:50,200
so in this part we're actually going to

692
00:25:48,400 --> 00:25:52,090
start going through those reports and

693
00:25:50,200 --> 00:25:53,980
looking to see what are the adversary's

694
00:25:52,090 --> 00:25:56,740
behavior what is the behavior of the

695
00:25:53,980 --> 00:25:58,600
tools they can do if possible and not

696
00:25:56,740 --> 00:26:00,159
always possible from strictly open

697
00:25:58,600 --> 00:26:02,230
source intelligence but trying to figure

698
00:26:00,159 --> 00:26:04,090
out what motivates the adversary what is

699
00:26:02,230 --> 00:26:06,279
it they're looking for what's their MO

700
00:26:04,090 --> 00:26:07,720
how do they operate on a network even

701
00:26:06,279 --> 00:26:09,429
once you get on a network not every

702
00:26:07,720 --> 00:26:11,200
adversary is gonna look for the same

703
00:26:09,429 --> 00:26:13,690
thing move the same way have the same

704
00:26:11,200 --> 00:26:14,830
kinds of infrastructure and as you start

705
00:26:13,690 --> 00:26:16,840
going through this and this is why I

706
00:26:14,830 --> 00:26:18,668
like using attack for this you start to

707
00:26:16,840 --> 00:26:20,830
think about the what the why and the how

708
00:26:18,669 --> 00:26:22,419
what it is they're doing this is the

709
00:26:20,830 --> 00:26:24,279
specific technique and attack that

710
00:26:22,419 --> 00:26:26,080
they're doing why they're doing it that

711
00:26:24,279 --> 00:26:28,510
goes back to that tactic level what are

712
00:26:26,080 --> 00:26:31,029
they trying to achieve and then the like

713
00:26:28,510 --> 00:26:32,500
nitty-gritty detail part that how what's

714
00:26:31,029 --> 00:26:33,940
the specific implementation of what

715
00:26:32,500 --> 00:26:36,130
they're doing and this is where you can

716
00:26:33,940 --> 00:26:38,080
get a lot of nice variation to help you

717
00:26:36,130 --> 00:26:41,740
as the offensive team and to help the

718
00:26:38,080 --> 00:26:44,408
defenders build up their analytics so

719
00:26:41,740 --> 00:26:46,779
there are three main kinds of reporting

720
00:26:44,409 --> 00:26:48,279
that I usually see as we go through and

721
00:26:46,779 --> 00:26:50,770
trying to pull out techniques for us to

722
00:26:48,279 --> 00:26:52,990
do adversary emulation we get this kind

723
00:26:50,770 --> 00:26:54,820
that and I'll step into this little bit

724
00:26:52,990 --> 00:26:57,429
more but we get this kind that's more of

725
00:26:54,820 --> 00:26:59,320
a prose writing paragraph after

726
00:26:57,429 --> 00:27:02,799
paragraph of somebody describing what's

727
00:26:59,320 --> 00:27:04,360
happening sometimes in the next example

728
00:27:02,799 --> 00:27:06,309
I'll show that we get a little bit more

729
00:27:04,360 --> 00:27:08,049
in-depth of a specific binary so

730
00:27:06,309 --> 00:27:10,210
somebody taking an instance of purpie

731
00:27:08,049 --> 00:27:11,529
and doing malware analysis on it running

732
00:27:10,210 --> 00:27:13,870
strings on it and providing that

733
00:27:11,529 --> 00:27:16,120
information back and the last kind is

734
00:27:13,870 --> 00:27:18,070
somewhere in between where we get a bit

735
00:27:16,120 --> 00:27:20,168
of information on specific pieces of

736
00:27:18,070 --> 00:27:24,010
malware that are used and details about

737
00:27:20,169 --> 00:27:25,720
them but more in a prose style so if you

738
00:27:24,010 --> 00:27:27,610
see this sort of blob in your reporting

739
00:27:25,720 --> 00:27:29,740
and you try to figure okay I'm the red

740
00:27:27,610 --> 00:27:31,000
teamer this is just a threat in teleport

741
00:27:29,740 --> 00:27:33,640
what am I supposed to gather from this

742
00:27:31,000 --> 00:27:35,919
how do I use it so you can start looking

743
00:27:33,640 --> 00:27:38,289
through the data and trying to pull out

744
00:27:35,919 --> 00:27:40,929
remember the what the why and the how so

745
00:27:38,289 --> 00:27:43,120
you can see here already that we're

746
00:27:40,929 --> 00:27:45,789
looking at a CV e4 pillage escalation

747
00:27:43,120 --> 00:27:48,428
they're trying to do an exploit the fact

748
00:27:45,789 --> 00:27:50,289
that it's CVE 2014 for one one three

749
00:27:48,429 --> 00:27:52,120
doesn't matter as much as the fact of

750
00:27:50,289 --> 00:27:53,799
the behavior they're using exploits on

751
00:27:52,120 --> 00:27:56,080
the system this is compared to maybe

752
00:27:53,799 --> 00:27:56,668
doing a path interception or overwriting

753
00:27:56,080 --> 00:27:58,019
files

754
00:27:56,669 --> 00:28:00,059
system this sort of stuff it gives you

755
00:27:58,019 --> 00:28:01,409
an idea of what kinds of stuff they're

756
00:28:00,059 --> 00:28:03,749
doing trying to get more towards their

757
00:28:01,409 --> 00:28:06,239
behavior you can also see other things

758
00:28:03,749 --> 00:28:07,830
like here we have CMD waxey Who am I

759
00:28:06,239 --> 00:28:09,809
this tells you a couple of things

760
00:28:07,830 --> 00:28:10,980
already right off the bat first that

761
00:28:09,809 --> 00:28:13,109
they're doing things on the command line

762
00:28:10,980 --> 00:28:14,909
so they're not not strictly doing

763
00:28:13,109 --> 00:28:17,158
everything with api's having their own

764
00:28:14,909 --> 00:28:18,539
things installed on the system they're

765
00:28:17,159 --> 00:28:20,730
using some of the kind of live off the

766
00:28:18,539 --> 00:28:21,840
land stuff that we see when you can see

767
00:28:20,730 --> 00:28:23,039
what them doing Who am I

768
00:28:21,840 --> 00:28:24,480
they're trying to do a little bit of

769
00:28:23,039 --> 00:28:26,669
discovery to see where they are what

770
00:28:24,480 --> 00:28:27,929
kind of permissions they have as we

771
00:28:26,669 --> 00:28:29,759
continue on you can see things like

772
00:28:27,929 --> 00:28:32,159
running scheduled tasks to create

773
00:28:29,759 --> 00:28:33,749
persistence and this is something you

774
00:28:32,159 --> 00:28:35,039
know what kind of resistance they're

775
00:28:33,749 --> 00:28:35,999
trying to get whether it's usually in

776
00:28:35,039 --> 00:28:38,070
persistence whether they're getting

777
00:28:35,999 --> 00:28:39,779
elevated persistence here you can see

778
00:28:38,070 --> 00:28:41,070
that they're specifically running a

779
00:28:39,779 --> 00:28:43,289
system so it's more of an elevated

780
00:28:41,070 --> 00:28:44,549
persistence and one of the things you'll

781
00:28:43,289 --> 00:28:45,869
notice as you go through and start

782
00:28:44,549 --> 00:28:49,379
looking at all this throughout Intel

783
00:28:45,869 --> 00:28:51,720
reporting is it's kind of biased towards

784
00:28:49,379 --> 00:28:53,340
what is seen when people come in to do

785
00:28:51,720 --> 00:28:55,379
the remediation so lots of this stuff

786
00:28:53,340 --> 00:28:57,178
comes out as people figure out that

787
00:28:55,379 --> 00:28:59,070
they're hacked in some way and then

788
00:28:57,179 --> 00:29:01,320
somebody comes in triage is it helps fix

789
00:28:59,070 --> 00:29:02,668
the system kick out the bad guy so in

790
00:29:01,320 --> 00:29:03,749
that last part where you actually have

791
00:29:02,669 --> 00:29:06,179
the company coming and that's going to

792
00:29:03,749 --> 00:29:07,499
be doing the reporting there's a subset

793
00:29:06,179 --> 00:29:09,269
of attack that they're more likely to

794
00:29:07,499 --> 00:29:11,009
see than others and part of this being

795
00:29:09,269 --> 00:29:12,840
like see two channels persistence

796
00:29:11,009 --> 00:29:14,609
mechanisms that sort of stuff rather

797
00:29:12,840 --> 00:29:17,369
than maybe what a user is sitting doing

798
00:29:14,609 --> 00:29:19,019
on command line in volatile memory that

799
00:29:17,369 --> 00:29:21,629
depending on when the internet response

800
00:29:19,019 --> 00:29:22,649
team comes in maybe along gone so

801
00:29:21,629 --> 00:29:25,259
because of this you'll start to see

802
00:29:22,649 --> 00:29:28,258
things talking about see two channels

803
00:29:25,259 --> 00:29:30,480
way way more often than others and here

804
00:29:28,259 --> 00:29:32,220
we can see an example of just raw

805
00:29:30,480 --> 00:29:34,980
connections out to specific ports that

806
00:29:32,220 --> 00:29:37,350
aren't very common and specifically this

807
00:29:34,980 --> 00:29:38,369
one goes more in-depth into okay that

808
00:29:37,350 --> 00:29:40,049
you have this connection

809
00:29:38,369 --> 00:29:42,600
what are they sending are they sending

810
00:29:40,049 --> 00:29:44,340
strings is it just another protocol over

811
00:29:42,600 --> 00:29:45,869
this random port here they're actually

812
00:29:44,340 --> 00:29:47,609
defining their own custom command

813
00:29:45,869 --> 00:29:48,959
control protocol so it kind of gives you

814
00:29:47,609 --> 00:29:49,949
an idea of the kind of stuff that you're

815
00:29:48,960 --> 00:29:51,869
going to have to do if you want to

816
00:29:49,950 --> 00:29:54,149
emulate this adversary you can't just

817
00:29:51,869 --> 00:29:56,189
simply run PowerShell with you know

818
00:29:54,149 --> 00:29:57,389
restful api is and gonna look like this

819
00:29:56,190 --> 00:30:00,119
adversary you have to think a little bit

820
00:29:57,389 --> 00:30:01,799
more about it so the second example I

821
00:30:00,119 --> 00:30:03,840
was talking about is you get a little

822
00:30:01,799 --> 00:30:06,200
bit more in depth detail into specific

823
00:30:03,840 --> 00:30:08,189
instance of binaries here we see

824
00:30:06,200 --> 00:30:10,140
somebody went through and did a

825
00:30:08,190 --> 00:30:12,240
presentation specifically on perky

826
00:30:10,140 --> 00:30:13,470
and in one of the copies they found they

827
00:30:12,240 --> 00:30:14,850
dumped the strings and found a whole

828
00:30:13,470 --> 00:30:16,140
bunch of Awesome command lines that

829
00:30:14,850 --> 00:30:19,290
people had been running from the binary

830
00:30:16,140 --> 00:30:20,730
and so you can see here already that for

831
00:30:19,290 --> 00:30:22,920
example they're doing commission groups

832
00:30:20,730 --> 00:30:24,870
discovery by trying to see who's admin

833
00:30:22,920 --> 00:30:26,790
where and one interesting thing to note

834
00:30:24,870 --> 00:30:29,250
about this part is you can already see

835
00:30:26,790 --> 00:30:30,840
that there's some redundancy looking at

836
00:30:29,250 --> 00:30:32,820
the local group administrators slash

837
00:30:30,840 --> 00:30:34,260
domain in the net group domain admin /

838
00:30:32,820 --> 00:30:35,939
domain is going to give you a lot of the

839
00:30:34,260 --> 00:30:37,559
same information because both of those

840
00:30:35,940 --> 00:30:40,770
are kind of looking for the elevated

841
00:30:37,559 --> 00:30:42,090
admins across the domain so adversaries

842
00:30:40,770 --> 00:30:43,889
themselves building in this kind of

843
00:30:42,090 --> 00:30:45,990
redundancy should give you a clue that

844
00:30:43,890 --> 00:30:47,880
even us as red teamers trying to do this

845
00:30:45,990 --> 00:30:49,549
sort of adversary emulation having that

846
00:30:47,880 --> 00:30:52,410
in the back of your mind is a good idea

847
00:30:49,549 --> 00:30:54,090
and we can continue on seeing that you

848
00:30:52,410 --> 00:30:55,980
know they're looking for network

849
00:30:54,090 --> 00:30:57,480
connections and remote systems the sort

850
00:30:55,980 --> 00:30:59,160
of stuff that you normally do as part of

851
00:30:57,480 --> 00:31:00,809
your normal red teaming you just maybe

852
00:30:59,160 --> 00:31:03,299
not thinking about it in this in this

853
00:31:00,809 --> 00:31:06,299
way one interesting thing to note with

854
00:31:03,299 --> 00:31:09,270
this sort of analysis that you get in

855
00:31:06,299 --> 00:31:12,210
threat reporting is that for example you

856
00:31:09,270 --> 00:31:14,580
see the C colon a OS the exe in this net

857
00:31:12,210 --> 00:31:16,559
start and stop for a OS now if you just

858
00:31:14,580 --> 00:31:18,540
look at this blindly you may just say

859
00:31:16,559 --> 00:31:20,070
okay the running command-line and they

860
00:31:18,540 --> 00:31:23,280
can start and stop services and you move

861
00:31:20,070 --> 00:31:25,080
on but if you start thinking more into

862
00:31:23,280 --> 00:31:27,270
this what is a OS is this an actual

863
00:31:25,080 --> 00:31:30,360
window service that could exist is it

864
00:31:27,270 --> 00:31:32,070
something they created normally binaries

865
00:31:30,360 --> 00:31:34,139
don't just exist at C colon slash

866
00:31:32,070 --> 00:31:35,939
they're in subdirectories so what's the

867
00:31:34,140 --> 00:31:37,650
purpose of putting a binary right there

868
00:31:35,940 --> 00:31:39,450
up at the front you see this more often

869
00:31:37,650 --> 00:31:40,770
in things like path interception where

870
00:31:39,450 --> 00:31:43,080
there's an uncoded service path that

871
00:31:40,770 --> 00:31:44,790
they're trying to interrupt so that

872
00:31:43,080 --> 00:31:46,799
could be an example here of having to

873
00:31:44,790 --> 00:31:49,678
dig a little bit deeper into this kind

874
00:31:46,799 --> 00:31:52,379
of non prose style just dump of data

875
00:31:49,679 --> 00:31:54,330
about a binary then of course you know

876
00:31:52,380 --> 00:31:56,400
you have more of your common discovering

877
00:31:54,330 --> 00:31:58,080
processes file deletions that's what the

878
00:31:56,400 --> 00:31:59,820
stuff that you're you see more in

879
00:31:58,080 --> 00:32:01,590
advanced adversaries trying to clean up

880
00:31:59,820 --> 00:32:03,299
from this up from themselves doing more

881
00:32:01,590 --> 00:32:06,689
discovery trying to get better awareness

882
00:32:03,299 --> 00:32:08,820
of the system and so the last kind of

883
00:32:06,690 --> 00:32:10,830
threat Intel report that I was talking

884
00:32:08,820 --> 00:32:12,480
about is somewhere in between the two so

885
00:32:10,830 --> 00:32:14,879
it's not just a straight-up blob of text

886
00:32:12,480 --> 00:32:18,030
talking about things but it's more than

887
00:32:14,880 --> 00:32:19,500
just one specific binary so here they're

888
00:32:18,030 --> 00:32:21,170
breaking out three different tools that

889
00:32:19,500 --> 00:32:24,320
they've seen a keylogger or

890
00:32:21,170 --> 00:32:25,970
CMD tool and a PWM variant and with

891
00:32:24,320 --> 00:32:28,040
these you know sometimes you get some of

892
00:32:25,970 --> 00:32:29,360
your standard your key logger records

893
00:32:28,040 --> 00:32:31,580
keystrokes go figure

894
00:32:29,360 --> 00:32:33,889
so obviously input capture then you get

895
00:32:31,580 --> 00:32:35,510
some sort of you know additional sneak

896
00:32:33,890 --> 00:32:37,280
peeks into things like oh okay

897
00:32:35,510 --> 00:32:38,780
no only is it recording keystrokes and

898
00:32:37,280 --> 00:32:40,250
they're not saving them into memory

899
00:32:38,780 --> 00:32:41,899
they're dumping them out into encrypted

900
00:32:40,250 --> 00:32:43,280
files so this kind of gives you an idea

901
00:32:41,900 --> 00:32:45,230
of other things that you might think

902
00:32:43,280 --> 00:32:47,240
about the system if you're going through

903
00:32:45,230 --> 00:32:49,160
and doing normal red teaming type things

904
00:32:47,240 --> 00:32:50,990
especially these days you tend to be

905
00:32:49,160 --> 00:32:52,880
more hesitant to touch disk at all

906
00:32:50,990 --> 00:32:54,380
anything you can do in memory is fine

907
00:32:52,880 --> 00:32:56,270
but as you go through you see

908
00:32:54,380 --> 00:32:58,460
adversaries still doing things where

909
00:32:56,270 --> 00:33:00,500
they touch disk so try and keep that

910
00:32:58,460 --> 00:33:02,410
kind of risk profile in your mind as you

911
00:33:00,500 --> 00:33:04,910
go through doing this sort of emulation

912
00:33:02,410 --> 00:33:06,410
and then of course another oddity here

913
00:33:04,910 --> 00:33:08,480
is a key logger that gathers network

914
00:33:06,410 --> 00:33:10,700
information not something you see very

915
00:33:08,480 --> 00:33:12,740
often but it's an interesting thing to

916
00:33:10,700 --> 00:33:14,450
know that these tools aren't just

917
00:33:12,740 --> 00:33:18,020
one-off sole purposes sometimes they're

918
00:33:14,450 --> 00:33:21,050
a little bit multi multi faceted another

919
00:33:18,020 --> 00:33:22,639
example here and this goes into the kind

920
00:33:21,050 --> 00:33:23,960
of follow the lead type of thing that

921
00:33:22,640 --> 00:33:25,940
you have to do as you go into research

922
00:33:23,960 --> 00:33:28,160
for these sorts of things is this remote

923
00:33:25,940 --> 00:33:30,020
CMD tool as they describe it they

924
00:33:28,160 --> 00:33:31,910
describe it in terms of another tool so

925
00:33:30,020 --> 00:33:33,950
they say oh this is similar to PS exec

926
00:33:31,910 --> 00:33:35,810
and then they don't go much beyond that

927
00:33:33,950 --> 00:33:37,760
so now you have to go and think okay

928
00:33:35,810 --> 00:33:40,070
what is PS exec what is that doing how

929
00:33:37,760 --> 00:33:41,030
does it work and so if you dig into that

930
00:33:40,070 --> 00:33:43,010
little bit more you'll see that it

931
00:33:41,030 --> 00:33:44,660
specifically mounting Windows admin

932
00:33:43,010 --> 00:33:47,000
shares copying files over starting

933
00:33:44,660 --> 00:33:47,900
services to do some lateral movement so

934
00:33:47,000 --> 00:33:49,220
you have to kind of keep that sort of

935
00:33:47,900 --> 00:33:51,680
stuff in mind and dig into these a

936
00:33:49,220 --> 00:33:53,720
little bit more and then of course you

937
00:33:51,680 --> 00:33:55,970
know everybody loves dumping credentials

938
00:33:53,720 --> 00:33:58,160
and here we see there's PW dump that's

939
00:33:55,970 --> 00:33:59,810
doing get hash but one interesting

940
00:33:58,160 --> 00:34:02,060
interesting thing to note about this is

941
00:33:59,810 --> 00:34:03,649
instead of doing maybe get hashes by

942
00:34:02,060 --> 00:34:05,360
looking at the system and Sam files on

943
00:34:03,650 --> 00:34:07,130
disk this one's specifically injecting

944
00:34:05,360 --> 00:34:08,839
into L SAS so this might be something

945
00:34:07,130 --> 00:34:11,090
that you'd see more commonly with things

946
00:34:08,840 --> 00:34:12,770
like me me cats so it's something to

947
00:34:11,090 --> 00:34:14,870
keep in mind as you go through looking

948
00:34:12,770 --> 00:34:17,600
at doing emulation how these things are

949
00:34:14,870 --> 00:34:19,429
happening if this rule so what Cody's

950
00:34:17,600 --> 00:34:21,230
been doing here actually as you guys can

951
00:34:19,429 --> 00:34:22,850
see when he maps these back he's mapping

952
00:34:21,230 --> 00:34:25,490
everything he's found back to attack

953
00:34:22,850 --> 00:34:26,960
each one of these IDs here which is you

954
00:34:25,489 --> 00:34:28,939
know the T if all by the for numbers

955
00:34:26,960 --> 00:34:31,190
that's a specific attack technique and

956
00:34:28,940 --> 00:34:33,540
that's the attack ID specifically T like

957
00:34:31,190 --> 00:34:35,130
10:55 being process injection

958
00:34:33,540 --> 00:34:37,230
so you'd be able to by mapping you back

959
00:34:35,130 --> 00:34:38,970
to attack you can see what is what that

960
00:34:37,230 --> 00:34:40,110
specifically is doing go into that

961
00:34:38,969 --> 00:34:42,270
technique and gain more information

962
00:34:40,110 --> 00:34:44,909
maybe also get different variants and

963
00:34:42,270 --> 00:34:46,860
see also how other groups not just apt 3

964
00:34:44,909 --> 00:34:48,870
in this case but how other groups do

965
00:34:46,860 --> 00:34:51,300
that specific technique yeah and this is

966
00:34:48,870 --> 00:34:52,888
one way that you can do that sort of red

967
00:34:51,300 --> 00:34:54,690
blue collaboration if everybody's

968
00:34:52,889 --> 00:34:56,970
speaking in the same t number the same

969
00:34:54,690 --> 00:34:59,190
technique style then that's a little bit

970
00:34:56,969 --> 00:35:00,870
easier to talk to each other then if red

971
00:34:59,190 --> 00:35:02,760
is talking about me me cats command line

972
00:35:00,870 --> 00:35:06,930
and blue is talking about you know

973
00:35:02,760 --> 00:35:07,920
access codes for process accesses so it

974
00:35:06,930 --> 00:35:10,710
helps you kind of bridge this gap

975
00:35:07,920 --> 00:35:13,200
between talking so that's now talking

976
00:35:10,710 --> 00:35:15,300
about we've covered you know finding the

977
00:35:13,200 --> 00:35:16,950
Intel looking at it to see what kind of

978
00:35:15,300 --> 00:35:18,390
behaviors are there but there's still

979
00:35:16,950 --> 00:35:21,450
one extra piece as part of this step

980
00:35:18,390 --> 00:35:23,670
looking into the adversary mo this is

981
00:35:21,450 --> 00:35:25,680
one of the hardest pieces depending on

982
00:35:23,670 --> 00:35:27,780
how active the adversary is how much

983
00:35:25,680 --> 00:35:29,009
reporting there is on them and even the

984
00:35:27,780 --> 00:35:31,980
client's reporting you may not be able

985
00:35:29,010 --> 00:35:34,290
to get this so it all just depends on

986
00:35:31,980 --> 00:35:35,370
what's out there but when you do start

987
00:35:34,290 --> 00:35:36,600
looking through these reports there are

988
00:35:35,370 --> 00:35:39,120
sections in there that aren't

989
00:35:36,600 --> 00:35:40,950
specifically tied to you know what this

990
00:35:39,120 --> 00:35:42,750
tool can do what hex values are in this

991
00:35:40,950 --> 00:35:44,910
string that sort of stuff

992
00:35:42,750 --> 00:35:47,220
and so you have to kind of read between

993
00:35:44,910 --> 00:35:49,379
the lines to start picking out more of a

994
00:35:47,220 --> 00:35:52,410
Y for the group instead of a specific

995
00:35:49,380 --> 00:35:54,180
tool so here's an example pulled from

996
00:35:52,410 --> 00:35:56,850
Symantec talking about Buckeye which is

997
00:35:54,180 --> 00:35:57,990
another alias for apt 3 but the

998
00:35:56,850 --> 00:36:00,270
interesting part here is they say

999
00:35:57,990 --> 00:36:01,649
Buckeye seems to target file and print

1000
00:36:00,270 --> 00:36:03,750
servers which makes it likely that the

1001
00:36:01,650 --> 00:36:05,520
group is looking to steal documents so

1002
00:36:03,750 --> 00:36:07,170
that already gives you some idea of ok

1003
00:36:05,520 --> 00:36:09,150
once I get into the network I'm not

1004
00:36:07,170 --> 00:36:11,340
looking for domain admin I'm not looking

1005
00:36:09,150 --> 00:36:13,200
you know to get this specific users

1006
00:36:11,340 --> 00:36:15,150
account to troll them I specifically

1007
00:36:13,200 --> 00:36:16,980
want to find areas in the network that

1008
00:36:15,150 --> 00:36:18,600
have high concentrations of documents so

1009
00:36:16,980 --> 00:36:20,670
that I can steal them gives you some

1010
00:36:18,600 --> 00:36:21,750
more of a rationale of why you're even

1011
00:36:20,670 --> 00:36:24,240
attacking this network in the first

1012
00:36:21,750 --> 00:36:26,940
place if we keep looking at other things

1013
00:36:24,240 --> 00:36:28,830
you'll see here one from fireEye where

1014
00:36:26,940 --> 00:36:30,780
it talks about them being extremely

1015
00:36:28,830 --> 00:36:32,250
proficient at lateral movement and not

1016
00:36:30,780 --> 00:36:34,290
reusing command control infrastructure

1017
00:36:32,250 --> 00:36:35,250
just gives you more of an idea as you go

1018
00:36:34,290 --> 00:36:36,540
through ok

1019
00:36:35,250 --> 00:36:38,220
not only are they looking for all these

1020
00:36:36,540 --> 00:36:39,240
kinds of documents in the network but

1021
00:36:38,220 --> 00:36:40,859
they're actually moving on to these

1022
00:36:39,240 --> 00:36:42,899
other boxes maybe to collect them maybe

1023
00:36:40,860 --> 00:36:44,220
to have better awareness and spread

1024
00:36:42,900 --> 00:36:46,080
throughout the network but they're

1025
00:36:44,220 --> 00:36:46,950
definitely spreading out quickly and

1026
00:36:46,080 --> 00:36:49,410
they do it very well

1027
00:36:46,950 --> 00:36:50,970
so it gives you some rationale for once

1028
00:36:49,410 --> 00:36:53,460
you get in the network how are you going

1029
00:36:50,970 --> 00:36:55,020
to propagate additionally with the

1030
00:36:53,460 --> 00:36:57,390
comment about the command control

1031
00:36:55,020 --> 00:37:00,240
infrastructure if you go through you'll

1032
00:36:57,390 --> 00:37:02,730
see some adversaries that will get on to

1033
00:37:00,240 --> 00:37:04,828
a network maybe be superfast and noisy

1034
00:37:02,730 --> 00:37:06,299
drop some commodity malware or something

1035
00:37:04,829 --> 00:37:09,000
that's out there and then if they

1036
00:37:06,299 --> 00:37:10,589
determine that it's a useful target drop

1037
00:37:09,000 --> 00:37:12,660
in a second type of malware that's more

1038
00:37:10,589 --> 00:37:14,720
stealthy more custom-made an attempt to

1039
00:37:12,660 --> 00:37:17,549
have that one kind of lay low and slow

1040
00:37:14,720 --> 00:37:19,500
longer term so the point here about not

1041
00:37:17,549 --> 00:37:20,430
reusing command control is interesting

1042
00:37:19,500 --> 00:37:21,900
to note that if you're going to go

1043
00:37:20,430 --> 00:37:23,940
through doing that maybe using different

1044
00:37:21,900 --> 00:37:25,440
tool sets don't reuse the command

1045
00:37:23,940 --> 00:37:29,339
control infrastructure keep those as

1046
00:37:25,440 --> 00:37:31,410
separate as possible and finally here's

1047
00:37:29,339 --> 00:37:33,150
another one where it's talking about the

1048
00:37:31,410 --> 00:37:35,759
actual initial access part that they

1049
00:37:33,150 --> 00:37:37,500
used specifically the self-extracting of

1050
00:37:35,760 --> 00:37:39,299
our archive was created five to six

1051
00:37:37,500 --> 00:37:41,309
months before the attack so this gives

1052
00:37:39,299 --> 00:37:43,380
you some idea that as they go through

1053
00:37:41,309 --> 00:37:45,510
and they're preparing to no Spearfish

1054
00:37:43,380 --> 00:37:47,339
their way into an environment or do

1055
00:37:45,510 --> 00:37:49,170
watering hole attacks or whatnot they're

1056
00:37:47,339 --> 00:37:50,400
creating these payloads months and

1057
00:37:49,170 --> 00:37:51,900
months in advance they're rehearsing

1058
00:37:50,400 --> 00:37:52,589
this type of thing they're looking into

1059
00:37:51,900 --> 00:37:54,480
how it works

1060
00:37:52,589 --> 00:37:57,000
once they get it working keeping that

1061
00:37:54,480 --> 00:37:59,010
safe and maybe swapping out the payloads

1062
00:37:57,000 --> 00:38:00,750
inside of it but not really changing up

1063
00:37:59,010 --> 00:38:02,099
their tactics that much right they're

1064
00:38:00,750 --> 00:38:03,690
still doing the same sort of thing but

1065
00:38:02,099 --> 00:38:06,150
they have a lot of preparation leading

1066
00:38:03,690 --> 00:38:08,549
up to this so taking these sorts of

1067
00:38:06,150 --> 00:38:11,460
things together you can create what we

1068
00:38:08,549 --> 00:38:12,359
have as an emulation plan now this is

1069
00:38:11,460 --> 00:38:14,460
definitely the hardest part of the

1070
00:38:12,359 --> 00:38:16,470
puzzle because it's way less

1071
00:38:14,460 --> 00:38:18,900
straightforward the data may not even be

1072
00:38:16,470 --> 00:38:20,848
out there but you just kind of have to

1073
00:38:18,900 --> 00:38:23,309
try and think about it and that goes

1074
00:38:20,849 --> 00:38:25,260
back to the mo pieces that we're just

1075
00:38:23,309 --> 00:38:27,299
talking about no plan will be perfect

1076
00:38:25,260 --> 00:38:29,309
it's okay you can approximate where

1077
00:38:27,299 --> 00:38:30,630
needed and remember as you go through

1078
00:38:29,309 --> 00:38:33,030
and you're doing this sort of adversary

1079
00:38:30,630 --> 00:38:34,740
emulation your goal isn't to be an exact

1080
00:38:33,030 --> 00:38:37,079
replica of a prior incident that

1081
00:38:34,740 --> 00:38:39,029
happened you're trying to provide some

1082
00:38:37,079 --> 00:38:40,950
sort of variation and behave like the

1083
00:38:39,030 --> 00:38:42,569
adversary right the adversary isn't

1084
00:38:40,950 --> 00:38:44,578
going to do the exact same thing twice

1085
00:38:42,569 --> 00:38:46,650
over and over again because as it is

1086
00:38:44,579 --> 00:38:48,390
defenders are already looking at file

1087
00:38:46,650 --> 00:38:49,740
hashes so right they're already doing

1088
00:38:48,390 --> 00:38:51,960
the same thing over and over again isn't

1089
00:38:49,740 --> 00:38:53,879
going to help you so it's okay to have

1090
00:38:51,960 --> 00:38:56,609
this sort of variation and if you can

1091
00:38:53,880 --> 00:38:58,710
see here we have the three phases for

1092
00:38:56,609 --> 00:39:00,249
our emulation plan that kind of coral

1093
00:38:58,710 --> 00:39:02,650
corresponds to the three

1094
00:39:00,249 --> 00:39:04,058
types of reports I just mentioned so you

1095
00:39:02,650 --> 00:39:06,579
have that first phase where you're

1096
00:39:04,059 --> 00:39:07,959
looking at long term setting up your

1097
00:39:06,579 --> 00:39:09,819
infrastructure getting your payloads

1098
00:39:07,959 --> 00:39:11,499
ready thinking about that sitting at

1099
00:39:09,819 --> 00:39:13,569
multiple kinds of infrastructure that

1100
00:39:11,499 --> 00:39:14,919
first phase then moving into the second

1101
00:39:13,569 --> 00:39:17,829
phase once you get on the network and

1102
00:39:14,920 --> 00:39:19,299
quickly moving around laterally moving

1103
00:39:17,829 --> 00:39:20,380
to a bunch of different hosts calling

1104
00:39:19,299 --> 00:39:22,089
back to you different infrastructures

1105
00:39:20,380 --> 00:39:23,799
finding all the things that you think

1106
00:39:22,089 --> 00:39:26,380
are useful all these different file

1107
00:39:23,799 --> 00:39:28,599
aggregation spots and then you move into

1108
00:39:26,380 --> 00:39:30,910
that final spot of okay and now that

1109
00:39:28,599 --> 00:39:33,069
you've found what you're looking for not

1110
00:39:30,910 --> 00:39:35,019
what so going through collecting the

1111
00:39:33,069 --> 00:39:37,329
data staging at exfiltrating it outright

1112
00:39:35,019 --> 00:39:38,738
remember this was your goal in emulating

1113
00:39:37,329 --> 00:39:42,849
this adversary on the network not just

1114
00:39:38,739 --> 00:39:44,109
to oh look i'm on 15 boxes so what

1115
00:39:42,849 --> 00:39:45,940
what's the impact what are you trying to

1116
00:39:44,109 --> 00:39:48,519
do something to try and keep in mind as

1117
00:39:45,940 --> 00:39:50,619
you go about doing this so now that you

1118
00:39:48,519 --> 00:39:52,508
have some sort of idea of what the

1119
00:39:50,619 --> 00:39:54,160
adversary is capable of doing some

1120
00:39:52,509 --> 00:39:56,289
general approach to how you want to do

1121
00:39:54,160 --> 00:39:57,999
this now you need some way of doing it

1122
00:39:56,289 --> 00:40:00,459
you're not going to go through and drop

1123
00:39:57,999 --> 00:40:03,098
you know purpie on the system you want

1124
00:40:00,459 --> 00:40:05,229
to be able to do this in a safer way so

1125
00:40:03,099 --> 00:40:06,729
this part step three is going through to

1126
00:40:05,229 --> 00:40:08,890
look at what kind of tools you need to

1127
00:40:06,729 --> 00:40:10,899
do this and as part of this you know you

1128
00:40:08,890 --> 00:40:13,629
may have your own tool set purchasing

1129
00:40:10,900 --> 00:40:14,709
tools that are out there may be open

1130
00:40:13,630 --> 00:40:17,589
source ones that are there that you can

1131
00:40:14,709 --> 00:40:19,328
use and thinking about how do they

1132
00:40:17,589 --> 00:40:20,739
operate can you extend them do you need

1133
00:40:19,329 --> 00:40:22,809
to modify them do you need to write your

1134
00:40:20,739 --> 00:40:24,789
own and specifically trying to look at

1135
00:40:22,809 --> 00:40:27,579
these behaviors so we keep talking about

1136
00:40:24,789 --> 00:40:29,079
behaviors a lot so I wanted to give a

1137
00:40:27,579 --> 00:40:30,910
couple examples of what we mean whenever

1138
00:40:29,079 --> 00:40:33,099
we talk about emulating these sorts of

1139
00:40:30,910 --> 00:40:35,890
TTP's because that's kind of a

1140
00:40:33,099 --> 00:40:38,559
higher-level broad abstract term I like

1141
00:40:35,890 --> 00:40:39,819
examples so we already talked about a

1142
00:40:38,559 --> 00:40:41,920
couple of these that we saw in the

1143
00:40:39,819 --> 00:40:43,749
threat reports already for example if

1144
00:40:41,920 --> 00:40:46,509
the adversary is using PS exec for

1145
00:40:43,749 --> 00:40:48,669
lateral movement well what are other

1146
00:40:46,509 --> 00:40:51,130
ways that you can do that manually so if

1147
00:40:48,670 --> 00:40:53,170
you use net use to mount the drive copy

1148
00:40:51,130 --> 00:40:54,969
the file over use SC to create the

1149
00:40:53,170 --> 00:40:56,949
services remotely have more of this

1150
00:40:54,969 --> 00:40:59,109
manual aspect to it you're still doing

1151
00:40:56,949 --> 00:41:01,059
the same attack technique you're just

1152
00:40:59,109 --> 00:41:02,949
changing up that how a little bit giving

1153
00:41:01,059 --> 00:41:05,199
a little bit more variation but the

1154
00:41:02,949 --> 00:41:07,180
behavior is still the same similarly if

1155
00:41:05,199 --> 00:41:09,400
the adversary is running Who am I for

1156
00:41:07,180 --> 00:41:10,779
discovery of once they get on a box what

1157
00:41:09,400 --> 00:41:12,339
kind of permissions do they have where

1158
00:41:10,779 --> 00:41:14,019
are they that sort of thing

1159
00:41:12,339 --> 00:41:15,940
what if you go ahead and instead use

1160
00:41:14,019 --> 00:41:17,439
environment variables user domain and

1161
00:41:15,940 --> 00:41:19,749
user name let's do a lot of the same

1162
00:41:17,440 --> 00:41:21,759
information the same style of doing

1163
00:41:19,749 --> 00:41:23,649
things but now you've tweaked things a

1164
00:41:21,759 --> 00:41:25,930
little bit to trip up the defenders

1165
00:41:23,650 --> 00:41:27,819
remember you're still trying to achieve

1166
00:41:25,930 --> 00:41:29,859
the same sort of goals do the same style

1167
00:41:27,819 --> 00:41:31,450
of things but the variations are what

1168
00:41:29,859 --> 00:41:33,910
matters here and so as you go through

1169
00:41:31,450 --> 00:41:35,169
doing this just keep in mind you know

1170
00:41:33,910 --> 00:41:37,149
what it is you're trying to do and why

1171
00:41:35,170 --> 00:41:39,309
it is you're trying to do it the attack

1172
00:41:37,150 --> 00:41:40,989
tactic and techniques the variations

1173
00:41:39,309 --> 00:41:43,089
really come into play with the how the

1174
00:41:40,989 --> 00:41:45,579
procedures how it is you're implementing

1175
00:41:43,089 --> 00:41:47,140
viewing this and so as you go through

1176
00:41:45,579 --> 00:41:48,849
and you start looking at these looking

1177
00:41:47,140 --> 00:41:52,089
at your tool sets you're gonna define

1178
00:41:48,849 --> 00:41:54,309
what it is you use and so sometimes

1179
00:41:52,089 --> 00:41:56,380
people will especially these days get so

1180
00:41:54,309 --> 00:41:58,479
overwhelmed with PowerShell and it's the

1181
00:41:56,380 --> 00:41:59,979
latest and greatest awesome thing but if

1182
00:41:58,479 --> 00:42:01,569
everything that you have is based off of

1183
00:41:59,979 --> 00:42:03,879
PowerShell and you get into an

1184
00:42:01,569 --> 00:42:06,849
environment and they have an XP box that

1185
00:42:03,880 --> 00:42:08,229
doesn't have PowerShell what do you do I

1186
00:42:06,849 --> 00:42:09,430
keep seeing people that are all

1187
00:42:08,229 --> 00:42:10,689
PowerShell and they get on there it's

1188
00:42:09,430 --> 00:42:12,640
like oh no I know this box should have

1189
00:42:10,690 --> 00:42:14,950
fifteen thousand ways of being exported

1190
00:42:12,640 --> 00:42:16,930
I mean it's XP but there's no PowerShell

1191
00:42:14,950 --> 00:42:18,879
so how do I do things right making sure

1192
00:42:16,930 --> 00:42:21,190
that you have this sort of broad

1193
00:42:18,880 --> 00:42:22,569
environment this wide range of tools and

1194
00:42:21,190 --> 00:42:25,180
implementations for how to do things

1195
00:42:22,569 --> 00:42:28,089
helps you as the adversary go about your

1196
00:42:25,180 --> 00:42:29,919
business as well and so here's an

1197
00:42:28,089 --> 00:42:33,160
example of breaking out some of purpose

1198
00:42:29,920 --> 00:42:34,839
functions the malware and ways that you

1199
00:42:33,160 --> 00:42:36,098
can go about implementing them while

1200
00:42:34,839 --> 00:42:38,558
staying within the balance of that

1201
00:42:36,099 --> 00:42:40,539
attack tactic and technique so going

1202
00:42:38,559 --> 00:42:42,759
through and having ways to do like

1203
00:42:40,539 --> 00:42:44,349
listing processes with Windows built in

1204
00:42:42,759 --> 00:42:46,239
what if you did this with CMD or

1205
00:42:44,349 --> 00:42:48,579
PowerShell how would you do it with

1206
00:42:46,239 --> 00:42:50,739
cobalt strike Metasploit empire puppy

1207
00:42:48,579 --> 00:42:53,229
all these different things to have ways

1208
00:42:50,739 --> 00:42:55,479
are going about to do this as you go

1209
00:42:53,229 --> 00:42:57,249
through and you start noting these

1210
00:42:55,479 --> 00:42:59,529
things down building out your arsenal

1211
00:42:57,249 --> 00:43:01,299
having all these toolkits as a nice

1212
00:42:59,529 --> 00:43:03,849
artifact you kind of get this adversary

1213
00:43:01,299 --> 00:43:05,950
emulation Field Manual you get this way

1214
00:43:03,849 --> 00:43:07,779
of illustrating and describing how

1215
00:43:05,950 --> 00:43:09,609
you're going to go about operating on

1216
00:43:07,779 --> 00:43:11,499
networks and relating specific

1217
00:43:09,609 --> 00:43:13,239
adversaries and it's a nice way to have

1218
00:43:11,499 --> 00:43:15,189
exact command line examples things that

1219
00:43:13,239 --> 00:43:16,569
you can kind of just copy and paste a

1220
00:43:15,190 --> 00:43:19,599
broader knowledge that you and your team

1221
00:43:16,569 --> 00:43:21,788
can use so now that you kind of

1222
00:43:19,599 --> 00:43:23,769
established how you're going to do

1223
00:43:21,789 --> 00:43:24,999
things you have your tools the next step

1224
00:43:23,769 --> 00:43:25,580
is setting up the infrastructure and

1225
00:43:24,999 --> 00:43:28,279
getting ready

1226
00:43:25,580 --> 00:43:30,319
this our abt three example is that phase

1227
00:43:28,280 --> 00:43:32,960
one getting everything set up buying a

1228
00:43:30,320 --> 00:43:34,940
domain jury directors test your

1229
00:43:32,960 --> 00:43:36,590
techniques and of course you're going to

1230
00:43:34,940 --> 00:43:38,450
be creating your payloads that are

1231
00:43:36,590 --> 00:43:40,040
inspired by the adversaries trade craft

1232
00:43:38,450 --> 00:43:41,750
remember you're not going to be dropping

1233
00:43:40,040 --> 00:43:44,300
Kirby or plug X onto your target Network

1234
00:43:41,750 --> 00:43:46,490
you're gonna be using your tools but try

1235
00:43:44,300 --> 00:43:49,040
and make them look closer to what the

1236
00:43:46,490 --> 00:43:50,839
adversary were use now I see this a lot

1237
00:43:49,040 --> 00:43:52,430
people going off you skate all the

1238
00:43:50,840 --> 00:43:54,560
things this is awesome

1239
00:43:52,430 --> 00:43:55,730
people like Dan Bohannon are releasing

1240
00:43:54,560 --> 00:43:57,730
awesome tools to go out there and

1241
00:43:55,730 --> 00:44:00,920
obviously all the things but remember

1242
00:43:57,730 --> 00:44:03,200
obfuscation itself can be kind of a trip

1243
00:44:00,920 --> 00:44:05,240
an indicator of compromise that people

1244
00:44:03,200 --> 00:44:07,339
are triggering on and so don't obvious

1245
00:44:05,240 --> 00:44:09,290
get all the things please obvious gate

1246
00:44:07,340 --> 00:44:10,580
with purpose if you're off you skating

1247
00:44:09,290 --> 00:44:12,740
then you're looking at something in that

1248
00:44:10,580 --> 00:44:14,299
defense evasion tactic that we have in

1249
00:44:12,740 --> 00:44:16,220
attack there's a reason that you're

1250
00:44:14,300 --> 00:44:17,300
trying to obvious Kate why you don't

1251
00:44:16,220 --> 00:44:19,069
want to just obvious Cape for the sake

1252
00:44:17,300 --> 00:44:21,770
of obfuscation but you're trying to

1253
00:44:19,070 --> 00:44:24,010
bypass a specific signature get rid of a

1254
00:44:21,770 --> 00:44:26,500
specific string that sort of stuff so

1255
00:44:24,010 --> 00:44:30,140
keep that in mind as you go through and

1256
00:44:26,500 --> 00:44:31,310
so finally the last step for this is now

1257
00:44:30,140 --> 00:44:34,190
that you have everything ready you have

1258
00:44:31,310 --> 00:44:36,320
everything set up tested now actually go

1259
00:44:34,190 --> 00:44:38,540
forth and conquer be the adversary on

1260
00:44:36,320 --> 00:44:40,700
that network emulate the adversary keep

1261
00:44:38,540 --> 00:44:43,100
this flow in mind why it is you're

1262
00:44:40,700 --> 00:44:45,500
you're going about them remember it's

1263
00:44:43,100 --> 00:44:47,960
highly unlikely that domain admin is the

1264
00:44:45,500 --> 00:44:49,310
target for an adversary right there's

1265
00:44:47,960 --> 00:44:51,380
something there trying to get just

1266
00:44:49,310 --> 00:44:53,990
having a domain admin password doesn't

1267
00:44:51,380 --> 00:44:55,970
like help the company get any better

1268
00:44:53,990 --> 00:44:57,439
doesn't help you as adversary do

1269
00:44:55,970 --> 00:45:00,230
anything there's something you're using

1270
00:44:57,440 --> 00:45:01,850
that credential for right so in the apt

1271
00:45:00,230 --> 00:45:05,180
three example you may not even need a

1272
00:45:01,850 --> 00:45:08,750
domain admin in the network maybe some

1273
00:45:05,180 --> 00:45:10,430
users capability and credential access

1274
00:45:08,750 --> 00:45:11,990
can already get you on to the most

1275
00:45:10,430 --> 00:45:13,460
valuable flyer file share and the

1276
00:45:11,990 --> 00:45:15,200
network and get all the documents you

1277
00:45:13,460 --> 00:45:17,420
need so just trying to keep that in mind

1278
00:45:15,200 --> 00:45:19,850
as you go through and keep in mind the

1279
00:45:17,420 --> 00:45:22,640
speed of the adversary some adversaries

1280
00:45:19,850 --> 00:45:24,920
are low and slow as they go about on

1281
00:45:22,640 --> 00:45:27,650
different networks you know may be

1282
00:45:24,920 --> 00:45:29,840
sending a command once a day being super

1283
00:45:27,650 --> 00:45:31,640
stealthy sometimes they're super smash

1284
00:45:29,840 --> 00:45:33,320
grab light up everything doesn't matter

1285
00:45:31,640 --> 00:45:33,808
they don't think this network is

1286
00:45:33,320 --> 00:45:35,219
important

1287
00:45:33,809 --> 00:45:37,109
important or that sort of thing so try

1288
00:45:35,219 --> 00:45:38,459
and keep remember this general mo of the

1289
00:45:37,109 --> 00:45:41,038
adversary in mind as you go about doing

1290
00:45:38,459 --> 00:45:42,629
this and so as part of this we're

1291
00:45:41,039 --> 00:45:45,359
providing a starting point for red and

1292
00:45:42,630 --> 00:45:46,680
blue apt three is already up on the

1293
00:45:45,359 --> 00:45:48,989
website now you're free to download it

1294
00:45:46,680 --> 00:45:51,089
look at it we have command line examples

1295
00:45:48,989 --> 00:45:53,999
as an adversary emulation Field Manual

1296
00:45:51,089 --> 00:45:55,739
of things in Cobalt strike Metasploit

1297
00:45:53,999 --> 00:45:58,109
and Windows built in that you can just

1298
00:45:55,739 --> 00:45:59,359
straight-up take down and run to emulate

1299
00:45:58,109 --> 00:46:02,699
these different techniques that we have

1300
00:45:59,359 --> 00:46:04,199
and we have a bt 29 coming out soon but

1301
00:46:02,699 --> 00:46:05,969
with the same sort of process all the

1302
00:46:04,199 --> 00:46:07,229
way through what fair intelligence is

1303
00:46:05,969 --> 00:46:10,650
out there mapping it to attack

1304
00:46:07,229 --> 00:46:11,999
interesting OPSEC notes yep and so at

1305
00:46:10,650 --> 00:46:15,839
the very end here's some links to

1306
00:46:11,999 --> 00:46:18,390
contact us or reach out and feel free to

1307
00:46:15,839 --> 00:46:18,689
reach out to mitre attack at twitter as

1308
00:46:18,390 --> 00:46:20,400
well

1309
00:46:18,689 --> 00:46:22,729
and that's it thank you I think we're

1310
00:46:20,400 --> 00:46:22,729
right on time

1311
00:46:27,330 --> 00:46:31,590
and I don't know if we have time for

1312
00:46:29,760 --> 00:46:33,630
questions but we'll be around for the

1313
00:46:31,590 --> 00:46:35,070
rest of the the conference we also have

1314
00:46:33,630 --> 00:46:36,270
two stickers for those who want them so

1315
00:46:35,070 --> 00:46:38,430
let's come find us we'll begin the

1316
00:46:36,270 --> 00:46:43,400
obvious attack yes please take our

1317
00:46:38,430 --> 00:46:43,399
stickers thank you thank you

