1
00:00:00,089 --> 00:00:06,150
I should probably not give my top and

2
00:00:02,310 --> 00:00:09,420
just let it be that all right I'm ready

3
00:00:06,150 --> 00:00:11,880
ready all right before we start a few

4
00:00:09,420 --> 00:00:13,620
points of order for people watching the

5
00:00:11,880 --> 00:00:16,230
livestream or anyone in the audience who

6
00:00:13,620 --> 00:00:18,480
would prefer subtitles the entire

7
00:00:16,230 --> 00:00:20,550
transcript all the slides and all the

8
00:00:18,480 --> 00:00:26,789
supporting materials for this talk are

9
00:00:20,550 --> 00:00:28,199
live now at NFC Dot toys NFC toys we're

10
00:00:26,789 --> 00:00:29,880
covering a lot in this talk and it

11
00:00:28,199 --> 00:00:32,520
clocks in to just under 50 minutes which

12
00:00:29,880 --> 00:00:34,440
means we won't have time for live QA but

13
00:00:32,520 --> 00:00:36,690
QA is important so I will be taking

14
00:00:34,440 --> 00:00:38,968
questions on paper and electronically

15
00:00:36,690 --> 00:00:40,530
the in-person audience can write their

16
00:00:38,969 --> 00:00:43,079
questions on the flip side of their

17
00:00:40,530 --> 00:00:46,050
feedback form both the in person and

18
00:00:43,079 --> 00:00:49,079
live stream audiences can submit

19
00:00:46,050 --> 00:00:51,209
questions via Twitter too at NFC toys or

20
00:00:49,079 --> 00:00:53,340
via text message for the remainder of

21
00:00:51,210 --> 00:00:54,600
the day I know it's you don't have great

22
00:00:53,340 --> 00:00:55,949
cell phone reception down here but you

23
00:00:54,600 --> 00:00:59,309
can type them in and queue them up and

24
00:00:55,949 --> 00:01:03,809
send them later to one eight five six to

25
00:00:59,309 --> 00:01:06,090
NFC Q&A one eight five six to NFC Q&A

26
00:01:03,809 --> 00:01:08,460
there are slide numbers on each slide

27
00:01:06,090 --> 00:01:11,220
you can reference I will post answers to

28
00:01:08,460 --> 00:01:13,169
questions on NFC toys and reply to you

29
00:01:11,220 --> 00:01:14,908
with a link to your answer if you're

30
00:01:13,170 --> 00:01:17,850
watching this talk in the future church

31
00:01:14,909 --> 00:01:21,030
asking questions via Twitter will be

32
00:01:17,850 --> 00:01:22,860
your best bet for a response this is an

33
00:01:21,030 --> 00:01:24,780
introductory level talk but there are

34
00:01:22,860 --> 00:01:26,420
also more advanced and related talks at

35
00:01:24,780 --> 00:01:28,590
hope this year I linked to the

36
00:01:26,420 --> 00:01:33,360
information about these and others on

37
00:01:28,590 --> 00:01:34,770
NFC toys and finally as the MC mentioned

38
00:01:33,360 --> 00:01:37,229
for the in-person audience I've provided

39
00:01:34,770 --> 00:01:39,298
speaker feedback forms and pens one side

40
00:01:37,229 --> 00:01:41,369
is for Q&A the other side is for talk or

41
00:01:39,299 --> 00:01:43,470
speaker feedback please fill these out

42
00:01:41,369 --> 00:01:45,570
and at the end pass them forward or

43
00:01:43,470 --> 00:01:47,548
leave them on the tables outside it

44
00:01:45,570 --> 00:01:49,079
helps me know how this went independent

45
00:01:47,549 --> 00:01:51,030
of any feedback you may provide hope

46
00:01:49,079 --> 00:01:52,979
directly if you need paper for your own

47
00:01:51,030 --> 00:01:55,110
notes I've also provided blank index

48
00:01:52,979 --> 00:01:56,880
cards so please use the feedback forms

49
00:01:55,110 --> 00:01:59,070
to ask questions and provide feedback

50
00:01:56,880 --> 00:02:00,899
there's extra ones up here up front and

51
00:01:59,070 --> 00:02:03,869
also on the table in the middle of the

52
00:02:00,899 --> 00:02:06,509
aisle all right we're going to talk

53
00:02:03,869 --> 00:02:08,818
about NFC toys which are toys which have

54
00:02:06,509 --> 00:02:10,530
NFC tags embedded in them I want to give

55
00:02:08,818 --> 00:02:12,629
you an idea of why this is worth an hour

56
00:02:10,530 --> 00:02:13,490
of your time but I need to start with a

57
00:02:12,629 --> 00:02:15,530
couple of exam

58
00:02:13,490 --> 00:02:19,400
fools for everyone who doesn't know what

59
00:02:15,530 --> 00:02:21,320
NFC is so a round of applause who has

60
00:02:19,400 --> 00:02:23,300
paid for something using an iPhone with

61
00:02:21,320 --> 00:02:28,820
Apple pay or an Android phone with

62
00:02:23,300 --> 00:02:31,100
Google pay cool all right NFC is how

63
00:02:28,820 --> 00:02:32,810
your phone talks to the payment terminal

64
00:02:31,100 --> 00:02:34,579
you hold it up to and all of those

65
00:02:32,810 --> 00:02:36,740
wireless payment systems work the same

66
00:02:34,580 --> 00:02:38,240
way under the hood part of NFC is a

67
00:02:36,740 --> 00:02:41,120
standard method of wireless

68
00:02:38,240 --> 00:02:42,710
communication round of applause whoo

69
00:02:41,120 --> 00:02:44,210
waves a security badge against the

70
00:02:42,710 --> 00:02:48,200
reader to get into their building at

71
00:02:44,210 --> 00:02:51,200
work all right

72
00:02:48,200 --> 00:02:54,230
NFC is a subset of the RFID technology

73
00:02:51,200 --> 00:02:56,570
that your badge probably uses inside

74
00:02:54,230 --> 00:02:59,269
that badge just like inside and NFC toy

75
00:02:56,570 --> 00:03:01,940
is what's called a tag NFC tags are a

76
00:02:59,270 --> 00:03:04,250
small amount of memory logic and an

77
00:03:01,940 --> 00:03:06,800
antenna they're not really a full-on

78
00:03:04,250 --> 00:03:10,010
microprocessor NFC tags are more like

79
00:03:06,800 --> 00:03:13,670
tiny slow Wireless flash drives part of

80
00:03:10,010 --> 00:03:16,160
NFC is a standard set of tag types when

81
00:03:13,670 --> 00:03:18,230
a tag or your phone talking like a tag

82
00:03:16,160 --> 00:03:20,660
is near enough to a reader generally

83
00:03:18,230 --> 00:03:22,820
millimeters to centimeters the readers

84
00:03:20,660 --> 00:03:25,040
radio frequency transmissions provide

85
00:03:22,820 --> 00:03:26,510
enough wireless power to allow the tag

86
00:03:25,040 --> 00:03:29,650
to communicate back and forth

87
00:03:26,510 --> 00:03:33,079
often just tends to a few hundred bytes

88
00:03:29,650 --> 00:03:35,720
now NFC tags which store tiny amounts of

89
00:03:33,080 --> 00:03:37,940
data Wireless NFC communication methods

90
00:03:35,720 --> 00:03:41,090
to transmit them these are technical

91
00:03:37,940 --> 00:03:45,079
tools for engineers but NFC toys are

92
00:03:41,090 --> 00:03:47,990
first and foremost toys toys are meant

93
00:03:45,080 --> 00:03:50,840
to be fun toys are meant to be played

94
00:03:47,990 --> 00:03:52,850
with everyone understands that toys are

95
00:03:50,840 --> 00:03:55,460
toys so when a toy does something that a

96
00:03:52,850 --> 00:03:57,980
toy would it normally do that's visually

97
00:03:55,460 --> 00:04:00,080
interesting that's stimulating swiping a

98
00:03:57,980 --> 00:04:02,179
toy of Samus Iran from Metroid on a

99
00:04:00,080 --> 00:04:04,550
subway turnstile that perks you up

100
00:04:02,180 --> 00:04:07,120
that's super interesting what other

101
00:04:04,550 --> 00:04:09,560
kinds of data could you put on one well

102
00:04:07,120 --> 00:04:13,130
anything because remember they're like

103
00:04:09,560 --> 00:04:14,750
tiny slow Wireless flash drives you

104
00:04:13,130 --> 00:04:16,459
could have a Maleficent toy holding

105
00:04:14,750 --> 00:04:18,709
within it the original curse from the

106
00:04:16,459 --> 00:04:20,510
grim fairy tale you gotta have a

107
00:04:18,709 --> 00:04:23,239
Tinkerbell toy with a link to the e-book

108
00:04:20,510 --> 00:04:25,099
of Peter and Wendy you could have a

109
00:04:23,240 --> 00:04:26,780
piggy bank with your Bitcoin wallets

110
00:04:25,100 --> 00:04:28,910
private key

111
00:04:26,780 --> 00:04:33,919
you could have a kylo Ren toy with a

112
00:04:28,910 --> 00:04:37,850
playlist of emo songs you could have a

113
00:04:33,920 --> 00:04:39,440
toy car to unlock your real car you

114
00:04:37,850 --> 00:04:42,620
could have a kickoff Countdown's toy

115
00:04:39,440 --> 00:04:44,570
store your world cup predictions you

116
00:04:42,620 --> 00:04:48,560
could have a toy in a geocache with

117
00:04:44,570 --> 00:04:49,940
coordinates to another geocache you

118
00:04:48,560 --> 00:04:51,710
could have a Pikachu toy with the

119
00:04:49,940 --> 00:04:54,320
credentials to your dev environment at

120
00:04:51,710 --> 00:04:55,580
work you could have a larger Pikachu toy

121
00:04:54,320 --> 00:04:58,490
with the credentials to your QA

122
00:04:55,580 --> 00:05:00,440
environment to work you could have a

123
00:04:58,490 --> 00:05:03,280
giant Pikachu toy with the credentials

124
00:05:00,440 --> 00:05:05,330
to your production environment at work

125
00:05:03,280 --> 00:05:08,150
even though they're technically no

126
00:05:05,330 --> 00:05:09,940
different than a bear NFC tag storing

127
00:05:08,150 --> 00:05:12,650
the same amount of data in the same way

128
00:05:09,940 --> 00:05:15,710
communicating the same way the novelty

129
00:05:12,650 --> 00:05:18,500
and playful aspect of NFC toys supports

130
00:05:15,710 --> 00:05:21,409
us in thinking about unique and fun uses

131
00:05:18,500 --> 00:05:25,250
for NFC tags in a way that NFC tags by

132
00:05:21,410 --> 00:05:26,960
themselves don't that said while they

133
00:05:25,250 --> 00:05:29,630
are technically no different than a bear

134
00:05:26,960 --> 00:05:31,370
NFC tag because NFC toys are often

135
00:05:29,630 --> 00:05:33,530
intended to support interactions with

136
00:05:31,370 --> 00:05:36,050
copyrighted digital content they may be

137
00:05:33,530 --> 00:05:38,330
legally different if we want to use them

138
00:05:36,050 --> 00:05:40,610
for our own purposes we should be able

139
00:05:38,330 --> 00:05:43,159
to play with our toys as we see fit and

140
00:05:40,610 --> 00:05:46,370
it's up to us to assert our rights to do

141
00:05:43,160 --> 00:05:48,650
so we're going to talk about three makes

142
00:05:46,370 --> 00:05:50,660
of NFC toys with most of our time spent

143
00:05:48,650 --> 00:05:52,340
on Activision Skylanders because that's

144
00:05:50,660 --> 00:05:54,140
where most of the literature is but

145
00:05:52,340 --> 00:05:57,049
we'll also cover Disney infinity and

146
00:05:54,140 --> 00:05:59,150
Nintendo amiibo there are other makes of

147
00:05:57,050 --> 00:06:00,740
NFC toys and the techniques we'll use

148
00:05:59,150 --> 00:06:03,320
can apply to them but these are what

149
00:06:00,740 --> 00:06:04,940
we'll be talking about today as we talk

150
00:06:03,320 --> 00:06:06,050
about them are going to explain how they

151
00:06:04,940 --> 00:06:08,060
work along with some background

152
00:06:06,050 --> 00:06:09,620
information about the toys to life genre

153
00:06:08,060 --> 00:06:12,440
of video games and pertinent details

154
00:06:09,620 --> 00:06:14,479
about NFC tags in general we'll explore

155
00:06:12,440 --> 00:06:16,460
each one with off-the-shelf hardware and

156
00:06:14,479 --> 00:06:18,550
software referencing a long history of

157
00:06:16,460 --> 00:06:20,960
security research and learn how that

158
00:06:18,550 --> 00:06:23,240
exploration can lead to determining read

159
00:06:20,960 --> 00:06:25,219
and write credentials and then we'll see

160
00:06:23,240 --> 00:06:27,020
how to write our own data to those three

161
00:06:25,220 --> 00:06:29,380
different types of NFC toy and talk

162
00:06:27,020 --> 00:06:31,909
about the legal implications of doing so

163
00:06:29,380 --> 00:06:34,310
while I will be discussing legal matters

164
00:06:31,910 --> 00:06:37,760
I am NOT a lawyer and this is not legal

165
00:06:34,310 --> 00:06:38,720
advice finally I will hand out NFC toys

166
00:06:37,760 --> 00:06:40,490
and works

167
00:06:38,720 --> 00:06:42,770
Sheetz for anyone in the audience who

168
00:06:40,490 --> 00:06:45,830
wants to try this out for themselves and

169
00:06:42,770 --> 00:06:48,799
I hope you will we're going to start

170
00:06:45,830 --> 00:06:50,719
with Activision Skylanders round of

171
00:06:48,800 --> 00:06:52,160
applause who has kids who were into

172
00:06:50,720 --> 00:06:53,780
Skylanders and you had to buy them a

173
00:06:52,160 --> 00:06:56,390
bunch of stupid toys and video games in

174
00:06:53,780 --> 00:06:58,460
the last seven years yeah parents in the

175
00:06:56,390 --> 00:07:00,320
audience okay okay

176
00:06:58,460 --> 00:07:02,180
round of applause who was personally

177
00:07:00,320 --> 00:07:03,800
into Skylanders and bought yourself a

178
00:07:02,180 --> 00:07:08,510
bunch of awesome toys and video games

179
00:07:03,800 --> 00:07:10,210
over the last seven years fantastic for

180
00:07:08,510 --> 00:07:12,409
everyone else who isn't familiar

181
00:07:10,210 --> 00:07:15,799
Skylanders is a video game that launched

182
00:07:12,410 --> 00:07:17,930
in 2011 as a Spyro the Dragon reboot

183
00:07:15,800 --> 00:07:20,270
across every major platform plus a

184
00:07:17,930 --> 00:07:23,180
flash-based web game it's a game in the

185
00:07:20,270 --> 00:07:26,060
toys to life genre as in bring your toys

186
00:07:23,180 --> 00:07:28,970
to life each Skylanders game shipped

187
00:07:26,060 --> 00:07:32,330
with a few starter figures and a USB NFC

188
00:07:28,970 --> 00:07:33,919
reader styled as a portal to play the

189
00:07:32,330 --> 00:07:35,650
game you place a figure on the portal

190
00:07:33,919 --> 00:07:38,000
and that's the character you play as

191
00:07:35,650 --> 00:07:39,620
when you name your character and you

192
00:07:38,000 --> 00:07:43,310
earn points and collect items they're

193
00:07:39,620 --> 00:07:44,930
stored in the NFC tag on the toy so when

194
00:07:43,310 --> 00:07:46,610
you take that same toy to your friend's

195
00:07:44,930 --> 00:07:48,530
house it shows up with the name you gave

196
00:07:46,610 --> 00:07:51,260
it and all its points and experience and

197
00:07:48,530 --> 00:07:52,700
all its history while you can beat the

198
00:07:51,260 --> 00:07:54,950
game with what comes in the starter kit

199
00:07:52,700 --> 00:07:56,539
to reach 100% completion and to collect

200
00:07:54,950 --> 00:07:58,130
every achievement you need to buy

201
00:07:56,540 --> 00:08:00,950
additional types of characters and

202
00:07:58,130 --> 00:08:01,820
expansion toys and Skylanders was a huge

203
00:08:00,950 --> 00:08:03,500
success

204
00:08:01,820 --> 00:08:06,010
sequels were shipped every year

205
00:08:03,500 --> 00:08:08,210
variously offering extra large figures

206
00:08:06,010 --> 00:08:11,390
recombine able figures with twice the

207
00:08:08,210 --> 00:08:15,099
NFC tags or vehicle figures resulting in

208
00:08:11,390 --> 00:08:17,539
over 350 Skylanders toys of all types

209
00:08:15,100 --> 00:08:19,490
earlier we said that some Android phones

210
00:08:17,540 --> 00:08:21,800
one that's ones that support Google pay

211
00:08:19,490 --> 00:08:23,780
can talk NFC and so an Android phone

212
00:08:21,800 --> 00:08:25,820
will be the first of three standard

213
00:08:23,780 --> 00:08:27,770
tools I'll be discussing when you're

214
00:08:25,820 --> 00:08:29,659
exploring NFC tags on your own it's

215
00:08:27,770 --> 00:08:31,820
easiest to look for an Android phone

216
00:08:29,660 --> 00:08:34,430
with Google pay support any Android

217
00:08:31,820 --> 00:08:37,968
phone with NFC support can read any NFC

218
00:08:34,429 --> 00:08:41,900
type one through four tag however the

219
00:08:37,969 --> 00:08:44,390
proprietary NXP Mifare tags can only be

220
00:08:41,900 --> 00:08:46,730
read by phones with NFC chips produced

221
00:08:44,390 --> 00:08:48,920
by nxp you should be able to find an

222
00:08:46,730 --> 00:08:50,480
older Android phone with NFC support for

223
00:08:48,920 --> 00:08:54,240
under 100

224
00:08:50,480 --> 00:08:56,400
so what happens when we swipe an NFC toy

225
00:08:54,240 --> 00:08:59,010
against an appropriate Android phone

226
00:08:56,400 --> 00:09:00,810
this is a ninja knee figure from

227
00:08:59,010 --> 00:09:02,610
Activision Skylanders when swiped

228
00:09:00,810 --> 00:09:06,300
against an Android phone with NFC

229
00:09:02,610 --> 00:09:08,370
support running the app NFC tools it

230
00:09:06,300 --> 00:09:10,979
gives us five pieces of information as

231
00:09:08,370 --> 00:09:12,810
it should some of the expected uses for

232
00:09:10,980 --> 00:09:15,390
NFC are for things like business cards

233
00:09:12,810 --> 00:09:17,430
and advertisements so some information

234
00:09:15,390 --> 00:09:19,860
can always be read from an NFC tag using

235
00:09:17,430 --> 00:09:22,349
standard tools and this represents some

236
00:09:19,860 --> 00:09:24,270
of that standard public information the

237
00:09:22,350 --> 00:09:27,690
first thing we see is that it's an NX P

238
00:09:24,270 --> 00:09:29,910
brand tag NX fee is a major manufacturer

239
00:09:27,690 --> 00:09:31,740
of NFC tags and they've promoted the use

240
00:09:29,910 --> 00:09:35,370
of their NFC tags in games like

241
00:09:31,740 --> 00:09:37,410
Skylanders since at least 2011 we also

242
00:09:35,370 --> 00:09:41,190
see the serial number for the tag called

243
00:09:37,410 --> 00:09:43,550
the UID and the 80 QA and si K which

244
00:09:41,190 --> 00:09:46,650
help identify the type of tag it is

245
00:09:43,550 --> 00:09:49,290
since it's an NX P tag let's see if NX

246
00:09:46,650 --> 00:09:52,860
P's own app and XP tag info can tell us

247
00:09:49,290 --> 00:09:55,709
anything more so I got to say these

248
00:09:52,860 --> 00:09:58,230
screens are kind of empty they're not

249
00:09:55,710 --> 00:10:00,110
telling us much more than NFC tools did

250
00:09:58,230 --> 00:10:02,910
and that is actually a little unusual

251
00:10:00,110 --> 00:10:05,370
let me show you what some other NFC tags

252
00:10:02,910 --> 00:10:07,199
look like in the same NX p tag info app

253
00:10:05,370 --> 00:10:10,320
here's a payment card from my local

254
00:10:07,200 --> 00:10:12,780
arcade while the first two screens are

255
00:10:10,320 --> 00:10:14,910
pretty bare the third one shows us the

256
00:10:12,780 --> 00:10:16,949
memory size which is how much stores the

257
00:10:14,910 --> 00:10:19,589
tag has and how it's set up and the

258
00:10:16,950 --> 00:10:22,170
fourth one shows us the actual data on

259
00:10:19,590 --> 00:10:23,610
the card and it formats it to match up

260
00:10:22,170 --> 00:10:27,000
with the description in the memory size

261
00:10:23,610 --> 00:10:29,790
this is laid out just like the data is

262
00:10:27,000 --> 00:10:33,960
stored on the tag in this case 16

263
00:10:29,790 --> 00:10:36,810
sectors with four rows of 16 bytes each

264
00:10:33,960 --> 00:10:39,150
we can see this because along with the

265
00:10:36,810 --> 00:10:41,550
standard public information that every

266
00:10:39,150 --> 00:10:43,860
tag presents for NFC tags which can be

267
00:10:41,550 --> 00:10:45,930
protected there are also standard keys

268
00:10:43,860 --> 00:10:48,750
and passwords which are commonly used

269
00:10:45,930 --> 00:10:50,670
often to allow for public readers while

270
00:10:48,750 --> 00:10:54,090
still restricting who can write to or

271
00:10:50,670 --> 00:10:56,760
update a tag that this tag uses a common

272
00:10:54,090 --> 00:10:59,970
standard factory default key meaning

273
00:10:56,760 --> 00:11:02,040
anyone can see what's on it here's a

274
00:10:59,970 --> 00:11:03,300
pair of bluetooth headphones which embed

275
00:11:02,040 --> 00:11:05,819
an NFC tag

276
00:11:03,300 --> 00:11:07,920
or easy pairing with your phone this one

277
00:11:05,820 --> 00:11:09,540
is great the second screen explains a

278
00:11:07,920 --> 00:11:11,550
lot of the technical details of the

279
00:11:09,540 --> 00:11:13,410
content like the manufacturer the model

280
00:11:11,550 --> 00:11:16,260
of the head said the kinds of Bluetooth

281
00:11:13,410 --> 00:11:18,180
protocols it supports and more the

282
00:11:16,260 --> 00:11:19,860
fourth screen again shows us all the raw

283
00:11:18,180 --> 00:11:22,319
content that it's getting all that

284
00:11:19,860 --> 00:11:24,810
information from again laid out how it's

285
00:11:22,320 --> 00:11:27,320
stored in the tag in this case four rows

286
00:11:24,810 --> 00:11:29,819
of four bytes each called pages

287
00:11:27,320 --> 00:11:31,860
unfortunately the asterisks here mean

288
00:11:29,820 --> 00:11:34,350
it's read only there's no way to write

289
00:11:31,860 --> 00:11:37,740
to this NFC tag and for example change

290
00:11:34,350 --> 00:11:40,140
what it identifies as for pairing here's

291
00:11:37,740 --> 00:11:42,269
a business card printed by mu which

292
00:11:40,140 --> 00:11:44,699
embeds an NFC tag to support sharing

293
00:11:42,269 --> 00:11:47,160
contact information sending the user to

294
00:11:44,700 --> 00:11:49,290
a URL or app store or social network

295
00:11:47,160 --> 00:11:51,719
profile or even triggering custom

296
00:11:49,290 --> 00:11:53,730
behaviors using if this than that this

297
00:11:51,720 --> 00:11:55,829
tag was set up to send a notification to

298
00:11:53,730 --> 00:11:59,760
my phone when someone taps it and then

299
00:11:55,829 --> 00:12:01,859
direct them to NFC toys this output is

300
00:11:59,760 --> 00:12:03,689
also really detailed the second screen

301
00:12:01,860 --> 00:12:06,420
explains the technical details of the

302
00:12:03,690 --> 00:12:08,399
content in this case the MU URL that

303
00:12:06,420 --> 00:12:10,920
provides all of the custom functionality

304
00:12:08,399 --> 00:12:12,510
through their online service the third

305
00:12:10,920 --> 00:12:14,640
screen has detailed information about

306
00:12:12,510 --> 00:12:16,439
the NFC tag itself and the fourth screen

307
00:12:14,640 --> 00:12:18,149
again shows us all the raw memory

308
00:12:16,440 --> 00:12:20,970
content that it's getting all of that

309
00:12:18,149 --> 00:12:23,070
information from again this is in a

310
00:12:20,970 --> 00:12:25,320
pages structure the entire business card

311
00:12:23,070 --> 00:12:27,690
appears writable meaning we can put

312
00:12:25,320 --> 00:12:31,079
anything we want to on it even replacing

313
00:12:27,690 --> 00:12:33,690
moves online service with our own so

314
00:12:31,079 --> 00:12:35,670
those other NFC tags show me memory

315
00:12:33,690 --> 00:12:39,690
contents and the layout of the data on

316
00:12:35,670 --> 00:12:41,579
the tag but the TN P 3 X X X in the

317
00:12:39,690 --> 00:12:44,339
skylander figure doesn't show me

318
00:12:41,579 --> 00:12:48,000
anything we know that it has memory the

319
00:12:44,339 --> 00:12:49,709
third tab says so so what's up to figure

320
00:12:48,000 --> 00:12:51,449
it out let's use that elite hacking

321
00:12:49,709 --> 00:12:54,779
technique called go poking around the

322
00:12:51,449 --> 00:12:58,319
internet like if we search NX P's

323
00:12:54,779 --> 00:13:01,769
website for TN P 3 X xx we find it in

324
00:12:58,320 --> 00:13:04,670
this PDF describing ways to identify an

325
00:13:01,769 --> 00:13:07,410
X P my fare tags so it's a my fare tag

326
00:13:04,670 --> 00:13:09,899
curiously it doesn't have any other

327
00:13:07,410 --> 00:13:12,209
information but table 2 in this PDF

328
00:13:09,899 --> 00:13:15,540
describes another Mifare tag with 1k of

329
00:13:12,209 --> 00:13:17,010
memory the Mifare classic Wikipedia

330
00:13:15,540 --> 00:13:19,469
describes the Mifare classic

331
00:13:17,010 --> 00:13:21,240
memory sizes so it matches the

332
00:13:19,470 --> 00:13:24,180
description of what the third screenshot

333
00:13:21,240 --> 00:13:27,930
from an XP tag info told us so maybe the

334
00:13:24,180 --> 00:13:28,500
tnp 3 xxx is a Mifare classic compatible

335
00:13:27,930 --> 00:13:31,410
tag

336
00:13:28,500 --> 00:13:35,310
even if tag info presents pretends to

337
00:13:31,410 --> 00:13:39,780
not know what it is Wikipedia also says

338
00:13:35,310 --> 00:13:42,209
this as a common type of NFC tag

339
00:13:39,780 --> 00:13:45,750
Mifare classic is pretty well explored

340
00:13:42,210 --> 00:13:48,360
from a security standpoint if n TN p3

341
00:13:45,750 --> 00:13:50,130
xxx is a Mifare classic derivative

342
00:13:48,360 --> 00:13:52,500
could it be vulnerable to the same

343
00:13:50,130 --> 00:13:58,830
exploits that Mifare classic tags are

344
00:13:52,500 --> 00:14:01,290
allowing us access to the tag so that's

345
00:13:58,830 --> 00:14:03,240
as far as we can get on a Skylanders toy

346
00:14:01,290 --> 00:14:05,010
with an Android phone so it's time to

347
00:14:03,240 --> 00:14:06,470
upgrade to the second set of three

348
00:14:05,010 --> 00:14:09,270
standard tools I'll be discussing

349
00:14:06,470 --> 00:14:12,030
dedicated NFC reader hardware plugged

350
00:14:09,270 --> 00:14:13,650
into your computer we want to look for

351
00:14:12,030 --> 00:14:16,260
hardware that's compatible with the Lib

352
00:14:13,650 --> 00:14:18,360
NFC open source library which supports a

353
00:14:16,260 --> 00:14:20,850
select range of NFC reader chips on

354
00:14:18,360 --> 00:14:23,310
Linux Mac and even Windows with some

355
00:14:20,850 --> 00:14:25,350
futzing we want Lib NFC compatible

356
00:14:23,310 --> 00:14:27,359
hardware because a lot of the dedicated

357
00:14:25,350 --> 00:14:30,090
NFC readers you'll find our windows only

358
00:14:27,360 --> 00:14:31,860
or only expose low-level communication

359
00:14:30,090 --> 00:14:34,380
functions requiring more complex

360
00:14:31,860 --> 00:14:36,720
technical programming there are higher

361
00:14:34,380 --> 00:14:38,850
level easier to use libraries and

362
00:14:36,720 --> 00:14:40,650
various languages which use Lib NFC

363
00:14:38,850 --> 00:14:43,350
under the hood so it provides security

364
00:14:40,650 --> 00:14:46,590
researchers and hobbyists alike with a

365
00:14:43,350 --> 00:14:49,610
standard platform you can find a Lib NFC

366
00:14:46,590 --> 00:14:51,870
supported NFC reader for around $50 in

367
00:14:49,610 --> 00:14:53,880
addition to a supported NFC reader

368
00:14:51,870 --> 00:14:55,980
plugged into our Mac or Linux computer

369
00:14:53,880 --> 00:14:57,630
you'll also need to already know or be

370
00:14:55,980 --> 00:15:00,510
comfortable figuring out how to compile

371
00:14:57,630 --> 00:15:03,960
software yourselves but we won't need to

372
00:15:00,510 --> 00:15:05,850
write anything new so Wikipedia

373
00:15:03,960 --> 00:15:08,070
describes something like 9 different

374
00:15:05,850 --> 00:15:11,460
papers and presentations going back to

375
00:15:08,070 --> 00:15:14,400
2007 which provide various attacks on

376
00:15:11,460 --> 00:15:17,730
and compromises to Mifare classic tags

377
00:15:14,400 --> 00:15:20,459
in addition nxp released so-called

378
00:15:17,730 --> 00:15:24,120
hardened versions of my fare tags quote

379
00:15:20,460 --> 00:15:25,800
in and around 2011 in exploring this

380
00:15:24,120 --> 00:15:27,150
ninja natori we're really just taking

381
00:15:25,800 --> 00:15:28,310
the next steps in a long line of

382
00:15:27,150 --> 00:15:30,920
scholarship

383
00:15:28,310 --> 00:15:33,380
now this ninja new toy is from 2000

384
00:15:30,920 --> 00:15:35,029
12 the Giants line I use it B as an

385
00:15:33,380 --> 00:15:36,950
example because it's bigger and it

386
00:15:35,029 --> 00:15:39,019
lights up but if it's a Mifare classic

387
00:15:36,950 --> 00:15:41,269
tag in disguise we're going to have to

388
00:15:39,019 --> 00:15:43,399
use a compromise that works against the

389
00:15:41,269 --> 00:15:47,060
hardened version of the tag like the one

390
00:15:43,399 --> 00:15:49,279
from this paper published in 2015 which

391
00:15:47,060 --> 00:15:52,699
finally led nxp to tell people to stop

392
00:15:49,279 --> 00:15:56,120
using them now all you need is one known

393
00:15:52,699 --> 00:15:57,920
key but what's a key so remember that

394
00:15:56,120 --> 00:16:00,649
payment card from earlier than its

395
00:15:57,920 --> 00:16:02,689
memory layout this is the same as how a

396
00:16:00,649 --> 00:16:05,800
Mifare classic tag is laid out in

397
00:16:02,690 --> 00:16:08,690
sixteen sectors numbered 0 through 15

398
00:16:05,800 --> 00:16:11,839
each of those rows in each sector is

399
00:16:08,690 --> 00:16:15,019
called a block each block can store 16

400
00:16:11,839 --> 00:16:19,579
bytes 16 bytes x 4 blocks

401
00:16:15,019 --> 00:16:22,040
x 16 sectors is 1k of storage the last

402
00:16:19,579 --> 00:16:25,579
block in each sector stores two

403
00:16:22,040 --> 00:16:28,069
passwords called key a and key B with

404
00:16:25,579 --> 00:16:29,689
access bits in between them which define

405
00:16:28,070 --> 00:16:31,519
which of the keys can read or write the

406
00:16:29,690 --> 00:16:33,829
blocks as well as read or write the

407
00:16:31,519 --> 00:16:34,519
other key in this sector from the

408
00:16:33,829 --> 00:16:37,459
payment card

409
00:16:34,519 --> 00:16:39,829
the first password key a is hidden

410
00:16:37,459 --> 00:16:42,170
unknown next out which probably means

411
00:16:39,829 --> 00:16:44,810
you need to Amina to update the dollar

412
00:16:42,170 --> 00:16:46,880
figure on the card the second pass where

413
00:16:44,810 --> 00:16:48,709
key B is the factory default key and

414
00:16:46,880 --> 00:16:50,720
it's readable which means we can see it

415
00:16:48,709 --> 00:16:52,579
that probably also means we can only use

416
00:16:50,720 --> 00:16:56,690
it to see what data is on the tag but

417
00:16:52,579 --> 00:16:59,029
not change it 16 sectors a key a and a

418
00:16:56,690 --> 00:17:01,310
key B each mean there can be up to 32

419
00:16:59,029 --> 00:17:03,890
passwords you need to uncover to get

420
00:17:01,310 --> 00:17:06,770
access to a completely locked down 1k

421
00:17:03,890 --> 00:17:08,929
Mifare classic tag but what this paper

422
00:17:06,770 --> 00:17:11,240
tells us is that we only need to know

423
00:17:08,929 --> 00:17:13,280
one and do two vulnerabilities in the

424
00:17:11,240 --> 00:17:15,650
logic on the tag it can figure out the

425
00:17:13,280 --> 00:17:17,869
rest from there knowing one in advance

426
00:17:15,650 --> 00:17:19,819
is not as difficult to task as it might

427
00:17:17,869 --> 00:17:22,668
seem like obviously we already know one

428
00:17:19,819 --> 00:17:25,369
for this payment card and maybe the T NP

429
00:17:22,669 --> 00:17:27,799
3 xxx has a similar situation we could

430
00:17:25,369 --> 00:17:30,290
search the documentation and source code

431
00:17:27,799 --> 00:17:32,299
for common Mifare keys and try each one

432
00:17:30,290 --> 00:17:34,909
of them against the key a and key B for

433
00:17:32,299 --> 00:17:36,620
every sector and spoiler alert it'll

434
00:17:34,910 --> 00:17:39,620
eventually work you'll eventually find

435
00:17:36,620 --> 00:17:41,719
one but this is 2018 and you have

436
00:17:39,620 --> 00:17:43,459
slightly newer information available to

437
00:17:41,720 --> 00:17:44,510
you than I did when I did that myself

438
00:17:43,460 --> 00:17:46,730
back into that

439
00:17:44,510 --> 00:17:50,240
14 so let's head back to the internet to

440
00:17:46,730 --> 00:17:52,790
find it so we're looking for a known key

441
00:17:50,240 --> 00:17:54,710
for a Skylanders toy and some not so

442
00:17:52,790 --> 00:17:57,200
creative searching Nets us an

443
00:17:54,710 --> 00:18:00,169
interesting paper comprehensive security

444
00:17:57,200 --> 00:18:02,600
analyses of a toys to life game and

445
00:18:00,169 --> 00:18:05,809
possible countermeasures master's thesis

446
00:18:02,600 --> 00:18:07,610
by Kevin Volk and when you find the

447
00:18:05,809 --> 00:18:09,309
author's homepage you also find the fact

448
00:18:07,610 --> 00:18:13,699
that he worked with toys for Bob

449
00:18:09,309 --> 00:18:15,980
developers of Skylanders for a year now

450
00:18:13,700 --> 00:18:18,860
the thesis never says Skylanders by name

451
00:18:15,980 --> 00:18:20,510
but knowing what we know now it's easy

452
00:18:18,860 --> 00:18:22,969
to recognize that's what it's about and

453
00:18:20,510 --> 00:18:27,530
it contains exactly what we're looking

454
00:18:22,970 --> 00:18:30,919
for and this it says that the first key

455
00:18:27,530 --> 00:18:34,629
the key a in every toy is the same and

456
00:18:30,919 --> 00:18:39,320
what does the paper say the first key is

457
00:18:34,630 --> 00:18:41,960
yes okay so thanks to two research

458
00:18:39,320 --> 00:18:43,520
papers we have a known key and we have

459
00:18:41,960 --> 00:18:45,650
an attack vector and now we just need

460
00:18:43,520 --> 00:18:48,830
software to run it that works with Liban

461
00:18:45,650 --> 00:18:50,660
FC let's look for cipher text only

462
00:18:48,830 --> 00:18:54,320
cryptanalysis and hardened Mifare

463
00:18:50,660 --> 00:18:55,580
classic tags liban FC and a little ways

464
00:18:54,320 --> 00:18:58,340
down the page we have an implementation

465
00:18:55,580 --> 00:19:01,309
of the papers algorithms suitable for

466
00:18:58,340 --> 00:19:03,530
use with Liban FC and if you compile and

467
00:19:01,309 --> 00:19:05,570
run their lib NFC crypto one crack

468
00:19:03,530 --> 00:19:08,210
program with a giant's figure you get a

469
00:19:05,570 --> 00:19:10,610
valid key for block four in Sector one

470
00:19:08,210 --> 00:19:12,980
and you can repeat that for a block in

471
00:19:10,610 --> 00:19:14,659
each of the remaining sectors and just

472
00:19:12,980 --> 00:19:16,730
to make sure let's try it with an even

473
00:19:14,660 --> 00:19:19,790
later model trap team figure and we get

474
00:19:16,730 --> 00:19:21,650
a valid key for block 9 sector 2 and you

475
00:19:19,790 --> 00:19:24,649
can repeat that for a block in each of

476
00:19:21,650 --> 00:19:29,990
the remaining sectors with this you can

477
00:19:24,650 --> 00:19:32,179
get keys a for every Skylanders toy you

478
00:19:29,990 --> 00:19:34,160
can then plug these into any Lib NFC

479
00:19:32,179 --> 00:19:36,080
Mifare reading app or into Mifare

480
00:19:34,160 --> 00:19:38,270
reading apps on your supported Android

481
00:19:36,080 --> 00:19:40,070
phone assuming the apps recognize the

482
00:19:38,270 --> 00:19:42,559
Skylanders toy as Mifare classic tags

483
00:19:40,070 --> 00:19:45,260
and see the full contents of the toy

484
00:19:42,559 --> 00:19:47,120
that looks like this just like in the

485
00:19:45,260 --> 00:19:50,360
payment card you can see the access bits

486
00:19:47,120 --> 00:19:53,689
on every fourth line sector 0 blocks 0

487
00:19:50,360 --> 00:19:56,979
to 3 has the access bits 0 F 0 F 0 F

488
00:19:53,690 --> 00:19:59,110
sector 1 blocks 4 to 7 and

489
00:19:56,980 --> 00:20:03,880
every sector after that have the access

490
00:19:59,110 --> 00:20:05,918
bits 7 f 0 f 0 8 if we look in NX P's

491
00:20:03,880 --> 00:20:07,510
Mifare classic documentation we see that

492
00:20:05,919 --> 00:20:10,480
we have to turn it into binary and we'll

493
00:20:07,510 --> 00:20:12,610
learn this sector 0 the first four

494
00:20:10,480 --> 00:20:15,520
blocks on the toy is completely

495
00:20:12,610 --> 00:20:19,090
read-only every other sector is writable

496
00:20:15,520 --> 00:20:20,500
by its key a we can't ever read each key

497
00:20:19,090 --> 00:20:24,040
a so we always have to know them in

498
00:20:20,500 --> 00:20:26,530
advance key B is all zeros which is a

499
00:20:24,040 --> 00:20:28,570
really common password but it can't do

500
00:20:26,530 --> 00:20:30,570
anything so it's all it's really good

501
00:20:28,570 --> 00:20:32,980
for is being used to exploit other keys

502
00:20:30,570 --> 00:20:34,990
there's more in there but that's enough

503
00:20:32,980 --> 00:20:37,960
for us to know that we can completely

504
00:20:34,990 --> 00:20:40,299
own any given Skylanders toy with a

505
00:20:37,960 --> 00:20:42,580
method to obtain all the keys a we have

506
00:20:40,299 --> 00:20:45,580
full read and write access to every

507
00:20:42,580 --> 00:20:47,799
available block that's 15 sectors 3

508
00:20:45,580 --> 00:20:49,480
writable blocks of 16 bytes each for a

509
00:20:47,799 --> 00:20:53,950
total of seven hundred and twenty bytes

510
00:20:49,480 --> 00:20:55,600
we can write anything we want to but

511
00:20:53,950 --> 00:20:57,070
there's one more thing going back to

512
00:20:55,600 --> 00:20:59,320
that quote we pulled from the Volk

513
00:20:57,070 --> 00:21:02,260
thesis for the toys to work as they do

514
00:20:59,320 --> 00:21:05,110
across multiple platforms and offline

515
00:21:02,260 --> 00:21:07,809
and with every key a on every toy being

516
00:21:05,110 --> 00:21:10,479
different there has to be some formula

517
00:21:07,809 --> 00:21:12,760
or math that sets them that the portal

518
00:21:10,480 --> 00:21:14,620
or the game knows about that has to be

519
00:21:12,760 --> 00:21:16,840
based on some fixed immutable

520
00:21:14,620 --> 00:21:19,899
information about the character like the

521
00:21:16,840 --> 00:21:22,030
content in Sector zero so how do you

522
00:21:19,900 --> 00:21:23,770
figure out what that formula is well if

523
00:21:22,030 --> 00:21:25,780
you're like me or like the security

524
00:21:23,770 --> 00:21:28,240
researchers who also eventually figured

525
00:21:25,780 --> 00:21:31,660
it out you buy and you crack a lot more

526
00:21:28,240 --> 00:21:35,260
toys as RFID and security researchers

527
00:21:31,660 --> 00:21:38,200
discovered across 2014 and 2015 if you

528
00:21:35,260 --> 00:21:40,270
collect enough keys and do some math you

529
00:21:38,200 --> 00:21:42,100
can see patterns and how each sectors

530
00:21:40,270 --> 00:21:43,540
keys relate to each other and come up

531
00:21:42,100 --> 00:21:46,870
with more than one method to generate

532
00:21:43,540 --> 00:21:48,220
the keys Volks thesis even included the

533
00:21:46,870 --> 00:21:50,139
fact that the patterns and the keys

534
00:21:48,220 --> 00:21:52,510
could be discovered documenting that

535
00:21:50,140 --> 00:21:54,610
there were patterns but he didn't go so

536
00:21:52,510 --> 00:21:58,510
far as to document what the patterns

537
00:21:54,610 --> 00:22:01,030
meant so today I present the first

538
00:21:58,510 --> 00:22:04,110
public cleanroom description of an

539
00:22:01,030 --> 00:22:06,730
algorithm to generate the keys a for all

540
00:22:04,110 --> 00:22:08,949
Skylanders figures released to date I'm

541
00:22:06,730 --> 00:22:10,690
publishing this to support new

542
00:22:08,950 --> 00:22:13,660
interoperability of active

543
00:22:10,690 --> 00:22:15,610
Skylanders NFC toys by knowing an

544
00:22:13,660 --> 00:22:18,430
algorithm used to set the read and write

545
00:22:15,610 --> 00:22:20,709
passwords keys a we can interoperable

546
00:22:18,430 --> 00:22:23,650
read and write our own data to

547
00:22:20,710 --> 00:22:25,780
Skylanders NFC toys using our own NFC

548
00:22:23,650 --> 00:22:29,610
harbours and software without tedious

549
00:22:25,780 --> 00:22:37,810
manual cracking on a per table ASIS

550
00:22:29,610 --> 00:22:39,580
thank you on NFC dot toys you'll find a

551
00:22:37,810 --> 00:22:42,100
video showing me writing custom data

552
00:22:39,580 --> 00:22:44,590
using a Mac using an off-the-shelf USB

553
00:22:42,100 --> 00:22:47,050
NFC reader and reading that custom data

554
00:22:44,590 --> 00:22:49,209
back out with a Raspberry Pi using an

555
00:22:47,050 --> 00:22:50,980
off-the-shelf NFC add-on you'll also

556
00:22:49,210 --> 00:22:55,270
find a sample implementation of the

557
00:22:50,980 --> 00:22:56,980
algorithm in Python 2 so that's it for

558
00:22:55,270 --> 00:22:59,980
Skylanders let's talk about Disney

559
00:22:56,980 --> 00:23:03,150
infinity next round of applause who has

560
00:22:59,980 --> 00:23:05,740
kids who are into Disney infinity No

561
00:23:03,150 --> 00:23:08,230
round of applause who is personally into

562
00:23:05,740 --> 00:23:10,230
Disney infinity and was devastated as I

563
00:23:08,230 --> 00:23:14,740
was when they canceled the series Oh

564
00:23:10,230 --> 00:23:17,230
y'all missed out so for everyone else

565
00:23:14,740 --> 00:23:19,780
Disney infinity was Disney's entry into

566
00:23:17,230 --> 00:23:22,330
the toys to life genre launched in 2013

567
00:23:19,780 --> 00:23:23,920
as in Skylanders the toy you place on

568
00:23:22,330 --> 00:23:26,320
their base is the character you play us

569
00:23:23,920 --> 00:23:28,480
in the game unlike Skylanders which is

570
00:23:26,320 --> 00:23:30,520
mostly all original IP Disney infinity

571
00:23:28,480 --> 00:23:32,620
let you play with characters from many

572
00:23:30,520 --> 00:23:34,629
different Disney properties all together

573
00:23:32,620 --> 00:23:37,449
in an open-world sandbox called

574
00:23:34,630 --> 00:23:39,280
the toy box there were also separate

575
00:23:37,450 --> 00:23:41,230
story based environments for specific

576
00:23:39,280 --> 00:23:43,870
environments and characters such as a

577
00:23:41,230 --> 00:23:46,720
Pirates of the Caribbean playset various

578
00:23:43,870 --> 00:23:49,510
Pixar playsets various Marvel playsets

579
00:23:46,720 --> 00:23:52,570
and various Star Wars playsets sequels

580
00:23:49,510 --> 00:23:55,960
were released in 2014 and 2015 resulting

581
00:23:52,570 --> 00:23:58,810
in over 300 NFC toys between figures and

582
00:23:55,960 --> 00:24:01,660
accessories this is a kanan jarrus

583
00:23:58,810 --> 00:24:04,389
figure from Disney infinity as seen in

584
00:24:01,660 --> 00:24:06,820
NXP tag info here again we can see that

585
00:24:04,390 --> 00:24:09,460
it's an NX P tag also specifically a

586
00:24:06,820 --> 00:24:12,070
Mifare classic tag we can see that

587
00:24:09,460 --> 00:24:14,440
there's 320 bytes total on this tag we

588
00:24:12,070 --> 00:24:17,590
can see its ID and it's 80 QA and it's

589
00:24:14,440 --> 00:24:20,440
sa K and we can also see memory content

590
00:24:17,590 --> 00:24:22,419
it's all crossed out and reports unknown

591
00:24:20,440 --> 00:24:24,320
key and it's like that for all the way

592
00:24:22,420 --> 00:24:26,330
down for all 321

593
00:24:24,320 --> 00:24:28,250
but at least we can see the structure of

594
00:24:26,330 --> 00:24:30,199
the storage on the tag which we couldn't

595
00:24:28,250 --> 00:24:31,670
for the sky lender now we're less

596
00:24:30,200 --> 00:24:33,980
fortunate working with Disney infinity

597
00:24:31,670 --> 00:24:35,990
figures none of the ten keys or standard

598
00:24:33,980 --> 00:24:38,300
keys so any exploit that relies on

599
00:24:35,990 --> 00:24:41,180
knowing a key won't work in addition

600
00:24:38,300 --> 00:24:43,870
Disney infinity came out in 2013 well

601
00:24:41,180 --> 00:24:46,250
after an XP hardened the Mifare classic

602
00:24:43,870 --> 00:24:47,719
to get into these figures we're going to

603
00:24:46,250 --> 00:24:49,150
have to upgrade to the third of the

604
00:24:47,720 --> 00:24:52,610
three standard tools I'll be discussing

605
00:24:49,150 --> 00:24:54,740
specialized RFID testing equipment now

606
00:24:52,610 --> 00:24:56,990
phones and live NFC compatible hardware

607
00:24:54,740 --> 00:24:58,940
can get you far but to figure out NXP

608
00:24:56,990 --> 00:25:01,430
tag NFC tags that are password protected

609
00:24:58,940 --> 00:25:03,050
and not exploitable you'll need to be

610
00:25:01,430 --> 00:25:04,790
able to listen in on the wireless

611
00:25:03,050 --> 00:25:07,159
communication between the tag and the

612
00:25:04,790 --> 00:25:10,040
reader and that means using more serious

613
00:25:07,160 --> 00:25:12,650
Hardware the proxmark was an open source

614
00:25:10,040 --> 00:25:14,450
design for RFID test equipment providing

615
00:25:12,650 --> 00:25:16,040
high-end functionality at a much lower

616
00:25:14,450 --> 00:25:18,800
price point than commercial test

617
00:25:16,040 --> 00:25:21,889
equipment because NFC is a subset of

618
00:25:18,800 --> 00:25:25,040
RFID it also it also works for NFC toys

619
00:25:21,890 --> 00:25:27,080
but as specialized RFID test equipment

620
00:25:25,040 --> 00:25:29,889
it also requires a more thorough

621
00:25:27,080 --> 00:25:32,419
understanding of RFID in general

622
00:25:29,890 --> 00:25:34,190
depending on where you get it from a new

623
00:25:32,420 --> 00:25:36,500
proxmark 3 will run you two to four

624
00:25:34,190 --> 00:25:38,390
hundred dollars their community is very

625
00:25:36,500 --> 00:25:39,800
active and it's possible someone has

626
00:25:38,390 --> 00:25:41,000
already figured out the tag you're

627
00:25:39,800 --> 00:25:42,830
looking at although you'll need

628
00:25:41,000 --> 00:25:44,930
technical expertise to translate

629
00:25:42,830 --> 00:25:46,310
something that works on the proxmark to

630
00:25:44,930 --> 00:25:49,820
something that works for a general

631
00:25:46,310 --> 00:25:52,220
purpose NFC reader now a proxmark three

632
00:25:49,820 --> 00:25:54,110
will let us place our own antenna right

633
00:25:52,220 --> 00:25:56,090
up against the antenna in the NFC reader

634
00:25:54,110 --> 00:25:58,429
and the antenna in the NFC toy and

635
00:25:56,090 --> 00:26:00,980
listen in on the communication between

636
00:25:58,430 --> 00:26:02,630
the figure and the base remember all of

637
00:26:00,980 --> 00:26:04,970
this all of these data transfers are

638
00:26:02,630 --> 00:26:07,280
happening wirelessly over-the-air even

639
00:26:04,970 --> 00:26:09,800
though the toy and their base are only a

640
00:26:07,280 --> 00:26:12,610
few millimeters of plastic apart if we

641
00:26:09,800 --> 00:26:14,360
listen in we can get the keys

642
00:26:12,610 --> 00:26:15,830
unfortunately that also means we're

643
00:26:14,360 --> 00:26:17,479
going to need the video game and a

644
00:26:15,830 --> 00:26:19,790
console to play it on since we need the

645
00:26:17,480 --> 00:26:21,290
conversation to happen it was possible

646
00:26:19,790 --> 00:26:23,360
to get into a Skylanders figure with

647
00:26:21,290 --> 00:26:26,000
just a toy a thesis and a research paper

648
00:26:23,360 --> 00:26:27,409
but not so for figuring out Disney

649
00:26:26,000 --> 00:26:30,950
infinity and we'll talk about how that

650
00:26:27,410 --> 00:26:32,840
affects our risk later now when you have

651
00:26:30,950 --> 00:26:34,730
a proxmark listen in on the toy base

652
00:26:32,840 --> 00:26:36,980
communication you learned that Disney

653
00:26:34,730 --> 00:26:40,040
infinity toys use one key

654
00:26:36,980 --> 00:26:43,280
the entire toy both key a and B for all

655
00:26:40,040 --> 00:26:44,659
five sectors is the same neither one can

656
00:26:43,280 --> 00:26:47,299
be read so you need to know it in

657
00:26:44,660 --> 00:26:49,309
advance sector zero is read only and

658
00:26:47,299 --> 00:26:52,030
sectors one through four are readable

659
00:26:49,309 --> 00:26:54,950
and writeable by both key a and key B

660
00:26:52,030 --> 00:26:58,190
four sectors three blocks each means

661
00:26:54,950 --> 00:27:01,700
every toy has 192 bytes of storage we

662
00:26:58,190 --> 00:27:03,500
can use for our own purposes the other

663
00:27:01,700 --> 00:27:05,809
nice thing about having a proxmark is

664
00:27:03,500 --> 00:27:08,390
that it can simulate a My Fair tag I

665
00:27:05,809 --> 00:27:09,950
don't need to buy a bunch of Disney

666
00:27:08,390 --> 00:27:11,780
infinity toys to get a bunch of keys to

667
00:27:09,950 --> 00:27:14,120
see if there are patterns I can have the

668
00:27:11,780 --> 00:27:15,889
proxmark pretend to be a tag with a

669
00:27:14,120 --> 00:27:18,080
randomly generated ID and then have it

670
00:27:15,890 --> 00:27:21,140
listen in on what key the base would use

671
00:27:18,080 --> 00:27:23,020
for it and when you do this for dozens

672
00:27:21,140 --> 00:27:26,809
of keys and regular patterns you find

673
00:27:23,020 --> 00:27:28,850
there's no pattern at all when there

674
00:27:26,809 --> 00:27:30,410
aren't any patterns the only solution

675
00:27:28,850 --> 00:27:32,418
left is to reverse-engineer the

676
00:27:30,410 --> 00:27:34,460
algorithm by figuring out where it lives

677
00:27:32,419 --> 00:27:36,320
and then extracting it from the software

678
00:27:34,460 --> 00:27:38,090
or firmware and as a liberal arts major

679
00:27:36,320 --> 00:27:40,850
I don't really have the engineering

680
00:27:38,090 --> 00:27:42,709
experience for that what I could do

681
00:27:40,850 --> 00:27:45,530
though is what I was just doing but at

682
00:27:42,710 --> 00:27:47,450
web scale so for about 16 months I ran a

683
00:27:45,530 --> 00:27:48,799
web service that accepted a Disney

684
00:27:47,450 --> 00:27:50,809
infinity toy UID

685
00:27:48,799 --> 00:27:53,030
passed it along to a proxmark for

686
00:27:50,809 --> 00:27:54,740
simulation listened in for the key and

687
00:27:53,030 --> 00:27:56,450
then posted it publicly along with all

688
00:27:54,740 --> 00:27:58,880
the other you ideas that had ever been

689
00:27:56,450 --> 00:28:02,750
requested a kind of public UID key

690
00:27:58,880 --> 00:28:04,309
database but finally another security

691
00:28:02,750 --> 00:28:06,260
researcher did have the engineering

692
00:28:04,309 --> 00:28:08,299
experience and so today I can present

693
00:28:06,260 --> 00:28:10,760
the first public cleanroom description

694
00:28:08,299 --> 00:28:13,040
of an algorithm to generate the keys a

695
00:28:10,760 --> 00:28:15,190
and B for all Disney infinity figures

696
00:28:13,040 --> 00:28:18,220
released

697
00:28:15,190 --> 00:28:20,720
[Applause]

698
00:28:18,220 --> 00:28:23,120
this algorithm supports new

699
00:28:20,720 --> 00:28:25,460
interoperability of Disney infinity NFC

700
00:28:23,120 --> 00:28:26,899
toys by knowing the algorithm used to

701
00:28:25,460 --> 00:28:29,720
set the read and write passwords the

702
00:28:26,900 --> 00:28:31,970
keys a and B we can interoperate and

703
00:28:29,720 --> 00:28:34,010
write our own data to an infinity NFC

704
00:28:31,970 --> 00:28:35,740
toy using our own NFC hardware and

705
00:28:34,010 --> 00:28:37,790
software without tedious manual

706
00:28:35,740 --> 00:28:40,970
simulation and sniffing on a per two

707
00:28:37,790 --> 00:28:42,830
basis on NFC toys you'll find a video

708
00:28:40,970 --> 00:28:45,140
showing me writing custom data using a

709
00:28:42,830 --> 00:28:46,939
Mac and reading that custom data back

710
00:28:45,140 --> 00:28:48,350
out with an Android phone using a

711
00:28:46,940 --> 00:28:50,360
standard app from the Google Play Store

712
00:28:48,350 --> 00:28:54,740
you'll also find a sample implementation

713
00:28:50,360 --> 00:28:56,600
of that algorithm in Python 2 now there

714
00:28:54,740 --> 00:28:58,880
haven't been any new Skylanders figures

715
00:28:56,600 --> 00:29:02,090
in a year and Disney infinity was

716
00:28:58,880 --> 00:29:03,850
cancelled in 2016 but amiibo which is

717
00:29:02,090 --> 00:29:08,209
Nintendo's line of collectable figures

718
00:29:03,850 --> 00:29:11,540
playing cards and cereal is still going

719
00:29:08,210 --> 00:29:13,040
strong same thing as before a round of

720
00:29:11,540 --> 00:29:18,290
applause who has kids who regularly

721
00:29:13,040 --> 00:29:20,600
demand new amiibo figures so who has

722
00:29:18,290 --> 00:29:22,639
been forced to pirate amiibo figures

723
00:29:20,600 --> 00:29:24,350
either buying pre clone tags or clone

724
00:29:22,640 --> 00:29:27,950
tags because the amiibos you want always

725
00:29:24,350 --> 00:29:29,810
sell out before you can get one nobody's

726
00:29:27,950 --> 00:29:32,450
gonna admit to that ok

727
00:29:29,810 --> 00:29:34,820
for everyone else Nintendo launched

728
00:29:32,450 --> 00:29:36,860
amiibo in 2014 and in classic Nintendo

729
00:29:34,820 --> 00:29:38,780
fashion treats them as much as rare

730
00:29:36,860 --> 00:29:40,669
collectibles for obsessive adults as

731
00:29:38,780 --> 00:29:42,530
video game accessories for kids

732
00:29:40,670 --> 00:29:44,990
resulting in lines in front of stores on

733
00:29:42,530 --> 00:29:48,320
release days and toys selling out and

734
00:29:44,990 --> 00:29:51,260
never being reissued because NFC support

735
00:29:48,320 --> 00:29:53,990
is built into Nintendo's Wii U new 3ds

736
00:29:51,260 --> 00:29:55,879
and switch consoles no games specific

737
00:29:53,990 --> 00:29:58,100
reader is necessary for any game to

738
00:29:55,880 --> 00:30:00,650
provide a me Bo support you just swipe

739
00:29:58,100 --> 00:30:02,990
the toy right on the controller what

740
00:30:00,650 --> 00:30:05,060
each amiibo toy does is different in

741
00:30:02,990 --> 00:30:07,400
each game some support only specific

742
00:30:05,060 --> 00:30:09,310
figures some store gameplay data on the

743
00:30:07,400 --> 00:30:12,200
figure some will recognize any figure

744
00:30:09,310 --> 00:30:13,850
Nintendo lists over 60 games in the US

745
00:30:12,200 --> 00:30:15,560
with amiibo support and over a hundred

746
00:30:13,850 --> 00:30:17,870
and 60 toys and there are also

747
00:30:15,560 --> 00:30:21,560
additional Japan exclusive figures and

748
00:30:17,870 --> 00:30:24,530
games this is a duck hunt figure from

749
00:30:21,560 --> 00:30:27,440
Nintendo amiibo as seen in nxp tag info

750
00:30:24,530 --> 00:30:30,110
an XP tagged info says duck hunt is also

751
00:30:27,440 --> 00:30:30,720
an NX P this one a type 2 tag called n

752
00:30:30,110 --> 00:30:35,129
tag 2

753
00:30:30,720 --> 00:30:37,590
five with 504 bites made up of 126 pages

754
00:30:35,130 --> 00:30:39,140
with four bites per page similar to that

755
00:30:37,590 --> 00:30:41,360
pair of bluetooth headphones we saw

756
00:30:39,140 --> 00:30:43,830
here's the memory content

757
00:30:41,360 --> 00:30:45,959
unlike the Disney infinity figure nearly

758
00:30:43,830 --> 00:30:48,030
all of the amiibo is readable but some

759
00:30:45,960 --> 00:30:50,700
of it is marked as locked and blocked or

760
00:30:48,030 --> 00:30:52,620
blocked if we were figuring out amiibo

761
00:30:50,700 --> 00:30:54,299
ourselves we'd have to work it like we

762
00:30:52,620 --> 00:30:57,239
did Disney infinity but we're luckier

763
00:30:54,299 --> 00:30:59,100
here in two ways first by the time I got

764
00:30:57,240 --> 00:31:01,830
around to trying amiibo toys researcher

765
00:30:59,100 --> 00:31:03,449
Marcos del Sol vivaz had already figured

766
00:31:01,830 --> 00:31:06,360
out how to derive their password from

767
00:31:03,450 --> 00:31:08,340
the toys UID and services for it and

768
00:31:06,360 --> 00:31:11,219
code have been published across the

769
00:31:08,340 --> 00:31:13,020
internet since second many of us could

770
00:31:11,220 --> 00:31:15,030
probably have independently replicated

771
00:31:13,020 --> 00:31:17,490
his work just like fellow hope 2018 s

772
00:31:15,030 --> 00:31:19,200
figure James chambers did while the

773
00:31:17,490 --> 00:31:21,240
Skylanders math was pretty gnarly the

774
00:31:19,200 --> 00:31:24,450
amiibo math as presented is a bitwise

775
00:31:21,240 --> 00:31:26,250
exclusive or operation it's simple

776
00:31:24,450 --> 00:31:28,320
enough that you can do it by hand with

777
00:31:26,250 --> 00:31:29,880
pen and paper enabling us to write a

778
00:31:28,320 --> 00:31:32,490
hundred four hundred and twenty eight

779
00:31:29,880 --> 00:31:35,880
bytes of our own data onto any amiibo

780
00:31:32,490 --> 00:31:37,590
NFC toy so today along with presenting

781
00:31:35,880 --> 00:31:39,659
that public cleanroom description of an

782
00:31:37,590 --> 00:31:41,820
algorithm to generate the PWD for

783
00:31:39,659 --> 00:31:44,400
current amiibo figures I'm also handing

784
00:31:41,820 --> 00:31:47,789
out a worksheet with an amiibo card and

785
00:31:44,400 --> 00:31:50,429
it's UID so you can generate a PWD by

786
00:31:47,789 --> 00:31:52,710
hand yourself right now in your seat if

787
00:31:50,429 --> 00:31:55,530
you'd like these support new

788
00:31:52,710 --> 00:31:59,039
interoperability of Disney amiibo sorry

789
00:31:55,530 --> 00:32:00,990
Nintendo amiibo NFC toys by knowing an

790
00:31:59,039 --> 00:32:02,789
algorithm used to set the right password

791
00:32:00,990 --> 00:32:05,370
we can inter operatively write our own

792
00:32:02,789 --> 00:32:07,169
data to an amiibo NFC toy using our own

793
00:32:05,370 --> 00:32:09,809
NFC hardware and software without

794
00:32:07,169 --> 00:32:13,740
needing to compute the PWD by hand on a

795
00:32:09,809 --> 00:32:15,149
per day basis on NFC toys you'll find a

796
00:32:13,740 --> 00:32:17,520
video showing me writing custom data

797
00:32:15,150 --> 00:32:20,610
using a Raspberry Pi and reading that

798
00:32:17,520 --> 00:32:22,799
data out using a Windows 10 laptop using

799
00:32:20,610 --> 00:32:24,870
the open-source Google Chrome NFC

800
00:32:22,799 --> 00:32:26,370
library and again you'll also find a

801
00:32:24,870 --> 00:32:30,780
sample implementation of this algorithm

802
00:32:26,370 --> 00:32:32,370
in Python too before I hand out those

803
00:32:30,780 --> 00:32:33,960
worksheets though it's important to

804
00:32:32,370 --> 00:32:36,120
consider those legal subtleties I

805
00:32:33,960 --> 00:32:39,179
mentioned can we get in some sort of

806
00:32:36,120 --> 00:32:41,668
trouble if we do this so a few points of

807
00:32:39,179 --> 00:32:43,740
order again first I'm about to talk

808
00:32:41,669 --> 00:32:44,520
about legal stuff but I am NOT an

809
00:32:43,740 --> 00:32:47,190
attorney

810
00:32:44,520 --> 00:32:49,170
this is not legal advice if you intend

811
00:32:47,190 --> 00:32:51,809
to publicly discuss or publish your own

812
00:32:49,170 --> 00:32:53,820
NFC toy efforts especially if you

813
00:32:51,809 --> 00:32:56,520
explore areas beyond what this talk

814
00:32:53,820 --> 00:32:59,280
covers like the data encryption or the

815
00:32:56,520 --> 00:33:01,530
USB reader Hardware you should end your

816
00:32:59,280 --> 00:33:03,780
US citizen or you ever intend to visit

817
00:33:01,530 --> 00:33:04,740
the u.s. afterwards you should talk with

818
00:33:03,780 --> 00:33:06,899
an attorney first

819
00:33:04,740 --> 00:33:08,429
your local bar association can usually

820
00:33:06,900 --> 00:33:10,290
refer you to an appropriate attorney

821
00:33:08,429 --> 00:33:14,010
often with a free or reduced cost

822
00:33:10,290 --> 00:33:16,139
initial conversation second this is

823
00:33:14,010 --> 00:33:18,480
America where you can be sued by anyone

824
00:33:16,140 --> 00:33:20,190
at any time for any reason and then

825
00:33:18,480 --> 00:33:22,620
you're stuck having to defend yourself

826
00:33:20,190 --> 00:33:25,020
this is lawsuit as threatened model if

827
00:33:22,620 --> 00:33:26,189
you can't afford to defend yourself you

828
00:33:25,020 --> 00:33:29,370
should be taking that into consideration

829
00:33:26,190 --> 00:33:31,470
and third while the next several minutes

830
00:33:29,370 --> 00:33:33,750
may be an interesting discussion at the

831
00:33:31,470 --> 00:33:35,700
end of the day our opinion doesn't

832
00:33:33,750 --> 00:33:38,280
matter everything we're going to cover

833
00:33:35,700 --> 00:33:39,900
is a gray area of the law and I will be

834
00:33:38,280 --> 00:33:42,540
positioning it as such because it's

835
00:33:39,900 --> 00:33:46,260
things that can only be decided by a

836
00:33:42,540 --> 00:33:48,030
judge in a court alright so why are we

837
00:33:46,260 --> 00:33:49,770
suddenly talking about legal trouble

838
00:33:48,030 --> 00:33:51,899
when I've just discussed a long history

839
00:33:49,770 --> 00:33:52,470
of security research an academic

840
00:33:51,900 --> 00:33:54,690
scholarship

841
00:33:52,470 --> 00:33:57,030
some even acknowledged by the companies

842
00:33:54,690 --> 00:33:59,010
affected which actively and directly

843
00:33:57,030 --> 00:34:01,260
discuss security compromises in these

844
00:33:59,010 --> 00:34:04,260
two NFC tags and I'm just taking the

845
00:34:01,260 --> 00:34:08,489
next steps the reason is that legally

846
00:34:04,260 --> 00:34:12,780
some NFC toys may not count as regular

847
00:34:08,489 --> 00:34:16,049
NFC tags let's define NFC toys in a way

848
00:34:12,780 --> 00:34:19,800
that might help clarify this NFC toys

849
00:34:16,050 --> 00:34:23,359
are physical toys which embed NFC tags

850
00:34:19,800 --> 00:34:26,609
to support some sort of interaction the

851
00:34:23,359 --> 00:34:28,830
interaction is typically digital and is

852
00:34:26,609 --> 00:34:31,168
important now there are probably toys

853
00:34:28,830 --> 00:34:32,940
and embed NFC tags for tracking or anti

854
00:34:31,168 --> 00:34:35,310
counterfeiting purposes and we just

855
00:34:32,940 --> 00:34:37,050
don't know about them toys that use NFC

856
00:34:35,310 --> 00:34:39,418
to support interactions typically

857
00:34:37,050 --> 00:34:42,690
digital ones means the toy may contain

858
00:34:39,418 --> 00:34:46,739
effect or involve digital content which

859
00:34:42,690 --> 00:34:48,270
may be covered by copyright in 1998 the

860
00:34:46,739 --> 00:34:50,279
United States passed the Digital

861
00:34:48,270 --> 00:34:52,320
Millennium Copyright Act or the DMCA

862
00:34:50,280 --> 00:34:54,720
most of you probably know it for section

863
00:34:52,320 --> 00:34:57,090
five one two which establishes the safe

864
00:34:54,719 --> 00:34:57,330
harbor provisions for online hosts this

865
00:34:57,090 --> 00:34:59,370
is

866
00:34:57,330 --> 00:35:01,710
when a copyright owner notifies her

867
00:34:59,370 --> 00:35:03,750
upstream provider like your ISP or web

868
00:35:01,710 --> 00:35:05,520
host that you've put their copyrighted

869
00:35:03,750 --> 00:35:07,500
content online and they need to take it

870
00:35:05,520 --> 00:35:09,480
down that's not the part we're concerned

871
00:35:07,500 --> 00:35:11,610
with there's a different part of the

872
00:35:09,480 --> 00:35:14,250
DMCA section 1201 known as the

873
00:35:11,610 --> 00:35:16,200
anti-circumvention provisions 1201

874
00:35:14,250 --> 00:35:18,000
establishes that circumventing or

875
00:35:16,200 --> 00:35:20,850
working around any type of copy

876
00:35:18,000 --> 00:35:23,430
protection mechanism is a crime as is

877
00:35:20,850 --> 00:35:26,009
distributing tools to support others

878
00:35:23,430 --> 00:35:28,169
circumvention x' you can be sued by the

879
00:35:26,010 --> 00:35:30,390
copyright owner whose digital walks you

880
00:35:28,170 --> 00:35:32,010
picked a civil action and also be

881
00:35:30,390 --> 00:35:34,140
charged by the federal government a

882
00:35:32,010 --> 00:35:38,670
criminal action it's a criminal action

883
00:35:34,140 --> 00:35:41,129
this is the damage now it doesn't matter

884
00:35:38,670 --> 00:35:42,990
whether you can or do use an NFC toy

885
00:35:41,130 --> 00:35:45,060
with the video game it was intended for

886
00:35:42,990 --> 00:35:47,339
that it may be intended to protect

887
00:35:45,060 --> 00:35:50,640
copyrighted content is what makes any

888
00:35:47,340 --> 00:35:53,040
possible circumvention illegal so maybe

889
00:35:50,640 --> 00:35:55,230
let's take this seriously and see how

890
00:35:53,040 --> 00:35:57,840
the DMCA concerns us based on excerpts

891
00:35:55,230 --> 00:36:00,210
from the 2013 Department of Justice

892
00:35:57,840 --> 00:36:03,780
prosecuting intellectual property crimes

893
00:36:00,210 --> 00:36:05,850
manual fourth edition to prove a

894
00:36:03,780 --> 00:36:07,550
violation the United the government must

895
00:36:05,850 --> 00:36:10,110
establish the defendant willfully

896
00:36:07,550 --> 00:36:12,390
circumvented a technological measure

897
00:36:10,110 --> 00:36:14,460
that effectively controls access to a

898
00:36:12,390 --> 00:36:16,350
copyrighted work for commercial

899
00:36:14,460 --> 00:36:19,680
advantage or private financial gain

900
00:36:16,350 --> 00:36:21,990
let's take those one at a time willfully

901
00:36:19,680 --> 00:36:24,180
willfully has a specific legal meaning

902
00:36:21,990 --> 00:36:25,709
but let's just go with the idea that

903
00:36:24,180 --> 00:36:27,419
since you're all in this room you can't

904
00:36:25,710 --> 00:36:30,900
argue that you didn't know it might not

905
00:36:27,420 --> 00:36:32,520
be okay for you to do this someone who

906
00:36:30,900 --> 00:36:35,360
just comes across those cleanroom

907
00:36:32,520 --> 00:36:38,280
algorithms might have a stronger case

908
00:36:35,360 --> 00:36:40,500
circumvented even if buying the toy

909
00:36:38,280 --> 00:36:42,060
legally doesn't grant us the right to

910
00:36:40,500 --> 00:36:44,520
crack its keys and put our own data on

911
00:36:42,060 --> 00:36:47,340
it once we have the keys

912
00:36:44,520 --> 00:36:49,800
we're not bypassing anything we're using

913
00:36:47,340 --> 00:36:51,540
the keys as intended now we might be

914
00:36:49,800 --> 00:36:55,190
eligible for other charges under other

915
00:36:51,540 --> 00:36:57,270
laws but that's not a DMCA violation a

916
00:36:55,190 --> 00:36:59,700
technological measure that effectively

917
00:36:57,270 --> 00:37:02,490
controls access now obviously an NFC's

918
00:36:59,700 --> 00:37:04,710
tags keys or passwords our technological

919
00:37:02,490 --> 00:37:06,750
measures but effectively is a great

920
00:37:04,710 --> 00:37:08,430
example of legally is not being plain

921
00:37:06,750 --> 00:37:10,860
English despite sounding like it

922
00:37:08,430 --> 00:37:11,169
effectively doesn't mean what it does to

923
00:37:10,860 --> 00:37:12,190
us

924
00:37:11,170 --> 00:37:14,170
in this room where you're probably

925
00:37:12,190 --> 00:37:16,980
interpreting it as something like does a

926
00:37:14,170 --> 00:37:20,970
good job at in court effectively

927
00:37:16,980 --> 00:37:23,470
basically means does it exist to do this

928
00:37:20,970 --> 00:37:25,328
to a copyrighted work if we're just

929
00:37:23,470 --> 00:37:27,640
talking about the toy right now and the

930
00:37:25,329 --> 00:37:29,770
existing data on the toy then if that

931
00:37:27,640 --> 00:37:31,598
data is just facts and figures

932
00:37:29,770 --> 00:37:34,390
it wouldn't be copyrighted and therefore

933
00:37:31,599 --> 00:37:37,359
breaking into the NFC toy wouldn't be an

934
00:37:34,390 --> 00:37:39,430
infringement finally for commercial

935
00:37:37,359 --> 00:37:41,230
advantage or private financial gain if

936
00:37:39,430 --> 00:37:43,270
you are just using these toys yourself

937
00:37:41,230 --> 00:37:44,619
for yourself and there's no commercial

938
00:37:43,270 --> 00:37:46,390
advantage then there's no commercial

939
00:37:44,619 --> 00:37:48,910
advantage or private financial gain

940
00:37:46,390 --> 00:37:51,098
if you're selling keys maybe that's an

941
00:37:48,910 --> 00:37:53,558
issue but I'm not being paid to give

942
00:37:51,099 --> 00:37:55,510
this talk and the content on NFC toys is

943
00:37:53,559 --> 00:37:58,000
deeded to the public domain so I hope

944
00:37:55,510 --> 00:38:01,089
that's evidence of my lack of profit

945
00:37:58,000 --> 00:38:03,400
motive so here's where we stand if we're

946
00:38:01,089 --> 00:38:05,710
only talking about the toy right now and

947
00:38:03,400 --> 00:38:08,440
only about the existing data on the toy

948
00:38:05,710 --> 00:38:10,900
because we need to tick all of the boxes

949
00:38:08,440 --> 00:38:13,660
if the data on the toy is not a

950
00:38:10,900 --> 00:38:15,940
copyrighted work then maybe we're not

951
00:38:13,660 --> 00:38:18,430
violating the DMCA either civilly or

952
00:38:15,940 --> 00:38:20,260
criminally now it doesn't mean we can't

953
00:38:18,430 --> 00:38:21,578
be sued for this anyway it just means

954
00:38:20,260 --> 00:38:23,530
that if we can afford to defend

955
00:38:21,579 --> 00:38:27,069
ourselves we might have a defensible

956
00:38:23,530 --> 00:38:29,230
case but if part of our legal standing

957
00:38:27,069 --> 00:38:30,849
depends on the toy not being caught the

958
00:38:29,230 --> 00:38:32,950
data on the toy not being copyrighted

959
00:38:30,849 --> 00:38:34,150
well how can we figure that out let's

960
00:38:32,950 --> 00:38:36,730
start by looking at what copyright

961
00:38:34,150 --> 00:38:38,260
protects now if the data on the toy

962
00:38:36,730 --> 00:38:40,299
includes things like the actual

963
00:38:38,260 --> 00:38:42,190
character art and sound effects which

964
00:38:40,299 --> 00:38:44,770
get used in the game those would be

965
00:38:42,190 --> 00:38:47,530
original creative expressions if the

966
00:38:44,770 --> 00:38:49,329
data is just this is an engine etoy with

967
00:38:47,530 --> 00:38:51,900
this health and this experience level

968
00:38:49,329 --> 00:38:54,549
those are discrete facts and figures

969
00:38:51,900 --> 00:38:57,059
they're not creative expressions facts

970
00:38:54,549 --> 00:38:59,619
and figures alone are not copyrightable

971
00:38:57,059 --> 00:39:01,630
so how can we tell if the data is

972
00:38:59,619 --> 00:39:03,910
uncopyrightable facts and figures or

973
00:39:01,630 --> 00:39:05,950
copyrightable content well there's a few

974
00:39:03,910 --> 00:39:08,109
ways some researchers might reverse

975
00:39:05,950 --> 00:39:09,879
engineer the video game or its support

976
00:39:08,109 --> 00:39:12,250
code to understand what data gets read

977
00:39:09,880 --> 00:39:13,990
or written others might reverse engineer

978
00:39:12,250 --> 00:39:15,460
the encryption on the data reading it

979
00:39:13,990 --> 00:39:17,290
from the tag frequently to see what

980
00:39:15,460 --> 00:39:19,869
changes get made but this is a talk

981
00:39:17,290 --> 00:39:22,900
focusing on just the NFC tag and the NFC

982
00:39:19,869 --> 00:39:24,790
toy and it turns out that there's a lot

983
00:39:22,900 --> 00:39:26,170
we can learn just a

984
00:39:24,790 --> 00:39:28,390
without doing any additional work at all

985
00:39:26,170 --> 00:39:30,100
just by very carefully playing the game

986
00:39:28,390 --> 00:39:32,830
and paying close attention to the tag

987
00:39:30,100 --> 00:39:35,049
now I go into more detail on this on NFC

988
00:39:32,830 --> 00:39:37,210
toys but the short version is we can

989
00:39:35,050 --> 00:39:39,340
absolutely collect evidence that there

990
00:39:37,210 --> 00:39:41,770
isn't anything original or copyrightable

991
00:39:39,340 --> 00:39:43,990
on a figure being careful about changing

992
00:39:41,770 --> 00:39:46,360
things in a game means we can figure out

993
00:39:43,990 --> 00:39:49,060
which blocks are likely to store many of

994
00:39:46,360 --> 00:39:51,130
our characters variables these are

995
00:39:49,060 --> 00:39:53,770
blocks that Skylanders Giants rise to

996
00:39:51,130 --> 00:39:55,660
that an ingénue toy during gameplay by

997
00:39:53,770 --> 00:39:57,670
watching the clock we can see that these

998
00:39:55,660 --> 00:40:00,100
two blocks probably store some kind of

999
00:39:57,670 --> 00:40:01,270
playtime counter by testing different

1000
00:40:00,100 --> 00:40:02,950
nicknames we can see that these two

1001
00:40:01,270 --> 00:40:05,290
blocks store the nickname and that they

1002
00:40:02,950 --> 00:40:07,089
change depending on its length by

1003
00:40:05,290 --> 00:40:08,650
gaining golden experience we can see

1004
00:40:07,090 --> 00:40:10,480
that the same blocks that store the

1005
00:40:08,650 --> 00:40:12,730
playtime counter probably also store

1006
00:40:10,480 --> 00:40:15,880
gold and that these new blocks seem to

1007
00:40:12,730 --> 00:40:18,490
store experience the NFC tags in these

1008
00:40:15,880 --> 00:40:20,560
NFC toys are merely storage devices for

1009
00:40:18,490 --> 00:40:22,990
numeric text and data that track your

1010
00:40:20,560 --> 00:40:25,509
characters progress and can't be covered

1011
00:40:22,990 --> 00:40:27,040
by copyrights now there's one other

1012
00:40:25,510 --> 00:40:29,740
concern which we touched on briefly

1013
00:40:27,040 --> 00:40:31,450
before even if we're not circumventing

1014
00:40:29,740 --> 00:40:34,089
the an access control to read and write

1015
00:40:31,450 --> 00:40:35,770
toy data the toys are still used to

1016
00:40:34,090 --> 00:40:37,930
access content within a game and the

1017
00:40:35,770 --> 00:40:40,150
game content is almost certainly under

1018
00:40:37,930 --> 00:40:42,310
copyright here's that list again if

1019
00:40:40,150 --> 00:40:44,830
we're changing number four to mean the

1020
00:40:42,310 --> 00:40:46,960
game content instead of the data on the

1021
00:40:44,830 --> 00:40:50,830
toy how does that change number three

1022
00:40:46,960 --> 00:40:53,200
are the NFC tags and tag keys and

1023
00:40:50,830 --> 00:40:55,630
passwords effective access controls that

1024
00:40:53,200 --> 00:40:57,580
protect the game content and I think the

1025
00:40:55,630 --> 00:40:59,710
additional argument here hinges on that

1026
00:40:57,580 --> 00:41:03,040
particular legal definition of the term

1027
00:40:59,710 --> 00:41:06,370
effectively that is the point of the NFC

1028
00:41:03,040 --> 00:41:08,200
tags and keys isn't to protect the game

1029
00:41:06,370 --> 00:41:11,319
content they're there to only protect

1030
00:41:08,200 --> 00:41:13,720
the data on the tag every NFC toy that

1031
00:41:11,320 --> 00:41:15,730
protects that controls access to content

1032
00:41:13,720 --> 00:41:18,580
in a video game requires at least its

1033
00:41:15,730 --> 00:41:20,380
initial presence on an NFC reader to

1034
00:41:18,580 --> 00:41:22,900
access that content suggesting the

1035
00:41:20,380 --> 00:41:26,920
access control for the game content is

1036
00:41:22,900 --> 00:41:29,860
the NFC toy plus the reader plus the

1037
00:41:26,920 --> 00:41:31,690
code in the game all together every NFC

1038
00:41:29,860 --> 00:41:34,210
toy we've looked at uses keys and

1039
00:41:31,690 --> 00:41:36,580
passwords in different ways but they are

1040
00:41:34,210 --> 00:41:38,080
all able to perform that same function

1041
00:41:36,580 --> 00:41:40,660
in that same combination

1042
00:41:38,080 --> 00:41:42,700
despite those differences the Volk

1043
00:41:40,660 --> 00:41:45,120
thesis even asserts that using a static

1044
00:41:42,700 --> 00:41:47,250
key for sector 0 shows a

1045
00:41:45,120 --> 00:41:49,779
misunderstanding of the NFC technology

1046
00:41:47,250 --> 00:41:51,220
amiibos don't have read protection

1047
00:41:49,780 --> 00:41:53,500
another toy we didn't even get to

1048
00:41:51,220 --> 00:41:55,509
discuss the pokemon rumble you figures

1049
00:41:53,500 --> 00:41:57,070
don't have write protection you can do

1050
00:41:55,510 --> 00:42:01,570
whatever you want with them right out of

1051
00:41:57,070 --> 00:42:04,210
the pokeball this suggests that the NFC

1052
00:42:01,570 --> 00:42:06,100
tag keys and passwords aren't effective

1053
00:42:04,210 --> 00:42:09,010
access controls for the game contents

1054
00:42:06,100 --> 00:42:10,900
they don't exist to have any effect on

1055
00:42:09,010 --> 00:42:13,780
access to the game content if they can

1056
00:42:10,900 --> 00:42:15,340
be misunderstood or not used at all they

1057
00:42:13,780 --> 00:42:17,650
are simply there by virtue of an

1058
00:42:15,340 --> 00:42:19,600
arbitrary technical decision to make it

1059
00:42:17,650 --> 00:42:22,150
easier or harder to work with the toys

1060
00:42:19,600 --> 00:42:26,470
as data storage devices so maybe number

1061
00:42:22,150 --> 00:42:28,330
three is also a maybe not so we've

1062
00:42:26,470 --> 00:42:31,180
talked about NFC toys which are toys

1063
00:42:28,330 --> 00:42:32,830
which have NFC tags embedded on them we

1064
00:42:31,180 --> 00:42:34,720
talked a little bit about them and about

1065
00:42:32,830 --> 00:42:37,810
the toys to life genre of video games

1066
00:42:34,720 --> 00:42:40,060
and about NFC tags in general we talked

1067
00:42:37,810 --> 00:42:41,980
about various off-the-shelf hardware and

1068
00:42:40,060 --> 00:42:44,590
software you can use to explore these

1069
00:42:41,980 --> 00:42:45,940
NFC toys and how that exploration can

1070
00:42:44,590 --> 00:42:47,740
lead to determining read and write

1071
00:42:45,940 --> 00:42:51,480
credentials and how to write your own

1072
00:42:47,740 --> 00:42:53,620
data to three different types of NFC toy

1073
00:42:51,480 --> 00:42:55,150
finally we talked about the legal

1074
00:42:53,620 --> 00:42:57,430
implications of doing so and I have

1075
00:42:55,150 --> 00:42:59,290
hopefully established that using NFC

1076
00:42:57,430 --> 00:43:01,600
toys for your own data storage is

1077
00:42:59,290 --> 00:43:04,090
probably not circumventing an effective

1078
00:43:01,600 --> 00:43:06,480
access control probably not a copyright

1079
00:43:04,090 --> 00:43:09,670
infringement and that this work is

1080
00:43:06,480 --> 00:43:13,960
legally enabling new interoperability of

1081
00:43:09,670 --> 00:43:15,760
NFC toys with your own hardware while I

1082
00:43:13,960 --> 00:43:19,200
discussed legal matters I am NOT a

1083
00:43:15,760 --> 00:43:21,910
lawyer and this was not legal advice so

1084
00:43:19,200 --> 00:43:23,919
who believes round of applause that

1085
00:43:21,910 --> 00:43:25,779
obtaining credentials for an NFC toy is

1086
00:43:23,920 --> 00:43:28,140
legal and wants to assert their rights

1087
00:43:25,780 --> 00:43:28,140
to do so

1088
00:43:30,430 --> 00:43:38,960
so these are amiibo cards each card has

1089
00:43:36,410 --> 00:43:41,899
a meebo NFC tag inside just like the

1090
00:43:38,960 --> 00:43:44,060
full-size toys do I will be handing them

1091
00:43:41,900 --> 00:43:45,830
out out front after this talk clips to

1092
00:43:44,060 --> 00:43:48,350
each amiibo card will be a worksheet

1093
00:43:45,830 --> 00:43:50,779
which explains how to compute the PWD

1094
00:43:48,350 --> 00:43:52,549
for the amiibo card longhand I hope

1095
00:43:50,780 --> 00:43:54,470
you'll enjoy working through it I also

1096
00:43:52,550 --> 00:43:55,940
have Skylanders and other NFC toys

1097
00:43:54,470 --> 00:43:58,640
available for you and I hope you'll

1098
00:43:55,940 --> 00:44:00,500
please take one that's it for my talk

1099
00:43:58,640 --> 00:44:02,540
again we won't have time to do Q&A but I

1100
00:44:00,500 --> 00:44:04,280
will reply to you NFC Dot toys - any

1101
00:44:02,540 --> 00:44:05,930
question submitted please fill out your

1102
00:44:04,280 --> 00:44:07,250
feedback forms and either pass them up

1103
00:44:05,930 --> 00:44:09,210
or leave them on the tables out front

1104
00:44:07,250 --> 00:44:16,409
thanks so much

1105
00:44:09,210 --> 00:44:16,409
[Applause]

