1
00:00:06,050 --> 00:00:12,320
<font color="#CCCCCC">oh hi everyone</font><font color="#E5E5E5"> my name is Ben</font><font color="#CCCCCC"> actus this</font>

2
00:00:10,340 --> 00:00:14,300
is<font color="#E5E5E5"> breaking mobile app protection</font>

3
00:00:12,320 --> 00:00:19,189
mechanisms you<font color="#E5E5E5"> can follow me on twitter</font>

4
00:00:14,300 --> 00:00:21,770
at been robbed<font color="#CCCCCC"> so</font><font color="#E5E5E5"> few things of my</font>

5
00:00:19,189 --> 00:00:24,890
<font color="#CCCCCC">background I started research lab</font><font color="#E5E5E5"> I was</font>

6
00:00:21,770 --> 00:00:27,200
doing mobile<font color="#E5E5E5"> security work for five or</font>

7
00:00:24,890 --> 00:00:29,480
six<font color="#CCCCCC"> years I also did a lot of network</font>

8
00:00:27,200 --> 00:00:32,299
<font color="#CCCCCC">sensor work as well some promoted</font>

9
00:00:29,480 --> 00:00:34,160
looking at packet capture then I<font color="#E5E5E5"> went to</font>

10
00:00:32,299 --> 00:00:35,809
look out where I got<font color="#CCCCCC"> to</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> with Tim</font>

11
00:00:34,160 --> 00:00:37,730
Jazeera<font color="#E5E5E5"> which is awesome I think</font><font color="#CCCCCC"> he's</font>

12
00:00:35,810 --> 00:00:40,609
speaking<font color="#E5E5E5"> later today</font><font color="#CCCCCC"> and Emily</font><font color="#E5E5E5"> who</font><font color="#CCCCCC"> is</font>

13
00:00:37,730 --> 00:00:43,699
also<font color="#E5E5E5"> speaking</font><font color="#CCCCCC"> I got to reverse</font><font color="#E5E5E5"> thousands</font>

14
00:00:40,609 --> 00:00:46,519
of Android and iOS malware samples<font color="#CCCCCC"> then</font>

15
00:00:43,699 --> 00:00:48,349
I went to<font color="#E5E5E5"> Cenac where I helped build</font>

16
00:00:46,519 --> 00:00:50,559
their mobile attack control chain so how

17
00:00:48,350 --> 00:00:52,519
do you at scale<font color="#E5E5E5"> look for vulnerabilities</font>

18
00:00:50,559 --> 00:00:55,160
<font color="#E5E5E5">statically in mobile apps and</font>

19
00:00:52,519 --> 00:00:57,079
<font color="#E5E5E5">dynamically by hooking api's and then</font>

20
00:00:55,160 --> 00:01:00,019
most recently it started<font color="#CCCCCC"> at Facebook on</font>

21
00:00:57,079 --> 00:01:02,839
the red team<font color="#E5E5E5"> at night a little</font><font color="#CCCCCC"> bit of</font>

22
00:01:00,019 --> 00:01:04,339
troll on Twitter<font color="#CCCCCC"> and I start a side</font>

23
00:01:02,839 --> 00:01:07,340
business called cyber merchants of death

24
00:01:04,339 --> 00:01:11,179
so<font color="#E5E5E5"> I can do various bug bounties as well</font>

25
00:01:07,340 --> 00:01:12,860
<font color="#CCCCCC">I do want to thank Tim John Sawyer and</font>

26
00:01:11,180 --> 00:01:16,130
Caleb they<font color="#CCCCCC"> taught me a lot</font><font color="#E5E5E5"> of the</font>

27
00:01:12,860 --> 00:01:18,140
Android skill sets and you don't like

28
00:01:16,130 --> 00:01:22,250
anything<font color="#E5E5E5"> I</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> about please blame that</font>

29
00:01:18,140 --> 00:01:24,410
<font color="#CCCCCC">so</font><font color="#E5E5E5"> because they're my tutors so my</font>

30
00:01:22,250 --> 00:01:26,090
objectives at<font color="#CCCCCC"> the end of this talk is</font><font color="#E5E5E5"> I</font>

31
00:01:24,410 --> 00:01:28,160
want<font color="#E5E5E5"> to make you all be able</font><font color="#CCCCCC"> to</font>

32
00:01:26,090 --> 00:01:30,410
<font color="#E5E5E5">essentially laugh at all the emulator</font>

33
00:01:28,160 --> 00:01:32,539
<font color="#CCCCCC">and route detection techniques that icon</font>

34
00:01:30,410 --> 00:01:34,520
<font color="#CCCCCC">when we</font><font color="#E5E5E5"> see mobile apps</font><font color="#CCCCCC"> I want you to be</font>

35
00:01:32,540 --> 00:01:35,960
<font color="#CCCCCC">able to laugh at any kind of HTTP</font>

36
00:01:34,520 --> 00:01:38,060
implementation because you'll know how

37
00:01:35,960 --> 00:01:39,470
<font color="#E5E5E5">to get around it and also if the dead</font>

38
00:01:38,060 --> 00:01:40,940
<font color="#CCCCCC">arguing's are</font><font color="#E5E5E5"> pinning</font><font color="#CCCCCC"> your key</font>

39
00:01:39,470 --> 00:01:44,570
validation<font color="#CCCCCC"> I'll show you how to</font><font color="#E5E5E5"> get</font>

40
00:01:40,940 --> 00:01:47,480
<font color="#E5E5E5">around</font><font color="#CCCCCC"> that too so determine the outline</font>

41
00:01:44,570 --> 00:01:49,820
<font color="#E5E5E5">talk about spend a good chunk on the</font>

42
00:01:47,480 --> 00:01:51,200
<font color="#CCCCCC">root emulator detection on Android then</font>

43
00:01:49,820 --> 00:01:53,509
we'll dive into<font color="#E5E5E5"> some of the iOS</font>

44
00:01:51,200 --> 00:01:55,730
techniques<font color="#CCCCCC"> we'll go to</font><font color="#E5E5E5"> start fitting</font><font color="#CCCCCC"> in</font>

45
00:01:53,510 --> 00:01:57,740
key validation<font color="#CCCCCC"> it's a little Android</font>

46
00:01:55,730 --> 00:01:59,930
heavily focused<font color="#E5E5E5"> but the same techniques</font>

47
00:01:57,740 --> 00:02:01,820
<font color="#CCCCCC">apply to iOS you'll see in the previous</font>

48
00:01:59,930 --> 00:02:03,980
<font color="#E5E5E5">section then we go through</font><font color="#CCCCCC"> some</font>

49
00:02:01,820 --> 00:02:05,690
debugging<font color="#E5E5E5"> Android apps</font><font color="#CCCCCC"> and spend a</font>

50
00:02:03,980 --> 00:02:07,400
little<font color="#E5E5E5"> bit of time on some basic</font>

51
00:02:05,690 --> 00:02:11,300
patching examples to kind<font color="#CCCCCC"> of reinforce</font>

52
00:02:07,400 --> 00:02:15,040
<font color="#E5E5E5">some of these skill sets so root an</font>

53
00:02:11,300 --> 00:02:18,420
emulator detection why do we<font color="#E5E5E5"> want root</font>

54
00:02:15,040 --> 00:02:20,790
when<font color="#E5E5E5"> your root you can debug everything</font>

55
00:02:18,420 --> 00:02:24,089
that means we can<font color="#CCCCCC"> change code paths</font><font color="#E5E5E5"> we</font>

56
00:02:20,790 --> 00:02:27,179
can<font color="#E5E5E5"> change values which is great we can</font>

57
00:02:24,090 --> 00:02:30,060
inspect obfuscated code or<font color="#CCCCCC"> cold call by</font>

58
00:02:27,180 --> 00:02:32,069
reflection<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> console grab</font>

59
00:02:30,060 --> 00:02:36,360
sensitive return values which is really

60
00:02:32,069 --> 00:02:38,670
good too you can also see all<font color="#CCCCCC"> the</font>

61
00:02:36,360 --> 00:02:41,250
internal files and<font color="#CCCCCC"> flash data</font><font color="#E5E5E5"> data calm</font>

62
00:02:38,670 --> 00:02:43,140
app named<font color="#CCCCCC"> earth</font><font color="#E5E5E5"> right so usually these</font>

63
00:02:41,250 --> 00:02:44,760
you know out<font color="#E5E5E5"> of scope for bug bounties</font>

64
00:02:43,140 --> 00:02:46,230
but they continue really juicy

65
00:02:44,760 --> 00:02:47,640
information right they might<font color="#E5E5E5"> contain</font>

66
00:02:46,230 --> 00:02:50,190
tokens<font color="#CCCCCC"> cookies</font>

67
00:02:47,640 --> 00:02:52,290
secrets or other values that<font color="#CCCCCC"> can allow</font>

68
00:02:50,190 --> 00:02:53,819
you<font color="#E5E5E5"> to change</font><font color="#CCCCCC"> application flow</font><font color="#E5E5E5"> so one of</font>

69
00:02:52,290 --> 00:02:55,950
<font color="#E5E5E5">things I like</font><font color="#CCCCCC"> to do is go in there</font><font color="#E5E5E5"> grab</font>

70
00:02:53,819 --> 00:02:58,140
a<font color="#E5E5E5"> bunch of data see how they're</font><font color="#CCCCCC"> doing</font>

71
00:02:55,950 --> 00:03:01,980
the web dedication<font color="#E5E5E5"> and I can pound away</font>

72
00:02:58,140 --> 00:03:03,809
<font color="#E5E5E5">at a Web</font><font color="#CCCCCC"> API</font><font color="#E5E5E5"> right you can also modify</font>

73
00:03:01,980 --> 00:03:07,040
everything<font color="#E5E5E5"> is route so any kind</font><font color="#CCCCCC"> of</font>

74
00:03:03,810 --> 00:03:09,480
system file<font color="#CCCCCC"> or setting you can change</font>

75
00:03:07,040 --> 00:03:11,700
get rid of couple ways<font color="#CCCCCC"> we're using a</font>

76
00:03:09,480 --> 00:03:14,459
real device physical<font color="#E5E5E5"> phone you can build</font>

77
00:03:11,700 --> 00:03:16,319
<font color="#E5E5E5">AOSP from source and select</font><font color="#CCCCCC"> an</font>

78
00:03:14,459 --> 00:03:18,630
engineering or debug<font color="#CCCCCC"> built if you really</font>

79
00:03:16,319 --> 00:03:20,548
enjoy that<font color="#E5E5E5"> you can also unlock the boot</font>

80
00:03:18,630 --> 00:03:23,430
layer loader and load<font color="#CCCCCC"> a</font><font color="#E5E5E5"> custom</font><font color="#CCCCCC"> wrong</font>

81
00:03:20,549 --> 00:03:25,320
it has<font color="#E5E5E5"> everything all set up the way</font><font color="#CCCCCC"> you</font>

82
00:03:23,430 --> 00:03:27,870
want you<font color="#E5E5E5"> can route the device</font><font color="#CCCCCC"> fine</font>

83
00:03:25,320 --> 00:03:29,820
exploit and I also want to say the

84
00:03:27,870 --> 00:03:32,579
<font color="#CCCCCC">physical phone is much faster than</font>

85
00:03:29,820 --> 00:03:34,440
emulator<font color="#E5E5E5"> when you're using an emulated</font>

86
00:03:32,579 --> 00:03:36,720
device<font color="#E5E5E5"> you don't need to purchase the</font>

87
00:03:34,440 --> 00:03:39,180
phone<font color="#E5E5E5"> for those of you like me I will</font>

88
00:03:36,720 --> 00:03:41,760
the Apple<font color="#E5E5E5"> laptops not the</font><font color="#CCCCCC"> Carrol USBC</font>

89
00:03:39,180 --> 00:03:43,799
<font color="#CCCCCC">dongles it's</font><font color="#E5E5E5"> already rooted</font><font color="#CCCCCC"> in</font>

90
00:03:41,760 --> 00:03:46,108
debuggable<font color="#CCCCCC"> and you can actually</font><font color="#E5E5E5"> speed it</font>

91
00:03:43,799 --> 00:03:48,540
up on OS 10<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Linux by installing</font><font color="#E5E5E5"> this</font>

92
00:03:46,109 --> 00:03:50,790
Intel<font color="#E5E5E5"> MX driver it helps them</font><font color="#CCCCCC"> in</font>

93
00:03:48,540 --> 00:03:52,230
<font color="#E5E5E5">acceleration it's also good if you break</font>

94
00:03:50,790 --> 00:03:56,220
your test phone right before public

95
00:03:52,230 --> 00:03:57,119
talks so why<font color="#CCCCCC"> do</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> give in</font><font color="#E5E5E5"> or why do we</font>

96
00:03:56,220 --> 00:03:59,190
want to<font color="#E5E5E5"> break these mobile app</font>

97
00:03:57,120 --> 00:04:01,620
protections<font color="#E5E5E5"> right the protection</font>

98
00:03:59,190 --> 00:04:03,780
mechanisms are often an obstacle<font color="#CCCCCC"> to kind</font>

99
00:04:01,620 --> 00:04:05,130
<font color="#E5E5E5">of novice bug bounty hunters especially</font>

100
00:04:03,780 --> 00:04:09,359
if they're<font color="#CCCCCC"> non familiar with the mobile</font>

101
00:04:05,130 --> 00:04:11,760
domain<font color="#CCCCCC"> even</font><font color="#E5E5E5"> though these obstacles exist</font>

102
00:04:09,359 --> 00:04:13,920
<font color="#CCCCCC">if you can get</font><font color="#E5E5E5"> around them there's</font>

103
00:04:11,760 --> 00:04:17,728
usually a bunch<font color="#E5E5E5"> additional bugs still in</font>

104
00:04:13,920 --> 00:04:19,909
those mobile apps<font color="#E5E5E5"> right so when you're</font>

105
00:04:17,728 --> 00:04:22,440
<font color="#E5E5E5">detecting these you have a few different</font>

106
00:04:19,910 --> 00:04:25,680
<font color="#E5E5E5">cases right so you typically it's really</font>

107
00:04:22,440 --> 00:04:27,510
easy static string checks more

108
00:04:25,680 --> 00:04:29,130
<font color="#E5E5E5">sophisticated developers could actually</font>

109
00:04:27,510 --> 00:04:31,230
<font color="#E5E5E5">pull sensor data which will get</font>

110
00:04:29,130 --> 00:04:32,960
and then there's actually<font color="#E5E5E5"> some academia</font>

111
00:04:31,230 --> 00:04:35,670
things out there how do<font color="#E5E5E5"> you detect</font>

112
00:04:32,960 --> 00:04:38,190
virtualization on x86 with<font color="#CCCCCC"> cumene</font>

113
00:04:35,670 --> 00:04:40,980
artifacts<font color="#E5E5E5"> but typically it's one of</font><font color="#CCCCCC"> two</font>

114
00:04:38,190 --> 00:04:42,780
<font color="#CCCCCC">things</font><font color="#E5E5E5"> really crappy string checks or</font>

115
00:04:40,980 --> 00:04:44,400
the devs did their homework<font color="#E5E5E5"> actually</font>

116
00:04:42,780 --> 00:04:46,169
read the<font color="#E5E5E5"> Google API is and they're using</font>

117
00:04:44,400 --> 00:04:49,770
something called<font color="#E5E5E5"> safety net which will</font>

118
00:04:46,170 --> 00:04:52,920
dive into so how do we search these

119
00:04:49,770 --> 00:04:55,560
mobile apps right<font color="#CCCCCC"> if you're unfamiliar</font>

120
00:04:52,920 --> 00:04:58,290
to this domain<font color="#E5E5E5"> there's typically</font><font color="#CCCCCC"> four</font>

121
00:04:55,560 --> 00:05:00,150
tools right<font color="#CCCCCC"> you're most</font><font color="#E5E5E5"> novice finally</font>

122
00:04:58,290 --> 00:05:02,640
tool is something<font color="#CCCCCC"> called Dex</font><font color="#E5E5E5"> to jar you</font>

123
00:05:00,150 --> 00:05:05,400
take your apk your Android app all it is

124
00:05:02,640 --> 00:05:05,789
is a zip unzip it then you use<font color="#E5E5E5"> them</font>

125
00:05:05,400 --> 00:05:08,609
called

126
00:05:05,790 --> 00:05:11,520
<font color="#CCCCCC">d2j</font><font color="#E5E5E5"> or Dexter jar right and that's going</font>

127
00:05:08,610 --> 00:05:13,140
to produce a jar file from your<font color="#CCCCCC"> awesome</font>

128
00:05:11,520 --> 00:05:15,120
top decks and you can open<font color="#CCCCCC"> that</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> JT</font>

129
00:05:13,140 --> 00:05:17,580
<font color="#E5E5E5">GUI</font><font color="#CCCCCC"> I'll give you a Java like</font><font color="#E5E5E5"> view</font>

130
00:05:15,120 --> 00:05:19,440
you're<font color="#CCCCCC"> a little more</font><font color="#E5E5E5"> sophisticated you</font>

131
00:05:17,580 --> 00:05:20,700
want to do kind<font color="#E5E5E5"> of dynamic debugging and</font>

132
00:05:19,440 --> 00:05:23,190
patching your<font color="#CCCCCC"> new something</font><font color="#E5E5E5"> called</font>

133
00:05:20,700 --> 00:05:27,090
apktool<font color="#CCCCCC"> connect it's you in a sembly</font>

134
00:05:23,190 --> 00:05:28,920
like view out you also<font color="#E5E5E5"> tools</font><font color="#CCCCCC"> a gem which</font>

135
00:05:27,090 --> 00:05:30,630
can switch between<font color="#E5E5E5"> your</font><font color="#CCCCCC"> two commodity</font>

136
00:05:28,920 --> 00:05:33,570
compilation and your disassembly on the

137
00:05:30,630 --> 00:05:35,909
fly and<font color="#E5E5E5"> tools like Ida Pro which allow</font>

138
00:05:33,570 --> 00:05:39,240
you to debugging and much more

139
00:05:35,910 --> 00:05:40,590
sophisticated<font color="#CCCCCC"> parson as well but for</font><font color="#E5E5E5"> a</font>

140
00:05:39,240 --> 00:05:43,170
lot<font color="#CCCCCC"> of this we</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use free tools</font><font color="#E5E5E5"> like</font>

141
00:05:40,590 --> 00:05:45,390
<font color="#E5E5E5">graph so in this example</font>

142
00:05:43,170 --> 00:05:48,810
JK's wrote this about<font color="#E5E5E5"> on his blog is</font><font color="#CCCCCC"> a</font>

143
00:05:45,390 --> 00:05:50,969
huge<font color="#E5E5E5"> blog post on this one</font><font color="#CCCCCC"> and in this</font>

144
00:05:48,810 --> 00:05:52,560
case<font color="#CCCCCC"> I'm using grep BR command for</font>

145
00:05:50,970 --> 00:05:55,380
recursive<font color="#E5E5E5"> and I'm going to search for a</font>

146
00:05:52,560 --> 00:05:57,300
string I know<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> of interest to</font><font color="#E5E5E5"> me</font>

147
00:05:55,380 --> 00:05:59,850
this case<font color="#E5E5E5"> is going to</font><font color="#CCCCCC"> be master password</font>

148
00:05:57,300 --> 00:06:03,090
and you<font color="#E5E5E5"> can see on</font><font color="#CCCCCC"> your far left column</font>

149
00:05:59,850 --> 00:06:05,460
<font color="#CCCCCC">here I can see every single time that</font><font color="#E5E5E5"> is</font>

150
00:06:03,090 --> 00:06:06,599
used in what class so one of the tricks

151
00:06:05,460 --> 00:06:08,250
<font color="#CCCCCC">are going to go</font><font color="#E5E5E5"> through here</font><font color="#CCCCCC"> in this</font>

152
00:06:06,600 --> 00:06:09,990
<font color="#E5E5E5">little talk is hey what</font><font color="#CCCCCC"> strings should</font>

153
00:06:08,250 --> 00:06:11,880
you look for<font color="#E5E5E5"> and then you'll go that</font>

154
00:06:09,990 --> 00:06:15,870
location<font color="#E5E5E5"> the code and will inspect it</font>

155
00:06:11,880 --> 00:06:17,820
<font color="#CCCCCC">and see how it works you can also be</font><font color="#E5E5E5"> use</font>

156
00:06:15,870 --> 00:06:19,830
<font color="#CCCCCC">jab search or strings as well alright</font>

157
00:06:17,820 --> 00:06:21,870
really<font color="#CCCCCC"> nice you can just go</font><font color="#E5E5E5"> down in the</font>

158
00:06:19,830 --> 00:06:24,419
lower corner<font color="#CCCCCC"> there search whatever</font>

159
00:06:21,870 --> 00:06:26,370
encrypted value may want and I'll show

160
00:06:24,420 --> 00:06:28,950
you exactly<font color="#CCCCCC"> where in the</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> that is</font>

161
00:06:26,370 --> 00:06:32,340
right so in this case what I end up

162
00:06:28,950 --> 00:06:34,280
<font color="#CCCCCC">doing is you can also click on</font><font color="#E5E5E5"> it and do</font>

163
00:06:32,340 --> 00:06:36,900
a cross reference which is<font color="#E5E5E5"> really nice</font>

164
00:06:34,280 --> 00:06:40,549
where its first initialize and then

165
00:06:36,900 --> 00:06:40,549
<font color="#E5E5E5">where</font><font color="#CCCCCC"> Jeep's as well which is great</font>

166
00:06:42,169 --> 00:06:46,770
you can also do a search in item<font color="#E5E5E5"> right</font>

167
00:06:45,000 --> 00:06:48,270
<font color="#E5E5E5">so one of the things you can do is you</font>

168
00:06:46,770 --> 00:06:50,099
go to your strings window and Ida Pro

169
00:06:48,270 --> 00:06:52,770
<font color="#E5E5E5">click on a particular string you want</font>

170
00:06:50,099 --> 00:06:55,620
<font color="#E5E5E5">all right you can find where</font><font color="#CCCCCC"> the code</font>

171
00:06:52,770 --> 00:06:59,330
<font color="#E5E5E5">base badges and then from there you can</font>

172
00:06:55,620 --> 00:07:04,289
<font color="#CCCCCC">just</font><font color="#E5E5E5"> do a</font><font color="#CCCCCC"> control extra cross-reference</font>

173
00:06:59,330 --> 00:07:06,240
if where it is<font color="#E5E5E5"> it's okay</font><font color="#CCCCCC"> and boom you</font>

174
00:07:04,289 --> 00:07:07,800
can find out<font color="#CCCCCC"> right where it</font><font color="#E5E5E5"> is okay</font><font color="#CCCCCC"> so</font>

175
00:07:06,240 --> 00:07:09,870
<font color="#CCCCCC">no matter if you're using</font><font color="#E5E5E5"> free tools</font>

176
00:07:07,800 --> 00:07:14,099
<font color="#E5E5E5">like graph or professional tool like jab</font>

177
00:07:09,870 --> 00:07:15,780
<font color="#E5E5E5">right a pro this is</font><font color="#CCCCCC"> how you can do it</font><font color="#E5E5E5"> no</font>

178
00:07:14,099 --> 00:07:20,430
<font color="#E5E5E5">static emulator checks by have build</font>

179
00:07:15,780 --> 00:07:22,799
prompts so<font color="#E5E5E5"> we have a few things here</font><font color="#CCCCCC"> so</font>

180
00:07:20,430 --> 00:07:24,840
<font color="#CCCCCC">typically your build profile is when you</font>

181
00:07:22,800 --> 00:07:26,789
compile<font color="#E5E5E5"> Android from source it's going</font>

182
00:07:24,840 --> 00:07:30,150
to have a full<font color="#E5E5E5"> list of a</font><font color="#CCCCCC"> bunch of</font>

183
00:07:26,789 --> 00:07:40,620
different I think<font color="#CCCCCC"> I'm getting a little</font>

184
00:07:30,150 --> 00:07:42,929
<font color="#E5E5E5">background</font><font color="#CCCCCC"> noise</font><font color="#E5E5E5"> by the way cool anyway</font>

185
00:07:40,620 --> 00:07:45,860
on<font color="#CCCCCC"> our ones like your build</font><font color="#E5E5E5"> crops or</font>

186
00:07:42,930 --> 00:07:48,389
properties<font color="#E5E5E5"> about</font><font color="#CCCCCC"> this all right</font><font color="#E5E5E5"> and</font>

187
00:07:45,860 --> 00:07:51,419
you're<font color="#E5E5E5"> going to see things here such as</font>

188
00:07:48,389 --> 00:07:54,060
<font color="#E5E5E5">hardware fingerprints one of the common</font>

189
00:07:51,419 --> 00:07:56,430
<font color="#E5E5E5">ones is goldfish on the bottom so prior</font>

190
00:07:54,060 --> 00:07:58,650
<font color="#E5E5E5">two years</font><font color="#CCCCCC"> ago that was a huge telltale</font>

191
00:07:56,430 --> 00:08:00,389
sign and a lot of<font color="#E5E5E5"> Android does still use</font>

192
00:07:58,650 --> 00:08:02,609
it right<font color="#E5E5E5"> so if we've wrecked your</font>

193
00:08:00,389 --> 00:08:03,659
goldfish<font color="#E5E5E5"> you can very quickly typically</font>

194
00:08:02,610 --> 00:08:06,270
most the time to figure<font color="#E5E5E5"> out</font><font color="#CCCCCC"> where</font>

195
00:08:03,659 --> 00:08:07,919
<font color="#E5E5E5">they're doing</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> emulator detection so</font>

196
00:08:06,270 --> 00:08:10,229
here's what we do we grep for goldfish

197
00:08:07,919 --> 00:08:13,049
<font color="#E5E5E5">and I can see on the left here the</font>

198
00:08:10,229 --> 00:08:15,150
<font color="#CCCCCC">wallet</font><font color="#E5E5E5"> slash</font><font color="#CCCCCC"> retails</font><font color="#E5E5E5"> curious</font><font color="#CCCCCC"> hills got</font>

199
00:08:13,050 --> 00:08:16,889
<font color="#E5E5E5">smaller file so then I</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> go that place</font>

200
00:08:15,150 --> 00:08:20,729
<font color="#E5E5E5">in the code and I can modify it as</font>

201
00:08:16,889 --> 00:08:22,620
needed<font color="#CCCCCC"> so another thing they look for in</font>

202
00:08:20,729 --> 00:08:25,919
build.prop<font color="#CCCCCC"> is</font><font color="#E5E5E5"> information such as your</font>

203
00:08:22,620 --> 00:08:27,000
<font color="#CCCCCC">model product</font><font color="#E5E5E5"> radio etc</font><font color="#CCCCCC"> know where I'll</font>

204
00:08:25,919 --> 00:08:29,159
<font color="#CCCCCC">show you</font><font color="#E5E5E5"> how to get</font><font color="#CCCCCC"> around all these</font><font color="#E5E5E5"> in</font>

205
00:08:27,000 --> 00:08:31,680
a little<font color="#CCCCCC"> bit and also</font><font color="#E5E5E5"> test keys in an</font>

206
00:08:29,159 --> 00:08:33,689
<font color="#E5E5E5">Android build here's what it looks like</font>

207
00:08:31,680 --> 00:08:34,649
in the code right<font color="#E5E5E5"> so in this one you're</font>

208
00:08:33,690 --> 00:08:36,930
<font color="#E5E5E5">going to see something</font><font color="#CCCCCC"> that looks like</font>

209
00:08:34,649 --> 00:08:40,529
build<font color="#CCCCCC"> fingerprint starts with generic or</font>

210
00:08:36,929 --> 00:08:42,529
fingerprint starts with unknown yet<font color="#E5E5E5"> very</font>

211
00:08:40,529 --> 00:08:45,870
<font color="#E5E5E5">blatantly stands out in the codebase and</font>

212
00:08:42,529 --> 00:08:47,579
how you get<font color="#CCCCCC"> around</font><font color="#E5E5E5"> this is trivial since</font>

213
00:08:45,870 --> 00:08:49,890
<font color="#CCCCCC">your root on the</font><font color="#E5E5E5"> emulator you need to go</font>

214
00:08:47,579 --> 00:08:52,170
to the build profile and edit<font color="#E5E5E5"> those</font>

215
00:08:49,890 --> 00:08:56,000
so it's<font color="#CCCCCC"> looking for goldfish changes to</font>

216
00:08:52,170 --> 00:08:58,500
<font color="#CCCCCC">my Nana</font><font color="#E5E5E5"> turtle or giraffe right trivial</font>

217
00:08:56,000 --> 00:09:02,310
and there's additional<font color="#E5E5E5"> checks</font><font color="#CCCCCC"> that might</font>

218
00:08:58,500 --> 00:09:03,329
do<font color="#E5E5E5"> so one of them are the get</font><font color="#CCCCCC"> voicemail</font>

219
00:09:02,310 --> 00:09:05,339
number so there's something<font color="#E5E5E5"> called</font>

220
00:09:03,329 --> 00:09:06,779
<font color="#E5E5E5">telephony manager and it's designed to</font>

221
00:09:05,339 --> 00:09:08,160
<font color="#E5E5E5">get information about the phone right</font>

222
00:09:06,779 --> 00:09:11,579
like if you want to figure<font color="#E5E5E5"> out what</font>

223
00:09:08,160 --> 00:09:12,959
country your users in one of the things

224
00:09:11,579 --> 00:09:15,750
you can do is this get<font color="#CCCCCC"> voicemail number</font>

225
00:09:12,959 --> 00:09:18,439
one and on your<font color="#CCCCCC"> emulator it's a static</font>

226
00:09:15,750 --> 00:09:21,350
<font color="#CCCCCC">number it's always going back</font><font color="#E5E5E5"> the same</font>

227
00:09:18,440 --> 00:09:23,459
<font color="#CCCCCC">some Deb's can look for this right</font>

228
00:09:21,350 --> 00:09:25,649
getting around it<font color="#E5E5E5"> again</font><font color="#CCCCCC"> it's really</font>

229
00:09:23,459 --> 00:09:27,959
<font color="#E5E5E5">trivial</font><font color="#CCCCCC"> just make a copy</font><font color="#E5E5E5"> or your</font>

230
00:09:25,649 --> 00:09:29,970
emulator binary<font color="#E5E5E5"> all right open</font><font color="#CCCCCC"> it up</font><font color="#E5E5E5"> in</font>

231
00:09:27,959 --> 00:09:32,180
a text<font color="#E5E5E5"> editor figure out what the</font>

232
00:09:29,970 --> 00:09:35,430
<font color="#CCCCCC">appropriate you know</font><font color="#E5E5E5"> base</font><font color="#CCCCCC"> ten the hex</font>

233
00:09:32,180 --> 00:09:38,069
<font color="#E5E5E5">conversion is for that number right here</font>

234
00:09:35,430 --> 00:09:41,279
and then<font color="#CCCCCC"> just edit it</font><font color="#E5E5E5"> boom you're good</font>

235
00:09:38,070 --> 00:09:44,130
the checker will fail<font color="#CCCCCC"> so static route</font>

236
00:09:41,279 --> 00:09:45,750
checks so here's the techniques I've

237
00:09:44,130 --> 00:09:47,279
seen<font color="#E5E5E5"> typically it's one of these</font><font color="#CCCCCC"> four</font>

238
00:09:45,750 --> 00:09:49,470
right<font color="#CCCCCC"> there</font><font color="#E5E5E5"> looking for the</font><font color="#CCCCCC"> president</font><font color="#E5E5E5"> of</font>

239
00:09:47,279 --> 00:09:51,870
a binary<font color="#E5E5E5"> they're looking from some</font>

240
00:09:49,470 --> 00:09:54,180
attribute like<font color="#E5E5E5"> a weird directory change</font>

241
00:09:51,870 --> 00:09:57,089
<font color="#CCCCCC">their hashing a particular file or</font>

242
00:09:54,180 --> 00:10:00,719
they're relying on existing binaries

243
00:09:57,089 --> 00:10:02,160
like in<font color="#E5E5E5"> Sakura who am i searching for</font>

244
00:10:00,720 --> 00:10:05,130
these<font color="#CCCCCC"> trivial</font><font color="#E5E5E5"> right so they're going to</font>

245
00:10:02,160 --> 00:10:07,500
<font color="#E5E5E5">be looking for bin su x 10's you or the</font>

246
00:10:05,130 --> 00:10:09,209
actual<font color="#CCCCCC"> apk files</font><font color="#E5E5E5"> that invokes in this</font>

247
00:10:07,500 --> 00:10:12,870
<font color="#E5E5E5">routing behavior right like super users</font>

248
00:10:09,209 --> 00:10:14,910
at<font color="#CCCCCC"> APK</font><font color="#E5E5E5"> or chain five</font><font color="#CCCCCC"> APK these are</font>

249
00:10:12,870 --> 00:10:18,420
really easy<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get around you can</font><font color="#CCCCCC"> just</font>

250
00:10:14,910 --> 00:10:20,760
rename them right super easy<font color="#E5E5E5"> just use a</font>

251
00:10:18,420 --> 00:10:23,969
little<font color="#E5E5E5"> clip so system</font><font color="#CCCCCC"> app in super user</font>

252
00:10:20,760 --> 00:10:25,560
<font color="#CCCCCC">APK rename</font><font color="#E5E5E5"> that not super user</font><font color="#CCCCCC"> APK it'll</font>

253
00:10:23,970 --> 00:10:30,560
fail to check<font color="#CCCCCC"> if</font><font color="#E5E5E5"> they're not hashing</font>

254
00:10:25,560 --> 00:10:34,170
right<font color="#CCCCCC"> looking for su and slash SVSU</font>

255
00:10:30,560 --> 00:10:38,310
<font color="#E5E5E5">rename it</font><font color="#CCCCCC"> nada see right that binaries</font>

256
00:10:34,170 --> 00:10:39,449
is still work<font color="#E5E5E5"> fine next check which</font><font color="#CCCCCC"> you</font>

257
00:10:38,310 --> 00:10:42,209
often<font color="#E5E5E5"> see is checking the system</font>

258
00:10:39,449 --> 00:10:44,219
attributes<font color="#E5E5E5"> so we usually</font><font color="#CCCCCC"> route the phony</font>

259
00:10:42,209 --> 00:10:45,540
<font color="#E5E5E5">of this slash system directory and it</font>

260
00:10:44,220 --> 00:10:47,790
should be only<font color="#E5E5E5"> read-only</font>

261
00:10:45,540 --> 00:10:49,680
<font color="#CCCCCC">unnhhh on route devices</font><font color="#E5E5E5"> but when you</font>

262
00:10:47,790 --> 00:10:52,380
read<font color="#E5E5E5"> some of the</font><font color="#CCCCCC"> grits will leave it and</font>

263
00:10:49,680 --> 00:10:54,329
rewritable<font color="#E5E5E5"> you do that</font><font color="#CCCCCC"> Deb's can check</font>

264
00:10:52,380 --> 00:10:56,010
<font color="#CCCCCC">those super</font><font color="#E5E5E5"> easy fix</font>

265
00:10:54,329 --> 00:10:59,160
just the commands right down<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bottom</font>

266
00:10:56,010 --> 00:11:02,069
<font color="#E5E5E5">just change it to mount - all</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> owing</font>

267
00:10:59,160 --> 00:11:03,000
to freedom right remount<font color="#E5E5E5"> reality</font><font color="#CCCCCC"> slash</font>

268
00:11:02,069 --> 00:11:06,439
system

269
00:11:03,000 --> 00:11:08,820
<font color="#E5E5E5">your Goldman doesn't look unusual</font><font color="#CCCCCC"> them</font>

270
00:11:06,440 --> 00:11:10,380
smart<font color="#CCCCCC"> des will actually try to hash the</font>

271
00:11:08,820 --> 00:11:12,000
file so they actually<font color="#E5E5E5"> will go through</font>

272
00:11:10,380 --> 00:11:15,330
<font color="#CCCCCC">all the iterations they can find</font><font color="#E5E5E5"> on</font>

273
00:11:12,000 --> 00:11:17,640
<font color="#CCCCCC">internet of su or Super User apk get a</font>

274
00:11:15,330 --> 00:11:20,400
hash of those right and then check for

275
00:11:17,640 --> 00:11:23,189
<font color="#CCCCCC">those so you could</font><font color="#E5E5E5"> get around this a few</font>

276
00:11:20,400 --> 00:11:24,300
ways<font color="#CCCCCC"> you could recompile se you change a</font>

277
00:11:23,190 --> 00:11:27,000
little<font color="#E5E5E5"> bit of</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> it's going to have a</font>

278
00:11:24,300 --> 00:11:28,140
hash that's<font color="#E5E5E5"> not public that's one one of</font>

279
00:11:27,000 --> 00:11:29,910
the steps we'll get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> in the next</font>

280
00:11:28,140 --> 00:11:32,460
<font color="#CCCCCC">section is</font><font color="#E5E5E5"> you can actually patch out</font>

281
00:11:29,910 --> 00:11:34,980
these or no off these checks<font color="#E5E5E5"> order to</font>

282
00:11:32,460 --> 00:11:38,490
change the value<font color="#CCCCCC"> of a check in the</font>

283
00:11:34,980 --> 00:11:41,280
debugger as well you also<font color="#CCCCCC"> have</font><font color="#E5E5E5"> some</font>

284
00:11:38,490 --> 00:11:43,710
binary checks to which you'll see<font color="#E5E5E5"> one of</font>

285
00:11:41,280 --> 00:11:45,329
these is I<font color="#E5E5E5"> often see is there's a</font>

286
00:11:43,710 --> 00:11:47,310
command<font color="#E5E5E5"> called Who am I Linux it's</font>

287
00:11:45,330 --> 00:11:49,770
basically<font color="#E5E5E5"> return your pit what user</font>

288
00:11:47,310 --> 00:11:51,780
you're running<font color="#CCCCCC"> is</font><font color="#E5E5E5"> if you're</font><font color="#CCCCCC"> running as</font>

289
00:11:49,770 --> 00:11:52,020
root or<font color="#CCCCCC"> will try to invoke running as</font>

290
00:11:51,780 --> 00:11:54,199
root

291
00:11:52,020 --> 00:11:56,420
<font color="#E5E5E5">sometimes you'll get a</font><font color="#CCCCCC"> different value</font>

292
00:11:54,200 --> 00:11:59,910
<font color="#CCCCCC">so one of the things you could do is</font>

293
00:11:56,420 --> 00:12:02,339
compile a little app and see make it so

294
00:11:59,910 --> 00:12:04,680
it never<font color="#E5E5E5"> returns a value that would flag</font>

295
00:12:02,340 --> 00:12:07,140
<font color="#E5E5E5">this that's one you could patch it</font><font color="#CCCCCC"> out</font>

296
00:12:04,680 --> 00:12:10,530
and check the binary right<font color="#E5E5E5"> or ethos</font><font color="#CCCCCC"> and</font>

297
00:12:07,140 --> 00:12:13,560
<font color="#E5E5E5">mod find a</font><font color="#CCCCCC"> juggler</font><font color="#E5E5E5"> as well dynamic</font>

298
00:12:10,530 --> 00:12:14,220
checks<font color="#E5E5E5"> so these are</font><font color="#CCCCCC"> super rare but it</font>

299
00:12:13,560 --> 00:12:16,109
can<font color="#E5E5E5"> be done</font>

300
00:12:14,220 --> 00:12:18,360
so<font color="#CCCCCC"> devs could</font><font color="#E5E5E5"> pull sensor data and</font>

301
00:12:16,110 --> 00:12:20,460
compare it<font color="#E5E5E5"> one of the things I</font><font color="#CCCCCC"> would do</font>

302
00:12:18,360 --> 00:12:21,930
at my job<font color="#CCCCCC"> at mitre is I built a</font><font color="#E5E5E5"> little</font>

303
00:12:20,460 --> 00:12:24,630
tool that<font color="#CCCCCC"> would check if I was</font><font color="#E5E5E5"> running</font>

304
00:12:21,930 --> 00:12:26,760
an emulator<font color="#E5E5E5"> the emulator always returns</font>

305
00:12:24,630 --> 00:12:28,710
a temperature of 32 degrees<font color="#E5E5E5"> Fahrenheit</font>

306
00:12:26,760 --> 00:12:30,930
<font color="#E5E5E5">for zero degrees Celsius depending on</font>

307
00:12:28,710 --> 00:12:33,000
where you<font color="#CCCCCC"> are right</font><font color="#E5E5E5"> so if I'm in</font>

308
00:12:30,930 --> 00:12:34,589
California<font color="#CCCCCC"> and it's</font><font color="#E5E5E5"> 32</font><font color="#CCCCCC"> degrees</font>

309
00:12:33,000 --> 00:12:35,270
<font color="#CCCCCC">Fahrenheit</font><font color="#E5E5E5"> I'm probably running out of</font>

310
00:12:34,590 --> 00:12:37,800
nebula

311
00:12:35,270 --> 00:12:39,990
does could do more sophisticated checks

312
00:12:37,800 --> 00:12:42,599
<font color="#E5E5E5">like checking number of contacts</font><font color="#CCCCCC"> called</font>

313
00:12:39,990 --> 00:12:45,120
<font color="#CCCCCC">inane sms's number</font><font color="#E5E5E5"> install packages</font>

314
00:12:42,600 --> 00:12:46,680
that's really<font color="#E5E5E5"> really rare</font><font color="#CCCCCC"> but typically</font>

315
00:12:45,120 --> 00:12:49,380
the best dynamic check it out there is

316
00:12:46,680 --> 00:12:51,719
<font color="#CCCCCC">this</font><font color="#E5E5E5"> Android safety net or Google safety</font>

317
00:12:49,380 --> 00:12:54,810
net API that's<font color="#CCCCCC"> really cool</font><font color="#E5E5E5"> so what this</font>

318
00:12:51,720 --> 00:12:57,450
<font color="#E5E5E5">does</font><font color="#CCCCCC"> is whenever it</font><font color="#E5E5E5"> does uses this it</font>

319
00:12:54,810 --> 00:13:00,150
pulled down<font color="#CCCCCC"> a special binary from Google</font>

320
00:12:57,450 --> 00:13:01,890
<font color="#CCCCCC">that very very few times</font><font color="#E5E5E5"> does a bunch of</font>

321
00:13:00,150 --> 00:13:02,329
checks on the phone measures a bunch of

322
00:13:01,890 --> 00:13:05,010
<font color="#E5E5E5">things</font>

323
00:13:02,330 --> 00:13:07,200
sends it<font color="#CCCCCC"> back up</font><font color="#E5E5E5"> to Google and</font><font color="#CCCCCC"> Google</font>

324
00:13:05,010 --> 00:13:09,030
knows based on your phone<font color="#CCCCCC"> model and</font>

325
00:13:07,200 --> 00:13:10,920
operating<font color="#E5E5E5"> system let's say</font>

326
00:13:09,030 --> 00:13:12,990
realistic-looking phone or a rooted

327
00:13:10,920 --> 00:13:14,140
phone<font color="#CCCCCC"> or non rooted phone</font><font color="#E5E5E5"> and it returns</font>

328
00:13:12,990 --> 00:13:15,730
that<font color="#E5E5E5"> value back</font>

329
00:13:14,140 --> 00:13:17,920
right<font color="#E5E5E5"> I personally don't know how to get</font>

330
00:13:15,730 --> 00:13:19,810
around<font color="#E5E5E5"> this the Pokemon</font><font color="#CCCCCC"> bill reversing</font>

331
00:13:17,920 --> 00:13:23,349
forms<font color="#E5E5E5"> actually has some really good tear</font>

332
00:13:19,810 --> 00:13:25,029
downs here<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> what's</font><font color="#CCCCCC"> facing</font><font color="#E5E5E5"> that</font>

333
00:13:23,350 --> 00:13:26,560
call would<font color="#E5E5E5"> look like so you're going</font><font color="#CCCCCC"> to</font>

334
00:13:25,029 --> 00:13:29,110
see some telltale strings here<font color="#E5E5E5"> the</font>

335
00:13:26,560 --> 00:13:31,180
safety<font color="#CCCCCC"> net service new Google API</font><font color="#E5E5E5"> state</font>

336
00:13:29,110 --> 00:13:33,850
you'll see<font color="#E5E5E5"> and the method in</font><font color="#CCCCCC"> particular</font>

337
00:13:31,180 --> 00:13:35,739
that starts this test is<font color="#E5E5E5"> that AC test</font>

338
00:13:33,850 --> 00:13:38,350
method on the bottom highlight in yellow

339
00:13:35,740 --> 00:13:39,850
<font color="#E5E5E5">there's a phenomenal teardown</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> Sega C</font>

340
00:13:38,350 --> 00:13:42,070
net on the link<font color="#E5E5E5"> on the bottom there if</font>

341
00:13:39,850 --> 00:13:44,399
you want<font color="#E5E5E5"> to learn more because just that</font>

342
00:13:42,070 --> 00:13:45,579
alone could<font color="#CCCCCC"> be like a</font><font color="#E5E5E5"> 60 minute talk</font>

343
00:13:44,399 --> 00:13:48,370
<font color="#E5E5E5">okay</font>

344
00:13:45,579 --> 00:13:50,319
so<font color="#CCCCCC"> TL</font><font color="#E5E5E5"> DR here unless unless it's safety</font>

345
00:13:48,370 --> 00:13:53,140
<font color="#E5E5E5">net we can get around it either by</font>

346
00:13:50,320 --> 00:13:55,450
patching<font color="#E5E5E5"> or changing values by the</font>

347
00:13:53,140 --> 00:13:59,980
bugger<font color="#E5E5E5"> or</font><font color="#CCCCCC"> disprove the</font><font color="#E5E5E5"> little</font><font color="#CCCCCC"> renamed</font>

348
00:13:55,450 --> 00:14:01,480
<font color="#CCCCCC">offense the first link there is a great</font>

349
00:13:59,980 --> 00:14:03,190
academic<font color="#E5E5E5"> paper of the strings you want</font>

350
00:14:01,480 --> 00:14:04,899
<font color="#E5E5E5">to look for there's also a really good</font>

351
00:14:03,190 --> 00:14:06,910
black<font color="#CCCCCC"> hat talk that</font><font color="#E5E5E5"> they went through</font>

352
00:14:04,899 --> 00:14:09,510
<font color="#CCCCCC">all these techniques</font><font color="#E5E5E5"> and route detection</font>

353
00:14:06,910 --> 00:14:10,689
show how<font color="#CCCCCC"> trivially</font><font color="#E5E5E5"> you around them</font><font color="#CCCCCC"> to</font>

354
00:14:09,510 --> 00:14:15,370
<font color="#E5E5E5">okay</font>

355
00:14:10,690 --> 00:14:17,800
on iOS now<font color="#E5E5E5"> so iOS</font><font color="#CCCCCC"> jailbreaking on my</font>

356
00:14:15,370 --> 00:14:19,420
wife's device just roughly<font color="#E5E5E5"> about four</font>

357
00:14:17,800 --> 00:14:23,399
ways<font color="#CCCCCC"> that you're going to detect this</font>

358
00:14:19,420 --> 00:14:25,660
<font color="#E5E5E5">right first is jailbreak artifacts right</font>

359
00:14:23,399 --> 00:14:28,360
<font color="#CCCCCC">next you're</font><font color="#E5E5E5"> going to have non-standard</font>

360
00:14:25,660 --> 00:14:30,040
ports differences in the sandbox<font color="#E5E5E5"> and</font>

361
00:14:28,360 --> 00:14:31,540
system<font color="#E5E5E5"> modifications</font><font color="#CCCCCC"> and we're also</font>

362
00:14:30,040 --> 00:14:36,550
going to touch<font color="#E5E5E5"> a little bit on the app</font>

363
00:14:31,540 --> 00:14:37,510
hooking<font color="#CCCCCC"> lad freedom</font><font color="#E5E5E5"> Cydia - so these</font>

364
00:14:36,550 --> 00:14:39,609
strings stand up

365
00:14:37,510 --> 00:14:43,000
<font color="#E5E5E5">if you see an iOS app looking for bin</font>

366
00:14:39,610 --> 00:14:44,470
<font color="#E5E5E5">bash that can be</font><font color="#CCCCCC"> a sign your iOS let it</font>

367
00:14:43,000 --> 00:14:46,720
fall it's<font color="#CCCCCC"> not going to have bash and</font>

368
00:14:44,470 --> 00:14:50,410
your jailbreak<font color="#E5E5E5"> your</font><font color="#CCCCCC"> front bash on there</font>

369
00:14:46,720 --> 00:14:52,180
<font color="#E5E5E5">any references to the Cydia app or asked</font>

370
00:14:50,410 --> 00:14:54,370
which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the you know package management</font>

371
00:14:52,180 --> 00:14:57,189
tool<font color="#E5E5E5"> that's going to be an indicator</font>

372
00:14:54,370 --> 00:14:59,230
right<font color="#E5E5E5"> is on non jailbroken iOS devices</font>

373
00:14:57,190 --> 00:15:01,660
you can't do package management like

374
00:14:59,230 --> 00:15:04,570
that you're getting<font color="#E5E5E5"> everything from the</font>

375
00:15:01,660 --> 00:15:08,290
iOS store right or a trusted<font color="#CCCCCC"> Enterprise</font>

376
00:15:04,570 --> 00:15:10,149
<font color="#CCCCCC">Service I loaded on there any references</font>

377
00:15:08,290 --> 00:15:15,040
to<font color="#CCCCCC"> pandu</font><font color="#E5E5E5"> or your other jailbreaking</font>

378
00:15:10,149 --> 00:15:16,540
tools right such<font color="#CCCCCC"> as</font><font color="#E5E5E5"> IO</font><font color="#CCCCCC"> tangu</font><font color="#E5E5E5"> Exe the</font>

379
00:15:15,040 --> 00:15:19,689
other ones you're<font color="#E5E5E5"> going to see little</font>

380
00:15:16,540 --> 00:15:23,010
<font color="#E5E5E5">often a check for mobile substrate SFTP</font>

381
00:15:19,690 --> 00:15:25,690
or stash<font color="#CCCCCC"> all right so if you see these</font>

382
00:15:23,010 --> 00:15:26,860
see if you can patch out those methods

383
00:15:25,690 --> 00:15:29,170
for<font color="#E5E5E5"> those checks</font>

384
00:15:26,860 --> 00:15:30,970
the other trick you<font color="#E5E5E5"> can do which</font><font color="#CCCCCC"> is an</font>

385
00:15:29,170 --> 00:15:32,680
interesting one is when you jailbreak<font color="#E5E5E5"> an</font>

386
00:15:30,970 --> 00:15:35,890
iOS<font color="#E5E5E5"> device you know you're communicating</font>

387
00:15:32,680 --> 00:15:40,030
over<font color="#E5E5E5"> SSH typically right</font><font color="#CCCCCC"> look for any</font>

388
00:15:35,890 --> 00:15:42,069
code references to localhost<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> to 7.00 1</font>

389
00:15:40,030 --> 00:15:46,240
and then see if they're checking<font color="#E5E5E5"> that</font>

390
00:15:42,070 --> 00:15:47,920
socket<font color="#E5E5E5"> right that's an easy check this</font>

391
00:15:46,240 --> 00:15:51,010
is some neat stuff<font color="#E5E5E5"> right so</font><font color="#CCCCCC"> then there's</font>

392
00:15:47,920 --> 00:15:53,729
also sandbox changes right so for splits

393
00:15:51,010 --> 00:15:56,110
a new process right on your<font color="#E5E5E5"> non</font>

394
00:15:53,730 --> 00:15:58,540
jailbroken devices apps can't fork

395
00:15:56,110 --> 00:15:59,980
themselves<font color="#E5E5E5"> right but based on some</font><font color="#CCCCCC"> of</font>

396
00:15:58,540 --> 00:16:01,329
the jail breaks you can actually<font color="#E5E5E5"> do that</font>

397
00:15:59,980 --> 00:16:03,790
<font color="#E5E5E5">so one of the things the process</font><font color="#CCCCCC"> will</font>

398
00:16:01,330 --> 00:16:06,130
try to<font color="#E5E5E5"> do is call for get that</font><font color="#CCCCCC"> succeeds</font>

399
00:16:03,790 --> 00:16:08,620
and it's<font color="#CCCCCC"> likely they're running ma Jill</font>

400
00:16:06,130 --> 00:16:12,000
broken<font color="#E5E5E5"> phone there's also a little file</font>

401
00:16:08,620 --> 00:16:14,080
differences<font color="#E5E5E5"> so another common</font><font color="#CCCCCC"> example is</font>

402
00:16:12,000 --> 00:16:16,030
you shouldn't<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to write</font><font color="#CCCCCC"> to the</font>

403
00:16:14,080 --> 00:16:18,280
private directory<font color="#E5E5E5"> devs will sometimes</font>

404
00:16:16,030 --> 00:16:19,810
<font color="#CCCCCC">try to do</font><font color="#E5E5E5"> that right and if</font><font color="#CCCCCC"> that</font>

405
00:16:18,280 --> 00:16:21,459
<font color="#E5E5E5">succeeds then they know hey if</font>

406
00:16:19,810 --> 00:16:24,939
something's changed with the sandbox<font color="#E5E5E5"> I'm</font>

407
00:16:21,460 --> 00:16:26,470
probably guilt open next<font color="#E5E5E5"> one is system</font>

408
00:16:24,940 --> 00:16:28,930
<font color="#CCCCCC">modification</font><font color="#E5E5E5"> so this one's</font><font color="#CCCCCC"> actually a</font>

409
00:16:26,470 --> 00:16:30,850
<font color="#E5E5E5">cool one</font><font color="#CCCCCC"> so to make more room for all</font>

410
00:16:28,930 --> 00:16:32,979
your jailbroken apps<font color="#E5E5E5"> after the jailbreak</font>

411
00:16:30,850 --> 00:16:35,650
they take the application partition and

412
00:16:32,980 --> 00:16:37,300
they make<font color="#E5E5E5"> that like a symbol if you see</font>

413
00:16:35,650 --> 00:16:40,510
a debit checking for<font color="#E5E5E5"> that in your</font>

414
00:16:37,300 --> 00:16:43,750
<font color="#CCCCCC">assembly code then you</font><font color="#E5E5E5"> know that's one</font>

415
00:16:40,510 --> 00:16:45,790
technique<font color="#E5E5E5"> and all these</font><font color="#CCCCCC"> are gone into</font>

416
00:16:43,750 --> 00:16:49,870
much much more granular detail<font color="#CCCCCC"> the</font>

417
00:16:45,790 --> 00:16:51,310
mobile application hacker's handbook<font color="#E5E5E5"> so</font>

418
00:16:49,870 --> 00:16:53,350
this is<font color="#E5E5E5"> another new one you can do here</font>

419
00:16:51,310 --> 00:16:55,060
<font color="#CCCCCC">-</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> detect if there's function hooking</font>

420
00:16:53,350 --> 00:16:57,100
like if you use<font color="#CCCCCC"> frida or any of the</font>

421
00:16:55,060 --> 00:16:59,199
other cooking<font color="#E5E5E5"> tools there's a few things</font>

422
00:16:57,100 --> 00:17:01,540
you can<font color="#E5E5E5"> do there's a neat little binary</font>

423
00:16:59,200 --> 00:17:04,060
called<font color="#CCCCCC"> DL a TDR and how that works</font><font color="#E5E5E5"> and</font>

424
00:17:01,540 --> 00:17:06,490
essentially give it a pointer and then

425
00:17:04,060 --> 00:17:08,589
that pointer will tell you where<font color="#E5E5E5"> a</font>

426
00:17:06,490 --> 00:17:10,390
<font color="#E5E5E5">pointer to</font><font color="#CCCCCC"> a process I'll tell you where</font>

427
00:17:08,589 --> 00:17:12,940
that<font color="#E5E5E5"> process originated from which is</font>

428
00:17:10,390 --> 00:17:15,610
pretty<font color="#E5E5E5"> cool now on iOS</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> a non</font>

429
00:17:12,940 --> 00:17:17,110
jailbroken device if your process<font color="#CCCCCC"> is</font>

430
00:17:15,609 --> 00:17:19,060
<font color="#E5E5E5">going to either come from</font><font color="#CCCCCC"> you know</font>

431
00:17:17,109 --> 00:17:22,208
you're currently running<font color="#E5E5E5"> one system</font>

432
00:17:19,060 --> 00:17:24,280
library text input accessibility private

433
00:17:22,209 --> 00:17:27,160
frameworks or frameworks or user live

434
00:17:24,280 --> 00:17:29,470
this anywhere<font color="#CCCCCC"> else</font><font color="#E5E5E5"> then it's going to be</font>

435
00:17:27,160 --> 00:17:34,030
a jailbroken device or it's<font color="#E5E5E5"> got to be</font>

436
00:17:29,470 --> 00:17:36,070
hopes on that<font color="#E5E5E5"> so bonus you can</font><font color="#CCCCCC"> also look</font>

437
00:17:34,030 --> 00:17:37,899
for debugger detection right so if you

438
00:17:36,070 --> 00:17:39,939
see it's called<font color="#CCCCCC"> P</font><font color="#E5E5E5"> trace or</font><font color="#CCCCCC"> P trays to</font>

439
00:17:37,900 --> 00:17:40,510
catch<font color="#CCCCCC"> to nine</font><font color="#E5E5E5"> probably doing a debugger</font>

440
00:17:39,940 --> 00:17:43,860
check

441
00:17:40,510 --> 00:17:46,210
you can also do it<font color="#CCCCCC"> with sy s</font><font color="#E5E5E5"> CTL as well</font>

442
00:17:43,860 --> 00:17:47,918
<font color="#CCCCCC">and if you have any questions on this</font>

443
00:17:46,210 --> 00:17:50,080
<font color="#E5E5E5">please the last Tim he's giving a talk</font>

444
00:17:47,919 --> 00:17:53,860
after<font color="#E5E5E5"> me</font><font color="#CCCCCC"> he's much better this kind</font><font color="#E5E5E5"> of</font>

445
00:17:50,080 --> 00:17:55,629
<font color="#CCCCCC">debugging detection than me so how do</font>

446
00:17:53,860 --> 00:17:57,490
<font color="#E5E5E5">you get</font><font color="#CCCCCC"> around these right same kind of</font>

447
00:17:55,630 --> 00:18:00,010
counter measures which will dive into on

448
00:17:57,490 --> 00:18:01,600
<font color="#CCCCCC">an Android a</font><font color="#E5E5E5"> little bit is you patch out</font>

449
00:18:00,010 --> 00:18:04,658
these<font color="#CCCCCC"> jacks which</font><font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> walk you through</font>

450
00:18:01,600 --> 00:18:07,178
how<font color="#E5E5E5"> to do and you can patch it on hopper</font>

451
00:18:04,659 --> 00:18:10,570
offers about $100 I think per license

452
00:18:07,179 --> 00:18:13,840
<font color="#CCCCCC">Ida Pro starts at about thousand you can</font>

453
00:18:10,570 --> 00:18:15,789
also see the app mobile app after Samvel

454
00:18:13,840 --> 00:18:18,039
<font color="#CCCCCC">50 to walk through and if you're new to</font>

455
00:18:15,789 --> 00:18:19,539
arm<font color="#E5E5E5"> because a lot of this passion</font><font color="#CCCCCC"> on iOS</font>

456
00:18:18,039 --> 00:18:21,940
is going to be at<font color="#CCCCCC"> your arm disassembly</font>

457
00:18:19,539 --> 00:18:24,309
level this is a great<font color="#E5E5E5"> two day video</font>

458
00:18:21,940 --> 00:18:29,230
<font color="#CCCCCC">course</font><font color="#E5E5E5"> upon open security training info</font>

459
00:18:24,309 --> 00:18:31,418
/<font color="#E5E5E5"> Android on also Emily giving a talk</font>

460
00:18:29,230 --> 00:18:35,080
next<font color="#CCCCCC"> to and the Olaf's</font><font color="#E5E5E5"> mobile guide</font>

461
00:18:31,419 --> 00:18:40,120
<font color="#CCCCCC">online is really good as well</font><font color="#E5E5E5"> okay sir</font>

462
00:18:35,080 --> 00:18:43,510
<font color="#E5E5E5">pending time so intercepting traffic on</font>

463
00:18:40,120 --> 00:18:44,830
mobile is actually pretty<font color="#E5E5E5"> easy my</font>

464
00:18:43,510 --> 00:18:48,399
preferred approach is man-in-the-middle

465
00:18:44,830 --> 00:18:50,279
proxy so I run OS X so I just do grew

466
00:18:48,399 --> 00:18:53,080
<font color="#E5E5E5">and song</font><font color="#CCCCCC"> and in the middle proxy</font><font color="#E5E5E5"> I</font>

467
00:18:50,279 --> 00:18:56,350
launch the app and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> on my</font><font color="#E5E5E5"> physical</font>

468
00:18:53,080 --> 00:18:59,049
phone<font color="#CCCCCC"> I set the proxy</font><font color="#E5E5E5"> so I go go to my</font>

469
00:18:56,350 --> 00:19:01,120
Wi-Fi network<font color="#E5E5E5"> changes to whatever the IP</font>

470
00:18:59,049 --> 00:19:04,510
address of<font color="#E5E5E5"> the desktop machine</font><font color="#CCCCCC"> and</font>

471
00:19:01,120 --> 00:19:06,760
running interception on do port 8080<font color="#CCCCCC"> and</font>

472
00:19:04,510 --> 00:19:10,840
<font color="#E5E5E5">then I install fraudulent sir right and</font>

473
00:19:06,760 --> 00:19:12,460
I can see<font color="#CCCCCC"> everything</font><font color="#E5E5E5"> that the cert</font>

474
00:19:10,840 --> 00:19:14,439
pinning<font color="#E5E5E5"> and key validation right there</font>

475
00:19:12,460 --> 00:19:15,760
<font color="#E5E5E5">keep hitting and</font><font color="#CCCCCC"> sir validation</font><font color="#E5E5E5"> rarely</font>

476
00:19:14,440 --> 00:19:18,610
implemented on a lot of<font color="#E5E5E5"> mobile apps</font>

477
00:19:15,760 --> 00:19:22,029
which<font color="#E5E5E5"> is sad which is good but I'll walk</font>

478
00:19:18,610 --> 00:19:24,219
through<font color="#CCCCCC"> how to go through one a lake</font><font color="#E5E5E5"> you</font>

479
00:19:22,029 --> 00:19:26,080
<font color="#CCCCCC">can</font><font color="#E5E5E5"> tell circuiting is occurring as</font>

480
00:19:24,220 --> 00:19:27,760
you've won<font color="#E5E5E5"> your man in the middle of</font>

481
00:19:26,080 --> 00:19:31,149
proxies<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> fail</font><font color="#CCCCCC"> going to be say hey</font>

482
00:19:27,760 --> 00:19:32,980
I can't decrypt this if you see that<font color="#E5E5E5"> one</font>

483
00:19:31,149 --> 00:19:36,370
of the things I do is I go to splash

484
00:19:32,980 --> 00:19:39,309
assets and slash<font color="#E5E5E5"> reg raw directory you</font>

485
00:19:36,370 --> 00:19:41,469
see anything that<font color="#CCCCCC"> looks like a cert I'm</font>

486
00:19:39,309 --> 00:19:44,559
probably<font color="#CCCCCC"> to insert pinning right so this</font>

487
00:19:41,470 --> 00:19:46,779
one you<font color="#E5E5E5"> see a trust or dot dks file if I</font>

488
00:19:44,559 --> 00:19:48,789
actually open that<font color="#E5E5E5"> in a hex</font><font color="#CCCCCC"> editor like</font>

489
00:19:46,779 --> 00:19:50,020
onl<font color="#CCCCCC"> editor</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see something that</font>

490
00:19:48,789 --> 00:19:53,590
<font color="#E5E5E5">says like</font><font color="#CCCCCC"> routes</font><font color="#E5E5E5"> are just</font>

491
00:19:50,020 --> 00:19:55,389
a dedication<font color="#CCCCCC"> Authority right that's</font>

492
00:19:53,590 --> 00:19:57,280
indication<font color="#CCCCCC"> that's being love it and then</font>

493
00:19:55,390 --> 00:19:58,780
I<font color="#E5E5E5"> would look for</font><font color="#CCCCCC"> that string in the</font>

494
00:19:57,280 --> 00:20:02,649
<font color="#CCCCCC">codebase and</font><font color="#E5E5E5"> see if where that's being</font>

495
00:19:58,780 --> 00:20:05,110
cross-referenced other things to<font color="#CCCCCC"> look</font>

496
00:20:02,650 --> 00:20:06,670
for so if yes<font color="#E5E5E5"> off</font><font color="#CCCCCC"> your skate it might be</font>

497
00:20:05,110 --> 00:20:08,560
a<font color="#CCCCCC"> little hard</font><font color="#E5E5E5"> to find</font><font color="#CCCCCC"> these things right</font>

498
00:20:06,670 --> 00:20:10,060
<font color="#E5E5E5">well the good news is</font><font color="#CCCCCC"> even if it's</font>

499
00:20:08,560 --> 00:20:11,830
<font color="#E5E5E5">obvious</font><font color="#CCCCCC"> skating you're still going to</font>

500
00:20:10,060 --> 00:20:14,440
<font color="#E5E5E5">see</font><font color="#CCCCCC"> the imports and certain exceptions</font>

501
00:20:11,830 --> 00:20:16,659
<font color="#E5E5E5">in your code right so if you see things</font>

502
00:20:14,440 --> 00:20:21,310
that look<font color="#CCCCCC"> like</font><font color="#E5E5E5"> keep in store to store</font>

503
00:20:16,660 --> 00:20:23,290
exception<font color="#CCCCCC"> x509 sorezore</font><font color="#E5E5E5"> imports they're</font>

504
00:20:21,310 --> 00:20:26,830
probably doing something would be<font color="#E5E5E5"> SS</font>

505
00:20:23,290 --> 00:20:29,200
<font color="#E5E5E5">elevator</font><font color="#CCCCCC"> to help you learn that</font><font color="#E5E5E5"> I</font>

506
00:20:26,830 --> 00:20:32,139
recommend you go to<font color="#E5E5E5"> the github for</font><font color="#CCCCCC"> OAuth</font>

507
00:20:29,200 --> 00:20:34,960
<font color="#E5E5E5">and also I think munch has some good</font>

508
00:20:32,140 --> 00:20:37,270
<font color="#E5E5E5">examples on his github of how you do</font>

509
00:20:34,960 --> 00:20:39,730
certain<font color="#E5E5E5"> incorrectly</font><font color="#CCCCCC"> if that's the</font><font color="#E5E5E5"> case</font>

510
00:20:37,270 --> 00:20:41,520
you go look at<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and then compile it</font>

511
00:20:39,730 --> 00:20:44,110
<font color="#CCCCCC">and then see what it looks like in the</font>

512
00:20:41,520 --> 00:20:45,930
<font color="#E5E5E5">pro guarded or obfuscated view</font><font color="#CCCCCC"> that</font>

513
00:20:44,110 --> 00:20:47,800
helps a lot

514
00:20:45,930 --> 00:20:51,990
here's<font color="#E5E5E5"> what it looks like at a binary</font>

515
00:20:47,800 --> 00:20:54,070
<font color="#CCCCCC">level so we're in</font><font color="#E5E5E5"> this check</font><font color="#CCCCCC"> method and</font>

516
00:20:51,990 --> 00:20:55,780
you can<font color="#CCCCCC"> see a couple things that will</font>

517
00:20:54,070 --> 00:20:57,970
help you<font color="#E5E5E5"> here just you're unfamiliar</font>

518
00:20:55,780 --> 00:20:59,500
<font color="#E5E5E5">when you're seeing a</font><font color="#CCCCCC"> stringbuilder with</font>

519
00:20:57,970 --> 00:21:02,500
a string the same<font color="#E5E5E5"> certificate pinning</font>

520
00:20:59,500 --> 00:21:04,990
failure right<font color="#CCCCCC"> so it</font><font color="#E5E5E5"> gives some clues</font>

521
00:21:02,500 --> 00:21:08,200
there<font color="#E5E5E5"> additionally you're seeing later</font>

522
00:21:04,990 --> 00:21:10,840
on in the file here this append x.509

523
00:21:08,200 --> 00:21:12,730
certificate<font color="#E5E5E5"> so that's another clue</font><font color="#CCCCCC"> that</font>

524
00:21:10,840 --> 00:21:15,550
this is the current here right also<font color="#E5E5E5"> the</font>

525
00:21:12,730 --> 00:21:17,860
pin certificates long<font color="#E5E5E5"> on you're also</font>

526
00:21:15,550 --> 00:21:20,740
seeing way on the<font color="#E5E5E5"> bottom of</font><font color="#CCCCCC"> the screen</font>

527
00:21:17,860 --> 00:21:26,260
shots<font color="#E5E5E5"> of throw new SSL pier unverified</font>

528
00:21:20,740 --> 00:21:28,000
exception<font color="#CCCCCC"> that</font><font color="#E5E5E5"> be another clue and how</font>

529
00:21:26,260 --> 00:21:29,920
we're actually invoking<font color="#E5E5E5"> this is there's</font>

530
00:21:28,000 --> 00:21:31,990
this v10 that gets certificate any

531
00:21:29,920 --> 00:21:34,330
method and that's calling check<font color="#E5E5E5"> all</font>

532
00:21:31,990 --> 00:21:38,110
<font color="#E5E5E5">right and that's basically saying hey is</font>

533
00:21:34,330 --> 00:21:40,090
this the<font color="#CCCCCC"> correct</font><font color="#E5E5E5"> cert or not so how do</font>

534
00:21:38,110 --> 00:21:42,459
you get<font color="#CCCCCC"> around</font><font color="#E5E5E5"> on this right so you can</font>

535
00:21:40,090 --> 00:21:45,760
hook an API with this and call expose

536
00:21:42,460 --> 00:21:47,530
that could do<font color="#E5E5E5"> it easy DZ one search you</font>

537
00:21:45,760 --> 00:21:49,750
<font color="#E5E5E5">can do is you can</font><font color="#CCCCCC"> just add or replace</font>

538
00:21:47,530 --> 00:21:51,100
the syrup with your malicious home or

539
00:21:49,750 --> 00:21:53,440
you could patch out the code that's

540
00:21:51,100 --> 00:21:57,219
responsible<font color="#CCCCCC"> I usually do the matching I</font>

541
00:21:53,440 --> 00:21:58,660
find that<font color="#E5E5E5"> to the easiest so next we're</font>

542
00:21:57,220 --> 00:22:00,010
going to<font color="#CCCCCC"> run the bugging Android app so</font>

543
00:21:58,660 --> 00:22:02,740
I have a<font color="#E5E5E5"> couple videos here which I'll</font>

544
00:22:00,010 --> 00:22:03,730
play<font color="#E5E5E5"> through the first</font><font color="#CCCCCC"> one is really</font>

545
00:22:02,740 --> 00:22:05,530
<font color="#E5E5E5">sure I'm going to</font>

546
00:22:03,730 --> 00:22:07,930
show you how<font color="#CCCCCC"> to load apps and I</font><font color="#E5E5E5"> to pro</font>

547
00:22:05,530 --> 00:22:09,970
use that dalvik the bugger<font color="#CCCCCC"> I'll also</font>

548
00:22:07,930 --> 00:22:13,390
cover how to set great<font color="#E5E5E5"> points inspect</font>

549
00:22:09,970 --> 00:22:16,630
local variables watch<font color="#CCCCCC"> bales</font><font color="#E5E5E5"> injection in</font>

550
00:22:13,390 --> 00:22:19,750
the<font color="#E5E5E5"> subsequent example so let me load</font>

551
00:22:16,630 --> 00:22:22,780
this up here on full<font color="#E5E5E5"> screen so you guys</font>

552
00:22:19,750 --> 00:22:27,160
can hear<font color="#E5E5E5"> okay this is a quick tutorial</font>

553
00:22:22,780 --> 00:22:32,500
<font color="#E5E5E5">I'll use either firm for</font><font color="#CCCCCC"> gavest</font><font color="#E5E5E5"> about it</font>

554
00:22:27,160 --> 00:22:35,950
per second we had a command path here

555
00:22:32,500 --> 00:22:41,200
suppose psyche<font color="#E5E5E5"> iga2</font><font color="#CCCCCC"> that all along try</font>

556
00:22:35,950 --> 00:22:43,510
to curl 32-bit every ID they to 64 which

557
00:22:41,200 --> 00:22:45,730
this is before<font color="#CCCCCC"> that by mine for our</font>

558
00:22:43,510 --> 00:22:49,420
<font color="#E5E5E5">current facilities click to the side I'm</font>

559
00:22:45,730 --> 00:22:53,380
going<font color="#E5E5E5"> to do Ida I give you</font><font color="#CCCCCC"> ask might</font><font color="#E5E5E5"> say</font>

560
00:22:49,420 --> 00:22:56,410
<font color="#E5E5E5">hi</font><font color="#CCCCCC"> and you can also</font><font color="#E5E5E5"> directly do</font>

561
00:22:53,380 --> 00:23:05,980
<font color="#E5E5E5">particularly toxic effects but this case</font>

562
00:22:56,410 --> 00:23:07,570
<font color="#CCCCCC">will do really fix</font><font color="#E5E5E5"> and enter we don't</font>

563
00:23:05,980 --> 00:23:12,720
want to select<font color="#E5E5E5"> the</font><font color="#CCCCCC"> classic backpack</font>

564
00:23:07,570 --> 00:23:12,720
<font color="#E5E5E5">style here beside</font><font color="#CCCCCC"> fit a peg</font>

565
00:23:19,630 --> 00:23:25,190
cool<font color="#E5E5E5"> so that is a really</font><font color="#CCCCCC"> easy way of</font>

566
00:23:22,190 --> 00:23:27,830
loading it in Ida<font color="#E5E5E5"> right there</font><font color="#CCCCCC"> there is a</font>

567
00:23:25,190 --> 00:23:29,510
<font color="#E5E5E5">30-day trial for Ida - I recommended</font>

568
00:23:27,830 --> 00:23:32,780
<font color="#CCCCCC">learning it</font><font color="#E5E5E5"> and if you're doing a lot of</font>

569
00:23:29,510 --> 00:23:34,310
heavy<font color="#E5E5E5"> mobile reversing helps a lot</font><font color="#CCCCCC"> so</font>

570
00:23:32,780 --> 00:23:35,840
<font color="#CCCCCC">now we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to go through a longer</font>

571
00:23:34,310 --> 00:23:37,370
<font color="#E5E5E5">video here and this one's kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> cool</font>

572
00:23:35,840 --> 00:23:39,350
because I'm going<font color="#E5E5E5"> to dive in everything</font>

573
00:23:37,370 --> 00:23:42,949
of how you inspect what's going on on

574
00:23:39,350 --> 00:23:45,560
the local staff<font color="#CCCCCC"> changing execution flow</font>

575
00:23:42,950 --> 00:23:47,780
<font color="#E5E5E5">and this comes from really interesting a</font>

576
00:23:45,560 --> 00:23:49,389
malware<font color="#E5E5E5"> samples or is heavily obfuscated</font>

577
00:23:47,780 --> 00:23:51,830
and<font color="#CCCCCC"> I had a hard time understanding</font>

578
00:23:49,390 --> 00:23:55,610
statically what was going on<font color="#E5E5E5"> and I'll</font>

579
00:23:51,830 --> 00:24:01,040
kind of walk<font color="#E5E5E5"> through all that here</font><font color="#CCCCCC"> see</font>

580
00:23:55,610 --> 00:24:05,149
<font color="#E5E5E5">play so this is a tutorial how to do the</font>

581
00:24:01,040 --> 00:24:06,889
dynamics about<font color="#E5E5E5"> dignified approach</font><font color="#CCCCCC"> first</font>

582
00:24:05,150 --> 00:24:12,140
<font color="#E5E5E5">thing you want to do is</font><font color="#CCCCCC"> go to</font><font color="#E5E5E5"> the burger</font>

583
00:24:06,890 --> 00:24:14,800
<font color="#E5E5E5">options set specific options</font><font color="#CCCCCC"> no you show</font>

584
00:24:12,140 --> 00:24:17,120
the back to your<font color="#E5E5E5"> ad</font><font color="#CCCCCC"> 3x</font><font color="#E5E5E5"> equal here</font>

585
00:24:14,800 --> 00:24:20,450
if you're using<font color="#CCCCCC"> multiple devices</font>

586
00:24:17,120 --> 00:24:22,580
specifically make the<font color="#E5E5E5"> filters and we get</font>

587
00:24:20,450 --> 00:24:33,380
to see this information<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> do it</font>

588
00:24:22,580 --> 00:24:34,370
quite simply<font color="#E5E5E5"> by easy the</font><font color="#CCCCCC"> best</font><font color="#E5E5E5"> month this</font>

589
00:24:33,380 --> 00:24:39,410
<font color="#E5E5E5">is the particular</font>

590
00:24:34,370 --> 00:24:43,100
officialized<font color="#CCCCCC"> to</font><font color="#E5E5E5"> serialize annually</font><font color="#CCCCCC"> will</font>

591
00:24:39,410 --> 00:24:49,960
see something<font color="#CCCCCC"> on -</font><font color="#E5E5E5"> five five five five</font>

592
00:24:43,100 --> 00:24:52,879
<font color="#E5E5E5">five five six this</font><font color="#CCCCCC"> information is also</font>

593
00:24:49,960 --> 00:24:59,500
filled<font color="#E5E5E5"> from</font><font color="#CCCCCC"> using manifests you can just</font>

594
00:24:52,880 --> 00:25:02,360
<font color="#CCCCCC">so the manifest XML</font><font color="#E5E5E5"> file processing car</font>

595
00:24:59,500 --> 00:25:05,510
and<font color="#CCCCCC"> the percent of to be particularly</font>

596
00:25:02,360 --> 00:25:08,270
<font color="#CCCCCC">apk</font><font color="#E5E5E5"> file variety you can</font><font color="#CCCCCC"> also zoom in on</font>

597
00:25:05,510 --> 00:25:11,000
<font color="#CCCCCC">a particular active you</font><font color="#E5E5E5"> know and if you</font>

598
00:25:08,270 --> 00:25:13,550
want man welcome to<font color="#CCCCCC"> is me sherry and</font>

599
00:25:11,000 --> 00:25:15,560
<font color="#CCCCCC">sacraments</font><font color="#E5E5E5"> note that</font><font color="#CCCCCC"> this designer for</font>

600
00:25:13,550 --> 00:25:19,490
launching<font color="#E5E5E5"> they used to belong to a</font>

601
00:25:15,560 --> 00:25:25,419
<font color="#E5E5E5">particular</font><font color="#CCCCCC"> type</font><font color="#E5E5E5"> you can't sort of a</font>

602
00:25:19,490 --> 00:25:25,420
<font color="#CCCCCC">complicated okay</font>

603
00:25:33,730 --> 00:25:39,809
<font color="#E5E5E5">okay ten nine eight</font><font color="#CCCCCC"> the butter couples</font>

604
00:25:53,279 --> 00:26:01,120
<font color="#CCCCCC">must be a sequence I feel I recommend my</font>

605
00:25:57,730 --> 00:26:03,970
life but I will<font color="#CCCCCC"> decide</font><font color="#E5E5E5"> on Syria</font>

606
00:26:01,120 --> 00:26:09,100
this is your local means we'll have<font color="#CCCCCC"> a</font>

607
00:26:03,970 --> 00:26:13,510
your local day hey then yeah well looks

608
00:26:09,100 --> 00:26:15,129
like your screen is oh never<font color="#E5E5E5"> okay sorry</font>

609
00:26:13,510 --> 00:26:29,710
the screen<font color="#E5E5E5"> was frozen there for a second</font>

610
00:26:15,130 --> 00:26:32,799
we couldn't time<font color="#E5E5E5"> we didn't yeah and it</font>

611
00:26:29,710 --> 00:26:36,190
stopped right<font color="#E5E5E5"> on this I've lucas duda</font>

612
00:26:32,799 --> 00:26:38,799
concept<font color="#E5E5E5"> sixty he</font><font color="#CCCCCC"> can and he should met</font>

613
00:26:36,190 --> 00:26:42,909
in the debugger once you have separated

614
00:26:38,799 --> 00:26:46,059
set over and then<font color="#E5E5E5"> I'm not running</font><font color="#CCCCCC"> for</font>

615
00:26:42,909 --> 00:26:48,549
editor functions and<font color="#CCCCCC"> fission</font><font color="#E5E5E5"> process the</font>

616
00:26:46,059 --> 00:26:50,139
<font color="#CCCCCC">Galvez above is particularly didn't see</font>

617
00:26:48,549 --> 00:26:54,389
one of<font color="#E5E5E5"> the new I'm always keep in mind</font>

618
00:26:50,139 --> 00:26:58,539
to increase our website<font color="#CCCCCC"> 6.30 X I mean</font>

619
00:26:54,389 --> 00:27:00,100
<font color="#CCCCCC">extreme pro social and artistic and you</font>

620
00:26:58,539 --> 00:27:03,820
<font color="#E5E5E5">know they need</font><font color="#CCCCCC"> to break them somewhere</font>

621
00:27:00,100 --> 00:27:04,750
else around<font color="#E5E5E5"> the execution so</font><font color="#CCCCCC"> to catch</font>

622
00:27:03,820 --> 00:27:08,350
that<font color="#E5E5E5"> adventure</font>

623
00:27:04,750 --> 00:27:11,620
I'll show you how to<font color="#E5E5E5"> success a some of</font>

624
00:27:08,350 --> 00:27:17,439
this one here if you<font color="#E5E5E5"> Comanche should</font>

625
00:27:11,620 --> 00:27:25,260
<font color="#E5E5E5">matter if I do this step which is a</font>

626
00:27:17,440 --> 00:27:30,990
<font color="#E5E5E5">seven</font><font color="#CCCCCC"> I like second any functions at all</font>

627
00:27:25,260 --> 00:27:35,019
so<font color="#E5E5E5"> writing is</font><font color="#CCCCCC"> break point the Cylon</font>

628
00:27:30,990 --> 00:27:38,970
<font color="#E5E5E5">program and I just using</font><font color="#CCCCCC"> f8 little</font>

629
00:27:35,019 --> 00:27:38,970
stuffing<font color="#CCCCCC"> all those particular values</font>

630
00:27:39,840 --> 00:27:43,459
<font color="#E5E5E5">know</font>

631
00:27:41,210 --> 00:27:45,710
after this line is executed<font color="#E5E5E5"> the change</font>

632
00:27:43,460 --> 00:27:50,300
in color for<font color="#CCCCCC"> discussion because</font><font color="#E5E5E5"> I'm</font>

633
00:27:45,710 --> 00:27:54,680
watching this particular object to

634
00:27:50,300 --> 00:27:58,879
create<font color="#CCCCCC"> a latitude of um I'm</font><font color="#E5E5E5"> just going</font>

635
00:27:54,680 --> 00:28:00,560
to<font color="#E5E5E5"> right click on it to add lunch and</font>

636
00:27:58,880 --> 00:28:05,210
then<font color="#CCCCCC"> these</font><font color="#E5E5E5"> various obstructions you can</font>

637
00:28:00,560 --> 00:28:09,169
do<font color="#E5E5E5"> the</font><font color="#CCCCCC"> fork steps for me</font><font color="#E5E5E5"> as I</font><font color="#CCCCCC"> tested an</font>

638
00:28:05,210 --> 00:28:11,630
object object aspects and then whatever

639
00:28:09,170 --> 00:28:19,520
<font color="#E5E5E5">that particular that is a so do you</font><font color="#CCCCCC"> see</font>

640
00:28:11,630 --> 00:28:21,470
<font color="#CCCCCC">like</font><font color="#E5E5E5"> a sense operated by now watching</font>

641
00:28:19,520 --> 00:28:24,260
certain watch<font color="#CCCCCC"> once real cause about</font>

642
00:28:21,470 --> 00:28:27,920
Isabella<font color="#CCCCCC"> cries for fun exercise</font><font color="#E5E5E5"> in the</font>

643
00:28:24,260 --> 00:28:34,640
facility types<font color="#CCCCCC"> only Ashland really it</font>

644
00:28:27,920 --> 00:28:37,040
does crash to be better<font color="#E5E5E5"> report so not</font>

645
00:28:34,640 --> 00:28:41,000
<font color="#E5E5E5">gonna be happy</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> this is the central</font>

646
00:28:37,040 --> 00:28:43,430
received f7<font color="#E5E5E5"> versus FA if</font><font color="#CCCCCC"> I press f8 I</font>

647
00:28:41,000 --> 00:28:46,520
will step over<font color="#CCCCCC"> to something</font><font color="#E5E5E5"> call and in</font>

648
00:28:43,430 --> 00:28:49,550
deficit aside<font color="#E5E5E5"> the object and I</font>

649
00:28:46,520 --> 00:28:51,889
accidentally the same an<font color="#CCCCCC"> efficient</font><font color="#E5E5E5"> that</font>

650
00:28:49,550 --> 00:28:57,070
in either<font color="#E5E5E5"> the comedies with excessive</font>

651
00:28:51,890 --> 00:28:57,070
<font color="#CCCCCC">Nicola and chemical kinetics are</font><font color="#E5E5E5"> two sub</font>

652
00:28:58,240 --> 00:29:07,730
<font color="#E5E5E5">success function and this is one of</font>

653
00:29:04,940 --> 00:29:10,280
<font color="#E5E5E5">those cases where okay where</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> happen</font>

654
00:29:07,730 --> 00:29:15,260
<font color="#CCCCCC">to notice</font><font color="#E5E5E5"> that the general register with</font>

655
00:29:10,280 --> 00:29:18,200
the<font color="#CCCCCC"> goal ffffff so in this case what I'm</font>

656
00:29:15,260 --> 00:29:20,180
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> want to do is you can't you</font><font color="#CCCCCC"> are</font>

657
00:29:18,200 --> 00:29:25,010
<font color="#CCCCCC">currently on I'm going to discover</font>

658
00:29:20,180 --> 00:29:27,440
<font color="#E5E5E5">continued process and I've</font><font color="#CCCCCC"> stopped on a</font>

659
00:29:25,010 --> 00:29:29,810
<font color="#CCCCCC">break back as it was actually getting</font>

660
00:29:27,440 --> 00:29:34,000
<font color="#E5E5E5">one of the functions I</font><font color="#CCCCCC"> care</font><font color="#E5E5E5"> about so</font>

661
00:29:29,810 --> 00:29:37,730
what<font color="#CCCCCC"> else is easier is before I end</font><font color="#E5E5E5"> up</font>

662
00:29:34,000 --> 00:29:39,890
here<font color="#E5E5E5"> I can click this an association</font><font color="#CCCCCC"> is</font>

663
00:29:37,730 --> 00:29:43,400
<font color="#CCCCCC">an that default like a custom and then</font>

664
00:29:39,890 --> 00:29:48,020
<font color="#CCCCCC">I'll just set up ways and that region</font>

665
00:29:43,400 --> 00:29:51,290
and<font color="#E5E5E5"> that</font><font color="#CCCCCC"> intention also can I look at</font>

666
00:29:48,020 --> 00:29:52,210
<font color="#E5E5E5">this</font><font color="#CCCCCC"> a bit and I'm</font><font color="#E5E5E5"> cooking</font><font color="#CCCCCC"> it and then</font>

667
00:29:51,290 --> 00:29:55,659
do

668
00:29:52,210 --> 00:29:57,610
first point variety you just in<font color="#CCCCCC"> the</font>

669
00:29:55,660 --> 00:30:05,760
<font color="#CCCCCC">event agenda professor selfish</font><font color="#E5E5E5"> shoot</font>

670
00:29:57,610 --> 00:30:05,760
event<font color="#E5E5E5"> step</font><font color="#CCCCCC"> outside of</font><font color="#E5E5E5"> it keep going</font>

671
00:30:21,890 --> 00:30:47,130
when you step over this composition<font color="#CCCCCC"> all</font>

672
00:30:26,309 --> 00:30:50,190
<font color="#E5E5E5">breakfast of all time so this here</font>

673
00:30:47,130 --> 00:30:53,700
<font color="#E5E5E5">another example is calling the</font><font color="#CCCCCC"> day that</font>

674
00:30:50,190 --> 00:30:57,150
<font color="#CCCCCC">use that be method set the</font><font color="#E5E5E5"> list</font><font color="#CCCCCC"> method</font><font color="#E5E5E5"> I</font>

675
00:30:53,700 --> 00:31:01,730
<font color="#E5E5E5">would break inside let's try</font><font color="#CCCCCC"> stepping</font>

676
00:30:57,150 --> 00:31:04,110
<font color="#CCCCCC">into I got</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> time out</font>

677
00:31:01,730 --> 00:31:07,669
so in this case<font color="#E5E5E5"> I have to turn this</font>

678
00:31:04,110 --> 00:31:07,668
process<font color="#CCCCCC"> to start</font>

679
00:31:23,630 --> 00:31:40,890
so I'm<font color="#E5E5E5"> doing is I want to get that</font><font color="#CCCCCC"> - for</font>

680
00:31:38,940 --> 00:31:43,620
anything

681
00:31:40,890 --> 00:31:46,830
last time when I stepped into<font color="#E5E5E5"> I didn't</font>

682
00:31:43,620 --> 00:31:51,419
know it's about<font color="#E5E5E5"> the other side</font><font color="#CCCCCC"> of time</font>

683
00:31:46,830 --> 00:31:53,850
so I'm just going<font color="#E5E5E5"> to do the another</font>

684
00:31:51,420 --> 00:32:00,000
breakpoint set within the something like

685
00:31:53,850 --> 00:32:01,919
it so what<font color="#CCCCCC"> I'll be doing is the</font><font color="#E5E5E5"> color is</font>

686
00:32:00,000 --> 00:32:09,480
to be<font color="#CCCCCC"> process which</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> and stop in</font>

687
00:32:01,920 --> 00:32:12,420
Africa so saying she<font color="#E5E5E5"> would time the</font>

688
00:32:09,480 --> 00:32:15,480
<font color="#E5E5E5">whole waiting for the that I'm going to</font>

689
00:32:12,420 --> 00:32:20,150
now<font color="#CCCCCC"> so</font><font color="#E5E5E5"> another</font><font color="#CCCCCC"> person will decide down</font>

690
00:32:15,480 --> 00:32:20,150
<font color="#E5E5E5">on the side and see if ethics is issued</font>

691
00:32:50,680 --> 00:32:56,050
<font color="#E5E5E5">now things you learn this stuff</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

692
00:32:52,900 --> 00:33:04,440
<font color="#CCCCCC">time function</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can do that until</font>

693
00:32:56,050 --> 00:33:04,440
<font color="#CCCCCC">return trying to pick up a defense</font>

694
00:33:18,140 --> 00:33:30,799
okay second<font color="#E5E5E5"> everything</font><font color="#CCCCCC"> all the system</font>

695
00:33:20,600 --> 00:33:31,480
starts<font color="#E5E5E5"> now intruder broke and we stopped</font>

696
00:33:30,799 --> 00:33:36,230
it

697
00:33:31,480 --> 00:33:38,750
so this<font color="#E5E5E5"> was</font><font color="#CCCCCC"> JD's</font><font color="#E5E5E5"> new signups playing</font>

698
00:33:36,230 --> 00:33:41,179
around with setting up<font color="#E5E5E5"> right length I do</font>

699
00:33:38,750 --> 00:33:45,190
that<font color="#CCCCCC"> right so if you're still</font><font color="#E5E5E5"> interested</font>

700
00:33:41,179 --> 00:33:45,190
<font color="#E5E5E5">in further I should</font><font color="#CCCCCC"> give values back</font>

701
00:34:01,320 --> 00:34:06,000
so this particular<font color="#CCCCCC"> item on diet see</font>

702
00:34:04,140 --> 00:34:11,060
there's a continuous call<font color="#E5E5E5"> description</font>

703
00:34:06,000 --> 00:34:14,550
function right here<font color="#E5E5E5"> it's easy method and</font>

704
00:34:11,060 --> 00:34:16,320
the result of this<font color="#E5E5E5"> equation is then</font>

705
00:34:14,550 --> 00:34:18,900
<font color="#CCCCCC">returned and then sort and this</font><font color="#E5E5E5"> is</font>

706
00:34:16,320 --> 00:34:21,380
inside<font color="#CCCCCC"> there today and I've</font><font color="#E5E5E5"> had to spend</font>

707
00:34:18,900 --> 00:34:24,620
<font color="#E5E5E5">on pecan tree and decrepit oddities so</font>

708
00:34:21,380 --> 00:34:27,630
if I step into this function<font color="#CCCCCC"> here</font>

709
00:34:24,620 --> 00:34:30,150
they're all medical things<font color="#CCCCCC"> event is a</font>

710
00:34:27,630 --> 00:34:35,400
system in<font color="#E5E5E5"> conservative values yes but</font>

711
00:34:30,150 --> 00:34:37,290
I'm a simple<font color="#E5E5E5"> overall</font><font color="#CCCCCC"> net how in the</font>

712
00:34:35,400 --> 00:34:40,160
<font color="#CCCCCC">washi</font><font color="#E5E5E5"> my lower right</font><font color="#CCCCCC"> hand corner values</font>

713
00:34:37,290 --> 00:34:40,159
<font color="#CCCCCC">of changing the world</font>

714
00:35:04,350 --> 00:35:09,220
cool so that<font color="#E5E5E5"> example is kind of</font>

715
00:35:07,300 --> 00:35:10,870
interesting<font color="#CCCCCC"> because one I think</font><font color="#E5E5E5"> it's one</font>

716
00:35:09,220 --> 00:35:12,759
of<font color="#CCCCCC"> the harder debug examples does they</font>

717
00:35:10,870 --> 00:35:14,920
show all the<font color="#E5E5E5"> ways the bugger can fail</font>

718
00:35:12,760 --> 00:35:17,650
and all the kind of<font color="#E5E5E5"> like gotchas that I</font>

719
00:35:14,920 --> 00:35:19,480
never found a lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> tutorials so in</font>

720
00:35:17,650 --> 00:35:21,550
this<font color="#CCCCCC"> method here with I ended up finding</font>

721
00:35:19,480 --> 00:35:23,230
<font color="#E5E5E5">a place where</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> you're doing</font>

722
00:35:21,550 --> 00:35:24,820
<font color="#E5E5E5">some decryption and you're returning</font>

723
00:35:23,230 --> 00:35:28,090
that value back<font color="#CCCCCC"> and once you identify</font>

724
00:35:24,820 --> 00:35:29,680
where that<font color="#E5E5E5"> is in a mobile binary you</font>

725
00:35:28,090 --> 00:35:31,360
find that kind<font color="#E5E5E5"> of sweet</font><font color="#CCCCCC"> spot where you</font>

726
00:35:29,680 --> 00:35:33,279
<font color="#CCCCCC">can set your breakpoints doesn't crash</font>

727
00:35:31,360 --> 00:35:34,930
<font color="#E5E5E5">everything you can just trim really</font>

728
00:35:33,280 --> 00:35:36,940
<font color="#E5E5E5">iterate through that and then like</font>

729
00:35:34,930 --> 00:35:38,620
decrypt all your values and just<font color="#E5E5E5"> comment</font>

730
00:35:36,940 --> 00:35:39,820
and then<font color="#E5E5E5"> they're right and that's</font>

731
00:35:38,620 --> 00:35:41,799
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> because your decrypted</font>

732
00:35:39,820 --> 00:35:44,710
values<font color="#E5E5E5"> could</font><font color="#CCCCCC"> be like the key to like a</font>

733
00:35:41,800 --> 00:35:48,550
<font color="#E5E5E5">sentence a file or an API call even you</font>

734
00:35:44,710 --> 00:35:49,930
can hammer away at<font color="#E5E5E5"> a web endpoint so now</font>

735
00:35:48,550 --> 00:35:52,300
<font color="#CCCCCC">that we</font><font color="#E5E5E5"> know how to do that dynamically</font>

736
00:35:49,930 --> 00:35:56,109
<font color="#E5E5E5">right I'm also going to look at how to</font>

737
00:35:52,300 --> 00:35:57,940
patch<font color="#CCCCCC"> some of these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> to okay so</font>

738
00:35:56,110 --> 00:36:00,610
patching the<font color="#E5E5E5"> app so my goal</font><font color="#CCCCCC"> on this one</font>

739
00:35:57,940 --> 00:36:03,550
here is<font color="#E5E5E5"> to make the dalvik less scary</font>

740
00:36:00,610 --> 00:36:06,130
<font color="#E5E5E5">right you really only need a small</font>

741
00:36:03,550 --> 00:36:07,870
understanding<font color="#E5E5E5"> of the assembly</font><font color="#CCCCCC"> we're</font>

742
00:36:06,130 --> 00:36:09,640
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> go through</font><font color="#CCCCCC"> about four different</font>

743
00:36:07,870 --> 00:36:12,400
things<font color="#E5E5E5"> here what</font><font color="#CCCCCC"> know operation means</font>

744
00:36:09,640 --> 00:36:16,660
<font color="#E5E5E5">remove</font><font color="#CCCCCC"> object</font><font color="#E5E5E5"> return and then how you</font>

745
00:36:12,400 --> 00:36:19,390
<font color="#E5E5E5">invoke methods so say we have</font><font color="#CCCCCC"> a route</font>

746
00:36:16,660 --> 00:36:21,190
detection somewhere<font color="#E5E5E5"> as from</font><font color="#CCCCCC"> earlier in</font>

747
00:36:19,390 --> 00:36:24,640
<font color="#E5E5E5">this talk I</font><font color="#CCCCCC"> crept with</font><font color="#E5E5E5"> the arc flag</font>

748
00:36:21,190 --> 00:36:27,550
<font color="#CCCCCC">slash</font><font color="#E5E5E5"> bin su and I find a bunch of</font>

749
00:36:24,640 --> 00:36:30,640
<font color="#E5E5E5">classes this loyalty</font><font color="#CCCCCC"> security util</font>

750
00:36:27,550 --> 00:36:32,430
device<font color="#CCCCCC"> utils and security</font><font color="#E5E5E5"> util begin I'm</font>

751
00:36:30,640 --> 00:36:35,920
going<font color="#CCCCCC"> to go to that place</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the code</font>

752
00:36:32,430 --> 00:36:38,589
this one is a company<font color="#CCCCCC"> called</font><font color="#E5E5E5"> is device</font>

753
00:36:35,920 --> 00:36:40,540
rooted method and on your last<font color="#CCCCCC"> eye of</font>

754
00:36:38,590 --> 00:36:42,460
the assembly<font color="#E5E5E5"> and then you're right I</font>

755
00:36:40,540 --> 00:36:44,350
have the Java<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a tool called Jeff</font>

756
00:36:42,460 --> 00:36:46,360
you're just<font color="#CCCCCC"> learning this highly</font>

757
00:36:44,350 --> 00:36:49,750
recommend Jeff that you can do side<font color="#E5E5E5"> by</font>

758
00:36:46,360 --> 00:36:54,580
side and it<font color="#CCCCCC"> has a debugger</font><font color="#E5E5E5"> like the</font><font color="#CCCCCC"> Ida</font>

759
00:36:49,750 --> 00:36:57,190
<font color="#CCCCCC">Pro example I just</font><font color="#E5E5E5"> gave you so first</font>

760
00:36:54,580 --> 00:36:59,920
<font color="#E5E5E5">part on the left hand side when this guy</font>

761
00:36:57,190 --> 00:37:02,200
starts<font color="#CCCCCC"> it's moving this value</font><font color="#E5E5E5"> into this</font>

762
00:36:59,920 --> 00:37:06,880
constant variable<font color="#E5E5E5"> so just worry about</font>

763
00:37:02,200 --> 00:37:09,609
<font color="#CCCCCC">these two in V 1 and</font><font color="#E5E5E5"> V 0 the value</font><font color="#CCCCCC"> of 1</font>

764
00:37:06,880 --> 00:37:13,840
is moved as a<font color="#E5E5E5"> variable V 1 the value of</font>

765
00:37:09,610 --> 00:37:15,370
0 is moved into V<font color="#CCCCCC"> 0</font><font color="#E5E5E5"> this mess</font>

766
00:37:13,840 --> 00:37:18,460
is returning<font color="#E5E5E5"> a boolean value</font><font color="#CCCCCC"> true or</font>

767
00:37:15,370 --> 00:37:20,259
false<font color="#E5E5E5"> so depending on the logic and a</font>

768
00:37:18,460 --> 00:37:23,440
little method<font color="#E5E5E5"> it's either going to</font>

769
00:37:20,260 --> 00:37:25,630
return the marital v1 which means true

770
00:37:23,440 --> 00:37:28,390
or the variable V 0 which means false

771
00:37:25,630 --> 00:37:30,160
true the value<font color="#CCCCCC"> want here even though the</font>

772
00:37:28,390 --> 00:37:33,910
device is named like<font color="#E5E5E5"> is device root is</font>

773
00:37:30,160 --> 00:37:35,710
true mean it's<font color="#E5E5E5"> not rooted now we're</font>

774
00:37:33,910 --> 00:37:38,799
going<font color="#E5E5E5"> to look at the actual checks the</font>

775
00:37:35,710 --> 00:37:40,720
conditional values here right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font>

776
00:37:38,800 --> 00:37:43,180
same area<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the left and the right</font>

777
00:37:40,720 --> 00:37:46,660
means the same thing in<font color="#E5E5E5"> the code right</font>

778
00:37:43,180 --> 00:37:48,759
that if<font color="#CCCCCC"> v2 equals equals 0</font><font color="#E5E5E5"> and return 0</font>

779
00:37:46,660 --> 00:37:53,410
<font color="#E5E5E5">same thing</font><font color="#CCCCCC"> as everything on the left</font>

780
00:37:48,760 --> 00:37:55,090
here<font color="#CCCCCC"> how</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> works is</font><font color="#E5E5E5"> it essentially</font>

781
00:37:53,410 --> 00:37:57,250
<font color="#E5E5E5">has a list of string that's going</font><font color="#CCCCCC"> to be</font>

782
00:37:55,090 --> 00:38:00,370
<font color="#E5E5E5">looking for on the local disk</font><font color="#CCCCCC"> right and</font>

783
00:37:57,250 --> 00:38:03,670
if those<font color="#CCCCCC"> are there right it's going</font><font color="#E5E5E5"> to</font>

784
00:38:00,370 --> 00:38:05,710
set a value v2 is equal to 0 and as v2

785
00:38:03,670 --> 00:38:08,080
is equal<font color="#CCCCCC"> 0 is going</font><font color="#E5E5E5"> to end the function</font>

786
00:38:05,710 --> 00:38:13,960
<font color="#E5E5E5">early and say hey hey something's false</font>

787
00:38:08,080 --> 00:38:16,569
<font color="#E5E5E5">this device is rooted now here is that</font>

788
00:38:13,960 --> 00:38:19,570
same<font color="#E5E5E5"> comparison in the actual dalvik</font>

789
00:38:16,570 --> 00:38:22,450
disassembly<font color="#E5E5E5"> it's saying if equal</font><font color="#CCCCCC"> to 0</font>

790
00:38:19,570 --> 00:38:25,030
value<font color="#E5E5E5"> V</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> if that's true</font>

791
00:38:22,450 --> 00:38:27,520
go to condition<font color="#E5E5E5"> AAA which is then</font><font color="#CCCCCC"> return</font>

792
00:38:25,030 --> 00:38:30,130
right<font color="#E5E5E5"> so that second line in the</font><font color="#CCCCCC"> middle</font>

793
00:38:27,520 --> 00:38:32,740
<font color="#E5E5E5">the move that only if it thinks the</font>

794
00:38:30,130 --> 00:38:35,770
device is<font color="#E5E5E5"> not rooted right so we want to</font>

795
00:38:32,740 --> 00:38:37,899
get that<font color="#E5E5E5"> return value so it's pretty</font>

796
00:38:35,770 --> 00:38:39,970
<font color="#CCCCCC">easy</font><font color="#E5E5E5"> to do this</font><font color="#CCCCCC"> all right</font><font color="#E5E5E5"> so on the left</font>

797
00:38:37,900 --> 00:38:43,690
of the<font color="#CCCCCC"> original code</font><font color="#E5E5E5"> it says hey is this</font>

798
00:38:39,970 --> 00:38:45,819
equal to<font color="#CCCCCC"> 0</font><font color="#E5E5E5"> all right it is go down</font><font color="#CCCCCC"> to</font>

799
00:38:43,690 --> 00:38:46,630
that condition<font color="#E5E5E5"> v1 exit</font><font color="#CCCCCC"> early your</font>

800
00:38:45,820 --> 00:38:50,890
<font color="#CCCCCC">phone's</font><font color="#E5E5E5"> rooted</font>

801
00:38:46,630 --> 00:38:53,830
if it's not equal<font color="#E5E5E5"> to 0 move</font><font color="#CCCCCC"> v1 into v-0</font>

802
00:38:50,890 --> 00:38:56,470
<font color="#CCCCCC">its makes that equal</font><font color="#E5E5E5"> to true right and</font>

803
00:38:53,830 --> 00:38:58,840
then return<font color="#E5E5E5"> so we could do this a few</font>

804
00:38:56,470 --> 00:39:00,339
<font color="#E5E5E5">ways you can just write no</font><font color="#CCCCCC"> op</font><font color="#E5E5E5"> literally</font>

805
00:38:58,840 --> 00:39:02,470
like the<font color="#CCCCCC"> Li that's just right no I mean</font>

806
00:39:00,340 --> 00:39:04,420
no operation and that<font color="#CCCCCC"> way there's no</font>

807
00:39:02,470 --> 00:39:07,240
check<font color="#E5E5E5"> and you end up in the move which</font>

808
00:39:04,420 --> 00:39:08,830
returns true or the other you could

809
00:39:07,240 --> 00:39:11,830
there's other ways you<font color="#E5E5E5"> can do it but I</font>

810
00:39:08,830 --> 00:39:15,040
<font color="#E5E5E5">think that being this one then you</font>

811
00:39:11,830 --> 00:39:16,630
rebuild the app with apktool<font color="#CCCCCC"> B and then</font>

812
00:39:15,040 --> 00:39:19,060
<font color="#E5E5E5">it'll be you'll have an unsigned app in</font>

813
00:39:16,630 --> 00:39:22,420
the<font color="#CCCCCC"> slash</font><font color="#E5E5E5"> dist directory and you got to</font>

814
00:39:19,060 --> 00:39:25,000
sign it with key<font color="#E5E5E5"> tool</font><font color="#CCCCCC"> super</font><font color="#E5E5E5"> easy just</font>

815
00:39:22,420 --> 00:39:26,510
<font color="#E5E5E5">copy/paste this in there you have a</font>

816
00:39:25,000 --> 00:39:30,320
private peen

817
00:39:26,510 --> 00:39:32,119
and you're going to sign<font color="#CCCCCC"> it</font><font color="#E5E5E5"> so signing</font>

818
00:39:30,320 --> 00:39:34,490
it<font color="#E5E5E5"> it's with the</font><font color="#CCCCCC"> hpk signer tool that's</font>

819
00:39:32,119 --> 00:39:36,530
usually included with the<font color="#E5E5E5"> Android studio</font>

820
00:39:34,490 --> 00:39:38,810
I found out actually the<font color="#E5E5E5"> most recent one</font>

821
00:39:36,530 --> 00:39:42,950
forgot it<font color="#E5E5E5"> so actually</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> go that link</font>

822
00:39:38,810 --> 00:39:43,340
on<font color="#E5E5E5"> the bottom</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> get it and that's</font>

823
00:39:42,950 --> 00:39:45,200
it

824
00:39:43,340 --> 00:39:46,940
so<font color="#E5E5E5"> let's do a little</font><font color="#CCCCCC"> bit more</font>

825
00:39:45,200 --> 00:39:49,868
complicated example I think<font color="#E5E5E5"> is the last</font>

826
00:39:46,940 --> 00:39:53,240
one<font color="#E5E5E5"> a little time for here and this is a</font>

827
00:39:49,869 --> 00:39:55,520
device rooted method<font color="#E5E5E5"> so what this is</font>

828
00:39:53,240 --> 00:39:57,200
<font color="#CCCCCC">doing again</font><font color="#E5E5E5"> the code on the left is the</font>

829
00:39:55,520 --> 00:40:00,109
same as the code on the<font color="#CCCCCC"> right</font><font color="#E5E5E5"> it's</font>

830
00:39:57,200 --> 00:40:03,439
calling this device util that is device

831
00:40:00,109 --> 00:40:05,509
rooted method right and then if that

832
00:40:03,440 --> 00:40:09,380
<font color="#CCCCCC">conditions met it's going to kill its</font>

833
00:40:05,510 --> 00:40:11,300
<font color="#CCCCCC">process right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> what we got</font><font color="#E5E5E5"> to do is</font>

834
00:40:09,380 --> 00:40:13,369
essentially<font color="#E5E5E5"> know all of this or delete</font>

835
00:40:11,300 --> 00:40:14,990
all this because we want this method

836
00:40:13,369 --> 00:40:17,119
doesn't return anything<font color="#E5E5E5"> right it</font>

837
00:40:14,990 --> 00:40:20,118
basically does a check if it's rooted

838
00:40:17,119 --> 00:40:22,220
kills my process<font color="#CCCCCC"> so if it</font><font color="#E5E5E5"> just returns</font>

839
00:40:20,119 --> 00:40:25,640
<font color="#E5E5E5">nothing we're fine</font>

840
00:40:22,220 --> 00:40:27,049
right so easiest way to doing this same

841
00:40:25,640 --> 00:40:29,290
<font color="#CCCCCC">thing so here is</font><font color="#E5E5E5"> it what it looks like</font>

842
00:40:27,050 --> 00:40:31,609
in the counter of<font color="#E5E5E5"> the dalvik assembly</font>

843
00:40:29,290 --> 00:40:34,250
<font color="#CCCCCC">we're going to</font><font color="#E5E5E5"> see a call to is device</font>

844
00:40:31,609 --> 00:40:36,410
rooted based on the result of<font color="#CCCCCC"> that it's</font>

845
00:40:34,250 --> 00:40:39,080
either<font color="#E5E5E5"> going to call the get the process</font>

846
00:40:36,410 --> 00:40:40,670
and kill process<font color="#E5E5E5"> so super</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> you can</font>

847
00:40:39,080 --> 00:40:43,250
either<font color="#E5E5E5"> delete all this and just</font><font color="#CCCCCC"> return</font>

848
00:40:40,670 --> 00:40:45,109
void<font color="#CCCCCC"> or you can do a</font><font color="#E5E5E5"> combination do no</font>

849
00:40:43,250 --> 00:40:48,340
often no op no op then return void

850
00:40:45,109 --> 00:40:51,020
<font color="#E5E5E5">doesn't really matter in this case</font>

851
00:40:48,340 --> 00:40:53,660
<font color="#CCCCCC">should</font><font color="#E5E5E5"> be noted though when you sign an</font>

852
00:40:51,020 --> 00:40:55,400
app with<font color="#CCCCCC"> your own</font><font color="#E5E5E5"> finer it's going to</font>

853
00:40:53,660 --> 00:40:58,819
have a different<font color="#E5E5E5"> signer</font>

854
00:40:55,400 --> 00:41:01,730
I didn't<font color="#CCCCCC"> signature some devs do check</font>

855
00:40:58,820 --> 00:41:03,619
<font color="#E5E5E5">this but again they're checking it we</font>

856
00:41:01,730 --> 00:41:05,810
can act out the same check right so<font color="#E5E5E5"> this</font>

857
00:41:03,619 --> 00:41:07,640
one is<font color="#E5E5E5"> boolean method B and says you</font>

858
00:41:05,810 --> 00:41:09,710
know if it's not<font color="#E5E5E5"> equal</font><font color="#CCCCCC"> to this</font>

859
00:41:07,640 --> 00:41:11,359
particular value then<font color="#CCCCCC"> go to this</font><font color="#E5E5E5"> point</font>

860
00:41:09,710 --> 00:41:15,800
<font color="#E5E5E5">again you could just know off that out</font>

861
00:41:11,359 --> 00:41:17,480
so again trivial check for learning

862
00:41:15,800 --> 00:41:25,010
dalvik there's some great resources

863
00:41:17,480 --> 00:41:26,570
right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> and yeah so any questions let</font>

864
00:41:25,010 --> 00:41:29,030
<font color="#CCCCCC">me</font><font color="#E5E5E5"> now I'm going to exit</font><font color="#CCCCCC"> out full screen</font>

865
00:41:26,570 --> 00:41:32,030
in a second here<font color="#E5E5E5"> my twitter is at been</font>

866
00:41:29,030 --> 00:41:34,400
<font color="#E5E5E5">wrong email then at cyber merchants the</font>

867
00:41:32,030 --> 00:41:37,050
death works fine and yeah<font color="#CCCCCC"> i</font><font color="#E5E5E5"> guess</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> have</font>

868
00:41:34,400 --> 00:41:41,310
a<font color="#CCCCCC"> few minutes</font><font color="#E5E5E5"> left</font><font color="#CCCCCC"> here and</font>

869
00:41:37,050 --> 00:41:46,590
I'll take questions<font color="#E5E5E5"> let me go to the</font>

870
00:41:41,310 --> 00:41:50,279
<font color="#CCCCCC">zoom yeah I think</font><font color="#E5E5E5"> where we might</font><font color="#CCCCCC"> have</font>

871
00:41:46,590 --> 00:41:52,200
time<font color="#E5E5E5"> for about one question</font><font color="#CCCCCC"> or so</font><font color="#E5E5E5"> I know</font>

872
00:41:50,280 --> 00:41:55,170
that<font color="#E5E5E5"> early on in</font><font color="#CCCCCC"> your presentation</font>

873
00:41:52,200 --> 00:41:57,990
someone asked if you<font color="#E5E5E5"> suggest using an</font>

874
00:41:55,170 --> 00:42:00,330
emulator or<font color="#E5E5E5"> i'ma</font><font color="#CCCCCC"> start</font><font color="#E5E5E5"> with an emulator</font>

875
00:41:57,990 --> 00:42:02,310
<font color="#E5E5E5">honestly so like but if there's</font>

876
00:42:00,330 --> 00:42:04,290
financial<font color="#E5E5E5"> concerns</font><font color="#CCCCCC"> start with an</font>

877
00:42:02,310 --> 00:42:08,400
emulator<font color="#CCCCCC"> and then it's the apps</font>

878
00:42:04,290 --> 00:42:12,120
detecting it<font color="#CCCCCC"> then</font><font color="#E5E5E5"> going and you</font><font color="#CCCCCC"> know get</font>

879
00:42:08,400 --> 00:42:13,740
a cheap $50 Amazon phone<font color="#CCCCCC"> Tim look at</font>

880
00:42:12,120 --> 00:42:15,180
Tim's<font color="#E5E5E5"> get hobby is a nice</font><font color="#CCCCCC"> route for a</font>

881
00:42:13,740 --> 00:42:19,290
lot of<font color="#CCCCCC"> those you know</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> are often on</font>

882
00:42:15,180 --> 00:42:21,029
sale<font color="#CCCCCC"> I would say it</font><font color="#E5E5E5"> was the exception of</font>

883
00:42:19,290 --> 00:42:26,250
maybe some<font color="#E5E5E5"> of your</font><font color="#CCCCCC"> banking apps and</font>

884
00:42:21,030 --> 00:42:28,620
you're really<font color="#E5E5E5"> popular apps you know</font><font color="#CCCCCC"> yeah</font>

885
00:42:26,250 --> 00:42:31,710
<font color="#CCCCCC">I think</font><font color="#E5E5E5"> you'll be</font><font color="#CCCCCC"> really a good to look</font>

886
00:42:28,620 --> 00:42:35,580
at<font color="#CCCCCC"> I do the mo you can</font><font color="#E5E5E5"> also do an eddy</font>

887
00:42:31,710 --> 00:42:37,890
x86 one<font color="#CCCCCC"> that's pretty</font><font color="#E5E5E5"> fast</font><font color="#CCCCCC"> the nice</font>

888
00:42:35,580 --> 00:42:39,720
<font color="#CCCCCC">thing about the phones is you I don't</font>

889
00:42:37,890 --> 00:42:41,460
<font color="#E5E5E5">want to get really crazy with things so</font>

890
00:42:39,720 --> 00:42:43,529
you can<font color="#E5E5E5"> get</font><font color="#CCCCCC"> a Nexus phone and</font><font color="#E5E5E5"> actually</font>

891
00:42:41,460 --> 00:42:46,230
<font color="#E5E5E5">change part of the Android source code</font>

892
00:42:43,530 --> 00:42:48,300
<font color="#E5E5E5">to make things easier for you that's</font><font color="#CCCCCC"> the</font>

893
00:42:46,230 --> 00:42:51,570
kind of way more advanced kind<font color="#E5E5E5"> of</font>

894
00:42:48,300 --> 00:42:54,950
techniques out there<font color="#CCCCCC"> cool so I think</font>

895
00:42:51,570 --> 00:42:57,960
that all the time we had for this

896
00:42:54,950 --> 00:43:03,270
presentation of<font color="#CCCCCC"> Bin's but</font><font color="#E5E5E5"> will have been</font>

897
00:42:57,960 --> 00:43:04,110
back again in an hour<font color="#E5E5E5"> - yeah yes well</font>

898
00:43:03,270 --> 00:43:07,009
<font color="#CCCCCC">thanks I wrong</font>

899
00:43:04,110 --> 00:43:07,010
yeah Thank<font color="#CCCCCC"> You Ven</font>

