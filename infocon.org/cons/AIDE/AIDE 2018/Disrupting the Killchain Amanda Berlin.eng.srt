1
00:00:00,709 --> 00:00:07,798
<font color="#E5E5E5">hmm</font><font color="#CCCCCC"> right sweet hello</font><font color="#E5E5E5"> everybody</font>

2
00:00:05,160 --> 00:00:10,290
Amanda<font color="#CCCCCC"> this is gonna be this is</font>

3
00:00:07,799 --> 00:00:11,670
<font color="#E5E5E5">technically like five</font><font color="#CCCCCC"> hours of</font><font color="#E5E5E5"> material</font>

4
00:00:10,290 --> 00:00:13,110
so I'm gonna try<font color="#E5E5E5"> and go</font><font color="#CCCCCC"> through it</font><font color="#E5E5E5"> in 50</font>

5
00:00:11,670 --> 00:00:16,230
<font color="#E5E5E5">minutes</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> can all get</font><font color="#CCCCCC"> out of here</font>

6
00:00:13,110 --> 00:00:18,029
for lunch<font color="#CCCCCC"> so this is my talk called</font>

7
00:00:16,230 --> 00:00:20,580
disrupting this<font color="#E5E5E5"> disrupting the kill</font>

8
00:00:18,029 --> 00:00:22,350
chain<font color="#E5E5E5"> I'm gonna go through the kill</font>

9
00:00:20,580 --> 00:00:25,919
chain<font color="#E5E5E5"> like none of you really know what</font>

10
00:00:22,350 --> 00:00:30,029
it is<font color="#CCCCCC"> or have ever heard of it before it</font>

11
00:00:25,920 --> 00:00:32,489
<font color="#E5E5E5">really won't affect</font><font color="#CCCCCC"> it if you know it or</font>

12
00:00:30,029 --> 00:00:35,070
not<font color="#E5E5E5"> so we'll just start at the beginning</font>

13
00:00:32,488 --> 00:00:38,309
<font color="#E5E5E5">of the seven steps so I worked at as</font>

14
00:00:35,070 --> 00:00:40,530
MSSP for several years now providing

15
00:00:38,309 --> 00:00:44,760
like<font color="#E5E5E5"> logging and monitoring alerting</font>

16
00:00:40,530 --> 00:00:46,800
services to anywhere<font color="#E5E5E5"> from</font><font color="#CCCCCC"> like twenty</font>

17
00:00:44,760 --> 00:00:49,649
<font color="#CCCCCC">thirty person companies all the way up</font>

18
00:00:46,800 --> 00:00:51,899
to like<font color="#E5E5E5"> fortune 50 companies</font><font color="#CCCCCC"> they all</font>

19
00:00:49,649 --> 00:00:52,770
<font color="#CCCCCC">have different needs they all have</font>

20
00:00:51,899 --> 00:00:56,670
different<font color="#CCCCCC"> things</font><font color="#E5E5E5"> that they want to</font>

21
00:00:52,770 --> 00:00:59,370
monitor<font color="#CCCCCC"> for but a lot of</font><font color="#E5E5E5"> the same kind</font>

22
00:00:56,670 --> 00:01:01,590
of overtone and many times like the

23
00:00:59,370 --> 00:01:05,250
<font color="#E5E5E5">c-level executives always bring up this</font>

24
00:01:01,590 --> 00:01:11,100
<font color="#E5E5E5">kill chain and it's just a buzzword</font><font color="#CCCCCC"> that</font>

25
00:01:05,250 --> 00:01:12,750
they've always<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use so what the</font>

26
00:01:11,100 --> 00:01:14,339
intrusion kill chain is it's sometimes

27
00:01:12,750 --> 00:01:17,070
called<font color="#E5E5E5"> the cyber kill chain a lot of</font>

28
00:01:14,340 --> 00:01:20,310
people make fun of it and InfoSec<font color="#E5E5E5"> but</font>

29
00:01:17,070 --> 00:01:22,679
what it the actual definition is a model

30
00:01:20,310 --> 00:01:24,659
<font color="#E5E5E5">for actual</font><font color="#CCCCCC"> intelligence</font><font color="#E5E5E5"> when defenders</font>

31
00:01:22,680 --> 00:01:27,360
<font color="#CCCCCC">align</font><font color="#E5E5E5"> enterprise defensive capabilities</font>

32
00:01:24,659 --> 00:01:30,990
which is what I do<font color="#E5E5E5"> is all the defense</font>

33
00:01:27,360 --> 00:01:33,030
side<font color="#CCCCCC"> for the</font><font color="#E5E5E5"> specific purposes and abotu</font>

34
00:01:30,990 --> 00:01:35,970
adversary undertakes to<font color="#E5E5E5"> target that</font>

35
00:01:33,030 --> 00:01:38,400
enterprise<font color="#E5E5E5"> so targeted attacks</font><font color="#CCCCCC"> apts</font>

36
00:01:35,970 --> 00:01:40,759
whatever you want to call<font color="#E5E5E5"> them</font><font color="#CCCCCC"> it's</font>

37
00:01:38,400 --> 00:01:43,170
composed of several different<font color="#CCCCCC"> steps and</font>

38
00:01:40,759 --> 00:01:45,960
Lockheed Martin<font color="#CCCCCC"> is the one that</font><font color="#E5E5E5"> kind of</font>

39
00:01:43,170 --> 00:01:50,159
came<font color="#CCCCCC"> up with these seven</font><font color="#E5E5E5"> steps first one</font>

40
00:01:45,960 --> 00:01:52,408
is recon so it's when an attacker will

41
00:01:50,159 --> 00:01:54,780
research that<font color="#CCCCCC"> OSINT</font><font color="#E5E5E5"> that Matt was</font>

42
00:01:52,409 --> 00:01:58,369
<font color="#CCCCCC">talking about</font><font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> they'll select</font>

43
00:01:54,780 --> 00:02:01,170
<font color="#E5E5E5">targets crawl internet websites LinkedIn</font>

44
00:01:58,369 --> 00:02:04,140
looking for email addresses looking for

45
00:02:01,170 --> 00:02:05,250
any<font color="#E5E5E5"> kind of open source intelligence and</font>

46
00:02:04,140 --> 00:02:07,920
<font color="#E5E5E5">that's if they're</font><font color="#CCCCCC"> coming from the</font>

47
00:02:05,250 --> 00:02:09,090
outside<font color="#CCCCCC"> right</font><font color="#E5E5E5"> you can also do recon if</font>

48
00:02:07,920 --> 00:02:12,140
they're already on the<font color="#E5E5E5"> inside</font><font color="#CCCCCC"> of the</font>

49
00:02:09,090 --> 00:02:13,330
network<font color="#E5E5E5"> at the beginning of the attack</font>

50
00:02:12,140 --> 00:02:17,170
<font color="#CCCCCC">seconds</font>

51
00:02:13,330 --> 00:02:20,200
is weaponization that's an automation<font color="#E5E5E5"> of</font>

52
00:02:17,170 --> 00:02:24,339
<font color="#E5E5E5">some kind of tool so</font><font color="#CCCCCC"> that's when they</font>

53
00:02:20,200 --> 00:02:27,160
put<font color="#CCCCCC"> a Trojan in like PDF or</font><font color="#E5E5E5"> a Microsoft</font>

54
00:02:24,340 --> 00:02:29,380
<font color="#E5E5E5">Office document or create a</font><font color="#CCCCCC"> macro that</font>

55
00:02:27,160 --> 00:02:32,350
<font color="#E5E5E5">kind of stuff</font><font color="#CCCCCC"> and actually create that</font>

56
00:02:29,380 --> 00:02:34,060
weaponize deliverable third<font color="#E5E5E5"> step is</font>

57
00:02:32,350 --> 00:02:37,890
delivery<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> when they</font><font color="#CCCCCC"> actually</font>

58
00:02:34,060 --> 00:02:39,940
transmit that<font color="#E5E5E5"> deliverable to the target</font>

59
00:02:37,890 --> 00:02:43,029
<font color="#CCCCCC">usually in the form</font><font color="#E5E5E5"> of like drive-by</font>

60
00:02:39,940 --> 00:02:44,829
downloads<font color="#E5E5E5"> or like the USB</font><font color="#CCCCCC"> Drive</font><font color="#E5E5E5"> that</font>

61
00:02:43,030 --> 00:02:47,760
they you know<font color="#CCCCCC"> leave</font><font color="#E5E5E5"> in the parking lot</font>

62
00:02:44,830 --> 00:02:52,210
all that kind of stuff<font color="#CCCCCC"> email attachments</font>

63
00:02:47,760 --> 00:02:54,760
number<font color="#E5E5E5"> four is exploitation phase</font><font color="#CCCCCC"> so</font>

64
00:02:52,210 --> 00:02:58,750
after the payloads delivered that

65
00:02:54,760 --> 00:03:00,459
actually<font color="#E5E5E5"> export the exploit code is run</font>

66
00:02:58,750 --> 00:03:02,770
<font color="#E5E5E5">on the machine</font>

67
00:03:00,460 --> 00:03:05,440
the only other target application the

68
00:03:02,770 --> 00:03:09,660
<font color="#CCCCCC">user themselves</font><font color="#E5E5E5"> and execute execute the</font>

69
00:03:05,440 --> 00:03:13,270
code<font color="#E5E5E5"> Step</font><font color="#CCCCCC"> five is installation</font>

70
00:03:09,660 --> 00:03:15,370
<font color="#E5E5E5">installation</font><font color="#CCCCCC"> is of some sort of tool</font>

71
00:03:13,270 --> 00:03:18,489
that's<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> allow them to maintain</font>

72
00:03:15,370 --> 00:03:24,010
persistence in<font color="#E5E5E5"> the environment so it</font>

73
00:03:18,489 --> 00:03:25,840
could<font color="#CCCCCC"> be like a client-server type set</font>

74
00:03:24,010 --> 00:03:28,540
<font color="#CCCCCC">up that they have but the</font><font color="#E5E5E5"> installation</font>

75
00:03:25,840 --> 00:03:32,440
is of number six which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> coming in and</font>

76
00:03:28,540 --> 00:03:34,480
<font color="#E5E5E5">control</font><font color="#CCCCCC"> so if an attacker is attacking</font>

77
00:03:32,440 --> 00:03:36,010
<font color="#CCCCCC">you they don't want to just</font><font color="#E5E5E5"> have one</font>

78
00:03:34,480 --> 00:03:38,560
<font color="#E5E5E5">foothold on the inside</font><font color="#CCCCCC"> of the</font>

79
00:03:36,010 --> 00:03:40,720
environment they want<font color="#E5E5E5"> to have as many as</font>

80
00:03:38,560 --> 00:03:43,239
<font color="#CCCCCC">possible</font><font color="#E5E5E5"> because if you find one</font><font color="#CCCCCC"> and</font>

81
00:03:40,720 --> 00:03:44,080
shut it down<font color="#E5E5E5"> they don't want to have to</font>

82
00:03:43,239 --> 00:03:47,220
start<font color="#E5E5E5"> all over again</font>

83
00:03:44,080 --> 00:03:50,140
so command and control is<font color="#E5E5E5"> going to be</font>

84
00:03:47,220 --> 00:03:52,359
kind<font color="#CCCCCC"> of an automated</font><font color="#E5E5E5"> proceed process</font>

85
00:03:50,140 --> 00:03:54,720
that they have<font color="#CCCCCC"> some</font><font color="#E5E5E5"> kind of server on</font>

86
00:03:52,360 --> 00:03:57,430
the outside and<font color="#E5E5E5"> their clients are now</font>

87
00:03:54,720 --> 00:04:02,350
potentially<font color="#CCCCCC"> the inside of the network</font><font color="#E5E5E5"> on</font>

88
00:03:57,430 --> 00:04:04,780
desktops whatever and<font color="#E5E5E5"> seven is actions</font>

89
00:04:02,350 --> 00:04:06,700
on objectives<font color="#CCCCCC"> that's the end that's</font>

90
00:04:04,780 --> 00:04:08,800
where they've gotten what<font color="#E5E5E5"> they've needed</font>

91
00:04:06,700 --> 00:04:12,280
<font color="#CCCCCC">whether it's data corruption</font>

92
00:04:08,800 --> 00:04:15,459
exfiltration<font color="#CCCCCC"> they can use the endpoint</font>

93
00:04:12,280 --> 00:04:18,040
<font color="#E5E5E5">as like some kind of botnet or hop to do</font>

94
00:04:15,459 --> 00:04:22,019
whatever they want<font color="#E5E5E5"> to</font><font color="#CCCCCC"> and maybe</font><font color="#E5E5E5"> start</font>

95
00:04:18,040 --> 00:04:22,019
from step one and go all<font color="#CCCCCC"> over again</font>

96
00:04:22,790 --> 00:04:29,940
so what I like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do with my customers</font>

97
00:04:27,420 --> 00:04:32,610
has come up with common<font color="#E5E5E5"> threats that</font>

98
00:04:29,940 --> 00:04:35,160
they worry about<font color="#CCCCCC"> one of my most common</font>

99
00:04:32,610 --> 00:04:38,730
questions<font color="#CCCCCC"> that I asked out ask</font><font color="#E5E5E5"> like our</font>

100
00:04:35,160 --> 00:04:42,390
customers is what do<font color="#E5E5E5"> you worry about at</font>

101
00:04:38,730 --> 00:04:44,480
<font color="#CCCCCC">night you know whether it</font><font color="#E5E5E5"> be from your</font>

102
00:04:42,390 --> 00:04:48,479
intellectual property being stolen<font color="#E5E5E5"> or</font>

103
00:04:44,480 --> 00:04:49,500
maybe it's like<font color="#E5E5E5"> a customer database</font>

104
00:04:48,480 --> 00:04:51,720
being<font color="#E5E5E5"> breached</font>

105
00:04:49,500 --> 00:04:54,810
whatever<font color="#E5E5E5"> would really really really</font>

106
00:04:51,720 --> 00:04:56,790
screw them<font color="#CCCCCC"> over if it got in the pans of</font>

107
00:04:54,810 --> 00:04:59,970
somebody malicious<font color="#E5E5E5"> that's what you need</font>

108
00:04:56,790 --> 00:05:02,760
<font color="#E5E5E5">to worry about so some of the things</font>

109
00:04:59,970 --> 00:05:06,960
<font color="#CCCCCC">that are top</font><font color="#E5E5E5"> of their mind</font><font color="#CCCCCC"> so according</font>

110
00:05:02,760 --> 00:05:08,490
to be last year's Verizon<font color="#CCCCCC"> dbi</font><font color="#E5E5E5"> are 88% of</font>

111
00:05:06,960 --> 00:05:13,010
breaches<font color="#E5E5E5"> fall into</font><font color="#CCCCCC"> nine different</font>

112
00:05:08,490 --> 00:05:15,480
categories cyber espionage is number one

113
00:05:13,010 --> 00:05:19,830
<font color="#CCCCCC">usually this is like state-sponsored</font>

114
00:05:15,480 --> 00:05:22,280
actors and our<font color="#E5E5E5"> target the targets are</font>

115
00:05:19,830 --> 00:05:24,750
larger companies or companies<font color="#E5E5E5"> less</font>

116
00:05:22,280 --> 00:05:26,599
political leanings or something like

117
00:05:24,750 --> 00:05:31,620
<font color="#E5E5E5">that</font>

118
00:05:26,600 --> 00:05:34,950
second is<font color="#CCCCCC"> dough stacks this</font><font color="#E5E5E5"> 98% of dos</font>

119
00:05:31,620 --> 00:05:38,490
attacks happen towards<font color="#CCCCCC"> very large</font>

120
00:05:34,950 --> 00:05:41,159
enterprises<font color="#CCCCCC"> threes</font><font color="#E5E5E5"> crimeware which is</font>

121
00:05:38,490 --> 00:05:45,000
ransomware<font color="#E5E5E5"> malware all that kind of</font>

122
00:05:41,160 --> 00:05:47,790
<font color="#CCCCCC">stuff it's climbed from the 22nd most</font>

123
00:05:45,000 --> 00:05:51,180
common of malware<font color="#E5E5E5"> up to the</font><font color="#CCCCCC"> fifth in</font>

124
00:05:47,790 --> 00:05:52,919
less than three years<font color="#E5E5E5"> and really this</font><font color="#CCCCCC"> is</font>

125
00:05:51,180 --> 00:05:56,220
a lot of what's<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the top of people's</font>

126
00:05:52,919 --> 00:05:59,340
<font color="#E5E5E5">minds I've had so many so many people</font>

127
00:05:56,220 --> 00:06:02,250
get ransomware and so many things I

128
00:05:59,340 --> 00:06:05,210
could<font color="#CCCCCC"> have done to</font><font color="#E5E5E5"> prevent</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and it's</font>

129
00:06:02,250 --> 00:06:08,640
definitely<font color="#CCCCCC"> something that happens a lot</font>

130
00:06:05,210 --> 00:06:11,310
for<font color="#E5E5E5"> is insider privilege and misuse so</font>

131
00:06:08,640 --> 00:06:15,570
like a rogue admin that kind of stuff

132
00:06:11,310 --> 00:06:21,260
and then go for what people<font color="#CCCCCC"> yeah people</font>

133
00:06:15,570 --> 00:06:24,030
<font color="#E5E5E5">like all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you back there</font><font color="#CCCCCC"> yeah and</font><font color="#E5E5E5"> then</font>

134
00:06:21,260 --> 00:06:27,630
the rest of<font color="#E5E5E5"> them are lower in priority</font>

135
00:06:24,030 --> 00:06:32,820
usually so<font color="#E5E5E5"> web app attacks miscellaneous</font>

136
00:06:27,630 --> 00:06:35,400
errors the kind<font color="#E5E5E5"> of one like the Amazon</font>

137
00:06:32,820 --> 00:06:36,030
<font color="#E5E5E5">miss type that brought down you know all</font>

138
00:06:35,400 --> 00:06:39,440
<font color="#CCCCCC">of</font><font color="#E5E5E5"> their</font>

139
00:06:36,030 --> 00:06:39,440
us three buckets on the East Coast

140
00:06:40,670 --> 00:06:44,580
<font color="#CCCCCC">skimmers POS intrusion and</font><font color="#E5E5E5"> then</font>

141
00:06:43,110 --> 00:06:50,610
everything else<font color="#CCCCCC"> falls into a smaller</font>

142
00:06:44,580 --> 00:06:52,859
percentage of<font color="#E5E5E5"> attack so what I wanted to</font>

143
00:06:50,610 --> 00:06:55,290
do is break<font color="#CCCCCC"> down the common threats that</font>

144
00:06:52,860 --> 00:06:58,860
my customers were worried about<font color="#CCCCCC"> into</font>

145
00:06:55,290 --> 00:07:01,560
things they could actually do<font color="#E5E5E5"> that cyber</font>

146
00:06:58,860 --> 00:07:03,510
kill chain intrusion kill chain people

147
00:07:01,560 --> 00:07:05,340
<font color="#E5E5E5">like to talk about it a lot of time and</font>

148
00:07:03,510 --> 00:07:08,670
have<font color="#E5E5E5"> absolutely no idea what</font><font color="#CCCCCC"> to do to</font>

149
00:07:05,340 --> 00:07:10,469
defend<font color="#E5E5E5"> it each step</font><font color="#CCCCCC"> so what I did</font><font color="#E5E5E5"> is I</font>

150
00:07:08,670 --> 00:07:13,680
<font color="#E5E5E5">actually made this gigantic spreadsheet</font>

151
00:07:10,470 --> 00:07:17,370
that<font color="#E5E5E5"> has</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> ransomware for a tab and</font>

152
00:07:13,680 --> 00:07:20,190
it has insider threat as a tab and it

153
00:07:17,370 --> 00:07:22,890
just breaks<font color="#CCCCCC"> down</font><font color="#E5E5E5"> kind of what happens or</font>

154
00:07:20,190 --> 00:07:25,560
what<font color="#E5E5E5"> can happen at each stage of the</font>

155
00:07:22,890 --> 00:07:26,700
kill chain<font color="#CCCCCC"> and not</font><font color="#E5E5E5"> only what you can do</font>

156
00:07:25,560 --> 00:07:28,590
<font color="#CCCCCC">let's see here</font>

157
00:07:26,700 --> 00:07:30,210
so the malicious action<font color="#E5E5E5"> so what happens</font>

158
00:07:28,590 --> 00:07:32,520
at each stage<font color="#CCCCCC"> what you can do as a</font>

159
00:07:30,210 --> 00:07:34,140
defensive mitigation a lot of times

160
00:07:32,520 --> 00:07:38,039
there aren't<font color="#E5E5E5"> defensive</font><font color="#CCCCCC"> mitigations that</font>

161
00:07:34,140 --> 00:07:40,590
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can do but there are other things</font>

162
00:07:38,040 --> 00:07:42,510
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can do right how easy it is to</font>

163
00:07:40,590 --> 00:07:46,640
<font color="#E5E5E5">deploy those defensive mitigations</font><font color="#CCCCCC"> and</font>

164
00:07:42,510 --> 00:07:49,050
then monitoring<font color="#E5E5E5"> and specific alerting</font>

165
00:07:46,640 --> 00:07:51,180
<font color="#CCCCCC">mmm the three things</font><font color="#E5E5E5"> that I'm probably</font>

166
00:07:49,050 --> 00:07:54,930
<font color="#CCCCCC">the best out of the defense</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

167
00:07:51,180 --> 00:07:56,820
<font color="#E5E5E5">monitoring in the alerting</font><font color="#CCCCCC"> it was harder</font>

168
00:07:54,930 --> 00:07:59,460
for<font color="#E5E5E5"> me</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> kind of learn</font><font color="#CCCCCC"> what happens at</font>

169
00:07:56,820 --> 00:08:01,050
each stage<font color="#E5E5E5"> of the attack but that's why</font>

170
00:07:59,460 --> 00:08:04,200
I have a bunch of red<font color="#CCCCCC"> teamer friends</font>

171
00:08:01,050 --> 00:08:09,300
because they can<font color="#CCCCCC"> actually tell me</font><font color="#E5E5E5"> you</font>

172
00:08:04,200 --> 00:08:11,159
know if I want to get this data<font color="#E5E5E5"> where do</font>

173
00:08:09,300 --> 00:08:14,010
you start<font color="#E5E5E5"> and then I would work</font><font color="#CCCCCC"> with</font>

174
00:08:11,160 --> 00:08:17,010
them<font color="#E5E5E5"> and find out okay well you do that</font>

175
00:08:14,010 --> 00:08:19,920
<font color="#CCCCCC">but I can do this</font><font color="#E5E5E5"> to block you and then</font>

176
00:08:17,010 --> 00:08:22,620
if that<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> work you do</font><font color="#E5E5E5"> this and I</font>

177
00:08:19,920 --> 00:08:25,230
can do this to alert on that<font color="#E5E5E5"> and we just</font>

178
00:08:22,620 --> 00:08:27,000
kind of went<font color="#CCCCCC"> back and</font><font color="#E5E5E5"> forth to figure</font>

179
00:08:25,230 --> 00:08:28,290
out you know<font color="#E5E5E5"> how ransomware works and</font>

180
00:08:27,000 --> 00:08:30,150
all that kind of stuff<font color="#CCCCCC"> so we could</font><font color="#E5E5E5"> kind</font>

181
00:08:28,290 --> 00:08:33,000
<font color="#E5E5E5">of build this framework</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> people can</font>

182
00:08:30,150 --> 00:08:34,620
just<font color="#CCCCCC"> in kind</font><font color="#E5E5E5"> of like plain English terms</font>

183
00:08:33,000 --> 00:08:37,159
look<font color="#E5E5E5"> at and be able to actually do</font>

184
00:08:34,620 --> 00:08:37,159
something<font color="#CCCCCC"> with</font>

185
00:08:37,999 --> 00:08:44,309
<font color="#E5E5E5">okay um</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> can probably show</font><font color="#CCCCCC"> you the</font>

186
00:08:41,519 --> 00:08:47,790
spreadsheet ma'am<font color="#CCCCCC"> well wait</font><font color="#E5E5E5"> till you in</font>

187
00:08:44,309 --> 00:08:49,589
for them so<font color="#E5E5E5"> no two networks are</font><font color="#CCCCCC"> the same</font>

188
00:08:47,790 --> 00:08:50,939
<font color="#E5E5E5">whether you've</font><font color="#CCCCCC"> been an attacker or</font>

189
00:08:49,589 --> 00:08:52,410
defender<font color="#CCCCCC"> or whether you've been studying</font>

190
00:08:50,939 --> 00:08:55,049
<font color="#E5E5E5">at whether you've</font><font color="#CCCCCC"> been setting</font><font color="#E5E5E5"> it up</font>

191
00:08:52,410 --> 00:08:57,988
<font color="#E5E5E5">I've never come across two networks that</font>

192
00:08:55,049 --> 00:09:01,619
are<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> you defend them differently</font>

193
00:08:57,989 --> 00:09:04,799
you attack them differently<font color="#E5E5E5"> and this is</font>

194
00:09:01,619 --> 00:09:05,939
the<font color="#E5E5E5"> Microsoft version of the attack kill</font>

195
00:09:04,799 --> 00:09:08,819
chain they did these little

196
00:09:05,939 --> 00:09:10,949
<font color="#E5E5E5">loop-de-loops instead because a lot</font><font color="#CCCCCC"> of</font>

197
00:09:08,819 --> 00:09:13,949
attacks don't actually fit into the

198
00:09:10,949 --> 00:09:15,809
<font color="#CCCCCC">lockheed-martin</font><font color="#E5E5E5"> kill chain because it's</font>

199
00:09:13,949 --> 00:09:18,779
not an<font color="#E5E5E5"> attack isn't</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> straightforward</font>

200
00:09:15,809 --> 00:09:20,368
<font color="#E5E5E5">seven step program some of</font><font color="#CCCCCC"> them do fit</font>

201
00:09:18,779 --> 00:09:24,329
into it and you can<font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> shoehorn</font>

202
00:09:20,369 --> 00:09:26,069
them in and kind of figure out<font color="#E5E5E5"> okay</font>

203
00:09:24,329 --> 00:09:28,349
maybe this one only<font color="#CCCCCC"> has five steps or</font>

204
00:09:26,069 --> 00:09:30,868
maybe this<font color="#E5E5E5"> one has nine and you know</font>

205
00:09:28,350 --> 00:09:32,339
break it<font color="#CCCCCC"> out like that then the</font>

206
00:09:30,869 --> 00:09:35,220
Microsoft instead did<font color="#E5E5E5"> this little</font>

207
00:09:32,339 --> 00:09:38,610
<font color="#CCCCCC">loop-d-loop where they have this low</font>

208
00:09:35,220 --> 00:09:41,519
privilege escalation<font color="#CCCCCC"> lateral movement</font>

209
00:09:38,610 --> 00:09:44,309
cycle and then they have<font color="#CCCCCC"> like the more</font>

210
00:09:41,519 --> 00:09:47,189
evil<font color="#CCCCCC"> rollercoaster with the little devil</font>

211
00:09:44,309 --> 00:09:49,980
guy which<font color="#CCCCCC"> is interesting</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> this is</font>

212
00:09:47,189 --> 00:09:52,439
high privilege<font color="#E5E5E5"> now the last one they say</font>

213
00:09:49,980 --> 00:09:54,509
this<font color="#E5E5E5"> could take they say this could</font><font color="#CCCCCC"> take</font>

214
00:09:52,439 --> 00:09:55,079
months<font color="#E5E5E5"> but in all actuality it could</font>

215
00:09:54,509 --> 00:09:57,839
take months

216
00:09:55,079 --> 00:10:00,029
it could take hours<font color="#CCCCCC"> just depending on</font>

217
00:09:57,839 --> 00:10:01,619
<font color="#E5E5E5">the target same thing with the high</font>

218
00:10:00,029 --> 00:10:03,929
<font color="#E5E5E5">privilege when they're already on the</font>

219
00:10:01,619 --> 00:10:05,999
<font color="#E5E5E5">inside</font><font color="#CCCCCC"> of your network it says it could</font>

220
00:10:03,929 --> 00:10:11,040
<font color="#E5E5E5">take</font><font color="#CCCCCC"> weeks but honestly I've seen it</font>

221
00:10:05,999 --> 00:10:12,720
take 60 seconds<font color="#E5E5E5"> it definitely the time</font>

222
00:10:11,040 --> 00:10:14,610
<font color="#E5E5E5">doesn't</font><font color="#CCCCCC"> really matter but it's</font><font color="#E5E5E5"> just the</font>

223
00:10:12,720 --> 00:10:19,709
<font color="#CCCCCC">idea that</font><font color="#E5E5E5"> it's more of a cyclical type</font>

224
00:10:14,610 --> 00:10:22,410
of attack a lot<font color="#E5E5E5"> of times so what I</font><font color="#CCCCCC"> did</font>

225
00:10:19,709 --> 00:10:24,508
was I broke this talk<font color="#E5E5E5"> slash training</font>

226
00:10:22,410 --> 00:10:27,600
down into<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> four different</font>

227
00:10:24,509 --> 00:10:28,740
use cases<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> one's ransomware and</font>

228
00:10:27,600 --> 00:10:31,169
I know I'll be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to get through that</font>

229
00:10:28,740 --> 00:10:34,249
in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> next 45</font><font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> so we'll try and</font>

230
00:10:31,169 --> 00:10:34,249
<font color="#CCCCCC">get through the</font><font color="#E5E5E5"> other ones too</font>

231
00:10:35,129 --> 00:10:42,350
and as we go<font color="#CCCCCC"> through all seven steps</font>

232
00:10:37,290 --> 00:10:45,118
<font color="#E5E5E5">like I said it might not all fit so</font>

233
00:10:42,350 --> 00:10:47,369
recon<font color="#E5E5E5"> right recons the first step in the</font>

234
00:10:45,119 --> 00:10:49,499
kill chain and then these are my you

235
00:10:47,369 --> 00:10:51,059
know<font color="#E5E5E5"> five different things</font><font color="#CCCCCC"> that I</font><font color="#E5E5E5"> broke</font>

236
00:10:49,499 --> 00:10:52,619
it down<font color="#E5E5E5"> into I def</font>

237
00:10:51,059 --> 00:10:54,299
we don't have a slide for<font color="#E5E5E5"> every single</font>

238
00:10:52,619 --> 00:10:56,279
one<font color="#E5E5E5"> of them because</font><font color="#CCCCCC"> some of them are</font>

239
00:10:54,299 --> 00:11:00,659
boring and some of them you can't really

240
00:10:56,279 --> 00:11:03,029
show in a<font color="#E5E5E5"> in a presentation at all so I</font>

241
00:11:00,659 --> 00:11:04,859
kind of<font color="#E5E5E5"> just skip around</font><font color="#CCCCCC"> just know</font><font color="#E5E5E5"> that</font>

242
00:11:03,029 --> 00:11:08,759
that's the step that we're on and that's

243
00:11:04,859 --> 00:11:11,129
<font color="#E5E5E5">the part that I broke it</font><font color="#CCCCCC"> down into so</font>

244
00:11:08,759 --> 00:11:12,899
even before any kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> incident is</font>

245
00:11:11,129 --> 00:11:15,539
happening a lot of people think<font color="#E5E5E5"> that you</font>

246
00:11:12,899 --> 00:11:19,109
can't really do a<font color="#CCCCCC"> whole lot</font><font color="#E5E5E5"> at this</font>

247
00:11:15,539 --> 00:11:22,429
<font color="#E5E5E5">recon step so the most malicious action</font>

248
00:11:19,109 --> 00:11:25,649
is them looking for<font color="#E5E5E5"> email addresses</font>

249
00:11:22,429 --> 00:11:28,829
technologies used<font color="#E5E5E5"> they can create like a</font>

250
00:11:25,649 --> 00:11:31,589
dossier<font color="#E5E5E5"> on your organization or specific</font>

251
00:11:28,829 --> 00:11:35,608
people<font color="#E5E5E5"> to</font><font color="#CCCCCC"> try and</font><font color="#E5E5E5"> attack them and create</font>

252
00:11:31,589 --> 00:11:39,119
more advanced targeted attacks<font color="#CCCCCC"> these</font><font color="#E5E5E5"> are</font>

253
00:11:35,609 --> 00:11:43,109
a couple<font color="#E5E5E5"> of examples</font><font color="#CCCCCC"> that I had used</font><font color="#E5E5E5"> I</font>

254
00:11:39,119 --> 00:11:45,359
participated in the<font color="#E5E5E5"> DEF CON</font><font color="#CCCCCC"> se CTF which</font>

255
00:11:43,109 --> 00:11:48,179
is<font color="#E5E5E5"> super fun if anybody goes</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> DEFCON I</font>

256
00:11:45,359 --> 00:11:51,419
highly recommend<font color="#CCCCCC"> not only participating</font>

257
00:11:48,179 --> 00:11:54,509
but going<font color="#E5E5E5"> in and watching them run this</font>

258
00:11:51,419 --> 00:11:56,728
they have one now at Derby con<font color="#CCCCCC"> 2</font><font color="#E5E5E5"> but</font>

259
00:11:54,509 --> 00:12:00,419
what they do<font color="#E5E5E5"> is you sign up for it</font><font color="#CCCCCC"> they</font>

260
00:11:56,729 --> 00:12:02,999
give you a company<font color="#E5E5E5"> so my company that I</font>

261
00:12:00,419 --> 00:12:04,739
got was frontier<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> basically find</font>

262
00:12:02,999 --> 00:12:07,049
all the<font color="#CCCCCC"> oesn't you can about</font><font color="#E5E5E5"> this</font>

263
00:12:04,739 --> 00:12:09,059
company<font color="#E5E5E5"> and they give you a list of like</font>

264
00:12:07,049 --> 00:12:11,968
<font color="#E5E5E5">20 different</font><font color="#CCCCCC"> things that you need to</font>

265
00:12:09,059 --> 00:12:14,539
<font color="#E5E5E5">find and create</font><font color="#CCCCCC"> a report</font><font color="#E5E5E5"> on this was</font>

266
00:12:11,969 --> 00:12:19,439
some<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> stuff that I</font><font color="#E5E5E5"> found so like</font>

267
00:12:14,539 --> 00:12:21,899
plain HTTP logins to their firewalls

268
00:12:19,439 --> 00:12:26,488
<font color="#E5E5E5">that's the f5 could be a load balancer</font>

269
00:12:21,899 --> 00:12:29,099
could be a firewall<font color="#E5E5E5"> their organizational</font>

270
00:12:26,489 --> 00:12:31,019
like employee logins<font color="#CCCCCC"> and then this</font>

271
00:12:29,099 --> 00:12:33,899
picture of this poor guy<font color="#E5E5E5"> has been on</font>

272
00:12:31,019 --> 00:12:38,039
<font color="#E5E5E5">lots of slides of mine but this was on</font>

273
00:12:33,899 --> 00:12:40,559
the frontiers<font color="#CCCCCC"> Facebook page and you</font>

274
00:12:38,039 --> 00:12:43,289
could plainly see<font color="#CCCCCC"> the type and model of</font>

275
00:12:40,559 --> 00:12:46,409
computer they were using<font color="#E5E5E5"> the fact that</font>

276
00:12:43,289 --> 00:12:48,989
<font color="#E5E5E5">you had you know Windows 7 with Adobe</font>

277
00:12:46,409 --> 00:12:51,659
pulled up<font color="#E5E5E5"> and what browser he was using</font>

278
00:12:48,989 --> 00:12:53,849
and there were a couple<font color="#CCCCCC"> other pictures</font>

279
00:12:51,659 --> 00:12:58,649
of like their<font color="#CCCCCC"> badges and stuff like that</font>

280
00:12:53,849 --> 00:13:00,479
all on there and play<font color="#E5E5E5"> Facebook page so</font>

281
00:12:58,649 --> 00:13:03,269
what can<font color="#E5E5E5"> you do as a defense of</font>

282
00:13:00,479 --> 00:13:04,920
mitigation<font color="#CCCCCC"> a lot of people say</font><font color="#E5E5E5"> nothing</font>

283
00:13:03,269 --> 00:13:08,519
<font color="#E5E5E5">but really there is</font><font color="#CCCCCC"> a lot</font>

284
00:13:04,920 --> 00:13:12,899
<font color="#E5E5E5">you can do to kind of put canary in the</font>

285
00:13:08,519 --> 00:13:16,200
coalmine<font color="#CCCCCC"> type stuff out there if you</font>

286
00:13:12,899 --> 00:13:17,940
control<font color="#CCCCCC"> anything to do with</font><font color="#E5E5E5"> you know</font>

287
00:13:16,200 --> 00:13:20,850
that part of<font color="#E5E5E5"> your organization you</font><font color="#CCCCCC"> can</font>

288
00:13:17,940 --> 00:13:23,730
create like<font color="#CCCCCC"> a fake</font><font color="#E5E5E5"> LinkedIn profile you</font>

289
00:13:20,850 --> 00:13:27,000
<font color="#E5E5E5">can create fake emails</font><font color="#CCCCCC"> there's a website</font>

290
00:13:23,730 --> 00:13:29,279
called canary tokens that<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> create</font>

291
00:13:27,000 --> 00:13:31,860
tokens for<font color="#E5E5E5"> pretty much anything</font><font color="#CCCCCC"> you can</font>

292
00:13:29,279 --> 00:13:34,410
create and it will alert you<font color="#CCCCCC"> that these</font>

293
00:13:31,860 --> 00:13:37,680
<font color="#E5E5E5">things</font><font color="#CCCCCC"> have been</font><font color="#E5E5E5"> either used or gathered</font>

294
00:13:34,410 --> 00:13:40,620
or exploited or whatever<font color="#E5E5E5"> you can have</font>

295
00:13:37,680 --> 00:13:43,680
like<font color="#CCCCCC"> canary sequel databases or</font>

296
00:13:40,620 --> 00:13:45,839
application servers or really they have

297
00:13:43,680 --> 00:13:49,529
a very large<font color="#CCCCCC"> amount of different things</font>

298
00:13:45,839 --> 00:13:52,589
that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can do on that so now we're</font><font color="#CCCCCC"> on</font>

299
00:13:49,529 --> 00:13:54,779
the<font color="#E5E5E5"> delivery step as we all know most</font>

300
00:13:52,589 --> 00:13:55,470
ransomware<font color="#E5E5E5"> is distributed through means</font>

301
00:13:54,779 --> 00:13:57,949
of<font color="#CCCCCC"> phishing</font>

302
00:13:55,470 --> 00:14:02,760
sometimes targeted sometimes not<font color="#E5E5E5"> or</font>

303
00:13:57,949 --> 00:14:04,139
<font color="#E5E5E5">could be just like a mass email</font><font color="#CCCCCC"> but</font>

304
00:14:02,760 --> 00:14:06,750
there are several defensive<font color="#CCCCCC"> medications</font>

305
00:14:04,139 --> 00:14:08,070
that you<font color="#E5E5E5"> can do at this step one that</font><font color="#CCCCCC"> I</font>

306
00:14:06,750 --> 00:14:09,660
really<font color="#E5E5E5"> highly recommend and I don't</font>

307
00:14:08,070 --> 00:14:12,120
<font color="#E5E5E5">really see</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> whole lot</font><font color="#CCCCCC"> of people</font><font color="#E5E5E5"> do is</font>

308
00:14:09,660 --> 00:14:18,240
assess what types of attachments that

309
00:14:12,120 --> 00:14:20,730
<font color="#E5E5E5">you need or file types yeah file types</font>

310
00:14:18,240 --> 00:14:24,510
<font color="#CCCCCC">that you need in an organization not</font>

311
00:14:20,730 --> 00:14:26,190
everybody needs<font color="#E5E5E5"> to run JavaScript</font><font color="#CCCCCC"> not</font>

312
00:14:24,510 --> 00:14:28,319
every button<font color="#CCCCCC"> you know you might not</font><font color="#E5E5E5"> use</font>

313
00:14:26,190 --> 00:14:30,540
screen savers not everybody<font color="#CCCCCC"> should all</font>

314
00:14:28,320 --> 00:14:32,370
of these are very very<font color="#E5E5E5"> potentially</font>

315
00:14:30,540 --> 00:14:37,199
<font color="#E5E5E5">harmful file types that you</font><font color="#CCCCCC"> can actually</font>

316
00:14:32,370 --> 00:14:40,079
stop<font color="#E5E5E5"> and I have a walkthrough on how to</font>

317
00:14:37,199 --> 00:14:42,899
stop those so there's what I have<font color="#E5E5E5"> five</font>

318
00:14:40,079 --> 00:14:44,790
other<font color="#CCCCCC"> things that you could</font><font color="#E5E5E5"> do you can</font>

319
00:14:42,899 --> 00:14:46,560
implement scanning for macros coming

320
00:14:44,790 --> 00:14:48,810
from the<font color="#E5E5E5"> outside or just block macros</font>

321
00:14:46,560 --> 00:14:51,989
<font color="#E5E5E5">all</font><font color="#CCCCCC"> together</font><font color="#E5E5E5"> and I have a walkthrough on</font>

322
00:14:48,810 --> 00:14:54,390
<font color="#E5E5E5">that too there's things called black</font>

323
00:14:51,990 --> 00:14:57,390
lists and<font color="#CCCCCC"> grey lists that</font><font color="#E5E5E5"> you can</font>

324
00:14:54,390 --> 00:14:59,399
implement for<font color="#E5E5E5"> your mail servers you can</font>

325
00:14:57,390 --> 00:15:01,769
<font color="#E5E5E5">install the idea of trust but verify to</font>

326
00:14:59,399 --> 00:15:03,720
your users because<font color="#E5E5E5"> we all know humans</font>

327
00:15:01,769 --> 00:15:06,480
are<font color="#CCCCCC"> one of the biggest weaknesses</font><font color="#E5E5E5"> and</font>

328
00:15:03,720 --> 00:15:08,940
organization<font color="#E5E5E5"> and do things like ad</font>

329
00:15:06,480 --> 00:15:11,310
blocking blocking of adding extensions

330
00:15:08,940 --> 00:15:12,480
<font color="#CCCCCC">under your</font><font color="#E5E5E5"> browsers</font><font color="#CCCCCC"> there's a lot</font><font color="#E5E5E5"> of</font>

331
00:15:11,310 --> 00:15:14,819
stuff<font color="#CCCCCC"> that you can control on</font><font color="#E5E5E5"> an</font>

332
00:15:12,480 --> 00:15:17,820
<font color="#CCCCCC">endpoint to not have to worry about</font><font color="#E5E5E5"> it</font>

333
00:15:14,819 --> 00:15:20,699
<font color="#E5E5E5">as much so</font>

334
00:15:17,820 --> 00:15:23,850
is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be a walkthrough on how to</font>

335
00:15:20,700 --> 00:15:26,430
change<font color="#E5E5E5"> the default application</font><font color="#CCCCCC"> that</font>

336
00:15:23,850 --> 00:15:29,090
opens malicious files in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> I'm</font>

337
00:15:26,430 --> 00:15:33,239
<font color="#E5E5E5">going to change it so group policy</font>

338
00:15:29,090 --> 00:15:35,220
controls<font color="#CCCCCC"> javascript file</font><font color="#E5E5E5"> and it's</font><font color="#CCCCCC"> going</font>

339
00:15:33,240 --> 00:15:37,350
<font color="#CCCCCC">to</font><font color="#E5E5E5"> open</font><font color="#CCCCCC"> it with paint</font><font color="#E5E5E5"> I think instead of</font>

340
00:15:35,220 --> 00:15:41,280
<font color="#E5E5E5">actually running the potentially</font>

341
00:15:37,350 --> 00:15:43,700
malicious JavaScript code we'll see if

342
00:15:41,280 --> 00:15:43,699
this<font color="#CCCCCC"> works</font>

343
00:15:45,290 --> 00:15:54,599
play is it going<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> can you</font>

344
00:15:48,750 --> 00:15:56,880
<font color="#E5E5E5">actually see it kind of all right so</font>

345
00:15:54,600 --> 00:16:00,000
this<font color="#E5E5E5"> is the deployment deployment image</font>

346
00:15:56,880 --> 00:16:03,510
servicing service manager tool and

347
00:16:00,000 --> 00:16:06,330
<font color="#CCCCCC">windows I'm exporting the default</font>

348
00:16:03,510 --> 00:16:09,630
application<font color="#E5E5E5"> associations on the server</font>

349
00:16:06,330 --> 00:16:14,640
<font color="#E5E5E5">and those actually</font><font color="#CCCCCC"> go into like a plain</font>

350
00:16:09,630 --> 00:16:16,470
XML file<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> can edit this XML file</font>

351
00:16:14,640 --> 00:16:19,080
to<font color="#CCCCCC"> open up any extension with any</font>

352
00:16:16,470 --> 00:16:20,850
program<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> want and we're gonna</font>

353
00:16:19,080 --> 00:16:26,700
<font color="#E5E5E5">actually force</font><font color="#CCCCCC"> the users to</font><font color="#E5E5E5"> open it up</font>

354
00:16:20,850 --> 00:16:29,060
the whatever you<font color="#CCCCCC"> want I can't see what</font>

355
00:16:26,700 --> 00:16:29,060
it's<font color="#E5E5E5"> doing</font>

356
00:16:34,700 --> 00:16:41,090
<font color="#CCCCCC">I think I'm saving it yeah so now</font>

357
00:16:39,770 --> 00:16:45,020
there's a default application is<font color="#E5E5E5"> that</font>

358
00:16:41,090 --> 00:16:46,700
<font color="#E5E5E5">XML and you actually right now</font><font color="#CCCCCC"> it's just</font>

359
00:16:45,020 --> 00:16:52,310
<font color="#CCCCCC">an</font><font color="#E5E5E5"> XML file it hasn't actually done</font>

360
00:16:46,700 --> 00:16:54,740
<font color="#E5E5E5">anything so this is</font><font color="#CCCCCC"> Group Policy where</font>

361
00:16:52,310 --> 00:16:57,619
<font color="#E5E5E5">you can set pretty much all your</font><font color="#CCCCCC"> window</font>

362
00:16:54,740 --> 00:17:05,170
<font color="#E5E5E5">settings that you ever want to set I'm</font>

363
00:16:57,620 --> 00:17:05,170
creating a<font color="#CCCCCC"> new group policy object which</font>

364
00:17:05,980 --> 00:17:12,589
<font color="#E5E5E5">not really super related to this but</font>

365
00:17:08,980 --> 00:17:15,110
<font color="#E5E5E5">there's two different default GPOs that</font>

366
00:17:12,589 --> 00:17:20,329
come with Windows<font color="#E5E5E5"> never edit them just</font>

367
00:17:15,109 --> 00:17:21,589
as a best practice thing so in here<font color="#E5E5E5"> I</font>

368
00:17:20,329 --> 00:17:25,339
<font color="#E5E5E5">think I have that path written down</font>

369
00:17:21,589 --> 00:17:26,990
<font color="#E5E5E5">maybe yeah so computer configuration</font>

370
00:17:25,339 --> 00:17:29,179
policies administrative templates

371
00:17:26,990 --> 00:17:31,100
windows components<font color="#CCCCCC"> file explorer and</font>

372
00:17:29,180 --> 00:17:36,500
<font color="#CCCCCC">then you can actually</font><font color="#E5E5E5"> point</font><font color="#CCCCCC"> to where</font>

373
00:17:31,100 --> 00:17:41,500
this XML file is at<font color="#CCCCCC"> it says set a</font>

374
00:17:36,500 --> 00:17:41,500
default<font color="#E5E5E5"> associations configuration file</font>

375
00:17:43,850 --> 00:17:47,659
and right there it gives<font color="#E5E5E5"> like the</font>

376
00:17:45,680 --> 00:17:53,720
example of what the command is that<font color="#CCCCCC"> you</font>

377
00:17:47,660 --> 00:17:56,000
actually have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> run so we'll enable</font>

378
00:17:53,720 --> 00:17:57,890
<font color="#E5E5E5">that and</font><font color="#CCCCCC"> it kind of tells you you can</font>

379
00:17:56,000 --> 00:18:01,210
point<font color="#E5E5E5"> it to</font><font color="#CCCCCC"> wherever you want but</font><font color="#E5E5E5"> all I</font>

380
00:17:57,890 --> 00:18:01,210
did<font color="#CCCCCC"> was move it to</font><font color="#E5E5E5"> that path</font>

381
00:18:07,179 --> 00:18:15,779
I think I have cool music with this<font color="#CCCCCC"> too</font>

382
00:18:17,789 --> 00:18:27,099
makes it a<font color="#E5E5E5"> little bit more so it's</font>

383
00:18:26,320 --> 00:18:31,389
already<font color="#CCCCCC"> won there</font>

384
00:18:27,099 --> 00:18:34,489
all I did<font color="#CCCCCC"> was</font><font color="#E5E5E5"> paste over top of it</font>

385
00:18:31,390 --> 00:18:34,489
[Music]

386
00:18:34,570 --> 00:18:38,020
there's<font color="#CCCCCC"> anyone</font>

387
00:18:54,420 --> 00:18:59,240
[Music]

388
00:18:56,690 --> 00:19:01,960
<font color="#E5E5E5">I'm going to create a fake malicious</font>

389
00:18:59,240 --> 00:19:01,960
<font color="#CCCCCC">javascript file</font>

390
00:19:06,600 --> 00:19:20,300
[Music]

391
00:19:18,560 --> 00:19:22,120
and you can see it's gonna<font color="#E5E5E5"> open</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> with</font>

392
00:19:20,300 --> 00:19:25,540
paint<font color="#E5E5E5"> instead</font><font color="#CCCCCC"> of the actual Java strip</font>

393
00:19:22,120 --> 00:19:30,679
<font color="#E5E5E5">it thinks it's a bitmap image instead of</font>

394
00:19:25,540 --> 00:19:33,590
the malicious file um<font color="#CCCCCC"> that will</font><font color="#E5E5E5"> only</font>

395
00:19:30,680 --> 00:19:35,210
work when<font color="#E5E5E5"> you do it this way</font><font color="#CCCCCC"> on the</font>

396
00:19:33,590 --> 00:19:37,550
computer that<font color="#E5E5E5"> you put it on or if it's a</font>

397
00:19:35,210 --> 00:19:38,690
domain a domain join computer<font color="#E5E5E5"> right</font>

398
00:19:37,550 --> 00:19:42,110
because it's pulling<font color="#CCCCCC"> all of that</font>

399
00:19:38,690 --> 00:19:44,000
information<font color="#E5E5E5"> from Active Directory so</font>

400
00:19:42,110 --> 00:19:48,050
that's one thing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can do to kind</font>

401
00:19:44,000 --> 00:19:50,750
of block<font color="#E5E5E5"> malicious file types</font><font color="#CCCCCC"> you can</font>

402
00:19:48,050 --> 00:19:53,389
also flag different things<font color="#CCCCCC"> so to to</font>

403
00:19:50,750 --> 00:19:55,970
known things are that<font color="#E5E5E5"> screensaver files</font>

404
00:19:53,390 --> 00:20:00,860
over<font color="#CCCCCC"> 22 megabyte</font><font color="#E5E5E5"> and JavaScript files</font>

405
00:19:55,970 --> 00:20:03,500
over 15 are mostly known to have to be

406
00:20:00,860 --> 00:20:07,280
ransomware files and you<font color="#E5E5E5"> can also block</font>

407
00:20:03,500 --> 00:20:09,650
them<font color="#E5E5E5"> with mail filtering so now we're on</font>

408
00:20:07,280 --> 00:20:11,540
the exploitation<font color="#CCCCCC"> phase the</font><font color="#E5E5E5"> endpoint will</font>

409
00:20:09,650 --> 00:20:13,940
download<font color="#E5E5E5"> that malicious file whatever it</font>

410
00:20:11,540 --> 00:20:15,500
may be<font color="#E5E5E5"> JavaScript Microsoft Word macros</font>

411
00:20:13,940 --> 00:20:16,820
blah blah blah

412
00:20:15,500 --> 00:20:20,480
those can either come from<font color="#E5E5E5"> an attachment</font>

413
00:20:16,820 --> 00:20:22,450
or drive-by download as we've<font color="#E5E5E5"> seen more</font>

414
00:20:20,480 --> 00:20:25,580
<font color="#E5E5E5">recently there's actually been processes</font>

415
00:20:22,450 --> 00:20:28,010
that don't<font color="#E5E5E5"> really need the macro it can</font>

416
00:20:25,580 --> 00:20:29,929
<font color="#E5E5E5">just like word can spawn a process</font>

417
00:20:28,010 --> 00:20:31,190
outside<font color="#E5E5E5"> of itself and there are</font>

418
00:20:29,930 --> 00:20:33,590
different<font color="#E5E5E5"> things that you can do to</font>

419
00:20:31,190 --> 00:20:35,150
block against that but you probably<font color="#E5E5E5"> at</font>

420
00:20:33,590 --> 00:20:38,570
<font color="#CCCCCC">that point you should have an endpoint</font>

421
00:20:35,150 --> 00:20:42,160
<font color="#E5E5E5">solution that says hey my Microsoft Word</font>

422
00:20:38,570 --> 00:20:42,159
document shouldn't be running PowerShell

423
00:20:42,520 --> 00:20:50,650
<font color="#CCCCCC">and we can disable macros via group</font>

424
00:20:45,110 --> 00:20:53,870
policy as well yeah let's see here

425
00:20:50,650 --> 00:20:56,080
there's<font color="#E5E5E5"> different</font><font color="#CCCCCC"> um like admin packs</font>

426
00:20:53,870 --> 00:20:58,969
that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can add</font><font color="#CCCCCC"> to group policy for</font><font color="#E5E5E5"> a</font>

427
00:20:56,080 --> 00:21:00,500
barrage of different things one

428
00:20:58,970 --> 00:21:03,530
specifically<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> always like</font><font color="#CCCCCC"> to add</font>

429
00:21:00,500 --> 00:21:05,000
is<font color="#E5E5E5"> the one for Microsoft Office</font><font color="#CCCCCC"> it will</font>

430
00:21:03,530 --> 00:21:08,060
give you a whole<font color="#E5E5E5"> bunch of security</font>

431
00:21:05,000 --> 00:21:10,040
<font color="#E5E5E5">settings and additional settings for all</font>

432
00:21:08,060 --> 00:21:12,919
of the office suite right<font color="#E5E5E5"> it will give</font>

433
00:21:10,040 --> 00:21:17,409
you Word<font color="#E5E5E5"> Excel PowerPoint all that kind</font>

434
00:21:12,920 --> 00:21:17,410
of<font color="#E5E5E5"> stuff and that's not there by</font><font color="#CCCCCC"> default</font>

435
00:21:17,920 --> 00:21:22,080
so blocking macros

436
00:21:30,990 --> 00:21:38,799
so these are those custom files that you

437
00:21:34,600 --> 00:21:40,570
have<font color="#CCCCCC"> to add to have the correct settings</font>

438
00:21:38,799 --> 00:21:42,660
show up in group policy<font color="#CCCCCC"> for Microsoft</font>

439
00:21:40,570 --> 00:21:42,659
Office

440
00:22:30,840 --> 00:22:35,610
and they show up right there all those

441
00:22:32,460 --> 00:22:37,350
<font color="#E5E5E5">Microsoft</font><font color="#CCCCCC"> whatever's and you</font><font color="#E5E5E5"> can add all</font>

442
00:22:35,610 --> 00:22:41,580
the ones for the<font color="#E5E5E5"> different versions</font><font color="#CCCCCC"> and</font>

443
00:22:37,350 --> 00:22:44,730
different<font color="#CCCCCC"> years and</font><font color="#E5E5E5"> stuff so under word</font>

444
00:22:41,580 --> 00:22:46,019
options there's actually a whole<font color="#CCCCCC"> lot of</font>

445
00:22:44,730 --> 00:22:49,889
different security things that you can

446
00:22:46,019 --> 00:22:53,809
set per<font color="#E5E5E5"> application but it here in file</font>

447
00:22:49,889 --> 00:22:53,809
block<font color="#E5E5E5"> click file block settings</font><font color="#CCCCCC"> yeah</font>

448
00:22:56,710 --> 00:23:05,799
maybe or maybe<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> just showing</font>

449
00:22:59,440 --> 00:23:07,419
different things<font color="#CCCCCC"> oh yeah there</font><font color="#E5E5E5"> we go</font>

450
00:23:05,799 --> 00:23:09,369
block macros from running in office

451
00:23:07,419 --> 00:23:11,529
files from the<font color="#CCCCCC"> internet so you could</font>

452
00:23:09,369 --> 00:23:14,379
totally create and sign your<font color="#CCCCCC"> own office</font>

453
00:23:11,529 --> 00:23:17,320
macros internally<font color="#CCCCCC"> I know a lot of people</font>

454
00:23:14,379 --> 00:23:22,389
actually do<font color="#E5E5E5"> that and still</font><font color="#CCCCCC"> don't have</font>

455
00:23:17,320 --> 00:23:26,379
the set but yeah you<font color="#E5E5E5"> just go through</font><font color="#CCCCCC"> an</font>

456
00:23:22,389 --> 00:23:29,320
enable<font color="#CCCCCC"> app which</font><font color="#E5E5E5"> is very very difficult</font>

457
00:23:26,379 --> 00:23:32,139
to<font color="#E5E5E5"> convince people to do just because</font>

458
00:23:29,320 --> 00:23:35,678
not<font color="#E5E5E5"> only one thing that you can do with</font>

459
00:23:32,139 --> 00:23:37,389
<font color="#E5E5E5">your policy say like your accounting</font>

460
00:23:35,679 --> 00:23:39,610
department<font color="#CCCCCC"> definitely needs to</font><font color="#E5E5E5"> use</font>

461
00:23:37,389 --> 00:23:41,559
macros<font color="#CCCCCC"> in Excel</font><font color="#E5E5E5"> because they work an</font>

462
00:23:39,610 --> 00:23:44,379
<font color="#E5E5E5">excel all the time obviously macros in</font>

463
00:23:41,559 --> 00:23:46,869
Excel make a whole lot of<font color="#CCCCCC"> sense you can</font>

464
00:23:44,379 --> 00:23:50,830
make it so<font color="#E5E5E5"> that</font><font color="#CCCCCC"> specific group</font><font color="#E5E5E5"> of people</font>

465
00:23:46,869 --> 00:23:52,689
<font color="#E5E5E5">can on macros and then you can actually</font>

466
00:23:50,830 --> 00:23:54,668
identify<font color="#CCCCCC"> the people</font><font color="#E5E5E5"> that need to</font><font color="#CCCCCC"> do it</font>

467
00:23:52,690 --> 00:23:55,960
and give them<font color="#E5E5E5"> more training on hey I</font>

468
00:23:54,669 --> 00:23:57,249
probably shouldn't<font color="#E5E5E5"> be downloading this</font>

469
00:23:55,960 --> 00:24:01,629
file from<font color="#E5E5E5"> the internet</font><font color="#CCCCCC"> and running their</font>

470
00:23:57,249 --> 00:24:04,090
macros<font color="#E5E5E5"> um another</font><font color="#CCCCCC"> thing that you can do</font>

471
00:24:01,629 --> 00:24:07,090
is monitor<font color="#CCCCCC"> proxy logs for unexpected</font>

472
00:24:04,090 --> 00:24:09,699
file retrievals<font color="#CCCCCC"> like going to an IP</font>

473
00:24:07,090 --> 00:24:13,418
<font color="#CCCCCC">address and</font><font color="#E5E5E5"> JavaScript files the first</font>

474
00:24:09,700 --> 00:24:15,999
file that they download different<font color="#CCCCCC"> IDs is</font>

475
00:24:13,419 --> 00:24:19,690
have rules for<font color="#CCCCCC"> this kind of stuff as</font>

476
00:24:15,999 --> 00:24:22,840
well this tool<font color="#E5E5E5"> is called floss</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> I</font>

477
00:24:19,690 --> 00:24:25,899
felt less<font color="#E5E5E5"> from the fire I</font><font color="#CCCCCC"> labs</font><font color="#E5E5E5"> it will</font>

478
00:24:22,840 --> 00:24:29,649
actually<font color="#CCCCCC"> de PUE skate which is always a</font>

479
00:24:25,899 --> 00:24:32,469
word I<font color="#E5E5E5"> have</font><font color="#CCCCCC"> problem saying the strings</font>

480
00:24:29,649 --> 00:24:35,168
that<font color="#E5E5E5"> ransomware uses because it uses</font>

481
00:24:32,470 --> 00:24:37,029
these huge long strings that it ought

482
00:24:35,169 --> 00:24:39,369
<font color="#E5E5E5">few skates to you know talk</font><font color="#CCCCCC"> to the</font>

483
00:24:37,029 --> 00:24:43,919
command and control servers well this

484
00:24:39,369 --> 00:24:46,059
tool can actually detect<font color="#E5E5E5"> on some of them</font>

485
00:24:43,919 --> 00:24:48,789
now we're on the<font color="#CCCCCC"> installation step</font>

486
00:24:46,059 --> 00:24:51,820
unless<font color="#E5E5E5"> any of you feel</font><font color="#CCCCCC"> like watching me</font>

487
00:24:48,789 --> 00:24:54,460
and<font color="#E5E5E5"> crap myself with ransomware I'm not</font>

488
00:24:51,820 --> 00:24:56,678
gonna do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> now we're just</font><font color="#E5E5E5"> gonna</font>

489
00:24:54,460 --> 00:25:01,090
pretend<font color="#E5E5E5"> that we've</font><font color="#CCCCCC"> ransomware to our</font>

490
00:24:56,679 --> 00:25:04,080
cells right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> ransomware variants</font>

491
00:25:01,090 --> 00:25:04,080
like crypto<font color="#E5E5E5"> wall</font>

492
00:25:07,060 --> 00:25:11,030
sorry

493
00:25:08,240 --> 00:25:13,130
<font color="#CCCCCC">I will live at home with nothing</font>

494
00:25:11,030 --> 00:25:16,340
ransomware but I can't get<font color="#CCCCCC"> to it right</font>

495
00:25:13,130 --> 00:25:19,280
now<font color="#CCCCCC"> but</font><font color="#E5E5E5"> they'll actually</font><font color="#CCCCCC"> use the</font>

496
00:25:16,340 --> 00:25:20,750
built-in<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> crypto API to start</font>

497
00:25:19,280 --> 00:25:24,379
encrypting the files which<font color="#CCCCCC"> is another</font>

498
00:25:20,750 --> 00:25:26,150
thing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can alert on and what can</font>

499
00:25:24,380 --> 00:25:28,700
we do at the installation<font color="#CCCCCC"> step for</font>

500
00:25:26,150 --> 00:25:30,800
<font color="#CCCCCC">defensive</font><font color="#E5E5E5"> mitigation at this point</font>

501
00:25:28,700 --> 00:25:34,880
you're pretty far along<font color="#E5E5E5"> right they've</font>

502
00:25:30,800 --> 00:25:35,990
already gotten the the<font color="#E5E5E5"> ransomware all</font>

503
00:25:34,880 --> 00:25:39,460
the way to this step

504
00:25:35,990 --> 00:25:44,240
it started encrypting the the files

505
00:25:39,460 --> 00:25:47,180
obviously backups<font color="#E5E5E5"> permanently</font><font color="#CCCCCC"> you know</font>

506
00:25:44,240 --> 00:25:48,830
like make sure your backups work<font color="#E5E5E5"> make</font>

507
00:25:47,180 --> 00:25:51,200
<font color="#E5E5E5">sure they you know give you all the</font>

508
00:25:48,830 --> 00:25:53,750
information<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you need</font><font color="#CCCCCC"> there's</font>

509
00:25:51,200 --> 00:25:55,700
different<font color="#E5E5E5"> things called like RPO RTO</font>

510
00:25:53,750 --> 00:25:57,350
<font color="#E5E5E5">which is recovery point objective and</font>

511
00:25:55,700 --> 00:26:00,410
recovery time objective which are

512
00:25:57,350 --> 00:26:04,360
<font color="#E5E5E5">completely like things that</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to</font>

513
00:26:00,410 --> 00:26:07,420
work<font color="#CCCCCC"> into your</font><font color="#E5E5E5"> backup</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> dr plans</font>

514
00:26:04,360 --> 00:26:09,800
there's there's things<font color="#E5E5E5"> called fire</font>

515
00:26:07,420 --> 00:26:13,490
<font color="#CCCCCC">filesystem firewalls which some of</font><font color="#E5E5E5"> the</font>

516
00:26:09,800 --> 00:26:16,540
<font color="#CCCCCC">next-gen 80 endpoint protection things</font>

517
00:26:13,490 --> 00:26:21,550
have started<font color="#CCCCCC"> to do which will</font><font color="#E5E5E5"> block</font>

518
00:26:16,540 --> 00:26:21,550
<font color="#E5E5E5">certain programs from spawning others</font>

519
00:26:21,820 --> 00:26:27,159
<font color="#CCCCCC">you can also have a portion of your IR</font>

520
00:26:24,470 --> 00:26:30,740
<font color="#CCCCCC">set-aside</font><font color="#E5E5E5"> depending on if you</font><font color="#CCCCCC"> have like</font>

521
00:26:27,160 --> 00:26:32,930
cyber<font color="#CCCCCC"> insurance or if you don't you can</font>

522
00:26:30,740 --> 00:26:34,400
actually just buy some<font color="#E5E5E5"> Bitcoin because</font>

523
00:26:32,930 --> 00:26:37,100
sometimes you actually<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to pay the</font>

524
00:26:34,400 --> 00:26:40,400
ransom<font color="#CCCCCC"> I never recommend paying</font><font color="#E5E5E5"> the</font>

525
00:26:37,100 --> 00:26:43,129
<font color="#E5E5E5">ransom but if you have to you have to</font>

526
00:26:40,400 --> 00:26:45,200
<font color="#E5E5E5">write you didn't do your due diligence</font>

527
00:26:43,130 --> 00:26:47,240
prior you don't know what's on<font color="#CCCCCC"> that</font>

528
00:26:45,200 --> 00:26:48,530
<font color="#CCCCCC">machine or you know what's on that</font>

529
00:26:47,240 --> 00:26:50,660
machine<font color="#E5E5E5"> and it's not anything that you</font>

530
00:26:48,530 --> 00:26:52,990
had backed up<font color="#E5E5E5"> sometimes you just have to</font>

531
00:26:50,660 --> 00:26:52,990
pay the<font color="#CCCCCC"> ransom</font>

532
00:26:54,580 --> 00:26:59,019
what can we do<font color="#E5E5E5"> for monitoring and</font>

533
00:26:56,500 --> 00:27:03,130
learning so this is an example of the

534
00:26:59,019 --> 00:27:07,269
<font color="#E5E5E5">windows crypto API spiking</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> server</font>

535
00:27:03,130 --> 00:27:11,440
started<font color="#E5E5E5"> encrypting the files on</font><font color="#CCCCCC"> the file</font>

536
00:27:07,269 --> 00:27:14,169
system<font color="#E5E5E5"> and now we're</font><font color="#CCCCCC"> into command</font><font color="#E5E5E5"> and</font>

537
00:27:11,440 --> 00:27:16,330
<font color="#E5E5E5">control</font><font color="#CCCCCC"> what it does at this point is</font>

538
00:27:14,169 --> 00:27:18,340
the ransomware transmits the decryption

539
00:27:16,330 --> 00:27:20,730
key to their<font color="#CCCCCC"> command a control server on</font>

540
00:27:18,340 --> 00:27:20,730
the<font color="#E5E5E5"> Internet</font>

541
00:27:22,299 --> 00:27:25,720
if any of you know what<font color="#CCCCCC"> I'd be</font><font color="#E5E5E5"> in a</font>

542
00:27:23,710 --> 00:27:28,570
sinkhole is this is a great defensive

543
00:27:25,720 --> 00:27:30,370
mitigation to do at this<font color="#CCCCCC"> point this</font><font color="#E5E5E5"> is</font>

544
00:27:28,570 --> 00:27:34,689
kind of what a<font color="#E5E5E5"> DNS sinkhole works like</font>

545
00:27:30,370 --> 00:27:37,268
so you<font color="#E5E5E5"> have your end device right and a</font>

546
00:27:34,690 --> 00:27:39,490
<font color="#E5E5E5">normal search for google.com</font><font color="#CCCCCC"> which your</font>

547
00:27:37,269 --> 00:27:41,049
internal DNS thinks<font color="#CCCCCC"> ok that's good</font>

548
00:27:39,490 --> 00:27:43,690
<font color="#E5E5E5">that's a good</font><font color="#CCCCCC"> domain</font><font color="#E5E5E5"> I'll allow that</font><font color="#CCCCCC"> out</font>

549
00:27:41,049 --> 00:27:46,149
to the downstream<font color="#E5E5E5"> DNS servers but if you</font>

550
00:27:43,690 --> 00:27:50,139
search<font color="#CCCCCC"> for you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> like a</font><font color="#E5E5E5"> ransom we're</font>

551
00:27:46,149 --> 00:27:53,168
looking for<font color="#E5E5E5"> X Y</font><font color="#CCCCCC"> k3 v blah blah blah blah</font>

552
00:27:50,139 --> 00:27:56,320
<font color="#E5E5E5">blah calm you know</font><font color="#CCCCCC"> that's already shown</font>

553
00:27:53,169 --> 00:28:00,730
up<font color="#E5E5E5"> as one of the listed bad domains</font>

554
00:27:56,320 --> 00:28:05,470
it'll just<font color="#E5E5E5"> send you nowhere right it can</font>

555
00:28:00,730 --> 00:28:07,269
send you<font color="#E5E5E5"> to localhost</font><font color="#CCCCCC"> it can send you to</font>

556
00:28:05,470 --> 00:28:09,309
<font color="#CCCCCC">an</font><font color="#E5E5E5"> internal server it can do whatever</font>

557
00:28:07,269 --> 00:28:11,409
you want<font color="#E5E5E5"> but the point is you don't</font>

558
00:28:09,309 --> 00:28:13,149
<font color="#CCCCCC">actually the computer itself doesn't</font>

559
00:28:11,409 --> 00:28:14,950
actually<font color="#E5E5E5"> end up going to that site</font><font color="#CCCCCC"> on</font>

560
00:28:13,149 --> 00:28:17,949
the<font color="#E5E5E5"> internet or the application doesn't</font>

561
00:28:14,950 --> 00:28:21,490
<font color="#E5E5E5">end up going to</font><font color="#CCCCCC"> that site I've seen this</font>

562
00:28:17,950 --> 00:28:23,529
work in<font color="#E5E5E5"> not necessarily a ransomware</font>

563
00:28:21,490 --> 00:28:26,820
case but it was a phishing case that we

564
00:28:23,529 --> 00:28:31,840
had at<font color="#E5E5E5"> the one hospital that I worked at</font>

565
00:28:26,820 --> 00:28:34,928
<font color="#CCCCCC">it was the</font><font color="#E5E5E5"> it didn't automatically block</font>

566
00:28:31,840 --> 00:28:37,990
it but we found<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the pen testers</font>

567
00:28:34,929 --> 00:28:40,389
that<font color="#E5E5E5"> we had hired phishing us and the IP</font>

568
00:28:37,990 --> 00:28:45,549
address and domain that<font color="#CCCCCC"> their fishing</font>

569
00:28:40,389 --> 00:28:49,809
was going to like<font color="#CCCCCC"> there</font><font color="#E5E5E5"> the DNS address</font>

570
00:28:45,549 --> 00:28:51,340
and everything<font color="#CCCCCC"> after seven</font><font color="#E5E5E5"> minutes I</font>

571
00:28:49,809 --> 00:28:53,408
<font color="#CCCCCC">think it was</font><font color="#E5E5E5"> because we actually</font><font color="#CCCCCC"> like we</font>

572
00:28:51,340 --> 00:28:55,720
had user training and they knew how<font color="#CCCCCC"> to</font>

573
00:28:53,409 --> 00:28:58,090
report it<font color="#CCCCCC"> to after</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> reported it</font><font color="#E5E5E5"> to</font>

574
00:28:55,720 --> 00:29:00,519
<font color="#E5E5E5">us we were</font><font color="#CCCCCC"> just able</font><font color="#E5E5E5"> to add</font><font color="#CCCCCC"> that to our</font>

575
00:28:58,090 --> 00:29:03,309
<font color="#E5E5E5">DNS sinkhole and then anybody else that</font>

576
00:29:00,519 --> 00:29:05,049
got any of<font color="#E5E5E5"> those emails</font><font color="#CCCCCC"> it just didn't</font>

577
00:29:03,309 --> 00:29:07,539
<font color="#E5E5E5">go anywhere you know after that first</font>

578
00:29:05,049 --> 00:29:09,290
person<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to like kind of use</font>

579
00:29:07,539 --> 00:29:17,330
that<font color="#CCCCCC"> in your IR</font>

580
00:29:09,290 --> 00:29:18,770
like live<font color="#CCCCCC"> IR</font><font color="#E5E5E5"> playbooks so this is</font>

581
00:29:17,330 --> 00:29:20,810
another<font color="#E5E5E5"> potential monitoring thing you</font>

582
00:29:18,770 --> 00:29:22,730
can use<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of times I have</font><font color="#E5E5E5"> customers</font>

583
00:29:20,810 --> 00:29:25,370
that<font color="#E5E5E5"> want to alert on any threat list</font>

584
00:29:22,730 --> 00:29:27,290
activity which is horrible idea

585
00:29:25,370 --> 00:29:29,899
threat lists are great<font color="#E5E5E5"> for specific</font>

586
00:29:27,290 --> 00:29:31,970
reasons<font color="#CCCCCC"> if you can identify those</font>

587
00:29:29,900 --> 00:29:34,880
specific reasons<font color="#E5E5E5"> but there are a</font>

588
00:29:31,970 --> 00:29:39,500
<font color="#CCCCCC">crap-ton of IP addresses on these threat</font>

589
00:29:34,880 --> 00:29:42,400
lists that<font color="#E5E5E5"> are not threats</font><font color="#CCCCCC"> just the</font>

590
00:29:39,500 --> 00:29:49,190
other day there was<font color="#CCCCCC"> a company that</font><font color="#E5E5E5"> added</font>

591
00:29:42,400 --> 00:29:51,950
all 169.254 addresses to a threat<font color="#E5E5E5"> list</font>

592
00:29:49,190 --> 00:29:56,720
<font color="#E5E5E5">which really can mess up the inside of</font>

593
00:29:51,950 --> 00:29:59,840
<font color="#CCCCCC">your network</font><font color="#E5E5E5"> as well</font><font color="#CCCCCC"> as like I've seen</font>

594
00:29:56,720 --> 00:30:02,510
people at all RFC 1918 addresses to

595
00:29:59,840 --> 00:30:04,970
<font color="#E5E5E5">publicly this anybody can submit stuff</font>

596
00:30:02,510 --> 00:30:06,950
to some of these<font color="#E5E5E5"> start lists and then</font>

597
00:30:04,970 --> 00:30:10,280
all of a sudden<font color="#E5E5E5"> you're getting you know</font>

598
00:30:06,950 --> 00:30:11,420
<font color="#E5E5E5">5 million alerts on threat</font><font color="#CCCCCC"> list activity</font>

599
00:30:10,280 --> 00:30:14,629
when it's just the inside<font color="#E5E5E5"> of your</font>

600
00:30:11,420 --> 00:30:17,510
network talking but these are some of

601
00:30:14,630 --> 00:30:20,600
<font color="#E5E5E5">them that I really like to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> there are</font>

602
00:30:17,510 --> 00:30:23,720
like<font color="#E5E5E5"> tor exit nodes but you can kind of</font>

603
00:30:20,600 --> 00:30:25,189
<font color="#E5E5E5">massage threat</font><font color="#CCCCCC"> list</font><font color="#E5E5E5"> to actually have to</font>

604
00:30:23,720 --> 00:30:26,810
do with threats that you're worried

605
00:30:25,190 --> 00:30:30,110
about you don't<font color="#E5E5E5"> just like blindly</font>

606
00:30:26,810 --> 00:30:34,960
implement all<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> and this is on</font>

607
00:30:30,110 --> 00:30:37,790
<font color="#CCCCCC">sans</font><font color="#E5E5E5"> another one that sans has is like a</font>

608
00:30:34,960 --> 00:30:40,670
few lists that they're super<font color="#CCCCCC"> sure about</font>

609
00:30:37,790 --> 00:30:43,820
<font color="#E5E5E5">so they have different rankings like all</font>

610
00:30:40,670 --> 00:30:47,660
of these IP<font color="#CCCCCC"> addresses have been specific</font>

611
00:30:43,820 --> 00:30:49,100
known threats for<font color="#CCCCCC"> the last</font><font color="#E5E5E5"> five years we</font>

612
00:30:47,660 --> 00:30:52,850
know that you're safe blocking these

613
00:30:49,100 --> 00:30:54,709
sure<font color="#CCCCCC"> add those</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> that's it's</font><font color="#E5E5E5"> usually</font>

614
00:30:52,850 --> 00:30:56,870
never gonna be a bad call to add all

615
00:30:54,710 --> 00:31:00,610
those but<font color="#E5E5E5"> you have to have a certain</font>

616
00:30:56,870 --> 00:31:00,610
<font color="#E5E5E5">sense of surety</font><font color="#CCCCCC"> when you do all of</font><font color="#E5E5E5"> that</font>

617
00:31:02,630 --> 00:31:07,910
these are called<font color="#E5E5E5"> DJs and ransomware uses</font>

618
00:31:05,720 --> 00:31:10,970
these it's a domain generated algorithm

619
00:31:07,910 --> 00:31:13,190
that<font color="#E5E5E5"> way ransomware people don't have to</font>

620
00:31:10,970 --> 00:31:15,350
like set<font color="#E5E5E5"> up one domain</font><font color="#CCCCCC"> and as soon as</font>

621
00:31:13,190 --> 00:31:18,049
somebody finds out<font color="#CCCCCC"> that that's the</font>

622
00:31:15,350 --> 00:31:21,020
domain<font color="#E5E5E5"> they use everybody blocks it they</font>

623
00:31:18,049 --> 00:31:23,809
use these I mean nobody<font color="#E5E5E5"> would go to</font>

624
00:31:21,020 --> 00:31:27,470
those<font color="#E5E5E5"> right or I hope not</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> there are</font>

625
00:31:23,809 --> 00:31:31,160
<font color="#E5E5E5">actually specific like IDs alerts and</font>

626
00:31:27,470 --> 00:31:33,020
stuff that<font color="#E5E5E5"> can alert on this type of</font>

627
00:31:31,160 --> 00:31:34,910
activity<font color="#CCCCCC"> right</font><font color="#E5E5E5"> because you're never</font>

628
00:31:33,020 --> 00:31:43,190
gonna just see somebody<font color="#E5E5E5"> go to a</font><font color="#CCCCCC"> xxx</font>

629
00:31:34,910 --> 00:31:44,929
character domain name in Russia and

630
00:31:43,190 --> 00:31:49,610
we're at the seventh step in the kill

631
00:31:44,929 --> 00:31:53,120
chain seeing a picture<font color="#CCCCCC"> of the screen</font>

632
00:31:49,610 --> 00:31:57,139
<font color="#CCCCCC">like</font><font color="#E5E5E5"> in action or at least seeing a</font>

633
00:31:53,120 --> 00:31:59,299
picture<font color="#CCCCCC"> of it the ransomware has</font><font color="#E5E5E5"> started</font>

634
00:31:57,140 --> 00:32:01,790
encrypting everything<font color="#E5E5E5"> this is the splash</font>

635
00:31:59,299 --> 00:32:03,440
page<font color="#E5E5E5"> that you'll get for one of the</font>

636
00:32:01,790 --> 00:32:05,389
variants<font color="#E5E5E5"> sometimes you get like a text</font>

637
00:32:03,440 --> 00:32:06,970
file giving you instructions<font color="#E5E5E5"> it's</font>

638
00:32:05,390 --> 00:32:09,740
usually like<font color="#E5E5E5"> a countdown timer</font>

639
00:32:06,970 --> 00:32:14,840
<font color="#E5E5E5">instructions on who to call or who to</font>

640
00:32:09,740 --> 00:32:15,770
contact<font color="#E5E5E5"> to get your stuff back and what</font>

641
00:32:14,840 --> 00:32:17,389
what<font color="#E5E5E5"> can we do for a</font><font color="#CCCCCC"> defensive</font>

642
00:32:15,770 --> 00:32:18,230
<font color="#E5E5E5">mitigation this was one</font><font color="#CCCCCC"> of my favorite</font>

643
00:32:17,390 --> 00:32:20,780
things<font color="#CCCCCC"> to do</font>

644
00:32:18,230 --> 00:32:22,130
it's called honey directories so what

645
00:32:20,780 --> 00:32:23,899
ransomware does when it starts

646
00:32:22,130 --> 00:32:26,090
encrypting your<font color="#E5E5E5"> files a lot of the time</font>

647
00:32:23,900 --> 00:32:29,600
it will<font color="#E5E5E5"> start at directories and</font><font color="#CCCCCC"> will do</font>

648
00:32:26,090 --> 00:32:31,730
<font color="#E5E5E5">in alphabetical order in that</font><font color="#CCCCCC"> look in</font>

649
00:32:29,600 --> 00:32:33,980
that alphabetical order it starts at

650
00:32:31,730 --> 00:32:35,750
dollar sign whatever<font color="#E5E5E5"> that's why a lot</font><font color="#CCCCCC"> of</font>

651
00:32:33,980 --> 00:32:38,030
<font color="#CCCCCC">times when you see ransomware</font><font color="#E5E5E5"> start</font>

652
00:32:35,750 --> 00:32:40,190
encrypting the recycle bin is the<font color="#E5E5E5"> first</font>

653
00:32:38,030 --> 00:32:42,530
one because this dollar sign recycle bin

654
00:32:40,190 --> 00:32:46,130
is<font color="#CCCCCC"> the first one listed in on your C</font>

655
00:32:42,530 --> 00:32:50,059
Drive<font color="#CCCCCC"> so there is a</font><font color="#E5E5E5"> PowerShell script</font>

656
00:32:46,130 --> 00:32:51,470
that<font color="#CCCCCC"> I did not create at all and the</font>

657
00:32:50,059 --> 00:32:52,610
site that did create<font color="#CCCCCC"> it and</font><font color="#E5E5E5"> the people</font>

658
00:32:51,470 --> 00:32:54,290
that created<font color="#E5E5E5"> it seemed to have</font><font color="#CCCCCC"> just</font>

659
00:32:52,610 --> 00:32:58,459
disappeared<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the internet so I can't</font>

660
00:32:54,290 --> 00:33:01,010
really<font color="#E5E5E5"> give them credit so what it does</font>

661
00:32:58,460 --> 00:33:03,140
is it creates a mount point<font color="#CCCCCC"> on the C</font>

662
00:33:01,010 --> 00:33:08,390
Drive<font color="#E5E5E5"> that is just dollar sign dollar</font>

663
00:33:03,140 --> 00:33:10,790
sign and<font color="#E5E5E5"> just like pointers to the rest</font>

664
00:33:08,390 --> 00:33:12,140
of the new fake C Drive<font color="#E5E5E5"> that it's</font>

665
00:33:10,790 --> 00:33:15,110
created

666
00:33:12,140 --> 00:33:17,480
and it will allow you<font color="#E5E5E5"> to navigate</font>

667
00:33:15,110 --> 00:33:19,610
through<font color="#E5E5E5"> those directories up until the</font>

668
00:33:17,480 --> 00:33:22,220
character limit of a path<font color="#E5E5E5"> in Windows</font>

669
00:33:19,610 --> 00:33:23,719
which is 256<font color="#E5E5E5"> characters so you can go</font>

670
00:33:22,220 --> 00:33:24,680
like you actually<font color="#E5E5E5"> click through these</font>

671
00:33:23,720 --> 00:33:27,470
<font color="#E5E5E5">and they'll be like dollar sign dollar</font>

672
00:33:24,680 --> 00:33:29,180
sign<font color="#E5E5E5"> slash dollar sign dollar sign slash</font>

673
00:33:27,470 --> 00:33:33,520
<font color="#CCCCCC">Docs</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> color sign</font><font color="#E5E5E5"> all the way up until</font>

674
00:33:29,180 --> 00:33:37,430
256 characters<font color="#CCCCCC"> and all</font><font color="#E5E5E5"> of the other</font>

675
00:33:33,520 --> 00:33:39,950
links<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> in there look like copies</font>

676
00:33:37,430 --> 00:33:41,240
of the<font color="#E5E5E5"> C Drive that aren't but you could</font>

677
00:33:39,950 --> 00:33:42,890
<font color="#E5E5E5">actually navigate through those so it</font>

678
00:33:41,240 --> 00:33:45,970
kind of gives as an early-warning

679
00:33:42,890 --> 00:33:48,380
detection system for ransomware

680
00:33:45,970 --> 00:33:52,100
by the time it gets through all<font color="#E5E5E5"> of those</font>

681
00:33:48,380 --> 00:33:55,390
you may have<font color="#CCCCCC"> 5-10 minutes but that's</font>

682
00:33:52,100 --> 00:33:59,740
<font color="#CCCCCC">5-10</font><font color="#E5E5E5"> minutes that you didn't have before</font>

683
00:33:55,390 --> 00:33:59,740
<font color="#E5E5E5">so that is this</font>

684
00:34:03,520 --> 00:34:21,020
so this is the<font color="#CCCCCC"> powershell</font><font color="#E5E5E5"> script and</font>

685
00:34:13,969 --> 00:34:22,009
that's<font color="#CCCCCC"> how fast it</font><font color="#E5E5E5"> runs and now my</font><font color="#CCCCCC"> c</font>

686
00:34:21,020 --> 00:34:26,359
<font color="#CCCCCC">drive i have this dollar sign dollar</font>

687
00:34:22,010 --> 00:34:29,590
sign you could just go into<font color="#E5E5E5"> and it's</font>

688
00:34:26,359 --> 00:34:29,590
just everything<font color="#CCCCCC"> forever</font>

689
00:34:31,100 --> 00:34:38,120
so I'm gonna actually<font color="#E5E5E5"> go in and show you</font>

690
00:34:34,520 --> 00:34:41,739
how<font color="#E5E5E5"> to create</font><font color="#CCCCCC"> a log</font><font color="#E5E5E5"> that shows somebody</font>

691
00:34:38,120 --> 00:34:44,000
accessing this<font color="#E5E5E5"> now you could have</font>

692
00:34:41,739 --> 00:34:45,979
<font color="#E5E5E5">definitely some false positives</font><font color="#CCCCCC"> if you</font>

693
00:34:44,000 --> 00:34:47,389
have a user that just gets curious like

694
00:34:45,980 --> 00:34:50,510
why is there a dollar sign dollar sign

695
00:34:47,389 --> 00:34:56,330
directory<font color="#E5E5E5"> okay but honestly that</font>

696
00:34:50,510 --> 00:34:58,400
<font color="#E5E5E5">probably shouldn't happen super often so</font>

697
00:34:56,330 --> 00:35:02,180
<font color="#CCCCCC">inherent you just set</font><font color="#E5E5E5"> auditing to</font>

698
00:34:58,400 --> 00:35:03,710
everyone this isn't an access thing this

699
00:35:02,180 --> 00:35:06,890
is<font color="#CCCCCC"> just the fact that you want to create</font>

700
00:35:03,710 --> 00:35:09,070
<font color="#CCCCCC">logs on anybody accessing</font><font color="#E5E5E5"> this file or</font>

701
00:35:06,890 --> 00:35:09,069
folder

702
00:35:21,050 --> 00:35:27,730
and into<font color="#E5E5E5"> your policy again we actually</font>

703
00:35:23,410 --> 00:35:31,850
starting with 2008 r2 Windows Server

704
00:35:27,730 --> 00:35:33,470
they created these<font color="#E5E5E5"> like way</font><font color="#CCCCCC"> more</font>

705
00:35:31,850 --> 00:35:35,720
advanced logging<font color="#E5E5E5"> options that you can</font>

706
00:35:33,470 --> 00:35:38,080
<font color="#E5E5E5">have and we're going to go on and turn</font>

707
00:35:35,720 --> 00:35:38,080
these<font color="#CCCCCC"> on</font>

708
00:35:39,420 --> 00:35:46,680
so advanced auto policy configuration<font color="#E5E5E5"> is</font>

709
00:35:42,150 --> 00:35:49,380
the<font color="#CCCCCC"> new one that they added under audit</font>

710
00:35:46,680 --> 00:35:52,819
policies<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's object</font><font color="#CCCCCC"> access I think</font>

711
00:35:49,380 --> 00:35:52,819
<font color="#E5E5E5">yeah object access</font>

712
00:35:54,640 --> 00:36:00,400
I'm gonna<font color="#CCCCCC"> audit our file system</font><font color="#E5E5E5"> and</font>

713
00:35:59,109 --> 00:36:02,848
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to audit for success for</font>

714
00:36:00,400 --> 00:36:02,849
<font color="#CCCCCC">axis</font>

715
00:36:13,200 --> 00:36:16,689
and when you make<font color="#E5E5E5"> your</font><font color="#CCCCCC"> policy changes</font>

716
00:36:15,460 --> 00:36:22,390
<font color="#E5E5E5">when you want them to take effect</font><font color="#CCCCCC"> right</font>

717
00:36:16,690 --> 00:36:24,400
<font color="#CCCCCC">away you have</font><font color="#E5E5E5"> to do a</font><font color="#CCCCCC"> policy</font><font color="#E5E5E5"> update this</font>

718
00:36:22,390 --> 00:36:28,770
normally happens<font color="#E5E5E5"> randomly throughout the</font>

719
00:36:24,400 --> 00:36:28,770
day in intervals or during reboots

720
00:36:34,800 --> 00:36:38,040
and I'm going<font color="#CCCCCC"> to access this file and</font>

721
00:36:36,510 --> 00:36:41,060
pretend to<font color="#E5E5E5"> be malware going through and</font>

722
00:36:38,040 --> 00:36:41,060
trying to<font color="#CCCCCC"> encrypt stuff</font>

723
00:36:58,329 --> 00:37:06,410
<font color="#E5E5E5">can I hate windows about viewer and see</font>

724
00:37:03,170 --> 00:37:08,599
right<font color="#E5E5E5"> here you can</font><font color="#CCCCCC"> see an attempt was</font>

725
00:37:06,410 --> 00:37:11,960
<font color="#E5E5E5">made</font><font color="#CCCCCC"> to access an object</font><font color="#E5E5E5"> and the object</font>

726
00:37:08,599 --> 00:37:14,599
<font color="#CCCCCC">names see</font><font color="#E5E5E5"> dollar sign dollar sign so in</font>

727
00:37:11,960 --> 00:37:16,519
a sim or any type of logging<font color="#E5E5E5"> solution</font>

728
00:37:14,599 --> 00:37:20,200
that you might have you<font color="#CCCCCC"> can say</font><font color="#E5E5E5"> all</font>

729
00:37:16,519 --> 00:37:24,019
<font color="#E5E5E5">right well if I get this event ID</font>

730
00:37:20,200 --> 00:37:26,029
happening<font color="#E5E5E5"> you could try it all first</font>

731
00:37:24,019 --> 00:37:27,709
<font color="#E5E5E5">right</font><font color="#CCCCCC"> but anytime you do any kind of</font>

732
00:37:26,029 --> 00:37:30,049
logging<font color="#E5E5E5"> solution there's a lot of tuning</font>

733
00:37:27,710 --> 00:37:32,599
that's involved so you<font color="#E5E5E5"> can start with I</font>

734
00:37:30,049 --> 00:37:34,249
want to see it<font color="#CCCCCC"> anytime this</font><font color="#E5E5E5"> happens and</font>

735
00:37:32,599 --> 00:37:35,989
then if you get a crap-ton<font color="#E5E5E5"> of those</font>

736
00:37:34,249 --> 00:37:38,269
because users<font color="#CCCCCC"> are going</font><font color="#E5E5E5"> in and clicking</font>

737
00:37:35,989 --> 00:37:40,160
on all the time<font color="#E5E5E5"> you want to say I want</font>

738
00:37:38,269 --> 00:37:43,729
to see when this happens

739
00:37:40,160 --> 00:37:50,930
<font color="#E5E5E5">oh so many times in 30 seconds and then</font>

740
00:37:43,729 --> 00:37:54,229
<font color="#CCCCCC">I'll</font><font color="#E5E5E5"> learn on</font><font color="#CCCCCC"> that here we can see an</font>

741
00:37:50,930 --> 00:37:57,799
example<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that in spunk</font><font color="#E5E5E5"> when it was</font>

742
00:37:54,229 --> 00:37:59,569
<font color="#E5E5E5">actually set</font><font color="#CCCCCC"> up right so can anybody</font>

743
00:37:57,799 --> 00:38:03,049
tell<font color="#CCCCCC"> me when the file started being</font>

744
00:37:59,569 --> 00:38:05,469
<font color="#CCCCCC">encrypted crap-ton</font><font color="#E5E5E5"> of those event logs</font>

745
00:38:03,049 --> 00:38:05,469
come in

746
00:38:06,429 --> 00:38:14,929
and we have finally<font color="#CCCCCC"> gotten through</font><font color="#E5E5E5"> the</font>

747
00:38:08,630 --> 00:38:16,400
<font color="#CCCCCC">first use case so we have like</font><font color="#E5E5E5"> 10</font>

748
00:38:14,929 --> 00:38:21,709
minutes<font color="#CCCCCC"> before we</font><font color="#E5E5E5"> have to go to lunch</font>

749
00:38:16,400 --> 00:38:25,009
any I have Shh<font color="#CCCCCC"> I think it's 2 2 more</font><font color="#E5E5E5"> use</font>

750
00:38:21,709 --> 00:38:26,899
cases<font color="#CCCCCC"> do you want to</font><font color="#E5E5E5"> learn about data</font>

751
00:38:25,009 --> 00:38:32,119
loss and theft

752
00:38:26,900 --> 00:38:36,559
oh no I have<font color="#E5E5E5"> three insider like</font>

753
00:38:32,119 --> 00:38:43,099
privilege misuse or<font color="#CCCCCC"> OSINT any</font>

754
00:38:36,559 --> 00:38:45,339
preferences insider<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> just ignore</font>

755
00:38:43,099 --> 00:38:45,339
all<font color="#E5E5E5"> this</font>

756
00:38:50,840 --> 00:38:58,730
there we go lateral movement privilege

757
00:38:53,090 --> 00:39:00,050
<font color="#E5E5E5">misuse is what it is okay so none</font><font color="#CCCCCC"> of</font>

758
00:38:58,730 --> 00:39:04,730
that makes sense because we<font color="#E5E5E5"> didn't go</font>

759
00:39:00,050 --> 00:39:08,870
over<font color="#E5E5E5"> DLP so first step is recon has</font>

760
00:39:04,730 --> 00:39:11,900
anybody<font color="#E5E5E5"> ever heard of</font><font color="#CCCCCC"> bloodhound right</font>

761
00:39:08,870 --> 00:39:13,670
so bloodhound<font color="#CCCCCC"> is a tool it used</font><font color="#E5E5E5"> to be</font>

762
00:39:11,900 --> 00:39:15,650
just<font color="#E5E5E5"> a</font><font color="#CCCCCC"> powershell script</font><font color="#E5E5E5"> and like</font>

763
00:39:13,670 --> 00:39:19,090
database stuff now they<font color="#CCCCCC"> turned it</font><font color="#E5E5E5"> into a</font>

764
00:39:15,650 --> 00:39:22,040
full-blown application that will

765
00:39:19,090 --> 00:39:24,970
enumerate<font color="#E5E5E5"> Active Directory so you can</font>

766
00:39:22,040 --> 00:39:27,590
run<font color="#E5E5E5"> it and it will give you this huge</font>

767
00:39:24,970 --> 00:39:31,520
all these all these<font color="#E5E5E5"> printouts or it will</font>

768
00:39:27,590 --> 00:39:34,040
create this this<font color="#E5E5E5"> database structure of</font>

769
00:39:31,520 --> 00:39:37,400
what actually Active Directory<font color="#E5E5E5"> actually</font>

770
00:39:34,040 --> 00:39:39,560
looks like<font color="#E5E5E5"> at this point and this is</font><font color="#CCCCCC"> why</font>

771
00:39:37,400 --> 00:39:42,440
it's in<font color="#E5E5E5"> kind of lateral movement</font><font color="#CCCCCC"> use</font>

772
00:39:39,560 --> 00:39:44,750
case is because by the time<font color="#E5E5E5"> blood hunt</font>

773
00:39:42,440 --> 00:39:46,640
bloodhound is being run<font color="#CCCCCC"> there already</font><font color="#E5E5E5"> on</font>

774
00:39:44,750 --> 00:39:50,750
the inside<font color="#CCCCCC"> of the network</font><font color="#E5E5E5"> right they're</font>

775
00:39:46,640 --> 00:39:52,580
still doing recon<font color="#CCCCCC"> but it's a little</font><font color="#E5E5E5"> bit</font>

776
00:39:50,750 --> 00:39:56,470
<font color="#E5E5E5">later it's in that second</font><font color="#CCCCCC"> you have more</font>

777
00:39:52,580 --> 00:39:56,470
evil<font color="#CCCCCC"> loop-d-loop</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> microsoft created</font>

778
00:39:56,680 --> 00:40:01,029
so the malicious action is things like

779
00:39:59,120 --> 00:40:05,000
<font color="#E5E5E5">bloodhound</font><font color="#CCCCCC"> you can also use other tools</font>

780
00:40:01,030 --> 00:40:06,980
<font color="#CCCCCC">W&I SNMP anything that's native in the</font>

781
00:40:05,000 --> 00:40:12,110
environment<font color="#E5E5E5"> to use to gather more</font>

782
00:40:06,980 --> 00:40:15,130
information<font color="#CCCCCC"> on the target</font><font color="#E5E5E5"> and this is</font>

783
00:40:12,110 --> 00:40:15,130
<font color="#E5E5E5">bloodhound running</font>

784
00:40:19,720 --> 00:40:24,399
it's just a little<font color="#CCCCCC"> powershell scripts</font>

785
00:40:25,900 --> 00:40:34,730
all right well let's get<font color="#E5E5E5"> that one</font>

786
00:40:28,329 --> 00:40:37,249
because<font color="#CCCCCC"> I also cover it later oh oh</font>

787
00:40:34,730 --> 00:40:40,960
let's see here one of<font color="#E5E5E5"> the first methods</font>

788
00:40:37,249 --> 00:40:44,359
of attack<font color="#E5E5E5"> during</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> recon phase is</font>

789
00:40:40,960 --> 00:40:46,160
something<font color="#E5E5E5"> called you can use a responder</font>

790
00:40:44,359 --> 00:40:48,859
or<font color="#E5E5E5"> there's a couple of the tools I</font><font color="#CCCCCC"> think</font>

791
00:40:46,160 --> 00:40:53,450
they do<font color="#E5E5E5"> this now</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's basically</font>

792
00:40:48,859 --> 00:40:55,848
spoofing<font color="#CCCCCC"> lmn are or NetBIOS requests</font>

793
00:40:53,450 --> 00:41:00,230
<font color="#CCCCCC">across the enterprise</font><font color="#E5E5E5"> so this is kind of</font>

794
00:40:55,849 --> 00:41:02,509
a<font color="#E5E5E5"> little diagram works basically the the</font>

795
00:41:00,230 --> 00:41:05,450
<font color="#E5E5E5">little victim guy over there he goes to</font>

796
00:41:02,509 --> 00:41:07,880
search for like a printer<font color="#CCCCCC"> or a file</font>

797
00:41:05,450 --> 00:41:10,999
share and<font color="#E5E5E5"> they type it wrong</font><font color="#CCCCCC"> right</font>

798
00:41:07,880 --> 00:41:13,640
there'll be a like slash<font color="#E5E5E5"> slash my test</font>

799
00:41:10,999 --> 00:41:17,209
server<font color="#E5E5E5"> one but it doesn't</font><font color="#CCCCCC"> really exist</font>

800
00:41:13,640 --> 00:41:19,970
out there that still creates some

801
00:41:17,210 --> 00:41:23,019
broadcast<font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> and it happens over a</font>

802
00:41:19,970 --> 00:41:27,910
<font color="#CCCCCC">specific port and it's either NetBIOS or</font>

803
00:41:23,019 --> 00:41:31,339
DNS or<font color="#CCCCCC"> lmn are just link local</font>

804
00:41:27,910 --> 00:41:34,190
multiverse<font color="#E5E5E5"> Aleutians</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> I always</font>

805
00:41:31,339 --> 00:41:35,450
<font color="#E5E5E5">forget that one</font><font color="#CCCCCC"> but those</font><font color="#E5E5E5"> are things</font>

806
00:41:34,190 --> 00:41:37,690
that you can actually<font color="#CCCCCC"> shut</font><font color="#E5E5E5"> off in an</font>

807
00:41:35,450 --> 00:41:41,359
organization<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are kind</font><font color="#E5E5E5"> of</font>

808
00:41:37,690 --> 00:41:43,400
deprecated<font color="#CCCCCC"> standards that are</font><font color="#E5E5E5"> out there</font>

809
00:41:41,359 --> 00:41:44,839
<font color="#E5E5E5">you should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> using DNS because it's a</font>

810
00:41:43,400 --> 00:41:47,559
little<font color="#CCCCCC"> bit more secure and it doesn't do</font>

811
00:41:44,839 --> 00:41:47,558
this whole<font color="#E5E5E5"> thing</font>

812
00:41:48,309 --> 00:41:57,849
so with responder<font color="#E5E5E5"> well I thought I had a</font>

813
00:41:53,589 --> 00:42:04,578
thing that showed responder running crap

814
00:41:57,849 --> 00:42:06,529
in<font color="#CCCCCC"> bay thank you so I did</font><font color="#E5E5E5"> have a video</font>

815
00:42:04,579 --> 00:42:08,690
<font color="#E5E5E5">on this running but we also don't</font><font color="#CCCCCC"> have</font>

816
00:42:06,529 --> 00:42:12,140
much time for<font color="#CCCCCC"> that so</font><font color="#E5E5E5"> basically what you</font>

817
00:42:08,690 --> 00:42:14,480
do is<font color="#CCCCCC"> you know that that victim box</font>

818
00:42:12,140 --> 00:42:18,098
<font color="#E5E5E5">tries to go</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> and the attacker can</font>

819
00:42:14,480 --> 00:42:20,150
actually say I am test server<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> and</font>

820
00:42:18,099 --> 00:42:23,710
it'll<font color="#CCCCCC"> just capture your Windows</font>

821
00:42:20,150 --> 00:42:23,710
credentials<font color="#CCCCCC"> super easy</font>

822
00:42:24,210 --> 00:42:28,380
and this is supposed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> a walkthrough</font>

823
00:42:26,710 --> 00:42:30,790
<font color="#CCCCCC">on how</font><font color="#E5E5E5"> to turn that</font><font color="#CCCCCC"> off</font>

824
00:42:28,380 --> 00:42:32,740
<font color="#E5E5E5">and if you want any of this stuff later</font>

825
00:42:30,790 --> 00:42:34,029
I have like videos on<font color="#E5E5E5"> YouTube and you</font>

826
00:42:32,740 --> 00:42:36,250
can<font color="#E5E5E5"> have the slides or whatever I've</font>

827
00:42:34,030 --> 00:42:39,550
<font color="#E5E5E5">like specific step-by-step instructions</font>

828
00:42:36,250 --> 00:42:44,950
on not only<font color="#E5E5E5"> how</font><font color="#CCCCCC"> to do the attack part</font>

829
00:42:39,550 --> 00:42:47,530
but also how<font color="#CCCCCC"> to prevent it so there's a</font>

830
00:42:44,950 --> 00:42:50,669
crap ton of<font color="#CCCCCC"> defensive things too that</font>

831
00:42:47,530 --> 00:42:53,140
you can do in this type of recon phase

832
00:42:50,670 --> 00:42:55,750
<font color="#CCCCCC">obviously</font><font color="#E5E5E5"> good passwords is this kind of</font>

833
00:42:53,140 --> 00:42:58,450
<font color="#E5E5E5">just</font><font color="#CCCCCC"> like some simple math behind what a</font>

834
00:42:55,750 --> 00:43:00,309
good password<font color="#E5E5E5"> is and that good password</font>

835
00:42:58,450 --> 00:43:03,609
<font color="#E5E5E5">doesn't have to be</font><font color="#CCCCCC"> fifteen twenty</font>

836
00:43:00,309 --> 00:43:05,619
characters<font color="#CCCCCC"> it just has to be long or</font>

837
00:43:03,609 --> 00:43:07,990
<font color="#E5E5E5">complex</font><font color="#CCCCCC"> right you actually have to think</font>

838
00:43:05,619 --> 00:43:10,030
<font color="#CCCCCC">about the math behind</font><font color="#E5E5E5"> it one of the huge</font>

839
00:43:07,990 --> 00:43:13,540
struggles again an enterprise is

840
00:43:10,030 --> 00:43:16,690
password policies<font color="#CCCCCC"> if you can get them to</font>

841
00:43:13,540 --> 00:43:18,880
<font color="#CCCCCC">do anything but the first</font><font color="#E5E5E5"> two you know</font>

842
00:43:16,690 --> 00:43:22,420
it's a<font color="#E5E5E5"> little bit more towards the</font>

843
00:43:18,880 --> 00:43:25,900
security<font color="#CCCCCC"> microsoft also has fine-grained</font>

844
00:43:22,420 --> 00:43:27,609
password policies which are<font color="#E5E5E5"> okay allows</font>

845
00:43:25,900 --> 00:43:30,160
you to set different password policies

846
00:43:27,609 --> 00:43:32,170
for different<font color="#CCCCCC"> people they used to have a</font>

847
00:43:30,160 --> 00:43:34,598
thing<font color="#CCCCCC"> in Windows 2000</font><font color="#E5E5E5"> that they got rid</font>

848
00:43:32,170 --> 00:43:36,490
<font color="#E5E5E5">of but it would be custom DLL that you</font>

849
00:43:34,599 --> 00:43:38,230
could write<font color="#E5E5E5"> that you would say</font><font color="#CCCCCC"> alright</font>

850
00:43:36,490 --> 00:43:40,589
well I work for<font color="#E5E5E5"> acne I don't want any of</font>

851
00:43:38,230 --> 00:43:42,790
<font color="#CCCCCC">my passwords to contain the word acne</font>

852
00:43:40,589 --> 00:43:44,020
they<font color="#E5E5E5"> got rid of that so Windows doesn't</font>

853
00:43:42,790 --> 00:43:46,900
<font color="#CCCCCC">do that</font><font color="#E5E5E5"> anymore</font><font color="#CCCCCC"> and you have to have a</font>

854
00:43:44,020 --> 00:43:49,450
custom off solution<font color="#CCCCCC"> alright I had tried</font>

855
00:43:46,900 --> 00:43:54,329
<font color="#CCCCCC">to actually</font><font color="#E5E5E5"> write the DLL to make 2008</font>

856
00:43:49,450 --> 00:43:54,328
do it<font color="#CCCCCC"> or twelve it didn't work</font>

857
00:43:55,660 --> 00:43:59,828
another thing<font color="#CCCCCC"> that I've heard that</font>

858
00:43:57,190 --> 00:44:02,079
<font color="#E5E5E5">really trips up pen testers is not only</font>

859
00:43:59,829 --> 00:44:04,780
<font color="#E5E5E5">to factor</font><font color="#CCCCCC"> auth in from the outside</font><font color="#E5E5E5"> but</font>

860
00:44:02,079 --> 00:44:07,530
<font color="#CCCCCC">to factor auth</font><font color="#E5E5E5"> all the important stuff</font>

861
00:44:04,780 --> 00:44:07,530
<font color="#CCCCCC">internally</font>

862
00:44:09,620 --> 00:44:13,109
<font color="#E5E5E5">I'm again I've always wanted to go a</font>

863
00:44:12,060 --> 00:44:16,560
little<font color="#E5E5E5"> bit further</font><font color="#CCCCCC"> into blocking</font>

864
00:44:13,110 --> 00:44:18,630
specific passwords<font color="#CCCCCC"> there are</font><font color="#E5E5E5"> people that</font>

865
00:44:16,560 --> 00:44:20,549
try and<font color="#CCCCCC"> do like</font><font color="#E5E5E5"> Active Directory</font><font color="#CCCCCC"> add-ons</font>

866
00:44:18,630 --> 00:44:23,850
for<font color="#E5E5E5"> their like help desk or</font><font color="#CCCCCC"> whatever</font>

867
00:44:20,550 --> 00:44:26,550
that may give them that<font color="#E5E5E5"> extra step of</font>

868
00:44:23,850 --> 00:44:28,410
security<font color="#CCCCCC"> when it</font><font color="#E5E5E5"> comes to cut choosing</font>

869
00:44:26,550 --> 00:44:31,140
passwords<font color="#CCCCCC"> that kind of stuff this</font><font color="#E5E5E5"> is</font>

870
00:44:28,410 --> 00:44:33,149
<font color="#E5E5E5">actually an example that I ran into</font><font color="#CCCCCC"> I</font>

871
00:44:31,140 --> 00:44:36,390
had a customer wanting to put this data

872
00:44:33,150 --> 00:44:37,920
<font color="#E5E5E5">in</font><font color="#CCCCCC"> Splunk this was their custom well</font>

873
00:44:36,390 --> 00:44:39,690
this was an<font color="#CCCCCC"> application that they paid</font>

874
00:44:37,920 --> 00:44:43,110
<font color="#E5E5E5">for for their helped us to be able</font><font color="#CCCCCC"> to</font>

875
00:44:39,690 --> 00:44:44,880
reset usernames and passwords<font color="#E5E5E5"> but it</font>

876
00:44:43,110 --> 00:44:47,460
logged<font color="#E5E5E5"> the username and password</font><font color="#CCCCCC"> in</font>

877
00:44:44,880 --> 00:44:49,020
<font color="#CCCCCC">plain text</font><font color="#E5E5E5"> in the log file and then</font><font color="#CCCCCC"> it</font>

878
00:44:47,460 --> 00:44:50,640
everything just<font color="#E5E5E5"> showed up</font><font color="#CCCCCC"> in Splunk and</font>

879
00:44:49,020 --> 00:44:52,680
we could tell what<font color="#E5E5E5"> all the passwords</font>

880
00:44:50,640 --> 00:44:55,290
<font color="#E5E5E5">were being changed to and so could</font>

881
00:44:52,680 --> 00:44:57,480
<font color="#E5E5E5">anybody that could read that log file it</font>

882
00:44:55,290 --> 00:45:00,920
was in Windows Event Viewer it was in

883
00:44:57,480 --> 00:45:02,970
the text log file itself<font color="#CCCCCC"> it's ridiculous</font>

884
00:45:00,920 --> 00:45:05,340
<font color="#E5E5E5">so that's one thing</font><font color="#CCCCCC"> that you should</font>

885
00:45:02,970 --> 00:45:06,540
definitely<font color="#E5E5E5"> pay attention to when trying</font>

886
00:45:05,340 --> 00:45:10,440
<font color="#E5E5E5">to come up</font><font color="#CCCCCC"> with better password</font>

887
00:45:06,540 --> 00:45:11,670
solutions<font color="#E5E5E5"> okay so hopefully you can see</font>

888
00:45:10,440 --> 00:45:13,860
<font color="#CCCCCC">this bloodhound</font>

889
00:45:11,670 --> 00:45:18,150
demo if not I'll just<font color="#E5E5E5"> open</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> up in</font>

890
00:45:13,860 --> 00:45:21,540
YouTube<font color="#E5E5E5"> but this is gonna be actually</font>

891
00:45:18,150 --> 00:45:23,870
<font color="#E5E5E5">running it and then or maybe not maybe</font>

892
00:45:21,540 --> 00:45:26,870
it's not the<font color="#CCCCCC"> running maybe it's the</font>

893
00:45:23,870 --> 00:45:26,870
<font color="#E5E5E5">alerting</font>

894
00:45:29,130 --> 00:45:37,849
oh yeah so this<font color="#E5E5E5"> is this is</font><font color="#CCCCCC"> more fine</font>

895
00:45:31,589 --> 00:45:41,339
<font color="#CCCCCC">grained audit</font><font color="#E5E5E5"> of audit policy settings</font>

896
00:45:37,849 --> 00:45:44,490
you can create turn on all PowerShell

897
00:45:41,339 --> 00:45:46,349
module logging so anything that's run<font color="#CCCCCC"> in</font>

898
00:45:44,490 --> 00:45:47,910
PowerShell<font color="#CCCCCC"> I need any command that's</font>

899
00:45:46,349 --> 00:45:52,289
typed you can actually<font color="#E5E5E5"> log that in Event</font>

900
00:45:47,910 --> 00:45:55,640
Viewer same thing with<font color="#E5E5E5"> the command line</font>

901
00:45:52,289 --> 00:45:55,640
<font color="#E5E5E5">you can do command line logging</font>

902
00:46:05,119 --> 00:46:09,530
that's something else to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> blogging oh</font>

903
00:46:09,710 --> 00:46:14,570
yeah

904
00:46:10,890 --> 00:46:14,569
include command<font color="#E5E5E5"> line</font><font color="#CCCCCC"> and process logging</font>

905
00:46:14,690 --> 00:46:20,010
those are the CSVs that came when<font color="#CCCCCC"> I</font>

906
00:46:18,030 --> 00:46:25,920
actually ran the<font color="#CCCCCC"> Bloodhound PowerShell</font>

907
00:46:20,010 --> 00:46:28,220
<font color="#CCCCCC">script sound bitch hold on</font><font color="#E5E5E5"> I'll we'll</font>

908
00:46:25,920 --> 00:46:28,220
get this

909
00:46:47,360 --> 00:46:56,220
<font color="#CCCCCC">that's word for</font><font color="#E5E5E5"> other things</font>

910
00:46:51,330 --> 00:46:57,870
oh why<font color="#E5E5E5"> can't you see it there either no</font>

911
00:46:56,220 --> 00:47:05,430
that's disappointing<font color="#CCCCCC"> hopefully we</font><font color="#E5E5E5"> can</font>

912
00:46:57,870 --> 00:47:10,020
see that<font color="#E5E5E5"> Active Directory oh</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> you</font>

913
00:47:05,430 --> 00:47:11,819
can't see it<font color="#E5E5E5"> kind of well it's super</font>

914
00:47:10,020 --> 00:47:17,009
small<font color="#E5E5E5"> but it's part of it that's</font>

915
00:47:11,820 --> 00:47:20,430
invoking<font color="#E5E5E5"> bloodhound</font><font color="#CCCCCC"> and then it's</font>

916
00:47:17,010 --> 00:47:22,800
running<font color="#E5E5E5"> and populating all of these CSVs</font>

917
00:47:20,430 --> 00:47:24,629
with<font color="#E5E5E5"> who the admins are who the groups</font>

918
00:47:22,800 --> 00:47:28,230
are what the trust permissions are all

919
00:47:24,630 --> 00:47:31,020
that kind of stuff and then an event

920
00:47:28,230 --> 00:47:32,880
viewer now there's a<font color="#E5E5E5"> crap ton of</font>

921
00:47:31,020 --> 00:47:34,710
different event viewers because<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font>

922
00:47:32,880 --> 00:47:39,470
<font color="#E5E5E5">that audit</font><font color="#CCCCCC"> policy settings have been</font>

923
00:47:34,710 --> 00:47:43,200
<font color="#CCCCCC">enabled and under operational PowerShell</font>

924
00:47:39,470 --> 00:47:46,200
you can actually see tada<font color="#CCCCCC"> it was that</font>

925
00:47:43,200 --> 00:47:48,600
bloodhound script was run and you can

926
00:47:46,200 --> 00:47:51,120
alert on<font color="#E5E5E5"> whatever you want you can</font><font color="#CCCCCC"> alert</font>

927
00:47:48,600 --> 00:47:54,630
on super long PowerShell commands being

928
00:47:51,120 --> 00:47:56,339
run you can alert on<font color="#E5E5E5"> WM</font><font color="#CCCCCC"> no really</font>

929
00:47:54,630 --> 00:48:02,610
<font color="#E5E5E5">anything that you that you want that you</font>

930
00:47:56,340 --> 00:48:02,970
<font color="#CCCCCC">think</font><font color="#E5E5E5"> might</font><font color="#CCCCCC"> be an issue for this oh for</font>

931
00:48:02,610 --> 00:48:06,800
me

932
00:48:02,970 --> 00:48:06,799
I don't do<font color="#E5E5E5"> power sell stuff anymore oh</font>

933
00:48:14,990 --> 00:48:23,479
really<font color="#CCCCCC"> first three right it's did it</font>

934
00:48:19,950 --> 00:48:23,480
start<font color="#E5E5E5"> it three yeah</font>

935
00:48:24,640 --> 00:48:29,830
<font color="#E5E5E5">okay so where's my mouse</font>

936
00:48:36,720 --> 00:48:44,640
<font color="#E5E5E5">okay so we're</font><font color="#CCCCCC"> at weaponization</font><font color="#E5E5E5"> how much</font>

937
00:48:40,589 --> 00:48:46,740
time<font color="#E5E5E5"> we get I'll just run through this</font>

938
00:48:44,640 --> 00:48:49,049
real quick<font color="#E5E5E5"> so the most</font><font color="#CCCCCC"> common thing you</font>

939
00:48:46,740 --> 00:48:51,990
can do at this point<font color="#E5E5E5"> is</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> application</font>

940
00:48:49,050 --> 00:48:53,400
whitelisting<font color="#E5E5E5"> well some people try and do</font>

941
00:48:51,990 --> 00:48:54,540
<font color="#CCCCCC">blacklisting not only with their</font>

942
00:48:53,400 --> 00:48:56,609
<font color="#E5E5E5">applications but</font><font color="#CCCCCC"> also with their</font>

943
00:48:54,540 --> 00:48:58,680
<font color="#E5E5E5">firewalls and say I just don't want</font>

944
00:48:56,609 --> 00:49:00,328
these<font color="#E5E5E5"> five things to work and that's</font>

945
00:48:58,680 --> 00:49:03,180
horrible<font color="#E5E5E5"> idea because then everything</font>

946
00:49:00,329 --> 00:49:08,910
else<font color="#E5E5E5"> bill just had a very frustrating</font>

947
00:49:03,180 --> 00:49:09,750
conversation<font color="#CCCCCC"> with customers exploitation</font>

948
00:49:08,910 --> 00:49:12,180
phase that's<font color="#CCCCCC"> where all the action</font>

949
00:49:09,750 --> 00:49:15,270
<font color="#CCCCCC">happens</font><font color="#E5E5E5"> things like me me cats</font><font color="#CCCCCC"> pass the</font>

950
00:49:12,180 --> 00:49:16,710
<font color="#CCCCCC">Hat pass the hash</font><font color="#E5E5E5"> stickykeys credentials</font>

951
00:49:15,270 --> 00:49:19,800
<font color="#E5E5E5">being harvested all that kind of stuff</font>

952
00:49:16,710 --> 00:49:21,210
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> pull it out</font><font color="#CCCCCC"> of memory and that's</font>

953
00:49:19,800 --> 00:49:24,480
a big<font color="#E5E5E5"> chunk of the stuff that</font><font color="#CCCCCC"> we have to</font>

954
00:49:21,210 --> 00:49:26,400
try<font color="#E5E5E5"> and defend against the primary</font>

955
00:49:24,480 --> 00:49:28,560
<font color="#E5E5E5">defense against me being</font><font color="#CCCCCC"> me me cats and</font>

956
00:49:26,400 --> 00:49:31,230
other privilege escalation is limiting

957
00:49:28,560 --> 00:49:34,770
who has<font color="#E5E5E5"> local admin and who logged on</font>

958
00:49:31,230 --> 00:49:36,630
with<font color="#E5E5E5"> admin to all of the things a couple</font>

959
00:49:34,770 --> 00:49:38,040
<font color="#E5E5E5">of the things that you can look into SMB</font>

960
00:49:36,630 --> 00:49:40,700
signing

961
00:49:38,040 --> 00:49:43,170
<font color="#E5E5E5">I lost my mouse again there you</font>

962
00:49:40,700 --> 00:49:46,020
<font color="#E5E5E5">privileged access workstations are also</font>

963
00:49:43,170 --> 00:49:47,609
called jump boxes<font color="#E5E5E5"> right so I don't</font><font color="#CCCCCC"> want</font>

964
00:49:46,020 --> 00:49:49,890
<font color="#CCCCCC">everybody</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to ask this</font><font color="#CCCCCC"> h2 all</font>

965
00:49:47,609 --> 00:49:51,720
my switches<font color="#E5E5E5"> I just want this</font><font color="#CCCCCC"> one box</font><font color="#E5E5E5"> to</font>

966
00:49:49,890 --> 00:49:53,160
be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> SSH to my switches and that's</font>

967
00:49:51,720 --> 00:49:55,828
the one<font color="#E5E5E5"> that my admins are</font><font color="#CCCCCC"> allowed along</font>

968
00:49:53,160 --> 00:49:58,200
<font color="#E5E5E5">into you didn't lock that stuff down a</font>

969
00:49:55,829 --> 00:50:01,040
lot more<font color="#CCCCCC"> do a lot more segmentation to</font>

970
00:49:58,200 --> 00:50:04,379
kind of protect against<font color="#E5E5E5"> this phase</font>

971
00:50:01,040 --> 00:50:07,170
another<font color="#E5E5E5"> thing called</font><font color="#CCCCCC"> laps which is the</font>

972
00:50:04,380 --> 00:50:10,760
picture<font color="#E5E5E5"> it's the local admin password</font>

973
00:50:07,170 --> 00:50:13,349
solution I've never had anybody ever

974
00:50:10,760 --> 00:50:16,589
<font color="#E5E5E5">actually implement this but what it does</font>

975
00:50:13,349 --> 00:50:18,720
is it actually changes automatically all

976
00:50:16,589 --> 00:50:22,500
of the<font color="#E5E5E5"> local admin passwords on the</font>

977
00:50:18,720 --> 00:50:26,009
<font color="#E5E5E5">domain it's just a random string that</font>

978
00:50:22,500 --> 00:50:28,680
way once an attacker<font color="#E5E5E5"> has a hash and a</font>

979
00:50:26,010 --> 00:50:31,230
<font color="#E5E5E5">username for one box they</font><font color="#CCCCCC"> can now not</font>

980
00:50:28,680 --> 00:50:33,149
use that<font color="#E5E5E5"> on the rest of them because of</font>

981
00:50:31,230 --> 00:50:35,810
very large<font color="#E5E5E5"> theme and enterprises is</font>

982
00:50:33,150 --> 00:50:38,970
they'll<font color="#CCCCCC"> just image a workstation</font><font color="#E5E5E5"> and</font>

983
00:50:35,810 --> 00:50:41,730
that admin and password is the<font color="#E5E5E5"> same</font>

984
00:50:38,970 --> 00:50:48,839
<font color="#E5E5E5">across everything</font>

985
00:50:41,730 --> 00:50:50,490
yes it's a gigantic pain things to note

986
00:50:48,840 --> 00:50:54,030
when<font color="#E5E5E5"> using laps that I did not know</font>

987
00:50:50,490 --> 00:50:56,580
until I actually implemented<font color="#E5E5E5"> it once</font><font color="#CCCCCC"> is</font>

988
00:50:54,030 --> 00:50:59,370
<font color="#E5E5E5">that it will change your domain admin</font>

989
00:50:56,580 --> 00:51:02,430
username and password<font color="#E5E5E5"> so thank God</font><font color="#CCCCCC"> I had</font>

990
00:50:59,370 --> 00:51:06,630
<font color="#E5E5E5">VM backups because</font><font color="#CCCCCC"> I could no longer log</font>

991
00:51:02,430 --> 00:51:09,149
in<font color="#E5E5E5"> anymore and then we run</font><font color="#CCCCCC"> do set</font><font color="#E5E5E5"> one</font>

992
00:51:06,630 --> 00:51:11,730
which we<font color="#E5E5E5"> are going to skip because</font><font color="#CCCCCC"> it's</font>

993
00:51:09,150 --> 00:51:13,470
<font color="#E5E5E5">12 o'clock and I'll just go past all</font>

994
00:51:11,730 --> 00:51:17,190
this stuff and if you guys want<font color="#E5E5E5"> it later</font>

995
00:51:13,470 --> 00:51:18,359
you can<font color="#E5E5E5"> have it table tops blah blah</font>

996
00:51:17,190 --> 00:51:23,310
blah and then<font color="#E5E5E5"> that's me</font>

997
00:51:18,360 --> 00:51:24,380
I'm Amanda<font color="#CCCCCC"> listen to my podcast buy my</font>

998
00:51:23,310 --> 00:51:33,180
book

999
00:51:24,380 --> 00:51:37,350
follow me<font color="#E5E5E5"> on Twitter yes bill once I</font>

1000
00:51:33,180 --> 00:51:40,649
<font color="#CCCCCC">finished them yes I'm writing</font><font color="#E5E5E5"> a bunch of</font>

1001
00:51:37,350 --> 00:51:42,540
table tops for<font color="#CCCCCC"> thanks so what's my next</font>

1002
00:51:40,650 --> 00:51:43,980
project<font color="#E5E5E5"> any questions</font><font color="#CCCCCC"> I know I went</font>

1003
00:51:42,540 --> 00:51:51,660
through<font color="#CCCCCC"> crap down</font><font color="#E5E5E5"> the stuff and also</font>

1004
00:51:43,980 --> 00:51:53,070
<font color="#E5E5E5">skipped a lot yes bill all the</font><font color="#CCCCCC"> stuff we</font>

1005
00:51:51,660 --> 00:51:54,990
cut yes it<font color="#CCCCCC"> will all the stuff</font><font color="#E5E5E5"> we cover</font>

1006
00:51:53,070 --> 00:51:59,150
<font color="#E5E5E5">will</font><font color="#CCCCCC"> we're kind of Mac it will work on</font>

1007
00:51:54,990 --> 00:51:59,149
<font color="#CCCCCC">your Apple</font><font color="#E5E5E5"> Active Directory server</font>

1008
00:52:03,830 --> 00:52:07,310
<font color="#E5E5E5">alright well thank you</font>

