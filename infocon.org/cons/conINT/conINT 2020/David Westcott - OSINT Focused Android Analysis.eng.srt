1
00:00:04,880 --> 00:00:07,040
good morning everyone good afternoon

2
00:00:07,040 --> 00:00:08,000
good evening

3
00:00:08,000 --> 00:00:10,480
wherever you are in the world welcome to

4
00:00:10,480 --> 00:00:11,599
track three

5
00:00:11,599 --> 00:00:14,160
i'm very excited to be kicking off track

6
00:00:14,160 --> 00:00:16,800
three as one of your mc's

7
00:00:16,800 --> 00:00:19,199
to start off i'll introduce myself give

8
00:00:19,199 --> 00:00:20,640
you a little bit of background

9
00:00:20,640 --> 00:00:23,039
my name is adrienne corn also known as

10
00:00:23,039 --> 00:00:24,480
ak47 intel

11
00:00:24,480 --> 00:00:26,560
you can find me various discord slacks

12
00:00:26,560 --> 00:00:28,720
twitter by that handle

13
00:00:28,720 --> 00:00:30,800
i'm one of your content organizers for

14
00:00:30,800 --> 00:00:33,760
today and i'm also the director of ocean

15
00:00:33,760 --> 00:00:36,880
operations at trace labs i'm also joined

16
00:00:36,880 --> 00:00:37,760
today by

17
00:00:37,760 --> 00:00:40,640
our second mc for track three james

18
00:00:40,640 --> 00:00:41,600
leolius

19
00:00:41,600 --> 00:00:44,160
also known as blackbeard and we also

20
00:00:44,160 --> 00:00:45,360
have andrew nolan

21
00:00:45,360 --> 00:00:47,600
also known as zoomer another one of our

22
00:00:47,600 --> 00:00:49,039
content organizers

23
00:00:49,039 --> 00:00:50,879
manning all the backhand logistics for a

24
00:00:50,879 --> 00:00:52,719
track three and really the whole

25
00:00:52,719 --> 00:00:55,039
conference actually i should mention

26
00:00:55,039 --> 00:00:56,879
um so before we get started with our

27
00:00:56,879 --> 00:00:58,879
first speaker here david westcott

28
00:00:58,879 --> 00:01:01,120
um i want to take a moment to give a

29
00:01:01,120 --> 00:01:03,199
little bit of background on trace labs

30
00:01:03,199 --> 00:01:04,640
in our mission um

31
00:01:04,640 --> 00:01:07,040
as one of the main missions of content

32
00:01:07,040 --> 00:01:07,760
today

33
00:01:07,760 --> 00:01:10,640
is to support uh trace labs and also a

34
00:01:10,640 --> 00:01:12,080
national child protection task

35
00:01:12,080 --> 00:01:14,720
force so trace labs for those of you who

36
00:01:14,720 --> 00:01:15,520
don't know

37
00:01:15,520 --> 00:01:18,080
we are a not-for-profit organization

38
00:01:18,080 --> 00:01:20,240
based on canada but we operate around

39
00:01:20,240 --> 00:01:21,600
the world

40
00:01:21,600 --> 00:01:23,840
our mission is really to crowdsource

41
00:01:23,840 --> 00:01:25,680
open source intelligence

42
00:01:25,680 --> 00:01:27,920
to assist law enforcement with a variety

43
00:01:27,920 --> 00:01:29,680
of missing persons cases

44
00:01:29,680 --> 00:01:31,840
around the world so we leveraged

45
00:01:31,840 --> 00:01:33,439
crowdsourcing to

46
00:01:33,439 --> 00:01:35,439
get volunteers to essentially conduct

47
00:01:35,439 --> 00:01:38,320
these open investigations on these

48
00:01:38,320 --> 00:01:40,880
real missing persons cases and then we

49
00:01:40,880 --> 00:01:42,799
crowdsource all those leads

50
00:01:42,799 --> 00:01:45,759
put them into a report uh summarize them

51
00:01:45,759 --> 00:01:47,360
and provide that to law enforcement so

52
00:01:47,360 --> 00:01:48,880
they can have some actionable

53
00:01:48,880 --> 00:01:51,360
intelligence there if you're interested

54
00:01:51,360 --> 00:01:52,240
in learning more

55
00:01:52,240 --> 00:01:54,399
highly recommend you join us tomorrow on

56
00:01:54,399 --> 00:01:55,600
sunday for

57
00:01:55,600 --> 00:01:57,840
the ocean search party ctf we're going

58
00:01:57,840 --> 00:01:58,799
to be running

59
00:01:58,799 --> 00:02:01,119
uh we'll have a more in-depth background

60
00:02:01,119 --> 00:02:02,719
there on trace labs as well

61
00:02:02,719 --> 00:02:05,759
so hope to see many of you there

62
00:02:05,759 --> 00:02:07,759
so to get started with our first talk

63
00:02:07,759 --> 00:02:09,679
i'm very excited to introduce our first

64
00:02:09,679 --> 00:02:11,520
speaker for track three

65
00:02:11,520 --> 00:02:14,400
david westcott david is an information

66
00:02:14,400 --> 00:02:16,239
security professional with over

67
00:02:16,239 --> 00:02:18,879
13 years of experience in a variety of

68
00:02:18,879 --> 00:02:20,640
security disciplines

69
00:02:20,640 --> 00:02:22,879
and really his main areas of focus have

70
00:02:22,879 --> 00:02:24,000
been on

71
00:02:24,000 --> 00:02:27,200
ocean digital forensics incident

72
00:02:27,200 --> 00:02:28,400
response

73
00:02:28,400 --> 00:02:30,720
android application analysis and also

74
00:02:30,720 --> 00:02:33,120
building linux distributions

75
00:02:33,120 --> 00:02:35,599
today david will be sharing his talk

76
00:02:35,599 --> 00:02:36,560
osint focus

77
00:02:36,560 --> 00:02:39,440
android analysis with us and in this

78
00:02:39,440 --> 00:02:41,360
talk you will be covering

79
00:02:41,360 --> 00:02:44,400
an outline of the basic breakdown of

80
00:02:44,400 --> 00:02:46,720
what is an android application we'll

81
00:02:46,720 --> 00:02:48,879
also be highlighting some primary pivot

82
00:02:48,879 --> 00:02:49,360
points

83
00:02:49,360 --> 00:02:51,760
that can be derived from analysis and

84
00:02:51,760 --> 00:02:53,040
then you'll be stepping through an

85
00:02:53,040 --> 00:02:55,440
example of an android application

86
00:02:55,440 --> 00:02:58,480
investigation so with that i'd like to

87
00:02:58,480 --> 00:02:58,800
give

88
00:02:58,800 --> 00:03:01,440
david a warm content welcome and we'll

89
00:03:01,440 --> 00:03:03,920
be passing over to virtual stage to him

90
00:03:03,920 --> 00:03:04,400
so

91
00:03:04,400 --> 00:03:07,280
david the stage is all yours hey thanks

92
00:03:07,280 --> 00:03:08,400
for that intro

93
00:03:08,400 --> 00:03:11,040
um so today i'm going to be covering

94
00:03:11,040 --> 00:03:14,400
ocean focused android analysis

95
00:03:14,400 --> 00:03:17,120
so as was already alluded to in my bio

96
00:03:17,120 --> 00:03:19,440
my primary areas of focus are ocean

97
00:03:19,440 --> 00:03:22,159
differ android and building linux

98
00:03:22,159 --> 00:03:23,760
distributions

99
00:03:23,760 --> 00:03:25,920
some of them you might have used boost

100
00:03:25,920 --> 00:03:27,840
gador and remnecks

101
00:03:27,840 --> 00:03:29,920
right now for day job i'm presently

102
00:03:29,920 --> 00:03:33,440
focused on incident response

103
00:03:33,440 --> 00:03:35,760
so just to highlight what this talk is

104
00:03:35,760 --> 00:03:36,959
and what it's not

105
00:03:36,959 --> 00:03:39,760
um this is a talk covering basic android

106
00:03:39,760 --> 00:03:41,599
analysis concepts

107
00:03:41,599 --> 00:03:43,680
an ocean focused approach to android

108
00:03:43,680 --> 00:03:46,239
investigations so we'll be using pivots

109
00:03:46,239 --> 00:03:48,159
you all are used to

110
00:03:48,159 --> 00:03:49,440
deriving from other types of

111
00:03:49,440 --> 00:03:51,280
investigations to gather more

112
00:03:51,280 --> 00:03:54,400
results contextual pivots and

113
00:03:54,400 --> 00:03:56,239
an example investigation of a google

114
00:03:56,239 --> 00:03:57,680
play application

115
00:03:57,680 --> 00:03:59,920
so what this talk is not this is not an

116
00:03:59,920 --> 00:04:01,519
expert's approach to analysis

117
00:04:01,519 --> 00:04:04,480
i'm by no means an android expert it's

118
00:04:04,480 --> 00:04:06,319
more of a hobby at this point

119
00:04:06,319 --> 00:04:08,319
it is not an introduction to android

120
00:04:08,319 --> 00:04:09,680
reverse engineering

121
00:04:09,680 --> 00:04:11,439
and it is definitely not a detailed

122
00:04:11,439 --> 00:04:14,799
explanation of android concepts

123
00:04:14,799 --> 00:04:16,238
so just to highlight what we're going to

124
00:04:16,238 --> 00:04:17,839
be talking about

125
00:04:17,839 --> 00:04:20,160
we're going to discuss why ocean should

126
00:04:20,160 --> 00:04:22,079
care about android

127
00:04:22,079 --> 00:04:24,400
go over why you don't need to be a

128
00:04:24,400 --> 00:04:26,080
reverse engineer to

129
00:04:26,080 --> 00:04:28,639
add this to your toolkit the breakdown

130
00:04:28,639 --> 00:04:30,639
of an android application

131
00:04:30,639 --> 00:04:32,479
and then some of the pivots you all are

132
00:04:32,479 --> 00:04:34,400
used to using infrastructure

133
00:04:34,400 --> 00:04:37,840
email addresses names locations

134
00:04:37,840 --> 00:04:39,600
some other fun stuff and then we're

135
00:04:39,600 --> 00:04:42,080
going to apply all of that in an example

136
00:04:42,080 --> 00:04:43,520
investigation

137
00:04:43,520 --> 00:04:45,440
of a lovely app that's presently in the

138
00:04:45,440 --> 00:04:48,240
google play store

139
00:04:48,240 --> 00:04:50,400
so i just want to highlight why you

140
00:04:50,400 --> 00:04:51,919
should care about android

141
00:04:51,919 --> 00:04:54,560
if you're doing ocean a lot of people

142
00:04:54,560 --> 00:04:56,479
still approach this as sort of a

143
00:04:56,479 --> 00:05:00,080
niche analysis concept they don't dive

144
00:05:00,080 --> 00:05:01,759
into it too much

145
00:05:01,759 --> 00:05:04,160
but there's so much data that's freely

146
00:05:04,160 --> 00:05:05,600
available for android

147
00:05:05,600 --> 00:05:07,280
and we'll go over some of those sources

148
00:05:07,280 --> 00:05:08,639
at the end

149
00:05:08,639 --> 00:05:10,960
a very few people are taking it on even

150
00:05:10,960 --> 00:05:12,960
in the professional vendor space

151
00:05:12,960 --> 00:05:16,479
apk analysis and android arm analysis is

152
00:05:16,479 --> 00:05:18,400
very rarely done

153
00:05:18,400 --> 00:05:20,479
most places generally only have a team

154
00:05:20,479 --> 00:05:21,919
of three to four people

155
00:05:21,919 --> 00:05:24,160
unless they're a vendor that specializes

156
00:05:24,160 --> 00:05:25,919
in the protection of android

157
00:05:25,919 --> 00:05:28,160
there's a very low barrier to entry

158
00:05:28,160 --> 00:05:30,240
versus other analysis

159
00:05:30,240 --> 00:05:33,520
so pel maco and all that stuff are way

160
00:05:33,520 --> 00:05:35,199
more complicated

161
00:05:35,199 --> 00:05:37,280
involve way more background information

162
00:05:37,280 --> 00:05:39,520
before you can even take them on

163
00:05:39,520 --> 00:05:42,080
from an investigator's perspective if

164
00:05:42,080 --> 00:05:44,240
you are going after a specified target

165
00:05:44,240 --> 00:05:45,520
or an hvt

166
00:05:45,520 --> 00:05:48,000
there is a 50 50 chance based on market

167
00:05:48,000 --> 00:05:50,080
share that your target will be using it

168
00:05:50,080 --> 00:05:53,120
and it's even more of a likelihood if

169
00:05:53,120 --> 00:05:55,280
that person's doing nefarious stuff

170
00:05:55,280 --> 00:05:58,160
um burners that are macs or apple

171
00:05:58,160 --> 00:05:58,800
devices

172
00:05:58,800 --> 00:06:00,880
are much more expensive especially if

173
00:06:00,880 --> 00:06:02,240
you're only going to utilize them for a

174
00:06:02,240 --> 00:06:04,080
specific purpose

175
00:06:04,080 --> 00:06:05,759
it improves your overall analytical

176
00:06:05,759 --> 00:06:08,080
capabilities any toolkit

177
00:06:08,080 --> 00:06:11,039
or tool set that you add to what you

178
00:06:11,039 --> 00:06:11,440
know

179
00:06:11,440 --> 00:06:14,720
as an ocean investigator or cti analyst

180
00:06:14,720 --> 00:06:16,400
or anything like that

181
00:06:16,400 --> 00:06:17,919
it's going to make you approach things

182
00:06:17,919 --> 00:06:19,680
differently regardless of what it is

183
00:06:19,680 --> 00:06:20,960
you're looking at

184
00:06:20,960 --> 00:06:23,520
and most importantly there are so many

185
00:06:23,520 --> 00:06:24,479
different pivots

186
00:06:24,479 --> 00:06:26,560
that will be going over that you can

187
00:06:26,560 --> 00:06:27,919
utilize

188
00:06:27,919 --> 00:06:31,359
without even being an re

189
00:06:31,919 --> 00:06:35,120
so here's my very fun slide

190
00:06:35,120 --> 00:06:38,080
um just going over you don't need to be

191
00:06:38,080 --> 00:06:39,360
a reverse engineer

192
00:06:39,360 --> 00:06:42,560
by any means um an apk is essentially

193
00:06:42,560 --> 00:06:45,039
a compressed file format that has a

194
00:06:45,039 --> 00:06:46,720
whole bunch of java kotlin or c

195
00:06:46,720 --> 00:06:50,080
plus plus in it um there are bunches

196
00:06:50,080 --> 00:06:53,039
and bunches of free tools there are

197
00:06:53,039 --> 00:06:53,840
obviously

198
00:06:53,840 --> 00:06:55,120
like with anything else there are

199
00:06:55,120 --> 00:06:56,880
professional tools for reverse

200
00:06:56,880 --> 00:06:57,680
engineering

201
00:06:57,680 --> 00:07:01,280
apks but from an ocean perspective

202
00:07:01,280 --> 00:07:04,319
you probably won't require those

203
00:07:04,319 --> 00:07:06,080
and that's where the dynamic execution

204
00:07:06,080 --> 00:07:07,840
comes in there are a bunch of free

205
00:07:07,840 --> 00:07:09,199
sandboxes

206
00:07:09,199 --> 00:07:12,080
ways to dynamically execute applications

207
00:07:12,080 --> 00:07:14,720
for complete free

208
00:07:14,720 --> 00:07:18,160
by people that that have them on github

209
00:07:18,160 --> 00:07:19,680
freely available for you and a lot of

210
00:07:19,680 --> 00:07:21,680
them are very well supported

211
00:07:21,680 --> 00:07:23,440
and most importantly you don't need to

212
00:07:23,440 --> 00:07:25,919
do full reverse engineering

213
00:07:25,919 --> 00:07:28,240
of a given application to gain insight

214
00:07:28,240 --> 00:07:29,599
about what it's doing

215
00:07:29,599 --> 00:07:33,199
who made it and what their targets are

216
00:07:33,440 --> 00:07:35,440
so here's a quick breakdown of an

217
00:07:35,440 --> 00:07:36,880
android application

218
00:07:36,880 --> 00:07:39,120
i tried to make this as visually

219
00:07:39,120 --> 00:07:40,639
appealing as possible

220
00:07:40,639 --> 00:07:43,440
and then the colors sort of uh showed up

221
00:07:43,440 --> 00:07:44,479
this way

222
00:07:44,479 --> 00:07:46,319
so at the top we have the android

223
00:07:46,319 --> 00:07:48,479
package so the android package if you've

224
00:07:48,479 --> 00:07:49,520
ever looked

225
00:07:49,520 --> 00:07:51,280
at an android application is probably

226
00:07:51,280 --> 00:07:53,120
what you're used to seeing it uses the

227
00:07:53,120 --> 00:07:55,199
apk extension

228
00:07:55,199 --> 00:07:57,520
once you decompress that you have all

229
00:07:57,520 --> 00:07:59,440
the goodies inside so there's the delvik

230
00:07:59,440 --> 00:08:00,560
executable

231
00:08:00,560 --> 00:08:02,199
which is generally represented as a

232
00:08:02,199 --> 00:08:04,080
classes.txt file

233
00:08:04,080 --> 00:08:06,240
and then within the classes.txt file are

234
00:08:06,240 --> 00:08:07,680
the actual classes

235
00:08:07,680 --> 00:08:10,080
of the application sometimes called the

236
00:08:10,080 --> 00:08:10,879
source code

237
00:08:10,879 --> 00:08:12,479
of the application and it's pretty high

238
00:08:12,479 --> 00:08:14,800
level java for the most part

239
00:08:14,800 --> 00:08:17,039
there's also the assets folder so the

240
00:08:17,039 --> 00:08:18,080
assets folder

241
00:08:18,080 --> 00:08:20,240
is anytime you want to bundle a file or

242
00:08:20,240 --> 00:08:22,560
a library or a configuration file

243
00:08:22,560 --> 00:08:24,800
you just put it in a folder for the most

244
00:08:24,800 --> 00:08:26,400
part they're unencrypted

245
00:08:26,400 --> 00:08:28,160
they're not obfuscated unless you're

246
00:08:28,160 --> 00:08:30,720
looking at malware a lot of times

247
00:08:30,720 --> 00:08:33,120
and then you also have icons and images

248
00:08:33,120 --> 00:08:34,320
shared libraries

249
00:08:34,320 --> 00:08:37,440
generally represented as a so file it's

250
00:08:37,440 --> 00:08:37,919
an l

251
00:08:37,919 --> 00:08:41,120
file primarily targeting arm the signing

252
00:08:41,120 --> 00:08:42,958
certificate

253
00:08:42,958 --> 00:08:44,320
what we'll find out later in this

254
00:08:44,320 --> 00:08:46,320
presentation is you can use a generic

255
00:08:46,320 --> 00:08:47,680
signing certificate

256
00:08:47,680 --> 00:08:49,279
and be very successful in the google

257
00:08:49,279 --> 00:08:51,519
play store and make a lot of money

258
00:08:51,519 --> 00:08:54,560
it does not have to be named you can do

259
00:08:54,560 --> 00:08:56,959
this for free in android studio

260
00:08:56,959 --> 00:09:00,160
and it'll create a new one every time

261
00:09:00,160 --> 00:09:01,920
if you've ever looked at sort of a

262
00:09:01,920 --> 00:09:04,399
report either in buyer's total or cudios

263
00:09:04,399 --> 00:09:04,800
or

264
00:09:04,800 --> 00:09:07,600
apk lab or anything like that you've

265
00:09:07,600 --> 00:09:09,440
probably noticed they break down things

266
00:09:09,440 --> 00:09:10,399
from

267
00:09:10,399 --> 00:09:12,160
the android manifest the android

268
00:09:12,160 --> 00:09:14,080
manifest

269
00:09:14,080 --> 00:09:17,760
comprises activities services receivers

270
00:09:17,760 --> 00:09:19,920
permissions application names and

271
00:09:19,920 --> 00:09:21,360
package names

272
00:09:21,360 --> 00:09:23,279
all of which are very good resources if

273
00:09:23,279 --> 00:09:24,480
you're trying to figure out what

274
00:09:24,480 --> 00:09:25,760
something does

275
00:09:25,760 --> 00:09:27,360
who they're targeting and what the

276
00:09:27,360 --> 00:09:29,680
expectation from the developer is

277
00:09:29,680 --> 00:09:31,839
about what the app is going to do and

278
00:09:31,839 --> 00:09:33,440
then there's the miscellaneous stuff

279
00:09:33,440 --> 00:09:35,279
that you'll use from an re in an ocean

280
00:09:35,279 --> 00:09:36,399
perspective

281
00:09:36,399 --> 00:09:39,279
what they use to compile it target sdk

282
00:09:39,279 --> 00:09:41,279
or target android version

283
00:09:41,279 --> 00:09:43,600
and the target demographic so a lot of

284
00:09:43,600 --> 00:09:45,279
times the target demographic can be

285
00:09:45,279 --> 00:09:46,160
derived

286
00:09:46,160 --> 00:09:48,560
either from what application it is or

287
00:09:48,560 --> 00:09:50,240
it's trying to impersonate

288
00:09:50,240 --> 00:09:55,040
what language all the prompts are in etc

289
00:09:55,839 --> 00:09:57,279
so the first section i wanted to

290
00:09:57,279 --> 00:09:59,360
highlight and sort of the way i break

291
00:09:59,360 --> 00:10:01,440
down each one of these slides specific

292
00:10:01,440 --> 00:10:02,480
to

293
00:10:02,480 --> 00:10:05,519
the overarching out workflow that we

294
00:10:05,519 --> 00:10:06,720
just

295
00:10:06,720 --> 00:10:10,320
did is the the name size modification

296
00:10:10,320 --> 00:10:10,959
time

297
00:10:10,959 --> 00:10:12,720
and hash are going to be pretty

298
00:10:12,720 --> 00:10:14,160
consistent for the

299
00:10:14,160 --> 00:10:18,480
overlay files so the apk the libso

300
00:10:18,480 --> 00:10:20,800
and the dex file itself are generally

301
00:10:20,800 --> 00:10:22,240
going to have all of those so you might

302
00:10:22,240 --> 00:10:22,720
notice

303
00:10:22,720 --> 00:10:24,880
in all the slides following this one

304
00:10:24,880 --> 00:10:26,399
those are the main things that we go

305
00:10:26,399 --> 00:10:27,440
over

306
00:10:27,440 --> 00:10:29,440
but the contents and the previous

307
00:10:29,440 --> 00:10:30,959
versions i feel

308
00:10:30,959 --> 00:10:32,880
are often left out in either a lot of

309
00:10:32,880 --> 00:10:34,399
the re reports

310
00:10:34,399 --> 00:10:38,160
or someone sharing the file on twitter

311
00:10:38,160 --> 00:10:39,760
and that's really important because a

312
00:10:39,760 --> 00:10:41,200
lot of stuff either in the google play

313
00:10:41,200 --> 00:10:43,200
store or from a malicious context

314
00:10:43,200 --> 00:10:45,360
is going to have previous versions and

315
00:10:45,360 --> 00:10:47,279
that's when the developers usually mess

316
00:10:47,279 --> 00:10:47,519
up

317
00:10:47,519 --> 00:10:50,320
they'll either have the apk reaching out

318
00:10:50,320 --> 00:10:52,480
to previously hosted infrastructure

319
00:10:52,480 --> 00:10:54,800
they'll leave their name in a compiled

320
00:10:54,800 --> 00:10:56,000
seo file

321
00:10:56,000 --> 00:10:58,480
etc

322
00:10:59,040 --> 00:11:01,279
so the dalvik executable uh you might

323
00:11:01,279 --> 00:11:02,959
notice i left name off

324
00:11:02,959 --> 00:11:05,839
the name of the file is very generically

325
00:11:05,839 --> 00:11:07,519
just classes.dex

326
00:11:07,519 --> 00:11:10,800
so depending on how complex the apk is

327
00:11:10,800 --> 00:11:13,519
you might actually have two three four

328
00:11:13,519 --> 00:11:14,079
of these

329
00:11:14,079 --> 00:11:15,920
and they're all referenced individually

330
00:11:15,920 --> 00:11:17,200
but for the most part

331
00:11:17,200 --> 00:11:20,480
simple apks especially like the one

332
00:11:20,480 --> 00:11:21,600
we're going to be looking at

333
00:11:21,600 --> 00:11:23,839
are really small just have a single

334
00:11:23,839 --> 00:11:25,360
classes file

335
00:11:25,360 --> 00:11:27,200
and they're often reused so if you're

336
00:11:27,200 --> 00:11:28,720
looking at a malicious builder

337
00:11:28,720 --> 00:11:30,800
often what they'll do is they will

338
00:11:30,800 --> 00:11:32,480
package the application using a

339
00:11:32,480 --> 00:11:34,480
different application name different apk

340
00:11:34,480 --> 00:11:35,120
name

341
00:11:35,120 --> 00:11:37,360
different pictures but they're really

342
00:11:37,360 --> 00:11:38,240
lazily just

343
00:11:38,240 --> 00:11:41,360
reuse the same classes.dex file and

344
00:11:41,360 --> 00:11:42,000
that's really

345
00:11:42,000 --> 00:11:44,000
easy to pivot from because the hash will

346
00:11:44,000 --> 00:11:45,920
be the same and often the

347
00:11:45,920 --> 00:11:47,920
contents and the modification time will

348
00:11:47,920 --> 00:11:50,480
be similar

349
00:11:50,480 --> 00:11:52,240
and then within the classes this is

350
00:11:52,240 --> 00:11:54,160
where a lot of the source code and a lot

351
00:11:54,160 --> 00:11:56,720
of developers mess up is they will

352
00:11:56,720 --> 00:11:58,160
actually go out and

353
00:11:58,160 --> 00:11:59,440
they'll have a generic signing

354
00:11:59,440 --> 00:12:01,680
certificate a generic email address

355
00:12:01,680 --> 00:12:03,040
associated with it

356
00:12:03,040 --> 00:12:05,760
but they'll forget to remove their their

357
00:12:05,760 --> 00:12:06,720
compile path

358
00:12:06,720 --> 00:12:10,079
from say their so or the will actually

359
00:12:10,079 --> 00:12:11,760
have their name defined within the

360
00:12:11,760 --> 00:12:13,279
variable if they're a very vain

361
00:12:13,279 --> 00:12:14,000
developer

362
00:12:14,000 --> 00:12:16,000
which happens a lot and they'll often

363
00:12:16,000 --> 00:12:17,279
reuse variable names

364
00:12:17,279 --> 00:12:18,480
especially when you get into the

365
00:12:18,480 --> 00:12:20,880
malicious context or people that are

366
00:12:20,880 --> 00:12:21,440
making

367
00:12:21,440 --> 00:12:23,360
say a bunch of vpn apps like we're going

368
00:12:23,360 --> 00:12:25,519
to be looking at shortly

369
00:12:25,519 --> 00:12:27,760
and another really important thing that

370
00:12:27,760 --> 00:12:30,079
gets left out of a lot of reports

371
00:12:30,079 --> 00:12:34,000
is code originality and strings so

372
00:12:34,000 --> 00:12:36,399
android studio has a very useful

373
00:12:36,399 --> 00:12:38,240
analysis capability where it will look

374
00:12:38,240 --> 00:12:39,440
for typos

375
00:12:39,440 --> 00:12:40,959
within the source code of a given

376
00:12:40,959 --> 00:12:43,120
application and then you can compare

377
00:12:43,120 --> 00:12:45,760
those typos to a previous apk

378
00:12:45,760 --> 00:12:47,680
so especially when you're looking at a

379
00:12:47,680 --> 00:12:49,920
lot of non-english developers targeting

380
00:12:49,920 --> 00:12:52,399
an english demographic they will often

381
00:12:52,399 --> 00:12:54,079
spell things incorrectly

382
00:12:54,079 --> 00:12:55,760
and they'll always spell that same thing

383
00:12:55,760 --> 00:12:57,760
incorrectly so it's a very good pivot

384
00:12:57,760 --> 00:13:00,160
when you're looking at family analysis

385
00:13:00,160 --> 00:13:03,439
or you're looking at targeting

386
00:13:03,600 --> 00:13:05,360
the primary things as we alluded to

387
00:13:05,360 --> 00:13:07,760
earlier contained within assets

388
00:13:07,760 --> 00:13:10,560
are html files encrypted content

389
00:13:10,560 --> 00:13:12,720
especially when you're looking at

390
00:13:12,720 --> 00:13:15,680
dynamic dex loading and malware families

391
00:13:15,680 --> 00:13:17,839
sometimes they include an embedded apk

392
00:13:17,839 --> 00:13:19,839
if they're too lazy to have dynamic

393
00:13:19,839 --> 00:13:20,880
decks loading

394
00:13:20,880 --> 00:13:22,480
you'll have configuration files

395
00:13:22,480 --> 00:13:24,800
configuration files are pretty standard

396
00:13:24,800 --> 00:13:26,320
especially if you're looking at things

397
00:13:26,320 --> 00:13:28,320
like vpn applications

398
00:13:28,320 --> 00:13:31,360
security applications or

399
00:13:31,360 --> 00:13:34,240
just malware in general and the etc is

400
00:13:34,240 --> 00:13:35,279
because you can put

401
00:13:35,279 --> 00:13:36,720
pretty much anything you want in this

402
00:13:36,720 --> 00:13:38,560
folder there's nothing

403
00:13:38,560 --> 00:13:41,040
within the android development guide

404
00:13:41,040 --> 00:13:41,600
that says

405
00:13:41,600 --> 00:13:43,519
you can't put something in there so

406
00:13:43,519 --> 00:13:44,880
sometimes you'll often see

407
00:13:44,880 --> 00:13:46,720
things within assets that are never

408
00:13:46,720 --> 00:13:49,199
actually used within the application

409
00:13:49,199 --> 00:13:52,560
because they'll leave it or you'll have

410
00:13:52,560 --> 00:13:53,839
someone building something and they

411
00:13:53,839 --> 00:13:55,440
don't really understand what it works

412
00:13:55,440 --> 00:13:56,320
like

413
00:13:56,320 --> 00:13:59,839
so this happens a lot when there's a

414
00:13:59,839 --> 00:14:01,040
stolen

415
00:14:01,040 --> 00:14:03,120
or an unreleased malware family of the

416
00:14:03,120 --> 00:14:04,880
source codes released you'll find people

417
00:14:04,880 --> 00:14:05,920
rebuilding it

418
00:14:05,920 --> 00:14:07,600
without realizing that a bunch of

419
00:14:07,600 --> 00:14:10,399
stuff's left over

420
00:14:10,720 --> 00:14:12,000
something that a lot of people in the

421
00:14:12,000 --> 00:14:13,839
ocean community very familiar with

422
00:14:13,839 --> 00:14:16,079
the icons and images are primarily

423
00:14:16,079 --> 00:14:17,920
contained within a res folder

424
00:14:17,920 --> 00:14:20,320
and all of those unfortunately most of

425
00:14:20,320 --> 00:14:21,440
them don't have exif

426
00:14:21,440 --> 00:14:23,680
because they're either stripped pngs or

427
00:14:23,680 --> 00:14:24,480
jpegs

428
00:14:24,480 --> 00:14:26,800
but you'll still have the size hash and

429
00:14:26,800 --> 00:14:28,320
you'll be able to do reverse image

430
00:14:28,320 --> 00:14:29,120
searches

431
00:14:29,120 --> 00:14:31,279
especially on generic icons to find

432
00:14:31,279 --> 00:14:33,040
originally where they're developed

433
00:14:33,040 --> 00:14:34,800
a lot of times people will use

434
00:14:34,800 --> 00:14:36,160
deviantart

435
00:14:36,160 --> 00:14:38,560
or five dollar stuff on fiverr to have

436
00:14:38,560 --> 00:14:40,480
someone develop a logo for them

437
00:14:40,480 --> 00:14:41,680
and then they'll use that in their

438
00:14:41,680 --> 00:14:43,519
builder and you'll be able to trace it

439
00:14:43,519 --> 00:14:44,639
back to

440
00:14:44,639 --> 00:14:46,560
who originally requested it when it was

441
00:14:46,560 --> 00:14:47,920
requested and be able to build the

442
00:14:47,920 --> 00:14:50,639
timeline that way

443
00:14:50,880 --> 00:14:52,560
the libraries this is where it gets a

444
00:14:52,560 --> 00:14:54,880
little more into actual doing reverse

445
00:14:54,880 --> 00:14:56,000
engineering

446
00:14:56,000 --> 00:14:58,720
a lot of these are l files and they're

447
00:14:58,720 --> 00:15:00,720
targeting arm

448
00:15:00,720 --> 00:15:02,639
and so with these very similar to how

449
00:15:02,639 --> 00:15:04,880
you would look at a pe or a mocko file

450
00:15:04,880 --> 00:15:06,959
you're going to be interested in the

451
00:15:06,959 --> 00:15:07,920
name

452
00:15:07,920 --> 00:15:10,959
the type of file the target so the

453
00:15:10,959 --> 00:15:14,000
target in this context is referring to

454
00:15:14,000 --> 00:15:16,320
which target arm it's looking at so if

455
00:15:16,320 --> 00:15:17,199
it's looking at

456
00:15:17,199 --> 00:15:20,079
mips if it's looking at arm 64 etc

457
00:15:20,079 --> 00:15:20,720
hashes

458
00:15:20,720 --> 00:15:23,120
size constant source the nice thing

459
00:15:23,120 --> 00:15:24,000
about this is

460
00:15:24,000 --> 00:15:27,519
virus total and similar sites have a lot

461
00:15:27,519 --> 00:15:29,199
of this information that's

462
00:15:29,199 --> 00:15:32,160
indexed and searchable so finding other

463
00:15:32,160 --> 00:15:34,480
applications that use the same so for

464
00:15:34,480 --> 00:15:35,920
example

465
00:15:35,920 --> 00:15:38,880
is very easily done and that's a good

466
00:15:38,880 --> 00:15:39,279
way

467
00:15:39,279 --> 00:15:41,440
again to see reuse and to see where

468
00:15:41,440 --> 00:15:44,320
developers mess up

469
00:15:44,480 --> 00:15:48,639
signing certificates are very generic

470
00:15:48,639 --> 00:15:50,720
this is what an example blank one looks

471
00:15:50,720 --> 00:15:53,680
like the objects highlighted in red

472
00:15:53,680 --> 00:15:56,079
are the most pivotable things within

473
00:15:56,079 --> 00:15:56,959
here

474
00:15:56,959 --> 00:16:00,160
signature algorithm the validation

475
00:16:00,160 --> 00:16:01,839
data from the timeline the algorithms

476
00:16:01,839 --> 00:16:04,079
and all that stuff are not really unique

477
00:16:04,079 --> 00:16:05,680
to a given certificate

478
00:16:05,680 --> 00:16:08,240
but the subject when it was initially

479
00:16:08,240 --> 00:16:09,040
cut

480
00:16:09,040 --> 00:16:10,959
the issuer the serial number all of

481
00:16:10,959 --> 00:16:13,360
those are pivot points that you can use

482
00:16:13,360 --> 00:16:15,759
in something like virus total from an

483
00:16:15,759 --> 00:16:18,160
android guard perspective to see

484
00:16:18,160 --> 00:16:20,720
other things using that certificate the

485
00:16:20,720 --> 00:16:22,639
one gotcha i will say with this

486
00:16:22,639 --> 00:16:25,279
is if someone's using a stolen developer

487
00:16:25,279 --> 00:16:28,000
certificate which is very very common

488
00:16:28,000 --> 00:16:29,839
with malware you'll have a generic

489
00:16:29,839 --> 00:16:31,519
google signing certificate that was

490
00:16:31,519 --> 00:16:33,040
stolen years ago

491
00:16:33,040 --> 00:16:34,800
and then thousands and thousands of

492
00:16:34,800 --> 00:16:36,880
applications are using it

493
00:16:36,880 --> 00:16:39,279
when you do your initial search it's a

494
00:16:39,279 --> 00:16:41,600
pretty safe bet that if you see over 100

495
00:16:41,600 --> 00:16:43,600
apks using the same

496
00:16:43,600 --> 00:16:45,680
certificate unless it's from a known

497
00:16:45,680 --> 00:16:46,720
builder

498
00:16:46,720 --> 00:16:51,279
it's too generic to be used as a pivot

499
00:16:51,279 --> 00:16:53,600
the activity services and receivers are

500
00:16:53,600 --> 00:16:55,279
really great for pivots because they're

501
00:16:55,279 --> 00:16:56,399
generally named

502
00:16:56,399 --> 00:16:58,480
so anything that is unique to an

503
00:16:58,480 --> 00:16:59,519
application

504
00:16:59,519 --> 00:17:01,920
that's named especially in the context

505
00:17:01,920 --> 00:17:03,600
of a string is a great pivot

506
00:17:03,600 --> 00:17:06,079
so all of these are named sometimes

507
00:17:06,079 --> 00:17:07,839
they'll call them rats sometimes they'll

508
00:17:07,839 --> 00:17:08,319
call them

509
00:17:08,319 --> 00:17:12,000
vpn and just like the source code people

510
00:17:12,000 --> 00:17:13,839
spell things wrong a lot

511
00:17:13,839 --> 00:17:16,000
or they'll reference things as a

512
00:17:16,000 --> 00:17:17,520
receiver that are specific to the

513
00:17:17,520 --> 00:17:18,240
application

514
00:17:18,240 --> 00:17:21,439
so example rat.keygen

515
00:17:21,439 --> 00:17:24,079
might be a named service and you can

516
00:17:24,079 --> 00:17:25,359
pivot off that to find

517
00:17:25,359 --> 00:17:26,799
other applications that are using the

518
00:17:26,799 --> 00:17:28,400
same thing and then

519
00:17:28,400 --> 00:17:30,320
function from a source code analysis

520
00:17:30,320 --> 00:17:32,640
perspective you can figure out what it

521
00:17:32,640 --> 00:17:34,080
does and this is where the dynamic

522
00:17:34,080 --> 00:17:35,919
sandboxes come in if you're not

523
00:17:35,919 --> 00:17:38,080
comfortable looking at it statically you

524
00:17:38,080 --> 00:17:40,160
can use a dynamic sandbox or you can use

525
00:17:40,160 --> 00:17:42,240
freda instrumentation

526
00:17:42,240 --> 00:17:45,200
to figure out what it does and do an

527
00:17:45,200 --> 00:17:46,080
activities

528
00:17:46,080 --> 00:17:47,679
search so if you're using a tool like

529
00:17:47,679 --> 00:17:49,919
mob sf it'll actually run all the

530
00:17:49,919 --> 00:17:51,440
activities for you and capture

531
00:17:51,440 --> 00:17:52,720
screenshots

532
00:17:52,720 --> 00:17:54,720
so you can see what all the workflows

533
00:17:54,720 --> 00:17:56,480
would be that are defined within the

534
00:17:56,480 --> 00:17:57,600
code without having to

535
00:17:57,600 --> 00:18:00,720
individually step through them

536
00:18:00,720 --> 00:18:02,720
and permissions this is where it gets

537
00:18:02,720 --> 00:18:04,640
really murky with android depending on

538
00:18:04,640 --> 00:18:07,200
the sdk version that it's targeting

539
00:18:07,200 --> 00:18:09,120
there are defined permissions there are

540
00:18:09,120 --> 00:18:10,400
dynamic permissions

541
00:18:10,400 --> 00:18:13,520
so with android 10 and further

542
00:18:13,520 --> 00:18:15,520
a lot of permissions are deemed to be

543
00:18:15,520 --> 00:18:18,160
restricted or dangerous permissions

544
00:18:18,160 --> 00:18:20,240
and as a result if anyone's running

545
00:18:20,240 --> 00:18:22,559
those google play will mark them off as

546
00:18:22,559 --> 00:18:24,640
malicious and possibly block them so

547
00:18:24,640 --> 00:18:26,160
what a lot of developers have started

548
00:18:26,160 --> 00:18:26,880
doing

549
00:18:26,880 --> 00:18:29,120
is they do the permissions dynamically

550
00:18:29,120 --> 00:18:30,880
once they either load a dynamic

551
00:18:30,880 --> 00:18:33,679
dex or they load a dynamic apk that's

552
00:18:33,679 --> 00:18:34,559
encrypted

553
00:18:34,559 --> 00:18:36,799
because as we'll find out google play

554
00:18:36,799 --> 00:18:38,640
does not too much verification

555
00:18:38,640 --> 00:18:40,320
on most stuff to do with things they

556
00:18:40,320 --> 00:18:42,080
host in their store even if it's a paid

557
00:18:42,080 --> 00:18:43,280
application

558
00:18:43,280 --> 00:18:45,120
and what you'll also run into sometimes

559
00:18:45,120 --> 00:18:46,880
is people define permissions that are

560
00:18:46,880 --> 00:18:49,280
not defined by the android sdk

561
00:18:49,280 --> 00:18:52,240
sometimes it's a typo sometimes it is

562
00:18:52,240 --> 00:18:54,080
something specific to the application

563
00:18:54,080 --> 00:18:55,600
where they're referencing it so

564
00:18:55,600 --> 00:18:56,000
sometimes

565
00:18:56,000 --> 00:18:58,160
you'll see this with obfuscation they'll

566
00:18:58,160 --> 00:18:59,679
call a permission

567
00:18:59,679 --> 00:19:01,840
and it won't be named until it actually

568
00:19:01,840 --> 00:19:03,840
executes what it is so for example if

569
00:19:03,840 --> 00:19:05,360
something requires

570
00:19:05,360 --> 00:19:07,919
a course permission they might not

571
00:19:07,919 --> 00:19:09,600
define it until the application actually

572
00:19:09,600 --> 00:19:10,640
runs

573
00:19:10,640 --> 00:19:12,720
and another thing you can do if you're

574
00:19:12,720 --> 00:19:14,640
getting

575
00:19:14,640 --> 00:19:17,200
really low on pivot points is you can

576
00:19:17,200 --> 00:19:18,880
look at the order in which permissions

577
00:19:18,880 --> 00:19:20,799
are defined

578
00:19:20,799 --> 00:19:22,799
i've been working a little bit on trying

579
00:19:22,799 --> 00:19:25,280
to define this as sort of an impact

580
00:19:25,280 --> 00:19:28,400
but you could take the permission order

581
00:19:28,400 --> 00:19:30,799
and you can classify it for a given app

582
00:19:30,799 --> 00:19:32,880
so they always request these permissions

583
00:19:32,880 --> 00:19:34,080
in this order

584
00:19:34,080 --> 00:19:35,919
and that's different than say the next

585
00:19:35,919 --> 00:19:38,080
app that requires the same permissions

586
00:19:38,080 --> 00:19:40,320
it's not required very often but it's a

587
00:19:40,320 --> 00:19:41,919
good thing to reference when you're

588
00:19:41,919 --> 00:19:45,360
doing an analysis of an apk

589
00:19:46,480 --> 00:19:48,240
again with an application name this is a

590
00:19:48,240 --> 00:19:50,160
string you'll see this a lot

591
00:19:50,160 --> 00:19:52,080
with malware you can make the

592
00:19:52,080 --> 00:19:54,240
application name anything you want

593
00:19:54,240 --> 00:19:56,480
it does not have to actually be that

594
00:19:56,480 --> 00:19:59,280
thing google play does a really bad

595
00:19:59,280 --> 00:20:01,120
job with impersonation you'll see this

596
00:20:01,120 --> 00:20:03,440
with a lot of phishing applications

597
00:20:03,440 --> 00:20:06,240
or people just trying to get credentials

598
00:20:06,240 --> 00:20:08,000
is you can call something say the bank

599
00:20:08,000 --> 00:20:09,919
of america application

600
00:20:09,919 --> 00:20:12,159
and then the apk reference has nothing

601
00:20:12,159 --> 00:20:13,440
to do with b of a

602
00:20:13,440 --> 00:20:15,840
they just took all of their application

603
00:20:15,840 --> 00:20:17,919
icons and their background images

604
00:20:17,919 --> 00:20:21,679
so with this uniqueness uh typos again

605
00:20:21,679 --> 00:20:24,880
happen a lot and um it doesn't have to

606
00:20:24,880 --> 00:20:25,200
do

607
00:20:25,200 --> 00:20:28,080
anything with the apk so you could call

608
00:20:28,080 --> 00:20:28,960
it

609
00:20:28,960 --> 00:20:32,640
bank america online and if you don't put

610
00:20:32,640 --> 00:20:34,320
any spaces that would be unique to the

611
00:20:34,320 --> 00:20:35,200
application

612
00:20:35,200 --> 00:20:37,120
and often especially with a builder

613
00:20:37,120 --> 00:20:38,640
depending on targeting

614
00:20:38,640 --> 00:20:40,159
this would be the same no matter what

615
00:20:40,159 --> 00:20:42,799
the apk is so where a lot of people get

616
00:20:42,799 --> 00:20:44,640
hung up and pivoting is they only rely

617
00:20:44,640 --> 00:20:46,080
on the apk name

618
00:20:46,080 --> 00:20:47,840
or they only reply on say the main

619
00:20:47,840 --> 00:20:50,159
activity name but they forget that the

620
00:20:50,159 --> 00:20:51,520
same application name

621
00:20:51,520 --> 00:20:53,200
is used and they have hundreds and

622
00:20:53,200 --> 00:20:55,600
hundreds of different apk name

623
00:20:55,600 --> 00:20:58,720
definitions but it's all the same thing

624
00:20:58,720 --> 00:21:00,880
and then from the malicious context is

625
00:21:00,880 --> 00:21:02,880
it impersonating something

626
00:21:02,880 --> 00:21:05,120
so is this going after a specific

627
00:21:05,120 --> 00:21:06,080
application

628
00:21:06,080 --> 00:21:07,840
and this is really helpful when it gets

629
00:21:07,840 --> 00:21:09,280
in the targeting of a specific

630
00:21:09,280 --> 00:21:10,559
demographic

631
00:21:10,559 --> 00:21:12,480
so especially if you're looking at

632
00:21:12,480 --> 00:21:14,080
countries like turkey

633
00:21:14,080 --> 00:21:16,960
or aipac where they use banks or

634
00:21:16,960 --> 00:21:18,640
messaging applications that you're not

635
00:21:18,640 --> 00:21:19,600
familiar with

636
00:21:19,600 --> 00:21:21,360
from an ocean perspective it's really

637
00:21:21,360 --> 00:21:23,840
good to say what is this app

638
00:21:23,840 --> 00:21:25,760
why would they create it and who are

639
00:21:25,760 --> 00:21:28,400
they targeting

640
00:21:28,799 --> 00:21:30,240
with the package name it's really

641
00:21:30,240 --> 00:21:33,280
straightforward it has a defined name

642
00:21:33,280 --> 00:21:35,039
it's good to look at what the defined

643
00:21:35,039 --> 00:21:37,120
name is not what the file is submitted

644
00:21:37,120 --> 00:21:37,520
as

645
00:21:37,520 --> 00:21:39,360
so a lot of times if especially if

646
00:21:39,360 --> 00:21:41,039
you're using virustotal

647
00:21:41,039 --> 00:21:43,200
people will often submit things as a

648
00:21:43,200 --> 00:21:44,640
different name

649
00:21:44,640 --> 00:21:46,159
but you want to actually look at the

650
00:21:46,159 --> 00:21:48,000
name defined

651
00:21:48,000 --> 00:21:49,840
within the manifest to figure out what

652
00:21:49,840 --> 00:21:51,520
it actually is

653
00:21:51,520 --> 00:21:54,159
is it associated with known malware

654
00:21:54,159 --> 00:21:57,679
again with the application impersonation

655
00:21:57,679 --> 00:22:00,000
and say like with metasploit right the

656
00:22:00,000 --> 00:22:01,919
the default metasploit package name

657
00:22:01,919 --> 00:22:03,600
is always the same regardless of the

658
00:22:03,600 --> 00:22:06,400
application name so is this apk

659
00:22:06,400 --> 00:22:08,320
tied to a known malware family what's

660
00:22:08,320 --> 00:22:10,320
the malware family is it actually that

661
00:22:10,320 --> 00:22:11,440
thing

662
00:22:11,440 --> 00:22:14,000
and then with the uniqueness just like

663
00:22:14,000 --> 00:22:15,760
application name

664
00:22:15,760 --> 00:22:18,960
a lot of times the application apk

665
00:22:18,960 --> 00:22:20,320
string identifier

666
00:22:20,320 --> 00:22:22,480
is going to be unique to the developer

667
00:22:22,480 --> 00:22:25,039
or unique to a given family

668
00:22:25,039 --> 00:22:26,960
and another one is the package versus

669
00:22:26,960 --> 00:22:28,960
main activity this is a really good way

670
00:22:28,960 --> 00:22:30,960
to determine

671
00:22:30,960 --> 00:22:33,760
if the package is actually the package

672
00:22:33,760 --> 00:22:34,480
so

673
00:22:34,480 --> 00:22:35,919
a lot of times what you'll see is

674
00:22:35,919 --> 00:22:37,919
someone will take a package from say the

675
00:22:37,919 --> 00:22:39,520
google play store

676
00:22:39,520 --> 00:22:41,600
they'll make that the name of the apk

677
00:22:41,600 --> 00:22:43,360
but the main activity is either

678
00:22:43,360 --> 00:22:46,799
an embedded apk or a lot of times it'll

679
00:22:46,799 --> 00:22:47,200
be an

680
00:22:47,200 --> 00:22:50,080
encrypted dex within the assets and it

681
00:22:50,080 --> 00:22:50,960
won't be loaded

682
00:22:50,960 --> 00:22:52,640
as the main activity until there's

683
00:22:52,640 --> 00:22:54,080
dynamic execution

684
00:22:54,080 --> 00:22:56,400
so a lot of antivirus vendors and google

685
00:22:56,400 --> 00:22:58,320
play will just look at the apk and say

686
00:22:58,320 --> 00:22:59,679
oh i know what that is

687
00:22:59,679 --> 00:23:02,080
i know what those permissions are green

688
00:23:02,080 --> 00:23:04,320
light

689
00:23:05,120 --> 00:23:06,559
so if you're really really getting in

690
00:23:06,559 --> 00:23:08,559
the weeds you can also look at the

691
00:23:08,559 --> 00:23:09,440
compile time

692
00:23:09,440 --> 00:23:11,280
and try to create a timeline of all

693
00:23:11,280 --> 00:23:12,559
package versions

694
00:23:12,559 --> 00:23:15,360
so if i'm looking at the timeline of say

695
00:23:15,360 --> 00:23:16,640
when was the first time

696
00:23:16,640 --> 00:23:19,679
this malware family or this developer

697
00:23:19,679 --> 00:23:22,080
targeting the specific application

698
00:23:22,080 --> 00:23:24,559
started working and then map out every

699
00:23:24,559 --> 00:23:25,600
version

700
00:23:25,600 --> 00:23:27,919
you can actually build out a timeline of

701
00:23:27,919 --> 00:23:29,760
developer release cycles

702
00:23:29,760 --> 00:23:31,840
you can build out of when did they start

703
00:23:31,840 --> 00:23:33,600
using a different compiler

704
00:23:33,600 --> 00:23:35,200
when did they start doing different

705
00:23:35,200 --> 00:23:37,440
versions and diffing along the way

706
00:23:37,440 --> 00:23:39,440
very similar to how you would do with

707
00:23:39,440 --> 00:23:42,159
different binary application timelining

708
00:23:42,159 --> 00:23:44,159
which compiler did they use for the most

709
00:23:44,159 --> 00:23:46,400
part unless it's in a commercial context

710
00:23:46,400 --> 00:23:49,279
this is going to be a pretty weak pivot

711
00:23:49,279 --> 00:23:50,000
but it's something

712
00:23:50,000 --> 00:23:52,640
to reference and then packing and

713
00:23:52,640 --> 00:23:53,679
encryption so

714
00:23:53,679 --> 00:23:56,559
this does not happen with a lot of the

715
00:23:56,559 --> 00:23:58,559
really lazy developers

716
00:23:58,559 --> 00:24:02,080
say subarus or anubis or any of those

717
00:24:02,080 --> 00:24:03,919
they'll actually just do the same thing

718
00:24:03,919 --> 00:24:05,360
over and over

719
00:24:05,360 --> 00:24:07,600
they'll obfuscate it in base 64 with a

720
00:24:07,600 --> 00:24:08,880
hard-coded string

721
00:24:08,880 --> 00:24:10,640
but if you start getting into the more

722
00:24:10,640 --> 00:24:12,080
advanced developers

723
00:24:12,080 --> 00:24:14,000
the staged loaders and a lot of times

724
00:24:14,000 --> 00:24:15,600
the commercial entities

725
00:24:15,600 --> 00:24:17,440
they'll either pack it or encrypt it in

726
00:24:17,440 --> 00:24:19,679
a way that makes it really annoying to

727
00:24:19,679 --> 00:24:20,559
reverse

728
00:24:20,559 --> 00:24:22,240
and the only way to actually get at the

729
00:24:22,240 --> 00:24:24,400
true apk or the true decks

730
00:24:24,400 --> 00:24:27,360
is through frida instrumentation or

731
00:24:27,360 --> 00:24:29,200
hands-on device

732
00:24:29,200 --> 00:24:31,440
but that is unique and even if you can't

733
00:24:31,440 --> 00:24:33,520
break it it might be unique to a given

734
00:24:33,520 --> 00:24:34,240
application

735
00:24:34,240 --> 00:24:36,640
and you can make note of it for the how

736
00:24:36,640 --> 00:24:40,159
the developer works and how they operate

737
00:24:40,159 --> 00:24:41,679
this is a really big one and this goes

738
00:24:41,679 --> 00:24:43,520
back to my cti days

739
00:24:43,520 --> 00:24:45,760
one thing left out of a lot of our re

740
00:24:45,760 --> 00:24:47,279
reports because they don't look at this

741
00:24:47,279 --> 00:24:48,720
from an ocean perspective and where

742
00:24:48,720 --> 00:24:50,480
ocean really shines

743
00:24:50,480 --> 00:24:53,919
is you can build out sort of a portfolio

744
00:24:53,919 --> 00:24:56,480
of who they're targeting why they're

745
00:24:56,480 --> 00:24:59,120
targeting them what language they use

746
00:24:59,120 --> 00:25:01,679
what people are involved um how they're

747
00:25:01,679 --> 00:25:03,200
sharing it so this

748
00:25:03,200 --> 00:25:05,200
especially if it's very specific

749
00:25:05,200 --> 00:25:06,320
targeting

750
00:25:06,320 --> 00:25:07,919
say for example they're only sharing it

751
00:25:07,919 --> 00:25:09,760
in a given telegram channel or they're

752
00:25:09,760 --> 00:25:11,120
sharing it in a specific

753
00:25:11,120 --> 00:25:12,480
facebook group or they're doing a

754
00:25:12,480 --> 00:25:14,320
watering hole that way

755
00:25:14,320 --> 00:25:16,240
when are they releasing it what target

756
00:25:16,240 --> 00:25:18,159
sdks are they going after

757
00:25:18,159 --> 00:25:20,000
this is really relevant because a lot of

758
00:25:20,000 --> 00:25:21,520
malicious developers

759
00:25:21,520 --> 00:25:23,840
will go after the target sdk of the

760
00:25:23,840 --> 00:25:25,520
market share for the region that they're

761
00:25:25,520 --> 00:25:26,559
going after

762
00:25:26,559 --> 00:25:28,799
market share by region is very easy to

763
00:25:28,799 --> 00:25:30,240
figure out there are a lot of places

764
00:25:30,240 --> 00:25:32,400
that keep those statistics for free

765
00:25:32,400 --> 00:25:34,080
and so they'll go to a different country

766
00:25:34,080 --> 00:25:36,080
and say what's my most common

767
00:25:36,080 --> 00:25:38,880
target sdk i'm going after because once

768
00:25:38,880 --> 00:25:39,600
you get to

769
00:25:39,600 --> 00:25:42,559
present day android sdks you have to do

770
00:25:42,559 --> 00:25:43,520
a lot more

771
00:25:43,520 --> 00:25:46,159
to bypass security checks um and to get

772
00:25:46,159 --> 00:25:48,320
into the play store with permissions and

773
00:25:48,320 --> 00:25:51,360
stuff like that and this is one

774
00:25:51,360 --> 00:25:53,919
everyone's very very familiar with i'm

775
00:25:53,919 --> 00:25:54,559
pretty sure

776
00:25:54,559 --> 00:25:57,840
at this conference and this goes into

777
00:25:57,840 --> 00:26:00,000
like anything else who's hosting the

778
00:26:00,000 --> 00:26:00,960
file

779
00:26:00,960 --> 00:26:02,559
what a lot of people are having to do

780
00:26:02,559 --> 00:26:04,559
nowadays because google play

781
00:26:04,559 --> 00:26:07,600
is quote unquote getting stricter with

782
00:26:07,600 --> 00:26:09,840
what they allow in the store they'll

783
00:26:09,840 --> 00:26:11,360
actually host it

784
00:26:11,360 --> 00:26:14,240
outside of the store and then use social

785
00:26:14,240 --> 00:26:16,000
engineering to get the end user to

786
00:26:16,000 --> 00:26:16,960
disable

787
00:26:16,960 --> 00:26:20,080
unofficial play restrictions so they'll

788
00:26:20,080 --> 00:26:20,400
say

789
00:26:20,400 --> 00:26:22,880
if you really want this awesome file or

790
00:26:22,880 --> 00:26:24,000
you want to see

791
00:26:24,000 --> 00:26:25,360
what your girlfriend's doing on her

792
00:26:25,360 --> 00:26:27,600
phone you have to disable the

793
00:26:27,600 --> 00:26:29,600
restriction and load this application

794
00:26:29,600 --> 00:26:31,600
from a third-party url

795
00:26:31,600 --> 00:26:34,640
happens a lot unfortunately people click

796
00:26:34,640 --> 00:26:35,120
stuff

797
00:26:35,120 --> 00:26:37,679
in their sms and they'll install it to

798
00:26:37,679 --> 00:26:38,720
get it that

799
00:26:38,720 --> 00:26:41,600
new tick tock background um that that

800
00:26:41,600 --> 00:26:42,400
they've been

801
00:26:42,400 --> 00:26:45,919
looking for so outbound inbound traffic

802
00:26:45,919 --> 00:26:47,520
and this is specifically if you're

803
00:26:47,520 --> 00:26:49,200
looking at reverse shells

804
00:26:49,200 --> 00:26:51,279
who's hitting it when you load it in

805
00:26:51,279 --> 00:26:52,960
dynamic execution

806
00:26:52,960 --> 00:26:55,600
and where is it going and then from a

807
00:26:55,600 --> 00:26:57,600
static perspective once you've developed

808
00:26:57,600 --> 00:26:59,200
those indicators

809
00:26:59,200 --> 00:27:01,919
what passive dns is associated with it

810
00:27:01,919 --> 00:27:04,400
is it associated with any who is

811
00:27:04,400 --> 00:27:06,080
has this developer made any other

812
00:27:06,080 --> 00:27:07,919
applications that reference the same

813
00:27:07,919 --> 00:27:09,120
infrastructure

814
00:27:09,120 --> 00:27:11,679
or are they what appears to be leasing

815
00:27:11,679 --> 00:27:13,200
out their infrastructure

816
00:27:13,200 --> 00:27:16,480
as we'll see in our investigation

817
00:27:16,480 --> 00:27:20,000
uh who registered the domains associated

818
00:27:20,000 --> 00:27:22,320
gdpr and other privacy restrictions have

819
00:27:22,320 --> 00:27:24,480
made this less and less of a well

820
00:27:24,480 --> 00:27:27,840
to dig from unfortunately but depending

821
00:27:27,840 --> 00:27:29,120
on the service you're utilizing

822
00:27:29,120 --> 00:27:30,080
sometimes

823
00:27:30,080 --> 00:27:32,720
they'll still have this information and

824
00:27:32,720 --> 00:27:34,480
then the key one that happens a lot and

825
00:27:34,480 --> 00:27:35,279
this is a

826
00:27:35,279 --> 00:27:36,559
big point in the investigation we're

827
00:27:36,559 --> 00:27:38,399
going to go over today are there any

828
00:27:38,399 --> 00:27:40,480
other applications utilizing similar

829
00:27:40,480 --> 00:27:41,760
infrastructure

830
00:27:41,760 --> 00:27:43,840
so this can be derived either from the

831
00:27:43,840 --> 00:27:45,760
base url and uri

832
00:27:45,760 --> 00:27:49,840
down to the uri syntax

833
00:27:50,960 --> 00:27:53,600
again uh email addresses most the ones

834
00:27:53,600 --> 00:27:54,559
on google play

835
00:27:54,559 --> 00:27:56,080
unless they're a commercial entity or

836
00:27:56,080 --> 00:27:58,480
fake unfortunately it doesn't appear

837
00:27:58,480 --> 00:28:01,840
that google play verifies

838
00:28:01,840 --> 00:28:05,039
for the most part um so a lot of these

839
00:28:05,039 --> 00:28:06,559
are going to be dead ends unless you

840
00:28:06,559 --> 00:28:09,520
have a really sloppy developer

841
00:28:09,520 --> 00:28:11,679
what advertisers are they using the nice

842
00:28:11,679 --> 00:28:13,360
thing about advertising is

843
00:28:13,360 --> 00:28:16,000
if you use it in most sdk context it's a

844
00:28:16,000 --> 00:28:17,600
static identifier

845
00:28:17,600 --> 00:28:18,960
so that is something that you can

846
00:28:18,960 --> 00:28:21,440
reference very similar to a ua string on

847
00:28:21,440 --> 00:28:22,640
a website

848
00:28:22,640 --> 00:28:24,720
the api key and all of that is a

849
00:28:24,720 --> 00:28:26,960
requirement for something like admob or

850
00:28:26,960 --> 00:28:28,240
for google play

851
00:28:28,240 --> 00:28:31,919
ads within the application and then

852
00:28:31,919 --> 00:28:34,720
again as we'll see today um oops i

853
00:28:34,720 --> 00:28:36,640
forgot my email address strings within

854
00:28:36,640 --> 00:28:37,760
the source code

855
00:28:37,760 --> 00:28:39,679
and you can use this as a pivot so a lot

856
00:28:39,679 --> 00:28:42,080
of times with developers their email

857
00:28:42,080 --> 00:28:43,360
address will either point to their

858
00:28:43,360 --> 00:28:46,159
github repository a personal website

859
00:28:46,159 --> 00:28:47,760
and you can do all the infrastructure

860
00:28:47,760 --> 00:28:49,279
pivots with the email address string

861
00:28:49,279 --> 00:28:51,440
that you derived

862
00:28:51,440 --> 00:28:53,039
and then once you have that email

863
00:28:53,039 --> 00:28:54,880
address either from google play

864
00:28:54,880 --> 00:28:57,039
or from other methods you could say is

865
00:28:57,039 --> 00:28:58,000
that email address

866
00:28:58,000 --> 00:29:00,240
tied to any name personas or companies

867
00:29:00,240 --> 00:29:02,320
or llc's

868
00:29:02,320 --> 00:29:04,240
and then who's listed as that llc or

869
00:29:04,240 --> 00:29:06,000
corporation oftentimes

870
00:29:06,000 --> 00:29:07,520
especially with front companies and

871
00:29:07,520 --> 00:29:09,120
malicious contacts

872
00:29:09,120 --> 00:29:12,000
they'll forget to actually use an email

873
00:29:12,000 --> 00:29:13,840
address that's not tied to a named

874
00:29:13,840 --> 00:29:14,799
persona

875
00:29:14,799 --> 00:29:17,360
whether that's their legal counsel their

876
00:29:17,360 --> 00:29:18,720
name or they forget

877
00:29:18,720 --> 00:29:20,640
like a lot of people do an ocean that

878
00:29:20,640 --> 00:29:22,080
the internet's a thing

879
00:29:22,080 --> 00:29:25,200
and historical presentations of the pdfs

880
00:29:25,200 --> 00:29:27,360
for their initial llc paperwork

881
00:29:27,360 --> 00:29:30,640
is easily accessible

882
00:29:30,640 --> 00:29:32,720
and then with the names aliases and

883
00:29:32,720 --> 00:29:34,000
relationships

884
00:29:34,000 --> 00:29:36,480
this is a very big ocean thing i don't

885
00:29:36,480 --> 00:29:38,640
need to tell a lot of people on here

886
00:29:38,640 --> 00:29:40,880
once you have an actual name you can do

887
00:29:40,880 --> 00:29:42,320
a lot of fun stuff with it

888
00:29:42,320 --> 00:29:44,080
you can derive relationships what

889
00:29:44,080 --> 00:29:45,600
aliases they use

890
00:29:45,600 --> 00:29:47,360
and the big thing that we're going to go

891
00:29:47,360 --> 00:29:48,960
into the investigation is

892
00:29:48,960 --> 00:29:51,279
can that name actually be verified

893
00:29:51,279 --> 00:29:54,000
especially with vpns for some reason

894
00:29:54,000 --> 00:29:57,520
in google play they don't use real names

895
00:29:57,520 --> 00:29:59,840
so you'll see a lot of burner names like

896
00:29:59,840 --> 00:30:01,039
karen smith

897
00:30:01,039 --> 00:30:03,360
and google's like that seems legitimate

898
00:30:03,360 --> 00:30:04,320
i'm gonna let that

899
00:30:04,320 --> 00:30:08,159
hang out and make money and then

900
00:30:08,159 --> 00:30:10,320
physical locations this one's left out

901
00:30:10,320 --> 00:30:13,039
the most i think from most re reports

902
00:30:13,039 --> 00:30:14,640
because most reverse engineers

903
00:30:14,640 --> 00:30:15,919
to their credit they're awesome at

904
00:30:15,919 --> 00:30:18,159
reverse engineering but once they've

905
00:30:18,159 --> 00:30:19,039
reversed it

906
00:30:19,039 --> 00:30:20,799
they sort of stop carrying or they pass

907
00:30:20,799 --> 00:30:22,240
it off to a separate team

908
00:30:22,240 --> 00:30:24,640
from an ocean perspective the developer

909
00:30:24,640 --> 00:30:26,080
location

910
00:30:26,080 --> 00:30:28,320
is sort of a complicated ask to look

911
00:30:28,320 --> 00:30:29,200
into

912
00:30:29,200 --> 00:30:30,880
you have to determine what their

913
00:30:30,880 --> 00:30:32,799
language is in the source code often

914
00:30:32,799 --> 00:30:33,360
they'll say

915
00:30:33,360 --> 00:30:35,200
they're an american developer that lives

916
00:30:35,200 --> 00:30:37,120
in california and loves surfing

917
00:30:37,120 --> 00:30:40,080
but all their source code is in mandarin

918
00:30:40,080 --> 00:30:41,520
and

919
00:30:41,520 --> 00:30:43,840
they will only share their stuff say on

920
00:30:43,840 --> 00:30:45,679
chinese websites

921
00:30:45,679 --> 00:30:47,279
ip locations this goes into

922
00:30:47,279 --> 00:30:49,279
infrastructure domain who is

923
00:30:49,279 --> 00:30:51,760
similarly the llc is a really big

924
00:30:51,760 --> 00:30:53,360
giveaway for a lot of these companies

925
00:30:53,360 --> 00:30:54,640
they'll use an s corp for

926
00:30:54,640 --> 00:30:57,919
an llc or a lawyer as we'll see in

927
00:30:57,919 --> 00:31:00,080
our investigation to associate their

928
00:31:00,080 --> 00:31:02,480
company so that google will pay them

929
00:31:02,480 --> 00:31:04,480
or so that google doesn't think that

930
00:31:04,480 --> 00:31:06,559
they appear fraudulent

931
00:31:06,559 --> 00:31:09,360
but a lot of times this will give us a

932
00:31:09,360 --> 00:31:11,120
very good idea of where they're actually

933
00:31:11,120 --> 00:31:12,640
located so say

934
00:31:12,640 --> 00:31:16,000
delaware as an example is referenced in

935
00:31:16,000 --> 00:31:17,360
a lot of llc's

936
00:31:17,360 --> 00:31:19,279
but most of the time people that use

937
00:31:19,279 --> 00:31:20,880
delaware llc's are

938
00:31:20,880 --> 00:31:23,039
trying to obfuscate something the

939
00:31:23,039 --> 00:31:24,960
signing certificate locality is often

940
00:31:24,960 --> 00:31:27,679
a really good one as we'll highlight in

941
00:31:27,679 --> 00:31:28,880
our investigation

942
00:31:28,880 --> 00:31:31,360
you generally want to declare there's a

943
00:31:31,360 --> 00:31:33,760
country string within the certificate

944
00:31:33,760 --> 00:31:35,440
for the issue we're in for the source

945
00:31:35,440 --> 00:31:37,760
and a lot of times people will mess up

946
00:31:37,760 --> 00:31:39,760
they'll say they're a us-based developer

947
00:31:39,760 --> 00:31:41,760
but oops their country code says hong

948
00:31:41,760 --> 00:31:42,720
kong

949
00:31:42,720 --> 00:31:44,640
and most importantly from an osa and a

950
00:31:44,640 --> 00:31:46,720
research perspective is any of this

951
00:31:46,720 --> 00:31:48,080
verifiable

952
00:31:48,080 --> 00:31:50,240
so you don't want to take anything in

953
00:31:50,240 --> 00:31:51,440
the google play store

954
00:31:51,440 --> 00:31:53,679
or on a website or anything like that as

955
00:31:53,679 --> 00:31:55,360
an actual verifiable fact

956
00:31:55,360 --> 00:31:56,720
you want to make sure that you prove it

957
00:31:56,720 --> 00:31:58,640
yourself

958
00:31:58,640 --> 00:31:59,919
and then from a miscellaneous

959
00:31:59,919 --> 00:32:03,360
perspective um how did they compile it

960
00:32:03,360 --> 00:32:05,039
what packages would they utilize and

961
00:32:05,039 --> 00:32:07,200
that they don't actually maintain

962
00:32:07,200 --> 00:32:09,200
a sort of a gotcha here is if you're

963
00:32:09,200 --> 00:32:11,679
just looking at the strings

964
00:32:11,679 --> 00:32:15,360
or the resource src for a given package

965
00:32:15,360 --> 00:32:18,080
all the strings in there are not to do

966
00:32:18,080 --> 00:32:18,480
with

967
00:32:18,480 --> 00:32:20,880
the developer so you'll see a lot of

968
00:32:20,880 --> 00:32:22,000
analysts when they're first getting

969
00:32:22,000 --> 00:32:24,080
going say aha like i found this string

970
00:32:24,080 --> 00:32:25,200
this is who did it

971
00:32:25,200 --> 00:32:26,960
or this is their compile time because

972
00:32:26,960 --> 00:32:28,399
it's referenced here

973
00:32:28,399 --> 00:32:31,200
i would advise pretty heavily against

974
00:32:31,200 --> 00:32:33,039
just looking at strings just like if

975
00:32:33,039 --> 00:32:34,399
you're looking at ida

976
00:32:34,399 --> 00:32:35,440
you're not going to want to look at the

977
00:32:35,440 --> 00:32:37,600
string sub view and assume

978
00:32:37,600 --> 00:32:40,320
that you have the the complete picture

979
00:32:40,320 --> 00:32:41,840
make sure that the string you're looking

980
00:32:41,840 --> 00:32:42,320
at

981
00:32:42,320 --> 00:32:44,399
is the string associated with the actual

982
00:32:44,399 --> 00:32:46,720
developer but it is important to see

983
00:32:46,720 --> 00:32:49,279
what packages they're using because that

984
00:32:49,279 --> 00:32:51,039
is something you can note and say oh

985
00:32:51,039 --> 00:32:53,279
they always use these third-party tools

986
00:32:53,279 --> 00:32:55,440
or they always use this malicious

987
00:32:55,440 --> 00:32:56,559
builder

988
00:32:56,559 --> 00:32:59,039
target sdk target demographic and target

989
00:32:59,039 --> 00:32:59,840
region

990
00:32:59,840 --> 00:33:02,000
go a lot into building out an overall

991
00:33:02,000 --> 00:33:03,760
profile or a dossier of the given

992
00:33:03,760 --> 00:33:05,120
developer

993
00:33:05,120 --> 00:33:07,440
if you're looking at a team or if you're

994
00:33:07,440 --> 00:33:08,960
looking at someone

995
00:33:08,960 --> 00:33:10,880
that might may or may not work for a

996
00:33:10,880 --> 00:33:12,720
nation state front company

997
00:33:12,720 --> 00:33:15,279
you want to see okay they primarily only

998
00:33:15,279 --> 00:33:17,519
go after this specific region

999
00:33:17,519 --> 00:33:19,600
this target sdk always and their

1000
00:33:19,600 --> 00:33:21,600
demographic appears to be the minority

1001
00:33:21,600 --> 00:33:23,200
in that country

1002
00:33:23,200 --> 00:33:24,720
and then the business site or

1003
00:33:24,720 --> 00:33:26,640
application impersonation

1004
00:33:26,640 --> 00:33:29,200
who do they generally try to spoof are

1005
00:33:29,200 --> 00:33:30,880
they always going after the financial

1006
00:33:30,880 --> 00:33:31,919
vertical

1007
00:33:31,919 --> 00:33:33,840
are they really interested in decrypting

1008
00:33:33,840 --> 00:33:35,279
whatsapp for telegram

1009
00:33:35,279 --> 00:33:36,480
and they're trying to make it look like

1010
00:33:36,480 --> 00:33:38,559
it's a real telegram application

1011
00:33:38,559 --> 00:33:40,799
and then a really fun one is who are

1012
00:33:40,799 --> 00:33:42,159
their competitors

1013
00:33:42,159 --> 00:33:44,159
so there is a lot of back and forth

1014
00:33:44,159 --> 00:33:45,760
between developers

1015
00:33:45,760 --> 00:33:47,279
especially if you get into the more

1016
00:33:47,279 --> 00:33:48,880
closed off

1017
00:33:48,880 --> 00:33:52,240
forums about who has the best malware

1018
00:33:52,240 --> 00:33:54,080
or who has the best vpn application

1019
00:33:54,080 --> 00:33:55,360
doesn't even necessarily have to be

1020
00:33:55,360 --> 00:33:56,559
malicious

1021
00:33:56,559 --> 00:33:58,720
but they'll write reviews on their own

1022
00:33:58,720 --> 00:34:00,480
stuff within google play and forget that

1023
00:34:00,480 --> 00:34:01,760
they're logged in

1024
00:34:01,760 --> 00:34:03,440
they'll make videos on youtube and

1025
00:34:03,440 --> 00:34:04,799
forget that they're logged in

1026
00:34:04,799 --> 00:34:06,240
and then you'll see their other stuff

1027
00:34:06,240 --> 00:34:07,919
that it looks like oh they make this

1028
00:34:07,919 --> 00:34:10,879
us vpn but they also make a vpn for

1029
00:34:10,879 --> 00:34:12,239
turkey and china

1030
00:34:12,239 --> 00:34:14,239
and those ones are flagged as malicious

1031
00:34:14,239 --> 00:34:15,918
and here are the certificates that they

1032
00:34:15,918 --> 00:34:16,719
use

1033
00:34:16,719 --> 00:34:18,879
and then from a competitor perspective

1034
00:34:18,879 --> 00:34:20,960
from you can also social engineer their

1035
00:34:20,960 --> 00:34:24,480
competitors to possibly give up dirt

1036
00:34:24,480 --> 00:34:26,879
now for the the most fun part of the

1037
00:34:26,879 --> 00:34:27,679
presentation

1038
00:34:27,679 --> 00:34:30,480
i did an example investigation of a very

1039
00:34:30,480 --> 00:34:31,359
popular app

1040
00:34:31,359 --> 00:34:33,520
in the google play store if you have

1041
00:34:33,520 --> 00:34:35,359
this app installed on your phone

1042
00:34:35,359 --> 00:34:37,760
or know anyone that does definitely

1043
00:34:37,760 --> 00:34:38,960
uninstall it

1044
00:34:38,960 --> 00:34:41,679
um don't install vpns from the google

1045
00:34:41,679 --> 00:34:43,119
play store

1046
00:34:43,119 --> 00:34:45,760
unless you've looked at them yourself

1047
00:34:45,760 --> 00:34:48,000
and you'll see why in just a second

1048
00:34:48,000 --> 00:34:50,000
so the three apps that i looked at are

1049
00:34:50,000 --> 00:34:51,199
about this company named

1050
00:34:51,199 --> 00:34:54,159
signal lab you might notice that green

1051
00:34:54,159 --> 00:34:55,440
signal vpn

1052
00:34:55,440 --> 00:34:57,680
not super popular only has about 59

1053
00:34:57,680 --> 00:34:58,640
reviews

1054
00:34:58,640 --> 00:35:00,160
and not many people have downloaded it

1055
00:35:00,160 --> 00:35:02,240
like a thousand users but then when you

1056
00:35:02,240 --> 00:35:03,839
get into thunder vpn

1057
00:35:03,839 --> 00:35:06,400
and secure vpn they're super high speed

1058
00:35:06,400 --> 00:35:08,400
and they have unlimited vpn

1059
00:35:08,400 --> 00:35:11,440
powers um they have over 10 million

1060
00:35:11,440 --> 00:35:12,720
installs each

1061
00:35:12,720 --> 00:35:14,800
and as you can see they have a lot of

1062
00:35:14,800 --> 00:35:18,079
really really great reviews

1063
00:35:18,880 --> 00:35:21,520
before we get into this uh they claim to

1064
00:35:21,520 --> 00:35:22,320
be

1065
00:35:22,320 --> 00:35:24,400
u.s developers that live in a place

1066
00:35:24,400 --> 00:35:26,400
called alhambra arkansas

1067
00:35:26,400 --> 00:35:28,240
for anyone on the call and anyone doing

1068
00:35:28,240 --> 00:35:30,000
fact checks in the twitch stream

1069
00:35:30,000 --> 00:35:32,560
there is no alhambra arkansas this is

1070
00:35:32,560 --> 00:35:34,560
their listed physical location in all of

1071
00:35:34,560 --> 00:35:35,839
their applications

1072
00:35:35,839 --> 00:35:37,040
all three of them are still on the

1073
00:35:37,040 --> 00:35:39,359
google play store and as we'll see

1074
00:35:39,359 --> 00:35:42,079
that is not actually a real address

1075
00:35:42,079 --> 00:35:43,520
because they

1076
00:35:43,520 --> 00:35:45,440
i don't know typoed it and google never

1077
00:35:45,440 --> 00:35:46,640
got back with them

1078
00:35:46,640 --> 00:35:48,800
so the quick pivots you can get just

1079
00:35:48,800 --> 00:35:50,079
from looking at a google play

1080
00:35:50,079 --> 00:35:50,880
application

1081
00:35:50,880 --> 00:35:52,320
without getting into any of the

1082
00:35:52,320 --> 00:35:54,320
nitty-gritty of the analysis of the

1083
00:35:54,320 --> 00:35:55,359
application

1084
00:35:55,359 --> 00:35:58,000
there will always be some type of email

1085
00:35:58,000 --> 00:35:58,800
address

1086
00:35:58,800 --> 00:36:00,240
whether that's a legitimate email

1087
00:36:00,240 --> 00:36:02,560
address or whatever it is a requirement

1088
00:36:02,560 --> 00:36:03,760
of google play

1089
00:36:03,760 --> 00:36:05,920
um they do i believe have some specifics

1090
00:36:05,920 --> 00:36:07,359
around what providers that you're

1091
00:36:07,359 --> 00:36:08,960
allowed to use you're not going to see a

1092
00:36:08,960 --> 00:36:10,240
lot of free mail or to

1093
00:36:10,240 --> 00:36:13,359
not or protonmail in here they generally

1094
00:36:13,359 --> 00:36:15,200
want you to use either a gmail address

1095
00:36:15,200 --> 00:36:17,119
or a verifiable email address to their

1096
00:36:17,119 --> 00:36:18,320
credit

1097
00:36:18,320 --> 00:36:21,119
the second email address here is taken

1098
00:36:21,119 --> 00:36:21,599
from

1099
00:36:21,599 --> 00:36:24,400
what they call their vip support section

1100
00:36:24,400 --> 00:36:25,200
as you can see

1101
00:36:25,200 --> 00:36:28,240
also a gmail address and then the dev id

1102
00:36:28,240 --> 00:36:30,160
so in this instance we got lucky

1103
00:36:30,160 --> 00:36:32,400
they're dev ids in numeric but for the

1104
00:36:32,400 --> 00:36:34,720
most part if you're a developer

1105
00:36:34,720 --> 00:36:36,480
um you're gonna have a name you're not

1106
00:36:36,480 --> 00:36:38,000
gonna get lucky enough to have

1107
00:36:38,000 --> 00:36:41,599
a numeric so the physical location

1108
00:36:41,599 --> 00:36:44,800
alhambra arkansas 91803 in the

1109
00:36:44,800 --> 00:36:47,760
u.s of a and then the base domain of

1110
00:36:47,760 --> 00:36:49,119
what their website is so

1111
00:36:49,119 --> 00:36:52,640
the website here is free signal.com

1112
00:36:52,640 --> 00:36:54,240
and then they have a sub domain for the

1113
00:36:54,240 --> 00:36:55,839
given apps so

1114
00:36:55,839 --> 00:36:59,520
there's uh green signal thunder

1115
00:36:59,520 --> 00:37:02,720
and secure the best vpn apps

1116
00:37:02,720 --> 00:37:05,119
and here you can get a simple timeline

1117
00:37:05,119 --> 00:37:06,000
so with

1118
00:37:06,000 --> 00:37:07,680
developer tools that are freely

1119
00:37:07,680 --> 00:37:09,200
available with an api

1120
00:37:09,200 --> 00:37:10,640
you can see the first time an

1121
00:37:10,640 --> 00:37:12,640
application was available in the google

1122
00:37:12,640 --> 00:37:13,599
play store

1123
00:37:13,599 --> 00:37:15,200
and not just the last time it was

1124
00:37:15,200 --> 00:37:17,200
updated the google play ui

1125
00:37:17,200 --> 00:37:19,680
does not give you a good way to do this

1126
00:37:19,680 --> 00:37:21,520
but it's easily queryable

1127
00:37:21,520 --> 00:37:23,760
so we can see they started in about june

1128
00:37:23,760 --> 00:37:25,520
of 2017

1129
00:37:25,520 --> 00:37:27,359
and then they had another release in

1130
00:37:27,359 --> 00:37:29,839
november and then another one in march

1131
00:37:29,839 --> 00:37:32,560
their apps cost anywhere from six to

1132
00:37:32,560 --> 00:37:34,000
sixty dollars

1133
00:37:34,000 --> 00:37:37,280
and that's just a range they offer a vip

1134
00:37:37,280 --> 00:37:39,520
option which you'll see a lot with a lot

1135
00:37:39,520 --> 00:37:41,119
of these freemium tools

1136
00:37:41,119 --> 00:37:42,880
the tool will work the same but if you

1137
00:37:42,880 --> 00:37:45,040
want those ads to go away

1138
00:37:45,040 --> 00:37:48,720
give us money the description

1139
00:37:48,720 --> 00:37:51,119
also a very good pivot as we can see

1140
00:37:51,119 --> 00:37:51,920
here

1141
00:37:51,920 --> 00:37:54,240
it is a lightning fast app provide free

1142
00:37:54,240 --> 00:37:55,839
vpn proxy service

1143
00:37:55,839 --> 00:37:58,480
not need any configuration if we take

1144
00:37:58,480 --> 00:38:00,640
that and throw that into google

1145
00:38:00,640 --> 00:38:03,520
you can see that that is uh used a lot

1146
00:38:03,520 --> 00:38:05,599
by avpn wolfvpn

1147
00:38:05,599 --> 00:38:10,079
expert vpn warlier vpn and hide you vpn

1148
00:38:10,079 --> 00:38:12,079
these are just a few examples it's used

1149
00:38:12,079 --> 00:38:13,440
an awful lot

1150
00:38:13,440 --> 00:38:16,079
and a lot of times with descriptions you

1151
00:38:16,079 --> 00:38:18,000
can tie it back to the first time it was

1152
00:38:18,000 --> 00:38:19,920
referenced and use it as a base for your

1153
00:38:19,920 --> 00:38:22,079
timeline

1154
00:38:22,079 --> 00:38:25,200
this about sums up my

1155
00:38:25,200 --> 00:38:30,320
my utilization of this vpn it's okay

1156
00:38:30,320 --> 00:38:32,560
from a physical perspective um right

1157
00:38:32,560 --> 00:38:36,000
away seeing arkansas 910803

1158
00:38:36,000 --> 00:38:37,599
was kind of red flag because that's a

1159
00:38:37,599 --> 00:38:39,200
california zip code

1160
00:38:39,200 --> 00:38:40,960
if we look at what they were trying to

1161
00:38:40,960 --> 00:38:42,400
put they were meant

1162
00:38:42,400 --> 00:38:44,800
alhambra california specifically

1163
00:38:44,800 --> 00:38:46,000
building one so you might

1164
00:38:46,000 --> 00:38:48,480
ask why why would they use this address

1165
00:38:48,480 --> 00:38:49,119
well

1166
00:38:49,119 --> 00:38:51,119
alhambra is an office suite and there's

1167
00:38:51,119 --> 00:38:52,560
a few different reasons they might use

1168
00:38:52,560 --> 00:38:53,200
this

1169
00:38:53,200 --> 00:38:56,400
um either they really wanted an office

1170
00:38:56,400 --> 00:38:59,359
there because a1 is the building offices

1171
00:38:59,359 --> 00:39:01,839
or in my research i found out

1172
00:39:01,839 --> 00:39:04,320
that there happens to be a law office

1173
00:39:04,320 --> 00:39:06,240
for a legal professional

1174
00:39:06,240 --> 00:39:08,320
that only accepts cash payments of this

1175
00:39:08,320 --> 00:39:11,119
address so this might be the person

1176
00:39:11,119 --> 00:39:13,280
that handles their mail handles their

1177
00:39:13,280 --> 00:39:15,040
notifications from google

1178
00:39:15,040 --> 00:39:17,200
and most importantly gets those awesome

1179
00:39:17,200 --> 00:39:21,200
checks for their premium vpn service

1180
00:39:21,200 --> 00:39:22,800
this is what their base domain looks

1181
00:39:22,800 --> 00:39:25,599
like as you can see very well maintained

1182
00:39:25,599 --> 00:39:28,800
this has not changed since 2017 but we

1183
00:39:28,800 --> 00:39:30,400
can tell that they're using

1184
00:39:30,400 --> 00:39:33,599
a very basic nginx front on fedora um

1185
00:39:33,599 --> 00:39:35,280
there's nothing here

1186
00:39:35,280 --> 00:39:38,720
they only have their web server set up

1187
00:39:38,720 --> 00:39:40,240
to handle the sub domain so like here

1188
00:39:40,240 --> 00:39:41,599
would be an example

1189
00:39:41,599 --> 00:39:44,560
of this totally legitimate website that

1190
00:39:44,560 --> 00:39:46,560
has over 10 million

1191
00:39:46,560 --> 00:39:49,119
app downloads on google play it looks

1192
00:39:49,119 --> 00:39:49,760
like

1193
00:39:49,760 --> 00:39:51,680
oops they forgot to take out a string

1194
00:39:51,680 --> 00:39:53,280
when they used h track

1195
00:39:53,280 --> 00:39:56,160
and they copied it from devittfamily.com

1196
00:39:56,160 --> 00:39:57,040
and they use

1197
00:39:57,040 --> 00:39:59,680
the subdirectory from apex one so the

1198
00:39:59,680 --> 00:40:00,480
important thing to

1199
00:40:00,480 --> 00:40:03,520
see here with apex one is apex one

1200
00:40:03,520 --> 00:40:05,599
is a developer that handles mobile

1201
00:40:05,599 --> 00:40:07,040
application development

1202
00:40:07,040 --> 00:40:09,359
and website company services for

1203
00:40:09,359 --> 00:40:10,240
individuals

1204
00:40:10,240 --> 00:40:13,119
companies and developers so what

1205
00:40:13,119 --> 00:40:15,280
probably happened here

1206
00:40:15,280 --> 00:40:17,440
is they were too lazy to make their own

1207
00:40:17,440 --> 00:40:18,480
website

1208
00:40:18,480 --> 00:40:22,079
they heard vpns were the new hotness and

1209
00:40:22,079 --> 00:40:23,760
they don't know how h track works you'll

1210
00:40:23,760 --> 00:40:25,680
see this a lot uh there's actually a

1211
00:40:25,680 --> 00:40:27,440
story this week where people forgot that

1212
00:40:27,440 --> 00:40:28,640
this was the thing

1213
00:40:28,640 --> 00:40:31,200
but from a pivotal perspective as a

1214
00:40:31,200 --> 00:40:31,960
gotcha

1215
00:40:31,960 --> 00:40:33,920
devotfamily.com probably has nothing to

1216
00:40:33,920 --> 00:40:35,359
do with this developer

1217
00:40:35,359 --> 00:40:37,599
neither does apex one they just really

1218
00:40:37,599 --> 00:40:40,880
liked the way their website looked

1219
00:40:40,960 --> 00:40:44,000
so here we get into what their original

1220
00:40:44,000 --> 00:40:45,440
certificate looked like so if you look

1221
00:40:45,440 --> 00:40:47,200
at any of these apps right now

1222
00:40:47,200 --> 00:40:49,040
you'll see all of them just have a

1223
00:40:49,040 --> 00:40:51,599
generic google developer certificate

1224
00:40:51,599 --> 00:40:53,440
it's perfectly straightforward

1225
00:40:53,440 --> 00:40:56,000
it's really great but if you go back to

1226
00:40:56,000 --> 00:40:57,680
the previous versions

1227
00:40:57,680 --> 00:41:00,880
oops they forgot to leave out the fact

1228
00:41:00,880 --> 00:41:02,480
that they're in hong kong

1229
00:41:02,480 --> 00:41:06,240
and the timeline associated for 12 2017

1230
00:41:06,240 --> 00:41:08,480
aligns with the original domain

1231
00:41:08,480 --> 00:41:09,520
registration

1232
00:41:09,520 --> 00:41:11,839
as well as their original amazing green

1233
00:41:11,839 --> 00:41:12,560
signal app

1234
00:41:12,560 --> 00:41:15,119
that did not have as many awesome clicks

1235
00:41:15,119 --> 00:41:16,079
and reviews

1236
00:41:16,079 --> 00:41:18,640
and i'm guessing monetary benefits so

1237
00:41:18,640 --> 00:41:19,680
from here

1238
00:41:19,680 --> 00:41:21,839
you could use this issuer the serial

1239
00:41:21,839 --> 00:41:22,800
number

1240
00:41:22,800 --> 00:41:25,200
as well as the hash to see if any other

1241
00:41:25,200 --> 00:41:26,240
applications

1242
00:41:26,240 --> 00:41:28,800
either within virustotal or cudios or

1243
00:41:28,800 --> 00:41:30,640
any other libraries like that

1244
00:41:30,640 --> 00:41:32,880
um use the same signing certificate in

1245
00:41:32,880 --> 00:41:35,119
this investigation unfortunately

1246
00:41:35,119 --> 00:41:37,680
um i didn't see any others but this is

1247
00:41:37,680 --> 00:41:39,839
very good to know

1248
00:41:39,839 --> 00:41:41,920
um it looks like this is probably not a

1249
00:41:41,920 --> 00:41:43,359
legitimate application

1250
00:41:43,359 --> 00:41:45,760
i could not find any llc's either in

1251
00:41:45,760 --> 00:41:47,680
arkansas or california

1252
00:41:47,680 --> 00:41:49,920
that use this name and i'm guessing they

1253
00:41:49,920 --> 00:41:51,200
use signal lab

1254
00:41:51,200 --> 00:41:53,520
because they heard signal messenger it

1255
00:41:53,520 --> 00:41:55,680
was a really well-known security tool

1256
00:41:55,680 --> 00:41:59,040
and they decided to piggyback off of it

1257
00:41:59,040 --> 00:42:00,960
here's a quick overview of what the

1258
00:42:00,960 --> 00:42:02,319
packages look like

1259
00:42:02,319 --> 00:42:04,319
i did a diff of all three and and the

1260
00:42:04,319 --> 00:42:05,440
one thing you might notice

1261
00:42:05,440 --> 00:42:09,200
is they all use this lib channel.so

1262
00:42:09,200 --> 00:42:12,560
so the lib channel so in my research it

1263
00:42:12,560 --> 00:42:13,839
looks like they're using that for their

1264
00:42:13,839 --> 00:42:15,200
vpn router

1265
00:42:15,200 --> 00:42:18,000
so based on what we know about people

1266
00:42:18,000 --> 00:42:19,839
leaving stuff in code

1267
00:42:19,839 --> 00:42:22,560
i took a look at their libeso and oops

1268
00:42:22,560 --> 00:42:24,079
there's his name

1269
00:42:24,079 --> 00:42:27,280
i've obfuscated it because i won

1270
00:42:27,280 --> 00:42:29,119
i don't really know where this person

1271
00:42:29,119 --> 00:42:31,119
lives if they truly do live in hong kong

1272
00:42:31,119 --> 00:42:32,960
i don't want them to get in trouble

1273
00:42:32,960 --> 00:42:35,760
but this is freely available information

1274
00:42:35,760 --> 00:42:38,400
cha cha 20 is a stream cipher

1275
00:42:38,400 --> 00:42:41,440
aes gcm also is used for the vpn routing

1276
00:42:41,440 --> 00:42:42,880
of this application

1277
00:42:42,880 --> 00:42:44,640
if you look into this particular

1278
00:42:44,640 --> 00:42:46,079
developer's name

1279
00:42:46,079 --> 00:42:48,160
and this particular string it looks like

1280
00:42:48,160 --> 00:42:49,839
he's worked on other vpn apps in the

1281
00:42:49,839 --> 00:42:50,560
past

1282
00:42:50,560 --> 00:42:53,040
and he also has a project on there

1283
00:42:53,040 --> 00:42:55,280
because he's into video games

1284
00:42:55,280 --> 00:42:57,440
if someone's using virustotal you can

1285
00:42:57,440 --> 00:43:00,160
look into this

1286
00:43:00,319 --> 00:43:02,720
here is a quick overview of what the app

1287
00:43:02,720 --> 00:43:04,400
looks like in its true form

1288
00:43:04,400 --> 00:43:07,520
because i decided to take the veil off

1289
00:43:07,520 --> 00:43:08,240
and uh

1290
00:43:08,240 --> 00:43:11,040
yeah this is the exact same app in the

1291
00:43:11,040 --> 00:43:12,319
us

1292
00:43:12,319 --> 00:43:14,800
or the uk or wherever you use it but

1293
00:43:14,800 --> 00:43:16,960
this is it in its original language

1294
00:43:16,960 --> 00:43:19,440
as you can see it's the best vpn of all

1295
00:43:19,440 --> 00:43:20,319
time

1296
00:43:20,319 --> 00:43:22,319
and you click one and it uses its

1297
00:43:22,319 --> 00:43:25,280
built-in statically assigned ops key

1298
00:43:25,280 --> 00:43:28,480
and des key to connect a totally secure

1299
00:43:28,480 --> 00:43:29,520
vpn

1300
00:43:29,520 --> 00:43:31,839
to a totally not owned by a hong kong

1301
00:43:31,839 --> 00:43:32,560
developer

1302
00:43:32,560 --> 00:43:36,319
vpn network if we go in here do a little

1303
00:43:36,319 --> 00:43:37,520
network analysis

1304
00:43:37,520 --> 00:43:39,680
we can see that it reaches out to some

1305
00:43:39,680 --> 00:43:40,560
subdomain called

1306
00:43:40,560 --> 00:43:43,280
s for it free signal i've redacted all

1307
00:43:43,280 --> 00:43:45,440
the fun things but as you can see here

1308
00:43:45,440 --> 00:43:48,480
this is the secure vpn context if you do

1309
00:43:48,480 --> 00:43:49,200
reach out

1310
00:43:49,200 --> 00:43:51,920
using the auth token and the rec token

1311
00:43:51,920 --> 00:43:53,280
and the auth id

1312
00:43:53,280 --> 00:43:55,839
what you get back is all of their vpn

1313
00:43:55,839 --> 00:43:56,480
ips

1314
00:43:56,480 --> 00:43:59,440
associated by location tier and the ops

1315
00:43:59,440 --> 00:44:00,319
keys

1316
00:44:00,319 --> 00:44:02,560
and then you can throw it at a fuzzer

1317
00:44:02,560 --> 00:44:04,800
and map out their entire network

1318
00:44:04,800 --> 00:44:06,720
if you map out their entire network if

1319
00:44:06,720 --> 00:44:08,240
you wanted to get into

1320
00:44:08,240 --> 00:44:11,200
a very complicated investigation which i

1321
00:44:11,200 --> 00:44:12,160
did not have time for

1322
00:44:12,160 --> 00:44:14,480
for this presentation you would be able

1323
00:44:14,480 --> 00:44:15,359
to say

1324
00:44:15,359 --> 00:44:17,359
all of these other apps are using this

1325
00:44:17,359 --> 00:44:19,119
network i'm pretty sure he's either

1326
00:44:19,119 --> 00:44:20,400
leasing infrastructure

1327
00:44:20,400 --> 00:44:23,040
or it's all the same person oh and look

1328
00:44:23,040 --> 00:44:23,680
at that

1329
00:44:23,680 --> 00:44:26,880
here are all the other vpns presently on

1330
00:44:26,880 --> 00:44:28,240
the google play store

1331
00:44:28,240 --> 00:44:31,280
using the exact same infrastructure uh

1332
00:44:31,280 --> 00:44:33,359
the same lib so

1333
00:44:33,359 --> 00:44:36,079
um oops he's probably making pretty good

1334
00:44:36,079 --> 00:44:36,880
money

1335
00:44:36,880 --> 00:44:39,280
um but if you're using again any of

1336
00:44:39,280 --> 00:44:40,480
these apps

1337
00:44:40,480 --> 00:44:42,640
it's probably a good idea to uninstall

1338
00:44:42,640 --> 00:44:43,520
them

1339
00:44:43,520 --> 00:44:45,599
and in the future it's probably a very

1340
00:44:45,599 --> 00:44:46,880
good rule to not

1341
00:44:46,880 --> 00:44:50,000
install an application called free vpn

1342
00:44:50,000 --> 00:44:53,119
or vpn internet or turbo vpn

1343
00:44:53,119 --> 00:44:56,319
etc if we look at the infrastructure

1344
00:44:56,319 --> 00:44:57,119
here

1345
00:44:57,119 --> 00:45:00,000
one thing you also might note is he's

1346
00:45:00,000 --> 00:45:02,079
really a big fan of bulgaria

1347
00:45:02,079 --> 00:45:04,560
if you look into that specific itl in

1348
00:45:04,560 --> 00:45:05,440
bulgaria

1349
00:45:05,440 --> 00:45:07,040
you'll notice there's only one person

1350
00:45:07,040 --> 00:45:08,800
assigned to it

1351
00:45:08,800 --> 00:45:10,640
may or may not be the developer but it's

1352
00:45:10,640 --> 00:45:12,480
not very widely used

1353
00:45:12,480 --> 00:45:15,119
and oddly enough for a u.s developer

1354
00:45:15,119 --> 00:45:16,720
none of their infrastructure is in the

1355
00:45:16,720 --> 00:45:19,440
united states

1356
00:45:19,440 --> 00:45:21,119
and then from a dynamic execution

1357
00:45:21,119 --> 00:45:23,280
perspective what we talked about before

1358
00:45:23,280 --> 00:45:24,400
you could look at the uri

1359
00:45:24,400 --> 00:45:27,200
context and say okay what else reaches

1360
00:45:27,200 --> 00:45:28,599
out to a file called

1361
00:45:28,599 --> 00:45:31,040
hello.txt and returns the value of

1362
00:45:31,040 --> 00:45:32,640
signal

1363
00:45:32,640 --> 00:45:35,920
which shared prefs of example signal lab

1364
00:45:35,920 --> 00:45:37,319
green signal

1365
00:45:37,319 --> 00:45:39,240
persistentconfig and

1366
00:45:39,240 --> 00:45:40,800
createsignal.database files

1367
00:45:40,800 --> 00:45:42,640
if you look into this i did a very quick

1368
00:45:42,640 --> 00:45:45,200
glance there are a bunch of other apps

1369
00:45:45,200 --> 00:45:46,960
and if someone with more free time than

1370
00:45:46,960 --> 00:45:49,440
me wanted to take a run at this

1371
00:45:49,440 --> 00:45:52,160
probably uh find a lot more fun stuff

1372
00:45:52,160 --> 00:45:52,880
than is

1373
00:45:52,880 --> 00:45:56,319
in this presentation so for getting

1374
00:45:56,319 --> 00:45:57,839
started here are the places i would

1375
00:45:57,839 --> 00:45:59,200
recommend

1376
00:45:59,200 --> 00:46:01,359
these are not tools these are just

1377
00:46:01,359 --> 00:46:02,480
places

1378
00:46:02,480 --> 00:46:05,200
that offer the ability to freely pivot

1379
00:46:05,200 --> 00:46:06,400
on stuff

1380
00:46:06,400 --> 00:46:08,160
virustotal is kind of at a freemium

1381
00:46:08,160 --> 00:46:10,800
point where you can look up hashes but

1382
00:46:10,800 --> 00:46:12,079
most of the pivots

1383
00:46:12,079 --> 00:46:14,319
require a paid account or researcher

1384
00:46:14,319 --> 00:46:17,200
account apk labs free but it's inline

1385
00:46:17,200 --> 00:46:19,359
invite only but all of the other

1386
00:46:19,359 --> 00:46:22,480
applications are free securios is free

1387
00:46:22,480 --> 00:46:25,599
and all the other ones listed so what

1388
00:46:25,599 --> 00:46:26,880
did we learn today

1389
00:46:26,880 --> 00:46:29,680
um you can do pivots for days because

1390
00:46:29,680 --> 00:46:31,280
all the data is freely available and

1391
00:46:31,280 --> 00:46:32,960
it's not very widely used

1392
00:46:32,960 --> 00:46:34,720
it's a great way to expand your skill

1393
00:46:34,720 --> 00:46:36,960
set everyone can play with this

1394
00:46:36,960 --> 00:46:40,319
you don't have to be a reverse engineer

1395
00:46:40,319 --> 00:46:42,079
and most importantly we learned that

1396
00:46:42,079 --> 00:46:56,000
google does not verify any information

1397
00:46:56,000 --> 00:46:58,640
so if anyone has any questions i believe

1398
00:46:58,640 --> 00:47:00,160
they're monitoring

1399
00:47:00,160 --> 00:47:04,240
right now and i can respond to those

1400
00:47:07,760 --> 00:47:10,000
yeah just looking here in the twitch

1401
00:47:10,000 --> 00:47:11,839
chat david uh

1402
00:47:11,839 --> 00:47:14,720
no questions yet so if anyone has any

1403
00:47:14,720 --> 00:47:16,960
questions on the talk for david

1404
00:47:16,960 --> 00:47:18,800
please drop them in the twitch chat now

1405
00:47:18,800 --> 00:47:21,680
we can definitely get to them

1406
00:47:21,680 --> 00:47:23,839
and also want to say david fantastic

1407
00:47:23,839 --> 00:47:25,200
talk really

1408
00:47:25,200 --> 00:47:27,440
great deep dive into these android

1409
00:47:27,440 --> 00:47:29,200
application investigative techniques

1410
00:47:29,200 --> 00:47:32,799
i really enjoyed it myself

1411
00:47:37,839 --> 00:47:39,440
okay so we have one question for you

1412
00:47:39,440 --> 00:47:41,200
david uh someone is asking if he could

1413
00:47:41,200 --> 00:47:42,640
go back to the

1414
00:47:42,640 --> 00:47:44,720
additional resources slide just for them

1415
00:47:44,720 --> 00:47:46,800
to see sure

1416
00:47:46,800 --> 00:47:52,400
uh this one

1417
00:47:52,400 --> 00:47:55,440
uh i believe so let's see let's look in

1418
00:47:55,440 --> 00:47:56,559
the chat

1419
00:47:56,559 --> 00:47:58,880
they're asking to show the list of tools

1420
00:47:58,880 --> 00:48:00,800
again is this the list of tools

1421
00:48:00,800 --> 00:48:03,520
yeah yeah

1422
00:48:04,079 --> 00:48:06,319
awesome i also want to remind everyone

1423
00:48:06,319 --> 00:48:08,480
that this talk will be recorded so

1424
00:48:08,480 --> 00:48:10,960
we upload to youtube at a later date so

1425
00:48:10,960 --> 00:48:12,640
if you miss any of david's slides it

1426
00:48:12,640 --> 00:48:14,160
will be available in that top

1427
00:48:14,160 --> 00:48:20,559
where you can see them

1428
00:48:20,559 --> 00:48:23,200
okay anyone else have any questions for

1429
00:48:23,200 --> 00:48:24,000
david

1430
00:48:24,000 --> 00:48:35,040
before we finish off the talk for today

1431
00:48:35,040 --> 00:48:38,400
okay we have one question here is it

1432
00:48:38,400 --> 00:48:39,920
relevant to analyze

1433
00:48:39,920 --> 00:48:42,400
the network traffic of a specific

1434
00:48:42,400 --> 00:48:43,680
application

1435
00:48:43,680 --> 00:48:46,000
if it isn't suspect with the data from

1436
00:48:46,000 --> 00:48:47,040
the apk

1437
00:48:47,040 --> 00:48:50,640
itself if the

1438
00:48:50,640 --> 00:48:53,440
so let's see if i so is it relevant to

1439
00:48:53,440 --> 00:48:54,319
analyze the

1440
00:48:54,319 --> 00:48:57,520
network traffic for the apk if it's not

1441
00:48:57,520 --> 00:48:59,200
relevant to the apk itself so like if

1442
00:48:59,200 --> 00:49:01,040
the device is just reaching out

1443
00:49:01,040 --> 00:49:03,839
to a given network

1444
00:49:05,119 --> 00:49:08,400
let's see um men elk are

1445
00:49:08,400 --> 00:49:10,880
is that uh your question essentially do

1446
00:49:10,880 --> 00:49:14,720
you want to clarify in the twitch chat

1447
00:49:14,839 --> 00:49:17,839
here

1448
00:49:18,400 --> 00:49:19,599
i think what i'll do for you as well

1449
00:49:19,599 --> 00:49:21,920
david i'll drop these questions into uh

1450
00:49:21,920 --> 00:49:23,680
the zoom chat on your side so you can

1451
00:49:23,680 --> 00:49:25,920
just read them on your end as well

1452
00:49:25,920 --> 00:49:31,839
because i'm asking them

1453
00:49:38,640 --> 00:49:41,040
oh yeah it's so i believe the question

1454
00:49:41,040 --> 00:49:43,520
if i'm understanding it correctly is

1455
00:49:43,520 --> 00:49:45,359
is it relevant to look at network

1456
00:49:45,359 --> 00:49:46,960
traffic even if it doesn't appear

1457
00:49:46,960 --> 00:49:48,880
suspect

1458
00:49:48,880 --> 00:49:51,520
and so if if that is indeed the question

1459
00:49:51,520 --> 00:49:52,480
uh definitely

1460
00:49:52,480 --> 00:49:55,599
so this traffic itself is not suspect

1461
00:49:55,599 --> 00:49:59,760
it's just insecure but it's definitely

1462
00:49:59,760 --> 00:50:01,680
but it's definitely very relevant

1463
00:50:01,680 --> 00:50:02,800
because from here

1464
00:50:02,800 --> 00:50:05,200
we were able to get other applications

1465
00:50:05,200 --> 00:50:07,280
that use the same network traffic

1466
00:50:07,280 --> 00:50:08,640
so even if you're not looking at a

1467
00:50:08,640 --> 00:50:10,720
malicious apk

1468
00:50:10,720 --> 00:50:13,119
if you are looking at a developer or an

1469
00:50:13,119 --> 00:50:14,640
organization that makes

1470
00:50:14,640 --> 00:50:16,800
that application it's very relevant

1471
00:50:16,800 --> 00:50:18,400
because it's the best way to map out

1472
00:50:18,400 --> 00:50:21,280
their infrastructure

1473
00:50:24,839 --> 00:50:27,599
fantastic i got another question here

1474
00:50:27,599 --> 00:50:28,559
for you david

1475
00:50:28,559 --> 00:50:31,520
um the question is what can we get for

1476
00:50:31,520 --> 00:50:32,559
more advanced

1477
00:50:32,559 --> 00:50:36,000
forensics for android and how can a

1478
00:50:36,000 --> 00:50:37,359
forensic analyst

1479
00:50:37,359 --> 00:50:40,720
use it to solve and how can an attacker

1480
00:50:40,720 --> 00:50:43,440
misuse it just drop the question as well

1481
00:50:43,440 --> 00:50:44,640
for you and then zoom chat

1482
00:50:44,640 --> 00:50:46,000
yeah i'm just trying to think of a

1483
00:50:46,000 --> 00:50:48,640
concise way to answer this um let's see

1484
00:50:48,640 --> 00:50:50,880
so from a forensics perspective it would

1485
00:50:50,880 --> 00:50:53,200
depend on what the investigation context

1486
00:50:53,200 --> 00:50:55,520
was so if you were looking

1487
00:50:55,520 --> 00:50:57,359
to see what someone was doing from a

1488
00:50:57,359 --> 00:50:59,680
nefarious perspective

1489
00:50:59,680 --> 00:51:02,079
you could very easily and there's a lot

1490
00:51:02,079 --> 00:51:04,240
of great training on this that's free

1491
00:51:04,240 --> 00:51:06,160
but you can look at a device very

1492
00:51:06,160 --> 00:51:09,119
similarly to how you would look at a pc

1493
00:51:09,119 --> 00:51:12,960
so they have the same folder structure

1494
00:51:12,960 --> 00:51:15,440
and they have the same applications so

1495
00:51:15,440 --> 00:51:16,240
that is

1496
00:51:16,240 --> 00:51:19,280
is pretty easy it just depends on how

1497
00:51:19,280 --> 00:51:20,960
you want to approach it so if you want

1498
00:51:20,960 --> 00:51:22,000
to use a professional

1499
00:51:22,000 --> 00:51:23,599
tool if you are using this for

1500
00:51:23,599 --> 00:51:25,119
investigations i would recommend a

1501
00:51:25,119 --> 00:51:26,319
professional tool

1502
00:51:26,319 --> 00:51:28,240
because most of the open source ways to

1503
00:51:28,240 --> 00:51:29,760
do this are not great

1504
00:51:29,760 --> 00:51:32,640
the open source way to do it would be to

1505
00:51:32,640 --> 00:51:32,960
use

1506
00:51:32,960 --> 00:51:36,400
adb to interact with the application and

1507
00:51:36,400 --> 00:51:39,680
the device itself but if you want to do

1508
00:51:39,680 --> 00:51:41,359
this from a forensic perspective of how

1509
00:51:41,359 --> 00:51:43,280
to analyze what an apk does

1510
00:51:43,280 --> 00:51:45,440
an open source way to do this would be a

1511
00:51:45,440 --> 00:51:46,880
tool called mob sf

1512
00:51:46,880 --> 00:51:49,839
or the mobile security framework the

1513
00:51:49,839 --> 00:51:52,160
mobile security framework's free

1514
00:51:52,160 --> 00:51:54,400
and it keeps track of everything that a

1515
00:51:54,400 --> 00:51:57,040
device does so what files are created

1516
00:51:57,040 --> 00:51:58,880
the hashes of all those files it takes

1517
00:51:58,880 --> 00:52:00,960
screenshots of the interaction

1518
00:52:00,960 --> 00:52:03,760
it also will get all of the network

1519
00:52:03,760 --> 00:52:05,520
traffic and allow you to replay it to a

1520
00:52:05,520 --> 00:52:06,480
fuzzer

1521
00:52:06,480 --> 00:52:08,960
so for this particular research

1522
00:52:08,960 --> 00:52:10,880
investigation i use the fuzzer to get

1523
00:52:10,880 --> 00:52:13,200
all their vpn ips

1524
00:52:13,200 --> 00:52:15,040
if you want to do it from a forensic

1525
00:52:15,040 --> 00:52:16,720
perspective or you need to pass it off

1526
00:52:16,720 --> 00:52:17,359
it's also

1527
00:52:17,359 --> 00:52:19,520
a great tool because it can create pdf

1528
00:52:19,520 --> 00:52:20,400
reports

1529
00:52:20,400 --> 00:52:22,480
so that would be the open source option

1530
00:52:22,480 --> 00:52:23,760
i would recommend

1531
00:52:23,760 --> 00:52:27,119
it's far better in my opinion than

1532
00:52:27,119 --> 00:52:29,359
unfortunately the sandbox in things like

1533
00:52:29,359 --> 00:52:30,880
virustotal

1534
00:52:30,880 --> 00:52:32,480
and it's the best way to do it if you're

1535
00:52:32,480 --> 00:52:33,839
looking at an investigation you don't

1536
00:52:33,839 --> 00:52:35,599
want to be made public

1537
00:52:35,599 --> 00:52:37,520
you can do it man in the middle proxies

1538
00:52:37,520 --> 00:52:39,040
so if you don't want it to

1539
00:52:39,040 --> 00:52:40,720
you don't have to do outbound network

1540
00:52:40,720 --> 00:52:42,079
that's just a good way to get file

1541
00:52:42,079 --> 00:52:44,480
creates

1542
00:52:45,200 --> 00:52:47,200
great i had a quick follow-up question

1543
00:52:47,200 --> 00:52:49,359
on that david from someone in the chat

1544
00:52:49,359 --> 00:52:51,119
they were asking what the name of that

1545
00:52:51,119 --> 00:52:52,720
open source option was

1546
00:52:52,720 --> 00:52:55,280
again sure it's the mobile security

1547
00:52:55,280 --> 00:52:56,559
framework

1548
00:52:56,559 --> 00:53:00,319
if you just type mob sf plus get

1549
00:53:00,319 --> 00:53:02,480
on a search engine it'll bring it up for

1550
00:53:02,480 --> 00:53:03,599
you

1551
00:53:03,599 --> 00:53:06,160
but it's my go-to option for android

1552
00:53:06,160 --> 00:53:07,359
analysis

1553
00:53:07,359 --> 00:53:09,520
just because it's so easy to use there's

1554
00:53:09,520 --> 00:53:11,440
even a docker option

1555
00:53:11,440 --> 00:53:14,559
and it has a public facing interface

1556
00:53:14,559 --> 00:53:16,640
on the host that you stand it up on so

1557
00:53:16,640 --> 00:53:18,160
you have a web server to actually

1558
00:53:18,160 --> 00:53:19,680
interact with frida

1559
00:53:19,680 --> 00:53:21,280
because if you've ever tried to use

1560
00:53:21,280 --> 00:53:23,040
frida before manually

1561
00:53:23,040 --> 00:53:25,760
it's doable but it's not the most

1562
00:53:25,760 --> 00:53:26,960
intuitive thing

1563
00:53:26,960 --> 00:53:29,040
this will actually dynamically control

1564
00:53:29,040 --> 00:53:30,480
freedom for you

1565
00:53:30,480 --> 00:53:33,359
and it works with jenny motion free so

1566
00:53:33,359 --> 00:53:36,000
also a free option for doing emulation

1567
00:53:36,000 --> 00:53:39,280
jd motion has a just for fun

1568
00:53:39,280 --> 00:53:41,440
option that doesn't require payment and

1569
00:53:41,440 --> 00:53:43,280
then you can use mob sf

1570
00:53:43,280 --> 00:53:45,680
to interact with the genymotion and you

1571
00:53:45,680 --> 00:53:47,280
can create everything i believe from

1572
00:53:47,280 --> 00:53:48,160
android 5

1573
00:53:48,160 --> 00:53:51,280
up to android 10 and then analyze how it

1574
00:53:51,280 --> 00:53:52,559
interacts with

1575
00:53:52,559 --> 00:53:56,720
each sdk target great

1576
00:53:56,720 --> 00:53:58,720
thank you so much for that david so we

1577
00:53:58,720 --> 00:54:00,480
have just about one more minute left

1578
00:54:00,480 --> 00:54:01,440
before we're gonna

1579
00:54:01,440 --> 00:54:04,240
finish off the talk had a couple more

1580
00:54:04,240 --> 00:54:06,640
questions but i think we'll just go with

1581
00:54:06,640 --> 00:54:09,839
one more for now um so the next question

1582
00:54:09,839 --> 00:54:10,640
is

1583
00:54:10,640 --> 00:54:13,280
do you know how to identify if a phone

1584
00:54:13,280 --> 00:54:14,400
has been hacked

1585
00:54:14,400 --> 00:54:17,200
by looking at a dd image that is a

1586
00:54:17,200 --> 00:54:17,920
question

1587
00:54:17,920 --> 00:54:21,599
okay yeah so the i'm guessing the base

1588
00:54:21,599 --> 00:54:23,200
assumption would be

1589
00:54:23,200 --> 00:54:26,079
um if you have the dd image you could

1590
00:54:26,079 --> 00:54:27,040
mount it and see if

1591
00:54:27,040 --> 00:54:29,680
root um if the phone had been rooted

1592
00:54:29,680 --> 00:54:31,280
there are a bunch of free utilities

1593
00:54:31,280 --> 00:54:33,599
i can't remember the names off the top

1594
00:54:33,599 --> 00:54:34,960
of my head

1595
00:54:34,960 --> 00:54:36,720
but there's a quick way to see if it's

1596
00:54:36,720 --> 00:54:38,880
been rooted uh the the term

1597
00:54:38,880 --> 00:54:41,280
hacked i guess you'd have to define what

1598
00:54:41,280 --> 00:54:42,000
what you

1599
00:54:42,000 --> 00:54:44,400
want that to mean so the question is

1600
00:54:44,400 --> 00:54:46,160
does it have malicious software

1601
00:54:46,160 --> 00:54:47,359
installed on it

1602
00:54:47,359 --> 00:54:49,760
um like spyware or a keylogger or

1603
00:54:49,760 --> 00:54:51,280
something like that

1604
00:54:51,280 --> 00:54:53,440
the best place to start looking would be

1605
00:54:53,440 --> 00:54:55,440
in the installed services

1606
00:54:55,440 --> 00:54:58,720
and the installed applications

1607
00:54:58,720 --> 00:55:00,640
but that yeah the the term hacked it

1608
00:55:00,640 --> 00:55:01,920
just would depend

1609
00:55:01,920 --> 00:55:03,520
because some people take hack to mean is

1610
00:55:03,520 --> 00:55:05,119
the phone rooted

1611
00:55:05,119 --> 00:55:06,480
other people take it to me and it's

1612
00:55:06,480 --> 00:55:08,400
their malicious software installed on it

1613
00:55:08,400 --> 00:55:09,920
but the installed services and

1614
00:55:09,920 --> 00:55:11,920
applications especially if you only have

1615
00:55:11,920 --> 00:55:12,880
the dd

1616
00:55:12,880 --> 00:55:15,920
would be the best place to start

1617
00:55:15,920 --> 00:55:18,319
fantastic thank you so much for that

1618
00:55:18,319 --> 00:55:19,520
david

1619
00:55:19,520 --> 00:55:21,760
and that brings us to the end of david's

1620
00:55:21,760 --> 00:55:22,559
talk

1621
00:55:22,559 --> 00:55:23,920
i want to thank everyone for coming out

1622
00:55:23,920 --> 00:55:26,559
to this first talk of track three

1623
00:55:26,559 --> 00:55:28,640
david thank you so much again for

1624
00:55:28,640 --> 00:55:30,319
joining us for the first edition of

1625
00:55:30,319 --> 00:55:31,440
content

1626
00:55:31,440 --> 00:55:33,520
we will now be taking a short

1627
00:55:33,520 --> 00:55:35,520
five-minute break as we transition to

1628
00:55:35,520 --> 00:55:36,880
our next speaker

1629
00:55:36,880 --> 00:55:39,359
dhruv magendar where he will be giving a

1630
00:55:39,359 --> 00:55:40,640
talk on

1631
00:55:40,640 --> 00:55:44,160
cti and threat hunting so come back on

1632
00:55:44,160 --> 00:55:45,839
in five minutes to hear from dhruv

1633
00:55:45,839 --> 00:55:48,319
and thank you again david thanks for

1634
00:55:48,319 --> 00:55:51,599
having me

