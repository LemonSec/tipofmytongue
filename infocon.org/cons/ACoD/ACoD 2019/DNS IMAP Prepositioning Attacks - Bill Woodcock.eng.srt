1
00:00:00,030 --> 00:00:07,440
howdy<font color="#E5E5E5"> so this is the talk that is on the</font>

2
00:00:04,170 --> 00:00:09,210
schedule<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it isn't really</font>

3
00:00:07,440 --> 00:00:12,750
it isn't really<font color="#E5E5E5"> where my head has been</font>

4
00:00:09,210 --> 00:00:14,670
<font color="#E5E5E5">in the last</font><font color="#CCCCCC"> couple of weeks so we</font>

5
00:00:12,750 --> 00:00:19,230
decided<font color="#CCCCCC"> that maybe it would be more</font>

6
00:00:14,670 --> 00:00:21,840
<font color="#CCCCCC">useful</font><font color="#E5E5E5"> if I</font><font color="#CCCCCC"> talked about what</font><font color="#E5E5E5"> I have</font>

7
00:00:19,230 --> 00:00:23,310
been<font color="#E5E5E5"> working</font><font color="#CCCCCC"> on in the last</font><font color="#E5E5E5"> few</font><font color="#CCCCCC"> weeks as</font>

8
00:00:21,840 --> 00:00:27,448
have a couple of other<font color="#E5E5E5"> people in the</font>

9
00:00:23,310 --> 00:00:29,609
<font color="#E5E5E5">room here</font><font color="#CCCCCC"> you may</font><font color="#E5E5E5"> have seen some</font>

10
00:00:27,449 --> 00:00:32,969
announcements<font color="#E5E5E5"> from DHS over the last</font>

11
00:00:29,609 --> 00:00:36,290
<font color="#CCCCCC">couple of</font><font color="#E5E5E5"> weeks about a very large</font>

12
00:00:32,969 --> 00:00:41,399
<font color="#E5E5E5">series of DNS hijackings and</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> map</font>

13
00:00:36,290 --> 00:00:46,559
credential theft<font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'm bill Woodcock</font>

14
00:00:41,399 --> 00:00:51,539
<font color="#E5E5E5">I'm with PCH we operate a very large DNS</font>

15
00:00:46,559 --> 00:00:55,680
Network<font color="#E5E5E5"> and so of the organizations that</font>

16
00:00:51,539 --> 00:00:58,109
were targeted<font color="#E5E5E5"> in this attack were</font>

17
00:00:55,680 --> 00:01:01,949
probably<font color="#E5E5E5"> the</font><font color="#CCCCCC"> only one in a</font><font color="#E5E5E5"> position to</font>

18
00:00:58,109 --> 00:01:04,619
talk about it<font color="#CCCCCC"> so I'm gonna give a bit of</font>

19
00:01:01,949 --> 00:01:06,600
<font color="#CCCCCC">a briefing on what it is</font><font color="#E5E5E5"> the DHS was</font>

20
00:01:04,619 --> 00:01:12,090
talking about<font color="#E5E5E5"> when they issued all those</font>

21
00:01:06,600 --> 00:01:14,009
recommendations<font color="#E5E5E5"> so first of all there</font>

22
00:01:12,090 --> 00:01:16,080
has been a bit published on this the

23
00:01:14,010 --> 00:01:18,570
first<font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> came out</font><font color="#CCCCCC"> was in the</font>

24
00:01:16,080 --> 00:01:21,539
middle<font color="#E5E5E5"> of November</font><font color="#CCCCCC"> the Cisco tell us</font>

25
00:01:18,570 --> 00:01:23,189
guys published<font color="#E5E5E5"> they had a little bit of</font>

26
00:01:21,540 --> 00:01:26,490
a view<font color="#CCCCCC"> into it and so what they were</font>

27
00:01:23,189 --> 00:01:29,100
seeing was<font color="#CCCCCC"> DNS hijacking targeting</font>

28
00:01:26,490 --> 00:01:32,789
middle eastern governments so that<font color="#CCCCCC"> one</font>

29
00:01:29,100 --> 00:01:39,210
<font color="#E5E5E5">references I believe Saudi UAE and</font>

30
00:01:32,790 --> 00:01:44,659
Lebanon<font color="#E5E5E5"> governments more recently in the</font>

31
00:01:39,210 --> 00:01:47,429
third week of<font color="#CCCCCC"> January DHS did a</font><font color="#E5E5E5"> bunch of</font>

32
00:01:44,659 --> 00:01:49,560
announcement well<font color="#E5E5E5"> January 10 was the</font>

33
00:01:47,430 --> 00:01:52,320
<font color="#E5E5E5">first one which didn't have a lot of</font>

34
00:01:49,560 --> 00:01:54,420
<font color="#E5E5E5">detail and</font><font color="#CCCCCC"> they've they've talked a bit</font>

35
00:01:52,320 --> 00:01:57,809
about it since then

36
00:01:54,420 --> 00:02:00,090
GCHQ same thing mandiant<font color="#E5E5E5"> has published a</font>

37
00:01:57,810 --> 00:02:03,570
blog posting<font color="#E5E5E5"> and there have</font><font color="#CCCCCC"> been a</font>

38
00:02:00,090 --> 00:02:05,520
couple of ours tech articles which again

39
00:02:03,570 --> 00:02:08,369
none of these present<font color="#E5E5E5"> too much</font>

40
00:02:05,520 --> 00:02:10,679
<font color="#CCCCCC">information about what</font><font color="#E5E5E5"> happened</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> of</font>

41
00:02:08,369 --> 00:02:13,510
the<font color="#E5E5E5"> ARS tech articles is probably the</font>

42
00:02:10,679 --> 00:02:17,830
best overview that's<font color="#E5E5E5"> there</font>

43
00:02:13,510 --> 00:02:21,340
but they they didn't talk with any<font color="#CCCCCC"> of</font>

44
00:02:17,830 --> 00:02:23,800
the actual<font color="#E5E5E5"> victim organizations so that</font>

45
00:02:21,340 --> 00:02:26,260
<font color="#CCCCCC">the overview they have is largely</font>

46
00:02:23,800 --> 00:02:27,670
garnered<font color="#E5E5E5"> from talking to threat Intel</font>

47
00:02:26,260 --> 00:02:29,530
folks who were<font color="#CCCCCC"> themselves trying</font><font color="#E5E5E5"> to</font>

48
00:02:27,670 --> 00:02:31,958
figure out<font color="#E5E5E5"> what was</font><font color="#CCCCCC"> going on</font><font color="#E5E5E5"> by looking</font>

49
00:02:29,530 --> 00:02:34,300
<font color="#CCCCCC">at sort of little through the keyhole</font>

50
00:02:31,959 --> 00:02:39,190
views that they had<font color="#E5E5E5"> into the attack</font>

51
00:02:34,300 --> 00:02:40,989
process so<font color="#E5E5E5"> I can I'll give sort of the</font>

52
00:02:39,190 --> 00:02:44,290
briefing<font color="#E5E5E5"> and then I can answer</font><font color="#CCCCCC"> questions</font>

53
00:02:40,989 --> 00:02:45,790
about<font color="#E5E5E5"> what this looked like</font><font color="#CCCCCC"> and the</font>

54
00:02:44,290 --> 00:02:49,298
<font color="#E5E5E5">interesting thing to</font><font color="#CCCCCC"> know is that</font><font color="#E5E5E5"> this</font>

55
00:02:45,790 --> 00:02:54,430
is<font color="#CCCCCC"> an ongoing attack this</font><font color="#E5E5E5"> is not stopped</font>

56
00:02:49,299 --> 00:02:56,680
or slowed down<font color="#CCCCCC"> so targets so far have</font>

57
00:02:54,430 --> 00:02:59,349
been<font color="#E5E5E5"> mostly national governments and</font>

58
00:02:56,680 --> 00:03:02,590
critical infrastructure<font color="#E5E5E5"> operators but</font>

59
00:02:59,349 --> 00:03:05,768
mostly national governments and this is

60
00:03:02,590 --> 00:03:09,069
military<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's pre positioning right</font>

61
00:03:05,769 --> 00:03:12,130
so they're trying to backdoor things<font color="#E5E5E5"> so</font>

62
00:03:09,069 --> 00:03:15,480
that they<font color="#E5E5E5"> can ensure ongoing access so</font>

63
00:03:12,130 --> 00:03:18,579
<font color="#CCCCCC">that they can then use</font><font color="#E5E5E5"> these assets in</font>

64
00:03:15,480 --> 00:03:22,840
future attacks<font color="#E5E5E5"> right they're not they're</font>

65
00:03:18,579 --> 00:03:25,060
not just they're not<font color="#CCCCCC"> after</font><font color="#E5E5E5"> your email</font>

66
00:03:22,840 --> 00:03:29,760
<font color="#E5E5E5">the</font><font color="#CCCCCC"> email was</font><font color="#E5E5E5"> a way to get into systems</font>

67
00:03:25,060 --> 00:03:33,489
<font color="#E5E5E5">so that</font><font color="#CCCCCC"> they can rootkit the systems and</font>

68
00:03:29,760 --> 00:03:35,739
maintain ongoing visibility<font color="#E5E5E5"> and they've</font>

69
00:03:33,489 --> 00:03:39,250
got a lot of<font color="#E5E5E5"> a lot of people hours to</font>

70
00:03:35,739 --> 00:03:41,380
throw at<font color="#E5E5E5"> this</font><font color="#CCCCCC"> so they're being</font><font color="#E5E5E5"> very</font>

71
00:03:39,250 --> 00:03:45,790
thorough

72
00:03:41,380 --> 00:03:48,280
the timing<font color="#CCCCCC"> eastern</font><font color="#E5E5E5"> governments run</font>

73
00:03:45,790 --> 00:03:52,060
<font color="#E5E5E5">mostly on expats if you are a</font>

74
00:03:48,280 --> 00:03:54,100
self-respecting<font color="#CCCCCC"> Saudi you do not</font>

75
00:03:52,060 --> 00:03:56,250
actually<font color="#E5E5E5"> do work yourself you hire a</font>

76
00:03:54,100 --> 00:03:59,230
Brit to come and do your<font color="#E5E5E5"> work for you</font>

77
00:03:56,250 --> 00:04:02,019
<font color="#CCCCCC">and then you have to</font><font color="#E5E5E5"> let the Brit go</font>

78
00:03:59,230 --> 00:04:04,179
back to the UK<font color="#CCCCCC"> for the</font><font color="#E5E5E5"> holidays at the</font>

79
00:04:02,019 --> 00:04:07,090
<font color="#E5E5E5">end of the year which</font><font color="#CCCCCC"> is typically</font><font color="#E5E5E5"> three</font>

80
00:04:04,180 --> 00:04:09,010
weeks<font color="#E5E5E5"> sometimes four so basically the</font>

81
00:04:07,090 --> 00:04:11,410
<font color="#E5E5E5">entire Middle East shuts down from a</font>

82
00:04:09,010 --> 00:04:15,040
governmental<font color="#E5E5E5"> perspective for about a</font>

83
00:04:11,410 --> 00:04:18,399
month<font color="#CCCCCC"> around the end of each year</font><font color="#E5E5E5"> so</font>

84
00:04:15,040 --> 00:04:20,139
this was how the attacks were timed the

85
00:04:18,399 --> 00:04:22,179
US government<font color="#E5E5E5"> also shutting down for</font>

86
00:04:20,139 --> 00:04:25,750
<font color="#CCCCCC">about</font><font color="#E5E5E5"> a month around the</font><font color="#CCCCCC"> beginning of</font>

87
00:04:22,180 --> 00:04:28,000
the year was unfortunate<font color="#CCCCCC"> self-inflicted</font>

88
00:04:25,750 --> 00:04:34,960
<font color="#E5E5E5">whatever here</font>

89
00:04:28,000 --> 00:04:37,389
and was I'm very very grateful<font color="#E5E5E5"> to the</font>

90
00:04:34,960 --> 00:04:39,870
DHS people who stuck around<font color="#E5E5E5"> and did</font>

91
00:04:37,389 --> 00:04:42,490
their jobs diligently<font color="#E5E5E5"> through all this</font>

92
00:04:39,870 --> 00:04:45,699
<font color="#E5E5E5">despite</font><font color="#CCCCCC"> all the problems</font><font color="#E5E5E5"> they worked</font>

93
00:04:42,490 --> 00:04:50,050
<font color="#E5E5E5">really hard and weren't getting paid for</font>

94
00:04:45,699 --> 00:04:55,150
it<font color="#CCCCCC"> so this is sort</font><font color="#E5E5E5"> of the meat of the</font>

95
00:04:50,050 --> 00:04:56,949
center<font color="#E5E5E5"> of the slide</font><font color="#CCCCCC"> deck the way and</font>

96
00:04:55,150 --> 00:05:00,539
this this<font color="#E5E5E5"> is detailing how it worked</font>

97
00:04:56,949 --> 00:05:03,039
<font color="#E5E5E5">with us</font><font color="#CCCCCC"> there are</font><font color="#E5E5E5"> parts of this</font><font color="#CCCCCC"> that</font>

98
00:05:00,539 --> 00:05:05,849
were done slightly<font color="#CCCCCC"> differently in</font>

99
00:05:03,039 --> 00:05:09,190
different attacks that I'm aware of<font color="#CCCCCC"> but</font>

100
00:05:05,849 --> 00:05:12,690
<font color="#E5E5E5">basically it follows this pattern</font><font color="#CCCCCC"> so it</font>

101
00:05:09,190 --> 00:05:20,139
starts<font color="#E5E5E5"> with a DNS hijack</font><font color="#CCCCCC"> for us they</font>

102
00:05:12,690 --> 00:05:22,270
broke into the<font color="#CCCCCC"> registrar</font><font color="#E5E5E5"> EPP interface</font>

103
00:05:20,139 --> 00:05:24,789
so extensible provisioning protocol is

104
00:05:22,270 --> 00:05:27,340
<font color="#E5E5E5">the API that registries and registrar's</font>

105
00:05:24,789 --> 00:05:29,710
<font color="#CCCCCC">use</font><font color="#E5E5E5"> to talk to</font><font color="#CCCCCC"> each</font><font color="#E5E5E5"> other for a domain</font>

106
00:05:27,340 --> 00:05:32,560
<font color="#CCCCCC">name provisioning</font><font color="#E5E5E5"> right so if you</font>

107
00:05:29,710 --> 00:05:34,180
register a domain name<font color="#E5E5E5"> and your</font>

108
00:05:32,560 --> 00:05:38,319
information<font color="#CCCCCC"> needs to</font><font color="#E5E5E5"> go into the Whois</font>

109
00:05:34,180 --> 00:05:40,690
<font color="#E5E5E5">or it did before</font><font color="#CCCCCC"> gdpr and you need to</font>

110
00:05:38,319 --> 00:05:42,490
set your NS records and your<font color="#CCCCCC"> DS records</font>

111
00:05:40,690 --> 00:05:47,110
and so forth<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> that gets</font>

112
00:05:42,490 --> 00:05:51,009
communicated through EPP protocol and<font color="#E5E5E5"> EP</font>

113
00:05:47,110 --> 00:05:54,039
of course is authenticated<font color="#E5E5E5"> so they got</font>

114
00:05:51,009 --> 00:05:57,430
EPP<font color="#CCCCCC"> credentials that allowed them to get</font>

115
00:05:54,039 --> 00:05:59,710
<font color="#E5E5E5">into the registrar and compromise us and</font>

116
00:05:57,430 --> 00:06:03,270
several<font color="#CCCCCC"> other critical infrastructure</font>

117
00:05:59,710 --> 00:06:07,479
operators<font color="#E5E5E5"> that were using that registrar</font>

118
00:06:03,270 --> 00:06:09,758
<font color="#CCCCCC">that in</font><font color="#E5E5E5"> turn passed the instructions to</font>

119
00:06:07,479 --> 00:06:11,229
the<font color="#CCCCCC"> registrar wholesaler who in turn</font>

120
00:06:09,759 --> 00:06:13,629
<font color="#CCCCCC">passed through</font><font color="#E5E5E5"> instructions to the</font>

121
00:06:11,229 --> 00:06:17,860
registry<font color="#E5E5E5"> Verisign</font><font color="#CCCCCC"> in this case because</font>

122
00:06:13,629 --> 00:06:20,979
we were in<font color="#CCCCCC"> dotnet</font><font color="#E5E5E5"> so interesting thing</font>

123
00:06:17,860 --> 00:06:23,319
here is at each stage there<font color="#E5E5E5"> was an</font>

124
00:06:20,979 --> 00:06:27,128
opportunity<font color="#CCCCCC"> to validate whether the</font>

125
00:06:23,319 --> 00:06:29,430
instructions were useful instructions to

126
00:06:27,129 --> 00:06:37,169
do productive work or were a hijack and

127
00:06:29,430 --> 00:06:40,780
nobody ever did any validation<font color="#E5E5E5"> so at the</font>

128
00:06:37,169 --> 00:06:44,090
<font color="#CCCCCC">Registrar wholesaler level</font>

129
00:06:40,780 --> 00:06:48,318
they were very<font color="#CCCCCC"> apologetic and interested</font>

130
00:06:44,090 --> 00:06:52,188
in adopting new better practices at<font color="#E5E5E5"> the</font>

131
00:06:48,319 --> 00:06:54,050
registry level<font color="#CCCCCC"> I think the position</font><font color="#E5E5E5"> is</font>

132
00:06:52,189 --> 00:06:58,009
<font color="#E5E5E5">they're just too many of these folks out</font>

133
00:06:54,050 --> 00:07:01,129
<font color="#CCCCCC">there we want to let them carry the</font>

134
00:06:58,009 --> 00:07:05,120
liability for mistakes<font color="#E5E5E5"> we don't want to</font>

135
00:07:01,129 --> 00:07:08,990
assume<font color="#CCCCCC"> that liability okay</font>

136
00:07:05,120 --> 00:07:13,520
so what was actually<font color="#E5E5E5"> done</font><font color="#CCCCCC"> is they used</font>

137
00:07:08,990 --> 00:07:18,169
that credential<font color="#E5E5E5"> to add an NS</font><font color="#CCCCCC"> record for</font>

138
00:07:13,520 --> 00:07:22,599
our<font color="#CCCCCC"> domain for one-hour periods</font><font color="#E5E5E5"> four</font>

139
00:07:18,169 --> 00:07:25,698
times between<font color="#E5E5E5"> December 13 and January to</font>

140
00:07:22,599 --> 00:07:28,370
doing that time in order<font color="#CCCCCC"> to escape</font>

141
00:07:25,699 --> 00:07:30,770
detection<font color="#CCCCCC"> they had to keep answering DNS</font>

142
00:07:28,370 --> 00:07:32,810
queries<font color="#E5E5E5"> so they had their</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> name</font>

143
00:07:30,770 --> 00:07:37,609
server<font color="#E5E5E5"> that was sitting there and would</font>

144
00:07:32,810 --> 00:07:43,939
take any query aimed at<font color="#E5E5E5"> our domains and</font>

145
00:07:37,610 --> 00:07:45,680
it<font color="#CCCCCC"> would then query Google 8.8.8.8</font><font color="#E5E5E5"> to</font>

146
00:07:43,939 --> 00:07:49,069
get an answer and it would hand back

147
00:07:45,680 --> 00:07:51,650
that<font color="#E5E5E5"> answer except if the origin</font><font color="#CCCCCC"> of the</font>

148
00:07:49,069 --> 00:07:52,129
query was from<font color="#E5E5E5"> Komodo</font><font color="#CCCCCC"> if it was</font><font color="#E5E5E5"> from</font>

149
00:07:51,650 --> 00:07:54,258
Komodo

150
00:07:52,129 --> 00:07:57,050
<font color="#E5E5E5">it would give back a different</font><font color="#CCCCCC"> answer</font>

151
00:07:54,259 --> 00:08:00,050
that went to one<font color="#CCCCCC"> of their</font><font color="#E5E5E5"> servers</font><font color="#CCCCCC"> the</font>

152
00:07:57,050 --> 00:08:05,360
goal<font color="#E5E5E5"> of which was</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get Komodo</font><font color="#CCCCCC"> to issue</font>

153
00:08:00,050 --> 00:08:08,330
an SSL cert<font color="#E5E5E5"> for our domain</font><font color="#CCCCCC"> name which</font>

154
00:08:05,360 --> 00:08:11,389
they got we were the first<font color="#E5E5E5"> one that they</font>

155
00:08:08,330 --> 00:08:16,490
used a Komodo cert on prior<font color="#CCCCCC"> to us they'd</font>

156
00:08:11,389 --> 00:08:18,110
used<font color="#E5E5E5"> all let's encrypt certs</font><font color="#CCCCCC"> and it</font>

157
00:08:16,490 --> 00:08:21,639
turned out<font color="#CCCCCC"> that no due diligence was</font>

158
00:08:18,110 --> 00:08:25,310
being done there<font color="#E5E5E5"> either</font><font color="#CCCCCC"> write a single</font>

159
00:08:21,639 --> 00:08:28,490
DNS SEC validated lookup would tell them

160
00:08:25,310 --> 00:08:31,180
<font color="#E5E5E5">that this was a hijack request not a</font>

161
00:08:28,490 --> 00:08:36,229
valid<font color="#CCCCCC"> request</font><font color="#E5E5E5"> but they didn't do that</font>

162
00:08:31,180 --> 00:08:38,000
<font color="#CCCCCC">the business</font><font color="#E5E5E5"> process in both case their</font>

163
00:08:36,229 --> 00:08:40,610
cases<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> documented business</font>

164
00:08:38,000 --> 00:08:42,229
processes<font color="#CCCCCC"> that their registrar's are</font>

165
00:08:40,610 --> 00:08:44,600
supposed to be following<font color="#E5E5E5"> and that the</font>

166
00:08:42,229 --> 00:08:47,630
<font color="#E5E5E5">SSL issuers are supposed to be</font><font color="#CCCCCC"> following</font>

167
00:08:44,600 --> 00:08:52,750
<font color="#E5E5E5">and we've got the packet traces that</font>

168
00:08:47,630 --> 00:08:52,750
show that they weren't<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> it in the</font>

169
00:08:53,769 --> 00:09:01,279
in the SSL<font color="#E5E5E5"> cert a certificate authority</font>

170
00:08:58,189 --> 00:09:02,930
<font color="#E5E5E5">case I believe what the business process</font>

171
00:09:01,279 --> 00:09:05,059
says is that<font color="#CCCCCC"> they're supposed to do the</font>

172
00:09:02,930 --> 00:09:06,620
checks<font color="#E5E5E5"> and then if the checks fail</font>

173
00:09:05,059 --> 00:09:10,519
they're still allowed<font color="#CCCCCC"> to issue the</font>

174
00:09:06,620 --> 00:09:13,569
certificate<font color="#CCCCCC"> we can see that</font><font color="#E5E5E5"> they didn't</font>

175
00:09:10,519 --> 00:09:13,569
even<font color="#E5E5E5"> do the checks yes sir</font>

176
00:09:25,060 --> 00:09:28,979
sorry at what level are we talking about

177
00:09:31,260 --> 00:09:41,830
so I don't<font color="#CCCCCC"> know I mean</font><font color="#E5E5E5"> Verisign</font><font color="#CCCCCC"> the</font>

178
00:09:39,340 --> 00:09:44,920
question is what at each of these two

179
00:09:41,830 --> 00:09:46,690
<font color="#E5E5E5">levels like where we have this</font><font color="#CCCCCC"> hierarchy</font>

180
00:09:44,920 --> 00:09:47,829
of registrar to register our wholesaler

181
00:09:46,690 --> 00:09:51,670
<font color="#CCCCCC">to</font><font color="#E5E5E5"> registry</font>

182
00:09:47,830 --> 00:09:54,580
how many EPP<font color="#E5E5E5"> change requests are</font><font color="#CCCCCC"> coming</font>

183
00:09:51,670 --> 00:09:58,229
in and so like what would<font color="#E5E5E5"> the ratio of</font>

184
00:09:54,580 --> 00:10:00,880
<font color="#E5E5E5">of</font><font color="#CCCCCC"> highjack to valid requests be and</font>

185
00:09:58,230 --> 00:10:03,310
with the SSL<font color="#E5E5E5"> Certificates what would the</font>

186
00:10:00,880 --> 00:10:07,260
ratio of<font color="#CCCCCC"> highjack to valid requests be</font><font color="#E5E5E5"> I</font>

187
00:10:03,310 --> 00:10:10,469
don't<font color="#CCCCCC"> have a lot of insight</font><font color="#E5E5E5"> into that</font><font color="#CCCCCC"> I</font>

188
00:10:07,260 --> 00:10:15,130
know that we<font color="#E5E5E5"> don't make a lot of changes</font>

189
00:10:10,470 --> 00:10:17,770
<font color="#CCCCCC">you know for our domain were rolling</font><font color="#E5E5E5"> the</font>

190
00:10:15,130 --> 00:10:20,590
s<font color="#CCCCCC"> Keys</font><font color="#E5E5E5"> maybe you know once every two</font>

191
00:10:17,770 --> 00:10:22,569
years or something<font color="#CCCCCC"> and NS records</font>

192
00:10:20,590 --> 00:10:33,460
there'll be you<font color="#CCCCCC"> know a valid change</font>

193
00:10:22,570 --> 00:10:36,010
every<font color="#CCCCCC"> couple years at the registry level</font>

194
00:10:33,460 --> 00:10:38,320
yes<font color="#CCCCCC"> yeah it strikes me that</font><font color="#E5E5E5"> there</font>

195
00:10:36,010 --> 00:10:40,210
probably<font color="#E5E5E5"> several million going on a day</font>

196
00:10:38,320 --> 00:10:43,450
it seems like a reasonable reasonable

197
00:10:40,210 --> 00:10:46,210
<font color="#E5E5E5">first pass guess</font><font color="#CCCCCC"> but at the same time</font>

198
00:10:43,450 --> 00:10:47,650
doing<font color="#E5E5E5"> a single DNS query that their</font>

199
00:10:46,210 --> 00:10:53,650
business process says that they<font color="#E5E5E5"> already</font>

200
00:10:47,650 --> 00:10:56,439
do<font color="#E5E5E5"> yeah exactly</font>

201
00:10:53,650 --> 00:11:00,699
yeah<font color="#E5E5E5"> well actually that's not</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> case</font>

202
00:10:56,440 --> 00:11:03,130
<font color="#E5E5E5">but for $45 a month</font><font color="#CCCCCC"> there is a manual</font>

203
00:11:00,700 --> 00:11:08,980
<font color="#CCCCCC">process</font><font color="#E5E5E5"> which I will describe shortly</font>

204
00:11:03,130 --> 00:11:11,980
<font color="#E5E5E5">with its flaws</font><font color="#CCCCCC"> so anyway all right so</font>

205
00:11:08,980 --> 00:11:13,830
<font color="#CCCCCC">then they had an SSL cert for our domain</font>

206
00:11:11,980 --> 00:11:17,620
<font color="#CCCCCC">name</font><font color="#E5E5E5"> perfectly valid</font>

207
00:11:13,830 --> 00:11:20,380
unfortunately<font color="#CCCCCC"> CA cert</font><font color="#E5E5E5"> so then they put</font>

208
00:11:17,620 --> 00:11:24,940
<font color="#CCCCCC">that into a pre-built</font><font color="#E5E5E5"> IMAP proxying</font>

209
00:11:20,380 --> 00:11:26,530
infrastructure<font color="#CCCCCC"> and they run the hijack</font>

210
00:11:24,940 --> 00:11:27,970
again<font color="#E5E5E5"> right so they're doing the hijack</font>

211
00:11:26,530 --> 00:11:31,230
in these<font color="#E5E5E5"> one our windows and</font>

212
00:11:27,970 --> 00:11:37,290
accomplishing tasks within these windows

213
00:11:31,230 --> 00:11:38,590
<font color="#CCCCCC">and so then they're trying</font><font color="#E5E5E5"> to get our</font>

214
00:11:37,290 --> 00:11:43,150
internal

215
00:11:38,590 --> 00:11:46,780
email users to talk to their server

216
00:11:43,150 --> 00:11:49,510
<font color="#CCCCCC">their IMAP server the cert will identify</font>

217
00:11:46,780 --> 00:11:53,410
it<font color="#E5E5E5"> as being</font><font color="#CCCCCC"> our server</font><font color="#E5E5E5"> although it's a</font>

218
00:11:49,510 --> 00:11:55,990
<font color="#E5E5E5">different certificate and then they</font>

219
00:11:53,410 --> 00:11:59,560
harvest the credentials<font color="#E5E5E5"> and then use</font>

220
00:11:55,990 --> 00:12:08,710
that to download mailboxes the cards and

221
00:11:59,560 --> 00:12:10,359
<font color="#CCCCCC">B Cal's</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> so they were doing these</font>

222
00:12:08,710 --> 00:12:11,530
<font color="#CCCCCC">one-hour windows and they were using</font>

223
00:12:10,360 --> 00:12:16,630
<font color="#CCCCCC">one-hour</font><font color="#E5E5E5"> TTLs</font>

224
00:12:11,530 --> 00:12:18,880
so<font color="#CCCCCC"> I</font><font color="#E5E5E5"> knowing something about the DNS if</font>

225
00:12:16,630 --> 00:12:22,300
I were<font color="#CCCCCC"> conducting this attack I</font><font color="#E5E5E5"> would do</font>

226
00:12:18,880 --> 00:12:23,890
it<font color="#E5E5E5"> in significantly different ways which</font>

227
00:12:22,300 --> 00:12:27,959
would<font color="#E5E5E5"> be less</font><font color="#CCCCCC"> visible to</font><font color="#E5E5E5"> somebody like</font>

228
00:12:23,890 --> 00:12:31,480
<font color="#E5E5E5">me but the fact of the matter</font><font color="#CCCCCC"> is that</font>

229
00:12:27,960 --> 00:12:34,000
this attack was marginally effective

230
00:12:31,480 --> 00:12:36,850
against us and it<font color="#E5E5E5"> was spectacularly</font>

231
00:12:34,000 --> 00:12:38,980
effective against essentially all the

232
00:12:36,850 --> 00:12:41,470
other victims<font color="#CCCCCC"> and the difference between</font>

233
00:12:38,980 --> 00:12:44,680
<font color="#CCCCCC">us and the other victims</font><font color="#E5E5E5"> is we were</font>

234
00:12:41,470 --> 00:12:48,640
doing DNS SEC validation so<font color="#CCCCCC"> only two of</font>

235
00:12:44,680 --> 00:12:53,109
our<font color="#E5E5E5"> clients got popped</font><font color="#CCCCCC"> and that was</font>

236
00:12:48,640 --> 00:12:58,180
because<font color="#CCCCCC"> they were</font><font color="#E5E5E5"> traversing captive</font>

237
00:12:53,110 --> 00:13:03,130
portals<font color="#E5E5E5"> during that that hour window</font><font color="#CCCCCC"> so</font>

238
00:12:58,180 --> 00:13:05,530
the timing for us the actual hijack

239
00:13:03,130 --> 00:13:07,300
<font color="#CCCCCC">though there was a one hour window on</font>

240
00:13:05,530 --> 00:13:09,250
the 13th of December a<font color="#E5E5E5"> one hour window</font>

241
00:13:07,300 --> 00:13:13,240
on the 14th of December and then<font color="#CCCCCC"> two</font>

242
00:13:09,250 --> 00:13:15,370
<font color="#CCCCCC">1-hour windows on</font><font color="#E5E5E5"> January 2 and so we're</font>

243
00:13:13,240 --> 00:13:17,590
<font color="#E5E5E5">not a huge organization and we're</font><font color="#CCCCCC"> very</font>

244
00:13:15,370 --> 00:13:19,690
geographically spread out and so it

245
00:13:17,590 --> 00:13:22,360
turned out<font color="#CCCCCC"> that on</font><font color="#E5E5E5"> December 2</font>

246
00:13:19,690 --> 00:13:24,700
there weren't any<font color="#E5E5E5"> two employees in the</font>

247
00:13:22,360 --> 00:13:26,230
same place at the same time<font color="#E5E5E5"> right people</font>

248
00:13:24,700 --> 00:13:28,300
were<font color="#E5E5E5"> traveling they were working from</font>

249
00:13:26,230 --> 00:13:31,800
home<font color="#E5E5E5"> they were back</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the office but</font>

250
00:13:28,300 --> 00:13:36,300
nobody else<font color="#E5E5E5"> was in</font><font color="#CCCCCC"> the office and so</font>

251
00:13:31,800 --> 00:13:40,510
actually that<font color="#E5E5E5"> tease up the next slide</font><font color="#CCCCCC"> so</font>

252
00:13:36,300 --> 00:13:42,790
<font color="#CCCCCC">during those</font><font color="#E5E5E5"> one hour periods we weren't</font>

253
00:13:40,510 --> 00:13:45,460
able to connect<font color="#E5E5E5"> to the mail</font><font color="#CCCCCC"> server right</font>

254
00:13:42,790 --> 00:13:48,550
because our<font color="#E5E5E5"> client would do the DNS SEC</font>

255
00:13:45,460 --> 00:13:52,000
validation to look<font color="#E5E5E5"> up the mail server IP</font>

256
00:13:48,550 --> 00:13:52,479
address and we'd get a fail<font color="#E5E5E5"> and so we</font>

257
00:13:52,000 --> 00:13:57,910
wouldn't

258
00:13:52,480 --> 00:14:00,370
and so in their heads<font color="#CCCCCC"> all of our</font>

259
00:13:57,910 --> 00:14:02,410
<font color="#E5E5E5">employees said uh I don't know</font><font color="#CCCCCC"> it's you</font>

260
00:14:00,370 --> 00:14:05,410
know<font color="#E5E5E5"> I'm on vacation or I'm coming back</font>

261
00:14:02,410 --> 00:14:08,860
<font color="#E5E5E5">from vacation whatever</font><font color="#CCCCCC"> my head</font><font color="#E5E5E5"> isn't</font>

262
00:14:05,410 --> 00:14:11,530
really in this<font color="#E5E5E5"> if if this problem</font>

263
00:14:08,860 --> 00:14:14,080
<font color="#E5E5E5">continues then I'll</font><font color="#CCCCCC"> open a trouble</font>

264
00:14:11,530 --> 00:14:16,689
ticket<font color="#CCCCCC"> but I'm not gonna worry about it</font>

265
00:14:14,080 --> 00:14:19,510
that I I'm not getting any new mail

266
00:14:16,690 --> 00:14:21,970
<font color="#CCCCCC">right now right</font><font color="#E5E5E5"> and for a one-hour</font>

267
00:14:19,510 --> 00:14:24,420
period when<font color="#E5E5E5"> you might not have looked at</font>

268
00:14:21,970 --> 00:14:26,800
the<font color="#E5E5E5"> beginning of the</font><font color="#CCCCCC"> hour</font>

269
00:14:24,420 --> 00:14:28,780
some of our<font color="#CCCCCC"> employees didn't notice at</font>

270
00:14:26,800 --> 00:14:30,819
all<font color="#E5E5E5"> most of them didn't notice at all</font>

271
00:14:28,780 --> 00:14:34,120
that they hadn't gotten any new mail

272
00:14:30,820 --> 00:14:36,880
during<font color="#E5E5E5"> that hour and a few of us myself</font>

273
00:14:34,120 --> 00:14:38,500
included<font color="#CCCCCC"> noticed and thought well gosh</font>

274
00:14:36,880 --> 00:14:41,140
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know I'm in the middle</font><font color="#E5E5E5"> of talking</font>

275
00:14:38,500 --> 00:14:43,300
<font color="#E5E5E5">with my in-laws here I'll check back</font>

276
00:14:41,140 --> 00:14:45,310
<font color="#CCCCCC">again in a little while and see if it's</font>

277
00:14:43,300 --> 00:14:46,900
<font color="#E5E5E5">still a problem</font><font color="#CCCCCC"> and I checked back in a</font>

278
00:14:45,310 --> 00:14:51,849
while<font color="#E5E5E5"> and it was no problem</font><font color="#CCCCCC"> and I had my</font>

279
00:14:46,900 --> 00:14:55,510
email<font color="#E5E5E5"> right so as a warning</font><font color="#CCCCCC"> sign that</font>

280
00:14:51,850 --> 00:14:59,220
was there<font color="#E5E5E5"> and now that were more aware</font>

281
00:14:55,510 --> 00:15:02,650
<font color="#CCCCCC">of this we'll we'll sort of have</font><font color="#E5E5E5"> that</font>

282
00:14:59,220 --> 00:15:05,020
more front of mind<font color="#E5E5E5"> right but at the time</font>

283
00:15:02,650 --> 00:15:06,939
everybody<font color="#E5E5E5"> being spread out no two people</font>

284
00:15:05,020 --> 00:15:09,069
<font color="#E5E5E5">so if we'd had two people</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> same</font>

285
00:15:06,940 --> 00:15:10,570
<font color="#E5E5E5">office at the same time it's</font><font color="#CCCCCC"> very likely</font>

286
00:15:09,070 --> 00:15:12,310
that<font color="#E5E5E5"> one who</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> said oh that's funny I</font>

287
00:15:10,570 --> 00:15:13,930
can't get to<font color="#E5E5E5"> my email</font><font color="#CCCCCC"> and the other one</font>

288
00:15:12,310 --> 00:15:16,060
who say oh that's<font color="#E5E5E5"> funny I can't either</font>

289
00:15:13,930 --> 00:15:23,699
<font color="#E5E5E5">and then it would have gotten escalated</font>

290
00:15:16,060 --> 00:15:24,849
yeah question<font color="#CCCCCC"> so we're an</font><font color="#E5E5E5"> Apple shop and</font>

291
00:15:23,700 --> 00:15:29,130
sorry

292
00:15:24,850 --> 00:15:33,670
you mean<font color="#E5E5E5"> mail client or DNS SEC yeah so</font>

293
00:15:29,130 --> 00:15:38,980
we're pretty<font color="#E5E5E5"> much all Apple Mail on iOS</font>

294
00:15:33,670 --> 00:15:42,810
and on Mac OS now the the two people who

295
00:15:38,980 --> 00:15:45,700
got popped<font color="#CCCCCC"> they were both on iOS devices</font>

296
00:15:42,810 --> 00:15:47,469
<font color="#CCCCCC">they were</font><font color="#E5E5E5"> both traveling and they both</font>

297
00:15:45,700 --> 00:15:50,590
wound up having<font color="#E5E5E5"> to navigate a captive</font>

298
00:15:47,470 --> 00:15:53,110
portal right so they want<font color="#E5E5E5"> went off of</font>

299
00:15:50,590 --> 00:15:55,240
our DNS SEC validating recursive

300
00:15:53,110 --> 00:15:59,890
resolver<font color="#CCCCCC"> onto the captive portal</font>

301
00:15:55,240 --> 00:16:01,630
<font color="#E5E5E5">recursive resolver right which got them</font>

302
00:15:59,890 --> 00:16:03,640
through the captive portal but during

303
00:16:01,630 --> 00:16:06,060
that<font color="#E5E5E5"> that few moments that</font><font color="#CCCCCC"> they were on</font>

304
00:16:03,640 --> 00:16:09,980
that resolver their mail client

305
00:16:06,060 --> 00:16:12,150
to check<font color="#CCCCCC"> for</font><font color="#E5E5E5"> mail</font><font color="#CCCCCC"> and boom</font><font color="#E5E5E5"> right so</font>

306
00:16:09,980 --> 00:16:14,490
statistically out of<font color="#CCCCCC"> a whole bunch of</font>

307
00:16:12,150 --> 00:16:15,780
employees<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> this wouldn't have</font>

308
00:16:14,490 --> 00:16:17,430
happened<font color="#CCCCCC"> at all if everybody been</font>

309
00:16:15,780 --> 00:16:20,490
sitting in the office at<font color="#E5E5E5"> that</font><font color="#CCCCCC"> time but</font>

310
00:16:17,430 --> 00:16:23,670
we're a 24-hour shop with people all

311
00:16:20,490 --> 00:16:25,200
over the<font color="#CCCCCC"> world so you know</font><font color="#E5E5E5"> any any</font><font color="#CCCCCC"> hour</font>

312
00:16:23,670 --> 00:16:26,610
window that you pick<font color="#CCCCCC"> they're gonna</font><font color="#E5E5E5"> be</font>

313
00:16:25,200 --> 00:16:28,410
some<font color="#E5E5E5"> people asleep some people in the</font>

314
00:16:26,610 --> 00:16:30,990
office some people you know<font color="#CCCCCC"> on the road</font>

315
00:16:28,410 --> 00:16:34,880
<font color="#E5E5E5">whatever right so we have to we have to</font>

316
00:16:30,990 --> 00:16:38,430
<font color="#CCCCCC">find a way that works</font><font color="#E5E5E5"> regardless</font><font color="#CCCCCC"> right</font>

317
00:16:34,880 --> 00:16:41,220
<font color="#CCCCCC">okay so another warning sign that</font><font color="#E5E5E5"> again</font>

318
00:16:38,430 --> 00:16:44,130
we didn't notice in advance or at the

319
00:16:41,220 --> 00:16:47,220
time<font color="#E5E5E5"> but we were able to see easily</font>

320
00:16:44,130 --> 00:16:50,939
looking in the log files after<font color="#E5E5E5"> is when</font>

321
00:16:47,220 --> 00:16:52,530
they were proxying<font color="#E5E5E5"> the mail the when</font>

322
00:16:50,940 --> 00:16:56,250
they had hijacked<font color="#E5E5E5"> the the mail server</font>

323
00:16:52,530 --> 00:16:58,699
<font color="#E5E5E5">right they were going</font><font color="#CCCCCC"> after our</font><font color="#E5E5E5"> IMAP</font>

324
00:16:56,250 --> 00:17:02,160
credentials so they were looking<font color="#CCCCCC"> for our</font>

325
00:16:58,700 --> 00:17:05,250
<font color="#E5E5E5">IMAP connections but because mail dot</font>

326
00:17:02,160 --> 00:17:08,970
<font color="#CCCCCC">PCH net is</font><font color="#E5E5E5"> mail dot</font><font color="#CCCCCC"> PCH</font><font color="#E5E5E5"> net it's not</font>

327
00:17:05,250 --> 00:17:11,250
separate<font color="#E5E5E5"> SMTP PCH net and IMAP pc a shot</font>

328
00:17:08,970 --> 00:17:14,550
net it's one name<font color="#E5E5E5"> they they couldn't</font>

329
00:17:11,250 --> 00:17:16,589
hijack<font color="#CCCCCC"> IMAP without also hijacking smtp</font>

330
00:17:14,550 --> 00:17:19,290
so they had to proxy the inbound and

331
00:17:16,589 --> 00:17:20,609
<font color="#E5E5E5">outbound smtp at the same time and</font><font color="#CCCCCC"> i</font>

332
00:17:19,290 --> 00:17:22,440
think<font color="#E5E5E5"> that's a fairly common</font><font color="#CCCCCC"> situation</font>

333
00:17:20,609 --> 00:17:25,589
right because they're<font color="#E5E5E5"> set up was built</font>

334
00:17:22,440 --> 00:17:26,910
to do that because<font color="#E5E5E5"> presumably they were</font>

335
00:17:25,589 --> 00:17:30,360
encountering the same thing with other

336
00:17:26,910 --> 00:17:32,040
organizations<font color="#E5E5E5"> when</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> ran an</font><font color="#CCCCCC"> ISP</font><font color="#E5E5E5"> we had</font>

337
00:17:30,360 --> 00:17:33,270
all this<font color="#E5E5E5"> separated out</font><font color="#CCCCCC"> right all these</font>

338
00:17:32,040 --> 00:17:34,649
roles<font color="#E5E5E5"> and functions were all on</font>

339
00:17:33,270 --> 00:17:37,410
different<font color="#CCCCCC"> machines or different stacks</font>

340
00:17:34,650 --> 00:17:39,420
<font color="#CCCCCC">of machines all named separately</font><font color="#E5E5E5"> so</font>

341
00:17:37,410 --> 00:17:43,890
forth<font color="#E5E5E5"> right so inbound smtp outbound</font>

342
00:17:39,420 --> 00:17:46,290
<font color="#CCCCCC">SMTP IMAP the the data store for it all</font>

343
00:17:43,890 --> 00:17:48,830
<font color="#E5E5E5">of that</font><font color="#CCCCCC"> we're all in separate things</font><font color="#E5E5E5"> you</font>

344
00:17:46,290 --> 00:17:52,020
know<font color="#E5E5E5"> we're we're a smaller organization</font>

345
00:17:48,830 --> 00:17:53,790
<font color="#E5E5E5">without</font><font color="#CCCCCC"> external customers so we're much</font>

346
00:17:52,020 --> 00:17:56,610
more like<font color="#CCCCCC"> enterprise in terms out our</font>

347
00:17:53,790 --> 00:17:58,800
email is set up and so it's<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the one</font>

348
00:17:56,610 --> 00:18:00,750
machine<font color="#E5E5E5"> so they had to proxy the SMTP</font>

349
00:17:58,800 --> 00:18:02,659
what that meant is that<font color="#E5E5E5"> they got</font>

350
00:18:00,750 --> 00:18:07,950
visibility of all of our in outbound

351
00:18:02,660 --> 00:18:08,610
<font color="#E5E5E5">SMTP during that hour mostly it wasn't</font>

352
00:18:07,950 --> 00:18:10,560
happening

353
00:18:08,610 --> 00:18:12,750
outbound because mostly we couldn't

354
00:18:10,560 --> 00:18:16,590
authenticate because<font color="#CCCCCC"> we couldn't</font><font color="#E5E5E5"> talk to</font>

355
00:18:12,750 --> 00:18:19,170
<font color="#CCCCCC">it because of</font><font color="#E5E5E5"> the DNS SEC validation but</font>

356
00:18:16,590 --> 00:18:19,770
all the inbound stuff nobody's bothering

357
00:18:19,170 --> 00:18:21,810
<font color="#CCCCCC">to yes</font>

358
00:18:19,770 --> 00:18:23,010
<font color="#CCCCCC">that validate</font><font color="#E5E5E5"> people aren't bothering to</font>

359
00:18:21,810 --> 00:18:26,480
do Dane

360
00:18:23,010 --> 00:18:29,910
so that inbound email<font color="#E5E5E5"> is showing up on</font>

361
00:18:26,480 --> 00:18:34,350
their server<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> included all of</font>

362
00:18:29,910 --> 00:18:36,960
<font color="#E5E5E5">the spam normally spam comes in from a</font>

363
00:18:34,350 --> 00:18:38,399
wide<font color="#E5E5E5"> distribution of sources</font><font color="#CCCCCC"> but during</font>

364
00:18:36,960 --> 00:18:40,830
<font color="#CCCCCC">that hour</font><font color="#E5E5E5"> that they were proxying</font>

365
00:18:38,400 --> 00:18:43,890
all of our inbound email was coming in

366
00:18:40,830 --> 00:18:47,159
from their proxy or not<font color="#E5E5E5"> not all but all</font>

367
00:18:43,890 --> 00:18:49,530
of the inbound mail<font color="#E5E5E5"> that got to them due</font>

368
00:18:47,160 --> 00:18:52,830
to<font color="#E5E5E5"> people having hit their name server</font>

369
00:18:49,530 --> 00:18:54,720
rather than ours<font color="#CCCCCC"> right because we</font><font color="#E5E5E5"> have</font>

370
00:18:52,830 --> 00:18:58,350
<font color="#E5E5E5">pool</font><font color="#CCCCCC"> of name servers and they just</font><font color="#E5E5E5"> added</font>

371
00:18:54,720 --> 00:19:01,710
one right so they got a bit of our DNS

372
00:18:58,350 --> 00:19:04,379
traffic<font color="#E5E5E5"> but not all of it anyway so what</font>

373
00:19:01,710 --> 00:19:07,200
<font color="#CCCCCC">that means is that</font><font color="#E5E5E5"> almost all of our</font>

374
00:19:04,380 --> 00:19:08,850
inbound spam was coming from one source

375
00:19:07,200 --> 00:19:10,620
<font color="#CCCCCC">during</font><font color="#E5E5E5"> that time which meant that source</font>

376
00:19:08,850 --> 00:19:12,300
got<font color="#CCCCCC"> grey listed and eventually</font>

377
00:19:10,620 --> 00:19:15,840
blacklisted pretty quickly within<font color="#E5E5E5"> that</font>

378
00:19:12,300 --> 00:19:18,210
hour<font color="#E5E5E5"> within just a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> the</font>

379
00:19:15,840 --> 00:19:22,350
the concentration of spam caused that

380
00:19:18,210 --> 00:19:25,380
<font color="#E5E5E5">SMTP</font><font color="#CCCCCC"> source to get blacklisted</font><font color="#E5E5E5"> which</font>

381
00:19:22,350 --> 00:19:29,520
meant that inbound SMTP really dropped

382
00:19:25,380 --> 00:19:34,500
off<font color="#E5E5E5"> during that hour</font><font color="#CCCCCC"> we hypothesized</font>

383
00:19:29,520 --> 00:19:38,940
that<font color="#E5E5E5"> because of the proxying the</font><font color="#CCCCCC"> DNS</font>

384
00:19:34,500 --> 00:19:41,300
proxying their DNS<font color="#E5E5E5"> proxy would always be</font>

385
00:19:38,940 --> 00:19:45,420
hitting<font color="#E5E5E5"> the any cast nearest instance of</font>

386
00:19:41,300 --> 00:19:48,600
<font color="#CCCCCC">google's 8.88 which in turn</font><font color="#E5E5E5"> would always</font>

387
00:19:45,420 --> 00:19:50,970
be hitting the same nearest<font color="#E5E5E5"> anycast</font>

388
00:19:48,600 --> 00:19:53,429
<font color="#E5E5E5">instance of our authoritative server so</font>

389
00:19:50,970 --> 00:19:57,800
we'd see a broad<font color="#CCCCCC"> distribution of inbound</font>

390
00:19:53,430 --> 00:20:02,130
queries concentrating down to a very

391
00:19:57,800 --> 00:20:03,540
geographically<font color="#CCCCCC"> specific locus</font><font color="#E5E5E5"> and so we</font>

392
00:20:02,130 --> 00:20:05,640
did a bunch of poking because that

393
00:20:03,540 --> 00:20:08,340
seemed<font color="#CCCCCC"> like a</font><font color="#E5E5E5"> really good theory</font><font color="#CCCCCC"> but in</font>

394
00:20:05,640 --> 00:20:11,430
practice<font color="#CCCCCC"> it just didn't really it didn't</font>

395
00:20:08,340 --> 00:20:14,159
really<font color="#E5E5E5"> pan out</font><font color="#CCCCCC"> and I don't</font><font color="#E5E5E5"> know whether</font>

396
00:20:11,430 --> 00:20:19,140
<font color="#E5E5E5">that's because Google was distributing</font>

397
00:20:14,160 --> 00:20:21,480
their queries to us<font color="#CCCCCC"> or because the</font>

398
00:20:19,140 --> 00:20:23,520
addition of<font color="#E5E5E5"> one</font><font color="#CCCCCC"> more name server to our</font>

399
00:20:21,480 --> 00:20:27,900
pool didn't actually<font color="#E5E5E5"> capture that much</font>

400
00:20:23,520 --> 00:20:30,420
traffic<font color="#E5E5E5"> or you know because suddenly a</font>

401
00:20:27,900 --> 00:20:32,250
<font color="#E5E5E5">bunch of stuff was</font><font color="#CCCCCC"> cashable on their</font>

402
00:20:30,420 --> 00:20:33,270
side<font color="#CCCCCC"> that wasn't cashable previously</font>

403
00:20:32,250 --> 00:20:35,400
because<font color="#CCCCCC"> it was coming in</font><font color="#E5E5E5"> from</font>

404
00:20:33,270 --> 00:20:37,350
sources<font color="#E5E5E5"> got a bunch of different</font>

405
00:20:35,400 --> 00:20:39,900
<font color="#CCCCCC">explanations the answer is probably</font><font color="#E5E5E5"> a</font>

406
00:20:37,350 --> 00:20:41,820
little<font color="#E5E5E5"> bit of all of</font><font color="#CCCCCC"> that combined means</font>

407
00:20:39,900 --> 00:20:43,560
that it was fairly fuzzy rather than

408
00:20:41,820 --> 00:20:51,300
sort of<font color="#E5E5E5"> the specific thing that we'd</font>

409
00:20:43,560 --> 00:20:53,940
been imagining<font color="#CCCCCC"> okay so the defense's the</font>

410
00:20:51,300 --> 00:20:55,919
actual one that<font color="#E5E5E5"> worked for us was the</font>

411
00:20:53,940 --> 00:20:57,600
DNS ex signing of the zones and<font color="#E5E5E5"> the DNS</font>

412
00:20:55,920 --> 00:20:59,130
SEC validation<font color="#E5E5E5"> right if we weren't doing</font>

413
00:20:57,600 --> 00:21:01,290
<font color="#E5E5E5">the validation the signing wouldn't have</font>

414
00:20:59,130 --> 00:21:03,000
done us<font color="#E5E5E5"> any good</font><font color="#CCCCCC"> so it's got</font><font color="#E5E5E5"> to be the</font>

415
00:21:01,290 --> 00:21:08,040
full combination<font color="#CCCCCC"> it's got to actually be</font>

416
00:21:03,000 --> 00:21:11,130
<font color="#E5E5E5">happening</font><font color="#CCCCCC"> the first thing that</font><font color="#E5E5E5"> we did</font>

417
00:21:08,040 --> 00:21:13,310
<font color="#E5E5E5">upon finding out about the</font><font color="#CCCCCC"> attack is we</font>

418
00:21:11,130 --> 00:21:15,960
started<font color="#CCCCCC"> walking the n s and</font><font color="#E5E5E5"> D s</font>

419
00:21:13,310 --> 00:21:19,200
delegation tree down from the<font color="#CCCCCC"> route from</font>

420
00:21:15,960 --> 00:21:22,230
<font color="#E5E5E5">a whole bunch of locations using ripe</font>

421
00:21:19,200 --> 00:21:24,030
Atlas<font color="#E5E5E5"> every 15 seconds</font><font color="#CCCCCC"> so if this</font>

422
00:21:22,230 --> 00:21:27,780
<font color="#E5E5E5">happens again</font><font color="#CCCCCC"> and it takes longer than</font>

423
00:21:24,030 --> 00:21:31,649
15 seconds<font color="#E5E5E5"> which again knowing what I</font>

424
00:21:27,780 --> 00:21:38,190
know<font color="#E5E5E5"> about the DNS I wouldn't take that</font>

425
00:21:31,650 --> 00:21:42,000
<font color="#E5E5E5">long</font><font color="#CCCCCC"> we'll catch it</font><font color="#E5E5E5"> the third thing is</font>

426
00:21:38,190 --> 00:21:43,770
registry lock<font color="#CCCCCC"> so we knew about registrar</font>

427
00:21:42,000 --> 00:21:47,640
lock and we'd had the domains on

428
00:21:43,770 --> 00:21:49,920
registrar lock forever<font color="#CCCCCC"> it turns</font><font color="#E5E5E5"> out</font>

429
00:21:47,640 --> 00:21:52,470
there's<font color="#CCCCCC"> another service from Verisign</font>

430
00:21:49,920 --> 00:21:55,020
called registry lock for<font color="#CCCCCC"> forty five</font>

431
00:21:52,470 --> 00:21:56,280
<font color="#CCCCCC">bucks a month</font><font color="#E5E5E5"> plus I remember</font><font color="#CCCCCC"> two</font>

432
00:21:55,020 --> 00:22:01,950
<font color="#CCCCCC">hundred bucks an instance or something</font>

433
00:21:56,280 --> 00:22:03,510
like<font color="#E5E5E5"> that when they get a I'm going to</font>

434
00:22:01,950 --> 00:22:04,560
tell you the<font color="#E5E5E5"> theory first and</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font>

435
00:22:03,510 --> 00:22:07,920
to<font color="#E5E5E5"> tell you what this looked like in</font>

436
00:22:04,560 --> 00:22:10,710
practice<font color="#CCCCCC"> the theory</font><font color="#E5E5E5"> is that when someone</font>

437
00:22:07,920 --> 00:22:16,740
<font color="#E5E5E5">tries to make a change to</font><font color="#CCCCCC"> a name server</font>

438
00:22:10,710 --> 00:22:18,060
or<font color="#E5E5E5"> D s record in at the registry level</font>

439
00:22:16,740 --> 00:22:20,610
right so<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that's come up</font>

440
00:22:18,060 --> 00:22:24,149
<font color="#CCCCCC">through</font><font color="#E5E5E5"> EPP that affects your domain</font>

441
00:22:20,610 --> 00:22:27,899
that they will contact<font color="#E5E5E5"> you out of bound</font>

442
00:22:24,150 --> 00:22:32,820
<font color="#E5E5E5">and authenticate it prior to actually</font>

443
00:22:27,900 --> 00:22:35,190
<font color="#E5E5E5">implementing the change okay so it feels</font>

444
00:22:32,820 --> 00:22:39,540
like something that you<font color="#E5E5E5"> shouldn't have</font>

445
00:22:35,190 --> 00:22:41,190
<font color="#E5E5E5">to pay extra for but okay yeah whatever</font>

446
00:22:39,540 --> 00:22:45,540
<font color="#E5E5E5">for that amount of</font><font color="#CCCCCC"> money</font><font color="#E5E5E5"> it's not worth</font>

447
00:22:41,190 --> 00:22:46,980
arguing about so we did that<font color="#CCCCCC"> and so then</font>

448
00:22:45,540 --> 00:22:49,710
the

449
00:22:46,980 --> 00:22:53,700
registrar<font color="#E5E5E5"> not the wholesaler not</font>

450
00:22:49,710 --> 00:22:56,550
<font color="#E5E5E5">Verisign the</font><font color="#CCCCCC"> Registrar</font><font color="#E5E5E5"> send us a PDF and</font>

451
00:22:53,700 --> 00:23:01,470
said fill<font color="#E5E5E5"> out this PDF and email it</font><font color="#CCCCCC"> back</font>

452
00:22:56,550 --> 00:23:04,020
to<font color="#CCCCCC"> us</font><font color="#E5E5E5"> and so the PDF said what's your</font>

453
00:23:01,470 --> 00:23:10,110
<font color="#E5E5E5">email address and what's your secret</font>

454
00:23:04,020 --> 00:23:13,139
passphrase that you want to use and so

455
00:23:10,110 --> 00:23:15,750
then we said okay what's your PGP<font color="#E5E5E5"> key so</font>

456
00:23:13,140 --> 00:23:18,360
<font color="#E5E5E5">that we can send this back to Verisign</font>

457
00:23:15,750 --> 00:23:19,890
or<font color="#CCCCCC"> you or</font><font color="#E5E5E5"> whatever like oh we don't do</font>

458
00:23:18,360 --> 00:23:20,550
that<font color="#CCCCCC"> you just send it back it's fine</font>

459
00:23:19,890 --> 00:23:24,660
right

460
00:23:20,550 --> 00:23:27,149
so this unencrypted PDF with the contact

461
00:23:24,660 --> 00:23:32,580
info and<font color="#E5E5E5"> the passphrase on it now</font>

462
00:23:27,150 --> 00:23:35,460
<font color="#E5E5E5">resides in some somewhere records of the</font>

463
00:23:32,580 --> 00:23:37,590
entire<font color="#E5E5E5"> chain up to Verisign</font><font color="#CCCCCC"> a guess and</font>

464
00:23:35,460 --> 00:23:39,780
it turns out<font color="#E5E5E5"> it's not Vera sign that</font>

465
00:23:37,590 --> 00:23:42,720
actually does this it's the<font color="#E5E5E5"> Registrar</font>

466
00:23:39,780 --> 00:23:44,160
that does it and tells<font color="#E5E5E5"> Verisign yet</font>

467
00:23:42,720 --> 00:23:46,140
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> worry about this it's been done</font>

468
00:23:44,160 --> 00:23:47,520
everything's fine<font color="#CCCCCC"> you get your money we</font>

469
00:23:46,140 --> 00:23:49,500
get our cut

470
00:23:47,520 --> 00:23:56,639
you know<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> look behind the</font><font color="#E5E5E5"> curtain</font>

471
00:23:49,500 --> 00:24:01,230
<font color="#CCCCCC">so this yeah</font><font color="#E5E5E5"> I'm not sure</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> worth</font><font color="#CCCCCC"> 45</font>

472
00:23:56,640 --> 00:24:04,890
bucks a month but<font color="#E5E5E5"> well we'll see</font><font color="#CCCCCC"> all</font>

473
00:24:01,230 --> 00:24:07,740
right<font color="#E5E5E5"> next</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> and you know a lot of</font>

474
00:24:04,890 --> 00:24:11,400
this<font color="#CCCCCC"> I'm just again telling you what we</font>

475
00:24:07,740 --> 00:24:13,500
<font color="#E5E5E5">did and you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> my wife works for Intel</font>

476
00:24:11,400 --> 00:24:15,210
and Intel already does all this stuff

477
00:24:13,500 --> 00:24:18,540
<font color="#CCCCCC">because</font><font color="#E5E5E5"> they've you know big enterprise</font>

478
00:24:15,210 --> 00:24:21,570
security IT<font color="#E5E5E5"> group</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> and they get</font>

479
00:24:18,540 --> 00:24:24,090
<font color="#CCCCCC">hacked all the time whatever</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we're so</font>

480
00:24:21,570 --> 00:24:25,679
for a small organization we're starting

481
00:24:24,090 --> 00:24:27,300
to look a lot<font color="#CCCCCC"> more like a big enterprise</font>

482
00:24:25,680 --> 00:24:31,710
organization as we have to nail this

483
00:24:27,300 --> 00:24:33,030
<font color="#E5E5E5">stuff down so our IMAP server is no</font>

484
00:24:31,710 --> 00:24:35,100
longer reachable from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> internet you</font>

485
00:24:33,030 --> 00:24:37,620
<font color="#E5E5E5">have to log</font><font color="#CCCCCC"> into a</font><font color="#E5E5E5"> VPN first before you</font>

486
00:24:35,100 --> 00:24:39,659
can authenticate it<font color="#E5E5E5"> so it's just</font><font color="#CCCCCC"> layers</font>

487
00:24:37,620 --> 00:24:42,659
<font color="#E5E5E5">of security</font><font color="#CCCCCC"> right and then we've got a</font>

488
00:24:39,660 --> 00:24:44,130
place where we can sort<font color="#E5E5E5"> of inspect all</font>

489
00:24:42,660 --> 00:24:46,860
the<font color="#E5E5E5"> traffic that's headed towards it</font>

490
00:24:44,130 --> 00:24:51,060
before it<font color="#E5E5E5"> gets there and you know if we</font>

491
00:24:46,860 --> 00:24:53,939
wind up splitting<font color="#E5E5E5"> as as we're now also</font>

492
00:24:51,060 --> 00:24:56,060
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to do</font><font color="#CCCCCC"> the structural separation</font>

493
00:24:53,940 --> 00:24:59,340
between services so inbound and outbound

494
00:24:56,060 --> 00:25:00,389
SMTP<font color="#E5E5E5"> and IMAP all on separate</font><font color="#CCCCCC"> machines</font>

495
00:24:59,340 --> 00:25:02,399
<font color="#E5E5E5">separate</font>

496
00:25:00,390 --> 00:25:08,070
IP<font color="#CCCCCC"> addresses separate names separate</font>

497
00:25:02,400 --> 00:25:11,220
certs<font color="#E5E5E5"> all that the inbound</font><font color="#CCCCCC"> SMTP and</font>

498
00:25:08,070 --> 00:25:13,500
outbound<font color="#CCCCCC"> smtp have to obviously</font><font color="#E5E5E5"> be able</font>

499
00:25:11,220 --> 00:25:17,430
to talk to<font color="#E5E5E5"> the internet but the IMAP</font>

500
00:25:13,500 --> 00:25:19,320
doesn't have to so<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> can separate</font>

501
00:25:17,430 --> 00:25:22,170
that<font color="#CCCCCC"> out a little</font><font color="#E5E5E5"> bit more and then a</font>

502
00:25:19,320 --> 00:25:26,340
big one is using mobile device

503
00:25:22,170 --> 00:25:29,790
management<font color="#E5E5E5"> to lock down the recursive</font>

504
00:25:26,340 --> 00:25:32,520
resolver<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> devices to only a DNS</font>

505
00:25:29,790 --> 00:25:34,139
SEC validating recursive resolver<font color="#E5E5E5"> so and</font>

506
00:25:32,520 --> 00:25:36,450
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> really critical right because if</font>

507
00:25:34,140 --> 00:25:41,070
we had done this first we'd<font color="#CCCCCC"> have been</font>

508
00:25:36,450 --> 00:25:43,860
okay because<font color="#CCCCCC"> those</font><font color="#E5E5E5"> two iPhones that were</font>

509
00:25:41,070 --> 00:25:48,720
out roaming around<font color="#E5E5E5"> traveling the thing</font>

510
00:25:43,860 --> 00:25:52,740
is that there's no user<font color="#E5E5E5"> interface on the</font>

511
00:25:48,720 --> 00:25:54,900
phone<font color="#E5E5E5"> that allows</font><font color="#CCCCCC"> you to</font><font color="#E5E5E5"> say only use</font>

512
00:25:52,740 --> 00:25:57,000
this recursive resolver<font color="#CCCCCC"> when you're</font>

513
00:25:54,900 --> 00:26:00,000
<font color="#E5E5E5">trying</font><font color="#CCCCCC"> to resolve</font><font color="#E5E5E5"> this domain</font><font color="#CCCCCC"> name or</font>

514
00:25:57,000 --> 00:26:02,090
only<font color="#E5E5E5"> use this VPN tunnel</font><font color="#CCCCCC"> if you're</font>

515
00:26:00,000 --> 00:26:04,770
<font color="#E5E5E5">trying to reach these IP addresses</font><font color="#CCCCCC"> but</font>

516
00:26:02,090 --> 00:26:09,090
<font color="#CCCCCC">through MDM</font><font color="#E5E5E5"> you can force those rules</font>

517
00:26:04,770 --> 00:26:10,440
<font color="#E5E5E5">down into a phone so or</font><font color="#CCCCCC"> a laptop</font><font color="#E5E5E5"> so on a</font>

518
00:26:09,090 --> 00:26:12,149
laptop<font color="#E5E5E5"> obviously you can hack that</font>

519
00:26:10,440 --> 00:26:16,500
around down<font color="#CCCCCC"> in the kernel right or the</font>

520
00:26:12,150 --> 00:26:18,030
routing<font color="#CCCCCC"> tables but you know phone not so</font>

521
00:26:16,500 --> 00:26:19,320
much unless you jailbreak<font color="#E5E5E5"> it and if you</font>

522
00:26:18,030 --> 00:26:22,440
<font color="#CCCCCC">jailbreak it you're asking for</font><font color="#E5E5E5"> a zillion</font>

523
00:26:19,320 --> 00:26:25,020
<font color="#E5E5E5">other problems so MDM is a pain in</font><font color="#CCCCCC"> the</font>

524
00:26:22,440 --> 00:26:27,120
<font color="#E5E5E5">ass but we're</font><font color="#CCCCCC"> gonna be</font><font color="#E5E5E5"> doing it in order</font>

525
00:26:25,020 --> 00:26:31,080
<font color="#CCCCCC">to get that additional</font><font color="#E5E5E5"> layer</font><font color="#CCCCCC"> of</font>

526
00:26:27,120 --> 00:26:33,239
<font color="#CCCCCC">protection locked in</font><font color="#E5E5E5"> so then there were</font>

527
00:26:31,080 --> 00:26:36,120
some other<font color="#CCCCCC"> things that</font><font color="#E5E5E5"> are sort</font><font color="#CCCCCC"> of in</font>

528
00:26:33,240 --> 00:26:40,610
<font color="#E5E5E5">the</font><font color="#CCCCCC"> hypothetical not actually queued up</font>

529
00:26:36,120 --> 00:26:45,929
to<font color="#CCCCCC"> do certain</font><font color="#E5E5E5"> and a whole bunch of other</font>

530
00:26:40,610 --> 00:26:48,889
sort of<font color="#E5E5E5"> CA cert band-aids</font><font color="#CCCCCC"> all look like</font>

531
00:26:45,930 --> 00:26:51,930
<font color="#E5E5E5">band-aids right</font><font color="#CCCCCC"> and they're all</font>

532
00:26:48,890 --> 00:26:53,880
<font color="#E5E5E5">workarounds</font><font color="#CCCCCC"> for them and they just don't</font>

533
00:26:51,930 --> 00:26:56,610
<font color="#E5E5E5">seem like</font><font color="#CCCCCC"> they're gonna be</font><font color="#E5E5E5"> that useful</font>

534
00:26:53,880 --> 00:26:59,520
<font color="#CCCCCC">the CA system is so fundamentally broken</font>

535
00:26:56,610 --> 00:27:01,530
that trying<font color="#CCCCCC"> to trying to bandaid</font>

536
00:26:59,520 --> 00:27:05,070
together something<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> actually safe</font>

537
00:27:01,530 --> 00:27:08,550
is you're never<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> get there</font><font color="#CCCCCC"> so we</font>

538
00:27:05,070 --> 00:27:09,740
decided to<font color="#E5E5E5"> just not try</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that</font>

539
00:27:08,550 --> 00:27:11,820
[Music]

540
00:27:09,740 --> 00:27:14,460
<font color="#E5E5E5">because</font><font color="#CCCCCC"> there'd be a lot of</font><font color="#E5E5E5"> effort</font><font color="#CCCCCC"> and</font>

541
00:27:11,820 --> 00:27:17,610
<font color="#CCCCCC">there other lower hanging fruit</font>

542
00:27:14,460 --> 00:27:22,290
client-side certs<font color="#CCCCCC"> what it kind</font><font color="#E5E5E5"> of came</font>

543
00:27:17,610 --> 00:27:26,490
<font color="#E5E5E5">down to was it's a nice idea but instead</font>

544
00:27:22,290 --> 00:27:28,800
<font color="#CCCCCC">of</font><font color="#E5E5E5"> using password or stored credentials</font>

545
00:27:26,490 --> 00:27:30,180
on devices<font color="#E5E5E5"> but it doesn't seem like it</font>

546
00:27:28,800 --> 00:27:34,110
gets it<font color="#E5E5E5"> gets you that much further</font>

547
00:27:30,180 --> 00:27:36,870
particularly on<font color="#E5E5E5"> modern phones that have</font>

548
00:27:34,110 --> 00:27:40,830
an end Conclave<font color="#CCCCCC"> and so forth</font><font color="#E5E5E5"> it's not</font>

549
00:27:36,870 --> 00:27:42,239
actually that<font color="#CCCCCC"> different and it's yet</font>

550
00:27:40,830 --> 00:27:44,040
another infrastructure that has to be

551
00:27:42,240 --> 00:27:47,460
set up<font color="#E5E5E5"> and certs have to be distributed</font>

552
00:27:44,040 --> 00:27:50,730
and so forth<font color="#CCCCCC"> and then the big long-term</font>

553
00:27:47,460 --> 00:27:51,900
<font color="#CCCCCC">one</font><font color="#E5E5E5"> is Dana authentication of</font><font color="#CCCCCC"> the IMAP</font>

554
00:27:50,730 --> 00:27:53,760
server so if we can get<font color="#E5E5E5"> Dana</font>

555
00:27:51,900 --> 00:27:56,550
authentication going on IMAP instead of

556
00:27:53,760 --> 00:28:00,570
just<font color="#E5E5E5"> SMTP then we don't have to</font><font color="#CCCCCC"> rely on</font>

557
00:27:56,550 --> 00:28:04,230
sort<font color="#E5E5E5"> on CA certs at all so in the short</font>

558
00:28:00,570 --> 00:28:06,560
term you know we could go with

559
00:28:04,230 --> 00:28:12,090
self-signed cert<font color="#CCCCCC"> some cert pinning and</font>

560
00:28:06,560 --> 00:28:14,280
so forth<font color="#CCCCCC"> but</font><font color="#E5E5E5"> again it seems</font><font color="#CCCCCC"> like a lot</font>

561
00:28:12,090 --> 00:28:15,899
of work not<font color="#CCCCCC"> necessarily get us where we</font>

562
00:28:14,280 --> 00:28:18,980
need<font color="#CCCCCC"> to be</font><font color="#E5E5E5"> there was question back there</font>

563
00:28:15,900 --> 00:28:18,980
yeah sir

564
00:28:23,930 --> 00:28:26,560
yeah

565
00:28:27,680 --> 00:28:32,960
yeah yeah so we're doing that<font color="#CCCCCC"> for the</font>

566
00:28:30,890 --> 00:28:35,300
<font color="#CCCCCC">VPM</font><font color="#E5E5E5"> oh sorry</font>

567
00:28:32,960 --> 00:28:37,700
so what he pointed out was<font color="#CCCCCC"> that using</font>

568
00:28:35,300 --> 00:28:41,000
MDM for pushing certs<font color="#CCCCCC"> is actually</font>

569
00:28:37,700 --> 00:28:43,280
completely<font color="#E5E5E5"> doable</font><font color="#CCCCCC"> and so where</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> are</font>

570
00:28:41,000 --> 00:28:45,650
<font color="#E5E5E5">right now is we're playing with we're</font>

571
00:28:43,280 --> 00:28:46,820
playing with<font color="#E5E5E5"> the MDM still all this you</font>

572
00:28:45,650 --> 00:28:49,670
<font color="#E5E5E5">know we're less</font><font color="#CCCCCC"> than a month out from</font>

573
00:28:46,820 --> 00:28:52,850
<font color="#E5E5E5">the</font><font color="#CCCCCC"> beginning of the attack so the sort</font>

574
00:28:49,670 --> 00:28:54,200
<font color="#E5E5E5">of bigger scale IT projects are all you</font>

575
00:28:52,850 --> 00:28:57,080
know we're playing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> different things</font>

576
00:28:54,200 --> 00:28:59,600
to see what's feasible<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so the MDM</font>

577
00:28:57,080 --> 00:29:01,730
seemed really scary at first<font color="#E5E5E5"> and more</font>

578
00:28:59,600 --> 00:29:03,590
and more it's looking like it actually

579
00:29:01,730 --> 00:29:04,580
<font color="#E5E5E5">will solve a lot</font><font color="#CCCCCC"> of problems for us</font><font color="#E5E5E5"> and</font>

580
00:29:03,590 --> 00:29:06,439
it's still<font color="#E5E5E5"> going to be a pain</font><font color="#CCCCCC"> to</font>

581
00:29:04,580 --> 00:29:09,620
implement<font color="#E5E5E5"> with the MDM what there are</font>

582
00:29:06,440 --> 00:29:11,270
are<font color="#CCCCCC"> a ton</font><font color="#E5E5E5"> of like in the cloud vendors</font>

583
00:29:09,620 --> 00:29:14,929
whose<font color="#E5E5E5"> security is way lower than ours</font>

584
00:29:11,270 --> 00:29:19,040
<font color="#E5E5E5">who we can't trust right and then there</font>

585
00:29:14,930 --> 00:29:22,490
are<font color="#E5E5E5"> a couple of good</font><font color="#CCCCCC"> ones</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> still</font>

586
00:29:19,040 --> 00:29:26,180
an externality<font color="#E5E5E5"> and then there's only</font>

587
00:29:22,490 --> 00:29:28,880
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> flight</font><font color="#E5E5E5"> something I can't</font>

588
00:29:26,180 --> 00:29:30,890
<font color="#E5E5E5">remember there's like one</font><font color="#CCCCCC"> open-source</font>

589
00:29:28,880 --> 00:29:35,210
<font color="#E5E5E5">commercially supported open-source one</font>

590
00:29:30,890 --> 00:29:37,940
that people seem<font color="#CCCCCC"> to actually like and so</font>

591
00:29:35,210 --> 00:29:42,100
that's that's<font color="#E5E5E5"> probably what we're gonna</font>

592
00:29:37,940 --> 00:29:47,120
try most seriously<font color="#E5E5E5"> first</font><font color="#CCCCCC"> FL why</font>

593
00:29:42,100 --> 00:29:51,439
something<font color="#E5E5E5"> it's not flight yeah</font><font color="#CCCCCC"> okay so</font>

594
00:29:47,120 --> 00:29:51,949
yeah<font color="#CCCCCC"> potentially we could</font><font color="#E5E5E5"> do self-signed</font>

595
00:29:51,440 --> 00:29:54,860
cert s--

596
00:29:51,950 --> 00:29:57,770
cert<font color="#E5E5E5"> pen use MDM to push the certs down</font>

597
00:29:54,860 --> 00:30:00,530
and ignore anything that<font color="#CCCCCC"> doesn't match</font>

598
00:29:57,770 --> 00:30:03,620
those certs<font color="#CCCCCC"> what we'd</font><font color="#E5E5E5"> really like though</font>

599
00:30:00,530 --> 00:30:06,500
and and we've been we've been bugging

600
00:30:03,620 --> 00:30:09,709
<font color="#E5E5E5">Apple product</font><font color="#CCCCCC"> security about this since</font>

601
00:30:06,500 --> 00:30:11,000
2011<font color="#CCCCCC"> but now they're taking</font><font color="#E5E5E5"> it much more</font>

602
00:30:09,710 --> 00:30:12,680
seriously<font color="#CCCCCC"> because there was an actual</font>

603
00:30:11,000 --> 00:30:17,300
attack that succeeded<font color="#E5E5E5"> because they</font>

604
00:30:12,680 --> 00:30:19,370
hadn't done<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> DNS SEC validation in</font>

605
00:30:17,300 --> 00:30:20,899
the client and Dane validation in the

606
00:30:19,370 --> 00:30:23,419
client<font color="#E5E5E5"> right I forgot Dee in a second</font>

607
00:30:20,900 --> 00:30:26,830
Dane actually in your phone<font color="#E5E5E5"> not</font>

608
00:30:23,420 --> 00:30:30,470
dependent upon the recursive resolver

609
00:30:26,830 --> 00:30:32,000
<font color="#E5E5E5">now you've eliminated all</font><font color="#CCCCCC"> of this sort</font>

610
00:30:30,470 --> 00:30:33,890
of man in<font color="#E5E5E5"> the middle opportunity and</font>

611
00:30:32,000 --> 00:30:37,760
you've got end-to-end security between

612
00:30:33,890 --> 00:30:40,670
the DNS signature application at the one

613
00:30:37,760 --> 00:30:41,600
<font color="#CCCCCC">end and the</font><font color="#E5E5E5"> validation on the client at</font>

614
00:30:40,670 --> 00:30:43,640
<font color="#CCCCCC">the other end</font>

615
00:30:41,600 --> 00:30:46,399
and then you just have to either<font color="#E5E5E5"> have</font>

616
00:30:43,640 --> 00:30:50,270
your<font color="#E5E5E5"> own TLD</font><font color="#CCCCCC"> and hope that I can doesn't</font>

617
00:30:46,400 --> 00:30:53,049
<font color="#E5E5E5">screw up or be in a TLD where you think</font>

618
00:30:50,270 --> 00:30:56,299
the TLD registry<font color="#CCCCCC"> operator is competent</font>

619
00:30:53,049 --> 00:30:57,679
<font color="#CCCCCC">and of course my recommendation is</font><font color="#E5E5E5"> if</font>

620
00:30:56,299 --> 00:31:00,860
you've got<font color="#CCCCCC"> the money get yourself a</font>

621
00:30:57,679 --> 00:31:04,130
brand TLD<font color="#E5E5E5"> so that you don't have so many</font>

622
00:31:00,860 --> 00:31:11,090
externalities<font color="#E5E5E5"> or</font><font color="#CCCCCC"> be a be a country and</font>

623
00:31:04,130 --> 00:31:14,780
have your<font color="#E5E5E5"> ccTLD</font><font color="#CCCCCC"> okay so one new tool</font>

624
00:31:11,090 --> 00:31:18,559
<font color="#CCCCCC">that we wound up developing internally</font>

625
00:31:14,780 --> 00:31:20,720
for this is looking at that<font color="#E5E5E5"> that first</font>

626
00:31:18,559 --> 00:31:22,879
<font color="#E5E5E5">thing that we did walking the</font><font color="#CCCCCC"> N s and D</font>

627
00:31:20,720 --> 00:31:28,309
s delegation down from the<font color="#CCCCCC"> route</font><font color="#E5E5E5"> the</font>

628
00:31:22,880 --> 00:31:30,679
actual walking and discovery<font color="#E5E5E5"> we're just</font>

629
00:31:28,309 --> 00:31:33,830
using ripe Atlas probes to<font color="#E5E5E5"> do and then</font>

630
00:31:30,679 --> 00:31:39,380
we get a big<font color="#E5E5E5"> JSON</font><font color="#CCCCCC"> feedback</font><font color="#E5E5E5"> from that but</font>

631
00:31:33,830 --> 00:31:41,539
then we visualize that<font color="#E5E5E5"> and sort of made</font>

632
00:31:39,380 --> 00:31:44,900
a little<font color="#CCCCCC"> tool that allowed us to for a</font>

633
00:31:41,539 --> 00:31:48,320
domain see what all of<font color="#E5E5E5"> the dependencies</font>

634
00:31:44,900 --> 00:31:50,390
were and how well secured every

635
00:31:48,320 --> 00:31:54,139
dependency was and we<font color="#CCCCCC"> started poking</font>

636
00:31:50,390 --> 00:31:56,419
<font color="#CCCCCC">around and</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> bad</font><font color="#CCCCCC"> I think</font>

637
00:31:54,140 --> 00:32:00,020
<font color="#CCCCCC">because of glue records and because</font>

638
00:31:56,419 --> 00:32:01,039
<font color="#CCCCCC">people think Oh more name servers is</font>

639
00:32:00,020 --> 00:32:03,590
better

640
00:32:01,039 --> 00:32:06,289
I'll get my buddy to be you know a

641
00:32:03,590 --> 00:32:09,559
secondary name server for<font color="#CCCCCC"> my domain</font><font color="#E5E5E5"> or</font>

642
00:32:06,289 --> 00:32:12,890
<font color="#E5E5E5">you know I registered with this</font><font color="#CCCCCC"> you know</font>

643
00:32:09,559 --> 00:32:17,030
<font color="#E5E5E5">$10 your registrar and they threw it in</font>

644
00:32:12,890 --> 00:32:19,280
for free<font color="#E5E5E5"> or whatever people have name</font>

645
00:32:17,030 --> 00:32:21,530
server records that<font color="#CCCCCC"> are all over the</font>

646
00:32:19,280 --> 00:32:23,059
<font color="#CCCCCC">place and the glue code is</font><font color="#E5E5E5"> coming or the</font>

647
00:32:21,530 --> 00:32:27,230
glue records are coming from<font color="#E5E5E5"> all over</font>

648
00:32:23,059 --> 00:32:29,720
the place and we've got a bunch<font color="#E5E5E5"> of</font>

649
00:32:27,230 --> 00:32:31,510
<font color="#E5E5E5">cleaning up to</font><font color="#CCCCCC"> do right</font><font color="#E5E5E5"> but we were</font>

650
00:32:29,720 --> 00:32:35,900
<font color="#CCCCCC">already</font><font color="#E5E5E5"> in much better shape than most</font>

651
00:32:31,510 --> 00:32:37,760
folks<font color="#E5E5E5"> and if you do this analysis on</font>

652
00:32:35,900 --> 00:32:41,539
your<font color="#E5E5E5"> domain names what you're gonna find</font>

653
00:32:37,760 --> 00:32:42,950
<font color="#E5E5E5">is that only there are only a few bright</font>

654
00:32:41,539 --> 00:32:45,470
spots<font color="#CCCCCC"> on the map</font><font color="#E5E5E5"> there's going to be</font>

655
00:32:42,950 --> 00:32:47,240
this big<font color="#E5E5E5"> spider web with</font><font color="#CCCCCC"> only a few</font>

656
00:32:45,470 --> 00:32:50,260
things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> have registrar lock or</font>

657
00:32:47,240 --> 00:32:53,210
registry lock or DNS<font color="#CCCCCC"> X signing done and</font>

658
00:32:50,260 --> 00:32:55,410
very<font color="#E5E5E5"> few things that have more</font><font color="#CCCCCC"> than one</font>

659
00:32:53,210 --> 00:32:57,090
<font color="#CCCCCC">of</font><font color="#E5E5E5"> those and there's going to be a</font>

660
00:32:55,410 --> 00:33:00,360
<font color="#E5E5E5">stuff that's</font><font color="#CCCCCC"> completely vulnerable and</font>

661
00:32:57,090 --> 00:33:03,419
what you need is all three<font color="#E5E5E5"> of those on</font>

662
00:33:00,360 --> 00:33:05,070
every dependency<font color="#E5E5E5"> in order to not</font><font color="#CCCCCC"> have a</font>

663
00:33:03,420 --> 00:33:07,790
point<font color="#CCCCCC"> of</font><font color="#E5E5E5"> entry for somebody doing DNS</font>

664
00:33:05,070 --> 00:33:07,790
hijacking<font color="#CCCCCC"> yeah</font>

665
00:33:13,770 --> 00:33:17,879
the<font color="#E5E5E5"> the question</font><font color="#CCCCCC"> is would CAA Records</font>

666
00:33:16,140 --> 00:33:19,740
have helped we're getting a<font color="#E5E5E5"> little bit</font>

667
00:33:17,880 --> 00:33:23,450
out of<font color="#E5E5E5"> my area of competence we've got</font>

668
00:33:19,740 --> 00:33:28,320
people<font color="#E5E5E5"> who are in my organization or</font>

669
00:33:23,450 --> 00:33:31,290
having that<font color="#CCCCCC"> argument and my</font>

670
00:33:28,320 --> 00:33:34,340
<font color="#CCCCCC">understanding is</font><font color="#E5E5E5"> that in a belt and</font>

671
00:33:31,290 --> 00:33:36,930
<font color="#E5E5E5">suspenders way we are implementing that</font>

672
00:33:34,340 --> 00:33:39,120
<font color="#CCCCCC">but that they don't seem to</font><font color="#E5E5E5"> have a lot</font>

673
00:33:36,930 --> 00:33:40,770
of<font color="#E5E5E5"> faith</font><font color="#CCCCCC"> in it and I</font><font color="#E5E5E5"> haven't been paying</font>

674
00:33:39,120 --> 00:33:43,909
attention closely<font color="#CCCCCC"> enough to</font><font color="#E5E5E5"> that part of</font>

675
00:33:40,770 --> 00:33:43,910
<font color="#E5E5E5">the conversation</font><font color="#CCCCCC"> to know why</font>

676
00:33:52,840 --> 00:34:02,129
yeah yeah<font color="#E5E5E5"> so there's there's a</font><font color="#CCCCCC"> lot of</font>

677
00:33:56,889 --> 00:34:06,309
stuff that<font color="#E5E5E5"> is that is theoretical and</font>

678
00:34:02,129 --> 00:34:08,889
works well when<font color="#E5E5E5"> people actively comply</font>

679
00:34:06,309 --> 00:34:11,319
with it but in the domain<font color="#E5E5E5"> name space</font>

680
00:34:08,889 --> 00:34:13,119
there<font color="#CCCCCC"> are a lot of</font><font color="#E5E5E5"> folks who</font><font color="#CCCCCC"> are more</font>

681
00:34:11,319 --> 00:34:15,849
<font color="#CCCCCC">interested in taking ten bucks a year</font>

682
00:34:13,119 --> 00:34:20,200
than they are in doing active compliance

683
00:34:15,849 --> 00:34:22,179
with new<font color="#E5E5E5"> security processes when</font><font color="#CCCCCC"> they</font>

684
00:34:20,199 --> 00:34:23,799
haven't<font color="#CCCCCC"> even implemented the security</font>

685
00:34:22,179 --> 00:34:28,869
processes<font color="#E5E5E5"> that they're</font><font color="#CCCCCC"> already supposed</font>

686
00:34:23,800 --> 00:34:31,000
to<font color="#E5E5E5"> be doing</font><font color="#CCCCCC"> so that said we've been</font>

687
00:34:28,869 --> 00:34:32,980
having<font color="#CCCCCC"> conversations with</font><font color="#E5E5E5"> both Komodo</font>

688
00:34:31,000 --> 00:34:36,159
and<font color="#E5E5E5"> let's encrypt the let's encrypt guys</font>

689
00:34:32,980 --> 00:34:38,500
are very interested in<font color="#E5E5E5"> fixing these</font>

690
00:34:36,159 --> 00:34:41,349
holes and<font color="#E5E5E5"> getting it right and the</font>

691
00:34:38,500 --> 00:34:43,530
Komodo people like we already<font color="#CCCCCC"> know</font>

692
00:34:41,349 --> 00:34:49,020
everything<font color="#CCCCCC"> we don't need to</font><font color="#E5E5E5"> talk to you</font>

693
00:34:43,530 --> 00:34:49,020
so<font color="#E5E5E5"> you know yeah</font>

694
00:34:54,520 --> 00:34:57,240
yep

695
00:35:03,690 --> 00:35:08,100
<font color="#E5E5E5">all right so the the question</font>

696
00:35:05,400 --> 00:35:15,060
<font color="#E5E5E5">essentially was attribution and goals of</font>

697
00:35:08,100 --> 00:35:20,549
the<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> so these are</font><font color="#CCCCCC"> military attacks</font>

698
00:35:15,060 --> 00:35:26,820
<font color="#E5E5E5">cyber offense attacks we are not the end</font>

699
00:35:20,550 --> 00:35:29,760
target<font color="#E5E5E5"> we provide the DNS</font><font color="#CCCCCC"> back-end</font><font color="#E5E5E5"> for a</font>

700
00:35:26,820 --> 00:35:31,680
hundred<font color="#CCCCCC"> and thirty countries</font><font color="#E5E5E5"> five</font>

701
00:35:29,760 --> 00:35:40,470
<font color="#CCCCCC">hundred and</font><font color="#E5E5E5"> fifty top-level domains in</font>

702
00:35:31,680 --> 00:35:43,230
all including the the<font color="#CCCCCC"> two letter ISO</font>

703
00:35:40,470 --> 00:35:46,339
<font color="#CCCCCC">cctlds</font><font color="#E5E5E5"> for a lot of countries but also</font>

704
00:35:43,230 --> 00:35:49,980
<font color="#E5E5E5">then</font><font color="#CCCCCC"> there IDN TLDs the</font>

705
00:35:46,340 --> 00:35:52,470
internationalized TLD so dot<font color="#E5E5E5"> HK for Hong</font>

706
00:35:49,980 --> 00:35:56,130
<font color="#E5E5E5">Kong but also then</font><font color="#CCCCCC"> the same</font><font color="#E5E5E5"> thing in</font>

707
00:35:52,470 --> 00:35:59,040
Chinese characters<font color="#E5E5E5"> and dot</font><font color="#CCCCCC"> AE for the</font>

708
00:35:56,130 --> 00:36:03,420
United Arab Emirates<font color="#CCCCCC"> but also dot</font><font color="#E5E5E5"> M rot</font>

709
00:35:59,040 --> 00:36:07,740
in Arabic script<font color="#E5E5E5"> for instance</font><font color="#CCCCCC"> plus</font><font color="#E5E5E5"> then</font>

710
00:36:03,420 --> 00:36:14,810
a whole bunch<font color="#E5E5E5"> of brand TL DS</font>

711
00:36:07,740 --> 00:36:14,810
BMW<font color="#CCCCCC"> all the fiat-chrysler ones</font><font color="#E5E5E5"> FedEx UPS</font>

712
00:36:15,740 --> 00:36:23,879
<font color="#E5E5E5">bunch of aviation ones right so if you</font>

713
00:36:21,210 --> 00:36:26,760
<font color="#E5E5E5">look at the list of countries</font><font color="#CCCCCC"> that use</font>

714
00:36:23,880 --> 00:36:28,920
us<font color="#CCCCCC"> for their DNS back-end it includes</font>

715
00:36:26,760 --> 00:36:36,950
essentially every Middle Eastern country

716
00:36:28,920 --> 00:36:39,930
other than Iran<font color="#CCCCCC"> so there's that</font>

717
00:36:36,950 --> 00:36:42,359
so the the attempt is a pre positioning

718
00:36:39,930 --> 00:36:45,600
attack right we were not ever intended

719
00:36:42,360 --> 00:36:48,140
<font color="#CCCCCC">to find out about the attack</font><font color="#E5E5E5"> and they're</font>

720
00:36:45,600 --> 00:36:50,420
not going<font color="#E5E5E5"> after us as individuals</font><font color="#CCCCCC"> and</font>

721
00:36:48,140 --> 00:36:53,720
you know there's banking information

722
00:36:50,420 --> 00:36:57,900
that they had access<font color="#CCCCCC"> to and didn't</font>

723
00:36:53,720 --> 00:37:00,959
<font color="#E5E5E5">particularly you know bite at what they</font>

724
00:36:57,900 --> 00:37:03,780
<font color="#CCCCCC">are purely</font><font color="#E5E5E5"> going for was anything</font><font color="#CCCCCC"> that</font>

725
00:37:00,960 --> 00:37:05,460
<font color="#CCCCCC">they could</font><font color="#E5E5E5"> find out about the the</font>

726
00:37:03,780 --> 00:37:10,950
countries that were<font color="#E5E5E5"> doing they were</font>

727
00:37:05,460 --> 00:37:14,190
working<font color="#CCCCCC"> with</font><font color="#E5E5E5"> us and any way that they</font>

728
00:37:10,950 --> 00:37:15,600
could<font color="#E5E5E5"> use compromising us to get to</font>

729
00:37:14,190 --> 00:37:20,340
the services we are<font color="#CCCCCC"> providing</font><font color="#E5E5E5"> for those</font>

730
00:37:15,600 --> 00:37:22,470
<font color="#CCCCCC">countries in terms of attribution</font><font color="#E5E5E5"> from</font>

731
00:37:20,340 --> 00:37:25,800
what I just<font color="#CCCCCC"> said you probably have a</font>

732
00:37:22,470 --> 00:37:27,569
guess<font color="#E5E5E5"> but I'll tell you that that guess</font>

733
00:37:25,800 --> 00:37:31,020
is incomplete<font color="#E5E5E5"> it's a lot more</font>

734
00:37:27,570 --> 00:37:35,250
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> than that</font><font color="#E5E5E5"> and that will wind</font>

735
00:37:31,020 --> 00:37:36,870
up<font color="#E5E5E5"> out there</font><font color="#CCCCCC"> in time</font><font color="#E5E5E5"> all right thank you</font>

736
00:37:35,250 --> 00:37:37,510
<font color="#E5E5E5">very much I'll be around</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> rest of the</font>

737
00:37:36,870 --> 00:37:41,709
day and<font color="#CCCCCC"> tomorrow</font>

738
00:37:37,510 --> 00:37:41,709
[Applause]

