1
00:00:02,879 --> 00:00:04,160
yeah okay

2
00:00:04,160 --> 00:00:05,920
so

3
00:00:05,920 --> 00:00:08,480
this is about eproms and tares but we

4
00:00:08,480 --> 00:00:10,320
made a little fun about it so we call it

5
00:00:10,320 --> 00:00:12,480
for tears

6
00:00:12,480 --> 00:00:14,240
it works for us

7
00:00:14,240 --> 00:00:17,359
non-native english speakers but uh yeah

8
00:00:17,359 --> 00:00:19,039
the british people in the room always

9
00:00:19,039 --> 00:00:21,199
dislikes it

10
00:00:21,199 --> 00:00:24,320
so who am i i'm iceman or you rather

11
00:00:24,320 --> 00:00:25,920
know me as iceman if you've been into

12
00:00:25,920 --> 00:00:27,760
proximal community where i've been an

13
00:00:27,760 --> 00:00:30,400
administrator and forum manager for

14
00:00:30,400 --> 00:00:33,200
some good old seven years i have a life

15
00:00:33,200 --> 00:00:35,280
outside of this i do this as a hobby as

16
00:00:35,280 --> 00:00:37,680
a funny thing to do and

17
00:00:37,680 --> 00:00:39,520
i have been contributing to the source

18
00:00:39,520 --> 00:00:41,840
code very much because i'm a code monkey

19
00:00:41,840 --> 00:00:44,079
and my friend here is a chip monkey we

20
00:00:44,079 --> 00:00:47,200
have a next generation adam

21
00:00:47,200 --> 00:00:48,719
and we also did a little device but we

22
00:00:48,719 --> 00:00:50,800
want to talk more about later on and i'm

23
00:00:50,800 --> 00:00:53,120
also a co-trainer for red team alliance

24
00:00:53,120 --> 00:00:56,320
where we do a practical rfid packs

25
00:00:56,320 --> 00:01:00,559
attacking defense so quick over to you

26
00:01:00,559 --> 00:01:03,120
oops not too fast different ah i'm

27
00:01:03,120 --> 00:01:05,760
philip tohen uh dugox on the internet

28
00:01:05,760 --> 00:01:07,600
but don't try to say the word just write

29
00:01:07,600 --> 00:01:10,720
it it's fine i'm the leader of the

30
00:01:10,720 --> 00:01:13,200
cryptography embedded security team at

31
00:01:13,200 --> 00:01:15,600
queerslab and you may know me for some

32
00:01:15,600 --> 00:01:16,640
other

33
00:01:16,640 --> 00:01:18,799
like whitebox attack papers or open

34
00:01:18,799 --> 00:01:20,799
source projects

35
00:01:20,799 --> 00:01:22,159
and

36
00:01:22,159 --> 00:01:24,799
since couple of years i am mostly coming

37
00:01:24,799 --> 00:01:27,040
to contributor to proxmark and

38
00:01:27,040 --> 00:01:29,280
maintaining the discord forum with

39
00:01:29,280 --> 00:01:30,799
iceman

40
00:01:30,799 --> 00:01:32,640
did a lot of trainings on the topic as

41
00:01:32,640 --> 00:01:33,759
well

42
00:01:33,759 --> 00:01:37,439
and by the way the drawing

43
00:01:37,920 --> 00:01:40,479
how does it come that we are all working

44
00:01:40,479 --> 00:01:43,280
together and doing a funny research

45
00:01:43,280 --> 00:01:44,479
it's uh

46
00:01:44,479 --> 00:01:47,680
thanks to the null content 19 event so

47
00:01:47,680 --> 00:01:49,520
tank and trick a lot

48
00:01:49,520 --> 00:01:50,399
for

49
00:01:50,399 --> 00:01:51,360
things

50
00:01:51,360 --> 00:01:53,759
happening now today here

51
00:01:53,759 --> 00:01:56,479
it's all thanks to you

52
00:01:56,479 --> 00:01:58,320
so and you'll be we all look a little

53
00:01:58,320 --> 00:02:00,560
bit younger

54
00:02:00,560 --> 00:02:04,079
usually suspect on that picture

55
00:02:04,079 --> 00:02:06,960
isn't it fancy

56
00:02:07,040 --> 00:02:08,639
you want it black or you want to comment

57
00:02:08,639 --> 00:02:11,760
the picture no no no okay okay

58
00:02:11,760 --> 00:02:16,319
um so yeah what's a physical tearing

59
00:02:16,319 --> 00:02:18,239
tearing is a

60
00:02:18,239 --> 00:02:19,840
technical term

61
00:02:19,840 --> 00:02:22,480
when someone wants to to batch his area

62
00:02:22,480 --> 00:02:25,120
id tag on a reader and on the metro it

63
00:02:25,120 --> 00:02:27,520
goes away a bit too fast maybe the

64
00:02:27,520 --> 00:02:30,640
reader was busy writing on your tag

65
00:02:30,640 --> 00:02:33,280
and when you take it away well the the

66
00:02:33,280 --> 00:02:36,560
power supply the the card drops with the

67
00:02:36,560 --> 00:02:37,760
field and

68
00:02:37,760 --> 00:02:40,160
maybe you risk to corrupt the memory so

69
00:02:40,160 --> 00:02:42,000
that's something quite useful that they

70
00:02:42,000 --> 00:02:44,800
have to deal with and most rfid attacks

71
00:02:44,800 --> 00:02:46,640
nowadays they have to support it because

72
00:02:46,640 --> 00:02:48,720
that stuff can happen

73
00:02:48,720 --> 00:02:52,000
uh in the life

74
00:02:52,080 --> 00:02:55,200
so we will explore a bit more in detail

75
00:02:55,200 --> 00:02:56,800
this type of event

76
00:02:56,800 --> 00:02:58,879
what we can do with that what is the

77
00:02:58,879 --> 00:03:00,239
eprom

78
00:03:00,239 --> 00:03:02,400
physics phenomenon behind it

79
00:03:02,400 --> 00:03:04,959
and understanding allow to to get better

80
00:03:04,959 --> 00:03:07,599
control on what's really happening and

81
00:03:07,599 --> 00:03:09,440
then we will check what kind of secret

82
00:03:09,440 --> 00:03:12,319
feature could be defeated on that and we

83
00:03:12,319 --> 00:03:14,640
will show four different examples of

84
00:03:14,640 --> 00:03:17,360
rfid tags and features

85
00:03:17,360 --> 00:03:20,640
that we could play with

86
00:03:20,640 --> 00:03:23,200
and all that was done with support of

87
00:03:23,200 --> 00:03:24,400
some

88
00:03:24,400 --> 00:03:27,040
tools that we made about open source and

89
00:03:27,040 --> 00:03:32,120
all available in the proxmox repository

90
00:03:32,400 --> 00:03:33,440
um

91
00:03:33,440 --> 00:03:34,319
so

92
00:03:34,319 --> 00:03:37,440
yeah how to to tear the attack when we

93
00:03:37,440 --> 00:03:39,120
want to do that uh

94
00:03:39,120 --> 00:03:41,280
in terms of research we don't do a

95
00:03:41,280 --> 00:03:43,040
little robot that will take the card

96
00:03:43,040 --> 00:03:45,519
away there is much simpler we just cut

97
00:03:45,519 --> 00:03:48,159
the power of the reader at some precise

98
00:03:48,159 --> 00:03:49,519
timing

99
00:03:49,519 --> 00:03:52,560
and because the way rfid is done when

100
00:03:52,560 --> 00:03:55,439
you cut power on the reader you cut the

101
00:03:55,439 --> 00:03:57,760
power of the tag and that's something

102
00:03:57,760 --> 00:03:59,680
iceman can cover with as well the the

103
00:03:59,680 --> 00:04:01,439
tools we're using

104
00:04:01,439 --> 00:04:02,560
yeah

105
00:04:02,560 --> 00:04:05,200
for our purposes and that tests uh we

106
00:04:05,200 --> 00:04:07,439
were using the proxmox out of a4 we will

107
00:04:07,439 --> 00:04:09,040
talk a little bit more about proxmox

108
00:04:09,040 --> 00:04:11,200
about later but if you don't know

109
00:04:11,200 --> 00:04:13,280
anything about rfid

110
00:04:13,280 --> 00:04:15,040
you need to know it's about magnetic

111
00:04:15,040 --> 00:04:17,040
coupling to transfer power to the card

112
00:04:17,040 --> 00:04:20,399
or the tag which you see down below here

113
00:04:20,399 --> 00:04:24,400
you can see the concept of this as the

114
00:04:24,400 --> 00:04:26,320
magnetic flux you're building up a fear

115
00:04:26,320 --> 00:04:27,600
of a near

116
00:04:27,600 --> 00:04:30,240
of this antenna that's powering it on so

117
00:04:30,240 --> 00:04:33,600
when we do tearing or tearings we

118
00:04:33,600 --> 00:04:35,440
actually cut the power and that magnetic

119
00:04:35,440 --> 00:04:36,400
flux

120
00:04:36,400 --> 00:04:38,560
strips away very fast

121
00:04:38,560 --> 00:04:40,880
that goes very instantly but what's left

122
00:04:40,880 --> 00:04:42,400
is in the coil in what tag and

123
00:04:42,400 --> 00:04:45,199
capacitors on the tag that makes

124
00:04:45,199 --> 00:04:46,960
you know this attacks a little bit

125
00:04:46,960 --> 00:04:49,440
unprecise in a sense it's like lingers

126
00:04:49,440 --> 00:04:50,639
on

127
00:04:50,639 --> 00:04:53,919
but basically yes it's a loop antennas

128
00:04:53,919 --> 00:04:56,180
both for lf and hf so we do it

129
00:04:56,180 --> 00:04:57,600
[Music]

130
00:04:57,600 --> 00:05:00,479
with aprox mock 2004 was a guy called

131
00:05:00,479 --> 00:05:02,720
jonathan vestius he's an engineer in

132
00:05:02,720 --> 00:05:05,520
california and he was very curious about

133
00:05:05,520 --> 00:05:08,240
something that the governor aware said

134
00:05:08,240 --> 00:05:10,560
very cheap so very secure so we can't

135
00:05:10,560 --> 00:05:12,400
clone them or do anything with that so

136
00:05:12,400 --> 00:05:14,400
being an engineer as he did he started

137
00:05:14,400 --> 00:05:15,840
to think about it and tinker with it and

138
00:05:15,840 --> 00:05:18,080
start building a device this is what's

139
00:05:18,080 --> 00:05:20,400
called the prox mark that is the one you

140
00:05:20,400 --> 00:05:22,240
see up here to the left

141
00:05:22,240 --> 00:05:24,560
that's the first iteration of it and you

142
00:05:24,560 --> 00:05:26,720
see like everything else he went over to

143
00:05:26,720 --> 00:05:28,400
some more iterations of his this is

144
00:05:28,400 --> 00:05:30,000
proxmok2

145
00:05:30,000 --> 00:05:33,039
and in the end 2008 he also made a

146
00:05:33,039 --> 00:05:34,960
proxmod version free

147
00:05:34,960 --> 00:05:35,759
which

148
00:05:35,759 --> 00:05:38,080
which is actually until this day the

149
00:05:38,080 --> 00:05:40,560
same hardware but we still use in the

150
00:05:40,560 --> 00:05:42,720
same base with schematics and shameless

151
00:05:42,720 --> 00:05:45,759
about it so from 2010 this green pcb

152
00:05:45,759 --> 00:05:47,759
board came out but

153
00:05:47,759 --> 00:05:49,280
it's

154
00:05:49,280 --> 00:05:50,800
before that you had to hand solder it

155
00:05:50,800 --> 00:05:52,639
yourself and make all this stuff because

156
00:05:52,639 --> 00:05:54,320
he made open source and open hardware

157
00:05:54,320 --> 00:05:56,160
but he didn't make a product out of it

158
00:05:56,160 --> 00:05:59,199
he seems long gone but what you see

159
00:05:59,199 --> 00:06:01,440
after this was several iterations of

160
00:06:01,440 --> 00:06:04,240
proxmos coming out and we were using or

161
00:06:04,240 --> 00:06:06,800
i was involved with it in making the rv4

162
00:06:06,800 --> 00:06:08,880
which you see here funny thing with this

163
00:06:08,880 --> 00:06:11,120
one is that this little piece here is

164
00:06:11,120 --> 00:06:13,199
the circuitry the rest is with dual

165
00:06:13,199 --> 00:06:16,960
antennas here this is no but that's not

166
00:06:16,960 --> 00:06:19,280
proper size this is much bigger

167
00:06:19,280 --> 00:06:20,720
this has batteries and all that stuff

168
00:06:20,720 --> 00:06:22,960
you want to add it on so it's proper but

169
00:06:22,960 --> 00:06:25,520
it's gone the whole way from there to

170
00:06:25,520 --> 00:06:28,639
now but remember we're all using the

171
00:06:28,639 --> 00:06:30,400
same software

172
00:06:30,400 --> 00:06:32,880
so this runs the same stuff for that one

173
00:06:32,880 --> 00:06:34,639
so if you have an old one you can still

174
00:06:34,639 --> 00:06:36,080
run and do all the things you do today

175
00:06:36,080 --> 00:06:37,759
i'm not sure if it's some older

176
00:06:37,759 --> 00:06:40,080
attackers or box markers here

177
00:06:40,080 --> 00:06:42,240
if you ever had used one has anyone here

178
00:06:42,240 --> 00:06:44,400
used the proxmod before

179
00:06:44,400 --> 00:06:45,600
holy

180
00:06:45,600 --> 00:06:48,400
wow that's amazing

181
00:06:48,400 --> 00:06:51,120
oh that's great

182
00:06:51,120 --> 00:06:55,199
let's get on with them perfect

183
00:06:56,319 --> 00:06:59,840
that's not your software i know

184
00:06:59,840 --> 00:07:02,160
anyway let's see we need to go to the

185
00:07:02,160 --> 00:07:04,400
terminal so we are like

186
00:07:04,400 --> 00:07:06,560
uh we're gonna have this uh

187
00:07:06,560 --> 00:07:08,000
pleasing with demo gods today we're

188
00:07:08,000 --> 00:07:09,759
gonna do live demonstrations about

189
00:07:09,759 --> 00:07:11,840
things so we hope it goes well and keep

190
00:07:11,840 --> 00:07:13,759
your fingers crossed for us and we need

191
00:07:13,759 --> 00:07:16,000
to turn our heads to look when we type

192
00:07:16,000 --> 00:07:17,759
so please take that in consideration as

193
00:07:17,759 --> 00:07:19,280
well and

194
00:07:19,280 --> 00:07:21,199
we go from there but basically what's

195
00:07:21,199 --> 00:07:23,120
happening is if you take a simple card

196
00:07:23,120 --> 00:07:25,199
let's say like my fair ultralight it's a

197
00:07:25,199 --> 00:07:27,440
simple tag with a little piece of memory

198
00:07:27,440 --> 00:07:29,599
we choose a user memory address called

199
00:07:29,599 --> 00:07:32,720
block 4 which is all available to read

200
00:07:32,720 --> 00:07:34,639
and we write to it we set it to a value

201
00:07:34,639 --> 00:07:37,199
called ffffs

202
00:07:37,199 --> 00:07:38,240
and

203
00:07:38,240 --> 00:07:40,960
if you interrupt that you launch a

204
00:07:40,960 --> 00:07:42,960
second write and interrupt it you shut

205
00:07:42,960 --> 00:07:44,639
down the feel after

206
00:07:44,639 --> 00:07:48,639
some seconds or micro microseconds

207
00:07:48,639 --> 00:07:50,400
in the

208
00:07:50,400 --> 00:07:54,000
yeah i can do this as well

209
00:07:54,720 --> 00:07:56,879
if you shut around we like observe what

210
00:07:56,879 --> 00:07:58,960
happens and then just like read back

211
00:07:58,960 --> 00:08:00,960
their memory points and if something

212
00:08:00,960 --> 00:08:03,919
could happen what we're interested in

213
00:08:03,919 --> 00:08:05,599
we don't have to repeat but normally it

214
00:08:05,599 --> 00:08:07,039
doesn't because that's the whole thing

215
00:08:07,039 --> 00:08:09,039
is finding the right timings and figure

216
00:08:09,039 --> 00:08:10,960
out what's going on so you have to go

217
00:08:10,960 --> 00:08:13,039
back to set up there initial value an

218
00:08:13,039 --> 00:08:15,199
initial state that you want to go from

219
00:08:15,199 --> 00:08:17,520
and then you try to understand the rest

220
00:08:17,520 --> 00:08:18,040
of it

221
00:08:18,040 --> 00:08:20,240
[Music]

222
00:08:20,240 --> 00:08:22,400
let's demonstrate like this

223
00:08:22,400 --> 00:08:23,520
so here

224
00:08:23,520 --> 00:08:26,400
as i said before we did the right fffs

225
00:08:26,400 --> 00:08:28,319
we trigger the second one with a tearing

226
00:08:28,319 --> 00:08:29,440
at 200

227
00:08:29,440 --> 00:08:31,680
microseconds and afterwards we do a read

228
00:08:31,680 --> 00:08:33,120
and see nah

229
00:08:33,120 --> 00:08:34,479
nothing happened

230
00:08:34,479 --> 00:08:36,159
we increased the timing

231
00:08:36,159 --> 00:08:37,599
nothing happened

232
00:08:37,599 --> 00:08:39,200
we did the right

233
00:08:39,200 --> 00:08:41,360
we interrupt it and something happened

234
00:08:41,360 --> 00:08:43,039
when we read it

235
00:08:43,039 --> 00:08:45,040
what was going on

236
00:08:45,040 --> 00:08:47,200
this goes on all the way down to about

237
00:08:47,200 --> 00:08:49,600
200 and then you see

238
00:08:49,600 --> 00:08:51,120
in the next one two thousand four

239
00:08:51,120 --> 00:08:53,279
hundred microseconds later that you see

240
00:08:53,279 --> 00:08:54,480
the new value

241
00:08:54,480 --> 00:08:56,880
so what we see up here is the old value

242
00:08:56,880 --> 00:08:59,360
this is the erased value and this is the

243
00:08:59,360 --> 00:09:01,440
newly written value

244
00:09:01,440 --> 00:09:02,959
so we take that

245
00:09:02,959 --> 00:09:05,440
and start thinking about it what can we

246
00:09:05,440 --> 00:09:08,760
do with that

247
00:09:10,959 --> 00:09:14,399
can't do very much actually yes we can

248
00:09:15,040 --> 00:09:17,680
okay so with that in mind

249
00:09:17,680 --> 00:09:19,440
knowing the process of what happens in

250
00:09:19,440 --> 00:09:21,040
eprom during this

251
00:09:21,040 --> 00:09:22,880
attacks what

252
00:09:22,880 --> 00:09:24,720
do we need to know

253
00:09:24,720 --> 00:09:27,040
we need to have something that involves

254
00:09:27,040 --> 00:09:29,040
writing to be prom with an erase or a

255
00:09:29,040 --> 00:09:30,480
right command

256
00:09:30,480 --> 00:09:32,320
we need to have something that we can

257
00:09:32,320 --> 00:09:35,279
trigger that we can control

258
00:09:35,279 --> 00:09:37,360
and

259
00:09:37,360 --> 00:09:40,399
we don't influence the output of it

260
00:09:40,399 --> 00:09:41,920
so it's not like a normal right to a

261
00:09:41,920 --> 00:09:43,440
normal user memory because that would be

262
00:09:43,440 --> 00:09:45,040
useless because if you want to write all

263
00:09:45,040 --> 00:09:47,360
zeros we could have done that but if we

264
00:09:47,360 --> 00:09:49,360
can't control the output that makes a

265
00:09:49,360 --> 00:09:52,240
whole deep difference

266
00:09:54,320 --> 00:09:57,279
yes the first attack we will demonstrate

267
00:09:57,279 --> 00:09:58,720
is on the

268
00:09:58,720 --> 00:10:00,640
russian guard which is a clone of a

269
00:10:00,640 --> 00:10:02,480
myfair ultralight which was used some

270
00:10:02,480 --> 00:10:04,399
years ago in the

271
00:10:04,399 --> 00:10:06,880
moscow metropolitan

272
00:10:06,880 --> 00:10:08,480
and

273
00:10:08,480 --> 00:10:10,959
it has a layout pretty much similar to

274
00:10:10,959 --> 00:10:13,120
the michael ultralight so this is a

275
00:10:13,120 --> 00:10:15,200
memory layout you see there and there

276
00:10:15,200 --> 00:10:18,720
are here otps otps are one-time

277
00:10:18,720 --> 00:10:20,320
programmable

278
00:10:20,320 --> 00:10:21,600
bits

279
00:10:21,600 --> 00:10:24,240
which means once you flip a bit to one

280
00:10:24,240 --> 00:10:26,079
you can never

281
00:10:26,079 --> 00:10:27,600
go back to zero

282
00:10:27,600 --> 00:10:28,959
so it's used for example in

283
00:10:28,959 --> 00:10:32,240
transportation because you can

284
00:10:32,240 --> 00:10:34,880
mark journeys on the same card and you

285
00:10:34,880 --> 00:10:37,440
burn a bit every time someone travels so

286
00:10:37,440 --> 00:10:40,240
if you have 32 bits you can validate 32

287
00:10:40,240 --> 00:10:41,839
travels and then

288
00:10:41,839 --> 00:10:44,640
that's over

289
00:10:44,959 --> 00:10:47,519
so this one has the characteristics

290
00:10:47,519 --> 00:10:49,600
iceman was looking for

291
00:10:49,600 --> 00:10:50,880
because

292
00:10:50,880 --> 00:10:52,000
you can

293
00:10:52,000 --> 00:10:54,000
write to otp

294
00:10:54,000 --> 00:10:56,480
but you can't control the fully the

295
00:10:56,480 --> 00:10:58,560
result if you want to get it zero you

296
00:10:58,560 --> 00:11:00,320
can't get it zero if they are already

297
00:11:00,320 --> 00:11:01,360
once

298
00:11:01,360 --> 00:11:02,959
in the way

299
00:11:02,959 --> 00:11:03,760
so

300
00:11:03,760 --> 00:11:06,399
for example here if the otp has a value

301
00:11:06,399 --> 00:11:08,800
one two three five six say

302
00:11:08,800 --> 00:11:11,760
seven eight and you want to write all

303
00:11:11,760 --> 00:11:13,839
zeros and one what happens is that the

304
00:11:13,839 --> 00:11:16,800
card will read the current otp value

305
00:11:16,800 --> 00:11:20,240
will do a logical or so it can only set

306
00:11:20,240 --> 00:11:21,279
bits

307
00:11:21,279 --> 00:11:25,839
and say okay that will give the

308
00:11:26,640 --> 00:11:28,480
last value okay thank you

309
00:11:28,480 --> 00:11:31,680
with a nine i just write that value to

310
00:11:31,680 --> 00:11:34,000
the otp memory

311
00:11:34,000 --> 00:11:35,760
so if you read it back

312
00:11:35,760 --> 00:11:38,079
you want to read the value you wrote but

313
00:11:38,079 --> 00:11:39,360
you will read

314
00:11:39,360 --> 00:11:40,320
the

315
00:11:40,320 --> 00:11:42,240
result of the logical or between these

316
00:11:42,240 --> 00:11:44,399
two values

317
00:11:44,399 --> 00:11:46,560
except that in that

318
00:11:46,560 --> 00:11:48,800
specific card

319
00:11:48,800 --> 00:11:49,680
to

320
00:11:49,680 --> 00:11:50,560
trigger

321
00:11:50,560 --> 00:11:52,639
to do the right operation

322
00:11:52,639 --> 00:11:55,519
they do a regular eprom right involving

323
00:11:55,519 --> 00:11:58,480
the erase that you saw first when you

324
00:11:58,480 --> 00:12:00,800
tried on the other ultralights

325
00:12:00,800 --> 00:12:02,959
so if you want to attack such a card

326
00:12:02,959 --> 00:12:05,839
it's pretty easy what would you do

327
00:12:05,839 --> 00:12:08,320
with tear off

328
00:12:08,320 --> 00:12:12,320
your tier just after the erase

329
00:12:12,320 --> 00:12:13,920
and then that's it

330
00:12:13,920 --> 00:12:15,680
you get zeros

331
00:12:15,680 --> 00:12:17,600
uh that's not an attack from us it's an

332
00:12:17,600 --> 00:12:19,519
attack from now alguzoli and three year

333
00:12:19,519 --> 00:12:22,320
old kmart published it in their student

334
00:12:22,320 --> 00:12:24,560
thesis last year

335
00:12:24,560 --> 00:12:27,519
um but still iceland can make a demo out

336
00:12:27,519 --> 00:12:29,600
of it let's see about that but you knew

337
00:12:29,600 --> 00:12:31,839
about this um attack long before you had

338
00:12:31,839 --> 00:12:33,920
in your trainings didn't you

339
00:12:33,920 --> 00:12:37,639
philip does trainings

340
00:12:40,639 --> 00:12:42,160
all right

341
00:12:42,160 --> 00:12:44,160
it takes a little bit fiddling here with

342
00:12:44,160 --> 00:12:46,240
the camera and everything to set it up

343
00:12:46,240 --> 00:12:49,639
all right great

344
00:12:51,760 --> 00:12:54,880
[Music]

345
00:12:58,079 --> 00:13:01,200
all right let's oh jesus christ uh

346
00:13:01,200 --> 00:13:04,240
i'm gonna get a headache from this

347
00:13:04,240 --> 00:13:08,639
and let's see i can spell what you type

348
00:13:08,959 --> 00:13:10,800
thank you very much

349
00:13:10,800 --> 00:13:12,560
as you see my camera that's the proxmox

350
00:13:12,560 --> 00:13:16,639
4 rb4 from free rv4 yeah so i won't give

351
00:13:16,639 --> 00:13:20,320
you the notes yeah thank you

352
00:13:20,800 --> 00:13:23,440
am i in there

353
00:13:23,440 --> 00:13:24,880
you're here so you can compete and

354
00:13:24,880 --> 00:13:26,240
uh-huh

355
00:13:26,240 --> 00:13:28,160
all right great so if that's gonna go

356
00:13:28,160 --> 00:13:31,839
over that what where am i

357
00:13:32,000 --> 00:13:34,160
over here

358
00:13:34,160 --> 00:13:36,639
hello so great inside with proxmox

359
00:13:36,639 --> 00:13:38,000
client this will be different if you

360
00:13:38,000 --> 00:13:39,519
ever use it you know it's been a little

361
00:13:39,519 --> 00:13:41,440
bit complicated over the years but with

362
00:13:41,440 --> 00:13:43,120
contributions become a little bit easier

363
00:13:43,120 --> 00:13:44,720
i'm talking a bit faster because i want

364
00:13:44,720 --> 00:13:46,880
to get over this section quite fast

365
00:13:46,880 --> 00:13:50,240
normally you just type in hell

366
00:13:50,320 --> 00:13:52,240
no that's wrong enter

367
00:13:52,240 --> 00:13:54,240
there you go and you see something nice

368
00:13:54,240 --> 00:13:57,519
outputs explaining what it is

369
00:13:57,519 --> 00:13:59,680
i also briefly say

370
00:13:59,680 --> 00:14:01,680
here are some

371
00:14:01,680 --> 00:14:04,320
and here's a description of it however

372
00:14:04,320 --> 00:14:05,920
not all things are commands from the

373
00:14:05,920 --> 00:14:08,160
proximal clients we have a hint saying

374
00:14:08,160 --> 00:14:10,399
if you see this angle record it's a

375
00:14:10,399 --> 00:14:12,160
category of commands

376
00:14:12,160 --> 00:14:13,760
so here would be without that would be a

377
00:14:13,760 --> 00:14:15,519
command that you run and this would be a

378
00:14:15,519 --> 00:14:17,839
category that you go into and that's

379
00:14:17,839 --> 00:14:21,199
what we want to demonstrate right now

380
00:14:22,160 --> 00:14:23,040
so

381
00:14:23,040 --> 00:14:25,680
so for high frequency you type in hf and

382
00:14:25,680 --> 00:14:27,360
press enter you will see

383
00:14:27,360 --> 00:14:29,120
the high frequency commands it's a

384
00:14:29,120 --> 00:14:31,440
little bit large so it's hard to say

385
00:14:31,440 --> 00:14:33,279
and if i would put on a little card onto

386
00:14:33,279 --> 00:14:34,160
here

387
00:14:34,160 --> 00:14:35,839
micron

388
00:14:35,839 --> 00:14:38,320
over proxmog when it comes to fortnite

389
00:14:38,320 --> 00:14:40,160
you need to have some distance so like

390
00:14:40,160 --> 00:14:42,320
literally put on this nicely

391
00:14:42,320 --> 00:14:44,639
bluetooth blue shark fee

392
00:14:44,639 --> 00:14:47,839
and then you can type in hf search

393
00:14:47,839 --> 00:14:51,199
and then type like a crazy person today

394
00:14:51,199 --> 00:14:52,880
there you go

395
00:14:52,880 --> 00:14:55,920
approximate identifies and

396
00:14:55,920 --> 00:14:58,079
shows event collision of a tag and gives

397
00:14:58,079 --> 00:15:01,040
you a hint to note that under hfmfu and

398
00:15:01,040 --> 00:15:04,480
the view info you will see that this tag

399
00:15:04,480 --> 00:15:07,519
have some more information

400
00:15:08,639 --> 00:15:11,600
which is the interesting part

401
00:15:11,600 --> 00:15:13,360
you see it's an alt-right

402
00:15:13,360 --> 00:15:15,680
it's identifies micron from russia

403
00:15:15,680 --> 00:15:17,680
by battle value and this is what we're

404
00:15:17,680 --> 00:15:19,600
interesting this is the four series here

405
00:15:19,600 --> 00:15:21,440
this is an unset

406
00:15:21,440 --> 00:15:23,920
otp

407
00:15:24,000 --> 00:15:25,760
and our purpose

408
00:15:25,760 --> 00:15:29,680
is to demonstrate what happens now

409
00:15:32,000 --> 00:15:34,800
let's see god

410
00:15:39,360 --> 00:15:40,880
it's a different keyboard as well so

411
00:15:40,880 --> 00:15:42,399
it's

412
00:15:42,399 --> 00:15:43,759
jesus christ

413
00:15:43,759 --> 00:15:46,800
sorry about that right

414
00:15:46,880 --> 00:15:49,920
lots of spaces here

415
00:15:51,120 --> 00:15:52,880
three things yeah it says it didn't

416
00:15:52,880 --> 00:15:54,959
answer

417
00:15:54,959 --> 00:15:56,880
there you go that's reading the block

418
00:15:56,880 --> 00:15:59,279
three block three was as philip was

419
00:15:59,279 --> 00:16:00,959
showing before is the

420
00:16:00,959 --> 00:16:02,800
the otp value so this is what we're

421
00:16:02,800 --> 00:16:04,880
looking at right now

422
00:16:04,880 --> 00:16:07,199
if we were to type

423
00:16:07,199 --> 00:16:08,639
write commands

424
00:16:08,639 --> 00:16:10,560
right block free

425
00:16:10,560 --> 00:16:12,959
data

426
00:16:13,120 --> 00:16:16,399
oh there's lots of spaces here

427
00:16:20,079 --> 00:16:21,680
all right cool

428
00:16:21,680 --> 00:16:24,160
so we now some set some blocks or otp

429
00:16:24,160 --> 00:16:26,480
bits

430
00:16:26,480 --> 00:16:30,160
or if you like looking for again

431
00:16:32,639 --> 00:16:34,399
you can definitely see here without p

432
00:16:34,399 --> 00:16:36,720
has been set so now we will show you

433
00:16:36,720 --> 00:16:39,120
that the bit flip goes one way not the

434
00:16:39,120 --> 00:16:41,600
other way

435
00:16:47,600 --> 00:16:50,600
okay

436
00:16:56,280 --> 00:16:58,240
[Music]

437
00:16:58,240 --> 00:17:00,079
we try to make and write will all

438
00:17:00,079 --> 00:17:02,160
seriously block three it says that the

439
00:17:02,160 --> 00:17:04,160
command executed but it wasn't

440
00:17:04,160 --> 00:17:06,640
successful in that sense and as you look

441
00:17:06,640 --> 00:17:08,880
at the output of mf info you see it is

442
00:17:08,880 --> 00:17:10,319
still the same values

443
00:17:10,319 --> 00:17:13,388
[Music]

444
00:17:16,880 --> 00:17:20,559
let's try and set some values

445
00:17:20,559 --> 00:17:21,520
again

446
00:17:21,520 --> 00:17:23,599
i go upper because i can

447
00:17:23,599 --> 00:17:27,039
easily don't have to retype things

448
00:17:27,039 --> 00:17:29,200
and as you see down here again you can

449
00:17:29,200 --> 00:17:32,080
set flip values up but you can't erase

450
00:17:32,080 --> 00:17:34,640
them alright so that's the setup

451
00:17:34,640 --> 00:17:37,280
something we can control but we can't

452
00:17:37,280 --> 00:17:40,240
control fully

453
00:17:43,120 --> 00:17:44,400
well

454
00:17:44,400 --> 00:17:47,600
change this crisis as well

455
00:17:50,480 --> 00:17:53,919
hf mfu

456
00:17:54,080 --> 00:17:56,960
for this particular attack

457
00:17:56,960 --> 00:17:59,360
we implemented a

458
00:17:59,360 --> 00:18:00,720
a command

459
00:18:00,720 --> 00:18:02,799
or an old

460
00:18:02,799 --> 00:18:05,200
implementary command so you will find it

461
00:18:05,200 --> 00:18:06,799
oops up there

462
00:18:06,799 --> 00:18:09,520
it says o2p here

463
00:18:09,520 --> 00:18:10,960
there

464
00:18:10,960 --> 00:18:15,760
and when you have it you can complete it

465
00:18:15,760 --> 00:18:18,080
okay

466
00:18:21,600 --> 00:18:23,918
oops

467
00:18:24,000 --> 00:18:25,520
oh sorry

468
00:18:25,520 --> 00:18:26,840
no

469
00:18:26,840 --> 00:18:30,799
problem will renew this

470
00:18:30,799 --> 00:18:32,320
this is how you call the commander we're

471
00:18:32,320 --> 00:18:33,600
not going to go into exactly all the

472
00:18:33,600 --> 00:18:37,199
details but you can manually set

473
00:18:37,679 --> 00:18:41,760
do information by 100s start at 100

474
00:18:41,760 --> 00:18:44,880
microseconds and at 2 500 microwaves and

475
00:18:44,880 --> 00:18:47,039
use the values one one two two three

476
00:18:47,039 --> 00:18:50,000
three four four

477
00:18:50,720 --> 00:18:53,919
we run an attack and you see

478
00:18:53,919 --> 00:18:55,760
that

479
00:18:55,760 --> 00:18:57,919
the tearing triggers and you see

480
00:18:57,919 --> 00:18:59,440
something happens and you see you

481
00:18:59,440 --> 00:19:00,960
remember how we present the slide where

482
00:19:00,960 --> 00:19:03,440
you saw the values happens not happen

483
00:19:03,440 --> 00:19:06,640
here is the raise to zeros

484
00:19:06,640 --> 00:19:08,559
we triggered after three four five

485
00:19:08,559 --> 00:19:12,400
hundred microseconds all the way down to

486
00:19:12,400 --> 00:19:15,360
2000 microseconds and then you see the

487
00:19:15,360 --> 00:19:18,000
new formally written

488
00:19:18,000 --> 00:19:20,000
otp values

489
00:19:20,000 --> 00:19:21,360
if you look at that

490
00:19:21,360 --> 00:19:23,039
that's cool that's interesting we can

491
00:19:23,039 --> 00:19:25,620
run hh mfu info again

492
00:19:25,620 --> 00:19:29,090
[Music]

493
00:19:29,360 --> 00:19:31,919
you see that the ff that we had here

494
00:19:31,919 --> 00:19:33,039
before

495
00:19:33,039 --> 00:19:35,520
has now been overwritten

496
00:19:35,520 --> 00:19:37,280
now that's fun

497
00:19:37,280 --> 00:19:41,200
but not really super fun

498
00:19:48,559 --> 00:19:51,039
just jumping

499
00:19:51,039 --> 00:19:52,720
yeah

500
00:19:52,720 --> 00:19:55,039
because it's ctrl shift

501
00:19:55,039 --> 00:19:57,120
not copy

502
00:19:57,120 --> 00:19:58,000
okay

503
00:19:58,000 --> 00:20:00,400
all right let's set it all

504
00:20:00,400 --> 00:20:01,200
to

505
00:20:01,200 --> 00:20:02,960
zeros and

506
00:20:02,960 --> 00:20:04,799
we say that we want to actually instead

507
00:20:04,799 --> 00:20:07,200
start to block target block three

508
00:20:07,200 --> 00:20:08,960
but we want the matching values to be

509
00:20:08,960 --> 00:20:10,240
zeros

510
00:20:10,240 --> 00:20:11,840
instead of trying to save a range

511
00:20:11,840 --> 00:20:12,350
everything

512
00:20:12,350 --> 00:20:14,080
[Music]

513
00:20:14,080 --> 00:20:15,840
and it goes quite fast because this is a

514
00:20:15,840 --> 00:20:18,640
really crappy implementation of our otp

515
00:20:18,640 --> 00:20:21,919
so actually two triggers and that's it

516
00:20:21,919 --> 00:20:24,960
vote b is reset

517
00:20:28,559 --> 00:20:30,880
and now you have a whole complete

518
00:20:30,880 --> 00:20:34,080
untouched otp now what is why is this

519
00:20:34,080 --> 00:20:35,679
interesting now this is interesting

520
00:20:35,679 --> 00:20:38,000
because my fair or microns

521
00:20:38,000 --> 00:20:40,799
was used in the subway of moscow

522
00:20:40,799 --> 00:20:43,120
meaning that you they flipped for each

523
00:20:43,120 --> 00:20:45,039
transport we did they flipped a bit

524
00:20:45,039 --> 00:20:47,120
saying that you had ten times nine times

525
00:20:47,120 --> 00:20:49,520
eight times but with this you could just

526
00:20:49,520 --> 00:20:50,640
go home

527
00:20:50,640 --> 00:20:52,880
in the end of the day do trips go home

528
00:20:52,880 --> 00:20:54,320
reset the thing and you have a brand new

529
00:20:54,320 --> 00:20:56,640
card working the next day

530
00:20:56,640 --> 00:21:00,120
time for plots

531
00:21:08,210 --> 00:21:13,359
[Music]

532
00:21:13,360 --> 00:21:16,880
okay that was the kind of textbook cases

533
00:21:16,880 --> 00:21:18,159
here

534
00:21:18,159 --> 00:21:20,480
where we just interrupt at any position

535
00:21:20,480 --> 00:21:23,600
over there but now we are interested to

536
00:21:23,600 --> 00:21:25,440
look more in detail

537
00:21:25,440 --> 00:21:28,400
what happens

538
00:21:28,799 --> 00:21:32,000
like oh

539
00:21:34,559 --> 00:21:36,799
somewhere on these values when it goes

540
00:21:36,799 --> 00:21:38,960
from f's to zeros and around these

541
00:21:38,960 --> 00:21:41,600
values when it goes from zero to f and

542
00:21:41,600 --> 00:21:43,520
we want to explore a little bit more in

543
00:21:43,520 --> 00:21:45,120
detail in these

544
00:21:45,120 --> 00:21:48,080
areas so we do just the same tearing but

545
00:21:48,080 --> 00:21:50,000
with other timings

546
00:21:50,000 --> 00:21:53,280
so and here if we zoom on that area

547
00:21:53,280 --> 00:21:56,080
between the 400 and the 600 we see that

548
00:21:56,080 --> 00:21:59,120
it's around 500 something

549
00:21:59,120 --> 00:22:02,240
we see progressive bit flips

550
00:22:02,240 --> 00:22:03,919
and there there are a few

551
00:22:03,919 --> 00:22:06,480
interesting things to see

552
00:22:06,480 --> 00:22:07,919
um first

553
00:22:07,919 --> 00:22:10,320
all events are independent because we

554
00:22:10,320 --> 00:22:13,520
always start from a fresh normal right

555
00:22:13,520 --> 00:22:15,440
that goes

556
00:22:15,440 --> 00:22:17,919
to ff normally before we do the second

557
00:22:17,919 --> 00:22:19,200
tearing

558
00:22:19,200 --> 00:22:21,919
and still we see that some bits are

559
00:22:21,919 --> 00:22:25,440
erased first almost all the time and

560
00:22:25,440 --> 00:22:27,440
some beasts are

561
00:22:27,440 --> 00:22:29,600
harder to to flip

562
00:22:29,600 --> 00:22:32,559
and are flipped last

563
00:22:32,559 --> 00:22:36,240
this is due to the manufacturing process

564
00:22:36,240 --> 00:22:38,480
to generate the transistors making the

565
00:22:38,480 --> 00:22:40,880
eeprom because there are some dope ends

566
00:22:40,880 --> 00:22:43,919
it's a gas and so locally you may have

567
00:22:43,919 --> 00:22:46,559
small differences between the transistor

568
00:22:46,559 --> 00:22:48,559
and the small differences

569
00:22:48,559 --> 00:22:50,559
uh will change a bit the physical

570
00:22:50,559 --> 00:22:53,200
transistor and the speed

571
00:22:53,200 --> 00:22:54,440
at which it will flip

572
00:22:54,440 --> 00:22:55,679
[Music]

573
00:22:55,679 --> 00:22:57,520
and it will be different for another

574
00:22:57,520 --> 00:22:58,880
card and it will be different for

575
00:22:58,880 --> 00:23:01,200
another memory of the card and you can

576
00:23:01,200 --> 00:23:03,360
even use it like to finger print

577
00:23:03,360 --> 00:23:05,919
physically a card if you want if some of

578
00:23:05,919 --> 00:23:08,720
you were use of sram physical and

579
00:23:08,720 --> 00:23:11,440
clinical function you can play

580
00:23:11,440 --> 00:23:15,520
kind of similar things with an eprom

581
00:23:16,240 --> 00:23:18,640
if we look at the right face from zero

582
00:23:18,640 --> 00:23:19,760
to f

583
00:23:19,760 --> 00:23:22,960
there is also an area there around

584
00:23:22,960 --> 00:23:25,600
some 300 something it's a bit quicker

585
00:23:25,600 --> 00:23:28,000
than the areas on that card but you see

586
00:23:28,000 --> 00:23:29,039
similar

587
00:23:29,039 --> 00:23:31,840
effect and similar bias between the

588
00:23:31,840 --> 00:23:34,559
different tanks

589
00:23:35,679 --> 00:23:38,320
so you may think

590
00:23:38,320 --> 00:23:40,080
that internally the eprom is like a

591
00:23:40,080 --> 00:23:43,120
little switch and if you tear off

592
00:23:43,120 --> 00:23:44,559
some have

593
00:23:44,559 --> 00:23:47,120
had time to flip and some didn't have

594
00:23:47,120 --> 00:23:49,919
time to flip at all

595
00:23:49,919 --> 00:23:52,480
physically it's not exactly correct and

596
00:23:52,480 --> 00:23:54,880
it's not good enough

597
00:23:54,880 --> 00:23:57,840
then to to think about

598
00:23:57,840 --> 00:24:00,159
smarter attack on that so for that i

599
00:24:00,159 --> 00:24:01,760
have to explain a bit how

600
00:24:01,760 --> 00:24:04,720
eeprom transistor works internally i

601
00:24:04,720 --> 00:24:07,360
won't go too much into the detail

602
00:24:07,360 --> 00:24:09,200
just

603
00:24:09,200 --> 00:24:12,000
uh remember that there is like here in

604
00:24:12,000 --> 00:24:13,919
red a floating gate

605
00:24:13,919 --> 00:24:16,480
which is like a conductive element

606
00:24:16,480 --> 00:24:20,720
which is trapped in some insulator

607
00:24:20,720 --> 00:24:24,000
so electrons can't move in and out

608
00:24:24,000 --> 00:24:27,120
still if you apply a large

609
00:24:27,120 --> 00:24:31,039
voltage bias between source and the gate

610
00:24:31,039 --> 00:24:33,520
you can drag electrons

611
00:24:33,520 --> 00:24:36,159
into the floating gate and out of the

612
00:24:36,159 --> 00:24:37,360
floating gate

613
00:24:37,360 --> 00:24:39,039
so you can charge electrons and

614
00:24:39,039 --> 00:24:40,720
discharge electrons

615
00:24:40,720 --> 00:24:42,960
and if you measure the physics of the

616
00:24:42,960 --> 00:24:45,120
transistor it will vary and that's how

617
00:24:45,120 --> 00:24:47,440
you can read a value stored in the

618
00:24:47,440 --> 00:24:49,919
eeprom

619
00:24:51,039 --> 00:24:53,360
so better analogy is

620
00:24:53,360 --> 00:24:55,679
to locate not as a switch but as an

621
00:24:55,679 --> 00:24:58,480
analog value that can go from zero to

622
00:24:58,480 --> 00:25:01,679
hundred percent and if you

623
00:25:01,679 --> 00:25:05,120
tear an erase

624
00:25:05,279 --> 00:25:06,880
a bit too soon

625
00:25:06,880 --> 00:25:09,120
you will empty a little bit each

626
00:25:09,120 --> 00:25:11,200
transistor and remember each transistor

627
00:25:11,200 --> 00:25:12,960
at its own rate

628
00:25:12,960 --> 00:25:14,400
so you get something like that if you

629
00:25:14,400 --> 00:25:16,640
read the value the readout will be

630
00:25:16,640 --> 00:25:18,159
something like uh

631
00:25:18,159 --> 00:25:20,480
look at the 50 percent threshold what

632
00:25:20,480 --> 00:25:22,320
happened and it looks like nothing

633
00:25:22,320 --> 00:25:24,320
happened and you still get ffs but

634
00:25:24,320 --> 00:25:27,200
internally the values decreased so if

635
00:25:27,200 --> 00:25:29,360
you go on then you will see the first

636
00:25:29,360 --> 00:25:32,240
bit flips and so

637
00:25:32,240 --> 00:25:34,720
so it's a very progressive thing analog

638
00:25:34,720 --> 00:25:36,640
things going on there that is

639
00:25:36,640 --> 00:25:40,640
discretized when you read it out

640
00:25:40,640 --> 00:25:42,799
and sometimes you can have even funny

641
00:25:42,799 --> 00:25:44,799
stuff happening like uh

642
00:25:44,799 --> 00:25:48,880
if i go on touch oh no sorry up on that

643
00:25:48,880 --> 00:25:49,450
one yeah

644
00:25:49,450 --> 00:25:51,440
[Music]

645
00:25:51,440 --> 00:25:52,559
um

646
00:25:52,559 --> 00:25:55,039
it's just a border and the readout

647
00:25:55,039 --> 00:25:57,440
has also some

648
00:25:57,440 --> 00:26:00,080
randomness in this physics

649
00:26:00,080 --> 00:26:03,279
so if you repeat several times sometimes

650
00:26:03,279 --> 00:26:05,039
you will read that

651
00:26:05,039 --> 00:26:08,840
weak bit as a one sometimes as a zero

652
00:26:08,840 --> 00:26:12,640
the eprom storage didn't change

653
00:26:12,640 --> 00:26:15,360
but the way it's readout may vary from

654
00:26:15,360 --> 00:26:18,320
time to time it may vary with different

655
00:26:18,320 --> 00:26:20,640
factors we will cover so that we can

656
00:26:20,640 --> 00:26:23,039
even control a little bit

657
00:26:23,039 --> 00:26:25,360
the way it will be read

658
00:26:25,360 --> 00:26:27,440
so if we take back our previous

659
00:26:27,440 --> 00:26:28,720
experiment

660
00:26:28,720 --> 00:26:31,279
and we don't reset to ff every time so

661
00:26:31,279 --> 00:26:32,320
no

662
00:26:32,320 --> 00:26:34,960
um i write only once ff and then i'll

663
00:26:34,960 --> 00:26:36,799
only do tailoring

664
00:26:36,799 --> 00:26:38,960
and i would choose a

665
00:26:38,960 --> 00:26:40,640
much

666
00:26:40,640 --> 00:26:42,480
quicker timings and look here the

667
00:26:42,480 --> 00:26:43,840
timings were at

668
00:26:43,840 --> 00:26:46,799
500 something now i do just the first

669
00:26:46,799 --> 00:26:49,200
tearing to be close to the middle but

670
00:26:49,200 --> 00:26:50,880
still some

671
00:26:50,880 --> 00:26:53,039
gap to meet and then i do very quick

672
00:26:53,039 --> 00:26:55,679
tear to always remove just a little bit

673
00:26:55,679 --> 00:26:58,400
of the electrons and like 20 times here

674
00:26:58,400 --> 00:27:00,880
nothing happened and then you start

675
00:27:00,880 --> 00:27:04,400
seeing the flipping bits so by that way

676
00:27:04,400 --> 00:27:08,000
we can control even more precisely

677
00:27:08,000 --> 00:27:09,360
um

678
00:27:09,360 --> 00:27:13,360
all the intermediate states of any race

679
00:27:13,360 --> 00:27:15,039
that makes sense

680
00:27:15,039 --> 00:27:16,559
does that make sense to you how the

681
00:27:16,559 --> 00:27:19,279
electrons goes out and slowly we can

682
00:27:19,279 --> 00:27:21,679
really see bit flips in the reading out

683
00:27:21,679 --> 00:27:23,279
of it okay

684
00:27:23,279 --> 00:27:25,440
good

685
00:27:25,840 --> 00:27:28,399
um so now we've already a few techniques

686
00:27:28,399 --> 00:27:30,240
to to control

687
00:27:30,240 --> 00:27:33,200
uh what's going on when an eeprom

688
00:27:33,200 --> 00:27:36,080
operation eraser or right occurs

689
00:27:36,080 --> 00:27:38,399
and we saw that we can just tear between

690
00:27:38,399 --> 00:27:39,840
the operation

691
00:27:39,840 --> 00:27:41,200
easy

692
00:27:41,200 --> 00:27:43,679
we can tear during the eraser during the

693
00:27:43,679 --> 00:27:46,000
write operation and we saw that there is

694
00:27:46,000 --> 00:27:48,080
some statical bias between the different

695
00:27:48,080 --> 00:27:49,600
bits

696
00:27:49,600 --> 00:27:51,760
we can use it even for finger printing

697
00:27:51,760 --> 00:27:52,880
as i said

698
00:27:52,880 --> 00:27:55,200
and we saw this progressive tearing to

699
00:27:55,200 --> 00:27:59,360
get even finer control on it

700
00:28:01,200 --> 00:28:03,120
we have to also

701
00:28:03,120 --> 00:28:04,559
watch for some

702
00:28:04,559 --> 00:28:07,279
effects that you necessarily don't want

703
00:28:07,279 --> 00:28:10,320
uh the timing that you're choosing may

704
00:28:10,320 --> 00:28:12,080
vary with different factors that you

705
00:28:12,080 --> 00:28:13,760
have to take into account

706
00:28:13,760 --> 00:28:15,279
the distance to the reader if you're

707
00:28:15,279 --> 00:28:17,440
further away you need a bit longer time

708
00:28:17,440 --> 00:28:18,399
because

709
00:28:18,399 --> 00:28:21,120
the card doesn't get as much power we

710
00:28:21,120 --> 00:28:23,120
saw even the temperature can affect the

711
00:28:23,120 --> 00:28:24,480
timings

712
00:28:24,480 --> 00:28:26,320
and also the the the content to be

713
00:28:26,320 --> 00:28:28,480
erased if they are all flip the bits to

714
00:28:28,480 --> 00:28:30,559
once and you want to erase them it takes

715
00:28:30,559 --> 00:28:32,320
a little bit more time than if there is

716
00:28:32,320 --> 00:28:36,720
a single bit to to drag

717
00:28:37,120 --> 00:28:39,520
we can also have some control on the

718
00:28:39,520 --> 00:28:43,279
read face when there is a weak bit

719
00:28:43,279 --> 00:28:46,080
um again the distance can play if we are

720
00:28:46,080 --> 00:28:47,679
close to the reader

721
00:28:47,679 --> 00:28:51,600
um we may like see more one on this week

722
00:28:51,600 --> 00:28:54,080
big and when we put the card a bit away

723
00:28:54,080 --> 00:28:55,760
then there is more chance that it will

724
00:28:55,760 --> 00:28:57,600
be read as a zero

725
00:28:57,600 --> 00:28:59,120
again because the character gets the

726
00:28:59,120 --> 00:29:02,240
less power and the comparator entirely

727
00:29:02,240 --> 00:29:03,919
will have for the readout will have a

728
00:29:03,919 --> 00:29:06,559
different level

729
00:29:06,559 --> 00:29:09,039
another effect is the time since pouring

730
00:29:09,039 --> 00:29:10,000
again

731
00:29:10,000 --> 00:29:12,720
it's the same logic behind

732
00:29:12,720 --> 00:29:14,320
if you pour the card and read

733
00:29:14,320 --> 00:29:16,559
immediately you have more chance to see

734
00:29:16,559 --> 00:29:18,399
the zero than the one

735
00:29:18,399 --> 00:29:20,559
and if you give more time for the power

736
00:29:20,559 --> 00:29:21,760
to settle

737
00:29:21,760 --> 00:29:23,840
then the card is also more power and

738
00:29:23,840 --> 00:29:26,960
more chance to read the one at the weak

739
00:29:26,960 --> 00:29:29,360
bit position and you can control both of

740
00:29:29,360 --> 00:29:32,000
course if you want to see more of zero

741
00:29:32,000 --> 00:29:34,320
go far away read fast if you want to see

742
00:29:34,320 --> 00:29:38,159
a one come close and read a bit later

743
00:29:38,159 --> 00:29:40,320
once the por is set settled

744
00:29:40,320 --> 00:29:43,120
so we will go uh very quickly on second

745
00:29:43,120 --> 00:29:44,559
example because

746
00:29:44,559 --> 00:29:46,799
i think that's mine

747
00:29:46,799 --> 00:29:49,200
huh no that's mine okay

748
00:29:49,200 --> 00:29:54,279
go you go to the em i go to c5 okay

749
00:29:54,880 --> 00:29:56,000
so the

750
00:29:56,000 --> 00:29:57,919
t5577

751
00:29:57,919 --> 00:30:00,399
it's like a generic lf card that can

752
00:30:00,399 --> 00:30:01,919
emulate many

753
00:30:01,919 --> 00:30:04,880
uh stupid lf cards which are just an id

754
00:30:04,880 --> 00:30:06,240
and and no

755
00:30:06,240 --> 00:30:10,159
no smart crypto or whatever and it has a

756
00:30:10,159 --> 00:30:12,399
security feature which is a

757
00:30:12,399 --> 00:30:15,039
a password you can lock the card and you

758
00:30:15,039 --> 00:30:16,720
have to know the password to be able to

759
00:30:16,720 --> 00:30:19,120
communicate with the cards

760
00:30:19,120 --> 00:30:21,360
um so internally it's also just a memory

761
00:30:21,360 --> 00:30:22,799
so one slot

762
00:30:22,799 --> 00:30:23,600
is

763
00:30:23,600 --> 00:30:25,520
for storing the password

764
00:30:25,520 --> 00:30:28,000
and one slot is the configuration and in

765
00:30:28,000 --> 00:30:29,919
that configuration block actually there

766
00:30:29,919 --> 00:30:31,600
is one single bit

767
00:30:31,600 --> 00:30:33,440
you can point to that

768
00:30:33,440 --> 00:30:35,600
that says if the password protection is

769
00:30:35,600 --> 00:30:37,520
enabled or not

770
00:30:37,520 --> 00:30:40,159
and funny thing of the on that tag

771
00:30:40,159 --> 00:30:43,120
is that there is also a test mode

772
00:30:43,120 --> 00:30:44,480
which is still available even in

773
00:30:44,480 --> 00:30:46,640
production test mode is not only for

774
00:30:46,640 --> 00:30:48,640
manufacturers to check quickly the

775
00:30:48,640 --> 00:30:50,960
prompt that and i can flip all the

776
00:30:50,960 --> 00:30:53,600
problem bits on ones and zeros to to

777
00:30:53,600 --> 00:30:55,679
check that everything is working fine so

778
00:30:55,679 --> 00:30:57,600
we can use that test mode even if the

779
00:30:57,600 --> 00:31:00,080
card is locked with a password but okay

780
00:31:00,080 --> 00:31:02,480
that's what erase the world pack

781
00:31:02,480 --> 00:31:05,200
so what to do with that well actually uh

782
00:31:05,200 --> 00:31:06,640
we can tear

783
00:31:06,640 --> 00:31:09,519
the test mode with a progressive tearing

784
00:31:09,519 --> 00:31:11,760
very slowly just to get a few bit flips

785
00:31:11,760 --> 00:31:14,000
here and there and we do that until we

786
00:31:14,000 --> 00:31:18,480
manage to flip the the password bit uh

787
00:31:18,480 --> 00:31:20,960
in the configuration block

788
00:31:20,960 --> 00:31:23,120
once it's done we can

789
00:31:23,120 --> 00:31:25,360
do whatever we want we can write again a

790
00:31:25,360 --> 00:31:27,840
configuration block to set the card in

791
00:31:27,840 --> 00:31:29,919
the proper state that we can understand

792
00:31:29,919 --> 00:31:32,480
and we can read out the password

793
00:31:32,480 --> 00:31:33,760
memory block

794
00:31:33,760 --> 00:31:35,679
some bit flip occurred it's not the real

795
00:31:35,679 --> 00:31:37,919
password but at least you get already

796
00:31:37,919 --> 00:31:40,080
some information all the ones you see in

797
00:31:40,080 --> 00:31:41,840
the password that are bit that didn't

798
00:31:41,840 --> 00:31:43,840
flip yet and you know that the real

799
00:31:43,840 --> 00:31:45,679
password content also once at these

800
00:31:45,679 --> 00:31:47,679
positions and that cap doesn't have a

801
00:31:47,679 --> 00:31:50,320
uid so that means on the system all the

802
00:31:50,320 --> 00:31:52,080
cards will share the same password so

803
00:31:52,080 --> 00:31:54,159
you kind of destroy a tag discover

804
00:31:54,159 --> 00:31:56,000
partially password take another tag

805
00:31:56,000 --> 00:31:57,600
attack it also

806
00:31:57,600 --> 00:31:59,039
get some information again on the

807
00:31:59,039 --> 00:32:01,760
password do a logical or between the

808
00:32:01,760 --> 00:32:04,480
result and at the end you will

809
00:32:04,480 --> 00:32:05,840
break the password i have the full

810
00:32:05,840 --> 00:32:08,720
password or good enough to to finish it

811
00:32:08,720 --> 00:32:11,039
with some brute force behind

812
00:32:11,039 --> 00:32:12,799
so that's the first

813
00:32:12,799 --> 00:32:16,159
attack that's all what i said there and

814
00:32:16,159 --> 00:32:18,880
another example that we'll be demote is

815
00:32:18,880 --> 00:32:19,480
the

816
00:32:19,480 --> 00:32:24,399
m4305 am 400 burgle electromarine

817
00:32:24,399 --> 00:32:26,640
another simple did you understand about

818
00:32:26,640 --> 00:32:29,440
that t557

819
00:32:29,440 --> 00:32:30,559
was

820
00:32:30,559 --> 00:32:31,679
talking about did you understand the

821
00:32:31,679 --> 00:32:34,399
concept of it how to we erase parts of

822
00:32:34,399 --> 00:32:36,720
the memory we realize that flip one bits

823
00:32:36,720 --> 00:32:38,240
and then we can extract information

824
00:32:38,240 --> 00:32:40,159
about it by looking at other tags later

825
00:32:40,159 --> 00:32:40,880
on

826
00:32:40,880 --> 00:32:43,200
did that make sense to you perfect i see

827
00:32:43,200 --> 00:32:45,039
nodding heads you're a very attentive

828
00:32:45,039 --> 00:32:47,360
crowd i'm very happy

829
00:32:47,360 --> 00:32:49,360
when it comes to another lf tags i don't

830
00:32:49,360 --> 00:32:51,440
know why we choose lf tags because we're

831
00:32:51,440 --> 00:32:53,120
so damn simple i guess

832
00:32:53,120 --> 00:32:55,279
it's no cryptos and stuffing

833
00:32:55,279 --> 00:32:57,200
yeah so we did that with it turned out

834
00:32:57,200 --> 00:32:59,120
that we got very excited about this

835
00:32:59,120 --> 00:33:02,399
steering or tearing and

836
00:33:02,399 --> 00:33:04,080
we're like let's see this is an

837
00:33:04,080 --> 00:33:06,080
anonymous tag again it's usually used

838
00:33:06,080 --> 00:33:08,640
for hid prox cards the isoprops two

839
00:33:08,640 --> 00:33:10,799
cards is based on these ones here they

840
00:33:10,799 --> 00:33:12,559
have a password

841
00:33:12,559 --> 00:33:15,600
that makes interesting sense but we know

842
00:33:15,600 --> 00:33:18,550
that they have a read-only uid

843
00:33:18,550 --> 00:33:21,360
[Music]

844
00:33:21,360 --> 00:33:25,720
and if you look at an em45

845
00:33:25,720 --> 00:33:29,519
e4305 tag the memory looks like from 0

846
00:33:29,519 --> 00:33:32,880
to 15 16 blocks off for 2 bits of values

847
00:33:32,880 --> 00:33:34,480
the interesting part here is that you

848
00:33:34,480 --> 00:33:37,519
have a lock bits that's vuid

849
00:33:37,519 --> 00:33:40,159
and you have two lock

850
00:33:40,159 --> 00:33:41,240
words down there

851
00:33:41,240 --> 00:33:42,720
[Music]

852
00:33:42,720 --> 00:33:45,679
now these words down here

853
00:33:45,679 --> 00:33:47,679
are called protection or lock

854
00:33:47,679 --> 00:33:49,440
suppression words

855
00:33:49,440 --> 00:33:51,039
protection words

856
00:33:51,039 --> 00:33:52,799
and it

857
00:33:52,799 --> 00:33:54,320
is actually

858
00:33:54,320 --> 00:33:55,519
very interesting because you see this

859
00:33:55,519 --> 00:33:58,320
eighth and this two so one

860
00:33:58,320 --> 00:34:00,720
bits here this 16 bits here

861
00:34:00,720 --> 00:34:02,480
denotes which

862
00:34:02,480 --> 00:34:06,559
block up here is locked

863
00:34:06,559 --> 00:34:08,800
did that make sense

864
00:34:08,800 --> 00:34:12,879
i don't know sounded better in my head

865
00:34:12,879 --> 00:34:14,000
so

866
00:34:14,000 --> 00:34:16,879
writing log configuration blocks

867
00:34:16,879 --> 00:34:20,480
uh yeah so the bitmaps of

868
00:34:20,480 --> 00:34:23,359
the world we're looking at

869
00:34:23,359 --> 00:34:26,159
it acts kaya it's kind of like an o2p

870
00:34:26,159 --> 00:34:27,918
because you can't clear it once you

871
00:34:27,918 --> 00:34:30,639
locked it it's permalocked

872
00:34:30,639 --> 00:34:32,639
interesting

873
00:34:32,639 --> 00:34:36,399
and the last bit indicates

874
00:34:36,399 --> 00:34:38,079
which one is active so it has two of

875
00:34:38,079 --> 00:34:40,800
these ones here 14 15 but eight means

876
00:34:40,800 --> 00:34:43,199
that this one is active

877
00:34:43,199 --> 00:34:46,678
keep that in mind

878
00:34:48,000 --> 00:34:48,960
you go

879
00:34:48,960 --> 00:34:51,119
so

880
00:34:51,119 --> 00:34:52,879
when we write these once we have to send

881
00:34:52,879 --> 00:34:54,800
a command called protect

882
00:34:54,800 --> 00:34:57,040
so if you want to write and lock the

883
00:34:57,040 --> 00:34:59,040
first word

884
00:34:59,040 --> 00:35:00,960
at index 1

885
00:35:00,960 --> 00:35:02,880
we send this

886
00:35:02,880 --> 00:35:03,680
the

887
00:35:03,680 --> 00:35:04,880
reader

888
00:35:04,880 --> 00:35:06,480
sends a glance and the card goes like

889
00:35:06,480 --> 00:35:10,320
huh okay this is vector once looks at it

890
00:35:10,320 --> 00:35:14,240
it adds the origin the value one to it

891
00:35:14,240 --> 00:35:16,720
and it flips over eight and it erases

892
00:35:16,720 --> 00:35:18,960
ward 14.

893
00:35:18,960 --> 00:35:21,920
so it flips between those two states

894
00:35:21,920 --> 00:35:23,680
so

895
00:35:23,680 --> 00:35:26,240
this is the process like it's more

896
00:35:26,240 --> 00:35:28,560
visualizing to see it then otherwise we

897
00:35:28,560 --> 00:35:30,400
were guessing on another p on the

898
00:35:30,400 --> 00:35:33,119
ultralight tank so you can more see how

899
00:35:33,119 --> 00:35:34,000
it works

900
00:35:34,000 --> 00:35:37,040
[Music]

901
00:35:37,040 --> 00:35:39,440
okay funny thing is of course this is

902
00:35:39,440 --> 00:35:42,320
there to according to own data sheets to

903
00:35:42,320 --> 00:35:45,040
protect things like unwanted bit flips

904
00:35:45,040 --> 00:35:50,240
to zero i.e there i have anti-tiering

905
00:35:50,240 --> 00:35:52,400
counter measures or measurements

906
00:35:52,400 --> 00:35:55,119
which is even more interesting because

907
00:35:55,119 --> 00:35:57,440
now we thought it was fun

908
00:35:57,440 --> 00:36:00,720
what can we do with this

909
00:36:02,800 --> 00:36:05,359
how about we launch an interrupt a

910
00:36:05,359 --> 00:36:07,839
protect command

911
00:36:07,839 --> 00:36:11,760
and ideas can we make sure

912
00:36:11,760 --> 00:36:13,599
by flipping that

913
00:36:13,599 --> 00:36:15,119
second bit

914
00:36:15,119 --> 00:36:17,119
to enable things force

915
00:36:17,119 --> 00:36:18,800
how we're going to do that remember

916
00:36:18,800 --> 00:36:20,640
we're talking about the

917
00:36:20,640 --> 00:36:22,320
um

918
00:36:22,320 --> 00:36:25,119
progressive flipping of bits it all

919
00:36:25,119 --> 00:36:26,480
comes to mind right now

920
00:36:26,480 --> 00:36:29,789
[Music]

921
00:36:30,240 --> 00:36:32,800
if you flip if you do that one both

922
00:36:32,800 --> 00:36:35,280
practical words protection words becomes

923
00:36:35,280 --> 00:36:36,160
active

924
00:36:36,160 --> 00:36:39,040
but one has always priority it's also

925
00:36:39,040 --> 00:36:41,359
good to know for us when we do that

926
00:36:41,359 --> 00:36:42,800
which one we do because we need to know

927
00:36:42,800 --> 00:36:45,040
where to start from

928
00:36:45,040 --> 00:36:47,359
and yeah that's something you can easily

929
00:36:47,359 --> 00:36:50,400
test and you like lock a word and then

930
00:36:50,400 --> 00:36:52,720
check if it's locked or not no you know

931
00:36:52,720 --> 00:36:55,760
if it's number 14 on number 15 which

932
00:36:55,760 --> 00:36:57,680
takes priority yeah and the answer is

933
00:36:57,680 --> 00:37:01,280
that it's 15. yeah yeah so that's it the

934
00:37:01,280 --> 00:37:03,040
whole thing goes and then in a very

935
00:37:03,040 --> 00:37:04,800
interesting loop

936
00:37:04,800 --> 00:37:07,280
where we adjust the timings and deal

937
00:37:07,280 --> 00:37:09,200
with the kind of odd things where were

938
00:37:09,200 --> 00:37:10,880
weak bits were described before some

939
00:37:10,880 --> 00:37:12,800
flips but we don't want to have flipped

940
00:37:12,800 --> 00:37:14,320
and then we restart from a stable

941
00:37:14,320 --> 00:37:16,240
situation if we fail

942
00:37:16,240 --> 00:37:18,720
so we write a normal right so we make

943
00:37:18,720 --> 00:37:19,760
their

944
00:37:19,760 --> 00:37:24,240
protection word 14 in a proper state

945
00:37:25,520 --> 00:37:27,520
so this one here is ultimately actually

946
00:37:27,520 --> 00:37:28,880
implemented as an automatic attack as

947
00:37:28,880 --> 00:37:30,560
well it takes about

948
00:37:30,560 --> 00:37:33,119
five seconds to several minutes

949
00:37:33,119 --> 00:37:35,680
but we have about a success rate around

950
00:37:35,680 --> 00:37:39,440
85 percent it's not 50 because

951
00:37:39,440 --> 00:37:42,640
of the bias in the flipping of weak bits

952
00:37:42,640 --> 00:37:44,079
so that's why i have a little bit more

953
00:37:44,079 --> 00:37:45,920
success rate for it and we shall

954
00:37:45,920 --> 00:37:50,280
actually just demonstrate right now

955
00:37:51,599 --> 00:37:53,359
oops

956
00:37:53,359 --> 00:37:55,759
click

957
00:37:56,320 --> 00:37:59,359
i have a password or not

958
00:37:59,359 --> 00:38:01,680
no not that one and this one full tear

959
00:38:01,680 --> 00:38:04,640
off yeah

960
00:38:04,640 --> 00:38:06,079
yeah if you

961
00:38:06,079 --> 00:38:07,839
if you want to see it it's uh if you can

962
00:38:07,839 --> 00:38:11,280
see it uh let's use hid

963
00:38:11,280 --> 00:38:12,079
yeah

964
00:38:12,079 --> 00:38:14,800
actually isoprops two cards

965
00:38:14,800 --> 00:38:17,359
kind of popular in the states

966
00:38:17,359 --> 00:38:19,130
don't think they're that popular here

967
00:38:19,130 --> 00:38:22,400
[Music]

968
00:38:22,400 --> 00:38:25,040
or have you seen those in europe much

969
00:38:25,040 --> 00:38:26,480
yeah okay

970
00:38:26,480 --> 00:38:30,440
adam not so that's why

971
00:38:34,560 --> 00:38:35,920
okay

972
00:38:35,920 --> 00:38:37,680
boom let's see

973
00:38:37,680 --> 00:38:39,200
let's see

974
00:38:39,200 --> 00:38:42,799
i feel like a musician like this

975
00:38:43,119 --> 00:38:47,359
all right good well let's go into lf em

976
00:38:47,359 --> 00:38:50,400
and it's 4x05 let's see what commands we

977
00:38:50,400 --> 00:38:52,720
have here i will do this again damn it

978
00:38:52,720 --> 00:38:54,240
doesn't work for me

979
00:38:54,240 --> 00:38:57,118
so um

980
00:38:58,880 --> 00:39:01,280
there is a command called unlock

981
00:39:01,280 --> 00:39:03,680
but first we want to look at the command

982
00:39:03,680 --> 00:39:07,520
on the data on it so we will make a dump

983
00:39:07,520 --> 00:39:10,880
let's see if it works on the tag

984
00:39:10,880 --> 00:39:13,200
all right

985
00:39:13,200 --> 00:39:16,720
you see the uid lock bit is set

986
00:39:16,720 --> 00:39:18,640
you see the 2 is there and this is the

987
00:39:18,640 --> 00:39:21,200
active slot 14. great

988
00:39:21,200 --> 00:39:23,839
let's go for

989
00:39:23,839 --> 00:39:26,320
the unlock

990
00:39:30,079 --> 00:39:33,359
uh if you want to see oops

991
00:39:34,560 --> 00:39:37,119
and send positive energy so that's it

992
00:39:37,119 --> 00:39:41,040
i'm sure it works yeah just unlock it

993
00:39:41,040 --> 00:39:43,839
chill winston

994
00:39:45,920 --> 00:39:46,960
all right

995
00:39:46,960 --> 00:39:49,440
here's the timings loops we were talking

996
00:39:49,440 --> 00:39:51,599
about it is adjusted to rough it should

997
00:39:51,599 --> 00:39:54,500
converge around 46 to run here we go

998
00:39:54,500 --> 00:39:57,869
[Music]

999
00:40:00,400 --> 00:40:03,200
triggering triggering

1000
00:40:03,200 --> 00:40:04,319
too late

1001
00:40:04,319 --> 00:40:07,119
too soon all right go up and down i

1002
00:40:07,119 --> 00:40:09,839
forgot but it's better if we put the tag

1003
00:40:09,839 --> 00:40:11,920
a bit further away here i'm not sure it

1004
00:40:11,920 --> 00:40:12,720
will

1005
00:40:12,720 --> 00:40:15,119
get it can stop and then we start over

1006
00:40:15,119 --> 00:40:17,200
from further away

1007
00:40:17,200 --> 00:40:18,720
let's do it

1008
00:40:18,720 --> 00:40:22,079
should be faster i'm sorry about that

1009
00:40:22,079 --> 00:40:24,880
is that better well that's right

1010
00:40:24,880 --> 00:40:27,920
okay let's go

1011
00:40:28,160 --> 00:40:30,640
four thousand demon guards come on give

1012
00:40:30,640 --> 00:40:33,879
it to us

1013
00:40:46,240 --> 00:40:48,000
i think you're too much far away that's

1014
00:40:48,000 --> 00:40:51,000
fine

1015
00:40:53,280 --> 00:40:55,520
the demon gods are not happy we should

1016
00:40:55,520 --> 00:40:57,680
have

1017
00:40:57,760 --> 00:41:02,760
you know no kittens today i'm so sorry

1018
00:41:12,480 --> 00:41:14,880
everybody's just blindly looking here

1019
00:41:14,880 --> 00:41:16,640
you see some results

1020
00:41:16,640 --> 00:41:17,680
so

1021
00:41:17,680 --> 00:41:19,599
there are some bit flips but not the

1022
00:41:19,599 --> 00:41:22,160
right bit it's the eight was flipped i

1023
00:41:22,160 --> 00:41:25,839
know it worked okay okay good success

1024
00:41:25,839 --> 00:41:28,078
so

1025
00:41:30,560 --> 00:41:32,319
if we dump the card again you will

1026
00:41:32,319 --> 00:41:35,520
notice that this little baby is gone

1027
00:41:35,520 --> 00:41:38,560
and it's still active and has 800 or 8

1028
00:41:38,560 --> 00:41:39,839
000 there

1029
00:41:39,839 --> 00:41:43,440
meaning that now from a read-only uid

1030
00:41:43,440 --> 00:41:46,319
card we have now

1031
00:41:46,319 --> 00:41:47,599
a

1032
00:41:47,599 --> 00:41:50,079
uid

1033
00:41:50,079 --> 00:41:54,319
changeable card a universal lfem4305

1034
00:41:54,319 --> 00:41:57,200
now you can upload

1035
00:41:58,160 --> 00:42:00,720
so by buying the official real stuff you

1036
00:42:00,720 --> 00:42:02,960
can make your own magic changeable ui

1037
00:42:02,960 --> 00:42:05,520
channel tag it's kind of awesome if you

1038
00:42:05,520 --> 00:42:09,599
like rfid nerds like me and philip

1039
00:42:12,960 --> 00:42:14,960
yep all right

1040
00:42:14,960 --> 00:42:16,880
so we did this demonstrate some of his

1041
00:42:16,880 --> 00:42:18,960
automated attacks of it but we were not

1042
00:42:18,960 --> 00:42:21,040
happy with that because

1043
00:42:21,040 --> 00:42:23,599
it's interesting but in the rfid field

1044
00:42:23,599 --> 00:42:24,800
there's loads of different card

1045
00:42:24,800 --> 00:42:26,880
technologies so if he was thinking a

1046
00:42:26,880 --> 00:42:28,960
little bit about it then and philip came

1047
00:42:28,960 --> 00:42:31,520
up with idea how about we make a generic

1048
00:42:31,520 --> 00:42:34,560
command instead so we can try instead of

1049
00:42:34,560 --> 00:42:36,960
writing your own in automated attacks

1050
00:42:36,960 --> 00:42:38,640
which is kind of hard for for the

1051
00:42:38,640 --> 00:42:40,720
average person but

1052
00:42:40,720 --> 00:42:42,880
we make one simple when we implement it

1053
00:42:42,880 --> 00:42:44,319
for hooks in several different

1054
00:42:44,319 --> 00:42:47,319
technologies like the 14a 14b

1055
00:42:47,319 --> 00:42:50,720
15693s and i-class and we combine it so

1056
00:42:50,720 --> 00:42:53,280
we can do something called hv tier off

1057
00:42:53,280 --> 00:42:56,480
hv tier off is a hook that we hook up

1058
00:42:56,480 --> 00:42:57,599
when we say

1059
00:42:57,599 --> 00:43:00,560
trigger at this point when i run this

1060
00:43:00,560 --> 00:43:02,480
command afterwards so we trigger this

1061
00:43:02,480 --> 00:43:04,240
one first enable it and then next time

1062
00:43:04,240 --> 00:43:06,240
we write that one this will happen it

1063
00:43:06,240 --> 00:43:07,839
will trigger at a certain point very

1064
00:43:07,839 --> 00:43:09,839
simple to run and do

1065
00:43:09,839 --> 00:43:11,520
and

1066
00:43:11,520 --> 00:43:13,599
yeah yeah we'll just

1067
00:43:13,599 --> 00:43:15,119
if you don't want to you know if you

1068
00:43:15,119 --> 00:43:16,800
want to add your own commands for other

1069
00:43:16,800 --> 00:43:18,560
card tech support it's kind of easy to

1070
00:43:18,560 --> 00:43:20,190
do it's all open source so

1071
00:43:20,190 --> 00:43:21,680
[Music]

1072
00:43:21,680 --> 00:43:23,119
yeah i will skip this one i think

1073
00:43:23,119 --> 00:43:25,040
because it's already what time do we

1074
00:43:25,040 --> 00:43:27,280
have

1075
00:43:27,280 --> 00:43:28,480
oh

1076
00:43:28,480 --> 00:43:31,200
okay we skipped this one

1077
00:43:31,200 --> 00:43:32,800
oh

1078
00:43:32,800 --> 00:43:35,680
 this is it

1079
00:43:36,000 --> 00:43:37,119
okay

1080
00:43:37,119 --> 00:43:39,200
i go also pretty quickly on that one

1081
00:43:39,200 --> 00:43:41,520
just for you to to get the principle of

1082
00:43:41,520 --> 00:43:43,520
the attack behind so we looked on the my

1083
00:43:43,520 --> 00:43:46,640
fire try tv one which is the

1084
00:43:46,640 --> 00:43:48,640
up to that uh my favorite ride you can

1085
00:43:48,640 --> 00:43:51,040
find on the market today so many

1086
00:43:51,040 --> 00:43:53,280
security features one of them is mono

1087
00:43:53,280 --> 00:43:55,040
encounter which means you can always

1088
00:43:55,040 --> 00:43:57,040
increase the contour but you cannot you

1089
00:43:57,040 --> 00:43:59,520
can never re decrease it or even reset

1090
00:43:59,520 --> 00:44:02,560
it to zero

1091
00:44:06,000 --> 00:44:08,319
so there are three mountain counters and

1092
00:44:08,319 --> 00:44:09,920
you have some commands to play with

1093
00:44:09,920 --> 00:44:11,760
command to increment the counter and

1094
00:44:11,760 --> 00:44:14,480
command to reout and a special command

1095
00:44:14,480 --> 00:44:16,160
to check if there was a tearing event

1096
00:44:16,160 --> 00:44:17,280
because actually there are several

1097
00:44:17,280 --> 00:44:19,340
protections again tearing

1098
00:44:19,340 --> 00:44:21,040
[Music]

1099
00:44:21,040 --> 00:44:22,800
internally that's something we found out

1100
00:44:22,800 --> 00:44:25,440
by all our experiments um actually you

1101
00:44:25,440 --> 00:44:27,520
have two different slots behind one

1102
00:44:27,520 --> 00:44:30,640
single counter a bit like for the em4305

1103
00:44:30,640 --> 00:44:32,640
except that you don't see the slots

1104
00:44:32,640 --> 00:44:35,680
yourself it's just that the car decides

1105
00:44:35,680 --> 00:44:36,400
which

1106
00:44:36,400 --> 00:44:38,800
slot to show you when you want to reload

1107
00:44:38,800 --> 00:44:40,720
the the the result

1108
00:44:40,720 --> 00:44:44,000
and you've also validity flag on the em

1109
00:44:44,000 --> 00:44:46,480
it was one single bit and eight here

1110
00:44:46,480 --> 00:44:48,720
it's a full byte and the full byte has

1111
00:44:48,720 --> 00:44:51,040
to have a very specific value with zerix

1112
00:44:51,040 --> 00:44:54,560
bd to know that there was no tearing

1113
00:44:54,560 --> 00:44:56,720
occur if you tear

1114
00:44:56,720 --> 00:44:59,119
the bdd isn't

1115
00:44:59,119 --> 00:45:01,839
wasn't written properly and you can

1116
00:45:01,839 --> 00:45:05,520
detect that there was a tearing event

1117
00:45:05,520 --> 00:45:08,640
in case of properties of both are valid

1118
00:45:08,640 --> 00:45:10,560
then the

1119
00:45:10,560 --> 00:45:12,720
the card will compute which

1120
00:45:12,720 --> 00:45:14,880
counter is the highest value and it will

1121
00:45:14,880 --> 00:45:17,359
return that one so

1122
00:45:17,359 --> 00:45:20,000
just be safe

1123
00:45:20,000 --> 00:45:20,800
so

1124
00:45:20,800 --> 00:45:21,839
we have

1125
00:45:21,839 --> 00:45:24,400
but yeah i try to spear but uh if you

1126
00:45:24,400 --> 00:45:27,040
think what i'm saying

1127
00:45:27,040 --> 00:45:29,200
it's not me so there are some examples

1128
00:45:29,200 --> 00:45:31,839
here when you get to like one two three

1129
00:45:31,839 --> 00:45:34,160
plus one in normal condition you get a

1130
00:45:34,160 --> 00:45:36,800
one two one two four if you can point at

1131
00:45:36,800 --> 00:45:38,960
the same time speak it's easier

1132
00:45:38,960 --> 00:45:41,280
and if you want to check the tearing you

1133
00:45:41,280 --> 00:45:43,520
get the the bite of the other slots

1134
00:45:43,520 --> 00:45:44,960
because if you interrupt something

1135
00:45:44,960 --> 00:45:46,640
that's when you were preparing the other

1136
00:45:46,640 --> 00:45:47,520
slot

1137
00:45:47,520 --> 00:45:49,280
if you interrupt this one two three plus

1138
00:45:49,280 --> 00:45:51,440
one what happens is that you get a

1139
00:45:51,440 --> 00:45:53,119
corruption in the

1140
00:45:53,119 --> 00:45:54,640
tearing flag

1141
00:45:54,640 --> 00:45:57,040
and it will send you back the other

1142
00:45:57,040 --> 00:45:58,960
counter which is

1143
00:45:58,960 --> 00:46:02,480
which was not affected by the tearing

1144
00:46:02,480 --> 00:46:04,880
so to attack it we need always to get

1145
00:46:04,880 --> 00:46:07,520
this valid flag so we we tried first to

1146
00:46:07,520 --> 00:46:08,800
do tearing

1147
00:46:08,800 --> 00:46:10,880
at very end of the right to make sure

1148
00:46:10,880 --> 00:46:13,040
that at least the flag was written

1149
00:46:13,040 --> 00:46:15,359
properly and we played with that and at

1150
00:46:15,359 --> 00:46:17,200
some point we managed to get

1151
00:46:17,200 --> 00:46:20,880
an old counter value not the fresh one

1152
00:46:20,880 --> 00:46:24,160
so internally what it means is that very

1153
00:46:24,160 --> 00:46:27,520
probably a bit flip occur

1154
00:46:27,520 --> 00:46:28,800
here

1155
00:46:28,800 --> 00:46:30,480
somewhere in the counter

1156
00:46:30,480 --> 00:46:31,440
so

1157
00:46:31,440 --> 00:46:34,160
the valid flex are correct on both so

1158
00:46:34,160 --> 00:46:36,880
for the cards both slots are correct and

1159
00:46:36,880 --> 00:46:39,040
when it looks which one to show you it

1160
00:46:39,040 --> 00:46:40,880
sees that this one is

1161
00:46:40,880 --> 00:46:43,359
smaller because one bit was not written

1162
00:46:43,359 --> 00:46:47,279
yet so it returns the old value

1163
00:46:48,000 --> 00:46:50,800
based on that um what can we do as an

1164
00:46:50,800 --> 00:46:53,280
attack let's try to get the counter to a

1165
00:46:53,280 --> 00:46:55,359
power of two so we'll get one single bit

1166
00:46:55,359 --> 00:46:57,520
in the counter and if you can become

1167
00:46:57,520 --> 00:47:00,079
weak one single bit

1168
00:47:00,079 --> 00:47:02,400
off to zero all the contour is set to

1169
00:47:02,400 --> 00:47:04,079
zero

1170
00:47:04,079 --> 00:47:05,359
um

1171
00:47:05,359 --> 00:47:08,319
so now what happens if you manage to get

1172
00:47:08,319 --> 00:47:11,280
a weak bit on your power of two

1173
00:47:11,280 --> 00:47:12,290
two things can happen

1174
00:47:12,290 --> 00:47:13,680
[Music]

1175
00:47:13,680 --> 00:47:15,520
if it's a one

1176
00:47:15,520 --> 00:47:17,520
you will get

1177
00:47:17,520 --> 00:47:19,280
the

1178
00:47:19,280 --> 00:47:22,240
new value if it becomes a zero you don't

1179
00:47:22,240 --> 00:47:23,280
get a

1180
00:47:23,280 --> 00:47:25,200
counter reset to zero because you get

1181
00:47:25,200 --> 00:47:27,920
the old counter

1182
00:47:27,920 --> 00:47:30,480
um we'll see later how we can put it

1183
00:47:30,480 --> 00:47:33,359
back to all to zero so

1184
00:47:33,359 --> 00:47:35,359
now if the bit you're targeting on your

1185
00:47:35,359 --> 00:47:38,480
power of two is not we because maybe

1186
00:47:38,480 --> 00:47:40,720
it's written

1187
00:47:40,720 --> 00:47:42,880
first and not later that's another

1188
00:47:42,880 --> 00:47:44,559
problem you just jump to the next power

1189
00:47:44,559 --> 00:47:46,559
of two and you try if the next bit this

1190
00:47:46,559 --> 00:47:48,640
week and you can scan all the bits after

1191
00:47:48,640 --> 00:47:50,960
one after each other and

1192
00:47:50,960 --> 00:47:53,359
maybe you're lucky at least one of them

1193
00:47:53,359 --> 00:47:57,680
will be written after the validity flag

1194
00:47:57,839 --> 00:47:58,800
um

1195
00:47:58,800 --> 00:48:02,640
so now how you get back to zero

1196
00:48:02,640 --> 00:48:04,160
we can play also with the distance to

1197
00:48:04,160 --> 00:48:06,960
the reader you remember to enforce how a

1198
00:48:06,960 --> 00:48:09,359
weak bit will be read so once we get the

1199
00:48:09,359 --> 00:48:12,160
situation when we're in an unstable read

1200
00:48:12,160 --> 00:48:15,040
between two values in the reader

1201
00:48:15,040 --> 00:48:18,160
um we can make it sure that it will be

1202
00:48:18,160 --> 00:48:22,319
read as a one and we do a tearing

1203
00:48:22,319 --> 00:48:24,960
earlier to corrupt on purpose the other

1204
00:48:24,960 --> 00:48:26,000
slot

1205
00:48:26,000 --> 00:48:28,720
so now we will get one slot with a weak

1206
00:48:28,720 --> 00:48:29,520
bit

1207
00:48:29,520 --> 00:48:31,119
and another slot which is completely

1208
00:48:31,119 --> 00:48:32,480
corrupted

1209
00:48:32,480 --> 00:48:34,880
so now when we read back that value if

1210
00:48:34,880 --> 00:48:36,960
the weak bit is seen

1211
00:48:36,960 --> 00:48:39,280
as a one we have the contour but if it's

1212
00:48:39,280 --> 00:48:42,400
seen as a zero then we manage to see

1213
00:48:42,400 --> 00:48:45,200
a zero in our counter

1214
00:48:45,200 --> 00:48:47,680
with a valid valid flag

1215
00:48:47,680 --> 00:48:50,079
still it's a bit unstable situation

1216
00:48:50,079 --> 00:48:52,319
because sometimes you see

1217
00:48:52,319 --> 00:48:54,400
the the full contour sometimes you see

1218
00:48:54,400 --> 00:48:57,200
zero so how can you stabilize it

1219
00:48:57,200 --> 00:49:00,160
put a card away from the reader

1220
00:49:00,160 --> 00:49:02,160
so the weak bit is more likely to be

1221
00:49:02,160 --> 00:49:03,520
zero

1222
00:49:03,520 --> 00:49:06,160
and you do a plus zero and when you

1223
00:49:06,160 --> 00:49:07,760
increment the contour you can also just

1224
00:49:07,760 --> 00:49:10,480
say plus zero so it will copy

1225
00:49:10,480 --> 00:49:12,800
the one that is read as a zero to a

1226
00:49:12,800 --> 00:49:15,680
stable zero on the second slot

1227
00:49:15,680 --> 00:49:17,520
and if you repeat the operation a second

1228
00:49:17,520 --> 00:49:20,720
time the second slot sorry

1229
00:49:20,720 --> 00:49:23,119
will be copied to the first slot and we

1230
00:49:23,119 --> 00:49:25,520
end up in situation when we have a very

1231
00:49:25,520 --> 00:49:28,960
stable counter reset to zero with a very

1232
00:49:28,960 --> 00:49:31,760
stable valid flag and we managed to

1233
00:49:31,760 --> 00:49:34,079
reset completely the

1234
00:49:34,079 --> 00:49:35,520
counter

1235
00:49:35,520 --> 00:49:38,720
and i'm afraid we are over something

1236
00:49:38,720 --> 00:49:40,079
yeah

1237
00:49:40,079 --> 00:49:41,359
so no

1238
00:49:41,359 --> 00:49:42,400
come

1239
00:49:42,400 --> 00:49:44,640
see us later if you want to have a nice

1240
00:49:44,640 --> 00:49:46,160
demo on that

1241
00:49:46,160 --> 00:49:48,559
so there is a cva there is all family of

1242
00:49:48,559 --> 00:49:51,119
tags which are affected on that

1243
00:49:51,119 --> 00:49:53,599
there are content measures explained on

1244
00:49:53,599 --> 00:49:56,720
application note at least mitigations

1245
00:49:56,720 --> 00:49:58,880
and there is no magic against that one

1246
00:49:58,880 --> 00:50:00,640
but for example when you play with a

1247
00:50:00,640 --> 00:50:03,599
contour uh if you use a very high value

1248
00:50:03,599 --> 00:50:05,839
contour there is less chance that we can

1249
00:50:05,839 --> 00:50:08,640
find this big bit somewhere higher so

1250
00:50:08,640 --> 00:50:10,559
instead of counting from 0 to 10 you can

1251
00:50:10,559 --> 00:50:13,520
count from ffff something to fff

1252
00:50:13,520 --> 00:50:15,680
a bit higher and it will be much harder

1253
00:50:15,680 --> 00:50:18,400
to reset the contour

1254
00:50:18,400 --> 00:50:21,280
so that's it that's over that or

1255
00:50:21,280 --> 00:50:22,240
slide

1256
00:50:22,240 --> 00:50:24,480
that's it yeah you got all the open

1257
00:50:24,480 --> 00:50:26,800
source tools there to play with it

1258
00:50:26,800 --> 00:50:28,880
we showed just

1259
00:50:28,880 --> 00:50:30,720
like fundamental technique to attack

1260
00:50:30,720 --> 00:50:32,160
many different

1261
00:50:32,160 --> 00:50:35,520
fids or eprom lf hf or even eproms which

1262
00:50:35,520 --> 00:50:37,440
are not on rfid

1263
00:50:37,440 --> 00:50:39,680
you may have also some some luck on it

1264
00:50:39,680 --> 00:50:41,680
but you've always to to target something

1265
00:50:41,680 --> 00:50:43,599
but there is a security feature that you

1266
00:50:43,599 --> 00:50:45,839
can activate but you can't control the

1267
00:50:45,839 --> 00:50:47,760
full result and then maybe you will be

1268
00:50:47,760 --> 00:50:48,800
lucky

1269
00:50:48,800 --> 00:50:50,559
i think you just missed to say one thing

1270
00:50:50,559 --> 00:50:52,720
last slide about the product family and

1271
00:50:52,720 --> 00:50:55,520
why the resetting of otp bits on those

1272
00:50:55,520 --> 00:50:57,599
modern cars is that they are used

1273
00:50:57,599 --> 00:50:59,680
everywhere in transport situation in the

1274
00:50:59,680 --> 00:51:02,640
world all over the place so yeah it has

1275
00:51:02,640 --> 00:51:04,240
implications

1276
00:51:04,240 --> 00:51:07,040
but then further we also wrote a paper

1277
00:51:07,040 --> 00:51:09,520
for stick yeah

1278
00:51:09,520 --> 00:51:11,520
and so you have a tiny url there too

1279
00:51:11,520 --> 00:51:12,880
it's a nice

1280
00:51:12,880 --> 00:51:15,520
long paper much very detailed very much

1281
00:51:15,520 --> 00:51:17,200
better explaining things than we are

1282
00:51:17,200 --> 00:51:19,200
doing live but we don't get live

1283
00:51:19,200 --> 00:51:20,880
demonstrations of open source those in

1284
00:51:20,880 --> 00:51:22,400
the proxmox repo

1285
00:51:22,400 --> 00:51:24,880
we also have a one thing that happened

1286
00:51:24,880 --> 00:51:27,760
during the code times instead of doing

1287
00:51:27,760 --> 00:51:29,520
the old proxmod forum which was kind of

1288
00:51:29,520 --> 00:51:32,240
dead and boring we started up a discord

1289
00:51:32,240 --> 00:51:36,959
server so rfid hacking by this man

1290
00:51:37,280 --> 00:51:39,440
we also got a vanity url so if you go to

1291
00:51:39,440 --> 00:51:40,880
that one you're most welcome to ask

1292
00:51:40,880 --> 00:51:42,640
questions about everything about what we

1293
00:51:42,640 --> 00:51:45,599
do this is our twitter handle so with

1294
00:51:45,599 --> 00:51:48,480
that said go by

1295
00:51:48,480 --> 00:51:51,480
hug

