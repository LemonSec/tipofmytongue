1
00:00:02,060 --> 00:00:09,300
as a Givens<font color="#CCCCCC"> um okay</font><font color="#E5E5E5"> um I'm doing two</font>

2
00:00:07,109 --> 00:00:11,940
talks today<font color="#E5E5E5"> this is the not</font><font color="#CCCCCC"> the bit by</font>

3
00:00:09,300 --> 00:00:14,429
<font color="#CCCCCC">one this</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> Z Siobhan and this one</font>

4
00:00:11,940 --> 00:00:16,289
the<font color="#E5E5E5"> disclosure that went down with</font><font color="#CCCCCC"> SCI</font>

5
00:00:14,429 --> 00:00:19,590
labs and Sigma designs was pretty bad

6
00:00:16,289 --> 00:00:21,539
<font color="#E5E5E5">but since bit fight happened disclosure</font>

7
00:00:19,590 --> 00:00:23,130
can't get any worse<font color="#CCCCCC"> so we've kind of cut</font>

8
00:00:21,539 --> 00:00:24,960
that bit out<font color="#CCCCCC"> of this this</font><font color="#E5E5E5"> particular</font>

9
00:00:23,130 --> 00:00:28,890
talk now I<font color="#E5E5E5"> don't actually know much</font>

10
00:00:24,960 --> 00:00:30,900
about z-wave now what z-wave is is RF

11
00:00:28,890 --> 00:00:32,700
communication protocol that's used for

12
00:00:30,900 --> 00:00:34,800
<font color="#E5E5E5">home automation mainly so it's</font>

13
00:00:32,700 --> 00:00:38,670
connecting things like light bulbs<font color="#E5E5E5"> light</font>

14
00:00:34,800 --> 00:00:40,349
switches<font color="#E5E5E5"> blinds sprinklers locks cameras</font>

15
00:00:38,670 --> 00:00:42,120
<font color="#E5E5E5">through to a hub which they will then</font>

16
00:00:40,350 --> 00:00:43,920
connect through to the internet<font color="#CCCCCC"> so</font><font color="#E5E5E5"> it</font>

17
00:00:42,120 --> 00:00:48,870
runs<font color="#E5E5E5"> on eight six eight megahertz in EU</font>

18
00:00:43,920 --> 00:00:50,309
<font color="#E5E5E5">maybe</font><font color="#CCCCCC"> 915 in the US and there's not much</font>

19
00:00:48,870 --> 00:00:51,899
to<font color="#E5E5E5"> the RF side of things there's</font><font color="#CCCCCC"> no</font>

20
00:00:50,309 --> 00:00:54,599
frequency hopping there's nothing<font color="#CCCCCC"> fancy</font>

21
00:00:51,899 --> 00:00:56,280
there now<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> the sensors that it</font>

22
00:00:54,600 --> 00:00:58,350
uses<font color="#CCCCCC"> are pretty boring things like flood</font>

23
00:00:56,280 --> 00:01:00,600
<font color="#E5E5E5">census so this does is sits underneath</font>

24
00:00:58,350 --> 00:01:01,590
your sink<font color="#E5E5E5"> and if it starts leaking</font><font color="#CCCCCC"> it</font>

25
00:01:00,600 --> 00:01:02,850
will send<font color="#E5E5E5"> the signal through you're</font>

26
00:01:01,590 --> 00:01:04,559
getting alert through your house is

27
00:01:02,850 --> 00:01:06,299
flooding<font color="#E5E5E5"> I've got another flood sensor</font>

28
00:01:04,559 --> 00:01:08,070
<font color="#E5E5E5">here they're pretty basic things</font><font color="#CCCCCC"> and</font>

29
00:01:06,299 --> 00:01:09,210
<font color="#E5E5E5">there's not much security impact you're</font>

30
00:01:08,070 --> 00:01:10,189
gonna get<font color="#E5E5E5"> from one of these being</font>

31
00:01:09,210 --> 00:01:12,509
compromised

32
00:01:10,189 --> 00:01:14,820
but there's more advanced things<font color="#CCCCCC"> this is</font>

33
00:01:12,510 --> 00:01:16,080
the<font color="#CCCCCC"> ring burglar alarm now all</font><font color="#E5E5E5"> of the</font>

34
00:01:14,820 --> 00:01:17,908
individual<font color="#CCCCCC"> components in</font><font color="#E5E5E5"> this are</font>

35
00:01:16,080 --> 00:01:19,350
<font color="#CCCCCC">actually z-wave devices that connect</font>

36
00:01:17,909 --> 00:01:21,659
through to the panel which then connects

37
00:01:19,350 --> 00:01:24,089
through to the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> but kind of more</font>

38
00:01:21,659 --> 00:01:26,490
interestingly to me<font color="#E5E5E5"> is locks now locks</font>

39
00:01:24,090 --> 00:01:28,200
are also connected<font color="#CCCCCC"> via a</font><font color="#E5E5E5"> wave and</font><font color="#CCCCCC"> that's</font>

40
00:01:26,490 --> 00:01:29,729
what I'm<font color="#E5E5E5"> going to do the demo with today</font>

41
00:01:28,200 --> 00:01:31,500
now there's not actually any technical

42
00:01:29,729 --> 00:01:33,298
issues<font color="#E5E5E5"> with the lock this is a protocol</font>

43
00:01:31,500 --> 00:01:35,040
issue with z-wave not a problem<font color="#E5E5E5"> with</font>

44
00:01:33,299 --> 00:01:39,479
this lock so just<font color="#E5E5E5"> ignore the</font>

45
00:01:35,040 --> 00:01:41,549
manufacturer on<font color="#CCCCCC"> it now z-waves got three</font>

46
00:01:39,479 --> 00:01:43,710
different<font color="#CCCCCC"> levels of security it started</font>

47
00:01:41,549 --> 00:01:44,820
off with no<font color="#E5E5E5"> security at all so the</font>

48
00:01:43,710 --> 00:01:46,140
commands were just sent in the clear

49
00:01:44,820 --> 00:01:47,250
from one end to the other<font color="#CCCCCC"> which meant</font>

50
00:01:46,140 --> 00:01:48,810
that<font color="#E5E5E5"> someone could walk up to your house</font>

51
00:01:47,250 --> 00:01:50,040
and they could<font color="#E5E5E5"> turn your lights on they</font>

52
00:01:48,810 --> 00:01:51,930
could<font color="#E5E5E5"> turn your heating on they could</font>

53
00:01:50,040 --> 00:01:53,820
<font color="#CCCCCC">open your locks</font><font color="#E5E5E5"> that's obviously not</font>

54
00:01:51,930 --> 00:01:56,100
good so what they did<font color="#E5E5E5"> is</font><font color="#CCCCCC"> they introduced</font>

55
00:01:53,820 --> 00:01:57,809
s naught security<font color="#E5E5E5"> and s naught security</font>

56
00:01:56,100 --> 00:01:59,969
induced<font color="#E5E5E5"> introduces encryption and</font>

57
00:01:57,810 --> 00:02:01,920
pairing so any<font color="#E5E5E5"> devices</font><font color="#CCCCCC"> they're paired to</font>

58
00:01:59,969 --> 00:02:04,259
your hub can communicate

59
00:02:01,920 --> 00:02:06,000
the problem if<font color="#CCCCCC"> that was was it</font><font color="#E5E5E5"> was found</font>

60
00:02:04,260 --> 00:02:06,659
<font color="#E5E5E5">that you could intercept the pairing</font>

61
00:02:06,000 --> 00:02:08,699
process

62
00:02:06,659 --> 00:02:11,340
so since<font color="#CCCCCC"> poster pentesting firm found</font>

63
00:02:08,699 --> 00:02:13,470
out 2013 that you could sniff the

64
00:02:11,340 --> 00:02:16,709
pairing<font color="#CCCCCC"> process obtain</font><font color="#E5E5E5"> the key and then</font>

65
00:02:13,470 --> 00:02:19,560
<font color="#E5E5E5">command the devices so what the company</font>

66
00:02:16,709 --> 00:02:22,530
the z-wave<font color="#E5E5E5"> Alliance that's behind z-wave</font>

67
00:02:19,560 --> 00:02:24,600
did was introduced s<font color="#E5E5E5"> to an</font><font color="#CCCCCC"> st uses</font>

68
00:02:22,530 --> 00:02:25,980
diffie-hellman<font color="#CCCCCC"> and authentication</font><font color="#E5E5E5"> so</font>

69
00:02:24,600 --> 00:02:28,890
that<font color="#E5E5E5"> even if you're there at the time of</font>

70
00:02:25,980 --> 00:02:30,090
pairing you can't insert the keys<font color="#E5E5E5"> what</font>

71
00:02:28,890 --> 00:02:32,640
<font color="#CCCCCC">i'm</font><font color="#E5E5E5"> going to be talking about is how we</font>

72
00:02:30,090 --> 00:02:35,250
can<font color="#E5E5E5"> downgrade the security from s 2 to s</font>

73
00:02:32,640 --> 00:02:38,549
<font color="#CCCCCC">0 so we undo all of those advantages</font>

74
00:02:35,250 --> 00:02:40,709
<font color="#CCCCCC">they put in</font><font color="#E5E5E5"> I'm gonna start talking</font>

75
00:02:38,550 --> 00:02:41,970
<font color="#E5E5E5">about how s naught security works so you</font>

76
00:02:40,709 --> 00:02:45,170
get an idea<font color="#CCCCCC"> of the vulnerabilities and</font>

77
00:02:41,970 --> 00:02:48,180
<font color="#CCCCCC">why</font><font color="#E5E5E5"> we'd</font><font color="#CCCCCC"> want to downgrade</font><font color="#E5E5E5"> to s naught</font>

78
00:02:45,170 --> 00:02:50,399
now the<font color="#E5E5E5"> networks got a 16 byte</font>

79
00:02:48,180 --> 00:02:53,010
encryption key now it's really quite

80
00:02:50,400 --> 00:02:55,290
interesting<font color="#CCCCCC"> this they actually generate</font>

81
00:02:53,010 --> 00:02:58,739
<font color="#E5E5E5">it using a true</font><font color="#CCCCCC"> random number generator</font>

82
00:02:55,290 --> 00:03:01,200
so every<font color="#E5E5E5"> single z-wave device this</font>

83
00:02:58,739 --> 00:03:02,910
<font color="#E5E5E5">little controller here has a proper</font>

84
00:03:01,200 --> 00:03:04,410
<font color="#E5E5E5">hardware random number generator inside</font>

85
00:03:02,910 --> 00:03:06,630
of it<font color="#E5E5E5"> and it's got to use</font><font color="#CCCCCC"> that to</font>

86
00:03:04,410 --> 00:03:08,640
generate<font color="#CCCCCC"> the keys if I've hard reset</font>

87
00:03:06,630 --> 00:03:10,620
<font color="#E5E5E5">this device it generates a new key</font><font color="#CCCCCC"> now</font>

88
00:03:08,640 --> 00:03:12,720
that's quite<font color="#E5E5E5"> good it's quite rare to see</font>

89
00:03:10,620 --> 00:03:16,049
<font color="#E5E5E5">that poor weak key generation something</font>

90
00:03:12,720 --> 00:03:17,549
we see a lot in IOT<font color="#E5E5E5"> devices now what it</font>

91
00:03:16,049 --> 00:03:19,709
does<font color="#E5E5E5"> is it then derived an encryption</font>

92
00:03:17,549 --> 00:03:21,989
key for encrypting the data<font color="#E5E5E5"> and an</font>

93
00:03:19,709 --> 00:03:23,880
<font color="#E5E5E5">authentication key for authenticating</font>

94
00:03:21,989 --> 00:03:27,000
the<font color="#E5E5E5"> data it does that simply by</font>

95
00:03:23,880 --> 00:03:29,040
encrypting<font color="#CCCCCC"> 16 bytes</font><font color="#E5E5E5"> of 55 and 16 bytes</font>

96
00:03:27,000 --> 00:03:31,980
of<font color="#E5E5E5"> a a using the network key so you've</font>

97
00:03:29,040 --> 00:03:35,310
got two different<font color="#CCCCCC"> keys it then encrypts</font>

98
00:03:31,980 --> 00:03:37,140
<font color="#E5E5E5">the message and it uses AES</font><font color="#CCCCCC"> ofb now this</font>

99
00:03:35,310 --> 00:03:38,820
isn't<font color="#E5E5E5"> a perfect mode of encryption it</font>

100
00:03:37,140 --> 00:03:40,950
doesn't inherently<font color="#E5E5E5"> have authentication</font>

101
00:03:38,820 --> 00:03:42,600
around it if you reuse<font color="#CCCCCC"> the initial</font>

102
00:03:40,950 --> 00:03:44,429
<font color="#E5E5E5">initialization vector on it as well it's</font>

103
00:03:42,600 --> 00:03:46,829
open<font color="#E5E5E5"> to a number of</font><font color="#CCCCCC"> weaknesses but</font><font color="#E5E5E5"> they</font>

104
00:03:44,430 --> 00:03:48,870
use<font color="#E5E5E5"> it securely and</font><font color="#CCCCCC"> then really</font>

105
00:03:46,829 --> 00:03:51,180
importantly<font color="#E5E5E5"> they wrap that with</font>

106
00:03:48,870 --> 00:03:52,470
authentication<font color="#E5E5E5"> now nearly all of the</font>

107
00:03:51,180 --> 00:03:54,870
time<font color="#CCCCCC"> with home automation you don't</font>

108
00:03:52,470 --> 00:03:57,090
really<font color="#CCCCCC"> care about</font><font color="#E5E5E5"> privacy and secrecy of</font>

109
00:03:54,870 --> 00:03:58,560
your<font color="#E5E5E5"> data if you see someone walking up</font>

110
00:03:57,090 --> 00:04:00,209
to<font color="#E5E5E5"> their house</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> their door unlocks</font>

111
00:03:58,560 --> 00:04:02,370
<font color="#E5E5E5">and you sniff a packet at that moment in</font>

112
00:04:00,209 --> 00:04:03,870
<font color="#CCCCCC">time</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know that they're unlocking the</font>

113
00:04:02,370 --> 00:04:05,940
door<font color="#CCCCCC"> it doesn't</font><font color="#E5E5E5"> matter if that's</font>

114
00:04:03,870 --> 00:04:07,859
<font color="#CCCCCC">encrypted if you can replay</font><font color="#E5E5E5"> that packet</font>

115
00:04:05,940 --> 00:04:09,120
if you can modify<font color="#CCCCCC"> that packet</font><font color="#E5E5E5"> that's</font>

116
00:04:07,859 --> 00:04:11,310
something<font color="#E5E5E5"> bad is gonna happen</font>

117
00:04:09,120 --> 00:04:12,660
it's the authentication of<font color="#E5E5E5"> that packet</font>

118
00:04:11,310 --> 00:04:15,510
<font color="#CCCCCC">that's important making</font><font color="#E5E5E5"> sure it came</font>

119
00:04:12,660 --> 00:04:18,659
from a genuine party so they use AES<font color="#CCCCCC"> C</font>

120
00:04:15,510 --> 00:04:22,048
<font color="#E5E5E5">BC</font><font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> kind of construction</font>

121
00:04:18,660 --> 00:04:23,970
using is to create a<font color="#E5E5E5"> keyed message</font>

122
00:04:22,048 --> 00:04:26,638
authentication code and again<font color="#CCCCCC"> that's</font>

123
00:04:23,970 --> 00:04:29,400
<font color="#E5E5E5">secure so the encryption is using AES</font>

124
00:04:26,639 --> 00:04:32,789
<font color="#CCCCCC">RFB which</font><font color="#E5E5E5"> is secured the authentication</font>

125
00:04:29,400 --> 00:04:34,409
is using<font color="#CCCCCC"> AES C</font><font color="#E5E5E5"> Mac which is secured the</font>

126
00:04:32,789 --> 00:04:36,740
key<font color="#CCCCCC"> generations</font><font color="#E5E5E5"> using a true</font><font color="#CCCCCC"> random</font>

127
00:04:34,410 --> 00:04:39,570
number generator<font color="#CCCCCC"> it's secure</font>

128
00:04:36,740 --> 00:04:42,750
you can't replay<font color="#CCCCCC"> now what it does is it</font>

129
00:04:39,570 --> 00:04:44,039
it the<font color="#E5E5E5"> IV it sends half of the IV from</font>

130
00:04:42,750 --> 00:04:46,229
<font color="#E5E5E5">one end to the other and then the other</font>

131
00:04:44,039 --> 00:04:47,849
<font color="#E5E5E5">end uses the other half of the IV which</font>

132
00:04:46,229 --> 00:04:49,590
means that packets<font color="#E5E5E5"> have to be fresh</font>

133
00:04:47,850 --> 00:04:51,870
you can't just spoof packets you can't

134
00:04:49,590 --> 00:04:54,000
replay packets so that's secure as well

135
00:04:51,870 --> 00:04:54,690
but<font color="#E5E5E5"> the problem</font><font color="#CCCCCC"> is is with the key</font>

136
00:04:54,000 --> 00:04:57,810
exchange

137
00:04:54,690 --> 00:04:59,280
they haven't used widely accepted<font color="#E5E5E5"> and</font>

138
00:04:57,810 --> 00:05:02,460
secure way<font color="#CCCCCC"> of exchanging the keys</font>

139
00:04:59,280 --> 00:05:05,549
between<font color="#E5E5E5"> two devices now you'll notice</font>

140
00:05:02,460 --> 00:05:07,380
this<font color="#CCCCCC"> is a series of</font><font color="#E5E5E5"> different z-wave</font>

141
00:05:05,550 --> 00:05:10,169
devices<font color="#E5E5E5"> they don't have a user</font><font color="#CCCCCC"> interface</font>

142
00:05:07,380 --> 00:05:11,850
on them it's a flood sensor<font color="#E5E5E5"> there's no</font>

143
00:05:10,169 --> 00:05:13,889
way<font color="#E5E5E5"> for me</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> type the key into this</font>

144
00:05:11,850 --> 00:05:15,690
device<font color="#E5E5E5"> it's not like a phone it's not</font>

145
00:05:13,889 --> 00:05:17,729
like a<font color="#E5E5E5"> computer</font><font color="#CCCCCC"> but if we join a Wi-Fi</font>

146
00:05:15,690 --> 00:05:19,680
network<font color="#E5E5E5"> we can type the key in there's</font>

147
00:05:17,729 --> 00:05:21,150
no<font color="#E5E5E5"> way to do</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so they've got</font><font color="#CCCCCC"> to</font>

148
00:05:19,680 --> 00:05:23,849
exchange the key somehow<font color="#E5E5E5"> between the</font>

149
00:05:21,150 --> 00:05:26,280
device and<font color="#E5E5E5"> the controller now the way</font>

150
00:05:23,849 --> 00:05:27,870
they do that<font color="#E5E5E5"> to move KN the network key</font>

151
00:05:26,280 --> 00:05:29,849
from one end to the other is they

152
00:05:27,870 --> 00:05:32,250
<font color="#E5E5E5">encrypt it with</font><font color="#CCCCCC"> a temporary key</font><font color="#E5E5E5"> so that</font>

153
00:05:29,849 --> 00:05:34,949
it gets<font color="#E5E5E5"> into the device now the</font>

154
00:05:32,250 --> 00:05:37,500
<font color="#E5E5E5">temporary key that they use is</font><font color="#CCCCCC"> 16</font><font color="#E5E5E5"> bytes</font>

155
00:05:34,949 --> 00:05:39,240
<font color="#E5E5E5">of all zeros so I don't know if any of</font>

156
00:05:37,500 --> 00:05:42,060
you have<font color="#E5E5E5"> worked with</font><font color="#CCCCCC"> ZigBee before and</font>

157
00:05:39,240 --> 00:05:43,620
<font color="#CCCCCC">ZigBee does a</font><font color="#E5E5E5"> similar</font><font color="#CCCCCC"> thing and what</font>

158
00:05:42,060 --> 00:05:45,660
they do their network key is ZigBee

159
00:05:43,620 --> 00:05:49,889
Alliance<font color="#CCCCCC"> 0 9 because the standard was</font>

160
00:05:45,660 --> 00:05:51,419
published<font color="#CCCCCC"> in 2009 that</font><font color="#E5E5E5"> was secret again</font>

161
00:05:49,889 --> 00:05:52,650
this was held secret for a while<font color="#E5E5E5"> but you</font>

162
00:05:51,419 --> 00:05:54,060
couldn't<font color="#CCCCCC"> reverse-engineer different</font>

163
00:05:52,650 --> 00:05:56,880
controllers different firm eyes and get

164
00:05:54,060 --> 00:05:59,039
this<font color="#E5E5E5"> key so that introduces a problem as</font>

165
00:05:56,880 --> 00:06:00,750
an attacker<font color="#CCCCCC"> if I can sniff that key</font>

166
00:05:59,039 --> 00:06:02,909
going<font color="#E5E5E5"> from one</font><font color="#CCCCCC"> end to the other I can</font>

167
00:06:00,750 --> 00:06:05,360
recover it so if you're there at<font color="#E5E5E5"> the</font>

168
00:06:02,909 --> 00:06:08,219
<font color="#E5E5E5">time of pairing you've got that key now</font>

169
00:06:05,360 --> 00:06:10,020
I'm gonna<font color="#E5E5E5"> try and do an actual demo here</font>

170
00:06:08,220 --> 00:06:13,370
which may or may<font color="#CCCCCC"> not work</font><font color="#E5E5E5"> these</font>

171
00:06:10,020 --> 00:06:15,930
<font color="#E5E5E5">screenshots</font><font color="#CCCCCC"> it just in case it doesn't</font>

172
00:06:13,370 --> 00:06:18,360
what<font color="#CCCCCC"> we have here is a piece of</font><font color="#E5E5E5"> software</font>

173
00:06:15,930 --> 00:06:19,949
<font color="#CCCCCC">that's acting as the controller</font><font color="#E5E5E5"> running</font>

174
00:06:18,360 --> 00:06:26,849
on my laptop<font color="#CCCCCC"> so this laptops the</font>

175
00:06:19,949 --> 00:06:28,240
controller and if we go to this what<font color="#E5E5E5"> we</font>

176
00:06:26,849 --> 00:06:30,190
have<font color="#E5E5E5"> here is a</font>

177
00:06:28,240 --> 00:06:32,139
<font color="#CCCCCC">sniffing</font><font color="#E5E5E5"> and what this is doing is</font><font color="#CCCCCC"> it's</font>

178
00:06:30,190 --> 00:06:35,080
showing us the z-wave traffic as it<font color="#CCCCCC"> goes</font>

179
00:06:32,139 --> 00:06:37,240
backwards<font color="#CCCCCC"> and forwards if I can find</font><font color="#E5E5E5"> the</font>

180
00:06:35,080 --> 00:06:41,680
mouse pointer I'm just gonna restart

181
00:06:37,240 --> 00:06:43,900
this<font color="#E5E5E5"> so the screens nice and clear face</font>

182
00:06:41,680 --> 00:06:54,190
screen there<font color="#E5E5E5"> and then if we jump through</font>

183
00:06:43,900 --> 00:06:56,349
<font color="#CCCCCC">to jump through to</font><font color="#E5E5E5"> the controller what</font>

184
00:06:54,190 --> 00:06:58,060
I'm going<font color="#CCCCCC"> to do is</font><font color="#E5E5E5"> very simply I'm gonna</font>

185
00:06:56,349 --> 00:06:59,620
press add<font color="#E5E5E5"> so this is like pressing a</font>

186
00:06:58,060 --> 00:07:04,030
button<font color="#E5E5E5"> authorizing the controller to add</font>

187
00:06:59,620 --> 00:07:06,370
<font color="#E5E5E5">a</font><font color="#CCCCCC"> device then on the C wave device here</font>

188
00:07:04,030 --> 00:07:07,809
I'm gonna press three buttons<font color="#E5E5E5"> you can</font>

189
00:07:06,370 --> 00:07:09,639
<font color="#CCCCCC">see at the bottom is a load of traffic</font>

190
00:07:07,810 --> 00:07:12,789
going on<font color="#E5E5E5"> and it's now paired with this</font>

191
00:07:09,639 --> 00:07:13,720
controller<font color="#E5E5E5"> so now this is communicating</font>

192
00:07:12,789 --> 00:07:15,940
with the controller here

193
00:07:13,720 --> 00:07:17,530
<font color="#E5E5E5">it's exchanged those s</font><font color="#CCCCCC"> not keys but we</font>

194
00:07:15,940 --> 00:07:19,990
can decrypt them and I'll show<font color="#E5E5E5"> you how</font>

195
00:07:17,530 --> 00:07:22,809
<font color="#E5E5E5">easy that</font><font color="#CCCCCC"> is to do I'm gonna</font><font color="#E5E5E5"> just jump</font>

196
00:07:19,990 --> 00:07:33,190
<font color="#E5E5E5">back through to the</font><font color="#CCCCCC"> sniffer here scroll</font>

197
00:07:22,810 --> 00:07:39,250
<font color="#E5E5E5">back up</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the top</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> you see right up</font>

198
00:07:33,190 --> 00:07:40,900
at the<font color="#CCCCCC"> top here we get what says</font>

199
00:07:39,250 --> 00:07:43,990
<font color="#E5E5E5">security message and calculation</font>

200
00:07:40,900 --> 00:07:46,659
encapsulation<font color="#E5E5E5"> there and it says that</font>

201
00:07:43,990 --> 00:07:48,699
it's a it's trying to decrypt<font color="#E5E5E5"> it there</font>

202
00:07:46,659 --> 00:07:50,949
there's no decrypted content<font color="#E5E5E5"> so we have</font>

203
00:07:48,699 --> 00:07:52,719
to do is press decrypt the key of all

204
00:07:50,949 --> 00:07:55,690
<font color="#CCCCCC">zeros is automatically populated because</font>

205
00:07:52,719 --> 00:07:58,750
it all already<font color="#E5E5E5"> knows this is bad from</font>

206
00:07:55,690 --> 00:08:01,030
that point<font color="#CCCCCC"> it then gives us</font><font color="#E5E5E5"> the network</font>

207
00:07:58,750 --> 00:08:03,490
key so<font color="#CCCCCC"> it's decrypted down there</font><font color="#E5E5E5"> okay I</font>

208
00:08:01,030 --> 00:08:05,619
can<font color="#E5E5E5"> just copy and paste</font><font color="#CCCCCC"> that and go</font><font color="#E5E5E5"> to</font>

209
00:08:03,490 --> 00:08:09,789
the next encrypted packet which won't

210
00:08:05,620 --> 00:08:11,560
decrypt press decrypt paste the key<font color="#E5E5E5"> that</font>

211
00:08:09,789 --> 00:08:13,568
we've<font color="#E5E5E5"> just snipped in and it's now</font>

212
00:08:11,560 --> 00:08:14,050
decrypted<font color="#CCCCCC"> our data</font><font color="#E5E5E5"> so it's really really</font>

213
00:08:13,569 --> 00:08:16,509
<font color="#E5E5E5">simple</font>

214
00:08:14,050 --> 00:08:22,620
<font color="#CCCCCC">so even tools made by</font><font color="#E5E5E5"> Sai labs will do</font>

215
00:08:16,509 --> 00:08:22,620
this decryption it's a<font color="#CCCCCC"> nine issue</font>

216
00:08:33,419 --> 00:08:47,949
now<font color="#E5E5E5"> PowerPoint doesn't want to come back</font>

217
00:08:35,770 --> 00:08:49,630
<font color="#CCCCCC">I can't actually work computers</font><font color="#E5E5E5"> there's</font>

218
00:08:47,950 --> 00:08:50,740
other problems<font color="#CCCCCC"> now if you come along and</font>

219
00:08:49,630 --> 00:08:52,600
you press<font color="#CCCCCC"> the</font><font color="#E5E5E5"> button on the controller</font>

220
00:08:50,740 --> 00:08:54,250
<font color="#CCCCCC">and you press the</font><font color="#E5E5E5"> button on a genuine</font>

221
00:08:52,600 --> 00:08:56,980
device your<font color="#E5E5E5"> parents are genuine device</font>

222
00:08:54,250 --> 00:08:59,290
<font color="#E5E5E5">but if someone outside your house comes</font>

223
00:08:56,980 --> 00:09:00,610
along at that<font color="#E5E5E5"> moment in time and presses</font>

224
00:08:59,290 --> 00:09:02,199
a button before<font color="#E5E5E5"> you press the button</font>

225
00:09:00,610 --> 00:09:03,760
they'll join their device to<font color="#CCCCCC"> your</font>

226
00:09:02,200 --> 00:09:05,709
network<font color="#E5E5E5"> so it's like a race</font><font color="#CCCCCC"> condition</font>

227
00:09:03,760 --> 00:09:07,029
that whoever pairs first will get paired

228
00:09:05,709 --> 00:09:08,649
with<font color="#E5E5E5"> that controller</font><font color="#CCCCCC"> there's no</font>

229
00:09:07,029 --> 00:09:09,910
authentication<font color="#E5E5E5"> of the node you're</font>

230
00:09:08,649 --> 00:09:12,370
joining<font color="#E5E5E5"> so you don't know if the node</font>

231
00:09:09,910 --> 00:09:14,079
that's<font color="#E5E5E5"> joining is a genuine node the</font>

232
00:09:12,370 --> 00:09:15,850
other problem is<font color="#E5E5E5"> that if you've</font><font color="#CCCCCC"> got a</font>

233
00:09:14,080 --> 00:09:17,620
door lock<font color="#E5E5E5"> a</font><font color="#CCCCCC"> cat flap</font><font color="#E5E5E5"> a light bulb</font>

234
00:09:15,850 --> 00:09:20,500
heating and sprinklers all on your

235
00:09:17,620 --> 00:09:22,990
<font color="#CCCCCC">z-wave</font><font color="#E5E5E5"> network with</font><font color="#CCCCCC"> their 0 all of those</font>

236
00:09:20,500 --> 00:09:24,760
have exactly the same key<font color="#E5E5E5"> so if you</font>

237
00:09:22,990 --> 00:09:26,920
sniff any of those pairings<font color="#CCCCCC"> you've got</font>

238
00:09:24,760 --> 00:09:28,569
the key to unlock the<font color="#CCCCCC"> door</font><font color="#E5E5E5"> if you steal</font>

239
00:09:26,920 --> 00:09:30,430
someone's sprinklers from their garden

240
00:09:28,570 --> 00:09:34,540
<font color="#E5E5E5">the</font><font color="#CCCCCC"> unprotected zone you've got access</font>

241
00:09:30,430 --> 00:09:36,010
to<font color="#E5E5E5"> the keys so the problem is if you're</font>

242
00:09:34,540 --> 00:09:38,199
in<font color="#E5E5E5"> range at the time of inclusion you</font>

243
00:09:36,010 --> 00:09:39,970
can<font color="#CCCCCC"> obtain the keys that's a bit of a</font>

244
00:09:38,200 --> 00:09:41,980
problem<font color="#CCCCCC"> if you'd be</font><font color="#E5E5E5"> unhappy</font><font color="#CCCCCC"> if that was</font>

245
00:09:39,970 --> 00:09:43,450
<font color="#E5E5E5">possible if your Wi-Fi network</font><font color="#CCCCCC"> the</font>

246
00:09:41,980 --> 00:09:45,640
device<font color="#CCCCCC"> isn't authenticated and</font><font color="#E5E5E5"> there's a</font>

247
00:09:43,450 --> 00:09:47,260
<font color="#E5E5E5">single</font><font color="#CCCCCC"> network wide key</font><font color="#E5E5E5"> now they</font>

248
00:09:45,640 --> 00:09:49,750
recognize these<font color="#CCCCCC"> as issues</font><font color="#E5E5E5"> so what they</font>

249
00:09:47,260 --> 00:09:51,430
did<font color="#E5E5E5"> was</font><font color="#CCCCCC"> they introduced s to security</font><font color="#E5E5E5"> we</font>

250
00:09:49,750 --> 00:09:53,800
don't know what happen to<font color="#E5E5E5"> s</font><font color="#CCCCCC"> one and I</font>

251
00:09:51,430 --> 00:09:57,010
asked them<font color="#E5E5E5"> and it doesn't seem to exist</font>

252
00:09:53,800 --> 00:10:00,250
<font color="#CCCCCC">and I to be honest only</font><font color="#E5E5E5"> care about s</font><font color="#CCCCCC"> T</font>

253
00:09:57,010 --> 00:10:02,380
I'm<font color="#E5E5E5"> not breaking s T security this is</font>

254
00:10:00,250 --> 00:10:04,360
the thing I'm downgrading s 2 to s

255
00:10:02,380 --> 00:10:06,250
naught<font color="#E5E5E5"> so it's completely</font><font color="#CCCCCC"> outside of the</font>

256
00:10:04,360 --> 00:10:08,649
S T security<font color="#E5E5E5"> but it's probably worth</font>

257
00:10:06,250 --> 00:10:11,230
explaining<font color="#E5E5E5"> it now what they said here is</font>

258
00:10:08,649 --> 00:10:13,570
s<font color="#CCCCCC"> to</font><font color="#E5E5E5"> also completely removes the risk of</font>

259
00:10:11,230 --> 00:10:15,490
devices being<font color="#E5E5E5"> hat whilst they included</font>

260
00:10:13,570 --> 00:10:17,950
in the network<font color="#E5E5E5"> now this really gets me</font>

261
00:10:15,490 --> 00:10:20,260
going when people say completely removes

262
00:10:17,950 --> 00:10:22,779
the risk<font color="#E5E5E5"> if they use the word unhackable</font>

263
00:10:20,260 --> 00:10:25,510
<font color="#CCCCCC">as well it's a bit</font><font color="#E5E5E5"> of a trigger</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font>

264
00:10:22,779 --> 00:10:28,329
honest<font color="#E5E5E5"> and so we were interested in this</font>

265
00:10:25,510 --> 00:10:30,310
<font color="#CCCCCC">completely removes the risk so the way</font>

266
00:10:28,329 --> 00:10:32,680
it does this is it<font color="#E5E5E5"> uses elliptic curve</font>

267
00:10:30,310 --> 00:10:34,869
diffie-hellman to exchange<font color="#E5E5E5"> the keys so</font>

268
00:10:32,680 --> 00:10:36,329
that<font color="#CCCCCC"> could still be vulnerable to an</font>

269
00:10:34,870 --> 00:10:37,949
active man-in-the-middle attack

270
00:10:36,329 --> 00:10:39,479
you could sit there<font color="#E5E5E5"> with a device</font><font color="#CCCCCC"> that</font>

271
00:10:37,949 --> 00:10:40,889
performs diffie-hellman on one side and

272
00:10:39,480 --> 00:10:42,779
the<font color="#CCCCCC"> other side</font><font color="#E5E5E5"> and you'd be able to</font>

273
00:10:40,889 --> 00:10:44,879
intercept those what it also does is<font color="#CCCCCC"> it</font>

274
00:10:42,779 --> 00:10:47,459
<font color="#E5E5E5">uses</font><font color="#CCCCCC"> what's called a device specific key</font>

275
00:10:44,879 --> 00:10:49,649
so<font color="#E5E5E5"> you have to type in</font><font color="#CCCCCC"> four five digits</font>

276
00:10:47,459 --> 00:10:51,449
of the key into<font color="#E5E5E5"> the controller and</font><font color="#CCCCCC"> that</font>

277
00:10:49,649 --> 00:10:52,619
authenticates the<font color="#E5E5E5"> other device it shows</font>

278
00:10:51,449 --> 00:10:54,809
the rest<font color="#E5E5E5"> of the key as well</font>

279
00:10:52,619 --> 00:10:55,889
and instead of<font color="#E5E5E5"> using one key it's got</font>

280
00:10:54,809 --> 00:10:57,420
three<font color="#CCCCCC"> different layers of keys you've</font>

281
00:10:55,889 --> 00:10:59,489
got access<font color="#E5E5E5"> control which is used for</font>

282
00:10:57,420 --> 00:11:00,748
locks<font color="#CCCCCC"> you've got a syndicated which is</font>

283
00:10:59,489 --> 00:11:02,160
used for<font color="#E5E5E5"> things you care about</font><font color="#CCCCCC"> and</font>

284
00:11:00,749 --> 00:11:06,329
unauthenticated<font color="#E5E5E5"> things like your cat</font>

285
00:11:02,160 --> 00:11:10,350
flap so comparing them<font color="#CCCCCC"> you can see that</font>

286
00:11:06,329 --> 00:11:12,508
<font color="#CCCCCC">s naught uses a</font><font color="#E5E5E5"> SOF bsts move to</font><font color="#CCCCCC"> AES CCM</font>

287
00:11:10,350 --> 00:11:14,579
so it's got integrated<font color="#E5E5E5"> authentication so</font>

288
00:11:12,509 --> 00:11:16,319
they can't make any mistakes<font color="#CCCCCC"> there the</font>

289
00:11:14,579 --> 00:11:18,359
number of<font color="#E5E5E5"> keys it's gone from single</font><font color="#CCCCCC"> to</font>

290
00:11:16,319 --> 00:11:21,179
multiple key exchange<font color="#E5E5E5"> symmetric and</font>

291
00:11:18,360 --> 00:11:23,489
sniffle<font color="#E5E5E5"> to diffie-hellman</font><font color="#CCCCCC"> and they've</font>

292
00:11:21,179 --> 00:11:25,290
actually authenticated<font color="#E5E5E5"> the connection so</font>

293
00:11:23,489 --> 00:11:26,970
they<font color="#CCCCCC"> fix</font><font color="#E5E5E5"> a lot of problems now there</font>

294
00:11:25,290 --> 00:11:28,709
might<font color="#CCCCCC"> be issues with that as to I</font><font color="#E5E5E5"> don't</font>

295
00:11:26,970 --> 00:11:30,720
know I'm<font color="#CCCCCC"> not a cryptographer</font>

296
00:11:28,709 --> 00:11:34,040
<font color="#CCCCCC">I like cryptography</font><font color="#E5E5E5"> but I couldn't see</font>

297
00:11:30,720 --> 00:11:38,220
any<font color="#CCCCCC"> obvious issues so we started looking</font>

298
00:11:34,040 --> 00:11:42,089
the specifications and<font color="#E5E5E5"> standards the one</font>

299
00:11:38,220 --> 00:11:44,220
thing we quickly realized was<font color="#CCCCCC"> that the</font>

300
00:11:42,089 --> 00:11:46,589
z-wave ecosystem is really<font color="#CCCCCC"> closed if you</font>

301
00:11:44,220 --> 00:11:48,029
<font color="#E5E5E5">sell a z-wave device</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> market</font><font color="#CCCCCC"> it's</font>

302
00:11:46,589 --> 00:11:50,419
got to use one of these<font color="#CCCCCC"> little modules</font>

303
00:11:48,029 --> 00:11:52,589
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is a module</font><font color="#CCCCCC"> made by</font><font color="#E5E5E5"> SCI labs and</font>

304
00:11:50,419 --> 00:11:55,079
the supposedly ones that are made by

305
00:11:52,589 --> 00:11:56,879
<font color="#E5E5E5">Mitsumi but we can't buy them</font><font color="#CCCCCC"> we can't</font>

306
00:11:55,079 --> 00:11:59,248
find any in any products I<font color="#E5E5E5"> don't think</font>

307
00:11:56,879 --> 00:12:01,860
they genuinely exist so that modules got

308
00:11:59,249 --> 00:12:03,389
to be in there<font color="#E5E5E5"> and you can customize</font>

309
00:12:01,860 --> 00:12:06,600
<font color="#E5E5E5">certain aspects of the firm in there but</font>

310
00:12:03,389 --> 00:12:08,249
the actual RF stack is a standard z-wave

311
00:12:06,600 --> 00:12:10,619
thing you can<font color="#E5E5E5"> just put an</font><font color="#CCCCCC"> application on</font>

312
00:12:08,249 --> 00:12:12,179
<font color="#E5E5E5">that now if you sell that product is</font>

313
00:12:10,619 --> 00:12:13,799
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be certified by the z-wave</font>

314
00:12:12,179 --> 00:12:16,019
Alliance<font color="#CCCCCC"> to go through a period of</font>

315
00:12:13,799 --> 00:12:18,209
<font color="#E5E5E5">testing and a really big thing about</font>

316
00:12:16,019 --> 00:12:21,269
<font color="#E5E5E5">this is they say</font><font color="#CCCCCC"> that any two</font><font color="#E5E5E5"> devices</font>

317
00:12:18,209 --> 00:12:22,589
have got to interoperate<font color="#E5E5E5"> so what that</font>

318
00:12:21,269 --> 00:12:24,509
means is if you've<font color="#CCCCCC"> got an S naught</font>

319
00:12:22,589 --> 00:12:27,179
controller<font color="#CCCCCC"> one that doesn't support</font><font color="#E5E5E5"> s 2</font>

320
00:12:24,509 --> 00:12:28,980
and an S 2 lock they've got to work

321
00:12:27,179 --> 00:12:31,439
together<font color="#E5E5E5"> if you've got an S 2 controller</font>

322
00:12:28,980 --> 00:12:31,980
and an S naught lock they have to work

323
00:12:31,439 --> 00:12:34,759
together

324
00:12:31,980 --> 00:12:37,319
now when you say backwards<font color="#E5E5E5"> compatibility</font>

325
00:12:34,759 --> 00:12:38,730
<font color="#E5E5E5">again that just shouts bang right attack</font>

326
00:12:37,319 --> 00:12:40,979
to me it says there's going to be a way

327
00:12:38,730 --> 00:12:42,869
to<font color="#E5E5E5"> work backward from this they have</font>

328
00:12:40,980 --> 00:12:45,360
this brilliant page here which you can

329
00:12:42,869 --> 00:12:47,339
search<font color="#CCCCCC"> for any device and you can see if</font>

330
00:12:45,360 --> 00:12:49,410
it's been certified you<font color="#E5E5E5"> can see at the</font>

331
00:12:47,339 --> 00:12:50,089
top there it<font color="#E5E5E5"> says there are over</font><font color="#CCCCCC"> 2400</font>

332
00:12:49,410 --> 00:12:51,800
<font color="#E5E5E5">interrupt</font>

333
00:12:50,089 --> 00:12:54,199
<font color="#CCCCCC">zus products they really go on about</font>

334
00:12:51,800 --> 00:12:57,069
this interoperability<font color="#CCCCCC"> the thing is we</font>

335
00:12:54,199 --> 00:12:59,180
can downgrade<font color="#E5E5E5"> and it works both ways</font>

336
00:12:57,069 --> 00:13:02,059
<font color="#E5E5E5">we've got a few tools here and I'll</font>

337
00:12:59,180 --> 00:13:07,128
explain<font color="#CCCCCC"> why I'm using them at the top</font>

338
00:13:02,059 --> 00:13:09,079
there<font color="#E5E5E5"> we have a</font><font color="#CCCCCC"> Sigma labs</font><font color="#E5E5E5"> product that</font>

339
00:13:07,129 --> 00:13:10,610
acts as a controller<font color="#E5E5E5"> the reason we're</font>

340
00:13:09,079 --> 00:13:13,189
using that is it's the only<font color="#CCCCCC"> thing we</font>

341
00:13:10,610 --> 00:13:15,319
<font color="#CCCCCC">could find</font><font color="#E5E5E5"> that supported s2 security</font>

342
00:13:13,189 --> 00:13:17,209
there were no hubs on the UK market at

343
00:13:15,319 --> 00:13:19,370
the time<font color="#CCCCCC"> that supported s2</font><font color="#E5E5E5"> this is</font>

344
00:13:17,209 --> 00:13:21,638
another controller that technically

345
00:13:19,370 --> 00:13:24,439
supports s2 but<font color="#CCCCCC"> we can't get</font><font color="#E5E5E5"> it working</font>

346
00:13:21,639 --> 00:13:26,990
<font color="#E5E5E5">the little black box</font><font color="#CCCCCC"> is called the</font>

347
00:13:24,439 --> 00:13:28,699
sniffer<font color="#E5E5E5"> and this is just a</font><font color="#CCCCCC"> ZigBee</font>

348
00:13:26,990 --> 00:13:31,059
sniffer it was providing the<font color="#E5E5E5"> data to</font>

349
00:13:28,699 --> 00:13:34,758
that Wireshark<font color="#E5E5E5"> like like</font><font color="#CCCCCC"> application and</font>

350
00:13:31,059 --> 00:13:36,860
there are free<font color="#CCCCCC"> tools that do sniffing</font>

351
00:13:34,759 --> 00:13:38,629
but they don't do the decryption<font color="#CCCCCC"> they</font>

352
00:13:36,860 --> 00:13:40,069
don't deal<font color="#E5E5E5"> with all of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> different</font>

353
00:13:38,629 --> 00:13:44,240
speeds and<font color="#E5E5E5"> all the different protocol</font>

354
00:13:40,069 --> 00:13:46,699
variations so it costs<font color="#E5E5E5"> seven hundred</font>

355
00:13:44,240 --> 00:13:48,379
pounds<font color="#CCCCCC"> to</font><font color="#E5E5E5"> buy</font><font color="#CCCCCC"> a development kit and you</font>

356
00:13:46,699 --> 00:13:50,059
get the only<font color="#E5E5E5"> two useful bits for a</font>

357
00:13:48,379 --> 00:13:52,220
<font color="#E5E5E5">pentesters perspective of these two</font>

358
00:13:50,059 --> 00:13:55,129
little dongles<font color="#E5E5E5"> so not particularly good</font>

359
00:13:52,220 --> 00:13:56,779
value<font color="#E5E5E5"> that gives us access to the</font>

360
00:13:55,129 --> 00:13:59,209
sniffer tool which is the decryption

361
00:13:56,779 --> 00:14:01,639
<font color="#E5E5E5">like Wireshark it's pretty good to be</font>

362
00:13:59,209 --> 00:14:03,050
honest<font color="#CCCCCC"> and it gives</font><font color="#E5E5E5"> us access to the PC</font>

363
00:14:01,639 --> 00:14:06,350
controller so that's just acting<font color="#CCCCCC"> like a</font>

364
00:14:03,050 --> 00:14:08,420
hub<font color="#E5E5E5"> but on a laptop now the other tool</font>

365
00:14:06,350 --> 00:14:10,850
we're using is called<font color="#E5E5E5"> a yard stick one</font>

366
00:14:08,420 --> 00:14:13,910
so that's<font color="#CCCCCC"> a another little USB</font><font color="#E5E5E5"> dongle</font>

367
00:14:10,850 --> 00:14:15,470
there and it has a TI chip on it that's

368
00:14:13,910 --> 00:14:18,350
an RF<font color="#CCCCCC"> system-on-chip</font>

369
00:14:15,470 --> 00:14:19,819
and it's got<font color="#E5E5E5"> firm on it called RF</font><font color="#CCCCCC"> cap</font>

370
00:14:18,350 --> 00:14:24,110
and<font color="#E5E5E5"> that allows</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> be commanded with</font>

371
00:14:19,819 --> 00:14:25,550
<font color="#E5E5E5">Python and it's quite it makes working</font>

372
00:14:24,110 --> 00:14:27,679
<font color="#CCCCCC">with our air quite easy it's not</font><font color="#E5E5E5"> as</font>

373
00:14:25,550 --> 00:14:29,300
powerful as an SDR<font color="#E5E5E5"> but it works</font>

374
00:14:27,679 --> 00:14:30,860
differently<font color="#E5E5E5"> and the reason we use it for</font>

375
00:14:29,300 --> 00:14:34,128
<font color="#CCCCCC">a lot of these</font><font color="#E5E5E5"> attacks is it has half a</font>

376
00:14:30,860 --> 00:14:37,129
watt of power<font color="#E5E5E5"> output now an SD</font><font color="#CCCCCC"> ours got</font>

377
00:14:34,129 --> 00:14:38,509
maybe 10 milliwatts<font color="#CCCCCC"> tops</font><font color="#E5E5E5"> which makes a</font>

378
00:14:37,129 --> 00:14:40,429
practical real-world attacks quite

379
00:14:38,509 --> 00:14:41,959
difficult to carry out half<font color="#E5E5E5"> of what if I</font>

380
00:14:40,429 --> 00:14:44,449
set that jamming on<font color="#E5E5E5"> eight six eight</font>

381
00:14:41,959 --> 00:14:46,518
megahertz in my house and causes

382
00:14:44,449 --> 00:14:48,079
widespread disruption<font color="#E5E5E5"> in the area</font>

383
00:14:46,519 --> 00:14:49,970
people's burglar alarms<font color="#CCCCCC"> stop working</font>

384
00:14:48,079 --> 00:14:52,729
they<font color="#E5E5E5"> con unlock their cars you know it's</font>

385
00:14:49,970 --> 00:14:54,410
got enough power to<font color="#CCCCCC"> cause problems</font><font color="#E5E5E5"> now</font>

386
00:14:52,730 --> 00:14:58,399
the other thing I'm<font color="#CCCCCC"> using is a Yale lock</font>

387
00:14:54,410 --> 00:15:00,589
and it's fairly standard lot to fit to

388
00:14:58,399 --> 00:15:01,970
UK doors<font color="#E5E5E5"> I don't think it would work</font>

389
00:15:00,589 --> 00:15:02,879
<font color="#E5E5E5">anywhere else in the world really due to</font>

390
00:15:01,970 --> 00:15:05,819
<font color="#CCCCCC">the form</font><font color="#E5E5E5"> factor</font>

391
00:15:02,879 --> 00:15:08,609
it's got RFID and it's got<font color="#E5E5E5"> bluetooth</font>

392
00:15:05,819 --> 00:15:11,549
<font color="#CCCCCC">it's got a z-wave</font><font color="#E5E5E5"> the z-waves done via a</font>

393
00:15:08,609 --> 00:15:13,109
small module which<font color="#CCCCCC"> is mounted</font><font color="#E5E5E5"> in the top</font>

394
00:15:11,549 --> 00:15:14,549
of the lock up here so it's<font color="#CCCCCC"> just a</font>

395
00:15:13,109 --> 00:15:16,079
little<font color="#E5E5E5"> blue module it's got that device</font>

396
00:15:14,549 --> 00:15:18,119
<font color="#E5E5E5">specifically I said</font><font color="#CCCCCC"> on it you can change</font>

397
00:15:16,079 --> 00:15:20,339
<font color="#E5E5E5">that</font><font color="#CCCCCC"> for other devices</font><font color="#E5E5E5"> and use other</font>

398
00:15:18,119 --> 00:15:22,799
protocols<font color="#E5E5E5"> so it's not an issue with the</font>

399
00:15:20,339 --> 00:15:27,359
lock<font color="#CCCCCC"> it's with z-wave</font><font color="#E5E5E5"> so it's not really</font>

400
00:15:22,799 --> 00:15:31,199
a<font color="#E5E5E5"> problem with Yale so if we look at how</font>

401
00:15:27,359 --> 00:15:32,819
an<font color="#E5E5E5"> S naught no pairs what happens</font><font color="#CCCCCC"> if the</font>

402
00:15:31,199 --> 00:15:34,258
user<font color="#E5E5E5"> comes along</font><font color="#CCCCCC"> and they press add note</font>

403
00:15:32,819 --> 00:15:36,419
on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> control</font><font color="#E5E5E5"> you saw me press the Add</font>

404
00:15:34,259 --> 00:15:38,579
button<font color="#E5E5E5"> then what we do is we press a</font>

405
00:15:36,419 --> 00:15:40,619
button on the device<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> one it's a</font>

406
00:15:38,579 --> 00:15:42,539
triple click and then<font color="#E5E5E5"> it decides it's</font>

407
00:15:40,619 --> 00:15:43,949
going<font color="#CCCCCC"> to join</font><font color="#E5E5E5"> the network</font><font color="#CCCCCC"> it sends out</font>

408
00:15:42,539 --> 00:15:45,839
what's called its<font color="#E5E5E5"> node info</font><font color="#CCCCCC"> it's outs</font>

409
00:15:43,949 --> 00:15:48,868
<font color="#CCCCCC">I'm this</font><font color="#E5E5E5"> kind of device I support these</font>

410
00:15:45,839 --> 00:15:51,179
kind of functions<font color="#CCCCCC"> and</font><font color="#E5E5E5"> acknowledge goes</font>

411
00:15:48,869 --> 00:15:52,319
back the device get brought<font color="#E5E5E5"> into the</font>

412
00:15:51,179 --> 00:15:54,869
network and then<font color="#CCCCCC"> you get the key</font>

413
00:15:52,319 --> 00:15:56,429
exchange so that bit down there the

414
00:15:54,869 --> 00:15:58,049
security<font color="#E5E5E5"> scheme get security scheme</font>

415
00:15:56,429 --> 00:16:02,249
<font color="#CCCCCC">report is where that</font><font color="#E5E5E5"> Keys exchange</font>

416
00:15:58,049 --> 00:16:04,499
<font color="#E5E5E5">that's that's how</font><font color="#CCCCCC"> I snore works st well</font>

417
00:16:02,249 --> 00:16:06,479
it starts out<font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> the same</font><font color="#E5E5E5"> it</font>

418
00:16:04,499 --> 00:16:08,729
does a node info it gets<font color="#E5E5E5"> assigned to</font><font color="#CCCCCC"> the</font>

419
00:16:06,479 --> 00:16:10,559
network<font color="#E5E5E5"> finds nodes in range and then</font>

420
00:16:08,729 --> 00:16:13,769
<font color="#E5E5E5">the actual key exchange is different</font>

421
00:16:10,559 --> 00:16:16,858
it's called a KX<font color="#E5E5E5"> now up until that point</font>

422
00:16:13,769 --> 00:16:19,109
<font color="#E5E5E5">those two of communications are almost</font>

423
00:16:16,859 --> 00:16:21,479
identical<font color="#CCCCCC"> exactly the same packets are</font>

424
00:16:19,109 --> 00:16:22,739
<font color="#E5E5E5">going backwards and</font><font color="#CCCCCC"> forward</font><font color="#E5E5E5"> the only two</font>

425
00:16:21,479 --> 00:16:24,329
things<font color="#E5E5E5"> they're actually</font><font color="#CCCCCC"> different are</font>

426
00:16:22,739 --> 00:16:26,519
these node<font color="#E5E5E5"> impose they're being sent</font>

427
00:16:24,329 --> 00:16:29,969
from<font color="#E5E5E5"> the device back to the controller</font>

428
00:16:26,519 --> 00:16:31,799
<font color="#CCCCCC">and if we look at</font><font color="#E5E5E5"> that in the sniffer</font>

429
00:16:29,970 --> 00:16:33,389
<font color="#E5E5E5">what it turns out is that the only thing</font>

430
00:16:31,799 --> 00:16:35,549
<font color="#CCCCCC">that's different</font><font color="#E5E5E5"> is at the bottom there</font>

431
00:16:33,389 --> 00:16:38,100
you can see how it says 9f<font color="#E5E5E5"> command class</font>

432
00:16:35,549 --> 00:16:40,829
security<font color="#CCCCCC"> - that means this device</font>

433
00:16:38,100 --> 00:16:43,019
supports<font color="#CCCCCC"> s2 security</font><font color="#E5E5E5"> the one above it</font>

434
00:16:40,829 --> 00:16:46,169
<font color="#E5E5E5">command class security means that it</font>

435
00:16:43,019 --> 00:16:48,419
supports that's norm<font color="#E5E5E5"> now that packets</font>

436
00:16:46,169 --> 00:16:50,579
not encrypted<font color="#E5E5E5"> that</font><font color="#CCCCCC"> packets not</font>

437
00:16:48,419 --> 00:16:53,789
authenticated<font color="#CCCCCC"> which means we can tamper</font>

438
00:16:50,579 --> 00:16:55,679
<font color="#E5E5E5">with it so</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> left hand side there</font>

439
00:16:53,789 --> 00:16:56,909
we've<font color="#CCCCCC"> got the</font><font color="#E5E5E5"> normal process and on the</font>

440
00:16:55,679 --> 00:16:59,389
right hand side I've<font color="#CCCCCC"> got what we call</font>

441
00:16:56,909 --> 00:17:01,139
<font color="#E5E5E5">the modified timing attack so</font>

442
00:16:59,389 --> 00:17:02,999
essentially this would<font color="#E5E5E5"> happen if the</font>

443
00:17:01,139 --> 00:17:05,250
user presses<font color="#CCCCCC"> the button on the device</font>

444
00:17:02,999 --> 00:17:08,100
rather<font color="#E5E5E5"> than the controller first so it</font>

445
00:17:05,250 --> 00:17:10,049
sends<font color="#E5E5E5"> out its node info we grab</font><font color="#CCCCCC"> it we</font>

446
00:17:08,099 --> 00:17:12,329
rebroadcast it as an attacker but

447
00:17:10,049 --> 00:17:14,780
<font color="#E5E5E5">modified we drop the support for s2</font>

448
00:17:12,329 --> 00:17:16,460
security so we<font color="#E5E5E5"> just remove that entire</font>

449
00:17:14,780 --> 00:17:19,730
the controller<font color="#CCCCCC"> you then</font><font color="#E5E5E5"> press the button</font>

450
00:17:16,460 --> 00:17:22,100
<font color="#CCCCCC">on</font><font color="#E5E5E5"> it it adds that node and in theory</font>

451
00:17:19,730 --> 00:17:26,060
<font color="#E5E5E5">you should pair that device with s</font><font color="#CCCCCC"> nor</font>

452
00:17:22,099 --> 00:17:27,439
run<font color="#CCCCCC"> s to security and just close up of</font>

453
00:17:26,060 --> 00:17:28,760
how that<font color="#E5E5E5"> works</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> this sounds</font>

454
00:17:27,440 --> 00:17:30,740
<font color="#E5E5E5">ridiculous but the</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> reason we</font>

455
00:17:28,760 --> 00:17:32,330
uncovered this was we found there<font color="#CCCCCC"> was</font>

456
00:17:30,740 --> 00:17:34,370
certain devices<font color="#E5E5E5"> when you put the battery</font>

457
00:17:32,330 --> 00:17:36,439
<font color="#CCCCCC">into them first</font>

458
00:17:34,370 --> 00:17:38,149
it broadcasts the<font color="#E5E5E5"> node</font><font color="#CCCCCC"> info so you don't</font>

459
00:17:36,440 --> 00:17:39,560
<font color="#E5E5E5">have to press the</font><font color="#CCCCCC"> button so you could</font>

460
00:17:38,150 --> 00:17:41,420
<font color="#CCCCCC">just put the battery into a device when</font>

461
00:17:39,560 --> 00:17:43,460
you're<font color="#CCCCCC"> pairing it it would broadcast</font><font color="#E5E5E5"> the</font>

462
00:17:41,420 --> 00:17:45,730
node<font color="#E5E5E5"> info and as an attacker</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

463
00:17:43,460 --> 00:17:47,890
grab<font color="#E5E5E5"> that packet and then retransmit it</font>

464
00:17:45,730 --> 00:17:51,500
<font color="#E5E5E5">the other one</font><font color="#CCCCCC"> that we were working</font><font color="#E5E5E5"> on</font>

465
00:17:47,890 --> 00:17:53,390
<font color="#E5E5E5">was a reactive jamming attack so this is</font>

466
00:17:51,500 --> 00:17:56,000
a bit different<font color="#E5E5E5"> here as the node info</font>

467
00:17:53,390 --> 00:17:57,890
<font color="#E5E5E5">sent</font><font color="#CCCCCC"> we'd then</font><font color="#E5E5E5"> jam</font><font color="#CCCCCC"> it halfway</font><font color="#E5E5E5"> through</font>

468
00:17:56,000 --> 00:18:00,470
<font color="#CCCCCC">that packet we'd receive the part of the</font>

469
00:17:57,890 --> 00:18:02,030
packet we need at the<font color="#CCCCCC"> beginning we then</font>

470
00:18:00,470 --> 00:18:03,410
start jamming it<font color="#CCCCCC"> so the controller</font>

471
00:18:02,030 --> 00:18:05,149
didn't receive<font color="#CCCCCC"> it we only</font><font color="#E5E5E5"> have to flip</font>

472
00:18:03,410 --> 00:18:07,720
one bit in the packet because<font color="#CCCCCC"> it's got a</font>

473
00:18:05,150 --> 00:18:11,840
<font color="#E5E5E5">CRC check sum on</font><font color="#CCCCCC"> the end of it now</font>

474
00:18:07,720 --> 00:18:14,240
<font color="#CCCCCC">that's probably</font><font color="#E5E5E5"> possible the way we're</font>

475
00:18:11,840 --> 00:18:16,129
using this RF<font color="#E5E5E5"> cut device it has to</font>

476
00:18:14,240 --> 00:18:17,900
receive an entire packet before<font color="#E5E5E5"> the</font>

477
00:18:16,130 --> 00:18:20,630
<font color="#E5E5E5">computers aware of the data so there's</font>

478
00:18:17,900 --> 00:18:22,340
no way<font color="#E5E5E5"> to easily reactively</font><font color="#CCCCCC"> Jam so we</font>

479
00:18:20,630 --> 00:18:26,690
have<font color="#E5E5E5"> actually got this one working but</font>

480
00:18:22,340 --> 00:18:27,980
it's<font color="#E5E5E5"> conceptually possible now you think</font>

481
00:18:26,690 --> 00:18:29,630
why do we actually<font color="#E5E5E5"> have to receive this</font>

482
00:18:27,980 --> 00:18:31,760
data<font color="#E5E5E5"> why do we have to know what that</font>

483
00:18:29,630 --> 00:18:34,280
data<font color="#E5E5E5"> is to</font><font color="#CCCCCC"> retransmit it</font><font color="#E5E5E5"> and the reason</font>

484
00:18:31,760 --> 00:18:35,540
is is this is a device broadcasting<font color="#CCCCCC"> its</font>

485
00:18:34,280 --> 00:18:37,879
first node info now<font color="#E5E5E5"> you'll see its</font>

486
00:18:35,540 --> 00:18:40,389
source it's address<font color="#CCCCCC"> is 0</font><font color="#E5E5E5"> and it's</font>

487
00:18:37,880 --> 00:18:44,300
sending<font color="#E5E5E5"> it to 255 like with most</font>

488
00:18:40,390 --> 00:18:46,250
protocols 255 is the broadcast<font color="#E5E5E5"> address</font>

489
00:18:44,300 --> 00:18:48,220
<font color="#CCCCCC">so sending it from</font><font color="#E5E5E5"> an unassigned address</font>

490
00:18:46,250 --> 00:18:51,470
to a broadcast<font color="#E5E5E5"> address shouting I'm here</font>

491
00:18:48,220 --> 00:18:53,980
<font color="#CCCCCC">pair me</font><font color="#E5E5E5"> into your network the home ID is</font>

492
00:18:51,470 --> 00:18:57,410
a<font color="#CCCCCC"> unique identifier for a device</font>

493
00:18:53,980 --> 00:18:59,900
unpaired<font color="#E5E5E5"> or your network</font><font color="#CCCCCC"> now it's got a</font>

494
00:18:57,410 --> 00:19:02,330
<font color="#E5E5E5">random home ID when</font><font color="#CCCCCC"> it's first being</font>

495
00:18:59,900 --> 00:19:05,090
paired<font color="#CCCCCC"> it's randomly generated</font><font color="#E5E5E5"> you can</font>

496
00:19:02,330 --> 00:19:06,889
<font color="#E5E5E5">see here</font><font color="#CCCCCC"> f1 starting there as it gets</font>

497
00:19:05,090 --> 00:19:09,439
brought<font color="#E5E5E5"> into the network it changes to</font>

498
00:19:06,890 --> 00:19:11,660
c1 which<font color="#E5E5E5"> is my genuine home ID so we</font>

499
00:19:09,440 --> 00:19:13,730
<font color="#CCCCCC">have to grab that home ID to then re</font>

500
00:19:11,660 --> 00:19:17,000
<font color="#E5E5E5">transmit the node info packet otherwise</font>

501
00:19:13,730 --> 00:19:19,160
the attack<font color="#E5E5E5"> won't work now I'm going to</font>

502
00:19:17,000 --> 00:19:23,180
demo this and it may or may<font color="#CCCCCC"> not work</font>

503
00:19:19,160 --> 00:19:26,690
<font color="#CCCCCC">let's see how it goes right I've got a</font>

504
00:19:23,180 --> 00:19:27,900
video<font color="#E5E5E5"> if it doesn't work anyway so what</font>

505
00:19:26,690 --> 00:19:30,120
we have<font color="#CCCCCC"> here</font>

506
00:19:27,900 --> 00:19:32,550
the z-wave controller<font color="#CCCCCC"> at the moment it</font>

507
00:19:30,120 --> 00:19:33,479
<font color="#E5E5E5">has the s</font><font color="#CCCCCC"> not device and I'm what I'm</font>

508
00:19:32,550 --> 00:19:37,350
going to do is I'm going<font color="#CCCCCC"> to pair the</font>

509
00:19:33,480 --> 00:19:41,700
lock as an<font color="#CCCCCC"> s2 note first</font><font color="#E5E5E5"> so this should</font>

510
00:19:37,350 --> 00:19:46,110
work<font color="#CCCCCC"> I press add</font><font color="#E5E5E5"> triple click the button</font>

511
00:19:41,700 --> 00:19:48,000
<font color="#E5E5E5">on the back then this should prompt me</font><font color="#CCCCCC"> I</font>

512
00:19:46,110 --> 00:19:49,949
want to add it is an s2 device it will

513
00:19:48,000 --> 00:19:57,630
<font color="#CCCCCC">ask</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> for the device specific key which</font>

514
00:19:49,950 --> 00:19:58,800
is<font color="#CCCCCC"> 2 1 0</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> know was it 2 0 1 0 2 and if</font>

515
00:19:57,630 --> 00:20:02,130
you<font color="#E5E5E5"> don't get this done quickly enough</font>

516
00:19:58,800 --> 00:20:07,100
it<font color="#E5E5E5"> times out and</font><font color="#CCCCCC"> adds</font><font color="#E5E5E5"> as no security so</font>

517
00:20:02,130 --> 00:20:10,380
we'll see if this<font color="#E5E5E5"> works if I missed it</font>

518
00:20:07,100 --> 00:20:12,480
like it's going<font color="#E5E5E5"> through so you can see</font>

519
00:20:10,380 --> 00:20:14,820
<font color="#CCCCCC">there</font><font color="#E5E5E5"> up at the top</font><font color="#CCCCCC"> it's a bit small</font>

520
00:20:12,480 --> 00:20:16,680
it's showing as<font color="#CCCCCC"> s2 so it's been paired</font>

521
00:20:14,820 --> 00:20:18,480
as an s2 device we<font color="#E5E5E5"> can now come on that</font>

522
00:20:16,680 --> 00:20:21,150
lock<font color="#CCCCCC"> so we go through to the command</font>

523
00:20:18,480 --> 00:20:26,850
classes come down here to the supported

524
00:20:21,150 --> 00:20:33,630
command classes of the device and what

525
00:20:26,850 --> 00:20:39,030
if we got door lock door operation set

526
00:20:33,630 --> 00:20:42,980
door unsecured and if I press send<font color="#E5E5E5"> it's</font>

527
00:20:39,030 --> 00:20:42,980
already unlocked<font color="#E5E5E5"> so let's try locking it</font>

528
00:20:45,440 --> 00:20:49,680
so you can see how we've got<font color="#CCCCCC"> control of</font>

529
00:20:47,580 --> 00:20:50,399
the lock through<font color="#E5E5E5"> the controller now what</font>

530
00:20:49,680 --> 00:20:52,650
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do is we're going to</font>

531
00:20:50,400 --> 00:20:54,690
remove<font color="#CCCCCC"> that node</font><font color="#E5E5E5"> so to remove a node</font>

532
00:20:52,650 --> 00:20:55,560
you've got to actively press it we

533
00:20:54,690 --> 00:20:57,390
haven't<font color="#E5E5E5"> found a way of the</font>

534
00:20:55,560 --> 00:21:00,330
authenticating nodes or breaking<font color="#E5E5E5"> them</font>

535
00:20:57,390 --> 00:21:02,100
out of the network<font color="#E5E5E5"> yet so that's now</font>

536
00:21:00,330 --> 00:21:03,210
removed from<font color="#E5E5E5"> the network now what I'm</font>

537
00:21:02,100 --> 00:21:05,520
going<font color="#CCCCCC"> to do is going to listen</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> that</font>

538
00:21:03,210 --> 00:21:08,670
<font color="#E5E5E5">node in froze it gets sent and I'm going</font>

539
00:21:05,520 --> 00:21:17,700
to retransmit<font color="#CCCCCC"> it as an</font><font color="#E5E5E5"> S</font><font color="#CCCCCC"> Nord device so</font>

540
00:21:08,670 --> 00:21:19,680
if we just restart<font color="#E5E5E5"> the sniffer get ready</font>

541
00:21:17,700 --> 00:21:20,420
to press add<font color="#E5E5E5"> so what I'm going to do is</font>

542
00:21:19,680 --> 00:21:23,160
I'm going<font color="#CCCCCC"> to do it in the wrong order</font>

543
00:21:20,420 --> 00:21:24,870
<font color="#CCCCCC">the actual scripts running</font><font color="#E5E5E5"> on this</font>

544
00:21:23,160 --> 00:21:26,070
laptop<font color="#CCCCCC"> there's nothing hidden you can</font>

545
00:21:24,870 --> 00:21:27,949
come to see you later on I'm<font color="#CCCCCC"> not doing</font>

546
00:21:26,070 --> 00:21:32,909
any trickery or<font color="#E5E5E5"> anything like that so</font>

547
00:21:27,950 --> 00:21:35,310
<font color="#CCCCCC">it's listening now</font><font color="#E5E5E5"> I triple click wait</font>

548
00:21:32,910 --> 00:21:39,900
for it to send a broadcast packet press

549
00:21:35,310 --> 00:21:41,260
<font color="#E5E5E5">add that's just resent it and you should</font>

550
00:21:39,900 --> 00:21:45,799
see in a second

551
00:21:41,260 --> 00:21:47,690
if it works<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see at the top there</font>

552
00:21:45,799 --> 00:21:49,879
<font color="#CCCCCC">s naught secure key padlock</font>

553
00:21:47,690 --> 00:21:50,840
so we<font color="#CCCCCC"> downgraded that pairing</font><font color="#E5E5E5"> notice I</font>

554
00:21:49,880 --> 00:21:52,669
didn't have to enter the<font color="#CCCCCC"> device-specific</font>

555
00:21:50,840 --> 00:21:54,168
<font color="#CCCCCC">key I didn't have to answering those</font>

556
00:21:52,669 --> 00:21:56,809
questions<font color="#CCCCCC"> but I haven't</font><font color="#E5E5E5"> done anything</font>

557
00:21:54,169 --> 00:21:58,340
<font color="#E5E5E5">differently now the thing</font><font color="#CCCCCC"> is the locks</font>

558
00:21:56,809 --> 00:22:00,260
not<font color="#CCCCCC"> mentioned this the locks not</font><font color="#E5E5E5"> got a</font>

559
00:21:58,340 --> 00:22:02,870
red<font color="#CCCCCC"> LED on it saying I've paired with s</font>

560
00:22:00,260 --> 00:22:04,640
not security<font color="#E5E5E5"> run this - it's got one LED</font>

561
00:22:02,870 --> 00:22:06,080
and a buzzer on it that's it<font color="#E5E5E5"> there's no</font>

562
00:22:04,640 --> 00:22:08,809
user interface<font color="#E5E5E5"> so it's really difficult</font>

563
00:22:06,080 --> 00:22:10,908
<font color="#CCCCCC">for</font><font color="#E5E5E5"> the for them to do that</font><font color="#CCCCCC"> and we can</font>

564
00:22:08,809 --> 00:22:12,710
<font color="#CCCCCC">go through to here</font><font color="#E5E5E5"> and because we've got</font>

565
00:22:10,909 --> 00:22:15,200
that security<font color="#E5E5E5"> message encapsulation</font><font color="#CCCCCC"> we</font>

566
00:22:12,710 --> 00:22:17,380
can press decrypt<font color="#E5E5E5"> for the keys in of all</font>

567
00:22:15,200 --> 00:22:21,260
<font color="#CCCCCC">0</font><font color="#E5E5E5"> Oh</font>

568
00:22:17,380 --> 00:22:26,000
what<font color="#E5E5E5"> happened there</font><font color="#CCCCCC"> Ivan</font><font color="#E5E5E5"> teeth soon so</font>

569
00:22:21,260 --> 00:22:27,710
if we go to this<font color="#CCCCCC"> one here this would be</font>

570
00:22:26,000 --> 00:22:28,850
crypt<font color="#E5E5E5"> at all zeros yeah it's already</font>

571
00:22:27,710 --> 00:22:30,710
<font color="#E5E5E5">done it with all</font><font color="#CCCCCC"> zeros so we've got the</font>

572
00:22:28,850 --> 00:22:34,120
<font color="#E5E5E5">network here and by sniffing it so</font>

573
00:22:30,710 --> 00:22:34,120
that's what that tax allowed us to<font color="#E5E5E5"> do</font>

574
00:22:35,380 --> 00:22:40,669
right<font color="#E5E5E5"> I'll skip over the video</font><font color="#CCCCCC"> cuz it</font>

575
00:22:37,730 --> 00:22:41,630
worked<font color="#CCCCCC"> so what's the impact</font><font color="#E5E5E5"> of this now</font>

576
00:22:40,669 --> 00:22:43,940
this<font color="#E5E5E5"> is kind of where it gets</font>

577
00:22:41,630 --> 00:22:45,830
interesting to me<font color="#E5E5E5"> and it talks quite</font>

578
00:22:43,940 --> 00:22:47,210
simple yet admit that's not<font color="#E5E5E5"> there's no</font>

579
00:22:45,830 --> 00:22:48,799
cryptography involved<font color="#CCCCCC"> there all I'm</font>

580
00:22:47,210 --> 00:22:51,169
doing is<font color="#CCCCCC"> just sending</font><font color="#E5E5E5"> a packets modified</font>

581
00:22:48,799 --> 00:22:53,120
<font color="#E5E5E5">and one of the problems is once</font><font color="#CCCCCC"> that s</font>

582
00:22:51,169 --> 00:22:54,710
not keys been compromised<font color="#CCCCCC"> I've got the s</font>

583
00:22:53,120 --> 00:22:57,500
not key for all of the devices<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your</font>

584
00:22:54,710 --> 00:23:01,490
house now I looked at a poll on a forum

585
00:22:57,500 --> 00:23:03,590
for<font color="#CCCCCC"> a home</font><font color="#E5E5E5"> automation</font><font color="#CCCCCC"> piece of software</font>

586
00:23:01,490 --> 00:23:05,360
<font color="#E5E5E5">and it seems that most people he put</font>

587
00:23:03,590 --> 00:23:08,090
z-wave in the house have got more than

588
00:23:05,360 --> 00:23:09,620
<font color="#CCCCCC">30 devices now if you want to repair</font>

589
00:23:08,090 --> 00:23:11,570
those devices<font color="#E5E5E5"> and change the key on your</font>

590
00:23:09,620 --> 00:23:13,459
network for nearly<font color="#CCCCCC"> all of</font><font color="#E5E5E5"> them</font>

591
00:23:11,570 --> 00:23:16,158
you've got to manually<font color="#E5E5E5"> go to that device</font>

592
00:23:13,460 --> 00:23:17,779
<font color="#E5E5E5">and press</font><font color="#CCCCCC"> a button on them</font><font color="#E5E5E5"> now that can</font>

593
00:23:16,159 --> 00:23:19,100
be<font color="#E5E5E5"> a bit of a</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> you know if you're</font>

594
00:23:17,779 --> 00:23:22,429
<font color="#E5E5E5">having to climb up ladders remove</font>

595
00:23:19,100 --> 00:23:23,600
switches from your walls<font color="#E5E5E5"> and dig things</font>

596
00:23:22,429 --> 00:23:25,549
up you<font color="#CCCCCC"> know it's</font><font color="#E5E5E5"> going to be a problem</font>

597
00:23:23,600 --> 00:23:28,399
<font color="#E5E5E5">so changing those keys it's not</font>

598
00:23:25,549 --> 00:23:30,230
<font color="#E5E5E5">supported the thing is people said why</font>

599
00:23:28,399 --> 00:23:32,178
didn't you just downgrade<font color="#E5E5E5"> to no security</font>

600
00:23:30,230 --> 00:23:35,059
rather than downgrade to s naught

601
00:23:32,179 --> 00:23:37,250
security if we look<font color="#CCCCCC"> in</font><font color="#E5E5E5"> existing network</font>

602
00:23:35,059 --> 00:23:39,049
<font color="#E5E5E5">so we've got an S</font><font color="#CCCCCC"> not door lock and it's</font>

603
00:23:37,250 --> 00:23:41,360
not light bulb<font color="#E5E5E5"> and some sprinklers on no</font>

604
00:23:39,049 --> 00:23:43,639
security if I walk up to<font color="#E5E5E5"> the house all I</font>

605
00:23:41,360 --> 00:23:46,399
can do is access the<font color="#E5E5E5"> sprinklers that's</font>

606
00:23:43,640 --> 00:23:50,690
it nothing<font color="#E5E5E5"> else now if I bring</font><font color="#CCCCCC"> a new</font>

607
00:23:46,399 --> 00:23:52,678
device in and it pairs is s<font color="#CCCCCC"> to all I can</font>

608
00:23:50,690 --> 00:23:55,230
get access<font color="#CCCCCC"> to still is those spring</font>

609
00:23:52,679 --> 00:23:58,200
I can't get the key from them if<font color="#E5E5E5"> I</font>

610
00:23:55,230 --> 00:23:59,580
downgrade<font color="#CCCCCC"> that</font><font color="#E5E5E5"> to no security all I have</font>

611
00:23:58,200 --> 00:24:01,889
access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> is the heating</font><font color="#E5E5E5"> and the</font>

612
00:23:59,580 --> 00:24:04,590
sprinklers<font color="#CCCCCC"> but if I downgrade it to s</font>

613
00:24:01,889 --> 00:24:06,809
naught security<font color="#CCCCCC"> I have access to the</font>

614
00:24:04,590 --> 00:24:08,879
<font color="#E5E5E5">entire network</font><font color="#CCCCCC"> it would</font><font color="#E5E5E5"> only be the s</font>

615
00:24:06,809 --> 00:24:10,320
<font color="#CCCCCC">two devices I don't have</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> to so</font>

616
00:24:08,879 --> 00:24:15,418
<font color="#E5E5E5">that's why we went</font><font color="#CCCCCC"> for that downgrade</font>

617
00:24:10,320 --> 00:24:18,450
from<font color="#E5E5E5"> s 2 to</font><font color="#CCCCCC"> s naught so what about the</font>

618
00:24:15,419 --> 00:24:20,190
likelihood<font color="#E5E5E5"> now</font><font color="#CCCCCC"> I don't know why this got</font>

619
00:24:18,450 --> 00:24:22,679
into the press<font color="#CCCCCC"> big-time there were loads</font>

620
00:24:20,190 --> 00:24:25,289
of articles<font color="#E5E5E5"> you know the register</font><font color="#CCCCCC"> I</font>

621
00:24:22,679 --> 00:24:26,940
can't<font color="#E5E5E5"> remember all of them and got into</font>

622
00:24:25,289 --> 00:24:28,980
home automation magazines things like

623
00:24:26,940 --> 00:24:31,320
that and the coverage wasn't necessarily

624
00:24:28,980 --> 00:24:33,149
<font color="#E5E5E5">proportional to the risk the register</font>

625
00:24:31,320 --> 00:24:34,559
blown out of all proportion<font color="#E5E5E5"> whereas some</font>

626
00:24:33,149 --> 00:24:35,820
home automation magazines took it

627
00:24:34,559 --> 00:24:38,190
<font color="#E5E5E5">completely the other way saying it</font>

628
00:24:35,820 --> 00:24:39,899
<font color="#E5E5E5">wasn't really an attack so the first</font>

629
00:24:38,190 --> 00:24:42,119
thing that<font color="#CCCCCC"> scilab said to me was the</font>

630
00:24:39,899 --> 00:24:45,119
evil dude have to be 30 to 40 meters

631
00:24:42,119 --> 00:24:48,869
away and listening<font color="#E5E5E5"> now the thing is is</font>

632
00:24:45,119 --> 00:24:51,330
that<font color="#E5E5E5"> they stay openly that the range of</font>

633
00:24:48,869 --> 00:24:53,249
z-wave is 100 meters now I don't<font color="#E5E5E5"> know</font>

634
00:24:51,330 --> 00:24:54,990
<font color="#CCCCCC">about you but if the attack when you're</font>

635
00:24:53,249 --> 00:24:56,879
<font color="#E5E5E5">carrying out you can't say that the</font>

636
00:24:54,990 --> 00:24:58,139
range<font color="#E5E5E5"> is</font><font color="#CCCCCC"> 100 meters when it works but</font>

637
00:24:56,879 --> 00:25:01,199
when someone's<font color="#CCCCCC"> trying to attack it</font><font color="#E5E5E5"> it</font>

638
00:24:58,139 --> 00:25:03,090
drops down<font color="#E5E5E5"> to 30 or 40 meters</font><font color="#CCCCCC"> and the</font>

639
00:25:01,200 --> 00:25:05,070
thing is as an attacker<font color="#CCCCCC"> we don't have to</font>

640
00:25:03,090 --> 00:25:06,330
play<font color="#CCCCCC"> by the</font><font color="#E5E5E5"> rules this little module</font>

641
00:25:05,070 --> 00:25:08,789
here<font color="#E5E5E5"> there's probably got</font><font color="#CCCCCC"> 10 million</font>

642
00:25:06,330 --> 00:25:11,158
watts of output power if I can use a

643
00:25:08,789 --> 00:25:12,809
directional<font color="#CCCCCC"> antenna and</font><font color="#E5E5E5"> 500 milli watts</font>

644
00:25:11,159 --> 00:25:16,529
of power<font color="#CCCCCC"> I might be able</font><font color="#E5E5E5"> to do worse</font>

645
00:25:12,809 --> 00:25:18,990
<font color="#CCCCCC">things than a standard module so we</font>

646
00:25:16,529 --> 00:25:20,909
<font color="#CCCCCC">found that the radius</font><font color="#E5E5E5"> of attack was</font>

647
00:25:18,990 --> 00:25:23,100
definitely 10 meters there<font color="#E5E5E5"> used to be a</font>

648
00:25:20,909 --> 00:25:24,929
thing called<font color="#E5E5E5"> low power inclusion mode so</font>

649
00:25:23,100 --> 00:25:26,070
when we were pairing this device<font color="#CCCCCC"> into</font>

650
00:25:24,929 --> 00:25:28,230
our network it would transmit<font color="#CCCCCC"> of</font><font color="#E5E5E5"> low</font>

651
00:25:26,070 --> 00:25:30,029
power but<font color="#E5E5E5"> that's been deprecated so they</font>

652
00:25:28,230 --> 00:25:32,549
<font color="#E5E5E5">transmit with full power so</font><font color="#CCCCCC"> I'm going to</font>

653
00:25:30,029 --> 00:25:34,049
<font color="#E5E5E5">do it at 10 meters outside</font><font color="#CCCCCC"> a house now</font>

654
00:25:32,549 --> 00:25:36,840
we'd<font color="#CCCCCC"> probably manage to extend that</font><font color="#E5E5E5"> to</font>

655
00:25:34,049 --> 00:25:39,179
40 meters<font color="#CCCCCC"> I don't know we could possibly</font>

656
00:25:36,840 --> 00:25:41,459
<font color="#E5E5E5">get down to 100 meters it's still a</font>

657
00:25:39,179 --> 00:25:43,860
local attack though what's important<font color="#E5E5E5"> it</font>

658
00:25:41,460 --> 00:25:45,119
isn't a remote<font color="#CCCCCC"> TAC there's no way for me</font>

659
00:25:43,860 --> 00:25:47,789
<font color="#CCCCCC">to do this</font><font color="#E5E5E5"> from the</font><font color="#CCCCCC"> other side of the</font>

660
00:25:45,119 --> 00:25:50,369
world<font color="#E5E5E5"> I have to</font><font color="#CCCCCC"> be local too but</font><font color="#E5E5E5"> really</font>

661
00:25:47,789 --> 00:25:51,330
importantly it's<font color="#E5E5E5"> not so small</font><font color="#CCCCCC"> that we</font>

662
00:25:50,369 --> 00:25:53,070
wouldn't<font color="#E5E5E5"> be able to do it without</font>

663
00:25:51,330 --> 00:25:54,928
entering someone's property<font color="#E5E5E5"> so they're</font>

664
00:25:53,070 --> 00:25:57,539
trying to downplay this range<font color="#E5E5E5"> aspect of</font>

665
00:25:54,929 --> 00:25:59,340
it the<font color="#E5E5E5"> next song is they said an</font>

666
00:25:57,539 --> 00:26:01,679
attacker would need to<font color="#E5E5E5"> know the precise</font>

667
00:25:59,340 --> 00:26:02,560
20 millisecond window when you were

668
00:26:01,679 --> 00:26:05,680
doing<font color="#E5E5E5"> the pairing</font>

669
00:26:02,560 --> 00:26:07,540
<font color="#E5E5E5">it's I just</font><font color="#CCCCCC"> I just don't get this now</font>

670
00:26:05,680 --> 00:26:09,570
<font color="#E5E5E5">this got repeated again and again by</font>

671
00:26:07,540 --> 00:26:12,280
someone high up in the<font color="#E5E5E5"> company</font><font color="#CCCCCC"> and</font>

672
00:26:09,570 --> 00:26:14,860
<font color="#E5E5E5">another thing is it doesn't really</font>

673
00:26:12,280 --> 00:26:16,570
<font color="#E5E5E5">matter if the</font><font color="#CCCCCC"> pairings</font><font color="#E5E5E5"> really short</font><font color="#CCCCCC"> and</font>

674
00:26:14,860 --> 00:26:18,550
happens three<font color="#CCCCCC"> times and we're there for</font>

675
00:26:16,570 --> 00:26:20,560
<font color="#CCCCCC">that duration</font><font color="#E5E5E5"> of time</font><font color="#CCCCCC"> we'll here it will</font>

676
00:26:18,550 --> 00:26:24,010
<font color="#E5E5E5">be add to uncover it if it takes longer</font>

677
00:26:20,560 --> 00:26:25,510
<font color="#E5E5E5">we'll uncover in reality if we're there</font>

678
00:26:24,010 --> 00:26:27,430
<font color="#E5E5E5">for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> shorter period</font><font color="#CCCCCC"> of time the pairing</font>

679
00:26:25,510 --> 00:26:28,870
actually takes longer<font color="#CCCCCC"> there's less of</font><font color="#E5E5E5"> a</font>

680
00:26:27,430 --> 00:26:31,720
chance<font color="#CCCCCC"> of us being able to successfully</font>

681
00:26:28,870 --> 00:26:33,580
<font color="#E5E5E5">capture</font><font color="#CCCCCC"> a pairing so the duration of</font><font color="#E5E5E5"> it</font>

682
00:26:31,720 --> 00:26:35,950
doesn't<font color="#E5E5E5"> matter what matters is the</font>

683
00:26:33,580 --> 00:26:38,199
<font color="#E5E5E5">frequency you don't pair nodes into your</font>

684
00:26:35,950 --> 00:26:39,400
network<font color="#E5E5E5"> that's often so if you don't if</font>

685
00:26:38,200 --> 00:26:41,080
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> not there for a pairing you're</font>

686
00:26:39,400 --> 00:26:42,970
not going<font color="#E5E5E5"> to get the key</font><font color="#CCCCCC"> so I don't know</font>

687
00:26:41,080 --> 00:26:45,760
why they said<font color="#CCCCCC"> that the frequent do the</font>

688
00:26:42,970 --> 00:26:47,110
duration matters the next song is this

689
00:26:45,760 --> 00:26:48,760
<font color="#E5E5E5">one's a really</font><font color="#CCCCCC"> cool one</font><font color="#E5E5E5"> specialist</font>

690
00:26:47,110 --> 00:26:50,290
<font color="#E5E5E5">equipments required I'm sure some</font><font color="#CCCCCC"> of you</font>

691
00:26:48,760 --> 00:26:53,710
use<font color="#CCCCCC"> SDR things like that they said</font>

692
00:26:50,290 --> 00:26:56,080
<font color="#E5E5E5">specialist equipments required and well</font>

693
00:26:53,710 --> 00:26:58,810
it's a yardstick one which now<font color="#E5E5E5"> you can</font>

694
00:26:56,080 --> 00:27:00,159
buy off Amazon<font color="#E5E5E5"> for just under 120 pounds</font>

695
00:26:58,810 --> 00:27:03,820
and<font color="#CCCCCC"> turns up</font><font color="#E5E5E5"> on your door the next day</font>

696
00:27:00,160 --> 00:27:06,970
<font color="#CCCCCC">and don't laugh at my code</font><font color="#E5E5E5"> it's really</font>

697
00:27:03,820 --> 00:27:08,139
bad<font color="#E5E5E5"> but the code it's maybe</font><font color="#CCCCCC"> 90 lines of</font>

698
00:27:06,970 --> 00:27:09,490
Python that's it

699
00:27:08,140 --> 00:27:11,890
I mean it doesn't<font color="#CCCCCC"> work in all situations</font>

700
00:27:09,490 --> 00:27:14,520
but<font color="#E5E5E5"> it's a script anyone can run it plug</font>

701
00:27:11,890 --> 00:27:16,840
the device into a laptop<font color="#CCCCCC"> run the script</font>

702
00:27:14,520 --> 00:27:18,370
the next song is attacker must be in

703
00:27:16,840 --> 00:27:20,290
range at<font color="#E5E5E5"> the time of the attack now this</font>

704
00:27:18,370 --> 00:27:22,270
we get this one again<font color="#CCCCCC"> and again I</font><font color="#E5E5E5"> don't</font>

705
00:27:20,290 --> 00:27:24,580
<font color="#E5E5E5">know why but with physical attack people</font>

706
00:27:22,270 --> 00:27:29,370
assume you have to be stood outside<font color="#E5E5E5"> the</font>

707
00:27:24,580 --> 00:27:33,060
house<font color="#E5E5E5"> now this this was awful so we</font>

708
00:27:29,370 --> 00:27:36,100
blogged about using the yardstick<font color="#CCCCCC"> one to</font>

709
00:27:33,060 --> 00:27:38,169
disable and<font color="#E5E5E5"> jam burglar alarms and</font>

710
00:27:36,100 --> 00:27:39,820
there's a lot consumer burglar alarms

711
00:27:38,170 --> 00:27:40,990
<font color="#E5E5E5">that</font><font color="#CCCCCC"> are vulnerable</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> that and I don't</font>

712
00:27:39,820 --> 00:27:43,570
<font color="#E5E5E5">know how</font><font color="#CCCCCC"> many of</font><font color="#E5E5E5"> you know about the</font>

713
00:27:40,990 --> 00:27:46,120
<font color="#E5E5E5">Daily Mail and it's not exactly</font><font color="#CCCCCC"> the most</font>

714
00:27:43,570 --> 00:27:48,129
balanced newspaper<font color="#E5E5E5"> and but essentially</font>

715
00:27:46,120 --> 00:27:51,429
they took<font color="#CCCCCC"> our story</font><font color="#E5E5E5"> went and bought</font>

716
00:27:48,130 --> 00:27:53,530
yardstick<font color="#CCCCCC"> one off of</font><font color="#E5E5E5"> Amazon</font><font color="#CCCCCC"> and then</font>

717
00:27:51,430 --> 00:27:57,280
made a guy in a hoodie stand<font color="#E5E5E5"> outside</font>

718
00:27:53,530 --> 00:27:58,899
someone's house with the laptop<font color="#E5E5E5"> and they</font>

719
00:27:57,280 --> 00:28:00,040
they weren't focusing on the burglar

720
00:27:58,900 --> 00:28:01,390
alarm being<font color="#CCCCCC"> fined</font><font color="#E5E5E5"> report they were</font>

721
00:28:00,040 --> 00:28:03,639
focusing on<font color="#E5E5E5"> the fact that Amazon was</font>

722
00:28:01,390 --> 00:28:05,440
selling this<font color="#CCCCCC"> tool the comments are all</font>

723
00:28:03,640 --> 00:28:10,080
just like must pull these off the market

724
00:28:05,440 --> 00:28:14,050
immediately<font color="#E5E5E5"> and it got worse as well now</font>

725
00:28:10,080 --> 00:28:15,970
we do a lot of work with cars<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's</font>

726
00:28:14,050 --> 00:28:17,470
a hack<font color="#CCCCCC"> RF on there</font><font color="#E5E5E5"> and they wrote</font>

727
00:28:15,970 --> 00:28:19,870
another article<font color="#CCCCCC"> about the hack RF and</font>

728
00:28:17,470 --> 00:28:22,060
how awful it was<font color="#E5E5E5"> and now that hacker if</font>

729
00:28:19,870 --> 00:28:24,580
I don't things even plugged<font color="#E5E5E5"> in and I</font>

730
00:28:22,060 --> 00:28:26,560
<font color="#E5E5E5">just I just find this idea of walking</font>

731
00:28:24,580 --> 00:28:28,659
<font color="#CCCCCC">around to the laptop doing this bizarre</font>

732
00:28:26,560 --> 00:28:30,129
it's a Raspberry Pi<font color="#E5E5E5"> with the yardstick</font>

733
00:28:28,660 --> 00:28:31,960
<font color="#E5E5E5">one plugged into it with the battery</font>

734
00:28:30,130 --> 00:28:33,820
pack<font color="#E5E5E5"> inside the box that's all you need</font>

735
00:28:31,960 --> 00:28:36,100
for<font color="#E5E5E5"> the attack</font><font color="#CCCCCC"> you could put</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> behind</font>

736
00:28:33,820 --> 00:28:37,689
someone's<font color="#CCCCCC"> hedge</font><font color="#E5E5E5"> walk away you don't have</font>

737
00:28:36,100 --> 00:28:42,040
to be sat outside<font color="#E5E5E5"> the person's house in</font>

738
00:28:37,690 --> 00:28:45,760
a<font color="#E5E5E5"> hoodie looking shady as the</font>

739
00:28:42,040 --> 00:28:47,889
marketing versus reality<font color="#E5E5E5"> now this is</font>

740
00:28:45,760 --> 00:28:49,450
<font color="#E5E5E5">kind of where what we realized was</font>

741
00:28:47,890 --> 00:28:52,180
z-wave we're trying to pitch this<font color="#E5E5E5"> s/t</font>

742
00:28:49,450 --> 00:28:54,970
solution as required<font color="#E5E5E5"> they were trying to</font>

743
00:28:52,180 --> 00:28:57,100
say<font color="#CCCCCC"> s2</font><font color="#E5E5E5"> Security's needed because you</font>

744
00:28:54,970 --> 00:28:59,230
secure<font color="#E5E5E5"> that inclusion</font><font color="#CCCCCC"> process you can't</font>

745
00:28:57,100 --> 00:29:01,389
get the keys that<font color="#CCCCCC"> elevates them above</font>

746
00:28:59,230 --> 00:29:03,730
<font color="#CCCCCC">ZigBee where ZigBee Alliance o.9 allows</font>

747
00:29:01,390 --> 00:29:06,250
you to grab the<font color="#E5E5E5"> keys and so what they</font>

748
00:29:03,730 --> 00:29:08,170
said was<font color="#CCCCCC"> the Alliance Board of Directors</font>

749
00:29:06,250 --> 00:29:10,990
voted to<font color="#E5E5E5"> make the implementation</font><font color="#CCCCCC"> the new</font>

750
00:29:08,170 --> 00:29:14,470
security s2 standard framework<font color="#E5E5E5"> mandatory</font>

751
00:29:10,990 --> 00:29:15,880
for<font color="#CCCCCC"> all products from April 2017</font><font color="#E5E5E5"> so they</font>

752
00:29:14,470 --> 00:29:19,330
said it's got to be mandatory<font color="#E5E5E5"> it's in</font>

753
00:29:15,880 --> 00:29:22,480
all<font color="#CCCCCC"> product on the date on the</font><font color="#E5E5E5"> 2nd</font><font color="#CCCCCC"> of</font>

754
00:29:19,330 --> 00:29:24,490
April they said that from<font color="#E5E5E5"> that date it's</font>

755
00:29:22,480 --> 00:29:26,850
a strict and uniform adoption of a new

756
00:29:24,490 --> 00:29:30,580
<font color="#CCCCCC">security protocol for</font><font color="#E5E5E5"> all devices and</font>

757
00:29:26,850 --> 00:29:34,149
well what it turns out<font color="#E5E5E5"> is that so far</font>

758
00:29:30,580 --> 00:29:36,189
<font color="#CCCCCC">removed from reality</font><font color="#E5E5E5"> and this is a lock</font>

759
00:29:34,150 --> 00:29:38,200
module<font color="#E5E5E5"> I've not picked this company for</font>

760
00:29:36,190 --> 00:29:40,240
<font color="#E5E5E5">any particular reason</font><font color="#CCCCCC"> and off the</font>

761
00:29:38,200 --> 00:29:41,800
certification site<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> see the</font>

762
00:29:40,240 --> 00:29:44,730
certification date there is the end of

763
00:29:41,800 --> 00:29:47,560
April<font color="#E5E5E5"> of this year not 2017 this year</font>

764
00:29:44,730 --> 00:29:51,580
now we go drill into<font color="#E5E5E5"> that and we can</font><font color="#CCCCCC"> see</font>

765
00:29:47,560 --> 00:29:53,980
support security<font color="#E5E5E5"> s to know now that's</font>

766
00:29:51,580 --> 00:29:55,570
obviously<font color="#E5E5E5"> quite bad homes here is a</font>

767
00:29:53,980 --> 00:29:58,300
common piece of home automation<font color="#E5E5E5"> software</font>

768
00:29:55,570 --> 00:30:00,820
that deals with z-wave<font color="#E5E5E5"> they can see here</font>

769
00:29:58,300 --> 00:30:02,800
they say any new device released after

770
00:30:00,820 --> 00:30:05,830
<font color="#E5E5E5">April the second twin 70 must support s2</font>

771
00:30:02,800 --> 00:30:08,139
<font color="#CCCCCC">there are</font><font color="#E5E5E5"> exceptions code space in the</font>

772
00:30:05,830 --> 00:30:09,250
500 series<font color="#CCCCCC"> zero chip is limited</font><font color="#E5E5E5"> so what</font>

773
00:30:08,140 --> 00:30:10,990
they're saying<font color="#CCCCCC"> is</font><font color="#E5E5E5"> there's technical</font>

774
00:30:09,250 --> 00:30:13,990
limitations that make it difficult to

775
00:30:10,990 --> 00:30:15,820
support s2<font color="#E5E5E5"> so they're saying it must</font>

776
00:30:13,990 --> 00:30:18,340
that the<font color="#E5E5E5"> Capitol's</font><font color="#CCCCCC"> they're at their</font>

777
00:30:15,820 --> 00:30:19,540
capitals<font color="#E5E5E5"> that must is theirs</font><font color="#CCCCCC"> but then</font>

778
00:30:18,340 --> 00:30:20,639
they say immediately<font color="#E5E5E5"> after</font><font color="#CCCCCC"> there's</font>

779
00:30:19,540 --> 00:30:22,500
<font color="#E5E5E5">exceptions</font>

780
00:30:20,640 --> 00:30:24,330
so what we<font color="#E5E5E5"> did we look to all of those</font>

781
00:30:22,500 --> 00:30:27,330
devices<font color="#CCCCCC"> between these</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> periods to be</font>

782
00:30:24,330 --> 00:30:30,750
<font color="#E5E5E5">found that only 48 out of 180 support s</font>

783
00:30:27,330 --> 00:30:32,580
to security<font color="#E5E5E5"> so mandatory they have a</font>

784
00:30:30,750 --> 00:30:34,380
really<font color="#E5E5E5"> really strange definition</font><font color="#CCCCCC"> of</font>

785
00:30:32,580 --> 00:30:37,949
mandatory<font color="#CCCCCC"> it's so far removed</font><font color="#E5E5E5"> from the</font>

786
00:30:34,380 --> 00:30:40,160
truth but<font color="#E5E5E5"> it gets weirder and we</font>

787
00:30:37,950 --> 00:30:42,750
reported<font color="#E5E5E5"> this vulnerability to</font><font color="#CCCCCC"> SCI labs</font>

788
00:30:40,160 --> 00:30:45,510
<font color="#E5E5E5">scilab</font><font color="#CCCCCC"> sport sigmund</font><font color="#E5E5E5"> designed to make</font>

789
00:30:42,750 --> 00:30:47,280
the z-wave<font color="#E5E5E5"> modules it only happened</font>

790
00:30:45,510 --> 00:30:49,710
maybe two months<font color="#E5E5E5"> before we reported the</font>

791
00:30:47,280 --> 00:30:53,340
issue we immediately<font color="#E5E5E5"> got an email</font><font color="#CCCCCC"> back</font>

792
00:30:49,710 --> 00:30:54,720
from a PR company not<font color="#E5E5E5"> a security team</font>

793
00:30:53,340 --> 00:30:56,129
<font color="#E5E5E5">now I don't know how</font><font color="#CCCCCC"> many of</font><font color="#E5E5E5"> you do</font>

794
00:30:54,720 --> 00:30:59,540
vulnerability disclosure<font color="#E5E5E5"> but if you get</font>

795
00:30:56,130 --> 00:31:01,440
an email<font color="#CCCCCC"> from someone who's</font><font color="#E5E5E5"> a PR company</font>

796
00:30:59,540 --> 00:31:05,490
generally<font color="#E5E5E5"> disclosure is not going to go</font>

797
00:31:01,440 --> 00:31:08,010
particularly smoothly it kind of came

798
00:31:05,490 --> 00:31:09,690
out eventually<font color="#CCCCCC"> for a very dodgy press</font>

799
00:31:08,010 --> 00:31:12,570
release<font color="#CCCCCC"> that they actually knew about</font>

800
00:31:09,690 --> 00:31:14,120
this attack so they pointed<font color="#CCCCCC"> me to this</font>

801
00:31:12,570 --> 00:31:16,649
piece<font color="#E5E5E5"> of documentation</font><font color="#CCCCCC"> here which</font>

802
00:31:14,120 --> 00:31:19,590
mentions explicitly an S naught

803
00:31:16,650 --> 00:31:21,690
<font color="#E5E5E5">downgrade attack now this documentation</font>

804
00:31:19,590 --> 00:31:25,260
wasn't open it wasn't public before<font color="#E5E5E5"> they</font>

805
00:31:21,690 --> 00:31:27,000
released it and and it says if an<font color="#CCCCCC"> s2</font>

806
00:31:25,260 --> 00:31:28,500
node has been securely bootstraps<font color="#CCCCCC"> blah</font>

807
00:31:27,000 --> 00:31:29,910
<font color="#CCCCCC">blah blah if it's been</font><font color="#E5E5E5"> brought in as st</font>

808
00:31:28,500 --> 00:31:32,280
you've got to put a warning<font color="#E5E5E5"> message</font>

809
00:31:29,910 --> 00:31:33,870
there for the user<font color="#E5E5E5"> so warning message</font>

810
00:31:32,280 --> 00:31:35,340
<font color="#E5E5E5">has got to</font><font color="#CCCCCC"> show the problem is they</font>

811
00:31:33,870 --> 00:31:37,590
<font color="#E5E5E5">don't specify how that warning message</font>

812
00:31:35,340 --> 00:31:40,530
should show this has got an LED<font color="#CCCCCC"> and a</font>

813
00:31:37,590 --> 00:31:43,409
buzzer that controller has got an LED

814
00:31:40,530 --> 00:31:45,809
<font color="#CCCCCC">and no buzzer</font><font color="#E5E5E5"> it's quite difficult to</font>

815
00:31:43,410 --> 00:31:47,730
warn a user we did find out<font color="#CCCCCC"> that the</font>

816
00:31:45,809 --> 00:31:50,520
home<font color="#E5E5E5"> CA software does actually support</font>

817
00:31:47,730 --> 00:31:54,270
s2 security<font color="#E5E5E5"> it took a bit of tweaking to</font>

818
00:31:50,520 --> 00:31:56,400
do and and this<font color="#E5E5E5"> is how it warns the user</font>

819
00:31:54,270 --> 00:31:58,530
it says adding using s<font color="#CCCCCC"> nought security</font>

820
00:31:56,400 --> 00:32:01,679
that's<font color="#E5E5E5"> it that line</font><font color="#CCCCCC"> they're out of this</font>

821
00:31:58,530 --> 00:32:03,720
wall of text<font color="#CCCCCC"> so that's the only warning</font>

822
00:32:01,679 --> 00:32:05,100
<font color="#CCCCCC">a user guess it's been downgraded that's</font>

823
00:32:03,720 --> 00:32:06,270
<font color="#CCCCCC">betta</font><font color="#E5E5E5"> software so I don't know if</font>

824
00:32:05,100 --> 00:32:09,840
they've improved on that<font color="#CCCCCC"> or there's a</font>

825
00:32:06,270 --> 00:32:12,360
better way of doing<font color="#E5E5E5"> it the press got</font>

826
00:32:09,840 --> 00:32:15,240
interested and<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> iLabs did was they</font>

827
00:32:12,360 --> 00:32:16,799
released a penetration<font color="#E5E5E5"> test report now</font>

828
00:32:15,240 --> 00:32:18,929
<font color="#E5E5E5">I've got a lot</font><font color="#CCCCCC"> of respect for sent post</font>

829
00:32:16,799 --> 00:32:21,210
and<font color="#E5E5E5"> there they do a lot</font><font color="#CCCCCC"> of work in the</font>

830
00:32:18,929 --> 00:32:23,010
<font color="#CCCCCC">hardware space and they found</font><font color="#E5E5E5"> the</font>

831
00:32:21,210 --> 00:32:24,780
initial<font color="#CCCCCC"> s nor vulnerabilities so they</font>

832
00:32:23,010 --> 00:32:28,860
know what they're doing<font color="#E5E5E5"> they were hired</font>

833
00:32:24,780 --> 00:32:31,530
to<font color="#CCCCCC"> look s</font><font color="#E5E5E5"> to UM one</font><font color="#CCCCCC"> of the findings</font><font color="#E5E5E5"> up</font>

834
00:32:28,860 --> 00:32:32,668
there in<font color="#CCCCCC"> grey and it's highly well but</font>

835
00:32:31,530 --> 00:32:33,580
essentially<font color="#E5E5E5"> it says they found this</font>

836
00:32:32,669 --> 00:32:35,920
<font color="#CCCCCC">downgrade attack</font>

837
00:32:33,580 --> 00:32:39,639
so a pen test report<font color="#E5E5E5"> found this down</font>

838
00:32:35,920 --> 00:32:42,400
<font color="#E5E5E5">great attack it went in as a high</font>

839
00:32:39,640 --> 00:32:43,840
severity issue not critical but<font color="#CCCCCC"> high</font>

840
00:32:42,400 --> 00:32:45,580
severity you've got to be local you've

841
00:32:43,840 --> 00:32:47,830
got to have<font color="#E5E5E5"> equipment</font><font color="#CCCCCC"> it's you know it's</font>

842
00:32:45,580 --> 00:32:49,600
not particularly easy<font color="#E5E5E5"> to exploit but</font>

843
00:32:47,830 --> 00:32:51,970
<font color="#E5E5E5">what sigma designs</font><font color="#CCCCCC"> said to sense post</font>

844
00:32:49,600 --> 00:32:53,649
was that the behavior was by<font color="#CCCCCC"> design it</font>

845
00:32:51,970 --> 00:32:56,200
was<font color="#E5E5E5"> to support backwards compatibility</font>

846
00:32:53,650 --> 00:32:58,920
<font color="#E5E5E5">and what that did was it moved a high</font>

847
00:32:56,200 --> 00:33:01,060
severity vulnerability<font color="#E5E5E5"> down to</font>

848
00:32:58,920 --> 00:33:03,040
informational<font color="#E5E5E5"> now</font><font color="#CCCCCC"> I don't know about you</font>

849
00:33:01,060 --> 00:33:04,990
<font color="#CCCCCC">but a downgrade attack that completely</font>

850
00:33:03,040 --> 00:33:06,610
undoes the security statements you make

851
00:33:04,990 --> 00:33:07,780
about<font color="#CCCCCC"> your protocol I mean I could</font>

852
00:33:06,610 --> 00:33:09,429
understand it may<font color="#E5E5E5"> be going</font><font color="#CCCCCC"> down to a</font>

853
00:33:07,780 --> 00:33:13,470
medium<font color="#E5E5E5"> but taking it all the way down to</font>

854
00:33:09,430 --> 00:33:16,330
informational seems really quite dubious

855
00:33:13,470 --> 00:33:17,860
so in conclusion<font color="#E5E5E5"> and what should we take</font>

856
00:33:16,330 --> 00:33:21,129
<font color="#CCCCCC">away</font><font color="#E5E5E5"> from this backwards compatibility</font>

857
00:33:17,860 --> 00:33:22,719
is really hard<font color="#E5E5E5"> now I'm sure some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you</font>

858
00:33:21,130 --> 00:33:25,690
<font color="#E5E5E5">are aware of TLS downgrade attacks</font>

859
00:33:22,720 --> 00:33:28,150
<font color="#CCCCCC">taking you know going down to SSL</font><font color="#E5E5E5"> vtune</font>

860
00:33:25,690 --> 00:33:31,030
<font color="#CCCCCC">being able to</font><font color="#E5E5E5"> break the encryption the</font>

861
00:33:28,150 --> 00:33:33,760
way that's mitigated<font color="#E5E5E5"> in SSL v3 TLS one</font>

862
00:33:31,030 --> 00:33:35,370
is you take a hash of<font color="#E5E5E5"> the handshake</font><font color="#CCCCCC"> and</font>

863
00:33:33,760 --> 00:33:37,810
then send that<font color="#E5E5E5"> after you've been paired</font>

864
00:33:35,370 --> 00:33:39,429
but both sides<font color="#E5E5E5"> have got to be aware</font><font color="#CCCCCC"> that</font>

865
00:33:37,810 --> 00:33:41,230
that's happening<font color="#E5E5E5"> otherwise it doesn't</font>

866
00:33:39,430 --> 00:33:44,350
work<font color="#CCCCCC"> the problem is an</font><font color="#E5E5E5"> S</font><font color="#CCCCCC"> note</font><font color="#E5E5E5"> controller</font>

867
00:33:41,230 --> 00:33:47,590
<font color="#E5E5E5">has absolutely no idea</font><font color="#CCCCCC"> that s2 security</font>

868
00:33:44,350 --> 00:33:49,090
exists this<font color="#E5E5E5"> is interesting vendors are</font>

869
00:33:47,590 --> 00:33:51,669
just that they're<font color="#E5E5E5"> happy to promote their</font>

870
00:33:49,090 --> 00:33:54,220
products based<font color="#E5E5E5"> on security risks that</font>

871
00:33:51,670 --> 00:33:55,750
aren't particularly real now<font color="#E5E5E5"> I don't</font>

872
00:33:54,220 --> 00:33:58,330
<font color="#E5E5E5">have that much high automation equipment</font>

873
00:33:55,750 --> 00:34:00,400
but I'm not bothered about the risk of

874
00:33:58,330 --> 00:34:02,830
<font color="#E5E5E5">someone</font><font color="#CCCCCC"> putting a Dropbox in</font><font color="#E5E5E5"> my garden</font>

875
00:34:00,400 --> 00:34:06,040
or sitting<font color="#CCCCCC"> in a car wearing a</font><font color="#E5E5E5"> hoodie</font>

876
00:34:02,830 --> 00:34:07,899
<font color="#E5E5E5">with a laptop grabbing my Wi-Fi key</font><font color="#CCCCCC"> or</font>

877
00:34:06,040 --> 00:34:10,300
something like<font color="#CCCCCC"> that it's not a risk that</font>

878
00:34:07,900 --> 00:34:11,620
<font color="#E5E5E5">I feel is genuine but they're happy to</font>

879
00:34:10,300 --> 00:34:14,440
say<font color="#E5E5E5"> our products better than the</font>

880
00:34:11,620 --> 00:34:15,819
competitors<font color="#CCCCCC"> because of that but</font><font color="#E5E5E5"> then</font>

881
00:34:14,440 --> 00:34:18,100
<font color="#E5E5E5">when you report those</font><font color="#CCCCCC"> vulnerabilities to</font>

882
00:34:15,820 --> 00:34:19,510
<font color="#E5E5E5">them they say they're not</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> problem it's</font>

883
00:34:18,100 --> 00:34:20,830
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of like this balancing</font><font color="#E5E5E5"> act where</font>

884
00:34:19,510 --> 00:34:22,120
<font color="#E5E5E5">they're trying to say yes we've</font><font color="#CCCCCC"> got</font><font color="#E5E5E5"> the</font>

885
00:34:20,830 --> 00:34:24,009
best<font color="#E5E5E5"> security in the world but then when</font>

886
00:34:22,120 --> 00:34:25,630
you say yes<font color="#E5E5E5"> we've broken that security</font>

887
00:34:24,010 --> 00:34:26,790
<font color="#E5E5E5">they just say no it's not it's not a</font>

888
00:34:25,630 --> 00:34:30,250
problem

889
00:34:26,790 --> 00:34:31,750
<font color="#CCCCCC">marketing's a mile from reality</font><font color="#E5E5E5"> and we</font>

890
00:34:30,250 --> 00:34:33,699
find with these closed systems<font color="#E5E5E5"> these</font>

891
00:34:31,750 --> 00:34:35,560
kind of<font color="#E5E5E5"> like ecosystems where you don't</font>

892
00:34:33,699 --> 00:34:37,120
<font color="#E5E5E5">really get</font><font color="#CCCCCC"> in sight there's</font><font color="#E5E5E5"> quite often</font>

893
00:34:35,560 --> 00:34:41,230
problems<font color="#CCCCCC"> you just have to start</font><font color="#E5E5E5"> digging</font>

894
00:34:37,120 --> 00:34:42,400
<font color="#CCCCCC">I mean it stickers I mean well yeah</font><font color="#E5E5E5"> half</font>

895
00:34:41,230 --> 00:34:43,990
a day<font color="#CCCCCC"> of looking in it followed</font><font color="#E5E5E5"> by</font>

896
00:34:42,400 --> 00:34:46,100
shower and<font color="#E5E5E5"> having a bit of a think about</font>

897
00:34:43,989 --> 00:34:48,979
it<font color="#CCCCCC"> to find a downgrade it was that</font><font color="#E5E5E5"> same</font>

898
00:34:46,100 --> 00:34:49,969
<font color="#E5E5E5">there's no work involved</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> just have</font>

899
00:34:48,980 --> 00:34:51,469
to remember<font color="#E5E5E5"> that this attack is</font>

900
00:34:49,969 --> 00:34:53,419
incredibly unlikely I<font color="#E5E5E5"> don't think</font>

901
00:34:51,469 --> 00:34:54,830
anyone's gonna<font color="#CCCCCC"> see this</font><font color="#E5E5E5"> but the thing is</font>

902
00:34:53,420 --> 00:34:57,110
is we're<font color="#CCCCCC"> getting more</font><font color="#E5E5E5"> and more</font><font color="#CCCCCC"> of these</font>

903
00:34:54,830 --> 00:34:58,759
devices<font color="#E5E5E5"> turn on I don't know if any of</font>

904
00:34:57,110 --> 00:35:00,500
<font color="#E5E5E5">you went to the industrial</font><font color="#CCCCCC"> wireless talk</font>

905
00:34:58,760 --> 00:35:02,900
yesterday<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> was talking about</font><font color="#E5E5E5"> how</font>

906
00:35:00,500 --> 00:35:06,020
<font color="#CCCCCC">these similar</font><font color="#E5E5E5"> security is being used</font>

907
00:35:02,900 --> 00:35:08,950
with similar fixed<font color="#E5E5E5"> keys to</font><font color="#CCCCCC"> exchange keys</font>

908
00:35:06,020 --> 00:35:12,020
for sensing networks in industry for

909
00:35:08,950 --> 00:35:14,089
<font color="#E5E5E5">even control networks and the security</font>

910
00:35:12,020 --> 00:35:15,560
is not that much<font color="#E5E5E5"> better and and we are</font>

911
00:35:14,090 --> 00:35:17,060
going to see<font color="#E5E5E5"> people starting to attack</font>

912
00:35:15,560 --> 00:35:18,710
<font color="#E5E5E5">these networks you just have to look at</font>

913
00:35:17,060 --> 00:35:20,660
things<font color="#CCCCCC"> like Stuxnet where</font><font color="#E5E5E5"> people really</font>

914
00:35:18,710 --> 00:35:23,540
<font color="#E5E5E5">really do put a lot of effort into</font><font color="#CCCCCC"> it</font>

915
00:35:20,660 --> 00:35:24,770
<font color="#CCCCCC">and vendors really need to improve</font>

916
00:35:23,540 --> 00:35:26,029
sooner rather than later they need to

917
00:35:24,770 --> 00:35:27,860
<font color="#E5E5E5">start thinking</font><font color="#CCCCCC"> about how to fix these</font>

918
00:35:26,030 --> 00:35:29,630
<font color="#E5E5E5">problems now</font><font color="#CCCCCC"> and that might involve</font>

919
00:35:27,860 --> 00:35:31,190
<font color="#E5E5E5">making some decisions</font><font color="#CCCCCC"> about taking</font><font color="#E5E5E5"> away</font>

920
00:35:29,630 --> 00:35:35,840
backwards compatibility and improving

921
00:35:31,190 --> 00:35:46,220
<font color="#CCCCCC">security</font><font color="#E5E5E5"> and so that's the talk and any</font>

922
00:35:35,840 --> 00:35:53,560
questions so who wants to<font color="#E5E5E5"> start</font><font color="#CCCCCC"> with the</font>

923
00:35:46,220 --> 00:35:58,430
first question the part he thought about

924
00:35:53,560 --> 00:36:01,580
<font color="#E5E5E5">introducing the</font><font color="#CCCCCC"> fee to</font><font color="#E5E5E5"> security did that</font>

925
00:35:58,430 --> 00:36:05,779
exclude the dunk right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> only fee</font><font color="#CCCCCC"> two</font>

926
00:36:01,580 --> 00:36:09,040
and removed<font color="#CCCCCC"> a</font><font color="#E5E5E5"> zero</font>

927
00:36:05,780 --> 00:36:12,890
night-night<font color="#E5E5E5"> the s not always present</font>

928
00:36:09,040 --> 00:36:14,360
<font color="#CCCCCC">you can't we I</font><font color="#E5E5E5"> don't think they're going</font>

929
00:36:12,890 --> 00:36:15,920
<font color="#E5E5E5">to</font><font color="#CCCCCC"> allow s</font><font color="#E5E5E5"> naught to</font><font color="#CCCCCC"> be removed because</font>

930
00:36:14,360 --> 00:36:17,840
<font color="#E5E5E5">this backwards compatibility thing they</font>

931
00:36:15,920 --> 00:36:19,310
will<font color="#E5E5E5"> place that above all others I mean</font>

932
00:36:17,840 --> 00:36:21,080
<font color="#E5E5E5">homes here you can turn it off you can</font>

933
00:36:19,310 --> 00:36:22,790
say I don't want to<font color="#CCCCCC"> support</font><font color="#E5E5E5"> s</font><font color="#CCCCCC"> naught</font>

934
00:36:21,080 --> 00:36:24,740
anymore<font color="#E5E5E5"> but the next</font><font color="#CCCCCC"> noughts still</font>

935
00:36:22,790 --> 00:36:26,150
better than no security so the problem

936
00:36:24,740 --> 00:36:27,890
there<font color="#CCCCCC"> is if you pair an S naught device</font>

937
00:36:26,150 --> 00:36:29,750
into a network<font color="#E5E5E5"> that doesn't</font><font color="#CCCCCC"> support</font><font color="#E5E5E5"> s</font>

938
00:36:27,890 --> 00:36:30,710
naught it goes in with no security<font color="#CCCCCC"> I'm</font>

939
00:36:29,750 --> 00:36:32,630
going to walk up<font color="#CCCCCC"> to</font><font color="#E5E5E5"> your house and</font>

940
00:36:30,710 --> 00:36:36,950
unlock the<font color="#E5E5E5"> door which is obviously very</font>

941
00:36:32,630 --> 00:36:40,880
bad so it didn't<font color="#E5E5E5"> actually solve stuff</font>

942
00:36:36,950 --> 00:36:44,710
<font color="#E5E5E5">only introducing new devices that have a</font>

943
00:36:40,880 --> 00:36:47,890
zero<font color="#CCCCCC"> in it and yeah pretty much okay and</font>

944
00:36:44,710 --> 00:36:49,839
<font color="#CCCCCC">we have found other problems as</font><font color="#E5E5E5"> well</font>

945
00:36:47,890 --> 00:36:51,339
<font color="#CCCCCC">today it's not all quite as rosy we</font>

946
00:36:49,839 --> 00:36:52,839
<font color="#E5E5E5">managed</font><font color="#CCCCCC"> to brick these and run the</font>

947
00:36:51,339 --> 00:36:57,220
batteries<font color="#E5E5E5"> out on these and things like</font>

948
00:36:52,839 --> 00:37:01,119
<font color="#E5E5E5">that</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it nothing major</font><font color="#CCCCCC"> okay thank you</font>

949
00:36:57,220 --> 00:37:03,308
<font color="#CCCCCC">for nice stock</font><font color="#E5E5E5"> really when you</font><font color="#CCCCCC"> actually</font>

950
00:37:01,119 --> 00:37:04,509
send the replay message<font color="#E5E5E5"> the</font><font color="#CCCCCC"> controller</font>

951
00:37:03,309 --> 00:37:07,299
<font color="#E5E5E5">is going to receive virtually two</font>

952
00:37:04,509 --> 00:37:08,109
messages at the same time say or did I

953
00:37:07,299 --> 00:37:10,269
miss something

954
00:37:08,109 --> 00:37:12,220
what we do is the controller isn't in

955
00:37:10,269 --> 00:37:14,680
the pairing mode when we first started

956
00:37:12,220 --> 00:37:15,819
so we the node sends its info<font color="#E5E5E5"> first okay</font>

957
00:37:14,680 --> 00:37:17,140
and<font color="#CCCCCC"> then we put the controller</font><font color="#E5E5E5"> into</font>

958
00:37:15,819 --> 00:37:19,420
pairing mode<font color="#CCCCCC"> now the problem is you've</font>

959
00:37:17,140 --> 00:37:21,460
got a bit<font color="#E5E5E5"> of a race going on here yeah</font>

960
00:37:19,420 --> 00:37:24,309
<font color="#CCCCCC">the device will keep on sending out that</font>

961
00:37:21,460 --> 00:37:26,049
load info every two seconds to start

962
00:37:24,309 --> 00:37:27,910
with then every<font color="#E5E5E5"> four seconds and then</font>

963
00:37:26,049 --> 00:37:30,700
every eight seconds it backs off<font color="#E5E5E5"> but if</font>

964
00:37:27,910 --> 00:37:32,680
we<font color="#E5E5E5"> don't get our node info first then</font>

965
00:37:30,700 --> 00:37:34,960
the attack<font color="#E5E5E5"> point succeed so the script</font>

966
00:37:32,680 --> 00:37:37,690
<font color="#E5E5E5">wait two seconds so it receives it waits</font>

967
00:37:34,960 --> 00:37:39,190
<font color="#E5E5E5">two seconds then resend it okay great so</font>

968
00:37:37,690 --> 00:37:41,230
basically your message will be do

969
00:37:39,190 --> 00:37:42,880
wonders going to first get to<font color="#CCCCCC"> the nth</font>

970
00:37:41,230 --> 00:37:45,119
<font color="#CCCCCC">roller</font><font color="#E5E5E5"> that's that's the right okay no</font>

971
00:37:42,880 --> 00:37:50,529
no<font color="#E5E5E5"> it's basically</font><font color="#CCCCCC"> Utley</font><font color="#E5E5E5"> okay thank you</font>

972
00:37:45,119 --> 00:37:54,630
other question hi<font color="#E5E5E5"> I'm actually with SCI</font>

973
00:37:50,529 --> 00:37:59,440
labs<font color="#E5E5E5"> oh hi nice to</font><font color="#CCCCCC"> meet you I wanted</font><font color="#E5E5E5"> to</font>

974
00:37:54,630 --> 00:38:02,559
speak<font color="#E5E5E5"> I guess on a positive note</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> I</font>

975
00:37:59,440 --> 00:38:04,210
mean my presence here<font color="#E5E5E5"> is one of the</font>

976
00:38:02,559 --> 00:38:07,539
things that we were doing<font color="#CCCCCC"> better</font><font color="#E5E5E5"> yeah</font>

977
00:38:04,210 --> 00:38:08,920
and I<font color="#CCCCCC"> think so and</font><font color="#E5E5E5"> thank you also for</font>

978
00:38:07,539 --> 00:38:12,210
the<font color="#E5E5E5"> talk I think it's been very very</font>

979
00:38:08,920 --> 00:38:16,509
<font color="#E5E5E5">useful</font><font color="#CCCCCC"> I do want to highlight</font><font color="#E5E5E5"> that</font>

980
00:38:12,210 --> 00:38:19,509
backwards<font color="#CCCCCC"> way balancing security and</font>

981
00:38:16,509 --> 00:38:21,130
backwards compatibility is is just in

982
00:38:19,509 --> 00:38:24,220
<font color="#E5E5E5">general a</font><font color="#CCCCCC"> very hard problem just</font><font color="#E5E5E5"> yeah</font>

983
00:38:21,130 --> 00:38:26,529
yes yeah and we are<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> trying to</font>

984
00:38:24,220 --> 00:38:30,509
<font color="#CCCCCC">struggle with you know how to best do</font>

985
00:38:26,529 --> 00:38:34,210
this with with z-wave yeah<font color="#CCCCCC"> yes there are</font>

986
00:38:30,509 --> 00:38:37,599
thousands of s0 products out there<font color="#E5E5E5"> and</font>

987
00:38:34,210 --> 00:38:39,789
yeah<font color="#E5E5E5"> I agree it's really really hard</font>

988
00:38:37,599 --> 00:38:42,130
<font color="#E5E5E5">problem</font><font color="#CCCCCC"> to solve I mean I sat down and I</font>

989
00:38:39,789 --> 00:38:44,529
just<font color="#E5E5E5"> couldn't think of a feasible</font><font color="#CCCCCC"> way of</font>

990
00:38:42,130 --> 00:38:46,839
<font color="#E5E5E5">doing it with the low UI that these</font>

991
00:38:44,529 --> 00:38:48,339
devices<font color="#CCCCCC"> have got and the thing</font><font color="#E5E5E5"> that I</font>

992
00:38:46,839 --> 00:38:49,359
found<font color="#E5E5E5"> interesting is that the disclosure</font>

993
00:38:48,339 --> 00:38:50,230
I was<font color="#CCCCCC"> talking about there and</font><font color="#E5E5E5"> it not</font>

994
00:38:49,359 --> 00:38:53,440
going swimmingly

995
00:38:50,230 --> 00:38:56,049
<font color="#CCCCCC">it wasn't until I'm</font><font color="#E5E5E5"> sure you know Lars</font>

996
00:38:53,440 --> 00:38:57,670
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> Lars got involved and from that</font>

997
00:38:56,049 --> 00:38:59,119
point onwards<font color="#CCCCCC"> it was clear we were</font>

998
00:38:57,670 --> 00:39:01,369
<font color="#E5E5E5">speaking to someone who</font>

999
00:38:59,119 --> 00:39:02,690
understood where we were<font color="#E5E5E5"> coming from and</font>

1000
00:39:01,369 --> 00:39:06,349
<font color="#E5E5E5">from that point</font><font color="#CCCCCC"> ones</font><font color="#E5E5E5"> everything flowed</font>

1001
00:39:02,690 --> 00:39:08,359
brilliantly and but I think<font color="#E5E5E5"> you know</font>

1002
00:39:06,349 --> 00:39:10,670
there was a lot<font color="#CCCCCC"> of initial issues there</font>

1003
00:39:08,359 --> 00:39:13,578
well we also now have ap<font color="#CCCCCC"> cert process</font>

1004
00:39:10,670 --> 00:39:15,229
<font color="#CCCCCC">yes so which</font><font color="#E5E5E5"> makes things yet all</font>

1005
00:39:13,579 --> 00:39:17,180
<font color="#E5E5E5">notifications come in through a known</font>

1006
00:39:15,229 --> 00:39:23,089
flow and I'm actually I'm<font color="#CCCCCC"> thank you</font>

1007
00:39:17,180 --> 00:39:25,940
testing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> in the next few days but</font>

1008
00:39:23,089 --> 00:39:28,460
it's one<font color="#CCCCCC"> thing we're aware of</font><font color="#E5E5E5"> this we're</font>

1009
00:39:25,940 --> 00:39:31,460
working on it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> and thanks cool thanks</font>

1010
00:39:28,460 --> 00:39:40,579
your comment there's one right<font color="#E5E5E5"> at the</font>

1011
00:39:31,460 --> 00:39:44,200
back as well<font color="#CCCCCC"> which one but</font><font color="#E5E5E5"> that was less</font>

1012
00:39:40,579 --> 00:39:44,200
<font color="#CCCCCC">uncomfortable and it could have</font><font color="#E5E5E5"> been</font><font color="#CCCCCC"> I</font>

1013
00:39:45,640 --> 00:39:51,049
remember<font color="#E5E5E5"> I I did the demo of this and I</font>

1014
00:39:49,519 --> 00:39:53,269
noticed the people<font color="#CCCCCC"> in the audience were</font>

1015
00:39:51,049 --> 00:39:54,529
covering up their name badges and<font color="#E5E5E5"> then</font>

1016
00:39:53,269 --> 00:39:57,109
when they when they<font color="#E5E5E5"> uncovered</font><font color="#CCCCCC"> didn't</font>

1017
00:39:54,529 --> 00:39:59,029
<font color="#E5E5E5">they will work for</font><font color="#CCCCCC"> Yale</font><font color="#E5E5E5"> which is quite</font>

1018
00:39:57,109 --> 00:40:02,479
quite<font color="#E5E5E5"> awkward</font>

1019
00:39:59,029 --> 00:40:05,150
sorry yeah just wanted<font color="#CCCCCC"> to say thanks for</font>

1020
00:40:02,479 --> 00:40:06,288
<font color="#E5E5E5">standing up</font><font color="#CCCCCC"> to John McAfee you better</font><font color="#E5E5E5"> so</font>

1021
00:40:05,150 --> 00:40:08,569
if you if you want<font color="#CCCCCC"> to if you want to</font>

1022
00:40:06,289 --> 00:40:11,329
<font color="#E5E5E5">hear about Mac if it is that</font><font color="#CCCCCC"> hey say</font>

1023
00:40:08,569 --> 00:40:12,410
McAfee I don't know I wouldn't<font color="#E5E5E5"> I don't</font>

1024
00:40:11,329 --> 00:40:13,609
<font color="#CCCCCC">know what I've been</font><font color="#E5E5E5"> calling</font><font color="#CCCCCC"> him I've</font>

1025
00:40:12,410 --> 00:40:15,759
<font color="#E5E5E5">never really said it before which is</font>

1026
00:40:13,609 --> 00:40:18,348
<font color="#E5E5E5">I've got to do a talk in an hour</font><font color="#CCCCCC"> and</font>

1027
00:40:15,759 --> 00:40:20,269
<font color="#E5E5E5">yeah I'm doing a talk about bit fine if</font>

1028
00:40:18,349 --> 00:40:22,190
you haven't<font color="#E5E5E5"> heard about bit Phi or bit</font>

1029
00:40:20,269 --> 00:40:25,640
fee it's a hardware wallet this<font color="#E5E5E5"> was</font>

1030
00:40:22,190 --> 00:40:27,170
called unhackable it's the first<font color="#E5E5E5"> time</font>

1031
00:40:25,640 --> 00:40:29,029
<font color="#E5E5E5">that someone's invited to me their house</font>

1032
00:40:27,170 --> 00:40:31,910
full<font color="#CCCCCC"> of guns to go and hack something</font>

1033
00:40:29,029 --> 00:40:34,549
<font color="#E5E5E5">and again the technical side of</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not</font>

1034
00:40:31,910 --> 00:40:36,288
particularly complicated<font color="#E5E5E5"> but the</font>

1035
00:40:34,549 --> 00:40:37,819
disclosure<font color="#CCCCCC"> process and some of the</font>

1036
00:40:36,289 --> 00:40:39,589
<font color="#E5E5E5">social</font><font color="#CCCCCC"> media stuff's being quite</font>

1037
00:40:37,819 --> 00:40:40,969
interesting so<font color="#E5E5E5"> if you want to come and</font>

1038
00:40:39,589 --> 00:40:44,420
see<font color="#CCCCCC"> that I'll I'll show you how the</font>

1039
00:40:40,969 --> 00:40:46,309
attacks work and show you some funny

1040
00:40:44,420 --> 00:40:49,029
stuff I hope and I might be<font color="#CCCCCC"> wearing</font><font color="#E5E5E5"> my</font>

1041
00:40:46,309 --> 00:40:49,029
<font color="#E5E5E5">Pikachu see</font>

1042
00:40:51,310 --> 00:40:55,710
[Applause]

