1
00:00:04,009 --> 00:00:10,710
all right so yeah that's a pretty good

2
00:00:07,799 --> 00:00:13,770
synopsis although I'd like to emphasize

3
00:00:10,710 --> 00:00:15,990
in this presentation that this idea of

4
00:00:13,770 --> 00:00:18,660
men in the middle Inge as an attack

5
00:00:15,990 --> 00:00:21,448
factor that's a bit that sounds a bit

6
00:00:18,660 --> 00:00:23,400
like my hostile what we're doing is we

7
00:00:21,449 --> 00:00:24,599
are man in the middling you could call

8
00:00:23,400 --> 00:00:28,288
the man in the middle attack but we're

9
00:00:24,599 --> 00:00:30,329
doing it for profit in some way we are

10
00:00:28,289 --> 00:00:32,550
doing it to improve a product and to

11
00:00:30,329 --> 00:00:34,440
sell this as an upgrade to existing cars

12
00:00:32,549 --> 00:00:37,349
and that means that I'm here as a

13
00:00:34,440 --> 00:00:39,589
businessperson and I have to acknowledge

14
00:00:37,350 --> 00:00:43,080
my man in the middle of the room there

15
00:00:39,590 --> 00:00:47,910
this is Jacques Bloomberg he and I

16
00:00:43,080 --> 00:00:50,010
together have the company Maxim yeah so

17
00:00:47,910 --> 00:00:54,199
it's not just me I mostly do the

18
00:00:50,010 --> 00:00:56,430
electronic side of things and the

19
00:00:54,200 --> 00:00:58,470
programming that kind of stuff Shaq does

20
00:00:56,430 --> 00:01:00,510
the mechanical engineering mostly you

21
00:00:58,470 --> 00:01:02,550
know basically it's a small company so

22
00:01:00,510 --> 00:01:05,729
we do everything but that's the reason

23
00:01:02,550 --> 00:01:10,490
why I'm here and he's in the audience

24
00:01:05,729 --> 00:01:12,899
today so write the theme of a

25
00:01:10,490 --> 00:01:16,429
businessperson I'm in my turtleneck

26
00:01:12,899 --> 00:01:18,749
people say oh my Steve Jobs uniform and

27
00:01:16,429 --> 00:01:20,969
that also means that I need to drive a

28
00:01:18,749 --> 00:01:25,439
flashy car so we're talking about

29
00:01:20,969 --> 00:01:28,469
electric cars so here is a Fiat 500e

30
00:01:25,439 --> 00:01:30,719
it's a very cool car so it's very nippy

31
00:01:28,469 --> 00:01:33,509
on the road it looks nice like it's a

32
00:01:30,719 --> 00:01:37,229
it's a looks very small in this photo

33
00:01:33,509 --> 00:01:38,819
but it is is fairly roomy it's um it's

34
00:01:37,229 --> 00:01:41,369
got a few downsides like the interior

35
00:01:38,819 --> 00:01:45,959
it's bit cheap and it doesn't go very

36
00:01:41,369 --> 00:01:52,380
far on a battery and well I had this

37
00:01:45,959 --> 00:01:54,630
photo it's not my car anyway this is a

38
00:01:52,380 --> 00:01:58,439
cool car right this is a tesla tesla

39
00:01:54,630 --> 00:02:01,529
model s p85d pretty much one of the best

40
00:01:58,439 --> 00:02:04,559
electric cars on the market it is it's

41
00:02:01,529 --> 00:02:07,829
really fast off the line its fastest car

42
00:02:04,560 --> 00:02:12,810
production car until very shortly ago

43
00:02:07,829 --> 00:02:14,549
um yeah really cool car so it's a bit

44
00:02:12,810 --> 00:02:18,930
expensive though I

45
00:02:14,550 --> 00:02:19,590
I can't really afford it so let's just

46
00:02:18,930 --> 00:02:25,440
move on

47
00:02:19,590 --> 00:02:27,240
mm-hmm so yeah I'm not actually really a

48
00:02:25,440 --> 00:02:29,550
business person more of an engineering

49
00:02:27,240 --> 00:02:33,560
type and I assume that most people here

50
00:02:29,550 --> 00:02:38,220
are more of the engineering persuasion

51
00:02:33,560 --> 00:02:40,740
so I like to like the the engineer in us

52
00:02:38,220 --> 00:02:45,390
we see a problem in the world for

53
00:02:40,740 --> 00:02:47,460
instance I guess a missing library for

54
00:02:45,390 --> 00:02:50,399
seeing if something is a positive

55
00:02:47,460 --> 00:02:53,970
integer and we fix it by writing a

56
00:02:50,400 --> 00:02:59,790
library that only tries to look at an

57
00:02:53,970 --> 00:03:02,550
integer and see if it's positive we do

58
00:02:59,790 --> 00:03:04,230
these things where we like to just fix

59
00:03:02,550 --> 00:03:06,330
the world so for instance we see on

60
00:03:04,230 --> 00:03:08,820
Thingiverse we see this head of Stephen

61
00:03:06,330 --> 00:03:11,130
Colbert and there's clearly something

62
00:03:08,820 --> 00:03:12,690
wrong with it is there anybody in the

63
00:03:11,130 --> 00:03:17,760
audience who knows what's wrong with

64
00:03:12,690 --> 00:03:19,560
this head just looking at it definitely

65
00:03:17,760 --> 00:03:21,929
something with the mouth yeah and the

66
00:03:19,560 --> 00:03:24,270
eyes and other things everything is

67
00:03:21,930 --> 00:03:25,440
upside down clearly it's this is a much

68
00:03:24,270 --> 00:03:28,440
better thing an engineer

69
00:03:25,440 --> 00:03:32,690
they changed the mesh and yeah

70
00:03:28,440 --> 00:03:35,240
fixed it this is what engineers do and

71
00:03:32,690 --> 00:03:37,800
yeah there's this whole cornucopia of

72
00:03:35,240 --> 00:03:40,980
information on the internet on github

73
00:03:37,800 --> 00:03:43,310
and NPM on Thingiverse people trying to

74
00:03:40,980 --> 00:03:50,000
fix the world and sharing their

75
00:03:43,310 --> 00:03:53,540
improvements but this is my actual car

76
00:03:50,000 --> 00:04:00,020
I've tried to find a nice photo of it

77
00:03:53,540 --> 00:04:00,019
it's it's not a very nice looking car

78
00:04:01,280 --> 00:04:04,890
yeah

79
00:04:02,550 --> 00:04:06,780
I obviously gave up I don't know what

80
00:04:04,890 --> 00:04:08,910
what to do with this but basically the

81
00:04:06,780 --> 00:04:09,840
car needs a body kit to be to be

82
00:04:08,910 --> 00:04:17,600
actually nice

83
00:04:09,840 --> 00:04:20,519
so yeah this car has to be fixed because

84
00:04:17,600 --> 00:04:22,560
here's the here's the deal we bought

85
00:04:20,519 --> 00:04:24,359
this car me and my fiance bought this

86
00:04:22,560 --> 00:04:27,120
car a year and a half ago

87
00:04:24,360 --> 00:04:28,200
so first carts or only car and it's an

88
00:04:27,120 --> 00:04:29,850
electric car

89
00:04:28,200 --> 00:04:34,710
and it was basically the only electric

90
00:04:29,850 --> 00:04:41,220
car we could afford which explains the

91
00:04:34,710 --> 00:04:43,020
design I guess and well I mean there are

92
00:04:41,220 --> 00:04:48,420
cheaper electric cars but I mean come on

93
00:04:43,020 --> 00:04:49,560
this is this is ridiculous so there are

94
00:04:48,420 --> 00:04:51,090
some problems with these first

95
00:04:49,560 --> 00:04:54,150
generation electric cars they have a

96
00:04:51,090 --> 00:04:55,830
limited range so typical Nissan Leaf

97
00:04:54,150 --> 00:04:59,190
when you buy them secondhand they go

98
00:04:55,830 --> 00:05:01,039
about 100 kilometers on a charge they

99
00:04:59,190 --> 00:05:05,280
try for you slowly so once you drive

100
00:05:01,040 --> 00:05:07,680
basically an hour on the highway you

101
00:05:05,280 --> 00:05:10,979
have to wait for basically an hour

102
00:05:07,680 --> 00:05:12,930
before it's full again at a fast charger

103
00:05:10,980 --> 00:05:15,630
if you want to do this as a slow charter

104
00:05:12,930 --> 00:05:18,030
yeah it's well as long as you'd like it

105
00:05:15,630 --> 00:05:21,240
pretty much it's very relaxed driving

106
00:05:18,030 --> 00:05:23,669
with it and this is a car from 2011 so

107
00:05:21,240 --> 00:05:25,530
it's missing a lot of cool gadgets

108
00:05:23,670 --> 00:05:26,790
things like Android auto and apple

109
00:05:25,530 --> 00:05:31,700
carplay if you're of the app

110
00:05:26,790 --> 00:05:36,150
appreciation so these are problems and

111
00:05:31,700 --> 00:05:40,110
how do we fix these problems so I talked

112
00:05:36,150 --> 00:05:43,710
to a couple of people and I first like

113
00:05:40,110 --> 00:05:45,540
to talk about the the responses I got

114
00:05:43,710 --> 00:05:47,969
from the other people which was buying a

115
00:05:45,540 --> 00:05:50,990
different car I don't get this this

116
00:05:47,970 --> 00:05:53,280
mindset of non engineers

117
00:05:50,990 --> 00:05:57,240
why would you buy a different car if you

118
00:05:53,280 --> 00:06:00,659
want a better car that makes sense

119
00:05:57,240 --> 00:06:02,460
though I don't know the actual solutions

120
00:06:00,660 --> 00:06:04,320
obviously is adding extra batteries

121
00:06:02,460 --> 00:06:06,150
that's I mean that's how you how you

122
00:06:04,320 --> 00:06:07,500
give it more battery capacity right you

123
00:06:06,150 --> 00:06:13,080
have the car already you bought it

124
00:06:07,500 --> 00:06:14,490
because well reasons so yeah yeah the

125
00:06:13,080 --> 00:06:17,789
extra batteries you increase the

126
00:06:14,490 --> 00:06:20,400
charging speed and yeah cool gadgets and

127
00:06:17,790 --> 00:06:23,190
stuff you want stuff that's in it Tesla

128
00:06:20,400 --> 00:06:25,830
for instance which still cannot afford

129
00:06:23,190 --> 00:06:28,140
even though starting a company you

130
00:06:25,830 --> 00:06:33,180
should make more money put that on the

131
00:06:28,140 --> 00:06:35,909
to-do list so we go to the cornucopia of

132
00:06:33,180 --> 00:06:38,340
the Internet there are people who have

133
00:06:35,910 --> 00:06:40,410
thought of this solution before adding

134
00:06:38,340 --> 00:06:41,669
extra batteries to a car and there's

135
00:06:40,410 --> 00:06:43,230
this whole YouTube channel this

136
00:06:41,670 --> 00:06:45,330
not my channels it's just another

137
00:06:43,230 --> 00:06:48,390
channel that I found quite a long time

138
00:06:45,330 --> 00:06:51,359
ago in the last few videos he made were

139
00:06:48,390 --> 00:06:57,300
from a few years ago and he made the

140
00:06:51,360 --> 00:07:00,570
battery pack for a Nissan Leaf so you

141
00:06:57,300 --> 00:07:04,140
say it's possible there's this company

142
00:07:00,570 --> 00:07:08,070
apparently in 2014 already who made a

143
00:07:04,140 --> 00:07:10,320
very ugly trailer that as battery

144
00:07:08,070 --> 00:07:17,490
capacity of a very ugly car I did not

145
00:07:10,320 --> 00:07:21,409
know that cars were so ugly so yeah it's

146
00:07:17,490 --> 00:07:23,790
possible right and then you delve into

147
00:07:21,410 --> 00:07:28,280
kind of a downside of the engineers

148
00:07:23,790 --> 00:07:30,840
mindset which is this guy at leaf x-pac

149
00:07:28,280 --> 00:07:33,830
he made the car work on this extra

150
00:07:30,840 --> 00:07:35,940
battery and then he fried his car and

151
00:07:33,830 --> 00:07:37,969
then he fixed the car and never

152
00:07:35,940 --> 00:07:42,510
installed the battery pack back because

153
00:07:37,970 --> 00:07:45,860
well he basically showed it as possible

154
00:07:42,510 --> 00:07:48,120
I made the thing work and now yeah

155
00:07:45,860 --> 00:07:52,460
making it into an actual product or

156
00:07:48,120 --> 00:07:55,110
making it actually work in a way that is

157
00:07:52,460 --> 00:07:57,180
worry-free that you can just drive

158
00:07:55,110 --> 00:07:58,860
around and don't have to worry about in

159
00:07:57,180 --> 00:08:02,220
which exact order you have to close the

160
00:07:58,860 --> 00:08:06,110
contactors which was this problem most

161
00:08:02,220 --> 00:08:09,810
people don't really want to do that so

162
00:08:06,110 --> 00:08:11,780
these projects they strand and a lot of

163
00:08:09,810 --> 00:08:15,320
project strand you can see this

164
00:08:11,780 --> 00:08:18,570
everywhere on github and forums and

165
00:08:15,320 --> 00:08:21,870
people discussing possible solutions

166
00:08:18,570 --> 00:08:23,940
getting like 20% of the way there

167
00:08:21,870 --> 00:08:26,430
30% of the way there and then stopping

168
00:08:23,940 --> 00:08:28,110
so there's a lot of information on the

169
00:08:26,430 --> 00:08:31,440
Internet a lot of cool stuff being done

170
00:08:28,110 --> 00:08:34,140
but very little of it is actually of any

171
00:08:31,440 --> 00:08:37,110
true value to an end customer

172
00:08:34,140 --> 00:08:38,880
it's just projects nothing wrong of

173
00:08:37,110 --> 00:08:43,020
course with that because I might have

174
00:08:38,880 --> 00:08:46,050
contributed quite a lot to that but yeah

175
00:08:43,020 --> 00:08:50,189
this is why I think and why I want to

176
00:08:46,050 --> 00:08:52,620
convince you the audience to try to do

177
00:08:50,190 --> 00:08:55,050
can man-in-the-middle attacks for profit

178
00:08:52,620 --> 00:08:58,140
might be a little bit specific thing

179
00:08:55,050 --> 00:09:00,839
to convince people of but yeah this this

180
00:08:58,140 --> 00:09:04,710
commercial incentive that is what drives

181
00:09:00,840 --> 00:09:07,020
us to develop this product further to

182
00:09:04,710 --> 00:09:11,160
the point that we can actually sell it

183
00:09:07,020 --> 00:09:14,030
to people and this might sound very very

184
00:09:11,160 --> 00:09:17,610
very money centric there was a

185
00:09:14,030 --> 00:09:20,819
presentation a little bit ago where the

186
00:09:17,610 --> 00:09:23,760
guy was talking about the commercial men

187
00:09:20,820 --> 00:09:27,420
and middle attacks and that's not what I

188
00:09:23,760 --> 00:09:31,290
mean but I mostly mean is other people

189
00:09:27,420 --> 00:09:34,140
carrying a lot about the money they gave

190
00:09:31,290 --> 00:09:37,079
us and saying I kind of want a product

191
00:09:34,140 --> 00:09:40,470
that works and my car is now stranded

192
00:09:37,080 --> 00:09:42,060
this is a there's a screenshot from leaf

193
00:09:40,470 --> 00:09:44,400
spy it's a little program you can

194
00:09:42,060 --> 00:09:47,900
install on your phone that inspects the

195
00:09:44,400 --> 00:09:50,370
error messages that a car causes and you

196
00:09:47,900 --> 00:09:52,890
don't need to really read all of this

197
00:09:50,370 --> 00:09:54,900
this basically means the car is dead

198
00:09:52,890 --> 00:09:57,990
stranded at the side of the road people

199
00:09:54,900 --> 00:09:59,550
are calling me and sending screenshots

200
00:09:57,990 --> 00:10:04,380
and saying how do I fix this

201
00:09:59,550 --> 00:10:05,910
now and that is not fun if you have 10

202
00:10:04,380 --> 00:10:07,980
customers driving around with cars that

203
00:10:05,910 --> 00:10:11,719
don't quite work right so there is a

204
00:10:07,980 --> 00:10:18,450
commercial incentive to fix the product

205
00:10:11,720 --> 00:10:22,260
anyway when all of this is said and done

206
00:10:18,450 --> 00:10:23,790
though and this is I think and I've been

207
00:10:22,260 --> 00:10:25,950
focusing a little bit on the the

208
00:10:23,790 --> 00:10:28,380
negatives of people complaining and to

209
00:10:25,950 --> 00:10:30,030
me a things don't work right but when it

210
00:10:28,380 --> 00:10:31,770
works right

211
00:10:30,030 --> 00:10:33,720
this is transformative especially in the

212
00:10:31,770 --> 00:10:37,520
evey sphere especially with secondhand

213
00:10:33,720 --> 00:10:40,170
older V's these cars are very limited

214
00:10:37,520 --> 00:10:43,050
people often say in firms well the

215
00:10:40,170 --> 00:10:45,270
average commute is 30 kilometers 20

216
00:10:43,050 --> 00:10:47,910
kilometers of an e v with 100 kilometer

217
00:10:45,270 --> 00:10:51,000
range can do anything it's more than

218
00:10:47,910 --> 00:10:54,270
enough to do anything this customer went

219
00:10:51,000 --> 00:10:56,820
to the Alps on holiday this summer

220
00:10:54,270 --> 00:10:59,939
holiday with his range extended battery

221
00:10:56,820 --> 00:11:03,030
and he was able to do things like finest

222
00:10:59,940 --> 00:11:05,310
lvo pass which is 2700 meter height

223
00:11:03,030 --> 00:11:07,560
difference from sea level to the pass

224
00:11:05,310 --> 00:11:09,040
this is something that is physically

225
00:11:07,560 --> 00:11:10,839
impossible with the original

226
00:11:09,040 --> 00:11:13,150
original car and actually physically

227
00:11:10,840 --> 00:11:15,510
impossible with any of the earliest

228
00:11:13,150 --> 00:11:19,329
generation car so the Nissan Leaf the

229
00:11:15,510 --> 00:11:21,540
Citroen c0 that you saw and the Renault

230
00:11:19,330 --> 00:11:23,970
Zoe their batteries are too small to

231
00:11:21,540 --> 00:11:27,910
actually bridge this height difference

232
00:11:23,970 --> 00:11:30,940
so you cannot go on holiday even if

233
00:11:27,910 --> 00:11:33,550
there were chargers everywhere this is a

234
00:11:30,940 --> 00:11:35,670
change this this slight increase in

235
00:11:33,550 --> 00:11:38,890
battery capacity while doubling I guess

236
00:11:35,670 --> 00:11:40,870
is something that helps people make a

237
00:11:38,890 --> 00:11:44,590
second car into a first car into a

238
00:11:40,870 --> 00:11:46,600
primary vehicle so these are useful

239
00:11:44,590 --> 00:11:49,510
modifications this is not a little bit

240
00:11:46,600 --> 00:11:51,520
useful they say stuff that transforms a

241
00:11:49,510 --> 00:11:52,990
car that you kind of want to sell into a

242
00:11:51,520 --> 00:11:55,569
car that you can keep for another 10

243
00:11:52,990 --> 00:11:57,970
years because these cars are Greek

244
00:11:55,570 --> 00:12:01,170
mechanically they don't fail they just

245
00:11:57,970 --> 00:12:03,670
have very crappy batteries so anyway

246
00:12:01,170 --> 00:12:05,770
that was a lot of trying to convince you

247
00:12:03,670 --> 00:12:10,660
to do things for the good of the world

248
00:12:05,770 --> 00:12:14,410
let's go into the actual technicals so

249
00:12:10,660 --> 00:12:15,790
in a car you have bits that want to

250
00:12:14,410 --> 00:12:19,420
communicate to each other sometimes

251
00:12:15,790 --> 00:12:21,189
these bits are very simple it's a light

252
00:12:19,420 --> 00:12:24,339
that has to blink on and off you can

253
00:12:21,190 --> 00:12:27,070
just run a wire and make the wire go on

254
00:12:24,340 --> 00:12:31,900
and off that's I think that was very

255
00:12:27,070 --> 00:12:32,980
obvious however in most vehicles and

256
00:12:31,900 --> 00:12:35,650
especially in EVs

257
00:12:32,980 --> 00:12:37,240
most of the communication going on is a

258
00:12:35,650 --> 00:12:39,790
little bit more complex you want to send

259
00:12:37,240 --> 00:12:42,730
messages that have more information in

260
00:12:39,790 --> 00:12:44,890
them for instance you want to know how

261
00:12:42,730 --> 00:12:47,200
deeply depressed the accelerator pedal

262
00:12:44,890 --> 00:12:49,300
is in an internal combustion energy car

263
00:12:47,200 --> 00:12:52,390
you can technically run a physical wire

264
00:12:49,300 --> 00:12:54,550
to your gas valve you cannot do that in

265
00:12:52,390 --> 00:12:56,740
an EEV you have to somehow instruct the

266
00:12:54,550 --> 00:12:59,250
motor inverter to do stuff you do that

267
00:12:56,740 --> 00:13:02,170
with messages that are fairly complex

268
00:12:59,250 --> 00:13:04,210
for which through historical reasons

269
00:13:02,170 --> 00:13:06,520
people have used canvas and canvas is

270
00:13:04,210 --> 00:13:09,520
pretty much the standard now since the

271
00:13:06,520 --> 00:13:12,610
end of last century for all important

272
00:13:09,520 --> 00:13:15,750
communication in the car one slight

273
00:13:12,610 --> 00:13:15,750
exception inland bus

274
00:13:15,950 --> 00:13:21,630
for those people I'm not sure if

275
00:13:18,450 --> 00:13:27,390
everybody here has has looked at the the

276
00:13:21,630 --> 00:13:30,060
can bus or automotive hacking thingy but

277
00:13:27,390 --> 00:13:31,640
for those not quite familiar with canvas

278
00:13:30,060 --> 00:13:34,069
and I kind of it's just a serial bus

279
00:13:31,640 --> 00:13:37,140
it's a two wire differential bus

280
00:13:34,070 --> 00:13:39,600
everything on the bus shares those two

281
00:13:37,140 --> 00:13:42,180
lines so there's no no daisy chaining or

282
00:13:39,600 --> 00:13:45,150
anything it's just two lines everything

283
00:13:42,180 --> 00:13:48,390
connects to that and what sets canvas

284
00:13:45,150 --> 00:13:52,199
part from other serial buses is that it

285
00:13:48,390 --> 00:13:53,850
is recognized so it's got the

286
00:13:52,200 --> 00:13:55,920
differential signaling over a twisted

287
00:13:53,850 --> 00:14:03,990
pair so it's enforced that uses pair oh

288
00:13:55,920 --> 00:14:06,990
sorry the protocol layer has a built in

289
00:14:03,990 --> 00:14:09,420
CRC on the entire thing and there are

290
00:14:06,990 --> 00:14:11,850
even more rugged features things like

291
00:14:09,420 --> 00:14:14,760
bit stuffing to avoid DC bias in the

292
00:14:11,850 --> 00:14:17,430
signal there is automatic V transmit

293
00:14:14,760 --> 00:14:18,689
again this is all vertical layer this is

294
00:14:17,430 --> 00:14:20,370
all stuff you don't have to actually

295
00:14:18,690 --> 00:14:23,840
care about if you write software for it

296
00:14:20,370 --> 00:14:27,120
this is all in the can transceiver chips

297
00:14:23,840 --> 00:14:29,430
there is like a really cool stuff like

298
00:14:27,120 --> 00:14:31,200
automatic retransmission of messages

299
00:14:29,430 --> 00:14:34,709
when they fail to transmit for some

300
00:14:31,200 --> 00:14:37,530
reason there is a passive passive mode

301
00:14:34,710 --> 00:14:41,550
for startup so in a vehicle you often

302
00:14:37,530 --> 00:14:44,060
have small ECU's in the in vehicle that

303
00:14:41,550 --> 00:14:46,890
need time to start up they run an OS of

304
00:14:44,060 --> 00:14:49,079
some sort maybe just a real-time OS but

305
00:14:46,890 --> 00:14:51,569
it still needs 100 milliseconds to

306
00:14:49,080 --> 00:14:53,430
startup when you start talking to it it

307
00:14:51,570 --> 00:14:56,250
initiates the startup but cannot talk

308
00:14:53,430 --> 00:14:59,780
back yet so there are all kinds of very

309
00:14:56,250 --> 00:15:02,790
interesting features to fix that and

310
00:14:59,780 --> 00:15:07,740
also part of the regularization is the

311
00:15:02,790 --> 00:15:09,360
fact that it is very slow to modern

312
00:15:07,740 --> 00:15:09,930
standards one megabit per second is

313
00:15:09,360 --> 00:15:13,200
nothing

314
00:15:09,930 --> 00:15:15,839
and this is the it's transmission rate

315
00:15:13,200 --> 00:15:18,180
though it's a bit rate of the canvas

316
00:15:15,840 --> 00:15:19,770
itself in fact as you will see on the

317
00:15:18,180 --> 00:15:21,479
next slide one megabit per second

318
00:15:19,770 --> 00:15:23,819
actually means you can only transmit

319
00:15:21,480 --> 00:15:25,890
about one to two thousand messages per

320
00:15:23,820 --> 00:15:28,190
second over the bus without overloading

321
00:15:25,890 --> 00:15:28,189
it

322
00:15:28,560 --> 00:15:34,498
so this is a kind of frame and what I

323
00:15:31,769 --> 00:15:36,870
want to convey to you here is that it's

324
00:15:34,499 --> 00:15:41,670
actually very simple I'm not sure if I

325
00:15:36,870 --> 00:15:43,709
chose the correct image for that but it

326
00:15:41,670 --> 00:15:45,990
is actually very simple so what you see

327
00:15:43,709 --> 00:15:49,800
here is the complexities of the signal

328
00:15:45,990 --> 00:15:53,689
there is this here are the actual

329
00:15:49,800 --> 00:15:57,029
physical canvas lines and here again

330
00:15:53,689 --> 00:15:58,889
doing all kinds of stuff and there are

331
00:15:57,029 --> 00:16:01,259
as there's an arbitration feel and

332
00:15:58,889 --> 00:16:04,709
they're here here's the CRC - 15 bits

333
00:16:01,259 --> 00:16:06,899
CRC very cool and there is a special and

334
00:16:04,709 --> 00:16:09,869
a frame thing to make sure that you're

335
00:16:06,899 --> 00:16:12,329
making the best passes again and all of

336
00:16:09,870 --> 00:16:16,470
that is irrelevant all you need to know

337
00:16:12,329 --> 00:16:19,138
about can is that it uses an ID that's

338
00:16:16,470 --> 00:16:21,449
part of that's this green bit and it has

339
00:16:19,139 --> 00:16:24,449
data 1 to 8 bytes there is only one byte

340
00:16:21,449 --> 00:16:26,399
here in the red area and that's it that

341
00:16:24,449 --> 00:16:29,849
is CEM there is no more information

342
00:16:26,399 --> 00:16:36,120
useful or relevant to the end-user than

343
00:16:29,850 --> 00:16:38,610
the ID and the data so now we know this

344
00:16:36,120 --> 00:16:42,870
we have a rudimentary understanding of

345
00:16:38,610 --> 00:16:45,180
can we can look at the consequences and

346
00:16:42,870 --> 00:16:47,449
here I want to go into the mindset of

347
00:16:45,180 --> 00:16:49,709
somebody trying to reverse engineer or

348
00:16:47,449 --> 00:16:52,079
our do things like man-in-the-middle

349
00:16:49,709 --> 00:16:54,719
attacks figuring out what is going on on

350
00:16:52,079 --> 00:16:58,050
the bus and how can I use this

351
00:16:54,720 --> 00:17:03,000
information to change behavior of the

352
00:16:58,050 --> 00:17:07,530
car so the bus is shared and is a

353
00:17:03,000 --> 00:17:10,439
surprisingly useful consequence of the

354
00:17:07,530 --> 00:17:12,809
bus there there is no doctrine allottee

355
00:17:10,439 --> 00:17:16,230
everything is shared on two lines so you

356
00:17:12,809 --> 00:17:18,839
cannot know where a message originates

357
00:17:16,230 --> 00:17:20,579
and where it's going to you can never

358
00:17:18,839 --> 00:17:22,319
know where it's going to but I will show

359
00:17:20,579 --> 00:17:25,639
you that there is a way with the man and

360
00:17:22,319 --> 00:17:28,530
will attack to show where it came from

361
00:17:25,640 --> 00:17:30,720
there is because everything is shared

362
00:17:28,530 --> 00:17:33,030
knows have to wait for each other

363
00:17:30,720 --> 00:17:35,340
to stop talking before they can start a

364
00:17:33,030 --> 00:17:37,500
transmission so there is no definite

365
00:17:35,340 --> 00:17:40,379
timing there's not even definite

366
00:17:37,500 --> 00:17:41,940
ordering of messages there are a few can

367
00:17:40,380 --> 00:17:45,600
protocols like FD can that

368
00:17:41,940 --> 00:17:51,299
can do this that's a pun sorry for that

369
00:17:45,600 --> 00:17:54,418
and but no in general canvas has no

370
00:17:51,299 --> 00:17:56,220
definite timing ordering and the most

371
00:17:54,419 --> 00:17:58,409
interesting feature that we're going to

372
00:17:56,220 --> 00:18:00,809
use and we're going to exploit is the

373
00:17:58,409 --> 00:18:03,929
messages are extremely short eight bytes

374
00:18:00,809 --> 00:18:07,230
at the maximum that is almost no payload

375
00:18:03,929 --> 00:18:09,210
that is basically impossible to do any

376
00:18:07,230 --> 00:18:12,570
kind of encryption that you cannot just

377
00:18:09,210 --> 00:18:15,059
rainbow table in a second in Lua or

378
00:18:12,570 --> 00:18:17,070
something like even the most inefficient

379
00:18:15,059 --> 00:18:17,549
way to crack that is going to be very

380
00:18:17,070 --> 00:18:22,918
fast

381
00:18:17,549 --> 00:18:24,990
so nobody bothers you also have to be

382
00:18:22,919 --> 00:18:28,259
very thrifty with your messages so the

383
00:18:24,990 --> 00:18:30,840
messages often contain just an integer

384
00:18:28,259 --> 00:18:34,679
value they don't contain any special

385
00:18:30,840 --> 00:18:36,299
padding or strange state machines rekha

386
00:18:34,679 --> 00:18:38,909
and stuff even if they contain state

387
00:18:36,299 --> 00:18:42,690
machines they are often like a nibble

388
00:18:38,909 --> 00:18:45,000
for bits not even a full byte this is

389
00:18:42,690 --> 00:18:50,429
really useful for reverse engineering

390
00:18:45,000 --> 00:18:54,029
all right so we've seen everything we

391
00:18:50,429 --> 00:18:57,389
need to know to go and look at the

392
00:18:54,029 --> 00:18:59,460
Nissan Leaf evie can so this is the

393
00:18:57,389 --> 00:19:02,639
canvas that runs between all the

394
00:18:59,460 --> 00:19:04,860
drivetrain components I will just very

395
00:19:02,639 --> 00:19:08,699
click quickly go into the lingo for

396
00:19:04,860 --> 00:19:11,549
Nissan this is common to most Japanese

397
00:19:08,700 --> 00:19:13,559
cars by the way so there's the VCM this

398
00:19:11,549 --> 00:19:17,639
is the vehicle control module you can

399
00:19:13,559 --> 00:19:21,120
see this as the main computer inside any

400
00:19:17,639 --> 00:19:22,918
Nissan vehicle then for some reason the

401
00:19:21,120 --> 00:19:24,989
air-conditioning is connected to the

402
00:19:22,919 --> 00:19:28,460
Eevee cam this is because the air

403
00:19:24,990 --> 00:19:31,080
conditioning runs on the mean - spidery

404
00:19:28,460 --> 00:19:33,269
there's the TCU the telecommunications

405
00:19:31,080 --> 00:19:36,178
control units might talk about that a

406
00:19:33,269 --> 00:19:37,350
little bit later there's a shifter you

407
00:19:36,179 --> 00:19:38,879
would think there are no gears in an

408
00:19:37,350 --> 00:19:41,699
electric car but you still need to put

409
00:19:38,879 --> 00:19:43,500
your car into park and dryer there's a

410
00:19:41,700 --> 00:19:46,409
traction motor inverter I don't know if

411
00:19:43,500 --> 00:19:49,049
this one uses a acronym for that the

412
00:19:46,409 --> 00:19:51,529
onboard charger and the lithium battery

413
00:19:49,049 --> 00:19:54,179
control this is basically the battery

414
00:19:51,529 --> 00:19:55,710
and one thing that is clearly missing

415
00:19:54,179 --> 00:19:59,820
for an entire Drive

416
00:19:55,710 --> 00:20:03,090
is where is the electron and the brake

417
00:19:59,820 --> 00:20:05,370
pedal they're not on here obviously I

418
00:20:03,090 --> 00:20:07,559
drew this in Inkscape so I could just

419
00:20:05,370 --> 00:20:10,010
have left it off but really it is not on

420
00:20:07,559 --> 00:20:11,549
the Eevee campus it is somewhere else

421
00:20:10,010 --> 00:20:14,010
where could it be

422
00:20:11,549 --> 00:20:15,480
well obviously it's not going to be in

423
00:20:14,010 --> 00:20:19,279
the air conditioning it's not going to

424
00:20:15,480 --> 00:20:21,539
be in any of these it would be very very

425
00:20:19,279 --> 00:20:23,490
interesting to put it directly on the

426
00:20:21,539 --> 00:20:24,899
traction motor but that's not possible

427
00:20:23,490 --> 00:20:27,149
because you have to depress the brake

428
00:20:24,899 --> 00:20:28,799
pedal to start the car and the truck

429
00:20:27,149 --> 00:20:31,408
motor inverter is not on at that point

430
00:20:28,799 --> 00:20:34,590
so it cannot be anywhere in this chain

431
00:20:31,409 --> 00:20:39,230
it has to be relayed from the VCM and

432
00:20:34,590 --> 00:20:41,399
there has to be something here that is

433
00:20:39,230 --> 00:20:44,100
connected to a different bus or a

434
00:20:41,399 --> 00:20:48,389
different direct connection that sends

435
00:20:44,100 --> 00:20:51,000
messages to the traction motor so let's

436
00:20:48,390 --> 00:20:53,340
reverse engineer this let's try to see

437
00:20:51,000 --> 00:20:57,690
how a man-in-the-middle attack is useful

438
00:20:53,340 --> 00:21:01,199
in looking at modifying for instance the

439
00:20:57,690 --> 00:21:03,149
response of your pedals - to this

440
00:21:01,200 --> 00:21:05,370
electric vehicle for instance to improve

441
00:21:03,149 --> 00:21:10,168
performance to increase power to do

442
00:21:05,370 --> 00:21:11,789
anything you like so here is the

443
00:21:10,169 --> 00:21:14,490
man-in-the-middle module this is what

444
00:21:11,789 --> 00:21:18,690
the whole talk is about I photographed

445
00:21:14,490 --> 00:21:21,630
it in its natural habitat on a bit of

446
00:21:18,690 --> 00:21:23,370
carpet in the car yes the VCM is

447
00:21:21,630 --> 00:21:25,169
somewhere here I have very crudely

448
00:21:23,370 --> 00:21:26,820
soldered this this is literally the

449
00:21:25,169 --> 00:21:29,370
prototype car I'm still driving like

450
00:21:26,820 --> 00:21:31,110
this so if people are in my on the

451
00:21:29,370 --> 00:21:33,360
passenger side they have to like scoot

452
00:21:31,110 --> 00:21:35,879
their feet to the side a little bit

453
00:21:33,360 --> 00:21:38,189
because I basically I want to be able to

454
00:21:35,880 --> 00:21:42,870
physically work on these wires at any

455
00:21:38,190 --> 00:21:49,669
time anyway the manual attack happens

456
00:21:42,870 --> 00:21:52,500
here so why do we do that ah let's just

457
00:21:49,669 --> 00:21:56,130
take a look at what the Amana tunnel

458
00:21:52,500 --> 00:21:59,450
board does so here we have the output of

459
00:21:56,130 --> 00:22:02,039
the Amana middle board

460
00:21:59,450 --> 00:22:04,740
these are cat messages and I'll just

461
00:22:02,039 --> 00:22:07,679
quickly go through the meaning of all

462
00:22:04,740 --> 00:22:08,549
these lines of code so the first column

463
00:22:07,679 --> 00:22:11,549
shows

464
00:22:08,549 --> 00:22:18,989
where the messages are originating from

465
00:22:11,549 --> 00:22:21,479
so in this particular example number one

466
00:22:18,989 --> 00:22:23,459
bus number one is connected to the DCM

467
00:22:21,479 --> 00:22:25,559
and bus number two is connected to the

468
00:22:23,459 --> 00:22:27,269
rest so you can see that there are

469
00:22:25,559 --> 00:22:29,609
actually a lot of messages going from

470
00:22:27,269 --> 00:22:33,419
two to one obviously because there are

471
00:22:29,609 --> 00:22:35,519
more nodes connected to bus two than two

472
00:22:33,419 --> 00:22:37,369
plus one and some go the other way as

473
00:22:35,519 --> 00:22:42,499
well

474
00:22:37,369 --> 00:22:46,019
the second column shows the the ID and I

475
00:22:42,499 --> 00:22:48,570
put on on a slide before that this ID

476
00:22:46,019 --> 00:22:52,499
can be either 11 or 29 bits obviously

477
00:22:48,570 --> 00:22:54,570
these are only 11 bits IDs then the

478
00:22:52,499 --> 00:22:59,489
third column shows the data so this is

479
00:22:54,570 --> 00:23:02,399
all in sequence the eight bytes that can

480
00:22:59,489 --> 00:23:03,839
exist on the canvas you can see the data

481
00:23:02,399 --> 00:23:06,629
length is not is not always the same

482
00:23:03,839 --> 00:23:08,700
here is one message that is only six

483
00:23:06,629 --> 00:23:14,849
bytes long here's one that's only 1 byte

484
00:23:08,700 --> 00:23:18,719
long so we want to know these motor

485
00:23:14,849 --> 00:23:21,329
control messages how do we start

486
00:23:18,719 --> 00:23:22,859
identifying this we have a very very

487
00:23:21,329 --> 00:23:25,499
small slice just to be clear this is

488
00:23:22,859 --> 00:23:28,678
about three dozen messages on the canvas

489
00:23:25,499 --> 00:23:30,659
the canvas has a couple hundred messages

490
00:23:28,679 --> 00:23:33,779
per second so this is a fraction of a

491
00:23:30,659 --> 00:23:36,329
second still though this should be

492
00:23:33,779 --> 00:23:40,429
enough information for us to identify

493
00:23:36,329 --> 00:23:42,658
our target message to decode it because

494
00:23:40,429 --> 00:23:43,649
these motor control messages they have

495
00:23:42,659 --> 00:23:46,859
to be very fast

496
00:23:43,649 --> 00:23:49,320
if you move your pedal around or do

497
00:23:46,859 --> 00:23:51,539
anything or if the car decides to make

498
00:23:49,320 --> 00:23:53,639
an emergency stop it has to respond

499
00:23:51,539 --> 00:23:54,929
within tens of milliseconds maybe a

500
00:23:53,639 --> 00:23:57,029
hundred milliseconds so there should be

501
00:23:54,929 --> 00:23:59,339
enough we should see very frequent

502
00:23:57,029 --> 00:24:03,029
messages that are related to the motor

503
00:23:59,339 --> 00:24:04,408
preferred to the traction motor they

504
00:24:03,029 --> 00:24:06,059
have to go from the VCM to the inverter

505
00:24:04,409 --> 00:24:10,379
so they have to be messages that go from

506
00:24:06,059 --> 00:24:13,320
1 to 2 and they have to have some kind

507
00:24:10,379 --> 00:24:15,418
of possible data that looks like motor

508
00:24:13,320 --> 00:24:17,279
control data we don't know for sure what

509
00:24:15,419 --> 00:24:20,909
it looks like yet but we'll figure it

510
00:24:17,279 --> 00:24:22,110
out so we can just cross out everything

511
00:24:20,909 --> 00:24:25,500
that goes from bus 2 to 1

512
00:24:22,110 --> 00:24:27,120
very simply we know that the messages

513
00:24:25,500 --> 00:24:28,260
that we're looking for have to be going

514
00:24:27,120 --> 00:24:29,760
in this direction

515
00:24:28,260 --> 00:24:32,240
and this is why this man in the middle

516
00:24:29,760 --> 00:24:35,908
attack is so powerful you can just

517
00:24:32,240 --> 00:24:38,220
immediately erase 90% of all your

518
00:24:35,909 --> 00:24:41,070
messages by exploiting the

519
00:24:38,220 --> 00:24:46,860
directionality of being in the middle of

520
00:24:41,070 --> 00:24:49,470
a camera now we see that there are only

521
00:24:46,860 --> 00:24:52,199
three IDs left this is I mean it's an

522
00:24:49,470 --> 00:24:53,760
old car I can imagine that newer

523
00:24:52,200 --> 00:24:56,610
electric cars have many more ideas that

524
00:24:53,760 --> 00:24:59,549
that could be eligible but this one only

525
00:24:56,610 --> 00:25:03,750
has the three it's got one two four one

526
00:24:59,549 --> 00:25:09,690
f2 and fifty see right here the rest is

527
00:25:03,750 --> 00:25:12,840
all one d4 1 f2 24 1 f2 24 1 f2 etc this

528
00:25:09,690 --> 00:25:15,720
50 C message doesn't happen often enough

529
00:25:12,840 --> 00:25:18,090
we can discount it fairly easily by the

530
00:25:15,720 --> 00:25:20,100
fact that it's just it only happens

531
00:25:18,090 --> 00:25:24,059
probably once every hundred milliseconds

532
00:25:20,100 --> 00:25:25,918
or slower it's just a chance encounter

533
00:25:24,059 --> 00:25:32,250
with this message in this particular

534
00:25:25,919 --> 00:25:34,409
part of the trace so let's just trace

535
00:25:32,250 --> 00:25:35,940
these messages in particular this by the

536
00:25:34,409 --> 00:25:40,799
way is notepad plus plus if anybody

537
00:25:35,940 --> 00:25:43,289
recognizes the search function I just

538
00:25:40,799 --> 00:25:48,750
selected all of the one of two messages

539
00:25:43,289 --> 00:25:50,129
in the log and we can see that this this

540
00:25:48,750 --> 00:25:54,659
is a trace while driving while

541
00:25:50,130 --> 00:25:57,630
manipulating the electron pedal and it's

542
00:25:54,659 --> 00:26:01,380
not doing anything like every message is

543
00:25:57,630 --> 00:26:05,610
identical except for on the end but this

544
00:26:01,380 --> 00:26:09,960
seems to be periodic so there's is 1 2 3

545
00:26:05,610 --> 00:26:16,860
0 1 2 3 0 goes on periodically same for

546
00:26:09,960 --> 00:26:20,429
the last byte so by elimination 1.d4 has

547
00:26:16,860 --> 00:26:24,199
to be the traction motor message there's

548
00:26:20,429 --> 00:26:27,980
just no other way so let's look at that

549
00:26:24,200 --> 00:26:30,149
here's the one D for trace and

550
00:26:27,980 --> 00:26:31,919
immediately we can see there's a lot of

551
00:26:30,149 --> 00:26:33,779
static data in there as well they're not

552
00:26:31,919 --> 00:26:36,060
being very thrifty with their messages

553
00:26:33,779 --> 00:26:39,450
so the first 2 bytes complete

554
00:26:36,060 --> 00:26:41,909
static these two bytes are actually not

555
00:26:39,450 --> 00:26:43,620
by sir there's the last nibble of this

556
00:26:41,910 --> 00:26:50,850
fight and the personable there's a whole

557
00:26:43,620 --> 00:26:55,199
static this last bite is like all over

558
00:26:50,850 --> 00:26:56,879
the place v c9 b p2 7y cheddar l so does

559
00:26:55,200 --> 00:26:59,480
anybody recognize what this could

560
00:26:56,880 --> 00:27:03,330
possibly be what's it's a good candidate

561
00:26:59,480 --> 00:27:10,070
yes exactly it's the CRC so it's a CRC

562
00:27:03,330 --> 00:27:13,230
with in this case root a hex 85 I think

563
00:27:10,070 --> 00:27:15,300
why they do this I don't know this is

564
00:27:13,230 --> 00:27:16,820
only an 8-bit to your C it's not even a

565
00:27:15,300 --> 00:27:20,930
good one because it's only on 7 bytes

566
00:27:16,820 --> 00:27:25,889
there's already a 15 bit CRC in canvas

567
00:27:20,930 --> 00:27:30,180
so like this is much more likely to

568
00:27:25,890 --> 00:27:33,120
collide especially if you stack your C's

569
00:27:30,180 --> 00:27:34,620
so I don't know why they do this they

570
00:27:33,120 --> 00:27:37,139
have this in multiple messages on the

571
00:27:34,620 --> 00:27:39,780
innocent leave canvas but anyway it's

572
00:27:37,140 --> 00:27:41,220
obviously a C or C so we're left with oh

573
00:27:39,780 --> 00:27:44,490
of course

574
00:27:41,220 --> 00:27:50,220
sorry we have another bit of periodic

575
00:27:44,490 --> 00:27:53,370
data here this goes for 8 C or 8 C 0 or

576
00:27:50,220 --> 00:27:56,100
eight see obviously periodic and by

577
00:27:53,370 --> 00:27:58,500
elimination this has to be the mode of

578
00:27:56,100 --> 00:28:00,510
control word there is nothing on the bus

579
00:27:58,500 --> 00:28:03,030
just by elimination this is the only

580
00:28:00,510 --> 00:28:05,160
thing that could ever be a motor control

581
00:28:03,030 --> 00:28:08,160
signal and we can see that it varies a

582
00:28:05,160 --> 00:28:12,900
little bit randomly is goes from FP to I

583
00:28:08,160 --> 00:28:14,900
have 9 it's clearly signed so because

584
00:28:12,900 --> 00:28:20,850
the first bit and basically all the bits

585
00:28:14,900 --> 00:28:23,190
at the top of the word are ones this is

586
00:28:20,850 --> 00:28:24,750
probably a negative thing so at this

587
00:28:23,190 --> 00:28:27,270
point I must have been breaking I guess

588
00:28:24,750 --> 00:28:31,080
or at least the traction motor must have

589
00:28:27,270 --> 00:28:33,540
been breaking but like clearly that has

590
00:28:31,080 --> 00:28:35,429
to be it that's how you do rehearsal

591
00:28:33,540 --> 00:28:37,590
engineering on a canvas with a

592
00:28:35,430 --> 00:28:41,510
man-in-the-middle attack this is a very

593
00:28:37,590 --> 00:28:43,889
quick attack this way you can figure out

594
00:28:41,510 --> 00:28:46,860
functionality in the car in a matter of

595
00:28:43,890 --> 00:28:49,790
like tens of minutes even including

596
00:28:46,860 --> 00:28:52,370
setup so super use

597
00:28:49,790 --> 00:28:56,629
super-nice I've only talked about the

598
00:28:52,370 --> 00:29:00,620
attack part now let's go and see how you

599
00:28:56,630 --> 00:29:03,530
can actually do any good with it so we

600
00:29:00,620 --> 00:29:05,989
compiled all of these things into a big

601
00:29:03,530 --> 00:29:08,540
Excel document this is a not actually

602
00:29:05,990 --> 00:29:11,210
something that I compiled at all this is

603
00:29:08,540 --> 00:29:13,639
something that has existed for four or

604
00:29:11,210 --> 00:29:16,600
five years people on the - Emily's

605
00:29:13,640 --> 00:29:19,400
internet forum have compiled this from

606
00:29:16,600 --> 00:29:21,590
just sniffing ham pack it's not even man

607
00:29:19,400 --> 00:29:24,440
in the middling it but just sniffing it

608
00:29:21,590 --> 00:29:26,840
and there's a lot of missing data stuff

609
00:29:24,440 --> 00:29:29,720
that I've included in our company have

610
00:29:26,840 --> 00:29:32,449
been able to figure out so this was

611
00:29:29,720 --> 00:29:34,340
already existent and you can see there's

612
00:29:32,450 --> 00:29:36,470
a lot of information to clarity glean

613
00:29:34,340 --> 00:29:41,030
from just looking at traces looking at

614
00:29:36,470 --> 00:29:46,490
sniffing packages so what can you do

615
00:29:41,030 --> 00:29:47,990
well we can improve improve the car we

616
00:29:46,490 --> 00:29:49,670
can put the batteries in

617
00:29:47,990 --> 00:29:51,650
but obviously putting the batteries in

618
00:29:49,670 --> 00:29:53,120
is not enough you have to report to the

619
00:29:51,650 --> 00:29:55,280
user that there is actually more

620
00:29:53,120 --> 00:29:57,199
capacity in the car otherwise they would

621
00:29:55,280 --> 00:30:00,170
have no idea how far they could drive

622
00:29:57,200 --> 00:30:03,230
before the battery goes empty so one of

623
00:30:00,170 --> 00:30:05,120
the possibilities for using this man in

624
00:30:03,230 --> 00:30:06,770
the middle attack for good is increasing

625
00:30:05,120 --> 00:30:09,010
the reported battery capacity so we just

626
00:30:06,770 --> 00:30:13,250
look for the message the only message a

627
00:30:09,010 --> 00:30:16,340
10-bit value on bits or on bytes

628
00:30:13,250 --> 00:30:18,620
zero and the top two bits of white one

629
00:30:16,340 --> 00:30:21,439
that represents the available charge

630
00:30:18,620 --> 00:30:25,239
signals so this is the name for how much

631
00:30:21,440 --> 00:30:29,500
is left in your battery I modify it and

632
00:30:25,240 --> 00:30:32,090
voila it works you get the correct

633
00:30:29,500 --> 00:30:35,750
amount of kilometers or miles from your

634
00:30:32,090 --> 00:30:40,520
- and the user can use their extender

635
00:30:35,750 --> 00:30:43,180
battery as normal we can increase

636
00:30:40,520 --> 00:30:46,970
regenerative regenerative braking so

637
00:30:43,180 --> 00:30:51,680
this is a bug in especially the oldest

638
00:30:46,970 --> 00:30:55,040
generation of Nissan Leaf where as the

639
00:30:51,680 --> 00:30:57,140
battery pack degrades slightly the car

640
00:30:55,040 --> 00:30:58,670
just refuses to use regenerative braking

641
00:30:57,140 --> 00:31:01,130
and you can imagine regenerative braking

642
00:30:58,670 --> 00:31:03,200
is when you brake and put the energy

643
00:31:01,130 --> 00:31:06,200
back into the battery instead

644
00:31:03,200 --> 00:31:09,950
of using your brake pads and just losing

645
00:31:06,200 --> 00:31:11,330
it all that energy is heat it's really

646
00:31:09,950 --> 00:31:14,029
useful especially with these tiny

647
00:31:11,330 --> 00:31:15,860
batteries that the old cars have to use

648
00:31:14,029 --> 00:31:19,820
regenerative braking in stop-and-go

649
00:31:15,860 --> 00:31:21,408
traffic to save some energy so it's very

650
00:31:19,820 --> 00:31:24,590
annoying that for some reason there's

651
00:31:21,409 --> 00:31:27,710
some bug in Nissan's firmware originally

652
00:31:24,590 --> 00:31:30,408
as they programmed it ten years maybe

653
00:31:27,710 --> 00:31:33,110
more than ten years ago where the

654
00:31:30,409 --> 00:31:34,549
battery messages are misinterpreted to

655
00:31:33,110 --> 00:31:38,110
show that the barrier has very high

656
00:31:34,549 --> 00:31:40,549
internal resistance and cannot cope with

657
00:31:38,110 --> 00:31:43,100
regenerative braking as well and you

658
00:31:40,549 --> 00:31:45,490
would get the effect that the car

659
00:31:43,100 --> 00:31:48,408
basically had no regenerative braking

660
00:31:45,490 --> 00:31:50,120
even as the battery gets very empty

661
00:31:48,409 --> 00:31:53,299
there was still not not full

662
00:31:50,120 --> 00:31:56,989
regenerative braking the regenerative

663
00:31:53,299 --> 00:32:00,190
braking is or the general power is shown

664
00:31:56,990 --> 00:32:03,950
by these bubbles so if these bubbles

665
00:32:00,190 --> 00:32:06,169
yeah show up on your dashboard I guess

666
00:32:03,950 --> 00:32:09,350
you can use the power so to the right

667
00:32:06,169 --> 00:32:11,779
this little white blip that's the

668
00:32:09,350 --> 00:32:13,668
current power being used going to the

669
00:32:11,779 --> 00:32:15,860
right is power being used for

670
00:32:13,669 --> 00:32:17,720
acceleration and going to the left is

671
00:32:15,860 --> 00:32:18,979
perm being used for regenerative braking

672
00:32:17,720 --> 00:32:22,519
and you can see that all five

673
00:32:18,980 --> 00:32:25,250
regenerative bubbles are available even

674
00:32:22,519 --> 00:32:27,980
though this car is fully charged has the

675
00:32:25,250 --> 00:32:30,019
extended battery so this is extremely

676
00:32:27,980 --> 00:32:32,600
useful for instance this client they

677
00:32:30,019 --> 00:32:35,659
went to the Alps and he was able to

678
00:32:32,600 --> 00:32:38,059
recoup a couple of kilowatt hours going

679
00:32:35,659 --> 00:32:42,409
down in the Salvio past even though his

680
00:32:38,059 --> 00:32:44,629
battery was so fairly full I saved him a

681
00:32:42,409 --> 00:32:46,399
lot of kilometers of range which would

682
00:32:44,630 --> 00:32:51,380
not be possible with the amount of my

683
00:32:46,399 --> 00:32:53,090
car and of course this is the thing I

684
00:32:51,380 --> 00:32:55,700
did last

685
00:32:53,090 --> 00:32:57,590
so the original leaf had an estimated

686
00:32:55,700 --> 00:32:59,000
range of about a hundred kilometers if

687
00:32:57,590 --> 00:33:01,428
the body was completely full it was a

688
00:32:59,000 --> 00:33:03,769
really nice day you would get an

689
00:33:01,429 --> 00:33:06,710
indicated range maybe 120 under 30

690
00:33:03,769 --> 00:33:09,200
kilometers I've upgraded my car to about

691
00:33:06,710 --> 00:33:12,320
500 kilometers of range to about 60

692
00:33:09,200 --> 00:33:14,570
kilowatt hours using a completely

693
00:33:12,320 --> 00:33:16,590
foreign battery well actually the

694
00:33:14,570 --> 00:33:20,039
battery from a newer generation is

695
00:33:16,590 --> 00:33:23,309
the original batteries were about 25 24

696
00:33:20,039 --> 00:33:25,289
kilowatt hours the new ones are 40 I had

697
00:33:23,309 --> 00:33:27,120
the extended battery in my trunk so

698
00:33:25,289 --> 00:33:31,408
altogether I have about 60 kilowatt

699
00:33:27,120 --> 00:33:32,908
hours in place of the original degrade

700
00:33:31,409 --> 00:33:35,070
at 24 kilowatt hour battery which

701
00:33:32,909 --> 00:33:37,799
actually had more like 15 or 16 kilowatt

702
00:33:35,070 --> 00:33:40,110
hours of usable capacity left so this is

703
00:33:37,799 --> 00:33:42,029
a massive improvement and the only

704
00:33:40,110 --> 00:33:43,590
reason this is possible is because we

705
00:33:42,029 --> 00:33:46,289
have the man in the middle doing

706
00:33:43,590 --> 00:33:50,730
translation between the newer and SM

707
00:33:46,289 --> 00:33:53,399
battery and the old Nissan computer she

708
00:33:50,730 --> 00:33:55,230
would not have this obviously the

709
00:33:53,399 --> 00:33:58,580
battery wouldn't understand anything

710
00:33:55,230 --> 00:34:01,350
happening in the car and vice versa and

711
00:33:58,580 --> 00:34:02,879
yet this is almost arranged as the Tesla

712
00:34:01,350 --> 00:34:09,060
Model 3 so that's why this is just a

713
00:34:02,879 --> 00:34:14,310
clickbait headline anyway what's the

714
00:34:09,060 --> 00:34:15,239
time roughly uh I don't have a how much

715
00:34:14,310 --> 00:34:21,210
time do I have left

716
00:34:15,239 --> 00:34:24,328
I should probably see if there are any

717
00:34:21,210 --> 00:34:26,668
questions before I try to do this all

718
00:34:24,329 --> 00:34:28,770
right so what I try to show today is

719
00:34:26,668 --> 00:34:32,839
that man-in-the-middle attacks on

720
00:34:28,770 --> 00:34:35,129
cameras are not just a security issue I

721
00:34:32,839 --> 00:34:38,129
have a lot more to tell about the

722
00:34:35,129 --> 00:34:41,190
security side of things as well but in

723
00:34:38,129 --> 00:34:44,449
this talk it's just I want to show you

724
00:34:41,190 --> 00:34:47,609
can improve old cars especially old v's

725
00:34:44,449 --> 00:34:49,469
it's a complete waste that these cars

726
00:34:47,609 --> 00:34:52,828
are basically only being used as

727
00:34:49,469 --> 00:34:58,470
shopping cars going 20 kilometers at a

728
00:34:52,829 --> 00:35:01,890
time to ticket groceries maybe be a

729
00:34:58,470 --> 00:35:04,049
convenient car to give to your kid

730
00:35:01,890 --> 00:35:08,790
because it doesn't go very far and

731
00:35:04,050 --> 00:35:10,369
doesn't go very fast I mean these cars

732
00:35:08,790 --> 00:35:13,619
are just mechanically completely good

733
00:35:10,369 --> 00:35:16,200
they're ugly as sin but if you can get

734
00:35:13,619 --> 00:35:17,700
over that they're still very fun to

735
00:35:16,200 --> 00:35:21,118
drive it's an electric car it's still

736
00:35:17,700 --> 00:35:23,430
got loads of torque it is a good car and

737
00:35:21,119 --> 00:35:25,560
it's just got this bad battery and if

738
00:35:23,430 --> 00:35:27,450
you just fix that bad battery do the

739
00:35:25,560 --> 00:35:29,640
engineering approach we can make these

740
00:35:27,450 --> 00:35:30,450
into cars that can drive another 20

741
00:35:29,640 --> 00:35:34,259
years

742
00:35:30,450 --> 00:35:37,020
probably they're super reliable so I

743
00:35:34,260 --> 00:35:39,930
think that we should be using our

744
00:35:37,020 --> 00:35:43,470
security efforts in this field for good

745
00:35:39,930 --> 00:35:47,279
for trying to yeah repurpose these old

746
00:35:43,470 --> 00:35:47,910
cars given a new lease on life so yeah

747
00:35:47,280 --> 00:35:57,480
that's it

748
00:35:47,910 --> 00:35:59,848
any questions yeah I have it I have a

749
00:35:57,480 --> 00:36:01,460
question you on the slide you said you

750
00:35:59,849 --> 00:36:03,900
didn't exactly know why they're AC

751
00:36:01,460 --> 00:36:06,410
communicators on the canvas I was

752
00:36:03,900 --> 00:36:08,700
wondering whether the whether the

753
00:36:06,410 --> 00:36:10,290
environmental control system was also

754
00:36:08,700 --> 00:36:13,980
did the environmental controls for the

755
00:36:10,290 --> 00:36:16,109
batteries haha well miss Lana is one of

756
00:36:13,980 --> 00:36:17,490
these companies that decided that even

757
00:36:16,109 --> 00:36:19,529
though their battery overheats all the

758
00:36:17,490 --> 00:36:21,180
time they don't need any better cooling

759
00:36:19,530 --> 00:36:23,549
or battery well they do have battery

760
00:36:21,180 --> 00:36:28,230
heaters in there very cold climates did

761
00:36:23,549 --> 00:36:29,759
I do the thing I think yes yeah they

762
00:36:28,230 --> 00:36:33,930
have almost no thermal management in

763
00:36:29,760 --> 00:36:37,260
batteries so no the the AC only is on

764
00:36:33,930 --> 00:36:39,930
there because of the tcu actually so

765
00:36:37,260 --> 00:36:43,589
that telecommunication control unit it's

766
00:36:39,930 --> 00:36:46,230
a little box that connects to a cellular

767
00:36:43,589 --> 00:36:49,640
network it's always on and it has the

768
00:36:46,230 --> 00:36:52,829
capability of starting up the entire

769
00:36:49,640 --> 00:36:54,960
campus so you can remotely log into your

770
00:36:52,829 --> 00:36:58,410
car see helpful the battery is if it's

771
00:36:54,960 --> 00:37:00,480
still charging and also remotely start

772
00:36:58,410 --> 00:37:02,098
the AC start the heating and I do that

773
00:37:00,480 --> 00:37:05,490
kind of stuff so that's the only reason

774
00:37:02,099 --> 00:37:07,500
it's on there it's still a bit weird

775
00:37:05,490 --> 00:37:10,229
there are other ways of doing this but I

776
00:37:07,500 --> 00:37:13,010
mean that's the actual reason I think I

777
00:37:10,230 --> 00:37:14,309
mean I don't know the design specs so

778
00:37:13,010 --> 00:37:17,309
all right

779
00:37:14,309 --> 00:37:19,410
any more questions hi I assume that you

780
00:37:17,309 --> 00:37:21,900
added batteries rather than replacing

781
00:37:19,410 --> 00:37:23,339
them to give you the extra capacity is

782
00:37:21,900 --> 00:37:25,200
there any difference between the new

783
00:37:23,339 --> 00:37:27,119
batteries you added in terms of that

784
00:37:25,200 --> 00:37:29,430
ability to charge compared to the old

785
00:37:27,119 --> 00:37:31,890
ones yeah that'd give you some any

786
00:37:29,430 --> 00:37:33,839
problems in the way that they have the

787
00:37:31,890 --> 00:37:37,650
difference between the new batteries

788
00:37:33,839 --> 00:37:39,839
charging your batteries charging yes

789
00:37:37,650 --> 00:37:43,530
there are quite large differences and

790
00:37:39,839 --> 00:37:44,160
we're actually specifically exploiting

791
00:37:43,530 --> 00:37:47,190
the

792
00:37:44,160 --> 00:37:48,660
fact that the batteries that we use have

793
00:37:47,190 --> 00:37:50,789
a much lower internal resistance they

794
00:37:48,660 --> 00:37:52,470
are much higher performance batteries

795
00:37:50,789 --> 00:37:54,289
that come from plug-in hybrids there are

796
00:37:52,470 --> 00:37:58,589
very small batteries that have to give

797
00:37:54,289 --> 00:38:02,190
power so these batteries can give and

798
00:37:58,589 --> 00:38:04,288
accept much higher power and they don't

799
00:38:02,190 --> 00:38:06,569
heat up nearly as much so you can

800
00:38:04,289 --> 00:38:09,270
increase charging speed you can increase

801
00:38:06,569 --> 00:38:11,640
discharging speed if you want so you can

802
00:38:09,270 --> 00:38:13,950
up the motor power and still have like

803
00:38:11,640 --> 00:38:17,670
decent performance and decent decently

804
00:38:13,950 --> 00:38:19,649
slow degradation they also have a

805
00:38:17,670 --> 00:38:23,059
different charge characteristic from the

806
00:38:19,650 --> 00:38:25,619
original battery which means that you

807
00:38:23,059 --> 00:38:28,049
remove a lot of stress from the original

808
00:38:25,619 --> 00:38:30,839
from the main battery also slowing down

809
00:38:28,049 --> 00:38:33,329
degradation and basically making

810
00:38:30,839 --> 00:38:35,400
everything better this is like it's not

811
00:38:33,329 --> 00:38:38,730
really security or Hardware things or a

812
00:38:35,400 --> 00:38:40,380
battery chemistry thing but yeah of

813
00:38:38,730 --> 00:38:42,750
course that also gives problems for

814
00:38:40,380 --> 00:38:45,750
instance in the you cannot just use

815
00:38:42,750 --> 00:38:47,819
voltage based capacity estimation on

816
00:38:45,750 --> 00:38:49,859
these batteries you have to do strange

817
00:38:47,819 --> 00:38:52,259
battery you have to do a whole new and

818
00:38:49,859 --> 00:38:55,020
battery management system but I mean

819
00:38:52,260 --> 00:38:56,849
that's kind of what I do so I'm familiar

820
00:38:55,020 --> 00:39:03,150
with that but that's not really a

821
00:38:56,849 --> 00:39:05,190
problem for me anymore hi assuming while

822
00:39:03,150 --> 00:39:07,829
driving this man in the middle component

823
00:39:05,190 --> 00:39:10,470
crashes what will be the effect of not

824
00:39:07,829 --> 00:39:13,410
passing these messages the car will stop

825
00:39:10,470 --> 00:39:15,359
functioning but with the brakes stopped

826
00:39:13,410 --> 00:39:18,720
functioning or with the cart you know so

827
00:39:15,359 --> 00:39:23,270
so this is this is also why the brake

828
00:39:18,720 --> 00:39:27,990
pedal is not in this loop there are so

829
00:39:23,270 --> 00:39:30,839
specifically the brake components has to

830
00:39:27,990 --> 00:39:33,299
be from a safety perspective has to have

831
00:39:30,839 --> 00:39:35,190
double action so it's got the just the

832
00:39:33,299 --> 00:39:37,170
the digital communication with the ECM

833
00:39:35,190 --> 00:39:38,579
but it's also got a backup connection

834
00:39:37,170 --> 00:39:41,250
special mechanical connection that you

835
00:39:38,579 --> 00:39:43,619
can hear when you start up the car that

836
00:39:41,250 --> 00:39:46,559
when the car loses communication with

837
00:39:43,619 --> 00:39:50,250
its structure motor it engages a little

838
00:39:46,559 --> 00:39:53,130
Paul and it directly connects to your

839
00:39:50,250 --> 00:39:56,220
hydraulic cylinders and gives you the

840
00:39:53,130 --> 00:39:57,690
ability to brake mechanically so the

841
00:39:56,220 --> 00:39:59,669
brake pedal will still work

842
00:39:57,690 --> 00:40:01,380
celebrated won't work basically nothing

843
00:39:59,670 --> 00:40:07,380
else will your your infotainment will

844
00:40:01,380 --> 00:40:09,390
work that's it basically so alright so

845
00:40:07,380 --> 00:40:11,430
my question is about the safety not the

846
00:40:09,390 --> 00:40:13,589
security in your experience what are the

847
00:40:11,430 --> 00:40:15,810
safety implications of adding a new

848
00:40:13,590 --> 00:40:16,910
battery and the did you learn any

849
00:40:15,810 --> 00:40:20,090
lessons from tinniest

850
00:40:16,910 --> 00:40:26,460
well fortunately we didn't learn any

851
00:40:20,090 --> 00:40:29,640
lessons lessons this is a kind of a

852
00:40:26,460 --> 00:40:33,900
complicated thing again really a

853
00:40:29,640 --> 00:40:37,290
security thing again did we learn

854
00:40:33,900 --> 00:40:39,390
anything you have learned lots I don't

855
00:40:37,290 --> 00:40:41,279
really know how to limit the scope of

856
00:40:39,390 --> 00:40:42,240
this question honestly look we can talk

857
00:40:41,280 --> 00:40:43,610
about this later

858
00:40:42,240 --> 00:40:46,859
because I think there are more people

859
00:40:43,610 --> 00:40:50,880
with question yeah yeah do you want to

860
00:40:46,860 --> 00:40:55,260
share with us the material costs of this

861
00:40:50,880 --> 00:40:57,390
upgrade do you mean like the entire

862
00:40:55,260 --> 00:40:59,580
battery pack and everything or just the

863
00:40:57,390 --> 00:41:03,150
animal attack not not your own

864
00:40:59,580 --> 00:41:04,950
investment but material costs but sorry

865
00:41:03,150 --> 00:41:08,090
do you mean for you like what we sell it

866
00:41:04,950 --> 00:41:14,040
for or never cheater self indictment

867
00:41:08,090 --> 00:41:18,120
relation to too much money lots of let's

868
00:41:14,040 --> 00:41:20,220
say we we haven't really made much money

869
00:41:18,120 --> 00:41:23,100
from the company even though we've had

870
00:41:20,220 --> 00:41:26,060
about a hundred thousand euros of

871
00:41:23,100 --> 00:41:28,470
turnover so that should give an idea of

872
00:41:26,060 --> 00:41:31,560
we still need to go into mass production

873
00:41:28,470 --> 00:41:34,980
to recoup all that cost a lot of cost I

874
00:41:31,560 --> 00:41:35,580
would say into yet and today an entire

875
00:41:34,980 --> 00:41:44,970
company

876
00:41:35,580 --> 00:41:50,640
time for one more questions hi what was

877
00:41:44,970 --> 00:41:55,129
Nissan's response we purposefully

878
00:41:50,640 --> 00:41:59,160
haven't really talked to miss an attack

879
00:41:55,130 --> 00:42:02,460
so no response

880
00:41:59,160 --> 00:42:05,940
i I'm not sure if they will have very

881
00:42:02,460 --> 00:42:10,160
much of a response there's also this

882
00:42:05,940 --> 00:42:14,280
very big language barrier between

883
00:42:10,160 --> 00:42:17,040
between the higher-ups at Nissan and the

884
00:42:14,280 --> 00:42:19,560
this kind of development I'm not sure if

885
00:42:17,040 --> 00:42:23,340
they're really interested in their

886
00:42:19,560 --> 00:42:28,710
products being modified overseas too

887
00:42:23,340 --> 00:42:32,220
much yeah yeah somebody still has a

888
00:42:28,710 --> 00:42:34,320
question but I think we're out of time

889
00:42:32,220 --> 00:42:35,910
though again think about it

890
00:42:34,320 --> 00:42:37,480
yeah we'll talk later thank you I mean

891
00:42:35,910 --> 00:42:40,558
right thank

892
00:42:37,480 --> 00:42:40,559
[Applause]

