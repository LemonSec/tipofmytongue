1
00:00:02,959 --> 00:00:06,899
so okay so we will start and my title is

2
00:00:06,899 --> 00:00:08,880
a bit long so I will only say that we

3
00:00:08,880 --> 00:00:10,740
will be speaking about the Practical

4
00:00:10,740 --> 00:00:13,500
invasive attacks but I will try to link

5
00:00:13,500 --> 00:00:15,719
this to a threat model and I was using

6
00:00:15,719 --> 00:00:17,640
compatible product creation for this

7
00:00:17,640 --> 00:00:19,440
because I think it's it's big enough

8
00:00:19,440 --> 00:00:22,619
that it's a decent threat model so an

9
00:00:22,619 --> 00:00:23,880
introduction

10
00:00:23,880 --> 00:00:26,400
I will speak about like myself and

11
00:00:26,400 --> 00:00:29,840
explain for one minute

12
00:00:41,960 --> 00:00:44,700
I've been working eight years in paytv

13
00:00:44,700 --> 00:00:46,079
and that's where I got exposed to

14
00:00:46,079 --> 00:00:48,239
invasive attacks back in the days after

15
00:00:48,239 --> 00:00:50,039
that I created a company which is from

16
00:00:50,039 --> 00:00:52,559
textplane and basically we are

17
00:00:52,559 --> 00:00:54,840
specialized in ic reverse engineering

18
00:00:54,840 --> 00:00:56,699
for a number of different things from

19
00:00:56,699 --> 00:00:58,559
design review so it's not really a

20
00:00:58,559 --> 00:01:00,000
reverse engineering but from design

21
00:01:00,000 --> 00:01:04,260
review to digital 0.6 security audits uh

22
00:01:04,260 --> 00:01:06,420
country feed check and this kind of

23
00:01:06,420 --> 00:01:08,880
things the the the the field of

24
00:01:08,880 --> 00:01:10,860
application a PC reverse engine is

25
00:01:10,860 --> 00:01:13,080
really big big but now I want to

26
00:01:13,080 --> 00:01:16,320
concentrate on on this because there's

27
00:01:16,320 --> 00:01:18,240
not so much public data so I'm trying to

28
00:01:18,240 --> 00:01:20,640
give you a predict that's about this

29
00:01:20,640 --> 00:01:22,860
secure elements themselves when I say

30
00:01:22,860 --> 00:01:24,600
secure elements it's secure elements

31
00:01:24,600 --> 00:01:27,060
smart cars TPM all the the secret chips

32
00:01:27,060 --> 00:01:29,939
you know very still an obfuscation a lot

33
00:01:29,939 --> 00:01:33,540
right so I want to also discuss this and

34
00:01:33,540 --> 00:01:36,540
to me the certifications schemes are not

35
00:01:36,540 --> 00:01:39,680
adapted or evaluating integrated

36
00:01:39,680 --> 00:01:42,240
integrated circuits reverse engineering

37
00:01:42,240 --> 00:01:45,000
based attacks so I think it's a good

38
00:01:45,000 --> 00:01:47,280
opportunity it has a number of people

39
00:01:47,280 --> 00:01:50,460
that are using those techniques and it's

40
00:01:50,460 --> 00:01:52,680
growing big you know like when I started

41
00:01:52,680 --> 00:01:55,500
18 years ago we were singing ships were

42
00:01:55,500 --> 00:01:56,820
like something called The Mad people

43
00:01:56,820 --> 00:01:59,340
right but now it's done a lot like the

44
00:01:59,340 --> 00:02:01,200
cheap rentals themselves or completely

45
00:02:01,200 --> 00:02:04,439
competitor analysis but also uh by the

46
00:02:04,439 --> 00:02:06,719
digital 0.6 guy like the law enforcement

47
00:02:06,719 --> 00:02:09,780
agencies are using this to extract

48
00:02:09,780 --> 00:02:12,540
evidences from like encrypted products

49
00:02:12,540 --> 00:02:13,680
let's say

50
00:02:13,680 --> 00:02:15,480
and then we have like this compatible

51
00:02:15,480 --> 00:02:18,060
product creation that I want to talk

52
00:02:18,060 --> 00:02:19,080
about

53
00:02:19,080 --> 00:02:22,560
and the idea is I really want to show at

54
00:02:22,560 --> 00:02:24,180
least give you a glimpse of what the

55
00:02:24,180 --> 00:02:26,580
pruners actually do to basically create

56
00:02:26,580 --> 00:02:30,120
some convertible products uh this is

57
00:02:30,120 --> 00:02:32,160
also applicable to a number of Opera

58
00:02:32,160 --> 00:02:34,860
attacks or hacks that I will concentrate

59
00:02:34,860 --> 00:02:36,599
on this one

60
00:02:36,599 --> 00:02:38,459
so I want to establish the threat model

61
00:02:38,459 --> 00:02:40,319
but I want to demonstrate the technique

62
00:02:40,319 --> 00:02:42,900
and Razer one is disclaimer the the

63
00:02:42,900 --> 00:02:44,580
analysis that I'm gonna show you so

64
00:02:44,580 --> 00:02:46,019
first of all I will not tell you where

65
00:02:46,019 --> 00:02:48,120
the chip is because to be fair I don't

66
00:02:48,120 --> 00:02:52,040
know it so for me it's a black box

67
00:02:52,099 --> 00:02:55,140
and the the analysis is not done yet

68
00:02:55,140 --> 00:02:57,360
right that you will see already that the

69
00:02:57,360 --> 00:02:59,160
number of steps that I represent is

70
00:02:59,160 --> 00:03:02,040
pretty big here and just to say yeah

71
00:03:02,040 --> 00:03:03,599
invasive attack it's still like

72
00:03:03,599 --> 00:03:05,700
something that is like time consuming a

73
00:03:05,700 --> 00:03:09,060
lot and and difficult but let's see if

74
00:03:09,060 --> 00:03:11,459
it's a straight manage the supply that

75
00:03:11,459 --> 00:03:13,920
we get interested into this I want to

76
00:03:13,920 --> 00:03:15,300
thank also all the cement to explain

77
00:03:15,300 --> 00:03:17,879
especially the one that was that we are

78
00:03:17,879 --> 00:03:19,620
working on this project so there is the

79
00:03:19,620 --> 00:03:23,040
CEO Isabel Step 11 so if you are looking

80
00:03:23,040 --> 00:03:26,239
at me hello and thanks

81
00:03:26,239 --> 00:03:28,800
and now let's uh let's see this threat

82
00:03:28,800 --> 00:03:30,780
model right

83
00:03:30,780 --> 00:03:34,620
so we focus on compatible products they

84
00:03:34,620 --> 00:03:36,959
are protecting Brands and that's

85
00:03:36,959 --> 00:03:39,300
something else than you know like being

86
00:03:39,300 --> 00:03:41,640
able to use like the right pigment there

87
00:03:41,640 --> 00:03:43,620
and the right cut which is

88
00:03:43,620 --> 00:03:46,319
and the the corners they will basically

89
00:03:46,319 --> 00:03:49,980
uh copy this you know in a way to give

90
00:03:49,980 --> 00:03:53,459
you an idea of the the the problem and

91
00:03:53,459 --> 00:03:56,459
the fullness make five billion dollar a

92
00:03:56,459 --> 00:03:59,040
year right so that's really big I would

93
00:03:59,040 --> 00:04:00,840
say and I would even say that one

94
00:04:00,840 --> 00:04:03,599
company only is taking 90 percent of the

95
00:04:03,599 --> 00:04:07,080
share all right so that's pretty big I

96
00:04:07,080 --> 00:04:09,840
would say and they have like Labs uh

97
00:04:09,840 --> 00:04:11,640
when you visit my lab you have to

98
00:04:11,640 --> 00:04:13,319
consider that this is a very small lamp

99
00:04:13,319 --> 00:04:15,540
right it's a

100
00:04:15,540 --> 00:04:18,540
the cleaners have like 30 times more

101
00:04:18,540 --> 00:04:21,600
machines than I do and people and so on

102
00:04:21,600 --> 00:04:24,979
so it's it's not fair

103
00:04:25,139 --> 00:04:28,320
repurpose compatible products for mainly

104
00:04:28,320 --> 00:04:30,419
all of the brands of printer and they

105
00:04:30,419 --> 00:04:32,400
are so big that they can produce their

106
00:04:32,400 --> 00:04:34,259
own Easy right so they have one chip

107
00:04:34,259 --> 00:04:36,660
that emulates them all right so I think

108
00:04:36,660 --> 00:04:38,880
it's a it's a it's a very decent

109
00:04:38,880 --> 00:04:40,139
activity

110
00:04:40,139 --> 00:04:42,540
and the activity is legal you can you

111
00:04:42,540 --> 00:04:46,680
can sell the the compatible product so

112
00:04:46,680 --> 00:04:49,740
it's just like you can sell it but to

113
00:04:49,740 --> 00:04:51,479
get to the point where you can sell it

114
00:04:51,479 --> 00:04:55,040
you need to basically attack and and

115
00:04:55,040 --> 00:04:59,720
compromise uh the original product

116
00:05:01,139 --> 00:05:04,020
so here so here you see here a part of

117
00:05:04,020 --> 00:05:05,880
the lab that we have so it's a it's a

118
00:05:05,880 --> 00:05:07,860
very small path where basically you have

119
00:05:07,860 --> 00:05:09,660
already enough equipment to be process

120
00:05:09,660 --> 00:05:12,840
your chips I will stick you that is very

121
00:05:12,840 --> 00:05:14,820
briefly

122
00:05:14,820 --> 00:05:17,280
um but here but I want to show to show

123
00:05:17,280 --> 00:05:19,919
you is like the the guys were putting

124
00:05:19,919 --> 00:05:22,320
ships in their genuine cartridges right

125
00:05:22,320 --> 00:05:24,060
they don't care about like the

126
00:05:24,060 --> 00:05:25,919
certification schemes and stuff like

127
00:05:25,919 --> 00:05:27,539
this we know that the threat model

128
00:05:27,539 --> 00:05:29,460
implies that the attackers were using

129
00:05:29,460 --> 00:05:32,460
the techniques right so

130
00:05:32,460 --> 00:05:35,820
and the the the security measure for

131
00:05:35,820 --> 00:05:38,100
most guy is the time that it takes for

132
00:05:38,100 --> 00:05:39,900
the pruners to have a compatible product

133
00:05:39,900 --> 00:05:42,600
okay and we want this time to be big of

134
00:05:42,600 --> 00:05:46,199
course and it's difficult right

135
00:05:46,199 --> 00:05:48,720
last thing I want to say is the attacks

136
00:05:48,720 --> 00:05:51,360
I'm going to show to you it's a it's a

137
00:05:51,360 --> 00:05:53,520
residual threat according to human

138
00:05:53,520 --> 00:05:55,500
criteria because like the time that has

139
00:05:55,500 --> 00:05:57,900
been spent the equipment and all of this

140
00:05:57,900 --> 00:06:00,840
thing is is a genius like not so good

141
00:06:00,840 --> 00:06:03,780
points I would say so is that further

142
00:06:03,780 --> 00:06:06,419
Ado let's let's see what what this kind

143
00:06:06,419 --> 00:06:07,979
of attack looks like

144
00:06:07,979 --> 00:06:09,900
and let's see let's start with the

145
00:06:09,900 --> 00:06:12,900
Target right so the Target in in printer

146
00:06:12,900 --> 00:06:15,539
cartridges you will find chips that are

147
00:06:15,539 --> 00:06:17,460
very close to secure elements so I put

148
00:06:17,460 --> 00:06:20,539
like some pictures of CPU elements

149
00:06:20,539 --> 00:06:23,400
you can recognize things you know and

150
00:06:23,400 --> 00:06:24,780
those things are packed with some

151
00:06:24,780 --> 00:06:27,000
damages and they are supposed to prevent

152
00:06:27,000 --> 00:06:29,400
any attack right plus the fact that you

153
00:06:29,400 --> 00:06:32,100
won't have like 2D documentation uh and

154
00:06:32,100 --> 00:06:33,720
and this kind of thing it makes it hard

155
00:06:33,720 --> 00:06:36,120
to even know what they are you know but

156
00:06:36,120 --> 00:06:37,979
inside the filter cartridge you also

157
00:06:37,979 --> 00:06:39,539
have like what's called custom other

158
00:06:39,539 --> 00:06:41,639
functions right so now if you have the

159
00:06:41,639 --> 00:06:43,919
firmware of those chips that's not snap

160
00:06:43,919 --> 00:06:45,539
you will also need a piece of the other

161
00:06:45,539 --> 00:06:49,199
all right so it's even more secure than

162
00:06:49,199 --> 00:06:52,460
most chips uh

163
00:06:52,620 --> 00:06:55,500
my targets all right so I told you

164
00:06:55,500 --> 00:06:58,620
before uh when I got this target it's

165
00:06:58,620 --> 00:07:00,479
just a piece of everything right and

166
00:07:00,479 --> 00:07:03,180
they have pins going in uh being pin

167
00:07:03,180 --> 00:07:06,300
pins going out sorry that that's all I

168
00:07:06,300 --> 00:07:09,000
know so when when I say I do black box

169
00:07:09,000 --> 00:07:12,360
analysis that's uh that's the one uh no

170
00:07:12,360 --> 00:07:15,060
reference on the package no friends no

171
00:07:15,060 --> 00:07:18,419
reference on the diet set notai marks

172
00:07:18,419 --> 00:07:21,780
um CPU and an architecture

173
00:07:21,780 --> 00:07:25,199
black books to know our Target is to be

174
00:07:25,199 --> 00:07:28,319
able to extract the memory of the the

175
00:07:28,319 --> 00:07:30,539
device let's also extract the hardware

176
00:07:30,539 --> 00:07:33,240
all right as if you wanted to basically

177
00:07:33,240 --> 00:07:36,060
emulate with this component

178
00:07:36,060 --> 00:07:39,660
and of course we started by just looking

179
00:07:39,660 --> 00:07:42,060
at the the frames between the printer

180
00:07:42,060 --> 00:07:45,300
and the cartridge we did some spas that

181
00:07:45,300 --> 00:07:47,340
are pretty much useless we know that

182
00:07:47,340 --> 00:07:49,259
something happens at the beginning when

183
00:07:49,259 --> 00:07:51,539
you put the device good yeah it's very

184
00:07:51,539 --> 00:07:55,080
useful and so we decided to

185
00:07:55,080 --> 00:07:56,340
um to do some kind of construction

186
00:07:56,340 --> 00:07:58,919
analysis right so that's basically doing

187
00:07:58,919 --> 00:08:01,740
a few steps going to the Silicon to see

188
00:08:01,740 --> 00:08:04,380
the transistors and the audio chip looks

189
00:08:04,380 --> 00:08:06,180
like and we've been performing a number

190
00:08:06,180 --> 00:08:08,520
of like different operation so we could

191
00:08:08,520 --> 00:08:10,080
see at the end of the day that this is

192
00:08:10,080 --> 00:08:13,080
our Target finally right so the targets

193
00:08:13,080 --> 00:08:15,840
by looking at just one picture you will

194
00:08:15,840 --> 00:08:18,360
see that it contains some analog

195
00:08:18,360 --> 00:08:21,120
functions digital energy

196
00:08:21,120 --> 00:08:24,840
parts and then one flash one ROM and two

197
00:08:24,840 --> 00:08:27,060
runs right I think today we will

198
00:08:27,060 --> 00:08:28,919
concentrate mainly on the ROM and you

199
00:08:28,919 --> 00:08:31,139
will see that getting run out of things

200
00:08:31,139 --> 00:08:34,200
like this is like crazy

201
00:08:34,200 --> 00:08:37,140
so you see the strategy that we choose

202
00:08:37,140 --> 00:08:40,099
and uh I will not comment it here

203
00:08:40,099 --> 00:08:43,979
directly to the slides and the first

204
00:08:43,979 --> 00:08:46,560
thing we started is extracting the Nets

205
00:08:46,560 --> 00:08:50,339
right so we have a digital CPU we want

206
00:08:50,339 --> 00:08:52,200
to know what this is so the chip has

207
00:08:52,200 --> 00:08:55,320
five metal layers right and the

208
00:08:55,320 --> 00:08:57,000
techniques that we've been using to get

209
00:08:57,000 --> 00:08:59,339
like in each of the layer is basically a

210
00:08:59,339 --> 00:09:01,920
CMP so mechanical polishing and plus

211
00:09:01,920 --> 00:09:03,959
matching all right so sometimes install

212
00:09:03,959 --> 00:09:06,660
variety also and by using this we could

213
00:09:06,660 --> 00:09:08,880
remove like layer by layer to take

214
00:09:08,880 --> 00:09:10,980
pictures with like a scanning icon

215
00:09:10,980 --> 00:09:12,839
microscope so that's the features of the

216
00:09:12,839 --> 00:09:15,839
layers so from like the the laser

217
00:09:15,839 --> 00:09:18,800
launcher which is

218
00:09:18,839 --> 00:09:21,600
um is like the PCS so here we see the

219
00:09:21,600 --> 00:09:24,240
transistors basically this layer it

220
00:09:24,240 --> 00:09:26,880
forms the logic cells right and then you

221
00:09:26,880 --> 00:09:28,560
have all of the inside connect layers on

222
00:09:28,560 --> 00:09:30,899
top right I didn't put like the upper

223
00:09:30,899 --> 00:09:32,519
layer because you see this that's only

224
00:09:32,519 --> 00:09:34,860
ground and VCC so not very useful for

225
00:09:34,860 --> 00:09:37,860
for the guys who reverse engineer the

226
00:09:37,860 --> 00:09:39,180
chips

227
00:09:39,180 --> 00:09:41,940
from the pictures we've been using a

228
00:09:41,940 --> 00:09:44,279
software so it's called chip use it's

229
00:09:44,279 --> 00:09:47,220
developed the light explained directly

230
00:09:47,220 --> 00:09:49,560
and the distributes you can basically

231
00:09:49,560 --> 00:09:51,959
select an area of interest for each of

232
00:09:51,959 --> 00:09:54,480
your stance right in the SDM so a scan

233
00:09:54,480 --> 00:09:56,519
for this cheaper is about like 15

234
00:09:56,519 --> 00:09:59,820
pictures per layer give you an ID

235
00:09:59,820 --> 00:10:02,399
and then from this we extracted the

236
00:10:02,399 --> 00:10:06,000
features tracks yes standard cells over

237
00:10:06,000 --> 00:10:08,279
raised I mean you name it the the

238
00:10:08,279 --> 00:10:11,339
features that are on the the IC after

239
00:10:11,339 --> 00:10:14,399
that we could use this detection to

240
00:10:14,399 --> 00:10:16,860
basically correct the Distortion that is

241
00:10:16,860 --> 00:10:19,140
introduced by the scms right the

242
00:10:19,140 --> 00:10:21,000
scanning action microscopy distort the

243
00:10:21,000 --> 00:10:22,620
pictures of it so if you want to stitch

244
00:10:22,620 --> 00:10:24,360
them especially if you have a large

245
00:10:24,360 --> 00:10:26,519
number it's good to be able to distort

246
00:10:26,519 --> 00:10:27,779
them back here

247
00:10:27,779 --> 00:10:29,060
so

248
00:10:29,060 --> 00:10:33,000
stitching so that's layer wise

249
00:10:33,000 --> 00:10:36,120
and then the most important part is

250
00:10:36,120 --> 00:10:37,980
extracting the standard cell library

251
00:10:37,980 --> 00:10:41,160
that is that was used by the by the

252
00:10:41,160 --> 00:10:43,680
designer right so you see all the nand

253
00:10:43,680 --> 00:10:45,480
gates the two clubs and all of those

254
00:10:45,480 --> 00:10:47,760
things so you have to reconstruct uh the

255
00:10:47,760 --> 00:10:50,880
the library so if you do this then you

256
00:10:50,880 --> 00:10:53,519
can go inside the the digital circuitry

257
00:10:53,519 --> 00:10:55,920
the next track basically where the sends

258
00:10:55,920 --> 00:10:57,660
are so each of the Dots here that's

259
00:10:57,660 --> 00:10:59,760
basically used on upsell right and

260
00:10:59,760 --> 00:11:01,800
that's a very small fraction of the of

261
00:11:01,800 --> 00:11:03,660
the digital

262
00:11:03,660 --> 00:11:06,360
all right this operation is taking a lot

263
00:11:06,360 --> 00:11:09,600
of time you know so when we were doing

264
00:11:09,600 --> 00:11:11,700
this basically we decided to have a look

265
00:11:11,700 --> 00:11:15,060
at the ROM okay so first thing we did

266
00:11:15,060 --> 00:11:18,000
was to do a shadow angular polish so

267
00:11:18,000 --> 00:11:20,040
basically we polished across the the the

268
00:11:20,040 --> 00:11:22,140
ROM itself you know with a slight angle

269
00:11:22,140 --> 00:11:24,240
so you can see all of the layer all

270
00:11:24,240 --> 00:11:27,000
right and at some point we can see those

271
00:11:27,000 --> 00:11:29,339
things with like short circuits and no

272
00:11:29,339 --> 00:11:31,260
short circuits that's basically your

273
00:11:31,260 --> 00:11:33,720
Beats all right so the rum is a is an

274
00:11:33,720 --> 00:11:36,060
end so I can see some candies of the

275
00:11:36,060 --> 00:11:38,540
penis I'm like yes it's true

276
00:11:38,540 --> 00:11:42,000
so we have an end ROM here and we

277
00:11:42,000 --> 00:11:44,339
decided to extract the row binary of the

278
00:11:44,339 --> 00:11:46,800
ROM so basically you stand with it right

279
00:11:46,800 --> 00:11:49,019
so it depresses until you see the beads

280
00:11:49,019 --> 00:11:51,060
you take pictures from the picture

281
00:11:51,060 --> 00:11:53,220
extract some kind of the grid from the

282
00:11:53,220 --> 00:11:54,839
grid you find the beads you put

283
00:11:54,839 --> 00:11:57,240
everything together you have what I

284
00:11:57,240 --> 00:11:59,279
would call a row binary because it's not

285
00:11:59,279 --> 00:12:01,980
binary yet right

286
00:12:01,980 --> 00:12:04,440
all right so binary if we look at the

287
00:12:04,440 --> 00:12:06,540
row binary I have something that look

288
00:12:06,540 --> 00:12:08,519
like this okay so that's the bits

289
00:12:08,519 --> 00:12:10,560
basically as we are stored inside the

290
00:12:10,560 --> 00:12:12,899
chip right so if you see a DOT that's

291
00:12:12,899 --> 00:12:15,000
going to be a zero and if you don't see

292
00:12:15,000 --> 00:12:16,740
a DOT that's gonna be a one all right

293
00:12:16,740 --> 00:12:19,079
but here you can see that there is a lot

294
00:12:19,079 --> 00:12:22,019
of patients and this even like an empty

295
00:12:22,019 --> 00:12:24,240
area at the very end of the ROM all

296
00:12:24,240 --> 00:12:26,640
right and that is suggesting something

297
00:12:26,640 --> 00:12:28,620
which is very uncommon with secure

298
00:12:28,620 --> 00:12:31,440
element that the ROM is not encrypted

299
00:12:31,440 --> 00:12:33,240
basically right

300
00:12:33,240 --> 00:12:36,120
so from this stage we decided okay the

301
00:12:36,120 --> 00:12:38,279
ram is not encrypted let's convert this

302
00:12:38,279 --> 00:12:42,540
row binary to the proper binary right

303
00:12:42,540 --> 00:12:44,100
and we tried

304
00:12:44,100 --> 00:12:45,959
um we tried three yarn so we tried

305
00:12:45,959 --> 00:12:48,540
different bits order for different

306
00:12:48,540 --> 00:12:50,579
orders for the big lines the world lines

307
00:12:50,579 --> 00:12:53,160
everything that can be used to scramble

308
00:12:53,160 --> 00:12:56,100
the ram data right and we got like a few

309
00:12:56,100 --> 00:12:57,959
binaries that we could test you know and

310
00:12:57,959 --> 00:12:59,760
we were looking for Strings

311
00:12:59,760 --> 00:13:02,940
industry right and we were looking for

312
00:13:02,940 --> 00:13:06,240
known outputs and with this words no no

313
00:13:06,240 --> 00:13:08,880
close to all right so we are at the

314
00:13:08,880 --> 00:13:11,820
stage where we think that and the ROM is

315
00:13:11,820 --> 00:13:14,160
not encrypted but we cannot make sense

316
00:13:14,160 --> 00:13:16,079
of it right because of all of this

317
00:13:16,079 --> 00:13:17,579
funding and maybe some of the things

318
00:13:17,579 --> 00:13:20,339
that we didn't see yet okay

319
00:13:20,339 --> 00:13:21,779
so next step

320
00:13:21,779 --> 00:13:24,120
and so as I was saying first of all it's

321
00:13:24,120 --> 00:13:26,040
rare to have like secure elements with

322
00:13:26,040 --> 00:13:28,680
these things with non-encrypted grounds

323
00:13:28,680 --> 00:13:30,360
right

324
00:13:30,360 --> 00:13:31,740
so

325
00:13:31,740 --> 00:13:33,480
then at least was not ready so we

326
00:13:33,480 --> 00:13:35,399
couldn't use the natives to verify the

327
00:13:35,399 --> 00:13:38,040
encryption and to see if we could do

328
00:13:38,040 --> 00:13:41,459
more things so we were kind of uh stuck

329
00:13:41,459 --> 00:13:42,300
here

330
00:13:42,300 --> 00:13:45,300
so what we decided to do is basically to

331
00:13:45,300 --> 00:13:49,019
see to check check first if the ROM was

332
00:13:49,019 --> 00:13:52,139
booty okay because if I don't turn the

333
00:13:52,139 --> 00:13:54,180
RAM and I turn the flash here trying to

334
00:13:54,180 --> 00:13:55,740
jump the ROM in the first place might

335
00:13:55,740 --> 00:13:58,800
not be the right spread it okay so to do

336
00:13:58,800 --> 00:14:02,880
this uh we did a microphobia all right

337
00:14:02,880 --> 00:14:05,339
so and the question is just switching

338
00:14:05,339 --> 00:14:08,040
the device so the idea is uh we have a

339
00:14:08,040 --> 00:14:10,680
chip and we have like we wanted to probe

340
00:14:10,680 --> 00:14:13,019
one bit of the ROM right one bit of The

341
00:14:13,019 --> 00:14:15,660
Flash and see which starts first okay so

342
00:14:15,660 --> 00:14:16,880
simple enough

343
00:14:16,880 --> 00:14:19,740
problem there is a shield on top of the

344
00:14:19,740 --> 00:14:21,360
of the chip

345
00:14:21,360 --> 00:14:23,579
and we need to go through it if you want

346
00:14:23,579 --> 00:14:26,940
to reach the signals of Interest right

347
00:14:26,940 --> 00:14:29,700
so to do this what we have been deciding

348
00:14:29,700 --> 00:14:32,040
to do is called the local bypass

349
00:14:32,040 --> 00:14:34,320
strategy right so

350
00:14:34,320 --> 00:14:36,720
and first of all I have to I have a

351
00:14:36,720 --> 00:14:38,940
slide about shield and I know I want to

352
00:14:38,940 --> 00:14:41,880
make friends with this slide that I

353
00:14:41,880 --> 00:14:46,380
always ask myself is is a shield becomes

354
00:14:46,380 --> 00:14:49,079
a measure against micropoding right and

355
00:14:49,079 --> 00:14:51,420
if I understand the historic greatly

356
00:14:51,420 --> 00:14:54,660
it's not right because

357
00:14:54,660 --> 00:14:56,880
long ago it decades ago you know to

358
00:14:56,880 --> 00:14:59,100
reach the signals of interest you just

359
00:14:59,100 --> 00:15:00,959
scratch the surface of the chip right

360
00:15:00,959 --> 00:15:03,740
until you search the tracks of interest

361
00:15:03,740 --> 00:15:06,480
and you go all right so no FIB

362
00:15:06,480 --> 00:15:08,519
modification there was no Shield

363
00:15:08,519 --> 00:15:10,680
deposition right but then you have to

364
00:15:10,680 --> 00:15:12,959
see that over time the sizes of the

365
00:15:12,959 --> 00:15:14,760
tracks and all of those things is just

366
00:15:14,760 --> 00:15:16,860
like shrinking you know over time and

367
00:15:16,860 --> 00:15:20,040
doing this was not visible anymore

368
00:15:20,040 --> 00:15:23,399
so at some point people started to use

369
00:15:23,399 --> 00:15:25,620
like the green laser all right to remove

370
00:15:25,620 --> 00:15:27,720
the passivation on top of the tracks of

371
00:15:27,720 --> 00:15:29,399
interest of it and it didn't go here

372
00:15:29,399 --> 00:15:32,639
right so why not I mean so and this is

373
00:15:32,639 --> 00:15:35,240
where and the vendors decided to

374
00:15:35,240 --> 00:15:38,399
introduce Shields okay the idea is now

375
00:15:38,399 --> 00:15:40,740
if I take a green laser and I remove the

376
00:15:40,740 --> 00:15:44,100
test position the new track I see is a

377
00:15:44,100 --> 00:15:47,100
track that is not useful to me and if I

378
00:15:47,100 --> 00:15:48,660
cut this crack the chip is killing

379
00:15:48,660 --> 00:15:50,760
itself okay so I don't jump anything

380
00:15:50,760 --> 00:15:54,860
from a chip which is another yeah

381
00:15:54,980 --> 00:15:58,220
which in the process

382
00:15:58,220 --> 00:16:00,720
attackers needed to access like deeper

383
00:16:00,720 --> 00:16:03,180
signals in the stack of layers of the

384
00:16:03,180 --> 00:16:05,220
Chip And we were starting to use

385
00:16:05,220 --> 00:16:08,220
basically fiber right so that's the FIB

386
00:16:08,220 --> 00:16:10,560
and an FIB is capable of like building

387
00:16:10,560 --> 00:16:13,680
metal removing outside because it's in

388
00:16:13,680 --> 00:16:16,620
metal and depositing oxide so basically

389
00:16:16,620 --> 00:16:20,040
you can reboot so C3 right at the

390
00:16:20,040 --> 00:16:22,680
nanometer scale which is fun

391
00:16:22,680 --> 00:16:26,160
and and because of that you know so

392
00:16:26,160 --> 00:16:30,180
that's the inside of the FIB uh so okay

393
00:16:30,180 --> 00:16:34,500
with each special but because we were

394
00:16:34,500 --> 00:16:37,079
using now Clips right

395
00:16:37,079 --> 00:16:39,420
what about cheese you have now or two

396
00:16:39,420 --> 00:16:41,399
where you can take the shield and to eat

397
00:16:41,399 --> 00:16:43,139
somewhere else basically and then you

398
00:16:43,139 --> 00:16:46,560
can access the similar as you want right

399
00:16:46,560 --> 00:16:48,540
so

400
00:16:48,540 --> 00:16:51,120
yes so sheets are not me a protection

401
00:16:51,120 --> 00:16:53,820
against microphone

402
00:16:53,820 --> 00:16:55,560
and then we change this to this after

403
00:16:55,560 --> 00:16:57,420
the the top yeah I know some people

404
00:16:57,420 --> 00:16:59,699
don't want to agree so if you have a

405
00:16:59,699 --> 00:17:01,440
shield all right so let's say this is

406
00:17:01,440 --> 00:17:03,300
all the lines of the shield and if you

407
00:17:03,300 --> 00:17:05,939
cut one the key is dead with the FIB

408
00:17:05,939 --> 00:17:08,459
basically you can re-root the tracks

409
00:17:08,459 --> 00:17:11,160
right so now you have the M you have an

410
00:17:11,160 --> 00:17:13,319
empty space in the shield where you can

411
00:17:13,319 --> 00:17:15,000
access the signals that are underneath

412
00:17:15,000 --> 00:17:17,819
right it's like this with a with the Fib

413
00:17:17,819 --> 00:17:22,439
so it's a it's a two loophole bypass it

414
00:17:22,439 --> 00:17:25,500
edits right and now all of this area is

415
00:17:25,500 --> 00:17:27,540
where you can just continue to Edge to

416
00:17:27,540 --> 00:17:29,640
reach like Tracks Of Interest

417
00:17:29,640 --> 00:17:33,299
which I think is what we did so before

418
00:17:33,299 --> 00:17:35,820
we did this we had to basically rewire

419
00:17:35,820 --> 00:17:39,000
the chip and then we did this bypass of

420
00:17:39,000 --> 00:17:41,880
The Shield to the pad here on the the

421
00:17:41,880 --> 00:17:44,039
wrong output another pad like this on

422
00:17:44,039 --> 00:17:46,080
the pressure output and basically from

423
00:17:46,080 --> 00:17:50,220
this we could Now microphone so put

424
00:17:50,220 --> 00:17:52,380
needles on those paths and we see that

425
00:17:52,380 --> 00:17:55,320
the ROM is starting first right so boot

426
00:17:55,320 --> 00:17:57,120
Run Okay so that build the information

427
00:17:57,120 --> 00:17:59,460
we were looking for So reading the ROM

428
00:17:59,460 --> 00:18:02,880
now is something we want okay

429
00:18:02,880 --> 00:18:06,240
still on at least so in that situation

430
00:18:06,240 --> 00:18:08,520
we need to find something else so we

431
00:18:08,520 --> 00:18:11,039
know that it's it's we don't know we we

432
00:18:11,039 --> 00:18:13,320
suppose that the ram isn't here so

433
00:18:13,320 --> 00:18:15,600
basically our issue is crumbling right

434
00:18:15,600 --> 00:18:17,580
and scrambling can be done inside the

435
00:18:17,580 --> 00:18:19,860
room and it can be done outside of the

436
00:18:19,860 --> 00:18:22,559
room so we tried basically to solve the

437
00:18:22,559 --> 00:18:25,860
inside of the round finger they

438
00:18:25,860 --> 00:18:28,580
basically taking the pictures of the RAM

439
00:18:28,580 --> 00:18:32,340
and making a vhtl model of the of the

440
00:18:32,340 --> 00:18:34,020
room itself so it means reverse

441
00:18:34,020 --> 00:18:35,760
engineering the world decoder the

442
00:18:35,760 --> 00:18:37,679
problem decoder the control logic of the

443
00:18:37,679 --> 00:18:40,320
RAM and as we have already the bits you

444
00:18:40,320 --> 00:18:42,299
know we can have this model and the idea

445
00:18:42,299 --> 00:18:44,460
is I give you an address you need the

446
00:18:44,460 --> 00:18:46,380
right data all right

447
00:18:46,380 --> 00:18:48,440
so

448
00:18:48,440 --> 00:18:50,700
the model looks like this I mean like

449
00:18:50,700 --> 00:18:52,200
the ROM looks like this if you look

450
00:18:52,200 --> 00:18:54,240
closely right so you have like banks

451
00:18:54,240 --> 00:18:58,140
that generates like uh wordline signals

452
00:18:58,140 --> 00:19:00,660
all right you have music pixel there and

453
00:19:00,660 --> 00:19:02,340
this is the control logic over there

454
00:19:02,340 --> 00:19:03,299
right

455
00:19:03,299 --> 00:19:05,530
and basically the the the

456
00:19:05,530 --> 00:19:06,840
[Music]

457
00:19:06,840 --> 00:19:09,360
what we found is like scrambling was

458
00:19:09,360 --> 00:19:12,000
everywhere right the order of those

459
00:19:12,000 --> 00:19:14,220
block is not this one it's a random

460
00:19:14,220 --> 00:19:16,380
order and in London you know it's a it's

461
00:19:16,380 --> 00:19:18,660
not a linear order let's say the other

462
00:19:18,660 --> 00:19:21,120
boost works are also like the difference

463
00:19:21,120 --> 00:19:23,460
but inside the blocks the selection of

464
00:19:23,460 --> 00:19:25,080
the world lines and the replayings were

465
00:19:25,080 --> 00:19:27,179
also scrambled so it's a good job of

466
00:19:27,179 --> 00:19:29,820
like obfuscating this

467
00:19:29,820 --> 00:19:31,799
so from this

468
00:19:31,799 --> 00:19:36,240
we could build new binaries and try to

469
00:19:36,240 --> 00:19:38,640
see if we can see strings or no no codes

470
00:19:38,640 --> 00:19:41,460
or you know like try to find if we can

471
00:19:41,460 --> 00:19:44,419
make sense of the data you know

472
00:19:44,419 --> 00:19:47,880
right so that's pretty rare to arrive at

473
00:19:47,880 --> 00:19:50,760
this point with a with a with a 1950

474
00:19:50,760 --> 00:19:52,500
drum and you have like so much trouble

475
00:19:52,500 --> 00:19:53,580
with it

476
00:19:53,580 --> 00:19:55,500
one thing we didn't know is the detail

477
00:19:55,500 --> 00:19:57,000
there are the address lines and the

478
00:19:57,000 --> 00:19:58,500
outputs because that's inside the

479
00:19:58,500 --> 00:20:00,419
digital circuitry that you can find this

480
00:20:00,419 --> 00:20:02,880
out right so we wanted to have we need

481
00:20:02,880 --> 00:20:04,620
it to happen

482
00:20:04,620 --> 00:20:06,419
okay

483
00:20:06,419 --> 00:20:09,539
so results are a bit annoying that's for

484
00:20:09,539 --> 00:20:11,660
sure there are still some unknown

485
00:20:11,660 --> 00:20:14,340
unknowns like the address the base

486
00:20:14,340 --> 00:20:15,840
address of the ROM

487
00:20:15,840 --> 00:20:19,799
and no type of processor is a known so

488
00:20:19,799 --> 00:20:21,620
yeah

489
00:20:21,620 --> 00:20:24,660
a bit later we could see that there is a

490
00:20:24,660 --> 00:20:26,400
difference between the physical address

491
00:20:26,400 --> 00:20:31,400
of the memory and it's a logical address

492
00:20:31,580 --> 00:20:34,260
now so we can get like so much more

493
00:20:34,260 --> 00:20:36,539
information so then at least is just

494
00:20:36,539 --> 00:20:39,360
like a file which is like quite long if

495
00:20:39,360 --> 00:20:40,980
you want to print the parts of the net

496
00:20:40,980 --> 00:20:43,080
this you need to have like a lot of

497
00:20:43,080 --> 00:20:44,520
paper right

498
00:20:44,520 --> 00:20:46,980
and inside the net is basically you have

499
00:20:46,980 --> 00:20:49,020
already digital logic so you can learn a

500
00:20:49,020 --> 00:20:52,320
lot from the latest itself so we wanted

501
00:20:52,320 --> 00:20:54,480
to confirm that the ROM was not

502
00:20:54,480 --> 00:20:56,640
encrypted but also we wanted to verify

503
00:20:56,640 --> 00:20:59,520
all of this all right find weaknesses to

504
00:20:59,520 --> 00:21:01,919
to their family attack thumbs around

505
00:21:01,919 --> 00:21:05,280
running good then everyone could find

506
00:21:05,280 --> 00:21:07,440
the order of the the data and the

507
00:21:07,440 --> 00:21:10,020
address lines and this kind of things

508
00:21:10,020 --> 00:21:13,320
right so okay let's jump in right so

509
00:21:13,320 --> 00:21:16,620
here let's schematics that are coming

510
00:21:16,620 --> 00:21:19,620
from also one of our tool that invest in

511
00:21:19,620 --> 00:21:20,900
it is to

512
00:21:20,900 --> 00:21:24,120
this and we can search things inside and

513
00:21:24,120 --> 00:21:26,580
what we see is basically the Run outputs

514
00:21:26,580 --> 00:21:29,940
the first cell that they reach is a rich

515
00:21:29,940 --> 00:21:31,620
pixel right

516
00:21:31,620 --> 00:21:33,659
so we can

517
00:21:33,659 --> 00:21:36,600
I mean that's expected I expect to have

518
00:21:36,600 --> 00:21:38,460
other memories in the design and we know

519
00:21:38,460 --> 00:21:40,799
there's a flash two Rams so having

520
00:21:40,799 --> 00:21:43,080
energy pixel makes sense and if you

521
00:21:43,080 --> 00:21:45,240
start to trace what you will find is the

522
00:21:45,240 --> 00:21:48,000
ram the ROM and the Flash are connected

523
00:21:48,000 --> 00:21:49,980
in the switch pixel all right so that's

524
00:21:49,980 --> 00:21:52,080
the memory selection that is just there

525
00:21:52,080 --> 00:21:55,020
okay at least two other things this cell

526
00:21:55,020 --> 00:21:57,840
and this cells right they are exhaust

527
00:21:57,840 --> 00:21:59,039
okay

528
00:21:59,039 --> 00:22:01,320
which tends to indicate that the flash

529
00:22:01,320 --> 00:22:04,919
is encrypted also the ram but I can see

530
00:22:04,919 --> 00:22:08,039
exhaustion of the room right so I can I

531
00:22:08,039 --> 00:22:10,200
start to assume that this is like 300

532
00:22:10,200 --> 00:22:13,440
Peppers already and our hypothesis was

533
00:22:13,440 --> 00:22:17,039
at the the room and was not encrypted so

534
00:22:17,039 --> 00:22:18,659
accents

535
00:22:18,659 --> 00:22:22,980
uh it's just contain this

536
00:22:22,980 --> 00:22:25,559
then we went a bit further all right

537
00:22:25,559 --> 00:22:27,480
because like what's interesting is to

538
00:22:27,480 --> 00:22:29,760
know where the the registers are right

539
00:22:29,760 --> 00:22:31,799
like the combinatory logic is one thing

540
00:22:31,799 --> 00:22:34,020
but the register so you are the first

541
00:22:34,020 --> 00:22:36,059
stage of registers that are reached by

542
00:22:36,059 --> 00:22:39,120
ROM run and Flash right as it probably

543
00:22:39,120 --> 00:22:40,980
that's already apart from the

544
00:22:40,980 --> 00:22:44,039
instruction and register

545
00:22:44,039 --> 00:22:47,059
and this is a finishing here on this

546
00:22:47,059 --> 00:22:50,039
stage right you have a control signal

547
00:22:50,039 --> 00:22:52,679
that is used by all of this cell and you

548
00:22:52,679 --> 00:22:54,539
can of course now the clear database to

549
00:22:54,539 --> 00:22:57,120
the old ones right so we can post an

550
00:22:57,120 --> 00:22:59,220
instruction now which is FF on the chip

551
00:22:59,220 --> 00:23:01,740
with one single only one needle on this

552
00:23:01,740 --> 00:23:06,559
and and we can we can use APAP as

553
00:23:08,159 --> 00:23:10,559
to me it's a very cool thing you know

554
00:23:10,559 --> 00:23:12,780
because if FF tends to be an instruction

555
00:23:12,780 --> 00:23:15,539
which is like a sequential type not a

556
00:23:15,539 --> 00:23:17,580
branch you know then we will be able to

557
00:23:17,580 --> 00:23:19,980
do like the instructions keep and start

558
00:23:19,980 --> 00:23:22,799
to mess up with the instruction flow

559
00:23:22,799 --> 00:23:27,559
itself so that's a very useful scenario

560
00:23:28,460 --> 00:23:32,039
retailer right so for the bit under uh

561
00:23:32,039 --> 00:23:34,380
it's it's pretty easy trace the signal

562
00:23:34,380 --> 00:23:37,919
until you find a debug chain right or

563
00:23:37,919 --> 00:23:39,840
until you find the others right and

564
00:23:39,840 --> 00:23:42,179
that's what we found here so uh I don't

565
00:23:42,179 --> 00:23:43,740
remember so that's the detail there

566
00:23:43,740 --> 00:23:46,140
right so inside the data pack so from

567
00:23:46,140 --> 00:23:49,020
the run down at some point you arrive on

568
00:23:49,020 --> 00:23:51,240
another right so that must be already

569
00:23:51,240 --> 00:23:54,000
part of the agu or something and you see

570
00:23:54,000 --> 00:23:56,340
the carry on the other that propagates

571
00:23:56,340 --> 00:23:58,320
from Nissan it can be too much

572
00:23:58,320 --> 00:24:01,260
Independence right so now the detail

573
00:24:01,260 --> 00:24:03,059
there for the the outputs of the memory

574
00:24:03,059 --> 00:24:05,700
is known okay and we did the same thing

575
00:24:05,700 --> 00:24:07,980
for the for the address and here you can

576
00:24:07,980 --> 00:24:10,380
really see like the the signal just like

577
00:24:10,380 --> 00:24:13,020
propagating from uh listen if you can be

578
00:24:13,020 --> 00:24:14,580
to listen if you can leave it there

579
00:24:14,580 --> 00:24:16,320
right

580
00:24:16,320 --> 00:24:19,559
so each other is known for the for the

581
00:24:19,559 --> 00:24:21,780
address because there is no other data

582
00:24:21,780 --> 00:24:25,799
so if I take the one model from before

583
00:24:25,799 --> 00:24:28,080
well we should have the right binary

584
00:24:28,080 --> 00:24:29,580
this time okay

585
00:24:29,580 --> 00:24:31,620
so I don't know if it's the right binary

586
00:24:31,620 --> 00:24:33,780
but there are still no strings

587
00:24:33,780 --> 00:24:37,440
and we are still no no close okay but it

588
00:24:37,440 --> 00:24:40,440
doesn't stop and the the attack you know

589
00:24:40,440 --> 00:24:42,059
we just know that we need to do

590
00:24:42,059 --> 00:24:45,600
something more so

591
00:24:45,919 --> 00:24:48,720
at this stage we say okay let's done the

592
00:24:48,720 --> 00:24:50,100
running code because now we have a

593
00:24:50,100 --> 00:24:52,559
binary we think it's the right one and

594
00:24:52,559 --> 00:24:54,419
if you look the running code of the Chip

595
00:24:54,419 --> 00:24:56,159
And We compare we will see where the

596
00:24:56,159 --> 00:24:57,960
jumps are and maybe we can find the base

597
00:24:57,960 --> 00:25:00,299
address like this and you know like the

598
00:25:00,299 --> 00:25:03,179
elaboration on this thing

599
00:25:03,179 --> 00:25:06,000
and that's implies much connections to

600
00:25:06,000 --> 00:25:09,840
the chip right so local bypass are good

601
00:25:09,840 --> 00:25:11,700
you know but they take time you know

602
00:25:11,700 --> 00:25:14,280
like uh I don't know after an hour an

603
00:25:14,280 --> 00:25:17,460
hour we make the edit you know and so it

604
00:25:17,460 --> 00:25:20,100
seems to be to be short but there's a

605
00:25:20,100 --> 00:25:22,740
better strategy

606
00:25:22,740 --> 00:25:25,140
when we look at the shield you know it's

607
00:25:25,140 --> 00:25:27,419
very funny because you have like the big

608
00:25:27,419 --> 00:25:29,580
Shield here and on top of the narrow

609
00:25:29,580 --> 00:25:32,940
block is a piece of Shield right and I

610
00:25:32,940 --> 00:25:35,159
say always like this is to me like it's

611
00:25:35,159 --> 00:25:37,679
a it's a narrow you know like you should

612
00:25:37,679 --> 00:25:39,360
look here you know like some kind of

613
00:25:39,360 --> 00:25:43,980
flag that yes so basically yes we've

614
00:25:43,980 --> 00:25:45,600
been looking at this structure that was

615
00:25:45,600 --> 00:25:47,400
also covered all right so you see it's

616
00:25:47,400 --> 00:25:50,580
not that big right and uh we've been

617
00:25:50,580 --> 00:25:52,500
putting like computers into Photoshop

618
00:25:52,500 --> 00:25:54,299
just to make some kind of like quick

619
00:25:54,299 --> 00:25:56,940
reverse engineer of the of the block and

620
00:25:56,940 --> 00:25:59,580
this is now the sheet logic right so you

621
00:25:59,580 --> 00:26:02,400
have the shield and it's it has like

622
00:26:02,400 --> 00:26:05,159
civil like points where it's basically

623
00:26:05,159 --> 00:26:06,179
sent

624
00:26:06,179 --> 00:26:08,400
so evaluate it let's say and then

625
00:26:08,400 --> 00:26:10,380
randomly they choose one of these signal

626
00:26:10,380 --> 00:26:14,520
to go to to send to the digital logic so

627
00:26:14,520 --> 00:26:15,779
it means that now if you want to

628
00:26:15,779 --> 00:26:17,940
understand the sheet that's inside the

629
00:26:17,940 --> 00:26:20,039
net is that the of the chip itself right

630
00:26:20,039 --> 00:26:23,460
and then if it says this so this is the

631
00:26:23,460 --> 00:26:25,320
beginning of the shield all right so you

632
00:26:25,320 --> 00:26:27,480
have the sheet lines that goes in any

633
00:26:27,480 --> 00:26:30,299
direction and this is uh the the what

634
00:26:30,299 --> 00:26:32,520
has been sensed by this little block

635
00:26:32,520 --> 00:26:36,120
right and what do you see here looks

636
00:26:36,120 --> 00:26:38,700
organ right so we just compare right

637
00:26:38,700 --> 00:26:41,340
which makes sense but it also means that

638
00:26:41,340 --> 00:26:44,220
if I'm here and I put the logical zero

639
00:26:44,220 --> 00:26:46,020
is a with a needle or directly

640
00:26:46,020 --> 00:26:48,299
connecting this track to the ground on

641
00:26:48,299 --> 00:26:51,120
the chip the chip doesn't the The Shield

642
00:26:51,120 --> 00:26:53,700
doesn't work anymore right it's not

643
00:26:53,700 --> 00:26:56,279
there whatever happens to the shield the

644
00:26:56,279 --> 00:26:57,960
the ship will think it's all right you

645
00:26:57,960 --> 00:27:00,140
know

646
00:27:00,419 --> 00:27:02,340
Okay so

647
00:27:02,340 --> 00:27:06,900
it shows to me that when you hear the

648
00:27:06,900 --> 00:27:09,200
protection against micro problem

649
00:27:09,200 --> 00:27:11,940
not really you know because people that

650
00:27:11,940 --> 00:27:14,100
might report will use an FIB to access

651
00:27:14,100 --> 00:27:16,140
their symbol and because they have an

652
00:27:16,140 --> 00:27:18,779
FID they can bypass the shield in the

653
00:27:18,779 --> 00:27:20,880
first place okay

654
00:27:20,880 --> 00:27:24,360
funny part and then you always say if I

655
00:27:24,360 --> 00:27:26,520
find this I will do a talk and I'm here

656
00:27:26,520 --> 00:27:31,520
today this cell is a r right

657
00:27:31,559 --> 00:27:33,600
and and this is this is interesting

658
00:27:33,600 --> 00:27:36,480
because this signal you can call it

659
00:27:36,480 --> 00:27:39,840
security evaluation for the shield right

660
00:27:39,840 --> 00:27:42,360
it arrives on the or so it means that

661
00:27:42,360 --> 00:27:44,760
the two other inputs for the for the or

662
00:27:44,760 --> 00:27:45,900
gate here

663
00:27:45,900 --> 00:27:49,980
is probably secretion first two

664
00:27:49,980 --> 00:27:52,740
so now you should go just observe itself

665
00:27:52,740 --> 00:27:56,279
right and you put this line to VCC not

666
00:27:56,279 --> 00:27:57,960
only the ship is not actually anymore

667
00:27:57,960 --> 00:28:00,419
but the two other counter measures are

668
00:28:00,419 --> 00:28:02,279
there right so you don't know what they

669
00:28:02,279 --> 00:28:05,520
are but they will not work right they

670
00:28:05,520 --> 00:28:07,260
will say maybe that there is a violation

671
00:28:07,260 --> 00:28:09,600
that you just said to the chip no don't

672
00:28:09,600 --> 00:28:11,580
take this into account this is useless

673
00:28:11,580 --> 00:28:14,159
you know it's not for you that for the L

674
00:28:14,159 --> 00:28:17,580
or anything like this all right

675
00:28:17,580 --> 00:28:20,159
so that gives you uh I think an idea of

676
00:28:20,159 --> 00:28:22,799
like what's what you can do the cool

677
00:28:22,799 --> 00:28:25,140
part was like this is the track that we

678
00:28:25,140 --> 00:28:27,900
want to do to VCC and the blue track the

679
00:28:27,900 --> 00:28:30,120
white blue track here uh that's VCC

680
00:28:30,120 --> 00:28:33,240
right so the edge itself was just like

681
00:28:33,240 --> 00:28:36,419
making a hole reaching this track and

682
00:28:36,419 --> 00:28:39,120
filling it with like Platinum until we

683
00:28:39,120 --> 00:28:42,240
reach the the the system track right and

684
00:28:42,240 --> 00:28:44,340
three content measures are dead two

685
00:28:44,340 --> 00:28:48,179
unknowns and the Sheep all right

686
00:28:48,179 --> 00:28:51,120
okay so then we probe all right so it

687
00:28:51,120 --> 00:28:53,580
looks like this and so we use the keep

688
00:28:53,580 --> 00:28:55,679
probes to get like the best signal

689
00:28:55,679 --> 00:28:58,620
possible and then we use Python script

690
00:28:58,620 --> 00:29:00,900
to just check what is the data and here

691
00:29:00,900 --> 00:29:04,620
we see one one memory I don't know which

692
00:29:04,620 --> 00:29:07,500
one this is I can't tell romart is zero

693
00:29:07,500 --> 00:29:09,600
all right and this is the internal clock

694
00:29:09,600 --> 00:29:11,640
of the device right so that's

695
00:29:11,640 --> 00:29:13,200
interesting to get the internet

696
00:29:13,200 --> 00:29:15,539
computers now you can simple with it but

697
00:29:15,539 --> 00:29:18,059
you can synchronize to it and that's uh

698
00:29:18,059 --> 00:29:22,940
that's very useful to have this right so

699
00:29:22,940 --> 00:29:26,340
Vegeta is basically the the leads we

700
00:29:26,340 --> 00:29:28,620
extracted so three bits for the for the

701
00:29:28,620 --> 00:29:30,720
run one bit for The Flash and this is

702
00:29:30,720 --> 00:29:33,539
running good so we see activity at the

703
00:29:33,539 --> 00:29:35,279
beginning and then it enters some kind

704
00:29:35,279 --> 00:29:38,100
of a loop right very fast

705
00:29:38,100 --> 00:29:40,620
and the idea was uh to compare the

706
00:29:40,620 --> 00:29:43,380
binary we think is the correct one

707
00:29:43,380 --> 00:29:45,960
to this one include all right and the

708
00:29:45,960 --> 00:29:48,120
longest sequence that we could find of

709
00:29:48,120 --> 00:29:50,340
like following outputs was something

710
00:29:50,340 --> 00:29:53,100
like 10 equal general you know which is

711
00:29:53,100 --> 00:29:55,799
uh not so much if you asked me I was

712
00:29:55,799 --> 00:29:58,679
expecting to have a to have more and

713
00:29:58,679 --> 00:30:02,880
yeah playing with this didn't help all

714
00:30:02,880 --> 00:30:05,039
right so nightcode is still from an

715
00:30:05,039 --> 00:30:07,740
unknown architecture architecture with

716
00:30:07,740 --> 00:30:11,820
no strings inside and well I don't know

717
00:30:11,820 --> 00:30:15,059
and yeah so this is where we stop uh

718
00:30:15,059 --> 00:30:17,100
where we are right now all right and

719
00:30:17,100 --> 00:30:19,380
this is all the things I showed to you

720
00:30:19,380 --> 00:30:21,960
that's one season where by the team

721
00:30:21,960 --> 00:30:24,419
right so that's that's pretty big and

722
00:30:24,419 --> 00:30:27,600
the next step are not uh small steps so

723
00:30:27,600 --> 00:30:31,020
when when this is done maybe I do a code

724
00:30:31,020 --> 00:30:33,899
for paper for Ado again because it's

725
00:30:33,899 --> 00:30:35,460
going to be very interesting because now

726
00:30:35,460 --> 00:30:38,220
what I think is next step will be to

727
00:30:38,220 --> 00:30:40,860
really simulate the fetching circuitry

728
00:30:40,860 --> 00:30:43,380
right so like this is the memory that's

729
00:30:43,380 --> 00:30:46,020
red and it's the the model that is

730
00:30:46,020 --> 00:30:47,760
implementing the address itself and

731
00:30:47,760 --> 00:30:50,340
everything because what I could foresee

732
00:30:50,340 --> 00:30:52,679
and what I can see already in the net is

733
00:30:52,679 --> 00:30:54,779
is like The Logical address and the

734
00:30:54,779 --> 00:30:56,640
address of the ROM it's a modified

735
00:30:56,640 --> 00:30:59,399
version right so we do something in the

736
00:30:59,399 --> 00:31:01,980
middle and I think that's why the binary

737
00:31:01,980 --> 00:31:04,200
I think is the correct one it's just not

738
00:31:04,200 --> 00:31:06,720
in the proper order still right after

739
00:31:06,720 --> 00:31:09,179
all we did so that's going to be uh

740
00:31:09,179 --> 00:31:11,279
first thing and now we have the code

741
00:31:11,279 --> 00:31:15,299
right by the way this this chip is uh is

742
00:31:15,299 --> 00:31:17,640
you can interact with extraction attacks

743
00:31:17,640 --> 00:31:19,799
on it too so the interactive extraction

744
00:31:19,799 --> 00:31:22,799
attacks are in the Z needle and it's

745
00:31:22,799 --> 00:31:24,720
made to jump through contents of

746
00:31:24,720 --> 00:31:26,700
memories that means that basically we

747
00:31:26,700 --> 00:31:28,799
could have a full gram and food large

748
00:31:28,799 --> 00:31:32,399
extracted like this okay but

749
00:31:32,399 --> 00:31:34,679
still if I have a binary but I cannot

750
00:31:34,679 --> 00:31:37,320
understand it that's that's bad I start

751
00:31:37,320 --> 00:31:39,720
to suspect this chip right to have a

752
00:31:39,720 --> 00:31:43,559
custom instruction set okay which is not

753
00:31:43,559 --> 00:31:46,320
very nice you have a binary and you have

754
00:31:46,320 --> 00:31:48,600
no idea of what kind of instruction you

755
00:31:48,600 --> 00:31:50,460
need to find inside so after the

756
00:31:50,460 --> 00:31:54,120
fetching circuitry analysis Next Step

757
00:31:54,120 --> 00:31:56,220
will be to look inside the the digital

758
00:31:56,220 --> 00:31:59,520
secretary and to do the the instructions

759
00:31:59,520 --> 00:32:01,740
to the basically rewriting the data

760
00:32:01,740 --> 00:32:05,520
sheet let's say uh that's what the the

761
00:32:05,520 --> 00:32:08,100
guys will do the pronounce that's they

762
00:32:08,100 --> 00:32:10,860
need to do this right the market is

763
00:32:10,860 --> 00:32:13,399
convenient

764
00:32:15,539 --> 00:32:17,640
and if you do this if you have the day

765
00:32:17,640 --> 00:32:19,559
if we rewrite the data sheets basically

766
00:32:19,559 --> 00:32:21,299
I think the the analysis will be

767
00:32:21,299 --> 00:32:23,399
completely so on this side they do more

768
00:32:23,399 --> 00:32:25,620
you know we emulate the project and sell

769
00:32:25,620 --> 00:32:28,140
it but on our site that's the end of the

770
00:32:28,140 --> 00:32:31,799
story right so for my conclusion

771
00:32:31,799 --> 00:32:35,399
um what can I say uh we tried with the

772
00:32:35,399 --> 00:32:38,279
talk to show you uh the process I mean

773
00:32:38,279 --> 00:32:40,080
like the thinking process you know like

774
00:32:40,080 --> 00:32:43,460
Watson invasive attack

775
00:32:43,880 --> 00:32:46,320
you know and I think you can see that

776
00:32:46,320 --> 00:32:48,480
it's a it's not an easy thing you know

777
00:32:48,480 --> 00:32:51,299
the time like the white structures with

778
00:32:51,299 --> 00:32:53,460
the FIB to probe and have like no more

779
00:32:53,460 --> 00:32:56,039
information you know it's it's it's a

780
00:32:56,039 --> 00:32:58,320
third thing right

781
00:32:58,320 --> 00:32:58,919
um

782
00:32:58,919 --> 00:33:02,340
I think she is a good point to discuss

783
00:33:02,340 --> 00:33:04,460
you know he had some points in real life

784
00:33:04,460 --> 00:33:07,679
and it's also true for some of the other

785
00:33:07,679 --> 00:33:09,659
counter measure

786
00:33:09,659 --> 00:33:13,320
that's what you can see I hope if I did

787
00:33:13,320 --> 00:33:16,140
a good job this morning is is sufficient

788
00:33:16,140 --> 00:33:17,100
time

789
00:33:17,100 --> 00:33:19,039
the cleaners will always

790
00:33:19,039 --> 00:33:23,220
to extract what they want right so it's

791
00:33:23,220 --> 00:33:25,559
not such a thing as a security right

792
00:33:25,559 --> 00:33:27,960
it's just a question of time and this is

793
00:33:27,960 --> 00:33:29,760
where I can argue that Shield is just

794
00:33:29,760 --> 00:33:31,919
another layer of protection and that the

795
00:33:31,919 --> 00:33:34,679
Pirates will sometimes just like you're

796
00:33:34,679 --> 00:33:35,880
doing this

797
00:33:35,880 --> 00:33:38,220
instances was really interesting

798
00:33:38,220 --> 00:33:40,080
discussion

799
00:33:40,080 --> 00:33:44,760
and yeah let's slide I think is some

800
00:33:44,760 --> 00:33:47,039
kind of History again you know like I

801
00:33:47,039 --> 00:33:49,980
can see that reverse engineering IC you

802
00:33:49,980 --> 00:33:52,980
know is increasingly increasingly

803
00:33:52,980 --> 00:33:53,519
um

804
00:33:53,519 --> 00:33:57,720
no it's it's getting big sorry and as a

805
00:33:57,720 --> 00:33:59,640
fixed plane for example we are part of a

806
00:33:59,640 --> 00:34:01,620
European project with law enforcement

807
00:34:01,620 --> 00:34:03,960
agencies to use this kind of techniques

808
00:34:03,960 --> 00:34:06,360
to learn things from like secure

809
00:34:06,360 --> 00:34:09,980
encrypted device right

810
00:34:10,440 --> 00:34:14,040
I think they still need to increase the

811
00:34:14,040 --> 00:34:16,320
security in Isis right and with the

812
00:34:16,320 --> 00:34:18,839
other methods that will then the ones

813
00:34:18,839 --> 00:34:21,719
that are free on currently in place and

814
00:34:21,719 --> 00:34:23,399
I think that red seeming the the

815
00:34:23,399 --> 00:34:25,020
integrated circuit is something that

816
00:34:25,020 --> 00:34:26,879
should be done more right I know it's

817
00:34:26,879 --> 00:34:29,219
expensive I know it's wrong but I think

818
00:34:29,219 --> 00:34:31,619
it's very useful to learn at least for

819
00:34:31,619 --> 00:34:34,980
the next uh chips right

820
00:34:34,980 --> 00:34:36,719
and there's still like the proper

821
00:34:36,719 --> 00:34:39,719
evaluation to the methods to be defined

822
00:34:39,719 --> 00:34:41,879
if you ask me right because it's hard to

823
00:34:41,879 --> 00:34:44,399
rank like as a general attack like DPA

824
00:34:44,399 --> 00:34:46,859
with the same

825
00:34:46,859 --> 00:34:49,980
in the same measure and we will solve

826
00:34:49,980 --> 00:34:52,560
this on the invasive attacks right I

827
00:34:52,560 --> 00:34:54,540
cannot do an invasive attack into this

828
00:34:54,540 --> 00:34:58,320
that's a real nice video right so for

829
00:34:58,320 --> 00:34:59,720
this we are also part of another

830
00:34:59,720 --> 00:35:02,339
European project arshin which is like

831
00:35:02,339 --> 00:35:04,080
basically discussing how we can make

832
00:35:04,080 --> 00:35:06,000
like secure Hardware in the context of

833
00:35:06,000 --> 00:35:08,760
like fully transparency code right so I

834
00:35:08,760 --> 00:35:10,859
give you the United States and I think

835
00:35:10,859 --> 00:35:12,300
that's good that's where we should go

836
00:35:12,300 --> 00:35:14,339
you know like the security by Design I

837
00:35:14,339 --> 00:35:16,500
show you the the dentist I show you the

838
00:35:16,500 --> 00:35:18,119
firmware and I say you need to do this

839
00:35:18,119 --> 00:35:20,700
now you get what you want and good luck

840
00:35:20,700 --> 00:35:23,460
you know that's ever three uh possible

841
00:35:23,460 --> 00:35:24,780
here

842
00:35:24,780 --> 00:35:28,980
and this being said that's it so thank

843
00:35:28,980 --> 00:35:32,339
you for for your patience and if you

844
00:35:32,339 --> 00:35:34,440
have questions and I'm here

845
00:35:34,440 --> 00:35:37,280
thanks Olivia

846
00:35:37,440 --> 00:35:40,440
wow

847
00:35:40,920 --> 00:35:43,680
so we have time for a couple questions

848
00:35:43,680 --> 00:35:45,300
do we have some questions from the

849
00:35:45,300 --> 00:35:49,579
audience we have way too many questions

850
00:35:56,400 --> 00:35:57,599
hi

851
00:35:57,599 --> 00:36:00,119
I have one question once you've got the

852
00:36:00,119 --> 00:36:03,420
full necklace are there any I mean not

853
00:36:03,420 --> 00:36:06,839
least of the ship essentially is there

854
00:36:06,839 --> 00:36:09,000
anything stopping you from converting

855
00:36:09,000 --> 00:36:11,160
that to some Hardware description

856
00:36:11,160 --> 00:36:14,099
language like phdl that's what we do the

857
00:36:14,099 --> 00:36:16,140
Netflix that I'm using here that's uh

858
00:36:16,140 --> 00:36:18,540
that's the HDL okay so you already

859
00:36:18,540 --> 00:36:21,060
converted back to yesterday so on this

860
00:36:21,060 --> 00:36:23,099
on this example you have like digital

861
00:36:23,099 --> 00:36:25,680
logic is a vhdl block the ROM is a

862
00:36:25,680 --> 00:36:26,940
number one you know and they are

863
00:36:26,940 --> 00:36:30,200
speaking to each other okay

864
00:36:30,200 --> 00:36:32,940
yes so it would be great to see you

865
00:36:32,940 --> 00:36:35,520
later down to your chip first I think

866
00:36:35,520 --> 00:36:37,440
it's it's low and complicated you know

867
00:36:37,440 --> 00:36:39,900
on any computer and and second I think

868
00:36:39,900 --> 00:36:42,300
like it's not possible to get a 100

869
00:36:42,300 --> 00:36:44,760
accurate not least of the digital

870
00:36:44,760 --> 00:36:47,400
circuit because it's big yeah and if you

871
00:36:47,400 --> 00:36:48,960
spend the time to clean it all right

872
00:36:48,960 --> 00:36:52,260
okay let's uh you know so that's why I I

873
00:36:52,260 --> 00:36:54,839
miserating parts of the second pitching

874
00:36:54,839 --> 00:36:56,940
all right that's one thing instruction

875
00:36:56,940 --> 00:36:57,960
because

876
00:36:57,960 --> 00:37:01,440
one so you want to stay small

877
00:37:01,440 --> 00:37:03,060
text

878
00:37:03,060 --> 00:37:05,220
okay one more question

879
00:37:05,220 --> 00:37:08,000
you have to

880
00:37:11,300 --> 00:37:13,800
right thank you for your nice

881
00:37:13,800 --> 00:37:15,900
presentation I have a question regarding

882
00:37:15,900 --> 00:37:17,880
the

883
00:37:17,880 --> 00:37:20,220
technology node and if you go to the

884
00:37:20,220 --> 00:37:21,599
lower technology do you have any

885
00:37:21,599 --> 00:37:25,820
restriction for this whole process

886
00:37:26,780 --> 00:37:29,339
it's a very tough question so first of

887
00:37:29,339 --> 00:37:31,800
all I'm looking at secure chips so take

888
00:37:31,800 --> 00:37:35,460
note 14 nanometer and a gold right so

889
00:37:35,460 --> 00:37:38,520
then can we do it in five nanometer tsmc

890
00:37:38,520 --> 00:37:40,440
that's your question in a way you know

891
00:37:40,440 --> 00:37:43,140
and answer would be maybe you had to

892
00:37:43,140 --> 00:37:44,640
explain we won't do it because we don't

893
00:37:44,640 --> 00:37:46,440
have like projects like this so much you

894
00:37:46,440 --> 00:37:49,440
know but we did try you know to make

895
00:37:49,440 --> 00:37:51,480
pictures almost stack and to prepare

896
00:37:51,480 --> 00:37:53,400
like the the cheap vendors we need to

897
00:37:53,400 --> 00:37:55,260
have the right machine to do the career

898
00:37:55,260 --> 00:37:57,720
analysis file so it means that the

899
00:37:57,720 --> 00:38:00,000
attacker will be able to do it it's way

900
00:38:00,000 --> 00:38:02,700
more complicated I don't like take I

901
00:38:02,700 --> 00:38:04,619
don't know like the layers would be at

902
00:38:04,619 --> 00:38:06,420
the end of the day like 15 nanometer

903
00:38:06,420 --> 00:38:09,000
what a peak all right and you need to be

904
00:38:09,000 --> 00:38:12,300
flat inside it's a statue another

905
00:38:12,300 --> 00:38:15,180
question is that uh this obfuscation

906
00:38:15,180 --> 00:38:17,220
period is being evolved with the time I

907
00:38:17,220 --> 00:38:20,099
mean logic is there I mean are you aware

908
00:38:20,099 --> 00:38:21,960
of these techniques I mean could you do

909
00:38:21,960 --> 00:38:25,079
some so much and if they implemented the

910
00:38:25,079 --> 00:38:27,720
ICS a lot the thing is in this context

911
00:38:27,720 --> 00:38:29,520
by example they may like the whole thing

912
00:38:29,520 --> 00:38:31,380
so they would also emulate the blocking

913
00:38:31,380 --> 00:38:34,920
and like this they don't care so

914
00:38:34,920 --> 00:38:37,380
um it's usually not an issue for them

915
00:38:37,380 --> 00:38:39,540
because like their goal is really to

916
00:38:39,540 --> 00:38:42,960
emulate so they emulate everything and

917
00:38:42,960 --> 00:38:44,720
these two

918
00:38:44,720 --> 00:38:47,880
thank you so much I apprecially we don't

919
00:38:47,880 --> 00:38:49,680
have much time for all other questions

920
00:38:49,680 --> 00:38:52,800
so we suggest everyone to find Olivia in

921
00:38:52,800 --> 00:38:55,380
the fall and ask them privately

922
00:38:55,380 --> 00:38:57,900
thanks everyone and we're uh thank you

923
00:38:57,900 --> 00:38:59,940
here for the next big round of applause

924
00:38:59,940 --> 00:39:02,960
please thank you

