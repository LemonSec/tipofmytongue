1
00:00:02,940 --> 00:00:06,839
all right hello everyone uh so for those

2
00:00:06,839 --> 00:00:09,120
of you who don't know me I am a

3
00:00:09,120 --> 00:00:12,360
consultant at NCC group uh specialize in

4
00:00:12,360 --> 00:00:15,299
Hardware embedded systems and I'm based

5
00:00:15,299 --> 00:00:18,600
in Waterloo in Canada uh I created

6
00:00:18,600 --> 00:00:22,020
sniffle the Bluetooth live LED zipper

7
00:00:22,020 --> 00:00:24,840
that I released here a few years ago uh

8
00:00:24,840 --> 00:00:27,119
and in general I'm a little deep car

9
00:00:27,119 --> 00:00:29,720
enthusiastic

10
00:00:31,920 --> 00:00:36,600
so this talk is all about YouTube Le

11
00:00:36,600 --> 00:00:39,360
based authentication systems and attacks

12
00:00:39,360 --> 00:00:41,340
against them

13
00:00:41,340 --> 00:00:43,200
so

14
00:00:43,200 --> 00:00:45,420
the basic idea behind of similar

15
00:00:45,420 --> 00:00:47,879
authentication is

16
00:00:47,879 --> 00:00:49,800
you have some object in your possession

17
00:00:49,800 --> 00:00:51,480
you walk up to something that you want

18
00:00:51,480 --> 00:00:53,700
to unlock you can go and touch the door

19
00:00:53,700 --> 00:00:55,800
lock and have it unlocked or startup or

20
00:00:55,800 --> 00:01:00,320
do whatever you want to achieve so

21
00:01:00,320 --> 00:01:02,760
wireless communication between the

22
00:01:02,760 --> 00:01:04,559
object and possession and you have to

23
00:01:04,559 --> 00:01:07,680
unlock and the most common example of

24
00:01:07,680 --> 00:01:12,500
this is uh Automotive keyless entry uh

25
00:01:12,500 --> 00:01:15,299
with the car quite commonly just keep

26
00:01:15,299 --> 00:01:17,040
key fob in your pocket walk up the car

27
00:01:17,040 --> 00:01:19,380
that's the door handles unlock it and

28
00:01:19,380 --> 00:01:23,280
the same way uh you could

29
00:01:23,280 --> 00:01:25,439
start the car just keeping keep on not

30
00:01:25,439 --> 00:01:28,860
needing to have otherwise attractive but

31
00:01:28,860 --> 00:01:30,659
the same kind of attack is also from any

32
00:01:30,659 --> 00:01:33,180
other applications so uh there are smart

33
00:01:33,180 --> 00:01:34,860
locks for Home applications that have

34
00:01:34,860 --> 00:01:36,540
similar features they're building the

35
00:01:36,540 --> 00:01:38,100
Access Control Systems where you don't

36
00:01:38,100 --> 00:01:40,979
need to actually tap a fob you just uh

37
00:01:40,979 --> 00:01:42,740
walk into the building

38
00:01:42,740 --> 00:01:45,720
and there are also some laptops mobile

39
00:01:45,720 --> 00:01:47,100
phones with similar functionality

40
00:01:47,100 --> 00:01:49,619
letting you either unlock them or keep

41
00:01:49,619 --> 00:01:51,659
them unlocked when you have some trusted

42
00:01:51,659 --> 00:01:54,659
device in your possession

43
00:01:54,659 --> 00:01:57,420
now four proximity authentication to

44
00:01:57,420 --> 00:02:00,479
work you need to be able to measure how

45
00:02:00,479 --> 00:02:02,579
far away the device in the position is

46
00:02:02,579 --> 00:02:04,439
from the device you're unlocking and

47
00:02:04,439 --> 00:02:06,479
there's several ways to do this so uh

48
00:02:06,479 --> 00:02:08,880
one of the simplest and most obvious is

49
00:02:08,880 --> 00:02:11,700
just measuring the uh you see signals

50
00:02:11,700 --> 00:02:13,280
again

51
00:02:13,280 --> 00:02:16,260
so when you have a strong signal for

52
00:02:16,260 --> 00:02:17,580
communication from these two devices

53
00:02:17,580 --> 00:02:20,099
that probably means they're closed

54
00:02:20,099 --> 00:02:21,860
together right

55
00:02:21,860 --> 00:02:26,459
why that's not uh it's obvious why you

56
00:02:26,459 --> 00:02:29,280
can see with that there's also type of

57
00:02:29,280 --> 00:02:31,260
flight based ranging as possible where

58
00:02:31,260 --> 00:02:33,120
you measure how long it takes for

59
00:02:33,120 --> 00:02:36,060
signals between the advices to propagate

60
00:02:36,060 --> 00:02:37,920
roughly the speed of light

61
00:02:37,920 --> 00:02:40,739
there also are other measurement systems

62
00:02:40,739 --> 00:02:42,840
for example there's a multi-carrier

63
00:02:42,840 --> 00:02:46,140
phase case range the idea behind that is

64
00:02:46,140 --> 00:02:48,180
if you're transmitting say multiple

65
00:02:48,180 --> 00:02:52,140
phones at different frequencies

66
00:02:52,140 --> 00:02:55,019
the phase shift in the different

67
00:02:55,019 --> 00:02:58,379
frequencies would be uh

68
00:02:58,379 --> 00:03:00,300
difference when you have the same amount

69
00:03:00,300 --> 00:03:02,160
of Transport today so based on the

70
00:03:02,160 --> 00:03:04,319
difference in Phase between carriers you

71
00:03:04,319 --> 00:03:07,860
can imagine what things are there's also

72
00:03:07,860 --> 00:03:11,340
a feature in Bluetooth LED those

73
00:03:11,340 --> 00:03:13,680
just basic reading obviously used for

74
00:03:13,680 --> 00:03:16,200
for measuring the the angle of arrival

75
00:03:16,200 --> 00:03:18,659
of cities so if you have say a multi

76
00:03:18,659 --> 00:03:20,340
antenna system and you measuring phase

77
00:03:20,340 --> 00:03:23,220
differences uh between uh where are the

78
00:03:23,220 --> 00:03:25,080
same signal reaches multiple tests and

79
00:03:25,080 --> 00:03:27,420
you can figure out the direction from

80
00:03:27,420 --> 00:03:29,459
which the uh

81
00:03:29,459 --> 00:03:33,420
so angle of arrival while it's not uh

82
00:03:33,420 --> 00:03:35,400
distance measuring scheme itself you can

83
00:03:35,400 --> 00:03:37,500
use it together with the other schemes

84
00:03:37,500 --> 00:03:39,840
to find out where the person is that's

85
00:03:39,840 --> 00:03:42,379
what I'm getting or if you have multiple

86
00:03:42,379 --> 00:03:45,900
regulation as well and the other schemes

87
00:03:45,900 --> 00:03:46,980
as well they could also use

88
00:03:46,980 --> 00:03:50,159
triangulation type setup so uh for

89
00:03:50,159 --> 00:03:51,840
example inside a car you want to know

90
00:03:51,840 --> 00:03:55,920
which door the driver or the person is

91
00:03:55,920 --> 00:03:58,379
approaching uh or say with the Smart

92
00:03:58,379 --> 00:04:00,680
Lock you won't be able to make sure

93
00:04:00,680 --> 00:04:02,760
the person you

94
00:04:02,760 --> 00:04:04,920
with the trust devices on the outside

95
00:04:04,920 --> 00:04:08,280
and you're unlocking it so that uh key

96
00:04:08,280 --> 00:04:09,780
fob or smartphone whatever you left

97
00:04:09,780 --> 00:04:11,580
inside the house you can actually unlock

98
00:04:11,580 --> 00:04:14,340
the floor

99
00:04:14,340 --> 00:04:17,339
so all these distant measurement schemes

100
00:04:17,339 --> 00:04:18,959
are vulnerable to different types of

101
00:04:18,959 --> 00:04:20,478
that so

102
00:04:20,478 --> 00:04:24,240
with the RSS i-based systems if you're

103
00:04:24,240 --> 00:04:25,860
just communicating with the devices

104
00:04:25,860 --> 00:04:28,560
nearby you could fool it some devices

105
00:04:28,560 --> 00:04:29,580
have

106
00:04:29,580 --> 00:04:32,460
very insecure authentication schemes

107
00:04:32,460 --> 00:04:35,520
where you just do a replay attack where

108
00:04:35,520 --> 00:04:36,560
you record

109
00:04:36,560 --> 00:04:39,300
previously again but if you have a

110
00:04:39,300 --> 00:04:41,220
properly designed off scheme that should

111
00:04:41,220 --> 00:04:42,960
run

112
00:04:42,960 --> 00:04:45,540
The Next Step Up from that is a really

113
00:04:45,540 --> 00:04:47,460
attack where you bridge the

114
00:04:47,460 --> 00:04:48,900
communications between the two devices

115
00:04:48,900 --> 00:04:50,460
that they think they're close to each

116
00:04:50,460 --> 00:04:52,199
other even if they could be further

117
00:04:52,199 --> 00:04:54,360
apart so there are several ways you can

118
00:04:54,360 --> 00:04:57,180
do this boosting the signals amplifier

119
00:04:57,180 --> 00:05:02,120
or retransmitting it from close device

120
00:05:03,139 --> 00:05:05,340
approaches can make devices think

121
00:05:05,340 --> 00:05:06,660
they're close to each other at least

122
00:05:06,660 --> 00:05:09,479
telling our society perspective

123
00:05:09,479 --> 00:05:11,280
now with time of flight based

124
00:05:11,280 --> 00:05:13,139
measurements if it's not being

125
00:05:13,139 --> 00:05:15,240
integrated as part of what's called

126
00:05:15,240 --> 00:05:17,699
secure agency where there's some graph

127
00:05:17,699 --> 00:05:20,699
control response coupled to it then if

128
00:05:20,699 --> 00:05:22,800
there is a time-of-flight ping you can

129
00:05:22,800 --> 00:05:24,060
just respond to that right away from

130
00:05:24,060 --> 00:05:25,919
very close to it

131
00:05:25,919 --> 00:05:28,500
secure ranging schemes are a little more

132
00:05:28,500 --> 00:05:31,160
public later

133
00:05:31,160 --> 00:05:34,080
and for other Facebook for other systems

134
00:05:34,080 --> 00:05:36,479
for example with face-based ranging uh

135
00:05:36,479 --> 00:05:37,800
you could just

136
00:05:37,800 --> 00:05:40,740
uh transmit these uh

137
00:05:40,740 --> 00:05:42,180
uh

138
00:05:42,180 --> 00:05:44,639
the multiplayer signals with three

139
00:05:44,639 --> 00:05:47,280
offset phases so that the receiving

140
00:05:47,280 --> 00:05:50,340
device thinks that the phase difference

141
00:05:50,340 --> 00:05:51,900
represents some distance from those

142
00:05:51,900 --> 00:05:53,639
actions

143
00:05:53,639 --> 00:05:55,620
and even with time-of-flight based

144
00:05:55,620 --> 00:05:58,440
attack or schemes that are employed in

145
00:05:58,440 --> 00:06:00,300
Secure ranging there are some possible

146
00:06:00,300 --> 00:06:03,000
attacks as well so for example there's

147
00:06:03,000 --> 00:06:06,780
the early detect plates uh mid attack

148
00:06:06,780 --> 00:06:10,159
which lets you

149
00:06:10,320 --> 00:06:12,380
have slightly

150
00:06:12,380 --> 00:06:16,199
widened window which

151
00:06:16,199 --> 00:06:17,699
time of flight

152
00:06:17,699 --> 00:06:20,280
is

153
00:06:20,280 --> 00:06:22,080
recognized

154
00:06:22,080 --> 00:06:23,580
uh

155
00:06:23,580 --> 00:06:25,860
with ble uh

156
00:06:25,860 --> 00:06:27,740
it's possible to

157
00:06:27,740 --> 00:06:31,440
have a mobile device like your phone uh

158
00:06:31,440 --> 00:06:33,600
packed as the authentication token

159
00:06:33,600 --> 00:06:35,880
there's all sorts of devices that use

160
00:06:35,880 --> 00:06:39,180
the elite for proximity off so there are

161
00:06:39,180 --> 00:06:40,740
many cars that function about this

162
00:06:40,740 --> 00:06:43,919
including all for Tesla models

163
00:06:43,919 --> 00:06:47,639
with smart locks or many brands of old

164
00:06:47,639 --> 00:06:49,440
smart locks that you can unlock that's

165
00:06:49,440 --> 00:06:51,300
keeping your phone you want is having a

166
00:06:51,300 --> 00:06:54,900
lot for example the Kevo line of blocks

167
00:06:54,900 --> 00:06:57,900
with mobile phones for instance the Heat

168
00:06:57,900 --> 00:07:01,380
and Android device unlocked if some

169
00:07:01,380 --> 00:07:04,620
device LED your class is a maintaining a

170
00:07:04,620 --> 00:07:06,120
connection with it

171
00:07:06,120 --> 00:07:07,280
with

172
00:07:07,280 --> 00:07:10,080
computers there's features like the

173
00:07:10,080 --> 00:07:12,840
Smart Lock on Chromebooks which lets you

174
00:07:12,840 --> 00:07:15,660
unlock them if you have an Android phone

175
00:07:15,660 --> 00:07:17,340
nearby that's able to communicate with

176
00:07:17,340 --> 00:07:20,520
them signal

177
00:07:20,639 --> 00:07:21,780
um

178
00:07:21,780 --> 00:07:23,580
and there are all sorts of other

179
00:07:23,580 --> 00:07:25,620
products and similar applications so

180
00:07:25,620 --> 00:07:27,240
there's old alarm systems have been

181
00:07:27,240 --> 00:07:28,620
disarmed when you keep the phone with

182
00:07:28,620 --> 00:07:30,539
your pocket uh they're building Access

183
00:07:30,539 --> 00:07:32,699
Control Systems you just walked into

184
00:07:32,699 --> 00:07:34,440
building your

185
00:07:34,440 --> 00:07:36,240
your phone is able to communicate with

186
00:07:36,240 --> 00:07:40,220
the control system over the elite uh

187
00:07:40,220 --> 00:07:42,360
hospitals and all sorts of things where

188
00:07:42,360 --> 00:07:45,660
uh it would be interesting for the

189
00:07:45,660 --> 00:07:47,699
security status to be able to be I just

190
00:07:47,699 --> 00:07:49,500
think for a different locations close to

191
00:07:49,500 --> 00:07:51,479
each other

192
00:07:51,479 --> 00:07:55,199
now Heelys was never designed as a for

193
00:07:55,199 --> 00:07:58,259
all for about sending me off so there is

194
00:07:58,259 --> 00:08:02,220
no uh functionality in Bluetooth and a

195
00:08:02,220 --> 00:08:05,400
layer of classic right now to give you a

196
00:08:05,400 --> 00:08:07,680
good way to measure time of flight at

197
00:08:07,680 --> 00:08:09,300
least with standard radius you could

198
00:08:09,300 --> 00:08:12,840
customize it

199
00:08:14,000 --> 00:08:16,819
compatible with office official phones

200
00:08:16,819 --> 00:08:19,500
and likewise there is no

201
00:08:19,500 --> 00:08:21,720
suitable built-in functionality and

202
00:08:21,720 --> 00:08:25,020
face-based food either so with ble

203
00:08:25,020 --> 00:08:27,599
devices with any proximity off uh

204
00:08:27,599 --> 00:08:30,900
they're just using RSSI basically so

205
00:08:30,900 --> 00:08:33,419
sometimes combining that with angular

206
00:08:33,419 --> 00:08:35,399
survival

207
00:08:35,399 --> 00:08:37,979
so as a result of this feeling facility

208
00:08:37,979 --> 00:08:41,700
off is vulnerable to really attacks and

209
00:08:41,700 --> 00:08:44,580
the Bluetooth Sync has known this for

210
00:08:44,580 --> 00:08:47,339
the longest time ever since it came up

211
00:08:47,339 --> 00:08:50,640
essentially and they also state that uh

212
00:08:50,640 --> 00:08:52,260
you can see the device into thinking

213
00:08:52,260 --> 00:08:54,480
they're close to each other and you

214
00:08:54,480 --> 00:08:56,160
shouldn't be using feeling of sending

215
00:08:56,160 --> 00:08:59,279
off for uh protecting valuable masks

216
00:08:59,279 --> 00:09:01,440
nonetheless

217
00:09:01,440 --> 00:09:03,899
all sorts of makers products do that

218
00:09:03,899 --> 00:09:05,760
anyways because it's convenience it's

219
00:09:05,760 --> 00:09:07,860
just called every smartphone nowadays

220
00:09:07,860 --> 00:09:09,420
has vle

221
00:09:09,420 --> 00:09:11,459
and uh

222
00:09:11,459 --> 00:09:14,580
it's just a easy protocol to work with

223
00:09:14,580 --> 00:09:18,120
and probably compatible

224
00:09:18,120 --> 00:09:20,160
so

225
00:09:20,160 --> 00:09:22,800
relay attacks are nothing either being

226
00:09:22,800 --> 00:09:24,899
done for courageous and have been used

227
00:09:24,899 --> 00:09:26,519
against all sorts of facility law

228
00:09:26,519 --> 00:09:29,040
systems in the past there are a few

229
00:09:29,040 --> 00:09:30,200
variations

230
00:09:30,200 --> 00:09:32,820
so one of the symptoms is

231
00:09:32,820 --> 00:09:35,040
here I'm just using the phone in this

232
00:09:35,040 --> 00:09:37,140
car's exam and you could have let's say

233
00:09:37,140 --> 00:09:40,819
a default smartphone

234
00:09:41,339 --> 00:09:43,140
the simplest attack

235
00:09:43,140 --> 00:09:45,240
uh you just amplify the signals which

236
00:09:45,240 --> 00:09:46,980
was submitted by each device so that the

237
00:09:46,980 --> 00:09:50,339
RSSI on the other side would make you

238
00:09:50,339 --> 00:09:53,700
guys think of its close by

239
00:09:53,700 --> 00:09:56,339
there's also a variation that we've had

240
00:09:56,339 --> 00:09:59,820
where you transport the signals between

241
00:09:59,820 --> 00:10:02,519
the two sides of a different carrier or

242
00:10:02,519 --> 00:10:04,560
different means you transmit it from

243
00:10:04,560 --> 00:10:06,720
that place

244
00:10:06,720 --> 00:10:08,760
so

245
00:10:08,760 --> 00:10:12,000
with the ladder it doesn't let you

246
00:10:12,000 --> 00:10:14,640
bypass uh some addition types of fuses

247
00:10:14,640 --> 00:10:15,540
now

248
00:10:15,540 --> 00:10:17,580
when we go back to before just the

249
00:10:17,580 --> 00:10:19,560
simple analog synthetic

250
00:10:19,560 --> 00:10:22,160
ation is is using really simple Hardware

251
00:10:22,160 --> 00:10:25,080
the latency you add is mainly just from

252
00:10:25,080 --> 00:10:27,420
the speed of light communication between

253
00:10:27,420 --> 00:10:30,839
the two sides and the overall patterns

254
00:10:30,839 --> 00:10:33,660
and timing of communication is not a

255
00:10:33,660 --> 00:10:36,899
change from normal unrelated operation

256
00:10:36,899 --> 00:10:38,700
so

257
00:10:38,700 --> 00:10:40,500
so

258
00:10:40,500 --> 00:10:42,380
fairly

259
00:10:42,380 --> 00:10:45,180
reliables however

260
00:10:45,180 --> 00:10:47,820
there is there are limits to how far he

261
00:10:47,820 --> 00:10:50,160
is right so for one

262
00:10:50,160 --> 00:10:52,740
um usually you still have a limit to how

263
00:10:52,740 --> 00:10:55,980
much you can amplify the signal and uh

264
00:10:55,980 --> 00:10:59,399
additionally when you get to ruling over

265
00:10:59,399 --> 00:11:01,740
very long distances

266
00:11:01,740 --> 00:11:05,339
the time of flight becomes an issue it's

267
00:11:05,339 --> 00:11:08,899
a violating timing requirements

268
00:11:09,140 --> 00:11:12,180
additionally if you have a protocol like

269
00:11:12,180 --> 00:11:14,279
Bluetooth where your bi-directional

270
00:11:14,279 --> 00:11:15,899
Communications on the same frequency

271
00:11:15,899 --> 00:11:19,160
becomes a bit more complicated

272
00:11:19,160 --> 00:11:21,060
because we should be able to figure out

273
00:11:21,060 --> 00:11:25,220
positions and furthermore if you have

274
00:11:25,220 --> 00:11:28,140
multi-usiver systems then just by

275
00:11:28,140 --> 00:11:32,160
looking at the pattern in which our side

276
00:11:32,160 --> 00:11:33,839
declines by Distance by doing

277
00:11:33,839 --> 00:11:36,300
triangulation you can detect that

278
00:11:36,300 --> 00:11:37,620
something that's fishing if you're just

279
00:11:37,620 --> 00:11:40,440
amplifying the signal from far away

280
00:11:40,440 --> 00:11:43,680
so you could do an analog version of the

281
00:11:43,680 --> 00:11:46,740
transport when you transmit type as well

282
00:11:46,740 --> 00:11:49,560
where uh you capture the frequency of

283
00:11:49,560 --> 00:11:51,000
Interest

284
00:11:51,000 --> 00:11:53,519
you transport that a lot of data but

285
00:11:53,519 --> 00:11:55,320
over a different carrier in the refund

286
00:11:55,320 --> 00:11:58,980
submitted up close uh to uh device so uh

287
00:11:58,980 --> 00:12:01,980
this way you can avoid many of the

288
00:12:01,980 --> 00:12:04,860
triangulation based differences

289
00:12:04,860 --> 00:12:07,860
and

290
00:12:08,519 --> 00:12:10,320
uh

291
00:12:10,320 --> 00:12:13,680
the minimal disruption of the timing and

292
00:12:13,680 --> 00:12:16,579
patterns of communication

293
00:12:18,620 --> 00:12:21,480
you're still limited to

294
00:12:21,480 --> 00:12:24,560
in the business

295
00:12:28,680 --> 00:12:31,500
finally with the transplant type of

296
00:12:31,500 --> 00:12:32,519
packing all

297
00:12:32,519 --> 00:12:34,620
form a bit where you're just

298
00:12:34,620 --> 00:12:39,300
taking the additional access over there

299
00:12:39,300 --> 00:12:41,459
within four wall and log signals if

300
00:12:41,459 --> 00:12:42,660
you're doing it this way you're dealing

301
00:12:42,660 --> 00:12:45,560
with a lot less there and you could use

302
00:12:45,560 --> 00:12:48,180
transports like the internet or the

303
00:12:48,180 --> 00:12:49,880
easily

304
00:12:49,880 --> 00:12:51,980
connection

305
00:12:51,980 --> 00:12:54,300
also when you're doing it this digitally

306
00:12:54,300 --> 00:12:56,459
like this it's quite easy to add in

307
00:12:56,459 --> 00:12:59,100
other functionality

308
00:12:59,100 --> 00:13:01,860
injection modification droppings

309
00:13:01,860 --> 00:13:04,220
anything

310
00:13:04,639 --> 00:13:07,380
but when you're doing Additionally you

311
00:13:07,380 --> 00:13:10,560
do have some drawbacks so for one

312
00:13:10,560 --> 00:13:12,120
because of all this additional

313
00:13:12,120 --> 00:13:13,920
processing involved there is

314
00:13:13,920 --> 00:13:16,860
considerably more latency introducible

315
00:13:16,860 --> 00:13:21,420
and furthermore the timing of when

316
00:13:21,420 --> 00:13:23,160
things are translated being precisely

317
00:13:23,160 --> 00:13:24,660
matched in all the daily operation

318
00:13:24,660 --> 00:13:25,800
because

319
00:13:25,800 --> 00:13:28,800
operations

320
00:13:31,019 --> 00:13:35,639
so with feeling uh there have been a

321
00:13:35,639 --> 00:13:38,459
bunch of really attacks in the past uh

322
00:13:38,459 --> 00:13:40,519
operating in various levels of the staff

323
00:13:40,519 --> 00:13:43,380
so to understand the little recently

324
00:13:43,380 --> 00:13:45,740
produce

325
00:13:45,980 --> 00:13:47,579
data

326
00:13:47,579 --> 00:13:50,519
so like with any radio protocol lowest

327
00:13:50,519 --> 00:13:52,320
level you have a physical layer of the

328
00:13:52,320 --> 00:13:54,600
analog

329
00:13:54,600 --> 00:13:57,120
uh transmission receiving then about

330
00:13:57,120 --> 00:14:00,620
that the link layer is what

331
00:14:08,240 --> 00:14:10,200
use that

332
00:14:10,200 --> 00:14:11,639
and then

333
00:14:11,639 --> 00:14:13,560
hopefully look we're in finally are

334
00:14:13,560 --> 00:14:15,420
implemented within a Bluetooth

335
00:14:15,420 --> 00:14:17,639
controller check generally that is

336
00:14:17,639 --> 00:14:19,860
connected to a host over a standardized

337
00:14:19,860 --> 00:14:22,860
protocols

338
00:14:22,980 --> 00:14:25,339
there are a few different relationships

339
00:14:25,339 --> 00:14:27,920
I've seen types of commands

340
00:14:27,920 --> 00:14:30,240
[Music]

341
00:14:30,240 --> 00:14:32,220
and then the whole side of things you

342
00:14:32,220 --> 00:14:33,779
have several layers of the staff so

343
00:14:33,779 --> 00:14:36,180
there's LG path which does Support

344
00:14:36,180 --> 00:14:37,920
called multiplexing for higher level

345
00:14:37,920 --> 00:14:41,459
protocols and you assembly for a lot of

346
00:14:41,459 --> 00:14:45,540
videos and then at the app layer of all

347
00:14:45,540 --> 00:14:46,860
the dots

348
00:14:46,860 --> 00:14:49,800
you got protocol so the generic

349
00:14:49,800 --> 00:14:51,480
attribute protocol has structures

350
00:14:51,480 --> 00:14:53,040
Communications

351
00:14:53,040 --> 00:14:55,860
include services and characteristics

352
00:14:55,860 --> 00:14:57,680
so

353
00:14:57,680 --> 00:15:00,120
when you're writing an application you

354
00:15:00,120 --> 00:15:02,760
say on mobile OS or most embedded

355
00:15:02,760 --> 00:15:05,060
systems

356
00:15:06,740 --> 00:15:08,699
there's also something called those

357
00:15:08,699 --> 00:15:12,420
mirror access profile that just defines

358
00:15:12,420 --> 00:15:14,820
procedures for establishing connections

359
00:15:14,820 --> 00:15:19,160
and the roles out of high school

360
00:15:19,160 --> 00:15:22,279
Advertiser and the other elections

361
00:15:22,279 --> 00:15:25,320
scanner and then initiative connection

362
00:15:25,320 --> 00:15:30,060
and then active Master State rules

363
00:15:30,060 --> 00:15:31,440
so

364
00:15:31,440 --> 00:15:34,320
one of the first ways that Bleu really

365
00:15:34,320 --> 00:15:36,720
attacks were done was operating apps the

366
00:15:36,720 --> 00:15:39,779
Gap player using standard apis and

367
00:15:39,779 --> 00:15:43,079
verbal blue staff so this was done both

368
00:15:43,079 --> 00:15:45,510
via some of your addressing

369
00:15:45,510 --> 00:15:46,920
[Music]

370
00:15:46,920 --> 00:15:48,959
uh they both around the same time

371
00:15:48,959 --> 00:15:52,500
released different limitations of uh

372
00:15:52,500 --> 00:15:56,160
relays and metal tools operates uh at

373
00:15:56,160 --> 00:15:58,199
the Gap layer

374
00:15:58,199 --> 00:16:00,959
more recently there's been a relay that

375
00:16:00,959 --> 00:16:04,500
just operates directly with the HCI and

376
00:16:04,500 --> 00:16:07,620
bypasses measuring stack that's was

377
00:16:07,620 --> 00:16:13,740
implemented as part of uh Mirage here

378
00:16:14,040 --> 00:16:18,180
so uh this is by offering a level I

379
00:16:18,180 --> 00:16:19,740
would get a bit more control and

380
00:16:19,740 --> 00:16:21,899
additionally

381
00:16:21,899 --> 00:16:25,740
avoid a bit of Legacy from and then most

382
00:16:25,740 --> 00:16:27,600
recently this year uh there was an

383
00:16:27,600 --> 00:16:30,620
analog really attack uh published

384
00:16:30,620 --> 00:16:34,500
that was reeling the entire 2.4

385
00:16:34,500 --> 00:16:36,660
gigahertz Spectrum while handled by

386
00:16:36,660 --> 00:16:39,180
director of communication to transfer

387
00:16:39,180 --> 00:16:41,540
hours

388
00:16:42,240 --> 00:16:45,000
now all these ruler attacks have

389
00:16:45,000 --> 00:16:48,120
different benefits and drawbacks so

390
00:16:48,120 --> 00:16:52,139
we're relaying at the Gap layer

391
00:16:52,139 --> 00:16:54,779
working your way up to the stack and not

392
00:16:54,779 --> 00:16:56,759
having control over low-level radio

393
00:16:56,759 --> 00:16:58,100
operations

394
00:16:58,100 --> 00:17:00,720
you end up introducing a clearly

395
00:17:00,720 --> 00:17:03,180
detectable amounts of latency in

396
00:17:03,180 --> 00:17:05,520
responses to have

397
00:17:05,520 --> 00:17:07,980
us and additionally because you're using

398
00:17:07,980 --> 00:17:10,760
normal Bluetooth controller checks

399
00:17:10,760 --> 00:17:13,679
they do not know how to follow a

400
00:17:13,679 --> 00:17:15,900
connection where the encryption key

401
00:17:15,900 --> 00:17:18,679
belongs to be is unknown

402
00:17:18,679 --> 00:17:22,079
with the HCI relay you can avoid some of

403
00:17:22,079 --> 00:17:25,199
those systems control uh but

404
00:17:25,199 --> 00:17:28,220
nevertheless there still is

405
00:17:40,919 --> 00:17:43,980
now with analog relay you can get past

406
00:17:43,980 --> 00:17:46,260
these limitations so the added latency

407
00:17:46,260 --> 00:17:49,140
is only from the transport to your

408
00:17:49,140 --> 00:17:53,419
lights and the uh

409
00:17:53,419 --> 00:17:57,559
increases of horizontal issue because

410
00:18:00,900 --> 00:18:03,539
uh this will analog user you have some

411
00:18:03,539 --> 00:18:06,660
limits or how much it unifies so how far

412
00:18:06,660 --> 00:18:07,640
is

413
00:18:07,640 --> 00:18:10,860
2.4 gigs as well let's take a look at

414
00:18:10,860 --> 00:18:15,439
that very long distance Communications

415
00:18:15,900 --> 00:18:19,500
now it's possible to combine some of the

416
00:18:19,500 --> 00:18:21,720
benefits of the ECI relay and the analog

417
00:18:21,720 --> 00:18:23,760
relay by operating at a level of the

418
00:18:23,760 --> 00:18:27,419
stack in between these uh

419
00:18:27,419 --> 00:18:30,900
we can operate at the link layer of the

420
00:18:30,900 --> 00:18:32,100
stack

421
00:18:32,100 --> 00:18:33,539
it

422
00:18:33,539 --> 00:18:37,100
send the videos

423
00:18:39,000 --> 00:18:42,240
having benefits of digital relay

424
00:18:42,240 --> 00:18:45,360
so to understand what a link will really

425
00:18:45,360 --> 00:18:47,280
attack is I'll quickly giving over you

426
00:18:47,280 --> 00:18:49,880
of how DNA Communications

427
00:18:49,880 --> 00:18:52,320
so at the physical layer it just takes

428
00:18:52,320 --> 00:18:54,600
the two points per gigahertz and splits

429
00:18:54,600 --> 00:18:57,360
in the 40 channels which three are used

430
00:18:57,360 --> 00:18:59,280
for advertisements to indicate devices

431
00:18:59,280 --> 00:19:01,679
available to connect to and then the

432
00:19:01,679 --> 00:19:04,020
other 37 are used for sending data into

433
00:19:04,020 --> 00:19:06,320
connection

434
00:19:06,559 --> 00:19:09,179
modulation is a gaussian entry position

435
00:19:09,179 --> 00:19:12,960
here so gradual frequency modulation uh

436
00:19:12,960 --> 00:19:16,260
and others time division from multiple

437
00:19:16,260 --> 00:19:18,240
devices to purchase together as well as

438
00:19:18,240 --> 00:19:20,039
within the single connection for a

439
00:19:20,039 --> 00:19:22,380
bi-directional communication and there

440
00:19:22,380 --> 00:19:24,600
are a few different fly modes the

441
00:19:24,600 --> 00:19:27,660
original one negative mode so you were

442
00:19:27,660 --> 00:19:30,720
faster two megabit per second mode for

443
00:19:30,720 --> 00:19:33,120
the error correctly including five long

444
00:19:33,120 --> 00:19:35,820
distance communication

445
00:19:35,820 --> 00:19:40,740
uh within the interaction uh it starts

446
00:19:40,740 --> 00:19:43,440
off with an advertising packet it'll be

447
00:19:43,440 --> 00:19:46,860
sent by a peripheral device uh and then

448
00:19:46,860 --> 00:19:49,380
the central device will issue uh connect

449
00:19:49,380 --> 00:19:51,320
in request

450
00:19:51,320 --> 00:19:54,419
within the interframe separation time of

451
00:19:54,419 --> 00:19:57,600
the advertising packet assuming the

452
00:19:57,600 --> 00:19:59,760
peripheral device received that connects

453
00:19:59,760 --> 00:20:02,520
our bust then they will both get ready

454
00:20:02,520 --> 00:20:04,280
for a connection

455
00:20:04,280 --> 00:20:07,500
so the connect request will indicate

456
00:20:07,500 --> 00:20:09,720
when the first so-called connection

457
00:20:09,720 --> 00:20:11,820
event will occur and during the

458
00:20:11,820 --> 00:20:15,059
connection event the initiator takes the

459
00:20:15,059 --> 00:20:17,059
master role in the connection will send

460
00:20:17,059 --> 00:20:20,460
the first frame over there and then

461
00:20:20,460 --> 00:20:22,740
assuming the peripheral or slave device

462
00:20:22,740 --> 00:20:26,760
in the connection uh

463
00:20:28,640 --> 00:20:31,679
from there on the connection events were

464
00:20:31,679 --> 00:20:34,679
they're alterating PDS going between the

465
00:20:34,679 --> 00:20:37,260
Master Slave and the slave master of

466
00:20:37,260 --> 00:20:38,220
directions

467
00:20:38,220 --> 00:20:41,360
uh within dle there's also a

468
00:20:41,360 --> 00:20:43,320
re-transmitted an alternate mechanism

469
00:20:43,320 --> 00:20:45,918
where

470
00:20:50,660 --> 00:20:54,380
within the uh

471
00:20:59,280 --> 00:21:03,059
So within the uh connection events uh

472
00:21:03,059 --> 00:21:04,860
both sides will alter in between the

473
00:21:04,860 --> 00:21:07,260
same data to each other until both sides

474
00:21:07,260 --> 00:21:08,940
say they have no more data for transmit

475
00:21:08,940 --> 00:21:12,780
in this event or a timeout occurs or on

476
00:21:12,780 --> 00:21:14,820
some devices that Master can choose to

477
00:21:14,820 --> 00:21:16,320
end the connection event prematurely

478
00:21:16,320 --> 00:21:18,120
even when there is more data to transfer

479
00:21:18,120 --> 00:21:20,100
from the slave advice is just wants to

480
00:21:20,100 --> 00:21:21,799
do something else

481
00:21:21,799 --> 00:21:23,660
video time

482
00:21:23,660 --> 00:21:27,480
and once a connection events ends there

483
00:21:27,480 --> 00:21:29,580
will be no more communication until the

484
00:21:29,580 --> 00:21:32,460
next event occurs so uh there is a

485
00:21:32,460 --> 00:21:34,500
interval between the next event is

486
00:21:34,500 --> 00:21:38,460
called the connection interval uh and at

487
00:21:38,460 --> 00:21:40,080
every connection event there's a switch

488
00:21:40,080 --> 00:21:44,480
to a new frequency for communication

489
00:21:44,820 --> 00:21:46,200
so

490
00:21:46,200 --> 00:21:49,140
learn how the link there works we can

491
00:21:49,140 --> 00:21:52,559
build a window task here and what a link

492
00:21:52,559 --> 00:21:55,620
layer really does is it just takes link

493
00:21:55,620 --> 00:21:59,039
their pdus encrypted or not and forwards

494
00:21:59,039 --> 00:22:01,620
them off to the

495
00:22:01,620 --> 00:22:04,020
uh this cannot be done with

496
00:22:04,020 --> 00:22:07,260
off-the-shelf uh Bluetooth controller

497
00:22:07,260 --> 00:22:08,400
ships

498
00:22:08,400 --> 00:22:11,520
using the normal HCI because the HCI

499
00:22:11,520 --> 00:22:13,200
operates at a higher level of product

500
00:22:13,200 --> 00:22:15,780
that doesn't give you control over uh

501
00:22:15,780 --> 00:22:18,120
just sending raw and therapeutes but

502
00:22:18,120 --> 00:22:21,659
it's still a digital relay or the edu is

503
00:22:21,659 --> 00:22:23,820
transmitting a very small thing that you

504
00:22:23,820 --> 00:22:25,860
can send over the understanding Network

505
00:22:25,860 --> 00:22:28,860
and

506
00:22:29,039 --> 00:22:31,220
in addition to be able to move forward

507
00:22:31,220 --> 00:22:34,080
uh encrypted PDS you also get more

508
00:22:34,080 --> 00:22:36,539
control over the timing of low-level

509
00:22:36,539 --> 00:22:38,880
radio operations is you can construct

510
00:22:38,880 --> 00:22:41,580
your own connect requests and you can

511
00:22:41,580 --> 00:22:45,480
also inject pdus for requested changes

512
00:22:45,480 --> 00:22:48,720
to action timing so

513
00:22:48,720 --> 00:22:52,580
this way uh you could

514
00:22:53,340 --> 00:22:55,679
pick the timing of connection events to

515
00:22:55,679 --> 00:22:57,659
be more suitable for you to mimic the

516
00:22:57,659 --> 00:23:01,280
legacy of an unrelated connection

517
00:23:01,280 --> 00:23:03,419
additionally because you're bypassing

518
00:23:03,419 --> 00:23:06,140
Bluetooth status

519
00:23:06,860 --> 00:23:10,799
typically Photoshop you can also get a

520
00:23:10,799 --> 00:23:13,559
bit less lazy through that

521
00:23:13,559 --> 00:23:16,799
so the basic flow for linking to really

522
00:23:16,799 --> 00:23:19,020
attack is well all that different from

523
00:23:19,020 --> 00:23:21,980
traditional twin connection relates so

524
00:23:21,980 --> 00:23:24,960
it starts off with so the legitimate

525
00:23:24,960 --> 00:23:27,600
slave device is the peripheral that is

526
00:23:27,600 --> 00:23:29,700
advertising it will send out

527
00:23:29,700 --> 00:23:32,460
advertisements and normally once the

528
00:23:32,460 --> 00:23:34,260
central device the legitimate Master

529
00:23:34,260 --> 00:23:36,600
seizes advertisements to connect to us

530
00:23:36,600 --> 00:23:39,900
but uh with a really attack scenario we

531
00:23:39,900 --> 00:23:42,059
have a relaying device that acts like a

532
00:23:42,059 --> 00:23:43,919
connection master that receives those

533
00:23:43,919 --> 00:23:46,140
advertisements and passed them on to the

534
00:23:46,140 --> 00:23:47,940
relaying slave that will mimic the

535
00:23:47,940 --> 00:23:49,260
Genesis

536
00:23:49,260 --> 00:23:53,100
the relay slave will then

537
00:23:53,100 --> 00:23:55,620
broadcast the same advertisements legit

538
00:23:55,620 --> 00:24:00,179
Master will connect to it and once the

539
00:24:00,179 --> 00:24:02,460
relay slave is connected to notify the

540
00:24:02,460 --> 00:24:04,679
Miller Master that will connect to the

541
00:24:04,679 --> 00:24:06,780
legitimate slave unless we have two

542
00:24:06,780 --> 00:24:09,360
connections established the independent

543
00:24:09,360 --> 00:24:10,580
timing

544
00:24:10,580 --> 00:24:14,520
then the link therapy used USB forward

545
00:24:14,520 --> 00:24:16,919
and between the two sides and if either

546
00:24:16,919 --> 00:24:18,659
side has nothing to transmit it was

547
00:24:18,659 --> 00:24:21,240
waiting for data they can just transmit

548
00:24:21,240 --> 00:24:22,720
empty edus

549
00:24:22,720 --> 00:24:25,759
[Music]

550
00:24:26,520 --> 00:24:30,360
uh for the latency of communications uh

551
00:24:30,360 --> 00:24:33,120
we can control that or limit it uh

552
00:24:33,120 --> 00:24:35,840
through control of uh the connection

553
00:24:35,840 --> 00:24:39,780
interval of detention events and also

554
00:24:39,780 --> 00:24:42,299
controlling when these events occur

555
00:24:42,299 --> 00:24:44,159
through an offset to the offensive

556
00:24:44,159 --> 00:24:45,419
window

557
00:24:45,419 --> 00:24:47,580
so since we're revealing the link where

558
00:24:47,580 --> 00:24:49,799
we can fully control these on the master

559
00:24:49,799 --> 00:24:51,360
side since we're sending the connect

560
00:24:51,360 --> 00:24:56,220
requests and on the slave role or we

561
00:24:56,220 --> 00:24:58,260
don't have direct control over it we can

562
00:24:58,260 --> 00:25:00,360
still inject eu's to request a

563
00:25:00,360 --> 00:25:01,679
particular connection and timing

564
00:25:01,679 --> 00:25:02,880
parameters

565
00:25:02,880 --> 00:25:06,240
by default on iOS you'll have a 30

566
00:25:06,240 --> 00:25:08,820
millisecond connection interval for most

567
00:25:08,820 --> 00:25:11,880
connections and an Android devices will

568
00:25:11,880 --> 00:25:14,280
be 48 and three quarters of

569
00:25:14,280 --> 00:25:17,179
a second uh

570
00:25:17,179 --> 00:25:19,980
so uh

571
00:25:19,980 --> 00:25:23,640
within both Android and iOS these

572
00:25:23,640 --> 00:25:25,260
connection intervals are not directly

573
00:25:25,260 --> 00:25:27,960
exposed to the users and any

574
00:25:27,960 --> 00:25:30,539
manipulation of these walls is also

575
00:25:30,539 --> 00:25:34,260
knobs visible at the app layer apis on

576
00:25:34,260 --> 00:25:37,020
iOS so uh

577
00:25:37,020 --> 00:25:39,900
any of the apps that provide your phone

578
00:25:39,900 --> 00:25:42,179
doesn't heat control will not be able to

579
00:25:42,179 --> 00:25:44,520
tell them there's any manipulation of

580
00:25:44,520 --> 00:25:46,400
these uh

581
00:25:46,400 --> 00:25:50,580
levels so one of the uh similar ways you

582
00:25:50,580 --> 00:25:52,440
can achieve

583
00:25:52,440 --> 00:25:53,820
um

584
00:25:53,820 --> 00:25:58,260
uh no added latency in overall operation

585
00:25:58,260 --> 00:26:01,140
is uh switching to a quicker connection

586
00:26:01,140 --> 00:26:03,000
interval on one side of the

587
00:26:03,000 --> 00:26:07,140
communication so uh for example

588
00:26:07,140 --> 00:26:08,460
uh

589
00:26:08,460 --> 00:26:11,100
we could keep the original communication

590
00:26:11,100 --> 00:26:14,179
between uh

591
00:26:14,179 --> 00:26:16,400
the let's let's

592
00:26:16,400 --> 00:26:20,760
card legit slave is a phone

593
00:26:20,760 --> 00:26:22,740
uh with a really the relay Master can

594
00:26:22,740 --> 00:26:24,840
pick a quick connection interval for

595
00:26:24,840 --> 00:26:27,600
communications between the Google and

596
00:26:27,600 --> 00:26:29,640
master and the phone and the phone would

597
00:26:29,640 --> 00:26:31,620
not know that a great connection to it

598
00:26:31,620 --> 00:26:35,039
was chosen uh however opal

599
00:26:35,039 --> 00:26:38,039
is

600
00:26:38,100 --> 00:26:39,840
culture

601
00:26:39,840 --> 00:26:41,039
um

602
00:26:41,039 --> 00:26:43,260
and what you could do is that even

603
00:26:43,260 --> 00:26:45,299
though there is some latency in the

604
00:26:45,299 --> 00:26:47,640
digital transport you use from between

605
00:26:47,640 --> 00:26:50,220
the two sides really

606
00:26:50,220 --> 00:26:51,720
uh it can be kept within a few

607
00:26:51,720 --> 00:26:54,299
milliseconds and

608
00:26:54,299 --> 00:26:56,100
uh

609
00:26:56,100 --> 00:26:58,620
in normal unrelated operation it will

610
00:26:58,620 --> 00:27:01,020
take at least one piece of them to get a

611
00:27:01,020 --> 00:27:05,960
response to any uh that's involved

612
00:27:05,960 --> 00:27:07,640
statues

613
00:27:07,640 --> 00:27:11,640
and this is not even guaranteed to be a

614
00:27:11,640 --> 00:27:13,440
normal operation to produce under your

615
00:27:13,440 --> 00:27:15,659
bills from timing sometimes you can take

616
00:27:15,659 --> 00:27:17,820
multiple connection events you get a

617
00:27:17,820 --> 00:27:20,279
response to see a gap request

618
00:27:20,279 --> 00:27:21,960
uh but

619
00:27:21,960 --> 00:27:24,419
because we can have a quick connection

620
00:27:24,419 --> 00:27:26,760
to hold one side even though there is

621
00:27:26,760 --> 00:27:28,980
latency in both the transport between

622
00:27:28,980 --> 00:27:31,140
the sides and we can get a response

623
00:27:31,140 --> 00:27:33,720
turnaround within the same timing that

624
00:27:33,720 --> 00:27:36,240
normal unrelated operation would have so

625
00:27:36,240 --> 00:27:39,240
from the perspective of both of both

626
00:27:39,240 --> 00:27:42,140
sides the

627
00:27:42,140 --> 00:27:45,120
time it takes to get a response is no

628
00:27:45,120 --> 00:27:47,760
different from really the operation now

629
00:27:47,760 --> 00:27:49,980
this is important to note because there

630
00:27:49,980 --> 00:27:53,539
have been many devices

631
00:27:53,539 --> 00:27:57,480
fire gap basically attacks by measuring

632
00:27:57,480 --> 00:28:00,059
the latency of Gap responses and because

633
00:28:00,059 --> 00:28:02,039
the acquire relay attacks tended to

634
00:28:02,039 --> 00:28:05,880
introduce one or more usually two or

635
00:28:05,880 --> 00:28:09,080
three connection events of latency

636
00:28:09,080 --> 00:28:11,640
it would reject response to that

637
00:28:11,640 --> 00:28:14,340
accessibility but just by doing tricks

638
00:28:14,340 --> 00:28:17,000
like this you can get lessons down to

639
00:28:17,000 --> 00:28:20,279
normal unreally levels

640
00:28:20,279 --> 00:28:22,980
uh now even if you were not able to

641
00:28:22,980 --> 00:28:26,220
control the connection interval there

642
00:28:26,220 --> 00:28:27,539
are other things you could do as well

643
00:28:27,539 --> 00:28:30,179
for instance you could stagger uh when

644
00:28:30,179 --> 00:28:31,740
the connection events happened between

645
00:28:31,740 --> 00:28:34,440
two sides such that even when you

646
00:28:34,440 --> 00:28:36,900
account for the transplant latency the

647
00:28:36,900 --> 00:28:38,880
time it takes for a response to come

648
00:28:38,880 --> 00:28:40,860
back is delayed by only a single

649
00:28:40,860 --> 00:28:43,260
connection lens and because there's an

650
00:28:43,260 --> 00:28:45,360
earned variability in the operating

651
00:28:45,360 --> 00:28:46,559
system

652
00:28:46,559 --> 00:28:48,299
of the

653
00:28:48,299 --> 00:28:50,640
host uh

654
00:28:50,640 --> 00:28:53,880
this additional event to connect of

655
00:28:53,880 --> 00:28:57,299
latency is still within the range of

656
00:28:57,299 --> 00:29:00,539
normal timing variation so uh it'll be

657
00:29:00,539 --> 00:29:02,400
accepted by most devices if you're

658
00:29:02,400 --> 00:29:03,840
overly stripped and they'll get a lot of

659
00:29:03,840 --> 00:29:06,000
false positives and Global operations as

660
00:29:06,000 --> 00:29:08,179
well

661
00:29:09,059 --> 00:29:11,460
now when you have link layer encryption

662
00:29:11,460 --> 00:29:13,679
that adds another little bit of

663
00:29:13,679 --> 00:29:17,400
complexity to such attacks So within new

664
00:29:17,400 --> 00:29:21,140
control energy there is a AES encryption

665
00:29:21,140 --> 00:29:26,460
mode with CBC Mac uh the encryption is

666
00:29:26,460 --> 00:29:29,100
pretty solid and there's also Perfection

667
00:29:29,100 --> 00:29:31,500
against replay attacks you use the

668
00:29:31,500 --> 00:29:33,419
things that you need session keys and

669
00:29:33,419 --> 00:29:36,059
the back counters and additionally

670
00:29:36,059 --> 00:29:37,740
Perfection begins to be ordering the

671
00:29:37,740 --> 00:29:40,080
packets the injection Edition packets

672
00:29:40,080 --> 00:29:42,080
all through the use of these counters

673
00:29:42,080 --> 00:29:44,399
and one thing that's important to note

674
00:29:44,399 --> 00:29:48,600
is that both data and control pdus are

675
00:29:48,600 --> 00:29:50,820
encrypted so data pdos are the data

676
00:29:50,820 --> 00:29:52,980
that's being sent back and forth and

677
00:29:52,980 --> 00:29:55,500
control PD was a control operation of

678
00:29:55,500 --> 00:29:58,260
the loop layer like which channels

679
00:29:58,260 --> 00:30:00,260
should be used for transmission

680
00:30:00,260 --> 00:30:03,419
when should we transmit how

681
00:30:03,419 --> 00:30:06,000
afraid of Machine Tools these are all

682
00:30:06,000 --> 00:30:07,679
things that can be changed during the

683
00:30:07,679 --> 00:30:10,440
election is part of adaptive

684
00:30:10,440 --> 00:30:13,039
so you need to be able to

685
00:30:13,039 --> 00:30:16,620
understand these control videos to keep

686
00:30:16,620 --> 00:30:19,279
all the connection

687
00:30:19,399 --> 00:30:21,360
so

688
00:30:21,360 --> 00:30:23,760
this encryption is pretty solid overall

689
00:30:23,760 --> 00:30:25,380
even though they're happy weaknesses and

690
00:30:25,380 --> 00:30:29,039
key establishments but if you say that

691
00:30:29,039 --> 00:30:33,240
the ltk used for the uh Communications

692
00:30:33,240 --> 00:30:35,880
is something that's to securely

693
00:30:35,880 --> 00:30:37,500
exchanged or something unloaded to the

694
00:30:37,500 --> 00:30:40,679
attacker then you can effectively break

695
00:30:40,679 --> 00:30:44,700
this equation really matters so

696
00:30:44,700 --> 00:30:49,279
we have to find a way to work with

697
00:30:49,279 --> 00:30:52,080
a few things to note that are useful

698
00:30:52,080 --> 00:30:56,039
when willing is that the empty pdus they

699
00:30:56,039 --> 00:30:57,840
are not encrypted and they don't

700
00:30:57,840 --> 00:31:00,059
influence the packet Founders either so

701
00:31:00,059 --> 00:31:02,940
you could inject as many empty pdus as

702
00:31:02,940 --> 00:31:04,500
you want at a lot

703
00:31:04,500 --> 00:31:07,919
caused years it's also useful to note

704
00:31:07,919 --> 00:31:11,520
that within the packet header there is

705
00:31:11,520 --> 00:31:13,620
information about the sequence numbers

706
00:31:13,620 --> 00:31:16,980
for the defensive that's not encrypted

707
00:31:16,980 --> 00:31:19,799
authenticated and additionally within

708
00:31:19,799 --> 00:31:21,600
the packet header in the portion that's

709
00:31:21,600 --> 00:31:23,520
not encrypted there is a field

710
00:31:23,520 --> 00:31:28,140
indicating the high level type of edu so

711
00:31:28,140 --> 00:31:31,380
there's data pus and control ease this

712
00:31:31,380 --> 00:31:32,580
fuel in the header will let you

713
00:31:32,580 --> 00:31:35,658
distinguish between those

714
00:31:36,120 --> 00:31:38,279
so

715
00:31:38,279 --> 00:31:42,320
when you're trying to relay a connection

716
00:31:42,779 --> 00:31:45,779
um the biggest problem is that when you

717
00:31:45,779 --> 00:31:47,880
have link layer control pdus that are

718
00:31:47,880 --> 00:31:50,340
changing when connection events occur or

719
00:31:50,340 --> 00:31:53,220
which channels are in use or which fly

720
00:31:53,220 --> 00:31:54,659
mode is in use

721
00:31:54,659 --> 00:31:58,200
if you can't decrypt these control eu's

722
00:31:58,200 --> 00:32:00,299
and you don't know when the device will

723
00:32:00,299 --> 00:32:01,919
be transmitting which channel they're

724
00:32:01,919 --> 00:32:04,559
operating on and which fly mode is used

725
00:32:04,559 --> 00:32:07,440
so while with an analog relay you could

726
00:32:07,440 --> 00:32:08,220
just

727
00:32:08,220 --> 00:32:11,220
share the entire 2.4 gigahertz band this

728
00:32:11,220 --> 00:32:12,179
is not

729
00:32:12,179 --> 00:32:14,220
a feasible with visual wheelies that are

730
00:32:14,220 --> 00:32:16,640
only operating on one percent at a time

731
00:32:16,640 --> 00:32:19,980
so this is why past relays that are

732
00:32:19,980 --> 00:32:22,740
using normal ECI based control chips

733
00:32:22,740 --> 00:32:25,200
have been unable for Relay connections

734
00:32:25,200 --> 00:32:30,260
with their encryption to use the keys

735
00:32:30,600 --> 00:32:32,700
additionally when you have linked their

736
00:32:32,700 --> 00:32:34,860
encryption in place one subscriptions

737
00:32:34,860 --> 00:32:37,980
and progress you cannot inject or drop

738
00:32:37,980 --> 00:32:40,679
any PDS you need to be able to send

739
00:32:40,679 --> 00:32:44,100
everything across and

740
00:32:44,100 --> 00:32:46,260
if you set up unequal connection

741
00:32:46,260 --> 00:32:48,120
intervals between the two sides of

742
00:32:48,120 --> 00:32:50,360
connection

743
00:33:05,700 --> 00:33:07,260
thanks

744
00:33:07,260 --> 00:33:11,419
so when you have any uh

745
00:33:11,539 --> 00:33:15,620
control PD sentence

746
00:33:18,980 --> 00:33:21,320
this is

747
00:33:21,320 --> 00:33:24,240
a counter or connection effect so if the

748
00:33:24,240 --> 00:33:26,399
number of connections since connection

749
00:33:26,399 --> 00:33:29,760
start is different on the two sides this

750
00:33:29,760 --> 00:33:31,980
will cause a connection to be lost as a

751
00:33:31,980 --> 00:33:36,059
side of the other instance time uh the

752
00:33:36,059 --> 00:33:38,880
instant events number for the new

753
00:33:38,880 --> 00:33:42,659
parameters on the bridge so because of

754
00:33:42,659 --> 00:33:44,820
this if you're dealing with the

755
00:33:44,820 --> 00:33:46,679
connection

756
00:33:46,679 --> 00:33:47,050
um

757
00:33:47,050 --> 00:33:50,139
[Music]

758
00:33:52,980 --> 00:33:56,279
so there are ways to feel inside

759
00:33:56,279 --> 00:33:57,720
so

760
00:33:57,720 --> 00:34:00,320
with the empty videos

761
00:34:00,320 --> 00:34:03,539
we can just send those whenever we said

762
00:34:03,539 --> 00:34:05,039
something I will not mess up the

763
00:34:05,039 --> 00:34:07,559
question and for viewing the perfect

764
00:34:07,559 --> 00:34:10,440
connection parameters uh what we can do

765
00:34:10,440 --> 00:34:14,418
is analyze the traffic

766
00:34:14,418 --> 00:34:17,879
so we do know when you use this whole

767
00:34:17,879 --> 00:34:20,960
pde in just in case

768
00:34:25,739 --> 00:34:28,199
uh but we'll talk about how we can do

769
00:34:28,199 --> 00:34:30,439
that

770
00:34:30,480 --> 00:34:33,839
additionally uh elections always start

771
00:34:33,839 --> 00:34:36,719
off unexpected and

772
00:34:36,719 --> 00:34:38,760
there's always a little window in which

773
00:34:38,760 --> 00:34:44,580
you can interact communities before uh

774
00:34:44,580 --> 00:34:46,918
and this is also interesting because

775
00:34:46,918 --> 00:34:50,099
within the design of the elite there is

776
00:34:50,099 --> 00:34:52,020
no mechanism to

777
00:34:52,020 --> 00:34:55,199
later verified once it puts it started

778
00:34:55,199 --> 00:34:58,158
immediately

779
00:34:58,320 --> 00:35:00,240
all right

780
00:35:00,240 --> 00:35:02,520
so whatever you do before I'm cooking

781
00:35:02,520 --> 00:35:07,140
startup uh early on in the connection

782
00:35:07,140 --> 00:35:10,140
s

783
00:35:11,520 --> 00:35:14,040
so what we could do is the eject videos

784
00:35:14,040 --> 00:35:16,200
and start the connection so that we can

785
00:35:16,200 --> 00:35:19,020
switch both sides of the connection to

786
00:35:19,020 --> 00:35:20,640
the correct connections

787
00:35:20,640 --> 00:35:24,180
and in that case the distance

788
00:35:24,180 --> 00:35:29,060
we didn't have lower latency again

789
00:35:30,720 --> 00:35:33,680
foreign

790
00:35:52,010 --> 00:35:55,189
[Music]

791
00:36:01,619 --> 00:36:04,380
it turns out that all these these whole

792
00:36:04,380 --> 00:36:07,280
pdus that specify

793
00:36:07,280 --> 00:36:12,780
uh changes letters all of them

794
00:36:12,780 --> 00:36:15,300
are uniquely identical based on the

795
00:36:15,300 --> 00:36:19,099
length so just to see that one header

796
00:36:19,099 --> 00:36:22,099
Fields

797
00:36:22,820 --> 00:36:26,280
modify what time you can use

798
00:36:26,280 --> 00:36:28,560
also there's decent prior research done

799
00:36:28,560 --> 00:36:31,380
by a friend of mine we found that

800
00:36:31,380 --> 00:36:34,980
almost always new connection parameters

801
00:36:34,980 --> 00:36:39,560
take effect six or seven factors

802
00:36:55,400 --> 00:36:59,839
nevertheless the same real devices

803
00:37:00,500 --> 00:37:05,359
pretty soon after the uh

804
00:37:23,160 --> 00:37:26,280
and uh you don't even need to get more

805
00:37:26,280 --> 00:37:28,200
of that students exactly either because

806
00:37:28,200 --> 00:37:32,180
uh there is support for you

807
00:37:35,760 --> 00:37:39,440
see this later we can just

808
00:37:39,540 --> 00:37:41,779
uh

809
00:37:45,900 --> 00:37:48,420
when there is a change to excel Maps

810
00:37:48,420 --> 00:37:52,140
specifying which channel studies what we

811
00:37:52,140 --> 00:37:53,960
could do is just

812
00:37:53,960 --> 00:37:57,300
initially seen all the Terrace hop

813
00:37:57,300 --> 00:37:59,820
through all the trails normal top secret

814
00:37:59,820 --> 00:38:03,000
is suiting all this automatic and use uh

815
00:38:03,000 --> 00:38:05,480
and if any of the channels

816
00:38:05,480 --> 00:38:08,099
that kind of business so again because

817
00:38:08,099 --> 00:38:11,119
we have this

818
00:38:11,119 --> 00:38:14,119
infections

819
00:38:14,960 --> 00:38:17,880
connection between that data and then

820
00:38:17,880 --> 00:38:20,900
that's correct shot

821
00:38:24,420 --> 00:38:27,359
the slave role since it's waiting for

822
00:38:27,359 --> 00:38:28,940
Acadiana

823
00:38:28,940 --> 00:38:32,540
you can just listen

824
00:38:32,900 --> 00:38:35,060
ing

825
00:38:35,060 --> 00:38:37,640
right away

826
00:38:37,640 --> 00:38:41,280
that connection since it has to figure

827
00:38:41,280 --> 00:38:43,800
out the correct time to transmitter is a

828
00:38:43,800 --> 00:38:45,500
response

829
00:38:45,500 --> 00:38:48,480
is so tricky but I discovered that

830
00:38:48,480 --> 00:38:51,480
through devices you can send empty

831
00:38:51,480 --> 00:38:54,839
pedu's Within

832
00:38:54,839 --> 00:38:59,160
about all the possible attention so the

833
00:38:59,160 --> 00:39:02,160
transfer time videos are at one of the

834
00:39:02,160 --> 00:39:04,500
one in one third

835
00:39:04,500 --> 00:39:07,320
um milliseconds so and

836
00:39:07,320 --> 00:39:09,119
it will destroy the message this sent

837
00:39:09,119 --> 00:39:11,339
MVP news at all the possible time

838
00:39:11,339 --> 00:39:13,500
offsets till you find the time off so we

839
00:39:13,500 --> 00:39:17,160
have some response from the other side

840
00:39:17,160 --> 00:39:21,000
so now using all these techniques I did

841
00:39:21,000 --> 00:39:25,700
implements uh music

842
00:39:28,040 --> 00:39:32,660
I just extended this um

843
00:39:38,180 --> 00:39:42,420
Unfortunately today I'm amazing

844
00:39:42,420 --> 00:39:44,720
world

845
00:39:45,720 --> 00:39:47,720
s

846
00:39:51,619 --> 00:39:54,420
but nonetheless I'll show you quickly

847
00:39:54,420 --> 00:39:57,420
what

848
00:39:57,780 --> 00:40:01,760
so here's one uh

849
00:40:06,180 --> 00:40:08,220
so what's happening here right now in

850
00:40:08,220 --> 00:40:13,740
this heart is that I specified the MAC

851
00:40:13,740 --> 00:40:18,020
address of the master in this case

852
00:40:24,300 --> 00:40:28,339
so what it's doing here

853
00:40:28,339 --> 00:40:32,180
the MAC address

854
00:40:32,280 --> 00:40:35,339
this scripture first captures the

855
00:40:35,339 --> 00:40:40,578
advertisements on the phone and what is

856
00:40:44,940 --> 00:40:47,760
uh the phone here was uh

857
00:40:47,760 --> 00:40:52,579
uh very far away from uh

858
00:40:52,579 --> 00:40:56,640
this is communicating

859
00:40:59,579 --> 00:41:02,240
now on the other side of the relator

860
00:41:02,240 --> 00:41:06,540
this device is now advertising mimicking

861
00:41:06,540 --> 00:41:09,359
the phone so the block will connect to

862
00:41:09,359 --> 00:41:10,820
the

863
00:41:10,820 --> 00:41:15,000
sleeve side of the wheelie and here what

864
00:41:15,000 --> 00:41:17,339
I tapped a lot

865
00:41:17,339 --> 00:41:20,160
what happened was that it established a

866
00:41:20,160 --> 00:41:22,140
connection uh junior release like

867
00:41:22,140 --> 00:41:24,540
Communications recorded in the two sides

868
00:41:24,540 --> 00:41:31,579
I was able to say myself a lot and uh

869
00:41:43,940 --> 00:41:49,800
was against uh Tesla Model y

870
00:41:49,800 --> 00:41:52,880
so you're

871
00:41:54,740 --> 00:41:57,240
what's happening is that right now we

872
00:41:57,240 --> 00:42:01,260
have our locks so if I try unlocking it

873
00:42:01,260 --> 00:42:03,720
uh it doesn't mean the phone that's

874
00:42:03,720 --> 00:42:06,920
authorized talking about very far away

875
00:42:06,920 --> 00:42:10,140
uh but now I have a relay set up within

876
00:42:10,140 --> 00:42:12,599
the office that's near the phone and the

877
00:42:12,599 --> 00:42:13,980
other side that we like here is hooked

878
00:42:13,980 --> 00:42:17,280
up to my laptop so if I relay the

879
00:42:17,280 --> 00:42:20,300
communication activities

880
00:42:20,359 --> 00:42:24,060
which parts overly students possible to

881
00:42:24,060 --> 00:42:26,700
make Gap is to really work in short

882
00:42:26,700 --> 00:42:29,640
ranges most likely this I have a huge

883
00:42:29,640 --> 00:42:32,118
amount of time

884
00:42:34,440 --> 00:42:35,839
uh

885
00:42:35,839 --> 00:42:38,760
in addition to unlock them are you see

886
00:42:38,760 --> 00:42:41,760
students

887
00:42:48,240 --> 00:42:51,319
[Music]

888
00:42:53,540 --> 00:42:55,980
right before a wrap-up I'll quickly tell

889
00:42:55,980 --> 00:42:58,200
you a bit about mitigations

890
00:42:58,200 --> 00:42:58,859
um

891
00:42:58,859 --> 00:43:01,380
the most obvious is required user

892
00:43:01,380 --> 00:43:04,160
interaction to unlock

893
00:43:06,920 --> 00:43:10,079
interactive device for instance if you

894
00:43:10,079 --> 00:43:11,940
had a key fob you have to require

895
00:43:11,940 --> 00:43:13,370
getting a buttons

896
00:43:13,370 --> 00:43:16,429
[Music]

897
00:43:17,940 --> 00:43:21,720
interaction there also are excuse for

898
00:43:21,720 --> 00:43:23,819
something called secure ranging of the

899
00:43:23,819 --> 00:43:25,280
component type of blood pressure

900
00:43:25,280 --> 00:43:27,480
demographics all results

901
00:43:27,480 --> 00:43:30,300
uh there are many different standards

902
00:43:30,300 --> 00:43:33,000
that can be used to do it all right now

903
00:43:33,000 --> 00:43:34,740
one of the most popular is the most

904
00:43:34,740 --> 00:43:37,400
White Band uh

905
00:43:37,400 --> 00:43:41,640
the uh hybrid pulse Solutions of it

906
00:43:41,640 --> 00:43:46,640
there are certain classes and because

907
00:43:47,900 --> 00:43:52,940
these types of more recent media tasks

908
00:43:55,140 --> 00:43:57,839
there's limited ranges that you can

909
00:43:57,839 --> 00:44:00,980
extend these types

910
00:44:01,500 --> 00:44:03,599
it's also possible sometimes the

911
00:44:03,599 --> 00:44:04,800
strategy

912
00:44:04,800 --> 00:44:06,800
is

913
00:44:08,240 --> 00:44:11,839
liable because

914
00:44:23,220 --> 00:44:27,480
and finally if you have a farmer from

915
00:44:27,480 --> 00:44:31,619
the Houston Rockets if you use it around

916
00:44:31,619 --> 00:44:33,480
these organization

917
00:44:33,480 --> 00:44:35,700
behind that it's just

918
00:44:35,700 --> 00:44:39,598
disabled personalities

919
00:44:42,300 --> 00:44:44,640
so putting it all together really really

920
00:44:44,640 --> 00:44:47,640
attacks the quite practical in many ways

921
00:44:47,640 --> 00:44:50,220
you could do it but

922
00:44:50,220 --> 00:44:53,220
Communications

923
00:45:00,000 --> 00:45:02,540
foreign

