1
00:00:02,689 --> 00:00:09,809
good morning everyone<font color="#E5E5E5"> I was not aware</font>

2
00:00:05,790 --> 00:00:13,860
that it was<font color="#CCCCCC"> Hobbit day I would have</font>

3
00:00:09,809 --> 00:00:15,509
dressed accordingly actually I hiked the

4
00:00:13,860 --> 00:00:17,850
Appalachian Trail<font color="#E5E5E5"> which is a trail goes</font>

5
00:00:15,509 --> 00:00:20,340
from Georgia to<font color="#CCCCCC"> Maine United States 12</font>

6
00:00:17,850 --> 00:00:22,230
years<font color="#CCCCCC"> ago and my trail name which is a</font>

7
00:00:20,340 --> 00:00:24,960
lot like hackers and handles well hikers

8
00:00:22,230 --> 00:00:26,369
have trade names my trail name was Bilbo

9
00:00:24,960 --> 00:00:30,330
which was actually<font color="#E5E5E5"> kind of appropriate</font>

10
00:00:26,369 --> 00:00:32,759
<font color="#CCCCCC">because</font><font color="#E5E5E5"> I'm sure I eat a lot and when</font>

11
00:00:30,330 --> 00:00:34,320
you're hiking<font color="#E5E5E5"> even more also the</font>

12
00:00:32,759 --> 00:00:36,600
appalachian trail ends at Mount Katahdin

13
00:00:34,320 --> 00:00:38,850
which is a you know big mountain in the

14
00:00:36,600 --> 00:00:40,469
middle of a<font color="#E5E5E5"> really flat area and i</font>

15
00:00:38,850 --> 00:00:42,930
believe the native american name

16
00:00:40,469 --> 00:00:44,460
actually means Lonely Mountain so I took

17
00:00:42,930 --> 00:00:46,050
a long journey and<font color="#E5E5E5"> I traveled to the</font>

18
00:00:44,460 --> 00:00:47,730
Lonely Mountain and actually carried a

19
00:00:46,050 --> 00:00:51,919
<font color="#E5E5E5">little ring with me too and my name was</font>

20
00:00:47,730 --> 00:00:54,269
Bilbo but anyway there's lots<font color="#E5E5E5"> of lots of</font>

21
00:00:51,920 --> 00:00:57,329
similarities between hiking long

22
00:00:54,270 --> 00:00:59,129
distances and hacking one that always

23
00:00:57,329 --> 00:01:01,890
stands out to me it pops in my mind is 0

24
00:00:59,129 --> 00:01:03,989
days and<font color="#E5E5E5"> 0 days are very different for</font>

25
00:01:01,890 --> 00:01:07,380
hikers those are days you d0 trail miles

26
00:01:03,989 --> 00:01:09,570
so they're<font color="#E5E5E5"> really fun too you just sit</font>

27
00:01:07,380 --> 00:01:10,589
in town and drink all day but<font color="#E5E5E5"> that's not</font>

28
00:01:09,570 --> 00:01:12,539
what I'm here to talk to you about today

29
00:01:10,590 --> 00:01:15,750
today I'm talking to<font color="#E5E5E5"> you about hardware</font>

30
00:01:12,540 --> 00:01:17,159
implants for fun and<font color="#E5E5E5"> root chills this is</font>

31
00:01:15,750 --> 00:01:20,549
right in line with a lot<font color="#CCCCCC"> of what circus</font>

32
00:01:17,159 --> 00:01:22,200
was mentioning basically we have<font color="#E5E5E5"> this</font>

33
00:01:20,549 --> 00:01:24,750
world where we trust our<font color="#E5E5E5"> hardware we</font>

34
00:01:22,200 --> 00:01:26,159
trust our abstraction layers and this is

35
00:01:24,750 --> 00:01:28,290
probably<font color="#E5E5E5"> gone a little bit too far</font>

36
00:01:26,159 --> 00:01:31,380
because the capability is of hardware

37
00:01:28,290 --> 00:01:34,170
particularly the capabilities of someone

38
00:01:31,380 --> 00:01:36,600
with a couple bucks to spare in hardware

39
00:01:34,170 --> 00:01:38,189
is pretty compelling<font color="#E5E5E5"> when you look at</font>

40
00:01:36,600 --> 00:01:45,919
what<font color="#E5E5E5"> you can do with</font><font color="#CCCCCC"> some of these</font>

41
00:01:38,189 --> 00:01:48,809
Hardware implants there we go Who am I

42
00:01:45,920 --> 00:01:50,159
my name is Joe Fitzpatrick my background

43
00:01:48,810 --> 00:01:51,869
<font color="#E5E5E5">is electrical engineering with quite a</font>

44
00:01:50,159 --> 00:01:54,630
bit of computer science and input sec

45
00:01:51,869 --> 00:01:56,219
twisted in there<font color="#CCCCCC"> I've been playing with</font>

46
00:01:54,630 --> 00:01:59,158
hardware for actually more like 15 years

47
00:01:56,219 --> 00:02:01,740
<font color="#CCCCCC">now five years of which was hardware</font>

48
00:01:59,159 --> 00:02:03,450
training I just taught a class the past

49
00:02:01,740 --> 00:02:06,658
couple days applied physical attacks on

50
00:02:03,450 --> 00:02:09,989
x86 systems another class similar that

51
00:02:06,659 --> 00:02:11,610
focuses on embedded systems before<font color="#CCCCCC"> that</font>

52
00:02:09,989 --> 00:02:13,590
I was doing hardware

53
00:02:11,610 --> 00:02:15,960
and pre and post silicon<font color="#CCCCCC"> pen testing of</font>

54
00:02:13,590 --> 00:02:18,360
desktop and server CPUs for a tiny chip

55
00:02:15,960 --> 00:02:20,220
company as well as internal training for

56
00:02:18,360 --> 00:02:23,340
functional validators to include

57
00:02:20,220 --> 00:02:27,870
<font color="#E5E5E5">security in their assessment of</font>

58
00:02:23,340 --> 00:02:29,490
importance of certain bugs can<font color="#CCCCCC"> we adjust</font>

59
00:02:27,870 --> 00:02:32,220
the screen a little<font color="#CCCCCC"> because stuffs</font>

60
00:02:29,490 --> 00:02:34,800
falling off I wonder if I can<font color="#E5E5E5"> do</font><font color="#CCCCCC"> that</font>

61
00:02:32,220 --> 00:02:35,940
let me think about it so as a little bit

62
00:02:34,800 --> 00:02:37,560
of background you know<font color="#CCCCCC"> I</font><font color="#E5E5E5"> like to</font>

63
00:02:35,940 --> 00:02:39,900
incorporate other thoughts and ideas

64
00:02:37,560 --> 00:02:42,120
into my talks<font color="#CCCCCC"> tau is like the Chinese</font>

65
00:02:39,900 --> 00:02:45,270
philosophy of<font color="#CCCCCC"> the absolute principle of</font>

66
00:02:42,120 --> 00:02:46,890
the underlying the universe and so I was

67
00:02:45,270 --> 00:02:49,140
thinking like what's the<font color="#CCCCCC"> Tao of hardware</font>

68
00:02:46,890 --> 00:02:50,970
right hardware is the absolute that

69
00:02:49,140 --> 00:02:54,299
underlies the entire<font color="#E5E5E5"> world of computing</font>

70
00:02:50,970 --> 00:02:55,859
everything we do every code we run every

71
00:02:54,300 --> 00:02:58,110
interpreted scripting language that we

72
00:02:55,860 --> 00:03:00,870
we write in eventually whittles down to

73
00:02:58,110 --> 00:03:03,300
Hardware underneath it today<font color="#E5E5E5"> on the</font>

74
00:03:00,870 --> 00:03:05,280
other hand is kind of this concept<font color="#CCCCCC"> in</font>

75
00:03:03,300 --> 00:03:08,250
Chinese philosophy of inner power and

76
00:03:05,280 --> 00:03:10,320
integrity so that the<font color="#CCCCCC"> tei of these</font>

77
00:03:08,250 --> 00:03:11,820
implants that<font color="#E5E5E5"> I'm building is that if</font><font color="#CCCCCC"> we</font>

78
00:03:10,320 --> 00:03:13,680
can<font color="#E5E5E5"> understand and harness the inner</font>

79
00:03:11,820 --> 00:03:15,750
strength<font color="#CCCCCC"> of minor addition to hardware</font>

80
00:03:13,680 --> 00:03:17,820
systems we can have pretty incredible

81
00:03:15,750 --> 00:03:19,709
power over everything that runs on it

82
00:03:17,820 --> 00:03:22,829
every<font color="#E5E5E5"> bit of code every bit of software</font>

83
00:03:19,709 --> 00:03:26,459
<font color="#E5E5E5">every bit of scripting language and the</font>

84
00:03:22,830 --> 00:03:29,850
author<font color="#E5E5E5"> of</font><font color="#CCCCCC"> childhood shit yeah tell</font><font color="#E5E5E5"> jay</font>

85
00:03:26,459 --> 00:03:31,140
<font color="#E5E5E5">king is that that ya lousy said do the</font>

86
00:03:29,850 --> 00:03:32,400
difficult things while they are simple

87
00:03:31,140 --> 00:03:34,589
and do the great things<font color="#E5E5E5"> while they are</font>

88
00:03:32,400 --> 00:03:35,850
small so let's make little tiny hardware

89
00:03:34,590 --> 00:03:38,130
implants to get us our route shells

90
00:03:35,850 --> 00:03:39,660
instead of having to chainsaw for

91
00:03:38,130 --> 00:03:41,850
vulnerabilities and sandbox escapes

92
00:03:39,660 --> 00:03:45,329
because that's just<font color="#E5E5E5"> hard work and</font><font color="#CCCCCC"> it's</font>

93
00:03:41,850 --> 00:03:50,070
software and software is difficult so

94
00:03:45,330 --> 00:03:51,239
before<font color="#E5E5E5"> 2013 we had hardware implants but</font>

95
00:03:50,070 --> 00:03:53,040
what our minds<font color="#CCCCCC"> and what we thought of</font>

96
00:03:51,239 --> 00:03:55,200
hardware implants was very<font color="#E5E5E5"> different</font>

97
00:03:53,040 --> 00:03:57,209
this is a tiny little USB keystroke

98
00:03:55,200 --> 00:03:58,470
logger<font color="#E5E5E5"> you plug it in to your keyboard</font>

99
00:03:57,209 --> 00:04:00,360
your system you plug your keyboard into

100
00:03:58,470 --> 00:04:02,130
this or much better someone else's would

101
00:04:00,360 --> 00:04:03,989
be the idea and you can log every

102
00:04:02,130 --> 00:04:05,970
keystroke that they send you take this

103
00:04:03,989 --> 00:04:07,769
off later you bring it<font color="#CCCCCC"> to your system at</font>

104
00:04:05,970 --> 00:04:09,630
<font color="#CCCCCC">home you plug it in and you press some</font>

105
00:04:07,769 --> 00:04:12,120
magic key sequence and<font color="#E5E5E5"> it spits out</font>

106
00:04:09,630 --> 00:04:14,100
every keystroke that they've typed over

107
00:04:12,120 --> 00:04:16,978
the past week month year however<font color="#E5E5E5"> long</font>

108
00:04:14,100 --> 00:04:18,779
you've had it<font color="#E5E5E5"> in place the other thing</font>

109
00:04:16,978 --> 00:04:22,500
we had are these game console

110
00:04:18,779 --> 00:04:24,270
modifications everybody likes to<font color="#E5E5E5"> back up</font>

111
00:04:22,500 --> 00:04:24,940
their video games because what<font color="#E5E5E5"> would</font>

112
00:04:24,270 --> 00:04:27,190
happen if

113
00:04:24,940 --> 00:04:29,680
<font color="#E5E5E5">you had a flood or a fire or someone</font>

114
00:04:27,190 --> 00:04:31,420
stole<font color="#E5E5E5"> all your computer yeah your your</font>

115
00:04:29,680 --> 00:04:34,870
cartridges actually not cartridges

116
00:04:31,420 --> 00:04:36,190
anymore your<font color="#E5E5E5"> CDs or DVDs or discs for</font>

117
00:04:34,870 --> 00:04:37,840
your game console so you want to make

118
00:04:36,190 --> 00:04:39,790
backups of all<font color="#E5E5E5"> these and you want to</font>

119
00:04:37,840 --> 00:04:41,739
play these backups so you go<font color="#E5E5E5"> and buy</font>

120
00:04:39,790 --> 00:04:43,630
these little chips that cost maybe ten

121
00:04:41,740 --> 00:04:45,610
twenty thirty dollars and they're very

122
00:04:43,630 --> 00:04:47,740
<font color="#CCCCCC">user-friendly if you ever have if</font><font color="#E5E5E5"> you've</font>

123
00:04:45,610 --> 00:04:49,570
never soldered before these are still

124
00:04:47,740 --> 00:04:50,890
made for you you<font color="#CCCCCC"> line</font><font color="#E5E5E5"> this chip up in</font>

125
00:04:49,570 --> 00:04:53,110
just<font color="#E5E5E5"> the right spot they tell you</font>

126
00:04:50,890 --> 00:04:55,630
exactly where to solder five or six

127
00:04:53,110 --> 00:04:57,250
touches of solder and suddenly you have

128
00:04:55,630 --> 00:04:59,530
<font color="#E5E5E5">installed a hardware implant in your</font>

129
00:04:57,250 --> 00:05:01,360
system<font color="#E5E5E5"> and its hardware implant lets you</font>

130
00:04:59,530 --> 00:05:03,940
bypass the restrictions that prevent you

131
00:05:01,360 --> 00:05:06,520
from playing your legally purchased

132
00:05:03,940 --> 00:05:10,000
backup copies of your computer games as

133
00:05:06,520 --> 00:05:11,409
well as your homebrew code as well so

134
00:05:10,000 --> 00:05:12,460
<font color="#CCCCCC">all of this changes</font><font color="#E5E5E5"> this is what we</font>

135
00:05:11,410 --> 00:05:15,520
thought about<font color="#CCCCCC"> what hardware implants</font>

136
00:05:12,460 --> 00:05:17,739
this changed about 2013 in<font color="#E5E5E5"> December</font>

137
00:05:15,520 --> 00:05:20,680
there was this<font color="#CCCCCC"> catalogue that was leaked</font>

138
00:05:17,740 --> 00:05:24,730
that advertised a<font color="#CCCCCC"> so-called NSA</font><font color="#E5E5E5"> toolbox</font>

139
00:05:20,680 --> 00:05:26,380
of spy toys it had all sorts of very

140
00:05:24,730 --> 00:05:28,840
<font color="#CCCCCC">interesting things that</font><font color="#E5E5E5"> the media</font>

141
00:05:26,380 --> 00:05:30,850
thought was kind<font color="#E5E5E5"> of magical several of</font>

142
00:05:28,840 --> 00:05:32,530
us disagreed so we got together and in

143
00:05:30,850 --> 00:05:35,050
blunted our own versions and called it

144
00:05:32,530 --> 00:05:37,119
the NSA playset you can check out NSA

145
00:05:35,050 --> 00:05:39,430
playset org to find all the toys that

146
00:05:37,120 --> 00:05:40,540
<font color="#CCCCCC">we've</font><font color="#E5E5E5"> developed all open source open</font>

147
00:05:39,430 --> 00:05:44,080
hardware so you can go<font color="#E5E5E5"> and implement</font>

148
00:05:40,540 --> 00:05:46,919
them yourself the point is what was a

149
00:05:44,080 --> 00:05:49,690
you know magic according to<font color="#E5E5E5"> the media</font>

150
00:05:46,919 --> 00:05:51,940
you know<font color="#CCCCCC"> nation state capabilities was</font>

151
00:05:49,690 --> 00:05:54,450
actually pretty basic hardware

152
00:05:51,940 --> 00:05:57,400
engineering and open source<font color="#E5E5E5"> and</font>

153
00:05:54,450 --> 00:05:59,710
hopefully doable by any teenager in

154
00:05:57,400 --> 00:06:03,370
their garage or even younger who can

155
00:05:59,710 --> 00:06:05,700
solder some wires together so what

156
00:06:03,370 --> 00:06:07,990
malicious hardware implants are real

157
00:06:05,700 --> 00:06:09,820
<font color="#CCCCCC">Hardware don't harder implants</font><font color="#E5E5E5"> don't</font>

158
00:06:07,990 --> 00:06:11,470
live in a vacuum what was the key

159
00:06:09,820 --> 00:06:13,870
<font color="#CCCCCC">takeaway from me as I was</font><font color="#E5E5E5"> looking at</font>

160
00:06:11,470 --> 00:06:15,820
this lead catalog all of<font color="#CCCCCC"> these Hardware</font>

161
00:06:13,870 --> 00:06:20,050
implants were designed<font color="#E5E5E5"> to give</font><font color="#CCCCCC"> Hardware</font>

162
00:06:15,820 --> 00:06:22,030
use<font color="#E5E5E5"> hardware access</font><font color="#CCCCCC"> to give software</font>

163
00:06:20,050 --> 00:06:23,410
privilege once<font color="#E5E5E5"> the software had</font>

164
00:06:22,030 --> 00:06:25,030
privileged you didn't<font color="#E5E5E5"> need the hardware</font>

165
00:06:23,410 --> 00:06:27,430
anymore you could let some software

166
00:06:25,030 --> 00:06:29,650
person figure it out and as we all know

167
00:06:27,430 --> 00:06:31,180
there's tons of software conferences

168
00:06:29,650 --> 00:06:33,099
there's tons of software developers this

169
00:06:31,180 --> 00:06:34,840
is a hardware conference so if we<font color="#CCCCCC"> can</font>

170
00:06:33,100 --> 00:06:36,760
shuffle off all that work to the

171
00:06:34,840 --> 00:06:38,049
software people all the better we can do

172
00:06:36,760 --> 00:06:39,460
we<font color="#CCCCCC"> can focus</font><font color="#E5E5E5"> on the fun stuff much</font>

173
00:06:38,050 --> 00:06:42,440
longer

174
00:06:39,460 --> 00:06:44,950
so today I've<font color="#CCCCCC"> got five hardware implants</font>

175
00:06:42,440 --> 00:06:46,969
that I've<font color="#E5E5E5"> developed some of them are</font>

176
00:06:44,950 --> 00:06:51,560
similar ones that are repurposed in

177
00:06:46,970 --> 00:06:53,840
different situations so what I want<font color="#E5E5E5"> to</font>

178
00:06:51,560 --> 00:06:55,760
do<font color="#CCCCCC"> is I'm going to blindly escalate</font>

179
00:06:53,840 --> 00:06:57,619
<font color="#CCCCCC">privileged in a system using</font><font color="#E5E5E5"> jtag I'm</font>

180
00:06:55,760 --> 00:06:59,480
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> patch kernels via DMA on an</font>

181
00:06:57,620 --> 00:07:01,880
embedded device I'll enable wireless

182
00:06:59,480 --> 00:07:04,070
control of an off-the-shelf plc I'll

183
00:07:01,880 --> 00:07:07,100
<font color="#CCCCCC">hot-plug</font><font color="#E5E5E5"> a malicious PLC expansion and</font>

184
00:07:04,070 --> 00:07:11,000
I'll go a little into bad USB style

185
00:07:07,100 --> 00:07:13,010
display adapters so you know some of you

186
00:07:11,000 --> 00:07:15,380
have heard some some rhetoric about how

187
00:07:13,010 --> 00:07:17,690
junk hacking is kind of killing the info

188
00:07:15,380 --> 00:07:18,980
second killing security people go<font color="#E5E5E5"> to a</font>

189
00:07:17,690 --> 00:07:21,380
conference and they present yeah I

190
00:07:18,980 --> 00:07:24,010
bought this piece of junk<font color="#E5E5E5"> from a store</font>

191
00:07:21,380 --> 00:07:26,120
<font color="#E5E5E5">and I opened it up and I hacked it and</font>

192
00:07:24,010 --> 00:07:28,130
the<font color="#E5E5E5"> argument is well there's not much to</font>

193
00:07:26,120 --> 00:07:31,310
be learned we know that junk is not

194
00:07:28,130 --> 00:07:33,380
secure the problem is junk hacking and

195
00:07:31,310 --> 00:07:35,930
critical infrastructure hacking are the

196
00:07:33,380 --> 00:07:37,820
exact same<font color="#E5E5E5"> skill set and the critical</font>

197
00:07:35,930 --> 00:07:39,230
infrastructure stuff is very poorly

198
00:07:37,820 --> 00:07:42,530
designed as well from<font color="#E5E5E5"> a hardware</font>

199
00:07:39,230 --> 00:07:43,880
security perspective so when you go to a

200
00:07:42,530 --> 00:07:45,619
conference and you see someone talk

201
00:07:43,880 --> 00:07:47,120
about how they opened up<font color="#E5E5E5"> a webcam or</font>

202
00:07:45,620 --> 00:07:49,760
opened up a router or open<font color="#E5E5E5"> up any</font>

203
00:07:47,120 --> 00:07:53,210
embedded system all those techniques

204
00:07:49,760 --> 00:07:56,710
apply to plcs and you know medical

205
00:07:53,210 --> 00:07:58,880
devices and cars just<font color="#E5E5E5"> like they apply to</font>

206
00:07:56,710 --> 00:08:01,729
network routers and webcams and

207
00:07:58,880 --> 00:08:03,820
everything else<font color="#E5E5E5"> so first if we want to</font>

208
00:08:01,730 --> 00:08:05,960
blindly escalate<font color="#E5E5E5"> privileged using jtag</font>

209
00:08:03,820 --> 00:08:08,030
how many<font color="#E5E5E5"> people here have used jtag</font>

210
00:08:05,960 --> 00:08:10,370
before probably a lot more<font color="#E5E5E5"> than most</font>

211
00:08:08,030 --> 00:08:12,590
conferences so<font color="#CCCCCC"> I don't have</font><font color="#E5E5E5"> to go in the</font>

212
00:08:10,370 --> 00:08:14,390
details about the layers of jtag and how

213
00:08:12,590 --> 00:08:16,070
you have<font color="#E5E5E5"> pins that control a state</font>

214
00:08:14,390 --> 00:08:18,229
machine the state machine gives you

215
00:08:16,070 --> 00:08:20,719
control over device specific operations

216
00:08:18,230 --> 00:08:23,750
and then we can do boundary scan we<font color="#E5E5E5"> can</font>

217
00:08:20,720 --> 00:08:26,960
halt resume we can do memory access<font color="#E5E5E5"> I</font>

218
00:08:23,750 --> 00:08:29,510
gave a presentation last year jtag to

219
00:08:26,960 --> 00:08:30,919
<font color="#E5E5E5">route</font><font color="#CCCCCC"> 5 ways because I noticed hardware</font>

220
00:08:29,510 --> 00:08:33,470
people think<font color="#CCCCCC"> all once you get jtag you</font>

221
00:08:30,920 --> 00:08:35,090
win right software<font color="#E5E5E5"> people think oh once</font>

222
00:08:33,470 --> 00:08:37,190
you get a root shell you win so let's

223
00:08:35,090 --> 00:08:41,450
connect the dots here's five ways<font color="#CCCCCC"> to go</font>

224
00:08:37,190 --> 00:08:43,310
from jtag to root shells so this one

225
00:08:41,450 --> 00:08:47,690
particular one goes through memory and

226
00:08:43,309 --> 00:08:50,359
modifies a user process<font color="#E5E5E5"> getty sorry</font>

227
00:08:47,690 --> 00:08:51,950
Getty is a process that runs and sits

228
00:08:50,360 --> 00:08:54,140
there and waits<font color="#E5E5E5"> for you to try</font><font color="#CCCCCC"> and log</font>

229
00:08:51,950 --> 00:08:56,420
when you go and enter a username it

230
00:08:54,140 --> 00:08:59,150
passes that username on to the log in

231
00:08:56,420 --> 00:09:01,910
executable which goes and asks you for

232
00:08:59,150 --> 00:09:04,670
your<font color="#E5E5E5"> password and processes that these</font>

233
00:09:01,910 --> 00:09:08,000
two dashes in here in this string inside

234
00:09:04,670 --> 00:09:09,740
the binary file those r dot dashes that

235
00:09:08,000 --> 00:09:12,080
are part of a string that's expanded and

236
00:09:09,740 --> 00:09:14,750
turned<font color="#E5E5E5"> into a shell command the dash is</font>

237
00:09:12,080 --> 00:09:16,270
<font color="#E5E5E5">also mean that no no command line</font>

238
00:09:14,750 --> 00:09:20,510
parameters should be parsed beyond this

239
00:09:16,270 --> 00:09:23,510
if we change that dash dash to dash<font color="#CCCCCC"> f we</font>

240
00:09:20,510 --> 00:09:26,540
actually are telling getty to instead

241
00:09:23,510 --> 00:09:28,970
force authentication meaning when i give

242
00:09:26,540 --> 00:09:31,189
you a<font color="#E5E5E5"> username so i am getty i'm running</font>

243
00:09:28,970 --> 00:09:32,960
as root<font color="#E5E5E5"> i give you a username and</font><font color="#CCCCCC"> i'm</font>

244
00:09:31,190 --> 00:09:34,070
telling<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to force</font><font color="#CCCCCC"> login as this user</font>

245
00:09:32,960 --> 00:09:36,320
don't ask them for the password<font color="#CCCCCC"> just</font>

246
00:09:34,070 --> 00:09:37,790
login as that person so what we can<font color="#E5E5E5"> do</font>

247
00:09:36,320 --> 00:09:40,820
is we can bypass the need to enter a

248
00:09:37,790 --> 00:09:42,260
password this one<font color="#E5E5E5"> this is one NS a place</font>

249
00:09:40,820 --> 00:09:46,430
that too i developed it's called solder

250
00:09:42,260 --> 00:09:48,020
peak which is a play on<font color="#CCCCCC"> the name flux</font>

251
00:09:46,430 --> 00:09:51,890
<font color="#CCCCCC">babbitt which was the name that was</font>

252
00:09:48,020 --> 00:09:54,260
mentioned in the NSA catalog and solder

253
00:09:51,890 --> 00:09:56,449
peak is basically an<font color="#E5E5E5"> arduino board that</font>

254
00:09:54,260 --> 00:09:58,670
plays back a script of jtag commands

255
00:09:56,450 --> 00:10:02,300
that's stored on a little<font color="#CCCCCC"> eeprom right</font>

256
00:09:58,670 --> 00:10:04,219
there very simple PCB two major

257
00:10:02,300 --> 00:10:08,390
components and some supporting passive

258
00:10:04,220 --> 00:10:09,800
components you can<font color="#E5E5E5"> use open OCD to</font>

259
00:10:08,390 --> 00:10:11,660
prototype this you sit<font color="#E5E5E5"> there with open</font>

260
00:10:09,800 --> 00:10:14,030
OCD you go through memory you find the

261
00:10:11,660 --> 00:10:16,760
thing you modify it you modify that bite

262
00:10:14,030 --> 00:10:17,959
memory and you get root shell so what

263
00:10:16,760 --> 00:10:19,880
you can<font color="#E5E5E5"> do is you can log everything</font>

264
00:10:17,960 --> 00:10:22,340
that opens OCD does in that<font color="#E5E5E5"> time and</font>

265
00:10:19,880 --> 00:10:25,640
turn that into an SDF file 0 vector

266
00:10:22,340 --> 00:10:31,670
format store that file on the<font color="#E5E5E5"> little</font>

267
00:10:25,640 --> 00:10:34,760
<font color="#CCCCCC">eeprom and then we have a video</font><font color="#E5E5E5"> of doing</font>

268
00:10:31,670 --> 00:10:38,329
that so here's a<font color="#CCCCCC"> Galileo it's an x86</font>

269
00:10:34,760 --> 00:10:40,580
based development board it's plugged in

270
00:10:38,330 --> 00:10:43,850
and powered up to my system and<font color="#E5E5E5"> I'm</font>

271
00:10:40,580 --> 00:10:45,530
trying to log in right of course I login

272
00:10:43,850 --> 00:10:48,500
<font color="#E5E5E5">as root and it asks me a password I</font>

273
00:10:45,530 --> 00:10:49,730
don't know the password just<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font>

274
00:10:48,500 --> 00:10:53,900
sure<font color="#E5E5E5"> you know it's a good system i'm</font>

275
00:10:49,730 --> 00:10:58,970
going to log in as a user<font color="#E5E5E5"> galileo</font>

276
00:10:53,900 --> 00:11:02,410
password a yeah we can<font color="#CCCCCC"> log-in normally</font>

277
00:10:58,970 --> 00:11:05,600
so we want to<font color="#E5E5E5"> get around that let's exit</font>

278
00:11:02,410 --> 00:11:07,620
now our board is connected

279
00:11:05,600 --> 00:11:08,610
oversee<font color="#E5E5E5"> okay that's how we're talking to</font>

280
00:11:07,620 --> 00:11:11,190
it we're<font color="#E5E5E5"> going to get a solder peak</font>

281
00:11:08,610 --> 00:11:12,660
that's been pre-programmed luckily<font color="#E5E5E5"> this</font>

282
00:11:11,190 --> 00:11:15,510
is<font color="#E5E5E5"> development board so it has a jtag</font>

283
00:11:12,660 --> 00:11:17,910
head or easy for us to access<font color="#CCCCCC"> that Jo</font>

284
00:11:15,510 --> 00:11:21,270
that device is already pre-prepared with

285
00:11:17,910 --> 00:11:22,650
the SPF file I try to do it with<font color="#CCCCCC"> one</font>

286
00:11:21,270 --> 00:11:24,510
hand because I'm holding<font color="#E5E5E5"> the camera with</font>

287
00:11:22,650 --> 00:11:27,930
<font color="#E5E5E5">the other hand I now have a tripod which</font>

288
00:11:24,510 --> 00:11:32,689
makes this a lot easier and less induces

289
00:11:27,930 --> 00:11:32,689
less motion sickness to you guys and

290
00:11:33,380 --> 00:11:37,800
this is<font color="#CCCCCC"> Hardware skills like real</font>

291
00:11:35,940 --> 00:11:39,510
hardware hacking skills plugging cables

292
00:11:37,800 --> 00:11:42,479
and with one hand while there's a

293
00:11:39,510 --> 00:11:43,740
plastic<font color="#CCCCCC"> thing in the way so once it</font>

294
00:11:42,480 --> 00:11:46,170
plugs in its getting power from the

295
00:11:43,740 --> 00:11:47,750
advice it powers up the board no lights

296
00:11:46,170 --> 00:11:52,890
or anything<font color="#E5E5E5"> because we want this to be</font>

297
00:11:47,750 --> 00:11:54,810
some hidden basically it's going<font color="#E5E5E5"> through</font>

298
00:11:52,890 --> 00:11:56,400
<font color="#E5E5E5">it's running</font><font color="#CCCCCC"> that jtag script it's going</font>

299
00:11:54,810 --> 00:12:01,020
through<font color="#CCCCCC"> a patching several locations in</font>

300
00:11:56,400 --> 00:12:04,800
memory and if we go back over here we go

301
00:12:01,020 --> 00:12:10,380
and login as root and bam we're in we

302
00:12:04,800 --> 00:12:11,969
just bypassed that and just<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> sure</font>

303
00:12:10,380 --> 00:12:15,060
<font color="#CCCCCC">you</font><font color="#E5E5E5"> know we can app cat at sea shadow</font>

304
00:12:11,970 --> 00:12:20,580
see the shadow file and yes we have in

305
00:12:15,060 --> 00:12:22,410
fact logged in as root so and it's any

306
00:12:20,580 --> 00:12:26,520
account<font color="#CCCCCC"> too so if we exit we can go log</font>

307
00:12:22,410 --> 00:12:29,939
in as a user as well oh yeah do it<font color="#CCCCCC"> again</font>

308
00:12:26,520 --> 00:12:34,230
whatever the<font color="#E5E5E5"> point being now we login as</font>

309
00:12:29,940 --> 00:12:36,600
user there we go<font color="#E5E5E5"> just</font><font color="#CCCCCC"> user Galileo</font>

310
00:12:34,230 --> 00:12:39,150
likewise it's not<font color="#E5E5E5"> going to ask us for a</font>

311
00:12:36,600 --> 00:12:40,950
password but login is anything we want

312
00:12:39,150 --> 00:12:49,020
just that time we're a plain old user

313
00:12:40,950 --> 00:12:50,850
which is boring anyway so onward so oh I

314
00:12:49,020 --> 00:12:53,280
don't<font color="#E5E5E5"> have</font><font color="#CCCCCC"> a so what slide well let's</font>

315
00:12:50,850 --> 00:12:57,540
move on patching kernels with dma on<font color="#E5E5E5"> an</font>

316
00:12:53,280 --> 00:12:58,890
that's out of order oh so what implant

317
00:12:57,540 --> 00:13:02,370
hardware is simple cheap and readily

318
00:12:58,890 --> 00:13:04,890
available right that was<font color="#CCCCCC"> arduino pro</font>

319
00:13:02,370 --> 00:13:08,840
micro with one other chip less than five

320
00:13:04,890 --> 00:13:11,819
dollars of like build completed hardware

321
00:13:08,840 --> 00:13:13,530
when the headers<font color="#CCCCCC"> exist the</font><font color="#E5E5E5"> installation</font>

322
00:13:11,820 --> 00:13:15,720
is really quick we prototype that

323
00:13:13,530 --> 00:13:18,030
payload with standard open source tools

324
00:13:15,720 --> 00:13:19,030
the pin amount is adaptable you can make

325
00:13:18,030 --> 00:13:21,610
a custom header on

326
00:13:19,030 --> 00:13:23,290
board for whatever target you have it's

327
00:13:21,610 --> 00:13:25,510
nice and<font color="#CCCCCC"> small and easy</font><font color="#E5E5E5"> enough</font><font color="#CCCCCC"> to stick</font>

328
00:13:23,290 --> 00:13:28,900
in lots of places and jtag is jai thai

329
00:13:25,510 --> 00:13:31,990
gets jtag mostly<font color="#CCCCCC"> i've tested this ain't</font>

330
00:13:28,900 --> 00:13:33,550
same exact thing on arm on mips on x86

331
00:13:31,990 --> 00:13:35,410
obviously you have to change a little

332
00:13:33,550 --> 00:13:37,030
bit of<font color="#CCCCCC"> the content of what you're doing</font>

333
00:13:35,410 --> 00:13:38,650
but the overall process stays the same

334
00:13:37,030 --> 00:13:43,000
and the hardware implant stays the same

335
00:13:38,650 --> 00:13:45,959
as well so second patching kernels via

336
00:13:43,000 --> 00:13:48,190
DMA on an embedded device what is DMA

337
00:13:45,960 --> 00:13:50,410
this is kind of a map of what a<font color="#E5E5E5"> PCI</font>

338
00:13:48,190 --> 00:13:53,800
<font color="#E5E5E5">Express system looks like according to</font>

339
00:13:50,410 --> 00:13:55,449
the PCI Express sig according<font color="#E5E5E5"> to the</font>

340
00:13:53,800 --> 00:13:57,579
standard at the very top we have a cpu

341
00:13:55,450 --> 00:13:59,500
and then we have a root complex which is

342
00:13:57,580 --> 00:14:01,390
kind<font color="#E5E5E5"> of a top of the</font><font color="#CCCCCC"> PCI Express</font>

343
00:13:59,500 --> 00:14:03,700
hierarchy what you'll<font color="#E5E5E5"> notice though is</font>

344
00:14:01,390 --> 00:14:06,880
the memory lives under<font color="#CCCCCC"> the root complex</font>

345
00:14:03,700 --> 00:14:09,670
so the path from any endpoint on pci

346
00:14:06,880 --> 00:14:11,920
express to memory doesn't necessarily

347
00:14:09,670 --> 00:14:14,140
involve a cpu there's also a<font color="#E5E5E5"> past from</font>

348
00:14:11,920 --> 00:14:16,329
any<font color="#CCCCCC"> pc</font><font color="#E5E5E5"> express end point to any other</font>

349
00:14:14,140 --> 00:14:18,370
pci express endpoint without the<font color="#E5E5E5"> cpu</font>

350
00:14:16,330 --> 00:14:20,230
being involved all these software people

351
00:14:18,370 --> 00:14:23,470
think<font color="#CCCCCC"> like the cpu is like the brain of</font>

352
00:14:20,230 --> 00:14:25,300
<font color="#E5E5E5">the operation right but really like you</font>

353
00:14:23,470 --> 00:14:26,980
know like<font color="#CCCCCC"> it's if the root complex</font>

354
00:14:25,300 --> 00:14:29,680
that's in charge of what<font color="#E5E5E5"> happens on this</font>

355
00:14:26,980 --> 00:14:32,410
<font color="#CCCCCC">system there</font><font color="#E5E5E5"> is some history to dma</font>

356
00:14:29,680 --> 00:14:34,089
attacks about 10<font color="#E5E5E5"> years ago Joe grand</font>

357
00:14:32,410 --> 00:14:36,520
built this board<font color="#CCCCCC"> Tribble it was a pci</font>

358
00:14:34,090 --> 00:14:37,960
device we had a PowerPC processor<font color="#E5E5E5"> and</font>

359
00:14:36,520 --> 00:14:39,660
that would periodically go and dump the

360
00:14:37,960 --> 00:14:42,670
contents of memory to a hard drive

361
00:14:39,660 --> 00:14:44,350
there's also a firewire card add-in card

362
00:14:42,670 --> 00:14:47,229
shown here there's a whole class of

363
00:14:44,350 --> 00:14:49,230
firewire vulnerabilities where you plug

364
00:14:47,230 --> 00:14:51,910
a firewire cable between two systems and

365
00:14:49,230 --> 00:14:53,650
just by nature<font color="#E5E5E5"> of the system and</font>

366
00:14:51,910 --> 00:14:55,959
features that are supported by a default

367
00:14:53,650 --> 00:14:59,560
in fire where you can do DMA access to

368
00:14:55,960 --> 00:15:00,370
<font color="#E5E5E5">another computer externally I was</font>

369
00:14:59,560 --> 00:15:02,589
looking<font color="#CCCCCC"> for something a little more</font>

370
00:15:00,370 --> 00:15:05,320
generic i found this chip and reference

371
00:15:02,590 --> 00:15:07,360
board a<font color="#CCCCCC"> pol x USB 3380 and</font><font color="#E5E5E5"> i've</font><font color="#CCCCCC"> been</font>

372
00:15:05,320 --> 00:15:11,620
using it for poking at<font color="#E5E5E5"> PCI Express dma</font>

373
00:15:07,360 --> 00:15:13,060
text and all sorts of systems typically

374
00:15:11,620 --> 00:15:14,620
you think a<font color="#E5E5E5"> PCI Express is something</font>

375
00:15:13,060 --> 00:15:15,969
that exists in your desktop computer and

376
00:15:14,620 --> 00:15:19,240
<font color="#E5E5E5">you plug in a graphics card in your</font>

377
00:15:15,970 --> 00:15:22,720
computer and you can play<font color="#CCCCCC"> games or you</font>

378
00:15:19,240 --> 00:15:24,250
know crack hashes but you can also do

379
00:15:22,720 --> 00:15:27,220
this embedded systems too so this is a

380
00:15:24,250 --> 00:15:29,620
nvidia board and it's got a mini PCIe

381
00:15:27,220 --> 00:15:32,640
slot intentionally the intention of that

382
00:15:29,620 --> 00:15:35,590
slot is for what's it called

383
00:15:32,640 --> 00:15:37,449
wireless adapters but you know<font color="#CCCCCC"> pci</font>

384
00:15:35,590 --> 00:15:39,310
<font color="#CCCCCC">express is pci express is pci express</font>

385
00:15:37,450 --> 00:15:41,260
plug it in use some electrical tape to

386
00:15:39,310 --> 00:15:43,449
<font color="#CCCCCC">hold it in place and I can do memory</font>

387
00:15:41,260 --> 00:15:45,130
access what impressed me is right off

388
00:15:43,450 --> 00:15:48,010
the bat this device actually had memory

389
00:15:45,130 --> 00:15:49,180
protection enabled so rather<font color="#E5E5E5"> than put</font>

390
00:15:48,010 --> 00:15:52,210
effort into that I moved<font color="#CCCCCC"> to a different</font>

391
00:15:49,180 --> 00:15:53,500
platform this is another embedded system

392
00:15:52,210 --> 00:15:55,900
that i have this is a pogoplug and

393
00:15:53,500 --> 00:15:58,450
network attached<font color="#CCCCCC"> storage device it's</font>

394
00:15:55,900 --> 00:16:00,370
just an arm<font color="#E5E5E5"> CPU 800 megahertz but I know</font>

395
00:15:58,450 --> 00:16:03,130
<font color="#E5E5E5">from looking at the spec</font><font color="#CCCCCC"> that there's pc</font>

396
00:16:00,370 --> 00:16:05,530
<font color="#CCCCCC">Express on a couple wires so just very</font>

397
00:16:03,130 --> 00:16:07,030
carefully solder some wires in there you

398
00:16:05,530 --> 00:16:09,459
<font color="#E5E5E5">need to put some capacitors on certain</font>

399
00:16:07,030 --> 00:16:11,740
lines wire that oh I<font color="#E5E5E5"> don't have another</font>

400
00:16:09,460 --> 00:16:13,570
picture why are that around a solder

401
00:16:11,740 --> 00:16:15,310
<font color="#E5E5E5">that to a socket and plug a pci express</font>

402
00:16:13,570 --> 00:16:19,510
card in<font color="#E5E5E5"> and now we have the ability to</font>

403
00:16:15,310 --> 00:16:22,719
<font color="#E5E5E5">do DMA access on this</font><font color="#CCCCCC"> $10 home like</font>

404
00:16:19,510 --> 00:16:24,970
consumer electronics device this is the

405
00:16:22,720 --> 00:16:27,780
one<font color="#CCCCCC"> i will show you a demo of this is a</font>

406
00:16:24,970 --> 00:16:30,370
wireless<font color="#E5E5E5"> router and you know it's got</font><font color="#CCCCCC"> a</font>

407
00:16:27,780 --> 00:16:32,709
cpu a mips processor it's got some extra

408
00:16:30,370 --> 00:16:36,000
<font color="#E5E5E5">radios so you can have like 10 billion</font>

409
00:16:32,710 --> 00:16:37,960
different channels hog the entire entire

410
00:16:36,000 --> 00:16:39,820
bandwidth to use all for yourself

411
00:16:37,960 --> 00:16:42,430
because who cares<font color="#E5E5E5"> about your neighbors</font>

412
00:16:39,820 --> 00:16:45,250
<font color="#CCCCCC">and their ability to use Wi-Fi this</font>

413
00:16:42,430 --> 00:16:47,319
one's neat because it's got a SATA pci

414
00:16:45,250 --> 00:16:49,060
express connected SATA controller and

415
00:16:47,320 --> 00:16:51,370
there's a spot to<font color="#E5E5E5"> plug in a hard drive</font>

416
00:16:49,060 --> 00:16:54,280
it's also got an extra pci express slot

417
00:16:51,370 --> 00:16:56,260
in case you wanted<font color="#E5E5E5"> to put what's it</font>

418
00:16:54,280 --> 00:16:58,240
called a 4g module or something else

419
00:16:56,260 --> 00:17:00,370
that was on pci express of course pci

420
00:16:58,240 --> 00:17:02,410
express is pci express is pci express so

421
00:17:00,370 --> 00:17:03,930
i just plugged my device in there and

422
00:17:02,410 --> 00:17:09,310
held it in with electrical tape again

423
00:17:03,930 --> 00:17:10,899
and looking at this a block diagram for

424
00:17:09,310 --> 00:17:12,698
the<font color="#E5E5E5"> cpu from the datasheet right write</font>

425
00:17:10,900 --> 00:17:14,260
it in right right there it's got<font color="#E5E5E5"> PCI</font>

426
00:17:12,699 --> 00:17:16,329
<font color="#E5E5E5">Express three lane three different</font>

427
00:17:14,260 --> 00:17:18,339
connections so i can plug stuff in there

428
00:17:16,329 --> 00:17:20,020
<font color="#E5E5E5">and do what i want and of course connect</font>

429
00:17:18,339 --> 00:17:23,280
to<font color="#E5E5E5"> the dram controller and go and do</font>

430
00:17:20,020 --> 00:17:25,599
stuff without worrying about the cpu<font color="#E5E5E5"> i</font>

431
00:17:23,280 --> 00:17:28,480
wrote some tax ID software basically

432
00:17:25,599 --> 00:17:31,300
some python that would let me read and

433
00:17:28,480 --> 00:17:33,400
write memory and again i'm<font color="#CCCCCC"> going to go</font>

434
00:17:31,300 --> 00:17:35,770
and target a part of the colonel where

435
00:17:33,400 --> 00:17:37,480
we do file system access list

436
00:17:35,770 --> 00:17:39,610
enforcement basically we<font color="#CCCCCC"> have this</font>

437
00:17:37,480 --> 00:17:41,500
generic permission function is the user

438
00:17:39,610 --> 00:17:43,810
permitted to touch this file it returns

439
00:17:41,500 --> 00:17:45,140
yes or no<font color="#E5E5E5"> no would be</font><font color="#CCCCCC"> in the form of</font>

440
00:17:43,810 --> 00:17:46,879
negative e access

441
00:17:45,140 --> 00:17:48,590
if<font color="#E5E5E5"> I can go and change the spot in</font>

442
00:17:46,880 --> 00:17:50,630
memory where negative exs is returned

443
00:17:48,590 --> 00:17:53,840
and put<font color="#E5E5E5"> that as zero right then it</font>

444
00:17:50,630 --> 00:18:06,760
returns true and we went so here's a

445
00:17:53,840 --> 00:18:09,020
video so them<font color="#CCCCCC"> too mediatek so here is</font>

446
00:18:06,760 --> 00:18:10,840
actually we<font color="#E5E5E5"> don't need video audio on</font>

447
00:18:09,020 --> 00:18:14,810
this one it's the later ones we do so

448
00:18:10,840 --> 00:18:17,570
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the wireless router it's a mips</font>

449
00:18:14,810 --> 00:18:21,440
face router it's got some antennas it's

450
00:18:17,570 --> 00:18:25,399
got chips on it it's got some flash that

451
00:18:21,440 --> 00:18:27,200
stores the firmware for it it's got<font color="#CCCCCC"> a</font>

452
00:18:25,400 --> 00:18:29,270
SATA controller that's going to<font color="#E5E5E5"> be IPC</font>

453
00:18:27,200 --> 00:18:33,470
<font color="#CCCCCC">Express and it's got my device that I've</font>

454
00:18:29,270 --> 00:18:36,620
plugged in there that USB cable connects

455
00:18:33,470 --> 00:18:38,960
to my laptop<font color="#CCCCCC"> to my implant that serial</font>

456
00:18:36,620 --> 00:18:43,639
cable connects to the console and I'm

457
00:18:38,960 --> 00:18:45,620
logged in right now as a nun user if<font color="#E5E5E5"> I</font>

458
00:18:43,640 --> 00:18:48,320
were to go ahead<font color="#E5E5E5"> and try</font><font color="#CCCCCC"> and cat</font><font color="#E5E5E5"> at sea</font>

459
00:18:45,620 --> 00:18:53,780
shadow oh you know look at the

460
00:18:48,320 --> 00:19:00,919
permissions on it its<font color="#E5E5E5"> root only so if i</font>

461
00:18:53,780 --> 00:19:04,120
try to cat it I can't do it over here

462
00:19:00,920 --> 00:19:06,560
<font color="#CCCCCC">I've got</font><font color="#E5E5E5"> a script that's going to go and</font>

463
00:19:04,120 --> 00:19:08,330
go and<font color="#E5E5E5"> patch generic permission so it's</font>

464
00:19:06,560 --> 00:19:11,030
detecting my implant device talking to

465
00:19:08,330 --> 00:19:12,560
it over USB patching<font color="#E5E5E5"> generic Christian</font>

466
00:19:11,030 --> 00:19:15,770
I've address it knows it can find it and

467
00:19:12,560 --> 00:19:18,649
I that's the device<font color="#E5E5E5"> that device just</font>

468
00:19:15,770 --> 00:19:20,840
<font color="#E5E5E5">sent dma commands over</font><font color="#CCCCCC"> PCI Express and</font>

469
00:19:18,650 --> 00:19:23,600
sorry<font color="#E5E5E5"> about the motion I should be</font><font color="#CCCCCC"> able</font>

470
00:19:20,840 --> 00:19:25,129
<font color="#E5E5E5">to cat etsy shadow and basically any</font>

471
00:19:23,600 --> 00:19:28,310
file access permission at this point in

472
00:19:25,130 --> 00:19:30,230
time<font color="#E5E5E5"> will pass so there we go yeah we</font>

473
00:19:28,310 --> 00:19:33,169
win we got the file if we want to clean

474
00:19:30,230 --> 00:19:34,640
that up we can go unpatch it basically

475
00:19:33,170 --> 00:19:38,660
patch the original value<font color="#E5E5E5"> back into</font>

476
00:19:34,640 --> 00:19:40,220
memory takes a moment to identify<font color="#CCCCCC"> the</font>

477
00:19:38,660 --> 00:19:42,920
device do the memory transaction

478
00:19:40,220 --> 00:19:44,300
restores the value and<font color="#E5E5E5"> it's done and I</font>

479
00:19:42,920 --> 00:19:48,460
should be<font color="#CCCCCC"> able to try and cat etsy</font>

480
00:19:44,300 --> 00:19:51,470
shadow and it should not work come on

481
00:19:48,460 --> 00:19:54,260
there we go kadett c shadow

482
00:19:51,470 --> 00:19:56,270
permission tonight so<font color="#CCCCCC"> just change a bite</font>

483
00:19:54,260 --> 00:19:58,789
in memory and this is what you actually

484
00:19:56,270 --> 00:20:08,030
it's a<font color="#CCCCCC"> d word in memory and you can</font>

485
00:19:58,789 --> 00:20:10,090
control access to the system so in this

486
00:20:08,030 --> 00:20:13,190
example it wasn't<font color="#E5E5E5"> really a standalone</font>

487
00:20:10,090 --> 00:20:15,740
command alone implant because i had my

488
00:20:13,190 --> 00:20:18,230
USB cable attached to the end<font color="#CCCCCC"> to a pc</font>

489
00:20:15,740 --> 00:20:20,000
but this device does have an 8051 cpu

490
00:20:18,230 --> 00:20:22,610
and a little my controller so<font color="#E5E5E5"> i could</font>

491
00:20:20,000 --> 00:20:25,309
theoretically port my you know<font color="#E5E5E5"> 20 to 30</font>

492
00:20:22,610 --> 00:20:26,539
lines of code compile them for the cpu

493
00:20:25,309 --> 00:20:27,678
put it right in the firmware<font color="#E5E5E5"> islands</font>

494
00:20:26,539 --> 00:20:29,270
device and it would<font color="#E5E5E5"> be a standalone</font>

495
00:20:27,679 --> 00:20:30,830
device that you know<font color="#E5E5E5"> maybe i could have</font>

496
00:20:29,270 --> 00:20:32,539
put a button on it to trigger it or<font color="#CCCCCC"> i</font>

497
00:20:30,830 --> 00:20:34,820
could<font color="#E5E5E5"> just have it time to you know wait</font>

498
00:20:32,539 --> 00:20:35,990
until a certain time of day or<font color="#CCCCCC"> wait till</font>

499
00:20:34,820 --> 00:20:42,408
you<font color="#CCCCCC"> know an hour after the system is</font>

500
00:20:35,990 --> 00:20:44,240
booted and apply the patch so the<font color="#E5E5E5"> next</font>

501
00:20:42,409 --> 00:20:46,580
implant<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> show you is enabling</font>

502
00:20:44,240 --> 00:20:47,870
wireless control of an off-the-shelf<font color="#E5E5E5"> PLC</font>

503
00:20:46,580 --> 00:20:49,879
this is where we're moving<font color="#E5E5E5"> away from the</font>

504
00:20:47,870 --> 00:20:53,750
toys and junk and into the critical

505
00:20:49,880 --> 00:20:55,610
<font color="#E5E5E5">infrastructure which you know maybe some</font>

506
00:20:53,750 --> 00:20:57,590
people<font color="#E5E5E5"> would disagree on the the level</font>

507
00:20:55,610 --> 00:21:00,830
of detail<font color="#E5E5E5"> in the design so this is a</font>

508
00:20:57,590 --> 00:21:02,030
siemens s7 200<font color="#CCCCCC"> PLC it's pretty old I</font>

509
00:21:00,830 --> 00:21:04,639
borrowed this from a friend this<font color="#E5E5E5"> is what</font>

510
00:21:02,030 --> 00:21:06,168
got<font color="#CCCCCC"> me started on plcs I'm like oh plc's</font>

511
00:21:04,640 --> 00:21:08,240
<font color="#CCCCCC">those sound like</font><font color="#E5E5E5"> fun let me find one and</font>

512
00:21:06,169 --> 00:21:10,970
this is what I could<font color="#E5E5E5"> get so of course I</font>

513
00:21:08,240 --> 00:21:12,700
open it up it's what I do we found<font color="#E5E5E5"> a</font><font color="#CCCCCC"> CPU</font>

514
00:21:10,970 --> 00:21:14,929
we found memory and we found flash

515
00:21:12,700 --> 00:21:17,000
something<font color="#E5E5E5"> inside me was expecting this</font>

516
00:21:14,929 --> 00:21:19,100
to be like all custom hardware custom

517
00:21:17,000 --> 00:21:20,900
silicon but in all reality this<font color="#CCCCCC"> is much</font>

518
00:21:19,100 --> 00:21:22,639
lower volume than consumer electronics

519
00:21:20,900 --> 00:21:24,169
so you're going<font color="#E5E5E5"> to find much</font><font color="#CCCCCC"> more in</font>

520
00:21:22,640 --> 00:21:27,260
terms of off-the-shelf components in

521
00:21:24,169 --> 00:21:29,270
lower volume devices pull that<font color="#CCCCCC"> off I</font>

522
00:21:27,260 --> 00:21:31,879
have another layer<font color="#E5E5E5"> of circuit board this</font>

523
00:21:29,270 --> 00:21:33,500
layer has output buffers and input

524
00:21:31,880 --> 00:21:34,850
buffers all the chips are marked<font color="#E5E5E5"> I can</font>

525
00:21:33,500 --> 00:21:36,590
find data sheets for everything I

526
00:21:34,850 --> 00:21:38,600
figured that out Bose basically because

527
00:21:36,590 --> 00:21:41,000
we have output pins up here and input

528
00:21:38,600 --> 00:21:43,280
pins down here though the bottom<font color="#E5E5E5"> layer</font>

529
00:21:41,000 --> 00:21:44,960
has some capacitors and basically your

530
00:21:43,280 --> 00:21:46,908
transformer to transform<font color="#CCCCCC"> óleo voltages</font>

531
00:21:44,960 --> 00:21:48,860
this is the board<font color="#E5E5E5"> that's interesting to</font>

532
00:21:46,909 --> 00:21:50,090
me like anybody can play with software

533
00:21:48,860 --> 00:21:52,490
but<font color="#E5E5E5"> I like the hardware side of things</font>

534
00:21:50,090 --> 00:21:54,049
<font color="#E5E5E5">so I look around and I figure out that</font>

535
00:21:52,490 --> 00:21:56,840
this header connects to a bunch of these

536
00:21:54,049 --> 00:21:58,039
chips that are one side these headers

537
00:21:56,840 --> 00:22:02,149
connect to those chips which is another

538
00:21:58,039 --> 00:22:04,760
set of the buffers if we look<font color="#E5E5E5"> carefully</font>

539
00:22:02,149 --> 00:22:06,139
this connector over here in

540
00:22:04,760 --> 00:22:07,820
have a tiered connector that hooks up to

541
00:22:06,140 --> 00:22:10,700
the next layer<font color="#CCCCCC"> of the board and connects</font>

542
00:22:07,820 --> 00:22:13,070
to IO pins GPIO pins of the CPU so all

543
00:22:10,700 --> 00:22:15,050
<font color="#E5E5E5">we need to do is get control over one of</font>

544
00:22:13,070 --> 00:22:17,179
those pins intercepted snippet solder a

545
00:22:15,050 --> 00:22:18,770
wire on both ends and we can use our

546
00:22:17,180 --> 00:22:21,140
little implant this<font color="#CCCCCC"> is a two dollar</font>

547
00:22:18,770 --> 00:22:23,840
<font color="#CCCCCC">Arduino board a one-dollar Nordic</font>

548
00:22:21,140 --> 00:22:25,340
semiconductor radio and there's<font color="#CCCCCC"> probably</font>

549
00:22:23,840 --> 00:22:27,100
like a dollar worth of wire in between

550
00:22:25,340 --> 00:22:29,449
<font color="#E5E5E5">there too so again under five dollars</font>

551
00:22:27,100 --> 00:22:30,919
build this little imp<font color="#CCCCCC"> int put in a</font>

552
00:22:29,450 --> 00:22:35,930
plastic bag so it's gonna short anything

553
00:22:30,920 --> 00:22:39,020
out and so I can put the top back on and

554
00:22:35,930 --> 00:22:41,480
the case is open<font color="#CCCCCC"> right now and you can't</font>

555
00:22:39,020 --> 00:22:43,250
see the implant right that's<font color="#E5E5E5"> pretty cool</font>

556
00:22:41,480 --> 00:22:44,420
yeah I mean<font color="#E5E5E5"> someone could open it up and</font>

557
00:22:43,250 --> 00:22:46,640
say there's someone tampered with this

558
00:22:44,420 --> 00:22:49,400
open it up look Oh looks fine<font color="#CCCCCC"> to me it's</font>

559
00:22:46,640 --> 00:22:52,310
good let's go pop the case back on it

560
00:22:49,400 --> 00:22:55,130
looks just<font color="#E5E5E5"> like it did before so I went</font>

561
00:22:52,310 --> 00:22:57,020
to<font color="#E5E5E5"> go and do</font><font color="#CCCCCC"> it like</font><font color="#E5E5E5"> a demo of this one</font>

562
00:22:55,130 --> 00:22:59,540
and<font color="#CCCCCC"> I'm like okay I just</font><font color="#E5E5E5"> got a program a</font>

563
00:22:57,020 --> 00:23:01,550
simple bunch of stuff in<font color="#CCCCCC"> here except it</font>

564
00:22:59,540 --> 00:23:04,040
turned out<font color="#CCCCCC"> to be really difficult to get</font>

565
00:23:01,550 --> 00:23:06,139
the software to program this thing the

566
00:23:04,040 --> 00:23:07,670
point though is I made this change with

567
00:23:06,140 --> 00:23:09,950
no software changes all the original

568
00:23:07,670 --> 00:23:12,290
hardware is there and the modification

569
00:23:09,950 --> 00:23:14,600
is an apparent from the outside since I

570
00:23:12,290 --> 00:23:17,300
couldn't<font color="#E5E5E5"> find the software to control to</font>

571
00:23:14,600 --> 00:23:20,570
give greater control the s7 200 legally

572
00:23:17,300 --> 00:23:21,800
find the software I decided to just get

573
00:23:20,570 --> 00:23:23,689
a different<font color="#E5E5E5"> target system so I got a</font>

574
00:23:21,800 --> 00:23:26,510
newer s7 1200 and did the<font color="#CCCCCC"> same thing</font>

575
00:23:23,690 --> 00:23:29,210
open it up we have a<font color="#E5E5E5"> board with a CP oh</font>

576
00:23:26,510 --> 00:23:30,770
I'm missing it there's a picture of<font color="#E5E5E5"> a</font>

577
00:23:29,210 --> 00:23:32,750
board the upper board has a<font color="#E5E5E5"> CPU and</font>

578
00:23:30,770 --> 00:23:35,000
memory like before this bottom board has

579
00:23:32,750 --> 00:23:37,910
a header which connects<font color="#E5E5E5"> to the input</font><font color="#CCCCCC"> and</font>

580
00:23:35,000 --> 00:23:41,570
output buffers and then there's a power

581
00:23:37,910 --> 00:23:43,550
board underneath I was focused on this

582
00:23:41,570 --> 00:23:45,950
board here's where<font color="#CCCCCC"> I knew that these</font>

583
00:23:43,550 --> 00:23:47,419
output lines came from I traced them up

584
00:23:45,950 --> 00:23:48,890
to the upper board and I know up<font color="#CCCCCC"> here we</font>

585
00:23:47,420 --> 00:23:51,230
have little LEDs that show us which

586
00:23:48,890 --> 00:23:52,700
outputs are on and off I check out<font color="#E5E5E5"> the</font>

587
00:23:51,230 --> 00:23:55,130
LEDs I see they're connected to<font color="#E5E5E5"> these</font>

588
00:23:52,700 --> 00:23:56,870
pins these pins are down here I follow

589
00:23:55,130 --> 00:23:58,910
traces to this chip which buffers them

590
00:23:56,870 --> 00:24:01,129
and puts them to that header up there

591
00:23:58,910 --> 00:24:03,470
<font color="#E5E5E5">and on the</font><font color="#CCCCCC"> other end of the header I</font>

592
00:24:01,130 --> 00:24:05,060
follow it and I have a bunch<font color="#E5E5E5"> of</font>

593
00:24:03,470 --> 00:24:07,490
resistors here this is one is for

594
00:24:05,060 --> 00:24:10,610
resistors in one package and one two

595
00:24:07,490 --> 00:24:12,170
three four are<font color="#CCCCCC"> the four outputs what's</font>

596
00:24:10,610 --> 00:24:13,429
really convenient<font color="#E5E5E5"> about this resistor is</font>

597
00:24:12,170 --> 00:24:15,350
it means that I can do<font color="#E5E5E5"> whatever the heck</font>

598
00:24:13,430 --> 00:24:17,000
I<font color="#E5E5E5"> want over here and it's not going to</font>

599
00:24:15,350 --> 00:24:18,550
cause problems on the other side i'm not

600
00:24:17,000 --> 00:24:19,900
going to short out the<font color="#E5E5E5"> cpu</font>

601
00:24:18,550 --> 00:24:22,030
so all i had to do is solder that<font color="#E5E5E5"> one</font>

602
00:24:19,900 --> 00:24:25,830
wire on there and get some power<font color="#E5E5E5"> and</font>

603
00:24:22,030 --> 00:24:27,970
ground and plug this implant in there so

604
00:24:25,830 --> 00:24:37,960
let's see if we've<font color="#CCCCCC"> got the video this</font>

605
00:24:27,970 --> 00:24:39,970
one needs sound so it actually it beeps

606
00:24:37,960 --> 00:24:41,650
really loud so maybe<font color="#CCCCCC"> I'll lower for you</font>

607
00:24:39,970 --> 00:24:43,810
a<font color="#E5E5E5"> little bit so we've got that implant</font>

608
00:24:41,650 --> 00:24:45,700
I've soldered a ground connection near

609
00:24:43,810 --> 00:24:47,260
that capacitor<font color="#CCCCCC"> a power connection which</font>

610
00:24:45,700 --> 00:24:49,510
I knew is power because I can find<font color="#E5E5E5"> the</font>

611
00:24:47,260 --> 00:24:50,620
specs<font color="#E5E5E5"> for that ship and the one spot</font>

612
00:24:49,510 --> 00:24:53,800
<font color="#CCCCCC">that i found that would control the</font>

613
00:24:50,620 --> 00:25:04,989
output<font color="#CCCCCC"> I'll put it in</font><font color="#E5E5E5"> there get those</font>

614
00:24:53,800 --> 00:25:13,510
wires tucked in nice and neat and<font color="#E5E5E5"> again</font>

615
00:25:04,990 --> 00:25:15,100
one-handed I'll reassemble the PLC and

616
00:25:13,510 --> 00:25:17,350
then pop the lid back<font color="#E5E5E5"> on what's really</font>

617
00:25:15,100 --> 00:25:18,879
neat about these is the lids snap right

618
00:25:17,350 --> 00:25:21,490
on and they snap right off and<font color="#E5E5E5"> there's</font>

619
00:25:18,880 --> 00:25:23,140
no scratches or any marks on them so you

620
00:25:21,490 --> 00:25:26,700
know there's no indication that's been

621
00:25:23,140 --> 00:25:29,860
modified we have our inputs and power

622
00:25:26,700 --> 00:25:32,650
output it's going<font color="#E5E5E5"> to a multimeter in</font>

623
00:25:29,860 --> 00:25:34,209
impedance in conductivity mode so it'll

624
00:25:32,650 --> 00:25:36,430
beep and tell us the resistance when

625
00:25:34,210 --> 00:25:40,270
it's shorted out<font color="#E5E5E5"> I'll go ahead and turn</font>

626
00:25:36,430 --> 00:25:42,070
it on and it's<font color="#E5E5E5"> telling me up the top</font>

627
00:25:40,270 --> 00:25:44,290
that once which is switched and none of

628
00:25:42,070 --> 00:25:47,230
the outputs are on I have it set up with

629
00:25:44,290 --> 00:25:49,180
a simple set reset circuit so it's set

630
00:25:47,230 --> 00:25:53,880
the multimeter is beeping because the

631
00:25:49,180 --> 00:25:53,880
outputs cleared I reset it it goes off

632
00:25:58,890 --> 00:26:03,100
so i'm going<font color="#E5E5E5"> to go over now and i have</font>

633
00:26:00,970 --> 00:26:05,440
another similar implant it's basically

634
00:26:03,100 --> 00:26:07,510
the same<font color="#E5E5E5"> radio and the same device</font>

635
00:26:05,440 --> 00:26:09,040
hooked up over<font color="#E5E5E5"> serial to my laptop I</font>

636
00:26:07,510 --> 00:26:10,960
could as well put this in a little

637
00:26:09,040 --> 00:26:14,200
<font color="#E5E5E5">dongle remote and I just override the</font>

638
00:26:10,960 --> 00:26:17,800
output<font color="#E5E5E5"> 12 open right into 10 to override</font>

639
00:26:14,200 --> 00:26:20,650
20 + z2 disabled so you can see when I

640
00:26:17,800 --> 00:26:22,120
do it as soon as<font color="#CCCCCC"> I do a one the light</font>

641
00:26:20,650 --> 00:26:24,940
doesn't go on but the multimeter is

642
00:26:22,120 --> 00:26:26,679
telling us the device is on right five

643
00:26:24,940 --> 00:26:29,090
dollars<font color="#E5E5E5"> a hardware you can put this in a</font>

644
00:26:26,680 --> 00:26:31,520
<font color="#CCCCCC">little car remote dongle type thing</font>

645
00:26:29,090 --> 00:26:33,020
and we can also override the output

646
00:26:31,520 --> 00:26:36,070
right now it's set it thinks the output

647
00:26:33,020 --> 00:26:36,070
is on but<font color="#E5E5E5"> it's clearly not</font>

648
00:26:38,940 --> 00:26:43,920
another possibility is you know you can

649
00:26:41,100 --> 00:26:44,939
<font color="#E5E5E5">go in and mess with it and you know</font>

650
00:26:43,920 --> 00:26:46,410
<font color="#E5E5E5">right software to do it really fast</font>

651
00:26:44,940 --> 00:26:49,350
because<font color="#E5E5E5"> sometimes that makes things</font>

652
00:26:46,410 --> 00:26:50,910
break and go and flip it on and off the

653
00:26:49,350 --> 00:26:53,250
real a really fast see what happens I

654
00:26:50,910 --> 00:26:54,420
hear noise happening if you do it a

655
00:26:53,250 --> 00:26:57,420
couple million times you might<font color="#E5E5E5"> break out</font>

656
00:26:54,420 --> 00:27:05,450
the relay and you know win or lose or

657
00:26:57,420 --> 00:27:05,450
<font color="#E5E5E5">blow something up so what's the point</font>

658
00:27:06,200 --> 00:27:12,570
this is a very<font color="#E5E5E5"> very cheap implant a</font>

659
00:27:09,000 --> 00:27:13,920
couple like less than five dollars it's

660
00:27:12,570 --> 00:27:16,379
almost completely off<font color="#CCCCCC"> the shelf open</font>

661
00:27:13,920 --> 00:27:18,150
source code I basically took an Arduino

662
00:27:16,380 --> 00:27:21,090
sketch cut and pasted it and change two

663
00:27:18,150 --> 00:27:22,380
or three wines and that's the extent of

664
00:27:21,090 --> 00:27:24,629
what it what's involved in<font color="#E5E5E5"> making this</font>

665
00:27:22,380 --> 00:27:26,790
this can be out retrofitted to most io

666
00:27:24,630 --> 00:27:30,180
types if you know where to solder the

667
00:27:26,790 --> 00:27:31,860
right wire to again is this is basic

668
00:27:30,180 --> 00:27:33,930
electronics and we're applying it to

669
00:27:31,860 --> 00:27:36,449
undermine assumptions that have been

670
00:27:33,930 --> 00:27:38,040
made about the security devices how long

671
00:27:36,450 --> 00:27:40,530
is going to take someone<font color="#CCCCCC"> to go in and</font>

672
00:27:38,040 --> 00:27:42,360
pop<font color="#CCCCCC"> that off and solder something on and</font>

673
00:27:40,530 --> 00:27:44,879
put it back together if it's in an

674
00:27:42,360 --> 00:27:46,770
unsecured location how difficult would

675
00:27:44,880 --> 00:27:48,120
it be to go and infiltrate a supply

676
00:27:46,770 --> 00:27:50,520
chain and put something like<font color="#E5E5E5"> this in a</font>

677
00:27:48,120 --> 00:27:52,979
system I don't<font color="#E5E5E5"> have answers for that but</font>

678
00:27:50,520 --> 00:27:54,870
I think<font color="#CCCCCC"> it's pretty easy so let's move</font>

679
00:27:52,980 --> 00:27:56,370
on we have another plc we can talk about

680
00:27:54,870 --> 00:27:59,520
<font color="#E5E5E5">and this is going to be a hot plugged</font>

681
00:27:56,370 --> 00:28:01,409
malicious plc expansion so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

682
00:27:59,520 --> 00:28:04,290
cheapest plc<font color="#E5E5E5"> i can buy in the united</font>

683
00:28:01,410 --> 00:28:08,190
<font color="#E5E5E5">states and</font><font color="#CCCCCC"> i figured</font><font color="#E5E5E5"> i'd buy one it's a</font>

684
00:28:04,290 --> 00:28:10,080
<font color="#CCCCCC">Phoenix Contact nano line</font><font color="#E5E5E5"> something and</font>

685
00:28:08,190 --> 00:28:11,970
of course I open it up easy to open up

686
00:28:10,080 --> 00:28:13,560
the first thing<font color="#CCCCCC"> that jumps out to me</font>

687
00:28:11,970 --> 00:28:16,380
<font color="#E5E5E5">because I'm a hardware guy and I play</font>

688
00:28:13,560 --> 00:28:18,540
with<font color="#CCCCCC"> a lot of electronics is anybody</font>

689
00:28:16,380 --> 00:28:20,940
what's anybody jump out<font color="#CCCCCC"> to anyone here</font>

690
00:28:18,540 --> 00:28:23,730
know<font color="#CCCCCC"> ten pins and</font><font color="#E5E5E5"> write the right</font>

691
00:28:20,940 --> 00:28:26,600
formation right there like as<font color="#E5E5E5"> soon as I</font>

692
00:28:23,730 --> 00:28:29,340
see that I'm like oh processor jtag port

693
00:28:26,600 --> 00:28:31,080
and sure enough it's an ARM processor

694
00:28:29,340 --> 00:28:33,419
with a data<font color="#E5E5E5"> sheet readily available and</font>

695
00:28:31,080 --> 00:28:34,889
<font color="#E5E5E5">a</font><font color="#CCCCCC"> tenpin jtag adapter</font><font color="#E5E5E5"> I can look at the</font>

696
00:28:33,420 --> 00:28:36,630
data sheet for this I know<font color="#E5E5E5"> that the Jake</font>

697
00:28:34,890 --> 00:28:40,380
tag pins it right here i omit out and

698
00:28:36,630 --> 00:28:42,630
double check yes it<font color="#E5E5E5"> is jtag of course</font>

699
00:28:40,380 --> 00:28:45,270
this this chip has code security

700
00:28:42,630 --> 00:28:48,690
features koduri protection lets you lock

701
00:28:45,270 --> 00:28:50,160
out people from using jtag you can do

702
00:28:48,690 --> 00:28:53,130
different modes where you enable or

703
00:28:50,160 --> 00:28:55,980
label<font color="#CCCCCC"> disable jtag completely</font>

704
00:28:53,130 --> 00:28:57,150
or just run control<font color="#E5E5E5"> or just flash you</font>

705
00:28:55,980 --> 00:29:00,270
know different microcontrollers have

706
00:28:57,150 --> 00:29:03,210
different features like this luckily no

707
00:29:00,270 --> 00:29:06,830
one ever uses them so at least on this

708
00:29:03,210 --> 00:29:09,270
system<font color="#E5E5E5"> it wasn't enabled I here have a</font>

709
00:29:06,830 --> 00:29:11,399
view from<font color="#E5E5E5"> the front and if you look this</font>

710
00:29:09,270 --> 00:29:14,790
<font color="#E5E5E5">is the</font><font color="#CCCCCC"> opening that you can plug in</font>

711
00:29:11,400 --> 00:29:17,040
these expansion modules right right now

712
00:29:14,790 --> 00:29:19,139
there's two blanks in there but this is

713
00:29:17,040 --> 00:29:21,840
how you would program it over USB you

714
00:29:19,140 --> 00:29:23,670
plug this guy in it hooks up to that<font color="#CCCCCC"> 10</font>

715
00:29:21,840 --> 00:29:26,490
pin black or sorry<font color="#E5E5E5"> 8 pin block header</font>

716
00:29:23,670 --> 00:29:29,430
and gives you a you know a control over

717
00:29:26,490 --> 00:29:31,380
that but right<font color="#E5E5E5"> next to</font><font color="#CCCCCC"> it is this header</font>

718
00:29:29,430 --> 00:29:35,370
which is really interesting<font color="#CCCCCC"> to me so i</font>

719
00:29:31,380 --> 00:29:37,730
get 0 let's take a step back the way

720
00:29:35,370 --> 00:29:39,570
that<font color="#CCCCCC"> the gpios on this chip are are</font>

721
00:29:37,730 --> 00:29:41,130
modified is through a memory mapped

722
00:29:39,570 --> 00:29:42,540
address so basically if we can write

723
00:29:41,130 --> 00:29:44,520
read & write to a certain memory address

724
00:29:42,540 --> 00:29:47,610
we can find the right GPIO pin that

725
00:29:44,520 --> 00:29:50,580
corresponds to our output and<font color="#E5E5E5"> write the</font>

726
00:29:47,610 --> 00:29:53,310
right values in the right registers and

727
00:29:50,580 --> 00:29:55,800
you just gotta dig through<font color="#CCCCCC"> the documents</font>

728
00:29:53,310 --> 00:29:57,780
to find the right<font color="#E5E5E5"> one if we look at the</font>

729
00:29:55,800 --> 00:30:00,030
device we have these relays these relays

730
00:29:57,780 --> 00:30:03,450
are what take the gpios and turn them

731
00:30:00,030 --> 00:30:05,970
into<font color="#E5E5E5"> on/off switches oh I thought I had</font>

732
00:30:03,450 --> 00:30:07,410
one more slide where I describe what I'm

733
00:30:05,970 --> 00:30:09,630
doing oh yeah now the<font color="#E5E5E5"> video will show</font>

734
00:30:07,410 --> 00:30:15,840
<font color="#E5E5E5">you the pogo pins that I use so last</font>

735
00:30:09,630 --> 00:30:20,310
video<font color="#E5E5E5"> sound stolen so them for phoenix</font>

736
00:30:15,840 --> 00:30:22,740
contact so same setup as before I've got

737
00:30:20,310 --> 00:30:24,149
a<font color="#E5E5E5"> PLC with some wires attached that are</font>

738
00:30:22,740 --> 00:30:27,690
hooked<font color="#E5E5E5"> up to a multimeter that beeps</font>

739
00:30:24,150 --> 00:30:30,570
when the switch is on this mode this<font color="#E5E5E5"> one</font>

740
00:30:27,690 --> 00:30:32,910
has a controller input where you can go

741
00:30:30,570 --> 00:30:34,860
and you<font color="#E5E5E5"> know directly turned on or off</font>

742
00:30:32,910 --> 00:30:38,290
any outputs and you know<font color="#CCCCCC"> what turn it on</font>

743
00:30:34,860 --> 00:30:44,889
it goes<font color="#E5E5E5"> on</font><font color="#CCCCCC"> I turn it off</font>

744
00:30:38,290 --> 00:30:47,139
it goes off but then i have my at my

745
00:30:44,890 --> 00:30:49,270
implant and those little pins right

746
00:30:47,140 --> 00:30:50,980
there are pogo pins and they're going<font color="#E5E5E5"> to</font>

747
00:30:49,270 --> 00:30:53,950
line up<font color="#CCCCCC"> with the right pins of the jtag</font>

748
00:30:50,980 --> 00:30:58,360
header that<font color="#CCCCCC"> i need to</font><font color="#E5E5E5"> send some jtag</font>

749
00:30:53,950 --> 00:31:01,300
commands pogo pins are pretty neat their

750
00:30:58,360 --> 00:31:04,360
little like sheath springs so really

751
00:31:01,300 --> 00:31:05,590
<font color="#CCCCCC">good connectivity when you have to plug</font>

752
00:31:04,360 --> 00:31:10,120
something in or take<font color="#E5E5E5"> something out use</font>

753
00:31:05,590 --> 00:31:11,830
them for test rigs I pop it in the

754
00:31:10,120 --> 00:31:14,590
device gets power it's the same implant

755
00:31:11,830 --> 00:31:17,500
as the first one and five seconds later

756
00:31:14,590 --> 00:31:22,240
it goes and writes 02 the GPIO pin and

757
00:31:17,500 --> 00:31:23,680
turns on the device I can<font color="#CCCCCC"> go and use the</font>

758
00:31:22,240 --> 00:31:25,000
controller to turn it back<font color="#E5E5E5"> off because</font>

759
00:31:23,680 --> 00:31:27,640
when i turn it off it's going<font color="#E5E5E5"> to go and</font>

760
00:31:25,000 --> 00:31:31,660
overwrite the GPIO output but pop it out

761
00:31:27,640 --> 00:31:37,150
plug it back in five seconds and we

762
00:31:31,660 --> 00:31:38,560
start beeping again so you know you

763
00:31:37,150 --> 00:31:40,810
could program to be five seconds you

764
00:31:38,560 --> 00:31:42,159
could have it hook up with<font color="#CCCCCC"> a rush radio</font>

765
00:31:40,810 --> 00:31:43,780
so<font color="#E5E5E5"> you have remote control over this</font>

766
00:31:42,160 --> 00:31:46,540
like the other one but<font color="#E5E5E5"> basically we're</font>

767
00:31:43,780 --> 00:31:48,639
using jtag on embedded device to modify

768
00:31:46,540 --> 00:31:55,120
the outputs of the GPIO without the

769
00:31:48,640 --> 00:31:58,330
software really being aware so jate<font color="#CCCCCC"> I</font>

770
00:31:55,120 --> 00:32:00,389
could be disabled it's<font color="#E5E5E5"> usually not test</font>

771
00:31:58,330 --> 00:32:02,620
headers are quick and easy to access

772
00:32:00,390 --> 00:32:05,800
especially<font color="#CCCCCC"> when you line them up right</font>

773
00:32:02,620 --> 00:32:07,810
next to a user replaceable part that can

774
00:32:05,800 --> 00:32:09,460
be swapped in well the system is live

775
00:32:07,810 --> 00:32:11,200
this<font color="#E5E5E5"> is cool because it can be used on</font>

776
00:32:09,460 --> 00:32:12,730
unit in operation whereas the other one

777
00:32:11,200 --> 00:32:14,380
you<font color="#E5E5E5"> actually have to solder and you had</font>

778
00:32:12,730 --> 00:32:15,400
actually open it up and you probably

779
00:32:14,380 --> 00:32:18,010
don't<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> do that while it's on</font>

780
00:32:15,400 --> 00:32:20,410
though you probably could and when you

781
00:32:18,010 --> 00:32:22,629
<font color="#E5E5E5">get jtag working you win that's kind of</font>

782
00:32:20,410 --> 00:32:24,670
my philosophy like<font color="#CCCCCC"> we said before when</font>

783
00:32:22,630 --> 00:32:25,960
<font color="#CCCCCC">you have an embedded system you know and</font>

784
00:32:24,670 --> 00:32:27,730
you<font color="#E5E5E5"> want to talk</font><font color="#CCCCCC"> to solve for people you</font>

785
00:32:25,960 --> 00:32:30,010
have<font color="#E5E5E5"> to speak root shell and translate</font>

786
00:32:27,730 --> 00:32:32,880
for them but on an embedded system like

787
00:32:30,010 --> 00:32:37,320
this you know when you get jtag you win

788
00:32:32,880 --> 00:32:37,320
so the<font color="#E5E5E5"> last implant I have to show</font><font color="#CCCCCC"> you</font>

789
00:32:37,890 --> 00:32:41,800
excuse me<font color="#CCCCCC"> is</font><font color="#E5E5E5"> still a little bit of a</font>

790
00:32:39,760 --> 00:32:42,820
work in progress but<font color="#E5E5E5"> i'll show you would</font>

791
00:32:41,800 --> 00:32:45,700
have done so far<font color="#E5E5E5"> i don't know if you've</font>

792
00:32:42,820 --> 00:32:47,820
noticed<font color="#E5E5E5"> as i'm plugging in my display</font>

793
00:32:45,700 --> 00:32:49,930
adapter that the board falls off because

794
00:32:47,820 --> 00:32:51,889
why would you<font color="#E5E5E5"> have hardware that you</font>

795
00:32:49,930 --> 00:32:54,690
don't take apart

796
00:32:51,889 --> 00:32:56,639
so there's been some presentations and

797
00:32:54,690 --> 00:32:59,249
<font color="#CCCCCC">talked about</font><font color="#E5E5E5"> like evil projection and</font>

798
00:32:56,639 --> 00:33:01,228
evil like video display adapters this is

799
00:32:59,249 --> 00:33:02,789
blinker cough which was part of the<font color="#E5E5E5"> NSA</font>

800
00:33:01,229 --> 00:33:04,470
playset if you see there's a<font color="#E5E5E5"> little</font>

801
00:33:02,789 --> 00:33:06,989
thing sticking out of this vga cable

802
00:33:04,470 --> 00:33:08,279
this component<font color="#E5E5E5"> is inside the cable what</font>

803
00:33:06,989 --> 00:33:09,899
it is is you<font color="#E5E5E5"> would get a bunch of these</font>

804
00:33:08,279 --> 00:33:12,450
cables and use them as<font color="#E5E5E5"> vga and</font><font color="#CCCCCC"> they</font>

805
00:33:09,899 --> 00:33:14,070
create<font color="#E5E5E5"> an</font><font color="#CCCCCC"> IR mesh network so</font><font color="#E5E5E5"> I mean if</font>

806
00:33:12,450 --> 00:33:15,690
you thought<font color="#E5E5E5"> you had a Faraday cage that</font>

807
00:33:14,070 --> 00:33:18,090
was keeping your data inside the cage

808
00:33:15,690 --> 00:33:19,409
but it was<font color="#CCCCCC"> just a wire mesh your</font>

809
00:33:18,090 --> 00:33:21,269
infrared light would actually be

810
00:33:19,409 --> 00:33:23,460
communicating to all vga cables outside

811
00:33:21,269 --> 00:33:26,239
the cage and you can<font color="#CCCCCC"> communicate over I</font>

812
00:33:23,460 --> 00:33:29,669
to see to this device to exfiltrate data

813
00:33:26,239 --> 00:33:33,090
this is alloyed<font color="#E5E5E5"> Viper it looks like</font><font color="#CCCCCC"> a</font>

814
00:33:29,669 --> 00:33:35,099
vga adapter so if just mini displayport

815
00:33:33,090 --> 00:33:36,720
to vga adapter that you might go and

816
00:33:35,099 --> 00:33:38,668
walk up<font color="#CCCCCC"> and say</font><font color="#E5E5E5"> i forgot my adapter but</font>

817
00:33:36,720 --> 00:33:39,779
<font color="#E5E5E5">luckily you have one for me turns out</font>

818
00:33:38,669 --> 00:33:41,399
it's actually<font color="#CCCCCC"> a thunderbolt cable</font>

819
00:33:39,779 --> 00:33:42,960
connected to this<font color="#CCCCCC"> device is slot</font>

820
00:33:41,399 --> 00:33:44,939
screamer which is that<font color="#E5E5E5"> pci express</font>

821
00:33:42,960 --> 00:33:47,129
implant and daisy change to a real

822
00:33:44,940 --> 00:33:48,539
display adapter so you plug it in your

823
00:33:47,129 --> 00:33:50,129
stuff shows up on the screen<font color="#CCCCCC"> you start</font>

824
00:33:48,539 --> 00:33:52,440
presenting with your<font color="#E5E5E5"> unlock pc and</font>

825
00:33:50,129 --> 00:33:53,789
meanwhile someone is under the under the

826
00:33:52,440 --> 00:33:58,229
<font color="#E5E5E5">curtain on behind the podium like</font>

827
00:33:53,789 --> 00:33:59,970
copying your memory so there's you know

828
00:33:58,229 --> 00:34:02,399
display technology changes we<font color="#E5E5E5"> want to</font>

829
00:33:59,970 --> 00:34:03,419
have something new and fancy and you

830
00:34:02,399 --> 00:34:06,299
know this<font color="#CCCCCC"> is right</font><font color="#E5E5E5"> off apple's website</font>

831
00:34:03,419 --> 00:34:09,089
<font color="#E5E5E5">USBC is has the capability to connect</font>

832
00:34:06,299 --> 00:34:10,889
everything you need or the capabilities

833
00:34:09,089 --> 00:34:14,038
who connect anything you put a plug into

834
00:34:10,889 --> 00:34:17,190
your computer to anything it wants so

835
00:34:14,039 --> 00:34:19,230
we've got charging displays storage

836
00:34:17,190 --> 00:34:21,089
devices let's see let's look look what

837
00:34:19,230 --> 00:34:23,039
comes inside so this<font color="#E5E5E5"> is the Apple</font>

838
00:34:21,089 --> 00:34:24,509
adapter it costs eighty dollars it

839
00:34:23,039 --> 00:34:26,190
probably had seventy dollars worth of

840
00:34:24,510 --> 00:34:28,020
shielding that I had to peel off of it

841
00:34:26,190 --> 00:34:29,789
before I could get to it<font color="#E5E5E5"> and I get</font>

842
00:34:28,020 --> 00:34:32,159
inside and there's a giant PCB with a

843
00:34:29,789 --> 00:34:36,480
whole<font color="#CCCCCC"> bunch of stuff luckily there was a</font>

844
00:34:32,159 --> 00:34:37,950
cheap<font color="#CCCCCC"> $20 one that was a lot</font><font color="#E5E5E5"> less</font>

845
00:34:36,480 --> 00:34:40,139
shielding and<font color="#E5E5E5"> just a simple adapter</font>

846
00:34:37,949 --> 00:34:42,210
these are the two apple ones this one is

847
00:34:40,139 --> 00:34:43,829
the<font color="#E5E5E5"> HDMI this one is the vga you'll</font>

848
00:34:42,210 --> 00:34:45,329
<font color="#E5E5E5">notice both of them have a very</font>

849
00:34:43,829 --> 00:34:47,789
interesting connector that we just saw

850
00:34:45,329 --> 00:34:50,609
moments ago think about<font color="#E5E5E5"> this you</font><font color="#CCCCCC"> want to</font>

851
00:34:47,789 --> 00:34:51,839
<font color="#E5E5E5">hook up a display therefore you need to</font>

852
00:34:50,609 --> 00:34:54,418
plug in a device that has a

853
00:34:51,839 --> 00:34:56,609
microcontroller that has a jtag port on

854
00:34:54,418 --> 00:34:58,319
<font color="#CCCCCC">it like this is the world we live in</font>

855
00:34:56,609 --> 00:35:00,869
there's no passive display devices

856
00:34:58,319 --> 00:35:02,700
anymore this is the one that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> normally</font>

857
00:35:00,869 --> 00:35:04,800
use when<font color="#CCCCCC"> i have vga</font>

858
00:35:02,700 --> 00:35:06,598
and you can see right there that big

859
00:35:04,800 --> 00:35:09,869
chip that does the real work that turns

860
00:35:06,599 --> 00:35:12,060
<font color="#CCCCCC">DisplayPort data into vga data USBC has</font>

861
00:35:09,869 --> 00:35:13,740
the ability to transfer raw DisplayPort

862
00:35:12,060 --> 00:35:15,839
data so we're<font color="#E5E5E5"> not sending USB packets</font>

863
00:35:13,740 --> 00:35:17,790
containing display information we're

864
00:35:15,839 --> 00:35:20,430
just spitting out display so this is the

865
00:35:17,790 --> 00:35:22,440
most passive USB you can get us<font color="#E5E5E5"> PC</font>

866
00:35:20,430 --> 00:35:24,029
display you can get but we've also got

867
00:35:22,440 --> 00:35:26,099
this chip over here that's our USB power

868
00:35:24,030 --> 00:35:28,650
delivery chip that's the one<font color="#E5E5E5"> that says</font>

869
00:35:26,099 --> 00:35:31,560
to the<font color="#E5E5E5"> system I'm a low voltage device I</font>

870
00:35:28,650 --> 00:35:33,240
want<font color="#CCCCCC"> five volts at 500 milliamps so</font>

871
00:35:31,560 --> 00:35:37,140
please send<font color="#E5E5E5"> me that voltage so I can do</font>

872
00:35:33,240 --> 00:35:39,000
my<font color="#CCCCCC"> job yeah if it said I want</font><font color="#E5E5E5"> 20 volts</font>

873
00:35:37,140 --> 00:35:42,390
at four amps it would get<font color="#E5E5E5"> that too if</font>

874
00:35:39,000 --> 00:35:44,579
your system supported it the next chip

875
00:35:42,390 --> 00:35:46,259
we've got<font color="#E5E5E5"> over here is a simple like nxp</font>

876
00:35:44,579 --> 00:35:49,079
USB micro controller this is that what

877
00:35:46,260 --> 00:35:51,089
you might find in a small device you

878
00:35:49,079 --> 00:35:54,030
could apply<font color="#CCCCCC"> to be a USB to serial</font>

879
00:35:51,089 --> 00:35:56,940
adapter or something like that or<font color="#E5E5E5"> USB</font>

880
00:35:54,030 --> 00:35:58,950
HID device but the<font color="#E5E5E5"> point is this</font><font color="#CCCCCC"> is a</font>

881
00:35:56,940 --> 00:36:01,800
this is a USB programmable

882
00:35:58,950 --> 00:36:03,779
microcontroller and if you<font color="#E5E5E5"> ever used dfu</font>

883
00:36:01,800 --> 00:36:06,359
you till there's usually some way to

884
00:36:03,780 --> 00:36:08,670
program this microcontroller it just so

885
00:36:06,359 --> 00:36:10,290
happens that this one was configured as

886
00:36:08,670 --> 00:36:11,700
I bought it I opened it up looking for

887
00:36:10,290 --> 00:36:13,770
like a<font color="#E5E5E5"> pin or something that I would</font>

888
00:36:11,700 --> 00:36:14,910
pull to put it in programming mode turns

889
00:36:13,770 --> 00:36:17,670
out<font color="#E5E5E5"> you plug it right in and it's</font>

890
00:36:14,910 --> 00:36:20,069
already in programming mode ok so i plug

891
00:36:17,670 --> 00:36:22,260
this in i hook up my vga adapter I run

892
00:36:20,069 --> 00:36:24,210
dfu util and I can dump<font color="#E5E5E5"> the firmware off</font>

893
00:36:22,260 --> 00:36:25,800
that<font color="#E5E5E5"> microcontroller and then I can go</font>

894
00:36:24,210 --> 00:36:28,410
<font color="#E5E5E5">and update that firmware with that upper</font>

895
00:36:25,800 --> 00:36:29,970
I want so I haven't<font color="#CCCCCC"> done it yet but my</font>

896
00:36:28,410 --> 00:36:33,029
plan is I'm going<font color="#E5E5E5"> to turn this</font><font color="#CCCCCC"> into like</font>

897
00:36:29,970 --> 00:36:35,640
the the malicious present presentation

898
00:36:33,030 --> 00:36:37,710
adapter so you plug this in your slides

899
00:36:35,640 --> 00:36:39,598
go up on<font color="#E5E5E5"> the screen and then randomly</font>

900
00:36:37,710 --> 00:36:42,599
every couple minutes it advances or

901
00:36:39,599 --> 00:36:43,829
reverses the slide for you because might

902
00:36:42,599 --> 00:36:46,380
as<font color="#CCCCCC"> well have fun while you're doing this</font>

903
00:36:43,829 --> 00:36:49,230
stuff when we have one port and that

904
00:36:46,380 --> 00:36:50,790
port can do<font color="#E5E5E5"> anything what sorry if when</font>

905
00:36:49,230 --> 00:36:52,200
we have one port that means that port

906
00:36:50,790 --> 00:36:53,490
has to be able<font color="#E5E5E5"> to do anything when that</font>

907
00:36:52,200 --> 00:36:56,700
port can do anything<font color="#E5E5E5"> that means anything</font>

908
00:36:53,490 --> 00:36:58,560
we plug into it has a pretty strong

909
00:36:56,700 --> 00:37:01,460
power over our system maybe this is<font color="#E5E5E5"> like</font>

910
00:36:58,560 --> 00:37:03,599
the one ring for for the new macbook

911
00:37:01,460 --> 00:37:06,990
hardware isn't just hardware anymore

912
00:37:03,599 --> 00:37:08,700
there are no passive devices there are

913
00:37:06,990 --> 00:37:11,459
no passive cables there's no reasonable

914
00:37:08,700 --> 00:37:14,069
way for a user to look at a device and

915
00:37:11,460 --> 00:37:16,359
know what it does right there's not much

916
00:37:14,069 --> 00:37:18,660
more minimal you could make this adapt

917
00:37:16,359 --> 00:37:21,578
and still have<font color="#CCCCCC"> the right ports on it and</font>

918
00:37:18,660 --> 00:37:25,089
realize that<font color="#CCCCCC"> it's more than just an</font>

919
00:37:21,579 --> 00:37:29,289
adapter so we went through a<font color="#CCCCCC"> couple</font>

920
00:37:25,089 --> 00:37:31,390
implants today we had blind put bridge

921
00:37:29,289 --> 00:37:33,640
excavation using jtag<font color="#E5E5E5"> patched kernels</font>

922
00:37:31,390 --> 00:37:35,618
with DMA we<font color="#E5E5E5"> enabled wireless control of</font>

923
00:37:33,640 --> 00:37:37,660
Norfolk shelf plc and then hot plug to

924
00:37:35,619 --> 00:37:41,859
malicious plc and then<font color="#CCCCCC"> I ranted</font><font color="#E5E5E5"> a bit</font>

925
00:37:37,660 --> 00:37:44,670
about USB these are the all the implants

926
00:37:41,859 --> 00:37:48,308
stacked up on a twenty-dollar bill

927
00:37:44,670 --> 00:37:50,529
solder peak a few dollars less than five

928
00:37:48,309 --> 00:37:53,140
dollars this one which is that the

929
00:37:50,529 --> 00:37:54,940
wireless radio and another mark

930
00:37:53,140 --> 00:37:56,950
patroller is you know another five

931
00:37:54,940 --> 00:38:01,539
dollars this is the one that was plugged

932
00:37:56,950 --> 00:38:03,399
into the USB plug sorry into<font color="#CCCCCC"> the</font>

933
00:38:01,539 --> 00:38:06,130
expansion module for the Phoenix<font color="#E5E5E5"> Contact</font>

934
00:38:03,400 --> 00:38:08,109
one with the pogo pins you know the pogo

935
00:38:06,130 --> 00:38:09,759
pins<font color="#CCCCCC"> apply the most</font><font color="#E5E5E5"> expensive part this</font>

936
00:38:08,109 --> 00:38:11,109
one on<font color="#CCCCCC"> the end is the PCI Express device</font>

937
00:38:09,759 --> 00:38:14,140
that<font color="#E5E5E5"> was probably most expensive it's</font>

938
00:38:11,109 --> 00:38:16,269
about<font color="#CCCCCC"> $67 but still sixty seventy</font>

939
00:38:14,140 --> 00:38:17,828
dollars is not much when you consider

940
00:38:16,269 --> 00:38:20,890
that people think of<font color="#E5E5E5"> this stuff as</font>

941
00:38:17,829 --> 00:38:22,059
nation-state capability so maybe<font color="#E5E5E5"> I</font>

942
00:38:20,890 --> 00:38:25,690
<font color="#CCCCCC">should start selling these for ten</font>

943
00:38:22,059 --> 00:38:30,849
thousand dollars or like 10<font color="#E5E5E5"> million</font>

944
00:38:25,690 --> 00:38:32,289
dollars or Euros but so yeah<font color="#E5E5E5"> they cost</font>

945
00:38:30,849 --> 00:38:33,970
between five and<font color="#CCCCCC"> seventy five dollars</font>

946
00:38:32,289 --> 00:38:36,880
they can be built by hobbyists they

947
00:38:33,970 --> 00:38:38,200
<font color="#E5E5E5">weigh all of them combined oh no no</font>

948
00:38:36,880 --> 00:38:39,220
individually they weigh less than an

949
00:38:38,200 --> 00:38:41,859
ounce is gonna say all<font color="#E5E5E5"> of them combined</font>

950
00:38:39,220 --> 00:38:44,499
they but no they can be customized all

951
00:38:41,859 --> 00:38:46,180
sorts of<font color="#CCCCCC"> different top targets and they</font>

952
00:38:44,499 --> 00:38:48,788
really barely scratch the surface of

953
00:38:46,180 --> 00:38:52,569
what's possible with hardware implants

954
00:38:48,789 --> 00:38:55,029
so hardware is cheap standard interfaces

955
00:38:52,569 --> 00:38:58,450
really are standard automating these

956
00:38:55,029 --> 00:39:00,579
small devices is pretty trivial you know

957
00:38:58,450 --> 00:39:02,618
if you have an interface if you have a

958
00:39:00,579 --> 00:39:04,420
protocol if you have devices that are

959
00:39:02,619 --> 00:39:06,309
meant to speak that<font color="#E5E5E5"> protocol then it's</font>

960
00:39:04,420 --> 00:39:07,420
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> easy to mimic that and create</font>

961
00:39:06,309 --> 00:39:09,700
<font color="#CCCCCC">your own device that's going to speak</font>

962
00:39:07,420 --> 00:39:11,499
the same protocol if you can't trust

963
00:39:09,700 --> 00:39:13,359
<font color="#CCCCCC">with our</font><font color="#E5E5E5"> hardware you can't trust the</font>

964
00:39:11,499 --> 00:39:17,089
software<font color="#E5E5E5"> and if you can control the</font>

965
00:39:13,359 --> 00:39:20,190
hardware you can control the software

966
00:39:17,090 --> 00:39:22,380
so there's a lot<font color="#E5E5E5"> of ranting and a lot of</font>

967
00:39:20,190 --> 00:39:24,680
complaining so what are the solutions we

968
00:39:22,380 --> 00:39:27,660
can't<font color="#E5E5E5"> protect against</font><font color="#CCCCCC"> hardware attacks</font>

969
00:39:24,680 --> 00:39:29,279
some people will<font color="#CCCCCC"> say we can but I don't</font>

970
00:39:27,660 --> 00:39:31,859
<font color="#CCCCCC">believe we can if you own the hardware</font>

971
00:39:29,280 --> 00:39:34,740
<font color="#E5E5E5">and you have unlimited funds you can get</font>

972
00:39:31,860 --> 00:39:36,810
it what you want we can however increase

973
00:39:34,740 --> 00:39:38,549
the cost of attacks and oftentimes a

974
00:39:36,810 --> 00:39:42,090
very<font color="#E5E5E5"> minor increase in the cost of</font>

975
00:39:38,550 --> 00:39:44,160
implementation<font color="#E5E5E5"> disabled jtag don't put</font>

976
00:39:42,090 --> 00:39:46,380
debug ports on your board these things

977
00:39:44,160 --> 00:39:48,089
don't cost that much and they turn it

978
00:39:46,380 --> 00:39:50,070
from a ten-dollar a five dollar attack

979
00:39:48,090 --> 00:39:52,380
into a thousand-dollar attack or a

980
00:39:50,070 --> 00:39:54,270
ten-thousand-dollar attack the other

981
00:39:52,380 --> 00:39:56,010
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> is we really</font><font color="#E5E5E5"> must demand</font>

982
00:39:54,270 --> 00:39:58,500
documented security assumptions from

983
00:39:56,010 --> 00:39:59,910
hardware vendors right if we're buying a

984
00:39:58,500 --> 00:40:02,610
device from a hardware vendor and

985
00:39:59,910 --> 00:40:03,960
they're<font color="#E5E5E5"> telling us this is a PLC this is</font>

986
00:40:02,610 --> 00:40:06,360
a network piece of network equipment

987
00:40:03,960 --> 00:40:09,060
this is a display adapter they should

988
00:40:06,360 --> 00:40:10,980
say to you if<font color="#E5E5E5"> you want this to be secure</font>

989
00:40:09,060 --> 00:40:12,870
you must secure it you must install in a

990
00:40:10,980 --> 00:40:14,820
physically secured area if you want this

991
00:40:12,870 --> 00:40:16,740
to be a secure piece of equipment<font color="#E5E5E5"> you</font>

992
00:40:14,820 --> 00:40:21,050
must make sure<font color="#E5E5E5"> it is or is not connected</font>

993
00:40:16,740 --> 00:40:25,049
<font color="#CCCCCC">to these interfaces when we get</font>

994
00:40:21,050 --> 00:40:27,360
manufacturers and vendors to say what

995
00:40:25,050 --> 00:40:28,830
barracks security expectations are it

996
00:40:27,360 --> 00:40:30,660
<font color="#E5E5E5">actually means they might have actually</font>

997
00:40:28,830 --> 00:40:32,610
thought about them which is<font color="#E5E5E5"> the first</font>

998
00:40:30,660 --> 00:40:34,859
step to starting down<font color="#CCCCCC"> the path of making</font>

999
00:40:32,610 --> 00:40:38,940
this a little more difficult<font color="#CCCCCC"> and</font><font color="#E5E5E5"> a</font>

1000
00:40:34,860 --> 00:40:40,290
little less trivial so going<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> the</font>

1001
00:40:38,940 --> 00:40:42,060
philosophy side of the thing the whole

1002
00:40:40,290 --> 00:40:44,310
philosophy of hardware implants there's

1003
00:40:42,060 --> 00:40:46,080
this story of the three vinegar tasters

1004
00:40:44,310 --> 00:40:48,200
and you know there's lots<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different</font>

1005
00:40:46,080 --> 00:40:50,430
paintings and representations of it but

1006
00:40:48,200 --> 00:40:52,069
Confucius is the first vinegar taste

1007
00:40:50,430 --> 00:40:54,180
<font color="#CCCCCC">around the less and he tastes this</font>

1008
00:40:52,070 --> 00:40:56,670
barrel of vinegar eNOS has a taste sour

1009
00:40:54,180 --> 00:40:58,589
and the vinegar is polluted wine and

1010
00:40:56,670 --> 00:41:01,890
this is representative of a conference

1011
00:40:58,590 --> 00:41:03,360
goer who missed the open bar<font color="#E5E5E5"> Buddha on</font>

1012
00:41:01,890 --> 00:41:05,520
the other hand is in<font color="#E5E5E5"> the middle and he</font>

1013
00:41:03,360 --> 00:41:07,770
tastes<font color="#CCCCCC"> the vin air</font><font color="#E5E5E5"> and he says that it</font>

1014
00:41:05,520 --> 00:41:09,360
tastes bitter and vinegar is bitter so

1015
00:41:07,770 --> 00:41:11,250
it's kind<font color="#E5E5E5"> of makes sense but he says you</font>

1016
00:41:09,360 --> 00:41:13,890
know life is pain and<font color="#E5E5E5"> suffering and</font>

1017
00:41:11,250 --> 00:41:16,860
clearly this is the incident<font color="#E5E5E5"> responder</font>

1018
00:41:13,890 --> 00:41:18,210
right of course<font color="#E5E5E5"> lasse is at the end he</font>

1019
00:41:16,860 --> 00:41:20,400
tastes the vinegar<font color="#CCCCCC"> and he's smiling</font>

1020
00:41:18,210 --> 00:41:23,280
<font color="#E5E5E5">right why is he smiling because he sees</font>

1021
00:41:20,400 --> 00:41:25,140
vinegar for its positive uses clearly he

1022
00:41:23,280 --> 00:41:27,060
was a hardware hacker he goes and he

1023
00:41:25,140 --> 00:41:28,410
<font color="#E5E5E5">gets some salt and peroxide and mixes</font><font color="#CCCCCC"> it</font>

1024
00:41:27,060 --> 00:41:28,770
up with the vinegar and<font color="#E5E5E5"> uses that 2x</font>

1025
00:41:28,410 --> 00:41:33,330
more

1026
00:41:28,770 --> 00:41:46,850
pcbs so that is what i have here<font color="#E5E5E5"> today</font>

1027
00:41:33,330 --> 00:41:51,360
do you have any questions like in<font color="#E5E5E5"> the</font>

1028
00:41:46,850 --> 00:41:55,259
jtech attack how do you<font color="#E5E5E5"> find the right</font>

1029
00:41:51,360 --> 00:41:56,940
address to change so in order to find

1030
00:41:55,260 --> 00:41:58,500
<font color="#E5E5E5">the address</font><font color="#CCCCCC"> that you want to change in</font>

1031
00:41:56,940 --> 00:42:00,930
the jtag attack you have to have prior

1032
00:41:58,500 --> 00:42:03,060
knowledge of<font color="#E5E5E5"> the system for</font><font color="#CCCCCC"> the first</font>

1033
00:42:00,930 --> 00:42:05,549
one the<font color="#E5E5E5"> Galileo I actually found out</font>

1034
00:42:03,060 --> 00:42:07,770
that as I booted it several times the

1035
00:42:05,550 --> 00:42:09,480
process i was looking<font color="#CCCCCC"> to attack only</font>

1036
00:42:07,770 --> 00:42:11,520
ended up at four to five different

1037
00:42:09,480 --> 00:42:13,770
<font color="#E5E5E5">addresses most of the time so for that</font>

1038
00:42:11,520 --> 00:42:16,170
one I just blindly wrote to all five

1039
00:42:13,770 --> 00:42:18,120
addresses and got lucky that I didn't

1040
00:42:16,170 --> 00:42:21,270
destroy anything else in the process for

1041
00:42:18,120 --> 00:42:25,020
the plx the<font color="#E5E5E5"> Phoenix condo sorry the plx</font>

1042
00:42:21,270 --> 00:42:28,710
khaled feat TL<font color="#CCCCCC"> abhava Phoenix Contact</font>

1043
00:42:25,020 --> 00:42:31,200
plc I had the documentation for the chip

1044
00:42:28,710 --> 00:42:33,120
I knew what the<font color="#E5E5E5"> address of the GPIO was</font>

1045
00:42:31,200 --> 00:42:34,379
so I<font color="#E5E5E5"> could just have a simple script</font>

1046
00:42:33,120 --> 00:42:41,580
that would write to that address and be

1047
00:42:34,380 --> 00:42:44,040
done sir bc i do you may similar

1048
00:42:41,580 --> 00:42:45,900
approach you know luckily with a<font color="#E5E5E5"> PCI</font>

1049
00:42:44,040 --> 00:42:47,910
that device is a bit<font color="#E5E5E5"> more capable the</font>

1050
00:42:45,900 --> 00:42:49,800
jtag devices is output only the PCI

1051
00:42:47,910 --> 00:42:51,210
Express device could read and write so

1052
00:42:49,800 --> 00:42:53,670
if I wanted to I<font color="#E5E5E5"> could have it</font>

1053
00:42:51,210 --> 00:42:55,950
programmed to go and read through memory

1054
00:42:53,670 --> 00:42:59,880
find the address find the code<font color="#CCCCCC"> that it</font>

1055
00:42:55,950 --> 00:43:01,939
wants to change and modify it<font color="#CCCCCC"> okay thank</font>

1056
00:42:59,880 --> 00:43:01,940
you

1057
00:43:07,430 --> 00:43:12,930
so jtag is really kind<font color="#E5E5E5"> of damage just a</font>

1058
00:43:10,500 --> 00:43:15,090
state machine and attach that are these

1059
00:43:12,930 --> 00:43:18,450
instructions that<font color="#E5E5E5"> I actually go out and</font>

1060
00:43:15,090 --> 00:43:20,970
do something how do<font color="#E5E5E5"> you map between the</font>

1061
00:43:18,450 --> 00:43:24,509
vendor instruction and reading and

1062
00:43:20,970 --> 00:43:28,410
<font color="#E5E5E5">writing memory so the way</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> did it is I</font>

1063
00:43:24,510 --> 00:43:30,570
used open OCD which worked on the target

1064
00:43:28,410 --> 00:43:32,549
opera target system and I recorded

1065
00:43:30,570 --> 00:43:35,400
everything that happened and turned that

1066
00:43:32,550 --> 00:43:37,080
into an SPF file so I didn't go down to

1067
00:43:35,400 --> 00:43:39,960
<font color="#CCCCCC">the deepest layers of how everything</font>

1068
00:43:37,080 --> 00:43:41,580
worked I just did the the<font color="#E5E5E5"> top layer of</font>

1069
00:43:39,960 --> 00:43:43,680
like I know how to do it from

1070
00:43:41,580 --> 00:43:45,330
prototyping tools and then I<font color="#CCCCCC"> just</font>

1071
00:43:43,680 --> 00:43:47,009
captured a dump and turning this raw

1072
00:43:45,330 --> 00:43:49,890
dump which is probably about a hundred

1073
00:43:47,010 --> 00:43:51,690
times larger than it needed to be but

1074
00:43:49,890 --> 00:43:54,180
did the job I wanted to do if I wanted

1075
00:43:51,690 --> 00:43:55,290
<font color="#CCCCCC">to be more clean and precise I would</font>

1076
00:43:54,180 --> 00:43:56,759
have<font color="#E5E5E5"> gone to the manufacturer</font>

1077
00:43:55,290 --> 00:43:58,680
documentation if they get out exactly

1078
00:43:56,760 --> 00:44:00,540
what steps to<font color="#E5E5E5"> go through</font><font color="#CCCCCC"> to interact</font>

1079
00:43:58,680 --> 00:44:05,009
<font color="#E5E5E5">with the debug registers to do the one</font>

1080
00:44:00,540 --> 00:44:08,430
right<font color="#E5E5E5"> that I actually wanted to do yeah</font>

1081
00:44:05,010 --> 00:44:10,020
handle most of it yes I think there were

1082
00:44:08,430 --> 00:44:11,669
there a couple modifications we made to

1083
00:44:10,020 --> 00:44:13,860
open OCD to make sure<font color="#CCCCCC"> all the data was</font>

1084
00:44:11,670 --> 00:44:18,110
there and then wrote the scripts take

1085
00:44:13,860 --> 00:44:18,110
the raw output log and turn it into svf

1086
00:44:21,170 --> 00:44:24,290
thank you

