1
00:00:00,050 --> 00:00:08,970
[Music]

2
00:00:05,569 --> 00:00:10,500
great to see everyone Thank You Ryan my

3
00:00:08,970 --> 00:00:12,360
name is Kurt Baumgartner I'm a principal

4
00:00:10,500 --> 00:00:14,580
security researcher with Kaspersky Labs

5
00:00:12,360 --> 00:00:16,230
global research and analysis team I've

6
00:00:14,580 --> 00:00:19,170
been working out of Boulder Colorado in

7
00:00:16,230 --> 00:00:21,000
the US since 2010 with the team

8
00:00:19,170 --> 00:00:23,460
today I'd like to talk with you about a

9
00:00:21,000 --> 00:00:26,820
particular group a kind of a curious

10
00:00:23,460 --> 00:00:30,449
subgroup of sofa C activity that we've

11
00:00:26,820 --> 00:00:33,270
been seeing since late 2015 and we've

12
00:00:30,449 --> 00:00:34,469
been pouring out private reports and I

13
00:00:33,270 --> 00:00:38,969
would like to put it sort of an

14
00:00:34,469 --> 00:00:42,149
intelligent perspective on zebra sea its

15
00:00:38,969 --> 00:00:44,969
activity resources malware they show up

16
00:00:42,149 --> 00:00:48,149
in the news every now and then and you

17
00:00:44,969 --> 00:00:53,219
know a lot of the what shows up in the

18
00:00:48,149 --> 00:00:55,800
news is you know people pulling pulling

19
00:00:53,219 --> 00:00:58,440
down samples from public sources and

20
00:00:55,800 --> 00:01:00,510
drawing out implications and in saying

21
00:00:58,440 --> 00:01:01,789
oh this piece of spear fish implies that

22
00:01:00,510 --> 00:01:05,689
they're attacking a certain government

23
00:01:01,789 --> 00:01:08,310
I'm I'm placing this perspective in

24
00:01:05,689 --> 00:01:12,839
firmly in data that we've been pouring

25
00:01:08,310 --> 00:01:17,070
out again and on zebra sea activity that

26
00:01:12,840 --> 00:01:18,990
we've been seeing in the wild so I

27
00:01:17,070 --> 00:01:20,658
wanted to come up with three simple

28
00:01:18,990 --> 00:01:23,280
bullet points to describe these guys

29
00:01:20,659 --> 00:01:25,200
five years of activity hundreds of

30
00:01:23,280 --> 00:01:27,750
targets essentially it's a

31
00:01:25,200 --> 00:01:30,329
russian-speaking abt that that are

32
00:01:27,750 --> 00:01:32,720
specialists in profiling and gaining

33
00:01:30,329 --> 00:01:36,029
access these guys steal credentials and

34
00:01:32,720 --> 00:01:38,880
they maintain their access quietly once

35
00:01:36,030 --> 00:01:40,829
they do that they they they are routed

36
00:01:38,880 --> 00:01:44,310
they have a lineage in something we call

37
00:01:40,829 --> 00:01:47,639
Delphi see that also was a part of a

38
00:01:44,310 --> 00:01:51,869
sofa C project back in 2013 until about

39
00:01:47,640 --> 00:01:54,000
2015 and they share malware artifacts

40
00:01:51,869 --> 00:01:56,130
back then at least the Delphi C project

41
00:01:54,000 --> 00:01:57,960
did with the black energy guys so if

42
00:01:56,130 --> 00:02:00,089
you're familiar with or have heard the

43
00:01:57,960 --> 00:02:04,110
term sandworm they share some

44
00:02:00,090 --> 00:02:08,310
similarities with that group and ongoing

45
00:02:04,110 --> 00:02:11,370
there continues to be overlap with sofa

46
00:02:08,310 --> 00:02:13,849
C and black energy which is interesting

47
00:02:11,370 --> 00:02:13,849
as well

48
00:02:14,510 --> 00:02:19,829
so really what I want to dive into are

49
00:02:17,880 --> 00:02:23,370
some claims and predictions that I made

50
00:02:19,830 --> 00:02:25,590
a little bit of a review from SAS 2018

51
00:02:23,370 --> 00:02:28,770
my my presentation Masha and the Bears

52
00:02:25,590 --> 00:02:31,050
are these bears I want to give you a

53
00:02:28,770 --> 00:02:34,290
timeline of what I see is zebra sea

54
00:02:31,050 --> 00:02:37,740
activity and resources talk about recent

55
00:02:34,290 --> 00:02:40,739
stuff just a week ago or two weeks ago

56
00:02:37,740 --> 00:02:43,160
we saw another spearfishing wave so

57
00:02:40,739 --> 00:02:46,260
these guys are a spear fishing machine

58
00:02:43,160 --> 00:02:48,540
and it's interesting that they are now

59
00:02:46,260 --> 00:02:51,269
using go which is a very portable

60
00:02:48,540 --> 00:02:53,250
language designed by Rob Pike and he's

61
00:02:51,269 --> 00:02:56,489
particularly proud of the machine

62
00:02:53,250 --> 00:02:58,350
generated assembler that he's been

63
00:02:56,489 --> 00:03:01,170
creating and the portability it provides

64
00:02:58,350 --> 00:03:05,060
so that's an interesting note that

65
00:03:01,170 --> 00:03:08,040
they're interested in machine generated

66
00:03:05,060 --> 00:03:10,080
portability really and so and they're

67
00:03:08,040 --> 00:03:12,570
also delivering second-stage implants

68
00:03:10,080 --> 00:03:14,550
which is rarely touched on I don't think

69
00:03:12,570 --> 00:03:16,590
people really understand what's going on

70
00:03:14,550 --> 00:03:19,140
with this group partly because of that

71
00:03:16,590 --> 00:03:21,239
so we'll cover some second-stage

72
00:03:19,140 --> 00:03:24,059
implants we'll talk about the malware

73
00:03:21,239 --> 00:03:28,579
that they've been delivering since 2013

74
00:03:24,060 --> 00:03:31,620
and what to expect for the rest of 2019

75
00:03:28,579 --> 00:03:33,930
so last year I had a presentation

76
00:03:31,620 --> 00:03:36,150
Martian bears if you were fewer there I

77
00:03:33,930 --> 00:03:38,640
love you thank you for coming back

78
00:03:36,150 --> 00:03:42,060
I made some claims last year the

79
00:03:38,640 --> 00:03:43,980
presentation it focused on the second

80
00:03:42,060 --> 00:03:46,730
stage implant that the more traditional

81
00:03:43,980 --> 00:03:55,109
sofa see group has been using SPLM or

82
00:03:46,730 --> 00:03:57,480
ex-agent and really I I claimed that we

83
00:03:55,110 --> 00:03:59,430
had a very interesting finding with sofa

84
00:03:57,480 --> 00:04:01,950
C because they had been changing or

85
00:03:59,430 --> 00:04:05,390
shifting their focused eastward and we

86
00:04:01,950 --> 00:04:09,149
found overlap between gray Lambert

87
00:04:05,390 --> 00:04:15,570
target system in China that was shared

88
00:04:09,150 --> 00:04:20,010
with sofa C's SPLM later at the same

89
00:04:15,570 --> 00:04:23,550
time sofa C's SPLM and ex-agent implant

90
00:04:20,010 --> 00:04:25,500
was withering withering away its use is

91
00:04:23,550 --> 00:04:27,300
totally on the doubt on the decline and

92
00:04:25,500 --> 00:04:31,830
2018

93
00:04:27,300 --> 00:04:34,290
while zebra see activity and and malware

94
00:04:31,830 --> 00:04:38,159
continued to beat on the increase

95
00:04:34,290 --> 00:04:41,910
throughout the globe so some of the

96
00:04:38,160 --> 00:04:45,450
predictions I came up with for 2018 were

97
00:04:41,910 --> 00:04:47,550
pretty simple I I discussed well we're

98
00:04:45,450 --> 00:04:50,159
probably going to see a lot more zebra

99
00:04:47,550 --> 00:04:54,120
see they're effective what they do is

100
00:04:50,160 --> 00:04:56,510
ever see it isn't replacing SPLM

101
00:04:54,120 --> 00:04:59,610
ex-agent activity that's also known for

102
00:04:56,510 --> 00:05:01,380
allegedly the DNC hack and all sorts of

103
00:04:59,610 --> 00:05:05,720
other hacks at governments throughout

104
00:05:01,380 --> 00:05:09,330
the world but SPLM is definitely

105
00:05:05,720 --> 00:05:10,830
disappearing and and at the same time

106
00:05:09,330 --> 00:05:13,859
while they're disappearing they're

107
00:05:10,830 --> 00:05:16,050
they're shifting eastward and zebra sea

108
00:05:13,860 --> 00:05:17,850
might shift eastward as well

109
00:05:16,050 --> 00:05:21,630
and really what ended up happening the

110
00:05:17,850 --> 00:05:24,960
data came in for 2018 2019 and we saw a

111
00:05:21,630 --> 00:05:27,390
massive surge in global zebra sea

112
00:05:24,960 --> 00:05:31,799
activity around September October of

113
00:05:27,390 --> 00:05:34,409
2018 so that was that was accurate SPLM

114
00:05:31,800 --> 00:05:37,230
fell off the map altogether the the last

115
00:05:34,410 --> 00:05:41,160
two targets that I knew of in Malaysia

116
00:05:37,230 --> 00:05:43,980
and Japan are no longer targeted with

117
00:05:41,160 --> 00:05:46,590
SPLM so it's it's kind of a question of

118
00:05:43,980 --> 00:05:49,050
if are they recoding are they are they

119
00:05:46,590 --> 00:05:51,239
just leaving that tool behind or that

120
00:05:49,050 --> 00:05:56,340
implant behind I don't know the answer

121
00:05:51,240 --> 00:06:02,130
to that but we certainly saw them

122
00:05:56,340 --> 00:06:06,630
disappearing so I want to give you a

123
00:06:02,130 --> 00:06:09,659
timeline of zebra sea itself so in

124
00:06:06,630 --> 00:06:13,920
October of 2013 there was this Delphi

125
00:06:09,660 --> 00:06:15,360
thing sophist II was delivering Delphis

126
00:06:13,920 --> 00:06:18,120
II and they were delivering it in

127
00:06:15,360 --> 00:06:21,750
Eastern Europe there was a boot kit that

128
00:06:18,120 --> 00:06:25,020
would install in part a Delphi Delphi

129
00:06:21,750 --> 00:06:28,680
backdoor and this was very unusual to

130
00:06:25,020 --> 00:06:30,599
see Delphi anything from an apt really

131
00:06:28,680 --> 00:06:34,110
the only other actor at the time that I

132
00:06:30,600 --> 00:06:38,100
had focused on was Mahdi an Iranian or a

133
00:06:34,110 --> 00:06:40,710
Persian speaking APD and the back door

134
00:06:38,100 --> 00:06:45,660
showed shared infrastructure

135
00:06:40,710 --> 00:06:47,190
with sofa see so apt 28 infrastructure

136
00:06:45,660 --> 00:06:50,370
and then code

137
00:06:47,190 --> 00:06:55,020
so both hashing functions or hashed IP

138
00:06:50,370 --> 00:06:57,449
api's and sort of this modified or

139
00:06:55,020 --> 00:07:00,419
custom rc4 algorithm which was

140
00:06:57,449 --> 00:07:03,180
specifically only used by Delphis e

141
00:07:00,419 --> 00:07:06,990
kernel-mode loaders and black energy

142
00:07:03,180 --> 00:07:09,300
kernel-mode loaders up until 2015 and

143
00:07:06,990 --> 00:07:12,389
then eventually was resurrected in VPN

144
00:07:09,300 --> 00:07:15,360
filters so there's an ongoing connection

145
00:07:12,389 --> 00:07:20,580
there at in malware artifacts with with

146
00:07:15,360 --> 00:07:23,780
black energy so along comes 2015

147
00:07:20,580 --> 00:07:27,000
Delphis II and that Delphi project of

148
00:07:23,780 --> 00:07:30,690
really whoever's behind it ends so

149
00:07:27,000 --> 00:07:34,320
Delphis II is is done and along comes

150
00:07:30,690 --> 00:07:37,590
zebra see the new zebra see Delphi

151
00:07:34,320 --> 00:07:43,770
package and backdoor shows up in October

152
00:07:37,590 --> 00:07:45,750
of 2015 and the rc4 and the carb air API

153
00:07:43,770 --> 00:07:48,270
hashing that was being used in the

154
00:07:45,750 --> 00:07:49,260
Delphi C packages and black energy as

155
00:07:48,270 --> 00:07:51,448
well

156
00:07:49,260 --> 00:07:54,780
now disappears as well so there's some

157
00:07:51,449 --> 00:07:58,320
sort of split here it's kind of a little

158
00:07:54,780 --> 00:08:00,840
Bang of russian-speaking apt subsets

159
00:07:58,320 --> 00:08:02,760
sofa see goes off there way black energy

160
00:08:00,840 --> 00:08:05,669
goes off there way and now zebra see is

161
00:08:02,760 --> 00:08:08,580
kind of right in the middle there

162
00:08:05,669 --> 00:08:10,198
development really doesn't make huge

163
00:08:08,580 --> 00:08:13,139
leaps and bounds there's twiddling

164
00:08:10,199 --> 00:08:15,900
around with different variants of Delphi

165
00:08:13,139 --> 00:08:19,310
back doors throughout 2015 and 16 and

166
00:08:15,900 --> 00:08:22,460
along in 20 July of 2017 they start

167
00:08:19,310 --> 00:08:25,470
toying or not toying but they start Reed

168
00:08:22,460 --> 00:08:28,888
redeveloping their code in dotnet we see

169
00:08:25,470 --> 00:08:32,310
multiple dotnet deployments throughout

170
00:08:28,889 --> 00:08:34,610
2017 and 2018 and then eventually we

171
00:08:32,309 --> 00:08:36,779
start seeing them pushing things with go

172
00:08:34,610 --> 00:08:40,919
multiple overlaps with black energy

173
00:08:36,779 --> 00:08:44,250
infrastructure and spearfishing activity

174
00:08:40,919 --> 00:08:46,740
and these massive new waves along with

175
00:08:44,250 --> 00:08:48,360
activity we're seeing even in the past

176
00:08:46,740 --> 00:08:52,740
couple weeks from these guys where

177
00:08:48,360 --> 00:08:53,960
they're downloading a huge 5 Meg DLL

178
00:08:52,740 --> 00:08:57,590
that's another read

179
00:08:53,960 --> 00:09:03,410
right of their Commons ever see payload

180
00:08:57,590 --> 00:09:06,560
code so um so again I want to I want to

181
00:09:03,410 --> 00:09:08,810
say that the the implant the zebra see

182
00:09:06,560 --> 00:09:13,660
implant as we know it really showed up

183
00:09:08,810 --> 00:09:16,550
in December to or October of 2015 and

184
00:09:13,660 --> 00:09:19,670
while it's rooted in sofa CE and shared

185
00:09:16,550 --> 00:09:22,550
sofa scenes for infrastructure and we

186
00:09:19,670 --> 00:09:24,800
considered a subset of sofa see it's

187
00:09:22,550 --> 00:09:29,449
very different from previous sofa see

188
00:09:24,800 --> 00:09:31,849
efforts so to date we've seen modules

189
00:09:29,450 --> 00:09:34,940
developed in auto IT Delphi c-sharp

190
00:09:31,850 --> 00:09:36,170
PowerShell going and I don't know what

191
00:09:34,940 --> 00:09:39,710
we're gonna see this year but I would

192
00:09:36,170 --> 00:09:43,310
assume we might see some rust some are

193
00:09:39,710 --> 00:09:45,230
some Python and I look at Python and I

194
00:09:43,310 --> 00:09:49,099
think most likely they'll look at Python

195
00:09:45,230 --> 00:09:53,480
because it's the most discussed and

196
00:09:49,100 --> 00:09:55,340
produced code on stack overflow one of

197
00:09:53,480 --> 00:09:58,460
the things about this particular apt

198
00:09:55,340 --> 00:10:00,830
that's very unusual when you come from a

199
00:09:58,460 --> 00:10:03,680
lineage of sofas see and black energy -

200
00:10:00,830 --> 00:10:07,760
very capable technically capable actors

201
00:10:03,680 --> 00:10:10,280
is that they rip they rip off coding

202
00:10:07,760 --> 00:10:13,330
projects every chance they get and it's

203
00:10:10,280 --> 00:10:17,420
almost as though this is machine guided

204
00:10:13,330 --> 00:10:19,820
they they will copy and paste portions

205
00:10:17,420 --> 00:10:22,430
of their backdoor recompile it and send

206
00:10:19,820 --> 00:10:24,260
it out to additional targets which I'll

207
00:10:22,430 --> 00:10:26,300
come back to that's interesting but

208
00:10:24,260 --> 00:10:28,760
that's something we didn't see with sofa

209
00:10:26,300 --> 00:10:32,420
C and there's sort of elegant exhaustive

210
00:10:28,760 --> 00:10:34,400
C code base in X agent and certainly not

211
00:10:32,420 --> 00:10:36,680
we we saw with the black energy guys and

212
00:10:34,400 --> 00:10:41,060
the code they deployed during their

213
00:10:36,680 --> 00:10:45,699
wiping efforts in 2014 and they're

214
00:10:41,060 --> 00:10:50,180
destructive efforts in Ukraine in 2015

215
00:10:45,700 --> 00:10:52,460
so why don't I start with something very

216
00:10:50,180 --> 00:10:54,410
recent in the past couple of weeks these

217
00:10:52,460 --> 00:10:58,970
guys sent out another small wave of

218
00:10:54,410 --> 00:11:01,280
Spearfish it's it's the usual stuff it's

219
00:10:58,970 --> 00:11:06,200
the name of the game again for these

220
00:11:01,280 --> 00:11:07,640
guys is profiling targets and then

221
00:11:06,200 --> 00:11:10,490
gaining access

222
00:11:07,640 --> 00:11:16,160
maintaining that access so they go about

223
00:11:10,490 --> 00:11:18,080
that by identifying the volume serial

224
00:11:16,160 --> 00:11:20,270
number of the system there they're

225
00:11:18,080 --> 00:11:22,640
running on and they maintain that as a

226
00:11:20,270 --> 00:11:25,040
unique ID for that system then they

227
00:11:22,640 --> 00:11:26,990
identify system information they gather

228
00:11:25,040 --> 00:11:29,089
everything they can about it a running

229
00:11:26,990 --> 00:11:30,830
process list and a screen shot that kind

230
00:11:29,090 --> 00:11:34,280
of anchors in time when they were first

231
00:11:30,830 --> 00:11:36,050
on the machine the running process list

232
00:11:34,280 --> 00:11:38,900
is going to be interesting later when it

233
00:11:36,050 --> 00:11:42,439
comes to the second stage implants but

234
00:11:38,900 --> 00:11:43,970
this is the this is their playbook

235
00:11:42,440 --> 00:11:47,150
they do this in order to steal

236
00:11:43,970 --> 00:11:49,730
credentials if the if the system is of

237
00:11:47,150 --> 00:11:52,939
further interest to them and again

238
00:11:49,730 --> 00:11:56,840
they're active and they're redeveloping

239
00:11:52,940 --> 00:11:58,640
the the the go code and the the code

240
00:11:56,840 --> 00:12:00,550
base is actually getting larger because

241
00:11:58,640 --> 00:12:04,760
they're adding AES and other

242
00:12:00,550 --> 00:12:10,160
cryptography modules and code to their

243
00:12:04,760 --> 00:12:11,720
to their malware every now in the news

244
00:12:10,160 --> 00:12:14,829
you might see that oh there are a couple

245
00:12:11,720 --> 00:12:18,560
of variants of there are two variants of

246
00:12:14,830 --> 00:12:20,690
zebra see and with the go code you can

247
00:12:18,560 --> 00:12:24,079
see multiple project strings over the

248
00:12:20,690 --> 00:12:27,500
past year functions are added and

249
00:12:24,080 --> 00:12:29,510
removed from this module per target so

250
00:12:27,500 --> 00:12:31,640
on almost on a case-by-case basis

251
00:12:29,510 --> 00:12:33,819
they are recreating and recoating new

252
00:12:31,640 --> 00:12:39,290
variants and this is just the goal

253
00:12:33,820 --> 00:12:41,450
module let alone auto IT Delphi all the

254
00:12:39,290 --> 00:12:43,880
other stuff so there are certainly more

255
00:12:41,450 --> 00:12:46,190
than two variants of zebra see these

256
00:12:43,880 --> 00:12:47,780
guys are very active and they continue

257
00:12:46,190 --> 00:12:50,330
to be very active it also might suggest

258
00:12:47,780 --> 00:12:52,420
to you that they're fairly effective at

259
00:12:50,330 --> 00:12:55,280
what they're doing if there's so much

260
00:12:52,420 --> 00:13:01,069
resource being put into maintaining this

261
00:12:55,280 --> 00:13:03,589
code set so when you see them delivering

262
00:13:01,070 --> 00:13:05,510
second stage implants things become a

263
00:13:03,590 --> 00:13:07,460
little more interesting because it does

264
00:13:05,510 --> 00:13:09,800
tell you what they're what they're

265
00:13:07,460 --> 00:13:12,740
really focused on the second stage

266
00:13:09,800 --> 00:13:14,900
implants are always in relation to the

267
00:13:12,740 --> 00:13:17,300
the list of running processes that

268
00:13:14,900 --> 00:13:19,550
they've pulled off a machine so if they

269
00:13:17,300 --> 00:13:21,000
haven't delivered something in the first

270
00:13:19,550 --> 00:13:23,069
stage

271
00:13:21,000 --> 00:13:26,939
of code that they've spear fished a

272
00:13:23,069 --> 00:13:30,769
target with they'll see the process list

273
00:13:26,939 --> 00:13:35,040
coming back to them and in in some cases

274
00:13:30,769 --> 00:13:38,370
there are these Asian custom builds of

275
00:13:35,040 --> 00:13:40,649
chromium sent browsers seven-star they

276
00:13:38,370 --> 00:13:43,220
go after Yandex but they send down these

277
00:13:40,649 --> 00:13:46,139
second stage implants to gather up

278
00:13:43,220 --> 00:13:48,149
credential stores from these additional

279
00:13:46,139 --> 00:13:50,250
browsers and again that's what they're

280
00:13:48,149 --> 00:13:53,310
after they're after credentials and

281
00:13:50,250 --> 00:13:55,500
maintaining access quietly so later on

282
00:13:53,310 --> 00:13:56,878
it's going to be very difficult to see

283
00:13:55,500 --> 00:13:59,459
these guys because they're living off

284
00:13:56,879 --> 00:14:02,730
the land or they're coming back with

285
00:13:59,459 --> 00:14:05,638
credentials to monitor email accounts

286
00:14:02,730 --> 00:14:07,829
communications that sort of thing they

287
00:14:05,639 --> 00:14:09,959
they've delivered second stage implants

288
00:14:07,829 --> 00:14:13,008
for common email clients like Outlook

289
00:14:09,959 --> 00:14:17,810
and Thunderbird and others as well and

290
00:14:13,009 --> 00:14:21,029
then finally in 2000 I think it was in

291
00:14:17,810 --> 00:14:25,699
2017 they they started delivering sort

292
00:14:21,029 --> 00:14:27,809
of this unexpected file content c-sharp

293
00:14:25,699 --> 00:14:33,870
stealer

294
00:14:27,809 --> 00:14:36,149
we called it Kofa C and essentially when

295
00:14:33,870 --> 00:14:38,430
a network drive or USB stick would be

296
00:14:36,149 --> 00:14:40,949
plugged in or added to the system it

297
00:14:38,430 --> 00:14:44,099
would identify files less than 60 Meg

298
00:14:40,949 --> 00:14:46,550
and certain types of content based on

299
00:14:44,100 --> 00:14:49,829
file extensions and start copying across

300
00:14:46,550 --> 00:14:52,500
that data it this is unusual for this

301
00:14:49,829 --> 00:14:54,809
group they don't do a lot of file copies

302
00:14:52,500 --> 00:14:56,870
the capable capability is there but for

303
00:14:54,809 --> 00:14:59,809
the most part they're looking looking at

304
00:14:56,870 --> 00:15:02,779
stealing credentials and then finally

305
00:14:59,809 --> 00:15:05,399
the c-sharp logger they added four

306
00:15:02,779 --> 00:15:10,800
generic credential stealing across all

307
00:15:05,399 --> 00:15:14,730
these software packages so I mentioned

308
00:15:10,800 --> 00:15:16,800
in December of 2000 5000 BER of 2015

309
00:15:14,730 --> 00:15:20,550
again that's that was our first sighting

310
00:15:16,800 --> 00:15:24,029
of zebra C and the zebra C payload auto

311
00:15:20,550 --> 00:15:26,370
IT well an auto IT compiled executable

312
00:15:24,029 --> 00:15:31,019
was what they first spear fished the

313
00:15:26,370 --> 00:15:34,230
target with the the auto IT script and

314
00:15:31,019 --> 00:15:34,750
its original sort of process flow or

315
00:15:34,230 --> 00:15:38,020
control

316
00:15:34,750 --> 00:15:41,020
flow is recoded again and again in

317
00:15:38,020 --> 00:15:43,060
delphi and go and other modules and

318
00:15:41,020 --> 00:15:44,860
essentially this type of functionality

319
00:15:43,060 --> 00:15:47,020
is what they want to deliver to a system

320
00:15:44,860 --> 00:15:49,590
every time so they capture that well

321
00:15:47,020 --> 00:15:52,449
first they get the volume information a

322
00:15:49,590 --> 00:15:54,910
serial number from the hard drive and

323
00:15:52,450 --> 00:15:56,860
then they perform a screen capture they

324
00:15:54,910 --> 00:15:59,560
gather up system system information

325
00:15:56,860 --> 00:16:01,660
there's a process list call here that

326
00:15:59,560 --> 00:16:02,949
gives them a list of processes so they

327
00:16:01,660 --> 00:16:04,449
can identify whether or not they're

328
00:16:02,950 --> 00:16:07,570
missing out on credentials from an

329
00:16:04,450 --> 00:16:10,120
unexpected software package and and then

330
00:16:07,570 --> 00:16:12,330
some other some other functionality as

331
00:16:10,120 --> 00:16:12,330
well

332
00:16:12,720 --> 00:16:19,150
I've been asked several times why we

333
00:16:14,980 --> 00:16:21,970
don't call it Z kabab in April of 2016 I

334
00:16:19,150 --> 00:16:23,380
believe is when this URL came about our

335
00:16:21,970 --> 00:16:25,720
research had been ongoing and had

336
00:16:23,380 --> 00:16:28,090
connected these guys with Delphis II

337
00:16:25,720 --> 00:16:29,920
before then so we were calling it zebra

338
00:16:28,090 --> 00:16:33,400
C by this point but that's really where

339
00:16:29,920 --> 00:16:35,829
it this came from an individual was

340
00:16:33,400 --> 00:16:38,550
spear fish who works in a fairly

341
00:16:35,830 --> 00:16:42,690
bureaucratic organization related to

342
00:16:38,550 --> 00:16:45,640
visa applications and other things and

343
00:16:42,690 --> 00:16:48,520
and that the malware reached out to that

344
00:16:45,640 --> 00:16:51,339
URL to pull down further Delphi

345
00:16:48,520 --> 00:16:55,449
backdoors but we're sticking with zebra

346
00:16:51,339 --> 00:16:58,420
see the Delphi backdoors that these guys

347
00:16:55,450 --> 00:17:00,490
code up add and removes functionality

348
00:16:58,420 --> 00:17:02,469
over time but usually it's over a dozen

349
00:17:00,490 --> 00:17:05,280
maybe 16 different functions that they

350
00:17:02,470 --> 00:17:09,160
maintain within these backdoors to again

351
00:17:05,280 --> 00:17:10,770
maintain access sometimes do some level

352
00:17:09,160 --> 00:17:16,060
of

353
00:17:10,770 --> 00:17:18,400
file file theft but generally they're

354
00:17:16,060 --> 00:17:20,198
going to pull down a second stage

355
00:17:18,400 --> 00:17:23,560
implant or and run it with something

356
00:17:20,199 --> 00:17:26,439
like this there's c-sharp

357
00:17:23,560 --> 00:17:28,329
they made incremental changes to their

358
00:17:26,439 --> 00:17:29,770
code but again it's kind of the same

359
00:17:28,329 --> 00:17:32,800
stuff they're collecting system

360
00:17:29,770 --> 00:17:35,650
information volume serial number the

361
00:17:32,800 --> 00:17:38,530
task list and then a screen shot this is

362
00:17:35,650 --> 00:17:40,570
c-sharp their c-sharp code for gathering

363
00:17:38,530 --> 00:17:42,490
screenshots from a system and anchoring

364
00:17:40,570 --> 00:17:47,280
sort of when they first get on that

365
00:17:42,490 --> 00:17:50,220
system in time it has multiple variants

366
00:17:47,280 --> 00:17:52,930
where they are

367
00:17:50,220 --> 00:17:54,490
grabbing up the serial number

368
00:17:52,930 --> 00:17:56,470
information for example it with a

369
00:17:54,490 --> 00:17:58,420
different function so they are

370
00:17:56,470 --> 00:18:02,370
constantly sort of tweaking and trying

371
00:17:58,420 --> 00:18:08,280
to improve what their malware is doing

372
00:18:02,370 --> 00:18:11,370
there c-sharp modules in 2017 included

373
00:18:08,280 --> 00:18:13,840
network file stealers key loggers and

374
00:18:11,370 --> 00:18:15,870
eventually the Canon backdoor which has

375
00:18:13,840 --> 00:18:18,699
gotten quite a bit of public coverage

376
00:18:15,870 --> 00:18:21,370
again this is very unusual and different

377
00:18:18,700 --> 00:18:23,260
from previous sofa C activity that we've

378
00:18:21,370 --> 00:18:26,800
seen they don't crank out modules like

379
00:18:23,260 --> 00:18:29,740
this they don't modify make incremental

380
00:18:26,800 --> 00:18:33,520
changes and have sort of this agile

381
00:18:29,740 --> 00:18:40,300
style in multiple languages like like

382
00:18:33,520 --> 00:18:43,270
these guys do so the Delphi I want to I

383
00:18:40,300 --> 00:18:47,050
want to step back again to the Delphi

384
00:18:43,270 --> 00:18:49,420
package so the Delphi has ever see that

385
00:18:47,050 --> 00:18:56,770
we originally saw that Delphi payload

386
00:18:49,420 --> 00:18:59,500
has its roots in Delphi C and late 2013

387
00:18:56,770 --> 00:19:02,350
is when we initially saw this sofa C

388
00:18:59,500 --> 00:19:06,430
boot kit and that boot kit in turn was

389
00:19:02,350 --> 00:19:09,550
used to load a delphi backdoor Delphis e

390
00:19:06,430 --> 00:19:12,610
and black energy shared a very unique

391
00:19:09,550 --> 00:19:15,970
function for about two years and then

392
00:19:12,610 --> 00:19:18,969
when zebra see at the in October of 2015

393
00:19:15,970 --> 00:19:21,970
one's ever see itself took off when that

394
00:19:18,970 --> 00:19:24,700
project took off then this at this

395
00:19:21,970 --> 00:19:26,320
custom rc4 just disappeared I've

396
00:19:24,700 --> 00:19:28,540
searched through multiple collections

397
00:19:26,320 --> 00:19:31,929
looking for that function and there are

398
00:19:28,540 --> 00:19:34,300
about 12 black energy modules and a few

399
00:19:31,930 --> 00:19:36,610
Delphis e kernel modules that maintain

400
00:19:34,300 --> 00:19:44,139
that unusual

401
00:19:36,610 --> 00:19:47,080
rc4 code so again this this is kind of

402
00:19:44,140 --> 00:19:51,820
circumstantial stuff but I really do

403
00:19:47,080 --> 00:19:56,590
believe that got it that it ties

404
00:19:51,820 --> 00:19:58,470
together the the the the groups and the

405
00:19:56,590 --> 00:20:02,129
lineage and sort of this break in

406
00:19:58,470 --> 00:20:02,130
October 2015

407
00:20:02,579 --> 00:20:09,519
another thing that ties together is

408
00:20:05,949 --> 00:20:14,349
embassy with sofa see early on this is

409
00:20:09,519 --> 00:20:16,239
early 2016 this is 2015 was some Whois

410
00:20:14,349 --> 00:20:18,668
data we were able to collect on one of

411
00:20:16,239 --> 00:20:20,409
the only domains that they had used in

412
00:20:18,669 --> 00:20:24,039
their lineup so they were spearfishing

413
00:20:20,409 --> 00:20:26,919
people with an auto IT payload they

414
00:20:24,039 --> 00:20:28,149
downloaded that pail they downloaded or

415
00:20:26,919 --> 00:20:30,429
I should say they they were spear

416
00:20:28,149 --> 00:20:32,948
fishing with an auto IT executable which

417
00:20:30,429 --> 00:20:37,239
in turn downloaded a Delphi backdoor and

418
00:20:32,949 --> 00:20:39,159
that called back to Rome Attica comm GDP

419
00:20:37,239 --> 00:20:42,099
GDP our has redacted Whois information

420
00:20:39,159 --> 00:20:43,779
but we know because of the Whois

421
00:20:42,099 --> 00:20:46,928
information on the same day with the

422
00:20:43,779 --> 00:20:49,509
same ailment email account the zebra see

423
00:20:46,929 --> 00:20:53,979
guys created rheumatica and Ravis 10.com

424
00:20:49,509 --> 00:20:57,309
and this this domain was hosted on an IP

425
00:20:53,979 --> 00:21:00,999
address that maintained and hosted

426
00:20:57,309 --> 00:21:03,399
multiple sofa see known sofa see domains

427
00:21:00,999 --> 00:21:07,779
so this isn't exactly a loose connection

428
00:21:03,399 --> 00:21:10,389
this is this is a fairly solid

429
00:21:07,779 --> 00:21:12,699
connection we know that they were

430
00:21:10,389 --> 00:21:18,369
sharing infrastructure in the early days

431
00:21:12,699 --> 00:21:21,489
of the project so another unusual thing

432
00:21:18,369 --> 00:21:24,129
that has come up out of this I wanted to

433
00:21:21,489 --> 00:21:29,229
take a look at the the flashy new

434
00:21:24,129 --> 00:21:32,228
decompiler and this is the the custom

435
00:21:29,229 --> 00:21:34,619
rc4 implementation that the decompiler

436
00:21:32,229 --> 00:21:37,839
spits out and what the code looks like

437
00:21:34,619 --> 00:21:40,688
and again the two thousand two two

438
00:21:37,839 --> 00:21:43,448
thousand 2013 to 2015

439
00:21:40,689 --> 00:21:46,929
timing and the usage and the sort of end

440
00:21:43,449 --> 00:21:53,529
of this code again ties together as ever

441
00:21:46,929 --> 00:21:55,089
see with both black energy and sofa c as

442
00:21:53,529 --> 00:21:57,129
ever see in practice so what we're

443
00:21:55,089 --> 00:21:59,469
seeing what we're seeing ongoing are

444
00:21:57,129 --> 00:22:01,389
multiple waves of Spearfish ongoing

445
00:21:59,469 --> 00:22:03,009
innovation we see them bringing in

446
00:22:01,389 --> 00:22:04,629
multiple languages and making tweaks

447
00:22:03,009 --> 00:22:07,749
here and there they're innovative

448
00:22:04,629 --> 00:22:09,849
they're not inventing something new but

449
00:22:07,749 --> 00:22:13,490
they're very innovative they're

450
00:22:09,849 --> 00:22:16,490
consistently they're OPSEC is very good

451
00:22:13,490 --> 00:22:18,740
they hide behind VPNs cryptocurrency

452
00:22:16,490 --> 00:22:23,090
when handling their infrastructure so

453
00:22:18,740 --> 00:22:24,590
this is which is fairly common for these

454
00:22:23,090 --> 00:22:25,939
types of groups but they are very

455
00:22:24,590 --> 00:22:27,620
consistent very good at what they're

456
00:22:25,940 --> 00:22:29,840
doing they have a stable and separate

457
00:22:27,620 --> 00:22:33,320
infrastructure now from the actual sofa

458
00:22:29,840 --> 00:22:35,959
see infrastructure and they continued to

459
00:22:33,320 --> 00:22:39,169
you to move towards better encryption

460
00:22:35,960 --> 00:22:44,570
strategies within their infrastructure

461
00:22:39,170 --> 00:22:45,890
and communications so next up what do I

462
00:22:44,570 --> 00:22:48,470
think we're going to see for the rest of

463
00:22:45,890 --> 00:22:50,570
2019 well we're going to continue to see

464
00:22:48,470 --> 00:22:51,830
spearfishing from from these guys that's

465
00:22:50,570 --> 00:22:54,850
the name of the game they're a

466
00:22:51,830 --> 00:22:57,500
spearfishing machine that gains access

467
00:22:54,850 --> 00:23:00,560
compromises boxes maintains that access

468
00:22:57,500 --> 00:23:02,480
in Steel's credentials I

469
00:23:00,560 --> 00:23:05,750
I predict that they're going to move

470
00:23:02,480 --> 00:23:07,430
possibly to Python Ruby are something

471
00:23:05,750 --> 00:23:10,040
new another managed language or

472
00:23:07,430 --> 00:23:12,380
scripting language that makes

473
00:23:10,040 --> 00:23:17,840
incremental changes and rewriting

474
00:23:12,380 --> 00:23:21,290
backdoors quick easy agile and I don't

475
00:23:17,840 --> 00:23:23,030
think we'll see Mimi Katz but we because

476
00:23:21,290 --> 00:23:25,220
we haven't been seeing Mimi Katz with

477
00:23:23,030 --> 00:23:27,320
these guys which is really odd for a

478
00:23:25,220 --> 00:23:29,570
group so interested in credential

479
00:23:27,320 --> 00:23:32,899
stealing but we will continue to see

480
00:23:29,570 --> 00:23:34,399
more credential stealing code rips from

481
00:23:32,900 --> 00:23:37,310
these guys being implemented and

482
00:23:34,400 --> 00:23:39,410
deployed a second stage implants and in

483
00:23:37,310 --> 00:23:41,690
the spirit of sort of the ghost in the

484
00:23:39,410 --> 00:23:43,430
shell' theme here I want to at least

485
00:23:41,690 --> 00:23:45,800
bring up one possibility about what's

486
00:23:43,430 --> 00:23:48,920
really going on because when you have a

487
00:23:45,800 --> 00:23:50,870
group a subgroup like zebra sea that's

488
00:23:48,920 --> 00:23:53,270
rooted in a technically advanced and

489
00:23:50,870 --> 00:23:55,280
capable group like sofa sea and black

490
00:23:53,270 --> 00:23:57,440
energy it makes me think something is

491
00:23:55,280 --> 00:24:00,530
going on behind the scenes that's a lot

492
00:23:57,440 --> 00:24:02,950
more interesting than these guys just

493
00:24:00,530 --> 00:24:04,910
ripping code and sending it out

494
00:24:02,950 --> 00:24:06,620
potentially we have some machine

495
00:24:04,910 --> 00:24:08,390
learning going on here that is

496
00:24:06,620 --> 00:24:12,129
maintaining some level of effectiveness

497
00:24:08,390 --> 00:24:15,080
for these guys we know that the DoD

498
00:24:12,130 --> 00:24:17,030
completed a grant where machines are

499
00:24:15,080 --> 00:24:20,090
performing coding and programming for

500
00:24:17,030 --> 00:24:22,010
themselves quite possibly these guys are

501
00:24:20,090 --> 00:24:26,570
have some sort of machine learning

502
00:24:22,010 --> 00:24:28,299
guided development process going on

503
00:24:26,570 --> 00:24:30,320
and they're they're ripping code and

504
00:24:28,299 --> 00:24:36,350
implementing re implementing things

505
00:24:30,320 --> 00:24:38,658
based on that advice so that's that's

506
00:24:36,350 --> 00:24:41,709
all I have for today and I'm gonna wrap

507
00:24:38,659 --> 00:24:47,160
it up I thank you for your time good

508
00:24:41,710 --> 00:24:47,160
[Applause]

