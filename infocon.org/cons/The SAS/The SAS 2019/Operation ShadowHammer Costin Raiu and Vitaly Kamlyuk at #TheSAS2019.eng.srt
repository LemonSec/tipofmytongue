1
00:00:00,050 --> 00:00:08,340
[Music]

2
00:00:05,480 --> 00:00:11,040
now me to introduce myself

3
00:00:08,340 --> 00:00:13,889
names see I'm Kendall the leader around

4
00:00:11,040 --> 00:00:17,130
here in great they serve my very good

5
00:00:13,889 --> 00:00:19,500
friends a B and C they're very brainy

6
00:00:17,130 --> 00:00:24,660
it's like they got two brains instead of

7
00:00:19,500 --> 00:00:26,880
hints I'm made of rocks as you can see

8
00:00:24,660 --> 00:00:28,830
but don't let that intimidate you unless

9
00:00:26,880 --> 00:00:33,740
you made of scissors that's a rock

10
00:00:28,830 --> 00:00:33,739
scissors paper job for you all right

11
00:00:34,550 --> 00:00:40,800
you know I tried to start a revolution

12
00:00:37,879 --> 00:00:42,930
but didn't print enough painful it's so

13
00:00:40,800 --> 00:00:51,870
hardly anyone showed up except for one

14
00:00:42,930 --> 00:00:55,019
in his girlfriend her great as a

15
00:00:51,870 --> 00:00:57,510
punishment I was sent to Singapore to

16
00:00:55,020 --> 00:01:02,070
make a speech here it's us a bit of a

17
00:00:57,510 --> 00:01:04,110
promotional disaster that one but now I

18
00:01:02,070 --> 00:01:05,850
trying to start another revolution if

19
00:01:04,110 --> 00:01:09,110
you'd be interested to I reckon you'd be

20
00:01:05,850 --> 00:01:14,100
interested yes all right

21
00:01:09,110 --> 00:01:17,158
the supply-chain revolution all right so

22
00:01:14,100 --> 00:01:19,919
one day I was sitting in my office and

23
00:01:17,159 --> 00:01:24,270
Bucharest watching oh I mean working

24
00:01:19,920 --> 00:01:25,979
working on thor ragnarok not watching it

25
00:01:24,270 --> 00:01:26,850
but in case you're wondering what that

26
00:01:25,979 --> 00:01:30,150
was about

27
00:01:26,850 --> 00:01:33,270
that's from Touareg never so across from

28
00:01:30,150 --> 00:01:35,970
me that's my colleague Dan and as I'm

29
00:01:33,270 --> 00:01:38,780
very busy watching the movie dance phone

30
00:01:35,970 --> 00:01:42,329
is making like this annoying sounds I

31
00:01:38,780 --> 00:01:46,229
and I'm like hey Dan and he was like

32
00:01:42,329 --> 00:01:48,419
nothing hey Dan nothing like hey Dan and

33
00:01:46,229 --> 00:01:52,979
he ho what what's up with your phone

34
00:01:48,420 --> 00:01:55,229
he's like yeah is like ridet and I'm

35
00:01:52,979 --> 00:01:58,469
like what's reddit it's like you know

36
00:01:55,229 --> 00:02:00,750
it's like Twitter but it's red oh okay

37
00:01:58,469 --> 00:02:02,669
so what's up with this reddit so we look

38
00:02:00,750 --> 00:02:04,439
there and we see like different people

39
00:02:02,670 --> 00:02:06,299
he's like yeah this is for young people

40
00:02:04,439 --> 00:02:09,538
like me not for like people like you oh

41
00:02:06,299 --> 00:02:13,080
all right so what's on reddit so I look

42
00:02:09,538 --> 00:02:13,649
there there's like one guy posting down

43
00:02:13,080 --> 00:02:17,730
this

44
00:02:13,650 --> 00:02:21,319
the red twitter thingy like new critical

45
00:02:17,730 --> 00:02:23,790
update available for your computer

46
00:02:21,319 --> 00:02:25,619
alright and the only thing is that he

47
00:02:23,790 --> 00:02:27,480
says it's kind of strange it tries to

48
00:02:25,620 --> 00:02:30,870
make a mystery update but there's

49
00:02:27,480 --> 00:02:32,390
basically nothing in there and then

50
00:02:30,870 --> 00:02:35,670
immediately you know people start

51
00:02:32,390 --> 00:02:37,529
sharing their opinions and one guy says

52
00:02:35,670 --> 00:02:39,958
hey yeah yeah me too me too I had the

53
00:02:37,530 --> 00:02:41,489
same error in my computer and another

54
00:02:39,959 --> 00:02:44,340
guy says yes and I uploaded to

55
00:02:41,489 --> 00:02:47,220
virustotal and guess what it has zero

56
00:02:44,340 --> 00:02:49,980
detections so probably it's fine and

57
00:02:47,220 --> 00:02:51,810
then another guy says but yeah but still

58
00:02:49,980 --> 00:02:55,170
it's suspicious because it's called a

59
00:02:51,810 --> 00:02:57,030
Sousa force force updater

60
00:02:55,170 --> 00:03:02,040
and then another guy that's probably

61
00:02:57,030 --> 00:03:03,950
because Isis is a German company the

62
00:03:02,040 --> 00:03:06,629
wisdom of the read Twitter

63
00:03:03,950 --> 00:03:11,548
everybody knows general knowledge

64
00:03:06,629 --> 00:03:15,500
assesses a German company alright then

65
00:03:11,549 --> 00:03:19,440
another guy same place posts another

66
00:03:15,500 --> 00:03:22,319
message I purchased the motherboard you

67
00:03:19,440 --> 00:03:24,569
know and this Asus live update gives me

68
00:03:22,319 --> 00:03:25,798
a very hard time because it can be

69
00:03:24,569 --> 00:03:27,988
tricked to download pretty much

70
00:03:25,799 --> 00:03:30,690
everything from the internet and

71
00:03:27,989 --> 00:03:32,519
immediately somebody from Essos USA

72
00:03:30,690 --> 00:03:34,139
replies and said well we're terribly

73
00:03:32,519 --> 00:03:36,030
sorry for that

74
00:03:34,139 --> 00:03:40,650
have you tried running a scan for

75
00:03:36,030 --> 00:03:43,079
viruses and obviously people have tried

76
00:03:40,650 --> 00:03:46,859
running a scan for viruses yes sure but

77
00:03:43,079 --> 00:03:48,299
nothing was found so this gets you you

78
00:03:46,859 --> 00:03:50,519
know wondering this was about nine

79
00:03:48,299 --> 00:03:53,849
months ago right and then seven months

80
00:03:50,519 --> 00:03:56,940
ago and you get to start thinking what

81
00:03:53,849 --> 00:03:59,190
about if this is a supply chain attack

82
00:03:56,940 --> 00:04:00,409
or if this was a supply chain attack

83
00:03:59,190 --> 00:04:02,760
right

84
00:04:00,409 --> 00:04:04,798
speaking of supply chain attacks how

85
00:04:02,760 --> 00:04:06,989
many people remember this shadow pad

86
00:04:04,799 --> 00:04:10,109
story okay

87
00:04:06,989 --> 00:04:14,760
few of you this was a very funny one as

88
00:04:10,109 --> 00:04:16,978
well very less a important player a

89
00:04:14,760 --> 00:04:19,108
financial institution called us one day

90
00:04:16,978 --> 00:04:21,478
saying that they found some suspicious

91
00:04:19,108 --> 00:04:23,430
traffic in their network and hey can you

92
00:04:21,478 --> 00:04:26,099
guys please come over and take a look at

93
00:04:23,430 --> 00:04:26,750
this so we went there we found what was

94
00:04:26,099 --> 00:04:29,210
going on

95
00:04:26,750 --> 00:04:31,820
turn out that software from Matt's Arang

96
00:04:29,210 --> 00:04:35,120
which the Korean company was Trojan eyes

97
00:04:31,820 --> 00:04:39,590
dwith a very tricky thing and Microsoft

98
00:04:35,120 --> 00:04:42,980
recently posted there's this you know

99
00:04:39,590 --> 00:04:46,630
indictment I'm sorry a court order in

100
00:04:42,980 --> 00:04:49,910
which they say that an apt known as

101
00:04:46,630 --> 00:04:52,580
barium was responsible for that and that

102
00:04:49,910 --> 00:04:55,360
involves his shadow Pat Miller and by

103
00:04:52,580 --> 00:04:58,460
the way what's up with this barium guys

104
00:04:55,360 --> 00:05:00,560
John Lambert one of my favorite speakers

105
00:04:58,460 --> 00:05:03,710
assess unfortunately he's not here this

106
00:05:00,560 --> 00:05:05,900
year but he presented what barium at

107
00:05:03,710 --> 00:05:08,840
virus bulletins and he said that barium

108
00:05:05,900 --> 00:05:13,190
was the apt behind the shadow pad and

109
00:05:08,840 --> 00:05:16,460
the ccleaner attacks so what's up with

110
00:05:13,190 --> 00:05:19,460
all this barium talk right well in

111
00:05:16,460 --> 00:05:21,890
January 2017 Microsoft posted a block in

112
00:05:19,460 --> 00:05:24,349
which they talk about barium and lab

113
00:05:21,890 --> 00:05:27,530
which are these two known activity

114
00:05:24,350 --> 00:05:29,450
groups that use the winning team hours

115
00:05:27,530 --> 00:05:32,119
so when you see the winning team Mallory

116
00:05:29,450 --> 00:05:35,560
that's kind of an old friends for us

117
00:05:32,120 --> 00:05:38,570
right we began looking into win nti in

118
00:05:35,560 --> 00:05:41,720
2011 and we kept tracking that and our

119
00:05:38,570 --> 00:05:44,659
conclusion back in 2011 was that this

120
00:05:41,720 --> 00:05:46,840
was a hacking group of Chinese origins

121
00:05:44,660 --> 00:05:49,970
and they were like a lot of you know

122
00:05:46,840 --> 00:05:53,299
trails going into that for instance on

123
00:05:49,970 --> 00:05:57,250
one of these hacker forums somebody

124
00:05:53,300 --> 00:05:59,630
posted a message from Southland sward

125
00:05:57,250 --> 00:06:02,210
saying that he's hiring people with a

126
00:05:59,630 --> 00:06:04,870
lot of unique skills penetration testing

127
00:06:02,210 --> 00:06:07,849
they know how to do science kills things

128
00:06:04,870 --> 00:06:09,800
and they need good verbal and written

129
00:06:07,850 --> 00:06:12,200
language skills they should be able to

130
00:06:09,800 --> 00:06:15,890
work in a team there's money involved

131
00:06:12,200 --> 00:06:18,140
like very nice job and the best part we

132
00:06:15,890 --> 00:06:22,250
have powerful background to know

133
00:06:18,140 --> 00:06:25,400
comments yeah don't worry no need to ask

134
00:06:22,250 --> 00:06:28,250
any questions we are powerful and then

135
00:06:25,400 --> 00:06:30,710
one of the win and TI guys merchants ii

136
00:06:28,250 --> 00:06:32,570
basically he posts a reply to that

137
00:06:30,710 --> 00:06:34,849
message and he said hey but aren't you

138
00:06:32,570 --> 00:06:37,760
recruiting people for apt what's up with

139
00:06:34,849 --> 00:06:40,639
all this you know pentesting let's be

140
00:06:37,760 --> 00:06:43,639
honest here you want people for apt work

141
00:06:40,639 --> 00:06:44,180
great and he said well Gwangju is too

142
00:06:43,639 --> 00:06:47,419
far

143
00:06:44,180 --> 00:06:50,150
but anyway sounds like a good plan and

144
00:06:47,419 --> 00:06:53,810
it's kind of ironic that emergency was

145
00:06:50,150 --> 00:06:55,878
later indicted in 2017 for hacking the

146
00:06:53,810 --> 00:07:01,370
capstone turbine and a few other

147
00:06:55,879 --> 00:07:04,249
companies well we told yourself in 2011

148
00:07:01,370 --> 00:07:06,800
so anyways if you want to learn more

149
00:07:04,249 --> 00:07:08,840
about all these combinations said what

150
00:07:06,800 --> 00:07:10,810
if those ready things were actually a

151
00:07:08,840 --> 00:07:14,539
supply chain attack let me invite my

152
00:07:10,810 --> 00:07:16,129
very brainy colleague Boris to tell you

153
00:07:14,539 --> 00:07:21,520
about the create a very curious

154
00:07:16,129 --> 00:07:29,060
discovery we made in January 2019 Boris

155
00:07:21,520 --> 00:07:29,060
[Applause]

156
00:07:34,130 --> 00:07:43,130
so in January this year we found

157
00:07:38,810 --> 00:07:46,340
something very strange we found that our

158
00:07:43,130 --> 00:07:49,190
technology caught a file but there was

159
00:07:46,340 --> 00:07:50,989
some problem with this file it had a

160
00:07:49,190 --> 00:07:55,130
valid signature of big hardware

161
00:07:50,990 --> 00:07:57,080
manufacturer esos so at first we thought

162
00:07:55,130 --> 00:08:01,100
that it should be a false alarm and

163
00:07:57,080 --> 00:08:03,710
decided to investigate we found out that

164
00:08:01,100 --> 00:08:06,920
we found samples that were distributed

165
00:08:03,710 --> 00:08:09,500
from official service offices it had a

166
00:08:06,920 --> 00:08:14,030
very cheeky backdoor with valid digital

167
00:08:09,500 --> 00:08:16,160
signature all samples that we found well

168
00:08:14,030 --> 00:08:18,320
backdoor it using one of two Victorian

169
00:08:16,160 --> 00:08:20,210
techniques and all of them way back

170
00:08:18,320 --> 00:08:22,760
during the same Potter book attributable

171
00:08:20,210 --> 00:08:25,549
so we managed to find this original file

172
00:08:22,760 --> 00:08:28,280
and you can see it on this slide you can

173
00:08:25,550 --> 00:08:33,740
see that it contains timestamp of March

174
00:08:28,280 --> 00:08:36,260
2015 and why attackers choose such an

175
00:08:33,740 --> 00:08:38,630
old file to carry an infection we

176
00:08:36,260 --> 00:08:43,340
believe that attackers found it along

177
00:08:38,630 --> 00:08:46,730
with Sangin keys on this slide you can

178
00:08:43,340 --> 00:08:49,340
see side-by-side comparison of two

179
00:08:46,730 --> 00:08:54,200
techniques that are used to backdoor

180
00:08:49,340 --> 00:08:56,000
this sample and also you can see

181
00:08:54,200 --> 00:08:58,760
side-by-side compassion all patched file

182
00:08:56,000 --> 00:09:01,100
layout in worst cases the load is likely

183
00:08:58,760 --> 00:09:04,090
that in your through section but the way

184
00:09:01,100 --> 00:09:06,650
how it was executed changed over time

185
00:09:04,090 --> 00:09:08,360
on this slide you can see first

186
00:09:06,650 --> 00:09:11,120
technique that was used among early

187
00:09:08,360 --> 00:09:13,070
variants with this technique when mine

188
00:09:11,120 --> 00:09:15,560
function was replaced with another

189
00:09:13,070 --> 00:09:18,020
function that copies per load from the

190
00:09:15,560 --> 00:09:21,349
restore section you using a fixed size

191
00:09:18,020 --> 00:09:23,600
an offset and then it executes it is

192
00:09:21,350 --> 00:09:27,320
another fixed size these are not upset

193
00:09:23,600 --> 00:09:30,140
so why does it work even if this palette

194
00:09:27,320 --> 00:09:32,240
is valid portable executable it contains

195
00:09:30,140 --> 00:09:35,000
a function that is called is that is

196
00:09:32,240 --> 00:09:37,310
coded in position independent way and

197
00:09:35,000 --> 00:09:39,620
what is also interesting about this

198
00:09:37,310 --> 00:09:42,500
sample is that you can see that it

199
00:09:39,620 --> 00:09:44,930
contains a reference to PDB pass and it

200
00:09:42,500 --> 00:09:46,520
reveals the name of this project name of

201
00:09:44,930 --> 00:09:47,910
this project is a social code which

202
00:09:46,520 --> 00:09:51,470
means that it was the world

203
00:09:47,910 --> 00:09:53,640
especially for carrying this a tiger

204
00:09:51,470 --> 00:09:56,670
attaches decided to switch to more

205
00:09:53,640 --> 00:09:59,130
stealthy technique and here you can see

206
00:09:56,670 --> 00:10:01,770
that this time when mine function is

207
00:09:59,130 --> 00:10:05,520
react intact but backdoor located deep

208
00:10:01,770 --> 00:10:09,900
inside of C library functions and it's

209
00:10:05,520 --> 00:10:12,990
executed right protein unification a lot

210
00:10:09,900 --> 00:10:15,060
of code changed as well and the palate

211
00:10:12,990 --> 00:10:17,490
still located in the true section but

212
00:10:15,060 --> 00:10:19,530
encryption is added and you can see the

213
00:10:17,490 --> 00:10:22,140
decryption algorithm on the left side of

214
00:10:19,530 --> 00:10:24,839
the slide you can see that it's a custom

215
00:10:22,140 --> 00:10:28,020
sort based algorithm but what is quite

216
00:10:24,840 --> 00:10:30,240
interesting about this algorithm it's a

217
00:10:28,020 --> 00:10:32,910
quite famous algorithm that was used in

218
00:10:30,240 --> 00:10:35,340
plug is malware and plug is my way is

219
00:10:32,910 --> 00:10:38,880
quite popular among Chinese hacking

220
00:10:35,340 --> 00:10:40,550
groups and while this done doesn't

221
00:10:38,880 --> 00:10:43,470
indicate strong connection between

222
00:10:40,550 --> 00:10:43,829
blogging starters and actors behind this

223
00:10:43,470 --> 00:10:46,980
attack

224
00:10:43,830 --> 00:10:49,890
we believe that actors behind this

225
00:10:46,980 --> 00:10:52,740
attack that quite familiar with source

226
00:10:49,890 --> 00:10:55,770
code of bugs and maybe they used it in a

227
00:10:52,740 --> 00:10:58,020
taxi in the past so right now let's talk

228
00:10:55,770 --> 00:11:00,780
about show code and we found a lot of

229
00:10:58,020 --> 00:11:03,300
them and some of them were really big in

230
00:11:00,780 --> 00:11:05,939
size because of a man that is it has

231
00:11:03,300 --> 00:11:09,390
ended on the stack so why is this that

232
00:11:05,940 --> 00:11:11,610
is present and how it's used it would

233
00:11:09,390 --> 00:11:13,439
appear that the Mangold factors behind

234
00:11:11,610 --> 00:11:16,080
this vicky that attack was to remain

235
00:11:13,440 --> 00:11:18,090
undetected in the plant site of hundreds

236
00:11:16,080 --> 00:11:20,220
of thousands installations while

237
00:11:18,090 --> 00:11:22,580
targeting only specific computers with

238
00:11:20,220 --> 00:11:25,230
surgical precision and to achieve that

239
00:11:22,580 --> 00:11:29,190
show code contains a table of entries

240
00:11:25,230 --> 00:11:31,500
where each entry contains one or two md5

241
00:11:29,190 --> 00:11:34,560
hashes of targets MAC addresses and

242
00:11:31,500 --> 00:11:38,670
backto will download next stage only in

243
00:11:34,560 --> 00:11:42,410
case if the talk addresses of computer

244
00:11:38,670 --> 00:11:45,120
will match one of these entries and

245
00:11:42,410 --> 00:11:48,750
otherwise normal East activity will be

246
00:11:45,120 --> 00:11:52,020
performed so we didn't fight 213

247
00:11:48,750 --> 00:11:55,350
examples and we were able to extract 14

248
00:11:52,020 --> 00:11:57,689
unique hash tables out of them so we can

249
00:11:55,350 --> 00:12:00,780
we found out that small stable which

250
00:11:57,690 --> 00:12:01,439
also the oldest one contains only 8

251
00:12:00,780 --> 00:12:05,279
entries

252
00:12:01,439 --> 00:12:09,299
and the biggest one contains 207 entries

253
00:12:05,279 --> 00:12:13,169
so in total we found 205 entries of type

254
00:12:09,299 --> 00:12:15,209
1 and 209 entries of turn two

255
00:12:13,169 --> 00:12:17,819
so it's fair to say that there are more

256
00:12:15,209 --> 00:12:22,199
than 400 machines that were targeted by

257
00:12:17,819 --> 00:12:25,469
oppression shadow hammer but this story

258
00:12:22,199 --> 00:12:27,419
doesn't end here because we found three

259
00:12:25,470 --> 00:12:27,959
more victims of similar submachine

260
00:12:27,419 --> 00:12:30,749
attacks

261
00:12:27,959 --> 00:12:33,628
one week after discovery of Asus case

262
00:12:30,749 --> 00:12:35,729
and also skill and all these companies

263
00:12:33,629 --> 00:12:39,119
they are aware from the gaming industry

264
00:12:35,729 --> 00:12:41,279
and all of them were affected by same

265
00:12:39,119 --> 00:12:45,809
backdoor but this backdoor was different

266
00:12:41,279 --> 00:12:48,329
from the one used in Asus case but there

267
00:12:45,809 --> 00:12:50,879
are some similarities as well first of

268
00:12:48,329 --> 00:12:53,699
all algorithm used to calculate API

269
00:12:50,879 --> 00:12:57,539
function hashes it decently reminds the

270
00:12:53,699 --> 00:13:00,719
one used in a suitcase and secondly our

271
00:12:57,539 --> 00:13:04,019
behavior engine identified that Asus

272
00:13:00,720 --> 00:13:08,220
case and other cases we're one of the

273
00:13:04,019 --> 00:13:10,759
only cases when EP HP Dell L was loaded

274
00:13:08,220 --> 00:13:13,949
and used from with initial code embedded

275
00:13:10,759 --> 00:13:17,170
into a portable executable file and now

276
00:13:13,949 --> 00:13:20,410
mr. Italy will tell us more about it

277
00:13:17,170 --> 00:13:20,410
[Applause]

278
00:13:22,580 --> 00:13:31,200
thank you Thank You Boris hey I'm

279
00:13:25,830 --> 00:13:38,610
literally well as you know my colleagues

280
00:13:31,200 --> 00:13:41,820
a mosque found stepped on a tale of

281
00:13:38,610 --> 00:13:45,690
shadow hammer in the end of January as

282
00:13:41,820 --> 00:13:48,180
for me my story of dealing with shadow

283
00:13:45,690 --> 00:13:50,670
hammer started two months before that

284
00:13:48,180 --> 00:13:53,790
who could have thought while my

285
00:13:50,670 --> 00:13:56,610
colleagues were surrounded with snow I

286
00:13:53,790 --> 00:13:59,310
am based in Singapore and in December

287
00:13:56,610 --> 00:14:03,270
where I first stepped on the tale of

288
00:13:59,310 --> 00:14:06,089
shadow hammer I was still waiting for

289
00:14:03,270 --> 00:14:08,460
the first note to come we don't have

290
00:14:06,090 --> 00:14:11,610
that much now here in Singapore so I was

291
00:14:08,460 --> 00:14:14,070
actually in my hammock relaxing and

292
00:14:11,610 --> 00:14:17,490
drinking my daily essential coconut

293
00:14:14,070 --> 00:14:20,370
juice when an email arrived and the

294
00:14:17,490 --> 00:14:23,420
email said that there is a partner of a

295
00:14:20,370 --> 00:14:27,030
company that asked us to look at some

296
00:14:23,420 --> 00:14:30,060
sophisticated simple this is where my

297
00:14:27,030 --> 00:14:32,100
story began I looked at this I said okay

298
00:14:30,060 --> 00:14:34,500
I'm gonna describe this very quickly who

299
00:14:32,100 --> 00:14:36,090
controls it how it works gotta do the

300
00:14:34,500 --> 00:14:39,600
job in half an hour and then go back to

301
00:14:36,090 --> 00:14:43,190
my hammock but no it was just the

302
00:14:39,600 --> 00:14:45,780
beginning for me it was an unknown actor

303
00:14:43,190 --> 00:14:48,750
with a very very sophisticated malware

304
00:14:45,780 --> 00:14:51,530
sample I spent the day on this didn't

305
00:14:48,750 --> 00:14:55,200
crack spend another day it didn't crack

306
00:14:51,530 --> 00:14:57,449
spend a week it didn't crack so I in

307
00:14:55,200 --> 00:15:00,720
fact layer after layer after layer after

308
00:14:57,450 --> 00:15:02,370
layer and then I felt like there must be

309
00:15:00,720 --> 00:15:04,350
something very very important behind

310
00:15:02,370 --> 00:15:06,240
there and then I stepped on the layer

311
00:15:04,350 --> 00:15:08,190
which was dependent on the hardware that

312
00:15:06,240 --> 00:15:10,590
would not unpack and execute on any

313
00:15:08,190 --> 00:15:13,590
other machine well if it's not the

314
00:15:10,590 --> 00:15:15,360
victim not the target so I kept on

315
00:15:13,590 --> 00:15:17,370
packing and packing and cracking the

316
00:15:15,360 --> 00:15:19,320
keys and getting inside and inside and

317
00:15:17,370 --> 00:15:23,090
in the end was just a loader of

318
00:15:19,320 --> 00:15:28,020
something generic from the internet so I

319
00:15:23,090 --> 00:15:29,730
was didn't the camera control using

320
00:15:28,020 --> 00:15:33,660
Google Docs to exchange the information

321
00:15:29,730 --> 00:15:35,790
with the malware was not active

322
00:15:33,660 --> 00:15:40,050
for a couple of months when I completed

323
00:15:35,790 --> 00:15:42,290
that but it was all down there was no

324
00:15:40,050 --> 00:15:45,479
context no other samples it was no gun

325
00:15:42,290 --> 00:15:48,390
so I kind of put it in the box and this

326
00:15:45,480 --> 00:15:50,640
box was opened somewhere in the end of

327
00:15:48,390 --> 00:15:52,110
January beginning of February with a

328
00:15:50,640 --> 00:15:56,850
name

329
00:15:52,110 --> 00:16:00,240
we recognized plugins that were used by

330
00:15:56,850 --> 00:16:02,870
shadow part as the code inside of the

331
00:16:00,240 --> 00:16:05,700
deepened deep and deep depths of that

332
00:16:02,870 --> 00:16:10,890
initial sample and of course we found

333
00:16:05,700 --> 00:16:13,110
many others so now this chart shows the

334
00:16:10,890 --> 00:16:15,480
connections between three different

335
00:16:13,110 --> 00:16:18,000
tracks and campaigns so it becomes just

336
00:16:15,480 --> 00:16:20,280
sophisticated where we are how they are

337
00:16:18,000 --> 00:16:23,850
connected so the main story about the

338
00:16:20,280 --> 00:16:27,180
asses is called shadow hammer here these

339
00:16:23,850 --> 00:16:30,290
guys compromise the distributive of the

340
00:16:27,180 --> 00:16:33,420
acids live update to an updater

341
00:16:30,290 --> 00:16:37,140
was patched with untempered digital

342
00:16:33,420 --> 00:16:40,439
signature the others are related so the

343
00:16:37,140 --> 00:16:44,490
shadow pad was linked to these and I'll

344
00:16:40,440 --> 00:16:46,170
show you how they are connected maybe

345
00:16:44,490 --> 00:16:48,870
this sounds convincing other than just

346
00:16:46,170 --> 00:16:51,540
the cold similarity which is not very

347
00:16:48,870 --> 00:16:53,570
reliable there are things like they use

348
00:16:51,540 --> 00:16:56,630
the same techniques they compromise

349
00:16:53,570 --> 00:16:59,310
supply chain software supply chains they

350
00:16:56,630 --> 00:17:02,939
make them over inserted into digitally

351
00:16:59,310 --> 00:17:05,429
signed binaries and the same code and

352
00:17:02,940 --> 00:17:08,430
same techniques were used to compromise

353
00:17:05,430 --> 00:17:10,640
a Korean at the right company this is

354
00:17:08,430 --> 00:17:13,880
where the name should've had appeared

355
00:17:10,640 --> 00:17:15,630
basically the incident that happened

356
00:17:13,880 --> 00:17:20,760
2017

357
00:17:15,630 --> 00:17:24,660
was also the attack by the same guys so

358
00:17:20,760 --> 00:17:27,000
the connections here you can see that in

359
00:17:24,660 --> 00:17:30,300
--see clinic is according to avast they

360
00:17:27,000 --> 00:17:33,420
published a blog post last year showing

361
00:17:30,300 --> 00:17:35,669
that in securing the case asus was

362
00:17:33,420 --> 00:17:39,330
specifically targeted we targeted some

363
00:17:35,670 --> 00:17:44,190
of the big companies in in Asia and that

364
00:17:39,330 --> 00:17:46,309
blog post from avast shows that they

365
00:17:44,190 --> 00:17:49,049
went after us

366
00:17:46,309 --> 00:17:51,240
also there was interest in casing that

367
00:17:49,049 --> 00:17:54,870
one of the breached gaming companies

368
00:17:51,240 --> 00:17:57,840
which are additional victims that also

369
00:17:54,870 --> 00:18:00,149
released compromised digitally signed

370
00:17:57,840 --> 00:18:03,299
binaries they were using the products of

371
00:18:00,150 --> 00:18:06,660
Nance around so it is just a coincidence

372
00:18:03,299 --> 00:18:09,320
yet but then the command control center

373
00:18:06,660 --> 00:18:11,760
in two cases were pointing to the same

374
00:18:09,320 --> 00:18:13,260
IP arranged located in the Korean

375
00:18:11,760 --> 00:18:17,070
educational network belonging to the

376
00:18:13,260 --> 00:18:20,100
same University well we reported this

377
00:18:17,070 --> 00:18:22,439
but it's still still figuring out how

378
00:18:20,100 --> 00:18:27,480
this university is lighted it probably

379
00:18:22,440 --> 00:18:31,530
got come from my service now think about

380
00:18:27,480 --> 00:18:33,919
what you did before Christmas prepare

381
00:18:31,530 --> 00:18:36,240
with families for the celebration

382
00:18:33,919 --> 00:18:40,260
probably did if you are from the western

383
00:18:36,240 --> 00:18:45,000
countries but here in Singapore and in

384
00:18:40,260 --> 00:18:48,000
the East basically there is much much

385
00:18:45,000 --> 00:18:51,330
bigger celebration of the Lunar New Year

386
00:18:48,000 --> 00:18:53,130
now imagine my role in the beginning of

387
00:18:51,330 --> 00:18:55,860
February where the influent the incident

388
00:18:53,130 --> 00:19:00,450
was uncovered with the SS when I had to

389
00:18:55,860 --> 00:19:03,149
call people on Friday get in touch with

390
00:19:00,450 --> 00:19:06,929
the company and they expected you know

391
00:19:03,150 --> 00:19:09,690
some greetings for the coming Chinese

392
00:19:06,929 --> 00:19:13,380
New Year or Lunar New Year instead we

393
00:19:09,690 --> 00:19:16,380
reported a big big problem so here I

394
00:19:13,380 --> 00:19:18,540
have to thank the colleagues from IT

395
00:19:16,380 --> 00:19:20,760
team of asses who responded very fast

396
00:19:18,540 --> 00:19:23,159
they reacted and took it very seriously

397
00:19:20,760 --> 00:19:24,690
provided us with additional information

398
00:19:23,160 --> 00:19:26,970
to verify that at least current

399
00:19:24,690 --> 00:19:28,530
executables are not breached and all

400
00:19:26,970 --> 00:19:32,370
other executables that they pulled from

401
00:19:28,530 --> 00:19:35,129
the servers throughout 2018 and the two

402
00:19:32,370 --> 00:19:36,090
days after were also not breached which

403
00:19:35,130 --> 00:19:38,100
was a good sign

404
00:19:36,090 --> 00:19:39,899
we could at least take a take a break

405
00:19:38,100 --> 00:19:42,149
and look back into this problem again

406
00:19:39,900 --> 00:19:44,280
but we kept communication with them and

407
00:19:42,150 --> 00:19:47,580
updating them and briefing them on the

408
00:19:44,280 --> 00:19:51,090
new discoveries we're still happy to

409
00:19:47,580 --> 00:19:55,300
work further and prevent such attacks in

410
00:19:51,090 --> 00:19:57,639
the future if he cooperates also

411
00:19:55,300 --> 00:19:59,350
now speaking of the Arsenal of these

412
00:19:57,640 --> 00:20:01,270
guys I just wanted to highlight three

413
00:19:59,350 --> 00:20:04,149
things starting from a very basic

414
00:20:01,270 --> 00:20:06,100
rudimentary back door and this is it

415
00:20:04,150 --> 00:20:08,350
doesn't show the skills of these guys it

416
00:20:06,100 --> 00:20:10,209
shows that they are really sly because

417
00:20:08,350 --> 00:20:13,240
during the initial reconnaissance they

418
00:20:10,210 --> 00:20:15,580
use very simple backdoor disposable one

419
00:20:13,240 --> 00:20:17,080
that they can easily replace so it was

420
00:20:15,580 --> 00:20:20,350
like very very simple http-based

421
00:20:17,080 --> 00:20:21,760
backdoor there were some somehow careful

422
00:20:20,350 --> 00:20:23,949
about profile in the window starting

423
00:20:21,760 --> 00:20:27,220
from windows 95 I'm not sure what what's

424
00:20:23,950 --> 00:20:29,380
the interest into that but they get from

425
00:20:27,220 --> 00:20:32,679
the listed all the versions starting

426
00:20:29,380 --> 00:20:34,840
from this so notice that they actually

427
00:20:32,679 --> 00:20:38,830
here in this initial reckons I started

428
00:20:34,840 --> 00:20:40,720
collecting MAC addresses and these

429
00:20:38,830 --> 00:20:43,870
samples are from the shadow path track

430
00:20:40,720 --> 00:20:46,440
shadow hammer that some people may think

431
00:20:43,870 --> 00:20:49,389
that it's not directly connected

432
00:20:46,440 --> 00:20:54,190
actually we use this MAC addresses right

433
00:20:49,390 --> 00:20:56,710
you profile to users to profile their

434
00:20:54,190 --> 00:20:59,950
targets and deliver next stage mover

435
00:20:56,710 --> 00:21:02,080
only to specific machines they also used

436
00:20:59,950 --> 00:21:07,210
they also collected serial number of

437
00:21:02,080 --> 00:21:09,040
drive C for later use in this main back

438
00:21:07,210 --> 00:21:11,260
door and now you can see the sample that

439
00:21:09,040 --> 00:21:12,879
I dealt with the diagram on the right

440
00:21:11,260 --> 00:21:14,920
I'm sure it's in readable but it just

441
00:21:12,880 --> 00:21:16,980
shows the number of items and the

442
00:21:14,920 --> 00:21:19,600
elements that you need to pull together

443
00:21:16,980 --> 00:21:21,100
to create a sample and those are not

444
00:21:19,600 --> 00:21:23,980
functions those are independent

445
00:21:21,100 --> 00:21:26,709
components that have to work nicely with

446
00:21:23,980 --> 00:21:29,980
each other interact like a factory so

447
00:21:26,710 --> 00:21:31,720
they have multiple plugins there they

448
00:21:29,980 --> 00:21:34,240
have been protect on top of everything

449
00:21:31,720 --> 00:21:35,860
so it took some time yes and in the

450
00:21:34,240 --> 00:21:39,160
middle there is a dependency on the

451
00:21:35,860 --> 00:21:43,469
drive C serial number which is used at

452
00:21:39,160 --> 00:21:45,520
the source data for encryption key

453
00:21:43,470 --> 00:21:47,140
decryption key basically fully for the

454
00:21:45,520 --> 00:21:50,800
our next stage payloads

455
00:21:47,140 --> 00:21:52,929
so definitely delays view a lot you need

456
00:21:50,800 --> 00:21:55,899
to break a crypt in order to analyze it

457
00:21:52,929 --> 00:22:00,429
and then it stuffed with a lot of anti

458
00:21:55,900 --> 00:22:03,700
reversing and anti debug in tricks last

459
00:22:00,429 --> 00:22:07,510
but not least this interesting implement

460
00:22:03,700 --> 00:22:09,760
usual because it is a capable of

461
00:22:07,510 --> 00:22:14,290
in the port 80 which is normally used

462
00:22:09,760 --> 00:22:17,290
for the HTTP web servers but it does it

463
00:22:14,290 --> 00:22:20,530
through windows api that is not commonly

464
00:22:17,290 --> 00:22:22,750
used so that it looks that the backdoor

465
00:22:20,530 --> 00:22:26,440
process itself does not open poor lady

466
00:22:22,750 --> 00:22:29,580
instead system opens for native forays

467
00:22:26,440 --> 00:22:33,370
and on behalf of the system it can

468
00:22:29,580 --> 00:22:34,990
communicate with with the other hosts so

469
00:22:33,370 --> 00:22:36,790
it is very hard to find for system

470
00:22:34,990 --> 00:22:39,550
administrators I can tell you we

471
00:22:36,790 --> 00:22:42,760
actually made an exercise for forensic

472
00:22:39,550 --> 00:22:43,930
analysts to teach how to do this I tell

473
00:22:42,760 --> 00:22:46,840
you it's not easy at all

474
00:22:43,930 --> 00:22:49,630
and that's why the back door like this

475
00:22:46,840 --> 00:22:50,639
will remain unnoticed for a very very

476
00:22:49,630 --> 00:22:53,920
long time

477
00:22:50,640 --> 00:22:58,780
we did some scan on the IP ranges and

478
00:22:53,920 --> 00:23:01,990
found companies that have web servers

479
00:22:58,780 --> 00:23:05,410
that respond to specific URL schema used

480
00:23:01,990 --> 00:23:07,660
in in this backdoor so far we have

481
00:23:05,410 --> 00:23:10,000
identified three additional businesses

482
00:23:07,660 --> 00:23:12,730
not the gaming industry compromised in

483
00:23:10,000 --> 00:23:13,870
South Korea right now one of them is a

484
00:23:12,730 --> 00:23:17,200
pharmaceutical company

485
00:23:13,870 --> 00:23:21,129
another is the opening conglomerate big

486
00:23:17,200 --> 00:23:24,970
company one more is actually the video

487
00:23:21,130 --> 00:23:27,070
game company now if you think that also

488
00:23:24,970 --> 00:23:29,590
story was big it probably all read about

489
00:23:27,070 --> 00:23:32,230
this in the news if you look at the

490
00:23:29,590 --> 00:23:35,139
other track the additional victims where

491
00:23:32,230 --> 00:23:39,810
they moved seems like they moved there

492
00:23:35,140 --> 00:23:42,850
after the asus working there for months

493
00:23:39,810 --> 00:23:45,820
they started moving to small companies

494
00:23:42,850 --> 00:23:48,669
but a larger number according to our

495
00:23:45,820 --> 00:23:52,330
detection that is what we see in our

496
00:23:48,670 --> 00:23:56,890
statistics we have seen more than 92,000

497
00:23:52,330 --> 00:23:58,659
of us that detected compromised

498
00:23:56,890 --> 00:24:02,170
digitally signed binaries from gaming

499
00:23:58,660 --> 00:24:06,700
vendors so the real picture actually can

500
00:24:02,170 --> 00:24:10,210
be multiplied by 10 or 20 depends what

501
00:24:06,700 --> 00:24:11,470
is the who are but I can tell you that

502
00:24:10,210 --> 00:24:14,350
we are talking about hundreds of

503
00:24:11,470 --> 00:24:15,940
thousands of potential victims and here

504
00:24:14,350 --> 00:24:18,969
the difference is that they did not

505
00:24:15,940 --> 00:24:20,460
target any specific Mac's they wanted

506
00:24:18,970 --> 00:24:22,690
everybody

507
00:24:20,460 --> 00:24:24,519
though they were much more careful with

508
00:24:22,690 --> 00:24:28,659
asses probably just to stay below the

509
00:24:24,519 --> 00:24:31,750
weather now we also analyzed and

510
00:24:28,659 --> 00:24:35,830
compared the way they injected code into

511
00:24:31,750 --> 00:24:37,360
the aciss binary and also into the

512
00:24:35,830 --> 00:24:40,059
gaming industry binaries and they were

513
00:24:37,360 --> 00:24:42,639
different what surprised us is that an

514
00:24:40,059 --> 00:24:45,730
analysis case they patched existing

515
00:24:42,639 --> 00:24:48,070
binary they modified the binder from

516
00:24:45,730 --> 00:24:50,289
2015 old one and then they resigned this

517
00:24:48,070 --> 00:24:52,720
with a valid signature in gaming

518
00:24:50,289 --> 00:24:54,519
industry cases they somehow seamlessly

519
00:24:52,720 --> 00:24:56,769
integrated malware into the code

520
00:24:54,519 --> 00:24:59,409
it looks like the developer had evil

521
00:24:56,769 --> 00:25:05,110
intent it was part of the code this is

522
00:24:59,409 --> 00:25:09,070
what how how it looks like it they they

523
00:25:05,110 --> 00:25:12,129
did this in the way that was based on

524
00:25:09,070 --> 00:25:14,379
the compromised development environment

525
00:25:12,130 --> 00:25:17,769
and this is where we see a big threat

526
00:25:14,380 --> 00:25:19,720
for the future because now they are not

527
00:25:17,769 --> 00:25:22,059
just targeting software and trying to

528
00:25:19,720 --> 00:25:26,200
create digital sign mover they are

529
00:25:22,059 --> 00:25:28,240
hunting software engineers and I'm sure

530
00:25:26,200 --> 00:25:30,100
that pretty much every big company has

531
00:25:28,240 --> 00:25:33,070
some internal software at some point you

532
00:25:30,100 --> 00:25:35,230
have own developers they may come after

533
00:25:33,070 --> 00:25:37,840
your developers and big door their

534
00:25:35,230 --> 00:25:40,600
compilers so what we managed to find in

535
00:25:37,840 --> 00:25:43,600
one of the cases of the gaming companies

536
00:25:40,600 --> 00:25:46,059
that the compiler the linker was

537
00:25:43,600 --> 00:25:48,399
backdoor and it would it would insert

538
00:25:46,059 --> 00:25:52,360
Malvar every time the source code was

539
00:25:48,399 --> 00:25:54,959
compiled now what does it mean one can

540
00:25:52,360 --> 00:25:57,729
yo compiler lies to you it's a big deal

541
00:25:54,960 --> 00:26:00,309
because your code will always contain

542
00:25:57,730 --> 00:26:03,460
better regardless of what source you are

543
00:26:00,309 --> 00:26:04,960
trying to compile it smoothly gets a

544
00:26:03,460 --> 00:26:06,940
digital signature because you do not

545
00:26:04,960 --> 00:26:09,730
expect maybe work saved process since

546
00:26:06,940 --> 00:26:15,880
cantillation to secure delivery to

547
00:26:09,730 --> 00:26:18,610
designing server the injection looks

548
00:26:15,880 --> 00:26:20,559
like the developer created this and if

549
00:26:18,610 --> 00:26:22,899
you try to review the code you will not

550
00:26:20,559 --> 00:26:24,850
find anything if you try to make a test

551
00:26:22,899 --> 00:26:27,939
dummy project and compile and see

552
00:26:24,850 --> 00:26:31,418
whether there is a backdoor you will not

553
00:26:27,940 --> 00:26:33,260
find the backdoor it's not there because

554
00:26:31,419 --> 00:26:36,620
it was editing this short gap

555
00:26:33,260 --> 00:26:40,910
between the source code and stage and

556
00:26:36,620 --> 00:26:42,620
the existing executable stage now if

557
00:26:40,910 --> 00:26:45,710
you're a software developer you should

558
00:26:42,620 --> 00:26:47,149
definitely ask yourself where does your

559
00:26:45,710 --> 00:26:49,549
development software come from

560
00:26:47,150 --> 00:26:52,640
do you trust it was it delivered in

561
00:26:49,549 --> 00:26:55,639
secure fashion to your place and when

562
00:26:52,640 --> 00:27:00,559
was the last time that you verify the

563
00:26:55,640 --> 00:27:02,330
integrity of this software and speaking

564
00:27:00,559 --> 00:27:04,490
of integrity and the whole trust model

565
00:27:02,330 --> 00:27:07,490
we are using I think we are living in

566
00:27:04,490 --> 00:27:10,429
very interesting times now first of all

567
00:27:07,490 --> 00:27:15,160
people stopped calling malvern over now

568
00:27:10,429 --> 00:27:18,470
we call it implants I heard also that

569
00:27:15,160 --> 00:27:21,429
hacking private companies are

570
00:27:18,470 --> 00:27:24,140
compromising private companies is not

571
00:27:21,429 --> 00:27:28,540
called hacking or compromising anymore

572
00:27:24,140 --> 00:27:36,679
it is called cyber maneuvering through

573
00:27:28,540 --> 00:27:38,720
civilian infrastructure that's true I

574
00:27:36,679 --> 00:27:45,460
mean I met people from the government

575
00:27:38,720 --> 00:27:45,460
that use this term well what can I say

576
00:27:46,419 --> 00:27:55,570
last word we have an exclusive it's a

577
00:27:50,809 --> 00:28:00,678
recording recording of a conversation

578
00:27:55,570 --> 00:28:03,290
between the operators at the part of

579
00:28:00,679 --> 00:28:05,620
this attack and I'm happy to present it

580
00:28:03,290 --> 00:28:05,620
to you

581
00:28:09,190 --> 00:28:13,640
still someone's here and blood all over

582
00:28:11,720 --> 00:28:15,800
the Stars can you clean up the weapons

583
00:28:13,640 --> 00:28:16,490
once you finish your fight disgusting

584
00:28:15,800 --> 00:28:21,760
slobs

585
00:28:16,490 --> 00:28:24,200
oh so want to use a big wooden fork

586
00:28:21,760 --> 00:28:25,970
you're not really useful unless you're

587
00:28:24,200 --> 00:28:29,000
fighting off three vampires that were

588
00:28:25,970 --> 00:28:32,240
huddled together I really wish I had my

589
00:28:29,000 --> 00:28:34,400
hammer Emma but unique was made from

590
00:28:32,240 --> 00:28:36,590
this special message from the hospital

591
00:28:34,400 --> 00:28:37,940
dying star and when I spun it really

592
00:28:36,590 --> 00:28:41,600
really fast it gave me the ability to

593
00:28:37,940 --> 00:28:44,150
fly ahem ah no I didn't write down the

594
00:28:41,600 --> 00:28:46,280
hammer are you on your BIC no no I spin

595
00:28:44,150 --> 00:28:49,160
it really fast and it would pull me off

596
00:28:46,280 --> 00:28:51,110
oh my god Emma pulled off the ground

597
00:28:49,160 --> 00:28:53,600
pulled me off the ground up into the air

598
00:28:51,110 --> 00:28:56,149
and I would fly every time I threw you

599
00:28:53,600 --> 00:28:57,590
always come back to me it sounds like

600
00:28:56,150 --> 00:28:58,850
you had a pretty special and intimate

601
00:28:57,590 --> 00:29:00,500
relationship with this hammer and then

602
00:28:58,850 --> 00:29:03,139
losing that was almost comparable to

603
00:29:00,500 --> 00:29:04,770
losing a loved one it's a nice way of

604
00:29:03,140 --> 00:29:08,810
putting it

605
00:29:04,770 --> 00:29:16,029
[Music]

606
00:29:08,810 --> 00:29:19,879
[Applause]

607
00:29:16,029 --> 00:29:21,830
what's that you know I asked for the hat

608
00:29:19,880 --> 00:29:24,039
the hammer of Thor and this is what they

609
00:29:21,830 --> 00:29:24,039
gave me

610
00:29:24,250 --> 00:29:28,880
Jenna thank you thank you very much for

611
00:29:26,750 --> 00:29:33,490
this presentation here applause the cost

612
00:29:28,880 --> 00:29:33,490
10 billion Boris Hankey

