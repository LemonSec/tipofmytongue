1
00:00:03,100 --> 00:00:07,119
[Music]

2
00:00:10,820 --> 00:00:18,180
go in the<font color="#E5E5E5"> world where everyone is spying</font>

3
00:00:15,660 --> 00:00:22,619
on everyone<font color="#E5E5E5"> there is always</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> place for</font>

4
00:00:18,180 --> 00:00:24,570
<font color="#CCCCCC">secret organizations like</font><font color="#E5E5E5"> shield this</font>

5
00:00:22,619 --> 00:00:30,840
organizations governmental<font color="#E5E5E5"> and</font>

6
00:00:24,570 --> 00:00:33,480
commercial founded a spying on companies

7
00:00:30,840 --> 00:00:36,570
<font color="#E5E5E5">States and individuals and they need</font>

8
00:00:33,480 --> 00:00:40,919
secret weapons to achieve this<font color="#CCCCCC"> tech</font><font color="#E5E5E5"> like</font>

9
00:00:36,570 --> 00:00:45,539
how but why this<font color="#E5E5E5"> why would I say that</font>

10
00:00:40,920 --> 00:00:51,239
<font color="#CCCCCC">hug is real secret reason because in a</font>

11
00:00:45,539 --> 00:00:55,819
normal life<font color="#E5E5E5"> Hulk is shy and good-looking</font>

12
00:00:51,239 --> 00:00:59,730
guy<font color="#E5E5E5"> let me introduce you dr. banner</font>

13
00:00:55,819 --> 00:01:01,909
<font color="#CCCCCC">would you</font><font color="#E5E5E5"> believe that dr. banner</font><font color="#CCCCCC"> can do</font>

14
00:00:59,730 --> 00:01:05,309
something malicious<font color="#E5E5E5"> now it'll maintain</font>

15
00:01:01,909 --> 00:01:07,100
would you believe if I would say<font color="#E5E5E5"> that</font>

16
00:01:05,309 --> 00:01:13,070
windows management instrumentation

17
00:01:07,100 --> 00:01:13,070
mechanism is the<font color="#CCCCCC"> same as dr. banner</font>

18
00:01:13,190 --> 00:01:17,789
today I will talk<font color="#CCCCCC"> about one of the most</font>

19
00:01:15,869 --> 00:01:23,570
interesting trends that we've<font color="#CCCCCC"> seen</font>

20
00:01:17,790 --> 00:01:27,110
malware file<font color="#CCCCCC"> it's malware and when you</font>

21
00:01:23,570 --> 00:01:31,139
it's hard to<font color="#CCCCCC"> detect such malware</font><font color="#E5E5E5"> it's</font>

22
00:01:27,110 --> 00:01:33,619
more<font color="#E5E5E5"> or less invisible and even if you</font>

23
00:01:31,140 --> 00:01:37,530
spot<font color="#E5E5E5"> it it can be somewhere in the crowd</font>

24
00:01:33,619 --> 00:01:39,899
<font color="#E5E5E5">so as far as Windows is still the most</font>

25
00:01:37,530 --> 00:01:42,240
popular<font color="#E5E5E5"> operating system the desktop</font>

26
00:01:39,899 --> 00:01:45,259
operating system<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about</font>

27
00:01:42,240 --> 00:01:49,079
<font color="#E5E5E5">gaining fearlessness</font><font color="#CCCCCC"> violinist state</font>

28
00:01:45,259 --> 00:01:52,289
using core components<font color="#E5E5E5"> of this system so</font>

29
00:01:49,079 --> 00:01:55,229
<font color="#CCCCCC">WM i</font><font color="#E5E5E5"> YW</font><font color="#CCCCCC"> might because it's like Swiss</font>

30
00:01:52,289 --> 00:01:58,140
<font color="#CCCCCC">Army knife it gives the constant</font>

31
00:01:55,229 --> 00:02:00,149
approach to carry<font color="#CCCCCC"> and carry out the</font>

32
00:01:58,140 --> 00:02:02,880
<font color="#CCCCCC">day-to-day management tasks</font><font color="#E5E5E5"> like running</font>

33
00:02:00,149 --> 00:02:07,590
processes<font color="#CCCCCC"> kid</font><font color="#E5E5E5"> link to run process in a</font>

34
00:02:02,880 --> 00:02:09,630
given<font color="#E5E5E5"> time or we get the list of</font>

35
00:02:07,590 --> 00:02:12,030
installed<font color="#E5E5E5"> applications and hardware and</font>

36
00:02:09,630 --> 00:02:16,710
<font color="#E5E5E5">also</font><font color="#CCCCCC"> you can use it</font><font color="#E5E5E5"> to implement files</font>

37
00:02:12,030 --> 00:02:20,400
<font color="#E5E5E5">attacks</font><font color="#CCCCCC"> so like there is a just</font><font color="#E5E5E5"> like</font>

38
00:02:16,710 --> 00:02:23,310
there is<font color="#CCCCCC"> a place in dr. banners DNA a</font>

39
00:02:20,400 --> 00:02:24,090
place for a hug<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> a such place</font>

40
00:02:23,310 --> 00:02:27,690
for

41
00:02:24,090 --> 00:02:29,250
<font color="#E5E5E5">are hiding data inside</font><font color="#CCCCCC"> WMI is double in</font>

42
00:02:27,690 --> 00:02:32,099
my classes<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can put there anything</font>

43
00:02:29,250 --> 00:02:34,920
you want<font color="#CCCCCC"> be</font><font color="#E5E5E5"> file scripts or stole</font>

44
00:02:32,099 --> 00:02:40,140
<font color="#CCCCCC">information</font><font color="#E5E5E5"> another powerful mechanism</font>

45
00:02:34,920 --> 00:02:42,859
that bad guys uses every<font color="#CCCCCC"> day</font><font color="#E5E5E5"> is w my</font>

46
00:02:40,140 --> 00:02:46,589
subscription<font color="#E5E5E5"> because you can trigger</font>

47
00:02:42,860 --> 00:02:49,530
<font color="#CCCCCC">your code when something happens in</font><font color="#E5E5E5"> a</font>

48
00:02:46,590 --> 00:02:54,540
system<font color="#E5E5E5"> for example gets connected to the</font>

49
00:02:49,530 --> 00:02:57,930
<font color="#CCCCCC">internet or</font><font color="#E5E5E5"> Union setting you</font><font color="#CCCCCC"> USB</font><font color="#E5E5E5"> Drive</font>

50
00:02:54,540 --> 00:03:00,900
<font color="#E5E5E5">so from a technical perspective that</font>

51
00:02:57,930 --> 00:03:03,450
Malema is a very nice system<font color="#E5E5E5"> it gives</font>

52
00:03:00,900 --> 00:03:06,900
you more or less<font color="#E5E5E5"> unremarkable storage</font>

53
00:03:03,450 --> 00:03:10,078
place it gives<font color="#E5E5E5"> you full system</font>

54
00:03:06,900 --> 00:03:14,970
information<font color="#E5E5E5"> and you work</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> it with</font>

55
00:03:10,079 --> 00:03:16,860
legitimate applications so you<font color="#CCCCCC"> don't</font>

56
00:03:14,970 --> 00:03:20,310
need to write<font color="#CCCCCC"> your in</font><font color="#E5E5E5"> the super</font>

57
00:03:16,860 --> 00:03:22,829
suspicious code<font color="#E5E5E5"> just use tools provided</font>

58
00:03:20,310 --> 00:03:26,579
by<font color="#E5E5E5"> Microsoft or using just sweepin</font>

59
00:03:22,829 --> 00:03:29,690
scripting languages<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is theory so</font>

60
00:03:26,579 --> 00:03:33,420
we will see our first example

61
00:03:29,690 --> 00:03:35,940
it's a mass-market malware so<font color="#CCCCCC"> we very</font>

62
00:03:33,420 --> 00:03:40,470
well<font color="#E5E5E5"> here we have</font><font color="#CCCCCC"> mm I'll skip</font>

63
00:03:35,940 --> 00:03:43,560
subscription that triggers can double<font color="#E5E5E5"> my</font>

64
00:03:40,470 --> 00:03:46,380
instance of a class instance<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

65
00:03:43,560 --> 00:03:48,720
actually a visual basic<font color="#E5E5E5"> script that</font>

66
00:03:46,380 --> 00:03:51,750
checks for installed browsers and

67
00:03:48,720 --> 00:03:53,250
changes start pages<font color="#E5E5E5"> very simple very</font>

68
00:03:51,750 --> 00:03:56,940
effective<font color="#CCCCCC"> profit</font>

69
00:03:53,250 --> 00:04:00,859
so<font color="#CCCCCC"> it's certainly</font><font color="#E5E5E5"> apt actors</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> use</font>

70
00:03:56,940 --> 00:04:03,180
<font color="#CCCCCC">or</font><font color="#E5E5E5"> visual basic</font><font color="#CCCCCC"> various</font><font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> and</font>

71
00:04:00,859 --> 00:04:07,620
here's<font color="#CCCCCC"> another example</font><font color="#E5E5E5"> from government</font>

72
00:04:03,180 --> 00:04:10,109
computer<font color="#E5E5E5"> subscriptions triggers every 30</font>

73
00:04:07,620 --> 00:04:12,959
minutes<font color="#CCCCCC"> after</font><font color="#E5E5E5"> boot it decrypts</font>

74
00:04:10,109 --> 00:04:16,769
<font color="#CCCCCC">powershell backdoor it's very simple</font><font color="#E5E5E5"> or</font>

75
00:04:12,959 --> 00:04:20,070
270 lines of code it can download<font color="#E5E5E5"> files</font>

76
00:04:16,769 --> 00:04:22,530
<font color="#E5E5E5">execute comments and upload files</font><font color="#CCCCCC"> very</font>

77
00:04:20,070 --> 00:04:25,349
<font color="#E5E5E5">simple but to get very effective and</font>

78
00:04:22,530 --> 00:04:28,979
<font color="#CCCCCC">resize totally in memory and WMI</font><font color="#E5E5E5"> no</font>

79
00:04:25,349 --> 00:04:32,400
files that<font color="#CCCCCC"> only</font><font color="#E5E5E5"> disk next example</font>

80
00:04:28,979 --> 00:04:36,380
sometimes<font color="#E5E5E5"> bad guys want more</font>

81
00:04:32,400 --> 00:04:39,469
functionality and here we have<font color="#CCCCCC"> three</font>

82
00:04:36,380 --> 00:04:41,780
<font color="#CCCCCC">model bag dork this beggar has three</font>

83
00:04:39,470 --> 00:04:45,560
modules<font color="#E5E5E5"> so first model just keeps</font>

84
00:04:41,780 --> 00:04:50,080
everything<font color="#CCCCCC"> second module</font><font color="#E5E5E5"> also in story</font>

85
00:04:45,560 --> 00:04:53,450
in<font color="#CCCCCC"> WMI inject code into processes and</font>

86
00:04:50,080 --> 00:04:58,690
third<font color="#E5E5E5"> model is actually dll file also</font>

87
00:04:53,450 --> 00:05:03,349
told in<font color="#CCCCCC"> WMI in base64</font><font color="#E5E5E5"> encrypted form so</font>

88
00:04:58,690 --> 00:05:07,060
each<font color="#E5E5E5"> day at</font><font color="#CCCCCC"> 9 o'clock</font><font color="#E5E5E5"> it activates and</font>

89
00:05:03,350 --> 00:05:10,750
then it spawns a new remove threat in

90
00:05:07,060 --> 00:05:13,790
else's<font color="#CCCCCC"> egg z allocates memory and while</font>

91
00:05:10,750 --> 00:05:17,960
<font color="#E5E5E5">yellow into this memory I think</font><font color="#CCCCCC"> becquer</font>

92
00:05:13,790 --> 00:05:20,060
<font color="#E5E5E5">very effective so what about real secret</font>

93
00:05:17,960 --> 00:05:23,390
<font color="#E5E5E5">engine</font><font color="#CCCCCC"> sees the if</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> take a</font>

94
00:05:20,060 --> 00:05:27,110
closer look<font color="#E5E5E5"> at our</font><font color="#CCCCCC"> world 7 documents you</font>

95
00:05:23,390 --> 00:05:30,260
will spotted user have already started

96
00:05:27,110 --> 00:05:36,070
to<font color="#E5E5E5"> implement W my persistence mechanism</font>

97
00:05:30,260 --> 00:05:40,219
for ricky bowden malware so how to how

98
00:05:36,070 --> 00:05:44,740
<font color="#CCCCCC">to detect such things</font><font color="#E5E5E5"> you need two</font>

99
00:05:40,220 --> 00:05:48,680
<font color="#CCCCCC">things a is the</font><font color="#E5E5E5"> hero of detection and B</font>

100
00:05:44,740 --> 00:05:50,510
analysis of big data<font color="#CCCCCC"> so combining these</font>

101
00:05:48,680 --> 00:05:52,700
two approaches you can spot that

102
00:05:50,510 --> 00:05:57,830
something bad is<font color="#CCCCCC"> happening with you with</font>

103
00:05:52,700 --> 00:05:59,840
<font color="#E5E5E5">go W my storage about Isis file like</font>

104
00:05:57,830 --> 00:06:03,469
<font color="#CCCCCC">hashes are</font><font color="#E5E5E5"> useless</font><font color="#CCCCCC"> absolutely everything</font>

105
00:05:59,840 --> 00:06:06,799
is in memory<font color="#CCCCCC"> like</font><font color="#E5E5E5"> in Philo file names</font><font color="#CCCCCC"> no</font>

106
00:06:03,470 --> 00:06:11,330
for<font color="#CCCCCC"> James story</font><font color="#E5E5E5"> but still</font><font color="#CCCCCC"> you can use</font>

107
00:06:06,800 --> 00:06:16,180
<font color="#E5E5E5">Network Isis and you still can use names</font>

108
00:06:11,330 --> 00:06:17,659
of<font color="#E5E5E5"> for W my object so now I hope you</font>

109
00:06:16,180 --> 00:06:20,660
know that

110
00:06:17,660 --> 00:06:24,140
<font color="#CCCCCC">w bi can transform from</font><font color="#E5E5E5"> innoncent</font>

111
00:06:20,660 --> 00:06:26,390
<font color="#E5E5E5">dr. banner</font><font color="#CCCCCC"> into Hulk and the last</font>

112
00:06:24,140 --> 00:06:30,680
mention remains what should I do to

113
00:06:26,390 --> 00:06:34,010
protect<font color="#E5E5E5"> myself and my recipe</font><font color="#CCCCCC"> is quite</font>

114
00:06:30,680 --> 00:06:37,730
simple<font color="#E5E5E5"> we want to receive that interact</font>

115
00:06:34,010 --> 00:06:40,789
<font color="#E5E5E5">with</font><font color="#CCCCCC"> WMI restrict usage of powershell</font><font color="#E5E5E5"> in</font>

116
00:06:37,730 --> 00:06:43,760
the organization<font color="#E5E5E5"> or</font><font color="#CCCCCC"> better use only</font>

117
00:06:40,790 --> 00:06:46,280
<font color="#E5E5E5">signed powershell script and you can</font>

118
00:06:43,760 --> 00:06:48,520
call<font color="#E5E5E5"> a</font><font color="#CCCCCC"> third day of concern and</font><font color="#E5E5E5"> act to</font>

119
00:06:46,280 --> 00:06:51,119
calm<font color="#CCCCCC"> down how can set a few</font>

120
00:06:48,520 --> 00:06:51,120
thank you very<font color="#CCCCCC"> much</font>

121
00:06:51,250 --> 00:06:55,769
[Applause]

