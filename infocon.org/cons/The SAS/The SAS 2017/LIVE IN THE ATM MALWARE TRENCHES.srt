1
00:00:03,180 --> 00:00:07,199
[Music]

2
00:00:10,680 --> 00:00:17,130
good afternoon<font color="#E5E5E5"> ladies and gentlemen</font>

3
00:00:12,650 --> 00:00:18,900
<font color="#E5E5E5">we've just</font><font color="#CCCCCC"> two of us here we are we're</font><font color="#E5E5E5"> a</font>

4
00:00:17,130 --> 00:00:22,200
principal security researchers we get

5
00:00:18,900 --> 00:00:27,839
<font color="#CCCCCC">special</font><font color="#E5E5E5"> ops so eager</font><font color="#CCCCCC"> swimming cough hi</font>

6
00:00:22,200 --> 00:00:30,029
and my name<font color="#E5E5E5"> is Serge so we are principal</font>

7
00:00:27,840 --> 00:00:31,860
security researchers and what does it

8
00:00:30,029 --> 00:00:34,500
<font color="#CCCCCC">mean it means</font><font color="#E5E5E5"> that we</font><font color="#CCCCCC"> are making</font>

9
00:00:31,860 --> 00:00:36,390
forensic forensics we're making the

10
00:00:34,500 --> 00:00:38,190
reverse<font color="#CCCCCC"> engineering we're making the</font>

11
00:00:36,390 --> 00:00:42,030
<font color="#E5E5E5">insert responses on a lot of</font><font color="#CCCCCC"> lot of</font>

12
00:00:38,190 --> 00:00:46,170
<font color="#E5E5E5">cases</font><font color="#CCCCCC"> some apts financial threats and</font>

13
00:00:42,030 --> 00:00:51,230
<font color="#E5E5E5">bla bla bla bla bla</font><font color="#CCCCCC"> bla but during our</font>

14
00:00:46,170 --> 00:00:54,210
daily job<font color="#E5E5E5"> we got some you know</font>

15
00:00:51,230 --> 00:00:58,468
mind-blowing cases so completely

16
00:00:54,210 --> 00:01:02,670
outstanding and during a preparation<font color="#CCCCCC"> for</font>

17
00:00:58,469 --> 00:01:07,830
<font color="#CCCCCC">us we've choose the three major stories</font>

18
00:01:02,670 --> 00:01:10,500
that we saw a during<font color="#E5E5E5"> last year so</font><font color="#CCCCCC"> three</font>

19
00:01:07,830 --> 00:01:15,530
stories about<font color="#E5E5E5"> like SWAT magic</font><font color="#CCCCCC"> drilling</font>

20
00:01:10,500 --> 00:01:18,539
and<font color="#E5E5E5"> et</font><font color="#CCCCCC"> image</font><font color="#E5E5E5"> so the first story started</font>

21
00:01:15,530 --> 00:01:22,289
<font color="#E5E5E5">in May 2016</font>

22
00:01:18,539 --> 00:01:26,369
and actually we already present

23
00:01:22,289 --> 00:01:30,000
<font color="#E5E5E5">something in our secure</font><font color="#CCCCCC"> list website so</font>

24
00:01:26,369 --> 00:01:32,240
it's about the<font color="#E5E5E5"> PowerShell it's about how</font>

25
00:01:30,000 --> 00:01:35,789
criminals<font color="#CCCCCC"> we wore were able to</font>

26
00:01:32,240 --> 00:01:37,318
successfully attack<font color="#E5E5E5"> financial</font>

27
00:01:35,789 --> 00:01:41,420
<font color="#E5E5E5">institutions and the price networks</font>

28
00:01:37,319 --> 00:01:44,849
around<font color="#E5E5E5"> the</font><font color="#CCCCCC"> world and during</font><font color="#E5E5E5"> this</font>

29
00:01:41,420 --> 00:01:47,640
penetration<font color="#E5E5E5"> they haven't used any</font>

30
00:01:44,849 --> 00:01:49,950
malicious binaries or scripts or

31
00:01:47,640 --> 00:01:51,750
something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they were injecting</font>

32
00:01:49,950 --> 00:01:54,450
<font color="#CCCCCC">into</font><font color="#E5E5E5"> the PowerShell directly to the</font>

33
00:01:51,750 --> 00:01:59,720
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> registry</font><font color="#E5E5E5"> through the - scheduler</font>

34
00:01:54,450 --> 00:02:03,239
<font color="#E5E5E5">or the standard utilities</font><font color="#CCCCCC"> plus what was</font>

35
00:01:59,720 --> 00:02:05,640
once again<font color="#E5E5E5"> interesting that criminals</font>

36
00:02:03,239 --> 00:02:08,099
were able to<font color="#E5E5E5"> dig tunnels inside</font>

37
00:02:05,640 --> 00:02:12,120
corporate networks through the standard

38
00:02:08,098 --> 00:02:14,849
natural utility and<font color="#CCCCCC"> that how they</font><font color="#E5E5E5"> were</font>

39
00:02:12,120 --> 00:02:16,950
<font color="#CCCCCC">able to</font><font color="#E5E5E5"> gain access</font><font color="#CCCCCC"> to anything to any</font>

40
00:02:14,849 --> 00:02:21,268
computer inside<font color="#E5E5E5"> the network</font><font color="#CCCCCC"> without any</font>

41
00:02:16,950 --> 00:02:23,578
malware<font color="#E5E5E5"> but why so that was the question</font>

42
00:02:21,269 --> 00:02:24,060
<font color="#CCCCCC">and now we're ready</font><font color="#E5E5E5"> to answer this</font>

43
00:02:23,579 --> 00:02:26,730
<font color="#E5E5E5">question</font>

44
00:02:24,060 --> 00:02:30,450
so the case was<font color="#CCCCCC"> evolved in money in</font>

45
00:02:26,730 --> 00:02:31,819
attacking<font color="#E5E5E5"> the eat here and this request</font>

46
00:02:30,450 --> 00:02:38,700
was really funny

47
00:02:31,819 --> 00:02:41,869
so<font color="#E5E5E5"> request from the bank was</font><font color="#CCCCCC"> guided no</font>

48
00:02:38,700 --> 00:02:45,750
money no money<font color="#E5E5E5"> the e-team is empty and</font>

49
00:02:41,870 --> 00:02:48,000
there are no sample<font color="#E5E5E5"> from the ATM and</font><font color="#CCCCCC"> the</font>

50
00:02:45,750 --> 00:02:50,239
logs of the<font color="#E5E5E5"> ATM are empty all</font><font color="#CCCCCC"> the</font>

51
00:02:48,000 --> 00:02:53,250
sitting<font color="#CCCCCC"> logs are ok nothing suspicious</font>

52
00:02:50,239 --> 00:02:56,489
<font color="#E5E5E5">but still there is no money and the</font>

53
00:02:53,250 --> 00:02:59,190
<font color="#E5E5E5">question is well guys there is a</font>

54
00:02:56,489 --> 00:02:59,880
suspicious text file in the temporary

55
00:02:59,190 --> 00:03:03,329
folder

56
00:02:59,880 --> 00:03:06,329
it's called<font color="#E5E5E5"> KL txt does it have to do</font>

57
00:03:03,330 --> 00:03:08,970
anything with you guys are you involved

58
00:03:06,330 --> 00:03:13,280
<font color="#CCCCCC">yes so they</font><font color="#E5E5E5"> asked us</font><font color="#CCCCCC"> are Kaspersky Lab</font>

59
00:03:08,970 --> 00:03:18,299
involved in this incident with the ATM

60
00:03:13,280 --> 00:03:22,230
<font color="#CCCCCC">so we asked for details</font><font color="#E5E5E5"> and they the</font>

61
00:03:18,299 --> 00:03:28,590
<font color="#E5E5E5">bank</font><font color="#CCCCCC"> sent us photo of the contents of</font>

62
00:03:22,230 --> 00:03:31,200
this file<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it was amazing so while</font>

63
00:03:28,590 --> 00:03:33,720
there were no system logs<font color="#CCCCCC"> there was</font>

64
00:03:31,200 --> 00:03:37,709
<font color="#E5E5E5">actually a very extensive local the</font>

65
00:03:33,720 --> 00:03:40,440
malware<font color="#E5E5E5"> and it was literally writing a</font>

66
00:03:37,709 --> 00:03:43,049
log line<font color="#E5E5E5"> for any action</font><font color="#CCCCCC"> that it was</font>

67
00:03:40,440 --> 00:03:45,829
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> and there was a</font><font color="#E5E5E5"> very nice catch</font>

68
00:03:43,049 --> 00:03:50,280
phrase in it but I'd like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> zoom it so</font>

69
00:03:45,829 --> 00:03:53,639
so nothing but<font color="#CCCCCC"> except this nice message</font>

70
00:03:50,280 --> 00:03:57,480
and what was the next<font color="#E5E5E5"> we started to do</font>

71
00:03:53,639 --> 00:03:58,889
our<font color="#E5E5E5"> regular job and we start to create a</font>

72
00:03:57,480 --> 00:04:02,149
yellow<font color="#CCCCCC"> roof or</font><font color="#E5E5E5"> virustotal</font>

73
00:03:58,889 --> 00:04:07,790
and we were waiting<font color="#E5E5E5"> we</font><font color="#CCCCCC"> were waiting for</font>

74
00:04:02,150 --> 00:04:11,120
20 hours<font color="#E5E5E5"> no more and this</font><font color="#CCCCCC"> is incredible</font>

75
00:04:07,790 --> 00:04:11,120
<font color="#CCCCCC">Yara rule</font>

76
00:04:12,230 --> 00:04:17,310
with<font color="#E5E5E5"> incredible food issue you need to</font>

77
00:04:15,269 --> 00:04:23,160
go to a special training<font color="#E5E5E5"> to be able to</font>

78
00:04:17,310 --> 00:04:25,680
do it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> there is a</font><font color="#CCCCCC"> submission</font><font color="#E5E5E5"> so after</font>

79
00:04:23,160 --> 00:04:28,020
several<font color="#CCCCCC"> hours from</font><font color="#E5E5E5"> two countries so we</font>

80
00:04:25,680 --> 00:04:31,260
<font color="#E5E5E5">learned that several banks were</font>

81
00:04:28,020 --> 00:04:34,020
suffering from this<font color="#E5E5E5"> valve and we started</font>

82
00:04:31,260 --> 00:04:37,139
to analyze<font color="#E5E5E5"> it so we went</font><font color="#CCCCCC"> to the real</font>

83
00:04:34,020 --> 00:04:43,469
ATMs<font color="#E5E5E5"> and started to look what this</font>

84
00:04:37,139 --> 00:04:47,039
binary<font color="#E5E5E5"> is actually doing so this is a</font>

85
00:04:43,470 --> 00:04:51,630
<font color="#CCCCCC">dll file</font><font color="#E5E5E5"> and we need to start it through</font>

86
00:04:47,039 --> 00:04:55,169
the regular routine<font color="#CCCCCC"> it's very small dll</font>

87
00:04:51,630 --> 00:04:57,360
file and it doesn't do anything itself

88
00:04:55,169 --> 00:05:00,900
it has to<font color="#CCCCCC"> be commanded</font><font color="#E5E5E5"> from the command</font>

89
00:04:57,360 --> 00:05:03,570
<font color="#CCCCCC">line and the attacker has to</font><font color="#E5E5E5"> invoke the</font>

90
00:05:00,900 --> 00:05:06,710
<font color="#E5E5E5">DLL and write a text file that contains</font>

91
00:05:03,570 --> 00:05:09,690
the command<font color="#CCCCCC"> one command in a file</font><font color="#E5E5E5"> and</font>

92
00:05:06,710 --> 00:05:12,719
every command instructs the DLL<font color="#E5E5E5"> either</font>

93
00:05:09,690 --> 00:05:15,870
if you open the dispenser to<font color="#E5E5E5"> initialize</font>

94
00:05:12,720 --> 00:05:17,400
<font color="#CCCCCC">the whole dispensing subsystem get the</font>

95
00:05:15,870 --> 00:05:20,690
<font color="#CCCCCC">information</font><font color="#E5E5E5"> about the</font><font color="#CCCCCC"> cassettes and then</font>

96
00:05:17,400 --> 00:05:24,200
eventually just<font color="#E5E5E5"> dispense the money out</font>

97
00:05:20,690 --> 00:05:28,050
yes so as you can see<font color="#E5E5E5"> we're just</font>

98
00:05:24,200 --> 00:05:30,110
manually<font color="#E5E5E5"> transferring the fo</font><font color="#CCCCCC"> comments to</font>

99
00:05:28,050 --> 00:05:34,349
the malware to the special file<font color="#E5E5E5"> and</font>

100
00:05:30,110 --> 00:05:36,720
three<font color="#CCCCCC"> to one light light light yep so</font>

101
00:05:34,349 --> 00:05:40,919
this<font color="#E5E5E5"> is the one</font><font color="#CCCCCC"> Beckett that we</font>

102
00:05:36,720 --> 00:05:47,130
<font color="#E5E5E5">requested and the wonderful message</font><font color="#CCCCCC"> case</font>

103
00:05:40,919 --> 00:05:50,130
<font color="#CCCCCC">on the air</font><font color="#E5E5E5"> is there yeah so what was the</font>

104
00:05:47,130 --> 00:05:52,680
summary<font color="#CCCCCC"> of this file</font><font color="#E5E5E5"> s attack inside</font><font color="#CCCCCC"> the</font>

105
00:05:50,130 --> 00:05:54,659
bank<font color="#E5E5E5"> and what does it</font><font color="#CCCCCC"> mean for the ECM</font>

106
00:05:52,680 --> 00:05:58,530
so for the<font color="#CCCCCC"> exams</font><font color="#E5E5E5"> that means that it</font>

107
00:05:54,660 --> 00:06:00,930
works with any ATM because<font color="#CCCCCC"> of the really</font>

108
00:05:58,530 --> 00:06:02,789
<font color="#E5E5E5">universal it doesn't need to</font><font color="#CCCCCC"> know what</font>

109
00:06:00,930 --> 00:06:05,130
the vendor is because it's<font color="#E5E5E5"> using the</font>

110
00:06:02,789 --> 00:06:09,990
universal layer<font color="#E5E5E5"> provided by Microsoft</font>

111
00:06:05,130 --> 00:06:11,820
<font color="#E5E5E5">API</font><font color="#CCCCCC"> DMS XFS</font><font color="#E5E5E5"> API so you just</font><font color="#CCCCCC"> feed it with</font>

112
00:06:09,990 --> 00:06:13,770
the name<font color="#E5E5E5"> of the dispenser device and</font>

113
00:06:11,820 --> 00:06:18,840
<font color="#E5E5E5">that's it</font><font color="#CCCCCC"> it is able</font><font color="#E5E5E5"> to work with any</font>

114
00:06:13,770 --> 00:06:21,090
vendor<font color="#E5E5E5"> yeah so as you saw we're manually</font>

115
00:06:18,840 --> 00:06:23,520
passing the comments to this<font color="#CCCCCC"> malware and</font>

116
00:06:21,090 --> 00:06:24,359
in real world<font color="#E5E5E5"> it will</font><font color="#CCCCCC"> be down through</font>

117
00:06:23,520 --> 00:06:26,070
the town

118
00:06:24,360 --> 00:06:29,460
that will be<font color="#CCCCCC"> implemented inside</font><font color="#E5E5E5"> the</font>

119
00:06:26,070 --> 00:06:33,210
banking network and there was the sound

120
00:06:29,460 --> 00:06:36,299
<font color="#E5E5E5">speculations</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> found the file as</font>

121
00:06:33,210 --> 00:06:39,390
malware<font color="#E5E5E5"> for the ATM and actually left</font>

122
00:06:36,300 --> 00:06:41,670
that's not true so there<font color="#E5E5E5"> is a</font><font color="#CCCCCC"> dll file</font>

123
00:06:39,390 --> 00:06:43,740
there<font color="#E5E5E5"> is some ad file this will start</font>

124
00:06:41,670 --> 00:06:46,350
this be<font color="#E5E5E5"> a</font><font color="#CCCCCC"> malicious DLL file and of</font>

125
00:06:43,740 --> 00:06:52,050
course<font color="#CCCCCC"> whitelisting is going to be</font>

126
00:06:46,350 --> 00:06:55,290
solution this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the story about testing</font>

127
00:06:52,050 --> 00:06:59,000
<font color="#E5E5E5">pen testing and grabbing access to the</font>

128
00:06:55,290 --> 00:07:01,770
<font color="#E5E5E5">ATMs through the banking network but</font>

129
00:06:59,000 --> 00:07:04,320
other case that was completely

130
00:07:01,770 --> 00:07:08,400
outstanding happened with the<font color="#CCCCCC"> blackbox</font>

131
00:07:04,320 --> 00:07:12,450
<font color="#CCCCCC">match once</font><font color="#E5E5E5"> again there was the request</font>

132
00:07:08,400 --> 00:07:17,609
<font color="#E5E5E5">from the bank and there was there was a</font>

133
00:07:12,450 --> 00:07:21,289
suspicion that the black box<font color="#E5E5E5"> was</font><font color="#CCCCCC"> locked</font>

134
00:07:17,610 --> 00:07:23,790
<font color="#E5E5E5">to the ATM</font><font color="#CCCCCC"> in eating or dispensing money</font>

135
00:07:21,290 --> 00:07:27,480
<font color="#E5E5E5">unfortunately there were no</font><font color="#CCCCCC"> cystic</font>

136
00:07:23,790 --> 00:07:29,669
cameras so the crew or the<font color="#E5E5E5"> attacker he</font>

137
00:07:27,480 --> 00:07:32,850
just placed the stickers<font color="#E5E5E5"> and they've</font>

138
00:07:29,669 --> 00:07:34,799
<font color="#E5E5E5">sent us the hard drive for forensics and</font>

139
00:07:32,850 --> 00:07:38,130
this time there<font color="#CCCCCC"> are really no looks at</font>

140
00:07:34,800 --> 00:07:40,080
all<font color="#E5E5E5"> no text files yeah no text files no</font>

141
00:07:38,130 --> 00:07:42,090
photos<font color="#CCCCCC"> just</font><font color="#E5E5E5"> a hard drive and</font>

142
00:07:40,080 --> 00:07:45,330
unfortunately<font color="#E5E5E5"> for</font><font color="#CCCCCC"> us we</font><font color="#E5E5E5"> have we haven't</font>

143
00:07:42,090 --> 00:07:48,690
<font color="#E5E5E5">found any locks about the opening the</font>

144
00:07:45,330 --> 00:07:51,810
ATM to<font color="#CCCCCC"> block the black box so for us it</font>

145
00:07:48,690 --> 00:07:54,270
was<font color="#CCCCCC"> a mystery</font><font color="#E5E5E5"> and we asked bank to</font>

146
00:07:51,810 --> 00:07:58,050
transfer physically transfer<font color="#E5E5E5"> it's really</font>

147
00:07:54,270 --> 00:08:03,450
heavy device to the office<font color="#E5E5E5"> so we can</font>

148
00:07:58,050 --> 00:08:06,930
<font color="#E5E5E5">look closer on this ATM and what was you</font>

149
00:08:03,450 --> 00:08:10,800
know completely outstanding that inside

150
00:08:06,930 --> 00:08:14,870
the deposit box<font color="#E5E5E5"> the safe box where money</font>

151
00:08:10,800 --> 00:08:19,380
allocated<font color="#E5E5E5"> we found the USB hub and</font>

152
00:08:14,870 --> 00:08:23,130
<font color="#CCCCCC">inside this hub</font><font color="#E5E5E5"> there was locked some</font>

153
00:08:19,380 --> 00:08:25,290
device so we do not<font color="#E5E5E5"> a flash</font><font color="#CCCCCC"> drive</font><font color="#E5E5E5"> and we</font>

154
00:08:23,130 --> 00:08:29,759
thought<font color="#CCCCCC"> maybe it's a new model</font><font color="#E5E5E5"> other</font>

155
00:08:25,290 --> 00:08:32,909
black box<font color="#CCCCCC"> maybe wirelessly operated but</font>

156
00:08:29,759 --> 00:08:35,550
not really but kind of so this<font color="#E5E5E5"> device</font>

157
00:08:32,909 --> 00:08:43,049
was<font color="#CCCCCC"> use</font><font color="#E5E5E5"> the bluetooth dongle for a</font>

158
00:08:35,549 --> 00:08:45,689
<font color="#E5E5E5">wireless keyboard so okay we asked it to</font>

159
00:08:43,049 --> 00:08:48,569
look on the hard drive<font color="#CCCCCC"> once again</font><font color="#E5E5E5"> and we</font>

160
00:08:45,690 --> 00:08:52,350
saw that<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are actually drivers for</font>

161
00:08:48,570 --> 00:08:54,660
the<font color="#CCCCCC"> bluetooth for the Bluetooth and we</font>

162
00:08:52,350 --> 00:08:57,870
were able<font color="#CCCCCC"> to recover all the stages</font><font color="#E5E5E5"> of</font>

163
00:08:54,660 --> 00:09:01,319
this attack so the first of all attacker

164
00:08:57,870 --> 00:09:04,230
<font color="#E5E5E5">he had access to the money to the</font>

165
00:09:01,320 --> 00:09:05,940
deposit box<font color="#CCCCCC"> but he</font><font color="#E5E5E5"> plucked this USB</font>

166
00:09:04,230 --> 00:09:07,920
bluetooth dongle then he<font color="#CCCCCC"> pair to it with</font>

167
00:09:05,940 --> 00:09:10,620
<font color="#CCCCCC">the wireless</font><font color="#E5E5E5"> keyboard then he was</font>

168
00:09:07,920 --> 00:09:14,990
waiting<font color="#E5E5E5"> for three months and the three</font>

169
00:09:10,620 --> 00:09:17,880
months<font color="#E5E5E5"> is locks rotation for the</font><font color="#CCCCCC"> ATMs</font>

170
00:09:14,990 --> 00:09:23,240
<font color="#E5E5E5">then he plays the sticker and turn out</font>

171
00:09:17,880 --> 00:09:26,639
this keyboard he rebooted<font color="#E5E5E5"> the ATM</font>

172
00:09:23,240 --> 00:09:29,970
through the control<font color="#CCCCCC"> delete then he was</font>

173
00:09:26,639 --> 00:09:32,940
booting inside the ATM desk is a special

174
00:09:29,970 --> 00:09:35,699
version of<font color="#E5E5E5"> Linux operation system for</font>

175
00:09:32,940 --> 00:09:37,410
<font color="#E5E5E5">testing it's a kind of service mode so</font>

176
00:09:35,699 --> 00:09:38,760
you can reboot in that service<font color="#E5E5E5"> code and</font>

177
00:09:37,410 --> 00:09:41,010
do whatever you like<font color="#E5E5E5"> for example</font>

178
00:09:38,760 --> 00:09:46,199
<font color="#CCCCCC">dispense all the money for testing</font>

179
00:09:41,010 --> 00:09:49,560
purposes and that's it<font color="#E5E5E5"> so after</font><font color="#CCCCCC"> we've</font>

180
00:09:46,199 --> 00:09:52,740
discovery we've decided that we we need

181
00:09:49,560 --> 00:09:57,660
<font color="#CCCCCC">to give</font><font color="#E5E5E5"> him a medal like professional</font>

182
00:09:52,740 --> 00:10:00,810
smartest so the ATM which it's about the

183
00:09:57,660 --> 00:10:03,630
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> it took maybe two</font><font color="#CCCCCC"> weeks of the</font>

184
00:10:00,810 --> 00:10:06,119
research and to write the reports for

185
00:10:03,630 --> 00:10:09,630
the<font color="#CCCCCC"> bank's about the file as malware</font><font color="#E5E5E5"> so</font>

186
00:10:06,120 --> 00:10:14,760
this case took like one<font color="#CCCCCC"> week</font><font color="#E5E5E5"> several</font>

187
00:10:09,630 --> 00:10:17,579
<font color="#E5E5E5">days but the third case that</font><font color="#CCCCCC"> was amazing</font>

188
00:10:14,760 --> 00:10:20,819
it's a<font color="#CCCCCC"> to hard work you</font><font color="#E5E5E5"> know everything</font>

189
00:10:17,579 --> 00:10:23,219
involved<font color="#E5E5E5"> in drilling is physical work so</font>

190
00:10:20,819 --> 00:10:26,639
we had to invest much more<font color="#E5E5E5"> resources</font>

191
00:10:23,220 --> 00:10:29,819
into<font color="#E5E5E5"> this case and I hope you will like</font>

192
00:10:26,639 --> 00:10:35,760
the story how this research<font color="#E5E5E5"> project</font>

193
00:10:29,819 --> 00:10:38,579
<font color="#E5E5E5">started request from the bank</font><font color="#CCCCCC"> and it's a</font>

194
00:10:35,760 --> 00:10:41,010
<font color="#E5E5E5">story it's</font><font color="#CCCCCC"> not actually a request</font><font color="#E5E5E5"> yes</font>

195
00:10:38,579 --> 00:10:44,699
it's a story<font color="#CCCCCC"> okay so go on so</font>

196
00:10:41,010 --> 00:10:48,600
a bank calls us with a story<font color="#E5E5E5"> about</font><font color="#CCCCCC"> guy</font>

197
00:10:44,699 --> 00:10:50,880
<font color="#CCCCCC">who came</font><font color="#E5E5E5"> in the daylight to an ATM</font><font color="#CCCCCC"> an</font>

198
00:10:48,600 --> 00:10:54,060
outdoor ATM located near a bank office

199
00:10:50,880 --> 00:10:57,089
and the guy was drilling a hole in the

200
00:10:54,060 --> 00:11:00,349
ATM<font color="#E5E5E5"> well but he was dressed as a</font>

201
00:10:57,089 --> 00:11:03,420
construction<font color="#E5E5E5"> worker some nobody cared</font>

202
00:11:00,350 --> 00:11:05,579
then a suspicious police patrol was

203
00:11:03,420 --> 00:11:09,329
coming by<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the earth the guy for an ID</font>

204
00:11:05,579 --> 00:11:12,540
but the<font color="#CCCCCC"> guy didn't quite do it</font><font color="#E5E5E5"> he just</font>

205
00:11:09,329 --> 00:11:15,029
started to<font color="#E5E5E5"> run</font><font color="#CCCCCC"> away and he was tearing</font>

206
00:11:12,540 --> 00:11:17,519
<font color="#E5E5E5">something that he had with it and trying</font>

207
00:11:15,029 --> 00:11:19,889
<font color="#E5E5E5">to break</font><font color="#CCCCCC"> something down</font><font color="#E5E5E5"> and eventually</font>

208
00:11:17,519 --> 00:11:23,160
he was<font color="#CCCCCC"> captured and as it turned out</font><font color="#E5E5E5"> he</font>

209
00:11:19,889 --> 00:11:27,120
<font color="#CCCCCC">had a laptop a</font><font color="#E5E5E5"> cable some small box and</font>

210
00:11:23,160 --> 00:11:29,610
<font color="#CCCCCC">a drill but when he was detained he</font>

211
00:11:27,120 --> 00:11:33,600
didn't say anything<font color="#E5E5E5"> and everyone was</font>

212
00:11:29,610 --> 00:11:36,600
puzzled<font color="#E5E5E5"> like what's going on so for us</font>

213
00:11:33,600 --> 00:11:39,810
this<font color="#CCCCCC"> was we try to imagine the whole</font><font color="#E5E5E5"> des</font>

214
00:11:36,600 --> 00:11:43,079
story<font color="#E5E5E5"> in the middle</font><font color="#CCCCCC"> of the day</font><font color="#E5E5E5"> and we</font>

215
00:11:39,810 --> 00:11:47,849
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> ask Bank for details</font><font color="#E5E5E5"> and</font>

216
00:11:43,079 --> 00:11:49,469
<font color="#CCCCCC">details</font><font color="#E5E5E5"> came to us with the photos the</font>

217
00:11:47,850 --> 00:11:51,959
guy looked<font color="#CCCCCC"> like he came straight from</font>

218
00:11:49,470 --> 00:11:54,329
<font color="#E5E5E5">the DIY shop very</font><font color="#CCCCCC"> well-dressed</font><font color="#E5E5E5"> as a</font>

219
00:11:51,959 --> 00:11:56,880
construction<font color="#E5E5E5"> worker and good rail and a</font>

220
00:11:54,329 --> 00:11:59,189
special bit<font color="#E5E5E5"> yeah brainy the whole video</font>

221
00:11:56,880 --> 00:12:05,399
was looks<font color="#E5E5E5"> like</font><font color="#CCCCCC"> business wins for the</font><font color="#E5E5E5"> box</font>

222
00:11:59,190 --> 00:12:07,829
<font color="#CCCCCC">since it and advertising that's real</font>

223
00:12:05,399 --> 00:12:10,050
fall it was<font color="#E5E5E5"> done in the plastic case of</font>

224
00:12:07,829 --> 00:12:13,260
the ATM near the<font color="#CCCCCC"> pinhead and there is</font>

225
00:12:10,050 --> 00:12:14,760
some cabling going nearby so<font color="#E5E5E5"> that must</font>

226
00:12:13,260 --> 00:12:17,579
<font color="#E5E5E5">have been the key because then the guy</font>

227
00:12:14,760 --> 00:12:22,439
started to seek his own cables in<font color="#CCCCCC"> the</font>

228
00:12:17,579 --> 00:12:24,000
fall and to do something with<font color="#CCCCCC"> it</font><font color="#E5E5E5"> we</font>

229
00:12:22,440 --> 00:12:26,850
first thought it<font color="#E5E5E5"> was something unique</font>

230
00:12:24,000 --> 00:12:29,190
<font color="#E5E5E5">but then we started</font><font color="#CCCCCC"> looking for it and</font>

231
00:12:26,850 --> 00:12:32,220
<font color="#E5E5E5">found out</font><font color="#CCCCCC"> that there are also some</font><font color="#E5E5E5"> cases</font>

232
00:12:29,190 --> 00:12:34,470
in Europe<font color="#E5E5E5"> but</font><font color="#CCCCCC"> the holes are not</font><font color="#E5E5E5"> so</font>

233
00:12:32,220 --> 00:12:38,519
perfectly done<font color="#E5E5E5"> still they are running</font>

234
00:12:34,470 --> 00:12:41,850
<font color="#E5E5E5">near the wires</font><font color="#CCCCCC"> so there must</font><font color="#E5E5E5"> be</font>

235
00:12:38,519 --> 00:12:45,329
something<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the wires so we went</font><font color="#CCCCCC"> to</font>

236
00:12:41,850 --> 00:12:47,699
the<font color="#CCCCCC"> ATM to realize I mean we were</font><font color="#E5E5E5"> lucky</font>

237
00:12:45,329 --> 00:12:52,138
enough<font color="#CCCCCC"> that we have the same money</font>

238
00:12:47,699 --> 00:12:57,149
sure the same series of<font color="#E5E5E5"> the ATM and so</font>

239
00:12:52,139 --> 00:13:01,230
the main question from the bank was what

240
00:12:57,149 --> 00:13:04,559
was the hell happened<font color="#E5E5E5"> so when the guy</font>

241
00:13:01,230 --> 00:13:07,290
was captured the law enforcement they

242
00:13:04,559 --> 00:13:09,358
were<font color="#CCCCCC"> able to charge like</font><font color="#E5E5E5"> the hooligans</font>

243
00:13:07,290 --> 00:13:14,549
before because<font color="#CCCCCC"> he</font><font color="#E5E5E5"> was physically</font>

244
00:13:09,359 --> 00:13:17,669
damaging<font color="#CCCCCC"> it</font><font color="#E5E5E5"> here but why there must be</font>

245
00:13:14,549 --> 00:13:22,350
some<font color="#CCCCCC"> reason for</font><font color="#E5E5E5"> some reason so we went</font>

246
00:13:17,669 --> 00:13:25,290
to<font color="#E5E5E5"> the ATM in our lab and started look</font>

247
00:13:22,350 --> 00:13:27,509
closely<font color="#E5E5E5"> on the photo in all the real ATM</font>

248
00:13:25,290 --> 00:13:31,498
and<font color="#E5E5E5"> what we found that this connector on</font>

249
00:13:27,509 --> 00:13:34,109
the<font color="#E5E5E5"> there's a very long wires going</font>

250
00:13:31,499 --> 00:13:36,419
through the whole ATM and<font color="#CCCCCC"> connected to</font>

251
00:13:34,109 --> 00:13:37,049
many devices<font color="#E5E5E5"> and</font><font color="#CCCCCC"> in the end there is a</font>

252
00:13:36,419 --> 00:13:42,029
board

253
00:13:37,049 --> 00:13:44,549
there's named SDC what's that we started

254
00:13:42,029 --> 00:13:46,649
to Google<font color="#E5E5E5"> for it found there is very</font>

255
00:13:44,549 --> 00:13:48,689
little<font color="#E5E5E5"> information and found out</font><font color="#CCCCCC"> that</font>

256
00:13:46,649 --> 00:13:51,329
it's called<font color="#CCCCCC"> the serial distributed</font>

257
00:13:48,689 --> 00:13:53,849
controlling and it's actually a boss

258
00:13:51,329 --> 00:13:57,199
<font color="#E5E5E5">seemed to the one you have</font><font color="#CCCCCC"> in a car that</font>

259
00:13:53,850 --> 00:14:00,299
<font color="#CCCCCC">connects all</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> devices</font><font color="#E5E5E5"> all together</font>

260
00:13:57,199 --> 00:14:04,169
but there is not<font color="#E5E5E5"> much information</font><font color="#CCCCCC"> about</font>

261
00:14:00,299 --> 00:14:05,730
what<font color="#CCCCCC"> is in</font><font color="#E5E5E5"> the bus so we started to find</font>

262
00:14:04,169 --> 00:14:07,649
it<font color="#E5E5E5"> out first of all it turned out it's</font>

263
00:14:05,730 --> 00:14:10,980
not<font color="#CCCCCC"> the serial protocol you can</font><font color="#E5E5E5"> find</font>

264
00:14:07,649 --> 00:14:14,039
anywhere<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> rs-485 it's more</font>

265
00:14:10,980 --> 00:14:16,410
industrial thing okay we found a

266
00:14:14,039 --> 00:14:19,379
converter<font color="#E5E5E5"> connected to our serial USB</font>

267
00:14:16,410 --> 00:14:22,139
adapter but it turned out that it didn't

268
00:14:19,379 --> 00:14:27,539
work<font color="#E5E5E5"> because the bus is not 8-speed it's</font>

269
00:14:22,139 --> 00:14:29,609
<font color="#CCCCCC">9 bit okay</font><font color="#E5E5E5"> eventually we found out how</font>

270
00:14:27,539 --> 00:14:32,009
to deal<font color="#CCCCCC"> with it then we collected all</font>

271
00:14:29,609 --> 00:14:35,519
<font color="#CCCCCC">these nine bits</font><font color="#E5E5E5"> and turn out</font><font color="#CCCCCC"> that the</font>

272
00:14:32,009 --> 00:14:38,069
<font color="#E5E5E5">data is encrypted and</font><font color="#CCCCCC"> the fourth</font>

273
00:14:35,519 --> 00:14:42,019
feedings are known so<font color="#E5E5E5"> we had to match</font>

274
00:14:38,069 --> 00:14:45,539
both of these to get<font color="#E5E5E5"> the actual bytes</font>

275
00:14:42,019 --> 00:14:48,809
but when we did all<font color="#CCCCCC"> of that we found</font><font color="#E5E5E5"> out</font>

276
00:14:45,539 --> 00:14:50,220
that the protocol is nothing that<font color="#CCCCCC"> you</font>

277
00:14:48,809 --> 00:14:52,589
find in common<font color="#E5E5E5"> hardware it's a</font>

278
00:14:50,220 --> 00:14:53,850
proprietary<font color="#CCCCCC"> one of course the vendor</font>

279
00:14:52,589 --> 00:14:57,929
will not disclose it

280
00:14:53,850 --> 00:15:00,239
we had to decode it<font color="#CCCCCC"> ourselves so in the</font>

281
00:14:57,929 --> 00:15:01,610
end we reply to the bank<font color="#CCCCCC"> the guys that</font>

282
00:15:00,239 --> 00:15:04,670
looks like<font color="#CCCCCC"> your</font>

283
00:15:01,610 --> 00:15:07,760
construction water he is<font color="#E5E5E5"> trying to make</font>

284
00:15:04,670 --> 00:15:10,810
some dispensing through these cables but

285
00:15:07,760 --> 00:15:14,510
<font color="#E5E5E5">it's too hard to reproduce the attack</font>

286
00:15:10,810 --> 00:15:17,569
<font color="#CCCCCC">because there are challenges and the</font>

287
00:15:14,510 --> 00:15:23,240
bank replied to<font color="#CCCCCC"> us like good job</font><font color="#E5E5E5"> keep it</font>

288
00:15:17,570 --> 00:15:26,240
up it will<font color="#E5E5E5"> make it you'll make</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> okay</font>

289
00:15:23,240 --> 00:15:26,540
<font color="#E5E5E5">we're okay</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> engineers we can make</font>

290
00:15:26,240 --> 00:15:31,220
it

291
00:15:26,540 --> 00:15:35,750
probably yeah so we started<font color="#CCCCCC"> to</font><font color="#E5E5E5"> work hard</font>

292
00:15:31,220 --> 00:15:38,390
and all this<font color="#E5E5E5"> job to five weeks</font><font color="#CCCCCC"> so we</font>

293
00:15:35,750 --> 00:15:42,130
were we were on the underground floor

294
00:15:38,390 --> 00:15:44,660
with the<font color="#E5E5E5"> ATMs</font><font color="#CCCCCC"> we grabbed</font><font color="#E5E5E5"> tons of coffee</font>

295
00:15:42,130 --> 00:15:49,430
<font color="#E5E5E5">cables</font><font color="#CCCCCC"> and all the</font><font color="#E5E5E5"> instruments that we</font>

296
00:15:44,660 --> 00:15:53,120
<font color="#E5E5E5">had well it helped somehow first we</font>

297
00:15:49,430 --> 00:15:55,160
started to find out what the wire what

298
00:15:53,120 --> 00:15:57,500
the electrical component is so we had to

299
00:15:55,160 --> 00:15:59,990
find out<font color="#E5E5E5"> what the serial bus is and what</font>

300
00:15:57,500 --> 00:16:04,310
the speed of the<font color="#E5E5E5"> bus is yeah so the</font>

301
00:15:59,990 --> 00:16:09,860
challenge<font color="#E5E5E5"> is to find the speed of</font><font color="#CCCCCC"> Silla</font>

302
00:16:04,310 --> 00:16:13,910
<font color="#E5E5E5">scope</font><font color="#CCCCCC"> also so we found out the</font><font color="#E5E5E5"> timing</font>

303
00:16:09,860 --> 00:16:16,279
the exact<font color="#CCCCCC"> format signal oh yeah</font><font color="#E5E5E5"> finally</font>

304
00:16:13,910 --> 00:16:19,430
we found it out<font color="#E5E5E5"> yeah so if we found</font><font color="#CCCCCC"> out</font>

305
00:16:16,279 --> 00:16:24,140
and<font color="#E5E5E5"> you can see the</font><font color="#CCCCCC"> once in zero zeros</font>

306
00:16:19,430 --> 00:16:28,430
inside the bus so the next challenge was

307
00:16:24,140 --> 00:16:30,829
to reach hacks read the data<font color="#E5E5E5"> so now we</font>

308
00:16:28,430 --> 00:16:33,620
need to cereal bars<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> night beat with</font>

309
00:16:30,829 --> 00:16:37,969
an<font color="#CCCCCC"> axe illogical</font><font color="#E5E5E5"> analyzer get the</font><font color="#CCCCCC"> nine</font>

310
00:16:33,620 --> 00:16:42,079
<font color="#CCCCCC">bit words</font><font color="#E5E5E5"> and try to find out what does</font>

311
00:16:37,970 --> 00:16:44,300
<font color="#CCCCCC">okay that's what we've got</font><font color="#E5E5E5"> but we're</font>

312
00:16:42,079 --> 00:16:46,760
<font color="#CCCCCC">analytic so we started to find some</font>

313
00:16:44,300 --> 00:16:49,069
pattern since to put all these patterns

314
00:16:46,760 --> 00:16:52,100
<font color="#E5E5E5">down and eventually we found out that</font>

315
00:16:49,070 --> 00:16:54,440
there are<font color="#E5E5E5"> commands that are</font><font color="#CCCCCC"> sent by the</font>

316
00:16:52,100 --> 00:16:57,140
computer<font color="#E5E5E5"> and every command is addressed</font>

317
00:16:54,440 --> 00:17:00,589
to a particular<font color="#E5E5E5"> device and every device</font>

318
00:16:57,140 --> 00:17:02,480
<font color="#CCCCCC">has an</font><font color="#E5E5E5"> address and we found the</font>

319
00:17:00,589 --> 00:17:06,020
addresses<font color="#E5E5E5"> of the printer of the LCD</font>

320
00:17:02,480 --> 00:17:08,510
<font color="#CCCCCC">screen and</font><font color="#E5E5E5"> then the dispenser</font><font color="#CCCCCC"> there it</font>

321
00:17:06,020 --> 00:17:14,000
was not enough yep because after

322
00:17:08,510 --> 00:17:15,170
successful<font color="#E5E5E5"> decryption we saw that the</font>

323
00:17:14,000 --> 00:17:17,599
protocol

324
00:17:15,170 --> 00:17:20,839
it's it's really<font color="#E5E5E5"> hard to understand so</font>

325
00:17:17,599 --> 00:17:24,619
we started to dispensing money<font color="#E5E5E5"> with</font>

326
00:17:20,839 --> 00:17:29,409
different<font color="#CCCCCC"> amounts of banknotes and we</font>

327
00:17:24,619 --> 00:17:34,360
try<font color="#E5E5E5"> to find the sum equation an equation</font>

328
00:17:29,410 --> 00:17:38,000
<font color="#E5E5E5">came to us we'll be following gifts that</font>

329
00:17:34,360 --> 00:17:41,689
well<font color="#CCCCCC"> II</font><font color="#E5E5E5"> Geum is</font><font color="#CCCCCC"> there still in common to</font>

330
00:17:38,000 --> 00:17:45,260
dispense you money<font color="#E5E5E5"> dispenser is deciding</font>

331
00:17:41,690 --> 00:17:48,560
from which<font color="#CCCCCC"> Cassatt which number of</font>

332
00:17:45,260 --> 00:17:52,760
banknotes<font color="#CCCCCC"> is going to dispense</font><font color="#E5E5E5"> so in</font>

333
00:17:48,560 --> 00:17:56,419
this case we got the multipliers<font color="#CCCCCC"> one two</font>

334
00:17:52,760 --> 00:17:57,530
<font color="#CCCCCC">three four and this</font><font color="#E5E5E5"> is the multiplier</font>

335
00:17:56,420 --> 00:18:02,140
for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> castle</font>

336
00:17:57,530 --> 00:18:06,639
so if<font color="#CCCCCC"> Bank</font><font color="#E5E5E5"> is requesting to dispense</font>

337
00:18:02,140 --> 00:18:13,790
<font color="#E5E5E5">fifteen fifteen banknotes then what the</font>

338
00:18:06,640 --> 00:18:17,240
dispenser is doing<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> 1 multiplied</font><font color="#E5E5E5"> 1</font>

339
00:18:13,790 --> 00:18:21,530
plus 1 multiplied<font color="#E5E5E5"> 2 plus 0 multiplied 3</font>

340
00:18:17,240 --> 00:18:25,250
<font color="#E5E5E5">bruised four multiplied 4 so this is</font>

341
00:18:21,530 --> 00:18:27,889
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> equation and then ATM will</font>

342
00:18:25,250 --> 00:18:28,370
dispense you<font color="#CCCCCC"> the amount</font><font color="#E5E5E5"> of money we</font>

343
00:18:27,890 --> 00:18:32,240
<font color="#CCCCCC">sugar</font>

344
00:18:28,370 --> 00:18:36,560
so this equation works with the 1590

345
00:18:32,240 --> 00:18:40,670
<font color="#CCCCCC">2931 so we've solved this equation so we</font>

346
00:18:36,560 --> 00:18:44,540
are able<font color="#E5E5E5"> to to make the request to</font>

347
00:18:40,670 --> 00:18:47,930
dispenser so we figured the command<font color="#E5E5E5"> but</font>

348
00:18:44,540 --> 00:18:50,629
when we try<font color="#E5E5E5"> to send it</font><font color="#CCCCCC"> to the bus we</font>

349
00:18:47,930 --> 00:18:53,360
failed<font color="#CCCCCC"> as it turned out the bus itself</font>

350
00:18:50,630 --> 00:18:56,420
<font color="#E5E5E5">is half duplex</font><font color="#CCCCCC"> most of the time with the</font>

351
00:18:53,360 --> 00:18:58,340
master<font color="#E5E5E5"> controller actually</font><font color="#CCCCCC"> DC that</font>

352
00:18:56,420 --> 00:19:00,490
controls the ATM holds the but

353
00:18:58,340 --> 00:19:03,409
electrically and<font color="#E5E5E5"> you can't do anything</font>

354
00:19:00,490 --> 00:19:07,370
<font color="#E5E5E5">even</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> try</font><font color="#CCCCCC"> to sense anything you will</font>

355
00:19:03,410 --> 00:19:10,820
be<font color="#CCCCCC"> muted</font><font color="#E5E5E5"> so we thought</font><font color="#CCCCCC"> that a</font><font color="#E5E5E5"> good old</font>

356
00:19:07,370 --> 00:19:13,010
injection will help so it found the

357
00:19:10,820 --> 00:19:15,169
conversation between devices<font color="#CCCCCC"> in the</font>

358
00:19:13,010 --> 00:19:19,370
computer<font color="#CCCCCC"> and found a long enough</font>

359
00:19:15,170 --> 00:19:21,950
sequence so then we try<font color="#E5E5E5"> to pretend that</font>

360
00:19:19,370 --> 00:19:25,310
we<font color="#CCCCCC"> are sending a response from some</font>

361
00:19:21,950 --> 00:19:27,620
device<font color="#E5E5E5"> but that response actually</font>

362
00:19:25,310 --> 00:19:28,800
contained another command that<font color="#E5E5E5"> are sent</font>

363
00:19:27,620 --> 00:19:30,989
to the dispenser

364
00:19:28,800 --> 00:19:33,480
and since all the devices<font color="#E5E5E5"> on the bus</font>

365
00:19:30,990 --> 00:19:35,730
<font color="#CCCCCC">trust each other</font><font color="#E5E5E5"> since the master is</font>

366
00:19:33,480 --> 00:19:39,570
holding is most of the time the

367
00:19:35,730 --> 00:19:42,840
dispenser accepted<font color="#CCCCCC"> our command so at the</font>

368
00:19:39,570 --> 00:19:47,240
<font color="#E5E5E5">end we were able to find the right place</font>

369
00:19:42,840 --> 00:19:51,179
<font color="#CCCCCC">to inject our our comments to dispenser</font>

370
00:19:47,240 --> 00:19:57,150
and this is actually likely the SQL

371
00:19:51,180 --> 00:20:01,800
injection<font color="#E5E5E5"> give me some money and it was</font>

372
00:19:57,150 --> 00:20:03,660
time<font color="#CCCCCC"> to make a proof</font><font color="#E5E5E5"> of concept</font><font color="#CCCCCC"> that we</font>

373
00:20:01,800 --> 00:20:07,310
<font color="#E5E5E5">are right we</font><font color="#CCCCCC"> needed to test the whole</font>

374
00:20:03,660 --> 00:20:09,960
idea yeah we all need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make a</font><font color="#CCCCCC"> miracle</font>

375
00:20:07,310 --> 00:20:11,790
<font color="#E5E5E5">yes so we need</font><font color="#CCCCCC"> the developer</font><font color="#E5E5E5"> so this</font>

376
00:20:09,960 --> 00:20:18,060
<font color="#E5E5E5">this man on the photo he is a developer</font>

377
00:20:11,790 --> 00:20:22,350
<font color="#CCCCCC">and I'm supported I'll get the</font>

378
00:20:18,060 --> 00:20:25,260
flashlight<font color="#E5E5E5"> and</font><font color="#CCCCCC"> of course we really</font>

379
00:20:22,350 --> 00:20:27,750
<font color="#CCCCCC">testing and with handfuls of the time</font>

380
00:20:25,260 --> 00:20:29,850
actually<font color="#CCCCCC"> test anything because so during</font>

381
00:20:27,750 --> 00:20:31,890
the board is<font color="#CCCCCC"> ok but then</font><font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to</font>

382
00:20:29,850 --> 00:20:33,419
write the<font color="#E5E5E5"> fervor that</font><font color="#CCCCCC"> will actually make</font>

383
00:20:31,890 --> 00:20:35,700
<font color="#E5E5E5">the injection</font><font color="#CCCCCC"> and send the proper</font>

384
00:20:33,420 --> 00:20:38,220
commands<font color="#E5E5E5"> and the problem is every time</font>

385
00:20:35,700 --> 00:20:41,490
<font color="#CCCCCC">you make a</font><font color="#E5E5E5"> bark it</font><font color="#CCCCCC"> sends</font><font color="#E5E5E5"> something wrong</font>

386
00:20:38,220 --> 00:20:43,230
to the wire<font color="#E5E5E5"> the ETM reboot and you have</font>

387
00:20:41,490 --> 00:20:46,440
to wait another 10 minutes<font color="#E5E5E5"> for it</font><font color="#CCCCCC"> to</font>

388
00:20:43,230 --> 00:20:54,450
boot<font color="#CCCCCC"> again I was sleeping for 10 minutes</font>

389
00:20:46,440 --> 00:20:55,830
<font color="#E5E5E5">not more so this is the device as it</font>

390
00:20:54,450 --> 00:20:58,380
turned out<font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> need anything</font>

391
00:20:55,830 --> 00:21:00,899
complicated<font color="#E5E5E5"> to actually do the injection</font>

392
00:20:58,380 --> 00:21:03,540
<font color="#E5E5E5">we took one micro controller the one</font>

393
00:21:00,900 --> 00:21:05,820
<font color="#E5E5E5">just we had in the Attic it's an 8 bit</font>

394
00:21:03,540 --> 00:21:10,379
<font color="#E5E5E5">head mega</font><font color="#CCCCCC"> MTU similar to the one in</font>

395
00:21:05,820 --> 00:21:13,110
Arduino we used 12<font color="#CCCCCC"> megahertz crystal to</font>

396
00:21:10,380 --> 00:21:14,540
match the speed<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> bus</font><font color="#E5E5E5"> and we used</font>

397
00:21:13,110 --> 00:21:17,939
an rs-485

398
00:21:14,540 --> 00:21:22,590
converter has been buy very cheap less

399
00:21:17,940 --> 00:21:25,380
for<font color="#E5E5E5"> a dollar then we had an LED and we</font>

400
00:21:22,590 --> 00:21:28,550
set it<font color="#CCCCCC"> up to send the data</font><font color="#E5E5E5"> on a proper</font>

401
00:21:25,380 --> 00:21:32,090
data rate<font color="#E5E5E5"> that's it the product is ready</font>

402
00:21:28,550 --> 00:21:35,340
we even thought that<font color="#E5E5E5"> since may be funded</font>

403
00:21:32,090 --> 00:21:37,620
<font color="#E5E5E5">but we're a bit afraid of potential</font>

404
00:21:35,340 --> 00:21:39,129
shady customers we don't want to meet

405
00:21:37,620 --> 00:21:43,899
them<font color="#E5E5E5"> in person</font>

406
00:21:39,130 --> 00:21:47,410
so at the<font color="#E5E5E5"> end we were</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to plug this</font>

407
00:21:43,900 --> 00:21:52,150
device to the ATM and<font color="#CCCCCC"> here you see</font>

408
00:21:47,410 --> 00:21:54,940
blinks<font color="#CCCCCC"> we which means that we</font><font color="#E5E5E5"> are able</font>

409
00:21:52,150 --> 00:21:57,280
<font color="#CCCCCC">to inject our comments</font><font color="#E5E5E5"> and at the end we</font>

410
00:21:54,940 --> 00:21:59,350
replied<font color="#E5E5E5"> to the bank that we were able to</font>

411
00:21:57,280 --> 00:22:04,389
<font color="#E5E5E5">successfully reproduce the attack of</font>

412
00:21:59,350 --> 00:22:08,490
this construction worker<font color="#E5E5E5"> so how does it</font>

413
00:22:04,390 --> 00:22:11,620
looks like in the reward<font color="#CCCCCC"> so that's me</font>

414
00:22:08,490 --> 00:22:14,980
and<font color="#E5E5E5"> the bus in</font><font color="#CCCCCC"> this device</font><font color="#E5E5E5"> we didn't</font>

415
00:22:11,620 --> 00:22:17,620
drill a hole in our ATM<font color="#E5E5E5"> because we still</font>

416
00:22:14,980 --> 00:22:19,630
<font color="#E5E5E5">need</font><font color="#CCCCCC"> it and didn't</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> break it so</font>

417
00:22:17,620 --> 00:22:23,428
we connected the wire to the<font color="#E5E5E5"> same port</font>

418
00:22:19,630 --> 00:22:26,799
inside the ATM<font color="#E5E5E5"> with a long wire but</font>

419
00:22:23,429 --> 00:22:29,260
that's it<font color="#E5E5E5"> there are no other differences</font>

420
00:22:26,799 --> 00:22:31,720
from the<font color="#E5E5E5"> actual attack we are</font><font color="#CCCCCC"> firing up</font>

421
00:22:29,260 --> 00:22:34,299
the device<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> ending</font><font color="#E5E5E5"> waiting for a</font>

422
00:22:31,720 --> 00:22:38,409
proper<font color="#E5E5E5"> sequence of data on the bus to</font>

423
00:22:34,299 --> 00:22:44,760
inject<font color="#CCCCCC"> the rejection occurs and</font><font color="#E5E5E5"> the</font>

424
00:22:38,409 --> 00:22:44,760
dispenser<font color="#CCCCCC"> starts</font><font color="#E5E5E5"> to work that's it</font>

425
00:22:46,550 --> 00:22:55,639
[Applause]

426
00:22:51,790 --> 00:22:57,860
but we are<font color="#CCCCCC"> quite head and think that</font>

427
00:22:55,640 --> 00:23:01,370
<font color="#E5E5E5">having such a device in the possession</font>

428
00:22:57,860 --> 00:23:03,139
is too<font color="#CCCCCC"> dangerous so that's the</font><font color="#E5E5E5"> only one</font>

429
00:23:01,370 --> 00:23:03,800
<font color="#E5E5E5">that we have and we would like to break</font>

430
00:23:03,140 --> 00:23:08,690
it up

431
00:23:03,800 --> 00:23:14,030
this is this board so in the hole we've

432
00:23:08,690 --> 00:23:16,010
got the ATM in the reception<font color="#E5E5E5"> so you just</font>

433
00:23:14,030 --> 00:23:19,250
connect it and<font color="#E5E5E5"> that's it</font>

434
00:23:16,010 --> 00:23:23,600
you need a 9-volt battery by the way but

435
00:23:19,250 --> 00:23:28,370
we<font color="#E5E5E5"> are the white cells so we think that</font>

436
00:23:23,600 --> 00:23:30,919
<font color="#E5E5E5">this board it's evil</font><font color="#CCCCCC"> - dangerous -</font>

437
00:23:28,370 --> 00:23:34,840
dangerous<font color="#CCCCCC"> in what goodman doing with the</font>

438
00:23:30,920 --> 00:23:34,840
dangerous<font color="#E5E5E5"> come on</font>

439
00:23:35,920 --> 00:23:55,450
- good soldering job so that's it<font color="#CCCCCC"> we</font>

440
00:23:49,940 --> 00:23:55,450
solve the problem and<font color="#E5E5E5"> we done</font>

441
00:23:55,970 --> 00:24:04,660
thank you

442
00:23:57,940 --> 00:24:04,660
[Applause]

