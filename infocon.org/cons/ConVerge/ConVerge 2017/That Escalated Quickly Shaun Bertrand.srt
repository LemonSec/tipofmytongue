1
00:00:07,770 --> 00:00:11,670
[Music]

2
00:00:09,320 --> 00:00:13,559
returning<font color="#E5E5E5"> the</font><font color="#CCCCCC"> truck</font><font color="#E5E5E5"> one after lunch</font><font color="#CCCCCC"> I</font>

3
00:00:11,670 --> 00:00:15,870
feel a little<font color="#E5E5E5"> sensitive</font><font color="#CCCCCC"> balcony's week</font>

4
00:00:13,559 --> 00:00:17,640
<font color="#CCCCCC">we're going to get</font><font color="#E5E5E5"> trained</font><font color="#CCCCCC"> ratings</font>

5
00:00:15,870 --> 00:00:24,180
<font color="#E5E5E5">welcome</font><font color="#CCCCCC"> children would that explain</font><font color="#E5E5E5"> it</font>

6
00:00:17,640 --> 00:00:27,869
quickly thank you for the simple and

7
00:00:24,180 --> 00:00:29,130
warm welcome appreciate<font color="#CCCCCC"> that so what</font>

8
00:00:27,869 --> 00:00:30,390
we're<font color="#E5E5E5"> going to do today we're going to</font>

9
00:00:29,130 --> 00:00:32,969
talk through<font color="#CCCCCC"> a few things would be</font><font color="#E5E5E5"> quick</font>

10
00:00:30,390 --> 00:00:34,980
<font color="#E5E5E5">introduction of</font><font color="#CCCCCC"> myself talk through some</font>

11
00:00:32,969 --> 00:00:37,110
<font color="#E5E5E5">of the assumptions</font><font color="#CCCCCC"> before we get started</font>

12
00:00:34,980 --> 00:00:38,940
into<font color="#E5E5E5"> the cop the core topic of this</font>

13
00:00:37,110 --> 00:00:40,739
<font color="#E5E5E5">conversation</font><font color="#CCCCCC"> then we're going to talk</font>

14
00:00:38,940 --> 00:00:43,860
specifically about a<font color="#E5E5E5"> workflow that we</font>

15
00:00:40,739 --> 00:00:47,339
developed that<font color="#E5E5E5"> in essentially helps from</font>

16
00:00:43,860 --> 00:00:48,480
a<font color="#CCCCCC"> privilege</font><font color="#E5E5E5"> escalation perspective we're</font>

17
00:00:47,340 --> 00:00:50,219
going to<font color="#CCCCCC"> give you</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> details here</font>

18
00:00:48,480 --> 00:00:51,870
soon then we're going<font color="#CCCCCC"> to dive into</font><font color="#E5E5E5"> some</font>

19
00:00:50,219 --> 00:00:54,360
of<font color="#E5E5E5"> the granular characteristics and some</font>

20
00:00:51,870 --> 00:00:57,089
of the attack models that we leverage on

21
00:00:54,360 --> 00:00:59,850
our red team<font color="#CCCCCC"> and then talk about some</font>

22
00:00:57,090 --> 00:01:01,289
detective and preventative controls that

23
00:00:59,850 --> 00:01:03,239
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> all take</font><font color="#E5E5E5"> away from this thing I</font>

24
00:01:01,289 --> 00:01:04,890
<font color="#E5E5E5">think it's pretty cool I'll be handing</font>

25
00:01:03,239 --> 00:01:06,600
out<font color="#E5E5E5"> the slide afterwards our</font><font color="#CCCCCC"> role you</font>

26
00:01:04,890 --> 00:01:07,619
know we've got the recording<font color="#E5E5E5"> but there's</font>

27
00:01:06,600 --> 00:01:09,240
a lot<font color="#E5E5E5"> of stuff included in the</font>

28
00:01:07,619 --> 00:01:10,890
<font color="#E5E5E5">presentation itself that you might be</font>

29
00:01:09,240 --> 00:01:13,408
<font color="#E5E5E5">able to take</font><font color="#CCCCCC"> advantage of them</font><font color="#E5E5E5"> I'm not</font>

30
00:01:10,890 --> 00:01:17,880
<font color="#E5E5E5">you know scared to share out with you</font>

31
00:01:13,409 --> 00:01:20,880
afterwards so a little<font color="#E5E5E5"> bit about me I've</font>

32
00:01:17,880 --> 00:01:24,390
been<font color="#E5E5E5"> in the industry for</font><font color="#CCCCCC"> about 15-20</font>

33
00:01:20,880 --> 00:01:27,330
<font color="#E5E5E5">years InfoSec computer hacking basically</font>

34
00:01:24,390 --> 00:01:29,009
penetration tester<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> vp</font><font color="#E5E5E5"> of the</font>

35
00:01:27,330 --> 00:01:31,590
incident<font color="#CCCCCC"> response and</font><font color="#E5E5E5"> red team at a</font>

36
00:01:29,009 --> 00:01:33,630
company called cbi<font color="#E5E5E5"> apparently</font><font color="#CCCCCC"> I'm an</font>

37
00:01:31,590 --> 00:01:36,479
overall great guy I<font color="#E5E5E5"> don't know where</font>

38
00:01:33,630 --> 00:01:38,339
that<font color="#CCCCCC"> came from but obsession with</font>

39
00:01:36,479 --> 00:01:40,200
hacking security vendors products yeah

40
00:01:38,340 --> 00:01:42,689
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know I've I do a lot of bug bounty</font>

41
00:01:40,200 --> 00:01:44,490
stuff and like to focus<font color="#E5E5E5"> my efforts on</font>

42
00:01:42,689 --> 00:01:47,000
the actual security<font color="#E5E5E5"> vendors</font><font color="#CCCCCC"> product so</font>

43
00:01:44,490 --> 00:01:48,929
it's kind of cool<font color="#CCCCCC"> it's one of my</font><font color="#E5E5E5"> hobbies</font>

44
00:01:47,000 --> 00:01:52,020
<font color="#CCCCCC">currently mastering the art of potty</font>

45
00:01:48,930 --> 00:01:53,610
<font color="#E5E5E5">training not me but</font><font color="#CCCCCC"> my two boys so from</font>

46
00:01:52,020 --> 00:01:55,470
a<font color="#E5E5E5"> personal perspective I've got twin</font>

47
00:01:53,610 --> 00:01:58,710
<font color="#CCCCCC">boys two and a half years old it's utter</font>

48
00:01:55,470 --> 00:02:00,210
bedlam<font color="#E5E5E5"> in our household right now</font><font color="#CCCCCC"> but</font>

49
00:01:58,710 --> 00:02:03,360
something that's that's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> I guess</font>

50
00:02:00,210 --> 00:02:05,280
cool<font color="#CCCCCC"> and</font><font color="#E5E5E5"> also if you know anything about</font>

51
00:02:03,360 --> 00:02:06,990
me<font color="#E5E5E5"> I</font><font color="#CCCCCC"> wait make a lot</font><font color="#E5E5E5"> of subtle</font>

52
00:02:05,280 --> 00:02:08,520
<font color="#E5E5E5">Spaceballs references I love the movies</font>

53
00:02:06,990 --> 00:02:10,590
<font color="#CCCCCC">baseball</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of relevance when it</font>

54
00:02:08,520 --> 00:02:12,660
comes to<font color="#CCCCCC"> path</font><font color="#E5E5E5"> from computer security</font>

55
00:02:10,590 --> 00:02:13,290
password<font color="#E5E5E5"> is one two</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> four five I</font>

56
00:02:12,660 --> 00:02:16,409
<font color="#E5E5E5">think someone</font>

57
00:02:13,290 --> 00:02:17,879
the CTF and<font color="#E5E5E5"> G that was going on</font><font color="#CCCCCC"> so those</font>

58
00:02:16,409 --> 00:02:20,760
<font color="#E5E5E5">that know me know</font><font color="#CCCCCC"> that this is something</font>

59
00:02:17,879 --> 00:02:22,230
<font color="#CCCCCC">that</font><font color="#E5E5E5"> I like to talk about a lot</font><font color="#CCCCCC"> what I'm</font>

60
00:02:20,760 --> 00:02:25,439
<font color="#E5E5E5">talking about here today does not</font>

61
00:02:22,230 --> 00:02:27,858
<font color="#CCCCCC">represent</font><font color="#E5E5E5"> the views</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> or opinion of my</font>

62
00:02:25,439 --> 00:02:32,939
employer<font color="#E5E5E5"> of course had to drop the</font>

63
00:02:27,859 --> 00:02:35,519
disclaimer there so working<font color="#E5E5E5"> on the red</font>

64
00:02:32,939 --> 00:02:38,879
<font color="#E5E5E5">team for</font><font color="#CCCCCC"> 15</font><font color="#E5E5E5"> years has allowed us to</font>

65
00:02:35,519 --> 00:02:40,530
<font color="#CCCCCC">identify</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> things that really work</font>

66
00:02:38,879 --> 00:02:41,638
and some things<font color="#CCCCCC"> that</font><font color="#E5E5E5"> don't work</font><font color="#CCCCCC"> and</font>

67
00:02:40,530 --> 00:02:43,680
we're<font color="#E5E5E5"> going to talk about that but</font><font color="#CCCCCC"> just</font>

68
00:02:41,639 --> 00:02:44,969
<font color="#E5E5E5">a</font><font color="#CCCCCC"> little bit on the red team itself</font><font color="#E5E5E5"> you</font>

69
00:02:43,680 --> 00:02:47,129
know we do all<font color="#E5E5E5"> the things</font><font color="#CCCCCC"> that you would</font>

70
00:02:44,969 --> 00:02:48,840
<font color="#CCCCCC">expect us to do right we spend a lot of</font>

71
00:02:47,129 --> 00:02:51,179
time in the industrial control state of

72
00:02:48,840 --> 00:02:52,980
space we do a lot social engineering<font color="#E5E5E5"> web</font>

73
00:02:51,180 --> 00:02:54,150
application testing and<font color="#E5E5E5"> incident</font>

74
00:02:52,980 --> 00:02:55,858
<font color="#E5E5E5">response</font>

75
00:02:54,150 --> 00:02:59,159
anybody else have<font color="#E5E5E5"> one of these metals</font>

76
00:02:55,859 --> 00:03:00,000
from<font color="#CCCCCC"> hacker Pentagon</font><font color="#E5E5E5"> hack the</font><font color="#CCCCCC"> army</font><font color="#E5E5E5"> it's</font>

77
00:02:59,159 --> 00:03:02,400
a pretty<font color="#CCCCCC"> small</font>

78
00:03:00,000 --> 00:03:04,709
invitation<font color="#E5E5E5"> happened last year and</font>

79
00:03:02,400 --> 00:03:07,169
earlier this year and we did pretty<font color="#E5E5E5"> good</font>

80
00:03:04,709 --> 00:03:09,599
<font color="#E5E5E5">on the red team and were awarded some of</font>

81
00:03:07,169 --> 00:03:11,370
these medals<font color="#E5E5E5"> we're experienced we're</font>

82
00:03:09,599 --> 00:03:12,840
extremely<font color="#E5E5E5"> passionate you know</font><font color="#CCCCCC"> when we</font>

83
00:03:11,370 --> 00:03:15,629
got<font color="#E5E5E5"> into this when I got into this</font>

84
00:03:12,840 --> 00:03:17,489
industry 15 20 years ago<font color="#E5E5E5"> was it because</font>

85
00:03:15,629 --> 00:03:19,228
I thought information security was going

86
00:03:17,489 --> 00:03:21,030
to be the lucrative market to be and I

87
00:03:19,229 --> 00:03:23,400
got in<font color="#E5E5E5"> it because I thought it was cool</font>

88
00:03:21,030 --> 00:03:25,500
joined<font color="#CCCCCC"> 2600 meetings you</font><font color="#E5E5E5"> know 20 years</font>

89
00:03:23,400 --> 00:03:27,720
<font color="#E5E5E5">ago</font><font color="#CCCCCC"> and started to get</font><font color="#E5E5E5"> some</font>

90
00:03:25,500 --> 00:03:29,430
<font color="#CCCCCC">understanding of what this stuff is</font><font color="#E5E5E5"> all</font>

91
00:03:27,720 --> 00:03:31,349
about and then one day<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> how</font>

92
00:03:29,430 --> 00:03:34,500
<font color="#CCCCCC">it happened</font><font color="#E5E5E5"> but I went through</font><font color="#CCCCCC"> a</font>

93
00:03:31,349 --> 00:03:36,119
presentation<font color="#CCCCCC"> CBI was giving</font><font color="#E5E5E5"> talking</font>

94
00:03:34,500 --> 00:03:38,190
about information<font color="#CCCCCC"> security and at the</font>

95
00:03:36,120 --> 00:03:39,959
time nobody<font color="#E5E5E5"> was given seminars talking</font>

96
00:03:38,190 --> 00:03:42,500
about<font color="#CCCCCC"> InfoSec so I really</font><font color="#E5E5E5"> thought it was</font>

97
00:03:39,959 --> 00:03:46,949
cool<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Here I am 15 layers later</font>

98
00:03:42,500 --> 00:03:49,680
running the red team so what do we<font color="#E5E5E5"> want</font>

99
00:03:46,949 --> 00:03:52,859
to talk<font color="#E5E5E5"> about today</font><font color="#CCCCCC"> I want to empower</font>

100
00:03:49,680 --> 00:03:54,329
the audience on<font color="#E5E5E5"> the ease and severity of</font>

101
00:03:52,859 --> 00:03:56,400
<font color="#E5E5E5">some of these privilege escalation</font>

102
00:03:54,329 --> 00:03:57,720
attacks<font color="#CCCCCC"> you know a lot of</font><font color="#E5E5E5"> people here</font>

103
00:03:56,400 --> 00:04:00,930
today may know<font color="#E5E5E5"> of the very traditional</font>

104
00:03:57,720 --> 00:04:03,180
<font color="#CCCCCC">type of attacks such</font><font color="#E5E5E5"> as as patch related</font>

105
00:04:00,930 --> 00:04:07,290
vulnerabilities but boy oh boy<font color="#E5E5E5"> there is</font>

106
00:04:03,180 --> 00:04:09,840
a ton<font color="#CCCCCC"> of cool manual advanced</font><font color="#E5E5E5"> kind of</font>

107
00:04:07,290 --> 00:04:11,250
sophisticated techniques that it's not

108
00:04:09,840 --> 00:04:12,659
rocket science<font color="#CCCCCC"> either</font><font color="#E5E5E5"> so I'm going</font><font color="#CCCCCC"> to</font>

109
00:04:11,250 --> 00:04:15,509
walk you<font color="#CCCCCC"> through some of those scenarios</font>

110
00:04:12,659 --> 00:04:17,339
and<font color="#E5E5E5"> better equip the audience to do two</font>

111
00:04:15,509 --> 00:04:19,019
<font color="#CCCCCC">things either take</font><font color="#E5E5E5"> advantage of this</font>

112
00:04:17,339 --> 00:04:20,190
from a<font color="#CCCCCC"> Red Team</font><font color="#E5E5E5"> perspective do some of</font>

113
00:04:19,019 --> 00:04:21,810
these<font color="#E5E5E5"> things on your</font><font color="#CCCCCC"> own if you're</font><font color="#E5E5E5"> not</font>

114
00:04:20,190 --> 00:04:23,639
already familiarized with the concepts

115
00:04:21,810 --> 00:04:25,470
but also for the blue team perspective

116
00:04:23,639 --> 00:04:27,900
<font color="#E5E5E5">I'm going to give you like it</font>

117
00:04:25,470 --> 00:04:30,600
some detection and<font color="#E5E5E5"> prevention</font>

118
00:04:27,900 --> 00:04:32,909
recommendations<font color="#CCCCCC"> that I truly believe you</font>

119
00:04:30,600 --> 00:04:35,430
<font color="#CCCCCC">can take advantage of in creating</font>

120
00:04:32,910 --> 00:04:37,460
certain<font color="#CCCCCC"> similar certifications alerts</font>

121
00:04:35,430 --> 00:04:39,870
logging whatever it might be<font color="#CCCCCC"> and a</font>

122
00:04:37,460 --> 00:04:42,120
<font color="#E5E5E5">relatively informal guy</font><font color="#CCCCCC"> so there'll be a</font>

123
00:04:39,870 --> 00:04:43,470
<font color="#E5E5E5">Q&A session at the</font><font color="#CCCCCC"> end but if you see</font>

124
00:04:42,120 --> 00:04:45,090
anything that comes up<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> just</font>

125
00:04:43,470 --> 00:04:47,330
<font color="#E5E5E5">want to raise your hand or throw</font>

126
00:04:45,090 --> 00:04:51,150
<font color="#CCCCCC">something at me</font><font color="#E5E5E5"> as long as</font><font color="#CCCCCC"> it's soft</font>

127
00:04:47,330 --> 00:04:53,190
<font color="#CCCCCC">cool</font><font color="#E5E5E5"> we'll be on the same page</font><font color="#CCCCCC"> so we'll</font>

128
00:04:51,150 --> 00:04:54,870
we'll discuss the workflow logic that<font color="#E5E5E5"> we</font>

129
00:04:53,190 --> 00:04:57,390
put together why we created this

130
00:04:54,870 --> 00:05:00,810
workflow logic and again talk about some

131
00:04:57,390 --> 00:05:02,400
<font color="#E5E5E5">of those specific attack vectors all</font>

132
00:05:00,810 --> 00:05:04,140
right<font color="#E5E5E5"> here's some assumptions that</font><font color="#CCCCCC"> we're</font>

133
00:05:02,400 --> 00:05:06,090
going to make right off the bat when we

134
00:05:04,140 --> 00:05:07,740
talk about<font color="#CCCCCC"> privilege escalation</font><font color="#E5E5E5"> for</font>

135
00:05:06,090 --> 00:05:10,109
those<font color="#E5E5E5"> that haven't done this</font><font color="#CCCCCC"> we're</font>

136
00:05:07,740 --> 00:05:12,600
completely well familiarized with with

137
00:05:10,110 --> 00:05:15,540
Red Team penetration testing gaining

138
00:05:12,600 --> 00:05:18,630
domain user rights<font color="#E5E5E5"> is inevitable</font>

139
00:05:15,540 --> 00:05:20,520
<font color="#E5E5E5">okay 99.9% of the time we're</font><font color="#CCCCCC"> going to be</font>

140
00:05:18,630 --> 00:05:22,469
able to come in<font color="#E5E5E5"> and whether it's through</font>

141
00:05:20,520 --> 00:05:24,060
a<font color="#E5E5E5"> social engineering attack using some</font>

142
00:05:22,470 --> 00:05:26,400
of those obfuscation<font color="#E5E5E5"> tools that we'll</font>

143
00:05:24,060 --> 00:05:29,160
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> here man-in-the-middle</font>

144
00:05:26,400 --> 00:05:31,409
attacks<font color="#CCCCCC"> super popular now right</font><font color="#E5E5E5"> anybody</font>

145
00:05:29,160 --> 00:05:34,500
who doesn't know<font color="#CCCCCC"> about responder you</font>

146
00:05:31,410 --> 00:05:36,630
<font color="#CCCCCC">need to know</font><font color="#E5E5E5"> because it's so easy</font><font color="#CCCCCC"> and</font>

147
00:05:34,500 --> 00:05:37,620
<font color="#E5E5E5">vulnerability exploitation</font><font color="#CCCCCC"> you know when</font>

148
00:05:36,630 --> 00:05:38,820
we talk about<font color="#E5E5E5"> patch these</font>

149
00:05:37,620 --> 00:05:41,130
vulnerabilities they're still out there

150
00:05:38,820 --> 00:05:43,200
<font color="#CCCCCC">not as prevalent</font><font color="#E5E5E5"> but we're going to talk</font>

151
00:05:41,130 --> 00:05:45,090
<font color="#E5E5E5">about some of</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> things but you got</font>

152
00:05:43,200 --> 00:05:47,370
to understand something<font color="#E5E5E5"> first and</font>

153
00:05:45,090 --> 00:05:51,239
<font color="#E5E5E5">foremost about this getting a domain</font>

154
00:05:47,370 --> 00:05:53,100
user account<font color="#E5E5E5"> is</font><font color="#CCCCCC"> easy breezy okay</font><font color="#E5E5E5"> turning</font>

155
00:05:51,240 --> 00:05:55,410
<font color="#CCCCCC">that into a</font><font color="#E5E5E5"> domain admin or a</font><font color="#CCCCCC"> higher</font>

156
00:05:53,100 --> 00:05:57,120
<font color="#CCCCCC">level privilege is where some of</font><font color="#E5E5E5"> the</font>

157
00:05:55,410 --> 00:06:00,870
challenges can come in and what we've

158
00:05:57,120 --> 00:06:03,000
done on the red team<font color="#CCCCCC"> about six</font><font color="#E5E5E5"> months</font>

159
00:06:00,870 --> 00:06:05,120
ago<font color="#E5E5E5"> or</font><font color="#CCCCCC"> so we all</font><font color="#E5E5E5"> sat</font><font color="#CCCCCC"> down in a</font><font color="#E5E5E5"> room and</font>

160
00:06:03,000 --> 00:06:08,040
we figured<font color="#E5E5E5"> out that we weren't</font><font color="#CCCCCC"> were as</font>

161
00:06:05,120 --> 00:06:10,110
efficient as an effective team as we

162
00:06:08,040 --> 00:06:11,340
could be what I found was that<font color="#E5E5E5"> my team</font>

163
00:06:10,110 --> 00:06:12,960
members were getting<font color="#E5E5E5"> dropped</font><font color="#CCCCCC"> into</font>

164
00:06:11,340 --> 00:06:15,690
<font color="#E5E5E5">different scenarios and they were</font>

165
00:06:12,960 --> 00:06:18,690
<font color="#E5E5E5">running different attacks not based on</font>

166
00:06:15,690 --> 00:06:21,960
any equation or effective<font color="#CCCCCC"> algorithm so</font>

167
00:06:18,690 --> 00:06:22,950
what we did is we sat in a room<font color="#CCCCCC"> and we</font>

168
00:06:21,960 --> 00:06:24,750
went through<font color="#CCCCCC"> all of these different</font>

169
00:06:22,950 --> 00:06:26,250
attack scenarios<font color="#E5E5E5"> that we generally</font>

170
00:06:24,750 --> 00:06:27,810
<font color="#E5E5E5">employ we're not talking about</font>

171
00:06:26,250 --> 00:06:29,130
meterpreter stuff<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> Metasploit</font>

172
00:06:27,810 --> 00:06:31,260
stuff<font color="#E5E5E5"> folks okay we're talking about</font>

173
00:06:29,130 --> 00:06:33,750
<font color="#E5E5E5">some some out-of-the-box</font><font color="#CCCCCC"> ER I hate using</font>

174
00:06:31,260 --> 00:06:35,789
<font color="#E5E5E5">that</font><font color="#CCCCCC"> word non-traditional type of attack</font>

175
00:06:33,750 --> 00:06:37,360
vectors some of these you may know about

176
00:06:35,789 --> 00:06:40,568
some you won't<font color="#E5E5E5"> but</font>

177
00:06:37,360 --> 00:06:42,819
we had to do was conceptualize<font color="#CCCCCC"> a little</font>

178
00:06:40,569 --> 00:06:45,520
bit about the<font color="#E5E5E5"> value</font><font color="#CCCCCC"> of these different</font>

179
00:06:42,819 --> 00:06:46,990
attacks<font color="#CCCCCC"> the time it</font><font color="#E5E5E5"> takes to run some</font><font color="#CCCCCC"> of</font>

180
00:06:45,520 --> 00:06:49,900
<font color="#E5E5E5">these different attacks and the</font>

181
00:06:46,990 --> 00:06:51,759
probability of<font color="#E5E5E5"> success</font><font color="#CCCCCC"> and so the</font>

182
00:06:49,900 --> 00:06:53,888
<font color="#E5E5E5">algorithm is pretty darn simple</font><font color="#CCCCCC"> alright</font>

183
00:06:51,759 --> 00:06:56,050
if you look at how long<font color="#CCCCCC"> the time it</font>

184
00:06:53,889 --> 00:06:59,650
<font color="#E5E5E5">takes to</font><font color="#CCCCCC"> conduct the attack versus the</font>

185
00:06:56,050 --> 00:07:01,780
payout<font color="#E5E5E5"> you can begin to prioritize what</font>

186
00:06:59,650 --> 00:07:05,318
you<font color="#E5E5E5"> should focus on first second third</font>

187
00:07:01,780 --> 00:07:08,229
and fourth<font color="#E5E5E5"> we on the red team we don't</font>

188
00:07:05,319 --> 00:07:10,240
<font color="#E5E5E5">have an infinite to hack an organization</font>

189
00:07:08,229 --> 00:07:11,830
<font color="#CCCCCC">okay we've</font><font color="#E5E5E5"> got a limited set of time</font>

190
00:07:10,240 --> 00:07:14,050
that we have to do some things<font color="#E5E5E5"> and we</font>

191
00:07:11,830 --> 00:07:15,340
don't<font color="#E5E5E5"> have the luxury</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> a true</font>

192
00:07:14,050 --> 00:07:18,610
malicious threat actor where they do

193
00:07:15,340 --> 00:07:21,188
have<font color="#CCCCCC"> that that</font><font color="#E5E5E5"> luxury of time so we sat</font>

194
00:07:18,610 --> 00:07:22,479
down<font color="#E5E5E5"> created this workflow and that's</font>

195
00:07:21,189 --> 00:07:23,740
really<font color="#E5E5E5"> what we're going to talk to you</font>

196
00:07:22,479 --> 00:07:25,240
about today<font color="#E5E5E5"> we're going to we're</font><font color="#CCCCCC"> going</font>

197
00:07:23,740 --> 00:07:27,750
<font color="#E5E5E5">to highlight the workflow a little bit</font>

198
00:07:25,240 --> 00:07:29,860
and then dive into<font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the specific</font>

199
00:07:27,750 --> 00:07:32,229
attacks the attack vectors themselves

200
00:07:29,860 --> 00:07:34,090
<font color="#CCCCCC">and show you how</font><font color="#E5E5E5"> we leverage these</font>

201
00:07:32,229 --> 00:07:35,710
things and<font color="#E5E5E5"> again</font><font color="#CCCCCC"> we'll show you</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> good</font>

202
00:07:34,090 --> 00:07:38,429
the bad and<font color="#E5E5E5"> the ugly</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> give you</font>

203
00:07:35,710 --> 00:07:42,039
<font color="#CCCCCC">preventive and detection recommendations</font>

204
00:07:38,430 --> 00:07:43,180
accordingly<font color="#E5E5E5"> so here it is here's the</font>

205
00:07:42,039 --> 00:07:45,009
<font color="#E5E5E5">workflow and I know you might</font><font color="#CCCCCC"> not be</font>

206
00:07:43,180 --> 00:07:46,360
able<font color="#E5E5E5"> to read all of this</font><font color="#CCCCCC"> but that's</font><font color="#E5E5E5"> okay</font>

207
00:07:45,009 --> 00:07:48,129
<font color="#CCCCCC">because we're</font><font color="#E5E5E5"> going to go into these</font>

208
00:07:46,360 --> 00:07:50,800
details<font color="#CCCCCC"> but what it really boils down to</font>

209
00:07:48,129 --> 00:07:53,050
<font color="#CCCCCC">is walking through some of the things</font>

210
00:07:50,800 --> 00:07:56,889
that require<font color="#E5E5E5"> some heavy lifting</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> front</font>

211
00:07:53,050 --> 00:07:58,629
<font color="#E5E5E5">optimize</font><font color="#CCCCCC"> your processes right streamline</font>

212
00:07:56,889 --> 00:08:00,219
some<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the things</font><font color="#E5E5E5"> that you're doing so</font>

213
00:07:58,629 --> 00:08:02,830
that<font color="#E5E5E5"> as you work through some</font><font color="#CCCCCC"> of these</font>

214
00:08:00,219 --> 00:08:04,479
<font color="#CCCCCC">other different areas you've already got</font>

215
00:08:02,830 --> 00:08:06,099
stuff going<font color="#CCCCCC"> on all right so we're</font><font color="#E5E5E5"> going</font>

216
00:08:04,479 --> 00:08:08,349
<font color="#CCCCCC">to</font><font color="#E5E5E5"> talk about</font><font color="#CCCCCC"> how we start off looking</font>

217
00:08:06,099 --> 00:08:10,539
<font color="#E5E5E5">at the sysvol directory we're going to</font>

218
00:08:08,349 --> 00:08:13,870
then<font color="#CCCCCC"> move</font><font color="#E5E5E5"> into how we run some scripted</font>

219
00:08:10,539 --> 00:08:16,960
attacks<font color="#E5E5E5"> to basically look</font><font color="#CCCCCC"> for certain</font>

220
00:08:13,870 --> 00:08:18,759
files that contain juicy info and and

221
00:08:16,960 --> 00:08:20,919
you<font color="#E5E5E5"> may be thinking passwords but that</font>

222
00:08:18,759 --> 00:08:22,779
that's not<font color="#E5E5E5"> what we think</font><font color="#CCCCCC"> well we'll talk</font>

223
00:08:20,919 --> 00:08:24,370
to you a<font color="#E5E5E5"> little bit about that and then</font>

224
00:08:22,779 --> 00:08:27,039
we'll go<font color="#CCCCCC"> into some more advanced attack</font>

225
00:08:24,370 --> 00:08:28,659
mechanisms like token impersonation what

226
00:08:27,039 --> 00:08:31,089
I like to call Kerberos

227
00:08:28,659 --> 00:08:32,349
attacks<font color="#E5E5E5"> and some of the evasion</font>

228
00:08:31,089 --> 00:08:34,448
<font color="#E5E5E5">techniques that we're currently using</font>

229
00:08:32,349 --> 00:08:36,010
today<font color="#CCCCCC"> all right there's some there's</font>

230
00:08:34,448 --> 00:08:39,069
some<font color="#E5E5E5"> tools that probably you guys have</font>

231
00:08:36,010 --> 00:08:41,349
<font color="#E5E5E5">heard of like MSF venom right and veil</font>

232
00:08:39,070 --> 00:08:42,760
guys may be familiar<font color="#E5E5E5"> with some of</font><font color="#CCCCCC"> those</font>

233
00:08:41,349 --> 00:08:45,550
tools<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> they're ways</font><font color="#CCCCCC"> to obfuscate</font>

234
00:08:42,760 --> 00:08:47,260
<font color="#E5E5E5">your payload to defeat antivirus</font><font color="#CCCCCC"> but</font>

235
00:08:45,550 --> 00:08:48,279
some of you may<font color="#CCCCCC"> not be familiar</font><font color="#E5E5E5"> with</font>

236
00:08:47,260 --> 00:08:49,870
some of<font color="#CCCCCC"> the other tools that are</font>

237
00:08:48,279 --> 00:08:53,949
emerging<font color="#CCCCCC"> right now that we're leveraging</font>

238
00:08:49,870 --> 00:08:56,410
<font color="#E5E5E5">with crazy success rates</font><font color="#CCCCCC"> okay and then</font>

239
00:08:53,949 --> 00:08:58,630
you know we'll<font color="#E5E5E5"> get into a little</font><font color="#CCCCCC"> bit of</font>

240
00:08:56,410 --> 00:09:01,240
our Hail Mary technique at the<font color="#E5E5E5"> end there</font>

241
00:08:58,630 --> 00:09:03,399
<font color="#E5E5E5">when all else fails what is it that we</font>

242
00:09:01,240 --> 00:09:05,560
do at<font color="#E5E5E5"> the end</font><font color="#CCCCCC"> hour to</font><font color="#E5E5E5"> increase our</font>

243
00:09:03,399 --> 00:09:08,230
chances of<font color="#CCCCCC"> gaining access to</font><font color="#E5E5E5"> the things</font>

244
00:09:05,560 --> 00:09:09,880
<font color="#CCCCCC">that we need</font><font color="#E5E5E5"> to gain access to</font><font color="#CCCCCC"> we're</font>

245
00:09:08,230 --> 00:09:12,640
familiar<font color="#CCCCCC"> with</font><font color="#E5E5E5"> this wall</font><font color="#CCCCCC"> razor hand if</font>

246
00:09:09,880 --> 00:09:14,410
you ever<font color="#CCCCCC"> heard of this well</font><font color="#E5E5E5"> okay general</font>

247
00:09:12,640 --> 00:09:17,319
show of hands<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> not too bad so</font>

248
00:09:14,410 --> 00:09:18,449
<font color="#CCCCCC">quick overview sysvol is a directory</font>

249
00:09:17,319 --> 00:09:21,040
<font color="#E5E5E5">that's on all of your domain controllers</font>

250
00:09:18,449 --> 00:09:23,709
<font color="#CCCCCC">okay and what it's doing is its hosting</font>

251
00:09:21,040 --> 00:09:26,680
up things like net<font color="#E5E5E5"> logon shares user</font>

252
00:09:23,709 --> 00:09:29,380
login scripts<font color="#E5E5E5"> and specifically</font><font color="#CCCCCC"> GPIOs</font>

253
00:09:26,680 --> 00:09:31,089
group policies<font color="#CCCCCC"> ok there's also some</font><font color="#E5E5E5"> FRS</font>

254
00:09:29,380 --> 00:09:33,490
and file replication service<font color="#E5E5E5"> going on</font>

255
00:09:31,089 --> 00:09:36,010
there as<font color="#CCCCCC"> well but as a domain user</font>

256
00:09:33,490 --> 00:09:38,140
<font color="#E5E5E5">anybody can navigate to</font><font color="#CCCCCC"> the sysvol</font>

257
00:09:36,010 --> 00:09:40,720
<font color="#E5E5E5">directory on any one of your domain</font>

258
00:09:38,140 --> 00:09:42,310
controllers<font color="#CCCCCC"> and so what's in there</font>

259
00:09:40,720 --> 00:09:44,620
what's the attack looked like from<font color="#E5E5E5"> the</font>

260
00:09:42,310 --> 00:09:47,619
sysvol perspective<font color="#E5E5E5"> well there's</font><font color="#CCCCCC"> two</font>

261
00:09:44,620 --> 00:09:50,649
primarily<font color="#E5E5E5"> first of all is network admins</font>

262
00:09:47,620 --> 00:09:53,709
store a ton of stuff in system all that

263
00:09:50,649 --> 00:09:56,110
they shouldn't<font color="#CCCCCC"> all right example</font><font color="#E5E5E5"> Visual</font>

264
00:09:53,709 --> 00:09:58,449
Basic scripts<font color="#CCCCCC"> batch scripts with clear</font>

265
00:09:56,110 --> 00:10:00,940
text passwords<font color="#CCCCCC"> these are things that are</font>

266
00:09:58,449 --> 00:10:02,680
easily<font color="#CCCCCC"> accessible from any domain</font><font color="#E5E5E5"> user</font>

267
00:10:00,940 --> 00:10:05,019
you<font color="#E5E5E5"> can just navigate</font><font color="#CCCCCC"> to the domain</font>

268
00:10:02,680 --> 00:10:07,209
controller<font color="#E5E5E5"> hit the sysvol directory and</font>

269
00:10:05,019 --> 00:10:09,550
start looking for<font color="#E5E5E5"> some of those specific</font>

270
00:10:07,209 --> 00:10:12,489
scripts<font color="#E5E5E5"> that are in there we have done</font>

271
00:10:09,550 --> 00:10:14,859
this a lot we have found tons of local

272
00:10:12,490 --> 00:10:16,690
administrator passwords<font color="#E5E5E5"> in Visual Basic</font>

273
00:10:14,860 --> 00:10:18,220
scripts a bunch of other<font color="#E5E5E5"> different</font>

274
00:10:16,690 --> 00:10:20,140
things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> just there for</font>

275
00:10:18,220 --> 00:10:22,300
the<font color="#CCCCCC"> taking and oftentimes they're you</font>

276
00:10:20,140 --> 00:10:24,939
know most considered a<font color="#E5E5E5"> low-hanging fruit</font>

277
00:10:22,300 --> 00:10:29,620
type vulnerability there's another one

278
00:10:24,940 --> 00:10:31,600
<font color="#CCCCCC">out there</font><font color="#E5E5E5"> M is 1425</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> easiest way I</font>

279
00:10:29,620 --> 00:10:34,269
can<font color="#CCCCCC"> describe this is in a big</font>

280
00:10:31,600 --> 00:10:36,190
environment<font color="#CCCCCC"> what you want to do is</font>

281
00:10:34,269 --> 00:10:37,630
eliminate<font color="#CCCCCC"> the sneaker netting in the</font>

282
00:10:36,190 --> 00:10:39,459
environment right<font color="#E5E5E5"> if I want to change</font>

283
00:10:37,630 --> 00:10:41,380
the<font color="#E5E5E5"> local administrator password on all</font>

284
00:10:39,459 --> 00:10:43,000
my<font color="#CCCCCC"> workstations last thing I'd want to</font>

285
00:10:41,380 --> 00:10:44,949
do is walk over<font color="#CCCCCC"> to each</font><font color="#E5E5E5"> and every</font><font color="#CCCCCC"> single</font>

286
00:10:43,000 --> 00:10:48,279
<font color="#E5E5E5">computer and have to type that in so</font>

287
00:10:44,949 --> 00:10:51,010
what this<font color="#E5E5E5"> this wall GPO allows you to do</font>

288
00:10:48,279 --> 00:10:53,199
is to set<font color="#CCCCCC"> the</font><font color="#E5E5E5"> local administrator</font>

289
00:10:51,010 --> 00:10:55,990
password<font color="#E5E5E5"> across all of your</font><font color="#CCCCCC"> different</font>

290
00:10:53,199 --> 00:10:58,630
workstations<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> there's a problem though</font>

291
00:10:55,990 --> 00:11:00,189
<font color="#E5E5E5">because the well let's just take a look</font>

292
00:10:58,630 --> 00:11:01,480
at the problem here's what here's<font color="#CCCCCC"> what</font>

293
00:11:00,189 --> 00:11:02,640
this looks<font color="#CCCCCC"> like if you look at the</font>

294
00:11:01,480 --> 00:11:05,850
actual

295
00:11:02,640 --> 00:11:09,530
GP or<font color="#E5E5E5"> the actual XML file here you'll</font>

296
00:11:05,850 --> 00:11:13,590
see this<font color="#CCCCCC"> C password is a hash password</font>

297
00:11:09,530 --> 00:11:15,410
<font color="#CCCCCC">about two</font><font color="#E5E5E5"> years ago</font><font color="#CCCCCC"> a Microsoft</font>

298
00:11:13,590 --> 00:11:18,330
developer on<font color="#E5E5E5"> the MSDN</font><font color="#CCCCCC"> network</font>

299
00:11:15,410 --> 00:11:21,630
accidentally posted<font color="#E5E5E5"> the private key for</font>

300
00:11:18,330 --> 00:11:23,940
this<font color="#CCCCCC"> bad</font><font color="#E5E5E5"> on a public public</font><font color="#CCCCCC"> warrant</font>

301
00:11:21,630 --> 00:11:26,130
nonetheless so cats out of the bag

302
00:11:23,940 --> 00:11:27,990
there's<font color="#CCCCCC"> no exploit code that you can</font>

303
00:11:26,130 --> 00:11:30,150
literally<font color="#CCCCCC"> take this</font><font color="#E5E5E5"> is just a little</font>

304
00:11:27,990 --> 00:11:32,790
<font color="#E5E5E5">PowerShell script you fire in your hash</font>

305
00:11:30,150 --> 00:11:34,560
you get the clear text password<font color="#E5E5E5"> local</font>

306
00:11:32,790 --> 00:11:38,579
<font color="#E5E5E5">administrator rights on every computer</font>

307
00:11:34,560 --> 00:11:40,140
that<font color="#CCCCCC"> has this GPL applied</font><font color="#E5E5E5"> to it you guys</font>

308
00:11:38,580 --> 00:11:42,450
should know<font color="#E5E5E5"> if you don't want to get</font>

309
00:11:40,140 --> 00:11:43,680
<font color="#CCCCCC">local admin all about</font><font color="#E5E5E5"> escalating</font>

310
00:11:42,450 --> 00:11:45,120
privileges so that's<font color="#E5E5E5"> really what we're</font>

311
00:11:43,680 --> 00:11:48,900
<font color="#E5E5E5">trying to do is we're</font><font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> do this</font>

312
00:11:45,120 --> 00:11:51,570
crawl walk<font color="#E5E5E5"> run scenario</font><font color="#CCCCCC"> to find things</font>

313
00:11:48,900 --> 00:11:53,730
that<font color="#E5E5E5"> will get us to either that domain</font>

314
00:11:51,570 --> 00:11:54,360
<font color="#E5E5E5">admin of the crown jewels</font><font color="#CCCCCC"> sooner</font><font color="#E5E5E5"> rather</font>

315
00:11:53,730 --> 00:11:58,530
than later

316
00:11:54,360 --> 00:12:01,440
<font color="#E5E5E5">okay so quick</font><font color="#CCCCCC"> recap</font><font color="#E5E5E5"> for you from a</font>

317
00:11:58,530 --> 00:12:03,480
prevention perspective if you do<font color="#E5E5E5"> nothing</font>

318
00:12:01,440 --> 00:12:05,070
leave<font color="#E5E5E5"> this</font><font color="#CCCCCC"> building as the network admin</font>

319
00:12:03,480 --> 00:12:07,290
or security admin and look at your sis

320
00:12:05,070 --> 00:12:10,080
file directory do a search for<font color="#E5E5E5"> VBS</font>

321
00:12:07,290 --> 00:12:12,170
scripts<font color="#CCCCCC"> and see what you see do a search</font>

322
00:12:10,080 --> 00:12:14,310
for<font color="#CCCCCC"> bash scripts</font><font color="#E5E5E5"> and see what you see</font>

323
00:12:12,170 --> 00:12:16,079
<font color="#E5E5E5">probably bet dollars to doughnuts you'll</font>

324
00:12:14,310 --> 00:12:17,989
find some type of<font color="#E5E5E5"> vulnerability</font><font color="#CCCCCC"> in there</font>

325
00:12:16,080 --> 00:12:20,580
that somebody<font color="#E5E5E5"> could capitalize on okay</font>

326
00:12:17,990 --> 00:12:22,710
don't store<font color="#CCCCCC"> crabs in script files and</font>

327
00:12:20,580 --> 00:12:25,080
make sure you're patched against<font color="#E5E5E5"> 14 25</font>

328
00:12:22,710 --> 00:12:26,550
<font color="#E5E5E5">14 25 is more of a manual patch you</font>

329
00:12:25,080 --> 00:12:27,420
won't find<font color="#E5E5E5"> out like a Windows Update so</font>

330
00:12:26,550 --> 00:12:29,849
you got to go in there

331
00:12:27,420 --> 00:12:31,680
apply it manually<font color="#CCCCCC"> make sure you do</font><font color="#E5E5E5"> this</font>

332
00:12:29,850 --> 00:12:34,110
is why we still see you know<font color="#E5E5E5"> this</font>

333
00:12:31,680 --> 00:12:39,510
vulnerability<font color="#E5E5E5"> from 2014 prevalent in</font>

334
00:12:34,110 --> 00:12:41,340
environments<font color="#E5E5E5"> today</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> all right</font><font color="#CCCCCC"> so</font>

335
00:12:39,510 --> 00:12:43,620
we've done a quick little search of

336
00:12:41,340 --> 00:12:45,720
sysvol<font color="#E5E5E5"> we may or may have not found some</font>

337
00:12:43,620 --> 00:12:48,360
stuff<font color="#CCCCCC"> what we really want to</font><font color="#E5E5E5"> do now</font><font color="#CCCCCC"> is</font>

338
00:12:45,720 --> 00:12:51,030
do some things in<font color="#E5E5E5"> an automated fashion</font>

339
00:12:48,360 --> 00:12:52,410
<font color="#CCCCCC">in almost</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> a cruise control</font>

340
00:12:51,030 --> 00:12:56,069
perspective<font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> what we call</font>

341
00:12:52,410 --> 00:12:57,630
unattended file searching so again

342
00:12:56,070 --> 00:12:59,940
<font color="#CCCCCC">having</font><font color="#E5E5E5"> been in this industry for a</font><font color="#CCCCCC"> while</font>

343
00:12:57,630 --> 00:13:01,530
you<font color="#E5E5E5"> know 10 12 years ago when we when we</font>

344
00:12:59,940 --> 00:13:04,140
were able<font color="#E5E5E5"> to come in on day one and get</font>

345
00:13:01,530 --> 00:13:06,240
domain administrator<font color="#CCCCCC"> access it</font><font color="#E5E5E5"> within</font>

346
00:13:04,140 --> 00:13:08,100
hours or<font color="#E5E5E5"> minutes that was</font><font color="#CCCCCC"> usually enough</font>

347
00:13:06,240 --> 00:13:09,930
to<font color="#CCCCCC"> raise</font><font color="#E5E5E5"> the eyebrows of the c-level</font>

348
00:13:08,100 --> 00:13:12,180
executives and the stakeholders<font color="#E5E5E5"> within</font>

349
00:13:09,930 --> 00:13:14,130
the project<font color="#E5E5E5"> no longer is that the case</font>

350
00:13:12,180 --> 00:13:15,050
today<font color="#E5E5E5"> because it's so easy what's</font>

351
00:13:14,130 --> 00:13:18,890
important<font color="#CCCCCC"> today</font>

352
00:13:15,050 --> 00:13:20,180
find things<font color="#CCCCCC"> get</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> than</font><font color="#E5E5E5"> just passwords</font>

353
00:13:18,890 --> 00:13:21,709
<font color="#E5E5E5">alright so when you're looking at</font>

354
00:13:20,180 --> 00:13:23,120
intellectual property<font color="#E5E5E5"> when you're</font>

355
00:13:21,709 --> 00:13:24,500
looking at the crown jewels when<font color="#E5E5E5"> you're</font>

356
00:13:23,120 --> 00:13:27,800
<font color="#E5E5E5">looking at all these different</font><font color="#CCCCCC"> areas</font>

357
00:13:24,500 --> 00:13:30,380
where that data is<font color="#E5E5E5"> more important than</font>

358
00:13:27,800 --> 00:13:32,180
<font color="#E5E5E5">the privilege itself we want to start</font>

359
00:13:30,380 --> 00:13:35,360
some things now because as you know

360
00:13:32,180 --> 00:13:37,729
<font color="#E5E5E5">searching through terabytes of files</font><font color="#CCCCCC"> is</font>

361
00:13:35,360 --> 00:13:39,560
<font color="#E5E5E5">not easy and it's not quick so what we</font>

362
00:13:37,730 --> 00:13:43,220
want to<font color="#E5E5E5"> do here at this process within</font>

363
00:13:39,560 --> 00:13:45,109
<font color="#CCCCCC">the workflow</font><font color="#E5E5E5"> is start looking for data</font>

364
00:13:43,220 --> 00:13:46,700
<font color="#CCCCCC">ok that could be in the form of</font>

365
00:13:45,110 --> 00:13:48,079
passwords that<font color="#E5E5E5"> can be in the form of</font>

366
00:13:46,700 --> 00:13:50,180
<font color="#E5E5E5">intellectual property</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> can be in the</font>

367
00:13:48,079 --> 00:13:52,420
<font color="#E5E5E5">form</font><font color="#CCCCCC"> of a number of different field</font><font color="#E5E5E5"> but</font>

368
00:13:50,180 --> 00:13:56,089
really what we're looking<font color="#CCCCCC"> high-value</font>

369
00:13:52,420 --> 00:13:57,949
information and some<font color="#E5E5E5"> of the way excuse</font>

370
00:13:56,089 --> 00:14:00,620
me that we do that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> obviously we look</font>

371
00:13:57,950 --> 00:14:03,680
<font color="#E5E5E5">at file shares we look at email we look</font>

372
00:14:00,620 --> 00:14:05,540
in the registry<font color="#E5E5E5"> Sam and the way that we</font>

373
00:14:03,680 --> 00:14:07,370
do<font color="#E5E5E5"> that is through custom PowerShell</font>

374
00:14:05,540 --> 00:14:09,290
scripting<font color="#E5E5E5"> so we've developed some tools</font>

375
00:14:07,370 --> 00:14:10,720
over the years that allow this to us to

376
00:14:09,290 --> 00:14:13,370
do this in a more automated

377
00:14:10,720 --> 00:14:15,260
<font color="#CCCCCC">operationalize fashion you can you can</font>

378
00:14:13,370 --> 00:14:17,600
<font color="#E5E5E5">look at some things manually you can</font>

379
00:14:15,260 --> 00:14:19,279
<font color="#E5E5E5">look at</font><font color="#CCCCCC"> Metasploit auxilary</font><font color="#E5E5E5"> modules that</font>

380
00:14:17,600 --> 00:14:20,990
offer some<font color="#E5E5E5"> of this inherent capabilities</font>

381
00:14:19,279 --> 00:14:23,149
but we put some stuff together<font color="#E5E5E5"> that</font>

382
00:14:20,990 --> 00:14:26,149
allows us<font color="#CCCCCC"> to kind of push play and then</font>

383
00:14:23,149 --> 00:14:28,820
look at some<font color="#CCCCCC"> other stuff while those</font>

384
00:14:26,149 --> 00:14:30,980
file searches<font color="#E5E5E5"> and that data searching is</font>

385
00:14:28,820 --> 00:14:32,810
going on and if we<font color="#E5E5E5"> see any hits on it</font>

386
00:14:30,980 --> 00:14:34,160
<font color="#CCCCCC">then we can focus back but this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> where</font>

387
00:14:32,810 --> 00:14:36,890
the heavy lifting is that we want to

388
00:14:34,160 --> 00:14:40,040
start<font color="#E5E5E5"> upfront so that</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> don't have to</font>

389
00:14:36,890 --> 00:14:41,660
do<font color="#E5E5E5"> this at the end of the</font><font color="#CCCCCC"> engagement so</font>

390
00:14:40,040 --> 00:14:43,670
you know from an<font color="#E5E5E5"> exploit perspective we</font>

391
00:14:41,660 --> 00:14:45,770
talked about you know<font color="#CCCCCC"> Nexus actually has</font>

392
00:14:43,670 --> 00:14:47,779
a content<font color="#E5E5E5"> discovery tool we sometimes</font>

393
00:14:45,770 --> 00:14:50,180
leverage that<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> environment we've</font>

394
00:14:47,779 --> 00:14:53,240
<font color="#E5E5E5">got domain user we</font><font color="#CCCCCC"> can leverage</font><font color="#E5E5E5"> the tool</font>

395
00:14:50,180 --> 00:14:55,760
to find some sensitive data<font color="#E5E5E5"> credit card</font>

396
00:14:53,240 --> 00:14:57,560
<font color="#E5E5E5">numbers social</font><font color="#CCCCCC"> security numbers there's</font>

397
00:14:55,760 --> 00:14:59,930
all these<font color="#E5E5E5"> predisposed policies or</font>

398
00:14:57,560 --> 00:15:02,060
pre-canned policies right<font color="#E5E5E5"> off the bat it</font>

399
00:14:59,930 --> 00:15:05,000
can sometimes be beneficial in certain

400
00:15:02,060 --> 00:15:07,010
environments<font color="#CCCCCC"> DLP we've hacked</font><font color="#E5E5E5"> into</font>

401
00:15:05,000 --> 00:15:09,079
<font color="#E5E5E5">customers DLP environments</font><font color="#CCCCCC"> they're</font>

402
00:15:07,010 --> 00:15:10,459
portals themselves and really start<font color="#E5E5E5"> to</font>

403
00:15:09,079 --> 00:15:12,170
understand where the critical<font color="#E5E5E5"> data is</font>

404
00:15:10,459 --> 00:15:14,180
why do<font color="#E5E5E5"> I need to go look</font><font color="#CCCCCC"> for it when</font>

405
00:15:12,170 --> 00:15:16,819
I've got one repository<font color="#E5E5E5"> if I can find</font>

406
00:15:14,180 --> 00:15:20,899
<font color="#E5E5E5">access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> their data</font><font color="#CCCCCC"> day loss prevention</font>

407
00:15:16,820 --> 00:15:23,120
<font color="#CCCCCC">I can get it all there so prevention</font>

408
00:15:20,899 --> 00:15:25,279
perspective obviously DLP is a great way

409
00:15:23,120 --> 00:15:27,890
you<font color="#E5E5E5"> know double-edged sword</font>

410
00:15:25,279 --> 00:15:28,410
but<font color="#CCCCCC"> leveraged DLP in a fashion to</font><font color="#E5E5E5"> find</font>

411
00:15:27,890 --> 00:15:31,170
the things

412
00:15:28,410 --> 00:15:33,600
you might not be<font color="#CCCCCC"> aware of great example</font>

413
00:15:31,170 --> 00:15:35,310
<font color="#E5E5E5">why don't you point your DLP solutions</font>

414
00:15:33,600 --> 00:15:38,040
to looking at the sysvol directory

415
00:15:35,310 --> 00:15:39,630
<font color="#CCCCCC">looking for password terms or any other</font>

416
00:15:38,040 --> 00:15:41,819
regex expressions that you<font color="#E5E5E5"> can think of</font>

417
00:15:39,630 --> 00:15:44,400
<font color="#E5E5E5">that might</font><font color="#CCCCCC"> be beneficial same thing</font>

418
00:15:41,820 --> 00:15:46,170
<font color="#E5E5E5">holds</font><font color="#CCCCCC"> true here DLP can use can can be</font>

419
00:15:44,400 --> 00:15:47,990
used and better optimized in a ton of

420
00:15:46,170 --> 00:15:50,459
different<font color="#CCCCCC"> environments that we see and</font>

421
00:15:47,990 --> 00:15:52,320
vulnerability content standing<font color="#CCCCCC"> if you</font>

422
00:15:50,460 --> 00:15:54,870
have an operationalized vulnerability

423
00:15:52,320 --> 00:15:56,760
<font color="#E5E5E5">management program today</font><font color="#CCCCCC"> you should</font>

424
00:15:54,870 --> 00:15:59,010
absolutely<font color="#E5E5E5"> think about leveraging some</font>

425
00:15:56,760 --> 00:16:01,290
<font color="#E5E5E5">of the content searching capabilities</font><font color="#CCCCCC"> as</font>

426
00:15:59,010 --> 00:16:03,030
well<font color="#CCCCCC"> a little bit more than DLP a little</font>

427
00:16:01,290 --> 00:16:08,670
bit less at times but<font color="#E5E5E5"> something that you</font>

428
00:16:03,030 --> 00:16:11,400
<font color="#E5E5E5">should</font><font color="#CCCCCC"> begin to</font><font color="#E5E5E5"> explore</font><font color="#CCCCCC"> ok so what we've</font>

429
00:16:08,670 --> 00:16:13,920
done<font color="#CCCCCC"> is basically walked through this</font>

430
00:16:11,400 --> 00:16:15,840
side of the workflow<font color="#CCCCCC"> and we're on</font>

431
00:16:13,920 --> 00:16:17,610
<font color="#CCCCCC">autopilot now alright</font><font color="#E5E5E5"> so now we're going</font>

432
00:16:15,840 --> 00:16:19,680
to get<font color="#E5E5E5"> into now we're going</font><font color="#CCCCCC"> to get jiggy</font>

433
00:16:17,610 --> 00:16:21,120
with<font color="#CCCCCC"> it alright</font><font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> start to</font>

434
00:16:19,680 --> 00:16:23,969
<font color="#E5E5E5">look into some</font><font color="#CCCCCC"> things that are a little</font>

435
00:16:21,120 --> 00:16:27,120
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> more advantageous</font><font color="#E5E5E5"> for us assuming</font>

436
00:16:23,970 --> 00:16:29,540
now we've got a<font color="#E5E5E5"> domain user right what</font>

437
00:16:27,120 --> 00:16:31,650
we want to do now is search for all

438
00:16:29,540 --> 00:16:34,349
local<font color="#CCCCCC"> administrative</font><font color="#E5E5E5"> rights on the</font>

439
00:16:31,650 --> 00:16:36,750
network using<font color="#CCCCCC"> the SMB login script for</font>

440
00:16:34,350 --> 00:16:39,390
<font color="#CCCCCC">Metasploit anybody familiar</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the SMB</font>

441
00:16:36,750 --> 00:16:42,450
login script<font color="#E5E5E5"> so let's say you have a</font>

442
00:16:39,390 --> 00:16:44,850
<font color="#E5E5E5">domain user and you want to see what</font>

443
00:16:42,450 --> 00:16:46,710
<font color="#CCCCCC">rights that domain user has across the</font>

444
00:16:44,850 --> 00:16:47,550
enterprise<font color="#E5E5E5"> what you're going to do is</font>

445
00:16:46,710 --> 00:16:49,770
you're<font color="#E5E5E5"> going to fire in those</font>

446
00:16:47,550 --> 00:16:52,079
<font color="#CCCCCC">credentials to the</font><font color="#E5E5E5"> SMB login script and</font>

447
00:16:49,770 --> 00:16:54,810
you're<font color="#E5E5E5"> going to say</font><font color="#CCCCCC"> scan the network and</font>

448
00:16:52,080 --> 00:16:56,820
tell me what other machines this guy or

449
00:16:54,810 --> 00:17:00,449
girl<font color="#E5E5E5"> or this this set of credentials has</font>

450
00:16:56,820 --> 00:17:02,010
access to most of the<font color="#E5E5E5"> time you're going</font>

451
00:17:00,450 --> 00:17:04,199
<font color="#E5E5E5">to find a</font><font color="#CCCCCC"> few boxes that have local</font>

452
00:17:02,010 --> 00:17:06,569
administrator rights<font color="#CCCCCC"> as this is either</font>

453
00:17:04,199 --> 00:17:08,250
<font color="#CCCCCC">advertent or inadvertent my team and I</font>

454
00:17:06,569 --> 00:17:10,500
<font color="#CCCCCC">just did</font><font color="#E5E5E5"> something for a big food</font>

455
00:17:08,250 --> 00:17:12,630
manufacturing company about<font color="#CCCCCC"> two or three</font>

456
00:17:10,500 --> 00:17:15,209
<font color="#E5E5E5">months</font><font color="#CCCCCC"> ago when</font><font color="#E5E5E5"> we were like they were</font>

457
00:17:12,630 --> 00:17:17,069
<font color="#E5E5E5">like there's</font><font color="#CCCCCC"> no way J Smith is</font><font color="#E5E5E5"> going to</font>

458
00:17:15,209 --> 00:17:18,600
have any local<font color="#E5E5E5"> admin</font><font color="#CCCCCC"> access to any</font><font color="#E5E5E5"> of</font>

459
00:17:17,069 --> 00:17:20,520
the<font color="#E5E5E5"> servers we prohibit that from</font>

460
00:17:18,599 --> 00:17:22,409
happening<font color="#CCCCCC"> we found like five or seven</font>

461
00:17:20,520 --> 00:17:24,660
servers where he did and we had domain

462
00:17:22,410 --> 00:17:27,030
admin in seconds after<font color="#CCCCCC"> that</font><font color="#E5E5E5"> all right</font><font color="#CCCCCC"> so</font>

463
00:17:24,660 --> 00:17:30,120
<font color="#CCCCCC">again</font><font color="#E5E5E5"> something you can take out</font><font color="#CCCCCC"> of here</font>

464
00:17:27,030 --> 00:17:31,770
and what<font color="#E5E5E5"> jumped ahead so what we're</font>

465
00:17:30,120 --> 00:17:32,850
<font color="#E5E5E5">going to do is we're going to scan</font><font color="#CCCCCC"> we're</font>

466
00:17:31,770 --> 00:17:34,139
going to find a bunch<font color="#E5E5E5"> of different</font>

467
00:17:32,850 --> 00:17:37,590
<font color="#CCCCCC">systems now that have local</font>

468
00:17:34,140 --> 00:17:39,610
<font color="#E5E5E5">administrator rights then what then what</font>

469
00:17:37,590 --> 00:17:42,340
do we<font color="#E5E5E5"> do and this is where it kind</font><font color="#CCCCCC"> of</font>

470
00:17:39,610 --> 00:17:43,570
<font color="#E5E5E5">a little more</font><font color="#CCCCCC"> fun in my opinion</font><font color="#E5E5E5"> so now</font>

471
00:17:42,340 --> 00:17:45,580
we're<font color="#CCCCCC"> moving</font><font color="#E5E5E5"> into some more of the</font>

472
00:17:43,570 --> 00:17:47,500
advanced attacks here<font color="#E5E5E5"> okay so we've done</font>

473
00:17:45,580 --> 00:17:49,270
<font color="#CCCCCC">all these things we're an autopilot</font>

474
00:17:47,500 --> 00:17:51,160
we've got our local admin rights that

475
00:17:49,270 --> 00:17:54,510
we've got on a few boxes<font color="#CCCCCC"> we're going to</font>

476
00:17:51,160 --> 00:17:56,940
begin<font color="#E5E5E5"> to</font><font color="#CCCCCC"> attack those specific machines</font>

477
00:17:54,510 --> 00:17:59,170
token impersonation attack

478
00:17:56,940 --> 00:18:01,360
<font color="#E5E5E5">cream-of-the-crop</font><font color="#CCCCCC"> one of the easiest</font>

479
00:17:59,170 --> 00:18:02,860
ways that we leverage to gain access<font color="#CCCCCC"> to</font>

480
00:18:01,360 --> 00:18:05,889
an environment<font color="#CCCCCC"> without a lot</font><font color="#E5E5E5"> of heavy</font>

481
00:18:02,860 --> 00:18:09,490
lifting<font color="#CCCCCC"> in addition we like to fly under</font>

482
00:18:05,890 --> 00:18:12,070
<font color="#CCCCCC">the radar</font><font color="#E5E5E5"> we are all about eliminating</font>

483
00:18:09,490 --> 00:18:14,170
logs to your sim<font color="#E5E5E5"> to</font><font color="#CCCCCC"> your threat</font><font color="#E5E5E5"> hunting</font>

484
00:18:12,070 --> 00:18:16,030
<font color="#E5E5E5">to all of the correlation metrics that</font>

485
00:18:14,170 --> 00:18:17,740
you have in your<font color="#E5E5E5"> device and some of</font>

486
00:18:16,030 --> 00:18:19,840
these next few<font color="#E5E5E5"> topics I'm</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be</font>

487
00:18:17,740 --> 00:18:23,830
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> will do just that</font>

488
00:18:19,840 --> 00:18:26,740
<font color="#CCCCCC">they're very non intrusive</font><font color="#E5E5E5"> extremely not</font>

489
00:18:23,830 --> 00:18:29,740
very noisy at all<font color="#CCCCCC"> either so token</font>

490
00:18:26,740 --> 00:18:32,610
impersonation<font color="#CCCCCC"> think of think of tokens</font>

491
00:18:29,740 --> 00:18:35,740
very much like cookies<font color="#CCCCCC"> if you will</font>

492
00:18:32,610 --> 00:18:39,459
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> basically a way to ensure that</font>

493
00:18:35,740 --> 00:18:40,690
your<font color="#E5E5E5"> session state is validated without</font>

494
00:18:39,460 --> 00:18:42,970
having to send<font color="#E5E5E5"> your username and</font>

495
00:18:40,690 --> 00:18:45,730
<font color="#E5E5E5">password</font><font color="#CCCCCC"> all the time</font><font color="#E5E5E5"> okay so that token</font>

496
00:18:42,970 --> 00:18:48,220
is cached<font color="#E5E5E5"> on certain servers or machines</font>

497
00:18:45,730 --> 00:18:50,830
so let's say I is the domain admin need

498
00:18:48,220 --> 00:18:53,980
to<font color="#CCCCCC"> login to in a</font><font color="#E5E5E5"> disk</font><font color="#CCCCCC"> guy</font><font color="#E5E5E5"> box for some</font>

499
00:18:50,830 --> 00:18:56,470
<font color="#E5E5E5">reason</font><font color="#CCCCCC"> and I as a</font><font color="#E5E5E5"> domain admin logged in</font>

500
00:18:53,980 --> 00:18:58,660
<font color="#CCCCCC">there Iife entik ated successfully and</font>

501
00:18:56,470 --> 00:19:01,810
then I killed my session maybe RDP or

502
00:18:58,660 --> 00:19:04,420
whatever<font color="#CCCCCC"> well the token</font><font color="#E5E5E5"> that I used to</font>

503
00:19:01,810 --> 00:19:06,600
log<font color="#E5E5E5"> into that device is still present on</font>

504
00:19:04,420 --> 00:19:11,380
<font color="#E5E5E5">that</font><font color="#CCCCCC"> machine and it's there for a</font><font color="#E5E5E5"> while</font>

505
00:19:06,600 --> 00:19:13,090
<font color="#E5E5E5">so what we can do is impersonate that</font>

506
00:19:11,380 --> 00:19:15,880
token and remember we're still a domain

507
00:19:13,090 --> 00:19:17,320
user so anybody here<font color="#E5E5E5"> that runs an</font>

508
00:19:15,880 --> 00:19:19,510
<font color="#CCCCCC">organization's you know your network</font>

509
00:19:17,320 --> 00:19:22,210
<font color="#E5E5E5">administration security whatever</font><font color="#CCCCCC"> any</font>

510
00:19:19,510 --> 00:19:24,970
domain user can do this stuff<font color="#CCCCCC"> okay so</font>

511
00:19:22,210 --> 00:19:27,610
now we're looking<font color="#E5E5E5"> at leveraging</font>

512
00:19:24,970 --> 00:19:29,230
<font color="#CCCCCC">Metasploit here</font><font color="#E5E5E5"> okay and and so we've</font>

513
00:19:27,610 --> 00:19:30,990
used the meterpreter session that we've

514
00:19:29,230 --> 00:19:33,370
got<font color="#E5E5E5"> earlier remember we've already</font>

515
00:19:30,990 --> 00:19:35,740
compromised<font color="#E5E5E5"> the box through the SMB</font>

516
00:19:33,370 --> 00:19:37,780
login script we've looked at who's out

517
00:19:35,740 --> 00:19:39,460
there<font color="#CCCCCC"> we've got a local administrator</font><font color="#E5E5E5"> we</font>

518
00:19:37,780 --> 00:19:40,990
drop the matter printer session on there

519
00:19:39,460 --> 00:19:42,850
through a<font color="#E5E5E5"> number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> different ways which</font>

520
00:19:40,990 --> 00:19:45,580
we will<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about in a little bit</font><font color="#E5E5E5"> and</font>

521
00:19:42,850 --> 00:19:50,010
we load up incognito<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right anybody</font>

522
00:19:45,580 --> 00:19:53,230
familiar with incognito incognito<font color="#E5E5E5"> is a</font>

523
00:19:50,010 --> 00:19:55,269
additional module in<font color="#CCCCCC"> Metasploit that</font>

524
00:19:53,230 --> 00:19:57,880
to do some cool<font color="#CCCCCC"> things like token</font>

525
00:19:55,269 --> 00:20:00,880
impersonation and<font color="#E5E5E5"> token snarfing and so</font>

526
00:19:57,880 --> 00:20:02,409
basically it's<font color="#E5E5E5"> really easy okay first we</font>

527
00:20:00,880 --> 00:20:04,419
need<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> all right we netted</font>

528
00:20:02,409 --> 00:20:06,850
we got to be a system<font color="#E5E5E5"> here</font><font color="#CCCCCC"> to do this</font>

529
00:20:04,419 --> 00:20:09,279
which is<font color="#CCCCCC"> really easy</font><font color="#E5E5E5"> with elevation</font><font color="#CCCCCC"> and</font>

530
00:20:06,850 --> 00:20:11,740
<font color="#CCCCCC">Metasploit and meterpreter</font><font color="#E5E5E5"> then what we</font>

531
00:20:09,279 --> 00:20:14,200
do is<font color="#E5E5E5"> load incognito</font><font color="#CCCCCC"> and then what we do</font>

532
00:20:11,740 --> 00:20:16,389
<font color="#E5E5E5">is we</font><font color="#CCCCCC"> listed tokens available okay</font><font color="#E5E5E5"> so</font>

533
00:20:14,200 --> 00:20:18,850
now when we<font color="#E5E5E5"> list the tokens with this -</font>

534
00:20:16,389 --> 00:20:20,889
<font color="#E5E5E5">you parameter we're looking at all user</font>

535
00:20:18,850 --> 00:20:23,230
tokens here and who do we<font color="#E5E5E5"> see here we've</font>

536
00:20:20,889 --> 00:20:24,969
got<font color="#E5E5E5"> this Alice</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right let's assume</font>

537
00:20:23,230 --> 00:20:27,490
<font color="#CCCCCC">Alice is a domain administrator that's</font>

538
00:20:24,970 --> 00:20:30,159
<font color="#E5E5E5">what we want to see okay now I've</font><font color="#CCCCCC"> got a</font>

539
00:20:27,490 --> 00:20:33,159
target<font color="#CCCCCC"> now I need</font><font color="#E5E5E5"> to impersonate this</font>

540
00:20:30,159 --> 00:20:35,380
token by impersonating<font color="#E5E5E5"> that token now I</font>

541
00:20:33,159 --> 00:20:38,049
will have the same darn level of

542
00:20:35,380 --> 00:20:38,710
permissions<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Alice does okay it's</font>

543
00:20:38,049 --> 00:20:41,649
that simple

544
00:20:38,710 --> 00:20:43,389
and to do it<font color="#E5E5E5"> we use incognito part of</font>

545
00:20:41,649 --> 00:20:46,149
<font color="#E5E5E5">Metasploit we're going to impersonate</font>

546
00:20:43,389 --> 00:20:48,399
this token okay and once we're

547
00:20:46,149 --> 00:20:50,799
impersonated we drop into<font color="#CCCCCC"> a shell we</font>

548
00:20:48,399 --> 00:20:52,149
validate through<font color="#CCCCCC"> Who am I and we see</font>

549
00:20:50,799 --> 00:20:54,519
that we're actually the administrator

550
00:20:52,149 --> 00:20:57,070
itself<font color="#E5E5E5"> okay it's that simple</font><font color="#CCCCCC"> takes</font>

551
00:20:54,519 --> 00:20:58,690
minutes to<font color="#CCCCCC"> run</font><font color="#E5E5E5"> this attack so there's</font>

552
00:20:57,070 --> 00:21:00,250
ways<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we can prevent against</font><font color="#E5E5E5"> this</font>

553
00:20:58,690 --> 00:21:04,029
<font color="#E5E5E5">all right we're going to talk</font><font color="#CCCCCC"> about that</font>

554
00:21:00,250 --> 00:21:06,850
but<font color="#CCCCCC"> again a review perspective</font><font color="#E5E5E5"> get local</font>

555
00:21:04,029 --> 00:21:08,740
administrator access<font color="#E5E5E5"> first identify</font>

556
00:21:06,850 --> 00:21:10,059
those juicy<font color="#CCCCCC"> two tokens that</font><font color="#E5E5E5"> you want to</font>

557
00:21:08,740 --> 00:21:11,679
impersonate because if you think<font color="#CCCCCC"> about</font>

558
00:21:10,059 --> 00:21:13,539
<font color="#E5E5E5">it you've got many</font><font color="#CCCCCC"> different</font><font color="#E5E5E5"> machines</font>

559
00:21:11,679 --> 00:21:15,760
that you can look at generally speaking

560
00:21:13,539 --> 00:21:17,860
it usually takes us<font color="#CCCCCC"> a few machines</font><font color="#E5E5E5"> to</font>

561
00:21:15,760 --> 00:21:19,210
find a<font color="#E5E5E5"> domain administrator token that's</font>

562
00:21:17,860 --> 00:21:21,219
<font color="#E5E5E5">that's been dropped on all right it's</font>

563
00:21:19,210 --> 00:21:23,320
usually<font color="#E5E5E5"> not the first time will</font>

564
00:21:21,220 --> 00:21:26,019
impersonate that token with incognito

565
00:21:23,320 --> 00:21:27,340
exploit<font color="#E5E5E5"> and land and expand right then</font>

566
00:21:26,019 --> 00:21:29,289
we'll move laterally<font color="#CCCCCC"> we'll start data</font>

567
00:21:27,340 --> 00:21:32,379
exfiltration<font color="#CCCCCC"> all that good stuff</font><font color="#E5E5E5"> but</font>

568
00:21:29,289 --> 00:21:34,629
tokens are extremely<font color="#CCCCCC"> easy way for your</font>

569
00:21:32,380 --> 00:21:36,669
existing domain users or any just any

570
00:21:34,630 --> 00:21:39,220
malicious<font color="#CCCCCC"> thread actor who gets domain</font>

571
00:21:36,669 --> 00:21:42,309
user access<font color="#E5E5E5"> to expand those political</font>

572
00:21:39,220 --> 00:21:44,440
privileges<font color="#E5E5E5"> real quickly how do you stop</font>

573
00:21:42,309 --> 00:21:47,019
<font color="#CCCCCC">it how do you detect</font><font color="#E5E5E5"> it first of all</font>

574
00:21:44,440 --> 00:21:48,730
well<font color="#E5E5E5"> people don't know is that</font><font color="#CCCCCC"> you can</font>

575
00:21:47,019 --> 00:21:52,210
turn off<font color="#E5E5E5"> impersonation on your</font>

576
00:21:48,730 --> 00:21:54,100
<font color="#CCCCCC">high-value targets which you should</font><font color="#E5E5E5"> all</font>

577
00:21:52,210 --> 00:21:55,750
<font color="#E5E5E5">right if there's any accounts out there</font>

578
00:21:54,100 --> 00:21:58,029
such as<font color="#E5E5E5"> domain admins or high value</font>

579
00:21:55,750 --> 00:22:00,820
<font color="#CCCCCC">targets anybody with</font><font color="#E5E5E5"> elevated privileges</font>

580
00:21:58,029 --> 00:22:03,309
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want to turn this stuff</font><font color="#E5E5E5"> off people</font>

581
00:22:00,820 --> 00:22:05,659
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right and it's relatively</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> to do</font>

582
00:22:03,309 --> 00:22:07,399
so through<font color="#CCCCCC"> GPOs and</font>

583
00:22:05,660 --> 00:22:09,230
other domain account settings but it's

584
00:22:07,400 --> 00:22:11,120
basically what you can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> here this</font>

585
00:22:09,230 --> 00:22:14,390
<font color="#CCCCCC">says account is sensitive</font><font color="#E5E5E5"> and cannot be</font>

586
00:22:11,120 --> 00:22:16,729
delegated<font color="#CCCCCC"> okay it's a really simple</font><font color="#E5E5E5"> fix</font>

587
00:22:14,390 --> 00:22:19,490
now there's<font color="#E5E5E5"> certain situations</font><font color="#CCCCCC"> where you</font>

588
00:22:16,730 --> 00:22:25,930
may need impersonation capabilities but

589
00:22:19,490 --> 00:22:31,220
very rarely<font color="#CCCCCC"> very rarely okay all</font><font color="#E5E5E5"> right</font>

590
00:22:25,930 --> 00:22:33,680
moving<font color="#E5E5E5"> on to Kerberos</font><font color="#CCCCCC"> and SPN tickets</font>

591
00:22:31,220 --> 00:22:37,250
<font color="#E5E5E5">anybody ever heard of an</font><font color="#CCCCCC"> SP n ticket</font>

592
00:22:33,680 --> 00:22:39,880
<font color="#E5E5E5">service</font><font color="#CCCCCC"> principal</font><font color="#E5E5E5"> name</font><font color="#CCCCCC"> alright kind</font><font color="#E5E5E5"> of</font>

593
00:22:37,250 --> 00:22:44,360
the same thing with<font color="#E5E5E5"> tokens</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

594
00:22:39,880 --> 00:22:46,220
SP ends<font color="#CCCCCC"> are tickets that are stored on</font>

595
00:22:44,360 --> 00:22:48,979
<font color="#E5E5E5">on your domain controllers</font><font color="#CCCCCC"> or file</font>

596
00:22:46,220 --> 00:22:51,950
servers that basically do the same<font color="#CCCCCC"> thing</font>

597
00:22:48,980 --> 00:22:54,170
<font color="#CCCCCC">from a user perspective except with</font>

598
00:22:51,950 --> 00:22:55,970
services<font color="#CCCCCC"> all right so we all have</font>

599
00:22:54,170 --> 00:22:58,010
services<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are running within our</font>

600
00:22:55,970 --> 00:22:59,330
network<font color="#E5E5E5"> right services</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> running all</font>

601
00:22:58,010 --> 00:23:01,490
the time well we don't<font color="#E5E5E5"> need to send the</font>

602
00:22:59,330 --> 00:23:03,770
service<font color="#CCCCCC"> username and password</font><font color="#E5E5E5"> and every</font>

603
00:23:01,490 --> 00:23:06,410
<font color="#E5E5E5">single request that that service needs</font>

604
00:23:03,770 --> 00:23:09,379
to make we've<font color="#E5E5E5"> got backup exec or backup</font>

605
00:23:06,410 --> 00:23:11,750
services<font color="#E5E5E5"> we've got antivirus services</font>

606
00:23:09,380 --> 00:23:14,120
got all sorts of services<font color="#E5E5E5"> running</font>

607
00:23:11,750 --> 00:23:17,180
<font color="#E5E5E5">throughout the environment I bet a lot</font>

608
00:23:14,120 --> 00:23:19,100
<font color="#CCCCCC">of you know that first of</font><font color="#E5E5E5"> all services</font>

609
00:23:17,180 --> 00:23:22,870
<font color="#E5E5E5">are usually running under</font><font color="#CCCCCC"> higher</font>

610
00:23:19,100 --> 00:23:27,110
<font color="#CCCCCC">privileged</font><font color="#E5E5E5"> accounts right generally</font>

611
00:23:22,870 --> 00:23:29,510
services which was we've seen<font color="#CCCCCC"> have bad</font>

612
00:23:27,110 --> 00:23:30,290
passwords<font color="#CCCCCC"> have easy easily guest</font>

613
00:23:29,510 --> 00:23:35,330
passwords

614
00:23:30,290 --> 00:23:39,740
okay so<font color="#CCCCCC"> fpn ticketing as we call it is a</font>

615
00:23:35,330 --> 00:23:42,199
way where any valid domain user can

616
00:23:39,740 --> 00:23:43,790
request a ticket for<font color="#E5E5E5"> any</font><font color="#CCCCCC"> domain service</font>

617
00:23:42,200 --> 00:23:46,340
let me repeat that and then tell you

618
00:23:43,790 --> 00:23:49,909
<font color="#CCCCCC">what that</font><font color="#E5E5E5"> means any domain user in your</font>

619
00:23:46,340 --> 00:23:53,990
<font color="#CCCCCC">environment today</font><font color="#E5E5E5"> can query your your</font>

620
00:23:49,910 --> 00:23:57,350
servers and this<font color="#E5E5E5"> is what they get what</font>

621
00:23:53,990 --> 00:24:00,560
is<font color="#E5E5E5"> this first of all a little tool from</font>

622
00:23:57,350 --> 00:24:03,800
<font color="#CCCCCC">an packet one of our very reputable</font><font color="#E5E5E5"> and</font>

623
00:24:00,560 --> 00:24:06,020
credible<font color="#CCCCCC"> open source tools and security</font>

624
00:24:03,800 --> 00:24:08,000
groups out there<font color="#CCCCCC"> and packet offers this</font>

625
00:24:06,020 --> 00:24:11,780
<font color="#CCCCCC">scripts this Python script called get</font>

626
00:24:08,000 --> 00:24:14,300
user SPS<font color="#CCCCCC"> and really all you need</font><font color="#E5E5E5"> to do</font>

627
00:24:11,780 --> 00:24:15,389
is<font color="#E5E5E5"> provide it with</font><font color="#CCCCCC"> the domain info your</font>

628
00:24:14,300 --> 00:24:19,469
<font color="#CCCCCC">username you</font>

629
00:24:15,389 --> 00:24:22,619
or password<font color="#E5E5E5"> not my password and it'll</font>

630
00:24:19,469 --> 00:24:23,999
spit back<font color="#CCCCCC"> the actual tickets okay now</font>

631
00:24:22,619 --> 00:24:26,549
what's in this<font color="#E5E5E5"> ticket let's let's</font>

632
00:24:23,999 --> 00:24:29,190
dissect<font color="#E5E5E5"> this a little bit first of all</font>

633
00:24:26,549 --> 00:24:32,070
<font color="#E5E5E5">this is what's called a</font><font color="#CCCCCC"> krb five TGS a</font>

634
00:24:29,190 --> 00:24:34,409
Kerberos 5<font color="#CCCCCC"> PGS hash if you're familiar</font>

635
00:24:32,070 --> 00:24:38,009
with ntlm<font color="#CCCCCC"> v 2</font><font color="#E5E5E5"> hashes</font><font color="#CCCCCC"> you're familiar</font>

636
00:24:34,409 --> 00:24:42,749
with other hashes this is a long-ass

637
00:24:38,009 --> 00:24:44,190
hash<font color="#CCCCCC"> ok and I had to truncate it</font><font color="#E5E5E5"> because</font>

638
00:24:42,749 --> 00:24:45,690
it<font color="#E5E5E5"> wouldn't all fit on this screen so</font>

639
00:24:44,190 --> 00:24:48,119
<font color="#E5E5E5">what is the long hash mean generally</font>

640
00:24:45,690 --> 00:24:50,489
harder to crack<font color="#E5E5E5"> right but not all the</font>

641
00:24:48,119 --> 00:24:53,428
<font color="#E5E5E5">time so now as a domain user</font>

642
00:24:50,489 --> 00:24:55,799
I've got your SQL administrator service

643
00:24:53,429 --> 00:24:57,809
<font color="#CCCCCC">i've got whatever</font><font color="#E5E5E5"> goober crazy high</font>

644
00:24:55,799 --> 00:24:59,849
value target user or service that's in

645
00:24:57,809 --> 00:25:01,739
there as well<font color="#CCCCCC"> too and now i need to</font>

646
00:24:59,849 --> 00:25:03,899
<font color="#E5E5E5">crack these hashes now when we go into</font>

647
00:25:01,739 --> 00:25:07,559
environments and we do this<font color="#E5E5E5"> we generally</font>

648
00:25:03,899 --> 00:25:10,619
get a ton of different<font color="#CCCCCC"> service principle</font>

649
00:25:07,559 --> 00:25:12,178
tickets<font color="#CCCCCC"> okay and it's easy</font><font color="#E5E5E5"> for us</font><font color="#CCCCCC"> to</font>

650
00:25:10,619 --> 00:25:14,158
<font color="#CCCCCC">figure out which ones we want to focus</font>

651
00:25:12,179 --> 00:25:16,889
on because the name of the account<font color="#E5E5E5"> it's</font>

652
00:25:14,159 --> 00:25:20,609
relatively simple<font color="#E5E5E5"> so how do we crack</font>

653
00:25:16,889 --> 00:25:24,238
those hashes<font color="#E5E5E5"> how else hash</font><font color="#CCCCCC"> Kat</font><font color="#E5E5E5"> John the</font>

654
00:25:20,609 --> 00:25:26,399
Ripper<font color="#E5E5E5"> you got to use the other version</font>

655
00:25:24,239 --> 00:25:28,049
of John I can't remember John<font color="#E5E5E5"> combo or</font>

656
00:25:26,399 --> 00:25:31,139
something it's John doesn't<font color="#E5E5E5"> work that</font>

657
00:25:28,049 --> 00:25:34,649
well hash<font color="#E5E5E5"> cat does for these</font><font color="#CCCCCC"> kr PG k r</font>

658
00:25:31,139 --> 00:25:36,119
<font color="#CCCCCC">b5</font><font color="#E5E5E5"> TGS hashes</font><font color="#CCCCCC"> so you fire up hash</font><font color="#E5E5E5"> cat</font>

659
00:25:34,649 --> 00:25:37,829
you tell it what type of hash you're

660
00:25:36,119 --> 00:25:41,879
looking at in this case<font color="#CCCCCC"> these SP</font><font color="#E5E5E5"> ends</font>

661
00:25:37,829 --> 00:25:43,559
are<font color="#CCCCCC"> 13 100 and you go to town now it</font>

662
00:25:41,879 --> 00:25:46,439
generally<font color="#E5E5E5"> takes a little bit longer to</font>

663
00:25:43,559 --> 00:25:47,969
crack these<font color="#CCCCCC"> hashes</font><font color="#E5E5E5"> but not forever</font><font color="#CCCCCC"> and</font>

664
00:25:46,440 --> 00:25:50,249
I'm telling you you know when the

665
00:25:47,969 --> 00:25:52,950
password<font color="#CCCCCC"> on some of these is very simple</font>

666
00:25:50,249 --> 00:25:55,679
<font color="#E5E5E5">it doesn't take</font><font color="#CCCCCC"> that long so now again</font>

667
00:25:52,950 --> 00:25:57,389
within<font color="#E5E5E5"> a series</font><font color="#CCCCCC"> of minutes</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> this</font>

668
00:25:55,679 --> 00:25:59,489
<font color="#E5E5E5">doesn't take long</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> something</font>

669
00:25:57,389 --> 00:26:02,488
takes 20 minutes<font color="#CCCCCC"> to run</font><font color="#E5E5E5"> if that</font><font color="#CCCCCC"> 5-10</font>

670
00:25:59,489 --> 00:26:04,079
<font color="#E5E5E5">minutes we've got the hatches for your</font>

671
00:26:02,489 --> 00:26:06,509
high privilege service accounts in

672
00:26:04,079 --> 00:26:08,908
addition to hopefully having cracked a

673
00:26:06,509 --> 00:26:11,459
few of these as<font color="#E5E5E5"> well</font><font color="#CCCCCC"> okay so if we're</font>

674
00:26:08,909 --> 00:26:13,469
not<font color="#CCCCCC"> successful</font><font color="#E5E5E5"> here we'll move on but</font>

675
00:26:11,459 --> 00:26:15,629
generally<font color="#E5E5E5"> we</font><font color="#CCCCCC"> find a lot of</font><font color="#E5E5E5"> success in</font>

676
00:26:13,469 --> 00:26:16,919
<font color="#E5E5E5">these service</font><font color="#CCCCCC"> principle names but a lot</font>

677
00:26:15,629 --> 00:26:20,039
<font color="#CCCCCC">of the things I'm describing to</font><font color="#E5E5E5"> you</font>

678
00:26:16,919 --> 00:26:23,219
today<font color="#E5E5E5"> they're they're tough to detect</font>

679
00:26:20,039 --> 00:26:25,919
<font color="#E5E5E5">and they're tough to prevent</font><font color="#CCCCCC"> okay that's</font>

680
00:26:23,219 --> 00:26:27,240
why we do them that's exactly<font color="#CCCCCC"> why we do</font>

681
00:26:25,919 --> 00:26:29,220
them<font color="#E5E5E5"> so</font>

682
00:26:27,240 --> 00:26:30,780
there are some things that<font color="#E5E5E5"> we can do but</font>

683
00:26:29,220 --> 00:26:32,130
real quickly that<font color="#E5E5E5"> overview the first</font>

684
00:26:30,780 --> 00:26:34,950
<font color="#CCCCCC">thing we do is we've got</font><font color="#E5E5E5"> to get those</font>

685
00:26:32,130 --> 00:26:37,170
<font color="#CCCCCC">SPN</font><font color="#E5E5E5"> tickets we've got to identify</font><font color="#CCCCCC"> which</font>

686
00:26:34,950 --> 00:26:39,150
ones we want<font color="#CCCCCC"> to try to</font><font color="#E5E5E5"> grab and crack</font><font color="#CCCCCC"> we</font>

687
00:26:37,170 --> 00:26:41,250
request those<font color="#CCCCCC"> hashes and</font><font color="#E5E5E5"> we crack the</font>

688
00:26:39,150 --> 00:26:43,980
hashes not rocket science

689
00:26:41,250 --> 00:26:46,559
pretty simple<font color="#E5E5E5"> but to detect and prevent</font>

690
00:26:43,980 --> 00:26:48,720
<font color="#E5E5E5">this stuff there's a little bit more to</font>

691
00:26:46,559 --> 00:26:50,428
it<font color="#E5E5E5"> than that</font><font color="#CCCCCC"> so we've been doing</font><font color="#E5E5E5"> this</font>

692
00:26:48,720 --> 00:26:52,140
for<font color="#CCCCCC"> a lot we've actually had to kind of</font>

693
00:26:50,429 --> 00:26:53,520
construct our own detection and

694
00:26:52,140 --> 00:26:56,010
<font color="#E5E5E5">prevention mechanisms here there's not</font>

695
00:26:53,520 --> 00:26:58,889
too much out there<font color="#CCCCCC"> that tells you how to</font>

696
00:26:56,010 --> 00:27:00,809
<font color="#E5E5E5">do this stuff</font><font color="#CCCCCC"> but first</font><font color="#E5E5E5"> of all I mean</font>

697
00:26:58,890 --> 00:27:03,320
password complexity first and foremost

698
00:27:00,809 --> 00:27:05,730
<font color="#E5E5E5">right we assess an International Airport</font>

699
00:27:03,320 --> 00:27:08,639
<font color="#CCCCCC">six months ago or so when</font><font color="#E5E5E5"> we did this</font>

700
00:27:05,730 --> 00:27:10,260
<font color="#E5E5E5">got a ton of hashes and we collaborate</font>

701
00:27:08,640 --> 00:27:11,520
with<font color="#E5E5E5"> our clients as we're we're</font>

702
00:27:10,260 --> 00:27:13,050
conducting<font color="#E5E5E5"> we're not like the wizard</font>

703
00:27:11,520 --> 00:27:15,270
behind the curtain shop or we're like

704
00:27:13,050 --> 00:27:16,740
you can't see what we're doing<font color="#E5E5E5"> we're</font>

705
00:27:15,270 --> 00:27:18,870
like come<font color="#E5E5E5"> out and see what we're doing</font>

706
00:27:16,740 --> 00:27:20,970
<font color="#CCCCCC">and he's like</font><font color="#E5E5E5"> you're</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> gonna you're</font>

707
00:27:18,870 --> 00:27:23,100
<font color="#E5E5E5">not going to crack those</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> are 26</font>

708
00:27:20,970 --> 00:27:24,960
characters long<font color="#E5E5E5"> uppercase lowercase</font>

709
00:27:23,100 --> 00:27:27,240
numeric special characters ask you all

710
00:27:24,960 --> 00:27:30,030
sorts of stuff<font color="#CCCCCC"> so that is a great</font>

711
00:27:27,240 --> 00:27:33,590
defense mechanism against some of<font color="#E5E5E5"> these</font>

712
00:27:30,030 --> 00:27:36,690
vulnerabilities<font color="#CCCCCC"> the SGN</font><font color="#E5E5E5"> tickets</font>

713
00:27:33,590 --> 00:27:38,220
<font color="#E5E5E5">monitoring is in some people will say</font>

714
00:27:36,690 --> 00:27:39,540
you<font color="#E5E5E5"> know detection is more important</font>

715
00:27:38,220 --> 00:27:41,640
than prevention<font color="#CCCCCC"> because</font><font color="#E5E5E5"> I want to see</font>

716
00:27:39,540 --> 00:27:43,500
what's going<font color="#E5E5E5"> on and I'm sometimes one</font><font color="#CCCCCC"> of</font>

717
00:27:41,640 --> 00:27:46,470
those guys<font color="#CCCCCC"> but there's a couple ways</font>

718
00:27:43,500 --> 00:27:49,050
<font color="#E5E5E5">that you can look for these</font><font color="#CCCCCC"> specific</font>

719
00:27:46,470 --> 00:27:53,010
requests<font color="#E5E5E5"> first of all</font><font color="#CCCCCC"> a standard domain</font>

720
00:27:49,050 --> 00:27:56,250
user<font color="#E5E5E5"> shouldn't be making a ton</font><font color="#CCCCCC"> of these</font>

721
00:27:53,010 --> 00:27:58,470
requests to<font color="#E5E5E5"> pulldown SPN tickets so if</font>

722
00:27:56,250 --> 00:28:00,390
you can look first of<font color="#E5E5E5"> all by enabling</font>

723
00:27:58,470 --> 00:28:02,490
Kerberos service ticket<font color="#CCCCCC"> request</font>

724
00:28:00,390 --> 00:28:04,380
monitoring you<font color="#CCCCCC"> can then look</font><font color="#E5E5E5"> for</font>

725
00:28:02,490 --> 00:28:06,030
excessive what are called four seven six

726
00:28:04,380 --> 00:28:08,040
nine<font color="#CCCCCC"> events that the event ID that you</font>

727
00:28:06,030 --> 00:28:10,260
<font color="#E5E5E5">want to look for we've had</font><font color="#CCCCCC"> customers</font>

728
00:28:08,040 --> 00:28:11,639
build these rules in their sins and

729
00:28:10,260 --> 00:28:13,080
their<font color="#CCCCCC"> threat on</font><font color="#E5E5E5"> eBay in all these</font>

730
00:28:11,640 --> 00:28:14,550
<font color="#CCCCCC">different</font><font color="#E5E5E5"> areas and we're actually</font>

731
00:28:13,080 --> 00:28:16,610
<font color="#E5E5E5">working with</font><font color="#CCCCCC"> some security</font><font color="#E5E5E5"> vendor</font>

732
00:28:14,550 --> 00:28:19,590
products as well<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> sure that they</font>

733
00:28:16,610 --> 00:28:22,979
figured<font color="#CCCCCC"> this stuff out as well</font><font color="#E5E5E5"> - okay so</font>

734
00:28:19,590 --> 00:28:24,720
if<font color="#E5E5E5"> nothing start looking</font><font color="#CCCCCC"> for abnormal</font>

735
00:28:22,980 --> 00:28:27,240
<font color="#E5E5E5">four seven six</font><font color="#CCCCCC"> nine accounts but to do</font>

736
00:28:24,720 --> 00:28:29,070
that you've<font color="#CCCCCC"> got to enable Kerberos</font>

737
00:28:27,240 --> 00:28:34,870
<font color="#E5E5E5">service ticket request monitoring</font>

738
00:28:29,070 --> 00:28:38,470
<font color="#E5E5E5">advanced logging</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> all right</font>

739
00:28:34,870 --> 00:28:40,209
so we're<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> good on time</font><font color="#CCCCCC"> all right so</font>

740
00:28:38,470 --> 00:28:41,830
by this stage most of the time we've<font color="#CCCCCC"> got</font>

741
00:28:40,210 --> 00:28:43,030
domain<font color="#E5E5E5"> admin we've got the crown jewels</font>

742
00:28:41,830 --> 00:28:47,350
we've got what it is that we need to

743
00:28:43,030 --> 00:28:49,120
<font color="#E5E5E5">find the critical data but not always so</font>

744
00:28:47,350 --> 00:28:51,520
now what we're generally facing is some

745
00:28:49,120 --> 00:28:53,620
nasty<font color="#E5E5E5"> or you know traditional antivirus</font>

746
00:28:51,520 --> 00:28:56,590
<font color="#E5E5E5">that somehow is able to detect some</font>

747
00:28:53,620 --> 00:28:59,500
<font color="#E5E5E5">things that we're doing SMB login</font><font color="#CCCCCC"> can</font>

748
00:28:56,590 --> 00:29:01,570
sometimes be detected<font color="#CCCCCC"> PS exact so if</font>

749
00:28:59,500 --> 00:29:03,760
you're familiar with PS exec<font color="#CCCCCC"> is</font><font color="#E5E5E5"> a great</font>

750
00:29:01,570 --> 00:29:06,220
way to leverage<font color="#E5E5E5"> to drop shells on the</font>

751
00:29:03,760 --> 00:29:10,929
<font color="#E5E5E5">machines but it's an also a sure way to</font>

752
00:29:06,220 --> 00:29:12,429
get<font color="#E5E5E5"> flagged by antivirus so a little bit</font>

753
00:29:10,929 --> 00:29:15,160
<font color="#E5E5E5">about evasion a little bit about</font>

754
00:29:12,429 --> 00:29:17,559
obfuscation I'm sure all<font color="#CCCCCC"> of you here in</font>

755
00:29:15,160 --> 00:29:19,960
this room<font color="#CCCCCC"> today</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> having discussions</font>

756
00:29:17,559 --> 00:29:22,120
<font color="#E5E5E5">about endpoint security about advanced</font>

757
00:29:19,960 --> 00:29:24,570
threat protection about EDR about all

758
00:29:22,120 --> 00:29:28,030
those things that are<font color="#E5E5E5"> non-traditional</font>

759
00:29:24,570 --> 00:29:29,530
<font color="#E5E5E5">antivirus security well let's tell you</font>

760
00:29:28,030 --> 00:29:31,480
what we<font color="#E5E5E5"> can do today to defeat those</font>

761
00:29:29,530 --> 00:29:33,250
technologies<font color="#CCCCCC"> and hopefully it influences</font>

762
00:29:31,480 --> 00:29:35,350
<font color="#E5E5E5">your decisions and</font><font color="#CCCCCC"> the questions that</font>

763
00:29:33,250 --> 00:29:37,120
you're<font color="#CCCCCC"> asking your vendors if they can</font>

764
00:29:35,350 --> 00:29:39,659
detect<font color="#E5E5E5"> this stuff all right</font>

765
00:29:37,120 --> 00:29:43,590
so there's lots of<font color="#E5E5E5"> tools out there</font>

766
00:29:39,660 --> 00:29:47,559
<font color="#E5E5E5">Empire great power</font><font color="#CCCCCC"> Schewel</font><font color="#E5E5E5"> PowerShell</font>

767
00:29:43,590 --> 00:29:50,620
exploitation framework<font color="#E5E5E5"> venom and veil</font><font color="#CCCCCC"> to</font>

768
00:29:47,559 --> 00:29:52,450
strong programs<font color="#E5E5E5"> historically that did a</font>

769
00:29:50,620 --> 00:29:54,850
really good<font color="#E5E5E5"> job back in the day of</font>

770
00:29:52,450 --> 00:29:57,280
defeating antivirus<font color="#E5E5E5"> but what we're</font>

771
00:29:54,850 --> 00:29:59,169
<font color="#E5E5E5">seeing they don't work that well</font><font color="#CCCCCC"> anymore</font>

772
00:29:57,280 --> 00:30:02,230
<font color="#E5E5E5">which of the antivirus folks have caught</font>

773
00:29:59,170 --> 00:30:04,240
on the EDR the advanced threat guys have

774
00:30:02,230 --> 00:30:06,490
had<font color="#E5E5E5"> caught on to some</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the</font>

775
00:30:04,240 --> 00:30:08,110
signatures<font color="#E5E5E5"> and the way that they define</font>

776
00:30:06,490 --> 00:30:11,050
those signatures is by<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at the</font>

777
00:30:08,110 --> 00:30:13,689
ways<font color="#E5E5E5"> that these products off you skate</font>

778
00:30:11,050 --> 00:30:16,149
<font color="#E5E5E5">decoder are trying to inject the dynamic</font>

779
00:30:13,690 --> 00:30:19,870
<font color="#CCCCCC">shellcode into whatever payload that it</font>

780
00:30:16,150 --> 00:30:21,760
is that you're<font color="#E5E5E5"> using</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> along comes this</font>

781
00:30:19,870 --> 00:30:26,559
product called<font color="#E5E5E5"> shelter anybody here a</font>

782
00:30:21,760 --> 00:30:29,679
shelter<font color="#E5E5E5"> oh all right if you haven't you</font>

783
00:30:26,559 --> 00:30:31,800
<font color="#CCCCCC">will</font><font color="#E5E5E5"> after this</font><font color="#CCCCCC"> shelters</font><font color="#E5E5E5"> that is the</font>

784
00:30:29,679 --> 00:30:33,850
latest<font color="#E5E5E5"> and</font><font color="#CCCCCC"> greatest way to bypass</font>

785
00:30:31,800 --> 00:30:37,629
<font color="#CCCCCC">antivirus and it</font><font color="#E5E5E5"> can be combined with</font>

786
00:30:33,850 --> 00:30:40,149
both file and file lists capabilities

787
00:30:37,630 --> 00:30:42,010
file<font color="#CCCCCC"> lists malware is all the</font><font color="#E5E5E5"> rage now</font>

788
00:30:40,150 --> 00:30:43,720
<font color="#E5E5E5">and it's a little</font><font color="#CCCCCC"> bit about it</font><font color="#E5E5E5"> but not</font>

789
00:30:42,010 --> 00:30:46,450
not<font color="#CCCCCC"> everything so</font><font color="#E5E5E5"> let's talk</font><font color="#CCCCCC"> about what</font>

790
00:30:43,720 --> 00:30:47,770
shelter<font color="#E5E5E5"> is it is a dynamic shell code</font>

791
00:30:46,450 --> 00:30:50,770
injection tool you

792
00:30:47,770 --> 00:30:53,800
take a standard<font color="#CCCCCC"> Windows 32 executable it</font>

793
00:30:50,770 --> 00:30:57,330
only works on 32-bit right now<font color="#CCCCCC"> and you</font>

794
00:30:53,800 --> 00:31:01,240
inject<font color="#E5E5E5"> your nasty malware</font><font color="#CCCCCC"> into that</font>

795
00:30:57,330 --> 00:31:02,500
executable<font color="#CCCCCC"> okay and the cool thing</font><font color="#E5E5E5"> I'm</font>

796
00:31:01,240 --> 00:31:03,970
going<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about stealth mode here in</font>

797
00:31:02,500 --> 00:31:05,559
a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> bit but the cool thing and</font><font color="#E5E5E5"> the</font>

798
00:31:03,970 --> 00:31:08,440
way that this works is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's not</font>

799
00:31:05,559 --> 00:31:10,360
applying<font color="#E5E5E5"> those same modifications such</font>

800
00:31:08,440 --> 00:31:13,300
as<font color="#E5E5E5"> changing memory access permissions</font>

801
00:31:10,360 --> 00:31:15,490
<font color="#E5E5E5">that Empire venom and veiled you okay so</font>

802
00:31:13,300 --> 00:31:17,139
right now<font color="#E5E5E5"> Empire venom and they all</font>

803
00:31:15,490 --> 00:31:21,370
they're<font color="#CCCCCC"> getting detected</font><font color="#E5E5E5"> by most all all</font>

804
00:31:17,140 --> 00:31:23,950
the AV products shelter not many<font color="#E5E5E5"> if at</font>

805
00:31:21,370 --> 00:31:27,000
all<font color="#CCCCCC"> okay we just</font><font color="#E5E5E5"> did a an engagement a</font>

806
00:31:23,950 --> 00:31:29,200
few weeks ago<font color="#E5E5E5"> blasted through their</font>

807
00:31:27,000 --> 00:31:31,990
situation there we also work<font color="#CCCCCC"> recently</font>

808
00:31:29,200 --> 00:31:33,580
with with Kaspersky<font color="#E5E5E5"> and we're able to do</font>

809
00:31:31,990 --> 00:31:35,260
some bypassing there as well

810
00:31:33,580 --> 00:31:38,260
but what we really like about<font color="#E5E5E5"> this is</font>

811
00:31:35,260 --> 00:31:39,760
what's called stealth mode<font color="#E5E5E5"> so if you</font>

812
00:31:38,260 --> 00:31:42,940
know<font color="#CCCCCC"> anything about attacking</font><font color="#E5E5E5"> an</font>

813
00:31:39,760 --> 00:31:45,070
<font color="#E5E5E5">organization when you deliver your</font>

814
00:31:42,940 --> 00:31:46,150
payload which by there's a lot of

815
00:31:45,070 --> 00:31:47,500
different mechanisms<font color="#CCCCCC"> that I'm going to</font>

816
00:31:46,150 --> 00:31:49,179
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about on how we</font><font color="#E5E5E5"> deliver this</font>

817
00:31:47,500 --> 00:31:51,460
payload<font color="#E5E5E5"> but</font><font color="#CCCCCC"> let's</font><font color="#E5E5E5"> just talk</font><font color="#CCCCCC"> about a</font>

818
00:31:49,179 --> 00:31:55,480
typical social<font color="#E5E5E5"> engineering attack you</font>

819
00:31:51,460 --> 00:31:58,270
deliver an exe right<font color="#CCCCCC"> user clicks on</font><font color="#E5E5E5"> exe</font>

820
00:31:55,480 --> 00:32:01,120
<font color="#E5E5E5">and you know something pops up</font><font color="#CCCCCC"> on their</font>

821
00:31:58,270 --> 00:32:02,590
screen<font color="#CCCCCC"> and then maybe goes away there's</font>

822
00:32:01,120 --> 00:32:05,678
some things there that<font color="#E5E5E5"> just don't</font><font color="#CCCCCC"> look</font>

823
00:32:02,590 --> 00:32:08,080
<font color="#CCCCCC">right so with shelter what you can do is</font>

824
00:32:05,679 --> 00:32:10,840
enable stealth mode<font color="#CCCCCC"> and</font><font color="#E5E5E5"> what it does is</font>

825
00:32:08,080 --> 00:32:12,309
it enables<font color="#E5E5E5"> the native functionality of</font>

826
00:32:10,840 --> 00:32:16,629
the application<font color="#CCCCCC"> to still do what it</font>

827
00:32:12,309 --> 00:32:18,370
needs<font color="#CCCCCC"> to do so</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> I back doored</font><font color="#E5E5E5"> Cal kxe</font>

828
00:32:16,630 --> 00:32:20,830
and then I deliver it to one of<font color="#CCCCCC"> my</font>

829
00:32:18,370 --> 00:32:21,280
targets and they<font color="#CCCCCC"> double-click it</font><font color="#E5E5E5"> guess</font>

830
00:32:20,830 --> 00:32:23,409
what

831
00:32:21,280 --> 00:32:25,660
how is<font color="#E5E5E5"> going to show up and they can</font>

832
00:32:23,410 --> 00:32:28,090
actually do some calculations<font color="#CCCCCC"> alright</font>

833
00:32:25,660 --> 00:32:30,580
<font color="#E5E5E5">but when they launch it also launching</font>

834
00:32:28,090 --> 00:32:33,699
my my shell code also injecting the

835
00:32:30,580 --> 00:32:35,530
payload<font color="#E5E5E5"> and it's super easy to run I</font>

836
00:32:33,700 --> 00:32:40,540
<font color="#CCCCCC">mean this</font><font color="#E5E5E5"> this is really</font><font color="#CCCCCC"> easy to run</font>

837
00:32:35,530 --> 00:32:42,340
runs<font color="#CCCCCC"> in Kali runs in Windows and</font><font color="#E5E5E5"> they're</font>

838
00:32:40,540 --> 00:32:45,520
<font color="#CCCCCC">really</font><font color="#E5E5E5"> easy so what we do here is we run</font>

839
00:32:42,340 --> 00:32:49,480
shelter if you're in a<font color="#CCCCCC"> linux distro</font><font color="#E5E5E5"> you</font>

840
00:32:45,520 --> 00:32:51,520
need wine but<font color="#E5E5E5"> you</font><font color="#CCCCCC"> basically say i want</font>

841
00:32:49,480 --> 00:32:54,190
to<font color="#E5E5E5"> run it an automatic mode you're going</font>

842
00:32:51,520 --> 00:32:57,400
to choose<font color="#E5E5E5"> the executable that you want a</font>

843
00:32:54,190 --> 00:32:59,470
backdoor in Kali for those that go to

844
00:32:57,400 --> 00:33:01,780
Kali<font color="#E5E5E5"> they're in user</font>

845
00:32:59,470 --> 00:33:04,260
<font color="#E5E5E5">err win32</font><font color="#CCCCCC"> binaries there's a ton of</font>

846
00:33:01,780 --> 00:33:08,080
binaries already in there for your

847
00:33:04,260 --> 00:33:11,379
exploitation pleasure<font color="#CCCCCC"> P link is one of</font>

848
00:33:08,080 --> 00:33:14,470
them I used<font color="#E5E5E5"> here netcat</font><font color="#CCCCCC"> our admin</font><font color="#E5E5E5"> a few</font>

849
00:33:11,380 --> 00:33:16,450
others<font color="#E5E5E5"> the</font><font color="#CCCCCC"> good examples of executables</font>

850
00:33:14,470 --> 00:33:18,880
<font color="#CCCCCC">that you can begin</font><font color="#E5E5E5"> the backdoor here</font>

851
00:33:16,450 --> 00:33:20,620
I've just<font color="#E5E5E5"> used this P</font><font color="#CCCCCC"> link executable I</font>

852
00:33:18,880 --> 00:33:22,929
basically run through a<font color="#E5E5E5"> series of</font>

853
00:33:20,620 --> 00:33:24,760
different next next next next<font color="#E5E5E5"> and it's</font>

854
00:33:22,929 --> 00:33:27,010
going<font color="#E5E5E5"> to run a series of different</font>

855
00:33:24,760 --> 00:33:28,330
operation techniques against<font color="#E5E5E5"> this</font>

856
00:33:27,010 --> 00:33:29,740
payload it's going to run<font color="#CCCCCC"> through a</font>

857
00:33:28,330 --> 00:33:32,740
first stage it's going to run<font color="#E5E5E5"> through a</font>

858
00:33:29,740 --> 00:33:35,020
second<font color="#E5E5E5"> and it takes time</font><font color="#CCCCCC"> if you're</font>

859
00:33:32,740 --> 00:33:36,909
running<font color="#E5E5E5"> it in Linux and you're using</font><font color="#CCCCCC"> Y</font>

860
00:33:35,020 --> 00:33:38,799
and it takes about 60 seconds to

861
00:33:36,909 --> 00:33:40,900
actually<font color="#E5E5E5"> obfuscate the code and again</font>

862
00:33:38,799 --> 00:33:42,429
<font color="#E5E5E5">remember it's not doing the dumb things</font>

863
00:33:40,900 --> 00:33:44,260
like<font color="#CCCCCC"> Vale and</font><font color="#E5E5E5"> some of the others are</font>

864
00:33:42,429 --> 00:33:47,830
like modifying permissions in the memory

865
00:33:44,260 --> 00:33:50,080
space<font color="#CCCCCC"> this is really</font><font color="#E5E5E5"> really cool</font><font color="#CCCCCC"> your</font>

866
00:33:47,830 --> 00:33:52,270
<font color="#CCCCCC">slickers</font><font color="#E5E5E5"> you know first stage filtering</font>

867
00:33:50,080 --> 00:33:54,100
do I want to enable stealth<font color="#CCCCCC"> nodes so</font>

868
00:33:52,270 --> 00:33:55,629
that<font color="#E5E5E5"> I retain that native functionality</font>

869
00:33:54,100 --> 00:33:59,320
of the<font color="#CCCCCC"> application I'm look in</font><font color="#E5E5E5"> the</font>

870
00:33:55,630 --> 00:34:01,299
<font color="#E5E5E5">backdoor or do I not care and here's</font>

871
00:33:59,320 --> 00:34:03,250
where you<font color="#CCCCCC"> could also</font><font color="#E5E5E5"> leverage some of</font>

872
00:34:01,299 --> 00:34:07,059
<font color="#E5E5E5">the you know existing tool sets that you</font>

873
00:34:03,250 --> 00:34:09,010
<font color="#E5E5E5">have so today with shelter you</font><font color="#CCCCCC"> can bind</font>

874
00:34:07,059 --> 00:34:10,929
it<font color="#E5E5E5"> to amateur / - shell if that's what</font>

875
00:34:09,010 --> 00:34:13,540
you want to do<font color="#CCCCCC"> okay you can bind it</font><font color="#E5E5E5"> to</font>

876
00:34:10,929 --> 00:34:15,099
your own shell<font color="#E5E5E5"> if you want as well</font><font color="#CCCCCC"> so in</font>

877
00:34:13,540 --> 00:34:16,330
this case I said yep<font color="#E5E5E5"> I'm going to choose</font>

878
00:34:15,099 --> 00:34:20,560
a listener I'm going to look<font color="#E5E5E5"> over</font>

879
00:34:16,330 --> 00:34:23,679
meterpreter reverse<font color="#CCCCCC"> HTTPS and here's my</font>

880
00:34:20,560 --> 00:34:25,418
local host here's my<font color="#CCCCCC"> L port and so when</font>

881
00:34:23,679 --> 00:34:26,500
they<font color="#CCCCCC"> launch</font><font color="#E5E5E5"> the executable obviously</font>

882
00:34:25,418 --> 00:34:28,629
it's going<font color="#E5E5E5"> to connect that to that IP</font>

883
00:34:26,500 --> 00:34:31,690
<font color="#E5E5E5">address on the meterpreter session</font><font color="#CCCCCC"> that</font>

884
00:34:28,629 --> 00:34:33,520
I'm running but when<font color="#CCCCCC"> I run finish up the</font>

885
00:34:31,690 --> 00:34:35,409
shelter payload what you'll see is it

886
00:34:33,520 --> 00:34:38,440
makes sure<font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> actually going to</font>

887
00:34:35,409 --> 00:34:40,240
<font color="#CCCCCC">work and</font><font color="#E5E5E5"> that the shell code was</font>

888
00:34:38,440 --> 00:34:41,950
legitimate<font color="#E5E5E5"> that it's verified that we</font>

889
00:34:40,239 --> 00:34:44,888
know we<font color="#E5E5E5"> got it in there it's obfuscated</font>

890
00:34:41,949 --> 00:34:48,609
in a manner that we need and and it

891
00:34:44,889 --> 00:34:49,750
works<font color="#CCCCCC"> so here it is I mean that's</font><font color="#E5E5E5"> what</font>

892
00:34:48,609 --> 00:34:50,770
it looks like when it's all done<font color="#E5E5E5"> it's</font>

893
00:34:49,750 --> 00:34:52,540
<font color="#CCCCCC">just right there</font>

894
00:34:50,770 --> 00:34:54,159
<font color="#CCCCCC">key link dot exe now you're ready to</font>

895
00:34:52,540 --> 00:34:57,910
plug in place send it to whomever you

896
00:34:54,159 --> 00:35:00,130
<font color="#E5E5E5">want and I'll tell</font><font color="#CCCCCC"> that story</font><font color="#E5E5E5"> later but</font>

897
00:34:57,910 --> 00:35:02,890
<font color="#E5E5E5">dear saw there's a lot of plug-and-play</font>

898
00:35:00,130 --> 00:35:04,089
functionality here<font color="#E5E5E5"> real real easy</font><font color="#CCCCCC"> all</font>

899
00:35:02,890 --> 00:35:04,779
<font color="#E5E5E5">right I'll tell this story now we were</font>

900
00:35:04,089 --> 00:35:07,630
<font color="#CCCCCC">at an engagement</font>

901
00:35:04,780 --> 00:35:08,830
last week two weeks ago and we had to

902
00:35:07,630 --> 00:35:11,680
use o365

903
00:35:08,830 --> 00:35:16,240
<font color="#E5E5E5">to deliver this this</font><font color="#CCCCCC"> p link or the</font>

904
00:35:11,680 --> 00:35:18,940
exploit and crazy<font color="#E5E5E5"> Microsoft was</font>

905
00:35:16,240 --> 00:35:22,319
listening I guess I would say<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we set</font>

906
00:35:18,940 --> 00:35:25,570
<font color="#CCCCCC">it through all 365 to our</font><font color="#E5E5E5"> targeted</font>

907
00:35:22,320 --> 00:35:26,920
employees are targeted employees and we

908
00:35:25,570 --> 00:35:28,690
had a<font color="#E5E5E5"> mature for your session sitting</font>

909
00:35:26,920 --> 00:35:30,940
there waiting<font color="#CCCCCC"> and then all of a sudden</font>

910
00:35:28,690 --> 00:35:32,890
<font color="#CCCCCC">we start to get</font><font color="#E5E5E5"> a couple</font><font color="#CCCCCC"> shelves but</font>

911
00:35:30,940 --> 00:35:36,130
they're<font color="#E5E5E5"> not from our customer they're</font>

912
00:35:32,890 --> 00:35:38,170
from<font color="#CCCCCC"> Microsoft</font><font color="#E5E5E5"> detonation camp the they</font>

913
00:35:36,130 --> 00:35:40,360
picked up on<font color="#CCCCCC"> our threat checked out the</font>

914
00:35:38,170 --> 00:35:42,490
executable launched it and we could see

915
00:35:40,360 --> 00:35:44,410
Microsoft<font color="#CCCCCC"> popping</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> were getting shells</font>

916
00:35:42,490 --> 00:35:47,109
<font color="#CCCCCC">popping it was you</font><font color="#E5E5E5"> know like the name of</font>

917
00:35:44,410 --> 00:35:49,629
<font color="#E5E5E5">the machine was IT system board</font><font color="#CCCCCC"> slash</font>

918
00:35:47,110 --> 00:35:52,390
admin we saw these things correlated the

919
00:35:49,630 --> 00:35:54,340
IP addresses<font color="#CCCCCC"> we're like oh shit it's</font>

920
00:35:52,390 --> 00:35:56,040
Microsoft detonated in our malware<font color="#CCCCCC"> this</font>

921
00:35:54,340 --> 00:35:58,510
<font color="#CCCCCC">is kind of cool on one hand on the other</font>

922
00:35:56,040 --> 00:36:02,860
<font color="#E5E5E5">check our Terms of Service real quick</font>

923
00:35:58,510 --> 00:36:05,080
share so<font color="#E5E5E5"> that shelter but there's you</font>

924
00:36:02,860 --> 00:36:06,760
<font color="#E5E5E5">know we talked a little bit about how</font>

925
00:36:05,080 --> 00:36:09,400
you deliver<font color="#CCCCCC"> that payload</font><font color="#E5E5E5"> because now</font>

926
00:36:06,760 --> 00:36:11,230
you've just got this executable<font color="#E5E5E5"> if</font>

927
00:36:09,400 --> 00:36:12,460
you're<font color="#E5E5E5"> inside the network or outside the</font>

928
00:36:11,230 --> 00:36:14,790
network<font color="#CCCCCC"> there's a lot of different ways</font>

929
00:36:12,460 --> 00:36:17,350
that<font color="#E5E5E5"> you can use this veil catapult</font>

930
00:36:14,790 --> 00:36:19,529
<font color="#E5E5E5">rightfully named is a way to deliver</font>

931
00:36:17,350 --> 00:36:22,420
<font color="#E5E5E5">your payload using a bunch of different</font>

932
00:36:19,530 --> 00:36:24,580
exploitation techniques<font color="#E5E5E5"> as long as</font>

933
00:36:22,420 --> 00:36:26,050
you've got domain user capabilities if

934
00:36:24,580 --> 00:36:28,299
you're familiar with the<font color="#CCCCCC"> power-up</font>

935
00:36:26,050 --> 00:36:31,450
<font color="#CCCCCC">powershell scripts</font><font color="#E5E5E5"> it uses some of those</font>

936
00:36:28,300 --> 00:36:33,520
<font color="#E5E5E5">similar functions to get</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> payload to</font>

937
00:36:31,450 --> 00:36:37,930
<font color="#E5E5E5">your computer that you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> it on and</font>

938
00:36:33,520 --> 00:36:40,210
<font color="#E5E5E5">also to run it that's the thing so we</font>

939
00:36:37,930 --> 00:36:41,919
here rely you can use<font color="#E5E5E5"> client-side</font>

940
00:36:40,210 --> 00:36:43,810
exploits but those are dead in my

941
00:36:41,920 --> 00:36:45,190
opinion what<font color="#CCCCCC"> I mean by that</font><font color="#E5E5E5"> is you know</font>

942
00:36:43,810 --> 00:36:47,460
I shouldn't say they're dead especially

943
00:36:45,190 --> 00:36:49,870
<font color="#E5E5E5">with</font><font color="#CCCCCC"> Tabitha's little drop here on</font>

944
00:36:47,460 --> 00:36:51,490
earlier<font color="#E5E5E5"> this week but they're they're no</font>

945
00:36:49,870 --> 00:36:53,529
longer<font color="#E5E5E5"> as prevalent as they used to be</font>

946
00:36:51,490 --> 00:36:56,020
so we're talking either<font color="#E5E5E5"> client-side</font>

947
00:36:53,530 --> 00:36:58,360
<font color="#E5E5E5">operating system vulnerabilities we're</font>

948
00:36:56,020 --> 00:37:00,220
talking application operation

949
00:36:58,360 --> 00:37:01,870
vulnerabilities at this stage Java Adobe

950
00:37:00,220 --> 00:37:04,419
all those things<font color="#E5E5E5"> those can</font><font color="#CCCCCC"> be one way</font>

951
00:37:01,870 --> 00:37:06,220
you can deliver this but PowerShell is

952
00:37:04,420 --> 00:37:08,680
web<font color="#CCCCCC"> delivery mechanism is pretty slick</font>

953
00:37:06,220 --> 00:37:12,129
we can invoke a<font color="#E5E5E5"> PowerShell script that</font>

954
00:37:08,680 --> 00:37:15,339
<font color="#CCCCCC">says go out and get this executable</font><font color="#E5E5E5"> kick</font>

955
00:37:12,130 --> 00:37:17,140
it off just<font color="#CCCCCC"> like that okay and then</font>

956
00:37:15,340 --> 00:37:20,200
<font color="#E5E5E5">metalloids got some similar web delivery</font>

957
00:37:17,140 --> 00:37:21,759
<font color="#E5E5E5">capabilities</font><font color="#CCCCCC"> you could use PS exact to</font>

958
00:37:20,200 --> 00:37:24,939
do this as well<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of like an auto run</font>

959
00:37:21,760 --> 00:37:26,800
<font color="#E5E5E5">function but we try to stay</font><font color="#CCCCCC"> away from</font>

960
00:37:24,940 --> 00:37:28,780
interpreter nowadays it's<font color="#CCCCCC"> really easy</font><font color="#E5E5E5"> to</font>

961
00:37:26,800 --> 00:37:31,470
see the first stage get caught by a<font color="#E5E5E5"> VA</font>

962
00:37:28,780 --> 00:37:33,670
or<font color="#E5E5E5"> other detection mechanisms but</font>

963
00:37:31,470 --> 00:37:36,160
PowerShell I mean<font color="#CCCCCC"> for all of</font><font color="#E5E5E5"> you that</font>

964
00:37:33,670 --> 00:37:37,870
<font color="#E5E5E5">have heard of laying off the</font><font color="#CCCCCC"> land</font><font color="#E5E5E5"> we're</font>

965
00:37:36,160 --> 00:37:38,440
living off the land that's the<font color="#CCCCCC"> latest</font>

966
00:37:37,870 --> 00:37:40,660
<font color="#E5E5E5">buzzword</font>

967
00:37:38,440 --> 00:37:42,220
<font color="#CCCCCC">which means these file lists malware</font>

968
00:37:40,660 --> 00:37:43,870
attacks are taking<font color="#CCCCCC"> advantage of the</font>

969
00:37:42,220 --> 00:37:46,029
native tools we have on the operating

970
00:37:43,870 --> 00:37:47,650
system<font color="#CCCCCC"> right now why do</font><font color="#E5E5E5"> I need to</font>

971
00:37:46,030 --> 00:37:49,300
install some special netcat tool when I

972
00:37:47,650 --> 00:37:52,300
got PowerShell<font color="#E5E5E5"> can do it for</font><font color="#CCCCCC"> me</font>

973
00:37:49,300 --> 00:37:55,900
<font color="#CCCCCC">NAB is not</font><font color="#E5E5E5"> going to pick it up so those</font>

974
00:37:52,300 --> 00:37:59,110
are<font color="#E5E5E5"> some ways that we can</font><font color="#CCCCCC"> deliver</font><font color="#E5E5E5"> this</font>

975
00:37:55,900 --> 00:38:01,720
<font color="#E5E5E5">specific payload so what do we do</font><font color="#CCCCCC"> again</font>

976
00:37:59,110 --> 00:38:03,910
quick overview we generate<font color="#E5E5E5"> that payload</font>

977
00:38:01,720 --> 00:38:05,980
<font color="#CCCCCC">I</font><font color="#E5E5E5"> use the Ron Popeil method set it and</font>

978
00:38:03,910 --> 00:38:08,980
forget it<font color="#E5E5E5"> simple nobody knows Ron Popeil</font>

979
00:38:05,980 --> 00:38:12,100
<font color="#CCCCCC">know okay</font><font color="#E5E5E5"> good set it and forget it</font>

980
00:38:08,980 --> 00:38:14,730
deliver the payload<font color="#CCCCCC"> wreak your</font><font color="#E5E5E5"> shell</font><font color="#CCCCCC"> all</font>

981
00:38:12,100 --> 00:38:20,440
<font color="#E5E5E5">right data exfiltration move laterally</font>

982
00:38:14,730 --> 00:38:22,450
laterally and land and expand detecting

983
00:38:20,440 --> 00:38:23,740
and preventing shelter payloads so this

984
00:38:22,450 --> 00:38:27,730
goes against a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of other different</font>

985
00:38:23,740 --> 00:38:29,859
<font color="#E5E5E5">payloads but this is tough</font><font color="#CCCCCC"> I in our team</font>

986
00:38:27,730 --> 00:38:31,690
wouldn't<font color="#E5E5E5"> be using this right now</font><font color="#CCCCCC"> if it</font>

987
00:38:29,860 --> 00:38:34,600
was<font color="#E5E5E5"> easy to detect and easy to prevent</font>

988
00:38:31,690 --> 00:38:36,370
<font color="#E5E5E5">all right so it's it's it's relatively</font>

989
00:38:34,600 --> 00:38:38,440
<font color="#CCCCCC">difficult</font><font color="#E5E5E5"> you can look at some of the</font>

990
00:38:36,370 --> 00:38:40,750
different<font color="#CCCCCC"> vilest memory malware tools</font>

991
00:38:38,440 --> 00:38:43,720
<font color="#E5E5E5">listen I'm not an</font><font color="#CCCCCC"> advocate of</font><font color="#E5E5E5"> any any</font>

992
00:38:40,750 --> 00:38:45,520
specific<font color="#CCCCCC"> products to defeat a specific</font>

993
00:38:43,720 --> 00:38:47,470
<font color="#E5E5E5">attack vector I mean there's solutions</font>

994
00:38:45,520 --> 00:38:50,020
<font color="#E5E5E5">that are better</font><font color="#CCCCCC"> suited to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> certain</font>

995
00:38:47,470 --> 00:38:51,970
things<font color="#E5E5E5"> but you know semantics got some</font>

996
00:38:50,020 --> 00:38:53,890
stuff out there carbon black<font color="#CCCCCC"> Taney and</font>

997
00:38:51,970 --> 00:38:55,240
<font color="#E5E5E5">whatever I haven't tested it against any</font>

998
00:38:53,890 --> 00:38:56,770
of these because<font color="#CCCCCC"> every environment</font><font color="#E5E5E5"> we've</font>

999
00:38:55,240 --> 00:38:58,750
dropped it into<font color="#E5E5E5"> is just blown</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> doors</font>

1000
00:38:56,770 --> 00:39:00,400
off<font color="#E5E5E5"> everything there's a chance</font><font color="#CCCCCC"> that</font>

1001
00:38:58,750 --> 00:39:04,560
<font color="#E5E5E5">some of this stuff might pick it up but</font>

1002
00:39:00,400 --> 00:39:06,520
we<font color="#CCCCCC"> haven't seen</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> I am a huge</font>

1003
00:39:04,560 --> 00:39:08,770
exclamation mark exclamation<font color="#E5E5E5"> mark</font>

1004
00:39:06,520 --> 00:39:11,890
exclamation<font color="#E5E5E5"> mark huge component</font><font color="#CCCCCC"> of</font>

1005
00:39:08,770 --> 00:39:14,650
<font color="#CCCCCC">whitelisting it's really hard to do</font>

1006
00:39:11,890 --> 00:39:16,299
<font color="#CCCCCC">though</font><font color="#E5E5E5"> on an end point if I say these</font>

1007
00:39:14,650 --> 00:39:17,950
are<font color="#CCCCCC"> the</font><font color="#E5E5E5"> only applications that you're</font>

1008
00:39:16,300 --> 00:39:20,950
allowed to<font color="#E5E5E5"> run and</font><font color="#CCCCCC"> everything else</font><font color="#E5E5E5"> is</font>

1009
00:39:17,950 --> 00:39:22,810
explicitly<font color="#E5E5E5"> denied that's tough to do but</font>

1010
00:39:20,950 --> 00:39:25,649
guess what those high<font color="#CCCCCC"> mission-critical</font>

1011
00:39:22,810 --> 00:39:28,570
<font color="#E5E5E5">environments do they do just this</font>

1012
00:39:25,650 --> 00:39:31,330
<font color="#E5E5E5">nuclear other</font>

1013
00:39:28,570 --> 00:39:32,950
some ICS<font color="#CCCCCC"> gaeta stuff</font><font color="#E5E5E5"> it is a pure</font>

1014
00:39:31,330 --> 00:39:34,810
<font color="#CCCCCC">whitelisting environment because the</font>

1015
00:39:32,950 --> 00:39:37,359
world it's<font color="#E5E5E5"> the risk and the reward</font>

1016
00:39:34,810 --> 00:39:41,230
<font color="#E5E5E5">factor is an easy equation spending the</font>

1017
00:39:37,360 --> 00:39:43,060
time to<font color="#CCCCCC"> create a</font><font color="#E5E5E5"> whitelist</font><font color="#CCCCCC"> is is worth</font>

1018
00:39:41,230 --> 00:39:45,070
it<font color="#CCCCCC"> alright</font>

1019
00:39:43,060 --> 00:39:46,779
again<font color="#CCCCCC"> whitelisting just as a side note</font>

1020
00:39:45,070 --> 00:39:49,630
<font color="#E5E5E5">when you think about just content</font>

1021
00:39:46,780 --> 00:39:51,310
filtering<font color="#CCCCCC"> one of the recommendations</font>

1022
00:39:49,630 --> 00:39:54,070
that we make to our customers and it's

1023
00:39:51,310 --> 00:39:55,509
hard<font color="#E5E5E5"> to do but see if you can't if</font>

1024
00:39:54,070 --> 00:39:57,100
you're<font color="#E5E5E5"> doing content filtering today</font>

1025
00:39:55,510 --> 00:39:58,600
from<font color="#E5E5E5"> an</font><font color="#CCCCCC"> internet perspective these are</font>

1026
00:39:57,100 --> 00:40:01,060
the sites are allowed to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> - these are</font>

1027
00:39:58,600 --> 00:40:03,310
the ones you're<font color="#CCCCCC"> not try to block on</font>

1028
00:40:01,060 --> 00:40:05,350
<font color="#CCCCCC">categorize sites</font><font color="#E5E5E5"> and again that's tough</font>

1029
00:40:03,310 --> 00:40:07,779
I know you're mad upheaval with your

1030
00:40:05,350 --> 00:40:10,420
users<font color="#E5E5E5"> but boy when we use our social</font>

1031
00:40:07,780 --> 00:40:12,910
engineering attacks<font color="#E5E5E5"> the domains that we</font>

1032
00:40:10,420 --> 00:40:14,440
<font color="#E5E5E5">stand up the the IPS</font><font color="#CCCCCC"> that we're</font><font color="#E5E5E5"> standing</font>

1033
00:40:12,910 --> 00:40:17,290
<font color="#E5E5E5">up there all uncatted Erised</font>

1034
00:40:14,440 --> 00:40:19,090
so by simply<font color="#CCCCCC"> making that that change and</font>

1035
00:40:17,290 --> 00:40:21,790
saying you<font color="#E5E5E5"> know what we're gonna block</font>

1036
00:40:19,090 --> 00:40:24,970
all sites that aren't categorized<font color="#E5E5E5"> it's a</font>

1037
00:40:21,790 --> 00:40:25,210
really strong defense mechanism<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> all</font>

1038
00:40:24,970 --> 00:40:27,609
right

1039
00:40:25,210 --> 00:40:29,970
and then monitoring monitoring for

1040
00:40:27,610 --> 00:40:33,640
unexpected creation of services

1041
00:40:29,970 --> 00:40:36,100
<font color="#E5E5E5">tunneling traffic user privileges on a</font>

1042
00:40:33,640 --> 00:40:38,109
show<font color="#E5E5E5"> of hands I'm just curious</font><font color="#CCCCCC"> who here</font>

1043
00:40:36,100 --> 00:40:41,290
today monitors<font color="#CCCCCC"> who's being added to</font><font color="#E5E5E5"> the</font>

1044
00:40:38,110 --> 00:40:43,630
domain<font color="#E5E5E5"> admin</font><font color="#CCCCCC"> group</font><font color="#E5E5E5"> you get an alert cool</font>

1045
00:40:41,290 --> 00:40:45,820
<font color="#E5E5E5">not bad</font><font color="#CCCCCC"> I like that not bad</font>

1046
00:40:43,630 --> 00:40:47,890
more of you should<font color="#E5E5E5"> be doing it it is</font><font color="#CCCCCC"> a</font>

1047
00:40:45,820 --> 00:40:49,600
number one thing I<font color="#E5E5E5"> mean what we do is we</font>

1048
00:40:47,890 --> 00:40:50,890
<font color="#CCCCCC">usually drop in our own</font><font color="#E5E5E5"> back door we'll</font>

1049
00:40:49,600 --> 00:40:53,470
name it<font color="#CCCCCC"> the name</font><font color="#E5E5E5"> of our company or</font>

1050
00:40:50,890 --> 00:40:55,810
something<font color="#E5E5E5"> funny</font><font color="#CCCCCC"> and then we're</font><font color="#E5E5E5"> at a</font>

1051
00:40:53,470 --> 00:40:58,299
company<font color="#CCCCCC"> of four or</font><font color="#E5E5E5"> five months ago guy</font>

1052
00:40:55,810 --> 00:41:01,360
runs and he's like I saw you I saw<font color="#E5E5E5"> you I</font>

1053
00:40:58,300 --> 00:41:02,170
saw<font color="#E5E5E5"> you but great that's awesome</font><font color="#CCCCCC"> we're</font>

1054
00:41:01,360 --> 00:41:04,540
going to talk a little bit<font color="#CCCCCC"> about</font>

1055
00:41:02,170 --> 00:41:06,520
creation of services and<font color="#E5E5E5"> how to monitor</font>

1056
00:41:04,540 --> 00:41:09,250
for<font color="#CCCCCC"> spawned services</font><font color="#E5E5E5"> things that some of</font>

1057
00:41:06,520 --> 00:41:10,780
these attack vectors<font color="#E5E5E5"> leverage but you</font>

1058
00:41:09,250 --> 00:41:12,760
know it's getting<font color="#E5E5E5"> hard out there folks</font>

1059
00:41:10,780 --> 00:41:14,470
getting harder<font color="#E5E5E5"> from an</font><font color="#CCCCCC"> injection</font>

1060
00:41:12,760 --> 00:41:17,320
perspective<font color="#E5E5E5"> but there are certainly some</font>

1061
00:41:14,470 --> 00:41:20,410
<font color="#CCCCCC">things that we can do to law to identify</font>

1062
00:41:17,320 --> 00:41:24,010
this<font color="#E5E5E5"> stuff all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so kind of rounding</font>

1063
00:41:20,410 --> 00:41:26,080
<font color="#E5E5E5">things out here Hail Mary all right so</font>

1064
00:41:24,010 --> 00:41:27,790
at this stage it's a very rare situation

1065
00:41:26,080 --> 00:41:29,920
that we haven't got what we needed to

1066
00:41:27,790 --> 00:41:31,840
<font color="#E5E5E5">get but there are those</font><font color="#CCCCCC"> situations when</font>

1067
00:41:29,920 --> 00:41:33,250
we encounter a client or<font color="#CCCCCC"> two some of</font>

1068
00:41:31,840 --> 00:41:35,110
<font color="#CCCCCC">them are in the room that</font><font color="#E5E5E5"> have super</font>

1069
00:41:33,250 --> 00:41:38,590
lockdown environments<font color="#E5E5E5"> that we are</font>

1070
00:41:35,110 --> 00:41:40,600
challenged<font color="#E5E5E5"> with in doing what we do</font>

1071
00:41:38,590 --> 00:41:41,950
so we reserved this<font color="#E5E5E5"> Hail Mary that I</font>

1072
00:41:40,600 --> 00:41:44,110
can't remember kind<font color="#E5E5E5"> of the last time you</font>

1073
00:41:41,950 --> 00:41:47,649
had to<font color="#E5E5E5"> use Hail Mary but there is a Hail</font>

1074
00:41:44,110 --> 00:41:49,360
Mary component on github there is a

1075
00:41:47,650 --> 00:41:52,270
Metasploit module that<font color="#E5E5E5"> you can download</font>

1076
00:41:49,360 --> 00:41:53,530
called PS<font color="#CCCCCC"> exec scanner and when you</font>

1077
00:41:52,270 --> 00:41:55,120
combine<font color="#CCCCCC"> it with some of the</font>

1078
00:41:53,530 --> 00:41:58,030
methodologies<font color="#CCCCCC"> that we've told you here</font>

1079
00:41:55,120 --> 00:42:01,330
today like creating a shelter executable

1080
00:41:58,030 --> 00:42:03,880
<font color="#E5E5E5">and using it as your as your process</font>

1081
00:42:01,330 --> 00:42:06,569
that you<font color="#CCCCCC"> launch</font><font color="#E5E5E5"> within PS exec you can</font>

1082
00:42:03,880 --> 00:42:11,620
use<font color="#E5E5E5"> this PS exact scanner to run a</font>

1083
00:42:06,570 --> 00:42:14,260
<font color="#E5E5E5">massive wide check of any systems that</font>

1084
00:42:11,620 --> 00:42:16,720
allow you<font color="#E5E5E5"> to upload the actual PS</font>

1085
00:42:14,260 --> 00:42:18,040
executive a and gain your<font color="#E5E5E5"> shell</font><font color="#CCCCCC"> and</font>

1086
00:42:16,720 --> 00:42:19,419
that's<font color="#CCCCCC"> really good for areas where a</font>

1087
00:42:18,040 --> 00:42:22,570
<font color="#E5E5E5">customer comes in and</font><font color="#CCCCCC"> says we've got</font>

1088
00:42:19,420 --> 00:42:24,700
<font color="#E5E5E5">antivirus and EDR and a DPL running</font>

1089
00:42:22,570 --> 00:42:25,300
everywhere and then we run these tools

1090
00:42:24,700 --> 00:42:27,040
and we're like<font color="#E5E5E5"> oh</font>

1091
00:42:25,300 --> 00:42:29,290
<font color="#CCCCCC">boom-boom-boom-boom-boom</font><font color="#E5E5E5"> here's three</font>

1092
00:42:27,040 --> 00:42:31,570
machines<font color="#E5E5E5"> that don't have</font><font color="#CCCCCC"> antivirus that</font>

1093
00:42:29,290 --> 00:42:33,430
<font color="#CCCCCC">we logged into as a result of PS exact</font>

1094
00:42:31,570 --> 00:42:35,860
scanner then we impersonated tokens and

1095
00:42:33,430 --> 00:42:37,529
boom<font color="#E5E5E5"> BAM done so PS exact scanner is a</font>

1096
00:42:35,860 --> 00:42:40,570
good one

1097
00:42:37,530 --> 00:42:43,570
refined<font color="#E5E5E5"> multi relay okay so who here has</font>

1098
00:42:40,570 --> 00:42:45,910
heard of responder<font color="#CCCCCC"> alright good it's an</font>

1099
00:42:43,570 --> 00:42:49,450
<font color="#CCCCCC">SMB really attack utility it is the cat</font>

1100
00:42:45,910 --> 00:42:51,190
<font color="#E5E5E5">meow</font><font color="#CCCCCC"> if you haven't</font><font color="#E5E5E5"> heard of responder</font>

1101
00:42:49,450 --> 00:42:53,319
know that it's like then it's the way

1102
00:42:51,190 --> 00:42:55,150
that we<font color="#CCCCCC"> compromise</font><font color="#E5E5E5"> 90% of the</font>

1103
00:42:53,320 --> 00:42:59,920
environments that we<font color="#E5E5E5"> walk into within</font>

1104
00:42:55,150 --> 00:43:02,520
minutes<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right and SMB signing for</font>

1105
00:42:59,920 --> 00:43:05,590
the win<font color="#CCCCCC"> ok it's all</font><font color="#E5E5E5"> I'm saying</font><font color="#CCCCCC"> all right</font>

1106
00:43:02,520 --> 00:43:07,690
so we'll use multi relay in a way to

1107
00:43:05,590 --> 00:43:10,480
target<font color="#E5E5E5"> specific machines Multi relay is</font>

1108
00:43:07,690 --> 00:43:12,400
an extension of responder<font color="#E5E5E5"> and allows</font><font color="#CCCCCC"> us</font>

1109
00:43:10,480 --> 00:43:15,370
<font color="#E5E5E5">to pick some specific machines that</font>

1110
00:43:12,400 --> 00:43:18,760
might have SMB signing disabled<font color="#E5E5E5"> and if</font>

1111
00:43:15,370 --> 00:43:20,290
it does we run<font color="#E5E5E5"> mimic</font><font color="#CCCCCC"> acts we run a few</font>

1112
00:43:18,760 --> 00:43:22,540
other<font color="#E5E5E5"> things that are really automate</font>

1113
00:43:20,290 --> 00:43:24,520
<font color="#CCCCCC">'add</font><font color="#E5E5E5"> that allow us</font><font color="#CCCCCC"> to get the the tools</font>

1114
00:43:22,540 --> 00:43:26,650
but this<font color="#E5E5E5"> is really noisy</font><font color="#CCCCCC"> sometimes and</font>

1115
00:43:24,520 --> 00:43:29,020
produces<font color="#E5E5E5"> some alerts and then we'll run</font>

1116
00:43:26,650 --> 00:43:33,010
responder with all the<font color="#E5E5E5"> options all right</font>

1117
00:43:29,020 --> 00:43:34,870
ICMP redirect the rogue DHCP<font color="#E5E5E5"> the</font><font color="#CCCCCC"> NetBIOS</font>

1118
00:43:33,010 --> 00:43:36,520
domain suffixes which<font color="#E5E5E5"> are definitely</font>

1119
00:43:34,870 --> 00:43:38,109
guaranteed to cause some<font color="#CCCCCC"> issues in the</font>

1120
00:43:36,520 --> 00:43:39,700
environment

1121
00:43:38,110 --> 00:43:41,710
<font color="#E5E5E5">we'll use the for stub new pad</font>

1122
00:43:39,700 --> 00:43:43,509
authentication attacks where if you run

1123
00:43:41,710 --> 00:43:45,460
this tool some of your targets might get

1124
00:43:43,510 --> 00:43:46,780
a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> pop-up most of</font><font color="#E5E5E5"> those people</font>

1125
00:43:45,460 --> 00:43:49,000
just click in their credentials you know

1126
00:43:46,780 --> 00:43:50,080
anybody sees a Windows networking<font color="#E5E5E5"> pop-up</font>

1127
00:43:49,000 --> 00:43:52,180
<font color="#E5E5E5">that means I must</font>

1128
00:43:50,080 --> 00:43:54,430
my<font color="#E5E5E5"> credentials so that's what they do</font>

1129
00:43:52,180 --> 00:43:56,649
<font color="#CCCCCC">and</font><font color="#E5E5E5"> we've developed some custom scripts</font>

1130
00:43:54,430 --> 00:43:58,029
and tools that<font color="#E5E5E5"> are outside the scope of</font>

1131
00:43:56,650 --> 00:43:59,830
this<font color="#E5E5E5"> conversation because those are</font>

1132
00:43:58,030 --> 00:44:02,230
considered our intellectual property<font color="#CCCCCC"> and</font>

1133
00:43:59,830 --> 00:44:04,230
we don't talk<font color="#E5E5E5"> about those too much</font><font color="#CCCCCC"> and</font>

1134
00:44:02,230 --> 00:44:07,390
then also in worst case situation

1135
00:44:04,230 --> 00:44:09,370
situations we will<font color="#E5E5E5"> will run full based</font>

1136
00:44:07,390 --> 00:44:10,150
art poisoning whenever we do art

1137
00:44:09,370 --> 00:44:11,620
poisoning

1138
00:44:10,150 --> 00:44:13,150
we're generally doing<font color="#E5E5E5"> that in a very</font>

1139
00:44:11,620 --> 00:44:16,270
limited perspective due to the

1140
00:44:13,150 --> 00:44:17,650
intrusiveness<font color="#CCCCCC"> of art poisoning but if</font>

1141
00:44:16,270 --> 00:44:19,990
all else<font color="#CCCCCC"> fails we're</font><font color="#E5E5E5"> talked to our</font>

1142
00:44:17,650 --> 00:44:21,820
customer<font color="#CCCCCC"> rule say we want to snag</font>

1143
00:44:19,990 --> 00:44:23,500
everything on<font color="#E5E5E5"> this subnet</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> in our</font>

1144
00:44:21,820 --> 00:44:26,470
<font color="#E5E5E5">poison perspective not</font><font color="#CCCCCC"> just these few</font>

1145
00:44:23,500 --> 00:44:30,550
selected hosts<font color="#CCCCCC"> is that</font><font color="#E5E5E5"> okay the answer</font>

1146
00:44:26,470 --> 00:44:34,480
is usually no so that's<font color="#CCCCCC"> the Hail Mary</font>

1147
00:44:30,550 --> 00:44:36,430
component<font color="#E5E5E5"> all right so from a summary</font>

1148
00:44:34,480 --> 00:44:38,290
perspective there are<font color="#CCCCCC"> a ton of different</font>

1149
00:44:36,430 --> 00:44:40,149
<font color="#E5E5E5">attack vectors that some of you may not</font>

1150
00:44:38,290 --> 00:44:42,580
even<font color="#CCCCCC"> heard about</font><font color="#E5E5E5"> today that you may not</font>

1151
00:44:40,150 --> 00:44:45,490
<font color="#E5E5E5">even be</font><font color="#CCCCCC"> aware that this</font><font color="#E5E5E5"> is this is the</font>

1152
00:44:42,580 --> 00:44:47,080
way that the good<font color="#E5E5E5"> guys are breaking in</font>

1153
00:44:45,490 --> 00:44:49,299
<font color="#CCCCCC">your environment</font><font color="#E5E5E5"> like our red team</font><font color="#CCCCCC"> and</font>

1154
00:44:47,080 --> 00:44:52,360
the<font color="#E5E5E5"> bad guys are</font><font color="#CCCCCC"> - when you talk about</font>

1155
00:44:49,300 --> 00:44:54,250
attacks from<font color="#CCCCCC"> rose nation state actors</font>

1156
00:44:52,360 --> 00:44:55,870
<font color="#E5E5E5">when you talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> all these advanced</font>

1157
00:44:54,250 --> 00:44:58,090
sophisticated<font color="#E5E5E5"> ways that</font><font color="#CCCCCC"> people are</font>

1158
00:44:55,870 --> 00:45:01,200
<font color="#CCCCCC">breaking into</font><font color="#E5E5E5"> networks these are some of</font>

1159
00:44:58,090 --> 00:45:03,670
<font color="#CCCCCC">the</font><font color="#E5E5E5"> ways that they're doing it okay and</font>

1160
00:45:01,200 --> 00:45:05,200
<font color="#E5E5E5">compromise</font><font color="#CCCCCC"> is inevitable in my opinion I</font>

1161
00:45:03,670 --> 00:45:07,090
think<font color="#E5E5E5"> you've all heard that by now</font><font color="#CCCCCC"> right</font>

1162
00:45:05,200 --> 00:45:08,169
the repetitive thing is you're going<font color="#E5E5E5"> to</font>

1163
00:45:07,090 --> 00:45:09,250
<font color="#E5E5E5">get breached you're going to get</font>

1164
00:45:08,170 --> 00:45:11,410
breached you're going to get breached

1165
00:45:09,250 --> 00:45:13,120
<font color="#CCCCCC">you just got to be able</font><font color="#E5E5E5"> to respond to it</font>

1166
00:45:11,410 --> 00:45:15,399
you got to be able<font color="#E5E5E5"> to detect it</font><font color="#CCCCCC"> so that</font>

1167
00:45:13,120 --> 00:45:17,620
you can do the right things<font color="#E5E5E5"> my advice to</font>

1168
00:45:15,400 --> 00:45:20,140
those of you in<font color="#CCCCCC"> the room today focus</font>

1169
00:45:17,620 --> 00:45:21,910
your efforts on services<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> look at</font>

1170
00:45:20,140 --> 00:45:25,299
those<font color="#E5E5E5"> those services</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> being</font>

1171
00:45:21,910 --> 00:45:26,890
spawned by different<font color="#CCCCCC"> processes</font><font color="#E5E5E5"> okay look</font>

1172
00:45:25,300 --> 00:45:28,990
at those privileges if you're not

1173
00:45:26,890 --> 00:45:31,509
triggering an alert whenever a<font color="#E5E5E5"> new</font>

1174
00:45:28,990 --> 00:45:33,520
domain admin gets added<font color="#E5E5E5"> you should be</font>

1175
00:45:31,510 --> 00:45:34,840
all right<font color="#E5E5E5"> that's that's Elementary</font><font color="#CCCCCC"> stop</font>

1176
00:45:33,520 --> 00:45:37,300
but there's other things you<font color="#E5E5E5"> can look</font>

1177
00:45:34,840 --> 00:45:39,820
for<font color="#E5E5E5"> within privileges</font><font color="#CCCCCC"> - there's ways</font>

1178
00:45:37,300 --> 00:45:41,860
that<font color="#CCCCCC"> you can detect</font><font color="#E5E5E5"> token impersonation</font>

1179
00:45:39,820 --> 00:45:44,380
<font color="#CCCCCC">if you see there's logs in Active</font>

1180
00:45:41,860 --> 00:45:46,180
Directory<font color="#CCCCCC"> or in a vent viewer where you</font>

1181
00:45:44,380 --> 00:45:47,860
can see<font color="#E5E5E5"> actual impersonation attempts</font>

1182
00:45:46,180 --> 00:45:49,629
because<font color="#E5E5E5"> the first time we impersonate</font>

1183
00:45:47,860 --> 00:45:51,640
sometimes it's not<font color="#E5E5E5"> always successful</font><font color="#CCCCCC"> and</font>

1184
00:45:49,630 --> 00:45:53,310
then tunneling<font color="#E5E5E5"> that's one of the hardest</font>

1185
00:45:51,640 --> 00:45:56,440
things to<font color="#E5E5E5"> look for data exfiltration</font>

1186
00:45:53,310 --> 00:45:59,200
<font color="#CCCCCC">tunneling capabilities it's hard but</font>

1187
00:45:56,440 --> 00:46:02,020
there's<font color="#E5E5E5"> there's possibilities there the</font>

1188
00:45:59,200 --> 00:46:03,240
last<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> I want to wrap up</font><font color="#E5E5E5"> with is I'm</font>

1189
00:46:02,020 --> 00:46:06,000
<font color="#E5E5E5">trying to</font>

1190
00:46:03,240 --> 00:46:08,580
<font color="#CCCCCC">who trying</font><font color="#E5E5E5"> to create a piece</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> software</font>

1191
00:46:06,000 --> 00:46:11,130
a script that operationalizes<font color="#E5E5E5"> all of</font>

1192
00:46:08,580 --> 00:46:13,410
this<font color="#E5E5E5"> so imagine if I could create a</font>

1193
00:46:11,130 --> 00:46:15,480
little<font color="#E5E5E5"> tool that</font><font color="#CCCCCC"> said give me your</font>

1194
00:46:13,410 --> 00:46:18,060
domain user give me your domain password

1195
00:46:15,480 --> 00:46:20,820
<font color="#CCCCCC">give me a local host</font><font color="#E5E5E5"> IP or I can drop my</font>

1196
00:46:18,060 --> 00:46:23,009
<font color="#CCCCCC">river shells onto a listener</font><font color="#E5E5E5"> push play</font>

1197
00:46:20,820 --> 00:46:25,140
<font color="#CCCCCC">and</font><font color="#E5E5E5"> it does</font><font color="#CCCCCC"> all these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> it's in the</font>

1198
00:46:23,010 --> 00:46:26,910
<font color="#E5E5E5">very early infant stages it's like alpha</font>

1199
00:46:25,140 --> 00:46:28,500
version but it's going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

1200
00:46:26,910 --> 00:46:30,330
scrape your sister all directory

1201
00:46:28,500 --> 00:46:31,500
automatically it's going to try to run

1202
00:46:30,330 --> 00:46:34,230
<font color="#E5E5E5">the</font><font color="#CCCCCC"> smv auxilary</font>

1203
00:46:31,500 --> 00:46:35,670
tool across the entire platform and drop

1204
00:46:34,230 --> 00:46:37,500
the shells<font color="#E5E5E5"> as needed</font>

1205
00:46:35,670 --> 00:46:40,290
Kerberos<font color="#E5E5E5"> SPN tickets all</font><font color="#CCCCCC"> this is</font>

1206
00:46:37,500 --> 00:46:50,850
scriptable<font color="#E5E5E5"> so stay tuned</font><font color="#CCCCCC"> for that that's</font>

1207
00:46:40,290 --> 00:47:04,550
what I'm working<font color="#CCCCCC"> on</font><font color="#E5E5E5"> that's it any</font>

1208
00:46:50,850 --> 00:47:13,170
questions right here yeah yeah and use

1209
00:47:04,550 --> 00:47:15,330
<font color="#E5E5E5">and users hate it right main reason</font>

1210
00:47:13,170 --> 00:47:18,750
<font color="#CCCCCC">primarily is when we when we flex our</font>

1211
00:47:15,330 --> 00:47:20,069
social engineering<font color="#E5E5E5"> campaigns if the</font>

1212
00:47:18,750 --> 00:47:21,720
first thing<font color="#E5E5E5"> we try to do is we try to</font>

1213
00:47:20,070 --> 00:47:23,820
spoof<font color="#CCCCCC"> your email domain so if you don't</font>

1214
00:47:21,720 --> 00:47:26,189
have SPF<font color="#CCCCCC"> setup and you</font><font color="#E5E5E5"> don't have</font><font color="#CCCCCC"> D mark</font>

1215
00:47:23,820 --> 00:47:28,890
D<font color="#E5E5E5"> Kim</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> we just send an email from</font>

1216
00:47:26,190 --> 00:47:30,270
you<font color="#E5E5E5"> know spoof</font><font color="#CCCCCC"> your domain</font><font color="#E5E5E5"> that's great</font>

1217
00:47:28,890 --> 00:47:32,730
but generally most<font color="#CCCCCC"> people are getting</font>

1218
00:47:30,270 --> 00:47:35,430
smart on that<font color="#CCCCCC"> so what we do then is</font>

1219
00:47:32,730 --> 00:47:39,510
purchase a<font color="#E5E5E5"> typo squatted domain so what</font>

1220
00:47:35,430 --> 00:47:44,368
that means is if<font color="#CCCCCC"> you're for comm I would</font>

1221
00:47:39,510 --> 00:47:46,380
purchase<font color="#E5E5E5"> f0r</font><font color="#CCCCCC"> d comm</font><font color="#E5E5E5"> and I'd use that to</font>

1222
00:47:44,369 --> 00:47:49,200
<font color="#E5E5E5">send out with the hopes of a user just</font>

1223
00:47:46,380 --> 00:47:51,420
<font color="#CCCCCC">quickly glancing over</font><font color="#E5E5E5"> that domain not</font>

1224
00:47:49,200 --> 00:47:53,399
noticing any better<font color="#E5E5E5"> and clicking on</font><font color="#CCCCCC"> our</font>

1225
00:47:51,420 --> 00:47:56,130
links assuming the email came from for

1226
00:47:53,400 --> 00:47:57,540
so f 0<font color="#E5E5E5"> Rd would come up with</font><font color="#CCCCCC"> a none</font>

1227
00:47:56,130 --> 00:47:59,760
<font color="#E5E5E5">categorize</font><font color="#CCCCCC"> web site</font>

1228
00:47:57,540 --> 00:48:01,380
we've also tricked<font color="#CCCCCC"> I'm not naming them</font>

1229
00:47:59,760 --> 00:48:04,890
any names but<font color="#E5E5E5"> we've also been able to</font>

1230
00:48:01,380 --> 00:48:07,140
get our malicious<font color="#E5E5E5"> website categorized in</font>

1231
00:48:04,890 --> 00:48:11,060
a legitimate<font color="#E5E5E5"> category just by</font><font color="#CCCCCC"> making a</font>

1232
00:48:07,140 --> 00:48:11,060
simple submission request so

1233
00:48:13,480 --> 00:48:23,230
correct<font color="#E5E5E5"> yep yep good good thanks again</font>

1234
00:48:21,019 --> 00:48:23,229
everybody

