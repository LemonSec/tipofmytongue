1
00:00:00,000 --> 00:00:04,200
well I've ever spoken to so whatever you
guys are taking whatever drugs awesome

2
00:00:04,200 --> 00:00:07,200
fantastic coffee whatever that is

3
00:00:08,309 --> 00:00:11,759
we can you guys give it up for converge
I mean really good job

4
00:00:11,759 --> 00:00:18,000
I mean good conference right you guys
having a good time

5
00:00:18,570 --> 00:00:23,490
excellent everyone stand up I'm sorry
you have to ever stand up

6
00:00:24,240 --> 00:00:28,139
ok one of the biggest problems I had
when I go to conferences is that a lot

7
00:00:28,140 --> 00:00:30,000
of people say that I'm trying to break
in

8
00:00:30,000 --> 00:00:33,809
and this is my first time here and I
don't know anyone so right now turn to

9
00:00:33,809 --> 00:00:35,760
somebody introduce yourself say hi

10
00:00:35,760 --> 00:00:38,760
you can either shit shake hands hugs or
punch the person

11
00:00:44,960 --> 00:00:48,469
all right that's enough sit down

12
00:00:51,579 --> 00:00:54,579
yeah

13
00:01:01,230 --> 00:01:02,680
yeah

14
00:01:02,680 --> 00:01:07,150
all right now all y'all that ate lunch
by yourself yesterday you don't have any

15
00:01:07,150 --> 00:01:10,150
excuses you have someone to go eat lunch
with today okay

16
00:01:12,250 --> 00:01:18,190
all right my name is Ben 10 I know 10 is
not my real last name it's just my real

17
00:01:18,190 --> 00:01:21,190
last name is difficult to pronounce so
10 is easier

18
00:01:21,940 --> 00:01:26,890
so I am a security senior security
consultant with trusted sec and I've

19
00:01:26,890 --> 00:01:30,369
actually been doing a technology and
everything for a long time I know I look

20
00:01:30,369 --> 00:01:32,770
really young and I sound really young

21
00:01:32,770 --> 00:01:36,820
you know I went with my son to a
conference one time and he introduced

22
00:01:36,820 --> 00:01:40,929
introduced himself he's like yeah you
know this is you know my I'm really into

23
00:01:40,930 --> 00:01:43,000
computers I'm a lot like my dad

24
00:01:43,000 --> 00:01:50,590
the big difference between me and my dad
is I'm supposed to be the short so i

25
00:01:50,590 --> 00:01:53,710
didn't have been doing development for
about 20 years I started when I was 12

26
00:01:53,710 --> 00:01:57,009
one of the first games I wrote was a 2d
side-scrolling game and it was really

27
00:01:57,009 --> 00:01:58,479
lit was a lot of fun

28
00:01:58,479 --> 00:02:03,369
I did when I was a junior in high school
and that you know the objective was just

29
00:02:03,369 --> 00:02:07,479
to see if i could do collision type of
tracking the bullets and destroying the

30
00:02:07,479 --> 00:02:12,670
little guys but my teammate and I we
thought it would be a lot more fun if we

31
00:02:12,670 --> 00:02:15,339
make the game a little bit more
interesting and so because we knew the

32
00:02:15,340 --> 00:02:18,340
professor was going to put this on his
computer and test it

33
00:02:18,340 --> 00:02:22,090
so what we did is we put code in there
that every time that you destroyed one

34
00:02:22,090 --> 00:02:22,989
of the bad guys

35
00:02:22,989 --> 00:02:28,720
it would randomly delete one of your
files so the log of the professor play

36
00:02:28,720 --> 00:02:34,989
his computers and this was back in like
98 97 when AV really wasn't there and so

37
00:02:34,989 --> 00:02:38,320
like it deleted boot that I and I auto
exact that bad

38
00:02:38,950 --> 00:02:41,950
so it we still got an a it was all good

39
00:02:42,489 --> 00:02:45,489
then I went into infrastructure for 13
years

40
00:02:46,060 --> 00:02:50,320
i also did blue team at that point i
doing a lot of defensive methodologies

41
00:02:50,320 --> 00:02:53,560
coming up with different ways to protect
and defend

42
00:02:53,560 --> 00:02:56,920
I eventually got all the way up to a
vice president

43
00:02:57,760 --> 00:03:01,720
I don't wish that on anyone I'm it's a
lot of responsibility

44
00:03:02,319 --> 00:03:05,738
I glad i'm not really doing any more and
then i decided i was going to make a

45
00:03:05,739 --> 00:03:06,909
change

46
00:03:06,909 --> 00:03:10,390
I was like either this is what i was
going to do for the rest of my life

47
00:03:10,390 --> 00:03:13,869
or I'm going to try something new so I
took a pay cut

48
00:03:13,870 --> 00:03:18,549
I took a you know and I was basically
writing my own ticket could do whatever

49
00:03:18,549 --> 00:03:19,720
I wanted

50
00:03:19,720 --> 00:03:22,870
but I'm like you know what I need to
learn something new and so i decided i

51
00:03:22,870 --> 00:03:25,299
was just going to move and I was going
to go to the offensive side because I

52
00:03:25,299 --> 00:03:28,629
figure I want to learn the different
aspect of this field

53
00:03:29,140 --> 00:03:34,149
so like hey I'm going to go and learn
pen testing so so that's kind of what

54
00:03:34,150 --> 00:03:37,840
we're talking about today one of the
people that a lot of what people know

55
00:03:37,840 --> 00:03:41,349
about me as i do powershell i'm
currently writing a book with no starch

56
00:03:41,349 --> 00:03:44,560
that's great help our show how to use
powershell for good and bad block

57
00:03:44,560 --> 00:03:48,790
basically walk you through all that I
used to be a Chicago resident so this is

58
00:03:48,790 --> 00:03:55,298
Chicago and summer at least that's the
way it feels for me I couldn't stand it

59
00:03:55,299 --> 00:04:00,700
anymore i was there for a long time so I
went up and so now I'm a dallas person

60
00:04:00,700 --> 00:04:05,108
I'm so it's a lot better there i was in
a t-shirt in the middle of you know

61
00:04:05,109 --> 00:04:08,739
on Christmas i know i said that to
somebody like yeah I did that too it was

62
00:04:08,739 --> 00:04:14,139
just that it was 34 below but it was
fine for me and then so now I get to

63
00:04:14,139 --> 00:04:17,560
travel around the world and this is
martin Boston me we were on our way to

64
00:04:17,560 --> 00:04:21,190
budapest hungary and this was the sky
lounge

65
00:04:21,849 --> 00:04:26,800
we did not do this but we took credit
for it but basically like this is there

66
00:04:26,800 --> 00:04:28,690
windows XP licensing thing

67
00:04:28,690 --> 00:04:31,719
so let me give you a little bit
background and security

68
00:04:34,330 --> 00:04:41,590
ok so i started in this industry and i
really wasn't doing security i was just

69
00:04:41,590 --> 00:04:42,938
doing infrastructure

70
00:04:42,939 --> 00:04:46,960
I was happy in my little world that was
doing development always good and then

71
00:04:46,960 --> 00:04:50,198
we had somebody break into our location

72
00:04:50,199 --> 00:04:53,409
physically broken still hard drives
everything like that now the nice thing

73
00:04:53,409 --> 00:04:59,438
was that I had already begun to do some
sort of a security and I put truecrypt

74
00:04:59,439 --> 00:05:00,250
on them

75
00:05:00,250 --> 00:05:04,539
so even though they walked away was it
wasn't that big of a deal but Jason

76
00:05:04,539 --> 00:05:08,050
Street said the best way to get somebody
excited about fire insurance is to burn

77
00:05:08,050 --> 00:05:09,639
down the building next door

78
00:05:09,639 --> 00:05:14,979
right because you see that you're like
that could be us

79
00:05:15,580 --> 00:05:20,620
well I realize that when they broke in I
realized hey this could have been a lot

80
00:05:20,620 --> 00:05:21,849
worse

81
00:05:21,849 --> 00:05:25,659
we could have had a data breach now i
need to understand some of this stuff so

82
00:05:25,659 --> 00:05:27,729
I'm like okay that's cool things are
burning

83
00:05:27,729 --> 00:05:30,849
but i'm cool like that's all right let's
go figure things out

84
00:05:31,479 --> 00:05:35,770
let's see what's going on so I was like
well let's go figure out this security

85
00:05:35,770 --> 00:05:40,120
stuff so i started going to cut
conventions in my first convention I'd

86
00:05:40,120 --> 00:05:43,000
ever go to I hadn't heard about b-sides
haven't heard anything

87
00:05:43,000 --> 00:05:47,740
this was a very first convention I'd
ever gone to and I knew nobody no one

88
00:05:47,740 --> 00:05:49,960
knew me I didn't know anything about
anything

89
00:05:49,960 --> 00:05:53,680
and so then I was like I don't need to
start learning things i would go to

90
00:05:53,680 --> 00:05:57,909
talks and you'd see these people do some
awesome and crazy things and like I have

91
00:05:57,909 --> 00:06:01,479
no idea what you just said you're really
really cute but I don't know what you're

92
00:06:01,479 --> 00:06:04,479
saying and then I would be like I got a
woman figure this out

93
00:06:05,020 --> 00:06:09,789
so then I learned about the defensive
stuff well Jason Street

94
00:06:09,789 --> 00:06:13,270
I picked him up from the airport in
chicago and on the way to be side

95
00:06:13,270 --> 00:06:16,810
chicago we were talking he's like why
are you presenting anything

96
00:06:17,349 --> 00:06:21,550
and like I really don't have anything to
share he's like that's bull you do have

97
00:06:21,550 --> 00:06:22,629
something to share

98
00:06:22,629 --> 00:06:25,719
you do something at your organization
that I have no idea about

99
00:06:26,289 --> 00:06:29,949
do you feel like you're even quasi
successfully and I'm like well yeah we

100
00:06:29,949 --> 00:06:34,180
I think so we're doing this New user
initiative that i started where we're

101
00:06:34,180 --> 00:06:37,300
training our users differently than what
most people are doing

102
00:06:37,300 --> 00:06:38,840
he's like well why don't you present on

103
00:06:38,840 --> 00:06:43,099
so I did and this is what it looked like
that first year

104
00:06:44,870 --> 00:06:50,960
oh lets you do I have sound well I might
have to just hold this - this whole .

105
00:06:50,960 --> 00:06:55,280
and then that but I don't have it hooked
up hold on a second

106
00:06:55,820 --> 00:07:04,460
I'll hold this down here ok so let's
take let's take over here because that

107
00:07:04,460 --> 00:07:08,510
when you do something so I i dunno lobby

108
00:07:08,510 --> 00:07:11,300
but let's just really get a sense let's
just pretend that you and I don't know

109
00:07:11,300 --> 00:07:12,020
each other

110
00:07:12,020 --> 00:07:16,820
ok hi nice to meet you I i'm going to be
talking to you about a new security

111
00:07:16,820 --> 00:07:20,540
procedures that I want you to do now the
thing about it is is you have to do it

112
00:07:20,540 --> 00:07:22,820
right now are picking out of my talk

113
00:07:22,820 --> 00:07:27,500
ok so now most people would be like
alright i'm leaving because I don't know

114
00:07:27,500 --> 00:07:28,550
who you are

115
00:07:28,550 --> 00:07:33,020
not only did i do choose him but he
actually wore the same shirt that I did

116
00:07:33,020 --> 00:07:37,520
that we're so this looks totally set up
so I'm like thanks for wearing the same

117
00:07:37,520 --> 00:07:39,320
shirt did

118
00:07:39,320 --> 00:07:43,219
if you don't if you didn't know me
though what would probably your first

119
00:07:43,220 --> 00:07:44,900
response

120
00:07:44,900 --> 00:07:48,229
you have to do this right now in front
of all these people right now i'm

121
00:07:48,229 --> 00:07:52,250
picking out of my talk this is my first
talk and nobody in the infosec industry

122
00:07:52,250 --> 00:07:56,120
what would probably your response and he
still didn't like he wasn't catching on

123
00:07:56,120 --> 00:07:59,150
that I wanted to say I just leave

124
00:07:59,150 --> 00:08:03,289
he's like I'll do whatever I can like
our most people would price

125
00:08:03,289 --> 00:08:07,370
most people are probably just say that
see you later who are you

126
00:08:07,370 --> 00:08:11,900
you're Ben 10 who cares now let's try
this

127
00:08:12,979 --> 00:08:17,240
let's see if this works a little bit
better ok so i want to do an example for

128
00:08:17,240 --> 00:08:18,919
my talk here

129
00:08:18,919 --> 00:08:22,130
and to do that I want you to do
something with me now I this is a

130
00:08:22,130 --> 00:08:22,729
security

131
00:08:22,729 --> 00:08:26,389
this is a new security thing and I want
to be done and I know it's gonna be a

132
00:08:26,389 --> 00:08:28,880
little different for you but however if
you do it with me

133
00:08:28,880 --> 00:08:33,740
hold on i'll give you fifty dollars

134
00:08:34,419 --> 00:08:37,838
I did this talk like six times and my
wife told me I couldn't do it anymore

135
00:08:37,839 --> 00:08:40,120
because it's so expensive

136
00:08:40,120 --> 00:08:44,920
ok so there's fifty dollars alright so
here we go

137
00:08:45,459 --> 00:08:51,339
this is the new security model you know
everyone can be working on now

138
00:08:51,339 --> 00:08:54,370
just also to frame this there's two
other talks going on at the same time

139
00:08:54,370 --> 00:08:57,370
and make sure my volume was as long as
possible

140
00:08:59,320 --> 00:09:02,320
one common stock

141
00:09:17,200 --> 00:09:20,200
yeah

142
00:09:25,710 --> 00:09:38,790
I get Christmas again here yet so hear
me yeah so that was fun and it was

143
00:09:38,790 --> 00:09:42,000
exciting and a lot of people a lot of
people saw what I had to say and like

144
00:09:42,000 --> 00:09:43,380
that's amazing

145
00:09:43,380 --> 00:09:48,030
that's a really cool idea I had never
thought about maybe incentivizing my

146
00:09:48,030 --> 00:09:51,720
security awareness programs instead of
it always being about penalizing the

147
00:09:51,720 --> 00:09:53,430
person when they do something wrong

148
00:09:53,430 --> 00:09:56,910
i'm actually going to try to incentivize
when you do something right

149
00:09:56,910 --> 00:10:01,350
it's amazing it and I realized that
because when I have with my kids

150
00:10:01,350 --> 00:10:05,220
I find out that i actually get them to
do what I want them to do when it's an

151
00:10:05,220 --> 00:10:07,680
incentive first base it off of

152
00:10:07,680 --> 00:10:12,359
I'm going to punish you if you don't and
it changed it revolutionized our

153
00:10:12,360 --> 00:10:15,780
organization and that people were
actually excited about the security

154
00:10:15,780 --> 00:10:20,310
program they actually wanted to be a
part of it and it was a cool competition

155
00:10:20,310 --> 00:10:25,140
and I share this with everyone and
that's part of what came into it

156
00:10:25,140 --> 00:10:28,080
well then i decided i was going to do a
little bit more and kind of look at the

157
00:10:28,080 --> 00:10:31,710
vulnerability management side and and
figure out how I could do like a self

158
00:10:31,710 --> 00:10:33,150
assessment on myself

159
00:10:33,150 --> 00:10:36,420
internal red team of one I guess you
could say was even a red team it was

160
00:10:36,420 --> 00:10:40,110
just more vulnerability management
identifying it up my wife is not too

161
00:10:40,110 --> 00:10:43,110
happy with the top title

162
00:10:44,660 --> 00:10:52,459
but that was the idea and I had tried a
lot of different things i'm like yes I'm

163
00:10:52,459 --> 00:10:57,888
going to learn how to hack myself and I
actually did this is my first execution

164
00:10:57,889 --> 00:11:01,819
with metasploit not realizing that I
wasn't supposed to use the example of

165
00:11:01,819 --> 00:11:03,050
127 001

166
00:11:03,050 --> 00:11:06,740
but hey i got shell so it's good right

167
00:11:07,250 --> 00:11:11,000
but then I started decide I'm like why I
need to try different things so i tried

168
00:11:11,000 --> 00:11:15,560
a new tool that i downloaded from the
internet and I did it on pride in the

169
00:11:15,560 --> 00:11:16,790
middle of the day

170
00:11:16,790 --> 00:11:21,170
this happened if you know what this is

171
00:11:22,129 --> 00:11:27,740
this is a LS asss crashing and at such a
primary domain controller to about 30

172
00:11:27,740 --> 00:11:31,250
minutes to come back up the CEO calls
from lunch because she's out with a

173
00:11:31,250 --> 00:11:34,189
client she's like hey we're getting a
bunch of issues of their like no no it's

174
00:11:34,189 --> 00:11:34,610
fine

175
00:11:34,610 --> 00:11:37,110
click

176
00:11:37,110 --> 00:11:44,970
and then it was at this point I realized
I I needed to try something else

177
00:11:45,630 --> 00:11:50,370
so i decided i would actually leave and
go on and do something else and so

178
00:11:50,370 --> 00:11:54,209
that's when I started going into
vulnerability management type stuff and

179
00:11:54,209 --> 00:11:58,229
this wasn't quite ready yet obviously
but we're still doing that to help but I

180
00:11:58,230 --> 00:12:00,360
was still trying to learn two different
things

181
00:12:00,360 --> 00:12:03,000
you know learning the different
vulnerability scanners trying to

182
00:12:03,000 --> 00:12:07,350
identify do patch management all that
other fun stuff and then and then I was

183
00:12:07,350 --> 00:12:10,320
like I need to expand a little bit more
so I started doing penetration testing

184
00:12:10,320 --> 00:12:15,209
and so because I'm so small i can fit
into suitcases and overhead compartments

185
00:12:15,209 --> 00:12:23,130
of airplanes when trust a sec books my
travel on always child in lap so I

186
00:12:23,130 --> 00:12:27,060
figured I'd start breaking in and the
cool thing about breaking in

187
00:12:27,060 --> 00:12:31,649
especially when you look young is that
people don't take you seriously you're

188
00:12:31,649 --> 00:12:36,180
like dude some someone just brought
their kids to work today or that kids

189
00:12:36,180 --> 00:12:38,130
lost or on the new intern

190
00:12:38,130 --> 00:12:42,689
so I broke into this organization they
had super tight security like revolving

191
00:12:42,690 --> 00:12:47,459
doors cards like you had your face
showed up on the screen when he came in

192
00:12:47,459 --> 00:12:51,839
but the executives they didn't want to
have to deal with that to their garage

193
00:12:51,839 --> 00:12:55,230
so the door would remain open for like
you know an hour or whatever

194
00:12:55,230 --> 00:12:59,130
well I drove right in sat in the garage
waiting for someone to go through and I

195
00:12:59,130 --> 00:13:00,000
walked right in

196
00:13:00,000 --> 00:13:04,050
so I go up in like on all the different
floors taking pictures in their data

197
00:13:04,050 --> 00:13:07,920
center and then I see a lunch like a
coffee area if I break into your place

198
00:13:07,920 --> 00:13:12,360
and you have coffee i'm getting free
coffee so I go over and I start born and

199
00:13:12,360 --> 00:13:15,870
people coming up there like oh are you
the new guy like yeah I'm still learning

200
00:13:15,870 --> 00:13:19,320
computers have really not sure what I
was doing and then one guy comes over

201
00:13:19,320 --> 00:13:22,709
he's like oh you're the new guy like
yeah yeah just starting you know i have

202
00:13:22,709 --> 00:13:24,989
orientation today is not good

203
00:13:24,990 --> 00:13:29,490
you know if you if you watch me and see
what's going on you're going to learn a

204
00:13:29,490 --> 00:13:32,670
lot of stuff you know really fire and
like all the man thanks so much i I'd I

205
00:13:32,670 --> 00:13:36,810
have a lot to learn he's like yeah no
race and they walked away we go to the

206
00:13:36,810 --> 00:13:40,619
recap meeting later on and we're in this
big conference room and I'm sitting

207
00:13:40,620 --> 00:13:44,010
there with my report saying you know I
just completely destroyed your security

208
00:13:44,010 --> 00:13:47,010
and the dude that walks in with the CTO

209
00:13:48,720 --> 00:13:51,720
oops

210
00:13:52,500 --> 00:13:56,760
so then you know so we're doing a lot of
this stuff so then I decided

211
00:13:57,510 --> 00:14:01,410
Dave kennedy from trust a sec he's like
hey we've got a position

212
00:14:01,410 --> 00:14:04,890
we really want you on the team I'm like
I'm not that amazing

213
00:14:04,890 --> 00:14:08,730
i'm still learning is like you have the
potential to do a lot of cool things you

214
00:14:08,730 --> 00:14:13,230
want to come over I'm like yeah sure so
so I moved over to trust a sec and so

215
00:14:13,230 --> 00:14:14,880
I've been there love it

216
00:14:14,880 --> 00:14:21,930
but what I've realized in all of my
engagements so far i have realized that

217
00:14:21,930 --> 00:14:26,729
a lot of organizations are doing the
exact same things on the defense side

218
00:14:26,730 --> 00:14:29,730
which is part of the reason a lot of
people are failing

219
00:14:31,770 --> 00:14:35,640
you see I i come up with these great
pretexts like I could go in as the

220
00:14:35,640 --> 00:14:41,490
intern going for a job interview or or i
can i can pretend on the copier guy or

221
00:14:41,490 --> 00:14:44,250
whatever the case may be but here's the
thing i haven't had to use those

222
00:14:44,250 --> 00:14:51,780
pretexts I walk in and maybe it's
because I'm so short I blend in I don't

223
00:14:51,780 --> 00:14:55,860
know what it is but I don't get stopped
and that's not going to say that's going

224
00:14:55,860 --> 00:14:59,010
to be for every place but that's in a
majority of the places I've gone too

225
00:14:59,670 --> 00:15:04,709
I walk right in I don't get stopped and
that's not even on the physical side on

226
00:15:04,710 --> 00:15:06,000
the computer side

227
00:15:06,000 --> 00:15:10,710
I'm still walking in electronically
super simple and we're not talking elite

228
00:15:10,710 --> 00:15:12,030
hack stuff here

229
00:15:12,030 --> 00:15:18,390
I'm not writing my own malware is this
simple stuff so i want to show you first

230
00:15:18,390 --> 00:15:19,890
what's wrong

231
00:15:19,890 --> 00:15:24,060
all right we got a look at some things
of what's wrong

232
00:15:24,060 --> 00:15:29,400
so a lot of times when you when you you
know you put a sim or you do need that

233
00:15:29,400 --> 00:15:32,520
type of stuff you open it up you get it
and it's kind of like this

234
00:15:34,510 --> 00:15:39,430
right you've got all of this data coming
in

235
00:15:39,970 --> 00:15:45,130
yay big data it's all over the place
right and then you're trying to figure

236
00:15:45,130 --> 00:15:47,410
out how you're going to handle it how
you gonna look at it

237
00:15:47,410 --> 00:15:50,770
part of the problem is you guys have so
much stuff in your environment and you

238
00:15:50,770 --> 00:15:54,340
try and get these silver bullet things
and you can't manage it

239
00:15:54,340 --> 00:15:58,960
so what ends up happening you ignore it
becomes shelf wear or you turn it off

240
00:15:58,960 --> 00:16:04,240
and you're like oh we've got this but we
don't use it

241
00:16:04,870 --> 00:16:15,550
another big issue everyone is using the
same password so LinkedIn reached 2012

242
00:16:15,550 --> 00:16:19,719
right that like three years or four
years ago now right

243
00:16:20,320 --> 00:16:25,510
we have the cracked version of just
about every single one of those lists

244
00:16:25,510 --> 00:16:30,850
and a lot of y'all used your work email
when you sign up for LinkedIn back then

245
00:16:30,850 --> 00:16:35,260
i guess the first thing i do an
engagement now I test all of those

246
00:16:35,260 --> 00:16:36,250
passwords

247
00:16:36,250 --> 00:16:43,120
we have gotten two to four of those that
are still active on just about every

248
00:16:43,120 --> 00:16:44,200
engagement

249
00:16:44,200 --> 00:16:48,850
if you are still using a password from
2012 that's a problem

250
00:16:49,600 --> 00:16:52,780
there are immense amount of lists out
there

251
00:16:53,410 --> 00:17:01,150
so if you think monkey 12 or a Detroit
16 or whatever you're using I certainly

252
00:17:01,150 --> 00:17:05,290
hope I'm not saying your password right
now but if you think that those are

253
00:17:05,290 --> 00:17:07,000
super elite they're not

254
00:17:07,000 --> 00:17:12,190
that's what I'm going to try i'm going
to try the going to try all of those

255
00:17:12,190 --> 00:17:16,810
passwords be why am I going to try and
brute for something when I've got a list

256
00:17:16,810 --> 00:17:17,859
of them

257
00:17:17,859 --> 00:17:21,458
I'd much rather just go through the list
the other thing

258
00:17:22,089 --> 00:17:29,230
default passwords brocade switches a lot
of your web services a lot of your

259
00:17:29,230 --> 00:17:31,300
Cisco's a lot of it at all

260
00:17:31,300 --> 00:17:35,020
they're still default passwords you know
one thing that we love attacking that in

261
00:17:35,020 --> 00:17:40,540
its a big Adrian friend's heart attack
are your MF PS your multifunction

262
00:17:40,540 --> 00:17:42,010
printers

263
00:17:42,010 --> 00:17:46,690
you know why we love FB so much because
you guys look those up to active

264
00:17:46,690 --> 00:17:50,230
directory so you hook them up to active
directory you give them their own

265
00:17:50,230 --> 00:17:51,220
account

266
00:17:51,220 --> 00:17:57,820
but you leave the administrator password
the same so we go in there and Emma peas

267
00:17:57,820 --> 00:18:04,210
are really nice they have this test
feature so we replace the IP with our IP

268
00:18:04,210 --> 00:18:06,070
and then we hit test

269
00:18:06,070 --> 00:18:09,939
guess what those MFPs do they send their
credentials in clear

270
00:18:10,450 --> 00:18:16,900
so now we have an Active Directory
account all because of an mfp because of

271
00:18:16,900 --> 00:18:24,040
a default password if you have default
passwords on any of your administrative

272
00:18:24,040 --> 00:18:29,350
tools you need to stop and turn that off
me get in this way more than we do any

273
00:18:29,350 --> 00:18:33,580
other way is because you guys left a
default password

274
00:18:33,580 --> 00:18:36,820
I would love to say we came up with some
awesome unique hack

275
00:18:36,820 --> 00:18:40,060
there's actually a new one that was just
released where you grab the printer

276
00:18:40,060 --> 00:18:40,899
driver

277
00:18:40,900 --> 00:18:46,450
you put your back shell into it real
upload it and then you set up a fake

278
00:18:46,450 --> 00:18:48,190
print server on the network

279
00:18:48,190 --> 00:18:51,580
well every user has the ability to add a
printer

280
00:18:51,580 --> 00:18:56,679
so you go into the add printer utility
and union use a little wizard

281
00:18:56,680 --> 00:19:01,780
well what you don't know is the wizard
spawns a second process that run the

282
00:19:01,780 --> 00:19:06,670
system so they can download the driver
will so when it's downloads my driver

283
00:19:06,670 --> 00:19:10,120
with my back door it's running as system

284
00:19:10,120 --> 00:19:15,399
so now i have a back door because we
just added a printer like cool eat hack

285
00:19:15,400 --> 00:19:20,710
but i'm using default passwords like
it's not even it's not even fun because

286
00:19:20,710 --> 00:19:22,990
i'm still using the same default
password

287
00:19:22,990 --> 00:19:27,400
the other problem is is that the
training that you guys are are very

288
00:19:27,400 --> 00:19:30,640
presenting to your users is not
effective

289
00:19:30,640 --> 00:19:34,870
I'm not staying in all situations but
most cases it's not effective because

290
00:19:34,870 --> 00:19:37,299
what's the first thing that someone does
when they click

291
00:19:37,299 --> 00:19:41,679
why did you click you're so stupid
stupid user

292
00:19:42,220 --> 00:19:46,509
I can't believe you click guess what
it's a business if you're using email

293
00:19:46,509 --> 00:19:49,809
guess what you have to open things

294
00:19:49,809 --> 00:19:53,200
that's the business that's the way the
business works

295
00:19:53,200 --> 00:19:57,249
the point isn't don't click at the point
is knowing what you're getting

296
00:19:57,249 --> 00:20:00,909
having that communication to the users
so they fully understand when you don't

297
00:20:00,909 --> 00:20:05,769
teach users well you get situations like
this because they get something that's

298
00:20:05,769 --> 00:20:14,080
super powerful that they don't know how
to use so it looks a lot like this and

299
00:20:14,080 --> 00:20:17,559
not once not never got the hammer

300
00:20:17,559 --> 00:20:26,080
ok so already you know I like a basic up

301
00:20:26,080 --> 00:20:34,389
ok so I'm how many people that have
operated a wet a use of fire

302
00:20:34,989 --> 00:20:43,690
ok how many of you are just ready for
the next part of the video interaction

303
00:20:43,690 --> 00:20:46,200
now now where is this finger

304
00:20:46,200 --> 00:20:49,200
where is his freakin finger

305
00:20:51,810 --> 00:21:03,360
no you wouldn't do this but because oh I
think you're off okay

306
00:21:03,360 --> 00:21:06,419
the dude talking about hi I can't hear

307
00:21:06,420 --> 00:21:09,660
that's his first reaction is I can't
hear

308
00:21:09,660 --> 00:21:13,170
not the fact that i just shot my friend

309
00:21:15,330 --> 00:21:21,030
so that's what ends up happening we give
people these awesome you till you tools

310
00:21:21,030 --> 00:21:24,120
and utilities and everything else like
that but we don't train them well enough

311
00:21:24,120 --> 00:21:27,899
to use them and then we get a set when
they don't use it well

312
00:21:28,500 --> 00:21:32,550
system admins

313
00:21:32,550 --> 00:21:38,970
let's just spin up a box just because we
get so many boxes that are sitting out

314
00:21:38,970 --> 00:21:40,530
there that y'all forgot about

315
00:21:40,530 --> 00:21:46,680
hey I'm dallas now i can say y'all you
guys forget about it

316
00:21:46,680 --> 00:21:50,730
you spun it up a lot of you guys asset
management is a nightmare

317
00:21:50,730 --> 00:21:55,560
you have no idea what's what and where
it is we love to find those boxes

318
00:21:55,560 --> 00:21:59,700
because they're typically unpatched
because you don't know about him

319
00:21:59,700 --> 00:22:03,090
developers any developers in the room

320
00:22:03,090 --> 00:22:06,540
ok then yell at you for a second

321
00:22:06,540 --> 00:22:09,930
I need local admin

322
00:22:09,930 --> 00:22:13,380
I can't do my job without it

323
00:22:13,380 --> 00:22:19,350
well guess what i have owned so many
developer boxes and you know the cool

324
00:22:19,350 --> 00:22:23,879
thing about a developer boxes they put
so much crap on their systems like they

325
00:22:23,880 --> 00:22:27,810
copy data they've got their own instance
of SQL server

326
00:22:27,810 --> 00:22:34,050
it is awesome i love developers because
i am i am one

327
00:22:34,050 --> 00:22:37,470
so y'all keep getting sysadmin that's
awesome because I'm gonna get your box

328
00:22:37,470 --> 00:22:43,350
and that's a problem if you need if you
need that level you should be segmented

329
00:22:43,350 --> 00:22:44,610
off the network

330
00:22:44,610 --> 00:22:47,969
that's the problem

331
00:22:47,970 --> 00:22:51,840
we're throwing things around out there
without realizing that hey this could

332
00:22:51,840 --> 00:22:53,580
potentially be a problem

333
00:22:53,580 --> 00:22:58,470
speaking of segmentation this is
typically your network topology diagram

334
00:22:58,470 --> 00:23:05,909
all flat all connected

335
00:23:05,909 --> 00:23:09,480
not only is this flat but you have all
of your devices on this like your cisco

336
00:23:09,480 --> 00:23:13,830
IP phones and your printers and
everything else like that you know

337
00:23:13,830 --> 00:23:16,379
you've got and then if you what we've
got neck

338
00:23:16,380 --> 00:23:20,880
well yeah but I just I just use a neat
little device me show it to you

339
00:23:21,480 --> 00:23:26,100
we've got this awesome neck

340
00:23:26,610 --> 00:23:32,340
well that's great but I just go over to
your cisco IP phone and I grab your I

341
00:23:32,340 --> 00:23:35,699
grabbed the pic the cable and I put a
land tap on it

342
00:23:36,270 --> 00:23:42,360
so that's all this is so little and tap
and what this does is it allows me to to

343
00:23:42,360 --> 00:23:47,610
ride that cisco I people a the rj45 i
just tried that so

344
00:23:47,610 --> 00:23:52,289
mac address everything it it just rides
as the IP phone and this is something

345
00:23:52,289 --> 00:23:57,120
that anyone can get any I built this
myself my son's built one of these super

346
00:23:57,120 --> 00:23:58,049
simple

347
00:23:58,049 --> 00:24:04,260
it's called throwing star land tap so a
lot of people implement you know network

348
00:24:04,260 --> 00:24:06,570
access control incorrectly anyways

349
00:24:06,570 --> 00:24:10,590
a lot of times you only need the first
six parts of the mac address and it will

350
00:24:10,590 --> 00:24:15,959
let you on right because I just need to
look like that device and then that's

351
00:24:15,960 --> 00:24:18,539
really going to screw up especially if
i'm changing my hostname and everything

352
00:24:18,539 --> 00:24:22,919
to that cisco IP phone your I mean how
many guys are monitoring what your

353
00:24:22,919 --> 00:24:25,890
phones are doing the fact that there are
now all of a sudden the dressing over

354
00:24:25,890 --> 00:24:32,159
HTTP or that your cisco IP phone is
connected over SMB that could be a

355
00:24:32,159 --> 00:24:35,400
problem folks but how many guys are
looking at that because you guys are

356
00:24:35,400 --> 00:24:36,330
super flat

357
00:24:36,330 --> 00:24:39,750
you're not seeing it the other problem
is that we're not learning

358
00:24:40,500 --> 00:24:46,830
we're not learning from people and past
mistakes we see the fact that the

359
00:24:46,830 --> 00:24:49,199
building burned down across the street

360
00:24:49,200 --> 00:24:53,400
but we're not doing anything to change
our behavior its security by obscurity

361
00:24:54,659 --> 00:25:00,419
well no one knows about us or uh or the
one I really like his security by

362
00:25:00,419 --> 00:25:01,409
divinity

363
00:25:01,409 --> 00:25:04,860
we don't know what we're doing but we're
just praying and hoping to some de that

364
00:25:04,860 --> 00:25:06,330
it does nothing bad happens

365
00:25:06,330 --> 00:25:11,139
we've actually I'm actually talk to
clients that said

366
00:25:11,140 --> 00:25:15,430
my Incident Response program is to take
one percent of all of our profits and

367
00:25:15,430 --> 00:25:18,550
put it in a savings account for when
that happens

368
00:25:18,550 --> 00:25:27,730
that's my security model we're just
going to pay for when it does we we see

369
00:25:27,730 --> 00:25:29,800
the ideas of what's wrong

370
00:25:29,800 --> 00:25:33,310
right and i think a lot of you guys can
empathize with this i think you see a

371
00:25:33,310 --> 00:25:36,250
lot of the stuff in your own
organizations and a lot of you know that

372
00:25:36,250 --> 00:25:39,370
it's wrong but it's frustrating because
you can't get things to change

373
00:25:39,370 --> 00:25:43,510
so let me tell you a little bit about
the attacker mentality

374
00:25:43,510 --> 00:25:48,430
ok because there are some things that
you can do on the defensive side to

375
00:25:48,430 --> 00:25:49,930
catch me

376
00:25:49,930 --> 00:25:54,880
so the first thing is I don't like
resistance

377
00:25:54,880 --> 00:25:58,090
I want to take the path of least
resistance

378
00:25:58,090 --> 00:26:01,120
I don't like to have to work hard

379
00:26:01,120 --> 00:26:06,189
okay i want to be able to come in
destroy you and then you know go outside

380
00:26:06,190 --> 00:26:07,990
and play or do whatever the case may be

381
00:26:07,990 --> 00:26:11,470
I'm lazy

382
00:26:11,470 --> 00:26:14,980
okay i want something easy

383
00:26:15,880 --> 00:26:22,660
so when i do this from your standpoint
when you try and deflect me it

384
00:26:22,660 --> 00:26:27,280
that only works so well the thing about
it is is that defense is more about

385
00:26:27,280 --> 00:26:29,379
detection and deflection

386
00:26:29,380 --> 00:26:37,690
you're not going to be able to deflect
everything there is a new attack every

387
00:26:37,690 --> 00:26:38,950
week

388
00:26:38,950 --> 00:26:43,630
patch tuesday I mean the anyone think
patch tuesday is ever going to go away

389
00:26:44,470 --> 00:26:48,700
anyone ready for next month past Tuesday
are you all ready ready for it

390
00:26:48,700 --> 00:26:53,560
no because you don't know what's coming
out there's always going to be something

391
00:26:53,560 --> 00:26:55,720
new there's always going to be a new
attack

392
00:26:55,720 --> 00:26:59,320
there's always going to be a new way and
i'll tell you a lot of the old attacks

393
00:26:59,320 --> 00:27:01,419
are working still

394
00:27:01,420 --> 00:27:05,950
because everyone's focusing on the new
glitzy and shiny stuff that bat to exe

395
00:27:05,950 --> 00:27:12,550
is still amazing i'm still replacing
service binaries like it's old school

396
00:27:12,550 --> 00:27:13,510
stuff

397
00:27:13,510 --> 00:27:20,150
it's about the detection piece if you
really want to understand how to

398
00:27:20,150 --> 00:27:24,080
get a better handle on when someone's
got an indicator of compromise on your

399
00:27:24,080 --> 00:27:28,699
network you need to make sure you've got
that detection peace without it

400
00:27:28,700 --> 00:27:33,710
you have no hope so how do we do this
how do we set up a path of least

401
00:27:33,710 --> 00:27:34,940
resistance

402
00:27:34,940 --> 00:27:43,460
well one of the big things is logs right
love logs but if anyone's ever done a

403
00:27:43,460 --> 00:27:45,410
type of log management whatever the case
may be

404
00:27:45,410 --> 00:27:50,960
it's like a drinking from a fire hose
right well one of the big hotness is

405
00:27:50,960 --> 00:27:52,100
power show right

406
00:27:52,100 --> 00:27:55,399
a lot of our texts power show us
directly in memory whatever the case may

407
00:27:55,400 --> 00:27:56,000
be

408
00:27:56,000 --> 00:28:02,900
Lee Holmes wrote this blog I was like a
year ago yet 2005 or 2015

409
00:28:02,900 --> 00:28:06,050
he wrote this blog anyone read it

410
00:28:06,050 --> 00:28:11,750
ok so how she'll love the blue team

411
00:28:11,750 --> 00:28:16,850
write this down you need to go and read
this article if you want if you take

412
00:28:16,850 --> 00:28:21,139
nothing from this talk and you have a
Windows environment you need to take

413
00:28:21,140 --> 00:28:21,920
this

414
00:28:21,920 --> 00:28:29,720
this will walk you through step by step
on how to set up your environment so

415
00:28:29,720 --> 00:28:36,680
that you can detect these types of
attacks is an amazing blog and in fact

416
00:28:36,680 --> 00:28:40,670
Lee Holmes was so concerned about this
blog that he gave it to Matt greater

417
00:28:40,670 --> 00:28:44,270
that do that real power supply would he
gave it to wil schroter that do that

418
00:28:44,270 --> 00:28:45,800
wrote powershell Empire

419
00:28:45,800 --> 00:28:51,860
he gave it to matt johnson and to me we
had access to this before it was posted

420
00:28:51,860 --> 00:28:56,240
to the public and we gave our feedback
on whether it was legitimate

421
00:28:56,240 --> 00:29:02,270
I was at a Microsoft night conference
last year and i was on the phone with

422
00:29:02,270 --> 00:29:07,070
Lee discussing this very thing that's
how concerned he was about this

423
00:29:07,070 --> 00:29:11,210
this is an amazing article it's been out
there for a year and I've been to many

424
00:29:11,210 --> 00:29:14,420
conferences and people still have not
heard about this

425
00:29:15,770 --> 00:29:22,160
now here's the thing you don't want to
do this on all 40,000 of your assets

426
00:29:22,160 --> 00:29:26,150
it's going to be a nightmare it's gonna
be tough to catch but you want to set it

427
00:29:26,150 --> 00:29:27,950
up on your critical assets first

428
00:29:27,950 --> 00:29:30,119
a lot of people when they're trying to
do this or like

429
00:29:30,119 --> 00:29:33,629
I don't know how we're going to do this
with 40,000 assets well don't do it with

430
00:29:33,629 --> 00:29:39,418
your 1000 critical assets do it with the
critical infrastructure start somewhere

431
00:29:40,049 --> 00:29:43,199
eventually your maturity model get to
the point where you can expand it but

432
00:29:43,199 --> 00:29:47,189
for now let's focus on the critical
stuff your servers your endpoints your

433
00:29:47,189 --> 00:29:52,319
developers that's critical stop man that
the areas where you have the highest

434
00:29:52,319 --> 00:29:53,158
risk

435
00:29:53,159 --> 00:29:58,889
that's where this needs to go expect
your deflective controls to feel that

436
00:29:58,889 --> 00:30:02,579
doesn't mean that the reflective
controls are bad I still have a be a lot

437
00:30:02,579 --> 00:30:06,418
of people run without AV and it's a
great tool but i still do it why do I

438
00:30:06,419 --> 00:30:11,189
still have AV is because there are still
people out there using those bunk and

439
00:30:11,189 --> 00:30:16,499
you know by viruses that we already have
signatures for so i'm still using that

440
00:30:16,499 --> 00:30:20,789
what i expected to fail because i bypass
a be all the time

441
00:30:21,899 --> 00:30:30,029
I i gotta access to an aspx system and
there's a command shell aspx that you

442
00:30:30,029 --> 00:30:32,069
can get off off the internet

443
00:30:32,069 --> 00:30:36,809
AV already has a signature for it so you
know how do you get around a baby with

444
00:30:36,809 --> 00:30:44,819
that command shell a aspx just press
enter and add a new line and in the in

445
00:30:44,819 --> 00:30:49,889
the script because there's no longer
matches the md5 like you just have to

446
00:30:49,889 --> 00:30:53,698
change the code just slightly and all
the sudden it works again

447
00:30:53,699 --> 00:30:59,639
right but that you have to expect that
they're going to fail so that's where

448
00:30:59,639 --> 00:31:01,649
the detection piece comes into play

449
00:31:01,649 --> 00:31:06,899
so i'm going to show you a couple of
different things so I i like i like

450
00:31:06,899 --> 00:31:09,359
demoing things I like showing you what's
going on

451
00:31:09,359 --> 00:31:15,779
so uh Dave Kennedy and I were doing a
conference in north or south dakota

452
00:31:15,779 --> 00:31:18,179
where there's lots of things to do

453
00:31:18,179 --> 00:31:26,789
um like you know looking at corn and
snow and cold weather and more snow so

454
00:31:26,789 --> 00:31:30,149
it was super awesome but we were sitting
there doing a thing of red vs blue

455
00:31:30,880 --> 00:31:34,360
and while dave was doing his peace I
decided I was going to write a new tool

456
00:31:34,360 --> 00:31:38,290
I have no idea what they've said because
i was sitting there writing this new

457
00:31:38,290 --> 00:31:41,200
tool and it's called invoke cutting
friends

458
00:31:41,200 --> 00:31:45,490
it's a cool little powershell thing and
basically what it does is um i

459
00:31:45,490 --> 00:31:47,080
impersonate a user

460
00:31:47,080 --> 00:31:51,850
I and what the intent is to put that
user on the wire now I'm going to show

461
00:31:51,850 --> 00:31:53,469
you something

462
00:31:53,470 --> 00:31:56,470
raise your hands if you know about
responder

463
00:31:57,550 --> 00:32:06,970
oh I have something to show y'all
alright so responders this neat tool and

464
00:32:06,970 --> 00:32:13,360
basically what it does is it'll poison
request over the wire when i get on to a

465
00:32:13,360 --> 00:32:18,639
network infrastructure that this is the
one of the first things I load up when

466
00:32:18,640 --> 00:32:22,810
you don't have a dns entry when
something is not in the hosts file your

467
00:32:22,810 --> 00:32:27,879
systems if by default unless you have
disabled it will send an l m n R and an

468
00:32:27,880 --> 00:32:34,090
NBN s request saying hey I this dude Ben
is trying to talk to Matt does anyone

469
00:32:34,090 --> 00:32:39,610
know who matt is anyone who's even know
Matt Matt anyone anyone anyone will

470
00:32:39,610 --> 00:32:44,350
respond will actually say hey I'm Matt
come talk to me

471
00:32:44,980 --> 00:32:50,140
but before you talk to me I need you to
authenticate and so what ends up

472
00:32:50,140 --> 00:32:55,780
happening is is that I get your hash
when you authenticate this is invisible

473
00:32:55,780 --> 00:32:57,760
to you by the way so let me show you

474
00:32:57,760 --> 00:33:03,879
so I do this please don't take pictures
of the next thing that I'm about to do

475
00:33:03,880 --> 00:33:07,180
just because it's actually my hash and I
don't want you to get my super-awesome

476
00:33:07,180 --> 00:33:13,060
password just so if so I let's do this

477
00:33:13,570 --> 00:33:17,169
I know it might be hard to see but but
i'm just going to do this net use

478
00:34:14,980 --> 00:34:16,389
aight graphic

479
00:34:16,389 --> 00:34:19,389
in there we set one on fire

480
00:34:21,039 --> 00:34:26,440
ok like we burned like flames were
coming out of the GPUs it got so hot

481
00:34:26,440 --> 00:34:28,089
right

482
00:34:28,089 --> 00:34:31,089
if it's 14 or fewer it's not as it's not
a strong password

483
00:34:31,809 --> 00:34:35,289
you guys should really be adopting
passphrases something that goes beyond

484
00:34:35,289 --> 00:34:38,049
its all about entropy right so now we've
got this

485
00:34:38,049 --> 00:34:41,559
so does anyone know how you would catch
responder

486
00:34:43,418 --> 00:34:48,638
how would you catch this on your network
because I'm and I'm i'm on your network

487
00:34:48,639 --> 00:34:50,710
so i'm not going to pass your endpoints

488
00:34:50,710 --> 00:34:55,179
I'm on the same segment so unless you've
got multiple segments trying to do that

489
00:34:55,179 --> 00:34:59,890
how any idea how you stop this tool or
how do you catch it

490
00:34:59,890 --> 00:35:04,629
let me show you I saw you raise your
hand back there but i'm not going to get

491
00:35:04,630 --> 00:35:08,140
them i can tell you all right

492
00:35:08,650 --> 00:35:14,079
so what honey Craig's does is i'm going
to go ahead and get this fired up again

493
00:35:14,589 --> 00:35:19,630
so what honey Craig's does is

494
00:35:19,630 --> 00:35:27,579
oops it allows you to type in a username
and password

495
00:35:27,579 --> 00:35:32,140
now here's the thing you don't want your
username and password to be something

496
00:35:32,140 --> 00:35:34,480
like haha pen tester

497
00:35:34,480 --> 00:35:38,890
I got you because i'm not going to use
those creds you wanted to make it look

498
00:35:38,890 --> 00:35:41,558
like it's legitimate right

499
00:35:41,559 --> 00:35:47,019
what some of the most legitimate looking
accounts that will typically broadcast

500
00:35:47,019 --> 00:35:53,439
these types of things on a continual
basis service accounts right so let's

501
00:35:53,440 --> 00:35:58,990
look at this let's so if i do converge
flash SCCM updater right

502
00:35:58,990 --> 00:36:03,910
does that look legit like a legit
service right and that will put a super

503
00:36:03,910 --> 00:36:05,970
long password in there

504
00:36:05,970 --> 00:36:18,029
ok now what

505
00:36:18,030 --> 00:36:21,990
honey Craig's does is it impersonates
that user and then puts it down to the

506
00:36:21,990 --> 00:36:22,919
wire

507
00:36:22,920 --> 00:36:26,760
it'll just sit there and broadcast it
and beacon it well responder when it's

508
00:36:26,760 --> 00:36:29,760
sitting there it's like hey I just saw
something new

509
00:36:30,390 --> 00:36:35,730
I'm going to respond to it well and then
of course i'm going to first get the the

510
00:36:35,730 --> 00:36:41,010
hash like I demonstrated earlier so it's
going to try and connect and then the

511
00:36:41,010 --> 00:36:43,050
hash will pop up there on the screen

512
00:36:43,050 --> 00:36:46,530
it takes a few seconds to kind of
negotiate everything that's going on

513
00:36:46,530 --> 00:36:50,970
boom

514
00:36:50,970 --> 00:36:53,970
so there's a hash but i do something
else

515
00:36:54,510 --> 00:36:57,930
unlike with the hash is fine but what
happens if they can't crack it

516
00:36:58,500 --> 00:37:01,950
so then I decide to send you clear Tex

517
00:37:04,650 --> 00:37:08,910
now if I have clear text creds or I'm a
hash which way am I going to use first

518
00:37:08,910 --> 00:37:12,330
i'm going to use a clear text

519
00:37:12,330 --> 00:37:16,109
so what you do is you set up an alert
i'm gonna show you this in a second

520
00:37:16,109 --> 00:37:20,310
at the moment that this account is used
you have an indicator of compromise

521
00:37:20,310 --> 00:37:23,759
now let me show you that on the other
side here

522
00:37:23,760 --> 00:37:28,619
the other thing is you'll get 200 ok
because i sent aid

523
00:37:28,619 --> 00:37:32,700
HTTP request the moment that you see 200
status ok

524
00:37:32,700 --> 00:37:37,529
you know you have responder on your
network because there's no service known

525
00:37:37,530 --> 00:37:38,460
to man

526
00:37:38,460 --> 00:37:41,520
that should be responding to this
especially when you have a bogus account

527
00:37:41,520 --> 00:37:42,240
like that

528
00:37:42,240 --> 00:37:45,930
so what happens is in the event log

529
00:37:46,770 --> 00:37:56,070
you're going to want to write this down
under security the event ID is 46 48

530
00:37:56,790 --> 00:38:04,020
4648 is the event ID that you want

531
00:38:04,020 --> 00:38:08,490
now as an awesome it is is bent log and
I know everyone's in there all day long

532
00:38:08,490 --> 00:38:10,859
looking through all of those logs right

533
00:38:10,859 --> 00:38:12,770
i know i am because it's awesome

534
00:38:12,770 --> 00:38:17,960
no one's gonna be doing this so i wrote
another little tool called fine

535
00:38:17,960 --> 00:38:22,640
malicious count now a parsec framework
is a tool i wrote a few years ago

536
00:38:23,300 --> 00:38:27,470
it's meant to be a free and it's open
source it's kind of like a you know poor

537
00:38:27,470 --> 00:38:29,870
man's IDs type of system

538
00:38:29,870 --> 00:38:33,020
it's basically just power show I just
wrapped in a GUI so I had this cool

539
00:38:33,020 --> 00:38:40,700
little thing and I've got the script so
I want to find any time SCCM updater is

540
00:38:40,700 --> 00:38:44,779
used and what the script will do is it
will pull that event log for me over and

541
00:38:44,780 --> 00:38:47,480
over and over and over and over and over
and over again and the moment that I've

542
00:38:47,480 --> 00:38:52,280
got that anyone using that it will pop
up an alert so I was all do this

543
00:38:52,280 --> 00:38:55,340
it does this honey credits thing here
and it's just sitting there writing

544
00:38:55,340 --> 00:39:05,270
right so let's go ahead and delete my
database here and let me go ahead and

545
00:39:05,270 --> 00:39:08,270
respond this

546
00:39:12,410 --> 00:39:22,339
all right i'm gonna get responder going
and respawn this and I'm going to do

547
00:39:22,340 --> 00:39:33,590
again I'll do converge SCCM updater
really long password right now the

548
00:39:33,590 --> 00:39:36,860
moment that responder will actually
respond to the request

549
00:39:37,760 --> 00:39:42,050
what will end up happening in here is
I've got this tool so it's just looking

550
00:39:42,050 --> 00:39:46,400
at my event logs so responders going to
do is hold handle handshake thing

551
00:39:46,400 --> 00:39:50,420
whatever the case may be but the moment
that we get that boom

552
00:39:50,420 --> 00:39:54,470
I got you what do you think you guys
think

553
00:39:58,160 --> 00:40:00,868
yeah

554
00:40:00,869 --> 00:40:05,369
and that's the cool thing is is that
this is you already have access to all

555
00:40:05,369 --> 00:40:06,420
of this

556
00:40:06,420 --> 00:40:13,529
it's just power shell and event logs and
now you've got me before I've even done

557
00:40:13,529 --> 00:40:15,210
anything

558
00:40:15,210 --> 00:40:21,539
you have an indicator of compromise and
now you can go back and say hey we we

559
00:40:21,539 --> 00:40:23,609
see someone running responder on our
network

560
00:40:23,609 --> 00:40:29,009
whatever the case may be so that's on
the network side but what about honey

561
00:40:29,009 --> 00:40:29,700
pots

562
00:40:29,700 --> 00:40:34,140
you guys are probably using honey pots
right let me tell you most of y'all are

563
00:40:34,140 --> 00:40:35,549
setting up your honey pots wrong

564
00:40:35,549 --> 00:40:38,849
if your honey pot response to all 65,000
ports

565
00:40:38,849 --> 00:40:44,339
I'm not touching it ok it's not your
setting up your honey pots wrong

566
00:40:44,880 --> 00:40:49,920
it's make it look legit make it look
like it's actually put something legit

567
00:40:49,920 --> 00:40:50,670
up there

568
00:40:50,670 --> 00:40:55,650
make it make it look like it's your get
server do that is so sick right

569
00:40:56,279 --> 00:40:59,670
make it look like a legit get server and
then when i go to clone it's like haha

570
00:40:59,670 --> 00:41:00,450
gotcha

571
00:41:00,450 --> 00:41:05,848
that'd be awesome right make it look
legit but look see how this is working

572
00:41:06,599 --> 00:41:10,829
and guess what for me on the responder
side i have no clue that you just caught

573
00:41:10,829 --> 00:41:11,489
me

574
00:41:11,489 --> 00:41:15,869
I have no idea that you just bet you
that you're capturing these things

575
00:41:15,869 --> 00:41:19,319
none it's a good

576
00:41:19,910 --> 00:41:23,538
the pen tester by the way so if you want
to get back to them that's that's the

577
00:41:23,539 --> 00:41:25,339
way you do it

578
00:41:25,339 --> 00:41:30,109
so we talk

579
00:41:30,109 --> 00:41:31,020
a little bit

580
00:41:31,020 --> 00:41:36,750
wrong but let's talk about some other
defensive tricks right when you hire at

581
00:41:36,750 --> 00:41:41,760
pentester do they tell you what didn't
work as much as they tell you what did

582
00:41:42,330 --> 00:41:46,470
if you get a pen tester and they didn't
say you guys did a great job of

583
00:41:46,470 --> 00:41:49,649
detection or we tried this but it did it
work

584
00:41:50,190 --> 00:41:55,050
that could be a problem because how do
you know what's working if the tester

585
00:41:55,050 --> 00:41:59,550
doesn't tell you that's their job right
is to test whether things are working or

586
00:41:59,550 --> 00:42:00,000
not

587
00:42:00,000 --> 00:42:03,000
not just say I broke your stuff you're
welcome and have a nice day

588
00:42:03,600 --> 00:42:08,580
it's also the identified as the fact to
say hey we tried to login with all those

589
00:42:08,580 --> 00:42:11,190
linkedin accounts and none of them
worked

590
00:42:11,190 --> 00:42:16,170
right that's what you want to hear
because that's a bonus for you guys

591
00:42:16,170 --> 00:42:19,200
so when you're looking at this when
you're doing these types of tests make

592
00:42:19,200 --> 00:42:22,799
sure that they're actually telling you
what's not working for what didn't work

593
00:42:22,800 --> 00:42:28,590
for the love of all things pure change
your default passwords

594
00:42:28,590 --> 00:42:31,860
it's super simple just if you have a
service

595
00:42:31,860 --> 00:42:36,120
just type the service name default
password into google guess what

596
00:42:36,120 --> 00:42:41,819
they're all out there it's super simple
admin admin cisko cisko admin blank

597
00:42:41,820 --> 00:42:50,700
admin password admin pass I try all of
them if you can authenticate to any of

598
00:42:50,700 --> 00:42:54,120
your services with any of those types of
default passwords that's a problem

599
00:42:54,720 --> 00:42:58,169
brocade switches for those who you know
i'm not going to have you raised your

600
00:42:58,170 --> 00:43:00,810
hands of those who use a brocade switch

601
00:43:00,810 --> 00:43:05,580
it's like a cisco in the fact that you
can do like the typical cisco commands

602
00:43:05,580 --> 00:43:10,290
and stuff like that but what brocade
does as a as a convenience for the

603
00:43:10,290 --> 00:43:14,759
attacker is they also have a root login
with a default password

604
00:43:14,760 --> 00:43:19,260
it's like breanne or something like that
i don't know maybe it's a girlfriend but

605
00:43:19,260 --> 00:43:24,930
when you log into it has w get now a lot
of these brocade switches these are

606
00:43:24,930 --> 00:43:26,040
backbone stuff right

607
00:43:26,040 --> 00:43:30,420
so the last thing i want to do is bring
it down so I set up a separate jump box

608
00:43:30,420 --> 00:43:33,630
but the whole idea is that an attacker
may not care right

609
00:43:34,180 --> 00:43:37,419
and now you've got so if you have a
brocade switch you need to go look at

610
00:43:37,420 --> 00:43:39,310
those default passwords and turn it off

611
00:43:39,310 --> 00:43:47,650
I got da that way with a brocade switch
switch to da expect your controls to

612
00:43:47,650 --> 00:43:52,780
fail expect your user education to fail
if you are in this industry and you're

613
00:43:52,780 --> 00:43:54,550
not expecting failure you

614
00:43:54,550 --> 00:43:57,550
that's the problem there is no such
thing as perfection

615
00:43:58,480 --> 00:44:02,710
i Jeremy nielsen died due to talk
yesterday and he was talking about how

616
00:44:02,710 --> 00:44:03,880
even read to me to fail

617
00:44:03,880 --> 00:44:08,140
now i am I am perfect ok

618
00:44:08,140 --> 00:44:12,370
I never fail and I never do anything
wrong my stuff is always awesome but not

619
00:44:12,370 --> 00:44:17,560
expected to fail expect people to click
expect people to open things that should

620
00:44:17,560 --> 00:44:18,940
be normal

621
00:44:18,940 --> 00:44:25,990
stop being in your blue team bubble go
to the red team talks even if you may

622
00:44:25,990 --> 00:44:29,319
not fully understand they're gonna tell
you stories about their attacks the

623
00:44:29,320 --> 00:44:33,460
methodologies and hopefully some of the
stories i've talked about you guys might

624
00:44:33,460 --> 00:44:37,600
want to go back and be like hey you know
those brocade switches we got

625
00:44:38,110 --> 00:44:42,520
let's go and change them go to the red
team or talks

626
00:44:42,520 --> 00:44:47,259
it's not always about blue burn things
to the ground

627
00:44:47,890 --> 00:44:54,009
not literally uh netflix has this thing
called chaos monkey you never heard of

628
00:44:54,010 --> 00:44:55,120
it

629
00:44:55,120 --> 00:45:01,120
- so what chaos monkey is it basically
is this it goes on it goes to amazon web

630
00:45:01,120 --> 00:45:06,160
services and it starts turning things
off like a releasing a simian into a

631
00:45:06,160 --> 00:45:09,580
data center just turns things off for
you

632
00:45:09,580 --> 00:45:15,850
it creates chaos if you are not creating
chaos in your environment that's a

633
00:45:15,850 --> 00:45:21,430
problem if everything has to be so
planned out all your pen test has to be

634
00:45:21,430 --> 00:45:24,759
perfectly node we have to know exactly
what's going on

635
00:45:24,760 --> 00:45:31,600
we can't have any chaos whatsoever you
are not ready for an attack because an

636
00:45:31,600 --> 00:45:36,610
attack is not methodical attack is not
planned out and attack is chaos

637
00:45:37,120 --> 00:45:42,089
I will turn crap off right

638
00:45:42,090 --> 00:45:47,640
your team should be not be surprised
when that happens it shouldn't be

639
00:45:47,640 --> 00:45:49,410
where's the incident response manual

640
00:45:49,410 --> 00:45:53,460
what's the policy on this what do we do
we found a road box

641
00:45:53,460 --> 00:45:57,450
what's our procedure I don't know where
is Jim Jim's on vacation

642
00:45:57,450 --> 00:46:00,960
where's Bob Bob is not here right now
well what do we do

643
00:46:00,960 --> 00:46:09,000
well it's friday we'll leave it till
Monday see i was i was 13 years in

644
00:46:09,000 --> 00:46:10,560
infrastructure I know how it works

645
00:46:10,560 --> 00:46:14,790
you should not be this should be normal

646
00:46:15,390 --> 00:46:19,980
it should be normal when things break it
should be normal when things don't work

647
00:46:19,980 --> 00:46:20,760
right

648
00:46:20,760 --> 00:46:23,910
if you're not burning things down that's
a problem

649
00:46:24,540 --> 00:46:28,740
now granted when you burn things down

650
00:46:28,740 --> 00:46:32,759
you get people that may not necessarily
appreciate you

651
00:46:32,760 --> 00:46:39,090
white nearly as much right because we
expect everything to work well

652
00:46:46,540 --> 00:46:49,540
I love to do and yes I said oh that's
Jim I'm sitting back down

653
00:46:57,940 --> 00:47:04,690
did you see the data back out ok ok

654
00:47:06,040 --> 00:47:10,630
he's like no I'm not touching that
that's not for me and that i'm not even

655
00:47:10,630 --> 00:47:12,550
i'm not even gonna go there right

656
00:47:12,550 --> 00:47:15,910
but that's the whole idea yes yes it
causes destruction

657
00:47:16,450 --> 00:47:20,830
yes it's not ideal but you should be
prepared to handle those types of

658
00:47:20,830 --> 00:47:23,410
situations on the defensive side

659
00:47:23,410 --> 00:47:26,410
I'm gonna get my screen back

660
00:47:27,370 --> 00:47:30,609
sweet look at that I should be prepared
for this

661
00:47:33,880 --> 00:47:39,700
there we go you get it ok so i wrote
this tool called the Krakken and the

662
00:47:39,700 --> 00:47:44,439
crack it is a it was designed as a
defensive methodology that if I found

663
00:47:44,440 --> 00:47:47,290
that something was going on my box and
it wasn't physically able to get there

664
00:47:47,290 --> 00:47:48,580
to figure out what's going on

665
00:47:48,580 --> 00:47:51,850
I wanted it off my networking so what it
would do is it would go out to the box

666
00:47:51,850 --> 00:47:56,650
and hardware disabled not software
hardware disable the net all of the next

667
00:47:56,650 --> 00:48:00,910
set on the box so i thought this was
awesome and whatever the case may be and

668
00:48:00,910 --> 00:48:04,240
I let my team uses the unfortunate
reality is is that i set it up to where

669
00:48:04,240 --> 00:48:09,399
you could point to all of our assets
entire domain so it's a great way to

670
00:48:09,400 --> 00:48:13,450
rage quit because when you hardware
disabled

671
00:48:13,450 --> 00:48:17,529
you can't remotely reenable that means
you have to walk to every single box and

672
00:48:17,530 --> 00:48:22,750
reenable those next so if you want to
rage quit that's way it is now because

673
00:48:22,750 --> 00:48:26,110
I'm socially short like this isn't
really the appropriate icon for the

674
00:48:26,110 --> 00:48:31,780
crack and it's kind of like this for me
but it should be chaos right

675
00:48:32,290 --> 00:48:35,620
that's something that you need in your
environment

676
00:48:35,620 --> 00:48:40,089
it's about detection can you detect when
you introduce that chaos

677
00:48:40,090 --> 00:48:45,040
you should be able to see that on your
own in your system's make sure that

678
00:48:45,040 --> 00:48:48,520
detection is your primary goal when you
do a pen test

679
00:48:48,520 --> 00:48:51,550
it's not so much stopping them but it's
did you even see me doing anything

680
00:48:52,540 --> 00:48:56,020
i did an event and I n and this guy was
like oh we got you

681
00:48:56,020 --> 00:48:59,559
we've got this awesome alert we've got
this awesome sin we got the best team

682
00:48:59,559 --> 00:49:04,150
whatever so I testing for like a week
and I'm like did you get anything he's

683
00:49:04,150 --> 00:49:06,279
like no you probably haven't even
started yet

684
00:49:06,279 --> 00:49:10,209
like nine and I'm and I'm i attempted to
log into your outlook fifty-four

685
00:49:10,209 --> 00:49:11,439
thousand times

686
00:49:11,439 --> 00:49:18,308
he's like what like what yeah you're owa
because oh I'm you guys are monitoring

687
00:49:18,309 --> 00:49:26,709
your owa see it's about detection

688
00:49:27,549 --> 00:49:30,880
I i want to show you something else real
quick

689
00:49:31,630 --> 00:49:37,029
a lot of you guys are scared of power
show and you're like hey we're just

690
00:49:37,029 --> 00:49:41,799
going to lock it down so that no one can
use it but so I wrote a tool called not

691
00:49:41,799 --> 00:49:53,079
powershell and it works the same exact
way as you know you know what you would

692
00:49:53,079 --> 00:49:58,869
do in powershell i can even do so you
can even you can do to powershell single

693
00:49:58,869 --> 00:50:02,170
command you can do could include command
you can go to decode command so if i'm

694
00:50:02,170 --> 00:50:06,189
dropping a binary and you're trying to
block powershell just at the binary and

695
00:50:06,189 --> 00:50:08,558
it doesn't do you any good

696
00:50:08,559 --> 00:50:14,650
it's not about the deflecting it's about
detecting we're going to come up with

697
00:50:14,650 --> 00:50:17,650
ways to get around all of your tools
like the execution policy

698
00:50:18,279 --> 00:50:22,299
dude there are 15 different ways to get
around execution policy and by the way

699
00:50:22,299 --> 00:50:25,239
if I'm able to get to system i can
change that

700
00:50:25,239 --> 00:50:28,749
so a lot of good that's gonna do right

701
00:50:28,749 --> 00:50:30,270
it's a

702
00:50:30,270 --> 00:50:34,620
detecting knowing that you have an
indicator of compromise if you don't

703
00:50:34,620 --> 00:50:37,620
have that your defense and methodology
needs to change

704
00:50:38,160 --> 00:50:41,790
so all the stuff that I've shown you so
far honey creds everything else like

705
00:50:41,790 --> 00:50:42,480
that

706
00:50:42,480 --> 00:50:46,260
parsec framework that's all out on
github and guess what it's free

707
00:50:47,370 --> 00:50:50,069
take it you whatever you want in fact
someone's already cloned it not

708
00:50:50,070 --> 00:50:52,170
complimenting me on it so I'm okay with
that

709
00:50:52,170 --> 00:50:56,880
uh I know that there have been a couple
of new attack frameworks that come out

710
00:50:56,880 --> 00:51:02,280
that actually pulled code from Hot Shot
framework so go out grab honey creds

711
00:51:02,280 --> 00:51:06,510
I know I know a client that just used it
on an engagement on an internal red team

712
00:51:06,510 --> 00:51:09,510
he said his red team was super pissed
and he was so excited

713
00:51:10,110 --> 00:51:15,930
i'm gerry jackson has some awesome stuff
out there to really good guys got invoke

714
00:51:15,930 --> 00:51:16,740
ir

715
00:51:16,740 --> 00:51:20,729
it's cool powershell stuff a lot of
stuff that Matt Johnson rights with posh

716
00:51:20,730 --> 00:51:24,660
sec potluck very much is what i wrote
but all of the parts x2 love comes from

717
00:51:24,660 --> 00:51:27,450
a bouncing so make sure you guys take a
look at that

718
00:51:27,450 --> 00:51:31,350
so in conclusion oh I'll go back so you
guys can take another picture

719
00:51:31,350 --> 00:51:36,720
so in conclusion the idea here is don't
get stuck on a single methodology come

720
00:51:36,720 --> 00:51:40,890
up with new and unique ways figure out
what the bad guys are doing and then go

721
00:51:40,890 --> 00:51:42,810
back and say how can we detect that

722
00:51:42,810 --> 00:51:47,190
how can we stop that and if you don't
know talk to the presenter because they

723
00:51:47,190 --> 00:51:51,180
make they may come and say I broke
everything that your job should be how

724
00:51:51,180 --> 00:51:56,279
do I defend against that they should be
able to tell you how do I defend against

725
00:51:56,280 --> 00:52:01,800
that detection is more important than
deflection because the deflection will

726
00:52:01,800 --> 00:52:02,610
fail

727
00:52:02,610 --> 00:52:08,490
it only works on the nones you have to
worry that has to be focused on that

728
00:52:08,490 --> 00:52:14,669
so this is how you get a hold of me I
answer email awesomely Ben's usa.com

729
00:52:14,670 --> 00:52:20,040
it's not been oxide 0xa texted us we'll
pretend and all the stuff i have is i

730
00:52:20,040 --> 00:52:24,700
don't get hub but thank you guys very
much i really appreciate it

731
00:52:24,700 --> 00:52:31,000
yeah

