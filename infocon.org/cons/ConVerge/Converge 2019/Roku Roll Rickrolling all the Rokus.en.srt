1
00:00:07,260 --> 00:00:13,020
so I mean just make sure I don't get off

2
00:00:09,960 --> 00:00:14,520
time here all right thank you very much

3
00:00:13,020 --> 00:00:16,740
for coming to my talk

4
00:00:14,520 --> 00:00:19,350
my name is ken Cooper a lot of you guys

5
00:00:16,740 --> 00:00:21,209
know me just want to take a second to

6
00:00:19,350 --> 00:00:22,710
say thank you so much to all of you that

7
00:00:21,210 --> 00:00:24,810
do know me as people that don't that's

8
00:00:22,710 --> 00:00:26,640
okay too but you guys are great like

9
00:00:24,810 --> 00:00:29,250
without you like my career just be

10
00:00:26,640 --> 00:00:31,349
terrible like I love being in my sec

11
00:00:29,250 --> 00:00:32,970
slack you guys means so much to me so

12
00:00:31,349 --> 00:00:35,910
thank you so much for being a part of my

13
00:00:32,970 --> 00:00:37,170
community thank you very much

14
00:00:35,910 --> 00:00:41,390
[Applause]

15
00:00:37,170 --> 00:00:43,440
so what's a Roku if you don't know

16
00:00:41,390 --> 00:00:46,050
there's just a series of digital

17
00:00:43,440 --> 00:00:49,649
streaming media players by this company

18
00:00:46,050 --> 00:00:51,328
called Roku Inc they work in TVs and in

19
00:00:49,649 --> 00:00:53,340
these little set-top boxes they're

20
00:00:51,329 --> 00:00:56,280
basically an IOT device and I got really

21
00:00:53,340 --> 00:00:57,809
interested in them relatively recently

22
00:00:56,280 --> 00:01:00,420
because I just started seeing them pop

23
00:00:57,809 --> 00:01:02,608
up in my life like at people's like

24
00:01:00,420 --> 00:01:04,530
homes that like I knew and things like

25
00:01:02,609 --> 00:01:06,030
that in offices and I was like this is

26
00:01:04,530 --> 00:01:08,490
kind of a weird device let me take a

27
00:01:06,030 --> 00:01:11,100
look at it and you know just go and show

28
00:01:08,490 --> 00:01:13,530
Dan you can kind of see basically like

29
00:01:11,100 --> 00:01:15,419
where they popular and then this is when

30
00:01:13,530 --> 00:01:18,240
I first gave this talk I believe a month

31
00:01:15,420 --> 00:01:21,480
ago and now you can see that they've

32
00:01:18,240 --> 00:01:23,270
expanded it a little bit and they're

33
00:01:21,480 --> 00:01:26,040
slowly becoming more and more popular

34
00:01:23,270 --> 00:01:28,289
this is just the zoomed in version this

35
00:01:26,040 --> 00:01:30,780
is just showing hey it's being used you

36
00:01:28,290 --> 00:01:32,640
can go get some interesting stuff when

37
00:01:30,780 --> 00:01:34,170
you go look at show Dan for that and

38
00:01:32,640 --> 00:01:35,160
this is a nice string you can put in

39
00:01:34,170 --> 00:01:40,620
show it and to find the ones that are

40
00:01:35,160 --> 00:01:42,869
open online okay so you can see the

41
00:01:40,620 --> 00:01:45,060
Google Trends here this is just another

42
00:01:42,870 --> 00:01:48,120
interesting point about the product

43
00:01:45,060 --> 00:01:49,950
they've been very successful like you

44
00:01:48,120 --> 00:01:51,840
can see here the yellow line being Roku

45
00:01:49,950 --> 00:01:53,700
and all of those little spikes up that

46
00:01:51,840 --> 00:01:55,890
you'll see like here all of those are

47
00:01:53,700 --> 00:01:57,300
basically holiday seasons because that's

48
00:01:55,890 --> 00:01:59,190
essentially when people are like looking

49
00:01:57,300 --> 00:02:01,289
them up and then we can see that

50
00:01:59,190 --> 00:02:03,840
chromecast has had a downward trend and

51
00:02:01,290 --> 00:02:06,990
fire TV has basically been flatlined at

52
00:02:03,840 --> 00:02:08,429
least in this school trend search and

53
00:02:06,990 --> 00:02:10,049
just another kind of interesting point

54
00:02:08,429 --> 00:02:13,110
about the company I suppose they

55
00:02:10,050 --> 00:02:14,940
recently had a big stock dive that we

56
00:02:13,110 --> 00:02:17,459
could see and then for whatever reason

57
00:02:14,940 --> 00:02:19,530
they just have like almost an immediate

58
00:02:17,459 --> 00:02:21,270
pop back up I just found this like very

59
00:02:19,530 --> 00:02:25,170
interesting like why are invest

60
00:02:21,270 --> 00:02:26,070
like so asset and investing in Roku so

61
00:02:25,170 --> 00:02:28,530
why

62
00:02:26,070 --> 00:02:30,570
and it's basically adds like effectively

63
00:02:28,530 --> 00:02:32,190
what the platform is is an advertising

64
00:02:30,570 --> 00:02:34,079
platform and this is just a quick screen

65
00:02:32,190 --> 00:02:35,820
shots from better cap showing a bunch of

66
00:02:34,080 --> 00:02:37,560
communication going to like double

67
00:02:35,820 --> 00:02:39,810
clicked on net which is Google's ad

68
00:02:37,560 --> 00:02:41,820
service and this is like happening a lot

69
00:02:39,810 --> 00:02:43,770
and you'll see a whole bunch of network

70
00:02:41,820 --> 00:02:44,760
traffic when you see if any of I or T

71
00:02:43,770 --> 00:02:46,760
device really right

72
00:02:44,760 --> 00:02:49,500
but these Roku specifically are just

73
00:02:46,760 --> 00:02:52,049
monitoring a lot of what's going on like

74
00:02:49,500 --> 00:02:54,720
all of the stuff that you're watching in

75
00:02:52,050 --> 00:02:56,490
fact like the Roku publishing platform

76
00:02:54,720 --> 00:02:58,680
is what they're trying to like sell to

77
00:02:56,490 --> 00:03:00,390
companies like Hulu and Viacom and

78
00:02:58,680 --> 00:03:02,400
things like that so they can go put

79
00:03:00,390 --> 00:03:04,619
their channels like their Netflix right

80
00:03:02,400 --> 00:03:06,690
on the Roku platform so that people will

81
00:03:04,620 --> 00:03:08,220
use them and so that they're trying to

82
00:03:06,690 --> 00:03:10,260
like basically market themself is a very

83
00:03:08,220 --> 00:03:13,170
popular platform and they're doing quite

84
00:03:10,260 --> 00:03:14,160
well honestly and one of the more

85
00:03:13,170 --> 00:03:15,750
interesting parts about that whole

86
00:03:14,160 --> 00:03:18,329
platform is that has literally an ad

87
00:03:15,750 --> 00:03:20,340
framework built in like all the things

88
00:03:18,330 --> 00:03:23,160
that you're watching can be monitored

89
00:03:20,340 --> 00:03:25,110
it's very very kind of like Orwell II

90
00:03:23,160 --> 00:03:27,450
and I suppose but just interesting

91
00:03:25,110 --> 00:03:29,100
because makes a lot of sense because I

92
00:03:27,450 --> 00:03:30,810
want to know what you're watching so I

93
00:03:29,100 --> 00:03:33,090
can advertise to you better

94
00:03:30,810 --> 00:03:35,190
that's essentially what they're selling

95
00:03:33,090 --> 00:03:37,350
right they're a hardware company that's

96
00:03:35,190 --> 00:03:38,700
selling these little boxes but then you

97
00:03:37,350 --> 00:03:40,530
all these hardware companies need a

98
00:03:38,700 --> 00:03:43,290
software play and their software play is

99
00:03:40,530 --> 00:03:44,700
obviously advertising and like basically

100
00:03:43,290 --> 00:03:46,140
you can just like just go on your Roku

101
00:03:44,700 --> 00:03:47,579
and then you'll see like random things

102
00:03:46,140 --> 00:03:50,010
like Jeff Goldblum trying to sell you

103
00:03:47,580 --> 00:03:51,630
apartments because you looked at trying

104
00:03:50,010 --> 00:03:52,590
to move to a new apartment it gets

105
00:03:51,630 --> 00:03:55,079
really weird

106
00:03:52,590 --> 00:03:56,430
again very overly and and basically

107
00:03:55,080 --> 00:03:58,410
because it's just free real estate like

108
00:03:56,430 --> 00:04:00,060
you're watching the TV like all the time

109
00:03:58,410 --> 00:04:02,579
right like they counts like how many

110
00:04:00,060 --> 00:04:04,140
hours of content is being streamed and

111
00:04:02,580 --> 00:04:05,670
they're very very proud of the fact that

112
00:04:04,140 --> 00:04:09,208
more and more households are screaming

113
00:04:05,670 --> 00:04:11,010
more so the whole platform is honestly

114
00:04:09,209 --> 00:04:12,720
like very nice like I actually kind of

115
00:04:11,010 --> 00:04:14,579
like having lived with the Roku guys to

116
00:04:12,720 --> 00:04:16,260
kind of like the Roku quite a bit like

117
00:04:14,580 --> 00:04:18,570
honestly you kind of become like

118
00:04:16,260 --> 00:04:20,339
attached to like the Roku remote because

119
00:04:18,570 --> 00:04:21,870
like honestly the Roku remote is like

120
00:04:20,339 --> 00:04:24,719
almost nice it'll hold then like maybe

121
00:04:21,870 --> 00:04:26,580
you're like built-in TV remote has like

122
00:04:24,720 --> 00:04:28,169
a built-in like a headphone jack which

123
00:04:26,580 --> 00:04:30,090
is really nice just like a whole bunch

124
00:04:28,169 --> 00:04:32,430
of like really weird features in fact

125
00:04:30,090 --> 00:04:33,690
you can do like a find my remote and it

126
00:04:32,430 --> 00:04:34,800
can play like the Game of Thrones theme

127
00:04:33,690 --> 00:04:36,060
song when you're like

128
00:04:34,800 --> 00:04:38,520
it's lost under the couch or something

129
00:04:36,060 --> 00:04:40,710
it's a it's a cool platform to be clear

130
00:04:38,520 --> 00:04:42,508
and then if you don't have the Roku

131
00:04:40,710 --> 00:04:44,039
remote look you lost that and you didn't

132
00:04:42,509 --> 00:04:46,919
have a find my remote thing for some

133
00:04:44,039 --> 00:04:49,259
reason well you have your iPhone or your

134
00:04:46,919 --> 00:04:52,349
Android device and basically it can

135
00:04:49,259 --> 00:04:55,830
control your TV or your roku device -

136
00:04:52,349 --> 00:04:57,690
and so how does that work right so we

137
00:04:55,830 --> 00:04:58,949
have this external control API and this

138
00:04:57,690 --> 00:05:00,990
is where things kind of get interesting

139
00:04:58,949 --> 00:05:03,150
with the roku platform so this basically

140
00:05:00,990 --> 00:05:05,610
enables a roku device to be controlled

141
00:05:03,150 --> 00:05:07,289
over a local area network and so that's

142
00:05:05,610 --> 00:05:09,389
pretty cool like I want to control the

143
00:05:07,289 --> 00:05:11,460
roku among the network and then

144
00:05:09,389 --> 00:05:13,349
basically if you use a simple service

145
00:05:11,460 --> 00:05:15,479
discovery protocol which is basically

146
00:05:13,349 --> 00:05:17,490
just like very very simple i'll show you

147
00:05:15,479 --> 00:05:20,669
the protocol looks like it's like plain

148
00:05:17,490 --> 00:05:24,270
text and it's essentially like HTTP over

149
00:05:20,669 --> 00:05:25,560
UDP but it is kind of weird but then you

150
00:05:24,270 --> 00:05:26,818
have this restful api that we can

151
00:05:25,560 --> 00:05:28,020
actually go interact with it

152
00:05:26,819 --> 00:05:29,879
so with the simple service discovery

153
00:05:28,020 --> 00:05:31,530
protocol in order to find the Roku's and

154
00:05:29,879 --> 00:05:32,729
then the restful api in order to

155
00:05:31,530 --> 00:05:35,580
actually interact with it and do

156
00:05:32,729 --> 00:05:37,590
interesting things so the way the SDP

157
00:05:35,580 --> 00:05:40,800
works is that we basically just do this

158
00:05:37,590 --> 00:05:42,690
HTTP looking request and instead of like

159
00:05:40,800 --> 00:05:44,430
you know get or something here it's M

160
00:05:42,690 --> 00:05:47,250
search and then we're doing HTTP 1.1

161
00:05:44,430 --> 00:05:51,150
this broadcast address and then we're

162
00:05:47,250 --> 00:05:52,919
looking for Roku devices here and so you

163
00:05:51,150 --> 00:05:54,479
send that on the network this is the

164
00:05:52,919 --> 00:05:56,430
request you could see like in something

165
00:05:54,479 --> 00:05:58,199
like Wireshark and then you could see

166
00:05:56,430 --> 00:06:00,840
the response which is gonna be this HTTP

167
00:05:58,199 --> 00:06:02,699
200 ok where it says hey you're looking

168
00:06:00,840 --> 00:06:04,529
for Roku device cool I'm a roku device

169
00:06:02,699 --> 00:06:06,629
and this will happen like very very fast

170
00:06:04,529 --> 00:06:08,699
and then just like cool I know where you

171
00:06:06,629 --> 00:06:10,020
are nice don't you do anything else and

172
00:06:08,699 --> 00:06:13,469
now I can start interacting with the API

173
00:06:10,020 --> 00:06:15,508
API but basically depending on what

174
00:06:13,469 --> 00:06:17,789
endpoint you hit return things like

175
00:06:15,509 --> 00:06:19,610
either like plain text XML or even think

176
00:06:17,789 --> 00:06:22,770
JSON in some cases it's kind of weird

177
00:06:19,610 --> 00:06:25,349
but I can just ask like what apps are

178
00:06:22,770 --> 00:06:27,508
currently installed on the TV and then I

179
00:06:25,349 --> 00:06:30,330
can tell me you know we got Roku Netflix

180
00:06:27,509 --> 00:06:32,580
etc it's like all right neat so the way

181
00:06:30,330 --> 00:06:34,139
that like the whole roku roll attack

182
00:06:32,580 --> 00:06:36,419
essentially works it's actually fairly

183
00:06:34,139 --> 00:06:40,560
simple on the local network

184
00:06:36,419 --> 00:06:42,419
I basically checked like where are the

185
00:06:40,560 --> 00:06:43,949
Roku devices and the Roku devices are

186
00:06:42,419 --> 00:06:46,440
program to tell me that they are roku

187
00:06:43,949 --> 00:06:48,420
device and I say cool please just play

188
00:06:46,440 --> 00:06:51,480
Rick Astley's never gonna get you out

189
00:06:48,420 --> 00:06:53,790
and then it does and I know it's kind of

190
00:06:51,480 --> 00:06:55,680
like not that cool but like that's

191
00:06:53,790 --> 00:06:56,610
literally how the attack works so that's

192
00:06:55,680 --> 00:06:58,710
simple Oh

193
00:06:56,610 --> 00:07:00,780
and so like literally it fits in a tweet

194
00:06:58,710 --> 00:07:02,460
like really literally just curl and then

195
00:07:00,780 --> 00:07:04,739
hit the rest API endpoint and then

196
00:07:02,460 --> 00:07:06,750
launch this is saying launch YouTube

197
00:07:04,740 --> 00:07:08,640
this is the YouTube ID which is gonna be

198
00:07:06,750 --> 00:07:11,460
the same at all the Roku players and

199
00:07:08,640 --> 00:07:12,810
then the Content ID which is never gonna

200
00:07:11,460 --> 00:07:13,830
give you out by Rick Astley it's a great

201
00:07:12,810 --> 00:07:18,180
great song I don't know if you ever

202
00:07:13,830 --> 00:07:21,990
heard it but it's good anyway so maybe

203
00:07:18,180 --> 00:07:24,090
maybe maybe so with just for fun I

204
00:07:21,990 --> 00:07:25,860
didn't want to do it with just in doing

205
00:07:24,090 --> 00:07:30,119
like curl bash commands I decided to

206
00:07:25,860 --> 00:07:32,130
make this whole going basically API

207
00:07:30,120 --> 00:07:33,510
connector that I can go and you know

208
00:07:32,130 --> 00:07:34,920
interact with API because I really love

209
00:07:33,510 --> 00:07:37,830
go I didn't do a Ruby for whatever

210
00:07:34,920 --> 00:07:39,300
reason this time whatever so this is the

211
00:07:37,830 --> 00:07:41,460
example code in order to like

212
00:07:39,300 --> 00:07:42,930
essentially do the whole Roku roll

213
00:07:41,460 --> 00:07:46,710
process this would be like the code

214
00:07:42,930 --> 00:07:49,260
right so a package main because go we

215
00:07:46,710 --> 00:07:51,180
start package main we import the library

216
00:07:49,260 --> 00:07:53,880
that I wrote from github right now and

217
00:07:51,180 --> 00:07:55,830
then we have this just function main and

218
00:07:53,880 --> 00:07:57,840
this is what runs we get the devices

219
00:07:55,830 --> 00:08:01,020
with the Roku default wait time which I

220
00:07:57,840 --> 00:08:03,479
think is like three seconds and then we

221
00:08:01,020 --> 00:08:05,490
basically whatever devices we got we

222
00:08:03,480 --> 00:08:08,160
just check what apps are on there and

223
00:08:05,490 --> 00:08:11,010
then if we have the YouTube app ID we're

224
00:08:08,160 --> 00:08:12,570
gonna launch the Rick Astley video we

225
00:08:11,010 --> 00:08:13,590
could also optionally install YouTube

226
00:08:12,570 --> 00:08:15,990
and do a whole bunch of other things

227
00:08:13,590 --> 00:08:18,630
here but very simple this is what the

228
00:08:15,990 --> 00:08:20,040
code would be and then it has a whole

229
00:08:18,630 --> 00:08:21,120
bunch of other features and I don't

230
00:08:20,040 --> 00:08:22,860
think I'm gonna have time to like get

231
00:08:21,120 --> 00:08:24,630
into like essentially all the features

232
00:08:22,860 --> 00:08:29,160
and I'm actually going really fast which

233
00:08:24,630 --> 00:08:30,630
is nice but uh I can also do the find my

234
00:08:29,160 --> 00:08:31,860
remote thing so with that device do you

235
00:08:30,630 --> 00:08:33,419
have a whole bunch of different methods

236
00:08:31,860 --> 00:08:35,400
that you can call upon it and so one of

237
00:08:33,419 --> 00:08:37,169
them is fine my remote which could be

238
00:08:35,400 --> 00:08:39,299
like very helpful to find my remote with

239
00:08:37,169 --> 00:08:40,919
its lost or to annoy people like I think

240
00:08:39,299 --> 00:08:42,809
in like an office setting situation

241
00:08:40,919 --> 00:08:45,829
really why is the remote continuingly

242
00:08:42,809 --> 00:08:49,439
like beeping or playing Game of Thrones

243
00:08:45,830 --> 00:08:51,150
so this Roku remote actually has like

244
00:08:49,440 --> 00:08:52,680
one other special capability that's like

245
00:08:51,150 --> 00:08:54,290
very very important because you can't do

246
00:08:52,680 --> 00:08:56,880
this through the external control API

247
00:08:54,290 --> 00:08:58,770
but one of the cooler like modes you can

248
00:08:56,880 --> 00:08:59,130
put your roku device in is in developer

249
00:08:58,770 --> 00:09:00,990
mode

250
00:08:59,130 --> 00:09:02,100
developer mode allows you to basically

251
00:09:00,990 --> 00:09:03,450
well

252
00:09:02,100 --> 00:09:05,700
use the device as though you're a

253
00:09:03,450 --> 00:09:08,610
developer making apps for the platform

254
00:09:05,700 --> 00:09:10,350
so I want to load up my own application

255
00:09:08,610 --> 00:09:11,880
on that rope you device and maybe it's

256
00:09:10,350 --> 00:09:13,620
gonna be like a malicious application in

257
00:09:11,880 --> 00:09:15,120
this case and I'm gonna dive into how

258
00:09:13,620 --> 00:09:23,310
some malicious applications written for

259
00:09:15,120 --> 00:09:25,110
Roku there I could just tear another

260
00:09:23,310 --> 00:09:26,969
like Roku remote like I bring if I was

261
00:09:25,110 --> 00:09:28,350
like going on to a network and I was

262
00:09:26,970 --> 00:09:30,180
attacking a Roku I could bring my own

263
00:09:28,350 --> 00:09:33,150
Roku remote and then connect it with any

264
00:09:30,180 --> 00:09:34,589
Roku and it's totally good but the

265
00:09:33,150 --> 00:09:38,220
device setup is essentially just like

266
00:09:34,590 --> 00:09:40,050
this DND thing right a dance dance

267
00:09:38,220 --> 00:09:42,300
revelution thing where i basically do

268
00:09:40,050 --> 00:09:43,829
home button three times up up right left

269
00:09:42,300 --> 00:09:47,040
right left and then right and then it

270
00:09:43,830 --> 00:09:49,920
brings me to this nice developer loading

271
00:09:47,040 --> 00:09:51,449
page and then once I have that set up I

272
00:09:49,920 --> 00:09:53,670
can go ahead and I can start installing

273
00:09:51,450 --> 00:09:56,010
applications on it and this is obviously

274
00:09:53,670 --> 00:09:57,449
like Karnes leads into a different kind

275
00:09:56,010 --> 00:09:58,860
of attack surface which I'm not gonna

276
00:09:57,450 --> 00:10:00,390
really have time to go into but this

277
00:09:58,860 --> 00:10:01,740
itself is just a web application so you

278
00:10:00,390 --> 00:10:04,140
can kind of imagine things that web

279
00:10:01,740 --> 00:10:05,640
applications can have problems with this

280
00:10:04,140 --> 00:10:07,860
is just one that's not gonna be enabled

281
00:10:05,640 --> 00:10:11,490
on Roku devices by default something

282
00:10:07,860 --> 00:10:13,740
you're gonna have to enable yourself so

283
00:10:11,490 --> 00:10:15,720
if I'm a Roku developer and I'm

284
00:10:13,740 --> 00:10:17,670
developing applications for it like what

285
00:10:15,720 --> 00:10:20,850
language do I get to develop in is it

286
00:10:17,670 --> 00:10:22,949
gonna see C++ no no no Roku has no

287
00:10:20,850 --> 00:10:25,500
interest in those Roku has bright script

288
00:10:22,950 --> 00:10:27,330
you might be like write scripts of what

289
00:10:25,500 --> 00:10:28,290
so there's this other company and

290
00:10:27,330 --> 00:10:29,850
totally entirely

291
00:10:28,290 --> 00:10:33,689
it's called bright sign and it's

292
00:10:29,850 --> 00:10:35,910
actually created the CEO of Roku figured

293
00:10:33,690 --> 00:10:38,100
his name but he has another company like

294
00:10:35,910 --> 00:10:39,780
Roku is like a sixth company Roku is six

295
00:10:38,100 --> 00:10:42,150
in Japanese so he likes companies I

296
00:10:39,780 --> 00:10:43,620
think but he has this other company

297
00:10:42,150 --> 00:10:45,360
called bright sign and it's sort of like

298
00:10:43,620 --> 00:10:48,600
Roku devices but it's targeted towards

299
00:10:45,360 --> 00:10:50,580
more like like large signage right so

300
00:10:48,600 --> 00:10:52,530
not your local not your TV but like

301
00:10:50,580 --> 00:10:56,040
large display which could be in like

302
00:10:52,530 --> 00:10:57,569
festivals it could be like any really

303
00:10:56,040 --> 00:11:00,209
anything like where you see big signage

304
00:10:57,570 --> 00:11:01,350
displays right so this is a totally

305
00:11:00,210 --> 00:11:02,970
separate device this is called the

306
00:11:01,350 --> 00:11:04,500
bright sign device and they have a whole

307
00:11:02,970 --> 00:11:06,060
bunch different models and honestly this

308
00:11:04,500 --> 00:11:07,770
is actually a more interesting device

309
00:11:06,060 --> 00:11:08,430
because I can do things like sideload

310
00:11:07,770 --> 00:11:10,350
nodejs

311
00:11:08,430 --> 00:11:11,969
and java applications on this has a

312
00:11:10,350 --> 00:11:14,720
whole bunch of extra features like it

313
00:11:11,970 --> 00:11:17,420
has like SSH and I believe

314
00:11:14,720 --> 00:11:19,970
so very interesting but that whole like

315
00:11:17,420 --> 00:11:21,680
other company that like bright script

316
00:11:19,970 --> 00:11:25,550
thing is now pulled into Roku that

317
00:11:21,680 --> 00:11:27,290
happened at some point so Roku now has

318
00:11:25,550 --> 00:11:29,410
this powerful scripting language that

319
00:11:27,290 --> 00:11:31,579
makes it easy to quit and build

320
00:11:29,410 --> 00:11:33,740
networked applications for embedded

321
00:11:31,580 --> 00:11:35,300
devices and so you have to write bright

322
00:11:33,740 --> 00:11:41,330
script in order to write applications

323
00:11:35,300 --> 00:11:42,709
for Roku and so you might be like and

324
00:11:41,330 --> 00:11:44,450
it's honestly like kind of interesting

325
00:11:42,710 --> 00:11:46,340
it's like a super weird language and I'm

326
00:11:44,450 --> 00:11:49,100
like I obviously love languages like

327
00:11:46,340 --> 00:11:50,800
this is the one year I'm not doing a

328
00:11:49,100 --> 00:11:54,800
talk on some programming language but

329
00:11:50,800 --> 00:11:56,209
this one essentially it's like very very

330
00:11:54,800 --> 00:11:57,740
nice right because not a lot of

331
00:11:56,210 --> 00:11:58,880
developers are developing for Roku

332
00:11:57,740 --> 00:12:01,250
devices you don't need that many

333
00:11:58,880 --> 00:12:02,450
developers abilities Roku devices but

334
00:12:01,250 --> 00:12:04,910
it's popular enough that you at least

335
00:12:02,450 --> 00:12:07,490
have things like weird glint errs for

336
00:12:04,910 --> 00:12:09,110
bright script reading and C++ by a

337
00:12:07,490 --> 00:12:12,620
company called willow tree apps you have

338
00:12:09,110 --> 00:12:14,210
companies like Viacom creating like for

339
00:12:12,620 --> 00:12:17,060
example ruby gems in order to build out

340
00:12:14,210 --> 00:12:19,220
Roku devices and so you even have like

341
00:12:17,060 --> 00:12:21,260
people like putting it in their give

342
00:12:19,220 --> 00:12:23,210
like a description and I just find this

343
00:12:21,260 --> 00:12:27,020
so funny it says yuck I don't know this

344
00:12:23,210 --> 00:12:29,270
guy is so-so but can it be that bad like

345
00:12:27,020 --> 00:12:31,670
he says yeah like is it yuck yes it is

346
00:12:29,270 --> 00:12:33,140
yuck so the loop counter is just as this

347
00:12:31,670 --> 00:12:34,579
is one example of the yuck you slip

348
00:12:33,140 --> 00:12:36,170
right script which I think could be its

349
00:12:34,580 --> 00:12:37,580
own separate talk not that I'm trying to

350
00:12:36,170 --> 00:12:40,160
hate on write script or anything like

351
00:12:37,580 --> 00:12:42,380
that but for example like loop counter

352
00:12:40,160 --> 00:12:44,089
stay in scope so you could probably so

353
00:12:42,380 --> 00:12:46,939
like for example I should be able to

354
00:12:44,090 --> 00:12:48,980
print this do something with I here it's

355
00:12:46,940 --> 00:12:51,440
gonna increment whatever 210 and then

356
00:12:48,980 --> 00:12:53,540
I'm gonna be able to not have to be able

357
00:12:51,440 --> 00:12:55,640
to reference I outside of this right

358
00:12:53,540 --> 00:12:57,199
well in bright script of course you get

359
00:12:55,640 --> 00:12:59,750
to reference I outside of that scope

360
00:12:57,200 --> 00:13:01,339
it's why not so you can imagine how many

361
00:12:59,750 --> 00:13:06,520
bugs like attribute of those kinds of

362
00:13:01,339 --> 00:13:08,810
things and then they have like this very

363
00:13:06,520 --> 00:13:10,550
imperative style programming with bright

364
00:13:08,810 --> 00:13:12,020
script but developer is really like

365
00:13:10,550 --> 00:13:13,490
declarative style programming where they

366
00:13:12,020 --> 00:13:16,460
just want to like almost have like maybe

367
00:13:13,490 --> 00:13:18,200
a react type program and essentially

368
00:13:16,460 --> 00:13:19,610
they don't give you anything like that

369
00:13:18,200 --> 00:13:22,130
but they give you something close with

370
00:13:19,610 --> 00:13:24,740
this thing called scene graph which is

371
00:13:22,130 --> 00:13:27,649
basically bright script with XML which

372
00:13:24,740 --> 00:13:30,320
just sounds wonderful doesn't it so this

373
00:13:27,649 --> 00:13:32,330
is this would be a hello world with the

374
00:13:30,320 --> 00:13:35,360
scene graph but you don't just get to do

375
00:13:32,330 --> 00:13:37,279
this you also still need to do bright

376
00:13:35,360 --> 00:13:38,810
script with it so it's really just

377
00:13:37,279 --> 00:13:42,200
wrapping more XML and bright script

378
00:13:38,810 --> 00:13:43,579
which is interesting and then a bright

379
00:13:42,200 --> 00:13:45,230
script itself is actually relatively

380
00:13:43,580 --> 00:13:46,730
full-featured I mean it doesn't have

381
00:13:45,230 --> 00:13:48,709
everything that you want in a language

382
00:13:46,730 --> 00:13:50,959
but the fact that this is a TCP server

383
00:13:48,709 --> 00:13:53,119
but I believe is asynchronous and bright

384
00:13:50,959 --> 00:13:54,260
script is pretty gnarly obviously

385
00:13:53,120 --> 00:13:56,270
they're not supposed to read this code

386
00:13:54,260 --> 00:13:59,180
but this is just more or less showing

387
00:13:56,270 --> 00:14:01,520
you that I could have an application

388
00:13:59,180 --> 00:14:03,979
loaded that is a full working TCP server

389
00:14:01,520 --> 00:14:06,110
asynchronous connections on a Roku

390
00:14:03,980 --> 00:14:08,029
device if I wanted it just kind of cool

391
00:14:06,110 --> 00:14:09,320
more than anything else and then it has

392
00:14:08,029 --> 00:14:12,050
a whole bunch of other features like

393
00:14:09,320 --> 00:14:13,339
built into the platform right so one of

394
00:14:12,050 --> 00:14:15,680
the more interesting ones that I'm just

395
00:14:13,339 --> 00:14:17,750
kind of pulling out here for example the

396
00:14:15,680 --> 00:14:19,790
microphone API so I can have access to

397
00:14:17,750 --> 00:14:21,529
the microphone because there's on my

398
00:14:19,790 --> 00:14:23,000
Roku remote there's a microphone

399
00:14:21,529 --> 00:14:24,740
there's just you know useful because I

400
00:14:23,000 --> 00:14:29,350
can be like hey Roku search for whatever

401
00:14:24,740 --> 00:14:32,660
right but we also have I can also create

402
00:14:29,350 --> 00:14:37,250
my own events for the external control

403
00:14:32,660 --> 00:14:39,589
API using the rro input IP I the URL

404
00:14:37,250 --> 00:14:42,740
transfer API so if I want to send

405
00:14:39,589 --> 00:14:44,420
something somewhere and then if I want

406
00:14:42,740 --> 00:14:47,390
to do any sort of open SSL encryption

407
00:14:44,420 --> 00:14:48,529
I have RSA there and so these kind of be

408
00:14:47,390 --> 00:14:50,390
put together in such an interesting kind

409
00:14:48,529 --> 00:14:52,339
of platform right where I could in

410
00:14:50,390 --> 00:14:55,329
theory just listen from your Roku remote

411
00:14:52,339 --> 00:14:57,890
and send that data anywhere I want right

412
00:14:55,329 --> 00:14:58,329
so like what does that give us though

413
00:14:57,890 --> 00:15:03,290
right

414
00:14:58,329 --> 00:15:07,279
in Roku I'm not allowed to listen to the

415
00:15:03,290 --> 00:15:09,649
microphone and less you allow it right

416
00:15:07,279 --> 00:15:10,880
so let's mix the attack kind of lame

417
00:15:09,649 --> 00:15:12,050
because all right they're always going

418
00:15:10,880 --> 00:15:14,149
to have to allow the microphone access

419
00:15:12,050 --> 00:15:15,589
right but we can totally get around that

420
00:15:14,149 --> 00:15:17,209
in the Roku settings if we just decided

421
00:15:15,589 --> 00:15:19,160
to go to settings privacy microphone

422
00:15:17,209 --> 00:15:21,109
channel microphone access and then

423
00:15:19,160 --> 00:15:22,370
select always allow which is super great

424
00:15:21,110 --> 00:15:27,110
because I can do this from the external

425
00:15:22,370 --> 00:15:28,490
control API automatically so like why is

426
00:15:27,110 --> 00:15:30,680
that even there I don't know like

427
00:15:28,490 --> 00:15:32,240
there's I believe this is like no real

428
00:15:30,680 --> 00:15:34,939
reason for this other than maybe make

429
00:15:32,240 --> 00:15:36,440
developers jobs easier but it doesn't

430
00:15:34,940 --> 00:15:38,140
even like add up doesn't make any sense

431
00:15:36,440 --> 00:15:41,350
here this should only be the maybe and

432
00:15:38,140 --> 00:15:43,300
oliver mode right so I can oh I can

433
00:15:41,350 --> 00:15:45,600
automate that and then just have always

434
00:15:43,300 --> 00:15:48,459
a la microphone access which is great

435
00:15:45,600 --> 00:15:50,560
but they even have like this crazy

436
00:15:48,460 --> 00:15:52,420
warning and their documentation and this

437
00:15:50,560 --> 00:15:53,709
is the only example of these kinds of

438
00:15:52,420 --> 00:15:56,290
crazy warnings and their documentation

439
00:15:53,710 --> 00:15:58,990
or their like do not use this feature if

440
00:15:56,290 --> 00:16:00,520
you're gonna like basically doing

441
00:15:58,990 --> 00:16:03,730
anything doing children or anything like

442
00:16:00,520 --> 00:16:05,199
that don't abuse this but like if I'm an

443
00:16:03,730 --> 00:16:07,120
attacker of course I'm gonna abuse it

444
00:16:05,200 --> 00:16:10,810
like that's just that's gonna happen so

445
00:16:07,120 --> 00:16:13,630
I don't I don't know so anyway so also

446
00:16:10,810 --> 00:16:16,300
if I did have the prompt there I can

447
00:16:13,630 --> 00:16:17,920
choose the prompt text so definitely

448
00:16:16,300 --> 00:16:20,589
nothing can go wrong there right like

449
00:16:17,920 --> 00:16:22,900
you must allow it right anyway so what

450
00:16:20,590 --> 00:16:25,450
else can we do so I'm trying to like

451
00:16:22,900 --> 00:16:26,980
I'll kind of expand upon the like Roku

452
00:16:25,450 --> 00:16:28,420
device attack surface like what are the

453
00:16:26,980 --> 00:16:31,390
things that are going on with it maybe

454
00:16:28,420 --> 00:16:33,790
things that might kind of spur you to go

455
00:16:31,390 --> 00:16:36,640
do this maybe a home go by a Roku device

456
00:16:33,790 --> 00:16:39,760
I don't know so what else can we do

457
00:16:36,640 --> 00:16:42,400
better cap is like the best for IOT

458
00:16:39,760 --> 00:16:44,230
hacking so a better cap is a

459
00:16:42,400 --> 00:16:46,930
man-in-the-middle framework originally

460
00:16:44,230 --> 00:16:48,250
written ruby was written and go like two

461
00:16:46,930 --> 00:16:51,060
years ago or something like that

462
00:16:48,250 --> 00:16:55,240
it's very very full-featured and

463
00:16:51,060 --> 00:16:57,550
including HTTP and HTTPS proxies where I

464
00:16:55,240 --> 00:16:59,650
think have arbitrary JavaScript be

465
00:16:57,550 --> 00:17:00,819
evaluated and do like neat things to

466
00:16:59,650 --> 00:17:04,030
each packet they're going through the

467
00:17:00,820 --> 00:17:05,560
proxy I can also just man in a little

468
00:17:04,030 --> 00:17:07,629
traffic and then like print out like

469
00:17:05,560 --> 00:17:11,109
what's going on in it so like this is an

470
00:17:07,630 --> 00:17:14,500
example of like when Hulu doesn't have

471
00:17:11,109 --> 00:17:16,060
network connectivity it'll display this

472
00:17:14,500 --> 00:17:18,180
error page and it'll be like hey blah

473
00:17:16,060 --> 00:17:20,889
blah blah can't get to the network

474
00:17:18,180 --> 00:17:23,140
here's this nice little image of a

475
00:17:20,890 --> 00:17:24,280
departing day thing which is this is

476
00:17:23,140 --> 00:17:28,000
what the image looks like so this is

477
00:17:24,280 --> 00:17:30,070
like the background of me like app right

478
00:17:28,000 --> 00:17:31,300
so I could just replace it with any

479
00:17:30,070 --> 00:17:33,040
other image that I want because it's

480
00:17:31,300 --> 00:17:36,940
just being served over HTTP and I

481
00:17:33,040 --> 00:17:38,920
literally just used the RTFM caplet from

482
00:17:36,940 --> 00:17:40,060
better cap if you go look at a better

483
00:17:38,920 --> 00:17:42,910
cap they have these things called

484
00:17:40,060 --> 00:17:44,590
caplets at caplets are basically almost

485
00:17:42,910 --> 00:17:47,230
like bash scripts for your better cap

486
00:17:44,590 --> 00:17:48,159
shell and so you can have all of the

487
00:17:47,230 --> 00:17:49,610
commands that you would run in your

488
00:17:48,160 --> 00:17:52,340
better cat run in a better cat

489
00:17:49,610 --> 00:17:53,570
session on a text file and then this was

490
00:17:52,340 --> 00:17:55,428
just one that I literally copied and

491
00:17:53,570 --> 00:17:59,870
pasted from github just to like find all

492
00:17:55,429 --> 00:18:01,220
of the network that was a network

493
00:17:59,870 --> 00:18:03,379
activity that was going through HTTP

494
00:18:01,220 --> 00:18:04,970
that was serving up a content type image

495
00:18:03,380 --> 00:18:06,710
and so I was just replacing it and

496
00:18:04,970 --> 00:18:09,530
serving up an image for my local disc

497
00:18:06,710 --> 00:18:11,660
which was this cat but something kind of

498
00:18:09,530 --> 00:18:14,090
interesting one I like I was thinking

499
00:18:11,660 --> 00:18:17,750
about this if we examine this is all

500
00:18:14,090 --> 00:18:20,059
white text and there is plenty of like

501
00:18:17,750 --> 00:18:22,160
room over here for a ransom notice or

502
00:18:20,059 --> 00:18:23,418
anything like that if we just had a

503
00:18:22,160 --> 00:18:25,549
white background and then some black

504
00:18:23,419 --> 00:18:27,440
text and like maybe a scary image and

505
00:18:25,549 --> 00:18:29,480
maybe you made it doesn't have to make a

506
00:18:27,440 --> 00:18:31,280
look at ransom notice like a scary one

507
00:18:29,480 --> 00:18:32,660
maybe it's just like hey rojulu we need

508
00:18:31,280 --> 00:18:34,010
you to do this thing in order to make

509
00:18:32,660 --> 00:18:35,809
the app work again or something like

510
00:18:34,010 --> 00:18:37,309
that you can get very creative but the

511
00:18:35,809 --> 00:18:42,020
way these kinds of applications are

512
00:18:37,309 --> 00:18:43,730
built another thing be firmware for the

513
00:18:42,020 --> 00:18:47,600
Roku is obviously an interesting like

514
00:18:43,730 --> 00:18:49,220
point of attack for this IOT if I go and

515
00:18:47,600 --> 00:18:51,770
update my Roku I can see that it's just

516
00:18:49,220 --> 00:18:53,270
hitting HTTP firmware dot Roku calm and

517
00:18:51,770 --> 00:18:55,250
just pulling down whatever version

518
00:18:53,270 --> 00:18:57,679
number that it wants and I apologize

519
00:18:55,250 --> 00:18:59,809
this does HTTP here I could have a

520
00:18:57,679 --> 00:19:02,210
better screenshot that's okay and then

521
00:18:59,809 --> 00:19:04,760
once I have that firmware that I just

522
00:19:02,210 --> 00:19:06,470
like you know just curled I can then run

523
00:19:04,760 --> 00:19:08,540
something like pin walk on it to start

524
00:19:06,470 --> 00:19:09,950
examining like what's inside of that

525
00:19:08,540 --> 00:19:11,418
firmware and I think I'm gonna run out

526
00:19:09,950 --> 00:19:13,940
of time if I try to go with too much

527
00:19:11,419 --> 00:19:15,140
into that so I didn't but you can see

528
00:19:13,940 --> 00:19:17,750
some really interesting artifacts just

529
00:19:15,140 --> 00:19:19,580
from this one bin walk here where we see

530
00:19:17,750 --> 00:19:21,770
there's this UNIX path and it says home

531
00:19:19,580 --> 00:19:23,570
builder old agent work blah blah blah

532
00:19:21,770 --> 00:19:24,679
there's bait but what and you see some

533
00:19:23,570 --> 00:19:26,120
interesting things here what there's

534
00:19:24,679 --> 00:19:28,520
actually and this is actually something

535
00:19:26,120 --> 00:19:29,899
that Roku they brag about they do a lot

536
00:19:28,520 --> 00:19:31,580
of continuous integration and things

537
00:19:29,900 --> 00:19:32,809
like that and so we can see it oh this

538
00:19:31,580 --> 00:19:34,580
is their build agent but they're using

539
00:19:32,809 --> 00:19:37,460
to like build out their next firmware

540
00:19:34,580 --> 00:19:38,510
release right and you can see there's

541
00:19:37,460 --> 00:19:41,720
some more interesting things in there

542
00:19:38,510 --> 00:19:42,830
like on my sequel em is a an index file

543
00:19:41,720 --> 00:19:46,669
it's interesting things you can go play

544
00:19:42,830 --> 00:19:48,860
around with but I haven't had that much

545
00:19:46,669 --> 00:19:51,169
success with bin walk thus far with my

546
00:19:48,860 --> 00:19:52,850
Roku firmware and I'm trying to figure

547
00:19:51,169 --> 00:19:54,950
that out like right now like how do I

548
00:19:52,850 --> 00:19:56,090
basically go about working with this

549
00:19:54,950 --> 00:19:59,800
firmware image because there seems to be

550
00:19:56,090 --> 00:20:03,350
some problems it's for arm using

551
00:19:59,800 --> 00:20:04,879
embedded Linux but that's all

552
00:20:03,350 --> 00:20:06,889
able to basically extract from it like

553
00:20:04,880 --> 00:20:08,539
all the file sync routes if you have any

554
00:20:06,890 --> 00:20:10,039
like ideas feel free to like reach out

555
00:20:08,539 --> 00:20:13,270
to me and I'm very interested because

556
00:20:10,039 --> 00:20:15,470
something I'm like doing ongoing um so

557
00:20:13,270 --> 00:20:17,418
if we don't want to just attack the the

558
00:20:15,470 --> 00:20:18,860
firmware maybe we just go around the

559
00:20:17,419 --> 00:20:19,820
entire thing we just go straight for the

560
00:20:18,860 --> 00:20:21,229
developers I know you're doing

561
00:20:19,820 --> 00:20:22,879
continuous integration and stuff like

562
00:20:21,230 --> 00:20:25,160
that right so I'll just go find your

563
00:20:22,880 --> 00:20:25,820
Jenkins servers that are online so

564
00:20:25,160 --> 00:20:28,100
that's good too

565
00:20:25,820 --> 00:20:30,830
this is using subdomain enumeration so

566
00:20:28,100 --> 00:20:32,990
Sub Zero is a project that's like a fork

567
00:20:30,830 --> 00:20:35,809
from a project that I was working on a

568
00:20:32,990 --> 00:20:38,090
sub Finder subdomain enumerations really

569
00:20:35,809 --> 00:20:39,500
really great and this is just like

570
00:20:38,090 --> 00:20:41,030
basically one way to go around the

571
00:20:39,500 --> 00:20:42,679
entire process so instead of like trying

572
00:20:41,030 --> 00:20:43,879
to go through with a throw coup device

573
00:20:42,679 --> 00:20:45,890
and then get into the firmware I do

574
00:20:43,880 --> 00:20:47,059
anything like that in theory you could

575
00:20:45,890 --> 00:20:49,520
just attack the developers that are

576
00:20:47,059 --> 00:20:50,928
building the firmware and you can go

577
00:20:49,520 --> 00:20:55,100
find some other things like staging

578
00:20:50,929 --> 00:20:56,780
stuff like that and that basically wraps

579
00:20:55,100 --> 00:21:06,168
up my talk if anyone has any questions

580
00:20:56,780 --> 00:21:07,940
I'll take them now but yeah they are in

581
00:21:06,169 --> 00:21:09,860
bright script I haven't been able to

582
00:21:07,940 --> 00:21:12,049
dump anything out no I haven't been able

583
00:21:09,860 --> 00:21:13,610
actually get an app from the Roku device

584
00:21:12,049 --> 00:21:18,110
and then like be able to reverse it or

585
00:21:13,610 --> 00:21:20,389
anything like that I mean so I don't

586
00:21:18,110 --> 00:21:21,408
think it's necessarily in the firm I

587
00:21:20,390 --> 00:21:24,320
don't know I don't think it's in the

588
00:21:21,409 --> 00:21:26,299
firmware but it's probably like on disk

589
00:21:24,320 --> 00:21:27,379
somewhere that have to access and like

590
00:21:26,299 --> 00:21:28,879
do some like just straight-up like

591
00:21:27,380 --> 00:21:30,200
hardware hacking to be able to like dump

592
00:21:28,880 --> 00:21:35,780
something that's meaningful I'm not sure

593
00:21:30,200 --> 00:21:37,370
that would be great now it would be

594
00:21:35,780 --> 00:21:39,049
possible to like basically replicate

595
00:21:37,370 --> 00:21:40,428
most of what Netflix is doing because a

596
00:21:39,049 --> 00:21:42,139
lot of these things are very simple like

597
00:21:40,429 --> 00:21:43,820
they're very simple applications so if I

598
00:21:42,140 --> 00:21:45,020
wanted to replicate it and Evan wanted

599
00:21:43,820 --> 00:21:48,139
to put that time into it I definitely

600
00:21:45,020 --> 00:21:49,940
think I could make a fake Netflix

601
00:21:48,140 --> 00:21:53,480
application enough to like do something

602
00:21:49,940 --> 00:21:56,049
harmful for sure but yeah anything else

603
00:21:53,480 --> 00:21:56,049
are we good yeah

604
00:21:58,290 --> 00:22:03,760
so most of the Roku's so I definitely

605
00:22:01,510 --> 00:22:04,570
don't recommend or condone or anything

606
00:22:03,760 --> 00:22:06,400
like that

607
00:22:04,570 --> 00:22:08,439
for a rope you devices that you don't

608
00:22:06,400 --> 00:22:10,270
own go buy your Opie device and do it on

609
00:22:08,440 --> 00:22:12,010
your own local network they're very very

610
00:22:10,270 --> 00:22:14,520
cheap when they like range different

611
00:22:12,010 --> 00:22:16,600
price ranges from like 20 to 50 bucks I

612
00:22:14,520 --> 00:22:18,639
haven't done anything but I have looked

613
00:22:16,600 --> 00:22:20,590
at things that are online more Roku

614
00:22:18,640 --> 00:22:23,049
devices are coming online they used to

615
00:22:20,590 --> 00:22:25,928
be every time I look at Roku devices on

616
00:22:23,049 --> 00:22:27,879
show Dan which is rather interesting but

617
00:22:25,929 --> 00:22:28,540
most of them aren't accessible like if

618
00:22:27,880 --> 00:22:31,960
I'm not mistaken

619
00:22:28,540 --> 00:22:35,290
last time I look there's 25 Roku devices

620
00:22:31,960 --> 00:22:37,900
that were accepting requests from the

621
00:22:35,290 --> 00:22:40,090
internet because they're built by

622
00:22:37,900 --> 00:22:41,890
default only to accept requests from

623
00:22:40,090 --> 00:22:42,939
your local network so if it's not your

624
00:22:41,890 --> 00:22:44,410
local network they're going to be like

625
00:22:42,940 --> 00:22:48,220
403 denied and that's what you'll see in

626
00:22:44,410 --> 00:22:49,940
the show damn thing too yeah so thank

627
00:22:48,220 --> 00:22:57,430
you Kevin

628
00:22:49,940 --> 00:22:57,430
[Applause]

