1
00:00:05,440 --> 00:00:10,800
oh thank everybody for coming to my talk

2
00:00:08,109 --> 00:00:12,910
my name is ed black I'm giving a talk on

3
00:00:10,800 --> 00:00:17,560
forensics for small to medium sized

4
00:00:12,910 --> 00:00:19,240
organizations now Who am I I am an

5
00:00:17,560 --> 00:00:21,220
institutional defender what that means

6
00:00:19,240 --> 00:00:24,009
if somebody pays me to defend their

7
00:00:21,220 --> 00:00:26,020
network and keep their users safe I've

8
00:00:24,009 --> 00:00:29,169
been doing this for 13 years mostly for

9
00:00:26,020 --> 00:00:30,399
small to medium sized businesses because

10
00:00:29,169 --> 00:00:32,529
of the nature of the small to medium

11
00:00:30,399 --> 00:00:34,300
sized businesses I am the IR guy I am

12
00:00:32,529 --> 00:00:36,250
the intelligence guy I'm the forensics

13
00:00:34,300 --> 00:00:37,750
guy I'm the threat hunter and then

14
00:00:36,250 --> 00:00:40,720
there's always other things they need me

15
00:00:37,750 --> 00:00:43,780
to do and a common theme in this talk is

16
00:00:40,720 --> 00:00:45,580
in organizations of this size time is

17
00:00:43,780 --> 00:00:46,870
always going to be a factor there's

18
00:00:45,580 --> 00:00:48,910
always going to be something else you

19
00:00:46,870 --> 00:00:50,470
need to do so you got to try to shoehorn

20
00:00:48,910 --> 00:00:56,709
forensics that are going to help the

21
00:00:50,470 --> 00:00:57,910
organization into that time frame so

22
00:00:56,710 --> 00:01:00,760
what we're looking at from a forensic

23
00:00:57,910 --> 00:01:02,769
standpoint are some key notes to

24
00:01:00,760 --> 00:01:05,019
highlight what the orga is going to need

25
00:01:02,770 --> 00:01:07,810
out of forensics what you're going to be

26
00:01:05,019 --> 00:01:09,850
able to do for that organization the big

27
00:01:07,810 --> 00:01:11,350
part of it is understanding what

28
00:01:09,850 --> 00:01:14,408
considerations need to be brought into

29
00:01:11,350 --> 00:01:17,259
play what do they need to have forensics

30
00:01:14,409 --> 00:01:19,359
done upon what will not need forensics

31
00:01:17,259 --> 00:01:21,340
done making sure that you have an

32
00:01:19,359 --> 00:01:23,249
environment built to do that forensics

33
00:01:21,340 --> 00:01:25,810
based on the needs of the organization

34
00:01:23,249 --> 00:01:27,939
making sure the organization has an

35
00:01:25,810 --> 00:01:29,829
understanding of what forensics is going

36
00:01:27,939 --> 00:01:33,068
to mean from a resource and time

37
00:01:29,829 --> 00:01:34,568
perspective and then at the end we're

38
00:01:33,069 --> 00:01:36,700
going to cover some high-level at the I

39
00:01:34,569 --> 00:01:37,990
had a very high-level free tools and

40
00:01:36,700 --> 00:01:40,060
there will be some references for

41
00:01:37,990 --> 00:01:41,589
digging into this a little bit more and

42
00:01:40,060 --> 00:01:44,590
in that situation we're going to focus

43
00:01:41,590 --> 00:01:46,149
on more GUI based tools things that are

44
00:01:44,590 --> 00:01:49,119
free downloads that'll be easier for

45
00:01:46,149 --> 00:01:50,649
people to get started with yes you have

46
00:01:49,119 --> 00:01:52,689
a lot better tools that operated a

47
00:01:50,649 --> 00:01:54,520
command line but this is a good way to

48
00:01:52,689 --> 00:01:57,958
ease in new people to forensics

49
00:01:54,520 --> 00:01:57,959
especially junior team members

50
00:02:00,280 --> 00:02:06,090
so why why do a talk on forensics

51
00:02:03,630 --> 00:02:09,669
specifically the small to medium-sized

52
00:02:06,090 --> 00:02:11,800
business level there's a very simple set

53
00:02:09,669 --> 00:02:12,399
up an alert comes in something has

54
00:02:11,800 --> 00:02:15,100
happened

55
00:02:12,400 --> 00:02:18,459
get it fixed get it patched image the

56
00:02:15,100 --> 00:02:19,989
box put it back from a business

57
00:02:18,459 --> 00:02:23,350
standpoint that's the fastest way to get

58
00:02:19,990 --> 00:02:24,910
up and running the issue is they don't

59
00:02:23,350 --> 00:02:28,810
quite understand how ordinary or how

60
00:02:24,910 --> 00:02:30,280
forensics fits into what they need if

61
00:02:28,810 --> 00:02:32,110
you keep getting hit with the same issue

62
00:02:30,280 --> 00:02:33,970
over and over and over again and you

63
00:02:32,110 --> 00:02:35,920
have to keep Reap atching end-users

64
00:02:33,970 --> 00:02:38,080
machines because they keep getting the

65
00:02:35,920 --> 00:02:39,600
same exploit in the browser or they keep

66
00:02:38,080 --> 00:02:42,160
clicking on the same link in an email

67
00:02:39,600 --> 00:02:44,079
yeah they can they can track a metric of

68
00:02:42,160 --> 00:02:46,450
well you got this machine back up and

69
00:02:44,080 --> 00:02:47,830
running an X amount of time as compared

70
00:02:46,450 --> 00:02:51,549
to what we know what caused the issue

71
00:02:47,830 --> 00:02:53,500
and if we patch this software plug this

72
00:02:51,550 --> 00:02:58,000
hole now we're not dealing with that

73
00:02:53,500 --> 00:03:00,790
anymore now the other problem we have

74
00:02:58,000 --> 00:03:03,310
when it comes to this is as technical

75
00:03:00,790 --> 00:03:06,010
people we get there's a time commitment

76
00:03:03,310 --> 00:03:08,110
to doing this most of leadership and

77
00:03:06,010 --> 00:03:09,609
anybody else in the business watches CSI

78
00:03:08,110 --> 00:03:12,610
cyber or NCIS

79
00:03:09,610 --> 00:03:16,239
Gibbs comes down Abby here's this laptop

80
00:03:12,610 --> 00:03:18,160
hacking the NSA within 45 minutes she's

81
00:03:16,239 --> 00:03:21,549
done it they have found the bad guy and

82
00:03:18,160 --> 00:03:23,560
everybody's going out for beers so there

83
00:03:21,549 --> 00:03:25,090
have been times I have faced and I'm

84
00:03:23,560 --> 00:03:27,430
sure other people who are in this space

85
00:03:25,090 --> 00:03:29,590
have done the same we think somebody has

86
00:03:27,430 --> 00:03:31,810
done something bad here is their laptop

87
00:03:29,590 --> 00:03:34,810
we need you to prove to legal by end of

88
00:03:31,810 --> 00:03:36,820
the day that was the case well what do

89
00:03:34,810 --> 00:03:38,709
you think they did we have no idea

90
00:03:36,820 --> 00:03:41,829
somebody reported something suspicious

91
00:03:38,709 --> 00:03:48,519
it did not trigger an alert you know be

92
00:03:41,829 --> 00:03:50,320
ready to brief Congress now in dealing

93
00:03:48,519 --> 00:03:54,040
with this one question that doesn't come

94
00:03:50,320 --> 00:03:56,470
up often enough is will the organization

95
00:03:54,040 --> 00:03:58,480
actually want to take this to court now

96
00:03:56,470 --> 00:04:00,579
we think going after a bad guy from a

97
00:03:58,480 --> 00:04:02,649
police standpoint but with small to

98
00:04:00,579 --> 00:04:04,630
medium sized orgs a lot of the issues

99
00:04:02,650 --> 00:04:07,480
that can come up deal with malicious

100
00:04:04,630 --> 00:04:08,680
insiders and maybe it's not criminal but

101
00:04:07,480 --> 00:04:12,790
it's something that could end up in

102
00:04:08,680 --> 00:04:13,720
civil court now ultimately we want to

103
00:04:12,790 --> 00:04:15,370
investigate

104
00:04:13,720 --> 00:04:18,070
everything as though we're going to sit

105
00:04:15,370 --> 00:04:20,440
in front of a jury the problem is with

106
00:04:18,070 --> 00:04:21,820
the time constraints whether or not

107
00:04:20,440 --> 00:04:25,300
they're going to want to take it to

108
00:04:21,820 --> 00:04:28,120
court can impact how you do forensics

109
00:04:25,300 --> 00:04:30,610
and whether or not certain steps along

110
00:04:28,120 --> 00:04:32,740
the lines of chain of custody you can

111
00:04:30,610 --> 00:04:34,120
skip ahead a little bit because you know

112
00:04:32,740 --> 00:04:37,030
you're not going to have to defend it

113
00:04:34,120 --> 00:04:39,430
now the caveat there as you will learn

114
00:04:37,030 --> 00:04:41,549
in time sometimes you and sometimes your

115
00:04:39,430 --> 00:04:43,720
organization doesn't get a vote

116
00:04:41,550 --> 00:04:45,820
if you're dealing with the malicious

117
00:04:43,720 --> 00:04:48,280
insider or some criminal who has done

118
00:04:45,820 --> 00:04:50,560
something publicly or if the FBI shows

119
00:04:48,280 --> 00:04:52,359
up and says hey we saw this beaconing

120
00:04:50,560 --> 00:04:55,090
coming from your system we need to

121
00:04:52,360 --> 00:04:57,280
examine something all of a sudden that

122
00:04:55,090 --> 00:04:58,690
could go up there and your organization

123
00:04:57,280 --> 00:05:01,059
may not want it and you're still sitting

124
00:04:58,690 --> 00:05:03,370
in a doc explain to 12 people and

125
00:05:01,060 --> 00:05:08,310
somebody up at the top of you what

126
00:05:03,370 --> 00:05:11,650
happened now looking at that question

127
00:05:08,310 --> 00:05:13,600
why would an organization not want to

128
00:05:11,650 --> 00:05:16,150
send it to court I mean from my

129
00:05:13,600 --> 00:05:18,340
standpoint we have a chance to get the

130
00:05:16,150 --> 00:05:20,020
bad guy in some situations we can

131
00:05:18,340 --> 00:05:24,159
actually identify who that bad guy is

132
00:05:20,020 --> 00:05:25,900
and trying to defend my network I want

133
00:05:24,160 --> 00:05:28,030
to make an example whether you're inside

134
00:05:25,900 --> 00:05:30,909
or outside er if you're going to bring

135
00:05:28,030 --> 00:05:32,950
trash at me I can find you I can stop

136
00:05:30,910 --> 00:05:36,190
you and I will hang you above the gate

137
00:05:32,950 --> 00:05:40,479
so everybody can see we can do that so

138
00:05:36,190 --> 00:05:42,760
from a business standpoint why not this

139
00:05:40,480 --> 00:05:44,980
is the clue and as I was discussing you

140
00:05:42,760 --> 00:05:46,719
the speaker dinner last night you

141
00:05:44,980 --> 00:05:50,250
probably have to be of a certain age to

142
00:05:46,720 --> 00:05:54,580
understand the clue so just bear with me

143
00:05:50,250 --> 00:05:56,500
this right here is why the company or or

144
00:05:54,580 --> 00:05:57,570
the institution may not want to go to

145
00:05:56,500 --> 00:06:01,590
court

146
00:05:57,570 --> 00:06:01,590
somebody from the audience helped me out

147
00:06:02,820 --> 00:06:06,760
there is no way I'm the oldest person in

148
00:06:05,590 --> 00:06:10,409
this room yes

149
00:06:06,760 --> 00:06:13,960
okay very specifically though thank you

150
00:06:10,410 --> 00:06:15,790
brand from Goonies mr. cable T Thanos

151
00:06:13,960 --> 00:06:18,729
over here his character was named brand

152
00:06:15,790 --> 00:06:21,669
and brand as soon as you bring the idea

153
00:06:18,730 --> 00:06:24,810
of brand into any discussion things

154
00:06:21,669 --> 00:06:24,810
start to get a little weird

155
00:06:25,250 --> 00:06:29,370
this is from an information security

156
00:06:27,599 --> 00:06:33,270
standpoint and going public the great

157
00:06:29,370 --> 00:06:35,189
inhibitor see when I look at the crown

158
00:06:33,270 --> 00:06:37,080
jewels of an institution I think of

159
00:06:35,189 --> 00:06:37,740
things like alright my domain

160
00:06:37,080 --> 00:06:40,409
controllers

161
00:06:37,740 --> 00:06:43,169
what file servers hold company secrets

162
00:06:40,409 --> 00:06:45,780
what systems are the priority systems

163
00:06:43,169 --> 00:06:47,789
what adds a service software do I need

164
00:06:45,780 --> 00:06:49,250
to worry about things that my human

165
00:06:47,789 --> 00:06:52,080
resources department might get to

166
00:06:49,250 --> 00:06:54,780
finance might get to this could go a

167
00:06:52,080 --> 00:06:56,969
step farther and be specific physical

168
00:06:54,780 --> 00:07:00,419
assets or areas in a given building or

169
00:06:56,969 --> 00:07:04,219
even key personnel you know from a risk

170
00:07:00,419 --> 00:07:06,508
standpoint if my CEO gets in a car and

171
00:07:04,219 --> 00:07:09,030
accidentally drives it off like Santa

172
00:07:06,509 --> 00:07:10,740
the bridge of San Francisco Bay it's

173
00:07:09,030 --> 00:07:12,299
going to hurt a little bit and there

174
00:07:10,740 --> 00:07:15,800
will be a financial impact in the

175
00:07:12,300 --> 00:07:18,419
investment markets for my corporation

176
00:07:15,800 --> 00:07:20,969
but if we think about how brand fits

177
00:07:18,419 --> 00:07:23,250
into this equation and how people think

178
00:07:20,969 --> 00:07:24,689
about a brand and how it affects how

179
00:07:23,250 --> 00:07:27,120
they feel and would do business with

180
00:07:24,689 --> 00:07:30,150
that brand we start to understand the

181
00:07:27,120 --> 00:07:37,789
mindset of leadership think about some

182
00:07:30,150 --> 00:07:41,008
popular brands Equifax Facebook Comcast

183
00:07:37,789 --> 00:07:44,659
Wells Fargo I mean from a brand

184
00:07:41,009 --> 00:07:48,810
standpoint the US Congress is a brand

185
00:07:44,659 --> 00:07:51,180
now I don't know about anybody else I

186
00:07:48,810 --> 00:07:53,430
don't get warm fuzzies when any of these

187
00:07:51,180 --> 00:07:54,990
names come up and if you work in the

188
00:07:53,430 --> 00:07:57,719
financial services in deal with Wells

189
00:07:54,990 --> 00:07:59,759
Fargo whose security is very shoddy but

190
00:07:57,719 --> 00:08:03,500
if you do business with them they demand

191
00:07:59,759 --> 00:08:07,800
yours is a plus you get especially

192
00:08:03,500 --> 00:08:09,060
little little hackles razor there now

193
00:08:07,800 --> 00:08:10,560
for the average defender when we think

194
00:08:09,060 --> 00:08:14,310
about the brand and we catch a bad guy

195
00:08:10,560 --> 00:08:16,889
our brand is strong we show the world

196
00:08:14,310 --> 00:08:19,889
that we can we can get the bad guy we

197
00:08:16,889 --> 00:08:22,919
can stop them we can take them down we

198
00:08:19,889 --> 00:08:24,599
are capable of defending our castle your

199
00:08:22,919 --> 00:08:28,109
efforts are going to require too many

200
00:08:24,599 --> 00:08:31,860
resources to try to take what we have go

201
00:08:28,110 --> 00:08:37,169
someplace else now to the rest of the

202
00:08:31,860 --> 00:08:40,240
world oh my god they've been breached

203
00:08:37,169 --> 00:08:44,110
we understand basic information security

204
00:08:40,240 --> 00:08:48,190
definitions an intrusion does not equal

205
00:08:44,110 --> 00:08:49,890
a breach depending on who you talk to or

206
00:08:48,190 --> 00:08:52,000
what's reported out in the world a

207
00:08:49,890 --> 00:08:53,880
reconnaissance scan against your

208
00:08:52,000 --> 00:08:57,700
perimeter means you have got an own

209
00:08:53,880 --> 00:08:58,780
people just don't know better and we

210
00:08:57,700 --> 00:09:02,680
live in a news cycle

211
00:08:58,780 --> 00:09:05,290
Koff bloomberg COFF where if a bad

212
00:09:02,680 --> 00:09:08,109
report goes out and a bunch of people

213
00:09:05,290 --> 00:09:10,689
start talking to it it doesn't need to

214
00:09:08,110 --> 00:09:13,240
be right as long as the voice is talking

215
00:09:10,690 --> 00:09:15,340
about it are the loudest so if they put

216
00:09:13,240 --> 00:09:18,010
a bad assumption out there that

217
00:09:15,340 --> 00:09:19,600
assumption gets spread people start to

218
00:09:18,010 --> 00:09:20,170
report on it people start to talk about

219
00:09:19,600 --> 00:09:23,470
it

220
00:09:20,170 --> 00:09:25,150
you can't put out that many fires then

221
00:09:23,470 --> 00:09:28,980
comes along Google and they will carve

222
00:09:25,150 --> 00:09:31,030
it into search history forever so now

223
00:09:28,980 --> 00:09:32,620
you're stuck trying to explain to

224
00:09:31,030 --> 00:09:34,930
leadership well this was really good we

225
00:09:32,620 --> 00:09:36,490
caught the bad guy well the world thinks

226
00:09:34,930 --> 00:09:38,589
we've lost everything and our stock

227
00:09:36,490 --> 00:09:40,420
price has just taken a dump we have

228
00:09:38,590 --> 00:09:42,870
accounts that are being pulled people

229
00:09:40,420 --> 00:09:45,209
don't want to do business with us and

230
00:09:42,870 --> 00:09:47,980
we're now faced with the problem that

231
00:09:45,210 --> 00:09:49,240
proving we're strong can be a detriment

232
00:09:47,980 --> 00:09:53,560
to what we're trying to do for the

233
00:09:49,240 --> 00:09:58,120
organization now the last where I'm

234
00:09:53,560 --> 00:10:00,520
going to say about brand if you do

235
00:09:58,120 --> 00:10:01,930
something make a report or put out any

236
00:10:00,520 --> 00:10:04,150
kind of information to feel you've

237
00:10:01,930 --> 00:10:06,520
defended your brand or made any kind of

238
00:10:04,150 --> 00:10:10,540
statement on your brand and it goes

239
00:10:06,520 --> 00:10:12,420
badly this creates the possibility of

240
00:10:10,540 --> 00:10:15,819
what we call a career limiting move

241
00:10:12,420 --> 00:10:18,280
if you tarnish the brand so bad publicly

242
00:10:15,820 --> 00:10:22,480
that it becomes repeated in a news cycle

243
00:10:18,280 --> 00:10:25,750
or goes down a shoot then turns into a

244
00:10:22,480 --> 00:10:28,720
resume generating event so understand

245
00:10:25,750 --> 00:10:30,220
this is very important sometimes more so

246
00:10:28,720 --> 00:10:33,330
than what you actually create at a

247
00:10:30,220 --> 00:10:37,060
company you as in the company royal you

248
00:10:33,330 --> 00:10:39,430
that that the perception Trump's the

249
00:10:37,060 --> 00:10:42,270
product if anybody's been to Burger King

250
00:10:39,430 --> 00:10:42,270
they understand this completely

251
00:10:43,120 --> 00:10:48,620
hurry now forensics I I enjoy forensics

252
00:10:46,610 --> 00:10:51,050
I like puzzles I like being able to

253
00:10:48,620 --> 00:10:52,610
figure out what the bad guy did so I can

254
00:10:51,050 --> 00:10:54,560
put a defense in place that I know is

255
00:10:52,610 --> 00:10:56,210
going to work for those of you who were

256
00:10:54,560 --> 00:10:58,280
in the previous talk that was in this

257
00:10:56,210 --> 00:11:00,590
room the idea is there's millions of

258
00:10:58,280 --> 00:11:03,319
vulnerabilities out patch the ones that

259
00:11:00,590 --> 00:11:04,820
hurt you right if I'm if I get a

260
00:11:03,320 --> 00:11:07,070
vulnerability because I have one server

261
00:11:04,820 --> 00:11:08,810
that has a bunch of lows tied to some

262
00:11:07,070 --> 00:11:11,270
product we have uninstalled but there

263
00:11:08,810 --> 00:11:14,599
are leftover registry keys patching

264
00:11:11,270 --> 00:11:17,750
those doesn't keep us safe forensics

265
00:11:14,600 --> 00:11:19,280
will help us identify what happened so I

266
00:11:17,750 --> 00:11:24,740
know what defense is to put in place to

267
00:11:19,280 --> 00:11:26,569
keep us safe the biggest part of

268
00:11:24,740 --> 00:11:29,090
forensics especially in a small and

269
00:11:26,570 --> 00:11:31,150
small to medium size org you need to

270
00:11:29,090 --> 00:11:33,500
understand what are you capable of doing

271
00:11:31,150 --> 00:11:36,970
what do your tool sets allow you to do

272
00:11:33,500 --> 00:11:40,340
what do your skill sets allow you to do

273
00:11:36,970 --> 00:11:44,300
so it is the the old adage spun for

274
00:11:40,340 --> 00:11:47,090
forensics what can you do what can't you

275
00:11:44,300 --> 00:11:49,579
do what needs to be done and you'll have

276
00:11:47,090 --> 00:11:51,230
to get help to have it done and can you

277
00:11:49,580 --> 00:11:53,590
tell the difference between those three

278
00:11:51,230 --> 00:11:53,590
things

279
00:11:54,220 --> 00:11:59,300
now from a overwhelming forensic

280
00:11:56,990 --> 00:12:02,270
viewpoint what can we apply the

281
00:11:59,300 --> 00:12:05,959
discipline of forensics do everything

282
00:12:02,270 --> 00:12:09,860
the simple act of existence creates a

283
00:12:05,960 --> 00:12:12,320
forensic marker at some level so we need

284
00:12:09,860 --> 00:12:16,040
to look at what do we need to examine

285
00:12:12,320 --> 00:12:19,460
what might we need to examine what part

286
00:12:16,040 --> 00:12:21,469
of that entity has to be examined how do

287
00:12:19,460 --> 00:12:29,870
we do that and what do we need to do

288
00:12:21,470 --> 00:12:32,660
that examination at a very one talk

289
00:12:29,870 --> 00:12:35,360
oversimplified level it breaks down to

290
00:12:32,660 --> 00:12:38,480
two things in a digital world you either

291
00:12:35,360 --> 00:12:40,580
have a forensic marker left on a device

292
00:12:38,480 --> 00:12:42,740
or something that has been captured

293
00:12:40,580 --> 00:12:46,070
traveling over a network it's the other

294
00:12:42,740 --> 00:12:48,140
thing or a communication from that

295
00:12:46,070 --> 00:12:50,870
standpoint we can gather a lot of

296
00:12:48,140 --> 00:12:52,270
information if we understand where in

297
00:12:50,870 --> 00:12:54,890
those two buckets were going to fall

298
00:12:52,270 --> 00:12:56,360
from a device standpoint a workstation

299
00:12:54,890 --> 00:12:59,480
server's mobile device

300
00:12:56,360 --> 00:13:01,399
is you know the the network gear will

301
00:12:59,480 --> 00:13:04,310
all have something some forensic

302
00:13:01,399 --> 00:13:06,950
instance on its system in itself

303
00:13:04,310 --> 00:13:08,869
whenever something happens whether it's

304
00:13:06,950 --> 00:13:10,519
good or whether it's bad there's always

305
00:13:08,870 --> 00:13:13,040
a remainder of somebody connecting a

306
00:13:10,519 --> 00:13:17,779
command being run a configuration being

307
00:13:13,040 --> 00:13:21,260
changed for us to break it down into

308
00:13:17,779 --> 00:13:25,189
three buckets further you know we have

309
00:13:21,260 --> 00:13:27,680
the disk memory and logs you know if you

310
00:13:25,190 --> 00:13:29,930
look at how data has been written to

311
00:13:27,680 --> 00:13:32,660
this device how things run on the device

312
00:13:29,930 --> 00:13:35,540
how the system tracks what has happened

313
00:13:32,660 --> 00:13:37,189
on the device those principles will all

314
00:13:35,540 --> 00:13:40,699
fall into one of these three buckets and

315
00:13:37,190 --> 00:13:45,320
every one of these can then be mine to

316
00:13:40,700 --> 00:13:48,440
be forensic ly analyzed now in motion

317
00:13:45,320 --> 00:13:49,790
we're on the wire so that's any of the

318
00:13:48,440 --> 00:13:52,339
communications that travels back and

319
00:13:49,790 --> 00:13:53,990
forth between your system and another

320
00:13:52,339 --> 00:13:57,170
entity whether that entity is your

321
00:13:53,990 --> 00:14:00,709
system your user somebody else what have

322
00:13:57,170 --> 00:14:02,420
you at a very high level once again it

323
00:14:00,709 --> 00:14:04,430
breaks down into two buckets you either

324
00:14:02,420 --> 00:14:06,709
get the full packet capture the absolute

325
00:14:04,430 --> 00:14:09,310
complete transmission of data between

326
00:14:06,709 --> 00:14:13,579
two systems and then you have net flow

327
00:14:09,310 --> 00:14:15,439
which in short order is metadata it's

328
00:14:13,579 --> 00:14:17,810
not what is transferred between systems

329
00:14:15,440 --> 00:14:21,980
it's what were the systems in each end

330
00:14:17,810 --> 00:14:23,390
how much data was transferred what ports

331
00:14:21,980 --> 00:14:25,160
were being used what protocols were

332
00:14:23,390 --> 00:14:31,850
being used and how big of a transmission

333
00:14:25,160 --> 00:14:34,130
was it now logs a lot of people I have

334
00:14:31,850 --> 00:14:35,300
logging in my organization sometimes

335
00:14:34,130 --> 00:14:37,610
this gets forgotten if you're not

336
00:14:35,300 --> 00:14:40,069
shipping it off to a bucket a sip a log

337
00:14:37,610 --> 00:14:41,870
collector at some point and an

338
00:14:40,070 --> 00:14:44,410
adversaries on their device it doesn't

339
00:14:41,870 --> 00:14:47,180
take much for them to flush those logs

340
00:14:44,410 --> 00:14:49,279
now when you go back and look and see

341
00:14:47,180 --> 00:14:50,630
logs are missing okay that's a sign

342
00:14:49,279 --> 00:14:53,029
something shouldn't have happened here

343
00:14:50,630 --> 00:14:54,170
but would you rather see that something

344
00:14:53,029 --> 00:14:56,120
happened that shouldn't have happened

345
00:14:54,170 --> 00:14:58,689
versus here's all the bad things that

346
00:14:56,120 --> 00:15:01,970
did happen on a given device or system

347
00:14:58,690 --> 00:15:03,649
and when you ship them off make sure

348
00:15:01,970 --> 00:15:04,910
wherever you're shipping them had some

349
00:15:03,649 --> 00:15:07,069
of the strongest permissions in the

350
00:15:04,910 --> 00:15:08,930
environment I have seen on more than one

351
00:15:07,069 --> 00:15:10,400
occasion all we ship them off to our sim

352
00:15:08,930 --> 00:15:12,859
well adversary on the

353
00:15:10,400 --> 00:15:14,510
Vox can see alright netstat shows are

354
00:15:12,860 --> 00:15:16,370
all going to this a whole bunch of

355
00:15:14,510 --> 00:15:19,580
traffic to this system I'm gonna go to

356
00:15:16,370 --> 00:15:21,050
that system it's a log aggregator they

357
00:15:19,580 --> 00:15:23,720
didn't lock down the permissions I can

358
00:15:21,050 --> 00:15:29,660
flush the log aggregator and then even

359
00:15:23,720 --> 00:15:32,270
off-site storage isn't going to help so

360
00:15:29,660 --> 00:15:34,640
when doing forensics says three places

361
00:15:32,270 --> 00:15:36,520
that in small to medium sized orgs you

362
00:15:34,640 --> 00:15:40,069
can find the biggest bang for your buck

363
00:15:36,520 --> 00:15:42,230
to get forensic information that is

364
00:15:40,070 --> 00:15:43,670
going to be of value that will be abused

365
00:15:42,230 --> 00:15:49,490
to the institution that you'll be

366
00:15:43,670 --> 00:15:50,900
allowed to use and those are the system

367
00:15:49,490 --> 00:15:52,930
event logs what has happened on the

368
00:15:50,900 --> 00:15:56,810
system in what order did that happen and

369
00:15:52,930 --> 00:16:00,290
what caused a to happen did a spawn beef

370
00:15:56,810 --> 00:16:02,719
so on and so forth who spawned a who

371
00:16:00,290 --> 00:16:04,520
spawned be on that system and that

372
00:16:02,720 --> 00:16:07,340
workflow logs what is what is everything

373
00:16:04,520 --> 00:16:09,890
communicating with why how much data is

374
00:16:07,340 --> 00:16:11,630
it sending from point A to point B is it

375
00:16:09,890 --> 00:16:16,090
using protocols or ports that seem

376
00:16:11,630 --> 00:16:18,470
unusual and then three browser history

377
00:16:16,090 --> 00:16:20,840
this is a little bit of bias of mine I

378
00:16:18,470 --> 00:16:23,870
do a lot of work that is more policeman

379
00:16:20,840 --> 00:16:25,400
than defender compliance will want to

380
00:16:23,870 --> 00:16:27,140
make sure people are doing things that

381
00:16:25,400 --> 00:16:29,600
they're supposed to be doing and not

382
00:16:27,140 --> 00:16:32,540
doing things they shouldn't and the

383
00:16:29,600 --> 00:16:35,990
browser history becomes a very easy way

384
00:16:32,540 --> 00:16:37,370
to check out in that anybody who's

385
00:16:35,990 --> 00:16:39,050
looked at firewall logs you have a

386
00:16:37,370 --> 00:16:41,480
pretty good idea of what your users are

387
00:16:39,050 --> 00:16:42,469
doing whether or not you want to if you

388
00:16:41,480 --> 00:16:46,750
actually take a look at the browser

389
00:16:42,470 --> 00:16:46,750
history you'll just pluck your eyes out

390
00:16:46,780 --> 00:16:52,579
so system event logs this is basically

391
00:16:49,850 --> 00:16:55,040
the what happened by who in what order

392
00:16:52,580 --> 00:16:56,540
on a box if you work with Windows you

393
00:16:55,040 --> 00:17:00,469
know the magic number forty six eighty

394
00:16:56,540 --> 00:17:01,760
eight this is the command line logs

395
00:17:00,470 --> 00:17:05,839
where it tells you what commands were

396
00:17:01,760 --> 00:17:10,819
run on a given system in other systems

397
00:17:05,839 --> 00:17:12,260
Mac Linux even set up on Cisco devices

398
00:17:10,819 --> 00:17:14,839
if you enable it you can get a running

399
00:17:12,260 --> 00:17:16,849
command history that I'll tell you what

400
00:17:14,839 --> 00:17:20,560
ran in what order so you can get an idea

401
00:17:16,849 --> 00:17:20,560
of what happened on a given system

402
00:17:20,730 --> 00:17:26,010
so all of these may not have turned it

403
00:17:23,190 --> 00:17:28,080
turning into your rosetta stone because

404
00:17:26,010 --> 00:17:29,310
you can look at what happened and then

405
00:17:28,079 --> 00:17:32,879
this will allow you to pivot to other

406
00:17:29,310 --> 00:17:34,830
systems I know a command ran remotely at

407
00:17:32,880 --> 00:17:37,200
a given time well now I know to look at

408
00:17:34,830 --> 00:17:40,199
net flow to that box at that time where

409
00:17:37,200 --> 00:17:42,150
did the command come from or if I see a

410
00:17:40,200 --> 00:17:45,000
script run that was launched by a

411
00:17:42,150 --> 00:17:47,340
service all right when did that service

412
00:17:45,000 --> 00:17:49,080
start who started the service and you

413
00:17:47,340 --> 00:17:51,659
can work and build out your timeline of

414
00:17:49,080 --> 00:17:53,520
events to help you get back to what

415
00:17:51,660 --> 00:17:59,220
started at all so you know ultimately

416
00:17:53,520 --> 00:18:02,639
what you need to defend now here's a

417
00:17:59,220 --> 00:18:06,050
caveat on these command histories at its

418
00:18:02,640 --> 00:18:09,440
core 46 88 in Windows will log

419
00:18:06,050 --> 00:18:11,639
powershell exe ran at this time the end

420
00:18:09,440 --> 00:18:15,030
now that will help because we see

421
00:18:11,640 --> 00:18:17,070
powershell ran and then w script ran or

422
00:18:15,030 --> 00:18:19,800
command ran into powershell or that's

423
00:18:17,070 --> 00:18:22,080
one from chrome it's very helpful to

424
00:18:19,800 --> 00:18:26,159
know what's going on you need to enable

425
00:18:22,080 --> 00:18:28,290
full auditing on 46 88 also on Cisco

426
00:18:26,160 --> 00:18:29,910
devices several other devices require

427
00:18:28,290 --> 00:18:32,129
you to do more than just say turn on the

428
00:18:29,910 --> 00:18:34,080
logs or log this event you know for the

429
00:18:32,130 --> 00:18:36,630
full command line auditing which will

430
00:18:34,080 --> 00:18:38,970
then give you okay PowerShell ran this

431
00:18:36,630 --> 00:18:42,060
specific script it was encoded no bypass

432
00:18:38,970 --> 00:18:44,070
no user interaction base64 string I need

433
00:18:42,060 --> 00:18:47,520
to decode right you can look and see

434
00:18:44,070 --> 00:18:49,050
this w script ran that once again if I

435
00:18:47,520 --> 00:18:51,240
decode what the you know the trailing

436
00:18:49,050 --> 00:18:52,680
part of that I can see the switches I

437
00:18:51,240 --> 00:18:55,260
can see where tried to pull something

438
00:18:52,680 --> 00:18:56,910
down from the internet this helps speed

439
00:18:55,260 --> 00:18:59,910
up any other pivot points of your

440
00:18:56,910 --> 00:19:01,410
detection to try to see alright this is

441
00:18:59,910 --> 00:19:07,470
what happened and this is what I need to

442
00:19:01,410 --> 00:19:09,510
clean up all right Network flow logs as

443
00:19:07,470 --> 00:19:11,340
I've said the the advantage of starting

444
00:19:09,510 --> 00:19:14,340
with metadata versus looking straight at

445
00:19:11,340 --> 00:19:16,770
the full packet capture is huge from a

446
00:19:14,340 --> 00:19:19,169
size standpoint how much information is

447
00:19:16,770 --> 00:19:22,530
in the packet versus what is in the net

448
00:19:19,170 --> 00:19:24,120
flow is a huge difference if you're

449
00:19:22,530 --> 00:19:25,770
starting to take a look at what happened

450
00:19:24,120 --> 00:19:27,270
where and just try to build that

451
00:19:25,770 --> 00:19:29,520
communication timeline so you can get

452
00:19:27,270 --> 00:19:31,350
further pivot points to investigate to

453
00:19:29,520 --> 00:19:35,360
understand forensically what happened in

454
00:19:31,350 --> 00:19:37,320
a given event alert intrusion

455
00:19:35,360 --> 00:19:39,659
NetFlow is something you can search

456
00:19:37,320 --> 00:19:41,189
through a heck of a lot easier and the

457
00:19:39,660 --> 00:19:43,620
nice thing is the way NetFlow is broken

458
00:19:41,190 --> 00:19:45,059
down in a standardized format it doesn't

459
00:19:43,620 --> 00:19:47,100
take much to go in and do a text search

460
00:19:45,059 --> 00:19:49,649
on these logs to be able to carve out

461
00:19:47,100 --> 00:19:50,969
individual pieces so I can say alright

462
00:19:49,650 --> 00:19:53,580
I'm just looking for things at a given

463
00:19:50,970 --> 00:19:54,720
IP address all right from there I can do

464
00:19:53,580 --> 00:19:56,520
another cut to say all right what

465
00:19:54,720 --> 00:19:57,900
protocols happen look at time frames

466
00:19:56,520 --> 00:20:00,450
something happened at this time in this

467
00:19:57,900 --> 00:20:02,720
date and from there you can say all

468
00:20:00,450 --> 00:20:04,770
right if I can identify this traffic

469
00:20:02,720 --> 00:20:07,500
happened at this time between these

470
00:20:04,770 --> 00:20:08,639
systems now I can either pivot and go

471
00:20:07,500 --> 00:20:10,950
look at what happened on the previous

472
00:20:08,640 --> 00:20:13,020
system or if you're collecting your full

473
00:20:10,950 --> 00:20:14,309
packet capture that's the point you go

474
00:20:13,020 --> 00:20:16,470
in and say all right I know the traffic

475
00:20:14,309 --> 00:20:22,770
at this time between these points is

476
00:20:16,470 --> 00:20:25,590
what I need to look at now we get into

477
00:20:22,770 --> 00:20:28,080
browser history as I've said this

478
00:20:25,590 --> 00:20:31,290
usually comes up through legal

479
00:20:28,080 --> 00:20:33,840
compliance governance somebody checking

480
00:20:31,290 --> 00:20:35,100
out what the employees are doing so it

481
00:20:33,840 --> 00:20:37,830
gives me a little rash for any

482
00:20:35,100 --> 00:20:39,030
battlestar galactica fans a Damas idea

483
00:20:37,830 --> 00:20:41,428
of the difference between a soldier and

484
00:20:39,030 --> 00:20:43,410
a policeman myself as in defender is

485
00:20:41,429 --> 00:20:44,970
more of a soldier I would love to be

486
00:20:43,410 --> 00:20:47,549
able to give compliance access to go be

487
00:20:44,970 --> 00:20:49,350
the policeman from a technical

488
00:20:47,549 --> 00:20:55,139
standpoint I get to be the bad guy on

489
00:20:49,350 --> 00:20:56,699
both ends with the browser history a lot

490
00:20:55,140 --> 00:20:59,580
of tools that will let you look at this

491
00:20:56,700 --> 00:21:02,010
will show you is if you look at the

492
00:20:59,580 --> 00:21:03,449
browser history going back you have all

493
00:21:02,010 --> 00:21:06,299
right is this something user clicked on

494
00:21:03,450 --> 00:21:07,770
how did they get to a given page is this

495
00:21:06,299 --> 00:21:09,450
something that was buried in a bunch of

496
00:21:07,770 --> 00:21:12,809
ads loading when they first went to

497
00:21:09,450 --> 00:21:14,580
nfl.com it gives you a chance to look a

498
00:21:12,809 --> 00:21:17,730
little bit deeper see how much of that

499
00:21:14,580 --> 00:21:19,320
communication was there see and some of

500
00:21:17,730 --> 00:21:25,350
the tools see upload see download see

501
00:21:19,320 --> 00:21:27,178
how many times they visited this site so

502
00:21:25,350 --> 00:21:30,719
as I mentioned with disappearing logs

503
00:21:27,179 --> 00:21:33,840
and evidence that is removed the absence

504
00:21:30,720 --> 00:21:36,000
of evidence by definition can be the

505
00:21:33,840 --> 00:21:38,070
metadata of evidence we may not know

506
00:21:36,000 --> 00:21:40,290
exactly what happened but we know

507
00:21:38,070 --> 00:21:42,689
something happened either there's a

508
00:21:40,290 --> 00:21:44,928
configuration issue on a system or

509
00:21:42,690 --> 00:21:47,970
somebody's trying to cover their tracks

510
00:21:44,929 --> 00:21:50,370
now a couple of examples

511
00:21:47,970 --> 00:21:51,660
our one user could have been caught

512
00:21:50,370 --> 00:21:53,699
doing something they shouldn't been

513
00:21:51,660 --> 00:21:57,150
doing from an insider standpoint maybe

514
00:21:53,700 --> 00:21:59,610
they were looking to take private IP and

515
00:21:57,150 --> 00:22:00,990
take it to a new employer with it well

516
00:21:59,610 --> 00:22:02,909
eventually that user is caught now

517
00:22:00,990 --> 00:22:04,500
somebody else is doing the same thing

518
00:22:02,910 --> 00:22:06,750
might realize hey I don't want to be

519
00:22:04,500 --> 00:22:09,510
caught doing that all of a sudden when

520
00:22:06,750 --> 00:22:11,280
we investigate that user despite working

521
00:22:09,510 --> 00:22:12,870
and doing business regularly they

522
00:22:11,280 --> 00:22:14,730
haven't used a web browser in a month

523
00:22:12,870 --> 00:22:16,469
according to the weather the records

524
00:22:14,730 --> 00:22:18,930
they haven't made a phone call on their

525
00:22:16,470 --> 00:22:20,580
mobile device in two weeks they haven't

526
00:22:18,930 --> 00:22:23,250
received any text they haven't used it

527
00:22:20,580 --> 00:22:26,220
to look at email ultimately we're not

528
00:22:23,250 --> 00:22:27,840
going to know what they're doing but the

529
00:22:26,220 --> 00:22:29,370
idea that somebody who works in my

530
00:22:27,840 --> 00:22:35,699
institution isn't using any of their

531
00:22:29,370 --> 00:22:37,169
electronic devices throws a flag up so

532
00:22:35,700 --> 00:22:41,370
now we're going to talk about the

533
00:22:37,170 --> 00:22:42,930
tooling in a forensic environment now

534
00:22:41,370 --> 00:22:44,520
the rule is at a small medium-sized

535
00:22:42,930 --> 00:22:46,890
business every dollar counts and you're

536
00:22:44,520 --> 00:22:48,980
fighting just to get the money to have a

537
00:22:46,890 --> 00:22:51,990
proper management system in some cases

538
00:22:48,980 --> 00:22:53,730
the money never shows up as needed until

539
00:22:51,990 --> 00:22:55,320
something really bad has happened and

540
00:22:53,730 --> 00:22:57,450
when something really bad has happened

541
00:22:55,320 --> 00:22:59,189
they're paying a lot of money to

542
00:22:57,450 --> 00:23:00,360
somebody who's not you to come in from

543
00:22:59,190 --> 00:23:05,220
the outside with all the really cool

544
00:23:00,360 --> 00:23:06,449
tool tools and do the looking so as you

545
00:23:05,220 --> 00:23:08,580
look at what tools you're going to be

546
00:23:06,450 --> 00:23:10,860
able to put to use to help build out

547
00:23:08,580 --> 00:23:14,100
these root cause analyses so that you

548
00:23:10,860 --> 00:23:16,379
can better defend your institution we're

549
00:23:14,100 --> 00:23:18,000
probably going to look at free because

550
00:23:16,380 --> 00:23:20,760
we're fortunate that as far as free

551
00:23:18,000 --> 00:23:23,190
tooling goes in the defense forensics

552
00:23:20,760 --> 00:23:25,890
and Incident Response pays we have some

553
00:23:23,190 --> 00:23:27,450
of the best tools written by some of the

554
00:23:25,890 --> 00:23:30,900
more dedicated people who keep them

555
00:23:27,450 --> 00:23:33,030
updated but when doing any of these

556
00:23:30,900 --> 00:23:36,720
investigations with the idea that there

557
00:23:33,030 --> 00:23:38,250
is an adversary potentially inside we

558
00:23:36,720 --> 00:23:42,060
can talk about the secret weapon and

559
00:23:38,250 --> 00:23:43,980
that is my little notebook whenever I'm

560
00:23:42,060 --> 00:23:45,679
doing an investigation that could be

561
00:23:43,980 --> 00:23:49,020
something I need to rely on later

562
00:23:45,680 --> 00:23:50,490
especially knowing that the the golden

563
00:23:49,020 --> 00:23:52,020
ticket for an adversary is to be on the

564
00:23:50,490 --> 00:23:54,930
communication system so they'd get your

565
00:23:52,020 --> 00:23:56,879
slack your email you know they see hey

566
00:23:54,930 --> 00:23:58,470
there's a phone conference being spun up

567
00:23:56,880 --> 00:24:00,960
because there's something going on and I

568
00:23:58,470 --> 00:24:02,310
need to know if I made

569
00:24:00,960 --> 00:24:04,800
oh look there's a conference number

570
00:24:02,310 --> 00:24:06,720
there's the dialing any communications

571
00:24:04,800 --> 00:24:09,180
you set to try to clear out whatever's

572
00:24:06,720 --> 00:24:10,800
going on any emails that have your notes

573
00:24:09,180 --> 00:24:13,680
if you're posting documentation to a

574
00:24:10,800 --> 00:24:16,620
wiki or a ticket management system bad

575
00:24:13,680 --> 00:24:18,060
guy can potentially see all of us unless

576
00:24:16,620 --> 00:24:19,889
these tinkerer SEC walking out of your

577
00:24:18,060 --> 00:24:21,810
your server closet with your domain

578
00:24:19,890 --> 00:24:23,340
controller nobody's going to come see

579
00:24:21,810 --> 00:24:24,960
that notebook right

580
00:24:23,340 --> 00:24:26,459
ultimately you're still going to use

581
00:24:24,960 --> 00:24:29,370
electronic communications but it's

582
00:24:26,460 --> 00:24:32,720
easier to keep anything sensitive

583
00:24:29,370 --> 00:24:35,939
limited to an eyes-only physical medium

584
00:24:32,720 --> 00:24:37,650
plus should you ultimately have to go to

585
00:24:35,940 --> 00:24:40,680
court in one of those you don't get a

586
00:24:37,650 --> 00:24:42,270
vote cases now this may be your first

587
00:24:40,680 --> 00:24:43,650
time a handful of times are sitting

588
00:24:42,270 --> 00:24:45,360
there because usually it's outside

589
00:24:43,650 --> 00:24:46,980
forensic groups that are brought in but

590
00:24:45,360 --> 00:24:50,219
if you're the initial incident responder

591
00:24:46,980 --> 00:24:52,410
you may end up in that box and it is the

592
00:24:50,220 --> 00:24:53,670
weather it is the defense attorney or

593
00:24:52,410 --> 00:24:56,730
the person on the other side of the

594
00:24:53,670 --> 00:24:59,790
civil litigation that attorneys job is

595
00:24:56,730 --> 00:25:02,910
to rip you to pieces rightly or wrongly

596
00:24:59,790 --> 00:25:04,649
if they can get 12 people to believe or

597
00:25:02,910 --> 00:25:09,540
in a civil case seven people to believe

598
00:25:04,650 --> 00:25:11,250
you've screwed up they win so one of the

599
00:25:09,540 --> 00:25:12,930
goals of that notebook is you only put

600
00:25:11,250 --> 00:25:15,330
things related to that investigation in

601
00:25:12,930 --> 00:25:17,430
that notebook so if people start talking

602
00:25:15,330 --> 00:25:18,720
about other things that could happen or

603
00:25:17,430 --> 00:25:20,820
say I want full discoveries like it's

604
00:25:18,720 --> 00:25:23,040
all right here oh you know from that

605
00:25:20,820 --> 00:25:24,870
discovery standpoint legally everything

606
00:25:23,040 --> 00:25:26,879
I've done is in that notebook and then

607
00:25:24,870 --> 00:25:28,530
email communications are usually tagged

608
00:25:26,880 --> 00:25:30,750
in a certain way so Leal can pull those

609
00:25:28,530 --> 00:25:33,360
you don't want it mixed with other notes

610
00:25:30,750 --> 00:25:35,400
where potentially you are not as careful

611
00:25:33,360 --> 00:25:37,110
with your language or your shorthand or

612
00:25:35,400 --> 00:25:38,340
or you're referring to something else

613
00:25:37,110 --> 00:25:41,899
that happened that they could try to use

614
00:25:38,340 --> 00:25:44,070
to discredit you or your organization

615
00:25:41,900 --> 00:25:47,580
now as we talk about the free tools

616
00:25:44,070 --> 00:25:49,740
digitally there's a rule there's the

617
00:25:47,580 --> 00:25:52,710
free beer rule versus the free puppies

618
00:25:49,740 --> 00:25:55,950
rule free beer is great I popped the cap

619
00:25:52,710 --> 00:25:57,990
I take a drink it's easy it's done free

620
00:25:55,950 --> 00:26:00,180
puppies somebody has given me a puppy

621
00:25:57,990 --> 00:26:01,680
this is great I need to house-train it I

622
00:26:00,180 --> 00:26:03,870
need to spend time with it I need to see

623
00:26:01,680 --> 00:26:05,580
it gets its shots ultimately there will

624
00:26:03,870 --> 00:26:08,040
be both a time and money commitment

625
00:26:05,580 --> 00:26:10,800
involved even though it's defined as

626
00:26:08,040 --> 00:26:12,870
free now with a lot of these tool sets

627
00:26:10,800 --> 00:26:13,740
somebody can put something out there and

628
00:26:12,870 --> 00:26:15,780
they like

629
00:26:13,740 --> 00:26:17,070
I have done something good I am done and

630
00:26:15,780 --> 00:26:19,139
because they're not getting paid for

631
00:26:17,070 --> 00:26:21,330
these things might not get updated so

632
00:26:19,140 --> 00:26:23,250
over time perhaps you're upgrading from

633
00:26:21,330 --> 00:26:26,220
windows 7 to 10 do these free tools

634
00:26:23,250 --> 00:26:28,950
still work their browser version changes

635
00:26:26,220 --> 00:26:30,570
does it still work was a bug or a coding

636
00:26:28,950 --> 00:26:34,560
error found in there and then it just

637
00:26:30,570 --> 00:26:38,850
never got updated now when it comes to

638
00:26:34,560 --> 00:26:41,190
any of these free tools how do you get

639
00:26:38,850 --> 00:26:41,820
to Carnegie Hall practice practice

640
00:26:41,190 --> 00:26:44,070
practice

641
00:26:41,820 --> 00:26:45,870
if you have a forensic investigation

642
00:26:44,070 --> 00:26:48,389
that needs to happen or something comes

643
00:26:45,870 --> 00:26:50,489
up and you have I've got this browser

644
00:26:48,390 --> 00:26:52,650
tool I can take a look at it I can pull

645
00:26:50,490 --> 00:26:54,690
down memory from an affected system I

646
00:26:52,650 --> 00:26:56,850
have a toolset that will automate my

647
00:26:54,690 --> 00:26:58,110
search of a registry or file system look

648
00:26:56,850 --> 00:27:00,419
at the permissions of the events and see

649
00:26:58,110 --> 00:27:01,830
what happened the first time you run

650
00:27:00,420 --> 00:27:04,590
that tool should not be when you are

651
00:27:01,830 --> 00:27:06,120
running that investigation you already

652
00:27:04,590 --> 00:27:08,669
have your back up against the wall for

653
00:27:06,120 --> 00:27:10,590
time the goal is to steal little moments

654
00:27:08,670 --> 00:27:12,510
before this point so you can get

655
00:27:10,590 --> 00:27:15,810
comfortable with that tool so that when

656
00:27:12,510 --> 00:27:17,940
the time comes you can get a little bit

657
00:27:15,810 --> 00:27:19,409
ahead and the time spent to get that

658
00:27:17,940 --> 00:27:21,930
information to the people who are going

659
00:27:19,410 --> 00:27:22,950
to be demanding it every five minutes as

660
00:27:21,930 --> 00:27:28,440
soon as they tell you something

661
00:27:22,950 --> 00:27:30,630
important happened now when we talk

662
00:27:28,440 --> 00:27:32,460
about discs most of my stuff will look

663
00:27:30,630 --> 00:27:35,370
at digital tools but there's always to

664
00:27:32,460 --> 00:27:38,040
talk about right bloggers from a

665
00:27:35,370 --> 00:27:41,010
forensic standpoint you want to have

666
00:27:38,040 --> 00:27:42,629
that bit by bit image ultimately if you

667
00:27:41,010 --> 00:27:44,310
can you don't want to be working from

668
00:27:42,630 --> 00:27:45,930
the very specific device that you're

669
00:27:44,310 --> 00:27:49,590
investigating you want to be able to

670
00:27:45,930 --> 00:27:51,600
make a copy of it then take the original

671
00:27:49,590 --> 00:27:54,209
device let legal hold onto it put it in

672
00:27:51,600 --> 00:27:55,679
a shelf put it in a box you know at that

673
00:27:54,210 --> 00:27:57,510
point you are not responsible for it

674
00:27:55,680 --> 00:28:00,030
they get paid the big bucks to do that

675
00:27:57,510 --> 00:28:02,040
kind of thing you can then make copies

676
00:28:00,030 --> 00:28:03,360
of the copy you of made and this is

677
00:28:02,040 --> 00:28:05,490
where you can go in and run your memory

678
00:28:03,360 --> 00:28:07,229
tools this is where you run any disc

679
00:28:05,490 --> 00:28:09,260
analysis tools this is where you run

680
00:28:07,230 --> 00:28:12,810
anything that could potentially interact

681
00:28:09,260 --> 00:28:15,350
with the file system or anything else on

682
00:28:12,810 --> 00:28:17,429
that disk because that will let you

683
00:28:15,350 --> 00:28:19,050
always go back and say I have this

684
00:28:17,430 --> 00:28:21,360
pristine copy over here this is what we

685
00:28:19,050 --> 00:28:25,250
work from any changes that don't line up

686
00:28:21,360 --> 00:28:25,250
with that are the result of my toy

687
00:28:26,660 --> 00:28:31,140
all right when we look at imagers

688
00:28:28,920 --> 00:28:33,420
anytime I I see resumes come across our

689
00:28:31,140 --> 00:28:35,130
desk whenever we try to hire and people

690
00:28:33,420 --> 00:28:36,780
talk about doing forensic imaging or

691
00:28:35,130 --> 00:28:39,150
forensic disk work it's almost

692
00:28:36,780 --> 00:28:40,920
exclusively forensic tool kit now that's

693
00:28:39,150 --> 00:28:42,630
not a knock for any other vendors except

694
00:28:40,920 --> 00:28:45,990
to say they are really really expensive

695
00:28:42,630 --> 00:28:48,990
and access data offers a free version of

696
00:28:45,990 --> 00:28:50,220
the forensic tool kit it is a slightly

697
00:28:48,990 --> 00:28:52,260
older version than whatever the latest

698
00:28:50,220 --> 00:28:54,090
is you don't have all the bells and

699
00:28:52,260 --> 00:28:55,770
whistles turned on but it gives you

700
00:28:54,090 --> 00:28:58,649
enough to get your fingers underneath

701
00:28:55,770 --> 00:29:03,770
and get in and take a look at what you

702
00:28:58,650 --> 00:29:07,650
have on that disk so from a high level

703
00:29:03,770 --> 00:29:09,120
ok the image is a little offset here but

704
00:29:07,650 --> 00:29:10,560
this is where in combination with the

705
00:29:09,120 --> 00:29:13,050
right blocker you can make that disk

706
00:29:10,560 --> 00:29:15,330
image you have the option to go through

707
00:29:13,050 --> 00:29:17,490
take any images that have been made by

708
00:29:15,330 --> 00:29:20,250
somebody else already hook them up and

709
00:29:17,490 --> 00:29:22,350
do your investigations in there get

710
00:29:20,250 --> 00:29:23,880
everything mounted make sure that

711
00:29:22,350 --> 00:29:26,850
everything's protected properly before

712
00:29:23,880 --> 00:29:28,470
you start doing work plus you have the

713
00:29:26,850 --> 00:29:30,389
advantage with that to be able to do in

714
00:29:28,470 --> 00:29:32,550
this situation it's a bit by bit

715
00:29:30,390 --> 00:29:35,640
analysis so you can see the actual data

716
00:29:32,550 --> 00:29:38,010
written to disk the other option you can

717
00:29:35,640 --> 00:29:40,140
do with this is you can take an image

718
00:29:38,010 --> 00:29:42,030
file and mount it like an external drive

719
00:29:40,140 --> 00:29:43,860
like you bring it up whatever letter

720
00:29:42,030 --> 00:29:46,139
make it your G Drive and then you can

721
00:29:43,860 --> 00:29:47,399
examine the file system in there to go

722
00:29:46,140 --> 00:29:49,020
and look to see are there actual

723
00:29:47,400 --> 00:29:51,000
physical artifacts malware you might

724
00:29:49,020 --> 00:29:52,320
want to reverse engineer if that's in

725
00:29:51,000 --> 00:29:54,720
your skill set or something you might

726
00:29:52,320 --> 00:29:55,490
want to pull a hash of and check against

727
00:29:54,720 --> 00:29:57,990
virustotal

728
00:29:55,490 --> 00:30:00,350
but not actually upload anything to

729
00:29:57,990 --> 00:30:00,350
virustotal

730
00:30:03,740 --> 00:30:09,620
now looking at memory I know there's a

731
00:30:07,910 --> 00:30:12,080
workshop on it this morning volatility

732
00:30:09,620 --> 00:30:15,110
is usually the de facto standard tool

733
00:30:12,080 --> 00:30:16,730
that most people talk about if you want

734
00:30:15,110 --> 00:30:19,040
to get juniors involved in the

735
00:30:16,730 --> 00:30:20,270
investigation process or slowly step

736
00:30:19,040 --> 00:30:23,060
into doing memory work

737
00:30:20,270 --> 00:30:26,210
I recommend redline formerly mandiant

738
00:30:23,060 --> 00:30:27,800
redline it is a GUI based tool that is

739
00:30:26,210 --> 00:30:31,730
one of the few things fireEye provides

740
00:30:27,800 --> 00:30:33,560
for free and it's something that you can

741
00:30:31,730 --> 00:30:36,020
set up on a forensic workstation and

742
00:30:33,560 --> 00:30:37,790
then spin up packages to run against

743
00:30:36,020 --> 00:30:41,629
other systems to pull memory from live

744
00:30:37,790 --> 00:30:43,430
boxes once again we can you know

745
00:30:41,630 --> 00:30:45,530
notebook document when you're doing that

746
00:30:43,430 --> 00:30:47,960
so if people look at hey I see these

747
00:30:45,530 --> 00:30:52,520
events that was me this is what I did

748
00:30:47,960 --> 00:30:54,380
this is why it shows up on the disk it

749
00:30:52,520 --> 00:30:56,900
gives you a couple of options just give

750
00:30:54,380 --> 00:30:59,030
me your your standard core things that

751
00:30:56,900 --> 00:31:01,100
might trip up when I'm seeing memory the

752
00:30:59,030 --> 00:31:03,980
things I would normally look for there's

753
00:31:01,100 --> 00:31:05,209
the give me everything option I want to

754
00:31:03,980 --> 00:31:08,570
know everything that has happened in

755
00:31:05,210 --> 00:31:11,030
memory on this box there is I have a

756
00:31:08,570 --> 00:31:12,889
bunch of i/o sees I found them maybe

757
00:31:11,030 --> 00:31:15,250
doing forensics on one box maybe the FBI

758
00:31:12,890 --> 00:31:17,840
told me maybe an information sharing

759
00:31:15,250 --> 00:31:19,820
Center said hey we see this going

760
00:31:17,840 --> 00:31:21,260
through your industry and you just want

761
00:31:19,820 --> 00:31:24,730
to be able to run those on boxes that

762
00:31:21,260 --> 00:31:27,290
are acting weird you can do all of that

763
00:31:24,730 --> 00:31:30,140
and then bring it back into red line to

764
00:31:27,290 --> 00:31:32,210
take a look now if you haven't done

765
00:31:30,140 --> 00:31:36,260
memory pools especially memory pools

766
00:31:32,210 --> 00:31:39,440
across a network think of the average

767
00:31:36,260 --> 00:31:42,020
memory on a workstation eight gigs 16

768
00:31:39,440 --> 00:31:45,890
gigs of its powerful machine getting

769
00:31:42,020 --> 00:31:47,150
your servers 32 64 some people 128 or

770
00:31:45,890 --> 00:31:50,030
higher depending on what that server

771
00:31:47,150 --> 00:31:52,100
does if you need to pull that remotely

772
00:31:50,030 --> 00:31:54,290
well one it's going to take time to

773
00:31:52,100 --> 00:31:55,939
actually generate the memory capture to

774
00:31:54,290 --> 00:31:58,310
turn all of that into a file they can

775
00:31:55,940 --> 00:32:01,120
pull off and then if you're trying to

776
00:31:58,310 --> 00:32:03,740
pull it over a network think of how long

777
00:32:01,120 --> 00:32:05,510
32 gigs is going to take to pull over a

778
00:32:03,740 --> 00:32:07,730
wire from A to B with everything else

779
00:32:05,510 --> 00:32:10,430
going on on your network things are

780
00:32:07,730 --> 00:32:12,950
going to bog down quickly if you can you

781
00:32:10,430 --> 00:32:15,680
want to deploy your a remote workstation

782
00:32:12,950 --> 00:32:18,580
as close as possible to the endpoint to

783
00:32:15,680 --> 00:32:18,580
do that memory pool

784
00:32:20,770 --> 00:32:25,460
now remember the advantage of red line

785
00:32:23,300 --> 00:32:34,129
here is it will put a visual timeline of

786
00:32:25,460 --> 00:32:36,380
what happened in memory so it's a little

787
00:32:34,130 --> 00:32:39,560
bit hard to see I apologize for that

788
00:32:36,380 --> 00:32:41,360
but what we have is a couple of options

789
00:32:39,560 --> 00:32:43,760
here I'm going to focus on one it lines

790
00:32:41,360 --> 00:32:46,159
everything up by timestamp by default so

791
00:32:43,760 --> 00:32:48,250
this is what happened in this order

792
00:32:46,160 --> 00:32:51,470
according to what we found in memory you

793
00:32:48,250 --> 00:32:52,970
know it'll give you like a field a basic

794
00:32:51,470 --> 00:32:55,880
summary of what it is like these are

795
00:32:52,970 --> 00:32:58,160
these executables of ran these are the

796
00:32:55,880 --> 00:33:00,590
process IDs tied to them which you can

797
00:32:58,160 --> 00:33:03,560
use to match up with any EDR tool you

798
00:33:00,590 --> 00:33:06,740
may have and more importantly it'll also

799
00:33:03,560 --> 00:33:08,840
show you where did this run one of the

800
00:33:06,740 --> 00:33:11,330
great matches about common Windows

801
00:33:08,840 --> 00:33:13,850
executables is this is something a bad

802
00:33:11,330 --> 00:33:17,629
guy that's gonna try to do but if I have

803
00:33:13,850 --> 00:33:19,610
a malicious svchost.exe I can't dump it

804
00:33:17,630 --> 00:33:21,290
in Windows 32 because the system

805
00:33:19,610 --> 00:33:23,270
processes that rely on the regular one

806
00:33:21,290 --> 00:33:26,149
will break and I will crash the system

807
00:33:23,270 --> 00:33:28,670
so unless that's my goal it doesn't do

808
00:33:26,150 --> 00:33:30,920
me anything at the same time I also know

809
00:33:28,670 --> 00:33:34,010
that the service host should be launched

810
00:33:30,920 --> 00:33:37,130
by services Exe if I see chrome launch

811
00:33:34,010 --> 00:33:40,220
it I either have a developer who's being

812
00:33:37,130 --> 00:33:44,900
bad or this is an adversary doing

813
00:33:40,220 --> 00:33:46,400
something they shouldn't be doing I say

814
00:33:44,900 --> 00:33:48,800
that because I've had developers who

815
00:33:46,400 --> 00:33:52,190
have been bad in a dev heavy org so it

816
00:33:48,800 --> 00:33:54,139
happens from time to time and here's

817
00:33:52,190 --> 00:33:55,550
just a further breakdown where with some

818
00:33:54,140 --> 00:33:57,830
of the other options you can look at

819
00:33:55,550 --> 00:34:00,379
where some of the hooks are what ports

820
00:33:57,830 --> 00:34:02,830
are being called out to in this case it

821
00:34:00,380 --> 00:34:05,510
takes that hierarchical process view so

822
00:34:02,830 --> 00:34:07,520
process a and launch process B that

823
00:34:05,510 --> 00:34:09,770
might lead into like C D and E on a tree

824
00:34:07,520 --> 00:34:11,239
and it lines them up for you once again

825
00:34:09,770 --> 00:34:13,909
in that time stamp order but it also

826
00:34:11,239 --> 00:34:16,790
lets you track your process IDs so I can

827
00:34:13,909 --> 00:34:19,040
see alright this is how things ran down

828
00:34:16,790 --> 00:34:21,050
in the system and it makes it easy to go

829
00:34:19,040 --> 00:34:23,480
back and say alright I know I have this

830
00:34:21,050 --> 00:34:25,640
bad executable and it was pulled down

831
00:34:23,480 --> 00:34:27,230
from a script that was launched by

832
00:34:25,639 --> 00:34:29,120
Chrome all right

833
00:34:27,230 --> 00:34:30,040
based on that chrome process ID I now

834
00:34:29,120 --> 00:34:32,500
have a time stay

835
00:34:30,040 --> 00:34:33,969
and once again I have pivot points where

836
00:34:32,500 --> 00:34:35,139
I can see what else was happening on the

837
00:34:33,969 --> 00:34:37,870
box at that time

838
00:34:35,139 --> 00:34:43,179
where did chrome reach out to what was

839
00:34:37,870 --> 00:34:47,440
the user potentially doing now we get

840
00:34:43,179 --> 00:34:49,600
into policeman land chrome forensics the

841
00:34:47,440 --> 00:34:51,190
advantage of browser forensics tools is

842
00:34:49,600 --> 00:34:53,469
these are some of the easiest tools to

843
00:34:51,190 --> 00:34:56,020
get started with they are very

844
00:34:53,469 --> 00:34:58,660
point-and-click in the case of hindsight

845
00:34:56,020 --> 00:35:01,210
which is available on github it is

846
00:34:58,660 --> 00:35:03,190
basically OS agnostic right it's a

847
00:35:01,210 --> 00:35:06,580
Python a series of Python scripts or

848
00:35:03,190 --> 00:35:07,990
there are executable options one if from

849
00:35:06,580 --> 00:35:10,330
a Windows command line if you want to do

850
00:35:07,990 --> 00:35:13,149
command line one that's Bui based where

851
00:35:10,330 --> 00:35:15,250
it'll pop up a localhost window on 8080

852
00:35:13,150 --> 00:35:16,810
and you can go in and run through and

853
00:35:15,250 --> 00:35:20,110
you'll see the the GUI in the next

854
00:35:16,810 --> 00:35:22,390
couple of slides from a freezin puppy

855
00:35:20,110 --> 00:35:24,130
standpoint browser forensics tools like

856
00:35:22,390 --> 00:35:26,980
this may be the only thing out there

857
00:35:24,130 --> 00:35:29,110
that is actually free as in beer easy to

858
00:35:26,980 --> 00:35:34,180
run easy to install easy to get output

859
00:35:29,110 --> 00:35:37,540
that's usable out of them so from this

860
00:35:34,180 --> 00:35:39,220
standpoint where a lot of the history

861
00:35:37,540 --> 00:35:41,590
files are for chrome it's standard

862
00:35:39,220 --> 00:35:43,569
unless somebody's doing something unique

863
00:35:41,590 --> 00:35:46,810
with their system it's going to fall

864
00:35:43,570 --> 00:35:49,330
into one given set of buckets so all you

865
00:35:46,810 --> 00:35:51,279
need to do is either run it against that

866
00:35:49,330 --> 00:35:55,240
box in the standard profile for that

867
00:35:51,280 --> 00:35:58,270
user or you can export that history file

868
00:35:55,240 --> 00:36:00,850
off and then run it on any other box if

869
00:35:58,270 --> 00:36:02,800
that's easier now the caveat if you're

870
00:36:00,850 --> 00:36:05,020
running this live if a user has chrome

871
00:36:02,800 --> 00:36:07,270
open that file does lock and this will

872
00:36:05,020 --> 00:36:09,370
error out like that that needs to be a

873
00:36:07,270 --> 00:36:12,930
closed file that's not being accessed in

874
00:36:09,370 --> 00:36:12,930
order to make use of it

875
00:36:15,810 --> 00:36:24,840
and you have a lot of options chrome

876
00:36:21,810 --> 00:36:27,690
extension names I have a story about a

877
00:36:24,840 --> 00:36:29,130
Chrome extension that it was interesting

878
00:36:27,690 --> 00:36:32,040
to us from a forensic standpoint it

879
00:36:29,130 --> 00:36:33,660
looks like nothing spawned this magical

880
00:36:32,040 --> 00:36:37,560
call out to a bad domain

881
00:36:33,660 --> 00:36:39,629
I have only in my edie arts as chrome

882
00:36:37,560 --> 00:36:44,460
went there I looked at the chrome

883
00:36:39,630 --> 00:36:48,300
history nada user interaction nothing I

884
00:36:44,460 --> 00:36:49,710
don't have any given user behavior that

885
00:36:48,300 --> 00:36:53,550
shows that this should have happened

886
00:36:49,710 --> 00:36:54,990
and what ended up happening and and the

887
00:36:53,550 --> 00:36:57,660
Chrome extension that was able to help

888
00:36:54,990 --> 00:36:58,859
me figure it out and user opened up

889
00:36:57,660 --> 00:37:00,350
their laptop they did not have a

890
00:36:58,860 --> 00:37:03,440
connected to the company Wireless yet

891
00:37:00,350 --> 00:37:06,839
they said all right I'm going to connect

892
00:37:03,440 --> 00:37:08,760
I'm gonna log in to what they thought

893
00:37:06,840 --> 00:37:10,290
was Gmail well if you're not careful in

894
00:37:08,760 --> 00:37:12,240
Chrome you might not be logging into

895
00:37:10,290 --> 00:37:14,220
your Gmail you could be logging into the

896
00:37:12,240 --> 00:37:17,220
Chrome browser where it will then try to

897
00:37:14,220 --> 00:37:18,750
sync everything you have set up on any

898
00:37:17,220 --> 00:37:22,680
other Chrome browser into which you are

899
00:37:18,750 --> 00:37:24,360
signed so this user did this and then

900
00:37:22,680 --> 00:37:25,770
there's it some time passes while this

901
00:37:24,360 --> 00:37:27,780
sink is going on is this trying to

902
00:37:25,770 --> 00:37:29,880
identify what else has this open out

903
00:37:27,780 --> 00:37:31,050
there so while the user is at lunch

904
00:37:29,880 --> 00:37:33,930
this is syncing up with the other

905
00:37:31,050 --> 00:37:36,800
browsers it then installs all these

906
00:37:33,930 --> 00:37:39,210
other extensions from her other browsers

907
00:37:36,800 --> 00:37:42,360
one of these was a malicious extension

908
00:37:39,210 --> 00:37:43,860
that immediately began calling out to an

909
00:37:42,360 --> 00:37:46,200
Eastern European country where we

910
00:37:43,860 --> 00:37:47,880
usually don't see traffic now

911
00:37:46,200 --> 00:37:50,520
fortunately for us it was a broken

912
00:37:47,880 --> 00:37:52,590
script but I had to go back and take a

913
00:37:50,520 --> 00:37:54,540
look through Chrome because how they

914
00:37:52,590 --> 00:37:57,180
tracked the extensions especially

915
00:37:54,540 --> 00:38:00,150
forensically without looking to see what

916
00:37:57,180 --> 00:38:03,450
extensions are installed they don't show

917
00:38:00,150 --> 00:38:05,010
in the browser history as a call out it

918
00:38:03,450 --> 00:38:07,020
wasn't a user doing this it wasn't a

919
00:38:05,010 --> 00:38:09,030
program doing this it just magically

920
00:38:07,020 --> 00:38:12,930
happened in and there's no history

921
00:38:09,030 --> 00:38:14,970
recorded for it the other advantages

922
00:38:12,930 --> 00:38:16,980
here with the plugins is get you

923
00:38:14,970 --> 00:38:18,330
timestamps ultimately when you're doing

924
00:38:16,980 --> 00:38:21,150
forensics you want to make sure you have

925
00:38:18,330 --> 00:38:22,650
a unified set of a unified time zone in

926
00:38:21,150 --> 00:38:25,050
which you're documenting when things

927
00:38:22,650 --> 00:38:27,340
happen there's nothing worse than having

928
00:38:25,050 --> 00:38:29,890
offices in different areas and

929
00:38:27,340 --> 00:38:32,200
my sim logs everything in UTC and user

930
00:38:29,890 --> 00:38:34,089
in London is still got his laptop that

931
00:38:32,200 --> 00:38:36,790
hasn't updated so it's on San Francisco

932
00:38:34,090 --> 00:38:39,130
time then I have somebody in Milwaukee

933
00:38:36,790 --> 00:38:40,540
who's on a VPN to Atlanta so now I've

934
00:38:39,130 --> 00:38:43,780
got Eastern Time and all this stuff

935
00:38:40,540 --> 00:38:46,330
mixes in especially with logging to a

936
00:38:43,780 --> 00:38:49,630
centralized device it's usually very

937
00:38:46,330 --> 00:38:55,509
easy to tie what happened when based on

938
00:38:49,630 --> 00:38:57,910
that unified time stamp now the output

939
00:38:55,510 --> 00:39:00,670
kicked out as a single light database or

940
00:38:57,910 --> 00:39:02,770
than kicked out his Excel Excel being

941
00:39:00,670 --> 00:39:05,430
the forensic ater threat intelligence

942
00:39:02,770 --> 00:39:07,080
person's best tool that's out there I

943
00:39:05,430 --> 00:39:10,210
hate it

944
00:39:07,080 --> 00:39:11,529
now I ran the tool I said all right I

945
00:39:10,210 --> 00:39:12,220
want to show you an output of what this

946
00:39:11,530 --> 00:39:14,800
looks like

947
00:39:12,220 --> 00:39:17,919
however from my poor planning standpoint

948
00:39:14,800 --> 00:39:19,510
I ran this on my personal laptop so you

949
00:39:17,920 --> 00:39:21,190
will understand if I decided not to put

950
00:39:19,510 --> 00:39:23,800
my browsing history up on screen for

951
00:39:21,190 --> 00:39:26,140
everybody but the advantage when you get

952
00:39:23,800 --> 00:39:29,260
this output you get the URLs you get the

953
00:39:26,140 --> 00:39:32,140
refer so you see how they got from URL a

954
00:39:29,260 --> 00:39:34,180
to URL B right you know there's a

955
00:39:32,140 --> 00:39:35,890
difference if somebody went to unhappy

956
00:39:34,180 --> 00:39:38,069
puppies dot-com and then suddenly

957
00:39:35,890 --> 00:39:41,020
they're at perfectly safe that are you

958
00:39:38,070 --> 00:39:43,300
versus somebody ran a Google search and

959
00:39:41,020 --> 00:39:45,460
when Google sometimes Auto loads those

960
00:39:43,300 --> 00:39:46,930
pages in the background of chrome also

961
00:39:45,460 --> 00:39:49,240
in you have ten pages load and

962
00:39:46,930 --> 00:39:51,279
rapid-fire that all load their ad pieces

963
00:39:49,240 --> 00:39:52,839
in rapid-fire so the cache lets the user

964
00:39:51,280 --> 00:39:54,910
get there quickly when they click on

965
00:39:52,840 --> 00:39:56,590
what they want and oh look one of those

966
00:39:54,910 --> 00:39:59,230
pages they wouldn't normally care about

967
00:39:56,590 --> 00:40:02,140
has been gamed in the SEO algorithms of

968
00:39:59,230 --> 00:40:04,150
Google to move malicious adware up just

969
00:40:02,140 --> 00:40:07,720
in case somebody hasn't turned off that

970
00:40:04,150 --> 00:40:10,690
auto loading in the background you get

971
00:40:07,720 --> 00:40:12,430
lots and lots of details when it was run

972
00:40:10,690 --> 00:40:18,670
in some cases how long a user was on a

973
00:40:12,430 --> 00:40:21,069
page now windows focus law on Windows

974
00:40:18,670 --> 00:40:23,380
because it is everywhere you know it is

975
00:40:21,070 --> 00:40:25,030
it is the matrix you're jacking whether

976
00:40:23,380 --> 00:40:26,590
or whether or not you want you have to

977
00:40:25,030 --> 00:40:28,240
be one of those few who's found a way to

978
00:40:26,590 --> 00:40:32,080
disconnect not to be connected to

979
00:40:28,240 --> 00:40:33,759
Windows there is a gentleman I believe

980
00:40:32,080 --> 00:40:37,420
his name is near silver he's got his

981
00:40:33,760 --> 00:40:40,150
near soft web site near soft net where

982
00:40:37,420 --> 00:40:40,869
he has a lot of utilities most of which

983
00:40:40,150 --> 00:40:42,940
are free

984
00:40:40,869 --> 00:40:45,819
that are all designed to do one or two

985
00:40:42,940 --> 00:40:47,769
small things so instead of having the I

986
00:40:45,819 --> 00:40:49,808
have bought this one forensic solution

987
00:40:47,769 --> 00:40:51,910
that does everything what specific

988
00:40:49,809 --> 00:40:55,329
forensic thing are you doing he may have

989
00:40:51,910 --> 00:40:57,160
an on site this is another one of those

990
00:40:55,329 --> 00:40:59,920
once again is browser based so fries and

991
00:40:57,160 --> 00:41:03,670
beer it's not as detailed as hindsight

992
00:40:59,920 --> 00:41:05,499
but the advantage that this gives you it

993
00:41:03,670 --> 00:41:07,239
basically hooks into any browser you

994
00:41:05,499 --> 00:41:09,910
would expect to see on a device in a

995
00:41:07,239 --> 00:41:12,609
corporate environment unless we're

996
00:41:09,910 --> 00:41:15,489
talking about a red team or pen tester

997
00:41:12,609 --> 00:41:17,828
or or whatnot where they have some weird

998
00:41:15,489 --> 00:41:20,229
old version of like Firefox that's been

999
00:41:17,829 --> 00:41:21,910
adapted to do a specific thing this

1000
00:41:20,229 --> 00:41:27,430
could hook into most of it and this will

1001
00:41:21,910 --> 00:41:29,170
get you the history now here it's your

1002
00:41:27,430 --> 00:41:31,569
standard Windows File Viewer output

1003
00:41:29,170 --> 00:41:35,109
fakes it breaks it down very basically

1004
00:41:31,569 --> 00:41:36,788
its URL what title would you get when

1005
00:41:35,109 --> 00:41:39,400
was the visit how many times does a user

1006
00:41:36,789 --> 00:41:42,400
gone to this site and a couple more

1007
00:41:39,400 --> 00:41:44,589
little bits of material once again it's

1008
00:41:42,400 --> 00:41:48,039
easy to use it's an executable you click

1009
00:41:44,589 --> 00:41:49,538
you run you can also export that the DAT

1010
00:41:48,039 --> 00:41:52,359
file that carries a history to another

1011
00:41:49,539 --> 00:41:53,769
device or any of the other history files

1012
00:41:52,359 --> 00:41:57,190
depending on browser and run this

1013
00:41:53,769 --> 00:41:58,779
offline on a different device it kicks

1014
00:41:57,190 --> 00:42:00,849
up in almost no time you'd have the

1015
00:41:58,779 --> 00:42:03,069
option to also search to try to speed

1016
00:42:00,849 --> 00:42:04,450
things up let's say I work at Wells

1017
00:42:03,069 --> 00:42:07,450
Fargo and I'm doing a Wells Fargo

1018
00:42:04,450 --> 00:42:08,739
investigation if I don't want to look to

1019
00:42:07,450 --> 00:42:10,899
see when his browser went to Wells Fargo

1020
00:42:08,739 --> 00:42:13,630
I can eliminate any of the internal

1021
00:42:10,900 --> 00:42:15,549
domains and then just focus if I if my

1022
00:42:13,630 --> 00:42:18,460
threat intelligence says this bad stuff

1023
00:42:15,549 --> 00:42:20,499
is coming from Russia or any anywhere in

1024
00:42:18,460 --> 00:42:22,359
the old Eastern Bloc well I can just

1025
00:42:20,499 --> 00:42:24,788
search I'm given top-level domains and

1026
00:42:22,359 --> 00:42:27,069
only show me that stuff this way once

1027
00:42:24,789 --> 00:42:28,930
again you you limit your scope so you

1028
00:42:27,069 --> 00:42:32,829
have a lot less that you need to dig

1029
00:42:28,930 --> 00:42:36,848
through so as we're wrapping up we'll

1030
00:42:32,829 --> 00:42:39,369
talk about references if anybody has

1031
00:42:36,849 --> 00:42:42,039
taken a stance class you were a sans

1032
00:42:39,369 --> 00:42:45,460
class in conference not counting Hotel

1033
00:42:42,039 --> 00:42:48,219
food and travel is the cost of at least

1034
00:42:45,460 --> 00:42:50,729
a semester at most public universities

1035
00:42:48,219 --> 00:42:52,900
if not more depending on the state

1036
00:42:50,729 --> 00:42:54,250
however they have a lot of good free

1037
00:42:52,900 --> 00:42:57,520
resources

1038
00:42:54,250 --> 00:42:59,230
they have like any of their posters if

1039
00:42:57,520 --> 00:43:00,730
you've ever seen their posters we'll

1040
00:42:59,230 --> 00:43:02,140
give you all the forensic artifacts you

1041
00:43:00,730 --> 00:43:04,390
need to worry about on a given system

1042
00:43:02,140 --> 00:43:06,279
they have them Windows from memory

1043
00:43:04,390 --> 00:43:08,650
Network mobile I believe they have one

1044
00:43:06,280 --> 00:43:10,000
format these are good things to download

1045
00:43:08,650 --> 00:43:12,040
or just order and have one of these

1046
00:43:10,000 --> 00:43:14,230
hanging around because they do a good

1047
00:43:12,040 --> 00:43:16,420
job of breaking down if you're looking

1048
00:43:14,230 --> 00:43:18,430
for this this is where you'll find it

1049
00:43:16,420 --> 00:43:21,370
now they don't tell you what toolset you

1050
00:43:18,430 --> 00:43:24,310
need to go to find those but it will get

1051
00:43:21,370 --> 00:43:27,460
you most of the way there plus if you're

1052
00:43:24,310 --> 00:43:28,990
want a forensic workstation they have a

1053
00:43:27,460 --> 00:43:31,570
really good one there chef workstation

1054
00:43:28,990 --> 00:43:32,680
once again fries and puppies could you

1055
00:43:31,570 --> 00:43:34,810
download it but you're going to need to

1056
00:43:32,680 --> 00:43:37,480
update it make sure that you have the

1057
00:43:34,810 --> 00:43:42,460
tools on there you want to use but once

1058
00:43:37,480 --> 00:43:44,080
again free and it's built to do this now

1059
00:43:42,460 --> 00:43:45,220
online from a forensic standpoint

1060
00:43:44,080 --> 00:43:48,160
there's a gentleman by the name of

1061
00:43:45,220 --> 00:43:49,990
Filmore what he does that is a huge

1062
00:43:48,160 --> 00:43:51,910
value in the forensic world is he

1063
00:43:49,990 --> 00:43:53,229
basically curates articles tweets and

1064
00:43:51,910 --> 00:43:55,120
everything else that's out there and

1065
00:43:53,230 --> 00:43:57,010
reports on it weekly and this week in

1066
00:43:55,120 --> 00:43:58,750
forensics and he'll do a monthly rundown

1067
00:43:57,010 --> 00:44:00,790
at the end of the week or I'm excuse me

1068
00:43:58,750 --> 00:44:02,590
the end of the month so you can get a

1069
00:44:00,790 --> 00:44:04,570
full listing of what's going on and it's

1070
00:44:02,590 --> 00:44:06,400
able to keep current without having to

1071
00:44:04,570 --> 00:44:08,620
try to Google or search and I believe

1072
00:44:06,400 --> 00:44:11,230
his site is somewhat searchable so you

1073
00:44:08,620 --> 00:44:12,250
can go back and look through history for

1074
00:44:11,230 --> 00:44:14,050
things that might be relevant to what

1075
00:44:12,250 --> 00:44:16,240
you're doing

1076
00:44:14,050 --> 00:44:18,670
Brett shavers has deferred training

1077
00:44:16,240 --> 00:44:21,939
which is another good repository that

1078
00:44:18,670 --> 00:44:23,860
has resources educational materials and

1079
00:44:21,940 --> 00:44:25,270
a lot of here's what's going on right

1080
00:44:23,860 --> 00:44:26,260
now on forensics and here's where you

1081
00:44:25,270 --> 00:44:30,009
may want to look for different things

1082
00:44:26,260 --> 00:44:31,890
and then Eric Zimmerman has a github

1083
00:44:30,010 --> 00:44:35,590
page where he is developing free tools

1084
00:44:31,890 --> 00:44:37,089
right now with not quite reckless

1085
00:44:35,590 --> 00:44:39,250
abandon but with a great amount of

1086
00:44:37,090 --> 00:44:42,130
enthusiasm and a lot of what he's been

1087
00:44:39,250 --> 00:44:43,600
doing is getting feedback so once again

1088
00:44:42,130 --> 00:44:44,980
there's a lot you can get from his

1089
00:44:43,600 --> 00:44:48,009
github page that will help you do

1090
00:44:44,980 --> 00:44:50,860
forensics once again free is in puppies

1091
00:44:48,010 --> 00:44:53,860
the only caveat to Eric Eric is a very

1092
00:44:50,860 --> 00:44:55,510
very smart man so he assumes you are a

1093
00:44:53,860 --> 00:44:58,150
very very smart person who's using these

1094
00:44:55,510 --> 00:45:00,310
tools there's a bit of a learning curve

1095
00:44:58,150 --> 00:45:02,710
on this these are the things you want to

1096
00:45:00,310 --> 00:45:04,600
start out and slowly build up to or or

1097
00:45:02,710 --> 00:45:08,400
spend extra time playing around with so

1098
00:45:04,600 --> 00:45:08,400
you understand what you get

1099
00:45:08,979 --> 00:45:11,779
all right

1100
00:45:10,279 --> 00:45:13,299
so in conclusion from a small to

1101
00:45:11,779 --> 00:45:15,710
medium-sized business standpoint

1102
00:45:13,299 --> 00:45:19,099
forensics can feel like there's a lot of

1103
00:45:15,710 --> 00:45:21,170
pressure or what is being asked for by

1104
00:45:19,099 --> 00:45:23,180
leadership may not be possible the

1105
00:45:21,170 --> 00:45:25,130
answer is yes it is you just need to

1106
00:45:23,180 --> 00:45:27,710
make sure you scope your environment for

1107
00:45:25,130 --> 00:45:29,509
what might need forensics make sure

1108
00:45:27,710 --> 00:45:31,700
you're set to do that forensics and you

1109
00:45:29,509 --> 00:45:33,469
can preserve evidence in such a way an

1110
00:45:31,700 --> 00:45:36,189
adversary can't destroy it

1111
00:45:33,469 --> 00:45:39,769
make sure leadership understands

1112
00:45:36,190 --> 00:45:42,950
expectations that a B does it in half an

1113
00:45:39,769 --> 00:45:43,519
hour don't hire her if you want in half

1114
00:45:42,950 --> 00:45:46,038
an hour

1115
00:45:43,519 --> 00:45:47,508
reality is it's going to take longer I

1116
00:45:46,039 --> 00:45:49,999
can get certain bits

1117
00:45:47,509 --> 00:45:52,279
it'll happen over time and if Emory

1118
00:45:49,999 --> 00:45:54,910
serves Abby is now unemployed so if you

1119
00:45:52,279 --> 00:45:57,680
need somebody who she is available

1120
00:45:54,910 --> 00:45:59,089
practice practice practice practice make

1121
00:45:57,680 --> 00:46:00,950
sure the first time you're using a tool

1122
00:45:59,089 --> 00:46:04,819
is not the first time you need a tool

1123
00:46:00,950 --> 00:46:06,379
and then document everything part of

1124
00:46:04,819 --> 00:46:07,549
documentation is not just protecting

1125
00:46:06,380 --> 00:46:10,279
yourself if you need to report to

1126
00:46:07,549 --> 00:46:13,219
somebody else part of it is the we're in

1127
00:46:10,279 --> 00:46:15,799
defense we are good people as I tell my

1128
00:46:13,219 --> 00:46:17,509
boss I document things because if I go

1129
00:46:15,799 --> 00:46:19,400
out at lunch to the falafel truck and

1130
00:46:17,509 --> 00:46:20,809
the guy with the hotdog cart doesn't

1131
00:46:19,400 --> 00:46:22,819
like it and whacks me because I'm not

1132
00:46:20,809 --> 00:46:24,920
buying a hotdog somebody else can come

1133
00:46:22,819 --> 00:46:26,900
into my documentation and take over the

1134
00:46:24,920 --> 00:46:28,759
investigation even if they have to bring

1135
00:46:26,900 --> 00:46:30,259
in an outside firm they can see what

1136
00:46:28,759 --> 00:46:32,599
I've done and pick up where we've left

1137
00:46:30,259 --> 00:46:35,630
off or if I'm trying to bring up juniors

1138
00:46:32,599 --> 00:46:38,299
how do I do this take a look this is how

1139
00:46:35,630 --> 00:46:39,589
I have done it in the past maybe you

1140
00:46:38,299 --> 00:46:41,660
maybe you can use this to get to a

1141
00:46:39,589 --> 00:46:42,619
conclusion you need maybe you find a way

1142
00:46:41,660 --> 00:46:45,288
to make it better

1143
00:46:42,619 --> 00:46:47,599
but you don't need to retread you know

1144
00:46:45,289 --> 00:46:49,099
retread any processes I've already done

1145
00:46:47,599 --> 00:46:54,140
unless it's from a learning or

1146
00:46:49,099 --> 00:46:56,539
improvement staff so thank you very much

1147
00:46:54,140 --> 00:46:57,078
for calling does anybody have any

1148
00:46:56,539 --> 00:47:00,529
questions

1149
00:46:57,079 --> 00:47:05,890
I was hoping nobody little bit go ahead

1150
00:47:00,529 --> 00:47:05,890
please there

1151
00:47:36,760 --> 00:47:39,390
yeah

1152
00:47:41,030 --> 00:47:46,099
I've heard people talk about this I've

1153
00:47:44,240 --> 00:47:49,098
never I've fortunately never been pinned

1154
00:47:46,099 --> 00:47:52,220
to the wall about like time skew but

1155
00:47:49,099 --> 00:47:54,260
it's generally understood and any lawyer

1156
00:47:52,220 --> 00:47:56,419
who's putting you in the dock to testify

1157
00:47:54,260 --> 00:47:58,730
that is on your side should be able to

1158
00:47:56,420 --> 00:48:02,420
back you up on this right nothing is

1159
00:47:58,730 --> 00:48:04,280
like from a time standpoint flying me to

1160
00:48:02,420 --> 00:48:06,109
clocks that have the exact same time

1161
00:48:04,280 --> 00:48:07,730
right even if you have to pulling from

1162
00:48:06,109 --> 00:48:09,650
the same NTP server you can be off by a

1163
00:48:07,730 --> 00:48:12,230
second right or off by some small

1164
00:48:09,650 --> 00:48:13,970
fraction there is an understanding that

1165
00:48:12,230 --> 00:48:16,099
there is going to be a little bit of

1166
00:48:13,970 --> 00:48:17,810
drift which is where the rest of it

1167
00:48:16,099 --> 00:48:19,609
comes into play it's like okay we see

1168
00:48:17,810 --> 00:48:22,640
things ran in a certain order but based

1169
00:48:19,609 --> 00:48:25,279
on my process examination things happen

1170
00:48:22,640 --> 00:48:27,200
in this order right I can use that to

1171
00:48:25,280 --> 00:48:29,119
build out a we're aware that there could

1172
00:48:27,200 --> 00:48:31,580
be this much drift because we also have

1173
00:48:29,119 --> 00:48:33,490
to account for latency to is you know

1174
00:48:31,580 --> 00:48:36,170
how long does it take for my box in

1175
00:48:33,490 --> 00:48:39,439
Chicago to log to my sim in Detroit

1176
00:48:36,170 --> 00:48:40,910
versus my box in Tallahassee right the

1177
00:48:39,440 --> 00:48:42,290
advantage of having to log collectors

1178
00:48:40,910 --> 00:48:44,420
you can use that as your trust but

1179
00:48:42,290 --> 00:48:47,089
verify on the time sink because those

1180
00:48:44,420 --> 00:48:49,520
log collectors should also be stamping a

1181
00:48:47,089 --> 00:48:51,290
time this log was received on there and

1182
00:48:49,520 --> 00:48:53,300
you can use that to build out your

1183
00:48:51,290 --> 00:48:55,580
unified timeline to demonstrate all

1184
00:48:53,300 --> 00:48:57,710
right based on this I can demonstrate

1185
00:48:55,580 --> 00:49:01,279
latency I can demonstrate drift and

1186
00:48:57,710 --> 00:49:03,500
there's the in essence the reasonable

1187
00:49:01,280 --> 00:49:04,730
range right if I'm off by five minutes

1188
00:49:03,500 --> 00:49:06,230
because I have time servers that aren't

1189
00:49:04,730 --> 00:49:08,900
behaving or something's not checking in

1190
00:49:06,230 --> 00:49:10,310
with the time server well you've already

1191
00:49:08,900 --> 00:49:12,320
got a bigger problem than just

1192
00:49:10,310 --> 00:49:15,200
explaining it to to the twelve in the

1193
00:49:12,320 --> 00:49:18,099
box but as long as you have things set

1194
00:49:15,200 --> 00:49:20,598
up properly that limited amount of

1195
00:49:18,099 --> 00:49:22,970
doesn't line up perfectly from a

1196
00:49:20,599 --> 00:49:24,589
timestamp is explainable and

1197
00:49:22,970 --> 00:49:26,899
understandable and those twelve people

1198
00:49:24,589 --> 00:49:29,060
especially with the aid of whoever's on

1199
00:49:26,900 --> 00:49:30,770
your side of the courtroom will be able

1200
00:49:29,060 --> 00:49:38,000
to understand that and that shouldn't be

1201
00:49:30,770 --> 00:49:39,470
held against you I'm hearing maybe one

1202
00:49:38,000 --> 00:49:40,760
more if anybody's got one otherwise we

1203
00:49:39,470 --> 00:49:45,609
can all go hit the bathroom get a drink

1204
00:49:40,760 --> 00:49:45,609
yes no bathroom breaks anybody go ahead

1205
00:49:52,099 --> 00:49:56,719
I got a really quick story about this I

1206
00:49:54,440 --> 00:50:00,799
had mentioned brand and how the company

1207
00:49:56,719 --> 00:50:02,239
feels about brand allegedly because this

1208
00:50:00,799 --> 00:50:04,420
never happened to any company I've

1209
00:50:02,239 --> 00:50:09,650
worked for an adversary was

1210
00:50:04,420 --> 00:50:12,319
impersonating the brand OS int and an

1211
00:50:09,650 --> 00:50:14,329
investigation gave me the golden ticket

1212
00:50:12,319 --> 00:50:17,650
magical unicorn this never happens I

1213
00:50:14,329 --> 00:50:20,150
found the actual human being allegedly I

1214
00:50:17,650 --> 00:50:21,650
was going to be near the human being at

1215
00:50:20,150 --> 00:50:25,640
a place where there are going to be lots

1216
00:50:21,650 --> 00:50:27,049
of federal law enforcement people now in

1217
00:50:25,640 --> 00:50:29,239
this situation I would have gone to

1218
00:50:27,049 --> 00:50:31,940
legal and say we have a chance to

1219
00:50:29,239 --> 00:50:35,329
literally crucify this guy right I have

1220
00:50:31,940 --> 00:50:37,599
everything here that no lawyer on planet

1221
00:50:35,329 --> 00:50:40,940
Earth is going to say it wasn't him

1222
00:50:37,599 --> 00:50:43,400
let's get him right this is this is the

1223
00:50:40,940 --> 00:50:46,459
hole-in-one at the lake on the 18th of

1224
00:50:43,400 --> 00:50:50,900
the win the Masters know what will

1225
00:50:46,459 --> 00:50:56,448
people think he didn't steal from us he

1226
00:50:50,900 --> 00:50:59,239
didn't breach us allegedly but there was

1227
00:50:56,449 --> 00:51:02,390
the concern that people could see us and

1228
00:50:59,239 --> 00:51:06,049
hacker and all of a sudden there's a

1229
00:51:02,390 --> 00:51:08,029
business impact so this guy's home

1230
00:51:06,049 --> 00:51:09,288
address is burned into my mind I will

1231
00:51:08,029 --> 00:51:12,440
remember it will be carved on my

1232
00:51:09,289 --> 00:51:14,900
tombstone allegedly but the decision was

1233
00:51:12,440 --> 00:51:17,569
made not to go get him and in in a lot

1234
00:51:14,900 --> 00:51:19,219
of these cases the only time at any of

1235
00:51:17,569 --> 00:51:21,288
my employers where I have seen all right

1236
00:51:19,219 --> 00:51:23,930
we're going to go to court it's because

1237
00:51:21,289 --> 00:51:26,420
in the case of one employer the FBI has

1238
00:51:23,930 --> 00:51:26,808
shown up and say hi apt one is hacked

1239
00:51:26,420 --> 00:51:30,589
you

1240
00:51:26,809 --> 00:51:31,969
we need your boxes that's the only time

1241
00:51:30,589 --> 00:51:36,979
I've ever she'd go to court and we

1242
00:51:31,969 --> 00:51:38,350
weren't the ones to take it there thank

1243
00:51:36,979 --> 00:51:43,718
you very much

1244
00:51:38,350 --> 00:51:43,719
[Applause]

