1
00:00:00,450 --> 00:00:12,629
let's all give a grateful and welcome to

2
00:00:04,319 --> 00:00:14,309
<font color="#E5E5E5">Brian all right</font><font color="#CCCCCC"> so how's</font><font color="#E5E5E5"> everyone doing</font>

3
00:00:12,630 --> 00:00:15,960
hopefully you're having a good<font color="#E5E5E5"> time with</font>

4
00:00:14,309 --> 00:00:20,789
conference here learning<font color="#E5E5E5"> new things and</font>

5
00:00:15,960 --> 00:00:24,119
<font color="#E5E5E5">picking</font><font color="#CCCCCC"> up new skills I know I have</font><font color="#E5E5E5"> so</font>

6
00:00:20,789 --> 00:00:26,730
my name is<font color="#E5E5E5"> Brian's Kowski</font><font color="#CCCCCC"> I work at a</font>

7
00:00:24,119 --> 00:00:29,009
web hosting company<font color="#E5E5E5"> based on Lansing</font>

8
00:00:26,730 --> 00:00:32,450
Michigan<font color="#CCCCCC"> that should narrow it down if</font>

9
00:00:29,010 --> 00:00:36,090
<font color="#E5E5E5">anyone you know can do the math there</font>

10
00:00:32,450 --> 00:00:41,030
and I am gonna be talking<font color="#CCCCCC"> about</font>

11
00:00:36,090 --> 00:00:45,780
malicious crypto<font color="#E5E5E5"> mining today</font><font color="#CCCCCC"> back in</font>

12
00:00:41,030 --> 00:00:47,879
<font color="#E5E5E5">January</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> I stole this quote</font><font color="#CCCCCC"> actually</font>

13
00:00:45,780 --> 00:00:53,460
from a podcast I'm a huge fan of called

14
00:00:47,879 --> 00:00:56,489
risky business<font color="#CCCCCC"> the idea that with crypto</font>

15
00:00:53,460 --> 00:00:59,399
currency being so<font color="#E5E5E5"> valuable right now</font>

16
00:00:56,489 --> 00:01:02,640
that it<font color="#E5E5E5"> is really incentivizing</font>

17
00:00:59,399 --> 00:01:05,760
attackers to use it as a way to monetize

18
00:01:02,640 --> 00:01:07,500
the access they already have and so I'm

19
00:01:05,760 --> 00:01:10,650
<font color="#E5E5E5">kind of going to go through some of</font><font color="#CCCCCC"> my</font>

20
00:01:07,500 --> 00:01:12,570
research into<font color="#CCCCCC"> that</font><font color="#E5E5E5"> tools that I built</font>

21
00:01:10,650 --> 00:01:18,000
around it different detection methods

22
00:01:12,570 --> 00:01:23,429
<font color="#E5E5E5">and kind of what it means for us as far</font>

23
00:01:18,000 --> 00:01:25,979
as a new you know<font color="#CCCCCC"> Avenue for malicious</font>

24
00:01:23,430 --> 00:01:28,049
attackers using in the field today<font color="#E5E5E5"> so</font>

25
00:01:25,979 --> 00:01:34,920
it's kind of a little brief overview

26
00:01:28,049 --> 00:01:36,780
there now<font color="#CCCCCC"> cryptocurrency and you know</font>

27
00:01:34,920 --> 00:01:39,900
<font color="#CCCCCC">Internet years</font><font color="#E5E5E5"> actually has been</font><font color="#CCCCCC"> around</font>

28
00:01:36,780 --> 00:01:44,189
for a while but it's pretty recent that

29
00:01:39,900 --> 00:01:47,729
it's become a key vector for attackers

30
00:01:44,189 --> 00:01:52,258
<font color="#E5E5E5">with access you know the first paper on</font>

31
00:01:47,729 --> 00:01:54,990
Bitcoin<font color="#E5E5E5"> was written back</font><font color="#CCCCCC"> in 2008</font><font color="#E5E5E5"> and</font>

32
00:01:52,259 --> 00:01:58,500
well<font color="#E5E5E5"> it definitely is worth a heck of a</font>

33
00:01:54,990 --> 00:02:00,750
lot more<font color="#E5E5E5"> now</font><font color="#CCCCCC"> based on you know the</font>

34
00:01:58,500 --> 00:02:04,439
<font color="#E5E5E5">actual</font><font color="#CCCCCC"> crypto currency that's being</font>

35
00:02:00,750 --> 00:02:05,759
mined you don't really need a<font color="#CCCCCC"> crypto</font>

36
00:02:04,439 --> 00:02:10,139
<font color="#CCCCCC">currency to be worth thousands</font><font color="#E5E5E5"> of</font>

37
00:02:05,759 --> 00:02:13,150
<font color="#E5E5E5">dollars</font><font color="#CCCCCC"> for someone to Wyatt so even</font>

38
00:02:10,139 --> 00:02:15,790
back in like November<font color="#CCCCCC"> of 213 when</font>

39
00:02:13,150 --> 00:02:20,680
corners over<font color="#E5E5E5"> a thousand it could have</font>

40
00:02:15,790 --> 00:02:23,349
taken<font color="#E5E5E5"> off then but you know there's kind</font>

41
00:02:20,680 --> 00:02:27,040
of a key reason<font color="#CCCCCC"> that it didn't and it</font>

42
00:02:23,349 --> 00:02:31,119
really<font color="#E5E5E5"> comes down to what bitcoin takes</font>

43
00:02:27,040 --> 00:02:34,209
to mine<font color="#CCCCCC"> if you've</font><font color="#E5E5E5"> been involved in</font>

44
00:02:31,120 --> 00:02:38,439
Bitcoin at all<font color="#E5E5E5"> you all know that people</font>

45
00:02:34,209 --> 00:02:41,920
<font color="#CCCCCC">have</font><font color="#E5E5E5"> created crazy multiple GPU</font><font color="#CCCCCC"> setups</font>

46
00:02:38,439 --> 00:02:44,379
to<font color="#E5E5E5"> you know run</font><font color="#CCCCCC"> it on cards until</font><font color="#E5E5E5"> they</font>

47
00:02:41,920 --> 00:02:46,839
burn them into the ground<font color="#E5E5E5"> and when that</font>

48
00:02:44,379 --> 00:02:51,310
became<font color="#E5E5E5"> ineffective people started</font>

49
00:02:46,840 --> 00:02:55,209
creating dedicated Asics<font color="#E5E5E5"> to do one thing</font>

50
00:02:51,310 --> 00:02:57,670
and that<font color="#E5E5E5"> was mine Bitcoin so when you</font>

51
00:02:55,209 --> 00:03:00,459
are sitting<font color="#CCCCCC"> there</font><font color="#E5E5E5"> with a tiny little CPU</font>

52
00:02:57,670 --> 00:03:02,530
<font color="#CCCCCC">in your laptop or your</font><font color="#E5E5E5"> phone trying to</font>

53
00:03:00,459 --> 00:03:06,189
mine something<font color="#E5E5E5"> against</font><font color="#CCCCCC"> someone who has</font>

54
00:03:02,530 --> 00:03:08,500
you<font color="#E5E5E5"> know teraflops worth of you know</font>

55
00:03:06,189 --> 00:03:10,180
<font color="#E5E5E5">compute power</font><font color="#CCCCCC"> you're not gonna you're</font>

56
00:03:08,500 --> 00:03:14,230
not<font color="#E5E5E5"> going to get anything with the way</font>

57
00:03:10,180 --> 00:03:16,299
that you know mining works<font color="#CCCCCC"> the tiny</font>

58
00:03:14,230 --> 00:03:18,548
little<font color="#E5E5E5"> bit you contribute really isn't</font>

59
00:03:16,299 --> 00:03:20,799
<font color="#E5E5E5">going to give you a payout so for quite</font>

60
00:03:18,549 --> 00:03:22,750
some time really<font color="#E5E5E5"> the</font><font color="#CCCCCC"> only you</font><font color="#E5E5E5"> know</font>

61
00:03:20,799 --> 00:03:25,480
Bitcoin related malicious activity was

62
00:03:22,750 --> 00:03:28,359
people ripping<font color="#E5E5E5"> off people's wallets</font><font color="#CCCCCC"> you</font>

63
00:03:25,480 --> 00:03:32,488
know figuring<font color="#E5E5E5"> out a way to either social</font>

64
00:03:28,359 --> 00:03:34,359
engineer them or take out the

65
00:03:32,489 --> 00:03:37,150
repositories the<font color="#E5E5E5"> cryptocurrency</font>

66
00:03:34,359 --> 00:03:39,310
exchanges and transfer out a lot of

67
00:03:37,150 --> 00:03:40,480
Bitcoin there so really it only was

68
00:03:39,310 --> 00:03:43,090
applicable to the<font color="#E5E5E5"> people who were</font>

69
00:03:40,480 --> 00:03:47,190
actually<font color="#CCCCCC"> holding Bitcoin rather than a</font>

70
00:03:43,090 --> 00:03:47,190
more you know general audience

71
00:03:48,750 --> 00:03:55,409
however<font color="#CCCCCC"> Bitcoin</font><font color="#E5E5E5"> is not the only</font>

72
00:03:52,780 --> 00:03:59,229
cryptocurrency out there<font color="#E5E5E5"> there are</font>

73
00:03:55,409 --> 00:04:01,929
thousands of<font color="#E5E5E5"> them now</font><font color="#CCCCCC"> but there's one in</font>

74
00:03:59,229 --> 00:04:04,659
particular<font color="#CCCCCC"> that's really become popular</font>

75
00:04:01,930 --> 00:04:08,349
<font color="#E5E5E5">as you</font><font color="#CCCCCC"> know being</font><font color="#E5E5E5"> used in this type of</font>

76
00:04:04,659 --> 00:04:11,828
an attack<font color="#E5E5E5"> and that's mineiro</font><font color="#CCCCCC"> the reason</font>

77
00:04:08,349 --> 00:04:13,179
why<font color="#CCCCCC"> Manero is so popular even</font><font color="#E5E5E5"> though</font>

78
00:04:11,829 --> 00:04:15,970
<font color="#E5E5E5">it's not necessary worth as much</font><font color="#CCCCCC"> as</font>

79
00:04:13,180 --> 00:04:18,510
other<font color="#E5E5E5"> crypto currencies is the fact that</font>

80
00:04:15,970 --> 00:04:23,830
you can mine<font color="#CCCCCC"> it on literally anything</font>

81
00:04:18,510 --> 00:04:25,170
<font color="#CCCCCC">down</font><font color="#E5E5E5"> to the weakest CPU up to you know a</font>

82
00:04:23,830 --> 00:04:28,409
crazy

83
00:04:25,170 --> 00:04:31,800
you know<font color="#E5E5E5"> 24 korzy on or you know above</font>

84
00:04:28,410 --> 00:04:34,950
and beyond that<font color="#CCCCCC"> the reason why</font><font color="#E5E5E5"> that's</font>

85
00:04:31,800 --> 00:04:37,650
effective is a few things<font color="#E5E5E5"> one is it uses</font>

86
00:04:34,950 --> 00:04:41,670
a specific<font color="#CCCCCC"> algorithm called kryptonite</font>

87
00:04:37,650 --> 00:04:45,750
which is optimized for CPU<font color="#E5E5E5"> and doesn't</font>

88
00:04:41,670 --> 00:04:49,560
scale well<font color="#E5E5E5"> with GPU</font><font color="#CCCCCC"> or ASIC type</font>

89
00:04:45,750 --> 00:04:53,870
architecture so<font color="#E5E5E5"> while you can mine it on</font>

90
00:04:49,560 --> 00:04:56,640
a GPU<font color="#E5E5E5"> or you could create an ASIC for it</font>

91
00:04:53,870 --> 00:04:58,890
<font color="#CCCCCC">you don't get the same scalability with</font>

92
00:04:56,640 --> 00:05:02,810
it<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> do with a crypto currency</font>

93
00:04:58,890 --> 00:05:06,240
like<font color="#CCCCCC"> Bitcoin</font><font color="#E5E5E5"> and even with that the</font>

94
00:05:02,810 --> 00:05:08,940
people are the<font color="#E5E5E5"> developers I guess I</font>

95
00:05:06,240 --> 00:05:11,310
should say behind<font color="#CCCCCC"> Manero</font><font color="#E5E5E5"> have kind of</font>

96
00:05:08,940 --> 00:05:13,590
<font color="#E5E5E5">taken a stance</font><font color="#CCCCCC"> they don't want</font><font color="#E5E5E5"> that to</font>

97
00:05:11,310 --> 00:05:17,220
become<font color="#CCCCCC"> a thing</font><font color="#E5E5E5"> there was actually a</font>

98
00:05:13,590 --> 00:05:19,140
<font color="#CCCCCC">recent</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> within</font><font color="#E5E5E5"> last month where one</font>

99
00:05:17,220 --> 00:05:22,650
of<font color="#E5E5E5"> the big firms out of China had built</font>

100
00:05:19,140 --> 00:05:25,380
an ASIC<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Manero</font><font color="#E5E5E5"> and the dev team</font>

101
00:05:22,650 --> 00:05:27,900
<font color="#E5E5E5">behind</font><font color="#CCCCCC"> Manero</font><font color="#E5E5E5"> card for cryptocurrency to</font>

102
00:05:25,380 --> 00:05:29,610
<font color="#E5E5E5">say no we're not going</font><font color="#CCCCCC"> to let you do</font>

103
00:05:27,900 --> 00:05:31,710
that<font color="#CCCCCC"> so as soon as</font><font color="#E5E5E5"> an ASIC was available</font>

104
00:05:29,610 --> 00:05:34,560
<font color="#E5E5E5">they made the conscious decision that</font>

105
00:05:31,710 --> 00:05:36,330
<font color="#E5E5E5">they weren't</font><font color="#CCCCCC"> going to allow</font><font color="#E5E5E5"> it so they</font>

106
00:05:34,560 --> 00:05:45,600
<font color="#E5E5E5">changed</font><font color="#CCCCCC"> the algorithm slightly so that</font>

107
00:05:36,330 --> 00:05:47,159
<font color="#E5E5E5">the ASIC became useless</font><font color="#CCCCCC"> so with a</font>

108
00:05:45,600 --> 00:05:50,820
cryptocurrency<font color="#E5E5E5"> that you can mine on</font>

109
00:05:47,160 --> 00:05:54,480
pretty much anything<font color="#CCCCCC"> there's really</font><font color="#E5E5E5"> been</font>

110
00:05:50,820 --> 00:05:56,909
an increase so I myself work in a web

111
00:05:54,480 --> 00:05:59,880
server environment<font color="#CCCCCC"> so we don't</font><font color="#E5E5E5"> have you</font>

112
00:05:56,910 --> 00:06:02,490
<font color="#CCCCCC">know a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> endpoints or you know</font>

113
00:05:59,880 --> 00:06:05,730
<font color="#E5E5E5">people behind a keyboard</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> dealing</font>

114
00:06:02,490 --> 00:06:08,270
with<font color="#E5E5E5"> what's on the other end</font><font color="#CCCCCC"> personally</font>

115
00:06:05,730 --> 00:06:09,420
I kind<font color="#E5E5E5"> of started noticing this around</font>

116
00:06:08,270 --> 00:06:13,710
<font color="#CCCCCC">mmm</font>

117
00:06:09,420 --> 00:06:16,590
act over November of 2017<font color="#CCCCCC"> that you know</font>

118
00:06:13,710 --> 00:06:18,979
our traditional investigations<font color="#E5E5E5"> for you</font>

119
00:06:16,590 --> 00:06:21,750
know<font color="#E5E5E5"> compromise</font><font color="#CCCCCC"> on a web server</font>

120
00:06:18,980 --> 00:06:24,270
<font color="#E5E5E5">generally we're looking at someone</font>

121
00:06:21,750 --> 00:06:26,340
throwing up<font color="#E5E5E5"> a phishing page or someone</font>

122
00:06:24,270 --> 00:06:28,620
sending spam from<font color="#E5E5E5"> the server those tend</font>

123
00:06:26,340 --> 00:06:30,840
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> the two ways</font><font color="#E5E5E5"> that when a server</font>

124
00:06:28,620 --> 00:06:34,350
got compromised what the attackers<font color="#E5E5E5"> leave</font>

125
00:06:30,840 --> 00:06:37,349
there<font color="#E5E5E5"> and around last October November I</font>

126
00:06:34,350 --> 00:06:40,710
started to notice an<font color="#E5E5E5"> increase in</font>

127
00:06:37,350 --> 00:06:44,100
crypto miners<font color="#E5E5E5"> we kind of first like</font>

128
00:06:40,710 --> 00:06:47,640
witnessed it around like<font color="#E5E5E5"> end of 2016</font>

129
00:06:44,100 --> 00:06:50,700
<font color="#E5E5E5">early 2017</font><font color="#CCCCCC"> when there was some</font>

130
00:06:47,640 --> 00:06:52,229
<font color="#CCCCCC">acquisitions that occurred and we</font>

131
00:06:50,700 --> 00:06:55,979
discovered it running on<font color="#E5E5E5"> some of those</font>

132
00:06:52,230 --> 00:06:57,870
servers<font color="#E5E5E5"> that we acquired</font><font color="#CCCCCC"> but there</font>

133
00:06:55,980 --> 00:07:00,240
really wasn't a whole<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> it up until</font>

134
00:06:57,870 --> 00:07:04,080
around<font color="#E5E5E5"> that act over November timeframe</font>

135
00:07:00,240 --> 00:07:09,600
<font color="#CCCCCC">and from the data</font><font color="#E5E5E5"> like I've been able to</font>

136
00:07:04,080 --> 00:07:13,349
find<font color="#E5E5E5"> that's pretty common around so I've</font>

137
00:07:09,600 --> 00:07:15,660
got<font color="#CCCCCC"> up the see</font><font color="#E5E5E5"> is malware trends from</font>

138
00:07:13,350 --> 00:07:17,460
December in<font color="#CCCCCC"> which a coin miner</font><font color="#E5E5E5"> was</font>

139
00:07:15,660 --> 00:07:18,870
listed as the<font color="#E5E5E5"> second highest piece of</font>

140
00:07:17,460 --> 00:07:22,530
<font color="#CCCCCC">malware that</font><font color="#E5E5E5"> they were witnessing as</font>

141
00:07:18,870 --> 00:07:24,270
well as the recently Microsoft put

142
00:07:22,530 --> 00:07:29,489
together some statistics from<font color="#E5E5E5"> their</font>

143
00:07:24,270 --> 00:07:33,120
Windows Defender<font color="#CCCCCC"> a TTP platform</font><font color="#E5E5E5"> where</font>

144
00:07:29,490 --> 00:07:35,400
the top one was towards<font color="#CCCCCC"> the end of last</font>

145
00:07:33,120 --> 00:07:38,550
year where you can kind of see it up and

146
00:07:35,400 --> 00:07:40,620
down and up and<font color="#CCCCCC"> down but then the bottom</font>

147
00:07:38,550 --> 00:07:42,450
one<font color="#E5E5E5"> there goes through</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> this last</font>

148
00:07:40,620 --> 00:07:50,190
March and<font color="#CCCCCC"> you can see a much more</font>

149
00:07:42,450 --> 00:07:52,050
<font color="#CCCCCC">obvious</font><font color="#E5E5E5"> trend increasing</font><font color="#CCCCCC"> there so as I</font>

150
00:07:50,190 --> 00:07:55,140
started noticing<font color="#CCCCCC"> you know the increase</font>

151
00:07:52,050 --> 00:07:57,870
here I kind of took it upon<font color="#CCCCCC"> myself to</font>

152
00:07:55,140 --> 00:07:59,460
figure<font color="#E5E5E5"> out how prevalent it was in our</font>

153
00:07:57,870 --> 00:07:59,880
environment<font color="#E5E5E5"> and what we could do about</font>

154
00:07:59,460 --> 00:08:03,989
it

155
00:07:59,880 --> 00:08:06,690
so I am a sysadmin I'm not in the

156
00:08:03,990 --> 00:08:09,090
dedicated security<font color="#E5E5E5"> group so a lot of</font>

157
00:08:06,690 --> 00:08:11,400
<font color="#E5E5E5">this was pretty informal but I did have</font>

158
00:08:09,090 --> 00:08:15,119
the<font color="#E5E5E5"> support of my management staff in</font>

159
00:08:11,400 --> 00:08:17,599
the support side of things and so

160
00:08:15,120 --> 00:08:21,390
initially<font color="#CCCCCC"> I started with what I knew the</font>

161
00:08:17,600 --> 00:08:24,360
cases that<font color="#CCCCCC"> I worked on personally and</font>

162
00:08:21,390 --> 00:08:27,539
kind<font color="#E5E5E5"> of going up from there</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> we</font>

163
00:08:24,360 --> 00:08:30,720
do a lot<font color="#CCCCCC"> of you know one-off</font><font color="#E5E5E5"> cases for</font>

164
00:08:27,540 --> 00:08:32,190
different<font color="#E5E5E5"> clients so we</font><font color="#CCCCCC"> often will you</font>

165
00:08:30,720 --> 00:08:34,289
know reach<font color="#E5E5E5"> out to each other in slack</font>

166
00:08:32,190 --> 00:08:35,910
channels so there was a lot<font color="#CCCCCC"> of data</font><font color="#E5E5E5"> I</font>

167
00:08:34,289 --> 00:08:38,699
<font color="#CCCCCC">could pull from our internal slack</font>

168
00:08:35,909 --> 00:08:40,439
channels as<font color="#E5E5E5"> well as then going out</font><font color="#CCCCCC"> to</font>

169
00:08:38,700 --> 00:08:42,990
the ticketing system looking for<font color="#CCCCCC"> people</font>

170
00:08:40,440 --> 00:08:46,200
<font color="#CCCCCC">who had either left it in their notes or</font>

171
00:08:42,990 --> 00:08:47,260
had been reported by a client<font color="#CCCCCC"> that</font><font color="#E5E5E5"> sort</font>

172
00:08:46,200 --> 00:08:50,170
of stuff

173
00:08:47,260 --> 00:08:53,950
pretty soon<font color="#CCCCCC"> I was able</font><font color="#E5E5E5"> to gather a</font>

174
00:08:50,170 --> 00:08:58,180
pretty good amount<font color="#E5E5E5"> of data</font><font color="#CCCCCC"> I'm well over</font>

175
00:08:53,950 --> 00:09:01,060
<font color="#CCCCCC">a hundred cases at this point a trying</font>

176
00:08:58,180 --> 00:09:05,050
<font color="#CCCCCC">ad though as</font><font color="#E5E5E5"> many more as I can as time</font>

177
00:09:01,060 --> 00:09:08,079
allows<font color="#CCCCCC"> but</font><font color="#E5E5E5"> definitely some stuff started</font>

178
00:09:05,050 --> 00:09:11,560
to<font color="#E5E5E5"> kind of trickle</font><font color="#CCCCCC"> out that was pretty</font>

179
00:09:08,080 --> 00:09:13,870
constant between<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of the cases and it</font>

180
00:09:11,560 --> 00:09:16,709
<font color="#E5E5E5">was</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> focused around those three</font>

181
00:09:13,870 --> 00:09:19,450
things up there<font color="#E5E5E5"> so mining pools</font>

182
00:09:16,710 --> 00:09:21,490
my name is software<font color="#CCCCCC"> in use and the</font>

183
00:09:19,450 --> 00:09:28,000
network traffic that's associated with

184
00:09:21,490 --> 00:09:31,090
<font color="#E5E5E5">that</font><font color="#CCCCCC"> so while you</font><font color="#E5E5E5"> can mine</font>

185
00:09:28,000 --> 00:09:34,360
cryptocurrency a lot on your<font color="#E5E5E5"> own</font><font color="#CCCCCC"> going</font>

186
00:09:31,090 --> 00:09:36,700
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to the idea of scale the person</font>

187
00:09:34,360 --> 00:09:39,180
with<font color="#E5E5E5"> the most</font><font color="#CCCCCC"> compute power is going to</font>

188
00:09:36,700 --> 00:09:43,990
have the best<font color="#E5E5E5"> chance of being rewarded</font>

189
00:09:39,180 --> 00:09:48,370
when the mining block<font color="#E5E5E5"> gets paid out</font><font color="#CCCCCC"> so a</font>

190
00:09:43,990 --> 00:09:52,420
lot<font color="#CCCCCC"> of a lot of miners put</font><font color="#E5E5E5"> into a pool</font>

191
00:09:48,370 --> 00:09:55,210
<font color="#CCCCCC">so everyone basically</font><font color="#E5E5E5"> runs their crypto</font>

192
00:09:52,420 --> 00:09:57,000
miners that<font color="#CCCCCC"> are running complex</font><font color="#E5E5E5"> you know</font>

193
00:09:55,210 --> 00:10:00,910
<font color="#E5E5E5">basically they're trying</font><font color="#CCCCCC"> to brute-force</font>

194
00:09:57,000 --> 00:10:03,370
hashes<font color="#CCCCCC"> and based</font><font color="#E5E5E5"> on if they're</font>

195
00:10:00,910 --> 00:10:05,530
successful with that<font color="#E5E5E5"> they you know</font>

196
00:10:03,370 --> 00:10:08,770
submit it off to the greater ledger out

197
00:10:05,530 --> 00:10:12,010
there and are<font color="#CCCCCC"> rewarded whoever can break</font>

198
00:10:08,770 --> 00:10:14,260
it first gets<font color="#E5E5E5"> that reward so if you</font>

199
00:10:12,010 --> 00:10:17,860
participate in a pool with everyone

200
00:10:14,260 --> 00:10:19,360
contributing<font color="#E5E5E5"> their CPU cycles you have</font>

201
00:10:17,860 --> 00:10:22,840
much higher likelihood<font color="#E5E5E5"> that you're gonna</font>

202
00:10:19,360 --> 00:10:24,850
break that<font color="#E5E5E5"> first and</font><font color="#CCCCCC"> then the pool pays</font>

203
00:10:22,840 --> 00:10:28,210
out based on<font color="#E5E5E5"> how much compute power you</font>

204
00:10:24,850 --> 00:10:30,100
contributed to the<font color="#CCCCCC"> overall pool</font><font color="#E5E5E5"> so again</font>

205
00:10:28,210 --> 00:10:32,530
it's<font color="#CCCCCC"> just an idea that with</font><font color="#E5E5E5"> the more</font>

206
00:10:30,100 --> 00:10:39,820
scale easier it is for you to make the

207
00:10:32,530 --> 00:10:42,160
<font color="#E5E5E5">mutton</font><font color="#CCCCCC"> based on the data that I gathered</font>

208
00:10:39,820 --> 00:10:45,730
we can see that some pools at least in

209
00:10:42,160 --> 00:10:49,480
my<font color="#CCCCCC"> environment were much more likely</font>

210
00:10:45,730 --> 00:10:52,120
<font color="#CCCCCC">than others with a</font><font color="#E5E5E5"> particular crypto</font>

211
00:10:49,480 --> 00:10:55,870
mining pool out of France<font color="#E5E5E5"> being the top</font>

212
00:10:52,120 --> 00:10:59,560
player here crypto<font color="#CCCCCC"> pool dat Fr</font>

213
00:10:55,870 --> 00:11:01,600
and some other ones<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are a little</font>

214
00:10:59,560 --> 00:11:04,779
<font color="#CCCCCC">bit more trying to</font><font color="#E5E5E5"> hide what they are</font>

215
00:11:01,600 --> 00:11:10,209
like<font color="#E5E5E5"> one of</font><font color="#CCCCCC"> my favorites is the Linux -</font>

216
00:11:04,779 --> 00:11:13,569
repository - updates<font color="#E5E5E5"> calm and there's a</font>

217
00:11:10,209 --> 00:11:17,079
<font color="#E5E5E5">little bit of</font><font color="#CCCCCC"> a difference so many pools</font>

218
00:11:13,569 --> 00:11:22,329
are public like that crypto<font color="#E5E5E5"> pool that</font>

219
00:11:17,079 --> 00:11:24,489
<font color="#CCCCCC">eff are</font><font color="#E5E5E5"> however some actors will create</font>

220
00:11:22,329 --> 00:11:27,939
a<font color="#E5E5E5"> private pool so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> Linux repository</font>

221
00:11:24,490 --> 00:11:29,680
updates is not a<font color="#E5E5E5"> public pool and there</font>

222
00:11:27,939 --> 00:11:31,870
isn't the ability<font color="#CCCCCC"> to gather more</font><font color="#E5E5E5"> data</font>

223
00:11:29,680 --> 00:11:36,969
from<font color="#E5E5E5"> that which I'll kind of show a</font>

224
00:11:31,870 --> 00:11:39,220
little<font color="#E5E5E5"> bit further on here so</font><font color="#CCCCCC"> besides</font>

225
00:11:36,970 --> 00:11:42,790
the<font color="#E5E5E5"> domains another thing that stood out</font>

226
00:11:39,220 --> 00:11:44,680
pretty quickly is the ports in use when

227
00:11:42,790 --> 00:11:47,410
they are<font color="#CCCCCC"> communicating</font><font color="#E5E5E5"> back to that pool</font>

228
00:11:44,680 --> 00:11:49,870
so when the<font color="#E5E5E5"> miners running it's running</font>

229
00:11:47,410 --> 00:11:52,449
those<font color="#E5E5E5"> calculations constantly and</font>

230
00:11:49,870 --> 00:11:54,670
quickly<font color="#E5E5E5"> and it needs</font><font color="#CCCCCC"> to report every</font>

231
00:11:52,449 --> 00:11:56,859
time it's run a calculation back to the

232
00:11:54,670 --> 00:12:00,399
pool<font color="#CCCCCC"> so the network communication is</font>

233
00:11:56,860 --> 00:12:03,939
pretty much constant<font color="#E5E5E5"> and in this case in</font>

234
00:12:00,399 --> 00:12:07,689
<font color="#CCCCCC">my data set we saw a lot of port quad</font>

235
00:12:03,939 --> 00:12:11,529
<font color="#CCCCCC">for a lot of quad</font><font color="#E5E5E5"> digits there so a lot</font>

236
00:12:07,689 --> 00:12:14,709
of quad for quad<font color="#E5E5E5"> seven</font><font color="#CCCCCC"> quad fives</font><font color="#E5E5E5"> and a</font>

237
00:12:11,529 --> 00:12:16,779
few others like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> again some tried to</font>

238
00:12:14,709 --> 00:12:20,619
be more<font color="#E5E5E5"> stealthy using more standard</font>

239
00:12:16,779 --> 00:12:22,269
<font color="#CCCCCC">courts like port 80 or</font><font color="#E5E5E5"> port 8080</font><font color="#CCCCCC"> but</font>

240
00:12:20,620 --> 00:12:24,370
<font color="#E5E5E5">depending on</font><font color="#CCCCCC"> what your monitoring</font>

241
00:12:22,269 --> 00:12:30,309
there's ways that<font color="#CCCCCC"> you can kind</font><font color="#E5E5E5"> of keep</font>

242
00:12:24,370 --> 00:12:34,899
<font color="#E5E5E5">an eye out</font><font color="#CCCCCC"> for that</font><font color="#E5E5E5"> stuff - okay</font><font color="#CCCCCC"> so</font>

243
00:12:30,309 --> 00:12:36,459
running<font color="#E5E5E5"> back to the pool here how did we</font>

244
00:12:34,899 --> 00:12:39,069
gather some of<font color="#E5E5E5"> this data well if you do</font>

245
00:12:36,459 --> 00:12:40,839
go<font color="#CCCCCC"> to those public pools they're all</font>

246
00:12:39,069 --> 00:12:43,660
about<font color="#E5E5E5"> getting you on</font><font color="#CCCCCC"> the you know</font><font color="#E5E5E5"> the</font>

247
00:12:40,839 --> 00:12:47,379
crypto coin hype train so they<font color="#CCCCCC"> publish</font>

248
00:12:43,660 --> 00:12:50,529
all the<font color="#E5E5E5"> data so this is from that crypto</font>

249
00:12:47,379 --> 00:12:52,540
pool<font color="#CCCCCC"> FR there these</font><font color="#E5E5E5"> are the</font><font color="#CCCCCC"> programs</font>

250
00:12:50,529 --> 00:12:55,360
they recommend<font color="#E5E5E5"> you use along</font><font color="#CCCCCC"> with the</font>

251
00:12:52,540 --> 00:12:57,550
<font color="#E5E5E5">recommended configuration settings so</font>

252
00:12:55,360 --> 00:12:59,439
just by simply heading over to here<font color="#E5E5E5"> I</font>

253
00:12:57,550 --> 00:13:02,139
was able<font color="#E5E5E5"> to gather a lot</font><font color="#CCCCCC"> of information</font>

254
00:12:59,439 --> 00:13:06,040
especially<font color="#E5E5E5"> via these configuration</font>

255
00:13:02,139 --> 00:13:08,259
settings to know<font color="#CCCCCC"> what</font><font color="#E5E5E5"> program was</font>

256
00:13:06,040 --> 00:13:09,339
running<font color="#E5E5E5"> so when it's actually</font><font color="#CCCCCC"> running</font><font color="#E5E5E5"> on</font>

257
00:13:08,259 --> 00:13:11,920
the system<font color="#CCCCCC"> you</font>

258
00:13:09,340 --> 00:13:14,950
can take a look at how the in figuration

259
00:13:11,920 --> 00:13:17,560
is<font color="#E5E5E5"> set up</font><font color="#CCCCCC"> to know what kind of actual</font>

260
00:13:14,950 --> 00:13:18,940
<font color="#CCCCCC">miner is running on the system because</font>

261
00:13:17,560 --> 00:13:23,979
each of them uses a slightly different

262
00:13:18,940 --> 00:13:25,870
<font color="#E5E5E5">syntax</font><font color="#CCCCCC"> so I mean it's not you know</font><font color="#E5E5E5"> that</font>

263
00:13:23,980 --> 00:13:27,910
<font color="#E5E5E5">you have to know what the miner is but</font>

264
00:13:25,870 --> 00:13:31,800
it's kind of a neat data point<font color="#E5E5E5"> to just</font>

265
00:13:27,910 --> 00:13:31,800
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of see what's being used</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> there</font>

266
00:13:33,660 --> 00:13:37,600
secondly they<font color="#E5E5E5"> publish how you</font>

267
00:13:36,550 --> 00:13:41,079
communicate with it

268
00:13:37,600 --> 00:13:42,580
so here's that<font color="#CCCCCC"> list of ports</font><font color="#E5E5E5"> which might</font>

269
00:13:41,080 --> 00:13:45,160
be a little<font color="#CCCCCC"> hard</font><font color="#E5E5E5"> to see from the back</font>

270
00:13:42,580 --> 00:13:47,320
but<font color="#CCCCCC"> they're severe saying hey if you</font>

271
00:13:45,160 --> 00:13:50,230
want to<font color="#E5E5E5"> mine this particular block of</font>

272
00:13:47,320 --> 00:13:53,500
the<font color="#E5E5E5"> cryptocurrency communicate to us on</font>

273
00:13:50,230 --> 00:13:58,300
port<font color="#CCCCCC"> Quad 3 if you would rather try this</font>

274
00:13:53,500 --> 00:14:02,470
<font color="#E5E5E5">block communicate on quad</font><font color="#CCCCCC"> 7 so depending</font>

275
00:13:58,300 --> 00:14:03,939
on what<font color="#E5E5E5"> the attacker if they know what</font>

276
00:14:02,470 --> 00:14:06,040
infrastructure<font color="#E5E5E5"> they're mining on they</font>

277
00:14:03,940 --> 00:14:07,590
can kind of tune<font color="#E5E5E5"> because</font><font color="#CCCCCC"> different</font>

278
00:14:06,040 --> 00:14:11,469
blocks have different difficulty levels

279
00:14:07,590 --> 00:14:13,840
<font color="#E5E5E5">so I didn't get too deep into trying to</font>

280
00:14:11,470 --> 00:14:16,150
<font color="#E5E5E5">figure out how you know complex they</font>

281
00:14:13,840 --> 00:14:18,400
were doing with that but essentially<font color="#E5E5E5"> you</font>

282
00:14:16,150 --> 00:14:20,500
can get some idea<font color="#CCCCCC"> of what they're</font>

283
00:14:18,400 --> 00:14:23,199
targeting just based on what difficulty

284
00:14:20,500 --> 00:14:31,240
<font color="#E5E5E5">level</font><font color="#CCCCCC"> they're actually targeting at the</font>

285
00:14:23,200 --> 00:14:35,110
mining pools<font color="#CCCCCC"> the next thing that became</font>

286
00:14:31,240 --> 00:14:40,870
pretty readily apparent and kind<font color="#E5E5E5"> of cool</font>

287
00:14:35,110 --> 00:14:42,700
to dig into was the keys in use so you

288
00:14:40,870 --> 00:14:45,210
know<font color="#CCCCCC"> cryptocurrency is essentially run</font>

289
00:14:42,700 --> 00:14:48,220
on a public/private key pair system<font color="#CCCCCC"> and</font>

290
00:14:45,210 --> 00:14:50,620
so since they're talking<font color="#CCCCCC"> to these pools</font>

291
00:14:48,220 --> 00:14:52,510
<font color="#E5E5E5">they need to be able to prove</font><font color="#CCCCCC"> that</font>

292
00:14:50,620 --> 00:14:55,660
they're the<font color="#CCCCCC"> ones submitting the hashes</font>

293
00:14:52,510 --> 00:14:59,200
<font color="#E5E5E5">so in the configurations they have to</font>

294
00:14:55,660 --> 00:15:01,180
leave their public key behind and so

295
00:14:59,200 --> 00:15:03,490
depending<font color="#CCCCCC"> on the crypto minor in use</font>

296
00:15:01,180 --> 00:15:07,060
<font color="#E5E5E5">there's different places you can</font><font color="#CCCCCC"> look at</font>

297
00:15:03,490 --> 00:15:11,080
to<font color="#E5E5E5"> find that key and with that key you</font>

298
00:15:07,060 --> 00:15:15,400
can then<font color="#E5E5E5"> use that to figure out how much</font>

299
00:15:11,080 --> 00:15:17,130
money<font color="#CCCCCC"> or crypto coins</font><font color="#E5E5E5"> the actor has</font>

300
00:15:15,400 --> 00:15:20,899
actually mined

301
00:15:17,130 --> 00:15:25,380
[Music]

302
00:15:20,899 --> 00:15:28,709
in my<font color="#E5E5E5"> network in particular</font><font color="#CCCCCC"> I've found</font>

303
00:15:25,380 --> 00:15:31,920
over<font color="#E5E5E5"> 41 unique keys obviously there's</font>

304
00:15:28,709 --> 00:15:36,750
going to be some reuse from you know

305
00:15:31,920 --> 00:15:39,300
certain actors<font color="#CCCCCC"> but</font><font color="#E5E5E5"> in total if you I did</font>

306
00:15:36,750 --> 00:15:42,120
this can on<font color="#E5E5E5"> April 29th</font>

307
00:15:39,300 --> 00:15:46,399
I think<font color="#CCCCCC"> Manero is sitting at around 250</font>

308
00:15:42,120 --> 00:15:51,329
bucks a coin<font color="#E5E5E5"> that totaled up to</font><font color="#CCCCCC"> a 1.6</font>

309
00:15:46,399 --> 00:15:53,639
<font color="#CCCCCC">$1,000,000 now we're</font><font color="#E5E5E5"> not a huge</font><font color="#CCCCCC"> network</font>

310
00:15:51,329 --> 00:15:56,399
you know we're<font color="#CCCCCC"> nothing the scale of you</font>

311
00:15:53,639 --> 00:16:00,120
know an AWS and<font color="#E5E5E5"> Azure or anything like</font>

312
00:15:56,399 --> 00:16:03,389
<font color="#E5E5E5">that so that was kind of interesting</font><font color="#CCCCCC"> you</font>

313
00:16:00,120 --> 00:16:05,310
know point to see that even on a small

314
00:16:03,389 --> 00:16:06,870
player like us<font color="#E5E5E5"> and we might not have</font>

315
00:16:05,310 --> 00:16:09,540
<font color="#CCCCCC">been the</font><font color="#E5E5E5"> only ones targeted this may</font>

316
00:16:06,870 --> 00:16:12,149
have you know<font color="#E5E5E5"> been in other environments</font>

317
00:16:09,540 --> 00:16:13,969
<font color="#CCCCCC">as well</font><font color="#E5E5E5"> but at least you know there's</font>

318
00:16:12,149 --> 00:16:17,069
real<font color="#E5E5E5"> money to be made here</font>

319
00:16:13,970 --> 00:16:19,910
<font color="#CCCCCC">now</font><font color="#E5E5E5"> if they cashed out at the right time</font>

320
00:16:17,069 --> 00:16:23,130
which<font color="#E5E5E5"> would've</font><font color="#CCCCCC"> been back</font><font color="#E5E5E5"> around January</font>

321
00:16:19,910 --> 00:16:25,040
<font color="#E5E5E5">they that one point six would have been</font>

322
00:16:23,130 --> 00:16:28,589
worth<font color="#E5E5E5"> about three point two mil so</font>

323
00:16:25,040 --> 00:16:31,589
<font color="#E5E5E5">cryptocurrency is pretty you know up and</font>

324
00:16:28,589 --> 00:16:34,560
<font color="#E5E5E5">down as far as</font><font color="#CCCCCC"> you know volatility goes</font>

325
00:16:31,589 --> 00:16:36,000
but definitely money to be made here<font color="#CCCCCC"> I</font>

326
00:16:34,560 --> 00:16:38,189
know<font color="#E5E5E5"> that there's</font><font color="#CCCCCC"> been a lot of stories</font>

327
00:16:36,000 --> 00:16:40,470
<font color="#CCCCCC">you know recently joking about</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know</font>

328
00:16:38,189 --> 00:16:44,160
<font color="#E5E5E5">10,000 sites were infected with coin</font>

329
00:16:40,470 --> 00:16:47,490
hype they made<font color="#CCCCCC"> ten dollars</font><font color="#E5E5E5"> yeah that can</font>

330
00:16:44,160 --> 00:16:49,920
<font color="#CCCCCC">happen but you also have something</font><font color="#E5E5E5"> like</font>

331
00:16:47,490 --> 00:16:51,930
<font color="#CCCCCC">this</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know real money so depending on</font>

332
00:16:49,920 --> 00:16:54,029
how<font color="#E5E5E5"> it's deployed how well they're</font>

333
00:16:51,930 --> 00:16:56,219
working<font color="#CCCCCC"> and how long they keep it going</font>

334
00:16:54,029 --> 00:16:59,850
<font color="#CCCCCC">is ideally you're gonna make the most</font>

335
00:16:56,220 --> 00:17:03,569
money<font color="#CCCCCC"> by staying</font><font color="#E5E5E5"> undetected you know so</font>

336
00:16:59,850 --> 00:17:06,270
if you're not you know shaking the boat

337
00:17:03,569 --> 00:17:07,918
and you keep your presence there for a

338
00:17:06,270 --> 00:17:11,879
long<font color="#E5E5E5"> time you're gonna get the biggest</font>

339
00:17:07,919 --> 00:17:13,559
payout<font color="#E5E5E5"> now you have levels of attackers</font>

340
00:17:11,880 --> 00:17:15,539
just like with<font color="#CCCCCC"> anything</font><font color="#E5E5E5"> else and</font><font color="#CCCCCC"> a lot</font>

341
00:17:13,559 --> 00:17:18,030
of<font color="#CCCCCC"> them</font><font color="#E5E5E5"> don't</font><font color="#CCCCCC"> really pay attention to</font>

342
00:17:15,539 --> 00:17:19,650
<font color="#E5E5E5">that and they will run your CPUs at a</font>

343
00:17:18,030 --> 00:17:20,970
hundred<font color="#E5E5E5"> percent</font><font color="#CCCCCC"> all over the board</font><font color="#E5E5E5"> and</font>

344
00:17:19,650 --> 00:17:25,669
you're gonna find<font color="#E5E5E5"> out about it really</font>

345
00:17:20,970 --> 00:17:25,669
damn quick<font color="#E5E5E5"> but it varies</font>

346
00:17:25,949 --> 00:17:36,539
here's a list rebukes between the

347
00:17:32,220 --> 00:17:38,039
different minor keys<font color="#CCCCCC"> I have kind of a</font>

348
00:17:36,539 --> 00:17:42,919
few<font color="#CCCCCC"> different thoughts on this so</font>

349
00:17:38,039 --> 00:17:46,799
obviously<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can see some you know</font><font color="#CCCCCC"> a</font>

350
00:17:42,919 --> 00:17:49,470
<font color="#CCCCCC">some</font><font color="#E5E5E5"> of these keys definitely pulled in</font>

351
00:17:46,799 --> 00:17:50,070
<font color="#E5E5E5">a lot</font><font color="#CCCCCC"> more cryptocurrency than the</font>

352
00:17:49,470 --> 00:17:54,080
others

353
00:17:50,070 --> 00:17:57,320
I kind of have two feelings about this

354
00:17:54,080 --> 00:17:59,309
<font color="#E5E5E5">one so that one that has the</font><font color="#CCCCCC"> highest</font>

355
00:17:57,320 --> 00:18:02,249
setting<font color="#E5E5E5"> there on the graph</font>

356
00:17:59,309 --> 00:18:06,749
they actually got blocked<font color="#E5E5E5"> from</font>

357
00:18:02,249 --> 00:18:09,029
contributing<font color="#CCCCCC"> to</font><font color="#E5E5E5"> mining pools</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> in</font>

358
00:18:06,749 --> 00:18:11,940
this<font color="#E5E5E5"> case I saw it on the crypto pool</font>

359
00:18:09,029 --> 00:18:14,489
dot<font color="#E5E5E5"> F our domain</font><font color="#CCCCCC"> they had locked out</font>

360
00:18:11,940 --> 00:18:16,259
<font color="#E5E5E5">that person from being able to access</font>

361
00:18:14,489 --> 00:18:18,599
any of the funds<font color="#E5E5E5"> that hadn't already</font>

362
00:18:16,259 --> 00:18:22,229
been<font color="#CCCCCC"> distributed because they actually</font>

363
00:18:18,599 --> 00:18:24,749
<font color="#CCCCCC">have an anti botnet policy so that was</font>

364
00:18:22,229 --> 00:18:26,669
<font color="#E5E5E5">something interesting to find out so I</font>

365
00:18:24,749 --> 00:18:28,649
kind of have two feelings about whether

366
00:18:26,669 --> 00:18:32,489
either some people<font color="#CCCCCC"> are really really</font>

367
00:18:28,649 --> 00:18:35,399
<font color="#E5E5E5">good at deploying these</font><font color="#CCCCCC"> versus you know</font>

368
00:18:32,489 --> 00:18:37,950
<font color="#E5E5E5">everyone else really sucks at it or</font>

369
00:18:35,399 --> 00:18:40,408
perhaps after<font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the people who</font>

370
00:18:37,950 --> 00:18:42,179
were<font color="#E5E5E5"> successful realize</font><font color="#CCCCCC"> that they could</font>

371
00:18:40,409 --> 00:18:45,749
have their funds locked out they started

372
00:18:42,179 --> 00:18:47,879
<font color="#E5E5E5">you know splitting up which wallets they</font>

373
00:18:45,749 --> 00:18:55,139
use that way if one wallet<font color="#E5E5E5"> got shut</font><font color="#CCCCCC"> down</font>

374
00:18:47,879 --> 00:18:56,459
they didn't lose<font color="#E5E5E5"> a bunch of funds</font><font color="#CCCCCC"> so</font>

375
00:18:55,139 --> 00:18:57,418
<font color="#E5E5E5">originally when I started</font><font color="#CCCCCC"> doing</font>

376
00:18:56,460 --> 00:18:58,830
<font color="#E5E5E5">investigations</font>

377
00:18:57,419 --> 00:19:00,570
I was literally looking<font color="#CCCCCC"> at the</font>

378
00:18:58,830 --> 00:19:03,178
configurations and in a browser

379
00:19:00,570 --> 00:19:06,359
<font color="#E5E5E5">you know typing in you know crypto -</font>

380
00:19:03,179 --> 00:19:09,509
<font color="#CCCCCC">cool dot F R and search</font><font color="#E5E5E5"> the key within</font>

381
00:19:06,359 --> 00:19:11,428
<font color="#E5E5E5">that pool</font><font color="#CCCCCC"> and then I would go to the</font>

382
00:19:09,509 --> 00:19:14,309
<font color="#CCCCCC">next one and it would be</font><font color="#E5E5E5"> over here at</font>

383
00:19:11,429 --> 00:19:17,039
menards.com and that one over<font color="#CCCCCC"> there</font>

384
00:19:14,309 --> 00:19:20,989
which<font color="#E5E5E5"> hash to</font><font color="#CCCCCC"> our us you know</font><font color="#E5E5E5"> there's</font>

385
00:19:17,039 --> 00:19:24,649
really<font color="#CCCCCC"> time consuming</font><font color="#E5E5E5"> so lately though</font>

386
00:19:20,989 --> 00:19:28,889
<font color="#E5E5E5">catch all the malware here on Twitter</font>

387
00:19:24,649 --> 00:19:32,969
<font color="#E5E5E5">made it much much easier by</font><font color="#CCCCCC"> creating</font><font color="#E5E5E5"> XMR</font>

388
00:19:28,889 --> 00:19:37,109
<font color="#E5E5E5">hunter</font><font color="#CCCCCC"> comm you can plug in</font><font color="#E5E5E5"> the Monaro</font>

389
00:19:32,970 --> 00:19:37,810
key that you<font color="#E5E5E5"> have and it will go query</font>

390
00:19:37,109 --> 00:19:41,560
all<font color="#CCCCCC"> of the</font>

391
00:19:37,810 --> 00:19:45,280
public available pools for you<font color="#CCCCCC"> so that</font>

392
00:19:41,560 --> 00:19:47,470
has<font color="#E5E5E5"> been extremely helpful in speeding</font>

393
00:19:45,280 --> 00:19:49,930
<font color="#E5E5E5">up the you know</font>

394
00:19:47,470 --> 00:19:52,510
ways<font color="#CCCCCC"> to find and you you might not know</font>

395
00:19:49,930 --> 00:19:55,030
is again so for instance they might be

396
00:19:52,510 --> 00:19:57,550
on your<font color="#E5E5E5"> network mining to crypto</font><font color="#CCCCCC"> pool</font>

397
00:19:55,030 --> 00:19:59,830
<font color="#CCCCCC">about fr</font><font color="#E5E5E5"> but on another network using</font>

398
00:19:57,550 --> 00:20:02,230
the<font color="#E5E5E5"> same key they might be mining</font><font color="#CCCCCC"> some</font>

399
00:19:59,830 --> 00:20:05,679
<font color="#CCCCCC">monaro hash comm</font><font color="#E5E5E5"> so it just gives</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> a</font>

400
00:20:02,230 --> 00:20:07,150
better overall idea of<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> what</font>

401
00:20:05,680 --> 00:20:11,800
those returns that they're getting<font color="#CCCCCC"> on</font>

402
00:20:07,150 --> 00:20:16,300
that particular campaign<font color="#E5E5E5"> recently they</font>

403
00:20:11,800 --> 00:20:18,520
have<font color="#E5E5E5"> Pingdom because I've been noticing</font>

404
00:20:16,300 --> 00:20:20,770
<font color="#CCCCCC">some other cryptocurrency is starting to</font>

405
00:20:18,520 --> 00:20:25,330
gain some<font color="#CCCCCC"> popularity with the</font><font color="#E5E5E5"> malware</font>

406
00:20:20,770 --> 00:20:27,520
<font color="#CCCCCC">authors</font><font color="#E5E5E5"> particularly sumo coin</font><font color="#CCCCCC"> has</font>

407
00:20:25,330 --> 00:20:29,909
<font color="#E5E5E5">started to get up there which made a lot</font>

408
00:20:27,520 --> 00:20:33,639
of sense after<font color="#CCCCCC"> I</font><font color="#E5E5E5"> first investigated one</font>

409
00:20:29,910 --> 00:20:35,680
<font color="#E5E5E5">sumo coin is a derivative of</font><font color="#CCCCCC"> Manero</font><font color="#E5E5E5"> so</font>

410
00:20:33,640 --> 00:20:39,280
it's basically<font color="#CCCCCC"> Manero</font><font color="#E5E5E5"> with some new</font>

411
00:20:35,680 --> 00:20:43,690
<font color="#E5E5E5">features</font><font color="#CCCCCC"> added to it and he has added</font>

412
00:20:39,280 --> 00:20:46,780
<font color="#E5E5E5">sumo coin cools to it now as well so all</font>

413
00:20:43,690 --> 00:20:48,430
the awesome on that<font color="#CCCCCC"> light coin is</font>

414
00:20:46,780 --> 00:20:50,889
another one that's shown up but it's

415
00:20:48,430 --> 00:20:53,620
<font color="#E5E5E5">been very very rare</font><font color="#CCCCCC"> and at least</font><font color="#E5E5E5"> as far</font>

416
00:20:50,890 --> 00:20:55,840
as<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> aware that tends to be one of the</font>

417
00:20:53,620 --> 00:20:58,270
crypto currencies<font color="#CCCCCC"> that tends to</font><font color="#E5E5E5"> do a</font>

418
00:20:55,840 --> 00:21:01,179
little<font color="#E5E5E5"> bit better on GPU mining as</font>

419
00:20:58,270 --> 00:21:02,950
opposed to CPU mining so that one it's

420
00:21:01,180 --> 00:21:10,450
kind of<font color="#E5E5E5"> an outlier for me I'm not quite</font>

421
00:21:02,950 --> 00:21:12,250
sure<font color="#E5E5E5"> if that's actually in use much and</font>

422
00:21:10,450 --> 00:21:15,010
so specifically everything up to this

423
00:21:12,250 --> 00:21:18,700
point<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been talking about mining on</font>

424
00:21:15,010 --> 00:21:21,129
the server CPU<font color="#E5E5E5"> itself but this isn't the</font>

425
00:21:18,700 --> 00:21:24,610
<font color="#E5E5E5">only way</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> attackers are trying to</font>

426
00:21:21,130 --> 00:21:26,200
monetize their access the other<font color="#E5E5E5"> form</font>

427
00:21:24,610 --> 00:21:29,260
that's quite popular right now<font color="#CCCCCC"> is</font>

428
00:21:26,200 --> 00:21:31,750
referred to as crypto<font color="#CCCCCC"> jackin this one</font>

429
00:21:29,260 --> 00:21:34,810
tends to<font color="#CCCCCC"> not use the mining pool</font>

430
00:21:31,750 --> 00:21:37,300
infrastructure but instead it<font color="#E5E5E5"> uses coin</font>

431
00:21:34,810 --> 00:21:40,120
hive which is a group<font color="#E5E5E5"> that got together</font>

432
00:21:37,300 --> 00:21:42,510
and<font color="#E5E5E5"> created</font><font color="#CCCCCC"> a service</font><font color="#E5E5E5"> where you insert</font>

433
00:21:40,120 --> 00:21:45,250
their JavaScript<font color="#E5E5E5"> into your website</font><font color="#CCCCCC"> and</font>

434
00:21:42,510 --> 00:21:48,100
<font color="#E5E5E5">they will pay you out based on how</font><font color="#CCCCCC"> many</font>

435
00:21:45,250 --> 00:21:50,930
clients<font color="#E5E5E5"> are connected to your</font><font color="#CCCCCC"> website at</font>

436
00:21:48,100 --> 00:21:55,730
<font color="#E5E5E5">any one time</font><font color="#CCCCCC"> mining Manero</font><font color="#E5E5E5"> in there</font>

437
00:21:50,930 --> 00:21:59,750
browser<font color="#E5E5E5"> so this one gets a little more</font>

438
00:21:55,730 --> 00:22:03,290
tricky<font color="#CCCCCC"> since it</font><font color="#E5E5E5"> is JavaScript</font><font color="#CCCCCC"> it can be</font>

439
00:21:59,750 --> 00:22:04,580
injected<font color="#E5E5E5"> in various different</font><font color="#CCCCCC"> ways if</font>

440
00:22:03,290 --> 00:22:06,230
they're mining on the server<font color="#E5E5E5"> itself</font>

441
00:22:04,580 --> 00:22:08,600
there's actually a<font color="#CCCCCC"> binary on the server</font>

442
00:22:06,230 --> 00:22:11,270
that's<font color="#CCCCCC"> running so that</font><font color="#E5E5E5"> is pretty</font><font color="#CCCCCC"> easy</font>

443
00:22:08,600 --> 00:22:14,600
<font color="#E5E5E5">for myself in our organization</font><font color="#CCCCCC"> to kind</font>

444
00:22:11,270 --> 00:22:16,879
of track and you know detect crypto

445
00:22:14,600 --> 00:22:19,639
<font color="#E5E5E5">jacking on the other hand it could be on</font>

446
00:22:16,880 --> 00:22:21,110
<font color="#E5E5E5">the server so we have caught it where</font>

447
00:22:19,640 --> 00:22:23,120
it's actually<font color="#E5E5E5"> been you know they've</font>

448
00:22:21,110 --> 00:22:25,760
gotten<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the CMS</font><font color="#CCCCCC"> and they've</font>

449
00:22:23,120 --> 00:22:29,360
modified<font color="#CCCCCC"> the header file and dropped in</font>

450
00:22:25,760 --> 00:22:32,870
the coin hive<font color="#CCCCCC"> you know code in</font><font color="#E5E5E5"> there but</font>

451
00:22:29,360 --> 00:22:36,020
we've also done various<font color="#E5E5E5"> I did an</font>

452
00:22:32,870 --> 00:22:39,050
investigation back in April with

453
00:22:36,020 --> 00:22:41,840
<font color="#CCCCCC">vBulletin site</font><font color="#E5E5E5"> where they were</font>

454
00:22:39,050 --> 00:22:42,919
leveraging certain<font color="#CCCCCC"> CVE vulnerabilities</font>

455
00:22:41,840 --> 00:22:44,990
because it was<font color="#E5E5E5"> running an outdated</font>

456
00:22:42,920 --> 00:22:49,250
version<font color="#E5E5E5"> that included cross-site</font>

457
00:22:44,990 --> 00:22:51,380
scripting and SQL injection so it could

458
00:22:49,250 --> 00:22:53,690
have<font color="#E5E5E5"> been living in the database it</font>

459
00:22:51,380 --> 00:22:56,360
could have been<font color="#E5E5E5"> getting loaded on page</font>

460
00:22:53,690 --> 00:23:00,860
load there's it wasn't actually<font color="#E5E5E5"> in the</font>

461
00:22:56,360 --> 00:23:02,719
server<font color="#E5E5E5"> files so another couple popular</font>

462
00:23:00,860 --> 00:23:06,379
ones that wouldn't<font color="#CCCCCC"> necessarily be</font>

463
00:23:02,720 --> 00:23:08,930
detected with on server<font color="#E5E5E5"> settings here ad</font>

464
00:23:06,380 --> 00:23:11,570
networks are<font color="#E5E5E5"> a pretty popular one to</font>

465
00:23:08,930 --> 00:23:15,280
drop this in<font color="#E5E5E5"> because then it can run on</font>

466
00:23:11,570 --> 00:23:17,960
any<font color="#CCCCCC"> website that</font><font color="#E5E5E5"> the ad network is on</font>

467
00:23:15,280 --> 00:23:20,780
and actually<font color="#CCCCCC"> YouTube's got hit for</font><font color="#E5E5E5"> that</font>

468
00:23:17,960 --> 00:23:24,590
<font color="#E5E5E5">earlier this year and then one of</font><font color="#CCCCCC"> my</font>

469
00:23:20,780 --> 00:23:27,500
<font color="#E5E5E5">other favorite oddities here was the LA</font>

470
00:23:24,590 --> 00:23:30,860
Times<font color="#CCCCCC"> website I believe it was they had</font>

471
00:23:27,500 --> 00:23:34,070
<font color="#CCCCCC">a</font><font color="#E5E5E5"> world writable s3 bucket so someone</font>

472
00:23:30,860 --> 00:23:36,770
took<font color="#CCCCCC"> that and dropped the their own</font><font color="#E5E5E5"> coin</font>

473
00:23:34,070 --> 00:23:39,860
hive script on there and so the LA Times

474
00:23:36,770 --> 00:23:43,690
<font color="#E5E5E5">website would load that and anyone going</font>

475
00:23:39,860 --> 00:23:43,689
in the LA<font color="#E5E5E5"> Times was mining for them</font>

476
00:23:47,080 --> 00:23:53,619
kind of like with the you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> other set</font>

477
00:23:52,090 --> 00:23:56,259
up with<font color="#E5E5E5"> some</font><font color="#CCCCCC"> miners being more popular</font>

478
00:23:53,619 --> 00:23:59,168
<font color="#E5E5E5">corn hive is the biggest one but it's</font>

479
00:23:56,259 --> 00:24:01,090
not<font color="#E5E5E5"> the only in browser mining</font><font color="#CCCCCC"> there are</font>

480
00:23:59,169 --> 00:24:04,600
others that are starting<font color="#CCCCCC"> to become</font><font color="#E5E5E5"> more</font>

481
00:24:01,090 --> 00:24:07,658
<font color="#CCCCCC">popular</font><font color="#E5E5E5"> because you</font><font color="#CCCCCC"> know there's ways</font>

482
00:24:04,600 --> 00:24:10,299
you<font color="#E5E5E5"> can block coin hive using things</font>

483
00:24:07,659 --> 00:24:15,429
<font color="#CCCCCC">like I was</font><font color="#E5E5E5"> at content security policy</font>

484
00:24:10,299 --> 00:24:16,840
<font color="#E5E5E5">and what's the other one there's ways</font>

485
00:24:15,429 --> 00:24:18,549
<font color="#CCCCCC">that you can you know prevent it from</font>

486
00:24:16,840 --> 00:24:21,519
<font color="#E5E5E5">even if they inject the code from</font>

487
00:24:18,549 --> 00:24:24,158
actually executing in<font color="#CCCCCC"> the browser so</font>

488
00:24:21,519 --> 00:24:25,570
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> some you know</font><font color="#CCCCCC"> other competitors</font>

489
00:24:24,159 --> 00:24:28,269
<font color="#CCCCCC">too</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> I've out</font><font color="#E5E5E5"> there that are</font>

490
00:24:25,570 --> 00:24:31,330
starting<font color="#CCCCCC"> to become</font><font color="#E5E5E5"> popular if you want</font>

491
00:24:28,269 --> 00:24:34,269
more data on this<font color="#E5E5E5"> stuff I'd recommend</font>

492
00:24:31,330 --> 00:24:36,580
checking<font color="#E5E5E5"> out that packets report</font><font color="#CCCCCC"> he does</font>

493
00:24:34,269 --> 00:24:41,529
<font color="#E5E5E5">really awesome work on especially coin</font>

494
00:24:36,580 --> 00:24:44,399
hive<font color="#E5E5E5"> attacks just last week he</font><font color="#CCCCCC"> found 400</font>

495
00:24:41,529 --> 00:24:46,840
sites that were all<font color="#E5E5E5"> affected</font><font color="#CCCCCC"> by</font><font color="#E5E5E5"> the same</font>

496
00:24:44,399 --> 00:24:48,998
you<font color="#E5E5E5"> know they're running the exact</font><font color="#CCCCCC"> same</font>

497
00:24:46,840 --> 00:24:53,019
script<font color="#E5E5E5"> reporting back to</font><font color="#CCCCCC"> the same wallet</font>

498
00:24:48,999 --> 00:24:55,179
key which he shut down<font color="#E5E5E5"> and</font><font color="#CCCCCC"> through some</font>

499
00:24:53,019 --> 00:24:56,590
communication with<font color="#E5E5E5"> him we found five of</font>

500
00:24:55,179 --> 00:24:58,359
<font color="#E5E5E5">those sites that were residing</font><font color="#CCCCCC"> on our</font>

501
00:24:56,590 --> 00:25:07,709
network and you know we rolled the

502
00:24:58,359 --> 00:25:11,139
appropriate response to<font color="#E5E5E5"> that as well so</font>

503
00:25:07,710 --> 00:25:13,629
<font color="#E5E5E5">we can</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> from from trends</font>

504
00:25:11,139 --> 00:25:16,988
from<font color="#E5E5E5"> news articles from</font><font color="#CCCCCC"> the fact that</font>

505
00:25:13,629 --> 00:25:20,649
I'm<font color="#E5E5E5"> speaking here</font><font color="#CCCCCC"> today that this</font><font color="#E5E5E5"> is out</font>

506
00:25:16,989 --> 00:25:22,749
there it<font color="#E5E5E5"> is becoming more prevalent</font><font color="#CCCCCC"> but</font>

507
00:25:20,649 --> 00:25:25,779
what does<font color="#CCCCCC"> it</font><font color="#E5E5E5"> actually mean for</font><font color="#CCCCCC"> us as a</font>

508
00:25:22,749 --> 00:25:27,279
security industry<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of times we like</font>

509
00:25:25,779 --> 00:25:28,480
to jump and there's been a lot of

510
00:25:27,279 --> 00:25:30,340
<font color="#E5E5E5">speakers who you know talked about</font>

511
00:25:28,480 --> 00:25:32,440
<font color="#E5E5E5">things like oh the Twitter thing or the</font>

512
00:25:30,340 --> 00:25:34,149
github thing with you know<font color="#E5E5E5"> plaintext</font>

513
00:25:32,440 --> 00:25:36,070
password logging and stuff like<font color="#E5E5E5"> that and</font>

514
00:25:34,149 --> 00:25:38,498
<font color="#E5E5E5">people really love the dumpster fire</font>

515
00:25:36,070 --> 00:25:42,330
stories we want<font color="#E5E5E5"> to you know jump on oh</font>

516
00:25:38,499 --> 00:25:45,100
<font color="#E5E5E5">my god this is the</font><font color="#CCCCCC"> worst thing ever I</font>

517
00:25:42,330 --> 00:25:47,350
don't<font color="#CCCCCC"> think this</font><font color="#E5E5E5"> is I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

518
00:25:45,100 --> 00:25:48,668
actually<font color="#E5E5E5"> a bit</font><font color="#CCCCCC"> of an</font><font color="#E5E5E5"> opportunity and</font>

519
00:25:47,350 --> 00:25:49,988
going<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that quote</font><font color="#CCCCCC"> from the</font>

520
00:25:48,669 --> 00:25:52,029
beginning from<font color="#E5E5E5"> risky</font><font color="#CCCCCC"> business</font>

521
00:25:49,989 --> 00:25:54,519
you know<font color="#CCCCCC"> cryptocurrency</font><font color="#E5E5E5"> being like an</font>

522
00:25:52,029 --> 00:25:56,210
<font color="#E5E5E5">internet wide bug bounty program</font><font color="#CCCCCC"> I mean</font>

523
00:25:54,519 --> 00:25:59,240
the idea of a bug<font color="#E5E5E5"> bounty program</font>

524
00:25:56,210 --> 00:26:02,180
is that you can take care of<font color="#CCCCCC"> a lot of</font>

525
00:25:59,240 --> 00:26:06,440
<font color="#CCCCCC">low-hanging fruit for a very small</font>

526
00:26:02,180 --> 00:26:09,500
investment<font color="#CCCCCC"> you know I've heard anecdotal</font>

527
00:26:06,440 --> 00:26:11,690
stories from other organizations<font color="#E5E5E5"> that</font>

528
00:26:09,500 --> 00:26:15,950
they've<font color="#E5E5E5"> seen a drop</font><font color="#CCCCCC"> you know a rather</font>

529
00:26:11,690 --> 00:26:21,530
dramatic drop and ransomware<font color="#CCCCCC"> as there's</font>

530
00:26:15,950 --> 00:26:25,130
been<font color="#E5E5E5"> a</font><font color="#CCCCCC"> pickup in coin mining which from</font>

531
00:26:21,530 --> 00:26:27,920
you know<font color="#CCCCCC"> a defender's perspective that's</font>

532
00:26:25,130 --> 00:26:29,480
<font color="#E5E5E5">awesome</font><font color="#CCCCCC"> I would much rather lose a few</font>

533
00:26:27,920 --> 00:26:31,670
compute cycles and<font color="#E5E5E5"> a little bit of</font>

534
00:26:29,480 --> 00:26:34,010
electricity<font color="#E5E5E5"> as opposed to potentially</font>

535
00:26:31,670 --> 00:26:36,470
<font color="#CCCCCC">having</font><font color="#E5E5E5"> like the city of Atlanta the</font>

536
00:26:34,010 --> 00:26:38,090
<font color="#CCCCCC">speak earlier</font><font color="#E5E5E5"> said five million dollars</font>

537
00:26:36,470 --> 00:26:41,030
worth of incident response they had to

538
00:26:38,090 --> 00:26:43,520
roll<font color="#E5E5E5"> if I can get away with just</font><font color="#CCCCCC"> a</font>

539
00:26:41,030 --> 00:26:47,090
<font color="#E5E5E5">little bit of electricity</font><font color="#CCCCCC"> I'm happy with</font>

540
00:26:43,520 --> 00:26:49,070
<font color="#E5E5E5">that</font><font color="#CCCCCC"> and in a lot of ways it can point</font>

541
00:26:47,090 --> 00:26:50,810
out ways<font color="#CCCCCC"> that you are vulnerable so</font><font color="#E5E5E5"> I</font>

542
00:26:49,070 --> 00:26:53,090
for<font color="#E5E5E5"> instance the LA Times with that</font>

543
00:26:50,810 --> 00:26:54,860
world writable s3 bucket you<font color="#E5E5E5"> better</font>

544
00:26:53,090 --> 00:26:57,110
believe they<font color="#E5E5E5"> did something</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font>

545
00:26:54,860 --> 00:26:59,719
you know after<font color="#E5E5E5"> they you know found out</font>

546
00:26:57,110 --> 00:27:03,050
<font color="#E5E5E5">that that was occurring</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that could</font>

547
00:26:59,720 --> 00:27:05,750
have<font color="#CCCCCC"> been a much</font><font color="#E5E5E5"> more you know dangerous</font>

548
00:27:03,050 --> 00:27:07,070
<font color="#CCCCCC">issue than just you know having</font><font color="#E5E5E5"> a few</font>

549
00:27:05,750 --> 00:27:09,410
<font color="#E5E5E5">people going on the site mines and</font>

550
00:27:07,070 --> 00:27:10,820
currency for them so I'm really<font color="#E5E5E5"> of the</font>

551
00:27:09,410 --> 00:27:14,090
perspective<font color="#CCCCCC"> that this is kind of an</font>

552
00:27:10,820 --> 00:27:16,820
<font color="#E5E5E5">opportunity for us</font><font color="#CCCCCC"> because there are a</font>

553
00:27:14,090 --> 00:27:19,010
<font color="#E5E5E5">lot of ways to detect this stuff and if</font>

554
00:27:16,820 --> 00:27:20,689
you can detect it<font color="#CCCCCC"> you can deal with</font><font color="#E5E5E5"> it</font>

555
00:27:19,010 --> 00:27:22,580
<font color="#E5E5E5">and close the ways that they you know</font>

556
00:27:20,690 --> 00:27:28,520
<font color="#E5E5E5">got in there to you know start</font><font color="#CCCCCC"> the</font>

557
00:27:22,580 --> 00:27:32,929
mining kind of covered a bit<font color="#E5E5E5"> of this</font>

558
00:27:28,520 --> 00:27:34,760
already<font color="#CCCCCC"> but kind of going off of some</font><font color="#E5E5E5"> of</font>

559
00:27:32,930 --> 00:27:37,460
the ways that<font color="#E5E5E5"> you can you know do some</font>

560
00:27:34,760 --> 00:27:39,590
detection here so as I mentioned<font color="#CCCCCC"> earlier</font>

561
00:27:37,460 --> 00:27:42,050
the the<font color="#E5E5E5"> miners are noisy on the network</font>

562
00:27:39,590 --> 00:27:44,840
<font color="#E5E5E5">they're constantly talking back to the</font>

563
00:27:42,050 --> 00:27:47,350
mining pools<font color="#E5E5E5"> so if you have</font><font color="#CCCCCC"> appropriate</font>

564
00:27:44,840 --> 00:27:50,000
you know<font color="#CCCCCC"> Network detection in place</font><font color="#E5E5E5"> it's</font>

565
00:27:47,350 --> 00:27:52,459
<font color="#E5E5E5">actually quite</font><font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know see</font>

566
00:27:50,000 --> 00:27:53,900
what's going on<font color="#E5E5E5"> here as far</font><font color="#CCCCCC"> as you know</font>

567
00:27:52,460 --> 00:27:56,080
the network detection things that I

568
00:27:53,900 --> 00:27:58,340
would recommend<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know one obviously</font>

569
00:27:56,080 --> 00:28:01,520
<font color="#E5E5E5">monitoring for those non-standard ports</font>

570
00:27:58,340 --> 00:28:03,280
<font color="#E5E5E5">so you</font><font color="#CCCCCC"> know if</font><font color="#E5E5E5"> quad</font><font color="#CCCCCC"> three doesn't exist</font>

571
00:28:01,520 --> 00:28:06,139
on<font color="#E5E5E5"> your network as a port that's in use</font>

572
00:28:03,280 --> 00:28:08,389
<font color="#E5E5E5">run up a flag if you see that you know</font>

573
00:28:06,140 --> 00:28:11,960
quad<font color="#E5E5E5"> seven quad six</font>

574
00:28:08,390 --> 00:28:15,680
<font color="#CCCCCC">um</font><font color="#E5E5E5"> there's a lot of individuals and</font>

575
00:28:11,960 --> 00:28:17,720
organizations<font color="#E5E5E5"> that are now creating you</font>

576
00:28:15,680 --> 00:28:21,260
<font color="#CCCCCC">know black lists or black lists for</font>

577
00:28:17,720 --> 00:28:25,220
these different crypto pools and<font color="#CCCCCC"> Korn</font>

578
00:28:21,260 --> 00:28:28,010
hive mining so you can create alerts

579
00:28:25,220 --> 00:28:30,170
based on those<font color="#CCCCCC"> depending</font><font color="#E5E5E5"> on what you're</font>

580
00:28:28,010 --> 00:28:31,940
<font color="#CCCCCC">trying to</font><font color="#E5E5E5"> block so</font><font color="#CCCCCC"> kinda I'm gonna split</font>

581
00:28:30,170 --> 00:28:36,890
out some of these detection<font color="#CCCCCC"> zhh</font><font color="#E5E5E5"> you know</font>

582
00:28:31,940 --> 00:28:37,550
<font color="#CCCCCC">coin have on one side and end pointer on</font>

583
00:28:36,890 --> 00:28:40,250
server

584
00:28:37,550 --> 00:28:41,750
you know<font color="#E5E5E5"> actually using the CPU</font><font color="#CCCCCC"> on the</font>

585
00:28:40,250 --> 00:28:43,280
server<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know with the local</font>

586
00:28:41,750 --> 00:28:45,290
executable<font color="#E5E5E5"> it's kind</font><font color="#CCCCCC"> of like the two</font>

587
00:28:43,280 --> 00:28:46,670
<font color="#CCCCCC">different things to</font><font color="#E5E5E5"> look for cuz there's</font>

588
00:28:45,290 --> 00:28:49,100
<font color="#E5E5E5">different ones that you</font><font color="#CCCCCC"> would look for</font>

589
00:28:46,670 --> 00:28:50,000
<font color="#E5E5E5">in one case versus the other</font><font color="#CCCCCC"> as I</font>

590
00:28:49,100 --> 00:28:51,770
already mentioned you<font color="#E5E5E5"> know</font>

591
00:28:50,000 --> 00:28:54,410
non-destructive and exposing<font color="#E5E5E5"> those</font>

592
00:28:51,770 --> 00:28:55,700
vulnerabilities<font color="#CCCCCC"> you they got in this is</font>

593
00:28:54,410 --> 00:28:57,860
your chance to figure<font color="#E5E5E5"> out how they got</font>

594
00:28:55,700 --> 00:29:07,070
<font color="#E5E5E5">in</font><font color="#CCCCCC"> before it becomes a terrible</font>

595
00:28:57,860 --> 00:29:09,379
situation<font color="#CCCCCC"> obviously as mentioned earlier</font>

596
00:29:07,070 --> 00:29:10,939
a lot<font color="#CCCCCC"> of these malware authors they're</font>

597
00:29:09,380 --> 00:29:12,350
not creating their own<font color="#E5E5E5"> coin miners</font>

598
00:29:10,940 --> 00:29:15,200
they're using the ones that are already

599
00:29:12,350 --> 00:29:17,510
<font color="#CCCCCC">out there for them</font><font color="#E5E5E5"> so if you can create</font>

600
00:29:15,200 --> 00:29:20,300
some<font color="#E5E5E5"> rules based around those programs</font>

601
00:29:17,510 --> 00:29:24,680
the configuration files and<font color="#E5E5E5"> stuff like</font>

602
00:29:20,300 --> 00:29:27,680
that<font color="#CCCCCC"> again pretty</font><font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to figure out for</font>

603
00:29:24,680 --> 00:29:31,430
<font color="#E5E5E5">the on server mining and I suppose it a</font>

604
00:29:27,680 --> 00:29:33,730
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> too depending on whether</font>

605
00:29:31,430 --> 00:29:36,770
you're the one that's affected or not

606
00:29:33,730 --> 00:29:40,850
<font color="#CCCCCC">increase load and drops in performance</font>

607
00:29:36,770 --> 00:29:43,190
<font color="#E5E5E5">so if you know your web server normally</font>

608
00:29:40,850 --> 00:29:45,110
doesn't<font color="#E5E5E5"> use all</font><font color="#CCCCCC"> of its cores which most</font>

609
00:29:43,190 --> 00:29:47,870
you know<font color="#CCCCCC"> web servers at least I deal</font>

610
00:29:45,110 --> 00:29:49,669
with<font color="#E5E5E5"> don't that's pretty easy way to</font>

611
00:29:47,870 --> 00:29:52,489
tell<font color="#CCCCCC"> that something weird is going</font><font color="#E5E5E5"> on</font>

612
00:29:49,670 --> 00:29:56,450
and you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> upon investigating you can</font>

613
00:29:52,490 --> 00:29:59,510
pretty quickly<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know use you know the</font>

614
00:29:56,450 --> 00:30:02,030
tools available and figure<font color="#CCCCCC"> out</font><font color="#E5E5E5"> if it is</font>

615
00:29:59,510 --> 00:30:05,600
<font color="#CCCCCC">a minor</font><font color="#E5E5E5"> and then you know proceed from</font>

616
00:30:02,030 --> 00:30:08,180
there<font color="#E5E5E5"> if your users are</font><font color="#CCCCCC"> reporting that</font>

617
00:30:05,600 --> 00:30:09,740
<font color="#E5E5E5">their workstations are slowing down</font><font color="#CCCCCC"> you</font>

618
00:30:08,180 --> 00:30:12,250
know asking them is that when you're<font color="#CCCCCC"> on</font>

619
00:30:09,740 --> 00:30:14,150
specific<font color="#E5E5E5"> sites you know for coin hive</font>

620
00:30:12,250 --> 00:30:15,710
<font color="#E5E5E5">that can be a little</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> difficult</font>

621
00:30:14,150 --> 00:30:18,470
because they might<font color="#E5E5E5"> be</font><font color="#CCCCCC"> going to a site</font>

622
00:30:15,710 --> 00:30:20,030
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you don't directly control but you</font>

623
00:30:18,470 --> 00:30:22,070
know if it does turn out<font color="#CCCCCC"> that it's your</font>

624
00:30:20,030 --> 00:30:23,899
<font color="#E5E5E5">local intranet site</font>

625
00:30:22,070 --> 00:30:25,700
and maybe you<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to you know run</font><font color="#E5E5E5"> a</font>

626
00:30:23,900 --> 00:30:27,770
<font color="#E5E5E5">little check to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that someone</font>

627
00:30:25,700 --> 00:30:33,170
didn't you know drop a coin hype<font color="#CCCCCC"> minor</font>

628
00:30:27,770 --> 00:30:37,160
on that<font color="#CCCCCC"> some of the tools they're out</font>

629
00:30:33,170 --> 00:30:37,790
there so as<font color="#E5E5E5"> I</font><font color="#CCCCCC"> been researching</font><font color="#E5E5E5"> this</font>

630
00:30:37,160 --> 00:30:41,480
myself

631
00:30:37,790 --> 00:30:44,540
<font color="#CCCCCC">I</font><font color="#E5E5E5"> built a tool that I put out</font><font color="#CCCCCC"> there and</font>

632
00:30:41,480 --> 00:30:46,400
we use within<font color="#E5E5E5"> our organization this is</font>

633
00:30:44,540 --> 00:30:49,940
you know we're<font color="#E5E5E5"> Linux shop mostly running</font>

634
00:30:46,400 --> 00:30:51,770
CentOS<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> six</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> seven servers so</font>

635
00:30:49,940 --> 00:30:53,420
you<font color="#E5E5E5"> know it is kind of built with that</font>

636
00:30:51,770 --> 00:30:58,129
<font color="#E5E5E5">in mind but it is you know a general</font>

637
00:30:53,420 --> 00:31:00,230
<font color="#E5E5E5">Linux based utility and I've been you</font>

638
00:30:58,130 --> 00:31:03,230
know expanding<font color="#CCCCCC"> its capability as</font><font color="#E5E5E5"> I</font>

639
00:31:00,230 --> 00:31:05,600
figured out more and<font color="#CCCCCC"> more around this</font><font color="#E5E5E5"> so</font>

640
00:31:03,230 --> 00:31:07,430
just to kind of depending<font color="#E5E5E5"> on how the</font>

641
00:31:05,600 --> 00:31:09,560
time<font color="#CCCCCC"> goes here I'm hoping at the end I</font>

642
00:31:07,430 --> 00:31:12,260
<font color="#E5E5E5">actually have a chance to run a couple</font>

643
00:31:09,560 --> 00:31:15,050
<font color="#E5E5E5">of miners and</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> show you</font><font color="#CCCCCC"> what to</font>

644
00:31:12,260 --> 00:31:16,850
<font color="#CCCCCC">look for if you're</font><font color="#E5E5E5"> on a Linux system but</font>

645
00:31:15,050 --> 00:31:18,950
<font color="#E5E5E5">someone you know the quick hits here is</font>

646
00:31:16,850 --> 00:31:21,379
it's got a couple different<font color="#E5E5E5"> scans you</font>

647
00:31:18,950 --> 00:31:24,380
can run<font color="#E5E5E5"> based on where the miner might</font>

648
00:31:21,380 --> 00:31:27,860
be<font color="#E5E5E5"> located whether it's making an active</font>

649
00:31:24,380 --> 00:31:30,860
<font color="#CCCCCC">connection out to a mining pool as well</font>

650
00:31:27,860 --> 00:31:34,040
<font color="#CCCCCC">I've compiled a list of mining pools</font>

651
00:31:30,860 --> 00:31:37,850
that<font color="#CCCCCC"> I've witnessed</font><font color="#E5E5E5"> in malware campaigns</font>

652
00:31:34,040 --> 00:31:39,290
<font color="#CCCCCC">so in</font><font color="#E5E5E5"> this program it can do a local</font>

653
00:31:37,850 --> 00:31:41,419
blocking on the<font color="#E5E5E5"> server but</font><font color="#CCCCCC"> you can also</font>

654
00:31:39,290 --> 00:31:43,040
<font color="#E5E5E5">use that</font><font color="#CCCCCC"> particular block list</font><font color="#E5E5E5"> at a</font>

655
00:31:41,420 --> 00:31:47,300
network level<font color="#CCCCCC"> if that fits your</font>

656
00:31:43,040 --> 00:31:49,940
organization's needs<font color="#E5E5E5"> and then in this</font>

657
00:31:47,300 --> 00:31:53,330
case<font color="#CCCCCC"> I've also</font><font color="#E5E5E5"> built in the ability to</font>

658
00:31:49,940 --> 00:31:56,000
send reports<font color="#E5E5E5"> based on what's found so if</font>

659
00:31:53,330 --> 00:31:59,300
something<font color="#CCCCCC"> gets found it can send a</font><font color="#E5E5E5"> email</font>

660
00:31:56,000 --> 00:32:01,370
alert to a specific<font color="#CCCCCC"> email that you set</font>

661
00:31:59,300 --> 00:32:03,440
up<font color="#CCCCCC"> I've built in you know the one that</font><font color="#E5E5E5"> I</font>

662
00:32:01,370 --> 00:32:05,800
use but you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> change that file and</font>

663
00:32:03,440 --> 00:32:08,330
send it wherever you like<font color="#CCCCCC"> if you want</font><font color="#E5E5E5"> to</font>

664
00:32:05,800 --> 00:32:10,040
it does have<font color="#CCCCCC"> some checks for crypto</font>

665
00:32:08,330 --> 00:32:11,629
jacking but again it's a<font color="#E5E5E5"> little less</font>

666
00:32:10,040 --> 00:32:14,389
effective at<font color="#CCCCCC"> that because if it's not</font>

667
00:32:11,630 --> 00:32:16,610
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> on the server it's not going to</font>

668
00:32:14,390 --> 00:32:19,040
find it<font color="#E5E5E5"> but it could</font><font color="#CCCCCC"> still</font><font color="#E5E5E5"> be there if</font>

669
00:32:16,610 --> 00:32:21,110
<font color="#E5E5E5">you load the site in a browser</font><font color="#CCCCCC"> so you</font>

670
00:32:19,040 --> 00:32:24,340
<font color="#CCCCCC">got to</font><font color="#E5E5E5"> take that one</font><font color="#CCCCCC"> with a</font><font color="#E5E5E5"> little bit</font>

671
00:32:21,110 --> 00:32:24,340
<font color="#CCCCCC">of a grain of salt there</font>

672
00:32:25,850 --> 00:32:33,270
<font color="#E5E5E5">going back</font><font color="#CCCCCC"> to the network</font><font color="#E5E5E5"> level blocking</font>

673
00:32:29,960 --> 00:32:35,790
<font color="#CCCCCC">zero dot over on github has put together</font>

674
00:32:33,270 --> 00:32:39,720
a pretty comprehensive list<font color="#E5E5E5"> of websites</font>

675
00:32:35,790 --> 00:32:41,428
<font color="#E5E5E5">that are using coin I've in</font><font color="#CCCCCC"> the wild so</font>

676
00:32:39,720 --> 00:32:45,450
if you want to prevent<font color="#E5E5E5"> your workstations</font>

677
00:32:41,429 --> 00:32:48,419
<font color="#E5E5E5">from running you know mining in the</font>

678
00:32:45,450 --> 00:32:50,660
browser<font color="#CCCCCC"> drop in his blacklist at a</font>

679
00:32:48,419 --> 00:32:52,980
network level can be<font color="#E5E5E5"> pretty effective</font>

680
00:32:50,660 --> 00:32:56,790
<font color="#CCCCCC">I'd mostly recommend if you're</font><font color="#E5E5E5"> going to</font>

681
00:32:52,980 --> 00:33:00,510
do a more comprehensive<font color="#E5E5E5"> block list like</font>

682
00:32:56,790 --> 00:33:03,620
his that you really make sure<font color="#CCCCCC"> that the</font>

683
00:33:00,510 --> 00:33:06,390
network<font color="#CCCCCC"> segment you're putting it on is</font>

684
00:33:03,620 --> 00:33:08,909
appropriate so one of the things we've

685
00:33:06,390 --> 00:33:12,690
run into<font color="#E5E5E5"> and rather I've run into</font><font color="#CCCCCC"> is you</font>

686
00:33:08,910 --> 00:33:15,360
know developing my tool is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> some of</font>

687
00:33:12,690 --> 00:33:19,110
these miners have their stuff sitting

688
00:33:15,360 --> 00:33:22,320
behind<font color="#E5E5E5"> CloudFlare we run</font><font color="#CCCCCC"> websites we</font>

689
00:33:19,110 --> 00:33:24,510
need access to<font color="#E5E5E5"> CloudFlare and similar</font>

690
00:33:22,320 --> 00:33:27,678
your<font color="#E5E5E5"> end users may you know actually</font>

691
00:33:24,510 --> 00:33:31,140
need to get to certain<font color="#E5E5E5"> you know</font>

692
00:33:27,679 --> 00:33:33,690
<font color="#E5E5E5">CloudFlare sites as well so if you pull</font>

693
00:33:31,140 --> 00:33:35,309
<font color="#CCCCCC">one of the block everything</font><font color="#E5E5E5"> lists you</font>

694
00:33:33,690 --> 00:33:37,980
might<font color="#E5E5E5"> block access</font><font color="#CCCCCC"> to some legitimate</font>

695
00:33:35,309 --> 00:33:41,580
resources<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of you'll need to</font>

696
00:33:37,980 --> 00:33:43,650
do some tuning<font color="#CCCCCC"> in</font><font color="#E5E5E5"> my case I haven't</font>

697
00:33:41,580 --> 00:33:46,230
instituted the more you know

698
00:33:43,650 --> 00:33:49,200
comprehensive blacklist due to that I'm

699
00:33:46,230 --> 00:33:52,020
mostly responding to the things that<font color="#CCCCCC"> I</font>

700
00:33:49,200 --> 00:34:00,510
see<font color="#E5E5E5"> in actual you know in the wild</font>

701
00:33:52,020 --> 00:34:04,620
attacks<font color="#CCCCCC"> tool three as I was doing this I</font>

702
00:34:00,510 --> 00:34:08,489
came across<font color="#E5E5E5"> NCC groups awesome</font><font color="#CCCCCC"> snort</font>

703
00:34:04,620 --> 00:34:13,290
<font color="#E5E5E5">rules generator so this can be</font><font color="#CCCCCC"> used a</font>

704
00:34:08,489 --> 00:34:15,928
lot wider than<font color="#CCCCCC"> just in the instance of</font>

705
00:34:13,290 --> 00:34:18,350
crypto mining<font color="#E5E5E5"> because</font><font color="#CCCCCC"> essentially you</font>

706
00:34:15,929 --> 00:34:21,330
can<font color="#E5E5E5"> feed it any IP addresses or any</font>

707
00:34:18,350 --> 00:34:23,580
domains<font color="#E5E5E5"> and it will generate</font><font color="#CCCCCC"> snort rules</font>

708
00:34:21,330 --> 00:34:25,889
for you based on those so just<font color="#CCCCCC"> in</font>

709
00:34:23,580 --> 00:34:28,168
general<font color="#CCCCCC"> if you're doing any kind of</font>

710
00:34:25,889 --> 00:34:30,419
analysis<font color="#E5E5E5"> of you know the</font><font color="#CCCCCC"> campaigns</font><font color="#E5E5E5"> that</font>

711
00:34:28,168 --> 00:34:32,399
are<font color="#E5E5E5"> actively hitting your network you</font>

712
00:34:30,418 --> 00:34:34,918
can pretty quickly turn that into you

713
00:34:32,399 --> 00:34:36,029
know actionable<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> blacklisting</font>

714
00:34:34,918 --> 00:34:37,819
alerting

715
00:34:36,030 --> 00:34:41,730
based on these<font color="#E5E5E5"> Norton rules</font>

716
00:34:37,820 --> 00:34:47,280
if you are using<font color="#E5E5E5"> that kind of</font><font color="#CCCCCC"> ids system</font>

717
00:34:41,730 --> 00:34:49,170
<font color="#E5E5E5">definitely check this out that's kind of</font>

718
00:34:47,280 --> 00:34:50,460
the end of the talk but it looks like<font color="#CCCCCC"> I</font>

719
00:34:49,170 --> 00:34:52,440
do<font color="#E5E5E5"> have a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of time</font><font color="#CCCCCC"> so I can</font>

720
00:34:50,460 --> 00:34:55,949
<font color="#E5E5E5">run a couple of minors for you and show</font>

721
00:34:52,440 --> 00:34:59,300
you how<font color="#CCCCCC"> that looks</font><font color="#E5E5E5"> on a live system</font>

722
00:34:55,949 --> 00:35:01,319
I do do write-ups on a lot<font color="#E5E5E5"> of the</font>

723
00:34:59,300 --> 00:35:03,180
investigations I do so if you're

724
00:35:01,320 --> 00:35:05,430
<font color="#E5E5E5">interesting that kind of a thing</font><font color="#CCCCCC"> you can</font>

725
00:35:03,180 --> 00:35:08,790
<font color="#E5E5E5">find me either</font><font color="#CCCCCC"> on my</font><font color="#E5E5E5"> personal blog there</font>

726
00:35:05,430 --> 00:35:13,649
let's go<font color="#E5E5E5"> see - tech</font><font color="#CCCCCC"> comm or hit me up on</font>

727
00:35:08,790 --> 00:35:15,630
<font color="#E5E5E5">Twitter at Lascaux 26 and with that</font>

728
00:35:13,650 --> 00:35:21,840
<font color="#E5E5E5">adjourn</font><font color="#CCCCCC"> - there let's run a couple</font><font color="#E5E5E5"> of</font>

729
00:35:15,630 --> 00:35:26,160
<font color="#CCCCCC">miners all right let's see here</font>

730
00:35:21,840 --> 00:35:29,880
so here<font color="#E5E5E5"> I've got a local VM running it's</font>

731
00:35:26,160 --> 00:35:32,190
just<font color="#CCCCCC"> a standard and moved</font><font color="#E5E5E5"> to 1604 system</font>

732
00:35:29,880 --> 00:35:34,470
here it's got a couple<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different</font>

733
00:35:32,190 --> 00:35:36,780
<font color="#CCCCCC">miners that I pulled</font><font color="#E5E5E5"> from investigations</font>

734
00:35:34,470 --> 00:35:38,339
we've had in the wild here and I'll just

735
00:35:36,780 --> 00:35:42,510
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of take the time to roll through a</font>

736
00:35:38,340 --> 00:35:50,030
couple<font color="#E5E5E5"> of them here it's a case of</font><font color="#CCCCCC"> my</font>

737
00:35:42,510 --> 00:35:54,420
hair<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so this particular miner</font>

738
00:35:50,030 --> 00:35:56,700
really likes to be<font color="#E5E5E5"> dropped into the temp</font>

739
00:35:54,420 --> 00:35:59,040
directory and masquerade as a<font color="#E5E5E5"> PHP</font>

740
00:35:56,700 --> 00:36:02,040
session file so that's mostly where<font color="#E5E5E5"> I</font>

741
00:35:59,040 --> 00:36:05,130
found<font color="#E5E5E5"> this particular</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> it's using</font>

742
00:36:02,040 --> 00:36:06,630
the yam<font color="#E5E5E5"> miner program so while the</font>

743
00:36:05,130 --> 00:36:08,910
programs are very<font color="#E5E5E5"> similar they will</font>

744
00:36:06,630 --> 00:36:11,850
often<font color="#E5E5E5"> you know attempt to obfuscate</font>

745
00:36:08,910 --> 00:36:15,120
<font color="#E5E5E5">what it's actually doing so you know</font>

746
00:36:11,850 --> 00:36:20,279
this<font color="#E5E5E5"> is an example of that and in this</font>

747
00:36:15,120 --> 00:36:22,380
<font color="#E5E5E5">case it will</font><font color="#CCCCCC"> actually be run by a</font>

748
00:36:20,280 --> 00:36:25,200
<font color="#CCCCCC">command-line</font><font color="#E5E5E5"> argument I like the</font>

749
00:36:22,380 --> 00:36:26,940
<font color="#CCCCCC">following and if you were to run it you</font>

750
00:36:25,200 --> 00:36:28,529
would see it you know doing<font color="#E5E5E5"> all of this</font>

751
00:36:26,940 --> 00:36:30,330
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you're gonna see it you know</font>

752
00:36:28,530 --> 00:36:35,370
start trying<font color="#E5E5E5"> to talk to the you know</font>

753
00:36:30,330 --> 00:36:38,340
crypto pool<font color="#CCCCCC"> doubtfire domain taking a</font>

754
00:36:35,370 --> 00:36:40,500
look at what<font color="#E5E5E5"> that</font><font color="#CCCCCC"> looks like we can see</font>

755
00:36:38,340 --> 00:36:42,000
<font color="#E5E5E5">pretty quickly that there's definitely</font>

756
00:36:40,500 --> 00:36:44,960
one thing that's<font color="#E5E5E5"> doing something out on</font>

757
00:36:42,000 --> 00:36:46,950
<font color="#CCCCCC">the</font><font color="#E5E5E5"> system here using</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> of a CPU core</font>

758
00:36:44,960 --> 00:36:49,610
<font color="#CCCCCC">whereas everything else really isn't</font>

759
00:36:46,950 --> 00:36:49,609
<font color="#CCCCCC">doing much</font><font color="#E5E5E5"> of anything</font>

760
00:36:52,609 --> 00:36:58,410
<font color="#CCCCCC">I've given a quick run of the</font><font color="#E5E5E5"> minor</font>

761
00:36:55,200 --> 00:37:00,029
check tool here<font color="#E5E5E5"> it will do a couple</font>

762
00:36:58,410 --> 00:37:02,609
<font color="#E5E5E5">checks to make</font><font color="#CCCCCC"> sure it's signatures are</font>

763
00:37:00,030 --> 00:37:06,240
<font color="#CCCCCC">up-to-date and that it's up to</font><font color="#E5E5E5"> date</font><font color="#CCCCCC"> okay</font>

764
00:37:02,609 --> 00:37:09,359
<font color="#E5E5E5">let's run a</font><font color="#CCCCCC"> quick check</font><font color="#E5E5E5"> to see if we</font>

765
00:37:06,240 --> 00:37:11,399
<font color="#CCCCCC">have anything</font><font color="#E5E5E5"> running</font><font color="#CCCCCC"> again as I</font><font color="#E5E5E5"> was</font>

766
00:37:09,359 --> 00:37:12,808
describing<font color="#E5E5E5"> earlier there's different</font>

767
00:37:11,400 --> 00:37:15,270
<font color="#CCCCCC">places where</font><font color="#E5E5E5"> these tend to</font><font color="#CCCCCC"> live this</font>

768
00:37:12,809 --> 00:37:18,260
tool is optimized for<font color="#E5E5E5"> a web server</font>

769
00:37:15,270 --> 00:37:20,730
environment so it's going to<font color="#CCCCCC"> be checking</font>

770
00:37:18,260 --> 00:37:22,470
<font color="#CCCCCC">for</font><font color="#E5E5E5"> the quick run it's checking for any</font>

771
00:37:20,730 --> 00:37:25,589
active connections to mining pools and

772
00:37:22,470 --> 00:37:27,569
it's<font color="#E5E5E5"> checking the temp directory the</font>

773
00:37:25,589 --> 00:37:29,970
other checks are<font color="#E5E5E5"> going to jump</font><font color="#CCCCCC"> into</font>

774
00:37:27,569 --> 00:37:32,069
<font color="#E5E5E5">where the</font><font color="#CCCCCC"> website files have live but</font>

775
00:37:29,970 --> 00:37:34,680
again you can<font color="#E5E5E5"> kind of adjust based on</font>

776
00:37:32,069 --> 00:37:37,230
<font color="#E5E5E5">you know your</font><font color="#CCCCCC"> environment and should</font><font color="#E5E5E5"> you</font>

777
00:37:34,680 --> 00:37:39,480
want to<font color="#E5E5E5"> so in this case we can see we</font>

778
00:37:37,230 --> 00:37:45,660
<font color="#E5E5E5">have a</font><font color="#CCCCCC"> connection going</font><font color="#E5E5E5"> out here to one</font>

779
00:37:39,480 --> 00:37:47,880
<font color="#E5E5E5">of the mining pools</font><font color="#CCCCCC"> run a check through</font>

780
00:37:45,660 --> 00:37:49,589
<font color="#CCCCCC">the site files here and</font><font color="#E5E5E5"> you're gonna see</font>

781
00:37:47,880 --> 00:37:51,109
a<font color="#CCCCCC"> whole bunch</font><font color="#E5E5E5"> of stuff getting reported</font>

782
00:37:49,589 --> 00:37:55,290
here because it's<font color="#E5E5E5"> looking through</font>

783
00:37:51,109 --> 00:37:56,430
<font color="#E5E5E5">everything in the /var WW area</font><font color="#CCCCCC"> we'll</font>

784
00:37:55,290 --> 00:37:58,020
play around with a couple<font color="#CCCCCC"> more of these</font>

785
00:37:56,430 --> 00:38:00,629
here<font color="#E5E5E5"> in a minute</font>

786
00:37:58,020 --> 00:38:02,849
one of the interesting<font color="#CCCCCC"> things that I</font>

787
00:38:00,630 --> 00:38:04,200
found<font color="#E5E5E5"> out doing this that if you don't</font>

788
00:38:02,849 --> 00:38:07,500
know about you should definitely<font color="#E5E5E5"> take</font>

789
00:38:04,200 --> 00:38:10,109
advantage<font color="#E5E5E5"> of you</font><font color="#CCCCCC"> know we use a lot of</font>

790
00:38:07,500 --> 00:38:12,809
open source<font color="#E5E5E5"> tools</font><font color="#CCCCCC"> in the web hosting</font>

791
00:38:10,109 --> 00:38:14,250
<font color="#CCCCCC">environment here</font><font color="#E5E5E5"> and one of the things</font>

792
00:38:12,809 --> 00:38:17,549
that's pretty much installed on all of

793
00:38:14,250 --> 00:38:19,890
our<font color="#CCCCCC"> servers already is</font><font color="#E5E5E5"> clam</font><font color="#CCCCCC"> AV</font><font color="#E5E5E5"> clam</font><font color="#CCCCCC"> AV</font>

794
00:38:17,549 --> 00:38:21,720
you<font color="#E5E5E5"> know you can kind of be</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> yay or</font>

795
00:38:19,890 --> 00:38:24,270
<font color="#E5E5E5">nay on it but one of the things that's</font>

796
00:38:21,720 --> 00:38:26,910
<font color="#E5E5E5">really awesome</font><font color="#CCCCCC"> is they now it can</font>

797
00:38:24,270 --> 00:38:29,009
process<font color="#E5E5E5"> Yarra signatures</font><font color="#CCCCCC"> so you can</font>

798
00:38:26,910 --> 00:38:31,348
write<font color="#E5E5E5"> your</font><font color="#CCCCCC"> own yard signatures and tell</font>

799
00:38:29,010 --> 00:38:34,619
clam maybe to run a scan using<font color="#E5E5E5"> your</font>

800
00:38:31,349 --> 00:38:37,109
signatures so if you create ones based

801
00:38:34,619 --> 00:38:39,270
on you know<font color="#E5E5E5"> investigations you've seen</font>

802
00:38:37,109 --> 00:38:40,770
but<font color="#E5E5E5"> aren't detected by other AV you can</font>

803
00:38:39,270 --> 00:38:43,710
write<font color="#E5E5E5"> your</font><font color="#CCCCCC"> own custom</font><font color="#E5E5E5"> rules</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> them</font>

804
00:38:40,770 --> 00:38:45,359
so<font color="#E5E5E5"> that's what it's doing</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> it's</font>

805
00:38:43,710 --> 00:38:47,549
<font color="#E5E5E5">actually using clam maybe if</font><font color="#CCCCCC"> it's</font>

806
00:38:45,359 --> 00:38:51,470
<font color="#E5E5E5">installed and running the custom yard</font>

807
00:38:47,549 --> 00:38:51,470
<font color="#CCCCCC">rules I've you know been working</font><font color="#E5E5E5"> on</font>

808
00:38:52,110 --> 00:38:59,280
<font color="#CCCCCC">alright let's</font><font color="#E5E5E5"> drop out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> there second</font>

809
00:38:55,680 --> 00:38:59,279
<font color="#CCCCCC">do it quick</font>

810
00:39:00,330 --> 00:39:12,279
here<font color="#E5E5E5"> we're gonna kill that process real</font>

811
00:39:04,360 --> 00:39:14,160
quick here<font color="#CCCCCC"> and make</font><font color="#E5E5E5"> sure that we are</font>

812
00:39:12,280 --> 00:39:17,110
good

813
00:39:14,160 --> 00:39:19,600
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> nothing taking up a ton of CPU</font>

814
00:39:17,110 --> 00:39:23,130
now and we can<font color="#E5E5E5"> see we're ended here</font>

815
00:39:19,600 --> 00:39:23,130
let's take a look at a<font color="#CCCCCC"> different one</font>

816
00:39:25,020 --> 00:39:47,710
let's see let's go<font color="#E5E5E5"> into I think it's</font>

817
00:39:28,510 --> 00:39:49,660
case<font color="#CCCCCC"> three here - yeah</font><font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> gonna</font>

818
00:39:47,710 --> 00:39:51,970
<font color="#E5E5E5">use this one here so this is one that</font>

819
00:39:49,660 --> 00:39:55,720
<font color="#E5E5E5">was dropped into an actual website</font>

820
00:39:51,970 --> 00:40:00,339
itself as opposed to temp<font color="#E5E5E5"> and this one</font>

821
00:39:55,720 --> 00:40:04,060
<font color="#E5E5E5">used a actual dropped all of</font><font color="#CCCCCC"> the</font>

822
00:40:00,340 --> 00:40:06,970
information<font color="#E5E5E5"> in the command line like so</font>

823
00:40:04,060 --> 00:40:08,950
so in this case they're actually<font color="#E5E5E5"> running</font>

824
00:40:06,970 --> 00:40:11,230
the configuration via the command<font color="#E5E5E5"> line</font>

825
00:40:08,950 --> 00:40:12,850
argument<font color="#E5E5E5"> as opposed to having something</font>

826
00:40:11,230 --> 00:40:16,120
<font color="#E5E5E5">living in a file so in the previous one</font>

827
00:40:12,850 --> 00:40:18,640
that<font color="#E5E5E5"> -</font><font color="#CCCCCC"> C flag told the miner to look for</font>

828
00:40:16,120 --> 00:40:20,230
the config within this file<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you also</font>

829
00:40:18,640 --> 00:40:22,890
see a<font color="#E5E5E5"> lot of times</font><font color="#CCCCCC"> they'll</font><font color="#E5E5E5"> literally</font>

830
00:40:20,230 --> 00:40:27,190
just drop it in the command<font color="#E5E5E5"> line itself</font>

831
00:40:22,890 --> 00:40:29,560
<font color="#CCCCCC">so if we were running back</font><font color="#E5E5E5"> over here we</font>

832
00:40:27,190 --> 00:40:33,160
<font color="#E5E5E5">can actually see that in the output of</font>

833
00:40:29,560 --> 00:40:36,430
<font color="#CCCCCC">your</font><font color="#E5E5E5"> running processes so all of the</font>

834
00:40:33,160 --> 00:40:39,009
miners<font color="#E5E5E5"> tend to have somewhere</font><font color="#CCCCCC"> in their</font>

835
00:40:36,430 --> 00:40:41,020
configuration that stratum<font color="#E5E5E5"> + TCP string</font>

836
00:40:39,010 --> 00:40:45,910
<font color="#E5E5E5">so that's one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the easy strings to</font>

837
00:40:41,020 --> 00:40:47,830
alert on because they're all using<font color="#CCCCCC"> that</font>

838
00:40:45,910 --> 00:40:49,359
particular protocol<font color="#CCCCCC"> to communicate and</font>

839
00:40:47,830 --> 00:40:55,410
it's a pretty<font color="#E5E5E5"> good indicator</font><font color="#CCCCCC"> that you</font>

840
00:40:49,360 --> 00:40:59,410
got something<font color="#CCCCCC"> going out in there</font><font color="#E5E5E5"> to do</font>

841
00:40:55,410 --> 00:41:01,089
just<font color="#CCCCCC"> in interest of what's going on here</font>

842
00:40:59,410 --> 00:41:03,000
this<font color="#E5E5E5"> is one of the ones</font><font color="#CCCCCC"> that's using the</font>

843
00:41:01,090 --> 00:41:05,940
<font color="#CCCCCC">sumo coin so</font>

844
00:41:03,000 --> 00:41:16,050
just kind of thing there<font color="#CCCCCC"> all right and</font>

845
00:41:05,940 --> 00:41:18,750
<font color="#CCCCCC">let's do one last one so this</font><font color="#E5E5E5"> one here</font>

846
00:41:16,050 --> 00:41:21,300
is one that they have<font color="#E5E5E5"> actually been</font>

847
00:41:18,750 --> 00:41:24,900
<font color="#E5E5E5">dropping in the home directories of</font>

848
00:41:21,300 --> 00:41:28,110
different users and<font color="#CCCCCC"> a multi-user set up</font>

849
00:41:24,900 --> 00:41:31,290
and it masquerades as<font color="#E5E5E5"> the batch RC file</font>

850
00:41:28,110 --> 00:41:33,990
<font color="#E5E5E5">and it has a couple of</font><font color="#CCCCCC"> built-in</font><font color="#E5E5E5"> things</font>

851
00:41:31,290 --> 00:41:35,250
where it will try and<font color="#E5E5E5"> hide itself so in</font>

852
00:41:33,990 --> 00:41:37,279
this case we can see that<font color="#CCCCCC"> we have a</font>

853
00:41:35,250 --> 00:41:40,140
process<font color="#CCCCCC"> running at a hundred percent CPU</font>

854
00:41:37,280 --> 00:41:42,840
but it looks<font color="#CCCCCC"> it</font><font color="#E5E5E5"> like a PHP process here</font>

855
00:41:40,140 --> 00:41:46,440
<font color="#CCCCCC">so that's a</font><font color="#E5E5E5"> little bit you know</font>

856
00:41:42,840 --> 00:41:47,070
different let's change our flag here to

857
00:41:46,440 --> 00:41:49,980
<font color="#CCCCCC">CDE</font>

858
00:41:47,070 --> 00:41:53,670
you know<font color="#CCCCCC"> at the actual</font><font color="#E5E5E5"> command just</font>

859
00:41:49,980 --> 00:41:55,200
regular top<font color="#CCCCCC"> and here we</font><font color="#E5E5E5"> can see it name</font>

860
00:41:53,670 --> 00:41:57,480
differently so depending<font color="#E5E5E5"> on how it's</font>

861
00:41:55,200 --> 00:42:00,509
being referenced<font color="#E5E5E5"> you might see two</font>

862
00:41:57,480 --> 00:42:03,780
<font color="#CCCCCC">different things</font><font color="#E5E5E5"> and then this one will</font>

863
00:42:00,510 --> 00:42:07,050
as<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> running constantly update the</font>

864
00:42:03,780 --> 00:42:09,960
crontab file and add a cron to restart

865
00:42:07,050 --> 00:42:12,870
itself if you kill<font color="#E5E5E5"> it so with this one</font>

866
00:42:09,960 --> 00:42:14,430
in particular<font color="#E5E5E5"> it can be a little</font>

867
00:42:12,870 --> 00:42:16,500
trickier to<font color="#E5E5E5"> kill because if you don't</font>

868
00:42:14,430 --> 00:42:20,460
realize<font color="#E5E5E5"> it's doing that it will just</font>

869
00:42:16,500 --> 00:42:23,340
keep coming<font color="#CCCCCC"> back</font><font color="#E5E5E5"> so that's just</font><font color="#CCCCCC"> kind of</font>

870
00:42:20,460 --> 00:42:26,430
a<font color="#E5E5E5"> little bit</font><font color="#CCCCCC"> of what's going</font><font color="#E5E5E5"> on in that</font>

871
00:42:23,340 --> 00:42:29,630
<font color="#E5E5E5">world thank you guys for listening if</font>

872
00:42:26,430 --> 00:42:32,759
you have questions feel free to come up

873
00:42:29,630 --> 00:42:35,010
<font color="#E5E5E5">afterwards here or hit me up on Twitter</font>

874
00:42:32,760 --> 00:42:38,810
<font color="#E5E5E5">I'm very open to giving out more</font>

875
00:42:35,010 --> 00:42:38,810
information<font color="#E5E5E5"> so thank you</font>

876
00:42:39,760 --> 00:42:43,979
[Applause]

877
00:42:44,740 --> 00:42:47,839
[Music]

