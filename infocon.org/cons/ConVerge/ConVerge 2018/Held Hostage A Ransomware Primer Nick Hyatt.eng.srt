1
00:00:10,759 --> 00:00:18,810
so welcome<font color="#CCCCCC"> to held hostage this is a</font>

2
00:00:14,490 --> 00:00:20,310
ransomware primer<font color="#CCCCCC"> we're going to talk</font>

3
00:00:18,810 --> 00:00:22,859
<font color="#E5E5E5">about a couple</font><font color="#CCCCCC"> of things</font><font color="#E5E5E5"> today</font><font color="#CCCCCC"> we're</font>

4
00:00:20,310 --> 00:00:26,970
gonna do an<font color="#E5E5E5"> overview of what ransomware</font>

5
00:00:22,859 --> 00:00:29,970
is a background on ransomware<font color="#CCCCCC"> and then</font>

6
00:00:26,970 --> 00:00:32,399
<font color="#CCCCCC">where we're seeing ransomware and then</font>

7
00:00:29,970 --> 00:00:33,780
we're gonna do some case studies<font color="#CCCCCC"> these</font>

8
00:00:32,399 --> 00:00:35,910
are real-world engagements<font color="#E5E5E5"> that I've</font>

9
00:00:33,780 --> 00:00:37,530
worked<font color="#E5E5E5"> and we're going</font><font color="#CCCCCC"> to talk about</font>

10
00:00:35,910 --> 00:00:40,349
some common<font color="#CCCCCC"> threads within</font><font color="#E5E5E5"> those and</font>

11
00:00:37,530 --> 00:00:42,360
some not<font color="#CCCCCC"> so common threads I am going</font><font color="#E5E5E5"> to</font>

12
00:00:40,350 --> 00:00:45,030
attempt to do a live<font color="#CCCCCC"> demo</font><font color="#E5E5E5"> of a bit</font>

13
00:00:42,360 --> 00:00:47,039
Paymer infection<font color="#CCCCCC"> so we're gonna play</font>

14
00:00:45,030 --> 00:00:49,770
<font color="#E5E5E5">with</font><font color="#CCCCCC"> some live malware</font><font color="#E5E5E5"> and then I'm</font>

15
00:00:47,039 --> 00:00:51,390
going<font color="#E5E5E5"> to give you guys some tips for</font>

16
00:00:49,770 --> 00:00:54,660
protecting<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can</font>

17
00:00:51,390 --> 00:00:57,870
<font color="#E5E5E5">take away and help secure both your</font>

18
00:00:54,660 --> 00:01:00,779
<font color="#E5E5E5">families and your company's networks so</font>

19
00:00:57,870 --> 00:01:03,660
let's talk about ransomware<font color="#E5E5E5"> and one of</font>

20
00:01:00,780 --> 00:01:06,030
the<font color="#E5E5E5"> questions that we often get is why</font>

21
00:01:03,660 --> 00:01:08,039
is ransomware so popular and the answer

22
00:01:06,030 --> 00:01:10,770
to that<font color="#E5E5E5"> is that it's a good attack it's</font>

23
00:01:08,040 --> 00:01:13,470
cheap and it's effective the level of

24
00:01:10,770 --> 00:01:16,170
investment<font color="#CCCCCC"> required</font><font color="#E5E5E5"> by an attacker</font><font color="#CCCCCC"> to</font>

25
00:01:13,470 --> 00:01:18,600
deploy a ransomware attack is<font color="#CCCCCC"> very</font><font color="#E5E5E5"> small</font>

26
00:01:16,170 --> 00:01:21,540
compared to the return that<font color="#CCCCCC"> they get</font><font color="#E5E5E5"> on</font>

27
00:01:18,600 --> 00:01:23,850
that so what is ransomware<font color="#CCCCCC"> besides</font><font color="#E5E5E5"> the</font>

28
00:01:21,540 --> 00:01:26,670
pain<font color="#CCCCCC"> we define ransomware</font>

29
00:01:23,850 --> 00:01:28,649
<font color="#E5E5E5">as malware with encryption so not all</font>

30
00:01:26,670 --> 00:01:31,740
malware is ransomware but all ransomware

31
00:01:28,650 --> 00:01:33,720
<font color="#E5E5E5">is malware it's mostly non-destructive</font>

32
00:01:31,740 --> 00:01:36,179
it started out a<font color="#CCCCCC"> non-destructive we've</font>

33
00:01:33,720 --> 00:01:37,650
seen it take some destructive trends<font color="#E5E5E5"> in</font>

34
00:01:36,180 --> 00:01:39,150
the past but primarily<font color="#E5E5E5"> it's</font>

35
00:01:37,650 --> 00:01:42,000
<font color="#E5E5E5">non-destructive it's virtually</font>

36
00:01:39,150 --> 00:01:44,159
impossible to crack<font color="#E5E5E5"> using RSA 2048</font>

37
00:01:42,000 --> 00:01:46,259
encryption<font color="#E5E5E5"> it would essentially take you</font>

38
00:01:44,159 --> 00:01:48,689
<font color="#E5E5E5">until the heat death of the universe</font>

39
00:01:46,259 --> 00:01:50,820
using<font color="#E5E5E5"> the harness power of every</font>

40
00:01:48,689 --> 00:01:54,210
computer<font color="#CCCCCC"> on the face</font><font color="#E5E5E5"> of the planet to</font>

41
00:01:50,820 --> 00:01:56,219
crack one hash<font color="#CCCCCC"> so you're</font><font color="#E5E5E5"> probably not</font>

42
00:01:54,210 --> 00:01:57,899
going to<font color="#CCCCCC"> get your data back and then</font>

43
00:01:56,219 --> 00:02:00,240
your ransom is paid in crypto currencies

44
00:01:57,899 --> 00:02:03,689
so<font color="#E5E5E5"> primarily we see that in Bitcoin we</font>

45
00:02:00,240 --> 00:02:05,429
haven't<font color="#E5E5E5"> really seen a step out into</font><font color="#CCCCCC"> a</font>

46
00:02:03,689 --> 00:02:07,648
theory<font color="#CCCCCC"> a more like coin or anything like</font>

47
00:02:05,430 --> 00:02:10,560
that but the ransom is<font color="#E5E5E5"> primarily paid in</font>

48
00:02:07,649 --> 00:02:13,680
crypto currencies<font color="#E5E5E5"> and so how</font><font color="#CCCCCC"> did we get</font>

49
00:02:10,560 --> 00:02:16,799
<font color="#E5E5E5">here so way back</font><font color="#CCCCCC"> in the dark</font><font color="#E5E5E5"> ages before</font>

50
00:02:13,680 --> 00:02:18,870
most of<font color="#E5E5E5"> us even used computers 1989</font><font color="#CCCCCC"> we</font>

51
00:02:16,799 --> 00:02:21,150
had a little piece of<font color="#CCCCCC"> malware</font><font color="#E5E5E5"> called PC</font>

52
00:02:18,870 --> 00:02:23,489
<font color="#CCCCCC">cyborg</font><font color="#E5E5E5"> and that was the very first piece</font>

53
00:02:21,150 --> 00:02:25,620
<font color="#E5E5E5">of</font><font color="#CCCCCC"> ransomware and we'll talk about these</font>

54
00:02:23,489 --> 00:02:28,769
<font color="#CCCCCC">more in depth</font><font color="#E5E5E5"> here in a minute</font>

55
00:02:25,620 --> 00:02:31,049
but if you<font color="#CCCCCC"> fast-forward</font><font color="#E5E5E5"> from 89 to 2005</font>

56
00:02:28,769 --> 00:02:33,930
<font color="#CCCCCC">you get to your first modern ransomware</font>

57
00:02:31,049 --> 00:02:36,540
<font color="#E5E5E5">which we know</font><font color="#CCCCCC"> as GP coder and then in</font>

58
00:02:33,930 --> 00:02:39,239
2008 we had<font color="#CCCCCC"> the scourge of fake</font><font color="#E5E5E5"> AV which</font>

59
00:02:36,540 --> 00:02:41,790
<font color="#CCCCCC">ten years later</font><font color="#E5E5E5"> really has not gone away</font>

60
00:02:39,239 --> 00:02:45,540
you have your<font color="#CCCCCC"> Locker variants</font><font color="#E5E5E5"> in 2011 so</font>

61
00:02:41,790 --> 00:02:47,220
<font color="#CCCCCC">Locker</font><font color="#E5E5E5"> Winlock</font><font color="#CCCCCC"> revit on in 2013 you get</font>

62
00:02:45,540 --> 00:02:49,709
into your modern crypto ransomware

63
00:02:47,220 --> 00:02:52,530
<font color="#CCCCCC">so that's cryptolocker crypto wall tesla</font>

64
00:02:49,709 --> 00:02:54,359
crypt<font color="#CCCCCC"> locky</font><font color="#E5E5E5"> all of these things and then</font>

65
00:02:52,530 --> 00:02:55,470
2017 we have everybody's favorite

66
00:02:54,359 --> 00:02:58,290
marketing<font color="#CCCCCC"> and headline didn't want to</font>

67
00:02:55,470 --> 00:02:59,579
cry<font color="#E5E5E5"> and then the not Pecha or</font><font color="#CCCCCC"> Pecha</font>

68
00:02:58,290 --> 00:03:02,879
<font color="#E5E5E5">attack however you want to talk about</font>

69
00:02:59,579 --> 00:03:05,849
that but let's take a step<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> the</font>

70
00:03:02,879 --> 00:03:07,739
Jurassic<font color="#E5E5E5"> age of ransomware</font><font color="#CCCCCC"> and let's</font>

71
00:03:05,849 --> 00:03:09,418
talk<font color="#E5E5E5"> about PC cyborgs</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> just as a note</font>

72
00:03:07,739 --> 00:03:11,280
I want<font color="#E5E5E5"> to say this is literally the only</font>

73
00:03:09,419 --> 00:03:13,049
<font color="#E5E5E5">image of PC</font><font color="#CCCCCC"> cyborgs I could find on the</font>

74
00:03:11,280 --> 00:03:14,519
<font color="#CCCCCC">Internet so it's fairly rare and I</font>

75
00:03:13,049 --> 00:03:17,280
couldn't find an installer for it

76
00:03:14,519 --> 00:03:19,650
anywhere<font color="#E5E5E5"> but it first appeared in 1989</font>

77
00:03:17,280 --> 00:03:22,019
<font color="#E5E5E5">and it was distributed</font><font color="#CCCCCC"> on five and a</font>

78
00:03:19,650 --> 00:03:25,409
quarter<font color="#E5E5E5"> inch</font><font color="#CCCCCC"> floppy disks if anybody in</font>

79
00:03:22,019 --> 00:03:28,260
this<font color="#E5E5E5"> room</font><font color="#CCCCCC"> knows what those are so we</font>

80
00:03:25,409 --> 00:03:30,659
<font color="#E5E5E5">have one hand but a replace autoexec.bat</font>

81
00:03:28,260 --> 00:03:33,209
<font color="#CCCCCC">on a system and it was used to count</font><font color="#E5E5E5"> the</font>

82
00:03:30,659 --> 00:03:34,978
number of<font color="#E5E5E5"> system boots and so once</font><font color="#CCCCCC"> we</font>

83
00:03:33,209 --> 00:03:37,310
get to<font color="#CCCCCC"> ninety boots</font><font color="#E5E5E5"> it encrypts the</font>

84
00:03:34,979 --> 00:03:40,379
system and demands<font color="#CCCCCC"> 189</font><font color="#E5E5E5"> dollars in ransom</font>

85
00:03:37,310 --> 00:03:43,759
for 1989<font color="#CCCCCC"> that's a fairly steep figure I</font>

86
00:03:40,379 --> 00:03:46,078
haven't done the conversion<font color="#E5E5E5"> to modern</font>

87
00:03:43,759 --> 00:03:48,179
money for inflation<font color="#E5E5E5"> but it's fairly</font>

88
00:03:46,079 --> 00:03:50,430
<font color="#E5E5E5">steep and it relied on symmetric</font>

89
00:03:48,180 --> 00:03:52,019
cryptography<font color="#E5E5E5"> so this is not something</font>

90
00:03:50,430 --> 00:03:54,060
<font color="#CCCCCC">that had a call home feature or anything</font>

91
00:03:52,019 --> 00:03:55,290
like<font color="#E5E5E5"> that it's literally very simplistic</font>

92
00:03:54,060 --> 00:03:57,599
<font color="#E5E5E5">in that it counted the number of boots</font>

93
00:03:55,290 --> 00:04:01,679
and<font color="#E5E5E5"> then once it's up to 90 it locks</font>

94
00:03:57,599 --> 00:04:03,149
<font color="#CCCCCC">down the</font><font color="#E5E5E5"> system and then we start to see</font>

95
00:04:01,680 --> 00:04:05,939
a<font color="#CCCCCC"> change in</font><font color="#E5E5E5"> this once we get into</font><font color="#CCCCCC"> the</font>

96
00:04:03,150 --> 00:04:07,949
future<font color="#CCCCCC"> once we go to</font><font color="#E5E5E5"> 2005 we start to</font>

97
00:04:05,939 --> 00:04:11,459
see your<font color="#E5E5E5"> first modern ransomware so your</font>

98
00:04:07,949 --> 00:04:14,759
things that<font color="#E5E5E5"> have the help how to decrypt</font>

99
00:04:11,459 --> 00:04:17,488
your files and these<font color="#E5E5E5"> maintain</font>

100
00:04:14,759 --> 00:04:18,930
persistence via<font color="#E5E5E5"> run key and then it</font>

101
00:04:17,488 --> 00:04:20,668
deletes itself<font color="#E5E5E5"> upon successful</font>

102
00:04:18,930 --> 00:04:22,380
encryption so after it encrypts<font color="#CCCCCC"> the</font>

103
00:04:20,668 --> 00:04:24,229
system it then deletes itself<font color="#E5E5E5"> and you</font>

104
00:04:22,380 --> 00:04:27,270
wouldn't be able<font color="#CCCCCC"> to detect the</font><font color="#E5E5E5"> installer</font>

105
00:04:24,229 --> 00:04:28,979
<font color="#E5E5E5">and again we're seeing</font>

106
00:04:27,270 --> 00:04:31,530
<font color="#CCCCCC">variance</font><font color="#E5E5E5"> here using symmetric key</font>

107
00:04:28,979 --> 00:04:33,479
encryption<font color="#CCCCCC"> so if you had the wherewithal</font>

108
00:04:31,530 --> 00:04:35,609
<font color="#E5E5E5">you could have actually decrypted these</font>

109
00:04:33,479 --> 00:04:39,240
on the local machine we didn't get<font color="#E5E5E5"> into</font>

110
00:04:35,610 --> 00:04:42,060
<font color="#CCCCCC">asymmetric encryption yet we get</font><font color="#E5E5E5"> into</font>

111
00:04:39,240 --> 00:04:44,270
around 2008 what we call fake<font color="#CCCCCC"> AV which</font>

112
00:04:42,060 --> 00:04:47,280
<font color="#E5E5E5">is not quite ransomware</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses the the</font>

113
00:04:44,270 --> 00:04:49,859
<font color="#CCCCCC">same distribution methods in</font><font color="#E5E5E5"> terms of</font>

114
00:04:47,280 --> 00:04:51,270
social engineering<font color="#CCCCCC"> pandering to people's</font>

115
00:04:49,860 --> 00:04:54,900
fear that they<font color="#CCCCCC"> have something on their</font>

116
00:04:51,270 --> 00:04:58,378
<font color="#E5E5E5">systems did not encrypt data but what it</font>

117
00:04:54,900 --> 00:05:00,179
did it was really scare people<font color="#E5E5E5"> into</font>

118
00:04:58,379 --> 00:05:02,430
paying<font color="#E5E5E5"> for</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so you would see one of</font>

119
00:05:00,180 --> 00:05:04,770
these where it would find that<font color="#E5E5E5"> you had</font>

120
00:05:02,430 --> 00:05:06,569
<font color="#E5E5E5">30,000 infected files on your</font><font color="#CCCCCC"> system and</font>

121
00:05:04,770 --> 00:05:09,180
then it would ask you<font color="#E5E5E5"> for</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> a measly</font>

122
00:05:06,569 --> 00:05:10,949
29.95<font color="#E5E5E5"> and</font><font color="#CCCCCC"> will take</font><font color="#E5E5E5"> care of all</font><font color="#CCCCCC"> that</font>

123
00:05:09,180 --> 00:05:13,080
when actually<font color="#E5E5E5"> what it did would detect</font>

124
00:05:10,949 --> 00:05:16,169
stuff like text files<font color="#E5E5E5"> and call those</font>

125
00:05:13,080 --> 00:05:17,880
infections<font color="#CCCCCC"> so it's really working</font><font color="#E5E5E5"> off</font><font color="#CCCCCC"> of</font>

126
00:05:16,169 --> 00:05:20,210
fear uncertainty and doubt<font color="#E5E5E5"> or flood as</font>

127
00:05:17,880 --> 00:05:23,789
we like<font color="#CCCCCC"> to call it</font>

128
00:05:20,210 --> 00:05:24,870
in late 2012<font color="#E5E5E5"> early 2013</font><font color="#CCCCCC"> we start</font><font color="#E5E5E5"> seeing</font>

129
00:05:23,789 --> 00:05:27,539
the Locker<font color="#E5E5E5"> variants</font>

130
00:05:24,870 --> 00:05:30,090
these are Winlock<font color="#CCCCCC"> revit on</font><font color="#E5E5E5"> don't know if</font>

131
00:05:27,539 --> 00:05:31,919
anybody here reads<font color="#CCCCCC"> Russian but</font><font color="#E5E5E5"> primarily</font>

132
00:05:30,090 --> 00:05:35,060
they come out<font color="#E5E5E5"> of</font><font color="#CCCCCC"> Russia</font><font color="#E5E5E5"> and as we can</font>

133
00:05:31,919 --> 00:05:37,590
<font color="#CCCCCC">see here we do have a lock screen</font><font color="#E5E5E5"> and</font>

134
00:05:35,060 --> 00:05:39,960
what these were were distributed via

135
00:05:37,590 --> 00:05:41,969
exploit kits so they would lock the

136
00:05:39,960 --> 00:05:45,299
desktop making the system<font color="#E5E5E5"> inaccessible</font>

137
00:05:41,969 --> 00:05:46,620
<font color="#E5E5E5">and they were known to</font><font color="#CCCCCC"> impersonate law</font>

138
00:05:45,300 --> 00:05:48,419
enforcement so if you ever had an

139
00:05:46,620 --> 00:05:50,490
instance where<font color="#CCCCCC"> you had a customer or an</font>

140
00:05:48,419 --> 00:05:51,900
employee<font color="#CCCCCC"> that said I've got a pop-up</font>

141
00:05:50,490 --> 00:05:54,479
<font color="#E5E5E5">screen that says I have child</font>

142
00:05:51,900 --> 00:05:55,859
pornography<font color="#CCCCCC"> on my system and very</font>

143
00:05:54,479 --> 00:05:59,460
obviously<font color="#E5E5E5"> you would hope that they're</font>

144
00:05:55,860 --> 00:06:01,110
not<font color="#E5E5E5"> pornographers but we'll see things</font>

145
00:05:59,460 --> 00:06:03,479
<font color="#E5E5E5">like</font><font color="#CCCCCC"> Revit on would impersonate those</font>

146
00:06:01,110 --> 00:06:07,259
and use that fear to<font color="#CCCCCC"> get them to pay the</font>

147
00:06:03,479 --> 00:06:09,599
fear of<font color="#CCCCCC"> having people know that you may</font>

148
00:06:07,259 --> 00:06:12,870
or may<font color="#CCCCCC"> not have done these things and</font>

149
00:06:09,599 --> 00:06:15,000
<font color="#E5E5E5">then what we get into in modern days are</font>

150
00:06:12,870 --> 00:06:16,289
our modern<font color="#E5E5E5"> ransom</font><font color="#CCCCCC"> wires</font><font color="#E5E5E5"> so locking</font>

151
00:06:15,000 --> 00:06:19,199
crypto wall things like that

152
00:06:16,289 --> 00:06:22,949
modern ransomware uses RSA 2048

153
00:06:19,199 --> 00:06:25,289
encryption<font color="#E5E5E5"> and</font><font color="#CCCCCC"> aes-256 that</font><font color="#E5E5E5"> encryption</font>

154
00:06:22,949 --> 00:06:27,270
is performed server-side so that

155
00:06:25,289 --> 00:06:30,419
prevents local decryption<font color="#E5E5E5"> so it's</font>

156
00:06:27,270 --> 00:06:32,789
<font color="#E5E5E5">asymmetric encryption those lock screens</font>

157
00:06:30,419 --> 00:06:35,520
are written in<font color="#E5E5E5"> every directory where</font>

158
00:06:32,789 --> 00:06:37,199
encrypted files are present<font color="#E5E5E5"> and then the</font>

159
00:06:35,520 --> 00:06:39,469
time of encryption<font color="#E5E5E5"> can</font><font color="#CCCCCC"> be determined</font>

160
00:06:37,199 --> 00:06:41,340
from<font color="#CCCCCC"> the right times on those help files</font>

161
00:06:39,469 --> 00:06:43,530
<font color="#CCCCCC">what we often</font><font color="#E5E5E5"> find</font>

162
00:06:41,340 --> 00:06:47,159
now is<font color="#E5E5E5"> that the ransomware will actually</font>

163
00:06:43,530 --> 00:06:49,198
replace<font color="#E5E5E5"> or will not replace the</font><font color="#CCCCCC"> right</font>

164
00:06:47,160 --> 00:06:50,729
<font color="#E5E5E5">times on the files it encrypts so it's</font>

165
00:06:49,199 --> 00:06:52,680
<font color="#E5E5E5">better to use the right times of the</font>

166
00:06:50,729 --> 00:06:56,610
files that<font color="#E5E5E5"> it drops to determine a time</font>

167
00:06:52,680 --> 00:06:57,960
of infection<font color="#CCCCCC"> and then last year</font><font color="#E5E5E5"> actually</font>

168
00:06:56,610 --> 00:06:59,100
<font color="#CCCCCC">right</font><font color="#E5E5E5"> around this time</font><font color="#CCCCCC"> we have</font>

169
00:06:57,960 --> 00:07:01,500
everybody's favorite<font color="#CCCCCC"> marketing the</font>

170
00:06:59,100 --> 00:07:02,010
headline want to cry<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a worming</font>

171
00:07:01,500 --> 00:07:03,600
ransomware

172
00:07:02,010 --> 00:07:06,810
that spreads via unpatched windows

173
00:07:03,600 --> 00:07:09,500
installations<font color="#E5E5E5"> uses eternal blue and to</font>

174
00:07:06,810 --> 00:07:12,449
take<font color="#E5E5E5"> advantage of the MS</font><font color="#CCCCCC"> 1701 Oh exploit</font>

175
00:07:09,500 --> 00:07:14,160
<font color="#CCCCCC">the ransomware</font><font color="#E5E5E5"> aspect is really</font><font color="#CCCCCC"> poorly</font>

176
00:07:12,449 --> 00:07:16,320
designed as really not<font color="#E5E5E5"> the newsworthy</font>

177
00:07:14,160 --> 00:07:18,510
part of it<font color="#E5E5E5"> the news where the aspect was</font>

178
00:07:16,320 --> 00:07:20,219
<font color="#CCCCCC">the warming capability</font><font color="#E5E5E5"> because what was</font>

179
00:07:18,510 --> 00:07:22,919
the<font color="#CCCCCC"> last real worm</font><font color="#E5E5E5"> that we dealt with</font>

180
00:07:20,220 --> 00:07:25,229
was probably<font color="#CCCCCC"> conficker</font><font color="#E5E5E5"> around 2009 so</font>

181
00:07:22,919 --> 00:07:27,270
<font color="#E5E5E5">you had essentially an eight nine year</font>

182
00:07:25,229 --> 00:07:28,830
period<font color="#CCCCCC"> where nobody had seen a worm in</font>

183
00:07:27,270 --> 00:07:31,740
the wild and a lot<font color="#E5E5E5"> of people got caught</font>

184
00:07:28,830 --> 00:07:34,020
unprepared<font color="#E5E5E5"> one of the other things we've</font>

185
00:07:31,740 --> 00:07:35,820
noticed<font color="#E5E5E5"> is ransomware as a service and</font>

186
00:07:34,020 --> 00:07:38,849
what we have here<font color="#CCCCCC"> is a screenshot of</font><font color="#E5E5E5"> the</font>

187
00:07:35,820 --> 00:07:40,469
github<font color="#E5E5E5"> page for hidden</font><font color="#CCCCCC"> tear</font><font color="#E5E5E5"> and you can</font>

188
00:07:38,850 --> 00:07:43,560
actually go<font color="#CCCCCC"> out to this</font><font color="#E5E5E5"> github page and</font>

189
00:07:40,470 --> 00:07:45,240
download<font color="#E5E5E5"> proof</font><font color="#CCCCCC"> of concept ransomware</font><font color="#E5E5E5"> and</font>

190
00:07:43,560 --> 00:07:46,860
essentially what this means<font color="#CCCCCC"> that</font><font color="#E5E5E5"> a large</font>

191
00:07:45,240 --> 00:07:48,150
number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> cyber criminals really don't</font>

192
00:07:46,860 --> 00:07:49,950
have to develop<font color="#E5E5E5"> their own ransom where</font>

193
00:07:48,150 --> 00:07:52,349
they can go<font color="#E5E5E5"> grab an installer off of</font>

194
00:07:49,950 --> 00:07:55,349
github<font color="#E5E5E5"> distribute it and then make some</font>

195
00:07:52,350 --> 00:07:57,479
money that<font color="#E5E5E5"> way</font><font color="#CCCCCC"> it developed even further</font>

196
00:07:55,350 --> 00:07:59,340
with the Satan ransomware<font color="#E5E5E5"> where the</font>

197
00:07:57,479 --> 00:08:00,960
developers became shareholders<font color="#E5E5E5"> they said</font>

198
00:07:59,340 --> 00:08:02,969
we will help you develop<font color="#CCCCCC"> this and</font>

199
00:08:00,960 --> 00:08:06,150
distribute it<font color="#CCCCCC"> you give us a</font><font color="#E5E5E5"> 30 percent</font>

200
00:08:02,970 --> 00:08:09,660
<font color="#E5E5E5">cut</font><font color="#CCCCCC"> so it really reinforces that malware</font>

201
00:08:06,150 --> 00:08:11,460
<font color="#CCCCCC">and adversarial attackers while they can</font>

202
00:08:09,660 --> 00:08:13,530
<font color="#CCCCCC">be political they are also business</font>

203
00:08:11,460 --> 00:08:14,969
oriented<font color="#E5E5E5"> so malware is a big business if</font>

204
00:08:13,530 --> 00:08:16,650
you have<font color="#E5E5E5"> great morals</font><font color="#CCCCCC"> you know maybe you</font>

205
00:08:14,970 --> 00:08:20,880
<font color="#E5E5E5">want to drive a Mercedes building</font>

206
00:08:16,650 --> 00:08:23,280
ransomware<font color="#CCCCCC"> I don't recommend</font><font color="#E5E5E5"> that but so</font>

207
00:08:20,880 --> 00:08:25,710
how do these infections occur we have

208
00:08:23,280 --> 00:08:26,789
primary methods of infection and there

209
00:08:25,710 --> 00:08:29,489
are three of<font color="#E5E5E5"> those we have</font>

210
00:08:26,789 --> 00:08:32,279
vulnerabilities<font color="#E5E5E5"> email and unpatched</font>

211
00:08:29,490 --> 00:08:34,140
software with<font color="#CCCCCC"> your vulnerabilities your</font>

212
00:08:32,279 --> 00:08:36,750
families of crypto wall and<font color="#E5E5E5"> Tesla crypt</font>

213
00:08:34,140 --> 00:08:38,789
<font color="#E5E5E5">really tended to use</font><font color="#CCCCCC"> those they would</font>

214
00:08:36,750 --> 00:08:40,708
<font color="#E5E5E5">exploit the angler exploit kit and the</font>

215
00:08:38,789 --> 00:08:43,409
nuclear exploit kit which took advantage

216
00:08:40,708 --> 00:08:44,640
of<font color="#CCCCCC"> Flash</font><font color="#E5E5E5"> and Java and</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> we also had</font>

217
00:08:43,409 --> 00:08:46,080
want to cry obviously that took

218
00:08:44,640 --> 00:08:48,810
<font color="#E5E5E5">advantage of Windows</font><font color="#CCCCCC"> for our abilities</font>

219
00:08:46,080 --> 00:08:51,390
one of the things that we often try to

220
00:08:48,810 --> 00:08:53,040
do in<font color="#E5E5E5"> our recommendations is say you</font>

221
00:08:51,390 --> 00:08:54,750
know<font color="#E5E5E5"> try to get</font><font color="#CCCCCC"> Flash and job out of</font>

222
00:08:53,040 --> 00:08:56,130
your environment<font color="#CCCCCC"> we</font>

223
00:08:54,750 --> 00:08:58,170
<font color="#CCCCCC">we</font><font color="#E5E5E5"> stopped</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> that after we started</font>

224
00:08:56,130 --> 00:08:59,880
<font color="#CCCCCC">getting laughed at on wrap-up calls when</font>

225
00:08:58,170 --> 00:09:03,900
people in the banking industry that have

226
00:08:59,880 --> 00:09:06,420
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> long term applications</font><font color="#CCCCCC"> that run</font>

227
00:09:03,900 --> 00:09:08,040
on<font color="#CCCCCC"> a version</font><font color="#E5E5E5"> of Java that's at this</font>

228
00:09:06,420 --> 00:09:10,079
point probably<font color="#E5E5E5"> 15</font><font color="#CCCCCC"> years old</font>

229
00:09:08,040 --> 00:09:13,469
can't<font color="#E5E5E5"> really get rid of it so we had to</font>

230
00:09:10,080 --> 00:09:16,320
come<font color="#E5E5E5"> at that from another point</font><font color="#CCCCCC"> Lackey</font>

231
00:09:13,470 --> 00:09:18,630
<font color="#CCCCCC">is a campaign</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> loves to push</font>

232
00:09:16,320 --> 00:09:20,220
email<font color="#CCCCCC"> and we've seen this</font><font color="#E5E5E5"> really in a</font>

233
00:09:18,630 --> 00:09:22,610
resurgence around<font color="#CCCCCC"> Christmastime</font><font color="#E5E5E5"> we</font>

234
00:09:20,220 --> 00:09:25,080
<font color="#CCCCCC">actually had one in December of 2017</font>

235
00:09:22,610 --> 00:09:27,330
<font color="#CCCCCC">they</font><font color="#E5E5E5"> love to use fake invoice</font>

236
00:09:25,080 --> 00:09:30,150
attachments<font color="#E5E5E5"> so</font><font color="#CCCCCC"> your fake FedEx UPS</font>

237
00:09:27,330 --> 00:09:32,580
notices<font color="#CCCCCC"> people still</font><font color="#E5E5E5"> haven't caught on</font>

238
00:09:30,150 --> 00:09:34,709
that that FedEx<font color="#CCCCCC"> and UPS don't send you</font>

239
00:09:32,580 --> 00:09:38,370
PDF<font color="#E5E5E5"> files that are actually executables</font>

240
00:09:34,710 --> 00:09:42,060
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> Word</font><font color="#E5E5E5"> docs that have macros in</font>

241
00:09:38,370 --> 00:09:44,340
them and those<font color="#CCCCCC"> Word</font><font color="#E5E5E5"> docs will reach out</font>

242
00:09:42,060 --> 00:09:46,589
grab the malicious executable download

243
00:09:44,340 --> 00:09:49,650
it and install<font color="#CCCCCC"> it and</font><font color="#E5E5E5"> then we have your</font>

244
00:09:46,590 --> 00:09:52,830
unpatched software<font color="#E5E5E5"> so things like</font><font color="#CCCCCC"> Sam</font>

245
00:09:49,650 --> 00:09:55,800
<font color="#E5E5E5">ass use it used the unpatched</font><font color="#CCCCCC"> JBoss</font>

246
00:09:52,830 --> 00:09:57,540
instances<font color="#E5E5E5"> that happened really about two</font>

247
00:09:55,800 --> 00:09:59,130
years<font color="#E5E5E5"> ago</font><font color="#CCCCCC"> but we still see</font><font color="#E5E5E5"> those once in</font>

248
00:09:57,540 --> 00:10:01,620
a while and then remote desktop is

249
00:09:59,130 --> 00:10:03,180
another one<font color="#E5E5E5"> if you've got 3389 exposed</font>

250
00:10:01,620 --> 00:10:04,440
to the<font color="#CCCCCC"> Internet you are probably</font><font color="#E5E5E5"> going</font>

251
00:10:03,180 --> 00:10:05,640
<font color="#E5E5E5">to get hit at</font><font color="#CCCCCC"> some point with a</font>

252
00:10:04,440 --> 00:10:09,120
<font color="#E5E5E5">brute-force attack if not with</font>

253
00:10:05,640 --> 00:10:11,880
ransomware so where<font color="#E5E5E5"> are we seeing these</font>

254
00:10:09,120 --> 00:10:13,589
there<font color="#E5E5E5"> are actually two answers to this</font>

255
00:10:11,880 --> 00:10:15,630
question the<font color="#CCCCCC"> short answer is everywhere</font>

256
00:10:13,589 --> 00:10:18,720
<font color="#E5E5E5">and the long answer</font><font color="#CCCCCC"> is no really</font>

257
00:10:15,630 --> 00:10:20,280
<font color="#E5E5E5">everywhere but we have three primary</font>

258
00:10:18,720 --> 00:10:22,140
verticals<font color="#E5E5E5"> where we see a lot</font><font color="#CCCCCC"> of</font>

259
00:10:20,280 --> 00:10:23,550
ransomware attacks<font color="#CCCCCC"> and that's going</font><font color="#E5E5E5"> to</font>

260
00:10:22,140 --> 00:10:25,290
<font color="#CCCCCC">be in healthcare</font><font color="#E5E5E5"> because you have your</font>

261
00:10:23,550 --> 00:10:27,839
<font color="#CCCCCC">hospital's imaging centers clinical</font>

262
00:10:25,290 --> 00:10:30,329
offices these places<font color="#E5E5E5"> that really</font><font color="#CCCCCC"> may not</font>

263
00:10:27,839 --> 00:10:31,470
have<font color="#E5E5E5"> visibility</font><font color="#CCCCCC"> into what's running you</font>

264
00:10:30,330 --> 00:10:33,750
have your<font color="#E5E5E5"> financial services</font>

265
00:10:31,470 --> 00:10:36,540
institutions which are<font color="#E5E5E5"> especially</font>

266
00:10:33,750 --> 00:10:38,040
vulnerable during<font color="#E5E5E5"> tax season and then</font>

267
00:10:36,540 --> 00:10:40,469
<font color="#E5E5E5">oil and natural gas because you have a</font>

268
00:10:38,040 --> 00:10:43,199
lot of<font color="#E5E5E5"> remote workers that are often</font>

269
00:10:40,470 --> 00:10:44,790
<font color="#E5E5E5">maybe not on managed systems but have</font>

270
00:10:43,200 --> 00:10:46,830
access to file shares and things<font color="#E5E5E5"> like</font>

271
00:10:44,790 --> 00:10:48,480
<font color="#CCCCCC">that</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> could</font><font color="#E5E5E5"> get an infection out</font>

272
00:10:46,830 --> 00:10:52,920
in the field and that<font color="#E5E5E5"> can jump back</font><font color="#CCCCCC"> into</font>

273
00:10:48,480 --> 00:10:55,589
your environment let's talk about a

274
00:10:52,920 --> 00:10:57,420
<font color="#E5E5E5">little bit in the trenches</font><font color="#CCCCCC"> and the</font>

275
00:10:55,589 --> 00:10:58,800
tagline<font color="#E5E5E5"> here is how much data got</font>

276
00:10:57,420 --> 00:11:01,170
encrypted because<font color="#E5E5E5"> that's a question that</font>

277
00:10:58,800 --> 00:11:03,719
<font color="#E5E5E5">we asked on the phone with one</font><font color="#CCCCCC"> of these</font>

278
00:11:01,170 --> 00:11:05,370
and so before<font color="#E5E5E5"> I</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> into the case</font>

279
00:11:03,720 --> 00:11:08,250
studies<font color="#E5E5E5"> I'm going to talk a little bit</font>

280
00:11:05,370 --> 00:11:08,480
about<font color="#E5E5E5"> the analysis tools that I use</font><font color="#CCCCCC"> so</font>

281
00:11:08,250 --> 00:11:10,250
this

282
00:11:08,480 --> 00:11:13,010
is not an endorsement of these tools

283
00:11:10,250 --> 00:11:15,620
this<font color="#E5E5E5"> is simply what I use I am ence</font>

284
00:11:13,010 --> 00:11:19,069
certified<font color="#E5E5E5"> so I primarily do a lot of my</font>

285
00:11:15,620 --> 00:11:22,070
forensic work<font color="#CCCCCC"> within in case</font><font color="#E5E5E5"> we were</font>

286
00:11:19,070 --> 00:11:24,800
<font color="#CCCCCC">using IEF we've moved</font><font color="#E5E5E5"> to axiom from</font>

287
00:11:22,070 --> 00:11:26,839
magnet forensics your standard shell

288
00:11:24,800 --> 00:11:27,949
bags<font color="#CCCCCC"> Explorer</font><font color="#E5E5E5"> jump list explore all the</font>

289
00:11:26,839 --> 00:11:30,769
places where you would look for file

290
00:11:27,949 --> 00:11:33,500
traces<font color="#CCCCCC"> for memory analysis we use</font>

291
00:11:30,769 --> 00:11:35,600
volatility and<font color="#CCCCCC"> redline depends</font><font color="#E5E5E5"> on if you</font>

292
00:11:33,500 --> 00:11:37,310
like command-line interfaces<font color="#E5E5E5"> or you know</font>

293
00:11:35,600 --> 00:11:39,620
graphical interfaces

294
00:11:37,310 --> 00:11:42,290
<font color="#CCCCCC">KooKoo sandbox is great for</font><font color="#E5E5E5"> detonating</font>

295
00:11:39,620 --> 00:11:46,880
samples in a safe environment<font color="#CCCCCC"> this is a</font>

296
00:11:42,290 --> 00:11:51,079
<font color="#CCCCCC">github link</font><font color="#E5E5E5"> to the cuckoo that Optive</font>

297
00:11:46,880 --> 00:11:53,510
uses internally<font color="#CCCCCC"> it is a break off of the</font>

298
00:11:51,079 --> 00:11:56,239
actual<font color="#E5E5E5"> main cuckoo sandbox but it works</font>

299
00:11:53,510 --> 00:11:58,910
pretty<font color="#E5E5E5"> well and then we have a list of</font>

300
00:11:56,240 --> 00:12:01,519
just<font color="#E5E5E5"> other tools</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> and JP Triforce is</font>

301
00:11:58,910 --> 00:12:03,800
fantastic for<font color="#CCCCCC"> MFT analysis so Master</font>

302
00:12:01,519 --> 00:12:05,570
<font color="#CCCCCC">File table</font><font color="#E5E5E5"> if you want to find out when</font>

303
00:12:03,800 --> 00:12:08,420
<font color="#E5E5E5">something was written the MFT doesn't</font>

304
00:12:05,570 --> 00:12:10,600
lie<font color="#CCCCCC"> event log Explorer is great for</font>

305
00:12:08,420 --> 00:12:13,729
<font color="#CCCCCC">looking at remote</font><font color="#E5E5E5"> desktop connections</font>

306
00:12:10,600 --> 00:12:16,130
just metadata is fantastic because you

307
00:12:13,730 --> 00:12:17,269
<font color="#E5E5E5">can</font><font color="#CCCCCC"> throw all kinds of</font><font color="#E5E5E5"> IPs at it if you</font>

308
00:12:16,130 --> 00:12:19,339
take a list of IPs

309
00:12:17,269 --> 00:12:21,980
<font color="#E5E5E5">feed it to just metadata it'll feed you</font>

310
00:12:19,339 --> 00:12:23,769
back all the who is the<font color="#CCCCCC"> geolocation</font><font color="#E5E5E5"> data</font>

311
00:12:21,980 --> 00:12:26,389
all<font color="#E5E5E5"> that stuff</font><font color="#CCCCCC"> so it's great for</font>

312
00:12:23,769 --> 00:12:28,519
<font color="#E5E5E5">building</font><font color="#CCCCCC"> heat maps of where</font><font color="#E5E5E5"> your attacks</font>

313
00:12:26,389 --> 00:12:30,199
are<font color="#CCCCCC"> coming from threat crowd is great</font>

314
00:12:28,519 --> 00:12:32,449
for making<font color="#E5E5E5"> pretty graphs for executives</font>

315
00:12:30,199 --> 00:12:35,510
for reports you can<font color="#CCCCCC"> look at associations</font>

316
00:12:32,449 --> 00:12:37,819
<font color="#E5E5E5">from</font><font color="#CCCCCC"> Mt 5s as well as URLs domains</font><font color="#E5E5E5"> and</font>

317
00:12:35,510 --> 00:12:39,860
then all the near soft tools browsing

318
00:12:37,819 --> 00:12:41,569
history view and when we get<font color="#E5E5E5"> into</font>

319
00:12:39,860 --> 00:12:43,610
network analysis we like to look at

320
00:12:41,569 --> 00:12:45,079
Wireshark<font color="#E5E5E5"> and things like that</font><font color="#CCCCCC"> so again</font>

321
00:12:43,610 --> 00:12:46,880
not an endorsement<font color="#CCCCCC"> these are just</font><font color="#E5E5E5"> what I</font>

322
00:12:45,079 --> 00:12:50,300
use maybe give you some<font color="#E5E5E5"> ideas when you</font>

323
00:12:46,880 --> 00:12:51,920
do your<font color="#E5E5E5"> own investigations let's take a</font>

324
00:12:50,300 --> 00:12:53,269
<font color="#E5E5E5">look at our first</font><font color="#CCCCCC"> real-world example</font>

325
00:12:51,920 --> 00:12:55,490
<font color="#E5E5E5">this is going to be a healthcare</font>

326
00:12:53,269 --> 00:12:57,230
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> and while we're looking</font><font color="#E5E5E5"> at</font>

327
00:12:55,490 --> 00:13:00,139
<font color="#E5E5E5">these I want you guys to kind</font><font color="#CCCCCC"> of get an</font>

328
00:12:57,230 --> 00:13:01,490
idea<font color="#CCCCCC"> of these</font><font color="#E5E5E5"> environments and look for</font>

329
00:13:00,139 --> 00:13:03,709
some commonalities<font color="#E5E5E5"> and maybe some things</font>

330
00:13:01,490 --> 00:13:05,839
<font color="#E5E5E5">that aren't so</font><font color="#CCCCCC"> common in</font><font color="#E5E5E5"> these we have a</font>

331
00:13:03,709 --> 00:13:08,719
surgical more surgical provider here

332
00:13:05,839 --> 00:13:10,699
with<font color="#E5E5E5"> multiple remote care centers</font><font color="#CCCCCC"> so</font>

333
00:13:08,720 --> 00:13:13,069
there's no dedicated on-site<font color="#E5E5E5"> IT staff</font>

334
00:13:10,699 --> 00:13:16,130
all of<font color="#CCCCCC"> that IT work is done remotely or</font>

335
00:13:13,069 --> 00:13:17,930
with temporary on-site visits<font color="#CCCCCC"> so</font>

336
00:13:16,130 --> 00:13:20,750
essentially what happens<font color="#E5E5E5"> is that when</font>

337
00:13:17,930 --> 00:13:21,380
<font color="#E5E5E5">these sites don't have IT on on staff</font>

338
00:13:20,750 --> 00:13:22,490
what

339
00:13:21,380 --> 00:13:24,710
looking for is when they get these

340
00:13:22,490 --> 00:13:26,090
infections<font color="#E5E5E5"> they have to report that and</font>

341
00:13:24,710 --> 00:13:27,470
then you have<font color="#CCCCCC"> a delay time between</font><font color="#E5E5E5"> the</font>

342
00:13:26,090 --> 00:13:29,810
<font color="#E5E5E5">time the ticket goes in the time that</font>

343
00:13:27,470 --> 00:13:31,400
<font color="#E5E5E5">attack is dispatched but what we had</font>

344
00:13:29,810 --> 00:13:34,880
here<font color="#CCCCCC"> was</font><font color="#E5E5E5"> a workstation infected with</font>

345
00:13:31,400 --> 00:13:36,620
crypto wall<font color="#E5E5E5"> and that infection occurred</font>

346
00:13:34,880 --> 00:13:38,660
via an exploit kit delivered through a

347
00:13:36,620 --> 00:13:39,890
malicious ad on a gaming website<font color="#E5E5E5"> so</font>

348
00:13:38,660 --> 00:13:41,719
somebody wasn't adhering to the

349
00:13:39,890 --> 00:13:43,910
acceptable use policy decided to go play

350
00:13:41,720 --> 00:13:45,260
a couple<font color="#E5E5E5"> of flash games unfortunately</font>

351
00:13:43,910 --> 00:13:47,569
they weren't<font color="#CCCCCC"> using an ad blocker</font>

352
00:13:45,260 --> 00:13:49,160
internally so any ad on that<font color="#CCCCCC"> site</font><font color="#E5E5E5"> could</font>

353
00:13:47,570 --> 00:13:51,920
have been compromised they came across<font color="#E5E5E5"> a</font>

354
00:13:49,160 --> 00:13:53,780
compromised one and that ended up<font color="#E5E5E5"> with</font>

355
00:13:51,920 --> 00:13:55,959
<font color="#E5E5E5">the local</font><font color="#CCCCCC"> workstations and the shared</font>

356
00:13:53,780 --> 00:13:58,250
folders on the<font color="#E5E5E5"> server getting encrypted</font>

357
00:13:55,960 --> 00:14:00,980
so let's talk<font color="#E5E5E5"> a little bit about crypto</font>

358
00:13:58,250 --> 00:14:03,770
wall<font color="#CCCCCC"> this first appeared</font><font color="#E5E5E5"> in early to mid</font>

359
00:14:00,980 --> 00:14:06,410
2014<font color="#CCCCCC"> as version 1 still present today</font><font color="#E5E5E5"> is</font>

360
00:14:03,770 --> 00:14:08,660
version 4 when cryptolocker was taken

361
00:14:06,410 --> 00:14:11,089
down<font color="#E5E5E5"> in</font><font color="#CCCCCC"> 2013 as part of Operation</font><font color="#E5E5E5"> Tovar</font>

362
00:14:08,660 --> 00:14:12,980
which is a which was a<font color="#E5E5E5"> multinational</font>

363
00:14:11,090 --> 00:14:15,710
effort to take down<font color="#E5E5E5"> the botnet behind</font>

364
00:14:12,980 --> 00:14:17,240
<font color="#E5E5E5">cryptolocker crypto defense arose from</font>

365
00:14:15,710 --> 00:14:19,880
the ashes of<font color="#CCCCCC"> that environment and</font><font color="#E5E5E5"> then</font>

366
00:14:17,240 --> 00:14:22,910
<font color="#CCCCCC">crypto wall is an evolution of crypto</font>

367
00:14:19,880 --> 00:14:25,910
defense<font color="#CCCCCC"> the current versions use RSA</font>

368
00:14:22,910 --> 00:14:29,329
2048 and AES 128 cbc to encrypt that

369
00:14:25,910 --> 00:14:31,310
data communications<font color="#E5E5E5"> are routed via i2p</font>

370
00:14:29,330 --> 00:14:32,750
and the<font color="#E5E5E5"> Tor protocols so if you're not</font>

371
00:14:31,310 --> 00:14:34,130
<font color="#E5E5E5">sniffing secure traffic on your</font>

372
00:14:32,750 --> 00:14:38,210
environment<font color="#E5E5E5"> you're probably not seeing</font>

373
00:14:34,130 --> 00:14:39,920
<font color="#CCCCCC">c2 traffic from ransomware</font><font color="#E5E5E5"> so you</font>

374
00:14:38,210 --> 00:14:43,220
probably want to take<font color="#E5E5E5"> a look at</font><font color="#CCCCCC"> 443 if</font>

375
00:14:39,920 --> 00:14:46,219
you have the capability so<font color="#E5E5E5"> we have</font>

376
00:14:43,220 --> 00:14:47,660
another healthcare example<font color="#E5E5E5"> and again we</font>

377
00:14:46,220 --> 00:14:50,420
have another imaging provider with

378
00:14:47,660 --> 00:14:52,490
multiple remote imaging centers these

379
00:14:50,420 --> 00:14:54,770
<font color="#E5E5E5">guys have no dedicated on-site IT staff</font>

380
00:14:52,490 --> 00:14:56,630
all IT work was done remotely<font color="#E5E5E5"> or with</font>

381
00:14:54,770 --> 00:14:58,130
temporary on-site visits we're starting

382
00:14:56,630 --> 00:14:59,630
to<font color="#E5E5E5"> see a pattern here</font>

383
00:14:58,130 --> 00:15:01,490
the<font color="#E5E5E5"> workstation was infected with the</font>

384
00:14:59,630 --> 00:15:04,340
<font color="#CCCCCC">locky</font><font color="#E5E5E5"> ransomware and this came in</font>

385
00:15:01,490 --> 00:15:07,760
<font color="#E5E5E5">through email</font><font color="#CCCCCC"> so we had a word</font><font color="#E5E5E5"> document</font>

386
00:15:04,340 --> 00:15:09,590
<font color="#CCCCCC">on a fake</font><font color="#E5E5E5"> invoice when the user opened</font>

387
00:15:07,760 --> 00:15:11,510
that<font color="#E5E5E5"> doc it asked to enable macros they</font>

388
00:15:09,590 --> 00:15:13,700
enabled it the macros connected out

389
00:15:11,510 --> 00:15:16,360
downloaded the ransomware binary<font color="#E5E5E5"> game</font>

390
00:15:13,700 --> 00:15:18,350
<font color="#E5E5E5">over you had a locked workstation and</font>

391
00:15:16,360 --> 00:15:21,290
shared folders on the<font color="#E5E5E5"> server got</font>

392
00:15:18,350 --> 00:15:23,690
encrypted so talking<font color="#CCCCCC"> about locky</font>

393
00:15:21,290 --> 00:15:26,689
<font color="#E5E5E5">this first appeared in</font><font color="#CCCCCC"> early to mid 2016</font>

394
00:15:23,690 --> 00:15:29,870
<font color="#E5E5E5">as version</font><font color="#CCCCCC"> 1 and</font><font color="#E5E5E5"> is still present today</font>

395
00:15:26,690 --> 00:15:31,520
<font color="#E5E5E5">as version 2 in version 3</font><font color="#CCCCCC"> there are</font>

396
00:15:29,870 --> 00:15:33,950
multiple variants including<font color="#CCCCCC"> thorin</font>

397
00:15:31,520 --> 00:15:35,540
Osiris so we have developers that are

398
00:15:33,950 --> 00:15:38,300
<font color="#E5E5E5">fans of</font><font color="#CCCCCC"> mythology</font>

399
00:15:35,540 --> 00:15:40,459
and then the current versions use RSA

400
00:15:38,300 --> 00:15:42,859
2048 and<font color="#E5E5E5"> aes-128</font>

401
00:15:40,460 --> 00:15:44,800
ECB<font color="#CCCCCC"> to encrypt that data again all of</font>

402
00:15:42,860 --> 00:15:47,330
<font color="#E5E5E5">that key generation is done</font><font color="#CCCCCC"> server-side</font>

403
00:15:44,800 --> 00:15:50,540
<font color="#E5E5E5">and then</font><font color="#CCCCCC"> C to communications use a</font>

404
00:15:47,330 --> 00:15:52,520
hard-coded<font color="#E5E5E5"> IP address</font><font color="#CCCCCC"> and then if</font><font color="#E5E5E5"> that</font>

405
00:15:50,540 --> 00:15:55,579
gets blocked it uses domain<font color="#E5E5E5"> generation</font>

406
00:15:52,520 --> 00:15:57,470
algorithms<font color="#E5E5E5"> to build out</font><font color="#CCCCCC"> domains that it</font>

407
00:15:55,580 --> 00:16:00,290
can contact so if<font color="#E5E5E5"> your hard blocking its</font>

408
00:15:57,470 --> 00:16:02,540
IP addresses it can detect that and then

409
00:16:00,290 --> 00:16:07,280
build domains<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it'll talk to outside</font>

410
00:16:02,540 --> 00:16:10,520
<font color="#CCCCCC">of that so our third example</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> is a</font>

411
00:16:07,280 --> 00:16:12,770
petroleum<font color="#E5E5E5"> and natural gas industry it's</font>

412
00:16:10,520 --> 00:16:15,050
a multinational<font color="#E5E5E5"> and they have a</font>

413
00:16:12,770 --> 00:16:17,420
combination<font color="#CCCCCC"> of on-site and remote</font><font color="#E5E5E5"> IT</font>

414
00:16:15,050 --> 00:16:19,760
workers<font color="#CCCCCC"> they have a high</font><font color="#E5E5E5"> visibility and</font>

415
00:16:17,420 --> 00:16:23,120
many tools in place to<font color="#CCCCCC"> monitor that</font>

416
00:16:19,760 --> 00:16:24,439
stuff<font color="#CCCCCC"> so essentially we're seeing a</font>

417
00:16:23,120 --> 00:16:26,270
<font color="#E5E5E5">change here instead of there</font><font color="#CCCCCC"> being</font>

418
00:16:24,440 --> 00:16:28,280
remote IT staff it's a combination of

419
00:16:26,270 --> 00:16:30,949
on-site<font color="#E5E5E5"> and IT staff</font><font color="#CCCCCC"> and a bunch of</font>

420
00:16:28,280 --> 00:16:33,439
tools this user system was infected with

421
00:16:30,950 --> 00:16:35,600
<font color="#E5E5E5">Tesla</font><font color="#CCCCCC"> crypt</font><font color="#E5E5E5"> the infection occurred via</font>

422
00:16:33,440 --> 00:16:37,880
the angler exploit kit during<font color="#E5E5E5"> the</font>

423
00:16:35,600 --> 00:16:40,070
browsing session and that workstation

424
00:16:37,880 --> 00:16:42,350
<font color="#CCCCCC">was infected along with an</font><font color="#E5E5E5"> 80</font><font color="#CCCCCC"> terabyte</font>

425
00:16:40,070 --> 00:16:44,390
<font color="#CCCCCC">Sam and the entire thing was encrypted</font>

426
00:16:42,350 --> 00:16:47,210
<font color="#CCCCCC">so when they got</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the phone with us</font>

427
00:16:44,390 --> 00:16:48,710
they had us in one ear and EMC in the

428
00:16:47,210 --> 00:16:51,470
other ear and they were<font color="#E5E5E5"> screaming into</font>

429
00:16:48,710 --> 00:16:53,270
both phones so<font color="#CCCCCC"> that infection occurred</font>

430
00:16:51,470 --> 00:16:55,610
on a Friday<font color="#E5E5E5"> leading into the weekend and</font>

431
00:16:53,270 --> 00:16:58,640
the tools that they had in place<font color="#CCCCCC"> did not</font>

432
00:16:55,610 --> 00:17:01,520
alert on that infection and as they were

433
00:16:58,640 --> 00:17:04,400
not tailored for ransomware<font color="#E5E5E5"> and so what</font>

434
00:17:01,520 --> 00:17:06,079
we had happened was that<font color="#E5E5E5"> infection was</font>

435
00:17:04,400 --> 00:17:08,480
not identified<font color="#CCCCCC"> until a day and a</font><font color="#E5E5E5"> half</font>

436
00:17:06,079 --> 00:17:10,429
after<font color="#E5E5E5"> the infection and encryption so</font>

437
00:17:08,480 --> 00:17:12,819
that ransomware essentially had a day

438
00:17:10,430 --> 00:17:15,470
<font color="#CCCCCC">and a half to run rampant in the sand</font>

439
00:17:12,819 --> 00:17:17,629
<font color="#CCCCCC">there is a happy ending to that story</font>

440
00:17:15,470 --> 00:17:20,480
they actually had hourly incremental

441
00:17:17,630 --> 00:17:22,339
backups<font color="#E5E5E5"> on that sand so they only ended</font>

442
00:17:20,480 --> 00:17:23,810
up losing<font color="#E5E5E5"> a day and a</font><font color="#CCCCCC"> half of work</font><font color="#E5E5E5"> but</font>

443
00:17:22,339 --> 00:17:25,419
if that had<font color="#CCCCCC"> happened on</font><font color="#E5E5E5"> a Monday and</font><font color="#CCCCCC"> not</font>

444
00:17:23,810 --> 00:17:29,659
a Friday it<font color="#CCCCCC"> could have</font><font color="#E5E5E5"> been a lot worse</font>

445
00:17:25,420 --> 00:17:32,540
<font color="#E5E5E5">so test your backups</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about</font>

446
00:17:29,660 --> 00:17:35,090
<font color="#CCCCCC">Tesla crypt</font><font color="#E5E5E5"> this first appeared in</font><font color="#CCCCCC"> early</font>

447
00:17:32,540 --> 00:17:37,580
2015<font color="#E5E5E5"> as version</font><font color="#CCCCCC"> 1 and</font><font color="#E5E5E5"> remained live</font>

448
00:17:35,090 --> 00:17:39,379
through 2016 as version<font color="#E5E5E5"> 3 it was</font>

449
00:17:37,580 --> 00:17:42,409
delivered via<font color="#E5E5E5"> the angular exploit kit</font>

450
00:17:39,380 --> 00:17:44,270
and it uses<font color="#E5E5E5"> RSA 4096 to encrypt data</font>

451
00:17:42,410 --> 00:17:46,940
because twice as good as twice<font color="#CCCCCC"> is better</font>

452
00:17:44,270 --> 00:17:48,770
and then<font color="#CCCCCC"> tor for c2</font><font color="#E5E5E5"> communications so</font>

453
00:17:46,940 --> 00:17:51,470
again we're seeing<font color="#E5E5E5"> the use of</font>

454
00:17:48,770 --> 00:17:54,110
symmetric encryption<font color="#CCCCCC"> and secure traffic</font>

455
00:17:51,470 --> 00:17:55,700
<font color="#CCCCCC">4c2</font><font color="#E5E5E5"> communications</font><font color="#CCCCCC"> the developers</font>

456
00:17:54,110 --> 00:17:59,750
actually<font color="#E5E5E5"> shut</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> the Tesla</font><font color="#CCCCCC"> crypt</font>

457
00:17:55,700 --> 00:18:02,390
<font color="#CCCCCC">project and issued an apology</font><font color="#E5E5E5"> in around</font>

458
00:17:59,750 --> 00:18:05,840
December of 2016<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> very kind of</font>

459
00:18:02,390 --> 00:18:07,940
them<font color="#E5E5E5"> and he said thereafter released a</font>

460
00:18:05,840 --> 00:18:09,379
decryption tool so if you actually do

461
00:18:07,940 --> 00:18:11,090
<font color="#CCCCCC">have a system that was encrypted with</font>

462
00:18:09,380 --> 00:18:13,730
<font color="#E5E5E5">Tesla crypt</font><font color="#CCCCCC"> and you want to get it</font>

463
00:18:11,090 --> 00:18:17,389
decrypted<font color="#E5E5E5"> those keys are</font><font color="#CCCCCC"> in the wild now</font>

464
00:18:13,730 --> 00:18:19,570
so you<font color="#E5E5E5"> should be</font><font color="#CCCCCC"> able to decrypt</font><font color="#E5E5E5"> that so</font>

465
00:18:17,390 --> 00:18:22,490
let's take a look at some<font color="#E5E5E5"> common threads</font>

466
00:18:19,570 --> 00:18:25,040
<font color="#CCCCCC">all - all</font><font color="#E5E5E5"> the tools that we</font><font color="#CCCCCC"> had in place</font>

467
00:18:22,490 --> 00:18:26,990
in these<font color="#CCCCCC"> environments were reactive IT</font>

468
00:18:25,040 --> 00:18:29,510
personnel really had no clue something

469
00:18:26,990 --> 00:18:30,740
<font color="#E5E5E5">was wrong until it was too late</font><font color="#CCCCCC"> and by</font>

470
00:18:29,510 --> 00:18:32,929
<font color="#E5E5E5">that the encryptions weren't identified</font>

471
00:18:30,740 --> 00:18:35,300
<font color="#CCCCCC">until users</font><font color="#E5E5E5"> couldn't access their data</font>

472
00:18:32,929 --> 00:18:37,780
<font color="#E5E5E5">so essentially somebody tried</font><font color="#CCCCCC"> to access</font>

473
00:18:35,300 --> 00:18:40,220
<font color="#E5E5E5">a shared CSV and they couldn't get to it</font>

474
00:18:37,780 --> 00:18:42,500
that encryption began at the<font color="#E5E5E5"> perimeter</font>

475
00:18:40,220 --> 00:18:45,740
<font color="#E5E5E5">at the</font><font color="#CCCCCC"> workstation and worked in words</font>

476
00:18:42,500 --> 00:18:48,170
towards the shares so we're gonna do a

477
00:18:45,740 --> 00:18:49,610
little<font color="#E5E5E5"> test here a little live demo</font><font color="#CCCCCC"> of</font>

478
00:18:48,170 --> 00:18:51,770
some ransomware and<font color="#E5E5E5"> hopefully this works</font>

479
00:18:49,610 --> 00:18:53,959
<font color="#CCCCCC">you</font><font color="#E5E5E5"> always know how live demos go in</font>

480
00:18:51,770 --> 00:18:55,330
conferences but we're<font color="#E5E5E5"> gonna talk</font><font color="#CCCCCC"> a</font>

481
00:18:53,960 --> 00:18:57,800
little bit about<font color="#E5E5E5"> bit Paymer</font>

482
00:18:55,330 --> 00:19:00,169
this is distributed via remote desktop

483
00:18:57,800 --> 00:19:02,149
<font color="#CCCCCC">and this is a</font><font color="#E5E5E5"> sample</font><font color="#CCCCCC"> that I recovered</font>

484
00:19:00,170 --> 00:19:05,330
<font color="#CCCCCC">from an engagement</font><font color="#E5E5E5"> that I worked so this</font>

485
00:19:02,150 --> 00:19:06,800
is a live<font color="#CCCCCC"> sample it</font><font color="#E5E5E5"> uses a</font><font color="#CCCCCC"> yes to mask</font>

486
00:19:05,330 --> 00:19:09,230
it's running process so when you

487
00:19:06,800 --> 00:19:10,970
actually<font color="#E5E5E5"> run the malware essentially</font>

488
00:19:09,230 --> 00:19:13,150
what<font color="#E5E5E5"> it does</font><font color="#CCCCCC"> is it spawns an alternate</font>

489
00:19:10,970 --> 00:19:15,679
data stream<font color="#E5E5E5"> that doesn't share</font><font color="#CCCCCC"> the</font>

490
00:19:13,150 --> 00:19:17,330
processes<font color="#E5E5E5"> name so it's really hard to</font>

491
00:19:15,679 --> 00:19:19,910
detect in memory if you're looking for

492
00:19:17,330 --> 00:19:22,159
specific process names<font color="#E5E5E5"> it hides in app</font>

493
00:19:19,910 --> 00:19:23,390
data and it<font color="#E5E5E5"> uses an auto run key for</font>

494
00:19:22,160 --> 00:19:26,510
persistence<font color="#CCCCCC"> so it is fairly</font>

495
00:19:23,390 --> 00:19:29,540
straightforward fairly simple but let's

496
00:19:26,510 --> 00:19:35,890
make sure this works<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we'll come over</font>

497
00:19:29,540 --> 00:19:39,050
<font color="#E5E5E5">to our VM here all right so</font><font color="#CCCCCC"> I have</font>

498
00:19:35,890 --> 00:19:42,110
<font color="#CCCCCC">process process Explorer running here</font>

499
00:19:39,050 --> 00:19:43,639
<font color="#E5E5E5">and we'll just move that over to the</font>

500
00:19:42,110 --> 00:19:46,399
<font color="#E5E5E5">side just to give you an idea of what's</font>

501
00:19:43,640 --> 00:19:48,140
running<font color="#E5E5E5"> on here</font><font color="#CCCCCC"> we have a couple</font><font color="#E5E5E5"> of</font>

502
00:19:46,400 --> 00:19:50,200
files<font color="#E5E5E5"> here we have our standard</font><font color="#CCCCCC"> end-user</font>

503
00:19:48,140 --> 00:19:53,809
<font color="#CCCCCC">License Agreement for process Explorer</font>

504
00:19:50,200 --> 00:19:57,620
<font color="#E5E5E5">just have it</font><font color="#CCCCCC"> here as an example we have</font>

505
00:19:53,809 --> 00:19:59,840
<font color="#E5E5E5">our</font><font color="#CCCCCC"> friendly</font><font color="#E5E5E5"> neighborhood slowpoke and</font>

506
00:19:57,620 --> 00:20:01,639
our friendly neighborhood spider-man<font color="#E5E5E5"> and</font>

507
00:19:59,840 --> 00:20:05,178
I have these in<font color="#E5E5E5"> here just</font><font color="#CCCCCC"> an example</font><font color="#E5E5E5"> of</font>

508
00:20:01,640 --> 00:20:06,520
<font color="#E5E5E5">files that you know maybe would be in a</font>

509
00:20:05,179 --> 00:20:09,470
<font color="#E5E5E5">user's directory or something like that</font>

510
00:20:06,520 --> 00:20:11,480
<font color="#E5E5E5">and what I want to show with this is not</font>

511
00:20:09,470 --> 00:20:14,059
specifically how<font color="#E5E5E5"> to do an analysis or</font>

512
00:20:11,480 --> 00:20:15,800
anything like<font color="#E5E5E5"> that but</font><font color="#CCCCCC"> just how fast a</font>

513
00:20:14,059 --> 00:20:18,080
system will get encrypted once

514
00:20:15,800 --> 00:20:20,389
ransomware<font color="#E5E5E5"> is in an environment</font><font color="#CCCCCC"> so we're</font>

515
00:20:18,080 --> 00:20:25,699
just<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to take this binary we're</font>

516
00:20:20,390 --> 00:20:29,690
gonna run<font color="#E5E5E5"> it we have the ADF stream pop</font>

517
00:20:25,700 --> 00:20:32,570
up and there<font color="#E5E5E5"> you go you now have an</font>

518
00:20:29,690 --> 00:20:35,330
encrypted system<font color="#CCCCCC"> and so what we have</font>

519
00:20:32,570 --> 00:20:38,000
<font color="#CCCCCC">here is this is our original JPEG for</font>

520
00:20:35,330 --> 00:20:40,370
<font color="#E5E5E5">slowpoke and this is our</font><font color="#CCCCCC"> readme file and</font>

521
00:20:38,000 --> 00:20:43,700
so let's<font color="#E5E5E5"> just pop this open</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> notepad</font>

522
00:20:40,370 --> 00:20:45,979
<font color="#CCCCCC">oh</font><font color="#E5E5E5"> our networks been penetrated</font>

523
00:20:43,700 --> 00:20:47,929
so everything within<font color="#E5E5E5"> the host</font>

524
00:20:45,980 --> 00:20:50,990
<font color="#CCCCCC">environment has been encrypted with</font><font color="#E5E5E5"> a</font>

525
00:20:47,929 --> 00:20:53,660
strong algorithm and then here's your

526
00:20:50,990 --> 00:20:58,270
onion<font color="#E5E5E5"> address and a nice protonmail</font>

527
00:20:53,660 --> 00:21:00,620
account for decrypting that<font color="#E5E5E5"> so</font>

528
00:20:58,270 --> 00:21:02,418
<font color="#E5E5E5">essentially what happened in this</font>

529
00:21:00,620 --> 00:21:05,479
environment<font color="#E5E5E5"> was somebody penetrated the</font>

530
00:21:02,419 --> 00:21:08,270
network via remote desktop they gained

531
00:21:05,480 --> 00:21:10,940
access to domain administrator keys and

532
00:21:08,270 --> 00:21:13,280
then ran rampant<font color="#E5E5E5"> so they had domain</font>

533
00:21:10,940 --> 00:21:15,320
administrator access disabled<font color="#E5E5E5"> the</font>

534
00:21:13,280 --> 00:21:18,440
environments<font color="#E5E5E5"> antivirus protection and</font>

535
00:21:15,320 --> 00:21:20,450
then deployed this unfortunately the

536
00:21:18,440 --> 00:21:22,309
<font color="#CCCCCC">endgame</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> this was the customer had to</font>

537
00:21:20,450 --> 00:21:24,470
entirely rebuild their environment

538
00:21:22,309 --> 00:21:28,340
<font color="#CCCCCC">because it was compromised from</font><font color="#E5E5E5"> the top</font>

539
00:21:24,470 --> 00:21:31,730
down<font color="#CCCCCC"> so that's just a</font><font color="#E5E5E5"> simple example of</font>

540
00:21:28,340 --> 00:21:35,780
how<font color="#CCCCCC"> quickly ransomware</font><font color="#E5E5E5"> can encrypt a</font>

541
00:21:31,730 --> 00:21:37,730
system<font color="#E5E5E5"> and then as we see it's no</font><font color="#CCCCCC"> longer</font>

542
00:21:35,780 --> 00:21:39,110
sitting in memory so if you're not

543
00:21:37,730 --> 00:21:41,960
monitoring memory if you're not doing

544
00:21:39,110 --> 00:21:45,100
process detection on endpoints<font color="#E5E5E5"> you're</font>

545
00:21:41,960 --> 00:21:45,100
<font color="#E5E5E5">probably going to miss that</font><font color="#CCCCCC"> spawn</font>

546
00:21:56,330 --> 00:22:02,730
so how do we protect<font color="#E5E5E5"> against things</font><font color="#CCCCCC"> like</font>

547
00:21:58,560 --> 00:22:06,360
that and what we've<font color="#E5E5E5"> come up</font><font color="#CCCCCC"> with is kind</font>

548
00:22:02,730 --> 00:22:08,070
<font color="#CCCCCC">of a conglomeration</font><font color="#E5E5E5"> of items to help</font>

549
00:22:06,360 --> 00:22:09,540
<font color="#CCCCCC">protect your environment</font><font color="#E5E5E5"> we're talking</font>

550
00:22:08,070 --> 00:22:12,090
about patches backups file integrity

551
00:22:09,540 --> 00:22:14,670
monitoring<font color="#CCCCCC"> endpoint process visibility</font>

552
00:22:12,090 --> 00:22:16,260
security awareness training<font color="#E5E5E5"> email</font>

553
00:22:14,670 --> 00:22:18,150
extension filters and then<font color="#E5E5E5"> AppLocker</font>

554
00:22:16,260 --> 00:22:21,390
software restriction GPOs and network

555
00:22:18,150 --> 00:22:23,250
segmentation<font color="#CCCCCC"> and these are not in any</font>

556
00:22:21,390 --> 00:22:25,530
<font color="#CCCCCC">specific</font><font color="#E5E5E5"> order these are all of equal</font>

557
00:22:23,250 --> 00:22:27,450
<font color="#E5E5E5">importance so let's start by</font><font color="#CCCCCC"> talking</font>

558
00:22:25,530 --> 00:22:29,760
about patches backups and file integrity

559
00:22:27,450 --> 00:22:31,350
monitoring<font color="#E5E5E5"> so patching systems is</font>

560
00:22:29,760 --> 00:22:34,020
imperative<font color="#E5E5E5"> we saw this about this time</font>

561
00:22:31,350 --> 00:22:35,610
last<font color="#CCCCCC"> year</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> wanna cry if you can't</font>

562
00:22:34,020 --> 00:22:37,139
get<font color="#E5E5E5"> rid of Java and</font><font color="#CCCCCC"> flash or if you</font>

563
00:22:35,610 --> 00:22:39,060
laugh at consultants<font color="#E5E5E5"> that tell you to</font>

564
00:22:37,140 --> 00:22:41,010
get<font color="#E5E5E5"> rid</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> please</font><font color="#E5E5E5"> make sure they're</font>

565
00:22:39,060 --> 00:22:43,139
<font color="#CCCCCC">updated as well</font><font color="#E5E5E5"> as you can</font>

566
00:22:41,010 --> 00:22:45,840
tested backups are the cheapest and

567
00:22:43,140 --> 00:22:48,930
easiest mitigation against ransomware

568
00:22:45,840 --> 00:22:50,760
<font color="#E5E5E5">and a backup is really just data unless</font>

569
00:22:48,930 --> 00:22:52,620
it's tested<font color="#E5E5E5"> so if you have a disaster</font>

570
00:22:50,760 --> 00:22:54,780
<font color="#CCCCCC">recovery plan if you have a</font><font color="#E5E5E5"> business</font>

571
00:22:52,620 --> 00:22:57,629
continuity plan you don't<font color="#E5E5E5"> test it it's</font>

572
00:22:54,780 --> 00:22:59,670
about<font color="#E5E5E5"> worth it's worth</font><font color="#CCCCCC"> about as much as</font>

573
00:22:57,630 --> 00:23:01,590
the paper it's written on<font color="#CCCCCC"> and then file</font>

574
00:22:59,670 --> 00:23:03,900
integrity monitoring helps identify and

575
00:23:01,590 --> 00:23:05,459
revert changes<font color="#E5E5E5"> ransomware makes so what</font>

576
00:23:03,900 --> 00:23:08,790
we call<font color="#E5E5E5"> these</font><font color="#CCCCCC"> are the canary in the</font>

577
00:23:05,460 --> 00:23:10,950
coalmine<font color="#CCCCCC"> so if you have a piece of</font><font color="#E5E5E5"> data</font>

578
00:23:08,790 --> 00:23:13,260
<font color="#E5E5E5">that you're using to test within the</font>

579
00:23:10,950 --> 00:23:15,720
<font color="#E5E5E5">environment and it triggers and you</font>

580
00:23:13,260 --> 00:23:19,230
<font color="#CCCCCC">notice it you can actually help</font><font color="#E5E5E5"> to stop</font>

581
00:23:15,720 --> 00:23:21,810
that infection before<font color="#CCCCCC"> it occurs</font><font color="#E5E5E5"> endpoint</font>

582
00:23:19,230 --> 00:23:23,370
process visibility is<font color="#E5E5E5"> great it's</font>

583
00:23:21,810 --> 00:23:26,310
critically important<font color="#CCCCCC"> that you know</font>

584
00:23:23,370 --> 00:23:27,899
what's running<font color="#E5E5E5"> on your systems endpoint</font>

585
00:23:26,310 --> 00:23:30,659
monitoring software<font color="#E5E5E5"> can alert on those</font>

586
00:23:27,900 --> 00:23:32,640
process spawns<font color="#E5E5E5"> like we saw with bit</font>

587
00:23:30,660 --> 00:23:34,590
paper here<font color="#E5E5E5"> those solutions can provide</font>

588
00:23:32,640 --> 00:23:35,610
one-click hash<font color="#E5E5E5"> banning so one</font><font color="#CCCCCC"> of the</font>

589
00:23:34,590 --> 00:23:37,379
things that we've<font color="#E5E5E5"> noticed about</font>

590
00:23:35,610 --> 00:23:40,290
ransomware developers is<font color="#CCCCCC"> that they're</font>

591
00:23:37,380 --> 00:23:42,000
<font color="#E5E5E5">not very creative</font><font color="#CCCCCC"> they will send out a</font>

592
00:23:40,290 --> 00:23:44,760
bunch of<font color="#E5E5E5"> installers that all have the</font>

593
00:23:42,000 --> 00:23:46,620
same<font color="#CCCCCC"> md5 hash</font><font color="#E5E5E5"> which is why you know</font>

594
00:23:44,760 --> 00:23:49,110
traditional<font color="#CCCCCC"> AV works so well against</font>

595
00:23:46,620 --> 00:23:50,699
ransomware<font color="#CCCCCC"> but then again you</font><font color="#E5E5E5"> know we've</font>

596
00:23:49,110 --> 00:23:52,199
also seen<font color="#E5E5E5"> that they actively</font><font color="#CCCCCC"> develop</font>

597
00:23:50,700 --> 00:23:54,060
<font color="#E5E5E5">these things</font><font color="#CCCCCC"> so they may flip a bit and</font>

598
00:23:52,200 --> 00:23:56,760
change<font color="#E5E5E5"> that md5 as soon as a detection</font>

599
00:23:54,060 --> 00:23:59,940
comes out we like<font color="#E5E5E5"> to use virustotal to</font>

600
00:23:56,760 --> 00:24:02,640
monitor binaries<font color="#CCCCCC"> so do the bad guys</font><font color="#E5E5E5"> so</font>

601
00:23:59,940 --> 00:24:03,630
understanding<font color="#E5E5E5"> what is running</font><font color="#CCCCCC"> is on a</font>

602
00:24:02,640 --> 00:24:06,090
system

603
00:24:03,630 --> 00:24:08,390
is key<font color="#E5E5E5"> and we'll talk a little bit about</font>

604
00:24:06,090 --> 00:24:11,820
<font color="#E5E5E5">app Locker</font><font color="#CCCCCC"> s RPGs Network segmentation</font>

605
00:24:08,390 --> 00:24:13,590
<font color="#CCCCCC">there was a question earlier in one</font><font color="#E5E5E5"> of</font>

606
00:24:11,820 --> 00:24:16,200
<font color="#CCCCCC">the presentations about how effective is</font>

607
00:24:13,590 --> 00:24:17,699
<font color="#CCCCCC">whitelisting</font><font color="#E5E5E5"> one of the things that we</font>

608
00:24:16,200 --> 00:24:19,530
noticed<font color="#E5E5E5"> is that</font><font color="#CCCCCC"> whitelisting is super</font>

609
00:24:17,700 --> 00:24:21,450
effective<font color="#CCCCCC"> but you're gonna need one dude</font>

610
00:24:19,530 --> 00:24:25,320
<font color="#E5E5E5">work in 40 hours</font><font color="#CCCCCC"> a week</font><font color="#E5E5E5"> to keep</font>

611
00:24:21,450 --> 00:24:27,930
<font color="#E5E5E5">everything appropriately appropriately</font>

612
00:24:25,320 --> 00:24:29,850
<font color="#CCCCCC">white listed</font><font color="#E5E5E5"> it is free with full</font>

613
00:24:27,930 --> 00:24:32,220
documentation<font color="#E5E5E5"> from Microsoft and that's</font>

614
00:24:29,850 --> 00:24:35,669
app Locker and software restriction

615
00:24:32,220 --> 00:24:40,350
policies<font color="#E5E5E5"> app Locker works the same as</font>

616
00:24:35,670 --> 00:24:42,870
software restriction policies but app

617
00:24:40,350 --> 00:24:47,189
lockers<font color="#E5E5E5"> for</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> 7</font><font color="#CCCCCC"> & 2 K</font><font color="#E5E5E5"> 8</font><font color="#CCCCCC"> r2 and higher</font>

618
00:24:42,870 --> 00:24:48,929
and<font color="#CCCCCC"> SRP SR for lower systems</font><font color="#E5E5E5"> it will</font>

619
00:24:47,190 --> 00:24:51,420
stop most ransomware and<font color="#E5E5E5"> malware in its</font>

620
00:24:48,930 --> 00:24:53,820
tracks<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's super intensive to</font>

621
00:24:51,420 --> 00:24:56,130
maintain so there's a<font color="#E5E5E5"> trade-off</font><font color="#CCCCCC"> for it</font>

622
00:24:53,820 --> 00:24:58,379
<font color="#CCCCCC">network segmentation is beyond the scope</font>

623
00:24:56,130 --> 00:25:01,320
<font color="#CCCCCC">of this talk really</font><font color="#E5E5E5"> but you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use</font>

624
00:24:58,380 --> 00:25:03,090
a<font color="#E5E5E5"> network architect and build out you</font>

625
00:25:01,320 --> 00:25:05,010
know your Fort Knox<font color="#CCCCCC"> so all</font><font color="#E5E5E5"> of your</font>

626
00:25:03,090 --> 00:25:06,840
critical systems<font color="#CCCCCC"> need to be protected</font>

627
00:25:05,010 --> 00:25:08,760
<font color="#E5E5E5">and really at this</font><font color="#CCCCCC"> point if you're</font>

628
00:25:06,840 --> 00:25:10,439
<font color="#E5E5E5">worried about endpoints and protecting</font>

629
00:25:08,760 --> 00:25:11,970
them it's probably more effective<font color="#E5E5E5"> to</font>

630
00:25:10,440 --> 00:25:14,580
<font color="#E5E5E5">just wipe and rebuild</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> system if it</font>

631
00:25:11,970 --> 00:25:18,390
gets infected<font color="#CCCCCC"> and focused</font><font color="#E5E5E5"> that security</font>

632
00:25:14,580 --> 00:25:20,340
on your your goldmine email extension

633
00:25:18,390 --> 00:25:22,950
filters we see a lot of ransomware come

634
00:25:20,340 --> 00:25:24,870
in<font color="#E5E5E5"> via email</font><font color="#CCCCCC"> so what we recommend is to</font>

635
00:25:22,950 --> 00:25:27,330
block attachments with both common and

636
00:25:24,870 --> 00:25:30,239
uncommon extensions<font color="#E5E5E5"> on your basic list</font>

637
00:25:27,330 --> 00:25:31,260
<font color="#E5E5E5">is zip</font><font color="#CCCCCC"> JSA XE because nobody</font><font color="#E5E5E5"> should be</font>

638
00:25:30,240 --> 00:25:33,210
getting those through email

639
00:25:31,260 --> 00:25:35,580
if you're feeling saucy you can block

640
00:25:33,210 --> 00:25:37,770
all the<font color="#E5E5E5"> office stuff but that's probably</font>

641
00:25:35,580 --> 00:25:39,510
<font color="#E5E5E5">not going to go</font><font color="#CCCCCC"> over real well</font><font color="#E5E5E5"> in a</font>

642
00:25:37,770 --> 00:25:41,670
perfect<font color="#E5E5E5"> world you would use a secure</font>

643
00:25:39,510 --> 00:25:43,230
transfer solution so where nobody<font color="#E5E5E5"> gets</font>

644
00:25:41,670 --> 00:25:45,300
attachments you just go to a portal and

645
00:25:43,230 --> 00:25:47,220
download them<font color="#CCCCCC"> and your ransomware</font><font color="#E5E5E5"> and</font>

646
00:25:45,300 --> 00:25:49,500
malware campaigns use email attachments

647
00:25:47,220 --> 00:25:53,070
because<font color="#CCCCCC"> it works so they wouldn't use it</font>

648
00:25:49,500 --> 00:25:54,150
<font color="#E5E5E5">if people didn't click on it we'll talk</font>

649
00:25:53,070 --> 00:25:56,129
a little<font color="#E5E5E5"> bit about security</font><font color="#CCCCCC"> awareness</font>

650
00:25:54,150 --> 00:25:58,350
training<font color="#CCCCCC"> you want to train people</font><font color="#E5E5E5"> to</font>

651
00:25:56,130 --> 00:25:59,910
know if something<font color="#CCCCCC"> looks suspicious it's</font>

652
00:25:58,350 --> 00:26:01,649
a learning<font color="#E5E5E5"> experience not</font><font color="#CCCCCC"> a shaming</font>

653
00:25:59,910 --> 00:26:03,480
experience please don't have the wall of

654
00:26:01,650 --> 00:26:05,910
sheep<font color="#E5E5E5"> for people that have clicked on</font>

655
00:26:03,480 --> 00:26:07,710
<font color="#CCCCCC">the phishing email and</font><font color="#E5E5E5"> even security</font>

656
00:26:05,910 --> 00:26:08,850
folks get compromised<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we usually</font>

657
00:26:07,710 --> 00:26:12,690
<font color="#E5E5E5">know what we're doing</font>

658
00:26:08,850 --> 00:26:14,100
but I can count<font color="#E5E5E5"> on more than one hand</font>

659
00:26:12,690 --> 00:26:16,290
the number of<font color="#CCCCCC"> people</font><font color="#E5E5E5"> on my</font><font color="#CCCCCC"> team</font><font color="#E5E5E5"> that</font>

660
00:26:14,100 --> 00:26:19,740
have been<font color="#E5E5E5"> caught up in fishing awareness</font>

661
00:26:16,290 --> 00:26:22,050
so just remember<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> end of the day</font>

662
00:26:19,740 --> 00:26:23,420
<font color="#CCCCCC">good security hygiene</font><font color="#E5E5E5"> starts with the</font>

663
00:26:22,050 --> 00:26:25,620
basics

664
00:26:23,420 --> 00:26:27,930
so what you<font color="#E5E5E5"> really want to do is is</font>

665
00:26:25,620 --> 00:26:31,080
cover as much as you can with what you

666
00:26:27,930 --> 00:26:34,680
have and if you want to reach<font color="#E5E5E5"> out to me</font>

667
00:26:31,080 --> 00:26:36,480
<font color="#E5E5E5">my</font><font color="#CCCCCC"> email</font><font color="#E5E5E5"> is up there and my</font><font color="#CCCCCC"> Twitter</font><font color="#E5E5E5"> is</font>

668
00:26:34,680 --> 00:26:38,670
up there I'm<font color="#E5E5E5"> not very funny so if you</font>

669
00:26:36,480 --> 00:26:42,120
<font color="#E5E5E5">follow people on Twitter for them to be</font>

670
00:26:38,670 --> 00:26:43,500
funny<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> not me</font><font color="#CCCCCC"> I am a managing</font>

671
00:26:42,120 --> 00:26:45,270
<font color="#E5E5E5">consultant with Optive Enterprise</font>

672
00:26:43,500 --> 00:26:53,610
incident management stuff<font color="#E5E5E5"> and I</font>

673
00:26:45,270 --> 00:27:10,410
appreciate<font color="#E5E5E5"> your time today does anybody</font>

674
00:26:53,610 --> 00:27:14,240
have<font color="#E5E5E5"> any questions yes sir yeah so that</font>

675
00:27:10,410 --> 00:27:18,000
was back on<font color="#CCCCCC"> the email extension filters</font>

676
00:27:14,240 --> 00:27:19,170
yes so the question<font color="#CCCCCC"> is do you have</font><font color="#E5E5E5"> a</font>

677
00:27:18,000 --> 00:27:26,670
specific<font color="#E5E5E5"> question you</font><font color="#CCCCCC"> just want to</font><font color="#E5E5E5"> talk</font>

678
00:27:19,170 --> 00:27:28,620
<font color="#E5E5E5">about that a little bit</font><font color="#CCCCCC"> ok so just as a</font>

679
00:27:26,670 --> 00:27:31,080
<font color="#CCCCCC">as an</font><font color="#E5E5E5"> example at Optive we</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> proof</font>

680
00:27:28,620 --> 00:27:33,689
<font color="#E5E5E5">point and again not endorsing this this</font>

681
00:27:31,080 --> 00:27:35,370
is simply what we<font color="#E5E5E5"> use internally when we</font>

682
00:27:33,690 --> 00:27:37,080
get attachments<font color="#CCCCCC"> that can come in through</font>

683
00:27:35,370 --> 00:27:38,729
<font color="#CCCCCC">Proofpoint it's automatically virus</font>

684
00:27:37,080 --> 00:27:40,470
scanned it's automatically scanned for

685
00:27:38,730 --> 00:27:42,210
exploits things like that<font color="#E5E5E5"> then we have</font>

686
00:27:40,470 --> 00:27:44,460
<font color="#E5E5E5">to physically</font><font color="#CCCCCC"> go and download that and</font>

687
00:27:42,210 --> 00:27:45,990
then run it rather than<font color="#E5E5E5"> it</font><font color="#CCCCCC"> just being</font>

688
00:27:44,460 --> 00:27:48,030
something<font color="#E5E5E5"> where it comes in on an email</font>

689
00:27:45,990 --> 00:27:51,480
and you can<font color="#E5E5E5"> just click on it</font><font color="#CCCCCC"> because as</font>

690
00:27:48,030 --> 00:27:52,740
we saw earlier<font color="#CCCCCC"> I believe last</font><font color="#E5E5E5"> year there</font>

691
00:27:51,480 --> 00:27:54,300
were exploits in<font color="#E5E5E5"> the wild where you</font>

692
00:27:52,740 --> 00:27:55,860
didn't even<font color="#E5E5E5"> have to click</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> something</font>

693
00:27:54,300 --> 00:27:58,830
in a document<font color="#E5E5E5"> you literally just</font><font color="#CCCCCC"> mouse</font>

694
00:27:55,860 --> 00:28:00,719
<font color="#E5E5E5">over it</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> can go out and trigger</font>

695
00:27:58,830 --> 00:28:02,610
a malware download so having<font color="#CCCCCC"> it come in</font>

696
00:28:00,720 --> 00:28:06,390
through a portal<font color="#E5E5E5"> it gives you that extra</font>

697
00:28:02,610 --> 00:28:10,669
<font color="#E5E5E5">layer</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> defense so things are scanned</font>

698
00:28:06,390 --> 00:28:10,670
prior to them ever seeing the<font color="#CCCCCC"> end</font><font color="#E5E5E5"> user</font>

699
00:28:13,430 --> 00:28:17,700
mobile ransomware<font color="#E5E5E5"> that's a fun one</font><font color="#CCCCCC"> I was</font>

700
00:28:16,260 --> 00:28:19,110
waiting<font color="#CCCCCC"> for</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> question I was waiting</font>

701
00:28:17,700 --> 00:28:21,000
<font color="#CCCCCC">for the question of have you guys seen</font>

702
00:28:19,110 --> 00:28:24,360
ransomware that likes to sleep before<font color="#CCCCCC"> it</font>

703
00:28:21,000 --> 00:28:27,210
<font color="#CCCCCC">encrypts</font><font color="#E5E5E5"> so mobile ransomware is is</font>

704
00:28:24,360 --> 00:28:29,520
<font color="#CCCCCC">interesting we tend</font><font color="#E5E5E5"> to see it not as</font>

705
00:28:27,210 --> 00:28:31,920
much as your standard<font color="#E5E5E5"> when</font>

706
00:28:29,520 --> 00:28:33,270
<font color="#CCCCCC">those</font><font color="#E5E5E5"> ransomware because you know when</font>

707
00:28:31,920 --> 00:28:35,070
you're dealing<font color="#E5E5E5"> with mobile</font><font color="#CCCCCC"> devices it's</font>

708
00:28:33,270 --> 00:28:37,650
<font color="#E5E5E5">it's they're less pervasive than then</font>

709
00:28:35,070 --> 00:28:39,659
<font color="#CCCCCC">windows in an office environment there</font>

710
00:28:37,650 --> 00:28:42,060
is some mobile ransomware out there we

711
00:28:39,660 --> 00:28:44,550
don't<font color="#E5E5E5"> often do much with</font><font color="#CCCCCC"> it so I</font>

712
00:28:42,060 --> 00:28:46,560
couldn't really speak to<font color="#CCCCCC"> that but it's</font>

713
00:28:44,550 --> 00:28:48,899
not as predominant<font color="#E5E5E5"> as some of the other</font>

714
00:28:46,560 --> 00:28:50,129
<font color="#E5E5E5">ransomware strains so sorry it's</font>

715
00:28:48,900 --> 00:28:52,620
probably not<font color="#E5E5E5"> the</font><font color="#CCCCCC"> answer you</font><font color="#E5E5E5"> were</font><font color="#CCCCCC"> looking</font>

716
00:28:50,130 --> 00:28:54,630
for<font color="#E5E5E5"> but yeah it's it's not as</font>

717
00:28:52,620 --> 00:28:56,370
predominant and you know to speak to the

718
00:28:54,630 --> 00:28:58,320
ransomware that sleeps before<font color="#E5E5E5"> it</font><font color="#CCCCCC"> infects</font>

719
00:28:56,370 --> 00:29:02,280
systems<font color="#E5E5E5"> it's out there but we don't see</font>

720
00:28:58,320 --> 00:29:05,850
<font color="#E5E5E5">it as</font><font color="#CCCCCC"> much again</font><font color="#E5E5E5"> that gives the bad guys</font>

721
00:29:02,280 --> 00:29:07,980
<font color="#CCCCCC">more time</font><font color="#E5E5E5"> to get caught</font><font color="#CCCCCC"> when you do</font>

722
00:29:05,850 --> 00:29:10,620
<font color="#E5E5E5">something</font><font color="#CCCCCC"> like that</font><font color="#E5E5E5"> because as soon as</font>

723
00:29:07,980 --> 00:29:12,390
some of that<font color="#E5E5E5"> stuff hits the</font><font color="#CCCCCC"> the web</font><font color="#E5E5E5"> it's</font>

724
00:29:10,620 --> 00:29:14,659
already<font color="#CCCCCC"> being</font><font color="#E5E5E5"> uploaded by researchers</font>

725
00:29:12,390 --> 00:29:17,160
being torn apart things<font color="#E5E5E5"> like that so</font>

726
00:29:14,660 --> 00:29:18,330
yeah it's<font color="#E5E5E5"> not as predominant as some of</font>

727
00:29:17,160 --> 00:29:22,530
the strains that<font color="#E5E5E5"> I talked about here</font><font color="#CCCCCC"> but</font>

728
00:29:18,330 --> 00:29:27,439
it is out there<font color="#CCCCCC"> yeah yep any other</font>

729
00:29:22,530 --> 00:29:27,440
questions<font color="#CCCCCC"> thank you</font><font color="#E5E5E5"> very much</font>

730
00:29:31,200 --> 00:29:35,190
[Applause]

