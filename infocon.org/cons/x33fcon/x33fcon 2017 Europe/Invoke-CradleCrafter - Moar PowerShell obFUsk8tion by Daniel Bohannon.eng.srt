1
00:00:01,150 --> 00:00:04,330
[Applause]

2
00:00:11,990 --> 00:00:16,500
thank you very<font color="#E5E5E5"> much</font><font color="#CCCCCC"> so yeah my name</font><font color="#E5E5E5"> is</font>

3
00:00:15,240 --> 00:00:18,869
Daniel Bohannon and<font color="#E5E5E5"> today we're going to</font>

4
00:00:16,500 --> 00:00:21,300
<font color="#E5E5E5">look for the first</font><font color="#CCCCCC"> time in public</font><font color="#E5E5E5"> at a</font>

5
00:00:18,869 --> 00:00:23,609
new tool that<font color="#CCCCCC"> I'd released</font><font color="#E5E5E5"> about 20</font>

6
00:00:21,300 --> 00:00:26,099
<font color="#E5E5E5">minutes ago called invoke cradle crafter</font>

7
00:00:23,609 --> 00:00:27,240
so just a<font color="#CCCCCC"> little bit about me</font><font color="#E5E5E5"> I am</font><font color="#CCCCCC"> an</font>

8
00:00:26,099 --> 00:00:29,039
incident response consultant with

9
00:00:27,240 --> 00:00:30,919
mandiant<font color="#E5E5E5"> based out</font><font color="#CCCCCC"> of the Washington DC</font>

10
00:00:29,039 --> 00:00:32,189
<font color="#CCCCCC">area been</font><font color="#E5E5E5"> there for</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> two years</font>

11
00:00:30,920 --> 00:00:33,420
<font color="#E5E5E5">prior to that</font>

12
00:00:32,189 --> 00:00:35,460
<font color="#CCCCCC">then about</font><font color="#E5E5E5"> five</font><font color="#CCCCCC"> years doing IT</font>

13
00:00:33,420 --> 00:00:38,129
operations and security<font color="#CCCCCC"> for a</font><font color="#E5E5E5"> restaurant</font>

14
00:00:35,460 --> 00:00:40,379
franchise<font color="#CCCCCC"> in the US</font><font color="#E5E5E5"> and my day-to-day</font>

15
00:00:38,129 --> 00:00:42,599
<font color="#CCCCCC">role pretty much looks like Incident</font>

16
00:00:40,379 --> 00:00:45,089
Response as well as I'm threatening kind

17
00:00:42,600 --> 00:00:47,219
of detection<font color="#CCCCCC"> evasion obfuscation</font>

18
00:00:45,090 --> 00:00:50,370
techniques and research<font color="#CCCCCC"> in actually</font>

19
00:00:47,219 --> 00:00:52,320
<font color="#E5E5E5">applying that in the real world</font><font color="#CCCCCC"> so in</font>

20
00:00:50,370 --> 00:00:55,260
<font color="#CCCCCC">January I was speaking at a conference</font>

21
00:00:52,320 --> 00:00:56,610
in<font color="#E5E5E5"> this</font><font color="#CCCCCC"> gentleman tweeted Daniel</font>

22
00:00:55,260 --> 00:00:59,789
Bohannon true American always<font color="#E5E5E5"> has</font><font color="#CCCCCC"> look</font>

23
00:00:56,610 --> 00:01:01,649
<font color="#CCCCCC">at the presentation</font><font color="#E5E5E5"> so I figured maybe I</font>

24
00:00:59,789 --> 00:01:03,180
didn't Rob<font color="#E5E5E5"> got such a strong stereotypes</font>

25
00:01:01,649 --> 00:01:05,129
of given all the presentations today it

26
00:01:03,180 --> 00:01:07,590
definitely is<font color="#E5E5E5"> so I figured I</font><font color="#CCCCCC"> would</font>

27
00:01:05,129 --> 00:01:11,100
counter with<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I'm a nice little</font>

28
00:01:07,590 --> 00:01:12,450
American mean but but<font color="#E5E5E5"> to be fair the</font>

29
00:01:11,100 --> 00:01:14,490
best one in probably<font color="#CCCCCC"> the more accurate</font>

30
00:01:12,450 --> 00:01:17,100
one is this a nice<font color="#E5E5E5"> oversized cat with</font>

31
00:01:14,490 --> 00:01:18,780
Starbucks<font color="#CCCCCC"> so so sorry Ilya I had to get</font>

32
00:01:17,100 --> 00:01:20,759
I had to get one<font color="#E5E5E5"> cat name in there by</font>

33
00:01:18,780 --> 00:01:23,310
promise that's all so what we're going

34
00:01:20,759 --> 00:01:25,170
to<font color="#CCCCCC"> look at today first I'm going</font><font color="#E5E5E5"> to just</font>

35
00:01:23,310 --> 00:01:27,030
<font color="#E5E5E5">briefly talk</font><font color="#CCCCCC"> about my motivation of why</font>

36
00:01:25,170 --> 00:01:29,070
<font color="#E5E5E5">am</font><font color="#CCCCCC"> I still researching</font><font color="#E5E5E5"> office</font><font color="#CCCCCC"> keishon</font>

37
00:01:27,030 --> 00:01:30,840
haven't I caused us defenders enough

38
00:01:29,070 --> 00:01:32,339
trouble with that<font color="#E5E5E5"> and they were going</font><font color="#CCCCCC"> to</font>

39
00:01:30,840 --> 00:01:34,650
<font color="#CCCCCC">look at the current</font><font color="#E5E5E5"> state</font><font color="#CCCCCC"> of PowerShell</font>

40
00:01:32,340 --> 00:01:36,689
<font color="#CCCCCC">occupations as well as the</font><font color="#E5E5E5"> current state</font>

41
00:01:34,650 --> 00:01:38,369
<font color="#E5E5E5">of detection of detecting this</font>

42
00:01:36,689 --> 00:01:40,470
<font color="#CCCCCC">occupation and then we're gonna look at</font>

43
00:01:38,369 --> 00:01:41,970
the new stuff<font color="#E5E5E5"> looking at really cryptic</font>

44
00:01:40,470 --> 00:01:43,950
cradles from three different

45
00:01:41,970 --> 00:01:46,280
perspectives<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the syntax</font><font color="#CCCCCC"> a kind</font><font color="#E5E5E5"> of</font>

46
00:01:43,950 --> 00:01:48,360
cradle<font color="#E5E5E5"> genre perspective as well</font><font color="#CCCCCC"> as</font>

47
00:01:46,280 --> 00:01:50,820
obfuscation that we can apply the token

48
00:01:48,360 --> 00:01:52,799
layer that's not<font color="#E5E5E5"> in invoke obfuscation</font>

49
00:01:50,820 --> 00:01:55,559
<font color="#CCCCCC">and then looking at a myriad of</font>

50
00:01:52,799 --> 00:01:56,850
different invocation<font color="#E5E5E5"> syntaxes that as</font>

51
00:01:55,560 --> 00:01:59,460
defenders we should be<font color="#E5E5E5"> aware of and be</font>

52
00:01:56,850 --> 00:02:02,610
looking for<font color="#E5E5E5"> they look at detecting these</font>

53
00:01:59,460 --> 00:02:05,880
cryptic cradles<font color="#CCCCCC"> for our best efforts at</font>

54
00:02:02,610 --> 00:02:08,878
starting to do that as well as<font color="#E5E5E5"> finally a</font>

55
00:02:05,880 --> 00:02:11,400
live demo<font color="#CCCCCC"> and</font><font color="#E5E5E5"> hopefully back as well</font>

56
00:02:08,878 --> 00:02:12,420
a few disclaimers and<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> these this</font>

57
00:02:11,400 --> 00:02:13,410
comes from<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of questions I've</font>

58
00:02:12,420 --> 00:02:15,839
<font color="#CCCCCC">gotten in</font>

59
00:02:13,410 --> 00:02:18,090
<font color="#CCCCCC">pass when</font><font color="#E5E5E5"> I talk about this or this sort</font>

60
00:02:15,840 --> 00:02:20,190
<font color="#E5E5E5">of material</font><font color="#CCCCCC"> first of all rocking</font>

61
00:02:18,090 --> 00:02:21,810
<font color="#CCCCCC">powershell is not a</font><font color="#E5E5E5"> realistic option</font><font color="#CCCCCC"> I</font>

62
00:02:20,190 --> 00:02:25,109
mean one short sentence that's because

63
00:02:21,810 --> 00:02:28,080
<font color="#CCCCCC">powershell exe</font><font color="#E5E5E5"> is not</font><font color="#CCCCCC"> powershell</font><font color="#E5E5E5"> and a</font>

64
00:02:25,110 --> 00:02:29,670
great<font color="#E5E5E5"> really simple</font><font color="#CCCCCC"> way it's</font><font color="#E5E5E5"> completely</font>

65
00:02:28,080 --> 00:02:31,080
different<font color="#E5E5E5"> to think about</font><font color="#CCCCCC"> is if your</font>

66
00:02:29,670 --> 00:02:33,179
attacker<font color="#CCCCCC"> renames</font><font color="#E5E5E5"> powershell</font>

67
00:02:31,080 --> 00:02:34,800
actually how good is<font color="#CCCCCC"> that you're trying</font>

68
00:02:33,180 --> 00:02:35,880
<font color="#CCCCCC">to only brought powershell that</font><font color="#E5E5E5"> XD so</font>

69
00:02:34,800 --> 00:02:37,830
you can<font color="#E5E5E5"> obviously go</font><font color="#CCCCCC"> deeper look at</font>

70
00:02:35,880 --> 00:02:39,390
internal<font color="#E5E5E5"> file name but it's not a great</font>

71
00:02:37,830 --> 00:02:40,320
<font color="#CCCCCC">option and there's a lot</font><font color="#E5E5E5"> more good that</font>

72
00:02:39,390 --> 00:02:41,820
you can do with PowerShell

73
00:02:40,320 --> 00:02:44,070
especially if you're<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> latest</font>

74
00:02:41,820 --> 00:02:46,769
<font color="#E5E5E5">version of PowerShell this leads to the</font>

75
00:02:44,070 --> 00:02:49,470
second<font color="#CCCCCC"> point which is</font><font color="#E5E5E5"> a quote from noted</font>

76
00:02:46,770 --> 00:02:51,060
<font color="#CCCCCC">blue team or jarred hate and that is how</font>

77
00:02:49,470 --> 00:02:53,100
our show is<font color="#E5E5E5"> not special and what he</font>

78
00:02:51,060 --> 00:02:54,270
<font color="#E5E5E5">means by that is that there's a lot of</font>

79
00:02:53,100 --> 00:02:55,980
<font color="#CCCCCC">reports to talk about the increase in</font>

80
00:02:54,270 --> 00:02:59,220
malicious uses a PowerShell

81
00:02:55,980 --> 00:03:01,590
<font color="#E5E5E5">but almost all those are in cases where</font>

82
00:02:59,220 --> 00:03:03,870
the attacker already has code execution

83
00:03:01,590 --> 00:03:05,610
on the<font color="#E5E5E5"> system so if your user opens a</font>

84
00:03:03,870 --> 00:03:07,710
macro<font color="#CCCCCC"> or</font><font color="#E5E5E5"> opens a document and it was a</font>

85
00:03:05,610 --> 00:03:09,240
macro<font color="#E5E5E5"> and PowerShell happens to be used</font>

86
00:03:07,710 --> 00:03:10,230
to<font color="#CCCCCC"> download</font><font color="#E5E5E5"> a binary that's not a</font>

87
00:03:09,240 --> 00:03:12,030
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> problem</font>

88
00:03:10,230 --> 00:03:13,679
that's a user<font color="#E5E5E5"> opening a freaking macro</font>

89
00:03:12,030 --> 00:03:15,720
problem<font color="#E5E5E5"> PowerShell does happen</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font>

90
00:03:13,680 --> 00:03:16,050
their tool of choice to download the

91
00:03:15,720 --> 00:03:18,720
file

92
00:03:16,050 --> 00:03:19,530
and lastly<font color="#CCCCCC"> powershell frog dodo is your</font>

93
00:03:18,720 --> 00:03:21,420
new best friend

94
00:03:19,530 --> 00:03:24,000
<font color="#CCCCCC">and i say new it's been</font><font color="#E5E5E5"> around since</font>

95
00:03:21,420 --> 00:03:25,500
2014<font color="#CCCCCC"> these are two really</font><font color="#E5E5E5"> good blog</font>

96
00:03:24,000 --> 00:03:27,600
<font color="#CCCCCC">posts looking at the</font><font color="#E5E5E5"> first one</font>

97
00:03:25,500 --> 00:03:29,910
specifically logging around<font color="#CCCCCC"> PowerShell</font>

98
00:03:27,600 --> 00:03:32,250
<font color="#CCCCCC">five and the second one is by Microsoft</font>

99
00:03:29,910 --> 00:03:36,510
<font color="#E5E5E5">a really good blog</font><font color="#CCCCCC"> post and white paper</font>

100
00:03:32,250 --> 00:03:39,810
<font color="#CCCCCC">on</font><font color="#E5E5E5"> all the benefits of PowerShell</font><font color="#CCCCCC"> 5 so</font>

101
00:03:36,510 --> 00:03:41,040
my motivation<font color="#E5E5E5"> attackers are off you</font>

102
00:03:39,810 --> 00:03:42,990
skating<font color="#E5E5E5"> and they have been for a</font><font color="#CCCCCC"> while</font>

103
00:03:41,040 --> 00:03:44,220
<font color="#E5E5E5">and for some</font><font color="#CCCCCC"> reason in the past six</font>

104
00:03:42,990 --> 00:03:46,890
months<font color="#E5E5E5"> they've been doing it a lot more</font>

105
00:03:44,220 --> 00:03:48,390
<font color="#E5E5E5">I don't</font><font color="#CCCCCC"> know why</font><font color="#E5E5E5"> and it you know power</font>

106
00:03:46,890 --> 00:03:51,690
shell is such a great<font color="#CCCCCC"> platform for</font><font color="#E5E5E5"> them</font>

107
00:03:48,390 --> 00:03:54,929
<font color="#CCCCCC">because it's you know it's native on all</font>

108
00:03:51,690 --> 00:03:57,750
modern Windows operating system<font color="#E5E5E5"> signs at</font>

109
00:03:54,930 --> 00:03:59,190
windows binary<font color="#E5E5E5"> and typically it's white</font>

110
00:03:57,750 --> 00:04:02,190
listed if a polite listening isn't<font color="#CCCCCC"> in</font>

111
00:03:59,190 --> 00:04:04,020
the environment<font color="#E5E5E5"> so once is L</font><font color="#CCCCCC"> codon about</font>

112
00:04:02,190 --> 00:04:05,040
<font color="#CCCCCC">gloomy</font><font color="#E5E5E5"> cat came to be the security</font>

113
00:04:04,020 --> 00:04:07,490
community<font color="#E5E5E5"> really started to take notice</font>

114
00:04:05,040 --> 00:04:09,900
<font color="#E5E5E5">and we start to see a proliferation of</font>

115
00:04:07,490 --> 00:04:12,990
offensive<font color="#E5E5E5"> powershell frameworks as well</font>

116
00:04:09,900 --> 00:04:14,970
as<font color="#E5E5E5"> defensive as well and</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> really it</font>

117
00:04:12,990 --> 00:04:16,590
for<font color="#E5E5E5"> all practical reasons impossible to</font>

118
00:04:14,970 --> 00:04:18,420
<font color="#E5E5E5">detect this kind of usage of powershell</font>

119
00:04:16,589 --> 00:04:20,279
if you don't add a very minimum have

120
00:04:18,420 --> 00:04:23,220
<font color="#E5E5E5">command line logging or command line</font>

121
00:04:20,279 --> 00:04:26,010
auditing but really what you want to get

122
00:04:23,220 --> 00:04:27,990
to is having<font color="#E5E5E5"> the script lock module and</font>

123
00:04:26,010 --> 00:04:31,349
and logs that<font color="#CCCCCC"> PowerShell 5 makes</font>

124
00:04:27,990 --> 00:04:32,970
<font color="#CCCCCC">available so what's my obsession with</font>

125
00:04:31,350 --> 00:04:34,230
<font color="#E5E5E5">obvious case why do I keep doing</font><font color="#CCCCCC"> it one</font>

126
00:04:32,970 --> 00:04:36,780
<font color="#E5E5E5">of my colleagues said what's your</font>

127
00:04:34,230 --> 00:04:39,240
sickness<font color="#E5E5E5"> like why don't</font><font color="#CCCCCC"> you just you</font>

128
00:04:36,780 --> 00:04:41,429
know be okay<font color="#E5E5E5"> with where</font><font color="#CCCCCC"> that and this is</font>

129
00:04:39,240 --> 00:04:43,050
because this is really<font color="#CCCCCC"> taking</font><font color="#E5E5E5"> the whole</font>

130
00:04:41,430 --> 00:04:45,270
realm of obfuscation and looking

131
00:04:43,050 --> 00:04:46,860
directly at one of the main things that

132
00:04:45,270 --> 00:04:50,130
hackers like to do which is download and

133
00:04:46,860 --> 00:04:53,220
execute remote code with PowerShell<font color="#CCCCCC"> and</font>

134
00:04:50,130 --> 00:04:54,960
so with this this<font color="#E5E5E5"> really started by</font>

135
00:04:53,220 --> 00:04:57,330
<font color="#E5E5E5">looking and documenting obscure</font><font color="#CCCCCC"> cradle</font>

136
00:04:54,960 --> 00:04:58,530
<font color="#CCCCCC">syntaxes</font><font color="#E5E5E5"> that we see</font><font color="#CCCCCC"> change it enough</font>

137
00:04:57,330 --> 00:04:59,880
commodity mail are using some of the

138
00:04:58,530 --> 00:05:02,099
more<font color="#E5E5E5"> interesting ones and then</font>

139
00:04:59,880 --> 00:05:04,800
enumerated that and finding cradles I

140
00:05:02,100 --> 00:05:07,860
have yet to see<font color="#E5E5E5"> the be used in the wild</font>

141
00:05:04,800 --> 00:05:09,930
<font color="#E5E5E5">and cataloging that and I put all this</font>

142
00:05:07,860 --> 00:05:11,430
into<font color="#CCCCCC"> this tool to kind</font><font color="#E5E5E5"> of make it like a</font>

143
00:05:09,930 --> 00:05:14,190
<font color="#E5E5E5">living library because to be honest I</font>

144
00:05:11,430 --> 00:05:15,540
<font color="#E5E5E5">got tired of copying and pasting out of</font>

145
00:05:14,190 --> 00:05:16,950
my notes and having<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know having</font>

146
00:05:15,540 --> 00:05:18,570
syntax errors and having to replace

147
00:05:16,950 --> 00:05:21,870
stuff so a tool is<font color="#CCCCCC"> effin Utley the</font>

148
00:05:18,570 --> 00:05:23,310
easiest<font color="#CCCCCC"> ways to keep that in check so</font>

149
00:05:21,870 --> 00:05:24,030
the current state<font color="#CCCCCC"> of</font><font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> offi</font>

150
00:05:23,310 --> 00:05:26,130
<font color="#E5E5E5">station</font>

151
00:05:24,030 --> 00:05:27,710
what are we at today<font color="#CCCCCC"> well this</font><font color="#E5E5E5"> is always</font>

152
00:05:26,130 --> 00:05:31,440
in my<font color="#CCCCCC"> life for</font><font color="#E5E5E5"> the past year and a half</font>

153
00:05:27,710 --> 00:05:32,430
<font color="#CCCCCC">again as a defender</font><font color="#E5E5E5"> I I get really</font>

154
00:05:31,440 --> 00:05:34,680
excited<font color="#CCCCCC"> when I</font><font color="#E5E5E5"> find interesting</font>

155
00:05:32,430 --> 00:05:36,780
PowerShell<font color="#CCCCCC"> artifacts</font><font color="#E5E5E5"> and in my</font>

156
00:05:34,680 --> 00:05:39,090
<font color="#CCCCCC">day-to-day what</font><font color="#E5E5E5"> I've</font><font color="#CCCCCC"> been</font><font color="#E5E5E5"> doing</font><font color="#CCCCCC"> for the</font>

157
00:05:36,780 --> 00:05:40,729
past<font color="#E5E5E5"> year and a half has</font><font color="#CCCCCC"> been working</font><font color="#E5E5E5"> on</font>

158
00:05:39,090 --> 00:05:43,679
<font color="#E5E5E5">host base and network based detection</font>

159
00:05:40,730 --> 00:05:46,310
for<font color="#E5E5E5"> mainly for PowerShell</font><font color="#CCCCCC"> but other</font>

160
00:05:43,680 --> 00:05:49,260
stuff is<font color="#E5E5E5"> wrong it wasn't until I got to</font>

161
00:05:46,310 --> 00:05:51,090
to be able<font color="#E5E5E5"> to play with</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> tool called</font>

162
00:05:49,260 --> 00:05:52,920
hip which is<font color="#E5E5E5"> a</font><font color="#CCCCCC"> real time agent that we</font>

163
00:05:51,090 --> 00:05:54,419
use in<font color="#E5E5E5"> investigations on the stands</font><font color="#CCCCCC"> for</font>

164
00:05:52,920 --> 00:05:56,070
<font color="#E5E5E5">hosts of</font><font color="#CCCCCC"> that investigative platform</font>

165
00:05:54,420 --> 00:05:57,240
once I started to do this I was<font color="#CCCCCC"> able to</font>

166
00:05:56,070 --> 00:05:59,340
see<font color="#E5E5E5"> the results really really quickly</font>

167
00:05:57,240 --> 00:06:00,960
<font color="#E5E5E5">and</font><font color="#CCCCCC"> I basically started to</font><font color="#E5E5E5"> come up with</font>

168
00:05:59,340 --> 00:06:03,630
obscure<font color="#CCCCCC"> syntaxes to</font><font color="#E5E5E5"> get around our</font>

169
00:06:00,960 --> 00:06:04,890
<font color="#CCCCCC">trigger logic and I would go</font><font color="#E5E5E5"> to the</font>

170
00:06:03,630 --> 00:06:07,230
<font color="#CCCCCC">donor and say hey can we update this</font>

171
00:06:04,890 --> 00:06:08,849
coming update this<font color="#E5E5E5"> and day</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> day</font>

172
00:06:07,230 --> 00:06:10,020
week<font color="#E5E5E5"> after week it got to the point</font>

173
00:06:08,850 --> 00:06:11,970
where he said why<font color="#E5E5E5"> don't I give you</font>

174
00:06:10,020 --> 00:06:14,190
<font color="#CCCCCC">access and you can come up with the</font>

175
00:06:11,970 --> 00:06:16,310
weird<font color="#E5E5E5"> some taxes and the the detection</font>

176
00:06:14,190 --> 00:06:18,540
<font color="#E5E5E5">for it and so</font><font color="#CCCCCC"> that kind of turned into a</font>

177
00:06:16,310 --> 00:06:21,690
somewhat unofficial role<font color="#CCCCCC"> and that's what</font>

178
00:06:18,540 --> 00:06:23,640
I've<font color="#CCCCCC"> been</font><font color="#E5E5E5"> doing ever since and it's been</font>

179
00:06:21,690 --> 00:06:25,680
a lot<font color="#CCCCCC"> of fun</font><font color="#E5E5E5"> and so last year</font><font color="#CCCCCC"> at Derby</font>

180
00:06:23,640 --> 00:06:27,539
con<font color="#E5E5E5"> I released this tool called invoke</font>

181
00:06:25,680 --> 00:06:30,420
<font color="#CCCCCC">coffee station</font><font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> a culmination</font><font color="#E5E5E5"> of</font>

182
00:06:27,540 --> 00:06:33,360
this research<font color="#E5E5E5"> to automate the</font><font color="#CCCCCC"> occupation</font>

183
00:06:30,420 --> 00:06:35,250
<font color="#CCCCCC">of PowerShell commands and script and it</font>

184
00:06:33,360 --> 00:06:37,710
<font color="#E5E5E5">does have four different layers and so</font>

185
00:06:35,250 --> 00:06:39,270
if you haven't<font color="#E5E5E5"> seen this tool or</font>

186
00:06:37,710 --> 00:06:40,530
<font color="#CCCCCC">Arsene the previous talk I'm going to go</font>

187
00:06:39,270 --> 00:06:42,599
through at a really high<font color="#CCCCCC"> level to show</font>

188
00:06:40,530 --> 00:06:43,979
<font color="#CCCCCC">you this with this kind of</font><font color="#E5E5E5"> occupation</font><font color="#CCCCCC"> so</font>

189
00:06:42,600 --> 00:06:46,230
that we can see how invoke<font color="#CCCCCC"> Cradle</font>

190
00:06:43,980 --> 00:06:48,930
crafter in today's<font color="#CCCCCC"> cost</font><font color="#E5E5E5"> is a bit</font>

191
00:06:46,230 --> 00:06:50,580
different<font color="#CCCCCC"> so the first layer on</font><font color="#E5E5E5"> tokens</font>

192
00:06:48,930 --> 00:06:52,740
<font color="#E5E5E5">so basically I</font><font color="#CCCCCC"> went through this example</font>

193
00:06:50,580 --> 00:06:54,570
this is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most common remote download</font>

194
00:06:52,740 --> 00:06:56,280
cradle and<font color="#E5E5E5"> if that's our attacker</font>

195
00:06:54,570 --> 00:06:57,690
command at the top<font color="#E5E5E5"> then as a defender on</font>

196
00:06:56,280 --> 00:06:59,340
<font color="#CCCCCC">the bottom if we look for</font><font color="#E5E5E5"> those four</font>

197
00:06:57,690 --> 00:07:00,870
strings<font color="#E5E5E5"> then</font><font color="#CCCCCC"> we'll catch that</font><font color="#E5E5E5"> command</font>

198
00:06:59,340 --> 00:07:03,060
<font color="#CCCCCC">but basically we're going</font><font color="#E5E5E5"> to walk</font>

199
00:07:00,870 --> 00:07:04,860
<font color="#E5E5E5">through and see if we start off you</font>

200
00:07:03,060 --> 00:07:06,510
skate<font color="#E5E5E5"> and we can actually bypass that</font>

201
00:07:04,860 --> 00:07:08,700
detection<font color="#E5E5E5"> sort and obfuscate the command</font>

202
00:07:06,510 --> 00:07:10,710
and update our<font color="#E5E5E5"> detection so for example</font>

203
00:07:08,700 --> 00:07:12,659
we<font color="#E5E5E5"> all need system dot we can remove</font>

204
00:07:10,710 --> 00:07:14,219
that<font color="#E5E5E5"> anytime you see a string we can</font>

205
00:07:12,660 --> 00:07:17,460
concatenate it<font color="#CCCCCC"> with these double quotes</font>

206
00:07:14,220 --> 00:07:18,750
<font color="#E5E5E5">single quotes right space</font><font color="#CCCCCC"> etc when it</font>

207
00:07:17,460 --> 00:07:20,190
comes to<font color="#E5E5E5"> methods now how much string is</font>

208
00:07:18,750 --> 00:07:22,140
the most common<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it's memory only</font>

209
00:07:20,190 --> 00:07:24,270
<font color="#E5E5E5">and it's a string an expression however</font>

210
00:07:22,140 --> 00:07:26,340
<font color="#CCCCCC">is a</font><font color="#E5E5E5"> method of the net dot web client</font>

211
00:07:24,270 --> 00:07:27,930
class<font color="#CCCCCC"> and there are a</font><font color="#E5E5E5"> ton of methods and</font>

212
00:07:26,340 --> 00:07:31,739
<font color="#CCCCCC">I want you to look at</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> so</font>

213
00:07:27,930 --> 00:07:33,480
download string download data open<font color="#CCCCCC"> reads</font>

214
00:07:31,740 --> 00:07:36,290
which<font color="#E5E5E5"> is the one that</font><font color="#CCCCCC"> you've only</font><font color="#E5E5E5"> seen</font>

215
00:07:33,480 --> 00:07:40,200
once or twice and<font color="#CCCCCC"> then download file</font>

216
00:07:36,290 --> 00:07:42,210
<font color="#E5E5E5">these are for that in</font><font color="#CCCCCC"> investigation</font><font color="#E5E5E5"> it</font>

217
00:07:40,200 --> 00:07:43,830
will never substitute<font color="#E5E5E5"> one method for</font>

218
00:07:42,210 --> 00:07:45,719
<font color="#E5E5E5">another because it's actually changing</font>

219
00:07:43,830 --> 00:07:48,150
the result if<font color="#E5E5E5"> you go from top to</font><font color="#CCCCCC"> bottom</font>

220
00:07:45,720 --> 00:07:50,640
you<font color="#CCCCCC"> have it returning</font><font color="#E5E5E5"> an expression</font><font color="#CCCCCC"> a</font>

221
00:07:48,150 --> 00:07:51,929
file to disk<font color="#CCCCCC"> a byte array or a byte</font>

222
00:07:50,640 --> 00:07:53,550
stream and so there's additional

223
00:07:51,930 --> 00:07:55,230
wrappers you need around<font color="#CCCCCC"> that command to</font>

224
00:07:53,550 --> 00:07:57,420
convert it back to an<font color="#E5E5E5"> expression to</font>

225
00:07:55,230 --> 00:07:59,550
invoke it so in both appreciation<font color="#E5E5E5"> will</font>

226
00:07:57,420 --> 00:08:01,910
never do this but<font color="#CCCCCC"> invoke Cradle crafter</font>

227
00:07:59,550 --> 00:08:04,290
can and that's<font color="#E5E5E5"> the whole point</font>

228
00:08:01,910 --> 00:08:06,180
additionally so invoke copy station will

229
00:08:04,290 --> 00:08:07,920
say<font color="#CCCCCC"> ok if we have a method we can put</font>

230
00:08:06,180 --> 00:08:09,300
single quotes around it<font color="#E5E5E5"> we can put</font>

231
00:08:07,920 --> 00:08:10,950
double<font color="#CCCCCC"> quotes around it and</font><font color="#E5E5E5"> once we do</font>

232
00:08:09,300 --> 00:08:13,200
that we can<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> put a tick mark</font><font color="#CCCCCC"> or</font>

233
00:08:10,950 --> 00:08:14,820
like a lot<font color="#E5E5E5"> of tick marks and then after</font>

234
00:08:13,200 --> 00:08:16,050
that we<font color="#E5E5E5"> can look at arguments do this do</font>

235
00:08:14,820 --> 00:08:16,980
a lot<font color="#E5E5E5"> of different stuff as well so</font>

236
00:08:16,050 --> 00:08:19,220
we'll<font color="#E5E5E5"> just</font><font color="#CCCCCC"> use tick marks in</font><font color="#E5E5E5"> this</font>

237
00:08:16,980 --> 00:08:21,150
example when it comes<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Commandments</font>

238
00:08:19,220 --> 00:08:22,740
these are three options<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> in</font>

239
00:08:21,150 --> 00:08:24,630
<font color="#E5E5E5">invoke</font><font color="#CCCCCC"> coffee station we see a</font>

240
00:08:22,740 --> 00:08:26,880
commandment never matter what it is<font color="#E5E5E5"> we</font>

241
00:08:24,630 --> 00:08:28,200
can add tick marks we can concatenate<font color="#E5E5E5"> it</font>

242
00:08:26,880 --> 00:08:30,150
as a string<font color="#E5E5E5"> and then invoke it with a</font>

243
00:08:28,200 --> 00:08:31,560
dot or<font color="#E5E5E5"> an ampersand</font><font color="#CCCCCC"> or we can reorder it</font>

244
00:08:30,150 --> 00:08:33,360
<font color="#E5E5E5">basically any string manipulation and</font>

245
00:08:31,560 --> 00:08:36,360
then invoke it with a dot or<font color="#CCCCCC"> ampersand</font>

246
00:08:33,360 --> 00:08:38,100
<font color="#CCCCCC">what an invoke</font><font color="#E5E5E5"> cradle crafter we can be</font>

247
00:08:36,360 --> 00:08:39,720
more creative<font color="#CCCCCC"> and the reason this is an</font>

248
00:08:38,100 --> 00:08:40,950
<font color="#E5E5E5">in in both coffee station as if there</font>

249
00:08:39,720 --> 00:08:43,580
<font color="#E5E5E5">are some fringe cases</font><font color="#CCCCCC"> on which</font><font color="#E5E5E5"> it</font>

250
00:08:40,950 --> 00:08:45,810
actually doesn't<font color="#E5E5E5"> work as expected and so</font>

251
00:08:43,580 --> 00:08:46,610
since we're<font color="#CCCCCC"> dealing with more tightly</font>

252
00:08:45,810 --> 00:08:49,469
constrained

253
00:08:46,610 --> 00:08:51,209
<font color="#CCCCCC">syntax</font><font color="#E5E5E5"> in invoke cradle</font><font color="#CCCCCC"> crafters we can</font>

254
00:08:49,470 --> 00:08:52,529
use different<font color="#E5E5E5"> option</font><font color="#CCCCCC"> stations so</font>

255
00:08:51,209 --> 00:08:54,569
<font color="#E5E5E5">I've chosen to</font><font color="#CCCCCC"> implement this kind of</font>

256
00:08:52,529 --> 00:08:56,279
<font color="#E5E5E5">occupations so we can use the expand or</font>

257
00:08:54,569 --> 00:08:57,868
this one bio syntax for<font color="#CCCCCC"> gate command</font><font color="#E5E5E5"> and</font>

258
00:08:56,279 --> 00:08:59,699
actually use<font color="#CCCCCC"> wildcard so</font><font color="#E5E5E5"> instead</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> a</font>

259
00:08:57,869 --> 00:09:02,279
new<font color="#CCCCCC"> object that wildcard happens to</font>

260
00:08:59,699 --> 00:09:05,670
return<font color="#CCCCCC"> in instead</font><font color="#E5E5E5"> of get command we can</font>

261
00:09:02,279 --> 00:09:07,679
<font color="#CCCCCC">use an alias or</font><font color="#E5E5E5"> yeah an alias of GCM and</font>

262
00:09:05,670 --> 00:09:09,509
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> calling execution context of</font>

263
00:09:07,679 --> 00:09:13,619
the variable we can<font color="#CCCCCC"> use</font><font color="#E5E5E5"> wildcards on the</font>

264
00:09:09,509 --> 00:09:15,389
get variable alias that way<font color="#E5E5E5"> um and so at</font>

265
00:09:13,619 --> 00:09:17,970
this point we're left with in both

266
00:09:15,389 --> 00:09:19,379
expression<font color="#E5E5E5"> and when it comes to invoke</font>

267
00:09:17,970 --> 00:09:22,050
<font color="#E5E5E5">opting station we pretty much this dealt</font>

268
00:09:19,379 --> 00:09:23,939
with<font color="#E5E5E5"> it ie X</font><font color="#CCCCCC"> on above expression or a</font>

269
00:09:22,050 --> 00:09:26,160
little bit different stuff like<font color="#E5E5E5"> this</font>

270
00:09:23,939 --> 00:09:27,569
using automatic variables or environment

271
00:09:26,160 --> 00:09:29,639
variables and<font color="#E5E5E5"> pulling out</font><font color="#CCCCCC"> the letters I</font>

272
00:09:27,569 --> 00:09:32,339
and<font color="#CCCCCC"> II and X and</font><font color="#E5E5E5"> then invoking that</font><font color="#CCCCCC"> um</font>

273
00:09:29,639 --> 00:09:35,939
so in in the<font color="#E5E5E5"> last two releases of</font><font color="#CCCCCC"> invoke</font>

274
00:09:32,339 --> 00:09:38,429
coffee station<font color="#E5E5E5"> I added a set of ie X and</font>

275
00:09:35,939 --> 00:09:40,199
taxes like this and we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to see</font>

276
00:09:38,429 --> 00:09:43,649
there's<font color="#E5E5E5"> quite a bit</font><font color="#CCCCCC"> more in in book</font>

277
00:09:40,199 --> 00:09:45,660
cradled after<font color="#E5E5E5"> I</font><font color="#CCCCCC"> lied there's actually</font>

278
00:09:43,649 --> 00:09:47,699
another cat picture in there<font color="#CCCCCC"> all right</font>

279
00:09:45,660 --> 00:09:49,618
<font color="#CCCCCC">two strikes</font><font color="#E5E5E5"> three ml off to sit down so</font>

280
00:09:47,699 --> 00:09:51,449
I hope<font color="#CCCCCC"> that's the only one</font>

281
00:09:49,619 --> 00:09:53,490
so that was token level<font color="#CCCCCC"> occupation the</font>

282
00:09:51,449 --> 00:09:54,959
first of the four categories<font color="#CCCCCC"> second we</font>

283
00:09:53,490 --> 00:09:57,119
<font color="#E5E5E5">have string level</font><font color="#CCCCCC"> this is really</font><font color="#E5E5E5"> simple</font>

284
00:09:54,959 --> 00:09:58,439
<font color="#E5E5E5">basically take your</font><font color="#CCCCCC"> entire command</font><font color="#E5E5E5"> treat</font>

285
00:09:57,119 --> 00:10:00,299
<font color="#CCCCCC">it as a string</font><font color="#E5E5E5"> and then do any string</font>

286
00:09:58,439 --> 00:10:01,769
manipulation<font color="#E5E5E5"> and then just invoke it</font>

287
00:10:00,299 --> 00:10:04,949
with invoke expression or whatever else

288
00:10:01,769 --> 00:10:07,350
you'd like<font color="#E5E5E5"> third we have encoding so the</font>

289
00:10:04,949 --> 00:10:09,569
current the<font color="#CCCCCC"> current public</font><font color="#E5E5E5"> version of</font>

290
00:10:07,350 --> 00:10:11,160
invoke obfuscation had<font color="#E5E5E5"> v6 ASCII</font>

291
00:10:09,569 --> 00:10:12,569
hexadecimal octal<font color="#E5E5E5"> all the way down to</font>

292
00:10:11,160 --> 00:10:15,240
secure string which technically

293
00:10:12,569 --> 00:10:16,920
encryption and<font color="#E5E5E5"> bitwise</font><font color="#CCCCCC"> XOR</font><font color="#E5E5E5"> and the</font>

294
00:10:15,240 --> 00:10:19,069
fourth<font color="#E5E5E5"> category is</font><font color="#CCCCCC"> Abu skated launchers</font>

295
00:10:16,920 --> 00:10:21,299
and so with this we<font color="#E5E5E5"> can do things like</font>

296
00:10:19,069 --> 00:10:24,240
<font color="#E5E5E5">echoing the</font><font color="#CCCCCC"> PowerShell command</font><font color="#E5E5E5"> into</font>

297
00:10:21,299 --> 00:10:25,860
<font color="#E5E5E5">PowerShell - a PowerShell</font><font color="#CCCCCC"> ie X input</font><font color="#E5E5E5"> and</font>

298
00:10:24,240 --> 00:10:27,839
what this allows you<font color="#E5E5E5"> to do is push code</font>

299
00:10:25,860 --> 00:10:29,189
<font color="#CCCCCC">PowerShell standard input</font><font color="#E5E5E5"> and so you can</font>

300
00:10:27,839 --> 00:10:30,540
see these are<font color="#E5E5E5"> system</font><font color="#CCCCCC"> own logs so power</font>

301
00:10:29,189 --> 00:10:33,839
<font color="#CCCCCC">shelf arguments doesn't actually contain</font>

302
00:10:30,540 --> 00:10:36,629
the<font color="#E5E5E5"> command but its parent does now you</font>

303
00:10:33,839 --> 00:10:38,549
can pick<font color="#CCCCCC"> up</font><font color="#E5E5E5"> some step further and set</font>

304
00:10:36,629 --> 00:10:40,829
your PowerShell command<font color="#CCCCCC"> into environment</font>

305
00:10:38,549 --> 00:10:43,350
variable<font color="#E5E5E5"> one an inset</font><font color="#CCCCCC"> PowerShell - an</font>

306
00:10:40,829 --> 00:10:46,019
environment variable<font color="#E5E5E5"> - and then echo var</font>

307
00:10:43,350 --> 00:10:48,540
one<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Davar - we've actually seen been</font>

308
00:10:46,019 --> 00:10:50,730
<font color="#CCCCCC">eight you do this as recently as this</font>

309
00:10:48,540 --> 00:10:53,610
February<font color="#CCCCCC"> and this is what it looks like</font>

310
00:10:50,730 --> 00:10:55,139
<font color="#E5E5E5">in the event logs so the arguments</font><font color="#CCCCCC"> of</font>

311
00:10:53,610 --> 00:10:56,279
the actual command cons are actually

312
00:10:55,139 --> 00:10:59,480
pushed all the<font color="#E5E5E5"> way up to the grandparent</font>

313
00:10:56,279 --> 00:11:01,589
process and there's an<font color="#E5E5E5"> interesting post</font>

314
00:10:59,480 --> 00:11:02,790
<font color="#E5E5E5">John Lambert from Microsoft if you're</font>

315
00:11:01,589 --> 00:11:03,870
not<font color="#E5E5E5"> following him you definitely</font><font color="#CCCCCC"> should</font>

316
00:11:02,790 --> 00:11:04,800
<font color="#E5E5E5">he tweets a lot of really</font><font color="#CCCCCC"> interesting</font>

317
00:11:03,870 --> 00:11:05,819
things

318
00:11:04,800 --> 00:11:07,889
evil<font color="#E5E5E5"> things that he's finding in the</font>

319
00:11:05,819 --> 00:11:11,160
wild and he<font color="#E5E5E5"> posted this doc</font><font color="#CCCCCC"> had some</font>

320
00:11:07,889 --> 00:11:12,869
interesting occupation going on in<font color="#CCCCCC"> knit</font>

321
00:11:11,160 --> 00:11:14,009
<font color="#E5E5E5">car a colleague of mine tweet and said</font>

322
00:11:12,869 --> 00:11:16,290
hey we've actually seen<font color="#CCCCCC"> been ain't doing</font>

323
00:11:14,009 --> 00:11:18,239
this<font color="#E5E5E5"> here's the decoder that I push to</font>

324
00:11:16,290 --> 00:11:20,759
github<font color="#E5E5E5"> to decode this and then another</font>

325
00:11:18,239 --> 00:11:21,899
<font color="#E5E5E5">colleague of mine</font><font color="#CCCCCC"> Ian all said yet</font><font color="#E5E5E5"> this</font>

326
00:11:20,759 --> 00:11:23,339
lines up really<font color="#CCCCCC"> well with some sample</font>

327
00:11:21,899 --> 00:11:26,100
that we've been seeing<font color="#E5E5E5"> so you see the</font>

328
00:11:23,339 --> 00:11:28,769
<font color="#CCCCCC">springshot</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> phonate is setting this</font>

329
00:11:26,100 --> 00:11:29,910
command<font color="#E5E5E5"> in the very bottom variable the</font>

330
00:11:28,769 --> 00:11:31,769
very bottom is setting it in variable

331
00:11:29,910 --> 00:11:33,360
<font color="#E5E5E5">one and variable</font><font color="#CCCCCC"> two they're setting</font>

332
00:11:31,769 --> 00:11:34,860
this<font color="#CCCCCC"> powershell - and then what you</font>

333
00:11:33,360 --> 00:11:37,679
actually<font color="#E5E5E5"> see</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the command line is</font>

334
00:11:34,860 --> 00:11:38,239
command<font color="#E5E5E5"> F of r1 devar - that looks</font>

335
00:11:37,679 --> 00:11:41,279
familiar

336
00:11:38,239 --> 00:11:42,420
so in the first<font color="#E5E5E5"> phase of invoke off you</font>

337
00:11:41,279 --> 00:11:44,249
station this<font color="#CCCCCC"> is how I did it but</font><font color="#E5E5E5"> I</font>

338
00:11:42,420 --> 00:11:45,748
<font color="#E5E5E5">actually took it one</font><font color="#CCCCCC"> step further</font><font color="#E5E5E5"> in</font>

339
00:11:44,249 --> 00:11:48,329
later releases<font color="#CCCCCC"> and basically</font><font color="#E5E5E5"> created</font>

340
00:11:45,749 --> 00:11:50,129
environment variable 3 which<font color="#CCCCCC"> is the</font>

341
00:11:48,329 --> 00:11:52,410
content<font color="#E5E5E5"> it is whether is a command echo</font>

342
00:11:50,129 --> 00:11:54,899
<font color="#E5E5E5">var</font><font color="#CCCCCC"> 1 pipe bar 2 and so now all you see</font>

343
00:11:52,410 --> 00:11:57,600
<font color="#CCCCCC">invoke confiscation is command slash C</font>

344
00:11:54,899 --> 00:11:58,829
bar 3<font color="#E5E5E5"> that's it</font><font color="#CCCCCC"> and so these are</font><font color="#E5E5E5"> the</font>

345
00:11:57,600 --> 00:12:00,269
current options again in the public

346
00:11:58,829 --> 00:12:02,069
<font color="#CCCCCC">verse of</font><font color="#E5E5E5"> invoke confiscation here's the</font>

347
00:12:00,269 --> 00:12:04,920
latest<font color="#E5E5E5"> on that's there and that standard</font>

348
00:12:02,069 --> 00:12:09,118
<font color="#CCCCCC">n + + is the example that we just looked</font>

349
00:12:04,920 --> 00:12:11,069
at so<font color="#CCCCCC"> let that's that's that's some of</font>

350
00:12:09,119 --> 00:12:13,319
<font color="#E5E5E5">the recent stuff in an obfuscation that</font>

351
00:12:11,069 --> 00:12:17,069
we've seen attackers using so where's

352
00:12:13,319 --> 00:12:18,839
the<font color="#CCCCCC"> Texan</font><font color="#E5E5E5"> look like for this well as</font>

353
00:12:17,069 --> 00:12:21,329
hopefully<font color="#CCCCCC"> there's examples</font><font color="#E5E5E5"> out there</font>

354
00:12:18,839 --> 00:12:22,679
<font color="#E5E5E5">where</font><font color="#CCCCCC"> AV is catching</font><font color="#E5E5E5"> some of these</font>

355
00:12:21,329 --> 00:12:25,079
scripts that are obfuscated at the token

356
00:12:22,679 --> 00:12:27,779
layer<font color="#CCCCCC"> I still</font><font color="#E5E5E5"> get to</font><font color="#CCCCCC"> see it but again</font>

357
00:12:25,079 --> 00:12:29,189
<font color="#CCCCCC">hopefully that they're catching up</font><font color="#E5E5E5"> and</font>

358
00:12:27,779 --> 00:12:31,410
one<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> to keep in mind is the</font>

359
00:12:29,189 --> 00:12:33,118
obfuscation does not affect heuristic so

360
00:12:31,410 --> 00:12:35,850
if you're looking<font color="#CCCCCC"> at</font><font color="#E5E5E5"> PowerShell</font>

361
00:12:33,119 --> 00:12:37,559
<font color="#E5E5E5">accessing</font><font color="#CCCCCC"> lsat memory space for invoke</font>

362
00:12:35,850 --> 00:12:38,579
mimikatz<font color="#E5E5E5"> obfuscation is not going to</font>

363
00:12:37,559 --> 00:12:41,969
help you there it's they're going to

364
00:12:38,579 --> 00:12:44,099
perform<font color="#CCCCCC"> that action</font><font color="#E5E5E5"> but it will it will</font>

365
00:12:41,970 --> 00:12:45,329
likely get around<font color="#E5E5E5"> detection of the</font>

366
00:12:44,100 --> 00:12:47,449
script itself<font color="#CCCCCC"> unless you're doing</font><font color="#E5E5E5"> some</font>

367
00:12:45,329 --> 00:12:49,349
<font color="#CCCCCC">interesting stuff that we'll talk</font><font color="#E5E5E5"> about</font>

368
00:12:47,449 --> 00:12:51,199
<font color="#E5E5E5">it's really need to see some of our</font>

369
00:12:49,350 --> 00:12:53,339
technically competitors in the industry

370
00:12:51,199 --> 00:12:55,589
<font color="#E5E5E5">updating their command line detection</font>

371
00:12:53,339 --> 00:12:57,540
<font color="#E5E5E5">for some of this obfuscation</font><font color="#CCCCCC"> that's been</font>

372
00:12:55,589 --> 00:12:59,999
<font color="#E5E5E5">really exciting</font><font color="#CCCCCC"> to see a lots changed</font>

373
00:12:57,540 --> 00:13:02,129
<font color="#E5E5E5">since the</font><font color="#CCCCCC"> initial</font><font color="#E5E5E5"> release of</font><font color="#CCCCCC"> info</font>

374
00:12:59,999 --> 00:13:04,319
<font color="#E5E5E5">confiscation so I hope</font><font color="#CCCCCC"> that they've been</font>

375
00:13:02,129 --> 00:13:06,319
<font color="#CCCCCC">keeping up but overall</font><font color="#E5E5E5"> that's that's my</font>

376
00:13:04,319 --> 00:13:08,639
goal is<font color="#E5E5E5"> is that we all</font><font color="#CCCCCC"> as a community</font>

377
00:13:06,319 --> 00:13:11,790
<font color="#E5E5E5">across</font><font color="#CCCCCC"> all industries will get better</font><font color="#E5E5E5"> at</font>

378
00:13:08,639 --> 00:13:14,429
detecting<font color="#E5E5E5"> this kind of activity</font><font color="#CCCCCC"> and it's</font>

379
00:13:11,790 --> 00:13:16,290
been<font color="#CCCCCC"> running</font><font color="#E5E5E5"> to Capt 32 which the</font>

380
00:13:14,429 --> 00:13:18,630
Vietnamese attacker also known as<font color="#E5E5E5"> ocean</font>

381
00:13:16,290 --> 00:13:20,640
Lotus<font color="#E5E5E5"> I'm using</font><font color="#CCCCCC"> invoke confiscations</font>

382
00:13:18,630 --> 00:13:22,800
<font color="#CCCCCC">I think</font><font color="#E5E5E5"> their inner command is stuck</font>

383
00:13:20,640 --> 00:13:24,540
<font color="#E5E5E5">convey they guess to a lot of layers</font>

384
00:13:22,800 --> 00:13:27,060
<font color="#E5E5E5">I've spent a bit of time in the past</font>

385
00:13:24,540 --> 00:13:29,010
couple weeks<font color="#CCCCCC"> Deonte skating and kind of</font>

386
00:13:27,060 --> 00:13:30,150
<font color="#E5E5E5">a kind of hating hating life for a</font>

387
00:13:29,010 --> 00:13:31,580
little<font color="#CCCCCC"> bit but it's been really</font>

388
00:13:30,150 --> 00:13:33,810
interesting<font color="#E5E5E5"> to</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> how they're</font><font color="#CCCCCC"> using it</font>

389
00:13:31,580 --> 00:13:35,310
so some<font color="#E5E5E5"> some interesting things if</font>

390
00:13:33,810 --> 00:13:37,619
you're<font color="#CCCCCC"> not aware of these that I think</font>

391
00:13:35,310 --> 00:13:39,449
are going to<font color="#E5E5E5"> be beneficial in</font><font color="#CCCCCC"> in</font>

392
00:13:37,620 --> 00:13:42,330
detecting this kind of stuff one is a

393
00:13:39,450 --> 00:13:43,920
<font color="#CCCCCC">MSI the anti-malware scan interface and</font>

394
00:13:42,330 --> 00:13:48,090
this allows registered<font color="#E5E5E5"> AV vendors to</font>

395
00:13:43,920 --> 00:13:50,699
access mostly<font color="#CCCCCC"> deoxy skated content a lot</font>

396
00:13:48,090 --> 00:13:52,890
<font color="#E5E5E5">more than just power shell from vbscript</font>

397
00:13:50,700 --> 00:13:54,270
and<font color="#E5E5E5"> several others</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> ultimately solar</font>

398
00:13:52,890 --> 00:13:56,370
lives on<font color="#CCCCCC"> the ad vendor having a</font>

399
00:13:54,270 --> 00:13:58,470
signature that<font color="#E5E5E5"> will detect on that</font>

400
00:13:56,370 --> 00:14:00,840
content and today still really<font color="#E5E5E5"> not</font>

401
00:13:58,470 --> 00:14:03,000
seeing it being flagged on<font color="#E5E5E5"> on any of</font>

402
00:14:00,840 --> 00:14:05,370
this and<font color="#E5E5E5"> hopefully that will change</font><font color="#CCCCCC"> very</font>

403
00:14:03,000 --> 00:14:06,810
soon<font color="#CCCCCC"> the other one is from</font><font color="#E5E5E5"> Lee homes and</font>

404
00:14:05,370 --> 00:14:09,210
he<font color="#E5E5E5"> is actually on the PowerShell team at</font>

405
00:14:06,810 --> 00:14:11,219
Microsoft<font color="#E5E5E5"> and now is currently a lead</font>

406
00:14:09,210 --> 00:14:13,140
security architect for the<font color="#CCCCCC"> Azure team</font>

407
00:14:11,220 --> 00:14:14,940
<font color="#E5E5E5">and he has this great great blog post</font>

408
00:14:13,140 --> 00:14:17,730
<font color="#CCCCCC">I'm actually</font><font color="#E5E5E5"> looking at invoke</font><font color="#CCCCCC"> off</font>

409
00:14:14,940 --> 00:14:19,530
<font color="#CCCCCC">instigation output and and he created</font>

410
00:14:17,730 --> 00:14:21,510
<font color="#E5E5E5">these two functions as long as github</font>

411
00:14:19,530 --> 00:14:23,220
<font color="#E5E5E5">frequency analysis and vector similarity</font>

412
00:14:21,510 --> 00:14:24,720
really really cool stuff<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> has</font>

413
00:14:23,220 --> 00:14:26,100
<font color="#E5E5E5">been the concept I get really excited</font>

414
00:14:24,720 --> 00:14:29,510
<font color="#CCCCCC">about</font><font color="#E5E5E5"> and have been doing some</font><font color="#CCCCCC"> research</font>

415
00:14:26,100 --> 00:14:33,090
on the<font color="#E5E5E5"> side to look more into that</font>

416
00:14:29,510 --> 00:14:34,890
<font color="#CCCCCC">alright for the new stuff more crafting</font>

417
00:14:33,090 --> 00:14:36,780
<font color="#CCCCCC">diptych cradles</font><font color="#E5E5E5"> you know I know what</font>

418
00:14:34,890 --> 00:14:38,520
this<font color="#E5E5E5"> next slide is</font><font color="#CCCCCC"> and it's another cat</font>

419
00:14:36,780 --> 00:14:40,290
<font color="#E5E5E5">but this one is really the last one I</font>

420
00:14:38,520 --> 00:14:42,270
promise<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> last one</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I had</font>

421
00:14:40,290 --> 00:14:44,099
to put this in<font color="#CCCCCC"> here because</font><font color="#E5E5E5"> more</font>

422
00:14:42,270 --> 00:14:46,590
obviously<font color="#E5E5E5"> using a different spelling</font>

423
00:14:44,100 --> 00:14:48,870
<font color="#CCCCCC">than then</font><font color="#E5E5E5"> within the dictionary but it</font>

424
00:14:46,590 --> 00:14:51,210
comes from<font color="#E5E5E5"> more prefer or more very</font>

425
00:14:48,870 --> 00:14:53,160
loudly I suppose so these are the three

426
00:14:51,210 --> 00:14:54,780
categories<font color="#E5E5E5"> of new stuff they're going to</font>

427
00:14:53,160 --> 00:14:56,430
talk about today<font color="#E5E5E5"> when it comes to</font>

428
00:14:54,780 --> 00:14:59,280
cryptic cradles<font color="#E5E5E5"> the first category is</font>

429
00:14:56,430 --> 00:15:00,959
<font color="#CCCCCC">just obscure</font><font color="#E5E5E5"> syntaxes no</font><font color="#CCCCCC"> office</font><font color="#E5E5E5"> station</font>

430
00:14:59,280 --> 00:15:02,880
whatsoever so<font color="#E5E5E5"> Matt graver actually</font>

431
00:15:00,960 --> 00:15:05,310
tweeted<font color="#E5E5E5"> this last week this is actually</font>

432
00:15:02,880 --> 00:15:07,230
a download cradle<font color="#CCCCCC"> IWR an alias for</font>

433
00:15:05,310 --> 00:15:08,310
<font color="#E5E5E5">invoke web</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> it was introduced in</font>

434
00:15:07,230 --> 00:15:09,810
PowerShell<font color="#CCCCCC"> three</font><font color="#E5E5E5"> years later so</font><font color="#CCCCCC"> you</font>

435
00:15:08,310 --> 00:15:11,790
don't see<font color="#E5E5E5"> it</font><font color="#CCCCCC"> that much because</font><font color="#E5E5E5"> typically</font>

436
00:15:09,810 --> 00:15:13,199
you know red teamers and attackers like

437
00:15:11,790 --> 00:15:15,000
<font color="#E5E5E5">their stuff to work on PowerShell</font><font color="#CCCCCC"> 2 or</font>

438
00:15:13,200 --> 00:15:17,610
later<font color="#E5E5E5"> but it</font><font color="#CCCCCC"> totally works so look at</font>

439
00:15:15,000 --> 00:15:19,260
<font color="#E5E5E5">this and a lot a lot of other ones don't</font>

440
00:15:17,610 --> 00:15:20,670
<font color="#E5E5E5">look at obscure token off you station</font>

441
00:15:19,260 --> 00:15:21,689
and again completely<font color="#E5E5E5"> different office</font>

442
00:15:20,670 --> 00:15:23,490
station than what you see in in both

443
00:15:21,690 --> 00:15:25,590
<font color="#E5E5E5">authentication</font><font color="#CCCCCC"> but allow us to</font><font color="#E5E5E5"> take the</font>

444
00:15:23,490 --> 00:15:27,300
command<font color="#E5E5E5"> like this and transform it</font><font color="#CCCCCC"> into</font>

445
00:15:25,590 --> 00:15:28,740
something<font color="#CCCCCC"> like this</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> really</font>

446
00:15:27,300 --> 00:15:30,089
interesting means of enumerated

447
00:15:28,740 --> 00:15:31,300
commandlets methods numbers and

448
00:15:30,089 --> 00:15:33,949
properties

449
00:15:31,300 --> 00:15:35,359
then we'll work at some obscure

450
00:15:33,949 --> 00:15:37,430
<font color="#E5E5E5">invocation syntax is looking at some</font>

451
00:15:35,360 --> 00:15:42,800
house r1 syntax power<font color="#E5E5E5"> so</font><font color="#CCCCCC"> three syntax</font>

452
00:15:37,430 --> 00:15:44,000
and several others so breaking<font color="#E5E5E5"> it down</font>

453
00:15:42,800 --> 00:15:45,319
into<font color="#CCCCCC"> two categories and</font><font color="#E5E5E5"> this is how the</font>

454
00:15:44,000 --> 00:15:48,110
tool does it as<font color="#E5E5E5"> well this</font><font color="#CCCCCC"> space in</font>

455
00:15:45,320 --> 00:15:49,399
<font color="#CCCCCC">everydays</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> space grande loves this</font>

456
00:15:48,110 --> 00:15:51,320
<font color="#CCCCCC">place stuff because they're downloading</font>

457
00:15:49,399 --> 00:15:53,720
you know and<font color="#E5E5E5"> actually to run but</font><font color="#CCCCCC"> i think</font>

458
00:15:51,320 --> 00:15:55,040
<font color="#E5E5E5">this space is</font><font color="#CCCCCC"> actually really overlooked</font>

459
00:15:53,720 --> 00:15:56,870
and it's<font color="#E5E5E5"> as if</font><font color="#CCCCCC"> it had some</font><font color="#E5E5E5"> interesting</font>

460
00:15:55,040 --> 00:15:58,579
<font color="#E5E5E5">potential that a lot of people aren't</font>

461
00:15:56,870 --> 00:15:59,930
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> one would be what if you</font>

462
00:15:58,579 --> 00:16:01,579
just<font color="#E5E5E5"> always download your</font><font color="#CCCCCC"> payload to the</font>

463
00:15:59,930 --> 00:16:03,319
profile script and then just ran

464
00:16:01,579 --> 00:16:04,790
powershell now everything in<font color="#E5E5E5"> that script</font>

465
00:16:03,320 --> 00:16:06,589
<font color="#E5E5E5">gets run nothing on the command line</font>

466
00:16:04,790 --> 00:16:07,550
<font color="#E5E5E5">pretty interesting interesting stuff</font>

467
00:16:06,589 --> 00:16:09,800
obviously it's all going to<font color="#E5E5E5"> be in</font>

468
00:16:07,550 --> 00:16:12,229
<font color="#CCCCCC">powershell</font><font color="#E5E5E5"> event laws but sadly</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> who</font>

469
00:16:09,800 --> 00:16:13,609
don't have powershell<font color="#CCCCCC"> 5 or even 3 for</font>

470
00:16:12,230 --> 00:16:16,459
that<font color="#CCCCCC"> matter</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> there's really not too</font>

471
00:16:13,610 --> 00:16:18,199
<font color="#CCCCCC">much not too much</font><font color="#E5E5E5"> to do there so</font>

472
00:16:16,459 --> 00:16:20,268
<font color="#E5E5E5">download file again this is the most</font>

473
00:16:18,199 --> 00:16:21,859
common one<font color="#CCCCCC"> that we see</font><font color="#E5E5E5"> commodity now are</font>

474
00:16:20,269 --> 00:16:24,110
<font color="#E5E5E5">using we do have to see a bit of monitor</font>

475
00:16:21,860 --> 00:16:26,149
using<font color="#CCCCCC"> bits</font><font color="#E5E5E5"> admin so good admin is</font>

476
00:16:24,110 --> 00:16:27,800
actually deprecated but you know still

477
00:16:26,149 --> 00:16:29,149
work<font color="#E5E5E5"> and start that transfers powershell</font>

478
00:16:27,800 --> 00:16:32,449
<font color="#CCCCCC">version now what's interesting about</font>

479
00:16:29,149 --> 00:16:34,250
<font color="#E5E5E5">these well they actually work with</font>

480
00:16:32,449 --> 00:16:35,269
<font color="#CCCCCC">constrained language mode so mat</font><font color="#E5E5E5"> great</font>

481
00:16:34,250 --> 00:16:36,680
<font color="#E5E5E5">bring taste expense have been doing a</font>

482
00:16:35,269 --> 00:16:38,810
<font color="#E5E5E5">lot of awesome talks on device guard</font>

483
00:16:36,680 --> 00:16:40,760
which can enforce<font color="#CCCCCC"> constrain language</font>

484
00:16:38,810 --> 00:16:41,930
mode<font color="#E5E5E5"> and so these will still work in</font>

485
00:16:40,760 --> 00:16:43,040
constrained language mode if you're on a

486
00:16:41,930 --> 00:16:44,630
system<font color="#E5E5E5"> that has that and need to</font>

487
00:16:43,040 --> 00:16:46,160
download some stuff one thing to keep in

488
00:16:44,630 --> 00:16:47,630
<font color="#CCCCCC">mind is that to file</font><font color="#E5E5E5"> that you're</font>

489
00:16:46,160 --> 00:16:50,719
downloading<font color="#E5E5E5"> if it does not return</font><font color="#CCCCCC"> a file</font>

490
00:16:47,630 --> 00:16:51,800
size<font color="#E5E5E5"> like if your files on paceman for</font>

491
00:16:50,720 --> 00:16:53,209
example it's<font color="#CCCCCC"> not in order</font><font color="#E5E5E5"> trying to file</font>

492
00:16:51,800 --> 00:16:55,519
size<font color="#CCCCCC"> you're pulling that</font><font color="#E5E5E5"> raw data</font><font color="#CCCCCC"> and</font>

493
00:16:53,209 --> 00:16:56,719
this needs that<font color="#E5E5E5"> to do it does the</font>

494
00:16:55,519 --> 00:16:58,579
background intelligent transfer service

495
00:16:56,720 --> 00:16:59,810
<font color="#E5E5E5">it needs that file size so you're going</font>

496
00:16:58,579 --> 00:17:01,459
<font color="#E5E5E5">to get an error</font><font color="#CCCCCC"> like this</font><font color="#E5E5E5"> so definitely</font>

497
00:16:59,810 --> 00:17:02,810
<font color="#E5E5E5">want to test your payload to make sure</font>

498
00:17:01,459 --> 00:17:04,309
is the server speaking the right

499
00:17:02,810 --> 00:17:07,149
<font color="#CCCCCC">language so that</font><font color="#E5E5E5"> bits will work when it</font>

500
00:17:04,309 --> 00:17:09,678
downloads<font color="#E5E5E5"> it now the memory</font><font color="#CCCCCC"> base cradles</font>

501
00:17:07,150 --> 00:17:11,089
again<font color="#E5E5E5"> first one fan favorite this</font><font color="#CCCCCC"> is</font>

502
00:17:09,679 --> 00:17:11,839
what we see all the time<font color="#CCCCCC"> not</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

503
00:17:11,089 --> 00:17:13,639
<font color="#E5E5E5">spend any time there</font>

504
00:17:11,839 --> 00:17:14,899
<font color="#E5E5E5">downloads data and open read main</font>

505
00:17:13,640 --> 00:17:16,280
difference here<font color="#CCCCCC"> is that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> it</font>

506
00:17:14,900 --> 00:17:17,720
<font color="#E5E5E5">returning as a byte</font><font color="#CCCCCC"> array or a byte</font>

507
00:17:16,280 --> 00:17:19,189
stream so we have to do a little more

508
00:17:17,720 --> 00:17:21,770
work<font color="#CCCCCC"> around that command to get</font><font color="#E5E5E5"> it back</font>

509
00:17:19,189 --> 00:17:24,260
to an<font color="#E5E5E5"> expression before</font><font color="#CCCCCC"> we invoke it in</font>

510
00:17:21,770 --> 00:17:25,730
<font color="#CCCCCC">both web request and invoke rest</font><font color="#E5E5E5"> method</font>

511
00:17:24,260 --> 00:17:28,790
this<font color="#CCCCCC"> is what Graber tweeted the IWR</font>

512
00:17:25,730 --> 00:17:30,919
<font color="#E5E5E5">these are also both these will both work</font>

513
00:17:28,790 --> 00:17:32,750
<font color="#E5E5E5">on systems with constraint language mode</font>

514
00:17:30,919 --> 00:17:34,610
enabled but<font color="#E5E5E5"> things are introduced</font><font color="#CCCCCC"> and</font>

515
00:17:32,750 --> 00:17:35,710
<font color="#CCCCCC">powershell free or later so that's</font>

516
00:17:34,610 --> 00:17:37,699
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> you have to keep in mind</font>

517
00:17:35,710 --> 00:17:40,100
<font color="#E5E5E5">invoke up request awful have some nice</font>

518
00:17:37,700 --> 00:17:41,600
aliases<font color="#CCCCCC"> double you</font><font color="#E5E5E5"> get and curl I don't</font>

519
00:17:40,100 --> 00:17:44,149
have actually ever seen those being you

520
00:17:41,600 --> 00:17:45,469
but they<font color="#E5E5E5"> totally work this is actually</font>

521
00:17:44,150 --> 00:17:47,360
<font color="#E5E5E5">probably my favorite which is really</font>

522
00:17:45,470 --> 00:17:49,070
it's<font color="#CCCCCC"> really strange</font><font color="#E5E5E5"> it's it's not only</font>

523
00:17:47,360 --> 00:17:51,199
<font color="#CCCCCC">that</font><font color="#E5E5E5"> sexy but it has some nuances I</font>

524
00:17:49,070 --> 00:17:53,418
think<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> really cool so basically</font>

525
00:17:51,200 --> 00:17:55,640
<font color="#E5E5E5">calling the net HTTP web request class</font>

526
00:17:53,419 --> 00:17:58,220
<font color="#E5E5E5">directly</font><font color="#CCCCCC"> and you're able to do</font><font color="#E5E5E5"> this</font>

527
00:17:55,640 --> 00:18:00,890
<font color="#CCCCCC">without having</font><font color="#E5E5E5"> to say new object and in</font>

528
00:17:58,220 --> 00:18:04,039
the class name and you can<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> do</font>

529
00:18:00,890 --> 00:18:05,570
the same<font color="#E5E5E5"> thing as 1 2 & 3 oh that was</font>

530
00:18:04,039 --> 00:18:07,580
not the laser<font color="#CCCCCC"> you can do the same thing</font>

531
00:18:05,570 --> 00:18:10,580
with download<font color="#E5E5E5"> string download data and</font>

532
00:18:07,580 --> 00:18:14,178
download file and open read but it's

533
00:18:10,580 --> 00:18:17,210
only in PowerShell<font color="#E5E5E5"> 4 year later all</font>

534
00:18:14,179 --> 00:18:19,340
<font color="#E5E5E5">right so that's number six number seven</font>

535
00:18:17,210 --> 00:18:21,289
<font color="#E5E5E5">this one is strictly for the roles if</font>

536
00:18:19,340 --> 00:18:23,299
you have money on<font color="#E5E5E5"> getting a cradle to</font>

537
00:18:21,289 --> 00:18:26,000
<font color="#E5E5E5">work don't put it on this one all right</font>

538
00:18:23,299 --> 00:18:27,799
<font color="#CCCCCC">I considered not</font><font color="#E5E5E5"> putting it in the tool</font>

539
00:18:26,000 --> 00:18:30,710
but I<font color="#E5E5E5"> spent like over</font><font color="#CCCCCC"> 50 hours on it</font>

540
00:18:27,799 --> 00:18:32,480
trying<font color="#CCCCCC"> to get it to be</font><font color="#E5E5E5"> more reliable so</font>

541
00:18:30,710 --> 00:18:34,010
your results may vary<font color="#CCCCCC"> so this one is</font>

542
00:18:32,480 --> 00:18:35,960
technically unsupported in<font color="#E5E5E5"> the tool</font>

543
00:18:34,010 --> 00:18:37,400
please don't open<font color="#CCCCCC"> up</font><font color="#E5E5E5"> yet issues on this</font>

544
00:18:35,960 --> 00:18:39,140
one<font color="#E5E5E5"> but basically</font><font color="#CCCCCC"> if you have notepad</font>

545
00:18:37,400 --> 00:18:41,360
<font color="#CCCCCC">and go to open</font><font color="#E5E5E5"> instead of a file name</font>

546
00:18:39,140 --> 00:18:42,799
put in the<font color="#E5E5E5"> URL the notepad will</font><font color="#CCCCCC"> fetch</font>

547
00:18:41,360 --> 00:18:43,939
your<font color="#E5E5E5"> freaking payload for you which is</font>

548
00:18:42,799 --> 00:18:46,220
awesome<font color="#CCCCCC"> because now power shows up</font>

549
00:18:43,940 --> 00:18:48,679
making a network<font color="#E5E5E5"> connection so basically</font>

550
00:18:46,220 --> 00:18:50,000
this syntax<font color="#E5E5E5"> in this tool will automate</font>

551
00:18:48,679 --> 00:18:52,309
<font color="#E5E5E5">that will basically spawn notepad off</font>

552
00:18:50,000 --> 00:18:54,470
the screen you send<font color="#CCCCCC"> keys that to send</font>

553
00:18:52,309 --> 00:18:56,240
keystrokes to automate all<font color="#E5E5E5"> this control</font>

554
00:18:54,470 --> 00:18:58,429
a<font color="#E5E5E5"> control</font><font color="#CCCCCC"> key to select</font><font color="#E5E5E5"> all copy all and</font>

555
00:18:56,240 --> 00:19:02,030
then invoke the contents off the

556
00:18:58,429 --> 00:19:04,309
clipboard<font color="#CCCCCC"> in line scripting oh look at</font>

557
00:19:02,030 --> 00:19:05,750
<font color="#CCCCCC">comm object so this is basically</font>

558
00:19:04,309 --> 00:19:07,610
<font color="#E5E5E5">PowerShell interacting with other</font>

559
00:19:05,750 --> 00:19:09,559
applications through<font color="#E5E5E5"> comm to have them</font>

560
00:19:07,610 --> 00:19:11,539
go fetch the payloads<font color="#CCCCCC"> a lot quieter a</font>

561
00:19:09,559 --> 00:19:12,678
lot cleaner<font color="#E5E5E5"> then send keys and notepads</font>

562
00:19:11,539 --> 00:19:15,010
you don't have stuff<font color="#E5E5E5"> flying up in front</font>

563
00:19:12,679 --> 00:19:17,330
of<font color="#E5E5E5"> the user these are really</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> cool</font>

564
00:19:15,010 --> 00:19:18,799
I'm going<font color="#CCCCCC"> to last</font><font color="#E5E5E5"> two are</font><font color="#CCCCCC"> inline</font>

565
00:19:17,330 --> 00:19:20,389
scripting and<font color="#CCCCCC"> pre-compiled scripting so</font>

566
00:19:18,799 --> 00:19:22,129
basically<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> fit hosts several</font>

567
00:19:20,390 --> 00:19:25,669
<font color="#E5E5E5">other scripting languages C sharp is</font><font color="#CCCCCC"> the</font>

568
00:19:22,130 --> 00:19:27,500
default but jscript<font color="#CCCCCC"> visual basic etc and</font>

569
00:19:25,669 --> 00:19:29,210
so you can<font color="#E5E5E5"> basically put in in this case</font>

570
00:19:27,500 --> 00:19:30,950
<font color="#CCCCCC">with</font><font color="#E5E5E5"> some c-sharp put in your code and</font>

571
00:19:29,210 --> 00:19:33,110
<font color="#CCCCCC">then it's do ad type and what I'll do on</font>

572
00:19:30,950 --> 00:19:35,000
the target system<font color="#CCCCCC"> it will compile and</font>

573
00:19:33,110 --> 00:19:36,649
execute that<font color="#E5E5E5"> code now if you wanna be a</font>

574
00:19:35,000 --> 00:19:39,770
little<font color="#E5E5E5"> quieter you can pre compile it</font>

575
00:19:36,650 --> 00:19:41,270
<font color="#CCCCCC">and just load the bytes directly onto</font>

576
00:19:39,770 --> 00:19:43,010
your<font color="#CCCCCC"> target system the thing you have</font><font color="#E5E5E5"> to</font>

577
00:19:41,270 --> 00:19:44,780
keep in mind<font color="#CCCCCC"> is that</font><font color="#E5E5E5"> there has to be</font>

578
00:19:43,010 --> 00:19:46,640
compatibility between the versions<font color="#E5E5E5"> of</font>

579
00:19:44,780 --> 00:19:50,389
the.net compilers<font color="#CCCCCC"> that are on each</font>

580
00:19:46,640 --> 00:19:52,669
system<font color="#CCCCCC"> alright that was looking at the</font>

581
00:19:50,390 --> 00:19:54,410
obscure cradles<font color="#E5E5E5"> now what</font><font color="#CCCCCC"> does</font>

582
00:19:52,669 --> 00:19:56,660
authentication look like how is it

583
00:19:54,410 --> 00:19:59,030
different<font color="#E5E5E5"> than in both</font><font color="#CCCCCC"> confiscation</font>

584
00:19:56,660 --> 00:20:01,340
<font color="#CCCCCC">we'll take a look at the same basic</font>

585
00:19:59,030 --> 00:20:03,889
download cradle<font color="#CCCCCC"> so we have</font><font color="#E5E5E5"> our member</font>

586
00:20:01,340 --> 00:20:07,580
occupation<font color="#CCCCCC"> sorry</font><font color="#E5E5E5"> our method office</font>

587
00:20:03,890 --> 00:20:09,290
kitchen<font color="#E5E5E5"> here so download string one</font>

588
00:20:07,580 --> 00:20:12,169
thing that we can do is say<font color="#CCCCCC"> ok this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

589
00:20:09,290 --> 00:20:14,090
<font color="#E5E5E5">method of net web client</font><font color="#CCCCCC"> the class</font><font color="#E5E5E5"> so</font>

590
00:20:12,170 --> 00:20:16,760
what if we just<font color="#E5E5E5"> say</font><font color="#CCCCCC"> new object net web</font>

591
00:20:14,090 --> 00:20:18,980
client<font color="#E5E5E5"> dot PS object dot methods it's</font>

592
00:20:16,760 --> 00:20:20,780
going to give us<font color="#CCCCCC"> a huge list</font><font color="#E5E5E5"> of all the</font>

593
00:20:18,980 --> 00:20:22,310
method names<font color="#E5E5E5"> you could also do the same</font>

594
00:20:20,780 --> 00:20:24,320
thing<font color="#CCCCCC"> and a lot cleaner syntax with get</font>

595
00:20:22,310 --> 00:20:26,000
member both of these are options in the

596
00:20:24,320 --> 00:20:28,760
tool but<font color="#E5E5E5"> we'll stick</font><font color="#CCCCCC"> with a PS object</font>

597
00:20:26,000 --> 00:20:30,350
for<font color="#E5E5E5"> this one now what we can do is then</font>

598
00:20:28,760 --> 00:20:32,600
enumerate<font color="#E5E5E5"> that and say</font><font color="#CCCCCC"> ok I want to</font><font color="#E5E5E5"> know</font>

599
00:20:30,350 --> 00:20:34,459
where the object name is download string

600
00:20:32,600 --> 00:20:36,260
and then we see<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is actually -</font>

601
00:20:34,460 --> 00:20:37,940
there's an overloaded definition<font color="#E5E5E5"> well I</font>

602
00:20:36,260 --> 00:20:39,950
would<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> the name of</font>

603
00:20:37,940 --> 00:20:42,650
<font color="#CCCCCC">that</font><font color="#E5E5E5"> now that gets me the string</font>

604
00:20:39,950 --> 00:20:44,630
download string and so what<font color="#E5E5E5"> really makes</font>

605
00:20:42,650 --> 00:20:46,730
<font color="#E5E5E5">this fun is see download string what if</font>

606
00:20:44,630 --> 00:20:49,370
we just<font color="#CCCCCC"> randomly select from a set</font><font color="#E5E5E5"> of</font>

607
00:20:46,730 --> 00:20:51,380
nice<font color="#E5E5E5"> wild carded string to get download</font>

608
00:20:49,370 --> 00:20:53,419
string<font color="#E5E5E5"> and you're going to see this</font>

609
00:20:51,380 --> 00:20:55,460
theme<font color="#E5E5E5"> repeated greatly so now this</font>

610
00:20:53,420 --> 00:20:56,390
<font color="#E5E5E5">becomes a string download string so now</font>

611
00:20:55,460 --> 00:20:57,470
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to pop it up</font><font color="#E5E5E5"> into the</font>

612
00:20:56,390 --> 00:20:59,570
command and if you notice<font color="#E5E5E5"> that dot</font>

613
00:20:57,470 --> 00:21:00,980
invoke this is necessary for<font color="#E5E5E5"> PowerShell</font>

614
00:20:59,570 --> 00:21:02,659
<font color="#CCCCCC">too but it's not</font><font color="#E5E5E5"> necessary for</font>

615
00:21:00,980 --> 00:21:05,000
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> 3 but everything producing</font>

616
00:21:02,660 --> 00:21:06,560
this<font color="#E5E5E5"> tool unless it explicitly says 3.0</font>

617
00:21:05,000 --> 00:21:09,560
or later it will work across<font color="#E5E5E5"> the board</font>

618
00:21:06,560 --> 00:21:11,389
<font color="#CCCCCC">so that</font><font color="#E5E5E5"> dot invoke will be</font><font color="#CCCCCC"> their new</font>

619
00:21:09,560 --> 00:21:14,659
object<font color="#E5E5E5"> so how does invoke cradle crafter</font>

620
00:21:11,390 --> 00:21:17,170
handle<font color="#CCCCCC"> punana obfuscation</font><font color="#E5E5E5"> well we can</font>

621
00:21:14,660 --> 00:21:19,430
use<font color="#CCCCCC"> yet commands</font><font color="#E5E5E5"> new object right and</font>

622
00:21:17,170 --> 00:21:20,870
then invoke the result that<font color="#E5E5E5"> comes back</font>

623
00:21:19,430 --> 00:21:22,610
so we<font color="#E5E5E5"> can use a dot or ampersand</font><font color="#CCCCCC"> to</font>

624
00:21:20,870 --> 00:21:24,020
invoke it yet command can<font color="#CCCCCC"> be any</font><font color="#E5E5E5"> of</font>

625
00:21:22,610 --> 00:21:25,729
these aliases<font color="#CCCCCC"> so we'll just choose</font>

626
00:21:24,020 --> 00:21:27,710
command<font color="#E5E5E5"> and the new object</font><font color="#CCCCCC"> you guessed</font>

627
00:21:25,730 --> 00:21:29,030
it<font color="#CCCCCC"> wild</font><font color="#E5E5E5"> cards</font><font color="#CCCCCC"> so randomly select one</font><font color="#E5E5E5"> of</font>

628
00:21:27,710 --> 00:21:30,500
<font color="#E5E5E5">these on the tool now that's our new</font>

629
00:21:29,030 --> 00:21:32,899
object<font color="#CCCCCC"> now something really</font><font color="#E5E5E5"> interesting</font>

630
00:21:30,500 --> 00:21:35,000
here since we obviously<font color="#CCCCCC"> ate a download</font>

631
00:21:32,900 --> 00:21:38,570
string<font color="#E5E5E5"> we've actually introduced another</font>

632
00:21:35,000 --> 00:21:39,500
new object so<font color="#E5E5E5"> they're always</font><font color="#CCCCCC"> everything</font>

633
00:21:38,570 --> 00:21:40,970
<font color="#E5E5E5">except this because</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> spent way too</font>

634
00:21:39,500 --> 00:21:42,530
much time making<font color="#CCCCCC"> this work because</font><font color="#E5E5E5"> I'm</font>

635
00:21:40,970 --> 00:21:45,410
really a CD<font color="#E5E5E5"> about this kind of stuff</font>

636
00:21:42,530 --> 00:21:47,210
<font color="#E5E5E5">working but basically the whole code if</font>

637
00:21:45,410 --> 00:21:50,120
is a comprise two tags an embedded tag

638
00:21:47,210 --> 00:21:51,350
<font color="#E5E5E5">so</font><font color="#CCCCCC"> that at any point</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you ever</font>

639
00:21:50,120 --> 00:21:53,659
<font color="#E5E5E5">introduce another new object it will</font>

640
00:21:51,350 --> 00:21:55,250
take on the<font color="#CCCCCC"> identity of</font><font color="#E5E5E5"> the original one</font>

641
00:21:53,660 --> 00:21:57,350
<font color="#CCCCCC">so boats are going to be replaced</font><font color="#E5E5E5"> and</font>

642
00:21:55,250 --> 00:21:58,730
this gets really really<font color="#E5E5E5"> big really</font><font color="#CCCCCC"> fast</font>

643
00:21:57,350 --> 00:22:00,230
<font color="#CCCCCC">when we start of</font><font color="#E5E5E5"> looking the bigger</font>

644
00:21:58,730 --> 00:22:01,730
cradles<font color="#E5E5E5"> in addition we could have used</font>

645
00:22:00,230 --> 00:22:03,590
this<font color="#E5E5E5"> just randomly selected one</font><font color="#CCCCCC"> dollar</font>

646
00:22:01,730 --> 00:22:05,750
syntax to do the same thing<font color="#E5E5E5"> pretty</font>

647
00:22:03,590 --> 00:22:08,090
<font color="#E5E5E5">disgusting right</font><font color="#CCCCCC"> I mean this one is</font>

648
00:22:05,750 --> 00:22:10,010
<font color="#CCCCCC">actually you</font><font color="#E5E5E5"> can see down here</font><font color="#CCCCCC"> this is</font>

649
00:22:08,090 --> 00:22:12,230
finding the<font color="#CCCCCC"> one that a method get'</font>

650
00:22:10,010 --> 00:22:14,090
command<font color="#E5E5E5"> name that's the one that it</font>

651
00:22:12,230 --> 00:22:15,529
shows<font color="#E5E5E5"> there other things</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> being</font>

652
00:22:14,090 --> 00:22:18,110
obfuscated behind the<font color="#E5E5E5"> scenes so in low</font>

653
00:22:15,529 --> 00:22:20,029
population does so much<font color="#E5E5E5"> occupation but</font>

654
00:22:18,110 --> 00:22:22,189
<font color="#E5E5E5">you can't really control</font><font color="#CCCCCC"> what it does</font>

655
00:22:20,029 --> 00:22:23,090
wear with invoke<font color="#E5E5E5"> cradle</font><font color="#CCCCCC"> crafters since</font>

656
00:22:22,190 --> 00:22:25,370
we're dealing<font color="#E5E5E5"> with such a smaller</font>

657
00:22:23,090 --> 00:22:27,168
command<font color="#CCCCCC"> I wanted to have almost full</font>

658
00:22:25,370 --> 00:22:28,760
control<font color="#E5E5E5"> over every piece of it</font><font color="#CCCCCC"> and</font>

659
00:22:27,169 --> 00:22:30,350
you'll see in the tool that hopefully it

660
00:22:28,760 --> 00:22:32,059
<font color="#E5E5E5">gets you pretty</font><font color="#CCCCCC"> darn close</font><font color="#E5E5E5"> to that these</font>

661
00:22:30,350 --> 00:22:33,559
<font color="#E5E5E5">are some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the options that will be off</font>

662
00:22:32,059 --> 00:22:34,760
you skated<font color="#CCCCCC"> randomly</font><font color="#E5E5E5"> behind the scenes</font>

663
00:22:33,559 --> 00:22:37,309
<font color="#E5E5E5">but you don't necessarily get to</font>

664
00:22:34,760 --> 00:22:39,200
explicitly select<font color="#E5E5E5"> so when object we can</font>

665
00:22:37,309 --> 00:22:42,710
<font color="#CCCCCC">use any of its aliases there and then</font>

666
00:22:39,200 --> 00:22:44,270
for like<font color="#E5E5E5"> a lot of I think I feel a lot</font>

667
00:22:42,710 --> 00:22:46,429
<font color="#CCCCCC">of</font><font color="#E5E5E5"> detections built on stuff looking for</font>

668
00:22:44,270 --> 00:22:48,379
like - like that's<font color="#E5E5E5"> going to burn you</font>

669
00:22:46,429 --> 00:22:51,200
because you can use -<font color="#E5E5E5"> see light for case</font>

670
00:22:48,380 --> 00:22:52,429
<font color="#E5E5E5">sensitive or I like for case insensitive</font>

671
00:22:51,200 --> 00:22:53,809
<font color="#CCCCCC">so there's a lot of</font><font color="#E5E5E5"> those things that</font>

672
00:22:52,429 --> 00:22:55,130
<font color="#E5E5E5">you need to keep in mind you're writing</font>

673
00:22:53,809 --> 00:22:57,020
<font color="#E5E5E5">detections for this kind of stuff</font>

674
00:22:55,130 --> 00:22:59,360
in addition dollar<font color="#CCCCCC"> undersigned this is</font>

675
00:22:57,020 --> 00:23:00,408
for the current<font color="#E5E5E5"> variable well</font><font color="#CCCCCC"> admit</font><font color="#E5E5E5"> me</font>

676
00:22:59,360 --> 00:23:02,750
in<font color="#E5E5E5"> one day</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> I was looking at the</font>

677
00:23:00,409 --> 00:23:03,980
automatic variables<font color="#E5E5E5"> about page it talked</font>

678
00:23:02,750 --> 00:23:06,289
<font color="#CCCCCC">about this variable called underscores</font>

679
00:23:03,980 --> 00:23:08,299
oh my gosh<font color="#E5E5E5"> that's that so we don't have</font>

680
00:23:06,289 --> 00:23:09,919
to use dollar<font color="#E5E5E5"> sign</font><font color="#CCCCCC"> underscore we can use</font>

681
00:23:08,299 --> 00:23:12,529
get<font color="#E5E5E5"> variable or any of its aliases</font>

682
00:23:09,919 --> 00:23:14,059
underscore<font color="#E5E5E5"> in addition - value only can</font>

683
00:23:12,529 --> 00:23:15,140
be any<font color="#E5E5E5"> of these sub strings because of</font>

684
00:23:14,059 --> 00:23:16,908
how parameter binding<font color="#E5E5E5"> works in</font>

685
00:23:15,140 --> 00:23:20,090
PowerShell<font color="#CCCCCC"> and we could also do not</font>

686
00:23:16,909 --> 00:23:22,070
<font color="#E5E5E5">value</font><font color="#CCCCCC"> it gets it gets crazier from</font><font color="#E5E5E5"> there</font>

687
00:23:20,090 --> 00:23:23,899
so we<font color="#E5E5E5"> can also use get item variable or</font>

688
00:23:22,070 --> 00:23:25,639
GI or item or the aliases<font color="#E5E5E5"> there in</font>

689
00:23:23,899 --> 00:23:26,090
addition you<font color="#E5E5E5"> can just throw out</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> for -</font>

690
00:23:25,640 --> 00:23:28,640
<font color="#E5E5E5">backslash</font>

691
00:23:26,090 --> 00:23:29,899
after that :<font color="#E5E5E5"> and it still works we can</font>

692
00:23:28,640 --> 00:23:33,320
<font color="#E5E5E5">also do the same</font><font color="#CCCCCC"> thing with get child</font>

693
00:23:29,899 --> 00:23:35,379
<font color="#E5E5E5">item in any of its aliases so a lot</font><font color="#CCCCCC"> of</font>

694
00:23:33,320 --> 00:23:37,399
<font color="#E5E5E5">options</font><font color="#CCCCCC"> there for that current variable</font>

695
00:23:35,380 --> 00:23:39,649
another thing we<font color="#E5E5E5"> can do is invoke cradle</font>

696
00:23:37,399 --> 00:23:41,750
<font color="#CCCCCC">clappers since</font><font color="#E5E5E5"> since the only input this</font>

697
00:23:39,649 --> 00:23:43,520
tool will take is a URL<font color="#E5E5E5"> from you of</font>

698
00:23:41,750 --> 00:23:44,990
where your<font color="#CCCCCC"> stage payload is</font><font color="#E5E5E5"> it'll take</font><font color="#CCCCCC"> a</font>

699
00:23:43,520 --> 00:23:46,879
post cradle command

700
00:23:44,990 --> 00:23:49,100
so again if<font color="#CCCCCC"> you're if</font><font color="#E5E5E5"> your cradle</font><font color="#CCCCCC"> would</font>

701
00:23:46,880 --> 00:23:50,990
invoke<font color="#E5E5E5"> mimikatz</font><font color="#CCCCCC"> scripts</font><font color="#E5E5E5"> you probably</font>

702
00:23:49,100 --> 00:23:53,178
want to run<font color="#CCCCCC"> after that</font><font color="#E5E5E5"> invoking the cats</font>

703
00:23:50,990 --> 00:23:55,190
<font color="#E5E5E5">-</font><font color="#CCCCCC"> dump creds whatever</font><font color="#E5E5E5"> so you can you can</font>

704
00:23:53,179 --> 00:23:57,200
<font color="#E5E5E5">enter a command afterwards and we'll see</font>

705
00:23:55,190 --> 00:23:58,760
well that's important for the tool<font color="#E5E5E5"> have</font>

706
00:23:57,200 --> 00:24:00,320
and some<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> imitations</font><font color="#E5E5E5"> than taxes</font>

707
00:23:58,760 --> 00:24:02,809
but<font color="#E5E5E5"> we can also do things like a</font>

708
00:24:00,320 --> 00:24:05,090
rearrange the command by breaking things

709
00:24:02,809 --> 00:24:07,070
out into<font color="#CCCCCC"> um variable so for</font><font color="#E5E5E5"> example we</font>

710
00:24:05,090 --> 00:24:08,870
have the options<font color="#E5E5E5"> to use logical variable</font>

711
00:24:07,070 --> 00:24:11,090
<font color="#E5E5E5">names like</font><font color="#CCCCCC"> ps4 downloads string and</font>

712
00:24:08,870 --> 00:24:12,889
radical variable syntax<font color="#E5E5E5"> the dollar sign</font>

713
00:24:11,090 --> 00:24:14,840
or<font color="#CCCCCC"> we can do random variable names with</font>

714
00:24:12,890 --> 00:24:17,210
<font color="#E5E5E5">random variable syntax and in the last</font>

715
00:24:14,840 --> 00:24:19,580
section<font color="#CCCCCC"> is obscure</font><font color="#E5E5E5"> imitate invocation</font>

716
00:24:17,210 --> 00:24:21,830
<font color="#E5E5E5">syntaxes which we'll look at right now</font>

717
00:24:19,580 --> 00:24:24,500
<font color="#E5E5E5">so there's over 10</font><font color="#CCCCCC"> different invocation</font>

718
00:24:21,830 --> 00:24:25,730
in taxes across the board<font color="#CCCCCC"> the</font>

719
00:24:24,500 --> 00:24:28,370
dissipation cradles have a couple more

720
00:24:25,730 --> 00:24:30,049
but<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> a standard</font><font color="#E5E5E5"> ie X</font>

721
00:24:28,370 --> 00:24:31,610
<font color="#E5E5E5">I'm not gonna spend any time there we</font>

722
00:24:30,049 --> 00:24:34,279
have get alias and get<font color="#E5E5E5"> command again</font>

723
00:24:31,610 --> 00:24:36,229
using wildcards to retrieve the command

724
00:24:34,279 --> 00:24:37,640
<font color="#CCCCCC">that we're interested in power so one</font>

725
00:24:36,230 --> 00:24:40,159
<font color="#E5E5E5">that we have get commandlets we saw one</font>

726
00:24:37,640 --> 00:24:42,380
sample<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that already the first</font><font color="#E5E5E5"> one is</font>

727
00:24:40,159 --> 00:24:44,929
like the basic syntax<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the second one</font>

728
00:24:42,380 --> 00:24:47,450
just<font color="#E5E5E5"> a random obfuscated version invoke</font>

729
00:24:44,929 --> 00:24:50,240
<font color="#CCCCCC">script powershell note syntax to execute</font>

730
00:24:47,450 --> 00:24:51,380
an expression<font color="#E5E5E5"> or a script block we</font>

731
00:24:50,240 --> 00:24:54,169
didn't<font color="#E5E5E5"> have invoked command which this</font>

732
00:24:51,380 --> 00:24:55,580
is<font color="#CCCCCC"> going to force</font><font color="#E5E5E5"> us to need to cast an</font>

733
00:24:54,169 --> 00:24:57,889
expression to a script block<font color="#E5E5E5"> before we</font>

734
00:24:55,580 --> 00:24:59,750
invoke it PS run space<font color="#E5E5E5"> this one's really</font>

735
00:24:57,889 --> 00:25:01,789
cool<font color="#E5E5E5"> I'm at</font><font color="#CCCCCC"> Graber actually had this</font>

736
00:24:59,750 --> 00:25:03,980
idea a<font color="#E5E5E5"> couple months ago and shared it</font>

737
00:25:01,789 --> 00:25:05,750
with me and<font color="#E5E5E5"> it's basically just creating</font>

738
00:25:03,980 --> 00:25:07,130
a<font color="#E5E5E5"> PowerShell run space shoving the code</font>

739
00:25:05,750 --> 00:25:09,760
in it with<font color="#CCCCCC"> this add script and then a</font>

740
00:25:07,130 --> 00:25:11,870
<font color="#CCCCCC">dot</font><font color="#E5E5E5"> invoke and you're off to the races</font>

741
00:25:09,760 --> 00:25:13,279
concatenated<font color="#CCCCCC"> IEX</font><font color="#E5E5E5"> this is the one I've</font>

742
00:25:11,870 --> 00:25:14,840
had the most<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> with it gets a</font><font color="#E5E5E5"> little</font>

743
00:25:13,279 --> 00:25:15,980
crazy as you can see so let me cover

744
00:25:14,840 --> 00:25:17,779
these last three real quick and<font color="#CCCCCC"> I'll</font>

745
00:25:15,980 --> 00:25:18,950
come back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> invoker's workflow</font>

746
00:25:17,779 --> 00:25:20,929
this is<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> three year later</font>

747
00:25:18,950 --> 00:25:22,190
pretty darn close to invoke expression

748
00:25:20,929 --> 00:25:25,309
except<font color="#CCCCCC"> everything's confined</font><font color="#E5E5E5"> to the</font>

749
00:25:22,190 --> 00:25:28,760
<font color="#E5E5E5">workflow so when you use option 9 and</font>

750
00:25:25,309 --> 00:25:30,620
option<font color="#E5E5E5"> 7 if you have a post cradle</font>

751
00:25:28,760 --> 00:25:32,480
command like again invoke mimikatz -

752
00:25:30,620 --> 00:25:34,850
<font color="#E5E5E5">dump</font><font color="#CCCCCC"> read</font><font color="#E5E5E5"> that has to be done in the</font>

753
00:25:32,480 --> 00:25:35,960
same run<font color="#E5E5E5"> space or workflow as the</font>

754
00:25:34,850 --> 00:25:37,399
invocation<font color="#E5E5E5"> itself</font>

755
00:25:35,960 --> 00:25:39,049
so that's why the tool takes that

756
00:25:37,399 --> 00:25:40,399
command so if your copy and pasting out

757
00:25:39,049 --> 00:25:41,899
and expecting to<font color="#E5E5E5"> always fit your plan at</font>

758
00:25:40,399 --> 00:25:44,029
the<font color="#E5E5E5"> end it's</font><font color="#CCCCCC"> not going to work with</font>

759
00:25:41,899 --> 00:25:46,729
those<font color="#CCCCCC"> two but the tool handles that and</font>

760
00:25:44,029 --> 00:25:49,370
puts it in<font color="#E5E5E5"> the proper run space or or a</font>

761
00:25:46,730 --> 00:25:51,500
<font color="#E5E5E5">workflow the last two dot</font><font color="#CCCCCC"> sourcing</font>

762
00:25:49,370 --> 00:25:52,908
import module<font color="#E5E5E5"> use you know interesting</font>

763
00:25:51,500 --> 00:25:54,860
ways that<font color="#CCCCCC"> you can load the scripts that</font>

764
00:25:52,909 --> 00:25:57,350
<font color="#E5E5E5">are on disk for any of the disk</font><font color="#CCCCCC"> space</font>

765
00:25:54,860 --> 00:25:59,750
download cradles so concatenated<font color="#E5E5E5"> IX</font>

766
00:25:57,350 --> 00:26:01,189
coming back to that<font color="#CCCCCC"> it again</font><font color="#E5E5E5"> the latest</font>

767
00:25:59,750 --> 00:26:02,779
version of invoke<font color="#E5E5E5"> coffee</font><font color="#CCCCCC"> station we do</font>

768
00:26:01,190 --> 00:26:05,630
stuff like this<font color="#E5E5E5"> pulling</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> the letters</font>

769
00:26:02,779 --> 00:26:07,549
<font color="#CCCCCC">ie and X from environment</font><font color="#E5E5E5"> variables like</font>

770
00:26:05,630 --> 00:26:09,470
<font color="#CCCCCC">comm spec or shell ID which is an</font>

771
00:26:07,549 --> 00:26:11,899
<font color="#E5E5E5">automatic variable in PowerShell this is</font>

772
00:26:09,470 --> 00:26:13,820
the only subtle overlap between these

773
00:26:11,899 --> 00:26:15,799
two tools<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> in book cradle contra</font>

774
00:26:13,820 --> 00:26:17,210
takes this but it basically clicks

775
00:26:15,799 --> 00:26:19,730
everything on steroids and<font color="#E5E5E5"> says okay</font>

776
00:26:17,210 --> 00:26:20,809
<font color="#E5E5E5">we're never going to call whatever done</font>

777
00:26:19,730 --> 00:26:22,880
assume that we're<font color="#E5E5E5"> going to call a</font>

778
00:26:20,809 --> 00:26:24,649
<font color="#E5E5E5">variable with a dollar</font><font color="#CCCCCC"> sign and let's</font>

779
00:26:22,880 --> 00:26:26,299
use wildcards wherever we can<font color="#CCCCCC"> so</font><font color="#E5E5E5"> now</font>

780
00:26:24,649 --> 00:26:29,689
that<font color="#CCCCCC"> becomes a coms</font><font color="#E5E5E5"> back and shell ID</font>

781
00:26:26,299 --> 00:26:31,100
<font color="#E5E5E5">and this is the newest part so if we</font>

782
00:26:29,690 --> 00:26:32,570
take a string in this<font color="#E5E5E5"> case it's an empty</font>

783
00:26:31,100 --> 00:26:34,490
<font color="#E5E5E5">string it doesn't matter when we pipe it</font>

784
00:26:32,570 --> 00:26:35,418
to get<font color="#E5E5E5"> number there are a ton of members</font>

785
00:26:34,490 --> 00:26:37,159
that<font color="#CCCCCC"> a string has</font>

786
00:26:35,419 --> 00:26:39,499
so look at the very bottom<font color="#E5E5E5"> we have this</font>

787
00:26:37,159 --> 00:26:42,139
<font color="#E5E5E5">index of that one conveniently has the</font>

788
00:26:39,499 --> 00:26:45,049
letters I and<font color="#CCCCCC"> II and X let's</font><font color="#E5E5E5"> look at</font>

789
00:26:42,139 --> 00:26:47,389
that<font color="#E5E5E5"> one so if we do string dot index of</font>

790
00:26:45,049 --> 00:26:48,979
then we can see<font color="#E5E5E5"> okay there's actually a</font>

791
00:26:47,389 --> 00:26:51,379
lot of overloaded definitions there<font color="#CCCCCC"> I</font>

792
00:26:48,979 --> 00:26:53,209
would love<font color="#E5E5E5"> to get my hands on any of</font>

793
00:26:51,379 --> 00:26:56,809
those eyes and using<font color="#E5E5E5"> X's but it's an</font>

794
00:26:53,209 --> 00:26:57,829
<font color="#CCCCCC">object so let's go into a string so</font>

795
00:26:56,809 --> 00:26:59,539
randomly choose between two different

796
00:26:57,829 --> 00:27:02,779
<font color="#E5E5E5">string syntax it's only have this long</font>

797
00:26:59,539 --> 00:27:04,940
string that<font color="#CCCCCC"> gives us a lot of options</font>

798
00:27:02,779 --> 00:27:07,039
<font color="#E5E5E5">so for example if we</font><font color="#CCCCCC"> use the</font><font color="#E5E5E5"> index</font><font color="#CCCCCC"> year</font>

799
00:27:04,940 --> 00:27:07,999
of<font color="#E5E5E5"> seven or eight that</font><font color="#CCCCCC"> gets</font><font color="#E5E5E5"> us IX but</font>

800
00:27:07,039 --> 00:27:09,440
these are all<font color="#E5E5E5"> the</font><font color="#CCCCCC"> options that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> in</font>

801
00:27:07,999 --> 00:27:11,059
the tool<font color="#E5E5E5"> so I basically went through</font>

802
00:27:09,440 --> 00:27:13,609
<font color="#CCCCCC">write a script to enumerate</font><font color="#E5E5E5"> every single</font>

803
00:27:11,059 --> 00:27:15,709
member of these string functions<font color="#E5E5E5"> and</font>

804
00:27:13,609 --> 00:27:17,029
pull out every single ie and X that

805
00:27:15,709 --> 00:27:18,559
works across<font color="#E5E5E5"> PowerShell two three four</font>

806
00:27:17,029 --> 00:27:20,089
and five<font color="#E5E5E5"> and</font><font color="#CCCCCC"> through into the tools will</font>

807
00:27:18,559 --> 00:27:21,678
<font color="#CCCCCC">be randomly selected every single time</font>

808
00:27:20,089 --> 00:27:23,418
so the numbers will never be the same

809
00:27:21,679 --> 00:27:25,190
<font color="#CCCCCC">but</font><font color="#E5E5E5"> there's</font><font color="#CCCCCC"> obviously some stuff you can</font>

810
00:27:23,419 --> 00:27:29,179
<font color="#E5E5E5">key off</font><font color="#CCCCCC"> of in here</font><font color="#E5E5E5"> if you're looking</font>

811
00:27:25,190 --> 00:27:33,139
<font color="#CCCCCC">just add that overall syntax itself all</font>

812
00:27:29,179 --> 00:27:34,309
<font color="#CCCCCC">right so both of you would say</font><font color="#E5E5E5"> hey all</font>

813
00:27:33,139 --> 00:27:35,748
of<font color="#CCCCCC"> that stuff you just said</font><font color="#E5E5E5"> is really</font>

814
00:27:34,309 --> 00:27:39,379
<font color="#E5E5E5">great for red teamers and sucks for blue</font>

815
00:27:35,749 --> 00:27:40,729
teamers right<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right well what's the</font>

816
00:27:39,379 --> 00:27:43,009
good news what's a redeeming factor for

817
00:27:40,729 --> 00:27:45,950
the blue teamers right that's who I am

818
00:27:43,009 --> 00:27:47,419
well behavior<font color="#E5E5E5"> is</font><font color="#CCCCCC"> doesn't not not only</font>

819
00:27:45,950 --> 00:27:49,009
gonna be affected by<font color="#E5E5E5"> a few</font><font color="#CCCCCC"> stations so</font>

820
00:27:47,419 --> 00:27:50,719
what's the bigger picture what are some

821
00:27:49,009 --> 00:27:53,539
favors<font color="#CCCCCC"> or artifacts that</font><font color="#E5E5E5"> we can look for</font>

822
00:27:50,719 --> 00:27:56,299
to<font color="#E5E5E5"> detect this kind</font><font color="#CCCCCC"> of activity first</font>

823
00:27:53,539 --> 00:27:58,009
network connections<font color="#CCCCCC"> and one of the big</font>

824
00:27:56,299 --> 00:27:59,989
one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the reasons I</font><font color="#CCCCCC"> went down this</font>

825
00:27:58,009 --> 00:28:02,869
rabbit hole<font color="#E5E5E5"> this project is what if an</font>

826
00:27:59,989 --> 00:28:04,070
organization that your target is is just

827
00:28:02,869 --> 00:28:05,899
<font color="#E5E5E5">looking for</font><font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> making that walk</font>

828
00:28:04,070 --> 00:28:07,369
connections period<font color="#E5E5E5"> well how can we</font>

829
00:28:05,899 --> 00:28:08,869
pawned off network connections on other

830
00:28:07,369 --> 00:28:11,208
binaries<font color="#E5E5E5"> and that's the coolest</font><font color="#CCCCCC"> part of</font>

831
00:28:08,869 --> 00:28:13,099
<font color="#E5E5E5">this project</font><font color="#CCCCCC"> in my</font><font color="#E5E5E5"> opinion so for</font>

832
00:28:11,209 --> 00:28:15,169
<font color="#E5E5E5">example when you use bit either</font><font color="#CCCCCC"> VIP</font>

833
00:28:13,099 --> 00:28:16,399
admin or<font color="#CCCCCC"> stop</font><font color="#E5E5E5"> mitts transfer SVC host</font>

834
00:28:15,169 --> 00:28:18,409
actually<font color="#CCCCCC"> make your network connection</font>

835
00:28:16,399 --> 00:28:19,849
<font color="#E5E5E5">and it's not really there's no</font>

836
00:28:18,409 --> 00:28:22,009
<font color="#CCCCCC">parent-child process relationship with</font>

837
00:28:19,849 --> 00:28:25,129
<font color="#E5E5E5">whom PowerShell</font><font color="#CCCCCC"> and SVC host</font><font color="#E5E5E5"> in that in</font>

838
00:28:22,009 --> 00:28:27,469
that<font color="#E5E5E5"> process for a common object</font><font color="#CCCCCC"> word</font>

839
00:28:25,129 --> 00:28:29,329
<font color="#CCCCCC">excel</font><font color="#E5E5E5"> ie those applications make the</font>

840
00:28:27,469 --> 00:28:31,039
<font color="#E5E5E5">network connection</font><font color="#CCCCCC"> and with sitting sees</font>

841
00:28:29,329 --> 00:28:32,418
a notepad actually notepad and<font color="#CCCCCC"> SVC tell</font>

842
00:28:31,039 --> 00:28:33,649
<font color="#CCCCCC">us</font><font color="#E5E5E5"> make the network connection actually</font>

843
00:28:32,419 --> 00:28:34,759
<font color="#CCCCCC">they make quite a few</font><font color="#E5E5E5"> network</font>

844
00:28:33,649 --> 00:28:36,678
connections depending on how big your

845
00:28:34,759 --> 00:28:39,379
payload is so something keep in mind

846
00:28:36,679 --> 00:28:40,609
<font color="#CCCCCC">there Parent Child</font><font color="#E5E5E5"> process relationships</font>

847
00:28:39,379 --> 00:28:42,379
again if you're calling bit to admin

848
00:28:40,609 --> 00:28:44,029
from<font color="#E5E5E5"> PowerShell that's pretty darn</font>

849
00:28:42,379 --> 00:28:45,289
suspicious and<font color="#CCCCCC"> again a lot</font><font color="#E5E5E5"> of commodity</font>

850
00:28:44,029 --> 00:28:47,389
malware does<font color="#E5E5E5"> this we see this quite a</font>

851
00:28:45,289 --> 00:28:48,740
bit<font color="#CCCCCC"> but</font><font color="#E5E5E5"> when it comes to</font><font color="#CCCCCC"> common objects</font>

852
00:28:47,389 --> 00:28:51,469
what's great is that

853
00:28:48,740 --> 00:28:54,679
windward in Excel and<font color="#E5E5E5"> ie gets spawned by</font>

854
00:28:51,470 --> 00:28:56,240
svchost.exe<font color="#CCCCCC"> on them</font><font color="#E5E5E5"> so no great</font>

855
00:28:54,679 --> 00:28:59,509
parent-child process relationship<font color="#CCCCCC"> their</font>

856
00:28:56,240 --> 00:29:01,190
<font color="#E5E5E5">sin</font><font color="#CCCCCC"> Keys</font><font color="#E5E5E5"> a notepad well in order</font><font color="#CCCCCC"> to get</font>

857
00:28:59,509 --> 00:29:02,570
<font color="#E5E5E5">the pit for notepad to try to make it a</font>

858
00:29:01,190 --> 00:29:04,039
<font color="#E5E5E5">little</font><font color="#CCCCCC"> more reliable</font><font color="#E5E5E5"> technically</font>

859
00:29:02,570 --> 00:29:05,600
<font color="#CCCCCC">PowerShell does spawn notepad you could</font>

860
00:29:04,039 --> 00:29:07,700
use<font color="#CCCCCC"> WMI</font><font color="#E5E5E5"> or some other stuff to do that</font>

861
00:29:05,600 --> 00:29:09,709
but it's in<font color="#CCCCCC"> my</font><font color="#E5E5E5"> opinion not really worth</font>

862
00:29:07,700 --> 00:29:11,330
the effort<font color="#CCCCCC"> to</font><font color="#E5E5E5"> go to that link and then</font>

863
00:29:09,710 --> 00:29:13,279
for inline scripting on<font color="#E5E5E5"> the target</font>

864
00:29:11,330 --> 00:29:14,869
system<font color="#CCCCCC"> if you do if you have embedded</font><font color="#E5E5E5"> in</font>

865
00:29:13,279 --> 00:29:16,549
line<font color="#CCCCCC"> c shop</font><font color="#E5E5E5"> or anything else it will</font>

866
00:29:14,869 --> 00:29:19,369
compile on the target<font color="#E5E5E5"> systems guilty</font>

867
00:29:16,549 --> 00:29:20,779
<font color="#E5E5E5">powershell CSC and CVT</font><font color="#CCCCCC"> res on</font><font color="#E5E5E5"> the target</font>

868
00:29:19,369 --> 00:29:22,428
<font color="#E5E5E5">system</font><font color="#CCCCCC"> so if you're not doing any</font>

869
00:29:20,779 --> 00:29:23,840
compilation<font color="#CCCCCC"> of c shots and powershell in</font>

870
00:29:22,429 --> 00:29:25,549
your environment<font color="#E5E5E5"> that's a pretty darn</font>

871
00:29:23,840 --> 00:29:27,199
good indicator<font color="#CCCCCC"> to look for</font><font color="#E5E5E5"> because a ton</font>

872
00:29:25,549 --> 00:29:28,519
of groups<font color="#E5E5E5"> a lot of financial groups</font><font color="#CCCCCC"> love</font>

873
00:29:27,200 --> 00:29:30,019
to use<font color="#E5E5E5"> shell code loaders that</font><font color="#CCCCCC"> are</font>

874
00:29:28,519 --> 00:29:31,700
<font color="#CCCCCC">written in c sharp</font>

875
00:29:30,019 --> 00:29:32,690
so we see this<font color="#E5E5E5"> quite a bit has</font><font color="#CCCCCC"> been</font>

876
00:29:31,700 --> 00:29:35,240
really helpful<font color="#E5E5E5"> on a lot of</font>

877
00:29:32,690 --> 00:29:36,919
investigations<font color="#CCCCCC"> of event logs besides</font>

878
00:29:35,240 --> 00:29:39,529
<font color="#E5E5E5">command line auditing and basically</font>

879
00:29:36,919 --> 00:29:41,659
every powershell log this<font color="#CCCCCC"> hatton has its</font>

880
00:29:39,529 --> 00:29:42,980
own event log that logs by default which

881
00:29:41,659 --> 00:29:44,570
is<font color="#E5E5E5"> really great to your UI is</font><font color="#CCCCCC"> it when</font>

882
00:29:42,980 --> 00:29:47,450
you're<font color="#E5E5E5"> sitting in there I'm not saying</font>

883
00:29:44,570 --> 00:29:48,470
clear it just saying be<font color="#CCCCCC"> aware of</font><font color="#E5E5E5"> it and</font>

884
00:29:47,450 --> 00:29:50,929
as defenders<font color="#E5E5E5"> it's something we</font><font color="#CCCCCC"> should</font>

885
00:29:48,470 --> 00:29:53,659
<font color="#CCCCCC">look for also</font><font color="#E5E5E5"> after using notepad yes</font>

886
00:29:50,929 --> 00:29:55,340
you run vol<font color="#E5E5E5"> making this</font><font color="#CCCCCC"> dab setcookie</font>

887
00:29:53,659 --> 00:29:59,149
<font color="#E5E5E5">with your</font><font color="#CCCCCC"> URI in the command</font><font color="#E5E5E5"> line</font>

888
00:29:55,340 --> 00:30:00,678
arguments so<font color="#CCCCCC"> dealers loaded there's a</font>

889
00:29:59,149 --> 00:30:02,479
lot of<font color="#E5E5E5"> interesting ones here when</font>

890
00:30:00,679 --> 00:30:04,279
<font color="#E5E5E5">PowerShell actually anything well it's</font>

891
00:30:02,480 --> 00:30:07,190
<font color="#E5E5E5">ie at the</font><font color="#CCCCCC"> comm object it's</font><font color="#E5E5E5"> going to load</font>

892
00:30:04,279 --> 00:30:09,080
a nice little<font color="#E5E5E5"> dll called ie proxy how</font>

893
00:30:07,190 --> 00:30:10,700
often does<font color="#E5E5E5"> PowerShell do that if you're</font>

894
00:30:09,080 --> 00:30:13,820
doing<font color="#E5E5E5"> this from a macro -</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> windward</font>

895
00:30:10,700 --> 00:30:15,320
<font color="#E5E5E5">load ie proxy</font><font color="#CCCCCC"> huh and when we</font><font color="#E5E5E5"> find that</font>

896
00:30:13,820 --> 00:30:17,119
pretty<font color="#CCCCCC"> search files</font><font color="#E5E5E5"> is a great place to</font>

897
00:30:15,320 --> 00:30:17,899
the prefetch file still there<font color="#E5E5E5"> the one</font>

898
00:30:17,119 --> 00:30:19,459
thing I really<font color="#CCCCCC"> want to draw your</font>

899
00:30:17,899 --> 00:30:21,320
<font color="#CCCCCC">attention to</font><font color="#E5E5E5"> is PowerShell</font><font color="#CCCCCC"> net that web</font>

900
00:30:19,460 --> 00:30:23,720
client<font color="#E5E5E5"> and there's a lot of dll's you</font>

901
00:30:21,320 --> 00:30:25,730
can see here a<font color="#E5E5E5"> couple but</font><font color="#CCCCCC"> wrasse API 32</font>

902
00:30:23,720 --> 00:30:27,440
<font color="#E5E5E5">and</font><font color="#CCCCCC"> rasma</font><font color="#E5E5E5"> not yellow</font><font color="#CCCCCC"> one of our</font>

903
00:30:25,730 --> 00:30:28,789
consultants<font color="#E5E5E5"> found this late last year</font>

904
00:30:27,440 --> 00:30:31,220
<font color="#E5E5E5">and engagement and what's really</font><font color="#CCCCCC"> cool</font>

905
00:30:28,789 --> 00:30:33,740
about this is that<font color="#E5E5E5"> it happens to create</font>

906
00:30:31,220 --> 00:30:35,269
a nice registry key for you<font color="#E5E5E5"> every time</font>

907
00:30:33,740 --> 00:30:36,049
any binary<font color="#E5E5E5"> it loads those</font><font color="#CCCCCC"> to make a</font>

908
00:30:35,269 --> 00:30:37,999
network<font color="#E5E5E5"> connection</font>

909
00:30:36,049 --> 00:30:39,168
now you can't trust the timestamp on<font color="#CCCCCC"> the</font>

910
00:30:37,999 --> 00:30:40,789
registry key because it inherits it from

911
00:30:39,169 --> 00:30:42,499
the parent I just repeat but<font color="#CCCCCC"> if</font>

912
00:30:40,789 --> 00:30:44,059
PowerShell is not used<font color="#E5E5E5"> to making network</font>

913
00:30:42,499 --> 00:30:46,100
connections in an environment<font color="#E5E5E5"> and let's</font>

914
00:30:44,059 --> 00:30:48,379
say an unnamed pin group went through

915
00:30:46,100 --> 00:30:50,719
and<font color="#E5E5E5"> was using PowerShell</font><font color="#CCCCCC"> to download a</font>

916
00:30:48,379 --> 00:30:52,189
second stage payload then you're<font color="#E5E5E5"> going</font>

917
00:30:50,720 --> 00:30:53,659
<font color="#E5E5E5">to see these</font><font color="#CCCCCC"> red</font><font color="#E5E5E5"> keys all over the place</font>

918
00:30:52,190 --> 00:30:56,960
for every<font color="#E5E5E5"> system that second stage ran</font>

919
00:30:53,659 --> 00:30:59,269
on pretty convenient stuff right absent

920
00:30:56,960 --> 00:31:00,830
at<font color="#E5E5E5"> cache again</font><font color="#CCCCCC"> if we see the shell</font>

921
00:30:59,269 --> 00:31:02,330
<font color="#E5E5E5">letting activity we're</font><font color="#CCCCCC"> going to see the</font>

922
00:31:00,830 --> 00:31:04,970
very specific<font color="#CCCCCC"> order of</font><font color="#E5E5E5"> PowerShell</font>

923
00:31:02,330 --> 00:31:06,439
CSCC<font color="#E5E5E5"> dt res and absent at cash whenever</font>

924
00:31:04,970 --> 00:31:08,690
the<font color="#CCCCCC"> c-sharp loaders have been run in</font>

925
00:31:06,440 --> 00:31:10,850
<font color="#CCCCCC">powershell really good to</font><font color="#E5E5E5"> look for</font><font color="#CCCCCC"> and</font>

926
00:31:08,690 --> 00:31:14,630
lastly<font color="#CCCCCC"> -</font><font color="#E5E5E5"> temporary files when you're</font>

927
00:31:10,850 --> 00:31:16,129
using<font color="#E5E5E5"> win</font><font color="#CCCCCC"> Word Excel</font><font color="#E5E5E5"> ie or notepad it's</font>

928
00:31:14,630 --> 00:31:17,630
kind of<font color="#E5E5E5"> really but not</font><font color="#CCCCCC"> really because</font>

929
00:31:16,130 --> 00:31:19,460
the applications will<font color="#E5E5E5"> cache crap and</font>

930
00:31:17,630 --> 00:31:23,060
temporary<font color="#CCCCCC"> Internet files or inet cash</font>

931
00:31:19,460 --> 00:31:24,830
depending on your OS so and a lot<font color="#CCCCCC"> of</font>

932
00:31:23,060 --> 00:31:26,000
times the full payload will be there<font color="#E5E5E5"> so</font>

933
00:31:24,830 --> 00:31:29,030
that's something<font color="#E5E5E5"> to keep in mind</font><font color="#CCCCCC"> again</font>

934
00:31:26,000 --> 00:31:31,430
I'm not saying go<font color="#E5E5E5"> and delete these cache</font>

935
00:31:29,030 --> 00:31:32,540
files but they are there's a defender

936
00:31:31,430 --> 00:31:35,930
system<font color="#E5E5E5"> your goals might</font><font color="#CCCCCC"> be pretty</font>

937
00:31:32,540 --> 00:31:38,810
helpful to go through and look<font color="#CCCCCC"> all right</font>

938
00:31:35,930 --> 00:31:42,350
it's demo time<font color="#E5E5E5"> well see if it's worse</font>

939
00:31:38,810 --> 00:31:44,810
oh of course<font color="#E5E5E5"> the obligatory please do</font>

940
00:31:42,350 --> 00:31:46,520
not use this for<font color="#E5E5E5"> evil have full consent</font>

941
00:31:44,810 --> 00:31:47,899
of whatever environment you're using it

942
00:31:46,520 --> 00:31:52,629
soon<font color="#E5E5E5"> and I don't say that jokingly</font>

943
00:31:47,900 --> 00:31:52,630
please<font color="#CCCCCC"> I'll come back</font>

944
00:32:03,970 --> 00:32:07,390
<font color="#E5E5E5">okay I'll see that all right</font>

945
00:32:09,700 --> 00:32:13,490
all right and this I push<font color="#E5E5E5"> this code</font>

946
00:32:11,960 --> 00:32:17,690
about 20 minutes before<font color="#E5E5E5"> I came up</font><font color="#CCCCCC"> here</font>

947
00:32:13,490 --> 00:32:24,410
so it<font color="#E5E5E5"> is live a habit huh</font>

948
00:32:17,690 --> 00:32:32,210
in<font color="#CCCCCC"> both cradle crafter dot PSD</font><font color="#E5E5E5"> one let</font>

949
00:32:24,410 --> 00:32:35,930
<font color="#E5E5E5">me</font><font color="#CCCCCC"> spell out oh thank you</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> and</font>

950
00:32:32,210 --> 00:32:39,680
<font color="#E5E5E5">now we're going to call</font><font color="#CCCCCC"> invoke Cradle</font>

951
00:32:35,930 --> 00:32:41,840
<font color="#E5E5E5">Custer and there's my</font><font color="#CCCCCC"> ASCII are way too</font>

952
00:32:39,680 --> 00:32:43,970
<font color="#E5E5E5">much time</font><font color="#CCCCCC"> on that</font><font color="#E5E5E5"> basically building out</font>

953
00:32:41,840 --> 00:32:45,320
a<font color="#CCCCCC"> night so</font><font color="#E5E5E5"> obfuscated cradle there and</font>

954
00:32:43,970 --> 00:32:47,060
<font color="#E5E5E5">actually does run that command that in</font>

955
00:32:45,320 --> 00:32:48,889
book cradle captor so you can go home

956
00:32:47,060 --> 00:32:51,740
and<font color="#CCCCCC"> play with that if you like</font>

957
00:32:48,890 --> 00:32:54,260
so we have very<font color="#CCCCCC"> very similar to invoke</font>

958
00:32:51,740 --> 00:32:55,880
confiscation<font color="#CCCCCC"> have a nice tutorial here</font>

959
00:32:54,260 --> 00:32:57,140
<font color="#E5E5E5">so basically</font><font color="#CCCCCC"> everything in yellow takes</font>

960
00:32:55,880 --> 00:32:59,390
you to new menu<font color="#CCCCCC"> and everything green</font>

961
00:32:57,140 --> 00:33:01,550
actually<font color="#CCCCCC"> apply something so if we get</font><font color="#E5E5E5"> to</font>

962
00:32:59,390 --> 00:33:03,590
the tutorial<font color="#E5E5E5"> you'll see step one is</font>

963
00:33:01,550 --> 00:33:04,970
basically setting your fields so URL and

964
00:33:03,590 --> 00:33:08,679
then<font color="#E5E5E5"> path and</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> cradle</font><font color="#CCCCCC"> cleaner</font>

965
00:33:04,970 --> 00:33:14,420
<font color="#E5E5E5">optional so for example let's do set URL</font>

966
00:33:08,680 --> 00:33:16,100
bitly Zisk on<font color="#E5E5E5"> ascii</font><font color="#CCCCCC"> we'll see what that</font>

967
00:33:14,420 --> 00:33:19,730
<font color="#CCCCCC">is later alright</font><font color="#E5E5E5"> so we have memory and</font>

968
00:33:16,100 --> 00:33:22,310
<font color="#CCCCCC">disk though</font><font color="#E5E5E5"> two options so memory</font><font color="#CCCCCC"> you</font>

969
00:33:19,730 --> 00:33:24,860
can see here very<font color="#CCCCCC"> clearly if</font><font color="#E5E5E5"> it's ps3 or</font>

970
00:33:22,310 --> 00:33:26,120
later<font color="#CCCCCC"> it's in bright red</font><font color="#E5E5E5"> so please don't</font>

971
00:33:24,860 --> 00:33:27,469
<font color="#E5E5E5">don't yell at me if your stuff doesn't</font>

972
00:33:26,120 --> 00:33:29,540
<font color="#CCCCCC">work on powershell</font><font color="#E5E5E5"> to you because it's</font>

973
00:33:27,470 --> 00:33:32,540
pretty<font color="#E5E5E5"> don't explicit in the tool so PS</font>

974
00:33:29,540 --> 00:33:34,430
web<font color="#CCCCCC"> stream if we go here I took a lot of</font>

975
00:33:32,540 --> 00:33:36,110
<font color="#E5E5E5">pains to go through and actually build</font>

976
00:33:34,430 --> 00:33:37,400
out information<font color="#E5E5E5"> every time</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> enter a</font>

977
00:33:36,110 --> 00:33:40,610
new cradle<font color="#CCCCCC"> context and say here's</font>

978
00:33:37,400 --> 00:33:42,470
artifacts behaviors indications that

979
00:33:40,610 --> 00:33:43,820
this<font color="#E5E5E5"> thing may have just happened</font><font color="#CCCCCC"> so</font>

980
00:33:42,470 --> 00:33:45,710
<font color="#E5E5E5">that as blue teamers</font>

981
00:33:43,820 --> 00:33:47,270
<font color="#E5E5E5">we have no excuse to</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> be looking at</font>

982
00:33:45,710 --> 00:33:48,740
these artifacts<font color="#E5E5E5"> and</font><font color="#CCCCCC"> those red teamers</font>

983
00:33:47,270 --> 00:33:50,000
you can make a more<font color="#CCCCCC"> informed selection</font>

984
00:33:48,740 --> 00:33:52,220
about what cradle you want to use in

985
00:33:50,000 --> 00:33:53,810
what situation so<font color="#CCCCCC"> please do</font><font color="#E5E5E5"> look at that</font>

986
00:33:52,220 --> 00:33:57,370
<font color="#CCCCCC">and if you see any errors</font><font color="#E5E5E5"> please let me</font>

987
00:33:53,810 --> 00:34:00,800
know and and we'll get those<font color="#E5E5E5"> updated so</font>

988
00:33:57,370 --> 00:34:03,830
<font color="#E5E5E5">rearrange by default this</font><font color="#CCCCCC"> is a one-liner</font>

989
00:34:00,800 --> 00:34:05,480
command here if I do<font color="#CCCCCC"> multivariable</font><font color="#E5E5E5"> it'll</font>

990
00:34:03,830 --> 00:34:07,220
break it out into normal variable syntax

991
00:34:05,480 --> 00:34:10,109
<font color="#CCCCCC">and normal variable names</font><font color="#E5E5E5"> now can notice</font>

992
00:34:07,220 --> 00:34:12,269
<font color="#CCCCCC">here that URL is in</font><font color="#E5E5E5"> blue</font>

993
00:34:10,109 --> 00:34:14,129
right so<font color="#E5E5E5"> everybody gets way</font><font color="#CCCCCC"> too much</font>

994
00:34:12,268 --> 00:34:16,229
time<font color="#E5E5E5"> on this any input</font><font color="#CCCCCC"> that you have</font>

995
00:34:14,129 --> 00:34:17,759
that which is your URL a path and post

996
00:34:16,230 --> 00:34:19,529
<font color="#E5E5E5">cradle command will always appear in</font>

997
00:34:17,759 --> 00:34:20,759
blue<font color="#E5E5E5"> so in the</font><font color="#CCCCCC"> command gets really crazy</font>

998
00:34:19,529 --> 00:34:23,279
<font color="#E5E5E5">you know what's the stuff that I</font>

999
00:34:20,759 --> 00:34:24,809
<font color="#E5E5E5">contributed to the whole command will</font><font color="#CCCCCC"> be</font>

1000
00:34:23,279 --> 00:34:26,940
white except for<font color="#E5E5E5"> the thing</font><font color="#CCCCCC"> that just</font>

1001
00:34:24,809 --> 00:34:28,200
<font color="#E5E5E5">changed to all the yellow</font><font color="#CCCCCC"> pieces</font><font color="#E5E5E5"> all the</font>

1002
00:34:26,940 --> 00:34:30,599
things<font color="#E5E5E5"> that just changed so if we do</font>

1003
00:34:28,199 --> 00:34:32,638
<font color="#E5E5E5">random variable those are all the</font><font color="#CCCCCC"> things</font>

1004
00:34:30,599 --> 00:34:34,169
that<font color="#E5E5E5"> change there and I really took way</font>

1005
00:34:32,639 --> 00:34:35,639
too<font color="#E5E5E5"> much time doing this because the</font>

1006
00:34:34,168 --> 00:34:38,368
point<font color="#E5E5E5"> isn't to create some hack tool</font>

1007
00:34:35,639 --> 00:34:39,960
<font color="#E5E5E5">it's to help inform users of how you can</font>

1008
00:34:38,369 --> 00:34:42,299
substitute these pieces<font color="#E5E5E5"> and why it still</font>

1009
00:34:39,960 --> 00:34:42,839
works so<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> leave that rearrange</font>

1010
00:34:42,299 --> 00:34:45,418
option

1011
00:34:42,839 --> 00:34:47,668
I'm<font color="#E5E5E5"> command lit for new object again the</font>

1012
00:34:45,418 --> 00:34:48,989
default is just<font color="#E5E5E5"> do natural object we can</font>

1013
00:34:47,668 --> 00:34:51,509
use<font color="#E5E5E5"> get command so in this case it's</font>

1014
00:34:48,989 --> 00:34:52,918
using<font color="#E5E5E5"> get - command now it's using</font>

1015
00:34:51,509 --> 00:34:55,619
command<font color="#E5E5E5"> you'll see</font><font color="#CCCCCC"> it using random</font>

1016
00:34:52,918 --> 00:34:57,900
invocation operator as well<font color="#CCCCCC"> as wildcard</font>

1017
00:34:55,619 --> 00:35:00,239
<font color="#CCCCCC">string so we'll go with that one method</font>

1018
00:34:57,900 --> 00:35:02,369
<font color="#E5E5E5">download string is the default number to</font>

1019
00:35:00,239 --> 00:35:03,869
be the<font color="#E5E5E5"> PS object enumeration so this is</font>

1020
00:35:02,369 --> 00:35:06,359
our wildcard that have selected for

1021
00:35:03,869 --> 00:35:08,190
download string<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is almost the same</font>

1022
00:35:06,359 --> 00:35:11,819
except<font color="#E5E5E5"> using git number instead of PS</font>

1023
00:35:08,190 --> 00:35:16,319
object<font color="#CCCCCC"> a</font><font color="#E5E5E5"> PS object method so we'll go</font>

1024
00:35:11,819 --> 00:35:18,239
with<font color="#CCCCCC"> that</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> invoke so by default I do</font>

1025
00:35:16,319 --> 00:35:19,739
<font color="#E5E5E5">not add an invoke function and the</font>

1026
00:35:18,239 --> 00:35:20,940
reason is<font color="#E5E5E5"> because sometimes</font><font color="#CCCCCC"> you probably</font>

1027
00:35:19,739 --> 00:35:23,249
don't want<font color="#CCCCCC"> to run that COBOL strikes</font>

1028
00:35:20,940 --> 00:35:25,319
<font color="#CCCCCC">pager on your system but you want to</font>

1029
00:35:23,249 --> 00:35:27,509
<font color="#E5E5E5">make sure you know is this</font><font color="#CCCCCC"> Debose</font><font color="#E5E5E5"> guys</font>

1030
00:35:25,319 --> 00:35:29,279
obfuscation is it actually working<font color="#E5E5E5"> let</font>

1031
00:35:27,509 --> 00:35:31,230
me just make sure<font color="#E5E5E5"> before I add invoke</font>

1032
00:35:29,279 --> 00:35:32,609
<font color="#CCCCCC">that actually downloads the payload in</font>

1033
00:35:31,230 --> 00:35:34,769
this case what<font color="#CCCCCC"> else go ahead</font><font color="#E5E5E5"> and invoke</font>

1034
00:35:32,609 --> 00:35:37,529
and again we have<font color="#E5E5E5"> our regular</font><font color="#CCCCCC"> invoke</font>

1035
00:35:34,769 --> 00:35:39,238
syntax<font color="#CCCCCC"> before after get alias is three</font>

1036
00:35:37,529 --> 00:35:41,249
we have<font color="#E5E5E5"> get command</font><font color="#CCCCCC"> pretty much all the</font>

1037
00:35:39,239 --> 00:35:43,529
<font color="#CCCCCC">things we walk</font><font color="#E5E5E5"> through and then nine of</font>

1038
00:35:41,249 --> 00:35:45,988
course my my<font color="#E5E5E5"> favorite is doing</font>

1039
00:35:43,529 --> 00:35:48,269
randomized<font color="#CCCCCC"> ie X</font><font color="#E5E5E5"> concatenation so we'll</font>

1040
00:35:45,989 --> 00:35:52,710
go<font color="#CCCCCC"> with this and now we can</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> run</font>

1041
00:35:48,269 --> 00:35:54,508
<font color="#E5E5E5">test and if it works there we go</font>

1042
00:35:52,710 --> 00:35:56,779
I<font color="#E5E5E5"> heart zip Khan so this is our payload</font>

1043
00:35:54,509 --> 00:35:56,779
<font color="#E5E5E5">right</font>

1044
00:35:57,150 --> 00:36:02,529
[Applause]

1045
00:36:00,269 --> 00:36:03,729
and so if you're like<font color="#E5E5E5"> me</font><font color="#CCCCCC"> that was</font><font color="#E5E5E5"> a lot</font>

1046
00:36:02,529 --> 00:36:06,939
of keystrokes<font color="#E5E5E5"> to get there and do that</font>

1047
00:36:03,729 --> 00:36:08,468
so I of<font color="#E5E5E5"> course included the nice all and</font>

1048
00:36:06,939 --> 00:36:09,848
you can just you<font color="#E5E5E5"> know do all of it at</font>

1049
00:36:08,469 --> 00:36:11,890
once<font color="#E5E5E5"> as many times as you want and again</font>

1050
00:36:09,849 --> 00:36:13,659
<font color="#CCCCCC">email coffee stations you kept hitting</font>

1051
00:36:11,890 --> 00:36:15,219
one one one one one<font color="#CCCCCC"> it would grow grow</font>

1052
00:36:13,659 --> 00:36:16,569
grow grow this isn't<font color="#E5E5E5"> because this is not</font>

1053
00:36:15,219 --> 00:36:18,009
adding to<font color="#CCCCCC"> it's simply</font><font color="#E5E5E5"> making</font>

1054
00:36:16,569 --> 00:36:20,259
substitutions in all the<font color="#E5E5E5"> places that it</font>

1055
00:36:18,009 --> 00:36:21,819
can so typically I'll do is I'll go

1056
00:36:20,259 --> 00:36:23,650
through<font color="#CCCCCC"> and I'll put all occupation and</font>

1057
00:36:21,819 --> 00:36:25,209
I'll go back<font color="#CCCCCC"> and start to pick the ones</font>

1058
00:36:23,650 --> 00:36:26,529
I want to<font color="#E5E5E5"> make sure I want to make</font><font color="#CCCCCC"> sure</font>

1059
00:36:25,209 --> 00:36:27,969
to this syntax let me go<font color="#E5E5E5"> through and</font>

1060
00:36:26,529 --> 00:36:29,559
repeat repeat until<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a syntax that I</font>

1061
00:36:27,969 --> 00:36:31,119
like and you'll see<font color="#E5E5E5"> that in some of</font>

1062
00:36:29,559 --> 00:36:33,099
<font color="#E5E5E5">these other ones like PS</font><font color="#CCCCCC"> com object</font><font color="#E5E5E5"> I</font>

1063
00:36:31,119 --> 00:36:35,049
there's a<font color="#E5E5E5"> lot more properties here it's</font>

1064
00:36:33,099 --> 00:36:37,209
<font color="#E5E5E5">a lot more things you can change</font><font color="#CCCCCC"> and a</font>

1065
00:36:35,049 --> 00:36:39,849
lot more<font color="#E5E5E5"> information</font><font color="#CCCCCC"> up here and if I go</font>

1066
00:36:37,209 --> 00:36:40,989
all there then that's that's<font color="#E5E5E5"> a that's</font><font color="#CCCCCC"> a</font>

1067
00:36:39,849 --> 00:36:43,869
chunk<font color="#E5E5E5"> of change right</font><font color="#CCCCCC"> there that's</font><font color="#E5E5E5"> a lot</font>

1068
00:36:40,989 --> 00:36:45,939
<font color="#CCCCCC">of cradle so again I hope that the</font>

1069
00:36:43,869 --> 00:36:47,799
colors are informative and actually<font color="#E5E5E5"> help</font>

1070
00:36:45,939 --> 00:36:51,339
you know convey what's happening behind

1071
00:36:47,799 --> 00:36:53,140
<font color="#E5E5E5">the scenes</font><font color="#CCCCCC"> and right now there's a few</font>

1072
00:36:51,339 --> 00:36:54,699
cradles that<font color="#E5E5E5"> are still in testing</font><font color="#CCCCCC"> sewn</font>

1073
00:36:53,140 --> 00:36:56,439
<font color="#CCCCCC">in with the inline c-sharp</font><font color="#E5E5E5"> in a bit</font>

1074
00:36:54,699 --> 00:36:58,630
<font color="#E5E5E5">those will be released within the</font><font color="#CCCCCC"> next</font>

1075
00:36:56,439 --> 00:37:00,339
two<font color="#CCCCCC"> weeks so bear with</font><font color="#E5E5E5"> me on that</font><font color="#CCCCCC"> but I</font>

1076
00:36:58,630 --> 00:37:01,989
<font color="#E5E5E5">hope</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I thought this is enough to</font>

1077
00:37:00,339 --> 00:37:04,359
get off to the<font color="#E5E5E5"> races and</font><font color="#CCCCCC"> get a good head</font>

1078
00:37:01,989 --> 00:37:05,409
start on when it<font color="#E5E5E5"> comes to testing these</font>

1079
00:37:04,359 --> 00:37:09,640
<font color="#E5E5E5">from a red team and blue team</font>

1080
00:37:05,409 --> 00:37:11,380
perspective<font color="#E5E5E5"> so closing comments please</font>

1081
00:37:09,640 --> 00:37:13,449
do<font color="#CCCCCC"> not run away</font><font color="#E5E5E5"> from PowerShell because</font>

1082
00:37:11,380 --> 00:37:14,979
a lot of<font color="#E5E5E5"> people</font><font color="#CCCCCC"> are saying</font><font color="#E5E5E5"> that there's</font>

1083
00:37:13,449 --> 00:37:17,319
so much good<font color="#E5E5E5"> that PowerShell can do and</font>

1084
00:37:14,979 --> 00:37:19,359
the logging and security features<font color="#CCCCCC"> that</font>

1085
00:37:17,319 --> 00:37:21,400
come with PowerShell<font color="#CCCCCC"> five</font><font color="#E5E5E5"> are insanely</font>

1086
00:37:19,359 --> 00:37:22,959
good<font color="#E5E5E5"> just so few people happen and I</font>

1087
00:37:21,400 --> 00:37:25,749
totally<font color="#E5E5E5"> realize that it produces a ton</font>

1088
00:37:22,959 --> 00:37:28,928
<font color="#CCCCCC">of logs</font><font color="#E5E5E5"> and there's some there's some</font>

1089
00:37:25,749 --> 00:37:31,058
research that<font color="#E5E5E5"> I'm working on to help to</font>

1090
00:37:28,929 --> 00:37:32,679
<font color="#E5E5E5">help make</font><font color="#CCCCCC"> available some some techniques</font>

1091
00:37:31,059 --> 00:37:33,939
<font color="#E5E5E5">as opposed</font><font color="#CCCCCC"> to meters saying hey</font><font color="#E5E5E5"> you</font>

1092
00:37:32,679 --> 00:37:35,739
should<font color="#E5E5E5"> look for like a lot of you</font><font color="#CCCCCC"> know</font>

1093
00:37:33,939 --> 00:37:38,109
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> characters and frequency</font>

1094
00:37:35,739 --> 00:37:39,130
analysis like like it would<font color="#CCCCCC"> be cool if</font>

1095
00:37:38,109 --> 00:37:41,199
<font color="#E5E5E5">there's an open source thing that</font>

1096
00:37:39,130 --> 00:37:42,299
actually<font color="#E5E5E5"> just did that</font><font color="#CCCCCC"> right so anyway</font>

1097
00:37:41,199 --> 00:37:44,619
hopefully<font color="#E5E5E5"> more on that later</font>

1098
00:37:42,299 --> 00:37:46,329
my message upgrade to<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> 5</font>

1099
00:37:44,619 --> 00:37:48,759
<font color="#E5E5E5">please even if you don't have the</font>

1100
00:37:46,329 --> 00:37:50,829
<font color="#CCCCCC">capacity to</font><font color="#E5E5E5"> look at the stuff like turn</font>

1101
00:37:48,759 --> 00:37:52,779
on<font color="#CCCCCC"> the logs aggregate the logs and if</font>

1102
00:37:50,829 --> 00:37:54,189
nothing<font color="#E5E5E5"> else</font><font color="#CCCCCC"> just set up a cron job and</font>

1103
00:37:52,779 --> 00:37:55,779
start graphing through for something

1104
00:37:54,189 --> 00:37:58,209
<font color="#CCCCCC">like we</font><font color="#E5E5E5"> all need to start somewhere</font><font color="#CCCCCC"> and</font>

1105
00:37:55,779 --> 00:37:59,349
<font color="#CCCCCC">get these small</font><font color="#E5E5E5"> wins and expand our</font>

1106
00:37:58,209 --> 00:38:01,328
<font color="#E5E5E5">detection to include more and more</font>

1107
00:37:59,349 --> 00:38:03,400
artifacts that we looked at on this list

1108
00:38:01,329 --> 00:38:05,079
<font color="#E5E5E5">and as always you'll hear me</font><font color="#CCCCCC"> talk about</font>

1109
00:38:03,400 --> 00:38:06,249
<font color="#E5E5E5">breaking our assumptions of</font><font color="#CCCCCC"> what we</font>

1110
00:38:05,079 --> 00:38:08,589
<font color="#CCCCCC">always thought</font><font color="#E5E5E5"> a cradle would look like</font>

1111
00:38:06,249 --> 00:38:10,029
and<font color="#E5E5E5"> again like what if notepads</font>

1112
00:38:08,589 --> 00:38:11,410
downloading the payload or<font color="#E5E5E5"> what</font><font color="#CCCCCC"> IE or</font>

1113
00:38:10,029 --> 00:38:13,660
<font color="#E5E5E5">something else is</font>

1114
00:38:11,410 --> 00:38:15,000
and how<font color="#CCCCCC"> would that how that bypass</font><font color="#E5E5E5"> some</font>

1115
00:38:13,660 --> 00:38:19,330
<font color="#E5E5E5">of our detection is today and how can we</font>

1116
00:38:15,000 --> 00:38:20,440
make changes<font color="#CCCCCC"> to not not</font><font color="#E5E5E5"> be bypassed and</font>

1117
00:38:19,330 --> 00:38:22,270
<font color="#E5E5E5">we need to accept we're going to miss</font>

1118
00:38:20,440 --> 00:38:23,380
stuff<font color="#E5E5E5"> we're all humans</font><font color="#CCCCCC"> and there's</font>

1119
00:38:22,270 --> 00:38:24,310
<font color="#E5E5E5">people</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> smarter than me that are</font>

1120
00:38:23,380 --> 00:38:26,050
<font color="#E5E5E5">doing stuff we've never even thought</font>

1121
00:38:24,310 --> 00:38:27,490
about<font color="#E5E5E5"> before</font><font color="#CCCCCC"> that hopefully</font><font color="#E5E5E5"> we'll</font><font color="#CCCCCC"> find</font>

1122
00:38:26,050 --> 00:38:30,250
<font color="#CCCCCC">an investigation at some point and</font><font color="#E5E5E5"> write</font>

1123
00:38:27,490 --> 00:38:32,020
a blog about or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> ultimately</font>

1124
00:38:30,250 --> 00:38:34,600
we can't expect<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to solve all</font>

1125
00:38:32,020 --> 00:38:36,370
<font color="#E5E5E5">this in one</font><font color="#CCCCCC"> fell swoop it takes time</font><font color="#E5E5E5"> it</font>

1126
00:38:34,600 --> 00:38:38,350
takes failing it takes repeated<font color="#E5E5E5"> tries</font>

1127
00:38:36,370 --> 00:38:40,240
and tries<font color="#CCCCCC"> again and the most beneficial</font>

1128
00:38:38,350 --> 00:38:42,160
thing that we can do is to<font color="#E5E5E5"> share both</font>

1129
00:38:40,240 --> 00:38:44,169
<font color="#E5E5E5">successes and more importantly failures</font>

1130
00:38:42,160 --> 00:38:47,339
with the community so<font color="#E5E5E5"> that we all get</font>

1131
00:38:44,170 --> 00:38:50,200
<font color="#E5E5E5">better together in forms just</font><font color="#CCCCCC"> like this</font>

1132
00:38:47,340 --> 00:38:52,690
so huge<font color="#E5E5E5"> huge thanks to</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> my</font>

1133
00:38:50,200 --> 00:38:55,210
colleagues<font color="#E5E5E5"> in particular</font><font color="#CCCCCC"> Nick Carr Ian</font>

1134
00:38:52,690 --> 00:38:58,330
on that<font color="#E5E5E5"> Dunwoody they they really make</font>

1135
00:38:55,210 --> 00:39:00,910
my job extremely<font color="#CCCCCC"> fun and make hunting</font>

1136
00:38:58,330 --> 00:39:02,020
just just unbelievably cool<font color="#CCCCCC"> Matt done</font>

1137
00:39:00,910 --> 00:39:03,910
<font color="#E5E5E5">what he's actually done some really cool</font>

1138
00:39:02,020 --> 00:39:05,380
stuff with<font color="#CCCCCC"> detecting this stuff in</font>

1139
00:39:03,910 --> 00:39:07,180
memory that's been<font color="#E5E5E5"> really really</font>

1140
00:39:05,380 --> 00:39:09,130
fascinating<font color="#CCCCCC"> to watch</font><font color="#E5E5E5"> I'd also like</font><font color="#CCCCCC"> to</font>

1141
00:39:07,180 --> 00:39:11,140
<font color="#E5E5E5">thank my colleague Evan Pena he's one of</font>

1142
00:39:09,130 --> 00:39:14,170
our<font color="#E5E5E5"> red team guys who undoubtedly</font>

1143
00:39:11,140 --> 00:39:15,609
performed the same level of QA on

1144
00:39:14,170 --> 00:39:17,380
several iterations of this<font color="#E5E5E5"> cradle so</font>

1145
00:39:15,610 --> 00:39:19,450
Evan big shout out<font color="#E5E5E5"> to</font><font color="#CCCCCC"> you and</font><font color="#E5E5E5"> then</font>

1146
00:39:17,380 --> 00:39:21,340
lastly<font color="#CCCCCC"> despite to thank my wife Paige</font>

1147
00:39:19,450 --> 00:39:23,200
because<font color="#E5E5E5"> she really supports me I'm in</font>

1148
00:39:21,340 --> 00:39:24,910
doing this<font color="#E5E5E5"> research and</font><font color="#CCCCCC"> went into</font>

1149
00:39:23,200 --> 00:39:26,169
hundreds and hundreds of hours<font color="#E5E5E5"> sitting</font>

1150
00:39:24,910 --> 00:39:28,180
at home in front of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> laptop doing this</font>

1151
00:39:26,170 --> 00:39:30,670
kind of<font color="#E5E5E5"> stuff at crazy hours into the</font>

1152
00:39:28,180 --> 00:39:32,740
night<font color="#E5E5E5"> it's not the most fun</font><font color="#CCCCCC"> for one</font>

1153
00:39:30,670 --> 00:39:34,840
thinker to sit and watch me do so I

1154
00:39:32,740 --> 00:39:38,919
really<font color="#CCCCCC"> do appreciate appreciate</font><font color="#E5E5E5"> that</font>

1155
00:39:34,840 --> 00:39:41,110
support<font color="#CCCCCC"> that was a lot of content</font><font color="#E5E5E5"> and I</font>

1156
00:39:38,920 --> 00:39:42,700
would like<font color="#E5E5E5"> to say that please reach out</font>

1157
00:39:41,110 --> 00:39:44,500
to<font color="#E5E5E5"> me</font><font color="#CCCCCC"> on Twitter and</font><font color="#E5E5E5"> I'll be around all</font>

1158
00:39:42,700 --> 00:39:45,549
day<font color="#E5E5E5"> today</font><font color="#CCCCCC"> be around tomorrow</font><font color="#E5E5E5"> as well so</font>

1159
00:39:44,500 --> 00:39:47,530
please<font color="#CCCCCC"> come talk to</font><font color="#E5E5E5"> me if you have any</font>

1160
00:39:45,550 --> 00:39:48,790
questions criticisms comments<font color="#E5E5E5"> I love to</font>

1161
00:39:47,530 --> 00:39:51,250
talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you and here you have to say and</font>

1162
00:39:48,790 --> 00:39:53,620
<font color="#CCCCCC">to the bottom of my heart I've had the</font>

1163
00:39:51,250 --> 00:39:55,510
<font color="#E5E5E5">best time in Poland</font><font color="#CCCCCC"> first time here</font>

1164
00:39:53,620 --> 00:39:57,609
<font color="#E5E5E5">often times</font><font color="#CCCCCC"> differences thank you very</font>

1165
00:39:55,510 --> 00:40:04,110
much for having<font color="#CCCCCC"> me</font>

1166
00:39:57,610 --> 00:40:04,260
[Applause]

1167
00:40:04,110 --> 00:40:07,409
you

1168
00:40:04,260 --> 00:40:07,409
[Applause]

