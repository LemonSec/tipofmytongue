1
00:00:01,850 --> 00:00:07,199
[Music]

2
00:00:07,200 --> 00:00:08,240
hi

3
00:00:08,240 --> 00:00:10,639
my name is rishi kesh and today we will

4
00:00:10,639 --> 00:00:13,120
try learn something about

5
00:00:13,120 --> 00:00:16,560
how one can sort cyber physical relevant

6
00:00:16,560 --> 00:00:19,680
binaries may be malicious maybe benign

7
00:00:19,680 --> 00:00:20,560
from

8
00:00:20,560 --> 00:00:23,119
from a lot of collection of we can say

9
00:00:23,119 --> 00:00:25,119
other binaries

10
00:00:25,119 --> 00:00:26,640
so

11
00:00:26,640 --> 00:00:27,920
yeah that's me

12
00:00:27,920 --> 00:00:31,039
i work at mandiant as a researcher

13
00:00:31,039 --> 00:00:33,760
most of the time

14
00:00:33,760 --> 00:00:35,440
okay yeah

15
00:00:35,440 --> 00:00:38,719
most of the times working on some

16
00:00:38,719 --> 00:00:41,600
on some terminal so please forgive me if

17
00:00:41,600 --> 00:00:43,840
there is some mystic on to onto

18
00:00:43,840 --> 00:00:45,680
presentation part i'm really not good at

19
00:00:45,680 --> 00:00:47,520
user interfaces

20
00:00:47,520 --> 00:00:51,120
and yeah i i love diving deeper into

21
00:00:51,120 --> 00:00:53,280
networks wireless data link layers

22
00:00:53,280 --> 00:00:55,760
memories uh formal methods

23
00:00:55,760 --> 00:00:58,000
and to some extent and yeah i'm big fan

24
00:00:58,000 --> 00:01:00,800
and small contributor of linux kernel so

25
00:01:00,800 --> 00:01:02,800
i try find

26
00:01:02,800 --> 00:01:05,280
security bugs in linux kernel and

27
00:01:05,280 --> 00:01:07,520
try to patch them upstream so far not so

28
00:01:07,520 --> 00:01:09,760
successful in doing that though

29
00:01:09,760 --> 00:01:11,520
so yes

30
00:01:11,520 --> 00:01:12,640
this slide

31
00:01:12,640 --> 00:01:14,080
there might be a question like why

32
00:01:14,080 --> 00:01:15,680
certainly this slide

33
00:01:15,680 --> 00:01:17,520
the reason being uh let me tell you some

34
00:01:17,520 --> 00:01:19,200
small story like how this whole thing

35
00:01:19,200 --> 00:01:20,240
begin

36
00:01:20,240 --> 00:01:22,159
i mean how this

37
00:01:22,159 --> 00:01:23,040
uh

38
00:01:23,040 --> 00:01:25,200
whole exploration began like when i

39
00:01:25,200 --> 00:01:27,119
started working in the cyber physical

40
00:01:27,119 --> 00:01:29,520
relevant threads research team in

41
00:01:29,520 --> 00:01:31,200
mandiant

42
00:01:31,200 --> 00:01:34,560
initially i i went ahead with the normal

43
00:01:34,560 --> 00:01:37,520
we can say normal flow of hunting

44
00:01:37,520 --> 00:01:40,400
specific binaries specific threats it's

45
00:01:40,400 --> 00:01:42,799
like apart from dark web onto onto

46
00:01:42,799 --> 00:01:46,079
various uh file aggregation engines

47
00:01:46,079 --> 00:01:47,040
uh

48
00:01:47,040 --> 00:01:49,040
there were like a lot of binaries so i

49
00:01:49,040 --> 00:01:51,840
did the typical search for say

50
00:01:51,840 --> 00:01:55,920
uh scara or say uh plc or something and

51
00:01:55,920 --> 00:01:58,399
and i got like you know thousands of uh

52
00:01:58,399 --> 00:02:00,240
results and written

53
00:02:00,240 --> 00:02:02,560
that was tricky to handle because

54
00:02:02,560 --> 00:02:04,240
that was not time efficient as well at

55
00:02:04,240 --> 00:02:06,079
resource efficient

56
00:02:06,079 --> 00:02:07,360
so

57
00:02:07,360 --> 00:02:10,160
i started drilling deeper and when i

58
00:02:10,160 --> 00:02:12,879
when i tried analyzing these all type of

59
00:02:12,879 --> 00:02:14,720
samples which were not

60
00:02:14,720 --> 00:02:17,360
so closely relevant to cyber physical

61
00:02:17,360 --> 00:02:19,200
systems yet had something to do with

62
00:02:19,200 --> 00:02:21,840
cyber physical systems they were obvious

63
00:02:21,840 --> 00:02:24,000
questions coming from the other end of

64
00:02:24,000 --> 00:02:24,800
the

65
00:02:24,800 --> 00:02:26,800
of the team like you know i'm part of

66
00:02:26,800 --> 00:02:28,480
research and there is another analysis

67
00:02:28,480 --> 00:02:30,560
team so they came up with a question

68
00:02:30,560 --> 00:02:32,400
saying okay you say this is cyber

69
00:02:32,400 --> 00:02:34,840
physical relevant binary why

70
00:02:34,840 --> 00:02:39,280
so while answering these questions i was

71
00:02:39,280 --> 00:02:40,959
fortunate enough to

72
00:02:40,959 --> 00:02:43,360
come up with certain selection criteria

73
00:02:43,360 --> 00:02:46,000
certain test of deductions which

74
00:02:46,000 --> 00:02:47,680
actually helped me

75
00:02:47,680 --> 00:02:48,480
uh

76
00:02:48,480 --> 00:02:51,120
we can say you know second my uh own

77
00:02:51,120 --> 00:02:53,760
opinion or my own thoughts saying okay

78
00:02:53,760 --> 00:02:56,080
these these these are the reasons that

79
00:02:56,080 --> 00:02:59,440
makes this particular executable file

80
00:02:59,440 --> 00:03:02,480
sample as cyber physical relevant so

81
00:03:02,480 --> 00:03:04,159
this whole talk is going to be around

82
00:03:04,159 --> 00:03:08,159
this uh excursion we can say

83
00:03:08,720 --> 00:03:11,920
yeah so coming back to the same slide ot

84
00:03:11,920 --> 00:03:13,360
malware

85
00:03:13,360 --> 00:03:17,040
back in 2010 stuxnet was uncovered we

86
00:03:17,040 --> 00:03:19,040
don't know before that how many years

87
00:03:19,040 --> 00:03:21,760
the stuxnet was

88
00:03:21,760 --> 00:03:24,159
in operation and was evolving

89
00:03:24,159 --> 00:03:26,640
now we are in 2022. if you see the

90
00:03:26,640 --> 00:03:27,680
numbers

91
00:03:27,680 --> 00:03:29,440
stuxnet 2010

92
00:03:29,440 --> 00:03:33,360
2014 black energy 2015 in destroyer 2016

93
00:03:33,360 --> 00:03:35,360
iron gate 2017

94
00:03:35,360 --> 00:03:37,040
triton and recently there was

95
00:03:37,040 --> 00:03:39,360
intercontroller

96
00:03:39,360 --> 00:03:42,400
one two three four five six

97
00:03:42,400 --> 00:03:45,360
twelve years and only six campaign

98
00:03:45,360 --> 00:03:48,239
honestly i was not convinced

99
00:03:48,239 --> 00:03:50,959
there must have been something huge

100
00:03:50,959 --> 00:03:54,000
number of things going on which we are

101
00:03:54,000 --> 00:03:55,120
missing

102
00:03:55,120 --> 00:03:57,760
maybe from detecting maybe from

103
00:03:57,760 --> 00:03:59,760
from some technical limitations or maybe

104
00:03:59,760 --> 00:04:01,439
something else

105
00:04:01,439 --> 00:04:04,560
so again my tests of deductions were my

106
00:04:04,560 --> 00:04:06,560
small contribution or rather are my

107
00:04:06,560 --> 00:04:08,560
small contribution to

108
00:04:08,560 --> 00:04:10,319
kind of you know come up with some

109
00:04:10,319 --> 00:04:12,080
bigger numbers here

110
00:04:12,080 --> 00:04:14,959
maybe in future but yes that's the whole

111
00:04:14,959 --> 00:04:15,760
thing

112
00:04:15,760 --> 00:04:18,478
so i believe this explains like why we

113
00:04:18,478 --> 00:04:20,880
need to understand more about

114
00:04:20,880 --> 00:04:23,840
ot binaries uh okay uh mythologies i

115
00:04:23,840 --> 00:04:25,840
didn't mention ot stands for operational

116
00:04:25,840 --> 00:04:29,840
technologies for those who are not aware

117
00:04:30,960 --> 00:04:33,440
yes this slide basically seconds this

118
00:04:33,440 --> 00:04:35,600
one just because there are five or six

119
00:04:35,600 --> 00:04:38,160
campaigns uncovered in last 12 years

120
00:04:38,160 --> 00:04:39,680
we are feeling happy okay there is

121
00:04:39,680 --> 00:04:41,199
something burning around but we at is

122
00:04:41,199 --> 00:04:42,639
bothered just because we are not aware

123
00:04:42,639 --> 00:04:45,840
of that particular thing right

124
00:04:46,880 --> 00:04:48,720
now let's come to the point why can't we

125
00:04:48,720 --> 00:04:52,080
find this particular type of samples

126
00:04:52,080 --> 00:04:54,840
while doing analysis onto onto various

127
00:04:54,840 --> 00:04:57,840
sandboxes manually static dynamic

128
00:04:57,840 --> 00:04:59,199
multiple things

129
00:04:59,199 --> 00:05:01,919
i've observed many things

130
00:05:01,919 --> 00:05:04,000
uh majority of the sandboxes that do

131
00:05:04,000 --> 00:05:05,440
analyze

132
00:05:05,440 --> 00:05:08,320
malware so that matter

133
00:05:08,320 --> 00:05:11,919
they have certain preset rules available

134
00:05:11,919 --> 00:05:12,960
and

135
00:05:12,960 --> 00:05:14,880
excuse me

136
00:05:14,880 --> 00:05:16,960
many of the times the cyber physical

137
00:05:16,960 --> 00:05:19,520
relevant binaries were flagged legit

138
00:05:19,520 --> 00:05:21,360
cyber physical relevant binaries were

139
00:05:21,360 --> 00:05:23,919
flagged as malicious just because they

140
00:05:23,919 --> 00:05:25,840
were doing something

141
00:05:25,840 --> 00:05:27,199
which was

142
00:05:27,199 --> 00:05:29,120
which was defeating the rules there or

143
00:05:29,120 --> 00:05:30,720
which was basically going against the

144
00:05:30,720 --> 00:05:33,360
rules into the sandboxes

145
00:05:33,360 --> 00:05:34,960
that base yeah that was one of the

146
00:05:34,960 --> 00:05:37,520
earlier days when i i tried showing in

147
00:05:37,520 --> 00:05:39,759
almost every other binary

148
00:05:39,759 --> 00:05:41,919
which was having some similarity to

149
00:05:41,919 --> 00:05:43,600
cyber physical relevance

150
00:05:43,600 --> 00:05:47,280
and i got like you know a number of uh

151
00:05:47,280 --> 00:05:49,759
wrongly reported behaviors from

152
00:05:49,759 --> 00:05:51,199
sandboxes

153
00:05:51,199 --> 00:05:52,720
so that was one thing

154
00:05:52,720 --> 00:05:54,880
another thing low visibility into ot

155
00:05:54,880 --> 00:05:57,520
systems yes this is one of really really

156
00:05:57,520 --> 00:06:00,479
big thing reason being

157
00:06:00,720 --> 00:06:03,440
the the softwares that we use in ot

158
00:06:03,440 --> 00:06:05,120
they are custom made

159
00:06:05,120 --> 00:06:08,000
so obviously just by doing a search on

160
00:06:08,000 --> 00:06:10,080
on any search engine we don't get a lot

161
00:06:10,080 --> 00:06:12,080
of information related to that software

162
00:06:12,080 --> 00:06:13,919
neither the software as well

163
00:06:13,919 --> 00:06:15,759
other part of the story is like even if

164
00:06:15,759 --> 00:06:17,280
you get a part of software there are

165
00:06:17,280 --> 00:06:18,479
multiple

166
00:06:18,479 --> 00:06:21,600
uh we can say parts you need to

167
00:06:21,600 --> 00:06:24,400
recombine and then the actual executable

168
00:06:24,400 --> 00:06:25,840
will trigger

169
00:06:25,840 --> 00:06:29,199
plus these things are super expensive

170
00:06:29,199 --> 00:06:32,240
the the typical operational technology

171
00:06:32,240 --> 00:06:35,039
setups including hardware and software

172
00:06:35,039 --> 00:06:36,880
they are super expensive that makes them

173
00:06:36,880 --> 00:06:38,639
a little less prevalent on to internet

174
00:06:38,639 --> 00:06:39,680
we can say

175
00:06:39,680 --> 00:06:41,680
uh when i say internet for searching

176
00:06:41,680 --> 00:06:43,680
purpose

177
00:06:43,680 --> 00:06:45,520
so i'm not talking about

178
00:06:45,520 --> 00:06:47,520
search or something

179
00:06:47,520 --> 00:06:49,680
the third thing few motivated actors so

180
00:06:49,680 --> 00:06:53,360
far yes there were not many uh

181
00:06:53,360 --> 00:06:55,199
actors who were interested in cyber

182
00:06:55,199 --> 00:06:56,960
physical

183
00:06:56,960 --> 00:07:00,720
relevant targets the reason being

184
00:07:00,720 --> 00:07:02,479
somebody or other majority of actors

185
00:07:02,479 --> 00:07:05,360
they wanted something in written so

186
00:07:05,360 --> 00:07:07,680
voter systems were not really targeted

187
00:07:07,680 --> 00:07:10,960
by them because of obvious not much of a

188
00:07:10,960 --> 00:07:12,160
we can say

189
00:07:12,160 --> 00:07:14,639
um a read on investment type of thing

190
00:07:14,639 --> 00:07:17,599
happening there uh yes the last one not

191
00:07:17,599 --> 00:07:20,160
documented or undetected yes as i said

192
00:07:20,160 --> 00:07:22,000
already like you know

193
00:07:22,000 --> 00:07:22,800
uh

194
00:07:22,800 --> 00:07:24,960
these things i mean the cyber physical

195
00:07:24,960 --> 00:07:27,680
relevant softwares and hardwares

196
00:07:27,680 --> 00:07:30,400
are a little less prevalent on internet

197
00:07:30,400 --> 00:07:33,599
to search or to download we can say

198
00:07:33,599 --> 00:07:35,919
and when i say not not documented and

199
00:07:35,919 --> 00:07:39,039
undetected reason being uh

200
00:07:39,039 --> 00:07:40,560
suppose there is a custom protocol

201
00:07:40,560 --> 00:07:42,960
written for say a very specific

202
00:07:42,960 --> 00:07:44,560
functionality

203
00:07:44,560 --> 00:07:46,080
for example

204
00:07:46,080 --> 00:07:48,160
operating a

205
00:07:48,160 --> 00:07:50,080
sugar cane juice

206
00:07:50,080 --> 00:07:52,319
mechanism for example

207
00:07:52,319 --> 00:07:54,160
so we won't find any specific

208
00:07:54,160 --> 00:07:56,240
documentation how the protocol was

209
00:07:56,240 --> 00:07:58,160
written which protocol was used and how

210
00:07:58,160 --> 00:08:00,479
that was passed on to the other side of

211
00:08:00,479 --> 00:08:02,560
the sensor network

212
00:08:02,560 --> 00:08:04,960
so obviously if we try to target that

213
00:08:04,960 --> 00:08:07,039
particular type of uh

214
00:08:07,039 --> 00:08:08,800
setup that is going to be challenged

215
00:08:08,800 --> 00:08:11,520
because nothing is available

216
00:08:11,520 --> 00:08:13,039
so that makes it

217
00:08:13,039 --> 00:08:15,599
whole operational technology we can say

218
00:08:15,599 --> 00:08:17,360
a little

219
00:08:17,360 --> 00:08:21,360
uh little difficult to detect

220
00:08:21,440 --> 00:08:25,560
so let's begin the search

221
00:08:26,960 --> 00:08:28,879
some basic graphic understanding of what

222
00:08:28,879 --> 00:08:32,479
exactly ot is and where exactly it sits

223
00:08:32,479 --> 00:08:34,880
into our whole internet architecture or

224
00:08:34,880 --> 00:08:38,559
for that matter ict

225
00:08:38,719 --> 00:08:40,880
majority of the times ot is sitting in

226
00:08:40,880 --> 00:08:43,599
between your uh

227
00:08:43,599 --> 00:08:46,560
normal network and a specific network

228
00:08:46,560 --> 00:08:48,720
people say like okay we have our ot

229
00:08:48,720 --> 00:08:51,440
setup which is completely isolated from

230
00:08:51,440 --> 00:08:53,760
internet but then the fact is

231
00:08:53,760 --> 00:08:56,320
the the machine operator was able to

232
00:08:56,320 --> 00:08:57,360
access

233
00:08:57,360 --> 00:09:00,160
uh some of his emails which was supposed

234
00:09:00,160 --> 00:09:02,399
to be only operated from internet so

235
00:09:02,399 --> 00:09:04,080
that way there was there was some access

236
00:09:04,080 --> 00:09:06,480
on such system so

237
00:09:06,480 --> 00:09:08,640
that is why there is an overlap between

238
00:09:08,640 --> 00:09:10,560
normal operating

239
00:09:10,560 --> 00:09:14,560
environment and od operating environment

240
00:09:15,680 --> 00:09:18,000
yes so coming back to the same question

241
00:09:18,000 --> 00:09:19,600
again and again

242
00:09:19,600 --> 00:09:22,399
what we see here is self-explanatory i

243
00:09:22,399 --> 00:09:25,519
would say what in a normal site what we

244
00:09:25,519 --> 00:09:28,160
used to what we perceive as as a normal

245
00:09:28,160 --> 00:09:29,519
activity

246
00:09:29,519 --> 00:09:31,360
is actually

247
00:09:31,360 --> 00:09:33,839
kind of really tricky activity to be

248
00:09:33,839 --> 00:09:35,200
considered

249
00:09:35,200 --> 00:09:37,680
in case of malicious behavior

250
00:09:37,680 --> 00:09:39,519
the graphic says it all i think i

251
00:09:39,519 --> 00:09:40,240
shouldn't

252
00:09:40,240 --> 00:09:41,519
i shouldn't say

253
00:09:41,519 --> 00:09:44,080
anything beyond that

254
00:09:44,080 --> 00:09:46,959
so yes

255
00:09:46,959 --> 00:09:49,920
we need legit ot binaries for for

256
00:09:49,920 --> 00:09:51,200
various things

257
00:09:51,200 --> 00:09:53,200
but then again

258
00:09:53,200 --> 00:09:55,760
what is the problem here

259
00:09:55,760 --> 00:09:57,360
as as we have already discussed no

260
00:09:57,360 --> 00:09:59,760
documentation available for them

261
00:09:59,760 --> 00:10:02,160
uh for for multiple reasons

262
00:10:02,160 --> 00:10:04,800
and cryptic and unique behavior so here

263
00:10:04,800 --> 00:10:06,959
when i say cryptic and unique behaviors

264
00:10:06,959 --> 00:10:08,640
uh let me give you an example say

265
00:10:08,640 --> 00:10:11,680
suppose there is a there is a modus

266
00:10:11,680 --> 00:10:13,760
protocol implementation it is speaking

267
00:10:13,760 --> 00:10:14,480
to

268
00:10:14,480 --> 00:10:17,440
some server and some client

269
00:10:17,440 --> 00:10:19,920
uh the server is sitting somewhere

270
00:10:19,920 --> 00:10:22,959
outside the uh sorry so the client is

271
00:10:22,959 --> 00:10:24,880
sitting somewhere outside the

272
00:10:24,880 --> 00:10:26,399
normal network periphery but is

273
00:10:26,399 --> 00:10:28,640
connected to the network

274
00:10:28,640 --> 00:10:30,720
my typical malware sandbox will say okay

275
00:10:30,720 --> 00:10:32,160
there is some p cap being generated

276
00:10:32,160 --> 00:10:33,760
because of so and so traffic that's

277
00:10:33,760 --> 00:10:35,600
happening between client and server

278
00:10:35,600 --> 00:10:37,839
server sitting inside gives a red flag

279
00:10:37,839 --> 00:10:40,079
saying okay this is something tricky

280
00:10:40,079 --> 00:10:41,760
happening some compromise or something

281
00:10:41,760 --> 00:10:43,120
of that sort

282
00:10:43,120 --> 00:10:45,279
but is it really so no because that's

283
00:10:45,279 --> 00:10:47,600
the typical implementation of we can say

284
00:10:47,600 --> 00:10:50,640
modbus protocol per se

285
00:10:50,640 --> 00:10:52,720
close source development yes many of the

286
00:10:52,720 --> 00:10:54,399
times even if we get some particular

287
00:10:54,399 --> 00:10:57,360
binary to analyze it is strict one you

288
00:10:57,360 --> 00:11:00,959
won't find any debug symbols so

289
00:11:00,959 --> 00:11:02,880
a little more difficult basically to

290
00:11:02,880 --> 00:11:04,720
analyze them

291
00:11:04,720 --> 00:11:06,880
uh yes again like specific to

292
00:11:06,880 --> 00:11:09,279
proprietary and private devices as i

293
00:11:09,279 --> 00:11:11,200
have already told these are

294
00:11:11,200 --> 00:11:13,120
custom made things like you know

295
00:11:13,120 --> 00:11:15,040
specifically built for a specific

296
00:11:15,040 --> 00:11:16,000
purpose

297
00:11:16,000 --> 00:11:17,040
so

298
00:11:17,040 --> 00:11:19,040
tricky

299
00:11:19,040 --> 00:11:21,360
yes i have already discussed uh usually

300
00:11:21,360 --> 00:11:24,160
distributed in parts

301
00:11:24,160 --> 00:11:26,000
the last two points are more interesting

302
00:11:26,000 --> 00:11:28,320
one huge variety of manufacturers and

303
00:11:28,320 --> 00:11:30,800
devices and more functions more codes

304
00:11:30,800 --> 00:11:32,240
more secrets

305
00:11:32,240 --> 00:11:33,040
so

306
00:11:33,040 --> 00:11:34,880
um

307
00:11:34,880 --> 00:11:36,959
so so for one particular functionality

308
00:11:36,959 --> 00:11:39,279
or for maybe one particular purpose if a

309
00:11:39,279 --> 00:11:41,440
person decides not to

310
00:11:41,440 --> 00:11:44,160
buy something which is readily available

311
00:11:44,160 --> 00:11:46,640
in the market they'll go and you know

312
00:11:46,640 --> 00:11:48,640
develop that thing on their own

313
00:11:48,640 --> 00:11:50,480
custom hardwares

314
00:11:50,480 --> 00:11:52,800
that makes it you know

315
00:11:52,800 --> 00:11:55,120
makes it more easy sometimes to develop

316
00:11:55,120 --> 00:11:57,200
such things and that makes it

317
00:11:57,200 --> 00:11:59,680
uh the number of

318
00:11:59,680 --> 00:12:01,760
such implementations

319
00:12:01,760 --> 00:12:04,000
that keeps growing just because of uh

320
00:12:04,000 --> 00:12:07,200
similar things

321
00:12:07,839 --> 00:12:10,240
so where exactly can we find these all

322
00:12:10,240 --> 00:12:13,279
uh ot binaries first thing is

323
00:12:13,279 --> 00:12:15,519
aggregation engines file aggregation

324
00:12:15,519 --> 00:12:17,760
engines like you know malware analysis

325
00:12:17,760 --> 00:12:19,279
platforms

326
00:12:19,279 --> 00:12:20,160
uh

327
00:12:20,160 --> 00:12:22,800
ot users or manufacturers i found many

328
00:12:22,800 --> 00:12:24,800
of such samples in their discussion

329
00:12:24,800 --> 00:12:26,880
forums so like usually there is somebody

330
00:12:26,880 --> 00:12:28,720
complaining about okay i'm trying to run

331
00:12:28,720 --> 00:12:31,120
so and so exe and i'm not getting so and

332
00:12:31,120 --> 00:12:34,160
so uh since the data or so and so

333
00:12:34,160 --> 00:12:37,120
uh client data how to how to go ahead

334
00:12:37,120 --> 00:12:39,040
and then at many places i have found the

335
00:12:39,040 --> 00:12:40,959
person actually mentioning

336
00:12:40,959 --> 00:12:43,760
every minute detail about the executable

337
00:12:43,760 --> 00:12:45,200
he is trying to trigger

338
00:12:45,200 --> 00:12:47,360
including his credentials

339
00:12:47,360 --> 00:12:50,160
so that was again really tricky thing

340
00:12:50,160 --> 00:12:52,399
and in-house collection yes so that was

341
00:12:52,399 --> 00:12:53,360
something

342
00:12:53,360 --> 00:12:54,240
uh

343
00:12:54,240 --> 00:12:56,240
we have been trying to do

344
00:12:56,240 --> 00:12:58,720
uh with the with the help of some

345
00:12:58,720 --> 00:13:01,440
some company or with the help of some uh

346
00:13:01,440 --> 00:13:03,839
vendors

347
00:13:05,279 --> 00:13:07,600
so that was a lot of theory lot of

348
00:13:07,600 --> 00:13:10,240
boring thing let's go to tests of

349
00:13:10,240 --> 00:13:12,240
deduction

350
00:13:12,240 --> 00:13:15,839
so far i was able to uh come up with

351
00:13:15,839 --> 00:13:19,040
these many criterias one two three four

352
00:13:19,040 --> 00:13:20,880
eight in number

353
00:13:20,880 --> 00:13:22,880
uh they are not just 18 number they

354
00:13:22,880 --> 00:13:24,399
could be many more

355
00:13:24,399 --> 00:13:26,399
or could be reduced or compressed to

356
00:13:26,399 --> 00:13:28,959
something small as well

357
00:13:28,959 --> 00:13:31,760
so uh these are this these are some of

358
00:13:31,760 --> 00:13:33,760
the types of deduction for

359
00:13:33,760 --> 00:13:34,480
for

360
00:13:34,480 --> 00:13:35,279
for

361
00:13:35,279 --> 00:13:37,920
maybe a threat researcher or a

362
00:13:37,920 --> 00:13:39,519
stock analyst to

363
00:13:39,519 --> 00:13:42,480
to determine if the binary in question

364
00:13:42,480 --> 00:13:45,040
is cyber physical relevant is actually

365
00:13:45,040 --> 00:13:48,639
having some cyber physical relevant

366
00:13:49,120 --> 00:13:51,839
content or not

367
00:13:58,160 --> 00:14:00,399
so let's look at them one by one static

368
00:14:00,399 --> 00:14:03,600
strings very basic approach

369
00:14:03,600 --> 00:14:06,240
most of the windows and linux

370
00:14:06,240 --> 00:14:09,040
systems are equipped with those commands

371
00:14:09,040 --> 00:14:10,720
as you can see here i have just run the

372
00:14:10,720 --> 00:14:12,720
binary with strings as a command and

373
00:14:12,720 --> 00:14:14,240
have seen

374
00:14:14,240 --> 00:14:16,959
some interesting keywords uh coming up

375
00:14:16,959 --> 00:14:17,920
into the

376
00:14:17,920 --> 00:14:20,399
uh into the uh terminal say like you

377
00:14:20,399 --> 00:14:24,160
know plc station number very specific uh

378
00:14:24,160 --> 00:14:28,000
occurrence from from modbus perspective

379
00:14:28,000 --> 00:14:30,800
so a small demo i actually wanted to

380
00:14:30,800 --> 00:14:34,480
show you live demo but my

381
00:14:34,480 --> 00:14:36,880
demo machine basically got crashed so i

382
00:14:36,880 --> 00:14:39,760
have some pre-recorded demo here to show

383
00:14:39,760 --> 00:14:42,760
you

384
00:14:44,000 --> 00:14:46,560
so it's it's the same strings command

385
00:14:46,560 --> 00:14:50,079
that i'm running over a specific

386
00:14:50,079 --> 00:14:52,399
file you could see it it dropped

387
00:14:52,399 --> 00:14:54,800
everything available on to that file as

388
00:14:54,800 --> 00:14:58,359
uh text

389
00:14:58,800 --> 00:14:59,600
yeah

390
00:14:59,600 --> 00:15:01,120
so you could see couple of entries there

391
00:15:01,120 --> 00:15:03,040
mentioning plc's

392
00:15:03,040 --> 00:15:05,680
and and these are from the binaries so

393
00:15:05,680 --> 00:15:08,399
something that can be used as a one of

394
00:15:08,399 --> 00:15:10,560
the convincing factor that the binary

395
00:15:10,560 --> 00:15:12,079
under

396
00:15:12,079 --> 00:15:14,319
under

397
00:15:14,639 --> 00:15:16,880
examination is cyber physical relevant

398
00:15:16,880 --> 00:15:19,680
one another thing that was like status

399
00:15:19,680 --> 00:15:22,160
rings which were available onto

400
00:15:22,160 --> 00:15:24,720
or into the executable another one is

401
00:15:24,720 --> 00:15:27,519
from dynamic strings so here we

402
00:15:27,519 --> 00:15:31,360
try to do some formal methods uh

403
00:15:31,360 --> 00:15:33,360
related work there's actually a tool

404
00:15:33,360 --> 00:15:35,519
called slos and we have used that tool

405
00:15:35,519 --> 00:15:37,279
to kind of you know carve some of the

406
00:15:37,279 --> 00:15:41,519
such sums of strings from

407
00:15:41,519 --> 00:15:43,600
from memory as well

408
00:15:43,600 --> 00:15:46,320
so let's see a demo for that

409
00:15:46,320 --> 00:15:49,320
too

410
00:15:57,440 --> 00:15:58,720
you could see that i have used a tool

411
00:15:58,720 --> 00:16:00,880
called floss so everything that you

412
00:16:00,880 --> 00:16:02,800
would see in the demos is available

413
00:16:02,800 --> 00:16:05,360
online and is open source

414
00:16:05,360 --> 00:16:08,000
so there is nothing uh something

415
00:16:08,000 --> 00:16:11,600
enterprise thing that i'm using here

416
00:16:19,279 --> 00:16:20,800
now if you just compare these two

417
00:16:20,800 --> 00:16:23,040
outcomes the first one is from the

418
00:16:23,040 --> 00:16:25,680
dynamic strings outcome and second one

419
00:16:25,680 --> 00:16:27,920
is static strings you could see dynamic

420
00:16:27,920 --> 00:16:30,320
strings actually spelled couple of more

421
00:16:30,320 --> 00:16:32,240
interesting

422
00:16:32,240 --> 00:16:34,880
entries there

423
00:16:35,120 --> 00:16:38,000
yes so this is something which will

424
00:16:38,000 --> 00:16:40,399
actually convince us in little more

425
00:16:40,399 --> 00:16:42,639
depths that whatever the binary that we

426
00:16:42,639 --> 00:16:44,399
are trying to analyze is cyber physical

427
00:16:44,399 --> 00:16:46,480
relevant here we are trying to

428
00:16:46,480 --> 00:16:47,279
uh

429
00:16:47,279 --> 00:16:49,600
drill a little deeper and understand if

430
00:16:49,600 --> 00:16:51,920
if there is any presence of a

431
00:16:51,920 --> 00:16:54,480
very specific function which is dealing

432
00:16:54,480 --> 00:16:55,680
with

433
00:16:55,680 --> 00:16:57,120
which is dealing with cyber physical

434
00:16:57,120 --> 00:16:58,720
systems

435
00:16:58,720 --> 00:16:59,920
so

436
00:16:59,920 --> 00:17:02,720
so i have used here a tool called getra

437
00:17:02,720 --> 00:17:04,640
again openly available

438
00:17:04,640 --> 00:17:06,559
for reverse engineering

439
00:17:06,559 --> 00:17:08,240
or actually it's not reverse engineering

440
00:17:08,240 --> 00:17:12,079
it's just exploring the things around

441
00:17:16,959 --> 00:17:20,000
so let's begin okay so in this

442
00:17:20,000 --> 00:17:22,079
particular uh

443
00:17:22,079 --> 00:17:24,720
video i'm showing usage of r2 that's

444
00:17:24,720 --> 00:17:26,400
actually radar a2

445
00:17:26,400 --> 00:17:28,640
another openly available

446
00:17:28,640 --> 00:17:32,200
debugger and disassembler

447
00:17:32,400 --> 00:17:34,480
so and purposely i have written the name

448
00:17:34,480 --> 00:17:36,960
of file as modbus plc so that we will uh

449
00:17:36,960 --> 00:17:38,480
have some understanding about what

450
00:17:38,480 --> 00:17:41,039
exactly we are trying to target so i

451
00:17:41,039 --> 00:17:43,440
have just run uh i i as a command and i

452
00:17:43,440 --> 00:17:45,039
have seen like you know a lot many

453
00:17:45,039 --> 00:17:46,720
functions and other calls

454
00:17:46,720 --> 00:17:48,400
uh making

455
00:17:48,400 --> 00:17:50,960
uh making a presence here that again is

456
00:17:50,960 --> 00:17:53,120
something really tricky to go one by one

457
00:17:53,120 --> 00:17:54,640
so i tried c

458
00:17:54,640 --> 00:17:57,200
if something of this sword is happening

459
00:17:57,200 --> 00:17:59,679
before going for the oh sorry i just

460
00:17:59,679 --> 00:18:02,720
missed it it seems

461
00:18:06,799 --> 00:18:09,799
okay

462
00:18:21,120 --> 00:18:23,520
yeah before going further i wanted oh

463
00:18:23,520 --> 00:18:26,520
sorry

464
00:18:29,440 --> 00:18:31,360
yes i wanted to share something about

465
00:18:31,360 --> 00:18:34,080
this particular open thing so why did i

466
00:18:34,080 --> 00:18:36,720
try and search open as a keyword into

467
00:18:36,720 --> 00:18:39,280
this whole functional or api

468
00:18:39,280 --> 00:18:41,600
uh calls which were being recorded or

469
00:18:41,600 --> 00:18:42,400
rather

470
00:18:42,400 --> 00:18:46,320
being analyzed by r2 radar a2

471
00:18:46,320 --> 00:18:47,840
for all of the operating systems in the

472
00:18:47,840 --> 00:18:50,000
world that we use so far

473
00:18:50,000 --> 00:18:53,840
everything that we read or write from is

474
00:18:53,840 --> 00:18:55,600
a file

475
00:18:55,600 --> 00:18:57,840
no matter if that is actually a file or

476
00:18:57,840 --> 00:18:59,600
if that is a device

477
00:18:59,600 --> 00:19:02,720
so this was actually an approach where i

478
00:19:02,720 --> 00:19:03,919
i tried

479
00:19:03,919 --> 00:19:06,240
uh see if if

480
00:19:06,240 --> 00:19:09,280
the binary in in its context is trying

481
00:19:09,280 --> 00:19:11,200
to reach out to a specific device and

482
00:19:11,200 --> 00:19:13,200
the best way to find that is

483
00:19:13,200 --> 00:19:15,280
see if there is any open call available

484
00:19:15,280 --> 00:19:18,000
or open file call available specifically

485
00:19:18,000 --> 00:19:19,919
that way i'll be able to understand if

486
00:19:19,919 --> 00:19:22,160
there is anything which is

487
00:19:22,160 --> 00:19:25,360
uh which is which is actually you know

488
00:19:25,360 --> 00:19:26,880
if there is any functionality which is

489
00:19:26,880 --> 00:19:29,520
trying to reach out to some hardware or

490
00:19:29,520 --> 00:19:32,640
some virtual device or some sensor

491
00:19:32,640 --> 00:19:34,480
uh outside the binary

492
00:19:34,480 --> 00:19:36,400
so was the reason of that particular

493
00:19:36,400 --> 00:19:37,360
search

494
00:19:37,360 --> 00:19:38,559
open

495
00:19:38,559 --> 00:19:40,080
and you could see that the first entry

496
00:19:40,080 --> 00:19:43,678
there that say is open file

497
00:19:43,840 --> 00:19:44,559
ah

498
00:19:44,559 --> 00:19:46,720
i think i reset

499
00:19:46,720 --> 00:19:50,120
the full

500
00:19:58,880 --> 00:20:02,440
just a second

501
00:20:18,840 --> 00:20:21,840
yeah so now i'm trying to search for

502
00:20:21,840 --> 00:20:24,320
open as a keyword into the

503
00:20:24,320 --> 00:20:25,840
list of available

504
00:20:25,840 --> 00:20:28,720
calls you can say

505
00:20:30,080 --> 00:20:32,559
now let's try digging deeper into the

506
00:20:32,559 --> 00:20:35,760
first entry that is open file and see if

507
00:20:35,760 --> 00:20:40,200
something of interest could be found

508
00:20:49,520 --> 00:20:53,360
yeah again we got two entries in there

509
00:20:53,760 --> 00:20:55,919
so i'll try and drill deeper into the

510
00:20:55,919 --> 00:21:00,520
first entry out of the out of the twos

511
00:21:02,640 --> 00:21:04,480
something interesting was shown there

512
00:21:04,480 --> 00:21:06,720
sim dot modbus.txt something something

513
00:21:06,720 --> 00:21:09,520
something but again not much much of the

514
00:21:09,520 --> 00:21:12,080
uh convincing power it has so far

515
00:21:12,080 --> 00:21:14,640
so i'll try seek that particular

516
00:21:14,640 --> 00:21:15,600
address

517
00:21:15,600 --> 00:21:17,440
and see if something could be found

518
00:21:17,440 --> 00:21:19,600
there

519
00:21:19,840 --> 00:21:22,080
yes

520
00:21:22,640 --> 00:21:25,120
bingo

521
00:21:25,200 --> 00:21:26,400
ah

522
00:21:26,400 --> 00:21:28,080
here

523
00:21:28,080 --> 00:21:31,520
string error accessing coil register

524
00:21:31,520 --> 00:21:34,000
address field

525
00:21:34,000 --> 00:21:37,440
this is a very specific description

526
00:21:37,440 --> 00:21:40,640
uh of behavior of modbus relevant

527
00:21:40,640 --> 00:21:43,679
binaries this gives me a

528
00:21:43,679 --> 00:21:46,000
proper proof or an evidence that the

529
00:21:46,000 --> 00:21:48,240
binary that i'm trying to analyze is

530
00:21:48,240 --> 00:21:50,559
cyber physical relevant one

531
00:21:50,559 --> 00:21:54,918
now let's go to another demo

532
00:22:02,640 --> 00:22:04,400
let me just

533
00:22:04,400 --> 00:22:08,840
quickly fold it

534
00:22:13,280 --> 00:22:15,520
oh

535
00:22:16,240 --> 00:22:19,919
sorry it was not highlighted earlier

536
00:22:19,919 --> 00:22:24,120
ah same thing was repeating

537
00:22:26,480 --> 00:22:28,640
okay now we'll we'll try to see the same

538
00:22:28,640 --> 00:22:32,559
demo from uh gidra

539
00:22:37,760 --> 00:22:40,480
i'll just skip some first

540
00:22:40,480 --> 00:22:42,080
steps here

541
00:22:42,080 --> 00:22:45,439
so that we could expediate

542
00:22:51,280 --> 00:22:53,840
yeah so here as well i was i was trying

543
00:22:53,840 --> 00:22:55,600
search find the presence of cyber

544
00:22:55,600 --> 00:22:57,840
physical relevant functionalities

545
00:22:57,840 --> 00:22:59,520
and

546
00:22:59,520 --> 00:23:02,400
yes like every other lazy person i i

547
00:23:02,400 --> 00:23:04,640
tried search interesting strings

548
00:23:04,640 --> 00:23:06,480
interesting functions

549
00:23:06,480 --> 00:23:08,320
uh using some of gydra's inbuilt

550
00:23:08,320 --> 00:23:09,919
capabilities here

551
00:23:09,919 --> 00:23:12,480
so this particular thing filter i later

552
00:23:12,480 --> 00:23:15,039
discovered that can actually be used to

553
00:23:15,039 --> 00:23:17,440
to search some interesting functions as

554
00:23:17,440 --> 00:23:20,440
well

555
00:23:22,080 --> 00:23:24,880
so this world uh video

556
00:23:24,880 --> 00:23:27,120
is is not only about success of how did

557
00:23:27,120 --> 00:23:29,120
i find something but is also about the

558
00:23:29,120 --> 00:23:31,200
failures how how i could not find

559
00:23:31,200 --> 00:23:34,200
something

560
00:23:38,799 --> 00:23:40,799
so like for coil there was no

561
00:23:40,799 --> 00:23:42,320
interesting thing i could find in the

562
00:23:42,320 --> 00:23:45,639
symbol tree

563
00:23:52,159 --> 00:23:54,320
so then i resorted to

564
00:23:54,320 --> 00:23:57,120
another search

565
00:24:01,919 --> 00:24:04,799
yes so here i got some interesting

566
00:24:04,799 --> 00:24:07,679
instances like lplc strings

567
00:24:07,679 --> 00:24:09,200
and and

568
00:24:09,200 --> 00:24:10,720
the other one which was like from

569
00:24:10,720 --> 00:24:13,720
ifcons.h

570
00:24:25,440 --> 00:24:26,480
yes

571
00:24:26,480 --> 00:24:28,320
this was the again concrete evidence i

572
00:24:28,320 --> 00:24:31,279
was able to establish if it is plc that

573
00:24:31,279 --> 00:24:34,240
i am dealing with into a particular

574
00:24:34,240 --> 00:24:36,559
sample

575
00:24:38,640 --> 00:24:41,039
and then resorting to typical string

576
00:24:41,039 --> 00:24:45,279
search including pascal strings as well

577
00:24:45,520 --> 00:24:47,360
and then filtering those search for very

578
00:24:47,360 --> 00:24:50,879
specific keywords

579
00:24:55,679 --> 00:24:56,880
yeah

580
00:24:56,880 --> 00:24:58,720
as we could see like you know plc

581
00:24:58,720 --> 00:25:01,360
station number again very unique uh

582
00:25:01,360 --> 00:25:02,799
occurrence

583
00:25:02,799 --> 00:25:03,760
for

584
00:25:03,760 --> 00:25:08,000
for cyber physical relevance i would say

585
00:25:13,679 --> 00:25:15,840
yeah

586
00:25:15,840 --> 00:25:19,360
okay so there are a couple of more

587
00:25:20,559 --> 00:25:22,640
similar thing i tried with modbus modbus

588
00:25:22,640 --> 00:25:24,559
tcp cybers

589
00:25:24,559 --> 00:25:26,240
spa bus

590
00:25:26,240 --> 00:25:28,799
lib iec 61850

591
00:25:28,799 --> 00:25:30,640
goose

592
00:25:30,640 --> 00:25:33,520
goes over tcp as well

593
00:25:33,520 --> 00:25:35,600
we will go to we will go through each of

594
00:25:35,600 --> 00:25:38,159
them one by one

595
00:25:38,159 --> 00:25:39,919
so yeah now we have got another proof

596
00:25:39,919 --> 00:25:41,360
that whatever we are dealing with is

597
00:25:41,360 --> 00:25:43,039
again having functionality specific to

598
00:25:43,039 --> 00:25:46,240
modbus tcp as well

599
00:25:53,039 --> 00:25:57,039
okay so there is some serial uh

600
00:25:57,039 --> 00:25:59,919
protocol involved eth stands for maybe

601
00:25:59,919 --> 00:26:01,279
ethernet

602
00:26:01,279 --> 00:26:03,200
so this was just like you know some some

603
00:26:03,200 --> 00:26:06,320
set of explorations

604
00:26:06,400 --> 00:26:09,400
okay

605
00:26:10,400 --> 00:26:12,320
i i won't be able to show demo on this

606
00:26:12,320 --> 00:26:14,880
particular slide uh fuzzy hash or import

607
00:26:14,880 --> 00:26:15,840
hash

608
00:26:15,840 --> 00:26:17,679
because of some tricky nature or

609
00:26:17,679 --> 00:26:20,400
behavior of samples we can say but what

610
00:26:20,400 --> 00:26:21,840
here exactly i'm trying to do like you

611
00:26:21,840 --> 00:26:24,559
know in previous demos we have seen some

612
00:26:24,559 --> 00:26:26,799
very specific functions being used some

613
00:26:26,799 --> 00:26:30,159
very uh specific calls being made so we

614
00:26:30,159 --> 00:26:32,320
can actually calculate a fuzzy hash for

615
00:26:32,320 --> 00:26:35,520
similar isolated functions and can run

616
00:26:35,520 --> 00:26:37,919
them run them through maybe you know

617
00:26:37,919 --> 00:26:39,679
various hunting mechanisms to see if

618
00:26:39,679 --> 00:26:40,799
there is any

619
00:26:40,799 --> 00:26:44,559
if there is any match available

620
00:26:45,600 --> 00:26:48,080
api sequences another very important

621
00:26:48,080 --> 00:26:50,320
thing i would say those who are malware

622
00:26:50,320 --> 00:26:52,000
researchers here or reverse engineers

623
00:26:52,000 --> 00:26:53,120
they know very well why this is

624
00:26:53,120 --> 00:26:55,520
important because those who are seizing

625
00:26:55,520 --> 00:26:58,080
malware researchers they can actually

626
00:26:58,080 --> 00:27:00,880
identify whole malware including the

627
00:27:00,880 --> 00:27:03,120
campaign and family just by looking at

628
00:27:03,120 --> 00:27:05,440
the api call sequences being made into

629
00:27:05,440 --> 00:27:07,600
the binary itself so similar approach

630
00:27:07,600 --> 00:27:10,720
can be used in in

631
00:27:10,720 --> 00:27:13,039
cyber physical or while establishing

632
00:27:13,039 --> 00:27:14,880
cyber physical relevant

633
00:27:14,880 --> 00:27:18,400
behavior of a binary as well

634
00:27:18,720 --> 00:27:20,559
device probes as we have already seen in

635
00:27:20,559 --> 00:27:22,960
the demo device probes is one of really

636
00:27:22,960 --> 00:27:25,840
very important thing reason being

637
00:27:25,840 --> 00:27:28,240
say out of if we consider 100 cyber

638
00:27:28,240 --> 00:27:31,039
physical relevant uh samples

639
00:27:31,039 --> 00:27:33,440
98 of them will be trying to speak to

640
00:27:33,440 --> 00:27:34,799
some device

641
00:27:34,799 --> 00:27:36,320
could be internally could be externally

642
00:27:36,320 --> 00:27:39,120
could be onto a network could be on to

643
00:27:39,120 --> 00:27:41,039
maybe some other custom protocol maybe

644
00:27:41,039 --> 00:27:44,080
onto wire could be anything right

645
00:27:44,080 --> 00:27:46,000
so finding these device probes can

646
00:27:46,000 --> 00:27:47,200
actually

647
00:27:47,200 --> 00:27:49,840
give us more

648
00:27:49,840 --> 00:27:52,640
or rather can give us uh give our

649
00:27:52,640 --> 00:27:54,880
statement more strength

650
00:27:54,880 --> 00:27:56,799
about the cyber physical relevance

651
00:27:56,799 --> 00:27:59,279
presence

652
00:27:59,760 --> 00:28:03,840
so again a small demo here

653
00:28:15,360 --> 00:28:18,159
so again same thing so let's not waste

654
00:28:18,159 --> 00:28:21,279
time in this demo same demo but from a

655
00:28:21,279 --> 00:28:22,799
different perspective i'm trying to show

656
00:28:22,799 --> 00:28:25,840
you because the coils are nothing but a

657
00:28:25,840 --> 00:28:27,360
remotely

658
00:28:27,360 --> 00:28:30,240
available some hardware maybe sensors

659
00:28:30,240 --> 00:28:32,960
analogous to sensors which we can say

660
00:28:32,960 --> 00:28:35,200
and

661
00:28:36,080 --> 00:28:38,240
yeah so here comes the network device

662
00:28:38,240 --> 00:28:41,200
probes uh reason being as sensors the

663
00:28:41,200 --> 00:28:42,480
majority of the times have some

664
00:28:42,480 --> 00:28:44,480
capability to speak on network majority

665
00:28:44,480 --> 00:28:46,720
of the times not always

666
00:28:46,720 --> 00:28:49,120
there would be interesting things to to

667
00:28:49,120 --> 00:28:52,159
look at or to search for

668
00:28:52,159 --> 00:28:56,399
so this was the demo

669
00:28:56,640 --> 00:28:59,840
let's begin

670
00:29:01,279 --> 00:29:03,200
i'll skip the part which is actually

671
00:29:03,200 --> 00:29:07,480
time consuming for no reason

672
00:29:18,240 --> 00:29:19,360
yes

673
00:29:19,360 --> 00:29:21,440
if you if you look at the string that we

674
00:29:21,440 --> 00:29:24,240
tried find here is like ic61850

675
00:29:24,240 --> 00:29:25,679
those who know this is nothing but kind

676
00:29:25,679 --> 00:29:28,320
of uh

677
00:29:28,320 --> 00:29:29,919
we can say you know power distribution

678
00:29:29,919 --> 00:29:32,240
relevant technology or our standard that

679
00:29:32,240 --> 00:29:34,640
we use

680
00:29:35,919 --> 00:29:41,840
so iec 61850 underscore s may be slave

681
00:29:43,120 --> 00:29:44,320
goose

682
00:29:44,320 --> 00:29:46,720
another power transmission related

683
00:29:46,720 --> 00:29:51,320
implementation that we use

684
00:30:09,279 --> 00:30:11,440
spabus another interesting cyber

685
00:30:11,440 --> 00:30:15,559
physical relevant implementation

686
00:30:23,440 --> 00:30:25,200
so that says t underscores power bus

687
00:30:25,200 --> 00:30:30,080
underscore m so maybe master instance

688
00:30:33,200 --> 00:30:36,200
okay

689
00:30:40,159 --> 00:30:43,520
so here i have tried enumerate some

690
00:30:43,520 --> 00:30:47,520
more such cyber physical relevant uh

691
00:30:47,520 --> 00:30:51,120
setups we can say or

692
00:30:51,120 --> 00:30:53,520
functions

693
00:30:55,760 --> 00:30:58,000
so

694
00:31:03,840 --> 00:31:05,440
okay i probably missed the earlier one

695
00:31:05,440 --> 00:31:06,480
the iec

696
00:31:06,480 --> 00:31:09,200
104

697
00:31:10,159 --> 00:31:11,840
or is it looping

698
00:31:11,840 --> 00:31:15,240
just a second

699
00:31:21,360 --> 00:31:24,640
ah yes so here again i have used

700
00:31:24,640 --> 00:31:27,440
radar a2 to find some different

701
00:31:27,440 --> 00:31:29,440
functions or protocol which are specific

702
00:31:29,440 --> 00:31:30,559
to

703
00:31:30,559 --> 00:31:32,399
cyber physical systems

704
00:31:32,399 --> 00:31:33,679
so again i have used some different

705
00:31:33,679 --> 00:31:36,000
binary here for for analysis purpose and

706
00:31:36,000 --> 00:31:37,360
i purposely

707
00:31:37,360 --> 00:31:40,000
fast forwarded initial steps that as we

708
00:31:40,000 --> 00:31:43,360
have already gone through them

709
00:31:45,519 --> 00:31:49,200
as you could see the occurrences

710
00:31:50,720 --> 00:31:53,360
so same thing we can do with gidra as

711
00:31:53,360 --> 00:31:54,640
well as with

712
00:31:54,640 --> 00:31:57,720
a direct

713
00:32:05,919 --> 00:32:07,600
i just am trying to highlight everything

714
00:32:07,600 --> 00:32:08,720
that i was

715
00:32:08,720 --> 00:32:10,399
able to find using these all

716
00:32:10,399 --> 00:32:13,399
explorations

717
00:32:17,360 --> 00:32:19,840
that's it

718
00:32:23,279 --> 00:32:25,600
so yes those were some of the demos i

719
00:32:25,600 --> 00:32:26,960
actually wanted to show you them all

720
00:32:26,960 --> 00:32:28,640
live but

721
00:32:28,640 --> 00:32:31,440
my setup could not could not run it

722
00:32:31,440 --> 00:32:33,200
properly or basically it was messing up

723
00:32:33,200 --> 00:32:35,200
into my

724
00:32:35,200 --> 00:32:36,960
setup that i'm going to use tomorrow in

725
00:32:36,960 --> 00:32:38,399
my workshop

726
00:32:38,399 --> 00:32:40,720
so yes yara rules

727
00:32:40,720 --> 00:32:42,320
so majority of the things that we have

728
00:32:42,320 --> 00:32:44,480
seen so far can actually be converted to

729
00:32:44,480 --> 00:32:47,840
yara rules and can be used as a as as a

730
00:32:47,840 --> 00:32:49,519
detection mechanism

731
00:32:49,519 --> 00:32:50,480
but

732
00:32:50,480 --> 00:32:52,000
uh

733
00:32:52,000 --> 00:32:54,000
when i try to do that majority of those

734
00:32:54,000 --> 00:32:55,440
era rules

735
00:32:55,440 --> 00:32:57,120
where were found to be a little more

736
00:32:57,120 --> 00:32:59,679
noisy than expected so

737
00:32:59,679 --> 00:33:01,120
sometimes i have got like you know ten

738
00:33:01,120 --> 00:33:02,880
thousand hits twenty thousand hits for

739
00:33:02,880 --> 00:33:04,159
for something

740
00:33:04,159 --> 00:33:07,200
really not so obvious

741
00:33:09,440 --> 00:33:10,640
results

742
00:33:10,640 --> 00:33:13,039
uh this whole thing took me a few months

743
00:33:13,039 --> 00:33:15,039
to basically formulate and come up with

744
00:33:15,039 --> 00:33:16,559
some results

745
00:33:16,559 --> 00:33:18,000
results were

746
00:33:18,000 --> 00:33:20,640
honestly

747
00:33:20,720 --> 00:33:22,799
average we can say

748
00:33:22,799 --> 00:33:25,440
i was actually able to build some data

749
00:33:25,440 --> 00:33:28,799
set which can be used as a benchmark or

750
00:33:28,799 --> 00:33:30,399
to to begin

751
00:33:30,399 --> 00:33:31,600
uh with

752
00:33:31,600 --> 00:33:33,919
in in cyber physical threat hunting

753
00:33:33,919 --> 00:33:36,399
process we can say

754
00:33:36,399 --> 00:33:37,840
if we could automate these all tests

755
00:33:37,840 --> 00:33:39,679
which are really easy to automate which

756
00:33:39,679 --> 00:33:41,360
we did as well

757
00:33:41,360 --> 00:33:43,600
that would be a lot of less effort

758
00:33:43,600 --> 00:33:46,159
overhead we can say like you know uh for

759
00:33:46,159 --> 00:33:49,559
example per uh per day there are around

760
00:33:49,559 --> 00:33:54,240
150 000 uploads on on famous

761
00:33:54,240 --> 00:33:55,519
you know

762
00:33:55,519 --> 00:33:58,480
malware aggregation engines

763
00:33:58,480 --> 00:34:00,720
uh sorting through them is is really

764
00:34:00,720 --> 00:34:02,720
tricky if we happen to download them all

765
00:34:02,720 --> 00:34:03,440
and

766
00:34:03,440 --> 00:34:05,039
then do the

767
00:34:05,039 --> 00:34:07,519
analysis part so here the automation can

768
00:34:07,519 --> 00:34:09,440
actually help

769
00:34:09,440 --> 00:34:12,000
yes as has already been mentioned it can

770
00:34:12,000 --> 00:34:14,399
actually help in expediating or analysis

771
00:34:14,399 --> 00:34:16,159
part as well

772
00:34:16,159 --> 00:34:17,918
for the same reason out of 100 if there

773
00:34:17,918 --> 00:34:19,839
are like one or two which are actually

774
00:34:19,839 --> 00:34:22,239
cyber physical relevant binaries then we

775
00:34:22,239 --> 00:34:23,839
need not analyze those hundred and then

776
00:34:23,839 --> 00:34:25,520
reach to the conclusion okay these are

777
00:34:25,520 --> 00:34:27,839
the cyber physical relevant binaries

778
00:34:27,839 --> 00:34:29,440
instead we can pick the cyber physical

779
00:34:29,440 --> 00:34:31,280
11 binaries and then go ahead and you

780
00:34:31,280 --> 00:34:32,239
know

781
00:34:32,239 --> 00:34:35,119
do the proper analysis on them

782
00:34:35,119 --> 00:34:37,199
excuse me

783
00:34:37,199 --> 00:34:39,839
yes like as already i have spoken it

784
00:34:39,839 --> 00:34:42,239
helps reducing glitter

785
00:34:42,239 --> 00:34:46,239
and the benchmark can be set quickly

786
00:34:46,239 --> 00:34:47,760
so

787
00:34:47,760 --> 00:34:49,359
after after going through these all

788
00:34:49,359 --> 00:34:50,960
tests we can say like you know there is

789
00:34:50,960 --> 00:34:53,440
no silver bullet there is no uh we can

790
00:34:53,440 --> 00:34:55,760
say you know check box like things okay

791
00:34:55,760 --> 00:34:57,760
these these things and

792
00:34:57,760 --> 00:34:59,359
you are hitting the cyber physical

793
00:34:59,359 --> 00:35:01,040
relevant sample

794
00:35:01,040 --> 00:35:03,359
but whatever the types of deductions

795
00:35:03,359 --> 00:35:05,359
that we have discussed so far can

796
00:35:05,359 --> 00:35:06,800
actually help us

797
00:35:06,800 --> 00:35:09,760
uh isolate some relatively

798
00:35:09,760 --> 00:35:11,680
relevant samples from

799
00:35:11,680 --> 00:35:13,839
uh from say like you know per day upload

800
00:35:13,839 --> 00:35:18,160
of 100 150 000 samples

801
00:35:18,240 --> 00:35:21,040
so that's most of it i had to share so

802
00:35:21,040 --> 00:35:22,079
far

803
00:35:22,079 --> 00:35:24,160
there is a lot of development also

804
00:35:24,160 --> 00:35:26,560
happening into this particular topic

805
00:35:26,560 --> 00:35:29,760
uh so far i have no

806
00:35:29,760 --> 00:35:31,920
approvals to share that thing on the

807
00:35:31,920 --> 00:35:32,880
stage

808
00:35:32,880 --> 00:35:35,280
but as soon as i get that i'll probably

809
00:35:35,280 --> 00:35:38,000
you know come up with uh more ideas to

810
00:35:38,000 --> 00:35:39,839
present as well so there are already

811
00:35:39,839 --> 00:35:42,000
things there are already developments in

812
00:35:42,000 --> 00:35:43,280
place for this

813
00:35:43,280 --> 00:35:45,200
so

814
00:35:45,200 --> 00:35:47,760
and this talk was actually meant to

815
00:35:47,760 --> 00:35:49,760
meant to you know share how

816
00:35:49,760 --> 00:35:52,720
how from a completely unknown territory

817
00:35:52,720 --> 00:35:56,400
we can go ahead in in hunting some very

818
00:35:56,400 --> 00:35:59,920
specific type of binaries

819
00:35:59,920 --> 00:36:03,720
so that's it

