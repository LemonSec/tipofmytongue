1
00:00:00,000 --> 00:00:01,850
foreign

2
00:00:01,850 --> 00:00:07,609
[Music]

3
00:00:08,460 --> 00:00:12,679
I really have a hard task because

4
00:00:12,679 --> 00:00:15,000
this is the first presentation after the

5
00:00:15,000 --> 00:00:17,880
dinner and this is the second day of the

6
00:00:17,880 --> 00:00:20,820
conference and I yeah my objective is

7
00:00:20,820 --> 00:00:23,400
not to and not to allow you to fall

8
00:00:23,400 --> 00:00:25,920
asleep uh hopefully this will be

9
00:00:25,920 --> 00:00:28,380
something interesting very enigmatic

10
00:00:28,380 --> 00:00:31,500
everybody is hearing me well

11
00:00:31,500 --> 00:00:35,520
yep at least somebody respond uh my very

12
00:00:35,520 --> 00:00:38,340
enigmatic title we need a major step in

13
00:00:38,340 --> 00:00:40,879
major reading security

14
00:00:40,879 --> 00:00:44,460
I will explain that in a few slides uh

15
00:00:44,460 --> 00:00:46,980
just a quick disclaimer that all the

16
00:00:46,980 --> 00:00:48,719
stuff that I will present in this

17
00:00:48,719 --> 00:00:51,660
presentation uh and on the following

18
00:00:51,660 --> 00:00:55,140
slides is my opinion nobody else

19
00:00:55,140 --> 00:00:57,960
uh not my wife not my employee not my

20
00:00:57,960 --> 00:01:01,079
line manager not my friend of my line

21
00:01:01,079 --> 00:01:02,480
manager whatever

22
00:01:02,480 --> 00:01:05,099
uh all the stuff on this presentation is

23
00:01:05,099 --> 00:01:07,500
in Internet for Education purpose only

24
00:01:07,500 --> 00:01:10,439
feel free to be educated and no animals

25
00:01:10,439 --> 00:01:13,380
were harmed during the whole process and

26
00:01:13,380 --> 00:01:15,900
research that was done

27
00:01:15,900 --> 00:01:16,680
um

28
00:01:16,680 --> 00:01:19,500
who am I for those who don't know me

29
00:01:19,500 --> 00:01:22,619
I'm working for more than 12 years in

30
00:01:22,619 --> 00:01:23,720
the security

31
00:01:23,720 --> 00:01:27,960
and until last year I was working on the

32
00:01:27,960 --> 00:01:29,880
blue team in the blue team

33
00:01:29,880 --> 00:01:33,780
uh I graduated physics and I'm very

34
00:01:33,780 --> 00:01:35,159
grateful for

35
00:01:35,159 --> 00:01:36,180
uh

36
00:01:36,180 --> 00:01:38,759
uh for having that

37
00:01:38,759 --> 00:01:41,640
for having that point in time when I was

38
00:01:41,640 --> 00:01:44,700
learning physics because uh actually it

39
00:01:44,700 --> 00:01:46,979
occurs that applying all the rules that

40
00:01:46,979 --> 00:01:49,460
we learn during static

41
00:01:49,460 --> 00:01:52,860
sorry studying physics applied very well

42
00:01:52,860 --> 00:01:55,500
to it security especially that one like

43
00:01:55,500 --> 00:01:57,420
you want to test if something is stable

44
00:01:57,420 --> 00:02:00,060
just shake it if it will be it if it

45
00:02:00,060 --> 00:02:03,540
will break it uh it wasn't secure enough

46
00:02:03,540 --> 00:02:06,899
as I said for the last year I'm uh

47
00:02:06,899 --> 00:02:09,419
trying to be a red teamer so I'm gaining

48
00:02:09,419 --> 00:02:11,700
the experience of the red teamer but

49
00:02:11,700 --> 00:02:14,099
deeply in my heart and I'm a blue teamer

50
00:02:14,099 --> 00:02:16,739
so I'm always thinking even I even when

51
00:02:16,739 --> 00:02:18,900
I'm breaking something or running a

52
00:02:18,900 --> 00:02:21,739
Cobalt strike I'm always thinking about

53
00:02:21,739 --> 00:02:24,599
the blue defense side

54
00:02:24,599 --> 00:02:27,660
uh so the the real problem that I would

55
00:02:27,660 --> 00:02:29,819
like to discuss here is the supply chain

56
00:02:29,819 --> 00:02:31,019
attack

57
00:02:31,019 --> 00:02:34,620
problem of so basically the problem how

58
00:02:34,620 --> 00:02:35,819
can we

59
00:02:35,819 --> 00:02:38,700
make this make secure or more secure or

60
00:02:38,700 --> 00:02:42,000
fix some issues regarding uh

61
00:02:42,000 --> 00:02:45,840
shipping uh untrusted piece of software

62
00:02:45,840 --> 00:02:48,060
into our infrastructure I know this is

63
00:02:48,060 --> 00:02:49,920
really a good buzzword for the for the

64
00:02:49,920 --> 00:02:53,099
past two years but I will try to avoid

65
00:02:53,099 --> 00:02:54,739
buzzwords and

66
00:02:54,739 --> 00:02:57,659
BS in my presentation

67
00:02:57,659 --> 00:02:59,819
so the motivation for this presentation

68
00:02:59,819 --> 00:03:02,700
started one and a half year ago a few

69
00:03:02,700 --> 00:03:06,000
days after the solar Wings incident

70
00:03:06,000 --> 00:03:09,840
how many of you know what is solar Wings

71
00:03:09,840 --> 00:03:12,540
about raise your hand

72
00:03:12,540 --> 00:03:16,080
okay majority so very quickly solar

73
00:03:16,080 --> 00:03:18,900
Wings is a solve with a software that is

74
00:03:18,900 --> 00:03:21,959
used in your network uh it is a software

75
00:03:21,959 --> 00:03:24,180
that is being run in privilege endpoints

76
00:03:24,180 --> 00:03:26,580
and basically the the attacker was able

77
00:03:26,580 --> 00:03:29,700
to compromise the pipeline of create the

78
00:03:29,700 --> 00:03:32,400
pipeline that is used for to create that

79
00:03:32,400 --> 00:03:34,680
software the binaries of that software

80
00:03:34,680 --> 00:03:40,200
and by compromising that uh part uh it

81
00:03:40,200 --> 00:03:42,540
is really big simplification they were

82
00:03:42,540 --> 00:03:45,420
able to implant malicious components

83
00:03:45,420 --> 00:03:46,860
into the software that was later

84
00:03:46,860 --> 00:03:49,920
uninstalled they were the malicious

85
00:03:49,920 --> 00:03:50,900
implant

86
00:03:50,900 --> 00:03:54,659
was present in the binaries for at least

87
00:03:54,659 --> 00:03:57,239
half a year and it was installed in

88
00:03:57,239 --> 00:03:58,799
multiple institutions

89
00:03:58,799 --> 00:04:02,099
and soon after the event called sora

90
00:04:02,099 --> 00:04:03,540
solar

91
00:04:03,540 --> 00:04:08,159
solar wind hack uh the discussion on one

92
00:04:08,159 --> 00:04:09,739
of the

93
00:04:09,739 --> 00:04:13,319
social professional social network

94
00:04:13,319 --> 00:04:16,199
portals started with this sentence like

95
00:04:16,199 --> 00:04:18,418
the solar Wings hacks shows that the

96
00:04:18,418 --> 00:04:20,279
automatic patching is not always a good

97
00:04:20,279 --> 00:04:21,180
idea

98
00:04:21,180 --> 00:04:25,259
uh blah blah blah and very obvious and

99
00:04:25,259 --> 00:04:27,960
very uh correct sentence that you are

100
00:04:27,960 --> 00:04:29,940
responsible for what is being installed

101
00:04:29,940 --> 00:04:32,460
on your network but the biggest problem

102
00:04:32,460 --> 00:04:35,280
in the supply chain attack is that yes

103
00:04:35,280 --> 00:04:39,120
you are responsible but the garbage that

104
00:04:39,120 --> 00:04:40,919
you receive and you need to install it

105
00:04:40,919 --> 00:04:43,440
on on your network is being delivered by

106
00:04:43,440 --> 00:04:45,840
someone else and there's no way that you

107
00:04:45,840 --> 00:04:49,500
can verify uh continuously verify the

108
00:04:49,500 --> 00:04:51,600
trust especially that you have if you

109
00:04:51,600 --> 00:04:53,400
have multiple vendors that are supplying

110
00:04:53,400 --> 00:04:56,600
multiple things for you

111
00:04:56,600 --> 00:05:01,259
so uh I I responded quickly okay how on

112
00:05:01,259 --> 00:05:02,880
Earth can you

113
00:05:02,880 --> 00:05:06,660
uh what kind of process can you apply

114
00:05:06,660 --> 00:05:09,780
to be sure to ensure yourself or your

115
00:05:09,780 --> 00:05:12,120
organization or to detect malicious

116
00:05:12,120 --> 00:05:13,800
intents in the software that is being

117
00:05:13,800 --> 00:05:15,720
shipped to you like the only thing that

118
00:05:15,720 --> 00:05:17,639
came to my mind okay I can take the

119
00:05:17,639 --> 00:05:19,800
binaries I can install it on the sandbox

120
00:05:19,800 --> 00:05:23,400
environment I can employ me or my

121
00:05:23,400 --> 00:05:25,320
friends to reverse engineer the software

122
00:05:25,320 --> 00:05:27,080
analyze

123
00:05:27,080 --> 00:05:30,180
uh bite by bite every function that is

124
00:05:30,180 --> 00:05:32,940
there and then I will be able to in

125
00:05:32,940 --> 00:05:35,699
majority of course claim that okay I

126
00:05:35,699 --> 00:05:37,860
didn't see anything suspicious

127
00:05:37,860 --> 00:05:39,960
uh if you go to the doctor the doctor

128
00:05:39,960 --> 00:05:42,120
will never say you say to you okay

129
00:05:42,120 --> 00:05:44,039
you're healthy the doctor will always

130
00:05:44,039 --> 00:05:46,259
tell you I don't see anything suspicious

131
00:05:46,259 --> 00:05:49,740
for me you you are not looking sick they

132
00:05:49,740 --> 00:05:52,560
will not tell you that uh you're 100

133
00:05:52,560 --> 00:05:54,660
healthy because you may not be healthy

134
00:05:54,660 --> 00:05:57,780
so even if if I would reverse spend like

135
00:05:57,780 --> 00:05:59,580
I don't know half a year on reverse

136
00:05:59,580 --> 00:06:01,620
engineering I wouldn't feel comfortable

137
00:06:01,620 --> 00:06:04,020
on telling somebody else that I I

138
00:06:04,020 --> 00:06:06,060
definitely certified that this binary

139
00:06:06,060 --> 00:06:08,340
especially huge binary is definitely

140
00:06:08,340 --> 00:06:11,400
safe and free from debuggers and the

141
00:06:11,400 --> 00:06:13,500
discussion continues

142
00:06:13,500 --> 00:06:15,660
uh I'm not saying that the manual

143
00:06:15,660 --> 00:06:17,880
installation is the answer and the the

144
00:06:17,880 --> 00:06:20,400
guy proposed three things check if the

145
00:06:20,400 --> 00:06:22,919
update is critical or not or and not

146
00:06:22,919 --> 00:06:25,680
install it like the whole idea of

147
00:06:25,680 --> 00:06:28,199
shipping the updates quickly is to

148
00:06:28,199 --> 00:06:29,880
install them especially if the software

149
00:06:29,880 --> 00:06:33,240
is high privilege software and in the

150
00:06:33,240 --> 00:06:35,639
most cases vendors are not

151
00:06:35,639 --> 00:06:38,220
providing updates because they just you

152
00:06:38,220 --> 00:06:40,139
know okay let's release the update this

153
00:06:40,139 --> 00:06:41,240
is the

154
00:06:41,240 --> 00:06:45,300
22nd of uh the middle of the summer this

155
00:06:45,300 --> 00:06:47,460
is released a update day releasing

156
00:06:47,460 --> 00:06:49,020
update because they fixed something

157
00:06:49,020 --> 00:06:51,599
probably maybe cosmetic things like user

158
00:06:51,599 --> 00:06:54,419
interface button was moved left or maybe

159
00:06:54,419 --> 00:06:56,220
a security issue

160
00:06:56,220 --> 00:06:59,340
uh to check on the sandbox uh if there's

161
00:06:59,340 --> 00:07:02,400
nothing suspicious like I I deeply

162
00:07:02,400 --> 00:07:04,759
believe that the sandbox

163
00:07:04,759 --> 00:07:08,039
approach is working but I will give a

164
00:07:08,039 --> 00:07:11,160
huge bottle of very pricey beer to

165
00:07:11,160 --> 00:07:13,380
person that would be able to run a very

166
00:07:13,380 --> 00:07:15,660
complex software on the sandbox and

167
00:07:15,660 --> 00:07:17,580
point a finger okay this is a malicious

168
00:07:17,580 --> 00:07:20,720
intent for all the hundreds of the

169
00:07:20,720 --> 00:07:23,400
Behavior behavioral things that were

170
00:07:23,400 --> 00:07:24,960
registered like access to the disk

171
00:07:24,960 --> 00:07:26,520
access to the memory access to the

172
00:07:26,520 --> 00:07:28,979
registry and all the other interactions

173
00:07:28,979 --> 00:07:30,419
they will be able to point the finger

174
00:07:30,419 --> 00:07:32,400
and say oh this is definitely malicious

175
00:07:32,400 --> 00:07:34,259
because the this IP address starts from

176
00:07:34,259 --> 00:07:35,580
five

177
00:07:35,580 --> 00:07:37,500
and to ensure that no external

178
00:07:37,500 --> 00:07:39,419
communication is being allowed and this

179
00:07:39,419 --> 00:07:41,400
is very problematic because for example

180
00:07:41,400 --> 00:07:44,520
the solar Wings needed a lot of network

181
00:07:44,520 --> 00:07:46,680
communication of course local

182
00:07:46,680 --> 00:07:49,620
communication but if you

183
00:07:49,620 --> 00:07:52,620
nowadays it is hard to

184
00:07:52,620 --> 00:07:54,300
have a software that doesn't require

185
00:07:54,300 --> 00:07:56,180
network communication

186
00:07:56,180 --> 00:07:59,840
uh like

187
00:07:59,940 --> 00:08:02,520
I don't know most of them require so

188
00:08:02,520 --> 00:08:04,379
even for example for downloading the

189
00:08:04,379 --> 00:08:05,460
updates

190
00:08:05,460 --> 00:08:08,759
uh so yeah this was perfect shot like

191
00:08:08,759 --> 00:08:10,740
don't install updates run your software

192
00:08:10,740 --> 00:08:12,599
on Sandbox and definitely this will fix

193
00:08:12,599 --> 00:08:17,160
the problem of supply chain attacks no

194
00:08:17,160 --> 00:08:20,280
uh and again if you try to discover what

195
00:08:20,280 --> 00:08:22,020
is the problem with supply chain uh

196
00:08:22,020 --> 00:08:24,840
attacks that's the problem you you have

197
00:08:24,840 --> 00:08:26,520
a third party that you cannot trust that

198
00:08:26,520 --> 00:08:28,020
is supplying your stuff and you need to

199
00:08:28,020 --> 00:08:29,940
run it on your environment

200
00:08:29,940 --> 00:08:32,940
and as I said uh running stuff and

201
00:08:32,940 --> 00:08:35,640
analyzing the results maybe if you're

202
00:08:35,640 --> 00:08:37,799
running malware and you you definitely

203
00:08:37,799 --> 00:08:39,839
know what you're looking for

204
00:08:39,839 --> 00:08:42,779
and it was a moment when Corporal

205
00:08:42,779 --> 00:08:46,200
approach kicked in I was in my tie I was

206
00:08:46,200 --> 00:08:49,320
sitting in my shirt uh in my uh

207
00:08:49,320 --> 00:08:51,440
corporate desk

208
00:08:51,440 --> 00:08:54,480
and my Approach changes we don't have a

209
00:08:54,480 --> 00:08:57,740
problems we have challenges

210
00:09:02,220 --> 00:09:05,700
okay you're not sleeping nice

211
00:09:05,700 --> 00:09:08,760
so I asked myself okay I can argue on

212
00:09:08,760 --> 00:09:10,920
the LinkedIn like everybody can do but

213
00:09:10,920 --> 00:09:14,459
this is not moving us anywhere Let's uh

214
00:09:14,459 --> 00:09:17,360
start thinking okay how actually we can

215
00:09:17,360 --> 00:09:19,560
approach that problem

216
00:09:19,560 --> 00:09:21,620
so first thing

217
00:09:21,620 --> 00:09:24,899
uh problem solving we need to well

218
00:09:24,899 --> 00:09:27,120
Define what is actually the problem so

219
00:09:27,120 --> 00:09:30,180
let's start by trying to uh articulate

220
00:09:30,180 --> 00:09:31,920
what's the problem the problem is who

221
00:09:31,920 --> 00:09:34,320
can provide the data about expected

222
00:09:34,320 --> 00:09:36,540
behavior of the software and of course

223
00:09:36,540 --> 00:09:38,459
the obvious answer here is like you

224
00:09:38,459 --> 00:09:39,899
don't need to spend a lot of time on

225
00:09:39,899 --> 00:09:42,540
thinking vendor because they are

226
00:09:42,540 --> 00:09:44,399
building the software

227
00:09:44,399 --> 00:09:47,399
so let's do this social experiment ask

228
00:09:47,399 --> 00:09:49,019
the vendor

229
00:09:49,019 --> 00:09:51,660
so you're opening our Outlook

230
00:09:51,660 --> 00:09:52,980
starting

231
00:09:52,980 --> 00:09:54,240
urgent requests from our security

232
00:09:54,240 --> 00:09:56,279
department please provide the

233
00:09:56,279 --> 00:09:57,600
description what is the expected

234
00:09:57,600 --> 00:09:59,760
behavior of your software let's assume

235
00:09:59,760 --> 00:10:01,560
that this is simple software like I know

236
00:10:01,560 --> 00:10:03,480
business calculation or something like

237
00:10:03,480 --> 00:10:04,320
that

238
00:10:04,320 --> 00:10:07,079
regards Fubar sending the email

239
00:10:07,079 --> 00:10:11,640
waiting few days waiting few more days

240
00:10:11,640 --> 00:10:13,920
and the answer is coming we are

241
00:10:13,920 --> 00:10:17,220
receiving the document with a logo

242
00:10:17,220 --> 00:10:20,940
second page company Mission

243
00:10:20,940 --> 00:10:24,060
second page term the list of things that

244
00:10:24,060 --> 00:10:25,440
will be in the document

245
00:10:25,440 --> 00:10:27,839
and the description why this product is

246
00:10:27,839 --> 00:10:29,100
very special

247
00:10:29,100 --> 00:10:31,560
and marketing description what this

248
00:10:31,560 --> 00:10:33,480
stuff is doing claiming to be a

249
00:10:33,480 --> 00:10:35,220
behavioral description

250
00:10:35,220 --> 00:10:37,260
and the Gartner Square pointing like

251
00:10:37,260 --> 00:10:38,700
we're here

252
00:10:38,700 --> 00:10:40,800
and we are very unique

253
00:10:40,800 --> 00:10:43,019
and the statement that we need to think

254
00:10:43,019 --> 00:10:45,660
before printing this document

255
00:10:45,660 --> 00:10:48,959
like I think majority of the people that

256
00:10:48,959 --> 00:10:50,700
are working in the big organizations

257
00:10:50,700 --> 00:10:53,339
would agree with me that yeah like this

258
00:10:53,339 --> 00:10:54,720
is something that you will get if you

259
00:10:54,720 --> 00:10:57,180
will ask vendors uh that way like

260
00:10:57,180 --> 00:10:58,860
provide me the description you will get

261
00:10:58,860 --> 00:11:02,279
the PDF maybe maybe a word file maybe a

262
00:11:02,279 --> 00:11:04,200
link to the website with all that be

263
00:11:04,200 --> 00:11:06,560
very important information

264
00:11:06,560 --> 00:11:10,860
and this is not moving us anywhere again

265
00:11:10,860 --> 00:11:14,640
so uh the real problem is not who can

266
00:11:14,640 --> 00:11:16,500
provide the data because the vendor rods

267
00:11:16,500 --> 00:11:20,459
the obvious answer but uh

268
00:11:20,459 --> 00:11:23,240
we just need to maybe ask more precisely

269
00:11:23,240 --> 00:11:26,640
for the data so okay we're creating

270
00:11:26,640 --> 00:11:28,740
another email because this is response

271
00:11:28,740 --> 00:11:30,959
for the forward of the response please

272
00:11:30,959 --> 00:11:33,240
provide the list of domain IP addresses

273
00:11:33,240 --> 00:11:34,980
that your software needs to connect in

274
00:11:34,980 --> 00:11:36,720
order to work like let's just focus on

275
00:11:36,720 --> 00:11:38,700
IP addresses what you will get let's

276
00:11:38,700 --> 00:11:40,980
like make a vote maybe there's something

277
00:11:40,980 --> 00:11:44,279
that you would like to propose

278
00:11:44,279 --> 00:11:46,680
now on a PDF you will get a Excel file

279
00:11:46,680 --> 00:11:49,079
with the list of the domains okay this

280
00:11:49,079 --> 00:11:50,399
is better because you can select the

281
00:11:50,399 --> 00:11:52,440
column copy to the text file and you

282
00:11:52,440 --> 00:11:54,300
will have the list of things that you

283
00:11:54,300 --> 00:11:56,880
need to look for or the opposite you you

284
00:11:56,880 --> 00:11:58,440
will get the list of the things that

285
00:11:58,440 --> 00:12:01,200
shouldn't worry you but this is only

286
00:12:01,200 --> 00:12:04,079
this one software is it scalable

287
00:12:04,079 --> 00:12:07,980
no did you get the answer partially yes

288
00:12:07,980 --> 00:12:10,440
but only for the network connectivity so

289
00:12:10,440 --> 00:12:13,620
let's move forward how a responsible

290
00:12:13,620 --> 00:12:15,560
entity and we

291
00:12:15,560 --> 00:12:18,240
assume here that this is a vendor can

292
00:12:18,240 --> 00:12:21,000
provide the data about expected behavior

293
00:12:21,000 --> 00:12:23,220
of the software and the site question

294
00:12:23,220 --> 00:12:26,100
what is the behavior

295
00:12:26,100 --> 00:12:29,360
so let's pause here

296
00:12:29,399 --> 00:12:31,980
and think about fixing the supply chain

297
00:12:31,980 --> 00:12:35,420
problem in Modern Way

298
00:12:36,000 --> 00:12:38,399
we don't need machine learning we don't

299
00:12:38,399 --> 00:12:40,079
need sandboxing we don't need blockchain

300
00:12:40,079 --> 00:12:42,000
stuff and deception

301
00:12:42,000 --> 00:12:45,120
because we already have too many uh

302
00:12:45,120 --> 00:12:47,339
security software on the market we have

303
00:12:47,339 --> 00:12:49,200
a network security protection prevention

304
00:12:49,200 --> 00:12:51,779
we have like in network intrusion

305
00:12:51,779 --> 00:12:54,240
detection Network intrusion prevention

306
00:12:54,240 --> 00:12:57,180
we have pattern based detection on the

307
00:12:57,180 --> 00:13:00,120
network and on the host and like inside

308
00:13:00,120 --> 00:13:02,220
the memory even we have endpoint

309
00:13:02,220 --> 00:13:04,860
protection signature based behavioral

310
00:13:04,860 --> 00:13:07,079
base stuff that is responsible just

311
00:13:07,079 --> 00:13:09,300
follow monitoring and forwarding the

312
00:13:09,300 --> 00:13:11,220
data about the behavior to the central

313
00:13:11,220 --> 00:13:14,279
server then to process it and apply the

314
00:13:14,279 --> 00:13:15,360
rules

315
00:13:15,360 --> 00:13:17,940
uh of course we have stuff that is based

316
00:13:17,940 --> 00:13:19,260
on blockchain and artificial

317
00:13:19,260 --> 00:13:22,440
intelligence but this is useless

318
00:13:22,440 --> 00:13:26,160
and uh but this all stuff that I I

319
00:13:26,160 --> 00:13:29,160
enlisted and probably most of you are

320
00:13:29,160 --> 00:13:31,079
working on daily basis with that kind of

321
00:13:31,079 --> 00:13:34,200
software it's an ineffective uh alone

322
00:13:34,200 --> 00:13:36,360
like uh

323
00:13:36,360 --> 00:13:38,519
a quotation from the Shrek the security

324
00:13:38,519 --> 00:13:41,040
is like onion you need to have Liars so

325
00:13:41,040 --> 00:13:43,860
you have Liars of security products uh

326
00:13:43,860 --> 00:13:45,540
you have an endpoint protection because

327
00:13:45,540 --> 00:13:47,519
if you if the network protection will

328
00:13:47,519 --> 00:13:50,220
fail maybe the network the endpoint

329
00:13:50,220 --> 00:13:52,980
protection will pick up the uh the

330
00:13:52,980 --> 00:13:55,380
attack and alert you and maybe stop the

331
00:13:55,380 --> 00:13:56,360
attack

332
00:13:56,360 --> 00:13:59,220
uh all the stuff that I listed here is

333
00:13:59,220 --> 00:14:01,980
very vendor specific like you are

334
00:14:01,980 --> 00:14:04,079
configuring the stuff in very

335
00:14:04,079 --> 00:14:06,959
vendor-specific way uh most probably

336
00:14:06,959 --> 00:14:08,880
this is web interface that you need to

337
00:14:08,880 --> 00:14:09,720
click

338
00:14:09,720 --> 00:14:12,959
even if you apply uh fancy rules like

339
00:14:12,959 --> 00:14:17,100
okay let's uh combine uh detection of a

340
00:14:17,100 --> 00:14:19,500
specific I don't know execution path Etc

341
00:14:19,500 --> 00:14:22,920
you are putting that knowledge uh and

342
00:14:22,920 --> 00:14:25,620
that configuration and web interface

343
00:14:25,620 --> 00:14:28,680
maybe in some in some cases you have a

344
00:14:28,680 --> 00:14:31,019
configuration file being uploaded maybe

345
00:14:31,019 --> 00:14:33,660
but this is very vendor specific

346
00:14:33,660 --> 00:14:36,240
and definitely you cannot just ship this

347
00:14:36,240 --> 00:14:38,040
configuration when you're changing I

348
00:14:38,040 --> 00:14:40,199
don't know antivirus vendor from one to

349
00:14:40,199 --> 00:14:41,699
another you cannot merge the

350
00:14:41,699 --> 00:14:43,860
configuration from one place to another

351
00:14:43,860 --> 00:14:46,079
because this is vendor specific even if

352
00:14:46,079 --> 00:14:47,880
you probably use the button export

353
00:14:47,880 --> 00:14:49,800
configuration you will end up with

354
00:14:49,800 --> 00:14:51,779
binary crap that is only parsable by

355
00:14:51,779 --> 00:14:54,240
this specific software

356
00:14:54,240 --> 00:14:56,699
so in the same category like antivirus

357
00:14:56,699 --> 00:14:59,699
and protection or network protection uh

358
00:14:59,699 --> 00:15:01,920
the functionality is even heavily

359
00:15:01,920 --> 00:15:03,720
inconsistent there's no like one

360
00:15:03,720 --> 00:15:06,000
Baseline that we should look

361
00:15:06,000 --> 00:15:09,480
for there's no list of events that we

362
00:15:09,480 --> 00:15:11,579
should look on the operating system

363
00:15:11,579 --> 00:15:15,060
level uh most probably majority of the

364
00:15:15,060 --> 00:15:17,399
Security Solutions are logging things

365
00:15:17,399 --> 00:15:18,899
like I don't know create process

366
00:15:18,899 --> 00:15:20,040
activity

367
00:15:20,040 --> 00:15:23,279
most security processors are logging the

368
00:15:23,279 --> 00:15:26,699
network activity but for example and

369
00:15:26,699 --> 00:15:29,459
this is open question I never saw a

370
00:15:29,459 --> 00:15:32,040
security product that was logging create

371
00:15:32,040 --> 00:15:34,380
process function call

372
00:15:34,380 --> 00:15:36,420
and the flag if the process is being

373
00:15:36,420 --> 00:15:38,399
created suspended or not

374
00:15:38,399 --> 00:15:40,620
but everybody who was working on pair

375
00:15:40,620 --> 00:15:42,959
hollowing method knows that this is like

376
00:15:42,959 --> 00:15:46,459
the obvious way to detect that and I I I

377
00:15:46,459 --> 00:15:49,320
didn't saw any kind of functionality on

378
00:15:49,320 --> 00:15:51,240
the market

379
00:15:51,240 --> 00:15:53,579
of course there's the exception most of

380
00:15:53,579 --> 00:15:56,279
those uh security staff is ingesting

381
00:15:56,279 --> 00:15:58,980
iocs but this is the result of the ioc

382
00:15:58,980 --> 00:16:02,639
becoming uh industry standard in terms

383
00:16:02,639 --> 00:16:04,699
of digesting things

384
00:16:04,699 --> 00:16:08,220
uh a side question here how do you store

385
00:16:08,220 --> 00:16:09,899
your configuration

386
00:16:09,899 --> 00:16:12,660
uh you have firewalls you have uh

387
00:16:12,660 --> 00:16:14,699
stateless firewalls stateful firewalls

388
00:16:14,699 --> 00:16:16,620
New Generation firewalls new driver

389
00:16:16,620 --> 00:16:19,199
narration web 3-0 firewalls and point

390
00:16:19,199 --> 00:16:22,440
protection antivirus EDR host base

391
00:16:22,440 --> 00:16:24,660
firewall application wine listing rules

392
00:16:24,660 --> 00:16:26,959
yarrows and whatever like you have

393
00:16:26,959 --> 00:16:30,300
multiple layers and how do you store the

394
00:16:30,300 --> 00:16:32,519
configuration of dot all of those

395
00:16:32,519 --> 00:16:35,279
Solutions most probably a case study

396
00:16:35,279 --> 00:16:36,959
based on firewall

397
00:16:36,959 --> 00:16:40,199
good old uh

398
00:16:40,199 --> 00:16:42,660
sorry this was the next slide

399
00:16:42,660 --> 00:16:46,320
uh uh in most cases in a very in big

400
00:16:46,320 --> 00:16:49,500
organization uh the configuration is

401
00:16:49,500 --> 00:16:52,259
stored in the series of Word documents

402
00:16:52,259 --> 00:16:54,120
that are describing the changes that are

403
00:16:54,120 --> 00:16:56,600
you applying one by one

404
00:16:56,600 --> 00:17:00,720
maybe the appliance hold is holding the

405
00:17:00,720 --> 00:17:03,779
recent version of the rule set

406
00:17:03,779 --> 00:17:07,679
configuration and the only copy called

407
00:17:07,679 --> 00:17:09,419
copy of that is if you are making a

408
00:17:09,419 --> 00:17:10,859
backup of course you are making a backup

409
00:17:10,859 --> 00:17:14,099
or snapshot as I said before most

410
00:17:14,099 --> 00:17:15,660
probably there's no way to switch the

411
00:17:15,660 --> 00:17:18,780
vendor if you will uh if you for example

412
00:17:18,780 --> 00:17:20,339
with just switch the vendor of the

413
00:17:20,339 --> 00:17:22,799
firewall like switch Palo Alto to Cisco

414
00:17:22,799 --> 00:17:24,859
Cisco par Alto

415
00:17:24,859 --> 00:17:27,660
merging the rule set is a bit

416
00:17:27,660 --> 00:17:30,600
challenging and there's no way that you

417
00:17:30,600 --> 00:17:32,039
will find a

418
00:17:32,039 --> 00:17:33,840
provider on the market that will say

419
00:17:33,840 --> 00:17:35,940
okay we will match one and one and you

420
00:17:35,940 --> 00:17:39,200
will we will guarantee the functionality

421
00:17:39,200 --> 00:17:41,100
anyone storing that kind of

422
00:17:41,100 --> 00:17:42,960
configuration I get managed to do that

423
00:17:42,960 --> 00:17:45,720
in the text files

424
00:17:45,720 --> 00:17:47,580
so you're sleeping or nobody's doing

425
00:17:47,580 --> 00:17:48,780
that

426
00:17:48,780 --> 00:17:52,940
uh let's get back to the real problem

427
00:17:53,120 --> 00:17:56,220
uh so let's apply again the corporate

428
00:17:56,220 --> 00:17:58,500
approach to solve the problem background

429
00:17:58,500 --> 00:18:02,100
is how uh can we get the information of

430
00:18:02,100 --> 00:18:03,960
the about the intended behavior of the

431
00:18:03,960 --> 00:18:06,120
software current situation is that as I

432
00:18:06,120 --> 00:18:09,720
showed and nobody uh objected if we will

433
00:18:09,720 --> 00:18:12,780
ask vendor we'll get Word documents or

434
00:18:12,780 --> 00:18:16,080
PDFs this is completely useless crap uh

435
00:18:16,080 --> 00:18:18,000
what is our Target we want to get the

436
00:18:18,000 --> 00:18:20,160
knowledge that's about the behavior

437
00:18:20,160 --> 00:18:22,679
about the expected Behavior and the way

438
00:18:22,679 --> 00:18:25,020
that the computers and the humans can

439
00:18:25,020 --> 00:18:27,419
read it parse it and consume it

440
00:18:27,419 --> 00:18:30,360
the root cause is most probably there is

441
00:18:30,360 --> 00:18:31,980
no well-defined format to exchange that

442
00:18:31,980 --> 00:18:35,120
any kind of information uh what is the

443
00:18:35,120 --> 00:18:37,799
what are the counter measures let's

444
00:18:37,799 --> 00:18:40,440
let's propose the format let's do it

445
00:18:40,440 --> 00:18:42,059
like we did that

446
00:18:42,059 --> 00:18:45,600
uh years ago we created a ioc standard

447
00:18:45,600 --> 00:18:48,720
like how can we exchange the knowledge

448
00:18:48,720 --> 00:18:50,960
about

449
00:18:50,960 --> 00:18:54,660
behavioral events that indicates that

450
00:18:54,660 --> 00:18:56,340
your infrastructure being compromised

451
00:18:56,340 --> 00:18:58,860
it's working we are exchanging that data

452
00:18:58,860 --> 00:19:01,020
we even have a fancy Protocols of

453
00:19:01,020 --> 00:19:02,960
exchanging that data

454
00:19:02,960 --> 00:19:06,120
uh the implementation plan let's make a

455
00:19:06,120 --> 00:19:08,039
POC ask people about the opinion put

456
00:19:08,039 --> 00:19:09,840
stuff on the GitHub

457
00:19:09,840 --> 00:19:12,120
and get drinks

458
00:19:12,120 --> 00:19:16,500
so I'm introducing now uh the indicators

459
00:19:16,500 --> 00:19:19,380
of normality the things that is quite

460
00:19:19,380 --> 00:19:21,360
obvious consequence of indicators of

461
00:19:21,360 --> 00:19:22,799
compromise

462
00:19:22,799 --> 00:19:25,740
uh why not indicators of compromise

463
00:19:25,740 --> 00:19:28,860
because if you are detecting indicator

464
00:19:28,860 --> 00:19:30,960
of compromises and in your network as I

465
00:19:30,960 --> 00:19:34,020
said this is already a bad situation so

466
00:19:34,020 --> 00:19:35,880
we need to reverse the process

467
00:19:35,880 --> 00:19:37,980
uh why application Wireless White

468
00:19:37,980 --> 00:19:40,320
listing is working because you're

469
00:19:40,320 --> 00:19:42,360
whitelisting the application you know

470
00:19:42,360 --> 00:19:44,100
what you're white listing you're not

471
00:19:44,100 --> 00:19:46,020
blacklisting things because you don't

472
00:19:46,020 --> 00:19:48,299
know what you need to Blacklist but you

473
00:19:48,299 --> 00:19:51,740
may know what you want to whitelist

474
00:19:51,740 --> 00:19:53,700
uh

475
00:19:53,700 --> 00:19:56,820
why uh what what do what do we want to

476
00:19:56,820 --> 00:19:58,799
achieve we want to achieve the

477
00:19:58,799 --> 00:20:00,660
consistent way of describing the

478
00:20:00,660 --> 00:20:02,820
expected behavior I'm repeating that

479
00:20:02,820 --> 00:20:05,400
like a third time or something and it

480
00:20:05,400 --> 00:20:08,400
need to be exchangeable uh it need to be

481
00:20:08,400 --> 00:20:10,559
possible for both computers and humans

482
00:20:10,559 --> 00:20:12,780
because otherwise people won't be able

483
00:20:12,780 --> 00:20:15,900
to assess if this set of rules or set of

484
00:20:15,900 --> 00:20:19,320
description is accurate or not it should

485
00:20:19,320 --> 00:20:21,780
be a primary golden source for a virus

486
00:20:21,780 --> 00:20:23,820
security Liars like if you have this

487
00:20:23,820 --> 00:20:28,320
source of description we later on can uh

488
00:20:28,320 --> 00:20:31,080
export or extract stuff from this

489
00:20:31,080 --> 00:20:33,120
configuration sorry if somebody's golden

490
00:20:33,120 --> 00:20:35,640
source to our our endpoint configuration

491
00:20:35,640 --> 00:20:38,520
and endpoint firewall EDR or whatever

492
00:20:38,520 --> 00:20:42,840
Farsi software you are using and uh need

493
00:20:42,840 --> 00:20:45,080
to

494
00:20:45,600 --> 00:20:49,860
and by defining the entities that we

495
00:20:49,860 --> 00:20:51,960
expect as being a description of the

496
00:20:51,960 --> 00:20:53,940
behavior we can have a consistent

497
00:20:53,940 --> 00:20:55,740
expectations from the vendors for

498
00:20:55,740 --> 00:20:57,900
example if you have a very obvious

499
00:20:57,900 --> 00:21:00,299
description that we want to uh have the

500
00:21:00,299 --> 00:21:02,460
money ability to monitor network

501
00:21:02,460 --> 00:21:04,799
security we can expect that that we if

502
00:21:04,799 --> 00:21:06,240
we will

503
00:21:06,240 --> 00:21:08,640
uh on board a vendor we are expecting

504
00:21:08,640 --> 00:21:10,440
that this product needs to monitor

505
00:21:10,440 --> 00:21:12,980
network activity

506
00:21:12,980 --> 00:21:16,380
who is responsible vendors of course

507
00:21:16,380 --> 00:21:17,640
because they are shipping software

508
00:21:17,640 --> 00:21:20,280
Security Department because some vendors

509
00:21:20,280 --> 00:21:21,840
are very

510
00:21:21,840 --> 00:21:24,539
uh hard to cooperate

511
00:21:24,539 --> 00:21:26,220
so the security department will be

512
00:21:26,220 --> 00:21:28,559
responsible or anyone like iocs are

513
00:21:28,559 --> 00:21:30,720
being created by the community

514
00:21:30,720 --> 00:21:33,539
you can pay for generating iocs or you

515
00:21:33,539 --> 00:21:35,100
can generate them on your own and it

516
00:21:35,100 --> 00:21:37,320
will work the stuff will ingest your

517
00:21:37,320 --> 00:21:40,080
data and you will get the detection

518
00:21:40,080 --> 00:21:43,380
and why because we already put some

519
00:21:43,380 --> 00:21:45,120
effort on

520
00:21:45,120 --> 00:21:47,520
we already um

521
00:21:47,520 --> 00:21:50,940
persuaded vendors that are supplying us

522
00:21:50,940 --> 00:21:53,340
with the software to put some effort on

523
00:21:53,340 --> 00:21:55,919
the security from the functionality

524
00:21:55,919 --> 00:21:58,919
perspective and I if you disagree rise a

525
00:21:58,919 --> 00:22:01,500
hand both things that I listed here like

526
00:22:01,500 --> 00:22:04,140
a code signing and a hash publication is

527
00:22:04,140 --> 00:22:06,299
completely worthless like it is not

528
00:22:06,299 --> 00:22:08,340
adding additional security to the

529
00:22:08,340 --> 00:22:10,980
software it is adding another security

530
00:22:10,980 --> 00:22:14,340
layer code signing allows you to sign

531
00:22:14,340 --> 00:22:17,039
the code and if you download it you are

532
00:22:17,039 --> 00:22:19,200
able to verify if that code was shipped

533
00:22:19,200 --> 00:22:21,659
and signed by this specific holder of

534
00:22:21,659 --> 00:22:23,700
the certificate from the business

535
00:22:23,700 --> 00:22:26,039
perspective this is a cost because they

536
00:22:26,039 --> 00:22:27,720
need to acquire acquired costly

537
00:22:27,720 --> 00:22:30,720
certificate they need to maintain the

538
00:22:30,720 --> 00:22:34,500
key management they they need to keep

539
00:22:34,500 --> 00:22:36,480
the key safe because if the key leaks

540
00:22:36,480 --> 00:22:38,340
you'll get the I don't know Windows

541
00:22:38,340 --> 00:22:41,460
driver sign buys the leaked certificate

542
00:22:41,460 --> 00:22:44,100
so this is costly and from the overall

543
00:22:44,100 --> 00:22:45,659
perspective this is not improving I

544
00:22:45,659 --> 00:22:47,340
don't know the quality of the software

545
00:22:47,340 --> 00:22:49,320
the software is not running faster if

546
00:22:49,320 --> 00:22:52,080
this is if it is being signed

547
00:22:52,080 --> 00:22:55,440
uh hash publication uh this is maybe not

548
00:22:55,440 --> 00:22:58,260
so uh caused ineffective because you

549
00:22:58,260 --> 00:23:01,140
just need to calculate a hash of your

550
00:23:01,140 --> 00:23:03,240
binaries and public publish them on your

551
00:23:03,240 --> 00:23:05,280
website but this is an additional

552
00:23:05,280 --> 00:23:07,679
process that is also not improving the

553
00:23:07,679 --> 00:23:09,960
efficiency of your software this is just

554
00:23:09,960 --> 00:23:12,419
a security feature that allows people

555
00:23:12,419 --> 00:23:14,460
when your code is for example not sign

556
00:23:14,460 --> 00:23:16,679
to verify if they have the right

557
00:23:16,679 --> 00:23:18,600
binaries on the disk like very simple

558
00:23:18,600 --> 00:23:21,199
operation

559
00:23:21,360 --> 00:23:24,360
uh do's and don'ts this the the thing

560
00:23:24,360 --> 00:23:27,299
that I would like to propose is the uh

561
00:23:27,299 --> 00:23:30,480
uh the idea may help to improve or solve

562
00:23:30,480 --> 00:23:32,340
partial problems with the security

563
00:23:32,340 --> 00:23:34,799
especially in terms of shipping a

564
00:23:34,799 --> 00:23:36,919
third-party stuff in your infrastructure

565
00:23:36,919 --> 00:23:39,659
it is just a format this is not an

566
00:23:39,659 --> 00:23:41,520
implementation this is not a solution

567
00:23:41,520 --> 00:23:45,059
I'm not creating EDR xdr endpoint

568
00:23:45,059 --> 00:23:47,400
protection firewall whatever and

569
00:23:47,400 --> 00:23:49,320
definitely not a blockchain this is

570
00:23:49,320 --> 00:23:51,419
something like iocs ioc is just a

571
00:23:51,419 --> 00:23:53,940
specification how we will write the data

572
00:23:53,940 --> 00:23:55,799
and definitely this is not a silver

573
00:23:55,799 --> 00:23:58,140
bullet this will not solve all the

574
00:23:58,140 --> 00:24:00,720
security problems this will help us to

575
00:24:00,720 --> 00:24:02,520
improve the security and maybe affect

576
00:24:02,520 --> 00:24:05,220
some specific problems

577
00:24:05,220 --> 00:24:09,480
uh let me show you the like what I had

578
00:24:09,480 --> 00:24:12,480
in mind when I was working on the format

579
00:24:12,480 --> 00:24:15,600
uh we have already rules that are human

580
00:24:15,600 --> 00:24:17,520
and computer readable like Sigma rule

581
00:24:17,520 --> 00:24:21,059
cruel rules anybody here wrote a Swagger

582
00:24:21,059 --> 00:24:23,279
openappi profile for your web

583
00:24:23,279 --> 00:24:24,720
application

584
00:24:24,720 --> 00:24:27,480
yes you see few people like you can

585
00:24:27,480 --> 00:24:30,840
describe in human readable form

586
00:24:30,840 --> 00:24:33,480
what your whole web application is

587
00:24:33,480 --> 00:24:37,140
implementing like all the possible HTTP

588
00:24:37,140 --> 00:24:38,640
requests that can be done to your

589
00:24:38,640 --> 00:24:40,320
application and you have a way to

590
00:24:40,320 --> 00:24:41,700
describe that

591
00:24:41,700 --> 00:24:43,679
and this is still human readable and

592
00:24:43,679 --> 00:24:45,179
computer readable

593
00:24:45,179 --> 00:24:47,220
rules that need to be human readable

594
00:24:47,220 --> 00:24:49,200
well structured you need to be able to

595
00:24:49,200 --> 00:24:52,860
make a very easy in a very easy way a

596
00:24:52,860 --> 00:24:55,500
diff between uh two files when somebody

597
00:24:55,500 --> 00:24:58,860
something is changing and uh the benefit

598
00:24:58,860 --> 00:25:01,500
of that unit you are able to store it in

599
00:25:01,500 --> 00:25:03,480
the repository as a tech text file so

600
00:25:03,480 --> 00:25:05,640
you are able to track the changes over

601
00:25:05,640 --> 00:25:06,960
the time

602
00:25:06,960 --> 00:25:11,880
uh rules in that format can the purpose

603
00:25:11,880 --> 00:25:14,460
is that those rules can be later on

604
00:25:14,460 --> 00:25:17,400
translated exported or you know compile

605
00:25:17,400 --> 00:25:20,100
to the other formats so for example to

606
00:25:20,100 --> 00:25:23,360
up Armor selinux

607
00:25:24,140 --> 00:25:27,140
application

608
00:25:27,320 --> 00:25:29,700
is very good example because they

609
00:25:29,700 --> 00:25:31,080
already providing very similar

610
00:25:31,080 --> 00:25:33,779
functionality but please raise a hand

611
00:25:33,779 --> 00:25:37,380
whoever read uh app armor configuration

612
00:25:37,380 --> 00:25:41,039
file like look inside one two

613
00:25:41,039 --> 00:25:44,039
it is working but this definitely the

614
00:25:44,039 --> 00:25:45,720
the part of human readable is not

615
00:25:45,720 --> 00:25:49,140
working there like yeah you can take a

616
00:25:49,140 --> 00:25:50,820
piece of paper and start drawing things

617
00:25:50,820 --> 00:25:52,440
and maybe you will understand but this

618
00:25:52,440 --> 00:25:54,960
is not definitely not so obvious

619
00:25:54,960 --> 00:25:58,320
uh and let's apply some uh good old

620
00:25:58,320 --> 00:26:02,340
python then explicit over implicit uh

621
00:26:02,340 --> 00:26:06,860
the readability is important

622
00:26:06,860 --> 00:26:09,840
if if our format needs additional

623
00:26:09,840 --> 00:26:11,640
explanation this is bad idea so this

624
00:26:11,640 --> 00:26:12,840
format need to be easy to understand

625
00:26:12,840 --> 00:26:14,700
even for the person that didn't read

626
00:26:14,700 --> 00:26:17,360
this documentation for that

627
00:26:17,360 --> 00:26:20,159
uh so yeah this is the format how we'll

628
00:26:20,159 --> 00:26:22,860
store it the problem uh of course

629
00:26:22,860 --> 00:26:25,260
there's a quickly we'll pick up the

630
00:26:25,260 --> 00:26:26,580
problem that there's a problem of

631
00:26:26,580 --> 00:26:28,260
signing those rules because if the

632
00:26:28,260 --> 00:26:30,360
vendor will will be releasing them we

633
00:26:30,360 --> 00:26:33,260
need to have a way to verify the

634
00:26:33,260 --> 00:26:36,059
Integrity of the file so we can put them

635
00:26:36,059 --> 00:26:39,200
into the JWT so the vendor can sign it

636
00:26:39,200 --> 00:26:41,340
probably maybe using even the same

637
00:26:41,340 --> 00:26:42,840
certificate that you're using for code

638
00:26:42,840 --> 00:26:45,539
signing which is asymmetric key

639
00:26:45,539 --> 00:26:48,600
uh and this is an example of the rule

640
00:26:48,600 --> 00:26:51,240
we have very simple structure we're

641
00:26:51,240 --> 00:26:53,700
defining the we have a categories like

642
00:26:53,700 --> 00:26:57,299
Network Behavior file system Behavior

643
00:26:57,299 --> 00:27:01,340
let me show you the file itself

644
00:27:04,200 --> 00:27:06,720
yeah so we have some metadata like any

645
00:27:06,720 --> 00:27:09,659
other formats targets we're defining

646
00:27:09,659 --> 00:27:11,059
what files

647
00:27:11,059 --> 00:27:14,760
what on to what files should we apply

648
00:27:14,760 --> 00:27:16,380
this rule set to

649
00:27:16,380 --> 00:27:18,419
and basically the rules of this here so

650
00:27:18,419 --> 00:27:20,100
for example for Network we specified

651
00:27:20,100 --> 00:27:22,500
that this uh this piece of software is

652
00:27:22,500 --> 00:27:24,240
allowed to connect to the example common

653
00:27:24,240 --> 00:27:27,840
on Port 80 if our solution is allowing

654
00:27:27,840 --> 00:27:30,480
us to implement layer 7 inspection we

655
00:27:30,480 --> 00:27:32,520
have the information that we expect HTTP

656
00:27:32,520 --> 00:27:34,860
there if our resolution is not allowing

657
00:27:34,860 --> 00:27:37,679
us to do so we just can live with Port

658
00:27:37,679 --> 00:27:39,559
TCP

659
00:27:39,559 --> 00:27:42,000
and only that information on the file

660
00:27:42,000 --> 00:27:44,120
system we can specify

661
00:27:44,120 --> 00:27:47,580
what paths what files can be open and

662
00:27:47,580 --> 00:27:51,120
accessed by the software and the idea

663
00:27:51,120 --> 00:27:52,799
behind the whole rule set is to apply

664
00:27:52,799 --> 00:27:57,120
the ACT allow deny order so if something

665
00:27:57,120 --> 00:28:01,080
is not being allowed explicitly it means

666
00:28:01,080 --> 00:28:03,299
that it is not being allowed at all so

667
00:28:03,299 --> 00:28:05,820
if you don't want your software to touch

668
00:28:05,820 --> 00:28:07,799
the file system just leaving the file

669
00:28:07,799 --> 00:28:10,320
system section empty and basically it

670
00:28:10,320 --> 00:28:12,000
means that your software doesn't

671
00:28:12,000 --> 00:28:14,940
supposed to touch anything on the disk

672
00:28:14,940 --> 00:28:19,200
uh exact means what kind of uh child

673
00:28:19,200 --> 00:28:21,320
processes should be

674
00:28:21,320 --> 00:28:24,919
allowed to be spawned by that process

675
00:28:24,919 --> 00:28:28,580
registry this is very platform specific

676
00:28:28,580 --> 00:28:32,399
parents means what can we expect in

677
00:28:32,399 --> 00:28:34,520
terms of our process being spawned from

678
00:28:34,520 --> 00:28:38,520
and environment means that we can put

679
00:28:38,520 --> 00:28:41,520
some information what are the allowed or

680
00:28:41,520 --> 00:28:44,100
not allowed environment viral boosts

681
00:28:44,100 --> 00:28:46,860
that are being used by our software this

682
00:28:46,860 --> 00:28:50,220
is yeah like quite basic the format is

683
00:28:50,220 --> 00:28:52,500
extendable so we can if we think about

684
00:28:52,500 --> 00:28:54,840
like I don't know maybe let's

685
00:28:54,840 --> 00:28:57,059
let's add what is the current

686
00:28:57,059 --> 00:28:58,799
temperature in the room and the software

687
00:28:58,799 --> 00:29:01,140
needs to be operated in a specific range

688
00:29:01,140 --> 00:29:03,059
of temperature we can add a section here

689
00:29:03,059 --> 00:29:05,580
not a problem

690
00:29:05,580 --> 00:29:08,640
uh how to generate that stuff

691
00:29:08,640 --> 00:29:11,039
uh vendors can use a code annotation

692
00:29:11,039 --> 00:29:13,080
they are already using Code annotation

693
00:29:13,080 --> 00:29:14,700
to generate the documentation like

694
00:29:14,700 --> 00:29:18,360
whoever spent up some time on developing

695
00:29:18,360 --> 00:29:20,899
software knows that in most modern

696
00:29:20,899 --> 00:29:23,640
programming languages you can create you

697
00:29:23,640 --> 00:29:26,100
can put a code annotation in the

698
00:29:26,100 --> 00:29:29,340
comments in your code and just by having

699
00:29:29,340 --> 00:29:31,260
them in the code you can create a

700
00:29:31,260 --> 00:29:34,799
documentation that will describe how you

701
00:29:34,799 --> 00:29:37,260
call how your code is working what's I

702
00:29:37,260 --> 00:29:41,580
don't know API are you exposing so we we

703
00:29:41,580 --> 00:29:44,760
can try to make a code annotation so for

704
00:29:44,760 --> 00:29:46,799
example for example if we have and this

705
00:29:46,799 --> 00:29:48,779
is an obvious way to do that if we have

706
00:29:48,779 --> 00:29:50,460
a function that is I don't know loading

707
00:29:50,460 --> 00:29:52,140
a configuration file from the disk we

708
00:29:52,140 --> 00:29:54,440
can add a code annotation that we expect

709
00:29:54,440 --> 00:29:56,820
read and write access to the specific

710
00:29:56,820 --> 00:29:58,980
file on the disk

711
00:29:58,980 --> 00:30:01,679
uh of course we can generate that

712
00:30:01,679 --> 00:30:04,320
profile by sandboxing monitoring Etc so

713
00:30:04,320 --> 00:30:06,659
we can just list of uh list the events

714
00:30:06,659 --> 00:30:08,279
that are happening and add them to the

715
00:30:08,279 --> 00:30:09,960
white list

716
00:30:09,960 --> 00:30:13,320
or we can do just do the manual work

717
00:30:13,320 --> 00:30:15,659
and let me show you an example of the

718
00:30:15,659 --> 00:30:17,940
rule for example a very obvious rule for

719
00:30:17,940 --> 00:30:19,550
Notepad

720
00:30:19,550 --> 00:30:22,780
[Music]

721
00:30:26,880 --> 00:30:28,860
okay so this is a rule for the notepad

722
00:30:28,860 --> 00:30:31,020
no notepad supposed to

723
00:30:31,020 --> 00:30:34,940
I'll just stop displaying correctly

724
00:30:34,980 --> 00:30:37,740
yeah notepad supposed to open read and

725
00:30:37,740 --> 00:30:39,539
write files on the disk it doesn't

726
00:30:39,539 --> 00:30:41,480
supposed to I don't know do a network

727
00:30:41,480 --> 00:30:46,200
communication spawn a process uh I don't

728
00:30:46,200 --> 00:30:49,559
know execute anything like if you will

729
00:30:49,559 --> 00:30:51,600
see a notepad spawning a new process

730
00:30:51,600 --> 00:30:53,100
this is definitely not something

731
00:30:53,100 --> 00:30:54,960
expected from the notepad

732
00:30:54,960 --> 00:30:58,380
so in this way in those like few lines

733
00:30:58,380 --> 00:31:01,799
of text we created a profile for a

734
00:31:01,799 --> 00:31:03,840
notepad I think that has been common to

735
00:31:03,840 --> 00:31:07,740
use in very naive exploitation paths but

736
00:31:07,740 --> 00:31:10,740
like it will work later on you can fit

737
00:31:10,740 --> 00:31:13,140
that knowledge into your security

738
00:31:13,140 --> 00:31:15,240
solution and see like if if there is

739
00:31:15,240 --> 00:31:17,100
something that is not fitting the

740
00:31:17,100 --> 00:31:19,519
profile this is definitely the

741
00:31:19,519 --> 00:31:22,500
uh definitely the indicator of

742
00:31:22,500 --> 00:31:24,960
indicators being compromised so we're

743
00:31:24,960 --> 00:31:26,460
going back to the indicator of the

744
00:31:26,460 --> 00:31:28,620
compromise but we we don't need to

745
00:31:28,620 --> 00:31:30,600
Define explicitly that we are looking

746
00:31:30,600 --> 00:31:33,539
for something uh malicious here

747
00:31:33,539 --> 00:31:35,760
and let me show you an example how we

748
00:31:35,760 --> 00:31:39,080
can see the changes in the file

749
00:31:43,919 --> 00:31:46,340
okay

750
00:31:51,299 --> 00:31:53,940
yeah so so if even if the attacker would

751
00:31:53,940 --> 00:31:56,580
manage to compromise the supply chain uh

752
00:31:56,580 --> 00:31:59,279
of the vendor and even even if they

753
00:31:59,279 --> 00:32:02,940
manage to compromise this ion rule set

754
00:32:02,940 --> 00:32:04,980
and Pub the vendor will publish like

755
00:32:04,980 --> 00:32:07,799
they they will be I know stupid and will

756
00:32:07,799 --> 00:32:10,019
publish anything that will be uh

757
00:32:10,019 --> 00:32:13,559
delivered by the uh by the by the

758
00:32:13,559 --> 00:32:18,960
pipeline uh any any one without any

759
00:32:18,960 --> 00:32:21,120
reverse engineering can take a look on

760
00:32:21,120 --> 00:32:23,700
the NCO case somebody added a huge

761
00:32:23,700 --> 00:32:26,039
section here and the software that

762
00:32:26,039 --> 00:32:28,860
previously in pass over past five years

763
00:32:28,860 --> 00:32:32,840
was not executing anything it's like

764
00:32:32,840 --> 00:32:36,419
allowed allowed to execute arbitrary

765
00:32:36,419 --> 00:32:39,620
binary from the disk

766
00:32:40,679 --> 00:32:42,840
there are still some open problems like

767
00:32:42,840 --> 00:32:45,480
how can we pin policy to a binary using

768
00:32:45,480 --> 00:32:48,299
harsh signatures Etc how can we handle

769
00:32:48,299 --> 00:32:50,519
script interpreters or LOL bins this is

770
00:32:50,519 --> 00:32:52,019
our open subject

771
00:32:52,019 --> 00:32:54,480
uh one of the ideas here to create a

772
00:32:54,480 --> 00:32:58,559
regular uh sorry a pattern for what uh

773
00:32:58,559 --> 00:33:01,200
what arguments for the process are being

774
00:33:01,200 --> 00:33:04,440
allowed and in terms of networking

775
00:33:04,440 --> 00:33:08,760
there's always a problem in uh

776
00:33:08,760 --> 00:33:11,880
domain name resolution versus time to

777
00:33:11,880 --> 00:33:15,179
check versus time to use DNS rebinding

778
00:33:15,179 --> 00:33:17,159
Etc but I think

779
00:33:17,159 --> 00:33:21,179
uh those are the minor problems here

780
00:33:21,179 --> 00:33:24,539
uh I want to thank to give a big thank

781
00:33:24,539 --> 00:33:27,059
to everybody who I ask about the opinion

782
00:33:27,059 --> 00:33:29,460
or help on that subject here for over

783
00:33:29,460 --> 00:33:30,720
past year

784
00:33:30,720 --> 00:33:32,519
I I don't want to list them because

785
00:33:32,519 --> 00:33:35,279
there's like a huge list of the person I

786
00:33:35,279 --> 00:33:38,100
and I may miss somebody so big thank you

787
00:33:38,100 --> 00:33:40,140
to everybody who helped me on improving

788
00:33:40,140 --> 00:33:41,039
that

789
00:33:41,039 --> 00:33:45,500
uh please feel free to contribute

