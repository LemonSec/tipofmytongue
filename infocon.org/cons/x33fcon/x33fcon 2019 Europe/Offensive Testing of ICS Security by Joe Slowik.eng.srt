1
00:00:08,179 --> 00:00:12,389
good morning thank you everyone so yes

2
00:00:11,190 --> 00:00:14,639
my name is Joe Slovak

3
00:00:12,389 --> 00:00:15,838
and I'll be talking about offensive

4
00:00:14,639 --> 00:00:18,570
testing of ICS security

5
00:00:15,839 --> 00:00:21,420
industrial-strength purple teaming so

6
00:00:18,570 --> 00:00:23,640
first who am I actually got my start as

7
00:00:21,420 --> 00:00:26,070
well a student does everyone does but as

8
00:00:23,640 --> 00:00:27,689
a philosophy student which is very far

9
00:00:26,070 --> 00:00:29,099
removed from where I am today and I

10
00:00:27,689 --> 00:00:32,910
realized the error of my ways so I

11
00:00:29,099 --> 00:00:35,550
joined the Navy as already stated and

12
00:00:32,910 --> 00:00:38,459
doing things more on the offensive

13
00:00:35,550 --> 00:00:40,078
attacker side in that role and then when

14
00:00:38,460 --> 00:00:41,910
I got out of that I switched to a blue

15
00:00:40,079 --> 00:00:42,899
team defensive role running incident

16
00:00:41,910 --> 00:00:45,809
response at Los Alamos National

17
00:00:42,899 --> 00:00:48,570
Laboratory for several years and then

18
00:00:45,809 --> 00:00:51,930
moved over almost exactly two years ago

19
00:00:48,570 --> 00:00:54,059
now to Drago's where I do ICS security I

20
00:00:51,930 --> 00:00:55,769
was given the very flattering comment of

21
00:00:54,059 --> 00:00:57,839
being an expert I'm not an expert I just

22
00:00:55,770 --> 00:00:59,550
ask lots and lots and lots of questions

23
00:00:57,840 --> 00:01:01,020
and hopefully some of them get answered

24
00:00:59,550 --> 00:01:02,578
and find out things along the way and

25
00:01:01,020 --> 00:01:05,040
hopefully as a result of that I can

26
00:01:02,579 --> 00:01:07,350
share some information with everyone

27
00:01:05,040 --> 00:01:09,420
present so that we all might advance a

28
00:01:07,350 --> 00:01:11,369
little bit together but as far as what

29
00:01:09,420 --> 00:01:12,810
we're going to talk about today is well

30
00:01:11,369 --> 00:01:14,670
first we'll go through some definitions

31
00:01:12,810 --> 00:01:17,040
and preliminaries just to make sure that

32
00:01:14,670 --> 00:01:18,390
we are all reasonably on the same page

33
00:01:17,040 --> 00:01:20,280
with what we're talking about in terms

34
00:01:18,390 --> 00:01:22,320
of the industrial control environment

35
00:01:20,280 --> 00:01:24,750
and then talk about an overview of

36
00:01:22,320 --> 00:01:26,908
attacks and adversary techniques since

37
00:01:24,750 --> 00:01:28,740
we want to model how we test security

38
00:01:26,909 --> 00:01:30,030
based upon what's going on in the wild

39
00:01:28,740 --> 00:01:32,880
and what sort of options are available

40
00:01:30,030 --> 00:01:34,439
to us and then go into security testing

41
00:01:32,880 --> 00:01:36,929
methodologies and applications for

42
00:01:34,439 --> 00:01:40,020
actual industrial control system focused

43
00:01:36,930 --> 00:01:42,060
purple teaming operations so first off

44
00:01:40,020 --> 00:01:43,710
what is an industrial control system

45
00:01:42,060 --> 00:01:45,960
this might seem to be an obvious

46
00:01:43,710 --> 00:01:47,369
question and or have an obvious answer

47
00:01:45,960 --> 00:01:49,979
and yet it really doesn't because if you

48
00:01:47,369 --> 00:01:51,780
ask 10 people especially 10 people who

49
00:01:49,979 --> 00:01:53,850
are not intimately involved in the field

50
00:01:51,780 --> 00:01:55,350
you'll get probably seven or six

51
00:01:53,850 --> 00:01:58,649
different answers some of which will be

52
00:01:55,350 --> 00:02:00,509
completely wrong so for the scope of

53
00:01:58,649 --> 00:02:02,100
this argument will talk about industrial

54
00:02:00,509 --> 00:02:05,340
controls as being those connected

55
00:02:02,100 --> 00:02:07,350
systems that control monitor or

56
00:02:05,340 --> 00:02:09,750
otherwise have some influence over an

57
00:02:07,350 --> 00:02:11,430
industrial process in making that

58
00:02:09,750 --> 00:02:13,140
statement what we're talking what we're

59
00:02:11,430 --> 00:02:15,870
not going to talk about are you

60
00:02:13,140 --> 00:02:18,600
Internet of Things devices your smart

61
00:02:15,870 --> 00:02:21,270
meters smart doorbell smart toasters etc

62
00:02:18,600 --> 00:02:23,160
really just focusing in on what are

63
00:02:21,270 --> 00:02:25,920
purely industrial equipment the things

64
00:02:23,160 --> 00:02:30,240
that you would find in a factory in oil

65
00:02:25,920 --> 00:02:31,920
refinery a power plant etc and when we

66
00:02:30,240 --> 00:02:33,390
talk about industrial control systems

67
00:02:31,920 --> 00:02:34,950
what we've observed are a number of

68
00:02:33,390 --> 00:02:37,619
trends and how these systems operate

69
00:02:34,950 --> 00:02:39,299
that impact and influence how it is that

70
00:02:37,620 --> 00:02:41,730
we both treat them as defenders and how

71
00:02:39,300 --> 00:02:43,890
we can approach them as attackers where

72
00:02:41,730 --> 00:02:46,320
they're real attackers or attackers from

73
00:02:43,890 --> 00:02:48,390
a testing standpoint so we're seeing an

74
00:02:46,320 --> 00:02:50,280
increasing adoption of information

75
00:02:48,390 --> 00:02:52,799
technology within control system

76
00:02:50,280 --> 00:02:54,720
environments combined with a extension

77
00:02:52,800 --> 00:02:56,010
of the perimeter instead of things being

78
00:02:54,720 --> 00:02:58,770
air-gapped you have increasing

79
00:02:56,010 --> 00:03:00,810
connectivity and an increasing vendor

80
00:02:58,770 --> 00:03:02,730
interest in cyber secure in industrial

81
00:03:00,810 --> 00:03:06,270
control security like my company down

82
00:03:02,730 --> 00:03:08,700
for example but first the idea fication

83
00:03:06,270 --> 00:03:10,620
of industrial control systems what does

84
00:03:08,700 --> 00:03:12,679
that mean well what we've seen is that

85
00:03:10,620 --> 00:03:14,640
due to increased efficiencies

86
00:03:12,680 --> 00:03:17,610
integrating more commercial

87
00:03:14,640 --> 00:03:19,920
off-the-shelf hardware to realize cost

88
00:03:17,610 --> 00:03:22,530
savings you know why build a custom

89
00:03:19,920 --> 00:03:25,440
system develop a custom operating system

90
00:03:22,530 --> 00:03:27,890
when I can just reskin rebrand a Windows

91
00:03:25,440 --> 00:03:30,359
device or a Cisco Network appliance

92
00:03:27,890 --> 00:03:32,670
strengthen it harden it somehow or for a

93
00:03:30,360 --> 00:03:34,470
harsh environment and then put it into

94
00:03:32,670 --> 00:03:38,190
the network the result is that we

95
00:03:34,470 --> 00:03:40,080
eliminate a lot of the confusing bits of

96
00:03:38,190 --> 00:03:42,209
control system environments in terms of

97
00:03:40,080 --> 00:03:43,590
custom environments air gaps and you

98
00:03:42,209 --> 00:03:44,880
know lots of distinctions from what

99
00:03:43,590 --> 00:03:47,750
would be a traditional enterprise IT

100
00:03:44,880 --> 00:03:51,660
environment but in doing so we've

101
00:03:47,750 --> 00:03:52,860
exported the IT attack surface so all of

102
00:03:51,660 --> 00:03:55,380
your windows exploits all of your

103
00:03:52,860 --> 00:03:57,180
windows owner abilities etc are now

104
00:03:55,380 --> 00:03:58,799
brought into an industrial control space

105
00:03:57,180 --> 00:04:01,170
but we'll help bring in a lot of the

106
00:03:58,799 --> 00:04:03,380
same security capabilities because even

107
00:04:01,170 --> 00:04:05,369
though we've imported Enterprise IT

108
00:04:03,380 --> 00:04:07,590
practices and software and hardware

109
00:04:05,370 --> 00:04:09,600
we've also had to apply them in ways

110
00:04:07,590 --> 00:04:11,459
that still don't allow us to do the same

111
00:04:09,600 --> 00:04:15,720
amount of flexibility in terms of

112
00:04:11,459 --> 00:04:18,149
monitoring data capture installing a EDR

113
00:04:15,720 --> 00:04:19,738
product etc so you're really left with a

114
00:04:18,149 --> 00:04:21,649
more constrained security space to

115
00:04:19,738 --> 00:04:24,030
operate while dealing with all of this

116
00:04:21,649 --> 00:04:26,070
meanwhile as a result of some of these

117
00:04:24,030 --> 00:04:26,609
same trends the perimeter no longer is

118
00:04:26,070 --> 00:04:28,830
you have

119
00:04:26,610 --> 00:04:30,360
this very much isolated industrial

120
00:04:28,830 --> 00:04:31,859
control network that shouldn't be

121
00:04:30,360 --> 00:04:33,300
connected to the Internet as anyone who

122
00:04:31,860 --> 00:04:35,699
looks at shoten can tell you that that

123
00:04:33,300 --> 00:04:37,949
is not the case but just by virtue of

124
00:04:35,699 --> 00:04:40,289
having to connect to vendor and

125
00:04:37,949 --> 00:04:42,930
contractor networks for example to

126
00:04:40,289 --> 00:04:46,289
receive updates or to send telemetry to

127
00:04:42,930 --> 00:04:48,090
the vendor of a particular product or to

128
00:04:46,289 --> 00:04:49,800
allow for remote work in administration

129
00:04:48,090 --> 00:04:52,289
not just the engineer working from home

130
00:04:49,800 --> 00:04:55,289
so to speak but an engineer it is single

131
00:04:52,289 --> 00:04:57,568
central location being able to access

132
00:04:55,289 --> 00:05:00,960
and control multiple field devices from

133
00:04:57,569 --> 00:05:04,139
that location at the same time so RTP

134
00:05:00,960 --> 00:05:06,270
access SSH access VNC access hopefully

135
00:05:04,139 --> 00:05:08,400
not among other items and then we're

136
00:05:06,270 --> 00:05:10,710
even seeing increasing use of cloud and

137
00:05:08,400 --> 00:05:13,109
off-premise sort of solutions in these

138
00:05:10,710 --> 00:05:15,568
fields such as for data gathering etc so

139
00:05:13,110 --> 00:05:17,610
you're seeing increased links from what

140
00:05:15,569 --> 00:05:19,919
we used to be fairly isolated networks

141
00:05:17,610 --> 00:05:22,349
to cloud-based deployments that

142
00:05:19,919 --> 00:05:24,120
introduce additional risks for

143
00:05:22,349 --> 00:05:26,449
connectivity and how to access otherwise

144
00:05:24,120 --> 00:05:29,250
sensitive equipment and machines and

145
00:05:26,449 --> 00:05:31,069
finally in looking at this from a vendor

146
00:05:29,250 --> 00:05:33,990
security perspective we were seeing a

147
00:05:31,069 --> 00:05:37,349
trend towards one size all fit security

148
00:05:33,990 --> 00:05:38,729
so you know the latest hotness fashion

149
00:05:37,349 --> 00:05:40,919
however you want to phrase it is

150
00:05:38,729 --> 00:05:43,050
industrial control system security this

151
00:05:40,919 --> 00:05:46,080
is exciting important you can blow up

152
00:05:43,050 --> 00:05:47,969
plants or shut off the power etc and as

153
00:05:46,080 --> 00:05:50,669
part of this narrative you're seeing a

154
00:05:47,969 --> 00:05:52,919
the itea fication of these environments

155
00:05:50,669 --> 00:05:54,839
as a justification for oh I take the

156
00:05:52,919 --> 00:05:57,000
same security solution that I'm using in

157
00:05:54,839 --> 00:05:58,979
my corporate environment for the email

158
00:05:57,000 --> 00:06:01,050
servers and domain controller and the

159
00:05:58,979 --> 00:06:04,110
file servers and just apply that to the

160
00:06:01,050 --> 00:06:05,580
HMI is the engineering work stations etc

161
00:06:04,110 --> 00:06:07,740
the problem is is that that approach

162
00:06:05,580 --> 00:06:09,719
fails to recognize how these

163
00:06:07,740 --> 00:06:12,150
technologies are actually deployed for

164
00:06:09,719 --> 00:06:13,860
an industrial use case scenario and what

165
00:06:12,150 --> 00:06:16,049
the limitations are in play and how that

166
00:06:13,860 --> 00:06:18,000
then comes into play for monitoring how

167
00:06:16,050 --> 00:06:19,650
these systems work on a day-to-day basis

168
00:06:18,000 --> 00:06:22,639
as well as what sorts of capabilities

169
00:06:19,650 --> 00:06:25,799
you have to test manipulate or otherwise

170
00:06:22,639 --> 00:06:27,060
discern how these systems are operating

171
00:06:25,800 --> 00:06:30,089
and it might be manipulated to cause

172
00:06:27,060 --> 00:06:32,250
something suboptimal or not very nice in

173
00:06:30,089 --> 00:06:34,050
the process and when we're talking about

174
00:06:32,250 --> 00:06:36,000
all of these trends we're overlaying

175
00:06:34,050 --> 00:06:39,089
this upon how industrial control

176
00:06:36,000 --> 00:06:39,849
networks are attacked so much like we've

177
00:06:39,089 --> 00:06:41,679
Howard

178
00:06:39,849 --> 00:06:43,869
referred to this several times in only a

179
00:06:41,679 --> 00:06:45,549
couple of presentations today that a

180
00:06:43,869 --> 00:06:48,279
attack is not a simple bolt from the

181
00:06:45,550 --> 00:06:51,009
blue but rather represents a process of

182
00:06:48,279 --> 00:06:53,020
several discrete steps so to simplify

183
00:06:51,009 --> 00:06:54,520
this you know you breach the victims IT

184
00:06:53,020 --> 00:06:57,188
network unless you have an insider

185
00:06:54,520 --> 00:06:59,469
that's putting in the USB key into the

186
00:06:57,189 --> 00:07:01,869
plant environment etc you don't see that

187
00:06:59,469 --> 00:07:03,520
too often thankfully but from that

188
00:07:01,869 --> 00:07:05,169
initial access point you then identify

189
00:07:03,520 --> 00:07:06,909
points of contact with your control

190
00:07:05,169 --> 00:07:09,039
system environment leveraging this

191
00:07:06,909 --> 00:07:11,649
increased connectivity between enclaves

192
00:07:09,039 --> 00:07:13,330
to then enumerate and categorize that

193
00:07:11,649 --> 00:07:15,309
industrial environment to determine what

194
00:07:13,330 --> 00:07:17,709
software and hardware is in play and

195
00:07:15,309 --> 00:07:19,209
then deliver whatever effects you have

196
00:07:17,709 --> 00:07:21,339
on objective that could be as simple as

197
00:07:19,209 --> 00:07:22,949
getting on to a piece of equipment that

198
00:07:21,339 --> 00:07:24,729
allows you to turn a system off or

199
00:07:22,949 --> 00:07:26,740
manipulate it in some way that the

200
00:07:24,729 --> 00:07:28,508
operating engineer would not like it or

201
00:07:26,740 --> 00:07:30,459
deploying some sort of industrial

202
00:07:28,509 --> 00:07:34,389
control specific malware to do something

203
00:07:30,459 --> 00:07:36,279
particularly nasty in looking at this we

204
00:07:34,389 --> 00:07:38,169
can map this to a industrial control

205
00:07:36,279 --> 00:07:40,240
specific kill chain so the ICS cyber

206
00:07:38,169 --> 00:07:42,219
kill chain is a sans developed concept

207
00:07:40,240 --> 00:07:43,839
the most important thing to take from

208
00:07:42,219 --> 00:07:46,089
this isn't necessarily the discrete

209
00:07:43,839 --> 00:07:48,129
steps per se but rather to look at the

210
00:07:46,089 --> 00:07:50,259
bifurcation between different stages of

211
00:07:48,129 --> 00:07:52,930
the operation is that you have a stage

212
00:07:50,259 --> 00:07:54,669
one IT centric operation that initial

213
00:07:52,930 --> 00:07:56,519
network access getting into the

214
00:07:54,669 --> 00:07:59,049
environment allowing for remote access

215
00:07:56,519 --> 00:08:01,539
followed by a second stage operation

216
00:07:59,050 --> 00:08:03,759
where you'd start going into the actual

217
00:08:01,539 --> 00:08:06,339
control system environment in order to

218
00:08:03,759 --> 00:08:08,439
manipulate or otherwise subvert the

219
00:08:06,339 --> 00:08:09,999
industrial process so it's almost like

220
00:08:08,439 --> 00:08:11,919
you have two separate attacks or at

221
00:08:09,999 --> 00:08:13,990
least two distinct phases combined into

222
00:08:11,919 --> 00:08:16,448
a single event and an attacker needs to

223
00:08:13,990 --> 00:08:18,069
be successful in all of these stages in

224
00:08:16,449 --> 00:08:20,979
order to actually achieve that final

225
00:08:18,069 --> 00:08:22,599
execution of an ICS attack but what does

226
00:08:20,979 --> 00:08:23,919
attack mean so everyone wants to say

227
00:08:22,599 --> 00:08:27,099
attack it if you look in the media all

228
00:08:23,919 --> 00:08:28,839
of you see you know something such or

229
00:08:27,099 --> 00:08:30,279
whatever was attacked or cyber attack

230
00:08:28,839 --> 00:08:31,659
happened but for the sake of this

231
00:08:30,279 --> 00:08:33,729
argument we're going to focus on two

232
00:08:31,659 --> 00:08:35,948
distinct phases so there's preparatory

233
00:08:33,729 --> 00:08:37,569
actions so I haven't attacked yet but

234
00:08:35,948 --> 00:08:39,429
I'm taking these steps that I need to

235
00:08:37,568 --> 00:08:41,500
deploy in order to make an attack

236
00:08:39,429 --> 00:08:44,078
possible later on and then from an

237
00:08:41,500 --> 00:08:45,880
attack perspective deny degrade destroy

238
00:08:44,078 --> 00:08:47,859
a very military definition of what

239
00:08:45,880 --> 00:08:49,269
attack looks like but for our purposes

240
00:08:47,860 --> 00:08:51,220
it really goes to the heart of the

241
00:08:49,269 --> 00:08:53,550
matter that we really want to only focus

242
00:08:51,220 --> 00:08:57,189
on those things that will no kidding

243
00:08:53,550 --> 00:08:58,990
damage destroy or otherwise maliciously

244
00:08:57,189 --> 00:09:01,599
manipulate an industrial process

245
00:08:58,990 --> 00:09:04,059
so if I have Conficker in an ICS network

246
00:09:01,600 --> 00:09:05,949
that's not ideal but at the same time I

247
00:09:04,059 --> 00:09:07,630
might not care because this do anything

248
00:09:05,949 --> 00:09:08,920
I might want to eliminate it later on

249
00:09:07,630 --> 00:09:10,689
but I haven't really been attacked

250
00:09:08,920 --> 00:09:13,059
something just happened and it's not

251
00:09:10,689 --> 00:09:15,040
causing any sort of overhead or impact

252
00:09:13,059 --> 00:09:16,540
right away so I could safely ignore that

253
00:09:15,040 --> 00:09:18,399
at least for the time being which might

254
00:09:16,540 --> 00:09:20,110
sound counterintuitive but because I'm

255
00:09:18,399 --> 00:09:22,510
really emphasizing availability and

256
00:09:20,110 --> 00:09:23,860
process integrity that might be fine so

257
00:09:22,510 --> 00:09:26,199
if we're looking at this more

258
00:09:23,860 --> 00:09:28,089
constrained definition of what an attack

259
00:09:26,199 --> 00:09:30,219
is you know we also have lots of things

260
00:09:28,089 --> 00:09:32,680
that aren't attacks so examples of

261
00:09:30,220 --> 00:09:34,899
things that are real intrusion scenarios

262
00:09:32,680 --> 00:09:36,638
but haven't resulted in or didn't appear

263
00:09:34,899 --> 00:09:39,550
to have the intention to result in a

264
00:09:36,639 --> 00:09:41,880
actual attack scenario to your classic

265
00:09:39,550 --> 00:09:44,680
fear uncertainty and doubt

266
00:09:41,880 --> 00:09:47,559
Laden stories or whatever about blowing

267
00:09:44,680 --> 00:09:49,719
up pipelines or even you know one

268
00:09:47,559 --> 00:09:51,699
notorious example would be the clear

269
00:09:49,720 --> 00:09:52,990
energy in the wild scalar ransomware

270
00:09:51,699 --> 00:09:54,939
that was actually a proof of concept

271
00:09:52,990 --> 00:09:56,559
that had some very interesting marketing

272
00:09:54,939 --> 00:09:58,420
around it so we're kind of really pay

273
00:09:56,559 --> 00:10:00,160
attention to any of these so much but

274
00:09:58,420 --> 00:10:02,979
really try to focus on what's actually

275
00:10:00,160 --> 00:10:05,410
happened in the field in the field what

276
00:10:02,980 --> 00:10:07,209
we've seen are many you know going from

277
00:10:05,410 --> 00:10:09,130
that preparatory stage to actual attacks

278
00:10:07,209 --> 00:10:11,079
we see lots of this reconnaissance

279
00:10:09,130 --> 00:10:12,610
initial access activity trying to learn

280
00:10:11,079 --> 00:10:15,579
these environments and get that initial

281
00:10:12,610 --> 00:10:17,709
football that stage one sort of aspect

282
00:10:15,579 --> 00:10:20,199
of attacks but fewer examples that then

283
00:10:17,709 --> 00:10:23,380
proceed to that stage to actual denied

284
00:10:20,199 --> 00:10:25,389
degrade destroy deny degrade and destroy

285
00:10:23,380 --> 00:10:28,059
stage which is good because that's very

286
00:10:25,389 --> 00:10:29,380
bad and we don't want that to happen but

287
00:10:28,059 --> 00:10:30,939
from an attack modeling and

288
00:10:29,380 --> 00:10:33,939
understanding perspective it leaves us

289
00:10:30,939 --> 00:10:36,639
with a circumscribed set of examples

290
00:10:33,939 --> 00:10:37,930
from which we can draw to learn how

291
00:10:36,639 --> 00:10:40,389
these environments are attacked and what

292
00:10:37,930 --> 00:10:42,519
options are available to attackers so if

293
00:10:40,389 --> 00:10:44,920
we're talking about actual no-kidding

294
00:10:42,519 --> 00:10:46,990
a control system environment and

295
00:10:44,920 --> 00:10:49,029
industrial process has been attacked has

296
00:10:46,990 --> 00:10:51,459
been somehow degraded we're really only

297
00:10:49,029 --> 00:10:53,889
talking about a handful of activities so

298
00:10:51,459 --> 00:10:55,750
in terms of malware you know I have the

299
00:10:53,889 --> 00:10:56,319
privilege of being the first to say for

300
00:10:55,750 --> 00:10:59,140
this event

301
00:10:56,319 --> 00:11:00,849
Stuxnet um we have that we're not talk

302
00:10:59,140 --> 00:11:02,799
about it too much because Stuxnet is

303
00:11:00,850 --> 00:11:04,329
really kind of an outlier in many ways

304
00:11:02,799 --> 00:11:06,310
and we can talk about this offline later

305
00:11:04,329 --> 00:11:08,260
if you'd like but then we start getting

306
00:11:06,310 --> 00:11:11,380
into the early 2010's things like

307
00:11:08,260 --> 00:11:13,360
Havoc's black energy - and then crash

308
00:11:11,380 --> 00:11:15,580
override and destroyer and trisys Triton

309
00:11:13,360 --> 00:11:17,500
events reading it a little bit further

310
00:11:15,580 --> 00:11:18,640
in terms of ICS disruptive events some

311
00:11:17,500 --> 00:11:21,490
of these didn't actually involve

312
00:11:18,640 --> 00:11:23,680
specific malware so we have the 2014

313
00:11:21,490 --> 00:11:27,180
German steel mill event where a steel

314
00:11:23,680 --> 00:11:29,650
mill in Germany ended up basically

315
00:11:27,180 --> 00:11:31,479
ripping itself apart as a result of a

316
00:11:29,650 --> 00:11:33,910
cyber event at least as reported by the

317
00:11:31,480 --> 00:11:37,000
BSI in Germany still not too many

318
00:11:33,910 --> 00:11:39,040
details on that one or 2015 with Ukraine

319
00:11:37,000 --> 00:11:41,200
while black energy 3 was used to

320
00:11:39,040 --> 00:11:42,969
facilitate that attack black energy 3

321
00:11:41,200 --> 00:11:44,890
was more of a means to an end with the

322
00:11:42,970 --> 00:11:47,430
actual industrial manipulation being

323
00:11:44,890 --> 00:11:49,569
someone manually interacting with the

324
00:11:47,430 --> 00:11:51,099
engineering work station to open

325
00:11:49,570 --> 00:11:53,500
breakers and then getting into the crash

326
00:11:51,100 --> 00:11:55,690
override in crisis events so not too

327
00:11:53,500 --> 00:11:57,040
many examples that we can look at here

328
00:11:55,690 --> 00:11:59,680
but what we can look at with these

329
00:11:57,040 --> 00:12:01,900
examples is an overall trend leaving

330
00:11:59,680 --> 00:12:03,849
again Stuxnet out as an outlier of that

331
00:12:01,900 --> 00:12:06,220
over time we move from things like

332
00:12:03,850 --> 00:12:08,920
Havoc's and black energy to we're just

333
00:12:06,220 --> 00:12:10,900
trying to get into and extract

334
00:12:08,920 --> 00:12:12,760
information from human machine

335
00:12:10,900 --> 00:12:14,920
interfaces and other devices within the

336
00:12:12,760 --> 00:12:16,930
networks to a greater adversary at risk

337
00:12:14,920 --> 00:12:18,310
tolerance for first actually

338
00:12:16,930 --> 00:12:19,870
manipulating processes to cause a

339
00:12:18,310 --> 00:12:22,329
disruption like we saw with the Ukraine

340
00:12:19,870 --> 00:12:24,250
examples to a pursuit of physical ICS

341
00:12:22,330 --> 00:12:26,200
attacks like with where trisys and

342
00:12:24,250 --> 00:12:27,850
Triton was probably going towards

343
00:12:26,200 --> 00:12:30,040
subverting the safety of that plant

344
00:12:27,850 --> 00:12:31,510
environment that starts creating danger

345
00:12:30,040 --> 00:12:33,219
for asset owners and people in that

346
00:12:31,510 --> 00:12:34,960
environment so we're talking about this

347
00:12:33,220 --> 00:12:36,760
from a purple team perspective these are

348
00:12:34,960 --> 00:12:38,080
events that we need to be very mindful

349
00:12:36,760 --> 00:12:39,550
of and trying to figure out a way to

350
00:12:38,080 --> 00:12:41,589
test for those scenarios but we can

351
00:12:39,550 --> 00:12:43,750
never proceed all the way to an attack

352
00:12:41,589 --> 00:12:45,280
like we would an enterprise IT where yes

353
00:12:43,750 --> 00:12:47,020
you can subvert Active Directory and

354
00:12:45,280 --> 00:12:49,300
dump all domain credentials or whatever

355
00:12:47,020 --> 00:12:51,250
you can't subvert a safety system in a

356
00:12:49,300 --> 00:12:52,540
plant environment to prove that this is

357
00:12:51,250 --> 00:12:55,870
the case because you might kill someone

358
00:12:52,540 --> 00:12:57,520
which would be very bad in looking at

359
00:12:55,870 --> 00:12:59,980
how these attacks play out though over

360
00:12:57,520 --> 00:13:02,589
the course of the kill chain we see a

361
00:12:59,980 --> 00:13:04,510
definite break in how these have taken

362
00:13:02,589 --> 00:13:08,350
place over time so if you start talking

363
00:13:04,510 --> 00:13:09,939
about pre 2016 so everything again

364
00:13:08,350 --> 00:13:12,670
leaving Stuxnet out of the conversation

365
00:13:09,940 --> 00:13:15,100
but from Havoc's operations through the

366
00:13:12,670 --> 00:13:18,069
first Ukraine event so a lot of custom

367
00:13:15,100 --> 00:13:19,690
malware and tools used for actually

368
00:13:18,070 --> 00:13:20,600
kicking off the operations your stage

369
00:13:19,690 --> 00:13:22,730
one act

370
00:13:20,600 --> 00:13:25,580
your initial stage two activity pivoting

371
00:13:22,730 --> 00:13:27,170
through the environment and then exploit

372
00:13:25,580 --> 00:13:29,900
use for movement and access and then

373
00:13:27,170 --> 00:13:31,579
manual operations for your ICS impact so

374
00:13:29,900 --> 00:13:33,890
pretty much just a human operator

375
00:13:31,580 --> 00:13:37,280
getting onto a control system and like

376
00:13:33,890 --> 00:13:39,560
we saw in 2015 Ukraine being vien seeing

377
00:13:37,280 --> 00:13:41,030
to the machine and manually open opening

378
00:13:39,560 --> 00:13:42,800
breakers there's a YouTube video of the

379
00:13:41,030 --> 00:13:44,360
operator filming with his cell phone

380
00:13:42,800 --> 00:13:46,729
camera of the mouse moving from the

381
00:13:44,360 --> 00:13:49,160
remote connection and the attack taking

382
00:13:46,730 --> 00:13:51,980
place but then in current operations all

383
00:13:49,160 --> 00:13:53,240
that custom malware in the initial

384
00:13:51,980 --> 00:13:55,640
stages of the attack is more or less

385
00:13:53,240 --> 00:13:58,190
gone away and we've seen a increased

386
00:13:55,640 --> 00:14:00,620
willingness or desire to live off the

387
00:13:58,190 --> 00:14:01,700
land or use a lot of the same tool sets

388
00:14:00,620 --> 00:14:03,470
that we're familiar with from a

389
00:14:01,700 --> 00:14:05,530
penetration testing environment so

390
00:14:03,470 --> 00:14:08,600
things like power sploit cobalt strike

391
00:14:05,530 --> 00:14:10,970
lots and lots of mini cats etc so

392
00:14:08,600 --> 00:14:13,070
nothing that really sticks out as being

393
00:14:10,970 --> 00:14:15,320
you know super sophisticated cyber

394
00:14:13,070 --> 00:14:17,000
weapon sort of activity but still very

395
00:14:15,320 --> 00:14:18,920
effective and relying mostly on

396
00:14:17,000 --> 00:14:20,840
credential theft and reuse in order to

397
00:14:18,920 --> 00:14:22,310
move through these environments but then

398
00:14:20,840 --> 00:14:24,320
as we start getting into that later

399
00:14:22,310 --> 00:14:27,890
stage two scenario of actually attacking

400
00:14:24,320 --> 00:14:30,080
an ICS device seeing custom malware that

401
00:14:27,890 --> 00:14:32,930
encodes the specialists knowledge of how

402
00:14:30,080 --> 00:14:35,060
to interact with a industrial control

403
00:14:32,930 --> 00:14:36,410
system into the software which is

404
00:14:35,060 --> 00:14:38,359
important because it means that you've

405
00:14:36,410 --> 00:14:40,160
now increased the number of people that

406
00:14:38,360 --> 00:14:42,950
are able to execute an attack because

407
00:14:40,160 --> 00:14:44,780
they only need to be one step removed or

408
00:14:42,950 --> 00:14:48,080
to a device that can communicate to the

409
00:14:44,780 --> 00:14:50,810
rtu DCs etc the actual control system

410
00:14:48,080 --> 00:14:52,160
and run a piece of software and have no

411
00:14:50,810 --> 00:14:54,109
knowledge or need no knowledge

412
00:14:52,160 --> 00:14:56,240
whatsoever for how that process actually

413
00:14:54,110 --> 00:14:59,060
works so you've increased the efficiency

414
00:14:56,240 --> 00:15:02,120
of being able to execute these sorts of

415
00:14:59,060 --> 00:15:04,760
attacks so we've seen tactics techniques

416
00:15:02,120 --> 00:15:06,890
and procedures shift through the kill

417
00:15:04,760 --> 00:15:08,990
chain so as we develop in your initial

418
00:15:06,890 --> 00:15:10,880
intrusion and lateral movement seeing

419
00:15:08,990 --> 00:15:12,950
you know the use of commodity tools and

420
00:15:10,880 --> 00:15:14,720
I hate the use of that word but I could

421
00:15:12,950 --> 00:15:17,180
say that and everyone sort of gets an

422
00:15:14,720 --> 00:15:19,370
idea for what I mean because it's not

423
00:15:17,180 --> 00:15:20,870
commodity or it's not unsophisticated if

424
00:15:19,370 --> 00:15:22,490
it works and in the quest and when we

425
00:15:20,870 --> 00:15:24,710
start talking about you know the various

426
00:15:22,490 --> 00:15:27,440
power shell based frameworks or cobalt

427
00:15:24,710 --> 00:15:29,000
strike veil etc that all of these items

428
00:15:27,440 --> 00:15:32,030
are quite effective in doing their

429
00:15:29,000 --> 00:15:33,200
business even if they're available to

430
00:15:32,030 --> 00:15:33,949
just about everyone it's how they're

431
00:15:33,200 --> 00:15:36,109
actually the

432
00:15:33,949 --> 00:15:38,479
and the intention behind it as you start

433
00:15:36,109 --> 00:15:40,160
proceeding toward a ICS specific

434
00:15:38,480 --> 00:15:43,309
disruption stage that makes them very

435
00:15:40,160 --> 00:15:45,559
significant so trying to sort of break

436
00:15:43,309 --> 00:15:47,329
away between your script kitty that's

437
00:15:45,559 --> 00:15:49,608
just taking the latest and greatest off

438
00:15:47,329 --> 00:15:51,169
of github to deploy an attack most

439
00:15:49,609 --> 00:15:53,239
penetration testers that are using these

440
00:15:51,169 --> 00:15:54,679
tools to a very sophisticated degree and

441
00:15:53,239 --> 00:15:56,269
then some of your state-sponsored

442
00:15:54,679 --> 00:15:57,799
attackers that are using these same

443
00:15:56,269 --> 00:15:59,689
frameworks you're seeing a lot of

444
00:15:57,799 --> 00:16:01,608
overlap and commonality and fundamental

445
00:15:59,689 --> 00:16:04,219
attack techniques but then as we get

446
00:16:01,609 --> 00:16:06,019
into that ICS disruption stage attacks

447
00:16:04,220 --> 00:16:08,449
start becoming very specific to the

448
00:16:06,019 --> 00:16:10,639
environment because for a better or for

449
00:16:08,449 --> 00:16:12,769
ill almost no to plant networks even

450
00:16:10,639 --> 00:16:14,660
within the same company are the same

451
00:16:12,769 --> 00:16:16,249
you could have plant a and plant B

452
00:16:14,660 --> 00:16:17,779
sitting directly across the street from

453
00:16:16,249 --> 00:16:19,369
one another that were built five or ten

454
00:16:17,779 --> 00:16:21,139
years apart and because of that

455
00:16:19,369 --> 00:16:22,609
difference in time slight differences in

456
00:16:21,139 --> 00:16:24,109
production you could have completely

457
00:16:22,609 --> 00:16:25,730
different looking networks even with

458
00:16:24,109 --> 00:16:28,699
some of the similar technology in play

459
00:16:25,730 --> 00:16:31,009
thus to deliver that final attack stage

460
00:16:28,699 --> 00:16:32,839
requires environments specific knowledge

461
00:16:31,009 --> 00:16:34,489
of how that environment is laid out and

462
00:16:32,839 --> 00:16:36,499
potentially the development of specific

463
00:16:34,489 --> 00:16:38,839
tools for that environment that are

464
00:16:36,499 --> 00:16:41,600
limited in capability for direct reuse

465
00:16:38,839 --> 00:16:43,730
elsewhere so what we see is that

466
00:16:41,600 --> 00:16:46,069
initially we have very repeatable

467
00:16:43,730 --> 00:16:48,110
tactics techniques procedure that rely

468
00:16:46,069 --> 00:16:50,029
upon fairly you know commodity looking

469
00:16:48,110 --> 00:16:52,129
techniques followed by highly

470
00:16:50,029 --> 00:16:54,529
specialized in unique attacks with very

471
00:16:52,129 --> 00:16:56,809
limited scope for replay outside of very

472
00:16:54,529 --> 00:16:58,040
almost identical-looking environments so

473
00:16:56,809 --> 00:17:00,829
if you're looking at this from a

474
00:16:58,040 --> 00:17:02,719
security testing perspective that just

475
00:17:00,829 --> 00:17:04,730
about everyone can get involved here at

476
00:17:02,720 --> 00:17:06,709
this stage though we start requiring

477
00:17:04,730 --> 00:17:07,789
very specialist knowledge to understand

478
00:17:06,709 --> 00:17:09,949
what's going on in these environments

479
00:17:07,789 --> 00:17:11,929
and how to interact with them so how do

480
00:17:09,949 --> 00:17:14,000
we translate this then to a purple

481
00:17:11,929 --> 00:17:15,799
teaming concept purple teaming being the

482
00:17:14,000 --> 00:17:18,380
foundation of this event and how we make

483
00:17:15,799 --> 00:17:20,359
red and blue work together so first we

484
00:17:18,380 --> 00:17:22,429
have to recognize that ICS environments

485
00:17:20,359 --> 00:17:24,319
remain brittle you know you hear the

486
00:17:22,429 --> 00:17:26,959
apocryphal story of we brought the

487
00:17:24,319 --> 00:17:28,970
network down with an nmap scan doesn't

488
00:17:26,959 --> 00:17:31,100
happen very often anymore but it's still

489
00:17:28,970 --> 00:17:33,350
a possibility and your asset owners and

490
00:17:31,100 --> 00:17:35,059
operators remember these stories so even

491
00:17:33,350 --> 00:17:37,730
if it might not be as true as it was

492
00:17:35,059 --> 00:17:38,960
three five or ten years ago the people

493
00:17:37,730 --> 00:17:42,139
you're interacting with are going to

494
00:17:38,960 --> 00:17:44,210
remember this and be very unwilling to

495
00:17:42,139 --> 00:17:46,639
allow for various levels of active

496
00:17:44,210 --> 00:17:47,870
Interop operation on their network asset

497
00:17:46,639 --> 00:17:50,300
owners are basically consider

498
00:17:47,870 --> 00:17:52,250
and they're going to allow for as little

499
00:17:50,300 --> 00:17:54,950
leeway as possible for direct testing of

500
00:17:52,250 --> 00:17:56,809
systems but also ICS attacks of

501
00:17:54,950 --> 00:17:59,360
prerequisites so we talked about this as

502
00:17:56,809 --> 00:18:01,370
being a bifurcation of attack stages so

503
00:17:59,360 --> 00:18:03,020
there's a lot of scope before you get

504
00:18:01,370 --> 00:18:05,179
into the actual interaction with control

505
00:18:03,020 --> 00:18:06,860
systems of testing what an adversary has

506
00:18:05,180 --> 00:18:09,410
to go through in order to make a control

507
00:18:06,860 --> 00:18:11,149
system attack possible from initial

508
00:18:09,410 --> 00:18:12,680
information gathering and access all the

509
00:18:11,150 --> 00:18:15,020
way to migrating into that network to

510
00:18:12,680 --> 00:18:16,760
begin with and thus we see multiple

511
00:18:15,020 --> 00:18:19,040
paths to security testing based upon

512
00:18:16,760 --> 00:18:20,600
both methodology and play and we're in

513
00:18:19,040 --> 00:18:22,460
that kill chain that you are interested

514
00:18:20,600 --> 00:18:24,620
in testing things and you can go from

515
00:18:22,460 --> 00:18:26,809
everything from notional or logical

516
00:18:24,620 --> 00:18:29,330
testing things like tabletop exercises

517
00:18:26,809 --> 00:18:31,420
documentation or reviews etc all the way

518
00:18:29,330 --> 00:18:33,980
to a fully interactive penetration test

519
00:18:31,420 --> 00:18:36,950
including a live an environment to work

520
00:18:33,980 --> 00:18:38,530
with so when we talk about testing ICS

521
00:18:36,950 --> 00:18:40,850
security there's things that need to be

522
00:18:38,530 --> 00:18:42,590
discussed and be made aware of in order

523
00:18:40,850 --> 00:18:44,689
to actually start taking this to the

524
00:18:42,590 --> 00:18:46,639
next level so first is gaining asset

525
00:18:44,690 --> 00:18:48,140
owner trust so asset owners are

526
00:18:46,640 --> 00:18:49,670
rightfully conservative they want their

527
00:18:48,140 --> 00:18:52,610
plants to run they want them to run

528
00:18:49,670 --> 00:18:55,460
properly effectively efficiently and in

529
00:18:52,610 --> 00:18:57,500
a known good state thus there is a

530
00:18:55,460 --> 00:18:59,660
requirement for clear communication this

531
00:18:57,500 --> 00:19:00,920
comes up a lot in events such as this

532
00:18:59,660 --> 00:19:02,390
they've always wanted to communicate

533
00:19:00,920 --> 00:19:04,610
well with the blue team that you don't

534
00:19:02,390 --> 00:19:06,320
want to make enemies etc in this case

535
00:19:04,610 --> 00:19:07,639
this is an eye you know you really want

536
00:19:06,320 --> 00:19:09,800
to communicate your blue team isn't

537
00:19:07,640 --> 00:19:12,530
necessarily a security team it could be

538
00:19:09,800 --> 00:19:14,178
a process engineer or similar plant

539
00:19:12,530 --> 00:19:15,649
worker in the environment whose trust

540
00:19:14,179 --> 00:19:17,809
you need to gain and we're gonna make

541
00:19:15,650 --> 00:19:20,000
sure that you have as much leeway as

542
00:19:17,809 --> 00:19:22,220
practically possible to actually perform

543
00:19:20,000 --> 00:19:23,480
meaningful tests and part of that

544
00:19:22,220 --> 00:19:25,460
gaining of trust is also having

545
00:19:23,480 --> 00:19:27,410
operationally significant knowledge such

546
00:19:25,460 --> 00:19:29,030
as what experience do you have in these

547
00:19:27,410 --> 00:19:31,040
environments do you have proper

548
00:19:29,030 --> 00:19:33,139
certifications to even be inside of them

549
00:19:31,040 --> 00:19:34,970
do you need any training to get in that

550
00:19:33,140 --> 00:19:36,140
environment do you show up in sandals

551
00:19:34,970 --> 00:19:37,760
and shorts when you're supposed to be

552
00:19:36,140 --> 00:19:39,740
wearing you know something along the

553
00:19:37,760 --> 00:19:41,600
lines of a jump suit that's flame

554
00:19:39,740 --> 00:19:42,740
retardant and a hardhat and so you wind

555
00:19:41,600 --> 00:19:44,780
up looking like an idiot when you show

556
00:19:42,740 --> 00:19:45,980
up on site so these are considerations

557
00:19:44,780 --> 00:19:48,080
to take into play if you want to be

558
00:19:45,980 --> 00:19:49,850
taken seriously but then from a purely

559
00:19:48,080 --> 00:19:52,010
technical standpoint we've talked about

560
00:19:49,850 --> 00:19:53,629
from an initial IT sort of initial

561
00:19:52,010 --> 00:19:55,250
access perspective that just about

562
00:19:53,630 --> 00:19:57,290
anyone can contribute to the initial

563
00:19:55,250 --> 00:19:59,240
phases of a control system focused

564
00:19:57,290 --> 00:20:01,520
attack but as you start proceeding down

565
00:19:59,240 --> 00:20:04,100
that kill chain you start getting into

566
00:20:01,520 --> 00:20:06,560
a distinction between IT tools and if

567
00:20:04,100 --> 00:20:08,000
they exist at all ICS tools and if I

568
00:20:06,560 --> 00:20:09,590
don't exist do you have the capability

569
00:20:08,000 --> 00:20:11,270
of developing them do you know how to

570
00:20:09,590 --> 00:20:13,610
interact with control systems or what

571
00:20:11,270 --> 00:20:16,250
protocols are in play from just a simple

572
00:20:13,610 --> 00:20:17,840
being able to read a scan of the network

573
00:20:16,250 --> 00:20:19,580
and identifying what systems are there

574
00:20:17,840 --> 00:20:21,740
versus what the network map or the

575
00:20:19,580 --> 00:20:24,139
network documentation documentation says

576
00:20:21,740 --> 00:20:26,390
is there do you need some sort of custom

577
00:20:24,140 --> 00:20:27,800
tools capabilities or knowledge in order

578
00:20:26,390 --> 00:20:30,260
to get into that environment to perform

579
00:20:27,800 --> 00:20:32,270
effectively and then finally what's your

580
00:20:30,260 --> 00:20:33,830
actual end goal in question so from a

581
00:20:32,270 --> 00:20:35,090
penetration testing perspective we've

582
00:20:33,830 --> 00:20:36,770
talked about this in previous

583
00:20:35,090 --> 00:20:39,409
discussions already we want to make Blu

584
00:20:36,770 --> 00:20:42,139
better well from an from an industrial

585
00:20:39,410 --> 00:20:43,400
control system perspective though it's

586
00:20:42,140 --> 00:20:45,560
not just making Blu better we want to

587
00:20:43,400 --> 00:20:47,180
improve security sure but we also want

588
00:20:45,560 --> 00:20:49,700
to make sure that we can try to enhance

589
00:20:47,180 --> 00:20:52,130
recovery minimize downtime all while

590
00:20:49,700 --> 00:20:54,380
ensuring plant integrity and safety so

591
00:20:52,130 --> 00:20:57,140
the goals are sort of similar but some

592
00:20:54,380 --> 00:20:58,520
of the specific items behind them shift

593
00:20:57,140 --> 00:21:00,830
a little bit beyond what we're normally

594
00:20:58,520 --> 00:21:03,260
comfortable or aware of in enterprise IT

595
00:21:00,830 --> 00:21:05,300
environments and one of the first things

596
00:21:03,260 --> 00:21:07,160
to be aware of is that you know to use

597
00:21:05,300 --> 00:21:09,530
the Wizard of Oz statement that you

598
00:21:07,160 --> 00:21:11,600
aren't in Kansas anymore or anywhere

599
00:21:09,530 --> 00:21:13,100
else for that matter is you know you

600
00:21:11,600 --> 00:21:15,260
might be used to being dropped into or

601
00:21:13,100 --> 00:21:17,209
remotely conducting a pen test from an

602
00:21:15,260 --> 00:21:18,860
office or dropped into a cubicle farm on

603
00:21:17,210 --> 00:21:20,300
site well you might need to fly out to

604
00:21:18,860 --> 00:21:21,800
one of these do you are you comfortable

605
00:21:20,300 --> 00:21:24,139
in flying in a helicopter and you have

606
00:21:21,800 --> 00:21:25,730
the proper certification too for search

607
00:21:24,140 --> 00:21:27,620
and rescue should the helicopter crash

608
00:21:25,730 --> 00:21:29,390
do you know how to wander in this

609
00:21:27,620 --> 00:21:31,010
environment and not get killed do you

610
00:21:29,390 --> 00:21:32,270
have the proper equipment in order to be

611
00:21:31,010 --> 00:21:33,560
on site in the first place without being

612
00:21:32,270 --> 00:21:36,170
kicked out of the plant and laughed at

613
00:21:33,560 --> 00:21:37,370
by all the engineers in question so not

614
00:21:36,170 --> 00:21:38,690
that sort of things that you normally

615
00:21:37,370 --> 00:21:40,850
take into consideration for a

616
00:21:38,690 --> 00:21:42,500
network-based pen test but that might

617
00:21:40,850 --> 00:21:43,699
become very relevant depending upon what

618
00:21:42,500 --> 00:21:45,470
you're being asked to do and what's most

619
00:21:43,700 --> 00:21:48,620
relevant if you have to go into a plant

620
00:21:45,470 --> 00:21:51,860
environment so from an ICS environmental

621
00:21:48,620 --> 00:21:53,179
approach there's three broad areas that

622
00:21:51,860 --> 00:21:54,889
we can approach in order to start

623
00:21:53,180 --> 00:21:56,870
testing security so there's the initial

624
00:21:54,890 --> 00:21:58,730
intrusion aspect which is very easy and

625
00:21:56,870 --> 00:22:01,250
many people can participate in so

626
00:21:58,730 --> 00:22:02,750
enterprise IT access and numerating and

627
00:22:01,250 --> 00:22:05,420
scoping of the environment but you could

628
00:22:02,750 --> 00:22:07,130
also add a control system specificity to

629
00:22:05,420 --> 00:22:09,440
this through targeting and information

630
00:22:07,130 --> 00:22:11,480
gathering you know how easy is it or how

631
00:22:09,440 --> 00:22:13,280
effective is it to identify who your

632
00:22:11,480 --> 00:22:14,990
process engineers are to fish them

633
00:22:13,280 --> 00:22:16,520
properly to identify

634
00:22:14,990 --> 00:22:17,960
what sort of systems they have in play

635
00:22:16,520 --> 00:22:20,240
that contain information about the

636
00:22:17,960 --> 00:22:22,279
control system environment to facilitate

637
00:22:20,240 --> 00:22:25,070
follow-on attacks and then moving to

638
00:22:22,279 --> 00:22:26,960
that IT ICS pivot stage how do I link

639
00:22:25,070 --> 00:22:28,879
the enterprise IT environment to the

640
00:22:26,960 --> 00:22:30,649
industrial environment what systems

641
00:22:28,880 --> 00:22:33,320
allow for inter networking between those

642
00:22:30,649 --> 00:22:35,029
two enclaves and how can I get command

643
00:22:33,320 --> 00:22:36,950
and control and other sort of traffic

644
00:22:35,029 --> 00:22:39,799
between those phases so that I can

645
00:22:36,950 --> 00:22:42,020
maintain remote access to systems of

646
00:22:39,799 --> 00:22:44,418
interest moving on to the actual ICS

647
00:22:42,020 --> 00:22:46,460
impact where you have the manual

648
00:22:44,419 --> 00:22:48,860
manipulation by being able to just get

649
00:22:46,460 --> 00:22:50,960
to an engineering workstation and turn a

650
00:22:48,860 --> 00:22:53,090
machine off to your more automated

651
00:22:50,960 --> 00:22:55,100
skills of being able to write software

652
00:22:53,090 --> 00:22:58,178
to manipulate industrial control system

653
00:22:55,100 --> 00:23:00,168
devices but the goal here is that

654
00:22:58,179 --> 00:23:01,549
chances are you'll get arrested or no

655
00:23:00,169 --> 00:23:02,929
one will invite you back if you actually

656
00:23:01,549 --> 00:23:04,520
turn something off in the environment

657
00:23:02,929 --> 00:23:06,559
that will be very bad unless you have a

658
00:23:04,520 --> 00:23:07,760
really really badly written rules of

659
00:23:06,559 --> 00:23:10,158
engagement from the plant owners

660
00:23:07,760 --> 00:23:11,809
perspective so really the idea here is

661
00:23:10,159 --> 00:23:13,460
to prove that something is possible or

662
00:23:11,809 --> 00:23:15,168
something is at risk as opposed to

663
00:23:13,460 --> 00:23:16,760
actually demonstrating that yes I can I

664
00:23:15,169 --> 00:23:18,890
can open up the breakers and turn off

665
00:23:16,760 --> 00:23:20,000
the power to 15,000 customers like no

666
00:23:18,890 --> 00:23:21,770
one wants to see that happen in

667
00:23:20,000 --> 00:23:24,440
actuality but proving that that's a

668
00:23:21,770 --> 00:23:26,929
possibility based upon the access gained

669
00:23:24,440 --> 00:23:29,299
in earlier stages the attack sequence is

670
00:23:26,929 --> 00:23:31,480
still Vil it very valuable for the asset

671
00:23:29,299 --> 00:23:33,590
operator to know to then start adding

672
00:23:31,480 --> 00:23:35,570
mitigations and defenses to prevent that

673
00:23:33,590 --> 00:23:38,090
from an actual adversary taking

674
00:23:35,570 --> 00:23:40,010
advantage of such a thing so mapping

675
00:23:38,090 --> 00:23:41,870
capabilities two phases the intrusion

676
00:23:40,010 --> 00:23:43,929
you know IT intrusion testing is

677
00:23:41,870 --> 00:23:46,100
basically a standard Enterprise IT

678
00:23:43,929 --> 00:23:48,200
penetration test you know we're all

679
00:23:46,100 --> 00:23:50,000
fairly familiar with how that works but

680
00:23:48,200 --> 00:23:51,260
for Industrial Organizations might want

681
00:23:50,000 --> 00:23:53,360
to assign special attention to

682
00:23:51,260 --> 00:23:55,669
operationally significant groups you

683
00:23:53,360 --> 00:23:58,250
know can I figure out who all of my ICS

684
00:23:55,669 --> 00:24:00,770
operators are based upon LinkedIn

685
00:23:58,250 --> 00:24:02,570
information or combing the company's

686
00:24:00,770 --> 00:24:03,889
email and phone directory from publicly

687
00:24:02,570 --> 00:24:05,629
available sources to identify

688
00:24:03,890 --> 00:24:07,549
specifically who it is that I'm trying

689
00:24:05,630 --> 00:24:09,770
to fish or who it is that I'm trying to

690
00:24:07,549 --> 00:24:12,590
target that won't allow emote allow me

691
00:24:09,770 --> 00:24:14,960
to most likely access that IT ICS

692
00:24:12,590 --> 00:24:17,149
boundary here we're still working with

693
00:24:14,960 --> 00:24:18,770
familiar IT concepts but just having to

694
00:24:17,149 --> 00:24:19,850
worry about the same sorts of things you

695
00:24:18,770 --> 00:24:21,918
might worry about with trying to get

696
00:24:19,850 --> 00:24:25,039
traffic through a proxy or trying to get

697
00:24:21,919 --> 00:24:27,320
into some specialized Enclave so still

698
00:24:25,039 --> 00:24:28,760
IT centric but some communication

699
00:24:27,320 --> 00:24:31,169
limitations and

700
00:24:28,760 --> 00:24:33,330
perhaps some value in understanding what

701
00:24:31,170 --> 00:24:35,520
services and what sort of protocols are

702
00:24:33,330 --> 00:24:37,500
most frequently allowed to flow between

703
00:24:35,520 --> 00:24:38,910
these sorts of environments so one

704
00:24:37,500 --> 00:24:41,940
example and we'll get to this a little

705
00:24:38,910 --> 00:24:43,770
bit and ransomware is SMB like why would

706
00:24:41,940 --> 00:24:45,240
the hell would you ever want SMB flowing

707
00:24:43,770 --> 00:24:47,280
into or out of a control system

708
00:24:45,240 --> 00:24:49,830
environment well if you're using that to

709
00:24:47,280 --> 00:24:51,180
transfer data from a data historian in

710
00:24:49,830 --> 00:24:52,860
your plant environment to a business

711
00:24:51,180 --> 00:24:55,020
intelligence server in your IT

712
00:24:52,860 --> 00:24:56,550
environment so you can build properly or

713
00:24:55,020 --> 00:24:58,080
have the correct license usage

714
00:24:56,550 --> 00:24:59,700
communicated you have a tunnel that's

715
00:24:58,080 --> 00:25:02,250
open between these networks that could

716
00:24:59,700 --> 00:25:06,620
allow for something like MS 17:10

717
00:25:02,250 --> 00:25:10,170
exploits to work remotely or to use the

718
00:25:06,620 --> 00:25:11,760
goodness cobol strike beacon pipe tunnel

719
00:25:10,170 --> 00:25:13,559
or whatever to flow through this network

720
00:25:11,760 --> 00:25:15,480
as well so you can chain C to that's

721
00:25:13,559 --> 00:25:17,040
important to know now as we start

722
00:25:15,480 --> 00:25:19,920
getting into ICS penetration your

723
00:25:17,040 --> 00:25:21,750
options include targeting the plethora

724
00:25:19,920 --> 00:25:23,550
of windows centric systems that are

725
00:25:21,750 --> 00:25:25,170
Lee's environment that are not only

726
00:25:23,550 --> 00:25:28,080
susceptible to all the standard windows

727
00:25:25,170 --> 00:25:30,360
tradecraft but chances are are one or

728
00:25:28,080 --> 00:25:31,980
more probably more patch tech cycles

729
00:25:30,360 --> 00:25:34,860
behind what you typically counter in

730
00:25:31,980 --> 00:25:36,900
your enterprise IT environment opening

731
00:25:34,860 --> 00:25:38,610
up many possibilities for how you can

732
00:25:36,900 --> 00:25:41,220
access and otherwise get onto these

733
00:25:38,610 --> 00:25:42,629
systems so the important point here is

734
00:25:41,220 --> 00:25:44,190
identifying what sort of tools and

735
00:25:42,630 --> 00:25:46,050
techniques are needed in advance based

736
00:25:44,190 --> 00:25:48,150
upon what you've negotiated or what's

737
00:25:46,050 --> 00:25:50,010
allowable within your roee to prove to

738
00:25:48,150 --> 00:25:51,420
the asset owner what's possible in the

739
00:25:50,010 --> 00:25:53,010
environment and what sort of controls

740
00:25:51,420 --> 00:25:55,590
they need to start incorporating and

741
00:25:53,010 --> 00:25:57,120
finally you have ICS impact something

742
00:25:55,590 --> 00:25:58,260
that we never want to actually test but

743
00:25:57,120 --> 00:26:01,050
something that we want to notionally

744
00:25:58,260 --> 00:26:02,640
examine and this can include looking at

745
00:26:01,050 --> 00:26:03,990
vulnerabilities within the environment

746
00:26:02,640 --> 00:26:06,150
to figure out well what are the actual

747
00:26:03,990 --> 00:26:08,340
remote code execution or Danao service

748
00:26:06,150 --> 00:26:10,559
vulnerabilities that may be mapped to

749
00:26:08,340 --> 00:26:12,389
control system gear that are actually

750
00:26:10,559 --> 00:26:14,520
exploitable based upon access that an

751
00:26:12,390 --> 00:26:16,650
adversary can gain mapping that out

752
00:26:14,520 --> 00:26:17,970
compared to what the network map says or

753
00:26:16,650 --> 00:26:20,340
compared to what the vulnerability

754
00:26:17,970 --> 00:26:22,559
scanner says to prove that no like this

755
00:26:20,340 --> 00:26:24,480
given vulnerability or this given attack

756
00:26:22,559 --> 00:26:25,860
mechanism is not just notional but

757
00:26:24,480 --> 00:26:27,960
realistic within your network

758
00:26:25,860 --> 00:26:30,419
environment therefore making this ICS

759
00:26:27,960 --> 00:26:31,920
impact scenario not just pause possible

760
00:26:30,420 --> 00:26:35,880
but if an intruder is able to get this

761
00:26:31,920 --> 00:26:37,530
far quite plausible and realization but

762
00:26:35,880 --> 00:26:38,370
we're talking about impact what are we

763
00:26:37,530 --> 00:26:41,040
talking about

764
00:26:38,370 --> 00:26:42,000
so most of us are familiar with the CIA

765
00:26:41,040 --> 00:26:43,920
triad

766
00:26:42,000 --> 00:26:45,570
Jiali integrity availability well that's

767
00:26:43,920 --> 00:26:46,980
still interesting you'll see lots of

768
00:26:45,570 --> 00:26:49,379
people say that availability is most

769
00:26:46,980 --> 00:26:51,330
important but really for an ICS

770
00:26:49,380 --> 00:26:53,670
perspective we're not focused on the

771
00:26:51,330 --> 00:26:55,980
classic CI a but really focused on the

772
00:26:53,670 --> 00:26:58,650
process itself the most important items

773
00:26:55,980 --> 00:27:00,780
are process integrity is the process

774
00:26:58,650 --> 00:27:02,910
running in a known good state process

775
00:27:00,780 --> 00:27:04,500
safety is everyone going to be safe and

776
00:27:02,910 --> 00:27:06,810
no one gets killed and process

777
00:27:04,500 --> 00:27:09,000
reliability known good inputs result in

778
00:27:06,810 --> 00:27:10,770
known good outputs like you would expect

779
00:27:09,000 --> 00:27:11,880
computers to operate except that seems

780
00:27:10,770 --> 00:27:14,550
to not happen all the time

781
00:27:11,880 --> 00:27:16,590
so anyway focusing on these ideas allows

782
00:27:14,550 --> 00:27:18,680
us to get an idea for what it is that's

783
00:27:16,590 --> 00:27:21,270
most important within these environments

784
00:27:18,680 --> 00:27:22,920
assessing that impact means that you

785
00:27:21,270 --> 00:27:24,720
know knowing what the physical process

786
00:27:22,920 --> 00:27:26,370
nature of ICS limits your ability to

787
00:27:24,720 --> 00:27:27,990
directly test impacts you don't want to

788
00:27:26,370 --> 00:27:29,909
necessarily turn the equipment off

789
00:27:27,990 --> 00:27:32,460
because that causes a expensive outage

790
00:27:29,910 --> 00:27:34,260
instead focus on the pathways to ICS

791
00:27:32,460 --> 00:27:35,700
access that then can be used to

792
00:27:34,260 --> 00:27:39,360
demonstrate that such impacts are

793
00:27:35,700 --> 00:27:41,730
plausible when desirable and this could

794
00:27:39,360 --> 00:27:43,770
be either conducted in a lab with spare

795
00:27:41,730 --> 00:27:46,020
equipment or through a tabletop or

796
00:27:43,770 --> 00:27:47,730
otherwise documentation review exercise

797
00:27:46,020 --> 00:27:48,960
you can play through the scenario of

798
00:27:47,730 --> 00:27:50,940
what an attack might look like and

799
00:27:48,960 --> 00:27:52,560
therefore glean information about what

800
00:27:50,940 --> 00:27:54,690
an actual attack scenario for the

801
00:27:52,560 --> 00:27:56,610
specific institution may look like and

802
00:27:54,690 --> 00:27:59,400
what impacts it might result in allowing

803
00:27:56,610 --> 00:28:01,490
you to then start developing scenarios

804
00:27:59,400 --> 00:28:04,230
around recovery response and remediation

805
00:28:01,490 --> 00:28:05,820
so purple team points of emphasis you

806
00:28:04,230 --> 00:28:07,200
know the initial intrusion basically the

807
00:28:05,820 --> 00:28:09,000
same as a normal penetration test

808
00:28:07,200 --> 00:28:10,740
lateral movement is where it gets

809
00:28:09,000 --> 00:28:12,930
important to identify how you go from

810
00:28:10,740 --> 00:28:15,240
initial access to the IT network to

811
00:28:12,930 --> 00:28:17,370
subsequent control system access that

812
00:28:15,240 --> 00:28:18,960
allows you to then demonstrate the

813
00:28:17,370 --> 00:28:21,870
realization or the possibility of

814
00:28:18,960 --> 00:28:24,510
realization a ICS breach with impact so

815
00:28:21,870 --> 00:28:26,429
getting into the ICS network identifying

816
00:28:24,510 --> 00:28:28,710
what ways you can move around and access

817
00:28:26,430 --> 00:28:30,840
other systems and then test visibility

818
00:28:28,710 --> 00:28:32,580
response and monitoring so that if

819
00:28:30,840 --> 00:28:34,230
there's is a Blue team or whoever's

820
00:28:32,580 --> 00:28:35,460
responsible if that environment knows

821
00:28:34,230 --> 00:28:37,920
what they can see what sort of

822
00:28:35,460 --> 00:28:40,530
indications of attack might emerge as a

823
00:28:37,920 --> 00:28:42,300
result of this penetration so putting

824
00:28:40,530 --> 00:28:44,310
this into practice first requires

825
00:28:42,300 --> 00:28:46,169
recognizing the limitations in ICS

826
00:28:44,310 --> 00:28:48,320
environments for direct testing but

827
00:28:46,170 --> 00:28:51,210
based upon that we still have a whole

828
00:28:48,320 --> 00:28:52,500
scope of activity we can test based upon

829
00:28:51,210 --> 00:28:55,340
a whole of kill chain approach from

830
00:28:52,500 --> 00:28:57,050
initial IT access all the way to lateral

831
00:28:55,340 --> 00:28:59,600
pivoting within the control system

832
00:28:57,050 --> 00:29:02,060
environment and from a final stage

833
00:28:59,600 --> 00:29:04,399
testing of ICS impacts we can build off

834
00:29:02,060 --> 00:29:06,710
of even those not too many of them known

835
00:29:04,400 --> 00:29:08,870
ICS attacks to develop methodologies or

836
00:29:06,710 --> 00:29:10,550
what sort of things need to be examined

837
00:29:08,870 --> 00:29:13,010
and tested for to see what sort of

838
00:29:10,550 --> 00:29:15,139
impacts might be realized so your purple

839
00:29:13,010 --> 00:29:17,000
team opera options include tabletop

840
00:29:15,140 --> 00:29:18,620
exercises that doesn't normally sound

841
00:29:17,000 --> 00:29:20,300
like a purple team exercise but in the

842
00:29:18,620 --> 00:29:21,469
case of a control system environment

843
00:29:20,300 --> 00:29:24,560
it's something to really take into

844
00:29:21,470 --> 00:29:26,690
consideration a TTX really walks through

845
00:29:24,560 --> 00:29:28,669
what a attack sequence might look like

846
00:29:26,690 --> 00:29:30,590
through injections and based upon

847
00:29:28,670 --> 00:29:32,360
realistic attack scenarios to walk

848
00:29:30,590 --> 00:29:34,610
through what the existing plan is with

849
00:29:32,360 --> 00:29:36,500
the environment in question and how

850
00:29:34,610 --> 00:29:38,870
they'd respond to notional attack

851
00:29:36,500 --> 00:29:40,430
scenarios it's the least invasive it's

852
00:29:38,870 --> 00:29:41,840
also likely to have the least value

853
00:29:40,430 --> 00:29:43,970
because you don't really test how things

854
00:29:41,840 --> 00:29:45,620
are in actuality but you can still at

855
00:29:43,970 --> 00:29:48,110
least build awareness and knowledge of

856
00:29:45,620 --> 00:29:49,580
what's going on out in the world so that

857
00:29:48,110 --> 00:29:51,260
asset owners and operators can

858
00:29:49,580 --> 00:29:54,379
incorporate that into planning and

859
00:29:51,260 --> 00:29:57,830
subsequent controls and mitigations for

860
00:29:54,380 --> 00:29:59,750
attacks more interactive is assessing

861
00:29:57,830 --> 00:30:02,149
the attack surface so this is really you

862
00:29:59,750 --> 00:30:04,070
know that all of stage 1 in most of

863
00:30:02,150 --> 00:30:06,890
stage 2 up until you get to the actual

864
00:30:04,070 --> 00:30:08,600
direct ICS attack so figuring out what

865
00:30:06,890 --> 00:30:10,010
am I actually exposing from a control

866
00:30:08,600 --> 00:30:12,439
system network perspective that would

867
00:30:10,010 --> 00:30:14,750
enable an attacker to pre position to

868
00:30:12,440 --> 00:30:16,880
deliver a disruptive effect in this case

869
00:30:14,750 --> 00:30:17,930
we are starting to manipulate actual

870
00:30:16,880 --> 00:30:20,720
systems in the control environment

871
00:30:17,930 --> 00:30:22,190
typically your Windows devices like data

872
00:30:20,720 --> 00:30:25,220
historians human machine interface

873
00:30:22,190 --> 00:30:26,900
devices engineering workstations etc so

874
00:30:25,220 --> 00:30:28,820
there is a risk that if you do something

875
00:30:26,900 --> 00:30:31,280
stupid or something unintentional that

876
00:30:28,820 --> 00:30:33,770
results in a unfortunate impact that you

877
00:30:31,280 --> 00:30:35,389
can harm the plant in some way but

878
00:30:33,770 --> 00:30:37,910
nowhere near the same as if you bounced

879
00:30:35,390 --> 00:30:39,260
a device in the DCs or something else

880
00:30:37,910 --> 00:30:42,050
that's actually controlling things that

881
00:30:39,260 --> 00:30:44,930
spin or produce steam or other sorts of

882
00:30:42,050 --> 00:30:46,220
items so minimally invasive relative to

883
00:30:44,930 --> 00:30:47,420
some other things but you can start

884
00:30:46,220 --> 00:30:49,040
getting some really valuable knowledge

885
00:30:47,420 --> 00:30:50,210
for what's actually out there and

886
00:30:49,040 --> 00:30:51,860
finally you could have an actual

887
00:30:50,210 --> 00:30:54,380
interactive pen test which is risky in

888
00:30:51,860 --> 00:30:56,389
the sense of unforeseen consequences but

889
00:30:54,380 --> 00:30:59,060
can be very valuable engaging just what

890
00:30:56,390 --> 00:31:00,890
a defense needs to be aware of this

891
00:30:59,060 --> 00:31:02,540
could be done in very specialized

892
00:31:00,890 --> 00:31:04,250
environments by taking equipment in a

893
00:31:02,540 --> 00:31:06,800
lab or working with vendors in order to

894
00:31:04,250 --> 00:31:08,310
test equipment offline to see like if a

895
00:31:06,800 --> 00:31:10,080
notional hacker

896
00:31:08,310 --> 00:31:12,179
were in the control system environment

897
00:31:10,080 --> 00:31:14,639
what sort of capabilities can they

898
00:31:12,180 --> 00:31:18,000
leverage to hack a locomotive or to hack

899
00:31:14,640 --> 00:31:19,620
a aircraft or to hack a gas turbine for

900
00:31:18,000 --> 00:31:21,090
example so you're not going to see this

901
00:31:19,620 --> 00:31:22,949
in production too often but the

902
00:31:21,090 --> 00:31:24,209
possibilities exist when working with

903
00:31:22,950 --> 00:31:26,460
the right people and if you have

904
00:31:24,210 --> 00:31:28,230
sufficient resources so looking at

905
00:31:26,460 --> 00:31:31,020
attacker focused scenarios we have

906
00:31:28,230 --> 00:31:32,280
really three brushstrokes of things to

907
00:31:31,020 --> 00:31:34,770
look for there's opportunistic

908
00:31:32,280 --> 00:31:37,530
infections that spread from IT to ot

909
00:31:34,770 --> 00:31:39,270
there are disruptive directly disruptive

910
00:31:37,530 --> 00:31:42,180
ICS events so turning off the power

911
00:31:39,270 --> 00:31:44,700
flipping a switch etc and then most

912
00:31:42,180 --> 00:31:46,370
sophisticated of all ICS integrity

913
00:31:44,700 --> 00:31:48,570
attacks actually undermining the

914
00:31:46,370 --> 00:31:50,489
reliability integrity and the safety of

915
00:31:48,570 --> 00:31:52,020
the processing question so for an

916
00:31:50,490 --> 00:31:53,790
opportunistic perspective we've seen

917
00:31:52,020 --> 00:31:55,560
this in the case of war mobile

918
00:31:53,790 --> 00:31:59,159
ransomware and in the case of blocker

919
00:31:55,560 --> 00:32:01,980
Goga maybe not so horrible but where you

920
00:31:59,160 --> 00:32:03,600
have links between the IT and ICS

921
00:32:01,980 --> 00:32:06,990
network like the SMB link I talked about

922
00:32:03,600 --> 00:32:08,370
earlier or allowing HTTP or other sorts

923
00:32:06,990 --> 00:32:10,350
of protocols to flow out of the control

924
00:32:08,370 --> 00:32:14,340
system Network but also to flow into it

925
00:32:10,350 --> 00:32:16,409
that even a not targeted attack like

926
00:32:14,340 --> 00:32:19,260
wanna cry can then sort of swim upstream

927
00:32:16,410 --> 00:32:21,240
to cross from IT into the ICS network

928
00:32:19,260 --> 00:32:23,010
and laterally move by propagating

929
00:32:21,240 --> 00:32:24,780
automatically to deliver a control

930
00:32:23,010 --> 00:32:26,160
system impact you know we talked about

931
00:32:24,780 --> 00:32:27,960
Maersk but there were a number of

932
00:32:26,160 --> 00:32:29,790
automotive plants pharmaceutical plants

933
00:32:27,960 --> 00:32:33,390
that all are continuing to be impacted

934
00:32:29,790 --> 00:32:34,649
by MS 1710 based ransomware so at that

935
00:32:33,390 --> 00:32:36,030
stage because we're talking about

936
00:32:34,650 --> 00:32:37,380
something that spreads quite quickly and

937
00:32:36,030 --> 00:32:39,629
automatically it's not just a question

938
00:32:37,380 --> 00:32:41,160
of knowing how do I block this how do I

939
00:32:39,630 --> 00:32:43,320
stop this by reducing that attack

940
00:32:41,160 --> 00:32:45,030
surface but also as we've seen in the

941
00:32:43,320 --> 00:32:46,950
case with norsk hydro quite admirably

942
00:32:45,030 --> 00:32:49,110
although quite expensively how do I

943
00:32:46,950 --> 00:32:50,850
respond and recover from these attacks

944
00:32:49,110 --> 00:32:52,740
should they take place and do I have

945
00:32:50,850 --> 00:32:54,990
that infrastructure knowledge and

946
00:32:52,740 --> 00:32:57,480
available and ability in-house in order

947
00:32:54,990 --> 00:32:59,730
to do that we start talking about direct

948
00:32:57,480 --> 00:33:02,310
disruptions you know we can look at the

949
00:32:59,730 --> 00:33:04,380
2015 and 2016 Ukraine events where an

950
00:33:02,310 --> 00:33:06,060
attacker got in and then planned on

951
00:33:04,380 --> 00:33:08,430
directly disrupting the process in order

952
00:33:06,060 --> 00:33:09,810
to turn the lights off or several

953
00:33:08,430 --> 00:33:11,880
thousands of people for a period of time

954
00:33:09,810 --> 00:33:14,280
so this is it might not seem that

955
00:33:11,880 --> 00:33:16,320
sophistic very sophisticated but really

956
00:33:14,280 --> 00:33:17,879
is a very direct sort of attack and this

957
00:33:16,320 --> 00:33:20,070
is something I'm hoping to do more

958
00:33:17,880 --> 00:33:21,690
research on in the future so stay tuned

959
00:33:20,070 --> 00:33:23,730
but in the course of something like

960
00:33:21,690 --> 00:33:25,350
crash override and destroyer you have a

961
00:33:23,730 --> 00:33:27,389
multi-stage attack that results in a

962
00:33:25,350 --> 00:33:29,399
very discrete end state so you have a

963
00:33:27,389 --> 00:33:31,490
you know launcher program that starts

964
00:33:29,399 --> 00:33:33,508
out that reads in ICS specific

965
00:33:31,490 --> 00:33:35,759
configurations to manipulate the process

966
00:33:33,509 --> 00:33:37,529
to open breakers that results in a

967
00:33:35,759 --> 00:33:39,419
disruption to the flow of power there

968
00:33:37,529 --> 00:33:41,399
was also a really nasty post attack bit

969
00:33:39,419 --> 00:33:42,950
where there were some backup backdoors

970
00:33:41,399 --> 00:33:45,239
that were left in as well as a

971
00:33:42,950 --> 00:33:47,279
distributed denial-of-service that if it

972
00:33:45,240 --> 00:33:49,409
had worked properly except the attackers

973
00:33:47,279 --> 00:33:52,470
screwed up the coding not once but twice

974
00:33:49,409 --> 00:33:54,240
which is hilarious please don't tell him

975
00:33:52,470 --> 00:33:56,669
that this is recorded I guess it doesn't

976
00:33:54,240 --> 00:33:58,500
matter anyway but screwed up their

977
00:33:56,669 --> 00:34:00,360
attack package twice and but using both

978
00:33:58,500 --> 00:34:02,039
a wrong version of the exploit and not

979
00:34:00,360 --> 00:34:04,439
properly coding how they created network

980
00:34:02,039 --> 00:34:06,029
sockets so the you can laugh about it

981
00:34:04,440 --> 00:34:08,668
but if that attack had succeeded they

982
00:34:06,029 --> 00:34:10,349
could have manipulated the protective

983
00:34:08,668 --> 00:34:11,848
relays that when they were trying to

984
00:34:10,349 --> 00:34:14,760
close the breakers to restore power

985
00:34:11,849 --> 00:34:15,960
would have allowed for a dangerous

986
00:34:14,760 --> 00:34:17,429
environment to take place where you

987
00:34:15,960 --> 00:34:20,099
could have actually had physical process

988
00:34:17,429 --> 00:34:21,300
just destruction and potentially harming

989
00:34:20,099 --> 00:34:23,069
individuals in question that we're

990
00:34:21,300 --> 00:34:24,060
trying to restore operations so not a

991
00:34:23,069 --> 00:34:26,429
laughing matter if it had actually

992
00:34:24,060 --> 00:34:28,290
worked out but in this question case

993
00:34:26,429 --> 00:34:30,060
what we're seeing from a direct

994
00:34:28,290 --> 00:34:32,279
disruption event is that first you want

995
00:34:30,060 --> 00:34:35,099
to figure out well can I control things

996
00:34:32,280 --> 00:34:36,510
that are in the ICS environment if I get

997
00:34:35,099 --> 00:34:38,520
an implant in there can I continue to

998
00:34:36,510 --> 00:34:40,379
talk to it and tell it what to do what

999
00:34:38,520 --> 00:34:41,819
sort of interactive movement what sort

1000
00:34:40,379 --> 00:34:43,739
of lateral movement capabilities do I

1001
00:34:41,819 --> 00:34:45,270
have that allowed me to then get into a

1002
00:34:43,739 --> 00:34:47,459
position in the case of the crash

1003
00:34:45,270 --> 00:34:49,349
override event sitting on data

1004
00:34:47,460 --> 00:34:51,270
historians in the environment that allow

1005
00:34:49,349 --> 00:34:53,819
the attacker then to communicate to

1006
00:34:51,270 --> 00:34:55,829
multiple control system pieces of

1007
00:34:53,819 --> 00:34:58,170
equipment nearly simultaneously to

1008
00:34:55,829 --> 00:35:00,270
produce the intended effect so for this

1009
00:34:58,170 --> 00:35:01,980
sort of example you can do an

1010
00:35:00,270 --> 00:35:03,390
interactive test for many of these items

1011
00:35:01,980 --> 00:35:05,670
to see where you can get and then for

1012
00:35:03,390 --> 00:35:07,560
that final stage of like okay we get

1013
00:35:05,670 --> 00:35:09,180
into the impact scenario now we're

1014
00:35:07,560 --> 00:35:11,400
talking about notional testing to see

1015
00:35:09,180 --> 00:35:13,020
okay if the scenario presents itself

1016
00:35:11,400 --> 00:35:14,579
what do you do how do you detect it how

1017
00:35:13,020 --> 00:35:15,869
do you restore operations and this is

1018
00:35:14,579 --> 00:35:17,819
actually something that I've done

1019
00:35:15,869 --> 00:35:19,470
several tabletop exercises with some of

1020
00:35:17,819 --> 00:35:21,660
my colleagues at Drago's and it's been

1021
00:35:19,470 --> 00:35:24,720
very informative for utility customers

1022
00:35:21,660 --> 00:35:27,328
so finally we have ICS integrity attacks

1023
00:35:24,720 --> 00:35:28,980
this is your real gamechanger stucks

1024
00:35:27,329 --> 00:35:30,150
that actually falls into this but again

1025
00:35:28,980 --> 00:35:32,099
like I talked about it when I keep

1026
00:35:30,150 --> 00:35:34,170
mentioning it so anyway but most

1027
00:35:32,099 --> 00:35:35,220
recently what falls into this bin is the

1028
00:35:34,170 --> 00:35:37,290
trisys Triton of

1029
00:35:35,220 --> 00:35:39,290
so this was an attack on a safety system

1030
00:35:37,290 --> 00:35:41,880
at a petrochemical plant in Saudi Arabia

1031
00:35:39,290 --> 00:35:43,320
so Trice is played out again you'll see

1032
00:35:41,880 --> 00:35:45,240
some similarities with crash override

1033
00:35:43,320 --> 00:35:47,940
you had an initial IT network intrusion

1034
00:35:45,240 --> 00:35:49,680
using lots of off-the-shelf tools like a

1035
00:35:47,940 --> 00:35:52,680
version of mini cats but also

1036
00:35:49,680 --> 00:35:55,169
straight-up me me cats WMI implant some

1037
00:35:52,680 --> 00:35:56,490
other items that were then used to pivot

1038
00:35:55,170 --> 00:35:58,970
through the network to gather sufficient

1039
00:35:56,490 --> 00:36:01,618
credentials and access to pivot into the

1040
00:35:58,970 --> 00:36:03,270
control system Network continue pivoting

1041
00:36:01,619 --> 00:36:05,490
through credential capture to get on to

1042
00:36:03,270 --> 00:36:07,080
a safety workstation from which the

1043
00:36:05,490 --> 00:36:08,669
adversary deployed a piece of software

1044
00:36:07,080 --> 00:36:10,619
that wasn't meant to directly disrupt

1045
00:36:08,670 --> 00:36:12,599
the process but rather to insert an

1046
00:36:10,619 --> 00:36:14,820
in-memory rootkit on the device to allow

1047
00:36:12,599 --> 00:36:16,980
manipulation of a safety instrumented

1048
00:36:14,820 --> 00:36:18,900
system that governs you know whether or

1049
00:36:16,980 --> 00:36:21,180
not a process safely shuts down in the

1050
00:36:18,900 --> 00:36:22,950
case of a unsafe condition in the plant

1051
00:36:21,180 --> 00:36:25,109
now we don't know exactly what the

1052
00:36:22,950 --> 00:36:26,790
attacker intended to do with this but it

1053
00:36:25,109 --> 00:36:29,869
undermines the integrity and the ability

1054
00:36:26,790 --> 00:36:31,770
of that safety system to preserve

1055
00:36:29,869 --> 00:36:33,570
environmental safety which means you

1056
00:36:31,770 --> 00:36:35,460
have the possibility of a attacker

1057
00:36:33,570 --> 00:36:37,170
undermining the conditions in that plant

1058
00:36:35,460 --> 00:36:40,050
that preserve human life which is pretty

1059
00:36:37,170 --> 00:36:41,430
scary so for an integrity attack we

1060
00:36:40,050 --> 00:36:42,990
already talked about all these initial

1061
00:36:41,430 --> 00:36:45,359
stages that overlap of what we've talked

1062
00:36:42,990 --> 00:36:47,250
about for that sort of stage one early

1063
00:36:45,359 --> 00:36:49,380
stage two penetration testing that looks

1064
00:36:47,250 --> 00:36:50,820
very similar to IT environments but then

1065
00:36:49,380 --> 00:36:53,220
when we start talking about what do I do

1066
00:36:50,820 --> 00:36:54,900
if an attacker starting to do this well

1067
00:36:53,220 --> 00:36:56,220
you start coming across the same sort of

1068
00:36:54,900 --> 00:36:58,920
tabletop exercises but also

1069
00:36:56,220 --> 00:37:01,348
documentation reviews and exercises into

1070
00:36:58,920 --> 00:37:02,339
not just how do you recover but how do

1071
00:37:01,349 --> 00:37:04,530
you even show that you've recovered

1072
00:37:02,339 --> 00:37:06,420
properly so these are hard questions for

1073
00:37:04,530 --> 00:37:08,369
people to answer and might seem outside

1074
00:37:06,420 --> 00:37:09,750
the scope of a normal penetration test

1075
00:37:08,369 --> 00:37:12,030
but if we're talking about legitimate

1076
00:37:09,750 --> 00:37:13,140
purple teaming is very important so if

1077
00:37:12,030 --> 00:37:14,940
we're talking about industrial

1078
00:37:13,140 --> 00:37:16,950
environments where the critical aspects

1079
00:37:14,940 --> 00:37:18,630
for a plant owner is do I know if my

1080
00:37:16,950 --> 00:37:20,640
process is reliable do I know if it's

1081
00:37:18,630 --> 00:37:22,380
safe and do I know that the integrity is

1082
00:37:20,640 --> 00:37:24,750
maintained how do I prove those things

1083
00:37:22,380 --> 00:37:26,369
if an attack has taken place how can I

1084
00:37:24,750 --> 00:37:29,460
show you know not just in this really

1085
00:37:26,369 --> 00:37:31,589
scary example of a plant being you know

1086
00:37:29,460 --> 00:37:33,000
designed to blow up or whatever but how

1087
00:37:31,589 --> 00:37:35,070
do I prove that I haven't altered the

1088
00:37:33,000 --> 00:37:36,089
manufacturing tolerance for a group of

1089
00:37:35,070 --> 00:37:37,859
industrial robots

1090
00:37:36,089 --> 00:37:40,170
that increases the defect rate for your

1091
00:37:37,859 --> 00:37:41,430
manufacturing so what sort of processes

1092
00:37:40,170 --> 00:37:44,280
procedures and technical capabilities

1093
00:37:41,430 --> 00:37:47,069
are in play to detect respond and then

1094
00:37:44,280 --> 00:37:48,300
recover from that scenario again very

1095
00:37:47,070 --> 00:37:49,110
different from what we thought think

1096
00:37:48,300 --> 00:37:50,850
about from a

1097
00:37:49,110 --> 00:37:53,070
penetration testing red teaming

1098
00:37:50,850 --> 00:37:54,720
environment NIT networks but vitally

1099
00:37:53,070 --> 00:37:57,210
important given what are possible

1100
00:37:54,720 --> 00:38:00,000
outcomes and very significant outcomes

1101
00:37:57,210 --> 00:38:01,620
from an industrial perspective so

1102
00:38:00,000 --> 00:38:02,970
takeaways and conclusions and I'm gonna

1103
00:38:01,620 --> 00:38:07,319
have time for questions I time this

1104
00:38:02,970 --> 00:38:08,759
awesomely first off you know there's a

1105
00:38:07,320 --> 00:38:10,260
lot of gatekeeping when it comes to

1106
00:38:08,760 --> 00:38:11,610
industrial control things that all if

1107
00:38:10,260 --> 00:38:13,020
you're not an engineer or whatever you

1108
00:38:11,610 --> 00:38:15,150
have no business in this environment

1109
00:38:13,020 --> 00:38:16,740
well we've demonstrated that a lot of

1110
00:38:15,150 --> 00:38:19,260
the attackers are operating on very

1111
00:38:16,740 --> 00:38:22,259
fundamental IT intrusion principles for

1112
00:38:19,260 --> 00:38:24,060
the majority of the attack process thus

1113
00:38:22,260 --> 00:38:25,890
well there's a lot of scope for people

1114
00:38:24,060 --> 00:38:27,720
who know a lot about how to break into

1115
00:38:25,890 --> 00:38:29,609
networks to test a lot of the

1116
00:38:27,720 --> 00:38:31,680
prerequisites towards delivering an ICS

1117
00:38:29,610 --> 00:38:33,120
attack but in order to really do this in

1118
00:38:31,680 --> 00:38:35,129
a meaningful way you need scope and

1119
00:38:33,120 --> 00:38:36,660
purpose so what's actually being tested

1120
00:38:35,130 --> 00:38:38,730
and how will those actions that you're

1121
00:38:36,660 --> 00:38:41,220
taking be use to improve the security

1122
00:38:38,730 --> 00:38:42,480
and the reliability of the industrial

1123
00:38:41,220 --> 00:38:44,759
processing question that you're testing

1124
00:38:42,480 --> 00:38:46,110
and finally you know you know this might

1125
00:38:44,760 --> 00:38:47,910
be seen as like oh you're just talking

1126
00:38:46,110 --> 00:38:49,650
crown jewels analysis but what are the

1127
00:38:47,910 --> 00:38:51,180
core interests and values that are in

1128
00:38:49,650 --> 00:38:52,980
question for the industrial environment

1129
00:38:51,180 --> 00:38:54,870
it's not just that this specific pieces

1130
00:38:52,980 --> 00:38:56,580
of equipment are important it's these

1131
00:38:54,870 --> 00:38:58,440
are the fundamental concepts that I need

1132
00:38:56,580 --> 00:39:00,630
to be aware of and be securing to have

1133
00:38:58,440 --> 00:39:03,090
do a good job so again reliability

1134
00:39:00,630 --> 00:39:04,800
safety integrity for the fundament for

1135
00:39:03,090 --> 00:39:06,780
the underlying industrial process not

1136
00:39:04,800 --> 00:39:08,760
just an individual machine to make sure

1137
00:39:06,780 --> 00:39:12,270
that the plant in question can continue

1138
00:39:08,760 --> 00:39:13,560
to operate and knowing that adopting

1139
00:39:12,270 --> 00:39:15,750
that and communicating that with your

1140
00:39:13,560 --> 00:39:17,460
asset owners will in addition to showing

1141
00:39:15,750 --> 00:39:19,770
up in the right sort of close by you a

1142
00:39:17,460 --> 00:39:21,780
lot of goodwill and acceptance that you

1143
00:39:19,770 --> 00:39:23,460
can start actually testing what's going

1144
00:39:21,780 --> 00:39:25,650
on this environment to realistically

1145
00:39:23,460 --> 00:39:27,060
improve security so when these slides

1146
00:39:25,650 --> 00:39:28,320
are posted and I need to get them to the

1147
00:39:27,060 --> 00:39:30,150
conference organizers but they'll be

1148
00:39:28,320 --> 00:39:31,560
posted somewhere I'm sure some

1149
00:39:30,150 --> 00:39:33,930
additional resources in case you want to

1150
00:39:31,560 --> 00:39:35,310
read up on some things but otherwise I

1151
00:39:33,930 --> 00:39:37,069
do have some time for questions before

1152
00:39:35,310 --> 00:39:39,130
we get into lunch

1153
00:39:37,070 --> 00:39:39,130
you

