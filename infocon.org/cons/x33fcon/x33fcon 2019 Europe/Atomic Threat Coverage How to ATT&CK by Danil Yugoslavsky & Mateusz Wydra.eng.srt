1
00:00:08,058 --> 00:00:13,620
all right so hello everybody

2
00:00:11,700 --> 00:00:15,570
I hope you enjoying your time in this

3
00:00:13,620 --> 00:00:17,810
beautiful city thank you for

4
00:00:15,570 --> 00:00:20,160
organization fermentation and everything

5
00:00:17,810 --> 00:00:22,140
today we are going to present you our

6
00:00:20,160 --> 00:00:25,550
project atomic threat coverage which

7
00:00:22,140 --> 00:00:28,349
represents technical implementation and

8
00:00:25,550 --> 00:00:31,170
operationalization of threat centric

9
00:00:28,349 --> 00:00:34,230
methodology and my tri-attack framework

10
00:00:31,170 --> 00:00:38,070
specifically at the same time we will

11
00:00:34,230 --> 00:00:39,629
present you the reasons which stands

12
00:00:38,070 --> 00:00:43,559
behind decision to develop this project

13
00:00:39,629 --> 00:00:45,780
and expected and a few unexpected

14
00:00:43,559 --> 00:00:48,890
benefits which we had when we starting

15
00:00:45,780 --> 00:00:52,140
processing all information automatically

16
00:00:48,890 --> 00:00:54,059
also everything I'm gonna present we

17
00:00:52,140 --> 00:00:56,430
gonna present to you today is free in

18
00:00:54,059 --> 00:00:58,289
open source available on github and

19
00:00:56,430 --> 00:01:02,120
ready to be implemented in your

20
00:00:58,289 --> 00:01:05,309
environment alright my name is Daniel I

21
00:01:02,120 --> 00:01:08,280
work another threat detection team late

22
00:01:05,309 --> 00:01:10,770
in theatre Salkin Czech Republic today

23
00:01:08,280 --> 00:01:14,280
we will perform together is NIOSH with

24
00:01:10,770 --> 00:01:17,460
her he is so constant responder in

25
00:01:14,280 --> 00:01:20,640
theater sock in Krakow in Poland also

26
00:01:17,460 --> 00:01:23,158
have two members who unfortunately

27
00:01:20,640 --> 00:01:26,369
couldn't participate today

28
00:01:23,159 --> 00:01:30,509
Mikhail action of his sock automation

29
00:01:26,369 --> 00:01:31,259
team late in Moscow in Busan and Yakov

30
00:01:30,509 --> 00:01:33,689
Wayans Ethel

31
00:01:31,259 --> 00:01:35,490
he is threat detection specialist in

32
00:01:33,689 --> 00:01:38,189
theater sock and Krakow in Poland as

33
00:01:35,490 --> 00:01:40,350
well at the same time we all crack of 26

34
00:01:38,189 --> 00:01:44,429
crimes meetings members these are our

35
00:01:40,350 --> 00:01:46,710
home meetups like local meetups I would

36
00:01:44,430 --> 00:01:49,200
say we used to present first proof of

37
00:01:46,710 --> 00:01:51,689
concepts or interesting ideas updates

38
00:01:49,200 --> 00:01:54,630
there first so if you guys feel being

39
00:01:51,689 --> 00:01:56,908
Krakow come over say hi this meetings

40
00:01:54,630 --> 00:01:58,640
takes place each first Friday of the

41
00:01:56,909 --> 00:02:00,479
month

42
00:01:58,640 --> 00:02:04,740
alright let me provide you some

43
00:02:00,479 --> 00:02:07,590
historical background in 2014 when I

44
00:02:04,740 --> 00:02:10,378
started when I moved from networking

45
00:02:07,590 --> 00:02:11,910
security to general computer security

46
00:02:10,378 --> 00:02:13,518
and started working with offensive

47
00:02:11,910 --> 00:02:16,969
defensive stuff

48
00:02:13,519 --> 00:02:19,549
I had only one question and also started

49
00:02:16,969 --> 00:02:23,420
working with CM systems specifically I

50
00:02:19,549 --> 00:02:27,079
had only one question where all of these

51
00:02:23,420 --> 00:02:29,149
people get correlation rules and I

52
00:02:27,079 --> 00:02:32,540
couldn't find the answer the thing is at

53
00:02:29,150 --> 00:02:35,150
that time basically if you're looking

54
00:02:32,540 --> 00:02:37,638
for like correlation rules detection

55
00:02:35,150 --> 00:02:40,129
rules methodology anything you can only

56
00:02:37,639 --> 00:02:42,469
find like information about brute force

57
00:02:40,129 --> 00:02:44,629
and everybody was like you know by our

58
00:02:42,469 --> 00:02:46,280
sim system for a couple of millions

59
00:02:44,629 --> 00:02:50,500
dollars and you will be able to detect

60
00:02:46,280 --> 00:02:53,450
brute force alright maybe something else

61
00:02:50,500 --> 00:02:56,329
basically I'll started also doing some

62
00:02:53,450 --> 00:02:58,429
hacking stuff offensive and I was able

63
00:02:56,329 --> 00:03:00,109
to intrude into system move laterally

64
00:02:58,430 --> 00:03:02,659
dump credentials and everything but I

65
00:03:00,109 --> 00:03:07,159
couldn't find any information about

66
00:03:02,659 --> 00:03:11,269
detection like literally you know empty

67
00:03:07,159 --> 00:03:15,069
field silence no articles no methodology

68
00:03:11,269 --> 00:03:17,840
nothing and for me it was clear that to

69
00:03:15,069 --> 00:03:19,310
detect something or to define the system

70
00:03:17,840 --> 00:03:22,099
from something you need to understand

71
00:03:19,310 --> 00:03:24,560
this something right like how the

72
00:03:22,099 --> 00:03:26,510
adversary's operates how it looks like

73
00:03:24,560 --> 00:03:28,939
what kind of tools they use and what is

74
00:03:26,510 --> 00:03:31,548
their motivation and I couldn't answer

75
00:03:28,939 --> 00:03:33,379
like find the answer for these questions

76
00:03:31,549 --> 00:03:37,280
like why nobody is doing that why it's

77
00:03:33,379 --> 00:03:39,888
so obvious but not so popular and I was

78
00:03:37,280 --> 00:03:41,419
digging into the topic like looking for

79
00:03:39,889 --> 00:03:43,430
something which would reflect my own

80
00:03:41,419 --> 00:03:45,819
understanding of this area and I found

81
00:03:43,430 --> 00:03:48,680
one it's called

82
00:03:45,819 --> 00:03:52,448
intelligent driven defense developed by

83
00:03:48,680 --> 00:03:57,169
Lockheed Martin corporation in 2012 and

84
00:03:52,449 --> 00:04:00,859
the main idea behind it is you supposed

85
00:03:57,169 --> 00:04:03,169
to know your enemy it is basic for

86
00:04:00,859 --> 00:04:05,989
military but not so popular at least it

87
00:04:03,169 --> 00:04:10,040
wasn't that popular that time basically

88
00:04:05,989 --> 00:04:12,439
just five years ago so I grabbed it

89
00:04:10,040 --> 00:04:17,978
started digging into what interesting is

90
00:04:12,439 --> 00:04:22,550
there what can I use and you know after

91
00:04:17,978 --> 00:04:25,700
just one year in 2015 my tree released

92
00:04:22,550 --> 00:04:27,400
their framework called my tri attack how

93
00:04:25,700 --> 00:04:29,320
many of you guys use my tree

94
00:04:27,400 --> 00:04:34,179
Dok framework in your daily job can you

95
00:04:29,320 --> 00:04:38,770
please raise your hand right that's just

96
00:04:34,180 --> 00:04:40,690
awesome thank you so I don't for those

97
00:04:38,770 --> 00:04:43,060
who are not using or not familiar I will

98
00:04:40,690 --> 00:04:46,630
provide a simple description it's just

99
00:04:43,060 --> 00:04:50,310
basically adversary model description of

100
00:04:46,630 --> 00:04:53,409
steps techniques procedures and Tuesday

101
00:04:50,310 --> 00:04:55,660
advisories used during the intrusion and

102
00:04:53,410 --> 00:04:58,800
post exploitation activities in other

103
00:04:55,660 --> 00:05:01,720
environment probably most of you

104
00:04:58,800 --> 00:05:03,940
familiar with concept of cyber kill

105
00:05:01,720 --> 00:05:07,360
chain also known as cyber attack

106
00:05:03,940 --> 00:05:09,039
lifecycle in mitre paradigm basically

107
00:05:07,360 --> 00:05:13,060
what they did they just split it into

108
00:05:09,039 --> 00:05:15,460
two pieces pre attack and Enterprise

109
00:05:13,060 --> 00:05:17,260
attack which is about delivery

110
00:05:15,460 --> 00:05:21,000
exploitation and all post exploitation

111
00:05:17,260 --> 00:05:24,729
activities which ad versus D and

112
00:05:21,000 --> 00:05:27,190
basically that's how it looks like it is

113
00:05:24,729 --> 00:05:31,599
a table there are twelve columns which

114
00:05:27,190 --> 00:05:34,060
represents tactics tactic is tactical

115
00:05:31,599 --> 00:05:36,610
objective of an adversary during the

116
00:05:34,060 --> 00:05:39,060
intrusion and there are more than two

117
00:05:36,610 --> 00:05:42,160
hunger cells which represents techniques

118
00:05:39,060 --> 00:05:45,550
which are like exact way how to achieve

119
00:05:42,160 --> 00:05:48,490
this tactical objective for example

120
00:05:45,550 --> 00:05:51,520
exfiltration over alternative protocol

121
00:05:48,490 --> 00:05:54,400
it is a technique at the same time it is

122
00:05:51,520 --> 00:05:57,820
a way how to achieve tactical goal which

123
00:05:54,400 --> 00:05:59,549
is exfiltration there is a simple

124
00:05:57,820 --> 00:06:02,320
description of what is it about

125
00:05:59,550 --> 00:06:05,650
mitigation detection strategies example

126
00:06:02,320 --> 00:06:08,800
of use in the wild and some references

127
00:06:05,650 --> 00:06:13,239
so basically each technique has such

128
00:06:08,800 --> 00:06:16,120
description so and with all of this

129
00:06:13,240 --> 00:06:20,139
stuff like all the mindset we are first

130
00:06:16,120 --> 00:06:22,530
decided to start implementing it and we

131
00:06:20,139 --> 00:06:26,010
faced a few problems during the

132
00:06:22,530 --> 00:06:29,169
operationalization first of all

133
00:06:26,010 --> 00:06:32,320
description for my tree itself is the

134
00:06:29,169 --> 00:06:34,080
high level it's not actionable which

135
00:06:32,320 --> 00:06:36,760
means that you cannot just pick up this

136
00:06:34,080 --> 00:06:39,870
advices about detection mitigations and

137
00:06:36,760 --> 00:06:42,450
go and implemented in them your own

138
00:06:39,870 --> 00:06:45,390
to actually implement it he need to be

139
00:06:42,450 --> 00:06:47,400
more specific for yourself understand

140
00:06:45,390 --> 00:06:49,349
what you are doing and why at the same

141
00:06:47,400 --> 00:06:52,289
time it's not it's always a team work so

142
00:06:49,350 --> 00:06:54,540
you need to understand your team members

143
00:06:52,290 --> 00:06:56,520
other departments leadership what you

144
00:06:54,540 --> 00:06:59,370
are doing why you're doing this and

145
00:06:56,520 --> 00:07:03,210
everything else so it's needs to be like

146
00:06:59,370 --> 00:07:05,340
detailed to be operationalized another

147
00:07:03,210 --> 00:07:09,930
thing is which is falling from the first

148
00:07:05,340 --> 00:07:12,119
topic is that mitre attack by itself

149
00:07:09,930 --> 00:07:15,680
doesn't provide you with the ability to

150
00:07:12,120 --> 00:07:18,180
explain what exactly do you need and

151
00:07:15,680 --> 00:07:20,640
doesn't provide you with the arguments

152
00:07:18,180 --> 00:07:22,440
like proofs what exactly why is actually

153
00:07:20,640 --> 00:07:25,469
need this one the good example of such

154
00:07:22,440 --> 00:07:27,600
thing is this one log source when you

155
00:07:25,470 --> 00:07:29,490
are saying your CMC my hey guys I want

156
00:07:27,600 --> 00:07:31,950
to have sis Mon there in our detection

157
00:07:29,490 --> 00:07:34,050
engine because I heard that he can

158
00:07:31,950 --> 00:07:34,979
detect what things do that and they're

159
00:07:34,050 --> 00:07:38,340
asking you alright

160
00:07:34,980 --> 00:07:39,870
how many data you like um what was B

161
00:07:38,340 --> 00:07:43,770
increased like an hour

162
00:07:39,870 --> 00:07:46,280
EPS what exactly needs to install there

163
00:07:43,770 --> 00:07:50,930
and why do you don't you like the

164
00:07:46,280 --> 00:07:54,510
default like you know Windows Event log

165
00:07:50,930 --> 00:07:58,230
like application security and system

166
00:07:54,510 --> 00:08:01,200
channels and it is relatively simple

167
00:07:58,230 --> 00:08:03,150
question but to answer it tend to be

168
00:08:01,200 --> 00:08:06,510
understood by everybody you have to do

169
00:08:03,150 --> 00:08:09,390
like huge research like what exactly you

170
00:08:06,510 --> 00:08:12,120
can detect with a small Y this batter

171
00:08:09,390 --> 00:08:14,940
down Windows Event log how many data

172
00:08:12,120 --> 00:08:17,669
like you will have after that and what

173
00:08:14,940 --> 00:08:20,250
can you detect like many things so each

174
00:08:17,669 --> 00:08:22,560
kind of each time somebody is asking you

175
00:08:20,250 --> 00:08:25,200
for to prove something to explain

176
00:08:22,560 --> 00:08:28,860
yourself you have to do lots of things

177
00:08:25,200 --> 00:08:32,218
to provide these proofs and compelling

178
00:08:28,860 --> 00:08:33,539
arguments and last thing well basically

179
00:08:32,219 --> 00:08:36,599
there are lots of thing but these are

180
00:08:33,539 --> 00:08:38,880
main for us reports and leadership

181
00:08:36,599 --> 00:08:40,710
basically when you are starting starting

182
00:08:38,880 --> 00:08:42,750
the implementation leadership want to

183
00:08:40,710 --> 00:08:46,410
know how you progressing what is the

184
00:08:42,750 --> 00:08:50,180
roadmap what is the current status and

185
00:08:46,410 --> 00:08:52,130
where you will be like in two months of

186
00:08:50,180 --> 00:08:54,410
or each and every customer because we

187
00:08:52,130 --> 00:08:59,360
are MSS we supposed to do reporting per

188
00:08:54,410 --> 00:09:01,610
customers so and it is also something

189
00:08:59,360 --> 00:09:04,430
which supposed to be simple but anytime

190
00:09:01,610 --> 00:09:05,930
you preparing the report you have to

191
00:09:04,430 --> 00:09:08,239
collect lots of data for multiple

192
00:09:05,930 --> 00:09:10,810
departments compile it together provide

193
00:09:08,240 --> 00:09:15,190
in an understandable way for management

194
00:09:10,810 --> 00:09:19,849
which is also kind of challenging and

195
00:09:15,190 --> 00:09:22,370
that's why in 2016 summer 2016 we

196
00:09:19,850 --> 00:09:26,420
decided to create our own tool or our

197
00:09:22,370 --> 00:09:29,959
own framework based on my tree and she

198
00:09:26,420 --> 00:09:32,930
basically operationalize this and it's

199
00:09:29,959 --> 00:09:34,969
called not a total misreading which

200
00:09:32,930 --> 00:09:38,719
cause it's code to use case framework

201
00:09:34,970 --> 00:09:41,240
yeah so you may heard about it in some

202
00:09:38,720 --> 00:09:45,020
conferences in Poland or in Luxembourg

203
00:09:41,240 --> 00:09:48,110
in 2017 or 18 but if you haven't don't

204
00:09:45,020 --> 00:09:51,410
worry today we will present you this

205
00:09:48,110 --> 00:09:55,279
stack the same benefits and something

206
00:09:51,410 --> 00:09:57,949
new and more actual so basically what

207
00:09:55,279 --> 00:10:01,820
was it it was a confluence knowledge

208
00:09:57,950 --> 00:10:05,810
base with the listed structure we were

209
00:10:01,820 --> 00:10:08,720
using my track technique as a separate

210
00:10:05,810 --> 00:10:12,400
use case and we were mapping multiple

211
00:10:08,720 --> 00:10:16,010
entities to this use case like alerts

212
00:10:12,400 --> 00:10:18,920
related data needed for which required

213
00:10:16,010 --> 00:10:21,830
for this alerting and related slogging

214
00:10:18,920 --> 00:10:24,949
policy and this way this way we were

215
00:10:21,830 --> 00:10:27,740
expressing ourselves to CMT also your

216
00:10:24,950 --> 00:10:31,160
mapping their response actions response

217
00:10:27,740 --> 00:10:33,770
response playbooks and many other things

218
00:10:31,160 --> 00:10:37,490
so Matthias will tell you more about it

219
00:10:33,770 --> 00:10:40,550
just in a few minutes so basically we

220
00:10:37,490 --> 00:10:42,890
solved the problems I have listed using

221
00:10:40,550 --> 00:10:47,510
this tool but we got another set of

222
00:10:42,890 --> 00:10:50,209
problems good example of it is the unit

223
00:10:47,510 --> 00:10:53,270
test unit test is an entity which which

224
00:10:50,209 --> 00:10:55,399
allow us to trigger some specific

225
00:10:53,270 --> 00:10:57,380
detection rule and we are putting all

226
00:10:55,399 --> 00:10:59,630
the stuff manually the confluence page

227
00:10:57,380 --> 00:11:00,589
to basically adjust to execute it you

228
00:10:59,630 --> 00:11:03,540
need to go there

229
00:11:00,589 --> 00:11:08,509
copy paste it and to the

230
00:11:03,540 --> 00:11:11,069
machine - you know trigger something and

231
00:11:08,509 --> 00:11:14,190
everything was filled manually and

232
00:11:11,070 --> 00:11:17,459
maintained manually another example is

233
00:11:14,190 --> 00:11:19,500
the traction rule we were using our own

234
00:11:17,459 --> 00:11:22,380
language to describe detection logic for

235
00:11:19,500 --> 00:11:25,709
CMT we call it high level detection

236
00:11:22,380 --> 00:11:27,600
logic well basically everything is

237
00:11:25,709 --> 00:11:29,819
simple at the same time we were

238
00:11:27,600 --> 00:11:32,850
supporting Cubana queries flying queries

239
00:11:29,819 --> 00:11:34,649
and CMT were doing their own stuff and

240
00:11:32,850 --> 00:11:37,620
everything was done manually so just

241
00:11:34,649 --> 00:11:39,930
imagine if you want to add their new

242
00:11:37,620 --> 00:11:41,850
service name for example we have to

243
00:11:39,930 --> 00:11:44,508
update this logic we have to bake when a

244
00:11:41,850 --> 00:11:50,160
query they have to update other things

245
00:11:44,509 --> 00:11:51,959
which require quite a lot of time that's

246
00:11:50,160 --> 00:11:54,180
the simple little bit let's say overview

247
00:11:51,959 --> 00:11:56,069
or the stuff we had this one is a use

248
00:11:54,180 --> 00:11:58,430
case there you can see like biggest

249
00:11:56,069 --> 00:12:00,959
square is a use case with a lot of links

250
00:11:58,430 --> 00:12:04,529
there are the needed logging policy

251
00:12:00,959 --> 00:12:10,768
software and other stuff and everything

252
00:12:04,529 --> 00:12:14,220
was tightly connected so just imagine

253
00:12:10,769 --> 00:12:16,050
for example when we were creating data

254
00:12:14,220 --> 00:12:18,089
needed entity there were no such thing

255
00:12:16,050 --> 00:12:19,680
that we were doing we were putting in

256
00:12:18,089 --> 00:12:21,779
these data into login policy and we

257
00:12:19,680 --> 00:12:25,349
decided one day like well it makes sense

258
00:12:21,779 --> 00:12:27,600
to separate these things and we started

259
00:12:25,350 --> 00:12:30,240
working on you and it's a and they had

260
00:12:27,600 --> 00:12:35,660
to rebuild basically everything change

261
00:12:30,240 --> 00:12:39,029
our links add new links create new

262
00:12:35,660 --> 00:12:42,660
articles for each data needed which took

263
00:12:39,029 --> 00:12:45,810
like two three weeks for two specialists

264
00:12:42,660 --> 00:12:48,870
and that's a lot and we're not counting

265
00:12:45,810 --> 00:12:51,239
the general maintenance another problem

266
00:12:48,870 --> 00:12:54,029
just following from that is that we were

267
00:12:51,240 --> 00:12:56,550
duplicating some stuff but still there

268
00:12:54,029 --> 00:13:00,540
are too many too many places where you

269
00:12:56,550 --> 00:13:02,790
should update it we just you know for

270
00:13:00,540 --> 00:13:05,399
missing some places and that's why in

271
00:13:02,790 --> 00:13:08,009
some lists we were saying these

272
00:13:05,399 --> 00:13:14,040
deprecated alerts or duplicated other

273
00:13:08,009 --> 00:13:15,650
kind of entities so last fall religious

274
00:13:14,040 --> 00:13:19,410
some

275
00:13:15,650 --> 00:13:26,340
horrible number if you think it is small

276
00:13:19,410 --> 00:13:28,589
how about that so you guys it's when are

277
00:13:26,340 --> 00:13:30,960
you maintaining such amount of analytics

278
00:13:28,590 --> 00:13:33,630
manually in web-based engine it became a

279
00:13:30,960 --> 00:13:35,850
madness that's why I last fall we

280
00:13:33,630 --> 00:13:38,130
decided to change and we were inspired

281
00:13:35,850 --> 00:13:40,950
by two projects first there's elastic

282
00:13:38,130 --> 00:13:44,010
comment schema we were contributing to

283
00:13:40,950 --> 00:13:46,200
it at that time and we were really

284
00:13:44,010 --> 00:13:48,480
inspired by the way how they handle

285
00:13:46,200 --> 00:13:50,910
their stuff so you basically update one

286
00:13:48,480 --> 00:13:54,750
configuration file or add something

287
00:13:50,910 --> 00:13:56,930
there edited and execute make command

288
00:13:54,750 --> 00:13:58,080
and after that it's generates

289
00:13:56,930 --> 00:14:00,660
regenerates

290
00:13:58,080 --> 00:14:03,360
all the documentation all the CSV files

291
00:14:00,660 --> 00:14:05,280
all the index templates basically

292
00:14:03,360 --> 00:14:07,640
everything for you in the background

293
00:14:05,280 --> 00:14:11,130
like automatically which is just awesome

294
00:14:07,640 --> 00:14:12,300
another project is Sigma we were using

295
00:14:11,130 --> 00:14:15,030
Sigma in the beginning in the first

296
00:14:12,300 --> 00:14:17,370
version of versions of use case

297
00:14:15,030 --> 00:14:19,980
framework but then we decided to change

298
00:14:17,370 --> 00:14:22,890
to our own logic due to some internal

299
00:14:19,980 --> 00:14:24,900
reasons but last fall we saw huge

300
00:14:22,890 --> 00:14:26,550
community support for this project at

301
00:14:24,900 --> 00:14:29,270
the same time they've started mapping

302
00:14:26,550 --> 00:14:32,280
their rules to miter attack techniques

303
00:14:29,270 --> 00:14:35,030
and that's why we decided to try to use

304
00:14:32,280 --> 00:14:37,650
them again and what's happened then

305
00:14:35,030 --> 00:14:40,980
beautiful integrations automated

306
00:14:37,650 --> 00:14:43,199
workflows big discoveries and also fun

307
00:14:40,980 --> 00:14:51,920
and profit for us and for community and

308
00:14:43,200 --> 00:14:55,220
mattie i'll tell you more about it so

309
00:14:51,920 --> 00:14:57,569
we've a few requirements for ourselves

310
00:14:55,220 --> 00:15:01,080
first of all we wanted to work with

311
00:14:57,570 --> 00:15:04,740
plain text files because they are easier

312
00:15:01,080 --> 00:15:07,380
to manage we could use version control

313
00:15:04,740 --> 00:15:10,920
systems like gate and do some bulk

314
00:15:07,380 --> 00:15:13,680
changes inside of those we decided to

315
00:15:10,920 --> 00:15:17,849
not do any kind of maintenance in web

316
00:15:13,680 --> 00:15:20,790
base editors because that amount of work

317
00:15:17,850 --> 00:15:22,740
which we did in confluence was just

318
00:15:20,790 --> 00:15:24,209
overwhelming and we decided to not do

319
00:15:22,740 --> 00:15:28,620
that anymore

320
00:15:24,210 --> 00:15:33,870
we wanted to MIMO manual job

321
00:15:28,620 --> 00:15:38,850
to be able to focus on more meaningful

322
00:15:33,870 --> 00:15:43,020
work like developing new rules or or

323
00:15:38,850 --> 00:15:47,850
tests and we wanted to and we wanted to

324
00:15:43,020 --> 00:15:52,100
automate everything which was able to be

325
00:15:47,850 --> 00:15:56,070
automated so following that requirements

326
00:15:52,100 --> 00:15:59,430
first of all we wanted something to work

327
00:15:56,070 --> 00:16:01,940
for us as trigger entities and we

328
00:15:59,430 --> 00:16:04,739
decided to use atomic reading for that

329
00:16:01,940 --> 00:16:07,860
and if you are not familiar with this

330
00:16:04,740 --> 00:16:10,710
project it uses Atomics which are tests

331
00:16:07,860 --> 00:16:12,810
mapped to miters techniques and might be

332
00:16:10,710 --> 00:16:15,060
used for testing detection capabilities

333
00:16:12,810 --> 00:16:16,800
and mitigation systems which are

334
00:16:15,060 --> 00:16:19,140
implemented

335
00:16:16,800 --> 00:16:23,400
so those Atomics are stored in Yama

336
00:16:19,140 --> 00:16:26,100
files and they contains actions which

337
00:16:23,400 --> 00:16:28,740
might be executed by adversaries or red

338
00:16:26,100 --> 00:16:30,600
team and what's really cool about this

339
00:16:28,740 --> 00:16:33,960
project is that it also comes with

340
00:16:30,600 --> 00:16:36,480
execution frameworks which basically

341
00:16:33,960 --> 00:16:39,750
made makes all of those tests actionable

342
00:16:36,480 --> 00:16:41,880
so you can prepare a list of tests which

343
00:16:39,750 --> 00:16:44,370
you would like to execute and quickly

344
00:16:41,880 --> 00:16:48,689
execute all of them on your in your test

345
00:16:44,370 --> 00:16:50,880
environment using those frameworks so

346
00:16:48,690 --> 00:16:55,140
once we had something to to test we

347
00:16:50,880 --> 00:16:58,430
needed to detect such activities and for

348
00:16:55,140 --> 00:17:01,710
that we decided to use the Sigma project

349
00:16:58,430 --> 00:17:04,679
if you are not familiar with it it it is

350
00:17:01,710 --> 00:17:07,590
the generic signature format for cm

351
00:17:04,680 --> 00:17:09,330
systems and the real power of it comes

352
00:17:07,589 --> 00:17:11,399
from its converter which is able to

353
00:17:09,329 --> 00:17:14,069
translate rules which are stored in

354
00:17:11,400 --> 00:17:17,010
Sigma format into queries for multiple

355
00:17:14,069 --> 00:17:20,250
cm systems like Splunk elasticsearch

356
00:17:17,010 --> 00:17:22,950
kibana Greylock ArcSight the list of

357
00:17:20,250 --> 00:17:27,200
supported systems is quite huge so

358
00:17:22,950 --> 00:17:29,970
that's only some examples and that's how

359
00:17:27,200 --> 00:17:32,250
sample rule written in Sigma format

360
00:17:29,970 --> 00:17:35,040
looks like as you can see inside the tax

361
00:17:32,250 --> 00:17:37,620
we have mappings to miters techniques

362
00:17:35,040 --> 00:17:41,040
and tactics there are some references

363
00:17:37,620 --> 00:17:42,149
and the conditions which are necessarily

364
00:17:41,040 --> 00:17:43,830
too met for

365
00:17:42,150 --> 00:17:48,660
the rule to trigger on some specific

366
00:17:43,830 --> 00:17:50,639
event so to make those rules works

367
00:17:48,660 --> 00:17:53,670
correctly we have to collect proper data

368
00:17:50,640 --> 00:17:56,130
and to keep track of it of what we have

369
00:17:53,670 --> 00:17:59,850
to collect we've created data needed

370
00:17:56,130 --> 00:18:02,100
entities so here we have the roll

371
00:17:59,850 --> 00:18:04,320
example which you might want to pass to

372
00:18:02,100 --> 00:18:07,409
see empty more data engineers to show

373
00:18:04,320 --> 00:18:10,439
them what what they should expect the

374
00:18:07,410 --> 00:18:13,290
list of the fields redundant ones here

375
00:18:10,440 --> 00:18:15,660
are used for the analytic purposes also

376
00:18:13,290 --> 00:18:18,000
the provider of that lock some

377
00:18:15,660 --> 00:18:20,820
references and was most important it

378
00:18:18,000 --> 00:18:23,730
also leads the logging policies which

379
00:18:20,820 --> 00:18:27,300
are needed to be implemented to collect

380
00:18:23,730 --> 00:18:31,200
some specific data and that's how sample

381
00:18:27,300 --> 00:18:33,720
logging policy entity looks like so as I

382
00:18:31,200 --> 00:18:36,600
said they describe what have to be

383
00:18:33,720 --> 00:18:38,640
configured to collect some data and at

384
00:18:36,600 --> 00:18:40,830
the same time they provide exact steps

385
00:18:38,640 --> 00:18:43,590
which have to be followed to collect

386
00:18:40,830 --> 00:18:48,240
such such to implement those policies

387
00:18:43,590 --> 00:18:50,280
and recently we also created new entity

388
00:18:48,240 --> 00:18:52,410
which is customer and this one allows

389
00:18:50,280 --> 00:18:55,410
you to track which data you are

390
00:18:52,410 --> 00:18:57,540
collecting which logging policy and

391
00:18:55,410 --> 00:19:00,810
which detection rules are implemented

392
00:18:57,540 --> 00:19:02,850
and it's not like this is useful only

393
00:19:00,810 --> 00:19:05,550
for these service providers because for

394
00:19:02,850 --> 00:19:09,330
internal security teams the customer

395
00:19:05,550 --> 00:19:11,639
might be another department remote

396
00:19:09,330 --> 00:19:15,560
office or even some specific assets like

397
00:19:11,640 --> 00:19:17,700
some server or group of of the hosts

398
00:19:15,560 --> 00:19:21,419
going further we've introduced

399
00:19:17,700 --> 00:19:23,790
enrichment entities and those entities

400
00:19:21,420 --> 00:19:26,790
describes how to enrich events with

401
00:19:23,790 --> 00:19:30,810
additional information so here we have

402
00:19:26,790 --> 00:19:32,850
the list of requirements list of events

403
00:19:30,810 --> 00:19:35,490
which might be enriched and description

404
00:19:32,850 --> 00:19:37,350
of the Gulf's on specific enrichment for

405
00:19:35,490 --> 00:19:40,010
example this might be introduction of

406
00:19:37,350 --> 00:19:43,740
new fields renaming or translation of

407
00:19:40,010 --> 00:19:45,750
some of the existing ones and it also

408
00:19:43,740 --> 00:19:49,280
contains the configuration which is

409
00:19:45,750 --> 00:19:51,840
needed to achieve such enrichment

410
00:19:49,280 --> 00:19:53,580
another thing our response actions and

411
00:19:51,840 --> 00:19:56,040
we've created those for incident

412
00:19:53,580 --> 00:19:58,620
response teams so they contains

413
00:19:56,040 --> 00:20:01,860
workflows associated with specific

414
00:19:58,620 --> 00:20:03,840
incident response phases and we are

415
00:20:01,860 --> 00:20:07,709
using them to construct the response

416
00:20:03,840 --> 00:20:11,639
playbooks and response playbooks

417
00:20:07,710 --> 00:20:13,710
are used as incident response plan for

418
00:20:11,640 --> 00:20:15,510
some specific threat and they are using

419
00:20:13,710 --> 00:20:17,580
Xmas actions as building blocks and

420
00:20:15,510 --> 00:20:19,860
since those were written in very

421
00:20:17,580 --> 00:20:22,710
granular way it gives ability to use

422
00:20:19,860 --> 00:20:23,250
same action in insight multiple

423
00:20:22,710 --> 00:20:25,830
playbooks

424
00:20:23,250 --> 00:20:28,260
so if you will update the response

425
00:20:25,830 --> 00:20:31,820
action all of the playbook switch uses

426
00:20:28,260 --> 00:20:36,120
that detection will be updated as well

427
00:20:31,820 --> 00:20:40,230
quite new stuff or visualizations so

428
00:20:36,120 --> 00:20:43,739
here we are aiming for ability of

429
00:20:40,230 --> 00:20:47,220
creation visualization independently

430
00:20:43,740 --> 00:20:50,190
from the system's currently we are

431
00:20:47,220 --> 00:20:53,130
supporting only Cabana but our next goal

432
00:20:50,190 --> 00:20:56,910
is to support this plank as well and in

433
00:20:53,130 --> 00:20:58,710
future maybe other systems so as you can

434
00:20:56,910 --> 00:21:01,800
see it's just the description of what

435
00:20:58,710 --> 00:21:05,010
have to be visual visualize and we are

436
00:21:01,800 --> 00:21:09,240
using them to create the dart boards so

437
00:21:05,010 --> 00:21:12,180
it allows you to create dart board by

438
00:21:09,240 --> 00:21:14,790
just listing the names of visualization

439
00:21:12,180 --> 00:21:18,030
in which we are interested and they

440
00:21:14,790 --> 00:21:20,760
supposed to be shareable and easy to

441
00:21:18,030 --> 00:21:24,080
maintain

442
00:21:20,760 --> 00:21:29,730
so a few words was going under the hood

443
00:21:24,080 --> 00:21:31,290
we separated data logic and presentation

444
00:21:29,730 --> 00:21:33,570
layers from each other

445
00:21:31,290 --> 00:21:36,420
all of our entities are stored in that

446
00:21:33,570 --> 00:21:39,330
TM files which I'll just show to you so

447
00:21:36,420 --> 00:21:42,810
it's easy to do some changes inside of

448
00:21:39,330 --> 00:21:44,669
them or create new stuff for example if

449
00:21:42,810 --> 00:21:46,740
you have some custom logging for

450
00:21:44,670 --> 00:21:52,020
application it shouldn't be a problem to

451
00:21:46,740 --> 00:21:55,880
add them we wrote most of the code in

452
00:21:52,020 --> 00:21:58,889
Python and we wrote few modules to

453
00:21:55,880 --> 00:22:01,290
present that data in in different

454
00:21:58,890 --> 00:22:05,250
formats and calculate some mappings

455
00:22:01,290 --> 00:22:07,530
between them and what's also worth to

456
00:22:05,250 --> 00:22:09,280
mention that we are using the ginger

457
00:22:07,530 --> 00:22:13,899
templates

458
00:22:09,280 --> 00:22:16,210
for human-readable wikis so it's kind of

459
00:22:13,900 --> 00:22:20,230
easy to adjust how how you want to

460
00:22:16,210 --> 00:22:23,650
present it and since it's ginger is also

461
00:22:20,230 --> 00:22:25,150
asks you to create new export formats so

462
00:22:23,650 --> 00:22:27,910
currently we are supporting only

463
00:22:25,150 --> 00:22:30,340
markdown and the confluence but it

464
00:22:27,910 --> 00:22:32,650
shouldn't be a problem to export that

465
00:22:30,340 --> 00:22:38,080
data to other wiki system like media

466
00:22:32,650 --> 00:22:40,720
wiki and small demo time so I would like

467
00:22:38,080 --> 00:22:44,610
to show you step by step kind of

468
00:22:40,720 --> 00:22:47,020
detailed tutorial how to implement

469
00:22:44,610 --> 00:22:59,320
atomic fred coverage inside your

470
00:22:47,020 --> 00:23:02,730
environment so it starts from execution

471
00:22:59,320 --> 00:23:02,730
of Mike utility

472
00:23:07,780 --> 00:23:13,570
and basically that's all that's all you

473
00:23:10,720 --> 00:23:15,520
have to do so what just happened all of

474
00:23:13,570 --> 00:23:19,020
these sub modules which are connected

475
00:23:15,520 --> 00:23:21,700
we're updated in this case it was the

476
00:23:19,020 --> 00:23:24,129
public version of Sigma project and

477
00:23:21,700 --> 00:23:26,350
atomic read but this part is

478
00:23:24,130 --> 00:23:30,450
configurable so if you have your own

479
00:23:26,350 --> 00:23:35,189
private Forks of that projects you can

480
00:23:30,450 --> 00:23:38,200
configure ATC to use those all of the

481
00:23:35,190 --> 00:23:41,530
entities were exported to mark down to

482
00:23:38,200 --> 00:23:44,980
the confluence and additional files with

483
00:23:41,530 --> 00:23:46,960
analytics were created and Daniel will

484
00:23:44,980 --> 00:23:49,600
show you right now how it looks like

485
00:23:46,960 --> 00:23:52,270
after that export and what you can do

486
00:23:49,600 --> 00:23:54,360
with the files which were exported thank

487
00:23:52,270 --> 00:23:54,360
you

488
00:24:06,040 --> 00:24:12,409
so guys I just want to ask you to follow

489
00:24:08,630 --> 00:24:15,230
this QR code or better if you have a

490
00:24:12,410 --> 00:24:17,480
laptop better use this short link to

491
00:24:15,230 --> 00:24:20,120
open our demonstration is available

492
00:24:17,480 --> 00:24:24,310
public but for mobile phones looks

493
00:24:20,120 --> 00:24:27,080
horrible so better to use laptop

494
00:24:24,310 --> 00:24:30,760
basically I'm gonna show you how it

495
00:24:27,080 --> 00:24:34,040
looks like conference and again just to

496
00:24:30,760 --> 00:24:35,840
refresh the what Mateo said everything

497
00:24:34,040 --> 00:24:40,550
which we're gonna show you right now

498
00:24:35,840 --> 00:24:43,850
based on open source Sigma detection

499
00:24:40,550 --> 00:24:47,389
rules and triggers from atomic read

500
00:24:43,850 --> 00:24:49,610
scene and some an open source analytics

501
00:24:47,390 --> 00:24:51,470
from our side like Etta needed login

502
00:24:49,610 --> 00:24:54,649
policies and related things like

503
00:24:51,470 --> 00:25:01,160
response actions alright I hope you

504
00:24:54,650 --> 00:25:03,440
manage to do it so basically that's how

505
00:25:01,160 --> 00:25:07,280
conference looks like as you can see the

506
00:25:03,440 --> 00:25:10,640
structure similar to use case framework

507
00:25:07,280 --> 00:25:12,200
but a bit different so it was created

508
00:25:10,640 --> 00:25:17,930
automatically just please keep it in

509
00:25:12,200 --> 00:25:21,980
mind if you'll open detection rule you

510
00:25:17,930 --> 00:25:24,470
will see this rendered table is all the

511
00:25:21,980 --> 00:25:26,930
mappings clickable links to attack

512
00:25:24,470 --> 00:25:30,440
tactics techniques automatically

513
00:25:26,930 --> 00:25:33,770
calculated data needed entities and

514
00:25:30,440 --> 00:25:38,120
links to them links link it so trigger

515
00:25:33,770 --> 00:25:39,860
which is atomic read same test and also

516
00:25:38,120 --> 00:25:43,219
here you can find the original Sigma

517
00:25:39,860 --> 00:25:46,550
rule which was used to render this page

518
00:25:43,220 --> 00:25:50,270
also if you automatically generated

519
00:25:46,550 --> 00:25:52,550
queries and this list of queries could

520
00:25:50,270 --> 00:25:54,320
be adjusted by units for example if you

521
00:25:52,550 --> 00:25:55,899
need Splunk just add Splunk to

522
00:25:54,320 --> 00:26:01,610
configuration and you will see that

523
00:25:55,900 --> 00:26:04,340
automatically generated query for it so

524
00:26:01,610 --> 00:26:08,479
if we will click two data needed we will

525
00:26:04,340 --> 00:26:10,459
go to this article here you can see a

526
00:26:08,480 --> 00:26:12,920
simple description of what is it and

527
00:26:10,460 --> 00:26:15,380
again very important thing is logging

528
00:26:12,920 --> 00:26:16,880
policies because data need just not

529
00:26:15,380 --> 00:26:18,940
exist by itself you have to configure

530
00:26:16,880 --> 00:26:21,220
something to have this data in

531
00:26:18,940 --> 00:26:25,120
so basically how it works you just

532
00:26:21,220 --> 00:26:27,340
provide CMC link it's the article or

533
00:26:25,120 --> 00:26:30,239
list of links to articles and they just

534
00:26:27,340 --> 00:26:32,470
click into link AHA so I need these data

535
00:26:30,240 --> 00:26:34,770
to have this data need this logging

536
00:26:32,470 --> 00:26:39,430
policy everything is kind of clear

537
00:26:34,770 --> 00:26:41,530
transparent and detailed enough all

538
00:26:39,430 --> 00:26:44,190
right also you see here

539
00:26:41,530 --> 00:26:47,649
definition of tie provider Channel and

540
00:26:44,190 --> 00:26:50,050
list of fields for analytics which I

541
00:26:47,650 --> 00:26:52,840
will show you in a minute at the same

542
00:26:50,050 --> 00:26:55,389
time there is a row log sample which is

543
00:26:52,840 --> 00:26:58,409
required for CM team to explain them

544
00:26:55,390 --> 00:27:01,030
what they should expect on receiver side

545
00:26:58,410 --> 00:27:05,410
alright this running back to detection

546
00:27:01,030 --> 00:27:07,840
rule there is a link to trigger which is

547
00:27:05,410 --> 00:27:10,720
basically original atomic our HCM test

548
00:27:07,840 --> 00:27:13,300
and here we have original article

549
00:27:10,720 --> 00:27:15,070
created by automatically generated by

550
00:27:13,300 --> 00:27:18,129
atomic reading project itself they have

551
00:27:15,070 --> 00:27:20,860
the description from my tree list of

552
00:27:18,130 --> 00:27:23,590
atomic tests and the tests themselves so

553
00:27:20,860 --> 00:27:28,060
basically everything is here presented

554
00:27:23,590 --> 00:27:29,590
in a human readable way also there are

555
00:27:28,060 --> 00:27:31,330
multiple entities but I'm not going to

556
00:27:29,590 --> 00:27:33,760
show you all of them basically you have

557
00:27:31,330 --> 00:27:35,439
a link you can go there yourself and be

558
00:27:33,760 --> 00:27:41,140
limited by time so I will show you only

559
00:27:35,440 --> 00:27:42,970
one more which is response playbook and

560
00:27:41,140 --> 00:27:47,670
again here you can see the same style of

561
00:27:42,970 --> 00:27:50,860
page with links to my track framework

562
00:27:47,670 --> 00:27:53,890
all the mappings from Yama file and if

563
00:27:50,860 --> 00:27:58,419
you remember in Yama file you only had

564
00:27:53,890 --> 00:28:01,950
this links to response actions which are

565
00:27:58,420 --> 00:28:05,010
constructed following the six six steps

566
00:28:01,950 --> 00:28:07,780
instant response lifecycle steps and

567
00:28:05,010 --> 00:28:09,730
here we have description of workflow

568
00:28:07,780 --> 00:28:13,810
again from the same Yama file but at the

569
00:28:09,730 --> 00:28:17,190
same time in the body of this article we

570
00:28:13,810 --> 00:28:20,040
have all the response actions rendered

571
00:28:17,190 --> 00:28:22,290
automatically so basically in case of

572
00:28:20,040 --> 00:28:25,389
phishing attack you just provide this

573
00:28:22,290 --> 00:28:27,040
playbook to shock analysts or instance

574
00:28:25,390 --> 00:28:31,929
responders they following their stuff

575
00:28:27,040 --> 00:28:35,090
but the main power of this entity

576
00:28:31,929 --> 00:28:39,409
ability to export it to the hive

577
00:28:35,090 --> 00:28:42,769
platform you may heard about it but if

578
00:28:39,409 --> 00:28:45,380
you haven't the hive is D I would say

579
00:28:42,769 --> 00:28:50,230
the best or at least most popular free

580
00:28:45,380 --> 00:28:55,070
open-source instant response platform so

581
00:28:50,230 --> 00:28:57,200
atomic fat coverage translate this Yama

582
00:28:55,070 --> 00:29:00,860
file not only to Conference markdown

583
00:28:57,200 --> 00:29:03,110
it's also can create case templates for

584
00:29:00,860 --> 00:29:07,428
the hive basically what you're going to

585
00:29:03,110 --> 00:29:13,370
do we will go to case management or case

586
00:29:07,429 --> 00:29:16,039
templates I don't click import going to

587
00:29:13,370 --> 00:29:18,559
atomic for coverage folder picking up

588
00:29:16,039 --> 00:29:25,580
automatically generated profile or case

589
00:29:18,559 --> 00:29:27,320
template and here we see that this case

590
00:29:25,580 --> 00:29:29,809
template was created and we can create

591
00:29:27,320 --> 00:29:33,889
the case out of it so basically clicking

592
00:29:29,809 --> 00:29:37,519
new case the case template putting there

593
00:29:33,889 --> 00:29:40,760
some random name as you can see all the

594
00:29:37,519 --> 00:29:43,510
mappings already there so that's how it

595
00:29:40,760 --> 00:29:47,330
looks like description from Yama file

596
00:29:43,510 --> 00:29:51,669
all the metrics from again from Yama

597
00:29:47,330 --> 00:29:54,769
file and the response actions mapped as

598
00:29:51,669 --> 00:29:57,559
tasks for this case template and if you

599
00:29:54,769 --> 00:29:59,630
will open it you will see original

600
00:29:57,559 --> 00:30:02,990
description from response actions here

601
00:29:59,630 --> 00:30:05,120
in this task so basically you can assign

602
00:30:02,990 --> 00:30:08,600
this task to some of instant responders

603
00:30:05,120 --> 00:30:10,610
or do it yourself click start and like

604
00:30:08,600 --> 00:30:13,449
you know just general your please follow

605
00:30:10,610 --> 00:30:13,449
your procedure

606
00:30:22,370 --> 00:30:28,189
next one and again here are caught and

607
00:30:24,740 --> 00:30:30,669
again the same I just would like to ask

608
00:30:28,190 --> 00:30:33,409
you to not use your phones for that

609
00:30:30,669 --> 00:30:35,659
better use your laptops if you have such

610
00:30:33,409 --> 00:30:39,980
opportunity because in the mobile

611
00:30:35,659 --> 00:30:43,070
version is looks like really bad so we

612
00:30:39,980 --> 00:30:46,700
will I will show you the analytics

613
00:30:43,070 --> 00:30:53,830
dashboard based on open-source Sigma

614
00:30:46,700 --> 00:30:53,830
rules and again with some our let's say

615
00:30:54,100 --> 00:30:58,658
automatically calculated mappings

616
00:31:04,480 --> 00:31:12,919
alright so here you see description it

617
00:31:09,320 --> 00:31:15,470
says that there are 211 detection rules

618
00:31:12,919 --> 00:31:19,240
or Sigma rules from open source project

619
00:31:15,470 --> 00:31:23,419
we updated it yesterday so it is actual

620
00:31:19,240 --> 00:31:26,140
we provided some extra calculation for

621
00:31:23,419 --> 00:31:28,669
data needed logging policy and there are

622
00:31:26,140 --> 00:31:32,179
test customer entities just to

623
00:31:28,669 --> 00:31:35,690
demonstrate what customer entity was

624
00:31:32,179 --> 00:31:42,070
built for so first row is distribution

625
00:31:35,690 --> 00:31:42,070
of detection rules per my attack tactic

626
00:31:42,309 --> 00:31:49,539
well basically everything is simple here

627
00:31:44,840 --> 00:31:53,120
on this diagram we see that almost like

628
00:31:49,539 --> 00:31:55,220
95 percent of our rules were not

629
00:31:53,120 --> 00:31:57,110
implemented anywhere this way we can

630
00:31:55,220 --> 00:31:59,570
track how many deduction rules we have

631
00:31:57,110 --> 00:32:06,678
in some specific customer environment

632
00:31:59,570 --> 00:32:09,590
implemented next thing is distribution

633
00:32:06,679 --> 00:32:12,350
of data providers per detection rules

634
00:32:09,590 --> 00:32:14,418
here you can see that most of open

635
00:32:12,350 --> 00:32:18,168
source Sigma rules are based on three

636
00:32:14,419 --> 00:32:21,230
providers Sigma sorry sis Mon and

637
00:32:18,169 --> 00:32:23,710
Windows Event log security auditing

638
00:32:21,230 --> 00:32:23,710
provider

639
00:32:26,960 --> 00:32:32,010
next thing is that we can highlight

640
00:32:29,640 --> 00:32:35,370
that's a system on is not just provides

641
00:32:32,010 --> 00:32:38,190
to us majority of the detection rules

642
00:32:35,370 --> 00:32:42,600
it's also providers most of critical

643
00:32:38,190 --> 00:32:45,690
rules so this way you know we can is

644
00:32:42,600 --> 00:32:50,310
explain why we need some specific data

645
00:32:45,690 --> 00:32:58,940
source to leadership or other teams to

646
00:32:50,310 --> 00:33:01,560
basically to anybody next thing is

647
00:32:58,940 --> 00:33:04,820
distribution of development status /

648
00:33:01,560 --> 00:33:08,700
detection rule here you can see that

649
00:33:04,820 --> 00:33:12,659
almost 80 percent of open source signals

650
00:33:08,700 --> 00:33:15,360
have experimental status which means

651
00:33:12,660 --> 00:33:16,770
that you cannot just implement them in

652
00:33:15,360 --> 00:33:19,830
your environment you need some extra

653
00:33:16,770 --> 00:33:21,360
testing on production data or just in

654
00:33:19,830 --> 00:33:24,449
the test lab and depends on your

655
00:33:21,360 --> 00:33:28,830
requirements and only like three

656
00:33:24,450 --> 00:33:32,250
percents stable kind of not defined for

657
00:33:28,830 --> 00:33:34,590
the rest which is also can be used like

658
00:33:32,250 --> 00:33:37,380
if you are saying I need some resources

659
00:33:34,590 --> 00:33:42,360
from my detection lab you can show this

660
00:33:37,380 --> 00:33:44,220
diagram you know kind of supporting also

661
00:33:42,360 --> 00:33:45,629
a few tops like you can see most

662
00:33:44,220 --> 00:33:47,580
detection rules were developed by

663
00:33:45,630 --> 00:33:52,670
foreign Roth one of the authors for

664
00:33:47,580 --> 00:33:56,820
Sigma and another one is says that

665
00:33:52,670 --> 00:34:00,060
majority of like 90% of all rules were

666
00:33:56,820 --> 00:34:05,939
built upon see events IDs six-month

667
00:34:00,060 --> 00:34:08,668
event 81 and windows event ID 46 88 so

668
00:34:05,940 --> 00:34:15,200
basically both are about process

669
00:34:08,668 --> 00:34:15,199
execution this common line alrighty

670
00:34:20,170 --> 00:34:28,600
yeah and the last demonstration for

671
00:34:21,940 --> 00:34:30,880
today expert to attack navigator

672
00:34:28,600 --> 00:34:33,850
if you don't familiar with that this is

673
00:34:30,880 --> 00:34:37,570
a tool for exploration analysis like

674
00:34:33,850 --> 00:34:43,839
mostly for gap analysis it was created

675
00:34:37,570 --> 00:34:46,060
by white ray and before atc we were

676
00:34:43,840 --> 00:34:48,150
developing a technology three profiles

677
00:34:46,060 --> 00:34:52,210
per customer manually you know it's a

678
00:34:48,150 --> 00:34:54,010
handy thing to show to your manager or

679
00:34:52,210 --> 00:34:57,840
to customer like how you're progressing

680
00:34:54,010 --> 00:35:01,560
what is the current coverage which is

681
00:34:57,840 --> 00:35:04,030
kind of questionable but whatever so

682
00:35:01,560 --> 00:35:05,890
what we did we just generate this

683
00:35:04,030 --> 00:35:07,420
profile per customer and for all

684
00:35:05,890 --> 00:35:09,370
existing analytics so basically

685
00:35:07,420 --> 00:35:12,130
everything is already generated for just

686
00:35:09,370 --> 00:35:15,730
picking it up yeah you have to click

687
00:35:12,130 --> 00:35:19,590
like add new layer or new tab open

688
00:35:15,730 --> 00:35:23,200
existing layer open under latex

689
00:35:19,590 --> 00:35:25,810
generated pack navigator and choose what

690
00:35:23,200 --> 00:35:30,430
profile you want later specific customer

691
00:35:25,810 --> 00:35:33,610
just for all of them and here you go

692
00:35:30,430 --> 00:35:37,930
that's the current coverage provided by

693
00:35:33,610 --> 00:35:40,330
Sigma project so that's the that's handy

694
00:35:37,930 --> 00:35:45,100
for again mostly for gap analysis but

695
00:35:40,330 --> 00:35:47,610
not for like coverage analysis so that's

696
00:35:45,100 --> 00:35:47,610
how it looks like

697
00:35:52,810 --> 00:35:58,660
next thing we are not limited to

698
00:35:55,369 --> 00:36:01,040
confluence at the same time regenerates

699
00:35:58,660 --> 00:36:03,259
absolutely the same information we have

700
00:36:01,040 --> 00:36:06,290
in conference in markdown format so you

701
00:36:03,260 --> 00:36:08,359
can use if you don't like confluence and

702
00:36:06,290 --> 00:36:10,820
don't want to pay money or I don't know

703
00:36:08,359 --> 00:36:13,400
any other reasons you can use markdown

704
00:36:10,820 --> 00:36:16,520
renders engines like get lab github or

705
00:36:13,400 --> 00:36:18,410
any others he prefer and you will have

706
00:36:16,520 --> 00:36:20,990
absolutely the same information there

707
00:36:18,410 --> 00:36:24,740
each time execution make we have all the

708
00:36:20,990 --> 00:36:28,459
entire knowledge base in markdown in one

709
00:36:24,740 --> 00:36:31,009
of the folders and repository next thing

710
00:36:28,460 --> 00:36:33,200
is analytics CSV so basically if you

711
00:36:31,010 --> 00:36:35,599
don't like Cubana if you don't have

712
00:36:33,200 --> 00:36:38,540
Cabana for some reason you can just use

713
00:36:35,599 --> 00:36:40,280
analytics CSV it has absolutely the same

714
00:36:38,540 --> 00:36:43,970
data you can answer absolutely the same

715
00:36:40,280 --> 00:36:47,599
questions using filtering or maybe if

716
00:36:43,970 --> 00:36:51,319
your fan of Bosh like cut pipes and

717
00:36:47,599 --> 00:36:53,450
everything use this stuff so here is the

718
00:36:51,320 --> 00:36:56,750
example of filtering for pass the hash

719
00:36:53,450 --> 00:36:58,730
and you can see what data needed you

720
00:36:56,750 --> 00:37:01,310
need for that also there is a mapping to

721
00:36:58,730 --> 00:37:02,750
triggers again logging policy like

722
00:37:01,310 --> 00:37:06,670
always that I need it always came with

723
00:37:02,750 --> 00:37:10,510
working policies and everything else

724
00:37:06,670 --> 00:37:15,589
next one which is also quite important

725
00:37:10,510 --> 00:37:18,950
called pivoting CSV this file destined C

726
00:37:15,589 --> 00:37:23,930
provide you with information where you

727
00:37:18,950 --> 00:37:26,180
can get some specific data type like

728
00:37:23,930 --> 00:37:27,890
hash for example what kind of data

729
00:37:26,180 --> 00:37:30,230
source can provide you with this

730
00:37:27,890 --> 00:37:33,109
information like you need hash for

731
00:37:30,230 --> 00:37:36,140
example so you put there a hash and it

732
00:37:33,109 --> 00:37:37,910
shows you the list of data needed or log

733
00:37:36,140 --> 00:37:40,700
sources where you can find this hash

734
00:37:37,910 --> 00:37:43,368
which is quite handy for triage and

735
00:37:40,700 --> 00:37:47,980
initial response and basically you know

736
00:37:43,369 --> 00:37:50,690
for understanding so as he remember we

737
00:37:47,980 --> 00:37:55,460
created another entity called dashboards

738
00:37:50,690 --> 00:37:58,430
with simple lists two links sorry for

739
00:37:55,460 --> 00:38:00,740
two other visualizations and we

740
00:37:58,430 --> 00:38:02,308
automatically converted to a JSON file

741
00:38:00,740 --> 00:38:04,948
for Cubana of

742
00:38:02,309 --> 00:38:07,529
you can automatically or manually upload

743
00:38:04,949 --> 00:38:10,380
this JSON if you have this kind of

744
00:38:07,529 --> 00:38:11,910
dashboard we also have it in our

745
00:38:10,380 --> 00:38:15,859
demonstration version it's available

746
00:38:11,910 --> 00:38:19,769
this using the same link or QR code and

747
00:38:15,859 --> 00:38:22,949
we built this dashboard with mordor

748
00:38:19,769 --> 00:38:24,899
project data tomorrow Roberta will

749
00:38:22,949 --> 00:38:27,390
present this project and tell you more

750
00:38:24,900 --> 00:38:31,489
about it but just it's worth to mention

751
00:38:27,390 --> 00:38:34,549
that there is something to see to just

752
00:38:31,489 --> 00:38:37,049
check how it works and why it is

753
00:38:34,549 --> 00:38:39,359
important handy useful and everything

754
00:38:37,049 --> 00:38:43,349
else alright

755
00:38:39,359 --> 00:38:46,558
I think summarizes stuff first of all we

756
00:38:43,349 --> 00:38:49,799
had if he expected process which are

757
00:38:46,559 --> 00:38:53,160
working with text files not working with

758
00:38:49,799 --> 00:38:57,150
web which is my end goal so basically we

759
00:38:53,160 --> 00:38:59,549
now use our favorite IDE or do bulk

760
00:38:57,150 --> 00:39:04,140
changes using bash or Python or anything

761
00:38:59,549 --> 00:39:07,380
we want use git flow CI and everything

762
00:39:04,140 --> 00:39:10,078
to you know just just for like for

763
00:39:07,380 --> 00:39:12,599
general programming or development use

764
00:39:10,079 --> 00:39:15,299
the merge requests push requests and

765
00:39:12,599 --> 00:39:17,400
everything and to check new

766
00:39:15,299 --> 00:39:21,179
contributions for other team members or

767
00:39:17,400 --> 00:39:24,029
from other even teams like if cm guys

768
00:39:21,179 --> 00:39:26,819
want to add some information no problems

769
00:39:24,029 --> 00:39:29,369
use git flow will review your stuff and

770
00:39:26,819 --> 00:39:30,959
merge it if it's ok or provide v's

771
00:39:29,369 --> 00:39:32,759
information about you supposed to change

772
00:39:30,959 --> 00:39:37,439
which is quite handy so basically it's

773
00:39:32,759 --> 00:39:40,949
some sort of analytics as a code not

774
00:39:37,439 --> 00:39:44,189
automation we don't do almost like

775
00:39:40,949 --> 00:39:46,319
anything manually not nothing manually

776
00:39:44,189 --> 00:39:48,509
we don't do mapping inside confluence we

777
00:39:46,319 --> 00:39:51,150
don't do we don't support these three

778
00:39:48,509 --> 00:39:52,709
girls in the conference we don't support

779
00:39:51,150 --> 00:39:56,269
detection logic and the confluence

780
00:39:52,709 --> 00:40:00,569
basically everything generated by itself

781
00:39:56,269 --> 00:40:03,629
and everybody has all the time the

782
00:40:00,569 --> 00:40:05,819
actual information so which is like just

783
00:40:03,630 --> 00:40:08,519
great for now we work only on meaningful

784
00:40:05,819 --> 00:40:12,058
data doing research doing development

785
00:40:08,519 --> 00:40:13,950
and the rest is automated so it's just

786
00:40:12,059 --> 00:40:18,270
fine

787
00:40:13,950 --> 00:40:20,210
at the same time our data is compatible

788
00:40:18,270 --> 00:40:22,700
with community projects like Sigma

789
00:40:20,210 --> 00:40:25,829
atomic ransom so basically we can just

790
00:40:22,700 --> 00:40:28,710
do git pull pull data from their project

791
00:40:25,829 --> 00:40:30,270
and automatically natively integrated to

792
00:40:28,710 --> 00:40:33,780
our environment which is also just great

793
00:40:30,270 --> 00:40:35,549
I have to speed up see there are a few

794
00:40:33,780 --> 00:40:37,740
expected pros first of all

795
00:40:35,549 --> 00:40:40,170
visualizations of existing on Linux as I

796
00:40:37,740 --> 00:40:42,750
said we started with generating of

797
00:40:40,170 --> 00:40:45,089
analytic CSV files but then we realize

798
00:40:42,750 --> 00:40:47,099
that why don't we generate elastic

799
00:40:45,089 --> 00:40:50,339
search index analyze all the stuff

800
00:40:47,099 --> 00:40:53,250
inside Cubana we just did and you saw

801
00:40:50,339 --> 00:40:55,740
what was the result so for now cm team

802
00:40:53,250 --> 00:40:58,170
has their own dashboard to track

803
00:40:55,740 --> 00:40:59,779
implementation like they see how many

804
00:40:58,170 --> 00:41:02,520
detection rules they can implement and

805
00:40:59,780 --> 00:41:04,230
there is at least what kind of logging

806
00:41:02,520 --> 00:41:06,780
policies the data in the date should

807
00:41:04,230 --> 00:41:08,760
collect and everything at the same time

808
00:41:06,780 --> 00:41:09,809
our leadership has their own dashboard

809
00:41:08,760 --> 00:41:11,490
where they see how we're progressing

810
00:41:09,809 --> 00:41:14,880
like how many detection rules will be

811
00:41:11,490 --> 00:41:17,430
implemented how many how they were

812
00:41:14,880 --> 00:41:21,270
changing this time and everything like

813
00:41:17,430 --> 00:41:24,540
that at the same time it's all automated

814
00:41:21,270 --> 00:41:27,960
automatically sorry such a horrible

815
00:41:24,540 --> 00:41:29,759
thing updated automatically just we

816
00:41:27,960 --> 00:41:32,420
updated something like new deduction

817
00:41:29,760 --> 00:41:36,270
rules added something or updated conf

818
00:41:32,420 --> 00:41:38,490
customer entity executed make and all

819
00:41:36,270 --> 00:41:42,030
the information were pushed to all

820
00:41:38,490 --> 00:41:43,589
kibana duck navigator everywhere

821
00:41:42,030 --> 00:41:45,680
basically everywhere so each time

822
00:41:43,589 --> 00:41:48,660
somebody opening this dashboard

823
00:41:45,680 --> 00:41:52,140
everything is brand new updated and

824
00:41:48,660 --> 00:41:56,460
actual alright I will skip this part

825
00:41:52,140 --> 00:42:01,069
last point and just jump into goals and

826
00:41:56,460 --> 00:42:04,200
plans first of all we want to simulate

827
00:42:01,069 --> 00:42:07,109
of atomic red team and Sigma projects

828
00:42:04,200 --> 00:42:10,710
format use it is obvious because more

829
00:42:07,109 --> 00:42:11,400
contributors they have more interesting

830
00:42:10,710 --> 00:42:13,589
and valuable

831
00:42:11,400 --> 00:42:15,960
analysis we can do and provide back to

832
00:42:13,589 --> 00:42:20,308
community at the same time we will have

833
00:42:15,960 --> 00:42:22,470
more interesting ideas analytics

834
00:42:20,309 --> 00:42:24,380
execution frameworks and converters

835
00:42:22,470 --> 00:42:27,149
which is also great

836
00:42:24,380 --> 00:42:27,690
another thing is utilization of my tree

837
00:42:27,150 --> 00:42:30,150
attack

838
00:42:27,690 --> 00:42:32,670
I believe we all community are as a

839
00:42:30,150 --> 00:42:34,829
community need more projects with Maya

840
00:42:32,670 --> 00:42:38,640
attacked Agins in first example of such

841
00:42:34,829 --> 00:42:40,380
project is Metasploit just imagine what

842
00:42:38,640 --> 00:42:42,598
will happen if we will attack all the

843
00:42:40,380 --> 00:42:44,640
post exploitation modules of Metasploit

844
00:42:42,599 --> 00:42:45,780
there are basically more than three

845
00:42:44,640 --> 00:42:48,980
hundreds of them

846
00:42:45,780 --> 00:42:52,589
we will dramatically increase our

847
00:42:48,980 --> 00:42:54,420
simulation testing ability another thing

848
00:42:52,589 --> 00:42:57,270
is that there is no project for

849
00:42:54,420 --> 00:42:59,310
automated hardening these mapping Tamiya

850
00:42:57,270 --> 00:43:02,900
attack there are lots of projects which

851
00:42:59,310 --> 00:43:04,890
do hardening do using ansible or other

852
00:43:02,900 --> 00:43:08,880
configuration management systems but

853
00:43:04,890 --> 00:43:10,618
none of them use my to attack attacks so

854
00:43:08,880 --> 00:43:13,440
we cannot implement it so if you guys

855
00:43:10,619 --> 00:43:15,589
were seeking for a project to do like

856
00:43:13,440 --> 00:43:18,900
next couple of months or maybe years

857
00:43:15,589 --> 00:43:20,578
it's a good one so you can find us we

858
00:43:18,900 --> 00:43:24,270
can discuss it may be provided with some

859
00:43:20,579 --> 00:43:27,420
help or you know advices anything you're

860
00:43:24,270 --> 00:43:32,369
welcome with that and last but not least

861
00:43:27,420 --> 00:43:34,890
this week in Brussels on e mitotic

862
00:43:32,369 --> 00:43:37,980
workshop we gonna present our definition

863
00:43:34,890 --> 00:43:40,710
of coverage / completeness of coverage

864
00:43:37,980 --> 00:43:45,119
for technique major attack technique we

865
00:43:40,710 --> 00:43:47,819
will discuss it with community and based

866
00:43:45,119 --> 00:43:50,599
on final let's say decision if I

867
00:43:47,819 --> 00:43:53,730
probably will initiate a few coordinated

868
00:43:50,599 --> 00:43:56,550
sprints working on some specific gaps we

869
00:43:53,730 --> 00:43:59,970
will identify together with the experts

870
00:43:56,550 --> 00:44:03,300
from the community all right thank you

871
00:43:59,970 --> 00:44:04,859
for your attention if you guys have any

872
00:44:03,300 --> 00:44:08,760
questions we would love to answer them

873
00:44:04,859 --> 00:44:11,130
but I see that time is just no thanks

874
00:44:08,760 --> 00:44:13,260
that new things but I was yeah we have

875
00:44:11,130 --> 00:44:15,270
we have a few minutes for the questions

876
00:44:13,260 --> 00:44:18,089
so if you have any question please raise

877
00:44:15,270 --> 00:44:25,730
your hand and we will provide you a

878
00:44:18,089 --> 00:44:25,730
microphone up there

879
00:44:29,060 --> 00:44:34,500
so I know you used to mention using the

880
00:44:31,950 --> 00:44:36,569
hive for your response framework

881
00:44:34,500 --> 00:44:38,070
have you do you know if anyone's been

882
00:44:36,570 --> 00:44:40,590
experimenting with using this with any

883
00:44:38,070 --> 00:44:43,560
of the other security automation

884
00:44:40,590 --> 00:44:45,510
platforms de misto phantom etc because

885
00:44:43,560 --> 00:44:49,110
it seems I'm really curious about how

886
00:44:45,510 --> 00:44:52,640
well we could get this in use by the

887
00:44:49,110 --> 00:44:57,510
commercial products as well mm-hmm

888
00:44:52,640 --> 00:45:02,790
we had the conversation in first TC in

889
00:44:57,510 --> 00:45:05,970
Amsterdam last month with guys from Palo

890
00:45:02,790 --> 00:45:08,550
Alto they just acquired the Mistah and

891
00:45:05,970 --> 00:45:10,200
one of them was exactly from the mr and

892
00:45:08,550 --> 00:45:14,010
they told me that they were also trying

893
00:45:10,200 --> 00:45:17,819
to implement like new playbook format

894
00:45:14,010 --> 00:45:23,130
but they were using JSON and there is

895
00:45:17,820 --> 00:45:27,330
idea to invent or I don't know proposed

896
00:45:23,130 --> 00:45:29,280
common format for play books which would

897
00:45:27,330 --> 00:45:31,110
be like human and machine readable we

898
00:45:29,280 --> 00:45:34,650
believe Yama is the best for that and

899
00:45:31,110 --> 00:45:38,130
our format is kind of a cage so there is

900
00:45:34,650 --> 00:45:41,940
an ongoing conversation about the common

901
00:45:38,130 --> 00:45:45,120
format for instant response platforms

902
00:45:41,940 --> 00:45:47,670
and maybe in the near future we will

903
00:45:45,120 --> 00:45:50,730
have something like common format which

904
00:45:47,670 --> 00:45:53,250
will be supported by most of at least

905
00:45:50,730 --> 00:45:57,060
instant response platforms and I cannot

906
00:45:53,250 --> 00:45:58,260
say anything more about other like EDRs

907
00:45:57,060 --> 00:46:09,540
or anything like this

908
00:45:58,260 --> 00:46:11,540
no information about it yeah guys you've

909
00:46:09,540 --> 00:46:14,790
solved I'm here thank you

910
00:46:11,540 --> 00:46:16,230
guys you've solved a lot of my questions

911
00:46:14,790 --> 00:46:19,190
that I had when I was working in a sock

912
00:46:16,230 --> 00:46:21,660
it's really impressive how do you handle

913
00:46:19,190 --> 00:46:24,180
say customers that have their own

914
00:46:21,660 --> 00:46:26,460
opinions how incidents should have been

915
00:46:24,180 --> 00:46:28,980
handled I mean are there like

916
00:46:26,460 --> 00:46:30,720
customizations for a given customer or

917
00:46:28,980 --> 00:46:32,370
do you kind of erase this format

918
00:46:30,720 --> 00:46:36,910
convincing enough for them to actually

919
00:46:32,370 --> 00:46:38,618
do it the right way well basically

920
00:46:36,910 --> 00:46:44,078
is a quite interesting question thank

921
00:46:38,619 --> 00:46:46,059
you for us like as a project issues like

922
00:46:44,079 --> 00:46:50,640
it flow and anything isn't a problem to

923
00:46:46,059 --> 00:46:54,279
create like fork their customer and

924
00:46:50,640 --> 00:46:55,960
basically that's how it works so we

925
00:46:54,279 --> 00:46:59,069
don't like to share information between

926
00:46:55,960 --> 00:47:01,210
customers and if they have some specific

927
00:46:59,069 --> 00:47:03,450
requirements it's not a problem to

928
00:47:01,210 --> 00:47:05,410
implement like response action

929
00:47:03,450 --> 00:47:07,629
specifically for the customer for

930
00:47:05,410 --> 00:47:10,930
customer environment and map them to

931
00:47:07,630 --> 00:47:16,109
playbook so it's it's just highly like

932
00:47:10,930 --> 00:47:16,109
very flexible no problems with that

933
00:47:27,000 --> 00:47:31,570
[Applause]

934
00:47:31,910 --> 00:47:33,970
you

