1
00:00:06,410 --> 00:00:09,459
[Music]

2
00:00:12,120 --> 00:00:16,128
[Applause]

3
00:00:13,360 --> 00:00:19,189
so yes this will<font color="#CCCCCC"> be a presentation about</font>

4
00:00:16,129 --> 00:00:21,079
<font color="#E5E5E5">the</font><font color="#CCCCCC"> box found</font><font color="#E5E5E5"> in the security solution</font>

5
00:00:19,189 --> 00:00:24,349
<font color="#CCCCCC">Enterprise great solution Enterprise</font>

6
00:00:21,079 --> 00:00:28,009
<font color="#E5E5E5">great solution the story how we did</font><font color="#CCCCCC"> root</font>

7
00:00:24,349 --> 00:00:30,649
it the second title<font color="#CCCCCC"> is</font><font color="#E5E5E5"> bugs are</font>

8
00:00:28,009 --> 00:00:32,628
everywhere and a quick question<font color="#CCCCCC"> what</font>

9
00:00:30,649 --> 00:00:34,840
happens when you<font color="#E5E5E5"> type in bugs are</font>

10
00:00:32,628 --> 00:00:40,910
everywhere into<font color="#E5E5E5"> the Google</font><font color="#CCCCCC"> image search</font>

11
00:00:34,840 --> 00:00:45,409
<font color="#CCCCCC">you get the box disclaimer so at</font><font color="#E5E5E5"> first</font>

12
00:00:40,910 --> 00:00:48,498
<font color="#E5E5E5">this the opinions expressed here are</font>

13
00:00:45,409 --> 00:00:50,210
<font color="#E5E5E5">only mine like if I'm saying that</font>

14
00:00:48,499 --> 00:00:50,989
somebody is<font color="#CCCCCC"> doing something</font><font color="#E5E5E5"> wrong this</font>

15
00:00:50,210 --> 00:00:56,050
is my opinion

16
00:00:50,989 --> 00:00:59,149
nobody else I know<font color="#E5E5E5"> impersonating anyone</font>

17
00:00:56,050 --> 00:01:02,870
<font color="#CCCCCC">second the presentation purpose</font><font color="#E5E5E5"> is just</font>

18
00:00:59,149 --> 00:01:06,260
to<font color="#E5E5E5"> educate everybody following slides of</font>

19
00:01:02,870 --> 00:01:09,289
there's a result of security research<font color="#E5E5E5"> of</font>

20
00:01:06,260 --> 00:01:12,110
course done by accident<font color="#CCCCCC"> by</font><font color="#E5E5E5"> but still</font><font color="#CCCCCC"> a</font>

21
00:01:09,290 --> 00:01:16,360
security research<font color="#E5E5E5"> no animals were harmed</font>

22
00:01:12,110 --> 00:01:19,220
and playing with malware is a bad idea

23
00:01:16,360 --> 00:01:21,440
<font color="#CCCCCC">basically Who am I I graduated physics</font>

24
00:01:19,220 --> 00:01:24,320
<font color="#CCCCCC">onwards of</font><font color="#E5E5E5"> University of Technology and</font>

25
00:01:21,440 --> 00:01:29,259
<font color="#E5E5E5">because of studying right there</font>

26
00:01:24,320 --> 00:01:32,479
I developed the curiosity how the things

27
00:01:29,260 --> 00:01:34,550
<font color="#CCCCCC">working out</font><font color="#E5E5E5"> the environment</font><font color="#CCCCCC"> the world is</font>

28
00:01:32,480 --> 00:01:38,210
is built and<font color="#E5E5E5"> the knowledge about the</font>

29
00:01:34,550 --> 00:01:40,520
universe<font color="#CCCCCC"> and</font><font color="#E5E5E5"> stuff like I know I did</font><font color="#CCCCCC"> the</font>

30
00:01:38,210 --> 00:01:43,880
answer<font color="#CCCCCC"> for everything is 42</font>

31
00:01:40,520 --> 00:01:46,940
later on working<font color="#E5E5E5"> seven years insert</font>

32
00:01:43,880 --> 00:01:49,250
<font color="#CCCCCC">polska allows me</font><font color="#E5E5E5"> allowed me to to</font>

33
00:01:46,940 --> 00:01:54,039
develop<font color="#E5E5E5"> skills and gain combat readiness</font>

34
00:01:49,250 --> 00:01:58,940
to analyze stuff to play with malware<font color="#CCCCCC"> I</font>

35
00:01:54,040 --> 00:02:01,430
was I had a<font color="#E5E5E5"> / to</font><font color="#CCCCCC"> natee to work with with</font>

36
00:01:58,940 --> 00:02:06,500
a lot of<font color="#E5E5E5"> great people some of them are</font>

37
00:02:01,430 --> 00:02:11,780
<font color="#E5E5E5">here here yes someone with some of them</font>

38
00:02:06,500 --> 00:02:13,640
I'm<font color="#E5E5E5"> still working in my new job so I'm</font>

39
00:02:11,780 --> 00:02:19,250
still trying to<font color="#E5E5E5"> fly with dragons dragon</font>

40
00:02:13,640 --> 00:02:22,369
sectors CTF team and now<font color="#E5E5E5"> now I'm working</font>

41
00:02:19,250 --> 00:02:23,180
in the corporate<font color="#E5E5E5"> environment and having</font>

42
00:02:22,370 --> 00:02:28,370
<font color="#E5E5E5">fun</font>

43
00:02:23,180 --> 00:02:31,849
corporate way still<font color="#E5E5E5"> so who are you is</font>

44
00:02:28,370 --> 00:02:34,760
there<font color="#E5E5E5"> any security that guy here girls</font>

45
00:02:31,849 --> 00:02:36,649
<font color="#CCCCCC">or bug hunters</font><font color="#E5E5E5"> because part of</font><font color="#CCCCCC"> this</font>

46
00:02:34,760 --> 00:02:39,530
<font color="#CCCCCC">presentation is</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> bug hunters any bug</font>

47
00:02:36,650 --> 00:02:42,920
hunters people who hunting bugs<font color="#CCCCCC"> day by</font>

48
00:02:39,530 --> 00:02:45,980
<font color="#E5E5E5">day earning money for bread doing that</font>

49
00:02:42,920 --> 00:02:50,689
<font color="#CCCCCC">ok so first</font><font color="#E5E5E5"> of all it happens to</font>

50
00:02:45,980 --> 00:02:53,959
everybody<font color="#E5E5E5"> everyone when when you create</font>

51
00:02:50,689 --> 00:02:58,250
a piece of code yourself<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> a human</font>

52
00:02:53,959 --> 00:03:00,560
<font color="#E5E5E5">is creating a piece of code</font><font color="#CCCCCC"> you will</font>

53
00:02:58,250 --> 00:03:04,780
<font color="#E5E5E5">create a box because this is the</font>

54
00:03:00,560 --> 00:03:08,120
byproduct<font color="#E5E5E5"> of being a human big examples</font>

55
00:03:04,780 --> 00:03:10,810
<font color="#E5E5E5">f5</font><font color="#CCCCCC"> this is something if you if you have</font>

56
00:03:08,120 --> 00:03:14,269
<font color="#CCCCCC">enterprise-grade</font>

57
00:03:10,810 --> 00:03:18,769
servers<font color="#E5E5E5"> you need to route</font><font color="#CCCCCC"> your HTTP</font>

58
00:03:14,269 --> 00:03:24,139
traffic<font color="#E5E5E5"> and probably are using a 5 if</font><font color="#CCCCCC"> 52</font>

59
00:03:18,769 --> 00:03:26,780
<font color="#CCCCCC">CD in and last year 11 this year so they</font>

60
00:03:24,139 --> 00:03:30,560
have<font color="#CCCCCC"> barracks Microsoft a very good</font>

61
00:03:26,780 --> 00:03:32,359
example like even since<font color="#CCCCCC"> they are they</font>

62
00:03:30,560 --> 00:03:34,400
started to developing operating systems

63
00:03:32,359 --> 00:03:36,560
<font color="#E5E5E5">they implement bucks right there</font>

64
00:03:34,400 --> 00:03:40,909
maybe for fun<font color="#E5E5E5"> Adobe another great</font>

65
00:03:36,560 --> 00:03:44,389
example probably they had a lot<font color="#CCCCCC"> of fun</font>

66
00:03:40,909 --> 00:03:48,679
implementing their<font color="#E5E5E5"> own standards</font><font color="#CCCCCC"> anti</font>

67
00:03:44,389 --> 00:03:52,459
<font color="#CCCCCC">viruses Symantec McAfee Trend Micro you</font>

68
00:03:48,680 --> 00:03:58,879
just can try to<font color="#E5E5E5"> Google exploits for</font>

69
00:03:52,459 --> 00:04:00,829
<font color="#CCCCCC">antivirus 22</font><font color="#E5E5E5"> 2017 CPU manufactures so</font>

70
00:03:58,879 --> 00:04:04,849
this year this year<font color="#E5E5E5"> we we learned that</font>

71
00:04:00,829 --> 00:04:07,280
you can have a bug in a<font color="#E5E5E5"> CPU so probably</font>

72
00:04:04,849 --> 00:04:11,780
somebody<font color="#E5E5E5"> who is designing those tiny</font>

73
00:04:07,280 --> 00:04:14,870
copper wires<font color="#E5E5E5"> did did the job wrong so</font>

74
00:04:11,780 --> 00:04:17,289
and<font color="#E5E5E5"> you can try to patch it using</font>

75
00:04:14,870 --> 00:04:20,930
software but still the<font color="#CCCCCC"> back is inside</font>

76
00:04:17,289 --> 00:04:23,750
<font color="#E5E5E5">inside the the great plan of of the CPU</font>

77
00:04:20,930 --> 00:04:28,300
like millions trillions of wires<font color="#E5E5E5"> and</font>

78
00:04:23,750 --> 00:04:31,550
<font color="#E5E5E5">some of them are then in the wrong way</font>

79
00:04:28,300 --> 00:04:34,279
<font color="#E5E5E5">if I'm correct today</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> be another</font>

80
00:04:31,550 --> 00:04:36,150
release of the CPU<font color="#E5E5E5"> box six or seven of</font>

81
00:04:34,279 --> 00:04:40,060
<font color="#E5E5E5">them</font>

82
00:04:36,150 --> 00:04:42,120
<font color="#E5E5E5">nice okay so but okay tomorrow we'll</font>

83
00:04:40,060 --> 00:04:45,130
have fun

84
00:04:42,120 --> 00:04:46,900
what about<font color="#E5E5E5"> us what</font><font color="#CCCCCC"> about my company</font><font color="#E5E5E5"> my</font>

85
00:04:45,130 --> 00:04:49,420
bank<font color="#CCCCCC"> I'm working the bank do we have a</font>

86
00:04:46,900 --> 00:04:51,729
box<font color="#CCCCCC"> do we</font><font color="#E5E5E5"> have a box in my coat okay</font><font color="#CCCCCC"> of</font>

87
00:04:49,420 --> 00:04:55,260
<font color="#CCCCCC">course the internet will say new banks</font>

88
00:04:51,730 --> 00:04:57,940
are safe but try to<font color="#CCCCCC"> google for it</font>

89
00:04:55,260 --> 00:05:00,820
somebody found<font color="#E5E5E5"> the back but we fix it in</font>

90
00:04:57,940 --> 00:05:04,090
20 in 72<font color="#CCCCCC"> hours</font><font color="#E5E5E5"> I'm very proud of that</font>

91
00:05:00,820 --> 00:05:07,090
<font color="#E5E5E5">because we managed to in the 72 hours we</font>

92
00:05:04,090 --> 00:05:13,030
managed<font color="#E5E5E5"> to identify identify the back</font>

93
00:05:07,090 --> 00:05:15,580
put it through the fix<font color="#E5E5E5"> through the chain</font>

94
00:05:13,030 --> 00:05:17,229
so in the environment<font color="#CCCCCC"> UAT environment</font>

95
00:05:15,580 --> 00:05:19,690
quality<font color="#E5E5E5"> environment production</font>

96
00:05:17,230 --> 00:05:23,110
environment and do the analysis if there

97
00:05:19,690 --> 00:05:26,590
are any victims<font color="#E5E5E5"> so if somebody</font><font color="#CCCCCC"> abused</font>

98
00:05:23,110 --> 00:05:28,690
this back<font color="#E5E5E5"> and everything was done in 72</font>

99
00:05:26,590 --> 00:05:32,609
<font color="#CCCCCC">hours so it</font><font color="#E5E5E5"> is doable in the big</font>

100
00:05:28,690 --> 00:05:37,840
corporate concrete environment

101
00:05:32,610 --> 00:05:40,750
motivation<font color="#CCCCCC"> bugs are often not funny some</font>

102
00:05:37,840 --> 00:05:43,900
some are<font color="#E5E5E5"> funny like vulnerabilities in</font>

103
00:05:40,750 --> 00:05:45,910
<font color="#E5E5E5">WordPress are funny</font><font color="#CCCCCC"> especially those</font>

104
00:05:43,900 --> 00:05:50,229
bugs in security solutions are not funny

105
00:05:45,910 --> 00:05:53,050
because because what<font color="#E5E5E5"> is</font><font color="#CCCCCC"> wars</font><font color="#E5E5E5"> then lack</font>

106
00:05:50,229 --> 00:05:55,450
of security<font color="#E5E5E5"> the false sense of security</font>

107
00:05:53,050 --> 00:05:58,900
<font color="#E5E5E5">so you think</font><font color="#CCCCCC"> you are safe</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> you</font>

108
00:05:55,450 --> 00:06:01,659
have<font color="#CCCCCC"> fireEye Kaspersky whatever put put</font>

109
00:05:58,900 --> 00:06:04,270
any name there so we are<font color="#CCCCCC"> safe because</font>

110
00:06:01,660 --> 00:06:08,470
look half of the rack is filled with

111
00:06:04,270 --> 00:06:10,479
security solutions the product what I

112
00:06:08,470 --> 00:06:14,530
will<font color="#CCCCCC"> talking what I will be talking</font>

113
00:06:10,479 --> 00:06:20,919
about<font color="#E5E5E5"> first point bundle so called web</font>

114
00:06:14,530 --> 00:06:25,960
sense<font color="#CCCCCC"> this is group of security products</font>

115
00:06:20,919 --> 00:06:27,460
the<font color="#E5E5E5"> first we have a email gateway so the</font>

116
00:06:25,960 --> 00:06:30,930
product that is filtering<font color="#E5E5E5"> your emails</font>

117
00:06:27,460 --> 00:06:34,840
but<font color="#E5E5E5"> going in</font><font color="#CCCCCC"> going out web gateway so</font>

118
00:06:30,930 --> 00:06:37,930
HTTP proxy able to do a content

119
00:06:34,840 --> 00:06:40,539
filtering SSL stripping<font color="#CCCCCC"> and of course we</font>

120
00:06:37,930 --> 00:06:43,750
cannot DLP to everything<font color="#E5E5E5"> so it looks</font>

121
00:06:40,540 --> 00:06:45,910
quite<font color="#E5E5E5"> this indecent</font><font color="#CCCCCC"> I do like that</font>

122
00:06:43,750 --> 00:06:47,770
<font color="#E5E5E5">partially because you have everything</font>

123
00:06:45,910 --> 00:06:48,970
integrated<font color="#E5E5E5"> into one piece like you don't</font>

124
00:06:47,770 --> 00:06:51,640
need<font color="#E5E5E5"> to write</font>

125
00:06:48,970 --> 00:06:54,160
emails<font color="#E5E5E5"> outgoing emails incoming emails</font>

126
00:06:51,640 --> 00:06:57,760
and web filtering<font color="#E5E5E5"> and if you separate</font>

127
00:06:54,160 --> 00:07:01,270
places<font color="#CCCCCC"> you can do</font><font color="#E5E5E5"> it once</font><font color="#CCCCCC"> the process of</font>

128
00:06:57,760 --> 00:07:04,870
<font color="#CCCCCC">reporting</font><font color="#E5E5E5"> this is quite important part</font>

129
00:07:01,270 --> 00:07:07,630
because<font color="#E5E5E5"> I am was not quite confident</font>

130
00:07:04,870 --> 00:07:10,810
about this process<font color="#CCCCCC"> so we managed</font><font color="#E5E5E5"> to</font>

131
00:07:07,630 --> 00:07:14,800
<font color="#E5E5E5">break version disclaimer number two we</font>

132
00:07:10,810 --> 00:07:17,680
managed to<font color="#E5E5E5"> break version</font><font color="#CCCCCC"> oh 8.1</font><font color="#E5E5E5"> and now</font>

133
00:07:14,800 --> 00:07:22,110
there is<font color="#CCCCCC"> eight point five on the market</font>

134
00:07:17,680 --> 00:07:24,910
<font color="#E5E5E5">so they did release</font><font color="#CCCCCC"> a few in this time</font>

135
00:07:22,110 --> 00:07:29,860
<font color="#E5E5E5">but still during the process of</font>

136
00:07:24,910 --> 00:07:35,110
reporting which was September the this

137
00:07:29,860 --> 00:07:37,360
<font color="#CCCCCC">version 0.1 was supported what did we</font>

138
00:07:35,110 --> 00:07:41,070
report we<font color="#CCCCCC"> sent them a five PDFs</font>

139
00:07:37,360 --> 00:07:44,050
containing bugs about Pam<font color="#E5E5E5"> Web Gateway</font>

140
00:07:41,070 --> 00:07:46,659
<font color="#CCCCCC">admin interface mail gateway in general</font>

141
00:07:44,050 --> 00:07:48,490
<font color="#E5E5E5">back bad practices</font><font color="#CCCCCC"> I will not talk</font><font color="#E5E5E5"> about</font>

142
00:07:46,660 --> 00:07:50,800
the general<font color="#E5E5E5"> but practices because this</font>

143
00:07:48,490 --> 00:07:52,930
is like standards<font color="#E5E5E5"> are like do not do not</font>

144
00:07:50,800 --> 00:07:57,760
<font color="#E5E5E5">hurt code passwords</font><font color="#CCCCCC"> interior code they</font>

145
00:07:52,930 --> 00:08:03,760
do they did<font color="#E5E5E5"> use modern cryptography they</font>

146
00:07:57,760 --> 00:08:07,450
use death<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know but I will try to</font>

147
00:08:03,760 --> 00:08:09,750
talk about<font color="#CCCCCC"> those</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> we reported</font>

148
00:08:07,450 --> 00:08:12,130
<font color="#E5E5E5">that we send them those</font><font color="#CCCCCC"> PDFs at</font>

149
00:08:09,750 --> 00:08:15,820
September at the<font color="#E5E5E5"> north end of September</font>

150
00:08:12,130 --> 00:08:19,510
<font color="#CCCCCC">and we clearly mentioned that we will</font>

151
00:08:15,820 --> 00:08:23,050
disclose that<font color="#CCCCCC"> this cost that</font><font color="#E5E5E5"> after 90</font>

152
00:08:19,510 --> 00:08:25,539
days<font color="#E5E5E5"> or</font><font color="#CCCCCC"> longer I consult</font><font color="#E5E5E5"> about those 90</font>

153
00:08:23,050 --> 00:08:27,970
days<font color="#E5E5E5"> with my friends for</font><font color="#CCCCCC"> example for</font>

154
00:08:25,540 --> 00:08:29,860
<font color="#E5E5E5">Google</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> I thought</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> those guys</font>

155
00:08:27,970 --> 00:08:31,660
are reporting a lot<font color="#E5E5E5"> of stuff</font><font color="#CCCCCC"> so probably</font>

156
00:08:29,860 --> 00:08:35,979
can tell<font color="#E5E5E5"> share with me our</font><font color="#CCCCCC"> experience</font>

157
00:08:31,660 --> 00:08:40,200
<font color="#CCCCCC">okay should I put</font><font color="#E5E5E5"> the 90 days so this is</font>

158
00:08:35,979 --> 00:08:40,200
like not a random<font color="#E5E5E5"> decision of ours</font>

159
00:08:40,229 --> 00:08:44,110
<font color="#CCCCCC">immediately</font><font color="#E5E5E5"> immediately the same day we</font>

160
00:08:42,669 --> 00:08:47,620
got<font color="#CCCCCC"> acknowledged</font><font color="#E5E5E5"> okay thank you for a</font>

161
00:08:44,110 --> 00:08:51,220
report<font color="#CCCCCC"> we'll contact you later</font><font color="#E5E5E5"> few</font>

162
00:08:47,620 --> 00:08:53,560
<font color="#E5E5E5">months later at end of December we still</font>

163
00:08:51,220 --> 00:08:58,089
didn't receive a clear acknowledgment

164
00:08:53,560 --> 00:09:00,430
that<font color="#CCCCCC"> ok we receive your email we test</font>

165
00:08:58,089 --> 00:09:02,890
<font color="#E5E5E5">out tests all the</font><font color="#CCCCCC"> vulnerabilities that</font>

166
00:09:00,430 --> 00:09:05,170
<font color="#E5E5E5">you mentioned and we confirmed</font>

167
00:09:02,890 --> 00:09:12,130
I don't know there<font color="#CCCCCC"> is only</font><font color="#E5E5E5"> one that is</font>

168
00:09:05,170 --> 00:09:14,439
still exploitable<font color="#E5E5E5"> and we to be honest we</font>

169
00:09:12,130 --> 00:09:16,689
didn't receive<font color="#E5E5E5"> any any exact information</font>

170
00:09:14,440 --> 00:09:18,550
<font color="#E5E5E5">what they are planning to do</font><font color="#CCCCCC"> we are</font>

171
00:09:16,690 --> 00:09:21,640
<font color="#E5E5E5">planning</font><font color="#CCCCCC"> to do planning I don't know</font><font color="#E5E5E5"> em</font>

172
00:09:18,550 --> 00:09:25,959
notified the customers<font color="#E5E5E5"> release</font><font color="#CCCCCC"> fixed did</font>

173
00:09:21,640 --> 00:09:27,819
fix it<font color="#E5E5E5"> in a new version one of</font><font color="#CCCCCC"> the</font>

174
00:09:25,960 --> 00:09:31,030
<font color="#E5E5E5">things they receive</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you can try</font><font color="#CCCCCC"> to</font>

175
00:09:27,820 --> 00:09:34,420
retest it in new version<font color="#E5E5E5"> okay so I am as</font>

176
00:09:31,030 --> 00:09:37,510
a customer as a researcher I'm allowed

177
00:09:34,420 --> 00:09:39,939
to to test<font color="#E5E5E5"> a new version and inform them</font>

178
00:09:37,510 --> 00:09:46,810
if<font color="#CCCCCC"> their new version is still</font><font color="#E5E5E5"> burnable</font>

179
00:09:39,940 --> 00:09:49,890
so for me quite misunderstanding<font color="#E5E5E5"> luckily</font>

180
00:09:46,810 --> 00:09:53,619
after<font color="#E5E5E5"> few escalations</font><font color="#CCCCCC"> at the end of the</font>

181
00:09:49,890 --> 00:09:56,560
<font color="#CCCCCC">january</font><font color="#E5E5E5"> we received a list of identified</font>

182
00:09:53,620 --> 00:09:59,530
vulnerabilities<font color="#E5E5E5"> 12</font><font color="#CCCCCC"> items they sent at</font><font color="#E5E5E5"> 12</font>

183
00:09:56,560 --> 00:10:02,979
items that we do<font color="#E5E5E5"> is acknowledge that we</font>

184
00:09:59,530 --> 00:10:07,660
received those<font color="#CCCCCC"> twelve items</font><font color="#E5E5E5"> nevertheless</font>

185
00:10:02,980 --> 00:10:10,990
a lot of answered questions and hurt

186
00:10:07,660 --> 00:10:13,120
<font color="#E5E5E5">feelings to the process but go let's go</font>

187
00:10:10,990 --> 00:10:16,000
to the<font color="#E5E5E5"> box the box</font>

188
00:10:13,120 --> 00:10:18,850
first the trivial one the<font color="#E5E5E5"> Triton</font><font color="#CCCCCC"> the</font>

189
00:10:16,000 --> 00:10:20,860
<font color="#E5E5E5">Triton is the part of this bundle that</font>

190
00:10:18,850 --> 00:10:23,950
is used to<font color="#E5E5E5"> manage or the components so</font>

191
00:10:20,860 --> 00:10:26,980
you<font color="#E5E5E5"> can do the admin clicking here so I</font>

192
00:10:23,950 --> 00:10:30,310
want to<font color="#E5E5E5"> block emails containing</font><font color="#CCCCCC"> viagra</font>

193
00:10:26,980 --> 00:10:32,050
<font color="#E5E5E5">apply it is sent to your infrastructure</font>

194
00:10:30,310 --> 00:10:35,560
<font color="#E5E5E5">and the emails containing viagra are</font>

195
00:10:32,050 --> 00:10:40,270
blocked<font color="#CCCCCC"> if you have a new appliance so</font>

196
00:10:35,560 --> 00:10:43,540
you ship<font color="#E5E5E5"> new for you server into the</font>

197
00:10:40,270 --> 00:10:45,850
rock and<font color="#E5E5E5"> you want to add it</font><font color="#CCCCCC"> to this your</font>

198
00:10:43,540 --> 00:10:49,209
existing cluster you can do it here like

199
00:10:45,850 --> 00:10:52,480
add another server<font color="#CCCCCC"> you're typing the IP</font>

200
00:10:49,210 --> 00:10:55,420
address of<font color="#E5E5E5"> the server you're typing the</font>

201
00:10:52,480 --> 00:10:57,490
username the<font color="#CCCCCC"> password</font><font color="#E5E5E5"> and out of</font>

202
00:10:55,420 --> 00:11:01,319
<font color="#E5E5E5">curiosity</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but what happened when I</font>

203
00:10:57,490 --> 00:11:01,320
type in<font color="#E5E5E5"> the backtick in the username</font>

204
00:11:02,740 --> 00:11:09,490
after visiting the<font color="#E5E5E5"> server server</font>

205
00:11:05,260 --> 00:11:13,810
<font color="#E5E5E5">sleeping for 60 seconds so maybe not</font>

206
00:11:09,490 --> 00:11:16,300
something<font color="#E5E5E5"> awesome but this should</font><font color="#CCCCCC"> not</font>

207
00:11:13,810 --> 00:11:16,780
happen<font color="#E5E5E5"> especially</font><font color="#CCCCCC"> that it is visible</font>

208
00:11:16,300 --> 00:11:19,060
<font color="#CCCCCC">that</font>

209
00:11:16,780 --> 00:11:21,610
passing this parameter<font color="#CCCCCC"> unsanitized</font>

210
00:11:19,060 --> 00:11:25,709
multiple times so the server was

211
00:11:21,610 --> 00:11:28,540
freezing<font color="#E5E5E5"> for six</font><font color="#CCCCCC"> 220 seconds</font><font color="#E5E5E5"> or more</font>

212
00:11:25,710 --> 00:11:30,460
<font color="#E5E5E5">okay but they said okay this is lame</font>

213
00:11:28,540 --> 00:11:33,339
<font color="#CCCCCC">because you already</font><font color="#E5E5E5"> have the admin to</font>

214
00:11:30,460 --> 00:11:37,920
this Triton stuff so you're injecting

215
00:11:33,340 --> 00:11:40,840
common as<font color="#E5E5E5"> admin everybody can do that</font>

216
00:11:37,920 --> 00:11:44,079
another part the personal immigrant

217
00:11:40,840 --> 00:11:45,940
manager<font color="#CCCCCC"> so</font><font color="#E5E5E5"> called Pam is this is the</font>

218
00:11:44,080 --> 00:11:48,280
marketing<font color="#E5E5E5"> from the PDF from the</font>

219
00:11:45,940 --> 00:11:51,310
<font color="#E5E5E5">vendor</font><font color="#CCCCCC"> basically this</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> quarantine</font>

220
00:11:48,280 --> 00:11:54,430
<font color="#CCCCCC">for the emails</font><font color="#E5E5E5"> so if the email gateways</font>

221
00:11:51,310 --> 00:11:56,949
<font color="#E5E5E5">will classify something as a malicious</font>

222
00:11:54,430 --> 00:11:58,810
spam suspicious or something<font color="#E5E5E5"> it is</font>

223
00:11:56,950 --> 00:12:02,020
putting the email to the quarantine<font color="#CCCCCC"> and</font>

224
00:11:58,810 --> 00:12:05,650
later user can browse the quarantine<font color="#E5E5E5"> and</font>

225
00:12:02,020 --> 00:12:08,500
<font color="#E5E5E5">see what kind what kind</font><font color="#CCCCCC"> of emails</font><font color="#E5E5E5"> are</font>

226
00:12:05,650 --> 00:12:10,900
were blocked<font color="#E5E5E5"> for example if</font><font color="#CCCCCC"> a very</font>

227
00:12:08,500 --> 00:12:14,410
important block<font color="#E5E5E5"> email from CEO was</font>

228
00:12:10,900 --> 00:12:19,689
blocked<font color="#E5E5E5"> it can be released all delivered</font>

229
00:12:14,410 --> 00:12:21,339
to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> inbox so this is how it looks</font><font color="#CCCCCC"> you</font>

230
00:12:19,690 --> 00:12:25,350
see that there<font color="#E5E5E5"> is a list of messages</font>

231
00:12:21,339 --> 00:12:29,680
<font color="#CCCCCC">nothing special</font><font color="#E5E5E5"> this is the preview of</font>

232
00:12:25,350 --> 00:12:33,610
<font color="#E5E5E5">email sent we see that we have headers</font>

233
00:12:29,680 --> 00:12:35,770
content nothing special still what<font color="#E5E5E5"> about</font>

234
00:12:33,610 --> 00:12:40,470
the features one of<font color="#E5E5E5"> the features</font><font color="#CCCCCC"> you can</font>

235
00:12:35,770 --> 00:12:44,380
<font color="#E5E5E5">view the blocked email content and this</font>

236
00:12:40,470 --> 00:12:46,839
this<font color="#E5E5E5"> point my attention because you are</font>

237
00:12:44,380 --> 00:12:48,760
<font color="#CCCCCC">viewing</font><font color="#E5E5E5"> a content of the email that</font><font color="#CCCCCC"> was</font>

238
00:12:46,839 --> 00:12:54,570
classified as possible potentially

239
00:12:48,760 --> 00:12:58,660
malicious<font color="#E5E5E5"> okay keep going</font><font color="#CCCCCC"> you're viewing</font>

240
00:12:54,570 --> 00:13:01,600
content<font color="#E5E5E5"> of email in HTML okay why do you</font>

241
00:12:58,660 --> 00:13:04,630
why do you<font color="#E5E5E5"> even try to render</font>

242
00:13:01,600 --> 00:13:06,730
<font color="#E5E5E5">potentially malicious emails in real</font>

243
00:13:04,630 --> 00:13:12,700
HTML because<font color="#E5E5E5"> you're not in Outlook here</font>

244
00:13:06,730 --> 00:13:14,890
<font color="#E5E5E5">in browser</font><font color="#CCCCCC"> about the</font><font color="#E5E5E5"> bug we found in</font><font color="#CCCCCC"> pam</font>

245
00:13:12,700 --> 00:13:15,580
web interface when the email content is

246
00:13:14,890 --> 00:13:18,370
displayed

247
00:13:15,580 --> 00:13:22,630
<font color="#E5E5E5">there's no literally no limit even</font>

248
00:13:18,370 --> 00:13:25,570
<font color="#CCCCCC">Outlook is is more restricted</font><font color="#E5E5E5"> more</font>

249
00:13:22,630 --> 00:13:28,290
restricted in<font color="#CCCCCC"> a way that of rendering</font>

250
00:13:25,570 --> 00:13:31,050
HTML<font color="#E5E5E5"> running JavaScript</font>

251
00:13:28,290 --> 00:13:34,800
<font color="#E5E5E5">what is funny you</font><font color="#CCCCCC"> can craft the email</font>

252
00:13:31,050 --> 00:13:36,930
that will click deliver myself<font color="#CCCCCC"> when</font>

253
00:13:34,800 --> 00:13:40,949
viewing the<font color="#CCCCCC"> email when you are</font><font color="#E5E5E5"> viewing</font>

254
00:13:36,930 --> 00:13:43,620
the<font color="#E5E5E5"> victim is viewing the email and one</font>

255
00:13:40,949 --> 00:13:46,529
thing<font color="#E5E5E5"> the security policy of the browser</font>

256
00:13:43,620 --> 00:13:49,019
<font color="#CCCCCC">made</font><font color="#E5E5E5"> may be less restrictive</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> the</font>

257
00:13:46,529 --> 00:13:51,449
<font color="#CCCCCC">PAMP this web interface is served</font><font color="#E5E5E5"> from</font>

258
00:13:49,019 --> 00:13:53,579
<font color="#CCCCCC">the</font><font color="#E5E5E5"> intranet so</font><font color="#CCCCCC"> already managed to</font>

259
00:13:51,449 --> 00:13:55,979
bypass<font color="#E5E5E5"> those all those firewalls proxy</font>

260
00:13:53,579 --> 00:13:58,888
servers<font color="#E5E5E5"> and stuff that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> filtering the</font>

261
00:13:55,980 --> 00:14:00,870
malicious traffic<font color="#E5E5E5"> you just deliver and</font>

262
00:13:58,889 --> 00:14:02,910
render<font color="#CCCCCC"> it in the euros are browsing</font><font color="#E5E5E5"> the</font>

263
00:14:00,870 --> 00:14:06,779
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> and but there is a one</font>

264
00:14:02,910 --> 00:14:10,079
<font color="#E5E5E5">condition your email need to be</font>

265
00:14:06,779 --> 00:14:15,060
<font color="#E5E5E5">classified as</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> spam</font><font color="#CCCCCC"> or malicious</font><font color="#E5E5E5"> how</font>

266
00:14:10,079 --> 00:14:18,239
<font color="#E5E5E5">would you do it</font><font color="#CCCCCC"> I just put a lot of</font>

267
00:14:15,060 --> 00:14:20,399
penis<font color="#E5E5E5"> envy Agra into the in Maryland it</font>

268
00:14:18,240 --> 00:14:24,589
worked<font color="#CCCCCC"> every single image containing</font>

269
00:14:20,399 --> 00:14:29,910
<font color="#E5E5E5">this stuff is mark as spam</font>

270
00:14:24,589 --> 00:14:38,300
<font color="#CCCCCC">Pharmaceuticals</font><font color="#E5E5E5"> so let's let's</font><font color="#CCCCCC"> look for</font>

271
00:14:29,910 --> 00:14:43,050
example blurry<font color="#E5E5E5"> so we have we have a</font>

272
00:14:38,300 --> 00:14:45,209
email content with URL<font color="#E5E5E5"> image loaded from</font>

273
00:14:43,050 --> 00:14:46,829
<font color="#CCCCCC">the external</font><font color="#E5E5E5"> web page and the iframe</font>

274
00:14:45,209 --> 00:14:49,469
pointing to some<font color="#CCCCCC"> resource in the</font>

275
00:14:46,829 --> 00:14:53,489
<font color="#CCCCCC">Internet</font><font color="#E5E5E5"> we are sending that</font><font color="#CCCCCC"> disk is</font><font color="#E5E5E5"> how</font>

276
00:14:49,470 --> 00:14:55,500
it looks in<font color="#CCCCCC"> the in the pan so everything</font>

277
00:14:53,490 --> 00:14:58,709
<font color="#E5E5E5">was rendered the content was downloaded</font>

278
00:14:55,500 --> 00:15:01,430
of course we the user needed access<font color="#CCCCCC"> to</font>

279
00:14:58,709 --> 00:15:03,569
up outgoing traffic<font color="#E5E5E5"> but there was a</font>

280
00:15:01,430 --> 00:15:08,209
there<font color="#CCCCCC"> was an attempt to fetch the</font>

281
00:15:03,569 --> 00:15:11,699
content and in inside<font color="#E5E5E5"> the inside</font><font color="#CCCCCC"> the</font>

282
00:15:08,209 --> 00:15:15,768
source of the web page there<font color="#CCCCCC"> is a plain</font>

283
00:15:11,699 --> 00:15:19,859
HTML so you can do anything<font color="#E5E5E5"> for example</font>

284
00:15:15,769 --> 00:15:23,550
<font color="#E5E5E5">you can do a JavaScript injection</font><font color="#CCCCCC"> into</font>

285
00:15:19,860 --> 00:15:29,730
this in<font color="#E5E5E5"> the DS interface but ok XSS is</font>

286
00:15:23,550 --> 00:15:32,729
<font color="#E5E5E5">not fun let's go deeper how do you</font>

287
00:15:29,730 --> 00:15:35,339
handle the email with<font color="#E5E5E5"> attachment and the</font>

288
00:15:32,730 --> 00:15:38,310
attachment is the<font color="#E5E5E5"> graphic file that is a</font>

289
00:15:35,339 --> 00:15:40,860
render<font color="#CCCCCC"> inside the</font><font color="#E5E5E5"> email there anybody of</font>

290
00:15:38,310 --> 00:15:44,380
you knows how<font color="#CCCCCC"> to do it</font>

291
00:15:40,860 --> 00:15:46,839
so so we<font color="#CCCCCC"> can try to invent</font><font color="#E5E5E5"> external</font>

292
00:15:44,380 --> 00:15:51,880
resources so like load this image from

293
00:15:46,839 --> 00:15:54,940
CDN dot-com whatever<font color="#E5E5E5"> you can add</font><font color="#CCCCCC"> inline</font>

294
00:15:51,880 --> 00:15:57,820
attachments like<font color="#E5E5E5"> base64 encoded inline</font>

295
00:15:54,940 --> 00:16:00,430
image but the content of the the body<font color="#E5E5E5"> of</font>

296
00:15:57,820 --> 00:16:02,890
the<font color="#E5E5E5"> HTML</font><font color="#CCCCCC"> is growing really</font><font color="#E5E5E5"> fast then and</font>

297
00:16:00,430 --> 00:16:06,189
you can use<font color="#CCCCCC"> something called</font><font color="#E5E5E5"> CID</font><font color="#CCCCCC"> URI</font>

298
00:16:02,890 --> 00:16:07,600
scheme<font color="#E5E5E5"> so you can you can</font><font color="#CCCCCC"> make a referee</font>

299
00:16:06,190 --> 00:16:10,540
in the email body<font color="#E5E5E5"> you can make</font><font color="#CCCCCC"> a</font>

300
00:16:07,600 --> 00:16:14,170
reference to attachments very very

301
00:16:10,540 --> 00:16:17,709
tricky<font color="#CCCCCC"> very like ATS</font>

302
00:16:14,170 --> 00:16:22,269
<font color="#E5E5E5">so following RFC it looks like that so</font>

303
00:16:17,709 --> 00:16:24,518
we<font color="#E5E5E5"> are creating</font><font color="#CCCCCC"> a URL</font><font color="#E5E5E5"> to CID</font><font color="#CCCCCC"> double dot</font>

304
00:16:22,269 --> 00:16:26,800
<font color="#E5E5E5">and the name of the resource and later</font>

305
00:16:24,519 --> 00:16:31,709
on you just need to name the<font color="#CCCCCC"> attachment</font>

306
00:16:26,800 --> 00:16:31,709
<font color="#E5E5E5">Content ID equals full bar or whatever</font>

307
00:16:32,430 --> 00:16:39,099
<font color="#CCCCCC">but how</font><font color="#E5E5E5"> will you do it</font><font color="#CCCCCC"> in the in the</font>

308
00:16:36,339 --> 00:16:42,610
<font color="#CCCCCC">real browser</font><font color="#E5E5E5"> in the HTML node because</font>

309
00:16:39,100 --> 00:16:44,949
when you are<font color="#CCCCCC"> rendering</font><font color="#E5E5E5"> email in the</font>

310
00:16:42,610 --> 00:16:48,459
browser<font color="#CCCCCC"> you don't have the attachments</font>

311
00:16:44,949 --> 00:16:51,310
so<font color="#E5E5E5"> you need to like fix those you the</font>

312
00:16:48,459 --> 00:16:58,899
browser don't know how to handle CID<font color="#E5E5E5"> URI</font>

313
00:16:51,310 --> 00:17:01,989
scheme<font color="#CCCCCC"> so let's make a</font><font color="#E5E5E5"> test so we send a</font>

314
00:16:58,899 --> 00:17:05,069
message<font color="#CCCCCC"> with image source equals</font><font color="#E5E5E5"> CID</font>

315
00:17:01,990 --> 00:17:09,549
<font color="#E5E5E5">blah blah blah</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> there was a third</font>

316
00:17:05,069 --> 00:17:12,490
image<font color="#E5E5E5"> at the end here what was the</font>

317
00:17:09,549 --> 00:17:16,418
effect<font color="#E5E5E5"> okay the nyan cat was rendered</font>

318
00:17:12,490 --> 00:17:21,609
inside the HTML mode<font color="#E5E5E5"> so some magic</font>

319
00:17:16,419 --> 00:17:26,709
<font color="#E5E5E5">happened at the bottom at</font><font color="#CCCCCC"> the server it</font>

320
00:17:21,609 --> 00:17:31,330
so<font color="#E5E5E5"> you can see that the URL</font><font color="#CCCCCC"> the CID was</font>

321
00:17:26,709 --> 00:17:35,530
replaced with<font color="#E5E5E5"> the path to to some file</font>

322
00:17:31,330 --> 00:17:38,770
on the web server so you so you're

323
00:17:35,530 --> 00:17:41,710
literally storing the attachments on the

324
00:17:38,770 --> 00:17:43,049
web<font color="#E5E5E5"> server and then presenting them to</font>

325
00:17:41,710 --> 00:17:46,840
<font color="#E5E5E5">the user</font>

326
00:17:43,049 --> 00:17:51,129
<font color="#CCCCCC">ok let's try</font><font color="#E5E5E5"> to exploit</font><font color="#CCCCCC"> that we created</font>

327
00:17:46,840 --> 00:17:53,840
<font color="#E5E5E5">email this is the this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the important</font>

328
00:17:51,130 --> 00:17:56,779
part<font color="#E5E5E5"> part the email contents going</font>

329
00:17:53,840 --> 00:18:00,349
<font color="#E5E5E5">i frame and the iframe is leading you to</font>

330
00:17:56,779 --> 00:18:04,070
the normally to<font color="#E5E5E5"> the attachment but in</font>

331
00:18:00,349 --> 00:18:07,059
HTML in browser it<font color="#CCCCCC"> will not work</font><font color="#E5E5E5"> so what</font>

332
00:18:04,070 --> 00:18:10,009
<font color="#CCCCCC">will get</font><font color="#E5E5E5"> okay and this is the attachment</font>

333
00:18:07,059 --> 00:18:14,149
please notice the original<font color="#CCCCCC"> file</font><font color="#E5E5E5"> name</font>

334
00:18:10,009 --> 00:18:17,419
<font color="#CCCCCC">this is JSP file</font><font color="#E5E5E5"> not chief not PNG not</font>

335
00:18:14,149 --> 00:18:21,408
graphic file rest<font color="#E5E5E5"> let's try to render it</font>

336
00:18:17,419 --> 00:18:22,820
and if you decode base64 this is

337
00:18:21,409 --> 00:18:25,929
something<font color="#CCCCCC"> that you can find in the</font>

338
00:18:22,820 --> 00:18:29,330
internet like a web show

339
00:18:25,929 --> 00:18:33,649
so when you<font color="#CCCCCC"> open the email in the</font>

340
00:18:29,330 --> 00:18:35,869
browser<font color="#E5E5E5"> it look like that and okay very</font>

341
00:18:33,649 --> 00:18:38,439
interesting guys<font color="#E5E5E5"> type the first comment</font>

342
00:18:35,869 --> 00:18:41,449
that<font color="#CCCCCC"> you type in the</font><font color="#E5E5E5"> unknown environment</font>

343
00:18:38,440 --> 00:18:44,960
some<font color="#E5E5E5"> propositions ID</font>

344
00:18:41,450 --> 00:18:54,169
yes<font color="#CCCCCC"> exactly</font><font color="#E5E5E5"> who am I like am</font><font color="#CCCCCC"> i nobody no</font>

345
00:18:44,960 --> 00:18:55,700
<font color="#E5E5E5">you are wrote so basically to</font><font color="#CCCCCC"> root this</font>

346
00:18:54,169 --> 00:18:58,909
appliance<font color="#CCCCCC"> you need to send yourself</font>

347
00:18:55,700 --> 00:19:07,309
<font color="#E5E5E5">email with a lot of spam and</font><font color="#CCCCCC"> viagra and</font>

348
00:18:58,909 --> 00:19:09,349
iframe but they<font color="#CCCCCC"> fix</font><font color="#E5E5E5"> that hopefully new</font>

349
00:19:07,309 --> 00:19:11,080
versions they will not implement it

350
00:19:09,349 --> 00:19:14,989
again in the new version

351
00:19:11,080 --> 00:19:17,478
another<font color="#CCCCCC"> bug</font><font color="#E5E5E5"> bug number</font><font color="#CCCCCC"> three I</font><font color="#E5E5E5"> was</font>

352
00:19:14,989 --> 00:19:21,830
setting up<font color="#CCCCCC"> web server running on a local</font>

353
00:19:17,479 --> 00:19:23,450
host<font color="#E5E5E5"> on some random high port</font><font color="#CCCCCC"> normal</font>

354
00:19:21,830 --> 00:19:26,178
daily job like<font color="#CCCCCC"> that you're developing a</font>

355
00:19:23,450 --> 00:19:27,889
tool to is serving HTML page<font color="#CCCCCC"> you're</font>

356
00:19:26,179 --> 00:19:31,190
starting a web server in Python Java

357
00:19:27,889 --> 00:19:35,109
whatever and I<font color="#E5E5E5"> open a corpo browser</font>

358
00:19:31,190 --> 00:19:40,039
Internet Explorer<font color="#E5E5E5"> of course type in HTTP</font>

359
00:19:35,109 --> 00:19:43,809
<font color="#E5E5E5">blah blah blah hit enter and hint alert</font>

360
00:19:40,039 --> 00:19:43,809
cannot display the<font color="#E5E5E5"> page what the is</font>

361
00:19:44,049 --> 00:19:52,190
this is the normal user<font color="#E5E5E5"> reaction and</font>

362
00:19:48,369 --> 00:19:56,449
ticket to the<font color="#E5E5E5"> IT but I'm not the</font><font color="#CCCCCC"> IT guy</font>

363
00:19:52,190 --> 00:19:59,599
<font color="#CCCCCC">am</font><font color="#E5E5E5"> the security guys</font><font color="#CCCCCC"> ok a lot</font><font color="#E5E5E5"> of fsck</font>

364
00:19:56,450 --> 00:20:01,970
<font color="#E5E5E5">netstat and debugging later</font><font color="#CCCCCC"> a very</font>

365
00:19:59,599 --> 00:20:04,330
obvious conclusion any<font color="#E5E5E5"> hints from the</font>

366
00:20:01,970 --> 00:20:04,330
audience

367
00:20:05,059 --> 00:20:13,440
<font color="#CCCCCC">no I set up</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> proxy in the wrong way I</font>

368
00:20:11,039 --> 00:20:17,730
didn't check the box bypass proxy server

369
00:20:13,440 --> 00:20:24,390
for<font color="#E5E5E5"> local addresses so the question is -</font>

370
00:20:17,730 --> 00:20:27,269
where did my HTTP request go so we are

371
00:20:24,390 --> 00:20:29,519
launching HTTP<font color="#CCCCCC"> request here</font><font color="#E5E5E5"> it is</font>

372
00:20:27,269 --> 00:20:31,980
forwarded to proxy because<font color="#E5E5E5"> this is the</font>

373
00:20:29,519 --> 00:20:35,190
<font color="#CCCCCC">setup</font><font color="#E5E5E5"> sundar set up proxies receiving</font>

374
00:20:31,980 --> 00:20:39,080
all the HTTP<font color="#CCCCCC"> requests and the proxy</font>

375
00:20:35,190 --> 00:20:39,080
<font color="#CCCCCC">saying where is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> localhost for</font><font color="#E5E5E5"> me</font>

376
00:20:39,110 --> 00:20:45,840
of course the<font color="#CCCCCC"> localhost is the proxy</font>

377
00:20:42,809 --> 00:20:49,529
itself<font color="#E5E5E5"> but still to be able to like do</font>

378
00:20:45,840 --> 00:20:51,779
something<font color="#E5E5E5"> with that you need a TCP port</font>

379
00:20:49,529 --> 00:20:54,750
to<font color="#E5E5E5"> be open like</font><font color="#CCCCCC"> you need something to be</font>

380
00:20:51,779 --> 00:20:57,139
listening<font color="#E5E5E5"> on localhost sorry for hunt</font>

381
00:20:54,750 --> 00:21:00,899
<font color="#CCCCCC">nodes</font><font color="#E5E5E5"> but I was researching that with</font>

382
00:20:57,139 --> 00:21:03,149
old-school techniques<font color="#E5E5E5"> this is the list</font>

383
00:21:00,899 --> 00:21:06,178
of the<font color="#E5E5E5"> ports that were open on the</font>

384
00:21:03,149 --> 00:21:10,350
<font color="#E5E5E5">localhost</font><font color="#CCCCCC"> some of them was were like TLS</font>

385
00:21:06,179 --> 00:21:14,419
wrappers for<font color="#E5E5E5"> others etc etc so</font><font color="#CCCCCC"> 20 or</font>

386
00:21:10,350 --> 00:21:18,418
more<font color="#CCCCCC"> TCP port I think half of them</font>

387
00:21:14,419 --> 00:21:21,419
<font color="#E5E5E5">answering with HTTP so we already</font><font color="#CCCCCC"> we</font>

388
00:21:18,419 --> 00:21:24,269
<font color="#E5E5E5">already got HTTP so this is the example</font>

389
00:21:21,419 --> 00:21:27,179
of<font color="#E5E5E5"> the exploit you are sending HTTP</font>

390
00:21:24,269 --> 00:21:31,139
<font color="#E5E5E5">request to</font><font color="#CCCCCC"> a local host port port 8 8 8</font>

391
00:21:27,179 --> 00:21:35,190
<font color="#CCCCCC">0</font><font color="#E5E5E5"> with using your corporate browser just</font>

392
00:21:31,139 --> 00:21:37,370
you mistype the one setting key and you

393
00:21:35,190 --> 00:21:39,960
get the configuration<font color="#CCCCCC"> of the appliance</font>

394
00:21:37,370 --> 00:21:42,600
<font color="#E5E5E5">and of course everything was running as</font>

395
00:21:39,960 --> 00:21:45,929
<font color="#CCCCCC">rot root so we just</font><font color="#E5E5E5"> need to find out a</font>

396
00:21:42,600 --> 00:21:50,459
valid method<font color="#E5E5E5"> some so with the lowest</font>

397
00:21:45,929 --> 00:21:52,799
possible user rights on the<font color="#CCCCCC"> endpoint you</font>

398
00:21:50,460 --> 00:21:59,130
<font color="#CCCCCC">are able to exploit the web gateway this</font>

399
00:21:52,799 --> 00:22:04,230
<font color="#E5E5E5">way and they</font><font color="#CCCCCC"> fix</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> likely bug</font><font color="#E5E5E5"> number</font>

400
00:21:59,130 --> 00:22:07,409
4<font color="#E5E5E5"> but first a short</font><font color="#CCCCCC"> story at some point</font>

401
00:22:04,230 --> 00:22:10,110
of the time they<font color="#E5E5E5"> ask I received the</font>

402
00:22:07,409 --> 00:22:14,010
email<font color="#CCCCCC"> how can we change the font</font><font color="#E5E5E5"> of the</font>

403
00:22:10,110 --> 00:22:16,320
disclaimer that this put attached at<font color="#CCCCCC"> the</font>

404
00:22:14,010 --> 00:22:18,190
end of the<font color="#E5E5E5"> each email so some</font><font color="#CCCCCC"> of you</font>

405
00:22:16,320 --> 00:22:20,620
probably work in the great big

406
00:22:18,190 --> 00:22:22,779
operation and you know that when the

407
00:22:20,620 --> 00:22:25,600
email is<font color="#E5E5E5"> going out you need</font><font color="#CCCCCC"> a disclaimer</font>

408
00:22:22,779 --> 00:22:28,120
<font color="#CCCCCC">this</font><font color="#E5E5E5"> message is need to be delivered</font><font color="#CCCCCC"> to</font>

409
00:22:25,600 --> 00:22:29,918
<font color="#E5E5E5">recipient only if you are not recipient</font>

410
00:22:28,120 --> 00:22:31,809
and reading this email please delete

411
00:22:29,919 --> 00:22:34,509
this email and<font color="#E5E5E5"> our our lawyers will</font>

412
00:22:31,809 --> 00:22:38,379
contact<font color="#CCCCCC"> your</font><font color="#E5E5E5"> blah blah blah</font><font color="#CCCCCC"> I did a huge</font>

413
00:22:34,509 --> 00:22:40,059
portion<font color="#E5E5E5"> of the text yes yes</font><font color="#CCCCCC"> you need to</font>

414
00:22:38,379 --> 00:22:42,009
<font color="#E5E5E5">protect an environment</font><font color="#CCCCCC"> don't print his</font>

415
00:22:40,059 --> 00:22:48,820
email blah blah blah<font color="#CCCCCC"> if</font><font color="#E5E5E5"> people don't</font>

416
00:22:42,009 --> 00:22:53,649
make harm<font color="#CCCCCC"> first</font><font color="#E5E5E5"> question why did it</font>

417
00:22:48,820 --> 00:22:55,779
reached me<font color="#E5E5E5"> like why I am NOT the guy</font>

418
00:22:53,649 --> 00:22:59,620
<font color="#CCCCCC">responsible for</font><font color="#E5E5E5"> the color of the font in</font>

419
00:22:55,779 --> 00:23:02,139
<font color="#E5E5E5">a disclaimer literally this is quite</font>

420
00:22:59,620 --> 00:23:04,658
obvious like you change the font<font color="#E5E5E5"> you go</font>

421
00:23:02,139 --> 00:23:06,340
to the<font color="#CCCCCC"> week's developer ask them for</font>

422
00:23:04,659 --> 00:23:09,039
piece<font color="#E5E5E5"> of HTML</font><font color="#CCCCCC"> code with different</font>

423
00:23:06,340 --> 00:23:14,199
<font color="#CCCCCC">coloring everything should be</font><font color="#E5E5E5"> working</font>

424
00:23:09,039 --> 00:23:16,629
but yes<font color="#CCCCCC"> a one remarked my team is known</font>

425
00:23:14,200 --> 00:23:19,149
in our corporation<font color="#CCCCCC"> as that people that</font>

426
00:23:16,629 --> 00:23:22,209
know<font color="#CCCCCC"> how those tiny things in</font><font color="#E5E5E5"> a computer</font>

427
00:23:19,149 --> 00:23:24,879
<font color="#CCCCCC">works so it sounds trivial but</font><font color="#E5E5E5"> we often</font>

428
00:23:22,210 --> 00:23:27,669
receive a lot<font color="#E5E5E5"> of maybe not</font><font color="#CCCCCC"> a lot of we</font>

429
00:23:24,879 --> 00:23:31,240
often receive a request<font color="#E5E5E5"> like</font><font color="#CCCCCC"> ok nobody</font>

430
00:23:27,669 --> 00:23:36,279
knows how the stuff is working<font color="#E5E5E5"> maybe you</font>

431
00:23:31,240 --> 00:23:39,519
have a slightly idea how to how this<font color="#E5E5E5"> is</font>

432
00:23:36,279 --> 00:23:41,320
<font color="#CCCCCC">working how to fix that so this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font>

433
00:23:39,519 --> 00:23:43,269
normal<font color="#CCCCCC"> way</font><font color="#E5E5E5"> how the intent that the email</font>

434
00:23:41,320 --> 00:23:46,059
<font color="#E5E5E5">is going out so the PC is contacting</font>

435
00:23:43,269 --> 00:23:49,710
exchange<font color="#CCCCCC"> or</font><font color="#E5E5E5"> any other mail server mail</font>

436
00:23:46,059 --> 00:23:52,720
server is<font color="#E5E5E5"> sending it to the world</font><font color="#CCCCCC"> by</font>

437
00:23:49,710 --> 00:23:56,320
<font color="#E5E5E5">filtering so for example this</font><font color="#CCCCCC"> web</font><font color="#E5E5E5"> gay</font>

438
00:23:52,720 --> 00:23:58,629
<font color="#CCCCCC">email</font><font color="#E5E5E5"> gateway appliance and of course</font>

439
00:23:56,320 --> 00:24:00,820
you have a bonus you have servers<font color="#E5E5E5"> and</font>

440
00:23:58,629 --> 00:24:03,668
because of<font color="#E5E5E5"> alleged legacy reasons</font>

441
00:24:00,820 --> 00:24:06,250
<font color="#E5E5E5">because</font><font color="#CCCCCC"> of change of the environment</font>

442
00:24:03,669 --> 00:24:08,379
because<font color="#CCCCCC"> of whatever whatever</font><font color="#E5E5E5"> servers are</font>

443
00:24:06,250 --> 00:24:10,330
sending<font color="#E5E5E5"> email is not through the single</font>

444
00:24:08,379 --> 00:24:12,490
<font color="#CCCCCC">point but they are like some</font><font color="#E5E5E5"> of the</font>

445
00:24:10,330 --> 00:24:15,009
contacted connected to<font color="#E5E5E5"> exchange some to</font>

446
00:24:12,490 --> 00:24:18,370
contacted connected to a web<font color="#CCCCCC"> gateway</font>

447
00:24:15,009 --> 00:24:22,210
some are like sending emails by I don't

448
00:24:18,370 --> 00:24:25,330
know so it happens<font color="#E5E5E5"> that we identified</font>

449
00:24:22,210 --> 00:24:28,409
that the disclaimer is attached on this

450
00:24:25,330 --> 00:24:28,408
web gate<font color="#E5E5E5"> mail gateway</font>

451
00:24:31,160 --> 00:24:35,180
in the Triton so in this fancy interface

452
00:24:34,070 --> 00:24:38,389
that you<font color="#CCCCCC"> man</font>

453
00:24:35,180 --> 00:24:41,600
configure everything<font color="#CCCCCC"> you're able to edit</font>

454
00:24:38,390 --> 00:24:43,160
the content<font color="#E5E5E5"> of the of the disclaimer but</font>

455
00:24:41,600 --> 00:24:44,540
you're not<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to change the style so</font>

456
00:24:43,160 --> 00:24:47,330
we could put the<font color="#CCCCCC"> Polish version the</font>

457
00:24:44,540 --> 00:24:48,530
English version<font color="#CCCCCC"> there</font><font color="#E5E5E5"> is no limit on</font><font color="#CCCCCC"> the</font>

458
00:24:47,330 --> 00:24:52,399
<font color="#CCCCCC">length so you can like put</font><font color="#E5E5E5"> the</font>

459
00:24:48,530 --> 00:24:58,340
environment<font color="#CCCCCC"> disclaimer the privacy</font><font color="#E5E5E5"> in</font>

460
00:24:52,400 --> 00:25:00,800
whatever<font color="#E5E5E5"> you wonder we are counting on</font>

461
00:24:58,340 --> 00:25:03,230
the fact<font color="#E5E5E5"> that okay maybe it is not</font>

462
00:25:00,800 --> 00:25:06,530
<font color="#E5E5E5">doable from the interface maybe there is</font>

463
00:25:03,230 --> 00:25:08,360
a config file or whatever<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we had be</font>

464
00:25:06,530 --> 00:25:12,730
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to change the config file then the</font>

465
00:25:08,360 --> 00:25:12,729
phone will go from<font color="#E5E5E5"> blue to silver</font>

466
00:25:13,030 --> 00:25:20,480
<font color="#CCCCCC">because we already good root we made a</font>

467
00:25:16,180 --> 00:25:24,830
very<font color="#CCCCCC"> short very</font><font color="#E5E5E5"> short one-liner that</font>

468
00:25:20,480 --> 00:25:26,780
will try to<font color="#E5E5E5"> find the file where the</font>

469
00:25:24,830 --> 00:25:31,159
<font color="#CCCCCC">configuration of the color</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> font</font>

470
00:25:26,780 --> 00:25:32,990
<font color="#CCCCCC">is</font><font color="#E5E5E5"> okay so we run it unluckily it was</font>

471
00:25:31,160 --> 00:25:37,340
hard-coded in the binary<font color="#CCCCCC"> file but</font><font color="#E5E5E5"> okay</font>

472
00:25:32,990 --> 00:25:39,380
<font color="#E5E5E5">so we</font><font color="#CCCCCC"> failed but they already</font><font color="#E5E5E5"> led us</font>

473
00:25:37,340 --> 00:25:42,350
into the server so let's<font color="#CCCCCC"> find some</font>

474
00:25:39,380 --> 00:25:48,190
<font color="#CCCCCC">commands</font><font color="#E5E5E5"> let's see what is happening</font><font color="#CCCCCC"> at</font>

475
00:25:42,350 --> 00:25:52,340
the kernel<font color="#E5E5E5"> the mask pound pound pound</font>

476
00:25:48,190 --> 00:25:56,540
<font color="#CCCCCC">okay you have</font><font color="#E5E5E5"> one thousand six holes in</font>

477
00:25:52,340 --> 00:25:59,500
<font color="#E5E5E5">your locks okay this is normal normal</font>

478
00:25:56,540 --> 00:26:01,399
<font color="#CCCCCC">people normal people reaction is</font>

479
00:25:59,500 --> 00:26:03,440
something is<font color="#E5E5E5"> crushing something</font>

480
00:26:01,400 --> 00:26:05,240
<font color="#CCCCCC">discoursing lighting</font><font color="#E5E5E5"> needs to fix it but</font>

481
00:26:03,440 --> 00:26:10,370
<font color="#CCCCCC">we are</font><font color="#E5E5E5"> again we are not the normal</font>

482
00:26:05,240 --> 00:26:13,360
<font color="#CCCCCC">people we</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> the security guys so we</font>

483
00:26:10,370 --> 00:26:19,639
see that something<font color="#E5E5E5"> is wrong</font>

484
00:26:13,360 --> 00:26:22,149
literally wrong there we<font color="#CCCCCC"> knew that stuff</font>

485
00:26:19,640 --> 00:26:27,650
is<font color="#CCCCCC"> crashing but we didn't know where so</font>

486
00:26:22,150 --> 00:26:30,620
from from the<font color="#CCCCCC"> logs we saw that process</font>

487
00:26:27,650 --> 00:26:34,370
<font color="#E5E5E5">name key vo o P is crushing in this</font>

488
00:26:30,620 --> 00:26:36,290
library<font color="#E5E5E5"> this process is created by</font>

489
00:26:34,370 --> 00:26:38,479
process called filter and process filter

490
00:26:36,290 --> 00:26:42,500
is created by some modified postfix

491
00:26:38,480 --> 00:26:44,330
version so<font color="#CCCCCC"> okay so we see</font><font color="#E5E5E5"> that when</font>

492
00:26:42,500 --> 00:26:50,260
probably when the email is filtered

493
00:26:44,330 --> 00:26:53,419
analyzed<font color="#E5E5E5"> something is crashing</font><font color="#CCCCCC"> so</font>

494
00:26:50,260 --> 00:26:58,370
<font color="#CCCCCC">related</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> processing and we</font><font color="#CCCCCC"> try to</font>

495
00:26:53,420 --> 00:27:00,740
<font color="#CCCCCC">google for</font><font color="#E5E5E5"> key vo o p MW x whatever and</font>

496
00:26:58,370 --> 00:27:03,199
we<font color="#E5E5E5"> found out that this is a library</font>

497
00:27:00,740 --> 00:27:09,290
developed by HP the company that is

498
00:27:03,200 --> 00:27:10,520
doing<font color="#E5E5E5"> the broken notebooks</font><font color="#CCCCCC"> sorry my</font>

499
00:27:09,290 --> 00:27:14,300
personal feeling I<font color="#E5E5E5"> don't like this</font>

500
00:27:10,520 --> 00:27:20,150
<font color="#E5E5E5">company</font><font color="#CCCCCC"> so so they they wrote a library</font>

501
00:27:14,300 --> 00:27:25,070
<font color="#E5E5E5">and this</font><font color="#CCCCCC"> mwx</font><font color="#E5E5E5"> s is Microsoft Word</font>

502
00:27:20,150 --> 00:27:26,750
XML something reader<font color="#E5E5E5"> so make sense if</font>

503
00:27:25,070 --> 00:27:30,280
you found<font color="#E5E5E5"> if you already find it in the</font>

504
00:27:26,750 --> 00:27:33,740
internet more<font color="#E5E5E5"> Google later</font>

505
00:27:30,280 --> 00:27:36,230
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> library to parse multiple file</font>

506
00:27:33,740 --> 00:27:38,480
formats<font color="#E5E5E5"> and extract the content for for</font>

507
00:27:36,230 --> 00:27:40,310
<font color="#CCCCCC">example for DLP so you have when you're</font>

508
00:27:38,480 --> 00:27:42,470
sending<font color="#E5E5E5"> dots</font><font color="#CCCCCC"> it is extracting</font><font color="#E5E5E5"> the</font>

509
00:27:40,310 --> 00:27:44,750
content to see that<font color="#E5E5E5"> your if you are not</font>

510
00:27:42,470 --> 00:27:50,720
<font color="#CCCCCC">shipping the Bank Secrecy or whatever</font>

511
00:27:44,750 --> 00:27:54,200
you're sending excel PDF<font color="#E5E5E5"> many of those</font>

512
00:27:50,720 --> 00:27:56,390
file formats anybody<font color="#E5E5E5"> when you look on</font>

513
00:27:54,200 --> 00:28:00,770
those<font color="#E5E5E5"> five</font><font color="#CCCCCC"> formas</font><font color="#E5E5E5"> anything come to</font><font color="#CCCCCC"> your</font>

514
00:27:56,390 --> 00:28:04,010
mind<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> CV was discovered for</font>

515
00:28:00,770 --> 00:28:07,700
<font color="#E5E5E5">example by Cisco</font><font color="#CCCCCC"> Dallas in those and for</font>

516
00:28:04,010 --> 00:28:10,490
me<font color="#E5E5E5"> like the Adobe itself implementing</font>

517
00:28:07,700 --> 00:28:13,700
the PDF format made a lot of mistakes

518
00:28:10,490 --> 00:28:16,430
<font color="#CCCCCC">and if you are making a product</font><font color="#E5E5E5"> that is</font>

519
00:28:13,700 --> 00:28:18,890
implementing PDF dot six zip every file

520
00:28:16,430 --> 00:28:25,760
format<font color="#CCCCCC"> that were exploited over</font><font color="#E5E5E5"> a few</font>

521
00:28:18,890 --> 00:28:28,100
years<font color="#E5E5E5"> you're brave</font><font color="#CCCCCC"> going back</font><font color="#E5E5E5"> to the seg</font>

522
00:28:25,760 --> 00:28:30,500
<font color="#E5E5E5">fault</font><font color="#CCCCCC"> they were</font><font color="#E5E5E5"> crushing when they were</font>

523
00:28:28,100 --> 00:28:31,610
trying to<font color="#CCCCCC"> access</font><font color="#E5E5E5"> the memory at the</font>

524
00:28:30,500 --> 00:28:34,460
addresses<font color="#CCCCCC"> like that</font>

525
00:28:31,610 --> 00:28:36,669
so anybody<font color="#E5E5E5"> order all the audio on the</font>

526
00:28:34,460 --> 00:28:39,730
<font color="#E5E5E5">audio audience can</font><font color="#CCCCCC"> you tell me what is</font>

527
00:28:36,670 --> 00:28:46,840
visible<font color="#CCCCCC"> when you look on this hex</font>

528
00:28:39,730 --> 00:28:53,380
characters<font color="#E5E5E5"> ten seconds</font>

529
00:28:46,840 --> 00:28:58,560
<font color="#CCCCCC">nine</font><font color="#E5E5E5"> no there are strings ASCII strings</font>

530
00:28:53,380 --> 00:29:01,330
so<font color="#CCCCCC"> 22 space 3a is some ale a big letter</font>

531
00:28:58,560 --> 00:29:04,060
<font color="#E5E5E5">big letter T or something</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> so</font>

532
00:29:01,330 --> 00:29:06,310
every if every time the process is

533
00:29:04,060 --> 00:29:09,669
<font color="#CCCCCC">crashing it is crushing</font><font color="#E5E5E5"> and when trying</font>

534
00:29:06,310 --> 00:29:13,090
<font color="#E5E5E5">to access a memory where the address is</font>

535
00:29:09,670 --> 00:29:16,600
asking so this is clearly something done

536
00:29:13,090 --> 00:29:19,679
<font color="#E5E5E5">wrong with parsing the currents and</font><font color="#CCCCCC"> we</font>

537
00:29:16,600 --> 00:29:23,370
got<font color="#CCCCCC"> a</font><font color="#E5E5E5"> file we need to find those emails</font>

538
00:29:19,680 --> 00:29:26,590
we managed<font color="#E5E5E5"> to find that those</font><font color="#CCCCCC"> emails</font><font color="#E5E5E5"> by</font>

539
00:29:23,370 --> 00:29:29,280
correlating the date of the crash<font color="#CCCCCC"> date</font>

540
00:29:26,590 --> 00:29:34,270
time of the<font color="#E5E5E5"> crash with logs from the</font>

541
00:29:29,280 --> 00:29:37,540
exchange<font color="#CCCCCC"> got the email</font><font color="#E5E5E5"> try to pop up</font>

542
00:29:34,270 --> 00:29:39,670
<font color="#E5E5E5">like got the rough</font><font color="#CCCCCC"> ero email with</font>

543
00:29:37,540 --> 00:29:41,350
attachment<font color="#CCCCCC"> ride</font><font color="#E5E5E5"> to pass it through the</font>

544
00:29:39,670 --> 00:29:45,550
solution it<font color="#CCCCCC"> crashed</font>

545
00:29:41,350 --> 00:29:49,389
<font color="#E5E5E5">okay so it is repeat can we repeat that</font>

546
00:29:45,550 --> 00:29:52,330
<font color="#E5E5E5">yes success</font><font color="#CCCCCC"> we try</font><font color="#E5E5E5"> to minimize</font><font color="#CCCCCC"> the</font>

547
00:29:49,390 --> 00:29:56,530
corpus<font color="#CCCCCC"> because the attachment was a</font><font color="#E5E5E5"> dot</font>

548
00:29:52,330 --> 00:30:00,129
<font color="#E5E5E5">X document having 60 pages so clearly</font>

549
00:29:56,530 --> 00:30:02,800
<font color="#E5E5E5">not good material for like analyzing</font>

550
00:30:00,130 --> 00:30:05,110
what is wrong with the parser we managed

551
00:30:02,800 --> 00:30:10,720
<font color="#E5E5E5">to minimize the the code almost to one</font>

552
00:30:05,110 --> 00:30:12,780
line so you had the picture inside the

553
00:30:10,720 --> 00:30:16,270
<font color="#E5E5E5">word document with a</font><font color="#CCCCCC"> to long description</font>

554
00:30:12,780 --> 00:30:19,510
and the server was crushing when there

555
00:30:16,270 --> 00:30:23,530
was too long description I think 124

556
00:30:19,510 --> 00:30:29,770
characters or<font color="#CCCCCC"> more then we need to try</font>

557
00:30:23,530 --> 00:30:32,790
<font color="#CCCCCC">to read the</font><font color="#E5E5E5"> defaults to like understand</font>

558
00:30:29,770 --> 00:30:36,910
<font color="#CCCCCC">well</font><font color="#E5E5E5"> this is the logic behind</font><font color="#CCCCCC"> but</font>

559
00:30:32,790 --> 00:30:38,860
reading<font color="#E5E5E5"> segmentation fault logs boring</font><font color="#CCCCCC"> I</font>

560
00:30:36,910 --> 00:30:40,420
wrote the code<font color="#E5E5E5"> normally you see</font>

561
00:30:38,860 --> 00:30:42,280
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that after parsing you</font>

562
00:30:40,420 --> 00:30:45,820
see something<font color="#CCCCCC"> like this</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> like</font>

563
00:30:42,280 --> 00:30:49,980
<font color="#E5E5E5">just a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> enriched so first of</font>

564
00:30:45,820 --> 00:30:52,870
all we can<font color="#E5E5E5"> see that the tools in</font>

565
00:30:49,980 --> 00:30:59,150
interpreting the memory address as a

566
00:30:52,870 --> 00:31:02,040
string so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can dot I s : here</font>

567
00:30:59,150 --> 00:31:04,710
additionally if you<font color="#CCCCCC"> if you give</font><font color="#E5E5E5"> this</font>

568
00:31:02,040 --> 00:31:06,960
<font color="#CCCCCC">tool path to the binaries so if you</font>

569
00:31:04,710 --> 00:31:10,470
extract<font color="#E5E5E5"> the binaries from the server and</font>

570
00:31:06,960 --> 00:31:13,550
<font color="#E5E5E5">put to the directory when the tool is it</font>

571
00:31:10,470 --> 00:31:13,550
can try to disassemble

572
00:31:13,580 --> 00:31:19,080
<font color="#E5E5E5">disassemble the binary file and tell you</font>

573
00:31:16,860 --> 00:31:25,500
<font color="#E5E5E5">okay this is the line when were the</font>

574
00:31:19,080 --> 00:31:29,129
assembly code crushed<font color="#E5E5E5"> in our case we are</font>

575
00:31:25,500 --> 00:31:37,530
<font color="#CCCCCC">crushing</font><font color="#E5E5E5"> in the line where you were this</font>

576
00:31:29,130 --> 00:31:39,810
<font color="#CCCCCC">call</font><font color="#E5E5E5"> I a plus some offset so the first</font>

577
00:31:37,530 --> 00:31:41,850
thing we we have remote code execution

578
00:31:39,810 --> 00:31:44,460
by<font color="#E5E5E5"> free because we don't need a rope</font>

579
00:31:41,850 --> 00:31:45,689
gadgets or anything else<font color="#E5E5E5"> because we</font>

580
00:31:44,460 --> 00:31:53,730
<font color="#CCCCCC">already have an instruction that is</font>

581
00:31:45,690 --> 00:31:56,520
<font color="#E5E5E5">calling the address that we control</font><font color="#CCCCCC"> so</font>

582
00:31:53,730 --> 00:32:00,930
few hours later we<font color="#E5E5E5"> will manage</font><font color="#CCCCCC"> to</font>

583
00:31:56,520 --> 00:32:03,510
develop exploit<font color="#E5E5E5"> the the input was that</font>

584
00:32:00,930 --> 00:32:06,030
we<font color="#E5E5E5"> are</font><font color="#CCCCCC"> we are</font><font color="#E5E5E5"> putting in the address</font>

585
00:32:03,510 --> 00:32:09,120
what we want to call<font color="#E5E5E5"> and later on the</font>

586
00:32:06,030 --> 00:32:12,149
server the software's<font color="#E5E5E5"> crashing just</font><font color="#CCCCCC"> at</font>

587
00:32:09,120 --> 00:32:17,850
<font color="#E5E5E5">this address and of course everything</font>

588
00:32:12,150 --> 00:32:21,870
<font color="#E5E5E5">was running as root so exploited</font><font color="#CCCCCC"> what is</font>

589
00:32:17,850 --> 00:32:23,969
very funny<font color="#E5E5E5"> to trigger this back</font><font color="#CCCCCC"> you</font>

590
00:32:21,870 --> 00:32:27,389
don't<font color="#E5E5E5"> need anything because we you need</font>

591
00:32:23,970 --> 00:32:29,760
to send the email with attachment to

592
00:32:27,390 --> 00:32:31,710
<font color="#E5E5E5">even not existing email in the</font>

593
00:32:29,760 --> 00:32:34,770
corporation that<font color="#CCCCCC"> is protected</font><font color="#E5E5E5"> with this</font>

594
00:32:31,710 --> 00:32:36,720
solution so you just prepared the

595
00:32:34,770 --> 00:32:38,550
exploit send it randomly<font color="#E5E5E5"> and you take</font>

596
00:32:36,720 --> 00:32:42,410
<font color="#CCCCCC">over the control take over the control</font>

597
00:32:38,550 --> 00:32:47,720
of<font color="#E5E5E5"> the mail gateway of the whole company</font>

598
00:32:42,410 --> 00:32:52,200
luckily they fix that closing credits

599
00:32:47,720 --> 00:32:54,360
<font color="#E5E5E5">the summary we didn't we did not perform</font>

600
00:32:52,200 --> 00:32:56,820
a penetration<font color="#CCCCCC"> test of the solution so</font>

601
00:32:54,360 --> 00:32:59,280
everything we discover was discovered by

602
00:32:56,820 --> 00:33:03,260
accident<font color="#CCCCCC"> like we</font><font color="#E5E5E5"> miss configure the</font>

603
00:32:59,280 --> 00:33:06,750
proxy all box was worth discovering

604
00:33:03,260 --> 00:33:10,230
<font color="#E5E5E5">discovered</font><font color="#CCCCCC"> by curiosity</font><font color="#E5E5E5"> and accidents of</font>

605
00:33:06,750 --> 00:33:12,029
the same<font color="#E5E5E5"> everything seriously</font><font color="#CCCCCC"> everything</font>

606
00:33:10,230 --> 00:33:14,190
on every each component

607
00:33:12,029 --> 00:33:16,979
of this<font color="#CCCCCC"> solution was running as root</font>

608
00:33:14,190 --> 00:33:19,049
<font color="#E5E5E5">with one exception there's what there</font>

609
00:33:16,979 --> 00:33:21,149
<font color="#E5E5E5">was a Postgres database running locally</font>

610
00:33:19,049 --> 00:33:23,279
and the Postgres database was running<font color="#CCCCCC"> on</font>

611
00:33:21,149 --> 00:33:26,218
the Postgres user<font color="#E5E5E5"> just because the</font>

612
00:33:23,279 --> 00:33:27,960
Postgres<font color="#CCCCCC"> out of the box is dropping the</font>

613
00:33:26,219 --> 00:33:29,999
privileges<font color="#E5E5E5"> but everything else was</font>

614
00:33:27,960 --> 00:33:32,519
running<font color="#E5E5E5"> as root so if you take over</font><font color="#CCCCCC"> any</font>

615
00:33:29,999 --> 00:33:35,849
kind<font color="#E5E5E5"> of piece of</font><font color="#CCCCCC"> this solution your</font>

616
00:33:32,519 --> 00:33:42,929
<font color="#CCCCCC">route we managed to</font><font color="#E5E5E5"> break version open</font>

617
00:33:35,849 --> 00:33:45,839
8.1<font color="#E5E5E5"> there is 8.5 a lot a lot seriously</font><font color="#CCCCCC"> a</font>

618
00:33:42,929 --> 00:33:46,409
<font color="#E5E5E5">lot was improved inside and a lot</font><font color="#CCCCCC"> of was</font>

619
00:33:45,839 --> 00:33:48,799
fixed

620
00:33:46,409 --> 00:33:51,659
not even stuff that<font color="#CCCCCC"> we reported</font>

621
00:33:48,799 --> 00:33:54,299
conclusion<font color="#E5E5E5"> number one never please if</font>

622
00:33:51,659 --> 00:33:57,960
you have any<font color="#CCCCCC"> influence on</font><font color="#E5E5E5"> the developers</font>

623
00:33:54,299 --> 00:34:01,679
product managers never run<font color="#CCCCCC"> staff as a</font>

624
00:33:57,960 --> 00:34:04,379
root you have<font color="#E5E5E5"> thousands of ways to do</font><font color="#CCCCCC"> to</font>

625
00:34:01,679 --> 00:34:07,109
like<font color="#E5E5E5"> elevate the privileges if the your</font>

626
00:34:04,379 --> 00:34:09,918
solution is needing that<font color="#E5E5E5"> but never run</font>

627
00:34:07,109 --> 00:34:11,480
stuff<font color="#CCCCCC"> was a root because because this</font>

628
00:34:09,918 --> 00:34:14,250
<font color="#E5E5E5">defense-in-depth</font>

629
00:34:11,480 --> 00:34:16,619
methodology said<font color="#CCCCCC"> okay drop the</font>

630
00:34:14,250 --> 00:34:19,589
privileges limit the access limit the

631
00:34:16,619 --> 00:34:21,809
scope<font color="#E5E5E5"> if you need read-only access work</font>

632
00:34:19,589 --> 00:34:25,049
as a user that<font color="#CCCCCC"> has</font><font color="#E5E5E5"> only read-only access</font>

633
00:34:21,809 --> 00:34:29,339
not as the<font color="#E5E5E5"> most privileged account on</font>

634
00:34:25,049 --> 00:34:31,739
the on your<font color="#E5E5E5"> system never never never</font>

635
00:34:29,339 --> 00:34:35,089
trust user input<font color="#E5E5E5"> especially if you</font><font color="#CCCCCC"> just</font>

636
00:34:31,739 --> 00:34:38,759
classify<font color="#E5E5E5"> this user input as a malicious</font>

637
00:34:35,089 --> 00:34:42,000
this is quite obvious<font color="#E5E5E5"> don't ignore your</font>

638
00:34:38,760 --> 00:34:43,740
<font color="#E5E5E5">crushes the piece that was missing on</font>

639
00:34:42,000 --> 00:34:47,339
<font color="#CCCCCC">the service was a process for example</font>

640
00:34:43,739 --> 00:34:49,469
that<font color="#E5E5E5"> was</font><font color="#CCCCCC"> rookie looking</font><font color="#E5E5E5"> if if something</font>

641
00:34:47,339 --> 00:34:51,569
crashed and then reporting<font color="#E5E5E5"> this crush</font>

642
00:34:49,469 --> 00:34:54,569
<font color="#E5E5E5">back to a vendor or say</font><font color="#CCCCCC"> ok</font>

643
00:34:51,569 --> 00:34:58,349
our solution is broken<font color="#CCCCCC"> what is funny</font>

644
00:34:54,569 --> 00:35:02,369
<font color="#E5E5E5">when the when the male analyzer crashed</font>

645
00:34:58,349 --> 00:35:04,230
<font color="#CCCCCC">it was marking the email as as clean</font><font color="#E5E5E5"> so</font>

646
00:35:02,369 --> 00:35:07,020
additionally to exploiting the web

647
00:35:04,230 --> 00:35:09,559
server<font color="#E5E5E5"> you will the email got passed</font>

648
00:35:07,020 --> 00:35:12,480
through all the detection<font color="#E5E5E5"> mechanism</font>

649
00:35:09,559 --> 00:35:15,390
keep your appeal under control out<font color="#CCCCCC"> Royce</font>

650
00:35:12,480 --> 00:35:18,059
calls<font color="#E5E5E5"> all of them</font><font color="#CCCCCC"> even if</font><font color="#E5E5E5"> you expose a</font><font color="#CCCCCC"> P</font>

651
00:35:15,390 --> 00:35:19,740
<font color="#E5E5E5">on the local host you never know who is</font>

652
00:35:18,059 --> 00:35:22,650
<font color="#CCCCCC">on the local</font><font color="#E5E5E5"> host and</font><font color="#CCCCCC"> you never know</font>

653
00:35:19,740 --> 00:35:25,919
when you<font color="#CCCCCC"> will by accident</font><font color="#E5E5E5"> expose the API</font>

654
00:35:22,650 --> 00:35:31,079
to<font color="#CCCCCC"> the local or</font>

655
00:35:25,920 --> 00:35:33,690
why to network if you<font color="#E5E5E5"> are implementing</font>

656
00:35:31,079 --> 00:35:34,079
parcels of complex file format<font color="#E5E5E5"> good luck</font>

657
00:35:33,690 --> 00:35:36,480
with that

658
00:35:34,079 --> 00:35:39,240
<font color="#CCCCCC">Adobe had a problem with that if you're</font>

659
00:35:36,480 --> 00:35:43,560
implementing parcels with many many

660
00:35:39,240 --> 00:35:49,319
complex files you're seriously<font color="#E5E5E5"> crazy and</font>

661
00:35:43,560 --> 00:35:52,230
<font color="#CCCCCC">very brave</font><font color="#E5E5E5"> final conclusion if you claim</font>

662
00:35:49,319 --> 00:35:55,859
<font color="#E5E5E5">to have bug reporting program handle it</font>

663
00:35:52,230 --> 00:35:58,250
<font color="#E5E5E5">first point on the official web page is</font>

664
00:35:55,859 --> 00:36:01,619
claiming to<font color="#CCCCCC"> have the</font><font color="#E5E5E5"> product security</font>

665
00:35:58,250 --> 00:36:03,839
<font color="#E5E5E5">incident response</font><font color="#CCCCCC"> team and with</font><font color="#E5E5E5"> the on</font>

666
00:36:01,619 --> 00:36:05,940
the description<font color="#E5E5E5"> it is said that this</font><font color="#CCCCCC"> is</font>

667
00:36:03,839 --> 00:36:09,540
the<font color="#E5E5E5"> team that is</font><font color="#CCCCCC"> dedicated</font><font color="#E5E5E5"> for receiving</font>

668
00:36:05,940 --> 00:36:11,730
<font color="#E5E5E5">a feedback about the products about</font><font color="#CCCCCC"> the</font>

669
00:36:09,540 --> 00:36:13,560
vulnerabilities about<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> MIS</font>

670
00:36:11,730 --> 00:36:18,390
configuration miss functionality and

671
00:36:13,560 --> 00:36:21,990
handling it<font color="#CCCCCC"> three tips evaluate the</font>

672
00:36:18,390 --> 00:36:24,509
submission<font color="#E5E5E5"> give the feedback to the guy</font>

673
00:36:21,990 --> 00:36:27,720
<font color="#E5E5E5">that is reporting be responsive be</font>

674
00:36:24,510 --> 00:36:30,030
precise tell exactly what is going<font color="#CCCCCC"> on</font>

675
00:36:27,720 --> 00:36:31,859
<font color="#CCCCCC">right now</font><font color="#E5E5E5"> because we just</font><font color="#CCCCCC"> put those</font>

676
00:36:30,030 --> 00:36:35,190
emails with<font color="#CCCCCC"> the reports to the black</font>

677
00:36:31,859 --> 00:36:36,900
hole<font color="#E5E5E5"> we didn't receive in my opinion any</font>

678
00:36:35,190 --> 00:36:38,730
<font color="#E5E5E5">constructive response from them and be</font>

679
00:36:36,900 --> 00:36:41,280
honest<font color="#E5E5E5"> if you if you have for example</font>

680
00:36:38,730 --> 00:36:42,660
<font color="#CCCCCC">not planning to</font><font color="#E5E5E5"> fix it because in the</font>

681
00:36:41,280 --> 00:36:44,640
two months<font color="#CCCCCC"> you are releasing a new</font>

682
00:36:42,660 --> 00:36:46,500
version<font color="#E5E5E5"> tell</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> to the researcher</font>

683
00:36:44,640 --> 00:36:50,339
<font color="#CCCCCC">because we</font><font color="#E5E5E5"> did know what is happening</font>

684
00:36:46,500 --> 00:36:52,710
especially<font color="#E5E5E5"> that for a very short</font><font color="#CCCCCC"> period</font>

685
00:36:50,339 --> 00:36:55,910
of time<font color="#E5E5E5"> we were</font><font color="#CCCCCC"> using this version</font><font color="#E5E5E5"> this</font>

686
00:36:52,710 --> 00:37:00,630
version with a lot of<font color="#CCCCCC"> route remote</font><font color="#E5E5E5"> route</font>

687
00:36:55,910 --> 00:37:05,250
vulnerabilities and<font color="#CCCCCC"> my personal</font><font color="#E5E5E5"> thing</font>

688
00:37:00,630 --> 00:37:06,960
about all the xperia x peer event thank

689
00:37:05,250 --> 00:37:07,470
you<font color="#CCCCCC"> very much that's all</font><font color="#E5E5E5"> if you have</font>

690
00:37:06,960 --> 00:37:14,550
questions

691
00:37:07,470 --> 00:37:14,549
[Applause]

692
00:37:15,020 --> 00:37:18,410
any questions

693
00:37:31,990 --> 00:37:37,700
hi I've got a quick<font color="#CCCCCC"> question regarding</font>

694
00:37:34,579 --> 00:37:44,420
<font color="#CCCCCC">this memory corruption there were no</font>

695
00:37:37,700 --> 00:37:48,169
<font color="#E5E5E5">Eisler right because yes</font><font color="#CCCCCC"> okay there was</font>

696
00:37:44,420 --> 00:37:52,490
literally no obstacles<font color="#CCCCCC"> so first of all</font>

697
00:37:48,170 --> 00:38:00,770
we did control the instruction pointer

698
00:37:52,490 --> 00:38:02,149
because<font color="#E5E5E5"> okay we control the instruction</font>

699
00:38:00,770 --> 00:38:03,970
point<font color="#E5E5E5"> and because there was a call with</font>

700
00:38:02,150 --> 00:38:06,289
a<font color="#E5E5E5"> parameter will control the parameter</font>

701
00:38:03,970 --> 00:38:09,828
<font color="#E5E5E5">second there was there were a lot of</font>

702
00:38:06,289 --> 00:38:11,930
libraries<font color="#E5E5E5"> statically not statically</font><font color="#CCCCCC"> that</font>

703
00:38:09,829 --> 00:38:13,520
<font color="#E5E5E5">or a lot on the fixed addresses so</font><font color="#CCCCCC"> we</font>

704
00:38:11,930 --> 00:38:16,970
didn't need<font color="#E5E5E5"> to guess for example</font>

705
00:38:13,520 --> 00:38:18,920
addresses because the<font color="#CCCCCC"> legislates were</font>

706
00:38:16,970 --> 00:38:22,730
loaded on the same address<font color="#E5E5E5"> all the time</font>

707
00:38:18,920 --> 00:38:24,650
second there I don't<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> remember</font><font color="#CCCCCC"> if</font>

708
00:38:22,730 --> 00:38:28,400
there were any I don't<font color="#E5E5E5"> know stack</font>

709
00:38:24,650 --> 00:38:30,650
Canaries or<font color="#E5E5E5"> SSL are there but it was</font>

710
00:38:28,400 --> 00:38:34,279
quite trivial<font color="#E5E5E5"> bitch the only thing that</font>

711
00:38:30,650 --> 00:38:36,970
we needed<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do is type in to this to a</font>

712
00:38:34,279 --> 00:38:39,710
correct address<font color="#E5E5E5"> and there was a lot of</font>

713
00:38:36,970 --> 00:38:43,480
there<font color="#CCCCCC"> was a lot of gadgets</font><font color="#E5E5E5"> are all</font>

714
00:38:39,710 --> 00:38:47,690
around<font color="#E5E5E5"> but you didn't need</font><font color="#CCCCCC"> to build</font><font color="#E5E5E5"> a</font>

715
00:38:43,480 --> 00:38:49,520
stack<font color="#E5E5E5"> base so</font><font color="#CCCCCC"> rope chain</font><font color="#E5E5E5"> because you</font>

716
00:38:47,690 --> 00:38:51,349
just need<font color="#E5E5E5"> to specify go there call</font><font color="#CCCCCC"> it</font>

717
00:38:49,520 --> 00:38:58,880
this procedure yes thank you<font color="#CCCCCC"> thank you</font>

718
00:38:51,349 --> 00:39:01,490
<font color="#E5E5E5">for explaining other questions okay I</font>

719
00:38:58,880 --> 00:39:04,089
also noticed that<font color="#CCCCCC"> you mentioned</font><font color="#E5E5E5"> that it</font>

720
00:39:01,490 --> 00:39:08,598
was a<font color="#E5E5E5"> product with many features you</font>

721
00:39:04,089 --> 00:39:11,630
<font color="#E5E5E5">explored</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> may link analysis have you</font>

722
00:39:08,599 --> 00:39:14,029
or<font color="#CCCCCC"> your team also</font><font color="#E5E5E5"> explored the just web</font>

723
00:39:11,630 --> 00:39:16,539
content analysis because I seem to to

724
00:39:14,029 --> 00:39:20,240
know the product and and it also

725
00:39:16,539 --> 00:39:23,359
<font color="#E5E5E5">implements the SSL traffic inspection</font>

726
00:39:20,240 --> 00:39:26,930
and so on so yes so<font color="#E5E5E5"> basically this</font><font color="#CCCCCC"> give</font>

727
00:39:23,359 --> 00:39:30,200
<font color="#CCCCCC">you library is used by any kind</font><font color="#E5E5E5"> of</font>

728
00:39:26,930 --> 00:39:33,020
channel to do the content as content

729
00:39:30,200 --> 00:39:35,000
inspection<font color="#CCCCCC"> so if you probably probably</font>

730
00:39:33,020 --> 00:39:36,950
we didn't test<font color="#CCCCCC"> that as I mentioned we</font>

731
00:39:35,000 --> 00:39:38,720
didn't<font color="#E5E5E5"> perform a penetration test it was</font>

732
00:39:36,950 --> 00:39:42,270
like<font color="#E5E5E5"> accident</font>

733
00:39:38,720 --> 00:39:44,819
<font color="#E5E5E5">probably 99% sure that</font><font color="#CCCCCC"> if you sent this</font>

734
00:39:42,270 --> 00:39:47,340
<font color="#E5E5E5">dot</font><font color="#CCCCCC"> SIG's</font><font color="#E5E5E5"> file</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> also trigger the</font>

735
00:39:44,820 --> 00:39:55,670
back<font color="#E5E5E5"> because the library underneath is</font>

736
00:39:47,340 --> 00:39:57,780
the<font color="#CCCCCC"> same thank you any other questions</font>

737
00:39:55,670 --> 00:40:00,690
<font color="#E5E5E5">thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> if you have a</font>

738
00:39:57,780 --> 00:40:04,200
question I<font color="#E5E5E5"> will be still here I will try</font>

739
00:40:00,690 --> 00:40:06,840
to put my presentation on the Twitter<font color="#E5E5E5"> on</font>

740
00:40:04,200 --> 00:40:09,000
<font color="#CCCCCC">X Eve</font><font color="#E5E5E5"> con so we can have fun in home</font>

741
00:40:06,840 --> 00:40:11,090
thanks very much

742
00:40:09,000 --> 00:40:16,080
[Applause]

743
00:40:11,090 --> 00:40:16,080
[Music]

