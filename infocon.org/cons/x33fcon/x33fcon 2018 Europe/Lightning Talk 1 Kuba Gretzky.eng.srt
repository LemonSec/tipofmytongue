1
00:00:06,410 --> 00:00:11,680
[Music]

2
00:00:09,130 --> 00:00:14,770
<font color="#CCCCCC">hello</font><font color="#E5E5E5"> my name</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> Cooper Gretzky I wanted</font>

3
00:00:11,680 --> 00:00:17,259
today<font color="#CCCCCC"> to show you the way</font><font color="#E5E5E5"> to fish for</font>

4
00:00:14,770 --> 00:00:22,330
two-factor authentication tokens<font color="#E5E5E5"> using</font>

5
00:00:17,260 --> 00:00:24,310
<font color="#E5E5E5">the tool that I made one year ago</font><font color="#CCCCCC"> so</font>

6
00:00:22,330 --> 00:00:25,810
<font color="#E5E5E5">basically who I am briefly I'm an</font>

7
00:00:24,310 --> 00:00:28,779
independent<font color="#CCCCCC"> software developer for the</font>

8
00:00:25,810 --> 00:00:32,890
<font color="#E5E5E5">last</font><font color="#CCCCCC"> 10 years</font><font color="#E5E5E5"> MMO cracker</font><font color="#CCCCCC"> and currently</font>

9
00:00:28,780 --> 00:00:35,470
I'm working<font color="#CCCCCC"> on</font><font color="#E5E5E5"> development</font><font color="#CCCCCC"> of custom</font>

10
00:00:32,890 --> 00:00:37,989
post exploitation<font color="#E5E5E5"> agents we focus on</font>

11
00:00:35,470 --> 00:00:40,870
<font color="#E5E5E5">advanced the AV evasion</font>

12
00:00:37,989 --> 00:00:45,220
so the question how much is the fish

13
00:00:40,870 --> 00:00:46,659
<font color="#CCCCCC">scooter once asked I don't know how much</font>

14
00:00:45,220 --> 00:00:49,690
<font color="#E5E5E5">is the fish because it doesn't make any</font>

15
00:00:46,659 --> 00:00:52,000
<font color="#CCCCCC">sense but basically what fish fishing</font>

16
00:00:49,690 --> 00:00:54,640
<font color="#E5E5E5">right</font><font color="#CCCCCC"> now looks like</font><font color="#E5E5E5"> is based on</font>

17
00:00:52,000 --> 00:00:57,820
creating<font color="#CCCCCC"> templates</font><font color="#E5E5E5"> so you create a</font>

18
00:00:54,640 --> 00:01:00,400
template<font color="#CCCCCC"> of the known</font><font color="#E5E5E5"> web service with</font>

19
00:00:57,820 --> 00:01:03,159
that<font color="#E5E5E5"> Ice</font><font color="#CCCCCC"> Cube to enter your credentials</font>

20
00:01:00,400 --> 00:01:05,459
and<font color="#CCCCCC"> then the credentials</font><font color="#E5E5E5"> are captured</font>

21
00:01:03,159 --> 00:01:07,870
and this is<font color="#E5E5E5"> basically it</font><font color="#CCCCCC"> and if</font>

22
00:01:05,459 --> 00:01:11,199
two-factor authentication is enabled<font color="#E5E5E5"> on</font>

23
00:01:07,870 --> 00:01:13,329
the<font color="#E5E5E5"> account of course doesn't like it's</font>

24
00:01:11,200 --> 00:01:16,360
the credentials are basically useless

25
00:01:13,329 --> 00:01:19,979
<font color="#E5E5E5">because you can do much with</font><font color="#CCCCCC"> it</font>

26
00:01:16,360 --> 00:01:23,200
so what's the next<font color="#E5E5E5"> generation of fishing</font>

27
00:01:19,979 --> 00:01:24,520
<font color="#E5E5E5">next generation of fishing why use</font>

28
00:01:23,200 --> 00:01:26,649
templates<font color="#E5E5E5"> anyway</font>

29
00:01:24,520 --> 00:01:30,100
you can<font color="#CCCCCC"> just set up your</font><font color="#E5E5E5"> server</font><font color="#CCCCCC"> that</font>

30
00:01:26,649 --> 00:01:33,490
acts as a relay<font color="#E5E5E5"> proxy between the victim</font>

31
00:01:30,100 --> 00:01:36,130
<font color="#CCCCCC">and the web servers like</font><font color="#E5E5E5"> Google for</font>

32
00:01:33,490 --> 00:01:39,119
<font color="#CCCCCC">example and the whole</font><font color="#E5E5E5"> website will be</font>

33
00:01:36,130 --> 00:01:41,048
just retrieved and shown to<font color="#E5E5E5"> the victim</font>

34
00:01:39,119 --> 00:01:43,299
<font color="#E5E5E5">dynamically you don't need to like</font>

35
00:01:41,049 --> 00:01:45,689
create<font color="#E5E5E5"> custom templates and everything</font>

36
00:01:43,299 --> 00:01:48,340
and additionally<font color="#CCCCCC"> to that</font><font color="#E5E5E5"> all the</font>

37
00:01:45,689 --> 00:01:51,100
requests HTTP requests are intercepted

38
00:01:48,340 --> 00:01:53,859
<font color="#E5E5E5">on the fly</font><font color="#CCCCCC"> so we can read</font><font color="#E5E5E5"> credentials</font>

39
00:01:51,100 --> 00:01:55,770
cookies you<font color="#CCCCCC"> can manipulate this data and</font>

40
00:01:53,859 --> 00:02:01,749
<font color="#CCCCCC">also we can set up your own domain</font><font color="#E5E5E5"> with</font>

41
00:01:55,770 --> 00:02:04,630
custom<font color="#E5E5E5"> SSL TLS certificate so this will</font>

42
00:02:01,749 --> 00:02:11,609
be a live demo<font color="#CCCCCC"> so everything can go</font>

43
00:02:04,630 --> 00:02:11,609
wrong<font color="#E5E5E5"> right now sorry</font><font color="#CCCCCC"> okay</font>

44
00:02:13,150 --> 00:02:21,519
so I will show you how<font color="#E5E5E5"> to hack my own</font>

45
00:02:16,690 --> 00:02:24,790
account<font color="#CCCCCC"> so this is</font><font color="#E5E5E5"> basically the link</font>

46
00:02:21,519 --> 00:02:28,090
<font color="#E5E5E5">that the victim will receive so the our</font>

47
00:02:24,790 --> 00:02:30,459
victim will<font color="#CCCCCC"> be called the</font><font color="#E5E5E5"> Janos so the</font>

48
00:02:28,090 --> 00:02:31,209
<font color="#E5E5E5">analyst is receiving a link and please</font>

49
00:02:30,459 --> 00:02:34,690
<font color="#E5E5E5">be honest</font>

50
00:02:31,209 --> 00:02:34,959
keep see this<font color="#CCCCCC"> document and get back to</font>

51
00:02:34,690 --> 00:02:39,280
me

52
00:02:34,959 --> 00:02:41,799
so this is the<font color="#E5E5E5"> victims browser they the</font>

53
00:02:39,280 --> 00:02:44,230
<font color="#E5E5E5">youngish is entering the link let me</font>

54
00:02:41,799 --> 00:02:49,870
just<font color="#E5E5E5"> only remove all the cookies just in</font>

55
00:02:44,230 --> 00:02:52,179
case so<font color="#CCCCCC"> yang which is</font><font color="#E5E5E5"> receiving the the</font>

56
00:02:49,870 --> 00:02:55,000
link and this is what he sees this is

57
00:02:52,180 --> 00:03:00,159
this is the real Google<font color="#CCCCCC"> website</font><font color="#E5E5E5"> but</font>

58
00:02:55,000 --> 00:03:03,310
<font color="#E5E5E5">instead you can see the the URL is the</font>

59
00:03:00,159 --> 00:03:08,828
attackers<font color="#E5E5E5"> domain so what the English</font>

60
00:03:03,310 --> 00:03:10,810
does he sees okay I need to<font color="#E5E5E5"> login</font><font color="#CCCCCC"> I need</font>

61
00:03:08,829 --> 00:03:15,250
to<font color="#CCCCCC"> login in order</font><font color="#E5E5E5"> to see this</font><font color="#CCCCCC"> document</font>

62
00:03:10,810 --> 00:03:18,220
so I will do<font color="#E5E5E5"> that now it asks for the</font>

63
00:03:15,250 --> 00:03:28,829
<font color="#CCCCCC">password so</font><font color="#E5E5E5"> if youngish enters his</font>

64
00:03:18,220 --> 00:03:28,829
passwords okay forget the passwords

65
00:03:35,750 --> 00:03:42,239
and now let<font color="#E5E5E5"> me just take the my phone</font>

66
00:03:39,769 --> 00:03:45,599
because<font color="#E5E5E5"> this account is set up</font><font color="#CCCCCC"> with</font>

67
00:03:42,239 --> 00:03:50,519
two-factor<font color="#E5E5E5"> authentication and this is</font>

68
00:03:45,599 --> 00:03:52,950
now what happens<font color="#CCCCCC"> I got the push</font>

69
00:03:50,519 --> 00:03:56,610
notification<font color="#E5E5E5"> on my android phone</font><font color="#CCCCCC"> I don't</font>

70
00:03:52,950 --> 00:03:59,429
know if you can see that it's it says

71
00:03:56,610 --> 00:04:01,590
that<font color="#E5E5E5"> someone from</font><font color="#CCCCCC"> Linux</font><font color="#E5E5E5"> machine and the</font>

72
00:03:59,430 --> 00:04:03,390
unrecognized location tries to<font color="#E5E5E5"> log</font><font color="#CCCCCC"> into</font>

73
00:04:01,590 --> 00:04:07,950
<font color="#E5E5E5">my account and of course this is Yana so</font>

74
00:04:03,390 --> 00:04:13,708
it's<font color="#E5E5E5"> so so</font><font color="#CCCCCC"> Janusz presses yes I just</font>

75
00:04:07,950 --> 00:04:15,988
<font color="#CCCCCC">pressed</font><font color="#E5E5E5"> yes and now yeah no she's seeing</font>

76
00:04:13,709 --> 00:04:19,228
the the document<font color="#E5E5E5"> that he was supposed</font><font color="#CCCCCC"> to</font>

77
00:04:15,989 --> 00:04:23,090
see so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the end on the victim</font>

78
00:04:19,228 --> 00:04:23,090
<font color="#CCCCCC">site and now what does</font><font color="#E5E5E5"> the attacker do</font>

79
00:04:24,050 --> 00:04:34,949
so the attacker<font color="#E5E5E5"> locks in to their evil</font>

80
00:04:29,610 --> 00:04:43,020
<font color="#E5E5E5">jinx server VR SSH well whatever you can</font>

81
00:04:34,949 --> 00:04:46,020
<font color="#E5E5E5">login with and they try to see what</font><font color="#CCCCCC"> kind</font>

82
00:04:43,020 --> 00:04:49,760
of credentials<font color="#E5E5E5"> were captured so now we</font>

83
00:04:46,020 --> 00:04:56,190
see we found<font color="#E5E5E5"> two</font><font color="#CCCCCC"> credits</font><font color="#E5E5E5"> and one token</font>

84
00:04:49,760 --> 00:04:59,219
so if we look<font color="#CCCCCC"> into here into the</font><font color="#E5E5E5"> locks</font>

85
00:04:56,190 --> 00:05:01,650
<font color="#E5E5E5">directory you can see there is the the</font>

86
00:04:59,220 --> 00:05:05,160
email<font color="#CCCCCC"> of Thoth</font><font color="#E5E5E5"> and Janos at gmail.com</font>

87
00:05:01,650 --> 00:05:07,080
<font color="#E5E5E5">the rest is actually funny</font><font color="#CCCCCC"> because some</font>

88
00:05:05,160 --> 00:05:09,690
Chinese bots are trying to<font color="#E5E5E5"> brute-force</font>

89
00:05:07,080 --> 00:05:11,219
<font color="#E5E5E5">Google accounts</font><font color="#CCCCCC"> using my fake domain I</font>

90
00:05:09,690 --> 00:05:17,419
don't know why it<font color="#CCCCCC"> just came up</font><font color="#E5E5E5"> this</font>

91
00:05:11,220 --> 00:05:22,560
morning sir yeah<font color="#E5E5E5"> well but no tokens yeah</font>

92
00:05:17,419 --> 00:05:26,340
<font color="#CCCCCC">okay so now we see we have two files</font><font color="#E5E5E5"> one</font>

93
00:05:22,560 --> 00:05:28,349
<font color="#CCCCCC">is with the creds</font><font color="#E5E5E5"> so you can see the the</font>

94
00:05:26,340 --> 00:05:30,239
login and<font color="#CCCCCC"> the password you can later use</font>

95
00:05:28,349 --> 00:05:34,020
it to log in yourself if<font color="#E5E5E5"> you want I'll</font>

96
00:05:30,240 --> 00:05:36,720
probably<font color="#E5E5E5"> change it or not and then you</font>

97
00:05:34,020 --> 00:05:41,370
see the more the better part which<font color="#CCCCCC"> is</font>

98
00:05:36,720 --> 00:05:44,340
the the tokens so these are the the

99
00:05:41,370 --> 00:05:47,920
cookies<font color="#E5E5E5"> that Google</font><font color="#CCCCCC"> saves in the browser</font>

100
00:05:44,340 --> 00:05:49,780
to<font color="#CCCCCC"> make sure that the that</font><font color="#E5E5E5"> the client is</font>

101
00:05:47,920 --> 00:05:51,640
<font color="#CCCCCC">authenticate it so this</font><font color="#E5E5E5"> is basically</font>

102
00:05:49,780 --> 00:05:54,630
what what happens after the two-factor

103
00:05:51,640 --> 00:06:00,039
authentication is<font color="#CCCCCC"> a success so attacker</font>

104
00:05:54,630 --> 00:06:02,200
<font color="#CCCCCC">copies this authentication tokens</font><font color="#E5E5E5"> then</font>

105
00:06:00,040 --> 00:06:06,670
we're<font color="#E5E5E5"> gonna move to</font><font color="#CCCCCC"> the attacker browser</font>

106
00:06:02,200 --> 00:06:10,150
<font color="#CCCCCC">I will clear the cookies just</font><font color="#E5E5E5"> to make</font>

107
00:06:06,670 --> 00:06:11,710
<font color="#CCCCCC">sure that everything</font><font color="#E5E5E5"> is clean so first</font>

108
00:06:10,150 --> 00:06:16,390
I'll show<font color="#CCCCCC"> you what happens</font><font color="#E5E5E5"> when I open</font>

109
00:06:11,710 --> 00:06:19,810
Gmail<font color="#E5E5E5"> okay so Gmail just asked me to</font>

110
00:06:16,390 --> 00:06:22,390
<font color="#CCCCCC">login</font><font color="#E5E5E5"> so I am not logged in as as a as</font>

111
00:06:19,810 --> 00:06:25,780
<font color="#E5E5E5">the attacker so what I will do I will</font>

112
00:06:22,390 --> 00:06:29,919
<font color="#E5E5E5">clear the</font><font color="#CCCCCC"> cookies again</font><font color="#E5E5E5"> and I will use</font>

113
00:06:25,780 --> 00:06:34,109
the<font color="#E5E5E5"> Chrome extension to import the</font>

114
00:06:29,920 --> 00:06:37,870
cookies<font color="#CCCCCC"> that I just captured</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> Janusz</font>

115
00:06:34,110 --> 00:06:46,000
<font color="#CCCCCC">okay and now we were visiting Gmail</font>

116
00:06:37,870 --> 00:06:53,350
again and boom we are<font color="#CCCCCC"> jános bypassing</font>

117
00:06:46,000 --> 00:06:55,660
fully two-factor authentication so this

118
00:06:53,350 --> 00:06:58,240
is how it works

119
00:06:55,660 --> 00:07:00,460
why cookies<font color="#CCCCCC"> well I just</font><font color="#E5E5E5"> said like</font>

120
00:06:58,240 --> 00:07:02,550
because the browser needs to<font color="#E5E5E5"> verify</font>

121
00:07:00,460 --> 00:07:04,870
itself with<font color="#CCCCCC"> the web server</font><font color="#E5E5E5"> and</font>

122
00:07:02,550 --> 00:07:08,380
<font color="#E5E5E5">two-factor authentication method really</font>

123
00:07:04,870 --> 00:07:10,900
doesn't<font color="#E5E5E5"> matter because you</font><font color="#CCCCCC"> can use SMS</font>

124
00:07:08,380 --> 00:07:13,570
you can use<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> many different</font>

125
00:07:10,900 --> 00:07:15,669
<font color="#CCCCCC">kinds I think only you bicky's protects</font>

126
00:07:13,570 --> 00:07:18,610
you against this kind<font color="#E5E5E5"> of attack because</font>

127
00:07:15,670 --> 00:07:21,070
you<font color="#CCCCCC"> bicky's also check the</font><font color="#E5E5E5"> the URL in</font>

128
00:07:18,610 --> 00:07:22,990
the address bar that that it's that<font color="#E5E5E5"> the</font>

129
00:07:21,070 --> 00:07:25,480
credentials are pair it with and<font color="#E5E5E5"> won't</font>

130
00:07:22,990 --> 00:07:29,830
<font color="#E5E5E5">allow you to</font><font color="#CCCCCC"> enter the the</font><font color="#E5E5E5"> credentials</font>

131
00:07:25,480 --> 00:07:33,640
on<font color="#E5E5E5"> other website</font><font color="#CCCCCC"> I still and</font><font color="#E5E5E5"> so what can</font>

132
00:07:29,830 --> 00:07:39,930
the<font color="#E5E5E5"> like</font><font color="#CCCCCC"> websites</font><font color="#E5E5E5"> do to protect itself</font>

133
00:07:33,640 --> 00:07:42,460
against so last year<font color="#E5E5E5"> lead security like</font>

134
00:07:39,930 --> 00:07:46,350
executive<font color="#E5E5E5"> from Google contacted me how</font>

135
00:07:42,460 --> 00:07:50,469
can they fix that<font color="#CCCCCC"> and</font><font color="#E5E5E5"> apparently they</font>

136
00:07:46,350 --> 00:07:52,840
they fixed it<font color="#CCCCCC"> somehow and</font><font color="#E5E5E5"> I didn't check</font>

137
00:07:50,470 --> 00:07:55,660
so last month<font color="#E5E5E5"> I I checked it and this is</font>

138
00:07:52,840 --> 00:07:57,880
what you can<font color="#E5E5E5"> see this is</font><font color="#CCCCCC"> basically what</font>

139
00:07:55,660 --> 00:07:59,860
I found in<font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> JavaScript files</font>

140
00:07:57,880 --> 00:08:00,740
when it didn't<font color="#E5E5E5"> work so basically what</font>

141
00:07:59,860 --> 00:08:03,500
they

142
00:08:00,740 --> 00:08:06,650
figured out to do is they do<font color="#CCCCCC"> regular</font>

143
00:08:03,500 --> 00:08:09,380
<font color="#CCCCCC">expression on the URL</font><font color="#E5E5E5"> tab just to see if</font>

144
00:08:06,650 --> 00:08:12,320
it's not that fish domain<font color="#E5E5E5"> currently so</font>

145
00:08:09,380 --> 00:08:14,540
this was actually the<font color="#E5E5E5"> way to bypass</font><font color="#CCCCCC"> that</font>

146
00:08:12,320 --> 00:08:17,870
was to<font color="#E5E5E5"> just modify</font><font color="#CCCCCC"> this regular</font>

147
00:08:14,540 --> 00:08:20,960
expression on the fly<font color="#CCCCCC"> while being in</font><font color="#E5E5E5"> the</font>

148
00:08:17,870 --> 00:08:22,730
proxy and modifying all the data so in

149
00:08:20,960 --> 00:08:27,680
order<font color="#CCCCCC"> to better protect against it I</font>

150
00:08:22,730 --> 00:08:32,029
would advise doing<font color="#E5E5E5"> obfuscation of course</font>

151
00:08:27,680 --> 00:08:33,740
it's not<font color="#CCCCCC"> like fully fully the best</font>

152
00:08:32,029 --> 00:08:36,620
solution<font color="#E5E5E5"> but it will deter some</font>

153
00:08:33,740 --> 00:08:40,130
attackers and it will make the whole

154
00:08:36,620 --> 00:08:44,060
<font color="#CCCCCC">like replacement much much</font><font color="#E5E5E5"> much harder</font>

155
00:08:40,130 --> 00:08:46,390
<font color="#CCCCCC">thirty</font><font color="#E5E5E5"> seconds yeah I'm done okay great</font>

156
00:08:44,059 --> 00:08:46,390
thank<font color="#E5E5E5"> you</font>

157
00:08:47,970 --> 00:08:51,119
[Music]

