1
00:00:10,559 --> 00:00:14,959
thank you very much

2
00:00:12,240 --> 00:00:16,480
so hi everyone good morning good evening

3
00:00:14,960 --> 00:00:19,600
i'm not sure what time is it for you

4
00:00:16,480 --> 00:00:21,520
it's morning for me so good morning um

5
00:00:19,600 --> 00:00:23,600
the presentation i'm going to give you

6
00:00:21,520 --> 00:00:26,080
guys is titled

7
00:00:23,600 --> 00:00:27,680
my robot detecting the undetected using

8
00:00:26,080 --> 00:00:30,959
deep learning

9
00:00:27,680 --> 00:00:32,558
and i hope the title doesn't sound as

10
00:00:30,960 --> 00:00:33,200
bad as it is because i know cyber

11
00:00:32,558 --> 00:00:35,680
security

12
00:00:33,200 --> 00:00:37,760
researchers uh usually fear deep

13
00:00:35,680 --> 00:00:39,760
learning or machine learning and

14
00:00:37,760 --> 00:00:41,599
everything advertisement but i promise

15
00:00:39,760 --> 00:00:42,960
you this is not an advertisement

16
00:00:41,600 --> 00:00:45,360
uh presentation it's a completely

17
00:00:42,960 --> 00:00:49,920
technical talk

18
00:00:45,360 --> 00:00:52,559
so a little bit about myself my name is

19
00:00:49,920 --> 00:00:54,320
and i'm a security data science team

20
00:00:52,559 --> 00:00:56,959
lead at akamai technologies which i'll

21
00:00:54,320 --> 00:00:58,559
explain in a bit what does it mean

22
00:00:56,960 --> 00:01:00,800
i've been doing cyber security for a

23
00:00:58,559 --> 00:01:02,640
really long time probably ever since i

24
00:01:00,800 --> 00:01:06,720
was 18 years old

25
00:01:02,640 --> 00:01:09,439
and um a little bit about myself so

26
00:01:06,720 --> 00:01:10,400
i wanted to kind of describe how my day

27
00:01:09,439 --> 00:01:12,399
look

28
00:01:10,400 --> 00:01:13,439
days look now that uh we're in a

29
00:01:12,400 --> 00:01:16,000
pandemic and

30
00:01:13,439 --> 00:01:17,439
we're all at home so usually my day

31
00:01:16,000 --> 00:01:20,479
consists of botnets

32
00:01:17,439 --> 00:01:22,798
traffic data algorithms and

33
00:01:20,479 --> 00:01:24,240
personally i also enjoy reading and

34
00:01:22,799 --> 00:01:26,560
painting and

35
00:01:24,240 --> 00:01:27,360
also a bit of gaming i must admit so i

36
00:01:26,560 --> 00:01:30,479
hope

37
00:01:27,360 --> 00:01:32,560
you all can relate and

38
00:01:30,479 --> 00:01:34,560
i wanted to kind of explain my point of

39
00:01:32,560 --> 00:01:37,439
view and to give you an insight

40
00:01:34,560 --> 00:01:39,119
and why i'm doing what i'm doing so

41
00:01:37,439 --> 00:01:41,439
where i'm coming from

42
00:01:39,119 --> 00:01:42,880
is basically a dns empire which is

43
00:01:41,439 --> 00:01:45,600
akamai and

44
00:01:42,880 --> 00:01:47,360
how did they get to this point um maybe

45
00:01:45,600 --> 00:01:49,119
most of you know that akamai is

46
00:01:47,360 --> 00:01:50,479
one of the largest cdn providers which

47
00:01:49,119 --> 00:01:52,320
means that they have

48
00:01:50,479 --> 00:01:54,960
a lot of internet hosted on their

49
00:01:52,320 --> 00:01:56,960
servers and with time they evolved

50
00:01:54,960 --> 00:01:59,280
in understanding that they can create a

51
00:01:56,960 --> 00:02:00,079
lot of cyber security intelligence based

52
00:01:59,280 --> 00:02:02,640
on that

53
00:02:00,079 --> 00:02:03,119
um data and this is basically what i'm

54
00:02:02,640 --> 00:02:05,280
doing

55
00:02:03,119 --> 00:02:06,960
so i have probably one of the largest

56
00:02:05,280 --> 00:02:09,119
dns data sets in the world and i

57
00:02:06,960 --> 00:02:10,079
have the privilege of looking for cyber

58
00:02:09,119 --> 00:02:12,319
security threats

59
00:02:10,080 --> 00:02:13,440
over this data and then essentially

60
00:02:12,319 --> 00:02:17,040
block it for

61
00:02:13,440 --> 00:02:18,800
everyone here so

62
00:02:17,040 --> 00:02:20,959
i would like to keep in mind during this

63
00:02:18,800 --> 00:02:23,360
presentation that

64
00:02:20,959 --> 00:02:25,840
my point of view is just massive amounts

65
00:02:23,360 --> 00:02:27,680
of dns traffic http traffic specifically

66
00:02:25,840 --> 00:02:30,000
here it's dns but

67
00:02:27,680 --> 00:02:31,120
like massive amounts of traffic and keep

68
00:02:30,000 --> 00:02:33,840
that in mind while

69
00:02:31,120 --> 00:02:35,680
go through the presentation so what are

70
00:02:33,840 --> 00:02:37,840
we going to cover today

71
00:02:35,680 --> 00:02:39,840
so first of all first of all i'm going

72
00:02:37,840 --> 00:02:41,120
to introduce you to a botnet called milo

73
00:02:39,840 --> 00:02:43,120
both and i'm not sure

74
00:02:41,120 --> 00:02:44,319
any of you have ever heard this name

75
00:02:43,120 --> 00:02:45,760
before

76
00:02:44,319 --> 00:02:47,359
then i'm going to go over a little bit

77
00:02:45,760 --> 00:02:49,920
in short what is a dga

78
00:02:47,360 --> 00:02:50,959
in case some of you might not know what

79
00:02:49,920 --> 00:02:52,799
it means and

80
00:02:50,959 --> 00:02:54,800
how did the defense community tackle

81
00:02:52,800 --> 00:02:55,840
this problem so far

82
00:02:54,800 --> 00:02:58,560
then i'm going to talk about

83
00:02:55,840 --> 00:02:59,760
specifically how we at akamai and i

84
00:02:58,560 --> 00:03:02,640
specifically

85
00:02:59,760 --> 00:03:04,879
tackle this issue i'm going to report

86
00:03:02,640 --> 00:03:05,760
results in the wild this is not just an

87
00:03:04,879 --> 00:03:07,840
algorithmic

88
00:03:05,760 --> 00:03:08,799
conversation this is like real reporting

89
00:03:07,840 --> 00:03:11,760
and real results

90
00:03:08,800 --> 00:03:14,000
and i will go over in details

91
00:03:11,760 --> 00:03:17,280
specifically about milo but just think

92
00:03:14,000 --> 00:03:20,560
uh you all find very interesting

93
00:03:17,280 --> 00:03:22,000
so what is milobot back at the end of

94
00:03:20,560 --> 00:03:24,319
2018

95
00:03:22,000 --> 00:03:25,680
there were a lot of reports or a few

96
00:03:24,319 --> 00:03:28,159
reports about this new

97
00:03:25,680 --> 00:03:29,360
emerging bot net um you can see some

98
00:03:28,159 --> 00:03:31,840
vendors like

99
00:03:29,360 --> 00:03:33,440
um centurylink trend micro and morphe

100
00:03:31,840 --> 00:03:36,080
sec and deep instinct and you see

101
00:03:33,440 --> 00:03:38,000
you can see um a lot of vlogging about

102
00:03:36,080 --> 00:03:40,400
it and then we're talking about how

103
00:03:38,000 --> 00:03:42,080
sophisticated it is i know uh we just

104
00:03:40,400 --> 00:03:43,360
talked about the sophisticated term

105
00:03:42,080 --> 00:03:47,040
being abused but

106
00:03:43,360 --> 00:03:48,239
um you can see that the specific botnet

107
00:03:47,040 --> 00:03:50,079
that they reported and

108
00:03:48,239 --> 00:03:51,840
this is specifically taken from the blog

109
00:03:50,080 --> 00:03:54,720
written by deep instinct

110
00:03:51,840 --> 00:03:57,120
that it was infused with a lot of

111
00:03:54,720 --> 00:03:58,799
evasion techniques so it had anti-vm and

112
00:03:57,120 --> 00:04:00,080
anti-debugging and code injection and

113
00:03:58,799 --> 00:04:02,959
process hollowing and

114
00:04:00,080 --> 00:04:04,879
so on and so forth but specifically for

115
00:04:02,959 --> 00:04:05,519
the communication part of the network

116
00:04:04,879 --> 00:04:07,040
part which

117
00:04:05,519 --> 00:04:08,400
you can all understand this is what i'm

118
00:04:07,040 --> 00:04:10,000
interested in because i come from the

119
00:04:08,400 --> 00:04:13,519
network point of view

120
00:04:10,000 --> 00:04:16,639
they used two specific techniques

121
00:04:13,519 --> 00:04:18,079
performed to evade network defense

122
00:04:16,639 --> 00:04:20,400
mechanisms such as

123
00:04:18,079 --> 00:04:22,400
delaying the cnc communication and also

124
00:04:20,399 --> 00:04:25,599
a dga

125
00:04:22,400 --> 00:04:27,919
so what is a dga let's go back a sec

126
00:04:25,600 --> 00:04:29,040
a second so here on the left on the

127
00:04:27,919 --> 00:04:32,240
screen you can see

128
00:04:29,040 --> 00:04:34,160
a computer that i the bot master

129
00:04:32,240 --> 00:04:36,080
managed to infect and you can see that

130
00:04:34,160 --> 00:04:36,960
there is a client on there or malware

131
00:04:36,080 --> 00:04:38,639
and

132
00:04:36,960 --> 00:04:40,880
it obviously needs to communicate with a

133
00:04:38,639 --> 00:04:42,800
server in some kind of manner and form

134
00:04:40,880 --> 00:04:46,000
the command control channel

135
00:04:42,800 --> 00:04:48,479
and let's assume that i

136
00:04:46,000 --> 00:04:51,120
managed to create this channel using

137
00:04:48,479 --> 00:04:52,880
this domain name botmaster.com

138
00:04:51,120 --> 00:04:55,360
and this is a way for me to tell about

139
00:04:52,880 --> 00:04:55,759
the bot or the malware what i wanted to

140
00:04:55,360 --> 00:04:58,080
do

141
00:04:55,759 --> 00:04:59,600
and send me data in return but i think

142
00:04:58,080 --> 00:05:00,800
we can all obviously intuitively

143
00:04:59,600 --> 00:05:04,160
understand that

144
00:05:00,800 --> 00:05:07,039
if as a defenser if as a as a defense

145
00:05:04,160 --> 00:05:09,280
uh system i were to detect this botnet

146
00:05:07,039 --> 00:05:10,159
or this domain as relating to malicious

147
00:05:09,280 --> 00:05:13,359
activity

148
00:05:10,160 --> 00:05:15,840
i can simply block it for eternity

149
00:05:13,360 --> 00:05:16,800
and then this botnet wouldn't be

150
00:05:15,840 --> 00:05:19,520
operating at all

151
00:05:16,800 --> 00:05:21,919
so this is a one point failure for this

152
00:05:19,520 --> 00:05:25,758
botnet and this operation so obviously

153
00:05:21,919 --> 00:05:26,560
attackers would want to avoid the scheme

154
00:05:25,759 --> 00:05:30,160
of defense

155
00:05:26,560 --> 00:05:32,160
and this is why djs were invented

156
00:05:30,160 --> 00:05:34,160
what is a dj it's an acronym that stands

157
00:05:32,160 --> 00:05:36,400
for domain generation algorithm

158
00:05:34,160 --> 00:05:38,080
it's a piece of code that attackers

159
00:05:36,400 --> 00:05:40,000
write into their malwares

160
00:05:38,080 --> 00:05:41,680
that their whole goal is to create

161
00:05:40,000 --> 00:05:45,039
create a really large list

162
00:05:41,680 --> 00:05:47,919
of really random looking domain names

163
00:05:45,039 --> 00:05:48,479
but the key sauce here is that it's not

164
00:05:47,919 --> 00:05:50,479
actually

165
00:05:48,479 --> 00:05:54,400
random it's something that is quite

166
00:05:50,479 --> 00:05:56,639
predictable based on a key or a seed or

167
00:05:54,400 --> 00:05:58,719
something that is shared between both

168
00:05:56,639 --> 00:06:02,160
parties the client and server

169
00:05:58,720 --> 00:06:02,880
and it makes it available for them to

170
00:06:02,160 --> 00:06:04,960
understand

171
00:06:02,880 --> 00:06:06,240
which domains are going to be created

172
00:06:04,960 --> 00:06:09,680
every day

173
00:06:06,240 --> 00:06:11,520
so say we're waking up day number one

174
00:06:09,680 --> 00:06:13,680
the mother woke up or the client and the

175
00:06:11,520 --> 00:06:15,520
server the attacker woke up as well

176
00:06:13,680 --> 00:06:17,440
they both run the same code using the

177
00:06:15,520 --> 00:06:18,880
same key so they generate the same list

178
00:06:17,440 --> 00:06:21,360
of domain names

179
00:06:18,880 --> 00:06:22,479
and because they are so randomly looking

180
00:06:21,360 --> 00:06:24,160
most of them are not going to be

181
00:06:22,479 --> 00:06:26,639
registered so you can see that most of

182
00:06:24,160 --> 00:06:27,280
them have the nx response for the dns

183
00:06:26,639 --> 00:06:28,880
query

184
00:06:27,280 --> 00:06:31,039
but only one of them is going to be to

185
00:06:28,880 --> 00:06:32,639
have an ibm the way that that happened

186
00:06:31,039 --> 00:06:35,039
is that the attacker

187
00:06:32,639 --> 00:06:36,720
or the server the bot master only needs

188
00:06:35,039 --> 00:06:39,840
to pick one of those domains

189
00:06:36,720 --> 00:06:40,479
to perform uh the communication on for

190
00:06:39,840 --> 00:06:42,318
that day

191
00:06:40,479 --> 00:06:44,318
so what the attacker does is that they

192
00:06:42,319 --> 00:06:47,120
choose a randomly domain

193
00:06:44,319 --> 00:06:48,880
out of that huge list they register it

194
00:06:47,120 --> 00:06:50,639
and then when the client queries

195
00:06:48,880 --> 00:06:52,159
all of those domains one of them is

196
00:06:50,639 --> 00:06:53,280
actually going to form the communication

197
00:06:52,160 --> 00:06:54,960
channel so

198
00:06:53,280 --> 00:06:56,559
one of them is actually going to be

199
00:06:54,960 --> 00:06:57,359
successful at communicating with the

200
00:06:56,560 --> 00:06:59,840
server

201
00:06:57,360 --> 00:07:00,560
now day number two the same thing

202
00:06:59,840 --> 00:07:03,520
happens

203
00:07:00,560 --> 00:07:04,800
but a completely new set of domains is

204
00:07:03,520 --> 00:07:07,198
created

205
00:07:04,800 --> 00:07:08,960
so again the attacker needs to choose

206
00:07:07,199 --> 00:07:10,800
one of those domains register them and

207
00:07:08,960 --> 00:07:13,120
then this is going to be used

208
00:07:10,800 --> 00:07:14,400
for the dj for the command control

209
00:07:13,120 --> 00:07:18,560
communication

210
00:07:14,400 --> 00:07:21,599
now this scheme makes us defenders

211
00:07:18,560 --> 00:07:23,280
um needing to detect those domains and

212
00:07:21,599 --> 00:07:25,759
block them

213
00:07:23,280 --> 00:07:26,400
essentially day one like we need to

214
00:07:25,759 --> 00:07:28,080
block it

215
00:07:26,400 --> 00:07:29,520
five minutes after it happened or the

216
00:07:28,080 --> 00:07:30,719
second it happens we need to understand

217
00:07:29,520 --> 00:07:32,479
that this is happening

218
00:07:30,720 --> 00:07:34,240
because tomorrow it's not going to be

219
00:07:32,479 --> 00:07:35,359
relevant anymore the domain is going to

220
00:07:34,240 --> 00:07:38,080
be different and

221
00:07:35,360 --> 00:07:40,400
i need to be able to detect this

222
00:07:38,080 --> 00:07:43,120
continuously and over time

223
00:07:40,400 --> 00:07:45,440
so this evasion technique specifically

224
00:07:43,120 --> 00:07:45,919
is obviously very visible in the dns

225
00:07:45,440 --> 00:07:48,479
level

226
00:07:45,919 --> 00:07:49,758
and mind you that i come from the dns

227
00:07:48,479 --> 00:07:51,199
empire so obviously this is

228
00:07:49,759 --> 00:07:53,599
an issue that is really interesting to

229
00:07:51,199 --> 00:07:56,240
us and to circle back

230
00:07:53,599 --> 00:07:57,360
milobot was using this technique this

231
00:07:56,240 --> 00:07:59,280
invasion technique

232
00:07:57,360 --> 00:08:00,639
as one of those techniques that um they

233
00:07:59,280 --> 00:08:02,799
were using

234
00:08:00,639 --> 00:08:06,240
so how did the defense community

235
00:08:02,800 --> 00:08:09,759
community tackle this problem so far

236
00:08:06,240 --> 00:08:13,520
so um this is a snapshot

237
00:08:09,759 --> 00:08:15,280
of um this is like a photo from a github

238
00:08:13,520 --> 00:08:17,120
uh that belongs to a fellow researcher

239
00:08:15,280 --> 00:08:17,520
that i really appreciate called butterca

240
00:08:17,120 --> 00:08:21,199
so

241
00:08:17,520 --> 00:08:22,159
shout out to you and this is an example

242
00:08:21,199 --> 00:08:23,440
of what the

243
00:08:22,160 --> 00:08:25,440
research community and the defense

244
00:08:23,440 --> 00:08:27,520
community used to do so far for evading

245
00:08:25,440 --> 00:08:30,400
dga based malware so

246
00:08:27,520 --> 00:08:32,958
once we were able to get a hold of a

247
00:08:30,400 --> 00:08:33,679
malware of a binary that has a dj code

248
00:08:32,958 --> 00:08:36,000
in it

249
00:08:33,679 --> 00:08:37,519
we can essentially reverse engineer it

250
00:08:36,000 --> 00:08:39,679
down to the

251
00:08:37,519 --> 00:08:40,880
specific vga code and then re-implement

252
00:08:39,679 --> 00:08:42,319
it in python

253
00:08:40,880 --> 00:08:44,640
and this is what you can see here from

254
00:08:42,320 --> 00:08:47,279
hit kitkat from his github

255
00:08:44,640 --> 00:08:48,880
and what's interesting here is that once

256
00:08:47,279 --> 00:08:51,279
you have this code

257
00:08:48,880 --> 00:08:52,640
you can use this code to generate all

258
00:08:51,279 --> 00:08:54,560
the domain names that are going to be

259
00:08:52,640 --> 00:08:56,480
created right but that's not

260
00:08:54,560 --> 00:08:58,479
entirely true because you also need the

261
00:08:56,480 --> 00:09:00,240
key the seed that would create this list

262
00:08:58,480 --> 00:09:02,399
of domains so

263
00:09:00,240 --> 00:09:04,320
this branches out to two types of

264
00:09:02,399 --> 00:09:05,120
scenarios the first one is that i have

265
00:09:04,320 --> 00:09:08,080
the key

266
00:09:05,120 --> 00:09:09,680
and therefore i can simply generate the

267
00:09:08,080 --> 00:09:12,240
domains every day and then

268
00:09:09,680 --> 00:09:13,120
block them ahead of time this is really

269
00:09:12,240 --> 00:09:15,040
useful

270
00:09:13,120 --> 00:09:16,320
but the second branch or type of

271
00:09:15,040 --> 00:09:19,360
scenario is that

272
00:09:16,320 --> 00:09:21,200
we might not have the seed in which case

273
00:09:19,360 --> 00:09:23,680
we would either need to

274
00:09:21,200 --> 00:09:24,480
brute force it or kind of break the

275
00:09:23,680 --> 00:09:27,120
scene

276
00:09:24,480 --> 00:09:29,440
or that or we'll be sad because we will

277
00:09:27,120 --> 00:09:31,040
have the code but we are not able to

278
00:09:29,440 --> 00:09:33,200
create the domains that are going to be

279
00:09:31,040 --> 00:09:36,480
created tomorrow so

280
00:09:33,200 --> 00:09:37,360
for the brute forcing part assuming you

281
00:09:36,480 --> 00:09:39,680
have really

282
00:09:37,360 --> 00:09:40,720
massive amount of compute computational

283
00:09:39,680 --> 00:09:43,279
sources

284
00:09:40,720 --> 00:09:44,080
um you are able usually you should be

285
00:09:43,279 --> 00:09:46,399
able to

286
00:09:44,080 --> 00:09:47,519
break these seeds based on the patterns

287
00:09:46,399 --> 00:09:51,120
if you have traffic

288
00:09:47,519 --> 00:09:53,279
so say i have a massive amount of dns

289
00:09:51,120 --> 00:09:55,440
traffics and i know how the patterns are

290
00:09:53,279 --> 00:09:57,360
are going to look i can look for a very

291
00:09:55,440 --> 00:09:59,200
narrow specific space

292
00:09:57,360 --> 00:10:00,800
and try to understand that this pattern

293
00:09:59,200 --> 00:10:01,920
could belong to the specific malware and

294
00:10:00,800 --> 00:10:04,319
this is the code

295
00:10:01,920 --> 00:10:05,360
and then try to break the c but this is

296
00:10:04,320 --> 00:10:07,760
essentially

297
00:10:05,360 --> 00:10:09,440
the first let's call it real solution

298
00:10:07,760 --> 00:10:13,279
for handling dga based on

299
00:10:09,440 --> 00:10:14,720
um malwares but there were two inherent

300
00:10:13,279 --> 00:10:17,680
issues here

301
00:10:14,720 --> 00:10:19,360
the first one is that how does it detect

302
00:10:17,680 --> 00:10:21,439
new malwares like how does it detect

303
00:10:19,360 --> 00:10:23,040
malwares that are using dgas and we see

304
00:10:21,440 --> 00:10:24,800
the pattern in traffic but

305
00:10:23,040 --> 00:10:26,640
we've never seen it before we don't have

306
00:10:24,800 --> 00:10:27,680
the sample we we don't have the reverse

307
00:10:26,640 --> 00:10:29,519
of it

308
00:10:27,680 --> 00:10:31,199
and what about djs who weren't able to

309
00:10:29,519 --> 00:10:33,440
break their c like

310
00:10:31,200 --> 00:10:34,399
i have the sample this is so frustrating

311
00:10:33,440 --> 00:10:36,480
like i know

312
00:10:34,399 --> 00:10:37,440
how the malware looks but i'm not able

313
00:10:36,480 --> 00:10:40,079
to create those

314
00:10:37,440 --> 00:10:41,519
cnc domains ahead of time because i

315
00:10:40,079 --> 00:10:42,640
weren't able to break the scene this is

316
00:10:41,519 --> 00:10:44,480
ridiculous like

317
00:10:42,640 --> 00:10:46,240
i have so much information and yet i'm

318
00:10:44,480 --> 00:10:49,279
still helpless

319
00:10:46,240 --> 00:10:52,079
so at this point let's say that

320
00:10:49,279 --> 00:10:54,560
we have a goal that is three-fold for

321
00:10:52,079 --> 00:10:58,479
not trying to create a new mechanism for

322
00:10:54,560 --> 00:11:00,479
um handling dj-based malwares so

323
00:10:58,480 --> 00:11:01,519
my first goal would be that i want to be

324
00:11:00,480 --> 00:11:04,720
able to block

325
00:11:01,519 --> 00:11:06,560
domains that um of malwares that i do

326
00:11:04,720 --> 00:11:07,040
have their sample and i do know their

327
00:11:06,560 --> 00:11:09,599
patent

328
00:11:07,040 --> 00:11:11,199
but i just couldn't break them the

329
00:11:09,600 --> 00:11:12,480
second goal here would be that i want to

330
00:11:11,200 --> 00:11:13,920
be able to detect the new

331
00:11:12,480 --> 00:11:15,680
malwares like i want to be able to

332
00:11:13,920 --> 00:11:18,959
understand that this is a malware that

333
00:11:15,680 --> 00:11:22,000
is using a dj that was never seen before

334
00:11:18,959 --> 00:11:22,719
and a bonus goal here would be what if i

335
00:11:22,000 --> 00:11:25,600
could also

336
00:11:22,720 --> 00:11:25,920
detect and block in traffic everything

337
00:11:25,600 --> 00:11:28,480
that

338
00:11:25,920 --> 00:11:31,120
it is already known because in this case

339
00:11:28,480 --> 00:11:34,720
we would have a holistic system

340
00:11:31,120 --> 00:11:36,480
that is basically diminishing the dga

341
00:11:34,720 --> 00:11:38,560
problem to zero like it wouldn't be an

342
00:11:36,480 --> 00:11:41,200
issue so you want a holistic system that

343
00:11:38,560 --> 00:11:43,040
would block dj domains in traffic

344
00:11:41,200 --> 00:11:45,920
so let's solve this together like let's

345
00:11:43,040 --> 00:11:49,680
do some uh exercise together maybe

346
00:11:45,920 --> 00:11:51,360
so i think my first intuition was

347
00:11:49,680 --> 00:11:53,120
wait but it doesn't it didn't look

348
00:11:51,360 --> 00:11:54,720
anything like the domains that i query

349
00:11:53,120 --> 00:11:57,120
in traffic usually like

350
00:11:54,720 --> 00:11:58,320
it looks completely gibberish i should

351
00:11:57,120 --> 00:11:59,200
be able to understand that this is

352
00:11:58,320 --> 00:12:02,320
coming from a

353
00:11:59,200 --> 00:12:04,639
dj based only on that intuition

354
00:12:02,320 --> 00:12:06,000
and if we formalize this intuition what

355
00:12:04,639 --> 00:12:08,560
you can see here

356
00:12:06,000 --> 00:12:10,160
is the distribution and frequency of

357
00:12:08,560 --> 00:12:12,638
using characters

358
00:12:10,160 --> 00:12:14,719
in domain names in those dga-based

359
00:12:12,639 --> 00:12:18,160
manners and you can see a pretty

360
00:12:14,720 --> 00:12:21,120
old version of all malwares here

361
00:12:18,160 --> 00:12:22,079
so you can see here that for the timba

362
00:12:21,120 --> 00:12:24,000
example

363
00:12:22,079 --> 00:12:25,519
there is a uniform distribution between

364
00:12:24,000 --> 00:12:27,760
the letters a and z which means that we

365
00:12:25,519 --> 00:12:30,720
are using all of the letters in the same

366
00:12:27,760 --> 00:12:32,079
amount of uh like the same frequency now

367
00:12:30,720 --> 00:12:33,920
obviously this looks

368
00:12:32,079 --> 00:12:35,279
nothing like the english natural

369
00:12:33,920 --> 00:12:36,880
language or nothing like

370
00:12:35,279 --> 00:12:40,320
all the domains we're usually using

371
00:12:36,880 --> 00:12:43,040
because for example we use a lot more

372
00:12:40,320 --> 00:12:44,800
vowels or we use a lot more there's a

373
00:12:43,040 --> 00:12:45,040
lot more letters that we use frequently

374
00:12:44,800 --> 00:12:46,880
and

375
00:12:45,040 --> 00:12:48,719
infrequently so obviously this looks

376
00:12:46,880 --> 00:12:50,959
very different from any other domain

377
00:12:48,720 --> 00:12:52,240
we're going to see and for the dire

378
00:12:50,959 --> 00:12:54,399
example you can see that they're

379
00:12:52,240 --> 00:12:55,839
using hexa characters like this is

380
00:12:54,399 --> 00:12:56,959
obviously not something we're using

381
00:12:55,839 --> 00:12:59,600
usually

382
00:12:56,959 --> 00:13:00,560
in language or in domain names so both

383
00:12:59,600 --> 00:13:03,040
of these should be

384
00:13:00,560 --> 00:13:04,479
pretty easy to detect uh in traffic

385
00:13:03,040 --> 00:13:07,199
because they look very different from

386
00:13:04,480 --> 00:13:10,000
what we're usually using

387
00:13:07,200 --> 00:13:11,760
but attackers aren't dumb like they

388
00:13:10,000 --> 00:13:13,200
understand exactly everything that we

389
00:13:11,760 --> 00:13:16,079
understand as well

390
00:13:13,200 --> 00:13:18,240
and they adapt so here you can see

391
00:13:16,079 --> 00:13:20,000
example of two other dga based malwares

392
00:13:18,240 --> 00:13:22,639
that adapted and they said okay

393
00:13:20,000 --> 00:13:24,160
i'm not stupid i'm going to use the

394
00:13:22,639 --> 00:13:26,240
characters i'm randomly

395
00:13:24,160 --> 00:13:28,560
choosing but i'm going to make it look

396
00:13:26,240 --> 00:13:31,120
exactly like all of the domains and talk

397
00:13:28,560 --> 00:13:34,399
i'll let someone meet in popular domains

398
00:13:31,120 --> 00:13:35,920
so our former intuition or heuristic

399
00:13:34,399 --> 00:13:36,880
wouldn't have worked because now it

400
00:13:35,920 --> 00:13:38,719
looks exactly

401
00:13:36,880 --> 00:13:40,240
like everything that we usually query in

402
00:13:38,720 --> 00:13:42,079
traffic

403
00:13:40,240 --> 00:13:44,480
but wait we're still smarter than that

404
00:13:42,079 --> 00:13:46,000
like we we can do better right so

405
00:13:44,480 --> 00:13:48,240
i'm gonna look at the two characters

406
00:13:46,000 --> 00:13:50,959
distribution like how every two

407
00:13:48,240 --> 00:13:52,800
concatenated characters frequently are

408
00:13:50,959 --> 00:13:54,399
looking in the domain names

409
00:13:52,800 --> 00:13:55,920
and again you can see okay this is a

410
00:13:54,399 --> 00:13:56,480
heuristic that could work because you

411
00:13:55,920 --> 00:13:57,920
can see

412
00:13:56,480 --> 00:14:02,000
there is a major difference between

413
00:13:57,920 --> 00:14:04,719
alexa top 1 million and this dga

414
00:14:02,000 --> 00:14:05,440
again attackers are adapting and here

415
00:14:04,720 --> 00:14:07,279
you can see

416
00:14:05,440 --> 00:14:09,519
another version of this specific dga

417
00:14:07,279 --> 00:14:11,040
based malware and they adapt it now this

418
00:14:09,519 --> 00:14:13,360
heuristic wouldn't work because there's

419
00:14:11,040 --> 00:14:17,599
no way to distinguish between the two

420
00:14:13,360 --> 00:14:19,199
so my my main intuition here is that

421
00:14:17,600 --> 00:14:20,720
this cat and mouse game

422
00:14:19,199 --> 00:14:22,560
we need something stronger we need

423
00:14:20,720 --> 00:14:24,320
something better we need something

424
00:14:22,560 --> 00:14:26,560
um that would understand the pattern in

425
00:14:24,320 --> 00:14:30,480
a more profound way than just this

426
00:14:26,560 --> 00:14:33,920
very basic heuristic so

427
00:14:30,480 --> 00:14:35,839
deep learning to the rescue um so deep

428
00:14:33,920 --> 00:14:39,120
learning algorithms and models

429
00:14:35,839 --> 00:14:42,000
are used to model really interesting um

430
00:14:39,120 --> 00:14:43,199
phenomenas and specifically here we

431
00:14:42,000 --> 00:14:44,880
understood that we want to

432
00:14:43,199 --> 00:14:46,560
model a phenomena that is a pattern

433
00:14:44,880 --> 00:14:47,600
recognition phenomena like we want to

434
00:14:46,560 --> 00:14:49,760
understand

435
00:14:47,600 --> 00:14:51,199
essentially the regular expression that

436
00:14:49,760 --> 00:14:52,959
we're seeing in traffic

437
00:14:51,199 --> 00:14:54,399
and this is why we chose a specific

438
00:14:52,959 --> 00:14:57,040
neural network which is an

439
00:14:54,399 --> 00:14:58,480
lstm architecture that is specifically

440
00:14:57,040 --> 00:15:01,599
designed for understanding

441
00:14:58,480 --> 00:15:03,040
patterns in sequences and we were hoping

442
00:15:01,600 --> 00:15:03,519
that if we would show this neural

443
00:15:03,040 --> 00:15:05,760
network

444
00:15:03,519 --> 00:15:07,839
enough data about domains that are

445
00:15:05,760 --> 00:15:08,399
generated by dgas and domains that are

446
00:15:07,839 --> 00:15:10,000
not

447
00:15:08,399 --> 00:15:12,000
it would understand the patterns that

448
00:15:10,000 --> 00:15:14,880
it's seeing and therefore understand

449
00:15:12,000 --> 00:15:15,519
if it's coming from a dg or not and this

450
00:15:14,880 --> 00:15:18,560
idea

451
00:15:15,519 --> 00:15:20,320
was first published by um end game

452
00:15:18,560 --> 00:15:23,040
and you can see the paper here and it

453
00:15:20,320 --> 00:15:25,920
was a really interesting idea because

454
00:15:23,040 --> 00:15:27,680
maybe we can progress into understanding

455
00:15:25,920 --> 00:15:29,759
that the pattern is wrong

456
00:15:27,680 --> 00:15:31,839
and not just understanding that the

457
00:15:29,759 --> 00:15:34,880
distribution is wrong

458
00:15:31,839 --> 00:15:37,600
so what we did uh

459
00:15:34,880 --> 00:15:38,880
based on this idea is it said okay we

460
00:15:37,600 --> 00:15:41,199
need to train this

461
00:15:38,880 --> 00:15:42,639
neural network and try it ourselves and

462
00:15:41,199 --> 00:15:44,560
we're going to tweak it to honor

463
00:15:42,639 --> 00:15:46,639
to our understanding because one of the

464
00:15:44,560 --> 00:15:47,680
problems with for example academic

465
00:15:46,639 --> 00:15:50,160
research which

466
00:15:47,680 --> 00:15:51,279
again i applaud them and um i think the

467
00:15:50,160 --> 00:15:54,079
research is beautiful

468
00:15:51,279 --> 00:15:54,880
is that usually when you take it out to

469
00:15:54,079 --> 00:15:56,880
the real world

470
00:15:54,880 --> 00:15:59,519
specifically for a platform like akamai

471
00:15:56,880 --> 00:16:01,279
which is huge and so much traffic

472
00:15:59,519 --> 00:16:02,720
then you're gonna see some phenomena

473
00:16:01,279 --> 00:16:04,480
that you didn't expect and a lot of

474
00:16:02,720 --> 00:16:05,199
noise then all of these models are not

475
00:16:04,480 --> 00:16:07,600
really working

476
00:16:05,199 --> 00:16:08,479
so it was a real challenge taking this

477
00:16:07,600 --> 00:16:10,160
idea

478
00:16:08,480 --> 00:16:11,680
and then formulating it in a way that

479
00:16:10,160 --> 00:16:15,120
can actually use

480
00:16:11,680 --> 00:16:18,239
to detect and block traffic for

481
00:16:15,120 --> 00:16:20,720
everyone so what we did is that we

482
00:16:18,240 --> 00:16:22,560
compiled a data set and we wanted to

483
00:16:20,720 --> 00:16:24,399
teach the neural network to understand

484
00:16:22,560 --> 00:16:26,079
how does a dga that's coming from

485
00:16:24,399 --> 00:16:28,000
how does the domain that's coming from a

486
00:16:26,079 --> 00:16:30,000
dga look like

487
00:16:28,000 --> 00:16:32,079
and what you can see here is that we

488
00:16:30,000 --> 00:16:34,480
built a data set

489
00:16:32,079 --> 00:16:35,359
that is half dj domains and half benign

490
00:16:34,480 --> 00:16:37,360
domains

491
00:16:35,360 --> 00:16:40,240
now the dji domains i gave her an

492
00:16:37,360 --> 00:16:43,519
example um there's a dji archive

493
00:16:40,240 --> 00:16:44,880
um that everyone can go and take and i

494
00:16:43,519 --> 00:16:46,320
hope that maybe

495
00:16:44,880 --> 00:16:48,240
inspired by this talk you're going to

496
00:16:46,320 --> 00:16:50,959
try it try it yourself

497
00:16:48,240 --> 00:16:53,440
we specifically took our own proprietary

498
00:16:50,959 --> 00:16:54,959
and your djs that we see in traffic but

499
00:16:53,440 --> 00:16:57,040
i wanted to give an example of something

500
00:16:54,959 --> 00:16:58,719
open source that maybe all of you are

501
00:16:57,040 --> 00:17:02,160
inspired to use

502
00:16:58,720 --> 00:17:04,240
and then on the benign case at akamai we

503
00:17:02,160 --> 00:17:07,280
took normal traffic but you can check

504
00:17:04,240 --> 00:17:08,799
take alexa top 1 million for example and

505
00:17:07,280 --> 00:17:10,160
we fitted to the neural network that i

506
00:17:08,799 --> 00:17:11,359
just showed you in the architecture that

507
00:17:10,160 --> 00:17:13,280
i talked about

508
00:17:11,359 --> 00:17:16,159
and we received like achieved really

509
00:17:13,280 --> 00:17:19,599
great accuracy it was a it was above 90

510
00:17:16,160 --> 00:17:21,600
accuracy but one of the um

511
00:17:19,599 --> 00:17:22,958
misfortunes or one of the results

512
00:17:21,599 --> 00:17:24,799
weren't happy about

513
00:17:22,959 --> 00:17:26,559
is that it wasn't able to classify

514
00:17:24,799 --> 00:17:27,359
exactly which malware family it came

515
00:17:26,559 --> 00:17:30,639
from

516
00:17:27,359 --> 00:17:33,918
now think about it from your um

517
00:17:30,640 --> 00:17:35,280
defense hat when you alert your

518
00:17:33,919 --> 00:17:37,840
uh i don't know the person you're

519
00:17:35,280 --> 00:17:39,280
defending that they have a dji based

520
00:17:37,840 --> 00:17:41,120
malware in their computer

521
00:17:39,280 --> 00:17:42,720
it's not enough to block the traffic you

522
00:17:41,120 --> 00:17:44,639
need to be able to tell them

523
00:17:42,720 --> 00:17:46,080
exactly which malware is issuing the

524
00:17:44,640 --> 00:17:47,760
square because they need to be able to

525
00:17:46,080 --> 00:17:48,399
mitigate the risk they need to be able

526
00:17:47,760 --> 00:17:50,480
to

527
00:17:48,400 --> 00:17:51,679
go back to their computer and remove the

528
00:17:50,480 --> 00:17:53,919
threat

529
00:17:51,679 --> 00:17:55,840
and it's not enough to just say okay i

530
00:17:53,919 --> 00:17:56,880
blocked it it's a lot of work and it's a

531
00:17:55,840 --> 00:17:59,600
great like

532
00:17:56,880 --> 00:18:00,480
we did the 80 probably but we have to

533
00:17:59,600 --> 00:18:03,678
help them

534
00:18:00,480 --> 00:18:04,880
mitigate the threat now this is a really

535
00:18:03,679 --> 00:18:07,840
difficult task

536
00:18:04,880 --> 00:18:08,880
and i wanted to understand if i took

537
00:18:07,840 --> 00:18:11,360
this

538
00:18:08,880 --> 00:18:12,640
massive deep learning architecture that

539
00:18:11,360 --> 00:18:14,559
is supposed to be like

540
00:18:12,640 --> 00:18:16,640
the biggest gun i can use against this

541
00:18:14,559 --> 00:18:18,639
problem why couldn't it classify it like

542
00:18:16,640 --> 00:18:20,559
it made no sense

543
00:18:18,640 --> 00:18:22,080
so this is probably the most

544
00:18:20,559 --> 00:18:24,720
mathematical

545
00:18:22,080 --> 00:18:25,840
um slide in this presentation so please

546
00:18:24,720 --> 00:18:29,200
bear with me

547
00:18:25,840 --> 00:18:30,799
but i try to understand why is it so

548
00:18:29,200 --> 00:18:33,120
difficult so i could understand

549
00:18:30,799 --> 00:18:37,039
potentially how can i solve this problem

550
00:18:33,120 --> 00:18:40,320
as well now it should be noticed no no

551
00:18:37,039 --> 00:18:42,160
it should be noted that um

552
00:18:40,320 --> 00:18:44,399
solving this issue of classifying

553
00:18:42,160 --> 00:18:47,440
exactly which memory it came from

554
00:18:44,400 --> 00:18:50,320
is an issue that nobody solved before

555
00:18:47,440 --> 00:18:50,559
so i took the neural network and i fit

556
00:18:50,320 --> 00:18:53,600
in

557
00:18:50,559 --> 00:18:55,840
all the data that i used from the dgas

558
00:18:53,600 --> 00:18:56,639
and i wanted to showcase how does it

559
00:18:55,840 --> 00:18:58,720
look

560
00:18:56,640 --> 00:19:00,160
uh in the deep learning eyes quote

561
00:18:58,720 --> 00:19:02,640
unquote like how does the

562
00:19:00,160 --> 00:19:04,400
neural network see it and once i

563
00:19:02,640 --> 00:19:05,039
visualized the space that the neural

564
00:19:04,400 --> 00:19:07,760
network

565
00:19:05,039 --> 00:19:09,600
built to understand if it's a dj or not

566
00:19:07,760 --> 00:19:11,679
i saw something really interesting

567
00:19:09,600 --> 00:19:13,439
so here in this graph every time you see

568
00:19:11,679 --> 00:19:16,960
a dot in a color

569
00:19:13,440 --> 00:19:18,799
it represents a domain name and the dga

570
00:19:16,960 --> 00:19:20,720
malware it came from

571
00:19:18,799 --> 00:19:23,120
and what you can see here is that there

572
00:19:20,720 --> 00:19:24,400
are some really separable clusters here

573
00:19:23,120 --> 00:19:26,719
right you can see that

574
00:19:24,400 --> 00:19:28,559
the green cluster is separable and the

575
00:19:26,720 --> 00:19:31,280
purple one and so on and

576
00:19:28,559 --> 00:19:31,918
the orange one so it's understandable

577
00:19:31,280 --> 00:19:33,840
why

578
00:19:31,919 --> 00:19:35,760
in general we could understand if

579
00:19:33,840 --> 00:19:37,678
domains are benign or not

580
00:19:35,760 --> 00:19:39,520
but what you can also see here is that

581
00:19:37,679 --> 00:19:41,919
some of the clusters are just too

582
00:19:39,520 --> 00:19:43,200
intertwined for example at the top

583
00:19:41,919 --> 00:19:46,080
cluster here

584
00:19:43,200 --> 00:19:47,679
you can see that uh the purple dots and

585
00:19:46,080 --> 00:19:49,760
the blue dots and the brown dots and the

586
00:19:47,679 --> 00:19:51,919
red dots are all intertwined

587
00:19:49,760 --> 00:19:54,960
and this is a really interesting thing

588
00:19:51,919 --> 00:19:57,280
to see because obviously if i can't

589
00:19:54,960 --> 00:19:59,919
draw a line and then separate it

590
00:19:57,280 --> 00:20:03,039
obviously a neural network can't as well

591
00:19:59,919 --> 00:20:04,880
and the intuition here is also supported

592
00:20:03,039 --> 00:20:06,960
by real evidence that when i

593
00:20:04,880 --> 00:20:08,720
traced back and looked at the domains

594
00:20:06,960 --> 00:20:10,960
all of the patterns that are describing

595
00:20:08,720 --> 00:20:13,280
the domain star cluster here together

596
00:20:10,960 --> 00:20:15,520
actually have the same pattern like the

597
00:20:13,280 --> 00:20:16,240
malwares are using some very similar dga

598
00:20:15,520 --> 00:20:18,080
code

599
00:20:16,240 --> 00:20:19,520
and they are generating a domain name

600
00:20:18,080 --> 00:20:22,320
that is for example

601
00:20:19,520 --> 00:20:25,120
seven characters seven characters long

602
00:20:22,320 --> 00:20:27,280
and they're sampling the lectures a to z

603
00:20:25,120 --> 00:20:29,199
now we all know that it's really common

604
00:20:27,280 --> 00:20:30,879
for malwares to share code and her

605
00:20:29,200 --> 00:20:33,440
share like there's a lot of stuff like

606
00:20:30,880 --> 00:20:35,679
that specifically for the dga code

607
00:20:33,440 --> 00:20:38,720
that's what made it so difficult because

608
00:20:35,679 --> 00:20:40,000
if they actually have the same pattern

609
00:20:38,720 --> 00:20:41,520
it's obviously going to be very

610
00:20:40,000 --> 00:20:43,039
difficult to understand that it's coming

611
00:20:41,520 --> 00:20:46,080
from different patterns

612
00:20:43,039 --> 00:20:48,080
so once i understood this was what

613
00:20:46,080 --> 00:20:49,439
was in the way of understanding and

614
00:20:48,080 --> 00:20:51,439
solving this issue

615
00:20:49,440 --> 00:20:52,960
we had an idea of how we can actually

616
00:20:51,440 --> 00:20:53,679
solve this and then also create an

617
00:20:52,960 --> 00:20:57,440
algorithm that

618
00:20:53,679 --> 00:21:00,159
attribute the specific model we see

619
00:20:57,440 --> 00:21:02,240
so what i'm going to showcase here is an

620
00:21:00,159 --> 00:21:05,039
actual system that we have

621
00:21:02,240 --> 00:21:05,919
running in production and is going over

622
00:21:05,039 --> 00:21:10,080
i think

623
00:21:05,919 --> 00:21:11,760
the latest report is 67 trillion dns

624
00:21:10,080 --> 00:21:14,840
queries a day

625
00:21:11,760 --> 00:21:16,400
so the first thing that we do is that we

626
00:21:14,840 --> 00:21:19,439
group um

627
00:21:16,400 --> 00:21:21,679
each domains that are queried by as way

628
00:21:19,440 --> 00:21:22,799
one user in a very specified small time

629
00:21:21,679 --> 00:21:25,200
window

630
00:21:22,799 --> 00:21:26,799
so here you can see for example say that

631
00:21:25,200 --> 00:21:27,520
this was the domains that we saw in

632
00:21:26,799 --> 00:21:29,760
traffic

633
00:21:27,520 --> 00:21:31,120
during this time window is that you can

634
00:21:29,760 --> 00:21:32,879
see facebook.com

635
00:21:31,120 --> 00:21:35,199
and some very funny looking domains and

636
00:21:32,880 --> 00:21:37,120
then google.com with a typo

637
00:21:35,200 --> 00:21:39,360
and then two other um funny looking

638
00:21:37,120 --> 00:21:42,000
domains now this is because

639
00:21:39,360 --> 00:21:42,879
imagine that the user is actually um

640
00:21:42,000 --> 00:21:44,400
querying and

641
00:21:42,880 --> 00:21:45,919
i don't know browsing the internet going

642
00:21:44,400 --> 00:21:46,960
through its facebook page and so on so

643
00:21:45,919 --> 00:21:47,919
obviously you're going to see some

644
00:21:46,960 --> 00:21:50,880
domains

645
00:21:47,919 --> 00:21:52,000
that are normal traffic combined with

646
00:21:50,880 --> 00:21:53,360
the malware that is running in the

647
00:21:52,000 --> 00:21:55,120
background

648
00:21:53,360 --> 00:21:57,600
and then what we do is that we run each

649
00:21:55,120 --> 00:21:59,918
domain through our deep learning model

650
00:21:57,600 --> 00:22:01,678
that we train together right now

651
00:21:59,919 --> 00:22:03,440
and we ask it a very simple question on

652
00:22:01,679 --> 00:22:04,720
each and every domain do you think this

653
00:22:03,440 --> 00:22:07,120
is a dga

654
00:22:04,720 --> 00:22:08,320
and the network replies was a result

655
00:22:07,120 --> 00:22:10,158
between zero and one

656
00:22:08,320 --> 00:22:11,439
where zero would stand for a no this is

657
00:22:10,159 --> 00:22:13,600
not at the ga and one

658
00:22:11,440 --> 00:22:14,960
is yeah i think it is so you can see

659
00:22:13,600 --> 00:22:16,480
real results here that

660
00:22:14,960 --> 00:22:18,240
it thought it thought that facebook is

661
00:22:16,480 --> 00:22:21,200
not a dj thought that these are

662
00:22:18,240 --> 00:22:23,360
um very likely to be djs and google.com

663
00:22:21,200 --> 00:22:25,360
the typo is not and so on

664
00:22:23,360 --> 00:22:26,719
and then what we do which was quite

665
00:22:25,360 --> 00:22:29,039
novel is that

666
00:22:26,720 --> 00:22:30,159
we take these groups of domain that pass

667
00:22:29,039 --> 00:22:32,879
the threshold and

668
00:22:30,159 --> 00:22:35,120
we're likely to be dgas and then we try

669
00:22:32,880 --> 00:22:37,440
to attribute them as a group

670
00:22:35,120 --> 00:22:39,280
and understand if they're all responding

671
00:22:37,440 --> 00:22:41,440
to the same pattern

672
00:22:39,280 --> 00:22:43,360
and if they all uh match the same

673
00:22:41,440 --> 00:22:45,760
regular expression

674
00:22:43,360 --> 00:22:47,678
in some cases we're able to specifically

675
00:22:45,760 --> 00:22:49,840
attribute them say okay this is

676
00:22:47,679 --> 00:22:51,600
all combining matching to the same

677
00:22:49,840 --> 00:22:53,199
regular expression and also

678
00:22:51,600 --> 00:22:54,719
they're all fitting the very specific

679
00:22:53,200 --> 00:22:56,640
regular expression that is

680
00:22:54,720 --> 00:22:57,760
described by a malware called loki for

681
00:22:56,640 --> 00:22:59,919
example

682
00:22:57,760 --> 00:23:02,320
or dire for example and so on and so

683
00:22:59,919 --> 00:23:04,640
forth but what's also interesting here

684
00:23:02,320 --> 00:23:07,039
is that this system where this

685
00:23:04,640 --> 00:23:09,120
understandings will need to be

686
00:23:07,039 --> 00:23:11,200
further investigating the pattern

687
00:23:09,120 --> 00:23:12,959
enables us also to group together

688
00:23:11,200 --> 00:23:15,120
domains that we're seeing in traffic

689
00:23:12,960 --> 00:23:16,720
we understand they're coming from a dga

690
00:23:15,120 --> 00:23:17,520
and they're all responding to a same

691
00:23:16,720 --> 00:23:19,600
pattern

692
00:23:17,520 --> 00:23:21,200
but it's just not reported yet like

693
00:23:19,600 --> 00:23:23,199
nobody um

694
00:23:21,200 --> 00:23:25,280
found this maori yet nobody reversed it

695
00:23:23,200 --> 00:23:26,159
nobody talked about it nobody even named

696
00:23:25,280 --> 00:23:28,799
it

697
00:23:26,159 --> 00:23:30,000
so once we sent something like that and

698
00:23:28,799 --> 00:23:32,400
understand that we have something

699
00:23:30,000 --> 00:23:34,640
completely novel in our system

700
00:23:32,400 --> 00:23:35,600
we attribute it or call it unknown

701
00:23:34,640 --> 00:23:39,360
number one

702
00:23:35,600 --> 00:23:41,120
now one may ask okay why don't you just

703
00:23:39,360 --> 00:23:41,760
research the malware and then report it

704
00:23:41,120 --> 00:23:43,360
now

705
00:23:41,760 --> 00:23:45,840
you need to bear in mind and remember

706
00:23:43,360 --> 00:23:48,479
that my point of view is the network

707
00:23:45,840 --> 00:23:50,639
so i end the network in a way and i

708
00:23:48,480 --> 00:23:51,200
never have access to the endpoint itself

709
00:23:50,640 --> 00:23:53,760
so

710
00:23:51,200 --> 00:23:55,919
if any of you ever comes across a

711
00:23:53,760 --> 00:23:58,000
malware that has dga and would like to

712
00:23:55,919 --> 00:24:01,120
collaborate in this i would love to

713
00:23:58,000 --> 00:24:03,600
but currently we have a number

714
00:24:01,120 --> 00:24:04,399
of dga-based malwares that we're

715
00:24:03,600 --> 00:24:08,000
tracking

716
00:24:04,400 --> 00:24:09,760
that are just simply not named yet so

717
00:24:08,000 --> 00:24:11,360
this should enable us to track it over

718
00:24:09,760 --> 00:24:13,600
time and block it over time

719
00:24:11,360 --> 00:24:14,479
and see if it's evolving and so on but

720
00:24:13,600 --> 00:24:16,879
sadly

721
00:24:14,480 --> 00:24:18,400
these are remaining unknown groups that

722
00:24:16,880 --> 00:24:20,480
we're just tracking

723
00:24:18,400 --> 00:24:22,240
now to report your real results because

724
00:24:20,480 --> 00:24:23,679
what i showcased you here

725
00:24:22,240 --> 00:24:26,080
is something that we actually have

726
00:24:23,679 --> 00:24:29,200
running in production for a while now

727
00:24:26,080 --> 00:24:31,439
and it's a beast of detecting dji

728
00:24:29,200 --> 00:24:33,840
domains and blocking them in traffic

729
00:24:31,440 --> 00:24:36,640
so it's automatically detecting and

730
00:24:33,840 --> 00:24:38,480
blocking about 2.5 million domains a day

731
00:24:36,640 --> 00:24:41,840
which is insane

732
00:24:38,480 --> 00:24:44,159
and it's independently blocking about 70

733
00:24:41,840 --> 00:24:46,959
million dns requests a day now

734
00:24:44,159 --> 00:24:48,720
this is subtracting the dns request

735
00:24:46,960 --> 00:24:50,240
request going to my about which you'll

736
00:24:48,720 --> 00:24:51,200
see in a second and you'll understand

737
00:24:50,240 --> 00:24:54,720
why

738
00:24:51,200 --> 00:24:58,320
i um separated the metrics

739
00:24:54,720 --> 00:25:00,000
we have very near zero like very near to

740
00:24:58,320 --> 00:25:02,639
zero percent of false positives

741
00:25:00,000 --> 00:25:04,960
now this is an interesting thing i would

742
00:25:02,640 --> 00:25:06,799
like to note in a in a moment that

743
00:25:04,960 --> 00:25:08,559
one of the most interesting things when

744
00:25:06,799 --> 00:25:10,080
you're going to create a detection beast

745
00:25:08,559 --> 00:25:11,918
like this is that you need to make sure

746
00:25:10,080 --> 00:25:13,918
you're not making mistakes because

747
00:25:11,919 --> 00:25:15,919
what this automatic thing is in motion

748
00:25:13,919 --> 00:25:17,360
and you're all basing this on statistics

749
00:25:15,919 --> 00:25:19,039
and deep learning and so on

750
00:25:17,360 --> 00:25:20,879
you need to have mechanisms that would

751
00:25:19,039 --> 00:25:21,840
make sure that i'm not blocking anything

752
00:25:20,880 --> 00:25:23,600
that would make you

753
00:25:21,840 --> 00:25:25,600
upset because i'm blocking and

754
00:25:23,600 --> 00:25:29,520
influencing the internet

755
00:25:25,600 --> 00:25:31,678
so what we did is that we have i think

756
00:25:29,520 --> 00:25:33,039
massive like amounts of algorithms that

757
00:25:31,679 --> 00:25:34,640
are also in charge

758
00:25:33,039 --> 00:25:36,480
of making sure that we don't have false

759
00:25:34,640 --> 00:25:38,720
positives and we are

760
00:25:36,480 --> 00:25:40,840
we have a lot of failsafes so this

761
00:25:38,720 --> 00:25:43,360
entire system is completely

762
00:25:40,840 --> 00:25:44,559
autonomous and it's also autonomous in

763
00:25:43,360 --> 00:25:46,000
making sure that it doesn't make

764
00:25:44,559 --> 00:25:49,200
mistakes

765
00:25:46,000 --> 00:25:50,000
and lastly i think currently we track

766
00:25:49,200 --> 00:25:53,039
about

767
00:25:50,000 --> 00:25:55,919
eight unknown or unreported uh

768
00:25:53,039 --> 00:25:56,480
possibly zero day dtas now the reason

769
00:25:55,919 --> 00:25:58,159
that i've said

770
00:25:56,480 --> 00:25:59,679
i said zero day and i'm not like

771
00:25:58,159 --> 00:26:01,360
question mark is because

772
00:25:59,679 --> 00:26:02,880
maybe it's a known malware just a new

773
00:26:01,360 --> 00:26:04,719
variant we don't know but

774
00:26:02,880 --> 00:26:06,720
once nobody reported it we have no way

775
00:26:04,720 --> 00:26:08,799
of knowing specifically the binary that

776
00:26:06,720 --> 00:26:10,400
it's coming from

777
00:26:08,799 --> 00:26:12,000
and now i want to drill down into my

778
00:26:10,400 --> 00:26:13,520
robot which is one of the detections

779
00:26:12,000 --> 00:26:15,120
made by the system and

780
00:26:13,520 --> 00:26:16,960
is really interesting and i wanted to

781
00:26:15,120 --> 00:26:19,439
share with the community

782
00:26:16,960 --> 00:26:21,600
so first let's go over how my robot

783
00:26:19,440 --> 00:26:24,320
operates now this is based again

784
00:26:21,600 --> 00:26:25,199
on a report by uh to concentrating and

785
00:26:24,320 --> 00:26:28,080
the reason is

786
00:26:25,200 --> 00:26:28,799
i don't have the sample myself so the

787
00:26:28,080 --> 00:26:31,840
first stage

788
00:26:28,799 --> 00:26:34,080
of this uh downloader specifically is to

789
00:26:31,840 --> 00:26:35,439
query this very interesting looking uh

790
00:26:34,080 --> 00:26:38,240
domain name

791
00:26:35,440 --> 00:26:40,640
and it obviously gets an eyepin return

792
00:26:38,240 --> 00:26:44,080
this is the how the dns protocol works

793
00:26:40,640 --> 00:26:46,559
and the malware is communicating with

794
00:26:44,080 --> 00:26:47,120
the specific id that was given and

795
00:26:46,559 --> 00:26:48,879
essentially

796
00:26:47,120 --> 00:26:50,879
logically it's asking okay where should

797
00:26:48,880 --> 00:26:51,760
i go next so this server is going to

798
00:26:50,880 --> 00:26:53,760
respond

799
00:26:51,760 --> 00:26:55,039
with a very specific url that is based

800
00:26:53,760 --> 00:26:57,919
on an ip

801
00:26:55,039 --> 00:27:00,000
um that the malware needs to go and grab

802
00:26:57,919 --> 00:27:01,440
the second stage malware so

803
00:27:00,000 --> 00:27:03,120
the third stage here would be that the

804
00:27:01,440 --> 00:27:04,559
malware actually goes and grabs the

805
00:27:03,120 --> 00:27:07,199
second stage malwares

806
00:27:04,559 --> 00:27:08,480
and gets it back to their to the victim

807
00:27:07,200 --> 00:27:11,200
computer

808
00:27:08,480 --> 00:27:12,240
and lastly they would run this um second

809
00:27:11,200 --> 00:27:14,240
stage malware

810
00:27:12,240 --> 00:27:15,520
and then this is unknown malicious

811
00:27:14,240 --> 00:27:18,399
activity so

812
00:27:15,520 --> 00:27:20,320
deep instinct reported that it was seen

813
00:27:18,399 --> 00:27:21,600
in the wild that the second stage maori

814
00:27:20,320 --> 00:27:22,879
used was khalisi but

815
00:27:21,600 --> 00:27:25,520
we all understand that it could be

816
00:27:22,880 --> 00:27:27,279
something different every other day

817
00:27:25,520 --> 00:27:29,279
and i think you would all understand

818
00:27:27,279 --> 00:27:31,200
that my system specifically

819
00:27:29,279 --> 00:27:33,039
detected it in a very early stage which

820
00:27:31,200 --> 00:27:36,159
is the first stage of

821
00:27:33,039 --> 00:27:38,799
only trying to um get the link for

822
00:27:36,159 --> 00:27:39,200
downloading the step in stage malware so

823
00:27:38,799 --> 00:27:41,120
what did

824
00:27:39,200 --> 00:27:43,520
we detect in traffic so our system

825
00:27:41,120 --> 00:27:45,520
alerted us that this specific domain

826
00:27:43,520 --> 00:27:46,639
uh and the group of domains it's coming

827
00:27:45,520 --> 00:27:49,600
from in traffic

828
00:27:46,640 --> 00:27:50,880
looks like it's coming from a dga and we

829
00:27:49,600 --> 00:27:54,799
detected about

830
00:27:50,880 --> 00:27:57,840
1 400 domains and the um

831
00:27:54,799 --> 00:28:00,480
the pattern that we saw is is as such so

832
00:27:57,840 --> 00:28:01,600
it has the prefix of the character m

833
00:28:00,480 --> 00:28:04,640
then a number

834
00:28:01,600 --> 00:28:05,918
between 0 and 43 then a domain name that

835
00:28:04,640 --> 00:28:10,240
is generated

836
00:28:05,919 --> 00:28:12,799
by a dj and then one of these tlds now

837
00:28:10,240 --> 00:28:13,520
wait is this everything that we detected

838
00:28:12,799 --> 00:28:15,360
no it's not

839
00:28:13,520 --> 00:28:17,200
because this is everything that was

840
00:28:15,360 --> 00:28:18,719
reported on in the blogs that i showed

841
00:28:17,200 --> 00:28:21,440
you in 2018

842
00:28:18,720 --> 00:28:24,080
but actually our system detected a lot

843
00:28:21,440 --> 00:28:26,880
more about four times more than that

844
00:28:24,080 --> 00:28:28,240
so we did detect this domain and we did

845
00:28:26,880 --> 00:28:30,399
group it together

846
00:28:28,240 --> 00:28:31,440
but actually what our system saw and now

847
00:28:30,399 --> 00:28:32,399
that you understand the system you

848
00:28:31,440 --> 00:28:34,240
understand that

849
00:28:32,399 --> 00:28:35,439
it's grouping things together that came

850
00:28:34,240 --> 00:28:37,919
together in traffic and

851
00:28:35,440 --> 00:28:39,840
fit the same pattern and we actually

852
00:28:37,919 --> 00:28:42,320
found what we understand to be

853
00:28:39,840 --> 00:28:43,600
four different variants of this

854
00:28:42,320 --> 00:28:46,559
operation

855
00:28:43,600 --> 00:28:46,879
and what we saw in traffic here is that

856
00:28:46,559 --> 00:28:49,918
we

857
00:28:46,880 --> 00:28:51,840
had the first uh reported variant

858
00:28:49,919 --> 00:28:53,440
but we had also three other variants

859
00:28:51,840 --> 00:28:54,320
with different patterns that we saw in

860
00:28:53,440 --> 00:28:56,799
traffic

861
00:28:54,320 --> 00:28:58,000
so you can see we also had a variant um

862
00:28:56,799 --> 00:29:00,879
that is prefixed with the

863
00:28:58,000 --> 00:29:02,720
character x the number 0 to 43 and the

864
00:29:00,880 --> 00:29:04,480
domain generated by a dga

865
00:29:02,720 --> 00:29:06,640
we also saw a variant that was prefixed

866
00:29:04,480 --> 00:29:09,600
with the word green

867
00:29:06,640 --> 00:29:11,360
and a number and so on and lastly a

868
00:29:09,600 --> 00:29:14,399
variant that looks somewhat

869
00:29:11,360 --> 00:29:16,639
uh maybe different but again our system

870
00:29:14,399 --> 00:29:18,239
grouped it together and it was prefixed

871
00:29:16,640 --> 00:29:19,279
with the letter v and then only the

872
00:29:18,240 --> 00:29:22,720
number one

873
00:29:19,279 --> 00:29:24,559
and then a dj domain now

874
00:29:22,720 --> 00:29:26,399
this was really interesting because as i

875
00:29:24,559 --> 00:29:28,080
told you once we get something that is

876
00:29:26,399 --> 00:29:30,320
unknown

877
00:29:28,080 --> 00:29:31,760
we want to investigate it and understand

878
00:29:30,320 --> 00:29:32,960
the most that we can about this

879
00:29:31,760 --> 00:29:35,120
detection

880
00:29:32,960 --> 00:29:36,159
so once our system alerted us about this

881
00:29:35,120 --> 00:29:38,399
we wanted to

882
00:29:36,159 --> 00:29:39,520
um go back and understand our research

883
00:29:38,399 --> 00:29:42,000
and and see

884
00:29:39,520 --> 00:29:43,279
wait is it a mistake or is it actually

885
00:29:42,000 --> 00:29:45,039
connected like

886
00:29:43,279 --> 00:29:46,559
when we saw the reports we were confused

887
00:29:45,039 --> 00:29:47,039
because this is very different than what

888
00:29:46,559 --> 00:29:50,960
we saw

889
00:29:47,039 --> 00:29:52,399
on the report on so what we treated

890
00:29:50,960 --> 00:29:54,720
tried to do at the time this was the

891
00:29:52,399 --> 00:29:56,799
beginning of 2019

892
00:29:54,720 --> 00:29:58,320
is that we wanted to look back at the

893
00:29:56,799 --> 00:29:59,440
infrastructure of what we're seeing in

894
00:29:58,320 --> 00:30:02,240
traffic

895
00:29:59,440 --> 00:30:03,919
so again keep in mind that all i can do

896
00:30:02,240 --> 00:30:04,480
is research it from the network point of

897
00:30:03,919 --> 00:30:06,320
view

898
00:30:04,480 --> 00:30:07,600
and therefore i need to use a lot of

899
00:30:06,320 --> 00:30:09,039
open source or

900
00:30:07,600 --> 00:30:10,719
engines that i can use such as

901
00:30:09,039 --> 00:30:12,240
virustotal in this case

902
00:30:10,720 --> 00:30:13,840
because i don't have access to the

903
00:30:12,240 --> 00:30:16,000
computer itself

904
00:30:13,840 --> 00:30:16,879
so what you can see here is an entity

905
00:30:16,000 --> 00:30:18,559
graph

906
00:30:16,880 --> 00:30:20,480
connecting the different things that i

907
00:30:18,559 --> 00:30:21,678
saw regarding the infrastructure of this

908
00:30:20,480 --> 00:30:23,440
botnet

909
00:30:21,679 --> 00:30:25,919
and because i have the network point of

910
00:30:23,440 --> 00:30:27,440
view i could specifically look for the

911
00:30:25,919 --> 00:30:29,200
domains that i saw that were actually

912
00:30:27,440 --> 00:30:29,840
resolving like as i told you at the

913
00:30:29,200 --> 00:30:31,440
beginning

914
00:30:29,840 --> 00:30:32,959
the domains that were actually used for

915
00:30:31,440 --> 00:30:34,080
the communication for the command of

916
00:30:32,960 --> 00:30:36,240
control

917
00:30:34,080 --> 00:30:38,000
and once i looked it up in virustoto

918
00:30:36,240 --> 00:30:40,399
what you can see here is that

919
00:30:38,000 --> 00:30:42,640
every time you see a blue or i think

920
00:30:40,399 --> 00:30:45,199
purple globe here it represents a domain

921
00:30:42,640 --> 00:30:47,120
or a subdomain and every time you see a

922
00:30:45,200 --> 00:30:49,360
flag it represents an ip in the

923
00:30:47,120 --> 00:30:51,760
autonomous system it's coming from

924
00:30:49,360 --> 00:30:53,600
so what you can see here on the left is

925
00:30:51,760 --> 00:30:55,840
the two domains that we saw in traffic

926
00:30:53,600 --> 00:30:57,840
resolving or having

927
00:30:55,840 --> 00:30:59,120
been used for the communication for the

928
00:30:57,840 --> 00:31:00,799
command control

929
00:30:59,120 --> 00:31:02,320
for the m variant which means that the

930
00:31:00,799 --> 00:31:03,360
variant that was blocked about its

931
00:31:02,320 --> 00:31:05,600
saturated

932
00:31:03,360 --> 00:31:07,519
and so on and i also put all the

933
00:31:05,600 --> 00:31:09,519
subdomains so you can see the pattern of

934
00:31:07,519 --> 00:31:10,159
the queries exactly as i explained in

935
00:31:09,519 --> 00:31:12,399
the

936
00:31:10,159 --> 00:31:14,000
slide before and you can see that it's

937
00:31:12,399 --> 00:31:15,678
resolving to a lot of eyepiece but

938
00:31:14,000 --> 00:31:17,679
what was interesting here is that here

939
00:31:15,679 --> 00:31:19,840
on the right you see the domain that

940
00:31:17,679 --> 00:31:21,519
we're resolving to the x variant which

941
00:31:19,840 --> 00:31:23,760
again is something that our system

942
00:31:21,519 --> 00:31:24,880
connected the dots together and you can

943
00:31:23,760 --> 00:31:26,799
see that pattern

944
00:31:24,880 --> 00:31:28,159
is similar but different domains and

945
00:31:26,799 --> 00:31:29,760
different variant

946
00:31:28,159 --> 00:31:31,200
from the ember but what you can see here

947
00:31:29,760 --> 00:31:32,879
that it's really cool is that they are

948
00:31:31,200 --> 00:31:35,279
resolving

949
00:31:32,880 --> 00:31:36,480
they have shared resolving to same some

950
00:31:35,279 --> 00:31:38,880
ips and specifically

951
00:31:36,480 --> 00:31:39,919
three and this was really cool but

952
00:31:38,880 --> 00:31:42,000
because this is what

953
00:31:39,919 --> 00:31:43,760
this was like wow so they are connected

954
00:31:42,000 --> 00:31:46,720
like they're communicating to the same

955
00:31:43,760 --> 00:31:48,640
server it has to be um related with

956
00:31:46,720 --> 00:31:50,960
psychic traffic and so on

957
00:31:48,640 --> 00:31:53,840
and what was also interesting about this

958
00:31:50,960 --> 00:31:55,919
is this specific portuguese flag

959
00:31:53,840 --> 00:31:56,879
so when we researched it what we

960
00:31:55,919 --> 00:31:59,039
understood it to be

961
00:31:56,880 --> 00:31:59,919
or our theory is that this is a

962
00:31:59,039 --> 00:32:02,879
sinkholding

963
00:31:59,919 --> 00:32:05,200
effort now this makes a lot of sense

964
00:32:02,880 --> 00:32:07,600
because as i said the m variant

965
00:32:05,200 --> 00:32:09,440
was reported at the time and it would

966
00:32:07,600 --> 00:32:11,199
make sense that the security community

967
00:32:09,440 --> 00:32:12,880
would try and block this

968
00:32:11,200 --> 00:32:14,559
but what was interesting here is that no

969
00:32:12,880 --> 00:32:15,279
matter that they tried to sinkhole it

970
00:32:14,559 --> 00:32:16,879
obviously

971
00:32:15,279 --> 00:32:19,279
the operation was still successful

972
00:32:16,880 --> 00:32:19,679
because they had so many other fallbacks

973
00:32:19,279 --> 00:32:23,200
and

974
00:32:19,679 --> 00:32:24,559
fallback ivs so this was really cool but

975
00:32:23,200 --> 00:32:26,799
then we wanted to go further

976
00:32:24,559 --> 00:32:28,480
and we wanted to see the other variants

977
00:32:26,799 --> 00:32:30,240
so we did the same analysis

978
00:32:28,480 --> 00:32:32,399
and we looked for the grain variant in

979
00:32:30,240 --> 00:32:33,600
the v1 variant now for the green variant

980
00:32:32,399 --> 00:32:37,199
again you can see

981
00:32:33,600 --> 00:32:39,120
the same story that they have shared ip

982
00:32:37,200 --> 00:32:40,559
and what was interesting in this

983
00:32:39,120 --> 00:32:43,600
specific

984
00:32:40,559 --> 00:32:45,840
graph is that for the v1 variant

985
00:32:43,600 --> 00:32:47,279
we can see that it's also connected but

986
00:32:45,840 --> 00:32:47,918
what we understood here is that it's

987
00:32:47,279 --> 00:32:51,440
already

988
00:32:47,919 --> 00:32:52,559
there were i think yeah 671 domains

989
00:32:51,440 --> 00:32:54,399
resolving

990
00:32:52,559 --> 00:32:56,399
to a portuguese ip that we understood to

991
00:32:54,399 --> 00:32:56,879
be a sinkholing effort and what we

992
00:32:56,399 --> 00:32:59,678
understood

993
00:32:56,880 --> 00:33:01,279
here is that probably the v1 variant was

994
00:32:59,679 --> 00:33:02,080
something that was successful this thing

995
00:33:01,279 --> 00:33:04,559
called

996
00:33:02,080 --> 00:33:07,199
and is not operational anymore and we

997
00:33:04,559 --> 00:33:09,360
even found evidence that this might be

998
00:33:07,200 --> 00:33:10,320
the first variant of this specific

999
00:33:09,360 --> 00:33:13,120
operation

1000
00:33:10,320 --> 00:33:15,279
and that was just the beginning so as

1001
00:33:13,120 --> 00:33:16,559
this was the earliest one we understood

1002
00:33:15,279 --> 00:33:18,720
that this one is probably

1003
00:33:16,559 --> 00:33:20,080
successfully sinkholed but these two are

1004
00:33:18,720 --> 00:33:21,600
still operational

1005
00:33:20,080 --> 00:33:23,199
and this was again really cool because

1006
00:33:21,600 --> 00:33:25,840
we saw the connections and

1007
00:33:23,200 --> 00:33:27,120
that everything is still really related

1008
00:33:25,840 --> 00:33:29,360
and we understood that their system was

1009
00:33:27,120 --> 00:33:32,639
making the right call

1010
00:33:29,360 --> 00:33:35,039
and now preparing for this presentation

1011
00:33:32,640 --> 00:33:37,440
for 2020 i decided to go

1012
00:33:35,039 --> 00:33:39,519
and look for how the infrastructure

1013
00:33:37,440 --> 00:33:41,200
looks right now so again my system is

1014
00:33:39,519 --> 00:33:42,559
tracking everything automatically

1015
00:33:41,200 --> 00:33:44,480
i just pulled everything that is

1016
00:33:42,559 --> 00:33:46,240
belonging to this group and what

1017
00:33:44,480 --> 00:33:48,159
i saw was really cool so first of all i

1018
00:33:46,240 --> 00:33:51,279
saw that there are a lot more

1019
00:33:48,159 --> 00:33:53,039
resolving domains that i saw before

1020
00:33:51,279 --> 00:33:54,880
and you can see that the graph looks

1021
00:33:53,039 --> 00:33:55,840
much bigger and there's a lot more

1022
00:33:54,880 --> 00:33:57,360
eyepiece here like

1023
00:33:55,840 --> 00:33:59,120
they really grew their infrastructure

1024
00:33:57,360 --> 00:34:00,399
they're they're growing business is

1025
00:33:59,120 --> 00:34:02,000
booming

1026
00:34:00,399 --> 00:34:03,760
and again you can see the connection

1027
00:34:02,000 --> 00:34:05,200
between the m variant and the x variant

1028
00:34:03,760 --> 00:34:06,480
and you can see the singling efforts and

1029
00:34:05,200 --> 00:34:08,079
so on

1030
00:34:06,480 --> 00:34:09,839
but what was really cool this time that

1031
00:34:08,079 --> 00:34:11,440
i prepared for this research

1032
00:34:09,839 --> 00:34:13,918
is that i also try to look at the

1033
00:34:11,440 --> 00:34:15,760
communicating files to these servers

1034
00:34:13,918 --> 00:34:17,279
to see if they actually have the same

1035
00:34:15,760 --> 00:34:19,359
file maybe i can even

1036
00:34:17,280 --> 00:34:20,480
find the file that i'm looking for so so

1037
00:34:19,359 --> 00:34:22,480
strongly

1038
00:34:20,480 --> 00:34:23,760
and what was cool here is the specific

1039
00:34:22,480 --> 00:34:25,679
cases you can see here

1040
00:34:23,760 --> 00:34:27,280
here down at the bottom and at the top

1041
00:34:25,679 --> 00:34:28,800
that there are a few files

1042
00:34:27,280 --> 00:34:30,560
that are communicating to the end

1043
00:34:28,800 --> 00:34:31,359
variant servers and the x variant

1044
00:34:30,560 --> 00:34:33,839
servers

1045
00:34:31,359 --> 00:34:36,239
even though they are not the same server

1046
00:34:33,839 --> 00:34:38,399
so it was really close because maybe

1047
00:34:36,239 --> 00:34:40,158
these are the malware files and just by

1048
00:34:38,399 --> 00:34:41,918
based on configuration

1049
00:34:40,159 --> 00:34:44,320
it's going to the x variant or the end

1050
00:34:41,918 --> 00:34:46,319
variant we're not really sure

1051
00:34:44,320 --> 00:34:48,000
but we were really interested in seeing

1052
00:34:46,320 --> 00:34:49,839
this because we essentially understood

1053
00:34:48,000 --> 00:34:51,679
that the operation is growing

1054
00:34:49,839 --> 00:34:53,279
and now i can also show you how it looks

1055
00:34:51,679 --> 00:34:55,679
from the network point of view right i'm

1056
00:34:53,280 --> 00:34:57,760
the dns empire i'm detecting this

1057
00:34:55,679 --> 00:34:59,520
so how does it look in our traffic and

1058
00:34:57,760 --> 00:35:02,079
why is it so interesting and

1059
00:34:59,520 --> 00:35:04,000
you should all be aware of this so this

1060
00:35:02,079 --> 00:35:06,560
is a graph representing the amount of

1061
00:35:04,000 --> 00:35:09,680
dns queries that we see a day

1062
00:35:06,560 --> 00:35:11,440
going to milobot domains and just to

1063
00:35:09,680 --> 00:35:12,480
make sure that we're all seeing it

1064
00:35:11,440 --> 00:35:16,079
correctly

1065
00:35:12,480 --> 00:35:17,200
the y scale here is in billion of dns

1066
00:35:16,079 --> 00:35:19,280
queries

1067
00:35:17,200 --> 00:35:21,759
so you can see that at the lowest point

1068
00:35:19,280 --> 00:35:24,880
which is august 2020 currently

1069
00:35:21,760 --> 00:35:28,400
like today it's at about 0.2

1070
00:35:24,880 --> 00:35:30,320
billion dns squares a day which is 200

1071
00:35:28,400 --> 00:35:33,440
million dns squares a day

1072
00:35:30,320 --> 00:35:36,640
now for comparison i also wrote

1073
00:35:33,440 --> 00:35:37,599
uh what we see for other botnets or the

1074
00:35:36,640 --> 00:35:40,000
most prominent

1075
00:35:37,599 --> 00:35:41,280
botnets after boiler boat so you can see

1076
00:35:40,000 --> 00:35:43,599
that for the botnet called

1077
00:35:41,280 --> 00:35:45,440
pike spawn we see about 1 million

1078
00:35:43,599 --> 00:35:47,359
squares a day and for q snatch 1 million

1079
00:35:45,440 --> 00:35:49,599
for imitate half a million so

1080
00:35:47,359 --> 00:35:50,720
you can understand that my robot does

1081
00:35:49,599 --> 00:35:53,680
200 times

1082
00:35:50,720 --> 00:35:54,799
more queries than all of the other

1083
00:35:53,680 --> 00:35:56,560
botnets that we've seen in

1084
00:35:54,800 --> 00:35:58,560
in our platform which is insane like

1085
00:35:56,560 --> 00:36:00,720
this is an insane amount of traffic

1086
00:35:58,560 --> 00:36:01,920
so if you circle back you remember i

1087
00:36:00,720 --> 00:36:04,720
told you we block about

1088
00:36:01,920 --> 00:36:05,839
70 million dns players a day to bot nets

1089
00:36:04,720 --> 00:36:07,680
coming from dta

1090
00:36:05,839 --> 00:36:10,160
without counting in manabut because

1091
00:36:07,680 --> 00:36:13,759
obviously my robot is skewing this

1092
00:36:10,160 --> 00:36:15,279
to a whole different scale now sadly

1093
00:36:13,760 --> 00:36:17,280
you can see that here there was this

1094
00:36:15,280 --> 00:36:19,200
huge spike that we still can't attribute

1095
00:36:17,280 --> 00:36:20,240
and understand what happened here again

1096
00:36:19,200 --> 00:36:21,680
because we're seeing it on in the

1097
00:36:20,240 --> 00:36:24,720
network platform

1098
00:36:21,680 --> 00:36:26,640
but my theory is that drop here

1099
00:36:24,720 --> 00:36:29,439
is just the successful efforts of the

1100
00:36:26,640 --> 00:36:32,319
sinkholding that we saw

1101
00:36:29,440 --> 00:36:34,240
and i wanted to give another intuition

1102
00:36:32,320 --> 00:36:37,200
of how their operation is just

1103
00:36:34,240 --> 00:36:37,759
um getting widespread is that i wanted

1104
00:36:37,200 --> 00:36:39,839
to give

1105
00:36:37,760 --> 00:36:41,280
an assessment of how many infected

1106
00:36:39,839 --> 00:36:44,400
entities are there

1107
00:36:41,280 --> 00:36:46,400
by this botnet called minorbot now

1108
00:36:44,400 --> 00:36:47,440
it should be noted that when i say an

1109
00:36:46,400 --> 00:36:50,160
entity

1110
00:36:47,440 --> 00:36:51,520
i'm talking about an entity i'm seeing

1111
00:36:50,160 --> 00:36:52,640
in a platform it could be either a

1112
00:36:51,520 --> 00:36:54,560
single user

1113
00:36:52,640 --> 00:36:56,160
or a not which means an enter an

1114
00:36:54,560 --> 00:36:58,160
enterprise gateway

1115
00:36:56,160 --> 00:37:00,000
and this gateway could represent maybe

1116
00:36:58,160 --> 00:37:02,000
tens of thousands of computers

1117
00:37:00,000 --> 00:37:03,680
so when i count one entity it could be

1118
00:37:02,000 --> 00:37:04,560
essentially tens of thousand computers

1119
00:37:03,680 --> 00:37:06,399
infected so

1120
00:37:04,560 --> 00:37:08,880
this graph could actually be much higher

1121
00:37:06,400 --> 00:37:10,000
than it shows here but what you can see

1122
00:37:08,880 --> 00:37:12,320
here still

1123
00:37:10,000 --> 00:37:14,079
is that over the course of the last year

1124
00:37:12,320 --> 00:37:16,800
milobot managed to pretty much

1125
00:37:14,079 --> 00:37:17,760
double their amount of infected entities

1126
00:37:16,800 --> 00:37:20,480
you can see that

1127
00:37:17,760 --> 00:37:22,240
at the end of 2018 the 19 they had about

1128
00:37:20,480 --> 00:37:25,200
3000 and four thousand infected

1129
00:37:22,240 --> 00:37:25,839
entities and dating right now we are

1130
00:37:25,200 --> 00:37:28,240
about

1131
00:37:25,839 --> 00:37:30,160
seven seven to eight thousand infected

1132
00:37:28,240 --> 00:37:31,759
users now

1133
00:37:30,160 --> 00:37:33,680
this is insane right this is a really

1134
00:37:31,760 --> 00:37:34,960
successful operation that's just growing

1135
00:37:33,680 --> 00:37:37,759
and growing

1136
00:37:34,960 --> 00:37:38,160
and i thought that once i saw all of

1137
00:37:37,760 --> 00:37:40,000
this

1138
00:37:38,160 --> 00:37:41,598
i have to share this with the world like

1139
00:37:40,000 --> 00:37:43,680
i have to be

1140
00:37:41,599 --> 00:37:46,400
able to tell everyone listen you really

1141
00:37:43,680 --> 00:37:50,078
need to be alerted about this

1142
00:37:46,400 --> 00:37:51,920
now i want to go i think quickly

1143
00:37:50,079 --> 00:37:53,359
about a summary of what i showed you

1144
00:37:51,920 --> 00:37:55,440
here um

1145
00:37:53,359 --> 00:37:57,279
so the first thing that we covered is

1146
00:37:55,440 --> 00:37:58,400
what is a dga and that it's a piece of

1147
00:37:57,280 --> 00:38:00,880
code that malwares

1148
00:37:58,400 --> 00:38:02,240
malwares use to generate domain names

1149
00:38:00,880 --> 00:38:04,160
and then to form the cnc

1150
00:38:02,240 --> 00:38:05,839
channel and then we talked about the

1151
00:38:04,160 --> 00:38:07,279
defense system that we built

1152
00:38:05,839 --> 00:38:09,359
and specifically i hope that i'm

1153
00:38:07,280 --> 00:38:10,480
inspiring you to do something very

1154
00:38:09,359 --> 00:38:13,279
similar because

1155
00:38:10,480 --> 00:38:14,000
i personally think this detection beast

1156
00:38:13,280 --> 00:38:16,960
and detection

1157
00:38:14,000 --> 00:38:18,079
and defense system is doing incredibly

1158
00:38:16,960 --> 00:38:21,119
uh well for our

1159
00:38:18,079 --> 00:38:21,680
for our platform um and how we did that

1160
00:38:21,119 --> 00:38:23,440
is that we'd

1161
00:38:21,680 --> 00:38:25,118
train a deep neural network and then we

1162
00:38:23,440 --> 00:38:26,640
used it on our light traffic to block

1163
00:38:25,119 --> 00:38:28,800
things

1164
00:38:26,640 --> 00:38:30,720
and lastly we covered milobot from our

1165
00:38:28,800 --> 00:38:32,560
perspective and from our understanding

1166
00:38:30,720 --> 00:38:34,078
which is a super active newly seen

1167
00:38:32,560 --> 00:38:35,759
botnet and

1168
00:38:34,079 --> 00:38:37,599
i think we should all be really aware

1169
00:38:35,760 --> 00:38:41,119
because who knows what the malicious

1170
00:38:37,599 --> 00:38:43,200
activities those second stages are doing

1171
00:38:41,119 --> 00:38:44,160
and the takeaways i want you guys to

1172
00:38:43,200 --> 00:38:46,720
take from here

1173
00:38:44,160 --> 00:38:48,560
are twofold so the first one is um the

1174
00:38:46,720 --> 00:38:51,200
counter measure so obviously

1175
00:38:48,560 --> 00:38:53,040
i think you all understand by now that

1176
00:38:51,200 --> 00:38:55,200
monitoring dns traffic

1177
00:38:53,040 --> 00:38:57,680
enabled us to detect it and therefore to

1178
00:38:55,200 --> 00:39:00,319
block it and successfully block it

1179
00:38:57,680 --> 00:39:00,960
and to go over to like to go the

1180
00:39:00,320 --> 00:39:02,800
distance

1181
00:39:00,960 --> 00:39:04,400
we will publish all of the iocs that

1182
00:39:02,800 --> 00:39:05,440
we're seeing in china specifically for

1183
00:39:04,400 --> 00:39:06,800
this botnet

1184
00:39:05,440 --> 00:39:08,800
now that we understand that everything

1185
00:39:06,800 --> 00:39:10,880
is all really connected

1186
00:39:08,800 --> 00:39:12,000
and the main takeaway here is that dji

1187
00:39:10,880 --> 00:39:14,320
detecting beast

1188
00:39:12,000 --> 00:39:16,320
are possible like even though that the

1189
00:39:14,320 --> 00:39:18,000
um recent work in recent papers or

1190
00:39:16,320 --> 00:39:20,400
academic paper showcase

1191
00:39:18,000 --> 00:39:21,839
successful lab results now i'm sharing

1192
00:39:20,400 --> 00:39:24,079
with you the successful

1193
00:39:21,839 --> 00:39:25,040
real world results and these are really

1194
00:39:24,079 --> 00:39:28,240
huge scale

1195
00:39:25,040 --> 00:39:28,960
real world results and lastly i wanted

1196
00:39:28,240 --> 00:39:30,879
to give you

1197
00:39:28,960 --> 00:39:32,320
uh one of the takeaways that i think

1198
00:39:30,880 --> 00:39:33,440
that threat intelligence from a network

1199
00:39:32,320 --> 00:39:36,320
perspective

1200
00:39:33,440 --> 00:39:37,760
isn't as crippled as uh we will all

1201
00:39:36,320 --> 00:39:40,240
think like i would love to

1202
00:39:37,760 --> 00:39:42,240
reverse engineer the malwares myself but

1203
00:39:40,240 --> 00:39:44,399
i think we were able to uh

1204
00:39:42,240 --> 00:39:46,000
get to some really interesting results

1205
00:39:44,400 --> 00:39:46,960
just investigating from the network

1206
00:39:46,000 --> 00:39:49,280
point of view so

1207
00:39:46,960 --> 00:39:57,599
i hope this inspired you guys as well

1208
00:39:49,280 --> 00:39:59,680
and uh thank you so much for your time

1209
00:39:57,599 --> 00:39:59,680
you

