1
00:00:11,280 --> 00:00:16,400
my name is uh

2
00:00:12,799 --> 00:00:20,720
peter bianchak i work

3
00:00:16,400 --> 00:00:24,960
as a senior uh researcher at

4
00:00:20,720 --> 00:00:24,960
sepolska and

5
00:00:25,039 --> 00:00:29,599
also i'm a phd student at versus

6
00:00:27,599 --> 00:00:32,800
university of technology

7
00:00:29,599 --> 00:00:36,719
you can reach me by email or by

8
00:00:32,800 --> 00:00:38,959
twitter no

9
00:00:36,719 --> 00:00:38,960
so

10
00:00:39,840 --> 00:00:44,239
i've always wanted to begin presentation

11
00:00:43,760 --> 00:00:47,760
with

12
00:00:44,239 --> 00:00:52,000
a card picture

13
00:00:47,760 --> 00:00:56,718
and yeah today i'm doing it

14
00:00:52,000 --> 00:00:59,920
it illustrates the mechanism

15
00:00:56,719 --> 00:01:03,199
which i think applies

16
00:00:59,920 --> 00:01:06,479
to uh to to

17
00:01:03,199 --> 00:01:07,920
work of blue teamers when they try to

18
00:01:06,479 --> 00:01:12,240
hunt

19
00:01:07,920 --> 00:01:16,000
malware using some block lists

20
00:01:12,240 --> 00:01:20,000
or some information about

21
00:01:16,000 --> 00:01:20,000
infrastructure malware infrastructure

22
00:01:20,720 --> 00:01:26,720
so i think a lot of

23
00:01:24,240 --> 00:01:29,919
people will wish to be that

24
00:01:26,720 --> 00:01:34,000
identification via

25
00:01:29,920 --> 00:01:37,280
this block list ip addresses domains was

26
00:01:34,000 --> 00:01:40,640
useful but and effective but

27
00:01:37,280 --> 00:01:44,399
i think it's not

28
00:01:40,640 --> 00:01:44,399
it's not um

29
00:01:44,560 --> 00:01:51,360
ips domains constantly change

30
00:01:48,079 --> 00:01:54,798
and mobile developers introduce some

31
00:01:51,360 --> 00:01:58,479
dedicated mechanism for evasion like dga

32
00:01:54,799 --> 00:02:01,520
fast flux all these things

33
00:01:58,479 --> 00:02:04,640
and yeah and

34
00:02:01,520 --> 00:02:07,039
when these things are

35
00:02:04,640 --> 00:02:08,560
maybe effective when we know the threats

36
00:02:07,040 --> 00:02:12,000
but when we are

37
00:02:08,560 --> 00:02:15,920
when we encounter an unknown threat

38
00:02:12,000 --> 00:02:21,120
then they these lists are useless

39
00:02:15,920 --> 00:02:25,200
so what should be

40
00:02:21,120 --> 00:02:28,480
what could we do if we have maybe some

41
00:02:25,200 --> 00:02:31,599
mechanism to identify

42
00:02:28,480 --> 00:02:33,119
uh something constant in malware

43
00:02:31,599 --> 00:02:36,359
behavior

44
00:02:33,120 --> 00:02:38,120
which also could provide some

45
00:02:36,360 --> 00:02:41,280
[Music]

46
00:02:38,120 --> 00:02:44,720
distinguishability between

47
00:02:41,280 --> 00:02:48,239
malware families i would say that

48
00:02:44,720 --> 00:02:53,200
it's marvel fingerprinting

49
00:02:48,239 --> 00:02:55,760
and malware fingerprinting using network

50
00:02:53,200 --> 00:02:57,119
network traffic which i will talk today

51
00:02:55,760 --> 00:03:00,480
about

52
00:02:57,120 --> 00:03:03,360
um with fingerprinters

53
00:03:00,480 --> 00:03:04,319
it will provide the fingerprinting we

54
00:03:03,360 --> 00:03:06,720
can identify

55
00:03:04,319 --> 00:03:06,720
threads

56
00:03:08,720 --> 00:03:13,519
because they use some rarely changed

57
00:03:12,080 --> 00:03:17,200
elements

58
00:03:13,519 --> 00:03:20,400
and we don't use the ip addresses

59
00:03:17,200 --> 00:03:22,720
but only those things which are

60
00:03:20,400 --> 00:03:24,239
like constant in all the traffic all the

61
00:03:22,720 --> 00:03:27,359
messages

62
00:03:24,239 --> 00:03:30,480
uh fingerprinters make

63
00:03:27,360 --> 00:03:34,480
uh the fingerprints produced unique

64
00:03:30,480 --> 00:03:37,040
that which can give us

65
00:03:34,480 --> 00:03:38,399
a way to identify in some sort smaller

66
00:03:37,040 --> 00:03:41,120
families

67
00:03:38,400 --> 00:03:41,440
but also the fingerprints can provide

68
00:03:41,120 --> 00:03:44,480
good

69
00:03:41,440 --> 00:03:48,000
generalization that means that

70
00:03:44,480 --> 00:03:50,319
if we have for example 100 requests

71
00:03:48,000 --> 00:03:51,680
a good finger printer can provide only

72
00:03:50,319 --> 00:03:53,839
10 fingerprints or

73
00:03:51,680 --> 00:03:56,879
even one fingerprint for all this

74
00:03:53,840 --> 00:04:01,120
traffic one is the same

75
00:03:56,879 --> 00:04:04,399
also fingerprinting provides

76
00:04:01,120 --> 00:04:07,519
uh or should provide an easy way to

77
00:04:04,400 --> 00:04:10,159
share the fingerprints and

78
00:04:07,519 --> 00:04:12,840
thus sharing the intelligence with the

79
00:04:10,159 --> 00:04:16,159
community for example

80
00:04:12,840 --> 00:04:17,358
um i think there are two different

81
00:04:16,160 --> 00:04:20,560
notions of uh

82
00:04:17,358 --> 00:04:23,680
fingerprinting mother fingerprinting uh

83
00:04:20,560 --> 00:04:25,120
one is i would say it's a direct

84
00:04:23,680 --> 00:04:29,199
identification of

85
00:04:25,120 --> 00:04:32,080
our families this

86
00:04:29,199 --> 00:04:32,639
this systems these tools directly

87
00:04:32,080 --> 00:04:36,320
provide

88
00:04:32,639 --> 00:04:39,199
name of the malware and i would say

89
00:04:36,320 --> 00:04:40,880
these are more like multi-class malware

90
00:04:39,199 --> 00:04:45,040
detectors

91
00:04:40,880 --> 00:04:45,040
and more than

92
00:04:45,440 --> 00:04:52,960
the second group which are more generic

93
00:04:50,240 --> 00:04:54,320
i will call them like generic feature

94
00:04:52,960 --> 00:04:56,960
extractors

95
00:04:54,320 --> 00:04:57,520
because they provide a representation of

96
00:04:56,960 --> 00:05:00,159
some

97
00:04:57,520 --> 00:05:02,960
features uh from from the network

98
00:05:00,160 --> 00:05:06,560
traffic from from the messages

99
00:05:02,960 --> 00:05:10,239
and these features

100
00:05:06,560 --> 00:05:10,800
do not er or its fingerprints do not

101
00:05:10,240 --> 00:05:14,080
give

102
00:05:10,800 --> 00:05:17,840
mother family however we can label it

103
00:05:14,080 --> 00:05:20,479
later in this presentation i will focus

104
00:05:17,840 --> 00:05:25,599
on the second group

105
00:05:20,479 --> 00:05:29,360
so let's begin with traffic fingerprints

106
00:05:25,600 --> 00:05:32,400
um majority of tools

107
00:05:29,360 --> 00:05:35,759
extract some payload fields uh

108
00:05:32,400 --> 00:05:39,280
from from for some help from

109
00:05:35,759 --> 00:05:42,080
headers here we can see ipv4 header

110
00:05:39,280 --> 00:05:44,400
or pseudo header and i have a lot of

111
00:05:42,080 --> 00:05:44,400
different

112
00:05:44,720 --> 00:05:51,360
different fields however

113
00:05:47,840 --> 00:05:55,440
the tools should choose only those

114
00:05:51,360 --> 00:05:58,800
fields which are like i said before uh

115
00:05:55,440 --> 00:06:00,000
rarely changed and also which are hard

116
00:05:58,800 --> 00:06:03,520
to change

117
00:06:00,000 --> 00:06:06,479
because if those change too much then um

118
00:06:03,520 --> 00:06:07,039
yeah or they're easy to change then they

119
00:06:06,479 --> 00:06:10,080
can be

120
00:06:07,039 --> 00:06:13,120
evaded um

121
00:06:10,080 --> 00:06:14,080
the fingerprinters present the results

122
00:06:13,120 --> 00:06:17,759
present the features

123
00:06:14,080 --> 00:06:20,639
usually into two forms like full

124
00:06:17,759 --> 00:06:21,280
presenting all the features and concise

125
00:06:20,639 --> 00:06:24,560
like

126
00:06:21,280 --> 00:06:28,239
hash or something like that so

127
00:06:24,560 --> 00:06:31,360
some uh examples of usage

128
00:06:28,240 --> 00:06:33,120
firstly you can use the fingerprinter to

129
00:06:31,360 --> 00:06:34,400
group activities for example you have

130
00:06:33,120 --> 00:06:39,280
like i said before

131
00:06:34,400 --> 00:06:44,400
100 http requests and you want to know

132
00:06:39,280 --> 00:06:44,400
either similar or different

133
00:06:45,199 --> 00:06:49,840
it can provide identification malware

134
00:06:47,840 --> 00:06:51,679
for example we have some

135
00:06:49,840 --> 00:06:54,560
one fingerprint which is distinct and

136
00:06:51,680 --> 00:06:57,599
you can use it as a hash

137
00:06:54,560 --> 00:07:00,840
to search for for other

138
00:06:57,599 --> 00:07:02,000
messages in this format it will it can

139
00:07:00,840 --> 00:07:05,440
be

140
00:07:02,000 --> 00:07:08,160
simply it is similar to like

141
00:07:05,440 --> 00:07:08,160
virustotal

142
00:07:09,840 --> 00:07:14,719
it can fingerprinters can also provide

143
00:07:12,960 --> 00:07:16,239
identification of different operations

144
00:07:14,720 --> 00:07:19,919
single malware

145
00:07:16,240 --> 00:07:23,599
family for example if we

146
00:07:19,919 --> 00:07:25,280
want to identify which request is for

147
00:07:23,599 --> 00:07:28,639
example for

148
00:07:25,280 --> 00:07:28,638
cnc and which is for

149
00:07:29,120 --> 00:07:32,319
information about ip or connectivity

150
00:07:31,360 --> 00:07:35,360
check

151
00:07:32,319 --> 00:07:38,479
fingerprinters can provide that info

152
00:07:35,360 --> 00:07:41,840
also if families

153
00:07:38,479 --> 00:07:45,039
are for example have

154
00:07:41,840 --> 00:07:48,400
one ascendant then

155
00:07:45,039 --> 00:07:51,520
yeah you can you can correlate some

156
00:07:48,400 --> 00:07:52,479
similar behaviors and provide some

157
00:07:51,520 --> 00:07:57,198
information that

158
00:07:52,479 --> 00:08:00,560
these two families are somewhat similar

159
00:07:57,199 --> 00:08:04,400
um now i'll present some popular tools

160
00:08:00,560 --> 00:08:05,919
uh we will begin with jeffrey i think

161
00:08:04,400 --> 00:08:10,000
it's very popular

162
00:08:05,919 --> 00:08:12,560
um it provides means for

163
00:08:10,000 --> 00:08:14,960
fingerprinting to your last uh both

164
00:08:12,560 --> 00:08:18,000
client and servers

165
00:08:14,960 --> 00:08:21,520
it uses the symbol values of some chosen

166
00:08:18,000 --> 00:08:21,520
fields of client hello message

167
00:08:22,080 --> 00:08:30,719
these are a version of tls

168
00:08:26,319 --> 00:08:33,759
the cyphers use used list of extensions

169
00:08:30,720 --> 00:08:33,759
elliptic curves and

170
00:08:34,559 --> 00:08:41,760
curse point formats all these things

171
00:08:37,599 --> 00:08:44,800
are concatenated and this is the

172
00:08:41,760 --> 00:08:47,279
full version of of the

173
00:08:44,800 --> 00:08:48,479
of the fingerprint however it's rather

174
00:08:47,279 --> 00:08:52,240
long so we can

175
00:08:48,480 --> 00:08:55,680
um use a shorter form

176
00:08:52,240 --> 00:09:00,000
which is hard with md5 this

177
00:08:55,680 --> 00:09:04,560
tool is extensively supported

178
00:09:00,000 --> 00:09:08,480
different different

179
00:09:04,560 --> 00:09:11,680
systems like mis like moloch

180
00:09:08,480 --> 00:09:12,480
monitoring with three music all the

181
00:09:11,680 --> 00:09:15,439
things

182
00:09:12,480 --> 00:09:16,860
that's over here to search for the

183
00:09:15,440 --> 00:09:19,120
github

184
00:09:16,860 --> 00:09:23,040
[Music]

185
00:09:19,120 --> 00:09:26,640
the second tool

186
00:09:23,040 --> 00:09:26,640
aj ssh

187
00:09:27,120 --> 00:09:34,839
yeah the name does all

188
00:09:30,160 --> 00:09:38,640
its fingerprints ssh clients servers

189
00:09:34,839 --> 00:09:41,519
uh as before

190
00:09:38,640 --> 00:09:41,519
it extracts some

191
00:09:41,839 --> 00:09:45,760
fields from the

192
00:09:44,580 --> 00:09:49,360
[Music]

193
00:09:45,760 --> 00:09:50,319
one of the first messages when the ssh

194
00:09:49,360 --> 00:09:54,800
connection is

195
00:09:50,320 --> 00:09:58,399
negotiated and decimal values of

196
00:09:54,800 --> 00:10:02,000
fields like public categories

197
00:09:58,399 --> 00:10:04,240
or encryption algorithms mark algorithms

198
00:10:02,000 --> 00:10:05,680
compression all these things are

199
00:10:04,240 --> 00:10:10,399
concatenated and then

200
00:10:05,680 --> 00:10:10,399
cast to provide a shorter phone

201
00:10:10,800 --> 00:10:16,800
also that would have open source so

202
00:10:14,160 --> 00:10:16,800
you can check it

203
00:10:17,279 --> 00:10:23,760
i think that this is also a great tool

204
00:10:20,320 --> 00:10:28,160
fingerprint of the things um

205
00:10:23,760 --> 00:10:28,160
it supports both previous

206
00:10:28,959 --> 00:10:36,160
previous tools jeffrey hs sage

207
00:10:32,959 --> 00:10:40,399
but also it can

208
00:10:36,160 --> 00:10:43,680
fingerprint remote desktop protocol

209
00:10:40,399 --> 00:10:45,279
by using rdfp fingerprinter but also

210
00:10:43,680 --> 00:10:48,560
gquigg

211
00:10:45,279 --> 00:10:51,839
um and http

212
00:10:48,560 --> 00:10:55,839
i had a fingerprinting i will talk

213
00:10:51,839 --> 00:10:59,279
about this later it can

214
00:10:55,839 --> 00:11:04,160
online network pick up files

215
00:10:59,279 --> 00:11:08,000
all these things here and the github

216
00:11:04,160 --> 00:11:11,040
so maybe some other great tools

217
00:11:08,000 --> 00:11:14,160
like it's a classic tool uh

218
00:11:11,040 --> 00:11:17,360
both in the version three it supports

219
00:11:14,160 --> 00:11:17,360
http fingerprinting

220
00:11:17,680 --> 00:11:20,640
cisco mercury

221
00:11:21,750 --> 00:11:28,240
[Music]

222
00:11:23,600 --> 00:11:31,519
a lot of protocols supported

223
00:11:28,240 --> 00:11:36,480
um identification framework

224
00:11:31,519 --> 00:11:39,839
which is called recalc by rapid7

225
00:11:36,480 --> 00:11:40,880
it gives information about not only

226
00:11:39,839 --> 00:11:45,200
about protocol

227
00:11:40,880 --> 00:11:47,760
to fingerprinting but also

228
00:11:45,200 --> 00:11:49,600
services operating system all these

229
00:11:47,760 --> 00:11:53,040
things

230
00:11:49,600 --> 00:11:55,760
so now something more complex that

231
00:11:53,040 --> 00:11:57,279
tools presented before smtp

232
00:11:55,760 --> 00:12:00,560
fingerprinting

233
00:11:57,279 --> 00:12:00,560
smtp used by

234
00:12:00,959 --> 00:12:05,439
to send emails to exchange emails

235
00:12:04,290 --> 00:12:10,000
[Music]

236
00:12:05,440 --> 00:12:14,410
this method it's called smtp dialects

237
00:12:10,000 --> 00:12:15,519
because it checks the implementation of

238
00:12:14,410 --> 00:12:20,000
[Music]

239
00:12:15,519 --> 00:12:24,560
smtp how the the client

240
00:12:20,000 --> 00:12:27,680
talks with server um

241
00:12:24,560 --> 00:12:31,439
it looks which messages are exchanged

242
00:12:27,680 --> 00:12:33,920
um the case also checks

243
00:12:31,440 --> 00:12:35,680
smtp extension imf fields all these

244
00:12:33,920 --> 00:12:39,839
things

245
00:12:35,680 --> 00:12:39,839
it can be used to detect spambots

246
00:12:40,320 --> 00:12:46,399
you can see more about this i think this

247
00:12:43,680 --> 00:12:46,399
one of the first

248
00:12:47,839 --> 00:12:53,440
papers about this academic paper however

249
00:12:51,519 --> 00:12:55,920
very i think we're promising also my

250
00:12:53,440 --> 00:12:59,839
colleagues in the system project

251
00:12:55,920 --> 00:13:02,880
uh worked on this and

252
00:12:59,839 --> 00:13:06,720
yes here is a screen from

253
00:13:02,880 --> 00:13:09,839
from from the season block

254
00:13:06,720 --> 00:13:14,000
and two different bots

255
00:13:09,839 --> 00:13:18,839
uh thunderbird and some spambot

256
00:13:14,000 --> 00:13:22,320
we can see some differences we've

257
00:13:18,839 --> 00:13:25,360
exchanged messages thunderbird is

258
00:13:22,320 --> 00:13:30,720
elo and about

259
00:13:25,360 --> 00:13:34,079
hello here is our ap address and

260
00:13:30,720 --> 00:13:37,200
the bot uses a domain name there is a

261
00:13:34,079 --> 00:13:40,880
difference in mail in the from

262
00:13:37,200 --> 00:13:43,760
the made from message

263
00:13:40,880 --> 00:13:45,279
it's written in some other case also

264
00:13:43,760 --> 00:13:47,760
there is a

265
00:13:45,279 --> 00:13:49,439
space after it there is no white space

266
00:13:47,760 --> 00:13:53,360
here in the thunderbird

267
00:13:49,440 --> 00:13:53,360
the same applies to

268
00:13:53,920 --> 00:13:58,560
the second message recipient to

269
00:13:58,880 --> 00:14:07,040
so and at last the quit uh information

270
00:14:03,600 --> 00:14:09,360
the bot does not send it so

271
00:14:07,040 --> 00:14:11,360
you can see the difference however there

272
00:14:09,360 --> 00:14:16,639
is no open source tool

273
00:14:11,360 --> 00:14:19,760
for for smtp fingerprinting so maybe

274
00:14:16,639 --> 00:14:21,440
someone want to to check it and check

275
00:14:19,760 --> 00:14:24,880
these papers

276
00:14:21,440 --> 00:14:28,240
and write something in the

277
00:14:24,880 --> 00:14:31,600
in the free time so

278
00:14:28,240 --> 00:14:35,040
i will now try to provide some demo

279
00:14:31,600 --> 00:14:44,480
oh already started so okay

280
00:14:35,040 --> 00:14:46,800
i've imported

281
00:14:44,480 --> 00:14:48,160
yeah yeah i should see security on okay

282
00:14:46,800 --> 00:14:50,639
so uh

283
00:14:48,160 --> 00:14:51,600
i've imported uh network traffic because

284
00:14:50,639 --> 00:14:55,279
files from

285
00:14:51,600 --> 00:14:58,800
uh model traffic analysis.com or

286
00:14:55,279 --> 00:15:02,480
you know you know the site and

287
00:14:58,800 --> 00:15:06,079
yeah the the traffic comes from the

288
00:15:02,480 --> 00:15:09,519
the posts from 2020 and i've

289
00:15:06,079 --> 00:15:12,959
i've imported them with so

290
00:15:09,519 --> 00:15:16,160
import pickup from security online

291
00:15:12,959 --> 00:15:20,000
okay i will like play the the

292
00:15:16,160 --> 00:15:23,519
film so uh

293
00:15:20,000 --> 00:15:27,040
i i go to this keyword to check

294
00:15:23,519 --> 00:15:31,360
all the surikata alerts

295
00:15:27,040 --> 00:15:34,880
and firstly i've

296
00:15:31,360 --> 00:15:40,720
checked the time

297
00:15:34,880 --> 00:15:44,240
because i'd like a whole liver

298
00:15:40,720 --> 00:15:46,560
as a time reference because the the

299
00:15:44,240 --> 00:15:50,240
pickups are from different

300
00:15:46,560 --> 00:15:53,758
time from holier

301
00:15:50,240 --> 00:15:57,839
okay so next yeah

302
00:15:53,759 --> 00:16:01,199
you can see some different uh different

303
00:15:57,839 --> 00:16:04,959
uh different different colors

304
00:16:01,199 --> 00:16:07,359
and because there is a lot of malware

305
00:16:04,959 --> 00:16:10,160
this traffic is almost all malware

306
00:16:07,360 --> 00:16:13,690
however some pickups have some

307
00:16:10,160 --> 00:16:15,120
traffic from from windows background

308
00:16:13,690 --> 00:16:18,880
[Music]

309
00:16:15,120 --> 00:16:23,839
so we can check

310
00:16:18,880 --> 00:16:23,839
check the traffic and here we can see

311
00:16:26,800 --> 00:16:33,920
here we can see that there is

312
00:16:30,399 --> 00:16:37,519
some cnc

313
00:16:33,920 --> 00:16:41,120
server of drivers or chipboard

314
00:16:37,519 --> 00:16:46,320
we don't know yet and

315
00:16:41,120 --> 00:16:46,320
there are some alerts for it and

316
00:16:46,639 --> 00:16:52,800
we will check the ip addresses

317
00:16:51,150 --> 00:16:56,639
[Music]

318
00:16:52,800 --> 00:16:59,680
for example here is some address from

319
00:16:56,639 --> 00:17:05,040
russia and yeah we will

320
00:16:59,680 --> 00:17:05,040
now click it and we will

321
00:17:13,839 --> 00:17:23,039
we have this default dashboard with

322
00:17:19,760 --> 00:17:27,760
information about the

323
00:17:23,039 --> 00:17:32,720
ip address however we would like to

324
00:17:27,760 --> 00:17:35,760
use it as a filter

325
00:17:32,720 --> 00:17:40,160
firstly yeah i forgot to

326
00:17:35,760 --> 00:17:43,919
to make time reference of one year

327
00:17:40,160 --> 00:17:43,919
last year okay so making a

328
00:17:44,240 --> 00:17:52,880
filter with ips keyboard

329
00:17:48,160 --> 00:17:56,000
and i've pasted the ip address

330
00:17:52,880 --> 00:17:59,280
save the filter okay so now we are

331
00:17:56,000 --> 00:18:02,559
in the in the default

332
00:17:59,280 --> 00:18:04,160
and the main dashboard and we want to to

333
00:18:02,559 --> 00:18:07,039
go to

334
00:18:04,160 --> 00:18:08,880
uh to some different dashboards but we

335
00:18:07,039 --> 00:18:12,080
want to save the site b

336
00:18:08,880 --> 00:18:15,200
and so i have pinned it

337
00:18:12,080 --> 00:18:18,480
and now i will go to

338
00:18:15,200 --> 00:18:20,960
um to

339
00:18:18,480 --> 00:18:20,960
ssl

340
00:18:23,360 --> 00:18:30,320
and yeah

341
00:18:27,120 --> 00:18:30,320
i think yeah

342
00:18:30,480 --> 00:18:37,560
we can see some counts

343
00:18:33,840 --> 00:18:39,918
uh how many times was it was observed

344
00:18:37,560 --> 00:18:42,679
[Music]

345
00:18:39,919 --> 00:18:44,160
so i've added

346
00:18:42,680 --> 00:18:47,520
[Music]

347
00:18:44,160 --> 00:18:51,280
here uh it's not default

348
00:18:47,520 --> 00:18:54,320
however i wanted to uh to to

349
00:18:51,280 --> 00:18:57,360
additional dashboards uh

350
00:18:54,320 --> 00:18:59,760
about zeke jeffrey and

351
00:18:57,360 --> 00:19:01,280
because it comes from zeke and jeffrey s

352
00:18:59,760 --> 00:19:03,660
for server

353
00:19:01,280 --> 00:19:06,240
and now i will uh

354
00:19:03,660 --> 00:19:09,700
[Music]

355
00:19:06,240 --> 00:19:13,599
try to prevent some

356
00:19:09,700 --> 00:19:13,599
[Music]

357
00:19:17,280 --> 00:19:20,879
i wanted to filter the traffic

358
00:19:21,440 --> 00:19:25,840
there was some problem however okay so

359
00:19:27,280 --> 00:19:29,918
yeah i have

360
00:19:31,360 --> 00:19:38,559
i have inputted the qr

361
00:19:35,280 --> 00:19:42,559
joffrey keyboard to my hand this is the

362
00:19:38,559 --> 00:19:46,480
fingerprint for for the client

363
00:19:42,559 --> 00:19:51,280
who connected to to this uh

364
00:19:46,480 --> 00:19:51,280
cnc server which was

365
00:19:51,679 --> 00:19:56,799
malicious at least by surikata

366
00:20:02,240 --> 00:20:09,600
so now i've unpin the ip

367
00:20:06,240 --> 00:20:13,200
and it showed that there is there was 51

368
00:20:09,600 --> 00:20:17,120
messages from with this

369
00:20:13,200 --> 00:20:20,640
fingerprint and yeah i think

370
00:20:17,120 --> 00:20:23,678
it is a lot and there is

371
00:20:20,640 --> 00:20:24,799
also some other jeffrey case here are

372
00:20:23,679 --> 00:20:27,600
some

373
00:20:24,799 --> 00:20:29,039
information about ip addresses of the

374
00:20:27,600 --> 00:20:31,918
clients using it

375
00:20:29,039 --> 00:20:32,400
so we can say that these ip addresses

376
00:20:31,919 --> 00:20:36,159
can

377
00:20:32,400 --> 00:20:36,159
provide some information that they are

378
00:20:37,600 --> 00:20:41,199
they are malicious

379
00:20:42,240 --> 00:20:46,400
okay so next thing

380
00:20:44,820 --> 00:20:50,399
[Music]

381
00:20:46,400 --> 00:20:54,480
sorry uh now i will

382
00:20:50,400 --> 00:20:58,000
uh the the filter is empty

383
00:20:54,480 --> 00:21:02,960
i have refreshed for the whole year to

384
00:20:58,000 --> 00:21:05,760
check information about all the um

385
00:21:02,960 --> 00:21:06,480
all the tls connections and then we have

386
00:21:05,760 --> 00:21:08,799
a lot of

387
00:21:06,480 --> 00:21:09,919
this joffrey keyboards a lot of

388
00:21:08,799 --> 00:21:13,679
fingerprints

389
00:21:09,919 --> 00:21:18,080
so maybe a lot of clients and

390
00:21:13,679 --> 00:21:22,400
so i have we can download it

391
00:21:18,080 --> 00:21:22,399
like a csv file and

392
00:21:22,960 --> 00:21:25,520
we go to

393
00:21:26,320 --> 00:21:33,840
terminal um

394
00:21:30,799 --> 00:21:34,960
let's see how how does it look so there

395
00:21:33,840 --> 00:21:38,320
you have uh

396
00:21:34,960 --> 00:21:41,360
um we have a

397
00:21:38,320 --> 00:21:45,439
fingerprint and the crown so we have to

398
00:21:41,360 --> 00:21:50,000
make it a little more prettier

399
00:21:45,440 --> 00:21:50,000
meanwhile we go to the

400
00:21:50,480 --> 00:21:56,559
abuse ch geoffrey fingerprints

401
00:21:54,240 --> 00:21:57,280
blacklist i have previously downloaded

402
00:21:56,559 --> 00:22:01,200
it

403
00:21:57,280 --> 00:22:01,200
and yeah

404
00:22:02,159 --> 00:22:06,559
we can cut the information about the

405
00:22:04,480 --> 00:22:09,440
fingerprints

406
00:22:06,559 --> 00:22:10,399
from from the zig from from the from the

407
00:22:09,440 --> 00:22:13,600
kibana and

408
00:22:10,400 --> 00:22:14,320
zig and then check whether any of these

409
00:22:13,600 --> 00:22:18,719
fingerprints

410
00:22:14,320 --> 00:22:18,720
is on the blacklist of abuse ch

411
00:22:19,360 --> 00:22:23,600
so we are preparing the data i have the

412
00:22:21,919 --> 00:22:27,280
data we can

413
00:22:23,600 --> 00:22:31,760
write all the information to

414
00:22:27,280 --> 00:22:31,760
the scene jeffrey

415
00:22:32,960 --> 00:22:41,440
dot txt file and then

416
00:22:36,080 --> 00:22:44,639
let's see how does look the blacklist

417
00:22:41,440 --> 00:22:47,600
which are free information of

418
00:22:44,640 --> 00:22:49,760
mother family that's all all we need so

419
00:22:47,600 --> 00:22:54,480
okay we use

420
00:22:49,760 --> 00:22:58,158
advanced tool called grab

421
00:22:54,480 --> 00:23:03,919
we will grab using

422
00:22:58,159 --> 00:23:03,919
using all these fingerprints from

423
00:23:04,080 --> 00:23:08,000
from kibana to check whether any of them

424
00:23:07,679 --> 00:23:12,080
is

425
00:23:08,000 --> 00:23:15,360
on the wch

426
00:23:12,080 --> 00:23:19,199
list so yeah we have found

427
00:23:15,360 --> 00:23:19,199
sorry i cannot but

428
00:23:19,520 --> 00:23:25,840
it's like here mark two thread is uh

429
00:23:23,600 --> 00:23:27,600
so we found gtx then we can pivot all

430
00:23:25,840 --> 00:23:32,320
the things

431
00:23:27,600 --> 00:23:32,320
more okay let me know if you see

432
00:23:32,480 --> 00:23:40,400
another desktop

433
00:23:37,120 --> 00:23:41,360
okay great thanks thanks all right so

434
00:23:40,400 --> 00:23:45,440
okay

435
00:23:41,360 --> 00:23:50,000
the next one because time is running

436
00:23:45,440 --> 00:23:53,039
out so let's play

437
00:23:50,000 --> 00:23:55,679
now i will uh uh

438
00:23:53,039 --> 00:23:56,799
give you information about the fight how

439
00:23:55,679 --> 00:24:00,880
does it work

440
00:23:56,799 --> 00:24:04,320
so some demo so previously i have

441
00:24:00,880 --> 00:24:06,240
restarted and fat

442
00:24:04,320 --> 00:24:08,320
as remember fingerprint all the things

443
00:24:06,240 --> 00:24:11,600
and we will use the http

444
00:24:08,320 --> 00:24:14,240
fingerprinting uh feature

445
00:24:11,600 --> 00:24:15,840
so firstly uh i've downloaded from model

446
00:24:14,240 --> 00:24:19,520
traffic analysis

447
00:24:15,840 --> 00:24:22,559
tripod pickup file

448
00:24:19,520 --> 00:24:24,780
and we will filter out only

449
00:24:22,559 --> 00:24:26,480
the http request

450
00:24:24,780 --> 00:24:29,600
[Music]

451
00:24:26,480 --> 00:24:33,039
http requests so there is

452
00:24:29,600 --> 00:24:35,520
like nine of them and

453
00:24:33,039 --> 00:24:36,240
there are some different but different

454
00:24:35,520 --> 00:24:39,840
ones

455
00:24:36,240 --> 00:24:41,360
this i think this one is like

456
00:24:39,840 --> 00:24:45,039
[Music]

457
00:24:41,360 --> 00:24:47,918
very identifiable

458
00:24:45,039 --> 00:24:48,559
for the trick board if you ever see the

459
00:24:47,919 --> 00:24:52,240
traffic

460
00:24:48,559 --> 00:24:54,480
because the name of the computer

461
00:24:52,240 --> 00:24:54,480
so

462
00:24:55,279 --> 00:24:59,600
there are some different different

463
00:24:57,919 --> 00:25:01,279
requests

464
00:24:59,600 --> 00:25:04,080
and there is a pulse request which i

465
00:25:01,279 --> 00:25:07,760
talked before here

466
00:25:04,080 --> 00:25:10,720
this three uh from what i remember

467
00:25:07,760 --> 00:25:11,279
are these three requests are used to

468
00:25:10,720 --> 00:25:14,880
develop

469
00:25:11,279 --> 00:25:18,159
additional trickbots dll and

470
00:25:14,880 --> 00:25:22,480
okay so let's see what can

471
00:25:18,159 --> 00:25:28,159
what fat can tell

472
00:25:22,480 --> 00:25:32,159
about this yeah we

473
00:25:28,159 --> 00:25:32,159
take the pickup file name

474
00:25:33,279 --> 00:25:35,600
and

475
00:25:37,120 --> 00:25:44,080
okay problem with the argument however

476
00:25:40,480 --> 00:25:44,480
it's like a minus r to read the pickup

477
00:25:44,080 --> 00:25:47,760
file

478
00:25:44,480 --> 00:25:50,159
minus p to print to the

479
00:25:47,760 --> 00:25:51,120
command line and http for for

480
00:25:50,159 --> 00:25:54,159
fingerprint

481
00:25:51,120 --> 00:25:57,360
so and there is a lot of data

482
00:25:54,159 --> 00:26:00,720
and however you can you you have

483
00:25:57,360 --> 00:26:04,000
source ip destination ip protocol

484
00:26:00,720 --> 00:26:06,159
um fingerprint and user agent

485
00:26:04,000 --> 00:26:07,360
and however there is information about

486
00:26:06,159 --> 00:26:11,840
the server

487
00:26:07,360 --> 00:26:11,840
uh server side but i would like to

488
00:26:12,400 --> 00:26:16,799
filter only for for

489
00:26:14,430 --> 00:26:20,720
[Music]

490
00:26:16,799 --> 00:26:24,639
for the client uh so we will

491
00:26:20,720 --> 00:26:25,360
get the info however it still is a lot

492
00:26:24,640 --> 00:26:28,400
of

493
00:26:25,360 --> 00:26:33,360
data so here we cut

494
00:26:28,400 --> 00:26:33,360
only the destination might be with

495
00:26:35,679 --> 00:26:43,440
with information about

496
00:26:39,760 --> 00:26:46,400
about destination port okay so

497
00:26:43,440 --> 00:26:47,760
here we can see there is a one

498
00:26:46,400 --> 00:26:51,360
fingerprint is

499
00:26:47,760 --> 00:26:54,879
in like one two three messages

500
00:26:51,360 --> 00:26:57,360
also there are two other

501
00:26:54,880 --> 00:26:59,679
fingerprints which are the same also the

502
00:26:57,360 --> 00:27:03,199
same are the user agents

503
00:26:59,679 --> 00:27:03,200
and i think uh

504
00:27:04,240 --> 00:27:11,279
fat gives a good uh information about

505
00:27:07,760 --> 00:27:12,240
different uh different requests of this

506
00:27:11,279 --> 00:27:15,520
malware

507
00:27:12,240 --> 00:27:17,440
like um the one i showed

508
00:27:15,520 --> 00:27:19,840
the fingerprint shot was for for the

509
00:27:17,440 --> 00:27:23,760
pulse request another

510
00:27:19,840 --> 00:27:27,678
another fingerprint for this

511
00:27:23,760 --> 00:27:30,158
post request which is kind

512
00:27:27,679 --> 00:27:30,159
different

513
00:27:31,120 --> 00:27:35,918
[Music]

514
00:27:33,120 --> 00:27:36,399
it's like here and this post request is

515
00:27:35,919 --> 00:27:40,080
on

516
00:27:36,399 --> 00:27:42,639
other report but also it uploads some

517
00:27:40,080 --> 00:27:44,000
other information on the other other

518
00:27:42,640 --> 00:27:47,600
requests so yeah

519
00:27:44,000 --> 00:27:51,200
i think it's a good

520
00:27:47,600 --> 00:27:54,480
good tool so um now we will go to

521
00:27:51,200 --> 00:27:57,760
uh to another problem we have uh

522
00:27:54,480 --> 00:28:00,080
emoted pickup uh

523
00:27:57,760 --> 00:28:01,360
a modern tripod and unknown pickup for

524
00:28:00,080 --> 00:28:06,399
someone no malware

525
00:28:01,360 --> 00:28:06,399
so we will check

526
00:28:06,480 --> 00:28:14,840
the traffic there is some

527
00:28:10,240 --> 00:28:17,679
traffic for http https okay

528
00:28:14,840 --> 00:28:21,678
so

529
00:28:17,679 --> 00:28:23,039
we put it in the pickup file to in the

530
00:28:21,679 --> 00:28:26,240
file

531
00:28:23,039 --> 00:28:29,919
and sort four unique

532
00:28:26,240 --> 00:28:30,720
values of fingerprint and user agent to

533
00:28:29,919 --> 00:28:34,799
provide

534
00:28:30,720 --> 00:28:37,840
unique information about

535
00:28:34,799 --> 00:28:41,039
all the requests in the known pickup

536
00:28:37,840 --> 00:28:43,279
with the emoted then we will do the same

537
00:28:41,039 --> 00:28:43,279
thing

538
00:28:43,360 --> 00:28:50,158
okay so now we save it as a voltage

539
00:28:46,480 --> 00:28:53,600
fingerprint txt file okay

540
00:28:50,159 --> 00:28:58,720
then we do the same for the

541
00:28:53,600 --> 00:29:02,879
unknown unknown pickup

542
00:28:58,720 --> 00:29:02,880
we get some information and

543
00:29:03,760 --> 00:29:07,200
let's see what's in there so there's

544
00:29:06,720 --> 00:29:11,120
some

545
00:29:07,200 --> 00:29:13,840
some hunches so some user agents

546
00:29:11,120 --> 00:29:15,439
but let's see whether these two

547
00:29:13,840 --> 00:29:19,120
intersect

548
00:29:15,440 --> 00:29:21,360
so with that uh with that mechanism we

549
00:29:19,120 --> 00:29:21,360
can

550
00:29:21,440 --> 00:29:27,840
we can tell whether those fingerprints

551
00:29:24,640 --> 00:29:30,559
from emoted are seen in the unknown file

552
00:29:27,840 --> 00:29:31,439
if yes then we can say with some

553
00:29:30,559 --> 00:29:34,960
probability

554
00:29:31,440 --> 00:29:34,960
probability that

555
00:29:35,039 --> 00:29:42,240
in the unknown pickup has also emoted

556
00:29:39,120 --> 00:29:46,320
traffic let's see

557
00:29:42,240 --> 00:29:49,440
yes using grab grabbing

558
00:29:46,320 --> 00:29:53,520
through the emoted from

559
00:29:49,440 --> 00:29:59,120
the normal and yeah we have some

560
00:29:53,520 --> 00:30:02,399
free uh three fingerprints with the same

561
00:29:59,120 --> 00:30:08,000
hash and user agent so yeah

562
00:30:02,399 --> 00:30:10,719
we can tell that the the one file is

563
00:30:08,000 --> 00:30:12,799
the one file is the second file it

564
00:30:10,720 --> 00:30:17,760
usually could be a model

565
00:30:12,799 --> 00:30:22,639
now two other uh malwares beta board

566
00:30:17,760 --> 00:30:26,480
and a copter

567
00:30:22,640 --> 00:30:26,480
firstly we will look at the copter

568
00:30:27,279 --> 00:30:34,080
there is harsh beginning with zero

569
00:30:30,559 --> 00:30:38,480
a0f etc then we will

570
00:30:34,080 --> 00:30:41,918
check the beta board

571
00:30:38,480 --> 00:30:46,480
all this has to show

572
00:30:41,919 --> 00:30:51,279
that there is also

573
00:30:46,480 --> 00:30:54,320
the same value for both modular families

574
00:30:51,279 --> 00:30:58,320
so yeah we have a collision here

575
00:30:54,320 --> 00:31:01,600
uh because

576
00:30:58,320 --> 00:31:05,279
uh both modeler the similar

577
00:31:01,600 --> 00:31:08,799
requests the similar headers

578
00:31:05,279 --> 00:31:12,320
however they are different by

579
00:31:08,799 --> 00:31:15,279
url okay so

580
00:31:12,320 --> 00:31:15,279
let's get back to

581
00:31:17,120 --> 00:31:19,840
sorry okay

582
00:31:22,640 --> 00:31:26,080
let's get back to presentation

583
00:31:28,720 --> 00:31:32,000
the problem the problems which we can

584
00:31:31,679 --> 00:31:37,120
see

585
00:31:32,000 --> 00:31:37,120
here is that

586
00:31:40,559 --> 00:31:46,639
there are in some current

587
00:31:44,080 --> 00:31:49,120
this is not only from this observation

588
00:31:46,640 --> 00:31:53,279
from some of my

589
00:31:49,120 --> 00:31:54,239
research current http fingerprinters

590
00:31:53,279 --> 00:31:57,679
have a lot of

591
00:31:54,240 --> 00:32:01,360
collision between families also between

592
00:31:57,679 --> 00:32:04,960
malware and benign software and

593
00:32:01,360 --> 00:32:08,158
currently the analysis of url payload

594
00:32:04,960 --> 00:32:09,279
is limited in them so yeah i've created

595
00:32:08,159 --> 00:32:12,320
each finger

596
00:32:09,279 --> 00:32:12,880
which looks in the url like this

597
00:32:12,320 --> 00:32:16,000
features

598
00:32:12,880 --> 00:32:17,519
length directories file extension header

599
00:32:16,000 --> 00:32:19,840
structure

600
00:32:17,519 --> 00:32:22,559
like request method protocol version

601
00:32:19,840 --> 00:32:25,600
order of the headers

602
00:32:22,559 --> 00:32:26,799
popular headers and values i think most

603
00:32:25,600 --> 00:32:28,799
of these

604
00:32:26,799 --> 00:32:31,840
features for the headset are already

605
00:32:28,799 --> 00:32:34,559
known and also the payload

606
00:32:31,840 --> 00:32:36,158
the length of the pile of entropy and

607
00:32:34,559 --> 00:32:39,200
presence of some non-ascii

608
00:32:36,159 --> 00:32:42,720
characters to check the

609
00:32:39,200 --> 00:32:45,840
information about the battles by the

610
00:32:42,720 --> 00:32:49,200
maid modeler so here we have a

611
00:32:45,840 --> 00:32:54,000
post request uh which

612
00:32:49,200 --> 00:32:54,000
is a dummy post request dummy data

613
00:32:54,080 --> 00:32:59,678
but it provides a fingerprint

614
00:32:57,440 --> 00:33:00,559
with information this is actual

615
00:32:59,679 --> 00:33:04,000
fingerprint from

616
00:33:00,559 --> 00:33:06,080
uh from from the finger and

617
00:33:04,000 --> 00:33:07,279
it provides information about the length

618
00:33:06,080 --> 00:33:10,799
of the

619
00:33:07,279 --> 00:33:13,840
url it's a base 10 logarithm

620
00:33:10,799 --> 00:33:16,000
of of the length uh

621
00:33:13,840 --> 00:33:18,158
also the extension of the file requested

622
00:33:16,000 --> 00:33:21,440
there is no extension here so

623
00:33:18,159 --> 00:33:22,240
it's empty and number of variables uh in

624
00:33:21,440 --> 00:33:24,640
the in

625
00:33:22,240 --> 00:33:25,360
the url here is only one so yeah it's

626
00:33:24,640 --> 00:33:28,320
here

627
00:33:25,360 --> 00:33:28,320
then the structure

628
00:33:28,559 --> 00:33:32,639
name of the request method version of

629
00:33:31,679 --> 00:33:38,320
the protocol

630
00:33:32,640 --> 00:33:39,890
and then a list of uh

631
00:33:38,320 --> 00:33:41,600
there is a list of uh

632
00:33:39,890 --> 00:33:44,399
[Music]

633
00:33:41,600 --> 00:33:45,439
headers some popular headers with with

634
00:33:44,399 --> 00:33:48,879
values encoded

635
00:33:45,440 --> 00:33:50,799
here and lastly uh payload features it's

636
00:33:48,880 --> 00:33:53,919
the length of the payload

637
00:33:50,799 --> 00:33:57,039
of this part uh as before

638
00:33:53,919 --> 00:34:02,159
uh it's a base then

639
00:33:57,039 --> 00:34:02,158
logger of of the length so

640
00:34:03,279 --> 00:34:09,599
it's you you can make as before

641
00:34:06,480 --> 00:34:12,639
uh md5 has from it however uh

642
00:34:09,599 --> 00:34:14,159
the main uh the main thing we would like

643
00:34:12,639 --> 00:34:19,839
to achieve with it

644
00:34:14,159 --> 00:34:23,599
is to give some interpretation for

645
00:34:19,839 --> 00:34:27,199
for analysts to to look into the

646
00:34:23,599 --> 00:34:30,320
request and check what's there by hand

647
00:34:27,199 --> 00:34:30,319
yeah there is some coding

648
00:34:32,320 --> 00:34:35,409
some popular headers are analyzed the

649
00:34:34,320 --> 00:34:37,040
values are

650
00:34:35,409 --> 00:34:39,679
[Music]

651
00:34:37,040 --> 00:34:40,399
encoded for example application json is

652
00:34:39,679 --> 00:34:43,918
called like

653
00:34:40,399 --> 00:34:46,560
ap js however

654
00:34:43,918 --> 00:34:47,359
you can provide your own encoding i

655
00:34:46,560 --> 00:34:51,199
don't know even

656
00:34:47,359 --> 00:34:54,399
with emoji or some smiley faces

657
00:34:51,199 --> 00:34:54,399
it's off for you

658
00:34:54,639 --> 00:34:58,079
the h finger have different support

659
00:34:56,639 --> 00:35:00,240
modes

660
00:34:58,079 --> 00:35:01,680
i've presented before the result of

661
00:35:00,240 --> 00:35:05,439
different features

662
00:35:01,680 --> 00:35:08,240
which are used by

663
00:35:05,440 --> 00:35:09,599
a springer however if you take a lot of

664
00:35:08,240 --> 00:35:12,078
features

665
00:35:09,599 --> 00:35:13,440
there is a lot of fingerprints given

666
00:35:12,079 --> 00:35:15,760
from the

667
00:35:13,440 --> 00:35:17,200
from the tool it's the generalization

668
00:35:15,760 --> 00:35:20,320
it's

669
00:35:17,200 --> 00:35:22,319
it's not very well then so

670
00:35:20,320 --> 00:35:24,480
you have you have to to make this

671
00:35:22,320 --> 00:35:28,160
optimization

672
00:35:24,480 --> 00:35:30,640
between uniqueness of the

673
00:35:28,160 --> 00:35:33,680
fingerprint and the number of

674
00:35:30,640 --> 00:35:37,200
fingerprints produced by the

675
00:35:33,680 --> 00:35:40,240
by the tool so uh you can

676
00:35:37,200 --> 00:35:41,040
choose choose the report mode depending

677
00:35:40,240 --> 00:35:44,720
on your

678
00:35:41,040 --> 00:35:46,160
level the default mode tries to optimize

679
00:35:44,720 --> 00:35:48,720
both

680
00:35:46,160 --> 00:35:49,680
this uniqueness and generalization uh

681
00:35:48,720 --> 00:35:53,200
there's a

682
00:35:49,680 --> 00:35:56,160
more informative mode where you can

683
00:35:53,200 --> 00:35:58,160
have more features presented to you but

684
00:35:56,160 --> 00:36:00,799
it makes also

685
00:35:58,160 --> 00:36:01,440
slightly more fingerprints and all the

686
00:36:00,800 --> 00:36:06,480
features

687
00:36:01,440 --> 00:36:06,480
not full information however it

688
00:36:06,560 --> 00:36:10,799
is full information the fingerprint is

689
00:36:08,640 --> 00:36:14,319
more is the most unique however

690
00:36:10,800 --> 00:36:14,720
uh there is also a lot of fingerprints

691
00:36:14,320 --> 00:36:18,560
done

692
00:36:14,720 --> 00:36:21,680
in the other modes some more info

693
00:36:18,560 --> 00:36:25,520
i think it's already uh

694
00:36:21,680 --> 00:36:29,279
already published at third point

695
00:36:25,520 --> 00:36:30,720
github you can find it there

696
00:36:29,280 --> 00:36:32,400
please know that it's a working

697
00:36:30,720 --> 00:36:34,799
prototype stage

698
00:36:32,400 --> 00:36:36,720
i think there will be some changes i

699
00:36:34,800 --> 00:36:39,040
wish to

700
00:36:36,720 --> 00:36:40,480
the tool is written python uses

701
00:36:39,040 --> 00:36:44,960
discharge for pickup parsing

702
00:36:40,480 --> 00:36:48,640
and http reassembly and

703
00:36:44,960 --> 00:36:49,119
comments issues pr's are all welcomed

704
00:36:48,640 --> 00:36:52,400
you can

705
00:36:49,119 --> 00:36:53,680
write to me by email yeah make issues on

706
00:36:52,400 --> 00:36:58,480
the github

707
00:36:53,680 --> 00:36:58,480
so maybe some demo

708
00:37:03,760 --> 00:37:11,119
let's check it i you should see okay so

709
00:37:06,960 --> 00:37:14,480
yeah there is but there is a problem i

710
00:37:11,119 --> 00:37:18,640
forgot to resize the

711
00:37:14,480 --> 00:37:22,320
size of the icons but

712
00:37:18,640 --> 00:37:26,720
okay so maybe you can

713
00:37:22,320 --> 00:37:28,530
see anything there is a long string it's

714
00:37:26,720 --> 00:37:31,279
not not beauty

715
00:37:28,530 --> 00:37:33,599
[Music]

716
00:37:31,280 --> 00:37:34,320
it's not so beautiful as you would like

717
00:37:33,599 --> 00:37:38,480
to

718
00:37:34,320 --> 00:37:41,119
so we put it into the queue

719
00:37:38,480 --> 00:37:42,480
maybe okay so here i resize it and i

720
00:37:41,119 --> 00:37:45,680
will talk about it so

721
00:37:42,480 --> 00:37:48,839
uh i've put the one of the

722
00:37:45,680 --> 00:37:49,919
collision files the copter pickup which

723
00:37:48,839 --> 00:37:52,400
was uh

724
00:37:49,920 --> 00:37:53,200
interfacing collisions the gate

725
00:37:52,400 --> 00:37:56,320
collisions

726
00:37:53,200 --> 00:37:59,598
uh so uh

727
00:37:56,320 --> 00:38:00,160
when we put it from the gq you can see

728
00:37:59,599 --> 00:38:03,280
some

729
00:38:00,160 --> 00:38:05,839
information about like like before

730
00:38:03,280 --> 00:38:06,560
uh length of the url but also the

731
00:38:05,839 --> 00:38:10,160
headers

732
00:38:06,560 --> 00:38:10,160
and then we will call

733
00:38:10,720 --> 00:38:15,680
the beta board and we can see that even

734
00:38:13,920 --> 00:38:18,880
that

735
00:38:15,680 --> 00:38:20,960
the part about the request version

736
00:38:18,880 --> 00:38:22,160
and the headers is the same however

737
00:38:20,960 --> 00:38:25,200
there is difference

738
00:38:22,160 --> 00:38:26,480
in the part of about the url here's a

739
00:38:25,200 --> 00:38:29,598
length of the url

740
00:38:26,480 --> 00:38:34,640
requested file number of variables so

741
00:38:29,599 --> 00:38:38,079
yeah here is a different uh

742
00:38:34,640 --> 00:38:41,839
difference between those two

743
00:38:38,079 --> 00:38:44,320
fingerprints so lastly

744
00:38:41,839 --> 00:38:44,320
valak

745
00:38:45,200 --> 00:38:48,319
we will analyze it with

746
00:38:48,480 --> 00:38:56,960
each finger firstly there is a lot of

747
00:38:53,040 --> 00:38:59,759
we filter out in t-shark the requests

748
00:38:56,960 --> 00:39:00,079
there is a lot of different requests

749
00:38:59,760 --> 00:39:03,280
here

750
00:39:00,079 --> 00:39:08,560
is some cap file

751
00:39:03,280 --> 00:39:08,560
here are some isp aspx

752
00:39:08,880 --> 00:39:15,760
requests one is on go dot spx other on

753
00:39:12,400 --> 00:39:19,200
rpc there is a lot of dissimilar

754
00:39:15,760 --> 00:39:23,839
uh requests but also

755
00:39:19,200 --> 00:39:28,078
there is some oh maybe i will

756
00:39:23,839 --> 00:39:31,200
can before yeah here you can see

757
00:39:28,079 --> 00:39:32,160
some background traffic from from

758
00:39:31,200 --> 00:39:36,879
windows

759
00:39:32,160 --> 00:39:40,160
it's not i think it's windows update so

760
00:39:36,880 --> 00:39:45,359
yeah mixed traffic

761
00:39:40,160 --> 00:39:45,359
and okay now we'll show it uh

762
00:39:47,359 --> 00:39:52,319
some different requests here is the

763
00:39:49,440 --> 00:39:55,839
request from the

764
00:39:52,320 --> 00:40:00,000
windows update yes

765
00:39:55,839 --> 00:40:04,960
update for funny user agent

766
00:40:00,000 --> 00:40:04,960
crypto api okay so

767
00:40:05,359 --> 00:40:12,319
we check the the file

768
00:40:08,800 --> 00:40:15,599
and it produced a lot of different

769
00:40:12,319 --> 00:40:19,359
requests however we can see that

770
00:40:15,599 --> 00:40:22,839
there is the the fingerprints are pretty

771
00:40:19,359 --> 00:40:27,759
uh the same

772
00:40:22,839 --> 00:40:27,759
so nextly we can

773
00:40:30,160 --> 00:40:37,359
we can check there is like uh five

774
00:40:33,680 --> 00:40:40,078
uh five uh five different

775
00:40:37,359 --> 00:40:40,078
fingerprints

776
00:40:41,839 --> 00:40:48,290
and with this fingerprints we can

777
00:40:46,720 --> 00:40:49,759
both

778
00:40:48,290 --> 00:40:53,279
[Music]

779
00:40:49,760 --> 00:40:56,400
identify this shorter shorter

780
00:40:53,280 --> 00:40:59,839
request but also between these two two

781
00:40:56,400 --> 00:41:03,599
requests which are to some two different

782
00:40:59,839 --> 00:41:06,640
uh different resources

783
00:41:03,599 --> 00:41:09,119
uh let's see is okay so

784
00:41:06,640 --> 00:41:09,118
that's all

785
00:41:12,480 --> 00:41:20,000
so back to the presentation

786
00:41:16,400 --> 00:41:21,440
okay okay i'm late so let's quick

787
00:41:20,000 --> 00:41:25,280
conclusion

788
00:41:21,440 --> 00:41:28,720
uh fingerprints are helpful in hunting

789
00:41:25,280 --> 00:41:32,720
malwares i think

790
00:41:28,720 --> 00:41:35,520
i show i showed you that that but

791
00:41:32,720 --> 00:41:37,279
like you know modeler developers are

792
00:41:35,520 --> 00:41:40,480
also

793
00:41:37,280 --> 00:41:44,319
working and fingerprinters are

794
00:41:40,480 --> 00:41:47,280
good until the the new mechanism of

795
00:41:44,319 --> 00:41:49,520
ours start to evade these fingerprints

796
00:41:47,280 --> 00:41:52,640
and

797
00:41:49,520 --> 00:41:56,400
these tools there is a

798
00:41:52,640 --> 00:41:58,078
all fingerprints including edge finger

799
00:41:56,400 --> 00:41:59,920
there is a problem of this

800
00:41:58,079 --> 00:42:03,839
generalization versus collisions

801
00:41:59,920 --> 00:42:07,839
if you make the fingerprinter more

802
00:42:03,839 --> 00:42:11,040
to give more unique fingerprints then

803
00:42:07,839 --> 00:42:12,240
you have a lot of fingerprints so you

804
00:42:11,040 --> 00:42:15,440
cannot

805
00:42:12,240 --> 00:42:19,279
generalize in a good manner

806
00:42:15,440 --> 00:42:21,440
the the requests sent by by demolar

807
00:42:19,280 --> 00:42:22,400
some popular tools are already called

808
00:42:21,440 --> 00:42:25,599
work

809
00:42:22,400 --> 00:42:27,119
protocols however there are some tools

810
00:42:25,599 --> 00:42:29,370
which can also be

811
00:42:27,119 --> 00:42:31,440
created so call

812
00:42:29,370 --> 00:42:35,440
[Music]

813
00:42:31,440 --> 00:42:37,839
and please give a try to which finger

814
00:42:35,440 --> 00:42:40,319
it was part of the work was sponsored by

815
00:42:37,839 --> 00:42:45,839
european union thank you

816
00:42:40,319 --> 00:42:45,839
and that's all

817
00:42:47,760 --> 00:42:49,839
you

