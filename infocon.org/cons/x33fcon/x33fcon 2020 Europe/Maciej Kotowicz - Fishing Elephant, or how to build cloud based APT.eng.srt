1
00:00:10,400 --> 00:00:14,240
hello guys

2
00:00:11,280 --> 00:00:14,559
um nice of you to join us in the morning

3
00:00:14,240 --> 00:00:16,880
or

4
00:00:14,559 --> 00:00:18,080
evening or whatever it is apparently uh

5
00:00:16,880 --> 00:00:20,640
all around the world

6
00:00:18,080 --> 00:00:22,240
uh for me it's way too early but let's

7
00:00:20,640 --> 00:00:25,840
try to do some things

8
00:00:22,240 --> 00:00:30,320
um so i'll be talking about um

9
00:00:25,840 --> 00:00:33,600
some apt i found a year ago

10
00:00:30,320 --> 00:00:36,239
and how it how they approach is uh

11
00:00:33,600 --> 00:00:38,960
makes easy to create an attack attack

12
00:00:36,239 --> 00:00:41,519
based on cloud tools

13
00:00:38,960 --> 00:00:42,160
as was said my name is machikotovic i go

14
00:00:41,520 --> 00:00:44,640
by mac

15
00:00:42,160 --> 00:00:45,360
in internet uh i'm independent malware

16
00:00:44,640 --> 00:00:48,160
researcher

17
00:00:45,360 --> 00:00:48,879
and operating out of malwarelab.pl which

18
00:00:48,160 --> 00:00:51,120
i found

19
00:00:48,879 --> 00:00:52,320
um it's a small consulting you know

20
00:00:51,120 --> 00:00:54,320
business doing

21
00:00:52,320 --> 00:00:55,440
whatever stuff you need from a free

22
00:00:54,320 --> 00:00:57,520
intelligence uh

23
00:00:55,440 --> 00:00:59,358
to malware reversing and whatever in

24
00:00:57,520 --> 00:01:01,600
that area

25
00:00:59,359 --> 00:01:03,440
uh in my free time i play with dragon

26
00:01:01,600 --> 00:01:07,439
selector in some ctfs

27
00:01:03,440 --> 00:01:08,479
uh and my most my main interest is

28
00:01:07,439 --> 00:01:10,798
universe engineering and exploit

29
00:01:08,479 --> 00:01:12,720
development as well as automatization

30
00:01:10,799 --> 00:01:15,280
and some formal methods in those topics

31
00:01:12,720 --> 00:01:15,280
and there's some

32
00:01:16,080 --> 00:01:20,720
some social media contacts to me and you

33
00:01:18,479 --> 00:01:24,320
know my previous jobs which was uh

34
00:01:20,720 --> 00:01:24,320
senior researcher at great and

35
00:01:24,799 --> 00:01:29,200
malware palmer at sirpolska and the

36
00:01:27,520 --> 00:01:30,798
quick disclaimer is that most of this

37
00:01:29,200 --> 00:01:34,560
research was done when i was uh

38
00:01:30,799 --> 00:01:37,119
at kaspersky so i'm not uh

39
00:01:34,560 --> 00:01:38,479
i cannot share much of the iocs and

40
00:01:37,119 --> 00:01:40,159
what's not because they kind of

41
00:01:38,479 --> 00:01:42,720
you know owned by the kaspersky great

42
00:01:40,159 --> 00:01:44,960
and their private uh reporting

43
00:01:42,720 --> 00:01:47,200
uh services but some of them are public

44
00:01:44,960 --> 00:01:49,119
so if maybe there will be a blog later

45
00:01:47,200 --> 00:01:52,320
on or you can reach me out and i'll

46
00:01:49,119 --> 00:01:52,720
gladly uh share what i can all right so

47
00:01:52,320 --> 00:01:55,520
first

48
00:01:52,720 --> 00:01:57,039
start and some let's do some theoretics

49
00:01:55,520 --> 00:02:00,320
uh how to create an

50
00:01:57,040 --> 00:02:04,399
apt or whatever targeted like attack

51
00:02:00,320 --> 00:02:04,398
and it's kinda nicely uh

52
00:02:04,719 --> 00:02:09,919
uh one second uh it's nicely presented

53
00:02:09,360 --> 00:02:12,879
by this

54
00:02:09,919 --> 00:02:13,839
uh chain of infection or whatever it's

55
00:02:12,879 --> 00:02:16,160
called

56
00:02:13,840 --> 00:02:17,760
uh so yeah this simple steps rally

57
00:02:16,160 --> 00:02:20,480
reconnaissance urbanization

58
00:02:17,760 --> 00:02:21,760
uh delivery exploitation installation

59
00:02:20,480 --> 00:02:23,040
common control and

60
00:02:21,760 --> 00:02:25,120
actions and objectives and actual

61
00:02:23,040 --> 00:02:26,799
objectives will define as an

62
00:02:25,120 --> 00:02:28,160
exploration of data basically stealing

63
00:02:26,800 --> 00:02:31,599
some documents as we want to

64
00:02:28,160 --> 00:02:34,879
have an espionage or whatever

65
00:02:31,599 --> 00:02:36,160
alike campaign and reconnaissance is

66
00:02:34,879 --> 00:02:38,879
something we're kind of

67
00:02:36,160 --> 00:02:40,000
not relying on on a cloud so we'll skip

68
00:02:38,879 --> 00:02:42,079
that and we'll go through

69
00:02:40,000 --> 00:02:43,519
different phases of what we need to to

70
00:02:42,080 --> 00:02:45,200
actually achieve that

71
00:02:43,519 --> 00:02:47,360
uh so first thing we need is kind of

72
00:02:45,200 --> 00:02:50,480
some some some way of storing

73
00:02:47,360 --> 00:02:51,200
files both the one we actually uh we

74
00:02:50,480 --> 00:02:53,679
want to steal

75
00:02:51,200 --> 00:02:54,640
and the one we want to host to to to to

76
00:02:53,680 --> 00:02:56,879
maintain and or

77
00:02:54,640 --> 00:02:58,720
recreate an infection basically and with

78
00:02:56,879 --> 00:03:01,120
that using a payload hosts

79
00:02:58,720 --> 00:03:02,480
we can host payload on a cloud storage

80
00:03:01,120 --> 00:03:05,680
services and you know just

81
00:03:02,480 --> 00:03:07,840
expose the the files to to everyone and

82
00:03:05,680 --> 00:03:10,239
the same we can exfiltrate our data to

83
00:03:07,840 --> 00:03:13,200
those cloud storage providers

84
00:03:10,239 --> 00:03:14,800
and you know all the history like the

85
00:03:13,200 --> 00:03:16,958
dropbox i think is the most popular in

86
00:03:14,800 --> 00:03:19,680
that that

87
00:03:16,959 --> 00:03:20,879
stage of dropping files delivering

88
00:03:19,680 --> 00:03:22,959
delivering payloads and

89
00:03:20,879 --> 00:03:24,798
also google this gun disc or whatever

90
00:03:22,959 --> 00:03:26,159
you wanna use that

91
00:03:24,799 --> 00:03:27,840
it's a perfect solution because you know

92
00:03:26,159 --> 00:03:31,040
it's it's kind of it's free and it's

93
00:03:27,840 --> 00:03:33,040
easy to do to set up next

94
00:03:31,040 --> 00:03:34,079
we need some way to some sort of

95
00:03:33,040 --> 00:03:37,280
computing

96
00:03:34,080 --> 00:03:37,519
and power and we have the solution for

97
00:03:37,280 --> 00:03:39,200
that

98
00:03:37,519 --> 00:03:41,120
anyway we don't need to set up all the

99
00:03:39,200 --> 00:03:43,679
all by the dedicated servers

100
00:03:41,120 --> 00:03:44,640
uh we can use just the platform as a

101
00:03:43,680 --> 00:03:46,720
service providers

102
00:03:44,640 --> 00:03:48,480
or some free hosting share free hosting

103
00:03:46,720 --> 00:03:49,599
which is you know we'll use it for one

104
00:03:48,480 --> 00:03:53,280
campaign and get it

105
00:03:49,599 --> 00:03:56,560
uh removed after one or two

106
00:03:53,280 --> 00:03:57,519
callbacks so it's it's uh it's not easy

107
00:03:56,560 --> 00:03:59,519
for the researchers to

108
00:03:57,519 --> 00:04:01,439
catch up because most of the malware

109
00:03:59,519 --> 00:04:01,760
analysis is kind of a retro hunt retro

110
00:04:01,439 --> 00:04:03,599
uh

111
00:04:01,760 --> 00:04:04,959
retro job right we do we work on the

112
00:04:03,599 --> 00:04:06,079
attack that already happened most of the

113
00:04:04,959 --> 00:04:09,920
time

114
00:04:06,080 --> 00:04:12,720
uh so we can get our c2 callbacks

115
00:04:09,920 --> 00:04:13,439
and you know the intermediate stages or

116
00:04:12,720 --> 00:04:15,599
whatever on

117
00:04:13,439 --> 00:04:16,959
those three free platforms without any

118
00:04:15,599 --> 00:04:20,320
any problems

119
00:04:16,959 --> 00:04:22,160
and without any well if you do it

120
00:04:20,320 --> 00:04:25,280
properly without any risk of exposing it

121
00:04:22,160 --> 00:04:27,040
ourselves and firebase and heroku will

122
00:04:25,280 --> 00:04:27,520
be the one that i will recommend on for

123
00:04:27,040 --> 00:04:30,880
that

124
00:04:27,520 --> 00:04:32,880
also we post oh host has a bunch of

125
00:04:30,880 --> 00:04:34,719
different projects basically a free

126
00:04:32,880 --> 00:04:38,639
hosting and it's abused by

127
00:04:34,720 --> 00:04:40,400
very like abused by apt actors

128
00:04:38,639 --> 00:04:42,080
and for a long time and they're very

129
00:04:40,400 --> 00:04:44,799
proud of it we're well

130
00:04:42,080 --> 00:04:45,120
found of it and then at the end uh we

131
00:04:44,800 --> 00:04:47,040
need

132
00:04:45,120 --> 00:04:48,240
some way of in in

133
00:04:47,040 --> 00:04:51,520
[Music]

134
00:04:48,240 --> 00:04:53,120
in to provide the infection so and

135
00:04:51,520 --> 00:04:54,639
maintaining the infection right so the

136
00:04:53,120 --> 00:04:56,160
first thing will be it opens getting

137
00:04:54,639 --> 00:04:58,000
some exploits exploitation

138
00:04:56,160 --> 00:04:59,520
or idea how to exploit the vulnerability

139
00:04:58,000 --> 00:05:02,160
and then get some malware

140
00:04:59,520 --> 00:05:03,359
and we go obviously to for github on

141
00:05:02,160 --> 00:05:05,680
that

142
00:05:03,360 --> 00:05:07,199
and that's more or less the like the

143
00:05:05,680 --> 00:05:08,960
bricks we need to to create an ipt

144
00:05:07,199 --> 00:05:11,120
attack basically

145
00:05:08,960 --> 00:05:13,120
and we'll a little bit go through how

146
00:05:11,120 --> 00:05:16,639
the fishing elephant and why the name

147
00:05:13,120 --> 00:05:20,000
came out of it uh so the thing

148
00:05:16,639 --> 00:05:20,560
thing that we cannot um overestimate in

149
00:05:20,000 --> 00:05:22,639
the

150
00:05:20,560 --> 00:05:24,320
creating a campaign is the is having a

151
00:05:22,639 --> 00:05:26,400
good good lures

152
00:05:24,320 --> 00:05:27,759
they think that you know sending the

153
00:05:26,400 --> 00:05:28,479
spear phishing document basically

154
00:05:27,759 --> 00:05:30,880
because that's

155
00:05:28,479 --> 00:05:32,159
whoever what everyone is doing and it's

156
00:05:30,880 --> 00:05:34,400
still working

157
00:05:32,160 --> 00:05:35,600
uh it has to contain some document that

158
00:05:34,400 --> 00:05:38,080
is you know conv

159
00:05:35,600 --> 00:05:39,680
will convince a victim to click on it

160
00:05:38,080 --> 00:05:41,039
and get infected

161
00:05:39,680 --> 00:05:43,440
so what they did in the first campaign

162
00:05:41,039 --> 00:05:45,840
they start sending the cvs

163
00:05:43,440 --> 00:05:47,120
because cv is something that you know if

164
00:05:45,840 --> 00:05:49,520
the company or

165
00:05:47,120 --> 00:05:50,240
the institution is recruiting there is a

166
00:05:49,520 --> 00:05:52,000
they will

167
00:05:50,240 --> 00:05:53,600
more likely click on it to get you know

168
00:05:52,000 --> 00:05:54,960
the candidates and inform candidates

169
00:05:53,600 --> 00:05:56,800
information

170
00:05:54,960 --> 00:05:58,880
uh so they didn't they didn't send the

171
00:05:56,800 --> 00:06:00,479
um the documents itself they sent the

172
00:05:58,880 --> 00:06:04,560
link to a

173
00:06:00,479 --> 00:06:04,560
deduct to a page that they hosted on

174
00:06:05,280 --> 00:06:11,119
they hosted on heroku this time and that

175
00:06:08,800 --> 00:06:13,360
mimicked uh google docs well google

176
00:06:11,120 --> 00:06:16,160
drive basically and their

177
00:06:13,360 --> 00:06:17,280
interface for open showing and opening

178
00:06:16,160 --> 00:06:20,400
files

179
00:06:17,280 --> 00:06:22,159
and and since it was quite quite

180
00:06:20,400 --> 00:06:23,840
some time ago i think at the time that

181
00:06:22,160 --> 00:06:26,639
the actual the urls were kind of similar

182
00:06:23,840 --> 00:06:29,198
to the one that's that's presented in

183
00:06:26,639 --> 00:06:29,840
in a screenshot uh it was quite cryptic

184
00:06:29,199 --> 00:06:32,240
so

185
00:06:29,840 --> 00:06:33,119
for them for the normal user it was you

186
00:06:32,240 --> 00:06:35,199
know it was

187
00:06:33,120 --> 00:06:36,479
pretty okay to to actually click on it

188
00:06:35,199 --> 00:06:40,160
and it was ssl

189
00:06:36,479 --> 00:06:42,000
enabled with a yeah so no problem there

190
00:06:40,160 --> 00:06:43,840
and it looks normally like a google docs

191
00:06:42,000 --> 00:06:46,720
so it had a pretty good

192
00:06:43,840 --> 00:06:47,758
write uh if we click on it the download

193
00:06:46,720 --> 00:06:50,639
button it says

194
00:06:47,759 --> 00:06:52,080
it was a simple html file uh html page

195
00:06:50,639 --> 00:06:55,759
with bunch of javascript

196
00:06:52,080 --> 00:06:58,960
for detection of browsers and you know

197
00:06:55,759 --> 00:07:02,080
going proper redirects uh we'll get this

198
00:06:58,960 --> 00:07:04,479
small hda that will launch in our

199
00:07:02,080 --> 00:07:04,479
browser

200
00:07:04,610 --> 00:07:08,319
[Music]

201
00:07:05,759 --> 00:07:08,800
right it's a simple stuff it will open

202
00:07:08,319 --> 00:07:10,639
it will

203
00:07:08,800 --> 00:07:14,000
download the next next stage while the

204
00:07:10,639 --> 00:07:17,280
final stage the the malware

205
00:07:14,000 --> 00:07:19,680
and open uh chrome browser with

206
00:07:17,280 --> 00:07:20,318
google drive link which will actually

207
00:07:19,680 --> 00:07:23,280
shows the

208
00:07:20,319 --> 00:07:23,919
the the actual um the actual document

209
00:07:23,280 --> 00:07:27,039
that the

210
00:07:23,919 --> 00:07:28,080
cv that's that's uh that's supposed to

211
00:07:27,039 --> 00:07:30,000
be send it

212
00:07:28,080 --> 00:07:31,199
so in from from a user perspective it

213
00:07:30,000 --> 00:07:33,759
was more or less

214
00:07:31,199 --> 00:07:35,440
uh invisible to to actually so what's

215
00:07:33,759 --> 00:07:38,240
what's happening

216
00:07:35,440 --> 00:07:39,199
uh obviously the the browser here was uh

217
00:07:38,240 --> 00:07:42,160
was

218
00:07:39,199 --> 00:07:43,120
depending on the browser that came to

219
00:07:42,160 --> 00:07:44,479
the

220
00:07:43,120 --> 00:07:47,039
user engine from the browser that came

221
00:07:44,479 --> 00:07:48,719
to the to the the staging page right so

222
00:07:47,039 --> 00:07:50,080
if it will be firefox it will firefox

223
00:07:48,720 --> 00:07:53,599
open firefox if not

224
00:07:50,080 --> 00:07:54,639
uh uh if it will be internet explorer

225
00:07:53,599 --> 00:07:56,878
will bring

226
00:07:54,639 --> 00:07:57,759
blah blah blah right chrome chrome uh

227
00:07:56,879 --> 00:08:01,199
then you can see that

228
00:07:57,759 --> 00:08:02,160
uh there is a powershell used for the

229
00:08:01,199 --> 00:08:05,520
downloading and the

230
00:08:02,160 --> 00:08:08,560
url is hidden by using bitly um

231
00:08:05,520 --> 00:08:10,560
which will be important later

232
00:08:08,560 --> 00:08:13,840
okay and that's got a pretty good

233
00:08:10,560 --> 00:08:13,840
infection rate but it's

234
00:08:14,800 --> 00:08:18,240
yeah so it gets pretty good infection

235
00:08:16,639 --> 00:08:20,240
rate right

236
00:08:18,240 --> 00:08:21,840
some summary of that if you didn't

237
00:08:20,240 --> 00:08:22,960
install it on the slides and i didn't

238
00:08:21,840 --> 00:08:24,638
mention it

239
00:08:22,960 --> 00:08:27,039
properly so there was a spearfishing

240
00:08:24,639 --> 00:08:30,400
image with a fake google drive

241
00:08:27,039 --> 00:08:33,360
dogs look alike are posted on heroku

242
00:08:30,400 --> 00:08:34,319
and that's actually why the name of the

243
00:08:33,360 --> 00:08:37,599
the doctor

244
00:08:34,320 --> 00:08:40,320
is from the fishing part

245
00:08:37,599 --> 00:08:41,360
because i when i was seeing it it was

246
00:08:40,320 --> 00:08:43,599
very much

247
00:08:41,360 --> 00:08:44,399
like like a normal phishing applications

248
00:08:43,599 --> 00:08:46,000
not the

249
00:08:44,399 --> 00:08:47,920
malware campaigns right it would become

250
00:08:46,000 --> 00:08:49,040
something like that to get credentials

251
00:08:47,920 --> 00:08:51,199
not to drop malware

252
00:08:49,040 --> 00:08:52,880
most of the time these guys went a

253
00:08:51,200 --> 00:08:56,160
little bit further and decided to

254
00:08:52,880 --> 00:08:57,839
to do some infection instead the decoy

255
00:08:56,160 --> 00:09:00,079
image hosted this on the google drive

256
00:08:57,839 --> 00:09:02,880
bunch of them actually and they're still

257
00:09:00,080 --> 00:09:05,519
there for a long long time

258
00:09:02,880 --> 00:09:06,720
and you can then they get up by the

259
00:09:05,519 --> 00:09:08,399
browser so there's

260
00:09:06,720 --> 00:09:09,839
more or less no suspicion because if you

261
00:09:08,399 --> 00:09:11,600
have a browser already opened

262
00:09:09,839 --> 00:09:13,680
up in the same browser it will open this

263
00:09:11,600 --> 00:09:17,360
new new new tab not the new pro

264
00:09:13,680 --> 00:09:19,920
new new window in most configurations

265
00:09:17,360 --> 00:09:20,800
uh some hindering of the payload by

266
00:09:19,920 --> 00:09:22,319
bitly

267
00:09:20,800 --> 00:09:24,399
and the payload was hosted on the cloud

268
00:09:22,320 --> 00:09:27,040
storage services and

269
00:09:24,399 --> 00:09:28,399
it was mostly dropbox some yandex disks

270
00:09:27,040 --> 00:09:30,560
asus web storage

271
00:09:28,399 --> 00:09:32,880
a bunch of different different stuff

272
00:09:30,560 --> 00:09:36,560
depending on

273
00:09:32,880 --> 00:09:38,640
on the alert that it was used

274
00:09:36,560 --> 00:09:40,399
this is quite a complex scheme so they

275
00:09:38,640 --> 00:09:41,360
decided to like with the the dropping

276
00:09:40,399 --> 00:09:45,120
the hta

277
00:09:41,360 --> 00:09:47,200
uh i think it was also relying on um

278
00:09:45,120 --> 00:09:49,120
i wasn't like anything it was uh you

279
00:09:47,200 --> 00:09:49,600
know we need to convince user to click

280
00:09:49,120 --> 00:09:51,839
to

281
00:09:49,600 --> 00:09:53,279
do basically two clicks because he needs

282
00:09:51,839 --> 00:09:56,720
to click on a link for

283
00:09:53,279 --> 00:09:58,399
in the email and then on a on a document

284
00:09:56,720 --> 00:09:59,760
that was dropped so maybe

285
00:09:58,399 --> 00:10:01,920
i don't know they decided not it's not

286
00:09:59,760 --> 00:10:02,880
it's not a good idea or was too complex

287
00:10:01,920 --> 00:10:06,319
and you cannot

288
00:10:02,880 --> 00:10:06,720
um at the end the cvs are only good for

289
00:10:06,320 --> 00:10:09,519
uh

290
00:10:06,720 --> 00:10:11,279
for a short period of time because maybe

291
00:10:09,519 --> 00:10:13,839
they attacking their target didn't

292
00:10:11,279 --> 00:10:14,880
recruit anything or was you know closed

293
00:10:13,839 --> 00:10:17,680
in that area

294
00:10:14,880 --> 00:10:18,240
so they decided to move towards more

295
00:10:17,680 --> 00:10:21,279
more

296
00:10:18,240 --> 00:10:22,800
convenient more typical approach uh

297
00:10:21,279 --> 00:10:25,839
spoofing some emails

298
00:10:22,800 --> 00:10:28,160
from you know big uh big names and using

299
00:10:25,839 --> 00:10:30,320
the documents of uh

300
00:10:28,160 --> 00:10:31,600
current events or the events that were

301
00:10:30,320 --> 00:10:32,320
happening all the events that were

302
00:10:31,600 --> 00:10:35,600
happening

303
00:10:32,320 --> 00:10:39,600
inside of the the target um

304
00:10:35,600 --> 00:10:41,920
like you know they managed to get some

305
00:10:39,600 --> 00:10:42,800
names of the internal documents or like

306
00:10:41,920 --> 00:10:44,560
uh

307
00:10:42,800 --> 00:10:46,399
or guess what what would be the set will

308
00:10:44,560 --> 00:10:49,760
be the sending the the different

309
00:10:46,399 --> 00:10:50,880
different documents about uh day-to-day

310
00:10:49,760 --> 00:10:54,880
work

311
00:10:50,880 --> 00:10:56,079
um my guess is they get it from

312
00:10:54,880 --> 00:10:58,480
different phishing campaigns they're

313
00:10:56,079 --> 00:11:00,399
probably doing i never managed to

314
00:10:58,480 --> 00:11:02,079
connect the dots if it's actually them

315
00:11:00,399 --> 00:11:04,000
but it's more likely that

316
00:11:02,079 --> 00:11:05,439
most likely them uh what they're doing

317
00:11:04,000 --> 00:11:07,360
they're setting up the

318
00:11:05,440 --> 00:11:09,120
fake zimbra servers and phishing for

319
00:11:07,360 --> 00:11:12,320
actually uh email accounts

320
00:11:09,120 --> 00:11:13,200
as well to get um the point of the way

321
00:11:12,320 --> 00:11:16,880
of sending

322
00:11:13,200 --> 00:11:18,079
emails to the victims from legitimate

323
00:11:16,880 --> 00:11:20,079
organizations

324
00:11:18,079 --> 00:11:21,599
with from within uh so this will get

325
00:11:20,079 --> 00:11:23,519
like this fancy fancy email from

326
00:11:21,600 --> 00:11:26,160
government of afghanistan

327
00:11:23,519 --> 00:11:28,800
with some documents so you know pretty

328
00:11:26,160 --> 00:11:32,079
convincing to open

329
00:11:28,800 --> 00:11:36,959
inside dde comments to get

330
00:11:32,079 --> 00:11:36,959
another payload uh again hta

331
00:11:37,920 --> 00:11:41,519
again hosted on dropbox you know some

332
00:11:40,720 --> 00:11:43,920
simple stuff

333
00:11:41,519 --> 00:11:45,200
this time not nope not powerful but

334
00:11:43,920 --> 00:11:48,719
beats admin is used so

335
00:11:45,200 --> 00:11:50,480
they're they found of uh

336
00:11:48,720 --> 00:11:52,160
living of the land or whatever you want

337
00:11:50,480 --> 00:11:52,639
to call those this approach of you know

338
00:11:52,160 --> 00:11:54,719
using

339
00:11:52,639 --> 00:11:56,959
uh services that already on the on the

340
00:11:54,720 --> 00:11:57,519
disk and not putting very much effort

341
00:11:56,959 --> 00:12:00,880
into

342
00:11:57,519 --> 00:12:02,320
creating their own stuff um so we get

343
00:12:00,880 --> 00:12:02,720
this the payload is more or less the

344
00:12:02,320 --> 00:12:04,959
same

345
00:12:02,720 --> 00:12:06,639
it will use again the the beside me to

346
00:12:04,959 --> 00:12:09,760
get and get a payload

347
00:12:06,639 --> 00:12:10,720
and load it to the registry you know to

348
00:12:09,760 --> 00:12:14,639
get some precision

349
00:12:10,720 --> 00:12:17,839
persistence a more or less the same

350
00:12:14,639 --> 00:12:19,920
the same template for for rta

351
00:12:17,839 --> 00:12:22,720
so i'm pretty sure it's actually from

352
00:12:19,920 --> 00:12:25,199
some builder that they didn't found it

353
00:12:22,720 --> 00:12:26,399
and this time the the the modification

354
00:12:25,200 --> 00:12:29,760
was that they used uh

355
00:12:26,399 --> 00:12:31,040
actual ip addresses of some dedicated

356
00:12:29,760 --> 00:12:35,040
servers instead of

357
00:12:31,040 --> 00:12:39,839
uh instead of cloud service but you know

358
00:12:35,040 --> 00:12:39,839
um you need some diversity at the end

359
00:12:39,920 --> 00:12:44,000
infection goes pretty nicely so

360
00:12:42,480 --> 00:12:45,839
spearfishing with reference to internal

361
00:12:44,000 --> 00:12:48,880
documents and current events

362
00:12:45,839 --> 00:12:51,440
did he abuse the first second page

363
00:12:48,880 --> 00:12:52,000
this time there was no no decoy document

364
00:12:51,440 --> 00:12:54,560
basically

365
00:12:52,000 --> 00:12:56,240
the first document was just a blank page

366
00:12:54,560 --> 00:12:59,760
and nothing else

367
00:12:56,240 --> 00:12:59,760
i think that's kind of a bad

368
00:13:01,200 --> 00:13:05,360
bad craft it's supposed to i think it

369
00:13:03,200 --> 00:13:07,440
should so

370
00:13:05,360 --> 00:13:08,959
show something at the end so the the

371
00:13:07,440 --> 00:13:12,240
user is

372
00:13:08,959 --> 00:13:14,959
more or less sure that uh

373
00:13:12,240 --> 00:13:16,160
the document he saw was was actually a

374
00:13:14,959 --> 00:13:19,439
legit document

375
00:13:16,160 --> 00:13:20,639
the real one but no at the end at the

376
00:13:19,440 --> 00:13:23,839
end every other day can

377
00:13:20,639 --> 00:13:26,720
someone can slip off um

378
00:13:23,839 --> 00:13:28,240
relying on the off of the shelf tools uh

379
00:13:26,720 --> 00:13:29,760
beside me and i think i

380
00:13:28,240 --> 00:13:31,519
found different ones as well but i don't

381
00:13:29,760 --> 00:13:34,399
remember which one right now

382
00:13:31,519 --> 00:13:35,279
uh and the game payload was uh link was

383
00:13:34,399 --> 00:13:39,680
hindered by uh

384
00:13:35,279 --> 00:13:39,680
via bitly at some point uh

385
00:13:40,639 --> 00:13:44,160
later on they uh they were they were

386
00:13:42,320 --> 00:13:46,800
very fond of the

387
00:13:44,160 --> 00:13:48,160
rely on some third-party service that

388
00:13:46,800 --> 00:13:51,439
was actually generating

389
00:13:48,160 --> 00:13:52,319
links i let the shorter links through

390
00:13:51,440 --> 00:13:54,160
those

391
00:13:52,320 --> 00:13:56,000
this this third party site that will

392
00:13:54,160 --> 00:13:58,480
then redirect to the final

393
00:13:56,000 --> 00:14:00,639
final destination i think maybe for a

394
00:13:58,480 --> 00:14:03,839
statistics collection or what's not

395
00:14:00,639 --> 00:14:04,800
but it was very easy to actually find

396
00:14:03,839 --> 00:14:07,920
them due to that

397
00:14:04,800 --> 00:14:10,000
because it stand out very very nicely

398
00:14:07,920 --> 00:14:13,760
and you'll see that you'll see the link

399
00:14:10,000 --> 00:14:13,760
at some point later on

400
00:14:13,920 --> 00:14:18,240
um and the third campaign type of

401
00:14:16,959 --> 00:14:21,199
campaign i found

402
00:14:18,240 --> 00:14:22,560
in the beginning of this year um they

403
00:14:21,199 --> 00:14:25,439
added the geofencing

404
00:14:22,560 --> 00:14:26,000
to this day first stage so they want to

405
00:14:25,440 --> 00:14:29,360
maybe

406
00:14:26,000 --> 00:14:30,880
uh concentrate more on the countries

407
00:14:29,360 --> 00:14:33,199
victims from the from the specific

408
00:14:30,880 --> 00:14:35,279
country so it was

409
00:14:33,199 --> 00:14:36,719
harder for the for the attackers for the

410
00:14:35,279 --> 00:14:39,040
recession actually for me

411
00:14:36,720 --> 00:14:40,160
uh to find out what's going on because

412
00:14:39,040 --> 00:14:45,839
if you call the directly

413
00:14:40,160 --> 00:14:45,839
directly the directly uh

414
00:14:46,480 --> 00:14:50,480
app that was hosted again on heroku it

415
00:14:48,639 --> 00:14:53,360
was uh

416
00:14:50,480 --> 00:14:54,399
at this time it was simple uh php file i

417
00:14:53,360 --> 00:14:56,880
think

418
00:14:54,399 --> 00:14:59,279
uh yeah so you get the redirection to

419
00:14:56,880 --> 00:15:00,240
the dropbox that the hta again caused on

420
00:14:59,279 --> 00:15:02,160
the dropbox

421
00:15:00,240 --> 00:15:03,279
but it was banning one that will just

422
00:15:02,160 --> 00:15:06,000
start a

423
00:15:03,279 --> 00:15:07,199
windows update service so it's still

424
00:15:06,000 --> 00:15:08,399
pretty uh

425
00:15:07,199 --> 00:15:10,399
strange to see if you go for the

426
00:15:08,399 --> 00:15:13,360
document and it's trying to

427
00:15:10,399 --> 00:15:15,519
download the document and you open the

428
00:15:13,360 --> 00:15:17,760
um

429
00:15:15,519 --> 00:15:18,560
open it starts opening the windows

430
00:15:17,760 --> 00:15:21,040
update service

431
00:15:18,560 --> 00:15:22,399
but i don't know the decision it was

432
00:15:21,040 --> 00:15:25,519
also using the

433
00:15:22,399 --> 00:15:28,079
dd as well not the nothing else

434
00:15:25,519 --> 00:15:29,199
so this basically changed was that they

435
00:15:28,079 --> 00:15:32,560
moved to the

436
00:15:29,199 --> 00:15:35,359
uh more fingerprinting on heroku and

437
00:15:32,560 --> 00:15:36,160
uh if you manage to get a proper payload

438
00:15:35,360 --> 00:15:40,079
it will

439
00:15:36,160 --> 00:15:43,199
download some text file from the

440
00:15:40,079 --> 00:15:44,239
from from from dropbox again and that

441
00:15:43,199 --> 00:15:47,199
the text file was

442
00:15:44,240 --> 00:15:48,160
mimicked as a certificate so they can

443
00:15:47,199 --> 00:15:51,599
use certutil

444
00:15:48,160 --> 00:15:52,160
uh to basically debase 64 the base64

445
00:15:51,600 --> 00:15:54,560
decode

446
00:15:52,160 --> 00:15:57,759
the payload into the actual exit so it

447
00:15:54,560 --> 00:15:59,758
has all of those nice um

448
00:15:57,759 --> 00:16:00,880
header and footer from from certificate

449
00:15:59,759 --> 00:16:04,959
but then like it was just

450
00:16:00,880 --> 00:16:07,439
simple uh simple base64 encoded

451
00:16:04,959 --> 00:16:08,800
binary so stood if you look at it for a

452
00:16:07,440 --> 00:16:10,320
few seconds it actually stood out

453
00:16:08,800 --> 00:16:10,880
because of the size i know because of

454
00:16:10,320 --> 00:16:12,720
the

455
00:16:10,880 --> 00:16:15,120
starting bias that doesn't didn't match

456
00:16:12,720 --> 00:16:17,040
the proper uh ssl certificate

457
00:16:15,120 --> 00:16:18,880
but then you know they can use that this

458
00:16:17,040 --> 00:16:21,519
this nice those dice tool to

459
00:16:18,880 --> 00:16:22,160
actually decode it and they don't in

460
00:16:21,519 --> 00:16:23,839
besides

461
00:16:22,160 --> 00:16:26,000
the power shall be the simple power

462
00:16:23,839 --> 00:16:28,800
should be invoked there is

463
00:16:26,000 --> 00:16:28,800
not much of a

464
00:16:29,040 --> 00:16:35,279
suspicious uh comments being uh

465
00:16:32,160 --> 00:16:38,319
executed right um and some persistence

466
00:16:35,279 --> 00:16:38,320
done with the registry

467
00:16:40,959 --> 00:16:47,439
okay so that's how you get to the system

468
00:16:44,399 --> 00:16:48,639
pretty easy you get to the system and

469
00:16:47,440 --> 00:16:50,800
if you get to the system you need to

470
00:16:48,639 --> 00:16:52,000
drop something um because you need to

471
00:16:50,800 --> 00:16:53,920
maintain a connection

472
00:16:52,000 --> 00:16:55,759
and having only powershell based stuff

473
00:16:53,920 --> 00:16:56,560
well it's still it's still in some sort

474
00:16:55,759 --> 00:16:59,199
of

475
00:16:56,560 --> 00:16:59,758
some sort of route or backdoor obviously

476
00:16:59,199 --> 00:17:02,160
if you wanna

477
00:16:59,759 --> 00:17:04,319
you need it you go for the github it

478
00:17:02,160 --> 00:17:07,439
costs a lot of a lot of

479
00:17:04,319 --> 00:17:10,079
tools like that for the risk for the

480
00:17:07,439 --> 00:17:11,120
educational problem reasons or whatever

481
00:17:10,079 --> 00:17:13,760
you want to call them

482
00:17:11,119 --> 00:17:14,879
you have even have some tags so go right

483
00:17:13,760 --> 00:17:17,199
back door or

484
00:17:14,880 --> 00:17:18,160
there is a curated list of all the nice

485
00:17:17,199 --> 00:17:21,120
things you can

486
00:17:18,160 --> 00:17:22,959
get and basically compile your own

487
00:17:21,119 --> 00:17:26,000
malware and have it

488
00:17:22,959 --> 00:17:26,799
dropped on the victim machine without

489
00:17:26,000 --> 00:17:29,919
you know being

490
00:17:26,799 --> 00:17:32,480
able to vote um well with actually by

491
00:17:29,919 --> 00:17:36,799
passing all of the code

492
00:17:32,480 --> 00:17:39,919
based attribution systems

493
00:17:36,799 --> 00:17:40,799
sorry what they what they settled down

494
00:17:39,919 --> 00:17:44,559
was for

495
00:17:40,799 --> 00:17:47,600
old python rat named rs

496
00:17:44,559 --> 00:17:48,000
they took some very very old version of

497
00:17:47,600 --> 00:17:51,039
it

498
00:17:48,000 --> 00:17:52,160
um it's already not being developed for

499
00:17:51,039 --> 00:17:54,160
three years and they think that they

500
00:17:52,160 --> 00:17:56,720
totally want like from

501
00:17:54,160 --> 00:17:58,160
2017 or something that's more or less

502
00:17:56,720 --> 00:18:01,039
when i'm

503
00:17:58,160 --> 00:18:02,720
assessing their starting data campaigns

504
00:18:01,039 --> 00:18:05,120
so probably they found one and

505
00:18:02,720 --> 00:18:06,640
said ah it's okay because at the end

506
00:18:05,120 --> 00:18:07,280
they're not doing much on the computer

507
00:18:06,640 --> 00:18:09,120
they're just

508
00:18:07,280 --> 00:18:10,639
dropping the malware then dropping some

509
00:18:09,120 --> 00:18:14,159
comments to get um

510
00:18:10,640 --> 00:18:17,120
get still the data as i will

511
00:18:14,160 --> 00:18:19,039
show you later so what this little bit

512
00:18:17,120 --> 00:18:20,320
more that rs can do it can upload file

513
00:18:19,039 --> 00:18:22,720
download file uh

514
00:18:20,320 --> 00:18:23,600
zip some files or directory ident used

515
00:18:22,720 --> 00:18:26,400
by them

516
00:18:23,600 --> 00:18:27,760
uh change directory and execute cmdx

517
00:18:26,400 --> 00:18:29,120
commands which is the most

518
00:18:27,760 --> 00:18:31,039
they basically what they do they

519
00:18:29,120 --> 00:18:34,239
download the file

520
00:18:31,039 --> 00:18:35,520
from them from dropbox to to put a bunch

521
00:18:34,240 --> 00:18:38,799
of files to dropbox

522
00:18:35,520 --> 00:18:41,840
from dropbox to to to the computer and

523
00:18:38,799 --> 00:18:44,480
execute them uh with cmdx

524
00:18:41,840 --> 00:18:46,080
and you know do stuff what they need

525
00:18:44,480 --> 00:18:49,440
what they're supposed to do

526
00:18:46,080 --> 00:18:52,480
uh it's not obviously not only damaging

527
00:18:49,440 --> 00:18:54,240
uh uh using open source tools

528
00:18:52,480 --> 00:18:56,799
for the infection if you go for some

529
00:18:54,240 --> 00:18:57,840
statistics but from anyone for example

530
00:18:56,799 --> 00:19:00,080
you'll see that

531
00:18:57,840 --> 00:19:01,918
on the top of their list most of them

532
00:19:00,080 --> 00:19:03,760
are later open source or

533
00:19:01,919 --> 00:19:06,000
licked or cracked which is basically the

534
00:19:03,760 --> 00:19:07,440
same because you know you can build your

535
00:19:06,000 --> 00:19:11,520
own stuff and have it

536
00:19:07,440 --> 00:19:12,799
deployed pretty easily so

537
00:19:11,520 --> 00:19:16,000
yeah maybe that's a little bit of a

538
00:19:12,799 --> 00:19:17,360
problem or either maybe not

539
00:19:16,000 --> 00:19:19,280
hard to say right now if it's a good

540
00:19:17,360 --> 00:19:23,439
thing that it's so nicely it's

541
00:19:19,280 --> 00:19:23,440
so easy to get malware

542
00:19:23,679 --> 00:19:28,640
or maybe it's too much okay acceleration

543
00:19:27,440 --> 00:19:30,080
because that was the other

544
00:19:28,640 --> 00:19:32,720
very interesting part they get to the

545
00:19:30,080 --> 00:19:34,720
machine they get the control of it

546
00:19:32,720 --> 00:19:35,919
now they're after the documents uh so

547
00:19:34,720 --> 00:19:37,440
they what they did

548
00:19:35,919 --> 00:19:39,600
they dropped the powershell and another

549
00:19:37,440 --> 00:19:41,039
powershell script that will download

550
00:19:39,600 --> 00:19:43,840
free files

551
00:19:41,039 --> 00:19:46,320
and actually those files i think that's

552
00:19:43,840 --> 00:19:49,439
still on the on the dropbox as well

553
00:19:46,320 --> 00:19:53,200
uh system exit mpxe

554
00:19:49,440 --> 00:19:56,400
and airclone.com and erickland.com

555
00:19:53,200 --> 00:19:58,640
is um very nice stuff

556
00:19:56,400 --> 00:20:00,400
because those three files one is uh

557
00:19:58,640 --> 00:20:02,000
systemaxy is basically that the real

558
00:20:00,400 --> 00:20:05,280
name is arkham.exe

559
00:20:02,000 --> 00:20:08,000
and they have those hashes and uh

560
00:20:05,280 --> 00:20:08,399
is 7-zip so even if they're they payload

561
00:20:08,000 --> 00:20:11,679
or

562
00:20:08,400 --> 00:20:13,600
their rat already had the zipping

563
00:20:11,679 --> 00:20:15,120
capability they decided it's not worth

564
00:20:13,600 --> 00:20:19,120
to using it let's

565
00:20:15,120 --> 00:20:20,399
drop a 7-zip binary and use it as a as a

566
00:20:19,120 --> 00:20:23,439
compressor

567
00:20:20,400 --> 00:20:25,600
and aircraft backup around clone

568
00:20:23,440 --> 00:20:27,520
con for the configuration file for this

569
00:20:25,600 --> 00:20:31,840
airclone.exe and

570
00:20:27,520 --> 00:20:34,639
iclone.xd is basically a simple

571
00:20:31,840 --> 00:20:36,480
command line tool that's used to

572
00:20:34,640 --> 00:20:39,600
managing cloud storage

573
00:20:36,480 --> 00:20:41,440
it's written in go so it's pretty nicely

574
00:20:39,600 --> 00:20:43,360
it's just that one big static binary

575
00:20:41,440 --> 00:20:45,760
that you can drop and don't care about

576
00:20:43,360 --> 00:20:45,760
anything

577
00:20:45,919 --> 00:20:52,080
so very nice very

578
00:20:49,360 --> 00:20:52,559
very nice that's something you want to

579
00:20:52,080 --> 00:20:55,840
have

580
00:20:52,559 --> 00:20:58,480
when you're pawning different machines

581
00:20:55,840 --> 00:21:00,639
static binaries are the thing that if

582
00:20:58,480 --> 00:21:02,480
you rely on them that's pretty nice

583
00:21:00,640 --> 00:21:04,640
because they will more or less work

584
00:21:02,480 --> 00:21:06,880
everywhere and what they get what you

585
00:21:04,640 --> 00:21:09,679
have in this communication

586
00:21:06,880 --> 00:21:12,320
what you have in this file is you know

587
00:21:09,679 --> 00:21:14,640
some access tokens

588
00:21:12,320 --> 00:21:16,399
to get to the google drive basically so

589
00:21:14,640 --> 00:21:16,880
what they did with that those files they

590
00:21:16,400 --> 00:21:18,880
drop

591
00:21:16,880 --> 00:21:21,039
dropped another uh they will drop

592
00:21:18,880 --> 00:21:24,240
another

593
00:21:21,039 --> 00:21:27,200
another bar another

594
00:21:24,240 --> 00:21:28,320
batch file that will iterate over all

595
00:21:27,200 --> 00:21:32,159
the disks

596
00:21:28,320 --> 00:21:35,200
and we'll look for all those documents

597
00:21:32,159 --> 00:21:36,720
and compress them and use this uh clone

598
00:21:35,200 --> 00:21:40,400
utility to

599
00:21:36,720 --> 00:21:42,159
push them to the google google drive

600
00:21:40,400 --> 00:21:44,159
and those commands are also hosted on

601
00:21:42,159 --> 00:21:45,760
the google google drive as well in the

602
00:21:44,159 --> 00:21:49,840
same one

603
00:21:45,760 --> 00:21:53,120
in form of documents so there is a

604
00:21:49,840 --> 00:21:54,480
uh there is another file there is

605
00:21:53,120 --> 00:21:57,600
another binary that they

606
00:21:54,480 --> 00:22:01,760
never managed to file find that will

607
00:21:57,600 --> 00:22:04,240
be uh take care of those

608
00:22:01,760 --> 00:22:05,520
oh sorry uh if you look closely there is

609
00:22:04,240 --> 00:22:08,720
that this the dot

610
00:22:05,520 --> 00:22:11,440
dr b extension and you know all of those

611
00:22:08,720 --> 00:22:13,840
previous ones are later related to the

612
00:22:11,440 --> 00:22:15,919
documents or scans or what's not

613
00:22:13,840 --> 00:22:17,678
but that are pr are for the keylogger

614
00:22:15,919 --> 00:22:18,799
and i never find the keylogger

615
00:22:17,679 --> 00:22:21,840
unfortunately

616
00:22:18,799 --> 00:22:22,639
uh for a long time i thought it's uh

617
00:22:21,840 --> 00:22:25,280
it's um

618
00:22:22,640 --> 00:22:27,039
it's supposed to be ruby scripts for

619
00:22:25,280 --> 00:22:29,520
some reason but no it's for for uh

620
00:22:27,039 --> 00:22:30,080
for a key logger i'm suspecting it's

621
00:22:29,520 --> 00:22:33,120
also

622
00:22:30,080 --> 00:22:35,280
some sort of open source kilogram uh but

623
00:22:33,120 --> 00:22:36,879
i never found it unfortunately if

624
00:22:35,280 --> 00:22:39,039
someone knows

625
00:22:36,880 --> 00:22:41,120
the one that's actually to have this and

626
00:22:39,039 --> 00:22:43,520
i think lua was the other one

627
00:22:41,120 --> 00:22:45,280
the other extension appended to the to

628
00:22:43,520 --> 00:22:48,000
the keylog file please let me know

629
00:22:45,280 --> 00:22:48,639
i will be happy to see to talk about it

630
00:22:48,000 --> 00:22:50,240
um

631
00:22:48,640 --> 00:22:52,559
so what they did you know get the files

632
00:22:50,240 --> 00:22:55,280
compress them and

633
00:22:52,559 --> 00:22:56,158
push them to the google docs and be done

634
00:22:55,280 --> 00:22:58,158
with it clean up

635
00:22:56,159 --> 00:23:00,000
you know problem solved unlimited

636
00:22:58,159 --> 00:23:03,120
storage no problem

637
00:23:00,000 --> 00:23:06,960
uh okay so pros and cons of those pro

638
00:23:03,120 --> 00:23:10,639
of the these solutions um

639
00:23:06,960 --> 00:23:14,080
from attacker point of view uh obviously

640
00:23:10,640 --> 00:23:16,400
uh so they are free in for the

641
00:23:14,080 --> 00:23:18,158
for the most part of it if they you're

642
00:23:16,400 --> 00:23:20,320
not exfiltrating terabytes of data

643
00:23:18,159 --> 00:23:22,799
because that would be a problem

644
00:23:20,320 --> 00:23:23,360
i think uh and it could be at some point

645
00:23:22,799 --> 00:23:26,879
maybe

646
00:23:23,360 --> 00:23:29,520
caught by the uh organization anyway

647
00:23:26,880 --> 00:23:30,400
if this is not seeing the spike of of

648
00:23:29,520 --> 00:23:32,799
data uh

649
00:23:30,400 --> 00:23:33,760
leaving the company or institutional

650
00:23:32,799 --> 00:23:36,559
whatever

651
00:23:33,760 --> 00:23:38,080
uh so it's free it's a little setup uh

652
00:23:36,559 --> 00:23:38,639
basically you need to click a few

653
00:23:38,080 --> 00:23:40,559
buttons

654
00:23:38,640 --> 00:23:42,799
and have all of the things you need uh

655
00:23:40,559 --> 00:23:45,600
that's working

656
00:23:42,799 --> 00:23:46,879
uh it's hard to figure it out from the

657
00:23:45,600 --> 00:23:48,320
from from researcher point who's

658
00:23:46,880 --> 00:23:50,799
actually using like so basically that

659
00:23:48,320 --> 00:23:54,000
attribution is kind of tricky

660
00:23:50,799 --> 00:23:54,000
because you know there is no

661
00:23:54,559 --> 00:23:56,799
not

662
00:23:57,840 --> 00:24:01,199
well depending on on a service it's

663
00:23:59,520 --> 00:24:01,679
there's not it's not much possibility to

664
00:24:01,200 --> 00:24:05,840
say

665
00:24:01,679 --> 00:24:05,840
who's owns the links

666
00:24:06,480 --> 00:24:09,440
if you want to get fancy you can get an

667
00:24:08,240 --> 00:24:11,039
easy and scriptable access to your

668
00:24:09,440 --> 00:24:13,120
assets because those

669
00:24:11,039 --> 00:24:15,440
cloud services mostly expose some sort

670
00:24:13,120 --> 00:24:18,879
of api

671
00:24:15,440 --> 00:24:20,720
and you know using open source tools and

672
00:24:18,880 --> 00:24:22,320
you can keys code base attribution

673
00:24:20,720 --> 00:24:23,200
goodbye because you know everyone is

674
00:24:22,320 --> 00:24:26,480
using it

675
00:24:23,200 --> 00:24:29,360
maybe at least some people are

676
00:24:26,480 --> 00:24:30,559
well it's not that only you if you if

677
00:24:29,360 --> 00:24:34,080
you don't pick very

678
00:24:30,559 --> 00:24:35,678
obscure very old stuff you mostly find

679
00:24:34,080 --> 00:24:39,840
you find some other

680
00:24:35,679 --> 00:24:42,320
hater researcher or well red teamer or

681
00:24:39,840 --> 00:24:44,559
actor or skip kid or whatever using the

682
00:24:42,320 --> 00:24:47,200
same tool

683
00:24:44,559 --> 00:24:49,279
and it's you know as you see those files

684
00:24:47,200 --> 00:24:52,480
are lying there for some time

685
00:24:49,279 --> 00:24:55,679
more than two years and

686
00:24:52,480 --> 00:24:57,279
no one cares to take them down

687
00:24:55,679 --> 00:24:59,440
except heroku which when i started

688
00:24:57,279 --> 00:25:02,720
talking to them getting and they

689
00:24:59,440 --> 00:25:04,720
managed to get a done uh

690
00:25:02,720 --> 00:25:06,000
create some rules to basically put them

691
00:25:04,720 --> 00:25:09,440
out when they start

692
00:25:06,000 --> 00:25:11,760
creating accounts so maybe they moved

693
00:25:09,440 --> 00:25:13,279
we'll move to the different uh provider

694
00:25:11,760 --> 00:25:15,360
or we'll still try to get something on

695
00:25:13,279 --> 00:25:18,880
heroku and we'll manage to

696
00:25:15,360 --> 00:25:18,879
catch them again and again

697
00:25:20,159 --> 00:25:24,480
obviously there are some if there are

698
00:25:22,159 --> 00:25:28,000
some pros there has to be some cons

699
00:25:24,480 --> 00:25:32,400
and all of the most of those services

700
00:25:28,000 --> 00:25:35,600
leaves a lot of metadata and using

701
00:25:32,400 --> 00:25:36,799
bitly or whatever most of the payload

702
00:25:35,600 --> 00:25:41,918
shortening stuff

703
00:25:36,799 --> 00:25:43,760
it will collect some clicks maybe some

704
00:25:41,919 --> 00:25:46,320
geolocation based on

705
00:25:43,760 --> 00:25:47,279
data from who's who's using the service

706
00:25:46,320 --> 00:25:50,799
and it's

707
00:25:47,279 --> 00:25:54,480
available to most of the uh

708
00:25:50,799 --> 00:25:57,039
people there there are some some some

709
00:25:54,480 --> 00:25:57,520
services that will create a unique link

710
00:25:57,039 --> 00:25:59,760
to get

711
00:25:57,520 --> 00:26:01,520
uh statistics only for the for the

712
00:25:59,760 --> 00:26:04,799
owners but it's not very

713
00:26:01,520 --> 00:26:07,879
popular and in this this this

714
00:26:04,799 --> 00:26:12,240
this case they again they used this

715
00:26:07,880 --> 00:26:14,559
jlworkshop.com as a base of

716
00:26:12,240 --> 00:26:16,000
creating those short links so as you can

717
00:26:14,559 --> 00:26:19,279
see it creates a

718
00:26:16,000 --> 00:26:22,400
quite unique url pattern we can

719
00:26:19,279 --> 00:26:24,720
one can hunt for in

720
00:26:22,400 --> 00:26:25,760
you know in their logs so that was

721
00:26:24,720 --> 00:26:28,320
pretty easy to actually

722
00:26:25,760 --> 00:26:30,559
find them and combine the the collect

723
00:26:28,320 --> 00:26:33,279
all of the data

724
00:26:30,559 --> 00:26:35,120
about their attacks using those uh those

725
00:26:33,279 --> 00:26:36,720
links

726
00:26:35,120 --> 00:26:38,559
and that's for bitly if you go for a

727
00:26:36,720 --> 00:26:39,679
google for example for those documents

728
00:26:38,559 --> 00:26:42,320
they also again

729
00:26:39,679 --> 00:26:44,240
contain a lot of metadata including uh

730
00:26:42,320 --> 00:26:45,678
oh the one more thing is important that

731
00:26:44,240 --> 00:26:46,799
there is a timeline for that attack

732
00:26:45,679 --> 00:26:50,720
right you see when the

733
00:26:46,799 --> 00:26:52,559
the when the most

734
00:26:50,720 --> 00:26:54,080
clicks happen and that's probably the

735
00:26:52,559 --> 00:26:56,480
timeline when they started the

736
00:26:54,080 --> 00:26:57,199
the the attack there is probably some

737
00:26:56,480 --> 00:27:00,480
researcher

738
00:26:57,200 --> 00:27:01,279
automating system and what's not and

739
00:27:00,480 --> 00:27:03,279
again the same

740
00:27:01,279 --> 00:27:04,720
situation for google you have a name for

741
00:27:03,279 --> 00:27:07,919
the guy who's or

742
00:27:04,720 --> 00:27:10,320
girl this time this case or

743
00:27:07,919 --> 00:27:11,520
you know the fake account that uploaded

744
00:27:10,320 --> 00:27:14,559
and

745
00:27:11,520 --> 00:27:16,879
uh if your optic is bad

746
00:27:14,559 --> 00:27:18,399
you it's possible to basically correlate

747
00:27:16,880 --> 00:27:19,120
all of those because you will using the

748
00:27:18,399 --> 00:27:22,479
same

749
00:27:19,120 --> 00:27:23,279
the same google account it wasn't the

750
00:27:22,480 --> 00:27:26,559
case here

751
00:27:23,279 --> 00:27:27,679
but well it was to some extent so some

752
00:27:26,559 --> 00:27:30,559
of the documents

753
00:27:27,679 --> 00:27:31,440
were shared by different different

754
00:27:30,559 --> 00:27:33,520
emails but

755
00:27:31,440 --> 00:27:35,440
mostly there was some correlation

756
00:27:33,520 --> 00:27:39,440
between them as well

757
00:27:35,440 --> 00:27:42,080
and you know again and there is uh

758
00:27:39,440 --> 00:27:43,200
those huge amount of data you get from

759
00:27:42,080 --> 00:27:46,480
querying the api

760
00:27:43,200 --> 00:27:50,080
you get also that the times of uh

761
00:27:46,480 --> 00:27:53,600
uploading modification and what's not

762
00:27:50,080 --> 00:27:54,960
um especially nice for their

763
00:27:53,600 --> 00:27:56,879
comments because they're hosting as well

764
00:27:54,960 --> 00:27:59,120
on there on the google drive and if

765
00:27:56,880 --> 00:28:02,559
if you get a id you can see that they're

766
00:27:59,120 --> 00:28:06,239
modifying the every day to to change

767
00:28:02,559 --> 00:28:09,360
this one part of if you see look closely

768
00:28:06,240 --> 00:28:13,120
uh there is a date somewhere in the

769
00:28:09,360 --> 00:28:16,479
uh in a disk name

770
00:28:13,120 --> 00:28:18,320
oh yeah in uh

771
00:28:16,480 --> 00:28:19,760
uh in the folder name so they're

772
00:28:18,320 --> 00:28:22,158
modifying the uh

773
00:28:19,760 --> 00:28:24,000
disks the the documents every other day

774
00:28:22,159 --> 00:28:26,559
to to to change that so

775
00:28:24,000 --> 00:28:28,480
i know they are still operating uh

776
00:28:26,559 --> 00:28:30,158
basically on tracking those the changes

777
00:28:28,480 --> 00:28:33,520
in those documents

778
00:28:30,159 --> 00:28:36,240
um another other fun thing is

779
00:28:33,520 --> 00:28:37,760
and it's you know kind of brazing on a

780
00:28:36,240 --> 00:28:41,360
it's

781
00:28:37,760 --> 00:28:43,520
kinda on on the edge of things

782
00:28:41,360 --> 00:28:47,120
uh the good good good behavior it's that

783
00:28:43,520 --> 00:28:49,279
they leak api case right to those

784
00:28:47,120 --> 00:28:50,158
they need api keys to manage those

785
00:28:49,279 --> 00:28:52,880
resources

786
00:28:50,159 --> 00:28:54,000
and if they lick them uh through the

787
00:28:52,880 --> 00:28:56,960
binary basically or

788
00:28:54,000 --> 00:28:58,159
through the scripts this not only them

789
00:28:56,960 --> 00:29:00,480
who who

790
00:28:58,159 --> 00:29:01,840
who has those keys uh the victims and

791
00:29:00,480 --> 00:29:02,399
the researchers obviously have them and

792
00:29:01,840 --> 00:29:05,439
they can

793
00:29:02,399 --> 00:29:10,239
do stuff about it uh if they didn't

794
00:29:05,440 --> 00:29:14,399
properly configure the api access

795
00:29:10,240 --> 00:29:14,399
well things can get ready

796
00:29:14,880 --> 00:29:20,880
and as i said in case of heroku they

797
00:29:18,000 --> 00:29:21,919
did quite a good job with creating rules

798
00:29:20,880 --> 00:29:25,120
and detections for

799
00:29:21,919 --> 00:29:25,600
their activities so it's it's obvious

800
00:29:25,120 --> 00:29:27,439
that

801
00:29:25,600 --> 00:29:28,879
cloud providers cloud operators has a

802
00:29:27,440 --> 00:29:31,520
different visibility

803
00:29:28,880 --> 00:29:32,640
into your stuff if you rent a just a

804
00:29:31,520 --> 00:29:34,559
dedicated server

805
00:29:32,640 --> 00:29:36,159
it's more or less done right the only

806
00:29:34,559 --> 00:29:37,039
thing that admin can do can maybe

807
00:29:36,159 --> 00:29:40,399
restart it

808
00:29:37,039 --> 00:29:40,799
and put it in a rescue mode and then get

809
00:29:40,399 --> 00:29:43,520
some

810
00:29:40,799 --> 00:29:44,799
 but then you will see it with a

811
00:29:43,520 --> 00:29:48,320
cloud operator it's not

812
00:29:44,799 --> 00:29:51,520
that obvious

813
00:29:48,320 --> 00:29:53,520
a summary to finishing to

814
00:29:51,520 --> 00:29:55,760
to to get you some more information

815
00:29:53,520 --> 00:29:57,679
about fishing elephant

816
00:29:55,760 --> 00:29:59,200
it's a new actor more or less as i said

817
00:29:57,679 --> 00:30:02,399
i found them i

818
00:29:59,200 --> 00:30:08,720
traced their their steps back to 2000 so

819
00:30:02,399 --> 00:30:11,760
something is happening

820
00:30:08,720 --> 00:30:14,720
uh okay so i found them in that the

821
00:30:11,760 --> 00:30:15,919
choice that i found them in last year

822
00:30:14,720 --> 00:30:19,679
ish or something

823
00:30:15,919 --> 00:30:24,399
uh tries their their steps back to 2017.

824
00:30:19,679 --> 00:30:27,200
uh this is not a sophisticated actor um

825
00:30:24,399 --> 00:30:28,080
they use they don't have any in-house

826
00:30:27,200 --> 00:30:30,000
development

827
00:30:28,080 --> 00:30:31,279
at least i don't think so and i never as

828
00:30:30,000 --> 00:30:32,880
i said i didn't find they didn't found a

829
00:30:31,279 --> 00:30:34,000
keylogger but i'm suspecting it's not

830
00:30:32,880 --> 00:30:37,919
the in-house based

831
00:30:34,000 --> 00:30:38,480
developed anyway i like however how they

832
00:30:37,919 --> 00:30:39,840
use

833
00:30:38,480 --> 00:30:43,120
different methods to glue their attacks

834
00:30:39,840 --> 00:30:46,480
together so they show some

835
00:30:43,120 --> 00:30:46,479
some ingenuity in that i think

836
00:30:47,120 --> 00:30:53,918
they main thing is heavy reliance

837
00:30:50,159 --> 00:30:57,279
on pass and cloud storage services

838
00:30:53,919 --> 00:31:00,720
uh i didn't saw any group that's

839
00:30:57,279 --> 00:31:02,399
doing the same that is doing it that

840
00:31:00,720 --> 00:31:04,640
heavily

841
00:31:02,399 --> 00:31:07,039
they target mostly southeast part of

842
00:31:04,640 --> 00:31:07,039
asia

843
00:31:08,799 --> 00:31:12,000
we don't i don't really know where

844
00:31:10,320 --> 00:31:15,039
they're from i have some ideas

845
00:31:12,000 --> 00:31:17,519
but unfortunately i cannot

846
00:31:15,039 --> 00:31:19,440
tell that maybe you know drop me an

847
00:31:17,519 --> 00:31:22,559
email if you're interested i can

848
00:31:19,440 --> 00:31:25,120
share some attribution stuff as well

849
00:31:22,559 --> 00:31:26,480
and as i said i'm probably relying on a

850
00:31:25,120 --> 00:31:28,479
phishing

851
00:31:26,480 --> 00:31:31,360
to get some access to email servers i

852
00:31:28,480 --> 00:31:34,399
saw some domains being set up

853
00:31:31,360 --> 00:31:34,399
and some

854
00:31:34,799 --> 00:31:38,320
some information that supports this

855
00:31:36,880 --> 00:31:41,279
disease but it's there's not

856
00:31:38,320 --> 00:31:42,080
direct connection yet and they are very

857
00:31:41,279 --> 00:31:45,679
hard to catch

858
00:31:42,080 --> 00:31:46,720
and i found only like two or three

859
00:31:45,679 --> 00:31:48,640
samples

860
00:31:46,720 --> 00:31:51,360
that are available publicly basically on

861
00:31:48,640 --> 00:31:51,360
virustotal

862
00:31:53,039 --> 00:31:58,399
and didn't manage to find them

863
00:31:56,320 --> 00:31:59,678
since january this year and i know the

864
00:31:58,399 --> 00:32:02,000
operating because i'm seeing

865
00:31:59,679 --> 00:32:03,679
how they changing the comments and

866
00:32:02,000 --> 00:32:07,039
getting new infections

867
00:32:03,679 --> 00:32:09,360
uh cloud relying attacks some very

868
00:32:07,039 --> 00:32:11,440
easy to set up hard to take down hard to

869
00:32:09,360 --> 00:32:13,199
detect because you know the urls are

870
00:32:11,440 --> 00:32:16,559
more or less legit

871
00:32:13,200 --> 00:32:18,080
and hard to attribute if the service for

872
00:32:16,559 --> 00:32:20,559
like dropbox for example doesn't show

873
00:32:18,080 --> 00:32:22,879
any metadata

874
00:32:20,559 --> 00:32:24,480
but for google and other stuff there are

875
00:32:22,880 --> 00:32:27,440
a lot of metadata we can use

876
00:32:24,480 --> 00:32:28,320
so it's kinda depending on what tool you

877
00:32:27,440 --> 00:32:29,919
do you use

878
00:32:28,320 --> 00:32:32,639
sometimes you have metadata sometimes

879
00:32:29,919 --> 00:32:33,279
you don't and access to accounts most of

880
00:32:32,640 --> 00:32:34,880
the time

881
00:32:33,279 --> 00:32:37,679
is shared with victims and researchers

882
00:32:34,880 --> 00:32:43,840
which can lead to funny stuff

883
00:32:37,679 --> 00:32:43,840
and that's all from me

884
00:32:44,799 --> 00:32:46,879
you

