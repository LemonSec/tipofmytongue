1
00:00:00,320 --> 00:00:02,480
uh again i'm perf the founder of

2
00:00:02,480 --> 00:00:04,720
passwordscon uh really nice to have so

3
00:00:04,720 --> 00:00:06,640
many people in the room i'm back here

4
00:00:06,640 --> 00:00:08,240
um

5
00:00:08,240 --> 00:00:09,840
whenever i do passwords con and i've

6
00:00:09,840 --> 00:00:12,400
been doing this since 2010

7
00:00:12,400 --> 00:00:16,160
in europe and in here in the states um i

8
00:00:16,160 --> 00:00:19,039
always look for new talks new speakers

9
00:00:19,039 --> 00:00:20,640
new content

10
00:00:20,640 --> 00:00:22,320
but i also

11
00:00:22,320 --> 00:00:25,439
i am also very interested in having

12
00:00:25,439 --> 00:00:28,480
new perspectives on old stuff and also

13
00:00:28,480 --> 00:00:31,279
repeating old stuff i don't care if your

14
00:00:31,279 --> 00:00:33,120
presentation has been done many times

15
00:00:33,120 --> 00:00:35,520
before because with this audience there

16
00:00:35,520 --> 00:00:37,360
is always something new to learn both

17
00:00:37,360 --> 00:00:40,000
for speakers and for the audience

18
00:00:40,000 --> 00:00:42,480
so if you uh if you have

19
00:00:42,480 --> 00:00:44,000
something that you think could be a

20
00:00:44,000 --> 00:00:46,320
great idea for a talk uh feel free to

21
00:00:46,320 --> 00:00:48,559
reach out to me i really love helping

22
00:00:48,559 --> 00:00:50,800
people trying to come up with good talks

23
00:00:50,800 --> 00:00:52,079
good content

24
00:00:52,079 --> 00:00:54,719
and most probably you are working or

25
00:00:54,719 --> 00:00:57,039
you're studying something that i take a

26
00:00:57,039 --> 00:00:58,559
keen interest in and i would like to

27
00:00:58,559 --> 00:01:01,359
love to hear more about it so please

28
00:01:01,359 --> 00:01:02,800
reach out

29
00:01:02,800 --> 00:01:05,040
and also when it comes to passwords

30
00:01:05,040 --> 00:01:07,680
uh one of the most common uh feedback i

31
00:01:07,680 --> 00:01:10,320
get from people whenever they attend

32
00:01:10,320 --> 00:01:13,760
is that they never had an any idea

33
00:01:13,760 --> 00:01:16,159
that the topic of passwords which sounds

34
00:01:16,159 --> 00:01:18,000
so incredibly narrow

35
00:01:18,000 --> 00:01:20,960
can actually be so incredibly wide

36
00:01:20,960 --> 00:01:23,600
i've had psychologists at passwords.com

37
00:01:23,600 --> 00:01:25,680
talking about how your brain works in

38
00:01:25,680 --> 00:01:27,200
terms of short-term mid-term and

39
00:01:27,200 --> 00:01:28,960
long-term memory

40
00:01:28,960 --> 00:01:31,439
i've had linguists talk about well how

41
00:01:31,439 --> 00:01:33,200
languages are constructed and how they

42
00:01:33,200 --> 00:01:34,560
work

43
00:01:34,560 --> 00:01:36,159
i've had

44
00:01:36,159 --> 00:01:38,799
yuan darman the inventor of aes

45
00:01:38,799 --> 00:01:41,280
encryption and the sha-3 algorithm

46
00:01:41,280 --> 00:01:43,680
explain how that stuff works and i still

47
00:01:43,680 --> 00:01:48,159
have absolutely no clue how that works

48
00:01:48,159 --> 00:01:50,560
i've had the author of hashcat

49
00:01:50,560 --> 00:01:51,759
introduce

50
00:01:51,759 --> 00:01:52,960
hashcat

51
00:01:52,960 --> 00:01:56,479
and how he optimized the sha-1 function

52
00:01:56,479 --> 00:01:58,240
and lots more content

53
00:01:58,240 --> 00:02:00,000
but now

54
00:02:00,000 --> 00:02:01,759
i will introduce

55
00:02:01,759 --> 00:02:03,119
base 16

56
00:02:03,119 --> 00:02:04,479
from twitter

57
00:02:04,479 --> 00:02:06,880
talk about secrets of the second factor

58
00:02:06,880 --> 00:02:09,119
and i

59
00:02:09,119 --> 00:02:10,000
you know

60
00:02:10,000 --> 00:02:11,760
no uh

61
00:02:11,760 --> 00:02:14,239
not a scary offer but this is one of

62
00:02:14,239 --> 00:02:16,800
those topics that to me is new and that

63
00:02:16,800 --> 00:02:18,959
i've been waiting for somebody to submit

64
00:02:18,959 --> 00:02:20,560
and i'm looking forward to this one so

65
00:02:20,560 --> 00:02:23,599
take it away all right

66
00:02:25,070 --> 00:02:28,239
[Applause]

67
00:02:28,239 --> 00:02:29,840
all right thank you this is secrets of

68
00:02:29,840 --> 00:02:31,519
the second factor i originally wrote

69
00:02:31,519 --> 00:02:34,080
this talk in november 2019 and i'm like

70
00:02:34,080 --> 00:02:35,599
hey i'm gonna go take it everywhere in

71
00:02:35,599 --> 00:02:37,440
2020. this is going to be a great year

72
00:02:37,440 --> 00:02:40,239
for me and then stuff

73
00:02:40,239 --> 00:02:41,840
i did do it a couple of times virtually

74
00:02:41,840 --> 00:02:44,080
in 2020 it's kind of smaller conferences

75
00:02:44,080 --> 00:02:46,239
i did do it at the diana initiative i

76
00:02:46,239 --> 00:02:48,640
have updated the content since then

77
00:02:48,640 --> 00:02:50,480
so you're not getting a totally totally

78
00:02:50,480 --> 00:02:52,640
recycled talk here but

79
00:02:52,640 --> 00:02:54,239
you might have seen it before i'm gonna

80
00:02:54,239 --> 00:02:55,920
level set and give you some expectations

81
00:02:55,920 --> 00:02:57,519
sometimes when you read an abstract you

82
00:02:57,519 --> 00:02:58,879
don't quite get the full idea of what

83
00:02:58,879 --> 00:03:01,599
you're about to get into so first off

84
00:03:01,599 --> 00:03:03,440
this is not about installing it this is

85
00:03:03,440 --> 00:03:04,879
not saying like hey you should really

86
00:03:04,879 --> 00:03:06,720
have a two-factor system i'm kind of

87
00:03:06,720 --> 00:03:08,000
already assuming that you've done it

88
00:03:08,000 --> 00:03:09,840
already so it's not going to be about

89
00:03:09,840 --> 00:03:11,200
that there's plenty of other talks that

90
00:03:11,200 --> 00:03:12,400
will explain to you why you need a

91
00:03:12,400 --> 00:03:14,159
two-factor system

92
00:03:14,159 --> 00:03:15,840
uh this is gonna be about organizational

93
00:03:15,840 --> 00:03:17,200
security it's not gonna be about your

94
00:03:17,200 --> 00:03:19,280
personal security it's going to be like

95
00:03:19,280 --> 00:03:21,120
are you defending an organization or a

96
00:03:21,120 --> 00:03:22,879
large company

97
00:03:22,879 --> 00:03:24,080
and then the last piece of those two

98
00:03:24,080 --> 00:03:25,680
things aren't super interesting to you

99
00:03:25,680 --> 00:03:27,200
it will be about threat modeling and

100
00:03:27,200 --> 00:03:28,879
threat hunting so there might be some

101
00:03:28,879 --> 00:03:30,319
tidbits and some techniques that you can

102
00:03:30,319 --> 00:03:34,080
pick up there uh who am i um kind of

103
00:03:34,080 --> 00:03:36,480
already mentioned i go by base 16 on on

104
00:03:36,480 --> 00:03:38,400
twitter and

105
00:03:38,400 --> 00:03:40,480
my day job is a threat hunter and

106
00:03:40,480 --> 00:03:42,560
incident response investigator so that's

107
00:03:42,560 --> 00:03:44,000
where a lot of these

108
00:03:44,000 --> 00:03:45,920
stories come from uh some of my other

109
00:03:45,920 --> 00:03:47,680
stories come from my nights and weekends

110
00:03:47,680 --> 00:03:49,840
as a hack coordinator i work on b-sides

111
00:03:49,840 --> 00:03:52,720
rdu i work on kakalakicon and i work on

112
00:03:52,720 --> 00:03:54,560
defcon 9-1-9 all of that is out in the

113
00:03:54,560 --> 00:03:56,239
north carolina area

114
00:03:56,239 --> 00:03:58,400
really big in the community there

115
00:03:58,400 --> 00:03:59,439
and then

116
00:03:59,439 --> 00:04:01,120
i say that i'm the expert only in one

117
00:04:01,120 --> 00:04:03,280
room so i'm the expert at my company and

118
00:04:03,280 --> 00:04:04,720
i always try to go out into a bigger

119
00:04:04,720 --> 00:04:06,640
room so i can meet other experts and

120
00:04:06,640 --> 00:04:08,000
teach other people so that we have more

121
00:04:08,000 --> 00:04:10,239
than one expert in the room

122
00:04:10,239 --> 00:04:12,159
and then i am a certified do it

123
00:04:12,159 --> 00:04:13,519
administrator and then i just want to

124
00:04:13,519 --> 00:04:15,200
call out that there's no commission i do

125
00:04:15,200 --> 00:04:17,279
kind of heavily rely on duo in this talk

126
00:04:17,279 --> 00:04:19,759
is the mfa system i have dabbled a

127
00:04:19,759 --> 00:04:21,519
little bit into octa and microsoft and

128
00:04:21,519 --> 00:04:22,720
some of the other ones but not as

129
00:04:22,720 --> 00:04:25,120
heavily as duo so a lot of my examples

130
00:04:25,120 --> 00:04:25,840
are

131
00:04:25,840 --> 00:04:27,919
um with that system and i just use it

132
00:04:27,919 --> 00:04:29,120
because it's convenient because that's

133
00:04:29,120 --> 00:04:31,600
what i'm able to use on a

134
00:04:31,600 --> 00:04:33,840
day-to-day basis

135
00:04:33,840 --> 00:04:34,880
so a little bit more about what this

136
00:04:34,880 --> 00:04:36,720
talk is about i'm going to very quickly

137
00:04:36,720 --> 00:04:39,759
go over mfa 101 like what is it if you

138
00:04:39,759 --> 00:04:42,240
don't know the details of it i'm going

139
00:04:42,240 --> 00:04:43,919
to go over what they tell you like when

140
00:04:43,919 --> 00:04:45,840
you first get an mfa system or what most

141
00:04:45,840 --> 00:04:48,160
of the mfa talks are about or like what

142
00:04:48,160 --> 00:04:49,759
sales people will tell you i'm going to

143
00:04:49,759 --> 00:04:51,840
get into what they don't tell you and

144
00:04:51,840 --> 00:04:53,440
then we're going to go through hunting

145
00:04:53,440 --> 00:04:55,600
and that's the really great part

146
00:04:55,600 --> 00:04:56,800
and then i'll give you some conclusions

147
00:04:56,800 --> 00:04:58,320
and some actions that you can do if you

148
00:04:58,320 --> 00:05:00,320
are with a corporation and if you do

149
00:05:00,320 --> 00:05:02,960
have um an mfa system like what you can

150
00:05:02,960 --> 00:05:04,560
do on on monday or whenever it is you

151
00:05:04,560 --> 00:05:07,280
get back to work and what you can action

152
00:05:07,280 --> 00:05:09,600
so just really briefly mfa 101 for the

153
00:05:09,600 --> 00:05:11,360
purpose of this talk we're talking about

154
00:05:11,360 --> 00:05:13,360
it after the password is correct so

155
00:05:13,360 --> 00:05:14,479
you've entered your username and

156
00:05:14,479 --> 00:05:15,919
password and then you're presented with

157
00:05:15,919 --> 00:05:19,039
a second factor or the multi-factor

158
00:05:19,039 --> 00:05:20,560
there are some systems that will allow

159
00:05:20,560 --> 00:05:22,160
you to like enter a code in line with a

160
00:05:22,160 --> 00:05:24,240
password but that's not in the scope of

161
00:05:24,240 --> 00:05:25,199
this

162
00:05:25,199 --> 00:05:26,960
and then for the scope of this we're

163
00:05:26,960 --> 00:05:29,120
also dealing with phone call sms

164
00:05:29,120 --> 00:05:31,280
messages and phone apps we're not

165
00:05:31,280 --> 00:05:33,120
dealing with sending an email to a user

166
00:05:33,120 --> 00:05:35,199
and giving them a code that way i'm not

167
00:05:35,199 --> 00:05:37,600
going to be talking about digi keys or

168
00:05:37,600 --> 00:05:40,639
like ub keys or one time passwords very

169
00:05:40,639 --> 00:05:41,440
much

170
00:05:41,440 --> 00:05:43,520
they do come up but it's not the bulk of

171
00:05:43,520 --> 00:05:45,120
this talk

172
00:05:45,120 --> 00:05:46,639
and then i'm gonna give you a minute to

173
00:05:46,639 --> 00:05:48,240
look at this diagram while i take a

174
00:05:48,240 --> 00:05:51,240
drink

175
00:05:52,479 --> 00:05:54,160
kind of the basic flow

176
00:05:54,160 --> 00:05:55,759
the first factor and then doing content

177
00:05:55,759 --> 00:05:56,800
checks and

178
00:05:56,800 --> 00:05:59,360
things like that

179
00:05:59,360 --> 00:06:00,080
so

180
00:06:00,080 --> 00:06:01,919
diving into what they tell you

181
00:06:01,919 --> 00:06:02,639
they

182
00:06:02,639 --> 00:06:04,400
for the mfa threat model

183
00:06:04,400 --> 00:06:05,600
uh most of what they tell you is that

184
00:06:05,600 --> 00:06:07,199
it's gonna be for prevention and

185
00:06:07,199 --> 00:06:09,680
mitigation uh prevention

186
00:06:09,680 --> 00:06:12,400
uh getting into an account this is a

187
00:06:12,400 --> 00:06:15,199
nice chart from from google it's all

188
00:06:15,199 --> 00:06:16,720
pretty about all the different ways that

189
00:06:16,720 --> 00:06:18,319
like hey mfa will prevent an account

190
00:06:18,319 --> 00:06:20,639
from getting taken over

191
00:06:20,639 --> 00:06:22,160
based on the different factors and

192
00:06:22,160 --> 00:06:24,960
things that you can have

193
00:06:25,919 --> 00:06:26,960
and then they also talk about the

194
00:06:26,960 --> 00:06:28,800
problems that are mitigated things like

195
00:06:28,800 --> 00:06:30,560
if you have a password policy that isn't

196
00:06:30,560 --> 00:06:32,319
great or you have users that maybe do

197
00:06:32,319 --> 00:06:34,560
some malicious compliance i was at

198
00:06:34,560 --> 00:06:36,479
another conference one time and one of

199
00:06:36,479 --> 00:06:37,840
the speakers was talking about they had

200
00:06:37,840 --> 00:06:39,680
a policy where you couldn't use the

201
00:06:39,680 --> 00:06:41,840
previous 15 passwords

202
00:06:41,840 --> 00:06:43,360
every time they changed it so they

203
00:06:43,360 --> 00:06:45,840
changed it exactly 16 times to put it

204
00:06:45,840 --> 00:06:47,440
back to their original password

205
00:06:47,440 --> 00:06:50,400
malicious compliance so

206
00:06:50,400 --> 00:06:52,800
two factor might help with that

207
00:06:52,800 --> 00:06:54,479
um

208
00:06:54,479 --> 00:06:55,840
and then things like fishing and

209
00:06:55,840 --> 00:06:57,680
credential harvesters and i throw some

210
00:06:57,680 --> 00:07:01,039
caveats on there to a certain degree

211
00:07:01,039 --> 00:07:02,639
an mfa system will mitigate those

212
00:07:02,639 --> 00:07:04,479
problems

213
00:07:04,479 --> 00:07:05,759
now let's dive into some of the things

214
00:07:05,759 --> 00:07:07,120
that they don't tell you and some of the

215
00:07:07,120 --> 00:07:08,319
things that you might not have heard of

216
00:07:08,319 --> 00:07:09,759
before

217
00:07:09,759 --> 00:07:11,440
problems persist

218
00:07:11,440 --> 00:07:13,120
things like brute force brute force is

219
00:07:13,120 --> 00:07:15,280
still a thing in an mfa system you have

220
00:07:15,280 --> 00:07:16,639
the brute force against the password

221
00:07:16,639 --> 00:07:18,560
then after you have that continuously

222
00:07:18,560 --> 00:07:20,080
sending pushes or continuously

223
00:07:20,080 --> 00:07:22,560
attempting uh like the six digit code

224
00:07:22,560 --> 00:07:24,240
that would be sent over sms in order to

225
00:07:24,240 --> 00:07:27,199
try to brute force uh into an account

226
00:07:27,199 --> 00:07:28,400
you still have things like social

227
00:07:28,400 --> 00:07:31,039
engineering uh calling somebody up and

228
00:07:31,039 --> 00:07:33,039
then with whatever pretext you have

229
00:07:33,039 --> 00:07:36,000
requesting that code in order to bypass

230
00:07:36,000 --> 00:07:38,720
the mfa and get in that way

231
00:07:38,720 --> 00:07:39,840
and then you still have man in the

232
00:07:39,840 --> 00:07:41,199
middle and like credential harvesting

233
00:07:41,199 --> 00:07:43,759
still like spoofing websites or spoofing

234
00:07:43,759 --> 00:07:45,120
permissions

235
00:07:45,120 --> 00:07:46,160
and then some of the credential

236
00:07:46,160 --> 00:07:47,520
harvesters now are getting a lot better

237
00:07:47,520 --> 00:07:48,639
where they're actually requesting that

238
00:07:48,639 --> 00:07:50,560
second factor code as well and then

239
00:07:50,560 --> 00:07:52,560
turning around and using it

240
00:07:52,560 --> 00:07:53,919
and then one of the other problems that

241
00:07:53,919 --> 00:07:55,280
a lot of people don't think about is

242
00:07:55,280 --> 00:07:57,440
account recovery so you have a password

243
00:07:57,440 --> 00:08:00,160
reset flow what is now your mfa flow if

244
00:08:00,160 --> 00:08:02,400
your user loses their phone if they lose

245
00:08:02,400 --> 00:08:04,160
their phone number how do you get them

246
00:08:04,160 --> 00:08:06,560
back into account recovery um and

247
00:08:06,560 --> 00:08:09,199
setting that up

248
00:08:09,199 --> 00:08:10,879
another thing is with more factors you

249
00:08:10,879 --> 00:08:12,720
also get more problems

250
00:08:12,720 --> 00:08:14,639
there's a lot of like false sense of

251
00:08:14,639 --> 00:08:16,720
security where hey we have an mfa system

252
00:08:16,720 --> 00:08:18,319
we should be fine that lovely chart by

253
00:08:18,319 --> 00:08:19,840
google that i showed earlier said that

254
00:08:19,840 --> 00:08:21,759
we're cool so

255
00:08:21,759 --> 00:08:24,319
you kind of get lulled into

256
00:08:24,319 --> 00:08:26,800
maybe more sense of security than you

257
00:08:26,800 --> 00:08:27,759
should have

258
00:08:27,759 --> 00:08:30,879
uh it can also be used if a attacker

259
00:08:30,879 --> 00:08:33,120
gets a password dump and they get a

260
00:08:33,120 --> 00:08:34,479
whole bunch of passwords it can be used

261
00:08:34,479 --> 00:08:37,039
for password validation so they enter in

262
00:08:37,039 --> 00:08:38,399
the password they get the prompt for the

263
00:08:38,399 --> 00:08:40,559
multi-factor now they see that hey that

264
00:08:40,559 --> 00:08:42,159
password was correct and if that

265
00:08:42,159 --> 00:08:43,679
password was correct is the rest of the

266
00:08:43,679 --> 00:08:44,959
dump correct

267
00:08:44,959 --> 00:08:47,519
and then they see that

268
00:08:47,519 --> 00:08:50,160
that screen for the mfa system they can

269
00:08:50,160 --> 00:08:52,720
now go do more recon on that mfa system

270
00:08:52,720 --> 00:08:54,320
and try to find bypasses around it build

271
00:08:54,320 --> 00:08:57,440
their pretexts better

272
00:08:58,080 --> 00:08:59,519
another thing is application

273
00:08:59,519 --> 00:09:00,959
implementation

274
00:09:00,959 --> 00:09:02,240
passwords have been around a lot longer

275
00:09:02,240 --> 00:09:04,880
than mfa so hopefully your application

276
00:09:04,880 --> 00:09:06,000
people know how to tie into those

277
00:09:06,000 --> 00:09:07,519
systems and have

278
00:09:07,519 --> 00:09:09,279
the code and everything to do and set

279
00:09:09,279 --> 00:09:11,120
that up correctly some of the mfa

280
00:09:11,120 --> 00:09:13,040
systems are a little bit newer

281
00:09:13,040 --> 00:09:14,640
and if you don't have very specific code

282
00:09:14,640 --> 00:09:16,080
to give to your application developers

283
00:09:16,080 --> 00:09:18,320
in order to hook into everything

284
00:09:18,320 --> 00:09:20,000
the way that they should be

285
00:09:20,000 --> 00:09:21,440
there's always misconfigurations and

286
00:09:21,440 --> 00:09:24,880
applications that can uh kind of bypass

287
00:09:24,880 --> 00:09:28,160
or have workarounds in the mfa system so

288
00:09:28,160 --> 00:09:30,720
that they can bypass it that way

289
00:09:30,720 --> 00:09:33,839
and then i bring up the the human factor

290
00:09:33,839 --> 00:09:35,200
and

291
00:09:35,200 --> 00:09:38,080
you know humans are bad at passwords um

292
00:09:38,080 --> 00:09:40,080
entire conference track dedicated to

293
00:09:40,080 --> 00:09:43,360
that but also it's amazing um what i've

294
00:09:43,360 --> 00:09:45,040
seen in my research how humans are not

295
00:09:45,040 --> 00:09:47,120
good with multi-factor the

296
00:09:47,120 --> 00:09:48,880
oh my gosh i have to get this code and

297
00:09:48,880 --> 00:09:51,680
punch it in that's so much extra work

298
00:09:51,680 --> 00:09:54,000
that that psychological acceptability

299
00:09:54,000 --> 00:09:55,760
where they will do things maybe not

300
00:09:55,760 --> 00:09:57,760
maliciously but just like get their job

301
00:09:57,760 --> 00:09:58,880
done

302
00:09:58,880 --> 00:10:01,279
and find bypasses and ways around

303
00:10:01,279 --> 00:10:04,279
multi-factor

304
00:10:04,560 --> 00:10:05,440
i'm going to get into some of the

305
00:10:05,440 --> 00:10:07,519
configuration threats uh when i first

306
00:10:07,519 --> 00:10:10,240
started looking into mfa systems and mfa

307
00:10:10,240 --> 00:10:12,079
logs i'm a blue teamer

308
00:10:12,079 --> 00:10:13,839
i asked some red teamers like hey what

309
00:10:13,839 --> 00:10:15,120
what do you do if you're on an

310
00:10:15,120 --> 00:10:17,760
engagement and you find an mfa system is

311
00:10:17,760 --> 00:10:19,360
set up and they were telling me that

312
00:10:19,360 --> 00:10:20,880
they love the engagements where they're

313
00:10:20,880 --> 00:10:23,120
just very first rolling out a brand new

314
00:10:23,120 --> 00:10:25,600
mfa system and they have enrollment

315
00:10:25,600 --> 00:10:28,320
after the password is correct so you've

316
00:10:28,320 --> 00:10:29,839
never used mfa before you enter your

317
00:10:29,839 --> 00:10:31,440
username password and it prompts you hey

318
00:10:31,440 --> 00:10:33,760
give me your phone so i can set up mfa

319
00:10:33,760 --> 00:10:36,079
for you if the red teamer has gone out

320
00:10:36,079 --> 00:10:37,440
and gotten the password already they

321
00:10:37,440 --> 00:10:39,040
then add their red team phone to that

322
00:10:39,040 --> 00:10:41,200
account find the person on vacation who

323
00:10:41,200 --> 00:10:42,720
hasn't set it up yet or is a little bit

324
00:10:42,720 --> 00:10:44,640
behind they now have their red team

325
00:10:44,640 --> 00:10:46,480
phone on that account and just go all

326
00:10:46,480 --> 00:10:48,959
the way through the mfa system

327
00:10:48,959 --> 00:10:51,040
the other thing with that is

328
00:10:51,040 --> 00:10:52,399
open self

329
00:10:52,399 --> 00:10:55,279
service device enrollment this is just

330
00:10:55,279 --> 00:10:57,279
allowing your users to add any device to

331
00:10:57,279 --> 00:11:00,560
their account like they can free add a

332
00:11:00,560 --> 00:11:02,880
one-time password device or they can add

333
00:11:02,880 --> 00:11:04,800
another phone or add another phone

334
00:11:04,800 --> 00:11:06,480
number to their account

335
00:11:06,480 --> 00:11:07,680
instead of going through something like

336
00:11:07,680 --> 00:11:10,160
it that can prove you can also kind of

337
00:11:10,160 --> 00:11:11,839
see how that would create problems if

338
00:11:11,839 --> 00:11:14,320
you're able to get a push the first time

339
00:11:14,320 --> 00:11:16,240
as a red teamer or an attacker and then

340
00:11:16,240 --> 00:11:17,760
being able to add your attack phone or

341
00:11:17,760 --> 00:11:19,279
your red team phone after the fact

342
00:11:19,279 --> 00:11:21,440
without having to go through any sort of

343
00:11:21,440 --> 00:11:24,320
checks or balances with it

344
00:11:24,320 --> 00:11:25,519
so one of the other things that they

345
00:11:25,519 --> 00:11:27,519
don't tell you about an mfa system is

346
00:11:27,519 --> 00:11:29,839
basic baselining things so we've talked

347
00:11:29,839 --> 00:11:31,360
about how you probably have a very

348
00:11:31,360 --> 00:11:33,120
explicit password policy that says you

349
00:11:33,120 --> 00:11:34,880
have to rotate it you know every so many

350
00:11:34,880 --> 00:11:36,800
days you have to have so many special

351
00:11:36,800 --> 00:11:38,959
characters numbers length and all that

352
00:11:38,959 --> 00:11:41,040
do you have an explicit established proc

353
00:11:41,040 --> 00:11:43,760
uh policy about your mfa system

354
00:11:43,760 --> 00:11:45,279
how are you limiting how many phones

355
00:11:45,279 --> 00:11:46,640
they can add what type of phones they

356
00:11:46,640 --> 00:11:48,880
can add are you doing byod

357
00:11:48,880 --> 00:11:51,200
uh can it only be corporate phones who's

358
00:11:51,200 --> 00:11:52,320
issuing that

359
00:11:52,320 --> 00:11:54,480
and things of that nature

360
00:11:54,480 --> 00:11:56,240
um another thing you want to think about

361
00:11:56,240 --> 00:11:58,399
is like implicit best practices

362
00:11:58,399 --> 00:12:00,639
uh best practices for a password best

363
00:12:00,639 --> 00:12:03,120
practices for an mfa system

364
00:12:03,120 --> 00:12:03,920
um

365
00:12:03,920 --> 00:12:04,959
the other thing that you kind of want to

366
00:12:04,959 --> 00:12:07,360
baseline with is your application teams

367
00:12:07,360 --> 00:12:08,800
that are going to be helping you set

368
00:12:08,800 --> 00:12:10,800
this up and then your i.t team any sort

369
00:12:10,800 --> 00:12:12,800
of tech support that is going to have to

370
00:12:12,800 --> 00:12:15,600
go along with a rollout or

371
00:12:15,600 --> 00:12:17,680
day-to-day operations of helping users

372
00:12:17,680 --> 00:12:19,279
that that are running

373
00:12:19,279 --> 00:12:21,760
and using the mfa system

374
00:12:21,760 --> 00:12:22,639
and then the other thing that you want

375
00:12:22,639 --> 00:12:25,040
to baseline is going out and doing test

376
00:12:25,040 --> 00:12:27,120
scenarios in a lab just running through

377
00:12:27,120 --> 00:12:29,360
the mfa system yourself through any sort

378
00:12:29,360 --> 00:12:31,600
of weird scenarios that you can think of

379
00:12:31,600 --> 00:12:33,519
and then taking a look at those logs and

380
00:12:33,519 --> 00:12:36,639
establishing those baselines

381
00:12:36,639 --> 00:12:41,320
take a minute to drink here real quick

382
00:12:52,000 --> 00:12:54,240
okay so is that is that better

383
00:12:54,240 --> 00:12:55,360
okay

384
00:12:55,360 --> 00:12:58,000
sorry i wasn't close enough there um

385
00:12:58,000 --> 00:12:59,200
so one of the biggest things that they

386
00:12:59,200 --> 00:13:01,600
don't tell you is that there are logs

387
00:13:01,600 --> 00:13:03,519
these systems log quite a bit of

388
00:13:03,519 --> 00:13:04,639
information

389
00:13:04,639 --> 00:13:05,760
um and then the other thing that they

390
00:13:05,760 --> 00:13:07,040
don't tell you is that you want to bring

391
00:13:07,040 --> 00:13:08,560
along more data when you go look at

392
00:13:08,560 --> 00:13:10,240
these logs and

393
00:13:10,240 --> 00:13:12,079
i love vlogs i love getting into it and

394
00:13:12,079 --> 00:13:13,120
why do i

395
00:13:13,120 --> 00:13:15,440
the logs tell me things i am like the

396
00:13:15,440 --> 00:13:18,240
log lady give me all of the logs upgrade

397
00:13:18,240 --> 00:13:20,160
the logs just bring them all to me

398
00:13:20,160 --> 00:13:22,160
because the logs tell me so much

399
00:13:22,160 --> 00:13:23,680
um they've told me lots of things and

400
00:13:23,680 --> 00:13:25,200
now i'm going to tell you what they told

401
00:13:25,200 --> 00:13:27,040
me so that now you can go throughout

402
00:13:27,040 --> 00:13:28,959
hunt and take a look in your logs so i'm

403
00:13:28,959 --> 00:13:31,680
going to break all of this down

404
00:13:31,680 --> 00:13:32,720
the first thing that we're going to take

405
00:13:32,720 --> 00:13:35,200
a look at is the access device this

406
00:13:35,200 --> 00:13:36,720
gives us some interesting information

407
00:13:36,720 --> 00:13:38,560
like the client os and the browser that

408
00:13:38,560 --> 00:13:40,959
your users are using to log into

409
00:13:40,959 --> 00:13:43,120
your system on some of these systems

410
00:13:43,120 --> 00:13:45,199
they will also have an endpoint client

411
00:13:45,199 --> 00:13:46,639
so you can get some additional endpoint

412
00:13:46,639 --> 00:13:49,040
details so here we can see that you know

413
00:13:49,040 --> 00:13:50,720
they have firewall enabled hey they

414
00:13:50,720 --> 00:13:52,560
don't have java that's great or flash

415
00:13:52,560 --> 00:13:54,160
that's also great that they don't have

416
00:13:54,160 --> 00:13:55,279
that installed and they're running

417
00:13:55,279 --> 00:13:57,839
windows defender and things like that

418
00:13:57,839 --> 00:13:59,199
uh some of the stuff that you want to

419
00:13:59,199 --> 00:14:00,959
bring along to these logs are things

420
00:14:00,959 --> 00:14:02,800
like your asset inventory because you

421
00:14:02,800 --> 00:14:05,040
have an asset inventory

422
00:14:05,040 --> 00:14:07,360
everybody has an asset inventory

423
00:14:07,360 --> 00:14:09,519
um those are hard

424
00:14:09,519 --> 00:14:10,720
um

425
00:14:10,720 --> 00:14:12,240
you you want to bring a list of your

426
00:14:12,240 --> 00:14:14,639
approved software you know do you allow

427
00:14:14,639 --> 00:14:16,560
users to run firefox do you allow them

428
00:14:16,560 --> 00:14:18,560
to run like brave or other different uh

429
00:14:18,560 --> 00:14:20,160
browsers like that

430
00:14:20,160 --> 00:14:22,000
uh and then one of the other things like

431
00:14:22,000 --> 00:14:24,399
add caveats to this is remember that

432
00:14:24,399 --> 00:14:26,079
there is agent string spoofing if

433
00:14:26,079 --> 00:14:27,600
they're logging into web apps they can

434
00:14:27,600 --> 00:14:29,120
be spoofing those agent strings

435
00:14:29,120 --> 00:14:30,720
depending on how the system gathers that

436
00:14:30,720 --> 00:14:32,240
data and then you also have

437
00:14:32,240 --> 00:14:34,720
browser-based apps so if you have a user

438
00:14:34,720 --> 00:14:36,160
and you're questioning their login they

439
00:14:36,160 --> 00:14:37,519
might not understand what it is they

440
00:14:37,519 --> 00:14:39,440
were even logging into

441
00:14:39,440 --> 00:14:41,440
depending on on how it displays in these

442
00:14:41,440 --> 00:14:42,560
logs

443
00:14:42,560 --> 00:14:43,519
so the thing that we're going to threat

444
00:14:43,519 --> 00:14:44,959
hunt in this

445
00:14:44,959 --> 00:14:46,639
is we're going to take a look at

446
00:14:46,639 --> 00:14:49,519
non-issued or approved operating systems

447
00:14:49,519 --> 00:14:51,199
so you're in an all windows shop and you

448
00:14:51,199 --> 00:14:52,720
start to see macintosh logins or you

449
00:14:52,720 --> 00:14:54,399
start to see linux logins you might want

450
00:14:54,399 --> 00:14:57,199
to take a closer look at those

451
00:14:57,199 --> 00:15:00,079
also taking a look at old or end of life

452
00:15:00,079 --> 00:15:02,720
uh os versions uh it was very surprising

453
00:15:02,720 --> 00:15:05,360
to me when i went hunting in my own

454
00:15:05,360 --> 00:15:07,120
environment seeing a lot of windows 7

455
00:15:07,120 --> 00:15:09,120
computers i thought we had gotten rid of

456
00:15:09,120 --> 00:15:10,800
all of those but they're still logging

457
00:15:10,800 --> 00:15:12,160
in and like where are they and what are

458
00:15:12,160 --> 00:15:13,199
they doing

459
00:15:13,199 --> 00:15:15,040
um and then you want to take a look for

460
00:15:15,040 --> 00:15:16,880
like restricted software here we see

461
00:15:16,880 --> 00:15:19,040
windows defender but maybe you are

462
00:15:19,040 --> 00:15:20,399
maybe you have a corporate license from

463
00:15:20,399 --> 00:15:22,639
mcafee or another vendor

464
00:15:22,639 --> 00:15:24,240
why are they running windows defender

465
00:15:24,240 --> 00:15:25,519
instead of what you

466
00:15:25,519 --> 00:15:27,600
rolled out to the whole fleet so take a

467
00:15:27,600 --> 00:15:29,360
look at those

468
00:15:29,360 --> 00:15:30,880
uh the next thing we're going to look at

469
00:15:30,880 --> 00:15:32,959
is the access device ip address like

470
00:15:32,959 --> 00:15:35,600
where where are they logging in from

471
00:15:35,600 --> 00:15:36,480
so

472
00:15:36,480 --> 00:15:38,720
uh ip address of the accessing device

473
00:15:38,720 --> 00:15:40,800
the location is based on ip address

474
00:15:40,800 --> 00:15:42,480
lookups

475
00:15:42,480 --> 00:15:43,680
and then some of the logs will actually

476
00:15:43,680 --> 00:15:46,320
give you a dns lookup or the asn

477
00:15:46,320 --> 00:15:48,320
so you kind of know what company uh like

478
00:15:48,320 --> 00:15:51,040
what isp they're using to log in

479
00:15:51,040 --> 00:15:52,320
some of the additional information you

480
00:15:52,320 --> 00:15:53,600
want to bring along with that is your

481
00:15:53,600 --> 00:15:55,920
known corporate subnets uh are you

482
00:15:55,920 --> 00:15:57,600
taking a look at users that are on site

483
00:15:57,600 --> 00:15:59,600
or have vpned into your system and then

484
00:15:59,600 --> 00:16:00,639
are

485
00:16:00,639 --> 00:16:02,000
going out to the web in order to get

486
00:16:02,000 --> 00:16:04,639
their mfa call um

487
00:16:04,639 --> 00:16:06,000
should they be going through that should

488
00:16:06,000 --> 00:16:08,079
it be split tunneling you know where are

489
00:16:08,079 --> 00:16:10,320
they allowed to come in through um you

490
00:16:10,320 --> 00:16:12,160
want a list of acceptable access

491
00:16:12,160 --> 00:16:14,079
locations depending on

492
00:16:14,079 --> 00:16:17,120
your industry or your uh

493
00:16:17,120 --> 00:16:18,639
or your company there might be certain

494
00:16:18,639 --> 00:16:20,160
locations where you don't want anybody

495
00:16:20,160 --> 00:16:22,880
logging in from and then you might also

496
00:16:22,880 --> 00:16:24,320
want to have an employee directory

497
00:16:24,320 --> 00:16:27,040
employee asset asset inventory again yes

498
00:16:27,040 --> 00:16:29,759
you have asset inventory um employee

499
00:16:29,759 --> 00:16:31,600
location data so you can kind of have an

500
00:16:31,600 --> 00:16:33,839
idea of where people should be

501
00:16:33,839 --> 00:16:35,680
and then a big caveat here is ip

502
00:16:35,680 --> 00:16:38,079
locations can be wrong um and it also

503
00:16:38,079 --> 00:16:40,240
varies by config and application like i

504
00:16:40,240 --> 00:16:42,399
was saying before vpn or coming through

505
00:16:42,399 --> 00:16:44,480
like your corporate network and bouncing

506
00:16:44,480 --> 00:16:45,839
out um

507
00:16:45,839 --> 00:16:47,920
the ip locations can be wrong i used to

508
00:16:47,920 --> 00:16:51,120
work for an isp i was doing a

509
00:16:51,120 --> 00:16:52,160
a

510
00:16:52,160 --> 00:16:53,759
packet capture on a firewall that i knew

511
00:16:53,759 --> 00:16:56,000
was in new york city for a customer

512
00:16:56,000 --> 00:16:57,839
they were complaining that one of the

513
00:16:57,839 --> 00:16:59,759
partners that they were trying to set up

514
00:16:59,759 --> 00:17:01,279
a vpn tunnel with was saying that their

515
00:17:01,279 --> 00:17:04,160
ips were located in puerto rico a packet

516
00:17:04,160 --> 00:17:05,679
captured on a new york city firewall i

517
00:17:05,679 --> 00:17:07,760
knew that it wasn't in puerto rico but

518
00:17:07,760 --> 00:17:08,959
the ip

519
00:17:08,959 --> 00:17:12,319
location service that their third party

520
00:17:12,319 --> 00:17:14,000
was was using

521
00:17:14,000 --> 00:17:15,679
had some stale data in it they had to go

522
00:17:15,679 --> 00:17:17,439
through and like use a different service

523
00:17:17,439 --> 00:17:19,599
in order to realize like hey the ip

524
00:17:19,599 --> 00:17:22,319
locations uh they can be wrong so you

525
00:17:22,319 --> 00:17:25,760
want to cross cross reference if you see

526
00:17:25,760 --> 00:17:27,839
scary location go just double check it

527
00:17:27,839 --> 00:17:30,640
before you start chasing it too hard

528
00:17:30,640 --> 00:17:32,640
so let's go hunting in this and what

529
00:17:32,640 --> 00:17:34,880
we're going to take a look at is tour

530
00:17:34,880 --> 00:17:38,720
ips or unapproved vpn ips

531
00:17:38,720 --> 00:17:40,320
it's amazing how many people will like

532
00:17:40,320 --> 00:17:41,919
go watch

533
00:17:41,919 --> 00:17:44,080
go use a personal vpn

534
00:17:44,080 --> 00:17:45,440
maybe watch some netflix for a different

535
00:17:45,440 --> 00:17:47,200
country or something and then try to log

536
00:17:47,200 --> 00:17:48,799
into your corporate network totally

537
00:17:48,799 --> 00:17:50,480
forgetting that they're in a

538
00:17:50,480 --> 00:17:52,799
country that you don't allow um kind of

539
00:17:52,799 --> 00:17:54,480
interesting when you see the tour nodes

540
00:17:54,480 --> 00:17:56,240
trying to connect into your corporate

541
00:17:56,240 --> 00:17:57,039
stuff

542
00:17:57,039 --> 00:17:58,960
um and then any sort of asn that you

543
00:17:58,960 --> 00:18:01,760
might have on a list

544
00:18:01,760 --> 00:18:03,039
and then here's also where you can use

545
00:18:03,039 --> 00:18:05,600
your threat until ioc ips and asns if

546
00:18:05,600 --> 00:18:07,120
you're getting any sort of threat until

547
00:18:07,120 --> 00:18:09,919
feeds um and if other people have seen

548
00:18:09,919 --> 00:18:11,760
malicious activity from ip addresses go

549
00:18:11,760 --> 00:18:13,280
hunt for those ips if they're trying to

550
00:18:13,280 --> 00:18:15,120
log into your

551
00:18:15,120 --> 00:18:16,720
system

552
00:18:16,720 --> 00:18:18,400
and then you can also hunt the ip

553
00:18:18,400 --> 00:18:20,320
locations with just that caveat that i

554
00:18:20,320 --> 00:18:22,000
mentioned before it has a little bit

555
00:18:22,000 --> 00:18:23,200
higher

556
00:18:23,200 --> 00:18:26,640
rate of false positives or benigns where

557
00:18:26,640 --> 00:18:28,000
just know that you have to do a lot of

558
00:18:28,000 --> 00:18:30,799
extra or a couple of extra cross checks

559
00:18:30,799 --> 00:18:34,639
there before you go chasing that too far

560
00:18:34,960 --> 00:18:37,039
uh the next part here is the application

561
00:18:37,039 --> 00:18:38,480
logs so we're taking a look at the

562
00:18:38,480 --> 00:18:40,840
application name and the application

563
00:18:40,840 --> 00:18:43,200
id uh the other thing you want to bring

564
00:18:43,200 --> 00:18:45,760
along is application inventory i'm very

565
00:18:45,760 --> 00:18:48,080
big on inventory inventory micro

566
00:18:48,080 --> 00:18:52,080
management um end game of everything so

567
00:18:52,080 --> 00:18:53,200
you also want to bring along the

568
00:18:53,200 --> 00:18:54,880
application logs

569
00:18:54,880 --> 00:18:56,799
just because a user was able to log in

570
00:18:56,799 --> 00:18:59,120
you know first factor second factor

571
00:18:59,120 --> 00:19:00,880
did the application kick them out or do

572
00:19:00,880 --> 00:19:02,320
they even have permissions to log into

573
00:19:02,320 --> 00:19:03,919
that application uh you want to have

574
00:19:03,919 --> 00:19:07,039
those logs to follow up on that

575
00:19:07,039 --> 00:19:09,760
and then a lot of these

576
00:19:09,760 --> 00:19:11,200
some of the vendors will have

577
00:19:11,200 --> 00:19:13,039
integrations with other major vendors

578
00:19:13,039 --> 00:19:14,559
and can like auto detect like oh you're

579
00:19:14,559 --> 00:19:16,160
using that application

580
00:19:16,160 --> 00:19:18,559
uh other times it's your it or whoever

581
00:19:18,559 --> 00:19:20,320
is configuring your mfa system is

582
00:19:20,320 --> 00:19:22,240
labeling those so hey you labeled this

583
00:19:22,240 --> 00:19:24,880
application website thank you i know

584
00:19:24,880 --> 00:19:26,480
exactly what the user got into there to

585
00:19:26,480 --> 00:19:28,640
follow up on that um

586
00:19:28,640 --> 00:19:30,799
you know or application

587
00:19:30,799 --> 00:19:32,559
level config i think i mentioned that

588
00:19:32,559 --> 00:19:34,080
before that applications can be

589
00:19:34,080 --> 00:19:36,160
configured wrong or they're not

590
00:19:36,160 --> 00:19:38,000
actually allowing the user in so just

591
00:19:38,000 --> 00:19:40,160
take a look at those

592
00:19:40,160 --> 00:19:41,360
what we're going to threat hunt in this

593
00:19:41,360 --> 00:19:43,679
data we're going to be taking a look at

594
00:19:43,679 --> 00:19:45,840
absence over time

595
00:19:45,840 --> 00:19:47,840
keeping an eye on reports how often do

596
00:19:47,840 --> 00:19:50,320
people log into certain applications and

597
00:19:50,320 --> 00:19:52,799
has that uh number started to drop off

598
00:19:52,799 --> 00:19:54,640
recently or dropped off completely you

599
00:19:54,640 --> 00:19:55,600
know is there an application

600
00:19:55,600 --> 00:19:57,039
configuration where maybe it's not

601
00:19:57,039 --> 00:19:57,919
hitting

602
00:19:57,919 --> 00:20:00,640
the mfa system like it should

603
00:20:00,640 --> 00:20:02,240
and then uh you also want to do

604
00:20:02,240 --> 00:20:04,240
application log follow-up i've mentioned

605
00:20:04,240 --> 00:20:06,559
that before it's

606
00:20:06,559 --> 00:20:07,600
getting a

607
00:20:07,600 --> 00:20:09,440
inventory of application logs and being

608
00:20:09,440 --> 00:20:11,039
able to follow up on those is really

609
00:20:11,039 --> 00:20:13,600
really important

610
00:20:13,600 --> 00:20:15,520
uh and then the next piece here is going

611
00:20:15,520 --> 00:20:16,960
to be the

612
00:20:16,960 --> 00:20:18,559
the factor that's used what kind of

613
00:20:18,559 --> 00:20:20,240
factor results of that factor and the

614
00:20:20,240 --> 00:20:22,240
reasons for that factor so here we see

615
00:20:22,240 --> 00:20:24,159
that there's a push that's sending out

616
00:20:24,159 --> 00:20:26,400
to a application on your phone the

617
00:20:26,400 --> 00:20:28,480
result was a success and it's a success

618
00:20:28,480 --> 00:20:31,760
because the user approved it

619
00:20:31,760 --> 00:20:33,120
you also want to bring along your first

620
00:20:33,120 --> 00:20:34,960
factor logs if you see

621
00:20:34,960 --> 00:20:36,720
a bunch of failures like you're seeing a

622
00:20:36,720 --> 00:20:38,400
brute force was the password brute

623
00:20:38,400 --> 00:20:39,919
forced first and now they're brute

624
00:20:39,919 --> 00:20:42,000
forcing the mfa system

625
00:20:42,000 --> 00:20:43,679
you also want to bring along help desk

626
00:20:43,679 --> 00:20:45,760
tickets a lot of times you'll see weird

627
00:20:45,760 --> 00:20:47,520
going on and then you look up help desk

628
00:20:47,520 --> 00:20:48,880
tickets for that user and it's like hey

629
00:20:48,880 --> 00:20:51,440
they were just having a bad day um they

630
00:20:51,440 --> 00:20:52,799
couldn't get their phone to work they

631
00:20:52,799 --> 00:20:54,080
couldn't get the push to work or

632
00:20:54,080 --> 00:20:55,360
whatever

633
00:20:55,360 --> 00:20:57,120
uh and then just remember defense and

634
00:20:57,120 --> 00:20:59,039
depth success here does not always mean

635
00:20:59,039 --> 00:21:01,679
success in the application

636
00:21:01,679 --> 00:21:02,960
and we're actually going to deep dive a

637
00:21:02,960 --> 00:21:04,159
little bit further into these i have

638
00:21:04,159 --> 00:21:06,480
some good examples here so

639
00:21:06,480 --> 00:21:08,159
brute force

640
00:21:08,159 --> 00:21:09,440
we'll dive into this we're going to

641
00:21:09,440 --> 00:21:11,840
verify this was a benign hit

642
00:21:11,840 --> 00:21:13,360
because if you kind of

643
00:21:13,360 --> 00:21:14,320
take a look at this a little bit

644
00:21:14,320 --> 00:21:16,400
interesting when we break down those

645
00:21:16,400 --> 00:21:18,159
five individual hits

646
00:21:18,159 --> 00:21:19,760
the logins appear to have completely

647
00:21:19,760 --> 00:21:21,360
random timing there's no real pattern

648
00:21:21,360 --> 00:21:23,600
there

649
00:21:24,000 --> 00:21:25,600
we have a successful login after the

650
00:21:25,600 --> 00:21:27,760
failures

651
00:21:27,760 --> 00:21:29,600
we're going to talk to ivan's manager

652
00:21:29,600 --> 00:21:32,240
and we're taking a look specifically at

653
00:21:32,240 --> 00:21:33,280
um

654
00:21:33,280 --> 00:21:35,200
we have that asset inventory so we know

655
00:21:35,200 --> 00:21:36,720
that ivan has a mobile phone we know

656
00:21:36,720 --> 00:21:38,400
ivan has a work phone and those approved

657
00:21:38,400 --> 00:21:40,320
numbers looking at that authentication

658
00:21:40,320 --> 00:21:43,039
device that's kind of weird um he has a

659
00:21:43,039 --> 00:21:45,919
9-1 which is the country code for india

660
00:21:45,919 --> 00:21:48,480
where 919 is the

661
00:21:48,480 --> 00:21:50,720
local area code for rtp

662
00:21:50,720 --> 00:21:52,960
so that's kind of odd that he added a

663
00:21:52,960 --> 00:21:54,320
phone number for india there to his

664
00:21:54,320 --> 00:21:56,840
account because we have open

665
00:21:56,840 --> 00:21:59,600
uh uh open self-service adding devices

666
00:21:59,600 --> 00:22:01,600
turned on so we're gonna talk to his

667
00:22:01,600 --> 00:22:03,679
manager and it turns out hey he typoed

668
00:22:03,679 --> 00:22:05,360
his desk phone number he thought he had

669
00:22:05,360 --> 00:22:07,280
to press 91 to get out of the system and

670
00:22:07,280 --> 00:22:08,720
ended up coding that

671
00:22:08,720 --> 00:22:10,559
into uh his

672
00:22:10,559 --> 00:22:12,400
authentication methods

673
00:22:12,400 --> 00:22:13,790
um so we're just going to

674
00:22:13,790 --> 00:22:14,960
[Music]

675
00:22:14,960 --> 00:22:16,720
uh and then also his his mobile phone

676
00:22:16,720 --> 00:22:18,080
was on silent and that's why the the

677
00:22:18,080 --> 00:22:21,440
push messages were on fail we're we're

678
00:22:21,440 --> 00:22:23,760
um we're failing and not being answered

679
00:22:23,760 --> 00:22:25,280
so we're going to go in and we're gonna

680
00:22:25,280 --> 00:22:26,799
fix that for him and get rid of that

681
00:22:26,799 --> 00:22:28,320
that phone for him

682
00:22:28,320 --> 00:22:31,520
and that was pretty benign

683
00:22:31,760 --> 00:22:32,720
the next one here we're gonna

684
00:22:32,720 --> 00:22:34,559
investigate a little bit further oh we

685
00:22:34,559 --> 00:22:36,960
don't have asset inventory we have no

686
00:22:36,960 --> 00:22:38,960
idea what faith's phone number should be

687
00:22:38,960 --> 00:22:40,880
that's very sad we also have no idea

688
00:22:40,880 --> 00:22:43,120
where she should be located so are those

689
00:22:43,120 --> 00:22:45,440
logins weird or not we have no idea is

690
00:22:45,440 --> 00:22:47,679
that phone number weird we have no idea

691
00:22:47,679 --> 00:22:48,720
um

692
00:22:48,720 --> 00:22:50,159
we see that we have a high count of

693
00:22:50,159 --> 00:22:52,159
failed logins so we have 27. let's take

694
00:22:52,159 --> 00:22:54,480
a look at those a little bit closer

695
00:22:54,480 --> 00:22:56,240
it turns out those login attempts are

696
00:22:56,240 --> 00:22:58,640
exactly five minutes apart to the second

697
00:22:58,640 --> 00:23:00,960
so that's a bit odd

698
00:23:00,960 --> 00:23:02,000
um

699
00:23:02,000 --> 00:23:03,520
we do have an asset inventory for the

700
00:23:03,520 --> 00:23:05,200
laptop though and we see that faith was

701
00:23:05,200 --> 00:23:07,120
issued a mac os at this company we have

702
00:23:07,120 --> 00:23:09,360
a windows system logging in so again

703
00:23:09,360 --> 00:23:11,360
that's odd so let's go ahead and talk to

704
00:23:11,360 --> 00:23:14,320
faith's manager she's on vacation

705
00:23:14,320 --> 00:23:15,919
this is great so we're just going to go

706
00:23:15,919 --> 00:23:17,600
ahead and disable face account until she

707
00:23:17,600 --> 00:23:18,960
returns and then we're going to reissue

708
00:23:18,960 --> 00:23:20,960
her a new password so that the attempts

709
00:23:20,960 --> 00:23:23,360
against the second factor are gonna stop

710
00:23:23,360 --> 00:23:26,320
disable the account just in case uh she

711
00:23:26,320 --> 00:23:28,400
decides to click accept on one of those

712
00:23:28,400 --> 00:23:30,080
pushes that keep coming through in that

713
00:23:30,080 --> 00:23:32,400
route for us

714
00:23:32,400 --> 00:23:33,760
and then we're gonna go ahead and follow

715
00:23:33,760 --> 00:23:35,360
up and do further investigation on those

716
00:23:35,360 --> 00:23:37,280
login attempts we had a correct password

717
00:23:37,280 --> 00:23:39,039
how did that correct password get leaked

718
00:23:39,039 --> 00:23:40,159
out

719
00:23:40,159 --> 00:23:42,159
and do further investigation on that see

720
00:23:42,159 --> 00:23:45,039
if there were any users or anything

721
00:23:45,039 --> 00:23:46,640
the next one i'm going to talk about is

722
00:23:46,640 --> 00:23:48,400
suspicious login reporting a lot of

723
00:23:48,400 --> 00:23:49,200
people

724
00:23:49,200 --> 00:23:50,960
that i've talked to actually didn't know

725
00:23:50,960 --> 00:23:52,320
that this was a thing

726
00:23:52,320 --> 00:23:53,760
um where

727
00:23:53,760 --> 00:23:55,760
you can have users actually report in if

728
00:23:55,760 --> 00:23:57,440
they see a suspicious or fraudulent

729
00:23:57,440 --> 00:23:59,039
login you get a push

730
00:23:59,039 --> 00:24:00,880
you can say hey that was weird i deny

731
00:24:00,880 --> 00:24:02,240
that and then i'm reporting that as

732
00:24:02,240 --> 00:24:03,279
fraud

733
00:24:03,279 --> 00:24:05,840
same thing with a phone call factor

734
00:24:05,840 --> 00:24:07,360
calling in you can press one number to

735
00:24:07,360 --> 00:24:08,880
accept it and a different number to

736
00:24:08,880 --> 00:24:10,880
report it as fraud i love this because

737
00:24:10,880 --> 00:24:13,919
it allows users to actively uh report

738
00:24:13,919 --> 00:24:15,200
weird things that they see in the

739
00:24:15,200 --> 00:24:17,200
environment setting up another detection

740
00:24:17,200 --> 00:24:18,400
method for you

741
00:24:18,400 --> 00:24:19,679
um

742
00:24:19,679 --> 00:24:21,120
this happens with the push or the phone

743
00:24:21,120 --> 00:24:23,039
call options can't really do it with an

744
00:24:23,039 --> 00:24:24,880
sms or anything like that

745
00:24:24,880 --> 00:24:27,039
and then you have to educate the users

746
00:24:27,039 --> 00:24:28,480
they have to know that it exists they

747
00:24:28,480 --> 00:24:30,000
have to know that it's there in order

748
00:24:30,000 --> 00:24:31,919
for them to be able to push that button

749
00:24:31,919 --> 00:24:33,919
and let you know also want to give them

750
00:24:33,919 --> 00:24:35,520
some information maybe to your incident

751
00:24:35,520 --> 00:24:37,039
response team like after you push the

752
00:24:37,039 --> 00:24:38,400
button could you please email us and

753
00:24:38,400 --> 00:24:40,480
tell us if you saw anything else weird

754
00:24:40,480 --> 00:24:42,400
going on or just how to get in contact

755
00:24:42,400 --> 00:24:43,919
with that

756
00:24:43,919 --> 00:24:45,440
so we're going to take a look at some uh

757
00:24:45,440 --> 00:24:48,240
suspicious login reports some logs here

758
00:24:48,240 --> 00:24:50,559
um we're gonna verify benign again here

759
00:24:50,559 --> 00:24:52,320
with with ivan

760
00:24:52,320 --> 00:24:53,760
uh the first thing that you'll notice is

761
00:24:53,760 --> 00:24:56,640
that his auth device matches his mobile

762
00:24:56,640 --> 00:24:58,640
on file and this is pretty much always

763
00:24:58,640 --> 00:24:59,840
gonna happen

764
00:24:59,840 --> 00:25:01,919
it's going to be the original user's

765
00:25:01,919 --> 00:25:03,520
phone that is reporting fraud if you're

766
00:25:03,520 --> 00:25:05,440
a red teamer or an attacker why are you

767
00:25:05,440 --> 00:25:08,320
reporting the authentication as fraud um

768
00:25:08,320 --> 00:25:10,240
probably not going to happen that's a

769
00:25:10,240 --> 00:25:12,480
bad attack if it does

770
00:25:12,480 --> 00:25:13,600
i'm going to take a look here and the

771
00:25:13,600 --> 00:25:16,400
access ip matches the authentication ip

772
00:25:16,400 --> 00:25:18,480
so that means that both the phone that

773
00:25:18,480 --> 00:25:20,320
we're sending the the push out to is in

774
00:25:20,320 --> 00:25:22,240
the same location enough that it's at

775
00:25:22,240 --> 00:25:23,440
least going out through the same router

776
00:25:23,440 --> 00:25:24,640
getting the same ip address and

777
00:25:24,640 --> 00:25:27,120
everything as the access device which

778
00:25:27,120 --> 00:25:28,320
could be a laptop or could be a

779
00:25:28,320 --> 00:25:31,039
different device

780
00:25:31,039 --> 00:25:32,480
so we're taking a look here a little bit

781
00:25:32,480 --> 00:25:35,120
more into ivan himself and his outlook

782
00:25:35,120 --> 00:25:36,799
status says that he's traveling that's

783
00:25:36,799 --> 00:25:38,559
interesting let's talk to ivan's manager

784
00:25:38,559 --> 00:25:40,640
why did he report fraud

785
00:25:40,640 --> 00:25:42,640
since he's out we can't really talk to

786
00:25:42,640 --> 00:25:43,760
him directly

787
00:25:43,760 --> 00:25:44,880
um

788
00:25:44,880 --> 00:25:46,960
so it turns out that ivan saw this

789
00:25:46,960 --> 00:25:49,520
really cool talk at b-sides las vegas

790
00:25:49,520 --> 00:25:51,840
and got all excited about fraud reports

791
00:25:51,840 --> 00:25:53,440
and decided to sit around the bar and

792
00:25:53,440 --> 00:25:55,120
take some bets and it turns out he was

793
00:25:55,120 --> 00:25:56,480
showing off how fast his incident

794
00:25:56,480 --> 00:25:58,240
response team will respond to a fraud

795
00:25:58,240 --> 00:25:59,520
report

796
00:25:59,520 --> 00:26:00,640
so

797
00:26:00,640 --> 00:26:04,080
my company is faster than yours

798
00:26:04,400 --> 00:26:06,240
so we we're gonna

799
00:26:06,240 --> 00:26:07,760
verify that benign and like please don't

800
00:26:07,760 --> 00:26:10,919
do that

801
00:26:11,200 --> 00:26:14,320
i'm going to take another care

802
00:26:21,279 --> 00:26:23,600
yes yes the ir team gets a percentage of

803
00:26:23,600 --> 00:26:25,760
the winnings for responding so quickly

804
00:26:25,760 --> 00:26:26,799
um

805
00:26:26,799 --> 00:26:28,080
so so this next one we're gonna

806
00:26:28,080 --> 00:26:29,679
investigate a little bit more faith is

807
00:26:29,679 --> 00:26:31,760
back um

808
00:26:31,760 --> 00:26:33,840
and the asset inventory shows again that

809
00:26:33,840 --> 00:26:35,360
faith was issued to mac os and we have a

810
00:26:35,360 --> 00:26:37,120
windows device logging in

811
00:26:37,120 --> 00:26:39,600
um we learned our lesson from the the

812
00:26:39,600 --> 00:26:41,039
brute force and

813
00:26:41,039 --> 00:26:42,720
now have her phone number on file so we

814
00:26:42,720 --> 00:26:44,720
can take a look at that

815
00:26:44,720 --> 00:26:46,799
uh it turns out uh we talked to faith's

816
00:26:46,799 --> 00:26:48,400
manager

817
00:26:48,400 --> 00:26:49,279
uh

818
00:26:49,279 --> 00:26:52,400
turns out faith is on vacation again

819
00:26:52,400 --> 00:26:53,760
and we're gonna go ahead and disable her

820
00:26:53,760 --> 00:26:55,840
her account and wait until she comes

821
00:26:55,840 --> 00:26:58,159
back to reissue her password and when we

822
00:26:58,159 --> 00:26:59,919
do further investigation you can see the

823
00:26:59,919 --> 00:27:01,840
login attempts are from the same subnet

824
00:27:01,840 --> 00:27:03,760
as before we talked to faith about her

825
00:27:03,760 --> 00:27:05,279
password and hey what did you do when

826
00:27:05,279 --> 00:27:06,480
you changed it

827
00:27:06,480 --> 00:27:08,480
she incremented it by one that's a

828
00:27:08,480 --> 00:27:10,480
different password so

829
00:27:10,480 --> 00:27:12,320
pretty easy to guess again and get back

830
00:27:12,320 --> 00:27:13,679
into the system in order to start

831
00:27:13,679 --> 00:27:15,200
sending pushes

832
00:27:15,200 --> 00:27:16,640
but we taught her how to report fraud

833
00:27:16,640 --> 00:27:18,159
this time so instead of getting just

834
00:27:18,159 --> 00:27:19,120
hammered

835
00:27:19,120 --> 00:27:21,120
she was able to

836
00:27:21,120 --> 00:27:22,960
report fraud and get the incident

837
00:27:22,960 --> 00:27:26,080
response team on on it right away

838
00:27:26,080 --> 00:27:27,279
so the next piece that we're going to

839
00:27:27,279 --> 00:27:29,840
take a look at are

840
00:27:29,840 --> 00:27:31,200
phones themselves

841
00:27:31,200 --> 00:27:33,279
um

842
00:27:33,279 --> 00:27:35,760
yeah so phone number or the or the token

843
00:27:35,760 --> 00:27:37,919
that you're using um if you're getting a

844
00:27:37,919 --> 00:27:40,799
push and again the ip address is based

845
00:27:40,799 --> 00:27:41,760
or

846
00:27:41,760 --> 00:27:42,799
yeah the ip address of the

847
00:27:42,799 --> 00:27:44,080
authentication device and then it's a

848
00:27:44,080 --> 00:27:45,919
location based on an ip lookup service

849
00:27:45,919 --> 00:27:47,679
again you want to bring your employee

850
00:27:47,679 --> 00:27:50,559
phone book again that inventory

851
00:27:50,559 --> 00:27:52,399
mobile device asset inventory if you're

852
00:27:52,399 --> 00:27:53,520
issuing

853
00:27:53,520 --> 00:27:55,679
cell phones out to users

854
00:27:55,679 --> 00:27:57,679
or are you allowing them byod with some

855
00:27:57,679 --> 00:27:59,919
level of registration or mobile device

856
00:27:59,919 --> 00:28:01,039
management

857
00:28:01,039 --> 00:28:02,480
and then you want to have a kind of a

858
00:28:02,480 --> 00:28:04,000
basic understanding of phone number

859
00:28:04,000 --> 00:28:05,840
country codes and locations and things

860
00:28:05,840 --> 00:28:08,158
like that

861
00:28:08,240 --> 00:28:10,159
and then the caveat here is bring your

862
00:28:10,159 --> 00:28:12,399
own device or open enrollment if you're

863
00:28:12,399 --> 00:28:13,679
not keeping track of that at all you're

864
00:28:13,679 --> 00:28:15,440
going to have no idea what

865
00:28:15,440 --> 00:28:18,000
what's coming in here is normal or not

866
00:28:18,000 --> 00:28:19,440
and then

867
00:28:19,440 --> 00:28:21,919
remember that pushes and codes don't

868
00:28:21,919 --> 00:28:24,320
require cellular you can get a push over

869
00:28:24,320 --> 00:28:26,880
wi-fi and if you're

870
00:28:26,880 --> 00:28:28,559
getting

871
00:28:28,559 --> 00:28:30,240
authentication codes out of the

872
00:28:30,240 --> 00:28:31,919
application itself that doesn't require

873
00:28:31,919 --> 00:28:34,000
cellular so you're not gonna get an ip

874
00:28:34,000 --> 00:28:35,279
sometimes you might not even get a phone

875
00:28:35,279 --> 00:28:37,039
number just that they use the app to do

876
00:28:37,039 --> 00:28:38,880
that

877
00:28:38,880 --> 00:28:41,520
so we're gonna go uh hunting in the

878
00:28:41,520 --> 00:28:43,360
authentication device data

879
00:28:43,360 --> 00:28:45,120
and we're going to take a look at a

880
00:28:45,120 --> 00:28:47,120
mismatched the access so here in this

881
00:28:47,120 --> 00:28:48,640
log we see that the authentication

882
00:28:48,640 --> 00:28:50,799
device was located in california but

883
00:28:50,799 --> 00:28:52,640
that access device or that laptop that

884
00:28:52,640 --> 00:28:54,080
was trying to log in is saying that it

885
00:28:54,080 --> 00:28:56,159
was in moscow so

886
00:28:56,159 --> 00:28:57,200
we're going to take a look at that one a

887
00:28:57,200 --> 00:28:59,120
little bit more

888
00:28:59,120 --> 00:29:00,320
uh the other thing that you want to take

889
00:29:00,320 --> 00:29:02,480
a look at is multiples and i'm going to

890
00:29:02,480 --> 00:29:03,840
get into that

891
00:29:03,840 --> 00:29:06,399
we'll do deep dive into that here with

892
00:29:06,399 --> 00:29:08,960
multiple users on one phone number

893
00:29:08,960 --> 00:29:10,480
so

894
00:29:10,480 --> 00:29:12,080
we're going to dig into these a little

895
00:29:12,080 --> 00:29:13,039
bit more

896
00:29:13,039 --> 00:29:15,039
here we have uh

897
00:29:15,039 --> 00:29:17,600
six users that are all using one phone

898
00:29:17,600 --> 00:29:20,960
number and one extension

899
00:29:20,960 --> 00:29:22,000
and we're gonna take a look at those

900
00:29:22,000 --> 00:29:24,080
users a little bit more those help desk

901
00:29:24,080 --> 00:29:25,760
agents they all have the same manager

902
00:29:25,760 --> 00:29:27,760
and the same hire date

903
00:29:27,760 --> 00:29:28,640
and we're going to go ahead and call

904
00:29:28,640 --> 00:29:29,520
that number because that's kind of

905
00:29:29,520 --> 00:29:31,120
interesting that they're using an

906
00:29:31,120 --> 00:29:32,480
extension

907
00:29:32,480 --> 00:29:34,240
and it turns out that it plays a tone

908
00:29:34,240 --> 00:29:36,080
and when we look up that tone it's

909
00:29:36,080 --> 00:29:38,080
pressing the number one so the outgoing

910
00:29:38,080 --> 00:29:39,679
voicemail message on that extension it

911
00:29:39,679 --> 00:29:41,200
goes straight to voicemail and then just

912
00:29:41,200 --> 00:29:44,559
plays the number one to accept our mfa

913
00:29:44,559 --> 00:29:46,559
so we have six people just automatically

914
00:29:46,559 --> 00:29:48,240
accepting mfa

915
00:29:48,240 --> 00:29:49,679
uh so we're going to have some emails

916
00:29:49,679 --> 00:29:51,600
with a manager and what's going on oh

917
00:29:51,600 --> 00:29:53,120
turns out it's a secure building they

918
00:29:53,120 --> 00:29:54,799
can't use mobile they can't use any sort

919
00:29:54,799 --> 00:29:56,399
of other devices but you know what we're

920
00:29:56,399 --> 00:29:58,399
going to issue them some hard tokens so

921
00:29:58,399 --> 00:30:00,000
that they aren't just using the same

922
00:30:00,000 --> 00:30:02,720
extension and bypassing mfa completely

923
00:30:02,720 --> 00:30:04,799
so

924
00:30:04,799 --> 00:30:06,159
next one we're going to investigate a

925
00:30:06,159 --> 00:30:07,360
little bit more

926
00:30:07,360 --> 00:30:09,120
uh we're taking a look at grace's

927
00:30:09,120 --> 00:30:11,360
landline she's named it for us so that's

928
00:30:11,360 --> 00:30:13,600
nice

929
00:30:13,600 --> 00:30:15,039
we have three people here and they all

930
00:30:15,039 --> 00:30:16,559
have three different job titles which is

931
00:30:16,559 --> 00:30:17,760
kind of interesting we're going to look

932
00:30:17,760 --> 00:30:19,600
into this a little bit more

933
00:30:19,600 --> 00:30:20,880
and it turns out that grace is with

934
00:30:20,880 --> 00:30:22,399
laptop support and she's doing some

935
00:30:22,399 --> 00:30:26,080
shadow i.t to to do her job here um so

936
00:30:26,080 --> 00:30:28,960
instead of going about uh calling up

937
00:30:28,960 --> 00:30:31,279
trudy or frank she's actually

938
00:30:31,279 --> 00:30:32,399
adding her

939
00:30:32,399 --> 00:30:34,480
phone to their

940
00:30:34,480 --> 00:30:36,480
systems and knowing their their uh

941
00:30:36,480 --> 00:30:38,000
passwords so that she can go in and make

942
00:30:38,000 --> 00:30:40,320
changes to their account and set up

943
00:30:40,320 --> 00:30:41,760
laptops and stuff for them while they

944
00:30:41,760 --> 00:30:43,520
aren't there while they're out on lunch

945
00:30:43,520 --> 00:30:46,080
she can log in and set up those laptops

946
00:30:46,080 --> 00:30:47,840
turns out the time stamps on those login

947
00:30:47,840 --> 00:30:49,520
match the time frames of her support

948
00:30:49,520 --> 00:30:51,679
tickets so again having your support

949
00:30:51,679 --> 00:30:53,120
ticket system so you can go back and

950
00:30:53,120 --> 00:30:55,279
cross-reference that

951
00:30:55,279 --> 00:30:56,720
uh and we're going to confirm that

952
00:30:56,720 --> 00:30:58,000
there's a password change on all of

953
00:30:58,000 --> 00:30:59,360
those users and we're going to remove

954
00:30:59,360 --> 00:31:01,519
grace's landline from those other users

955
00:31:01,519 --> 00:31:02,720
because that shouldn't be happening and

956
00:31:02,720 --> 00:31:03,840
then we're gonna have a conversation

957
00:31:03,840 --> 00:31:05,519
with her management

958
00:31:05,519 --> 00:31:07,200
and make the support process more secure

959
00:31:07,200 --> 00:31:08,399
make sure that they shouldn't be doing

960
00:31:08,399 --> 00:31:11,120
things like that um it is kind of nice

961
00:31:11,120 --> 00:31:12,799
and you do notice that that people can

962
00:31:12,799 --> 00:31:13,840
know

963
00:31:13,840 --> 00:31:15,120
in some of these systems people can

964
00:31:15,120 --> 00:31:17,279
label their their phone numbers so one

965
00:31:17,279 --> 00:31:18,480
of the things that i did when i first

966
00:31:18,480 --> 00:31:20,640
started digging around in the logs was i

967
00:31:20,640 --> 00:31:22,720
threw in an easter egg and anybody that

968
00:31:22,720 --> 00:31:24,000
that goes in and tries to look at my

969
00:31:24,000 --> 00:31:25,120
logs they're going to see that i always

970
00:31:25,120 --> 00:31:28,240
log in from a banana phone

971
00:31:28,240 --> 00:31:29,679
so

972
00:31:29,679 --> 00:31:33,760
good luck looking at that

973
00:31:33,760 --> 00:31:35,440
the next example here

974
00:31:35,440 --> 00:31:37,919
is one user multiple phones

975
00:31:37,919 --> 00:31:40,159
and again i wrote this talk in november

976
00:31:40,159 --> 00:31:42,000
2019 you might remember something that

977
00:31:42,000 --> 00:31:45,039
happened in december 2020 where fireeye

978
00:31:45,039 --> 00:31:47,200
was able to detect an attacker in their

979
00:31:47,200 --> 00:31:48,880
in their system when they noticed a

980
00:31:48,880 --> 00:31:51,519
second phone on an employee's mfa

981
00:31:51,519 --> 00:31:53,360
um so

982
00:31:53,360 --> 00:31:56,000
it was added to that um

983
00:31:56,000 --> 00:31:56,720
but

984
00:31:56,720 --> 00:31:58,720
if you aren't keeping track of new

985
00:31:58,720 --> 00:32:00,399
devices that are being added or you have

986
00:32:00,399 --> 00:32:02,320
a history we're going to go into how do

987
00:32:02,320 --> 00:32:04,080
you hunt for that after the fact if

988
00:32:04,080 --> 00:32:05,440
you're not getting those alerts real

989
00:32:05,440 --> 00:32:06,480
time

990
00:32:06,480 --> 00:32:07,519
so

991
00:32:07,519 --> 00:32:08,640
we're going to dig into this a little

992
00:32:08,640 --> 00:32:09,760
bit

993
00:32:09,760 --> 00:32:12,080
and we're going to do this one as benign

994
00:32:12,080 --> 00:32:14,480
we see that we have the mobile inventory

995
00:32:14,480 --> 00:32:16,399
um and we have her work phone number and

996
00:32:16,399 --> 00:32:17,919
if you take a look at those a little bit

997
00:32:17,919 --> 00:32:20,080
closer we do have three phones there but

998
00:32:20,080 --> 00:32:21,840
one of them has been named

999
00:32:21,840 --> 00:32:24,080
so where else previously had an

1000
00:32:24,080 --> 00:32:25,840
unlabeled cell phone

1001
00:32:25,840 --> 00:32:27,760
uh ellis got a new iphone so cool

1002
00:32:27,760 --> 00:32:30,240
congratulations um the mfa system had a

1003
00:32:30,240 --> 00:32:32,399
code update so when she added that phone

1004
00:32:32,399 --> 00:32:34,640
it decided to tag on iphone for us to

1005
00:32:34,640 --> 00:32:35,919
try to be helpful

1006
00:32:35,919 --> 00:32:37,519
uh so she installed mfa on the new phone

1007
00:32:37,519 --> 00:32:39,279
which caused the mfa system to relabel

1008
00:32:39,279 --> 00:32:40,640
it so

1009
00:32:40,640 --> 00:32:42,559
that's benign all those uh phones are

1010
00:32:42,559 --> 00:32:44,159
accounted for

1011
00:32:44,159 --> 00:32:45,200
we're gonna investigate this one a

1012
00:32:45,200 --> 00:32:46,640
little bit more because this is indirect

1013
00:32:46,640 --> 00:32:48,799
interesting uh we see that we have a

1014
00:32:48,799 --> 00:32:51,120
mobile number and a

1015
00:32:51,120 --> 00:32:52,320
um

1016
00:32:52,320 --> 00:32:54,000
work number on file for him and then we

1017
00:32:54,000 --> 00:32:56,720
have these five other phones and bob's

1018
00:32:56,720 --> 00:32:58,080
logging phones don't match the company

1019
00:32:58,080 --> 00:32:59,440
records so this is starting to look

1020
00:32:59,440 --> 00:33:00,320
weird

1021
00:33:00,320 --> 00:33:02,159
uh the logins happen at all hours of the

1022
00:33:02,159 --> 00:33:04,080
day he's logging in at 1am he's logging

1023
00:33:04,080 --> 00:33:07,200
in at 1pm he's logging in

1024
00:33:07,200 --> 00:33:09,679
just all different hours of the day

1025
00:33:09,679 --> 00:33:11,279
we're gonna contact bob's manager about

1026
00:33:11,279 --> 00:33:13,519
this and try to see what's going on and

1027
00:33:13,519 --> 00:33:15,200
oh it turns out he was outsourcing his

1028
00:33:15,200 --> 00:33:17,200
work to other contractors and they had

1029
00:33:17,200 --> 00:33:18,880
his password and added all their phones

1030
00:33:18,880 --> 00:33:20,880
to his account bob's doing the work of

1031
00:33:20,880 --> 00:33:25,559
five people because he is five people

1032
00:33:27,200 --> 00:33:29,360
so

1033
00:33:29,440 --> 00:33:30,640
now i'm going to kind of get into like

1034
00:33:30,640 --> 00:33:31,840
some gray areas and beyond the

1035
00:33:31,840 --> 00:33:33,760
technology you have restricted areas and

1036
00:33:33,760 --> 00:33:35,760
skiffs and like how do you

1037
00:33:35,760 --> 00:33:37,600
compensate and work around that the

1038
00:33:37,600 --> 00:33:38,880
whole thing of like oh they're going to

1039
00:33:38,880 --> 00:33:40,399
an extension

1040
00:33:40,399 --> 00:33:42,720
have a plan to like issue ub keys or

1041
00:33:42,720 --> 00:33:45,519
one-time passwords uh password tokens if

1042
00:33:45,519 --> 00:33:48,320
those are acceptable in those areas

1043
00:33:48,320 --> 00:33:49,519
the other thing

1044
00:33:49,519 --> 00:33:51,760
is contractors a lot of times

1045
00:33:51,760 --> 00:33:53,519
contractors are given expectations of

1046
00:33:53,519 --> 00:33:54,960
employees but they aren't given the

1047
00:33:54,960 --> 00:33:56,720
permissions and abilities to do things

1048
00:33:56,720 --> 00:33:58,720
that employees are able to do so make

1049
00:33:58,720 --> 00:34:00,159
sure that you level set those so that

1050
00:34:00,159 --> 00:34:02,080
contractors aren't

1051
00:34:02,080 --> 00:34:03,919
trying to use credentials of employees

1052
00:34:03,919 --> 00:34:06,799
in order to just do their job and then

1053
00:34:06,799 --> 00:34:09,119
the last one is assistance and what i

1054
00:34:09,119 --> 00:34:10,800
mean

1055
00:34:10,800 --> 00:34:12,719
by this is is

1056
00:34:12,719 --> 00:34:14,000
for the call for papers for this

1057
00:34:14,000 --> 00:34:15,839
conference even they understand the

1058
00:34:15,839 --> 00:34:17,679
concept that people have administrative

1059
00:34:17,679 --> 00:34:19,280
assistants or people that help them out

1060
00:34:19,280 --> 00:34:20,480
with different things

1061
00:34:20,480 --> 00:34:22,320
there are lots of

1062
00:34:22,320 --> 00:34:24,159
applications that don't understand this

1063
00:34:24,159 --> 00:34:26,320
concept so if you have somebody that has

1064
00:34:26,320 --> 00:34:28,639
an assistant how do they log in as that

1065
00:34:28,639 --> 00:34:30,399
person in order to assist that person

1066
00:34:30,399 --> 00:34:32,480
with their job it's amazing how many

1067
00:34:32,480 --> 00:34:34,239
people don't understand delegation in

1068
00:34:34,239 --> 00:34:35,520
applications

1069
00:34:35,520 --> 00:34:37,520
and are logging into

1070
00:34:37,520 --> 00:34:39,599
the higher level person that they are

1071
00:34:39,599 --> 00:34:41,839
assisting so

1072
00:34:41,839 --> 00:34:44,399
be on the lookout for that

1073
00:34:44,399 --> 00:34:45,679
and then i'm going to get into the

1074
00:34:45,679 --> 00:34:46,879
actions

1075
00:34:46,879 --> 00:34:48,480
that you can take back with you

1076
00:34:48,480 --> 00:34:51,119
is go out and respond to findings um

1077
00:34:51,119 --> 00:34:52,960
limit self-enrollment i've kind of made

1078
00:34:52,960 --> 00:34:54,079
that clear where it's like hey if you

1079
00:34:54,079 --> 00:34:55,918
let people uh

1080
00:34:55,918 --> 00:34:58,079
add other devices they will

1081
00:34:58,079 --> 00:34:59,680
if you don't explain to them how backups

1082
00:34:59,680 --> 00:35:01,440
work you might see things like oh yeah i

1083
00:35:01,440 --> 00:35:03,280
added my spouse's phone to my account

1084
00:35:03,280 --> 00:35:04,960
because if i lose my phone i can use my

1085
00:35:04,960 --> 00:35:07,520
spouse's phone what is that allowed

1086
00:35:07,520 --> 00:35:08,720
maybe think about limiting

1087
00:35:08,720 --> 00:35:10,320
self-enrollment

1088
00:35:10,320 --> 00:35:12,320
you might want to limit um

1089
00:35:12,320 --> 00:35:13,599
or just not have phone call

1090
00:35:13,599 --> 00:35:15,359
authentication it's one of those things

1091
00:35:15,359 --> 00:35:17,280
where you don't have to unlock the phone

1092
00:35:17,280 --> 00:35:19,680
so if somebody loses their their laptop

1093
00:35:19,680 --> 00:35:20,720
and their phone is also in their

1094
00:35:20,720 --> 00:35:22,560
backpack they now have access to the

1095
00:35:22,560 --> 00:35:23,839
second factor

1096
00:35:23,839 --> 00:35:26,000
with a phone call without having to

1097
00:35:26,000 --> 00:35:27,200
um

1098
00:35:27,200 --> 00:35:28,560
having to do anything else to get into

1099
00:35:28,560 --> 00:35:29,440
that

1100
00:35:29,440 --> 00:35:30,880
if you do have the phone call you might

1101
00:35:30,880 --> 00:35:31,760
want to

1102
00:35:31,760 --> 00:35:34,079
um

1103
00:35:34,720 --> 00:35:36,400
you might want to change the default

1104
00:35:36,400 --> 00:35:37,680
number on that

1105
00:35:37,680 --> 00:35:38,800
the

1106
00:35:38,800 --> 00:35:40,480
the group there that was able to play

1107
00:35:40,480 --> 00:35:42,480
the tone in the voicemail they knew that

1108
00:35:42,480 --> 00:35:43,680
it was always going to be like the

1109
00:35:43,680 --> 00:35:46,400
number one to accept that push just

1110
00:35:46,400 --> 00:35:48,079
change that up every so often so you

1111
00:35:48,079 --> 00:35:50,160
have to actually listen to the message

1112
00:35:50,160 --> 00:35:52,000
in order to push the right number

1113
00:35:52,000 --> 00:35:54,079
and then be sure that you

1114
00:35:54,079 --> 00:35:56,160
uh

1115
00:35:56,160 --> 00:35:57,760
be sure that you fix what you find you

1116
00:35:57,760 --> 00:36:00,160
find a lot of weird stuff um just don't

1117
00:36:00,160 --> 00:36:01,520
let it slide like oh yeah this is how

1118
00:36:01,520 --> 00:36:03,359
it's done it for 10 years just logging

1119
00:36:03,359 --> 00:36:05,040
in as other people to do their job like

1120
00:36:05,040 --> 00:36:06,720
actually um

1121
00:36:06,720 --> 00:36:09,119
dig in and get through and do that

1122
00:36:09,119 --> 00:36:10,560
you want to be sure that you educate

1123
00:36:10,560 --> 00:36:12,480
your users beyond the password policy

1124
00:36:12,480 --> 00:36:14,079
educate them about reporting fraud

1125
00:36:14,079 --> 00:36:16,480
educate them about um

1126
00:36:16,480 --> 00:36:18,079
not adding other phones and things like

1127
00:36:18,079 --> 00:36:18,960
that

1128
00:36:18,960 --> 00:36:19,340
um

1129
00:36:19,340 --> 00:36:20,560
[Music]

1130
00:36:20,560 --> 00:36:22,480
well let them

1131
00:36:22,480 --> 00:36:23,680
make sure that they understand to report

1132
00:36:23,680 --> 00:36:27,680
those suspicious mfa requests and fraud

1133
00:36:27,680 --> 00:36:29,119
and let them know that it's okay to

1134
00:36:29,119 --> 00:36:30,400
report

1135
00:36:30,400 --> 00:36:33,599
user requests for sharing credentials

1136
00:36:33,599 --> 00:36:37,040
i had a situation where a contractor

1137
00:36:37,040 --> 00:36:38,960
was being pressured by their management

1138
00:36:38,960 --> 00:36:40,160
to share their credentials for the

1139
00:36:40,160 --> 00:36:42,480
company in order to get their paycheck

1140
00:36:42,480 --> 00:36:44,800
uh because the the manager who is not

1141
00:36:44,800 --> 00:36:46,400
part of the who's part of the

1142
00:36:46,400 --> 00:36:48,000
contracting company not part of the

1143
00:36:48,000 --> 00:36:49,920
company um

1144
00:36:49,920 --> 00:36:52,480
wanted to log in and basically scrape

1145
00:36:52,480 --> 00:36:54,720
company data uh in order to do

1146
00:36:54,720 --> 00:36:56,720
recruiting and things like that but

1147
00:36:56,720 --> 00:36:58,800
um make sure that it that users can

1148
00:36:58,800 --> 00:37:00,960
report things um or

1149
00:37:00,960 --> 00:37:02,880
you know hey like this this admins away

1150
00:37:02,880 --> 00:37:04,400
on vacation share the password share the

1151
00:37:04,400 --> 00:37:05,599
credentials and stuff like that make

1152
00:37:05,599 --> 00:37:06,800
sure that that can be reported and

1153
00:37:06,800 --> 00:37:08,720
resolved and then

1154
00:37:08,720 --> 00:37:11,119
include contractors uh i used to be a

1155
00:37:11,119 --> 00:37:13,280
contractor uh kind of treated like

1156
00:37:13,280 --> 00:37:14,800
second class citizens at some companies

1157
00:37:14,800 --> 00:37:15,839
and stuff like that you just want to be

1158
00:37:15,839 --> 00:37:18,320
sure that you bring them along on

1159
00:37:18,320 --> 00:37:20,000
on security and making sure that they're

1160
00:37:20,000 --> 00:37:22,560
following it correctly

1161
00:37:22,560 --> 00:37:24,079
and then some of the other mfa takeaways

1162
00:37:24,079 --> 00:37:25,920
do not set it and forget it go back read

1163
00:37:25,920 --> 00:37:27,839
your logs always read your logs all

1164
00:37:27,839 --> 00:37:29,359
systems

1165
00:37:29,359 --> 00:37:31,119
read logs

1166
00:37:31,119 --> 00:37:32,720
search for the unusual

1167
00:37:32,720 --> 00:37:34,240
figure out what normal is and then find

1168
00:37:34,240 --> 00:37:36,079
out what's not normal investigate the

1169
00:37:36,079 --> 00:37:37,599
logs i'm just going to keep hammering

1170
00:37:37,599 --> 00:37:39,599
that i love logs go out and just read

1171
00:37:39,599 --> 00:37:40,720
them

1172
00:37:40,720 --> 00:37:42,079
some of my future research that i want

1173
00:37:42,079 --> 00:37:42,880
to do

1174
00:37:42,880 --> 00:37:44,079
i haven't done a whole lot on password

1175
00:37:44,079 --> 00:37:45,760
lists but i want to get into that i want

1176
00:37:45,760 --> 00:37:47,359
to do client-based authentication more

1177
00:37:47,359 --> 00:37:49,200
about token duplication

1178
00:37:49,200 --> 00:37:51,040
um i want to take a look and see if

1179
00:37:51,040 --> 00:37:52,720
people are sharing ub keys or tokens and

1180
00:37:52,720 --> 00:37:54,079
stuff between users not something i've

1181
00:37:54,079 --> 00:37:55,680
really gotten into

1182
00:37:55,680 --> 00:37:57,680
and then just to thank thanks to my

1183
00:37:57,680 --> 00:37:59,359
employer for on the job research and

1184
00:37:59,359 --> 00:38:00,640
training the other security

1185
00:38:00,640 --> 00:38:02,079
professionals that shared their stories

1186
00:38:02,079 --> 00:38:03,040
with me

1187
00:38:03,040 --> 00:38:04,560
and i kind of mixed into some of these

1188
00:38:04,560 --> 00:38:06,640
things co-workers for my logging

1189
00:38:06,640 --> 00:38:09,440
obsession and uh

1190
00:38:09,440 --> 00:38:11,520
investigation and stuff and then duo has

1191
00:38:11,520 --> 00:38:13,520
some pretty good documentation if you

1192
00:38:13,520 --> 00:38:15,119
want references i'll leave the slide up

1193
00:38:15,119 --> 00:38:17,599
for a minute and uh that's it if there

1194
00:38:17,599 --> 00:38:20,240
are any questions

1195
00:38:24,850 --> 00:38:26,720
[Applause]

1196
00:38:26,720 --> 00:38:28,800
even better than i expected and that

1197
00:38:28,800 --> 00:38:31,520
that means a lot so really really good

1198
00:38:31,520 --> 00:38:32,880
um

1199
00:38:32,880 --> 00:38:35,440
questions

1200
00:38:39,440 --> 00:38:41,119
uh for hunting through your logs and

1201
00:38:41,119 --> 00:38:43,359
stuff do you use any automated tools is

1202
00:38:43,359 --> 00:38:44,960
it just kind of whatever the vendors

1203
00:38:44,960 --> 00:38:47,920
provided for that or are you did you

1204
00:38:47,920 --> 00:38:50,000
write some scripts or something to flag

1205
00:38:50,000 --> 00:38:52,240
like some of these interesting cases

1206
00:38:52,240 --> 00:38:54,800
that might happen frequently

1207
00:38:54,800 --> 00:38:57,280
yeah so i've written um and set up uh

1208
00:38:57,280 --> 00:38:58,960
like plays like if you have a playbook

1209
00:38:58,960 --> 00:39:01,359
and stuff like writing up a bunch of um

1210
00:39:01,359 --> 00:39:03,599
splunk queries or some queries that will

1211
00:39:03,599 --> 00:39:06,880
go through and find certain things

1212
00:39:11,040 --> 00:39:13,839
ah thanks for a great talk

1213
00:39:13,839 --> 00:39:14,960
when uh

1214
00:39:14,960 --> 00:39:17,040
when the ffa that you have is not for

1215
00:39:17,040 --> 00:39:18,320
the organ

1216
00:39:18,320 --> 00:39:20,079
employees of the organization but of

1217
00:39:20,079 --> 00:39:22,480
your customers like uh financial

1218
00:39:22,480 --> 00:39:24,160
companies and stuff like that do you

1219
00:39:24,160 --> 00:39:26,320
think any of these analysis can be

1220
00:39:26,320 --> 00:39:28,400
applicable to this situation

1221
00:39:28,400 --> 00:39:30,720
yeah i think they could um

1222
00:39:30,720 --> 00:39:33,119
if you were to like have those logs um

1223
00:39:33,119 --> 00:39:34,480
it might be interesting to see if there

1224
00:39:34,480 --> 00:39:36,079
are any customers sharing information if

1225
00:39:36,079 --> 00:39:38,079
you do have

1226
00:39:38,079 --> 00:39:39,920
i would think maybe

1227
00:39:39,920 --> 00:39:42,800
like with a financial uh situation there

1228
00:39:42,800 --> 00:39:44,560
um if there's any sort of fraud going on

1229
00:39:44,560 --> 00:39:46,960
like maybe you have multiple uh like one

1230
00:39:46,960 --> 00:39:48,480
phone on multiple users accounts there

1231
00:39:48,480 --> 00:39:50,000
could be a situation of fraud going on

1232
00:39:50,000 --> 00:39:51,599
there

1233
00:39:51,599 --> 00:39:53,040
with customers

1234
00:39:53,040 --> 00:39:56,200
thank you

1235
00:39:58,320 --> 00:40:00,800
thanks for your talk uh so many of your

1236
00:40:00,800 --> 00:40:02,079
examples

1237
00:40:02,079 --> 00:40:03,280
um

1238
00:40:03,280 --> 00:40:05,760
were that uh showed that

1239
00:40:05,760 --> 00:40:06,640
if

1240
00:40:06,640 --> 00:40:10,240
we weren't using telephone pstn as a

1241
00:40:10,240 --> 00:40:12,640
second factor authenticator these these

1242
00:40:12,640 --> 00:40:14,560
examples just wouldn't exist and they're

1243
00:40:14,560 --> 00:40:16,880
sure there's a cost associated with

1244
00:40:16,880 --> 00:40:18,400
issuing

1245
00:40:18,400 --> 00:40:20,640
a uh an authenticator

1246
00:40:20,640 --> 00:40:23,640
that's

1247
00:40:24,480 --> 00:40:26,319
sure there's an uh

1248
00:40:26,319 --> 00:40:28,000
cost associated with issuing a heart

1249
00:40:28,000 --> 00:40:30,560
authenticator but it seems like your

1250
00:40:30,560 --> 00:40:33,359
time or you know the time of the the it

1251
00:40:33,359 --> 00:40:35,280
people and the risk of loss

1252
00:40:35,280 --> 00:40:36,240
uh

1253
00:40:36,240 --> 00:40:39,440
would largely be subsumed by

1254
00:40:39,440 --> 00:40:41,760
you know would would subsume the cost of

1255
00:40:41,760 --> 00:40:44,079
of those authenticators why can't we get

1256
00:40:44,079 --> 00:40:46,480
away from that

1257
00:40:46,480 --> 00:40:47,760
that

1258
00:40:47,760 --> 00:40:49,839
that is a fantastic question i don't

1259
00:40:49,839 --> 00:40:51,119
know

1260
00:40:51,119 --> 00:40:52,000
like

1261
00:40:52,000 --> 00:40:53,520
why why are the vendors still producing

1262
00:40:53,520 --> 00:40:54,960
those sort of things and i i guess i was

1263
00:40:54,960 --> 00:40:57,599
supposed to ask you who you are as well

1264
00:40:57,599 --> 00:40:59,760
yeah

1265
00:40:59,760 --> 00:41:03,520
jim you need to say who you are

1266
00:41:04,400 --> 00:41:06,480
i am jim fenton i'm i'm uh one of the

1267
00:41:06,480 --> 00:41:09,440
people i'm a contractor i work with nist

1268
00:41:09,440 --> 00:41:10,240
on

1269
00:41:10,240 --> 00:41:13,359
uh user authentication guidelines

1270
00:41:13,359 --> 00:41:15,680
okay cool yeah yes please update the

1271
00:41:15,680 --> 00:41:19,720
guidelines get rid of phones

1272
00:41:22,480 --> 00:41:24,560
jim has talked to pastor scrum before

1273
00:41:24,560 --> 00:41:26,160
and he's one of those with his name on

1274
00:41:26,160 --> 00:41:28,160
the sp 863d

1275
00:41:28,160 --> 00:41:30,319
yeah so uh

1276
00:41:30,319 --> 00:41:32,240
yeah

1277
00:41:32,240 --> 00:41:35,479
more questions

1278
00:41:39,200 --> 00:41:41,040
what kind of training do we give users

1279
00:41:41,040 --> 00:41:42,800
to educate them without getting too

1280
00:41:42,800 --> 00:41:45,280
nitty-gritty or like revealing uh

1281
00:41:45,280 --> 00:41:47,440
security flaws in an existing system how

1282
00:41:47,440 --> 00:41:50,480
do we make that practical

1283
00:41:51,599 --> 00:41:53,599
yeah some of the vendors do have some

1284
00:41:53,599 --> 00:41:55,040
education like when you first roll it

1285
00:41:55,040 --> 00:41:56,880
out and i think they are getting better

1286
00:41:56,880 --> 00:41:58,560
at like education packages that you can

1287
00:41:58,560 --> 00:42:01,200
use to like mail campaigns um and things

1288
00:42:01,200 --> 00:42:03,359
like that um

1289
00:42:03,359 --> 00:42:05,040
probably just being like

1290
00:42:05,040 --> 00:42:06,960
a little bit transparent without making

1291
00:42:06,960 --> 00:42:10,400
them like too curious yeah

1292
00:42:10,400 --> 00:42:12,560
you had several uh examples in here some

1293
00:42:12,560 --> 00:42:15,119
of them crazier than others

1294
00:42:15,119 --> 00:42:17,520
what's the sort of craziest thing you've

1295
00:42:17,520 --> 00:42:20,160
ever found

1296
00:42:20,160 --> 00:42:22,400
war stories from a reality

1297
00:42:22,400 --> 00:42:24,720
yeah some of those were not reality at

1298
00:42:24,720 --> 00:42:26,640
all and then some of them were and i'm

1299
00:42:26,640 --> 00:42:27,920
just going to like leave that up to the

1300
00:42:27,920 --> 00:42:29,839
imagination which was ruined which ones

1301
00:42:29,839 --> 00:42:34,079
weren't uh protect the innocent maybe um

1302
00:42:34,079 --> 00:42:37,200
i i think it's soft time for me to to do

1303
00:42:37,200 --> 00:42:40,160
one of my stories which is for real i've

1304
00:42:40,160 --> 00:42:41,680
told this one i've included this in

1305
00:42:41,680 --> 00:42:43,599
talks before but there might be new

1306
00:42:43,599 --> 00:42:46,160
people here as well and this story is

1307
00:42:46,160 --> 00:42:48,000
something that i did as a pen tesla

1308
00:42:48,000 --> 00:42:49,680
doing password cracking many years ago

1309
00:42:49,680 --> 00:42:52,720
in a galaxy far far away

1310
00:42:52,720 --> 00:42:55,280
and it's also very interesting to see

1311
00:42:55,280 --> 00:42:56,160
how

1312
00:42:56,160 --> 00:42:58,000
social and cultural differences play a

1313
00:42:58,000 --> 00:42:59,520
role when i

1314
00:42:59,520 --> 00:43:01,200
tell a story

1315
00:43:01,200 --> 00:43:03,760
because um

1316
00:43:03,760 --> 00:43:06,800
together with a friend of mine we

1317
00:43:06,800 --> 00:43:08,800
did a penetration test and we cracked

1318
00:43:08,800 --> 00:43:10,720
the passwords of

1319
00:43:10,720 --> 00:43:13,680
a lot of people and there's a vista for

1320
00:43:13,680 --> 00:43:16,640
you here susan

1321
00:43:18,319 --> 00:43:20,960
all right so uh we had a

1322
00:43:20,960 --> 00:43:22,800
really lovely this one yep can you hear

1323
00:43:22,800 --> 00:43:23,839
me

1324
00:43:23,839 --> 00:43:26,000
yeah we had a really lovely uh speaker

1325
00:43:26,000 --> 00:43:27,839
request uh

1326
00:43:27,839 --> 00:43:29,599
for all of the staff

1327
00:43:29,599 --> 00:43:31,839
and volunteers at b-sides to be

1328
00:43:31,839 --> 00:43:34,079
excellent to each other

1329
00:43:34,079 --> 00:43:36,000
so that we could be excellent to all the

1330
00:43:36,000 --> 00:43:37,599
other participants

1331
00:43:37,599 --> 00:43:40,720
so with that in mind i actually it

1332
00:43:40,720 --> 00:43:42,079
really touched us

1333
00:43:42,079 --> 00:43:43,359
we'd like to present you with something

1334
00:43:43,359 --> 00:43:46,000
as a result

1335
00:43:50,400 --> 00:43:53,400
cool

1336
00:44:05,440 --> 00:44:09,319
thank you demon yeah

1337
00:44:13,040 --> 00:44:15,520
so to continue my story we were able to

1338
00:44:15,520 --> 00:44:17,760
crack the passwords of

1339
00:44:17,760 --> 00:44:21,359
approximately 5 000 people

1340
00:44:21,359 --> 00:44:24,800
that easy windows long time ago

1341
00:44:24,800 --> 00:44:27,040
and then we also found a windows

1342
00:44:27,040 --> 00:44:29,119
directory where we found

1343
00:44:29,119 --> 00:44:31,680
pictures of all these people

1344
00:44:31,680 --> 00:44:33,760
like headshots being used for physical

1345
00:44:33,760 --> 00:44:36,240
access cards

1346
00:44:36,240 --> 00:44:38,880
and this wasn't part of our assignment

1347
00:44:38,880 --> 00:44:39,760
but

1348
00:44:39,760 --> 00:44:42,319
we had an evening where we you know

1349
00:44:42,319 --> 00:44:44,480
we were drinking beer and

1350
00:44:44,480 --> 00:44:46,480
i i can't remember today who came up

1351
00:44:46,480 --> 00:44:48,960
with the idea but the idea was pretty

1352
00:44:48,960 --> 00:44:50,720
simple

1353
00:44:50,720 --> 00:44:52,560
do you think men or women have the best

1354
00:44:52,560 --> 00:44:55,119
passwords

1355
00:44:55,359 --> 00:44:58,640
so we had 5 000 pictures

1356
00:44:58,640 --> 00:45:01,280
and we had 5000 passwords

1357
00:45:01,280 --> 00:45:03,040
we put everything into your database and

1358
00:45:03,040 --> 00:45:04,960
then we spent a couple of days

1359
00:45:04,960 --> 00:45:08,720
two guys analyzing pictures

1360
00:45:08,720 --> 00:45:11,680
and we looked at gender which is

1361
00:45:11,680 --> 00:45:13,839
i should say fairly easy to identify

1362
00:45:13,839 --> 00:45:14,800
from

1363
00:45:14,800 --> 00:45:16,240
pictures

1364
00:45:16,240 --> 00:45:18,480
we also identified if the person in the

1365
00:45:18,480 --> 00:45:20,560
picture were using glasses and used that

1366
00:45:20,560 --> 00:45:21,599
as a

1367
00:45:21,599 --> 00:45:23,680
thing we could check for

1368
00:45:23,680 --> 00:45:26,480
we also looked at hair color

1369
00:45:26,480 --> 00:45:29,440
including no hair or gray or brown or

1370
00:45:29,440 --> 00:45:30,560
black

1371
00:45:30,560 --> 00:45:33,839
and also facial hair

1372
00:45:34,160 --> 00:45:36,160
and when we had done that to 5000

1373
00:45:36,160 --> 00:45:37,920
pictures we could do queries into the

1374
00:45:37,920 --> 00:45:40,480
database

1375
00:45:40,480 --> 00:45:43,440
and what did we find

1376
00:45:43,839 --> 00:45:47,280
number one we found that women prefer

1377
00:45:47,280 --> 00:45:49,599
length

1378
00:45:53,520 --> 00:45:55,599
some people doesn't dare laugh and

1379
00:45:55,599 --> 00:45:57,599
mainly it is men laughing there might be

1380
00:45:57,599 --> 00:45:58,839
a few women as

1381
00:45:58,839 --> 00:46:02,319
well but this is about passwords

1382
00:46:02,319 --> 00:46:04,880
so we found that women on average had

1383
00:46:04,880 --> 00:46:08,000
longer passwords than men

1384
00:46:08,000 --> 00:46:10,720
we also found that men

1385
00:46:10,720 --> 00:46:14,640
prefers a wider selection in characters

1386
00:46:14,640 --> 00:46:16,640
they used more different letters from

1387
00:46:16,640 --> 00:46:18,319
the alphabet than special characters and

1388
00:46:18,319 --> 00:46:20,480
so on

1389
00:46:20,480 --> 00:46:22,319
and in norway

1390
00:46:22,319 --> 00:46:24,000
at least in our culture it's the thing

1391
00:46:24,000 --> 00:46:25,040
that

1392
00:46:25,040 --> 00:46:26,800
and i'm sure to say this but blonde

1393
00:46:26,800 --> 00:46:28,800
women are supposed to be just a little

1394
00:46:28,800 --> 00:46:32,720
bit more stupid than everybody else

1395
00:46:32,720 --> 00:46:34,560
but blonde women didn't have the worst

1396
00:46:34,560 --> 00:46:36,720
passwords

1397
00:46:36,720 --> 00:46:40,000
the worst passwords belongs to males

1398
00:46:40,000 --> 00:46:44,079
that goes into the category of unix guru

1399
00:46:44,079 --> 00:46:46,880
and that is a category we had to create

1400
00:46:46,880 --> 00:46:48,880
based on hairstyle

1401
00:46:48,880 --> 00:46:51,760
and beard style so you can imagine the

1402
00:46:51,760 --> 00:46:54,480
rest they had the absolute worst

1403
00:46:54,480 --> 00:46:56,000
passwords

1404
00:46:56,000 --> 00:46:59,119
and now the end of the joke

1405
00:46:59,119 --> 00:47:00,400
the person

1406
00:47:00,400 --> 00:47:02,800
type with the best passwords

1407
00:47:02,800 --> 00:47:05,520
were women with red hair

1408
00:47:05,520 --> 00:47:07,280
and that is something i just cannot

1409
00:47:07,280 --> 00:47:09,359
understand due to my ex-wife being a

1410
00:47:09,359 --> 00:47:11,839
redhead

1411
00:47:12,640 --> 00:47:14,640
and with that

1412
00:47:14,640 --> 00:47:16,640
thank you and our next talk will be at

1413
00:47:16,640 --> 00:47:21,960
three o'clock so be back then thank you

