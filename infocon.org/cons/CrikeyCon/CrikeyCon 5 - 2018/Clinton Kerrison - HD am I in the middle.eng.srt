1
00:00:03,790 --> 00:00:07,240
[Music]

2
00:00:08,930 --> 00:00:12,070
[Applause]

3
00:00:14,469 --> 00:00:17,990
<font color="#E5E5E5">okay</font>

4
00:00:15,620 --> 00:00:22,250
hi I'm Clinton and this is putting<font color="#E5E5E5"> the</font>

5
00:00:17,990 --> 00:00:24,320
<font color="#E5E5E5">man in the middle in HDMI</font><font color="#CCCCCC"> I've been</font>

6
00:00:22,250 --> 00:00:27,080
working in<font color="#E5E5E5"> IT support for the last five</font>

7
00:00:24,320 --> 00:00:29,330
<font color="#CCCCCC">years or</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> inevitably you have it</font>

8
00:00:27,080 --> 00:00:33,800
on the day off<font color="#E5E5E5"> that you get that call</font>

9
00:00:29,330 --> 00:00:36,349
<font color="#CCCCCC">from work and they want</font><font color="#E5E5E5"> to be able to</font>

10
00:00:33,800 --> 00:00:40,578
boot off<font color="#E5E5E5"> a cd-rom</font><font color="#CCCCCC"> reimagine machine</font>

11
00:00:36,350 --> 00:00:42,109
something<font color="#CCCCCC"> of that nature and you have to</font>

12
00:00:40,579 --> 00:00:45,399
explain they've got to get into the BIOS

13
00:00:42,109 --> 00:00:48,440
<font color="#CCCCCC">they've got to</font><font color="#E5E5E5"> change their boot order</font>

14
00:00:45,399 --> 00:00:51,909
this can cause some<font color="#E5E5E5"> confusion</font><font color="#CCCCCC"> especially</font>

15
00:00:48,440 --> 00:00:53,928
when every machine<font color="#CCCCCC"> has a different bias</font>

16
00:00:51,909 --> 00:00:57,079
inevitably that's<font color="#CCCCCC"> the end of</font><font color="#E5E5E5"> your day</font>

17
00:00:53,929 --> 00:00:59,059
off or you're going to<font color="#E5E5E5"> spend an hour and</font>

18
00:00:57,079 --> 00:01:00,889
<font color="#E5E5E5">a half on the phone with them trying to</font>

19
00:00:59,059 --> 00:01:04,548
talk them through changing the settings

20
00:01:00,889 --> 00:01:06,560
<font color="#E5E5E5">and I think we've most of us would have</font>

21
00:01:04,549 --> 00:01:11,689
wished at some point in our careers<font color="#E5E5E5"> I</font>

22
00:01:06,560 --> 00:01:15,229
wish I could remote into the<font color="#CCCCCC"> BIOS so</font>

23
00:01:11,689 --> 00:01:18,408
surely there's a way around<font color="#E5E5E5"> this maybe</font>

24
00:01:15,229 --> 00:01:21,619
something<font color="#E5E5E5"> like this KVM over IP device</font>

25
00:01:18,409 --> 00:01:23,479
<font color="#CCCCCC">would be</font><font color="#E5E5E5"> ideal for</font><font color="#CCCCCC"> work circumstance but</font>

26
00:01:21,619 --> 00:01:26,119
<font color="#E5E5E5">I'm not sure I wanted to fork out over a</font>

27
00:01:23,479 --> 00:01:31,700
thousand<font color="#CCCCCC"> dollars just to save an hour</font>

28
00:01:26,119 --> 00:01:35,920
<font color="#E5E5E5">and that's when I shelved the idea that</font>

29
00:01:31,700 --> 00:01:38,179
was at<font color="#CCCCCC"> least until</font><font color="#E5E5E5"> a couple of years ago</font>

30
00:01:35,920 --> 00:01:42,100
<font color="#E5E5E5">Darren from hack</font><font color="#CCCCCC"> five gave a talk about</font>

31
00:01:38,179 --> 00:01:42,100
<font color="#CCCCCC">his grammar causing the end of the world</font>

32
00:01:42,200 --> 00:01:46,069
I've been following hack<font color="#CCCCCC"> 5 through</font>

33
00:01:43,909 --> 00:01:48,859
projects like<font color="#CCCCCC"> the USB switchblade and</font>

34
00:01:46,069 --> 00:01:51,859
the Wi-Fi pineapple for a while now<font color="#CCCCCC"> and</font>

35
00:01:48,859 --> 00:01:54,740
they all exploit the convenience<font color="#E5E5E5"> and</font>

36
00:01:51,859 --> 00:01:56,419
<font color="#CCCCCC">Trust built into our systems</font><font color="#E5E5E5"> it was this</font>

37
00:01:54,740 --> 00:02:00,740
talk however<font color="#E5E5E5"> that got me thinking</font><font color="#CCCCCC"> about</font>

38
00:01:56,420 --> 00:02:06,350
<font color="#CCCCCC">KVM devices again typically</font><font color="#E5E5E5"> a PC trusts</font>

39
00:02:00,740 --> 00:02:09,318
<font color="#CCCCCC">at HDMI keyboard and mouse devices this</font>

40
00:02:06,350 --> 00:02:11,319
gives us an<font color="#E5E5E5"> opportunity to</font><font color="#CCCCCC"> resolve</font><font color="#E5E5E5"> a few</font>

41
00:02:09,318 --> 00:02:13,079
of the problems<font color="#E5E5E5"> with</font><font color="#CCCCCC"> on premises</font>

42
00:02:11,319 --> 00:02:17,609
<font color="#CCCCCC">Pinterest</font>

43
00:02:13,080 --> 00:02:22,110
<font color="#E5E5E5">pentesting devices they interact with</font>

44
00:02:17,610 --> 00:02:24,540
<font color="#E5E5E5">the Wi-Fi or the</font><font color="#CCCCCC"> Ethernet even if they</font>

45
00:02:22,110 --> 00:02:26,690
operating in a<font color="#E5E5E5"> stealthy mode</font><font color="#CCCCCC"> that only</font>

46
00:02:24,540 --> 00:02:29,840
lets them do passive surveillance

47
00:02:26,690 --> 00:02:32,880
<font color="#CCCCCC">otherwise there is a chance of detection</font>

48
00:02:29,840 --> 00:02:34,950
they don't have credentialed access<font color="#E5E5E5"> in</font>

49
00:02:32,880 --> 00:02:36,870
some<font color="#CCCCCC"> cases this can limit your access to</font>

50
00:02:34,950 --> 00:02:39,989
<font color="#E5E5E5">certain applications or if they've got</font>

51
00:02:36,870 --> 00:02:43,940
<font color="#CCCCCC">802 dot 1 X on the network they can</font>

52
00:02:39,990 --> 00:02:43,940
<font color="#E5E5E5">block them</font><font color="#CCCCCC"> from the network entirely</font>

53
00:02:44,360 --> 00:02:49,800
<font color="#E5E5E5">some of the drop boxes out there do</font>

54
00:02:47,030 --> 00:02:54,770
<font color="#E5E5E5">utilize an out-of-band communication</font>

55
00:02:49,800 --> 00:02:57,840
methods such as<font color="#E5E5E5"> 4G or some other method</font>

56
00:02:54,770 --> 00:03:00,570
<font color="#CCCCCC">but many of the devices</font><font color="#E5E5E5"> out there do</font>

57
00:02:57,840 --> 00:03:02,340
<font color="#E5E5E5">utilize the network under test to</font>

58
00:03:00,570 --> 00:03:06,269
communicate out and that's<font color="#E5E5E5"> another point</font>

59
00:03:02,340 --> 00:03:06,750
of potential detection and common USB

60
00:03:06,270 --> 00:03:09,420
drops

61
00:03:06,750 --> 00:03:11,900
<font color="#CCCCCC">HID attacks and drive-by downloads</font>

62
00:03:09,420 --> 00:03:16,890
result in<font color="#E5E5E5"> software being dropped on the</font>

63
00:03:11,900 --> 00:03:20,040
Machine under<font color="#CCCCCC"> test and viruses can catch</font>

64
00:03:16,890 --> 00:03:24,268
it<font color="#CCCCCC"> or activity can sharpen</font><font color="#E5E5E5"> PowerShell</font>

65
00:03:20,040 --> 00:03:26,070
logs where it can be<font color="#E5E5E5"> detected again so</font>

66
00:03:24,269 --> 00:03:29,160
this is where our requirements start to

67
00:03:26,070 --> 00:03:32,430
take shape<font color="#E5E5E5"> the device needs to be</font>

68
00:03:29,160 --> 00:03:35,579
transparent to<font color="#E5E5E5"> the user ideally we'd</font>

69
00:03:32,430 --> 00:03:38,390
have keyboard and mouse control we<font color="#CCCCCC"> need</font>

70
00:03:35,580 --> 00:03:41,100
<font color="#E5E5E5">out-of-band communication back</font><font color="#CCCCCC"> to us</font><font color="#E5E5E5"> and</font>

71
00:03:38,390 --> 00:03:46,500
it needs<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be small enough to remain</font>

72
00:03:41,100 --> 00:03:49,739
unnoticed or<font color="#CCCCCC"> disguising in some way our</font>

73
00:03:46,500 --> 00:03:52,110
<font color="#CCCCCC">KVM device has some issues here with the</font>

74
00:03:49,739 --> 00:03:56,580
cost this<font color="#E5E5E5"> is a fair bit of investment</font><font color="#CCCCCC"> to</font>

75
00:03:52,110 --> 00:04:00,300
leave lying<font color="#E5E5E5"> around office</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> often</font>

76
00:03:56,580 --> 00:04:01,890
large<font color="#E5E5E5"> even rackmount devices and they</font>

77
00:04:00,300 --> 00:04:05,400
need<font color="#CCCCCC"> additional hardware to become</font>

78
00:04:01,890 --> 00:04:08,850
cellular capable<font color="#E5E5E5"> now this is where I</font>

79
00:04:05,400 --> 00:04:11,720
started<font color="#E5E5E5"> the project in earnest</font><font color="#CCCCCC"> we've got</font>

80
00:04:08,850 --> 00:04:11,720
our target<font color="#E5E5E5"> machine</font>

81
00:04:14,319 --> 00:04:20,019
which will have a HDMI cable to the

82
00:04:17,228 --> 00:04:22,750
monitor which we can join<font color="#E5E5E5"> with the</font>

83
00:04:20,019 --> 00:04:25,449
splitter<font color="#E5E5E5"> the touch up</font><font color="#CCCCCC"> to a</font><font color="#E5E5E5"> capture</font>

84
00:04:22,750 --> 00:04:29,470
device<font color="#E5E5E5"> hook it up to a small form-factor</font>

85
00:04:25,449 --> 00:04:33,759
computer<font color="#E5E5E5"> attach a 3G and face or dongle</font>

86
00:04:29,470 --> 00:04:36,699
for communications and then utilize USB

87
00:04:33,759 --> 00:04:40,710
to control the target<font color="#CCCCCC"> machine and that</font>

88
00:04:36,699 --> 00:04:43,690
would give<font color="#E5E5E5"> us our HD man in the middle</font>

89
00:04:40,710 --> 00:04:47,710
so my first<font color="#E5E5E5"> revision was built around an</font>

90
00:04:43,690 --> 00:04:51,340
atom powered stick PC<font color="#CCCCCC"> a USB capture</font>

91
00:04:47,710 --> 00:04:54,460
dongle I had lying around<font color="#E5E5E5"> various</font>

92
00:04:51,340 --> 00:04:57,008
adapters and cables and an electrical

93
00:04:54,460 --> 00:04:59,500
junction box<font color="#CCCCCC"> now I did actually managed</font>

94
00:04:57,009 --> 00:05:02,590
to get<font color="#E5E5E5"> the lid on that it had a few</font>

95
00:04:59,500 --> 00:05:05,770
<font color="#E5E5E5">flaws it would capture and pass a</font>

96
00:05:02,590 --> 00:05:08,919
monitor signal<font color="#E5E5E5"> but only at</font><font color="#CCCCCC"> the limited</font>

97
00:05:05,770 --> 00:05:12,310
<font color="#CCCCCC">resolution and I</font><font color="#E5E5E5"> exhausted my</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> USB</font>

98
00:05:08,919 --> 00:05:15,669
interface on the device which<font color="#E5E5E5"> limited my</font>

99
00:05:12,310 --> 00:05:18,849
ability to do you USB<font color="#E5E5E5"> control and to</font>

100
00:05:15,669 --> 00:05:22,960
hook up to<font color="#E5E5E5"> a cellular connection and it</font>

101
00:05:18,849 --> 00:05:24,729
<font color="#E5E5E5">was far from small a while later as new</font>

102
00:05:22,960 --> 00:05:27,969
hardware became available<font color="#CCCCCC"> at cheaper</font>

103
00:05:24,729 --> 00:05:32,530
price our tried again<font color="#E5E5E5"> this version was</font>

104
00:05:27,970 --> 00:05:38,760
based<font color="#E5E5E5"> on a Raspberry Pi using a small</font>

105
00:05:32,530 --> 00:05:42,789
<font color="#CCCCCC">Arduino stick PC to do the</font><font color="#E5E5E5"> hid control a</font>

106
00:05:38,760 --> 00:05:45,909
USB to HDMI capture card<font color="#E5E5E5"> however</font><font color="#CCCCCC"> this</font>

107
00:05:42,789 --> 00:05:48,610
<font color="#CCCCCC">particular USB</font><font color="#E5E5E5"> 3 card gave me all sorts</font>

108
00:05:45,909 --> 00:05:54,479
<font color="#E5E5E5">of problems because I only had USB 2 on</font>

109
00:05:48,610 --> 00:05:57,760
the PI so I switched to<font color="#E5E5E5"> this one it did</font>

110
00:05:54,479 --> 00:05:59,650
<font color="#CCCCCC">downsample and crunch the picture but it</font>

111
00:05:57,760 --> 00:06:00,250
was USB 2 and I got a much better

112
00:05:59,650 --> 00:06:04,169
<font color="#CCCCCC">framerate</font>

113
00:06:00,250 --> 00:06:08,080
a basic<font color="#E5E5E5"> 4G dongle</font>

114
00:06:04,169 --> 00:06:10,780
paired<font color="#E5E5E5"> with a HDMI splitter and we get</font>

115
00:06:08,080 --> 00:06:12,240
<font color="#E5E5E5">st. looks kind of suspicious</font><font color="#CCCCCC"> so I put in</font>

116
00:06:10,780 --> 00:06:16,030
a box

117
00:06:12,240 --> 00:06:18,250
and we get something<font color="#CCCCCC"> that you might</font>

118
00:06:16,030 --> 00:06:20,169
reasonably miss if it was hidden behind

119
00:06:18,250 --> 00:06:25,990
your<font color="#E5E5E5"> desk amongst the clutter of</font><font color="#CCCCCC"> other</font>

120
00:06:20,170 --> 00:06:29,680
<font color="#E5E5E5">items so let's do this thing</font>

121
00:06:25,990 --> 00:06:31,780
I have here a Windows<font color="#CCCCCC"> laptop hooked up</font>

122
00:06:29,680 --> 00:06:35,020
to a monitor just with a regular<font color="#E5E5E5"> HDMI</font>

123
00:06:31,780 --> 00:06:37,780
cable what<font color="#E5E5E5"> I do I plug</font><font color="#CCCCCC"> my device up to</font>

124
00:06:35,020 --> 00:06:40,479
power and then hook it between<font color="#E5E5E5"> the HDMI</font>

125
00:06:37,780 --> 00:06:42,960
signal<font color="#CCCCCC"> and up to the usb on the device</font>

126
00:06:40,480 --> 00:06:42,960
<font color="#CCCCCC">to test</font>

127
00:06:43,180 --> 00:06:54,629
[Music]

128
00:06:58,190 --> 00:07:11,120
[Music]

129
00:07:08,080 --> 00:07:13,039
and<font color="#E5E5E5"> they totally didn't bring out my</font>

130
00:07:11,120 --> 00:07:19,040
other USB<font color="#E5E5E5"> extension so hopefully I've</font>

131
00:07:13,040 --> 00:07:21,620
got<font color="#E5E5E5"> a</font><font color="#CCCCCC"> picture there so you can still see</font>

132
00:07:19,040 --> 00:07:24,050
<font color="#E5E5E5">what's going on on the machine through</font>

133
00:07:21,620 --> 00:07:27,040
the monitor<font color="#E5E5E5"> but my device</font><font color="#CCCCCC"> is now in the</font>

134
00:07:24,050 --> 00:07:29,390
<font color="#E5E5E5">middle it'll be connecting</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> 4G</font>

135
00:07:27,040 --> 00:07:44,570
connecting through a<font color="#CCCCCC"> VPN which</font><font color="#E5E5E5"> I can</font>

136
00:07:29,390 --> 00:07:46,789
then<font color="#CCCCCC"> access from here so so we've got</font>

137
00:07:44,570 --> 00:07:53,000
<font color="#E5E5E5">our interface just waiting</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> it to</font>

138
00:07:46,790 --> 00:07:59,360
come up<font color="#E5E5E5"> on the VPN VPN should be</font>

139
00:07:53,000 --> 00:08:05,490
connecting and I'm getting pings from

140
00:07:59,360 --> 00:08:13,240
<font color="#E5E5E5">the device and I'm getting the screen</font>

141
00:08:05,490 --> 00:08:17,600
[Applause]

142
00:08:13,240 --> 00:08:22,340
now from here so we've got<font color="#CCCCCC"> a</font><font color="#E5E5E5"> view</font><font color="#CCCCCC"> of</font>

143
00:08:17,600 --> 00:08:28,160
what's on<font color="#E5E5E5"> screen</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> have some ability to</font>

144
00:08:22,340 --> 00:08:36,228
<font color="#CCCCCC">do keyboard</font><font color="#E5E5E5"> and mouse control hopefully</font>

145
00:08:28,160 --> 00:08:39,130
yep<font color="#E5E5E5"> move the mouse around do things like</font>

146
00:08:36,229 --> 00:08:39,130
control<font color="#CCCCCC"> it deletes</font>

147
00:08:41,970 --> 00:08:51,900
even potentially pop a run<font color="#CCCCCC"> dialogue type</font>

148
00:08:47,340 --> 00:08:57,900
of restart<font color="#CCCCCC"> commands and reboot the</font>

149
00:08:51,900 --> 00:08:59,670
<font color="#CCCCCC">machine now</font><font color="#E5E5E5"> in this particular</font><font color="#CCCCCC"> instance</font>

150
00:08:57,900 --> 00:09:02,939
<font color="#E5E5E5">the laptop I</font><font color="#CCCCCC"> have doesn't give me a</font>

151
00:08:59,670 --> 00:09:04,589
video signal<font color="#E5E5E5"> during</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> BIOS face but</font>

152
00:09:02,940 --> 00:09:08,310
you could imagine<font color="#E5E5E5"> on any workstation</font>

153
00:09:04,590 --> 00:09:12,620
machine<font color="#E5E5E5"> you would get full access to the</font>

154
00:09:08,310 --> 00:09:16,800
<font color="#E5E5E5">BIOS it is just HDMI</font><font color="#CCCCCC"> and USB</font><font color="#E5E5E5"> after all</font>

155
00:09:12,620 --> 00:09:19,940
so I've got your screen your keyboard

156
00:09:16,800 --> 00:09:33,780
and<font color="#E5E5E5"> mouse I'm not on your network</font><font color="#CCCCCC"> and</font>

157
00:09:19,940 --> 00:09:35,520
<font color="#CCCCCC">you can't see me applause so what next</font>

158
00:09:33,780 --> 00:09:37,620
<font color="#CCCCCC">now I've got a</font><font color="#E5E5E5"> list of features which</font>

159
00:09:35,520 --> 00:09:41,640
could be<font color="#CCCCCC"> implemented to them improve</font><font color="#E5E5E5"> the</font>

160
00:09:37,620 --> 00:09:45,120
capability<font color="#CCCCCC"> of the device use a more</font>

161
00:09:41,640 --> 00:09:46,740
powerful computer so I<font color="#E5E5E5"> can run USB 3 get</font>

162
00:09:45,120 --> 00:09:49,590
a better<font color="#E5E5E5"> resolution and a better</font>

163
00:09:46,740 --> 00:09:52,620
<font color="#CCCCCC">framerate the web app could</font><font color="#E5E5E5"> be improved</font>

164
00:09:49,590 --> 00:09:57,420
<font color="#CCCCCC">or</font><font color="#E5E5E5"> I could potentially implement a VNC</font>

165
00:09:52,620 --> 00:09:59,400
interface for the device the device

166
00:09:57,420 --> 00:10:04,410
<font color="#E5E5E5">could possibly should be shrunk with the</font>

167
00:09:59,400 --> 00:10:06,209
use of some custom hardware<font color="#CCCCCC"> the keyboard</font>

168
00:10:04,410 --> 00:10:08,400
mouse from the host machine<font color="#E5E5E5"> could be</font>

169
00:10:06,210 --> 00:10:12,350
routed<font color="#CCCCCC"> through my</font><font color="#E5E5E5"> device giving you</font>

170
00:10:08,400 --> 00:10:15,689
<font color="#CCCCCC">Hardware</font><font color="#E5E5E5"> keylogging associated with that</font>

171
00:10:12,350 --> 00:10:17,520
<font color="#E5E5E5">image from the screen so not only seeing</font>

172
00:10:15,690 --> 00:10:19,470
<font color="#CCCCCC">the keyboard</font><font color="#E5E5E5"> and mouse commands you've</font>

173
00:10:17,520 --> 00:10:24,630
actually got a<font color="#E5E5E5"> visual context for those</font>

174
00:10:19,470 --> 00:10:28,620
and a<font color="#E5E5E5"> lot of other things besides that's</font>

175
00:10:24,630 --> 00:10:31,140
the talk I mentioned this is me<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font>

176
00:10:28,620 --> 00:10:33,089
<font color="#E5E5E5">is the HD man in the middle and</font>

177
00:10:31,140 --> 00:10:33,410
unfortunately<font color="#E5E5E5"> we're out of</font><font color="#CCCCCC"> time so</font><font color="#E5E5E5"> I'll</font>

178
00:10:33,089 --> 00:10:35,180
leave

179
00:10:33,410 --> 00:10:36,120
the questions

180
00:10:35,180 --> 00:10:39,209
[Applause]

181
00:10:36,120 --> 00:10:39,210
[Music]

182
00:10:41,350 --> 00:10:43,410
<font color="#E5E5E5">you</font>

183
00:10:44,750 --> 00:10:47,860
[Applause]

