1
00:00:03,790 --> 00:00:07,240
[Music]

2
00:00:08,930 --> 00:00:12,070
[Applause]

3
00:00:12,500 --> 00:00:17,970
<font color="#E5E5E5">today I'm going to talk</font><font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to</font>

4
00:00:15,420 --> 00:00:19,860
<font color="#E5E5E5">unwrap your network or more specifically</font>

5
00:00:17,970 --> 00:00:24,150
I'm<font color="#CCCCCC"> going to talk about BGP injection</font>

6
00:00:19,860 --> 00:00:28,920
route injection so yeah<font color="#E5E5E5"> hopefully</font><font color="#CCCCCC"> you</font>

7
00:00:24,150 --> 00:00:30,060
<font color="#CCCCCC">guys will</font><font color="#E5E5E5"> all enjoy it so here's a</font>

8
00:00:28,920 --> 00:00:32,219
<font color="#E5E5E5">little bit of an outline so</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> just</font>

9
00:00:30,060 --> 00:00:34,379
<font color="#E5E5E5">going to start off with</font><font color="#CCCCCC"> an intro to BGP</font>

10
00:00:32,219 --> 00:00:36,600
just so like everyone's on the same<font color="#CCCCCC"> page</font>

11
00:00:34,379 --> 00:00:38,670
when<font color="#CCCCCC"> I start doing</font><font color="#E5E5E5"> some of the demos</font>

12
00:00:36,600 --> 00:00:41,129
<font color="#E5E5E5">this is the first time I'm going to do</font>

13
00:00:38,670 --> 00:00:42,899
live demos in a presentation<font color="#CCCCCC"> so bear</font>

14
00:00:41,129 --> 00:00:44,909
with me<font color="#E5E5E5"> I'm super nervous I'll probably</font>

15
00:00:42,899 --> 00:00:47,670
be shaking and making typos the whole

16
00:00:44,909 --> 00:00:50,219
time<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to demo black hauling</font>

17
00:00:47,670 --> 00:00:52,010
and spoofing for a bit of<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> and then</font>

18
00:00:50,219 --> 00:00:53,969
I'll go just quickly over some

19
00:00:52,010 --> 00:00:57,748
mitigations of how to stop route

20
00:00:53,969 --> 00:01:00,030
injection in BGP so so why am<font color="#E5E5E5"> I going to</font>

21
00:00:57,749 --> 00:01:05,670
<font color="#E5E5E5">talk about this and besides</font><font color="#CCCCCC"> it it's</font>

22
00:01:00,030 --> 00:01:07,920
heaps of fun to do<font color="#CCCCCC"> so back</font><font color="#E5E5E5"> in 2008 if</font>

23
00:01:05,670 --> 00:01:09,600
anyone remembers Pakistan not<font color="#E5E5E5"> YouTube</font>

24
00:01:07,920 --> 00:01:12,420
<font color="#E5E5E5">offline see that I think</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> was an</font>

25
00:01:09,600 --> 00:01:16,740
accidental<font color="#E5E5E5"> round injection which black</font>

26
00:01:12,420 --> 00:01:19,920
hold<font color="#CCCCCC"> YouTube then we had a bit later</font><font color="#E5E5E5"> in</font>

27
00:01:16,740 --> 00:01:22,520
2010 China swallowed 15% of the<font color="#CCCCCC"> Internet</font>

28
00:01:19,920 --> 00:01:26,970
traffic<font color="#CCCCCC"> I'm specifically</font><font color="#E5E5E5"> I think they</font>

29
00:01:22,520 --> 00:01:29,039
they swallowed<font color="#E5E5E5"> NASA and and sort of more</font>

30
00:01:26,970 --> 00:01:30,990
important things like<font color="#E5E5E5"> that and we</font>

31
00:01:29,040 --> 00:01:34,230
<font color="#CCCCCC">thought maybe this had been fixed</font><font color="#E5E5E5"> but</font>

32
00:01:30,990 --> 00:01:36,630
lucky for<font color="#E5E5E5"> me just</font><font color="#CCCCCC"> December past we had</font>

33
00:01:34,230 --> 00:01:39,180
Russia do something<font color="#E5E5E5"> similar</font>

34
00:01:36,630 --> 00:01:41,460
routing Google Facebook<font color="#E5E5E5"> and Microsoft</font>

35
00:01:39,180 --> 00:01:43,650
through Russia so it's actually<font color="#E5E5E5"> still</font>

36
00:01:41,460 --> 00:01:46,440
still relevant<font color="#E5E5E5"> it's it's something</font>

37
00:01:43,650 --> 00:01:50,190
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> hard to mitigate against</font>

38
00:01:46,440 --> 00:01:55,500
but it's good<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> it again so</font>

39
00:01:50,190 --> 00:01:57,179
Who am<font color="#E5E5E5"> I</font><font color="#CCCCCC"> Sileo</font><font color="#E5E5E5"> my my co-organizer of</font>

40
00:01:55,500 --> 00:01:59,160
b-sides said this was too busy<font color="#E5E5E5"> this</font>

41
00:01:57,180 --> 00:02:03,990
slide I'm like well it represents<font color="#CCCCCC"> life</font>

42
00:01:59,160 --> 00:02:07,140
hey<font color="#CCCCCC"> say so in Canberra I'm a tech lead</font>

43
00:02:03,990 --> 00:02:09,408
of a security<font color="#E5E5E5"> engineering team</font><font color="#CCCCCC"> I'm also</font>

44
00:02:07,140 --> 00:02:13,319
a part-time lecturer<font color="#E5E5E5"> at UNSW Canberra</font>

45
00:02:09,408 --> 00:02:17,310
<font color="#E5E5E5">teaching network security operations</font>

46
00:02:13,319 --> 00:02:19,589
and a few other<font color="#E5E5E5"> courses</font><font color="#CCCCCC"> an unpaid role</font>

47
00:02:17,310 --> 00:02:21,420
so volunteer in my<font color="#E5E5E5"> spare time with</font>

48
00:02:19,590 --> 00:02:25,859
<font color="#CCCCCC">Silvio as I mentioned we do besides</font>

49
00:02:21,420 --> 00:02:28,708
Canberra in Canberra<font color="#E5E5E5"> obviously which is</font>

50
00:02:25,859 --> 00:02:32,280
in April<font color="#CCCCCC"> so come</font><font color="#E5E5E5"> along to that if you</font>

51
00:02:28,709 --> 00:02:34,739
guys have time<font color="#E5E5E5"> with Silvio as well we</font>

52
00:02:32,280 --> 00:02:37,049
run<font color="#CCCCCC"> info</font><font color="#E5E5E5"> sect which is a hackerspace</font><font color="#CCCCCC"> in</font>

53
00:02:34,739 --> 00:02:39,900
<font color="#E5E5E5">Canberra that does and free events</font>

54
00:02:37,049 --> 00:02:42,900
I'm also the<font color="#E5E5E5"> CFO</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> hackers helping</font>

55
00:02:39,900 --> 00:02:44,430
hackers<font color="#E5E5E5"> so I think we have about 15</font>

56
00:02:42,900 --> 00:02:47,040
people<font color="#E5E5E5"> here today from</font><font color="#CCCCCC"> hackers helping</font>

57
00:02:44,430 --> 00:02:49,530
hackers really I just<font color="#E5E5E5"> watched the books</font>

58
00:02:47,040 --> 00:02:51,780
<font color="#CCCCCC">I don't actually do much for hackers</font>

59
00:02:49,530 --> 00:02:53,609
helping hackers but<font color="#E5E5E5"> they're out at the</font>

60
00:02:51,780 --> 00:02:55,290
<font color="#CCCCCC">table outside</font><font color="#E5E5E5"> to go talk</font><font color="#CCCCCC"> to them they're</font>

61
00:02:53,609 --> 00:02:59,340
doing<font color="#E5E5E5"> a</font><font color="#CCCCCC"> really good job</font><font color="#E5E5E5"> helping people</font>

62
00:02:55,290 --> 00:03:02,879
get<font color="#E5E5E5"> into computer security</font><font color="#CCCCCC"> so I have an</font>

63
00:02:59,340 --> 00:03:05,669
engineering<font color="#E5E5E5"> bachelor's with a special</font>

64
00:03:02,879 --> 00:03:07,319
specializing in DSP and digital systems

65
00:03:05,669 --> 00:03:10,439
I have<font color="#CCCCCC"> a master's in computer networking</font>

66
00:03:07,319 --> 00:03:14,578
<font color="#CCCCCC">done too many Cisco certs</font><font color="#E5E5E5"> some six</font>

67
00:03:10,439 --> 00:03:16,828
security certs but you know so

68
00:03:14,579 --> 00:03:19,500
specifically I had to put my route exam

69
00:03:16,829 --> 00:03:24,959
and my<font color="#CCCCCC"> BGP exam</font><font color="#E5E5E5"> even though I did it</font>

70
00:03:19,500 --> 00:03:28,919
<font color="#E5E5E5">like how long ago 2010</font><font color="#CCCCCC"> eight years ago</font>

71
00:03:24,959 --> 00:03:31,650
<font color="#E5E5E5">so maybe I'm out</font><font color="#CCCCCC"> of date so what is</font><font color="#E5E5E5"> BGP</font>

72
00:03:28,919 --> 00:03:34,290
it's a standards-based protocol it's

73
00:03:31,650 --> 00:03:37,049
used for<font color="#E5E5E5"> the Internet backbone so I've</font>

74
00:03:34,290 --> 00:03:38,668
<font color="#E5E5E5">given this</font><font color="#CCCCCC"> talk to my class at uni to</font>

75
00:03:37,049 --> 00:03:41,549
practice and they said you didn't tell

76
00:03:38,669 --> 00:03:44,909
us<font color="#CCCCCC"> more what BGP is so pretty much BGP</font>

77
00:03:41,549 --> 00:03:47,400
is is what runs the<font color="#CCCCCC"> internet so all the</font>

78
00:03:44,909 --> 00:03:49,198
ISPs<font color="#E5E5E5"> are running BGP they share their</font>

79
00:03:47,400 --> 00:03:52,829
routes and and this<font color="#E5E5E5"> is how things travel</font>

80
00:03:49,199 --> 00:03:54,900
across the<font color="#CCCCCC"> internet more</font><font color="#E5E5E5"> features of</font><font color="#CCCCCC"> it</font>

81
00:03:52,829 --> 00:03:57,269
it's a class was protocol so<font color="#CCCCCC"> it supports</font>

82
00:03:54,900 --> 00:04:00,030
variable length subnet masking and

83
00:03:57,269 --> 00:04:02,609
summarization<font color="#E5E5E5"> it's highly scalable as</font>

84
00:04:00,030 --> 00:04:05,340
you would expect<font color="#E5E5E5"> hundreds of thousands</font>

85
00:04:02,609 --> 00:04:08,359
of routes<font color="#E5E5E5"> currently the BGP table and</font>

86
00:04:05,340 --> 00:04:12,719
<font color="#E5E5E5">this is like from about a week ago is</font>

87
00:04:08,359 --> 00:04:15,719
<font color="#CCCCCC">700,000</font><font color="#E5E5E5"> I P</font><font color="#CCCCCC"> v4 routes</font><font color="#E5E5E5"> and 50,000 ipv6</font>

88
00:04:12,719 --> 00:04:18,209
routes so it's really it's highly stable

89
00:04:15,719 --> 00:04:22,409
as you<font color="#CCCCCC"> as you</font><font color="#E5E5E5"> would</font><font color="#CCCCCC"> expect</font><font color="#E5E5E5"> it does</font>

90
00:04:18,209 --> 00:04:25,289
routing while making<font color="#E5E5E5"> decisions it routes</font>

91
00:04:22,409 --> 00:04:27,110
by<font color="#E5E5E5"> enforcing routing policy so as</font>

92
00:04:25,289 --> 00:04:29,180
opposed to<font color="#CCCCCC"> IG P which is</font><font color="#E5E5E5"> in</font>

93
00:04:27,110 --> 00:04:30,710
interior gateway protocol<font color="#CCCCCC"> bgp will use</font>

94
00:04:29,180 --> 00:04:32,870
route attributes to decide where to

95
00:04:30,710 --> 00:04:35,388
<font color="#E5E5E5">route the traffic</font>

96
00:04:32,870 --> 00:04:37,129
it doesn't use its<font color="#E5E5E5"> own transport like</font>

97
00:04:35,389 --> 00:04:40,129
other routing protocols do it<font color="#E5E5E5"> actually</font>

98
00:04:37,129 --> 00:04:42,530
uses<font color="#E5E5E5"> unicast TCP at port 179 so it's</font>

99
00:04:40,129 --> 00:04:47,539
just a TCP connection<font color="#CCCCCC"> to to</font><font color="#E5E5E5"> share routes</font>

100
00:04:42,530 --> 00:04:49,729
<font color="#E5E5E5">between routers</font><font color="#CCCCCC"> BGP peers are not</font>

101
00:04:47,539 --> 00:04:53,020
discovered<font color="#CCCCCC"> there manually configured</font><font color="#E5E5E5"> so</font>

102
00:04:49,729 --> 00:04:55,520
there's that peering relationship<font color="#CCCCCC"> setup</font>

103
00:04:53,020 --> 00:04:57,409
they don't have to be directly<font color="#E5E5E5"> connected</font>

104
00:04:55,520 --> 00:05:00,590
<font color="#E5E5E5">it's logical</font><font color="#CCCCCC"> peering so as</font><font color="#E5E5E5"> long as you</font>

105
00:04:57,409 --> 00:05:03,889
have a<font color="#E5E5E5"> connection via TCP between the</font>

106
00:05:00,590 --> 00:05:06,289
two routers<font color="#CCCCCC"> you can you can share routes</font>

107
00:05:03,889 --> 00:05:07,729
<font color="#E5E5E5">which implies BGP will need an</font><font color="#CCCCCC"> IG P</font><font color="#E5E5E5"> or</font>

108
00:05:06,289 --> 00:05:10,639
something else underneath to know the

109
00:05:07,729 --> 00:05:12,590
routes between<font color="#E5E5E5"> each other so there are</font>

110
00:05:10,639 --> 00:05:16,069
two types<font color="#E5E5E5"> of</font><font color="#CCCCCC"> bgp neighbors there are</font>

111
00:05:12,590 --> 00:05:17,810
external<font color="#CCCCCC"> and internal neighbors BGP has</font>

112
00:05:16,069 --> 00:05:22,580
control plane security and it's

113
00:05:17,810 --> 00:05:26,270
<font color="#E5E5E5">extensible so at the heart of BGP is the</font>

114
00:05:22,580 --> 00:05:27,830
autonomous system not system number<font color="#E5E5E5"> so</font>

115
00:05:26,270 --> 00:05:31,460
originally this was<font color="#E5E5E5"> a two byte field</font>

116
00:05:27,830 --> 00:05:33,529
which is value<font color="#E5E5E5"> zero</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> six</font><font color="#CCCCCC"> five</font><font color="#E5E5E5"> five</font>

117
00:05:31,460 --> 00:05:36,469
<font color="#CCCCCC">thirty</font><font color="#E5E5E5"> five and there's actually some</font>

118
00:05:33,529 --> 00:05:40,669
<font color="#E5E5E5">private a s ends in there as well which</font>

119
00:05:36,469 --> 00:05:44,240
is<font color="#E5E5E5"> defined by RFC six nine</font><font color="#CCCCCC"> ninety six</font><font color="#E5E5E5"> um</font>

120
00:05:40,669 --> 00:05:46,310
but then RFC<font color="#E5E5E5"> four</font><font color="#CCCCCC"> 893 defined a 4-byte</font>

121
00:05:44,240 --> 00:05:48,949
asn<font color="#E5E5E5"> because like with all good things on</font>

122
00:05:46,310 --> 00:05:50,719
<font color="#CCCCCC">the</font><font color="#E5E5E5"> internet we started running out it</font>

123
00:05:48,949 --> 00:05:54,139
started off with<font color="#E5E5E5"> this a s dot notation</font>

124
00:05:50,719 --> 00:05:58,580
but these days<font color="#E5E5E5"> pretty much is</font><font color="#CCCCCC"> just a</font>

125
00:05:54,139 --> 00:06:00,379
4-byte asn<font color="#E5E5E5"> so for backward</font><font color="#CCCCCC"> compatibility</font>

126
00:05:58,580 --> 00:06:04,219
there<font color="#E5E5E5"> was they</font><font color="#CCCCCC"> just popped a zero in</font>

127
00:06:00,379 --> 00:06:05,779
<font color="#E5E5E5">front of the older a essence so as</font><font color="#CCCCCC"> I</font>

128
00:06:04,219 --> 00:06:09,439
<font color="#E5E5E5">said before there's two peering</font><font color="#CCCCCC"> types</font>

129
00:06:05,779 --> 00:06:11,029
says ebgp and<font color="#CCCCCC"> I bgp today in my demos</font>

130
00:06:09,439 --> 00:06:12,620
I'm going to specifically<font color="#E5E5E5"> look at ebgp</font>

131
00:06:11,029 --> 00:06:13,310
because this is what is being<font color="#CCCCCC"> used on</font>

132
00:06:12,620 --> 00:06:17,180
<font color="#CCCCCC">the</font><font color="#E5E5E5"> Internet</font>

133
00:06:13,310 --> 00:06:19,599
so the difference is a BGP is<font color="#E5E5E5"> peering</font>

134
00:06:17,180 --> 00:06:21,770
between<font color="#E5E5E5"> different</font><font color="#CCCCCC"> aliases so external</font>

135
00:06:19,599 --> 00:06:25,159
guesses

136
00:06:21,770 --> 00:06:27,620
by default the TTL for a BGP is 1 so you

137
00:06:25,159 --> 00:06:29,389
if you're at a<font color="#E5E5E5"> longer</font><font color="#CCCCCC"> distance someone</font>

138
00:06:27,620 --> 00:06:34,610
<font color="#E5E5E5">you have to</font><font color="#CCCCCC"> set that multi-hop parameter</font>

139
00:06:29,389 --> 00:06:37,459
and the way ebgp works is it uses<font color="#E5E5E5"> the a</font>

140
00:06:34,610 --> 00:06:39,310
<font color="#E5E5E5">s path attribute for loop prevention so</font>

141
00:06:37,459 --> 00:06:42,250
if you receive<font color="#CCCCCC"> a route there has your</font>

142
00:06:39,310 --> 00:06:46,090
<font color="#E5E5E5">ASN in it you don't</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> don't keep that</font>

143
00:06:42,250 --> 00:06:47,920
route<font color="#CCCCCC"> so I bgp I'll talk about</font><font color="#E5E5E5"> briefly</font>

144
00:06:46,090 --> 00:06:49,060
<font color="#CCCCCC">although this will</font><font color="#E5E5E5"> be the only point I</font>

145
00:06:47,920 --> 00:06:52,480
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about it because then we move on to</font>

146
00:06:49,060 --> 00:06:54,400
ebgp<font color="#CCCCCC"> IBG</font><font color="#E5E5E5"> appears when we peer within the</font>

147
00:06:52,480 --> 00:06:57,820
same<font color="#E5E5E5"> a s so using it internal to our</font>

148
00:06:54,400 --> 00:07:02,080
<font color="#E5E5E5">network</font><font color="#CCCCCC"> again many</font><font color="#E5E5E5"> times not directly</font>

149
00:06:57,820 --> 00:07:06,430
connected<font color="#E5E5E5"> and the way i</font><font color="#CCCCCC"> bgp stop salute</font>

150
00:07:02,080 --> 00:07:09,219
prevention is by suppressing<font color="#E5E5E5"> routes so</font>

151
00:07:06,430 --> 00:07:12,220
an<font color="#CCCCCC"> i BGP appear won't pass on routes</font>

152
00:07:09,220 --> 00:07:13,900
that's weren't from<font color="#E5E5E5"> another peer so it</font>

153
00:07:12,220 --> 00:07:15,250
needs this full mesh in the<font color="#CCCCCC"> networks</font><font color="#E5E5E5"> you</font>

154
00:07:13,900 --> 00:07:17,530
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> peer</font><font color="#E5E5E5"> with every other router in</font>

155
00:07:15,250 --> 00:07:20,550
<font color="#CCCCCC">your network</font><font color="#E5E5E5"> and this can be fixed by</font>

156
00:07:17,530 --> 00:07:23,020
using route reflectors and

157
00:07:20,550 --> 00:07:25,600
Confederations so splitting your<font color="#E5E5E5"> AAS</font>

158
00:07:23,020 --> 00:07:27,130
into smaller asses<font color="#E5E5E5"> this is this us get</font>

159
00:07:25,600 --> 00:07:30,820
<font color="#E5E5E5">more complicated and it's beyond what</font>

160
00:07:27,130 --> 00:07:33,250
we're going to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about today</font><font color="#E5E5E5"> so a</font>

161
00:07:30,820 --> 00:07:35,170
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of looking at the bgp</font>

162
00:07:33,250 --> 00:07:37,690
messages so there's four main messages

163
00:07:35,170 --> 00:07:39,970
that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> BGP users to start a session</font>

164
00:07:37,690 --> 00:07:41,350
and start<font color="#E5E5E5"> exchanging routes so there's</font>

165
00:07:39,970 --> 00:07:42,700
the open message<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is pretty</font><font color="#E5E5E5"> much</font>

166
00:07:41,350 --> 00:07:45,550
<font color="#E5E5E5">just</font><font color="#CCCCCC"> setting up that peering</font>

167
00:07:42,700 --> 00:07:47,050
relationship<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> the keeper live message</font>

168
00:07:45,550 --> 00:07:49,600
which<font color="#E5E5E5"> it regularly sends to make sure</font>

169
00:07:47,050 --> 00:07:51,610
its peers still there there's the update

170
00:07:49,600 --> 00:07:54,910
message which will<font color="#E5E5E5"> advertise or withdraw</font>

171
00:07:51,610 --> 00:07:56,980
a prefix<font color="#E5E5E5"> from its peer and then the</font>

172
00:07:54,910 --> 00:07:58,750
notification message is used to convey

173
00:07:56,980 --> 00:08:03,520
an error has happened and will close

174
00:07:58,750 --> 00:08:05,140
that peering session and so<font color="#E5E5E5"> a little bit</font>

175
00:08:03,520 --> 00:08:07,870
<font color="#E5E5E5">of look at the attributes or they were</font>

176
00:08:05,140 --> 00:08:09,460
going to mainly<font color="#E5E5E5"> focus on one today</font><font color="#CCCCCC"> the</font>

177
00:08:07,870 --> 00:08:11,940
<font color="#E5E5E5">weight attribute is</font><font color="#CCCCCC"> Cisco</font><font color="#E5E5E5"> proprietary</font>

178
00:08:09,460 --> 00:08:15,039
and locally significant so<font color="#CCCCCC"> there's only</font>

179
00:08:11,940 --> 00:08:16,210
significant<font color="#E5E5E5"> local to that that router we</font>

180
00:08:15,040 --> 00:08:18,640
probably won't<font color="#E5E5E5"> look too much of that</font>

181
00:08:16,210 --> 00:08:21,820
<font color="#E5E5E5">today local preference is discretionary</font>

182
00:08:18,640 --> 00:08:24,400
<font color="#CCCCCC">and more used for ibgp</font><font color="#E5E5E5"> and I won't touch</font>

183
00:08:21,820 --> 00:08:27,490
<font color="#E5E5E5">on that today and med is optional a non</font>

184
00:08:24,400 --> 00:08:31,060
transitive transitive meaning it's not

185
00:08:27,490 --> 00:08:32,049
<font color="#E5E5E5">passed on through the</font><font color="#CCCCCC"> Pyrrhic peers but</font>

186
00:08:31,060 --> 00:08:34,270
what we'll look at today<font color="#CCCCCC"> is the</font>

187
00:08:32,049 --> 00:08:36,270
<font color="#CCCCCC">well-known mandatory ones</font><font color="#E5E5E5"> so these ones</font>

188
00:08:34,270 --> 00:08:39,280
will always<font color="#E5E5E5"> be in your update messages</font>

189
00:08:36,270 --> 00:08:42,429
<font color="#E5E5E5">and more specifically a s path is the</font>

190
00:08:39,280 --> 00:08:45,280
one<font color="#E5E5E5"> that will be most effective in</font>

191
00:08:42,429 --> 00:08:46,959
affecting our routes<font color="#E5E5E5"> so pretty much the</font>

192
00:08:45,280 --> 00:08:49,270
routers will go top to<font color="#CCCCCC"> bottom down</font><font color="#E5E5E5"> these</font>

193
00:08:46,960 --> 00:08:50,810
attributes until it finds the<font color="#E5E5E5"> best route</font>

194
00:08:49,270 --> 00:08:55,760
and then it will put it in in the<font color="#CCCCCC"> route</font>

195
00:08:50,810 --> 00:08:57,910
table<font color="#E5E5E5"> yeah so as I said the best path</font>

196
00:08:55,760 --> 00:09:02,600
<font color="#E5E5E5">selection will go down those attributes</font>

197
00:08:57,910 --> 00:09:05,750
<font color="#CCCCCC">until until</font><font color="#E5E5E5"> the router elects the best</font>

198
00:09:02,600 --> 00:09:07,339
route for<font color="#CCCCCC"> each</font><font color="#E5E5E5"> prefix so only the best</font>

199
00:09:05,750 --> 00:09:10,700
route will<font color="#CCCCCC"> be sent to the</font><font color="#E5E5E5"> routing table</font>

200
00:09:07,339 --> 00:09:13,700
from the<font color="#E5E5E5"> BGP table and only that route</font>

201
00:09:10,700 --> 00:09:15,950
will be advertised to<font color="#E5E5E5"> other peers</font><font color="#CCCCCC"> and as</font>

202
00:09:13,700 --> 00:09:17,630
I said<font color="#E5E5E5"> the algorithm runs from top to</font>

203
00:09:15,950 --> 00:09:20,029
bottom<font color="#E5E5E5"> so</font><font color="#CCCCCC"> a s path will be</font><font color="#E5E5E5"> the one we're</font>

204
00:09:17,630 --> 00:09:22,310
looking<font color="#E5E5E5"> at most so here's the scenario</font>

205
00:09:20,029 --> 00:09:25,430
<font color="#E5E5E5">so this is what I'll</font><font color="#CCCCCC"> be doing for the</font>

206
00:09:22,310 --> 00:09:27,619
live demo I've built so what I've done

207
00:09:25,430 --> 00:09:30,170
is<font color="#CCCCCC"> I've used</font><font color="#E5E5E5"> Cisco's viral which is like</font>

208
00:09:27,620 --> 00:09:34,820
the consumer<font color="#CCCCCC"> crl if anyone's familiar</font>

209
00:09:30,170 --> 00:09:38,469
with<font color="#CCCCCC"> Cisco tools and this just runs</font>

210
00:09:34,820 --> 00:09:41,779
<font color="#CCCCCC">multiple VMs in</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> open stack</font>

211
00:09:38,470 --> 00:09:45,020
configuration using iOS images<font color="#E5E5E5"> so</font>

212
00:09:41,779 --> 00:09:47,750
they're all<font color="#E5E5E5"> VMs</font><font color="#CCCCCC"> I upgraded my laptop to</font>

213
00:09:45,020 --> 00:09:50,360
be able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do this demo</font><font color="#CCCCCC"> but I wanted to</font>

214
00:09:47,750 --> 00:09:53,570
anyway<font color="#E5E5E5"> so what I've done here</font><font color="#CCCCCC"> is that</font>

215
00:09:50,360 --> 00:09:56,839
each router<font color="#E5E5E5"> is has been placed into its</font>

216
00:09:53,570 --> 00:09:59,810
own<font color="#CCCCCC"> a/s</font><font color="#E5E5E5"> I've just used the first</font><font color="#CCCCCC"> six</font><font color="#E5E5E5"> a</font>

217
00:09:56,839 --> 00:10:02,270
<font color="#CCCCCC">SS because it's</font><font color="#E5E5E5"> just a demo and I've</font>

218
00:09:59,810 --> 00:10:07,270
just<font color="#E5E5E5"> put the IPS relevant to the a</font><font color="#CCCCCC"> SS</font><font color="#E5E5E5"> so</font>

219
00:10:02,270 --> 00:10:13,970
s1 has<font color="#E5E5E5"> 1 1 1 s2 has 2</font><font color="#CCCCCC"> to 2a s3 has 3 3 3</font>

220
00:10:07,270 --> 00:10:15,380
<font color="#E5E5E5">then I've</font><font color="#CCCCCC"> got 4 5 & 6</font><font color="#E5E5E5"> &</font><font color="#CCCCCC"> a s 1 2 & 3 are</font>

221
00:10:13,970 --> 00:10:17,720
<font color="#E5E5E5">fully meshed which is why I put that</font>

222
00:10:15,380 --> 00:10:21,500
<font color="#E5E5E5">switch in there so s1 is pairing with</font>

223
00:10:17,720 --> 00:10:23,750
both 2 & 3<font color="#E5E5E5"> 3 is 2 & 1 &</font><font color="#CCCCCC"> 2 is 1</font><font color="#E5E5E5"> & 3</font>

224
00:10:21,500 --> 00:10:28,580
<font color="#E5E5E5">whereas the other ones are</font><font color="#CCCCCC"> just peering</font>

225
00:10:23,750 --> 00:10:30,080
with<font color="#E5E5E5"> their adjacent</font><font color="#CCCCCC"> routers um so the</font>

226
00:10:28,580 --> 00:10:32,890
<font color="#E5E5E5">first demo I'm going</font><font color="#CCCCCC"> to do is our black</font>

227
00:10:30,080 --> 00:10:32,890
<font color="#CCCCCC">holing traffic</font>

228
00:10:32,990 --> 00:10:37,850
so I'm<font color="#E5E5E5"> going to look at</font><font color="#CCCCCC"> traffic going</font>

229
00:10:34,730 --> 00:10:39,890
<font color="#E5E5E5">from</font><font color="#CCCCCC"> s2 to s3</font><font color="#E5E5E5"> which should be a direct</font>

230
00:10:37,850 --> 00:10:42,470
hop because they're fully meshed<font color="#E5E5E5"> I'm</font>

231
00:10:39,890 --> 00:10:46,280
going to<font color="#E5E5E5"> blackhole it through to s1 so</font>

232
00:10:42,470 --> 00:10:48,950
s1 is the bad guy being being<font color="#E5E5E5"> read and</font>

233
00:10:46,280 --> 00:10:50,959
then I'm<font color="#E5E5E5"> gonna do a s2 to a s5 and</font>

234
00:10:48,950 --> 00:10:52,640
likewise I'm going to<font color="#E5E5E5"> blackhole that</font>

235
00:10:50,959 --> 00:10:54,260
traffic down to a s1 as well and that's

236
00:10:52,640 --> 00:10:57,020
<font color="#E5E5E5">just to</font><font color="#CCCCCC"> show if you have a longer</font>

237
00:10:54,260 --> 00:11:00,980
<font color="#E5E5E5">distance in your</font><font color="#CCCCCC"> s path what that effect</font>

238
00:10:57,020 --> 00:11:02,930
will<font color="#CCCCCC"> be so praying to the demo gods here</font>

239
00:11:00,980 --> 00:11:04,250
that this will work<font color="#CCCCCC"> I've got it recorded</font>

240
00:11:02,930 --> 00:11:06,510
just<font color="#E5E5E5"> in case</font>

241
00:11:04,250 --> 00:11:09,480
so here's the network<font color="#E5E5E5"> running it's all</font>

242
00:11:06,510 --> 00:11:12,870
active<font color="#E5E5E5"> and reachable</font><font color="#CCCCCC"> hopefully it stays</font>

243
00:11:09,480 --> 00:11:15,270
that<font color="#E5E5E5"> way</font><font color="#CCCCCC"> so what I'll do first is I'll</font>

244
00:11:12,870 --> 00:11:19,080
hop<font color="#CCCCCC"> onto router two which is this one up</font>

245
00:11:15,270 --> 00:11:23,120
<font color="#CCCCCC">here and I'll</font><font color="#E5E5E5"> have I'll show you the BGP</font>

246
00:11:19,080 --> 00:11:23,120
table<font color="#E5E5E5"> so I did this just</font><font color="#CCCCCC"> before the talk</font>

247
00:11:23,660 --> 00:11:28,199
so that's<font color="#E5E5E5"> the BGP table for the for the</font>

248
00:11:26,880 --> 00:11:30,500
network that's<font color="#E5E5E5"> going to be used in the</font>

249
00:11:28,200 --> 00:11:34,970
demo<font color="#E5E5E5"> and as I</font><font color="#CCCCCC"> said I'll look</font><font color="#E5E5E5"> first at</font>

250
00:11:30,500 --> 00:11:37,800
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> as3 so</font><font color="#E5E5E5"> that's this subnet here</font>

251
00:11:34,970 --> 00:11:40,410
so the first thing we look<font color="#E5E5E5"> at here is</font>

252
00:11:37,800 --> 00:11:42,930
the<font color="#CCCCCC"> AAS path which is</font><font color="#E5E5E5"> this variable at</font>

253
00:11:40,410 --> 00:11:45,180
the<font color="#E5E5E5"> end and you can see here this is the</font>

254
00:11:42,930 --> 00:11:47,430
<font color="#E5E5E5">shortest one obviously goes direct</font><font color="#CCCCCC"> 3 to</font>

255
00:11:45,180 --> 00:11:49,680
<font color="#CCCCCC">1</font><font color="#E5E5E5"> and the other thing to note from the</font>

256
00:11:47,430 --> 00:11:51,540
BGP<font color="#E5E5E5"> table is if you have this arrow</font><font color="#CCCCCC"> it</font>

257
00:11:49,680 --> 00:11:54,420
means<font color="#E5E5E5"> this is what's being put into the</font>

258
00:11:51,540 --> 00:11:57,420
routing table you can you can<font color="#CCCCCC"> look more</font>

259
00:11:54,420 --> 00:12:01,170
specifically<font color="#E5E5E5"> if you do show IP BGP and</font>

260
00:11:57,420 --> 00:12:07,319
<font color="#CCCCCC">then put your route in and you can see</font>

261
00:12:01,170 --> 00:12:10,310
there which one has<font color="#E5E5E5"> been put in so two</font>

262
00:12:07,320 --> 00:12:13,829
<font color="#CCCCCC">piles of the</font><font color="#E5E5E5"> advertised</font>

263
00:12:10,310 --> 00:12:17,060
<font color="#CCCCCC">and and this one has this AAS path and</font>

264
00:12:13,829 --> 00:12:17,060
this one has<font color="#E5E5E5"> this s path</font>

265
00:12:18,529 --> 00:12:29,689
so I'll just do a quick<font color="#E5E5E5"> traceroute to</font>

266
00:12:21,949 --> 00:12:30,829
check<font color="#E5E5E5"> up yep</font><font color="#CCCCCC"> and it's and you</font><font color="#E5E5E5"> can see</font>

267
00:12:29,689 --> 00:12:33,829
even<font color="#E5E5E5"> in the traceroute that it's gone</font>

268
00:12:30,829 --> 00:12:35,689
straight<font color="#CCCCCC"> to a s3</font><font color="#E5E5E5"> so what I'm going to do</font>

269
00:12:33,829 --> 00:12:38,929
<font color="#CCCCCC">before I start</font><font color="#E5E5E5"> my attack here is I'm</font>

270
00:12:35,689 --> 00:12:40,429
going to<font color="#E5E5E5"> has this cool option of doing</font>

271
00:12:38,929 --> 00:12:43,519
packet capture so we can do a packet

272
00:12:40,429 --> 00:12:48,379
capture between two of the nodes<font color="#CCCCCC"> oops</font>

273
00:12:43,519 --> 00:12:50,119
not<font color="#E5E5E5"> that one always do that so creating</font>

274
00:12:48,379 --> 00:12:51,829
<font color="#E5E5E5">your packet capture that way I can show</font>

275
00:12:50,119 --> 00:12:55,549
<font color="#CCCCCC">you the packets</font><font color="#E5E5E5"> that I'm sending</font><font color="#CCCCCC"> to do</font>

276
00:12:51,829 --> 00:12:57,829
the attack so viral has<font color="#E5E5E5"> this tool called</font>

277
00:12:55,549 --> 00:13:00,139
<font color="#CCCCCC">rowden and they Cisco</font><font color="#E5E5E5"> have created this</font>

278
00:12:57,829 --> 00:13:02,258
specifically so that<font color="#CCCCCC"> engineers can</font><font color="#E5E5E5"> test</font>

279
00:13:00,139 --> 00:13:04,819
their networks by<font color="#E5E5E5"> injecting extra routes</font>

280
00:13:02,259 --> 00:13:06,859
<font color="#E5E5E5">I'm not sure if they</font><font color="#CCCCCC"> realize that we</font>

281
00:13:04,819 --> 00:13:10,519
could also test doing bad stuff<font color="#CCCCCC"> but</font>

282
00:13:06,859 --> 00:13:13,489
that's what I'm doing so if I open route

283
00:13:10,519 --> 00:13:18,229
them here I've prepared some<font color="#CCCCCC"> demo so if</font>

284
00:13:13,489 --> 00:13:20,089
I cat<font color="#E5E5E5"> demo one one</font><font color="#CCCCCC"> two the</font><font color="#E5E5E5"> first demo</font>

285
00:13:18,229 --> 00:13:22,579
<font color="#E5E5E5">and I'll actually launch the demo</font>

286
00:13:20,089 --> 00:13:27,169
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it takes a little while for</font><font color="#E5E5E5"> the</font>

287
00:13:22,579 --> 00:13:28,909
routes to change so in the file here it

288
00:13:27,169 --> 00:13:32,149
pretty much just<font color="#E5E5E5"> sets up a</font><font color="#CCCCCC"> bgp</font>

289
00:13:28,909 --> 00:13:34,039
relationship with router<font color="#E5E5E5"> 3 and it's</font>

290
00:13:32,149 --> 00:13:35,809
actually<font color="#CCCCCC"> just sharing</font><font color="#E5E5E5"> this route here</font>

291
00:13:34,039 --> 00:13:40,069
that<font color="#CCCCCC"> i want to inject into</font><font color="#E5E5E5"> that bgp</font>

292
00:13:35,809 --> 00:13:46,269
network<font color="#E5E5E5"> if</font><font color="#CCCCCC"> i go back to the packet</font>

293
00:13:40,069 --> 00:13:49,189
capture i just started and and<font color="#E5E5E5"> open it</font>

294
00:13:46,269 --> 00:13:54,679
not delete it<font color="#E5E5E5"> which would</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> something</font>

295
00:13:49,189 --> 00:13:56,779
I'd do<font color="#CCCCCC"> okay it's opening in Wireshark I</font>

296
00:13:54,679 --> 00:14:00,728
said pick<font color="#CCCCCC"> it up if I can</font><font color="#E5E5E5"> make it a bit</font>

297
00:13:56,779 --> 00:14:03,229
bigger<font color="#E5E5E5"> yep so if I just filter on</font><font color="#CCCCCC"> BGP</font>

298
00:14:00,729 --> 00:14:05,929
you can see here the<font color="#CCCCCC"> sum of</font><font color="#E5E5E5"> the messages</font>

299
00:14:03,229 --> 00:14:07,329
<font color="#E5E5E5">at BGP</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> sending we have the open</font>

300
00:14:05,929 --> 00:14:09,459
message<font color="#E5E5E5"> that I talked</font><font color="#CCCCCC"> about so</font><font color="#E5E5E5"> this is</font>

301
00:14:07,329 --> 00:14:12,649
my route I'm creating<font color="#E5E5E5"> that relationship</font>

302
00:14:09,459 --> 00:14:15,378
<font color="#CCCCCC">some Cape Alive</font><font color="#E5E5E5"> messages and some</font>

303
00:14:12,649 --> 00:14:18,619
updates so the update is the<font color="#E5E5E5"> one that is</font>

304
00:14:15,379 --> 00:14:20,539
the<font color="#E5E5E5"> one we're interested in if I dig</font>

305
00:14:18,619 --> 00:14:23,479
into that<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit deeper you can</font>

306
00:14:20,539 --> 00:14:28,459
<font color="#E5E5E5">see all I'm doing is saying hey I know</font>

307
00:14:23,479 --> 00:14:30,979
about<font color="#E5E5E5"> this route here if you have this</font>

308
00:14:28,459 --> 00:14:33,550
route send to me so if I go<font color="#CCCCCC"> back to</font>

309
00:14:30,979 --> 00:14:39,290
router<font color="#CCCCCC"> 2</font>

310
00:14:33,550 --> 00:14:41,569
<font color="#E5E5E5">and have a look at my BGP table so you</font>

311
00:14:39,290 --> 00:14:46,910
<font color="#E5E5E5">can see here the BGP table for that</font>

312
00:14:41,570 --> 00:14:48,800
<font color="#E5E5E5">subnet has changed</font><font color="#CCCCCC"> but even though this</font>

313
00:14:46,910 --> 00:14:51,350
<font color="#CCCCCC">has dropped</font><font color="#E5E5E5"> down to it being like one</font>

314
00:14:48,800 --> 00:14:53,810
hop away<font color="#CCCCCC"> a s1 you can see that it</font>

315
00:14:51,350 --> 00:14:55,910
actually<font color="#CCCCCC"> hasn't changed what's in the</font>

316
00:14:53,810 --> 00:15:01,518
routing table<font color="#E5E5E5"> and I can</font><font color="#CCCCCC"> test this by</font>

317
00:14:55,910 --> 00:15:02,660
<font color="#CCCCCC">doing the the traceroute so</font><font color="#E5E5E5"> so you can</font>

318
00:15:01,519 --> 00:15:05,810
see it's still<font color="#E5E5E5"> just</font><font color="#CCCCCC"> going straight</font><font color="#E5E5E5"> to</font>

319
00:15:02,660 --> 00:15:10,310
<font color="#CCCCCC">three so what happens if you if you're</font>

320
00:15:05,810 --> 00:15:11,510
advertising the same same prefix<font color="#E5E5E5"> it's</font>

321
00:15:10,310 --> 00:15:13,760
just<font color="#E5E5E5"> going to stick with what it already</font>

322
00:15:11,510 --> 00:15:16,970
<font color="#CCCCCC">knows and that's part of just</font>

323
00:15:13,760 --> 00:15:20,089
maintaining that stability<font color="#CCCCCC"> um so I go</font>

324
00:15:16,970 --> 00:15:25,640
back<font color="#E5E5E5"> let me go back and I'll</font><font color="#CCCCCC"> show</font><font color="#E5E5E5"> you</font>

325
00:15:20,089 --> 00:15:28,610
demo<font color="#CCCCCC"> to</font><font color="#E5E5E5"> will demo one part two and here</font>

326
00:15:25,640 --> 00:15:32,240
I'm going to<font color="#E5E5E5"> I'll launch it again so it</font>

327
00:15:28,610 --> 00:15:34,610
takes a<font color="#E5E5E5"> little while this time I'm going</font>

328
00:15:32,240 --> 00:15:37,670
to<font color="#E5E5E5"> advertise a more specific route which</font>

329
00:15:34,610 --> 00:15:39,140
is<font color="#CCCCCC"> three three three 2/32</font><font color="#E5E5E5"> so this one's</font>

330
00:15:37,670 --> 00:15:42,760
<font color="#E5E5E5">more specific so it's a different</font>

331
00:15:39,140 --> 00:15:45,529
different<font color="#E5E5E5"> route and if I head back to my</font>

332
00:15:42,760 --> 00:15:47,089
BGP table you can<font color="#CCCCCC"> see this is gone I've</font>

333
00:15:45,529 --> 00:15:48,820
stopped that<font color="#E5E5E5"> attack so that's gone back</font>

334
00:15:47,089 --> 00:15:55,970
to<font color="#E5E5E5"> being the full length that it was</font>

335
00:15:48,820 --> 00:16:02,240
<font color="#E5E5E5">should come up soon there we go so</font>

336
00:15:55,970 --> 00:16:04,730
there's the new<font color="#E5E5E5"> there's the new route</font>

337
00:16:02,240 --> 00:16:06,589
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> lint and the shortest s path is one</font>

338
00:16:04,730 --> 00:16:11,480
so that's been popped into the<font color="#E5E5E5"> routing</font>

339
00:16:06,589 --> 00:16:15,110
table<font color="#E5E5E5"> now if I do my trace route it</font>

340
00:16:11,480 --> 00:16:16,550
should work<font color="#E5E5E5"> yep</font><font color="#CCCCCC"> so it's dropped into a</font>

341
00:16:15,110 --> 00:16:17,930
s1 so it's not getting<font color="#CCCCCC"> to</font><font color="#E5E5E5"> where it</font>

342
00:16:16,550 --> 00:16:22,000
<font color="#E5E5E5">should</font><font color="#CCCCCC"> be going and</font><font color="#E5E5E5"> where black holing</font>

343
00:16:17,930 --> 00:16:24,140
that traffic which<font color="#E5E5E5"> is which is good but</font>

344
00:16:22,000 --> 00:16:26,300
it was a bit annoying because we had to

345
00:16:24,140 --> 00:16:33,079
do a more specific route so we'll look

346
00:16:26,300 --> 00:16:35,569
more at<font color="#E5E5E5"> this this way two to five where</font>

347
00:16:33,079 --> 00:16:37,910
we've got a bigger bigger<font color="#E5E5E5"> option of</font>

348
00:16:35,570 --> 00:16:41,209
route so if I do you I'm sure IP BGP

349
00:16:37,910 --> 00:16:43,550
again you'll<font color="#E5E5E5"> get sick of that command we</font>

350
00:16:41,209 --> 00:16:45,229
see<font color="#E5E5E5"> five five five zero and as I said</font>

351
00:16:43,550 --> 00:16:45,870
<font color="#E5E5E5">before there's there's different</font><font color="#CCCCCC"> ways to</font>

352
00:16:45,230 --> 00:16:47,960
get there<font color="#E5E5E5"> so</font>

353
00:16:45,870 --> 00:16:52,560
if<font color="#E5E5E5"> I go back</font><font color="#CCCCCC"> to my diagram we can go</font>

354
00:16:47,960 --> 00:16:56,550
from from<font color="#CCCCCC"> - it</font><font color="#E5E5E5"> can go one three six five</font>

355
00:16:52,560 --> 00:16:58,109
<font color="#E5E5E5">you can go to 365 or it can go to four</font>

356
00:16:56,550 --> 00:17:00,359
five<font color="#E5E5E5"> and you know there's multiple</font>

357
00:16:58,110 --> 00:17:06,120
multiple ways

358
00:17:00,360 --> 00:17:09,000
oops come back<font color="#E5E5E5"> there we go so the</font>

359
00:17:06,119 --> 00:17:13,349
shortest<font color="#E5E5E5"> way is</font><font color="#CCCCCC"> four five</font><font color="#E5E5E5"> directly that</font>

360
00:17:09,000 --> 00:17:13,950
way<font color="#E5E5E5"> so if I do a trace route five five</font>

361
00:17:13,349 --> 00:17:17,790
<font color="#E5E5E5">five</font>

362
00:17:13,950 --> 00:17:20,910
<font color="#E5E5E5">- you can see it goes through a s 4 and</font>

363
00:17:17,790 --> 00:17:27,109
then<font color="#E5E5E5"> it goes through a s 5 I'm so if I</font>

364
00:17:20,910 --> 00:17:27,110
attack this one which<font color="#E5E5E5"> is demo2</font>

365
00:17:32,240 --> 00:17:36,530
and this time I'm just<font color="#E5E5E5"> doing a slash 24</font>

366
00:17:35,150 --> 00:17:41,570
again<font color="#E5E5E5"> or what's already in the routing</font>

367
00:17:36,530 --> 00:17:44,320
<font color="#E5E5E5">table</font><font color="#CCCCCC"> but because of the distances</font><font color="#E5E5E5"> when</font>

368
00:17:41,570 --> 00:17:50,559
I look at this one

369
00:17:44,320 --> 00:17:58,460
it takes a little<font color="#E5E5E5"> while one more time</font>

370
00:17:50,559 --> 00:18:00,110
<font color="#CCCCCC">just one more</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> there we go</font><font color="#E5E5E5"> so you</font>

371
00:17:58,460 --> 00:18:02,480
<font color="#E5E5E5">can see now that the</font><font color="#CCCCCC"> es path has</font>

372
00:18:00,110 --> 00:18:06,439
significantly changed<font color="#CCCCCC"> so we're looking</font>

373
00:18:02,480 --> 00:18:08,150
<font color="#E5E5E5">again at this 555 subnet</font><font color="#CCCCCC"> and the</font>

374
00:18:06,440 --> 00:18:13,490
<font color="#E5E5E5">shortest path now is directly to one</font>

375
00:18:08,150 --> 00:18:15,320
which is our attacker<font color="#CCCCCC"> and that's been</font>

376
00:18:13,490 --> 00:18:17,570
put into the routing table<font color="#E5E5E5"> so now when</font><font color="#CCCCCC"> I</font>

377
00:18:15,320 --> 00:18:20,899
trace route<font color="#CCCCCC"> to five five five two its</font>

378
00:18:17,570 --> 00:18:22,370
dropping<font color="#E5E5E5"> should be going straight to ask</font>

379
00:18:20,900 --> 00:18:22,700
one so I'm black calling that traffic<font color="#E5E5E5"> as</font>

380
00:18:22,370 --> 00:18:24,530
well

381
00:18:22,700 --> 00:18:26,120
so you can see if you're if<font color="#CCCCCC"> you're the</font>

382
00:18:24,530 --> 00:18:28,660
<font color="#E5E5E5">attacker</font><font color="#CCCCCC"> and you're attacking</font><font color="#E5E5E5"> something</font>

383
00:18:26,120 --> 00:18:33,830
<font color="#E5E5E5">further away you can really affect your</font>

384
00:18:28,660 --> 00:18:36,020
<font color="#E5E5E5">nearby a SS a lot a lot</font><font color="#CCCCCC"> more readily so</font>

385
00:18:33,830 --> 00:18:37,340
yep so that's<font color="#E5E5E5"> the first demo done and it</font>

386
00:18:36,020 --> 00:18:46,280
didn't fail so I'm<font color="#E5E5E5"> pretty happy with</font>

387
00:18:37,340 --> 00:18:48,020
that yeah so it works so equal hops with

388
00:18:46,280 --> 00:18:51,428
more specific route<font color="#E5E5E5"> will black hole the</font>

389
00:18:48,020 --> 00:18:54,170
traffic equal hops with the same subnet

390
00:18:51,429 --> 00:18:55,910
<font color="#CCCCCC">the route won't change</font><font color="#E5E5E5"> and that was that</font>

391
00:18:54,170 --> 00:18:58,210
was a bit bit annoying<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I've put a</font>

392
00:18:55,910 --> 00:19:01,070
little<font color="#E5E5E5"> star star here to note</font><font color="#CCCCCC"> that I</font>

393
00:18:58,210 --> 00:19:04,520
mentioned before<font color="#CCCCCC"> that</font><font color="#E5E5E5"> TCP route that I'm</font>

394
00:19:01,070 --> 00:19:06,559
BGP is run<font color="#E5E5E5"> over TCP 179 so an attack</font>

395
00:19:04,520 --> 00:19:08,540
<font color="#CCCCCC">that people are</font><font color="#E5E5E5"> aware</font><font color="#CCCCCC"> of is that</font><font color="#E5E5E5"> you can</font>

396
00:19:06,559 --> 00:19:10,250
<font color="#CCCCCC">brute-force that source port because you</font>

397
00:19:08,540 --> 00:19:12,200
know the<font color="#CCCCCC"> destination port</font><font color="#E5E5E5"> and pull and</font>

398
00:19:10,250 --> 00:19:14,000
send<font color="#E5E5E5"> down</font><font color="#CCCCCC"> these notifications</font><font color="#E5E5E5"> and tear</font>

399
00:19:12,200 --> 00:19:16,730
down<font color="#CCCCCC"> the sessions</font><font color="#E5E5E5"> and then your route</font>

400
00:19:14,000 --> 00:19:18,830
will be<font color="#E5E5E5"> the newest one one the oldest</font>

401
00:19:16,730 --> 00:19:22,280
one<font color="#CCCCCC"> learnt and will go into the routing</font>

402
00:19:18,830 --> 00:19:26,600
table so less hops with the same subnet

403
00:19:22,280 --> 00:19:29,540
<font color="#E5E5E5">will</font><font color="#CCCCCC"> blackhole her traffic</font><font color="#E5E5E5"> yeah so as I</font>

404
00:19:26,600 --> 00:19:32,120
said<font color="#CCCCCC"> just a second ago happening to go</font>

405
00:19:29,540 --> 00:19:34,490
more specific is annoying<font color="#CCCCCC"> don't people</font>

406
00:19:32,120 --> 00:19:37,520
just<font color="#E5E5E5"> like who's going to accept a / 32</font>

407
00:19:34,490 --> 00:19:40,280
route in their BGP table and and like I

408
00:19:37,520 --> 00:19:42,889
said<font color="#CCCCCC"> BGP session tear downs is is an</font>

409
00:19:40,280 --> 00:19:44,870
attack vector for that<font color="#E5E5E5"> so authentication</font>

410
00:19:42,890 --> 00:19:45,560
between<font color="#E5E5E5"> peers will stop that that</font><font color="#CCCCCC"> BGP</font>

411
00:19:44,870 --> 00:19:49,399
session

412
00:19:45,560 --> 00:19:53,360
yeah pull down so I wanted<font color="#E5E5E5"> to do a more</font>

413
00:19:49,400 --> 00:19:56,780
interesting<font color="#E5E5E5"> demo now that we've with</font>

414
00:19:53,360 --> 00:20:00,320
work verify<font color="#E5E5E5"> that it</font><font color="#CCCCCC"> works so this is my</font>

415
00:19:56,780 --> 00:20:02,149
um my spoofing demo<font color="#CCCCCC"> so we're starting</font>

416
00:20:00,320 --> 00:20:03,770
off with<font color="#CCCCCC"> our</font><font color="#E5E5E5"> crack econ vulnerability</font>

417
00:20:02,150 --> 00:20:05,510
researcher<font color="#E5E5E5"> he's that you know he's come</font>

418
00:20:03,770 --> 00:20:07,879
to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> conference he's thinks he's</font>

419
00:20:05,510 --> 00:20:10,370
<font color="#E5E5E5">pretty good he's found is uh well I</font>

420
00:20:07,880 --> 00:20:11,930
<font color="#E5E5E5">should say she's found her her zero days</font>

421
00:20:10,370 --> 00:20:15,050
in<font color="#E5E5E5"> some awesome software and she wants</font>

422
00:20:11,930 --> 00:20:16,670
<font color="#E5E5E5">to report it so she's going to go to</font><font color="#CCCCCC"> sir</font>

423
00:20:15,050 --> 00:20:20,110
toss trailer and and report her

424
00:20:16,670 --> 00:20:25,340
vulnerabilities<font color="#E5E5E5"> so the traffic from</font>

425
00:20:20,110 --> 00:20:31,070
Sirte<font color="#CCCCCC"> Strayer I'm going to try</font><font color="#E5E5E5"> to pull</font>

426
00:20:25,340 --> 00:20:33,669
into a s1 and and spoof it so this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

427
00:20:31,070 --> 00:20:38,260
more tricky demo so hopefully it works

428
00:20:33,670 --> 00:20:38,260
so we've got servers and everything<font color="#CCCCCC"> oh</font>

429
00:20:38,710 --> 00:20:47,750
<font color="#CCCCCC">so</font><font color="#E5E5E5"> yes I've got nothing in</font><font color="#CCCCCC"> my directory</font>

430
00:20:42,610 --> 00:20:50,120
<font color="#CCCCCC">this is my crack econ guy so go guy it's</font>

431
00:20:47,750 --> 00:20:51,920
going<font color="#E5E5E5"> to go to UM you know he doesn't</font>

432
00:20:50,120 --> 00:20:53,840
<font color="#E5E5E5">like gooeys because you know there's too</font>

433
00:20:51,920 --> 00:20:56,150
many vulnerabilities<font color="#E5E5E5"> in Nome and</font><font color="#CCCCCC"> staff</font>

434
00:20:53,840 --> 00:20:58,189
say he does everything come<font color="#E5E5E5"> online so</font>

435
00:20:56,150 --> 00:21:02,150
he's<font color="#CCCCCC"> going to go the website</font><font color="#E5E5E5"> also</font>

436
00:20:58,190 --> 00:21:10,220
there's no<font color="#CCCCCC"> GUI Xin wirelessly so</font><font color="#E5E5E5"> he goes</font>

437
00:21:02,150 --> 00:21:12,470
<font color="#E5E5E5">to</font><font color="#CCCCCC"> the website gets his webpage ok so</font>

438
00:21:10,220 --> 00:21:14,120
this is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> cert web page they really need</font>

439
00:21:12,470 --> 00:21:17,690
to<font color="#E5E5E5"> work</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> their web development but</font>

440
00:21:14,120 --> 00:21:19,639
it's pretty simple<font color="#CCCCCC"> just says</font><font color="#E5E5E5"> welcome to</font>

441
00:21:17,690 --> 00:21:22,430
<font color="#CCCCCC">set Australia I are in responsible</font>

442
00:21:19,640 --> 00:21:25,820
disclosure<font color="#E5E5E5"> for instance in disclosing</font>

443
00:21:22,430 --> 00:21:27,320
vulnerability please<font color="#E5E5E5"> email set a due</font>

444
00:21:25,820 --> 00:21:31,100
date<font color="#E5E5E5"> you so do you</font>

445
00:21:27,320 --> 00:21:35,780
at gov dot<font color="#CCCCCC"> EU</font><font color="#E5E5E5"> anyway so this attacker</font>

446
00:21:31,100 --> 00:21:40,129
guy knows this is happening<font color="#CCCCCC"> so he's</font>

447
00:21:35,780 --> 00:21:45,580
injecting the route<font color="#CCCCCC"> will go back to</font><font color="#E5E5E5"> this</font>

448
00:21:40,130 --> 00:21:45,580
route and we head back<font color="#E5E5E5"> to</font>

449
00:21:46,450 --> 00:21:57,979
yeah<font color="#E5E5E5"> I'm just</font><font color="#CCCCCC"> gonna remove that</font><font color="#E5E5E5"> file and</font>

450
00:21:52,999 --> 00:22:02,859
now the new vulnerabilities<font color="#E5E5E5"> needs to be</font>

451
00:21:57,979 --> 00:22:02,859
disclosed so they head back to<font color="#E5E5E5"> cert</font><font color="#CCCCCC"> yeah</font>

452
00:22:05,409 --> 00:22:15,200
yeah whoo<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> hopefully</font><font color="#CCCCCC"> it's the right</font>

453
00:22:10,039 --> 00:22:18,619
one let's see<font color="#CCCCCC"> say</font><font color="#E5E5E5"> yo look</font><font color="#CCCCCC"> sets changed</font>

454
00:22:15,200 --> 00:22:20,149
their disclosure policy say for

455
00:22:18,619 --> 00:22:22,668
assistance in disclosing<font color="#CCCCCC"> a vulnerability</font>

456
00:22:20,149 --> 00:22:24,549
<font color="#CCCCCC">set</font><font color="#E5E5E5"> a you is now using</font><font color="#CCCCCC"> b-sides</font><font color="#E5E5E5"> camera to</font>

457
00:22:22,669 --> 00:22:27,289
deal with all vulnerable<font color="#CCCCCC"> --'tis no</font>

458
00:22:24,549 --> 00:22:29,359
<font color="#E5E5E5">please email info at these slides</font><font color="#CCCCCC"> they</font>

459
00:22:27,289 --> 00:22:32,239
<font color="#CCCCCC">you.com Denis you with all your</font><font color="#E5E5E5"> sweet 0</font>

460
00:22:29,359 --> 00:22:37,449
days<font color="#CCCCCC"> that's it that's the that's</font><font color="#E5E5E5"> the</font>

461
00:22:32,239 --> 00:22:40,869
last<font color="#E5E5E5"> demo but that was a bit of</font><font color="#CCCCCC"> fun</font><font color="#E5E5E5"> yeah</font>

462
00:22:37,450 --> 00:22:44,509
okay so last<font color="#E5E5E5"> part of the talk will be on</font>

463
00:22:40,869 --> 00:22:48,109
mitigations<font color="#CCCCCC"> so pretty much just route</font>

464
00:22:44,509 --> 00:22:50,119
filtering but you know 700,000 routes on

465
00:22:48,109 --> 00:22:51,499
<font color="#CCCCCC">the internet</font><font color="#E5E5E5"> who's gonna who's going to</font>

466
00:22:50,119 --> 00:22:53,959
<font color="#CCCCCC">filter all those ones and this</font><font color="#E5E5E5"> is the</font>

467
00:22:51,499 --> 00:22:55,190
<font color="#E5E5E5">problem I</font><font color="#CCCCCC"> think that makes</font><font color="#E5E5E5"> bgp route</font>

468
00:22:53,960 --> 00:22:56,710
injection<font color="#CCCCCC"> just keep popping up</font>

469
00:22:55,190 --> 00:22:59,629
constantly

470
00:22:56,710 --> 00:23:01,639
<font color="#CCCCCC">so I speak to my friend at Cisco and</font>

471
00:22:59,629 --> 00:23:04,009
he's<font color="#CCCCCC"> now</font><font color="#E5E5E5"> give</font><font color="#CCCCCC"> you a</font><font color="#E5E5E5"> BGP routing table so</font>

472
00:23:01,639 --> 00:23:07,519
I have to say thanks<font color="#E5E5E5"> to Nathan of us</font>

473
00:23:04,009 --> 00:23:10,429
from Cisco<font color="#CCCCCC"> yeah so he's</font><font color="#E5E5E5"> that his a copy</font>

474
00:23:07,519 --> 00:23:12,009
of the<font color="#E5E5E5"> the current BGP routing table out</font>

475
00:23:10,429 --> 00:23:15,320
on the Internet

476
00:23:12,009 --> 00:23:20,029
<font color="#E5E5E5">yeah and there's our 700,000</font><font color="#CCCCCC"> network</font>

477
00:23:15,320 --> 00:23:21,918
entries there I'm so what what<font color="#CCCCCC"> is best</font>

478
00:23:20,029 --> 00:23:23,960
<font color="#CCCCCC">practice and</font><font color="#E5E5E5"> commonly</font><font color="#CCCCCC"> used is using an</font>

479
00:23:21,919 --> 00:23:26,809
<font color="#CCCCCC">internet routing registry and using an</font>

480
00:23:23,960 --> 00:23:30,469
<font color="#E5E5E5">internet routing registry registry will</font>

481
00:23:26,809 --> 00:23:31,908
allow you to correlate<font color="#CCCCCC"> the a s number to</font>

482
00:23:30,469 --> 00:23:36,349
what IP address<font color="#CCCCCC"> should be coming</font><font color="#E5E5E5"> from</font>

483
00:23:31,909 --> 00:23:40,309
<font color="#CCCCCC">that a s number so it can be used</font><font color="#E5E5E5"> it's a</font>

484
00:23:36,349 --> 00:23:42,349
it's a pretty<font color="#E5E5E5"> much a free service and it</font>

485
00:23:40,309 --> 00:23:44,089
will<font color="#E5E5E5"> allow you to correlate to validate</font>

486
00:23:42,349 --> 00:23:50,570
the contents<font color="#E5E5E5"> of a BGP announcement</font>

487
00:23:44,089 --> 00:23:53,299
message<font color="#CCCCCC"> so this is their their FAC and</font>

488
00:23:50,570 --> 00:23:55,309
you can you<font color="#E5E5E5"> can read</font><font color="#CCCCCC"> about it but I'm</font>

489
00:23:53,299 --> 00:23:57,379
what what is really<font color="#CCCCCC"> neat</font><font color="#E5E5E5"> is being able</font>

490
00:23:55,309 --> 00:23:59,500
<font color="#E5E5E5">to do it programmatically so using</font><font color="#CCCCCC"> RT</font>

491
00:23:57,379 --> 00:24:02,730
config you can pull<font color="#CCCCCC"> down</font><font color="#E5E5E5"> and</font>

492
00:23:59,500 --> 00:24:05,800
automatically configure<font color="#E5E5E5"> this also do</font>

493
00:24:02,730 --> 00:24:07,960
<font color="#E5E5E5">filtering weighted</font><font color="#CCCCCC"> base filtering</font><font color="#E5E5E5"> so you</font>

494
00:24:05,800 --> 00:24:10,629
know you if you<font color="#CCCCCC"> filter out all your</font>

495
00:24:07,960 --> 00:24:12,280
networks<font color="#CCCCCC"> or filter out now it's</font><font color="#E5E5E5"> coming</font>

496
00:24:10,630 --> 00:24:14,200
from other<font color="#E5E5E5"> a</font><font color="#CCCCCC"> SS you're going to lose</font>

497
00:24:12,280 --> 00:24:16,450
<font color="#CCCCCC">that redundancy in BGP which we which we</font>

498
00:24:14,200 --> 00:24:18,790
<font color="#CCCCCC">really mean so weighted filtering will</font>

499
00:24:16,450 --> 00:24:20,770
allow you to<font color="#E5E5E5"> say you know if Google's</font>

500
00:24:18,790 --> 00:24:22,450
advertising this<font color="#E5E5E5"> I trust it</font><font color="#CCCCCC"> more than</font><font color="#E5E5E5"> if</font>

501
00:24:20,770 --> 00:24:24,670
this guy's advertising it but you know

502
00:24:22,450 --> 00:24:27,790
if Google goes down I'm happy<font color="#E5E5E5"> to go this</font>

503
00:24:24,670 --> 00:24:39,070
way<font color="#E5E5E5"> and that's</font><font color="#CCCCCC"> the end say thank</font><font color="#E5E5E5"> you to</font>

504
00:24:27,790 --> 00:24:52,240
crack<font color="#CCCCCC"> econ have any questions we all get</font>

505
00:24:39,070 --> 00:24:53,950
to go<font color="#E5E5E5"> the bar actually</font><font color="#CCCCCC"> someone told me</font>

506
00:24:52,240 --> 00:24:57,150
yesterday I<font color="#E5E5E5"> don't know how true this is</font>

507
00:24:53,950 --> 00:25:00,640
<font color="#E5E5E5">but</font><font color="#CCCCCC"> on that blockchain can be used to do</font>

508
00:24:57,150 --> 00:25:04,030
to<font color="#E5E5E5"> validate BGP routes</font><font color="#CCCCCC"> buyed having it</font>

509
00:25:00,640 --> 00:25:05,440
having<font color="#E5E5E5"> like distributing that</font><font color="#CCCCCC"> added a he</font>

510
00:25:04,030 --> 00:25:08,370
said there's been research on it<font color="#E5E5E5"> I'll</font>

511
00:25:05,440 --> 00:25:08,370
have to go<font color="#E5E5E5"> back and check</font>

512
00:25:16,010 --> 00:25:18,070
<font color="#E5E5E5">you</font>

