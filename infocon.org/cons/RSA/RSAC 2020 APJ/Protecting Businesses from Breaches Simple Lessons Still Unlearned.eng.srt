1
00:00:04,050 --> 00:00:04,883
- Hi, everyone.

2
00:00:04,883 --> 00:00:05,939
Thanks for joining me.

3
00:00:05,940 --> 00:00:07,610
My name's Christine Smoley

4
00:00:07,610 --> 00:00:10,060
and I'm gonna be sharing with you today

5
00:00:10,060 --> 00:00:12,540
on protecting businesses from breaches

6
00:00:12,540 --> 00:00:15,879
and some of the lessons which
we still haven't learned.

7
00:00:15,880 --> 00:00:18,070
First of all, I'd like
to thank DevSecOps Days

8
00:00:18,070 --> 00:00:20,610
for having me along so
that I can share with you

9
00:00:20,610 --> 00:00:24,230
and I hope to be able to
give you something of value.

10
00:00:24,230 --> 00:00:26,580
So just to frame my talk.

11
00:00:26,580 --> 00:00:30,459
So this isn't designed as an in-depth

12
00:00:30,460 --> 00:00:33,520
technological walkthrough of the breaches.

13
00:00:33,520 --> 00:00:35,140
It's also not a history.

14
00:00:35,140 --> 00:00:36,400
Rather what I'm aiming to do

15
00:00:36,400 --> 00:00:38,089
is just take some of these lessons,

16
00:00:38,090 --> 00:00:40,580
which are really rather quite simple.

17
00:00:40,580 --> 00:00:42,730
A lot of the big breaches we see

18
00:00:42,730 --> 00:00:47,610
comes from simple misconfigurations
or unpatched components.

19
00:00:47,610 --> 00:00:50,710
So I'm hoping that by
highlighting some of these things,

20
00:00:50,710 --> 00:00:52,120
you'll get some takeaways,

21
00:00:52,120 --> 00:00:53,629
whether you're running a business

22
00:00:53,630 --> 00:00:56,050
and wondering how you
can best secure them,

23
00:00:56,050 --> 00:00:58,339
or whether you're perhaps
starting out in the industry

24
00:00:58,340 --> 00:01:00,450
and wondering how do these things happen

25
00:01:00,450 --> 00:01:02,980
and how can you best serve your industry

26
00:01:02,980 --> 00:01:04,343
by trying to prevent them?

27
00:01:05,330 --> 00:01:08,050
So, to get started,

28
00:01:08,050 --> 00:01:08,940
Who am I?

29
00:01:08,940 --> 00:01:10,830
So why are you listening to me

30
00:01:10,830 --> 00:01:12,880
of all people talk about this?

31
00:01:12,880 --> 00:01:17,100
So I am a security engineer at Paytm Labs.

32
00:01:17,100 --> 00:01:22,100
And so Paytm is the largest
eCommerce ecosystem in India.

33
00:01:22,800 --> 00:01:26,480
So we have about 350 million users.

34
00:01:26,480 --> 00:01:28,580
We have 15,000 staff.

35
00:01:28,580 --> 00:01:31,179
And so we have a large
infrastructure over there

36
00:01:31,180 --> 00:01:34,470
and I'm part of a relatively
small security team

37
00:01:34,470 --> 00:01:38,400
who works to secure it.

38
00:01:38,400 --> 00:01:40,690
Sorry, I have a variety of functions

39
00:01:40,690 --> 00:01:43,240
and two of the main ones are
(car engine revving)

40
00:01:43,240 --> 00:01:45,890
I am the bug bounty program lead.

41
00:01:45,890 --> 00:01:47,780
So a bug bounty program,

42
00:01:47,780 --> 00:01:49,680
I'm sure many of you
will have heard of one

43
00:01:49,680 --> 00:01:53,660
that one way or another
that if a consumer,

44
00:01:53,660 --> 00:01:57,429
member of the public finds a
bug in a piece of software,

45
00:01:57,430 --> 00:02:00,910
I'm sure we've heard the ones
recently by Apple and Amazon,

46
00:02:00,910 --> 00:02:03,259
then they're able to
report it to the company,

47
00:02:03,260 --> 00:02:04,770
and then the company is able to fix it.

48
00:02:04,770 --> 00:02:07,729
So it's a way of outsourcing security,

49
00:02:07,730 --> 00:02:12,580
and a way of encouraging
the public to inform us

50
00:02:12,580 --> 00:02:14,530
of the things that they might find

51
00:02:14,530 --> 00:02:16,840
so that we can get on to them.

52
00:02:16,840 --> 00:02:19,880
I am also the threat intelligence lead

53
00:02:19,880 --> 00:02:22,540
and then threat intelligence
it can be a broad term.

54
00:02:22,540 --> 00:02:24,519
So I'll let you know
the way that we do it,

55
00:02:24,520 --> 00:02:27,030
and the way that we
understand threat intelligence

56
00:02:27,030 --> 00:02:28,140
is that first of all,

57
00:02:28,140 --> 00:02:30,100
to have intelligence about your network,

58
00:02:30,100 --> 00:02:31,560
you need to know what's on your network

59
00:02:31,560 --> 00:02:33,020
and what your assets are.

60
00:02:33,020 --> 00:02:34,070
So threat intelligence,

61
00:02:34,070 --> 00:02:37,660
you often think in terms
of the data you collect

62
00:02:37,660 --> 00:02:41,910
about new threats, those
things that might pose a risk

63
00:02:41,910 --> 00:02:43,230
to your business.

64
00:02:43,230 --> 00:02:45,340
But when we receive a threat,

65
00:02:45,340 --> 00:02:47,080
when we receive threat intel,

66
00:02:47,080 --> 00:02:48,850
we need to know whether that's applicable

67
00:02:48,850 --> 00:02:50,226
to our environment.

68
00:02:50,226 --> 00:02:52,370
And we'll only know that
by knowing our assets.

69
00:02:52,370 --> 00:02:55,050
So threat intelligence for
me involves three things.

70
00:02:55,050 --> 00:02:58,650
Knowing your infrastructure,
know yourself,

71
00:02:58,650 --> 00:03:02,010
gain the Intel from this...

72
00:03:02,010 --> 00:03:06,920
Often we see in the form of
CVs, the common vulnerabilities.

73
00:03:06,920 --> 00:03:10,320
This can be about software,
can be about web servers,

74
00:03:10,320 --> 00:03:12,790
it can be operating systems.

75
00:03:12,790 --> 00:03:15,370
And then when we know
that a piece of intel

76
00:03:15,370 --> 00:03:18,370
matches up with our environment,
we can then patch that,

77
00:03:18,370 --> 00:03:20,580
do something to remediate
that issue to make sure that

78
00:03:20,580 --> 00:03:23,040
that then doesn't become concern.

79
00:03:23,040 --> 00:03:25,299
And then in turn, there's
a strong correlation

80
00:03:25,300 --> 00:03:28,470
between the sorts of things
we may get reported to us

81
00:03:28,470 --> 00:03:30,450
through the bug bounty programs,

82
00:03:30,450 --> 00:03:34,660
and what we receive through
threat intelligence.

83
00:03:34,660 --> 00:03:37,170
And so one thing that I found...

84
00:03:37,170 --> 00:03:39,920
So let me say, the reason
this positions mean well

85
00:03:39,920 --> 00:03:41,720
to talk on this topic,

86
00:03:41,720 --> 00:03:44,730
is because if there's anything
I've learned from experience,

87
00:03:44,730 --> 00:03:46,480
that there is a very strong correlation

88
00:03:46,480 --> 00:03:49,480
between what I see on day to
day basis in the components

89
00:03:49,480 --> 00:03:52,619
that we work with, and
some of the root causes

90
00:03:52,620 --> 00:03:54,920
of the large breaches out there.

91
00:03:54,920 --> 00:03:58,899
So often, you'll hear about
the known vulnerabilities,

92
00:03:58,900 --> 00:04:00,890
and in a little bit I'll talk about one

93
00:04:00,890 --> 00:04:03,000
that we just recently saw.

94
00:04:03,000 --> 00:04:05,660
It concern the Australian
government actually,

95
00:04:05,660 --> 00:04:09,810
where the attackers exploited
known vulnerabilities.

96
00:04:09,810 --> 00:04:13,680
These are things that when they come out

97
00:04:13,680 --> 00:04:17,313
when you hear what component was exploited

98
00:04:17,313 --> 00:04:18,146
(car engine revving)

99
00:04:18,146 --> 00:04:20,670
it's almost uncanny because
I've seen these things,

100
00:04:20,670 --> 00:04:22,780
I know how to secure these things.

101
00:04:22,780 --> 00:04:27,710
So it leaves you with
quite an uneasy feeling

102
00:04:27,710 --> 00:04:30,489
when you see the consequences
of these breaches,

103
00:04:30,490 --> 00:04:34,040
whether it's personal
data, the cost of them,

104
00:04:34,040 --> 00:04:37,620
the loss of life in
cases such as WannaCry ,

105
00:04:37,620 --> 00:04:39,390
and you're aware that in some cases,

106
00:04:39,390 --> 00:04:43,130
all you need to do was to
update or to configure it.

107
00:04:43,130 --> 00:04:47,469
So in the case of publicly
accessible servers

108
00:04:47,470 --> 00:04:50,140
so that they weren't publicly accessible.

109
00:04:50,140 --> 00:04:52,090
So I've seen this correlation.

110
00:04:52,090 --> 00:04:53,280
I've seen the correlation

111
00:04:53,280 --> 00:04:57,000
between the bug bounty
methodologies that people use

112
00:04:57,000 --> 00:05:00,660
and the the techniques of adversaries.

113
00:05:00,660 --> 00:05:04,800
So often, once again, starting
with knowing the assets,

114
00:05:04,800 --> 00:05:06,610
whether you're on the security team,

115
00:05:06,610 --> 00:05:09,660
whether you're working
to attack a company,

116
00:05:09,660 --> 00:05:11,010
you'll need to know what they use,

117
00:05:11,010 --> 00:05:14,930
what is network where the IP
ranges, what software is there,

118
00:05:14,930 --> 00:05:19,347
and then source Intel and
identify the vulnerabilities.

119
00:05:19,347 --> 00:05:20,830
And so for any of you

120
00:05:20,830 --> 00:05:23,070
who do have a background in pentesting,

121
00:05:23,070 --> 00:05:25,300
you don't need to get
far before you know that

122
00:05:25,300 --> 00:05:28,860
first of all, you identify
let's say the IP range,

123
00:05:28,860 --> 00:05:32,270
you then run a scan to identify
what services are running.

124
00:05:32,270 --> 00:05:34,979
And then you can quite often just google

125
00:05:34,980 --> 00:05:38,090
an exploit for the service that you find.

126
00:05:38,090 --> 00:05:41,200
And then the next step in the methodology

127
00:05:41,200 --> 00:05:43,510
is to maintain control.

128
00:05:43,510 --> 00:05:45,420
Once you know your assets, you secure it,

129
00:05:45,420 --> 00:05:48,080
you want to make sure you maintain that.

130
00:05:48,080 --> 00:05:52,550
And so that then on my side
is patching the systems,

131
00:05:52,550 --> 00:05:55,750
remediating vulnerabilities,
mitigating risk.

132
00:05:55,750 --> 00:05:58,400
But on a attacker side,

133
00:05:58,400 --> 00:06:02,750
that can then actually
be a similar approach

134
00:06:02,750 --> 00:06:04,860
but to maintain access.

135
00:06:04,860 --> 00:06:07,270
And I want to share...

136
00:06:07,270 --> 00:06:12,270
It's almost an allegory about
once I heard from a podcast.

137
00:06:13,890 --> 00:06:15,860
Unfortunately I searched what high and low

138
00:06:15,860 --> 00:06:18,040
but I couldn't find the specific one.

139
00:06:18,040 --> 00:06:20,750
If someone can remind
me, please get in touch.

140
00:06:20,750 --> 00:06:24,020
But I remember a security
consultant saying

141
00:06:24,020 --> 00:06:26,549
that Wind Firm had
gotten in touch with him

142
00:06:26,550 --> 00:06:28,870
to tell him that that they believe

143
00:06:28,870 --> 00:06:31,240
their systems were compromised.

144
00:06:31,240 --> 00:06:32,397
So the consultant asked,

145
00:06:32,397 --> 00:06:34,247
"Well, what symptoms are you seeing?

146
00:06:34,247 --> 00:06:36,250
"What makes you believe this?"

147
00:06:36,250 --> 00:06:37,590
And they run through a few things,

148
00:06:37,590 --> 00:06:41,260
but one of the indicators
was that their systems

149
00:06:41,260 --> 00:06:44,490
were being updated, which
seems quite peculiar.

150
00:06:44,490 --> 00:06:46,470
But as he investigated, sure enough,

151
00:06:46,470 --> 00:06:50,230
there was crypto mining
malware on the system.

152
00:06:50,230 --> 00:06:52,920
But one of the things
this malware would do

153
00:06:52,920 --> 00:06:56,150
is that would then patch the
system because that meant

154
00:06:56,150 --> 00:06:59,690
that the very vulnerability
it used to get into the system

155
00:06:59,690 --> 00:07:02,010
could then not be used by
someone else to come in

156
00:07:02,010 --> 00:07:05,360
and to get onto their turf, so to speak.

157
00:07:05,360 --> 00:07:08,780
And so the peculiarity about this is that

158
00:07:08,780 --> 00:07:11,780
the malware's patching
was then more effective

159
00:07:11,780 --> 00:07:14,599
than what the Wind Firm had
been able to roll out itself,

160
00:07:14,600 --> 00:07:18,110
because those of us in
IT Change Management,

161
00:07:18,110 --> 00:07:20,520
having a good patching program,

162
00:07:20,520 --> 00:07:22,729
It's simple but not always easy.

163
00:07:22,730 --> 00:07:26,840
So that said, as I talk about these issues

164
00:07:26,840 --> 00:07:29,770
I hope that it's often the
fixes are quite simple.

165
00:07:29,770 --> 00:07:34,640
So upgrading or configuring
a system to be private.

166
00:07:34,640 --> 00:07:36,010
But at the same time,

167
00:07:36,010 --> 00:07:39,360
the struggles of actually
knowing your own network

168
00:07:39,360 --> 00:07:41,660
having disability, the larger it grows,

169
00:07:41,660 --> 00:07:43,500
the more difficult it becomes.

170
00:07:43,500 --> 00:07:46,150
And then when you have
team to believe they rely

171
00:07:46,150 --> 00:07:48,549
on the software and they
don't want the downtime

172
00:07:48,550 --> 00:07:51,560
that it would require to
upgrade their systems,

173
00:07:51,560 --> 00:07:52,960
this then becomes an issue.

174
00:07:52,960 --> 00:07:54,109
So I believe in this story

175
00:07:54,110 --> 00:07:56,050
there was a bit back and
forth with the IT team

176
00:07:56,050 --> 00:07:56,883
and the management.

177
00:07:56,883 --> 00:08:00,719
The IT team want to afford the downtime

178
00:08:00,720 --> 00:08:03,160
to be able to patch the system.

179
00:08:03,160 --> 00:08:05,170
And so in this example,

180
00:08:05,170 --> 00:08:08,110
I remember hearing that
actually the company said,

181
00:08:08,110 --> 00:08:09,560
they were willing to accept the risk

182
00:08:09,560 --> 00:08:11,590
of having the crypto mining malware,

183
00:08:11,590 --> 00:08:13,500
which was just using CPU cycles.

184
00:08:13,500 --> 00:08:16,190
So it wasn't posing...

185
00:08:16,190 --> 00:08:18,700
In that sense, you don't
want to be accepting

186
00:08:18,700 --> 00:08:20,210
malware on your system.

187
00:08:20,210 --> 00:08:23,017
But here, they said,
"Well, we don't mind them

188
00:08:23,017 --> 00:08:25,157
"taking the resources of the CPU,

189
00:08:25,157 --> 00:08:28,609
"if it means that we have
another quick patching cycle."

190
00:08:28,610 --> 00:08:32,200
And so I see on one hand...

191
00:08:34,409 --> 00:08:37,120
Wind Firm it's a relatively small example,

192
00:08:37,120 --> 00:08:41,340
but similarities with larger companies.

193
00:08:41,340 --> 00:08:42,539
And as I mentioned,

194
00:08:42,539 --> 00:08:44,030
I'm gonna move on to talk about the one

195
00:08:44,030 --> 00:08:46,140
that we saw with the Australian Government

196
00:08:46,140 --> 00:08:49,939
because here, just as on the Wind Firm,

197
00:08:49,940 --> 00:08:51,540
they knew that they
need to patch this issue

198
00:08:51,540 --> 00:08:53,333
to keep that turf.

199
00:08:54,210 --> 00:08:56,940
The attacker will often look for things

200
00:08:56,940 --> 00:09:00,680
that can be automated easily found.

201
00:09:00,680 --> 00:09:03,410
And so even in terms of the
Australian Government issue

202
00:09:03,410 --> 00:09:05,530
that we've recently been facing,

203
00:09:05,530 --> 00:09:08,087
they're not often that complex.

204
00:09:08,087 --> 00:09:10,833
And so I'm gonna talk about the recent

205
00:09:11,710 --> 00:09:13,603
situation we're facing in Australia,

206
00:09:14,960 --> 00:09:17,610
and the fact that what they're facing

207
00:09:17,610 --> 00:09:20,610
it's not a highly complex attack.

208
00:09:20,610 --> 00:09:22,080
In fact, it's been referred to

209
00:09:22,080 --> 00:09:24,370
as the copy-paste compromises.

210
00:09:24,370 --> 00:09:28,508
Because the attacks that
the attacker is using

211
00:09:28,508 --> 00:09:30,040
are open source, they're well known,

212
00:09:30,040 --> 00:09:32,480
and they're being used
against known vulnerabilities

213
00:09:32,480 --> 00:09:34,000
in software.

214
00:09:34,000 --> 00:09:38,510
And so here we have what the
Australian Signals Directorate

215
00:09:38,510 --> 00:09:40,710
has released to the
public, the explanation.

216
00:09:40,710 --> 00:09:41,730
Now it's quite wordy.

217
00:09:41,730 --> 00:09:45,250
It uses a lot of jargon there.
(vehicle engine revving)

218
00:09:45,250 --> 00:09:48,660
But basically, it can be broken
down so that the actor here

219
00:09:48,660 --> 00:09:53,660
is using public exploits

220
00:09:54,370 --> 00:09:56,730
against the networks of interest.

221
00:09:56,730 --> 00:09:58,770
And this has been done
with the methodology

222
00:09:58,770 --> 00:10:00,449
that we've already covered.

223
00:10:00,450 --> 00:10:02,910
That first of all, it uses scans

224
00:10:02,910 --> 00:10:04,719
to find the vulnerable services

225
00:10:04,720 --> 00:10:09,350
and the target of interest here.

226
00:10:09,350 --> 00:10:13,720
It then likely maintains a
service and asset inventory,

227
00:10:13,720 --> 00:10:16,637
which as I said, the first
step is always know yourself

228
00:10:16,637 --> 00:10:18,770
or you know your assets.

229
00:10:18,770 --> 00:10:20,740
And then the third step is that

230
00:10:20,740 --> 00:10:24,760
it's mapped known vulnerabilities
to what it has found

231
00:10:24,760 --> 00:10:25,780
what has an inventory of,

232
00:10:25,780 --> 00:10:29,420
to know what the attack vector is.

233
00:10:29,420 --> 00:10:33,089
And so here we find, once again,

234
00:10:33,090 --> 00:10:35,644
the same approach being used.

235
00:10:35,644 --> 00:10:39,580
It's not complex that here
I pulled up the technologies

236
00:10:39,580 --> 00:10:43,180
that the attacker was able to utilize.

237
00:10:43,180 --> 00:10:44,250
And we have Citrix,

238
00:10:44,250 --> 00:10:47,090
we have Microsoft Internet
Information Services,

239
00:10:47,090 --> 00:10:51,840
we have SharePoint, we have Telerik UI.

240
00:10:54,030 --> 00:10:55,130
I think you can google them.

241
00:10:55,130 --> 00:10:58,140
You can google how to exploit them.

242
00:10:58,140 --> 00:11:00,189
But you can also very
easily go and download

243
00:11:00,190 --> 00:11:03,690
patches and updates to fix these issues.

244
00:11:03,690 --> 00:11:06,570
And so that's with any attack,

245
00:11:06,570 --> 00:11:08,400
you find that the version
number might change,

246
00:11:08,400 --> 00:11:10,300
the vulnerable version number.

247
00:11:10,300 --> 00:11:13,270
But the approach to fixing it doesn't.

248
00:11:13,270 --> 00:11:15,590
It's basic cyber hygiene.

249
00:11:15,590 --> 00:11:17,990
And so here I also wanna say though,

250
00:11:17,990 --> 00:11:22,990
that we are focusing on
the common vulnerabilities

251
00:11:23,030 --> 00:11:25,720
that we see in terms of misconfigurations

252
00:11:25,720 --> 00:11:27,200
and unpatched software.

253
00:11:27,200 --> 00:11:30,550
There are, of course, other
elements that lead to breaches

254
00:11:30,550 --> 00:11:34,060
and one huge one is the human factor.

255
00:11:34,060 --> 00:11:35,556
That you can have a secured system,

256
00:11:35,557 --> 00:11:38,430
but if someone leaves their computer open

257
00:11:38,430 --> 00:11:41,819
in the public space or they
leak their credentials,

258
00:11:41,820 --> 00:11:43,790
then that's something
which is more difficult

259
00:11:43,790 --> 00:11:47,490
to secure against simply
by patch management.

260
00:11:47,490 --> 00:11:50,920
There are ways you can
hopefully mitigate issues

261
00:11:50,920 --> 00:11:52,729
with correct permissions,

262
00:11:52,730 --> 00:11:54,910
but I'm not denying that
there are other things

263
00:11:54,910 --> 00:11:58,740
that need to be done as well
as supply chain management

264
00:11:58,740 --> 00:12:01,053
that these are the considerations.

265
00:12:02,100 --> 00:12:04,880
And also that sometime
when I'm talking about

266
00:12:04,880 --> 00:12:07,980
the large breaches that we
won't learn the lessons from

267
00:12:07,980 --> 00:12:12,600
some of the examples I'll use,
for example the WannaCry .

268
00:12:12,600 --> 00:12:16,420
So that was a ransomware
cryptoworm, specifically.

269
00:12:16,420 --> 00:12:18,449
But we're referring to these breaches

270
00:12:18,450 --> 00:12:22,380
in terms of large scale
examples that we can learn from.

271
00:12:22,380 --> 00:12:26,220
So to move on with the stage set,

272
00:12:26,220 --> 00:12:29,533
I might jump into the first example.

273
00:12:30,550 --> 00:12:33,890
So I want to go back to the
WannaCry ransomware attack

274
00:12:33,890 --> 00:12:36,380
back in May, 2017.

275
00:12:36,380 --> 00:12:39,700
So it's widely covered,
but it's an interesting one

276
00:12:39,700 --> 00:12:41,850
and an exemplary one.

277
00:12:41,850 --> 00:12:45,500
Because we find that it was
using a known vulnerability

278
00:12:45,500 --> 00:12:47,700
that there was a patch for.

279
00:12:47,700 --> 00:12:52,410
So this particular
ransomware was based out of

280
00:12:54,550 --> 00:12:57,310
a tech believed to be developed by the NSA

281
00:12:57,310 --> 00:12:58,939
called Eternal Blue.

282
00:12:58,940 --> 00:13:01,343
This was then believed to be leaked,

283
00:13:01,343 --> 00:13:06,343
and the group called the Shadow
Brokers then sold it online.

284
00:13:08,590 --> 00:13:12,423
And knowing that this had
potentially been leaked,

285
00:13:13,428 --> 00:13:16,250
NSA warned Microsoft
and Microsoft were able

286
00:13:16,250 --> 00:13:19,410
to then patch this vulnerability.

287
00:13:19,410 --> 00:13:23,410
So Microsoft produced a patch in March

288
00:13:23,410 --> 00:13:27,980
having been tipped off and then
in April the Shadow Brokers

289
00:13:27,980 --> 00:13:30,390
put this out for public sale

290
00:13:31,350 --> 00:13:35,127
concerning Windows OS SMB1 vulnerability.

291
00:13:36,500 --> 00:13:40,880
And it was then in May
that the ransomware spread.

292
00:13:40,880 --> 00:13:44,953
So this had given them two
months to patch at this point.

293
00:13:45,830 --> 00:13:47,960
Yet there were vulnerable
systems out there

294
00:13:47,960 --> 00:13:52,430
and we saw catastrophic impact

295
00:13:52,430 --> 00:13:55,770
where it shut down 80 NHS organizations,

296
00:13:55,770 --> 00:13:58,083
so the UK National Health Service,

297
00:13:59,890 --> 00:14:02,270
20,000 canceled appointments,

298
00:14:02,270 --> 00:14:05,010
and five hospitals diverting ambulances.

299
00:14:05,010 --> 00:14:06,990
So one thing that I sometimes hear

300
00:14:06,990 --> 00:14:08,900
when we do talk about cyber attacks,

301
00:14:08,900 --> 00:14:11,670
it's the thought that this is just data

302
00:14:11,670 --> 00:14:12,579
that can be recovered.

303
00:14:12,580 --> 00:14:15,270
But in situations such as this,

304
00:14:15,270 --> 00:14:18,020
and as we get into an era
where more and more things

305
00:14:18,020 --> 00:14:22,770
are connected to the network
in terms of healthcare,

306
00:14:22,770 --> 00:14:25,430
this can lead to loss of life.

307
00:14:25,430 --> 00:14:27,569
And so in this case,

308
00:14:27,570 --> 00:14:31,030
not only was this very real consequence,

309
00:14:31,030 --> 00:14:32,970
but then also in terms of business

310
00:14:32,970 --> 00:14:34,430
we're looking at across the board

311
00:14:34,430 --> 00:14:36,603
about 400 billion in losses.

312
00:14:38,930 --> 00:14:40,760
To look at the vulnerability itself,

313
00:14:40,760 --> 00:14:43,620
so the SMB1 vulnerability,

314
00:14:43,620 --> 00:14:45,200
so what could have been done?

315
00:14:45,200 --> 00:14:47,720
So once the the patch had been released,

316
00:14:47,720 --> 00:14:49,820
it could be installed quite easily.

317
00:14:49,820 --> 00:14:53,070
And I think it's just
simply disabling SMBv1

318
00:14:53,070 --> 00:14:56,280
and only supporting SMBv2.

319
00:14:56,280 --> 00:14:58,630
So version two or version
three on the network,

320
00:14:58,630 --> 00:15:00,910
just having that service disabled.

321
00:15:00,910 --> 00:15:04,350
You could also restrict inbound SMB.

322
00:15:04,350 --> 00:15:06,060
So we know what we're talking about,

323
00:15:06,060 --> 00:15:07,770
I'm trying to keep this accessible.

324
00:15:07,770 --> 00:15:11,540
So SMB is the server message block.

325
00:15:11,540 --> 00:15:16,180
It's a network file sharing
service which Microsoft uses.

326
00:15:16,180 --> 00:15:20,520
And so you can restrict
that incoming to a machine

327
00:15:20,520 --> 00:15:23,960
or network by blocking
that on the firewall,

328
00:15:23,960 --> 00:15:28,747
or you can close the inbound
SMB which runs on port 446.

329
00:15:29,610 --> 00:15:31,880
So there's plenty of
things that can be done,

330
00:15:31,880 --> 00:15:35,520
and any of those could
potentially have saved

331
00:15:35,520 --> 00:15:37,313
the sort of losses that we saw.

332
00:15:39,220 --> 00:15:41,500
So moving on another well known one

333
00:15:41,500 --> 00:15:46,060
is the Capital One breach,
which happened in March, 2019.

334
00:15:46,060 --> 00:15:48,959
So this one, perhaps it's a
little bit more technical,

335
00:15:48,960 --> 00:15:51,840
but it you utilize what's called

336
00:15:51,840 --> 00:15:54,290
a Server-Side Request Forgery.

337
00:15:54,290 --> 00:15:56,199
And what made that possible

338
00:15:56,200 --> 00:15:59,920
was a misconfigured
open-source ModSecurity

339
00:15:59,920 --> 00:16:02,000
Web Application Firewall.

340
00:16:02,000 --> 00:16:04,140
So the Web Application Firewall.,

341
00:16:04,140 --> 00:16:06,850
it's designed to protect,
in this instance,

342
00:16:06,850 --> 00:16:09,790
the Amazon Web Services and server.

343
00:16:09,790 --> 00:16:11,319
But instead of protecting it,

344
00:16:11,320 --> 00:16:14,700
it served as a pivot
point for the intruder,

345
00:16:14,700 --> 00:16:18,750
where the intruder was
able to trick this firewall

346
00:16:18,750 --> 00:16:23,750
into overlaying a request
to the back-end resources.

347
00:16:24,370 --> 00:16:27,570
So we have the diagram here,
which is from ModSecurity

348
00:16:27,570 --> 00:16:28,840
how it functions.

349
00:16:28,840 --> 00:16:31,460
So requests from the
network, from the web,

350
00:16:31,460 --> 00:16:34,210
was able to reach the
firewall and then trick it

351
00:16:34,210 --> 00:16:38,190
into querying the metadata service,

352
00:16:38,190 --> 00:16:40,760
the server on the back-end.

353
00:16:40,760 --> 00:16:43,784
And then a metadata service on AWS

354
00:16:43,784 --> 00:16:46,319
will then provide credentials.

355
00:16:46,320 --> 00:16:48,080
It's supposed to provide credentials

356
00:16:48,080 --> 00:16:52,760
to authorized individuals,
so they have permissions

357
00:16:52,760 --> 00:16:54,710
to access resources.

358
00:16:54,710 --> 00:16:57,060
But in this case, it was
able to provide credentials

359
00:16:57,060 --> 00:16:59,290
to the attacker to give them access

360
00:17:00,130 --> 00:17:03,880
And in this case, that access involved

361
00:17:05,232 --> 00:17:07,560
40,000 Social Security numbers,

362
00:17:07,560 --> 00:17:09,819
Canadian Social Security numbers.

363
00:17:09,819 --> 00:17:13,520
Oh well, 1 million
Social Insurance Numbers,

364
00:17:13,520 --> 00:17:18,470
and then details of about
80,000 bank accounts.

365
00:17:18,470 --> 00:17:20,730
And so this was clearly not information

366
00:17:20,730 --> 00:17:22,230
which the public attackers

367
00:17:22,230 --> 00:17:24,579
should have the permissions to access.

368
00:17:24,579 --> 00:17:27,760
It was because of this
misconfigured firewall,

369
00:17:27,760 --> 00:17:30,640
that it was then able to query the servers

370
00:17:30,640 --> 00:17:35,030
to get the credentials
required to access this data.

371
00:17:35,030 --> 00:17:36,629
And the estimated cost of this

372
00:17:36,630 --> 00:17:38,810
they're saying is somewhere
between 300 million

373
00:17:38,810 --> 00:17:41,110
and 500 million dollars.

374
00:17:41,110 --> 00:17:42,520
So once again, if that firewall

375
00:17:42,520 --> 00:17:44,203
had been configured correctly,

376
00:17:45,310 --> 00:17:47,183
then this could have been avoided.

377
00:17:48,710 --> 00:17:51,140
The next breach I want to look at

378
00:17:51,140 --> 00:17:54,180
is the Accenture Cloud Leak.

379
00:17:54,180 --> 00:17:55,390
And once again, very simple,

380
00:17:55,390 --> 00:17:58,290
that they had four
cloud-based storage servers

381
00:17:58,290 --> 00:18:00,139
which were publicly available.

382
00:18:00,140 --> 00:18:04,090
Now, these storage servers
are called S3 buckets.

383
00:18:04,090 --> 00:18:07,740
They're servers on Amazon
where you can store your data.

384
00:18:07,740 --> 00:18:11,220
And at times you might want
an S3 bucket to be public.

385
00:18:11,220 --> 00:18:14,490
There is that functionality,
that I'll give you an example,

386
00:18:14,490 --> 00:18:16,480
that if you're running a website

387
00:18:16,480 --> 00:18:19,530
and you want to store
the images that you use

388
00:18:19,530 --> 00:18:22,160
on that website, not locally,

389
00:18:22,160 --> 00:18:24,470
but you wanna keep that all together

390
00:18:24,470 --> 00:18:27,600
on one particular server
that can then be query

391
00:18:27,600 --> 00:18:29,850
so the website can pull from that.

392
00:18:29,850 --> 00:18:33,110
You might want the S3 bucket,

393
00:18:33,110 --> 00:18:35,629
this server which is hosting the images,

394
00:18:35,630 --> 00:18:38,530
you want that public because
you want these websites

395
00:18:38,530 --> 00:18:42,270
to be able to use this imagery
and to have access to it

396
00:18:42,270 --> 00:18:44,500
so that it can be hosted there,

397
00:18:44,500 --> 00:18:47,090
but then requested to be
used on another website.

398
00:18:47,090 --> 00:18:50,620
In that case, if it's just
images and branding material,

399
00:18:50,620 --> 00:18:53,600
that's fine for the S3
bucket to be public.

400
00:18:53,600 --> 00:18:57,280
Then other cases, and
the case of Accenture,

401
00:18:57,280 --> 00:19:00,879
they had information about
their internal network.

402
00:19:00,880 --> 00:19:05,250
They had 40,000 passwords
and client information

403
00:19:05,250 --> 00:19:07,240
stored in the S3 bucket.

404
00:19:07,240 --> 00:19:10,770
And the only thing that
they would have need to do

405
00:19:10,770 --> 00:19:13,129
to keep that secure, in
which they certainly did

406
00:19:13,130 --> 00:19:14,500
after it was discovered,

407
00:19:14,500 --> 00:19:19,040
is change it from being a public
bucket to a private bucket.

408
00:19:19,040 --> 00:19:24,040
And so what can we learn from
this and how can we do better?

409
00:19:25,120 --> 00:19:28,709
So in the case where we're just
talking about four buckets,

410
00:19:28,710 --> 00:19:29,750
it seems quite easy.

411
00:19:29,750 --> 00:19:32,480
Yes, you can go in there,
change configuration.

412
00:19:32,480 --> 00:19:34,250
Something that a lot of companies face

413
00:19:34,250 --> 00:19:37,840
is when they have thousands of servers,

414
00:19:37,840 --> 00:19:41,679
thousands of S3 storage
buckets potentially.

415
00:19:41,680 --> 00:19:44,620
How do you go and make
sure all of them secure?

416
00:19:44,620 --> 00:19:48,810
And that's where we have cloud
auditing management systems.

417
00:19:48,810 --> 00:19:52,090
You need to make sure that
you have things in place

418
00:19:52,090 --> 00:19:55,129
to keep, once again, back
to knowing your assets

419
00:19:55,130 --> 00:19:58,380
so that you're aware of what
you have and the configuration,

420
00:19:58,380 --> 00:20:03,080
so that you can standardize
the configuration across

421
00:20:03,080 --> 00:20:04,510
what you were using.

422
00:20:04,510 --> 00:20:07,983
So moving on then from a Accenture,

423
00:20:09,100 --> 00:20:11,129
then the Equifax Breach.

424
00:20:11,130 --> 00:20:16,130
And so this is one which
impacted 143 million consumers.

425
00:20:18,220 --> 00:20:21,620
It concerned credit information.

426
00:20:21,620 --> 00:20:24,379
The settlements alone was 700 million

427
00:20:24,380 --> 00:20:27,190
and it's been estimated
that the cost of this

428
00:20:27,190 --> 00:20:29,070
was from Equifax.

429
00:20:29,070 --> 00:20:32,189
They said they spent about $1.6 billion

430
00:20:32,190 --> 00:20:34,580
on security following this.

431
00:20:34,580 --> 00:20:36,070
They fixed this.

432
00:20:36,070 --> 00:20:40,605
The way of avoiding this
700 million settlement

433
00:20:40,605 --> 00:20:42,880
would have been a simple upgrade.

434
00:20:42,880 --> 00:20:45,990
And so they we're using
a unpatched web component

435
00:20:45,990 --> 00:20:49,560
called Apache Struts and, once again,

436
00:20:49,560 --> 00:20:51,429
we saw a fix was provided in March

437
00:20:51,430 --> 00:20:53,570
and the breach occurred in May.

438
00:20:53,570 --> 00:20:55,010
So there were two months

439
00:20:55,010 --> 00:20:57,070
during which they could've upgraded

440
00:20:57,070 --> 00:20:58,760
and avoid this.

441
00:20:58,760 --> 00:21:01,330
So the vulnerability itself.

442
00:21:01,330 --> 00:21:03,720
So Apache Struts was using a parser

443
00:21:03,720 --> 00:21:06,900
and a parser is that
when you put in commands,

444
00:21:06,900 --> 00:21:11,900
when a server is processing
text, that's called parsing.

445
00:21:11,950 --> 00:21:15,040
And if text is being parsed to it,

446
00:21:15,040 --> 00:21:17,860
say commands, some form of input,

447
00:21:17,860 --> 00:21:21,060
then you want to make sure
that input is validated,

448
00:21:21,060 --> 00:21:23,909
that that input doesn't
contain anything suspicious,

449
00:21:23,910 --> 00:21:26,690
that then you might run
an unintended command

450
00:21:26,690 --> 00:21:29,520
on the back-end on the server.

451
00:21:29,520 --> 00:21:34,000
Then this case, the parser had
incorrect exception handling

452
00:21:34,000 --> 00:21:37,340
and error-message generation
during file-upload attempts.

453
00:21:37,340 --> 00:21:40,750
And then this allows remote
attackers to execute commands.

454
00:21:40,750 --> 00:21:44,400
So I would be able to parse
commands to the server,

455
00:21:44,400 --> 00:21:46,200
because when those were parsed

456
00:21:46,200 --> 00:21:49,080
those were not being handled adequately.

457
00:21:49,080 --> 00:21:51,050
And so having gone through some of those,

458
00:21:51,050 --> 00:21:52,530
we see a distinct pattern

459
00:21:53,950 --> 00:21:56,610
between misconfigurations and upgrades.

460
00:21:56,610 --> 00:21:59,959
Some very, very simple solutions

461
00:21:59,960 --> 00:22:03,810
and what can we take away from this?

462
00:22:03,810 --> 00:22:06,820
So first of all, once
again, know yourself,

463
00:22:06,820 --> 00:22:08,340
know your assets.

464
00:22:08,340 --> 00:22:10,413
Have asset management in place.

465
00:22:11,316 --> 00:22:13,440
A few of these were on the cloud.

466
00:22:13,440 --> 00:22:16,030
So have cloud organizing in place.

467
00:22:16,030 --> 00:22:17,950
Have configuration management.

468
00:22:17,950 --> 00:22:21,670
So if you build them into your network,

469
00:22:21,670 --> 00:22:23,540
you're not then going around chasing fires

470
00:22:23,540 --> 00:22:25,810
and trying to put fire fires out,

471
00:22:25,810 --> 00:22:28,953
because hopefully your baseline is secure.

472
00:22:30,270 --> 00:22:32,720
The next is threat intelligence.

473
00:22:32,720 --> 00:22:34,690
So you know your assets,

474
00:22:34,690 --> 00:22:37,010
but unless you know what vulnerabilities

475
00:22:37,010 --> 00:22:38,890
need to be addressed in them,

476
00:22:38,890 --> 00:22:43,070
then knowing your assets
alone isn't going to help.

477
00:22:43,070 --> 00:22:44,980
So know what you have.

478
00:22:44,980 --> 00:22:49,240
Have intel coming in,
subscribe to the advisories

479
00:22:49,240 --> 00:22:51,530
so that if you're using...

480
00:22:51,530 --> 00:22:53,879
We've seen issues lately with zoom,

481
00:22:53,880 --> 00:22:57,080
we've seen issues lately with web servers.

482
00:22:57,080 --> 00:23:00,530
Even I remember the one

483
00:23:00,530 --> 00:23:04,710
from the Australian
breach recently, Citrix.

484
00:23:04,710 --> 00:23:07,990
Just yesterday I received 11
alerts for vulnerabilities.

485
00:23:07,990 --> 00:23:10,330
So if we were using that software,

486
00:23:10,330 --> 00:23:12,139
I would then know that I now need to go

487
00:23:12,140 --> 00:23:13,920
see what version numbers were using,

488
00:23:13,920 --> 00:23:15,620
and if they need to be updated.

489
00:23:15,620 --> 00:23:18,379
So make sure that you are sourcing Intel

490
00:23:18,380 --> 00:23:21,430
and you know when that's
applicable to you.

491
00:23:21,430 --> 00:23:23,620
And once again, basic cyber hygiene.

492
00:23:23,620 --> 00:23:28,620
So have patching in place,
change management in place.

493
00:23:29,570 --> 00:23:31,810
Have processes for these.

494
00:23:31,810 --> 00:23:33,980
And then so aside from
that, in addition to that,

495
00:23:33,980 --> 00:23:36,410
I'm aware that my audience might likely

496
00:23:36,410 --> 00:23:38,420
be those of you who are starting out.

497
00:23:38,420 --> 00:23:41,020
So I certainly hope that
I've made this accessible,

498
00:23:41,020 --> 00:23:44,780
that hasn't been too heavy
on the technical terms.

499
00:23:44,780 --> 00:23:49,379
If you are signing out, one
thing that I can advise is,

500
00:23:49,380 --> 00:23:51,870
as I mentioned, a lot of these
things are familiar to me

501
00:23:51,870 --> 00:23:54,419
because I run a bug bounty program.

502
00:23:54,420 --> 00:23:55,610
So a lot of these are familiar

503
00:23:55,610 --> 00:23:58,300
to what our reporters
are telling us about.

504
00:23:58,300 --> 00:24:00,879
That if they find some server

505
00:24:00,880 --> 00:24:04,193
or they find something that
you can then map to a CV,

506
00:24:05,175 --> 00:24:06,980
a common vulnerability,

507
00:24:06,980 --> 00:24:09,230
then they will report that.

508
00:24:09,230 --> 00:24:11,830
But this is the same thing
that the attackers are doing.

509
00:24:11,830 --> 00:24:14,899
And so knowing bug bounty
hunting methodologies

510
00:24:14,900 --> 00:24:17,770
is actually incredibly helpful
when you're starting out.

511
00:24:17,770 --> 00:24:19,290
So I would encourage any of you,

512
00:24:19,290 --> 00:24:21,010
there's resources out there.

513
00:24:21,010 --> 00:24:22,820
I know a guy called Jason Haddix

514
00:24:22,820 --> 00:24:26,169
has a fantastic bug
bounty hunter methodology

515
00:24:26,170 --> 00:24:27,260
that he updates.

516
00:24:27,260 --> 00:24:30,710
I think he's up to his
third version of that now.

517
00:24:30,710 --> 00:24:32,410
There's also great courses out there,

518
00:24:32,410 --> 00:24:36,480
that doing a introduction
to practical pentesting

519
00:24:36,480 --> 00:24:37,710
can be incredibly helpful

520
00:24:37,710 --> 00:24:40,010
because it gets you
scanning your own network.

521
00:24:41,300 --> 00:24:44,300
Not your network, but
knowing how to scan networks.

522
00:24:44,300 --> 00:24:45,820
And this, in fact, is quite similar

523
00:24:45,820 --> 00:24:48,439
to a general vulnerability assessment.

524
00:24:48,440 --> 00:24:51,830
So knowing your assets,
scan them being aware

525
00:24:51,830 --> 00:24:54,659
of the services that are running.

526
00:24:54,660 --> 00:24:56,860
And that's where a
vulnerability assessment,

527
00:24:56,860 --> 00:24:58,780
which is something which
you should have automated

528
00:24:58,780 --> 00:25:00,960
and running on a regular basis.

529
00:25:00,960 --> 00:25:03,060
That's really very
similar to the first step

530
00:25:03,060 --> 00:25:06,923
of a penetration test or an attack.

531
00:25:08,070 --> 00:25:09,889
So that's for any of you starting out.

532
00:25:09,890 --> 00:25:12,343
I would strongly advise to look into that.

533
00:25:13,460 --> 00:25:16,630
A guy called Heath Adams has
a fantastic course out there

534
00:25:16,630 --> 00:25:18,560
on practical pentesting.

535
00:25:18,560 --> 00:25:19,960
Now, on the other side of the spectrum

536
00:25:19,960 --> 00:25:22,370
I know there's likely a lot
of business owners out there

537
00:25:22,370 --> 00:25:25,060
wondering what do I have to do

538
00:25:25,060 --> 00:25:27,690
to make sure that I'm not next?

539
00:25:27,690 --> 00:25:29,670
And I would say that in
addition to these three,

540
00:25:29,670 --> 00:25:32,070
knowing your assets, having intel,

541
00:25:32,070 --> 00:25:34,590
having the patch management,

542
00:25:34,590 --> 00:25:37,240
and updates, configuration management,

543
00:25:37,240 --> 00:25:39,030
make sure that your systems

544
00:25:39,030 --> 00:25:40,873
are integrating with one another.

545
00:25:41,859 --> 00:25:43,830
I learned my case.

546
00:25:43,830 --> 00:25:46,199
So we run a bug bounty program.

547
00:25:46,200 --> 00:25:49,310
If we have a finding on
the bug bounty program,

548
00:25:49,310 --> 00:25:52,210
we don't assume that's the only one.

549
00:25:52,210 --> 00:25:55,600
We then question well, where
else might this be applicable?

550
00:25:55,600 --> 00:25:57,060
We then make sure that anything

551
00:25:57,060 --> 00:25:58,790
that gets reported to us,

552
00:25:58,790 --> 00:26:00,760
we then take that as intel,

553
00:26:00,760 --> 00:26:02,810
which we then integrate into our systems.

554
00:26:02,810 --> 00:26:05,629
So we have our vulnerability assessment.

555
00:26:05,630 --> 00:26:08,620
We might find if one of
the reports from bug bounty

556
00:26:08,620 --> 00:26:09,879
if it's valid,

557
00:26:09,880 --> 00:26:11,670
we'll then make sure to write a rule

558
00:26:11,670 --> 00:26:13,620
so that you catch that automatically.

559
00:26:13,620 --> 00:26:16,810
So we're not relying on someone
else to hopefully find that.

560
00:26:16,810 --> 00:26:19,530
We're then taking that and
making sure those systems

561
00:26:19,530 --> 00:26:20,700
are integrating.

562
00:26:20,700 --> 00:26:23,530
That the findings from one help us improve

563
00:26:23,530 --> 00:26:28,530
our configuration and optimize
our vulnerability assessment

564
00:26:28,680 --> 00:26:30,323
in that unloved vertical.

565
00:26:31,500 --> 00:26:35,200
And make sure to have auditing in place.

566
00:26:35,200 --> 00:26:38,120
Auditing isn't simply for compliance.

567
00:26:38,120 --> 00:26:41,750
Auditing is knowing what you
have knowing the configuration.

568
00:26:41,750 --> 00:26:44,360
And once again, there's
software out there,

569
00:26:44,360 --> 00:26:46,699
there's plenty of great vendors out there

570
00:26:46,700 --> 00:26:49,200
who will help but keep it simple.

571
00:26:49,200 --> 00:26:51,550
Make sure to have the basics in place.

572
00:26:51,550 --> 00:26:54,040
And I really can't emphasize that enough,

573
00:26:54,040 --> 00:26:58,080
which is what I've hopefully sought to do

574
00:26:58,080 --> 00:26:59,610
in sharing some of the lessons

575
00:26:59,610 --> 00:27:02,639
that we can take away from
some of these larger breaches

576
00:27:02,640 --> 00:27:05,200
which we've seen over the last few years.

577
00:27:05,200 --> 00:27:07,240
So thank you very much for your attention.

578
00:27:07,240 --> 00:27:08,840
It's been a pleasure.

579
00:27:08,840 --> 00:27:11,419
Hopefully in future years I
can be there in person perhaps.

580
00:27:11,420 --> 00:27:14,320
And I hope you've taken
some value from this.

581
00:27:14,320 --> 00:27:15,463
Thank you very much.

