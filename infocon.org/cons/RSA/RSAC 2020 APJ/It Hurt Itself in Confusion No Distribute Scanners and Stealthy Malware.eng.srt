1
00:00:06,604 --> 00:00:08,130
- [Announcer] The Vendorpedia platform

2
00:00:08,130 --> 00:00:11,530
is purpose-built to automate
the third-party risk lifecycle

3
00:00:11,530 --> 00:00:13,620
with three core capabilities:

4
00:00:13,620 --> 00:00:15,540
assessments and due diligence,

5
00:00:15,540 --> 00:00:19,192
global risk exchange, and
vendor chasing services.

6
00:00:25,140 --> 00:00:28,247
- Hello, and welcome to "It
Hurt Itself in Confusion:

7
00:00:28,247 --> 00:00:31,259
"No distribute scanners
and stealthy malware."

8
00:00:31,260 --> 00:00:33,380
If you are joining us live, our speakers

9
00:00:33,380 --> 00:00:35,270
are in the slider
discussion area right now,

10
00:00:35,270 --> 00:00:37,250
answering any of your questions.

11
00:00:37,250 --> 00:00:39,570
If you have any audio or video issues,

12
00:00:39,570 --> 00:00:42,280
please click the technical
support button below.

13
00:00:42,280 --> 00:00:43,510
I'd now like to turn it over

14
00:00:43,510 --> 00:00:48,113
to Liv Rowley and Mathieu
Gaucheler for the presentation.

15
00:00:50,330 --> 00:00:53,280
- Hi everyone, good
morning, good afternoon,

16
00:00:53,280 --> 00:00:54,950
good evening, wherever you may be,

17
00:00:54,950 --> 00:00:56,540
and thank you all for joining us

18
00:00:56,540 --> 00:00:58,266
for "It Hurt Itself in Confusion:

19
00:00:58,267 --> 00:01:01,110
"No distribute scanners
and stealthy malware."

20
00:01:01,110 --> 00:01:02,780
Again, my name is Liv Rowley,

21
00:01:02,780 --> 00:01:05,553
and I am a threat intelligence
analyst over here at Blueliv.

22
00:01:05,553 --> 00:01:07,039
- And I am Mathieu Gaucheler,

23
00:01:07,040 --> 00:01:09,883
I'm a cybersecurity analyst
over at Blueliv as well.

24
00:01:11,650 --> 00:01:14,310
- So what are we going to
be chatting about today?

25
00:01:14,310 --> 00:01:15,561
First off, we're gonna start with

26
00:01:15,561 --> 00:01:18,417
a brief introduction to
no distribute scanners,

27
00:01:18,417 --> 00:01:22,424
or NDSs, so, what are
they, how do they work.

28
00:01:22,424 --> 00:01:24,550
Next we're going to talk about

29
00:01:24,550 --> 00:01:26,679
the different types of NDS services

30
00:01:26,680 --> 00:01:29,488
that we find available in the
cybercriminal underground.

31
00:01:29,488 --> 00:01:33,060
And then we're going to
talk about how these NDSs

32
00:01:33,060 --> 00:01:36,800
are used by cybercriminals
to commit cybercrime.

33
00:01:36,800 --> 00:01:38,119
And then we'll wrap this whole thing up

34
00:01:38,120 --> 00:01:40,993
with some key points for you
all to take away with you.

35
00:01:42,830 --> 00:01:46,737
Okay, so, let's talk about
Scan4You and Dyncheck.

36
00:01:48,350 --> 00:01:49,183
Okay.

37
00:01:49,183 --> 00:01:51,830
Imagine that you are this
man here, Ruslan Bondars.

38
00:01:51,830 --> 00:01:56,210
And it is a lovely day
in May of 2017 in Latvia,

39
00:01:56,210 --> 00:01:58,050
and suddenly you get a knock on the door.

40
00:01:58,050 --> 00:02:00,429
And you are picked up by law enforcement,

41
00:02:00,430 --> 00:02:02,710
extradited to the United States.

42
00:02:02,710 --> 00:02:03,570
What was your crime?

43
00:02:03,570 --> 00:02:04,929
Let's talk.

44
00:02:04,930 --> 00:02:07,283
So, Bondars here and
his partner were running

45
00:02:07,283 --> 00:02:11,885
a no distribute scanner, or
an NDS, known as Scan4You.

46
00:02:11,885 --> 00:02:14,890
Scan4You was branded as
"VirusTotal-for-Crooks"

47
00:02:14,890 --> 00:02:17,390
by the media, which I really like,

48
00:02:17,390 --> 00:02:19,172
because I think it
actually does a great job

49
00:02:19,172 --> 00:02:22,540
of explaining what these services are.

50
00:02:22,540 --> 00:02:25,109
Scan4You was available,
or was online rather,

51
00:02:25,110 --> 00:02:28,430
for eight years, which is
a lengthy period of time

52
00:02:28,430 --> 00:02:29,850
for a cybercriminal service.

53
00:02:29,850 --> 00:02:33,440
Typically the underground
is pretty volatile.

54
00:02:33,440 --> 00:02:36,130
And by the time it was
seized by law enforcement,

55
00:02:36,130 --> 00:02:39,475
it had 30,000 registered users.

56
00:02:39,475 --> 00:02:43,370
So how does this story
end for Mr. Bondars here?

57
00:02:43,370 --> 00:02:47,030
Well, in the US he received
a 14-year prison sentence.

58
00:02:47,030 --> 00:02:49,529
Obviously, that's quite a lengthy time,

59
00:02:49,529 --> 00:02:51,770
and that really should show you

60
00:02:51,770 --> 00:02:54,380
the impact and severity of these services,

61
00:02:54,380 --> 00:02:57,283
and the role that they play
in facilitating cybercrime.

62
00:02:59,200 --> 00:03:01,760
So where does that lead us now, right?

63
00:03:01,760 --> 00:03:03,957
There are many different,
well, there's a handful

64
00:03:03,957 --> 00:03:06,910
of different no distribute
scanners, or NDSs,

65
00:03:06,910 --> 00:03:09,109
that are currently available,

66
00:03:09,110 --> 00:03:11,190
which we will talk a bit about later.

67
00:03:11,190 --> 00:03:15,300
But kind of the top dog of the
NDSs right now is DynCheck.

68
00:03:15,300 --> 00:03:16,681
So, DynCheck is popular with both

69
00:03:16,681 --> 00:03:20,427
Russian- and English-speaking
cybercriminals, as well as

70
00:03:20,427 --> 00:03:23,872
tons of people from other
linguistic communities as well.

71
00:03:23,872 --> 00:03:26,831
The site came online in 2016,

72
00:03:26,831 --> 00:03:29,230
which meant that it was very well prepared

73
00:03:29,230 --> 00:03:32,409
to take over from Scan4You
when that was taken offline.

74
00:03:32,409 --> 00:03:36,111
And DynCheck offers full
static and dynamic scans

75
00:03:36,111 --> 00:03:38,649
of malicious files, and we'll talk

76
00:03:38,650 --> 00:03:40,350
a bit about what that means later.

77
00:03:42,150 --> 00:03:45,110
Okay, so, "No Distribute Scanners 101."

78
00:03:45,110 --> 00:03:46,053
What are these?

79
00:03:47,500 --> 00:03:50,140
So no distribute scanners, or NDSs,

80
00:03:50,140 --> 00:03:55,140
and they're also sometimes
known as counter AV as well.

81
00:03:55,150 --> 00:03:57,120
They are standalone websites.

82
00:03:57,120 --> 00:04:00,400
And by that I mean that
they aren't part of a form,

83
00:04:00,400 --> 00:04:02,310
or a software that you download.

84
00:04:02,310 --> 00:04:04,960
It's actually a website that you access

85
00:04:04,960 --> 00:04:07,970
and they have API access as well.

86
00:04:07,970 --> 00:04:12,450
What they do is that they scan
potentially malicious files

87
00:04:12,450 --> 00:04:15,109
against dozens of different
antivirus products,

88
00:04:15,110 --> 00:04:17,510
and then generate a
report that is given back

89
00:04:17,510 --> 00:04:19,130
to the person scanning the file,

90
00:04:19,130 --> 00:04:21,344
telling you whether and how that file

91
00:04:21,344 --> 00:04:23,293
might have been detected.

92
00:04:24,170 --> 00:04:26,210
So the key here on what differentiates

93
00:04:26,210 --> 00:04:29,349
it from something
legitimate like virus total

94
00:04:29,350 --> 00:04:31,320
is that there's no feedback loop.

95
00:04:31,320 --> 00:04:34,080
So cybercriminals have
disabled the feedback loop

96
00:04:34,080 --> 00:04:35,580
between the anti-virus product

97
00:04:35,580 --> 00:04:37,450
and the anti-virus company

98
00:04:37,450 --> 00:04:41,180
in order to ensure that
this malware stays stealthy

99
00:04:41,180 --> 00:04:44,610
and secret for as long as possible

100
00:04:44,610 --> 00:04:46,653
before being used in a campaign.

101
00:04:47,740 --> 00:04:50,680
So the takeaway there is
that these cybercriminals

102
00:04:50,680 --> 00:04:52,960
are really using security products

103
00:04:52,960 --> 00:04:57,960
to help themselves improve
in their cybercrime.

104
00:04:58,050 --> 00:05:01,070
NDSs are advertised to cybercriminals.

105
00:05:01,070 --> 00:05:03,240
They're actively promoted on forums

106
00:05:03,240 --> 00:05:06,183
and they're cyber-criminal products.

107
00:05:09,180 --> 00:05:11,580
So here we have an example of one NDS.

108
00:05:11,580 --> 00:05:13,359
This is Cyber Scanner.

109
00:05:13,360 --> 00:05:16,240
And you can see it's pretty intuitive,

110
00:05:16,240 --> 00:05:17,400
kind of user friendly.

111
00:05:17,400 --> 00:05:20,260
You can just drag and drop
your file right into the site,

112
00:05:20,260 --> 00:05:22,733
it'll scan it and it'll give you a report.

113
00:05:23,850 --> 00:05:25,130
- So here you have an example

114
00:05:25,130 --> 00:05:28,240
of a little more
complicated setting panel.

115
00:05:28,240 --> 00:05:30,560
This one is from Scan Haven, I believe.

116
00:05:30,560 --> 00:05:32,150
You have a lot of options.

117
00:05:32,150 --> 00:05:35,840
For example, you have the
choice of which anti-virus

118
00:05:35,840 --> 00:05:37,400
you want to test your malware against.

119
00:05:37,400 --> 00:05:41,549
You can see you have (mumbles),
Avast, Avira some of them.

120
00:05:41,550 --> 00:05:44,383
Depending of which one you
wanna test your malware against.

121
00:05:44,383 --> 00:05:46,870
And you have also several

122
00:05:46,870 --> 00:05:49,550
options like enabling internet or not.

123
00:05:49,550 --> 00:05:51,830
Deleting the zone identifier.

124
00:05:51,830 --> 00:05:54,159
Disabling the user access control.

125
00:05:54,160 --> 00:05:57,040
All of these little parameters and options

126
00:05:57,040 --> 00:05:59,390
are made to a lot of factors.

127
00:05:59,390 --> 00:06:03,460
To have a more finely-tuned
control over (faintly speaking).

128
00:06:03,460 --> 00:06:07,400
NDS is going to be actually closer

129
00:06:07,400 --> 00:06:10,789
to what they could encounter in the wild.

130
00:06:10,790 --> 00:06:13,243
This is what this setting
panel is made for.

131
00:06:15,560 --> 00:06:17,660
If you take a look at the
DynCheck settings panel,

132
00:06:17,660 --> 00:06:19,370
you see more of the same options

133
00:06:19,370 --> 00:06:22,200
maybe even more specific.

134
00:06:22,200 --> 00:06:23,550
For example you can use DbgView

135
00:06:23,550 --> 00:06:25,830
to see how Windows reacts to your malware.

136
00:06:25,830 --> 00:06:30,830
Or even enable object
linking and embedding.

137
00:06:30,880 --> 00:06:35,330
But one of the most
interesting features for me

138
00:06:35,330 --> 00:06:37,479
the connection enabling or not.

139
00:06:37,480 --> 00:06:39,650
You can choose to block in completely.

140
00:06:39,650 --> 00:06:41,580
White listing a few handful of sites.

141
00:06:41,580 --> 00:06:44,080
For example your command control server.

142
00:06:44,080 --> 00:06:46,243
Or fully enabling internet.

143
00:06:47,740 --> 00:06:50,510
Fully enabling internet is actually

144
00:06:50,510 --> 00:06:52,070
kind of a cross especially in Scan Haven.

145
00:06:52,070 --> 00:06:54,817
I don't know if you see
there was a mention saying,

146
00:06:54,817 --> 00:06:57,147
"If you enable there to find
(faintly speaking) distributed

147
00:06:57,147 --> 00:06:59,447
"is that because a lot of AV products

148
00:06:59,447 --> 00:07:01,747
"actually use cloud computing

149
00:07:01,747 --> 00:07:05,475
"to do some more heavy lifting operation

150
00:07:05,475 --> 00:07:07,587
"like sandboxing to analyze some files."

151
00:07:08,510 --> 00:07:10,860
That's what NDSs don't want.

152
00:07:10,860 --> 00:07:12,603
They do not desire that because

153
00:07:12,603 --> 00:07:14,950
this would distribute the file

154
00:07:14,950 --> 00:07:16,409
of the redactors stop paying

155
00:07:16,410 --> 00:07:18,580
them not to distribute that.

156
00:07:18,580 --> 00:07:21,479
So that's kind of the problem here.

157
00:07:22,537 --> 00:07:27,409
Okay let's take a look at
the different NDS services.

158
00:07:27,410 --> 00:07:29,080
First and foremost we need to

159
00:07:29,980 --> 00:07:32,420
do a little bit and explain
what difference between

160
00:07:32,420 --> 00:07:35,360
static and dynamic analysis, actually.

161
00:07:35,360 --> 00:07:38,240
So this stems from antiviruses

162
00:07:38,240 --> 00:07:41,070
and the way they analyze files.

163
00:07:41,070 --> 00:07:42,810
You have a static analysis,

164
00:07:42,810 --> 00:07:45,250
which is basically an overview,

165
00:07:45,250 --> 00:07:47,940
an inspection of the format of your file,

166
00:07:47,940 --> 00:07:50,430
of how it's made, what's inside.

167
00:07:50,430 --> 00:07:52,770
For example, is there any string patterns

168
00:07:52,770 --> 00:07:54,650
that are indicative, like
you have on the right,

169
00:07:54,650 --> 00:07:57,568
you have a rule made to detect

170
00:07:57,569 --> 00:08:01,300
an OS X malware named HiddenLotus?

171
00:08:01,300 --> 00:08:02,900
It's basically just
going to open the file,

172
00:08:02,900 --> 00:08:06,080
search for some patterns,
string patterns like this,

173
00:08:06,080 --> 00:08:08,597
and then give out if they are here or not.

174
00:08:08,597 --> 00:08:10,549
It can also inspect the format,

175
00:08:10,550 --> 00:08:12,370
seeing if the, for example,

176
00:08:12,370 --> 00:08:15,860
the portable executable is signed or not,

177
00:08:15,860 --> 00:08:19,380
or if the entropy is considered normal

178
00:08:19,380 --> 00:08:21,440
or not in the form, in the file,

179
00:08:21,440 --> 00:08:22,863
which could indicate, for example,

180
00:08:22,863 --> 00:08:25,967
that the file's packed or maybe encrypted.

181
00:08:26,920 --> 00:08:28,230
On the other hand,

182
00:08:28,230 --> 00:08:32,659
dynamic analysis is really
about executing the sample,

183
00:08:32,659 --> 00:08:34,959
as opposed to static analysis.

184
00:08:34,960 --> 00:08:36,520
And then taking into behavior,

185
00:08:36,520 --> 00:08:37,929
monitoring its behavior,

186
00:08:37,929 --> 00:08:40,229
maybe analyzing the process memory,

187
00:08:40,230 --> 00:08:43,419
or even invading an entire environment

188
00:08:43,419 --> 00:08:45,170
and then running a sample inside

189
00:08:45,170 --> 00:08:48,563
to have a better view of what
it's doing and its behavior.

190
00:08:49,880 --> 00:08:54,140
These are really the two
different ways to analyze,

191
00:08:54,140 --> 00:08:56,410
two different types of
analysis that we can outline:

192
00:08:56,410 --> 00:08:58,810
static, in which you do not run sample,

193
00:08:58,810 --> 00:09:00,260
and dynamic, in which you do.

194
00:09:03,020 --> 00:09:04,640
- So we mentioned earlier

195
00:09:04,640 --> 00:09:08,199
that once you upload your
malicious file to an NDS,

196
00:09:08,200 --> 00:09:10,240
it'll generate a report for you.

197
00:09:10,240 --> 00:09:12,950
So here is an example of one such report.

198
00:09:12,950 --> 00:09:16,150
This is a report of a static scan

199
00:09:16,150 --> 00:09:17,550
of a malware known as Bore,

200
00:09:17,550 --> 00:09:19,859
which is an information-stealing malware,

201
00:09:19,860 --> 00:09:22,270
and this report is from February of 2020.

202
00:09:23,520 --> 00:09:26,050
This report was actually
shared by the threat actor

203
00:09:26,050 --> 00:09:28,550
who wrote Bore, who was trying to sell it,

204
00:09:28,550 --> 00:09:32,310
and so this is used as
a marketing material.

205
00:09:32,310 --> 00:09:36,229
So here you see that Bore
was only detected by one

206
00:09:36,230 --> 00:09:40,283
out of 31 different AV
products on Dyncheck.

207
00:09:41,130 --> 00:09:43,210
And here's a close-up of that detection,

208
00:09:43,210 --> 00:09:45,360
and it actually shows you the signature

209
00:09:45,360 --> 00:09:47,173
that triggered detection here.

210
00:09:49,370 --> 00:09:53,140
And here we have the dynamic scan report

211
00:09:53,140 --> 00:09:54,939
for that same malware sample.

212
00:09:54,940 --> 00:09:56,940
So here, it's actually a truncated report.

213
00:09:56,940 --> 00:09:59,090
We had to cut some stuff out.

214
00:09:59,090 --> 00:10:00,840
But you can see that in this case,

215
00:10:00,840 --> 00:10:02,260
Bore was detected by three

216
00:10:02,260 --> 00:10:04,400
out of 23 different AV products.

217
00:10:04,400 --> 00:10:06,553
So detection has gone up slightly.

218
00:10:07,490 --> 00:10:09,940
And here's a closer look at that.

219
00:10:09,940 --> 00:10:13,560
So one of the interesting
things about the dynamic scans

220
00:10:13,560 --> 00:10:15,500
is that they tend to include screenshots

221
00:10:15,500 --> 00:10:17,500
of the infected machine

222
00:10:17,500 --> 00:10:19,780
after the malware has been executed,

223
00:10:19,780 --> 00:10:21,620
so you can see what this might look like

224
00:10:21,620 --> 00:10:23,263
from a victim perspective.

225
00:10:25,950 --> 00:10:27,300
In the course of this research,

226
00:10:27,300 --> 00:10:31,040
we looked at about nine different NDS's.

227
00:10:31,040 --> 00:10:35,400
I say nine because this underground

228
00:10:36,420 --> 00:10:38,120
landscape is pretty unstable,

229
00:10:38,120 --> 00:10:41,420
so some of the NDS's would go offline

230
00:10:41,420 --> 00:10:43,469
or they would change names

231
00:10:43,470 --> 00:10:46,170
or they'd be bought by somebody
else, something like that,

232
00:10:46,170 --> 00:10:49,780
but we really, we looked
at nine different services

233
00:10:49,780 --> 00:10:52,273
that existed at one
point in time at least.

234
00:10:53,110 --> 00:10:56,030
All of these services offered API access,

235
00:10:56,030 --> 00:10:59,490
and all of them offered
static scans as well.

236
00:10:59,490 --> 00:11:01,680
Only two of the nine that we looked at

237
00:11:01,680 --> 00:11:03,109
offered dynamic scans,

238
00:11:03,110 --> 00:11:05,000
which is a little bit curious,

239
00:11:05,000 --> 00:11:07,320
unless you start to
look into how, actually,

240
00:11:07,320 --> 00:11:09,690
these scans are being conducted.

241
00:11:09,690 --> 00:11:12,910
- So to answer that question, what we made

242
00:11:12,910 --> 00:11:14,079
is kind of a mock-up

243
00:11:14,080 --> 00:11:17,540
of the possible architecture
these scanners are using.

244
00:11:17,540 --> 00:11:19,500
Keep in mind, this is nothing more than

245
00:11:19,500 --> 00:11:21,790
an educated guess to answer that question.

246
00:11:21,790 --> 00:11:24,510
Why is there so few dynamic scanners?

247
00:11:24,510 --> 00:11:28,650
Well, let's jump right into
the possible architecture

248
00:11:28,650 --> 00:11:30,670
of static scanner.

249
00:11:30,670 --> 00:11:33,240
You have your classic front end,

250
00:11:33,240 --> 00:11:34,940
which we'll not detail,

251
00:11:34,940 --> 00:11:37,430
communicating to the back-end server,

252
00:11:37,430 --> 00:11:38,650
transmitting the sample,

253
00:11:38,650 --> 00:11:40,860
in which like your software

254
00:11:40,860 --> 00:11:42,440
that we'll call the NDS controller

255
00:11:42,440 --> 00:11:45,610
is going to receive the
sample, store it somewhere,

256
00:11:45,610 --> 00:11:49,170
then the use command-line
interface to actually order the AV

257
00:11:49,170 --> 00:11:52,339
to open the file and search for
some incriminating patterns.

258
00:11:52,340 --> 00:11:53,980
As we say, this is static analysis.

259
00:11:53,980 --> 00:11:56,170
You only need to open the file.

260
00:11:56,170 --> 00:11:58,770
After that, it will return
results of the scan,

261
00:11:58,770 --> 00:12:01,079
and then the NDS controller
will return the result

262
00:12:01,080 --> 00:12:02,563
of the scan to the front end.

263
00:12:03,660 --> 00:12:05,300
Okay, so far, so good, right?

264
00:12:05,300 --> 00:12:07,750
This architecture is
pretty simple to program,

265
00:12:07,750 --> 00:12:09,110
pretty scalable.

266
00:12:09,110 --> 00:12:11,160
It doesn't need a lot of computing power.

267
00:12:12,440 --> 00:12:16,050
But if we take a look at the architecture

268
00:12:16,050 --> 00:12:18,229
that would be needed
for a dynamic scanner,

269
00:12:18,230 --> 00:12:20,510
we run into several problems.

270
00:12:20,510 --> 00:12:21,630
So the beginning is the same.

271
00:12:21,630 --> 00:12:23,400
You have your front end transmitting

272
00:12:23,400 --> 00:12:25,560
to the NDS controller on the back end.

273
00:12:25,560 --> 00:12:28,069
But here, you run into your first problem.

274
00:12:28,070 --> 00:12:30,750
You cannot run a malware sample

275
00:12:30,750 --> 00:12:32,650
into your back-end server directly

276
00:12:32,650 --> 00:12:34,120
because it's a malware.

277
00:12:34,120 --> 00:12:35,830
If you do it, you're
going to get infected,

278
00:12:35,830 --> 00:12:40,120
and possibly lose some very
important pieces of information.

279
00:12:40,120 --> 00:12:42,000
So what you need to do
is actually run this

280
00:12:42,000 --> 00:12:43,560
into a virtual machine,

281
00:12:43,560 --> 00:12:45,640
because, and this is also another reason

282
00:12:45,640 --> 00:12:46,610
for the virtual machine,

283
00:12:46,610 --> 00:12:50,510
you cannot have 50 different
AV software solutions

284
00:12:50,510 --> 00:12:53,250
running in your back-end
server in the same machine,

285
00:12:53,250 --> 00:12:56,580
because they're going to
contaminate each other's analysis.

286
00:12:56,580 --> 00:12:58,700
You need to have them all separate,

287
00:12:58,700 --> 00:13:00,820
meaning that you need,

288
00:13:00,820 --> 00:13:03,870
for 50 different AV software,

289
00:13:03,870 --> 00:13:06,540
you need 50 different virtual machines,

290
00:13:06,540 --> 00:13:08,920
which is going to cost
you a lot in overhead

291
00:13:08,920 --> 00:13:12,113
because you need to
simulate an entire system.

292
00:13:13,010 --> 00:13:14,780
So this is already the first problem.

293
00:13:14,780 --> 00:13:15,930
The second problem,

294
00:13:15,930 --> 00:13:18,579
if you're familiar with a virtual machine,

295
00:13:18,580 --> 00:13:20,790
is that you know you're
going to need a snapshot

296
00:13:20,790 --> 00:13:22,620
to revert back to.

297
00:13:22,620 --> 00:13:24,650
A snapshot is basically a state,

298
00:13:24,650 --> 00:13:27,500
a picture it takes of
a system at instant T,

299
00:13:27,500 --> 00:13:30,270
that you're going to revert
back for each analysis.

300
00:13:30,270 --> 00:13:34,569
This way, they won't be
contaminated by previous ones.

301
00:13:34,570 --> 00:13:37,230
So, and the problem is
that when you cross this

302
00:13:37,230 --> 00:13:40,120
with the problematic of
having an AV software

303
00:13:40,120 --> 00:13:41,150
that needs to be updated

304
00:13:41,150 --> 00:13:44,090
because your customers, your
financiers that pay you,

305
00:13:44,090 --> 00:13:46,970
are paying you for an invasive service,

306
00:13:46,970 --> 00:13:50,300
you need to have your AV
software updated daily

307
00:13:50,300 --> 00:13:52,459
to be efficient at least.

308
00:13:52,460 --> 00:13:55,060
So you need to come up
with some of the mechanism

309
00:13:55,060 --> 00:13:58,790
to every day churn out a new snapshot

310
00:13:58,790 --> 00:14:01,219
with an updated AV software,

311
00:14:01,220 --> 00:14:03,230
and need to do that for all,

312
00:14:03,230 --> 00:14:07,180
maybe the 40, 50 virtual
machines that you have,

313
00:14:07,180 --> 00:14:09,282
and make it into the new daily snapshot.

314
00:14:12,399 --> 00:14:13,956
So the AV scanners are something

315
00:14:13,956 --> 00:14:15,760
that require more computing power

316
00:14:15,760 --> 00:14:18,910
and that are way more difficult
to manage and administer,

317
00:14:18,910 --> 00:14:20,140
and also different RAM,

318
00:14:20,140 --> 00:14:21,830
because you need to
come up with that system

319
00:14:21,830 --> 00:14:25,080
of dating the AV software every day.

320
00:14:25,080 --> 00:14:27,320
So this is partly the
response of the answer,

321
00:14:27,320 --> 00:14:28,410
why we think, actually,

322
00:14:28,410 --> 00:14:30,719
there is so few dynamic scanners,

323
00:14:30,720 --> 00:14:32,930
and this something that
actually has a big impact

324
00:14:32,930 --> 00:14:35,723
on the price, as my
colleague is to demonstrate.

325
00:14:36,810 --> 00:14:39,540
- So we identified three
different pricing models

326
00:14:39,540 --> 00:14:42,740
that are used by these
no-distribute scanners,

327
00:14:42,740 --> 00:14:45,390
and the first are free models.

328
00:14:45,390 --> 00:14:46,640
So some of the scanners

329
00:14:46,640 --> 00:14:48,803
are just available completely for free.

330
00:14:50,340 --> 00:14:53,320
Those were always static
scanners that we identified,

331
00:14:53,320 --> 00:14:56,790
and they appeared to be
supported by paid advertising.

332
00:14:56,790 --> 00:14:58,920
So they would have like ads on them

333
00:14:58,920 --> 00:15:00,199
that would say something like, "Hey,

334
00:15:00,200 --> 00:15:01,510
like do you need a crypter?

335
00:15:01,510 --> 00:15:04,850
Like come check out our
crypter." Something like that.

336
00:15:04,850 --> 00:15:06,490
Then we have the paid model,

337
00:15:06,490 --> 00:15:07,720
So typically,

338
00:15:07,720 --> 00:15:09,318
a site that is a paid-for site will offer

339
00:15:09,318 --> 00:15:11,240
both of these models.

340
00:15:11,240 --> 00:15:13,510
So we have single and bundle scan pricing,

341
00:15:13,510 --> 00:15:16,120
and just a normal subscription model.

342
00:15:16,120 --> 00:15:19,137
By single and bundle
scan, I mean either paying

343
00:15:19,137 --> 00:15:22,410
one price for a single
scan or paying a set price

344
00:15:22,410 --> 00:15:26,980
for maybe 10 scans or 25
scans or something like that.

345
00:15:26,980 --> 00:15:28,980
Subscription models tend
to be more flexible.

346
00:15:28,980 --> 00:15:33,980
They may offer you, you know,
a handful of static scans

347
00:15:34,060 --> 00:15:37,709
and a different amount of
dynamic scans and API access,

348
00:15:37,710 --> 00:15:40,070
and it's good for a week,
or something like that.

349
00:15:40,070 --> 00:15:42,690
And they offer different
combinations of things.

350
00:15:42,690 --> 00:15:45,740
So for the single and bundle scan pricing,

351
00:15:45,740 --> 00:15:50,140
there's really a huge
variety of pricing models

352
00:15:50,140 --> 00:15:51,340
that are out there.

353
00:15:51,340 --> 00:15:52,893
So for instance, for Dyncheck,

354
00:15:53,830 --> 00:15:56,890
we found that to do one static scan,

355
00:15:56,890 --> 00:16:01,400
checking against one AV product,
it cost data at one cent.

356
00:16:01,400 --> 00:16:03,000
And it can go up from there, with the

357
00:16:03,000 --> 00:16:06,620
dynamic scans costing more
than the static scans.

358
00:16:06,620 --> 00:16:09,250
The subscription models, those also have a

359
00:16:09,250 --> 00:16:11,440
giant range in pricing, depending on the

360
00:16:11,440 --> 00:16:12,770
different features that you want

361
00:16:12,770 --> 00:16:15,069
or for what length of
time you want it for,

362
00:16:15,070 --> 00:16:17,810
but for Dyncheck, which
we are looking at here,

363
00:16:17,810 --> 00:16:22,810
there's everything from 50 to
nearly 300 US dollars a month.

364
00:16:25,850 --> 00:16:28,640
So, how are these services advertised?

365
00:16:28,640 --> 00:16:30,470
These services are most popular,

366
00:16:30,470 --> 00:16:32,469
or most popularly advertised, at least,

367
00:16:32,469 --> 00:16:34,920
in the Russian-English language

368
00:16:34,920 --> 00:16:36,209
cyber criminal underground,

369
00:16:36,210 --> 00:16:38,250
so typically on forums.

370
00:16:38,250 --> 00:16:40,581
Here we have a snippet of an ad for

371
00:16:40,581 --> 00:16:43,940
ScanHaven, which was actually
recently rebranded as

372
00:16:43,940 --> 00:16:47,172
CheckZilla, and they say "at ScanHaven

373
00:16:47,172 --> 00:16:50,133
you can scan your file
on 39 fully licensed

374
00:16:50,133 --> 00:16:52,235
anti-viruses which include daily

375
00:16:52,235 --> 00:16:55,360
automated database updates."

376
00:16:55,360 --> 00:16:57,820
We also have a screenshot
here of an ad for

377
00:16:57,820 --> 00:17:00,830
Spyral Scanner, which is a static scanner.

378
00:17:00,830 --> 00:17:02,210
And you can see it's got this kind of like

379
00:17:02,210 --> 00:17:04,253
mysterious graphic, and you know,

380
00:17:04,253 --> 00:17:06,740
the red writing and stuff,

381
00:17:06,740 --> 00:17:08,772
and this is especially common on the

382
00:17:08,772 --> 00:17:11,060
English language underground, using these

383
00:17:11,060 --> 00:17:14,483
kind of flashier graphics
to grab attention.

384
00:17:15,950 --> 00:17:18,359
- So, let's take a look now at

385
00:17:18,359 --> 00:17:20,351
what is the role, actually, of NDS's

386
00:17:20,352 --> 00:17:23,040
in the criminal landscapes,
our criminal landscape.

387
00:17:23,040 --> 00:17:25,240
First we're going to examine

388
00:17:25,240 --> 00:17:28,703
how NDS is directly used
by malware developers.

389
00:17:30,100 --> 00:17:33,592
So, to talk about that
we outline the sort of

390
00:17:33,593 --> 00:17:35,690
different stages in the malware life,

391
00:17:35,690 --> 00:17:38,260
possible stages I say
because not all of them

392
00:17:38,260 --> 00:17:39,540
have to present.

393
00:17:39,540 --> 00:17:42,290
Development, advertisement,
and exploitation.

394
00:17:42,290 --> 00:17:44,930
Of course, not every malware developer

395
00:17:44,930 --> 00:17:47,480
is going to advertise his product.

396
00:17:47,480 --> 00:17:51,050
Also we know that some
cyber criminal gangs

397
00:17:51,050 --> 00:17:53,320
such as (mumbles)

398
00:17:54,720 --> 00:17:58,170
had their own noticeable scanner.

399
00:17:58,170 --> 00:18:00,630
And we as a research community are aware

400
00:18:00,630 --> 00:18:05,333
that modern cyber criminal gang
uses NDS for their activity.

401
00:18:06,490 --> 00:18:08,740
So, with that in mind, let's jump right in

402
00:18:08,740 --> 00:18:09,693
to the development.

403
00:18:11,380 --> 00:18:14,830
When you develop a malware using NDS

404
00:18:14,830 --> 00:18:17,870
to make it more undetectable,

405
00:18:17,870 --> 00:18:20,590
you're going to run
through that kind of cycle,

406
00:18:20,590 --> 00:18:22,399
meaning you're going to test your malware,

407
00:18:22,400 --> 00:18:23,250
analyze the output,

408
00:18:23,250 --> 00:18:25,200
if it's not detected, well, hooray,

409
00:18:25,200 --> 00:18:26,320
you have a great malware.

410
00:18:26,320 --> 00:18:29,050
If it is, you need to identify
the cause of detection,

411
00:18:29,050 --> 00:18:31,623
remedy it, and then
test your malware again.

412
00:18:32,600 --> 00:18:34,820
Now how would that look in real life

413
00:18:34,820 --> 00:18:35,840
with a concrete example?

414
00:18:35,840 --> 00:18:39,669
Now, let's say I'm malware developer.

415
00:18:39,670 --> 00:18:42,550
I program my malware, I
submit it to Dyncheck,

416
00:18:42,550 --> 00:18:44,409
and I see this result.

417
00:18:44,410 --> 00:18:46,590
Avira Internet Security
detecting my software,

418
00:18:46,590 --> 00:18:50,699
my malware with this signature.

419
00:18:50,700 --> 00:18:52,700
I can go on Avira's website

420
00:18:52,700 --> 00:18:54,390
and see if there is any information

421
00:18:54,390 --> 00:18:55,840
about signature online.

422
00:18:55,840 --> 00:18:58,800
There is, and it tells
me that it's a signature

423
00:18:58,800 --> 00:19:00,419
that is supposed to be triggered

424
00:19:00,420 --> 00:19:04,650
when the software modify the MBR

425
00:19:04,650 --> 00:19:07,380
or when it makes a copy of itself

426
00:19:07,380 --> 00:19:10,660
in these two different files.

427
00:19:10,660 --> 00:19:12,660
This way, I can inspect my malware.

428
00:19:12,660 --> 00:19:15,040
Is it checking something in the MBR,

429
00:19:15,040 --> 00:19:16,909
modifying it in any way?

430
00:19:16,910 --> 00:19:19,050
Is it using these two paths?

431
00:19:19,050 --> 00:19:21,430
Are they hard-coded in them or not?

432
00:19:21,430 --> 00:19:24,220
This is the kind of question
it should be asking.

433
00:19:24,220 --> 00:19:26,730
Another very good way to
escape static detection,

434
00:19:26,730 --> 00:19:28,740
of course, are crypters.

435
00:19:28,740 --> 00:19:31,930
So here you have a example of legitimate

436
00:19:31,930 --> 00:19:34,280
and also totally,

437
00:19:34,280 --> 00:19:36,690
the tools that ought to be for criminals,

438
00:19:36,690 --> 00:19:39,090
only to hide malicious intent.

439
00:19:39,090 --> 00:19:41,350
You have Themida and Spartan Crypter.

440
00:19:41,350 --> 00:19:46,350
These two are very useful
to escape static detection,

441
00:19:46,500 --> 00:19:49,450
meaning that they will
encrypt your malware

442
00:19:49,450 --> 00:19:51,530
in particular step at the beginning.

443
00:19:51,530 --> 00:19:53,780
When you execute a nearly
created executable,

444
00:19:55,740 --> 00:19:57,100
the step will decrypt the whole thing

445
00:19:57,100 --> 00:19:59,620
and then execute a malicious payload.

446
00:19:59,620 --> 00:20:00,889
So this is how this would work,

447
00:20:00,890 --> 00:20:02,440
how you would escape detection,

448
00:20:02,440 --> 00:20:03,940
the static detection at least.

449
00:20:05,740 --> 00:20:09,550
Now if you come to actually
finishing your malware

450
00:20:09,550 --> 00:20:11,710
and you want to sell it,

451
00:20:11,710 --> 00:20:15,580
a crucial part of that is
actually advertising your malware.

452
00:20:15,580 --> 00:20:19,290
So what people usually
do is that they actually,

453
00:20:19,290 --> 00:20:21,700
they show an example

454
00:20:21,700 --> 00:20:24,410
of one of the malware running

455
00:20:24,410 --> 00:20:26,990
against an NDS, and saying, "Look,

456
00:20:26,990 --> 00:20:28,087
my malware is a quality product.

457
00:20:28,087 --> 00:20:31,780
It's only detected by
three security vendors

458
00:20:31,780 --> 00:20:35,170
out of 45," which is
pretty good, in my opinion.

459
00:20:35,170 --> 00:20:37,340
Here you have some screenshots

460
00:20:37,340 --> 00:20:41,230
of people selling or advertising, rather,

461
00:20:41,230 --> 00:20:42,620
a information stealer.

462
00:20:42,620 --> 00:20:44,382
You have KPOT, you have Borr,

463
00:20:44,383 --> 00:20:46,420
you have DiamondFox and Oski.

464
00:20:46,420 --> 00:20:48,810
So they go on marketplaces and forums

465
00:20:48,810 --> 00:20:50,740
and actually advertise the product

466
00:20:50,740 --> 00:20:54,433
by linking a link to the analysis.

467
00:20:54,433 --> 00:20:57,810
This is one way to advertise your malware.

468
00:20:57,810 --> 00:21:00,560
Last but not least, using an NDS

469
00:21:00,560 --> 00:21:03,520
to actually monitor the
AV editor's response.

470
00:21:03,520 --> 00:21:04,690
This is something very important.

471
00:21:04,690 --> 00:21:06,680
After you develop your malware,

472
00:21:06,680 --> 00:21:09,680
after you choose a site or
not and you did it, actually,

473
00:21:09,680 --> 00:21:13,400
you are going to actually
exploit your malware in the wide.

474
00:21:13,400 --> 00:21:17,220
To do so, NDS's have two
very useful features,

475
00:21:17,220 --> 00:21:20,010
which, the first one is periodic scans,

476
00:21:20,010 --> 00:21:21,370
meaning, for example,

477
00:21:21,370 --> 00:21:24,520
a threat actor is going to be able to scan

478
00:21:24,520 --> 00:21:27,830
each piece of malware every five days,

479
00:21:27,830 --> 00:21:31,550
and every five days,
he's going to be assured

480
00:21:31,550 --> 00:21:35,720
that his malware is still undetected.

481
00:21:35,720 --> 00:21:37,730
This is something that is
very powerful, in my opinion,

482
00:21:37,730 --> 00:21:40,050
because it allows threat actors

483
00:21:41,080 --> 00:21:44,460
to constantly stay ahead of AV vendors,

484
00:21:44,460 --> 00:21:46,960
meaning that if there
is detection one day,

485
00:21:46,960 --> 00:21:49,410
they can circumvent detection quickly

486
00:21:49,410 --> 00:21:51,140
by identifying the cause

487
00:21:51,140 --> 00:21:54,350
and then churning out a
new release of the malware,

488
00:21:54,350 --> 00:21:57,110
and set it again or use this new version.

489
00:21:57,110 --> 00:21:59,740
This is something that allows
them to stay ahead of the game

490
00:21:59,740 --> 00:22:02,663
that malware editors have
been playing for so long.

491
00:22:03,590 --> 00:22:06,389
Another feature, domain check.

492
00:22:06,390 --> 00:22:08,760
If you are about to launch a campaign,

493
00:22:08,760 --> 00:22:10,030
the last thing you want

494
00:22:10,030 --> 00:22:13,510
is use a C2 that is
already blacklisted, right?

495
00:22:13,510 --> 00:22:16,020
So domain check allows you actually to

496
00:22:17,950 --> 00:22:20,930
check a certain list of URLs

497
00:22:20,930 --> 00:22:22,600
or host of domains

498
00:22:22,600 --> 00:22:25,520
against blacklists that
antivirus vendor uses.

499
00:22:25,520 --> 00:22:27,040
This way, you can be assured

500
00:22:27,040 --> 00:22:29,170
that your campaign's not going to fail

501
00:22:29,170 --> 00:22:31,483
because your C2 is already
blacklisted somewhere.

502
00:22:33,610 --> 00:22:34,899
So let's take a look now

503
00:22:34,900 --> 00:22:38,310
at some less obvious actual uses of NDS.

504
00:22:38,310 --> 00:22:40,803
NDS integrated into crimeware tools.

505
00:22:41,710 --> 00:22:44,240
So, if you look at your right,

506
00:22:44,240 --> 00:22:45,730
you have an example,

507
00:22:45,730 --> 00:22:48,070
a screenshot, sorry, of Cyber Seal,

508
00:22:48,070 --> 00:22:51,373
a crypter that embeds CyberScan in it,

509
00:22:52,290 --> 00:22:54,610
which is NDS, meaning every time

510
00:22:54,610 --> 00:22:59,000
you're going to actually
encrypt a malware with this,

511
00:22:59,000 --> 00:23:01,000
the result of this encryption

512
00:23:01,000 --> 00:23:04,690
is going to be automatically
checked against CyberScan

513
00:23:04,690 --> 00:23:09,023
to see if it is statically
detected by AV vendors.

514
00:23:09,870 --> 00:23:13,229
In my opinion, this is incredible option

515
00:23:13,230 --> 00:23:15,790
which allows threat actors actually

516
00:23:15,790 --> 00:23:18,700
to streamline the process
of encrypting something,

517
00:23:18,700 --> 00:23:22,150
and then checking if the packed result

518
00:23:22,150 --> 00:23:24,410
is actually something detectable or not,

519
00:23:24,410 --> 00:23:26,823
see if something
potentially is very harmful.

520
00:23:28,060 --> 00:23:32,540
This is why every NDS we
surveyed actually have an API,

521
00:23:32,540 --> 00:23:34,180
an application programming interface,

522
00:23:34,180 --> 00:23:37,620
the cells for automation
and integrational tools.

523
00:23:37,620 --> 00:23:38,790
At the center of your screen,

524
00:23:38,790 --> 00:23:42,149
you have a screenshot
of Dyncheck's GitHub,

525
00:23:42,150 --> 00:23:45,800
which have PHP resources and example

526
00:23:45,800 --> 00:23:48,633
to show you how to use their API.

527
00:23:52,510 --> 00:23:54,520
Last but not least, NDS.

528
00:23:54,520 --> 00:23:57,120
Some NDS, we know that Scan4You did it,

529
00:23:57,120 --> 00:24:00,129
and now its successor in term of scale

530
00:24:00,130 --> 00:24:02,383
and successfulness maybe,

531
00:24:03,700 --> 00:24:05,500
is Dyncheck.

532
00:24:05,500 --> 00:24:10,500
They actually propose to be
the back end of other NDS's.

533
00:24:10,840 --> 00:24:13,850
So actually, it's on
Dyncheck official website.

534
00:24:13,850 --> 00:24:15,820
You can actually become
partner distributor

535
00:24:15,820 --> 00:24:18,110
if you wish to have your own NDS server,

536
00:24:18,110 --> 00:24:20,510
NDS service, and you do not
want to be at your back end.

537
00:24:20,510 --> 00:24:23,943
You can actually ask
Dyncheck to do that for you.

538
00:24:26,380 --> 00:24:28,260
Let's jump to key points.

539
00:24:28,260 --> 00:24:31,410
What do you guys remember
from this presentation?

540
00:24:31,410 --> 00:24:35,790
So antivirus is not a
panacea against malware.

541
00:24:35,790 --> 00:24:39,040
This has been said, but this
will be never said enough.

542
00:24:39,040 --> 00:24:40,310
Although we must

543
00:24:41,840 --> 00:24:43,867
remember that these are scans

544
00:24:43,867 --> 00:24:47,860
that are not made with the
internet enabled, usually,

545
00:24:47,860 --> 00:24:50,439
meaning that the whole
cloud-computing aspect

546
00:24:50,440 --> 00:24:51,690
now present in AV vendors

547
00:24:52,575 --> 00:24:54,837
will not be taken into
account through its analysis,

548
00:24:54,837 --> 00:24:57,940
making analysis little bit less real,

549
00:24:57,940 --> 00:24:59,930
as will be in the real world.

550
00:24:59,930 --> 00:25:02,780
So if you could excuse the typo.

551
00:25:02,780 --> 00:25:04,670
Antivirus doesn't stop all threats,

552
00:25:04,670 --> 00:25:06,700
and threat actors are actually monitoring

553
00:25:06,700 --> 00:25:08,203
what AV vendors are doing.

554
00:25:09,660 --> 00:25:10,920
- Another takeaway from this

555
00:25:10,920 --> 00:25:14,610
is that it's important for us
to identify the big players

556
00:25:14,610 --> 00:25:18,250
in any type of cybercriminal
ecosystem, as always, right?

557
00:25:18,250 --> 00:25:22,550
So when we look at different
types of cybercriminal services

558
00:25:22,550 --> 00:25:23,570
that are available,

559
00:25:23,570 --> 00:25:26,179
it is important that
we keep NDS's in mind,

560
00:25:26,180 --> 00:25:30,260
and identify who are the major
sites and players out there.

561
00:25:30,260 --> 00:25:32,020
That was, at one point, Scan4You,

562
00:25:32,020 --> 00:25:34,080
which again, was taken down.

563
00:25:34,080 --> 00:25:36,620
And now, I mean, you've
heard us mention Dyncheck

564
00:25:36,620 --> 00:25:38,370
multiple times in this presentation.

565
00:25:38,370 --> 00:25:39,820
There are others as well.

566
00:25:39,820 --> 00:25:41,520
But this helps us better understand,

567
00:25:41,520 --> 00:25:43,060
as researchers and defenders,

568
00:25:43,060 --> 00:25:45,602
where to invest our
time and our resources.

569
00:25:46,640 --> 00:25:48,730
And finally, malware authors

570
00:25:48,730 --> 00:25:50,490
are giving us a very interesting gift

571
00:25:50,490 --> 00:25:53,120
when they share these AV scan results,

572
00:25:53,120 --> 00:25:56,469
or when they share these
NDS scan results, rather.

573
00:25:56,470 --> 00:25:58,367
We're allowed to take a
look at these and say,

574
00:25:58,367 --> 00:26:02,240
"Okay, what is bypassing antivirus?

575
00:26:02,240 --> 00:26:05,070
What is really getting
through the cracks here?"

576
00:26:05,070 --> 00:26:07,159
And it can allow us to better identify

577
00:26:07,160 --> 00:26:09,060
what's really an up-and-coming malware,

578
00:26:09,060 --> 00:26:10,240
what's really potent,

579
00:26:10,240 --> 00:26:12,520
and what should we prioritize

580
00:26:12,520 --> 00:26:14,283
being prepared to defend against?

581
00:26:16,890 --> 00:26:19,820
So thank you everyone for attending today,

582
00:26:19,820 --> 00:26:22,453
and I guess we'll open
it up for questions now.

