1
00:00:11,090 --> 00:00:17,150
good morning everyone

2
00:00:13,920 --> 00:00:20,130
come to our session about mining botnets

3
00:00:17,150 --> 00:00:23,880
so I'm Leonard and this is my colleague

4
00:00:20,130 --> 00:00:26,360
Benson we're both researchers from Trend

5
00:00:23,880 --> 00:00:26,360
Micro

6
00:00:38,480 --> 00:00:47,550
cryptocurrency so by now we've heard of

7
00:00:42,870 --> 00:00:48,900
this term it's quite popular and it also

8
00:00:47,550 --> 00:00:51,360
have attracted a lot of attention

9
00:00:48,900 --> 00:00:54,989
especially for those seeking to have

10
00:00:51,360 --> 00:01:00,570
more income or have more ways to gain

11
00:00:54,989 --> 00:01:03,500
income so legitimate miners and illegal

12
00:01:00,570 --> 00:01:06,810
miners alike have been attracted to this

13
00:01:03,500 --> 00:01:09,720
cryptocurrency mining as well as several

14
00:01:06,810 --> 00:01:14,490
new cryptocurrencies have emerged in the

15
00:01:09,720 --> 00:01:17,400
past so cyber criminals have been

16
00:01:14,490 --> 00:01:20,759
attracted into buying cryptocurrency

17
00:01:17,400 --> 00:01:23,970
mining botnets and as well as several

18
00:01:20,759 --> 00:01:26,759
malware authors have been encouraged to

19
00:01:23,970 --> 00:01:32,250
produce more mining botanist as time

20
00:01:26,759 --> 00:01:34,650
goes by so in the past year in 2017

21
00:01:32,250 --> 00:01:37,740
we have seen a pattern of increasing

22
00:01:34,650 --> 00:01:41,399
activity of cryptocurrency mining

23
00:01:37,740 --> 00:01:44,960
botnets so if you look at the slides

24
00:01:41,399 --> 00:01:47,490
here it's a record of the activity of

25
00:01:44,960 --> 00:01:51,210
several endpoints connecting to

26
00:01:47,490 --> 00:01:54,210
cryptocurrency mining botnet CNCs as

27
00:01:51,210 --> 00:01:56,490
well as the number of CNCs that have

28
00:01:54,210 --> 00:01:59,690
been active throughout the year so you

29
00:01:56,490 --> 00:02:03,690
can see the pattern that is increasing

30
00:01:59,690 --> 00:02:06,770
so today we will talk about three case

31
00:02:03,690 --> 00:02:10,139
studies basically about three

32
00:02:06,770 --> 00:02:13,709
cryptocurrency mining botnets first

33
00:02:10,139 --> 00:02:16,019
ratted OOP it's originally an info

34
00:02:13,709 --> 00:02:20,370
stealer that's transition to coin mining

35
00:02:16,020 --> 00:02:23,880
dig mine it's a use of popular social

36
00:02:20,370 --> 00:02:24,450
media platform to propagate and I'm

37
00:02:23,880 --> 00:02:28,680
sorry

38
00:02:24,450 --> 00:02:31,739
miner which is currently widely sold in

39
00:02:28,680 --> 00:02:34,470
the underground market so we'll examine

40
00:02:31,740 --> 00:02:39,209
these three families and talk about how

41
00:02:34,470 --> 00:02:42,870
how they gain more victims how they

42
00:02:39,209 --> 00:02:46,320
communicate through their CNCs and what

43
00:02:42,870 --> 00:02:47,620
other attributes they have and also we

44
00:02:46,320 --> 00:02:51,319
will talk about

45
00:02:47,620 --> 00:02:53,599
several coin miner bought bought

46
00:02:51,319 --> 00:02:57,349
capabilities and features that's being

47
00:02:53,599 --> 00:02:59,768
advertised in the underground also some

48
00:02:57,349 --> 00:03:06,709
features that's being requested by

49
00:02:59,769 --> 00:03:10,610
buyers of these botnets so to start off

50
00:03:06,709 --> 00:03:13,970
we talked about residue so let the Dukes

51
00:03:10,610 --> 00:03:17,299
originally a info stealer botnet so an

52
00:03:13,970 --> 00:03:21,650
overview of its info stealer days it's

53
00:03:17,299 --> 00:03:25,700
been coded in Auto it and it's using the

54
00:03:21,650 --> 00:03:29,150
dot a tree X extension so it's version

55
00:03:25,700 --> 00:03:33,470
three of what it which is compressed and

56
00:03:29,150 --> 00:03:36,590
encrypted so its main features are it

57
00:03:33,470 --> 00:03:40,819
has a remote access Trojan capability

58
00:03:36,590 --> 00:03:43,099
which is a full feature it's using key

59
00:03:40,819 --> 00:03:47,298
log beatings for key logging keystrokes

60
00:03:43,099 --> 00:03:51,888
and it steals various credentials like

61
00:03:47,299 --> 00:03:55,609
credentials from browsers Outlook etc so

62
00:03:51,889 --> 00:03:58,579
this version mainly focus on sealing

63
00:03:55,609 --> 00:04:04,879
information though so that's the main

64
00:03:58,579 --> 00:04:07,340
way about the Raptors gain income by

65
00:04:04,879 --> 00:04:12,679
stealing information and selling them to

66
00:04:07,340 --> 00:04:15,799
someone else several buyers and its main

67
00:04:12,680 --> 00:04:21,579
mechanism to spread is via removable

68
00:04:15,799 --> 00:04:26,389
drives so it is a worm basically so

69
00:04:21,579 --> 00:04:29,570
transitioning to coin mining since info

70
00:04:26,389 --> 00:04:31,550
stealer you need to first sell your data

71
00:04:29,570 --> 00:04:32,180
in order to monetize what you have

72
00:04:31,550 --> 00:04:35,780
stolen

73
00:04:32,180 --> 00:04:37,970
however coin mining as long as your

74
00:04:35,780 --> 00:04:41,119
miner is working you're constantly

75
00:04:37,970 --> 00:04:44,750
gaining income without needing to sell

76
00:04:41,120 --> 00:04:47,000
or trade your coins even you can use the

77
00:04:44,750 --> 00:04:50,780
coins directly to buy several stuff from

78
00:04:47,000 --> 00:04:53,780
just about other underground shops so to

79
00:04:50,780 --> 00:04:56,690
transition into mining ratted dope has

80
00:04:53,780 --> 00:05:00,659
split its components so it has now a

81
00:04:56,690 --> 00:05:03,240
separate file for the bot as well as the

82
00:05:00,660 --> 00:05:08,370
rather component which also acts they

83
00:05:03,240 --> 00:05:12,150
say installer so apart from that there's

84
00:05:08,370 --> 00:05:14,910
also the set of mining components so

85
00:05:12,150 --> 00:05:17,969
these are basically coded in Auto it as

86
00:05:14,910 --> 00:05:20,540
a miner as well and they're split into

87
00:05:17,970 --> 00:05:26,460
two distinct architectures mainly for

88
00:05:20,540 --> 00:05:28,620
32-bit and 64-bit so the bot feature of

89
00:05:26,460 --> 00:05:31,320
rata dope has been reduced drastically

90
00:05:28,620 --> 00:05:35,970
no more information staff

91
00:05:31,320 --> 00:05:38,790
no more keystroke logging and that the

92
00:05:35,970 --> 00:05:41,670
rat function which was a before it's

93
00:05:38,790 --> 00:05:44,970
fully functional rat which can totally

94
00:05:41,670 --> 00:05:48,300
take over the victims machine now it's

95
00:05:44,970 --> 00:05:52,290
mainly designed only to manage the

96
00:05:48,300 --> 00:05:56,400
mining activity of red loop so as an

97
00:05:52,290 --> 00:05:58,590
auto it it's required to use the auto it

98
00:05:56,400 --> 00:06:00,659
interpreter so as you can see there's a

99
00:05:58,590 --> 00:06:03,419
component which is a legitimate auto

100
00:06:00,660 --> 00:06:08,210
engine so it's the one that interprets

101
00:06:03,420 --> 00:06:12,960
the bought and the spreader components

102
00:06:08,210 --> 00:06:18,599
so to propagate residue propagates by

103
00:06:12,960 --> 00:06:20,460
removable drives so what does is while

104
00:06:18,600 --> 00:06:23,580
the spreader component is actively

105
00:06:20,460 --> 00:06:27,359
running in the vector machine if you

106
00:06:23,580 --> 00:06:30,210
plug in a removable drive rata Duke will

107
00:06:27,360 --> 00:06:32,790
copy all the content of its installation

108
00:06:30,210 --> 00:06:36,859
folder into the removable drives as well

109
00:06:32,790 --> 00:06:39,570
as on every folder in those drives and

110
00:06:36,860 --> 00:06:42,900
in order for it to have a launching

111
00:06:39,570 --> 00:06:46,260
capability from the removable drives it

112
00:06:42,900 --> 00:06:49,560
will create a shortcut file so this

113
00:06:46,260 --> 00:06:52,550
technique is kind of a quite common in

114
00:06:49,560 --> 00:06:56,430
worms that spread through flash drives

115
00:06:52,550 --> 00:06:59,820
so when we inspect the LNT file this

116
00:06:56,430 --> 00:07:04,260
shortcut file we can see that it's

117
00:06:59,820 --> 00:07:07,530
launching the spreader component as a

118
00:07:04,260 --> 00:07:09,780
parameter for the for the auto eight

119
00:07:07,530 --> 00:07:10,320
engine so the auto eight engine is

120
00:07:09,780 --> 00:07:16,229
missing

121
00:07:10,320 --> 00:07:20,070
legitimate part of it now we talked

122
00:07:16,230 --> 00:07:23,610
about how residue communicates via its

123
00:07:20,070 --> 00:07:27,030
CNC so Retta dope is using the classic

124
00:07:23,610 --> 00:07:30,990
example of beaconing communication so it

125
00:07:27,030 --> 00:07:34,530
sends it beacon to the CNC and wait for

126
00:07:30,990 --> 00:07:37,950
it to reply with any cute tasks or if

127
00:07:34,530 --> 00:07:40,940
there's none it will tell it to sleep

128
00:07:37,950 --> 00:07:43,950
for how long it wants it to sleep

129
00:07:40,940 --> 00:07:48,770
basically there's also the time the CNC

130
00:07:43,950 --> 00:07:52,530
tells the residue when to beacon next so

131
00:07:48,770 --> 00:07:56,039
this is a example of its beacon

132
00:07:52,530 --> 00:07:58,169
communication packet so what it has is

133
00:07:56,040 --> 00:08:00,690
several information that's useful heard

134
00:07:58,170 --> 00:08:04,170
the CNC in order for it to determine

135
00:08:00,690 --> 00:08:06,420
what's the next command to be sent so

136
00:08:04,170 --> 00:08:08,670
first part is a victim ID

137
00:08:06,420 --> 00:08:12,690
it's used by retinue to trap which

138
00:08:08,670 --> 00:08:15,660
victim is which on its control panel in

139
00:08:12,690 --> 00:08:16,940
a hard-coded flag so this is always one

140
00:08:15,660 --> 00:08:20,310
by default

141
00:08:16,940 --> 00:08:22,969
processor count also tells basically how

142
00:08:20,310 --> 00:08:27,750
many processor the victim machine has

143
00:08:22,970 --> 00:08:32,340
useful for mining knowledge and worm

144
00:08:27,750 --> 00:08:34,620
process flag telling the CNC if the worm

145
00:08:32,340 --> 00:08:38,010
process is already running or not so if

146
00:08:34,620 --> 00:08:40,380
it's not running so normally CNC should

147
00:08:38,010 --> 00:08:45,420
tell the bottle you should download the

148
00:08:40,380 --> 00:08:48,740
rider run the minor component so minor

149
00:08:45,420 --> 00:08:51,990
process flag again this is for minor and

150
00:08:48,740 --> 00:08:54,930
the worker folder content so this is

151
00:08:51,990 --> 00:08:57,840
basically the worker folder that we've

152
00:08:54,930 --> 00:09:00,329
seen earlier so if it's not present so

153
00:08:57,840 --> 00:09:03,750
basically residue this needs to download

154
00:09:00,330 --> 00:09:07,560
the minor component and put it into the

155
00:09:03,750 --> 00:09:10,280
worker component and for the victim ID

156
00:09:07,560 --> 00:09:15,780
this is composed of several information

157
00:09:10,280 --> 00:09:19,620
which is then hashed into md5 so they

158
00:09:15,780 --> 00:09:22,130
gather the OS language OS version always

159
00:09:19,620 --> 00:09:24,590
build number processor architecture

160
00:09:22,130 --> 00:09:28,400
and home type cereal so combining this

161
00:09:24,590 --> 00:09:30,980
information their hash into md5 and then

162
00:09:28,400 --> 00:09:34,520
the md5 result will again be hashed into

163
00:09:30,980 --> 00:09:41,180
another md5 and that becomes the victim

164
00:09:34,520 --> 00:09:46,189
ID tag for the current victim so in

165
00:09:41,180 --> 00:09:49,130
response rata Duke will send a encoded

166
00:09:46,190 --> 00:09:51,470
message to the bot so they have two

167
00:09:49,130 --> 00:09:55,640
layers have been coding base64 and

168
00:09:51,470 --> 00:09:59,090
string two hex so there's a quite a

169
00:09:55,640 --> 00:10:02,090
level of difficulty compared to just

170
00:09:59,090 --> 00:10:04,400
plain Tex communication but here's an

171
00:10:02,090 --> 00:10:10,070
example of a response from C&C when

172
00:10:04,400 --> 00:10:14,840
there's no no task on Q so if we decode

173
00:10:10,070 --> 00:10:15,590
it so it's basically a sleep it tells

174
00:10:14,840 --> 00:10:18,620
the bot

175
00:10:15,590 --> 00:10:21,320
sleep for 30 seconds and beacon after

176
00:10:18,620 --> 00:10:24,650
the next 30 seconds again if just to see

177
00:10:21,320 --> 00:10:28,250
there's another task so if there's no

178
00:10:24,650 --> 00:10:31,250
task again yeah the cnc will just tell

179
00:10:28,250 --> 00:10:38,560
him to go sleep again and beacon the

180
00:10:31,250 --> 00:10:41,770
next time so let a dog has several

181
00:10:38,560 --> 00:10:45,829
mining botnet infections already and

182
00:10:41,770 --> 00:10:50,329
there's a one wallet address that we've

183
00:10:45,830 --> 00:10:54,620
been able to monitor from residue using

184
00:10:50,330 --> 00:10:59,600
it to monitor using the public public

185
00:10:54,620 --> 00:11:01,760
mining pool that it's using so the

186
00:10:59,600 --> 00:11:05,930
operation for the mining residue we

187
00:11:01,760 --> 00:11:08,270
observed started on June of 2017 and as

188
00:11:05,930 --> 00:11:11,089
you can see here from the public mining

189
00:11:08,270 --> 00:11:14,329
pool the pattern of the hash rate has

190
00:11:11,090 --> 00:11:20,710
been increasing gradually over the

191
00:11:14,330 --> 00:11:24,410
months that is been active and up to

192
00:11:20,710 --> 00:11:28,610
like March or April of this year the

193
00:11:24,410 --> 00:11:33,540
same pattern could be observed so while

194
00:11:28,610 --> 00:11:36,420
the the fluctuation is quite steady

195
00:11:33,540 --> 00:11:40,400
the overall pattern is increasing

196
00:11:36,420 --> 00:11:47,250
increasing and it maintained quite high

197
00:11:40,400 --> 00:11:50,120
value for its hash rate and in April

198
00:11:47,250 --> 00:11:53,310
early April of this year we've seen that

199
00:11:50,120 --> 00:11:55,620
from the public mining pool hash rate

200
00:11:53,310 --> 00:11:59,430
activity for Reta dope has stopped at

201
00:11:55,620 --> 00:12:02,040
least for this one wallet address so

202
00:11:59,430 --> 00:12:04,079
we're not sure if there's other wallet

203
00:12:02,040 --> 00:12:07,459
address right dope has been using but

204
00:12:04,080 --> 00:12:11,700
for this one it's basically stopped and

205
00:12:07,460 --> 00:12:14,490
the last payment that the total payment

206
00:12:11,700 --> 00:12:20,600
that beretta dope has gained for this

207
00:12:14,490 --> 00:12:24,300
wallet is around 1050 seven Mineiro so

208
00:12:20,600 --> 00:12:29,790
if if the actor cashed it out at that

209
00:12:24,300 --> 00:12:33,930
point in time the value of Manero is 1

210
00:12:29,790 --> 00:12:36,959
Mineiro equals to 162 US dollars so if

211
00:12:33,930 --> 00:12:41,489
you cashed out his coins at that time he

212
00:12:36,960 --> 00:12:45,690
would have total of 171 US dollars give

213
00:12:41,490 --> 00:12:50,029
or take but if we remember that he has a

214
00:12:45,690 --> 00:12:53,209
long span of operation since June 2017

215
00:12:50,029 --> 00:12:56,730
the value of Manero has actually

216
00:12:53,209 --> 00:13:01,410
fluctuated been going up and down during

217
00:12:56,730 --> 00:13:04,800
that time and it peaked at around 400

218
00:13:01,410 --> 00:13:07,319
nearly 500 US dollars so we don't know

219
00:13:04,800 --> 00:13:12,449
when exactly he cashed out his coins if

220
00:13:07,320 --> 00:13:16,050
he cashed it out one by one or he cashed

221
00:13:12,450 --> 00:13:19,740
it out as soon as the mining activity

222
00:13:16,050 --> 00:13:22,979
stopped however this does not mean that

223
00:13:19,740 --> 00:13:27,360
when the residue activity has totally

224
00:13:22,980 --> 00:13:31,320
stopped so residue has actually adapted

225
00:13:27,360 --> 00:13:32,459
to changes so first from using public

226
00:13:31,320 --> 00:13:34,560
mining pools

227
00:13:32,459 --> 00:13:38,029
it has switched into private mining

228
00:13:34,560 --> 00:13:40,859
pools so the reason for this is that

229
00:13:38,029 --> 00:13:43,160
public mining pools have actually tried

230
00:13:40,860 --> 00:13:45,529
to ban what net mine

231
00:13:43,160 --> 00:13:49,209
in their pools they've given several

232
00:13:45,529 --> 00:13:51,800
reasons like ethical reasoning

233
00:13:49,209 --> 00:13:54,410
possibility of them getting banned by

234
00:13:51,800 --> 00:13:55,579
their eyes before being associated with

235
00:13:54,410 --> 00:13:59,709
mining botnets

236
00:13:55,579 --> 00:14:02,599
and also that mining with botanist

237
00:13:59,709 --> 00:14:07,040
negatively affect the legitimate miners

238
00:14:02,600 --> 00:14:08,839
so if mining botnets mine quite fast the

239
00:14:07,040 --> 00:14:11,990
increase in difficulty of the block

240
00:14:08,839 --> 00:14:14,180
chains may may be may increase quicker

241
00:14:11,990 --> 00:14:17,540
and that will affect you just admit

242
00:14:14,180 --> 00:14:20,089
miners quicker so to compensate for this

243
00:14:17,540 --> 00:14:22,939
change in the public mining pool

244
00:14:20,089 --> 00:14:26,209
Retta dupe has constructed its own

245
00:14:22,939 --> 00:14:29,870
private mining pool and it's activity

246
00:14:26,209 --> 00:14:35,768
now is with its private mining pool so

247
00:14:29,870 --> 00:14:40,160
much harder to monitor second adaptation

248
00:14:35,769 --> 00:14:45,019
rata dope has done is that it's switch

249
00:14:40,160 --> 00:14:47,120
from auto it into autohotkey so the

250
00:14:45,019 --> 00:14:48,560
benefit it gained from switching to a

251
00:14:47,120 --> 00:14:51,410
different scripting language is that

252
00:14:48,560 --> 00:14:56,018
since the autohotkey version is now a

253
00:14:51,410 --> 00:15:00,319
pure script no encoding no encryption no

254
00:14:56,019 --> 00:15:03,410
compression so it's able to utilize a

255
00:15:00,319 --> 00:15:08,000
polymorphic routine every time residue

256
00:15:03,410 --> 00:15:10,040
propagates it adds random line which is

257
00:15:08,000 --> 00:15:13,850
commented out so it has nothing to do

258
00:15:10,040 --> 00:15:17,889
with actual code so however the hash of

259
00:15:13,850 --> 00:15:20,389
the new copy is different every time and

260
00:15:17,889 --> 00:15:24,170
aside from the added line it also

261
00:15:20,389 --> 00:15:27,649
changes the variable names so that it

262
00:15:24,170 --> 00:15:31,729
further becomes polymorphic so different

263
00:15:27,649 --> 00:15:33,920
hash for different instance however not

264
00:15:31,730 --> 00:15:37,550
all components have been switched to

265
00:15:33,920 --> 00:15:40,639
autohotkey the mining component ready to

266
00:15:37,550 --> 00:15:43,128
be used is still using auto it the main

267
00:15:40,639 --> 00:15:48,920
components that's been switched are the

268
00:15:43,129 --> 00:15:51,290
spreader and the but also behavior

269
00:15:48,920 --> 00:15:54,219
that's been observed not only from

270
00:15:51,290 --> 00:15:56,329
residue but also from other botanist is

271
00:15:54,220 --> 00:15:58,610
previously in there earlier

272
00:15:56,329 --> 00:16:02,049
versions they're running they're minor

273
00:15:58,610 --> 00:16:05,029
components as totally a command line and

274
00:16:02,049 --> 00:16:08,170
when you check any process monitoring

275
00:16:05,029 --> 00:16:11,809
tool you will see the arguments that's

276
00:16:08,170 --> 00:16:14,238
greatly related to mining so in one look

277
00:16:11,809 --> 00:16:18,799
you can see that it's for mining there's

278
00:16:14,239 --> 00:16:21,679
a algorithm type the mining pool address

279
00:16:18,799 --> 00:16:26,559
as well as the wallet address used by

280
00:16:21,679 --> 00:16:31,160
the users of this mining botnets however

281
00:16:26,559 --> 00:16:34,639
they've been being cautious recently so

282
00:16:31,160 --> 00:16:37,189
they they switch the the mode for their

283
00:16:34,639 --> 00:16:39,439
mining component so instead of putting

284
00:16:37,189 --> 00:16:42,049
all those information as arguments

285
00:16:39,439 --> 00:16:45,738
they're now put inside configuration

286
00:16:42,049 --> 00:16:48,410
files and that configuration file alone

287
00:16:45,739 --> 00:16:50,689
is the argument for the mining component

288
00:16:48,410 --> 00:16:54,350
so when you see here this is a notepad

289
00:16:50,689 --> 00:16:57,319
with a certain argument quite suspicious

290
00:16:54,350 --> 00:17:01,419
still but you will no longer be able to

291
00:16:57,319 --> 00:17:04,279
determine easily that it's a miner

292
00:17:01,419 --> 00:17:08,349
so those are the changes that residue

293
00:17:04,279 --> 00:17:08,349
pass adapted for mining purposes

294
00:17:08,529 --> 00:17:19,429
now we inspect dig mine so this one took

295
00:17:14,209 --> 00:17:22,279
advantage of social media platform quite

296
00:17:19,429 --> 00:17:28,970
a significant difference from the way

297
00:17:22,279 --> 00:17:32,090
residue spreads so dig mine also has

298
00:17:28,970 --> 00:17:35,320
several components so it has a browser

299
00:17:32,090 --> 00:17:40,279
extension used for propagation a minor

300
00:17:35,320 --> 00:17:42,350
component which manages the minor minor

301
00:17:40,279 --> 00:17:44,450
bots which manages the minor component

302
00:17:42,350 --> 00:17:47,240
and the downloader the downloader

303
00:17:44,450 --> 00:17:53,299
basically is also the installer

304
00:17:47,240 --> 00:17:59,450
component of a dig mine so dig mine

305
00:17:53,299 --> 00:18:03,649
propagates by Facebook so dig mine

306
00:17:59,450 --> 00:18:07,010
launches Facebook launches chrome with

307
00:18:03,649 --> 00:18:11,290
this argument so basically the

308
00:18:07,010 --> 00:18:14,960
Extension component is not from any

309
00:18:11,290 --> 00:18:17,389
browser extension component store or for

310
00:18:14,960 --> 00:18:20,360
example Google Google store it's

311
00:18:17,390 --> 00:18:24,290
downloaded from the CNC and installed

312
00:18:20,360 --> 00:18:27,949
locally normally Chrome will not load

313
00:18:24,290 --> 00:18:32,740
this kind of extension however if Chrome

314
00:18:27,950 --> 00:18:37,220
is already running the hot will first

315
00:18:32,740 --> 00:18:38,870
terminate Chrome so and then relaunch it

316
00:18:37,220 --> 00:18:41,510
with this argument so this argument

317
00:18:38,870 --> 00:18:46,449
basically allows a chrome to load a

318
00:18:41,510 --> 00:18:48,940
local component that's not from any safe

319
00:18:46,450 --> 00:18:54,020
location or safe source

320
00:18:48,940 --> 00:18:56,480
so once browser extension is loaded it

321
00:18:54,020 --> 00:19:00,320
will download further scripts from its

322
00:18:56,480 --> 00:19:05,500
CNC and those scripts basically contain

323
00:19:00,320 --> 00:19:09,169
more functions for example the main

324
00:19:05,500 --> 00:19:13,460
function it has is interact with

325
00:19:09,170 --> 00:19:16,850
Facebook and upload a file from its CNC

326
00:19:13,460 --> 00:19:18,880
to Facebook server which is it's

327
00:19:16,850 --> 00:19:21,860
basically the downloader component

328
00:19:18,880 --> 00:19:25,550
afterwards it will search your friends

329
00:19:21,860 --> 00:19:29,629
list and message each of your friends to

330
00:19:25,550 --> 00:19:33,020
check out this movie file so the

331
00:19:29,630 --> 00:19:35,540
uploaded the downloaded component will

332
00:19:33,020 --> 00:19:38,740
be will be an attachment for your

333
00:19:35,540 --> 00:19:43,490
message to your friends so this is how

334
00:19:38,740 --> 00:19:49,370
Digg mines spread and while it it is

335
00:19:43,490 --> 00:19:52,310
quite a fast spreading mechanism a lot

336
00:19:49,370 --> 00:19:56,179
of people using Facebook it's also quite

337
00:19:52,310 --> 00:19:58,010
noisy so people have to download the

338
00:19:56,180 --> 00:20:01,610
downloader from their friends message

339
00:19:58,010 --> 00:20:05,240
and run it so cautious users might first

340
00:20:01,610 --> 00:20:10,870
ask their friends deduce and this one so

341
00:20:05,240 --> 00:20:14,780
it's kind of a an opt-out type of

342
00:20:10,870 --> 00:20:17,370
spreading where the user has to has to

343
00:20:14,780 --> 00:20:22,649
say don't want to

344
00:20:17,370 --> 00:20:24,899
this one and infection while the

345
00:20:22,650 --> 00:20:29,370
spreading is successful via the

346
00:20:24,900 --> 00:20:33,150
messenger if a user downloading it and

347
00:20:29,370 --> 00:20:40,110
running the downloader is not guaranteed

348
00:20:33,150 --> 00:20:43,110
in this scenario so how big mine

349
00:20:40,110 --> 00:20:48,570
communicates to its CNC is quite

350
00:20:43,110 --> 00:20:53,010
different from from our attitude so this

351
00:20:48,570 --> 00:20:59,070
is a packet construction code from code

352
00:20:53,010 --> 00:21:03,510
of digne so we see it it uses a get

353
00:20:59,070 --> 00:21:07,139
request for its CNC communication the

354
00:21:03,510 --> 00:21:09,980
main notable trait of this packet is

355
00:21:07,140 --> 00:21:13,679
that the header info contains specific

356
00:21:09,980 --> 00:21:18,450
information that's specific to take mine

357
00:21:13,679 --> 00:21:21,840
so it mainly uses user agent called

358
00:21:18,450 --> 00:21:24,330
miner so user agent change depends on

359
00:21:21,840 --> 00:21:28,439
for example what browser you use to

360
00:21:24,330 --> 00:21:31,470
communicate to the website so if you use

361
00:21:28,440 --> 00:21:34,920
for example testing to communicate using

362
00:21:31,470 --> 00:21:38,820
a browser so you your user agent is not

363
00:21:34,920 --> 00:21:45,800
minor CNC of dig mine will reply with a

364
00:21:38,820 --> 00:21:50,010
different content so this is the

365
00:21:45,800 --> 00:21:52,110
response communication from the CNC so

366
00:21:50,010 --> 00:21:53,940
as you can see compared to residue of

367
00:21:52,110 --> 00:21:58,020
this has no added protection it's

368
00:21:53,940 --> 00:22:01,370
basically in text even the download of a

369
00:21:58,020 --> 00:22:04,050
binary sustained text for this one and

370
00:22:01,370 --> 00:22:07,139
another major difference of dig mine

371
00:22:04,050 --> 00:22:11,210
communication to read how it utilizes

372
00:22:07,140 --> 00:22:15,510
CNC is it's basically just download

373
00:22:11,210 --> 00:22:18,900
components from the CNC and it just

374
00:22:15,510 --> 00:22:20,670
checks if for example what component or

375
00:22:18,900 --> 00:22:23,370
the browser extension component is

376
00:22:20,670 --> 00:22:24,230
present in victim machine if not

377
00:22:23,370 --> 00:22:28,399
download

378
00:22:24,230 --> 00:22:32,090
CNC so different use it basically does

379
00:22:28,400 --> 00:22:35,299
not wait for any command just that CNC

380
00:22:32,090 --> 00:22:41,090
is mainly used as a component repository

381
00:22:35,299 --> 00:22:43,850
for big mine so now we move on to the

382
00:22:41,090 --> 00:22:50,780
I'm sorry coin miner so I give to my

383
00:22:43,850 --> 00:22:53,178
partner Benson okay so thanks Leonard so

384
00:22:50,780 --> 00:22:54,799
let's continue I'm sorry it's one of the

385
00:22:53,179 --> 00:22:57,740
most active coin mining what we're

386
00:22:54,799 --> 00:22:59,600
seeing today so so far we've come across

387
00:22:57,740 --> 00:23:02,179
two version so British online is

388
00:22:59,600 --> 00:23:04,459
composed of a minor component which is

389
00:23:02,179 --> 00:23:07,600
just X Emery an open-source manera minor

390
00:23:04,460 --> 00:23:10,730
and a bot component the minor controller

391
00:23:07,600 --> 00:23:13,010
then progression to the bot component

392
00:23:10,730 --> 00:23:15,080
became a loader bot component it can

393
00:23:13,010 --> 00:23:17,990
download additional modules from the CNC

394
00:23:15,080 --> 00:23:20,449
so this includes the minor then the

395
00:23:17,990 --> 00:23:22,520
minor became a minor injector component

396
00:23:20,450 --> 00:23:26,419
it will inject the actual minor into

397
00:23:22,520 --> 00:23:29,179
memory so this is one of the example

398
00:23:26,419 --> 00:23:30,410
where we saw I am sorry it is disguise

399
00:23:29,179 --> 00:23:33,280
as bomb squad

400
00:23:30,410 --> 00:23:36,799
so bonus bot is supposed to be a

401
00:23:33,280 --> 00:23:39,049
universal bot collector yeah universal

402
00:23:36,799 --> 00:23:40,910
bonus collector it promises to pay out a

403
00:23:39,049 --> 00:23:44,450
few dollars per day just by installing

404
00:23:40,910 --> 00:23:48,169
it so once this bonus pot is installed

405
00:23:44,450 --> 00:23:51,410
the bot gets executed and the bot will

406
00:23:48,169 --> 00:23:54,650
download and install the minor component

407
00:23:51,410 --> 00:23:56,330
the Windows then Windows the minor

408
00:23:54,650 --> 00:24:01,100
component will inject the minor into a

409
00:23:56,330 --> 00:24:04,309
triplet exe so the communication

410
00:24:01,100 --> 00:24:06,530
protocol is done in plain text the HW ID

411
00:24:04,309 --> 00:24:09,350
here is used to identify individual

412
00:24:06,530 --> 00:24:10,820
victims so ditch the number is taken

413
00:24:09,350 --> 00:24:15,500
from volume serial number which is

414
00:24:10,820 --> 00:24:17,870
supposed to be quite unique so this is

415
00:24:15,500 --> 00:24:19,850
the above part that's the initial C&C

416
00:24:17,870 --> 00:24:22,549
communication of the bot communicating

417
00:24:19,850 --> 00:24:26,090
to the C&C that it is alive and waiting

418
00:24:22,549 --> 00:24:27,980
for a task then the CSE will reply

419
00:24:26,090 --> 00:24:31,620
something like this the usual HTTP

420
00:24:27,980 --> 00:24:34,320
headers followed by some tests so each

421
00:24:31,620 --> 00:24:37,830
is composed of three parts the task type

422
00:24:34,320 --> 00:24:40,020
the download link and a task ID so the

423
00:24:37,830 --> 00:24:43,110
task type could be download and execute

424
00:24:40,020 --> 00:24:46,760
or update both are used for downloading

425
00:24:43,110 --> 00:24:51,689
additional components but update will

426
00:24:46,760 --> 00:24:54,750
will replace an existing file so going

427
00:24:51,690 --> 00:24:57,840
back after executing a task after

428
00:24:54,750 --> 00:25:00,750
completing a task the bot will reply

429
00:24:57,840 --> 00:25:07,709
this one so the task status completed

430
00:25:00,750 --> 00:25:10,080
followed by the task ID so this is the

431
00:25:07,710 --> 00:25:12,600
control panel for I am sorry it's mainly

432
00:25:10,080 --> 00:25:14,669
used for tracking record BOTS so how

433
00:25:12,600 --> 00:25:18,120
many are still active so you can see

434
00:25:14,670 --> 00:25:21,050
here are the HW ID and then for the

435
00:25:18,120 --> 00:25:27,409
location you can see that it's well it's

436
00:25:21,050 --> 00:25:32,240
infecting everywhere then this is the

437
00:25:27,410 --> 00:25:32,240
for a peaking test so for sending tasks

438
00:25:33,470 --> 00:25:38,580
so aside from I am sorry dig mine

439
00:25:36,540 --> 00:25:40,170
residue so let's take a look at some of

440
00:25:38,580 --> 00:25:43,110
the koi mine what's being sold in the

441
00:25:40,170 --> 00:25:44,670
underground market so of course

442
00:25:43,110 --> 00:25:47,250
different sellers will have different

443
00:25:44,670 --> 00:25:49,460
feature sets however there seems to be

444
00:25:47,250 --> 00:25:52,980
some items that has to be always there

445
00:25:49,460 --> 00:25:55,650
so for example this one silent mining

446
00:25:52,980 --> 00:25:58,590
silent miner persistence idle checking

447
00:25:55,650 --> 00:26:01,320
no drops also the no drops here is

448
00:25:58,590 --> 00:26:03,240
basically saying that it will not drop

449
00:26:01,320 --> 00:26:06,419
additional component everything is

450
00:26:03,240 --> 00:26:08,309
packaged inside a single executable then

451
00:26:06,420 --> 00:26:13,010
send me a few D the fully under tech

452
00:26:08,309 --> 00:26:16,530
table another example again silent miner

453
00:26:13,010 --> 00:26:22,740
fu d startup which is persistence

454
00:26:16,530 --> 00:26:26,399
then a USB spreading another example

455
00:26:22,740 --> 00:26:34,080
again silent miner heat and start up

456
00:26:26,400 --> 00:26:38,049
which is persistence again a few D

457
00:26:34,080 --> 00:26:40,299
so to summarize the features this 5ir

458
00:26:38,049 --> 00:26:44,139
seems to be the most important one so

459
00:26:40,299 --> 00:26:46,690
when I first read about the silent or

460
00:26:44,140 --> 00:26:48,669
hidden my first impression is that are

461
00:26:46,690 --> 00:26:50,950
they using some kind of fruit kit but

462
00:26:48,669 --> 00:26:52,840
actually no the strategy is very simple

463
00:26:50,950 --> 00:26:55,450
they monitored the list of planning

464
00:26:52,840 --> 00:26:57,549
applications and if there's a match with

465
00:26:55,450 --> 00:26:59,289
their forbidden list which is a list of

466
00:26:57,549 --> 00:27:02,110
common system monitoring applications

467
00:26:59,289 --> 00:27:04,030
they determinate the binary basically

468
00:27:02,110 --> 00:27:07,000
they are trying to prevent the user from

469
00:27:04,030 --> 00:27:10,990
seeing the minor having a high CPU

470
00:27:07,000 --> 00:27:14,409
utilization then single installation

471
00:27:10,990 --> 00:27:16,570
file if your target victim have to do

472
00:27:14,409 --> 00:27:20,110
several steps they will probably not do

473
00:27:16,570 --> 00:27:22,570
it so what the buyers want is a single

474
00:27:20,110 --> 00:27:24,850
executable that will do all of the

475
00:27:22,570 --> 00:27:26,830
installation process for them so this

476
00:27:24,850 --> 00:27:28,750
can be as simple as a self-extracting

477
00:27:26,830 --> 00:27:30,939
archive that will drop all of the

478
00:27:28,750 --> 00:27:32,740
required components or for the more

479
00:27:30,940 --> 00:27:34,929
advanced version it would probably

480
00:27:32,740 --> 00:27:40,960
download additional components from the

481
00:27:34,929 --> 00:27:43,570
CNC fully undetectable basically this

482
00:27:40,960 --> 00:27:46,000
service is checking if your binary is

483
00:27:43,570 --> 00:27:48,730
already detected by AV vendors or not if

484
00:27:46,000 --> 00:27:49,480
it's detected it gets repack probably

485
00:27:48,730 --> 00:27:51,909
several times

486
00:27:49,480 --> 00:27:55,150
once it is no longer it detected it

487
00:27:51,909 --> 00:27:57,880
yourself again so this is probably the

488
00:27:55,150 --> 00:28:00,640
most expensive feature a standard coin

489
00:27:57,880 --> 00:28:03,490
mining bots cost around $10 well those

490
00:28:00,640 --> 00:28:06,850
that promises some kind of fvd is almost

491
00:28:03,490 --> 00:28:08,830
about that then depends on the service

492
00:28:06,850 --> 00:28:15,610
level agreement that you want the price

493
00:28:08,830 --> 00:28:18,000
can really goes up persistence so

494
00:28:15,610 --> 00:28:21,010
anything to execute the malware on

495
00:28:18,000 --> 00:28:23,440
reboot so it can be scheduled tasks

496
00:28:21,010 --> 00:28:26,169
service draw file in start-up or

497
00:28:23,440 --> 00:28:28,659
registry but it seems that the most

498
00:28:26,169 --> 00:28:32,200
popular ones are the most persistent one

499
00:28:28,659 --> 00:28:34,510
are you seeing schedule tests so for

500
00:28:32,200 --> 00:28:36,580
example for this one it uses the repeat

501
00:28:34,510 --> 00:28:39,070
pass every one minute so with the right

502
00:28:36,580 --> 00:28:43,980
settings it can execute the malware or

503
00:28:39,070 --> 00:28:43,980
the bot every time it is terminated

504
00:28:44,900 --> 00:28:50,240
then take our message so anything to

505
00:28:47,660 --> 00:28:53,780
fool the user it can be a simple as a

506
00:28:50,240 --> 00:28:55,940
fake error or maybe a video image a

507
00:28:53,780 --> 00:28:57,560
document so anything to prevent the user

508
00:28:55,940 --> 00:29:01,730
from thinking that something wrong has

509
00:28:57,560 --> 00:29:05,179
happened then aside from those five

510
00:29:01,730 --> 00:29:07,610
features most potential buyers are

511
00:29:05,180 --> 00:29:09,230
requesting for a spreader feature so

512
00:29:07,610 --> 00:29:13,969
they want their BOTS to spread through

513
00:29:09,230 --> 00:29:16,760
social media to USB but still most

514
00:29:13,970 --> 00:29:18,590
sellers are seems to be not willing to

515
00:29:16,760 --> 00:29:21,370
provide this kind of feature which is

516
00:29:18,590 --> 00:29:24,110
good a free trial version

517
00:29:21,370 --> 00:29:26,629
someone has to vouch or guarantee that

518
00:29:24,110 --> 00:29:29,540
what what you're selling is working so

519
00:29:26,630 --> 00:29:31,610
someone from the community can can get a

520
00:29:29,540 --> 00:29:35,030
sample of your bot they will check there

521
00:29:31,610 --> 00:29:36,919
it's hashing great evasion capability

522
00:29:35,030 --> 00:29:39,710
that will post something like mass miner

523
00:29:36,920 --> 00:29:43,910
on the market then of course with a

524
00:29:39,710 --> 00:29:47,030
somewhat lower price okay so to

525
00:29:43,910 --> 00:29:48,440
summarize so cyber criminals are moving

526
00:29:47,030 --> 00:29:50,899
from their usual models into

527
00:29:48,440 --> 00:29:53,360
cryptocurrency mining currently it's

528
00:29:50,900 --> 00:29:55,940
probably the most effective way for them

529
00:29:53,360 --> 00:29:56,419
to earn money mining bots will continue

530
00:29:55,940 --> 00:29:59,540
to improve

531
00:29:56,420 --> 00:30:02,330
we've already saw what's propagating

532
00:29:59,540 --> 00:30:05,060
through social media to us be better

533
00:30:02,330 --> 00:30:08,240
persistence and evasion we've saw them

534
00:30:05,060 --> 00:30:10,070
fully utilizing scheduled tasks we saw

535
00:30:08,240 --> 00:30:14,060
them trying to evade process system

536
00:30:10,070 --> 00:30:17,000
monitoring processes they don't execute

537
00:30:14,060 --> 00:30:20,480
when the CPU utilization side work

538
00:30:17,000 --> 00:30:24,320
around on restrictions we've saw mining

539
00:30:20,480 --> 00:30:27,140
bots were banned on mining pool so they

540
00:30:24,320 --> 00:30:29,149
created their own private pool so as

541
00:30:27,140 --> 00:30:31,340
long as cryptocurrency mining remains

542
00:30:29,150 --> 00:30:33,350
profitable and of low risk to cyber

543
00:30:31,340 --> 00:30:35,840
criminals they will definitely keep on

544
00:30:33,350 --> 00:30:41,060
improving and find ways to evade our

545
00:30:35,840 --> 00:30:42,500
current solution and applied sides so

546
00:30:41,060 --> 00:30:45,110
after this session what would we

547
00:30:42,500 --> 00:30:47,840
recommend you to do the number one would

548
00:30:45,110 --> 00:30:49,699
be listen to your fans the computer fans

549
00:30:47,840 --> 00:30:54,020
to be exact so if you turn off

550
00:30:49,700 --> 00:30:55,790
everything except OS then your fans

551
00:30:54,020 --> 00:30:57,570
still spinning loudly it could be an

552
00:30:55,790 --> 00:31:00,670
indicator that something

553
00:30:57,570 --> 00:31:03,659
then the second one while not totally

554
00:31:00,670 --> 00:31:06,070
related to our presentation it's still

555
00:31:03,660 --> 00:31:09,760
related to coin mining attacks as a

556
00:31:06,070 --> 00:31:11,620
whole so checker Khalid counts one of

557
00:31:09,760 --> 00:31:14,080
the common scenarios that we are seeing

558
00:31:11,620 --> 00:31:17,889
is that hackers are somehow able to get

559
00:31:14,080 --> 00:31:20,590
your AWS account and then they create

560
00:31:17,890 --> 00:31:24,010
multiple instances just to do mining so

561
00:31:20,590 --> 00:31:28,959
yeah check your college account protect

562
00:31:24,010 --> 00:31:30,850
them secure those images then in three

563
00:31:28,960 --> 00:31:32,860
months do a regular awareness training

564
00:31:30,850 --> 00:31:34,750
phishing training so this kind of tax

565
00:31:32,860 --> 00:31:36,879
still involves social engineering so

566
00:31:34,750 --> 00:31:39,670
always be on the lookout for for new

567
00:31:36,880 --> 00:31:42,820
kinds of tax for new techniques then in

568
00:31:39,670 --> 00:31:45,010
six months have a monitoring system so

569
00:31:42,820 --> 00:31:46,929
it's best if you have a monitoring

570
00:31:45,010 --> 00:31:49,510
system that can provide actionable

571
00:31:46,930 --> 00:31:52,030
threat intelligence so this way your

572
00:31:49,510 --> 00:31:55,150
security team can provide a better

573
00:31:52,030 --> 00:31:57,940
solution and react faster then develop a

574
00:31:55,150 --> 00:31:59,770
proactive incident response strategy so

575
00:31:57,940 --> 00:32:03,400
always to learn from each attack and

576
00:31:59,770 --> 00:32:06,850
find ways to counter to prevent the same

577
00:32:03,400 --> 00:32:08,020
attack from happening again so thank you

578
00:32:06,850 --> 00:32:15,869
very much and

579
00:32:27,410 --> 00:32:30,070
okay

580
00:32:33,230 --> 00:32:36,130
yes

581
00:32:48,570 --> 00:32:58,020
do you mean the coin hive minor yeah so

582
00:32:53,850 --> 00:32:58,020
can you repeat the question again

583
00:33:06,170 --> 00:33:12,840
so for those kinds of minor so they

584
00:33:09,510 --> 00:33:16,920
they're basically from there they're

585
00:33:12,840 --> 00:33:19,800
like replacement to ads so what we see

586
00:33:16,920 --> 00:33:23,640
recently is that there are also similar

587
00:33:19,800 --> 00:33:27,960
technologies to add ad blocks so I think

588
00:33:23,640 --> 00:33:31,620
those are also a bit effective to fight

589
00:33:27,960 --> 00:33:36,720
against those coin miners which are like

590
00:33:31,620 --> 00:33:40,620
coin hype that replaces the ads so I

591
00:33:36,720 --> 00:33:42,360
think for now those are the one of the

592
00:33:40,620 --> 00:33:45,199
good tools we can use against these

593
00:33:42,360 --> 00:33:45,199
kinds of minors

594
00:34:08,040 --> 00:34:15,609
so you mean the feature testing for

595
00:34:12,040 --> 00:34:19,330
static detection there's a sort of like

596
00:34:15,609 --> 00:34:23,129
underground underground scanners like

597
00:34:19,330 --> 00:34:27,330
similar to virustotal services but some

598
00:34:23,129 --> 00:34:30,190
malware authors they have like a trust

599
00:34:27,330 --> 00:34:32,230
with these service providers that they

600
00:34:30,190 --> 00:34:35,619
trust these service providers will not

601
00:34:32,230 --> 00:34:38,290
share samples they're scanning so for

602
00:34:35,619 --> 00:34:43,090
static detections they use these

603
00:34:38,290 --> 00:34:46,379
services for behavioral we have not seen

604
00:34:43,090 --> 00:34:49,899
any specific service but we do know some

605
00:34:46,379 --> 00:34:52,779
people who vouch for the effectivity of

606
00:34:49,899 --> 00:34:56,710
these miners they they have their own

607
00:34:52,780 --> 00:34:59,859
way of testing like drops several

608
00:34:56,710 --> 00:35:04,210
components it's quite noisy it's coated

609
00:34:59,859 --> 00:35:06,819
in this for example coded in auto it and

610
00:35:04,210 --> 00:35:09,970
it's quite big so they will have some

611
00:35:06,820 --> 00:35:14,550
testing for that but it's like every

612
00:35:09,970 --> 00:35:14,549
voucher has his own way of testing laws

613
00:35:37,440 --> 00:35:42,750
so if no more questions thank you for

614
00:35:40,420 --> 00:35:47,329
attending our session good morning

