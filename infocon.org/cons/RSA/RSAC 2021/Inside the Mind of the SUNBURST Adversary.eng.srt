1
00:00:01,500 --> 00:00:06,500
- Welcome to Inside the Mind
of the SUNBURST Adversary.

2
00:00:07,650 --> 00:00:09,600
My name is Marco Figueroa

3
00:00:09,600 --> 00:00:13,484
I'm a principle threat
researcher at SentinelOne.

4
00:00:13,484 --> 00:00:16,430
Before joining SentinelOne,

5
00:00:16,430 --> 00:00:19,483
I was at Intel for the last seven years.

6
00:00:20,520 --> 00:00:22,590
And it was an amazing ride.

7
00:00:22,590 --> 00:00:26,060
Before that I was at
McAfee then Booz Allen.

8
00:00:26,060 --> 00:00:30,869
But today I wanna enter the
mindset of the adversary.

9
00:00:30,870 --> 00:00:33,660
Supply-chain attacks are here to stay.

10
00:00:33,660 --> 00:00:36,775
We've seen over the last couple of years,

11
00:00:36,776 --> 00:00:41,010
NotPetya, CCleaner and now SolarWinds.

12
00:00:41,010 --> 00:00:43,710
I wanted the rate, the supply chain attack

13
00:00:43,710 --> 00:00:47,070
against pass supply and chain attacks

14
00:00:47,070 --> 00:00:51,130
While describing how
threat actors took the risk

15
00:00:51,130 --> 00:00:53,563
which led to their detection.

16
00:00:54,490 --> 00:00:58,170
The sunburst adversaries
went after core developers

17
00:00:58,170 --> 00:01:01,630
because they knew if they
infiltrated their machines

18
00:01:01,630 --> 00:01:05,209
it would help them
understand the coding style,

19
00:01:05,209 --> 00:01:09,449
help compromise the bill
process and make it much easier.

20
00:01:09,450 --> 00:01:12,930
And I believe every organization
should have that mindset

21
00:01:12,930 --> 00:01:17,323
of the adversary from the
blue team to developers.

22
00:01:19,360 --> 00:01:22,980
Now the anatomy of the SolarWinds attack

23
00:01:22,980 --> 00:01:25,100
this is an ongoing saga.

24
00:01:25,100 --> 00:01:27,419
We know it was special operations.

25
00:01:27,420 --> 00:01:31,510
Every single month a report
has come out on SolarWinds.

26
00:01:31,510 --> 00:01:34,710
Stage one was modifying the build process.

27
00:01:34,710 --> 00:01:39,710
Stage two was, they had
a menu of 17,000 victims

28
00:01:41,010 --> 00:01:45,360
to pick from which included
nine government agencies.

29
00:01:45,360 --> 00:01:48,380
They asked themselves, what do I want?

30
00:01:48,380 --> 00:01:52,220
The first thing they
did was steal the keys

31
00:01:52,220 --> 00:01:54,010
to the Orion platform.

32
00:01:54,010 --> 00:01:59,010
The second was specific
targeting of emails, documents.

33
00:01:59,050 --> 00:02:04,050
The third was based on targeting
the victims source code

34
00:02:04,210 --> 00:02:05,512
as well as software.

35
00:02:07,230 --> 00:02:10,810
Now we're gonna go into
the SUNBURST timeline.

36
00:02:10,810 --> 00:02:14,683
The initial access to SolarWinds, right?

37
00:02:15,600 --> 00:02:19,230
What SolarWinds provided
because this presentation

38
00:02:19,230 --> 00:02:22,840
this premise is based off
of the SolarWinds timeline

39
00:02:22,840 --> 00:02:23,890
released in February.

40
00:02:25,880 --> 00:02:29,680
SolarWinds provided insight
into the threat actors events

41
00:02:29,680 --> 00:02:32,050
that led to the supply chain attack.

42
00:02:32,050 --> 00:02:35,900
Looking at this timeline, I
immediately thought to myself

43
00:02:35,900 --> 00:02:37,810
how is it possible?

44
00:02:37,810 --> 00:02:40,950
In eight days, the threat
actor penetrated the network

45
00:02:40,950 --> 00:02:44,220
and knew precisely where
to inject test code

46
00:02:44,220 --> 00:02:45,663
in the Orion platform.

47
00:02:46,523 --> 00:02:49,180
That was very odd to me.

48
00:02:49,180 --> 00:02:52,020
Immediately it stuck out once
I looked at that timeline

49
00:02:52,020 --> 00:02:53,110
as a hacker.

50
00:02:53,110 --> 00:02:57,710
As I mentioned before, I
first began to research.

51
00:02:57,710 --> 00:03:00,993
When did the penetration I think occurred?

52
00:03:02,530 --> 00:03:06,750
And I decided, hey, let me
put on my red team hat on

53
00:03:06,750 --> 00:03:10,610
and let me do the initial
reconnaissance, right?

54
00:03:10,610 --> 00:03:15,540
But before I go into that, I
wanna say transparency is key.

55
00:03:15,540 --> 00:03:18,762
SolarWinds was likely compromised by SVR

56
00:03:18,762 --> 00:03:23,253
which is Russia's Foreign
Intelligence Service.

57
00:03:24,120 --> 00:03:28,300
I say likely because the White
House in a press briefing

58
00:03:28,300 --> 00:03:32,570
said it has high confidence
in its assessment

59
00:03:32,570 --> 00:03:35,222
of the attribution to the SVR.

60
00:03:36,460 --> 00:03:40,870
But what I think is very
important is the transparency

61
00:03:40,870 --> 00:03:44,090
with this investigation,
this isn't CCleaner

62
00:03:44,090 --> 00:03:49,090
where you had 10 and maybe 15
companies that were targeted.

63
00:03:49,290 --> 00:03:54,290
You're talking about 17,000
companies that downloaded that.

64
00:03:54,690 --> 00:03:57,660
yes, the actors had
their menu to pick from

65
00:03:57,660 --> 00:03:59,700
but you need hard facts.

66
00:03:59,700 --> 00:04:03,440
One of the things that
has limited researchers

67
00:04:03,440 --> 00:04:08,340
has been sharing of samples and artifacts

68
00:04:08,340 --> 00:04:11,700
by investigators on the SUNBURST saga.

69
00:04:11,700 --> 00:04:14,980
And I understand, you know
these companies have NDAs

70
00:04:14,980 --> 00:04:17,070
and stuff like that but this is bigger

71
00:04:17,070 --> 00:04:20,010
than just one company's NDA.

72
00:04:20,010 --> 00:04:23,150
You're talking about
the biggest hack ever.

73
00:04:23,150 --> 00:04:26,190
Raindrop samples weren't initially shared

74
00:04:26,190 --> 00:04:28,440
due to legal reasons, they couldn't do it.

75
00:04:28,440 --> 00:04:31,590
SUNSPOT has yet to be released.

76
00:04:31,590 --> 00:04:34,376
And cyber samples have yet
to be shared by Microsoft.

77
00:04:34,376 --> 00:04:37,580
We'll go into that in a bit.

78
00:04:37,580 --> 00:04:42,450
But now we have threat hunters
waiting to reverse samples

79
00:04:42,450 --> 00:04:47,180
looking for clues for code
similarities in these binaries.

80
00:04:47,180 --> 00:04:50,990
These are hard facts that everyone needs.

81
00:04:50,990 --> 00:04:54,810
You know, investigators
must share this to prove

82
00:04:54,810 --> 00:04:56,690
this isn't high confidence.

83
00:04:56,690 --> 00:04:59,260
This needs to be, here are the facts.

84
00:04:59,260 --> 00:05:00,550
This is what we know.

85
00:05:00,550 --> 00:05:01,730
And we need a point.

86
00:05:01,730 --> 00:05:05,910
I was having a conversation on a call

87
00:05:05,910 --> 00:05:09,000
with a lot of researchers and
I was having this discussion.

88
00:05:09,000 --> 00:05:13,070
And what they said was,
oh, you know the bad guys

89
00:05:13,070 --> 00:05:15,520
and actors, they could
use these techniques.

90
00:05:15,520 --> 00:05:16,520
I'm like what?

91
00:05:16,520 --> 00:05:18,849
Everyone could use Cobalt Strike.

92
00:05:18,850 --> 00:05:21,393
This isn't, it's nothing new.

93
00:05:22,610 --> 00:05:27,610
So I decided to put my red team hat on

94
00:05:27,880 --> 00:05:30,140
and started doing reconnaissance, right?

95
00:05:30,140 --> 00:05:31,902
Your normal Google Dorking.

96
00:05:33,730 --> 00:05:37,970
What I found in in using different tools

97
00:05:37,970 --> 00:05:42,970
was 10 email servers, 13 VPN
servers, 329 all sub domains

98
00:05:47,220 --> 00:05:50,060
which some of the sub
domains was very interesting.

99
00:05:50,060 --> 00:05:52,020
I would recommend you look at them

100
00:05:52,020 --> 00:05:54,490
because now they have
a bug bounty program.

101
00:05:54,490 --> 00:05:59,370
I didn't go into spidering
any of the hosts and that far

102
00:05:59,370 --> 00:06:00,430
but within a half an hour,

103
00:06:00,430 --> 00:06:02,933
I had a clearer picture
and a understanding.

104
00:06:05,271 --> 00:06:09,180
Vinoth Kumar, a security researcher found

105
00:06:09,180 --> 00:06:13,320
a public GitHub repo which
was leaking FTP credentials

106
00:06:13,320 --> 00:06:18,050
that belong to SolarWinds, which
could upload any executable

107
00:06:18,050 --> 00:06:22,760
and was then available for
SolarWinds customers to download.

108
00:06:22,760 --> 00:06:25,590
This is another vector that a threat actor

109
00:06:25,590 --> 00:06:26,640
could have compromised.

110
00:06:26,640 --> 00:06:30,149
And we're not talking about
SUPERNOVA or SUNBURST.

111
00:06:30,149 --> 00:06:32,500
This could be anyone.

112
00:06:32,500 --> 00:06:36,034
And for me, what I found
is looking at this is

113
00:06:36,034 --> 00:06:39,849
there's so many low hanging fruits.

114
00:06:39,850 --> 00:06:42,710
When not only looking at SolarWinds

115
00:06:42,710 --> 00:06:45,890
but other companies,
you can target people.

116
00:06:45,890 --> 00:06:48,150
You can do so many other things.

117
00:06:48,150 --> 00:06:50,239
And I hope all the people watching here,

118
00:06:50,240 --> 00:06:54,330
I hope your company has
a bug bounty program

119
00:06:54,330 --> 00:06:56,383
because it is so worth it.

120
00:06:57,810 --> 00:07:02,210
Now, what I think is the
likely timeline was before

121
00:07:02,210 --> 00:07:04,368
or after 6/17.

122
00:07:04,368 --> 00:07:09,368
I think is before because
you have to grasp everything

123
00:07:10,860 --> 00:07:13,660
as happened with the SolarWinds hack.

124
00:07:13,660 --> 00:07:15,030
And we're gonna go into details.

125
00:07:15,030 --> 00:07:18,280
But when I'm red teaming
and I penetrate a network,

126
00:07:18,280 --> 00:07:21,539
what I told the team that
I'm red teaming with is

127
00:07:21,540 --> 00:07:24,450
I want to be the new admin, right?

128
00:07:24,450 --> 00:07:27,320
But for SolarWinds, once the threat actor

129
00:07:27,320 --> 00:07:30,400
had the credentials
from the Orion platform,

130
00:07:30,400 --> 00:07:32,150
they could move laterally.

131
00:07:32,150 --> 00:07:35,039
Also, they would have had full access

132
00:07:35,040 --> 00:07:38,430
to the cloud infrastructure,
which with credentials

133
00:07:38,430 --> 00:07:43,160
and we know they have the
capabilities to compromise 2FA

134
00:07:43,160 --> 00:07:46,823
because this is how they
were caught by FireEye.

135
00:07:48,290 --> 00:07:52,193
So I want to go into the
initial code injection.

136
00:07:54,860 --> 00:07:59,510
9/12/19 the trial run began, right?

137
00:07:59,510 --> 00:08:03,381
This code modification
was a proof of concept.

138
00:08:03,381 --> 00:08:08,381
They compromise the build,
inject their own code

139
00:08:08,610 --> 00:08:11,480
and then verify that their signed packages

140
00:08:11,480 --> 00:08:15,800
are going to appear on the
client side as expected.

141
00:08:15,800 --> 00:08:20,300
Once these objectives were
met and the attackers proved

142
00:08:20,300 --> 00:08:22,290
to themselves that they could do it,

143
00:08:22,290 --> 00:08:24,860
the supply chain could be compromised.

144
00:08:24,860 --> 00:08:26,840
They started getting ready to deploy

145
00:08:26,840 --> 00:08:29,030
the real attack payload.

146
00:08:29,030 --> 00:08:32,780
They tested the code for nearly
two months waiting to see

147
00:08:32,780 --> 00:08:35,620
if anyone would detect it.

148
00:08:35,620 --> 00:08:36,980
And because no one did,

149
00:08:36,980 --> 00:08:39,102
it was time to move to that next phase.

150
00:08:39,102 --> 00:08:43,289
Now this small snippet
creates a new thread

151
00:08:43,289 --> 00:08:45,480
that runs that backdoor.

152
00:08:45,480 --> 00:08:50,290
The location is perfect for
this kind of code to be added

153
00:08:50,290 --> 00:08:53,939
as the original code
is already dealing with

154
00:08:53,940 --> 00:08:56,070
a long running background task.

155
00:08:56,070 --> 00:08:58,490
So they inject that code,
blends in perfectly.

156
00:08:58,490 --> 00:09:02,870
So no one would really know.

157
00:09:02,870 --> 00:09:07,820
So how was the build process compromised?

158
00:09:07,820 --> 00:09:10,600
The likely details of the
build process compromises

159
00:09:10,600 --> 00:09:12,860
in some spot, right?

160
00:09:12,860 --> 00:09:15,930
Like most persistant malware SunSpot

161
00:09:15,930 --> 00:09:19,420
creates a scheduled task
to execute on boot up.

162
00:09:19,420 --> 00:09:23,360
It monitors the task for running processes

163
00:09:23,360 --> 00:09:27,770
which then hashes the name of each process

164
00:09:27,770 --> 00:09:30,193
And is compared with
the corresponding value.

165
00:09:31,190 --> 00:09:35,730
It finds the MsBuild process
and spawns a new thread

166
00:09:35,730 --> 00:09:38,720
to determine the Orion
software is being built

167
00:09:38,720 --> 00:09:42,693
then hijacks to build
operation and inject SUNBURST.

168
00:09:44,850 --> 00:09:48,150
Now there isn't a OR they use,

169
00:09:48,150 --> 00:09:51,160
just an If Statement to inject code.

170
00:09:51,160 --> 00:09:53,550
You know, as a researcher I looked at this

171
00:09:53,550 --> 00:09:57,120
and I appreciated the
non-sophistication of this attack.

172
00:09:57,120 --> 00:10:00,920
Now we're not talking about the how,

173
00:10:00,920 --> 00:10:04,227
the when, we're just
talking about what they did.

174
00:10:05,735 --> 00:10:07,383
It blew my mind.

175
00:10:08,940 --> 00:10:12,313
All right, so putting my red team hat on.

176
00:10:13,250 --> 00:10:16,000
At my prior company, we had this SDL

177
00:10:16,000 --> 00:10:19,222
that we would go through
which had these processes,

178
00:10:19,222 --> 00:10:22,439
which are standard practice.

179
00:10:22,440 --> 00:10:26,360
But I'm pretty sure those
actors had that as well.

180
00:10:26,360 --> 00:10:29,830
Such a large environment to tackle, right?

181
00:10:29,830 --> 00:10:31,770
You have to replicate everything.

182
00:10:31,770 --> 00:10:34,610
You need the QA, as a threat actor

183
00:10:34,610 --> 00:10:38,160
you had to have that environment,
like I said replicated

184
00:10:38,160 --> 00:10:40,920
and having a QA testing it.

185
00:10:40,920 --> 00:10:44,819
Because patients I believe might have been

186
00:10:44,820 --> 00:10:48,380
the most important thing
because of the length of time.

187
00:10:48,380 --> 00:10:50,814
So it's practice rehearse,
practice rehearse

188
00:10:50,814 --> 00:10:53,329
because you only have one shot.

189
00:10:53,330 --> 00:10:54,930
You can't mess this up.

190
00:10:54,930 --> 00:10:56,662
It's one shot, one kill.

191
00:10:58,460 --> 00:11:01,393
So let's go into the SUNBURST deployment.

192
00:11:04,260 --> 00:11:08,543
So the SUNBURST deployment was 2/20/20.

193
00:11:10,290 --> 00:11:14,250
So let's go into the code
analysis of SUNBURST.

194
00:11:14,250 --> 00:11:19,186
So the SUNBURST Trackprocesses
called by Update

195
00:11:19,186 --> 00:11:22,490
and UpdateNotification is
responsible for querying

196
00:11:22,490 --> 00:11:26,350
the running processes
on the victim's machine

197
00:11:26,350 --> 00:11:30,700
to find the process, service
and drivers name of interest.

198
00:11:30,700 --> 00:11:35,400
So this routine will get a list
of running process objects.

199
00:11:35,400 --> 00:11:40,400
Then pass the three methods
below for identifying

200
00:11:41,400 --> 00:11:44,390
the blacklist, the process and services.

201
00:11:44,390 --> 00:11:48,010
These methods will return back true,

202
00:11:48,010 --> 00:11:51,370
if the blacklist, process
or service is found

203
00:11:51,370 --> 00:11:54,220
causing the malware to break out the loop.

204
00:11:54,220 --> 00:11:59,020
And this was interesting
because I joined SentinelOne

205
00:11:59,020 --> 00:12:02,160
four months before the
discovery of SolarWinds.

206
00:12:02,160 --> 00:12:06,884
And I was proud that none of
our customers were affected.

207
00:12:06,884 --> 00:12:11,884
The reason was that this
was due to that one reason

208
00:12:12,530 --> 00:12:15,250
that we had built from the beginning

209
00:12:15,250 --> 00:12:20,130
that our endpoint agent
had tamper protection.

210
00:12:20,130 --> 00:12:22,580
You know, once many companies understood,

211
00:12:22,580 --> 00:12:26,690
okay, tamper protection a
lot of vendors followed suit

212
00:12:26,690 --> 00:12:28,530
to start doing that to theirs.

213
00:12:28,530 --> 00:12:33,530
And our SentinelMonitor.sys
was hardcoded in the blacklist.

214
00:12:35,160 --> 00:12:38,400
I mean, for me, I went
to some of the engineers

215
00:12:38,400 --> 00:12:40,319
and I was like kudos to you.

216
00:12:40,320 --> 00:12:42,810
You know, that's a chip on our shoulder

217
00:12:42,810 --> 00:12:45,949
to have an actor say mm-mm,

218
00:12:45,950 --> 00:12:49,160
if that's on their system,
we're not gonna attack them.

219
00:12:49,160 --> 00:12:50,350
You know, that was big.

220
00:12:50,350 --> 00:12:54,530
That's something that, you know,
internally we were proud of

221
00:12:54,530 --> 00:12:58,150
because we didn't have
to run and tell customers

222
00:12:58,150 --> 00:13:01,360
how to fix something
and what we needed to do

223
00:13:01,360 --> 00:13:02,653
to correct the problem.

224
00:13:04,080 --> 00:13:07,910
So we go a little deeper.

225
00:13:07,910 --> 00:13:11,760
So the SearchServices
method which leverages

226
00:13:11,760 --> 00:13:16,760
the same hashing technique to
identify services of interest

227
00:13:17,000 --> 00:13:18,040
to disable.

228
00:13:18,040 --> 00:13:20,900
This allows the attacker
to disable certain services

229
00:13:20,900 --> 00:13:23,110
they needed to run this attack on.

230
00:13:23,110 --> 00:13:25,660
And they had that list as well.

231
00:13:25,660 --> 00:13:27,130
I won't go into the companies they have

232
00:13:27,130 --> 00:13:28,743
but that was on the list.

233
00:13:30,190 --> 00:13:34,170
So let's go, I'm gonna break down SUNBURST

234
00:13:34,170 --> 00:13:38,910
and I may explain it
like very simple, right?

235
00:13:38,910 --> 00:13:43,530
How did the supply chain
attack update work?

236
00:13:43,530 --> 00:13:45,949
Well, once you install the Orion Update,

237
00:13:45,950 --> 00:13:49,470
the injected code stayed
dormant for 12 to 14 days.

238
00:13:49,470 --> 00:13:51,310
Everybody knows that now, right?

239
00:13:51,310 --> 00:13:53,369
But they checked the Dev Tools,

240
00:13:53,370 --> 00:13:56,100
it then checks the security services

241
00:13:56,100 --> 00:13:59,000
and disables it via registry.

242
00:13:59,000 --> 00:14:02,190
And then you proceed communicate to C2

243
00:14:02,190 --> 00:14:04,633
and then start the malicious activity.

244
00:14:06,550 --> 00:14:10,680
So putting on that red team
hat knowing that enemy.

245
00:14:10,680 --> 00:14:13,420
The threat actor knew how to defeat

246
00:14:13,420 --> 00:14:14,610
the Endpoint Security products.

247
00:14:14,610 --> 00:14:18,010
And as a red teamer, you start being aware

248
00:14:18,010 --> 00:14:20,300
when you're in different environments,

249
00:14:20,300 --> 00:14:21,849
how to defeat the system.

250
00:14:21,850 --> 00:14:26,850
And this is where having a red
team pays a lot of dividends

251
00:14:27,330 --> 00:14:31,130
because you can allow them
to work with the blue team

252
00:14:31,130 --> 00:14:35,840
and help them assist
how to fix these things.

253
00:14:35,840 --> 00:14:39,863
So they understood which
victims they were targeting.

254
00:14:40,850 --> 00:14:42,310
What is the shocking thing?

255
00:14:42,310 --> 00:14:46,550
And I said it before, there
were no 0-dayz reported on this.

256
00:14:46,550 --> 00:14:50,959
And again, there's reports
continually coming out.

257
00:14:50,960 --> 00:14:55,960
So I look at this and
I say wow, these actors

258
00:14:56,200 --> 00:14:57,650
they knew what they wanted.

259
00:14:57,650 --> 00:14:59,350
They knew who they were targeting.

260
00:15:00,244 --> 00:15:05,244
And in the White House
briefing, they put sanctions

261
00:15:05,320 --> 00:15:09,480
not only against SVR but
they also put sanctions

262
00:15:09,480 --> 00:15:11,930
against 10 Russian companies.

263
00:15:11,930 --> 00:15:14,430
You know, contractors, the same would be

264
00:15:14,430 --> 00:15:17,430
for like your Booz Allen's
or your Raytheon's,

265
00:15:17,430 --> 00:15:18,262
it's the same thing.

266
00:15:18,263 --> 00:15:21,640
So they put sanctions against them.

267
00:15:21,640 --> 00:15:24,763
That shows you how large
this operation was.

268
00:15:26,120 --> 00:15:31,120
Now let's talk about once they
have access to the systems

269
00:15:32,700 --> 00:15:36,520
and you were one of the
targets they wanted to go after

270
00:15:36,520 --> 00:15:39,545
and I call this part
accessing an organizations

271
00:15:39,545 --> 00:15:40,902
crown jewels.

272
00:15:45,210 --> 00:15:48,503
So we're still in that timeline, right?

273
00:15:49,400 --> 00:15:52,793
And Skelton Key details.

274
00:15:53,660 --> 00:15:55,949
Once Orion platform was compromised

275
00:15:55,950 --> 00:16:00,690
the threat actors also had
access to all the API keys.

276
00:16:00,690 --> 00:16:04,590
Which meant the entire cloud
environment was compromised.

277
00:16:04,590 --> 00:16:07,770
I was having a conversation
the first month

278
00:16:07,770 --> 00:16:12,510
that all these reports were coming out.

279
00:16:12,510 --> 00:16:16,360
And one of the conversations I had was,

280
00:16:16,360 --> 00:16:21,360
you know, how do you know that
they weren't targeting you

281
00:16:23,960 --> 00:16:27,730
just because you didn't find anything.

282
00:16:27,730 --> 00:16:29,450
And that's something we're gonna go over.

283
00:16:29,450 --> 00:16:32,920
But the level of access is unprecedented

284
00:16:32,920 --> 00:16:36,420
for a threat actor compared to
other supply chains attacks.

285
00:16:36,420 --> 00:16:39,870
I did discuss with Ccleaner,
you know, if it wasn't

286
00:16:39,870 --> 00:16:43,140
for Talos finding something odd,

287
00:16:43,140 --> 00:16:45,800
they would have never gotten caught.

288
00:16:45,800 --> 00:16:49,800
So I just want you to think about that.

289
00:16:49,800 --> 00:16:54,359
Those AWS and a sort of API
Root Keys enables an attacker

290
00:16:54,360 --> 00:16:58,464
to take over and compromise
many different things.

291
00:16:58,464 --> 00:17:01,910
This enables an attacker, not only to have

292
00:17:01,910 --> 00:17:06,359
full privilege admin
privileges to the account

293
00:17:06,359 --> 00:17:10,270
but it also allows you
to like turn stuff on,

294
00:17:10,270 --> 00:17:14,129
maybe throw some implants
into an environment.

295
00:17:14,130 --> 00:17:16,290
And a company that was compromised

296
00:17:16,290 --> 00:17:18,389
which provides secure certificates.

297
00:17:18,390 --> 00:17:20,230
They have their certificate stolen,

298
00:17:20,230 --> 00:17:22,800
they had their source code stolen.

299
00:17:22,800 --> 00:17:24,659
Just to give you an example
and that's just one.

300
00:17:24,660 --> 00:17:28,170
That's one of many, you will
see this is like I said,

301
00:17:28,170 --> 00:17:29,380
an ongoing saga.

302
00:17:29,380 --> 00:17:31,380
You will see next year,

303
00:17:31,380 --> 00:17:35,580
a report on tracing back to SolarWinds.

304
00:17:35,580 --> 00:17:40,580
So the Orion requires access to an IAM.

305
00:17:42,630 --> 00:17:47,250
This calls for treating
IAM as compromised.

306
00:17:47,250 --> 00:17:52,250
This is hard to do, but
everything needs to be blown away

307
00:17:52,510 --> 00:17:54,960
and rebuilt if possible.

308
00:17:54,960 --> 00:17:57,400
Now many companies cannot do that.

309
00:17:57,400 --> 00:18:00,700
But if you're agile enough
and you are part of that

310
00:18:00,700 --> 00:18:02,860
you need to rethink that.

311
00:18:02,860 --> 00:18:06,743
You know, I had a friend said
this was like Willy Wonka.

312
00:18:08,080 --> 00:18:11,379
And there were in the chocolate factory.

313
00:18:11,380 --> 00:18:14,653
It had anything to pick
from, that was Eric.

314
00:18:16,060 --> 00:18:20,543
So I mean, it's really for me,

315
00:18:22,630 --> 00:18:25,163
this is the biggest hack ever.

316
00:18:26,420 --> 00:18:29,420
So ghost in a shell.

317
00:18:29,420 --> 00:18:30,253
How do you know?

318
00:18:30,253 --> 00:18:32,790
I just said it, how do
you know what's good?

319
00:18:32,790 --> 00:18:37,790
Or what's bad if you do not
have complete visibility, right?

320
00:18:37,900 --> 00:18:42,900
Many organizations are
pressed by business needs

321
00:18:43,200 --> 00:18:45,750
rather than security.

322
00:18:45,750 --> 00:18:47,340
Security is a cost.

323
00:18:47,340 --> 00:18:50,340
It's always in the red for companies

324
00:18:50,340 --> 00:18:52,129
that aren't in security.

325
00:18:52,130 --> 00:18:55,600
So when you're doing
businesses it doesn't matter

326
00:18:55,600 --> 00:18:56,433
what it is.

327
00:18:56,433 --> 00:18:57,570
It's always a cost.

328
00:18:57,570 --> 00:18:59,889
It's not generating revenue for you.

329
00:18:59,890 --> 00:19:04,370
So when a threat actor customizes malware

330
00:19:04,370 --> 00:19:08,489
for your environment,
they already are aware of

331
00:19:08,490 --> 00:19:10,760
how your network is configured,

332
00:19:10,760 --> 00:19:13,700
what they need to do, how
to bypass those detections.

333
00:19:13,700 --> 00:19:15,750
As we've seen with SolarWinds.

334
00:19:15,750 --> 00:19:20,553
Now lastly, how do you
find something malicious

335
00:19:21,400 --> 00:19:23,783
if a binary blends into the environment?

336
00:19:24,840 --> 00:19:27,189
It's hard to do.

337
00:19:27,190 --> 00:19:29,700
If there's no IoCs or IoAs

338
00:19:29,700 --> 00:19:34,181
and your rules do not detect
it, how do you find it?

339
00:19:34,181 --> 00:19:36,810
It's one of those puzzles, right?

340
00:19:36,810 --> 00:19:38,163
Hunting is the key.

341
00:19:39,470 --> 00:19:44,180
So I wanted to go into malware strains

342
00:19:44,180 --> 00:19:49,180
and some of the things that
researchers really want to,

343
00:19:50,650 --> 00:19:52,423
you know, peel back that onion.

344
00:19:54,000 --> 00:19:59,000
So Teardrop and SunShuttle,
which was reported by FireEye

345
00:20:00,090 --> 00:20:04,429
kudos to them, they were
transparent from the beginning.

346
00:20:04,430 --> 00:20:06,350
You know, they provided those URLs,

347
00:20:06,350 --> 00:20:11,350
they provided binaries
to help detect SUNBURST.

348
00:20:11,620 --> 00:20:16,370
And they continue to share
their binaries, right?

349
00:20:16,370 --> 00:20:18,479
Raindrop we discussed earlier,

350
00:20:18,480 --> 00:20:21,880
which was discovered by
Symantec, but because of NDA

351
00:20:21,880 --> 00:20:24,820
they couldn't share it, but
it did leak on VirusTotal.

352
00:20:24,820 --> 00:20:26,350
I don't think Symantec leaked it.

353
00:20:26,350 --> 00:20:28,752
I think maybe another company,

354
00:20:28,752 --> 00:20:30,984
found it after the Symantec report

355
00:20:30,984 --> 00:20:34,530
and uploaded it to
VirusTotal, kudos to them.

356
00:20:34,530 --> 00:20:35,730
And then you have NOBELIUM.

357
00:20:35,730 --> 00:20:40,730
The NOBELIUM report that was
released in March by Microsoft.

358
00:20:41,590 --> 00:20:44,050
When reading their report.

359
00:20:44,050 --> 00:20:48,680
I thought Sibot was a
very interesting sample

360
00:20:48,680 --> 00:20:51,980
that could shine light on the actor.

361
00:20:51,980 --> 00:20:56,190
Sibot reaches out to a legitimate
but compromised domain.

362
00:20:56,190 --> 00:20:59,010
And I believe that's why
they didn't wanna release it

363
00:20:59,010 --> 00:21:01,670
because it was a legitimate domain

364
00:21:01,670 --> 00:21:03,870
but what it does, it downloads the DLL.

365
00:21:03,870 --> 00:21:07,159
And renames the DLL to a dot sys extension

366
00:21:07,160 --> 00:21:11,150
which is designed to achieve
persistence on the endpoint.

367
00:21:11,150 --> 00:21:16,150
But again, I get about not sharing

368
00:21:18,500 --> 00:21:23,150
and having an NDA in place.

369
00:21:23,150 --> 00:21:25,750
And you don't wanna show that, you know

370
00:21:25,750 --> 00:21:29,080
these domains were compromised.

371
00:21:29,080 --> 00:21:34,080
But we know that 17,000
companies were compromised.

372
00:21:34,370 --> 00:21:37,129
What are two more on the list, right?

373
00:21:37,130 --> 00:21:40,520
So that I believe is super important.

374
00:21:40,520 --> 00:21:42,403
Having that transparency.

375
00:21:43,310 --> 00:21:45,590
It is something that we need to do.

376
00:21:45,590 --> 00:21:47,807
And I harp on that because I don't think

377
00:21:47,807 --> 00:21:52,807
this is a one-time thing.

378
00:21:53,600 --> 00:21:56,060
What happens if through SolarWinds

379
00:21:56,060 --> 00:21:59,230
they get into another company
that didn't detect them.

380
00:21:59,230 --> 00:22:04,067
And now they've injected
code into more source code

381
00:22:06,370 --> 00:22:09,530
or compromises other build processes.

382
00:22:09,530 --> 00:22:12,649
I think this is something
that needs to happen

383
00:22:13,570 --> 00:22:16,053
and needs to be shared for everyone.

384
00:22:17,370 --> 00:22:21,520
So here's some of the
key takeaways, right?

385
00:22:21,520 --> 00:22:26,520
And what I said was, you
know, these threat actors

386
00:22:30,230 --> 00:22:32,103
was Playing with The House's Money.

387
00:22:32,990 --> 00:22:37,540
And, you know, going after
FireEye is the only reason

388
00:22:37,540 --> 00:22:39,149
why they were caught.

389
00:22:39,150 --> 00:22:40,530
When they were going after them.

390
00:22:40,530 --> 00:22:43,080
They had to say to themselves,
they're security company

391
00:22:43,080 --> 00:22:45,832
they're probably gonna go
ahead in the tech desk.

392
00:22:46,951 --> 00:22:51,951
And I really think that it
wasn't SVR going after them.

393
00:22:52,950 --> 00:22:54,770
I think it was one of the 10 companies

394
00:22:54,770 --> 00:22:56,970
that was sanctioned that went after them.

395
00:22:56,970 --> 00:23:00,890
Because if you have such
a successful campaign,

396
00:23:00,890 --> 00:23:03,500
you wanted to continue to go on, right?

397
00:23:03,500 --> 00:23:07,000
You want that to always, always be there.

398
00:23:07,000 --> 00:23:11,620
So SVR going after FireEye
was a complete mistake.

399
00:23:14,700 --> 00:23:19,700
I always say, pigs get fat,
but a hog get slaughtered.

400
00:23:20,850 --> 00:23:22,159
They were greedy.

401
00:23:22,160 --> 00:23:25,230
They wanted everything, right?

402
00:23:25,230 --> 00:23:30,230
And those red team tools, I
don't know if it was worse

403
00:23:31,660 --> 00:23:34,633
giving, you know, tipping your hand.

404
00:23:37,864 --> 00:23:38,950
That's just me.

405
00:23:38,950 --> 00:23:41,450
I don't think it was worth it.

406
00:23:41,450 --> 00:23:46,450
Now we talked about
the SDL process, right.

407
00:23:47,190 --> 00:23:50,350
But what I think that needs to change

408
00:23:50,350 --> 00:23:54,899
is planning or assessment.

409
00:23:54,900 --> 00:23:59,270
Planning and assessment must
focus on security, right?

410
00:23:59,270 --> 00:24:02,470
Architecture should
have a security champion

411
00:24:02,470 --> 00:24:07,160
or influencer to provide
direction all the time.

412
00:24:07,160 --> 00:24:11,503
You know, design always
with security in mind.

413
00:24:12,370 --> 00:24:15,620
It's always important to
restrict access, right?

414
00:24:15,620 --> 00:24:20,620
And you've seen that with
SolarWinds intern uploading code

415
00:24:22,190 --> 00:24:23,407
to Github.

416
00:24:24,850 --> 00:24:29,850
I mean, that was shocking
to me to have that.

417
00:24:30,360 --> 00:24:32,800
Now it could be true, I don't know.

418
00:24:32,800 --> 00:24:37,770
But you have to restrict access always.

419
00:24:37,770 --> 00:24:40,970
But fuzzing and diffing before and after

420
00:24:40,970 --> 00:24:43,260
the build process is critical.

421
00:24:43,260 --> 00:24:46,720
I believe if this was in place

422
00:24:46,720 --> 00:24:49,730
this attack would have been prevented

423
00:24:49,730 --> 00:24:53,280
because after the build
process, if you analyze

424
00:24:53,280 --> 00:24:56,250
and you review the source code

425
00:24:56,250 --> 00:24:58,360
and even if you do a quick vimdiff

426
00:24:59,586 --> 00:25:03,483
you would have known that code changed.

427
00:25:04,380 --> 00:25:07,760
And a lot of times I've
been in environments

428
00:25:07,760 --> 00:25:11,820
where you have red teams that go through,

429
00:25:11,820 --> 00:25:13,050
that look for bugs.

430
00:25:13,050 --> 00:25:18,050
And they're rated on how many
bugs they can find a year.

431
00:25:19,380 --> 00:25:21,034
Like that is awesome.

432
00:25:21,034 --> 00:25:26,034
I believe every company needs
to train their red teams.

433
00:25:28,510 --> 00:25:31,160
There's places where I used to work

434
00:25:31,160 --> 00:25:35,280
where you have small pockets of red team

435
00:25:35,280 --> 00:25:38,670
for each organization when it's very big,

436
00:25:38,670 --> 00:25:39,670
you need that right.

437
00:25:39,670 --> 00:25:44,013
One red team for an organization over 15,

438
00:25:45,718 --> 00:25:47,973
20,000 employees pushing code,

439
00:25:48,860 --> 00:25:51,209
how can they touch everything, right?

440
00:25:51,210 --> 00:25:56,210
And this is why I said before
bug bounty is very important.

441
00:25:57,400 --> 00:26:00,650
Is super important because
you're gonna have that army

442
00:26:00,650 --> 00:26:02,740
just like the army of reversers.

443
00:26:02,740 --> 00:26:06,600
You're gonna have that
army for bug bounty.

444
00:26:06,600 --> 00:26:11,600
And one of the things I say
just to touch on bug bounty,

445
00:26:12,380 --> 00:26:16,510
you know, when a bug is submitted

446
00:26:19,400 --> 00:26:22,650
and it's critical, you need to pay

447
00:26:22,650 --> 00:26:25,673
what the market is paying.

448
00:26:26,698 --> 00:26:31,698
And this will level out
where a lot of the bugs

449
00:26:32,340 --> 00:26:35,389
would be submitted directly to the vendor

450
00:26:35,390 --> 00:26:37,690
if they were paying that amount.

451
00:26:37,690 --> 00:26:41,640
A lot of times people sell it to

452
00:26:41,640 --> 00:26:43,960
or hold it to point own, right?

453
00:26:43,960 --> 00:26:46,790
Because they're paying out a lot of money

454
00:26:47,660 --> 00:26:48,493
and that's important.

455
00:26:48,493 --> 00:26:51,260
That's a conversation
that, you know, Katie

456
00:26:53,166 --> 00:26:54,840
and other people have, but
that's just my opinion.

457
00:26:54,840 --> 00:26:59,030
And what I wanted to say is the victims

458
00:26:59,030 --> 00:27:04,030
that were compromised
DTA, don't trust anything.

459
00:27:05,400 --> 00:27:10,140
If you downloaded that
update and let's say,

460
00:27:11,322 --> 00:27:15,495
they didn't pick you
guys or you don't think

461
00:27:15,495 --> 00:27:17,479
don't have that mindset.

462
00:27:17,480 --> 00:27:19,780
You know, try to carpet bomb everything.

463
00:27:19,780 --> 00:27:21,402
Do not trust anything created

464
00:27:21,402 --> 00:27:24,220
after the SUNBURST install.

465
00:27:24,220 --> 00:27:28,060
And like I mentioned before

466
00:27:29,110 --> 00:27:33,409
I had a friend that was a
head of security at a company

467
00:27:33,410 --> 00:27:36,780
that was affected,
stated we don't have it.

468
00:27:36,780 --> 00:27:38,482
We didn't see anything.

469
00:27:38,482 --> 00:27:42,379
And I'm like, yeah, a lot of
companies didn't see anything.

470
00:27:42,380 --> 00:27:44,570
And now you're starting to see

471
00:27:44,570 --> 00:27:49,100
that other companies are
reaching out to the company

472
00:27:49,100 --> 00:27:53,040
that was affected and stated,
hey where have you seen this?

473
00:27:53,040 --> 00:27:55,167
And that was the example
that I gave earlier about

474
00:27:55,167 --> 00:28:00,167
the one company that had their
certificates compromised.

475
00:28:03,330 --> 00:28:08,330
So let's go into the mindset of an actor.

476
00:28:09,990 --> 00:28:14,050
You know, it's a key
takeaway on this presentation

477
00:28:14,050 --> 00:28:16,830
the mindset of an actor's
home through training

478
00:28:16,830 --> 00:28:20,060
and understanding of the adversary.

479
00:28:20,060 --> 00:28:22,960
You know, you're not just
gonna come into the industry

480
00:28:22,960 --> 00:28:27,480
and just have that, oh
this is what they would do.

481
00:28:27,480 --> 00:28:30,960
No, you need to have, I
always say the same thing.

482
00:28:30,960 --> 00:28:32,650
If you're a blue teamer

483
00:28:32,650 --> 00:28:35,990
you wanna do offensive security training.

484
00:28:35,990 --> 00:28:37,440
And if you're a red teamer

485
00:28:37,440 --> 00:28:41,720
you wanna do defensive
training to understand

486
00:28:41,720 --> 00:28:45,070
how the protections in
place and try to balance it.

487
00:28:45,070 --> 00:28:49,280
And you know, I do that today.

488
00:28:49,280 --> 00:28:53,800
I love to go and play both
sides because I constantly

489
00:28:53,800 --> 00:28:56,629
when I'm reversing engineering anything,

490
00:28:56,630 --> 00:28:57,890
or looking at something,

491
00:28:57,890 --> 00:29:02,174
I look at it as an
adversary and vice versa.

492
00:29:02,174 --> 00:29:07,120
Or you should create actor
simulations with your red team,

493
00:29:07,120 --> 00:29:09,600
as well as training for the blue team

494
00:29:09,600 --> 00:29:11,889
and training for developers, right?

495
00:29:11,890 --> 00:29:14,200
A lot of developers were seeing

496
00:29:14,200 --> 00:29:15,960
that they don't have that training

497
00:29:15,960 --> 00:29:18,200
and understanding how to secure code.

498
00:29:18,200 --> 00:29:21,790
You know, I used to work
with one of my friends.

499
00:29:21,790 --> 00:29:23,080
He's like, it works?

500
00:29:23,080 --> 00:29:24,220
Yeah, it works.

501
00:29:24,220 --> 00:29:26,010
All right, that's it, it doesn't matter.

502
00:29:26,010 --> 00:29:26,910
It works.

503
00:29:26,910 --> 00:29:29,880
And I'm like, no, that's
not how it goes, right?

504
00:29:29,880 --> 00:29:34,040
So kudos to that person

505
00:29:34,040 --> 00:29:36,790
because he has gotten
better over the years.

506
00:29:36,790 --> 00:29:41,146
Now you must have visibility
into threat hunting

507
00:29:41,146 --> 00:29:45,384
into your endpoints and you know,

508
00:29:45,384 --> 00:29:47,910
when people are hunting, it's a skill.

509
00:29:47,910 --> 00:29:49,944
You know, they can't do their job well

510
00:29:49,944 --> 00:29:53,170
if they don't have those
tools on the endpoint.

511
00:29:53,170 --> 00:29:58,170
So this is the thing, as
what will the attackers want

512
00:29:58,560 --> 00:30:00,453
if they penetrated your network?

513
00:30:01,660 --> 00:30:03,980
And what are those crown jewels?

514
00:30:03,980 --> 00:30:07,180
If you're not having those conversations,

515
00:30:07,180 --> 00:30:08,250
you need to do that.

516
00:30:08,250 --> 00:30:11,000
And the way you get to that answer

517
00:30:11,000 --> 00:30:15,422
is I feel like this is one of
the most important exercises

518
00:30:15,422 --> 00:30:18,850
that must happen in all organizations.

519
00:30:18,850 --> 00:30:23,850
You know, creating a internal
think tank or a brown bag.

520
00:30:24,547 --> 00:30:28,050
And coming up with worst case scenarios

521
00:30:28,050 --> 00:30:33,050
if you're a hospital, you
know if ransomware hits us,

522
00:30:33,135 --> 00:30:35,200
you know, are we protected?

523
00:30:35,200 --> 00:30:36,033
Is that good?

524
00:30:36,033 --> 00:30:40,939
If it hits the CT scan or MRI,
is that segregated correctly?

525
00:30:44,570 --> 00:30:49,362
Or if you're a car
company it's the same way,

526
00:30:51,099 --> 00:30:55,250
can someone attack our
car and take over it

527
00:30:55,250 --> 00:31:00,250
or even in the systems and
compromise the build process

528
00:31:00,760 --> 00:31:04,000
or put code in there just like SUNBURST?

529
00:31:04,000 --> 00:31:08,010
And these are conversations
that will happen now

530
00:31:08,010 --> 00:31:09,713
that this attack happened.

531
00:31:11,230 --> 00:31:15,720
And for me, that is all from my side,

532
00:31:15,720 --> 00:31:20,420
guys I had a pleasure
to share my research,

533
00:31:20,420 --> 00:31:21,800
until next time.

534
00:31:21,800 --> 00:31:23,450
Thank you for joining.

535
00:31:23,450 --> 00:31:24,387
Have a good day.

