1
00:00:01,450 --> 00:00:03,599
- Hey, good day, everybody.

2
00:00:03,600 --> 00:00:05,030
This is Kean.

3
00:00:05,030 --> 00:00:06,150
Thank you very much for listening

4
00:00:06,150 --> 00:00:08,880
to my Bitcoin wallet story.

5
00:00:08,880 --> 00:00:12,430
Well, I'm an independent
security researcher

6
00:00:12,430 --> 00:00:14,730
and a member of the Honeynet Project.

7
00:00:14,730 --> 00:00:16,610
So during my free time, I am involved

8
00:00:16,610 --> 00:00:19,419
in sort of Honeybag tools development

9
00:00:19,420 --> 00:00:23,560
and play around with
different deceptive-based

10
00:00:23,560 --> 00:00:25,240
defense mechanism.

11
00:00:25,240 --> 00:00:27,189
Well, personally,

12
00:00:27,190 --> 00:00:30,910
I always have these big
questions in my mind.

13
00:00:30,910 --> 00:00:33,550
Mmm, what if you and I,

14
00:00:33,550 --> 00:00:36,730
we put our personal file on the internet

15
00:00:36,730 --> 00:00:38,139
and then we just leave it there,

16
00:00:38,140 --> 00:00:42,180
maybe for 90 days or 60 days.

17
00:00:42,180 --> 00:00:43,013
Mmm.

18
00:00:43,013 --> 00:00:44,992
What will happen to all of them?

19
00:00:46,270 --> 00:00:47,910
Well, this is going to be formed

20
00:00:47,910 --> 00:00:50,110
the fundamental concept

21
00:00:50,110 --> 00:00:52,620
for what we are going to explore today,

22
00:00:52,620 --> 00:00:53,960
which is,

23
00:00:53,960 --> 00:00:58,420
who stole my $100,000
worth of a Bitcoin wallet?

24
00:00:58,420 --> 00:01:01,310
Well, let's share all these stories

25
00:01:01,310 --> 00:01:02,313
of the honeytokens.

26
00:01:03,220 --> 00:01:06,380
For the next 30 to 35 minutes,

27
00:01:06,380 --> 00:01:08,940
we'll share about three things right here.

28
00:01:08,940 --> 00:01:09,823
So first,

29
00:01:10,990 --> 00:01:14,020
let's take a quick look about the tool,

30
00:01:14,020 --> 00:01:14,970
Honeybag.

31
00:01:14,970 --> 00:01:17,571
This is a new open source
tool that we develop

32
00:01:17,571 --> 00:01:19,480
for this purpose.

33
00:01:19,480 --> 00:01:20,313
Secondly,

34
00:01:21,360 --> 00:01:22,799
how we created all these kinds

35
00:01:22,799 --> 00:01:25,460
of $100,000 worth of a Bitcoin wallet,

36
00:01:25,460 --> 00:01:28,663
and then how we placed it on the internet.

37
00:01:29,830 --> 00:01:31,810
Thirdly, let's take a quick look about

38
00:01:31,810 --> 00:01:34,310
all the interesting stuff and all the pain

39
00:01:34,310 --> 00:01:36,390
and exciting moment that we have

40
00:01:36,390 --> 00:01:38,600
about this use case.

41
00:01:38,600 --> 00:01:39,669
Last but not least,

42
00:01:39,670 --> 00:01:42,070
I would love to share
with everyone right here

43
00:01:42,070 --> 00:01:44,369
about some of the learning experience,

44
00:01:44,370 --> 00:01:46,100
some of the do's and don'ts.

45
00:01:46,100 --> 00:01:48,600
Well, let's do this together.

46
00:01:48,600 --> 00:01:52,740
But definitely feel free
to ask any questions.

47
00:01:52,740 --> 00:01:55,360
I will definitely love
to answer your questions

48
00:01:55,360 --> 00:01:58,077
and hear your thoughts.

49
00:01:58,077 --> 00:01:59,200
Yeah.

50
00:01:59,200 --> 00:02:01,083
Let's do this together.

51
00:02:02,180 --> 00:02:03,650
Now, nowadays,

52
00:02:03,650 --> 00:02:07,390
we always know that
lots of security company

53
00:02:07,390 --> 00:02:10,220
perform internet-wide scanning

54
00:02:10,220 --> 00:02:12,683
in order to look for insecure devices,

55
00:02:14,100 --> 00:02:18,170
insecure configured system
or servers on the internet.

56
00:02:18,170 --> 00:02:23,170
And then lots of big brain
behind the scene always thought,

57
00:02:23,420 --> 00:02:26,730
had a thought, how can
we secure it nicely?

58
00:02:26,730 --> 00:02:28,119
Well,

59
00:02:28,120 --> 00:02:29,940
yet on the other side of the wall,

60
00:02:29,940 --> 00:02:31,800
the dark side of the internet,

61
00:02:31,800 --> 00:02:35,000
those bad guys, they
are looking at the same,

62
00:02:35,000 --> 00:02:37,480
so-called internet scanning result.

63
00:02:37,480 --> 00:02:39,299
And those guys, they are trying to harvest

64
00:02:39,300 --> 00:02:42,333
those kind of results
with a malicious intent.

65
00:02:43,250 --> 00:02:47,360
For example, the folks are
looking for insecure server,

66
00:02:47,360 --> 00:02:50,610
which contains tons of credit card

67
00:02:50,610 --> 00:02:52,750
personal information on it.

68
00:02:52,750 --> 00:02:55,670
Or he could be looking
for some internal servers

69
00:02:55,670 --> 00:02:57,940
which belongs to a certain company.

70
00:02:57,940 --> 00:03:01,030
And all this kind of information

71
00:03:01,030 --> 00:03:04,060
can be leveraged later
in order to infiltrate

72
00:03:04,060 --> 00:03:05,930
into the corporate environment,

73
00:03:05,930 --> 00:03:09,210
into a private server farm
and some sort of stuff.

74
00:03:09,210 --> 00:03:13,160
Well, the bad guy are
looking for juicy information

75
00:03:13,160 --> 00:03:14,630
on the internet.

76
00:03:14,630 --> 00:03:16,140
Well, for me,

77
00:03:16,140 --> 00:03:21,140
I always love to tie this to
so-called a real-life scenario.

78
00:03:22,600 --> 00:03:25,710
For example, a street thief,

79
00:03:25,710 --> 00:03:28,330
when they try to break into the house,

80
00:03:28,330 --> 00:03:29,950
will carry an empty bag.

81
00:03:29,950 --> 00:03:32,390
Now they break into the house,

82
00:03:32,390 --> 00:03:34,160
and then they'll put all the jewelries,

83
00:03:34,160 --> 00:03:36,520
all the gold and silver, into the bag.

84
00:03:36,520 --> 00:03:39,910
Carry the full bag out
from the crime scene.

85
00:03:39,910 --> 00:03:40,743
Now,

86
00:03:42,310 --> 00:03:44,613
what if in the laws of movie,

87
00:03:45,860 --> 00:03:47,620
some of the folks are, they will try, or,

88
00:03:47,620 --> 00:03:49,010
so-called the investigator,

89
00:03:49,010 --> 00:03:51,530
they will put certain GPS tracker devices

90
00:03:51,530 --> 00:03:53,130
into those kind of bags.

91
00:03:53,130 --> 00:03:55,200
Once the bag moves from a single location

92
00:03:56,220 --> 00:03:57,750
to another location,

93
00:03:57,750 --> 00:04:01,790
the GPS tracker will send certain ping,

94
00:04:01,790 --> 00:04:03,660
or certain signal,

95
00:04:03,660 --> 00:04:07,540
back to the controller or
so-called the investigator.

96
00:04:07,540 --> 00:04:10,470
Well, this can be used to, kind of,

97
00:04:10,470 --> 00:04:12,640
keep track about where the files are going

98
00:04:12,640 --> 00:04:16,339
and where it's appeared here and there.

99
00:04:16,339 --> 00:04:20,880
Now I would love to tie
this scenario, this analogy,

100
00:04:20,880 --> 00:04:25,350
to so-called cybersecurity
defender's point of view.

101
00:04:25,350 --> 00:04:26,600
As a honeypot researcher,

102
00:04:27,700 --> 00:04:29,010
honeypot hobbyist,

103
00:04:29,010 --> 00:04:31,099
I always think that,

104
00:04:31,100 --> 00:04:32,930
if anything that we can do in this case

105
00:04:32,930 --> 00:04:36,590
in terms of cyber
defender's point of view,

106
00:04:36,590 --> 00:04:39,549
what if we can put certain bait

107
00:04:39,550 --> 00:04:42,300
or bait files into those kind of bag?

108
00:04:42,300 --> 00:04:45,973
And whenever the file gets
stolen over the internet,

109
00:04:46,820 --> 00:04:50,270
it will send us certain
information afterwards.

110
00:04:50,270 --> 00:04:53,310
Now, this concept is not brand new.

111
00:04:53,310 --> 00:04:55,203
This is about honeytoken,

112
00:04:55,203 --> 00:04:56,219
it's about baits,

113
00:04:56,220 --> 00:04:58,250
it's about breadcrumb.

114
00:04:58,250 --> 00:05:00,480
Yeah, multiple terms are

115
00:05:00,480 --> 00:05:03,270
which popular in the industry right now.

116
00:05:03,270 --> 00:05:07,729
Well, it was still back to
the same fundamental concept,

117
00:05:07,730 --> 00:05:09,390
which is about a bait.

118
00:05:09,390 --> 00:05:10,223
Yeah.

119
00:05:11,120 --> 00:05:12,530
Let's take a quick look together

120
00:05:12,530 --> 00:05:14,479
about a real-life example,

121
00:05:14,480 --> 00:05:17,383
which are back in 2017.

122
00:05:20,370 --> 00:05:22,930
I came across with this public blog,

123
00:05:22,930 --> 00:05:26,620
which are post by a very
well-known security guru,

124
00:05:26,620 --> 00:05:28,040
Mr. Didier Stevens,

125
00:05:28,040 --> 00:05:29,063
on SANS blog.

126
00:05:29,950 --> 00:05:31,560
Back in 2017,

127
00:05:31,560 --> 00:05:35,800
he observed these very
interesting observations.

128
00:05:35,800 --> 00:05:38,970
Someone, or I will say that the bad guy,

129
00:05:38,970 --> 00:05:43,443
tried to pickpocket Bitcoin
wallet from his web server.

130
00:05:45,090 --> 00:05:47,001
Back in 2017,

131
00:05:47,002 --> 00:05:48,002
end of 2017,

132
00:05:48,962 --> 00:05:51,710
Bitcoin price was all-time high.

133
00:05:51,710 --> 00:05:53,832
Well, I mean, that was back then.

134
00:05:55,290 --> 00:05:56,300
If I remember correctly,

135
00:05:56,300 --> 00:06:00,340
the Bitcoin price was
around 19,000 U.S. dollar,

136
00:06:00,340 --> 00:06:02,669
for Bitcoin, back in 2017 again.

137
00:06:02,670 --> 00:06:04,500
Yeah (laughs)

138
00:06:04,500 --> 00:06:07,570
Oh, at that time, Mr.
Didier Stevens observed that

139
00:06:09,461 --> 00:06:12,640
there were a lot of internet
scanning activities.

140
00:06:12,640 --> 00:06:15,700
People tried to pickpocket Bitcoin wallet

141
00:06:15,700 --> 00:06:17,450
from his web server.

142
00:06:17,450 --> 00:06:19,849
And these are patterns
that came back from time

143
00:06:19,850 --> 00:06:21,873
over a couple of few months.

144
00:06:23,170 --> 00:06:26,360
One thing that really
catch our attention is

145
00:06:26,360 --> 00:06:29,833
the picture that he posted on the blog.

146
00:06:33,250 --> 00:06:34,713
This is the web server log.

147
00:06:36,150 --> 00:06:38,219
Personally, I would love to say that

148
00:06:38,220 --> 00:06:40,330
this is a very beautiful and very sexy

149
00:06:40,330 --> 00:06:41,530
web server log (laughs).

150
00:06:42,970 --> 00:06:45,340
In brief, a bad guy,

151
00:06:45,340 --> 00:06:48,539
continuously hitting
on his web server log.

152
00:06:48,540 --> 00:06:51,650
He's tried to, tried his luck

153
00:06:51,650 --> 00:06:55,599
by guessing those kind of correct wallet,

154
00:06:55,600 --> 00:06:57,190
crypto wallet filename,

155
00:06:57,190 --> 00:07:00,739
with hope that there
are some crypto wallet

156
00:07:00,739 --> 00:07:04,200
appear or located on this web server.

157
00:07:04,200 --> 00:07:07,969
Now, how can we read this correct easily?

158
00:07:07,970 --> 00:07:10,763
The first column will be IP address.

159
00:07:11,820 --> 00:07:15,447
The second column will be the date

160
00:07:17,230 --> 00:07:18,460
and the timestamp.

161
00:07:18,460 --> 00:07:22,056
It followed by the HTTP get method,

162
00:07:22,057 --> 00:07:24,170
followed by the URL as well,

163
00:07:24,170 --> 00:07:26,960
with the history around response.

164
00:07:26,960 --> 00:07:29,477
Over here, we'll be seeing a lot of HTTP

165
00:07:30,730 --> 00:07:33,670
404, not found response.

166
00:07:33,670 --> 00:07:35,760
And last but not least,

167
00:07:35,760 --> 00:07:38,543
followed by the data
size and the user agent.

168
00:07:40,690 --> 00:07:42,760
Some guy just continued to try his luck,

169
00:07:42,760 --> 00:07:46,070
try to brute forcing or guessing

170
00:07:46,070 --> 00:07:48,010
different Bitcoin wallet filename.

171
00:07:48,010 --> 00:07:50,390
In this case, of course,

172
00:07:50,390 --> 00:07:53,409
he was hit with a lot of 404,

173
00:07:53,410 --> 00:07:55,660
not found HTTP error code

174
00:07:55,660 --> 00:07:58,210
because there was no any
Bitcoin wallet over there.

175
00:07:59,080 --> 00:08:03,123
Well, the things that catch
our attention the most,

176
00:08:04,460 --> 00:08:08,349
is the patterns of the
brute forcing activities

177
00:08:08,350 --> 00:08:09,743
or the pattern of the,

178
00:08:10,730 --> 00:08:14,700
by guessing those kind of
crypto wallet filename.

179
00:08:14,700 --> 00:08:15,800
Now, just for context,

180
00:08:16,870 --> 00:08:20,460
for common, in a common practice,

181
00:08:20,460 --> 00:08:22,130
crypto wallet could be named as

182
00:08:23,320 --> 00:08:24,483
wallet.dat,

183
00:08:25,540 --> 00:08:28,267
or wallet underscore backup.dat.

184
00:08:30,200 --> 00:08:32,130
In this case, bad guy

185
00:08:32,130 --> 00:08:35,020
tried to look for a zip file,

186
00:08:35,020 --> 00:08:38,449
which contain the crypto
wallet in this case.

187
00:08:38,450 --> 00:08:39,962
They are looking for the files

188
00:08:39,962 --> 00:08:43,460
with the filename called wallet.zip,

189
00:08:43,460 --> 00:08:47,183
or backup/wallet.zip.

190
00:08:48,170 --> 00:08:51,613
Now as a honeypot researcher,
or the honeypot hobbyist,

191
00:08:53,110 --> 00:08:55,490
anything that we can do right here?

192
00:08:55,490 --> 00:08:59,400
Can we try to feed the bad guy
with the data that they need

193
00:08:59,400 --> 00:09:01,810
and then make a fake content in it,

194
00:09:01,810 --> 00:09:05,262
and eventually this
zip file, or this data,

195
00:09:06,225 --> 00:09:08,870
that are accessed by the bad guy,

196
00:09:08,870 --> 00:09:10,960
and it will send us certain information

197
00:09:10,960 --> 00:09:13,610
about the bad guy behind the scene.

198
00:09:13,610 --> 00:09:17,090
This sort of forms,
so-called a concept for us

199
00:09:17,090 --> 00:09:20,140
which we would like to
introduce our new tools,

200
00:09:20,140 --> 00:09:21,943
a new open source tool,

201
00:09:22,960 --> 00:09:23,853
namely, Honeybag.

202
00:09:27,580 --> 00:09:30,220
Honeybag is a tool which allow,

203
00:09:30,220 --> 00:09:33,703
which helps all of us
to create a bait file.

204
00:09:34,799 --> 00:09:36,910
A zip file in this case.

205
00:09:36,910 --> 00:09:39,199
We can easily embed it with any content

206
00:09:39,200 --> 00:09:42,253
or such as files, folders into it.

207
00:09:43,270 --> 00:09:45,165
If someone access it,

208
00:09:45,166 --> 00:09:48,870
it will notify you, it
will notify us, yeah.

209
00:09:48,870 --> 00:09:51,450
The main goal for Honeybag is to,

210
00:09:51,450 --> 00:09:53,440
definitely about the notifications.

211
00:09:53,440 --> 00:09:57,193
We like to let this, so-called a bait,

212
00:09:58,030 --> 00:10:00,110
sitting quietly over there.

213
00:10:00,110 --> 00:10:02,770
If someone accidentally

214
00:10:02,770 --> 00:10:05,470
or intentionally access it,

215
00:10:05,470 --> 00:10:06,583
it will notify us.

216
00:10:07,420 --> 00:10:11,949
We hope that this can be helpful
for our security community

217
00:10:11,950 --> 00:10:14,270
in terms of the cybersecurity
defense point of view.

218
00:10:14,270 --> 00:10:16,300
And we hope that this can be useful

219
00:10:16,300 --> 00:10:18,959
for data breach detections

220
00:10:18,960 --> 00:10:22,403
or deceptive defense-based mechanism.

221
00:10:23,350 --> 00:10:24,820
Let's take a quick look together

222
00:10:24,820 --> 00:10:26,953
about how Honeybag works.

223
00:10:29,340 --> 00:10:30,830
In an easiest way,

224
00:10:30,830 --> 00:10:34,010
Honeybag will contain
three different components.

225
00:10:34,010 --> 00:10:37,090
It could be, it would be pretty easy to,

226
00:10:37,090 --> 00:10:38,950
to use in this case.

227
00:10:38,950 --> 00:10:41,050
So the first component will be

228
00:10:42,030 --> 00:10:44,810
this Honeybag command line client,

229
00:10:44,810 --> 00:10:47,400
which you have seen on
the screen right now.

230
00:10:47,400 --> 00:10:52,360
The second component will be
the Honeybag simple DNS server.

231
00:10:52,360 --> 00:10:54,008
For the third component,

232
00:10:54,008 --> 00:10:57,730
we can set up RESPONDER

233
00:10:57,730 --> 00:10:59,830
in order to work together with Honeybag.

234
00:10:59,830 --> 00:11:00,663
This can,

235
00:11:02,040 --> 00:11:04,772
these three components can
work well with each other,

236
00:11:05,760 --> 00:11:09,390
that, eventually, it just
can give us a good result.

237
00:11:09,390 --> 00:11:12,120
Well, I would say,

238
00:11:12,120 --> 00:11:13,410
what you have seen on
the screen right here.

239
00:11:13,410 --> 00:11:15,160
This is just a simple Python script

240
00:11:16,010 --> 00:11:17,890
for our Honeybag client.

241
00:11:17,890 --> 00:11:20,650
We can easily generate a bait zip file

242
00:11:20,650 --> 00:11:22,853
with any embedded files
and folders into it.

243
00:11:23,930 --> 00:11:25,479
We can, for example,

244
00:11:25,480 --> 00:11:28,580
we can insert or we can embed

245
00:11:28,580 --> 00:11:31,270
a PDF file, document file,

246
00:11:31,270 --> 00:11:33,370
or text file, or pictures,

247
00:11:33,370 --> 00:11:35,190
or anything into the zip file.

248
00:11:35,190 --> 00:11:36,227
And this will,

249
00:11:36,227 --> 00:11:38,569
Honeybag client will generate,

250
00:11:38,570 --> 00:11:40,560
so-called a final zip file for us.

251
00:11:40,560 --> 00:11:42,920
Now I will let us shift gear a bit.

252
00:11:42,920 --> 00:11:46,469
Let's try to take a look
about the final zip file.

253
00:11:46,470 --> 00:11:48,863
How the final zip file looks like?

254
00:11:51,130 --> 00:11:54,683
Now what you're seeing on
the right screen, right here.

255
00:11:56,384 --> 00:11:57,343
Our zip file,

256
00:11:58,630 --> 00:12:00,380
this is a so-called the simple tree view

257
00:12:00,380 --> 00:12:03,275
about one of the zip
file that we generated.

258
00:12:03,275 --> 00:12:07,090
The zip file namely as secret.zip.

259
00:12:07,090 --> 00:12:10,700
It contains a folder, a secret folder.

260
00:12:10,700 --> 00:12:13,370
We can easily customize this name.

261
00:12:13,370 --> 00:12:16,590
And then it contains just a single file.

262
00:12:16,590 --> 00:12:20,240
The file is supersecretdocument.pdf.

263
00:12:20,240 --> 00:12:21,073
I know,

264
00:12:21,073 --> 00:12:23,247
we have a lot of secret
right here (laughs).

265
00:12:26,240 --> 00:12:28,450
During the generation process,

266
00:12:28,450 --> 00:12:30,850
Honeybag will automatically slot

267
00:12:30,850 --> 00:12:32,270
two different new files

268
00:12:32,270 --> 00:12:34,610
into the secret zip file

269
00:12:34,610 --> 00:12:36,393
or under the secret folder.

270
00:12:37,810 --> 00:12:40,209
The first file will be the file

271
00:12:40,210 --> 00:12:44,350
ended with a file extension .url.

272
00:12:44,350 --> 00:12:46,390
The second file will be the file

273
00:12:46,390 --> 00:12:48,663
with the name desktop.ini.

274
00:12:49,990 --> 00:12:52,000
Both of these files will serve so-called

275
00:12:52,000 --> 00:12:55,260
the alerting mechanism for our Honeybag.

276
00:12:55,260 --> 00:12:56,800
And this is how,

277
00:12:56,800 --> 00:12:59,120
wherever someone tried to access the file,

278
00:12:59,120 --> 00:13:01,563
this alerting mechanism
will be kicking in.

279
00:13:03,180 --> 00:13:07,140
So for the first of file
which is the desktop.ini,

280
00:13:07,140 --> 00:13:09,420
and this is one of the very common file

281
00:13:09,420 --> 00:13:11,310
that every one of us will be encountered

282
00:13:11,310 --> 00:13:14,089
in Windows operating system.

283
00:13:14,090 --> 00:13:17,420
In fact, in a legitimate usage,

284
00:13:17,420 --> 00:13:20,089
desktop.ini is associated

285
00:13:20,090 --> 00:13:23,970
with how Windows display the folders

286
00:13:23,970 --> 00:13:26,250
on the Windows Explorer.

287
00:13:26,250 --> 00:13:27,083
For example,

288
00:13:28,388 --> 00:13:29,490
for a folder,

289
00:13:29,490 --> 00:13:34,130
if you want to customize
the icon for the folder,

290
00:13:34,130 --> 00:13:36,210
we can do it in a,

291
00:13:36,210 --> 00:13:38,310
with this desktop.ini.

292
00:13:38,310 --> 00:13:42,140
Desktop.ini will try to
look for the icon file

293
00:13:42,140 --> 00:13:43,203
on a local system.

294
00:13:44,410 --> 00:13:47,100
Well, credit to,

295
00:13:47,100 --> 00:13:49,090
thanks Canary token,

296
00:13:49,090 --> 00:13:51,370
for a very interesting technique.

297
00:13:51,370 --> 00:13:56,370
Instead of letting desktop.ini
look for icon file locally,

298
00:13:56,940 --> 00:13:57,840
you can tweak

299
00:13:59,420 --> 00:14:03,380
this mechanism to let desktop.ini

300
00:14:03,380 --> 00:14:07,220
looking for icon on the external location.

301
00:14:07,220 --> 00:14:09,670
It could be some icon file that's sitting

302
00:14:09,670 --> 00:14:13,353
on a certain domain, or a website,

303
00:14:13,354 --> 00:14:16,690
or it could be an icon file
which are located somewhere

304
00:14:17,890 --> 00:14:21,960
with some IP address on
somewhere out of the internet.

305
00:14:21,960 --> 00:14:24,750
So with these kind of tweaking,

306
00:14:24,750 --> 00:14:27,940
in fact, this is very handy for the,

307
00:14:27,940 --> 00:14:31,057
our alerting mechanism in this case, yeah.

308
00:14:31,057 --> 00:14:33,573
For the second file, the .url,

309
00:14:34,460 --> 00:14:37,260
we're going, we use almost a similar,

310
00:14:37,260 --> 00:14:40,330
a so-called mechanism,
which is for your LAP.

311
00:14:40,330 --> 00:14:43,640
The icon file tried to
look for the icon pictures,

312
00:14:43,640 --> 00:14:45,283
or the exact file itself,

313
00:14:46,140 --> 00:14:47,560
on external locations.

314
00:14:47,560 --> 00:14:49,989
It could be IP address sitting somewhere.

315
00:14:49,990 --> 00:14:54,760
Now we have this, secret zip file on hand,

316
00:14:54,760 --> 00:14:57,361
and once we place it somewhere

317
00:14:57,361 --> 00:15:00,200
on the computer networks,

318
00:15:00,200 --> 00:15:02,220
or it could be on the internet.

319
00:15:02,220 --> 00:15:06,070
What if a bad guy get this file,

320
00:15:06,070 --> 00:15:07,710
the secret.zip file?

321
00:15:07,710 --> 00:15:10,890
Now he tried to unzip the zip file

322
00:15:10,890 --> 00:15:12,689
and click into the folder.

323
00:15:12,690 --> 00:15:14,793
What will happen in this case?

324
00:15:17,750 --> 00:15:18,583
In this case,

325
00:15:20,440 --> 00:15:23,840
Honeybag the zip file
will trigger two alerts.

326
00:15:23,840 --> 00:15:27,635
The first alert will go to our
Honeybag simple DNS server.

327
00:15:27,635 --> 00:15:30,930
And then the second alert
will go to the RESPONDER

328
00:15:30,930 --> 00:15:34,257
which we set up, we can set it up on,

329
00:15:34,258 --> 00:15:37,250
we host it on certain IP
address on the internet.

330
00:15:37,250 --> 00:15:41,630
Now for the Honeybag simple DNS component,

331
00:15:41,630 --> 00:15:43,120
DNS server component,

332
00:15:43,120 --> 00:15:46,003
there is a little listen on DNS traffic.

333
00:15:47,070 --> 00:15:49,410
It will perform certain logging

334
00:15:49,410 --> 00:15:52,403
with just simply on the SQLite database.

335
00:15:53,330 --> 00:15:56,750
In this case, we will start to collect

336
00:15:56,750 --> 00:16:00,230
some information such
as the computer name,

337
00:16:00,230 --> 00:16:02,700
the user name, the domain name

338
00:16:02,700 --> 00:16:04,690
from the Windows machines

339
00:16:04,690 --> 00:16:07,930
which used to access, or used to unzip

340
00:16:07,930 --> 00:16:09,313
and open our zip file.

341
00:16:10,350 --> 00:16:13,930
Well, for the RESPONDER perspective,

342
00:16:13,930 --> 00:16:16,260
we can collect, maybe, it could be

343
00:16:16,260 --> 00:16:19,350
source IP address, the username,

344
00:16:19,350 --> 00:16:20,790
computer name.

345
00:16:20,790 --> 00:16:22,449
And if we're lucky enough,

346
00:16:22,450 --> 00:16:25,530
we will able to get some NTLMv2 hashes

347
00:16:25,530 --> 00:16:27,303
or NTLM hashes in this case.

348
00:16:29,227 --> 00:16:31,000
It's going to be small little pieces

349
00:16:31,000 --> 00:16:32,880
of the information here and there.

350
00:16:32,880 --> 00:16:34,800
IP, source IP address.

351
00:16:34,800 --> 00:16:37,370
but eventually all this information,

352
00:16:37,370 --> 00:16:38,900
it can gel out together

353
00:16:38,900 --> 00:16:40,520
and it can form a very beautiful

354
00:16:40,520 --> 00:16:43,903
and very useful investigation
picture for all of us.

355
00:16:45,650 --> 00:16:46,800
Now, a little bit,

356
00:16:46,800 --> 00:16:48,805
a caveat right here.

357
00:16:48,805 --> 00:16:51,290
For our alerting mechanism to work,

358
00:16:51,290 --> 00:16:54,900
desktop.ini and the .url file,

359
00:16:54,900 --> 00:16:55,890
both of them,

360
00:16:55,890 --> 00:16:56,723
they are more applicable

361
00:16:56,723 --> 00:16:59,543
for Windows operating system as for now.

362
00:17:00,730 --> 00:17:03,010
Well, let's see an example.

363
00:17:03,010 --> 00:17:05,609
If someone tried to get,

364
00:17:05,609 --> 00:17:07,869
able to get a secret.zip file

365
00:17:07,869 --> 00:17:10,089
and he or she opened it and access it

366
00:17:10,089 --> 00:17:13,786
in Linux or in OS X,

367
00:17:13,787 --> 00:17:14,953
Mac OS X environment.

368
00:17:15,900 --> 00:17:20,250
We will not able to receive
any alerts as for now.

369
00:17:20,250 --> 00:17:23,349
Yeah, we are always looking for new idea,

370
00:17:23,349 --> 00:17:26,449
new techniques which we can apply,

371
00:17:26,450 --> 00:17:31,040
building mechanism for
Linux and OS X machines.

372
00:17:31,040 --> 00:17:33,330
So if you came across with any of these

373
00:17:33,330 --> 00:17:35,510
interesting techniques or new idea,

374
00:17:35,510 --> 00:17:37,379
feel free to reach out to us.

375
00:17:37,380 --> 00:17:38,500
We would like to hear about this

376
00:17:38,500 --> 00:17:41,350
and hopefully we can implement
this in the Honeybag.

377
00:17:41,350 --> 00:17:43,919
And for this is an open source tool,

378
00:17:43,920 --> 00:17:46,940
so hopefully it can be
useful for our community

379
00:17:46,940 --> 00:17:49,250
and especially in terms
of the cybersecurity,

380
00:17:49,250 --> 00:17:51,360
I mean, cyber defender's point of view.

381
00:17:51,360 --> 00:17:52,193
Yeah.

382
00:17:53,560 --> 00:17:55,613
Now things are getting interesting.

383
00:17:57,112 --> 00:18:00,153
Since we have this zip
file right now on hand,

384
00:18:01,680 --> 00:18:02,950
well, I will say that,

385
00:18:02,950 --> 00:18:05,853
this technique is not really brand new.

386
00:18:06,946 --> 00:18:11,429
There were numbers of blogs and articles

387
00:18:11,430 --> 00:18:12,690
about this type of technique

388
00:18:12,690 --> 00:18:17,690
with .url or desktop.ini approach.

389
00:18:17,930 --> 00:18:21,010
But for Honeybag, one
of our highlights is,

390
00:18:21,010 --> 00:18:23,520
this is an open source tool.

391
00:18:23,520 --> 00:18:27,330
We can easily generate a
zip file with any folder

392
00:18:27,330 --> 00:18:32,330
or any embedded files
and folders as we like.

393
00:18:32,370 --> 00:18:33,830
You can easily customize.

394
00:18:33,830 --> 00:18:35,120
So for example,

395
00:18:35,120 --> 00:18:38,669
we can turn just a single file,

396
00:18:38,670 --> 00:18:39,530
zip file,

397
00:18:39,530 --> 00:18:41,520
or it could be thousands of zip files,

398
00:18:41,520 --> 00:18:43,550
since it's just a Python script.

399
00:18:43,550 --> 00:18:46,399
We can easily integrate in other
scripting language as well.

400
00:18:46,400 --> 00:18:48,043
I mean, yeah, or system.

401
00:18:49,310 --> 00:18:51,510
While we have these
tools on hand right now,

402
00:18:52,730 --> 00:18:54,190
the next question will be,

403
00:18:54,190 --> 00:18:57,653
how can you play with it
and get the best out of it?

404
00:18:58,780 --> 00:19:00,790
Well we have lots of thoughts,

405
00:19:00,790 --> 00:19:02,840
lots of discussions.

406
00:19:02,840 --> 00:19:06,580
How can we create this kind of use case?

407
00:19:06,580 --> 00:19:09,590
And we came across with
this very interesting idea.

408
00:19:09,590 --> 00:19:12,760
Everybody gonna love Bitcoin wallet.

409
00:19:12,760 --> 00:19:14,240
Yeah?

410
00:19:14,240 --> 00:19:15,073
So what if,

411
00:19:15,073 --> 00:19:18,300
if we place a $100,000
worth of a Bitcoin wallet

412
00:19:18,300 --> 00:19:20,790
and we just leave it there on the internet

413
00:19:20,790 --> 00:19:22,822
for 90 days.

414
00:19:23,720 --> 00:19:26,023
What will happen to all of them?

415
00:19:27,470 --> 00:19:30,770
Well, once, after we had this idea,

416
00:19:30,770 --> 00:19:33,263
I came across with a very huge roadblock.

417
00:19:34,810 --> 00:19:39,360
Personally I don't have
$100,000 worth of Bitcoin wallet

418
00:19:39,360 --> 00:19:40,360
on my hand (laughs).

419
00:19:41,510 --> 00:19:43,307
Now, if anyone would like to donate this,

420
00:19:43,307 --> 00:19:47,520
$100,000 worth of Bitcoin
wallet to me or Bitcoin to me,

421
00:19:47,520 --> 00:19:49,447
thank you very much in advance (laughs).

422
00:19:52,660 --> 00:19:53,493
Well.

423
00:19:54,960 --> 00:19:56,960
After we searching around

424
00:19:56,960 --> 00:19:58,320
and then we came across with this

425
00:19:58,320 --> 00:20:00,253
very interesting alternative,

426
00:20:01,690 --> 00:20:04,360
namely, Bitcoin Testnet,

427
00:20:04,360 --> 00:20:06,602
which is a BTC Testnet.

428
00:20:09,010 --> 00:20:11,750
We prepare 10 Bitcoin wallets,

429
00:20:11,750 --> 00:20:14,260
and each of them is unprotected.

430
00:20:14,260 --> 00:20:15,660
When they contain,

431
00:20:15,660 --> 00:20:20,357
each of them contain one
BTC Testnet in this case.

432
00:20:21,480 --> 00:20:24,150
Now some differences between BTC Testnet

433
00:20:24,150 --> 00:20:27,000
and BTC, which is Bitcoin.

434
00:20:27,900 --> 00:20:31,620
BTC Testnet is meant for testing purposes.

435
00:20:31,620 --> 00:20:32,453
For lots of,

436
00:20:32,453 --> 00:20:35,149
it's very useful for lots
of blockchain developers

437
00:20:35,150 --> 00:20:40,150
or wallet, crypto application developers,

438
00:20:40,800 --> 00:20:44,899
because the BTC Testnet and BTC,

439
00:20:44,900 --> 00:20:47,760
they are using the same
mechanism at the back.

440
00:20:47,760 --> 00:20:49,890
But while BTC testing,

441
00:20:49,890 --> 00:20:53,483
it doesn't associate with any real value,

442
00:20:54,630 --> 00:20:57,490
for example, tied to any currency value.

443
00:20:57,490 --> 00:21:00,400
While Bitcoin itself is associated,

444
00:21:00,400 --> 00:21:01,620
could be to the currency

445
00:21:01,620 --> 00:21:04,280
such as the U.S. dollar in this case.

446
00:21:04,280 --> 00:21:06,860
While we are looking at the addresses,

447
00:21:06,860 --> 00:21:09,979
the BTC Testnet and BTC addresses,

448
00:21:09,980 --> 00:21:13,980
the prefix with a
so-called different prefix

449
00:21:16,540 --> 00:21:18,940
at the front of each addresses,

450
00:21:18,940 --> 00:21:20,950
in terms of the wallet perspective,

451
00:21:20,950 --> 00:21:23,520
for me, they look pretty similar.

452
00:21:23,520 --> 00:21:24,530
Yeah.

453
00:21:24,530 --> 00:21:27,139
We can use some similar

454
00:21:27,140 --> 00:21:29,623
crypto wallet application to open it.

455
00:21:30,680 --> 00:21:32,793
But the best things about BTC Testnet,

456
00:21:33,710 --> 00:21:35,670
they are freely available on the internet.

457
00:21:35,670 --> 00:21:40,670
We can get it freely from
different faucet on the internet.

458
00:21:40,890 --> 00:21:43,290
But if you go for the same approach,

459
00:21:43,290 --> 00:21:45,320
I would really suggest that,

460
00:21:45,320 --> 00:21:50,169
once we finish use it
for different use cases,

461
00:21:50,170 --> 00:21:53,070
please transfer it back to the faucet

462
00:21:53,070 --> 00:21:56,129
so other developers or other members,

463
00:21:56,130 --> 00:21:59,580
I mean, anyone in the
community can use it later.

464
00:21:59,580 --> 00:22:00,413
Yeah.

465
00:22:00,413 --> 00:22:04,240
So we have this use
case back in early 2020.

466
00:22:05,200 --> 00:22:08,890
During that time, one BTC, one Bitcoin

467
00:22:08,890 --> 00:22:10,700
will be equivalent to around U.S.,

468
00:22:10,700 --> 00:22:12,880
10 U.S. dollar.

469
00:22:12,880 --> 00:22:14,440
Yeah.

470
00:22:14,440 --> 00:22:15,273
So,

471
00:22:16,630 --> 00:22:20,020
well, I want to bring it up this human,

472
00:22:20,020 --> 00:22:22,440
this wallet, the terms.

473
00:22:22,440 --> 00:22:24,570
You know, human psychology perspective,

474
00:22:24,570 --> 00:22:27,700
wallet is something always interesting.

475
00:22:27,700 --> 00:22:30,780
It's interest, it's a
placeholder for valuable,

476
00:22:30,780 --> 00:22:35,780
such as cash, note,

477
00:22:36,100 --> 00:22:38,590
credit card or identifications or cards,

478
00:22:38,590 --> 00:22:41,970
which appear, which will
be appear in a wallet.

479
00:22:41,970 --> 00:22:43,430
In real life,

480
00:22:43,430 --> 00:22:48,430
what if someone encountered
this wallet on a street,

481
00:22:49,170 --> 00:22:52,900
or on a desk in a restaurant,

482
00:22:52,900 --> 00:22:54,000
will someone take it

483
00:22:55,270 --> 00:22:58,270
and try to contact the owner?

484
00:22:58,270 --> 00:23:01,210
Or will someone just take
it and take all the cash,

485
00:23:01,210 --> 00:23:02,043
all of it?

486
00:23:03,470 --> 00:23:07,757
So what if we leave all
our 10 Bitcoin wallets

487
00:23:07,757 --> 00:23:08,590
on the internet.

488
00:23:08,590 --> 00:23:10,423
What will happen to all of them?

489
00:23:12,370 --> 00:23:17,050
So we decided to put all
these 10 Bitcoin wallets

490
00:23:17,050 --> 00:23:20,570
on a multiple, open directory server,

491
00:23:20,570 --> 00:23:22,590
web server on the internet.

492
00:23:22,590 --> 00:23:25,762
We just let them sitting
quietly over there.

493
00:23:25,762 --> 00:23:29,010
We just want to wait for
things to be happened.

494
00:23:29,010 --> 00:23:33,500
Of course, we try to make
this web server look real.

495
00:23:33,500 --> 00:23:36,410
So we put a lot of many personal info,

496
00:23:36,410 --> 00:23:38,660
files on the web server.

497
00:23:38,660 --> 00:23:40,880
A bunch of documents over there.

498
00:23:40,880 --> 00:23:44,473
So the web server looks kind
of pretty real in a sense.

499
00:23:45,400 --> 00:23:48,590
Now, once we have all
of this kind of set up,

500
00:23:48,590 --> 00:23:51,473
what we really expect is,

501
00:23:52,350 --> 00:23:54,439
this full screen of very sexy

502
00:23:54,440 --> 00:23:57,370
and very beautiful web server log.

503
00:23:57,370 --> 00:23:59,760
And we really expect
that different hackers,

504
00:23:59,760 --> 00:24:01,757
or different trackers
or different bad guy,

505
00:24:01,757 --> 00:24:05,990
try to fight with each other
for our Bitcoin wallet.

506
00:24:05,990 --> 00:24:08,350
We hope that they can
keep continuously grab

507
00:24:08,350 --> 00:24:13,020
different copy of our Bitcoin
wallet from our web server.

508
00:24:13,020 --> 00:24:14,220
This is our expectation.

509
00:24:15,370 --> 00:24:18,500
Well, in reality,

510
00:24:18,500 --> 00:24:20,983
in reality, it's so disappointing.

511
00:24:22,601 --> 00:24:25,810
Our web server is just simply quiet,

512
00:24:25,810 --> 00:24:28,393
for the first 30 days or 35 days.

513
00:24:29,940 --> 00:24:33,117
From time to time, we have seen
some cat and flies (laughs).

514
00:24:33,960 --> 00:24:35,740
We sit there and say hi.

515
00:24:35,740 --> 00:24:37,720
If you're lucky enough,

516
00:24:37,720 --> 00:24:39,321
you may come across with a Google bot

517
00:24:39,321 --> 00:24:41,403
or Bing bots talk to us.

518
00:24:43,550 --> 00:24:45,260
This could be due to the reason that

519
00:24:45,260 --> 00:24:47,763
this pretty new web server that we,

520
00:24:48,666 --> 00:24:50,860
which appear on the internet,

521
00:24:50,860 --> 00:24:52,129
it could be a new resources.

522
00:24:52,130 --> 00:24:54,800
So no one really noticed about this.

523
00:24:54,800 --> 00:24:57,000
So first lesson learned,

524
00:24:57,000 --> 00:24:58,743
just be patient, yeah.

525
00:24:59,790 --> 00:25:02,670
We start to have a different approach

526
00:25:02,670 --> 00:25:04,500
about how can we improve it.

527
00:25:04,500 --> 00:25:08,370
So we decided to go for
more corrective approach.

528
00:25:08,370 --> 00:25:11,850
So we try to put miscellaneous
information on Pastebin,

529
00:25:11,850 --> 00:25:16,850
such as, hey buddy, this
is my secret crypto wallet.

530
00:25:18,690 --> 00:25:20,270
Please don't download it.

531
00:25:20,270 --> 00:25:21,650
Please don't download it.

532
00:25:21,650 --> 00:25:23,840
Once we put the word,
please don't download it,

533
00:25:23,840 --> 00:25:25,149
things are getting interesting.

534
00:25:25,150 --> 00:25:30,120
'Cause people are starting to
download it and to access it.

535
00:25:30,120 --> 00:25:34,892
Now in overall, what happened in 90 days?

536
00:25:36,710 --> 00:25:40,350
Interestingly, all our 10 Bitcoin wallets

537
00:25:40,350 --> 00:25:41,523
which we created with Honeybag,

538
00:25:41,523 --> 00:25:44,163
all the zip files were stolen.

539
00:25:45,160 --> 00:25:47,530
Nine of the 10 Bitcoin wallets

540
00:25:47,530 --> 00:25:49,070
gave us certain information

541
00:25:49,070 --> 00:25:51,538
about the bad guy behind the scene.

542
00:25:51,538 --> 00:25:54,113
And we have one missing crypto wallet.

543
00:25:55,370 --> 00:25:57,360
I suspect that this could be due to

544
00:25:57,360 --> 00:25:59,659
the wallet was accessed in a Linux

545
00:25:59,660 --> 00:26:02,180
or in a Mac OS X environment.

546
00:26:02,180 --> 00:26:04,243
So we have never received anything back.

547
00:26:05,730 --> 00:26:07,660
An interesting observation.

548
00:26:07,660 --> 00:26:12,050
The fastest record for
one of the stolen wallets

549
00:26:12,050 --> 00:26:15,783
is almost less than a minute
after we posted on Pastebin.

550
00:26:17,550 --> 00:26:18,940
This could be due to,

551
00:26:18,940 --> 00:26:21,340
maybe certain automated bot,

552
00:26:21,340 --> 00:26:24,649
or it could be a human behind a keyboard.

553
00:26:24,650 --> 00:26:25,483
Who knows?

554
00:26:28,738 --> 00:26:30,940
For the next five minutes or 10 minutes,

555
00:26:30,940 --> 00:26:33,840
let me show you about
one unexpected scene.

556
00:26:33,840 --> 00:26:36,220
Yeah, there was someone
just totally wipe out

557
00:26:36,220 --> 00:26:38,843
our Bitcoin Testnet wallet.

558
00:26:40,100 --> 00:26:44,429
Well, the whole story started

559
00:26:44,430 --> 00:26:47,250
around March 23rd last year.

560
00:26:47,250 --> 00:26:48,760
We created this Bitcoin wallet

561
00:26:48,760 --> 00:26:50,410
and we placed it on the internet.

562
00:26:51,380 --> 00:26:54,450
Within, I would say less than 24 hours,

563
00:26:54,450 --> 00:26:57,400
surprisingly and unexpectedly,

564
00:26:57,400 --> 00:26:59,670
the value in our Bitcoin wallet

565
00:26:59,670 --> 00:27:02,120
become totally empty, becomes zero,

566
00:27:02,120 --> 00:27:04,449
which is what you can see
on the screen right now.

567
00:27:04,450 --> 00:27:08,010
Somebody has just wiped
out our BTC Testnet wallet.

568
00:27:08,010 --> 00:27:10,720
Hey buddy, this is BTC Testnet.

569
00:27:10,720 --> 00:27:11,940
There is no value into it.

570
00:27:11,940 --> 00:27:16,079
Why you wipe out our entire BTC Testnet?

571
00:27:16,079 --> 00:27:17,440
And now let me try to take a quick look

572
00:27:17,440 --> 00:27:19,550
about the three different
components right here,

573
00:27:19,550 --> 00:27:23,513
so we can form a nice timeline
investigation panel together.

574
00:27:25,290 --> 00:27:26,710
Back in March 23rd,

575
00:27:26,710 --> 00:27:28,250
ahh, 24th,

576
00:27:28,250 --> 00:27:31,630
we, someone access our web server

577
00:27:31,630 --> 00:27:36,630
and retrieve the wallet.zip
file from our web server.

578
00:27:38,160 --> 00:27:39,083
This case will be,

579
00:27:40,010 --> 00:27:45,010
he got a file from /bitcoin/wallet.zip.

580
00:27:45,090 --> 00:27:49,143
Our web server responds
with a HTTP code 200.

581
00:27:50,220 --> 00:27:53,370
In this case it indicates
a success download.

582
00:27:53,370 --> 00:27:58,370
Followed by the common user
agent for Firefox version 74.

583
00:27:58,950 --> 00:28:03,033
Well, these things happen in 14:40 UTC.

584
00:28:06,040 --> 00:28:07,629
Two minutes afterwards,

585
00:28:07,630 --> 00:28:12,460
we start to observe that we
received these DNS requests,

586
00:28:12,460 --> 00:28:14,343
pretty long DNS requests,

587
00:28:15,570 --> 00:28:18,120
which appear on the screen right here.

588
00:28:18,120 --> 00:28:20,120
Now, this DNS request is,

589
00:28:20,120 --> 00:28:24,000
the format itself is
pre-crafted for all of us.

590
00:28:24,000 --> 00:28:28,070
And then the first column will be

591
00:28:28,070 --> 00:28:30,980
the value which belongs to the username

592
00:28:30,980 --> 00:28:32,580
or the Windows operating system.

593
00:28:33,890 --> 00:28:35,920
We should, in this case,
will be a Mr. Blue.

594
00:28:35,920 --> 00:28:39,340
Second column will be,
so-called the computer name.

595
00:28:39,340 --> 00:28:41,913
In this case will be the DESKTOP-AFMMB6K.

596
00:28:45,790 --> 00:28:49,822
And the third column will be
the DESKTOP-AFMMB6K as well,

597
00:28:51,280 --> 00:28:52,850
this is the domain name.

598
00:28:52,850 --> 00:28:56,490
So once we get these DNS requests,

599
00:28:56,490 --> 00:29:00,690
this indicates that the bad guy was

600
00:29:00,690 --> 00:29:02,204
unzip our zip file,

601
00:29:02,204 --> 00:29:03,700
look into the zip file,

602
00:29:03,700 --> 00:29:05,944
click into the secret folder in this case,

603
00:29:05,944 --> 00:29:08,197
under Windows Explorer

604
00:29:08,197 --> 00:29:09,959
on a Windows machine.

605
00:29:09,960 --> 00:29:12,300
Now things are getting interesting because

606
00:29:12,300 --> 00:29:15,409
of the whole alerts are
continuously appear for 20 minutes.

607
00:29:15,410 --> 00:29:16,550
Now we realized that,

608
00:29:16,550 --> 00:29:20,820
hey, the folk is try to
looking into our crypto wallet

609
00:29:20,820 --> 00:29:22,893
for around 20 minutes during that time.

610
00:29:24,617 --> 00:29:26,379
For the third component,

611
00:29:26,380 --> 00:29:28,928
this is about the RESPONDER perspective.

612
00:29:28,928 --> 00:29:33,650
Well, we collected so-called NTMv2 hashes.

613
00:29:33,650 --> 00:29:37,350
In this case, the username Mr. Blue, is

614
00:29:37,350 --> 00:29:40,850
exactly tie with what we have
seen on the DNS log just now.

615
00:29:40,850 --> 00:29:43,199
And the computer name appear
to be the same as well.

616
00:29:43,200 --> 00:29:47,503
Now these hash can be useful
for certain analysis later.

617
00:29:49,380 --> 00:29:50,240
In overall,

618
00:29:50,240 --> 00:29:53,920
in that timeline, the
investigation timeline,

619
00:29:53,920 --> 00:29:57,840
was around 14:40 UTC.

620
00:29:57,840 --> 00:30:00,470
Our wallet was stolen from our web server.

621
00:30:00,470 --> 00:30:02,100
Two minutes afterward,

622
00:30:02,100 --> 00:30:04,429
we received the first DNS alert,

623
00:30:04,430 --> 00:30:06,593
indicates that somebody was accessing our,

624
00:30:08,132 --> 00:30:09,860
our folder and zip file.

625
00:30:09,860 --> 00:30:11,040
It continuously with,

626
00:30:11,040 --> 00:30:14,629
appear with this SMB alert
in our RESPONDER log.

627
00:30:14,630 --> 00:30:17,180
Well, 35 minutes

628
00:30:17,180 --> 00:30:21,600
from the first moment our
wallet.zip file gets stolen,

629
00:30:21,600 --> 00:30:25,352
Mr. Blue wipe out our BTC Testnet wallet.

630
00:30:26,619 --> 00:30:29,803
Until right now, I have
no idea why he did this.

631
00:30:30,950 --> 00:30:32,690
It could be, I guess,

632
00:30:32,690 --> 00:30:35,070
could be, he found out what we did.

633
00:30:35,070 --> 00:30:36,139
Since this is a bait,

634
00:30:36,140 --> 00:30:39,100
and he just piss off (laughs)

635
00:30:39,100 --> 00:30:41,159
about what we have done right here.

636
00:30:41,160 --> 00:30:42,610
Now I'm just joking (laughs).

637
00:30:44,820 --> 00:30:46,189
Lesson learned.

638
00:30:46,190 --> 00:30:47,980
It is always good to
have a different pieces

639
00:30:47,980 --> 00:30:49,730
of this evidence.

640
00:30:49,730 --> 00:30:53,220
We can gel all these kind
of evidence together.

641
00:30:53,220 --> 00:30:54,970
Eventually this can give us

642
00:30:54,970 --> 00:30:58,333
a very good investigation
timeline or the pictures.

643
00:31:00,750 --> 00:31:03,373
I would love to share a
couple of do and don't.

644
00:31:04,770 --> 00:31:06,270
First lesson learned, right here,

645
00:31:06,270 --> 00:31:08,163
just be patient.

646
00:31:09,170 --> 00:31:10,950
Initially we expect a very beautiful

647
00:31:10,950 --> 00:31:13,150
and very sexy web server log.

648
00:31:13,150 --> 00:31:14,320
We hope that it,

649
00:31:14,320 --> 00:31:15,179
the folks, the bad guy,

650
00:31:15,180 --> 00:31:18,160
would try to fight with
themselves and try to grab

651
00:31:18,160 --> 00:31:21,563
a copy of the Bitcoin
wallet from our web server.

652
00:31:22,460 --> 00:31:26,670
In fact, we had to wait
for more than 35 or 30 days

653
00:31:26,670 --> 00:31:28,220
to get the first result.

654
00:31:28,220 --> 00:31:29,580
It's always the pain

655
00:31:29,580 --> 00:31:32,030
and the fun for honeypot researchers,

656
00:31:32,030 --> 00:31:33,910
cybersecurity researchers.

657
00:31:33,910 --> 00:31:35,420
It always takes, take time

658
00:31:35,420 --> 00:31:37,403
and then we can harvest a good result.

659
00:31:38,280 --> 00:31:40,180
Well, I will suggest that

660
00:31:40,180 --> 00:31:43,640
customize our own unique deceptive baits.

661
00:31:43,640 --> 00:31:45,550
All these kind of, all these baits,

662
00:31:45,550 --> 00:31:47,120
the more unique it is,

663
00:31:47,120 --> 00:31:51,830
I believe that the impact
will be better definitely.

664
00:31:51,830 --> 00:31:52,663
Yeah.

665
00:31:53,550 --> 00:31:56,300
I also would like to
suggest that we should

666
00:31:56,300 --> 00:31:59,980
put up the warning banner, in
this case a warning message.

667
00:31:59,980 --> 00:32:04,880
Hey buddy, this is a restricted area

668
00:32:04,880 --> 00:32:06,840
or restricted resources.

669
00:32:06,840 --> 00:32:09,550
You are not authorized to access this.

670
00:32:09,550 --> 00:32:11,370
While someone try to bypass

671
00:32:11,370 --> 00:32:14,260
or ignore totally about this
kind of warning message,

672
00:32:14,260 --> 00:32:16,260
well, things can be getting interesting.

673
00:32:19,970 --> 00:32:22,320
One last thing I want to
mention right here is,

674
00:32:23,540 --> 00:32:25,372
never underestimate

675
00:32:25,372 --> 00:32:27,730
for the great impact of this.

676
00:32:27,730 --> 00:32:29,730
For us, initially,

677
00:32:29,730 --> 00:32:31,420
the design of the Honeybag

678
00:32:31,420 --> 00:32:34,420
is meant to be more applicable
for Windows operating system.

679
00:32:35,830 --> 00:32:39,540
Well, surprisingly nine out of 10

680
00:32:39,540 --> 00:32:41,440
of our Bitcoin wallet

681
00:32:41,440 --> 00:32:44,180
return certain information
about the bad guy

682
00:32:44,180 --> 00:32:45,699
behind the scene.

683
00:32:45,699 --> 00:32:47,630
This is unexpected result,

684
00:32:47,630 --> 00:32:50,550
and definitely never underestimate

685
00:32:50,550 --> 00:32:53,510
about a great impact out of it.

686
00:32:53,510 --> 00:32:55,070
The more unique it is,

687
00:32:55,070 --> 00:32:57,129
the more tailor-made it is,

688
00:32:57,130 --> 00:33:00,243
the honeytokens, the impact
can be really useful.

689
00:33:01,180 --> 00:33:03,960
I will, let's say, start
to deploy your own unique

690
00:33:03,960 --> 00:33:05,940
honeytokens today.

691
00:33:05,940 --> 00:33:07,390
If you like to give it a try,

692
00:33:08,400 --> 00:33:12,653
please feel free to try
on our Honeybag new tool.

693
00:33:12,653 --> 00:33:16,680
A tool that will help you
to create a bait zip file,

694
00:33:16,680 --> 00:33:17,980
archive file,

695
00:33:17,980 --> 00:33:21,601
can easily embed any
folder or files into it.

696
00:33:21,601 --> 00:33:24,051
It will ask you, notify
you if someone access it.

697
00:33:24,950 --> 00:33:26,400
The GitHub page is here.

698
00:33:26,400 --> 00:33:30,440
So you can feel free to
download and access it.

699
00:33:30,440 --> 00:33:31,910
Now we also would like to welcome

700
00:33:31,910 --> 00:33:35,690
if anyone like to
contribute to this project.

701
00:33:35,690 --> 00:33:38,520
If you have any new
techniques that we can apply,

702
00:33:38,520 --> 00:33:43,000
alerting mechanism in the
Linux or in OS X environment,

703
00:33:43,000 --> 00:33:44,860
yeah, please share with us.

704
00:33:44,860 --> 00:33:49,218
Yeah, feel free to ask any
questions for today's session.

705
00:33:49,219 --> 00:33:51,650
I would love to thank RSA Conference

706
00:33:51,650 --> 00:33:55,460
for this wonderful opportunity
for me to share about,

707
00:33:55,460 --> 00:33:57,580
for us to share about our new tools,

708
00:33:57,580 --> 00:33:59,280
the Honeybag tool right here.

709
00:33:59,280 --> 00:34:03,760
And thanks for listening
to my Bitcoin wallet story.

710
00:34:03,760 --> 00:34:04,800
Thank you very much.

