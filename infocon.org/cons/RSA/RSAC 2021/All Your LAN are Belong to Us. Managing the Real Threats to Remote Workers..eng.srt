1
00:00:01,120 --> 00:00:03,130
- Well, hello everybody.

2
00:00:03,130 --> 00:00:05,150
I greet you from Cape town, South Africa.

3
00:00:05,150 --> 00:00:08,090
My name is Charl Van Der
Walt and I'm the head of

4
00:00:08,090 --> 00:00:10,453
security research at Orange Cyberdefense.

5
00:00:11,396 --> 00:00:13,940
Orange Cyberdefense is a leading provider

6
00:00:13,940 --> 00:00:16,309
of security solutions and products

7
00:00:17,510 --> 00:00:19,270
headquartered in Paris, France.

8
00:00:19,270 --> 00:00:21,393
I'm joined today by my colleague Wicus.

9
00:00:22,880 --> 00:00:25,270
- Hello everybody, Wicus Ross,

10
00:00:25,270 --> 00:00:27,503
senior security researcher
at Orange Cyberdefense

11
00:00:27,503 --> 00:00:29,512
and I'm also based in Cape town.

12
00:00:31,380 --> 00:00:34,660
- So we're here today to share
with you our presentation

13
00:00:34,660 --> 00:00:37,540
titled "All your LAN are belong to us.

14
00:00:37,540 --> 00:00:40,310
And really what we wanna
do is explore with you

15
00:00:40,310 --> 00:00:42,760
the new set of risks
and threats that emerge

16
00:00:42,760 --> 00:00:45,430
because your people are working from home.

17
00:00:45,430 --> 00:00:47,000
And in particular, we wanna look at

18
00:00:47,000 --> 00:00:50,100
the role that specific
security technologies

19
00:00:50,100 --> 00:00:53,000
and secure remote access play
in countering those threats.

20
00:00:56,100 --> 00:00:58,560
So we all know that COVID and the pandemic

21
00:00:58,560 --> 00:01:00,150
and lockdown has changed the game.

22
00:01:00,150 --> 00:01:01,440
Everyone's talking about it.

23
00:01:01,440 --> 00:01:04,300
It seems clear that
something is different.

24
00:01:04,300 --> 00:01:06,690
What's not so clear, I
think is what's different.

25
00:01:06,690 --> 00:01:08,350
What has actually changed?

26
00:01:08,350 --> 00:01:11,119
There's this perception
that because our people

27
00:01:11,120 --> 00:01:14,340
are working from home, they're
gonna be attacked more.

28
00:01:14,340 --> 00:01:16,590
And that somehow COVID and the pandemic

29
00:01:16,590 --> 00:01:20,923
are gonna play a role in
that wave of new attacks.

30
00:01:22,000 --> 00:01:25,450
But, you know, a study
by Checkpoint recently,

31
00:01:25,450 --> 00:01:30,450
suggests that this may not
be exactly what we think.

32
00:01:30,670 --> 00:01:33,410
This graph very briefly
just illustrates that

33
00:01:33,410 --> 00:01:36,490
although there was a
slight blip over the peak

34
00:01:36,490 --> 00:01:39,640
of the first wave of the COVID pandemic,

35
00:01:39,640 --> 00:01:43,550
where attackers were pivoting
to using COVID related themes.

36
00:01:43,550 --> 00:01:47,860
Overall, in fact, the
number of attacks decreased

37
00:01:47,860 --> 00:01:49,070
over that time.

38
00:01:49,070 --> 00:01:52,243
And the blip that we did
see was very short-lived.

39
00:01:54,070 --> 00:01:58,970
So if attacks targeting our
users based on a COVID premise

40
00:01:58,970 --> 00:02:02,039
are not the new thing, then what is?

41
00:02:02,040 --> 00:02:04,750
Well I think what we
have to recognize is that

42
00:02:04,750 --> 00:02:08,490
this changes that we see
associated with the pandemic

43
00:02:08,490 --> 00:02:10,150
are systemic changes.

44
00:02:10,150 --> 00:02:11,640
And there are several of these,

45
00:02:11,640 --> 00:02:14,559
but I wanna focus on one in particular.

46
00:02:14,560 --> 00:02:17,980
And that's the increased use of WIFI

47
00:02:17,980 --> 00:02:20,369
as a way of connecting to the internet.

48
00:02:20,370 --> 00:02:23,360
This data from Open Signal
shows us very clearly,

49
00:02:23,360 --> 00:02:28,360
that at some point, during
the first wave of the pandemic

50
00:02:28,460 --> 00:02:30,490
in various geographies across the world,

51
00:02:30,490 --> 00:02:32,580
there was a marked increase

52
00:02:32,580 --> 00:02:35,550
in connectivity to the
internet using WIFI.

53
00:02:35,550 --> 00:02:39,210
And I think we can assume
that's gonna be home WIFI.

54
00:02:39,210 --> 00:02:41,530
So our users are
connecting to the internet

55
00:02:41,530 --> 00:02:44,410
and connecting to our
enterprise networks today

56
00:02:44,410 --> 00:02:47,770
using WIFI that they're getting
at home, at a friend's house

57
00:02:47,770 --> 00:02:49,203
or wherever they're staying.

58
00:02:50,440 --> 00:02:53,550
And we know that those WIFI appliances,

59
00:02:53,550 --> 00:02:57,043
those home routers are
notoriously insecure.

60
00:02:59,220 --> 00:03:02,580
This recent article speaks
about several vulnerabilities

61
00:03:02,580 --> 00:03:04,670
in a Netgear SOHO switch.

62
00:03:04,670 --> 00:03:08,059
But it's really not just one technology.

63
00:03:08,060 --> 00:03:11,590
The study by Frauen
Wolfer shows very clearly

64
00:03:11,590 --> 00:03:16,043
that across a range of
consumer connectivity products,

65
00:03:16,880 --> 00:03:19,210
security and vulnerability
management in particular

66
00:03:19,210 --> 00:03:21,380
are really, very poor.

67
00:03:21,380 --> 00:03:25,799
They report that there was
no router without flaws.

68
00:03:25,800 --> 00:03:28,230
And that 46 of the routers that examined,

69
00:03:28,230 --> 00:03:32,500
had not gotten a security
update within the previous year.

70
00:03:32,500 --> 00:03:36,130
And that's even assuming that
when updates are available,

71
00:03:36,130 --> 00:03:39,823
users are interested and
able to upgrade them.

72
00:03:41,040 --> 00:03:44,147
And these vulnerabilities
are not just theoretical.

73
00:03:44,147 --> 00:03:46,274
The security vulnerabilities
and misconfigurations

74
00:03:46,275 --> 00:03:48,330
are also being actively attacked.

75
00:03:48,330 --> 00:03:51,040
And the Mariah botnet is probably the most

76
00:03:51,040 --> 00:03:54,030
contemporary and famous example of that.

77
00:03:54,030 --> 00:03:58,230
But it's not just cyber
criminals and botnet herders

78
00:03:58,230 --> 00:04:02,040
that are exploiting home
connectivity equipment.

79
00:04:02,040 --> 00:04:04,429
It's also more sophisticated players.

80
00:04:04,430 --> 00:04:08,480
In this example, we saw
home routers being targeted

81
00:04:08,480 --> 00:04:12,350
with the view to hijacking DNS
and using that hijacked DNS

82
00:04:12,350 --> 00:04:15,180
to redirect traffic to malicious sites.

83
00:04:15,180 --> 00:04:17,790
This is an attack vector
that Wicus will demonstrate.

84
00:04:17,790 --> 00:04:19,860
There is a name that's probably still

85
00:04:19,860 --> 00:04:22,443
stamped on many of our minds.

86
00:04:24,200 --> 00:04:28,210
This campaign dates back to
more than three years ago now,

87
00:04:28,210 --> 00:04:33,210
but at its peak, it had
500,000 compromised endpoints.

88
00:04:33,389 --> 00:04:37,030
That's more than 50 devices
in more than 50 countries.

89
00:04:37,030 --> 00:04:38,880
And even today, a recent study shows that

90
00:04:38,880 --> 00:04:43,219
there are still thousands
of devices that are infected

91
00:04:43,220 --> 00:04:46,023
with this particular brand of malware.

92
00:04:47,510 --> 00:04:50,150
And just to be clear,
although in this presentation

93
00:04:50,150 --> 00:04:54,179
we're gonna be focusing
particularly on the access points,

94
00:04:54,180 --> 00:04:59,100
and the means that the user
uses to connect to the internet.

95
00:04:59,100 --> 00:05:01,460
Really what makes an
access point interesting

96
00:05:01,460 --> 00:05:05,680
is that it's a highly functional,
but insecure Linux box,

97
00:05:05,680 --> 00:05:09,900
that's connected to the same
local area network as the user.

98
00:05:09,900 --> 00:05:12,960
And so actually everything we
describe in this presentation

99
00:05:12,960 --> 00:05:17,227
could be transposed to other
similar technologies like IOT.

100
00:05:19,920 --> 00:05:24,140
So what we've seen so far is
that remote work using WIFI

101
00:05:24,140 --> 00:05:25,830
has become common commonplace.

102
00:05:25,830 --> 00:05:27,950
Your users are connecting
from their homes,

103
00:05:27,950 --> 00:05:30,849
from their friend's house
or from some public place.

104
00:05:30,850 --> 00:05:33,140
And if it's a public
place, quite probably,

105
00:05:33,140 --> 00:05:35,700
they're gonna encounter something
called the captive portal.

106
00:05:35,700 --> 00:05:37,960
Which is that a browser
screen that pops up

107
00:05:37,960 --> 00:05:39,659
when you have to enter
your username and password

108
00:05:39,660 --> 00:05:41,033
in order to use free WIFI.

109
00:05:41,940 --> 00:05:43,440
We've seen and I think it's safe to assume

110
00:05:43,440 --> 00:05:46,330
that these routers are insecure
or insecurity configured

111
00:05:46,330 --> 00:05:48,433
and that there are targets.

112
00:05:48,434 --> 00:05:51,810
And so we need to proceed
from the assumption

113
00:05:51,810 --> 00:05:54,580
that the primary mechanism that your users

114
00:05:54,580 --> 00:05:57,060
are leveraging to access the internet

115
00:05:57,060 --> 00:05:59,430
is under the control of someone else.

116
00:05:59,430 --> 00:06:01,560
At best it's untrusted,

117
00:06:01,560 --> 00:06:04,780
at worst it's fully
compromised or malicious.

118
00:06:04,780 --> 00:06:08,440
And our assumption is that the
primary security mechanism,

119
00:06:08,440 --> 00:06:10,910
with which we're responding to that threat

120
00:06:10,910 --> 00:06:12,787
is secure remote access.

121
00:06:12,787 --> 00:06:14,472
And to demonstrate that,

122
00:06:15,552 --> 00:06:16,950
just a quick show of statistics

123
00:06:16,950 --> 00:06:19,267
from our security operations center,

124
00:06:20,170 --> 00:06:23,270
expressing the increased demand for,

125
00:06:23,270 --> 00:06:26,609
so this is in support around
virtual private network

126
00:06:26,610 --> 00:06:30,510
technologies at the
peak of the first wave.

127
00:06:30,510 --> 00:06:31,800
And you can see very clearly there,

128
00:06:31,800 --> 00:06:33,740
however, March, April and May

129
00:06:33,740 --> 00:06:37,380
there was a sudden explosion of demand

130
00:06:37,380 --> 00:06:39,930
as companies hurry to either scale up

131
00:06:39,930 --> 00:06:43,303
or add a new secure remote
access technologies.

132
00:06:44,480 --> 00:06:46,650
And so what we wanna do now

133
00:06:46,650 --> 00:06:50,210
is take some time to show
you in a very practical way,

134
00:06:50,210 --> 00:06:52,640
what it means if you assume

135
00:06:52,640 --> 00:06:55,190
that the user's router is compromised.

136
00:06:55,190 --> 00:06:58,900
And our argument is that
there's is a number of new

137
00:06:58,900 --> 00:07:03,060
and unusual threats that come into play

138
00:07:03,060 --> 00:07:05,850
that you need to be taken into
account in your threat model.

139
00:07:05,850 --> 00:07:07,590
And so I'm gonna hand it over to Wicus

140
00:07:07,590 --> 00:07:09,750
to talk you through some examples

141
00:07:09,750 --> 00:07:11,100
that illustrate this point.

142
00:07:12,030 --> 00:07:13,251
- Thank you Charl.

143
00:07:13,252 --> 00:07:17,500
Before we gonna go into the examples,

144
00:07:17,500 --> 00:07:20,600
I'm gonna introduce a
couple of technical concepts

145
00:07:20,600 --> 00:07:23,140
that you'll hear me repeat quite often

146
00:07:23,140 --> 00:07:25,250
throughout the scenarios.

147
00:07:25,250 --> 00:07:28,520
So to make sure that
everybody's on the same page,

148
00:07:28,520 --> 00:07:33,210
let's just look at what those are

149
00:07:33,210 --> 00:07:37,020
and how they play out in reality.

150
00:07:37,020 --> 00:07:40,690
So the first one is dynamic
host configuration protocol,

151
00:07:40,690 --> 00:07:43,663
or DHCP as it's known more frequently.

152
00:07:44,820 --> 00:07:49,820
This is quite a common
protocol that's used

153
00:07:51,250 --> 00:07:54,060
throughout network infrastructure.

154
00:07:54,060 --> 00:07:56,510
And it is typically used to supply

155
00:07:57,700 --> 00:08:02,210
IP addresses, DNS configuration
and routes as well.

156
00:08:02,210 --> 00:08:06,710
This DHCP protocol's quite feature rich

157
00:08:06,710 --> 00:08:08,239
and even includes something called

158
00:08:08,240 --> 00:08:10,270
Preboot eXecution environment,

159
00:08:10,270 --> 00:08:12,130
that we will look at a bit later.

160
00:08:12,130 --> 00:08:14,430
And what this does, it allows you to boot

161
00:08:14,430 --> 00:08:16,433
an operating system over the network.

162
00:08:17,310 --> 00:08:19,700
And we'll see how we can play with that.

163
00:08:19,700 --> 00:08:22,270
Another concept that
you'll hear me talk about

164
00:08:22,270 --> 00:08:23,510
is captive portals.

165
00:08:23,510 --> 00:08:26,010
Now you might hear or you might know this

166
00:08:26,010 --> 00:08:28,280
in a different form, but I
think everybody in the audience

167
00:08:28,280 --> 00:08:30,623
have encountered this before.

168
00:08:31,530 --> 00:08:36,530
To think of your
complementary coffee WIFI.

169
00:08:36,630 --> 00:08:40,400
Think of the WIFI at
hotels, at airport lounges,

170
00:08:40,400 --> 00:08:41,480
even at the mall.

171
00:08:41,480 --> 00:08:43,760
All of these launches normally require you

172
00:08:43,760 --> 00:08:46,350
to agree to certain terms and conditions.

173
00:08:46,350 --> 00:08:48,760
Maybe even supply
information about yourself

174
00:08:48,760 --> 00:08:50,960
before allow you internet access.

175
00:08:50,960 --> 00:08:53,440
Now what's important
about a captive portal

176
00:08:53,440 --> 00:08:55,230
is it puts your machine or your device

177
00:08:55,230 --> 00:08:57,390
in a compromising state.

178
00:08:57,390 --> 00:09:00,380
Specifically, it exposes your browser

179
00:09:00,380 --> 00:09:02,350
to interact with the captive portal.

180
00:09:02,350 --> 00:09:04,630
Now some vendors or VPN vendors

181
00:09:04,630 --> 00:09:06,880
or secure remote access vendors

182
00:09:06,880 --> 00:09:10,040
use mitigations to limit
the impact of that.

183
00:09:10,040 --> 00:09:13,040
For example, something called
a captive portal mini browser

184
00:09:13,040 --> 00:09:15,689
which is a proprietary
browser that they use

185
00:09:15,690 --> 00:09:18,260
to force the user to interact
with the captive portal.

186
00:09:18,260 --> 00:09:20,030
You'll hear me talk about
that a bit later as well.

187
00:09:20,030 --> 00:09:22,220
So pay attention to that.

188
00:09:22,220 --> 00:09:26,610
Next, we're gonna look at
some legends or diagrams

189
00:09:29,562 --> 00:09:33,207
that we use or tutorials that
we use in this interface.

190
00:09:34,897 --> 00:09:38,240
So whenever you see the
first icon at the top,

191
00:09:38,240 --> 00:09:40,380
it's the victim, that's who we targeting,

192
00:09:40,380 --> 00:09:43,680
or that has been compromised
or that we want to compromise.

193
00:09:43,680 --> 00:09:47,459
Next, you'll see the
malicious access point icon.

194
00:09:47,459 --> 00:09:51,079
So that's either compromised
access point, home router,

195
00:09:51,080 --> 00:09:54,550
captive portal, IOT device
and that is under the control

196
00:09:54,550 --> 00:09:58,359
or influence of the attacker,
the last icon there at bottom.

197
00:09:58,360 --> 00:10:01,320
So that attacker will also
supply additional infrastructure

198
00:10:01,320 --> 00:10:02,240
that they will use.

199
00:10:02,240 --> 00:10:03,930
But the whole idea is that attacker

200
00:10:03,930 --> 00:10:05,410
wants to get onto that device

201
00:10:05,410 --> 00:10:09,219
or influence the way that
your victim's device behave.

202
00:10:09,220 --> 00:10:12,250
So let's get into the first scenario.

203
00:10:12,250 --> 00:10:15,080
In this scenario, we're gonna use DHCP

204
00:10:15,080 --> 00:10:19,960
to inject a route onto your victim machine

205
00:10:19,960 --> 00:10:23,140
to change the direction
or the traffic flow

206
00:10:23,140 --> 00:10:25,189
of something like a RDP session

207
00:10:25,190 --> 00:10:27,490
with idea of capturing credentials.

208
00:10:27,490 --> 00:10:29,600
This will happen even when
the VPN is established.

209
00:10:29,600 --> 00:10:32,030
So how does this play out in reality?

210
00:10:32,030 --> 00:10:34,720
So for example, our
victim is sitting behind

211
00:10:34,720 --> 00:10:37,220
a compromised home router for example,

212
00:10:37,220 --> 00:10:40,260
and they establish a VPN
to your corporate network

213
00:10:40,260 --> 00:10:43,990
with the intention of
accessing a RDP session

214
00:10:43,990 --> 00:10:45,520
on your trusted network.

215
00:10:45,520 --> 00:10:49,560
But what we have is a
compromised access point

216
00:10:49,560 --> 00:10:54,260
and our attacker has injected a route

217
00:10:54,260 --> 00:10:56,300
that overlaps within a subnet,

218
00:10:56,300 --> 00:10:59,020
that so happens to be the RDP session.

219
00:10:59,020 --> 00:11:02,439
And with this attack, we
can now pop the traffic

220
00:11:02,440 --> 00:11:03,493
out of the VPN.

221
00:11:04,570 --> 00:11:07,640
Now, if your user or your victim

222
00:11:07,640 --> 00:11:09,750
tries to connect to the RDP session,

223
00:11:09,750 --> 00:11:12,550
instead, they will be presented
with something like this

224
00:11:13,400 --> 00:11:14,760
and they will have to supply.

225
00:11:14,760 --> 00:11:16,370
Well, they probably will
supply their credentials

226
00:11:16,370 --> 00:11:18,880
thinking that this is
a legitimate session.

227
00:11:18,880 --> 00:11:20,210
But in fact what's happening is,

228
00:11:20,210 --> 00:11:24,407
it's connecting to the attackers
malicious service calls.

229
00:11:24,407 --> 00:11:26,810
In our case, we're using
something called Seth

230
00:11:26,810 --> 00:11:29,339
created by Adrian Vollmer
to illustrate the fact that

231
00:11:29,340 --> 00:11:31,330
we can catch your credentials.

232
00:11:31,330 --> 00:11:34,050
Now this attack or the
scenario is possible

233
00:11:34,050 --> 00:11:36,479
because of something that's lacking

234
00:11:36,480 --> 00:11:38,280
called the route precedents,

235
00:11:38,280 --> 00:11:40,319
an enforcement by the VPN client.

236
00:11:40,320 --> 00:11:42,480
So if your VPN client has route precedents

237
00:11:42,480 --> 00:11:47,480
or something in that line,
then make sure it's enabled,

238
00:11:48,050 --> 00:11:52,089
so you can mitigate this
type of behavior or attack.

239
00:11:52,090 --> 00:11:55,110
Next, let's look at another scenario

240
00:11:55,110 --> 00:11:56,910
in which we will talk about,

241
00:11:56,910 --> 00:11:59,740
we will use that pre-boot
execution environment option

242
00:11:59,740 --> 00:12:03,950
of DHCP, in which we will use DHCP

243
00:12:03,950 --> 00:12:06,380
to boot our own operating system.

244
00:12:06,380 --> 00:12:08,270
Operating system that's under our control,

245
00:12:08,270 --> 00:12:11,882
we will be serving that over the network,

246
00:12:11,882 --> 00:12:14,329
if that victim's machine

247
00:12:14,330 --> 00:12:18,630
is requesting or supporting
PXE boot at startup.

248
00:12:18,630 --> 00:12:20,870
So how does this play out?

249
00:12:20,870 --> 00:12:22,540
So you'll see on the left,

250
00:12:22,540 --> 00:12:26,849
we have our compromised
access point home router,

251
00:12:26,850 --> 00:12:28,240
and as Charl mentioned earlier,

252
00:12:28,240 --> 00:12:29,900
that this one is running Linux.

253
00:12:29,900 --> 00:12:32,380
And many of these home routers

254
00:12:32,380 --> 00:12:34,420
use a service called DNS mask.

255
00:12:34,420 --> 00:12:36,449
It's feature rich, it's
like the Swiss army knife

256
00:12:36,450 --> 00:12:38,870
of the home router services.

257
00:12:38,870 --> 00:12:42,200
It's got DHCP capabilities,
DNS resolution,

258
00:12:42,200 --> 00:12:43,913
TFTP, Trivial FTP that is used

259
00:12:43,913 --> 00:12:46,980
especially when you're serving PXE images.

260
00:12:46,980 --> 00:12:49,640
So our attackers compromised
is seated up in such a way that

261
00:12:49,640 --> 00:12:53,300
it will serve content,
which is highlighted

262
00:12:53,300 --> 00:12:54,979
or listed on the right-hand side.

263
00:12:54,980 --> 00:12:58,010
So this infrastructure is under control

264
00:12:58,010 --> 00:12:59,360
also of the attacker.

265
00:12:59,360 --> 00:13:03,090
And here we are waiting
for an HTTP connection

266
00:13:03,090 --> 00:13:05,810
to serve the operating
system that we control.

267
00:13:05,810 --> 00:13:08,400
Now note, this operating
system has also been modified

268
00:13:08,400 --> 00:13:12,860
to facilitate remote access
or remote administration.

269
00:13:12,860 --> 00:13:15,070
So when it's booted, it will connect back

270
00:13:15,070 --> 00:13:17,030
to the attacker's infrastructure.

271
00:13:17,030 --> 00:13:18,382
So how does that look?

272
00:13:19,980 --> 00:13:23,065
Here we see our victim attempting to,

273
00:13:23,065 --> 00:13:24,820
our victim's machine is starting up

274
00:13:24,820 --> 00:13:26,560
and part of the first startup process,

275
00:13:26,560 --> 00:13:29,770
it's looking for a PXE DHCP server.

276
00:13:29,770 --> 00:13:32,040
And our attackers DNS mask server,

277
00:13:32,040 --> 00:13:35,640
is actually serving that
from the compromised host.

278
00:13:35,640 --> 00:13:38,340
Including the Preboot
eXecution environment

279
00:13:39,470 --> 00:13:41,580
follow that bootstraps
our operating system.

280
00:13:41,580 --> 00:13:44,190
And now you can see, we are
serving the operating system

281
00:13:44,190 --> 00:13:48,000
that we modified to the victim.

282
00:13:48,000 --> 00:13:49,610
And once it's finished booting,

283
00:13:49,610 --> 00:13:53,730
our reverse shell or
remote access capabilities

284
00:13:53,730 --> 00:13:58,730
will be enabled once it hits
the attackers reverse shell.

285
00:14:00,230 --> 00:14:03,940
We will see here that we
have access to the host.

286
00:14:03,940 --> 00:14:07,680
Also, we see that there's a
disk attached to this machine

287
00:14:10,766 --> 00:14:11,910
when you re mount that disk,

288
00:14:11,910 --> 00:14:14,530
we noticed there's a windows
operating system present.

289
00:14:14,530 --> 00:14:16,270
Now this case, the
witness operating system

290
00:14:16,270 --> 00:14:18,520
is not protected using
full disk encryption,

291
00:14:18,520 --> 00:14:20,410
which means we have nearly what?

292
00:14:20,410 --> 00:14:21,477
We have full access to that disk

293
00:14:21,477 --> 00:14:23,959
and we can do anything we want to it.

294
00:14:23,960 --> 00:14:25,470
To demonstrate that, we just say,

295
00:14:25,470 --> 00:14:30,020
well, here's this attack is
fortunately not that malicious.

296
00:14:30,020 --> 00:14:31,410
We just modifying the full system,

297
00:14:31,410 --> 00:14:34,530
so when the victims
logs into their account,

298
00:14:34,530 --> 00:14:38,242
some files will be displayed
as part of this demonstration.

299
00:14:39,160 --> 00:14:41,363
So next comes the captive portal.

300
00:14:41,363 --> 00:14:43,180
And in the captive portal.

301
00:14:43,180 --> 00:14:45,959
What we gonna use captive
portal for in this case

302
00:14:45,960 --> 00:14:49,070
is to leverage the whole behavior

303
00:14:49,070 --> 00:14:50,500
and we're gonna modify that behavior

304
00:14:50,500 --> 00:14:52,870
using the captive portal mini
browser that I talked about,

305
00:14:52,870 --> 00:14:55,270
the propriety captive portal interface

306
00:14:55,270 --> 00:14:58,097
from the VPN agent's side.

307
00:14:58,097 --> 00:15:00,680
We're hoping to trick the user

308
00:15:00,680 --> 00:15:02,782
into a social engineering attack.

309
00:15:04,350 --> 00:15:07,330
So you would start off
with the victim connecting

310
00:15:07,330 --> 00:15:09,550
to a network, all right.

311
00:15:09,550 --> 00:15:12,333
Thinking that this is maybe
the coffee shop, right?

312
00:15:14,370 --> 00:15:15,640
The captive portal mini browser here

313
00:15:15,640 --> 00:15:17,430
depicted by the little gray box there,

314
00:15:17,430 --> 00:15:20,380
is this proprietary browser I spoke about.

315
00:15:20,380 --> 00:15:22,720
And this is what you would
normally expect to see.

316
00:15:22,720 --> 00:15:26,090
So created by some sort of logo
from the captive portal side

317
00:15:26,090 --> 00:15:29,230
agreeing to do something, maybe
provide some login details

318
00:15:29,230 --> 00:15:30,403
or something else, right?

319
00:15:30,403 --> 00:15:33,150
But in fact what happened is our attacker

320
00:15:33,150 --> 00:15:36,175
has modified the content,
and now we are serving

321
00:15:36,176 --> 00:15:39,620
something that looks
kind of official, right?

322
00:15:39,620 --> 00:15:42,920
And if I use this or happens
to click on that link there,

323
00:15:42,920 --> 00:15:46,418
we'll see it asks to run
this Jamal application.

324
00:15:46,418 --> 00:15:50,400
And further and hoping
that the user clicks

325
00:15:50,400 --> 00:15:51,660
that run button there.

326
00:15:51,660 --> 00:15:53,890
If they do, we have code execution.

327
00:15:53,890 --> 00:15:56,410
So we just highlighted that
icon there on the task bar

328
00:15:56,410 --> 00:15:57,980
there to illustrate the point.

329
00:15:57,980 --> 00:16:01,960
But because you know, this
is just for demonstration,

330
00:16:01,960 --> 00:16:04,630
but we can also hide that if
you really need to, right?

331
00:16:04,630 --> 00:16:06,137
But what is really achieved here is that,

332
00:16:06,137 --> 00:16:09,349
the attacker now has remote
access to our victim.

333
00:16:09,350 --> 00:16:11,350
So they can do whatever they want there.

334
00:16:12,260 --> 00:16:14,939
So coming up to this point, you know,

335
00:16:14,940 --> 00:16:17,170
is was we influenced
quite greatly about work

336
00:16:17,170 --> 00:16:21,360
we did last year in
exploring what does it mean

337
00:16:21,360 --> 00:16:23,730
to use a VPN client and you know,

338
00:16:23,730 --> 00:16:24,890
what does it actually benefit?

339
00:16:24,890 --> 00:16:27,400
Was it actual benefits when it comes from

340
00:16:27,400 --> 00:16:29,220
a security point of view when working with

341
00:16:29,220 --> 00:16:31,260
untrusted networks.

342
00:16:31,260 --> 00:16:33,420
Especially in looking at
it from a captive portal

343
00:16:33,420 --> 00:16:34,410
point of view.

344
00:16:34,410 --> 00:16:38,689
So we started off using
two code responder.

345
00:16:38,690 --> 00:16:41,880
Now, if you're familiar
with that responder,

346
00:16:41,880 --> 00:16:46,880
is a type of penetration
testing tool that is used

347
00:16:50,046 --> 00:16:54,573
to facilitate, compromise of
windows authentication tokens.

348
00:16:55,650 --> 00:16:57,540
Now authentication tokens could also be,

349
00:16:57,540 --> 00:16:59,270
but they also referred
to as Intel M hashes.

350
00:16:59,270 --> 00:17:03,180
Now, these Intel M hashes are
provided by windows services,

351
00:17:03,180 --> 00:17:04,639
when they're trying to typically connect

352
00:17:04,640 --> 00:17:09,410
to a windows map drive for example

353
00:17:09,410 --> 00:17:11,790
or say another resource like a printer

354
00:17:11,790 --> 00:17:14,220
through which they've
previously authenticated.

355
00:17:14,220 --> 00:17:16,400
So responder allows us
to capture these hashes

356
00:17:16,400 --> 00:17:18,530
and then we can track them offline.

357
00:17:18,530 --> 00:17:20,822
So in the captive portal state,

358
00:17:22,540 --> 00:17:23,383
the attacker controls everything.

359
00:17:23,383 --> 00:17:25,369
They control the DNS,
they control the routing,

360
00:17:25,369 --> 00:17:27,079
they control DHCP.

361
00:17:27,079 --> 00:17:31,280
And basically they can choose
how content is resolved

362
00:17:31,280 --> 00:17:33,070
especially host names, right?

363
00:17:33,070 --> 00:17:37,810
So coming back to our friendly
captive portal interface

364
00:17:37,810 --> 00:17:40,710
there, we'll see the VPN agent

365
00:17:40,710 --> 00:17:43,850
detected there a captive portal
between it and the internet.

366
00:17:43,850 --> 00:17:46,030
So it can't established VPN.

367
00:17:46,030 --> 00:17:48,139
It launches its captive
portal mini browser

368
00:17:48,140 --> 00:17:52,903
asking the user to interface
with this captive portal.

369
00:17:54,030 --> 00:17:57,629
But because we control the DNS,

370
00:17:57,630 --> 00:18:00,070
we can influence anything
that's not like I said

371
00:18:00,070 --> 00:18:01,520
on a network level.

372
00:18:01,520 --> 00:18:04,040
And if there's a service
during this period

373
00:18:04,040 --> 00:18:09,040
that wants to connect to,
let's say windows drive,

374
00:18:09,863 --> 00:18:14,610
our a responder service will
happily oblige, talking to it.

375
00:18:14,610 --> 00:18:16,488
But at the same time, we will still

376
00:18:16,489 --> 00:18:20,180
unlift some juicy intel
measures that will crack.

377
00:18:20,180 --> 00:18:23,203
And if this is a weak password,
we have the password, right?

378
00:18:23,203 --> 00:18:26,210
So this leads us to the whole thing like,

379
00:18:26,210 --> 00:18:27,760
what does a VPN supposed to do?

380
00:18:29,180 --> 00:18:30,470
How do we benefit from this really,

381
00:18:30,470 --> 00:18:32,546
when dealing with a
compromised environment.

382
00:18:32,546 --> 00:18:35,722
And I'll let Charl answer
that difficult question.

383
00:18:35,722 --> 00:18:36,790
- Thanks Wicus.

384
00:18:36,790 --> 00:18:39,488
So Wicus has demonstrated
a variety of attacks

385
00:18:39,488 --> 00:18:40,920
that become possible,

386
00:18:40,920 --> 00:18:43,090
because the user is under the influence

387
00:18:43,090 --> 00:18:44,879
of the machine access point.

388
00:18:44,880 --> 00:18:48,280
And typically our response
to these kinds of threats

389
00:18:48,280 --> 00:18:51,920
is to shovel victim's traffic down a VPN.

390
00:18:51,920 --> 00:18:53,310
Put them in a secure tunnel

391
00:18:53,310 --> 00:18:55,700
and keep them out of the
influence of the bad guys.

392
00:18:55,700 --> 00:18:58,390
But what is it that a
VPN actually gives us?

393
00:18:58,390 --> 00:19:01,120
Well, we know technically
we get confidentiality,

394
00:19:01,120 --> 00:19:03,610
integrity and access control.

395
00:19:03,610 --> 00:19:06,959
But conceptually we're of the opinion

396
00:19:06,960 --> 00:19:10,880
that what enterprise admins are expecting

397
00:19:10,880 --> 00:19:13,889
is something that we would
call security equivalency.

398
00:19:13,889 --> 00:19:16,310
And our definition of security equivalency

399
00:19:16,310 --> 00:19:19,490
is that there's an expectation that a user

400
00:19:19,490 --> 00:19:23,010
connected via a VPN
from a remote location,

401
00:19:23,010 --> 00:19:26,370
no matter how malicious
should be confronted with

402
00:19:26,370 --> 00:19:29,830
and expect to deal with
the same threats and risks

403
00:19:29,830 --> 00:19:32,810
as a user, who's directly
connected to the LAN.

404
00:19:32,810 --> 00:19:34,720
We're not saying that's
what VPNs are offering.

405
00:19:34,720 --> 00:19:37,580
We're saying, that's what
we believe our admins

406
00:19:37,580 --> 00:19:41,253
and architects expect once
the VPN is established.

407
00:19:42,970 --> 00:19:44,490
So in our previous work,

408
00:19:44,490 --> 00:19:49,490
we set out to verify whether
in fact, that was the case.

409
00:19:49,500 --> 00:19:52,500
And the first thing that we
did was to define four states

410
00:19:52,500 --> 00:19:56,810
or four modes that a VPN
could find itself in.

411
00:19:56,810 --> 00:19:59,360
And you'll see depicted on this grid..

412
00:19:59,360 --> 00:20:02,719
Firstly, there's two modes,
two configuration modes.

413
00:20:02,720 --> 00:20:04,810
In standard mode, we've taken the VPN,

414
00:20:04,810 --> 00:20:06,515
basically just off the shelf

415
00:20:06,516 --> 00:20:09,784
and configured it only
enough to get it working,

416
00:20:09,784 --> 00:20:11,900
so the user can connect.

417
00:20:11,900 --> 00:20:14,820
And lock down mode, we've really taken

418
00:20:14,820 --> 00:20:18,909
gone to maximum efforts
to address the threats

419
00:20:18,910 --> 00:20:22,480
that a malicious captive
portal might present.

420
00:20:22,480 --> 00:20:25,200
And then we have two
states, captured and online.

421
00:20:25,200 --> 00:20:26,503
In the captured state,

422
00:20:30,712 --> 00:20:33,350
the IP is not allowing the end point

423
00:20:33,350 --> 00:20:34,620
to connect to the internet.

424
00:20:34,620 --> 00:20:36,030
So this is the state that you'd be in,

425
00:20:36,030 --> 00:20:37,530
if you were behind the captive portal.

426
00:20:37,530 --> 00:20:39,600
But of course a malicious access point

427
00:20:39,600 --> 00:20:41,570
can initiate the state at any time

428
00:20:41,570 --> 00:20:43,250
using a variety of mechanisms.

429
00:20:43,250 --> 00:20:44,840
So that's captured state.

430
00:20:44,840 --> 00:20:46,990
The online state is where

431
00:20:49,557 --> 00:20:51,140
the internet connectivity
has been established

432
00:20:51,140 --> 00:20:52,980
and the client has been able to

433
00:20:52,980 --> 00:20:54,930
make the connection with the gateway.

434
00:20:54,930 --> 00:20:56,200
The tunnel is fully established,

435
00:20:56,200 --> 00:20:57,960
everything's working as expected.

436
00:20:57,960 --> 00:21:00,500
So that gives us these four scenarios

437
00:21:00,500 --> 00:21:03,410
in which we wanna test VPN products.

438
00:21:03,410 --> 00:21:06,862
We then went on to define a
variety of different threats.

439
00:21:06,862 --> 00:21:08,800
So these are attack vectors

440
00:21:08,800 --> 00:21:12,470
that may present themselves to an actor

441
00:21:12,470 --> 00:21:14,580
who has control of the access point.

442
00:21:14,580 --> 00:21:16,340
These are not specifically important

443
00:21:16,340 --> 00:21:18,090
or significant attack factors,

444
00:21:18,090 --> 00:21:21,409
but they are all practical, technical

445
00:21:21,410 --> 00:21:23,790
and they can be proven in the lab.

446
00:21:23,790 --> 00:21:26,730
So that gives us six threat scenarios

447
00:21:26,730 --> 00:21:28,340
that we wanted to test.

448
00:21:28,340 --> 00:21:30,139
And then we combine those,
and that's what you see

449
00:21:30,140 --> 00:21:31,880
in this complex looking
grid funnily enough.

450
00:21:31,880 --> 00:21:34,470
You see the four quadrants representative

451
00:21:34,470 --> 00:21:35,970
just like we saw in the beginning,

452
00:21:35,970 --> 00:21:39,180
like captured and online,
standard and locked down mode.

453
00:21:39,180 --> 00:21:42,140
And then you'll see for each threat

454
00:21:42,998 --> 00:21:44,770
that we identified a column
within that quadrant.

455
00:21:44,770 --> 00:21:47,629
So there are six parliaments
representing the six threats

456
00:21:47,630 --> 00:21:49,050
in each quadrant.

457
00:21:49,050 --> 00:21:52,440
And then there are six rows
representing six vendors.

458
00:21:52,440 --> 00:21:54,770
That's a mix of traditional VPN vendors

459
00:21:54,770 --> 00:21:59,770
and more contemporary
so-called Zero Trust vendors.

460
00:22:00,020 --> 00:22:04,180
And that gives us the six by
six grid within each quadrant.

461
00:22:04,180 --> 00:22:07,010
And then we tested each product

462
00:22:07,010 --> 00:22:09,150
against each one of those threats.

463
00:22:09,150 --> 00:22:12,110
And the coloration is an
indication of results.

464
00:22:12,110 --> 00:22:14,040
Red meaning that the
threat was successful,

465
00:22:14,040 --> 00:22:15,710
we could execute that threat.

466
00:22:15,710 --> 00:22:17,440
Green meaning the technology successfully

467
00:22:17,440 --> 00:22:19,150
mitigated the threat.

468
00:22:19,150 --> 00:22:22,090
And the progression is clear
that you can see very clearly,

469
00:22:22,090 --> 00:22:24,919
that without special configuration
in that captured state,

470
00:22:24,920 --> 00:22:26,780
without connectivity to the internet,

471
00:22:26,780 --> 00:22:28,190
none of the products we tested,

472
00:22:28,190 --> 00:22:31,190
could mitigate any of the
threats that could be conceive.

473
00:22:31,190 --> 00:22:33,570
As you move to the top, right
and you start implementing

474
00:22:33,570 --> 00:22:35,710
these more sophisticated controls,

475
00:22:35,710 --> 00:22:38,650
some of the products stop
mitigating some of the threats.

476
00:22:38,650 --> 00:22:39,870
But really it's not looking.

477
00:22:39,870 --> 00:22:41,850
The majority of the
threats are still firing

478
00:22:41,850 --> 00:22:43,320
as we would expect.

479
00:22:43,320 --> 00:22:44,941
Once the VPN is established

480
00:22:44,941 --> 00:22:46,930
but without special configurations

481
00:22:46,930 --> 00:22:48,620
in the bottom left quadrant,

482
00:22:48,620 --> 00:22:49,909
now you'll see similar behavior.

483
00:22:49,910 --> 00:22:52,710
Some of the threats being
mitigated really most of them

484
00:22:52,710 --> 00:22:54,540
are still triggering as expected.

485
00:22:54,540 --> 00:22:57,070
But then finally, as we
get to the end state,

486
00:22:57,070 --> 00:23:01,020
where we've hardened the
VPN the way we would expect

487
00:23:01,020 --> 00:23:02,990
and we have the tunnel established,

488
00:23:02,990 --> 00:23:05,500
then very few of these
threats are still firing.

489
00:23:05,500 --> 00:23:06,500
And to make that practical,

490
00:23:06,500 --> 00:23:08,240
I wanna go back to the responder attack,

491
00:23:08,240 --> 00:23:10,283
that Wicus talked us through.

492
00:23:11,240 --> 00:23:12,840
And just illustrate how that looks.

493
00:23:12,840 --> 00:23:15,870
So in the standard mode
without connectivity,

494
00:23:15,870 --> 00:23:18,620
responder works against all the vendors.

495
00:23:18,620 --> 00:23:21,139
In standard mode with connectivity,

496
00:23:21,140 --> 00:23:22,990
it works against all, but one vendor.

497
00:23:24,236 --> 00:23:26,362
In lockdown mode without connectivity,

498
00:23:26,362 --> 00:23:29,350
it works on the half the vendors,
but it's mitigated by off.

499
00:23:29,350 --> 00:23:31,000
And finally, even in the best case,

500
00:23:31,000 --> 00:23:34,650
there are still vendors who
failed to mitigate this threat.

501
00:23:34,650 --> 00:23:36,840
So the behavior of the vendors

502
00:23:36,840 --> 00:23:39,520
in the face of these kinds of threats

503
00:23:39,520 --> 00:23:41,560
is not consistent at all.

504
00:23:41,560 --> 00:23:43,560
And if you wanna get any mitigation,

505
00:23:43,560 --> 00:23:46,090
you need to make sure that
you're configuring devices

506
00:23:46,090 --> 00:23:47,983
in accordance with those threats.

507
00:23:49,626 --> 00:23:51,700
So next we wanna talk to you,

508
00:23:51,700 --> 00:23:53,470
we talked a little bit
about the legacy products,

509
00:23:53,470 --> 00:23:55,410
those are traditional VPNs.

510
00:23:55,410 --> 00:23:57,420
There's also a new way of thinking,

511
00:23:57,420 --> 00:23:59,490
the so-called Zero Trust products.

512
00:23:59,490 --> 00:24:01,481
Perhaps personified by Zscaler.

513
00:24:01,481 --> 00:24:03,360
So, Wicus is gonna just talk us through,

514
00:24:03,360 --> 00:24:05,010
the differences we could expect to see

515
00:24:05,010 --> 00:24:07,653
between something like
Zscaler and traditional VPN.

516
00:24:09,940 --> 00:24:11,180
- Thank you Charl.

517
00:24:11,180 --> 00:24:14,160
So if you think about VPNs and how long

518
00:24:14,160 --> 00:24:15,540
we've been dealing with them.

519
00:24:15,540 --> 00:24:19,050
VPNs is around about 25 years maybe more,

520
00:24:19,050 --> 00:24:21,773
coming through from mid
90's up to where we are now.

521
00:24:22,610 --> 00:24:25,929
And all the incidents that
we've heard of in the last,

522
00:24:25,930 --> 00:24:28,060
let's say six months, maybe longer.

523
00:24:28,060 --> 00:24:30,110
Maybe into the start of 2020,

524
00:24:31,077 --> 00:24:36,020
the buzzword Zero Trust is
being used more and more.

525
00:24:36,020 --> 00:24:37,889
And everybody's trying to understand

526
00:24:37,890 --> 00:24:38,910
where does this fit in on?

527
00:24:38,910 --> 00:24:40,500
What does it mean for us?

528
00:24:40,500 --> 00:24:42,410
Now talking about the Zscaler,

529
00:24:42,410 --> 00:24:45,310
this is a technology
that's familiar to us.

530
00:24:45,310 --> 00:24:46,929
And it might not be familiar to you.

531
00:24:46,930 --> 00:24:49,740
So let me first introduce some concepts,

532
00:24:49,740 --> 00:24:51,130
so that we can just set the scene,

533
00:24:51,130 --> 00:24:53,610
so you can understand
where we coming from.

534
00:24:53,610 --> 00:24:56,439
And then we'll just show
you how Zscaler perform

535
00:24:56,440 --> 00:25:00,690
in a similar type of compromised
captive portal environment

536
00:25:00,690 --> 00:25:04,660
or captive compromised router environment.

537
00:25:04,660 --> 00:25:07,790
Also caveat, please speak to
the Zscaler people directly,

538
00:25:07,790 --> 00:25:11,820
if you want more of official communication

539
00:25:11,820 --> 00:25:12,653
about their product,

540
00:25:12,653 --> 00:25:14,140
I'm sure they will be happy to obliged,

541
00:25:14,140 --> 00:25:17,123
to clarify and answer your questions.

542
00:25:18,850 --> 00:25:23,850
So Zscaler offers two ways
of connecting through them

543
00:25:23,950 --> 00:25:27,640
to the internet as well
as to specific services,

544
00:25:27,640 --> 00:25:30,083
that your organization
might wish to explore.

545
00:25:31,270 --> 00:25:35,080
One of the straightforward
ways to do this,

546
00:25:35,080 --> 00:25:39,149
but also limited to only a
specific set of functionality

547
00:25:39,150 --> 00:25:43,010
is a ZIA or Zscaler internet access.

548
00:25:43,010 --> 00:25:45,600
So think of it as a
policy based HTTP proxy

549
00:25:45,600 --> 00:25:49,129
that's running locally on your endpoint.

550
00:25:49,130 --> 00:25:53,180
They have an agent that you
deploy like a VPN client

551
00:25:53,180 --> 00:25:55,100
called Zscaler client connector.

552
00:25:55,100 --> 00:25:58,590
And this basically
facilitates the connectivity,

553
00:25:58,590 --> 00:26:00,990
the proxy on your local device.

554
00:26:00,990 --> 00:26:04,500
And it will then take specific
traffic that you configured

555
00:26:04,500 --> 00:26:07,380
through proxy auto configuration scripts,

556
00:26:07,380 --> 00:26:11,630
as well as just the blanket
pass through if you will,

557
00:26:11,630 --> 00:26:15,360
to their Zscaler cloud, that
enables them to do all sorts

558
00:26:15,360 --> 00:26:17,189
of validation on the traffic

559
00:26:17,190 --> 00:26:22,190
and fingerprinting of maybe
identifying of malicious traffic

560
00:26:22,440 --> 00:26:26,210
and also help with the
DLP type style attacks

561
00:26:26,210 --> 00:26:28,600
or identification of anomalous behavior.

562
00:26:28,600 --> 00:26:31,389
But everything relies in this paradigm

563
00:26:31,390 --> 00:26:34,720
on identity providers that
facilitate single sign-on.

564
00:26:34,720 --> 00:26:37,320
Because the user experience
is quite important,

565
00:26:37,320 --> 00:26:41,610
when dealing with a lot of
services behind this technology.

566
00:26:43,310 --> 00:26:46,379
You don't want users to get login fatigue

567
00:26:46,380 --> 00:26:49,650
going to multiple sites
having to re authenticate.

568
00:26:49,650 --> 00:26:54,650
So it is key that you map
your specific applications

569
00:26:54,890 --> 00:26:55,793
through your ZIA.

570
00:26:56,650 --> 00:27:01,650
Now, this is like I said but
limited to HTTP type traffic

571
00:27:01,790 --> 00:27:04,519
specifically if you've
got legacy protocols

572
00:27:04,519 --> 00:27:07,200
that's not necessarily compatible with us,

573
00:27:07,200 --> 00:27:09,760
you would need to look
at something called ZPA

574
00:27:09,760 --> 00:27:12,530
or Zscaler private access for example.

575
00:27:12,530 --> 00:27:15,899
This type of solution's a lot closer

576
00:27:15,900 --> 00:27:20,330
to what we would understand
the VPNs to offer.

577
00:27:20,330 --> 00:27:22,210
But there's a difference,
a major difference

578
00:27:22,210 --> 00:27:24,820
and this comes into the way that it plays

579
00:27:24,820 --> 00:27:26,909
in this technology space.

580
00:27:26,910 --> 00:27:28,730
Is that it is app centric.

581
00:27:28,730 --> 00:27:30,980
So Gardner is defined as whole app centric

582
00:27:30,980 --> 00:27:33,210
way of doing things, where your users

583
00:27:33,210 --> 00:27:36,740
are assigned specific access to apps,

584
00:27:36,740 --> 00:27:39,884
as opposed to the
traditional implicit trust

585
00:27:39,884 --> 00:27:42,990
network centric approach.

586
00:27:42,990 --> 00:27:45,270
This is achieved through what they call,

587
00:27:45,270 --> 00:27:46,660
the inside out approach.

588
00:27:46,660 --> 00:27:49,800
Where you need to deploy
a Zscaler app connector

589
00:27:49,800 --> 00:27:53,260
close as possible to the
service that you wish to expose.

590
00:27:53,260 --> 00:27:57,781
And this will then bridge that
app into the Zscaler cloud

591
00:27:57,781 --> 00:28:01,480
and through using the
Zscaler client connector

592
00:28:01,480 --> 00:28:04,252
agent running on your user's endpoint,

593
00:28:04,252 --> 00:28:06,680
map traffic then through that way.

594
00:28:06,680 --> 00:28:10,420
So at no point, do you actually
expose a port or a service

595
00:28:10,420 --> 00:28:11,740
through to the internet like you would

596
00:28:11,740 --> 00:28:13,900
with a traditional VPN agent.

597
00:28:13,900 --> 00:28:18,560
It's all just connecting
out from the trusted network

598
00:28:18,560 --> 00:28:21,320
and from the remote user
site into the Zscaler cloud

599
00:28:21,320 --> 00:28:22,840
and is better that way.

600
00:28:22,840 --> 00:28:25,669
What's important to note is
that Zscaler client connector

601
00:28:25,670 --> 00:28:29,230
has two ways of getting
traffic into the Zscaler cloud

602
00:28:29,230 --> 00:28:30,400
from the end point.

603
00:28:30,400 --> 00:28:32,420
You can use the
traditional IP rating base.

604
00:28:32,420 --> 00:28:34,670
And if you're running
windows there's a feature

605
00:28:34,670 --> 00:28:36,310
that's highly recommended
that you look into,

606
00:28:36,310 --> 00:28:37,830
it's called packet filtering,

607
00:28:37,830 --> 00:28:40,250
which means that you can
push traffic directly

608
00:28:40,250 --> 00:28:43,170
into that packet filter
without having to worry about

609
00:28:43,170 --> 00:28:44,840
attacks like I demonstrated earlier

610
00:28:44,840 --> 00:28:47,840
about a router manipulation.

611
00:28:47,840 --> 00:28:52,082
So how does Zscaler client connector,

612
00:28:53,260 --> 00:28:55,200
how does it deal with captive portal?

613
00:28:55,200 --> 00:28:58,800
So we've seen that it's got
two modes in dealing with it.

614
00:28:58,800 --> 00:29:03,220
Where the fail closed state
is where it just detects

615
00:29:03,220 --> 00:29:05,130
there's something between
it and the internet,

616
00:29:05,130 --> 00:29:07,910
and it will literally say
"I'm not doing anything,

617
00:29:07,910 --> 00:29:09,818
not allowing any traffic to the internet

618
00:29:09,818 --> 00:29:12,270
or any other traffic going up."

619
00:29:12,270 --> 00:29:15,500
That's important to note that
the user needs to find a way

620
00:29:15,500 --> 00:29:17,460
to circumvent that.

621
00:29:17,460 --> 00:29:20,830
But the Zscaler client connector will not

622
00:29:20,830 --> 00:29:22,592
facilitate any network traffic.

623
00:29:23,600 --> 00:29:27,959
Another aspect that it
can be configured in,

624
00:29:27,960 --> 00:29:29,780
which is a default one
is called the Fail Open.

625
00:29:29,780 --> 00:29:32,030
where it basically backs
off for a period of time

626
00:29:32,030 --> 00:29:34,530
when it detects there's something behaving

627
00:29:34,530 --> 00:29:36,000
like a captive portal.

628
00:29:36,000 --> 00:29:39,900
And in that state, it would
then allow the user to interact

629
00:29:39,900 --> 00:29:43,910
with the captive portal or
that malicious access point.

630
00:29:43,910 --> 00:29:47,170
And in this state, it is
important to note that

631
00:29:47,170 --> 00:29:51,300
we see that it is also
vulnerable to the attacks

632
00:29:51,300 --> 00:29:53,159
we've seen against traditional VPN.

633
00:29:53,160 --> 00:29:57,770
So there is this compromise in technology

634
00:29:57,770 --> 00:30:01,970
that is applicable to
this scenario as well.

635
00:30:01,970 --> 00:30:04,820
So Charl mentioned Zero Trust earlier.

636
00:30:04,820 --> 00:30:07,480
And can you really compare
it to secure remote access?

637
00:30:07,480 --> 00:30:09,830
When we start looking at the technologies

638
00:30:09,830 --> 00:30:12,949
and then, specifics like
internet access management,

639
00:30:12,950 --> 00:30:14,300
granular resource control,

640
00:30:14,300 --> 00:30:16,260
monitoring and inspection of networks,

641
00:30:16,260 --> 00:30:17,760
those facets are there.

642
00:30:17,760 --> 00:30:20,600
And it's important to
note that they are similar

643
00:30:20,600 --> 00:30:25,600
but they function also
with similar purpose.

644
00:30:26,090 --> 00:30:29,840
But where Zero Trust is different
from secure remote access

645
00:30:29,840 --> 00:30:31,800
is it's not the technology, right?

646
00:30:31,800 --> 00:30:34,010
It's not specific vendor.

647
00:30:34,010 --> 00:30:38,390
We have to think about it
as principles or a mindset.

648
00:30:38,390 --> 00:30:41,352
And you'll hear a lot of
people will talk about

649
00:30:41,352 --> 00:30:44,600
the verify explicitly, right?

650
00:30:44,600 --> 00:30:48,740
Transactions need to be
authenticated and authorized.

651
00:30:48,740 --> 00:30:50,130
We're not extending the perimeter,

652
00:30:50,130 --> 00:30:54,316
we're applying least
privileges concepts to segment

653
00:30:54,316 --> 00:30:57,400
and control specific pinpoint access.

654
00:30:57,400 --> 00:31:01,540
And also assume breach
is important tenant,

655
00:31:01,540 --> 00:31:04,770
as opposed to looking at
an implicit trusted network

656
00:31:04,770 --> 00:31:06,868
where you think your environment is safe

657
00:31:06,868 --> 00:31:09,310
and you're trying to
keep the bad guys out.

658
00:31:09,310 --> 00:31:12,450
And this is important to remember that

659
00:31:12,450 --> 00:31:14,113
Zero Trust is not a technology,

660
00:31:15,060 --> 00:31:17,540
it's a concept and it's a mindset.

661
00:31:17,540 --> 00:31:20,860
I'm gonna hand over now to
Charl to close this out.

662
00:31:20,860 --> 00:31:22,229
- Thanks Wicus.

663
00:31:22,230 --> 00:31:25,283
All right, so what I hope
you've taken from this is,

664
00:31:25,283 --> 00:31:28,679
if we assume as I think we
must that the access point

665
00:31:28,680 --> 00:31:31,150
is malicious or compromised,

666
00:31:31,150 --> 00:31:34,680
then there is an entire
range of new threats

667
00:31:34,680 --> 00:31:38,280
impacting the end point or
impacting your network traffic.

668
00:31:38,280 --> 00:31:40,720
Or impacting your environments,

669
00:31:40,720 --> 00:31:44,259
that probably without
very very careful care,

670
00:31:44,259 --> 00:31:47,080
your traditional secure
mode access technology

671
00:31:47,080 --> 00:31:49,220
is not protecting you against.

672
00:31:49,220 --> 00:31:52,200
And that's true, not
just for the traditional

673
00:31:53,077 --> 00:31:57,113
"VPN" technologies, but also
for the newer generation,

674
00:31:58,240 --> 00:32:00,750
so-called Zero Trust technologies.

675
00:32:00,750 --> 00:32:04,700
Unless they are used
in a very specific way

676
00:32:04,700 --> 00:32:07,037
to mitigate against those threats.

677
00:32:07,037 --> 00:32:09,480
So that being the case,
so what should we do?

678
00:32:09,480 --> 00:32:13,263
We've given a lot of
guidance on these slides.

679
00:32:14,800 --> 00:32:18,550
But in summary, the first thing
that you need to recognize

680
00:32:18,550 --> 00:32:20,700
is that if someone else
controls the access point

681
00:32:20,700 --> 00:32:22,530
then they're threatening the endpoint.

682
00:32:22,530 --> 00:32:25,820
And you need to take that
into your threat model

683
00:32:25,820 --> 00:32:28,913
and bold your security from that point on.

684
00:32:30,170 --> 00:32:34,060
Next, you need to appreciate

685
00:32:34,060 --> 00:32:37,990
that traditional VPNs or as I said,

686
00:32:37,990 --> 00:32:41,250
even the sort of newest
Zero Trust technologies

687
00:32:41,250 --> 00:32:44,070
on their own and without
very, very careful care,

688
00:32:44,070 --> 00:32:45,830
are probably not positioned

689
00:32:45,830 --> 00:32:48,379
to counter the malicious access points.

690
00:32:48,380 --> 00:32:51,263
Even if that's what your expectation is.

691
00:32:52,940 --> 00:32:54,770
So coming away from this talk,

692
00:32:54,770 --> 00:32:56,370
when you get back to the office,

693
00:32:58,165 --> 00:33:00,930
you're not gonna go back
to the office, are you?

694
00:33:00,930 --> 00:33:02,800
Then what should you do?

695
00:33:02,800 --> 00:33:05,580
Well, Wicus showed a very specific attack

696
00:33:05,580 --> 00:33:09,203
which involved overriding
router precedence.

697
00:33:10,130 --> 00:33:12,500
This is it's an attack vector

698
00:33:12,500 --> 00:33:16,540
that some of the products
do have mitigations against.

699
00:33:16,540 --> 00:33:20,230
It's what allowed us to do the
RDP man in the middle attack.

700
00:33:20,230 --> 00:33:23,210
And we would encourage you to
go and speak to your vendors,

701
00:33:23,210 --> 00:33:25,720
engage with them, understand
how their technology

702
00:33:25,720 --> 00:33:29,480
can mitigate this threat and
make sure that that's enabled

703
00:33:29,480 --> 00:33:31,200
in your environment.

704
00:33:31,200 --> 00:33:34,430
Next, significant number of the attacks

705
00:33:34,430 --> 00:33:36,542
that Wicus demonstrated and that we tested

706
00:33:36,542 --> 00:33:41,542
in our evaluation, involve
exploiting split tunneling.

707
00:33:41,680 --> 00:33:43,930
Split tunneling as you know
is that feature of VPNs

708
00:33:43,930 --> 00:33:46,680
that you use to send some
traffic to the enterprise

709
00:33:46,680 --> 00:33:48,470
and some traffic to the internet

710
00:33:48,470 --> 00:33:50,420
in order to improve performance.

711
00:33:50,420 --> 00:33:52,240
Now split tunneling
creates a lot of problems,

712
00:33:52,240 --> 00:33:54,370
because it allows us to be direct traffic

713
00:33:54,370 --> 00:33:57,600
to malicious places outside of the control

714
00:33:57,600 --> 00:34:00,803
of your corporate security infrastructure.

715
00:34:01,680 --> 00:34:05,200
Microsoft presents or
recommends an alternative

716
00:34:05,200 --> 00:34:08,409
which is possible on any
product, called the Forced Tunnel

717
00:34:08,409 --> 00:34:10,460
but with exceptions.

718
00:34:10,460 --> 00:34:12,620
Basically the idea is that you channel

719
00:34:12,620 --> 00:34:15,370
almost all of your traffic
into the enterprise

720
00:34:15,370 --> 00:34:17,650
with some very specific exceptions.

721
00:34:17,650 --> 00:34:20,460
Now that list of exceptions
doesn't have to be small.

722
00:34:20,460 --> 00:34:22,120
You can throw in just about anything,

723
00:34:22,120 --> 00:34:26,880
high bandwidth that the
user might need or want.

724
00:34:26,880 --> 00:34:28,380
Provided that you know what it is.

725
00:34:28,380 --> 00:34:31,920
Facebook, YouTube, Salesforce, Office 365,

726
00:34:31,920 --> 00:34:32,753
put them all in there.

727
00:34:32,753 --> 00:34:34,420
But make sure that everything else,

728
00:34:34,420 --> 00:34:36,409
including traffic to the local LAN,

729
00:34:36,409 --> 00:34:37,940
rather goes through the tunnel.

730
00:34:37,940 --> 00:34:39,423
And finally, once again,

731
00:34:41,067 --> 00:34:44,830
we broadly exploit our control of the DNS

732
00:34:44,830 --> 00:34:47,049
when we own the access point,

733
00:34:47,050 --> 00:34:48,900
to facilitate these attacks.

734
00:34:48,900 --> 00:34:50,659
So what you wanna do, is
you wanna make sure that

735
00:34:50,659 --> 00:34:52,489
as soon as the user's connected,

736
00:34:52,489 --> 00:34:56,580
the VPN product forces the
DNS cache to be flashed,

737
00:34:56,580 --> 00:34:59,850
and that DNS is served
exclusively from war environments

738
00:34:59,850 --> 00:35:00,900
to the endpoint.

739
00:35:00,900 --> 00:35:04,080
Focus on those three things, primarily

740
00:35:04,080 --> 00:35:05,390
when you get back to the office

741
00:35:05,390 --> 00:35:08,100
and you would have made good progress.

742
00:35:08,100 --> 00:35:09,252
Once that's done.

743
00:35:10,260 --> 00:35:11,860
Given a little bit more time,

744
00:35:11,860 --> 00:35:15,160
we would encourage you
to do just two things.

745
00:35:15,160 --> 00:35:16,640
The one is visit our website,

746
00:35:16,640 --> 00:35:19,220
we've got an extensive set
of resources on the problem.

747
00:35:19,220 --> 00:35:22,149
The previous work, background
to this presentation,

748
00:35:22,150 --> 00:35:25,030
very detailed paper on recommendations,

749
00:35:25,030 --> 00:35:26,800
demo videos you name it.

750
00:35:26,800 --> 00:35:29,400
And take some time to have
a look at that in detail

751
00:35:29,400 --> 00:35:32,467
and internalize these risks that are faced

752
00:35:32,467 --> 00:35:34,370
by your home users.

753
00:35:34,370 --> 00:35:35,710
Make sure that you understand them

754
00:35:35,710 --> 00:35:40,300
and make sure how they
apply to your risk appetite

755
00:35:40,300 --> 00:35:42,622
and your environment.

756
00:35:42,622 --> 00:35:45,470
And then finally in the longer term,

757
00:35:45,470 --> 00:35:47,160
we would encourage people

758
00:35:47,160 --> 00:35:50,140
to consider some alternative paradigms.

759
00:35:50,140 --> 00:35:52,870
Really this problem emerges from the fact

760
00:35:52,870 --> 00:35:55,660
that you don't have control
of the user's access point.

761
00:35:55,660 --> 00:35:57,487
You can't patch it,
you can't configure it,

762
00:35:57,487 --> 00:35:58,537
you can't monitor it.

763
00:35:59,400 --> 00:36:03,170
And that happens because,
you're depending on your users

764
00:36:03,170 --> 00:36:06,380
to use their own free
home internet to connect.

765
00:36:06,380 --> 00:36:08,990
Maybe it's time to consider
other alternatives,

766
00:36:08,990 --> 00:36:12,997
like providing your own
users with connectivity

767
00:36:12,997 --> 00:36:16,089
and IT that's sponsored
and controlled by you.

768
00:36:16,090 --> 00:36:19,060
There's some wonderful
hardware-based SD- WAN products

769
00:36:19,060 --> 00:36:21,470
that are remote to keep
controllable via the cloud.

770
00:36:21,470 --> 00:36:22,906
Ship the user and access point.

771
00:36:22,907 --> 00:36:24,340
You can configure it, you can control it,

772
00:36:24,340 --> 00:36:26,600
to force the traffic down with VPN.

773
00:36:26,600 --> 00:36:28,830
We've seen it done and
it works very nicely.

774
00:36:28,830 --> 00:36:32,037
Or even consider using mobile data

775
00:36:32,037 --> 00:36:34,669
or with the maybe a private access point.

776
00:36:34,670 --> 00:36:36,970
A mobile access point
for your remote workers.

777
00:36:37,920 --> 00:36:40,000
And then on top of that,
we really encourage you

778
00:36:40,000 --> 00:36:42,790
to begin your Zero Trust journey.

779
00:36:42,790 --> 00:36:44,810
And just to reiterate what Wicus said.

780
00:36:44,810 --> 00:36:47,590
Zero Trust is not about
buying a different technology.

781
00:36:47,590 --> 00:36:50,030
It's a different mindset that assumes that

782
00:36:50,030 --> 00:36:52,410
all of these components are compromised

783
00:36:52,410 --> 00:36:55,379
and properly mitigate the
threats that they represent.

784
00:36:55,380 --> 00:36:59,090
And it's a model that assumes
that breach is inevitable

785
00:36:59,090 --> 00:37:00,740
or has already occurred.

786
00:37:00,740 --> 00:37:03,359
And that's the mindset
that we need to switch into

787
00:37:03,360 --> 00:37:08,040
rather than just trying to
layer technology on technology.

788
00:37:08,040 --> 00:37:11,009
And with that, our time is up.

789
00:37:11,010 --> 00:37:13,940
Thank you very much for taking
the time to listen to us.

790
00:37:13,940 --> 00:37:16,170
So once again, I would encourage you,

791
00:37:16,170 --> 00:37:18,166
please reach out to us, take a screenshot.

792
00:37:18,166 --> 00:37:20,090
Follow us on on Twitter

793
00:37:20,090 --> 00:37:22,347
so we can continue this
conversation there.

794
00:37:22,347 --> 00:37:24,990
And finally we have a long session

795
00:37:24,990 --> 00:37:28,450
following this presentation
where we can engage with you

796
00:37:28,450 --> 00:37:32,629
in much more detail than
at a much more easily pace.

797
00:37:32,630 --> 00:37:35,742
So we look forward to
having the conversation

798
00:37:35,742 --> 00:37:37,080
with you there.

799
00:37:37,080 --> 00:37:39,779
Thanks very much and enjoy
the rest of the conference.

