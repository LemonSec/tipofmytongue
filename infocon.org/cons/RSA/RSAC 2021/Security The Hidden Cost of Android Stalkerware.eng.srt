1
00:00:01,240 --> 00:00:02,219
- Hello, everybody,

2
00:00:02,220 --> 00:00:06,220
my name is Lukas and I'm
Android malware analyst at ESET,

3
00:00:06,220 --> 00:00:08,189
and today I would like to share

4
00:00:08,189 --> 00:00:11,080
with you our research regarding security

5
00:00:11,080 --> 00:00:15,650
and privacy issues discovered
in Android stalkerware.

6
00:00:15,650 --> 00:00:18,600
If you thought that social media
knows everything about you,

7
00:00:18,600 --> 00:00:20,510
you were right, however,

8
00:00:20,510 --> 00:00:23,333
today I will tell you that there are apps

9
00:00:23,333 --> 00:00:24,810
that know even more,

10
00:00:24,810 --> 00:00:26,979
would you like to know more?

11
00:00:26,980 --> 00:00:29,900
Have you ever been
feeling like spied upon?

12
00:00:29,900 --> 00:00:32,159
Have you ever encountered strange behavior

13
00:00:32,159 --> 00:00:33,449
of your smartphone?

14
00:00:33,450 --> 00:00:35,913
Have you ever had a feeling that you know

15
00:00:35,913 --> 00:00:37,339
that somebody knows,

16
00:00:37,340 --> 00:00:39,253
but you don't know how they know?

17
00:00:41,210 --> 00:00:42,380
They might know it

18
00:00:42,380 --> 00:00:45,070
because they installed
a stalkerware software

19
00:00:45,070 --> 00:00:46,620
in your smartphone,

20
00:00:46,620 --> 00:00:48,879
so what is stalkerware?

21
00:00:48,880 --> 00:00:51,690
Simply put, it's a spying app,

22
00:00:51,690 --> 00:00:54,050
stalker needs to have a physical access

23
00:00:54,050 --> 00:00:55,559
to the victim's smartphone,

24
00:00:55,560 --> 00:00:56,600
unlocks it,

25
00:00:56,600 --> 00:00:59,610
sideload the application, set up the app,

26
00:00:59,610 --> 00:01:02,230
allow all the necessary permissions,

27
00:01:02,230 --> 00:01:04,569
and well, based on these permissions,

28
00:01:04,569 --> 00:01:08,389
you can tell what are the
capabilities of the software,

29
00:01:08,390 --> 00:01:12,230
afterwards, stalkerware is
hidden from the victim's view

30
00:01:12,230 --> 00:01:15,613
and impersonating
application such as settings.

31
00:01:16,860 --> 00:01:19,080
Where these apps could be downloaded from?

32
00:01:19,080 --> 00:01:20,710
Besides shady sites,

33
00:01:20,710 --> 00:01:24,550
apparently they were
available even on Google Play,

34
00:01:24,550 --> 00:01:28,179
in posing as kid or employee spies,

35
00:01:28,180 --> 00:01:30,780
resulting, in fact, that it was not

36
00:01:30,780 --> 00:01:33,580
that difficult to install them whatsoever,

37
00:01:33,580 --> 00:01:35,500
precisely they were installed

38
00:01:35,500 --> 00:01:40,410
over 140,000 times from
Google Play Store alone,

39
00:01:40,410 --> 00:01:42,380
numbers speaks for itself,

40
00:01:42,380 --> 00:01:46,149
based on our data from our
Android client devices,

41
00:01:46,150 --> 00:01:48,340
as you can see in the slide now,

42
00:01:48,340 --> 00:01:51,200
these apps have become
a more and more popular

43
00:01:51,200 --> 00:01:53,080
in the last couple of years.

44
00:01:53,080 --> 00:01:56,835
In 2019, we detected
five times more installs

45
00:01:56,835 --> 00:01:58,740
as in previous year,

46
00:01:58,740 --> 00:02:03,250
last year, detection increased up to 48%,

47
00:02:03,250 --> 00:02:05,833
we see the popularity still on the rise.

48
00:02:06,850 --> 00:02:11,850
So how can we make sure no one
is looking over our shoulder?

49
00:02:11,850 --> 00:02:13,430
This problem has been discussed,

50
00:02:13,430 --> 00:02:14,720
and luckily for us,

51
00:02:14,720 --> 00:02:16,970
it has been solved, how?

52
00:02:16,970 --> 00:02:18,540
Either by manually

53
00:02:18,540 --> 00:02:22,670
or automatically using
trustworthy security solution

54
00:02:22,670 --> 00:02:27,192
that detects, informs,
removes our uninvited guest.

55
00:02:28,560 --> 00:02:32,810
However, it's enormous
popularity made us wonder

56
00:02:32,810 --> 00:02:35,180
and worry about one more problem,

57
00:02:35,180 --> 00:02:36,703
who else might be watching?

58
00:02:38,080 --> 00:02:41,740
Since stalkerware
gathers more private data

59
00:02:41,740 --> 00:02:45,220
about their victims than any
other app you have installed

60
00:02:45,220 --> 00:02:47,470
in your smartphone right now,

61
00:02:47,470 --> 00:02:48,970
I'm talking about privacy

62
00:02:48,970 --> 00:02:51,300
and security of victim information

63
00:02:51,300 --> 00:02:52,920
that might be at risk,

64
00:02:52,920 --> 00:02:56,512
since such software can
access almost all of them.

65
00:02:58,670 --> 00:02:59,959
When we picked one

66
00:02:59,960 --> 00:03:02,570
of the most popular social
media app permissions

67
00:03:02,570 --> 00:03:06,030
to compare them with
stalkerware, important thing,

68
00:03:06,030 --> 00:03:09,130
social media app request
these permissions only

69
00:03:09,130 --> 00:03:10,310
when necessary,

70
00:03:10,310 --> 00:03:12,270
it means when user
wants to take a picture,

71
00:03:12,270 --> 00:03:14,080
there is a request to allow permission,

72
00:03:14,080 --> 00:03:16,760
at one time during using the application

73
00:03:16,760 --> 00:03:18,609
or a lifetime on the app,

74
00:03:18,610 --> 00:03:20,890
contrary, stalkerware,

75
00:03:20,890 --> 00:03:22,820
in order to work properly,

76
00:03:22,820 --> 00:03:25,120
all the permissions needs to be checked,

77
00:03:25,120 --> 00:03:29,713
as a result, the stalker has
full access all the time.

78
00:03:31,610 --> 00:03:33,130
Let's take a look,

79
00:03:33,130 --> 00:03:36,280
the phone on the right
belongs to the attacker,

80
00:03:36,280 --> 00:03:38,660
the attacker is not a stalker,

81
00:03:38,660 --> 00:03:39,570
it's a person

82
00:03:40,460 --> 00:03:44,290
that misuses security
issues found in stalkerware,

83
00:03:44,290 --> 00:03:46,720
victim and stalker are not aware

84
00:03:46,720 --> 00:03:49,580
of the attacker or these actions,

85
00:03:49,580 --> 00:03:52,110
the phone on the left
belongs to the victim,

86
00:03:52,110 --> 00:03:55,413
the attacker sends text
message to a victim,

87
00:03:57,230 --> 00:03:59,549
victim receives text message,

88
00:03:59,550 --> 00:04:03,020
stalkerware will process it,

89
00:04:03,020 --> 00:04:06,970
and that would trigger a phone
call back to the attacker,

90
00:04:06,970 --> 00:04:11,410
instantly opening microphone
spying opportunities

91
00:04:11,410 --> 00:04:12,859
without a victim's knowledge.

92
00:04:16,910 --> 00:04:19,399
Please pay attention to upcoming slides

93
00:04:19,399 --> 00:04:23,022
where we will deep dive and
share with you our research,

94
00:04:23,890 --> 00:04:27,900
we will focus on stalkerware security,

95
00:04:27,900 --> 00:04:30,650
that will be followed
by forensic analysis,

96
00:04:30,650 --> 00:04:32,219
and we will close all that

97
00:04:32,220 --> 00:04:35,683
with responsible disclosure
to affected vendors.

98
00:04:38,790 --> 00:04:42,220
We gathered stalkerware
apps from various sources,

99
00:04:42,220 --> 00:04:45,930
starting with stalkerware
indicators of compromise,

100
00:04:45,930 --> 00:04:46,763
at that time,

101
00:04:46,763 --> 00:04:49,700
there was available
around 40 stalkerwares,

102
00:04:49,700 --> 00:04:51,760
some of them were offline,

103
00:04:51,760 --> 00:04:53,603
I'll explain that later on,

104
00:04:55,400 --> 00:04:58,120
then based on the most prevalent,

105
00:04:58,120 --> 00:05:03,120
popular stalkerwares on
infected devices on our clients,

106
00:05:05,400 --> 00:05:07,429
then through paid advertisement,

107
00:05:07,430 --> 00:05:10,380
paid PR articles, Google search,

108
00:05:10,380 --> 00:05:11,710
and because of that,

109
00:05:11,710 --> 00:05:16,710
we gathered 101 information
about mobile stalkerwares.

110
00:05:17,160 --> 00:05:19,600
However, mobile stalkerware is divided

111
00:05:19,600 --> 00:05:23,190
to two main platforms, iOS and Android,

112
00:05:23,190 --> 00:05:25,330
we focused only on Android,

113
00:05:25,330 --> 00:05:28,140
the reason is simple, market share,

114
00:05:28,140 --> 00:05:30,543
and easiness of sideloading apps,

115
00:05:31,530 --> 00:05:33,400
comparing to iOS,

116
00:05:33,400 --> 00:05:35,640
device needs to be either jailbroken

117
00:05:35,640 --> 00:05:38,919
or stalker needs to
have iCloud credentials,

118
00:05:38,920 --> 00:05:42,250
and there's one more reason
from all the analyzed apps,

119
00:05:42,250 --> 00:05:45,520
they provide solution
for Android platform,

120
00:05:45,520 --> 00:05:50,053
but only something over
37% for iOS as well.

121
00:05:52,940 --> 00:05:57,280
So our plan was to analyze
all these 101 stalkerwares,

122
00:05:57,280 --> 00:05:59,710
unfortunately 15, or fortunately,

123
00:05:59,710 --> 00:06:03,229
15 were offline, not available,

124
00:06:03,230 --> 00:06:05,200
most likely out of business,

125
00:06:05,200 --> 00:06:08,920
their server or website was not available,

126
00:06:08,920 --> 00:06:10,250
because of that,

127
00:06:10,250 --> 00:06:14,070
it was impossible for potential
clients to download the app.

128
00:06:14,070 --> 00:06:16,923
We end up with analyzing 86 apps,

129
00:06:17,860 --> 00:06:18,760
how we did that?

130
00:06:18,760 --> 00:06:21,840
Using manual, static and dynamic analysis

131
00:06:21,840 --> 00:06:24,472
to observe it's behaviors
and capabilities,

132
00:06:25,430 --> 00:06:27,050
because of possible legal issues,

133
00:06:27,050 --> 00:06:29,050
we would like to state a fact

134
00:06:29,050 --> 00:06:32,520
that this is not a full penetration test,

135
00:06:32,520 --> 00:06:34,260
we focused on privacy,

136
00:06:34,260 --> 00:06:37,440
security issues with actual
impact on the clients,

137
00:06:37,440 --> 00:06:39,290
victims, company,

138
00:06:39,290 --> 00:06:41,483
however, matter is really serious.

139
00:06:43,460 --> 00:06:44,690
There were some limitations

140
00:06:44,690 --> 00:06:47,090
that I would like to
go through them first,

141
00:06:47,090 --> 00:06:50,409
because we haven't paid
for any of the software,

142
00:06:50,410 --> 00:06:52,040
we didn't want to support them,

143
00:06:52,040 --> 00:06:55,470
we were limited by the provided
functionality of the app,

144
00:06:55,470 --> 00:06:58,240
as well as availability of the server,

145
00:06:58,240 --> 00:07:00,980
since server that is accessible only

146
00:07:00,980 --> 00:07:05,800
by stalker sends commands
to stalker victim device,

147
00:07:05,800 --> 00:07:07,170
that process the commands,

148
00:07:07,170 --> 00:07:09,260
gathers data and sends them back,

149
00:07:09,260 --> 00:07:11,777
and these data are then
stored on the server,

150
00:07:14,200 --> 00:07:18,300
still, we were able to fully test 72 apps,

151
00:07:18,300 --> 00:07:21,903
only 14 were limited to
static analysis only.

152
00:07:23,400 --> 00:07:25,710
Okay, so what were our findings?

153
00:07:25,710 --> 00:07:29,099
From 86 apps, we found security issues

154
00:07:29,100 --> 00:07:33,780
with serious impact in
67% of analyzed apps,

155
00:07:33,780 --> 00:07:37,119
33% were without serious security

156
00:07:37,120 --> 00:07:38,553
or privacy issue discovered,

157
00:07:40,230 --> 00:07:41,110
all altogether,

158
00:07:41,110 --> 00:07:46,110
we identified 158 exploitable
issues in 58 apps,

159
00:07:47,610 --> 00:07:50,063
which stands for 67%.

160
00:07:51,490 --> 00:07:53,940
Now, let's continue with
the particular problems,

161
00:07:55,760 --> 00:07:56,710
because the limitations,

162
00:07:56,710 --> 00:08:01,080
we still could gather,
identify 158 issues,

163
00:08:01,080 --> 00:08:04,789
and right now I will go
through the most prevalent one,

164
00:08:04,790 --> 00:08:07,520
which are such as leak on the network,

165
00:08:07,520 --> 00:08:08,549
leak on the device,

166
00:08:08,550 --> 00:08:11,050
leak on the server of
the private information,

167
00:08:11,050 --> 00:08:13,010
sensitive information of the victim,

168
00:08:13,010 --> 00:08:16,539
possibility to manipulate the
victim's data on the server,

169
00:08:16,540 --> 00:08:20,820
remotely control stalkerware
victim device by text message,

170
00:08:20,820 --> 00:08:24,110
open directory leaks, account takeover,

171
00:08:24,110 --> 00:08:28,110
possibility to livestream
from victim's smartphone,

172
00:08:28,110 --> 00:08:30,550
I prepared two more video demonstration

173
00:08:30,550 --> 00:08:32,630
of exploiting some vulnerabilities,

174
00:08:32,630 --> 00:08:34,323
I will go through them briefly.

175
00:08:35,750 --> 00:08:39,370
Now, let's go through
the most serious ones,

176
00:08:39,370 --> 00:08:44,159
starting with using
unencrypted HTTP protocol,

177
00:08:44,159 --> 00:08:45,199
what does it mean?

178
00:08:45,200 --> 00:08:47,770
Every stalkerware once
it gathers all the data

179
00:08:47,770 --> 00:08:48,920
and needs to send them to the server,

180
00:08:48,920 --> 00:08:51,983
and on the server they
are available for stalker,

181
00:08:52,920 --> 00:08:54,510
problem is that the communication

182
00:08:54,510 --> 00:08:58,290
between the device and the
server was not encrypted,

183
00:08:58,290 --> 00:08:59,823
not protected anyhow,

184
00:09:01,030 --> 00:09:03,339
this could be misused in a couple of ways,

185
00:09:03,340 --> 00:09:06,490
the first one, when stalker
installs the stalkerware

186
00:09:06,490 --> 00:09:07,540
on a smartphone,

187
00:09:07,540 --> 00:09:10,252
he needs to create account or login,

188
00:09:12,290 --> 00:09:13,130
because of that,

189
00:09:13,130 --> 00:09:16,939
the credentials are not
anyhow additionally encrypted,

190
00:09:16,940 --> 00:09:19,800
they are sent as in plain text,

191
00:09:19,800 --> 00:09:20,939
and because of that,

192
00:09:20,940 --> 00:09:23,680
the attacker that is on the same network,

193
00:09:23,680 --> 00:09:26,599
on the same Wi-Fi, let's say,

194
00:09:26,600 --> 00:09:28,920
could intercept that communication,

195
00:09:28,920 --> 00:09:30,353
obtain the credentials,

196
00:09:30,353 --> 00:09:32,882
access the admin panel
and control the victim.

197
00:09:35,050 --> 00:09:37,250
Stalkerware could also update themself

198
00:09:37,250 --> 00:09:39,990
or download additional components
that are then triggered,

199
00:09:39,990 --> 00:09:42,030
these are components that are necessary

200
00:09:42,030 --> 00:09:45,122
to gather data from the victim,

201
00:09:46,180 --> 00:09:50,630
and because of no integrity
check of downloaded binaries,

202
00:09:50,630 --> 00:09:51,660
data hacker, again,

203
00:09:51,660 --> 00:09:53,350
on the same network, same Wi-Fi,

204
00:09:53,350 --> 00:09:57,600
could replace the updates
for the malicious apps

205
00:09:57,600 --> 00:09:59,953
and trigger remote code execution.

206
00:10:01,400 --> 00:10:03,500
The most common issue was a leak

207
00:10:03,500 --> 00:10:05,830
of old extracted victim's data,

208
00:10:05,830 --> 00:10:09,550
they were sent in plain text to server,

209
00:10:09,550 --> 00:10:13,479
there were text messages,
call log history,

210
00:10:13,480 --> 00:10:16,310
contacts, browsing history,

211
00:10:16,310 --> 00:10:18,569
taken photos, screenshots,

212
00:10:18,570 --> 00:10:21,083
and many, many others.

213
00:10:22,010 --> 00:10:26,520
The impact of using
unencrypted HTTP is simple,

214
00:10:26,520 --> 00:10:28,710
it's a possibility to take over account,

215
00:10:28,710 --> 00:10:33,710
as you saw, credentials are
sent unprotected, unencrypted,

216
00:10:34,010 --> 00:10:36,600
possibility to trigger
remote code execution

217
00:10:36,600 --> 00:10:40,510
and stealing data that were uploaded

218
00:10:40,510 --> 00:10:42,319
by the victim to the device,

219
00:10:42,320 --> 00:10:43,903
to a smartphone, to server.

220
00:10:45,560 --> 00:10:47,219
From a leak on the network,

221
00:10:47,220 --> 00:10:49,840
move to a leak on a device,

222
00:10:49,840 --> 00:10:52,760
it's a leaking of personally
identifiable information

223
00:10:52,760 --> 00:10:53,990
on a smartphone,

224
00:10:53,990 --> 00:10:56,650
well, let me tell you more,

225
00:10:56,650 --> 00:10:59,473
since stalkerware gathers
information about the victim,

226
00:10:59,473 --> 00:11:02,010
this data needs to be stored somewhere,

227
00:11:02,010 --> 00:11:04,580
and then extract it to server,

228
00:11:04,580 --> 00:11:06,780
problem is that these gathered data,

229
00:11:06,780 --> 00:11:08,589
which contains sensitive information,

230
00:11:08,590 --> 00:11:11,720
are stored on external media,

231
00:11:11,720 --> 00:11:15,570
which is accessible to all the
apps installed on the device,

232
00:11:15,570 --> 00:11:17,310
with the proper permission,

233
00:11:17,310 --> 00:11:18,423
read, write storage,

234
00:11:20,060 --> 00:11:24,819
in one case, stalkerware
would store admin token

235
00:11:24,820 --> 00:11:25,920
on external media,

236
00:11:25,920 --> 00:11:27,459
and by misusing this token,

237
00:11:27,460 --> 00:11:30,490
it was possible for attacker to get access

238
00:11:30,490 --> 00:11:32,663
to admin console and control the victim.

239
00:11:35,910 --> 00:11:38,910
Some of the stalkerware provided
keylogger functionality,

240
00:11:38,910 --> 00:11:43,910
meaning they could log all
user input from all apps,

241
00:11:44,650 --> 00:11:46,170
these keylogs, problem is,

242
00:11:46,170 --> 00:11:48,709
were stored on external
media in text file,

243
00:11:48,710 --> 00:11:50,240
including sensitive information,

244
00:11:50,240 --> 00:11:52,973
such as passwords and their apps,

245
00:11:52,973 --> 00:11:56,219
this was a result in taking over accounts

246
00:11:56,220 --> 00:11:58,220
or stealing credentials to accounts

247
00:11:58,220 --> 00:12:00,660
that does not belong to stalker,

248
00:12:00,660 --> 00:12:03,642
belongs to other apps from other contexts.

249
00:12:05,800 --> 00:12:07,740
The most frequently seen device leak

250
00:12:07,740 --> 00:12:12,740
was unprotected storing of
externally extracted data,

251
00:12:13,470 --> 00:12:15,580
such as recorded phone calls,

252
00:12:15,580 --> 00:12:17,650
taken photos, screenshots,

253
00:12:17,650 --> 00:12:21,630
in some cases, even calendar
events, browsing history,

254
00:12:21,630 --> 00:12:23,600
contact list, phone number,

255
00:12:23,600 --> 00:12:25,453
and the received text messages,

256
00:12:26,340 --> 00:12:28,400
the impact of a leak on a device,

257
00:12:28,400 --> 00:12:30,273
is that any third party app

258
00:12:30,273 --> 00:12:32,440
that is installed on a smartphone

259
00:12:32,440 --> 00:12:35,310
could, with read, write
storage permission,

260
00:12:35,310 --> 00:12:38,642
access these files
without proper permission.

261
00:12:41,610 --> 00:12:42,540
From device leak,

262
00:12:42,540 --> 00:12:44,870
move to leak on a server,

263
00:12:44,870 --> 00:12:48,910
user data leaks through open directories,

264
00:12:48,910 --> 00:12:52,430
there were available data
such as a victim's photos,

265
00:12:52,430 --> 00:12:53,939
recorded phone calls,

266
00:12:53,940 --> 00:12:55,630
details about the victim,

267
00:12:55,630 --> 00:12:59,820
such as names, addresses,
physical addresses,

268
00:12:59,820 --> 00:13:03,850
email addresses, text messages,
social media messages,

269
00:13:03,850 --> 00:13:06,090
these data were accessible

270
00:13:06,090 --> 00:13:08,293
without any authentication for anyone.

271
00:13:11,670 --> 00:13:14,959
Let's head on to uploading
victim's data to server

272
00:13:14,960 --> 00:13:18,090
before account is actually set up,

273
00:13:18,090 --> 00:13:21,440
I'll explain that in two scenarios,

274
00:13:21,440 --> 00:13:22,420
how this could be misused,

275
00:13:22,420 --> 00:13:27,420
the first one, stalkerware
installs the app on a device

276
00:13:28,650 --> 00:13:32,490
and after launch realizes
he first needs to purchase,

277
00:13:32,490 --> 00:13:35,146
so he will remove the app
and searches for another one

278
00:13:35,146 --> 00:13:37,839
that maybe is for free,

279
00:13:37,840 --> 00:13:40,440
unfortunately, the app already extracted

280
00:13:40,440 --> 00:13:43,070
from a device call log history,

281
00:13:43,070 --> 00:13:46,580
email address and SMS messages,

282
00:13:46,580 --> 00:13:48,520
even though there was no license,

283
00:13:48,520 --> 00:13:49,810
second case scenario,

284
00:13:49,810 --> 00:13:51,750
after license expires,

285
00:13:51,750 --> 00:13:52,697
and because of that,

286
00:13:52,697 --> 00:13:55,460
the stalker cannot access admin console

287
00:13:55,460 --> 00:13:56,790
and see the gathered data

288
00:13:56,790 --> 00:13:58,939
or send commands to victim,

289
00:13:58,940 --> 00:14:01,580
stalkerware app that is
installed on a smartphone

290
00:14:01,580 --> 00:14:04,070
could still extract personal information

291
00:14:04,070 --> 00:14:06,100
and send them to server,

292
00:14:06,100 --> 00:14:08,560
even though the license came to an end,

293
00:14:08,560 --> 00:14:11,323
we've seen this behavior in 15 cases.

294
00:14:13,490 --> 00:14:15,280
During analysis we discovered and tested

295
00:14:15,280 --> 00:14:19,850
that manipulating the victims
data wasn't a problem,

296
00:14:19,850 --> 00:14:24,420
many apps used for pairing
device and a server account,

297
00:14:24,420 --> 00:14:25,990
unique device ID,

298
00:14:25,990 --> 00:14:28,600
such as IMEI number, Android ID,

299
00:14:28,600 --> 00:14:31,460
instead of using server generated token,

300
00:14:31,460 --> 00:14:35,000
however, these IDs could
be easily obtained,

301
00:14:35,000 --> 00:14:37,993
extracted by other apps
installed on a smartphone,

302
00:14:39,430 --> 00:14:40,959
two ways how to misuse that,

303
00:14:40,960 --> 00:14:45,700
the first one, the attacker
on the same network,

304
00:14:45,700 --> 00:14:49,080
if data are uploaded
over unencrypted HTTP,

305
00:14:49,080 --> 00:14:52,180
could manipulate, could
fabricate with the data,

306
00:14:52,180 --> 00:14:54,489
and upload custom text messages,

307
00:14:54,490 --> 00:14:57,890
custom photos, screenshots, communication,

308
00:14:57,890 --> 00:15:00,920
call log histories to frame a person,

309
00:15:00,920 --> 00:15:02,030
to frame a victim,

310
00:15:02,030 --> 00:15:06,372
or make her life a little bit more harder.

311
00:15:07,980 --> 00:15:11,250
Second example, apps
installed on a smartphone

312
00:15:11,250 --> 00:15:13,340
could obtain the device ID,

313
00:15:13,340 --> 00:15:14,804
and by using the ID they

314
00:15:14,804 --> 00:15:19,804
could upload custom
fabricated tampered data

315
00:15:19,910 --> 00:15:22,057
to server for stalker to see.

316
00:15:25,670 --> 00:15:27,400
If there is no internet connection

317
00:15:27,400 --> 00:15:29,170
on the victim's smartphone,

318
00:15:29,170 --> 00:15:32,060
some of the stalkerware provided ability

319
00:15:32,060 --> 00:15:34,380
to receive text messages commands,

320
00:15:34,380 --> 00:15:37,180
however, not all of them
verify if the command

321
00:15:37,180 --> 00:15:39,099
is received from stalker,

322
00:15:39,100 --> 00:15:40,010
and because of that,

323
00:15:40,010 --> 00:15:43,463
anyone could remotely
control a victim's device,

324
00:15:44,660 --> 00:15:47,350
there are two things that are necessary,

325
00:15:47,350 --> 00:15:51,623
the first, we need to know
the commands to send them,

326
00:15:54,140 --> 00:15:58,780
however, stalkerware vendors
provided them on their website,

327
00:15:58,780 --> 00:16:02,300
the second one is to know
a phone number of a victim

328
00:16:02,300 --> 00:16:05,270
where the attacker will send text message,

329
00:16:05,270 --> 00:16:06,610
and this could be, for example,

330
00:16:06,610 --> 00:16:08,954
one of the ways extracted by, again,

331
00:16:08,954 --> 00:16:11,272
app that is installed on a smartphone.

332
00:16:14,120 --> 00:16:17,350
One more example with
sending SMS commands,

333
00:16:17,350 --> 00:16:20,040
the phone on the right
belongs to the attacker,

334
00:16:20,040 --> 00:16:23,490
the phone on the left
belongs to the victim,

335
00:16:23,490 --> 00:16:26,053
the attacker sends text message to victim,

336
00:16:26,930 --> 00:16:28,882
the victim receive text message,

337
00:16:29,800 --> 00:16:34,800
triggers and shares exact GPS
location back to the attacker,

338
00:16:36,470 --> 00:16:40,243
in this case GPS needs to be
enabled on a victim device.

339
00:16:42,870 --> 00:16:47,070
Let's continue with arbitrary
components being available

340
00:16:47,070 --> 00:16:50,220
because of unprotected
components, exported components,

341
00:16:50,220 --> 00:16:51,053
it is possible

342
00:16:51,053 --> 00:16:54,800
to trigger restricted
stalkerwares functionality,

343
00:16:54,800 --> 00:16:59,349
as a result, any application
on the smartphone could,

344
00:16:59,350 --> 00:17:02,470
through stalkerware, take pictures,

345
00:17:02,470 --> 00:17:05,329
record calls, surrounding audio,

346
00:17:05,329 --> 00:17:08,270
record surrounding
audio, take screenshots,

347
00:17:08,270 --> 00:17:11,050
wipe data, enable, disable GPS,

348
00:17:11,050 --> 00:17:12,883
reboot smartphone, et cetera,

349
00:17:13,740 --> 00:17:16,482
and afterwards access these gathered files

350
00:17:16,482 --> 00:17:19,133
since they are stored on external media.

351
00:17:21,869 --> 00:17:24,142
What happens when spying ends?

352
00:17:25,329 --> 00:17:27,790
This, this is a photo taken

353
00:17:27,790 --> 00:17:30,080
by a stalkerware of my ceiling

354
00:17:30,080 --> 00:17:32,429
while it was lying next to me,

355
00:17:32,430 --> 00:17:35,100
unfortunately, it is still stored

356
00:17:35,100 --> 00:17:36,949
and accessible on the server,

357
00:17:36,950 --> 00:17:38,650
even though the stalker,

358
00:17:38,650 --> 00:17:39,760
in this case me,

359
00:17:39,760 --> 00:17:43,750
removed data logs, un-links smartphone,

360
00:17:43,750 --> 00:17:45,633
and removes full account,

361
00:17:47,290 --> 00:17:51,300
besides my photos still being
available on the server,

362
00:17:51,300 --> 00:17:53,050
there are also my call log history

363
00:17:53,050 --> 00:17:55,720
and text messages available

364
00:17:55,720 --> 00:17:58,270
for anyone without any authentication,

365
00:17:58,270 --> 00:17:59,163
in other case,

366
00:18:00,010 --> 00:18:03,740
data are not removed from server
immediately when requested

367
00:18:03,740 --> 00:18:05,720
by stalker, but rather,

368
00:18:05,720 --> 00:18:08,383
it takes 90 extra days to be deleted.

369
00:18:10,610 --> 00:18:13,550
Let's head to inner
process communication leak,

370
00:18:13,550 --> 00:18:16,409
let me quickly explain what does it mean,

371
00:18:16,410 --> 00:18:18,680
Android apps as well as stalkerware,

372
00:18:18,680 --> 00:18:21,750
they have different
components inside the apps

373
00:18:21,750 --> 00:18:23,610
which needs to communicate to each other,

374
00:18:23,610 --> 00:18:25,820
to send and receive data,

375
00:18:25,820 --> 00:18:27,820
in case of stalkerware,

376
00:18:27,820 --> 00:18:30,210
it has enabled keylogger,

377
00:18:30,210 --> 00:18:32,460
one of the components is some spying

378
00:18:32,460 --> 00:18:36,380
or snooping on all entered
keys from other apps,

379
00:18:36,380 --> 00:18:38,640
and these keys are then sent

380
00:18:38,640 --> 00:18:41,150
to another component of the stalkerware,

381
00:18:41,150 --> 00:18:45,390
problem is that sending
this data was not only

382
00:18:45,390 --> 00:18:47,610
to the component that
belonged to stalkerware,

383
00:18:47,610 --> 00:18:49,439
but it was actually broadcasted

384
00:18:49,440 --> 00:18:52,000
to other apps installed on a smartphone,

385
00:18:52,000 --> 00:18:56,810
so any app that was
listening on such activity

386
00:18:56,810 --> 00:18:59,320
could receive the keylogs,

387
00:18:59,320 --> 00:19:02,620
as a result, every app
could be a keylogger

388
00:19:02,620 --> 00:19:04,627
because of the stalkerware.

389
00:19:07,648 --> 00:19:11,480
Stalkerware having a not
restricted access to admin panel

390
00:19:11,480 --> 00:19:13,040
or admin panel APIs,

391
00:19:13,040 --> 00:19:15,520
that would partially allow

392
00:19:15,520 --> 00:19:20,520
to extract information
about victims by having ID,

393
00:19:20,600 --> 00:19:21,433
this is necessary,

394
00:19:21,433 --> 00:19:23,763
an ID is, in this case, IMEI number.

395
00:19:26,360 --> 00:19:29,179
There's one special
functionality in the stalkerware

396
00:19:29,180 --> 00:19:31,460
which was actually
powerful for the attacker,

397
00:19:31,460 --> 00:19:36,140
since there were scheduled reports defined

398
00:19:36,140 --> 00:19:37,150
in the application,

399
00:19:37,150 --> 00:19:41,710
and these scheduled reports
could extract, at some time,

400
00:19:41,710 --> 00:19:43,140
all the call logs history

401
00:19:43,140 --> 00:19:45,740
and text messages sent and received,

402
00:19:45,740 --> 00:19:47,580
they were put to PDF file

403
00:19:47,580 --> 00:19:49,889
and the PDF file was then sent

404
00:19:49,890 --> 00:19:53,563
to the email address of the stalker,

405
00:19:54,910 --> 00:19:58,320
for the attacker, once
he has the IMEI number

406
00:19:58,320 --> 00:19:59,820
and accesses the panel,

407
00:19:59,820 --> 00:20:03,550
he could replace the email
address of the stalker

408
00:20:03,550 --> 00:20:05,350
for the address that
belongs to the attacker,

409
00:20:05,350 --> 00:20:08,800
and then it would receive
all this information

410
00:20:08,800 --> 00:20:10,423
on behalf of the stalker.

411
00:20:12,600 --> 00:20:14,919
Hard-coded secrets, it's not a token

412
00:20:14,920 --> 00:20:17,580
or password as you might expect,

413
00:20:17,580 --> 00:20:21,370
rather just server links
that are responsible

414
00:20:21,370 --> 00:20:23,610
for triggering livestream,

415
00:20:25,230 --> 00:20:27,610
what is this all about?

416
00:20:27,610 --> 00:20:29,929
In app are hard-coded links

417
00:20:29,930 --> 00:20:32,370
that could, through server,

418
00:20:32,370 --> 00:20:36,060
trigger livestream from
a particular device,

419
00:20:36,060 --> 00:20:39,550
the only thing that's
necessary is device ID,

420
00:20:39,550 --> 00:20:44,550
but this device ID is stored
on external shared media

421
00:20:44,870 --> 00:20:48,320
and accessible to apps that have a read,

422
00:20:48,320 --> 00:20:49,822
write storage permission,

423
00:20:51,360 --> 00:20:54,812
I will demonstrate that
right now on the example,

424
00:20:56,080 --> 00:20:59,949
where, on the left side
is a victim's smartphone,

425
00:20:59,950 --> 00:21:02,560
and all the attacker needs
are just three links,

426
00:21:02,560 --> 00:21:07,293
the first one is where the
stream will be outputted,

427
00:21:09,510 --> 00:21:11,260
necessary are only device IDs,

428
00:21:11,260 --> 00:21:12,870
as you can see,

429
00:21:12,870 --> 00:21:15,429
stream is not enabled or active now,

430
00:21:15,430 --> 00:21:16,650
the attacker needs to make

431
00:21:16,650 --> 00:21:20,250
two request to server with that ID

432
00:21:20,250 --> 00:21:25,250
to trigger or to make server send command

433
00:21:25,380 --> 00:21:29,240
to particular smartphone
with this device ID

434
00:21:29,240 --> 00:21:33,150
to broadcast livestream to that link,

435
00:21:33,150 --> 00:21:35,030
and right now the attacker,

436
00:21:35,030 --> 00:21:37,160
without authorization,

437
00:21:37,160 --> 00:21:39,390
can see what is happening
on a victim's smartphone,

438
00:21:39,390 --> 00:21:40,893
can see video and audio.

439
00:21:42,090 --> 00:21:47,060
These were security issues
identified on stalkerware apps,

440
00:21:47,060 --> 00:21:49,860
now let's continue with
the forensic analysis,

441
00:21:49,860 --> 00:21:51,689
because with successful forensics,

442
00:21:51,690 --> 00:21:53,830
it is possible to access internal data

443
00:21:53,830 --> 00:21:56,439
of a stalkerware app that contain

444
00:21:56,440 --> 00:22:00,500
or might contain email
address of the stalker,

445
00:22:00,500 --> 00:22:02,933
some of them, even
credentials in plain text,

446
00:22:04,230 --> 00:22:06,780
what data were extracted
from victim's smartphone

447
00:22:06,780 --> 00:22:07,623
and since when.

448
00:22:09,970 --> 00:22:12,590
So if victim would like
to identify a stalker

449
00:22:12,590 --> 00:22:14,223
before uninstalling it,

450
00:22:15,690 --> 00:22:18,153
it will be possible with device forensics,

451
00:22:19,910 --> 00:22:22,360
retrieving internal data
from stalker is possible

452
00:22:24,950 --> 00:22:27,100
or is necessary to have
physical access to device,

453
00:22:27,100 --> 00:22:31,139
and is possible when a app has one

454
00:22:31,140 --> 00:22:32,930
of the two flags enabled,

455
00:22:32,930 --> 00:22:35,230
either it's debuggable

456
00:22:35,230 --> 00:22:37,093
or it allows to create backups.

457
00:22:38,000 --> 00:22:40,350
for 86 apps that we analyzed,

458
00:22:40,350 --> 00:22:44,429
64% of these apps it was possible

459
00:22:44,430 --> 00:22:46,500
to extract internal information

460
00:22:46,500 --> 00:22:51,500
that might contain information
to identify a stalker.

461
00:22:54,960 --> 00:22:56,960
After finding the problems, the issues,

462
00:22:56,960 --> 00:23:01,230
we tried to report 'em
to effective vendors,

463
00:23:01,230 --> 00:23:04,400
we follow 90 day disclosure practice

464
00:23:04,400 --> 00:23:06,903
by contacting vendor up to three times,

465
00:23:08,020 --> 00:23:10,730
either through email we
found on their website,

466
00:23:10,730 --> 00:23:12,090
creating support ticket,

467
00:23:12,090 --> 00:23:15,937
if it was possible, on the vendor site,

468
00:23:15,937 --> 00:23:17,850
or using combination of these,

469
00:23:17,850 --> 00:23:19,909
if we haven't received a reply

470
00:23:19,910 --> 00:23:23,290
from first or second request,

471
00:23:23,290 --> 00:23:24,990
in two cases, we were not able

472
00:23:24,990 --> 00:23:27,520
to report these issues,

473
00:23:27,520 --> 00:23:28,720
since it appeared to be

474
00:23:28,720 --> 00:23:32,920
that inbox of the vendor was full,

475
00:23:32,920 --> 00:23:36,590
and the second case was creating a ticket

476
00:23:36,590 --> 00:23:38,810
on their websites would
return always error,

477
00:23:38,810 --> 00:23:39,863
always some problem.

478
00:23:43,020 --> 00:23:47,629
As a result from 58 apps
with the security issues,

479
00:23:47,630 --> 00:23:49,166
we communicated with them,

480
00:23:49,166 --> 00:23:53,280
22 something, over 22% of them,

481
00:23:53,280 --> 00:23:58,223
12% of the stalkerware fixed the issues,

482
00:24:00,362 --> 00:24:04,400
10% promised to fix the
issues in a next release,

483
00:24:04,400 --> 00:24:09,400
but the release did not contain
patched for these issues,

484
00:24:12,410 --> 00:24:16,980
and 77.6% have not replied directly to us

485
00:24:16,980 --> 00:24:21,960
and these problems are still
present in their stalkerware,

486
00:24:21,960 --> 00:24:22,963
in their apps,

487
00:24:24,180 --> 00:24:25,050
because of that,

488
00:24:25,050 --> 00:24:27,870
we decided not to publish the full list

489
00:24:27,870 --> 00:24:29,979
where we connect all the problems,

490
00:24:29,980 --> 00:24:31,410
all the vulnerabilities

491
00:24:31,410 --> 00:24:34,303
to particular vendor's particular apps.

492
00:24:36,130 --> 00:24:37,320
Now we're heading to conclusion,

493
00:24:37,320 --> 00:24:41,720
but first let me go through
a compromise scenario,

494
00:24:41,720 --> 00:24:43,260
how it looks like from the attacker

495
00:24:43,260 --> 00:24:47,110
or the stalker position,

496
00:24:47,110 --> 00:24:48,189
and the victim,

497
00:24:48,190 --> 00:24:52,053
how to prevent the victim
device being compromised.

498
00:24:53,510 --> 00:24:56,360
Stalker needs to have physical
access to a smartphone,

499
00:24:56,360 --> 00:24:58,929
it means it cannot be done remotely,

500
00:24:58,930 --> 00:25:01,630
it means the stalker needs

501
00:25:01,630 --> 00:25:05,150
to have a pin to unlock a smartphone,

502
00:25:05,150 --> 00:25:09,540
download application and set-up account,

503
00:25:09,540 --> 00:25:11,343
this can be done within two minutes.

504
00:25:12,440 --> 00:25:13,273
How to prevent?

505
00:25:13,273 --> 00:25:16,199
Make sure to have lock screen protection,

506
00:25:16,200 --> 00:25:18,090
ideally pin,

507
00:25:18,090 --> 00:25:19,590
don't share that pin with anyone,

508
00:25:19,590 --> 00:25:21,870
and if you have any doubts

509
00:25:21,870 --> 00:25:25,193
that someone might enter your device,

510
00:25:27,034 --> 00:25:31,260
I advise you to install
trustworthy security solution

511
00:25:31,260 --> 00:25:34,360
that will detect such malicious behavior

512
00:25:34,360 --> 00:25:35,852
and removes that for you.

513
00:25:40,310 --> 00:25:42,669
Based on what we have
seen in the slides before,

514
00:25:42,670 --> 00:25:47,170
number of stalkerware
app is increasing based

515
00:25:47,170 --> 00:25:49,570
on our data, for example,

516
00:25:49,570 --> 00:25:53,189
as you saw, stalkerware gathers
more private information

517
00:25:53,190 --> 00:25:54,340
about their victims

518
00:25:54,340 --> 00:25:56,060
than any other app you have installed

519
00:25:56,060 --> 00:25:58,300
in your smartphone right now,

520
00:25:58,300 --> 00:26:02,070
unfortunately, many of them
contain security issues

521
00:26:03,410 --> 00:26:05,763
that could affect a victim or a stalker,

522
00:26:08,030 --> 00:26:13,030
and another problem is
that the vendors appears

523
00:26:13,190 --> 00:26:15,180
to be don't care about them,

524
00:26:15,180 --> 00:26:17,370
they don't care about their client,

525
00:26:17,370 --> 00:26:18,850
don't care about fixing them,

526
00:26:18,850 --> 00:26:22,433
since only 12% of them
actually fix these issues.

527
00:26:23,900 --> 00:26:27,530
How to apply these slides in your life?

528
00:26:27,530 --> 00:26:28,933
If you are a developer,

529
00:26:30,050 --> 00:26:33,540
make sure to follow OWASP rules,

530
00:26:33,540 --> 00:26:36,210
hire dedicated security person,

531
00:26:36,210 --> 00:26:38,370
go through a penetration test,

532
00:26:38,370 --> 00:26:41,770
for researchers, if you
identify weak points,

533
00:26:41,770 --> 00:26:44,420
vulnerabilities in Android apps or other,

534
00:26:44,420 --> 00:26:46,340
even in stalkerware,

535
00:26:46,340 --> 00:26:49,639
please follow a responsible
disclosure period,

536
00:26:49,640 --> 00:26:54,640
for enterprise, make sure to
enforce lock screen protection,

537
00:26:55,200 --> 00:26:58,430
pin lock screen or password protection,

538
00:26:58,430 --> 00:27:01,430
restrict your devices to download apps

539
00:27:01,430 --> 00:27:03,230
from third-party stores,

540
00:27:03,230 --> 00:27:05,350
and in a case some bad,

541
00:27:05,350 --> 00:27:07,719
shady app slips through Play Store,

542
00:27:07,720 --> 00:27:09,610
make sure to create a whitelist,

543
00:27:09,610 --> 00:27:11,250
for anyone else,

544
00:27:11,250 --> 00:27:13,970
use a lock screen
protection with strong pin

545
00:27:13,970 --> 00:27:17,250
to restrict access to your smartphone

546
00:27:17,250 --> 00:27:18,733
by unauthorized person.

547
00:27:20,730 --> 00:27:25,730
We would like to appeal to
anyone who might be thinking

548
00:27:25,910 --> 00:27:29,690
of using such software to reconsider that,

549
00:27:29,690 --> 00:27:32,780
using stalkerware to spy on your spouses,

550
00:27:32,780 --> 00:27:34,379
it's not just unethical,

551
00:27:34,380 --> 00:27:36,760
but it also reveals private

552
00:27:36,760 --> 00:27:38,990
and intimate information about them,

553
00:27:38,990 --> 00:27:41,580
but also about those who installed it

554
00:27:41,580 --> 00:27:43,803
and want to spy on their close ones.

555
00:27:45,110 --> 00:27:49,060
This year's RSA carries
a symbol of resilience,

556
00:27:49,060 --> 00:27:51,580
to be resilient in cybersecurity,

557
00:27:51,580 --> 00:27:55,560
we need to join forces to
fight cybersecurity threats

558
00:27:55,560 --> 00:27:57,040
including stalkerware,

559
00:27:57,040 --> 00:27:59,760
to share and raise awareness

560
00:27:59,760 --> 00:28:02,633
to protect unaware and fragile victims.

561
00:28:05,610 --> 00:28:06,889
Thank you very much,

562
00:28:06,890 --> 00:28:10,010
enjoy more resilient talks to come.

