1
00:00:00,783 --> 00:00:02,390
- Hi everyone.

2
00:00:02,390 --> 00:00:03,740
Thanks for coming to my talk.

3
00:00:03,740 --> 00:00:04,760
My name is Zack Allen.

4
00:00:04,760 --> 00:00:07,590
I'm the Senior Director of
Threat Intelligence at ZeroFOX.

5
00:00:07,590 --> 00:00:08,743
And for today,

6
00:00:08,743 --> 00:00:12,366
I'll be talking about my
Phishing Kit Burnbook.

7
00:00:12,366 --> 00:00:14,379
(keyboard clicks)

8
00:00:14,380 --> 00:00:15,213
So,

9
00:00:15,213 --> 00:00:16,710
we have a lot of content to go through

10
00:00:16,710 --> 00:00:17,990
and I'm excited to talk about it.

11
00:00:17,990 --> 00:00:21,009
And I split this talk up into four parts.

12
00:00:21,010 --> 00:00:21,870
The first part,

13
00:00:21,870 --> 00:00:23,820
I'm gonna be talking about
the Phishing Ecosystem,

14
00:00:23,820 --> 00:00:26,060
and I'm gonna try to
convince everybody here

15
00:00:26,060 --> 00:00:27,630
that phishing is more than just a page

16
00:00:27,630 --> 00:00:29,881
and more than just account takeover.

17
00:00:29,881 --> 00:00:32,137
There's a lot of things
that kind of go into it.

18
00:00:32,137 --> 00:00:32,989
Next,

19
00:00:32,990 --> 00:00:34,760
I'm gonna be doing a
Threat Actor Case Study.

20
00:00:34,760 --> 00:00:36,720
So all of the lessons that we've learned

21
00:00:36,720 --> 00:00:39,694
from the phishing ecosystem portion,

22
00:00:39,694 --> 00:00:42,350
we're gonna apply that and study

23
00:00:42,350 --> 00:00:43,390
a threat actor

24
00:00:43,390 --> 00:00:45,930
and a group of people
that perform phishing

25
00:00:45,930 --> 00:00:48,220
at a really, really large scale.

26
00:00:48,220 --> 00:00:50,320
Afterwards, I'm gonna
talk about Year in Review,

27
00:00:50,320 --> 00:00:53,296
where I'm going to look
at different open source

28
00:00:53,296 --> 00:00:54,620
kind of stats

29
00:00:54,620 --> 00:00:57,001
and metrics behind
phishing and phishing kits.

30
00:00:57,002 --> 00:00:58,000
Spoiler alert.

31
00:00:58,000 --> 00:00:59,210
There's not really a lot,

32
00:00:59,210 --> 00:01:01,730
or they're not as
accurate as they could be.

33
00:01:01,730 --> 00:01:02,779
And then lastly,

34
00:01:02,779 --> 00:01:05,300
I'm going to talk about a tool

35
00:01:05,300 --> 00:01:07,649
that me and my company
built called phishpond

36
00:01:07,650 --> 00:01:08,700
to help everybody here

37
00:01:08,700 --> 00:01:11,430
to research and defense against phishing

38
00:01:11,430 --> 00:01:12,980
using this new tool.

39
00:01:12,980 --> 00:01:13,900
So let's get started.

40
00:01:13,900 --> 00:01:14,900
(keyboard clicks)

41
00:01:14,900 --> 00:01:17,193
So, for my apply side,

42
00:01:17,193 --> 00:01:18,690
you know, I wanna make sure

43
00:01:18,690 --> 00:01:20,210
that by the end of this talk,

44
00:01:20,210 --> 00:01:21,199
everyone here should be able

45
00:01:21,200 --> 00:01:22,670
to understand the criminal economy

46
00:01:22,670 --> 00:01:24,380
behind phishing campaigns

47
00:01:24,380 --> 00:01:26,560
and to be able to safely hunt, identify

48
00:01:26,560 --> 00:01:29,630
and reverse-engineer of some
novice-level phishing kits.

49
00:01:29,630 --> 00:01:31,342
So within three months,

50
00:01:32,210 --> 00:01:34,479
if you continue on a
phishing research journey

51
00:01:34,480 --> 00:01:36,800
and I hope everybody here does

52
00:01:36,800 --> 00:01:37,708
because it's a lot of fun

53
00:01:37,708 --> 00:01:40,550
and there's a lot of
different components to it.

54
00:01:40,550 --> 00:01:42,140
You'll be able to safely identify

55
00:01:42,140 --> 00:01:44,040
and reverse-engineer some
advanced phishing kits.

56
00:01:44,040 --> 00:01:45,900
And we'll look at some of those today,

57
00:01:45,900 --> 00:01:47,730
accurately attribute kits to actors

58
00:01:47,730 --> 00:01:50,610
based on some net new
indicators within the kit.

59
00:01:50,610 --> 00:01:53,190
So not really traditional
threat indicators,

60
00:01:53,190 --> 00:01:54,416
something a little bit different.

61
00:01:54,416 --> 00:01:55,369
And then lastly,

62
00:01:55,370 --> 00:01:57,140
share the findings with the
phishing research community

63
00:01:57,140 --> 00:01:58,808
because everybody wants that clout

64
00:01:58,808 --> 00:02:00,639
but it's also because

65
00:02:00,639 --> 00:02:02,670
we really need a lot more data

66
00:02:02,670 --> 00:02:04,290
to help, kind of,

67
00:02:04,290 --> 00:02:06,510
bring all of these different
components together

68
00:02:06,510 --> 00:02:09,958
and understands this ecosystem as a whole.

69
00:02:09,958 --> 00:02:11,232
(keyboard clicks)

70
00:02:11,232 --> 00:02:12,270
So,

71
00:02:12,270 --> 00:02:13,825
The Phishing Kit Ecosystem.

72
00:02:13,825 --> 00:02:16,420
Phishing attacks are way
more than just a website.

73
00:02:16,420 --> 00:02:17,649
And I'll be saying that a lot

74
00:02:17,650 --> 00:02:19,982
throughout the presentation here.

75
00:02:19,982 --> 00:02:22,460
But before we begin, I wanna scope this.

76
00:02:22,460 --> 00:02:24,510
So, throughout this presentation,

77
00:02:24,510 --> 00:02:27,269
I'm gonna be talking about
phishing as it pertains to:

78
00:02:27,270 --> 00:02:29,780
cyber criminals that are doing spam

79
00:02:29,780 --> 00:02:31,270
for the end goal of fraud,

80
00:02:31,270 --> 00:02:32,103
and they do that

81
00:02:32,103 --> 00:02:35,280
by stealing personally
identifiable information

82
00:02:35,280 --> 00:02:36,430
and financial information

83
00:02:36,430 --> 00:02:38,440
via a web server deployed on the internet.

84
00:02:38,440 --> 00:02:40,722
Now, phishing, that's not in scope

85
00:02:40,723 --> 00:02:42,720
but you'll kind of see
phishing go hand-in-hand

86
00:02:42,720 --> 00:02:43,930
with some of these other topics

87
00:02:43,930 --> 00:02:45,260
includes spear phishing,

88
00:02:45,260 --> 00:02:46,381
which you'll see a lot, in like,

89
00:02:46,381 --> 00:02:48,529
APT campaigns and things like that.

90
00:02:48,529 --> 00:02:51,240
Any type of malware or meldock spam,

91
00:02:51,240 --> 00:02:53,136
where it infects the user

92
00:02:53,136 --> 00:02:55,700
using that type of delivery system.

93
00:02:55,700 --> 00:02:58,170
Sometimes you hear people say
phishing along those lines.

94
00:02:58,170 --> 00:02:59,003
And then lastly,

95
00:02:59,003 --> 00:03:00,666
business email compromise

96
00:03:00,666 --> 00:03:02,940
already a very hard topic

97
00:03:02,940 --> 00:03:04,930
to identify and really define.

98
00:03:04,930 --> 00:03:06,560
And I've seen phishing be used

99
00:03:06,560 --> 00:03:08,290
within the context of BEC

100
00:03:08,290 --> 00:03:10,940
but I will not be talking
about BEC during this talk.

101
00:03:12,190 --> 00:03:13,023
So,

102
00:03:13,023 --> 00:03:15,540
for those that are
defenders researchers and,

103
00:03:15,540 --> 00:03:17,670
hey, maybe even attackers too,

104
00:03:17,670 --> 00:03:18,769
you know,

105
00:03:18,770 --> 00:03:21,330
you've probably seen a
URL like this before.

106
00:03:21,330 --> 00:03:22,760
Whether you're responding to a ticket,

107
00:03:22,760 --> 00:03:24,880
or you're building something out,

108
00:03:24,880 --> 00:03:26,530
a WordPress server,

109
00:03:26,530 --> 00:03:28,478
and at the end of that WordPress server,

110
00:03:28,478 --> 00:03:30,410
there's a WP includes folder

111
00:03:30,410 --> 00:03:31,700
with some gibberish afterwards

112
00:03:31,700 --> 00:03:35,186
and then perhaps something
like a brand like ProtonMail.

113
00:03:35,187 --> 00:03:37,400
And I'm gonna pick on them a little bit

114
00:03:37,400 --> 00:03:39,103
but I love ProtonMail.

115
00:03:40,270 --> 00:03:41,560
And...

116
00:03:41,560 --> 00:03:42,393
when you look at this,

117
00:03:42,393 --> 00:03:44,840
you think like why is there,

118
00:03:44,840 --> 00:03:47,830
you know, protonmail and
index.php after this,

119
00:03:47,830 --> 00:03:49,590
it's most likely a phishing page.

120
00:03:49,590 --> 00:03:51,210
And then for the astute

121
00:03:51,210 --> 00:03:53,012
kind of researchers and defenders,

122
00:03:53,012 --> 00:03:55,100
they'll notice that there's
multiple directories

123
00:03:55,100 --> 00:03:56,440
leading to that phishing page.

124
00:03:56,440 --> 00:03:59,030
And so you navigate a directory up,

125
00:03:59,030 --> 00:04:00,280
and sometimes you get this,

126
00:04:00,280 --> 00:04:01,760
which is an open directory.

127
00:04:01,760 --> 00:04:03,660
You'll see the protonmail directory

128
00:04:03,660 --> 00:04:05,440
that can click and go to the phishing site

129
00:04:05,440 --> 00:04:06,900
and then some type of zip file.

130
00:04:06,900 --> 00:04:07,940
Congratulations.

131
00:04:07,940 --> 00:04:09,940
You found a phishing kit.

132
00:04:09,940 --> 00:04:11,430
So it may look something like this.

133
00:04:11,430 --> 00:04:13,200
You can right-click save link as

134
00:04:13,200 --> 00:04:15,040
downloaded locally.

135
00:04:15,040 --> 00:04:16,360
I run seven zip all the time,

136
00:04:16,360 --> 00:04:17,589
so I list the contents here.

137
00:04:17,589 --> 00:04:19,079
And what you see,

138
00:04:19,079 --> 00:04:20,550
and what I have on the screen here

139
00:04:20,550 --> 00:04:22,284
is a collection of PHP files,

140
00:04:22,284 --> 00:04:23,159
HTML,

141
00:04:23,159 --> 00:04:25,137
assets like JavaScript,

142
00:04:25,137 --> 00:04:26,240
CSS,

143
00:04:26,240 --> 00:04:27,343
maybe some pictures

144
00:04:27,343 --> 00:04:30,307
and then maybe some TXT
files in there as well.

145
00:04:30,307 --> 00:04:31,627
This is a phishing kit,

146
00:04:31,627 --> 00:04:32,890
and this is what phishpond

147
00:04:32,890 --> 00:04:34,702
is going to help everyone here analyze

148
00:04:34,702 --> 00:04:37,165
in a lot more streamlined fashion.

149
00:04:37,165 --> 00:04:38,330
So,

150
00:04:38,330 --> 00:04:40,510
a phishing kit really is
just pre-constructed code

151
00:04:40,510 --> 00:04:43,250
which allows quick
deployment of phishing sites.

152
00:04:43,250 --> 00:04:44,960
It's that zip file.

153
00:04:44,960 --> 00:04:46,575
They're sold and traded online,

154
00:04:46,575 --> 00:04:50,460
and there's actually some
tiers related to phishing kits.

155
00:04:50,460 --> 00:04:51,750
There's some lower tiered stuff,

156
00:04:51,750 --> 00:04:53,030
that's not that advanced.

157
00:04:53,030 --> 00:04:54,479
And there's some higher priced kits

158
00:04:54,480 --> 00:04:55,910
that are very modular.

159
00:04:55,910 --> 00:04:56,834
They have APIs,

160
00:04:56,834 --> 00:04:59,890
they have different ways
to exfiltrate stolen data,

161
00:04:59,890 --> 00:05:01,890
and some of them even have
digital rights management

162
00:05:01,890 --> 00:05:04,491
and licensing attached to them.

163
00:05:04,492 --> 00:05:06,257
And they are very popular

164
00:05:06,257 --> 00:05:07,720
because there's potentially

165
00:05:07,720 --> 00:05:09,700
high return on investment
for threat actors.

166
00:05:09,700 --> 00:05:12,174
This allows people to
quickly stand this stuff up

167
00:05:12,174 --> 00:05:14,549
without really knowing what's going on

168
00:05:14,550 --> 00:05:15,420
because all they care about

169
00:05:15,420 --> 00:05:16,780
is getting it on a server,

170
00:05:16,780 --> 00:05:17,919
sending something out,

171
00:05:17,920 --> 00:05:18,914
and then reaping the benefits

172
00:05:18,914 --> 00:05:20,462
from that phishing attack.

173
00:05:21,580 --> 00:05:22,450
So,

174
00:05:22,450 --> 00:05:23,818
my company's been doing

175
00:05:23,818 --> 00:05:26,256
phishing research for quite some time and,

176
00:05:26,256 --> 00:05:28,818
you know, whatever, we're
looking at a threat actor

177
00:05:28,818 --> 00:05:30,400
or a group of people doing this.

178
00:05:30,400 --> 00:05:32,299
They tend to fall into a couple of buckets

179
00:05:32,300 --> 00:05:33,680
which I have listed here,

180
00:05:33,680 --> 00:05:35,403
the operator, the developer,

181
00:05:35,403 --> 00:05:39,004
an infrastructure broker,
and an illicit market.

182
00:05:39,004 --> 00:05:39,837
And so,

183
00:05:39,837 --> 00:05:43,000
it could be any combination
of these types of personas

184
00:05:43,000 --> 00:05:44,590
but the basic premise behind all this

185
00:05:44,590 --> 00:05:47,400
is everyone's in the
phishing game to make money

186
00:05:47,400 --> 00:05:48,676
if they're in it to do fraud.

187
00:05:48,677 --> 00:05:50,770
And so the operator,

188
00:05:50,770 --> 00:05:52,621
they purchase the kit from a developer,

189
00:05:52,622 --> 00:05:55,320
they obtain different
ways to spam that kit out,

190
00:05:55,320 --> 00:05:56,153
they deploy it,

191
00:05:56,153 --> 00:05:57,280
and then they reap the benefits.

192
00:05:57,280 --> 00:05:58,441
Developer builds the kit,

193
00:05:58,442 --> 00:05:59,560
host it,

194
00:05:59,560 --> 00:06:00,750
takes feature requests,

195
00:06:00,750 --> 00:06:02,819
which I'll show a little bit

196
00:06:02,819 --> 00:06:04,698
in a slide coming up here,

197
00:06:04,698 --> 00:06:06,869
and they keep improving it

198
00:06:06,869 --> 00:06:08,720
so more operators buy it.

199
00:06:08,720 --> 00:06:10,220
There's infrastructure brokers

200
00:06:10,220 --> 00:06:12,460
that basically obtain infrastructure

201
00:06:12,460 --> 00:06:13,774
to perform some type of spam.

202
00:06:13,774 --> 00:06:15,080
They'll do this illicitly

203
00:06:15,080 --> 00:06:16,669
through carting, through fraud,

204
00:06:16,670 --> 00:06:18,620
or in that WordPress example,

205
00:06:18,620 --> 00:06:20,516
through compromise, and then a market.

206
00:06:20,516 --> 00:06:22,290
And this market doesn't have to be

207
00:06:22,290 --> 00:06:24,476
on the dark web or some secret crazy place

208
00:06:24,476 --> 00:06:26,970
that you have to go and
know a secret handshake.

209
00:06:26,970 --> 00:06:28,100
This could be on the internet,

210
00:06:28,100 --> 00:06:29,610
this can be on social media,

211
00:06:29,610 --> 00:06:31,550
this can be on WhatsApp or Telegram.

212
00:06:31,550 --> 00:06:32,870
All of these things together

213
00:06:32,870 --> 00:06:35,640
are basically the ecosystem of fraud

214
00:06:35,640 --> 00:06:36,885
when it comes to phishing kits.

215
00:06:36,885 --> 00:06:37,718
(keyboard clicks)

216
00:06:37,718 --> 00:06:40,470
So I want to talk a little bit about

217
00:06:40,470 --> 00:06:42,280
what it takes to make a phishing campaign.

218
00:06:42,280 --> 00:06:44,547
And so I'm gonna zoom
in here on the operator.

219
00:06:44,548 --> 00:06:45,663
Basically,

220
00:06:45,663 --> 00:06:48,670
this is gonna complete
something called a flywheel,

221
00:06:48,670 --> 00:06:50,100
and it's gonna go in a circle here

222
00:06:50,100 --> 00:06:52,000
because the more the operator does this,

223
00:06:52,000 --> 00:06:53,364
the better they get.

224
00:06:53,364 --> 00:06:56,811
So I'll step through each portion here.

225
00:06:56,812 --> 00:06:59,008
So the operator first identifies a place

226
00:06:59,008 --> 00:07:02,430
they can go in and buy or
sell financial information

227
00:07:02,430 --> 00:07:05,142
or personally identifiable information.

228
00:07:05,142 --> 00:07:06,840
So that's a really important step,

229
00:07:06,840 --> 00:07:07,810
is just go to a place

230
00:07:07,810 --> 00:07:10,140
and see where this is being sold.

231
00:07:10,140 --> 00:07:11,943
Once they figure out what's being sold,

232
00:07:11,943 --> 00:07:13,460
they'll buy a phishing kit.

233
00:07:13,460 --> 00:07:15,729
They'll also buy, perhaps,
some infrastructure,

234
00:07:15,730 --> 00:07:18,094
some lists to spam
emails or phone numbers.

235
00:07:18,094 --> 00:07:19,790
They'll buy something called a "Letter"

236
00:07:19,790 --> 00:07:22,379
which is basically a
pre-packaged piece of HTML

237
00:07:22,379 --> 00:07:23,717
that is...

238
00:07:23,717 --> 00:07:24,550
"guaranteed"

239
00:07:24,550 --> 00:07:27,230
to get past the spam filter on the email.

240
00:07:27,230 --> 00:07:28,460
Sometimes they don't work,

241
00:07:28,460 --> 00:07:29,604
most of the time they do.

242
00:07:29,605 --> 00:07:30,438
(keyboard clicks)

243
00:07:30,438 --> 00:07:31,700
Once all those purchases are done,

244
00:07:31,700 --> 00:07:32,990
they then deploy the kit

245
00:07:32,990 --> 00:07:34,840
to get the virtual private server,

246
00:07:34,840 --> 00:07:36,310
when they get on that VPS,

247
00:07:36,310 --> 00:07:37,510
they install a web server

248
00:07:37,510 --> 00:07:39,190
and a LAMPstack with PHP

249
00:07:39,190 --> 00:07:40,104
and they take that zip file

250
00:07:40,104 --> 00:07:41,690
and they copy it on there.

251
00:07:41,690 --> 00:07:43,870
And that's where we can
get that really juicy intel

252
00:07:43,870 --> 00:07:44,890
and that juicy phish kit

253
00:07:44,890 --> 00:07:47,599
is when they copy it and
they forget about it.

254
00:07:47,600 --> 00:07:49,820
So once they copy it
over and they extract it,

255
00:07:49,820 --> 00:07:51,540
they have a payload that they build,

256
00:07:51,540 --> 00:07:52,930
either through this letter template

257
00:07:52,930 --> 00:07:55,940
or through some type
of SMS spamming service

258
00:07:55,940 --> 00:07:58,390
where they can text out the phishing link.

259
00:07:58,390 --> 00:07:59,753
They initiate the campaign.

260
00:07:59,754 --> 00:08:01,520
So they'll press a button,

261
00:08:01,520 --> 00:08:04,318
and basically emails and
text messages go out,

262
00:08:04,319 --> 00:08:05,601
victims get it,

263
00:08:05,601 --> 00:08:08,090
victims navigate to the phishing website.

264
00:08:08,090 --> 00:08:08,984
The kit

265
00:08:08,984 --> 00:08:10,109
is really good at blocking

266
00:08:10,109 --> 00:08:12,840
any type of automated
and security scanners.

267
00:08:12,840 --> 00:08:14,700
And then the victim starts
filling in the data.

268
00:08:14,700 --> 00:08:16,409
And the last part

269
00:08:16,410 --> 00:08:18,260
is the operator collects the loop.

270
00:08:18,260 --> 00:08:20,280
This can be done through a
number of different ways,

271
00:08:20,280 --> 00:08:21,590
which I'll show in my demo,

272
00:08:21,590 --> 00:08:24,739
and they can take that information

273
00:08:24,740 --> 00:08:27,160
and put it somewhere
so they can retrieve it

274
00:08:27,160 --> 00:08:28,350
and then go and list it

275
00:08:28,350 --> 00:08:30,763
within the identify
step that you see here.

276
00:08:30,763 --> 00:08:32,140
(keyboard clicks)

277
00:08:32,140 --> 00:08:32,990
So it's really important

278
00:08:32,990 --> 00:08:34,985
when you're looking at
any type of phishing page

279
00:08:34,985 --> 00:08:36,789
or you're doing phishing kit research

280
00:08:36,789 --> 00:08:37,622
that you look at

281
00:08:37,623 --> 00:08:38,721
what we like to call it at ZeroFOX,

282
00:08:38,721 --> 00:08:39,787
the victim workflow.

283
00:08:39,787 --> 00:08:40,780
It's basically,

284
00:08:40,780 --> 00:08:43,302
the user experience of the phishing kits.

285
00:08:43,302 --> 00:08:45,400
So if I've plop two things right here,

286
00:08:45,400 --> 00:08:47,290
this is a cash app, on the left,

287
00:08:47,290 --> 00:08:49,420
and then a phishing kit targeting cash app

288
00:08:49,420 --> 00:08:50,420
on the right.

289
00:08:50,420 --> 00:08:52,079
Really, without access to the domain

290
00:08:52,080 --> 00:08:52,913
or the source code,

291
00:08:52,913 --> 00:08:54,248
if you're not that good at analyzing this,

292
00:08:54,248 --> 00:08:56,495
it's really hard to tell the
difference between the two.

293
00:08:56,495 --> 00:08:58,160
That's because these operator

294
00:08:58,160 --> 00:08:59,848
or these developers, rather,

295
00:08:59,848 --> 00:09:01,295
they spend a lot of time

296
00:09:01,296 --> 00:09:03,114
to make sure this looks exactly

297
00:09:03,114 --> 00:09:05,980
like the brand that they are targeting.

298
00:09:05,980 --> 00:09:08,080
And then each page is uniquely built,

299
00:09:08,080 --> 00:09:09,740
so they can take the right information

300
00:09:09,740 --> 00:09:10,940
based on that brand.

301
00:09:10,940 --> 00:09:12,641
So we have the cache pin on left here,

302
00:09:12,641 --> 00:09:14,010
we're getting the email

303
00:09:14,010 --> 00:09:15,877
and the email password on the right.

304
00:09:15,877 --> 00:09:18,030
And then this is where
it gets interesting,

305
00:09:18,030 --> 00:09:19,459
a phishing page is usually

306
00:09:19,460 --> 00:09:20,960
a username and password, right?

307
00:09:20,960 --> 00:09:21,793
Well,

308
00:09:21,793 --> 00:09:24,420
a lot of these pages
and a lot of these kits,

309
00:09:24,420 --> 00:09:25,760
they start to take a lot more

310
00:09:25,760 --> 00:09:27,180
than just usernames and passwords.

311
00:09:27,180 --> 00:09:28,790
On the left, you'll see a lot of PII,

312
00:09:28,790 --> 00:09:30,089
which includes everything

313
00:09:30,090 --> 00:09:31,790
from your name, address,

314
00:09:31,790 --> 00:09:33,209
and your social security number.

315
00:09:33,209 --> 00:09:34,459
And then on the right,

316
00:09:34,460 --> 00:09:36,193
includes your debit card, credit card,

317
00:09:36,193 --> 00:09:38,680
routing and bank account number.

318
00:09:38,680 --> 00:09:40,630
This is a lot different
than what I was taught,

319
00:09:40,630 --> 00:09:42,265
initially, with phishing.

320
00:09:42,265 --> 00:09:43,830
This begins to, kind of,

321
00:09:43,830 --> 00:09:45,220
build up something more and more

322
00:09:45,220 --> 00:09:46,850
into what's called a profile.

323
00:09:46,850 --> 00:09:49,360
So a profile or a pro is what you'll see

324
00:09:49,360 --> 00:09:50,860
some of these actors talk about

325
00:09:50,860 --> 00:09:52,826
when they have a really good package

326
00:09:52,826 --> 00:09:56,384
of this PII, FI, that
they can sell to somebody

327
00:09:56,384 --> 00:09:59,490
so they can go and use that fraudulently.

328
00:09:59,490 --> 00:10:00,750
So,

329
00:10:00,750 --> 00:10:01,960
really, we do you need to educate

330
00:10:01,960 --> 00:10:03,860
security practitioners and researchers

331
00:10:03,860 --> 00:10:05,290
that phishing is not always just

332
00:10:05,290 --> 00:10:08,978
equaling to usernames and passwords.

333
00:10:08,979 --> 00:10:11,781
These are pre-packed identity,
compromised toolkits.

334
00:10:11,781 --> 00:10:13,870
And so for example, you see here,

335
00:10:13,870 --> 00:10:16,741
the last portion of this phishing page,

336
00:10:16,741 --> 00:10:19,170
it asks you to upload
your driver's license.

337
00:10:19,170 --> 00:10:20,449
That whole package

338
00:10:20,450 --> 00:10:22,068
is a really good thing to have.

339
00:10:22,068 --> 00:10:23,890
If you need to beat

340
00:10:23,890 --> 00:10:24,723
KYC

341
00:10:24,723 --> 00:10:26,609
or Know Your Customer protections

342
00:10:26,610 --> 00:10:28,610
at a bank, on a credit card website,

343
00:10:28,610 --> 00:10:29,660
or things like that.

344
00:10:29,660 --> 00:10:32,339
So this is a lot of
information that you can get

345
00:10:32,340 --> 00:10:34,910
and it's really useful to basically

346
00:10:34,910 --> 00:10:37,218
compromise somebody's
financial livelihood.

347
00:10:37,219 --> 00:10:38,052
(keyboard clicks)

348
00:10:38,052 --> 00:10:38,885
Now,

349
00:10:39,800 --> 00:10:42,719
I'm not saying that all
phishing pages are this.

350
00:10:42,720 --> 00:10:43,960
I'm not saying all phishing, you know,

351
00:10:43,960 --> 00:10:46,020
some phishing pages are
username and password.

352
00:10:46,020 --> 00:10:47,600
I'm saying there's a spectrum here.

353
00:10:47,600 --> 00:10:49,719
So basically what I'm showing here

354
00:10:49,719 --> 00:10:51,228
is a Shoppy profile

355
00:10:51,228 --> 00:10:55,202
of somebody who sells
usernames and passwords

356
00:10:55,202 --> 00:10:57,946
for Nando's PERi-PERi,
the chicken restaurant,

357
00:10:57,946 --> 00:10:59,754
and for 5 to 10 dollars,

358
00:10:59,754 --> 00:11:02,810
you can purchase a username
and password from this person,

359
00:11:02,810 --> 00:11:04,750
log in to Nando's PERi-PERi,

360
00:11:04,750 --> 00:11:06,480
and they'll give you
instructions to, say like,

361
00:11:06,480 --> 00:11:08,300
here's how you go and order a lot of food

362
00:11:08,300 --> 00:11:10,376
with this $10 credential I just sold you.

363
00:11:10,376 --> 00:11:11,209
So,

364
00:11:11,209 --> 00:11:12,449
I can spend $10

365
00:11:12,450 --> 00:11:14,410
to get a hundred dollars worth of food.

366
00:11:14,410 --> 00:11:16,089
This might be really attractive for people

367
00:11:16,089 --> 00:11:19,360
and they have over 2000 purchases here.

368
00:11:19,360 --> 00:11:21,582
2200 of them are very positive.

369
00:11:21,582 --> 00:11:22,660
So,

370
00:11:22,660 --> 00:11:25,429
it really depends on the threat
model of the organization.

371
00:11:25,429 --> 00:11:27,199
It really depends on the brands

372
00:11:27,200 --> 00:11:28,540
and what you can get from it.

373
00:11:28,540 --> 00:11:30,370
And it really just depends alsoon

374
00:11:30,370 --> 00:11:33,485
where people are using
this, and kind of like the

375
00:11:33,485 --> 00:11:35,990
almost the life circumstances

376
00:11:35,990 --> 00:11:37,790
of the people within that region.

377
00:11:37,790 --> 00:11:39,719
So it's a very complicated subject.

378
00:11:39,720 --> 00:11:40,580
And you know,

379
00:11:40,580 --> 00:11:42,410
this is not something
we've really talked about

380
00:11:42,410 --> 00:11:44,520
or I've seen people talk about enough

381
00:11:44,520 --> 00:11:45,797
within the security research community.

382
00:11:45,797 --> 00:11:46,981
(keyboard clicks)

383
00:11:46,981 --> 00:11:48,960
So, now everyone here

384
00:11:48,960 --> 00:11:50,580
is totally an expert on phishing kits.

385
00:11:50,580 --> 00:11:52,873
I'm gonna go and look at
a specific threat actor

386
00:11:52,873 --> 00:11:54,721
called 16Shop.

387
00:11:54,721 --> 00:11:57,025
And the interesting thing about this

388
00:11:57,025 --> 00:11:58,477
and I want everyone to take away

389
00:11:58,477 --> 00:12:00,408
is to kind of understand that

390
00:12:00,408 --> 00:12:03,130
geopolitics is a very important part

391
00:12:03,130 --> 00:12:05,560
of any type of fraud research.

392
00:12:05,560 --> 00:12:08,550
And you know, when looking at this kit

393
00:12:08,550 --> 00:12:10,443
you can't really look away from

394
00:12:10,443 --> 00:12:12,670
how some of fraud

395
00:12:12,670 --> 00:12:15,236
within this area of the world came to be.

396
00:12:15,236 --> 00:12:17,750
So really how some of
the fraud in this area

397
00:12:17,750 --> 00:12:19,022
the world came to be,

398
00:12:19,022 --> 00:12:21,350
was that there was a very notable person

399
00:12:21,350 --> 00:12:23,680
called the Bali Bomber in Indonesia.

400
00:12:23,680 --> 00:12:26,739
And they wrote a book
after they were caught

401
00:12:26,740 --> 00:12:27,760
called "Hacking, Why Not?"

402
00:12:27,760 --> 00:12:28,890
and within the book,

403
00:12:28,890 --> 00:12:32,380
they basically urged Muslim radicals

404
00:12:32,380 --> 00:12:34,340
to engage in a holy war in cyberspace

405
00:12:34,340 --> 00:12:35,173
by doing what?

406
00:12:35,173 --> 00:12:36,890
Performing credit card fraud.

407
00:12:36,890 --> 00:12:38,304
And so within that chapter,

408
00:12:38,304 --> 00:12:39,968
you see a lot of different methods

409
00:12:39,969 --> 00:12:41,507
to perform that credit card fraud.

410
00:12:41,507 --> 00:12:43,729
And to basically

411
00:12:43,730 --> 00:12:46,260
use this as a way to attack the US.

412
00:12:46,260 --> 00:12:47,093
So,

413
00:12:47,093 --> 00:12:48,421
years and years later,

414
00:12:48,422 --> 00:12:50,090
a bunch of phishing kits

415
00:12:50,090 --> 00:12:53,634
and groups started to
emerge from Indonesia.

416
00:12:53,634 --> 00:12:54,750
And in my opinion,

417
00:12:54,750 --> 00:12:57,720
16Shop is kind of like
the king of all of them,

418
00:12:57,720 --> 00:12:59,136
it's the biggest that we've seen.

419
00:12:59,136 --> 00:13:00,824
And one person

420
00:13:00,825 --> 00:13:03,240
has been attributed to running it

421
00:13:03,240 --> 00:13:04,961
and their moniker's DevilScreaM.

422
00:13:04,961 --> 00:13:08,360
And this was first
attributed in 2018 by Akamai.

423
00:13:08,360 --> 00:13:10,200
And this person's been around a lot

424
00:13:10,200 --> 00:13:12,830
like within the Zone-h defacing scene.

425
00:13:12,830 --> 00:13:14,440
And it was really hard

426
00:13:14,440 --> 00:13:16,813
not to attribute to DevilScreaM

427
00:13:16,813 --> 00:13:19,569
because DevilScreaM
not only put their name

428
00:13:19,570 --> 00:13:21,186
inside the phishing kits and signed it,

429
00:13:21,186 --> 00:13:23,610
he put in where did they can go

430
00:13:23,610 --> 00:13:25,830
if you find this kit and you can buy more,

431
00:13:25,830 --> 00:13:27,068
he also put in his real name.

432
00:13:27,068 --> 00:13:29,581
So it just kind of goes to show,

433
00:13:29,581 --> 00:13:31,047
you know,

434
00:13:31,047 --> 00:13:32,222
this is an enterprise

435
00:13:32,222 --> 00:13:34,069
and people and his developers

436
00:13:34,070 --> 00:13:35,030
need to sell these things.

437
00:13:35,030 --> 00:13:36,520
So they have to market themselves.

438
00:13:36,520 --> 00:13:38,365
Now, whether that's an
operational security faux pas,

439
00:13:38,365 --> 00:13:39,620
I do not know,

440
00:13:39,620 --> 00:13:41,330
but it was definitely effective

441
00:13:41,330 --> 00:13:43,103
in terms of making it popular.

442
00:13:44,270 --> 00:13:45,130
So,

443
00:13:45,130 --> 00:13:46,505
when you go to 16Shop,

444
00:13:46,505 --> 00:13:48,110
it's not on the dark web,

445
00:13:48,110 --> 00:13:50,007
you don't have to know Indonesian,

446
00:13:50,007 --> 00:13:53,319
you don't have to know a secret handshake

447
00:13:53,320 --> 00:13:54,460
it's on the open web.

448
00:13:54,460 --> 00:13:56,090
And if you know what the URL is

449
00:13:56,090 --> 00:13:57,828
you can go and register a free account

450
00:13:57,828 --> 00:13:59,449
and start buying phishing kits

451
00:13:59,450 --> 00:14:01,200
related to the brands below.

452
00:14:01,200 --> 00:14:03,142
So once you register a you login,

453
00:14:03,142 --> 00:14:04,660
you'll see that it's set up

454
00:14:04,660 --> 00:14:06,020
almost like a SAS product.

455
00:14:06,020 --> 00:14:07,710
It's very, very easy to kind of look at

456
00:14:07,710 --> 00:14:08,807
and understand like,

457
00:14:08,807 --> 00:14:10,238
where can I buy these things?

458
00:14:10,238 --> 00:14:12,294
Where can I get a guide?

459
00:14:12,294 --> 00:14:13,319
You know,

460
00:14:13,320 --> 00:14:15,850
it even has a support
portal at the bottom.

461
00:14:15,850 --> 00:14:16,683
Now, one thing you'll see

462
00:14:16,683 --> 00:14:19,242
with a lot of these
phishing kit researchers

463
00:14:19,243 --> 00:14:21,175
or phishing kit actors, rather,

464
00:14:21,175 --> 00:14:22,500
is that they don't call them kits.

465
00:14:22,500 --> 00:14:24,520
They call them scams or scam pages.

466
00:14:24,520 --> 00:14:25,870
So what you see here,

467
00:14:25,870 --> 00:14:27,827
is a way to buy an Apple scam page

468
00:14:27,827 --> 00:14:30,080
for about 70 us dollars.

469
00:14:30,080 --> 00:14:31,649
And you could pay them in cryptocurrency,

470
00:14:31,649 --> 00:14:33,570
or if you're in Indonesia,

471
00:14:33,570 --> 00:14:35,680
you could just do a
direct bank wire transfer

472
00:14:35,680 --> 00:14:37,069
to DevilScreaM's bank account,

473
00:14:37,070 --> 00:14:38,707
which I thought was pretty funny.

474
00:14:38,707 --> 00:14:39,790
(keyboard clicks)

475
00:14:39,790 --> 00:14:41,089
They have a user guide

476
00:14:41,090 --> 00:14:43,960
so you can see ways that you can upload

477
00:14:43,960 --> 00:14:46,020
that zip file to your
hosting and file manager,

478
00:14:46,020 --> 00:14:46,895
as you can see here.

479
00:14:46,895 --> 00:14:48,249
It shows what happens

480
00:14:48,249 --> 00:14:49,436
if there's any errors

481
00:14:49,436 --> 00:14:51,539
that happen in this particular case,

482
00:14:51,539 --> 00:14:55,313
not only do you buy the license for Apple,

483
00:14:55,313 --> 00:14:57,334
you only get three domains

484
00:14:57,334 --> 00:14:59,281
you can host that Apple kit at a time.

485
00:14:59,282 --> 00:15:01,900
16Shop is set up almost like an API

486
00:15:01,900 --> 00:15:04,050
where you won't actually see a lot

487
00:15:04,050 --> 00:15:06,286
of the phishing pages
within the kit itself.

488
00:15:06,287 --> 00:15:08,045
The API server feeds it back

489
00:15:08,045 --> 00:15:09,775
to these pages in real time,

490
00:15:09,775 --> 00:15:11,449
as people visit them.

491
00:15:11,450 --> 00:15:12,988
So it's a pretty unique setup here.

492
00:15:12,988 --> 00:15:13,871
(keyboard clicks)

493
00:15:13,871 --> 00:15:15,760
Once the page is set up,

494
00:15:15,760 --> 00:15:17,259
it'll show you how to log into your page

495
00:15:17,259 --> 00:15:18,740
by going to /admin.

496
00:15:18,740 --> 00:15:20,280
So this is a very interesting thing,

497
00:15:20,280 --> 00:15:21,230
if you're doing research,

498
00:15:21,230 --> 00:15:22,410
if you go to /admin,

499
00:15:22,410 --> 00:15:23,800
and you see a 16Shop logo,

500
00:15:23,800 --> 00:15:25,892
it's most likely a 16Shop phishing page.

501
00:15:25,893 --> 00:15:27,735
And then when you do log in,

502
00:15:27,735 --> 00:15:29,222
you'll get a nice pretty dashboard

503
00:15:29,222 --> 00:15:30,586
of all the different metrics,

504
00:15:30,586 --> 00:15:32,810
and all the different victims,

505
00:15:32,810 --> 00:15:34,130
and driver's license you found,

506
00:15:34,130 --> 00:15:36,530
you can configure your
phishing kit in here.

507
00:15:36,530 --> 00:15:38,699
So, it's very

508
00:15:38,700 --> 00:15:39,533
well built.

509
00:15:39,533 --> 00:15:41,140
and it's just something

510
00:15:41,140 --> 00:15:42,710
that is interesting to study

511
00:15:42,710 --> 00:15:44,780
because it's just so advanced.

512
00:15:44,780 --> 00:15:46,126
It has DRM,

513
00:15:46,126 --> 00:15:50,079
it has the setup with
dashboards and things like that

514
00:15:50,080 --> 00:15:51,440
and it has user guides.

515
00:15:51,440 --> 00:15:54,370
So, definitely something
to consider more and more

516
00:15:54,370 --> 00:15:55,203
when you're going out

517
00:15:55,203 --> 00:15:57,470
and you're looking at these things.

518
00:15:57,470 --> 00:16:00,667
Now, in terms of the impact,

519
00:16:00,667 --> 00:16:04,476
16Shop is a pretty crazy operation.

520
00:16:04,476 --> 00:16:07,407
URL scan identified around 8,000 16Shop

521
00:16:07,407 --> 00:16:09,012
websites in 2020.

522
00:16:09,012 --> 00:16:11,672
Neonprimetime, we'll talk
about in a little bit,

523
00:16:11,673 --> 00:16:14,727
has pulled 1,200-ish zip files

524
00:16:14,727 --> 00:16:17,130
that are 16Shop within 2020.

525
00:16:17,130 --> 00:16:18,060
So not just the site,

526
00:16:18,060 --> 00:16:19,719
but they found a zip file within there.

527
00:16:19,720 --> 00:16:22,130
And then just in the
last three months alone,

528
00:16:22,130 --> 00:16:24,737
my company has collected
over 3000 of these

529
00:16:24,737 --> 00:16:26,305
16Shop zip files.

530
00:16:26,306 --> 00:16:28,170
And then just last year,

531
00:16:28,170 --> 00:16:29,270
we're talking about

532
00:16:29,270 --> 00:16:31,130
like close to 100,000 different domains

533
00:16:31,130 --> 00:16:32,100
that we've tracked.

534
00:16:32,100 --> 00:16:35,580
So it's pretty crazy
in terms of the amount

535
00:16:35,580 --> 00:16:39,824
and the impact that these
different sites have.

536
00:16:39,824 --> 00:16:41,060
Great.

537
00:16:41,060 --> 00:16:43,910
So now that everyone here is
an expert in phishing kits;

538
00:16:43,910 --> 00:16:45,491
we talked about one threat actor;

539
00:16:45,491 --> 00:16:47,269
the question then becomes,

540
00:16:47,269 --> 00:16:49,480
well how many more are there out there

541
00:16:49,480 --> 00:16:51,121
and how can we track them?

542
00:16:51,121 --> 00:16:53,370
And what brands do they affect

543
00:16:53,370 --> 00:16:55,030
and how effective are they?

544
00:16:55,030 --> 00:16:57,010
I'm about to disappoint
people here a little bit,

545
00:16:57,010 --> 00:16:59,260
there's not a lot of good data on this.

546
00:16:59,260 --> 00:17:01,270
So for those that don't know,

547
00:17:01,270 --> 00:17:02,280
the Anti-Phishing Work Group

548
00:17:02,280 --> 00:17:04,629
is a fantastic place to go

549
00:17:04,630 --> 00:17:06,288
for this type of phishing data.

550
00:17:06,288 --> 00:17:08,259
People submit phishing URLs and domains

551
00:17:08,259 --> 00:17:10,160
and emails and things like that

552
00:17:10,160 --> 00:17:11,740
to the Anti-Phishing Work Group.

553
00:17:11,740 --> 00:17:13,130
And they track it by brands,

554
00:17:13,130 --> 00:17:14,506
and then track it by sites.

555
00:17:14,506 --> 00:17:15,680
And you can kind of see

556
00:17:15,680 --> 00:17:17,492
their 2020 phishing activity here.

557
00:17:17,492 --> 00:17:19,050
There's initial dip in March

558
00:17:19,050 --> 00:17:20,839
and then started to go up and up and up

559
00:17:20,839 --> 00:17:21,673
throughout the year.

560
00:17:21,673 --> 00:17:24,035
So, you know, hundreds
of thousands per quarters

561
00:17:24,035 --> 00:17:25,622
basically what they've tracked,

562
00:17:25,622 --> 00:17:28,339
but no data on any zip files or kits

563
00:17:28,339 --> 00:17:30,399
or who was behind any of this.

564
00:17:30,400 --> 00:17:31,290
Next,

565
00:17:31,290 --> 00:17:32,182
urlscan,

566
00:17:32,182 --> 00:17:34,100
and if you don't know what urlscan is

567
00:17:34,100 --> 00:17:35,629
everyone needs to go check it out.

568
00:17:35,630 --> 00:17:36,790
It's a really awesome tool

569
00:17:36,790 --> 00:17:39,176
to do phishing research and it's free.

570
00:17:39,176 --> 00:17:40,626
You can...

571
00:17:40,626 --> 00:17:41,720
go there

572
00:17:41,720 --> 00:17:43,110
and get some stats

573
00:17:43,110 --> 00:17:44,679
related to these phishing domains

574
00:17:44,680 --> 00:17:45,890
and phishing URLs.

575
00:17:45,890 --> 00:17:47,739
So they sent me over some things,

576
00:17:47,739 --> 00:17:50,464
in terms of the amount of domains and URLs

577
00:17:50,464 --> 00:17:52,040
that they've classified.

578
00:17:52,040 --> 00:17:53,350
And so it's about over

579
00:17:53,350 --> 00:17:55,090
like right around a million

580
00:17:55,090 --> 00:17:57,497
phishing URLs that they
classified last year.

581
00:17:57,498 --> 00:17:59,070
But the really cool thing was

582
00:17:59,070 --> 00:18:01,580
they also put in a
number of unique brands.

583
00:18:01,580 --> 00:18:03,483
Anti-phishing work group had that as well.

584
00:18:03,483 --> 00:18:06,120
So at least we have
some type of brand data

585
00:18:06,120 --> 00:18:07,390
to measure impact here.

586
00:18:07,391 --> 00:18:09,041
(keyboard clicks)

587
00:18:09,041 --> 00:18:10,865
But the question really is here is

588
00:18:10,865 --> 00:18:12,050
what about kits?

589
00:18:12,050 --> 00:18:12,883
What about those zip files

590
00:18:12,883 --> 00:18:14,260
in that one open directory?

591
00:18:14,260 --> 00:18:16,020
Do we have anything on that?

592
00:18:16,020 --> 00:18:16,980
And there's not much.

593
00:18:16,980 --> 00:18:19,200
So neonprimetime, if you
don't know who that is,

594
00:18:19,200 --> 00:18:21,340
great researcher, go give
them a follow on Twitter.

595
00:18:21,340 --> 00:18:23,260
They run a open source project

596
00:18:23,260 --> 00:18:24,560
called the PhishKitTracker,

597
00:18:24,560 --> 00:18:26,419
which you can see here on GitHub.

598
00:18:26,420 --> 00:18:27,600
And they've collected

599
00:18:27,600 --> 00:18:29,904
about 2,000 phishing kits total

600
00:18:29,904 --> 00:18:32,850
across GitHub VirusTotal
on Twitter in 2020.

601
00:18:32,850 --> 00:18:35,753
And only 3% of those had
brand classification.

602
00:18:35,753 --> 00:18:38,360
So we had a bunch of phishing kits

603
00:18:38,360 --> 00:18:39,721
but they're not classified

604
00:18:39,721 --> 00:18:41,650
in terms of which brand
that they were affected.

605
00:18:41,650 --> 00:18:43,269
So we have the opposite problem now.

606
00:18:43,269 --> 00:18:45,440
And of all the phishing kits they got,

607
00:18:45,440 --> 00:18:47,008
they did some threat actor tracking

608
00:18:47,008 --> 00:18:48,287
and campaign tracking.

609
00:18:48,287 --> 00:18:51,030
And then the majority of them were 16Shop,

610
00:18:51,030 --> 00:18:52,300
as you can see on the right here,

611
00:18:52,300 --> 00:18:54,360
and then a lot of them
just weren't labeled.

612
00:18:54,360 --> 00:18:56,924
So it's still a very fuzzy area

613
00:18:56,924 --> 00:18:58,374
in terms of,

614
00:18:58,374 --> 00:19:00,442
you know, tracking these
different campaigns.

615
00:19:00,442 --> 00:19:01,510
And funny enough,

616
00:19:01,510 --> 00:19:02,560
if you look on the right,

617
00:19:02,560 --> 00:19:03,393
Freaksbrothers,

618
00:19:03,393 --> 00:19:04,226
HijaIyh,

619
00:19:04,226 --> 00:19:05,150
YoungSister,

620
00:19:05,150 --> 00:19:07,500
all of those are also
Indonesian-based phishing kits.

621
00:19:07,500 --> 00:19:09,700
So starting to see a pattern here

622
00:19:09,700 --> 00:19:11,057
in terms of some of these actors.

623
00:19:11,057 --> 00:19:12,430
(keyboard clicks)

624
00:19:12,430 --> 00:19:15,527
So, in terms of the open source need

625
00:19:15,527 --> 00:19:18,735
and the need just for
more research around this,

626
00:19:18,735 --> 00:19:20,003
I took a stab of, you know,

627
00:19:20,003 --> 00:19:22,788
three things that we need to improve upon

628
00:19:22,788 --> 00:19:23,930
as a community.

629
00:19:23,930 --> 00:19:26,393
We need to be better
at identifying new kits

630
00:19:26,393 --> 00:19:29,114
and we need to be able to identify

631
00:19:29,114 --> 00:19:31,970
changes in TTPs and
anti-analysis capabilities

632
00:19:31,970 --> 00:19:33,600
within these phishing pages.

633
00:19:33,600 --> 00:19:36,263
There's a lot of work
that goes into preventing

634
00:19:36,263 --> 00:19:38,770
researchers and automated scanners

635
00:19:38,770 --> 00:19:40,745
to connect to these
sites and analyze them.

636
00:19:40,745 --> 00:19:42,860
And without someone
constantly looking at it,

637
00:19:42,860 --> 00:19:44,486
it's gonna be really hard for us to

638
00:19:44,487 --> 00:19:47,385
really adjust as these attackers adjust.

639
00:19:47,385 --> 00:19:48,978
Next, victimology.

640
00:19:48,978 --> 00:19:51,895
So who the most affected brands and why?

641
00:19:51,895 --> 00:19:53,743
We can see who,

642
00:19:53,743 --> 00:19:55,169
you know, through these reports,

643
00:19:55,170 --> 00:19:56,910
through URLs scan in
Anti-Phishing Work Group,

644
00:19:56,910 --> 00:19:58,251
but we can't really see the why.

645
00:19:58,251 --> 00:20:00,290
And the why is because

646
00:20:00,290 --> 00:20:02,379
we know what brands they go after

647
00:20:02,380 --> 00:20:03,420
but it's not just

648
00:20:03,420 --> 00:20:04,970
usernames and passwords
they're going after,

649
00:20:04,970 --> 00:20:06,540
they're taking more stuff there.

650
00:20:06,540 --> 00:20:07,889
So where is that data going

651
00:20:07,890 --> 00:20:09,896
after the victim falls for that phish?

652
00:20:09,896 --> 00:20:11,962
And then lastly, sharing and reporting.

653
00:20:11,962 --> 00:20:14,400
There just needs to be a better way to

654
00:20:14,400 --> 00:20:16,627
take something like that
zip file and that campaign,

655
00:20:16,627 --> 00:20:19,100
and put it somewhere so
somebody can track it.

656
00:20:19,100 --> 00:20:20,145
The best I've seen so far,

657
00:20:20,145 --> 00:20:22,498
are basically volunteers on Twitter.

658
00:20:22,498 --> 00:20:23,331
Go ahead,

659
00:20:23,331 --> 00:20:25,550
and if you put in hashtag
phishing or phishingkit,

660
00:20:25,550 --> 00:20:27,560
you'll see a lot of
their research on there

661
00:20:27,560 --> 00:20:28,700
and it's good data,

662
00:20:28,700 --> 00:20:30,860
but Twitter is definitely
not the best thing

663
00:20:30,860 --> 00:20:32,740
when it comes to threat indicator sharing.

664
00:20:32,740 --> 00:20:34,272
Though it has been pretty good

665
00:20:34,272 --> 00:20:35,521
for a number of things.

666
00:20:35,521 --> 00:20:36,716
(keyboard clicks)

667
00:20:36,716 --> 00:20:39,179
So in attempt to help out

668
00:20:39,180 --> 00:20:40,600
at least with the analysis part

669
00:20:40,600 --> 00:20:43,965
and that capability tracking
part for these actors,

670
00:20:43,965 --> 00:20:46,209
you know, we buildt phishponds at ZeroFOX.

671
00:20:46,210 --> 00:20:49,176
It's basically a malware
sandbox, but for phishing kits.

672
00:20:49,176 --> 00:20:50,540
(keyboard clicks)

673
00:20:50,540 --> 00:20:52,830
So the problem with,

674
00:20:52,830 --> 00:20:54,510
you know, phishing as we...

675
00:20:54,510 --> 00:20:55,800
as I've seen it over the years

676
00:20:55,800 --> 00:20:56,633
is that we kind of,

677
00:20:56,633 --> 00:20:58,550
we look at the domains
and the IP addresses

678
00:20:58,550 --> 00:21:00,373
and the registrars and the VPS provider.

679
00:21:00,373 --> 00:21:03,060
Those are all great
indicators of compromise

680
00:21:03,060 --> 00:21:05,560
but it kind of falls flat on its face

681
00:21:05,560 --> 00:21:07,270
because it's just
traditional whack-a-mole,

682
00:21:07,270 --> 00:21:08,710
think malware hashes.

683
00:21:08,710 --> 00:21:10,840
So, if we can start kind of,

684
00:21:10,840 --> 00:21:12,709
building upon other indicators

685
00:21:12,710 --> 00:21:14,890
by tagging a kit, for example,

686
00:21:14,890 --> 00:21:16,068
or looking at the different brands

687
00:21:16,068 --> 00:21:17,889
on a specific

688
00:21:17,890 --> 00:21:19,070
registrar

689
00:21:19,070 --> 00:21:21,370
or VPS where there's
hundreds of these things,

690
00:21:21,370 --> 00:21:22,943
we can maybe start building out campaigns

691
00:21:22,943 --> 00:21:25,160
and understanding this stuff a lot better.

692
00:21:25,160 --> 00:21:27,117
So phishpond makes that attempt

693
00:21:27,117 --> 00:21:31,547
to help defenders and
researchers analyze these TTPs

694
00:21:31,547 --> 00:21:34,570
and start putting together
these campaigns more.

695
00:21:34,570 --> 00:21:36,695
So, it basically is a malware sandbox,

696
00:21:36,695 --> 00:21:38,040
but for phishing kits,

697
00:21:38,040 --> 00:21:39,947
it'll detonate the kit
inside a web server.

698
00:21:39,948 --> 00:21:42,220
It's a docker project that has

699
00:21:42,220 --> 00:21:43,053
man-in-the -middleproxy,

700
00:21:43,053 --> 00:21:44,705
a containerized browser,

701
00:21:44,705 --> 00:21:46,280
and a containerized web server

702
00:21:46,280 --> 00:21:49,139
all looking through man
in the middle proxy.

703
00:21:49,140 --> 00:21:50,400
So you can sit there

704
00:21:50,400 --> 00:21:52,320
and watch traffic go through

705
00:21:52,320 --> 00:21:53,659
man in the middle proxy.

706
00:21:53,660 --> 00:21:56,220
You can stop traffic, you can shape it.

707
00:21:56,220 --> 00:21:58,665
And it's all there for you
to kind of play around with.

708
00:21:58,665 --> 00:22:00,692
It also has a lot of PHP shims

709
00:22:00,692 --> 00:22:03,270
that overrides normal PHP functionality

710
00:22:03,270 --> 00:22:05,470
to essentially neuter the kit as well.

711
00:22:05,470 --> 00:22:07,900
So, in terms of what you can do

712
00:22:07,900 --> 00:22:09,967
and how you can use phishponds,

713
00:22:09,967 --> 00:22:12,410
immediately, what I think you can do

714
00:22:12,410 --> 00:22:14,432
is find these exfiltration endpoints

715
00:22:14,432 --> 00:22:15,720
relatively quickly.

716
00:22:15,720 --> 00:22:17,490
So you can see where the data is going.

717
00:22:17,490 --> 00:22:19,111
A lot of times it's
going on the web server,

718
00:22:19,111 --> 00:22:20,680
or it's gonna an email address

719
00:22:20,680 --> 00:22:21,736
or things like that.

720
00:22:21,736 --> 00:22:24,019
You can also identify
weaknesses in the phishing kit.

721
00:22:24,019 --> 00:22:27,330
So you can see if it's
writing to a text file

722
00:22:27,330 --> 00:22:30,199
and that text file may
contain metadata on victims.

723
00:22:30,200 --> 00:22:32,501
And so now if you identify
that kit in the future,

724
00:22:32,501 --> 00:22:33,580
and it's live,

725
00:22:33,580 --> 00:22:35,409
you can navigate to that
text file in real time

726
00:22:35,410 --> 00:22:37,230
and pull down really good metadata.

727
00:22:37,230 --> 00:22:38,243
And then lastly,

728
00:22:38,243 --> 00:22:39,710
to be able to fingerprint

729
00:22:39,710 --> 00:22:41,743
either known kits or new kits.

730
00:22:41,743 --> 00:22:43,932
This is really important
when it comes to hunting

731
00:22:43,932 --> 00:22:46,240
because then we know
what those weaknesses are

732
00:22:46,240 --> 00:22:47,073
and who it is.

733
00:22:47,073 --> 00:22:48,430
And we can start building up

734
00:22:48,430 --> 00:22:50,680
campaigns and cases against these actors.

735
00:22:50,680 --> 00:22:53,160
So we can take more action against them

736
00:22:53,160 --> 00:22:55,730
rather than just getting a site band.

737
00:22:55,730 --> 00:22:58,447
So I'm gonna go through
three different videos here.

738
00:22:58,447 --> 00:23:01,989
I did not want to test the Demo
Gods today with a live demo.

739
00:23:01,990 --> 00:23:02,855
And within these videos,

740
00:23:02,855 --> 00:23:05,255
I'll do some color
commentary as they play.

741
00:23:05,255 --> 00:23:08,220
So, it's gonna be a
ProtonMail phishing kit

742
00:23:08,220 --> 00:23:10,223
that I pulled from Hackin9's repo.

743
00:23:10,223 --> 00:23:11,669
It's very straightforward.

744
00:23:11,670 --> 00:23:13,037
I modified them

745
00:23:13,037 --> 00:23:15,850
to make them a little bit more complicated

746
00:23:15,850 --> 00:23:17,123
with the other two demos,

747
00:23:17,124 --> 00:23:19,620
but hopefully at the end of this,

748
00:23:19,620 --> 00:23:20,453
you can kind of,

749
00:23:20,453 --> 00:23:22,389
understand what my analysis workflow is

750
00:23:22,390 --> 00:23:23,252
with phishing kits.

751
00:23:23,252 --> 00:23:25,419
And you can use this accordingly

752
00:23:25,420 --> 00:23:27,607
to go and do your own research.

753
00:23:27,607 --> 00:23:28,879
(keyboard clicks)

754
00:23:28,879 --> 00:23:29,800
Okay.

755
00:23:29,800 --> 00:23:32,270
So I'm gonna press play here.

756
00:23:32,270 --> 00:23:34,230
So here's the open-source repo

757
00:23:34,230 --> 00:23:35,063
it's on GitHub,

758
00:23:35,063 --> 00:23:36,410
feel free to go check it out.

759
00:23:36,410 --> 00:23:38,570
We try to document it as much as possible,

760
00:23:38,570 --> 00:23:39,870
it shows how to set it
up for the first time,

761
00:23:39,870 --> 00:23:42,003
how to use it and things like that.

762
00:23:42,003 --> 00:23:44,419
We also have a Wiki on here

763
00:23:44,420 --> 00:23:46,450
with the same for getting started,

764
00:23:46,450 --> 00:23:48,635
as well as a using phishpond guide

765
00:23:48,635 --> 00:23:51,520
that will have a lot more instructions

766
00:23:51,520 --> 00:23:54,179
on how to use to phishpond
to analyze these kits.

767
00:23:54,179 --> 00:23:55,600
So, as you can see here,

768
00:23:55,600 --> 00:23:57,520
whether it's debugging,
looking at traffic,

769
00:23:57,520 --> 00:23:59,670
browsing through the
kit, things like that.

770
00:24:00,613 --> 00:24:01,730
So,

771
00:24:01,730 --> 00:24:02,679
as you can see,

772
00:24:02,679 --> 00:24:05,725
there's a containerized Firefox browser

773
00:24:05,725 --> 00:24:09,553
and you just have to
navigate to localhost:5800,

774
00:24:09,553 --> 00:24:10,940
and once you're in there,

775
00:24:10,940 --> 00:24:12,380
go to phishpond.local

776
00:24:13,280 --> 00:24:17,410
And phishpond.local is the
containerized web server

777
00:24:17,410 --> 00:24:19,204
that has the phishing kit within it.

778
00:24:19,204 --> 00:24:21,360
So I'm pulling up my terminal here

779
00:24:21,360 --> 00:24:22,193
just to show you

780
00:24:22,193 --> 00:24:23,693
where I am within the directory path.

781
00:24:23,693 --> 00:24:24,639
So as you can see,

782
00:24:24,640 --> 00:24:28,260
demo phpinfo welcome.php's here.

783
00:24:28,260 --> 00:24:29,560
And then if I go up one more,

784
00:24:29,560 --> 00:24:31,120
it'll just be the top level directory

785
00:24:31,120 --> 00:24:32,402
of the GitHub repo.

786
00:24:33,749 --> 00:24:35,160
So this is perfect.

787
00:24:35,160 --> 00:24:36,763
So I'm gonna click into demo,

788
00:24:36,763 --> 00:24:39,274
and then I'm gonna
click into a ProtonMail.

789
00:24:39,275 --> 00:24:40,456
Now, I have three here,

790
00:24:40,456 --> 00:24:42,780
so this, I'll go through all
three of these during the demo.

791
00:24:42,780 --> 00:24:44,100
And these will be on the GitHub repo

792
00:24:44,100 --> 00:24:45,699
for everyone to play around with

793
00:24:45,700 --> 00:24:48,290
once you see this presentation.

794
00:24:48,290 --> 00:24:49,979
So I'm gonna click into protonmail,

795
00:24:49,979 --> 00:24:51,420
as you can see,

796
00:24:51,420 --> 00:24:53,650
it's a very simple
ProtonMail phishing page.

797
00:24:53,650 --> 00:24:55,900
Firefox is already warning
us this isn't over TLS,

798
00:24:55,900 --> 00:24:57,304
so be careful.

799
00:24:57,304 --> 00:24:58,900
And I wanna kind of,

800
00:24:58,900 --> 00:25:00,170
research this a little bit more,

801
00:25:00,170 --> 00:25:01,870
and because I pulled that zip file,

802
00:25:01,870 --> 00:25:03,232
I can research it.

803
00:25:03,232 --> 00:25:06,363
So the first thing I look at is index.php

804
00:25:08,228 --> 00:25:10,092
This is basically where,

805
00:25:10,092 --> 00:25:12,380
if there's a root kind of directory

806
00:25:12,380 --> 00:25:13,510
in a PHP deployment

807
00:25:13,510 --> 00:25:16,770
it'll always try to look
for index.php and load that.

808
00:25:16,770 --> 00:25:17,992
It'll load a file,

809
00:25:17,992 --> 00:25:19,430
in a script called ip.php

810
00:25:19,430 --> 00:25:22,440
and to a redirection to login.html

811
00:25:23,620 --> 00:25:26,090
So if I look at ip.php

812
00:25:26,090 --> 00:25:27,300
this does some logging

813
00:25:27,300 --> 00:25:28,290
based on a couple of headers

814
00:25:28,290 --> 00:25:29,740
that are present in the client.

815
00:25:29,740 --> 00:25:30,910
And then you'll notice

816
00:25:30,910 --> 00:25:34,050
that it writes that file out to ip.txt

817
00:25:34,050 --> 00:25:35,704
So already I'm making a
mental note in my head,

818
00:25:35,704 --> 00:25:38,639
if I see this phishing kit do /ip.txt

819
00:25:38,640 --> 00:25:40,580
and it'll give me some victim info.

820
00:25:40,580 --> 00:25:42,501
Anytime I'm looking at a phishing page,

821
00:25:42,501 --> 00:25:43,830
and doing research on this,

822
00:25:43,830 --> 00:25:44,840
I'm looking for forms.

823
00:25:44,840 --> 00:25:48,080
So just run that command F or control F,

824
00:25:48,080 --> 00:25:48,913
look for a form,

825
00:25:48,913 --> 00:25:50,640
and then look to see

826
00:25:50,640 --> 00:25:52,250
if you can find the login page here.

827
00:25:52,250 --> 00:25:54,130
And as you can see method posts,

828
00:25:54,130 --> 00:25:55,700
this is probably gonna be a post request

829
00:25:55,700 --> 00:25:57,287
with the credentials.

830
00:25:57,287 --> 00:26:00,095
You can also look up the
action within the form,

831
00:26:00,095 --> 00:26:01,790
to get the actual file

832
00:26:01,790 --> 00:26:04,430
that it sends that post
request to login.php

833
00:26:04,430 --> 00:26:05,940
So all really good intel,

834
00:26:05,940 --> 00:26:08,720
this is that victim workflow
that I was talking about.

835
00:26:08,720 --> 00:26:09,553
So,

836
00:26:09,553 --> 00:26:10,386
login.php

837
00:26:10,386 --> 00:26:13,026
it takes a post request
of username and password

838
00:26:13,026 --> 00:26:14,390
concatenates them together,

839
00:26:14,390 --> 00:26:16,640
and it writes it out to
this file on the web server

840
00:26:16,640 --> 00:26:18,028
called usernames.txt

841
00:26:18,028 --> 00:26:21,230
So this is really important
intel for you as well,

842
00:26:21,230 --> 00:26:24,300
because although the operator
can log in and get this,

843
00:26:24,300 --> 00:26:26,149
anybody can get in and get this,

844
00:26:26,150 --> 00:26:29,020
as long as the operator
didn't secure it correctly.

845
00:26:29,020 --> 00:26:30,547
A lot of times they have not.

846
00:26:30,547 --> 00:26:31,930
So one thing I'm gonna do

847
00:26:31,930 --> 00:26:33,404
with man in the middle proxy,

848
00:26:33,404 --> 00:26:36,100
it's I'm gonna set up some
filters for intercepting.

849
00:26:36,100 --> 00:26:37,707
So this is very much like Wireshark

850
00:26:37,708 --> 00:26:40,170
and I love using man in the middle proxy

851
00:26:40,170 --> 00:26:41,430
for this feature.

852
00:26:41,430 --> 00:26:42,853
I'm gonna put in a filter to say,

853
00:26:42,853 --> 00:26:45,120
if a method matches a post request,

854
00:26:45,120 --> 00:26:47,530
and if there's a header
that matches location,

855
00:26:47,530 --> 00:26:49,350
go ahead and just pause execution,

856
00:26:49,350 --> 00:26:52,423
and don't forward that HTTP packet out.

857
00:26:54,720 --> 00:26:56,570
So you can use this type of feature

858
00:26:56,570 --> 00:26:57,403
when you're going through

859
00:26:57,403 --> 00:26:58,430
and you're navigating through the kit

860
00:26:58,430 --> 00:26:59,940
to pause execution.

861
00:26:59,940 --> 00:27:02,710
I'm gonna type in a
username and password here,

862
00:27:02,710 --> 00:27:03,680
tester and tester,

863
00:27:03,680 --> 00:27:04,910
press login.

864
00:27:04,910 --> 00:27:05,806
It is frozen,

865
00:27:05,806 --> 00:27:06,990
and it is frozen

866
00:27:06,990 --> 00:27:09,040
because man in the middle
proxy caught a match,

867
00:27:09,040 --> 00:27:10,590
and now paused it.

868
00:27:10,590 --> 00:27:11,639
As you can see here,

869
00:27:11,640 --> 00:27:12,890
it shows all of the headers

870
00:27:12,890 --> 00:27:14,101
that came from the phishing kit,

871
00:27:14,101 --> 00:27:15,210
as well as,

872
00:27:15,210 --> 00:27:17,910
the post requests that
contains username and password.

873
00:27:19,460 --> 00:27:21,290
And it's paused here.

874
00:27:21,290 --> 00:27:24,378
And then you can also take
a look at the response.

875
00:27:24,378 --> 00:27:27,860
So this is what the PHP
server is responding with

876
00:27:27,860 --> 00:27:29,716
that location 302 found,

877
00:27:29,717 --> 00:27:30,688
and it's forwarding

878
00:27:30,688 --> 00:27:33,070
the victim to mail.protonmail.com

879
00:27:33,070 --> 00:27:35,110
So this is the full victim workflow

880
00:27:35,110 --> 00:27:36,562
of this particular kit.

881
00:27:38,330 --> 00:27:40,540
I pressed on pause here,

882
00:27:40,540 --> 00:27:43,889
I'm gonna go back to the
containerized browser,

883
00:27:43,890 --> 00:27:46,460
and there you go, mail.proton mail.com

884
00:27:46,460 --> 00:27:48,520
So that's the full victim workflow

885
00:27:48,520 --> 00:27:50,081
for this particular kit.

886
00:27:50,082 --> 00:27:53,550
Now, for my next trick,

887
00:27:53,550 --> 00:27:55,228
no, for my next demo,

888
00:27:55,228 --> 00:27:57,560
I'm gonna replace

889
00:27:57,560 --> 00:27:58,393
that

890
00:27:58,393 --> 00:27:59,790
file

891
00:27:59,790 --> 00:28:01,450
that we wrote our victims to

892
00:28:01,450 --> 00:28:04,185
with Telegram, a Telegram API call.

893
00:28:04,185 --> 00:28:05,040
You know,

894
00:28:05,040 --> 00:28:06,580
we're starting to see a lot of Telegram

895
00:28:06,580 --> 00:28:09,300
be to use lately for
exfiltration at ZeroFOX.

896
00:28:09,300 --> 00:28:10,389
Not just phishing kits

897
00:28:10,390 --> 00:28:12,230
but we're also seeing a lot with malware.

898
00:28:12,230 --> 00:28:14,307
So understanding and knowing

899
00:28:14,307 --> 00:28:17,160
when to deal with the a Telegram exfil

900
00:28:17,160 --> 00:28:18,280
is gonna be really important

901
00:28:18,280 --> 00:28:19,620
if you're analyzing these things.

902
00:28:19,620 --> 00:28:20,841
And luckily,

903
00:28:20,841 --> 00:28:22,261
we have a neat way

904
00:28:22,261 --> 00:28:25,550
of stopping telegram in
its tracks with phishponds,

905
00:28:25,550 --> 00:28:28,030
by using man in the middle proxy modules,

906
00:28:28,030 --> 00:28:29,430
which I'll demonstrate here.

907
00:28:31,000 --> 00:28:32,996
So I'm back in phishpond.local

908
00:28:32,996 --> 00:28:34,433
I clicked demo,

909
00:28:35,600 --> 00:28:38,370
I then go to the ProtonMail
telegram phish page.

910
00:28:38,370 --> 00:28:40,030
Looks very, very similar,

911
00:28:40,030 --> 00:28:41,960
but if I pull up the code,

912
00:28:41,960 --> 00:28:45,890
you'll notice that login.php was replaced.

913
00:28:45,890 --> 00:28:48,030
And instead of writing out to a text file

914
00:28:48,030 --> 00:28:50,300
on URL in coding that string,

915
00:28:50,300 --> 00:28:53,030
and I'm gonna call out to the Telegram API

916
00:28:53,030 --> 00:28:55,460
to send a message to a particular chat.

917
00:28:55,460 --> 00:28:57,060
Now, for those that are looking

918
00:28:57,060 --> 00:28:59,460
this is all like garbage data.

919
00:28:59,460 --> 00:29:02,230
So they're actually like,
this is not a real key.

920
00:29:02,230 --> 00:29:05,600
This is just kind of
demonstrating what would happen

921
00:29:05,600 --> 00:29:07,649
if I go in and reach out
to that with a real key.

922
00:29:07,650 --> 00:29:10,743
And we've used this rather
effectively with legit keys.

923
00:29:12,680 --> 00:29:14,053
So here's the URL.

924
00:29:15,460 --> 00:29:18,380
And then it calls file
get contents on that URL.

925
00:29:18,380 --> 00:29:21,190
So I'm gonna put in my
username and password again,

926
00:29:21,190 --> 00:29:23,240
which is not gonna go to user.txt

927
00:29:24,690 --> 00:29:25,800
I'm gonna press login,

928
00:29:25,800 --> 00:29:27,040
and instead of pausing,

929
00:29:27,040 --> 00:29:29,000
it's gonna forward me
directly to ProtonMail.

930
00:29:29,000 --> 00:29:30,743
So this is good.

931
00:29:30,743 --> 00:29:33,706
And it looks like I skipped it here.

932
00:29:33,707 --> 00:29:35,143
I'm gonna go back.

933
00:29:36,588 --> 00:29:37,909
Perfect. Okay.

934
00:29:37,910 --> 00:29:40,000
So I'm on man in the middle proxy here,

935
00:29:40,000 --> 00:29:41,751
and I'm to look for that

936
00:29:41,751 --> 00:29:45,000
get request out to api.telegram.com

937
00:29:45,000 --> 00:29:46,520
Now I didn't pause it this time

938
00:29:46,520 --> 00:29:47,830
because we have a module

939
00:29:47,830 --> 00:29:48,750
and you can go and check out

940
00:29:48,750 --> 00:29:50,370
the different modules that we have

941
00:29:50,370 --> 00:29:52,069
for man in the middle proxy

942
00:29:52,069 --> 00:29:53,040
(keyboard clicks)

943
00:29:53,040 --> 00:29:54,913
within the GitHub repo.

944
00:29:56,910 --> 00:29:58,603
Now, when this reached out,

945
00:29:59,512 --> 00:30:03,320
instead of going to api.telegram.org

946
00:30:03,320 --> 00:30:05,860
phishpond had this module

947
00:30:05,860 --> 00:30:07,639
that recognize something was going out

948
00:30:07,640 --> 00:30:09,010
to that domain,

949
00:30:09,010 --> 00:30:11,970
and instead, I gave it back to 201 created

950
00:30:11,970 --> 00:30:14,170
which was what the script expected.

951
00:30:14,170 --> 00:30:16,140
And then it returned with log data

952
00:30:16,140 --> 00:30:18,270
to log/telegram.log

953
00:30:18,270 --> 00:30:19,290
And lucky for us,

954
00:30:19,290 --> 00:30:22,310
there's a logs folder within the repo.

955
00:30:22,310 --> 00:30:24,020
And if you tail that telegram log,

956
00:30:24,020 --> 00:30:26,339
you'll see a beautiful JSON here,

957
00:30:26,339 --> 00:30:28,453
the actual requests as it goes out.

958
00:30:30,690 --> 00:30:31,640
Great.

959
00:30:31,640 --> 00:30:32,630
So,

960
00:30:32,630 --> 00:30:33,463
for

961
00:30:33,463 --> 00:30:34,643
my last

962
00:30:34,643 --> 00:30:36,210
kind of demo here,

963
00:30:36,210 --> 00:30:38,280
I'm gonna show an obfuscated phishing kit.

964
00:30:38,280 --> 00:30:40,040
So, this is really important

965
00:30:40,040 --> 00:30:43,280
because this is how the
developers for phish kits

966
00:30:43,280 --> 00:30:45,530
kind of protect their
intellectual property

967
00:30:45,530 --> 00:30:47,060
for lack of a better term.

968
00:30:47,060 --> 00:30:49,429
The problem is we control the code.

969
00:30:49,430 --> 00:30:50,780
If we control the code,

970
00:30:50,780 --> 00:30:53,280
we can deobfuscate it
with some tricks here.

971
00:30:53,280 --> 00:30:55,117
Now, the only thing

972
00:30:55,117 --> 00:30:58,230
with this particular type of analysis

973
00:30:58,230 --> 00:30:59,650
if you jump on the Wiki,

974
00:30:59,650 --> 00:31:02,113
go and set up the debugging kits,

975
00:31:03,750 --> 00:31:05,930
go to the RMI that has debugging kits,

976
00:31:05,930 --> 00:31:07,140
and it'll show you how to configure

977
00:31:07,140 --> 00:31:09,060
specifically Visual Studio code

978
00:31:09,060 --> 00:31:11,690
to build something
called a remote container

979
00:31:11,690 --> 00:31:13,850
and remote development container.

980
00:31:13,850 --> 00:31:16,209
And it'll actually connect
into that container,

981
00:31:16,210 --> 00:31:18,378
you can drop your PHP
break points in there,

982
00:31:18,378 --> 00:31:21,470
and then as that server
is executing that PHP,

983
00:31:21,470 --> 00:31:22,830
it'll drop into that break point,

984
00:31:22,830 --> 00:31:23,705
which is really neat

985
00:31:23,705 --> 00:31:25,120
and it helps out a lot

986
00:31:25,120 --> 00:31:26,820
when it comes to these techniques.

987
00:31:30,120 --> 00:31:31,360
So as you can see here,

988
00:31:31,360 --> 00:31:32,879
I'm just going through the read me

989
00:31:32,880 --> 00:31:33,900
and how to set it up,

990
00:31:33,900 --> 00:31:35,960
but let's do it for real this time.

991
00:31:35,960 --> 00:31:38,383
So I'm already in ProtonMail obfuscated,

992
00:31:40,056 --> 00:31:42,920
and I'm gonna switch over to VS code.

993
00:31:42,920 --> 00:31:44,490
Now, if you follow the instructions,

994
00:31:44,490 --> 00:31:47,779
you'll be presented with
a new VS code window,

995
00:31:47,779 --> 00:31:49,080
and then on the left,

996
00:31:49,080 --> 00:31:50,085
if you can see right here,

997
00:31:50,085 --> 00:31:51,443
there's the debugger.

998
00:31:51,443 --> 00:31:54,155
I'm gonna drop into login.php

999
00:31:54,155 --> 00:31:55,970
And I can see

1000
00:31:55,970 --> 00:31:58,610
that there's, I see some
obfuscated PHP code,

1001
00:31:58,610 --> 00:32:00,560
like variable names that don't make sense,

1002
00:32:00,560 --> 00:32:02,231
we're Base64 decoded stuff,

1003
00:32:02,231 --> 00:32:04,320
instead of going through this manually

1004
00:32:04,320 --> 00:32:06,010
and like kind of rip and replacing things,

1005
00:32:06,010 --> 00:32:07,310
and I've done this a bunch,

1006
00:32:07,310 --> 00:32:08,510
I'm just gonna use a debugger

1007
00:32:08,510 --> 00:32:11,310
because then I can just inspect
the values in real time.

1008
00:32:14,385 --> 00:32:15,480
So,

1009
00:32:15,480 --> 00:32:18,201
I'm going to go to line one.

1010
00:32:18,201 --> 00:32:20,623
I'm going to turn on a break point here.

1011
00:32:22,948 --> 00:32:24,170
As you go.

1012
00:32:24,170 --> 00:32:25,550
As you can see, that's a break point.

1013
00:32:25,550 --> 00:32:27,210
I'm gonna click listen,

1014
00:32:27,210 --> 00:32:28,970
and you should see a little pop up here

1015
00:32:28,970 --> 00:32:31,190
that says the remote extension debugger

1016
00:32:31,190 --> 00:32:32,740
is working on port 9,000

1017
00:32:32,740 --> 00:32:34,300
and you'll see the color

1018
00:32:34,300 --> 00:32:36,129
at the bottom turned to orange

1019
00:32:36,130 --> 00:32:40,100
which means it's ready
to hit that break point.

1020
00:32:40,100 --> 00:32:42,699
I'm gonna go back to the
containerized browser,

1021
00:32:42,700 --> 00:32:44,370
putting in my test test.

1022
00:32:44,370 --> 00:32:47,392
And instead of man in the
middle proxy stopping execution,

1023
00:32:47,393 --> 00:32:50,680
now I have Visual Studio
stopping this execution.

1024
00:32:50,680 --> 00:32:51,863
And I can see line by line

1025
00:32:51,863 --> 00:32:54,410
what these different values are gonna be.

1026
00:32:54,410 --> 00:32:55,863
So, as I skip over,

1027
00:32:57,710 --> 00:33:00,010
you'll see that that particular line

1028
00:33:00,010 --> 00:33:03,330
brought in account and
password from that post.

1029
00:33:03,330 --> 00:33:04,720
I also have some type of

1030
00:33:04,720 --> 00:33:06,950
api to telegram.org string.

1031
00:33:06,950 --> 00:33:08,710
I'm creating some stream context

1032
00:33:08,710 --> 00:33:10,970
for an HTTP call and PHP;

1033
00:33:10,970 --> 00:33:13,550
just some really nice debugging features

1034
00:33:13,550 --> 00:33:15,817
that's all in one place
and it's very visual.

1035
00:33:15,817 --> 00:33:18,870
This has saved my team a lot of time.

1036
00:33:18,870 --> 00:33:20,040
As we were kind of stepping through

1037
00:33:20,040 --> 00:33:21,677
some of these more
complicated phishing pages

1038
00:33:21,677 --> 00:33:22,995
and phishing kits.

1039
00:33:22,996 --> 00:33:25,053
I'm gonna step over everything here.

1040
00:33:26,600 --> 00:33:28,580
You can kind of see everything.

1041
00:33:28,580 --> 00:33:31,149
I also noted the Superglobals for PHP

1042
00:33:31,150 --> 00:33:33,070
and go back just a little bit.

1043
00:33:33,070 --> 00:33:35,330
You can actually pull
apart the post requests,

1044
00:33:35,330 --> 00:33:36,669
what the server has,

1045
00:33:36,670 --> 00:33:38,100
the different headers
and things like that.

1046
00:33:38,100 --> 00:33:40,699
So it's just a very useful thing

1047
00:33:40,700 --> 00:33:42,120
to step through this and,

1048
00:33:42,120 --> 00:33:44,132
you know, thank goodness they chose PHP

1049
00:33:45,415 --> 00:33:48,310
for the most part when
using phishing kits.

1050
00:33:48,310 --> 00:33:50,429
So I pressed step over and then resume,

1051
00:33:50,430 --> 00:33:53,050
and then I got forwarded
on the phishing kits

1052
00:33:53,050 --> 00:33:56,050
from my page to mail.protonmail.com

1053
00:33:56,050 --> 00:33:58,096
So you can see that victim workflow

1054
00:33:58,096 --> 00:33:59,955
still working all the way through,

1055
00:33:59,955 --> 00:34:01,790
but instead of the analysis technique

1056
00:34:01,790 --> 00:34:03,760
where I'm looking at it and
man in the middle proxy,

1057
00:34:03,760 --> 00:34:05,879
or I'm looking at it in log files,

1058
00:34:05,880 --> 00:34:07,280
or I'm looking at it through

1059
00:34:08,494 --> 00:34:10,239
man in the middle proxy modules,

1060
00:34:10,239 --> 00:34:12,763
I'm now looking at it
through Visual Studio code.

1061
00:34:12,763 --> 00:34:14,846
(sniffs)

1062
00:34:15,690 --> 00:34:16,523
Okay.

1063
00:34:16,523 --> 00:34:17,949
So next slide.

1064
00:34:17,949 --> 00:34:19,382
So in conclusion,

1065
00:34:20,270 --> 00:34:23,330
I hope you liked the presentation.

1066
00:34:23,330 --> 00:34:24,259
We spent a lot of time

1067
00:34:24,260 --> 00:34:25,420
kinda building this stuff up.

1068
00:34:25,420 --> 00:34:27,469
We used phishpond a lot.

1069
00:34:27,469 --> 00:34:29,591
And I'm gonna have a call to action here.

1070
00:34:29,592 --> 00:34:31,929
If it's interesting for you,

1071
00:34:31,929 --> 00:34:34,301
reach out to me on Twitter or

1072
00:34:34,301 --> 00:34:36,699
reach out to anybody you see posting

1073
00:34:36,699 --> 00:34:39,000
the #phishing or #phishingkit.

1074
00:34:39,000 --> 00:34:40,590
If you need help analyzing something,

1075
00:34:40,590 --> 00:34:41,880
or if you have a new sample,

1076
00:34:41,880 --> 00:34:43,190
almost everybody there is happy

1077
00:34:43,190 --> 00:34:44,699
to take a look at it for you.

1078
00:34:44,699 --> 00:34:48,159
But the big conclusion
points from the talk

1079
00:34:48,159 --> 00:34:49,121
are listed right here.

1080
00:34:49,121 --> 00:34:50,549
Just make sure that you know

1081
00:34:50,550 --> 00:34:52,790
that phishing and fraud,
they do go hand in hand,

1082
00:34:52,790 --> 00:34:54,708
and it's more than just
usernames and passwords

1083
00:34:54,708 --> 00:34:56,319
for a lot of these things.

1084
00:34:56,319 --> 00:34:58,840
And that's because these phishing kits,

1085
00:34:58,840 --> 00:35:01,376
they can take technically
unskilled operators

1086
00:35:01,376 --> 00:35:03,100
and give them the ability

1087
00:35:03,100 --> 00:35:05,009
to use really complicated
and advanced features

1088
00:35:05,010 --> 00:35:06,306
to attack end users.

1089
00:35:06,306 --> 00:35:07,601
Fraud is geopolitical.

1090
00:35:07,601 --> 00:35:11,329
So just like we looked at
the threat actor case study,

1091
00:35:11,329 --> 00:35:13,660
putting some time into look at

1092
00:35:13,660 --> 00:35:15,690
where these developers and operators are,

1093
00:35:15,690 --> 00:35:16,920
can give you a lot better insight

1094
00:35:16,920 --> 00:35:18,250
into why they're operating

1095
00:35:18,250 --> 00:35:21,210
and allows you to kinda
level up as a researcher.

1096
00:35:21,210 --> 00:35:23,720
Kits do have plenty of
this unused intelligence.

1097
00:35:23,720 --> 00:35:25,850
So instead of the IP
address and the domains

1098
00:35:25,850 --> 00:35:27,520
which are all great to have,

1099
00:35:27,520 --> 00:35:30,370
you saw that I had in there some

1100
00:35:30,370 --> 00:35:31,451
text files I can look at,

1101
00:35:31,451 --> 00:35:32,710
I had...

1102
00:35:32,710 --> 00:35:35,953
some APIs that I talked with on Telegram

1103
00:35:35,953 --> 00:35:38,509
and I can get Telegram API keys

1104
00:35:38,510 --> 00:35:39,859
to go and do additional pivoting.

1105
00:35:39,859 --> 00:35:42,807
So it's useful almost immediately

1106
00:35:42,807 --> 00:35:45,149
is what I'm trying to say here.

1107
00:35:45,150 --> 00:35:47,670
And then lastly,
contribute to open source.

1108
00:35:47,670 --> 00:35:48,660
We definitely need a lot more data

1109
00:35:48,660 --> 00:35:51,210
and we need a lot more eyes on this

1110
00:35:51,210 --> 00:35:52,043
and... I'm happy to answer

1111
00:35:52,043 --> 00:35:54,026
anything

1112
00:35:54,026 --> 00:35:54,859
anything

1113
00:35:55,744 --> 00:35:56,750
And like I said before,

1114
00:35:56,750 --> 00:35:59,921
anybody else on those
hashtags will do it as well.

1115
00:35:59,921 --> 00:36:00,799
(keyboard clicks)

1116
00:36:00,800 --> 00:36:02,206
So that concludes my talk.

1117
00:36:02,206 --> 00:36:03,960
Thank you everyone for coming.

1118
00:36:03,960 --> 00:36:05,327
And I know that...

1119
00:36:05,327 --> 00:36:07,540
hopefully you're typing some questions

1120
00:36:07,540 --> 00:36:09,090
throughout the talk here

1121
00:36:09,090 --> 00:36:10,220
and I was answering it in real time.

1122
00:36:10,220 --> 00:36:11,779
I hope I did an okay job.

1123
00:36:11,780 --> 00:36:13,000
And I think we should have
a little bit more time

1124
00:36:13,000 --> 00:36:14,300
to take some more questions.

1125
00:36:14,300 --> 00:36:15,133
Thank you.

