1
00:00:01,410 --> 00:00:04,990
- Hello, and welcome to Building
a CISO Response Strategy

2
00:00:04,990 --> 00:00:06,750
to Advanced Threats.

3
00:00:06,750 --> 00:00:07,930
My name is Jeff Costlow.

4
00:00:07,930 --> 00:00:09,530
I'm the deputy CISO at ExtraHop,

5
00:00:09,530 --> 00:00:11,639
a cybersecurity company
that specializes in

6
00:00:11,640 --> 00:00:13,930
network detection and response.

7
00:00:13,930 --> 00:00:15,570
As the CISO at a security company,

8
00:00:15,570 --> 00:00:18,670
I have spent a lot of time
thinking about advanced threats,

9
00:00:18,670 --> 00:00:20,710
supply chain attacks, and how to improve

10
00:00:20,710 --> 00:00:23,670
our response strategy when
the next SUNBURST scale

11
00:00:23,670 --> 00:00:26,900
or Exchange scale attack
shakes the industry.

12
00:00:26,900 --> 00:00:30,029
Today, I wanna share some
lessons learned during my career.

13
00:00:30,030 --> 00:00:32,270
I do wanna mention that
we are open for Q and A

14
00:00:32,270 --> 00:00:34,090
and I can take some questions online

15
00:00:34,090 --> 00:00:36,190
before the general Q/A session at the end.

16
00:00:37,820 --> 00:00:39,840
Before we dive into the
meat of the presentation,

17
00:00:39,840 --> 00:00:42,410
I wanna set the stage by
sharing two different CISO's

18
00:00:42,410 --> 00:00:44,510
threat response timelines.

19
00:00:44,510 --> 00:00:46,519
The CISO in dark blue manages a SOC

20
00:00:46,520 --> 00:00:48,690
that's more resilient to advanced threats.

21
00:00:48,690 --> 00:00:50,540
SOC is more mature.

22
00:00:50,540 --> 00:00:52,150
Because they were more prepared,

23
00:00:52,150 --> 00:00:54,699
they have a shorter time to resolution.

24
00:00:54,700 --> 00:00:57,380
Versus the organization
that's less resilient,

25
00:00:57,380 --> 00:01:00,000
which takes longer to resolve issues.

26
00:01:00,000 --> 00:01:01,870
My goal is to give you a framework

27
00:01:01,870 --> 00:01:03,360
to think about incident response

28
00:01:03,360 --> 00:01:06,100
and some immediate actions
to improve your resilience

29
00:01:06,100 --> 00:01:09,360
so that you can respond
faster and more confidently.

30
00:01:09,360 --> 00:01:11,840
At the end of this presentation,
I want you to feel equipped

31
00:01:11,840 --> 00:01:14,960
to be the dark blue
line, not the teal line.

32
00:01:14,960 --> 00:01:16,660
But why does a more mature shop have

33
00:01:16,660 --> 00:01:18,122
a shorter time to resolution?

34
00:01:19,640 --> 00:01:21,830
When you're in the beginning
moments of an emergency,

35
00:01:21,830 --> 00:01:24,880
it can feel like you're
wearing a cone of uncertainty.

36
00:01:24,880 --> 00:01:27,380
As soon as the news breaks
or you learn of a compromise

37
00:01:27,380 --> 00:01:30,503
or you learn of an attack,
your uncertainty is very large.

38
00:01:31,380 --> 00:01:33,179
You don't know what's happening exactly.

39
00:01:33,180 --> 00:01:35,620
But as you learn more information,

40
00:01:35,620 --> 00:01:39,160
your uncertainty decreases to
result in a more narrow cone.

41
00:01:39,160 --> 00:01:41,479
You can act on the
information that you have

42
00:01:41,480 --> 00:01:44,360
and those actions are what
leads to a resolution,

43
00:01:44,360 --> 00:01:46,020
a final resolution.

44
00:01:46,020 --> 00:01:47,860
In this diagram, the organization with

45
00:01:47,860 --> 00:01:50,630
the more mature information
retrieval process

46
00:01:50,630 --> 00:01:52,990
not only starts with less uncertainty

47
00:01:52,990 --> 00:01:55,660
but has a faster path to resolution.

48
00:01:55,660 --> 00:01:58,009
In other words, the faster
you can get information

49
00:01:58,010 --> 00:02:01,223
and reduce uncertainty, the
faster your time to resolution.

50
00:02:02,070 --> 00:02:05,570
I wanna point out this agility
at information retrieval

51
00:02:05,570 --> 00:02:07,610
builds on other key metrics also:

52
00:02:07,610 --> 00:02:12,123
resiliency, disaster recovery,
RTO, RPO, and others.

53
00:02:14,170 --> 00:02:15,829
In order to help you become more resilient

54
00:02:15,830 --> 00:02:18,040
in the face of high impact incidents,

55
00:02:18,040 --> 00:02:19,450
as well as all other incidents,

56
00:02:19,450 --> 00:02:21,959
I wanna discuss the following points:

57
00:02:21,960 --> 00:02:24,540
reframe our existing mental models;

58
00:02:24,540 --> 00:02:26,620
revise our incident response processes

59
00:02:26,620 --> 00:02:29,260
with steps to assess our risk,

60
00:02:29,260 --> 00:02:31,792
update where and how we look for answers,

61
00:02:32,686 --> 00:02:33,820
and to build resilience.

62
00:02:33,820 --> 00:02:35,290
I will also share next steps

63
00:02:35,290 --> 00:02:36,989
and summarize our learnings today.

64
00:02:39,450 --> 00:02:43,239
Let's start by defining what
we mean by advanced threats.

65
00:02:43,240 --> 00:02:44,720
Advanced threats are
those threats that are

66
00:02:44,720 --> 00:02:45,900
beyond the scope of the things

67
00:02:45,900 --> 00:02:47,830
that we normally worry about as CISOs,

68
00:02:47,830 --> 00:02:50,710
like phishing emails,
insecure IOT devices,

69
00:02:50,710 --> 00:02:53,860
ransomware, botnets, and other threats.

70
00:02:53,860 --> 00:02:55,500
I don't wanna downplay those threats,

71
00:02:55,500 --> 00:02:58,010
they are still quite dangerous.

72
00:02:58,010 --> 00:03:00,790
But they're relatively
well understood threats

73
00:03:00,790 --> 00:03:02,963
and we have tools to
mitigate most of them.

74
00:03:04,160 --> 00:03:06,829
Here's what we know about
the advanced adversary.

75
00:03:06,830 --> 00:03:09,320
They have patience and skills.

76
00:03:09,320 --> 00:03:11,200
They're using novel techniques

77
00:03:11,200 --> 00:03:13,410
and they may have already
made it past your defenses

78
00:03:13,410 --> 00:03:16,109
and are living off the LAN
inside of your environment.

79
00:03:17,000 --> 00:03:19,923
In a sense, malicious
insiders aren't unlike APTs.

80
00:03:20,810 --> 00:03:22,730
They have deep knowledge of your network,

81
00:03:22,730 --> 00:03:25,910
are good at hiding under the
cover of legitimate operations,

82
00:03:25,910 --> 00:03:28,329
and in both cases, we don't
deal with them very well

83
00:03:28,330 --> 00:03:30,180
because of the complexities involved.

84
00:03:31,060 --> 00:03:32,680
I will be discussing advanced threats

85
00:03:32,680 --> 00:03:33,820
and occasionally referencing

86
00:03:33,820 --> 00:03:36,650
the SolarWinds SUNBURST
campaign as an example.

87
00:03:36,650 --> 00:03:38,710
Since it was so widely covered,

88
00:03:38,710 --> 00:03:41,220
I believe it will be
understood by everyone.

89
00:03:41,220 --> 00:03:43,920
The next advanced threat will
look different than SUNBURST,

90
00:03:43,920 --> 00:03:46,869
but the tips I share should be
applicable across the board.

91
00:03:48,380 --> 00:03:52,180
Okay, so the adversary
is advanced, so what?

92
00:03:52,180 --> 00:03:53,920
If the adversary is so advanced,

93
00:03:53,920 --> 00:03:54,940
then there are a few principles

94
00:03:54,940 --> 00:03:57,160
that we wanna work into our defense.

95
00:03:57,160 --> 00:03:59,660
First, we can no longer
blindly trust our logs

96
00:03:59,660 --> 00:04:02,170
because they've been
potentially tampered with.

97
00:04:02,170 --> 00:04:04,089
An advanced attacker
would attempt to delete

98
00:04:04,090 --> 00:04:05,403
or corrupt those logs.

99
00:04:06,710 --> 00:04:09,100
Traditional tools will be evaded.

100
00:04:09,100 --> 00:04:11,410
If we look at SUNBURST,
we know that the adversary

101
00:04:11,410 --> 00:04:13,640
was able to bypass certain tooling.

102
00:04:13,640 --> 00:04:16,919
In this case, EDR, but it
could be different next time.

103
00:04:16,920 --> 00:04:18,700
We know that dwell times
for these attackers

104
00:04:18,700 --> 00:04:20,149
is often very long.

105
00:04:20,149 --> 00:04:21,979
Generally that means that the inside view

106
00:04:21,980 --> 00:04:24,450
of what's happening in our
environments is lacking.

107
00:04:24,450 --> 00:04:27,370
Otherwise, they wouldn't
have such a long dwell time.

108
00:04:27,370 --> 00:04:29,760
Add that all up and it means
we generally don't have

109
00:04:29,760 --> 00:04:32,500
a holistic view of our entire environment.

110
00:04:32,500 --> 00:04:33,333
But there's more.

111
00:04:33,333 --> 00:04:35,550
Our investment in traditional
tooling of prevention

112
00:04:35,550 --> 00:04:38,280
is inflated relative to the problem,

113
00:04:38,280 --> 00:04:40,530
that adversaries have
already bypassed that tooling

114
00:04:40,530 --> 00:04:42,332
and are left to roam freely.

115
00:04:43,720 --> 00:04:47,820
And finally, attackers attack
where there are assets.

116
00:04:47,820 --> 00:04:49,670
Why do bank robbers rob banks?

117
00:04:49,670 --> 00:04:51,570
Because that's where the money is.

118
00:04:51,570 --> 00:04:53,890
Attackers will go after your assets.

119
00:04:53,890 --> 00:04:55,780
And, customers are assets, too.

120
00:04:55,780 --> 00:04:57,900
This is immediately obvious
when we shine the light

121
00:04:57,900 --> 00:04:59,620
of SUNBURST on this problem.

122
00:04:59,620 --> 00:05:01,900
Clearly, the attackers were
quite interested in getting

123
00:05:01,900 --> 00:05:03,780
into the customers of SolarWinds,

124
00:05:03,780 --> 00:05:05,503
not just SolarWinds themselves.

125
00:05:07,130 --> 00:05:08,390
For this rest of this deck,

126
00:05:08,390 --> 00:05:10,719
I'll be using the NIST
Incident Response Cycle

127
00:05:10,720 --> 00:05:12,760
as a framework to help fit new techniques

128
00:05:12,760 --> 00:05:14,960
into what we are already doing.

129
00:05:14,960 --> 00:05:17,039
I like taking large problems
and breaking them into

130
00:05:17,040 --> 00:05:19,400
smaller pieces to make progress on them.

131
00:05:19,400 --> 00:05:22,880
Now, this cycle is straight
out of the NIST 861

132
00:05:22,880 --> 00:05:24,750
Incident Response Handling Guide.

133
00:05:24,750 --> 00:05:26,220
I simplified it just a little bit,

134
00:05:26,220 --> 00:05:28,740
but we'll get past that right away.

135
00:05:28,740 --> 00:05:31,610
So there are multiple stages here.

136
00:05:31,610 --> 00:05:34,770
Preparation: this step is
about gathering information

137
00:05:34,770 --> 00:05:37,549
and setting up our
policies and going through

138
00:05:37,550 --> 00:05:41,770
and just building a
system that we can extend.

139
00:05:41,770 --> 00:05:44,890
Detection and analysis: this
is the meat of what we do.

140
00:05:44,890 --> 00:05:46,460
We attempt to detect the bad guys

141
00:05:46,460 --> 00:05:49,513
and analyze their techniques,
tactics, and procedures.

142
00:05:50,510 --> 00:05:53,440
Containment and recovery:
this is the action we take

143
00:05:53,440 --> 00:05:55,493
when we know an attacker is operating.

144
00:05:56,537 --> 00:05:59,310
We first contain the
bad actor, then recover

145
00:05:59,310 --> 00:06:02,100
and ensure that they
no longer have access.

146
00:06:02,100 --> 00:06:05,490
Finally, there is
post-incident activities.

147
00:06:05,490 --> 00:06:08,630
The NIST Computer Security
Incident Handling Guide notes

148
00:06:08,630 --> 00:06:10,807
that, quote, "One of
the most important parts

149
00:06:10,807 --> 00:06:13,647
"of incident response is
also the most often omitted:

150
00:06:13,647 --> 00:06:15,810
"learning and improving."

151
00:06:15,810 --> 00:06:17,100
That quote comes from the section

152
00:06:17,100 --> 00:06:18,960
on post-incident activities,

153
00:06:18,960 --> 00:06:21,130
one of the final steps in the cycle.

154
00:06:21,130 --> 00:06:23,240
Later, we're gonna do small retrospective

155
00:06:23,240 --> 00:06:25,450
and examine some key facets of an attack

156
00:06:25,450 --> 00:06:27,539
and use it as an example
to lay out some learnings

157
00:06:27,540 --> 00:06:30,010
and preparatory steps
that can able faster,

158
00:06:30,010 --> 00:06:32,430
more effective response
to future advanced threats

159
00:06:32,430 --> 00:06:33,793
and supply chain attacks.

160
00:06:36,970 --> 00:06:38,340
Preparation.

161
00:06:38,340 --> 00:06:40,887
A key part of the
preparation phase is, quote,

162
00:06:40,887 --> 00:06:43,527
"Selecting and implementing
a set of controls

163
00:06:43,527 --> 00:06:46,280
"based on the results of risk assessment."

164
00:06:46,280 --> 00:06:48,750
Some of this selection and
implementation is focused on

165
00:06:48,750 --> 00:06:50,720
preventing incidents in the first place,

166
00:06:50,720 --> 00:06:52,430
which is important work to do,

167
00:06:52,430 --> 00:06:54,420
but over-investing in
prevention is something

168
00:06:54,420 --> 00:06:57,760
that has limited value and
diminishing returns over time.

169
00:06:57,760 --> 00:06:59,599
We may be better off
focusing our attention

170
00:06:59,600 --> 00:07:01,610
on response techniques.

171
00:07:01,610 --> 00:07:03,530
This preparation step is where we ensure

172
00:07:03,530 --> 00:07:05,429
we have the ability to answer questions

173
00:07:05,430 --> 00:07:06,820
about our environment.

174
00:07:06,820 --> 00:07:09,137
If we don't have logs and
we don't have endpoint

175
00:07:09,137 --> 00:07:10,750
and we don't have network data,

176
00:07:10,750 --> 00:07:13,640
then we're not gonna be
able to respond at all.

177
00:07:13,640 --> 00:07:16,270
As advanced threats, and
especially supply chain attacks,

178
00:07:16,270 --> 00:07:18,760
impact greater and greater
numbers of organizations,

179
00:07:18,760 --> 00:07:20,520
it grows more important to invest in

180
00:07:20,520 --> 00:07:23,099
internal investigation and response tools

181
00:07:23,100 --> 00:07:25,940
that are able to look backwards in time

182
00:07:25,940 --> 00:07:28,610
to discover attack exposure
and get to the root cause

183
00:07:28,610 --> 00:07:31,040
of an incident whose initial
compromise may have been

184
00:07:31,040 --> 00:07:33,800
in the past and may have come
in through the supply chain

185
00:07:33,800 --> 00:07:36,500
or other methods that has
no chance of being detected

186
00:07:36,500 --> 00:07:38,613
by perimeter-based prevention country.

187
00:07:41,518 --> 00:07:44,210
The second phase is
detection and analysis.

188
00:07:44,210 --> 00:07:46,000
Many security tools have some mechanism

189
00:07:46,000 --> 00:07:48,060
for saving and correlating relevant data

190
00:07:48,060 --> 00:07:49,960
after they have detected a threat.

191
00:07:49,960 --> 00:07:51,390
This is an example of present

192
00:07:51,390 --> 00:07:54,440
and future-focused detection and response.

193
00:07:54,440 --> 00:07:56,730
Unfortunately, by only
saving forensic data

194
00:07:56,730 --> 00:07:59,010
beginning at the point of detection,

195
00:07:59,010 --> 00:08:00,840
these tools give
themselves and their users

196
00:08:00,840 --> 00:08:03,609
much less of a chance to get
the root cause of an attack

197
00:08:03,610 --> 00:08:05,610
that started in the past.

198
00:08:05,610 --> 00:08:07,900
Unless you detect the
threat instantaneously,

199
00:08:07,900 --> 00:08:11,060
which is relatively rare,
you're losing valuable evidence

200
00:08:11,060 --> 00:08:12,590
by waiting to start saving data

201
00:08:12,590 --> 00:08:14,563
until some sort of detection fires.

202
00:08:15,470 --> 00:08:17,380
When advanced threats
operate with dwell times

203
00:08:17,380 --> 00:08:19,270
anywhere from months to nearly a year,

204
00:08:19,270 --> 00:08:21,080
in the case of the SUNBURST attack,

205
00:08:21,080 --> 00:08:24,490
it is important to investigate
to retain investigative data

206
00:08:24,490 --> 00:08:26,700
much longer into the past and assure

207
00:08:26,700 --> 00:08:28,550
that you have the
capabilities and know-how

208
00:08:28,550 --> 00:08:30,660
to quickly access and analyze that data

209
00:08:30,660 --> 00:08:31,860
to determine root cause.

210
00:08:33,210 --> 00:08:35,510
This type of data is also
useful for a piece of advice

211
00:08:35,510 --> 00:08:37,929
we'll get to later:
learning from the attack

212
00:08:37,929 --> 00:08:40,219
and generalizing that knowledge
to reduce the likelihood

213
00:08:40,220 --> 00:08:42,330
of being successfully hit
by the same techniques

214
00:08:42,330 --> 00:08:43,280
again in the field.

215
00:08:45,440 --> 00:08:48,290
The third phase is
containment and recovery.

216
00:08:48,290 --> 00:08:49,829
Security expert Bruce Schneider said,

217
00:08:49,830 --> 00:08:51,880
in the wake of SUNBURST,
that many organizations

218
00:08:51,880 --> 00:08:53,850
would have to burn down
their IT environments

219
00:08:53,850 --> 00:08:55,340
and start from scratch to sure

220
00:08:55,340 --> 00:08:57,370
that the threat was eradicated.

221
00:08:57,370 --> 00:09:00,160
This threat was active and
stealthily growing its access

222
00:09:00,160 --> 00:09:02,870
and persistence mechanisms
for such a long time

223
00:09:02,870 --> 00:09:04,440
that it would be very difficult to know

224
00:09:04,440 --> 00:09:06,790
you had it fully removed
from your environment.

225
00:09:07,860 --> 00:09:10,400
In a perfect world where
you have 100% visibility

226
00:09:10,400 --> 00:09:11,949
of everything in your environment,

227
00:09:11,950 --> 00:09:14,190
now and at every moment in the past,

228
00:09:14,190 --> 00:09:16,060
you could be perfectly
efficient at cutting out

229
00:09:16,060 --> 00:09:18,319
only the effected devices.

230
00:09:18,320 --> 00:09:20,400
Nobody's that good, but
you can make choices

231
00:09:20,400 --> 00:09:23,370
in your controls, your
tooling, your configuration,

232
00:09:23,370 --> 00:09:25,310
and your policies that make it more likely

233
00:09:25,310 --> 00:09:27,439
that you'll have the
right evidence preserved

234
00:09:27,440 --> 00:09:29,650
to confidently identify only those systems

235
00:09:29,650 --> 00:09:31,100
that need to be burned down,

236
00:09:31,100 --> 00:09:34,160
rather than rebuilding your
whole environment from scratch.

237
00:09:34,160 --> 00:09:36,089
The more evidence, and crucially,

238
00:09:36,090 --> 00:09:38,640
the correct pieces of
evidence that you preserve,

239
00:09:38,640 --> 00:09:41,540
the less likely you'll have
to fully burn down to rebuild.

240
00:09:42,960 --> 00:09:45,580
Finally, post-incident.

241
00:09:45,580 --> 00:09:47,580
The NIST Computer Security
Incident Handling Guide

242
00:09:47,580 --> 00:09:50,117
notes that, quote, "One of
the most important parts

243
00:09:50,117 --> 00:09:52,607
"of incident response is
often the most admitted:

244
00:09:52,607 --> 00:09:54,247
"learning and improving."

245
00:09:55,100 --> 00:09:56,320
That quote comes from the section

246
00:09:56,320 --> 00:09:57,670
on post-incident activities,

247
00:09:57,670 --> 00:09:59,959
one of the final steps in the cycle.

248
00:09:59,960 --> 00:10:02,720
In this presentation, we're
basically practicing this step,

249
00:10:02,720 --> 00:10:05,600
using SUNBURST as an example
to lay out some learnings

250
00:10:05,600 --> 00:10:08,040
and preparatory steps
that can enable faster,

251
00:10:08,040 --> 00:10:10,890
more effective response to
advance threats in the future.

252
00:10:13,030 --> 00:10:14,860
We're gonna analyze
these four steps deeper,

253
00:10:14,860 --> 00:10:16,020
but I'm gonna start at the end

254
00:10:16,020 --> 00:10:17,689
instead of starting at the beginning,

255
00:10:17,690 --> 00:10:20,270
with post-incident and
work our way forward

256
00:10:20,270 --> 00:10:22,600
from the beginning.

257
00:10:22,600 --> 00:10:25,210
Well, why do we do retrospectives?

258
00:10:25,210 --> 00:10:27,640
Well, we do them because you can bet

259
00:10:27,640 --> 00:10:29,490
that attackers are doing retrospectives

260
00:10:29,490 --> 00:10:31,870
and learning from their attacks.

261
00:10:31,870 --> 00:10:33,700
Attackers only get better.

262
00:10:33,700 --> 00:10:35,620
This leads to the famous escalating war

263
00:10:35,620 --> 00:10:36,810
where attackers get better

264
00:10:36,810 --> 00:10:39,089
and defenders have to
get better to keep up.

265
00:10:39,090 --> 00:10:41,500
The escalating war is
really an innovation gap

266
00:10:41,500 --> 00:10:43,930
between the attacker and the defenders.

267
00:10:43,930 --> 00:10:46,160
One of the things I noticed
right away about SUNBURST

268
00:10:46,160 --> 00:10:49,730
was that it looked like there
were multiple groups involved.

269
00:10:49,730 --> 00:10:52,480
One group was responsible
for initial landing.

270
00:10:52,480 --> 00:10:54,970
One group was responsible
for command and control.

271
00:10:54,970 --> 00:10:57,610
And one group was for
subverting the build system.

272
00:10:57,610 --> 00:10:59,180
You can bet that each one of those groups

273
00:10:59,180 --> 00:11:01,680
did a retrospective, just
like you're going to do.

274
00:11:02,740 --> 00:11:04,740
Why else do we do retrospectives?

275
00:11:04,740 --> 00:11:06,570
Enterprises have other business goals

276
00:11:06,570 --> 00:11:09,070
and naturally fall behind the attacker.

277
00:11:09,070 --> 00:11:12,530
I'm reminded here of
information asymmetry attacks.

278
00:11:12,530 --> 00:11:15,350
These are every child's tactic
when they want a cookie.

279
00:11:15,350 --> 00:11:17,920
Try parent one first,
and if the answer is no,

280
00:11:17,920 --> 00:11:19,620
try parent two.

281
00:11:19,620 --> 00:11:23,110
Now, both parents may have
access to the same information

282
00:11:23,110 --> 00:11:24,980
but they use it in different ways,

283
00:11:24,980 --> 00:11:27,000
which ends up with different results.

284
00:11:27,000 --> 00:11:29,030
If the two parents had
perfect communication

285
00:11:29,030 --> 00:11:31,150
then the cookie attack wouldn't succeed.

286
00:11:31,150 --> 00:11:32,650
Sadly, that's not always true.

287
00:11:33,990 --> 00:11:36,030
Next, I wanna talk about
using a retrospective

288
00:11:36,030 --> 00:11:38,693
to build a more resilient
and innovative defense.

289
00:11:39,800 --> 00:11:42,579
So when you're doing your retrospective,

290
00:11:42,580 --> 00:11:44,660
ask yourself the same question twice.

291
00:11:44,660 --> 00:11:46,199
The first should look backward

292
00:11:46,200 --> 00:11:48,030
and the second should look forward.

293
00:11:48,030 --> 00:11:50,800
These are the questions that I always ask.

294
00:11:50,800 --> 00:11:53,423
What can we do that would
have stopped this attack?

295
00:11:54,330 --> 00:11:56,120
And then, looking forward,

296
00:11:56,120 --> 00:11:58,453
how can we generalize
that to the next attack?

297
00:11:59,800 --> 00:12:02,400
How were we compromised or breached?

298
00:12:02,400 --> 00:12:04,050
How can we stop it next time?

299
00:12:04,050 --> 00:12:06,370
And you can break this down into multiple

300
00:12:07,430 --> 00:12:08,560
phases of the attack.

301
00:12:08,560 --> 00:12:11,280
There's the initial
vector, lateral movement.

302
00:12:11,280 --> 00:12:13,670
There's lots of ways to break this down.

303
00:12:13,670 --> 00:12:16,319
If you have multiple questions
to the first question,

304
00:12:16,320 --> 00:12:18,110
you can answer that question the second,

305
00:12:18,110 --> 00:12:19,560
how can we stop it next time?

306
00:12:20,600 --> 00:12:22,540
What assets were impacted?

307
00:12:22,540 --> 00:12:25,130
And then, how should we protect
those assets differently

308
00:12:25,130 --> 00:12:27,186
in the future to make sure

309
00:12:27,186 --> 00:12:28,986
that that this doesn't happen again?

310
00:12:30,130 --> 00:12:33,120
What information do we
need to be more resilient?

311
00:12:33,120 --> 00:12:37,070
And, how could we get that
information sooner next time?

312
00:12:37,070 --> 00:12:38,050
This is an important one.

313
00:12:38,050 --> 00:12:40,079
This is what we talked about
very early in the deck,

314
00:12:40,080 --> 00:12:42,660
about the cone of
uncertainty and shrinking

315
00:12:42,660 --> 00:12:45,150
that cone of uncertainty
as quickly as possible.

316
00:12:45,150 --> 00:12:46,689
How can I get the information

317
00:12:46,690 --> 00:12:48,243
that eliminates my uncertainty?

318
00:12:49,530 --> 00:12:52,569
Finally, why didn't we
realize this was happening?

319
00:12:52,570 --> 00:12:55,330
And then, an example kind
of forward looking is,

320
00:12:55,330 --> 00:12:58,220
how can we improve, say,
our MITRE ATT&CK coverage?

321
00:12:58,220 --> 00:13:00,360
Or, how can we make sure
that this is not happening

322
00:13:00,360 --> 00:13:01,290
in the future?

323
00:13:01,290 --> 00:13:03,663
And there are frameworks
under which to do that.

324
00:13:06,884 --> 00:13:10,410
The first phase after we're
done with our retrospective,

325
00:13:10,410 --> 00:13:12,640
we wanna feed that back in
and go all the way through

326
00:13:12,640 --> 00:13:14,120
the NIST cycle again.

327
00:13:14,120 --> 00:13:16,770
So the first phase in that is preparation.

328
00:13:16,770 --> 00:13:21,040
So we now have some retrospective
data about our defenses

329
00:13:21,040 --> 00:13:23,829
and we can be better
prepared for the next attack.

330
00:13:23,830 --> 00:13:25,530
We go back to our preparation phase

331
00:13:25,530 --> 00:13:28,030
and prepare to handle the
new attacker techniques.

332
00:13:28,880 --> 00:13:30,689
Ask yourself what your defenses look like

333
00:13:30,690 --> 00:13:33,440
before the threat and what
you want them to look like

334
00:13:33,440 --> 00:13:36,603
after the retrospective, after
you've analyze the threat.

335
00:13:37,440 --> 00:13:39,660
The best way I've found
to do this is to update

336
00:13:39,660 --> 00:13:41,160
the threat models that I keep.

337
00:13:42,230 --> 00:13:46,010
So the payoff of an updated
threat model is huge.

338
00:13:46,010 --> 00:13:48,000
The more mature your threat model is,

339
00:13:48,000 --> 00:13:49,650
the more attack coverage you have.

340
00:13:49,650 --> 00:13:51,230
And this is kind of a natural thing.

341
00:13:51,230 --> 00:13:53,060
We're back to a cone here,

342
00:13:53,060 --> 00:13:54,910
but this time it's not
a cone of uncertainty,

343
00:13:54,910 --> 00:13:56,660
it's a cone of coverage.

344
00:13:56,660 --> 00:13:58,230
When we first started doing threat models,

345
00:13:58,230 --> 00:14:01,240
our coverage didn't cover
everything that we wanted it to.

346
00:14:01,240 --> 00:14:02,380
And we knew that, right?

347
00:14:02,380 --> 00:14:04,820
We had to try to defend
what we could defend

348
00:14:04,820 --> 00:14:05,760
in the time we had.

349
00:14:05,760 --> 00:14:08,670
But over time, our threat
models get better and better

350
00:14:08,670 --> 00:14:12,170
and we take into account
more real-world information

351
00:14:12,170 --> 00:14:14,900
about how bad actors operate.

352
00:14:14,900 --> 00:14:16,740
We evolved our threat model to cover

353
00:14:16,740 --> 00:14:18,727
a much more broad set of threats.

354
00:14:18,727 --> 00:14:20,500
And this is a natural evolution over time,

355
00:14:20,500 --> 00:14:21,600
and it's a good thing.

356
00:14:23,600 --> 00:14:25,300
As long as we're updating
our threat model,

357
00:14:25,300 --> 00:14:27,770
it pays to go back and assess our risk

358
00:14:27,770 --> 00:14:30,670
and the visibility we have into that risk,

359
00:14:30,670 --> 00:14:33,120
in light of these new attacks.

360
00:14:33,120 --> 00:14:34,950
I like to think of my estate in terms of

361
00:14:34,950 --> 00:14:36,710
the assets that I hold.

362
00:14:36,710 --> 00:14:38,650
The majority of those
assets are gonna be things

363
00:14:38,650 --> 00:14:41,090
coverable by endpoint protection,

364
00:14:41,090 --> 00:14:44,610
like my desktops, laptops, mobile devices.

365
00:14:44,610 --> 00:14:45,950
That's the middle part, there.

366
00:14:45,950 --> 00:14:47,400
And generally those are well covered

367
00:14:47,400 --> 00:14:50,680
by endpoint agents or
logging or what have you,

368
00:14:50,680 --> 00:14:53,000
the general tools that we already have.

369
00:14:53,000 --> 00:14:55,000
As an industry, we're
already investing heavily

370
00:14:55,000 --> 00:14:57,550
in what's underneath the
peak of the bell curve, here.

371
00:14:57,550 --> 00:15:00,979
But there are other servers,
cloud servers, IOT devices,

372
00:15:00,980 --> 00:15:02,940
and I still need visibility into those.

373
00:15:02,940 --> 00:15:05,210
And I'm not likely to get any endpoint

374
00:15:05,210 --> 00:15:07,380
or even any logs out of those.

375
00:15:07,380 --> 00:15:10,810
So I choose to use network visibility.

376
00:15:10,810 --> 00:15:12,369
It's gonna have the broadest swath

377
00:15:12,370 --> 00:15:14,840
and it's gonna encompass
all those devices.

378
00:15:14,840 --> 00:15:17,570
If they're talking on the network,

379
00:15:17,570 --> 00:15:20,070
they're visible via their network traffic.

380
00:15:20,070 --> 00:15:22,260
It's time to diversify our investments

381
00:15:22,260 --> 00:15:24,620
and invest where we have the advantage

382
00:15:24,620 --> 00:15:26,923
on the inside, with this network data.

383
00:15:28,860 --> 00:15:30,737
Once we're more prepared with more data

384
00:15:30,737 --> 00:15:32,949
and the ability to answer more questions,

385
00:15:32,950 --> 00:15:35,170
it's time to move to the
next phase of our NIST cycle,

386
00:15:35,170 --> 00:15:36,713
detection and analysis.

387
00:15:37,630 --> 00:15:40,620
Attack surface is ever
expanding as we get more devices

388
00:15:40,620 --> 00:15:43,190
and more services scattered all around.

389
00:15:43,190 --> 00:15:45,970
Perhaps you've heard of
the Defender's Dilemma?

390
00:15:45,970 --> 00:15:48,540
Today, I'm gonna talk about
the Attacker's Dilemma.

391
00:15:48,540 --> 00:15:50,400
Despite our defenses,
there are so many ways

392
00:15:50,400 --> 00:15:51,550
to get past the perimeter.

393
00:15:51,550 --> 00:15:54,160
The perimeter is the dotted
line down there, at the bottom.

394
00:15:54,160 --> 00:15:56,120
The attacker's dilemma
is that their playbook

395
00:15:56,120 --> 00:15:58,350
becomes much more limited
once they've made it

396
00:15:58,350 --> 00:15:59,840
inside the perimeter.

397
00:15:59,840 --> 00:16:02,730
to accomplish their goals,
they must move laterally

398
00:16:02,730 --> 00:16:04,930
and likely have to use some
sort of command and control

399
00:16:04,930 --> 00:16:07,650
to broaden their access,
establish persistence,

400
00:16:07,650 --> 00:16:09,860
or just generally achieve their goal,

401
00:16:09,860 --> 00:16:11,640
whether that goal is data exfiltration

402
00:16:11,640 --> 00:16:13,430
or simple destruction.

403
00:16:13,430 --> 00:16:16,520
The number of tactics, techniques,
and procedures available

404
00:16:16,520 --> 00:16:20,329
for stealthy, lateral
movement within an environment

405
00:16:20,330 --> 00:16:22,130
is much smaller than the number of ways

406
00:16:22,130 --> 00:16:24,260
an attacker can attempt to
compromise the perimeter

407
00:16:24,260 --> 00:16:25,950
in the first place.

408
00:16:25,950 --> 00:16:28,190
If you get good at
detecting and investigating

409
00:16:28,190 --> 00:16:30,870
that handful of TTPs that attackers use

410
00:16:30,870 --> 00:16:32,410
once they're already inside,

411
00:16:32,410 --> 00:16:33,939
you can greatly improve your odds

412
00:16:33,940 --> 00:16:36,680
of preventing a breach,
as well as accelerating

413
00:16:36,680 --> 00:16:39,563
your eradication, containment,
and recovery stages.

414
00:16:41,410 --> 00:16:44,980
So how can we see those
attackers on the inside?

415
00:16:44,980 --> 00:16:47,280
Basically, you can look
at the Pyramid of Pain

416
00:16:47,280 --> 00:16:49,329
and break it down by what's easily visible

417
00:16:49,330 --> 00:16:52,020
with signatures, and what's not.

418
00:16:52,020 --> 00:16:53,850
The bottom part of the
Pyramid of Pain shows

419
00:16:53,850 --> 00:16:56,660
information that is
relatively easy to categorize.

420
00:16:56,660 --> 00:16:58,890
IP addresses, domain
names, things like that

421
00:16:58,890 --> 00:17:00,710
are relatively easy.

422
00:17:00,710 --> 00:17:02,710
However, the very top of the pyramid,

423
00:17:02,710 --> 00:17:05,300
tactics, techniques, and procedures,

424
00:17:05,300 --> 00:17:06,629
they're very tough to detect

425
00:17:06,630 --> 00:17:08,369
because you can't reduce it to signatures,

426
00:17:08,369 --> 00:17:10,849
you have to look at the behaviors.

427
00:17:10,849 --> 00:17:12,339
And this brings me back to the bottleneck

428
00:17:12,339 --> 00:17:14,220
at the bottom of the last slide.

429
00:17:14,220 --> 00:17:16,810
The good news is that there
are few behaviors available

430
00:17:16,810 --> 00:17:18,520
to attackers on the inside.

431
00:17:18,520 --> 00:17:20,129
Generally, they need to steal credentials

432
00:17:20,130 --> 00:17:22,760
or impersonate others, or figure
out how to move laterally,

433
00:17:22,760 --> 00:17:24,230
or command and control.

434
00:17:24,230 --> 00:17:27,329
So if you focus on
detecting those behaviors

435
00:17:27,329 --> 00:17:28,970
and retaining evidence for them

436
00:17:30,433 --> 00:17:33,670
for the post-compromise
investigation and threat hunting,

437
00:17:33,670 --> 00:17:36,370
you can get the biggest
bang for your buck.

438
00:17:36,370 --> 00:17:37,669
To put it in another way,

439
00:17:37,670 --> 00:17:41,350
flip the Attacker's
Dilemma into your solution.

440
00:17:41,350 --> 00:17:44,750
This can seem intimidating
if you don't have a way

441
00:17:44,750 --> 00:17:46,500
to observe these behaviors.

442
00:17:46,500 --> 00:17:47,890
But remember that bell curve

443
00:17:47,890 --> 00:17:50,500
that had every interaction
visible in the network?

444
00:17:50,500 --> 00:17:52,460
The trick is to build a security posture

445
00:17:52,460 --> 00:17:54,850
that relies on different
data sources and tooling,

446
00:17:54,850 --> 00:17:56,510
based on their strengths.

447
00:17:56,510 --> 00:17:57,790
Endpoint and logs will help you with

448
00:17:57,790 --> 00:17:59,120
the bulk of the pyramid,

449
00:17:59,120 --> 00:18:00,959
and the most advanced
threats on the inside

450
00:18:00,960 --> 00:18:02,343
are visible on the network.

451
00:18:03,940 --> 00:18:06,383
And if you don't believe
me, listen to the NSA.

452
00:18:07,220 --> 00:18:09,417
Quote, "One of our
worst nightmares is that

453
00:18:09,417 --> 00:18:12,276
"out-of-band network tap
that is really capturing

454
00:18:12,277 --> 00:18:14,607
"all the data, understanding
anomalous behavior

455
00:18:14,607 --> 00:18:18,127
"that's going on, and someone's
paying attention to it.

456
00:18:18,127 --> 00:18:19,587
"You've gotta know your network.

457
00:18:19,587 --> 00:18:22,790
"understand your network,
because we're going to."

458
00:18:22,790 --> 00:18:24,790
This quote is from Rob Joyce of the NSA.

459
00:18:25,850 --> 00:18:26,919
It's a few years ago now,

460
00:18:26,920 --> 00:18:30,260
but his point is that attackers
can't hide from the network.

461
00:18:30,260 --> 00:18:31,950
The attacker's goal is to know the network

462
00:18:31,950 --> 00:18:33,750
better than you know it yourself.

463
00:18:33,750 --> 00:18:35,640
But the attacker will
have no way of knowing

464
00:18:35,640 --> 00:18:38,520
if she's being watched if that
network tool is out of band

465
00:18:38,520 --> 00:18:41,129
and totally invisible to the attacker.

466
00:18:41,130 --> 00:18:43,620
Today, unfortunately,
advanced threat actors

467
00:18:43,620 --> 00:18:46,399
can pretty safely assume
they're not being watched.

468
00:18:46,400 --> 00:18:48,610
But the companies who
have adopted the network

469
00:18:48,610 --> 00:18:51,689
as a data source for defense
will be the best prepared

470
00:18:51,690 --> 00:18:52,863
for advanced threats.

471
00:18:54,860 --> 00:18:56,659
Okay, so we got some good strategies

472
00:18:56,660 --> 00:18:58,510
for detection and analysis.

473
00:18:58,510 --> 00:19:00,460
What about the next
phase of the NIST cycle,

474
00:19:00,460 --> 00:19:04,190
containment and recovery, the
last topic we haven't covered?

475
00:19:04,190 --> 00:19:05,670
Remember earlier how we said that

476
00:19:05,670 --> 00:19:08,090
we might have to burn
it down and start again?

477
00:19:08,090 --> 00:19:10,399
That sounds bad, let's not do that.

478
00:19:10,400 --> 00:19:11,810
How can we reassure ourselves

479
00:19:11,810 --> 00:19:14,040
the bad actors didn't spread?

480
00:19:14,040 --> 00:19:16,909
My answer to that is that
the usual tools that we have,

481
00:19:16,910 --> 00:19:20,960
EDR and logs, but I'm gonna
add network data again.

482
00:19:20,960 --> 00:19:22,750
Because of how network telemetry works,

483
00:19:22,750 --> 00:19:25,080
you can store a large amount
of the right forensics evidence

484
00:19:25,080 --> 00:19:26,689
for this kind of investigation,

485
00:19:26,690 --> 00:19:30,030
and ultimately avoid burning
it down and rebuilding.

486
00:19:30,030 --> 00:19:33,879
If you get hit by a less
sophisticated attacker,

487
00:19:33,880 --> 00:19:36,350
you can likely be more surgical
about your containment,

488
00:19:36,350 --> 00:19:39,159
eradication, and recovery processes.

489
00:19:39,160 --> 00:19:41,280
But in order to do so,
you need to have evidence

490
00:19:41,280 --> 00:19:43,540
that goes back far enough
that you can see when

491
00:19:43,540 --> 00:19:46,490
and where the attacker first
entered your environment.

492
00:19:46,490 --> 00:19:48,990
Forensic evidence, preserved
for as long as possible

493
00:19:48,990 --> 00:19:51,880
into the past, is a vital
tool for reducing your chances

494
00:19:51,880 --> 00:19:54,440
of having to burn it down and rebuild.

495
00:19:54,440 --> 00:19:56,610
For example, in cases where the attack has

496
00:19:56,610 --> 00:19:59,760
a very long dwell time,
nearly a year for SUNBURST,

497
00:19:59,760 --> 00:20:01,540
and the attackers are likely maintaining

498
00:20:01,540 --> 00:20:03,080
their potential for access,

499
00:20:03,080 --> 00:20:05,230
but may not be using it very often,

500
00:20:05,230 --> 00:20:07,700
your opportunity to determine which users,

501
00:20:07,700 --> 00:20:09,890
hosts, or assets are compromised

502
00:20:09,890 --> 00:20:13,047
may be to trace the original
moment of compromise

503
00:20:13,047 --> 00:20:16,800
or discover stealthy C2 traffic.

504
00:20:16,800 --> 00:20:18,740
Retaining forensic data for long periods

505
00:20:18,740 --> 00:20:20,540
is an important preparatory step

506
00:20:20,540 --> 00:20:23,230
for reducing the impact of future attacks.

507
00:20:23,230 --> 00:20:25,040
Think of it as less expensive than logs

508
00:20:25,040 --> 00:20:26,633
but possibly just as useful.

509
00:20:28,820 --> 00:20:31,879
To wrap this up, let's
look at our call to action.

510
00:20:31,880 --> 00:20:33,300
Let's start just like we did

511
00:20:33,300 --> 00:20:35,899
at the end of the NIST
Incident Response Cycle.

512
00:20:35,900 --> 00:20:38,720
Next week, conduct a retrospective.

513
00:20:38,720 --> 00:20:40,570
Reassess the risk you hold.

514
00:20:40,570 --> 00:20:42,500
Use the SUNBURST attack as your guide

515
00:20:42,500 --> 00:20:44,400
and ask the questions I showed earlier.

516
00:20:44,400 --> 00:20:45,930
What could we do to stop that attack

517
00:20:45,930 --> 00:20:47,440
if it were done to us?

518
00:20:47,440 --> 00:20:48,969
What assets do we have

519
00:20:48,969 --> 00:20:51,300
that the attacker would have gone after?

520
00:20:51,300 --> 00:20:54,129
Next month, feed that back
into your preparation steps

521
00:20:54,130 --> 00:20:55,950
so that you can answer questions quickly

522
00:20:55,950 --> 00:20:57,510
and reduce your cone of uncertainty

523
00:20:57,510 --> 00:20:59,560
when in the middle of an incident.

524
00:20:59,560 --> 00:21:01,220
Update your threat model and think about

525
00:21:01,220 --> 00:21:04,130
the defenses you need to put into place.

526
00:21:04,130 --> 00:21:06,830
Six months from now, do it all again.

527
00:21:06,830 --> 00:21:09,040
You'll know more about
the attacker techniques.

528
00:21:09,040 --> 00:21:10,990
You'll know more about your defenses.

529
00:21:10,990 --> 00:21:13,780
You'll have thought about those
attacks, and your defenses,

530
00:21:13,780 --> 00:21:14,960
and likely you will have come up

531
00:21:14,960 --> 00:21:16,560
with some novel countermeasures.

532
00:21:19,600 --> 00:21:22,429
In summary, advanced threats
should change how we think

533
00:21:22,430 --> 00:21:24,680
about our risk and incident
response strategies,

534
00:21:24,680 --> 00:21:26,890
as well as our threat models.

535
00:21:26,890 --> 00:21:29,480
Adversaries are learning
from successful campaigns,

536
00:21:29,480 --> 00:21:30,313
so should we.

537
00:21:31,220 --> 00:21:33,350
Building resilience
begins with retrospectives

538
00:21:33,350 --> 00:21:34,949
and assessing the risk you hold.

539
00:21:36,000 --> 00:21:37,560
Attackers have a limited playbook,

540
00:21:37,560 --> 00:21:40,030
which can be used to your advantage.

541
00:21:40,030 --> 00:21:42,629
Network monitoring is an
attacker's worst nightmare.

542
00:21:43,510 --> 00:21:45,700
Enabling evidence preservation
across your tooling

543
00:21:45,700 --> 00:21:48,540
will save your organization
a lot of heartaches.

544
00:21:48,540 --> 00:21:53,090
And, good security is about resilience,

545
00:21:53,090 --> 00:21:55,060
not being bulletproof.

546
00:21:55,060 --> 00:21:56,970
So with that, I'd like to thank you all

547
00:21:56,970 --> 00:21:58,924
and open up for the Q/A session now.

548
00:21:58,924 --> 00:21:59,757
Thanks.

