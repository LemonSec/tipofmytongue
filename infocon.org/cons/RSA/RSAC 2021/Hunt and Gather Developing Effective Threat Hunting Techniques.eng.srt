1
00:00:01,140 --> 00:00:02,410
- My name's Tim Bandos.

2
00:00:02,410 --> 00:00:04,720
I am the CISO for Digital Guardian,

3
00:00:04,720 --> 00:00:06,439
a data loss prevention company.

4
00:00:06,440 --> 00:00:09,500
And today we're gonna talk
about hunting and gathering.

5
00:00:09,500 --> 00:00:12,503
Developing effective
threat hunting techniques.

6
00:00:14,720 --> 00:00:16,070
Just a couple of things
that we're gonna discuss.

7
00:00:16,070 --> 00:00:18,480
We're gonna go over
what threat hunting is.

8
00:00:18,480 --> 00:00:20,190
We're gonna talk a little
bit about the skills

9
00:00:20,190 --> 00:00:21,320
that are ultimately required

10
00:00:21,320 --> 00:00:23,560
to be an effective threat hunter.

11
00:00:23,560 --> 00:00:25,330
Talk about attack model selection.

12
00:00:25,330 --> 00:00:26,729
I know there's a lot
out there in the market

13
00:00:26,730 --> 00:00:28,050
like the MITRE ATT&CK Framework,

14
00:00:28,050 --> 00:00:28,883
the Lockheed Chain.

15
00:00:28,883 --> 00:00:30,810
We're gonna go into some
details around those.

16
00:00:30,810 --> 00:00:32,619
We're also gonna talk
about prepping the hunt.

17
00:00:32,619 --> 00:00:35,220
How do you go about preparing
for actually engaging

18
00:00:35,220 --> 00:00:37,750
in an effective threat hunting campaign?

19
00:00:37,750 --> 00:00:39,520
We're gonna talk about
some hunting use cases.

20
00:00:39,520 --> 00:00:41,200
Things that you guys
can use out in the field

21
00:00:41,200 --> 00:00:43,910
to identify adversary type techniques

22
00:00:43,910 --> 00:00:46,669
and tactics and artifacts
that have been left behind.

23
00:00:46,670 --> 00:00:48,780
And then for the more advanced out there,

24
00:00:48,780 --> 00:00:49,613
we're gonna talk about

25
00:00:49,613 --> 00:00:51,250
some advanced threat hunting scenarios.

26
00:00:51,250 --> 00:00:53,710
Techniques that can be used
for really drilling down

27
00:00:53,710 --> 00:00:55,670
and finding the unknown.

28
00:00:55,670 --> 00:00:56,770
And then I'm gonna wrap it all up

29
00:00:56,770 --> 00:00:58,220
in a nice little pretty bell.

30
00:01:00,250 --> 00:01:02,040
What is threat hunting?

31
00:01:02,040 --> 00:01:03,690
Now, there's a ton of
definitions out there on the web

32
00:01:03,690 --> 00:01:06,590
but from my perspective it's human driven.

33
00:01:06,590 --> 00:01:08,100
It's hypothesis driven.

34
00:01:08,100 --> 00:01:10,289
It's coming up with
questions thinking about

35
00:01:10,290 --> 00:01:12,730
where do I wanna search across my network.

36
00:01:12,730 --> 00:01:14,840
Coming up with those types
of questions where you wanna

37
00:01:14,840 --> 00:01:18,000
drill down into specific
types of behaviors.

38
00:01:18,000 --> 00:01:20,220
What lateral movement type tools

39
00:01:20,220 --> 00:01:22,500
or utilities are executing
in my environment?

40
00:01:22,500 --> 00:01:24,870
What users are executing
these types of programs?

41
00:01:24,870 --> 00:01:27,820
What programs are executing
out of a temporary directory?

42
00:01:27,820 --> 00:01:30,809
These are just a couple of
questions that can be asked

43
00:01:30,810 --> 00:01:32,970
in the beginning of prepping for a hunt.

44
00:01:32,970 --> 00:01:34,840
It's proactively searching too.

45
00:01:34,840 --> 00:01:36,700
It's not sitting back

46
00:01:36,700 --> 00:01:39,040
and just waiting for the
incident to come to you.

47
00:01:39,040 --> 00:01:40,320
It's being proactive

48
00:01:40,320 --> 00:01:41,190
and going out there

49
00:01:41,190 --> 00:01:43,140
and searching across all the data sources

50
00:01:43,140 --> 00:01:45,100
that you guys have available to you.

51
00:01:45,100 --> 00:01:46,240
It's looking at endpoint data,

52
00:01:46,240 --> 00:01:47,550
it's looking at network device data.

53
00:01:47,550 --> 00:01:48,713
It's looking at all the centralized logs

54
00:01:48,713 --> 00:01:50,380
that you have coming in.

55
00:01:50,380 --> 00:01:53,140
Any source of data can be really

56
00:01:53,140 --> 00:01:54,500
an information pool,

57
00:01:54,500 --> 00:01:56,580
a data pool that can be seeking out

58
00:01:56,580 --> 00:01:59,440
looking for adversarial type activity.

59
00:01:59,440 --> 00:02:00,570
And that's what this is about.

60
00:02:00,570 --> 00:02:02,009
It's seeking out the unknown.

61
00:02:02,010 --> 00:02:04,870
It's not necessarily looking
for things that we know about

62
00:02:04,870 --> 00:02:06,619
or high fidelity indicators

63
00:02:06,619 --> 00:02:08,979
or alerts that are triggering in our SIM.

64
00:02:08,979 --> 00:02:11,587
It's identifying those
things that we're unaware of.

65
00:02:11,587 --> 00:02:14,820
And it also leverage
intelligence on tactics

66
00:02:14,820 --> 00:02:17,810
and techniques, procedures
that are being used by

67
00:02:17,810 --> 00:02:21,103
advanced nation state sponsored
type threat actor groups.

68
00:02:24,500 --> 00:02:25,710
From a skills perspective,

69
00:02:25,710 --> 00:02:27,720
what does it all require?

70
00:02:27,720 --> 00:02:30,160
So anyone can be really a threat hunter.

71
00:02:30,160 --> 00:02:31,799
Analysts can go out there,

72
00:02:31,800 --> 00:02:33,595
they can look for things within the logs.

73
00:02:33,595 --> 00:02:35,560
But if you wanted to be
an effective threat hunter

74
00:02:35,560 --> 00:02:39,410
I do believe that comes with
having a complete package.

75
00:02:39,410 --> 00:02:40,410
From a skills perspective

76
00:02:40,410 --> 00:02:42,359
really in the security knowledge space,

77
00:02:42,360 --> 00:02:44,410
understanding security architecture,

78
00:02:44,410 --> 00:02:46,100
asset security, application security,

79
00:02:46,100 --> 00:02:48,640
risk management, all of
these fundamental pillars

80
00:02:48,640 --> 00:02:51,000
of cybersecurity actually help

81
00:02:51,000 --> 00:02:54,420
in informing a more
well-rounded threat hunter.

82
00:02:54,420 --> 00:02:55,700
And then when you really start looking at

83
00:02:55,700 --> 00:02:57,380
the hands-on experience,

84
00:02:57,380 --> 00:02:59,210
from an incident response perspective.

85
00:02:59,210 --> 00:03:00,690
Having log analysis skills,

86
00:03:00,690 --> 00:03:02,920
malware analysis, forensics,

87
00:03:02,920 --> 00:03:04,880
which I think is one
of the most important,

88
00:03:04,880 --> 00:03:07,760
and then also being able to
even conduct threat intelligence

89
00:03:07,760 --> 00:03:10,590
when you're researching a
particular adversarial group

90
00:03:10,590 --> 00:03:12,270
or looking for different type techniques

91
00:03:12,270 --> 00:03:14,690
that are out on the internet
about certain things.

92
00:03:14,690 --> 00:03:17,010
All of that matters when
you're building up a profile

93
00:03:17,010 --> 00:03:19,090
of what you're actively
gonna start looking for

94
00:03:19,090 --> 00:03:21,240
when you do conduct a threat hunt.

95
00:03:21,240 --> 00:03:22,320
And then the mindset,

96
00:03:22,320 --> 00:03:24,840
that's almost just as
important as the other two too.

97
00:03:24,840 --> 00:03:26,910
Being analytical, being patient

98
00:03:26,910 --> 00:03:28,350
and creative and relentless

99
00:03:28,350 --> 00:03:30,530
and not giving up and stopping.

100
00:03:30,530 --> 00:03:31,680
If you really wanna be,

101
00:03:31,680 --> 00:03:34,930
I think an Uber fed hunter
like my boy Mandu over here,

102
00:03:34,930 --> 00:03:36,440
you really need to have

103
00:03:36,440 --> 00:03:38,329
that relentless nature about yourself

104
00:03:38,330 --> 00:03:40,770
and not necessarily give up.

105
00:03:40,770 --> 00:03:42,320
Because it can be difficult.

106
00:03:42,320 --> 00:03:43,153
You're looking for things

107
00:03:43,153 --> 00:03:44,109
that are unknown in the environment

108
00:03:44,110 --> 00:03:45,110
and you might not be

109
00:03:46,060 --> 00:03:48,670
effective every single
day in finding something.

110
00:03:48,670 --> 00:03:51,190
But there's gonna be those
days when you do find stuff

111
00:03:51,190 --> 00:03:52,913
and then we're gonna get into that.

112
00:03:54,330 --> 00:03:55,570
Choosing a model.

113
00:03:55,570 --> 00:03:56,829
There's a ton of models out there

114
00:03:56,830 --> 00:03:58,740
but this is important.

115
00:03:58,740 --> 00:03:59,670
This is a very important step

116
00:03:59,670 --> 00:04:03,420
because understanding the
entire attack life cycle,

117
00:04:03,420 --> 00:04:05,450
from infiltration to
backdoor installation,

118
00:04:05,450 --> 00:04:06,410
command and control,

119
00:04:06,410 --> 00:04:08,890
all the way down to exfiltration.

120
00:04:08,890 --> 00:04:11,470
Understanding each one of those vectors

121
00:04:11,470 --> 00:04:13,770
in the attack life cycle is critical.

122
00:04:13,770 --> 00:04:15,370
Because all of those areas

123
00:04:15,370 --> 00:04:18,303
you can identify traces of
adversarial type behavior.

124
00:04:19,470 --> 00:04:21,019
Lockheed Martin has a great one,

125
00:04:21,019 --> 00:04:22,180
FireEye has a great one.

126
00:04:22,180 --> 00:04:24,380
But I think the staple in this industry,

127
00:04:24,380 --> 00:04:26,350
and I think by now we

128
00:04:26,350 --> 00:04:28,230
almost all probably agree,

129
00:04:28,230 --> 00:04:32,110
is that MITRE ATT&CK Framework
is absolutely the best.

130
00:04:32,110 --> 00:04:34,060
It breaks down every single vector.

131
00:04:34,060 --> 00:04:36,550
And they've got a fantastic
website that really goes

132
00:04:36,550 --> 00:04:39,090
into the details of every single area.

133
00:04:39,090 --> 00:04:41,659
From initial access to
privilege escalation.

134
00:04:41,660 --> 00:04:43,530
And they drill down into those.

135
00:04:43,530 --> 00:04:44,690
Application shimming,

136
00:04:44,690 --> 00:04:47,050
exploitation for privilege escalation.

137
00:04:47,050 --> 00:04:48,500
Every single one of these

138
00:04:48,500 --> 00:04:51,310
can be basically a threat hunting campaign

139
00:04:51,310 --> 00:04:52,790
searching out across your environment

140
00:04:52,790 --> 00:04:56,410
for artifacts associated
with each of these areas.

141
00:04:56,410 --> 00:04:59,130
If you wanted to look at bits jobs running

142
00:04:59,130 --> 00:05:01,580
or scheduled at jobs executing,

143
00:05:01,580 --> 00:05:05,659
or looking at scheduled transfers
across your environment.

144
00:05:05,660 --> 00:05:09,360
Every one of those areas you
can identify certain types of,

145
00:05:09,360 --> 00:05:10,193
like I said,

146
00:05:10,193 --> 00:05:11,026
adversarial type behavior.

147
00:05:11,026 --> 00:05:14,660
So understanding and picking an attack

148
00:05:14,660 --> 00:05:15,960
model is critical.

149
00:05:15,960 --> 00:05:17,520
This is just my recommendation.

150
00:05:17,520 --> 00:05:20,683
I do believe the ATT&CK
MITRE Framework is the best.

151
00:05:23,030 --> 00:05:24,046
There's just a little bit of talking about

152
00:05:24,047 --> 00:05:25,283
what I just went over.

153
00:05:26,120 --> 00:05:27,790
On the website itself too,

154
00:05:27,790 --> 00:05:29,100
as we break these things down,

155
00:05:29,100 --> 00:05:30,040
they give you a nice definition.

156
00:05:30,040 --> 00:05:32,380
They talk about the
operating systems affected.

157
00:05:32,380 --> 00:05:34,080
They go into real world examples.

158
00:05:34,080 --> 00:05:35,560
How do you go about mitigating it?

159
00:05:35,560 --> 00:05:37,250
And then most importantly
for you threat hunters,

160
00:05:37,250 --> 00:05:38,900
how do you go about detecting it?

161
00:05:38,900 --> 00:05:40,099
How do you actually find

162
00:05:41,010 --> 00:05:42,780
some of these specific segments

163
00:05:42,780 --> 00:05:44,460
or areas across your environment?

164
00:05:44,460 --> 00:05:45,293
And then they even give it

165
00:05:45,293 --> 00:05:47,470
a ton of different references as well.

166
00:05:47,470 --> 00:05:48,960
So hands down,

167
00:05:48,960 --> 00:05:50,909
check it out if you haven't already,

168
00:05:50,910 --> 00:05:52,660
it's a fantastic resource for this.

169
00:05:54,700 --> 00:05:58,390
Recommended pre-requisites
for threat hunting.

170
00:05:58,390 --> 00:05:59,500
I know this is just my opinion,

171
00:05:59,500 --> 00:06:02,150
some of you network packet
guys might disagree,

172
00:06:02,150 --> 00:06:06,200
but I do believe endpoint
visibility is absolutely critical.

173
00:06:06,200 --> 00:06:09,750
Continuously collecting program execution,

174
00:06:09,750 --> 00:06:10,590
network connections,

175
00:06:10,590 --> 00:06:12,890
registry activity, file activity.

176
00:06:12,890 --> 00:06:14,450
As you're collecting all this data

177
00:06:14,450 --> 00:06:18,710
it just becomes a dating
mining capability.

178
00:06:18,710 --> 00:06:20,500
Allows you to then drill down

179
00:06:20,500 --> 00:06:22,800
and pivot off of all
this information that's

180
00:06:22,800 --> 00:06:24,770
being collected across your enterprise.

181
00:06:24,770 --> 00:06:27,180
And that stim check hasn't come in yet,

182
00:06:27,180 --> 00:06:28,060
and you're on a budget,

183
00:06:28,060 --> 00:06:30,540
you can hit that Sysmon
tool because it's free.

184
00:06:30,540 --> 00:06:32,510
Sysmon is absolutely fantastic as well,

185
00:06:32,510 --> 00:06:33,770
I highly recommend it.

186
00:06:33,770 --> 00:06:36,430
If you haven't had a chance
to download that tool

187
00:06:36,430 --> 00:06:38,906
and really see all of its capabilities,

188
00:06:38,906 --> 00:06:40,360
it is fantastic.

189
00:06:40,360 --> 00:06:42,970
It can really solve this
use case in terms of

190
00:06:42,970 --> 00:06:44,813
gaining that end point visibility.

191
00:06:49,020 --> 00:06:50,099
Where do we begin?

192
00:06:50,100 --> 00:06:52,970
I do believe once you've gotten
that end point visibility

193
00:06:52,970 --> 00:06:55,070
you gotta start setting the traps.

194
00:06:55,070 --> 00:06:57,370
Identifying attack activity traits,

195
00:06:57,370 --> 00:06:59,380
developing these informational signatures,

196
00:06:59,380 --> 00:07:02,130
these lower fidelity type
signatures that allow you to pivot

197
00:07:02,130 --> 00:07:02,963
off this data

198
00:07:02,963 --> 00:07:04,540
and really start identifying

199
00:07:05,760 --> 00:07:08,310
some interesting behavior
in your environment.

200
00:07:08,310 --> 00:07:10,640
So getting these rules
deployed in your SIM

201
00:07:10,640 --> 00:07:12,130
and then start base lining.

202
00:07:12,130 --> 00:07:13,440
Understand your environment.

203
00:07:13,440 --> 00:07:15,410
Every environment is also very different,

204
00:07:15,410 --> 00:07:17,010
but once you start to identify

205
00:07:17,010 --> 00:07:19,560
and baseline what's normal
behavior environment,

206
00:07:19,560 --> 00:07:21,290
you can start to alert

207
00:07:21,290 --> 00:07:23,730
and trigger on things too that

208
00:07:23,730 --> 00:07:26,167
maybe are anomalous for your environment.

209
00:07:26,167 --> 00:07:27,563
And this is important too.

210
00:07:28,520 --> 00:07:31,359
Hunting is not high fidelity indicators.

211
00:07:31,360 --> 00:07:35,820
So if you enter an IOC that
is a high fidelity IOC,

212
00:07:35,820 --> 00:07:37,880
if this thing triggers you've
gotta immediately respond,

213
00:07:37,880 --> 00:07:38,870
this is something where you get

214
00:07:38,870 --> 00:07:40,913
your level one guys on immediately.

215
00:07:41,850 --> 00:07:44,020
But hunting from my perspective is

216
00:07:44,020 --> 00:07:45,590
something a little bit lower fidelity.

217
00:07:45,590 --> 00:07:47,030
It's seeking out unknown,

218
00:07:47,030 --> 00:07:49,849
things that you aren't aware
of in your environment.

219
00:07:49,850 --> 00:07:51,440
And it does require some base lining

220
00:07:51,440 --> 00:07:52,920
and it does require some pivoting.

221
00:07:52,920 --> 00:07:53,780
So I just wanna make sure

222
00:07:53,780 --> 00:07:55,400
that we delineate between the two.

223
00:07:55,400 --> 00:07:59,150
Because I do believe high fidelity IOC

224
00:07:59,150 --> 00:08:02,409
hunting in terms of
something triggering an alarm

225
00:08:02,410 --> 00:08:03,880
in your SIM that requires
immediate action,

226
00:08:03,880 --> 00:08:04,830
that's not hunting.

227
00:08:04,830 --> 00:08:07,789
That's sitting back waiting
for the alerts to trigger off.

228
00:08:07,790 --> 00:08:09,140
So we're gonna go into one of those

229
00:08:09,140 --> 00:08:11,360
lower fidelity type indicators

230
00:08:11,360 --> 00:08:13,410
or TTPs that you're gonna be looking for.

231
00:08:16,690 --> 00:08:18,260
So from a Sysmon perspective,

232
00:08:18,260 --> 00:08:19,093
what do we do?

233
00:08:19,093 --> 00:08:20,410
How do we configure this thing?

234
00:08:20,410 --> 00:08:22,720
Here's just an example.

235
00:08:22,720 --> 00:08:25,740
Sysmon version 13.01 is out there.

236
00:08:25,740 --> 00:08:28,320
It does have the ability
to trigger on rules.

237
00:08:28,320 --> 00:08:30,430
Trigger on rules is also very important

238
00:08:30,430 --> 00:08:32,559
in this whole threat hunting game I think.

239
00:08:32,559 --> 00:08:35,150
So Sysmon can collect
all this great telemetry

240
00:08:35,150 --> 00:08:35,982
off of the endpoint.

241
00:08:35,982 --> 00:08:37,459
Like what processes ran?

242
00:08:37,460 --> 00:08:38,593
Where did it run from?

243
00:08:39,460 --> 00:08:41,520
But if you wanna start
understanding context

244
00:08:41,520 --> 00:08:44,380
or enriching that particular data,

245
00:08:44,380 --> 00:08:46,890
it's important to also then
create these signatures.

246
00:08:46,890 --> 00:08:48,120
So here's just an example.

247
00:08:48,120 --> 00:08:49,080
We have a rule here,

248
00:08:49,080 --> 00:08:50,750
account discovery, something that's out

249
00:08:50,750 --> 00:08:52,120
on the MITRE ATT&CK Framework.

250
00:08:52,120 --> 00:08:53,370
So you can enter the rule name,

251
00:08:53,370 --> 00:08:54,203
account discovery,

252
00:08:54,203 --> 00:08:55,699
and then you enter a condition.

253
00:08:55,700 --> 00:08:56,533
In this particular case,

254
00:08:56,533 --> 00:08:58,100
I just have a quick example.

255
00:08:58,100 --> 00:08:59,950
I know there's a lot
more to account discover

256
00:08:59,950 --> 00:09:02,490
than just this but if in the CommandLine

257
00:09:02,490 --> 00:09:05,060
contains wmic useraccount get/ALL,

258
00:09:05,060 --> 00:09:07,170
that means somebody is trying to identify

259
00:09:07,170 --> 00:09:10,000
the list of accounts on
that particular machine.

260
00:09:10,000 --> 00:09:12,700
This could be an interesting
indicator for your environment.

261
00:09:12,700 --> 00:09:15,660
How often does that occur
for your enterprise?

262
00:09:15,660 --> 00:09:17,719
If it's something that
happens less frequently

263
00:09:17,720 --> 00:09:19,700
than maybe it's something you
need to quickly investigate

264
00:09:19,700 --> 00:09:21,730
or maybe it occurs all the time

265
00:09:21,730 --> 00:09:22,630
and you wanna start looking

266
00:09:22,630 --> 00:09:23,910
and base lining the times

267
00:09:23,910 --> 00:09:25,980
or the days when this type
of things are occurring.

268
00:09:25,980 --> 00:09:29,170
Or the parent application that
is executing these commands.

269
00:09:29,170 --> 00:09:31,349
All these different
elements can add up to a,

270
00:09:31,350 --> 00:09:33,700
I think an interesting
threat hunting campaign.

271
00:09:37,200 --> 00:09:38,750
Here's the hunting signature one.

272
00:09:38,750 --> 00:09:41,050
There's just a couple
examples I'm gonna go through.

273
00:09:41,050 --> 00:09:42,829
Account discovery is an awesome one.

274
00:09:42,830 --> 00:09:43,680
We talked a little bit about that,

275
00:09:43,680 --> 00:09:44,979
I showed you a quick example.

276
00:09:44,980 --> 00:09:46,510
But this is some additional

277
00:09:47,520 --> 00:09:48,420
things that you wanna look for.

278
00:09:48,420 --> 00:09:50,579
So if the process equals cmd.exe,

279
00:09:50,579 --> 00:09:51,411
powershell.exe, cmdkey,

280
00:09:52,927 --> 00:09:55,130
and the command equals
any of those other things

281
00:09:55,130 --> 00:09:55,990
that you see below there.

282
00:09:55,990 --> 00:09:57,420
Like net user,

283
00:09:57,420 --> 00:09:59,500
even that sneaky little
command like doing a dir

284
00:09:59,500 --> 00:10:00,770
on the C users,

285
00:10:00,770 --> 00:10:02,090
we're watching you bad guys,

286
00:10:02,090 --> 00:10:02,923
we're watching you.

287
00:10:02,923 --> 00:10:05,000
I think this is a fantastic rule.

288
00:10:05,000 --> 00:10:07,930
It's something that's
not always gonna yield

289
00:10:07,930 --> 00:10:10,069
fruitful in terms of identifying

290
00:10:10,070 --> 00:10:12,000
maybe a nation state threat
actor in your environment,

291
00:10:12,000 --> 00:10:12,880
but it can.

292
00:10:12,880 --> 00:10:14,630
There's always gonna be that one time

293
00:10:14,630 --> 00:10:15,820
when it actually does

294
00:10:15,820 --> 00:10:17,020
and I think this is important.

295
00:10:17,020 --> 00:10:18,510
And I think it's in critical

296
00:10:18,510 --> 00:10:20,723
to collect this type of enrichment.

297
00:10:23,120 --> 00:10:25,270
Number two, account creation.

298
00:10:25,270 --> 00:10:28,400
How often are accounts being
created in your environment.

299
00:10:28,400 --> 00:10:29,740
So if you see

300
00:10:29,740 --> 00:10:30,640
items like net.exe,

301
00:10:30,640 --> 00:10:34,610
powershell.exe, dsadd executing
these types of commands

302
00:10:34,610 --> 00:10:35,860
like net user/add,

303
00:10:35,860 --> 00:10:38,410
new user, local user group.

304
00:10:38,410 --> 00:10:41,069
All these create an
account on the end point.

305
00:10:41,070 --> 00:10:44,550
And from an adversarial
perspective this is persistence.

306
00:10:44,550 --> 00:10:47,260
This allows the adversary to
add an account to the machine,

307
00:10:47,260 --> 00:10:49,290
allows them to have possibly
administrative rights

308
00:10:49,290 --> 00:10:51,740
or privileges to that device
so that they can come back

309
00:10:51,740 --> 00:10:53,960
and leverage that new
account that's been created.

310
00:10:53,960 --> 00:10:55,720
I see this countless times

311
00:10:55,720 --> 00:10:57,880
during incident response investigations.

312
00:10:57,880 --> 00:11:01,418
So I do think this is
also very important to add

313
00:11:01,418 --> 00:11:03,030
to your arsenal in terms of

314
00:11:03,030 --> 00:11:04,780
creating threat hunting signatures.

315
00:11:08,590 --> 00:11:10,810
Hunting Sig number three,

316
00:11:10,810 --> 00:11:11,959
Windows admin shares.

317
00:11:11,960 --> 00:11:13,240
I think this is very important.

318
00:11:13,240 --> 00:11:15,520
Adversaries may leverage network shares

319
00:11:15,520 --> 00:11:17,150
to move laterally across environment.

320
00:11:17,150 --> 00:11:19,030
They also may be using it to push

321
00:11:19,030 --> 00:11:20,209
or transfer files,

322
00:11:20,210 --> 00:11:23,270
executables, their tools

323
00:11:23,270 --> 00:11:25,890
and information across the environment.

324
00:11:25,890 --> 00:11:29,140
I had a particular investigation
a couple of years ago,

325
00:11:29,140 --> 00:11:31,800
there was a managed services
environment that was also

326
00:11:31,800 --> 00:11:34,790
providing services to this other company.

327
00:11:34,790 --> 00:11:36,980
And this managed services
environment got hit.

328
00:11:36,980 --> 00:11:37,813
They were attacked,

329
00:11:37,813 --> 00:11:40,150
they were infiltrated by
a nation state adversary.

330
00:11:40,150 --> 00:11:42,461
They leveraged that trusted connection

331
00:11:42,461 --> 00:11:43,640
between the MSP

332
00:11:43,640 --> 00:11:45,850
and that customer.

333
00:11:45,850 --> 00:11:48,040
And they were moving laterally
into that environment

334
00:11:48,040 --> 00:11:49,530
but they were transferring files

335
00:11:49,530 --> 00:11:51,319
and binaries and executables

336
00:11:51,320 --> 00:11:53,645
over these windows admin shares.

337
00:11:53,645 --> 00:11:58,130
So monitoring this type of
activity can be very critical

338
00:11:58,130 --> 00:11:59,420
because we see this time

339
00:11:59,420 --> 00:12:01,091
and time again too during incidents.

340
00:12:01,091 --> 00:12:03,400
We see adversaries moving
across the environment

341
00:12:03,400 --> 00:12:04,530
and pushing their tools

342
00:12:04,530 --> 00:12:05,656
and malware as well.

343
00:12:05,657 --> 00:12:08,330
And this could be a fantastic
indicator to pick up on

344
00:12:08,330 --> 00:12:10,730
or also just to be used to hunt

345
00:12:10,730 --> 00:12:12,840
across your environment to see if you have

346
00:12:12,840 --> 00:12:15,793
an incident ongoing
within your enterprise.

347
00:12:18,780 --> 00:12:20,483
Hunting Sig number four,

348
00:12:21,450 --> 00:12:24,310
adversaries may clear up after themselves.

349
00:12:24,310 --> 00:12:25,750
We see this all the time too.

350
00:12:25,750 --> 00:12:27,956
Windows event logs being cleared

351
00:12:27,956 --> 00:12:31,880
with a wevtutil using that cl command

352
00:12:31,880 --> 00:12:33,910
to actually clear the event logs.

353
00:12:33,910 --> 00:12:34,870
I don't know,

354
00:12:34,870 --> 00:12:36,110
you could argue with me on this one.

355
00:12:36,110 --> 00:12:39,100
This is probably a fairly
high fidelity type indicator.

356
00:12:39,100 --> 00:12:40,600
If you're seeing this in your environment,

357
00:12:40,600 --> 00:12:43,920
this is probably something you
wanna immediately respond to.

358
00:12:43,920 --> 00:12:44,752
But maybe not,

359
00:12:44,753 --> 00:12:45,730
maybe this is something that you have

360
00:12:45,730 --> 00:12:46,830
in a powershell script

361
00:12:46,830 --> 00:12:48,850
and it's clearing
something for some reason.

362
00:12:48,850 --> 00:12:50,330
Don't do this by the way.

363
00:12:50,330 --> 00:12:53,690
But I have seen some IT
admins actually do this.

364
00:12:53,690 --> 00:12:54,790
But it's important right

365
00:12:54,790 --> 00:12:55,969
to identify this behavior

366
00:12:55,970 --> 00:12:58,160
and then also to respond accordingly.

367
00:12:58,160 --> 00:13:01,089
This is another fantastic
rule looking for this,

368
00:13:01,090 --> 00:13:02,290
this is a command regex,

369
00:13:02,290 --> 00:13:04,099
so make sure that you
accommodate for that.

370
00:13:04,100 --> 00:13:06,680
'Cause you're looking
for cl of something else.

371
00:13:06,680 --> 00:13:08,709
So when they run this wevtutil,

372
00:13:08,710 --> 00:13:11,090
they're gonna clear something
like an application log,

373
00:13:11,090 --> 00:13:12,370
a security event log,

374
00:13:12,370 --> 00:13:14,730
maybe the remote desktop log.

375
00:13:14,730 --> 00:13:16,817
We see that happen a lot as well.

376
00:13:16,817 --> 00:13:19,033
Another good signature to leverage.

377
00:13:21,720 --> 00:13:23,950
Executable launch from
an extracted archive.

378
00:13:23,950 --> 00:13:25,720
There's a couple of these examples here.

379
00:13:25,720 --> 00:13:28,010
So let's say you're an
end-user at the computer,

380
00:13:28,010 --> 00:13:29,260
you receive an email

381
00:13:29,260 --> 00:13:32,420
from some source of
suspicious email account

382
00:13:32,420 --> 00:13:33,579
and there's an attachment,

383
00:13:33,580 --> 00:13:34,830
there's an archive,

384
00:13:34,830 --> 00:13:36,290
a compressed file.

385
00:13:36,290 --> 00:13:38,480
Your end user downloads
that particular file,

386
00:13:38,480 --> 00:13:39,313
opens it up

387
00:13:39,313 --> 00:13:41,653
and executes whatever's inside.

388
00:13:42,500 --> 00:13:45,530
This is one of the most
common threat actor

389
00:13:45,530 --> 00:13:47,770
entrances that I've seen
over the last 15 years,

390
00:13:47,770 --> 00:13:49,370
it's phishing.

391
00:13:49,370 --> 00:13:51,100
This type of activity though,

392
00:13:51,100 --> 00:13:53,800
looking for and hunting
through this type of behavior

393
00:13:53,800 --> 00:13:57,469
can be very fruitful in
terms of what you identify.

394
00:13:57,470 --> 00:14:00,220
So if you see parent
processes like explorer,

395
00:14:00,220 --> 00:14:01,580
or winzip or winrar

396
00:14:01,580 --> 00:14:04,560
or 7zip executing a program

397
00:14:04,560 --> 00:14:07,089
out of those particular
directories that I have there

398
00:14:07,090 --> 00:14:08,770
in the file path regex.

399
00:14:08,770 --> 00:14:11,960
That's an indication that
somebody clicked on an attachment,

400
00:14:11,960 --> 00:14:13,040
they downloaded it to their desktop

401
00:14:13,040 --> 00:14:15,540
and they opened up what's inside of it.

402
00:14:15,540 --> 00:14:17,880
Unfortunately, we only can do
so much with our end-users.

403
00:14:17,880 --> 00:14:20,740
We can provide them a ton
of security awareness.

404
00:14:20,740 --> 00:14:22,740
We can tell them not to
click on suspicious links

405
00:14:22,740 --> 00:14:24,980
and attachments but at the end of the day

406
00:14:24,980 --> 00:14:26,800
they still seem to do it.

407
00:14:26,800 --> 00:14:29,800
So I just think it's
important to also be prepared

408
00:14:29,800 --> 00:14:31,550
and hunt for this type of behavior.

409
00:14:34,930 --> 00:14:36,209
All right (indistinct).

410
00:14:36,210 --> 00:14:37,660
That's my job, impression.

411
00:14:37,660 --> 00:14:38,959
This is where we wanna go.

412
00:14:38,960 --> 00:14:42,240
250 plus alerts, maybe more.

413
00:14:42,240 --> 00:14:43,857
That allows you to pivot off this data

414
00:14:43,857 --> 00:14:46,770
and to start hunting
across your enterprise.

415
00:14:46,770 --> 00:14:48,550
There's a couple examples
you see on the left here,

416
00:14:48,550 --> 00:14:51,250
looking for automated
collection commands executing,

417
00:14:51,250 --> 00:14:54,073
executing commands that
collect credentials and files.

418
00:14:55,250 --> 00:14:57,780
Getting to this type of profile set though

419
00:14:57,780 --> 00:14:59,810
will allow you to build

420
00:14:59,810 --> 00:15:02,630
that information, that data mining event

421
00:15:02,630 --> 00:15:05,189
that allows you to pivot off that data.

422
00:15:05,190 --> 00:15:07,670
once you start triggering
on all these different

423
00:15:07,670 --> 00:15:09,329
types of events in your environment,

424
00:15:09,330 --> 00:15:12,260
you can start every single
day picking off a rule.

425
00:15:12,260 --> 00:15:14,680
Rule by rule identifying what happened

426
00:15:14,680 --> 00:15:15,699
after this rule triggered?

427
00:15:15,700 --> 00:15:18,473
How many end points did this occur on?

428
00:15:18,473 --> 00:15:19,770
Is there anything suspicious

429
00:15:19,770 --> 00:15:21,430
about those commands that executed

430
00:15:21,430 --> 00:15:23,089
from that particular rule that triggered?

431
00:15:23,090 --> 00:15:25,150
This is, I think your ultimate goal.

432
00:15:25,150 --> 00:15:27,920
Is to get to a set where
you have a nice set

433
00:15:27,920 --> 00:15:30,199
of enrichment information
that allows you to pivot

434
00:15:30,200 --> 00:15:31,100
through that data.

435
00:15:33,970 --> 00:15:34,970
It's hunting time.

436
00:15:34,970 --> 00:15:36,010
Let's pick a rule, any rule.

437
00:15:36,010 --> 00:15:36,843
As I said,

438
00:15:36,843 --> 00:15:38,459
once you get to this state

439
00:15:38,460 --> 00:15:41,796
where you can start picking
rules to drill into,

440
00:15:41,796 --> 00:15:45,340
this is where you start beginning to hunt.

441
00:15:45,340 --> 00:15:46,173
In this particular case,

442
00:15:46,173 --> 00:15:48,550
I chose modification of the AutoRun Key.

443
00:15:48,550 --> 00:15:51,709
The AutoRun Key is a
location on the end point

444
00:15:51,710 --> 00:15:53,410
that allows persistence to occur.

445
00:15:53,410 --> 00:15:57,240
It allows the malware to
naturally stay through reboots.

446
00:15:57,240 --> 00:15:58,730
When malware installs itself

447
00:15:58,730 --> 00:16:01,510
it loves to adjust some
of those AutoRun Keys.

448
00:16:01,510 --> 00:16:02,900
This could be a great point to look

449
00:16:02,900 --> 00:16:05,110
for that type of behavior
in your environment.

450
00:16:05,110 --> 00:16:05,943
In this particular case,

451
00:16:05,943 --> 00:16:09,290
we can see that an
AutoRun Key was adjusted,

452
00:16:09,290 --> 00:16:12,750
and it looks like it's gonna
execute this RealNetwork.exe

453
00:16:12,750 --> 00:16:15,980
out of this extremely
suspicious 9ur7v4 path.

454
00:16:19,760 --> 00:16:20,939
That's not normal.

455
00:16:20,940 --> 00:16:21,773
That's not gonna happen.

456
00:16:21,773 --> 00:16:25,530
So this particular one stands
out pretty, pretty well.

457
00:16:25,530 --> 00:16:27,010
But these are the types of indicators

458
00:16:27,010 --> 00:16:28,780
that you're gonna wanna start looking for.

459
00:16:28,780 --> 00:16:29,701
These are the types of

460
00:16:29,701 --> 00:16:33,370
persistence artifacts that
will ultimately lead to,

461
00:16:33,370 --> 00:16:36,012
I think a much larger investigation.

462
00:16:36,012 --> 00:16:38,459
Understanding where this also might occur

463
00:16:38,460 --> 00:16:40,410
across your entire enterprise.

464
00:16:40,410 --> 00:16:43,751
How many machines is exhibiting
this type of behavior?

465
00:16:43,751 --> 00:16:46,880
It's also very critical to scope out

466
00:16:46,880 --> 00:16:48,820
these indicators that you're identifying.

467
00:16:48,820 --> 00:16:50,300
Because if it's on one machine,

468
00:16:50,300 --> 00:16:53,260
it's more than likely that
it could be on two machines,

469
00:16:53,260 --> 00:16:55,069
10 machines, possibly 20.

470
00:16:55,070 --> 00:16:56,100
I've had investigations

471
00:16:56,100 --> 00:16:57,830
or cases where it's been upward

472
00:16:57,830 --> 00:17:00,670
of a hundred devices including servers.

473
00:17:00,670 --> 00:17:03,829
Where we see the same types
of artifacts being dropped.

474
00:17:03,830 --> 00:17:07,329
And if you don't scope out
your intrusion properly,

475
00:17:07,329 --> 00:17:09,389
you're leaving potentially

476
00:17:09,390 --> 00:17:11,790
malware root get back doors behind.

477
00:17:11,790 --> 00:17:14,420
And if there's a backdoor
network connection

478
00:17:14,420 --> 00:17:15,329
out to some command

479
00:17:15,329 --> 00:17:18,060
and control infrastructure
that you're not aware of,

480
00:17:18,060 --> 00:17:20,190
that's only gonna allow the
bad guys to come back in.

481
00:17:20,190 --> 00:17:21,604
So it's also very important

482
00:17:21,604 --> 00:17:23,950
to also scope out your intrusion

483
00:17:23,950 --> 00:17:27,363
and understand where all
you're seeing these indicators.

484
00:17:29,610 --> 00:17:30,879
So hunting lateral movement.

485
00:17:30,880 --> 00:17:32,390
I mentioned this a little bit earlier.

486
00:17:32,390 --> 00:17:34,807
But who's executing
psexec in my environment?

487
00:17:34,807 --> 00:17:37,227
And where is psexec even executing from?

488
00:17:37,227 --> 00:17:39,430
This is just a simple example,

489
00:17:39,430 --> 00:17:41,610
but if you start base
lining your environment

490
00:17:41,610 --> 00:17:44,679
and building out the directories
of where these utilities

491
00:17:44,680 --> 00:17:46,960
are typically being ran by IT admins

492
00:17:46,960 --> 00:17:49,050
or people within your company,

493
00:17:49,050 --> 00:17:51,700
you start to see some
interesting behaviors.

494
00:17:51,700 --> 00:17:54,470
Things that might stand out like p.exe

495
00:17:54,470 --> 00:17:55,920
executing out of a temp directory

496
00:17:55,920 --> 00:17:58,320
and that turns out to be psexec.

497
00:17:58,320 --> 00:18:00,240
That smells like a bad guy to me.

498
00:18:00,240 --> 00:18:01,560
Bad guys are very lazy.

499
00:18:01,560 --> 00:18:03,590
They like to name their
binaries single character,

500
00:18:03,590 --> 00:18:04,860
double character binaries.

501
00:18:04,860 --> 00:18:07,250
But then when it's executing
out of a temporary directory

502
00:18:07,250 --> 00:18:09,730
it just makes it even
that more suspicious.

503
00:18:09,730 --> 00:18:12,350
So it's very important to look
for these types of things.

504
00:18:12,350 --> 00:18:14,209
In the rule itself that
I have appear in the top,

505
00:18:14,210 --> 00:18:17,480
I say Processes=psexec.exe

506
00:18:17,480 --> 00:18:19,650
or the product name.

507
00:18:19,650 --> 00:18:21,880
So the metadata within
that particular binary

508
00:18:21,880 --> 00:18:23,640
is sysinternals psexec.

509
00:18:23,640 --> 00:18:25,500
That's how you identify when

510
00:18:25,500 --> 00:18:27,220
adversaries are attempting to masquerade

511
00:18:27,220 --> 00:18:29,130
or rename files.

512
00:18:29,130 --> 00:18:31,540
But what's nice is some of
that metadata doesn't change,

513
00:18:31,540 --> 00:18:33,230
unless of course they recompile it.

514
00:18:33,230 --> 00:18:34,860
But some of that metadata
that doesn't change.

515
00:18:34,860 --> 00:18:37,010
So it can really help you identify when

516
00:18:37,010 --> 00:18:38,943
someone's done something sneaky.

517
00:18:41,980 --> 00:18:44,100
This is my favorite one.

518
00:18:44,100 --> 00:18:46,740
Hunting network connections.

519
00:18:46,740 --> 00:18:48,410
I have such a field day doing this.

520
00:18:48,410 --> 00:18:50,660
I could literally do this all week.

521
00:18:50,660 --> 00:18:52,320
When you start to look at

522
00:18:52,320 --> 00:18:54,350
outbound network connections by binaries.

523
00:18:54,350 --> 00:18:56,980
And then even if you pair that
with the signature status,

524
00:18:56,980 --> 00:18:57,813
is it signed?

525
00:18:57,813 --> 00:18:58,646
Is it unsigned?

526
00:18:58,646 --> 00:19:00,290
Sometimes that doesn't matter as much.

527
00:19:00,290 --> 00:19:03,310
You can really find some bad
stuff in the environment.

528
00:19:03,310 --> 00:19:05,110
I remember when I first started out

529
00:19:05,110 --> 00:19:07,860
conducting threat hunting back in 2007,

530
00:19:07,860 --> 00:19:10,479
I didn't have all these
cool awesome tools,

531
00:19:10,480 --> 00:19:12,160
I didn't have Twitter out there

532
00:19:12,160 --> 00:19:14,520
tweeting about the
latest hunting playbooks.

533
00:19:14,520 --> 00:19:17,990
We had to figure out how to
really go about doing this.

534
00:19:17,990 --> 00:19:20,200
We actually collected all the proxy logs

535
00:19:20,200 --> 00:19:21,033
for the environment.

536
00:19:21,033 --> 00:19:23,820
So every single outbound
network connection that was made

537
00:19:23,820 --> 00:19:27,540
we'd have sent to a
centralized Linux server.

538
00:19:27,540 --> 00:19:28,800
Once I had it on that Linux server

539
00:19:28,800 --> 00:19:32,700
I started creating these grep-o commands

540
00:19:32,700 --> 00:19:35,640
to search through this this log set.

541
00:19:35,640 --> 00:19:38,560
Identifying anytime there was
outbound network connections

542
00:19:38,560 --> 00:19:39,580
maybe once a day

543
00:19:39,580 --> 00:19:41,210
or maybe it was once a month

544
00:19:41,210 --> 00:19:42,610
or twice a day.

545
00:19:42,610 --> 00:19:45,110
Looking for patterns of behavior.

546
00:19:45,110 --> 00:19:47,320
And this actually led to a couple of

547
00:19:47,320 --> 00:19:48,669
state sponsored investigations

548
00:19:48,670 --> 00:19:50,081
just doing that one thing,

549
00:19:50,081 --> 00:19:52,100
looking at that network logs.

550
00:19:52,100 --> 00:19:54,550
But I think the negative,

551
00:19:54,550 --> 00:19:56,810
the downside effect of
that is once you identify

552
00:19:56,810 --> 00:19:58,649
that there is an outbound
network connection

553
00:19:58,650 --> 00:20:00,640
you gotta then pair it
back to the process,

554
00:20:00,640 --> 00:20:02,060
the end points that are doing it.

555
00:20:02,060 --> 00:20:04,810
That's why I absolutely
love endpoint data.

556
00:20:04,810 --> 00:20:06,129
Because when you can see

557
00:20:06,130 --> 00:20:08,880
the offending process like wscript.exe

558
00:20:08,880 --> 00:20:10,920
is making an outbound
network connection call

559
00:20:10,920 --> 00:20:12,214
to this particular domain

560
00:20:12,214 --> 00:20:14,159
or this particular IP address,

561
00:20:14,160 --> 00:20:16,080
it actually makes your job a lot easier.

562
00:20:16,080 --> 00:20:19,270
Versus just sitting at that network level.

563
00:20:19,270 --> 00:20:20,770
Not saying that you can't do it there,

564
00:20:20,770 --> 00:20:22,629
but it does make it a lot easier.

565
00:20:22,630 --> 00:20:25,660
So hunting for network connections can be,

566
00:20:25,660 --> 00:20:26,990
I think very fruitful.

567
00:20:26,990 --> 00:20:27,823
In this particular case,

568
00:20:27,823 --> 00:20:31,010
I have an example where
wscript is executing

569
00:20:31,010 --> 00:20:33,500
this text file out of the
program data directory.

570
00:20:33,500 --> 00:20:35,420
It's actually a JavaScript
that's doing that.

571
00:20:35,420 --> 00:20:37,740
So this is a no-no.

572
00:20:37,740 --> 00:20:38,850
You're never gonna see this.

573
00:20:38,850 --> 00:20:40,530
This one actually stands out a lot more,

574
00:20:40,530 --> 00:20:43,240
but when you start looking
at frequency analysis,

575
00:20:43,240 --> 00:20:45,670
how many times do we see
these outbound network

576
00:20:45,670 --> 00:20:49,230
connection calls by particular processes?

577
00:20:49,230 --> 00:20:51,873
I think it's a very effective
threat hunting method.

578
00:20:54,720 --> 00:20:56,510
Hunting for web shells.

579
00:20:56,510 --> 00:20:59,250
This is another favorite of mine.

580
00:20:59,250 --> 00:21:02,780
If you see IIS servers like tomcat,

581
00:21:02,780 --> 00:21:07,550
or w3wp.exe, or apache
executing a command shell

582
00:21:07,550 --> 00:21:08,383
on a server,

583
00:21:08,383 --> 00:21:10,170
there's a pretty good chance that

584
00:21:10,170 --> 00:21:12,800
there's a web shell on that bad boy.

585
00:21:12,800 --> 00:21:13,633
What are web shells?

586
00:21:13,633 --> 00:21:15,640
It's a piece of code that executes on

587
00:21:16,730 --> 00:21:18,110
an IAS server.

588
00:21:18,110 --> 00:21:19,620
And allows them to interact

589
00:21:19,620 --> 00:21:21,000
with the underlying operating system.

590
00:21:21,000 --> 00:21:23,420
So executing commands
on the operating system.

591
00:21:23,420 --> 00:21:25,980
In this particular example
that you see below here,

592
00:21:25,980 --> 00:21:28,030
you can see that they're
changing directories

593
00:21:28,030 --> 00:21:31,389
from Inetpub but they're also

594
00:21:31,390 --> 00:21:32,630
executing something there on the end.

595
00:21:32,630 --> 00:21:33,610
So can you pick up on

596
00:21:33,610 --> 00:21:34,939
the type of web show
that we're doing here?

597
00:21:34,940 --> 00:21:36,500
So this is a cd&echo,

598
00:21:36,500 --> 00:21:38,780
it's actually the China Chopper.

599
00:21:38,780 --> 00:21:39,613
Don't hate me,

600
00:21:39,613 --> 00:21:41,040
I didn't come up with the
name the China Chopper

601
00:21:41,040 --> 00:21:43,409
but that is the name of
this particular web shell.

602
00:21:43,410 --> 00:21:44,610
This is an indicator.

603
00:21:44,610 --> 00:21:46,090
Looking for these types of indicators,

604
00:21:46,090 --> 00:21:48,230
once again can prove to be very,

605
00:21:48,230 --> 00:21:50,620
very useful when you're identifying

606
00:21:50,620 --> 00:21:53,620
any sort of anomalous behavior
from your server environment.

607
00:21:58,670 --> 00:22:01,500
Let's go into some advanced
threat hunting use cases.

608
00:22:01,500 --> 00:22:03,110
We've talked about some one-on-one,

609
00:22:03,110 --> 00:22:04,260
what does it all mean?

610
00:22:04,260 --> 00:22:05,500
What is threat hunting?

611
00:22:05,500 --> 00:22:07,420
What skills are required?

612
00:22:07,420 --> 00:22:10,070
Once you've built up these skill sets

613
00:22:10,070 --> 00:22:11,480
of looking through the data

614
00:22:11,480 --> 00:22:14,090
and identifying suspicious
anomalous behavior,

615
00:22:14,090 --> 00:22:15,679
once you become familiar with

616
00:22:15,680 --> 00:22:16,840
the windows operating system

617
00:22:16,840 --> 00:22:17,673
or the Linux

618
00:22:17,673 --> 00:22:21,150
or OSX, you wanna take
it to the next level.

619
00:22:21,150 --> 00:22:22,860
Only so much you can do sometimes pivoting

620
00:22:22,860 --> 00:22:24,673
off of all these events and alerts.

621
00:22:25,640 --> 00:22:27,330
Now, you wanna be extremely proactive

622
00:22:27,330 --> 00:22:28,210
and really go out

623
00:22:28,210 --> 00:22:30,100
and start collecting some
additional artifacts.

624
00:22:30,100 --> 00:22:32,122
We're talking a little
bit about that right now.

625
00:22:34,010 --> 00:22:38,120
Shimcache hunting, if you
haven't done this you need to.

626
00:22:38,120 --> 00:22:40,429
So the Application Compatibility Cache,

627
00:22:40,430 --> 00:22:45,160
this stores literally a
history of all the processes

628
00:22:45,160 --> 00:22:47,090
that have executed on
a particular machine.

629
00:22:47,090 --> 00:22:49,610
So forensically, you can
go out into your enterprise

630
00:22:49,610 --> 00:22:52,560
and say, "Hey, has this
particular program executed

631
00:22:52,560 --> 00:22:56,870
ever across my environment
on any particular date?"

632
00:22:56,870 --> 00:22:58,649
And this method

633
00:22:58,650 --> 00:23:02,010
and this approach has proven
extremely helpful to us

634
00:23:02,010 --> 00:23:04,120
during a multiple campaigns.

635
00:23:04,120 --> 00:23:05,770
In terms of identifying any sort of,

636
00:23:05,770 --> 00:23:08,580
either existing campaigns

637
00:23:08,580 --> 00:23:11,530
or things that have occurred
maybe a couple of years ago

638
00:23:11,530 --> 00:23:12,490
that are just important.

639
00:23:12,490 --> 00:23:14,100
It's always good to understand

640
00:23:14,100 --> 00:23:16,530
what adversaries are
targeting your environment?

641
00:23:16,530 --> 00:23:18,120
What sort of tools are executing?

642
00:23:18,120 --> 00:23:20,250
'Cause you wanna build up profiles

643
00:23:20,250 --> 00:23:21,910
on the groups that target you.

644
00:23:21,910 --> 00:23:24,770
Understanding your adversary is very,

645
00:23:24,770 --> 00:23:26,120
very important to this game.

646
00:23:26,120 --> 00:23:28,803
Because then you can
catch them a lot faster.

647
00:23:29,770 --> 00:23:31,580
It's minimizing that initial faction,

648
00:23:31,580 --> 00:23:33,790
the detection time as much as possible.

649
00:23:33,790 --> 00:23:36,639
This particular method is a
very good approach to that.

650
00:23:36,640 --> 00:23:37,473
You can use a tool from Mandiant

651
00:23:37,473 --> 00:23:39,899
or FireEye or whatever.

652
00:23:39,900 --> 00:23:41,577
It's called the Shimcache Parser.

653
00:23:41,577 --> 00:23:42,940
You can download this,

654
00:23:42,940 --> 00:23:45,620
once you've exported that
particular registry key.

655
00:23:45,620 --> 00:23:47,409
I put the whole registry
key down there below.

656
00:23:47,410 --> 00:23:50,190
You can have them all
come to a centralized box,

657
00:23:50,190 --> 00:23:52,420
have it parsed via the Shimcache Parser

658
00:23:52,420 --> 00:23:53,710
and then start going to town.

659
00:23:53,710 --> 00:23:55,860
This is what the data looks like.

660
00:23:55,860 --> 00:23:57,567
It gives you a plethora of information

661
00:23:57,567 --> 00:24:00,530
and it shows you all the
programs that have executed,

662
00:24:00,530 --> 00:24:01,950
the date and time.

663
00:24:01,950 --> 00:24:04,930
This information is extremely useful.

664
00:24:04,930 --> 00:24:05,763
in this particular case,

665
00:24:05,763 --> 00:24:06,770
I can identify,

666
00:24:06,770 --> 00:24:09,620
for example, mimikatz_trunk just executed.

667
00:24:09,620 --> 00:24:11,439
And if anyone knows what mimikatz is,

668
00:24:11,440 --> 00:24:13,030
that's a credential dumping program.

669
00:24:13,030 --> 00:24:15,860
So I can say back in 2014

670
00:24:15,860 --> 00:24:18,237
I had a credential dumping program problem

671
00:24:18,238 --> 00:24:19,350
in my environment.

672
00:24:19,350 --> 00:24:20,780
And then in 2016,

673
00:24:20,780 --> 00:24:22,360
I had a very similar problem.

674
00:24:22,360 --> 00:24:25,139
They also executed from
a very similar directory.

675
00:24:25,140 --> 00:24:26,610
Is this the same adversary?

676
00:24:26,610 --> 00:24:29,409
Is this similar type behavior
activity that's occurring?

677
00:24:29,410 --> 00:24:30,620
Yes, it was.

678
00:24:30,620 --> 00:24:32,610
This is a perfect example where

679
00:24:32,610 --> 00:24:34,370
you can go back in time

680
00:24:34,370 --> 00:24:35,689
and actually search

681
00:24:35,690 --> 00:24:37,740
to see if there's any,

682
00:24:37,740 --> 00:24:39,593
like I said, adversary traces.

683
00:24:41,380 --> 00:24:43,790
And then if you really wanna
get super crazy like me,

684
00:24:43,790 --> 00:24:46,100
you can create this cool
hunting dashboard in Splunk

685
00:24:46,100 --> 00:24:47,807
or any SIM that you guys have.

686
00:24:47,807 --> 00:24:49,100
And in Splunk,

687
00:24:49,100 --> 00:24:50,657
what you can do is
actually ingest this data.

688
00:24:50,657 --> 00:24:52,480
You can build all these
cool little panels,

689
00:24:52,480 --> 00:24:53,313
you can say,

690
00:24:53,313 --> 00:24:55,290
"Okay, I wanna look
across my Simcache output

691
00:24:55,290 --> 00:24:57,620
for single character
binaries that have executed

692
00:24:57,620 --> 00:24:59,629
or double character binaries.

693
00:24:59,630 --> 00:25:01,400
I wanna look for tools that have executed

694
00:25:01,400 --> 00:25:03,000
from a temporary directory."

695
00:25:03,000 --> 00:25:05,330
Or, "I wanna look for suspicious binaries

696
00:25:05,330 --> 00:25:08,610
that might've named itself
to look like SPC host

697
00:25:08,610 --> 00:25:11,332
or maybe the name of
the binary is 421.exe."

698
00:25:13,080 --> 00:25:16,730
So now you can actually start
to build a pivotable dashboard

699
00:25:16,730 --> 00:25:19,780
using this data that
you're collecting off of

700
00:25:19,780 --> 00:25:21,290
your end points.

701
00:25:21,290 --> 00:25:22,993
I think getting to this state,

702
00:25:24,050 --> 00:25:26,280
once again you start to get
to that more advanced state.

703
00:25:26,280 --> 00:25:27,220
You're being proactive.

704
00:25:27,220 --> 00:25:28,870
You're looking for
things that are occurring

705
00:25:28,870 --> 00:25:29,703
in your environment,

706
00:25:29,703 --> 00:25:30,660
whether it's historical

707
00:25:30,660 --> 00:25:31,820
or even current.

708
00:25:31,820 --> 00:25:34,713
You can identify some
very interesting behavior.

709
00:25:37,208 --> 00:25:38,380
AutoRuns hunting.

710
00:25:38,380 --> 00:25:40,640
Talked a little bit about
that in my earlier example.

711
00:25:40,640 --> 00:25:42,202
When you're looking at the AutoRuns key

712
00:25:42,202 --> 00:25:45,040
but let's say that you
don't have Sysmon deployed

713
00:25:45,040 --> 00:25:47,580
or you don't have any end point detection

714
00:25:47,580 --> 00:25:51,620
response type tool recording
all this telemetry, who cares?

715
00:25:51,620 --> 00:25:52,453
You can be proactive

716
00:25:52,453 --> 00:25:53,286
and still go out

717
00:25:53,286 --> 00:25:55,430
and look at what is actually executing

718
00:25:55,430 --> 00:25:56,760
out of the AutoRuns directory?

719
00:25:56,760 --> 00:25:59,435
So AutoRuns from Sysinternals tools,

720
00:25:59,435 --> 00:26:01,000
is a fantastic tool.

721
00:26:01,000 --> 00:26:02,130
You can execute the program,

722
00:26:02,130 --> 00:26:03,320
that's command right there.

723
00:26:03,320 --> 00:26:05,399
You can adjust the flags
to whatever you like

724
00:26:05,400 --> 00:26:07,040
but once you've outputted this data

725
00:26:07,040 --> 00:26:09,100
and have it all come to
a centralized location,

726
00:26:09,100 --> 00:26:11,159
then you can start parsing
through that information.

727
00:26:11,160 --> 00:26:12,150
You start analyzing it

728
00:26:12,150 --> 00:26:15,160
and looking for any
interesting type activity.

729
00:26:15,160 --> 00:26:18,040
You can also create this
crazy Splunk dashboard.

730
00:26:18,040 --> 00:26:18,873
In this particular case,

731
00:26:18,873 --> 00:26:20,820
I can instantly look at
all the different things

732
00:26:20,820 --> 00:26:22,790
that are occurring in my AutoRuns.

733
00:26:22,790 --> 00:26:25,409
Show me any time there's a
file that's not found on disc,

734
00:26:25,410 --> 00:26:27,890
however, there's an AutoRun entry of that.

735
00:26:27,890 --> 00:26:30,410
Show me times AutoRuns is with a toolbar

736
00:26:30,410 --> 00:26:32,510
or runs in the launch string.

737
00:26:32,510 --> 00:26:33,640
All these things

738
00:26:33,640 --> 00:26:37,220
or pieces of information can
be used to help guide you.

739
00:26:37,220 --> 00:26:39,260
So this is some interesting behavior.

740
00:26:39,260 --> 00:26:41,300
You don't wanna just bring all this data

741
00:26:41,300 --> 00:26:42,820
to one centralized repository

742
00:26:42,820 --> 00:26:44,669
and try figure out what do I do next?

743
00:26:44,670 --> 00:26:46,100
You wanna be thoughtful about it.

744
00:26:46,100 --> 00:26:47,659
You wanna know going into this,

745
00:26:47,660 --> 00:26:49,340
what do I wanna seek out?

746
00:26:49,340 --> 00:26:52,790
what sort of parts of
the AutoRun file path

747
00:26:52,790 --> 00:26:56,280
do I wanna look into to identify
maybe something suspicious.

748
00:26:56,280 --> 00:26:57,750
Once you start building out

749
00:26:57,750 --> 00:27:00,890
those different hypothesis
of things that you wanna seek

750
00:27:00,890 --> 00:27:02,870
within your hunting campaign,

751
00:27:02,870 --> 00:27:04,729
it's gonna make it that much easier.

752
00:27:04,730 --> 00:27:06,340
You're gonna be a lot more effective

753
00:27:06,340 --> 00:27:08,050
conducting these types of exercises

754
00:27:08,050 --> 00:27:09,060
and you're gonna be a lot more effective

755
00:27:09,060 --> 00:27:12,639
at finding things too versus
just looking all the data

756
00:27:12,640 --> 00:27:13,910
and drowning in that data.

757
00:27:13,910 --> 00:27:15,343
'Cause that's a big no-no.

758
00:27:18,440 --> 00:27:19,273
Yara hunting.

759
00:27:19,273 --> 00:27:20,780
This is quite possibly one of

760
00:27:21,784 --> 00:27:22,970
my most favorite tools.

761
00:27:22,970 --> 00:27:24,950
I don't know if you can
get any better than this.

762
00:27:24,950 --> 00:27:28,010
Yara, and you can create
your own custom signatures.

763
00:27:28,010 --> 00:27:30,890
You can identify specific
malware families.

764
00:27:30,890 --> 00:27:33,030
You can leverage a whole repository

765
00:27:33,030 --> 00:27:35,418
or dataset of signatures
that have been identified

766
00:27:35,418 --> 00:27:37,152
over all the different years

767
00:27:37,153 --> 00:27:38,720
from various threat hunters.

768
00:27:38,720 --> 00:27:41,480
And then seek out across
your enterprise any

769
00:27:41,480 --> 00:27:43,200
files that might match a trigger

770
00:27:43,200 --> 00:27:45,270
on those particular signatures.

771
00:27:45,270 --> 00:27:46,103
This is really,

772
00:27:46,103 --> 00:27:48,340
I think a very interesting approach

773
00:27:48,340 --> 00:27:49,990
when it comes to threat hunting.

774
00:27:49,990 --> 00:27:52,350
Because you can be very
targeted with this approach.

775
00:27:52,350 --> 00:27:56,389
You can focus on specific type indicators

776
00:27:56,390 --> 00:27:59,360
like maybe a specific malware
family that you wanna seek out

777
00:27:59,360 --> 00:28:01,780
or you can look for everything.

778
00:28:01,780 --> 00:28:02,710
Bring everything back

779
00:28:02,710 --> 00:28:06,590
and see is there any
existing malware that exists

780
00:28:06,590 --> 00:28:07,740
across my environment

781
00:28:07,740 --> 00:28:08,993
or any tools.

782
00:28:09,900 --> 00:28:10,733
A lot of times,

783
00:28:10,733 --> 00:28:12,210
sometimes when adversaries
come into an environment,

784
00:28:12,210 --> 00:28:14,450
they might drop a folder filled with tools

785
00:28:14,450 --> 00:28:17,200
and maybe they only execute one.

786
00:28:17,200 --> 00:28:18,680
There's a problem,

787
00:28:18,680 --> 00:28:20,360
from a threat hunting
perspective with that approach.

788
00:28:20,360 --> 00:28:24,750
Because you're only seeing
in the EDR telemetry

789
00:28:24,750 --> 00:28:26,580
programs that have possibly run.

790
00:28:26,580 --> 00:28:28,550
You might not see everything else.

791
00:28:28,550 --> 00:28:30,379
This is where you start to pick up

792
00:28:30,380 --> 00:28:31,213
all those additional indicators,

793
00:28:31,213 --> 00:28:33,010
files that are at rest.

794
00:28:33,010 --> 00:28:36,680
Files that might've been dropped
by a particular adversary.

795
00:28:36,680 --> 00:28:38,480
And I do think this is

796
00:28:38,480 --> 00:28:40,690
another critical component

797
00:28:40,690 --> 00:28:43,070
to the whole front hunting package.

798
00:28:43,070 --> 00:28:44,419
And here's just an example.

799
00:28:45,440 --> 00:28:46,707
Let's say your CISO's like,

800
00:28:46,707 --> 00:28:48,450
"Hey bro, or gal,

801
00:28:48,450 --> 00:28:50,350
or non-gender neutral."

802
00:28:50,350 --> 00:28:52,129
However, progressive your CISO is,

803
00:28:52,130 --> 00:28:53,387
if he's asking you these questions.

804
00:28:53,387 --> 00:28:56,470
"Do we have any Sunburst
malware existing out

805
00:28:56,470 --> 00:28:57,360
in my environment?"

806
00:28:57,360 --> 00:28:58,270
You can answer that question.

807
00:28:58,270 --> 00:28:59,103
You can be like,

808
00:28:59,103 --> 00:28:59,936
"No, we don't.

809
00:28:59,936 --> 00:29:01,580
I already checked it with my Yara scan."

810
00:29:01,580 --> 00:29:03,330
This is a perfect use case.

811
00:29:03,330 --> 00:29:05,889
Because FireEye, I
believe FireEye came out

812
00:29:05,890 --> 00:29:08,020
with a whole set of different signatures

813
00:29:08,020 --> 00:29:08,900
looking for Sunburst

814
00:29:08,900 --> 00:29:09,810
and Teardrop malware

815
00:29:09,810 --> 00:29:11,419
and Supernova malware.

816
00:29:11,420 --> 00:29:12,454
You can take those signatures,

817
00:29:12,454 --> 00:29:14,030
you can package them up,

818
00:29:14,030 --> 00:29:15,930
use Yara to then scan your enterprise

819
00:29:15,930 --> 00:29:17,660
and see if any of that exist.

820
00:29:17,660 --> 00:29:18,493
In this particular case,

821
00:29:18,493 --> 00:29:20,110
most likely you would
just scan the servers

822
00:29:20,110 --> 00:29:21,889
that are running

823
00:29:21,890 --> 00:29:23,890
the solar winds type software.

824
00:29:23,890 --> 00:29:25,190
But here's an example,

825
00:29:25,190 --> 00:29:26,050
where you can actually go out

826
00:29:26,050 --> 00:29:26,883
and be proactive

827
00:29:26,883 --> 00:29:28,230
and be able to answer

828
00:29:28,230 --> 00:29:29,063
back your CISO that,

829
00:29:29,063 --> 00:29:30,050
"No, we're not at risk."

830
00:29:30,050 --> 00:29:32,080
Or, "No there has been no traces

831
00:29:32,080 --> 00:29:34,820
or artifacts associated with a compromise

832
00:29:34,820 --> 00:29:36,200
in our particular environment."

833
00:29:36,200 --> 00:29:37,580
So getting to this level,

834
00:29:37,580 --> 00:29:40,330
or this state where you're being proactive

835
00:29:40,330 --> 00:29:41,750
and creating your own signature sets

836
00:29:41,750 --> 00:29:44,033
and scanning, I think is an awesome thing.

837
00:29:48,737 --> 00:29:50,800
"Do or Do Not... There is No Try"

838
00:29:50,800 --> 00:29:52,260
So let's go into this.

839
00:29:52,260 --> 00:29:54,610
Download the free utilities
that I discussed today.

840
00:29:54,610 --> 00:29:56,229
Become comfortable executing them,

841
00:29:56,230 --> 00:29:57,180
learning about them,

842
00:29:57,180 --> 00:29:59,200
get as much hands-on
experience as you possibly can.

843
00:29:59,200 --> 00:30:01,800
If you're just starting out in this game,

844
00:30:01,800 --> 00:30:02,919
there's no better advice.

845
00:30:02,920 --> 00:30:04,870
You gotta have hands-on experience

846
00:30:04,870 --> 00:30:07,199
to do well in this particular field.

847
00:30:07,200 --> 00:30:09,860
And some of the utilities that
I talked today are barn on

848
00:30:09,860 --> 00:30:13,629
some of the best at cost, free.

849
00:30:13,630 --> 00:30:15,340
I also recommend using a virtual machine

850
00:30:15,340 --> 00:30:16,730
to conduct a lot of these tests.

851
00:30:16,730 --> 00:30:19,500
Let's not use our
production systems please.

852
00:30:19,500 --> 00:30:21,140
Let's discover what programs might have

853
00:30:21,140 --> 00:30:23,620
historically ran on a particular program.

854
00:30:23,620 --> 00:30:24,919
Conduct these tests yourselves

855
00:30:24,920 --> 00:30:27,270
just to see what the output looks like.

856
00:30:27,270 --> 00:30:29,100
What programs might have
registered themselves

857
00:30:29,100 --> 00:30:30,240
to an AutoRun location?

858
00:30:30,240 --> 00:30:34,330
I think is important
to also train yourself

859
00:30:34,330 --> 00:30:37,060
and really start to build
this capability before

860
00:30:37,060 --> 00:30:38,669
you start going out into the enterprise

861
00:30:38,670 --> 00:30:40,270
and start pulling all this data.

862
00:30:41,780 --> 00:30:43,363
Become a master with that Sysmon agent.

863
00:30:43,363 --> 00:30:44,196
So once again,

864
00:30:44,196 --> 00:30:46,179
if you don't have an EDR tool,

865
00:30:46,180 --> 00:30:47,300
Sysmon is fantastic.

866
00:30:47,300 --> 00:30:48,456
It does all this stuff.

867
00:30:48,457 --> 00:30:52,730
And the visibility this tool
provides is absolutely amazing.

868
00:30:52,730 --> 00:30:54,977
So become useful with Sysmon,

869
00:30:56,050 --> 00:30:56,883
it's just one of the,

870
00:30:56,883 --> 00:30:57,716
I think one of the best

871
00:30:57,716 --> 00:30:59,949
in terms of collecting that telemetry.

872
00:30:59,950 --> 00:31:02,520
Also, begin to develop these
rules that we discussed.

873
00:31:02,520 --> 00:31:04,760
Align yourself with that
MITRE ATT&CK Framework,

874
00:31:04,760 --> 00:31:06,040
go to that website

875
00:31:06,040 --> 00:31:08,050
and learn about all those different areas

876
00:31:08,050 --> 00:31:10,570
that we discussed on that site.

877
00:31:10,570 --> 00:31:11,659
Drill down into each of them.

878
00:31:11,660 --> 00:31:14,202
Understand what's been
discovered in the past,

879
00:31:14,202 --> 00:31:17,750
what indicators and sections
do I need to then build into

880
00:31:17,750 --> 00:31:19,410
my profile set?

881
00:31:19,410 --> 00:31:21,500
So truly understanding the
MITRE ATT&CK Framework,

882
00:31:21,500 --> 00:31:23,200
I think is very important as well.

883
00:31:24,440 --> 00:31:26,440
And expand your scope right over time

884
00:31:26,440 --> 00:31:29,520
and start deploying these
tools to your enterprise.

885
00:31:29,520 --> 00:31:32,170
I always say acquire
permission first though,

886
00:31:32,170 --> 00:31:33,930
none of this ask for forgiveness later.

887
00:31:33,930 --> 00:31:34,790
I tried that one time.

888
00:31:34,790 --> 00:31:35,830
Sometimes they don't forgive.

889
00:31:35,830 --> 00:31:37,060
Sometimes they're actually very

890
00:31:37,060 --> 00:31:37,902
not very forgiving

891
00:31:37,902 --> 00:31:40,290
when you start messing
with production systems.

892
00:31:40,290 --> 00:31:42,030
So make sure that you ask for permission

893
00:31:42,030 --> 00:31:43,420
before you start going down this route.

894
00:31:43,420 --> 00:31:44,420
Have a project in place,

895
00:31:44,420 --> 00:31:46,030
make sure that people
have signed off on it.

896
00:31:46,030 --> 00:31:47,590
I'm not recommending during this talk

897
00:31:47,590 --> 00:31:48,699
to start running all these tools

898
00:31:48,700 --> 00:31:51,633
in all your machines without
doing that first of course.

899
00:31:52,790 --> 00:31:54,670
And then centralize your logs.

900
00:31:54,670 --> 00:31:57,640
You wanna centralize those
logs to a centralized location,

901
00:31:57,640 --> 00:32:00,010
it allows for much quicker analysis.

902
00:32:00,010 --> 00:32:01,591
'Cause this is what this is about.

903
00:32:01,591 --> 00:32:02,651
It's being able to quickly

904
00:32:02,652 --> 00:32:06,580
and analyze and be efficient
with your processes

905
00:32:06,580 --> 00:32:08,500
in terms of conducting front hunting.

906
00:32:08,500 --> 00:32:11,120
You don't wanna spend all day every day

907
00:32:11,120 --> 00:32:14,060
taking forever trying to
aggregate to a location

908
00:32:14,060 --> 00:32:15,310
and grepping across out of that.

909
00:32:15,310 --> 00:32:16,830
That is old school.

910
00:32:16,830 --> 00:32:17,850
We got SIMS now,

911
00:32:17,850 --> 00:32:18,820
we got free SIMS,

912
00:32:18,820 --> 00:32:21,750
we got all this stuff available
today to make our jobs,

913
00:32:21,750 --> 00:32:23,870
I think a lot easier.

914
00:32:23,870 --> 00:32:25,520
And then begin the hunt.

915
00:32:25,520 --> 00:32:26,353
Get out there

916
00:32:26,353 --> 00:32:27,200
and have a good time.

917
00:32:28,400 --> 00:32:29,233
So a new hope,

918
00:32:29,233 --> 00:32:30,590
what do we discuss about today?

919
00:32:30,590 --> 00:32:33,699
And really wrapping this
thing all up together.

920
00:32:33,700 --> 00:32:37,250
So threat hunting is a critical component

921
00:32:37,250 --> 00:32:39,590
to your overall cybersecurity program.

922
00:32:39,590 --> 00:32:43,500
In terms of getting sign-on

923
00:32:43,500 --> 00:32:45,730
and buy-in from the execs

924
00:32:45,730 --> 00:32:47,410
and especially the CISO,

925
00:32:47,410 --> 00:32:49,180
that is absolutely important.

926
00:32:49,180 --> 00:32:50,600
Because you want it to be a part of

927
00:32:50,600 --> 00:32:53,740
your overall cybersecurity
maturity program.

928
00:32:53,740 --> 00:32:55,540
You wanna get the necessary funding

929
00:32:55,540 --> 00:32:57,930
or support whether they're
buying new tools or not.

930
00:32:57,930 --> 00:32:58,763
It doesn't matter.

931
00:32:58,763 --> 00:33:00,790
You want that support though,

932
00:33:00,790 --> 00:33:02,159
conduct these types of exercises.

933
00:33:02,160 --> 00:33:03,810
Because being proactive

934
00:33:03,810 --> 00:33:07,070
and hunting for different attack activity

935
00:33:07,070 --> 00:33:08,730
is a lot better than sitting back

936
00:33:08,730 --> 00:33:12,365
and waiting for some
incident to occur, trust me.

937
00:33:12,365 --> 00:33:14,610
So make sure that it's a
part of your overall program.

938
00:33:14,610 --> 00:33:16,479
Do not become discouraged either.

939
00:33:16,480 --> 00:33:17,430
If you're spending days

940
00:33:17,430 --> 00:33:19,040
or weeks without finding anything,

941
00:33:19,040 --> 00:33:20,320
it doesn't matter.

942
00:33:20,320 --> 00:33:24,560
This helps continue develop
your skills over time.

943
00:33:24,560 --> 00:33:26,760
You're not gonna necessarily
find something on day one

944
00:33:26,760 --> 00:33:28,540
or even possibly day seven.

945
00:33:28,540 --> 00:33:30,120
But the more you do it,

946
00:33:30,120 --> 00:33:33,100
the more you become familiar
with the operating system,

947
00:33:33,100 --> 00:33:35,100
the more you become familiar with

948
00:33:35,100 --> 00:33:36,980
normal parent child relationships.

949
00:33:36,980 --> 00:33:39,150
Like this parent executed this child,

950
00:33:39,150 --> 00:33:40,970
is that legitimate?

951
00:33:40,970 --> 00:33:44,390
All of these tidbits of
information that you develop

952
00:33:44,390 --> 00:33:45,756
in your skillset you'll start to spot

953
00:33:45,756 --> 00:33:47,480
these things a lot quicker,

954
00:33:47,480 --> 00:33:51,090
a lot faster whenever you're doing these

955
00:33:51,090 --> 00:33:52,362
types of investigations.

956
00:33:53,717 --> 00:33:55,830
Threat hunting does not
require a massive budget.

957
00:33:55,830 --> 00:33:58,490
I've been saying this
throughout the whole thing,

958
00:33:58,490 --> 00:33:59,550
you don't need the latest

959
00:33:59,550 --> 00:34:01,060
and greatest security
technologies deployed,

960
00:34:01,060 --> 00:34:03,899
you can get this job done
too if you don't have that.

961
00:34:03,900 --> 00:34:06,100
So if you're strict on budget

962
00:34:06,100 --> 00:34:08,029
and you don't have any additional funds,

963
00:34:08,030 --> 00:34:09,230
you don't need budget.

964
00:34:09,230 --> 00:34:10,300
As long as you have some time

965
00:34:10,300 --> 00:34:11,820
and some buy-in from the top

966
00:34:11,820 --> 00:34:14,210
that you can conduct
these types of activities,

967
00:34:14,210 --> 00:34:16,313
it's very very critical.

968
00:34:17,940 --> 00:34:19,159
And learn from others.

969
00:34:19,159 --> 00:34:20,639
Reading blog posts on the latest

970
00:34:20,639 --> 00:34:22,150
and greatest threat hunting techniques.

971
00:34:22,150 --> 00:34:24,739
There's actually, I
think a fantastic set of

972
00:34:24,739 --> 00:34:26,310
threat hunting playbooks

973
00:34:26,310 --> 00:34:27,143
and things to look for.

974
00:34:27,143 --> 00:34:29,310
The guy's name @Cyb3rWard0g,

975
00:34:29,310 --> 00:34:30,699
I'm not gonna take all the credit

976
00:34:30,699 --> 00:34:32,429
for teaching this guy many years ago.

977
00:34:32,429 --> 00:34:34,810
But of course he was my young Padawan,

978
00:34:34,810 --> 00:34:37,139
but he's got a fantastic
set of information

979
00:34:37,139 --> 00:34:38,359
on threat hunting.

980
00:34:38,360 --> 00:34:39,193
And he's actually,

981
00:34:39,193 --> 00:34:40,330
he's a good friend of mine, Roberto.

982
00:34:40,330 --> 00:34:41,719
So definitely check out that,

983
00:34:41,719 --> 00:34:42,810
that's only one example.

984
00:34:42,810 --> 00:34:44,060
There's like a million out there,

985
00:34:44,060 --> 00:34:44,893
there's a million,

986
00:34:44,893 --> 00:34:47,110
I think people in this industry
who are fantastic at this.

987
00:34:47,110 --> 00:34:48,070
You can just go out there

988
00:34:48,070 --> 00:34:51,083
and start searching for threat
hunting in the tweet space.

989
00:34:52,340 --> 00:34:53,270
And then also,

990
00:34:53,270 --> 00:34:54,469
I know this is a little controversial,

991
00:34:54,469 --> 00:34:56,620
but consider working for an organization

992
00:34:56,620 --> 00:34:58,600
that will truly help grow your skills.

993
00:34:58,600 --> 00:35:01,799
If you're responsible for
protecting 100 to 200 end points

994
00:35:01,800 --> 00:35:04,590
in a small business
that'll never be targeted,

995
00:35:04,590 --> 00:35:05,730
I hate to say this

996
00:35:05,730 --> 00:35:07,480
but you might not get anything

997
00:35:07,480 --> 00:35:11,500
out of that opportunity, unfortunately.

998
00:35:11,500 --> 00:35:12,360
I'm used to...

999
00:35:12,360 --> 00:35:13,540
So when I started my career,

1000
00:35:13,540 --> 00:35:15,727
I worked for a company
that had 90,000 end points.

1001
00:35:15,727 --> 00:35:19,529
Can you imagine the amount
of fun I had in that moment,

1002
00:35:19,530 --> 00:35:21,800
90,000 endpoints, there
is something interesting

1003
00:35:21,800 --> 00:35:23,720
that happened every single day.

1004
00:35:23,720 --> 00:35:25,160
But when you have a limited scope,

1005
00:35:25,160 --> 00:35:26,680
when it's only a handful of machines

1006
00:35:26,680 --> 00:35:28,419
and you're in a business line

1007
00:35:28,420 --> 00:35:29,850
that's just never gonna be hit.

1008
00:35:29,850 --> 00:35:32,450
It's just, you're gonna
get bored, trust me.

1009
00:35:32,450 --> 00:35:33,609
I'm not saying leave your job

1010
00:35:33,610 --> 00:35:34,443
or quit your job,

1011
00:35:34,443 --> 00:35:35,340
but just consider that

1012
00:35:35,340 --> 00:35:38,410
as you're getting into
your career next steps.

1013
00:35:38,410 --> 00:35:39,690
Like where do you wanna
go with your career?

1014
00:35:39,690 --> 00:35:42,370
I think it's important to work for

1015
00:35:42,370 --> 00:35:44,413
an environment where you're
gonna start seeing stuff.

1016
00:35:46,020 --> 00:35:48,170
And Hey, if you wanna
get in touch with me,

1017
00:35:48,170 --> 00:35:49,130
you have any questions,

1018
00:35:49,130 --> 00:35:50,690
there's my deets,

1019
00:35:50,690 --> 00:35:52,440
tbandos@digitalguardian.com.

1020
00:35:52,440 --> 00:35:53,700
You can email me.

1021
00:35:53,700 --> 00:35:56,109
You can also at me at Twitter,

1022
00:35:56,110 --> 00:35:58,360
I am @cybertimmay.

1023
00:35:58,360 --> 00:36:00,420
So please feel free to do that.

1024
00:36:00,420 --> 00:36:01,870
Also during the session,

1025
00:36:01,870 --> 00:36:04,540
I am gonna be handling any
questions that you guys have.

1026
00:36:04,540 --> 00:36:06,680
So as I've gone through this,

1027
00:36:06,680 --> 00:36:07,940
if there's anything that comes up

1028
00:36:07,940 --> 00:36:08,773
and you're like,

1029
00:36:08,773 --> 00:36:09,770
"Oh my gosh, I wonder..."

1030
00:36:09,770 --> 00:36:10,860
Please type that away.

1031
00:36:10,860 --> 00:36:14,180
I'm gonna be readily available
during a session time slot.

1032
00:36:14,180 --> 00:36:17,410
So please sure to enter those questions

1033
00:36:17,410 --> 00:36:18,962
and I'll answer them as well.

1034
00:36:20,200 --> 00:36:21,216
So one piece of advice,

1035
00:36:21,217 --> 00:36:23,999
"May the hunting forces be with you."

1036
00:36:23,999 --> 00:36:25,649
That was a very horrible impression.

1037
00:36:25,650 --> 00:36:26,483
I don't wanna leave with that

1038
00:36:26,483 --> 00:36:27,790
but I wanna say, "Good luck."

1039
00:36:27,790 --> 00:36:29,610
Thank you for attending my presentation.

1040
00:36:29,610 --> 00:36:31,010
And I hope to hear from you.

