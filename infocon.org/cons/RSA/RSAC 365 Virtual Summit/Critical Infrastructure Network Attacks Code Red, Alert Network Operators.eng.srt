1
00:00:00,140 --> 00:00:02,760
- Hello everyone from
joining us for this session

2
00:00:02,760 --> 00:00:05,600
on Critical Infrastructure
Network Attacks.

3
00:00:05,600 --> 00:00:08,328
and specifically the attacks that we saw

4
00:00:08,328 --> 00:00:11,639
when we performed a utility

5
00:00:11,640 --> 00:00:15,504
or industrial control system
oriented honeypot research.

6
00:00:15,504 --> 00:00:19,217
My name is Israel Barak,
I'm the CISO at Cybereason.

7
00:00:20,450 --> 00:00:23,233
So without further ado,
let's kick this off.

8
00:00:24,170 --> 00:00:27,590
Now, looking at the
Honeypot Research Goals,

9
00:00:27,590 --> 00:00:32,189
our primary goals were really
to expand our tracking, right?

10
00:00:32,189 --> 00:00:34,910
of changes in the adversarial landscape,

11
00:00:34,910 --> 00:00:37,430
the tools, the techniques, the practices

12
00:00:38,510 --> 00:00:40,080
that threat actors are using

13
00:00:40,080 --> 00:00:41,690
from a threat Intel perspective.

14
00:00:41,690 --> 00:00:45,500
And really we wanted to
add threat Intel context

15
00:00:45,500 --> 00:00:48,350
and analytics context around the telemetry

16
00:00:48,350 --> 00:00:52,450
that we often collect from
both IT and an OT environment.

17
00:00:52,450 --> 00:00:54,853
Now, to help accomplish that,

18
00:00:55,790 --> 00:00:58,370
this specific honeypot research was built

19
00:00:58,370 --> 00:01:02,535
to emulate an electric
transmission substation network.

20
00:01:02,535 --> 00:01:05,410
And we basically use
the network identifier

21
00:01:05,410 --> 00:01:08,780
as both internal and
external network identifiers

22
00:01:08,780 --> 00:01:10,560
that are very, very similar

23
00:01:10,560 --> 00:01:13,460
to a known large electricity provider

24
00:01:13,460 --> 00:01:16,809
to entice attackers to show interest

25
00:01:16,810 --> 00:01:19,103
and maybe even target this honeypot.

26
00:01:20,750 --> 00:01:25,710
Now, looking at the outcomes
so far from this research,

27
00:01:25,710 --> 00:01:27,869
I think the spectrum of cyber attacks

28
00:01:27,870 --> 00:01:29,417
against utility providers

29
00:01:29,417 --> 00:01:32,030
and the interest in protecting them

30
00:01:32,030 --> 00:01:34,230
come as the profile of adversaries

31
00:01:34,230 --> 00:01:38,200
who target industrial
control system providers

32
00:01:38,200 --> 00:01:39,630
is really broadening.

33
00:01:39,630 --> 00:01:43,320
And I think while usually
industrial control system attacks

34
00:01:43,320 --> 00:01:47,630
are linked to APT or advanced
persistent threat actor groups

35
00:01:47,630 --> 00:01:49,899
and nation state threat actors.

36
00:01:49,900 --> 00:01:52,132
And those are probably still, you know,

37
00:01:52,132 --> 00:01:55,880
the primary profile of an adversary

38
00:01:55,880 --> 00:01:58,100
that would target these environments.

39
00:01:58,100 --> 00:02:03,100
We were able to make that
assessment, I think today

40
00:02:04,050 --> 00:02:07,610
based on honeypot data that we collected

41
00:02:07,610 --> 00:02:11,553
that really, really shows the
profile of the threat actors.

42
00:02:12,448 --> 00:02:14,130
They target these utility environments,

43
00:02:14,130 --> 00:02:17,820
these industrial control system
environments is broadening,

44
00:02:17,820 --> 00:02:21,010
and we're seeing many more
types of threat actors

45
00:02:21,010 --> 00:02:24,920
getting into that mix and many
more tiers of threat actors

46
00:02:24,920 --> 00:02:26,192
getting into that mix.

47
00:02:27,470 --> 00:02:32,470
Now, before we dive into the
honeypot research results,

48
00:02:32,630 --> 00:02:36,530
I'd like to set some context

49
00:02:36,530 --> 00:02:39,350
on some key trends in
the ransomware space.

50
00:02:39,350 --> 00:02:40,897
The work that's gonna be,

51
00:02:40,897 --> 00:02:44,397
and those are gonna be
important for us to understand,

52
00:02:44,397 --> 00:02:48,600
to put in context what we
saw in the honeypot research.

53
00:02:48,600 --> 00:02:52,120
And I think those are gonna
be single-stage ransomware

54
00:02:52,120 --> 00:02:55,020
and multi-stage ransomware operations.

55
00:02:55,020 --> 00:02:57,790
So, ransomware has historically been used

56
00:02:57,790 --> 00:03:01,200
in the so-called shotgun approach, right?

57
00:03:01,200 --> 00:03:03,910
Basically distributing the ransomware

58
00:03:03,910 --> 00:03:06,549
to as many targets as possible,

59
00:03:06,550 --> 00:03:11,550
and thereby increasing the
chances of generating revenue.

60
00:03:11,580 --> 00:03:14,060
Now, in these cases,
the ransomware operator

61
00:03:14,060 --> 00:03:16,700
basically acquires a list of targets,

62
00:03:16,700 --> 00:03:18,670
many times in the form of a mailing list

63
00:03:18,670 --> 00:03:21,760
or an email address, a distribution list,

64
00:03:21,760 --> 00:03:23,810
and basically distributes that email

65
00:03:23,810 --> 00:03:25,550
to that entire distribution list.

66
00:03:25,550 --> 00:03:29,560
Now, usually this is done with
very little customization,

67
00:03:29,560 --> 00:03:32,600
usually just customizing the language

68
00:03:32,600 --> 00:03:34,239
to the geographic location

69
00:03:34,240 --> 00:03:37,323
of where that presumed target actually is.

70
00:03:38,605 --> 00:03:42,760
Those single stage ransomware attacks

71
00:03:42,760 --> 00:03:45,429
are usually very quick to detonate.

72
00:03:45,430 --> 00:03:49,010
Usually when the target
receives that outreach,

73
00:03:49,010 --> 00:03:51,450
the email or that link

74
00:03:51,450 --> 00:03:55,359
and the ransomware lands on
the end point of that target,

75
00:03:55,360 --> 00:03:57,520
it usually detonates on impact,

76
00:03:57,520 --> 00:03:59,770
where it detonates very, very quickly.

77
00:03:59,770 --> 00:04:04,770
It starts encrypting the data
and basically asks for money.

78
00:04:05,100 --> 00:04:08,670
Now, when you look at
single stage ransomware,

79
00:04:08,670 --> 00:04:12,130
there usually is usually exist,

80
00:04:12,130 --> 00:04:15,750
there usually are very few
indicators of reuse, right?

81
00:04:15,750 --> 00:04:20,750
You see a large variety
of strains in this space.

82
00:04:20,793 --> 00:04:24,950
A lot of new strains are
being developed every month,

83
00:04:24,950 --> 00:04:26,370
and the idea is that those are

84
00:04:26,370 --> 00:04:30,730
fairly simple rudimentary
tools, really blunt tools.

85
00:04:30,730 --> 00:04:34,435
And so there's not a lot
of need to reuse code

86
00:04:34,435 --> 00:04:38,130
from previous strains
to actually get money

87
00:04:38,130 --> 00:04:39,630
out of these operations.

88
00:04:39,630 --> 00:04:43,580
And that actually makes it
difficult to detect those

89
00:04:43,580 --> 00:04:48,310
with next generation AVS
and static analysis tools.

90
00:04:48,310 --> 00:04:52,020
And those are single
stage ransomware attacks,

91
00:04:52,020 --> 00:04:54,049
can be fairly impactful,

92
00:04:54,050 --> 00:04:56,700
but usually when you
think about business risk,

93
00:04:56,700 --> 00:04:59,890
those are actually the
ones that pose lesser risk

94
00:04:59,890 --> 00:05:03,880
to corporate in larger
enterprise organizations.

95
00:05:03,880 --> 00:05:08,010
Now, one of the critical
trends in ransomware threats

96
00:05:08,010 --> 00:05:11,240
is the growth of a new
operational paradigm,

97
00:05:11,240 --> 00:05:13,790
which is a multi-stage ransomware.

98
00:05:13,790 --> 00:05:17,020
Now, those are essentially
multi-stage hacking operations,

99
00:05:17,020 --> 00:05:20,280
where the threat actor
breaches a victim's network

100
00:05:20,280 --> 00:05:23,559
and performs several post-breach actions.

101
00:05:23,560 --> 00:05:25,850
And those actions are meant to result

102
00:05:25,850 --> 00:05:29,170
in a fairly large ransom payment.

103
00:05:29,170 --> 00:05:32,080
The general idea behind these operations

104
00:05:32,080 --> 00:05:33,690
is that a ransomware operator

105
00:05:33,690 --> 00:05:35,610
can generate significant revenue

106
00:05:35,610 --> 00:05:37,760
from the relatively
small number of victims

107
00:05:37,760 --> 00:05:39,920
if each of them pays a large amount.

108
00:05:39,920 --> 00:05:43,500
And when you think about
all these ransomware cases

109
00:05:43,500 --> 00:05:45,170
that we've been seeing on the news

110
00:05:45,170 --> 00:05:50,170
that pay or at least
extorted for six figure sums,

111
00:05:50,850 --> 00:05:53,530
those are usually a
multi-stage ransomware attack.

112
00:05:53,530 --> 00:05:56,953
Now, in a multi-stage attack,

113
00:05:56,954 --> 00:06:00,840
the attack itself typically
involves data theft,

114
00:06:00,840 --> 00:06:02,479
stealing user credentials,

115
00:06:02,480 --> 00:06:04,630
laterally moving through
the victim network

116
00:06:04,630 --> 00:06:07,060
and compromising other end points.

117
00:06:07,060 --> 00:06:09,220
And then basically
targeting critical assets

118
00:06:09,220 --> 00:06:12,550
like domain controllers
and others in the network.

119
00:06:12,550 --> 00:06:15,210
Now this operational attack pattern

120
00:06:15,210 --> 00:06:18,640
attempts to impact the victim
in several different ways

121
00:06:18,640 --> 00:06:21,240
including confidential data loss,

122
00:06:21,240 --> 00:06:23,410
sensitive user credential theft,

123
00:06:23,410 --> 00:06:25,710
disabling large amounts of systems

124
00:06:25,710 --> 00:06:29,157
to effectively cause a large
scale service disruption.

125
00:06:29,158 --> 00:06:33,590
And I think the idea behind these attacks

126
00:06:33,590 --> 00:06:36,890
is really the create or
behind the operational pattern

127
00:06:36,890 --> 00:06:39,620
of multi-stage ransomware attacks,

128
00:06:39,620 --> 00:06:43,030
is to create as many leverage points

129
00:06:43,030 --> 00:06:45,340
that the attacker can take advantage of

130
00:06:45,340 --> 00:06:48,852
to facilitate a large extortion.

131
00:06:49,700 --> 00:06:53,340
Now, ransomware attacks both single stage

132
00:06:53,340 --> 00:06:55,630
and multi-stage are very prevalent

133
00:06:55,630 --> 00:06:58,385
as we know in IT environments.

134
00:06:58,386 --> 00:07:00,510
In fact, some threat actors

135
00:07:00,510 --> 00:07:02,469
have turned ransomware operations

136
00:07:02,470 --> 00:07:04,900
into the primary area of focus

137
00:07:04,900 --> 00:07:06,513
and source of revenue for them.

138
00:07:07,450 --> 00:07:09,150
But ransomware threat actors

139
00:07:09,150 --> 00:07:11,609
that target industrial control systems

140
00:07:11,610 --> 00:07:13,690
or critical infrastructure environments

141
00:07:13,690 --> 00:07:16,530
are presumed to be much less prevalent.

142
00:07:16,530 --> 00:07:19,530
Usually, when you go through
threat intelligence reports,

143
00:07:19,530 --> 00:07:22,830
those are usually presumed
to be much less prevalent.

144
00:07:22,830 --> 00:07:26,469
And while at the onset
of this ICS honeypot,

145
00:07:26,470 --> 00:07:30,020
we actually did not
expect to encounter one.

146
00:07:30,020 --> 00:07:31,409
We ended up realizing

147
00:07:31,410 --> 00:07:36,410
that these attacks can very
likely be a lot more frequent

148
00:07:36,440 --> 00:07:38,090
than we might be used to thinking

149
00:07:42,620 --> 00:07:47,620
Now, before we dive into the
honeypot research results,

150
00:07:47,960 --> 00:07:50,370
this is a quick overview
of the architecture

151
00:07:50,370 --> 00:07:52,870
of the honeypot that we had set up.

152
00:07:52,870 --> 00:07:56,490
Basically the honeypot network was built

153
00:07:56,490 --> 00:08:00,930
to resemble an electric
transmission substation, right?

154
00:08:00,930 --> 00:08:03,820
The network architecture is very typical

155
00:08:03,820 --> 00:08:06,453
to a large substation,

156
00:08:07,420 --> 00:08:09,930
it contains several different
elements here, right?

157
00:08:09,930 --> 00:08:14,930
There's a DMZ area that is
facing the external world,

158
00:08:16,180 --> 00:08:21,180
in this case, the internet
or the when environment.

159
00:08:21,390 --> 00:08:23,570
Some of the critical services here

160
00:08:23,570 --> 00:08:26,030
in the DMZ include typical services

161
00:08:26,030 --> 00:08:28,080
that you would find in
a substation network,

162
00:08:28,080 --> 00:08:31,370
like remote technician interfaces,

163
00:08:31,370 --> 00:08:34,950
or for the station is currently
in an unmanned situation,

164
00:08:34,950 --> 00:08:38,330
a technician would be
able to connect remotely

165
00:08:38,330 --> 00:08:43,330
and support different types of issues

166
00:08:43,710 --> 00:08:45,960
or analyze different types of issues

167
00:08:45,960 --> 00:08:49,370
or if remote support is
needed by an escalation point.

168
00:08:49,370 --> 00:08:54,010
And those are, those personnel
are able to connect remotely.

169
00:08:54,010 --> 00:08:57,090
We'll see that component in the network

170
00:08:57,090 --> 00:09:00,160
actually played a critical role

171
00:09:00,160 --> 00:09:02,120
in the incident that we're
gonna talk about in here

172
00:09:02,120 --> 00:09:05,513
serving as an initial access
point for the attacker.

173
00:09:07,180 --> 00:09:09,189
Other components here in the environment

174
00:09:09,190 --> 00:09:12,420
include the industrial
control system network itself.

175
00:09:12,420 --> 00:09:14,640
In this case, you can
see here the devices.

176
00:09:14,640 --> 00:09:17,967
Those are different
types of ICS controllers

177
00:09:17,967 --> 00:09:21,100
that we had here in the in the honeypot.

178
00:09:21,100 --> 00:09:23,670
ICS services segment in the network

179
00:09:23,670 --> 00:09:27,069
was focused on HMI systems

180
00:09:27,070 --> 00:09:29,350
that are based on an open SCADA

181
00:09:29,350 --> 00:09:33,810
and other service segments
here in the network,

182
00:09:33,810 --> 00:09:36,853
that are fairly typical
to a large substation.

183
00:09:38,780 --> 00:09:42,053
Looking further into what we
had here in the environment,

184
00:09:43,690 --> 00:09:46,420
the endpoints themselves were typically

185
00:09:46,420 --> 00:09:49,110
windows or Linux based,

186
00:09:49,110 --> 00:09:52,350
the way we collected telemetry
from the endpoints here

187
00:09:52,350 --> 00:09:55,950
and from the ICS environment
was using the Cybereason sensor

188
00:09:55,950 --> 00:09:58,570
that's basically deployed
on these end points

189
00:09:58,570 --> 00:10:02,630
and collecting the system
user application behaviors

190
00:10:02,630 --> 00:10:04,150
on these end points, that we were able to

191
00:10:04,150 --> 00:10:06,780
essentially correlate and analyze

192
00:10:06,780 --> 00:10:09,630
to identify potential attack patterns

193
00:10:09,630 --> 00:10:11,453
and provide visibility into them.

194
00:10:12,950 --> 00:10:15,270
Can also see that the network segmentation

195
00:10:15,270 --> 00:10:20,270
was fairly typical to a, an
IT/OT combined environment

196
00:10:21,640 --> 00:10:24,710
where the IT areas of the system

197
00:10:24,710 --> 00:10:28,997
are fairly reasonably
segregated via firewalls,

198
00:10:30,140 --> 00:10:33,463
in this case, from the IT network itself.

199
00:10:36,940 --> 00:10:40,450
Now, one of the primary incidents

200
00:10:40,450 --> 00:10:44,520
that occurred in this honeypot
is what we believe to be

201
00:10:44,520 --> 00:10:47,300
a multi-stage ransomware attack,

202
00:10:47,300 --> 00:10:51,079
likely by a cyber crime threat actor.

203
00:10:51,080 --> 00:10:54,610
Now, at a glance, and
we'll take a look shortly

204
00:10:54,610 --> 00:10:56,160
into the steps of the attack

205
00:10:56,160 --> 00:10:59,740
and more details through
screenshots from the environment,

206
00:10:59,740 --> 00:11:03,870
the timeline of the attack
started essentially two days

207
00:11:03,870 --> 00:11:06,390
right after we've connected
the honeypot environment

208
00:11:06,390 --> 00:11:07,929
into the internet.

209
00:11:07,929 --> 00:11:10,670
So, basically our time equals zero,

210
00:11:10,670 --> 00:11:12,620
the network was ready,

211
00:11:12,620 --> 00:11:15,780
We had it connected to the internet,

212
00:11:15,780 --> 00:11:18,150
and it took us two days

213
00:11:18,150 --> 00:11:22,372
to get to the initial
compromise of the environment.

214
00:11:23,670 --> 00:11:26,189
Now, in the initial compromise,

215
00:11:26,190 --> 00:11:28,950
what we can see here is
the primary techniques

216
00:11:28,950 --> 00:11:30,900
that were used by the attacker,

217
00:11:30,900 --> 00:11:33,180
the initial access was through

218
00:11:33,180 --> 00:11:36,670
the remote technician interface.

219
00:11:36,670 --> 00:11:41,250
They use basically brute
forced user account credentials

220
00:11:41,250 --> 00:11:43,210
and were able to gain access

221
00:11:43,210 --> 00:11:47,380
with those brute forced
credentials into the RDP system.

222
00:11:47,380 --> 00:11:50,600
They then ran a series
of discovery techniques

223
00:11:50,600 --> 00:11:53,920
performing discovery on the
active directory in the domain

224
00:11:53,920 --> 00:11:56,040
as well as the DNS server

225
00:11:56,040 --> 00:11:58,819
that was in there primarily
doing reverse DNS look-ups

226
00:11:58,820 --> 00:12:01,093
to identify where they are

227
00:12:01,093 --> 00:12:04,170
and what assets are in that network.

228
00:12:04,170 --> 00:12:07,839
And persistence was done
in a fairly rudimentary way

229
00:12:07,840 --> 00:12:11,440
in this initial phase,
using a local user creation,

230
00:12:11,440 --> 00:12:13,760
basically creation of a backup user.

231
00:12:13,760 --> 00:12:16,990
The idea was that if we
would go and change back

232
00:12:16,990 --> 00:12:19,800
or replace the passwords that
they were able to brute force,

233
00:12:19,800 --> 00:12:23,479
they would still have
a way to log in, right

234
00:12:23,480 --> 00:12:25,180
and get back into the environment.

235
00:12:26,350 --> 00:12:29,220
Now, that was the two days

236
00:12:29,220 --> 00:12:32,890
after we got this environment
connected to the internet.

237
00:12:32,890 --> 00:12:36,620
The short amount of time
is very likely indicative

238
00:12:36,620 --> 00:12:39,650
of some sort of automatic
scanning activity

239
00:12:39,650 --> 00:12:44,459
that's going on, that
allowed the threat group here

240
00:12:44,460 --> 00:12:46,940
to identify the new
asset that was connected

241
00:12:46,940 --> 00:12:51,070
and perform these actions,
very likely automatically

242
00:12:51,070 --> 00:12:53,823
on those, on the remote
technician interface.

243
00:12:54,770 --> 00:12:59,770
Now, four days after this, two days after

244
00:13:00,100 --> 00:13:03,150
the first access,

245
00:13:03,150 --> 00:13:05,550
the threat actor access
into the environment,

246
00:13:05,550 --> 00:13:09,248
we started noticing a
different set of TTPs.

247
00:13:09,249 --> 00:13:12,290
We believe by the way
that the change of TTPs

248
00:13:12,290 --> 00:13:14,730
that we're seeing between
step two and three

249
00:13:14,730 --> 00:13:17,260
are very likely due to a handoff

250
00:13:17,260 --> 00:13:20,830
of this environment between
two different threat actors.

251
00:13:20,830 --> 00:13:22,120
Very likely a first one

252
00:13:22,120 --> 00:13:24,150
that only got access to the environment

253
00:13:24,150 --> 00:13:27,670
and then sold it over to
a second threat actor,

254
00:13:27,670 --> 00:13:30,349
that continue to work on target.

255
00:13:30,350 --> 00:13:34,610
Probably based on the attractiveness

256
00:13:34,610 --> 00:13:36,890
of the indicators of which network

257
00:13:36,890 --> 00:13:39,293
they believe that they compromised.

258
00:13:40,630 --> 00:13:45,630
Now, in step three, basically
the threat actor here

259
00:13:46,870 --> 00:13:51,360
started operating in a mode
that was very, very focused

260
00:13:51,360 --> 00:13:56,360
on moving in the environment,
towards a higher goal, right?

261
00:13:57,070 --> 00:14:00,480
And what we saw here is
a operational pattern

262
00:14:00,480 --> 00:14:02,440
that's actually very common

263
00:14:02,440 --> 00:14:05,000
to multi-stage ransomware attacks.

264
00:14:05,000 --> 00:14:09,840
The first stage is to steal credentials,

265
00:14:09,840 --> 00:14:12,390
basically steal the passwords

266
00:14:12,390 --> 00:14:15,569
of every user that
logged on to the machine.

267
00:14:15,570 --> 00:14:18,670
In this case, the remote
technician access machines

268
00:14:18,670 --> 00:14:20,742
and the tool that they used was MimiKatz.

269
00:14:22,020 --> 00:14:24,140
And then the second stage

270
00:14:24,140 --> 00:14:27,040
is to basically collect and exfiltrate

271
00:14:27,040 --> 00:14:32,040
all the data files that
exists on that machine.

272
00:14:32,367 --> 00:14:37,367
The third stage was to drop a
ransomware onto that machine.

273
00:14:38,900 --> 00:14:39,920
So at this point,

274
00:14:39,920 --> 00:14:42,959
the threat actor isn't
detonating the ransomware,

275
00:14:42,960 --> 00:14:45,050
they're placing the
ransomware on the machine

276
00:14:45,050 --> 00:14:47,150
but they're not yet detonating it.

277
00:14:47,150 --> 00:14:50,265
The idea is to wait until
a later moment in time

278
00:14:50,265 --> 00:14:52,569
until they actually detonate those.

279
00:14:52,570 --> 00:14:54,650
So they're very, very similar to a pattern

280
00:14:54,650 --> 00:14:58,160
that exists in the multi-stage
ransomware attacks.

281
00:14:58,160 --> 00:15:01,130
And then finally, the idea is to use

282
00:15:01,130 --> 00:15:04,270
all these stolen credentials
from this machine

283
00:15:04,270 --> 00:15:07,920
to move laterally to other
machines in this environment.

284
00:15:07,920 --> 00:15:11,490
In this case, they chose to use SMB

285
00:15:11,490 --> 00:15:15,713
and specifically PS exec
to move in the environment.

286
00:15:17,520 --> 00:15:21,660
Now, this stage took some time, right?

287
00:15:21,660 --> 00:15:23,439
It took them several days to move

288
00:15:23,440 --> 00:15:24,730
throughout the environment.

289
00:15:24,730 --> 00:15:26,110
In this case, they're focused on,

290
00:15:26,110 --> 00:15:29,290
they're still in the
IT environment, right?

291
00:15:29,290 --> 00:15:30,469
They're not yet in the OT

292
00:15:30,470 --> 00:15:33,260
they're moving around the IT environment.

293
00:15:33,260 --> 00:15:35,550
23 days after we started

294
00:15:35,550 --> 00:15:39,053
that was 19 days after the previous step,

295
00:15:40,280 --> 00:15:43,640
the attacker exhibited a behavior

296
00:15:43,640 --> 00:15:48,230
that actually came as a
surprise to us, right?

297
00:15:48,230 --> 00:15:49,520
What we expected them to do

298
00:15:49,520 --> 00:15:52,000
is to spread through the IT environment

299
00:15:52,000 --> 00:15:54,150
and then drop the, detonate the ransomware

300
00:15:54,150 --> 00:15:55,939
in the IT environment.

301
00:15:55,940 --> 00:15:57,940
Instead of that, they waited,

302
00:15:57,940 --> 00:16:00,550
they kept moving laterally
in the environment.

303
00:16:00,550 --> 00:16:03,760
And then on day 23 for the honeypot,

304
00:16:03,760 --> 00:16:07,260
they made a lateral movement
from the IT environment

305
00:16:07,260 --> 00:16:08,893
into the OT environment.

306
00:16:08,893 --> 00:16:11,660
And what they used to accomplish that

307
00:16:11,660 --> 00:16:14,050
since the environments were separated

308
00:16:14,050 --> 00:16:16,280
in this case with firewalls,

309
00:16:16,280 --> 00:16:18,740
they use the web service vulnerability

310
00:16:18,740 --> 00:16:20,707
that existed in our open SCADA HMI.

311
00:16:22,310 --> 00:16:26,162
And then that surprised us,
because what that showed us

312
00:16:26,163 --> 00:16:30,030
is that the attacker
came in with a playbook

313
00:16:30,030 --> 00:16:32,709
that they were able to execute on

314
00:16:32,710 --> 00:16:37,060
for pivoting between an IT
and an OT environment, right?

315
00:16:37,060 --> 00:16:39,430
What they showed us was obviously,

316
00:16:39,430 --> 00:16:40,760
the majority of the environment

317
00:16:40,760 --> 00:16:43,010
did not have access into the HMI

318
00:16:43,010 --> 00:16:44,980
or to the ICS services environment,

319
00:16:44,980 --> 00:16:48,200
only specific services
in the IT environment

320
00:16:48,200 --> 00:16:50,240
had that type of access.

321
00:16:50,240 --> 00:16:51,940
And what the threat actor showed us

322
00:16:51,940 --> 00:16:53,887
was that they were able to move laterally

323
00:16:53,887 --> 00:16:56,040
and they kept moving in the environment,

324
00:16:56,040 --> 00:17:01,040
in this case for 19 days
until they found a service

325
00:17:01,200 --> 00:17:04,869
that had the ability to
access the HMI system,

326
00:17:04,869 --> 00:17:08,179
in this case, to see the HMI data.

327
00:17:08,180 --> 00:17:11,068
And then what they did
with that level of access

328
00:17:11,068 --> 00:17:15,069
is to pivot into the OT network

329
00:17:15,069 --> 00:17:18,592
by exploiting a web service
vulnerability in our HMI system.

330
00:17:19,750 --> 00:17:22,510
So that was a surprise.

331
00:17:22,510 --> 00:17:26,280
From the moment they gained
access into the OT environment,

332
00:17:26,280 --> 00:17:29,918
they started going through
the same multistage,

333
00:17:29,918 --> 00:17:31,830
ransomware operational pattern

334
00:17:31,830 --> 00:17:35,820
changing techniques and
procedures a little bit.

335
00:17:35,820 --> 00:17:39,060
In this case, since the
environment was Linux-based,

336
00:17:39,060 --> 00:17:40,909
the credential access was done via

337
00:17:40,910 --> 00:17:44,480
pass the ticket technique.

338
00:17:44,480 --> 00:17:46,440
And the lateral movement was again

339
00:17:46,440 --> 00:17:49,130
via SMB not PsExec in this environment,

340
00:17:49,130 --> 00:17:52,610
but SMB using past the ticket technique.

341
00:17:52,610 --> 00:17:55,270
But the procedure from multi-stage attack,

342
00:17:55,270 --> 00:17:57,260
a ransomware attack was very similar.

343
00:17:57,260 --> 00:18:00,410
With each new host that
they got access to,

344
00:18:00,410 --> 00:18:03,000
a ransomware was dropped, not detonated,

345
00:18:03,000 --> 00:18:05,740
but dropped this time
in the OT environment.

346
00:18:05,740 --> 00:18:08,050
Data was collected and exfiltrated

347
00:18:08,050 --> 00:18:09,733
over the command control channel.

348
00:18:10,720 --> 00:18:12,810
And the stolen credentials were used

349
00:18:12,810 --> 00:18:15,620
to keep moving in the environment.

350
00:18:15,620 --> 00:18:19,070
And then later on the 24,
the environment itself,

351
00:18:19,070 --> 00:18:21,149
the OT environment was not very big

352
00:18:21,150 --> 00:18:23,800
so they completed that portion

353
00:18:23,800 --> 00:18:25,669
of their pattern of laterally moving

354
00:18:25,670 --> 00:18:28,390
in that environment on the 24.

355
00:18:28,390 --> 00:18:30,860
And when they completed, over there,

356
00:18:30,860 --> 00:18:32,260
they exhausted their ability

357
00:18:32,260 --> 00:18:34,460
to move laterally in the environment.

358
00:18:34,460 --> 00:18:39,080
Late on day 24, they
detonated the ransomware

359
00:18:39,080 --> 00:18:43,439
across both the IT and the OT
environment simultaneously,

360
00:18:43,440 --> 00:18:45,730
basically encrypting all
the data that was there

361
00:18:45,730 --> 00:18:48,040
and leading the system shutdowns

362
00:18:48,040 --> 00:18:50,550
right across the entire environment

363
00:18:50,550 --> 00:18:52,603
and then demanding their ransom.

364
00:18:55,940 --> 00:19:00,940
Now, if we look at EDR
data from this attack,

365
00:19:01,410 --> 00:19:03,010
and I'm using screenshots

366
00:19:03,010 --> 00:19:06,110
taken from the Cybereason EDR console.

367
00:19:06,110 --> 00:19:08,368
We can see the attack here,

368
00:19:08,368 --> 00:19:10,080
starting with the attacker compromising

369
00:19:10,080 --> 00:19:12,449
our remote technician, RDP service

370
00:19:12,450 --> 00:19:16,083
by basically brute forcing the
local administrator password,

371
00:19:17,170 --> 00:19:18,970
then using PowerShell, right?

372
00:19:18,970 --> 00:19:21,530
To deploy the first stage of the attack,

373
00:19:21,530 --> 00:19:22,740
and among other things,

374
00:19:22,740 --> 00:19:26,610
initiate data theft from
this compromised system

375
00:19:26,610 --> 00:19:28,560
and start performing persistence

376
00:19:28,560 --> 00:19:32,523
by creating a new local admin account.

377
00:19:34,480 --> 00:19:37,920
In the next stage, they actually,

378
00:19:37,920 --> 00:19:39,850
we can actually see in
more details, right?

379
00:19:39,850 --> 00:19:43,330
The creation of the
malicious local admin account

380
00:19:43,330 --> 00:19:45,460
that is used as backup, right?

381
00:19:45,460 --> 00:19:48,540
In case someone would reset the passwords

382
00:19:48,540 --> 00:19:51,290
for one of the users that
they originally brute forced.

383
00:19:54,600 --> 00:19:58,199
Their next step was to start downloading

384
00:19:58,200 --> 00:20:00,120
and staging additional tools.

385
00:20:00,120 --> 00:20:03,149
And specifically the ransomware drop.

386
00:20:03,150 --> 00:20:04,970
We can see that they're using PowerShell

387
00:20:04,970 --> 00:20:08,730
in this case to perform a,
the file download, right?

388
00:20:08,730 --> 00:20:10,740
Or dropping of those initial tools

389
00:20:10,740 --> 00:20:12,770
or additional tools on the endpoint,

390
00:20:12,770 --> 00:20:16,870
where one of these tools
was the ransomware, right?

391
00:20:16,870 --> 00:20:19,550
At this point, they're still
not detonating the ransomware.

392
00:20:19,550 --> 00:20:21,990
They're placing it in a temporary folder

393
00:20:21,990 --> 00:20:25,170
on each of the hosts
that they gain access to,

394
00:20:25,170 --> 00:20:27,310
but they're still not
detonating it, right?

395
00:20:27,310 --> 00:20:28,760
The idea is again, to wait

396
00:20:28,760 --> 00:20:31,120
until the cycle for lateral movement,

397
00:20:31,120 --> 00:20:35,060
data theft, credential theft,
maximum leverage, right,

398
00:20:35,060 --> 00:20:37,179
has been achieved on the target.

399
00:20:37,180 --> 00:20:40,813
And then detonate across
the environment as a whole.

400
00:20:42,570 --> 00:20:47,570
The next step was performing
a system, a network discovery.

401
00:20:47,640 --> 00:20:50,383
We can see that they're actually using

402
00:20:50,383 --> 00:20:54,720
a commodity, network discovery tool here

403
00:20:54,720 --> 00:20:58,020
as part of their arsenal of tools,

404
00:20:58,020 --> 00:21:00,639
which I think is probably more indicative

405
00:21:00,640 --> 00:21:03,050
of a cyber crime threat actor

406
00:21:03,050 --> 00:21:06,300
than it is of a more
sophisticated EPT group.

407
00:21:06,300 --> 00:21:09,020
And I think we'll see that
pattern repeating itself.

408
00:21:09,020 --> 00:21:12,523
We saw it in the network discovery,

409
00:21:13,730 --> 00:21:15,870
we saw it in that strain of ransomware

410
00:21:15,870 --> 00:21:19,330
that was used the fairly
commodity strain of ransomware,

411
00:21:19,330 --> 00:21:21,510
and we'll see it in a
couple of other places.

412
00:21:21,510 --> 00:21:25,100
I think it's probably more
indicative of a cyber crime.

413
00:21:25,100 --> 00:21:27,653
Threat actors in this particular space,

414
00:21:29,180 --> 00:21:32,330
but what they're doing
with this network discovery

415
00:21:32,330 --> 00:21:33,870
is first and foremost,

416
00:21:33,870 --> 00:21:38,020
looking for assets that are
critical for the network,

417
00:21:38,020 --> 00:21:42,410
like domain controllers, file
servers, databases, right?

418
00:21:42,410 --> 00:21:45,500
To scan and discover for
us before discovering

419
00:21:45,500 --> 00:21:48,153
other endpoints in the network.

420
00:21:49,880 --> 00:21:53,650
The attacker is then
stealing user credentials

421
00:21:53,650 --> 00:21:55,123
from the compromised asset.

422
00:21:57,330 --> 00:22:01,610
And basically, as you can
see, they're using MimiKatz

423
00:22:01,610 --> 00:22:06,419
right, to dump credentials
from this compromised assets.

424
00:22:06,420 --> 00:22:09,290
And then they're using
these stolen credentials,

425
00:22:09,290 --> 00:22:12,170
in combination with legitimate
administrative tools.

426
00:22:12,170 --> 00:22:15,770
As you can see here with PS exec to move

427
00:22:15,770 --> 00:22:18,410
into other assets in
the environment, right?

428
00:22:18,410 --> 00:22:21,210
So they're taking encryption keys from LSS

429
00:22:21,210 --> 00:22:25,530
or taking credentials and user
passwords from this machine.

430
00:22:25,530 --> 00:22:27,710
The legitimate user is remote technicians

431
00:22:27,710 --> 00:22:29,309
in this particular case.

432
00:22:29,309 --> 00:22:32,250
And they're using these
credentials as well as

433
00:22:32,250 --> 00:22:35,240
a legitimate administrative tool PS exec,

434
00:22:35,240 --> 00:22:37,920
to move in the environment.

435
00:22:37,920 --> 00:22:41,090
Now, the first spread points
that they're going after

436
00:22:41,090 --> 00:22:43,240
are actually the assets that will pose

437
00:22:43,240 --> 00:22:45,410
the probably the least
amount of suspicion,

438
00:22:45,410 --> 00:22:46,990
but likely caused the highest

439
00:22:46,990 --> 00:22:49,360
amount of impact to the organization.

440
00:22:49,360 --> 00:22:51,840
Like domain controllers, file servers

441
00:22:51,840 --> 00:22:54,149
and database servers that, you know,

442
00:22:54,150 --> 00:22:56,650
these compromised end
points usually access

443
00:22:56,650 --> 00:22:58,883
as part of their normal
day-to-day activity.

444
00:23:00,676 --> 00:23:02,810
And again, I think it's the use

445
00:23:02,810 --> 00:23:05,820
of commodity tool in this
case for credential dumping

446
00:23:05,820 --> 00:23:07,330
and for lateral movement,

447
00:23:07,330 --> 00:23:11,294
I think is probably another indicator here

448
00:23:11,295 --> 00:23:14,950
for a cyber crime actor,
that very likely prefers

449
00:23:14,950 --> 00:23:17,390
speed and simplicity

450
00:23:17,390 --> 00:23:20,363
more than stealth and
operational security.

451
00:23:21,520 --> 00:23:25,870
Now they will continue to steal
data and user credentials,

452
00:23:25,870 --> 00:23:27,860
iterate of way right
through this environment

453
00:23:27,860 --> 00:23:30,370
using these techniques that we saw here,

454
00:23:30,370 --> 00:23:32,580
basically until they've exhausted

455
00:23:32,580 --> 00:23:34,870
their ability to move laterally.

456
00:23:34,870 --> 00:23:38,649
And only after they've
completed that first stage

457
00:23:38,650 --> 00:23:40,690
which in this case,

458
00:23:40,690 --> 00:23:44,440
in this honeypots environment
took several days,

459
00:23:44,440 --> 00:23:47,470
closer two to three weeks
for them to go through the IT

460
00:23:47,470 --> 00:23:50,180
and then make the pivot into OT

461
00:23:50,180 --> 00:23:53,090
and then cycle through the OT environment.

462
00:23:53,090 --> 00:23:56,429
Only after they've
completed that first stage,

463
00:23:56,430 --> 00:23:59,120
Will they actually
detonate that ransomware,

464
00:23:59,120 --> 00:24:00,889
and it will do it simultaneously.

465
00:24:00,890 --> 00:24:02,300
And that ransomware that we saw them

466
00:24:02,300 --> 00:24:04,490
dropping at a very early stage

467
00:24:04,490 --> 00:24:08,330
in the attack across all
those compromised end points.

468
00:24:08,330 --> 00:24:10,120
Now what this results in?

469
00:24:10,120 --> 00:24:13,699
in many cases is a significant disruption

470
00:24:13,700 --> 00:24:15,230
to the victims of business

471
00:24:15,230 --> 00:24:17,220
and obviously a significant risk

472
00:24:17,220 --> 00:24:21,200
of operational risk and
on and risk of data loss.

473
00:24:21,200 --> 00:24:25,740
Now, when the extent of the
disruption is large enough,

474
00:24:25,740 --> 00:24:27,640
and obviously, unless an organization has

475
00:24:27,640 --> 00:24:30,460
full isolated DVR capabilities

476
00:24:30,460 --> 00:24:32,620
that they can quickly revert to,

477
00:24:32,620 --> 00:24:36,500
even recovering from backups
may not be a good enough option

478
00:24:36,500 --> 00:24:39,040
because of the amount of time

479
00:24:39,040 --> 00:24:40,909
a large-scale recovery can take.

480
00:24:40,910 --> 00:24:42,680
And, and that leads organizations

481
00:24:42,680 --> 00:24:47,380
and sometimes even insurers to
start considering negotiating

482
00:24:47,380 --> 00:24:48,323
with the attacker.

483
00:24:52,060 --> 00:24:56,030
Now, looking at some of
our takeaways from this,

484
00:24:56,030 --> 00:25:00,180
from this honeypot, we
saw some of the mechanics

485
00:25:00,180 --> 00:25:03,440
of the attack and we understood

486
00:25:03,440 --> 00:25:06,220
how attackers get to the point

487
00:25:06,220 --> 00:25:07,770
where they can leverage the attack

488
00:25:07,770 --> 00:25:10,520
to try to extort large amounts of money.

489
00:25:10,520 --> 00:25:14,240
And we also saw the element
that at least us, you know,

490
00:25:14,240 --> 00:25:18,350
we found surprising was
that playbook for pivoting

491
00:25:18,350 --> 00:25:22,350
from IT to OT, which was
very surprising for us to see

492
00:25:22,350 --> 00:25:23,812
in a cyber crime actor.

493
00:25:24,670 --> 00:25:27,680
For us, some of the key
takeaways from this research are,

494
00:25:27,680 --> 00:25:29,560
you know, first and foremost,

495
00:25:29,560 --> 00:25:31,633
the diversity of threat actors

496
00:25:31,633 --> 00:25:34,210
that are actually
targeting utility providers

497
00:25:34,210 --> 00:25:36,010
in ICS systems.

498
00:25:36,010 --> 00:25:39,500
I think judging by how quickly
these attackers operated,

499
00:25:39,500 --> 00:25:40,740
and their ability to pivot

500
00:25:40,740 --> 00:25:43,683
from the IT environment
to the OT environment.

501
00:25:45,010 --> 00:25:46,410
I think while we can conclude

502
00:25:46,410 --> 00:25:48,910
that this is likely a cyber crime group,

503
00:25:48,910 --> 00:25:52,270
they're still very familiar
with ICS environment.

504
00:25:52,270 --> 00:25:55,709
The security measures that
utility providers implemented

505
00:25:55,709 --> 00:25:59,607
and how to move from an IT
environment to an OT environment.

506
00:25:59,607 --> 00:26:02,120
And I think what this suggests,

507
00:26:02,120 --> 00:26:04,510
that this honeypot wasn't the first time

508
00:26:04,510 --> 00:26:05,379
that they've done this

509
00:26:05,380 --> 00:26:07,810
and they've probably
been implementing this

510
00:26:07,810 --> 00:26:09,173
playbook fairly often.

511
00:26:10,360 --> 00:26:12,020
The other thing is I think that

512
00:26:12,020 --> 00:26:15,200
the fact that multiple tiers of attackers

513
00:26:15,200 --> 00:26:18,296
find ICS environments interesting,

514
00:26:18,296 --> 00:26:20,920
very likely means increased risk

515
00:26:20,920 --> 00:26:24,120
for people who operate
these type of systems.

516
00:26:24,120 --> 00:26:26,679
I think the security basics are really

517
00:26:26,680 --> 00:26:28,470
what's gonna prevent it badly

518
00:26:28,470 --> 00:26:32,820
from becoming a catastrophic
day in these environments.

519
00:26:32,820 --> 00:26:36,530
I think, you know, when you
think about these environments

520
00:26:36,530 --> 00:26:38,980
in most utility providers,
not all of them,

521
00:26:38,980 --> 00:26:41,126
but I would say most environments,

522
00:26:41,126 --> 00:26:44,250
these systems are old, they're fragile.

523
00:26:44,250 --> 00:26:47,020
And even trained hacking
units make mistakes

524
00:26:47,020 --> 00:26:49,250
that cause failures in these controls

525
00:26:49,250 --> 00:26:52,100
and hackers seeking to
make a name for themselves,

526
00:26:52,100 --> 00:26:55,029
or simply prove that they
can get into a system

527
00:26:55,029 --> 00:26:58,474
I think are far more
likely to cause failures

528
00:26:58,474 --> 00:27:02,139
out of ignorance rather than malice.

529
00:27:02,140 --> 00:27:04,470
And I think this makes instant response

530
00:27:04,470 --> 00:27:08,090
and attribution harder, but I think

531
00:27:08,090 --> 00:27:10,100
it also is more likely to result

532
00:27:10,100 --> 00:27:12,943
in an unintended real-world effect.

533
00:27:14,180 --> 00:27:17,090
Now, second, I think it's important

534
00:27:17,090 --> 00:27:19,780
that the companies where ICS environments

535
00:27:19,780 --> 00:27:23,200
operate a unified sock
that provides visibility

536
00:27:23,200 --> 00:27:26,340
into the IT and OT environment, right?

537
00:27:26,340 --> 00:27:29,580
I think as we saw in
the honeypot research,

538
00:27:29,580 --> 00:27:32,030
attackers are looking
to use IT environments

539
00:27:32,030 --> 00:27:34,879
as gateways into OT environments.

540
00:27:34,880 --> 00:27:37,650
I think we need to have an ability

541
00:27:37,650 --> 00:27:40,270
to correlate activities that are starting

542
00:27:40,270 --> 00:27:41,480
in the IT environment,

543
00:27:41,480 --> 00:27:46,130
or starting in the OT environment
and traverse that bridge

544
00:27:46,130 --> 00:27:47,070
between those environments.

545
00:27:47,070 --> 00:27:48,649
So we can have a better understanding

546
00:27:48,650 --> 00:27:50,715
of how to respond to them

547
00:27:50,715 --> 00:27:52,812
and the nature of the
risk that they present.

548
00:27:52,813 --> 00:27:54,380
I think often companies have a NOC

549
00:27:54,380 --> 00:27:55,940
monitoring the OT environment,

550
00:27:55,940 --> 00:27:59,030
but a combined sock lets you see

551
00:27:59,030 --> 00:28:02,139
all operations as as they
move through the network.

552
00:28:02,140 --> 00:28:04,830
And I think having that
visibility is important

553
00:28:04,830 --> 00:28:07,860
because attackers, as we see here,

554
00:28:07,860 --> 00:28:10,199
could very likely start
in the IT environment

555
00:28:10,200 --> 00:28:12,860
and move to the OT environment.

556
00:28:12,860 --> 00:28:16,800
And lastly, I think hunting is critical.

557
00:28:16,800 --> 00:28:20,020
You know, this activity
looks for indicators

558
00:28:20,020 --> 00:28:23,690
that attackers are already
in the company's environment

559
00:28:23,690 --> 00:28:26,230
instead of waiting to react to an alert

560
00:28:26,230 --> 00:28:28,017
issued by a security tool I think,

561
00:28:28,017 --> 00:28:29,930
threat hunting allows defenders

562
00:28:29,930 --> 00:28:32,460
to take a proactive approach to security

563
00:28:32,460 --> 00:28:33,950
by detecting adversaries

564
00:28:33,950 --> 00:28:36,752
before they cause severe
damage to a network.

565
00:28:36,752 --> 00:28:39,930
And I think establishing
and putting visibility,

566
00:28:39,930 --> 00:28:42,630
having behavioral detection capabilities

567
00:28:42,630 --> 00:28:45,700
are gonna be critical for
effective threat hunting,

568
00:28:45,700 --> 00:28:49,653
let alone for scoping and
responding to those incidents.

569
00:28:51,870 --> 00:28:55,709
And with that, first and foremost
I would like to thank you

570
00:28:55,710 --> 00:28:58,610
for joining us on this session

571
00:28:58,610 --> 00:29:00,723
and open the session up for any questions.

