1
00:00:05,440 --> 00:00:07,839
welcome to ransomware exploded modern

2
00:00:07,839 --> 00:00:09,519
defenses against the technological

3
00:00:09,519 --> 00:00:11,920
plague i'm chester wisniewski principal

4
00:00:11,920 --> 00:00:14,880
research scientist at sofos and my goal

5
00:00:14,880 --> 00:00:16,720
is to share with you some of the latest

6
00:00:16,720 --> 00:00:18,560
information that we've seen in sofas

7
00:00:18,560 --> 00:00:20,560
labs related to ransomware

8
00:00:20,560 --> 00:00:23,359
and how the criminals are using

9
00:00:23,359 --> 00:00:25,760
tactics to compromise their victims i'm

10
00:00:25,760 --> 00:00:27,840
hoping that we can also then inform you

11
00:00:27,840 --> 00:00:29,359
of ways you may be able to better defend

12
00:00:29,359 --> 00:00:32,640
yourself against these threats

13
00:00:36,239 --> 00:00:38,160
so we'll start out by talking about

14
00:00:38,160 --> 00:00:39,600
who's really targeted and how they're

15
00:00:39,600 --> 00:00:41,440
acquiring their targets

16
00:00:41,440 --> 00:00:42,879
we'll go through some of the most

17
00:00:42,879 --> 00:00:45,520
frequently exploited products and

18
00:00:45,520 --> 00:00:47,280
services that they're using to gain a

19
00:00:47,280 --> 00:00:49,440
foothold inside of your networks we'll

20
00:00:49,440 --> 00:00:51,120
also look at a bit of how they abuse

21
00:00:51,120 --> 00:00:53,920
trust that you may have in vendors and

22
00:00:53,920 --> 00:00:55,440
other parts of your supply chain that

23
00:00:55,440 --> 00:00:58,160
may give them a foothold to gain access

24
00:00:58,160 --> 00:00:59,520
to your network through legitimate

25
00:00:59,520 --> 00:01:01,600
access

26
00:01:01,600 --> 00:01:03,280
there's a lot of abuse of legitimate

27
00:01:03,280 --> 00:01:04,959
tools so we'll talk about what those

28
00:01:04,959 --> 00:01:06,400
tools are and a little bit of the

29
00:01:06,400 --> 00:01:08,320
behavior of what it looks like when

30
00:01:08,320 --> 00:01:10,400
those tools are being abused

31
00:01:10,400 --> 00:01:13,920
and of course uh impairing your recovery

32
00:01:13,920 --> 00:01:15,200
they want to make sure that you're in a

33
00:01:15,200 --> 00:01:16,560
particularly difficult bind if they

34
00:01:16,560 --> 00:01:18,479
manage to get into your network uh to

35
00:01:18,479 --> 00:01:19,920
make it that much more difficult to

36
00:01:19,920 --> 00:01:22,159
recover from these attacks and we'll

37
00:01:22,159 --> 00:01:23,119
take

38
00:01:23,119 --> 00:01:25,759
a glance at what that looks like

39
00:01:25,759 --> 00:01:27,280
as well as how they identify the

40
00:01:27,280 --> 00:01:29,520
valuable things that they want to steal

41
00:01:29,520 --> 00:01:32,000
and ultimately how they're locking it up

42
00:01:32,000 --> 00:01:34,240
it may seem obvious but there are some

43
00:01:34,240 --> 00:01:36,560
nuances to that that can help defenders

44
00:01:36,560 --> 00:01:39,840
spot malicious activity

45
00:01:39,840 --> 00:01:41,439
of course to wrap things up we're going

46
00:01:41,439 --> 00:01:43,520
to want to talk about modern defenses

47
00:01:43,520 --> 00:01:45,520
and how

48
00:01:45,520 --> 00:01:47,759
how to monitor and master those basics

49
00:01:47,759 --> 00:01:49,759
and what specific things are most

50
00:01:49,759 --> 00:01:51,200
important to look for amongst those

51
00:01:51,200 --> 00:01:53,759
basics how you get a baseline for what

52
00:01:53,759 --> 00:01:57,360
things should look like uh best ways to

53
00:01:57,360 --> 00:01:59,920
deploy multi-factor if you're unable or

54
00:01:59,920 --> 00:02:01,360
unwilling to necessarily deploy it

55
00:02:01,360 --> 00:02:03,200
across your entire estate where it's

56
00:02:03,200 --> 00:02:05,119
most effective and strategies you can

57
00:02:05,119 --> 00:02:06,399
use to

58
00:02:06,399 --> 00:02:09,360
only impose the tax if you will

59
00:02:09,360 --> 00:02:10,878
when necessary

60
00:02:10,878 --> 00:02:11,920
and

61
00:02:11,920 --> 00:02:14,879
you know when to update when to mitigate

62
00:02:14,879 --> 00:02:17,120
and how to segment the network better

63
00:02:17,120 --> 00:02:19,040
and ultimately how to go into threat

64
00:02:19,040 --> 00:02:21,280
hunting mode so you can find attackers

65
00:02:21,280 --> 00:02:23,360
if they manage to make it past your best

66
00:02:23,360 --> 00:02:25,920
defenses

67
00:02:28,400 --> 00:02:29,200
so

68
00:02:29,200 --> 00:02:30,720
you know how are they getting into the

69
00:02:30,720 --> 00:02:32,480
network ultimately like how are they

70
00:02:32,480 --> 00:02:34,560
gaining access what is the way that

71
00:02:34,560 --> 00:02:37,360
you're most likely to succumb to attacks

72
00:02:37,360 --> 00:02:40,480
by these types of criminals

73
00:02:40,720 --> 00:02:43,120
and the truth is the criminals

74
00:02:43,120 --> 00:02:44,720
themselves that are conducting ransom

75
00:02:44,720 --> 00:02:47,280
attacks in most cases are not actually

76
00:02:47,280 --> 00:02:48,879
the ones breaking into your network to

77
00:02:48,879 --> 00:02:51,200
begin with they're typically buying you

78
00:02:51,200 --> 00:02:53,680
from what is now being called an initial

79
00:02:53,680 --> 00:02:56,080
access broker uh

80
00:02:56,080 --> 00:02:57,280
you know in the

81
00:02:57,280 --> 00:02:58,480
back in the day if you've been doing

82
00:02:58,480 --> 00:02:59,760
this for a while you may have heard of

83
00:02:59,760 --> 00:03:02,159
people having loaders this kind of thing

84
00:03:02,159 --> 00:03:04,000
where in essence they're infecting your

85
00:03:04,000 --> 00:03:04,959
machine

86
00:03:04,959 --> 00:03:06,480
with a small piece of malware that

87
00:03:06,480 --> 00:03:08,159
allows them to have a foothold inside of

88
00:03:08,159 --> 00:03:10,000
that computer and then

89
00:03:10,000 --> 00:03:11,519
can later on bring down additional

90
00:03:11,519 --> 00:03:13,920
payloads which

91
00:03:13,920 --> 00:03:15,680
means they can sell you off if you will

92
00:03:15,680 --> 00:03:17,920
to other criminals and on the left side

93
00:03:17,920 --> 00:03:20,560
of your screen you can see there that uh

94
00:03:20,560 --> 00:03:22,480
you know emails are a very popular way

95
00:03:22,480 --> 00:03:24,400
of doing this and what's interesting is

96
00:03:24,400 --> 00:03:26,000
in addition to just sending you directly

97
00:03:26,000 --> 00:03:28,159
the attachments like you see in the word

98
00:03:28,159 --> 00:03:30,159
screenshot there in the middle

99
00:03:30,159 --> 00:03:32,159
what way they're using now is to evade

100
00:03:32,159 --> 00:03:34,159
anti-spam technologies and to evade

101
00:03:34,159 --> 00:03:36,080
sandboxing technologies and other things

102
00:03:36,080 --> 00:03:38,720
that will automatically investigate or

103
00:03:38,720 --> 00:03:41,519
explode a payload or an attachment that

104
00:03:41,519 --> 00:03:43,120
could allow it to be detected by the

105
00:03:43,120 --> 00:03:44,239
good guys

106
00:03:44,239 --> 00:03:47,519
uh they're often luring people with

107
00:03:47,519 --> 00:03:49,519
into making phone calls and other things

108
00:03:49,519 --> 00:03:50,879
these are two examples from north

109
00:03:50,879 --> 00:03:53,280
america but we have seen these globally

110
00:03:53,280 --> 00:03:55,599
uh you know the the top one is about a

111
00:03:55,599 --> 00:03:57,200
subscription that you've signed up for

112
00:03:57,200 --> 00:03:59,120
for a video service and if you want to

113
00:03:59,120 --> 00:04:00,319
cancel that you don't want your credit

114
00:04:00,319 --> 00:04:01,680
card to be charged you should call this

115
00:04:01,680 --> 00:04:04,480
phone number uh to to let them know

116
00:04:04,480 --> 00:04:06,159
the second one i actually received in my

117
00:04:06,159 --> 00:04:09,200
own inbox and a honeypot i run at home

118
00:04:09,200 --> 00:04:10,720
that claims to be from amazon web

119
00:04:10,720 --> 00:04:12,000
services and that i'm going to be

120
00:04:12,000 --> 00:04:15,200
charged a 120 us dollars a month if i

121
00:04:15,200 --> 00:04:17,358
don't cancel my subscription and if i

122
00:04:17,358 --> 00:04:19,358
would like to cancel it i conveniently

123
00:04:19,358 --> 00:04:21,519
can call this phone number now that

124
00:04:21,519 --> 00:04:24,320
phone number uh plus one two zero six is

125
00:04:24,320 --> 00:04:26,320
uh the united states of america 206 is

126
00:04:26,320 --> 00:04:28,800
seattle so even for people in america

127
00:04:28,800 --> 00:04:30,240
that might be somewhat familiar and go

128
00:04:30,240 --> 00:04:32,080
oh amazon right they're in seattle it

129
00:04:32,080 --> 00:04:33,919
makes sense that i could call this phone

130
00:04:33,919 --> 00:04:35,680
number in seattle in order to cancel the

131
00:04:35,680 --> 00:04:37,360
subscription service

132
00:04:37,360 --> 00:04:38,800
it seems pretty innocuous because of

133
00:04:38,800 --> 00:04:40,160
course there's nothing here to block

134
00:04:40,160 --> 00:04:42,080
there's there's no link to a website

135
00:04:42,080 --> 00:04:44,240
there's no attachment but when i in fact

136
00:04:44,240 --> 00:04:45,680
call that number

137
00:04:45,680 --> 00:04:47,120
i get someone on the phone in a call

138
00:04:47,120 --> 00:04:48,880
center and that person in the call

139
00:04:48,880 --> 00:04:50,880
center explains to me that oh if i'd

140
00:04:50,880 --> 00:04:52,639
like to unsubscribe to this service

141
00:04:52,639 --> 00:04:54,320
actually what i need to do

142
00:04:54,320 --> 00:04:56,639
is type in this website into my web

143
00:04:56,639 --> 00:04:57,840
browser so

144
00:04:57,840 --> 00:04:59,840
uh of course that's the way that they're

145
00:04:59,840 --> 00:05:01,919
gonna lure you to the malicious document

146
00:05:01,919 --> 00:05:03,919
and then once i get there i download a

147
00:05:03,919 --> 00:05:05,840
word document like you see pictured and

148
00:05:05,840 --> 00:05:07,759
they go oh right so you're gonna have to

149
00:05:07,759 --> 00:05:09,360
enable the macros because when you fill

150
00:05:09,360 --> 00:05:11,600
out the form to cancel the service it

151
00:05:11,600 --> 00:05:13,520
needs to send us the message back over

152
00:05:13,520 --> 00:05:15,360
the internet and that's what the macro

153
00:05:15,360 --> 00:05:17,440
does right it allows us to to see that

154
00:05:17,440 --> 00:05:19,280
you filled out the form correctly and in

155
00:05:19,280 --> 00:05:21,199
fact you want to cancel your service and

156
00:05:21,199 --> 00:05:22,400
when in reality of course you're

157
00:05:22,400 --> 00:05:24,000
inviting a trojan horse onto your

158
00:05:24,000 --> 00:05:26,160
computer now that computer if it's an

159
00:05:26,160 --> 00:05:27,840
individual's computer

160
00:05:27,840 --> 00:05:29,680
may just have information stolen from it

161
00:05:29,680 --> 00:05:31,600
or it may be used to later on send spam

162
00:05:31,600 --> 00:05:33,520
things like that but in the context of

163
00:05:33,520 --> 00:05:35,280
ransomware if it happens to be your

164
00:05:35,280 --> 00:05:37,840
corporate computer they now know

165
00:05:37,840 --> 00:05:39,520
that that's a computer that is a member

166
00:05:39,520 --> 00:05:41,680
of a domain and they can usually discern

167
00:05:41,680 --> 00:05:43,440
by the name of that domain or the

168
00:05:43,440 --> 00:05:44,720
internet domain that that computer is

169
00:05:44,720 --> 00:05:46,639
connected from that that is in fact a

170
00:05:46,639 --> 00:05:48,000
business computer which they may be able

171
00:05:48,000 --> 00:05:51,360
to sell up to other criminals

172
00:05:51,360 --> 00:05:53,199
much of remote access can be abused that

173
00:05:53,199 --> 00:05:54,960
way as well we see credential stuffing

174
00:05:54,960 --> 00:05:57,840
against rdp vnc

175
00:05:57,840 --> 00:06:00,560
teamviewer log me in all these different

176
00:06:00,560 --> 00:06:03,280
types of remote access services and you

177
00:06:03,280 --> 00:06:04,639
can see on the right side of your screen

178
00:06:04,639 --> 00:06:06,160
that's actually an underground form on

179
00:06:06,160 --> 00:06:08,960
the dark web known as uas shop and

180
00:06:08,960 --> 00:06:10,479
that's some of the victim computers

181
00:06:10,479 --> 00:06:12,560
listed there that i can choose to buy

182
00:06:12,560 --> 00:06:14,400
from the criminals and remotely access

183
00:06:14,400 --> 00:06:16,479
them for very small sums of money you

184
00:06:16,479 --> 00:06:17,440
can see

185
00:06:17,440 --> 00:06:20,160
less than 20 us dollars is sort of the

186
00:06:20,160 --> 00:06:22,000
going rate they tell you how much

187
00:06:22,000 --> 00:06:24,080
bandwidth what the operating system is

188
00:06:24,080 --> 00:06:26,080
how much memory it has that kind of

189
00:06:26,080 --> 00:06:28,240
thing of course if you buy access to

190
00:06:28,240 --> 00:06:29,520
these computers you then can find out

191
00:06:29,520 --> 00:06:32,319
the full name of the computer the full

192
00:06:32,319 --> 00:06:34,319
ip address then you may be able to

193
00:06:34,319 --> 00:06:36,240
target specific organizations that have

194
00:06:36,240 --> 00:06:38,160
had computers compromised that are being

195
00:06:38,160 --> 00:06:41,280
sold through these forums

196
00:06:43,199 --> 00:06:44,880
other things they're doing is exploiting

197
00:06:44,880 --> 00:06:46,479
weaknesses and flaws that have been

198
00:06:46,479 --> 00:06:48,800
unpatched and unfortunately this is

199
00:06:48,800 --> 00:06:51,520
incredibly common uh the most frequently

200
00:06:51,520 --> 00:06:54,080
things we see being exploited have been

201
00:06:54,080 --> 00:06:56,000
remote access technologies followed by

202
00:06:56,000 --> 00:06:58,800
email services so going all the way back

203
00:06:58,800 --> 00:07:01,199
to january of 2020 we're coming you know

204
00:07:01,199 --> 00:07:04,080
a year and three quarters ago now

205
00:07:04,080 --> 00:07:06,639
we're still seeing heavy abuse of citrus

206
00:07:06,639 --> 00:07:08,240
vulnerabilities one of them was well

207
00:07:08,240 --> 00:07:10,479
known as called the citrix vulnerability

208
00:07:10,479 --> 00:07:12,639
uh in citrix remote access systems

209
00:07:12,639 --> 00:07:14,319
there's still lots of unpatched systems

210
00:07:14,319 --> 00:07:16,560
out there unfortunately that

211
00:07:16,560 --> 00:07:18,880
can be exploited using that other common

212
00:07:18,880 --> 00:07:20,800
ones are against vpn solutions like

213
00:07:20,800 --> 00:07:23,599
pulse secure and florida vpn and

214
00:07:23,599 --> 00:07:24,960
unfortunately for fortinet also

215
00:07:24,960 --> 00:07:26,639
fortigate firewalls have been pretty

216
00:07:26,639 --> 00:07:29,039
heavily exploited using some of these

217
00:07:29,039 --> 00:07:31,520
just scanning the internet with uh

218
00:07:31,520 --> 00:07:34,080
census.io to style or showdown style

219
00:07:34,080 --> 00:07:36,720
services looking for unpatched firewalls

220
00:07:36,720 --> 00:07:38,560
and vpns as a way to gain access to

221
00:07:38,560 --> 00:07:40,880
networks that's particularly dangerous

222
00:07:40,880 --> 00:07:43,360
because vpn servers are almost always a

223
00:07:43,360 --> 00:07:45,039
member of active directory because you

224
00:07:45,039 --> 00:07:47,440
want remote access users to not have to

225
00:07:47,440 --> 00:07:48,800
have a unique password of course you

226
00:07:48,800 --> 00:07:50,720
want to share authentication with your

227
00:07:50,720 --> 00:07:52,400
enterprise but that means if the

228
00:07:52,400 --> 00:07:55,039
criminals gain root access to those vpn

229
00:07:55,039 --> 00:07:57,280
concentrators they often can dump the

230
00:07:57,280 --> 00:07:59,120
entire active directory as a domain

231
00:07:59,120 --> 00:08:00,560
admin and gain access to all of your

232
00:08:00,560 --> 00:08:03,440
credentials within your organization

233
00:08:03,440 --> 00:08:05,440
we're still seeing exchange being abused

234
00:08:05,440 --> 00:08:07,199
by all kinds of different groups not

235
00:08:07,199 --> 00:08:09,199
just ransomware we do see crypto miners

236
00:08:09,199 --> 00:08:10,400
and other things targeting exchange

237
00:08:10,400 --> 00:08:12,319
servers but there were several serious

238
00:08:12,319 --> 00:08:14,479
exchange vulnerabilities one around

239
00:08:14,479 --> 00:08:16,800
february of 2021 and another major one

240
00:08:16,800 --> 00:08:19,360
in august of 2021 and both of those are

241
00:08:19,360 --> 00:08:20,879
still under heavy exploitation for

242
00:08:20,879 --> 00:08:22,879
organizations that haven't yet been able

243
00:08:22,879 --> 00:08:23,919
to patch

244
00:08:23,919 --> 00:08:26,080
against those in fact most of the

245
00:08:26,080 --> 00:08:28,160
victims we see when we see exchange as

246
00:08:28,160 --> 00:08:30,639
the entry into their network

247
00:08:30,639 --> 00:08:32,000
they're criminal multiple different

248
00:08:32,000 --> 00:08:33,360
criminals have been there we'll often

249
00:08:33,360 --> 00:08:34,640
see there was a crypto miner and then

250
00:08:34,640 --> 00:08:36,080
later on they were ransomed by a

251
00:08:36,080 --> 00:08:38,560
different group

252
00:08:39,839 --> 00:08:41,839
abusing trust is big i'm not going to go

253
00:08:41,839 --> 00:08:43,440
through this in too much detail but this

254
00:08:43,440 --> 00:08:46,240
is a kind of a diagram of how

255
00:08:46,240 --> 00:08:48,640
the cassaya attack cassette of course is

256
00:08:48,640 --> 00:08:50,320
a remote access solution and they offer

257
00:08:50,320 --> 00:08:52,160
a cloud product and they offer an

258
00:08:52,160 --> 00:08:54,000
on-premise product it's often used by

259
00:08:54,000 --> 00:08:56,480
managed security service providers or

260
00:08:56,480 --> 00:08:58,480
managed service providers to

261
00:08:58,480 --> 00:09:00,320
remotely access their customers networks

262
00:09:00,320 --> 00:09:02,480
in order to provide services to them

263
00:09:02,480 --> 00:09:04,320
and this was a vulnerability in the web

264
00:09:04,320 --> 00:09:06,160
server that was part of the on-premises

265
00:09:06,160 --> 00:09:08,720
version of the cassea

266
00:09:08,720 --> 00:09:10,560
remote access offering

267
00:09:10,560 --> 00:09:12,080
almost always this would be outwardly

268
00:09:12,080 --> 00:09:14,080
facing so that that service provider can

269
00:09:14,080 --> 00:09:17,120
access the web portal to log into their

270
00:09:17,120 --> 00:09:18,800
customers network in order to manage

271
00:09:18,800 --> 00:09:21,040
their computers on their behalf

272
00:09:21,040 --> 00:09:22,399
and unfortunately it had an

273
00:09:22,399 --> 00:09:25,120
unauthenticated uh upload vulnerability

274
00:09:25,120 --> 00:09:27,760
that allowed sql uh injection and

275
00:09:27,760 --> 00:09:29,920
through that they were able to instruct

276
00:09:29,920 --> 00:09:32,160
the the remote access agents on all the

277
00:09:32,160 --> 00:09:34,800
computers within the victims to retrieve

278
00:09:34,800 --> 00:09:37,120
a specialized digital certificate that

279
00:09:37,120 --> 00:09:39,200
was actually the malicious payload

280
00:09:39,200 --> 00:09:41,040
wrapped up in a certificate

281
00:09:41,040 --> 00:09:42,080
which meant when it came through

282
00:09:42,080 --> 00:09:44,080
firewalls or scanners it just looked

283
00:09:44,080 --> 00:09:46,160
like any other encrypted blob that was a

284
00:09:46,160 --> 00:09:47,839
digital certificate something perfectly

285
00:09:47,839 --> 00:09:50,240
legitimate which the malware then used

286
00:09:50,240 --> 00:09:52,320
powershell to unpack and when it

287
00:09:52,320 --> 00:09:53,600
unpacked it

288
00:09:53,600 --> 00:09:55,360
with the cert util

289
00:09:55,360 --> 00:09:57,279
built into windows

290
00:09:57,279 --> 00:10:00,399
it extracted uh the certificate into two

291
00:10:00,399 --> 00:10:01,839
different files and the two files that

292
00:10:01,839 --> 00:10:03,839
were inside of that certificate were a

293
00:10:03,839 --> 00:10:05,839
vulnerable version of microsoft defender

294
00:10:05,839 --> 00:10:07,920
signed by microsoft another legitimate

295
00:10:07,920 --> 00:10:10,800
piece of code that could be exploited to

296
00:10:10,800 --> 00:10:12,640
do what's called a side load attack and

297
00:10:12,640 --> 00:10:15,120
sort of inject malicious code into that

298
00:10:15,120 --> 00:10:17,279
legitimate windows defender process

299
00:10:17,279 --> 00:10:19,440
resulting in the ransomware in the end

300
00:10:19,440 --> 00:10:21,440
and this is a really complex attack

301
00:10:21,440 --> 00:10:23,040
chain and it shows why

302
00:10:23,040 --> 00:10:24,640
basic things like traditional

303
00:10:24,640 --> 00:10:26,480
old-fashioned antivirus is often

304
00:10:26,480 --> 00:10:27,760
ineffective at blocking these more

305
00:10:27,760 --> 00:10:29,600
sophisticated attacks

306
00:10:29,600 --> 00:10:31,680
the truth is the legitimate files are

307
00:10:31,680 --> 00:10:33,600
all of the executables that were run

308
00:10:33,600 --> 00:10:35,200
were legitimate executables that were

309
00:10:35,200 --> 00:10:37,760
signed by microsoft we saw cert util

310
00:10:37,760 --> 00:10:39,120
powershell

311
00:10:39,120 --> 00:10:41,519
uh microsoft defender these are all

312
00:10:41,519 --> 00:10:44,000
legitimate programs signed by microsoft

313
00:10:44,000 --> 00:10:45,839
that were all part of this attack chain

314
00:10:45,839 --> 00:10:48,320
so looking at the behavior in the entire

315
00:10:48,320 --> 00:10:49,600
um

316
00:10:49,600 --> 00:10:52,160
40 000 foot view of the attack surface

317
00:10:52,160 --> 00:10:54,240
is really important for modern defense

318
00:10:54,240 --> 00:10:55,760
technologies to be effective against

319
00:10:55,760 --> 00:11:00,279
these styles of ransomware attacks

320
00:11:01,360 --> 00:11:02,959
once they're inside the network and

321
00:11:02,959 --> 00:11:04,880
they've got a foothold they're starting

322
00:11:04,880 --> 00:11:07,279
to use your tools against you and some

323
00:11:07,279 --> 00:11:09,440
of these are more legitimate than others

324
00:11:09,440 --> 00:11:11,200
but all of them by no means are

325
00:11:11,200 --> 00:11:14,399
considered malicious files or malware

326
00:11:14,399 --> 00:11:16,399
angry ip scanner will often be used to

327
00:11:16,399 --> 00:11:18,959
scan your network or if not that maybe

328
00:11:18,959 --> 00:11:21,440
things like nmap or even other

329
00:11:21,440 --> 00:11:23,040
freely available software like nessus

330
00:11:23,040 --> 00:11:24,480
can be used to scan your network to

331
00:11:24,480 --> 00:11:26,880
identify all of the assets that they may

332
00:11:26,880 --> 00:11:30,959
want to steal data from and or encrypt

333
00:11:30,959 --> 00:11:33,839
meme cats by gentle kiwi is a

334
00:11:33,839 --> 00:11:36,240
known well-known red team or tool

335
00:11:36,240 --> 00:11:37,600
frequently used in these attacks against

336
00:11:37,600 --> 00:11:39,120
the steel credentials or elevate

337
00:11:39,120 --> 00:11:40,320
privilege

338
00:11:40,320 --> 00:11:42,480
if there's an ability to run this even

339
00:11:42,480 --> 00:11:43,920
if you're a lower privileged user you

340
00:11:43,920 --> 00:11:45,519
may be able to run this tool to grab

341
00:11:45,519 --> 00:11:47,519
password hashes from memory that belong

342
00:11:47,519 --> 00:11:49,120
to administrators and allow yourself to

343
00:11:49,120 --> 00:11:51,519
become a domain administrator

344
00:11:51,519 --> 00:11:53,120
microsoft tools that are frequently used

345
00:11:53,120 --> 00:11:55,600
by legitimate admins are also in part of

346
00:11:55,600 --> 00:11:57,040
these attack chains powershell and

347
00:11:57,040 --> 00:11:59,120
windows system turns tools things like

348
00:11:59,120 --> 00:12:03,279
ps exact ps kill uh process explorer etc

349
00:12:03,279 --> 00:12:05,760
and in the end another tool that's open

350
00:12:05,760 --> 00:12:07,760
source uh often used for backups called

351
00:12:07,760 --> 00:12:10,800
rclone is used to exfiltrate stolen data

352
00:12:10,800 --> 00:12:12,160
this complicates things right because

353
00:12:12,160 --> 00:12:13,600
your antivirus vendor and your security

354
00:12:13,600 --> 00:12:15,279
vendor is unlikely to automatically

355
00:12:15,279 --> 00:12:17,040
consider powershell activity be

356
00:12:17,040 --> 00:12:18,720
malicious or window assist internals

357
00:12:18,720 --> 00:12:21,680
tools so you need to be able to

358
00:12:21,680 --> 00:12:23,440
monitor and manage these legitimate

359
00:12:23,440 --> 00:12:25,440
tools and see when they're used

360
00:12:25,440 --> 00:12:28,240
behaviorally in a attack chain

361
00:12:28,240 --> 00:12:30,160
that is different than the expected or

362
00:12:30,160 --> 00:12:32,160
normal use that you would see your

363
00:12:32,160 --> 00:12:34,000
administrators use to manage your

364
00:12:34,000 --> 00:12:37,000
network

365
00:12:38,399 --> 00:12:40,480
and that takes us to the next step uh

366
00:12:40,480 --> 00:12:41,760
now that they've got a foothold and

367
00:12:41,760 --> 00:12:42,800
they've been able to explore your

368
00:12:42,800 --> 00:12:44,959
network using your tools now it's time

369
00:12:44,959 --> 00:12:47,200
to steal your information and send it

370
00:12:47,200 --> 00:12:49,040
off to the crooks so that they can later

371
00:12:49,040 --> 00:12:52,000
extort you not all groups do this this

372
00:12:52,000 --> 00:12:54,320
technique started around two years ago

373
00:12:54,320 --> 00:12:56,720
uh maybe a little longer where the maze

374
00:12:56,720 --> 00:12:58,079
group started

375
00:12:58,079 --> 00:12:59,760
you know specifically stealing data

376
00:12:59,760 --> 00:13:01,600
before they encrypted it almost all

377
00:13:01,600 --> 00:13:04,079
ransom groups do this now uh the number

378
00:13:04,079 --> 00:13:05,440
of groups and the names change on a

379
00:13:05,440 --> 00:13:06,560
weekly basis

380
00:13:06,560 --> 00:13:09,120
as i'm recording this the rival group

381
00:13:09,120 --> 00:13:11,200
was apparently taken down perhaps by the

382
00:13:11,200 --> 00:13:13,040
us government and some other

383
00:13:13,040 --> 00:13:15,279
countries cooperating to disable their

384
00:13:15,279 --> 00:13:17,120
networks but they'll

385
00:13:17,120 --> 00:13:19,120
you know soon be back with another name

386
00:13:19,120 --> 00:13:20,639
or another group will simply replace

387
00:13:20,639 --> 00:13:22,000
their malicious activity because there's

388
00:13:22,000 --> 00:13:23,920
too much money on the line to stop

389
00:13:23,920 --> 00:13:25,600
and once they're in they'll start

390
00:13:25,600 --> 00:13:26,959
scouring your network specifically

391
00:13:26,959 --> 00:13:28,320
looking for information from your

392
00:13:28,320 --> 00:13:32,240
finance human resources i.t departments

393
00:13:32,240 --> 00:13:33,839
they'll look for file names that have

394
00:13:33,839 --> 00:13:36,160
words like budget or passwords because

395
00:13:36,160 --> 00:13:38,160
many organizations unfortunately are

396
00:13:38,160 --> 00:13:40,240
still putting lots of shared passwords

397
00:13:40,240 --> 00:13:42,240
into spreadsheets or sending them around

398
00:13:42,240 --> 00:13:44,320
through unencrypted emails

399
00:13:44,320 --> 00:13:45,680
they're looking for things that they can

400
00:13:45,680 --> 00:13:47,440
use to extort you legal documents in

401
00:13:47,440 --> 00:13:49,600
particular maybe you have contracts or

402
00:13:49,600 --> 00:13:51,040
settlements with competitors or

403
00:13:51,040 --> 00:13:53,279
employees over certain legal issues and

404
00:13:53,279 --> 00:13:54,720
if they were to release those publicly

405
00:13:54,720 --> 00:13:56,639
be very embarrassing to your

406
00:13:56,639 --> 00:13:58,000
organization so that's the kind of thing

407
00:13:58,000 --> 00:13:59,440
they're looking for in order to find

408
00:13:59,440 --> 00:14:00,160
that

409
00:14:00,160 --> 00:14:01,600
they'll simply look at active directory

410
00:14:01,600 --> 00:14:03,279
to find all the file servers within your

411
00:14:03,279 --> 00:14:05,839
network where they need to go looking

412
00:14:05,839 --> 00:14:07,600
once they find what they're looking for

413
00:14:07,600 --> 00:14:10,160
they'll use that rclone open source tool

414
00:14:10,160 --> 00:14:11,040
to

415
00:14:11,040 --> 00:14:13,360
synchronize all of the uh

416
00:14:13,360 --> 00:14:15,519
good stolen documents up to some sort of

417
00:14:15,519 --> 00:14:17,680
a file sharing service in the cloud

418
00:14:17,680 --> 00:14:19,279
they'll want to use legitimate ones

419
00:14:19,279 --> 00:14:20,560
that'll blend in with your normal

420
00:14:20,560 --> 00:14:21,680
traffic

421
00:14:21,680 --> 00:14:23,440
most often we see them abusing a service

422
00:14:23,440 --> 00:14:24,959
called mega

423
00:14:24,959 --> 00:14:27,440
mega dot io used to be called mega dot

424
00:14:27,440 --> 00:14:30,480
co dot nz it's operated by a man named

425
00:14:30,480 --> 00:14:33,839
kim.com who's a convicted criminal but

426
00:14:33,839 --> 00:14:36,399
kind of prac uh proudly calls his file

427
00:14:36,399 --> 00:14:39,600
sharing service a privacy company he had

428
00:14:39,600 --> 00:14:41,760
been accused of facilitating software

429
00:14:41,760 --> 00:14:44,720
piracy it's kind of a good place for

430
00:14:44,720 --> 00:14:46,720
dogs with fleas to go live

431
00:14:46,720 --> 00:14:48,560
but we don't we don't just see abuse of

432
00:14:48,560 --> 00:14:50,079
mega we do see abusive other file

433
00:14:50,079 --> 00:14:52,160
sharing services like google drive

434
00:14:52,160 --> 00:14:54,720
dropbox box.com and others

435
00:14:54,720 --> 00:14:56,240
anywhere they can set up a free account

436
00:14:56,240 --> 00:14:58,079
to store the stolen files or use a

437
00:14:58,079 --> 00:14:59,680
stolen credit card to establish an

438
00:14:59,680 --> 00:15:01,040
account

439
00:15:01,040 --> 00:15:02,639
will blend in with a lot of legitimate

440
00:15:02,639 --> 00:15:04,399
traffic within most organizations as

441
00:15:04,399 --> 00:15:09,160
they steal that sensitive data

442
00:15:12,720 --> 00:15:14,399
now that they've got the stolen data

443
00:15:14,399 --> 00:15:17,120
it's kind of the last before final step

444
00:15:17,120 --> 00:15:19,199
the penultimate step if you will to

445
00:15:19,199 --> 00:15:21,279
sabotage you what they they're trying to

446
00:15:21,279 --> 00:15:23,839
set you up for failure if you will they

447
00:15:23,839 --> 00:15:24,880
know that

448
00:15:24,880 --> 00:15:26,480
the first thing you're going to do is

449
00:15:26,480 --> 00:15:28,639
want to restore your backups and that

450
00:15:28,639 --> 00:15:30,000
your administrators are going to need

451
00:15:30,000 --> 00:15:31,759
access to the network

452
00:15:31,759 --> 00:15:34,240
they'll try to pick times of day in

453
00:15:34,240 --> 00:15:36,079
particular where they think things may

454
00:15:36,079 --> 00:15:37,920
be monitored less frequently so that

455
00:15:37,920 --> 00:15:40,639
gives them a bit of an advantage

456
00:15:40,639 --> 00:15:41,839
to give them time while they're

457
00:15:41,839 --> 00:15:43,120
monkeying around where they may not be

458
00:15:43,120 --> 00:15:44,800
noticed as they're starting to trigger

459
00:15:44,800 --> 00:15:47,279
the early steps of encryption etc so

460
00:15:47,279 --> 00:15:48,560
they'll they'll start scouring the

461
00:15:48,560 --> 00:15:50,399
network to determine how are you doing

462
00:15:50,399 --> 00:15:52,800
your backups are your backups online or

463
00:15:52,800 --> 00:15:54,639
are your backups offline now if your

464
00:15:54,639 --> 00:15:57,120
backups are offline you're safe i mean

465
00:15:57,120 --> 00:15:59,199
largely if you're if they're on hard

466
00:15:59,199 --> 00:16:01,440
disks or taped tapes that are removed

467
00:16:01,440 --> 00:16:03,839
from tape loaders that means that

468
00:16:03,839 --> 00:16:05,360
they're offline and unless the criminal

469
00:16:05,360 --> 00:16:07,759
breaks into your office it's almost

470
00:16:07,759 --> 00:16:09,120
impossible for them to delete them or

471
00:16:09,120 --> 00:16:11,360
destroy them but most organizations

472
00:16:11,360 --> 00:16:12,959
unfortunately are using cloud-based

473
00:16:12,959 --> 00:16:14,880
backup services and or

474
00:16:14,880 --> 00:16:17,440
lots of hard disks and arrays where they

475
00:16:17,440 --> 00:16:19,199
may just be backing them up to live hard

476
00:16:19,199 --> 00:16:20,959
drives that are connected to

477
00:16:20,959 --> 00:16:23,279
sans or other type of shared disk

478
00:16:23,279 --> 00:16:26,160
storage within the network so

479
00:16:26,160 --> 00:16:28,000
when that's the case we you know things

480
00:16:28,000 --> 00:16:30,800
like veeam carbonite will often be cloud

481
00:16:30,800 --> 00:16:33,199
services to manage your backups that may

482
00:16:33,199 --> 00:16:36,320
store them on services like backblaze or

483
00:16:36,320 --> 00:16:38,959
amazon s3 or other

484
00:16:38,959 --> 00:16:41,199
similar type of file storage backends in

485
00:16:41,199 --> 00:16:42,240
the cloud

486
00:16:42,240 --> 00:16:44,560
and for convenience many administrators

487
00:16:44,560 --> 00:16:47,279
will have linked those backup services

488
00:16:47,279 --> 00:16:49,120
to their active directory

489
00:16:49,120 --> 00:16:50,399
and that means

490
00:16:50,399 --> 00:16:52,079
if the criminal already has acquired

491
00:16:52,079 --> 00:16:54,079
administrative access on your network

492
00:16:54,079 --> 00:16:56,160
they can simply log into those backup

493
00:16:56,160 --> 00:16:58,079
services with those same stolen

494
00:16:58,079 --> 00:16:59,279
credentials

495
00:16:59,279 --> 00:17:02,399
to delete the backups and being tying

496
00:17:02,399 --> 00:17:04,000
all these services into active directory

497
00:17:04,000 --> 00:17:05,839
is sort of part of the problem here i

498
00:17:05,839 --> 00:17:07,199
mean it's certainly convenient to have

499
00:17:07,199 --> 00:17:08,959
single sign-on but if that single

500
00:17:08,959 --> 00:17:11,280
sign-on is not protected by multi-factor

501
00:17:11,280 --> 00:17:12,559
authentication

502
00:17:12,559 --> 00:17:15,679
then that means one password stolen can

503
00:17:15,679 --> 00:17:17,599
delete everything including your backups

504
00:17:17,599 --> 00:17:18,480
in the cloud

505
00:17:18,480 --> 00:17:20,160
and this is one of the steps we'll see

506
00:17:20,160 --> 00:17:21,839
right before they're ready to start

507
00:17:21,839 --> 00:17:24,640
triggering the actual ransom attack is

508
00:17:24,640 --> 00:17:26,079
to go in and

509
00:17:26,079 --> 00:17:28,000
delete every backup they can find and

510
00:17:28,000 --> 00:17:30,160
then once they've deleted the backups go

511
00:17:30,160 --> 00:17:32,480
into active directory disable all the

512
00:17:32,480 --> 00:17:34,880
admin accounts to slow down the response

513
00:17:34,880 --> 00:17:37,679
when you finally notice that um you've

514
00:17:37,679 --> 00:17:40,400
been victimized and and and used that as

515
00:17:40,400 --> 00:17:41,280
a way

516
00:17:41,280 --> 00:17:43,360
to continue to negotiate

517
00:17:43,360 --> 00:17:44,720
i don't actually have it in my slides

518
00:17:44,720 --> 00:17:46,160
but i guess it's a good time to mention

519
00:17:46,160 --> 00:17:47,679
because they have compromised your

520
00:17:47,679 --> 00:17:49,760
network when they get to the stage where

521
00:17:49,760 --> 00:17:51,760
they're disabling admin accounts

522
00:17:51,760 --> 00:17:53,679
if you are able to recover recover some

523
00:17:53,679 --> 00:17:55,440
of it remember the criminals are in

524
00:17:55,440 --> 00:17:57,679
control of your network at this point

525
00:17:57,679 --> 00:17:59,520
you can't trust your communication if

526
00:17:59,520 --> 00:18:01,280
you start communicating with one another

527
00:18:01,280 --> 00:18:02,880
about how you're going to kick the

528
00:18:02,880 --> 00:18:04,559
criminals out of your network or how

529
00:18:04,559 --> 00:18:05,520
you're going to

530
00:18:05,520 --> 00:18:07,360
engage with law enforcement or outside

531
00:18:07,360 --> 00:18:09,919
consul or services to help you recover

532
00:18:09,919 --> 00:18:12,080
if you do that via email they're reading

533
00:18:12,080 --> 00:18:13,679
your email right they've got access to

534
00:18:13,679 --> 00:18:15,120
active directory they've got access to

535
00:18:15,120 --> 00:18:17,039
your entire enterprise at that point so

536
00:18:17,039 --> 00:18:19,200
be sure to be uh able to communicate out

537
00:18:19,200 --> 00:18:20,960
of band using

538
00:18:20,960 --> 00:18:23,039
whatsapp or signal or some other service

539
00:18:23,039 --> 00:18:24,559
where it's not tied into the same

540
00:18:24,559 --> 00:18:26,880
credential system you're that's now

541
00:18:26,880 --> 00:18:31,280
compromised and owned by your adversary

542
00:18:32,559 --> 00:18:34,000
of course lastly the thing that they're

543
00:18:34,000 --> 00:18:35,200
looking to do

544
00:18:35,200 --> 00:18:38,960
is encrypt and extort and i use that

545
00:18:38,960 --> 00:18:41,120
image there of a calendar to remind you

546
00:18:41,120 --> 00:18:43,440
that more often than not they know what

547
00:18:43,440 --> 00:18:44,720
time zone you're in they know what

548
00:18:44,720 --> 00:18:46,000
country you're in

549
00:18:46,000 --> 00:18:48,240
and they will pick a time where they

550
00:18:48,240 --> 00:18:50,559
feel they've got the most amount of time

551
00:18:50,559 --> 00:18:51,360
to

552
00:18:51,360 --> 00:18:53,200
trigger the exploitation encryption

553
00:18:53,200 --> 00:18:55,120
takes a long time many of you if you've

554
00:18:55,120 --> 00:18:57,679
worked in it understand if you deploy

555
00:18:57,679 --> 00:18:59,280
full disk encryption to a laptop

556
00:18:59,280 --> 00:19:01,679
computer it may take an hour or two

557
00:19:01,679 --> 00:19:03,840
hours to complete sometimes and so the

558
00:19:03,840 --> 00:19:05,440
criminals have to get really clever

559
00:19:05,440 --> 00:19:07,360
about how they go about their encryption

560
00:19:07,360 --> 00:19:10,000
and they do a few things to accelerate

561
00:19:10,000 --> 00:19:11,679
this process to cause more pain to the

562
00:19:11,679 --> 00:19:13,520
victims firstly they try to pick a

563
00:19:13,520 --> 00:19:16,480
holiday often or at least a weekend so

564
00:19:16,480 --> 00:19:18,080
many of these attacks we see triggered

565
00:19:18,080 --> 00:19:20,080
on friday afternoons

566
00:19:20,080 --> 00:19:21,679
with the expectation that staff have

567
00:19:21,679 --> 00:19:23,200
gone home or will be going home for the

568
00:19:23,200 --> 00:19:25,520
weekend and will not maybe be monitoring

569
00:19:25,520 --> 00:19:27,440
systems as carefully and closely as they

570
00:19:27,440 --> 00:19:29,600
are during normal business hours at your

571
00:19:29,600 --> 00:19:31,039
organization

572
00:19:31,039 --> 00:19:32,640
if they can pick a holiday like

573
00:19:32,640 --> 00:19:34,320
christmas or any bank holiday within

574
00:19:34,320 --> 00:19:36,320
your country that gives them

575
00:19:36,320 --> 00:19:38,480
another advantage to maybe have an extra

576
00:19:38,480 --> 00:19:40,720
day before they get noticed which allows

577
00:19:40,720 --> 00:19:42,400
them to spend more time stealing

578
00:19:42,400 --> 00:19:44,000
documents spend more time encrypting

579
00:19:44,000 --> 00:19:46,400
more systems or disabling more processes

580
00:19:46,400 --> 00:19:48,400
and defenses so those are important

581
00:19:48,400 --> 00:19:49,760
things remember on the right side of

582
00:19:49,760 --> 00:19:50,799
your screen

583
00:19:50,799 --> 00:19:53,360
they're starting to also deploy

584
00:19:53,360 --> 00:19:55,600
more speedy encryption algorithms that

585
00:19:55,600 --> 00:19:57,360
aren't even all that widely adopted

586
00:19:57,360 --> 00:19:59,280
amongst the good guys or the people

587
00:19:59,280 --> 00:20:00,960
doing cryptography for legitimate

588
00:20:00,960 --> 00:20:05,840
purposes uh clearly the best most secure

589
00:20:05,840 --> 00:20:07,520
tested way of encrypting things is to

590
00:20:07,520 --> 00:20:10,320
use the rsa algorithm to negotiate an

591
00:20:10,320 --> 00:20:13,520
aes key the same way we do

592
00:20:13,520 --> 00:20:15,280
all of the encryption most of the

593
00:20:15,280 --> 00:20:16,559
encryption on the internet the same way

594
00:20:16,559 --> 00:20:18,320
we encrypt websites the same way we

595
00:20:18,320 --> 00:20:21,280
encrypt disks on our computers

596
00:20:21,280 --> 00:20:22,799
that's kind of tried and true but it is

597
00:20:22,799 --> 00:20:25,200
a little slow rsa is a slow algorithm to

598
00:20:25,200 --> 00:20:27,039
asynchronously negotiate a synchronous

599
00:20:27,039 --> 00:20:27,840
key

600
00:20:27,840 --> 00:20:29,840
and even the synchronous encryption

601
00:20:29,840 --> 00:20:31,679
that's accelerated in aes by

602
00:20:31,679 --> 00:20:34,080
technologies built into our intel and

603
00:20:34,080 --> 00:20:37,760
amd cpus and modern computers um

604
00:20:37,760 --> 00:20:39,440
uses a bit of processing power and when

605
00:20:39,440 --> 00:20:40,720
you're talking about potentially

606
00:20:40,720 --> 00:20:41,919
encrypting

607
00:20:41,919 --> 00:20:42,720
uh

608
00:20:42,720 --> 00:20:44,720
gigabytes if not terabytes worth of data

609
00:20:44,720 --> 00:20:46,400
it can take a long time which means you

610
00:20:46,400 --> 00:20:48,799
may detect something's wrong and be able

611
00:20:48,799 --> 00:20:50,159
to stop them before they can complete

612
00:20:50,159 --> 00:20:51,440
their attacks so they're really looking

613
00:20:51,440 --> 00:20:53,360
at ways to accelerate it

614
00:20:53,360 --> 00:20:54,960
two of the most common ways is they

615
00:20:54,960 --> 00:20:56,799
first started adapting a new encryption

616
00:20:56,799 --> 00:20:59,440
algorithm known as salsa 20. i say new

617
00:20:59,440 --> 00:21:00,960
and in crypto world

618
00:21:00,960 --> 00:21:02,799
new means 15 years old these things have

619
00:21:02,799 --> 00:21:04,720
to be tested for a long time to be sure

620
00:21:04,720 --> 00:21:06,320
they're safe before we use them i think

621
00:21:06,320 --> 00:21:10,480
salsa is around 20 uh 15 years plus old

622
00:21:10,480 --> 00:21:12,880
bull celsa and chacha were venna by a

623
00:21:12,880 --> 00:21:14,559
guy named daniel bernstein's a well

624
00:21:14,559 --> 00:21:16,320
respected cryptographer and these are

625
00:21:16,320 --> 00:21:18,640
designed to be lightweight very fast

626
00:21:18,640 --> 00:21:20,159
encryption algorithms

627
00:21:20,159 --> 00:21:21,760
you'll most likely see them in use on

628
00:21:21,760 --> 00:21:23,440
your mobile phone we often use them for

629
00:21:23,440 --> 00:21:26,000
mobile encryption for accessing websites

630
00:21:26,000 --> 00:21:27,760
so that we don't use up all the battery

631
00:21:27,760 --> 00:21:29,520
on your iphone or android device when

632
00:21:29,520 --> 00:21:31,280
you're surfing encrypted content the

633
00:21:31,280 --> 00:21:33,200
criminals have started adopting in

634
00:21:33,200 --> 00:21:36,159
particular cha-cha 20 um the most

635
00:21:36,159 --> 00:21:37,760
sophisticated fastest of these

636
00:21:37,760 --> 00:21:40,240
algorithms uh to do encryption so they

637
00:21:40,240 --> 00:21:41,679
can do it much more speedily than they

638
00:21:41,679 --> 00:21:44,559
can do it with rsa and aes

639
00:21:44,559 --> 00:21:45,679
of course they need to deploy the

640
00:21:45,679 --> 00:21:48,240
encryption software to all of the victim

641
00:21:48,240 --> 00:21:50,559
computers and the two most common ways

642
00:21:50,559 --> 00:21:52,720
i've observed them doing this is either

643
00:21:52,720 --> 00:21:54,960
using a group policy object on active

644
00:21:54,960 --> 00:21:57,440
directory to instruct

645
00:21:57,440 --> 00:22:00,080
all of the uh member computers that they

646
00:22:00,080 --> 00:22:02,320
target to install

647
00:22:02,320 --> 00:22:04,080
the software just as if you were telling

648
00:22:04,080 --> 00:22:06,080
them to install legitimate software they

649
00:22:06,080 --> 00:22:07,600
instruct them of course to install the

650
00:22:07,600 --> 00:22:10,080
encryption software which is a pretty

651
00:22:10,080 --> 00:22:12,400
bad idea for the victim

652
00:22:12,400 --> 00:22:14,000
or powershell scripts they'll use

653
00:22:14,000 --> 00:22:16,320
powershell to push many of these things

654
00:22:16,320 --> 00:22:17,919
in combination with things as i talked

655
00:22:17,919 --> 00:22:19,280
about earlier like microsoft system

656
00:22:19,280 --> 00:22:21,280
turns tools perhaps they'll push a

657
00:22:21,280 --> 00:22:23,039
powershell to all the computers in the

658
00:22:23,039 --> 00:22:26,000
domain and then they'll use ps exec to

659
00:22:26,000 --> 00:22:27,840
instruct those remote computers to run

660
00:22:27,840 --> 00:22:29,600
that script which pulls down the

661
00:22:29,600 --> 00:22:32,799
encryption software the ransomware

662
00:22:32,799 --> 00:22:34,240
encrypts all the files and of course

663
00:22:34,240 --> 00:22:36,640
plants the ransom node and

664
00:22:36,640 --> 00:22:39,360
in some cases they're even

665
00:22:39,360 --> 00:22:41,120
auctioning off the stolen data to the

666
00:22:41,120 --> 00:22:42,640
highest bidder is another pressure

667
00:22:42,640 --> 00:22:44,880
tactic in order to get victims to pay

668
00:22:44,880 --> 00:22:46,559
but at this point

669
00:22:46,559 --> 00:22:48,559
to be honest the victim is in so much

670
00:22:48,559 --> 00:22:50,240
pain i'm not sure the extortion

671
00:22:50,240 --> 00:22:52,320
techniques are necessary your network is

672
00:22:52,320 --> 00:22:54,640
disabled you're likely unable to conduct

673
00:22:54,640 --> 00:22:56,880
business at this point and if your

674
00:22:56,880 --> 00:22:58,559
backups were online and they were able

675
00:22:58,559 --> 00:23:00,960
to disable your administrative accounts

676
00:23:00,960 --> 00:23:02,960
i don't know that additional pressure is

677
00:23:02,960 --> 00:23:05,200
necessary although some of these crews

678
00:23:05,200 --> 00:23:09,640
do seem to try to apply it

679
00:23:13,840 --> 00:23:15,840
so this is an example attack that we

680
00:23:15,840 --> 00:23:18,320
helped a victim partially defend

681
00:23:18,320 --> 00:23:19,840
themselves against unfortunately we were

682
00:23:19,840 --> 00:23:22,159
unable to necessarily stop the criminal

683
00:23:22,159 --> 00:23:24,240
from gaining initial access to the

684
00:23:24,240 --> 00:23:26,400
victims network but

685
00:23:26,400 --> 00:23:28,240
they were able to have some success and

686
00:23:28,240 --> 00:23:29,280
it's a good

687
00:23:29,280 --> 00:23:31,679
example of how these things unfold so

688
00:23:31,679 --> 00:23:33,360
conti is one of the largest ransom

689
00:23:33,360 --> 00:23:35,760
groups in the world arguably i i

690
00:23:35,760 --> 00:23:37,120
certainly amongst the people that we

691
00:23:37,120 --> 00:23:38,960
help uh that are victimized that come to

692
00:23:38,960 --> 00:23:41,520
us to assist them uh more of them have

693
00:23:41,520 --> 00:23:43,360
been victimized by kanti than any other

694
00:23:43,360 --> 00:23:44,720
ransomware group they're the most

695
00:23:44,720 --> 00:23:45,840
prolific

696
00:23:45,840 --> 00:23:46,720
uh

697
00:23:46,720 --> 00:23:49,120
of the last year or two without question

698
00:23:49,120 --> 00:23:51,200
and they're still operating

699
00:23:51,200 --> 00:23:53,279
as i record this they actually posted a

700
00:23:53,279 --> 00:23:54,799
note today

701
00:23:54,799 --> 00:23:57,200
uh attacking security researchers and

702
00:23:57,200 --> 00:23:59,120
defending rievil the group that was

703
00:23:59,120 --> 00:24:00,480
theoretically

704
00:24:00,480 --> 00:24:03,120
taken down by western law enforcement

705
00:24:03,120 --> 00:24:04,799
but when they attack a victim they're

706
00:24:04,799 --> 00:24:06,480
really efficient and smart they've got a

707
00:24:06,480 --> 00:24:08,000
script that they follow

708
00:24:08,000 --> 00:24:09,440
one of their affiliates that works

709
00:24:09,440 --> 00:24:12,159
within the conti group actually leaked

710
00:24:12,159 --> 00:24:13,919
um sort of the manual like it's an

711
00:24:13,919 --> 00:24:15,520
instruction manual of how they teach

712
00:24:15,520 --> 00:24:17,200
people to attack victims and the steps

713
00:24:17,200 --> 00:24:19,200
that they go through to compromise them

714
00:24:19,200 --> 00:24:21,440
and i got a copy of all these manuals in

715
00:24:21,440 --> 00:24:22,400
russian

716
00:24:22,400 --> 00:24:24,400
that were stolen and it's quite

717
00:24:24,400 --> 00:24:25,840
interesting to just see it is a bit

718
00:24:25,840 --> 00:24:27,600
formulaic they have a protocol they

719
00:24:27,600 --> 00:24:29,679
follow in this case they gain their

720
00:24:29,679 --> 00:24:31,360
initial foothold through an unpatched

721
00:24:31,360 --> 00:24:34,240
fortinet firewall and once they were

722
00:24:34,240 --> 00:24:36,000
able to gain access

723
00:24:36,000 --> 00:24:37,120
uh

724
00:24:37,120 --> 00:24:38,559
they were able to get onto two domain

725
00:24:38,559 --> 00:24:39,919
controllers right off the bat because

726
00:24:39,919 --> 00:24:41,679
again once they got onto that firewall

727
00:24:41,679 --> 00:24:42,880
they were able to get administrative

728
00:24:42,880 --> 00:24:45,039
credentials they could extract out of

729
00:24:45,039 --> 00:24:46,400
the firewall

730
00:24:46,400 --> 00:24:48,080
and then used that to log in as domain

731
00:24:48,080 --> 00:24:49,200
admin

732
00:24:49,200 --> 00:24:50,960
within about 16 minutes they got onto

733
00:24:50,960 --> 00:24:52,799
two different domain controllers within

734
00:24:52,799 --> 00:24:54,799
the network

735
00:24:54,799 --> 00:24:56,720
at that point they started to deploy

736
00:24:56,720 --> 00:24:58,640
cobalt strike which is a penetration

737
00:24:58,640 --> 00:25:00,400
testing tool it's a commercial piece of

738
00:25:00,400 --> 00:25:02,480
software used by red teams and

739
00:25:02,480 --> 00:25:04,799
penetration testers in order to test

740
00:25:04,799 --> 00:25:06,000
your network security of course the

741
00:25:06,000 --> 00:25:07,679
criminals steal this software they use

742
00:25:07,679 --> 00:25:09,039
pirated versions

743
00:25:09,039 --> 00:25:10,880
and they started deploying cobalt strike

744
00:25:10,880 --> 00:25:12,799
which was just the clue that was

745
00:25:12,799 --> 00:25:15,200
necessary for the victim to start

746
00:25:15,200 --> 00:25:17,120
getting some alerts in their security

747
00:25:17,120 --> 00:25:19,440
council so the victim of course realizes

748
00:25:19,440 --> 00:25:21,279
right away cobalt strike is a bad thing

749
00:25:21,279 --> 00:25:22,799
if they're not conducting a penetration

750
00:25:22,799 --> 00:25:24,480
test right now

751
00:25:24,480 --> 00:25:26,000
immediately uh

752
00:25:26,000 --> 00:25:28,799
contacted us for help and

753
00:25:28,799 --> 00:25:32,159
they were detected and booted off of one

754
00:25:32,159 --> 00:25:34,080
of the servers that they compromised

755
00:25:34,080 --> 00:25:36,960
unfortunately the the customer in this

756
00:25:36,960 --> 00:25:38,960
case didn't realize they had gotten onto

757
00:25:38,960 --> 00:25:40,240
two different domain controllers when

758
00:25:40,240 --> 00:25:41,840
they got the cobalt strike detection

759
00:25:41,840 --> 00:25:43,600
they very much focused on

760
00:25:43,600 --> 00:25:45,200
we use the term eviction the same way

761
00:25:45,200 --> 00:25:46,720
you might evict somebody who doesn't pay

762
00:25:46,720 --> 00:25:48,159
their rent we want to evict the

763
00:25:48,159 --> 00:25:49,520
criminals from the network we want to

764
00:25:49,520 --> 00:25:51,440
evict them from your servers so they

765
00:25:51,440 --> 00:25:53,440
were able to evict them from one server

766
00:25:53,440 --> 00:25:54,880
but unfortunately they didn't realize

767
00:25:54,880 --> 00:25:56,559
they were on the second server

768
00:25:56,559 --> 00:25:59,200
so in only 15 minutes the criminals once

769
00:25:59,200 --> 00:26:00,640
they realized they booted off the first

770
00:26:00,640 --> 00:26:02,080
one they connected to the second one and

771
00:26:02,080 --> 00:26:04,400
they continued to perform their attack

772
00:26:04,400 --> 00:26:05,919
and at this point they started

773
00:26:05,919 --> 00:26:07,919
specifically scanning the network for

774
00:26:07,919 --> 00:26:10,159
documents in the human resources i.t and

775
00:26:10,159 --> 00:26:12,320
finance departments and we're looking

776
00:26:12,320 --> 00:26:14,720
for things like budget files and as

777
00:26:14,720 --> 00:26:17,279
alluded to earlier used rclone to steal

778
00:26:17,279 --> 00:26:18,559
anything that looked like any type of

779
00:26:18,559 --> 00:26:20,799
that data and upload it to the mega file

780
00:26:20,799 --> 00:26:23,200
sharing service

781
00:26:23,200 --> 00:26:26,080
and for our lucky sake uh they use

782
00:26:26,080 --> 00:26:27,840
scripts in order to copy all these files

783
00:26:27,840 --> 00:26:29,440
and the password for their mega account

784
00:26:29,440 --> 00:26:31,120
is included in those scripts so that was

785
00:26:31,120 --> 00:26:33,919
kind of handy it allowed us to uh

786
00:26:33,919 --> 00:26:35,919
find out what files they had stolen and

787
00:26:35,919 --> 00:26:37,600
actually delete them from the cloud

788
00:26:37,600 --> 00:26:39,120
service once we were able to remove them

789
00:26:39,120 --> 00:26:40,640
from the network so that was kind of

790
00:26:40,640 --> 00:26:41,760
handy

791
00:26:41,760 --> 00:26:43,440
they were also looking for password

792
00:26:43,440 --> 00:26:44,559
lists

793
00:26:44,559 --> 00:26:46,159
and any kind of spreadsheet spreadsheets

794
00:26:46,159 --> 00:26:47,760
typically contain financial data that

795
00:26:47,760 --> 00:26:50,159
may be very useful for their extortion

796
00:26:50,159 --> 00:26:52,240
techniques

797
00:26:52,240 --> 00:26:53,760
they managed to copy the ransomware

798
00:26:53,760 --> 00:26:55,279
using some scripts to around 300

799
00:26:55,279 --> 00:26:56,960
different computers across the network

800
00:26:56,960 --> 00:26:58,720
and that was around the time that our

801
00:26:58,720 --> 00:27:00,559
rapid response team was able to engage

802
00:27:00,559 --> 00:27:03,360
with the client and start locking down

803
00:27:03,360 --> 00:27:04,400
the

804
00:27:04,400 --> 00:27:06,000
the methods the criminals were using to

805
00:27:06,000 --> 00:27:07,600
access the computers so fortunately in

806
00:27:07,600 --> 00:27:09,520
the end cryptoguard and some other

807
00:27:09,520 --> 00:27:11,919
technologies this customer had deployed

808
00:27:11,919 --> 00:27:13,760
were able to slow the criminals down and

809
00:27:13,760 --> 00:27:16,559
allow us to help that customer uh close

810
00:27:16,559 --> 00:27:18,960
the holes patch that fortinet firewall

811
00:27:18,960 --> 00:27:20,480
and some other things to lock them out

812
00:27:20,480 --> 00:27:22,480
of the network but this is really a

813
00:27:22,480 --> 00:27:24,399
great example of the type

814
00:27:24,399 --> 00:27:27,200
of process we see gain initial access

815
00:27:27,200 --> 00:27:29,200
use red team tools and legitimate tools

816
00:27:29,200 --> 00:27:30,159
to

817
00:27:30,159 --> 00:27:31,919
move around the network find files you

818
00:27:31,919 --> 00:27:33,919
want to steal copy them off to a drive

819
00:27:33,919 --> 00:27:35,600
in the cloud somewhere where you can

820
00:27:35,600 --> 00:27:37,200
access them later

821
00:27:37,200 --> 00:27:39,600
then start to mass deploy the ransomware

822
00:27:39,600 --> 00:27:41,520
and were they successful of course they

823
00:27:41,520 --> 00:27:43,120
would have triggered the ransomware in

824
00:27:43,120 --> 00:27:44,559
this particular case we were fortunate

825
00:27:44,559 --> 00:27:45,840
enough to be able to stop them before it

826
00:27:45,840 --> 00:27:49,320
got to that point

827
00:27:49,760 --> 00:27:51,200
another group that i mentioned earlier

828
00:27:51,200 --> 00:27:53,039
that we think may be gone now but is a

829
00:27:53,039 --> 00:27:54,399
very interesting group because a lot of

830
00:27:54,399 --> 00:27:56,320
these a lot of these groups almost kind

831
00:27:56,320 --> 00:27:58,159
of have a reputation or they almost

832
00:27:58,159 --> 00:28:00,240
advertise themselves and

833
00:28:00,240 --> 00:28:02,960
we refer to them as rival and rival

834
00:28:02,960 --> 00:28:05,120
acknowledges that they were named for

835
00:28:05,120 --> 00:28:05,840
the

836
00:28:05,840 --> 00:28:08,399
resident evil movie and they do not like

837
00:28:08,399 --> 00:28:09,840
being called revel they like to be

838
00:28:09,840 --> 00:28:11,919
called our evil so we call them revo

839
00:28:11,919 --> 00:28:13,360
because it irritates them and i quite

840
00:28:13,360 --> 00:28:15,279
like that um

841
00:28:15,279 --> 00:28:17,120
they had the brand changes in the past

842
00:28:17,120 --> 00:28:18,640
so we may see them surface again in the

843
00:28:18,640 --> 00:28:21,039
past they were called gan crab and

844
00:28:21,039 --> 00:28:23,360
they're kind of famous for running their

845
00:28:23,360 --> 00:28:25,120
leaks blog which is when they steal data

846
00:28:25,120 --> 00:28:27,120
from your organization they leak it on

847
00:28:27,120 --> 00:28:29,120
the dark web on a blog called the happy

848
00:28:29,120 --> 00:28:31,760
blog now it is never a happy day to be

849
00:28:31,760 --> 00:28:33,120
on the happy blog because that means

850
00:28:33,120 --> 00:28:34,240
you've been compromised and your

851
00:28:34,240 --> 00:28:36,399
information is being leaked

852
00:28:36,399 --> 00:28:38,720
and they but rather than leak the data

853
00:28:38,720 --> 00:28:40,480
publicly right off the bat they actually

854
00:28:40,480 --> 00:28:42,399
steal the data and offer it up for

855
00:28:42,399 --> 00:28:44,480
auction and so they try to auction off

856
00:28:44,480 --> 00:28:46,399
your sensitive information in case some

857
00:28:46,399 --> 00:28:47,919
criminal is willing to pay them for it

858
00:28:47,919 --> 00:28:49,600
and in the end if you don't pay the

859
00:28:49,600 --> 00:28:51,840
ransom and no other criminal pays to buy

860
00:28:51,840 --> 00:28:54,799
the stolen sensitive information

861
00:28:54,799 --> 00:28:56,640
from your organization in the end they

862
00:28:56,640 --> 00:28:58,880
will publish your information on the

863
00:28:58,880 --> 00:29:01,120
happy blog uh as of time of recording

864
00:29:01,120 --> 00:29:02,960
the happy blog has been offline for two

865
00:29:02,960 --> 00:29:05,840
days so um we hope to not see it

866
00:29:05,840 --> 00:29:07,360
re-emerge but

867
00:29:07,360 --> 00:29:09,840
revo has disappeared twice in the past

868
00:29:09,840 --> 00:29:11,279
and and then a few months later

869
00:29:11,279 --> 00:29:13,840
re-emerge so it's hard to know for sure

870
00:29:13,840 --> 00:29:15,600
whether they're truly gone forever or

871
00:29:15,600 --> 00:29:17,200
whether we have a temporary victim

872
00:29:17,200 --> 00:29:19,600
against uh victory against them

873
00:29:19,600 --> 00:29:21,840
and these guys uh some fascinating stuff

874
00:29:21,840 --> 00:29:23,840
if you really are interested in this

875
00:29:23,840 --> 00:29:25,679
topic i encourage you to go to youtube

876
00:29:25,679 --> 00:29:28,080
and search for elite russian hackers

877
00:29:28,080 --> 00:29:29,200
reveal

878
00:29:29,200 --> 00:29:30,640
and you'll see the youtube video on the

879
00:29:30,640 --> 00:29:32,799
left side of the slide there

880
00:29:32,799 --> 00:29:34,640
where there's an actual interview with

881
00:29:34,640 --> 00:29:37,360
the guy whose name is unknown

882
00:29:37,360 --> 00:29:39,919
so he's not unknown to us but his name

883
00:29:39,919 --> 00:29:41,120
is unknown

884
00:29:41,120 --> 00:29:43,520
and he granted an interview talking

885
00:29:43,520 --> 00:29:45,279
about how they choose victims and how

886
00:29:45,279 --> 00:29:46,799
they go about

887
00:29:46,799 --> 00:29:48,399
attacking people and why they think it's

888
00:29:48,399 --> 00:29:50,399
okay sort of their moral views of the

889
00:29:50,399 --> 00:29:52,720
world and how they think these attacks

890
00:29:52,720 --> 00:29:55,760
are justified and uh right after that

891
00:29:55,760 --> 00:29:57,520
interview they posted a sort of million

892
00:29:57,520 --> 00:30:00,159
dollar bounty in cryptocurrency to one

893
00:30:00,159 --> 00:30:02,240
of the underground crime forums

894
00:30:02,240 --> 00:30:03,840
promoting themselves and asking for

895
00:30:03,840 --> 00:30:06,480
penetration testers to sign up to work

896
00:30:06,480 --> 00:30:08,480
for them to attack more victims

897
00:30:08,480 --> 00:30:10,159
and if you signed up as a penetration

898
00:30:10,159 --> 00:30:11,600
tester and were accepted into their

899
00:30:11,600 --> 00:30:13,440
affiliate network they would give you as

900
00:30:13,440 --> 00:30:15,600
a portion of that one million dollars as

901
00:30:15,600 --> 00:30:17,679
a signing bonus for agreeing to work

902
00:30:17,679 --> 00:30:18,960
with them to

903
00:30:18,960 --> 00:30:22,399
recruit more victims and the unknown did

904
00:30:22,399 --> 00:30:26,080
a more recent interview with uh a blog

905
00:30:26,080 --> 00:30:27,840
called the record

906
00:30:27,840 --> 00:30:31,279
and uh dimitri smiling at smilonitz uh

907
00:30:31,279 --> 00:30:32,960
did a interview with them in russian and

908
00:30:32,960 --> 00:30:34,880
translated to english you can find that

909
00:30:34,880 --> 00:30:37,120
on the records website and again

910
00:30:37,120 --> 00:30:38,960
interesting to talk about how he was a

911
00:30:38,960 --> 00:30:41,120
poor kid growing up in soviet union and

912
00:30:41,120 --> 00:30:43,200
russia and nothing to his name and was

913
00:30:43,200 --> 00:30:45,120
picking through trash heaps looking for

914
00:30:45,120 --> 00:30:46,880
partially smoked cigarettes and now he's

915
00:30:46,880 --> 00:30:49,520
a millionaire and how awesome and

916
00:30:49,520 --> 00:30:51,120
successful it is to be a ransomware

917
00:30:51,120 --> 00:30:52,399
criminal so there

918
00:30:52,399 --> 00:30:54,000
there's a lot of braggadocio that goes

919
00:30:54,000 --> 00:30:58,000
on in the ransom community

920
00:30:58,240 --> 00:30:59,840
so this is sort of their downfall the

921
00:30:59,840 --> 00:31:01,919
record again broke the news um the

922
00:31:01,919 --> 00:31:03,919
record.media is the blog i was

923
00:31:03,919 --> 00:31:05,600
referencing a second ago

924
00:31:05,600 --> 00:31:06,399
on

925
00:31:06,399 --> 00:31:09,840
a criminal forum the the the co-partner

926
00:31:09,840 --> 00:31:12,000
a guy named one day with an underscore

927
00:31:12,000 --> 00:31:14,000
between zero and n

928
00:31:14,000 --> 00:31:16,960
uh was the co-founder of rival with

929
00:31:16,960 --> 00:31:19,760
unknown and he posted to a forum that

930
00:31:19,760 --> 00:31:21,200
some fishy things were going on with

931
00:31:21,200 --> 00:31:22,799
access to their server the server had

932
00:31:22,799 --> 00:31:25,519
gone offline unknown had disappeared and

933
00:31:25,519 --> 00:31:27,120
now somebody seemed to be tampering or

934
00:31:27,120 --> 00:31:30,399
accessing uh the the website and so he

935
00:31:30,399 --> 00:31:32,080
was gonna go dark he was afraid maybe it

936
00:31:32,080 --> 00:31:34,399
was the police and he was probably right

937
00:31:34,399 --> 00:31:37,360
so uh i i hope he didn't get away but uh

938
00:31:37,360 --> 00:31:40,080
nonetheless uh he kind of suspected that

939
00:31:40,080 --> 00:31:42,000
people were after him and said for now

940
00:31:42,000 --> 00:31:43,679
we're off we're getting out of here

941
00:31:43,679 --> 00:31:44,960
leaving town

942
00:31:44,960 --> 00:31:47,279
um they made tens of millions of dollars

943
00:31:47,279 --> 00:31:49,039
they're if they are able to get away

944
00:31:49,039 --> 00:31:51,440
they're certainly not hurting for cash

945
00:31:51,440 --> 00:31:53,600
to aid them in their escape

946
00:31:53,600 --> 00:31:54,960
but um

947
00:31:54,960 --> 00:31:57,679
you generally the the police don't

948
00:31:57,679 --> 00:31:59,760
usually shut things down until they feel

949
00:31:59,760 --> 00:32:01,200
they have their

950
00:32:01,200 --> 00:32:03,039
victim in

951
00:32:03,039 --> 00:32:04,320
a place where they may be able to

952
00:32:04,320 --> 00:32:06,320
apprehend them so hopefully we'll hear

953
00:32:06,320 --> 00:32:07,919
in the not too distant future about some

954
00:32:07,919 --> 00:32:09,279
indictments from the u.s department of

955
00:32:09,279 --> 00:32:10,960
justice or others

956
00:32:10,960 --> 00:32:12,799
on the right side you see

957
00:32:12,799 --> 00:32:15,120
sort of a retaliatory

958
00:32:15,120 --> 00:32:16,640
this morning

959
00:32:16,640 --> 00:32:19,039
conti who i mentioned earlier sort of

960
00:32:19,039 --> 00:32:21,919
wrote a big screed on their dark website

961
00:32:21,919 --> 00:32:24,559
talking about how rival were had

962
00:32:24,559 --> 00:32:26,559
honestly earned their money and how evil

963
00:32:26,559 --> 00:32:29,200
the great devil united states is

964
00:32:29,200 --> 00:32:31,600
and um was even poking funny at people

965
00:32:31,600 --> 00:32:33,679
fun at people like me calling us social

966
00:32:33,679 --> 00:32:35,279
media hobos

967
00:32:35,279 --> 00:32:37,039
and how we all really deserve it and

968
00:32:37,039 --> 00:32:38,159
there's nothing wrong with what they're

969
00:32:38,159 --> 00:32:40,159
doing because we're just thieves on the

970
00:32:40,159 --> 00:32:42,399
other side harming people and

971
00:32:42,399 --> 00:32:44,480
stealing back from us is a perfectly

972
00:32:44,480 --> 00:32:46,640
legitimate thing apparently so

973
00:32:46,640 --> 00:32:49,039
there's there's certainly

974
00:32:49,039 --> 00:32:52,159
developments in the ransomware space the

975
00:32:52,159 --> 00:32:53,760
cat and mouse between

976
00:32:53,760 --> 00:32:56,080
attackers and defenders and even amongst

977
00:32:56,080 --> 00:32:58,159
ransomware crews themselves

978
00:32:58,159 --> 00:32:59,840
self-referentially talking to one

979
00:32:59,840 --> 00:33:02,159
another uh that it's very difficult

980
00:33:02,159 --> 00:33:04,000
sometimes to keep up with this but don't

981
00:33:04,000 --> 00:33:06,080
forget in the end what their goal is

982
00:33:06,080 --> 00:33:08,480
their goal is simply to victimize people

983
00:33:08,480 --> 00:33:10,960
who've left a security hole open

984
00:33:10,960 --> 00:33:12,960
steal all of your money and leave your

985
00:33:12,960 --> 00:33:15,440
business worse off in the end despite

986
00:33:15,440 --> 00:33:18,559
having done nothing to them

987
00:33:19,600 --> 00:33:22,080
so that's enough about the attackers

988
00:33:22,080 --> 00:33:24,480
let's look into as defenders what are

989
00:33:24,480 --> 00:33:26,559
the hallmarks or things that people that

990
00:33:26,559 --> 00:33:28,880
are successful at defending themselves

991
00:33:28,880 --> 00:33:30,720
are more likely to have employees or

992
00:33:30,720 --> 00:33:32,159
practices that they're more likely to

993
00:33:32,159 --> 00:33:33,919
follow that lead them to be safer than

994
00:33:33,919 --> 00:33:36,919
others

995
00:33:41,039 --> 00:33:42,159
certainly

996
00:33:42,159 --> 00:33:43,840
patching is a big part of that and i'm

997
00:33:43,840 --> 00:33:45,039
going to talk about patching a little

998
00:33:45,039 --> 00:33:47,200
bit more in a slide in a few more slides

999
00:33:47,200 --> 00:33:49,440
but i mean we all know we need to patch

1000
00:33:49,440 --> 00:33:52,480
the problem is the ubiquity of it right

1001
00:33:52,480 --> 00:33:54,720
and as we see with the stormtroopers the

1002
00:33:54,720 --> 00:33:56,720
lego stormtroopers there

1003
00:33:56,720 --> 00:33:58,159
we really need

1004
00:33:58,159 --> 00:34:00,640
everything to be the same in order to be

1005
00:34:00,640 --> 00:34:02,159
able to be effective at this we can't

1006
00:34:02,159 --> 00:34:04,399
patch nine of our exchange server but

1007
00:34:04,399 --> 00:34:07,120
not the tenth one or we can't patch all

1008
00:34:07,120 --> 00:34:08,560
of our endpoints

1009
00:34:08,560 --> 00:34:09,359
but

1010
00:34:09,359 --> 00:34:12,719
not our servers and unfortunately the

1011
00:34:12,719 --> 00:34:14,719
ubiquity of the basics is more

1012
00:34:14,719 --> 00:34:16,560
challenging than it sounds

1013
00:34:16,560 --> 00:34:19,119
we're seeing more and more organizations

1014
00:34:19,119 --> 00:34:21,760
where they have fantastic security tools

1015
00:34:21,760 --> 00:34:23,440
deployed they have a reasonably

1016
00:34:23,440 --> 00:34:24,639
well-trained

1017
00:34:24,639 --> 00:34:26,639
sock or security operations center

1018
00:34:26,639 --> 00:34:29,199
monitoring their behavior

1019
00:34:29,199 --> 00:34:31,599
they're certainly trying to make good

1020
00:34:31,599 --> 00:34:33,839
balanced risk decisions around how to

1021
00:34:33,839 --> 00:34:36,079
deploy those tools but in the end the

1022
00:34:36,079 --> 00:34:38,320
lack of ubiquity means that once the

1023
00:34:38,320 --> 00:34:40,879
criminal is on the network they become

1024
00:34:40,879 --> 00:34:43,280
admin and unravel all the rest of it and

1025
00:34:43,280 --> 00:34:44,960
so look at your security tools that may

1026
00:34:44,960 --> 00:34:46,560
run on your endpoint whether it's

1027
00:34:46,560 --> 00:34:48,079
something from our organization or one

1028
00:34:48,079 --> 00:34:49,918
of our competitors or even the built-in

1029
00:34:49,918 --> 00:34:51,760
windows defender once you become

1030
00:34:51,760 --> 00:34:53,679
administrator on the domain

1031
00:34:53,679 --> 00:34:55,760
you likely have the ability to disable

1032
00:34:55,760 --> 00:34:58,400
all of that protection so if you've got

1033
00:34:58,400 --> 00:35:00,800
a server that's unpatched and all the

1034
00:35:00,800 --> 00:35:02,560
other ones are patched

1035
00:35:02,560 --> 00:35:04,079
once i gain access to the one that's

1036
00:35:04,079 --> 00:35:06,480
unpatched and i gain administrative

1037
00:35:06,480 --> 00:35:08,560
access on it i simply turn off the

1038
00:35:08,560 --> 00:35:09,760
protection on all the other ones all

1039
00:35:09,760 --> 00:35:11,680
that patching is undone it's no longer

1040
00:35:11,680 --> 00:35:13,520
helpful we're frequently seeing

1041
00:35:13,520 --> 00:35:15,920
organizations applying strict security

1042
00:35:15,920 --> 00:35:18,000
policies to endpoint computers

1043
00:35:18,000 --> 00:35:20,480
and no security or limited security to

1044
00:35:20,480 --> 00:35:22,240
server computers sometimes for

1045
00:35:22,240 --> 00:35:23,920
performance reasons

1046
00:35:23,920 --> 00:35:25,839
it's not always clear why those policies

1047
00:35:25,839 --> 00:35:27,119
are different

1048
00:35:27,119 --> 00:35:29,280
too many exclusions we see you know i'm

1049
00:35:29,280 --> 00:35:30,800
going to exclude the c colon windows

1050
00:35:30,800 --> 00:35:32,880
folder to speed up my servers except of

1051
00:35:32,880 --> 00:35:34,240
course the criminals hide everything and

1052
00:35:34,240 --> 00:35:35,599
see windows temp and that means all the

1053
00:35:35,599 --> 00:35:38,000
malware goes undetected so there's

1054
00:35:38,000 --> 00:35:39,920
those gaps are where they're gaining

1055
00:35:39,920 --> 00:35:41,520
their advantage and we have to eliminate

1056
00:35:41,520 --> 00:35:43,920
the gaps and

1057
00:35:43,920 --> 00:35:45,440
not able always to patch everything and

1058
00:35:45,440 --> 00:35:46,800
i'll talk about mitigation when i talk

1059
00:35:46,800 --> 00:35:48,400
about patching some more but that

1060
00:35:48,400 --> 00:35:50,800
ubiquity of security policy ubiquity of

1061
00:35:50,800 --> 00:35:53,280
security tools being in place on all

1062
00:35:53,280 --> 00:35:55,119
machines that hold sensitive data that

1063
00:35:55,119 --> 00:35:57,359
can be used in these attacks

1064
00:35:57,359 --> 00:35:58,480
and also

1065
00:35:58,480 --> 00:36:00,079
managing carefully

1066
00:36:00,079 --> 00:36:02,320
how we grant exceptions to policy you

1067
00:36:02,320 --> 00:36:03,839
may have a policy that everything needs

1068
00:36:03,839 --> 00:36:05,920
to be patched in 14 days

1069
00:36:05,920 --> 00:36:07,359
but the oracle server we're going to

1070
00:36:07,359 --> 00:36:10,079
wait uh 45 days

1071
00:36:10,079 --> 00:36:12,160
that starts to increase your risk quite

1072
00:36:12,160 --> 00:36:14,560
dramatically and unfortunately lots of

1073
00:36:14,560 --> 00:36:16,720
times a temporary exception is granted

1074
00:36:16,720 --> 00:36:19,680
to a policy uh while

1075
00:36:19,680 --> 00:36:21,920
you're you know determining a better way

1076
00:36:21,920 --> 00:36:24,079
to secure that system and that temporary

1077
00:36:24,079 --> 00:36:25,760
thing is there forever which means it's

1078
00:36:25,760 --> 00:36:27,920
not temporary so in essence the

1079
00:36:27,920 --> 00:36:30,160
compromise in your policy leads to

1080
00:36:30,160 --> 00:36:32,480
compromised computers at the end because

1081
00:36:32,480 --> 00:36:34,960
those things are never changed and

1082
00:36:34,960 --> 00:36:36,240
there's been a few victims i've talked

1083
00:36:36,240 --> 00:36:38,560
to in recent months where they

1084
00:36:38,560 --> 00:36:40,400
temporarily had disabled

1085
00:36:40,400 --> 00:36:42,320
uh some piece of their security software

1086
00:36:42,320 --> 00:36:43,760
on some servers because it was

1087
00:36:43,760 --> 00:36:45,280
interfering with something they were

1088
00:36:45,280 --> 00:36:47,040
working with their vendors

1089
00:36:47,040 --> 00:36:48,880
things were patched and then they never

1090
00:36:48,880 --> 00:36:51,359
turned those things back on again and

1091
00:36:51,359 --> 00:36:54,000
years later they had exceptions from six

1092
00:36:54,000 --> 00:36:56,480
years previous that were still in place

1093
00:36:56,480 --> 00:36:57,839
because they didn't review the

1094
00:36:57,839 --> 00:36:59,440
exceptions so if you're going to make

1095
00:36:59,440 --> 00:37:01,280
exceptions to policy which is

1096
00:37:01,280 --> 00:37:03,040
unfortunately part of doing business we

1097
00:37:03,040 --> 00:37:04,960
have to make exceptions sometimes those

1098
00:37:04,960 --> 00:37:06,160
exceptions need to be reviewed on a

1099
00:37:06,160 --> 00:37:09,680
regular basis and reverted back to the

1100
00:37:09,680 --> 00:37:11,839
standard as soon as possible

1101
00:37:11,839 --> 00:37:13,680
because any of those gaps allow the

1102
00:37:13,680 --> 00:37:15,200
criminals to gain a foothold within the

1103
00:37:15,200 --> 00:37:17,520
network

1104
00:37:18,480 --> 00:37:20,160
knowing what's normal

1105
00:37:20,160 --> 00:37:21,359
clearly

1106
00:37:21,359 --> 00:37:22,880
pencils that bend in a circle aren't

1107
00:37:22,880 --> 00:37:24,800
normal and clearly

1108
00:37:24,800 --> 00:37:26,720
uh you know you don't expect to see a

1109
00:37:26,720 --> 00:37:31,040
poppy uh in a field full of ragweed so

1110
00:37:31,040 --> 00:37:33,760
what what is normal and unfortunately if

1111
00:37:33,760 --> 00:37:35,839
you're not patrolling

1112
00:37:35,839 --> 00:37:38,480
no different than a police person might

1113
00:37:38,480 --> 00:37:40,240
patrol a perimeter of a network if

1114
00:37:40,240 --> 00:37:41,839
you're reactive right so we you know on

1115
00:37:41,839 --> 00:37:44,240
the left we've got the reactive person

1116
00:37:44,240 --> 00:37:46,240
they're they're not they're defensive

1117
00:37:46,240 --> 00:37:48,079
they're looking for something that went

1118
00:37:48,079 --> 00:37:49,599
wrong and then

1119
00:37:49,599 --> 00:37:51,119
responding to the thing that went wrong

1120
00:37:51,119 --> 00:37:52,560
when it comes to them sort of like

1121
00:37:52,560 --> 00:37:54,640
sitting in the sock and waiting for a

1122
00:37:54,640 --> 00:37:56,320
user to open a ticket the user opens a

1123
00:37:56,320 --> 00:37:58,320
ticket my laptop's infected

1124
00:37:58,320 --> 00:38:00,640
i go out i reimage the laptop that's a

1125
00:38:00,640 --> 00:38:02,400
pretty normal process

1126
00:38:02,400 --> 00:38:04,000
if you're reactive like that you're not

1127
00:38:04,000 --> 00:38:05,520
going out and looking for problems you

1128
00:38:05,520 --> 00:38:07,040
need to be patrolling the perimeter like

1129
00:38:07,040 --> 00:38:08,400
the police on the horses here in the

1130
00:38:08,400 --> 00:38:09,920
slide you need to be out there so that

1131
00:38:09,920 --> 00:38:11,680
you know what normal is i you know you

1132
00:38:11,680 --> 00:38:13,200
ride around the park twice a day on the

1133
00:38:13,200 --> 00:38:15,359
horse you know what normal activity is

1134
00:38:15,359 --> 00:38:17,200
uh these kids play with the frisbee in

1135
00:38:17,200 --> 00:38:18,960
the afternoon these these people go

1136
00:38:18,960 --> 00:38:20,800
golfing every day at three on fridays

1137
00:38:20,800 --> 00:38:22,320
they golf at three o'clock and we see

1138
00:38:22,320 --> 00:38:23,839
them every week when there's something

1139
00:38:23,839 --> 00:38:26,800
unusual you'll know that this seems like

1140
00:38:26,800 --> 00:38:28,320
it's not right but the only way to tell

1141
00:38:28,320 --> 00:38:30,400
what's normal is to establish that

1142
00:38:30,400 --> 00:38:32,079
baseline and there are many ways of

1143
00:38:32,079 --> 00:38:33,599
doing this i mean some people establish

1144
00:38:33,599 --> 00:38:35,839
baselines by monitoring their network

1145
00:38:35,839 --> 00:38:37,280
traffic through their firewalls and then

1146
00:38:37,280 --> 00:38:39,599
they might spot that large upload of the

1147
00:38:39,599 --> 00:38:41,280
stolen data when they see suddenly a

1148
00:38:41,280 --> 00:38:44,079
burst at an unusual time for gigabytes

1149
00:38:44,079 --> 00:38:45,520
or terabytes being transferred on the

1150
00:38:45,520 --> 00:38:46,800
network

1151
00:38:46,800 --> 00:38:49,680
it might be just taking alerts seriously

1152
00:38:49,680 --> 00:38:51,599
looking um

1153
00:38:51,599 --> 00:38:53,680
what a normal load of different types of

1154
00:38:53,680 --> 00:38:55,280
alerts is and noticing that there's a

1155
00:38:55,280 --> 00:38:57,359
particular spike and a type of thing

1156
00:38:57,359 --> 00:38:59,359
happening but the key here is it's

1157
00:38:59,359 --> 00:39:02,160
moving from reactive to proactive you

1158
00:39:02,160 --> 00:39:03,920
don't really know what normal is when

1159
00:39:03,920 --> 00:39:05,839
you're only responding to things as

1160
00:39:05,839 --> 00:39:08,320
they're coming at you when when you have

1161
00:39:08,320 --> 00:39:11,040
the freedom to actually start patrolling

1162
00:39:11,040 --> 00:39:13,200
is when you start to get more of a sense

1163
00:39:13,200 --> 00:39:15,200
of the neighborhood what does my network

1164
00:39:15,200 --> 00:39:16,960
look like on different days of the week

1165
00:39:16,960 --> 00:39:18,880
different hours of the day

1166
00:39:18,880 --> 00:39:21,520
different months of the year and is that

1167
00:39:21,520 --> 00:39:23,760
expected or unexpected so that i know

1168
00:39:23,760 --> 00:39:25,839
whether it's something i should spend

1169
00:39:25,839 --> 00:39:28,000
extra time and money investigating and

1170
00:39:28,000 --> 00:39:29,280
too often

1171
00:39:29,280 --> 00:39:31,920
we hear about a terabyte being stolen

1172
00:39:31,920 --> 00:39:34,000
and the victim had no idea the criminals

1173
00:39:34,000 --> 00:39:35,680
had been in their network for weeks

1174
00:39:35,680 --> 00:39:37,920
sometimes months and they didn't have

1175
00:39:37,920 --> 00:39:39,680
any idea but there were little telltale

1176
00:39:39,680 --> 00:39:41,359
signs all over but nobody really picked

1177
00:39:41,359 --> 00:39:42,640
up on it because they weren't looking

1178
00:39:42,640 --> 00:39:44,400
for them so in order to look for them

1179
00:39:44,400 --> 00:39:45,599
you have to know what's normal and

1180
00:39:45,599 --> 00:39:48,240
what's not

1181
00:39:49,760 --> 00:39:52,640
remote access must use multi-factor it

1182
00:39:52,640 --> 00:39:54,960
is not okay under any circumstance to

1183
00:39:54,960 --> 00:39:56,480
allow a password to log in and i don't

1184
00:39:56,480 --> 00:39:59,839
care what the technology is and

1185
00:39:59,839 --> 00:40:02,640
it's just it's unsafe at this point um

1186
00:40:02,640 --> 00:40:04,400
it doesn't matter if it's ssh if it's

1187
00:40:04,400 --> 00:40:07,280
telnet if it's rdp if it's your remote

1188
00:40:07,280 --> 00:40:08,880
access solution like cassaya or

1189
00:40:08,880 --> 00:40:12,240
baumgarten or other

1190
00:40:12,240 --> 00:40:14,319
large-scale remote access solutions it

1191
00:40:14,319 --> 00:40:16,079
doesn't matter if it's your vpn anything

1192
00:40:16,079 --> 00:40:17,520
that allows

1193
00:40:17,520 --> 00:40:18,960
if you have a perimeter-based defense i

1194
00:40:18,960 --> 00:40:20,480
should say if you're not already fully

1195
00:40:20,480 --> 00:40:22,560
zero trust anything that allows somebody

1196
00:40:22,560 --> 00:40:25,040
to simply know a secret and gain access

1197
00:40:25,040 --> 00:40:27,839
to all of your network is not okay now

1198
00:40:27,839 --> 00:40:29,359
most of us probably aren't using rsa

1199
00:40:29,359 --> 00:40:30,640
tokens like in the photograph there

1200
00:40:30,640 --> 00:40:32,319
anymore i happen to have one so i use it

1201
00:40:32,319 --> 00:40:33,839
as an example

1202
00:40:33,839 --> 00:40:36,079
i use the thing behind it a yubikey

1203
00:40:36,079 --> 00:40:38,720
personally to multi-factor remote access

1204
00:40:38,720 --> 00:40:40,400
all of the systems i'm responsible for

1205
00:40:40,400 --> 00:40:42,560
managing it's a smart card that i can

1206
00:40:42,560 --> 00:40:45,520
use to authenticate with both a physical

1207
00:40:45,520 --> 00:40:47,599
thing plus a pin in order to to gain

1208
00:40:47,599 --> 00:40:48,880
access

1209
00:40:48,880 --> 00:40:50,640
within our organization we use a

1210
00:40:50,640 --> 00:40:52,400
software push notification service as

1211
00:40:52,400 --> 00:40:54,800
another kind of two-factor really but

1212
00:40:54,800 --> 00:40:57,200
but on remote ac systems is not remote

1213
00:40:57,200 --> 00:40:59,359
access systems is not negotiable you may

1214
00:40:59,359 --> 00:41:01,200
decide you don't want multi-factor for

1215
00:41:01,200 --> 00:41:02,480
for email or you might not want

1216
00:41:02,480 --> 00:41:04,079
multi-factor for getting access to your

1217
00:41:04,079 --> 00:41:05,119
wiki

1218
00:41:05,119 --> 00:41:06,880
each organization has to measure risk

1219
00:41:06,880 --> 00:41:09,040
for themselves to decide where and how

1220
00:41:09,040 --> 00:41:11,119
to apply the strongest security

1221
00:41:11,119 --> 00:41:12,560
protections depending on what they can

1222
00:41:12,560 --> 00:41:14,000
afford or what inconvenience they're

1223
00:41:14,000 --> 00:41:16,560
willing to tolerate but you cannot grant

1224
00:41:16,560 --> 00:41:18,800
entry from the outside internet anymore

1225
00:41:18,800 --> 00:41:20,720
simply using a password they're being

1226
00:41:20,720 --> 00:41:22,240
stolen from your web browser they're

1227
00:41:22,240 --> 00:41:24,160
being stolen from your desktop computer

1228
00:41:24,160 --> 00:41:25,760
they've been stolen from linkedin

1229
00:41:25,760 --> 00:41:28,079
they've been stolen everywhere people do

1230
00:41:28,079 --> 00:41:30,079
reuse them they use predictable ones and

1231
00:41:30,079 --> 00:41:31,520
they're constantly being stolen from

1232
00:41:31,520 --> 00:41:33,920
staff members and there's just no

1233
00:41:33,920 --> 00:41:36,960
reasonable way to expect people to

1234
00:41:36,960 --> 00:41:38,800
keep passwords safe across an entire

1235
00:41:38,800 --> 00:41:40,480
organization and always use unique ones

1236
00:41:40,480 --> 00:41:41,760
no matter what you do to try to help

1237
00:41:41,760 --> 00:41:43,760
them you should try to help them people

1238
00:41:43,760 --> 00:41:45,359
should use unique passwords but it's not

1239
00:41:45,359 --> 00:41:47,359
going to happen and multi-factor will

1240
00:41:47,359 --> 00:41:49,280
stop almost all of these attacks in

1241
00:41:49,280 --> 00:41:52,000
their tracks without uh

1242
00:41:52,000 --> 00:41:54,160
with even a poor password so it really

1243
00:41:54,160 --> 00:41:57,759
is not optional it is essential

1244
00:41:59,839 --> 00:42:00,800
and

1245
00:42:00,800 --> 00:42:02,480
you know you got to decide that balance

1246
00:42:02,480 --> 00:42:03,920
between updating and mitigating and i

1247
00:42:03,920 --> 00:42:05,200
got to thinking about this going this is

1248
00:42:05,200 --> 00:42:06,960
not a new idea we've been talking about

1249
00:42:06,960 --> 00:42:08,480
this forever so i went look through some

1250
00:42:08,480 --> 00:42:10,560
slides and i found a slide deck i had

1251
00:42:10,560 --> 00:42:13,200
from 2011 when i was doing a series

1252
00:42:13,200 --> 00:42:15,200
called anatomy of an attack where i was

1253
00:42:15,200 --> 00:42:17,359
talking about how the amount of time you

1254
00:42:17,359 --> 00:42:18,880
have to patch is vanishing because of

1255
00:42:18,880 --> 00:42:20,960
course back in 2003 when the blaster

1256
00:42:20,960 --> 00:42:23,200
worm was running rampant across the

1257
00:42:23,200 --> 00:42:25,680
internet it was 72 days from the

1258
00:42:25,680 --> 00:42:28,240
disclosure of the vulnerability

1259
00:42:28,240 --> 00:42:30,240
until the worm was released so you had

1260
00:42:30,240 --> 00:42:32,640
two and a half months to patch and yet

1261
00:42:32,640 --> 00:42:34,000
people still didn't right like we saw

1262
00:42:34,000 --> 00:42:35,920
this worm just race across the internet

1263
00:42:35,920 --> 00:42:37,359
because back in 2003 it wasn't that

1264
00:42:37,359 --> 00:42:39,760
common to patches quickly and then you

1265
00:42:39,760 --> 00:42:41,760
know accelerating closer to the time of

1266
00:42:41,760 --> 00:42:43,680
that presentation the aurora attack

1267
00:42:43,680 --> 00:42:44,960
which was the attack that china

1268
00:42:44,960 --> 00:42:47,359
allegedly broke into google in china

1269
00:42:47,359 --> 00:42:49,280
china the country broke into google

1270
00:42:49,280 --> 00:42:52,160
china uh through an ie6 zero day

1271
00:42:52,160 --> 00:42:54,000
vulnerability and of course as soon as

1272
00:42:54,000 --> 00:42:55,440
that was discovered it was exploited

1273
00:42:55,440 --> 00:42:57,280
everywhere on the internet with no time

1274
00:42:57,280 --> 00:42:59,920
to patch so already we had been down to

1275
00:42:59,920 --> 00:43:00,800
zero

1276
00:43:00,800 --> 00:43:02,319
reasonable days to patch for most

1277
00:43:02,319 --> 00:43:04,640
vulnerabilities in 2010 which quickly

1278
00:43:04,640 --> 00:43:06,560
was followed up by the stuxnet attack

1279
00:43:06,560 --> 00:43:09,119
against the iranian nuclear centrifuges

1280
00:43:09,119 --> 00:43:09,920
so

1281
00:43:09,920 --> 00:43:12,000
more than 10 years ago we were already

1282
00:43:12,000 --> 00:43:13,440
at a point where we couldn't wait and

1283
00:43:13,440 --> 00:43:15,359
yet we're waiting and we understand why

1284
00:43:15,359 --> 00:43:17,440
i mean microsoft doesn't always ship

1285
00:43:17,440 --> 00:43:20,480
perfect patches we've seen some vulnerab

1286
00:43:20,480 --> 00:43:21,760
blue screens and other things happen

1287
00:43:21,760 --> 00:43:25,040
from microsoft patches in recent months

1288
00:43:25,040 --> 00:43:26,400
you know oracle

1289
00:43:26,400 --> 00:43:28,480
systems and i'm not picking specifically

1290
00:43:28,480 --> 00:43:29,839
on oracle but i will because they have

1291
00:43:29,839 --> 00:43:33,119
lots of vulnerabilities they had uh 461

1292
00:43:33,119 --> 00:43:35,119
i think this month so that's more than a

1293
00:43:35,119 --> 00:43:37,200
few vulnerabilities of per quarter to

1294
00:43:37,200 --> 00:43:38,800
having your products

1295
00:43:38,800 --> 00:43:41,359
but they're big complicated enterprise

1296
00:43:41,359 --> 00:43:43,280
uh tools that if you can't afford

1297
00:43:43,280 --> 00:43:45,200
downtime patching them is a risky thing

1298
00:43:45,200 --> 00:43:46,480
if you build a lot of custom logic

1299
00:43:46,480 --> 00:43:48,400
around them so it's understandable that

1300
00:43:48,400 --> 00:43:51,760
we can't always patch on day zero

1301
00:43:51,760 --> 00:43:53,920
so what is your mitigation plan like you

1302
00:43:53,920 --> 00:43:55,119
need to mitigate those volumes but you

1303
00:43:55,119 --> 00:43:56,720
can't just go well we're going to wait

1304
00:43:56,720 --> 00:43:59,200
60 days to patch our oracle servers

1305
00:43:59,200 --> 00:44:01,200
and then do nothing

1306
00:44:01,200 --> 00:44:02,960
you have to do something during those 60

1307
00:44:02,960 --> 00:44:04,000
days

1308
00:44:04,000 --> 00:44:05,839
while you're doing the testing you need

1309
00:44:05,839 --> 00:44:07,839
to have either software defenses in

1310
00:44:07,839 --> 00:44:09,520
place that are looking for exploitation

1311
00:44:09,520 --> 00:44:11,760
things that might detect detect buffer

1312
00:44:11,760 --> 00:44:13,119
overflow attacks things that might

1313
00:44:13,119 --> 00:44:14,720
detect sql injection depending on what

1314
00:44:14,720 --> 00:44:16,960
the service is you may want to have

1315
00:44:16,960 --> 00:44:19,359
advanced uh vulnerability detection

1316
00:44:19,359 --> 00:44:22,560
software installed on those servers

1317
00:44:22,560 --> 00:44:25,200
you also may want to shut certain ports

1318
00:44:25,200 --> 00:44:27,680
off or put them behind proxies things

1319
00:44:27,680 --> 00:44:29,920
like a waff a web application firewall

1320
00:44:29,920 --> 00:44:31,839
maybe another way to put a mitigation in

1321
00:44:31,839 --> 00:44:33,839
front of a slightly vulnerable service

1322
00:44:33,839 --> 00:44:35,520
but again don't

1323
00:44:35,520 --> 00:44:36,880
perpetually have an exception to

1324
00:44:36,880 --> 00:44:38,319
applying that patch we're going to do it

1325
00:44:38,319 --> 00:44:39,680
in 60 days

1326
00:44:39,680 --> 00:44:41,119
during the 60-day window we're going to

1327
00:44:41,119 --> 00:44:43,280
be behind a waf proxy we're going to

1328
00:44:43,280 --> 00:44:45,040
have advanced endpoint detection

1329
00:44:45,040 --> 00:44:46,480
software on that server in case there's

1330
00:44:46,480 --> 00:44:48,160
a buffer overflow or other type of

1331
00:44:48,160 --> 00:44:49,599
attack against those known

1332
00:44:49,599 --> 00:44:50,960
vulnerabilities

1333
00:44:50,960 --> 00:44:52,160
and

1334
00:44:52,160 --> 00:44:54,240
we are going to get that patch delivered

1335
00:44:54,240 --> 00:44:56,480
by the 60th day whether that means

1336
00:44:56,480 --> 00:44:58,480
working with the vendor to assist you

1337
00:44:58,480 --> 00:45:00,960
with the testing whatever it takes

1338
00:45:00,960 --> 00:45:02,560
making sure you're going back and around

1339
00:45:02,560 --> 00:45:04,800
that loop around the mitigation of you

1340
00:45:04,800 --> 00:45:06,160
know protecting

1341
00:45:06,160 --> 00:45:08,240
the best you can trying to detect if

1342
00:45:08,240 --> 00:45:10,079
it's failed responding to it with

1343
00:45:10,079 --> 00:45:12,160
mitigations when you can fixing the

1344
00:45:12,160 --> 00:45:14,240
system and then identifying the risks

1345
00:45:14,240 --> 00:45:15,520
again and you got to keep going around

1346
00:45:15,520 --> 00:45:16,640
the loop

1347
00:45:16,640 --> 00:45:19,839
if uh you can't patch immediately and so

1348
00:45:19,839 --> 00:45:21,599
what we see many organizations doing of

1349
00:45:21,599 --> 00:45:23,200
course is generally applying patches to

1350
00:45:23,200 --> 00:45:24,480
endpoints nearly immediately when

1351
00:45:24,480 --> 00:45:25,760
they're available from microsoft and

1352
00:45:25,760 --> 00:45:27,760
other vendors and on the servers we see

1353
00:45:27,760 --> 00:45:29,839
more of a 7 to 14 day time window

1354
00:45:29,839 --> 00:45:32,160
typically but when it goes longer than 7

1355
00:45:32,160 --> 00:45:33,839
or 14 days and when those mitigations

1356
00:45:33,839 --> 00:45:35,440
aren't in place you're almost guaranteed

1357
00:45:35,440 --> 00:45:37,119
that that server is going to be hacked

1358
00:45:37,119 --> 00:45:38,720
so would you rather have the risk of a

1359
00:45:38,720 --> 00:45:39,920
blue screen

1360
00:45:39,920 --> 00:45:42,640
which reboots the server or a guarantee

1361
00:45:42,640 --> 00:45:44,160
that it's going to be compromised and

1362
00:45:44,160 --> 00:45:45,520
potentially turn into a thing like a

1363
00:45:45,520 --> 00:45:47,520
ransomware attack i know i'll take a

1364
00:45:47,520 --> 00:45:50,319
blue screen any day

1365
00:45:52,240 --> 00:45:53,920
raising barriers is really important and

1366
00:45:53,920 --> 00:45:55,440
we've gotten bad at this back when i

1367
00:45:55,440 --> 00:45:56,400
mentioned

1368
00:45:56,400 --> 00:45:58,400
blaster a few minutes ago on a flat

1369
00:45:58,400 --> 00:46:00,400
network architecture blaster would hit

1370
00:46:00,400 --> 00:46:01,839
your entire network

1371
00:46:01,839 --> 00:46:04,800
and so in 2003 2004 2005 this was

1372
00:46:04,800 --> 00:46:06,560
happening a lot so one of the things

1373
00:46:06,560 --> 00:46:09,200
that we did as vendors uh was finally

1374
00:46:09,200 --> 00:46:10,640
get everyone to start segmenting their

1375
00:46:10,640 --> 00:46:11,760
networks if you could put up some

1376
00:46:11,760 --> 00:46:14,319
firewalls segment your network you would

1377
00:46:14,319 --> 00:46:15,839
have much less likelihood that a

1378
00:46:15,839 --> 00:46:17,280
criminal would be able to get into one

1379
00:46:17,280 --> 00:46:19,760
system and compromise all the systems

1380
00:46:19,760 --> 00:46:21,359
unfortunately in most these ransom

1381
00:46:21,359 --> 00:46:23,520
attacks we see today uh they're running

1382
00:46:23,520 --> 00:46:26,400
uh rampant across the entire network and

1383
00:46:26,400 --> 00:46:28,800
um you know most famously we said not

1384
00:46:28,800 --> 00:46:31,920
petya attack uh which was uh against a

1385
00:46:31,920 --> 00:46:33,920
ukrainian accounting firm actually

1386
00:46:33,920 --> 00:46:35,680
affected a lot of firms outside of the

1387
00:46:35,680 --> 00:46:38,319
uk because they may have had a uk uh

1388
00:46:38,319 --> 00:46:40,640
sorry ukrainian subsidiary

1389
00:46:40,640 --> 00:46:42,319
and then it spread across their entire

1390
00:46:42,319 --> 00:46:44,000
internal network even though no one else

1391
00:46:44,000 --> 00:46:46,720
used the affected software in uh that

1392
00:46:46,720 --> 00:46:49,040
ukraine required uh we saw this with

1393
00:46:49,040 --> 00:46:50,720
mayor's shipping when they were ransomed

1394
00:46:50,720 --> 00:46:52,319
their entire global network went down in

1395
00:46:52,319 --> 00:46:54,160
fact the only thing that saved them was

1396
00:46:54,160 --> 00:46:55,680
they had an internet connection down

1397
00:46:55,680 --> 00:46:57,839
somewhere in africa and that meant they

1398
00:46:57,839 --> 00:47:00,160
had one domain controller that was

1399
00:47:00,160 --> 00:47:02,000
not compromised because they were

1400
00:47:02,000 --> 00:47:04,160
offline and they literally had to

1401
00:47:04,160 --> 00:47:06,720
physically like fedex the hard disks

1402
00:47:06,720 --> 00:47:08,480
from that server back to their corporate

1403
00:47:08,480 --> 00:47:09,760
headquarters in order to recover their

1404
00:47:09,760 --> 00:47:11,119
system so they were very fortunate that

1405
00:47:11,119 --> 00:47:13,280
when system was offline so there's a lot

1406
00:47:13,280 --> 00:47:15,040
of advantages to segmentation and if you

1407
00:47:15,040 --> 00:47:16,240
can segment

1408
00:47:16,240 --> 00:47:17,920
finance from the rest of your network or

1409
00:47:17,920 --> 00:47:19,280
engineering from the rest of the network

1410
00:47:19,280 --> 00:47:20,559
you need to decide where your high and

1411
00:47:20,559 --> 00:47:22,400
low risk areas of your network are but

1412
00:47:22,400 --> 00:47:24,000
if you can put up some firewalls between

1413
00:47:24,000 --> 00:47:26,079
those areas they're not just useful for

1414
00:47:26,079 --> 00:47:28,160
blocking lateral movement which they

1415
00:47:28,160 --> 00:47:30,480
certainly are i mean it's a great way to

1416
00:47:30,480 --> 00:47:32,480
slow down an attacker from compromising

1417
00:47:32,480 --> 00:47:34,559
all the assets within your organization

1418
00:47:34,559 --> 00:47:36,079
they're also a checkpoint i use this

1419
00:47:36,079 --> 00:47:38,400
image of checkpoint charlie in berlin

1420
00:47:38,400 --> 00:47:40,079
they're a place where you can record and

1421
00:47:40,079 --> 00:47:42,079
log the movement of data and that's

1422
00:47:42,079 --> 00:47:44,000
equally as important if you happen to be

1423
00:47:44,000 --> 00:47:46,640
compromised and your regulator or your

1424
00:47:46,640 --> 00:47:48,880
attorneys say were they able to access

1425
00:47:48,880 --> 00:47:50,880
the files and human resources

1426
00:47:50,880 --> 00:47:52,960
well if you don't have a firewall

1427
00:47:52,960 --> 00:47:54,400
between human resources and the rest of

1428
00:47:54,400 --> 00:47:56,319
the network you likely don't know if

1429
00:47:56,319 --> 00:47:58,800
they were moving in data in and out of

1430
00:47:58,800 --> 00:48:01,200
that network but if you do you at least

1431
00:48:01,200 --> 00:48:02,559
know the data was stolen even if the

1432
00:48:02,559 --> 00:48:04,000
data was allowed and unfortunately it

1433
00:48:04,000 --> 00:48:06,319
was stolen you now have a record that

1434
00:48:06,319 --> 00:48:08,319
there was a connection from server a to

1435
00:48:08,319 --> 00:48:10,319
server b and this amount of data was

1436
00:48:10,319 --> 00:48:12,800
transferred and that allows you to start

1437
00:48:12,800 --> 00:48:14,800
to track down what parts of your network

1438
00:48:14,800 --> 00:48:16,800
were compromised as part of the attack

1439
00:48:16,800 --> 00:48:19,200
and it also allows you to sort of

1440
00:48:19,200 --> 00:48:20,640
seal the hatches no different than you

1441
00:48:20,640 --> 00:48:22,640
might do in a ship if if one part of a

1442
00:48:22,640 --> 00:48:24,640
ship starts to flood you close the doors

1443
00:48:24,640 --> 00:48:26,720
and you lock them down so only one

1444
00:48:26,720 --> 00:48:28,319
segment of the ship floods and the whole

1445
00:48:28,319 --> 00:48:30,480
ship doesn't flood and

1446
00:48:30,480 --> 00:48:32,720
even if the firewall networks are open

1447
00:48:32,720 --> 00:48:34,800
for normal operation as soon as you

1448
00:48:34,800 --> 00:48:36,480
detect that you're under attack you can

1449
00:48:36,480 --> 00:48:38,319
immediately close them all and at least

1450
00:48:38,319 --> 00:48:39,599
now you've been able to isolate the

1451
00:48:39,599 --> 00:48:40,880
attackers into one segment of your

1452
00:48:40,880 --> 00:48:43,280
network

1453
00:48:45,200 --> 00:48:46,880
and lastly you have to be throughout

1454
00:48:46,880 --> 00:48:48,640
hunting back from that get away from

1455
00:48:48,640 --> 00:48:50,480
reactive and get into proactive you need

1456
00:48:50,480 --> 00:48:52,960
to be out there actively watching and in

1457
00:48:52,960 --> 00:48:56,319
a recent survey we did of victims that

1458
00:48:56,319 --> 00:48:57,680
had the beginnings of a ransomware

1459
00:48:57,680 --> 00:48:59,359
attack that was able to penetrate their

1460
00:48:59,359 --> 00:49:02,720
network 47 percent were able to

1461
00:49:02,720 --> 00:49:05,119
effectively defend themselves and not

1462
00:49:05,119 --> 00:49:07,520
end up being ransomed so they got

1463
00:49:07,520 --> 00:49:09,200
infected the criminals may have even

1464
00:49:09,200 --> 00:49:11,760
encrypted a server or two uh they may

1465
00:49:11,760 --> 00:49:14,240
have started you know stealing data but

1466
00:49:14,240 --> 00:49:15,920
before they were able to infect and

1467
00:49:15,920 --> 00:49:17,680
encrypt all the systems

1468
00:49:17,680 --> 00:49:19,520
they were able to detect that and evict

1469
00:49:19,520 --> 00:49:21,200
them from their networks that's less

1470
00:49:21,200 --> 00:49:22,640
than half though we need to do better

1471
00:49:22,640 --> 00:49:24,240
than that more than half of us need to

1472
00:49:24,240 --> 00:49:26,480
be prepared and actively watching for

1473
00:49:26,480 --> 00:49:28,559
these attacks and

1474
00:49:28,559 --> 00:49:31,040
in interviewing victims

1475
00:49:31,040 --> 00:49:32,319
those that

1476
00:49:32,319 --> 00:49:33,920
said that their practice was to have

1477
00:49:33,920 --> 00:49:36,160
threat hunters and people that patrolled

1478
00:49:36,160 --> 00:49:37,200
the network

1479
00:49:37,200 --> 00:49:40,160
watched the logs in the sock maintained

1480
00:49:40,160 --> 00:49:42,000
what a normal looked like and understood

1481
00:49:42,000 --> 00:49:44,160
that these administrative tools are used

1482
00:49:44,160 --> 00:49:45,680
on saturdays for maintenance not on

1483
00:49:45,680 --> 00:49:47,839
mondays and new when they saw it on a

1484
00:49:47,839 --> 00:49:49,760
monday it was a criminal on the network

1485
00:49:49,760 --> 00:49:51,119
whereas when they saw it on a saturday

1486
00:49:51,119 --> 00:49:52,480
it was probably legitimate maintenance

1487
00:49:52,480 --> 00:49:54,720
activity those are the ones that survive

1488
00:49:54,720 --> 00:49:55,839
these attacks they're the ones that

1489
00:49:55,839 --> 00:49:57,440
don't pay the ransom they're the ones

1490
00:49:57,440 --> 00:49:58,960
that stop it before it gets to the point

1491
00:49:58,960 --> 00:50:00,720
where it encrypts their files and more

1492
00:50:00,720 --> 00:50:01,920
often than not they're the ones to

1493
00:50:01,920 --> 00:50:04,000
detect it within the first 24 or 48

1494
00:50:04,000 --> 00:50:05,359
hours

1495
00:50:05,359 --> 00:50:07,359
of it starting which is often enough to

1496
00:50:07,359 --> 00:50:09,680
prevent all damage many of these attacks

1497
00:50:09,680 --> 00:50:11,359
take seven or more days from start to

1498
00:50:11,359 --> 00:50:13,359
finish so if you can

1499
00:50:13,359 --> 00:50:16,319
detect them in an hour or four hours or

1500
00:50:16,319 --> 00:50:18,960
god forbid even 24 hours you're far

1501
00:50:18,960 --> 00:50:21,680
ahead of the pack you're you're okay

1502
00:50:21,680 --> 00:50:23,200
there are humans that are attacking you

1503
00:50:23,200 --> 00:50:25,119
these are not bots this is not an

1504
00:50:25,119 --> 00:50:27,040
automated process it takes the criminal

1505
00:50:27,040 --> 00:50:29,119
some time to identify with data they

1506
00:50:29,119 --> 00:50:30,880
want to steal they've done it they don't

1507
00:50:30,880 --> 00:50:32,480
want to lock up how they're going to

1508
00:50:32,480 --> 00:50:34,400
turn off your backups all those things

1509
00:50:34,400 --> 00:50:35,920
take human beings that are unfamiliar

1510
00:50:35,920 --> 00:50:37,520
with your network a bit of time and they

1511
00:50:37,520 --> 00:50:39,680
make a bit of noise along the way right

1512
00:50:39,680 --> 00:50:41,920
and so you can detect that noise but

1513
00:50:41,920 --> 00:50:43,200
when you detect it don't just

1514
00:50:43,200 --> 00:50:45,599
acknowledge the alert investigate it and

1515
00:50:45,599 --> 00:50:46,800
that's the difference between threat

1516
00:50:46,800 --> 00:50:48,559
hunting and being reactive a threat

1517
00:50:48,559 --> 00:50:50,240
hunter is patrolling the perimeter

1518
00:50:50,240 --> 00:50:51,760
watching for the things that that's out

1519
00:50:51,760 --> 00:50:53,839
of place listening for the broken glass

1520
00:50:53,839 --> 00:50:55,359
in the front window and going and

1521
00:50:55,359 --> 00:50:57,280
investigating it and if you hear it and

1522
00:50:57,280 --> 00:50:58,559
you investigate it you're likely to

1523
00:50:58,559 --> 00:51:00,640
survive these attacks with far less

1524
00:51:00,640 --> 00:51:03,599
costly organization if not making it uh

1525
00:51:03,599 --> 00:51:05,440
through it without even losing any data

1526
00:51:05,440 --> 00:51:07,040
and that's really the goal and that's

1527
00:51:07,040 --> 00:51:08,559
what we're hoping that you're able to

1528
00:51:08,559 --> 00:51:10,480
learn some processes and techniques for

1529
00:51:10,480 --> 00:51:12,720
accomplishing that for your organization

1530
00:51:12,720 --> 00:51:14,319
based on what i was able to share with

1531
00:51:14,319 --> 00:51:15,359
you today

1532
00:51:15,359 --> 00:51:17,359
so i thank you very much for listening

1533
00:51:17,359 --> 00:51:19,040
to my session i hope you found it

1534
00:51:19,040 --> 00:51:21,040
educational and helpful if you'd like to

1535
00:51:21,040 --> 00:51:22,800
reach out to me you can find me on

1536
00:51:22,800 --> 00:51:24,640
twitter at chatwizneski

1537
00:51:24,640 --> 00:51:27,640
w-i-s-n-i-e-w-s-k-i

1538
00:51:28,160 --> 00:51:29,599
and if you search for me on google it's

1539
00:51:29,599 --> 00:51:31,359
easy to find my email address and feel

1540
00:51:31,359 --> 00:51:33,359
free to contact me at sophos we're

1541
00:51:33,359 --> 00:51:35,520
always happy to share what we know and

1542
00:51:35,520 --> 00:51:37,040
do our best to help protect you against

1543
00:51:37,040 --> 00:51:41,480
the latest threats thank you

