1
00:00:04,480 --> 00:00:06,560
hello and welcome everyone thank you

2
00:00:06,560 --> 00:00:08,400
thank you for being here today with us

3
00:00:08,400 --> 00:00:10,800
for this tag skopx the path to surprise

4
00:00:10,800 --> 00:00:13,840
breaches i'm excited to be here also as

5
00:00:13,840 --> 00:00:15,920
a part of the simcon this year

6
00:00:15,920 --> 00:00:17,359
thanks for the organizers and the

7
00:00:17,359 --> 00:00:20,480
awesome sponsors ec council and vissen

8
00:00:20,480 --> 00:00:22,400
before we get started i'm going to go

9
00:00:22,400 --> 00:00:24,320
through a very quick introduction about

10
00:00:24,320 --> 00:00:26,800
myself my name is mesa maslahi i'm a

11
00:00:26,800 --> 00:00:28,880
cyber security practitioner interested

12
00:00:28,880 --> 00:00:30,320
in both reactive and proactive

13
00:00:30,320 --> 00:00:32,399
cybersecurity services i'm a

14
00:00:32,399 --> 00:00:34,559
cybersecurity consultant researcher and

15
00:00:34,559 --> 00:00:36,480
blogger as well at the moment i'm

16
00:00:36,480 --> 00:00:37,520
working

17
00:00:37,520 --> 00:00:40,559
as a senior director at egs ec council

18
00:00:40,559 --> 00:00:42,800
global services

19
00:00:42,800 --> 00:00:44,559
i would be more than happy to connect to

20
00:00:44,559 --> 00:00:46,640
all of you via linkedin and or twitter

21
00:00:46,640 --> 00:00:48,480
whichever works better for you together

22
00:00:48,480 --> 00:00:51,039
we can share and together we can learn

23
00:00:51,039 --> 00:00:52,719
and learn for sure

24
00:00:52,719 --> 00:00:54,879
so here is the agenda for the today talk

25
00:00:54,879 --> 00:00:56,960
we will start with the concept of the

26
00:00:56,960 --> 00:00:59,680
scope x and unknown risks

27
00:00:59,680 --> 00:01:01,440
we will continue with the threat hunting

28
00:01:01,440 --> 00:01:03,520
which is a proactive approach that may

29
00:01:03,520 --> 00:01:06,240
help us to effectively address the

30
00:01:06,240 --> 00:01:09,200
issues caused by the scopex and finally

31
00:01:09,200 --> 00:01:11,040
we have a brief review of the threat

32
00:01:11,040 --> 00:01:14,000
hunting in the sub domains just as it

33
00:01:14,000 --> 00:01:16,479
as an example to elaborate the technical

34
00:01:16,479 --> 00:01:17,680
part of

35
00:01:17,680 --> 00:01:19,439
this webinar

36
00:01:19,439 --> 00:01:23,680
so the scopex the land of the unknowns

37
00:01:23,680 --> 00:01:26,000
i think everyone agreed to the point

38
00:01:26,000 --> 00:01:28,640
that the pandemic has changed our life

39
00:01:28,640 --> 00:01:31,200
in many ways is not only about lives

40
00:01:31,200 --> 00:01:34,720
it's about the businesses as well so

41
00:01:34,720 --> 00:01:37,280
every businesses must go through a rapid

42
00:01:37,280 --> 00:01:39,840
digitalization to just survive in this

43
00:01:39,840 --> 00:01:42,560
situation based on the reports what

44
00:01:42,560 --> 00:01:44,560
that's supposed to be done within seven

45
00:01:44,560 --> 00:01:47,119
to ten years and just happened in less

46
00:01:47,119 --> 00:01:48,479
than a year

47
00:01:48,479 --> 00:01:49,280
uh

48
00:01:49,280 --> 00:01:51,360
and nothing wrong with that actually but

49
00:01:51,360 --> 00:01:54,479
this rapid growth may brought a lot of

50
00:01:54,479 --> 00:01:57,520
risk to our environments such as lack of

51
00:01:57,520 --> 00:02:00,240
readiness lack of visibility and in

52
00:02:00,240 --> 00:02:02,640
overall we may provide more attack

53
00:02:02,640 --> 00:02:05,759
surfaces to the attackers it's it's not

54
00:02:05,759 --> 00:02:08,000
it wasn't a really big surprise to me

55
00:02:08,000 --> 00:02:11,038
even the back road reported that nearly

56
00:02:11,038 --> 00:02:14,239
30 percent of the cyber attacks uh

57
00:02:14,239 --> 00:02:16,959
carried out via the unpolarized and

58
00:02:16,959 --> 00:02:19,520
unknown assets this is what i call it

59
00:02:19,520 --> 00:02:22,560
the scope x actually escopex is not only

60
00:02:22,560 --> 00:02:23,760
covers

61
00:02:23,760 --> 00:02:26,239
the assets it could be any unregistered

62
00:02:26,239 --> 00:02:28,400
unattended unpreacherized and unknown

63
00:02:28,400 --> 00:02:31,120
things within our organizations people

64
00:02:31,120 --> 00:02:32,720
process and

65
00:02:32,720 --> 00:02:34,080
technology

66
00:02:34,080 --> 00:02:35,840
technically these are a bunch of the

67
00:02:35,840 --> 00:02:37,200
unknowns and

68
00:02:37,200 --> 00:02:39,680
accordingly they are out of our radars

69
00:02:39,680 --> 00:02:42,319
and we have no protection around them

70
00:02:42,319 --> 00:02:43,920
because of what we don't know we don't

71
00:02:43,920 --> 00:02:46,879
know and we cannot protect what we don't

72
00:02:46,879 --> 00:02:48,239
know so

73
00:02:48,239 --> 00:02:50,640
this is not actually a new

74
00:02:50,640 --> 00:02:52,879
term but in my opinion we should pay

75
00:02:52,879 --> 00:02:54,480
attention and

76
00:02:54,480 --> 00:02:57,200
we should pay more attention uh to these

77
00:02:57,200 --> 00:02:59,599
uh unknowns in other

78
00:02:59,599 --> 00:03:02,400
environments so for example one of the

79
00:03:02,400 --> 00:03:04,879
good examples of the scopex and the

80
00:03:04,879 --> 00:03:08,080
unknowns is the sub domains

81
00:03:08,080 --> 00:03:11,040
why i say so because in almost every

82
00:03:11,040 --> 00:03:13,040
engagement i asked client do you know

83
00:03:13,040 --> 00:03:15,120
how many subdomains you have at the

84
00:03:15,120 --> 00:03:18,080
moment for your main domain and in most

85
00:03:18,080 --> 00:03:20,400
of the cases they replied like we are

86
00:03:20,400 --> 00:03:22,800
not sure it's because we may have a

87
00:03:22,800 --> 00:03:25,040
hundred and thousand subdomains for our

88
00:03:25,040 --> 00:03:27,519
main domain in most of the cases they

89
00:03:27,519 --> 00:03:29,200
are not well maintained they are not

90
00:03:29,200 --> 00:03:32,159
inherit the cyber security controls from

91
00:03:32,159 --> 00:03:33,760
the parent domain

92
00:03:33,760 --> 00:03:35,599
and technically they are out of the

93
00:03:35,599 --> 00:03:38,080
rudders so when the things are out of

94
00:03:38,080 --> 00:03:40,959
rudders and out of our monitoring scope

95
00:03:40,959 --> 00:03:45,200
we may not able to fully protect them so

96
00:03:45,200 --> 00:03:47,040
this is where we should think twice

97
00:03:47,040 --> 00:03:49,200
actually shall we assume protection when

98
00:03:49,200 --> 00:03:51,200
it comes to the unknowns and to the

99
00:03:51,200 --> 00:03:52,640
scopex

100
00:03:52,640 --> 00:03:53,920
in general we have two type of

101
00:03:53,920 --> 00:03:56,319
cybersecurity as a lot of you know the

102
00:03:56,319 --> 00:03:58,480
reactive and proactive in the reactive

103
00:03:58,480 --> 00:04:00,879
normally we assume the project we make

104
00:04:00,879 --> 00:04:03,120
sure to place all the security controls

105
00:04:03,120 --> 00:04:04,799
security solutions

106
00:04:04,799 --> 00:04:06,799
monitoring systems in the different

107
00:04:06,799 --> 00:04:09,200
layers then we keep monitoring and in

108
00:04:09,200 --> 00:04:10,959
case something happens we trigger the

109
00:04:10,959 --> 00:04:14,080
incident response and digital forensics

110
00:04:14,080 --> 00:04:16,160
so i came across a very interesting

111
00:04:16,160 --> 00:04:18,639
report by the ibm which says

112
00:04:18,639 --> 00:04:21,040
only eighty percent of the cyber attacks

113
00:04:21,040 --> 00:04:24,080
could be detected by automated security

114
00:04:24,080 --> 00:04:27,360
tools sucked year one and tier two

115
00:04:27,360 --> 00:04:29,840
around 20 percent remain

116
00:04:29,840 --> 00:04:31,040
uh

117
00:04:31,040 --> 00:04:33,360
undetected uh this could be because of

118
00:04:33,360 --> 00:04:34,639
the zero day because of the

119
00:04:34,639 --> 00:04:36,400
sophisticated techniques used by the

120
00:04:36,400 --> 00:04:38,400
cyber criminals but in my opinion it

121
00:04:38,400 --> 00:04:40,240
could be partially because of the escope

122
00:04:40,240 --> 00:04:42,800
x and the unknowns we may have a lot of

123
00:04:42,800 --> 00:04:44,800
unknown zone in our environment we are

124
00:04:44,800 --> 00:04:47,120
not even aware of their existence and

125
00:04:47,120 --> 00:04:49,120
definitely we are not aware of the risk

126
00:04:49,120 --> 00:04:51,680
and there will be no protection uh for

127
00:04:51,680 --> 00:04:53,520
them that's why in addition to the

128
00:04:53,520 --> 00:04:56,160
reactive security which is integral part

129
00:04:56,160 --> 00:04:58,240
of every strategy of

130
00:04:58,240 --> 00:04:59,120
for

131
00:04:59,120 --> 00:05:00,960
securing any company

132
00:05:00,960 --> 00:05:03,120
it would be a good idea to consider

133
00:05:03,120 --> 00:05:06,160
being proactive means we assume the

134
00:05:06,160 --> 00:05:09,520
breach we consider that an attacker

135
00:05:09,520 --> 00:05:12,000
successfully bridge to our network and

136
00:05:12,000 --> 00:05:15,120
then we try to look for the traces keep

137
00:05:15,120 --> 00:05:18,240
hunting and we proactively try to find

138
00:05:18,240 --> 00:05:20,479
the vulnerabilities the security issues

139
00:05:20,479 --> 00:05:23,600
and fix them before the attacker abuses

140
00:05:23,600 --> 00:05:25,360
them

141
00:05:25,360 --> 00:05:27,759
so the threat hunting is one of the

142
00:05:27,759 --> 00:05:30,320
technical proactive

143
00:05:30,320 --> 00:05:32,800
cyber security services it's human

144
00:05:32,800 --> 00:05:36,320
driven and must be done iteratively

145
00:05:36,320 --> 00:05:38,800
which which simply means that is not a

146
00:05:38,800 --> 00:05:41,759
one-time job actually is a continuous

147
00:05:41,759 --> 00:05:44,479
process in general we have two type of

148
00:05:44,479 --> 00:05:46,800
the threat hunting a structure and on a

149
00:05:46,800 --> 00:05:48,800
structure so let's start with the

150
00:05:48,800 --> 00:05:50,720
unstructured one which is

151
00:05:50,720 --> 00:05:52,960
totally data driven means a threat

152
00:05:52,960 --> 00:05:56,000
hunter go through a bunch of huge volume

153
00:05:56,000 --> 00:05:59,120
of the lugs and based on the experience

154
00:05:59,120 --> 00:06:01,520
look for the any deviation of the

155
00:06:01,520 --> 00:06:04,000
standard behaviors on the other hand

156
00:06:04,000 --> 00:06:06,240
structural threat hunting work around

157
00:06:06,240 --> 00:06:08,960
the educated guess or the hypotheses

158
00:06:08,960 --> 00:06:10,880
we may know that we are specifically

159
00:06:10,880 --> 00:06:12,479
looking for the certain type of the

160
00:06:12,479 --> 00:06:13,520
attach

161
00:06:13,520 --> 00:06:15,360
we know what type of data we should

162
00:06:15,360 --> 00:06:17,199
collect and what are the steps and the

163
00:06:17,199 --> 00:06:19,360
tools we may use to look for any

164
00:06:19,360 --> 00:06:22,720
evidence of that particular cyber attack

165
00:06:22,720 --> 00:06:25,199
so apart from that the threat hunting

166
00:06:25,199 --> 00:06:27,360
could be work around uh

167
00:06:27,360 --> 00:06:30,000
entity for example the high value assets

168
00:06:30,000 --> 00:06:31,919
or the high risk users this is what we

169
00:06:31,919 --> 00:06:34,400
call it entity delivery threat hunting

170
00:06:34,400 --> 00:06:35,759
it could be

171
00:06:35,759 --> 00:06:37,680
based on the specific threat actors and

172
00:06:37,680 --> 00:06:40,560
the technique used by them um to look

173
00:06:40,560 --> 00:06:43,199
for any a specific pattern of a

174
00:06:43,199 --> 00:06:45,759
particular attack or it could be a intel

175
00:06:45,759 --> 00:06:47,680
derivative for example over threat

176
00:06:47,680 --> 00:06:50,800
intelligent report team reported that uh

177
00:06:50,800 --> 00:06:52,880
recently there is a threat actor which

178
00:06:52,880 --> 00:06:55,520
is focused on the certain business

179
00:06:55,520 --> 00:06:57,599
sectors and if by chance we are in the

180
00:06:57,599 --> 00:06:59,360
same sector or we are using the same

181
00:06:59,360 --> 00:07:02,080
technology it could be give us some idea

182
00:07:02,080 --> 00:07:04,880
about what we should look for and hunt

183
00:07:04,880 --> 00:07:05,680
for

184
00:07:05,680 --> 00:07:07,919
so it could be a hybrid approach which

185
00:07:07,919 --> 00:07:09,919
is a combination of the all of these

186
00:07:09,919 --> 00:07:12,000
three we look for the specific users

187
00:07:12,000 --> 00:07:14,000
specific vulnerabilities and look for

188
00:07:14,000 --> 00:07:16,639
the particular uh cyber

189
00:07:16,639 --> 00:07:18,400
attack so

190
00:07:18,400 --> 00:07:20,000
regardless of the type of the threat

191
00:07:20,000 --> 00:07:22,080
hunting in general there are a few

192
00:07:22,080 --> 00:07:24,720
success factors so it's start with the

193
00:07:24,720 --> 00:07:26,960
high level one like a mindset awareness

194
00:07:26,960 --> 00:07:29,840
priorities capabilities and whole well

195
00:07:29,840 --> 00:07:32,560
the different teams in our organizations

196
00:07:32,560 --> 00:07:35,280
coordinate and collaborate with each

197
00:07:35,280 --> 00:07:38,319
other but if i want to divide that the

198
00:07:38,319 --> 00:07:40,720
if i want to talk about the main factors

199
00:07:40,720 --> 00:07:43,199
i could divide them into the three

200
00:07:43,199 --> 00:07:44,479
three main one

201
00:07:44,479 --> 00:07:46,800
started with the total visibility data

202
00:07:46,800 --> 00:07:50,000
quality and availability and situation

203
00:07:50,000 --> 00:07:51,440
awareness

204
00:07:51,440 --> 00:07:53,840
so total visibility means that

205
00:07:53,840 --> 00:07:55,840
we know about ourselves and we know

206
00:07:55,840 --> 00:07:58,080
about our enemy so this is how we can

207
00:07:58,080 --> 00:07:59,840
protect ourselves this is what it

208
00:07:59,840 --> 00:08:02,319
actually taught us by the swansea

209
00:08:02,319 --> 00:08:04,400
so but there are a few challenges there

210
00:08:04,400 --> 00:08:06,400
for example a rapid shift to the remote

211
00:08:06,400 --> 00:08:08,560
world the cloud infrastructures

212
00:08:08,560 --> 00:08:12,000
third-party vendors shadow it byod when

213
00:08:12,000 --> 00:08:14,400
the uvn our employees employ your

214
00:08:14,400 --> 00:08:17,440
employees use their own devices in their

215
00:08:17,440 --> 00:08:19,599
network place when it comes to the data

216
00:08:19,599 --> 00:08:21,440
quality and availability any

217
00:08:21,440 --> 00:08:24,400
misconfiguration on human errors limited

218
00:08:24,400 --> 00:08:26,800
access and controls for example i have a

219
00:08:26,800 --> 00:08:29,280
log but which is simply disabled and i

220
00:08:29,280 --> 00:08:32,240
have no access to that or it could be

221
00:08:32,240 --> 00:08:34,399
infrastructure overload and failure or

222
00:08:34,399 --> 00:08:36,159
even the cyber attack because of the

223
00:08:36,159 --> 00:08:38,080
cyber attack the date of vibe and i have

224
00:08:38,080 --> 00:08:40,479
no access to certain data which is

225
00:08:40,479 --> 00:08:42,640
needed to look for any evidence of

226
00:08:42,640 --> 00:08:45,680
malicious activities sexual

227
00:08:45,680 --> 00:08:47,360
situation awareness plays a very

228
00:08:47,360 --> 00:08:51,279
important role in the threat hunting um

229
00:08:51,279 --> 00:08:52,880
but the main challenge is that in most

230
00:08:52,880 --> 00:08:55,200
of the cases we have no baseline about

231
00:08:55,200 --> 00:08:56,959
what is good what is bad in our

232
00:08:56,959 --> 00:08:59,040
environment because based on the what is

233
00:08:59,040 --> 00:09:01,440
the good and what is bad we can search

234
00:09:01,440 --> 00:09:02,560
for the

235
00:09:02,560 --> 00:09:05,120
deviation

236
00:09:05,120 --> 00:09:07,200
it may be because of the poor data

237
00:09:07,200 --> 00:09:09,680
management's poor analysis and also

238
00:09:09,680 --> 00:09:13,440
diversity and dynamic nature of other

239
00:09:13,440 --> 00:09:15,920
environments so there are a lot of

240
00:09:15,920 --> 00:09:17,440
technical things that we can do to

241
00:09:17,440 --> 00:09:20,640
overcome these issues but in general we

242
00:09:20,640 --> 00:09:23,279
should proactively

243
00:09:23,279 --> 00:09:25,360
discover our asset and discover our

244
00:09:25,360 --> 00:09:27,760
resource to collect the data about them

245
00:09:27,760 --> 00:09:30,000
understand the nature of the

246
00:09:30,000 --> 00:09:32,320
each assets the business logic behind

247
00:09:32,320 --> 00:09:34,560
each assets so we should validate the

248
00:09:34,560 --> 00:09:37,040
data and classify them and then we

249
00:09:37,040 --> 00:09:39,279
should form a baseline uh thread

250
00:09:39,279 --> 00:09:41,519
modeling to find a potential model and

251
00:09:41,519 --> 00:09:43,680
they put their potential trade around

252
00:09:43,680 --> 00:09:44,640
our

253
00:09:44,640 --> 00:09:47,360
organizers and the current setup and

254
00:09:47,360 --> 00:09:49,040
limitations so

255
00:09:49,040 --> 00:09:51,920
let's make it simple and short just

256
00:09:51,920 --> 00:09:54,720
discover the unknowns and start thread

257
00:09:54,720 --> 00:09:55,760
hunting

258
00:09:55,760 --> 00:09:57,200
so

259
00:09:57,200 --> 00:09:59,440
when it comes to the subdomains we as we

260
00:09:59,440 --> 00:10:01,440
discussed earlier we may have thousands

261
00:10:01,440 --> 00:10:03,040
of the subdomains in our environment

262
00:10:03,040 --> 00:10:05,839
that's why the data collection and data

263
00:10:05,839 --> 00:10:08,800
validation is very important so i just

264
00:10:08,800 --> 00:10:11,839
simply designed a very um

265
00:10:11,839 --> 00:10:15,200
brief process about a

266
00:10:15,200 --> 00:10:17,680
threat hunting preparation for the

267
00:10:17,680 --> 00:10:19,920
subdomains however it could be adopted

268
00:10:19,920 --> 00:10:22,640
to any other type of assets in other

269
00:10:22,640 --> 00:10:24,959
environments so it's a start with a data

270
00:10:24,959 --> 00:10:26,720
collection could be passive could be

271
00:10:26,720 --> 00:10:28,640
active for example we should go through

272
00:10:28,640 --> 00:10:32,000
the dns and the subdomains enumeration

273
00:10:32,000 --> 00:10:34,240
to find a list of the existing subdomain

274
00:10:34,240 --> 00:10:36,000
for our environments

275
00:10:36,000 --> 00:10:38,240
so every subdomains must be validated

276
00:10:38,240 --> 00:10:40,880
for example simply to check their uh to

277
00:10:40,880 --> 00:10:42,880
check if they are up and leave or is

278
00:10:42,880 --> 00:10:45,760
just simply a false positive

279
00:10:45,760 --> 00:10:47,600
once we validate the data we can go

280
00:10:47,600 --> 00:10:49,519
through the classification based on the

281
00:10:49,519 --> 00:10:51,600
desired parameter for example in this

282
00:10:51,600 --> 00:10:54,240
example i only go for the

283
00:10:54,240 --> 00:10:56,800
subdomains which runs uh

284
00:10:56,800 --> 00:11:00,160
over the port 80 and port 443 which is

285
00:11:00,160 --> 00:11:02,959
the standard for the http and https

286
00:11:02,959 --> 00:11:05,600
and then we have to go through

287
00:11:05,600 --> 00:11:08,079
analyzes to look for the potential

288
00:11:08,079 --> 00:11:09,839
threat to look for the potential

289
00:11:09,839 --> 00:11:11,279
security

290
00:11:11,279 --> 00:11:12,959
issues for example unknown

291
00:11:12,959 --> 00:11:15,040
vulnerabilities and once everything

292
00:11:15,040 --> 00:11:16,959
documented we can pass this to our

293
00:11:16,959 --> 00:11:19,839
threat hunting team and ask them to come

294
00:11:19,839 --> 00:11:21,360
up with some educated guess and

295
00:11:21,360 --> 00:11:23,680
hypotheses and look for the potential

296
00:11:23,680 --> 00:11:26,480
threats so if you are wondering how we

297
00:11:26,480 --> 00:11:27,680
should

298
00:11:27,680 --> 00:11:29,920
take care of the this process either is

299
00:11:29,920 --> 00:11:33,279
a manual observation uh is it automation

300
00:11:33,279 --> 00:11:35,279
by tools and scripts or the advanced

301
00:11:35,279 --> 00:11:37,440
analytic techniques it's a combination

302
00:11:37,440 --> 00:11:39,360
of all of them

303
00:11:39,360 --> 00:11:40,240
three

304
00:11:40,240 --> 00:11:41,360
are needed

305
00:11:41,360 --> 00:11:42,880
so

306
00:11:42,880 --> 00:11:45,360
uh as bell said by my good friend

307
00:11:45,360 --> 00:11:47,680
charles we should spend time finding

308
00:11:47,680 --> 00:11:50,240
what we don't know and then we automate

309
00:11:50,240 --> 00:11:52,560
what we know normally we combine the

310
00:11:52,560 --> 00:11:54,959
manual observation

311
00:11:54,959 --> 00:11:57,440
with the advanced analytical techniques

312
00:11:57,440 --> 00:11:59,600
to look for the new cyber security

313
00:11:59,600 --> 00:12:02,240
attacks and once we identify them we can

314
00:12:02,240 --> 00:12:04,959
automate the things

315
00:12:04,959 --> 00:12:05,760
so

316
00:12:05,760 --> 00:12:08,000
the first step in the subdomain threat

317
00:12:08,000 --> 00:12:10,160
hunting is a data collection there are a

318
00:12:10,160 --> 00:12:12,480
lot of techniques to enumerate the dnss

319
00:12:12,480 --> 00:12:14,560
and a lot of tools out there i'm not

320
00:12:14,560 --> 00:12:16,720
going to talk about them in this webinar

321
00:12:16,720 --> 00:12:19,839
uh i'm i prefer to more talk about a

322
00:12:19,839 --> 00:12:22,160
type of potential observation that we

323
00:12:22,160 --> 00:12:24,000
could have here once we collect the

324
00:12:24,000 --> 00:12:25,760
subdomains we may

325
00:12:25,760 --> 00:12:27,600
observe

326
00:12:27,600 --> 00:12:29,920
a series of the old numbers for example

327
00:12:29,920 --> 00:12:31,040
there is

328
00:12:31,040 --> 00:12:33,920
the unusual number of the subdomains we

329
00:12:33,920 --> 00:12:35,760
used to have only a few subdomains for

330
00:12:35,760 --> 00:12:38,240
our businesses and suddenly we face a

331
00:12:38,240 --> 00:12:41,920
newly created subdomains in the mass of

332
00:12:41,920 --> 00:12:44,399
volume or it could be the unusual

333
00:12:44,399 --> 00:12:46,639
pattern for example any subdomains with

334
00:12:46,639 --> 00:12:49,440
the unusual name a strange name strange

335
00:12:49,440 --> 00:12:53,200
patterns unusual lens and to be simple

336
00:12:53,200 --> 00:12:54,639
all the unknowns

337
00:12:54,639 --> 00:12:56,480
something that we have never encountered

338
00:12:56,480 --> 00:12:58,480
before in our environment and they are

339
00:12:58,480 --> 00:13:00,480
not look familiar for us but there

340
00:13:00,480 --> 00:13:02,720
exists they newly created and no one

341
00:13:02,720 --> 00:13:04,320
aware of them

342
00:13:04,320 --> 00:13:06,720
so

343
00:13:06,720 --> 00:13:09,600
depends on the services run behind the

344
00:13:09,600 --> 00:13:11,120
subdomains they may come with a

345
00:13:11,120 --> 00:13:14,160
different names i just listed a few

346
00:13:14,160 --> 00:13:15,279
well-known

347
00:13:15,279 --> 00:13:19,760
ones like the ftp mail blog smtp admin

348
00:13:19,760 --> 00:13:21,440
my favorite one

349
00:13:21,440 --> 00:13:24,800
uh so it could be based on the

350
00:13:24,800 --> 00:13:26,880
stages that they are residing at the

351
00:13:26,880 --> 00:13:29,120
moment for example development test

352
00:13:29,120 --> 00:13:31,200
stage staging uat

353
00:13:31,200 --> 00:13:32,880
and so on

354
00:13:32,880 --> 00:13:36,480
so the very important point here is that

355
00:13:36,480 --> 00:13:38,399
we should use a combination of them for

356
00:13:38,399 --> 00:13:40,959
example my top favorite one is admin or

357
00:13:40,959 --> 00:13:44,399
login an api or portal which is in the

358
00:13:44,399 --> 00:13:46,160
test or a stage

359
00:13:46,160 --> 00:13:48,720
environment

360
00:13:48,720 --> 00:13:50,800
so once we collect the data we should

361
00:13:50,800 --> 00:13:52,880
validate them i just write a very simple

362
00:13:52,880 --> 00:13:55,600
script here definitely you can use your

363
00:13:55,600 --> 00:13:57,760
own creativity your own experience your

364
00:13:57,760 --> 00:14:00,000
own knowledge to develop more

365
00:14:00,000 --> 00:14:02,639
validation process based on your

366
00:14:02,639 --> 00:14:05,760
base on your agenda so here i just try

367
00:14:05,760 --> 00:14:08,160
to understand which um

368
00:14:08,160 --> 00:14:10,079
subdomains are up and leave and which

369
00:14:10,079 --> 00:14:11,440
one is

370
00:14:11,440 --> 00:14:15,040
down so the data validation effectively

371
00:14:15,040 --> 00:14:18,160
help us to narrow down the data to the

372
00:14:18,160 --> 00:14:20,959
quality one so actually we can

373
00:14:20,959 --> 00:14:23,680
deduct the amount of the unwanted data

374
00:14:23,680 --> 00:14:27,760
like false positive from our data set

375
00:14:27,760 --> 00:14:29,760
so when it comes to the classification

376
00:14:29,760 --> 00:14:31,279
again it depends on the desired

377
00:14:31,279 --> 00:14:33,920
parameter depends on the case depends on

378
00:14:33,920 --> 00:14:36,959
the situation but in this example i only

379
00:14:36,959 --> 00:14:38,880
look for the all the subdomains which is

380
00:14:38,880 --> 00:14:41,519
running over the port 80 and port

381
00:14:41,519 --> 00:14:44,480
443 i also collected the

382
00:14:44,480 --> 00:14:47,440
response code for the http to have a

383
00:14:47,440 --> 00:14:49,440
better understanding about what is going

384
00:14:49,440 --> 00:14:51,920
on in my environment so

385
00:14:51,920 --> 00:14:54,399
the classification is very important to

386
00:14:54,399 --> 00:14:57,440
have a good situational awareness

387
00:14:57,440 --> 00:15:00,079
we can understand and record the normals

388
00:15:00,079 --> 00:15:03,120
and then we look for any

389
00:15:03,120 --> 00:15:05,600
significant changes if there is no any

390
00:15:05,600 --> 00:15:07,680
operational or business logic behind

391
00:15:07,680 --> 00:15:10,959
that that could be a sign of the

392
00:15:10,959 --> 00:15:14,240
malicious activities so when it comes to

393
00:15:14,240 --> 00:15:16,320
the analysis as we just said it could be

394
00:15:16,320 --> 00:15:18,560
a start with the manual analysis manual

395
00:15:18,560 --> 00:15:20,639
analysis is always one of my favorite

396
00:15:20,639 --> 00:15:22,959
things especially during the training

397
00:15:22,959 --> 00:15:27,279
stage but observing thousand of the

398
00:15:27,279 --> 00:15:29,600
subdomains one by one is not practical

399
00:15:29,600 --> 00:15:31,680
however there is a common practice

400
00:15:31,680 --> 00:15:34,480
which uh using of the automated tools to

401
00:15:34,480 --> 00:15:37,759
screenshots all the subdomains in in one

402
00:15:37,759 --> 00:15:40,160
go and then we go through navigating the

403
00:15:40,160 --> 00:15:42,959
different images and any screenshot

404
00:15:42,959 --> 00:15:45,519
attract our attention then we can go and

405
00:15:45,519 --> 00:15:48,639
and dig more so via the screenshots we

406
00:15:48,639 --> 00:15:51,440
may face a lot of interesting things for

407
00:15:51,440 --> 00:15:53,199
example the error messages expose

408
00:15:53,199 --> 00:15:54,880
sensitive information

409
00:15:54,880 --> 00:15:57,120
default banner relief the technology

410
00:15:57,120 --> 00:16:00,399
used login pages pages leaks business

411
00:16:00,399 --> 00:16:03,759
information and a lot of other juicy

412
00:16:03,759 --> 00:16:06,480
informations

413
00:16:06,639 --> 00:16:09,279
when we talking about a large scale

414
00:16:09,279 --> 00:16:10,800
manual

415
00:16:10,800 --> 00:16:12,160
observation

416
00:16:12,160 --> 00:16:15,120
it's not that practical so here i just

417
00:16:15,120 --> 00:16:18,240
listed the four tools that works

418
00:16:18,240 --> 00:16:20,560
works well for me i'm not white listing

419
00:16:20,560 --> 00:16:22,880
any of other tools if you know any tools

420
00:16:22,880 --> 00:16:25,120
better than them please do not hesitate

421
00:16:25,120 --> 00:16:27,680
to introduce to us as well

422
00:16:27,680 --> 00:16:29,440
so one

423
00:16:29,440 --> 00:16:31,920
apart from the manual and automation we

424
00:16:31,920 --> 00:16:34,240
are mostly help us to look for the some

425
00:16:34,240 --> 00:16:36,880
things which is easy to understand

426
00:16:36,880 --> 00:16:39,199
when things become complex means the

427
00:16:39,199 --> 00:16:42,720
data the data is a large in the volume

428
00:16:42,720 --> 00:16:45,519
the data have the velocity changing

429
00:16:45,519 --> 00:16:48,240
rapidly over the time or the data comes

430
00:16:48,240 --> 00:16:50,880
with the different varieties and the

431
00:16:50,880 --> 00:16:53,279
attackers is very skilled one using a

432
00:16:53,279 --> 00:16:55,920
very sophisticated attack we definitely

433
00:16:55,920 --> 00:16:57,759
need something

434
00:16:57,759 --> 00:17:00,480
more than the tools and more than the

435
00:17:00,480 --> 00:17:03,440
ordinary thread hunter this is where we

436
00:17:03,440 --> 00:17:06,079
should get aid of the advanced analytic

437
00:17:06,079 --> 00:17:08,480
techniques such as the data mining

438
00:17:08,480 --> 00:17:10,640
machine learning pattern recognition

439
00:17:10,640 --> 00:17:14,000
neural networks and so on

440
00:17:14,000 --> 00:17:16,160
when we fit our

441
00:17:16,160 --> 00:17:19,039
ai driven engine with the data it could

442
00:17:19,039 --> 00:17:21,199
be supervised and unsupervised but at

443
00:17:21,199 --> 00:17:22,959
the end they help us to find the new

444
00:17:22,959 --> 00:17:27,199
ttps detection rule and even behavioral

445
00:17:27,199 --> 00:17:28,559
analysis

446
00:17:28,559 --> 00:17:31,280
so let's have a quick example in the

447
00:17:31,280 --> 00:17:34,559
last slide we assumed that our cti

448
00:17:34,559 --> 00:17:36,640
monitoring system reported a newly

449
00:17:36,640 --> 00:17:38,880
discovered web-based botnet

450
00:17:38,880 --> 00:17:41,280
targeting the microsoft windows system

451
00:17:41,280 --> 00:17:43,440
the botnet exploited several

452
00:17:43,440 --> 00:17:46,240
vulnerabilities so any of my machine

453
00:17:46,240 --> 00:17:48,960
behind any of the sub domains

454
00:17:48,960 --> 00:17:52,080
that run the microsoft operating system

455
00:17:52,080 --> 00:17:55,120
could be vulnerable to this

456
00:17:55,120 --> 00:17:58,320
and botnet so the bot master could get

457
00:17:58,320 --> 00:18:01,520
control over on my machines and even

458
00:18:01,520 --> 00:18:04,240
either steal information from them on

459
00:18:04,240 --> 00:18:06,400
force them to be part of the

460
00:18:06,400 --> 00:18:08,880
botnet command and control

461
00:18:08,880 --> 00:18:12,559
mechanism so two educated guests came

462
00:18:12,559 --> 00:18:14,799
into my mind and the first one is not

463
00:18:14,799 --> 00:18:17,440
the hunt i prefer to call it detection

464
00:18:17,440 --> 00:18:20,000
because it's working around the iocs so

465
00:18:20,000 --> 00:18:23,919
i go to check two things one any system

466
00:18:23,919 --> 00:18:27,039
in my network communicating with those

467
00:18:27,039 --> 00:18:30,960
ip or urls associated with the botnet

468
00:18:30,960 --> 00:18:34,000
so i can find the list of the known ip

469
00:18:34,000 --> 00:18:36,880
the known url the known host name the

470
00:18:36,880 --> 00:18:39,280
known subdomains from the

471
00:18:39,280 --> 00:18:41,440
public available cti

472
00:18:41,440 --> 00:18:43,039
databases

473
00:18:43,039 --> 00:18:43,919
and

474
00:18:43,919 --> 00:18:46,240
check in my access log if any of my

475
00:18:46,240 --> 00:18:48,720
systems communicating with them but

476
00:18:48,720 --> 00:18:50,720
another things which is more important i

477
00:18:50,720 --> 00:18:52,240
would like to know

478
00:18:52,240 --> 00:18:54,720
is any of my machines part of that

479
00:18:54,720 --> 00:18:57,600
botnet what if the bot master take

480
00:18:57,600 --> 00:19:00,400
control of my server which is one of the

481
00:19:00,400 --> 00:19:03,200
the services left behind one of the

482
00:19:03,200 --> 00:19:05,679
forgotten sub domains and then use them

483
00:19:05,679 --> 00:19:06,880
as a

484
00:19:06,880 --> 00:19:09,039
command and control

485
00:19:09,039 --> 00:19:11,760
servers so but as you know all of these

486
00:19:11,760 --> 00:19:14,000
techniques are more into the detection

487
00:19:14,000 --> 00:19:16,640
and base and work based on the known

488
00:19:16,640 --> 00:19:19,200
iocs what if the attack is a zero day

489
00:19:19,200 --> 00:19:21,520
there is no ioc around that this is

490
00:19:21,520 --> 00:19:25,039
where we need a behavioral analysis get

491
00:19:25,039 --> 00:19:27,039
the help of the machine learning get the

492
00:19:27,039 --> 00:19:28,480
head of the

493
00:19:28,480 --> 00:19:31,039
neural networks or ai or any other

494
00:19:31,039 --> 00:19:33,360
statistics or analytical techniques to

495
00:19:33,360 --> 00:19:36,160
look for the pattern for example one of

496
00:19:36,160 --> 00:19:38,400
the hypotheses about the botnet command

497
00:19:38,400 --> 00:19:40,640
and control activity detection says that

498
00:19:40,640 --> 00:19:42,880
the bot master may use the application

499
00:19:42,880 --> 00:19:46,320
layer protocol http over the port 80 to

500
00:19:46,320 --> 00:19:48,160
communicate with the command and control

501
00:19:48,160 --> 00:19:50,080
in the periodic

502
00:19:50,080 --> 00:19:51,120
format

503
00:19:51,120 --> 00:19:52,400
so

504
00:19:52,400 --> 00:19:54,960
it's not easy to find a periodic pattern

505
00:19:54,960 --> 00:19:57,120
in our environment because there are a

506
00:19:57,120 --> 00:19:58,720
lot of applications

507
00:19:58,720 --> 00:20:01,200
that may pose the same uh

508
00:20:01,200 --> 00:20:03,440
behavior for example the updaters the

509
00:20:03,440 --> 00:20:06,320
downloaders or any business related

510
00:20:06,320 --> 00:20:08,000
application which continuously and

511
00:20:08,000 --> 00:20:10,000
periodically connect to the server and

512
00:20:10,000 --> 00:20:12,799
fetch the business related informations

513
00:20:12,799 --> 00:20:14,640
that's why we need something more

514
00:20:14,640 --> 00:20:17,440
advanced to feed the data supervise the

515
00:20:17,440 --> 00:20:19,600
data and then for example like the

516
00:20:19,600 --> 00:20:21,280
decision tree

517
00:20:21,280 --> 00:20:23,840
to categorize the different type of the

518
00:20:23,840 --> 00:20:26,559
periodicity of the behaviors i have

519
00:20:26,559 --> 00:20:30,240
published two paper to detect the http

520
00:20:30,240 --> 00:20:32,240
botnets in the computer and in the

521
00:20:32,240 --> 00:20:33,679
mobile environment and one of the

522
00:20:33,679 --> 00:20:36,080
factors is a periodicity level if you

523
00:20:36,080 --> 00:20:38,000
are interested feel free to contact me

524
00:20:38,000 --> 00:20:40,159
and i would be more than happy to share

525
00:20:40,159 --> 00:20:43,200
those information with you so our short

526
00:20:43,200 --> 00:20:46,559
talk ends here but the threat hunting is

527
00:20:46,559 --> 00:20:47,840
a never

528
00:20:47,840 --> 00:20:50,240
battle discover the unknowns be

529
00:20:50,240 --> 00:20:53,600
proactive dive into the beats and hunts

530
00:20:53,600 --> 00:20:56,760
the beasts

