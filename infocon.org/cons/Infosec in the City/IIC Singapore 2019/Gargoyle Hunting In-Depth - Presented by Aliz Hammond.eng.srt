1
00:00:00,000 --> 00:00:01,800
hello everyone I'm just felt with it

2
00:00:01,800 --> 00:00:04,019
start my talk I've just filled my belly

3
00:00:04,019 --> 00:00:06,870
full of food at the at the lunch which

4
00:00:06,870 --> 00:00:08,970
has got me they got me sup ready to talk

5
00:00:08,970 --> 00:00:10,440
I've decided this is definitely the best

6
00:00:10,440 --> 00:00:12,509
time to do a presentation just after

7
00:00:12,509 --> 00:00:14,969
lunch yeah I do it in the morning I'm

8
00:00:14,969 --> 00:00:16,949
like too hungry for do it in the evening

9
00:00:16,949 --> 00:00:18,900
too hungry I want to go home and you

10
00:00:18,900 --> 00:00:21,900
know hack stuff so yeah anyway I digress

11
00:00:21,900 --> 00:00:24,470
I'm coming today I'm going to talk about

12
00:00:24,470 --> 00:00:26,939
this particular code hiding method

13
00:00:26,939 --> 00:00:29,670
called gargoyle which is a kind of a

14
00:00:29,670 --> 00:00:32,250
makes an interesting case study in terms

15
00:00:32,250 --> 00:00:33,989
of it's a very cute way of hiding code

16
00:00:33,989 --> 00:00:36,750
and then talk about how we detect it I'm

17
00:00:36,750 --> 00:00:38,820
gonna go kind of technical but not super

18
00:00:38,820 --> 00:00:41,640
duper duper technical I want that's

19
00:00:41,640 --> 00:00:43,170
because I want to talk about the attack

20
00:00:43,170 --> 00:00:45,030
itself I want talk about detection I

21
00:00:45,030 --> 00:00:46,680
want to talk about the practicalities of

22
00:00:46,680 --> 00:00:47,850
detection

23
00:00:47,850 --> 00:00:50,420
I say it's scale you know on earth

24
00:00:50,420 --> 00:00:53,850
across a large client base as opposed to

25
00:00:53,850 --> 00:00:56,670
being able to say like did the leap from

26
00:00:56,670 --> 00:00:58,770
going on Twitter and say and reading a

27
00:00:58,770 --> 00:01:00,660
tweet of some guy saying oh you should

28
00:01:00,660 --> 00:01:01,920
run this command to see if you've got

29
00:01:01,920 --> 00:01:04,650
the latest apt and then delete from

30
00:01:04,650 --> 00:01:06,299
there to go into having something you

31
00:01:06,299 --> 00:01:07,860
can deploy to the like tens of thousands

32
00:01:07,860 --> 00:01:09,330
of people and not like blow up your

33
00:01:09,330 --> 00:01:11,820
network let's talk about that a bit so

34
00:01:11,820 --> 00:01:12,689
because that it's not gonna be

35
00:01:12,689 --> 00:01:14,490
SuperDuper technical bit I don't know

36
00:01:14,490 --> 00:01:16,439
just I've interests

37
00:01:16,439 --> 00:01:18,900
how many people here have have used

38
00:01:18,900 --> 00:01:23,340
windy bug before the windows debugger ok

39
00:01:23,340 --> 00:01:27,090
ok ok that that's ok ok ok

40
00:01:27,090 --> 00:01:28,560
that's anyone doesn't kernel debugging

41
00:01:28,560 --> 00:01:30,509
with it before Oh

42
00:01:30,509 --> 00:01:33,659
one person ok ok that's cool so hmm

43
00:01:33,659 --> 00:01:35,130
if there are any hard questions I can't

44
00:01:35,130 --> 00:01:36,750
answer after the talk I'll direct them

45
00:01:36,750 --> 00:01:40,140
at the one person who's done anyway I

46
00:01:40,140 --> 00:01:42,990
digress so with that said let's get

47
00:01:42,990 --> 00:01:45,840
started on the slides there it's a big

48
00:01:45,840 --> 00:01:47,909
gargoyle did these slides this is the

49
00:01:47,909 --> 00:01:50,460
same slide deck I used for an event that

50
00:01:50,460 --> 00:01:52,680
we used endo you are the guys I work for

51
00:01:52,680 --> 00:01:55,290
and it's so it's a little bit corporate

52
00:01:55,290 --> 00:01:57,270
so anything that could possibly reflect

53
00:01:57,270 --> 00:01:59,130
badly upon the company has been taken

54
00:01:59,130 --> 00:02:01,350
out but I'll try to put it back in as we

55
00:02:01,350 --> 00:02:03,270
speak because my boss is apologized

56
00:02:03,270 --> 00:02:04,950
because we can't be here today she's got

57
00:02:04,950 --> 00:02:06,750
to do some meeting so I can sneak it

58
00:02:06,750 --> 00:02:07,950
back in without him noticing

59
00:02:07,950 --> 00:02:10,348
anyway quick agenda I'm gonna talk about

60
00:02:10,348 --> 00:02:12,470
me because

61
00:02:12,470 --> 00:02:15,020
fantastic it's all about gargoyle what

62
00:02:15,020 --> 00:02:16,250
the attack is whether you should be

63
00:02:16,250 --> 00:02:18,560
worried about it quick spoiler it's not

64
00:02:18,560 --> 00:02:21,260
like it's not like or the big scary apt

65
00:02:21,260 --> 00:02:22,580
everyone needs to go home and practice

66
00:02:22,580 --> 00:02:24,650
immediately it's just an interesting

67
00:02:24,650 --> 00:02:26,990
case study all right so a mission

68
00:02:26,990 --> 00:02:29,330
statement and give what what what we're

69
00:02:29,330 --> 00:02:32,090
trying to do in our research work and so

70
00:02:32,090 --> 00:02:34,190
how would you Tex it how we automate

71
00:02:34,190 --> 00:02:36,170
this detection in a kind of safe and

72
00:02:36,170 --> 00:02:37,100
reliable way

73
00:02:37,100 --> 00:02:39,230
so not automating too much not

74
00:02:39,230 --> 00:02:41,570
automating too little and I'll talk

75
00:02:41,570 --> 00:02:43,360
about how we QA that-that-that-that

76
00:02:43,360 --> 00:02:45,860
detection method it's as I alluded to

77
00:02:45,860 --> 00:02:48,590
earlier that delete from going from this

78
00:02:48,590 --> 00:02:50,750
works on my machine this works on lots

79
00:02:50,750 --> 00:02:52,010
and lots of machines and no one's

80
00:02:52,010 --> 00:02:53,720
complained since I deployed it for the

81
00:02:53,720 --> 00:02:55,700
last half an hour so finish up with some

82
00:02:55,700 --> 00:02:58,760
general observations because yeah so

83
00:02:58,760 --> 00:03:02,660
first off about me I think I think quite

84
00:03:02,660 --> 00:03:03,709
a few people in this room know me

85
00:03:03,709 --> 00:03:06,380
already but if you don't this is me I'm

86
00:03:06,380 --> 00:03:09,650
Alice Hammond I'm all the way from

87
00:03:09,650 --> 00:03:12,410
England I am based in Singapore I am

88
00:03:12,410 --> 00:03:13,520
based in Singapore I've been in

89
00:03:13,520 --> 00:03:15,110
Singapore for about three years and I'm

90
00:03:15,110 --> 00:03:17,660
very slowly picking up the the whole

91
00:03:17,660 --> 00:03:18,620
Singlish thing

92
00:03:18,620 --> 00:03:22,190
very slowly funny very difficult just

93
00:03:22,190 --> 00:03:23,840
about getting there still can't eat

94
00:03:23,840 --> 00:03:26,150
Dorian's by no not say come on the MRT

95
00:03:26,150 --> 00:03:28,370
so yeah after England this is in case

96
00:03:28,370 --> 00:03:29,450
you're wondering what the state of

97
00:03:29,450 --> 00:03:32,360
British politics is this this chap here

98
00:03:32,360 --> 00:03:36,380
who's whose body I used he's looking

99
00:03:36,380 --> 00:03:37,940
like he's going to be in charge of the

100
00:03:37,940 --> 00:03:39,950
United Kingdom for the next few years in

101
00:03:39,950 --> 00:03:41,600
case you wondered what British politics

102
00:03:41,600 --> 00:03:45,890
is like anyway getting off that before I

103
00:03:45,890 --> 00:03:48,140
go into a bit of a rant I have a

104
00:03:48,140 --> 00:03:50,510
background in bug finding explanation I

105
00:03:50,510 --> 00:03:52,580
spent some time doing lots of fuzzing

106
00:03:52,580 --> 00:03:54,830
fuzzing is really fun finding bugs

107
00:03:54,830 --> 00:03:58,340
exploiting them trying to exploit them

108
00:03:58,340 --> 00:04:00,440
finding them so yeah

109
00:04:00,440 --> 00:04:02,330
that's my kind of background I did a lot

110
00:04:02,330 --> 00:04:04,190
of research like at my previous job with

111
00:04:04,190 --> 00:04:07,910
that I kind of I had a thought last

112
00:04:07,910 --> 00:04:09,650
night about old computer stuff my

113
00:04:09,650 --> 00:04:12,920
hobbies involve electronics all computer

114
00:04:12,920 --> 00:04:13,850
is that kind of thing

115
00:04:13,850 --> 00:04:15,620
but because of that I have this this

116
00:04:15,620 --> 00:04:18,769
kind of bottom-up mindset when it comes

117
00:04:18,769 --> 00:04:22,220
to to analyzing systems so instead of

118
00:04:22,220 --> 00:04:24,050
like looking at things like Oh start at

119
00:04:24,050 --> 00:04:25,640
the top of the stack you've got your web

120
00:04:25,640 --> 00:04:26,330
browser

121
00:04:26,330 --> 00:04:27,979
jealous curb you've got something else I

122
00:04:27,979 --> 00:04:29,629
like going up from the bottom and saying

123
00:04:29,629 --> 00:04:31,370
oh yeah there's a bio sand built on eyes

124
00:04:31,370 --> 00:04:33,650
this and it's a mindset that kind of

125
00:04:33,650 --> 00:04:36,050
lends quite quite well into looking at

126
00:04:36,050 --> 00:04:40,180
kernel stuff and that kind of thing I

127
00:04:40,180 --> 00:04:43,129
work at counter set down state leaders

128
00:04:43,129 --> 00:04:44,930
use our corporate logo a look at counter

129
00:04:44,930 --> 00:04:49,190
set which is part of MWR which is

130
00:04:49,190 --> 00:04:51,650
recently acquired by f-secure so the

131
00:04:51,650 --> 00:04:53,330
branding is a bit about a bit weird but

132
00:04:53,330 --> 00:04:56,150
yes I work there I'm a researcher

133
00:04:56,150 --> 00:04:58,340
spoiling for hunters so I'm not I'm not

134
00:04:58,340 --> 00:05:01,729
fit onto myself so my knowledge of light

135
00:05:01,729 --> 00:05:04,879
light like my knowledge of some of the

136
00:05:04,879 --> 00:05:07,370
threatening stuff is a bit rusty but I

137
00:05:07,370 --> 00:05:09,860
support the threat hundreds directly so

138
00:05:09,860 --> 00:05:13,909
all of our researches so most places

139
00:05:13,909 --> 00:05:15,940
that do that hunting your your-your-your

140
00:05:15,940 --> 00:05:18,319
theranos will do a bit of research as

141
00:05:18,319 --> 00:05:21,199
well usually when they've researched

142
00:05:21,199 --> 00:05:22,699
something and they get to a point and

143
00:05:22,699 --> 00:05:23,990
they're like oh no I've got to get and

144
00:05:23,990 --> 00:05:25,430
go and hunt some flips now and do some

145
00:05:25,430 --> 00:05:27,319
actual work then I can swoop in a bit

146
00:05:27,319 --> 00:05:28,699
like oh I'll take that fun research

147
00:05:28,699 --> 00:05:30,409
project off your hands and play with it

148
00:05:30,409 --> 00:05:33,680
while you're actually defending my job

149
00:05:33,680 --> 00:05:35,060
is really fun because I just basically

150
00:05:35,060 --> 00:05:36,830
play about a windy bulb all day while

151
00:05:36,830 --> 00:05:38,060
everyone else does all the hard work

152
00:05:38,060 --> 00:05:42,020
it's great anyway I do all day yeah

153
00:05:42,020 --> 00:05:44,150
sorry I just miss other I also do the

154
00:05:44,150 --> 00:05:47,419
whole generating hypotheses and

155
00:05:47,419 --> 00:05:50,150
anticipating attacks so I I try to keep

156
00:05:50,150 --> 00:05:51,919
up to date with what's going on I look

157
00:05:51,919 --> 00:05:54,139
at like new attacks oh my god this new

158
00:05:54,139 --> 00:05:55,550
attack looks cool how are we going to

159
00:05:55,550 --> 00:05:58,069
detect it is there a kind of easy good

160
00:05:58,069 --> 00:06:01,849
way of doing this kind of thing so let's

161
00:06:01,849 --> 00:06:04,039
start off what is gargoyle

162
00:06:04,039 --> 00:06:08,539
so gargoyle is well so it's probably

163
00:06:08,539 --> 00:06:11,120
explain what gargoyle is I'm gonna give

164
00:06:11,120 --> 00:06:12,650
you some I say give you some historical

165
00:06:12,650 --> 00:06:14,779
perspective but I guess everyone already

166
00:06:14,779 --> 00:06:16,909
knows this but to put things in a

167
00:06:16,909 --> 00:06:20,029
historical light maybe is the better way

168
00:06:20,029 --> 00:06:21,889
of putting it so every members back in

169
00:06:21,889 --> 00:06:24,620
the kind of 2,000 Z era when you're

170
00:06:24,620 --> 00:06:26,180
malware would be will be saying on disk

171
00:06:26,180 --> 00:06:27,379
you'd have an X cubed

172
00:06:27,379 --> 00:06:29,240
that you download and you'd run it and

173
00:06:29,240 --> 00:06:30,289
it would do horrible things your

174
00:06:30,289 --> 00:06:33,370
computer so that was kind of generally

175
00:06:33,370 --> 00:06:37,009
general generally defended against by

176
00:06:37,009 --> 00:06:38,040
having an anti

177
00:06:38,040 --> 00:06:40,110
could periodically come and scan all the

178
00:06:40,110 --> 00:06:42,510
programs on your disk and it would be

179
00:06:42,510 --> 00:06:43,890
you like it would run on the schedule

180
00:06:43,890 --> 00:06:45,450
and a man and it would light up your

181
00:06:45,450 --> 00:06:46,800
hard disk and your computer would slow

182
00:06:46,800 --> 00:06:48,360
down for thereby go No

183
00:06:48,360 --> 00:06:50,270
so one of the ways that this was sped up

184
00:06:50,270 --> 00:06:55,980
is that only only files with the

185
00:06:55,980 --> 00:06:58,140
appropriate file type were scanned for

186
00:06:58,140 --> 00:07:00,180
upload via malware so if you're looking

187
00:07:00,180 --> 00:07:02,070
for macro virus there's no point looking

188
00:07:02,070 --> 00:07:05,190
through like Exe files and if you've got

189
00:07:05,190 --> 00:07:07,170
like a hundred megabyte mp4 file there's

190
00:07:07,170 --> 00:07:09,060
no point trying to pass in CR as a PE

191
00:07:09,060 --> 00:07:11,580
header so this is this is one thing that

192
00:07:11,580 --> 00:07:13,560
was done I know this sounds like a very

193
00:07:13,560 --> 00:07:16,170
incidental thing being you'll see why in

194
00:07:16,170 --> 00:07:18,630
a minute I'm like after that we moved up

195
00:07:18,630 --> 00:07:23,100
to sure you said that oh yes there's my

196
00:07:23,100 --> 00:07:25,320
fantastic picture that's what's so it

197
00:07:25,320 --> 00:07:29,360
it's my fantastic picture this is I

198
00:07:29,510 --> 00:07:32,520
think this is a blaster worm I may be

199
00:07:32,520 --> 00:07:34,050
forgetting you can see it you can see

200
00:07:34,050 --> 00:07:35,340
it's aged because it has the the

201
00:07:35,340 --> 00:07:38,370
reference to mr. Bill Gates after that

202
00:07:38,370 --> 00:07:41,250
kind of 2010 ish other kind of value

203
00:07:41,250 --> 00:07:43,320
vague timelines people started moving to

204
00:07:43,320 --> 00:07:45,600
having their malware in memory your

205
00:07:45,600 --> 00:07:48,600
malware would would break into your

206
00:07:48,600 --> 00:07:50,460
system it wouldn't hit the disk you'd

207
00:07:50,460 --> 00:07:52,710
avoid your your disk base antivirus cos

208
00:07:52,710 --> 00:07:54,510
it would just sit in memory it would

209
00:07:54,510 --> 00:07:56,970
allocate some memory virtual work make

210
00:07:56,970 --> 00:07:59,100
it executable stick the badness in there

211
00:07:59,100 --> 00:08:02,670
so because of that we have or modern EDR

212
00:08:02,670 --> 00:08:05,990
systems have a periodic kind of similar

213
00:08:05,990 --> 00:08:08,850
periodic scanning of memory pages so you

214
00:08:08,850 --> 00:08:10,650
have all your zillions of gigabytes of

215
00:08:10,650 --> 00:08:12,150
memory on your system it'll go through

216
00:08:12,150 --> 00:08:14,640
and look for look for things that are

217
00:08:14,640 --> 00:08:17,640
probably bad or unknown code things but

218
00:08:17,640 --> 00:08:20,010
similarly it's a necessity when you're

219
00:08:20,010 --> 00:08:21,780
doing this to filter what you're

220
00:08:21,780 --> 00:08:23,780
standing based on the memory permissions

221
00:08:23,780 --> 00:08:26,310
so in the same way that we used to look

222
00:08:26,310 --> 00:08:28,650
at file extensions we now look at memory

223
00:08:28,650 --> 00:08:30,750
permissions in that if you have an area

224
00:08:30,750 --> 00:08:33,450
of memory which is executable then you

225
00:08:33,450 --> 00:08:34,799
should look at it for exit of a code

226
00:08:34,799 --> 00:08:37,289
but if you have like a hundred megabytes

227
00:08:37,289 --> 00:08:38,940
of memory that's read-only

228
00:08:38,940 --> 00:08:41,039
I'm not executable there's no point

229
00:08:41,039 --> 00:08:42,510
scanning it to see if there's Mel well

230
00:08:42,510 --> 00:08:46,710
in it right and this is this is not just

231
00:08:46,710 --> 00:08:48,150
like an optimization to speed things up

232
00:08:48,150 --> 00:08:50,100
this is like a necessary optimization if

233
00:08:50,100 --> 00:08:50,570
you don't

234
00:08:50,570 --> 00:08:52,480
do these things get pretty much unusable

235
00:08:52,480 --> 00:08:57,770
in my experience so it's kind of hard to

236
00:08:57,770 --> 00:08:59,240
show you an example of this but this is

237
00:08:59,240 --> 00:09:01,490
this is a Pokemon output I said oh we've

238
00:09:01,490 --> 00:09:03,440
got some memory here it's execute its

239
00:09:03,440 --> 00:09:05,480
read writable there could be something

240
00:09:05,480 --> 00:09:07,400
there which is we should like our loss

241
00:09:07,400 --> 00:09:09,650
no it's going to take a look and go God

242
00:09:09,650 --> 00:09:12,080
itself is a way of placing it your

243
00:09:12,080 --> 00:09:13,850
malware into non-executable areas of

244
00:09:13,850 --> 00:09:17,180
memory which is kind of tricky because

245
00:09:17,180 --> 00:09:18,470
obviously the memory protection is

246
00:09:18,470 --> 00:09:20,180
enforced by the CPU when you can't just

247
00:09:20,180 --> 00:09:22,250
be like oh it is executable really you

248
00:09:22,250 --> 00:09:25,090
know the CPU knows what's going on the

249
00:09:25,090 --> 00:09:28,450
it's not my attack this attack was

250
00:09:28,450 --> 00:09:31,430
feature of guys I've got the chaps name

251
00:09:31,430 --> 00:09:33,080
a link to the guys get her button on on

252
00:09:33,080 --> 00:09:36,320
a slide very soon but the chap who made

253
00:09:36,320 --> 00:09:39,230
it released the the POC in March 2017

254
00:09:39,230 --> 00:09:42,020
and there were when I started the

255
00:09:42,020 --> 00:09:43,670
research there was no way of detecting

256
00:09:43,670 --> 00:09:46,460
this available which is kind of

257
00:09:46,460 --> 00:09:49,250
interesting because it's it's it's it's

258
00:09:49,250 --> 00:09:51,500
gone for a fairly long time without

259
00:09:51,500 --> 00:09:53,990
without detection we haven't seen it in

260
00:09:53,990 --> 00:09:55,550
the wild just quick spoiler for that

261
00:09:55,550 --> 00:09:57,260
this is always the first question I get

262
00:09:57,260 --> 00:09:58,640
after I give this talk is I'll have you

263
00:09:58,640 --> 00:09:59,780
seen the stack in the wild may have to

264
00:09:59,780 --> 00:10:01,130
sing no when everyone's like there's a

265
00:10:01,130 --> 00:10:02,900
collective sigh of disappointment from

266
00:10:02,900 --> 00:10:05,320
everyone in the cloud when I say that

267
00:10:05,320 --> 00:10:08,120
this is the same screen shot with just

268
00:10:08,120 --> 00:10:09,350
illustrating that there's no actual

269
00:10:09,350 --> 00:10:12,050
memory stuff's readable writable not

270
00:10:12,050 --> 00:10:15,380
executable I hope I do have a link to

271
00:10:15,380 --> 00:10:16,910
this guy's github in the next slides if

272
00:10:16,910 --> 00:10:18,440
not I'm gonna have to like try to

273
00:10:18,440 --> 00:10:21,320
remember it from my memory the other

274
00:10:21,320 --> 00:10:22,940
thing I say we haven't seen in the wild

275
00:10:22,940 --> 00:10:26,570
and is true but one of the things that

276
00:10:26,570 --> 00:10:28,130
we really focus on MWR I'm sorry could

277
00:10:28,130 --> 00:10:31,010
be a little bit corporal when I the last

278
00:10:31,010 --> 00:10:32,510
time I gave this speech was like to

279
00:10:32,510 --> 00:10:34,340
clients so I have all that the kind of

280
00:10:34,340 --> 00:10:36,320
very corporate stuff memorized so if I

281
00:10:36,320 --> 00:10:38,090
slip into it just just like shout at me

282
00:10:38,090 --> 00:10:39,680
or something or heckle me to be to be

283
00:10:39,680 --> 00:10:42,590
less corporate but one of the one of the

284
00:10:42,590 --> 00:10:44,030
things we're big on is that whole cycle

285
00:10:44,030 --> 00:10:46,250
of offensive and defensive and we have

286
00:10:46,250 --> 00:10:47,840
our red teaming our researchers and we

287
00:10:47,840 --> 00:10:49,760
work we work quite closely together you

288
00:10:49,760 --> 00:10:51,530
know we it's it's very my it's not like

289
00:10:51,530 --> 00:10:53,390
you know researcher comes up with

290
00:10:53,390 --> 00:10:55,310
something keeps it secret until the blue

291
00:10:55,310 --> 00:10:57,260
team finds out and then I read it it's

292
00:10:57,260 --> 00:10:58,940
very much like we really push the hold

293
00:10:58,940 --> 00:10:59,990
in place you show everything

294
00:10:59,990 --> 00:11:03,399
and one of our guys back in July 2018

295
00:11:03,399 --> 00:11:05,870
wrote this blog post about how to modify

296
00:11:05,870 --> 00:11:08,600
a cobalt cobalt strike beacon to use

297
00:11:08,600 --> 00:11:10,640
gargoyle so we were using it for a while

298
00:11:10,640 --> 00:11:11,959
I don't know if we still are using it

299
00:11:11,959 --> 00:11:13,490
but we definitely used it for a while so

300
00:11:13,490 --> 00:11:15,500
I say we haven't seen it in the wild you

301
00:11:15,500 --> 00:11:19,420
know except us because we're awesome I

302
00:11:19,420 --> 00:11:21,230
don't need to say that my boss isn't

303
00:11:21,230 --> 00:11:24,230
well as I say my boss isn't various

304
00:11:24,230 --> 00:11:25,640
people who were above me in the chain

305
00:11:25,640 --> 00:11:26,750
are in the crowd so I should probably

306
00:11:26,750 --> 00:11:27,880
say something like that

307
00:11:27,880 --> 00:11:36,170
anyway as I say it's they're the kind of

308
00:11:36,170 --> 00:11:37,730
summary of it so you keep your code in

309
00:11:37,730 --> 00:11:40,790
non-taxable sections of memory but X

310
00:11:40,790 --> 00:11:43,160
equal but page permissions on x86 y'all

311
00:11:43,160 --> 00:11:45,800
enforced by the the the CPU itself you

312
00:11:45,800 --> 00:11:47,300
can't really like blog your way into it

313
00:11:47,300 --> 00:11:48,830
you can't lie to the CPU and knows

314
00:11:48,830 --> 00:11:52,310
what's going on so it's quite tricky to

315
00:11:52,310 --> 00:11:54,290
to to do this and now that's why I

316
00:11:54,290 --> 00:11:58,310
really like this attack it hides all

317
00:11:58,310 --> 00:12:00,170
this malicious code in not actual memory

318
00:12:00,170 --> 00:12:02,089
and this is this is something that like

319
00:12:02,089 --> 00:12:08,120
like yeah yeah anyway yeah it hides all

320
00:12:08,120 --> 00:12:10,339
its code in a non heme and it's very

321
00:12:10,339 --> 00:12:12,860
briefly made executable and I say very

322
00:12:12,860 --> 00:12:15,170
briefly there was a POC online that the

323
00:12:15,170 --> 00:12:17,930
chap who made the attack pushed up and

324
00:12:17,930 --> 00:12:20,660
it will sit dormant on your system and

325
00:12:20,660 --> 00:12:22,670
then pop a message box every 30 seconds

326
00:12:22,670 --> 00:12:24,470
or something so you can bite your your

327
00:12:24,470 --> 00:12:26,570
malware that will sit dormant for like

328
00:12:26,570 --> 00:12:29,120
tens of seconds minutes hours or

329
00:12:29,120 --> 00:12:30,800
whatever and then wake up for 10

330
00:12:30,800 --> 00:12:33,050
milliseconds and do some CNC and some

331
00:12:33,050 --> 00:12:36,440
bad stuff and then go back to sleep so

332
00:12:36,440 --> 00:12:38,450
unless your EDR kicks in exactly the

333
00:12:38,450 --> 00:12:39,670
right time you're not going to find

334
00:12:39,670 --> 00:12:42,470
you're not gonna find a code in an

335
00:12:42,470 --> 00:12:45,410
executable state so you might be

336
00:12:45,410 --> 00:12:47,060
thinking about at this point that this

337
00:12:47,060 --> 00:12:49,220
is this is like textbook stuff right you

338
00:12:49,220 --> 00:12:50,810
have a you have a little stub of code

339
00:12:50,810 --> 00:12:54,350
that makes your main code executable and

340
00:12:54,350 --> 00:12:57,140
then runs it and but one of the great

341
00:12:57,140 --> 00:12:59,450
things about gargoyle oh wow so yeah I

342
00:12:59,450 --> 00:13:01,940
forgot I had migrated gif in here I'm

343
00:13:01,940 --> 00:13:03,860
sorry I said it's a little bit jumbled

344
00:13:03,860 --> 00:13:05,000
and so this is one of the problems of

345
00:13:05,000 --> 00:13:06,410
doing the talk straight after lunch is I

346
00:13:06,410 --> 00:13:09,140
also had a red ball just before lunch

347
00:13:09,140 --> 00:13:11,370
anyway this is my fantastic gift that I

348
00:13:11,370 --> 00:13:13,410
found to illustrate that the code is

349
00:13:13,410 --> 00:13:17,810
mainly in a stone about the inanimate

350
00:13:17,810 --> 00:13:20,100
state and then maybe soften it wakes up

351
00:13:20,100 --> 00:13:21,930
so here we have in this allegory we have

352
00:13:21,930 --> 00:13:24,060
like a client system here that we're

353
00:13:24,060 --> 00:13:25,650
analyzing and we have these two threat

354
00:13:25,650 --> 00:13:27,930
hunters who are pretty convinced that

355
00:13:27,930 --> 00:13:30,360
there's nothing malicious going on on

356
00:13:30,360 --> 00:13:32,940
this system so convinced that they take

357
00:13:32,940 --> 00:13:35,100
a selfie with the system which in case

358
00:13:35,100 --> 00:13:36,390
you're wondering our engineers very

359
00:13:36,390 --> 00:13:37,950
rarely take selfies with our client

360
00:13:37,950 --> 00:13:41,730
system but unbeknownst to them it

361
00:13:41,730 --> 00:13:43,890
becomes magically animated and surprises

362
00:13:43,890 --> 00:13:45,990
the living the daylights out of them and

363
00:13:45,990 --> 00:13:48,660
I love this gif and I put it in talk

364
00:13:48,660 --> 00:13:50,370
just because I can't get enough of

365
00:13:50,370 --> 00:13:53,430
looking this guy's reaction it's

366
00:13:53,430 --> 00:13:55,800
fantastic and I love it these I don't

367
00:13:55,800 --> 00:13:56,910
know if we've ever seen anyone doing

368
00:13:56,910 --> 00:13:58,230
this they're like performance artists

369
00:13:58,230 --> 00:14:00,030
and they'll go and they'll dress up all

370
00:14:00,030 --> 00:14:01,260
nicely like that and they'll stand on

371
00:14:01,260 --> 00:14:02,940
the streets like literally like half an

372
00:14:02,940 --> 00:14:04,770
hour or so and then when someone comes

373
00:14:04,770 --> 00:14:06,440
up and stands next time they're like mmm

374
00:14:06,440 --> 00:14:09,750
I have seen them in the street I have

375
00:14:09,750 --> 00:14:11,970
not actually been been scared by one

376
00:14:11,970 --> 00:14:13,560
which is probably why I can watch this

377
00:14:13,560 --> 00:14:15,270
without any kind of like a swarm about

378
00:14:15,270 --> 00:14:19,670
horrific flashbacks or something anyway

379
00:14:19,670 --> 00:14:21,750
the point I was I was going to make

380
00:14:21,750 --> 00:14:24,300
before my my my awesome animation came

381
00:14:24,300 --> 00:14:27,240
up is that while the codes dormant there

382
00:14:27,240 --> 00:14:30,420
is no executable code on the system so

383
00:14:30,420 --> 00:14:32,040
there isn't a little stub that D

384
00:14:32,040 --> 00:14:34,250
protects the main code and jumps to it

385
00:14:34,250 --> 00:14:37,500
there isn't anything executable at all

386
00:14:37,500 --> 00:14:40,050
everything is nanak seeable which is one

387
00:14:40,050 --> 00:14:41,730
of the reasons this attacks so cool it

388
00:14:41,730 --> 00:14:45,260
is totally dormant it does it uses

389
00:14:45,260 --> 00:14:47,640
system facilities to wake itself up

390
00:14:47,640 --> 00:14:51,180
periodically and the system that the

391
00:14:51,180 --> 00:14:54,090
kind of resources uses is a system timer

392
00:14:54,090 --> 00:14:57,150
which is a something provided by the

393
00:14:57,150 --> 00:14:58,980
Windows kernel it's a timer

394
00:14:58,980 --> 00:15:01,080
every so often you can you give a time

395
00:15:01,080 --> 00:15:02,790
you say all in three seconds call this

396
00:15:02,790 --> 00:15:08,100
function but this function did but but

397
00:15:08,100 --> 00:15:09,540
the thought the problem here is that

398
00:15:09,540 --> 00:15:11,490
you're you're the code you're trying to

399
00:15:11,490 --> 00:15:13,980
invoke isn't invoke isn't in execute or

400
00:15:13,980 --> 00:15:16,380
memory its sat in non-acute your memory

401
00:15:16,380 --> 00:15:18,390
and it's inanimate you can't just jump

402
00:15:18,390 --> 00:15:20,910
to it so to get around that you use the

403
00:15:20,910 --> 00:15:22,380
same resource that the

404
00:15:22,380 --> 00:15:24,330
exploit writers have been using for many

405
00:15:24,330 --> 00:15:26,430
years which is you know that the WAP

406
00:15:26,430 --> 00:15:29,460
style stack pivot so this is used to

407
00:15:29,460 --> 00:15:32,010
make up for the lack of a stub to D

408
00:15:32,010 --> 00:15:34,710
Pertex or two to make the main codec

409
00:15:34,710 --> 00:15:36,960
suitable to every every few seconds your

410
00:15:36,960 --> 00:15:39,840
timer fires that points our stack pivot

411
00:15:39,840 --> 00:15:42,690
bits in illegitimate dll so like ms HTML

412
00:15:42,690 --> 00:15:45,720
or whatever that jumps to like a rope

413
00:15:45,720 --> 00:15:47,940
chain called virtual protect makes your

414
00:15:47,940 --> 00:15:50,160
main malware executable invokes your

415
00:15:50,160 --> 00:15:52,170
main malware and then turns your

416
00:15:52,170 --> 00:15:54,750
gargoyle but gargoyle back to stone by

417
00:15:54,750 --> 00:15:58,200
setting it back to read/write again so

418
00:15:58,200 --> 00:16:01,020
it's it's a really cute attack in the

419
00:16:01,020 --> 00:16:03,600
day there's no there's no executable

420
00:16:03,600 --> 00:16:05,310
code as I think I've said about five

421
00:16:05,310 --> 00:16:07,920
times and last minute now but it's it's

422
00:16:07,920 --> 00:16:11,280
also very cool I guess for reasons that

423
00:16:11,280 --> 00:16:12,750
we'll go into a minute and it's actually

424
00:16:12,750 --> 00:16:15,240
very hard to detect from from user mode

425
00:16:15,240 --> 00:16:17,490
or from the kernel it isn't easy wasn't

426
00:16:17,490 --> 00:16:20,250
easy for me there yeah the other thing

427
00:16:20,250 --> 00:16:21,900
of course is that while it is it like

428
00:16:21,900 --> 00:16:24,840
you do end up with a rope chain and this

429
00:16:24,840 --> 00:16:26,430
stack pivot but because you're you're

430
00:16:26,430 --> 00:16:28,410
not you're not letting an exploit you're

431
00:16:28,410 --> 00:16:29,850
not breaking at the system you already

432
00:16:29,850 --> 00:16:31,710
have code execution so you don't need to

433
00:16:31,710 --> 00:16:33,210
bother like working out offsets right

434
00:16:33,210 --> 00:16:35,070
you can just open the DLL file and find

435
00:16:35,070 --> 00:16:36,390
the gadget you need and just use it

436
00:16:36,390 --> 00:16:37,680
which is great and that's why if you

437
00:16:37,680 --> 00:16:40,500
check out the the POC on the guy's

438
00:16:40,500 --> 00:16:42,570
github which I'm really hoping as one of

439
00:16:42,570 --> 00:16:44,610
the in one of these slides soon if you

440
00:16:44,610 --> 00:16:47,250
check out the POC it just works you know

441
00:16:47,250 --> 00:16:49,140
it's a I don't say it's a bit of a

442
00:16:49,140 --> 00:16:51,750
rarity in these pocs but it does just

443
00:16:51,750 --> 00:16:55,590
work so having talked about gargoyle

444
00:16:55,590 --> 00:16:57,740
possibly for longer than I intended to

445
00:16:57,740 --> 00:17:02,430
check in 15 okay it's all good I can all

446
00:17:02,430 --> 00:17:04,530
fit it in don't worry having talked

447
00:17:04,530 --> 00:17:05,939
about gargoyle and explained what it is

448
00:17:05,939 --> 00:17:08,520
and why it's why it's quite cool I'm

449
00:17:08,520 --> 00:17:09,660
gonna go up with a quick mission

450
00:17:09,660 --> 00:17:12,630
statement as I say that slight ik is a

451
00:17:12,630 --> 00:17:14,970
teensy bit corporate went to all the

452
00:17:14,970 --> 00:17:16,740
clients but the old set mission

453
00:17:16,740 --> 00:17:18,869
statement is is fairly simple and pretty

454
00:17:18,869 --> 00:17:20,490
easy to predict you know we want to be

455
00:17:20,490 --> 00:17:22,650
able to take this thing in real time we

456
00:17:22,650 --> 00:17:24,480
want to have an agent running on

457
00:17:24,480 --> 00:17:26,430
people's computers we want to limit or

458
00:17:26,430 --> 00:17:27,569
you want a lot of pop up saying oh

459
00:17:27,569 --> 00:17:29,070
there's some badness going on here go

460
00:17:29,070 --> 00:17:31,470
and investigate it turns out this is

461
00:17:31,470 --> 00:17:34,080
this it this is like really difficult so

462
00:17:34,080 --> 00:17:35,970
I took on this piece of research

463
00:17:35,970 --> 00:17:40,049
like just as I said MWR sorry and I was

464
00:17:40,049 --> 00:17:41,400
like okay let's do this this is gonna be

465
00:17:41,400 --> 00:17:43,740
great and this is a really quite

466
00:17:43,740 --> 00:17:45,210
difficult thing to do so I kind of split

467
00:17:45,210 --> 00:17:48,630
this into two portions it's kind of

468
00:17:48,630 --> 00:17:50,010
splits into two portions with the hope

469
00:17:50,010 --> 00:17:51,480
of you know actually achieving something

470
00:17:51,480 --> 00:17:54,030
that I could hold minimum viable product

471
00:17:54,030 --> 00:17:55,650
thing that I'm usually really bad at

472
00:17:55,650 --> 00:17:57,210
because I start a project and then keep

473
00:17:57,210 --> 00:17:59,340
adding to it as time goes on but the

474
00:17:59,340 --> 00:18:00,960
first stage the kind of easy mode of

475
00:18:00,960 --> 00:18:03,450
that of it is to equip our fit hunters

476
00:18:03,450 --> 00:18:05,220
the people I'm supporting my whole job

477
00:18:05,220 --> 00:18:06,659
is to make the fit hunters life easier

478
00:18:06,659 --> 00:18:13,260
which yeah well the whole point is that

479
00:18:13,260 --> 00:18:15,179
we can equip them to detect this during

480
00:18:15,179 --> 00:18:17,549
an offline IR job and when I say an

481
00:18:17,549 --> 00:18:19,260
offline IR job I mean that they have

482
00:18:19,260 --> 00:18:21,090
access to a machining someone said or

483
00:18:21,090 --> 00:18:23,159
there's some badness on this machine he

484
00:18:23,159 --> 00:18:25,260
is a full memory dump or here's a disk

485
00:18:25,260 --> 00:18:27,240
image can you tell me what's going on on

486
00:18:27,240 --> 00:18:29,220
it and I want to make sure that if we're

487
00:18:29,220 --> 00:18:30,360
doing that and I'll threaten as I'm

488
00:18:30,360 --> 00:18:33,299
gonna miss oh I'm going to miss the

489
00:18:33,299 --> 00:18:36,360
possibility of this kind of attack so

490
00:18:36,360 --> 00:18:37,919
okay that's cool I know that's kind of a

491
00:18:37,919 --> 00:18:41,360
lot easier to do within like than live

492
00:18:41,360 --> 00:18:44,190
background detection partly because we

493
00:18:44,190 --> 00:18:45,960
can leverage a really rich tool chain if

494
00:18:45,960 --> 00:18:48,150
I'm on a if we're if we're on a threat

495
00:18:48,150 --> 00:18:50,130
hunters workstation we can request that

496
00:18:50,130 --> 00:18:52,049
they install loads of Python libraries

497
00:18:52,049 --> 00:18:54,150
and loads of tool chains to make this

498
00:18:54,150 --> 00:18:55,470
happen whereas if we're on a client

499
00:18:55,470 --> 00:18:57,270
system we can't be like oh no you have

500
00:18:57,270 --> 00:19:00,120
to install all these zillion things we

501
00:19:00,120 --> 00:19:02,250
also get somewhat soluble thoughts

502
00:19:02,250 --> 00:19:04,260
positive rate in the our our threat

503
00:19:04,260 --> 00:19:06,330
hunters of yeah owners would love it if

504
00:19:06,330 --> 00:19:08,760
I had zero false positives but a small

505
00:19:08,760 --> 00:19:10,710
amount of false positives ok because we

506
00:19:10,710 --> 00:19:12,240
you know we aren't selling a black box

507
00:19:12,240 --> 00:19:14,850
to clients that that that says oh you're

508
00:19:14,850 --> 00:19:18,960
being hacked most of our services in we

509
00:19:18,960 --> 00:19:20,789
have our hunter team who do all the

510
00:19:20,789 --> 00:19:22,409
monitoring so any alerts go through the

511
00:19:22,409 --> 00:19:24,780
farmers and the time is comb through all

512
00:19:24,780 --> 00:19:25,980
of these alert and say oh that's not

513
00:19:25,980 --> 00:19:27,659
that's not important that's so important

514
00:19:27,659 --> 00:19:29,700
and so on so some amount of false

515
00:19:29,700 --> 00:19:32,669
positives is okay the malware

516
00:19:32,669 --> 00:19:36,150
well yeah we do have a pretty tight

517
00:19:36,150 --> 00:19:38,429
restriction on false negatives in the if

518
00:19:38,429 --> 00:19:39,900
the malware gets dropped and we don't

519
00:19:39,900 --> 00:19:41,760
spot it that's you know super duper

520
00:19:41,760 --> 00:19:43,770
duper duper bad so we want to avoid that

521
00:19:43,770 --> 00:19:46,020
at all costs and the other one that

522
00:19:46,020 --> 00:19:47,460
seems a bit silly and a bit obvious is

523
00:19:47,460 --> 00:19:49,240
we need this thing usable on everyone's

524
00:19:49,240 --> 00:19:51,430
playing systems we can't go to the

525
00:19:51,430 --> 00:19:54,070
client and be like oh yeah well we can't

526
00:19:54,070 --> 00:19:56,080
do IR on your box because we don't

527
00:19:56,080 --> 00:19:58,380
support Windows 7 anymore you know

528
00:19:58,380 --> 00:20:02,950
wouldn't make us very popular so the

529
00:20:02,950 --> 00:20:04,900
second stage which is the really

530
00:20:04,900 --> 00:20:05,650
difficult one

531
00:20:05,650 --> 00:20:08,200
it's detect joan life system usage and I

532
00:20:08,200 --> 00:20:10,900
didn't get this done I arrived at the

533
00:20:10,900 --> 00:20:12,340
point where we kind of closed the

534
00:20:12,340 --> 00:20:14,170
research I had that the first half ton

535
00:20:14,170 --> 00:20:16,870
of coal detection and the live detection

536
00:20:16,870 --> 00:20:18,850
I kind of have it working on my machine

537
00:20:18,850 --> 00:20:23,230
and on like my farm of VMs but if I

538
00:20:23,230 --> 00:20:24,970
suggest push gap to client stead then

539
00:20:24,970 --> 00:20:26,740
like all the people my company would be

540
00:20:26,740 --> 00:20:28,600
very very nervous about doing that and

541
00:20:28,600 --> 00:20:29,950
the clients are probably nervous as well

542
00:20:29,950 --> 00:20:32,710
it's not it's not quite stable enough as

543
00:20:32,710 --> 00:20:34,480
I say we need this these very strong

544
00:20:34,480 --> 00:20:35,650
stability showings as if we're going to

545
00:20:35,650 --> 00:20:37,420
do that which I can't I can't really

546
00:20:37,420 --> 00:20:39,280
provide we need to possibility based

547
00:20:39,280 --> 00:20:41,050
conditions because we're running like

548
00:20:41,050 --> 00:20:43,240
the kernels running as we're running if

549
00:20:43,240 --> 00:20:45,040
you have a cold memory dump you know so

550
00:20:45,040 --> 00:20:46,360
fair enough some your data structures

551
00:20:46,360 --> 00:20:47,860
might not be consistent because of when

552
00:20:47,860 --> 00:20:50,080
you took the dump but you don't have

553
00:20:50,080 --> 00:20:51,820
things changing beneath in the same way

554
00:20:51,820 --> 00:20:54,640
you do on a live kernel and we also need

555
00:20:54,640 --> 00:20:56,320
higher accuracy requirements because

556
00:20:56,320 --> 00:20:57,820
this is when we're going to scale up on

557
00:20:57,820 --> 00:20:59,140
running on tens of thousands machines

558
00:20:59,140 --> 00:21:01,450
and ours are going to get buried in like

559
00:21:01,450 --> 00:21:04,560
a million false positives or whatever so

560
00:21:04,560 --> 00:21:07,210
stage one as well not as far as I

561
00:21:07,210 --> 00:21:11,130
thought but did stage one and it was the

562
00:21:11,130 --> 00:21:13,900
what's the term I'm not sure about it

563
00:21:13,900 --> 00:21:16,390
the whole thing where where you you at

564
00:21:16,390 --> 00:21:17,380
the point you hit the point of

565
00:21:17,380 --> 00:21:20,140
diminishing returns that's wonderful so

566
00:21:20,140 --> 00:21:22,840
on to detection so I'm being really

567
00:21:22,840 --> 00:21:24,010
unprofessional I'm checking my phone

568
00:21:24,010 --> 00:21:25,150
because I want to see how much time I've

569
00:21:25,150 --> 00:21:26,950
got Lester I should have put a clock on

570
00:21:26,950 --> 00:21:31,740
here or something anyway onto detection

571
00:21:31,740 --> 00:21:34,360
so if you want to look at how we got you

572
00:21:34,360 --> 00:21:36,310
to take this obviously we wanted to take

573
00:21:36,310 --> 00:21:37,390
an attack we're going to start looking

574
00:21:37,390 --> 00:21:39,160
at which artifacts we've got on the

575
00:21:39,160 --> 00:21:41,770
system and there really isn't much here

576
00:21:41,770 --> 00:21:44,230
there's some code that's sat in on

577
00:21:44,230 --> 00:21:46,720
execute of memory section so I was like

578
00:21:46,720 --> 00:21:48,580
who going to be kind of tricky to detect

579
00:21:48,580 --> 00:21:50,920
based on that you could maybe you can do

580
00:21:50,920 --> 00:21:52,810
some clever scanning and you can say oh

581
00:21:52,810 --> 00:21:55,540
this is this is X this is non-executable

582
00:21:55,540 --> 00:21:57,610
memory but there's some stuff in here

583
00:21:57,610 --> 00:21:59,200
that looks like it might be x86

584
00:21:59,200 --> 00:22:01,260
but that's gonna be

585
00:22:01,260 --> 00:22:03,030
it's gonna be slow right because you

586
00:22:03,030 --> 00:22:05,040
have to do all this clever matching and

587
00:22:05,040 --> 00:22:07,170
you have to access all the memory and

588
00:22:07,170 --> 00:22:08,820
it's kind of bit of a losing proposition

589
00:22:08,820 --> 00:22:12,990
really I thought I thought the other one

590
00:22:12,990 --> 00:22:16,710
in the other artifact caught my eye was

591
00:22:16,710 --> 00:22:20,040
the system time itself and because the

592
00:22:20,040 --> 00:22:21,870
whole attack is based around using this

593
00:22:21,870 --> 00:22:24,530
system time it to wake up and there's no

594
00:22:24,530 --> 00:22:27,630
it's it the use of a system time it

595
00:22:27,630 --> 00:22:28,620
isn't a byproduct

596
00:22:28,620 --> 00:22:30,500
it's very intrinsic to the attack itself

597
00:22:30,500 --> 00:22:32,790
kind of I'll come back to that at the

598
00:22:32,790 --> 00:22:36,120
last slide but for now it's very much

599
00:22:36,120 --> 00:22:37,800
intrinsic to the attack itself is that

600
00:22:37,800 --> 00:22:39,390
you have this timer and that's what

601
00:22:39,390 --> 00:22:42,030
wakes everything up so okay let's see if

602
00:22:42,030 --> 00:22:44,040
I'm finally these system timers you know

603
00:22:44,040 --> 00:22:46,080
I'll go I'll check out the API

604
00:22:46,080 --> 00:22:48,480
documentation find out get a list of

605
00:22:48,480 --> 00:22:49,980
these timers see what they're gonna do

606
00:22:49,980 --> 00:22:52,530
you know there must be some API call you

607
00:22:52,530 --> 00:22:55,740
know in um timer lists or whatever yeah

608
00:22:55,740 --> 00:22:59,640
there isn't so this is the first big

609
00:22:59,640 --> 00:23:01,430
wall I've hidden that I've run into is

610
00:23:01,430 --> 00:23:04,260
that time information isn't available

611
00:23:04,260 --> 00:23:06,960
from user space if you're a Windows user

612
00:23:06,960 --> 00:23:11,690
space process you have like the API to

613
00:23:11,690 --> 00:23:14,730
interact with timers is limited creating

614
00:23:14,730 --> 00:23:18,300
them canceling them setting how much

615
00:23:18,300 --> 00:23:20,340
times going to elapse before they happen

616
00:23:20,340 --> 00:23:21,900
that they're pretty much entirely

617
00:23:21,900 --> 00:23:23,790
kernel-mode facility that has some very

618
00:23:23,790 --> 00:23:25,650
thin wrappers in user space that's like

619
00:23:25,650 --> 00:23:28,160
okay that kind of sucks but you know

620
00:23:28,160 --> 00:23:30,960
we're elite hackers you know we're gonna

621
00:23:30,960 --> 00:23:32,670
be fine I'll attach a kernel debugger

622
00:23:32,670 --> 00:23:34,650
I'm sure there's I'm sure it's going to

623
00:23:34,650 --> 00:23:37,110
be just like you know all the all the

624
00:23:37,110 --> 00:23:39,150
other things that we do in InfoSec where

625
00:23:39,150 --> 00:23:41,010
there's all these opaque data structures

626
00:23:41,010 --> 00:23:42,270
that you're not supposed to touch and

627
00:23:42,270 --> 00:23:43,650
then we go in and touch them all and

628
00:23:43,650 --> 00:23:44,880
Microsoft hates us for breaking

629
00:23:44,880 --> 00:23:47,070
everything it sounds like okay let's

630
00:23:47,070 --> 00:23:48,900
take a look kernel but it turns out the

631
00:23:48,900 --> 00:23:50,990
kernel space is pretty much the same

632
00:23:50,990 --> 00:23:54,120
there's a very narrow list of the of

633
00:23:54,120 --> 00:23:56,100
these time of functions is available you

634
00:23:56,100 --> 00:23:58,410
can create them cancel them

635
00:23:58,410 --> 00:24:00,960
wait for them and not much else so it's

636
00:24:00,960 --> 00:24:02,880
like hmm okay

637
00:24:02,880 --> 00:24:05,460
you can't enumerate them we can't

638
00:24:05,460 --> 00:24:07,710
interrogate them in terms of finding out

639
00:24:07,710 --> 00:24:09,510
the the payload that they're going to

640
00:24:09,510 --> 00:24:11,880
execute when they go off right what

641
00:24:11,880 --> 00:24:12,930
we're gonna do here maybe there's

642
00:24:12,930 --> 00:24:15,210
something we can dig out so I study

643
00:24:15,210 --> 00:24:17,460
the windows internal box and poured over

644
00:24:17,460 --> 00:24:23,520
this and there really isn't so there

645
00:24:23,520 --> 00:24:27,480
really isn't any any easy undocumented

646
00:24:27,480 --> 00:24:29,610
way of doing this either like there's

647
00:24:29,610 --> 00:24:31,350
many things of Windows that are you know

648
00:24:31,350 --> 00:24:33,510
you shouldn't do them but they're stable

649
00:24:33,510 --> 00:24:35,370
for most Windows versions and you can

650
00:24:35,370 --> 00:24:37,260
get away weird like messing around but

651
00:24:37,260 --> 00:24:42,240
with time as there isn't there isn't one

652
00:24:42,240 --> 00:24:44,340
I could find maybe I should say I don't

653
00:24:44,340 --> 00:24:46,980
know a man I'm waiting for the the point

654
00:24:46,980 --> 00:24:48,540
at the end of the talk about open things

655
00:24:48,540 --> 00:24:49,920
up for questions and someone tells me

656
00:24:49,920 --> 00:24:51,450
that I'm completely and absolutely wrong

657
00:24:51,450 --> 00:24:53,310
looking with no one in particular in the

658
00:24:53,310 --> 00:24:54,720
audience you might have lots of

659
00:24:54,720 --> 00:25:00,990
knowledge in this area so anyway because

660
00:25:00,990 --> 00:25:03,720
we're working on a cold memory dump we

661
00:25:03,720 --> 00:25:05,520
can take advantage of volatility which

662
00:25:05,520 --> 00:25:09,090
is as has who's used volatility before

663
00:25:09,090 --> 00:25:12,720
or no split does or great cool yeah so

664
00:25:12,720 --> 00:25:15,120
it's a it's a tool for for taking memory

665
00:25:15,120 --> 00:25:16,620
dumps interrogating them and proving out

666
00:25:16,620 --> 00:25:18,930
what's going on and it turns out it

667
00:25:18,930 --> 00:25:20,820
ships with a script a plugin it's its

668
00:25:20,820 --> 00:25:23,670
plug-in based or written and Python it

669
00:25:23,670 --> 00:25:26,760
ships with a plug-in called x dot py i

670
00:25:26,760 --> 00:25:29,670
was like fantastic time is dot py he'll

671
00:25:29,670 --> 00:25:31,350
tell me all the timers and everything

672
00:25:31,350 --> 00:25:35,640
will be great so I got my Windows my I

673
00:25:35,640 --> 00:25:37,500
think as Windows 10 I've got my the VM

674
00:25:37,500 --> 00:25:38,820
that I'm working on which just so

675
00:25:38,820 --> 00:25:41,460
happened to be like the the same version

676
00:25:41,460 --> 00:25:43,320
that this plug-in works on I'll come

677
00:25:43,320 --> 00:25:45,690
back to that in a minute and the

678
00:25:45,690 --> 00:25:47,790
difficulties but the important thing is

679
00:25:47,790 --> 00:25:49,980
this this plug-in can enumerate all the

680
00:25:49,980 --> 00:25:52,380
system timers fantastic and it can

681
00:25:52,380 --> 00:25:55,260
extract all the a PC info the a PC is

682
00:25:55,260 --> 00:25:58,260
just a data structure that that defines

683
00:25:58,260 --> 00:25:59,850
what's going to happen when the timer

684
00:25:59,850 --> 00:26:02,490
fires a synchronous procedure call so

685
00:26:02,490 --> 00:26:04,440
yeah it will tell us the address of the

686
00:26:04,440 --> 00:26:06,480
code and which process it belongs to

687
00:26:06,480 --> 00:26:09,180
that kind of thing that's fantastic

688
00:26:09,180 --> 00:26:11,010
thank you volatility everything's great

689
00:26:11,010 --> 00:26:14,220
yay volatility so we we spin it up and

690
00:26:14,220 --> 00:26:16,410
we run it on our Windows 10 32-bit VM

691
00:26:16,410 --> 00:26:18,030
because that's why I had handy at a time

692
00:26:18,030 --> 00:26:22,350
and we run this command timers and it's

693
00:26:22,350 --> 00:26:23,970
like oh yes here's all your timers

694
00:26:23,970 --> 00:26:26,700
fantastic so these are system timers are

695
00:26:26,700 --> 00:26:28,419
in the Windows kernel

696
00:26:28,419 --> 00:26:29,919
they have this do time blah blah blah

697
00:26:29,919 --> 00:26:32,200
one of the really one of the important

698
00:26:32,200 --> 00:26:34,629
things here is the the offset field

699
00:26:34,629 --> 00:26:37,929
which is a pointer to a an e timer

700
00:26:37,929 --> 00:26:40,059
struct which is the structure that

701
00:26:40,059 --> 00:26:42,009
Windows uses to describe it the the

702
00:26:42,009 --> 00:26:44,739
system time ism so if you connect your

703
00:26:44,739 --> 00:26:46,659
your kernel debugger and you go and take

704
00:26:46,659 --> 00:26:48,609
a look at that Microsoft make all the

705
00:26:48,609 --> 00:26:50,049
symbols for the kernel

706
00:26:50,049 --> 00:26:51,009
almost all the symbols available

707
00:26:51,009 --> 00:26:53,289
publicly so you can fight win debug

708
00:26:53,289 --> 00:26:55,210
it'll pull down the symbols what's in an

709
00:26:55,210 --> 00:26:57,190
e timer and it will tell you and yeah

710
00:26:57,190 --> 00:27:00,190
and this is what's in the e timer and

711
00:27:00,190 --> 00:27:01,659
there's like some bits of information

712
00:27:01,659 --> 00:27:03,340
we're not interested in the things we

713
00:27:03,340 --> 00:27:06,489
are interested in is the the a PC as I

714
00:27:06,489 --> 00:27:08,289
say it'll tell you what happens when it

715
00:27:08,289 --> 00:27:10,269
goes off there's also period as well so

716
00:27:10,269 --> 00:27:11,409
you can see how long it's going to be

717
00:27:11,409 --> 00:27:12,999
put happens and there's all sorts of

718
00:27:12,999 --> 00:27:14,710
like scary stuff that we're not supposed

719
00:27:14,710 --> 00:27:20,350
to touch will touch it later Mike and so

720
00:27:20,350 --> 00:27:21,730
yeah so then we have enough information

721
00:27:21,730 --> 00:27:24,309
in that we have the list of timers we

722
00:27:24,309 --> 00:27:27,549
know what they're going to do as I said

723
00:27:27,549 --> 00:27:28,629
I'm not going to get like super duper

724
00:27:28,629 --> 00:27:30,759
technical here there is a blog post on

725
00:27:30,759 --> 00:27:33,730
the account cept blog and it's it has

726
00:27:33,730 --> 00:27:36,220
like a full walkthrough of connect your

727
00:27:36,220 --> 00:27:38,619
kernel debugger and then type this and

728
00:27:38,619 --> 00:27:40,509
you'll see this kind of thing is that

729
00:27:40,509 --> 00:27:41,980
there's a full walkthrough a detection

730
00:27:41,980 --> 00:27:44,169
if you're if you're interested in light

731
00:27:44,169 --> 00:27:45,850
like Windows kernel or that kind of

732
00:27:45,850 --> 00:27:48,279
thing do check it out I spent ages on it

733
00:27:48,279 --> 00:27:50,379
I'm proud of it possibly because it's my

734
00:27:50,379 --> 00:27:52,049
first blog post for the company but yeah

735
00:27:52,049 --> 00:27:56,049
anyway given this information we need to

736
00:27:56,049 --> 00:27:58,570
detect the detect use of this gargoyle

737
00:27:58,570 --> 00:28:01,869
attack so the the kind of first try

738
00:28:01,869 --> 00:28:05,259
naive way of doing things is observe the

739
00:28:05,259 --> 00:28:06,629
the prologue of the handler routine

740
00:28:06,629 --> 00:28:08,919
because normally if there's a timer it's

741
00:28:08,919 --> 00:28:10,720
going to point to a function and the

742
00:28:10,720 --> 00:28:11,919
function is going to have you know the

743
00:28:11,919 --> 00:28:14,529
normal x86 or babysittin whatever the

744
00:28:14,529 --> 00:28:17,950
normal flow log of setting up some stack

745
00:28:17,950 --> 00:28:20,049
frame pushing some registers that kind

746
00:28:20,049 --> 00:28:20,440
of thing

747
00:28:20,440 --> 00:28:21,639
it's not going to do anything really

748
00:28:21,639 --> 00:28:23,289
weird like a stack bit like a stack

749
00:28:23,289 --> 00:28:25,029
pivot is going to know pop-pop bet it's

750
00:28:25,029 --> 00:28:27,070
gonna be it's gonna be pretty obvious so

751
00:28:27,070 --> 00:28:30,220
okay let's get that set up so that was

752
00:28:30,220 --> 00:28:31,629
the first thing I did I went away in

753
00:28:31,629 --> 00:28:33,759
over I wrote some Python to do this so I

754
00:28:33,759 --> 00:28:35,950
made this this very simple plugin that

755
00:28:35,950 --> 00:28:38,289
did this I just I just built on top of

756
00:28:38,289 --> 00:28:39,789
the timers plug-in and here we can see

757
00:28:39,789 --> 00:28:42,340
that gargoyle DXE which is the peer

758
00:28:42,340 --> 00:28:47,010
has a a gargoyle

759
00:28:47,010 --> 00:28:49,630
he's showing signs of using the gargoyle

760
00:28:49,630 --> 00:28:51,519
attack so we filtered out all the other

761
00:28:51,519 --> 00:28:53,710
timers at this point and we said okay

762
00:28:53,710 --> 00:28:55,870
there's a handler here this is the code

763
00:28:55,870 --> 00:28:57,399
that's gonna be executed and it says a

764
00:28:57,399 --> 00:28:59,049
disassembly it's gonna it's an execute

765
00:28:59,049 --> 00:29:01,779
already know pop pop bet pretty bad

766
00:29:01,779 --> 00:29:04,289
pretty scary if we showed it to our

767
00:29:04,289 --> 00:29:06,490
elephants they'd be like oh oh no we

768
00:29:06,490 --> 00:29:08,590
better do something about that and I

769
00:29:08,590 --> 00:29:09,789
would like to slide away and do some

770
00:29:09,789 --> 00:29:11,140
research on something while they dealt

771
00:29:11,140 --> 00:29:12,669
with all the hard at throwing up the

772
00:29:12,669 --> 00:29:14,559
clients and talking about them my job's

773
00:29:14,559 --> 00:29:15,880
fantastic just like everyone else does

774
00:29:15,880 --> 00:29:18,760
all the hard stuff and I just use anyway

775
00:29:18,760 --> 00:29:19,980
I digress

776
00:29:19,980 --> 00:29:22,690
it does work very well but it is kind of

777
00:29:22,690 --> 00:29:25,659
manual and that means that if we have

778
00:29:25,659 --> 00:29:27,760
our hunters and obviously our vets

779
00:29:27,760 --> 00:29:29,110
hunters are always at peak performance

780
00:29:29,110 --> 00:29:30,730
and they're always really really

781
00:29:30,730 --> 00:29:33,789
fantastic and I never miss anything it

782
00:29:33,789 --> 00:29:35,799
would never happen that our threat

783
00:29:35,799 --> 00:29:38,350
hunters would find this like 4:59 p.m.

784
00:29:38,350 --> 00:29:41,019
just before their shift ends and see a

785
00:29:41,019 --> 00:29:43,120
list of 10,000 of these a false positive

786
00:29:43,120 --> 00:29:44,679
someone that isn't and it would never

787
00:29:44,679 --> 00:29:47,860
happen obviously because I was at like

788
00:29:47,860 --> 00:29:49,600
superhuman right and they would never

789
00:29:49,600 --> 00:29:54,039
they would never miss that but just for

790
00:29:54,039 --> 00:29:55,480
the benefit of all the mere mortals we

791
00:29:55,480 --> 00:29:56,889
don't work for such an illustrious and

792
00:29:56,889 --> 00:30:00,309
wonderful companies and I was kidding

793
00:30:00,309 --> 00:30:01,600
please laugh otherwise I'm gonna feel

794
00:30:01,600 --> 00:30:02,860
really egotistical as if I'm being

795
00:30:02,860 --> 00:30:06,639
serious so I wanted to automate this a

796
00:30:06,639 --> 00:30:08,830
bit after we've done this after I after

797
00:30:08,830 --> 00:30:10,389
I'd taken this to saying okay here's the

798
00:30:10,389 --> 00:30:12,669
timer information so I really should

799
00:30:12,669 --> 00:30:13,990
have bought an alarm clock actually have

800
00:30:13,990 --> 00:30:15,399
like enough you know the old alarm

801
00:30:15,399 --> 00:30:16,809
clocks that have like big bells and

802
00:30:16,809 --> 00:30:18,039
they're really really noisy

803
00:30:18,039 --> 00:30:19,570
I've got one those home I was gonna put

804
00:30:19,570 --> 00:30:21,039
it just there so I could keep an eye on

805
00:30:21,039 --> 00:30:23,830
a time and I forgot about it never mind

806
00:30:23,830 --> 00:30:25,090
I was I was so flushed with success

807
00:30:25,090 --> 00:30:26,649
after I came in today

808
00:30:26,649 --> 00:30:28,570
like in time for the first presentation

809
00:30:28,570 --> 00:30:30,130
that was my goal for today so it's flush

810
00:30:30,130 --> 00:30:34,919
with success after that anyway I digress

811
00:30:34,919 --> 00:30:37,059
after finding this looking at the

812
00:30:37,059 --> 00:30:38,590
function prologues I want to look at how

813
00:30:38,590 --> 00:30:41,590
to automate this and there's a we have

814
00:30:41,590 --> 00:30:43,269
to be very careful about how we automate

815
00:30:43,269 --> 00:30:45,909
anything in this area because you can

816
00:30:45,909 --> 00:30:47,980
give too much automation you can give to

817
00:30:47,980 --> 00:30:50,740
little automation there's we don't want

818
00:30:50,740 --> 00:30:52,630
to end up being the

819
00:30:52,630 --> 00:30:55,610
we aren't we aren't the kind of company

820
00:30:55,610 --> 00:30:57,290
who give you a black box and you say

821
00:30:57,290 --> 00:30:58,880
this box will tell you when you're being

822
00:30:58,880 --> 00:30:59,360
hacked

823
00:30:59,360 --> 00:31:00,950
you see these packets it's a hack

824
00:31:00,950 --> 00:31:02,960
attempt we've blocked 30,000 hack

825
00:31:02,960 --> 00:31:04,910
attempts on new in the last 24 hours

826
00:31:04,910 --> 00:31:06,560
that's not really our game we want to

827
00:31:06,560 --> 00:31:09,110
keep humans in the loop we want to I

828
00:31:09,110 --> 00:31:11,150
feel so sci-fi when I say that we want

829
00:31:11,150 --> 00:31:15,590
to keep humans in the loop it's well

830
00:31:15,590 --> 00:31:17,150
wonder how I have a lot of time for

831
00:31:17,150 --> 00:31:19,850
quick anecdote about a film maybe they

832
00:31:19,850 --> 00:31:22,220
want even some wargames it's like an 80s

833
00:31:22,220 --> 00:31:24,710
film about hacking yeah one person okay

834
00:31:24,710 --> 00:31:28,520
that's cool two people okay I have to

835
00:31:28,520 --> 00:31:29,720
run some film nights at my workplace

836
00:31:29,720 --> 00:31:31,910
because half people in my workplace

837
00:31:31,910 --> 00:31:33,290
haven't seen khakis and I'm just like

838
00:31:33,290 --> 00:31:35,690
what is going on here man anyway at the

839
00:31:35,690 --> 00:31:38,060
start of that film there's a the whole

840
00:31:38,060 --> 00:31:39,680
premise of it is is that there's this

841
00:31:39,680 --> 00:31:41,660
computer that takes over the nuclear

842
00:31:41,660 --> 00:31:43,820
missile silos it gets hacked but at the

843
00:31:43,820 --> 00:31:48,220
start to film you see all the the the

844
00:31:48,250 --> 00:31:50,420
there's a big conversation between all

845
00:31:50,420 --> 00:31:51,980
the army generals saying oh we need to

846
00:31:51,980 --> 00:31:54,230
take the humans out of the missile silos

847
00:31:54,230 --> 00:31:55,640
because they can't form under pressure

848
00:31:55,640 --> 00:31:57,440
and can't turn the key to annihilate

849
00:31:57,440 --> 00:31:58,970
everyone in the world so we need a

850
00:31:58,970 --> 00:32:00,560
computer that's going to keep the

851
00:32:00,560 --> 00:32:03,500
controls the president can push them can

852
00:32:03,500 --> 00:32:05,990
push the button and kill everyone and to

853
00:32:05,990 --> 00:32:07,430
quote there is that you know we need to

854
00:32:07,430 --> 00:32:10,160
keep humans in the loop that's where my

855
00:32:10,160 --> 00:32:12,230
quote was was from for the benefit of

856
00:32:12,230 --> 00:32:14,360
like the the two people in the room

857
00:32:14,360 --> 00:32:16,670
who've seen that okay when I get to my

858
00:32:16,670 --> 00:32:18,260
last slide and I have no time remaining

859
00:32:18,260 --> 00:32:19,730
you can remind me it's my own fault for

860
00:32:19,730 --> 00:32:22,190
talking about like a G's in here at

861
00:32:22,190 --> 00:32:24,080
hacker films instead of actual Gargoyle

862
00:32:24,080 --> 00:32:30,350
so getting back on track automation when

863
00:32:30,350 --> 00:32:32,660
you still carefully as I say way to keep

864
00:32:32,660 --> 00:32:34,970
things objective we don't want a system

865
00:32:34,970 --> 00:32:37,400
that says there is someone hacking you

866
00:32:37,400 --> 00:32:39,680
we want a system that tells you

867
00:32:39,680 --> 00:32:42,580
objective facts about the situation

868
00:32:42,580 --> 00:32:45,380
intent is the key intake should be

869
00:32:45,380 --> 00:32:48,160
inferred by a person who knows what who

870
00:32:48,160 --> 00:32:52,940
who is familiar with yeah of goings on

871
00:32:52,940 --> 00:32:56,080
as opposed to a computer which is Liam

872
00:32:56,080 --> 00:32:58,820
very objective not not very good at kind

873
00:32:58,820 --> 00:33:01,340
of guessing things obviously you need to

874
00:33:01,340 --> 00:33:03,560
fail safely and when I say this you to

875
00:33:03,560 --> 00:33:05,570
err on the side of the false positives

876
00:33:05,570 --> 00:33:07,310
after that hunters will hate me if I

877
00:33:07,310 --> 00:33:09,200
send them 10,000 false positives a day

878
00:33:09,200 --> 00:33:12,800
and that's bad kind of but the client

879
00:33:12,800 --> 00:33:14,600
will hate me if I don't send them the

880
00:33:14,600 --> 00:33:16,580
true positive when one occurs right so

881
00:33:16,580 --> 00:33:18,740
fail safely if it breaks you've got to

882
00:33:18,740 --> 00:33:20,180
let you go be like oh there's there's

883
00:33:20,180 --> 00:33:24,830
probably something wrong here so I'm

884
00:33:24,830 --> 00:33:27,830
sort of so yeah to keep the thing that

885
00:33:27,830 --> 00:33:29,540
set out was to do to be very objective

886
00:33:29,540 --> 00:33:31,700
here I want to expose the behavior of

887
00:33:31,700 --> 00:33:34,160
this time a handler and if we see it

888
00:33:34,160 --> 00:33:36,740
performing a stack pivot then there's

889
00:33:36,740 --> 00:33:38,000
something going that there's something

890
00:33:38,000 --> 00:33:40,280
of I it woman it's further investigation

891
00:33:40,280 --> 00:33:43,160
so it's not a 100 percent this is bad

892
00:33:43,160 --> 00:33:45,260
but it's probably in nineteen ninety

893
00:33:45,260 --> 00:33:46,970
five percent this is almost certainly

894
00:33:46,970 --> 00:33:50,120
bad go check it out and if it jumps to a

895
00:33:50,120 --> 00:33:51,590
virtual protect and it makes some code

896
00:33:51,590 --> 00:33:53,810
executable that's fully pretty bad as

897
00:33:53,810 --> 00:33:55,910
well and if it does that and then jumps

898
00:33:55,910 --> 00:33:57,320
to that memory then you know that's

899
00:33:57,320 --> 00:33:59,690
that's bad people need to be like paying

900
00:33:59,690 --> 00:34:02,420
attention and the way I did this was

901
00:34:02,420 --> 00:34:07,600
with a an emulation framework I have

902
00:34:07,600 --> 00:34:10,730
yeah the emulation framework I used was

903
00:34:10,730 --> 00:34:12,650
a unicorn engine which as has anyone

904
00:34:12,650 --> 00:34:15,699
used the unicorn engine anyone know it

905
00:34:15,699 --> 00:34:22,159
oh no one person yes I yes okay so this

906
00:34:22,159 --> 00:34:24,530
is this is the unicorn engine I kind of

907
00:34:24,530 --> 00:34:25,940
stuck this slide in because like not

908
00:34:25,940 --> 00:34:27,409
enough people are using unicorn it's

909
00:34:27,409 --> 00:34:29,600
fantastic I absolutely love it I've got

910
00:34:29,600 --> 00:34:31,280
an entire slide after this where I kind

911
00:34:31,280 --> 00:34:32,840
of go off on a tangent like a plan to

912
00:34:32,840 --> 00:34:34,520
tangent about how wonderful it is

913
00:34:34,520 --> 00:34:37,909
it's a CPU emulation engine it's based

914
00:34:37,909 --> 00:34:40,040
on qemu it does as iliyan architectures

915
00:34:40,040 --> 00:34:43,159
so it'll do all your x86 64 it'll do

916
00:34:43,159 --> 00:34:44,840
like your arm stuff if you want if you

917
00:34:44,840 --> 00:34:47,360
have some like Android code like this

918
00:34:47,360 --> 00:34:51,170
it's properly actively maintained big

919
00:34:51,170 --> 00:34:52,670
bonus I know it sounds silly but you

920
00:34:52,670 --> 00:34:55,429
know and it's for from from Quinn Eugene

921
00:34:55,429 --> 00:34:57,860
the guy who wrote capstone which is you

922
00:34:57,860 --> 00:35:00,500
know if anyone has everyone used used

923
00:35:00,500 --> 00:35:01,100
Capstone's

924
00:35:01,100 --> 00:35:02,810
and on each capstone disassemble if a

925
00:35:02,810 --> 00:35:05,030
map so capstone is a it's a really good

926
00:35:05,030 --> 00:35:06,470
disassemble framework you feed it some

927
00:35:06,470 --> 00:35:08,590
code and it'll disassemble it for you

928
00:35:08,590 --> 00:35:11,360
cool it works fantastic because they've

929
00:35:11,360 --> 00:35:12,590
written by the same person they play

930
00:35:12,590 --> 00:35:13,670
really nicely together

931
00:35:13,670 --> 00:35:15,920
it's very easy to be like oh you

932
00:35:15,920 --> 00:35:17,330
disassemble this code and you you

933
00:35:17,330 --> 00:35:18,260
emulate through it

934
00:35:18,260 --> 00:35:19,880
it's it's really good if you end up

935
00:35:19,880 --> 00:35:21,770
doing or if you're if you end up doing

936
00:35:21,770 --> 00:35:23,210
this kind of thing check it out it's

937
00:35:23,210 --> 00:35:25,609
it's it's really cool code I really like

938
00:35:25,609 --> 00:35:28,910
it and not not I'd say not enough people

939
00:35:28,910 --> 00:35:31,760
use it maybe I'm maybe I maybe all the

940
00:35:31,760 --> 00:35:33,470
people I know don't use it but yeah it's

941
00:35:33,470 --> 00:35:36,220
it's fake I'm just giving a quick plug

942
00:35:36,220 --> 00:35:39,800
how more times it did it dare what time

943
00:35:39,800 --> 00:35:45,200
do I start I start 1:30 oh wow I

944
00:35:45,200 --> 00:35:46,670
should've had to bed bulls I'm not going

945
00:35:46,670 --> 00:35:49,700
quick enough okay so I'm gonna skip my

946
00:35:49,700 --> 00:35:51,800
quick tangent because it's not quick

947
00:35:51,800 --> 00:35:54,380
enough so for the people trying to take

948
00:35:54,380 --> 00:35:55,760
a picture of my quick dungeon it doesn't

949
00:35:55,760 --> 00:35:57,619
work unless I talk anyway so yes I

950
00:35:57,619 --> 00:36:00,980
emulate once you emulate you can emulate

951
00:36:00,980 --> 00:36:03,290
essentially this dub code you get some

952
00:36:03,290 --> 00:36:05,210
information about your about what the

953
00:36:05,210 --> 00:36:07,100
code is doing it say oh there was a call

954
00:36:07,100 --> 00:36:09,230
to virtual protect it jumped to it this

955
00:36:09,230 --> 00:36:09,859
is bad

956
00:36:09,859 --> 00:36:11,480
malicious code is here and you can pump

957
00:36:11,480 --> 00:36:12,770
that to your for it hummin your threat

958
00:36:12,770 --> 00:36:15,260
hunters come back oh great let me go and

959
00:36:15,260 --> 00:36:17,420
check it out and battle some cyber

960
00:36:17,420 --> 00:36:21,530
warriors our I'm always like loki

961
00:36:21,530 --> 00:36:23,359
mocking our with that hunters over there

962
00:36:23,359 --> 00:36:27,890
like hand-to-hand cyber combat they

963
00:36:27,890 --> 00:36:29,690
don't do that thing if it fails

964
00:36:29,690 --> 00:36:31,940
emulation fails sometimes and if it does

965
00:36:31,940 --> 00:36:34,609
so you can flag that up and still send

966
00:36:34,609 --> 00:36:36,080
it off the hunters and they can check it

967
00:36:36,080 --> 00:36:38,090
out probably something suspicious don't

968
00:36:38,090 --> 00:36:41,300
know so I'm really bumping up in speed

969
00:36:41,300 --> 00:36:43,600
because I talked about films too much

970
00:36:43,600 --> 00:36:45,950
I'm going to talk about QA and how we

971
00:36:45,950 --> 00:36:48,470
went from here's our here's our recall

972
00:36:48,470 --> 00:36:50,359
plug-in you can go and use it to

973
00:36:50,359 --> 00:36:51,560
actually having something stable people

974
00:36:51,560 --> 00:36:53,690
can use very quickly I'm going to zoom

975
00:36:53,690 --> 00:36:57,680
through it so as I say as I kind of

976
00:36:57,680 --> 00:37:00,109
alluded to earlier my first version

977
00:37:00,109 --> 00:37:02,840
worked perfectly on my wind 10 32 bits

978
00:37:02,840 --> 00:37:05,480
dev machine for my Linux for my Linux

979
00:37:05,480 --> 00:37:07,430
like development machine targeting the

980
00:37:07,430 --> 00:37:10,550
windows box but that was pretty much all

981
00:37:10,550 --> 00:37:12,619
it worked on so I've got all this done I

982
00:37:12,619 --> 00:37:13,820
was like oh fantastic

983
00:37:13,820 --> 00:37:15,290
I can Mouse slack off for a bit and

984
00:37:15,290 --> 00:37:18,740
nothing left to do and then I tried it

985
00:37:18,740 --> 00:37:20,510
on like a 64-bit version of Windows 10

986
00:37:20,510 --> 00:37:21,950
just to make sure it worked and it just

987
00:37:21,950 --> 00:37:24,619
all completely fell flat like completely

988
00:37:24,619 --> 00:37:27,020
fell flat so I tried it on Windows 7 and

989
00:37:27,020 --> 00:37:28,430
it brogre if I don't live and this

990
00:37:28,430 --> 00:37:30,140
pretty much the only version of Windows

991
00:37:30,140 --> 00:37:31,650
of work properly I okay

992
00:37:31,650 --> 00:37:33,660
it was also broken when I ran it for a

993
00:37:33,660 --> 00:37:35,700
Windows host so when my volatility

994
00:37:35,700 --> 00:37:37,320
plug-in run on Windows of Linux it was

995
00:37:37,320 --> 00:37:38,520
broken which is quite an achievement

996
00:37:38,520 --> 00:37:41,430
given the cross-platform nature of

997
00:37:41,430 --> 00:37:44,040
Python right they I don't think I saw

998
00:37:44,040 --> 00:37:46,470
the top before me

999
00:37:46,470 --> 00:37:48,570
damn I forgotten the guy's name I told

1000
00:37:48,570 --> 00:37:49,890
before me where the guy was like I'm not

1001
00:37:49,890 --> 00:37:52,200
a developer but I dabble a bit oh yeah

1002
00:37:52,200 --> 00:37:53,700
me neither

1003
00:37:53,700 --> 00:37:56,790
you can tell and I'm also very bad a

1004
00:37:56,790 --> 00:37:59,640
Python but one thing that was very

1005
00:37:59,640 --> 00:38:01,920
obvious is it's worth spending a lot of

1006
00:38:01,920 --> 00:38:04,350
extra time here to make sure it's going

1007
00:38:04,350 --> 00:38:06,540
to work properly in the day because if

1008
00:38:06,540 --> 00:38:08,160
you have a client saying oh no our box

1009
00:38:08,160 --> 00:38:09,630
has been popped check it out

1010
00:38:09,630 --> 00:38:11,730
we can't go there and be like okay well

1011
00:38:11,730 --> 00:38:13,710
I've opened a but I've opened a ticket

1012
00:38:13,710 --> 00:38:15,210
on the tracker and the guy who maintains

1013
00:38:15,210 --> 00:38:16,740
it will fix it later and then we can

1014
00:38:16,740 --> 00:38:18,690
have a look you know it's worth spending

1015
00:38:18,690 --> 00:38:20,610
a disproportionately large amount of

1016
00:38:20,610 --> 00:38:23,540
time queuing and getting really really

1017
00:38:23,540 --> 00:38:27,930
careful about this so I decided I want a

1018
00:38:27,930 --> 00:38:29,460
test of false negatives on over ie

1019
00:38:29,460 --> 00:38:32,190
viruses so I just wanted to run the POC

1020
00:38:32,190 --> 00:38:33,570
on a load of different OSS

1021
00:38:33,570 --> 00:38:36,630
and then make sure it was detected ID I

1022
00:38:36,630 --> 00:38:39,030
didn't really test the false positives I

1023
00:38:39,030 --> 00:38:40,380
figured that was like slightly less

1024
00:38:40,380 --> 00:38:43,380
important I want it to start go back to

1025
00:38:43,380 --> 00:38:46,880
when XP no real need for earlier

1026
00:38:46,880 --> 00:38:48,930
everything changes like massively

1027
00:38:48,930 --> 00:38:53,010
earlier and oh five minutes I'm gonna go

1028
00:38:53,010 --> 00:38:55,440
really fast man so everything changes

1029
00:38:55,440 --> 00:38:58,290
for XP obviously and also because we

1030
00:38:58,290 --> 00:38:59,850
have like a few clients we deal with I

1031
00:38:59,850 --> 00:39:01,140
could look at a client base and say oh

1032
00:39:01,140 --> 00:39:02,490
yeah there's no need to do early next

1033
00:39:02,490 --> 00:39:03,810
because not many people using them

1034
00:39:03,810 --> 00:39:05,820
obviously we need 32 in 612

1035
00:39:05,820 --> 00:39:08,340
architectures 25% of our client boxes

1036
00:39:08,340 --> 00:39:09,960
were 32 bit which supplies me a little

1037
00:39:09,960 --> 00:39:13,260
bit the Dainik slider to do you test it

1038
00:39:13,260 --> 00:39:14,970
works ok from both Windows and Linux in

1039
00:39:14,970 --> 00:39:17,040
case my my my awful Python was like

1040
00:39:17,040 --> 00:39:19,230
excessively off alright so I clearly

1041
00:39:19,230 --> 00:39:21,030
needed to automate this you know I'm too

1042
00:39:21,030 --> 00:39:22,920
lazy to do it on everything and I wanted

1043
00:39:22,920 --> 00:39:24,750
to test it very often on each checking I

1044
00:39:24,750 --> 00:39:26,460
didn't want to commit my code like 4

1045
00:39:26,460 --> 00:39:29,010
p.m. on a Friday and then have some ir

1046
00:39:29,010 --> 00:39:30,900
job coming on Saturday and I'm like at

1047
00:39:30,900 --> 00:39:34,190
home I don't work weekends and have the

1048
00:39:34,190 --> 00:39:37,350
know he's broke the code and buggered

1049
00:39:37,350 --> 00:39:39,090
off or like he's broke the code and left

1050
00:39:39,090 --> 00:39:41,730
the building or such like it doesn't fit

1051
00:39:41,730 --> 00:39:43,740
nicely into the nice normal QA

1052
00:39:43,740 --> 00:39:45,950
environment

1053
00:39:46,070 --> 00:39:48,180
that's when the lines at the boss told

1054
00:39:48,180 --> 00:39:50,040
me to put into because it makes us sound

1055
00:39:50,040 --> 00:39:51,180
like we have like a really QA

1056
00:39:51,180 --> 00:39:54,900
environment doesn't fit into the normal

1057
00:39:54,900 --> 00:39:59,070
conveyance so I set up some some kind of

1058
00:39:59,070 --> 00:40:01,380
bodged QA as I say I'm not a developer I

1059
00:40:01,380 --> 00:40:04,140
dabble in development a bit the same way

1060
00:40:04,140 --> 00:40:05,640
that when like developers double

1061
00:40:05,640 --> 00:40:07,410
insecurity and then code their passwords

1062
00:40:07,410 --> 00:40:09,450
base64 that's like me to development

1063
00:40:09,450 --> 00:40:11,610
like I mess about with it so I wrote

1064
00:40:11,610 --> 00:40:13,380
some Python threw together some some

1065
00:40:13,380 --> 00:40:15,380
quick scripts that word build the POC

1066
00:40:15,380 --> 00:40:19,080
run it on a VM snapshot the VM drop

1067
00:40:19,080 --> 00:40:21,390
Titan volatility run the plug-in and

1068
00:40:21,390 --> 00:40:23,280
make sure it just said yes you're

1069
00:40:23,280 --> 00:40:26,190
infected so not much code surprisingly

1070
00:40:26,190 --> 00:40:29,010
enough or not much code with my

1071
00:40:29,010 --> 00:40:30,570
rudimentary Python skills surprisingly

1072
00:40:30,570 --> 00:40:32,730
enough turn the lines of code volatility

1073
00:40:32,730 --> 00:40:33,990
can kick out Jason which was like I

1074
00:40:33,990 --> 00:40:35,430
found that I was like ah fantastic that

1075
00:40:35,430 --> 00:40:36,870
means I can be coupled up fantastically

1076
00:40:36,870 --> 00:40:38,700
so I hooked it all up to Jenkins

1077
00:40:38,700 --> 00:40:40,710
so you know every time I push code it

1078
00:40:40,710 --> 00:40:43,470
goes and takes my Windows 7 BM I win 10

1079
00:40:43,470 --> 00:40:45,240
VM and all these VMs and fires them up

1080
00:40:45,240 --> 00:40:46,530
and checks everything works and then

1081
00:40:46,530 --> 00:40:48,510
 me out and then notifies me if

1082
00:40:48,510 --> 00:40:52,200
it stops working there and I did this

1083
00:40:52,200 --> 00:40:54,720
this was the big revelation I guess you

1084
00:40:54,720 --> 00:40:56,370
know I already knew so everything was

1085
00:40:56,370 --> 00:40:59,490
broken the main the so the other thing

1086
00:40:59,490 --> 00:41:01,200
I'm going to throw in really really

1087
00:41:01,200 --> 00:41:03,630
don't fast now how much my did to do 3

1088
00:41:03,630 --> 00:41:05,310
minutes 3 minutes how fast my getting 3

1089
00:41:05,310 --> 00:41:07,800
Mets so one thing I found having you the

1090
00:41:07,800 --> 00:41:09,450
people tests was invaluable during

1091
00:41:09,450 --> 00:41:11,370
development there was lots and lots of

1092
00:41:11,370 --> 00:41:14,790
making it work on windows server 2003

1093
00:41:14,790 --> 00:41:17,900
Service Pack 1 which wrote Windows Vista

1094
00:41:17,900 --> 00:41:21,810
such-and-such there was lots of that so

1095
00:41:21,810 --> 00:41:23,730
having having like a large amount of VM

1096
00:41:23,730 --> 00:41:26,010
snapshots oh I could just run my script

1097
00:41:26,010 --> 00:41:27,660
I'm like oh yes this works it doesn't

1098
00:41:27,660 --> 00:41:29,520
work invaluable so if you get a chance

1099
00:41:29,520 --> 00:41:31,920
to do that kind of thing right now main

1100
00:41:31,920 --> 00:41:33,600
culprits where's volatile time is

1101
00:41:33,600 --> 00:41:35,280
plug-in I don't I don't sound like I'm

1102
00:41:35,280 --> 00:41:37,260
crapping on bullets at least plug-in

1103
00:41:37,260 --> 00:41:38,220
here you know this this is the only

1104
00:41:38,220 --> 00:41:39,540
thing I've found that could tuck to go

1105
00:41:39,540 --> 00:41:42,360
talk about timers at all so for the

1106
00:41:42,360 --> 00:41:43,890
sillies timers plug-in absolutely

1107
00:41:43,890 --> 00:41:46,140
fantastic but it was broken on quite a

1108
00:41:46,140 --> 00:41:47,550
lot and that's because these date

1109
00:41:47,550 --> 00:41:49,410
structures as I alluded to earlier when

1110
00:41:49,410 --> 00:41:51,030
I said are there's no easy way of doing

1111
00:41:51,030 --> 00:41:52,770
this you know did these dates which

1112
00:41:52,770 --> 00:41:55,470
stage a lot like 2003 server you have a

1113
00:41:55,470 --> 00:41:58,430
list of 256k timers but

1114
00:41:58,430 --> 00:41:59,780
if you serve his packet then you

1115
00:41:59,780 --> 00:42:01,609
suddenly get 512 of them and they become

1116
00:42:01,609 --> 00:42:04,220
K time table entries right and then when

1117
00:42:04,220 --> 00:42:05,569
you're on win7 they're like hanging off

1118
00:42:05,569 --> 00:42:06,530
a piece yaar like like they're

1119
00:42:06,530 --> 00:42:08,839
completely different place so yeah this

1120
00:42:08,839 --> 00:42:11,059
stuff changes a lot so yeah this is when

1121
00:42:11,059 --> 00:42:12,319
Microsoft hanged me man

1122
00:42:12,319 --> 00:42:16,190
anyway it all works now definitely one

1123
00:42:16,190 --> 00:42:18,170
of the lines that my boss told me to put

1124
00:42:18,170 --> 00:42:19,790
in to impress our prospective clients

1125
00:42:19,790 --> 00:42:22,069
this is I say it all works and I'm going

1126
00:42:22,069 --> 00:42:23,599
to show you this table this this table

1127
00:42:23,599 --> 00:42:24,950
is actually kind of old it has been

1128
00:42:24,950 --> 00:42:26,690
updated since then but these are some of

1129
00:42:26,690 --> 00:42:28,280
the builds that I'm running on green

1130
00:42:28,280 --> 00:42:30,530
ticks means everything working question

1131
00:42:30,530 --> 00:42:32,390
mark means I haven't yet set up that

1132
00:42:32,390 --> 00:42:34,700
environments up these red cross is

1133
00:42:34,700 --> 00:42:37,040
interesting mean isn't working and this

1134
00:42:37,040 --> 00:42:38,990
led to one like instant revelation which

1135
00:42:38,990 --> 00:42:41,630
I felt just justified the whole the

1136
00:42:41,630 --> 00:42:43,730
whole whole QA process so I was like am

1137
00:42:43,730 --> 00:42:45,829
I being a bit too anal on this whole QA

1138
00:42:45,829 --> 00:42:48,319
thing but it turns out the POC itself

1139
00:42:48,319 --> 00:42:52,250
doesn't work on win7 and I was like huh

1140
00:42:52,250 --> 00:42:54,770
what how the guys are using it as a red

1141
00:42:54,770 --> 00:42:56,089
teamers and it doesn't work on win7

1142
00:42:56,089 --> 00:42:58,579
what's going on here well so I do need

1143
00:42:58,579 --> 00:43:00,170
to investigate it more I'm probably not

1144
00:43:00,170 --> 00:43:02,420
gonna get time but turns out they did

1145
00:43:02,420 --> 00:43:03,890
they're doing an infant infinite

1146
00:43:03,890 --> 00:43:05,839
interruptible sleep will return on win7

1147
00:43:05,839 --> 00:43:09,069
and didn't on anything else I don't know

1148
00:43:09,069 --> 00:43:11,750
iiiiii I don't know I mean maybe there

1149
00:43:11,750 --> 00:43:12,950
was something weird on my tears remember

1150
00:43:12,950 --> 00:43:14,780
yeah okay how many minutes we have left

1151
00:43:14,780 --> 00:43:17,299
to do and it's there oh yes like like

1152
00:43:17,299 --> 00:43:19,369
less than a minute okay really fast so

1153
00:43:19,369 --> 00:43:20,869
yeah got good test coverage need to add

1154
00:43:20,869 --> 00:43:24,020
more stuff yep it did earned it today so

1155
00:43:24,020 --> 00:43:25,910
yeah all the codes public check out our

1156
00:43:25,910 --> 00:43:28,160
blog post I'm foxy I don't have the URL

1157
00:43:28,160 --> 00:43:29,599
and even if I did it'll be too long for

1158
00:43:29,599 --> 00:43:31,760
to put on the slide height of when

1159
00:43:31,760 --> 00:43:33,500
people put long URLs on slides but if

1160
00:43:33,500 --> 00:43:34,940
you google for like Ali's Hammond

1161
00:43:34,940 --> 00:43:37,190
gargoyle can accept gargoyle that kind

1162
00:43:37,190 --> 00:43:37,609
of thing

1163
00:43:37,609 --> 00:43:39,770
you'll find it there is a big walk

1164
00:43:39,770 --> 00:43:41,930
through if you if you're trying to get

1165
00:43:41,930 --> 00:43:42,770
into kernel

1166
00:43:42,770 --> 00:43:44,990
like Windows kernel analysis you might

1167
00:43:44,990 --> 00:43:47,569
like it it's a windy bug and windy back

1168
00:43:47,569 --> 00:43:52,579
has a really kind of has a syntax I was

1169
00:43:52,579 --> 00:43:54,290
quite a learning curve but it's worth it

1170
00:43:54,290 --> 00:43:56,210
because when debug integrates so well in

1171
00:43:56,210 --> 00:43:59,869
so all the window stuff it's great the

1172
00:43:59,869 --> 00:44:02,660
time @py plugin is submit to volatility

1173
00:44:02,660 --> 00:44:06,200
and it's also on our blog oh and also a

1174
00:44:06,200 --> 00:44:08,000
quick showing off we also some

1175
00:44:08,000 --> 00:44:11,250
volatility to an annual plugin contest

1176
00:44:11,250 --> 00:44:12,810
where everyone submits their plug-ins

1177
00:44:12,810 --> 00:44:14,550
for how great their plug-in is and we've

1178
00:44:14,550 --> 00:44:16,200
submitted ours and we won it and I was

1179
00:44:16,200 --> 00:44:18,560
like yay

1180
00:44:18,980 --> 00:44:20,940
okay so have a very quick celebration

1181
00:44:20,940 --> 00:44:22,619
I'm saying so yeah we've got all this

1182
00:44:22,619 --> 00:44:24,510
testing subsystem going we can QA are

1183
00:44:24,510 --> 00:44:26,099
the volatility functionality because it

1184
00:44:26,099 --> 00:44:27,330
is just a script that checks the

1185
00:44:27,330 --> 00:44:29,040
volatility output so we can be like oh

1186
00:44:29,040 --> 00:44:31,530
does this work great yay comes update to

1187
00:44:31,530 --> 00:44:32,880
other projects we've got a load of all

1188
00:44:32,880 --> 00:44:35,070
these PM's we can analyze them I really

1189
00:44:35,070 --> 00:44:36,570
want to do more stuff with it I want to

1190
00:44:36,570 --> 00:44:38,520
get yeah I pay my bit of time for that

1191
00:44:38,520 --> 00:44:41,820
obviously big takeaway as everyone

1192
00:44:41,820 --> 00:44:44,130
should know but but maybe it doesn't

1193
00:44:44,130 --> 00:44:45,570
move as I should have known but didn't

1194
00:44:45,570 --> 00:44:47,369
relying on these on document such as is

1195
00:44:47,369 --> 00:44:49,740
risky it's too risky for live analysis

1196
00:44:49,740 --> 00:44:51,450
where you can't cut you can always catch

1197
00:44:51,450 --> 00:44:54,270
a kernel space access violation okay for

1198
00:44:54,270 --> 00:44:55,500
offline analysis but you still have to

1199
00:44:55,500 --> 00:44:57,720
be like SuperDuper the 10 to be very

1200
00:44:57,720 --> 00:44:59,070
careful and make sure everything works

1201
00:44:59,070 --> 00:45:02,119
they did they're almost done almost done

1202
00:45:02,119 --> 00:45:04,410
I'd like to get this going I'd like to

1203
00:45:04,410 --> 00:45:06,599
have the the Jenkins build twittering I

1204
00:45:06,599 --> 00:45:08,460
think I've got this running shortly

1205
00:45:08,460 --> 00:45:10,410
after I make this talk so I have a

1206
00:45:10,410 --> 00:45:13,230
Windows Update server and I have a

1207
00:45:13,230 --> 00:45:16,589
system that will that will be run a test

1208
00:45:16,589 --> 00:45:18,089
cycle every time that an update comes

1209
00:45:18,089 --> 00:45:19,230
down from Microsoft which is great

1210
00:45:19,230 --> 00:45:20,550
because then it might kick out a patch

1211
00:45:20,550 --> 00:45:22,650
that breaks my code I know about it as I

1212
00:45:22,650 --> 00:45:24,300
say I'm not real de Paul you real Deb's

1213
00:45:24,300 --> 00:45:26,310
in the audience I'd be like oh yes of

1214
00:45:26,310 --> 00:45:29,240
course we have 5 million of those I

1215
00:45:29,240 --> 00:45:32,430
don't I'm still doing I'll be frank I

1216
00:45:32,430 --> 00:45:34,470
need to further investigate lie

1217
00:45:34,470 --> 00:45:36,119
detection as I say I've got it running

1218
00:45:36,119 --> 00:45:37,950
but I'm a little bit scared to deploy on

1219
00:45:37,950 --> 00:45:39,540
anything because it's know deep in the

1220
00:45:39,540 --> 00:45:41,099
kernel and Microsoft will come and like

1221
00:45:41,099 --> 00:45:43,260
 me out also Microsoft will come

1222
00:45:43,260 --> 00:45:45,630
and justifiably be upset that I'm making

1223
00:45:45,630 --> 00:45:48,390
their OS crash a lot and they're getting

1224
00:45:48,390 --> 00:45:51,859
the blame for the out there yeah I

1225
00:45:51,859 --> 00:45:53,880
wanted to see what mitigation zitao's

1226
00:45:53,880 --> 00:45:55,890
team all the the attackers and our

1227
00:45:55,890 --> 00:45:57,240
company we could come up with because

1228
00:45:57,240 --> 00:45:59,640
the the the timer is a really integral

1229
00:45:59,640 --> 00:46:02,460
integral part of this attack it really

1230
00:46:02,460 --> 00:46:04,410
is a core of everything and I wanted to

1231
00:46:04,410 --> 00:46:05,820
see if we can take it out and do

1232
00:46:05,820 --> 00:46:06,510
something else

1233
00:46:06,510 --> 00:46:08,190
so I was like ok I was experimenting

1234
00:46:08,190 --> 00:46:09,780
with sockets that we could like start a

1235
00:46:09,780 --> 00:46:13,230
socket call and then our APC would fire

1236
00:46:13,230 --> 00:46:14,849
on failure time or something like that

1237
00:46:14,849 --> 00:46:17,220
and this was a juggernaut I didn't

1238
00:46:17,220 --> 00:46:18,660
really get anything working and then

1239
00:46:18,660 --> 00:46:22,520
yesterday I came into a talk

1240
00:46:22,520 --> 00:46:25,700
and this did this chap just like idly

1241
00:46:25,700 --> 00:46:27,110
drops oh yes this is a technique for

1242
00:46:27,110 --> 00:46:31,040
making files like taken an arbitrarily

1243
00:46:31,040 --> 00:46:32,810
long time I'm like holy crap that's

1244
00:46:32,810 --> 00:46:37,250
exactly what I need so yeah I'm gonna go

1245
00:46:37,250 --> 00:46:39,230
home and play with that another another

1246
00:46:39,230 --> 00:46:40,940
day because if I can make a fold we take

1247
00:46:40,940 --> 00:46:43,310
an arbitrarily long amount of time I can

1248
00:46:43,310 --> 00:46:46,100
hang my gargoyle code off it so the APC

1249
00:46:46,100 --> 00:46:48,410
completes everything gets executable

1250
00:46:48,410 --> 00:46:49,910
everything blows up there so I need to

1251
00:46:49,910 --> 00:46:53,570
play with that so and that's all I have

1252
00:46:53,570 --> 00:46:57,050
and all my I know in some happen Oh over

1253
00:46:57,050 --> 00:46:59,150
a little bit over any any any any easy

1254
00:46:59,150 --> 00:47:04,450
questions okay any difficult questions

1255
00:47:04,750 --> 00:47:10,860
yeah we good okay cool cool

1256
00:47:10,860 --> 00:47:15,889
[Applause]

