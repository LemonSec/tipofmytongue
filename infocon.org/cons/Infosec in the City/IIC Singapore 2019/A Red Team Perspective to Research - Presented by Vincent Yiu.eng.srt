1
00:00:00,030 --> 00:00:02,100
all right cool so hi everyone I'm gonna

2
00:00:02,100 --> 00:00:03,780
start a little bit early and though it's

3
00:00:03,780 --> 00:00:06,029
not quite half past yet but I've got

4
00:00:06,029 --> 00:00:07,680
quite a lot of content to go through and

5
00:00:07,680 --> 00:00:09,360
I wanted to make sure that we finish on

6
00:00:09,360 --> 00:00:13,440
time so I'm going to be talking about

7
00:00:13,440 --> 00:00:16,890
red team pepper buzzword but more

8
00:00:16,890 --> 00:00:18,180
specifically we wouldn't be talking

9
00:00:18,180 --> 00:00:21,090
about converting experiences and jobs

10
00:00:21,090 --> 00:00:23,340
and projects experiences that we've all

11
00:00:23,340 --> 00:00:26,550
gained from doing projects etc right and

12
00:00:26,550 --> 00:00:28,230
into tools that we can use in the

13
00:00:28,230 --> 00:00:31,199
industry as security professionals more

14
00:00:31,199 --> 00:00:32,850
specifically I think the tour title I

15
00:00:32,850 --> 00:00:35,520
gave was a perspective on you know

16
00:00:35,520 --> 00:00:37,680
research and from an offensive security

17
00:00:37,680 --> 00:00:38,160
perspective

18
00:00:38,160 --> 00:00:42,379
I'm Vincent you your speaker for today

19
00:00:42,500 --> 00:00:53,070
all right this isn't on okay we go all

20
00:00:53,070 --> 00:00:54,719
right so what's the talk about right

21
00:00:54,719 --> 00:00:58,680
it's about writing tools mainly but more

22
00:00:58,680 --> 00:01:00,270
specifically the reasoning behind

23
00:01:00,270 --> 00:01:03,719
writing tools right and the some of the

24
00:01:03,719 --> 00:01:05,700
ideas that I've had and the ways I come

25
00:01:05,700 --> 00:01:07,740
about having new ideas to do new types

26
00:01:07,740 --> 00:01:10,080
of research and the process I go through

27
00:01:10,080 --> 00:01:12,830
so it's to aim its aim to help people

28
00:01:12,830 --> 00:01:15,360
are looking to do research to understand

29
00:01:15,360 --> 00:01:17,670
the process I go through to make these

30
00:01:17,670 --> 00:01:19,710
tools happen and make my research happen

31
00:01:19,710 --> 00:01:21,840
and some of the results from the

32
00:01:21,840 --> 00:01:23,700
research that I've done and the benefits

33
00:01:23,700 --> 00:01:25,710
that we we can obtain from doing the

34
00:01:25,710 --> 00:01:27,780
research it's gonna be more about

35
00:01:27,780 --> 00:01:29,939
getting started in research to my

36
00:01:29,939 --> 00:01:31,350
specific journey to share that

37
00:01:31,350 --> 00:01:32,970
experience with you all so if you're

38
00:01:32,970 --> 00:01:34,500
interested in writing your own tools you

39
00:01:34,500 --> 00:01:36,060
can maybe learn adapt on some of my

40
00:01:36,060 --> 00:01:38,100
experiences to help yourself

41
00:01:38,100 --> 00:01:40,530
you know get started it's not a rock

42
00:01:40,530 --> 00:01:42,509
star talk it's no I don't have any zero

43
00:01:42,509 --> 00:01:46,170
days to share today but you know I hope

44
00:01:46,170 --> 00:01:47,880
that everyone can gain a bit of insight

45
00:01:47,880 --> 00:01:49,320
here because I've heard a lot of people

46
00:01:49,320 --> 00:01:51,240
in the industry where you know I always

47
00:01:51,240 --> 00:01:53,579
get questioned about hey I want to do

48
00:01:53,579 --> 00:01:54,990
some research where do I get started

49
00:01:54,990 --> 00:01:56,460
right I want to marry a new tool watch

50
00:01:56,460 --> 00:01:58,799
what can I do and this is aimed to help

51
00:01:58,799 --> 00:02:00,450
low tech there those people out there

52
00:02:00,450 --> 00:02:04,619
that I want to wanted to get started so

53
00:02:04,619 --> 00:02:06,299
first of all Who am I I'm Vincent you

54
00:02:06,299 --> 00:02:08,520
I'm a consultant at science security in

55
00:02:08,520 --> 00:02:11,459
Hong Kong we start around the year and a

56
00:02:11,459 --> 00:02:12,780
half ago now and

57
00:02:12,780 --> 00:02:14,280
I've got a bunch of certificates grass

58
00:02:14,280 --> 00:02:17,760
certified I've got osep oversee ECT PS

59
00:02:17,760 --> 00:02:19,800
quite recently because as a boy I play

60
00:02:19,800 --> 00:02:22,350
around with the labs on LinkedIn and

61
00:02:22,350 --> 00:02:24,390
Twitter as well so if you want to reach

62
00:02:24,390 --> 00:02:26,610
out viola channels to ask any questions

63
00:02:26,610 --> 00:02:31,260
I'm happy to chat with anyone as well so

64
00:02:31,260 --> 00:02:33,390
red teaming right it's become a buzzword

65
00:02:33,390 --> 00:02:35,550
all sales guys using it everyone talks

66
00:02:35,550 --> 00:02:39,390
about red teaming these days but yeah we

67
00:02:39,390 --> 00:02:41,310
use the word red teaming and it you know

68
00:02:41,310 --> 00:02:42,420
attract a lot of attention in the

69
00:02:42,420 --> 00:02:44,459
security industry well essentially I

70
00:02:44,459 --> 00:02:46,800
like to think of it as like when we do

71
00:02:46,800 --> 00:02:48,300
that red teaming engagement the whole

72
00:02:48,300 --> 00:02:50,130
idea is just to understand how well our

73
00:02:50,130 --> 00:02:51,750
security investments are doing right

74
00:02:51,750 --> 00:02:53,220
we've put a lot of money and time into

75
00:02:53,220 --> 00:02:54,750
implementing security in our

76
00:02:54,750 --> 00:02:56,880
organizations we want to understand you

77
00:02:56,880 --> 00:02:58,350
know how well are we doing where has it

78
00:02:58,350 --> 00:02:59,970
been its goal of protecting our

79
00:02:59,970 --> 00:03:02,250
organization or are we now more

80
00:03:02,250 --> 00:03:04,080
difficult to hack and there's the

81
00:03:04,080 --> 00:03:06,150
process of simulating the footsteps of

82
00:03:06,150 --> 00:03:06,750
an attacker

83
00:03:06,750 --> 00:03:09,510
we simply according to the cyber kill

84
00:03:09,510 --> 00:03:12,019
chain quite frequently nowadays and

85
00:03:12,019 --> 00:03:14,519
that's quite useful and as we'll see

86
00:03:14,519 --> 00:03:16,500
later on in the talk as to how I select

87
00:03:16,500 --> 00:03:19,920
my types of research to do and the

88
00:03:19,920 --> 00:03:21,630
result would be to learn you know from a

89
00:03:21,630 --> 00:03:22,890
back of a red team would be to know the

90
00:03:22,890 --> 00:03:24,959
strengths and weaknesses of your

91
00:03:24,959 --> 00:03:26,640
organization when defending against the

92
00:03:26,640 --> 00:03:28,829
unknown because if you're always

93
00:03:28,829 --> 00:03:30,000
defending against things that you know

94
00:03:30,000 --> 00:03:31,350
about then how do you know you can

95
00:03:31,350 --> 00:03:32,700
defend something against something like

96
00:03:32,700 --> 00:03:35,160
you haven't met before and it's aim to

97
00:03:35,160 --> 00:03:38,880
address those types of concerns so we

98
00:03:38,880 --> 00:03:41,820
need tools and research everywhere I say

99
00:03:41,820 --> 00:03:43,650
red teaming here it's not just specific

100
00:03:43,650 --> 00:03:45,359
to red teaming right so if we're red

101
00:03:45,359 --> 00:03:46,590
teaming a car from this perspective

102
00:03:46,590 --> 00:03:47,880
right we're trying to break into this

103
00:03:47,880 --> 00:03:49,859
car we might look at different aspects

104
00:03:49,859 --> 00:03:51,570
right like the wheels for example or the

105
00:03:51,570 --> 00:03:54,000
window or the headlights or even the

106
00:03:54,000 --> 00:03:55,590
cloud abyss connected to the cloud in

107
00:03:55,590 --> 00:03:57,090
some way all the internet right

108
00:03:57,090 --> 00:03:58,920
we might even look at the driver or

109
00:03:58,920 --> 00:04:00,299
someone let's do maintenance on the

110
00:04:00,299 --> 00:04:01,890
character we might rank it in that way

111
00:04:01,890 --> 00:04:04,260
through other avenues and then I see

112
00:04:04,260 --> 00:04:07,410
pentesting was more like looking at just

113
00:04:07,410 --> 00:04:09,209
the wheels right but in more detail in

114
00:04:09,209 --> 00:04:13,410
more sophistication but you know there's

115
00:04:13,410 --> 00:04:15,030
benefits to both approaches and the red

116
00:04:15,030 --> 00:04:16,709
team approach and I've always been able

117
00:04:16,709 --> 00:04:18,269
to see more you know from a

118
00:04:18,269 --> 00:04:20,940
outside-the-box perspective and from a

119
00:04:20,940 --> 00:04:22,800
penetration testing perspective of being

120
00:04:22,800 --> 00:04:24,930
able to look at specific components in

121
00:04:24,930 --> 00:04:26,180
more detail

122
00:04:26,180 --> 00:04:29,330
- but the the takeaway from these slides

123
00:04:29,330 --> 00:04:32,120
are basically regardless of what your

124
00:04:32,120 --> 00:04:33,800
day-to-day role is and what types of

125
00:04:33,800 --> 00:04:36,259
exposure you get in the security

126
00:04:36,259 --> 00:04:38,780
industry there are areas where you can

127
00:04:38,780 --> 00:04:40,580
always contribute in with your own

128
00:04:40,580 --> 00:04:42,169
research and with writing your own tools

129
00:04:42,169 --> 00:04:43,940
and and you know it will benefit

130
00:04:43,940 --> 00:04:47,720
everyone everyone else as well so in my

131
00:04:47,720 --> 00:04:50,360
opinion there's the following types of

132
00:04:50,360 --> 00:04:51,949
research you know it's like the rock

133
00:04:51,949 --> 00:04:53,990
star level where people finding O'Day is

134
00:04:53,990 --> 00:04:55,729
fuzzing and all of that good stuff

135
00:04:55,729 --> 00:04:58,070
finding CV ease all the deep tech stuff

136
00:04:58,070 --> 00:04:59,330
I'm not going to be talking about what

137
00:04:59,330 --> 00:05:00,949
as much in this talk I'm going to try

138
00:05:00,949 --> 00:05:02,449
and focus on more of like the ad hoc

139
00:05:02,449 --> 00:05:04,789
research type stuff you know we find the

140
00:05:04,789 --> 00:05:06,410
new area like we're interested in we

141
00:05:06,410 --> 00:05:08,210
want to quickly see whether we can

142
00:05:08,210 --> 00:05:09,680
leverage something from that new area of

143
00:05:09,680 --> 00:05:12,470
research or developing tools fill out

144
00:05:12,470 --> 00:05:14,270
research as well so I'll be focusing

145
00:05:14,270 --> 00:05:20,030
more on the latter two so the tools are

146
00:05:20,030 --> 00:05:22,370
really important regardless of what your

147
00:05:22,370 --> 00:05:24,949
role is or what profession you're in you

148
00:05:24,949 --> 00:05:27,050
know if I if my laptop broke today and I

149
00:05:27,050 --> 00:05:28,880
needed to take it apart to you know

150
00:05:28,880 --> 00:05:30,860
start looking at the internals this try

151
00:05:30,860 --> 00:05:33,680
and fix it you know I could open up the

152
00:05:33,680 --> 00:05:35,599
case in a number of ways where I could

153
00:05:35,599 --> 00:05:37,310
get hammer and smash it open but let my

154
00:05:37,310 --> 00:05:38,780
laptop won't look very good right

155
00:05:38,780 --> 00:05:41,150
afterwards or I can actually choose a

156
00:05:41,150 --> 00:05:43,610
screwdriver that's designed for the task

157
00:05:43,610 --> 00:05:47,180
at hand and I think the takeaway is when

158
00:05:47,180 --> 00:05:49,460
we have more tools we can make it more

159
00:05:49,460 --> 00:05:51,440
consistent the way we do things and we

160
00:05:51,440 --> 00:05:53,990
can also you know we can professionalize

161
00:05:53,990 --> 00:05:55,789
the way we do things and make sure that

162
00:05:55,789 --> 00:05:58,009
we're less prone to mistakes where we

163
00:05:58,009 --> 00:05:59,509
make the task get a lot more efficient

164
00:05:59,509 --> 00:06:03,860
and easier to to complete and so before

165
00:06:03,860 --> 00:06:06,349
we had Salter this is an example of one

166
00:06:06,349 --> 00:06:08,560
of the tools I wrote a couple years ago

167
00:06:08,560 --> 00:06:11,870
so we know there's like a PowerShell

168
00:06:11,870 --> 00:06:14,509
command for example the top here we know

169
00:06:14,509 --> 00:06:16,310
this is quite easily detectable by

170
00:06:16,310 --> 00:06:19,669
antivirus right and back in the day when

171
00:06:19,669 --> 00:06:22,849
we wanted to change up and break

172
00:06:22,849 --> 00:06:25,190
signatures in instance static files we

173
00:06:25,190 --> 00:06:26,690
had to and start off the skate in the

174
00:06:26,690 --> 00:06:29,599
text etc and maybe every time we had to

175
00:06:29,599 --> 00:06:31,430
make a new payload we'd go and edit the

176
00:06:31,430 --> 00:06:34,130
text manually or even script up elements

177
00:06:34,130 --> 00:06:35,960
of it and we'd have something quite

178
00:06:35,960 --> 00:06:38,120
simple and but it'll do the job right

179
00:06:38,120 --> 00:06:38,689
it's a

180
00:06:38,689 --> 00:06:42,289
fix it or work and then after we created

181
00:06:42,289 --> 00:06:44,239
tools all we had to do was run one tool

182
00:06:44,239 --> 00:06:45,739
against that code and then we'll have a

183
00:06:45,739 --> 00:06:47,809
new output every time and it'll be

184
00:06:47,809 --> 00:06:49,459
consistent I'll be less prone to

185
00:06:49,459 --> 00:06:51,469
mistakes I'll have less syntax errors

186
00:06:51,469 --> 00:06:53,299
for example and my code will still work

187
00:06:53,299 --> 00:06:57,199
and it will do the job and it's tried

188
00:06:57,199 --> 00:06:59,569
and tested too it works every time and I

189
00:06:59,569 --> 00:07:01,099
can add additional complex features

190
00:07:01,099 --> 00:07:03,739
which I'll show in a bit as well but

191
00:07:03,739 --> 00:07:06,379
before we go into I want to go over you

192
00:07:06,379 --> 00:07:09,469
know so how do I actually decide what I

193
00:07:09,469 --> 00:07:11,089
want to research right and what to

194
00:07:11,089 --> 00:07:14,689
research one way I do it is by looking

195
00:07:14,689 --> 00:07:16,579
at the cyber kill chain so when doing

196
00:07:16,579 --> 00:07:18,769
like a Red Team engagement it's like the

197
00:07:18,769 --> 00:07:20,199
reconnaissance varies weaponization

198
00:07:20,199 --> 00:07:22,639
exploitation you know whether it's

199
00:07:22,639 --> 00:07:24,469
persistence and then you know actual

200
00:07:24,469 --> 00:07:27,469
movement in the organization or actions

201
00:07:27,469 --> 00:07:29,719
and objectives a bit more and target

202
00:07:29,719 --> 00:07:32,539
specific in those cases but I've always

203
00:07:32,539 --> 00:07:34,789
focused more on the earlier stages so

204
00:07:34,789 --> 00:07:36,139
the reconnaissance and weaponization in

205
00:07:36,139 --> 00:07:38,059
command and control phases I've written

206
00:07:38,059 --> 00:07:40,729
tools I Dom linked linked into my in for

207
00:07:40,729 --> 00:07:42,679
reconnaissance of doing a weaponization

208
00:07:42,679 --> 00:07:45,079
bit shoot like cactus or morph HD and

209
00:07:45,079 --> 00:07:47,419
weaponized so cactus torch was based off

210
00:07:47,419 --> 00:07:48,919
from James for tools and research

211
00:07:48,919 --> 00:07:51,409
previously which I tried to make work

212
00:07:51,409 --> 00:07:52,999
and we can use it as like implants and

213
00:07:52,999 --> 00:07:57,499
payload commanding control you know

214
00:07:57,499 --> 00:07:58,699
around domain fronting or subdomain

215
00:07:58,699 --> 00:08:01,069
takeovers so I pick things like quiet

216
00:08:01,069 --> 00:08:02,959
I know that I can apply straightaway

217
00:08:02,959 --> 00:08:06,289
into my day-to-day job and that's how I

218
00:08:06,289 --> 00:08:08,779
pick research so it's a pretty good way

219
00:08:08,779 --> 00:08:10,789
to if you're designing on some into

220
00:08:10,789 --> 00:08:12,769
research you can pick a specific step in

221
00:08:12,769 --> 00:08:13,879
the cyber kill chain and then find

222
00:08:13,879 --> 00:08:15,289
something that might interest you that

223
00:08:15,289 --> 00:08:19,969
you can look into I'm from a penetration

224
00:08:19,969 --> 00:08:22,309
testing perspective you know I've done a

225
00:08:22,309 --> 00:08:24,439
whole bunch of things as well this isn't

226
00:08:24,439 --> 00:08:27,979
very specific but if you are doing a pen

227
00:08:27,979 --> 00:08:29,919
test for example on a specific

228
00:08:29,919 --> 00:08:33,679
technology or web application right you

229
00:08:33,679 --> 00:08:36,229
might be doing you know one of the

230
00:08:36,229 --> 00:08:38,269
vendors outside even in the technology

231
00:08:38,269 --> 00:08:40,578
boots right if you do in their web

232
00:08:40,578 --> 00:08:42,019
application you might find specific

233
00:08:42,019 --> 00:08:44,179
vulnerabilities or even let's say you

234
00:08:44,179 --> 00:08:45,860
finally use an enumeration book that's

235
00:08:45,860 --> 00:08:47,689
time-based right and so you put in the

236
00:08:47,689 --> 00:08:49,189
username and it you know there's a

237
00:08:49,189 --> 00:08:51,290
different delay time if the username is

238
00:08:51,290 --> 00:08:52,340
correct or incorrect

239
00:08:52,340 --> 00:08:53,840
you can write up a tool that can do a

240
00:08:53,840 --> 00:08:55,430
lot for that specific technology wrote

241
00:08:55,430 --> 00:08:58,100
and you can make like repeatable every

242
00:08:58,100 --> 00:08:59,660
time and you can share that tool and

243
00:08:59,660 --> 00:09:01,070
then everyone else can have that

244
00:09:01,070 --> 00:09:02,960
repeatable effects and we can enumerate

245
00:09:02,960 --> 00:09:05,300
user names from application and it's

246
00:09:05,300 --> 00:09:07,580
about you know applying and finding

247
00:09:07,580 --> 00:09:09,200
areas that you can write a quick tool

248
00:09:09,200 --> 00:09:11,860
for in your specific area of research or

249
00:09:11,860 --> 00:09:16,580
day to day roles I think and I never

250
00:09:16,580 --> 00:09:18,200
think I hear quite a lot when that you

251
00:09:18,200 --> 00:09:19,460
know so someone's come to me and they're

252
00:09:19,460 --> 00:09:21,380
asking hey what area of research can I

253
00:09:21,380 --> 00:09:23,240
do I give him some idea and then they're

254
00:09:23,240 --> 00:09:25,400
like hey I'm not a developer sure I'm

255
00:09:25,400 --> 00:09:26,990
not a developer I try and shy away from

256
00:09:26,990 --> 00:09:29,330
it as well and you know I'm not a great

257
00:09:29,330 --> 00:09:31,670
coder for example so a lot of my code is

258
00:09:31,670 --> 00:09:34,610
just patched together it works it's not

259
00:09:34,610 --> 00:09:36,440
beautiful code I'm not the best Python

260
00:09:36,440 --> 00:09:37,460
programmer in the world

261
00:09:37,460 --> 00:09:39,110
you know I patch it all together and it

262
00:09:39,110 --> 00:09:42,490
worked people give new code updates and

263
00:09:42,490 --> 00:09:44,750
official optimize my code for example

264
00:09:44,750 --> 00:09:47,540
and that's because I share my code out

265
00:09:47,540 --> 00:09:49,520
there and people are get other sets of

266
00:09:49,520 --> 00:09:52,250
eyes and people can contribute so like I

267
00:09:52,250 --> 00:09:53,990
said but if the code is somewhat

268
00:09:53,990 --> 00:09:55,760
readable if you make it somewhat

269
00:09:55,760 --> 00:09:57,050
documented and readable and

270
00:09:57,050 --> 00:09:58,730
understandable people will actually

271
00:09:58,730 --> 00:10:00,470
contribute to your code that you push

272
00:10:00,470 --> 00:10:02,810
out and they'll keep it up to date a

273
00:10:02,810 --> 00:10:06,110
little add new features etc but more

274
00:10:06,110 --> 00:10:07,790
importantly keeping it up to date as

275
00:10:07,790 --> 00:10:09,350
we'll see with one of the tools that I

276
00:10:09,350 --> 00:10:11,120
wrote the login process broke quite

277
00:10:11,120 --> 00:10:13,520
recently and the community decided to

278
00:10:13,520 --> 00:10:17,930
submit fixes quite useful a quick quick

279
00:10:17,930 --> 00:10:19,610
slide just to break it off a little bit

280
00:10:19,610 --> 00:10:23,060
for me oh thank you I'm plugging the USB

281
00:10:23,060 --> 00:10:28,310
into my own device okay right nothing

282
00:10:28,310 --> 00:10:31,910
everything all right cool so just to

283
00:10:31,910 --> 00:10:33,380
break off the slides a little bit for

284
00:10:33,380 --> 00:10:34,640
the rest of the talk I'm going to go

285
00:10:34,640 --> 00:10:36,290
over a few case studies of tools I've

286
00:10:36,290 --> 00:10:38,150
written in the past I'll go over the

287
00:10:38,150 --> 00:10:40,250
sort of idea as to why I chose that

288
00:10:40,250 --> 00:10:42,170
piece of research and how I went about

289
00:10:42,170 --> 00:10:44,360
doing it and the process behind it and

290
00:10:44,360 --> 00:10:46,340
the some of the results and benefits we

291
00:10:46,340 --> 00:10:48,820
gained from it

292
00:10:49,070 --> 00:10:52,370
so morph HDA that has anyone seen this

293
00:10:52,370 --> 00:10:55,970
tool before or used it before right if

294
00:10:55,970 --> 00:10:58,430
not I'll go over it now anyways but yeah

295
00:10:58,430 --> 00:11:00,110
more fish tear was a tool I wrote a

296
00:11:00,110 --> 00:11:02,120
couple of years ago because I hid the

297
00:11:02,120 --> 00:11:04,580
idea where they say files are actually

298
00:11:04,580 --> 00:11:05,690
used why

299
00:11:05,690 --> 00:11:08,990
often for infecting machines as a

300
00:11:08,990 --> 00:11:11,210
malware infection vector so HTML

301
00:11:11,210 --> 00:11:15,620
applications can run JavaScript vbscript

302
00:11:15,620 --> 00:11:18,410
etc inside these fouls and it's a

303
00:11:18,410 --> 00:11:20,540
commonly used vector a lot of people use

304
00:11:20,540 --> 00:11:21,860
it you might generate it for our

305
00:11:21,860 --> 00:11:24,500
Metasploit for example or a couple

306
00:11:24,500 --> 00:11:25,870
strike three and work back cetera

307
00:11:25,870 --> 00:11:27,860
there's a variety of ways to get these

308
00:11:27,860 --> 00:11:30,350
payload cells but the thing is it's in

309
00:11:30,350 --> 00:11:32,720
the public space for it so a lot of

310
00:11:32,720 --> 00:11:34,730
defenders will be writing signatures for

311
00:11:34,730 --> 00:11:35,960
these things right really dumb

312
00:11:35,960 --> 00:11:37,340
signatures what might just find the word

313
00:11:37,340 --> 00:11:39,620
PowerShell with like VB script in the

314
00:11:39,620 --> 00:11:41,740
same file right that sort of thing but

315
00:11:41,740 --> 00:11:44,570
what we what I found was like we know

316
00:11:44,570 --> 00:11:46,790
there's a common way to fix this issue

317
00:11:46,790 --> 00:11:48,380
but I just obfuscating the strings

318
00:11:48,380 --> 00:11:51,470
within that file but when your other

319
00:11:51,470 --> 00:11:53,660
Skating strings in that file like I said

320
00:11:53,660 --> 00:11:55,250
before if you're going into the file

321
00:11:55,250 --> 00:11:56,960
every time and trying to change up the

322
00:11:56,960 --> 00:12:00,350
code or you know just tight pack code

323
00:12:00,350 --> 00:12:02,930
yourself and mess mess with it a little

324
00:12:02,930 --> 00:12:05,030
bit it gets really complicated and

325
00:12:05,030 --> 00:12:06,650
you're more prone to errors you know it

326
00:12:06,650 --> 00:12:08,630
can break if you're you know you have to

327
00:12:08,630 --> 00:12:10,160
test it every code change sort of thing

328
00:12:10,160 --> 00:12:12,620
and it might be six months later before

329
00:12:12,620 --> 00:12:14,420
you have to do another payload right or

330
00:12:14,420 --> 00:12:16,310
even a year later and you don't remember

331
00:12:16,310 --> 00:12:17,840
that syntax and you have to go back to

332
00:12:17,840 --> 00:12:20,000
VB script syntax you know it's a dot or

333
00:12:20,000 --> 00:12:22,100
a plus or a or a ton symbol to

334
00:12:22,100 --> 00:12:23,660
concatenate strings that type of thing

335
00:12:23,660 --> 00:12:25,550
and you might not necessarily want to be

336
00:12:25,550 --> 00:12:26,840
fiddling with that when you're on an

337
00:12:26,840 --> 00:12:31,730
engagement and the time pressure so you

338
00:12:31,730 --> 00:12:33,320
know like I said it's time consuming to

339
00:12:33,320 --> 00:12:35,690
do and also humans are not really good

340
00:12:35,690 --> 00:12:38,210
at being random right I can keep copying

341
00:12:38,210 --> 00:12:40,220
pasting the same command to you know add

342
00:12:40,220 --> 00:12:42,620
more in the in the file but I'm not good

343
00:12:42,620 --> 00:12:45,410
at being random at all and a computer

344
00:12:45,410 --> 00:12:47,650
can just randomly generate this for me

345
00:12:47,650 --> 00:12:50,690
and I can have custom obfuscation per

346
00:12:50,690 --> 00:12:52,700
campaign if I'm doing a whole bunch of

347
00:12:52,700 --> 00:12:54,650
phishing campaigns and I could generate

348
00:12:54,650 --> 00:12:56,780
you know maybe 50 payloads if I want to

349
00:12:56,780 --> 00:12:59,000
send everyone else's every single person

350
00:12:59,000 --> 00:13:01,640
different payload for example and I can

351
00:13:01,640 --> 00:13:03,770
add fake code paths you know I can add

352
00:13:03,770 --> 00:13:06,260
benign code that can just make it a lot

353
00:13:06,260 --> 00:13:07,670
bit more difficult to read than

354
00:13:07,670 --> 00:13:09,980
different code streams so if someone's

355
00:13:09,980 --> 00:13:11,870
trying to step through the code it gets

356
00:13:11,870 --> 00:13:15,920
a lot more difficult for them so if

357
00:13:15,920 --> 00:13:17,030
you're a bit lost right now

358
00:13:17,030 --> 00:13:19,640
the key takeaway is you know

359
00:13:19,640 --> 00:13:21,320
this was just a few days ago when I scan

360
00:13:21,320 --> 00:13:22,910
this just to make sure and see what it

361
00:13:22,910 --> 00:13:25,820
looks like nowadays but you know before

362
00:13:25,820 --> 00:13:28,160
before you do any obfuscation whatsoever

363
00:13:28,160 --> 00:13:29,959
it's 26 engines we'll find the static

364
00:13:29,959 --> 00:13:31,640
strings in the in the script or it

365
00:13:31,640 --> 00:13:33,350
that's about half of the virus all

366
00:13:33,350 --> 00:13:36,589
engines but immediately if there's no

367
00:13:36,589 --> 00:13:38,060
Sun boxing well you just don't wait for

368
00:13:38,060 --> 00:13:40,970
the Sun box to work yet but there's

369
00:13:40,970 --> 00:13:42,769
around two detections on virus talk

370
00:13:42,769 --> 00:13:44,510
after the processing get through the

371
00:13:44,510 --> 00:13:47,870
tool three is later since I wrote the

372
00:13:47,870 --> 00:13:49,190
tool so I wrote it around three years

373
00:13:49,190 --> 00:13:51,649
ago and at that time it was zero

374
00:13:51,649 --> 00:13:53,329
detections and now it's two so you know

375
00:13:53,329 --> 00:13:55,700
pretty good after three years it's still

376
00:13:55,700 --> 00:13:57,860
not very detected and it's still usable

377
00:13:57,860 --> 00:13:59,959
so it's not like the tools gone out now

378
00:13:59,959 --> 00:14:01,570
right you can't use it at all

379
00:14:01,570 --> 00:14:03,769
so there is a long term benefit of

380
00:14:03,769 --> 00:14:07,250
writing tools as well it's actually

381
00:14:07,250 --> 00:14:08,690
simpler than you might think right you

382
00:14:08,690 --> 00:14:10,579
might look at a tool and I've had people

383
00:14:10,579 --> 00:14:13,820
ask this in candidate interviews as well

384
00:14:13,820 --> 00:14:15,050
all right have you heard of the tool

385
00:14:15,050 --> 00:14:17,510
morph HDA how does it work right can you

386
00:14:17,510 --> 00:14:18,829
explain how it works how was it

387
00:14:18,829 --> 00:14:21,529
bypassing a TV and is actually simpler

388
00:14:21,529 --> 00:14:24,290
than you might think it's like four

389
00:14:24,290 --> 00:14:26,329
steps pretty much the first steps to

390
00:14:26,329 --> 00:14:28,699
read the file in the payload in and then

391
00:14:28,699 --> 00:14:30,620
pass the text of interest list different

392
00:14:30,620 --> 00:14:32,480
sections within the file and then just

393
00:14:32,480 --> 00:14:34,810
process the text transform the text

394
00:14:34,810 --> 00:14:37,550
change the code up and then just write

395
00:14:37,550 --> 00:14:39,320
it back out as a foul you know it's just

396
00:14:39,320 --> 00:14:41,540
the simple weed process a little bit and

397
00:14:41,540 --> 00:14:44,300
write the file it's a lot more simple

398
00:14:44,300 --> 00:14:46,459
and learn you know some people make it

399
00:14:46,459 --> 00:14:49,339
out to be but if you're lost his is a

400
00:14:49,339 --> 00:14:50,990
quick demo just to see what the tool

401
00:14:50,990 --> 00:14:57,170
does so this is the morph hdthe all is

402
00:14:57,170 --> 00:15:07,390
it gonna start or maybe it's starting

403
00:15:16,210 --> 00:15:18,500
okay there we go yeah there's a bit of a

404
00:15:18,500 --> 00:15:20,270
delay so you know we begin by just

405
00:15:20,270 --> 00:15:22,310
generating HTML applications straight

406
00:15:22,310 --> 00:15:24,740
out of COBOL stroke detected by I pretty

407
00:15:24,740 --> 00:15:27,290
much and a lot of antivirus engines like

408
00:15:27,290 --> 00:15:31,550
I said before 26 out of 52 it's still

409
00:15:31,550 --> 00:15:33,170
pretty good I suppose and you can still

410
00:15:33,170 --> 00:15:35,810
bypass something's but majority like

411
00:15:35,810 --> 00:15:39,170
people are using semantic or McAfee etc

412
00:15:39,170 --> 00:15:41,270
learn you want to bypass a lot here I

413
00:15:41,270 --> 00:15:44,000
run morph HDA with the Explorer mode so

414
00:15:44,000 --> 00:15:45,800
this is another mode that I implemented

415
00:15:45,800 --> 00:15:49,430
because our a default Pichet files born

416
00:15:49,430 --> 00:15:51,920
out of a HTML application container

417
00:15:51,920 --> 00:15:54,770
where if you see like running powershell

418
00:15:54,770 --> 00:15:56,300
that might be suspicious right you can

419
00:15:56,300 --> 00:15:59,150
find my insists this mom for example and

420
00:15:59,150 --> 00:16:01,220
learn the process spawn chain but here

421
00:16:01,220 --> 00:16:04,070
it makes it spawned out of explorer now

422
00:16:04,070 --> 00:16:05,300
after reading the tour get a whole bunch

423
00:16:05,300 --> 00:16:07,160
of office gated code and it writes it

424
00:16:07,160 --> 00:16:09,680
out to pound out hitched here and here

425
00:16:09,680 --> 00:16:11,510
I'm just comparing the payloads a little

426
00:16:11,510 --> 00:16:13,100
bit so previously you could see words

427
00:16:13,100 --> 00:16:14,840
like W script got shell and PowerShell

428
00:16:14,840 --> 00:16:17,810
so immediate flags to a defender and you

429
00:16:17,810 --> 00:16:19,220
can immediately see oh it's a PowerShell

430
00:16:19,220 --> 00:16:21,770
payload but if we generate this then it

431
00:16:21,770 --> 00:16:23,180
gives the defender a little bit more

432
00:16:23,180 --> 00:16:24,530
work to play with they might have the

433
00:16:24,530 --> 00:16:25,880
Sun box it to find out where its

434
00:16:25,880 --> 00:16:27,800
connecting out to you know what is it

435
00:16:27,800 --> 00:16:29,210
it's a PowerShell payload what is it

436
00:16:29,210 --> 00:16:30,800
right and they can do a bit more

437
00:16:30,800 --> 00:16:34,310
analysis it gives a it gives the blue

438
00:16:34,310 --> 00:16:36,980
team a bit more work to play with if

439
00:16:36,980 --> 00:16:39,220
you're doing it in a simulator the top

440
00:16:39,220 --> 00:16:42,470
and most important of all after you do

441
00:16:42,470 --> 00:16:43,670
all of the processing you have to still

442
00:16:43,670 --> 00:16:45,620
make sure the payload works right so I'm

443
00:16:45,620 --> 00:16:47,540
just gonna bring it in this unboxer just

444
00:16:47,540 --> 00:16:49,700
to make sure like it's still running and

445
00:16:49,700 --> 00:16:53,950
I still have the full payload working

446
00:16:54,880 --> 00:16:56,600
waiting for the Sun watts to get

447
00:16:56,600 --> 00:16:57,920
infected it takes a little while the

448
00:16:57,920 --> 00:16:59,450
internet was quite slow in the hotel

449
00:16:59,450 --> 00:17:04,460
when I was recording this but yeah we've

450
00:17:04,460 --> 00:17:07,250
got 2 or AC 2 and you know it's around

451
00:17:07,250 --> 00:17:09,290
twenty twelve megabyte file it converted

452
00:17:09,290 --> 00:17:11,390
it from around you know maybe like 50

453
00:17:11,390 --> 00:17:13,880
kilobyte 50 bytes or something even IV

454
00:17:13,880 --> 00:17:17,510
know how long it was but but yeah it

455
00:17:17,510 --> 00:17:19,189
you know it's had loads of fake code

456
00:17:19,189 --> 00:17:21,980
streams changed up the text you know

457
00:17:21,980 --> 00:17:25,160
added arithmetic expressions etc just to

458
00:17:25,160 --> 00:17:29,360
you know mess with a AVL but so the sort

459
00:17:29,360 --> 00:17:30,679
of like key benefits from this tool I

460
00:17:30,679 --> 00:17:32,450
wrote where it was what we can now

461
00:17:32,450 --> 00:17:34,309
reduce the time needed to obfuscate

462
00:17:34,309 --> 00:17:37,160
these payloads if I needed to make fifty

463
00:17:37,160 --> 00:17:38,929
or if I wanted to make a hundred even

464
00:17:38,929 --> 00:17:40,490
because every single target I'm

465
00:17:40,490 --> 00:17:42,110
targeting I want to give him a little

466
00:17:42,110 --> 00:17:44,000
specific instance of a payload so it

467
00:17:44,000 --> 00:17:46,100
looks completely different then I can do

468
00:17:46,100 --> 00:17:48,410
a lot now as well I don't have to spend

469
00:17:48,410 --> 00:17:50,720
half an hour doing it manually and the

470
00:17:50,720 --> 00:17:52,520
complexity and sophistication of these

471
00:17:52,520 --> 00:17:53,960
payloads have increased right like

472
00:17:53,960 --> 00:17:55,460
before the blue team could have just

473
00:17:55,460 --> 00:17:57,320
looked at the script and saw that

474
00:17:57,320 --> 00:17:58,669
PowerShell command and they knew all

475
00:17:58,669 --> 00:17:59,840
right is PowerShell can write it in the

476
00:17:59,840 --> 00:18:01,880
report now for the incident response but

477
00:18:01,880 --> 00:18:03,380
now they have to do a little bit more

478
00:18:03,380 --> 00:18:05,330
maybe you have to run it in a sandbox we

479
00:18:05,330 --> 00:18:07,370
look at in Wireshark or actually try and

480
00:18:07,370 --> 00:18:08,990
find write a script to pass through the

481
00:18:08,990 --> 00:18:11,030
obfuscation so you know it adds a bit

482
00:18:11,030 --> 00:18:13,220
more skill so they have to do a bit more

483
00:18:13,220 --> 00:18:15,350
of an exercise when fighting against

484
00:18:15,350 --> 00:18:17,120
these types of payloads in a attack

485
00:18:17,120 --> 00:18:19,580
simulation so we're increasing the sort

486
00:18:19,580 --> 00:18:21,970
of like value for our customers as well

487
00:18:21,970 --> 00:18:26,059
all right onto the second talk so the

488
00:18:26,059 --> 00:18:28,429
second talk I wrote was a I'm going to

489
00:18:28,429 --> 00:18:30,679
talk about is LinkedIn and my int so we

490
00:18:30,679 --> 00:18:32,660
know in a lot of attack simulation

491
00:18:32,660 --> 00:18:34,960
engagements we do fishing right and

492
00:18:34,960 --> 00:18:37,790
fishing is one way that we know a lot of

493
00:18:37,790 --> 00:18:38,990
adversaries are breaking into

494
00:18:38,990 --> 00:18:42,500
organizations we've always been getting

495
00:18:42,500 --> 00:18:45,200
employee names and details from social

496
00:18:45,200 --> 00:18:48,770
media like LinkedIn in since moving to

497
00:18:48,770 --> 00:18:51,770
Hong Kong and the mainland China area

498
00:18:51,770 --> 00:18:54,290
I've realized what a lot of people don't

499
00:18:54,290 --> 00:18:56,270
actually use LinkedIn they use another

500
00:18:56,270 --> 00:18:58,190
social media that's mobile based called

501
00:18:58,190 --> 00:19:01,340
my mine and so I've written tools for

502
00:19:01,340 --> 00:19:04,220
both of these types of sort of social

503
00:19:04,220 --> 00:19:06,290
media platforms so I can target you know

504
00:19:06,290 --> 00:19:09,919
more people and get names for more

505
00:19:09,919 --> 00:19:13,010
employees so layers myself like

506
00:19:13,010 --> 00:19:14,320
injection points to where I did this

507
00:19:14,320 --> 00:19:17,380
sort of research and made this tool and

508
00:19:17,380 --> 00:19:20,720
actually previously you know when we

509
00:19:20,720 --> 00:19:22,190
wanted to do lists we might have to fire

510
00:19:22,190 --> 00:19:24,350
up burp for example and then go through

511
00:19:24,350 --> 00:19:26,000
Google and then loop through pages and

512
00:19:26,000 --> 00:19:28,130
next Rapids and then you know pass a

513
00:19:28,130 --> 00:19:30,770
little bit or go through LinkedIn and do

514
00:19:30,770 --> 00:19:30,970
the

515
00:19:30,970 --> 00:19:33,100
you know it was it was a bit of a hacky

516
00:19:33,100 --> 00:19:37,240
process but actually LinkedIn is a lot

517
00:19:37,240 --> 00:19:38,710
more simpler than you might think once

518
00:19:38,710 --> 00:19:42,429
again it's it's it's a Python script it

519
00:19:42,429 --> 00:19:44,799
basically connects to LinkedIn logged in

520
00:19:44,799 --> 00:19:47,559
you know as you would in a browser gets

521
00:19:47,559 --> 00:19:49,929
a session token' connects to LinkedIn

522
00:19:49,929 --> 00:19:51,340
once again looks for your company of

523
00:19:51,340 --> 00:19:52,809
interest that you're interested in and

524
00:19:52,809 --> 00:19:55,960
then you know gets the employees passes

525
00:19:55,960 --> 00:19:57,669
freely employees extracts their names

526
00:19:57,669 --> 00:20:01,419
and details from the responses reformats

527
00:20:01,419 --> 00:20:04,059
it all and puts it into a nice report

528
00:20:04,059 --> 00:20:06,400
and sort of format and then output it to

529
00:20:06,400 --> 00:20:09,820
a text file great so we'll see a demo of

530
00:20:09,820 --> 00:20:10,539
that in a moment

531
00:20:10,539 --> 00:20:13,960
or my aunt's right so my my my was a

532
00:20:13,960 --> 00:20:15,580
little bit different they have they

533
00:20:15,580 --> 00:20:18,190
don't really have a web application they

534
00:20:18,190 --> 00:20:20,080
say they have more of a just a mobile

535
00:20:20,080 --> 00:20:23,710
app and the difference here was learned

536
00:20:23,710 --> 00:20:24,940
I'd have to play with them all that

537
00:20:24,940 --> 00:20:26,650
lapped intercept the API and make it all

538
00:20:26,650 --> 00:20:28,330
work it isn't that much more difficult

539
00:20:28,330 --> 00:20:30,159
if you've done much mobile testing

540
00:20:30,159 --> 00:20:32,440
before learned all it is is setting a

541
00:20:32,440 --> 00:20:33,880
web property on your mobile phone and

542
00:20:33,880 --> 00:20:35,679
actually using the application to get

543
00:20:35,679 --> 00:20:37,150
all the api's that you'd need to connect

544
00:20:37,150 --> 00:20:41,049
it so similarly you log into the API

545
00:20:41,049 --> 00:20:42,850
like you've extracted from the mobile

546
00:20:42,850 --> 00:20:45,880
application then connect to that social

547
00:20:45,880 --> 00:20:48,370
media network find that company name

548
00:20:48,370 --> 00:20:50,230
once again get live employees even

549
00:20:50,230 --> 00:20:52,210
better on my mind I found out that you

550
00:20:52,210 --> 00:20:54,520
could just dump 50,000 employees all at

551
00:20:54,520 --> 00:20:56,890
once if he wanted to so you don't where

552
00:20:56,890 --> 00:20:58,929
as on LinkedIn it was restricted to

553
00:20:58,929 --> 00:21:02,409
around a thousand employees I will look

554
00:21:02,409 --> 00:21:04,030
for the pages once again pass it all and

555
00:21:04,030 --> 00:21:08,950
then spit it out in a HTML template so

556
00:21:08,950 --> 00:21:11,080
there's a quick demo of LinkedIn just to

557
00:21:11,080 --> 00:21:12,490
show you what it does and saw the

558
00:21:12,490 --> 00:21:14,620
benefits if you're not quite aware from

559
00:21:14,620 --> 00:21:16,929
just meet like listening to me so I've

560
00:21:16,929 --> 00:21:19,179
run the LinkedIn tool here I'm just

561
00:21:19,179 --> 00:21:21,100
gonna use uber as a example I always use

562
00:21:21,100 --> 00:21:23,080
it because I've got a book about you

563
00:21:23,080 --> 00:21:28,929
going on so it's not as sensitive so I

564
00:21:28,929 --> 00:21:31,659
fill in some fields you know until today

565
00:21:31,659 --> 00:21:33,909
it still works pretty well and we can

566
00:21:33,909 --> 00:21:37,120
see it's extracting employees the hotel

567
00:21:37,120 --> 00:21:39,250
Wi-Fi was a bit slow so I've speeded up

568
00:21:39,250 --> 00:21:41,919
the video a little bit here we'll see it

569
00:21:41,919 --> 00:21:45,090
start shooting through in the moment

570
00:21:46,850 --> 00:21:49,200
so yeah here it's extracting a lot of

571
00:21:49,200 --> 00:21:50,700
employees is spitting out some error

572
00:21:50,700 --> 00:21:51,870
messages for people that don't have

573
00:21:51,870 --> 00:21:56,610
photographs on LinkedIn that let's point

574
00:21:56,610 --> 00:21:58,919
the the tools finished and that was

575
00:21:58,919 --> 00:22:01,110
within the three minutes maybe and I'm

576
00:22:01,110 --> 00:22:03,059
able to get roughly a thousand employees

577
00:22:03,059 --> 00:22:06,809
off LinkedIn get a nice HTML report

578
00:22:06,809 --> 00:22:08,880
template which I can view in those nice

579
00:22:08,880 --> 00:22:11,429
photographs and the job the location I

580
00:22:11,429 --> 00:22:13,169
get a lot of Hong Kong contacts because

581
00:22:13,169 --> 00:22:16,590
my I'm in Hong Kong right now so it

582
00:22:16,590 --> 00:22:18,120
gives me people in the same proximity of

583
00:22:18,120 --> 00:22:20,159
people in the same network you can

584
00:22:20,159 --> 00:22:21,750
actually specify specific location

585
00:22:21,750 --> 00:22:23,669
you're interested in and you can get

586
00:22:23,669 --> 00:22:25,640
employees for that specific location

587
00:22:25,640 --> 00:22:28,260
I've got a CSV file as well for the

588
00:22:28,260 --> 00:22:30,450
people that want to cut out those emails

589
00:22:30,450 --> 00:22:32,700
for example and put it into other tools

590
00:22:32,700 --> 00:22:35,279
it's for processing so you might put

591
00:22:35,279 --> 00:22:37,529
into a phishing framework or into a

592
00:22:37,529 --> 00:22:39,330
brute-forcing tool for example and you

593
00:22:39,330 --> 00:22:42,049
can use these as well

594
00:22:42,590 --> 00:22:45,210
so once again we're reducing the time

595
00:22:45,210 --> 00:22:47,309
necessary to perform a repetitive tasks

596
00:22:47,309 --> 00:22:48,720
that we doing across many engagements

597
00:22:48,720 --> 00:22:51,090
you know if you're spending less time

598
00:22:51,090 --> 00:22:52,279
finding employees of an organization

599
00:22:52,279 --> 00:22:54,539
you're actually spending more time doing

600
00:22:54,539 --> 00:22:56,669
something else right what will that be

601
00:22:56,669 --> 00:22:59,100
for you know doing reconnaissance for

602
00:22:59,100 --> 00:23:02,279
other social media or you know finding

603
00:23:02,279 --> 00:23:04,080
breach passwords maybe a lot sort of

604
00:23:04,080 --> 00:23:05,399
thing you so you're spending more time

605
00:23:05,399 --> 00:23:08,850
on other aspects as opposed to looking

606
00:23:08,850 --> 00:23:10,970
for employees that might take hours if

607
00:23:10,970 --> 00:23:14,279
in some cases and it's less confusion

608
00:23:14,279 --> 00:23:16,020
now there's one go-to tool before there

609
00:23:16,020 --> 00:23:17,789
were a lot of other tools some light use

610
00:23:17,789 --> 00:23:20,399
LinkedIn api's some light used like

611
00:23:20,399 --> 00:23:22,110
other methods to get to getting

612
00:23:22,110 --> 00:23:24,210
employees maybe from Google but now you

613
00:23:24,210 --> 00:23:25,590
just got one ghost at all and you can

614
00:23:25,590 --> 00:23:27,149
just you know you know it works and it

615
00:23:27,149 --> 00:23:31,830
does the job so yeah it reduces like

616
00:23:31,830 --> 00:23:34,649
complexity alright so now for the third

617
00:23:34,649 --> 00:23:36,890
one I'm gonna give a quick disclaimer

618
00:23:36,890 --> 00:23:39,149
I'd rather if people don't record this

619
00:23:39,149 --> 00:23:41,039
if possible or at least don't share it

620
00:23:41,039 --> 00:23:43,919
publicly so yeah just keep it within the

621
00:23:43,919 --> 00:23:45,750
room if possible a Microsoft or are you

622
00:23:45,750 --> 00:23:48,029
aware with the issues I spoke to like a

623
00:23:48,029 --> 00:23:51,059
senior as your p.m. they were like we

624
00:23:51,059 --> 00:23:53,130
know about the issue we're not I don't

625
00:23:53,130 --> 00:23:55,260
know it was like half a year ago I or

626
00:23:55,260 --> 00:23:57,120
even up to a year ago and they

627
00:23:57,120 --> 00:23:59,130
don't care so I'm just going to talk

628
00:23:59,130 --> 00:24:01,830
about it and you know please just no

629
00:24:01,830 --> 00:24:05,309
video and photographs as possible so

630
00:24:05,309 --> 00:24:07,470
it's all public knowledge flow so you

631
00:24:07,470 --> 00:24:08,940
can actually figure this out as well

632
00:24:08,940 --> 00:24:11,250
so subdomain takeovers using the cloud

633
00:24:11,250 --> 00:24:12,240
are quite popular

634
00:24:12,240 --> 00:24:14,190
we know Asher is like really vulnerable

635
00:24:14,190 --> 00:24:17,309
right now Amazon CloudFront that used to

636
00:24:17,309 --> 00:24:19,800
be vulnerable but leave I did a lot haul

637
00:24:19,800 --> 00:24:23,610
a lot of precautions in place where

638
00:24:23,610 --> 00:24:25,170
they're validating your domains before

639
00:24:25,170 --> 00:24:28,670
they allow you to use it now in Amazon

640
00:24:28,670 --> 00:24:30,929
Alibaba is over clouds as well in the

641
00:24:30,929 --> 00:24:34,260
local proximity in the Asia region are

642
00:24:34,260 --> 00:24:35,550
also vulnerable to these types of

643
00:24:35,550 --> 00:24:37,679
attacks I looked at it quite you know

644
00:24:37,679 --> 00:24:40,170
briefly not not as much in depth because

645
00:24:40,170 --> 00:24:42,240
I sure has a lot of good stuff for so I

646
00:24:42,240 --> 00:24:45,540
play with Astro quite a bit in this bit

647
00:24:45,540 --> 00:24:47,070
we're gonna I'll go over what a

648
00:24:47,070 --> 00:24:49,290
subdomain takeover is so it's basically

649
00:24:49,290 --> 00:24:50,790
one alright let's say ticket exchange

650
00:24:50,790 --> 00:24:53,070
that Microsoft comm this is one that

651
00:24:53,070 --> 00:24:54,660
I've identified as being viable you can

652
00:24:54,660 --> 00:24:55,920
even if you've got your laptop right now

653
00:24:55,920 --> 00:24:57,510
you can actually dig for it yourself and

654
00:24:57,510 --> 00:24:58,559
you can see lights in the vulnerable

655
00:24:58,559 --> 00:25:03,360
state so in step one where if you do you

656
00:25:03,360 --> 00:25:04,770
do the dig request rate you'll see that

657
00:25:04,770 --> 00:25:06,000
it actually resolves to the C name of

658
00:25:06,000 --> 00:25:08,160
ticket exchange dot Traffic Manager down

659
00:25:08,160 --> 00:25:08,520
there

660
00:25:08,520 --> 00:25:10,050
and then in step two you can see that it

661
00:25:10,050 --> 00:25:12,450
doesn't resolve to an a record so if no

662
00:25:12,450 --> 00:25:14,160
one wants to be ticket exchange to

663
00:25:14,160 --> 00:25:16,260
traffic manager yeah so why don't we be

664
00:25:16,260 --> 00:25:17,610
like ticket exchange that traffic

665
00:25:17,610 --> 00:25:19,440
manager doesn't it so you know I'll take

666
00:25:19,440 --> 00:25:22,710
over it I'll be like yeah and what

667
00:25:22,710 --> 00:25:26,220
happens is but even even after we do

668
00:25:26,220 --> 00:25:29,370
that like research right we I don't want

669
00:25:29,370 --> 00:25:30,900
to just know that ticket exchange that

670
00:25:30,900 --> 00:25:32,880
traffic manager net is vulnerable right

671
00:25:32,880 --> 00:25:35,880
I want to know Ana larger-scale

672
00:25:35,880 --> 00:25:38,070
what companies are vulnerable what other

673
00:25:38,070 --> 00:25:40,260
organizations of what other domains are

674
00:25:40,260 --> 00:25:42,620
vulnerable and I'll go over that as well

675
00:25:42,620 --> 00:25:46,020
so what I do is I take a large list of

676
00:25:46,020 --> 00:25:48,150
traffic manager net instances because I

677
00:25:48,150 --> 00:25:50,340
know traffic manager uses a starlet

678
00:25:50,340 --> 00:25:52,710
traffic management net and then I'll

679
00:25:52,710 --> 00:25:54,690
loop through all of them and I can use a

680
00:25:54,690 --> 00:25:56,880
tool that subject you can run on github

681
00:25:56,880 --> 00:25:58,530
and it will loop through all of them and

682
00:25:58,530 --> 00:25:59,910
I'll tell you whether it's morrible to

683
00:25:59,910 --> 00:26:01,740
subdomain take over there is a lot of

684
00:26:01,740 --> 00:26:03,420
false positives here and sometimes

685
00:26:03,420 --> 00:26:04,980
you'll see with the traffic manager

686
00:26:04,980 --> 00:26:07,110
instance I just talked about I've

687
00:26:07,110 --> 00:26:09,060
reserved control over it so you can't

688
00:26:09,060 --> 00:26:10,830
just go over and take control over its

689
00:26:10,830 --> 00:26:11,160
head

690
00:26:11,160 --> 00:26:14,430
I'm talking about it but in that case

691
00:26:14,430 --> 00:26:15,840
where you know if someone's already

692
00:26:15,840 --> 00:26:18,240
taking over it but they're not enabling

693
00:26:18,240 --> 00:26:19,950
it learn it will make it look like it's

694
00:26:19,950 --> 00:26:20,880
still in the vulnerable state if you

695
00:26:20,880 --> 00:26:23,100
just looking at the DNS record we've put

696
00:26:23,100 --> 00:26:24,240
our own like private sort of like

697
00:26:24,240 --> 00:26:26,340
research and way to do it to sort of let

698
00:26:26,340 --> 00:26:30,030
me do that false positive route but I'm

699
00:26:30,030 --> 00:26:31,530
not not going to share it here in this

700
00:26:31,530 --> 00:26:35,130
presentation but what we can do is if we

701
00:26:35,130 --> 00:26:36,360
can take that research and we can

702
00:26:36,360 --> 00:26:38,340
automate it every morn for every few

703
00:26:38,340 --> 00:26:40,290
weeks and have this alerting the

704
00:26:40,290 --> 00:26:42,150
monitoring system we can alert off

705
00:26:42,150 --> 00:26:44,190
specific domains or even compares the

706
00:26:44,190 --> 00:26:46,350
vulnerable domains to elections have 1

707
00:26:46,350 --> 00:26:48,060
million for example to assess the impact

708
00:26:48,060 --> 00:26:51,600
etc and then give ourselves alert or you

709
00:26:51,600 --> 00:26:53,490
know I can get email every month to say

710
00:26:53,490 --> 00:26:55,860
these are the new ones that we found and

711
00:26:55,860 --> 00:26:58,860
I can use that to help our customers if

712
00:26:58,860 --> 00:27:00,570
our customers subdomain is vulnerable I

713
00:27:00,570 --> 00:27:02,490
can use like in an engagement with learn

714
00:27:02,490 --> 00:27:05,490
for weather like a pseudo waterhole

715
00:27:05,490 --> 00:27:08,790
attack or in command and control if I

716
00:27:08,790 --> 00:27:10,050
want to use the wrong domain for command

717
00:27:10,050 --> 00:27:12,150
control or I can use it to fishable an

718
00:27:12,150 --> 00:27:14,460
employee so you know I can do a lot as

719
00:27:14,460 --> 00:27:16,950
well so they're like legitimate uses for

720
00:27:16,950 --> 00:27:18,960
these things as well in in some of our

721
00:27:18,960 --> 00:27:23,100
red team engagements if you lost as to

722
00:27:23,100 --> 00:27:24,420
what's happening here is a quick demo

723
00:27:24,420 --> 00:27:26,640
here's a sure Traffic Manager subdomain

724
00:27:26,640 --> 00:27:30,990
take over here we're actually on Azure

725
00:27:30,990 --> 00:27:32,880
just to show I mean though it's not fake

726
00:27:32,880 --> 00:27:34,710
it's all not sure I've got a ticket has

727
00:27:34,710 --> 00:27:36,870
changed got Traffic Manager garnett

728
00:27:36,870 --> 00:27:38,790
already registered we're gonna dig it

729
00:27:38,790 --> 00:27:41,130
again and ticket exchange but Microsoft

730
00:27:41,130 --> 00:27:43,260
calm and we can see like there's

731
00:27:43,260 --> 00:27:46,800
actually missing a records right so

732
00:27:46,800 --> 00:27:49,320
there's no a record and then this pretty

733
00:27:49,320 --> 00:27:50,550
much shows like it could be in the

734
00:27:50,550 --> 00:27:51,930
vulnerable state it might not be an

735
00:27:51,930 --> 00:27:54,690
injured person but we can register it in

736
00:27:54,690 --> 00:27:58,140
traffic in Azure Traffic Manager so I've

737
00:27:58,140 --> 00:28:00,330
registered it here and I've set an

738
00:28:00,330 --> 00:28:03,780
endpoint light goes to I'd use take over

739
00:28:03,780 --> 00:28:05,550
that mega court that ICU which I on and

740
00:28:05,550 --> 00:28:07,170
then I can just manipulate like a record

741
00:28:07,170 --> 00:28:10,110
to my own servers it's over good to get

742
00:28:10,110 --> 00:28:14,820
changed at Microsoft calm there's no

743
00:28:14,820 --> 00:28:17,640
content exists because it's not enabled

744
00:28:17,640 --> 00:28:20,340
yet and then I go back out to the

745
00:28:20,340 --> 00:28:23,870
overview but I can enable a profile

746
00:28:24,429 --> 00:28:26,989
and we'll seal it actually quite quickly

747
00:28:26,989 --> 00:28:31,759
if I dickly a records again the AC name

748
00:28:31,759 --> 00:28:33,529
again we'll see that now it results to

749
00:28:33,529 --> 00:28:35,659
my server so I've got control over this

750
00:28:35,659 --> 00:28:39,049
domain at this point yeah it's not my

751
00:28:39,049 --> 00:28:40,429
server plant page and all of the bug

752
00:28:40,429 --> 00:28:42,169
bounties I do as well because learn it

753
00:28:42,169 --> 00:28:44,179
it you know it doesn't damage the

754
00:28:44,179 --> 00:28:46,999
reputation of the organization but here

755
00:28:46,999 --> 00:28:48,320
for this proof-of-concept I'm just going

756
00:28:48,320 --> 00:28:50,570
to type in some information I'm some

757
00:28:50,570 --> 00:28:53,889
content some text refresh the page again

758
00:28:53,889 --> 00:28:56,149
visit the website and we see we've got

759
00:28:56,149 --> 00:28:59,269
control over Microsoft subdomain so if

760
00:28:59,269 --> 00:29:00,649
you were a malicious attacker right

761
00:29:00,649 --> 00:29:02,720
someone could use this for fishing you

762
00:29:02,720 --> 00:29:04,519
know you can put it like an office 365

763
00:29:04,519 --> 00:29:05,869
page on there for example where it learn

764
00:29:05,869 --> 00:29:08,239
suddenly you you add a lot of trust for

765
00:29:08,239 --> 00:29:11,509
employees I doing this type of research

766
00:29:11,509 --> 00:29:13,669
don't generate SSL certs really like

767
00:29:13,669 --> 00:29:15,679
high profile domains because the whole

768
00:29:15,679 --> 00:29:17,450
stock team's gonna go after you so you

769
00:29:17,450 --> 00:29:18,799
know you'll have some legal consequences

770
00:29:18,799 --> 00:29:20,960
so just like you know be careful when

771
00:29:20,960 --> 00:29:24,619
doing this type of research so you well

772
00:29:24,619 --> 00:29:25,879
from the back of this research you know

773
00:29:25,879 --> 00:29:26,989
ahead of time if your customers

774
00:29:26,989 --> 00:29:29,179
vulnerable I found loads of banks

775
00:29:29,179 --> 00:29:31,570
government entities across the world and

776
00:29:31,570 --> 00:29:34,399
you know even even like national

777
00:29:34,399 --> 00:29:37,039
railways companies that said they were

778
00:29:37,039 --> 00:29:38,690
all vulnerable to this type of thing and

779
00:29:38,690 --> 00:29:40,730
the shipment and logistic companies as

780
00:29:40,730 --> 00:29:42,350
well so there's a lot of there's

781
00:29:42,350 --> 00:29:43,970
actually quite a large exposure right so

782
00:29:43,970 --> 00:29:45,409
if you can do this on the large scale

783
00:29:45,409 --> 00:29:46,820
you can find out a lot of these

784
00:29:46,820 --> 00:29:48,679
companies and then if the one of your

785
00:29:48,679 --> 00:29:50,509
clients you can help them you can you

786
00:29:50,509 --> 00:29:52,840
know provide this information to them

787
00:29:52,840 --> 00:29:54,950
and you can simulate attacks that might

788
00:29:54,950 --> 00:29:56,090
not have been possible if you didn't

789
00:29:56,090 --> 00:29:57,919
have this knowledge you know watering

790
00:29:57,919 --> 00:29:59,359
hole attacks have being quite hard to

791
00:29:59,359 --> 00:30:01,879
simulate from a red team perspective

792
00:30:01,879 --> 00:30:03,649
legally because we can't just compromise

793
00:30:03,649 --> 00:30:05,299
a website on the internet and be lot

794
00:30:05,299 --> 00:30:07,129
what web site right but whereas if you

795
00:30:07,129 --> 00:30:08,629
find that your customers subdomain is

796
00:30:08,629 --> 00:30:10,730
vulnerable you can use that tool and

797
00:30:10,730 --> 00:30:12,049
maybe hold some content to them fish

798
00:30:12,049 --> 00:30:16,730
their own employees and we'll the last

799
00:30:16,730 --> 00:30:17,809
sort of like section I'm going to talk

800
00:30:17,809 --> 00:30:21,980
about is as your app c2 so we know from

801
00:30:21,980 --> 00:30:27,499
the previous case the dealer roger has a

802
00:30:27,499 --> 00:30:29,359
lot of subdomain takeovers right and

803
00:30:29,359 --> 00:30:31,159
Traffic Manager is really easy to play

804
00:30:31,159 --> 00:30:32,899
with because you can just direct traffic

805
00:30:32,899 --> 00:30:35,570
to a c2 server or a server let you

806
00:30:35,570 --> 00:30:36,650
control whoever

807
00:30:36,650 --> 00:30:38,990
but as your apps are a little bit more

808
00:30:38,990 --> 00:30:41,360
you know you can host content on it but

809
00:30:41,360 --> 00:30:43,460
we'll see like it's actually a little

810
00:30:43,460 --> 00:30:45,470
bit more difficult I have to learn the

811
00:30:45,470 --> 00:30:47,720
scripting languages like dotnet all

812
00:30:47,720 --> 00:30:50,030
right fair enough PHP like I have to

813
00:30:50,030 --> 00:30:51,530
learn how to write a web app in these

814
00:30:51,530 --> 00:30:53,330
languages which if I'm on an engagement

815
00:30:53,330 --> 00:30:56,120
you know quite giving me like 10 15 days

816
00:30:56,120 --> 00:30:57,920
I don't have time to be messing around

817
00:30:57,920 --> 00:31:00,020
with figuring out how I'm gonna stack

818
00:31:00,020 --> 00:31:01,340
hosting content on this subdomain

819
00:31:01,340 --> 00:31:03,500
takeover around on there and one of

820
00:31:03,500 --> 00:31:07,250
their domains so what I've done is I've

821
00:31:07,250 --> 00:31:11,240
just created a proxy in in Python where

822
00:31:11,240 --> 00:31:12,860
it's just proxies traffic to a selected

823
00:31:12,860 --> 00:31:15,650
the main or selected back-end a server

824
00:31:15,650 --> 00:31:20,120
like you specify so what I did was I I

825
00:31:20,120 --> 00:31:21,980
take the connecting client into the

826
00:31:21,980 --> 00:31:24,080
azure app where I pass it for the

827
00:31:24,080 --> 00:31:26,870
request I get the get request the

828
00:31:26,870 --> 00:31:28,700
parameters the parameters in the URL

829
00:31:28,700 --> 00:31:32,630
body and in etc and then the headers as

830
00:31:32,630 --> 00:31:34,100
well the cookies and other headers if

831
00:31:34,100 --> 00:31:36,559
you're using I don't know maybe I don't

832
00:31:36,559 --> 00:31:38,270
recommend using the export we did for

833
00:31:38,270 --> 00:31:40,309
header for example for you know

834
00:31:40,309 --> 00:31:42,350
commanding control but if that was the

835
00:31:42,350 --> 00:31:43,429
case then you need to make sure you

836
00:31:43,429 --> 00:31:45,950
proxying a lot as well right and there's

837
00:31:45,950 --> 00:31:47,600
a lot of other headers that might be of

838
00:31:47,600 --> 00:31:50,210
interest as well and then I basically

839
00:31:50,210 --> 00:31:52,160
just craft a new request to the target

840
00:31:52,160 --> 00:31:55,120
location so my attacker control server

841
00:31:55,120 --> 00:31:57,950
controlled server and then just send

842
00:31:57,950 --> 00:31:59,750
that same request to my server get the

843
00:31:59,750 --> 00:32:01,220
response and send it back out to the

844
00:32:01,220 --> 00:32:03,290
connecting client so just access this

845
00:32:03,290 --> 00:32:06,140
proxy between the as your app am I am I

846
00:32:06,140 --> 00:32:09,440
am server so when the incoming request

847
00:32:09,440 --> 00:32:11,360
comes in if I've got bad at PNG then

848
00:32:11,360 --> 00:32:12,950
I'll just create a new request with that

849
00:32:12,950 --> 00:32:14,990
same same information so basically just

850
00:32:14,990 --> 00:32:16,910
mirror-like that same request for it

851
00:32:16,910 --> 00:32:18,140
these are the some of the things that

852
00:32:18,140 --> 00:32:19,370
you have to be concerned with when

853
00:32:19,370 --> 00:32:22,100
writing this type of thing the host

854
00:32:22,100 --> 00:32:24,559
header I stick it as my target server so

855
00:32:24,559 --> 00:32:26,360
we'll see in the neck in the demo a bit

856
00:32:26,360 --> 00:32:28,400
where I actually just configure and then

857
00:32:28,400 --> 00:32:33,350
it'll proxy request to my server so if

858
00:32:33,350 --> 00:32:35,870
you lost again here's a demo so I'm sure

859
00:32:35,870 --> 00:32:40,550
your application command and control so

860
00:32:40,550 --> 00:32:43,160
connect me dot Microsoft comm is

861
00:32:43,160 --> 00:32:44,900
actually a domain I found I was

862
00:32:44,900 --> 00:32:46,940
vulnerable to subdomain takeover once

863
00:32:46,940 --> 00:32:49,340
again in as your websites right so

864
00:32:49,340 --> 00:32:50,419
there's no a record you can see

865
00:32:50,419 --> 00:32:52,789
missing but we've got this name in our

866
00:32:52,789 --> 00:32:55,820
website we can go ahead and deploy an

867
00:32:55,820 --> 00:32:59,059
application as that name and we can take

868
00:32:59,059 --> 00:33:00,440
over a lot subdomain

869
00:33:00,440 --> 00:33:01,820
so here I've created this Flast

870
00:33:01,820 --> 00:33:03,679
application which just acts as the proxy

871
00:33:03,679 --> 00:33:07,249
I set the target server to my attacker

872
00:33:07,249 --> 00:33:09,999
control server I've run the application

873
00:33:09,999 --> 00:33:12,470
it takes a little bit of time to deploy

874
00:33:12,470 --> 00:33:22,519
so I speed up the video all right so it

875
00:33:22,519 --> 00:33:24,529
takes quite a few minutes so we're

876
00:33:24,529 --> 00:33:26,809
speeding up rapidly like 15 times the

877
00:33:26,809 --> 00:33:31,850
speed and then you know it's doing all

878
00:33:31,850 --> 00:33:33,470
the deployment stuff it's pushing out

879
00:33:33,470 --> 00:33:35,960
this application on to larium

880
00:33:35,960 --> 00:33:38,690
application cloud after it's finished

881
00:33:38,690 --> 00:33:41,480
deploying we can then visit the website

882
00:33:41,480 --> 00:33:42,980
but we'll see light it doesn't work

883
00:33:42,980 --> 00:33:45,679
there's a 404 website not found I

884
00:33:45,679 --> 00:33:47,659
figured but actually you can't use like

885
00:33:47,659 --> 00:33:49,159
the free version and they've been

886
00:33:49,159 --> 00:33:50,330
charging me quite a bit money for doing

887
00:33:50,330 --> 00:33:53,690
this so I've had to go and upgrade my as

888
00:33:53,690 --> 00:33:55,999
your account so what ended but here I'm

889
00:33:55,999 --> 00:33:58,779
cloning Microsoft's website for example

890
00:33:58,779 --> 00:34:03,080
just there's a POC so I'll clone that i

891
00:34:03,080 --> 00:34:04,580
refresh it again it still doesn't work

892
00:34:04,580 --> 00:34:05,989
because it's not configured correctly

893
00:34:05,989 --> 00:34:10,909
yet I go to a sure again click on the

894
00:34:10,909 --> 00:34:13,250
application services click on that

895
00:34:13,250 --> 00:34:15,799
instance go to custom domains and

896
00:34:15,799 --> 00:34:17,540
because it's already pointing to the

897
00:34:17,540 --> 00:34:19,969
correct location I can type in connect

898
00:34:19,969 --> 00:34:23,089
me Microsoft calm here I'm validate like

899
00:34:23,089 --> 00:34:26,418
this this domain actually works go down

900
00:34:26,418 --> 00:34:33,199
and I can add it as a custom domain now

901
00:34:33,199 --> 00:34:36,079
if i refresh this website again we'll

902
00:34:36,079 --> 00:34:37,940
see like connect me that microsoft come

903
00:34:37,940 --> 00:34:40,399
actually host a website that looks like

904
00:34:40,399 --> 00:34:42,139
Microsoft's web site right on my own

905
00:34:42,139 --> 00:34:46,520
server but the key point of this was to

906
00:34:46,520 --> 00:34:48,530
make it work for command and control so

907
00:34:48,530 --> 00:34:49,549
I'm going to generate a malware

908
00:34:49,549 --> 00:34:51,589
executable here and then run it in the

909
00:34:51,589 --> 00:34:53,179
sandbox just to make sure I'm actually

910
00:34:53,179 --> 00:34:55,280
connecting to connect me up microsoft

911
00:34:55,280 --> 00:34:57,109
calm and it's actually working this

912
00:34:57,109 --> 00:34:59,828
two-way see too

913
00:35:02,859 --> 00:35:04,299
so here's the sandbox I'm just gonna

914
00:35:04,299 --> 00:35:06,130
paste it in I've got wyshak for anything

915
00:35:06,130 --> 00:35:07,809
so we can monitor like the situ is

916
00:35:07,809 --> 00:35:08,799
actually working

917
00:35:08,799 --> 00:35:10,390
I don't you take CCP I figure that I

918
00:35:10,390 --> 00:35:13,140
don't want any I don't want to make any

919
00:35:13,140 --> 00:35:18,999
SSL certs under Microsoft's domain so

920
00:35:18,999 --> 00:35:21,519
see two channels working I checked over

921
00:35:21,519 --> 00:35:22,779
and coal box straight to make sure like

922
00:35:22,779 --> 00:35:27,299
the to like force to a situ is working I

923
00:35:27,299 --> 00:35:29,200
censored that a little bit because I

924
00:35:29,200 --> 00:35:30,819
didn't want to give out too much about

925
00:35:30,819 --> 00:35:36,489
my CT channel so yeah if I do a

926
00:35:36,489 --> 00:35:38,049
screenshot it will work because it's the

927
00:35:38,049 --> 00:35:39,729
to two-way command and control working

928
00:35:39,729 --> 00:35:41,950
and to the connect meet up Microsoft

929
00:35:41,950 --> 00:35:44,109
calm and we can see there's a screenshot

930
00:35:44,109 --> 00:35:47,969
of a lot of lot of lot of the Sun box

931
00:35:47,969 --> 00:35:50,259
and it's a bit cut off because I'm high

932
00:35:50,259 --> 00:35:52,749
DPI in the sandbox and I didn't

933
00:35:52,749 --> 00:35:55,359
screenshot and the in the right

934
00:35:55,359 --> 00:35:57,369
application but if we look at the DNS

935
00:35:57,369 --> 00:35:59,259
records we can see that you know it's

936
00:35:59,259 --> 00:36:00,640
actually going to connect me that

937
00:36:00,640 --> 00:36:07,719
Microsoft icon yeah so by doing this

938
00:36:07,719 --> 00:36:10,209
research I'm now able to have command

939
00:36:10,209 --> 00:36:12,549
control over subdomain takeovers like

940
00:36:12,549 --> 00:36:15,039
I've run Azure applications and a lot of

941
00:36:15,039 --> 00:36:16,869
actual applications were actually used a

942
00:36:16,869 --> 00:36:18,940
lot more than traffic manager and a lot

943
00:36:18,940 --> 00:36:22,150
of banks and you know like even

944
00:36:22,150 --> 00:36:24,009
financial organizations are actually

945
00:36:24,009 --> 00:36:26,170
vulnerable to these types of takeovers

946
00:36:26,170 --> 00:36:27,910
I've found the bank in Hong Kong for

947
00:36:27,910 --> 00:36:29,920
example that was vulnerable and you know

948
00:36:29,920 --> 00:36:31,660
I communicated these findings to them as

949
00:36:31,660 --> 00:36:32,109
well

950
00:36:32,109 --> 00:36:34,089
but you know if it was a client then you

951
00:36:34,089 --> 00:36:35,049
might be able to use one of the

952
00:36:35,049 --> 00:36:37,989
subdomains to to use it as C 2 and if

953
00:36:37,989 --> 00:36:39,519
you're the blue team and you see this

954
00:36:39,519 --> 00:36:41,259
right in your dashboard you're like hey

955
00:36:41,259 --> 00:36:43,239
there's one of my you know our cloud you

956
00:36:43,239 --> 00:36:44,920
means get compromised or something right

957
00:36:44,920 --> 00:36:46,959
so you know adds a bit of an interesting

958
00:36:46,959 --> 00:36:50,589
situation to to the attack and one can

959
00:36:50,589 --> 00:36:52,650
increase the sophistication a little bit

960
00:36:52,650 --> 00:36:54,640
so yeah that's about it

961
00:36:54,640 --> 00:36:57,279
but the key takeaways are I think it's

962
00:36:57,279 --> 00:36:59,319
really important to decide on what type

963
00:36:59,319 --> 00:37:01,719
of research you want to do I like I said

964
00:37:01,719 --> 00:37:03,190
I normally pick it from the cyber kill

965
00:37:03,190 --> 00:37:05,349
chain somewhere in that kill chain if

966
00:37:05,349 --> 00:37:05,979
possible

967
00:37:05,979 --> 00:37:07,599
so I pin know I can directly apply it

968
00:37:07,599 --> 00:37:10,329
again to my work you could do the same

969
00:37:10,329 --> 00:37:13,329
as well and a lot of the tooling

970
00:37:13,329 --> 00:37:15,910
I write is you know it's hacked together

971
00:37:15,910 --> 00:37:17,680
there's no fancy GUI exit sure there's

972
00:37:17,680 --> 00:37:19,720
no you know I'm not a GUI application

973
00:37:19,720 --> 00:37:22,809
guy I don't write much bootstrap code so

974
00:37:22,809 --> 00:37:23,920
I can't make it look fancy where it's

975
00:37:23,920 --> 00:37:25,660
not got a dashboard but it works it does

976
00:37:25,660 --> 00:37:27,819
the job and I think people shouldn't shy

977
00:37:27,819 --> 00:37:30,039
away from writing tools even if it's a

978
00:37:30,039 --> 00:37:32,019
simple concept I've had people say why

979
00:37:32,019 --> 00:37:33,670
are you writing at all to do a few DNS

980
00:37:33,670 --> 00:37:36,009
lookups but to me right it works it does

981
00:37:36,009 --> 00:37:37,509
the job every time and they don't have

982
00:37:37,509 --> 00:37:39,339
to remember those exact things to look

983
00:37:39,339 --> 00:37:41,829
up hence why it's going to be useful and

984
00:37:41,829 --> 00:37:45,460
I always Sheila cooling if possible the

985
00:37:45,460 --> 00:37:47,460
community will help you evolve and

986
00:37:47,460 --> 00:37:50,980
update your tools as well so thanks a

987
00:37:50,980 --> 00:37:53,200
lot I'm Vincent you find me on Twitter

988
00:37:53,200 --> 00:37:55,359
if you're interested in to meet the mo

989
00:37:55,359 --> 00:37:57,339
some things ask about anything if you've

990
00:37:57,339 --> 00:37:58,690
got any questions now I can take it as

991
00:37:58,690 --> 00:38:05,950
one if we've got time yeah might have

992
00:38:05,950 --> 00:38:13,529
been a bit faster no okay

993
00:38:13,529 --> 00:38:16,920
yeah okay

994
00:38:17,080 --> 00:38:22,980
[Applause]

