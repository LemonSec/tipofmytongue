1
00:00:06,399 --> 00:00:10,559
we

2
00:00:07,200 --> 00:00:12,160
would like to continue with the last

3
00:00:10,559 --> 00:00:15,360
talk before the break

4
00:00:12,160 --> 00:00:18,480
um which is about the android

5
00:00:15,360 --> 00:00:22,080
debug bridge from gabriel

6
00:00:18,480 --> 00:00:25,199
kerlik gabriel is a software developer

7
00:00:22,080 --> 00:00:27,038
and the so-called bot hunter at white

8
00:00:25,199 --> 00:00:30,320
ops located in london

9
00:00:27,039 --> 00:00:33,120
uk in the past he worked on

10
00:00:30,320 --> 00:00:34,640
threat intelligence and he obviously

11
00:00:33,120 --> 00:00:37,440
loves to dismantle

12
00:00:34,640 --> 00:00:39,040
break and things all kinds of hardware

13
00:00:37,440 --> 00:00:41,280
he can get his hands on

14
00:00:39,040 --> 00:00:42,239
today's going to talk about the android

15
00:00:41,280 --> 00:00:44,719
debug bridge

16
00:00:42,239 --> 00:00:47,199
and how his self-made honeypots

17
00:00:44,719 --> 00:00:49,600
discovered the worms abusing this

18
00:00:47,200 --> 00:00:51,199
networked debug interface so please

19
00:00:49,600 --> 00:00:54,320
welcome with me

20
00:00:51,199 --> 00:00:56,839
gabriel hello

21
00:00:54,320 --> 00:00:58,399
fellow humans and thank you eric for the

22
00:00:56,840 --> 00:01:01,840
introduction

23
00:00:58,399 --> 00:01:04,400
let me just share my screen

24
00:01:01,840 --> 00:01:05,519
is it all good yes we can hear you and

25
00:01:04,400 --> 00:01:08,720
we can see your screen

26
00:01:05,519 --> 00:01:10,159
all perfect awesome

27
00:01:08,720 --> 00:01:12,400
so first thing first thank you for

28
00:01:10,159 --> 00:01:15,200
having me here

29
00:01:12,400 --> 00:01:17,040
i'm gonna show you today some neat

30
00:01:15,200 --> 00:01:20,640
tricks that

31
00:01:17,040 --> 00:01:24,400
are not being understood well by

32
00:01:20,640 --> 00:01:27,520
the hardware development community but

33
00:01:24,400 --> 00:01:31,200
first thing first i want to know you

34
00:01:27,520 --> 00:01:34,560
uh a bit better hang on a second

35
00:01:31,200 --> 00:01:37,600
i need to find a way to see

36
00:01:34,560 --> 00:01:40,799
the window the

37
00:01:37,600 --> 00:01:44,158
participant window so

38
00:01:40,799 --> 00:01:46,799
raise your hand whoever is an android

39
00:01:44,159 --> 00:01:46,799
developer

40
00:01:48,159 --> 00:01:52,479
could you please just raise your hand

41
00:01:53,119 --> 00:01:57,520
ah all right we've got two people

42
00:02:00,159 --> 00:02:08,239
three okay four

43
00:02:04,159 --> 00:02:11,920
so we've got uh a nice audience uh

44
00:02:08,239 --> 00:02:14,959
for those who don't know what adb is

45
00:02:11,920 --> 00:02:18,079
it's uh basically

46
00:02:14,959 --> 00:02:20,879
android debuggerage um

47
00:02:18,080 --> 00:02:23,040
it's a developer's way of communicating

48
00:02:20,879 --> 00:02:26,399
with the device

49
00:02:23,040 --> 00:02:28,640
and building up a

50
00:02:26,400 --> 00:02:30,239
debugging bridge hence the name between

51
00:02:28,640 --> 00:02:33,440
the app that's being debugged

52
00:02:30,239 --> 00:02:37,519
and the and the developers

53
00:02:33,440 --> 00:02:39,920
computer and today we're gonna

54
00:02:37,519 --> 00:02:41,200
look into ways that this is being abused

55
00:02:39,920 --> 00:02:45,359
by the bad guys

56
00:02:41,200 --> 00:02:47,679
at least a vendor's uh generosity

57
00:02:45,360 --> 00:02:49,840
into allowing easy debugging of their

58
00:02:47,680 --> 00:02:50,800
devices being actively exploited by the

59
00:02:49,840 --> 00:02:54,239
bad guys

60
00:02:50,800 --> 00:02:57,840
and now a bit more about me so

61
00:02:54,239 --> 00:03:00,319
i haven't started my security

62
00:02:57,840 --> 00:03:02,080
research career for long i pulled the

63
00:03:00,319 --> 00:03:03,440
stunt a few years ago

64
00:03:02,080 --> 00:03:05,360
people nicknamed me the public

65
00:03:03,440 --> 00:03:08,000
transportation hacker after i

66
00:03:05,360 --> 00:03:10,400
uh did the simple midfield hack with the

67
00:03:08,000 --> 00:03:12,080
public transit system in romania

68
00:03:10,400 --> 00:03:14,480
and after that i discovered that i

69
00:03:12,080 --> 00:03:16,879
couldn't hack my

70
00:03:14,480 --> 00:03:18,480
way through the town anymore so i

71
00:03:16,879 --> 00:03:22,319
started hacking my car

72
00:03:18,480 --> 00:03:24,560
uh i found out that it knew quite a lot

73
00:03:22,319 --> 00:03:26,720
definitely a lot more than i knew about

74
00:03:24,560 --> 00:03:29,440
myself and about the people that were

75
00:03:26,720 --> 00:03:31,200
roaming around that car but that's a

76
00:03:29,440 --> 00:03:35,359
story for a different time

77
00:03:31,200 --> 00:03:38,879
and recently i started hunting uh

78
00:03:35,360 --> 00:03:42,080
bots at white tops uh hopefully

79
00:03:38,879 --> 00:03:44,079
we're gonna prevent the next uh

80
00:03:42,080 --> 00:03:46,959
robot insurrection but right now we're

81
00:03:44,080 --> 00:03:50,159
just preventing them from doing ad fraud

82
00:03:46,959 --> 00:03:53,440
and this little

83
00:03:50,159 --> 00:03:53,440
tiny bit of research

84
00:03:54,239 --> 00:04:01,519
kinda started from the fact that

85
00:03:57,760 --> 00:04:04,319
we have smart tvs smart fridges

86
00:04:01,519 --> 00:04:05,840
smart toasters smart cars and even

87
00:04:04,319 --> 00:04:09,119
smarter toasters

88
00:04:05,840 --> 00:04:12,400
so what we can do

89
00:04:09,120 --> 00:04:15,040
if we want to make to stay safe is

90
00:04:12,400 --> 00:04:16,399
sprinkle our little honey pots in

91
00:04:15,040 --> 00:04:20,880
between all of those

92
00:04:16,399 --> 00:04:23,440
smart devices and the iot

93
00:04:20,880 --> 00:04:25,120
where s stands for security as we all

94
00:04:23,440 --> 00:04:28,719
know

95
00:04:25,120 --> 00:04:32,720
and looking at all of landscape

96
00:04:28,720 --> 00:04:36,800
uh something caught my eye it looks like

97
00:04:32,720 --> 00:04:40,400
among this rubble of smart devices

98
00:04:36,800 --> 00:04:41,360
some of them were being noticed by the

99
00:04:40,400 --> 00:04:45,520
bad guys

100
00:04:41,360 --> 00:04:49,120
and it was mainly android devices

101
00:04:45,520 --> 00:04:52,159
who had adb on

102
00:04:49,120 --> 00:04:54,880
this was being spotted by kevin bomo at

103
00:04:52,160 --> 00:04:56,320
around two years ago i think i can't

104
00:04:54,880 --> 00:04:58,639
recall exactly

105
00:04:56,320 --> 00:05:00,400
i still remember that it was summer so

106
00:04:58,639 --> 00:05:04,000
it might be two years ago

107
00:05:00,400 --> 00:05:07,198
uh which kind of prompted me

108
00:05:04,000 --> 00:05:10,800
into trying to figure out

109
00:05:07,199 --> 00:05:14,240
what are they sending to those devices

110
00:05:10,800 --> 00:05:15,680
is it what are they exploiting how are

111
00:05:14,240 --> 00:05:19,120
they exploiting it

112
00:05:15,680 --> 00:05:20,880
uh can i exploit it as well so

113
00:05:19,120 --> 00:05:22,479
a lot of questions going around in my

114
00:05:20,880 --> 00:05:25,840
head

115
00:05:22,479 --> 00:05:25,840
basically being a

116
00:05:26,240 --> 00:05:33,520
protocol that you can use to connect to

117
00:05:30,000 --> 00:05:34,479
you can push binaries to it and you can

118
00:05:33,520 --> 00:05:37,599
also

119
00:05:34,479 --> 00:05:38,320
send shell commands through adb to that

120
00:05:37,600 --> 00:05:41,360
phone

121
00:05:38,320 --> 00:05:44,880
because guess what at some point

122
00:05:41,360 --> 00:05:48,080
in history adb got externalized

123
00:05:44,880 --> 00:05:50,000
over tcp so

124
00:05:48,080 --> 00:05:51,359
even though initially the protocol was

125
00:05:50,000 --> 00:05:55,120
designed for usb

126
00:05:51,360 --> 00:05:57,120
only at some point

127
00:05:55,120 --> 00:05:59,039
the powers that we decided to put it up

128
00:05:57,120 --> 00:06:00,880
on the internet and anybody can just

129
00:05:59,039 --> 00:06:04,400
type adb tcp

130
00:06:00,880 --> 00:06:06,560
and the port and bam then adb is exposed

131
00:06:04,400 --> 00:06:09,520
on all of the interfaces

132
00:06:06,560 --> 00:06:11,680
that your phone has or tv or dvr or

133
00:06:09,520 --> 00:06:14,479
whatever

134
00:06:11,680 --> 00:06:16,800
on the internet and that's when you're

135
00:06:14,479 --> 00:06:16,800
owned

136
00:06:16,960 --> 00:06:21,359
so i started working i started tinkering

137
00:06:19,280 --> 00:06:25,359
and hammering away trying to

138
00:06:21,360 --> 00:06:28,960
uh just find a way to do it you know

139
00:06:25,360 --> 00:06:32,160
just pour in the hard work and read rfcs

140
00:06:28,960 --> 00:06:36,318
rtfm and you should be able to do it

141
00:06:32,160 --> 00:06:39,600
and i did read the manual the one that

142
00:06:36,319 --> 00:06:43,440
we have from google

143
00:06:39,600 --> 00:06:47,039
all of the there there is documentation

144
00:06:43,440 --> 00:06:50,080
for everything that's going on but it's

145
00:06:47,039 --> 00:06:52,639
very outdated that stuff was written

146
00:06:50,080 --> 00:06:53,120
once when the protocol was made they

147
00:06:52,639 --> 00:06:57,280
even

148
00:06:53,120 --> 00:06:58,960
described the flow through ascii art

149
00:06:57,280 --> 00:07:01,599
but fortunately the community came to

150
00:06:58,960 --> 00:07:02,318
the rescue and they decided to compile

151
00:07:01,599 --> 00:07:05,919
and add

152
00:07:02,319 --> 00:07:05,919
more resources on top of that

153
00:07:06,319 --> 00:07:10,080
but it was still not enough so i had to

154
00:07:09,199 --> 00:07:12,319
dig a bit more

155
00:07:10,080 --> 00:07:14,719
fortunately i have i found some people

156
00:07:12,319 --> 00:07:18,319
who reverse engineered most of the

157
00:07:14,720 --> 00:07:21,840
headers and the message body and

158
00:07:18,319 --> 00:07:24,319
initially at least according to the rfcs

159
00:07:21,840 --> 00:07:25,280
on an adb packet that's being sent over

160
00:07:24,319 --> 00:07:27,199
tcp

161
00:07:25,280 --> 00:07:28,559
you have the command you have the two

162
00:07:27,199 --> 00:07:31,599
arguments

163
00:07:28,560 --> 00:07:33,759
only two uh

164
00:07:31,599 --> 00:07:37,440
the length of the data being transmitted

165
00:07:33,759 --> 00:07:37,440
to the crc and some magic

166
00:07:38,000 --> 00:07:43,120
simple enough i guess you have

167
00:07:41,039 --> 00:07:45,520
four functions that you can call and

168
00:07:43,120 --> 00:07:48,720
using those four functions

169
00:07:45,520 --> 00:07:50,560
you should just able to assemble really

170
00:07:48,720 --> 00:07:53,360
complex instructions

171
00:07:50,560 --> 00:07:55,039
like in this case trying to execute open

172
00:07:53,360 --> 00:07:56,000
a shell on the device and execute a

173
00:07:55,039 --> 00:07:58,240
simple command

174
00:07:56,000 --> 00:08:00,400
when you execute command you open the

175
00:07:58,240 --> 00:08:04,319
share but in order to open the shell

176
00:08:00,400 --> 00:08:04,960
you need to uh send the open which will

177
00:08:04,319 --> 00:08:08,080
fork

178
00:08:04,960 --> 00:08:11,440
that uh the adb demon into the shell

179
00:08:08,080 --> 00:08:12,318
and then in order to do that you need to

180
00:08:11,440 --> 00:08:16,639
actually

181
00:08:12,319 --> 00:08:19,680
send some proper handshake before it

182
00:08:16,639 --> 00:08:19,680
but it didn't work

183
00:08:20,319 --> 00:08:25,280
and it got that's when the whole rabbit

184
00:08:23,280 --> 00:08:29,039
hole started forming up and it was just

185
00:08:25,280 --> 00:08:32,399
ripe for diving in um the crc

186
00:08:29,039 --> 00:08:34,159
it's not actually the crc uh it's

187
00:08:32,399 --> 00:08:36,719
some kind of implementation that they

188
00:08:34,159 --> 00:08:37,360
did uh the magic had absolutely no

189
00:08:36,719 --> 00:08:39,279
reason

190
00:08:37,360 --> 00:08:40,880
they it wasn't documented what's the

191
00:08:39,279 --> 00:08:44,560
format how it should be there

192
00:08:40,880 --> 00:08:46,800
is it really commands sore and the other

193
00:08:44,560 --> 00:08:46,800
uh

194
00:08:47,120 --> 00:08:56,560
the list of f's uh nobody kinda knew

195
00:08:51,200 --> 00:08:56,560
and nobody kinda knew why that happened

196
00:08:56,800 --> 00:09:03,680
probably you know just um

197
00:09:01,519 --> 00:09:05,360
pms breathing down your neck hey guys

198
00:09:03,680 --> 00:09:06,560
how can we wrap this up faster and

199
00:09:05,360 --> 00:09:09,120
faster

200
00:09:06,560 --> 00:09:09,680
and add pcp-ip over adb or just finish

201
00:09:09,120 --> 00:09:12,080
it yeah

202
00:09:09,680 --> 00:09:13,439
just we're gonna bolt something together

203
00:09:12,080 --> 00:09:17,519
and

204
00:09:13,440 --> 00:09:21,360
uh let it be so

205
00:09:17,519 --> 00:09:23,279
these are my attempts at sending

206
00:09:21,360 --> 00:09:24,959
because in order to write that honeypot

207
00:09:23,279 --> 00:09:27,279
i needed to reverse

208
00:09:24,959 --> 00:09:28,079
those three functions connecting sending

209
00:09:27,279 --> 00:09:30,320
a command

210
00:09:28,080 --> 00:09:31,760
sending a binary so i was trying to send

211
00:09:30,320 --> 00:09:33,920
the binary

212
00:09:31,760 --> 00:09:35,439
using the same devices on the same

213
00:09:33,920 --> 00:09:38,079
connection

214
00:09:35,440 --> 00:09:40,160
three times and i got three different

215
00:09:38,080 --> 00:09:42,880
flows

216
00:09:40,160 --> 00:09:43,360
totally different flows okay let's say

217
00:09:42,880 --> 00:09:47,680
that

218
00:09:43,360 --> 00:09:47,680
the first part kind of

219
00:09:47,839 --> 00:09:52,160
is kind of in line with the other i mean

220
00:09:50,240 --> 00:09:54,240
that's the handshaking part

221
00:09:52,160 --> 00:09:55,760
but until we reach the actual stream of

222
00:09:54,240 --> 00:09:58,320
data

223
00:09:55,760 --> 00:09:59,040
there's a different flow every time and

224
00:09:58,320 --> 00:10:02,480
in the

225
00:09:59,040 --> 00:10:04,959
last example you can actually see that

226
00:10:02,480 --> 00:10:05,680
there's like a big discrepancy over

227
00:10:04,959 --> 00:10:09,839
there

228
00:10:05,680 --> 00:10:12,959
so what i did

229
00:10:09,839 --> 00:10:14,800
i got a the headers

230
00:10:12,959 --> 00:10:16,800
and the body of the message from an open

231
00:10:14,800 --> 00:10:19,839
source repository that i found and i was

232
00:10:16,800 --> 00:10:19,839
telling you about

233
00:10:20,000 --> 00:10:29,200
and i just got to work

234
00:10:24,000 --> 00:10:29,200
i basically implemented

235
00:10:29,680 --> 00:10:33,359
the send function like a rosen function

236
00:10:32,160 --> 00:10:37,519
and tried

237
00:10:33,360 --> 00:10:41,600
every corner case known to humanity

238
00:10:37,519 --> 00:10:44,800
until i could get 99 of the payloads

239
00:10:41,600 --> 00:10:48,480
let's say that there was this odd puppy

240
00:10:44,800 --> 00:10:48,479
that would come in sometimes and

241
00:10:50,079 --> 00:10:56,160
screw everything over but let's say that

242
00:10:53,200 --> 00:10:57,839
in the end it was a great success i

243
00:10:56,160 --> 00:11:00,079
finally had a honeypot

244
00:10:57,839 --> 00:11:01,040
and you can actually go and connect to

245
00:11:00,079 --> 00:11:04,079
it right now

246
00:11:01,040 --> 00:11:07,360
the honeypot has been running for

247
00:11:04,079 --> 00:11:09,839
around one year and a half

248
00:11:07,360 --> 00:11:11,120
and catching attacks all over the

249
00:11:09,839 --> 00:11:14,959
internet

250
00:11:11,120 --> 00:11:18,959
bad guys that keep connecting to adb

251
00:11:14,959 --> 00:11:20,800
and trying to exploit them and to

252
00:11:18,959 --> 00:11:23,199
deploy their malware over there so we

253
00:11:20,800 --> 00:11:24,959
can could go connect over there to my

254
00:11:23,200 --> 00:11:26,399
server and say hi

255
00:11:24,959 --> 00:11:28,319
don't worry nothing will it's gonna

256
00:11:26,399 --> 00:11:31,839
happen it's just like my

257
00:11:28,320 --> 00:11:34,560
private list of my private zoo actually

258
00:11:31,839 --> 00:11:35,839
when it comes to malware and speaking of

259
00:11:34,560 --> 00:11:37,439
zoo

260
00:11:35,839 --> 00:11:40,839
let's get into some of the more

261
00:11:37,440 --> 00:11:43,839
interesting samples that i found

262
00:11:40,839 --> 00:11:43,839
um

263
00:11:44,399 --> 00:11:47,839
the first one got my heart rate a little

264
00:11:46,480 --> 00:11:51,600
bit up

265
00:11:47,839 --> 00:11:53,839
made me seem like a bit wholesome

266
00:11:51,600 --> 00:11:55,760
it looked like there's this guy going

267
00:11:53,839 --> 00:11:57,680
around on the internet stealing my

268
00:11:55,760 --> 00:11:59,120
original idea

269
00:11:57,680 --> 00:12:01,199
thinking that hey i'm gonna make a

270
00:11:59,120 --> 00:12:03,200
botnet that is gonna

271
00:12:01,200 --> 00:12:04,399
fight with other botnets and clean the

272
00:12:03,200 --> 00:12:06,639
internet

273
00:12:04,399 --> 00:12:09,200
hey look this guy already decided to do

274
00:12:06,639 --> 00:12:13,440
that i mean he's removing like

275
00:12:09,200 --> 00:12:16,399
one two three seven other miners

276
00:12:13,440 --> 00:12:17,120
from that device and of course he's

277
00:12:16,399 --> 00:12:20,480
deploying his

278
00:12:17,120 --> 00:12:22,720
own after he's doing that so

279
00:12:20,480 --> 00:12:25,839
yeah that's how my hope in humanity

280
00:12:22,720 --> 00:12:25,839
collapsed again

281
00:12:26,959 --> 00:12:32,959
very simple operation shutting down

282
00:12:30,000 --> 00:12:33,519
his competitors and then trying to push

283
00:12:32,959 --> 00:12:36,638
his no

284
00:12:33,519 --> 00:12:39,839
his own apk using adb push and

285
00:12:36,639 --> 00:12:41,680
after that he starts his apk the apk

286
00:12:39,839 --> 00:12:44,000
starts mining and not only that

287
00:12:41,680 --> 00:12:45,439
in case that who knows maybe the user is

288
00:12:44,000 --> 00:12:47,920
done installs the apk

289
00:12:45,440 --> 00:12:50,079
he always he also has some scripts that

290
00:12:47,920 --> 00:12:50,880
download some binaries that do the

291
00:12:50,079 --> 00:12:53,680
miners

292
00:12:50,880 --> 00:12:55,200
mining but he's not relying only on the

293
00:12:53,680 --> 00:12:58,800
apk

294
00:12:55,200 --> 00:13:02,160
uh at some point came along

295
00:12:58,800 --> 00:13:06,079
a guy who kind of forgot that you can

296
00:13:02,160 --> 00:13:09,439
do adb and push of a command

297
00:13:06,079 --> 00:13:13,279
of a binary so he escaped

298
00:13:09,440 --> 00:13:17,120
the payload behind hex

299
00:13:13,279 --> 00:13:20,720
and then he tried to rebuild it

300
00:13:17,120 --> 00:13:25,040
even though adb shell commands like

301
00:13:20,720 --> 00:13:29,680
go in all directions everywhere and

302
00:13:25,040 --> 00:13:32,880
it's not like always especially over tcp

303
00:13:29,680 --> 00:13:36,079
that you're gonna have the same

304
00:13:32,880 --> 00:13:38,240
commands go in the same

305
00:13:36,079 --> 00:13:39,199
order especially if the connection

306
00:13:38,240 --> 00:13:42,320
becomes this

307
00:13:39,199 --> 00:13:46,000
like close it at some point

308
00:13:42,320 --> 00:13:49,440
uh here short-lived needless to say

309
00:13:46,000 --> 00:13:50,000
and the putin helper yeah this guy's

310
00:13:49,440 --> 00:13:52,720
nose

311
00:13:50,000 --> 00:13:53,680
representing uh that's the actual name

312
00:13:52,720 --> 00:13:57,760
of the malware

313
00:13:53,680 --> 00:14:01,439
putin helper um it's some kind of

314
00:13:57,760 --> 00:14:04,240
dvr mining scam

315
00:14:01,440 --> 00:14:05,440
like most of the bad guys out there it

316
00:14:04,240 --> 00:14:07,360
looks like

317
00:14:05,440 --> 00:14:08,639
mining is still going strong when it

318
00:14:07,360 --> 00:14:12,800
comes to

319
00:14:08,639 --> 00:14:16,480
android botnets mining and banking

320
00:14:12,800 --> 00:14:19,519
making money um

321
00:14:16,480 --> 00:14:20,399
and i actually like felt sorry a bit for

322
00:14:19,519 --> 00:14:23,440
this guy

323
00:14:20,399 --> 00:14:27,519
for this guy he's actually

324
00:14:23,440 --> 00:14:29,600
uh asking for a job over his botnet

325
00:14:27,519 --> 00:14:31,600
for those who don't watch i'm he's

326
00:14:29,600 --> 00:14:33,760
saying i'm sorry but i'm mining on your

327
00:14:31,600 --> 00:14:35,120
device not because i want to but because

328
00:14:33,760 --> 00:14:38,480
i need the cash

329
00:14:35,120 --> 00:14:40,320
and then he attaches his protonmail uh

330
00:14:38,480 --> 00:14:41,760
email and saying that he's gonna send

331
00:14:40,320 --> 00:14:44,399
you a cv

332
00:14:41,760 --> 00:14:47,040
if you contact him over there yeah what

333
00:14:44,399 --> 00:14:50,079
can i say buddy

334
00:14:47,040 --> 00:14:54,160
hoping that you got

335
00:14:50,079 --> 00:14:59,040
a job finally and renounced your ways

336
00:14:54,160 --> 00:15:03,040
and now lapis

337
00:14:59,040 --> 00:15:07,120
um trinity uh trinity is an interesting

338
00:15:03,040 --> 00:15:09,839
uh piece mainly because it's the biggest

339
00:15:07,120 --> 00:15:12,160
malware that's going around the intern

340
00:15:09,839 --> 00:15:15,839
on this on these devices right now

341
00:15:12,160 --> 00:15:19,279
which at their peak were about 50 000

342
00:15:15,839 --> 00:15:23,120
or 60 000 android devices

343
00:15:19,279 --> 00:15:25,439
um it's a

344
00:15:23,120 --> 00:15:26,480
bot it's a bot that's comprised of the

345
00:15:25,440 --> 00:15:29,519
three parts

346
00:15:26,480 --> 00:15:32,720
a native miner an android miner and

347
00:15:29,519 --> 00:15:36,480
a spreading script and all of these

348
00:15:32,720 --> 00:15:39,199
three components are pushed dynamically

349
00:15:36,480 --> 00:15:41,120
so the bot an infected device let's say

350
00:15:39,199 --> 00:15:45,040
will start scanning the internet

351
00:15:41,120 --> 00:15:45,040
but if at some point it will find

352
00:15:46,000 --> 00:15:52,800
a device that has

353
00:15:49,759 --> 00:15:53,680
the 555 port open he's going to connect

354
00:15:52,800 --> 00:15:57,279
to it

355
00:15:53,680 --> 00:15:58,959
and see if the malware the same strain

356
00:15:57,279 --> 00:15:59,759
of malware is already running on that

357
00:15:58,959 --> 00:16:03,839
device

358
00:15:59,759 --> 00:16:05,440
if it is then it won't do anything it

359
00:16:03,839 --> 00:16:06,000
will just leave it alone if it's not

360
00:16:05,440 --> 00:16:08,240
running

361
00:16:06,000 --> 00:16:09,120
it will check each of the individual

362
00:16:08,240 --> 00:16:12,160
pieces that i

363
00:16:09,120 --> 00:16:15,360
told you about native miner java miner

364
00:16:12,160 --> 00:16:15,680
spreading script if they are running if

365
00:16:15,360 --> 00:16:17,600
not

366
00:16:15,680 --> 00:16:20,319
if one is not running it will push it to

367
00:16:17,600 --> 00:16:22,160
the device and try to restart it

368
00:16:20,320 --> 00:16:23,600
in order to achieve this meta

369
00:16:22,160 --> 00:16:26,639
persistency

370
00:16:23,600 --> 00:16:31,279
mechanism there's a lot to delve into it

371
00:16:26,639 --> 00:16:35,120
uh a really cool researcher

372
00:16:31,279 --> 00:16:36,720
nc commander uh made an analysis of it

373
00:16:35,120 --> 00:16:38,959
i don't think he published the research

374
00:16:36,720 --> 00:16:42,639
yet but basically this guy is

375
00:16:38,959 --> 00:16:44,160
actually uh infiltrating in the recovery

376
00:16:42,639 --> 00:16:47,279
partition i think

377
00:16:44,160 --> 00:16:50,800
uh if it found a rooted device so

378
00:16:47,279 --> 00:16:52,720
he achieves this extra resilience over

379
00:16:50,800 --> 00:16:56,959
there

380
00:16:52,720 --> 00:17:00,320
but anyhow the nate the um

381
00:16:56,959 --> 00:17:03,680
java miner is really straightforward

382
00:17:00,320 --> 00:17:06,720
it just embeds low it has a

383
00:17:03,680 --> 00:17:10,799
file embedded it loads it in a webview

384
00:17:06,720 --> 00:17:12,959
uh and inside that file they just open a

385
00:17:10,799 --> 00:17:17,439
coin hive and

386
00:17:12,959 --> 00:17:20,799
make money uh the native miner

387
00:17:17,439 --> 00:17:21,839
is just your run-of-the-mill mining

388
00:17:20,799 --> 00:17:26,559
binary

389
00:17:21,839 --> 00:17:26,559
for monero while the spreading script

390
00:17:27,679 --> 00:17:30,880
this is the more interesting one that i

391
00:17:29,440 --> 00:17:32,799
was telling you about

392
00:17:30,880 --> 00:17:34,799
it contains the routines required for

393
00:17:32,799 --> 00:17:37,840
all of that to extra

394
00:17:34,799 --> 00:17:40,799
uh punch with

395
00:17:37,840 --> 00:17:42,559
uh embedded emitting itself into the

396
00:17:40,799 --> 00:17:44,480
recovery partition and

397
00:17:42,559 --> 00:17:45,678
trying to spread around as much as it

398
00:17:44,480 --> 00:17:48,799
can

399
00:17:45,679 --> 00:17:51,679
now trinity was not

400
00:17:48,799 --> 00:17:54,080
was the most successful but a close

401
00:17:51,679 --> 00:17:56,480
competitor to it was fbot

402
00:17:54,080 --> 00:17:58,840
which got covered by the guys at key who

403
00:17:56,480 --> 00:18:01,440
i think

404
00:17:58,840 --> 00:18:03,439
um

405
00:18:01,440 --> 00:18:05,919
and they discovered that it was using

406
00:18:03,440 --> 00:18:08,240
some kind of blockchain dns system like

407
00:18:05,919 --> 00:18:10,080
going all out blockchain blockchain

408
00:18:08,240 --> 00:18:11,280
money blockchain dns blockchain

409
00:18:10,080 --> 00:18:14,879
everything

410
00:18:11,280 --> 00:18:19,600
uh and at some point

411
00:18:14,880 --> 00:18:24,480
they were specifically targeting trinity

412
00:18:19,600 --> 00:18:28,719
over here ufo minor this is trinity

413
00:18:24,480 --> 00:18:31,840
and catalin chimpanu actually made

414
00:18:28,720 --> 00:18:34,880
i think for zdnet a really cool

415
00:18:31,840 --> 00:18:37,039
article about how these two botnets are

416
00:18:34,880 --> 00:18:40,240
actually fighting with each other

417
00:18:37,039 --> 00:18:42,640
on top of this network of devices that

418
00:18:40,240 --> 00:18:46,000
are adb enabled into

419
00:18:42,640 --> 00:18:46,320
basically the ownership of your smart tv

420
00:18:46,000 --> 00:18:50,320
or

421
00:18:46,320 --> 00:18:50,320
smart home or smart whatever

422
00:18:50,559 --> 00:18:56,240
uh but hey gabby it's not that bad maybe

423
00:18:53,360 --> 00:18:59,120
these guys only had

424
00:18:56,240 --> 00:18:59,120
all devices

425
00:18:59,280 --> 00:19:07,520
my sources told me that

426
00:19:04,160 --> 00:19:10,480
they are pretty new devices android 7 8

427
00:19:07,520 --> 00:19:12,960
9 even android 10 devices you're gonna

428
00:19:10,480 --> 00:19:16,480
find everything in there

429
00:19:12,960 --> 00:19:21,600
which leaves us the question how does

430
00:19:16,480 --> 00:19:21,600
this happen i mean uh

431
00:19:22,480 --> 00:19:25,600
it's not like an active exploit or

432
00:19:24,559 --> 00:19:29,918
anything

433
00:19:25,600 --> 00:19:32,399
it's something that is as designed

434
00:19:29,919 --> 00:19:34,240
probably some somebody in the factory

435
00:19:32,400 --> 00:19:35,679
when they were building the tvs had this

436
00:19:34,240 --> 00:19:39,440
brilliant idea

437
00:19:35,679 --> 00:19:42,320
of enabling adb over tcp

438
00:19:39,440 --> 00:19:43,840
connecting them to a wi-fi and then just

439
00:19:42,320 --> 00:19:46,000
pushing the apk for

440
00:19:43,840 --> 00:19:46,959
like the qa process or that tv or that

441
00:19:46,000 --> 00:19:49,360
dvr

442
00:19:46,960 --> 00:19:50,240
and just automating the process and

443
00:19:49,360 --> 00:19:54,159
somehow

444
00:19:50,240 --> 00:19:58,320
they forgot to remove this debugging

445
00:19:54,160 --> 00:19:58,720
feature uh i'm using this educated guess

446
00:19:58,320 --> 00:20:01,760
because

447
00:19:58,720 --> 00:20:05,200
it it happened in the past that's how i

448
00:20:01,760 --> 00:20:07,200
got to hack my mazda before

449
00:20:05,200 --> 00:20:08,480
they just left all of their debugging

450
00:20:07,200 --> 00:20:11,520
tools

451
00:20:08,480 --> 00:20:11,919
like on my machine like on a production

452
00:20:11,520 --> 00:20:13,440
line

453
00:20:11,919 --> 00:20:15,440
machine and not only for me but for

454
00:20:13,440 --> 00:20:18,480
everybody else

455
00:20:15,440 --> 00:20:21,760
um but

456
00:20:18,480 --> 00:20:24,159
yeah anyway um

457
00:20:21,760 --> 00:20:25,120
just a quick reminder you can always

458
00:20:24,159 --> 00:20:28,400
connect

459
00:20:25,120 --> 00:20:31,439
and try to work around my uh

460
00:20:28,400 --> 00:20:34,159
honeypot in order to

461
00:20:31,440 --> 00:20:35,360
maybe find a bug who knows and together

462
00:20:34,159 --> 00:20:36,400
we can improve it by the way the

463
00:20:35,360 --> 00:20:38,639
honeypot is

464
00:20:36,400 --> 00:20:39,440
available open source it's written in

465
00:20:38,640 --> 00:20:41,520
python

466
00:20:39,440 --> 00:20:42,640
and last year it was upgraded to python

467
00:20:41,520 --> 00:20:45,679
3 as well

468
00:20:42,640 --> 00:20:49,440
um everybody can just pop on

469
00:20:45,679 --> 00:20:52,000
and pop it and see what

470
00:20:49,440 --> 00:20:53,120
these guys are sending but then enough

471
00:20:52,000 --> 00:20:56,159
of the honeypot

472
00:20:53,120 --> 00:20:57,360
i mean i've talked i didn't talk enough

473
00:20:56,159 --> 00:21:00,480
about

474
00:20:57,360 --> 00:21:02,080
what can you find on those devices so

475
00:21:00,480 --> 00:21:04,400
we're gonna have like a demo

476
00:21:02,080 --> 00:21:05,280
ish like a prepared demo i know i'm

477
00:21:04,400 --> 00:21:07,280
cheating

478
00:21:05,280 --> 00:21:08,399
but i couldn't have done it live it's

479
00:21:07,280 --> 00:21:11,840
again from my

480
00:21:08,400 --> 00:21:14,880
sources i can show you

481
00:21:11,840 --> 00:21:16,480
what can be seen on these devices and i

482
00:21:14,880 --> 00:21:20,000
would kindly ask you that

483
00:21:16,480 --> 00:21:22,159
you don't like record this

484
00:21:20,000 --> 00:21:24,880
part or let's say that you don't

485
00:21:22,159 --> 00:21:28,240
specifically target this part because

486
00:21:24,880 --> 00:21:29,360
there are people behind those images and

487
00:21:28,240 --> 00:21:32,799
we're going to start with something

488
00:21:29,360 --> 00:21:36,000
light um some bad guys just injected

489
00:21:32,799 --> 00:21:39,360
uh their uh uh

490
00:21:36,000 --> 00:21:41,440
ad fraud apk onto that device and are

491
00:21:39,360 --> 00:21:44,158
actually trying to test to see if

492
00:21:41,440 --> 00:21:44,799
they can get something done uh more

493
00:21:44,159 --> 00:21:47,600
testing

494
00:21:44,799 --> 00:21:49,440
for ad fraud these are just the default

495
00:21:47,600 --> 00:21:52,320
ads from admob

496
00:21:49,440 --> 00:21:53,120
and bam they got it they got an ad

497
00:21:52,320 --> 00:21:56,480
running

498
00:21:53,120 --> 00:21:58,799
and how this happens they

499
00:21:56,480 --> 00:22:01,039
uh you just say let's say that you have

500
00:21:58,799 --> 00:22:02,480
one of those tvs with adb enabled

501
00:22:01,039 --> 00:22:04,720
you plug it in you connect it to the

502
00:22:02,480 --> 00:22:07,679
internet and then you just get picked up

503
00:22:04,720 --> 00:22:11,280
by some of these bad guys for example

504
00:22:07,679 --> 00:22:13,039
like the ones that push ads and

505
00:22:11,280 --> 00:22:14,480
you're gonna start seeing interstitial

506
00:22:13,039 --> 00:22:18,799
ads on your tv

507
00:22:14,480 --> 00:22:18,799
from now and then fun right um

508
00:22:18,960 --> 00:22:24,159
this guy was just trying to ins to was

509
00:22:21,440 --> 00:22:26,640
was in the process of being hacked

510
00:22:24,159 --> 00:22:28,240
somebody who was just connecting to him

511
00:22:26,640 --> 00:22:30,000
and pushing

512
00:22:28,240 --> 00:22:32,000
the fraudulent one of the fraudulent

513
00:22:30,000 --> 00:22:35,440
apks that from around the internet

514
00:22:32,000 --> 00:22:38,880
uh on his device as

515
00:22:35,440 --> 00:22:41,840
i as all of this screen capture was

516
00:22:38,880 --> 00:22:41,840
going

517
00:22:42,080 --> 00:22:47,360
some random people watching apk watching

518
00:22:44,960 --> 00:22:47,360
youtube

519
00:22:48,159 --> 00:22:54,000
people playing games you know

520
00:22:51,919 --> 00:22:55,120
i mean up until now it's not that

521
00:22:54,000 --> 00:22:58,320
harmful right i

522
00:22:55,120 --> 00:23:00,239
mean what can go bad it's it can be

523
00:22:58,320 --> 00:23:01,600
i mean what are the hackers gonna do

524
00:23:00,240 --> 00:23:04,400
like use your mining

525
00:23:01,600 --> 00:23:06,559
use your cpu for mining time and see

526
00:23:04,400 --> 00:23:09,679
that you're watching vikings

527
00:23:06,559 --> 00:23:13,200
well how about porn

528
00:23:09,679 --> 00:23:13,200
um yes

529
00:23:14,480 --> 00:23:17,520
zero privacy if you one of the one of

530
00:23:16,480 --> 00:23:20,080
those devices

531
00:23:17,520 --> 00:23:21,039
you've got zero privacy somebody can

532
00:23:20,080 --> 00:23:24,960
connect to it

533
00:23:21,039 --> 00:23:29,039
at any time and just use this as fresh

534
00:23:24,960 --> 00:23:31,360
ransom material uh or how about

535
00:23:29,039 --> 00:23:32,320
your messages that you are discussing

536
00:23:31,360 --> 00:23:36,719
with

537
00:23:32,320 --> 00:23:40,799
your loved ones or whatever or just

538
00:23:36,720 --> 00:23:44,559
spying you while you're doing your

539
00:23:40,799 --> 00:23:48,879
i don't know actual human

540
00:23:44,559 --> 00:23:51,360
being stuff trying to

541
00:23:48,880 --> 00:23:52,400
talk with your relatives trying to i

542
00:23:51,360 --> 00:23:56,479
don't know

543
00:23:52,400 --> 00:23:58,400
use what's up and then here comes this

544
00:23:56,480 --> 00:24:00,320
jackass connecting to your phone and

545
00:23:58,400 --> 00:24:01,440
stealing sensitive information and your

546
00:24:00,320 --> 00:24:04,559
chat logs

547
00:24:01,440 --> 00:24:05,919
and i had to do i mean

548
00:24:04,559 --> 00:24:07,600
that's when i knew that i had to do

549
00:24:05,919 --> 00:24:09,679
something so i open sourced

550
00:24:07,600 --> 00:24:12,000
the honeypot as i was telling you

551
00:24:09,679 --> 00:24:14,159
earlier and i got fresh memes

552
00:24:12,000 --> 00:24:15,200
for uh these are these are were not made

553
00:24:14,159 --> 00:24:18,880
by me these were made

554
00:24:15,200 --> 00:24:21,039
by some guys as a reaction to uh

555
00:24:18,880 --> 00:24:22,000
uh to the honeypot being open source

556
00:24:21,039 --> 00:24:24,480
which was like

557
00:24:22,000 --> 00:24:25,600
really really really wholesome i mean

558
00:24:24,480 --> 00:24:28,159
being kind of fresh

559
00:24:25,600 --> 00:24:30,080
in the infosec industry and basically

560
00:24:28,159 --> 00:24:32,640
piggybacking so much

561
00:24:30,080 --> 00:24:33,360
onto the knowledge that was shared with

562
00:24:32,640 --> 00:24:36,240
me

563
00:24:33,360 --> 00:24:37,600
by other people i felt that i needed to

564
00:24:36,240 --> 00:24:41,039
give something back

565
00:24:37,600 --> 00:24:44,639
so a single reaction to that

566
00:24:41,039 --> 00:24:45,360
to this give back was just amazing it

567
00:24:44,640 --> 00:24:48,880
was

568
00:24:45,360 --> 00:24:51,918
really cool thing open source best

569
00:24:48,880 --> 00:24:56,400
10 out of 10 would do again

570
00:24:51,919 --> 00:25:00,320
and yeah it got the honeypot got

571
00:24:56,400 --> 00:25:03,279
integrated by the guys at telecom

572
00:25:00,320 --> 00:25:04,720
uh into teapot which is really cool you

573
00:25:03,279 --> 00:25:06,480
don't have to deploy it by yourself you

574
00:25:04,720 --> 00:25:10,799
can just deploy teapot and you've got

575
00:25:06,480 --> 00:25:14,000
an adb honey instance running on

576
00:25:10,799 --> 00:25:16,158
by itself over there the number

577
00:25:14,000 --> 00:25:18,320
of infected devices after i started

578
00:25:16,159 --> 00:25:22,240
evangelizing this decreased from

579
00:25:18,320 --> 00:25:25,678
more than 50k to 15k

580
00:25:22,240 --> 00:25:27,760
and it even decreased

581
00:25:25,679 --> 00:25:30,000
more this was last year it decreased

582
00:25:27,760 --> 00:25:31,279
more this year to write 7k

583
00:25:30,000 --> 00:25:33,600
or something like that but we'll get to

584
00:25:31,279 --> 00:25:36,720
that later it keeps oscillating

585
00:25:33,600 --> 00:25:38,559
um some interesting statistics

586
00:25:36,720 --> 00:25:40,400
there is something wrong with june and

587
00:25:38,559 --> 00:25:43,678
july like i'm not

588
00:25:40,400 --> 00:25:44,400
really they like knowledgeable data

589
00:25:43,679 --> 00:25:47,120
science

590
00:25:44,400 --> 00:25:47,919
guy but when the graph goes like this it

591
00:25:47,120 --> 00:25:51,600
is bad

592
00:25:47,919 --> 00:25:55,039
right so we've got two spikes one here

593
00:25:51,600 --> 00:25:58,559
and one here and this was from last year

594
00:25:55,039 --> 00:26:01,679
lo and behold the same spikes

595
00:25:58,559 --> 00:26:05,120
over here in june

596
00:26:01,679 --> 00:26:08,840
i don't know what's going on but

597
00:26:05,120 --> 00:26:10,479
it looks like the bad guys want to go on

598
00:26:08,840 --> 00:26:14,399
vacation

599
00:26:10,480 --> 00:26:16,640
maybe who knows and

600
00:26:14,400 --> 00:26:18,320
yeah they they need they want to rake in

601
00:26:16,640 --> 00:26:19,440
some cash something really interesting

602
00:26:18,320 --> 00:26:23,600
is that

603
00:26:19,440 --> 00:26:27,039
they seem to have like a lower activity

604
00:26:23,600 --> 00:26:27,600
during the winter holidays maybe they

605
00:26:27,039 --> 00:26:30,480
just

606
00:26:27,600 --> 00:26:31,678
take time off being a malware guy it can

607
00:26:30,480 --> 00:26:35,360
be hard right

608
00:26:31,679 --> 00:26:38,640
and texting another

609
00:26:35,360 --> 00:26:41,918
interesting aftermath is that the number

610
00:26:38,640 --> 00:26:44,960
of devices keeps shifting up and down

611
00:26:41,919 --> 00:26:50,080
um for example there were only like

612
00:26:44,960 --> 00:26:53,440
10 000 devices that were open on ipv6

613
00:26:50,080 --> 00:26:55,439
a couple of months ago fortunately in

614
00:26:53,440 --> 00:26:58,000
the meantime sometimes somebody decided

615
00:26:55,440 --> 00:27:01,039
to shut that down

616
00:26:58,000 --> 00:27:04,320
so the number

617
00:27:01,039 --> 00:27:07,679
dropped from 20k a couple of months ago

618
00:27:04,320 --> 00:27:09,200
to only 7k right now and all of the ipv6

619
00:27:07,679 --> 00:27:12,799
devices

620
00:27:09,200 --> 00:27:14,799
uh have pretty much gone in the dark so

621
00:27:12,799 --> 00:27:15,918
somebody over there must have done

622
00:27:14,799 --> 00:27:20,158
something really

623
00:27:15,919 --> 00:27:23,840
well and i thank him for that because

624
00:27:20,159 --> 00:27:26,640
the botnet is still going strong uh

625
00:27:23,840 --> 00:27:27,600
even if you i mean if you get infected

626
00:27:26,640 --> 00:27:29,840
and even if you

627
00:27:27,600 --> 00:27:32,559
shut down your internet connection after

628
00:27:29,840 --> 00:27:33,840
that or sorry you put your device behind

629
00:27:32,559 --> 00:27:36,960
the net

630
00:27:33,840 --> 00:27:38,720
you're still gonna get you're still

631
00:27:36,960 --> 00:27:41,600
gonna mine for that guy and

632
00:27:38,720 --> 00:27:42,320
try one and spread the malware basically

633
00:27:41,600 --> 00:27:45,279
but

634
00:27:42,320 --> 00:27:46,840
at least we're seeing like a downwards

635
00:27:45,279 --> 00:27:50,159
trend

636
00:27:46,840 --> 00:27:53,678
um and without further ado

637
00:27:50,159 --> 00:27:54,960
um follow me on github for my latest

638
00:27:53,679 --> 00:27:56,880
project i have

639
00:27:54,960 --> 00:27:58,559
some really cool stuff that i'm gonna be

640
00:27:56,880 --> 00:28:02,240
releasing soon

641
00:27:58,559 --> 00:28:06,399
and follow me on twitter for uh

642
00:28:02,240 --> 00:28:09,840
all the fresh memes thank you guys

643
00:28:06,399 --> 00:28:14,479
and thank you the guys at android

644
00:28:09,840 --> 00:28:14,480
security symposium for uh having me

645
00:28:15,760 --> 00:28:22,240
okay thanks gabriel for this animated

646
00:28:18,799 --> 00:28:23,918
very mean powered presentation uh we're

647
00:28:22,240 --> 00:28:26,960
ready for another round of

648
00:28:23,919 --> 00:28:30,640
q and a there are two uh people

649
00:28:26,960 --> 00:28:32,000
in um in zoom still raising their hands

650
00:28:30,640 --> 00:28:33,760
i don't know whether or not you would

651
00:28:32,000 --> 00:28:36,880
like to ask questions or

652
00:28:33,760 --> 00:28:40,960
maybe this is from your questions

653
00:28:36,880 --> 00:28:40,960
regarding android development before

654
00:28:41,039 --> 00:28:45,840
claudia do you want to ask a question

655
00:28:49,440 --> 00:28:53,919
okay i don't i don't think so so if

656
00:28:52,799 --> 00:28:57,360
there are any questions

657
00:28:53,919 --> 00:29:00,640
please just type them into the program

658
00:28:57,360 --> 00:29:03,279
the one q and a in metamost

659
00:29:00,640 --> 00:29:04,799
um well almost all of the questions are

660
00:29:03,279 --> 00:29:06,720
prepared during the first half of your

661
00:29:04,799 --> 00:29:09,760
speech you actually answered

662
00:29:06,720 --> 00:29:12,640
in the second one um it seems that

663
00:29:09,760 --> 00:29:13,440
most bots you detected have their main

664
00:29:12,640 --> 00:29:16,399
focus on

665
00:29:13,440 --> 00:29:16,720
mining cryptocurrencies is that correct

666
00:29:16,399 --> 00:29:18,719
or

667
00:29:16,720 --> 00:29:20,720
did you find malware which tries to do

668
00:29:18,720 --> 00:29:22,640
anything else in particular

669
00:29:20,720 --> 00:29:24,480
oh it's mainly ad fraud and

670
00:29:22,640 --> 00:29:26,480
cryptocurrency they are still exploring

671
00:29:24,480 --> 00:29:28,880
the ad fraud part

672
00:29:26,480 --> 00:29:32,640
but the cryptocurrency is there to stay

673
00:29:28,880 --> 00:29:36,159
they are mining like crazy

674
00:29:32,640 --> 00:29:39,840
okay um is is mining

675
00:29:36,159 --> 00:29:39,840
on on android hardware

676
00:29:42,480 --> 00:29:47,840
yeah exactly interesting when well

677
00:29:45,919 --> 00:29:49,520
when you i mean when it's not your

678
00:29:47,840 --> 00:29:52,840
device any kind of mining

679
00:29:49,520 --> 00:29:56,240
is financially

680
00:29:52,840 --> 00:29:58,158
useful you just need to find the

681
00:29:56,240 --> 00:29:59,440
reasonable amount of devices i've seen

682
00:29:58,159 --> 00:30:02,320
people trying to mine

683
00:29:59,440 --> 00:30:03,600
on even a lower number of devices like

684
00:30:02,320 --> 00:30:07,600
1k

685
00:30:03,600 --> 00:30:10,959
for example okay and yeah and it still

686
00:30:07,600 --> 00:30:10,959
break some profit for them

687
00:30:11,120 --> 00:30:15,760
well obviously they wouldn't do it

688
00:30:12,559 --> 00:30:15,760
otherwise i guess yeah

689
00:30:16,000 --> 00:30:19,440
there is a another question from renee

690
00:30:18,799 --> 00:30:22,480
uh

691
00:30:19,440 --> 00:30:26,000
who asks what's the plan b

692
00:30:22,480 --> 00:30:28,240
or c or d on recovering or resetting the

693
00:30:26,000 --> 00:30:31,360
honeypot when attackers manage

694
00:30:28,240 --> 00:30:34,880
to compromise the next level oh

695
00:30:31,360 --> 00:30:37,320
there is no next level it's completely

696
00:30:34,880 --> 00:30:40,000
uh

697
00:30:37,320 --> 00:30:41,678
non-interactive i mean it's interactive

698
00:30:40,000 --> 00:30:45,279
as in it responds

699
00:30:41,679 --> 00:30:47,919
to the various uh packets

700
00:30:45,279 --> 00:30:48,559
like lower level packets that are being

701
00:30:47,919 --> 00:30:50,480
sent

702
00:30:48,559 --> 00:30:52,158
because you just can't like make a

703
00:30:50,480 --> 00:30:54,080
handshake and then send a command now

704
00:30:52,159 --> 00:30:56,080
you need to like follow that protocol

705
00:30:54,080 --> 00:30:57,519
so the whole adb i implemented the whole

706
00:30:56,080 --> 00:31:00,559
adb protocol

707
00:30:57,519 --> 00:31:04,080
from the ground up and

708
00:31:00,559 --> 00:31:05,279
the payload is just download it in a

709
00:31:04,080 --> 00:31:07,918
file

710
00:31:05,279 --> 00:31:09,279
and the shell command is outputted to a

711
00:31:07,919 --> 00:31:12,960
text file

712
00:31:09,279 --> 00:31:16,240
that's it i mean unless

713
00:31:12,960 --> 00:31:18,000
they find some kind of exploit in the

714
00:31:16,240 --> 00:31:22,559
honeypot in python where

715
00:31:18,000 --> 00:31:25,679
they can do some shenanigans

716
00:31:22,559 --> 00:31:25,678
there is no second level

717
00:31:26,080 --> 00:31:32,799
okay i guess i guess that answers it um

718
00:31:29,440 --> 00:31:36,480
we have another question from paul

719
00:31:32,799 --> 00:31:39,679
which who tells you you did a good job

720
00:31:36,480 --> 00:31:41,919
on your talk have you seen any

721
00:31:39,679 --> 00:31:43,120
any malware from another source that

722
00:31:41,919 --> 00:31:46,159
attempts to turn

723
00:31:43,120 --> 00:31:48,959
on adb over wi-fi

724
00:31:46,159 --> 00:31:50,640
he also says he assumes that whiteheads

725
00:31:48,960 --> 00:31:53,440
can find these devices

726
00:31:50,640 --> 00:31:54,480
atp connect and disable adb over wi-fi

727
00:31:53,440 --> 00:31:58,159
while connected

728
00:31:54,480 --> 00:31:58,159
so that's some sort of the drop

729
00:31:58,840 --> 00:32:05,600
um from my knowledge the

730
00:32:01,840 --> 00:32:05,600
adb so the connection

731
00:32:06,159 --> 00:32:11,440
is permanent like built

732
00:32:09,200 --> 00:32:12,320
in from the hard so even if you disable

733
00:32:11,440 --> 00:32:14,399
it right now

734
00:32:12,320 --> 00:32:16,240
when you reboot your device it's gonna

735
00:32:14,399 --> 00:32:18,959
be re-enabled

736
00:32:16,240 --> 00:32:21,279
i can't recall for sure it depends on on

737
00:32:18,960 --> 00:32:22,720
from vendor to vendor but i've seen one

738
00:32:21,279 --> 00:32:24,559
that did that

739
00:32:22,720 --> 00:32:25,919
and this is one of the issues that i've

740
00:32:24,559 --> 00:32:29,840
noticed it's

741
00:32:25,919 --> 00:32:29,840
a bit harder to patch it

742
00:32:31,360 --> 00:32:34,799
yeah but and to answer the first

743
00:32:34,240 --> 00:32:37,440
question

744
00:32:34,799 --> 00:32:40,240
i haven't seen any malware trying to

745
00:32:37,440 --> 00:32:43,600
open adb connections

746
00:32:40,240 --> 00:32:45,200
like and we were talking about android

747
00:32:43,600 --> 00:32:46,879
malware like google play malware and

748
00:32:45,200 --> 00:32:49,360
stuff like that or side channel

749
00:32:46,880 --> 00:32:50,799
malware third-party malware they don't

750
00:32:49,360 --> 00:32:54,000
do that they either

751
00:32:50,799 --> 00:32:56,799
go like they

752
00:32:54,000 --> 00:32:58,799
wiggle their their way through adb where

753
00:32:56,799 --> 00:33:00,960
and they do all of their shenanigans

754
00:32:58,799 --> 00:33:02,000
or you download them from a marketplace

755
00:33:00,960 --> 00:33:05,200
whatever

756
00:33:02,000 --> 00:33:08,720
and they just stay in the context of

757
00:33:05,200 --> 00:33:11,760
that device and don't do anything

758
00:33:08,720 --> 00:33:15,039
cross channel okay thanks

759
00:33:11,760 --> 00:33:17,519
um another question from uh weaker she

760
00:33:15,039 --> 00:33:20,399
asks do you know what kind of devices

761
00:33:17,519 --> 00:33:23,279
are these like a list of devices um do

762
00:33:20,399 --> 00:33:26,559
you notify the vendors to fix it

763
00:33:23,279 --> 00:33:29,919
the list is really big uh i tried

764
00:33:26,559 --> 00:33:32,158
yeah it's it's i tried i

765
00:33:29,919 --> 00:33:33,720
at some point i tried doing some recon

766
00:33:32,159 --> 00:33:36,159
but the

767
00:33:33,720 --> 00:33:40,159
configurations that came were very

768
00:33:36,159 --> 00:33:40,159
diverse and colorful and

769
00:33:40,240 --> 00:33:45,360
yeah what can i say just gave up it was

770
00:33:43,360 --> 00:33:46,559
it was basically whack them all because

771
00:33:45,360 --> 00:33:48,240
you would try to

772
00:33:46,559 --> 00:33:50,320
let's say that you found a vendor but

773
00:33:48,240 --> 00:33:53,279
then the next day you had like

774
00:33:50,320 --> 00:33:54,799
this other vendor like the ipv6 guys

775
00:33:53,279 --> 00:33:58,159
that i was telling you about

776
00:33:54,799 --> 00:34:02,080
they are some kind of dvr company from

777
00:33:58,159 --> 00:34:05,039
brazil and they just pop them overnight

778
00:34:02,080 --> 00:34:07,439
they spread everywhere like just like

779
00:34:05,039 --> 00:34:10,000
that uh

780
00:34:07,440 --> 00:34:11,520
fortunately i'm trying like a more

781
00:34:10,000 --> 00:34:13,359
proactive approach so

782
00:34:11,520 --> 00:34:14,719
i'm trying to speak about this and to

783
00:34:13,359 --> 00:34:16,960
raise awareness

784
00:34:14,719 --> 00:34:18,319
hoping that this kind of knowledge will

785
00:34:16,960 --> 00:34:20,960
spread as much

786
00:34:18,320 --> 00:34:22,560
like go right to the guys actually

787
00:34:20,960 --> 00:34:24,800
making this stuff

788
00:34:22,560 --> 00:34:26,719
and getting them informed and

789
00:34:24,800 --> 00:34:30,000
fortunately shutting down

790
00:34:26,719 --> 00:34:34,399
adb okay we'll see if that works

791
00:34:30,000 --> 00:34:37,119
hopefully okay um

792
00:34:34,399 --> 00:34:39,520
i do have a last uh concluding question

793
00:34:37,119 --> 00:34:42,000
uh a more general one so

794
00:34:39,520 --> 00:34:42,560
speaking of of pushing system upgrades

795
00:34:42,000 --> 00:34:44,879
uh

796
00:34:42,560 --> 00:34:47,199
especially devices like tvs have a

797
00:34:44,879 --> 00:34:48,000
notoriously bad track record for for not

798
00:34:47,199 --> 00:34:51,040
being taken care

799
00:34:48,000 --> 00:34:51,520
of after manufacturing them as far as i

800
00:34:51,040 --> 00:34:53,759
know

801
00:34:51,520 --> 00:34:55,839
much worse even than it is the case with

802
00:34:53,760 --> 00:34:57,680
some smartphone manufacturers

803
00:34:55,839 --> 00:34:59,680
so do you have the impression that

804
00:34:57,680 --> 00:35:01,440
companies which are using

805
00:34:59,680 --> 00:35:03,520
android for devices other than

806
00:35:01,440 --> 00:35:06,480
smartphones care significantly less

807
00:35:03,520 --> 00:35:08,400
about the security of their devices

808
00:35:06,480 --> 00:35:10,000
i don't think that care would be the

809
00:35:08,400 --> 00:35:13,520
correct verb

810
00:35:10,000 --> 00:35:16,560
i would say that they just don't know

811
00:35:13,520 --> 00:35:17,920
yeah it's it's like let's say that

812
00:35:16,560 --> 00:35:21,200
you're making tvs

813
00:35:17,920 --> 00:35:22,960
and all of a sudden uh there's this uh

814
00:35:21,200 --> 00:35:25,118
requirement from the management hey guys

815
00:35:22,960 --> 00:35:27,359
you need to make a smart tv

816
00:35:25,119 --> 00:35:29,200
yeah but now we we need to like release

817
00:35:27,359 --> 00:35:32,319
in a couple of months

818
00:35:29,200 --> 00:35:35,680
we don't care it has to be smart so

819
00:35:32,320 --> 00:35:40,240
then you have devs just rushing

820
00:35:35,680 --> 00:35:41,839
and bolting things together and i mean

821
00:35:40,240 --> 00:35:44,078
i know because i've been in that

822
00:35:41,839 --> 00:35:47,839
situation i've written some

823
00:35:44,079 --> 00:35:51,440
bad code and i'm i feel guilty about

824
00:35:47,839 --> 00:35:53,119
it so i think that this is happening

825
00:35:51,440 --> 00:35:55,680
it's a it's a light motif in our

826
00:35:53,119 --> 00:35:55,680
industry

827
00:35:56,240 --> 00:36:01,279
yeah from from what i know i i'm afraid

828
00:35:58,320 --> 00:36:04,720
you're right about that

829
00:36:01,280 --> 00:36:08,320
okay um it seems like there

830
00:36:04,720 --> 00:36:11,279
aren't any questions left to be answered

831
00:36:08,320 --> 00:36:12,000
so uh thank you very much once again

832
00:36:11,280 --> 00:36:19,599
gabriel

833
00:36:12,000 --> 00:36:19,599
thank you very much for your talk

