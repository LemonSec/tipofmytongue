1
00:00:08,200 --> 00:00:11,920
hello mr.

2
00:00:15,680 --> 00:00:22,970
actually killed two factor
authentication I didn't do this by

3
00:00:22,970 --> 00:00:30,500
myself some from vu university
supervised by her boss and most of this

4
00:00:30,500 --> 00:00:35,570
park was done as a monster project by
pradesh so these are scratches to be

5
00:00:35,570 --> 00:00:44,570
here and a little about me so system and
network security in the past I've been

6
00:00:44,570 --> 00:00:51,440
working on and rubies here in Vienna and
as for a massive project i implemented

7
00:00:51,440 --> 00:00:57,349
Traci Lords with some happen analysis
system and over the last year I've been

8
00:00:57,350 --> 00:01:05,239
busy doing other stuff and one of the
results are paper at CES 2015 which is

9
00:01:05,239 --> 00:01:14,509
about cfi so today my talk will be about
two things will be about two factor

10
00:01:14,509 --> 00:01:17,509
authentication and then about how Google
killed it

11
00:01:18,890 --> 00:01:24,799
so let's start here two-factor
authentication is form of multi-factor

12
00:01:24,799 --> 00:01:29,990
education was waiting a long time ago
and its uses multiple components for

13
00:01:29,990 --> 00:01:37,100
identification right so ideal you have
three of those something you know so

14
00:01:37,100 --> 00:01:42,320
your username your password something
you possess bank card or smart card

15
00:01:42,320 --> 00:01:48,710
reader and something you are fingerprint
or is it uses to authenticate yourself

16
00:01:48,710 --> 00:01:55,039
right to make it harder for attackers to
hijack your account and this works

17
00:01:55,040 --> 00:01:59,750
because the components are usually
separated right it's realizing the

18
00:01:59,750 --> 00:02:03,860
separation of these components and for
an attacker to hide your account and we

19
00:02:03,860 --> 00:02:07,520
really need to control all the separate
components that are you

20
00:02:07,520 --> 00:02:14,570
they're meeting us an example i think
everybody should notice withdrawing

21
00:02:14,570 --> 00:02:18,680
money from ATM right so you've got to
your to the ATM machine you put in your

22
00:02:18,680 --> 00:02:19,610
barn cat

23
00:02:19,610 --> 00:02:25,340
the bank card which is something you
possess the enter your PIN code which is

24
00:02:25,340 --> 00:02:31,850
something you know and you get your
money right so we're doing this for web

25
00:02:31,850 --> 00:02:37,730
applications is quite a hustle right so
you don't want every website episode on

26
00:02:37,730 --> 00:02:43,280
smart card reader so it's quite
expensive to set up so we wouldn t be

27
00:02:43,280 --> 00:02:47,420
great if we can use something for the
second factor that everybody has already

28
00:02:48,200 --> 00:02:53,540
yes SMS that's the debt so how does it
work

29
00:02:55,040 --> 00:03:02,600
use case that we are particularly
interested in its ebanking so happens

30
00:03:02,600 --> 00:03:11,060
you're on the left side you are you want
to make a transaction so you communicate

31
00:03:11,060 --> 00:03:16,010
with your back here either interrupts
banking first thing you do is you login

32
00:03:16,010 --> 00:03:23,179
right use my pass work then you want to
transfer some money so that's why I want

33
00:03:23,180 --> 00:03:27,680
to transfer one of the euros to account
number X so he said this request through

34
00:03:27,680 --> 00:03:35,000
back to the bank will respond by sending
a attend a transsexual education number

35
00:03:35,000 --> 00:03:43,250
to your mobile phone to SMS it says here
is called verification code xx 1 2 3 and

36
00:03:43,250 --> 00:03:48,049
this will this one is valid to confirm
the transaction to transfer one that

37
00:03:48,049 --> 00:03:54,019
euros to count number X right and then
last step is entering the skull in your

38
00:03:54,019 --> 00:03:59,209
web browser underwear phase and you get
a transaction being executed

39
00:03:59,780 --> 00:04:05,989
alright so the threat model of two
factor authentication and why do you

40
00:04:05,989 --> 00:04:12,620
have this threat more ways that your
browser is compromised you have a man in

41
00:04:12,620 --> 00:04:17,720
the browser so this is very common right
we have all the malware that still out

42
00:04:17,720 --> 00:04:21,890
there dried X right now tire spy been in
the past

43
00:04:21,890 --> 00:04:26,630
choose whatever and eubank let's get
stolen right but with two factor

44
00:04:26,630 --> 00:04:31,070
authentication attacks are no longer
possible so attackers can initiate your

45
00:04:31,070 --> 00:04:32,980
transaction but the

46
00:04:32,980 --> 00:04:40,090
no longer confirm them so they can no
longer enter your bank account so what

47
00:04:40,090 --> 00:04:46,060
did we see one once this was getting
deployed so we were starting to see new

48
00:04:46,060 --> 00:04:54,160
with Jack variants on mobile banking so
one was instead of trying to set up new

49
00:04:54,160 --> 00:04:59,020
transactions modified ongoing
transection show attacker would wait

50
00:04:59,020 --> 00:05:03,940
until the user would initiate the
transaction but then instead of

51
00:05:03,940 --> 00:05:09,760
transferring 10 silicon number X it will
change the request to say . transfer 102

52
00:05:09,760 --> 00:05:13,719
my own account that was mitigated bags

53
00:05:13,720 --> 00:05:21,100
pretty soon i think by including also
account information the transaction so

54
00:05:21,100 --> 00:05:25,900
as message was received with actually
say this is valid to transfer money to

55
00:05:25,900 --> 00:05:33,400
this particular account instead of so in
this case that the the victim would get

56
00:05:33,400 --> 00:05:39,669
a message and you would you should see
that the target transaction number is

57
00:05:39,670 --> 00:05:46,900
different than what he was a progressive
right so then the second thing we saw

58
00:05:46,900 --> 00:05:53,979
was that attackers started to try to
control also over the second factor

59
00:05:53,980 --> 00:05:59,470
right so people are going to use
smartphones so once the position control

60
00:05:59,470 --> 00:06:06,340
lets span the user by sending an email
or SMS messages and social engineering

61
00:06:06,340 --> 00:06:12,340
into social engineer him into installing
more on this phone and then once the

62
00:06:12,340 --> 00:06:18,010
smaller was also installed then it would
be capable of forwarding incoming SMS

63
00:06:18,010 --> 00:06:22,539
messages so the 10 course would be to be
intercepted and forward to the attack

64
00:06:22,540 --> 00:06:31,600
and they came up with very nice name for
this rights sit more socially mobile 6

65
00:06:31,600 --> 00:06:37,870
bit more and more whatever however this
is not straightforward

66
00:06:38,710 --> 00:06:45,190
the current attacks that we see is that
a user must explicitly allow

67
00:06:45,190 --> 00:06:49,900
installation right so you really must
click oh yes i'm going to install this

68
00:06:49,900 --> 00:06:55,000
app right now on the phone and then
there's also google bouncer how I think

69
00:06:55,000 --> 00:07:01,750
Nick didn't really discussed google
bouncer but his talk on Tuesday or

70
00:07:01,750 --> 00:07:07,390
Wednesday was actually related so Google
bouncer is this awesome security feature

71
00:07:07,390 --> 00:07:11,080
of android and the play store that
detects and remove malicious

72
00:07:11,080 --> 00:07:17,020
applications and also between static and
dynamic analysis so the current mall

73
00:07:17,020 --> 00:07:21,909
where is reliance on what we call site
loading which is this this option on

74
00:07:21,910 --> 00:07:26,020
your android phone allow app
installation from unknown sources right

75
00:07:26,020 --> 00:07:30,940
because that's the only way for them to
host their malicious apps somewhere

76
00:07:32,350 --> 00:07:37,150
alright so how did google kill this
right

77
00:07:37,150 --> 00:07:46,210
it all started with this this crazy
desire to integrate everything I would I

78
00:07:46,210 --> 00:07:49,060
like to call and we're computing but
there are very different names that

79
00:07:49,060 --> 00:07:52,480
people use so that is that just
synchronize everything synchronize your

80
00:07:52,480 --> 00:07:56,950
browser your email your contacts with
your phone with your tablet with your pc

81
00:07:56,950 --> 00:08:03,159
with your pc and your work phone right
because that's really the smart smart

82
00:08:03,160 --> 00:08:06,160
phone through the smart thing to do

83
00:08:06,790 --> 00:08:14,830
so how does Google implemented if you
have an Android phone you can manage it

84
00:08:14,830 --> 00:08:20,080
from your browser so there I think their
features to locate it because you lost

85
00:08:20,080 --> 00:08:28,090
it it was stolen you can wipe it to make
sure that no dangerous information gets

86
00:08:28,090 --> 00:08:34,780
the but also you can install apps and
installing apps is really interesting

87
00:08:35,500 --> 00:08:40,809
from our perspective because the
permissions that you need to approve

88
00:08:40,809 --> 00:08:44,859
when installing the app they are shown
only in your browser not being shown

89
00:08:44,860 --> 00:08:45,520
your phone

90
00:08:45,520 --> 00:08:51,880
there's no phone interaction during the
installation of the map is artist look

91
00:08:51,880 --> 00:08:58,300
this is this is my browser I'm locked in
that I'm a plate google come and I

92
00:08:58,300 --> 00:09:05,920
opened angry birds app and i can pick my
device this access to so that's a

93
00:09:05,920 --> 00:09:09,849
positive permission to use you can click
install and look at installing you're

94
00:09:09,850 --> 00:09:14,200
sure this is safe

95
00:09:14,200 --> 00:09:20,470
who says because you can only you can
only install apps from play and we have

96
00:09:20,470 --> 00:09:22,540
bouncer right so balanced will protect
you

97
00:09:22,540 --> 00:09:30,099
moreover apps when newly installed apps
they're inactive after installation

98
00:09:30,100 --> 00:09:35,380
they're inactive and they cannot
out-of-the-blue do anything so a user

99
00:09:35,380 --> 00:09:41,439
must explicitly at least once open the
app only then we can start on boot

100
00:09:41,440 --> 00:09:47,710
only then we can receive SMS messages
and to anything interesting so in order

101
00:09:47,710 --> 00:09:55,210
to elevate our men and browser to a man
in the mobile attack and to intercept

102
00:09:55,210 --> 00:09:59,800
SMS system with do three things right
one is bypassed pounds or so we need to

103
00:09:59,800 --> 00:10:01,000
find a way

104
00:10:01,000 --> 00:10:06,400
new way to also hosts malicious content
in place then we need to figure out a

105
00:10:06,400 --> 00:10:12,370
way to steer you into activating the app
and finally we can intercept SMS

106
00:10:12,370 --> 00:10:19,000
messages to friends them and support
them out here that the app activation is

107
00:10:19,000 --> 00:10:20,260
required only once

108
00:10:20,260 --> 00:10:26,230
one two apps active phone go get
rebooted at will still remain active and

109
00:10:26,230 --> 00:10:32,080
be able to interest himself so let's
start with the first . bypassing bouncer

110
00:10:32,080 --> 00:10:37,090
this has been done in the past already
multiple times however google story is

111
00:10:37,090 --> 00:10:42,700
yes bouncers ongoing process we keep on
improving it and we won't release any

112
00:10:42,700 --> 00:10:49,210
details but that will just help funerals
but it's very hard to get your malicious

113
00:10:49,210 --> 00:10:55,360
content in the in the Play Store so
let's assume that there's this is true

114
00:10:55,360 --> 00:10:57,510
right let's assume that bouncer is like
this /

115
00:10:57,510 --> 00:11:02,100
perfect this is perfect actually bouncer
that can pick out everything is

116
00:11:02,100 --> 00:11:08,010
malicious why not upload the vulnerable
app instead right that's so let's take a

117
00:11:08,010 --> 00:11:12,990
simple news app that connects to a
remote server to control and fetches

118
00:11:12,990 --> 00:11:21,660
news items we control the app called we
control the server so if we make the

119
00:11:21,660 --> 00:11:28,589
appt to some Native HTTP request then we
can craft a memory corruption so easy we

120
00:11:28,590 --> 00:11:32,970
write the code so that is vulnerable to
move to park for overflow and whenever

121
00:11:32,970 --> 00:11:39,120
it connects to our server we just
exploit the buffer buffer of flow and we

122
00:11:39,120 --> 00:11:44,370
can actually two things that we want to
do without having the cold store in the

123
00:11:44,370 --> 00:11:54,420
app on our way is to use web weapon that
few vulnerabilities you can find us in

124
00:11:54,420 --> 00:11:59,400
google play this is this is what was
there my slide yesterday but I was

125
00:11:59,400 --> 00:12:03,600
talking to make yesterday and because it
is not here and i was showing in the

126
00:12:03,600 --> 00:12:09,930
demo and then yesterday evening we
suddenly got a message that RF was

127
00:12:09,930 --> 00:12:16,290
banned and our developer account was
also suspended

128
00:12:18,470 --> 00:12:26,720
so you can no longer find us in the
Google Play so this stuff that this this

129
00:12:26,720 --> 00:12:29,990
has been done before right so that the
web for vulnerabilities are materials

130
00:12:29,990 --> 00:12:36,650
and Martina hear from Vienna presented
this earlier but also having a

131
00:12:36,650 --> 00:12:38,209
vulnerable app doing stuff right

132
00:12:38,210 --> 00:12:48,620
is this be done before i do 6x5 works it
works I think we were there for 6-8

133
00:12:48,620 --> 00:12:53,510
weeks least until I spoke to me
yesterday so second thing we need to do

134
00:12:53,510 --> 00:13:00,620
is to activate the app right the apps
installed via the remote install feature

135
00:13:00,620 --> 00:13:08,480
on the user's phone and then you need
only one user interaction idol user

136
00:13:08,480 --> 00:13:13,430
clicks the app directly feed the app
icon or for you to install modification

137
00:13:13,430 --> 00:13:20,689
or you can click on the custom you ride
my app opens of me right if you click on

138
00:13:20,690 --> 00:13:22,250
this your browser

139
00:13:22,250 --> 00:13:29,150
the app will also get activated so i
have an example of ours direct

140
00:13:29,150 --> 00:13:41,209
activation works right on the left is my
phone and the right side is the is the

141
00:13:41,210 --> 00:13:47,360
compromise browser and browsing to
google that an hour and right now the

142
00:13:47,360 --> 00:13:53,060
extension so we implemented this is a
chrome extension it will it will start

143
00:13:53,060 --> 00:14:00,589
running and we'll actually push the app
onto the phone so see it happening right

144
00:14:00,590 --> 00:14:06,830
now so see they're this small icon at
the top that is actually downloading and

145
00:14:06,830 --> 00:14:16,010
in installing the app so i made a bit of
a person stopped so I thought right now

146
00:14:16,010 --> 00:14:24,290
I pull down the notification area and
it's actually our episodes thought so go

147
00:14:24,290 --> 00:14:27,719
back to the home screen will show that

148
00:14:27,720 --> 00:14:33,720
the after are now we have an icon that's
cheap backup which is not the same as me

149
00:14:33,720 --> 00:14:39,480
or two but it's the same app it's our
app that just going to stop and also if

150
00:14:39,480 --> 00:14:48,300
i go to the overview of install apps
will see their new surface and your

151
00:14:48,300 --> 00:14:53,639
servers and delicate it's not the same
as mere two wasn't the same as backup

152
00:14:53,639 --> 00:14:59,339
but it's the same app it's our app that
just got assault so i can open the g

153
00:14:59,339 --> 00:15:04,319
surface and you'll see here that the
four stop button is not available which

154
00:15:04,319 --> 00:15:07,319
means that right now tap is deactivated

155
00:15:07,980 --> 00:15:14,220
alright so go back to my home screen to
open the notification area again and now

156
00:15:14,220 --> 00:15:19,980
i will i will click on the mere to write
so we appreciate things a bit and what

157
00:15:19,980 --> 00:15:25,829
will happen it will just press or
decided to close immediately and also to

158
00:15:25,829 --> 00:15:31,170
remove the icon from the drawer so I
click it but it was very quickly see

159
00:15:31,170 --> 00:15:35,309
something popping up and your back to
the home screen i will open the tower

160
00:15:35,309 --> 00:15:42,240
again sir I open the app of you again
and you see now hear that . button is is

161
00:15:42,240 --> 00:15:47,970
clickable so this means the app is now
active got back to the home screen and

162
00:15:47,970 --> 00:15:58,500
touch are they will see here that the
g-pack of icon is gone right so only one

163
00:15:58,500 --> 00:16:08,459
click app gets install and after that
only trace you can see is if you open it

164
00:16:08,459 --> 00:16:14,128
in the app of you or if you go to play
story and look it up over here but you

165
00:16:14,129 --> 00:16:19,649
want you to enjoy right so we think this
is it is hard to detect for user click

166
00:16:19,649 --> 00:16:24,180
on the app it's open oh no now we're up
for whatever right but its active

167
00:16:24,180 --> 00:16:28,949
weather we can do interesting some the
second way

168
00:16:29,630 --> 00:16:37,310
2x10 app is using the custom your eyes
or and for this hour later we be abused

169
00:16:37,310 --> 00:16:41,630
all this synchronization techniques that
we have now that right so think you can

170
00:16:41,630 --> 00:16:44,960
do it you can send them we control the
browser so we can send an email to the

171
00:16:44,960 --> 00:16:50,450
victim itself we could put replace links
in google documents sort of the food

172
00:16:50,450 --> 00:16:51,140
actually

173
00:16:51,140 --> 00:16:55,699
first open our app before doing anything
before redirected to the original target

174
00:16:55,700 --> 00:17:02,330
we can post the URL to the facebook page
can replace recent apps grow but will

175
00:17:02,330 --> 00:17:04,910
she always replacing bookmarks

176
00:17:04,910 --> 00:17:10,280
alright so remember we control the
browser and we will replace the

177
00:17:10,280 --> 00:17:14,689
bookmarks but make sure that the
functionality remains the same so

178
00:17:14,689 --> 00:17:19,730
whenever the user will click on the
bookmark it and it will be redirected to

179
00:17:19,730 --> 00:17:29,000
the original personal euro so we
redirect the bookmarked to link to our

180
00:17:29,000 --> 00:17:33,950
control server and now depending on
whether or not to using the old or

181
00:17:33,950 --> 00:17:40,790
slightly newer chromium app for the old
version the our control our webserver

182
00:17:40,790 --> 00:17:46,730
real immediately trigger and intent
redirect that will open our app and then

183
00:17:46,730 --> 00:17:53,300
our app will redirect to the to find a
bookmark or if you're new grown-up bad

184
00:17:53,300 --> 00:18:03,290
to redirect after the user touches the
sweet then one once this is all in place

185
00:18:03,290 --> 00:18:08,000
we can intercept messages right we have
control over the phone so we install an

186
00:18:08,000 --> 00:18:13,970
SMS receiver and then for each incoming
SMS we store it we detect them or two

187
00:18:13,970 --> 00:18:19,820
factors against it goes and with Alito's
only on peak at get though because it's

188
00:18:19,820 --> 00:18:25,939
not no longer possible for for later and
revision we send the webview request to

189
00:18:25,940 --> 00:18:31,880
our militia server we download an excuse
to come back to motel and then we have

190
00:18:31,880 --> 00:18:35,870
control of the buying up over browser of
course already so we can login into our

191
00:18:35,870 --> 00:18:37,729
banking environment

192
00:18:37,730 --> 00:18:43,760
initial transaction and then received
the SMS and confirm the transaction

193
00:18:43,760 --> 00:18:52,820
forty percent of the users soon on Pete
get so this means that for those users

194
00:18:52,820 --> 00:18:58,429
they won't see anything happening our
users we all will see that encode that

195
00:18:58,430 --> 00:19:07,400
they cannot explain in the SMS inbox
right so a live demo at least that

196
00:19:07,400 --> 00:19:13,730
that's what I had planned we are
actually on good terms with the banks so

197
00:19:13,730 --> 00:19:18,530
i wanted to show something else want to
break google authenticator because I had

198
00:19:18,530 --> 00:19:23,420
a talk on Wednesday with Andrew and it
was saying yeah i'm i'm using google

199
00:19:23,420 --> 00:19:29,810
authenticator right so it's not SMS so
that save I said yes but then I started

200
00:19:29,810 --> 00:19:36,649
looking into it a bit more and actually
it's it's it's also SMS so we can break

201
00:19:36,650 --> 00:19:38,630
this so like them over

202
00:19:38,630 --> 00:19:46,460
I talked to nick of course our appt got
to dance so it won't be a live demo it

203
00:19:46,460 --> 00:19:54,140
would just be a video so let's go there
and the first beginning is the same as i

204
00:19:54,140 --> 00:20:00,080
said earlier i go to the google pays the
extensions get activated and it will

205
00:20:00,080 --> 00:20:02,030
download the app

206
00:20:02,030 --> 00:20:13,280
alright i will show that episode expert
i will now swipe away the notification

207
00:20:13,280 --> 00:20:25,010
area notification i will show again that
there's a new icon and we show here that

208
00:20:25,010 --> 00:20:28,850
the APIs is stopped

209
00:20:28,850 --> 00:20:30,520
it's not active

210
00:20:30,520 --> 00:20:39,280
ok so right now we go to the to bookmark
on my browser and the phone and I want

211
00:20:39,280 --> 00:20:46,210
bookmark it's the wikipedia page of mr.
robot i click on it

212
00:20:47,680 --> 00:20:54,400
alright and what will happen ' now so
what happens is instead of going to WIC

213
00:20:54,400 --> 00:21:01,660
benefits i go to my own web server and
the web server i provide the web server

214
00:21:01,660 --> 00:21:07,000
as a parameter the actual URL the
original URL of the bookmark and among

215
00:21:07,000 --> 00:21:12,610
the latest version of chrome so my
server will do is will you all download

216
00:21:12,610 --> 00:21:23,740
wikipedia page to show it to me so
she'll happening right now and since it

217
00:21:23,740 --> 00:21:30,700
cannot directly redirecting intense to
our to our appt I had to inject some

218
00:21:30,700 --> 00:21:34,690
JavaScript code that now whenever the
user to touch the screen it will

219
00:21:34,690 --> 00:21:41,500
actually do the redirect so i will now
scroll and you will see a couple

220
00:21:41,500 --> 00:21:45,880
flashing screens and then in the end
you'll see that we could be the pits of

221
00:21:45,880 --> 00:21:59,320
mr. up coming up so scroll down they go
oh yes I'm wikipedia ok so i think i was

222
00:21:59,320 --> 00:22:03,040
showing her again that yes the icon this
removed

223
00:22:06,250 --> 00:22:14,830
and the app is active alright so we can
now install receive messages

224
00:22:16,570 --> 00:22:25,570
ok so i'm back to my to my browser i'm
going to log out of google and I've set

225
00:22:25,570 --> 00:22:30,639
up this two-factor authentication
thinking so I sign in again type in my

226
00:22:30,640 --> 00:22:39,610
password and then i have to enter the
six digit code which is what you get

227
00:22:39,610 --> 00:22:45,879
from the google authenticator app right
but there's also this this feature try

228
00:22:45,880 --> 00:22:55,000
another way to sign in so that's click
on that and yes school

229
00:22:55,000 --> 00:23:00,430
you can also send the text message to
your phone right and in my case the

230
00:23:00,430 --> 00:23:05,200
google authenticator is running on the
same phone that also has this phone

231
00:23:05,200 --> 00:23:08,200
number so if I just click that button

232
00:23:08,770 --> 00:23:20,590
alright i will receive an incoming SMS
on my phone yes there is

233
00:23:20,590 --> 00:23:26,649
and meanwhile my remote server higher
net cut listening for incoming

234
00:23:26,650 --> 00:23:35,170
connections and I just got the incoming
connected from my mobile thought so from

235
00:23:35,170 --> 00:23:41,020
here on it's just basic shelter can
execute commands while as as being the

236
00:23:41,020 --> 00:23:42,040
app right

237
00:23:42,040 --> 00:23:50,409
r ab I could go to our data directory
and so what's there

238
00:23:55,490 --> 00:24:02,660
and then you will see here the SMS that
we received right so we'll just copy

239
00:24:02,660 --> 00:24:09,559
paste the code come back to the browser
and login

240
00:24:15,679 --> 00:24:22,820
alright so we think this is this issue
right i think users will be will be

241
00:24:22,820 --> 00:24:29,720
possible for this user will be tricked
into into into getting this on the phone

242
00:24:29,720 --> 00:24:37,130
so how should this be fixed we think
that Google should always require on

243
00:24:37,130 --> 00:24:41,750
phone confirmation for app installs so
if you enjoy every browser make sure

244
00:24:41,750 --> 00:24:47,120
that also on your phone you get these
messages saying hey you're going to

245
00:24:47,120 --> 00:24:51,020
install this app on your phone are you
sure you want to continue it is or maybe

246
00:24:51,020 --> 00:24:58,129
you're not so sure and want to leave it
here also this activation by clicking on

247
00:24:58,130 --> 00:25:06,500
the on URLs is something to debate right
it really something that we want to have

248
00:25:06,500 --> 00:25:15,080
or maybe two we kill that then this
remote install feature i will just

249
00:25:15,080 --> 00:25:22,220
disabled I don't see any real
improvement that brings or at least make

250
00:25:22,220 --> 00:25:26,750
it optional right so i can turn it off
and then also something that perhaps

251
00:25:26,750 --> 00:25:30,110
it's some attention is looking at the
hiring tricks that we that we use to

252
00:25:30,110 --> 00:25:36,439
hire app I think it's all features that
we exploit but it's really questionable

253
00:25:36,440 --> 00:25:41,780
whether or not this is something that
you want to have as a feature but so

254
00:25:41,780 --> 00:25:46,399
user the user because we've been in
contact with google for a while and

255
00:25:46,400 --> 00:25:52,220
they're not sure where is really an
issue but the user until the fixes now

256
00:25:52,220 --> 00:25:56,630
what's out for unknown app installs
right and perhaps even use a separate

257
00:25:56,630 --> 00:26:01,760
account for any thought so that this
synchronization installing about apps

258
00:26:01,760 --> 00:26:07,450
doesn't work and finally the google
authenticator user

259
00:26:07,450 --> 00:26:14,169
set up a backup number 444 number that
is not on the same smart on the

260
00:26:14,169 --> 00:26:20,320
smartphone on android phone right just
by old nokia and use that one as a

261
00:26:20,320 --> 00:26:22,330
backup power

262
00:26:22,330 --> 00:26:27,610
ok so that was that's that's that's how
we think that Google killed two factors

263
00:26:27,610 --> 00:26:34,240
education right i think i have some time
right so let's also wanted to talk a

264
00:26:34,240 --> 00:26:43,149
little bit about the reactions so that
I'm here some of the beginning so we

265
00:26:43,149 --> 00:26:47,500
found this think play 2014

266
00:26:47,500 --> 00:26:53,230
we tried to set up some stuff and we
first contacted google like me

267
00:26:53,230 --> 00:26:57,340
acceptable just sent to email to
security intercom so we did that and

268
00:26:57,340 --> 00:27:02,799
report our findings right and then a
couple days later with a response and

269
00:27:02,799 --> 00:27:06,399
they were saying this attack is
medicated in two ways one there's

270
00:27:06,399 --> 00:27:12,518
bouncer with your which will stop
everything malicious in place where at

271
00:27:12,519 --> 00:27:16,990
to theirs at activation so we must admit
that at the time we didn't really know

272
00:27:16,990 --> 00:27:23,440
about that activation right so we need
to look into that mean now we were also

273
00:27:23,440 --> 00:27:25,149
involved in this

274
00:27:25,149 --> 00:27:30,399
that's research project called mal pay
that involves all the three major touch

275
00:27:30,399 --> 00:27:36,879
banks ABN amro bank and ing and two desk
at the demonstration there and the

276
00:27:36,880 --> 00:27:45,639
letter ing these guys use sms-based
two-factor education to confirm your

277
00:27:45,639 --> 00:27:54,250
transactions right and they were not
happy because the attack that we

278
00:27:54,250 --> 00:27:59,590
demonstrate it does not require any user
interaction anymore after the apps

279
00:27:59,590 --> 00:28:07,209
activated so that could take place in
the middle of the night usually wake up

280
00:28:07,210 --> 00:28:12,820
and we'll see some 10 codes and SMS
inbox you would log into his bank

281
00:28:12,820 --> 00:28:13,820
account and

282
00:28:13,820 --> 00:28:23,570
it will be empty but then after having a
month later we got to the point where we

283
00:28:23,570 --> 00:28:30,230
have written attack paper on this and we
send a copy of it to google and got a

284
00:28:30,230 --> 00:28:38,060
response related marks and the ability
to launch an inactive app from the

285
00:28:38,060 --> 00:28:41,870
browser feeling intent is not
intentional and we have opened an

286
00:28:41,870 --> 00:28:51,889
internal back alright there's this thing
in the Netherlands is called ncsc it's

287
00:28:51,890 --> 00:28:56,900
adults national cybersecurity Center and
they say that they're the central hop

288
00:28:56,900 --> 00:29:00,290
and center of expertise for
cybersecurity and villains so we set

289
00:29:00,290 --> 00:29:05,120
them also a copy of our of our paper and
responsibilities at school but it's not

290
00:29:05,120 --> 00:29:12,199
within our research and development
policies so that later also at the ncc

291
00:29:12,200 --> 00:29:22,310
cadets and Herbert gift demonstration
there the ncsu one conference and things

292
00:29:22,310 --> 00:29:28,879
were not moving right there in store we
respond from google coming in and ncc

293
00:29:28,880 --> 00:29:34,070
was not interested so we decided to go
public right so we were in contact with

294
00:29:34,070 --> 00:29:37,850
folks ground which is one of the big
bucks newspapers and the published this

295
00:29:37,850 --> 00:29:44,570
article it says big vulnerability in the
North thoughts right over on patreon the

296
00:29:44,570 --> 00:29:51,620
considered a newspaper and very soon
this was copied by all all major or dots

297
00:29:51,620 --> 00:29:55,489
new stations in the Netherlands and if
we went international because the

298
00:29:55,490 --> 00:30:00,260
concept from paper and the Morgan there
are belgium newspaper so weird internet

299
00:30:00,260 --> 00:30:07,940
already so then a little side story of
how this video works right so couple

300
00:30:07,940 --> 00:30:10,940
days later after the the first Argonne
forest won't we

301
00:30:11,750 --> 00:30:18,860
they published on another article
follow-up one slightly more details but

302
00:30:18,860 --> 00:30:23,810
on purpose we released very few
specifics about the attack

303
00:30:24,340 --> 00:30:31,779
right but no journalist or blogger these
days not no one cared to contact us and

304
00:30:31,779 --> 00:30:35,049
ask hey what's up buddy doing I don't
understand this aspect of your attack

305
00:30:35,049 --> 00:30:37,418
but i need two more details

306
00:30:37,419 --> 00:30:41,440
instead we were being slaughtered by the
media right all this is nothing new this

307
00:30:41,440 --> 00:30:46,960
be done already are your opening selling
his attack but just use a strong

308
00:30:46,960 --> 00:30:50,049
password and you're safe and bouncer

309
00:30:50,049 --> 00:30:56,139
yes bouncer real or law will help help
us and always make sure that no

310
00:30:56,140 --> 00:31:00,340
malicious app will be in there in the
absolute right and then the rest is

311
00:31:00,340 --> 00:31:03,100
computer world magazine with your
fingers

312
00:31:03,100 --> 00:31:09,969
european or global and the deficiency
among countries there was this article

313
00:31:09,970 --> 00:31:17,770
by this this reporter for the real world
and instead was a piece of postures blah

314
00:31:17,770 --> 00:31:25,418
blah about big Android league and few vu
researchers and media raise fit so I had

315
00:31:25,419 --> 00:31:29,679
to look about that means it's fear
uncertainty and doubt or in other words

316
00:31:29,679 --> 00:31:39,130
we were guilty of fear-mongering right
this block it attracts 200,000 business

317
00:31:39,130 --> 00:31:44,980
a month so we invited the author to have
a chapter because you get your office we

318
00:31:44,980 --> 00:31:50,529
SAT there for three hours or so and then
two weeks later he revisited or post the

319
00:31:50,529 --> 00:31:56,289
new article i was still might be
negative but in the end he did agree did

320
00:31:56,289 --> 00:32:00,879
actually write this that google kill the
added value of mobile phone to factory

321
00:32:00,880 --> 00:32:09,640
education also what we did is we set up
a web page with frequently asked

322
00:32:09,640 --> 00:32:15,429
questions to address all the comments we
got from the experts what you can do and

323
00:32:15,429 --> 00:32:21,220
that is actually really an issue that
two-factor authentication is actually

324
00:32:21,220 --> 00:32:29,649
intended to to stop man in the browser
attacks right and after that fix fix a

325
00:32:29,649 --> 00:32:35,350
little bit up to the end of love to lie
when we got a reply from google so

326
00:32:35,350 --> 00:32:40,330
meanwhile he has been in contact with
couple of a google engineers and I

327
00:32:40,330 --> 00:32:44,980
personally communicated that they agree
with our assessment but you reply we got

328
00:32:44,980 --> 00:32:46,539
from the from the email

329
00:32:46,539 --> 00:32:50,890
what's the following so this is copy
paste right there was a lot of

330
00:32:50,890 --> 00:32:54,280
discussion about this but in the end we
decided that things are working as

331
00:32:54,280 --> 00:32:58,780
intended and we have no played floor
plans change the behavior

332
00:32:59,860 --> 00:33:07,629
moreover the email that they were saying
that they also look at our records and

333
00:33:07,630 --> 00:33:12,280
we supposed to make misleading
statements right so three things not all

334
00:33:12,280 --> 00:33:15,370
permissions are available so i think
somewhere on the pits at the air you can

335
00:33:15,370 --> 00:33:19,449
do whatever you want but yes of course
you don't have this information right

336
00:33:19,450 --> 00:33:27,520
and it doesn't kill all forms of mobile
phone to fa well I sort of disagree but

337
00:33:27,520 --> 00:33:33,668
alright and the other at later android
versions SMS going to be deleted it

338
00:33:33,669 --> 00:33:41,350
in addition they they concluded the
email saying that google has sufficient

339
00:33:41,350 --> 00:33:46,899
or enter that sufficient security
barriers in place to stop this attack is

340
00:33:46,899 --> 00:33:51,639
six points bringing up so one is first
11 victims bc your browser must be

341
00:33:51,639 --> 00:33:57,039
compromised right yes but that's why we
have that's the threat model of to have

342
00:33:57,039 --> 00:34:04,149
a right so this the resumption that that
the browser is is compromised second set

343
00:34:04,149 --> 00:34:09,159
is attacker must upload the militia up
to play so yeah I'm saying here you can

344
00:34:09,159 --> 00:34:14,230
still down there out but of course it
was it was bad yesterday but I'm pretty

345
00:34:14,230 --> 00:34:16,570
confident that this is possible right

346
00:34:16,570 --> 00:34:22,720
you cannot static and dynamic analysis
will not be enough to to detect every

347
00:34:22,719 --> 00:34:31,000
malicious activity in a nap then the
victim must afford noticing that the

348
00:34:31,000 --> 00:34:37,960
malicious app was uploaded to play so I
think he meant phone so this means that

349
00:34:37,960 --> 00:34:44,710
the victim was not see our avenue apt i
will i'll just delete it ever will

350
00:34:44,710 --> 00:34:49,359
answer as is shown if you have this app
is installed message which is the only

351
00:34:49,359 --> 00:34:53,918
thing you see and if you click on it it
will actually help us to activate stuff

352
00:34:53,918 --> 00:34:56,500
and the message the notification will be
gone

353
00:34:56,500 --> 00:35:04,240
that will be very hard to find on your
phone so i think this is also not a

354
00:35:04,240 --> 00:35:11,890
really strong . then for was the victim
must either manually activate the app or

355
00:35:11,890 --> 00:35:17,470
click a link and activates the app so we
need some social engineering or of

356
00:35:17,470 --> 00:35:20,919
course we can exploit the
synchronization usability features that

357
00:35:20,920 --> 00:35:29,440
we have these days like getting
bookmarks or recent apps five was the

358
00:35:29,440 --> 00:35:33,280
victim must be using an sms-based
two-factor authentication mechanism for

359
00:35:33,280 --> 00:35:38,770
that bank and not a nap or hardware
token based mechanism writer so does

360
00:35:38,770 --> 00:35:44,650
this mean that Google's saying sms-based
to face obsolete because it if it's true

361
00:35:44,650 --> 00:35:49,480
then we should all call banks that are
still using is and tell them to switch

362
00:35:49,480 --> 00:35:53,890
right right now not tomorrow right now
so it's right now don't worry about the

363
00:35:53,890 --> 00:35:56,830
cost right needs to be done

364
00:35:56,830 --> 00:36:04,270
moreover the fall back for those apps so
hardware tokens are are good thing right

365
00:36:04,270 --> 00:36:12,339
but the focus for us apps is SMS right
google self is still using SMS as a way

366
00:36:12,339 --> 00:36:19,330
to to deploy to evade for your account
so this this statement was I think it's

367
00:36:19,330 --> 00:36:20,799
just plain wrong

368
00:36:20,800 --> 00:36:25,900
and finally the the victim will still
immediately see that an sms-based n

369
00:36:25,900 --> 00:36:32,170
comes in and he can contact the back
right so one thing is that for forty

370
00:36:32,170 --> 00:36:37,660
percent of the uses this is not true and
additionally do you call your bank

371
00:36:37,660 --> 00:36:44,170
if you receive a weird tan coat right
and to check for 10 coats between in the

372
00:36:44,170 --> 00:36:58,599
morning and your mom or your sister so I
asked nick about this feels really cool

373
00:36:58,599 --> 00:37:02,589
he was here but first the current
attempt to stop and I asked him to

374
00:37:02,589 --> 00:37:09,279
comment on this writers have the slides
and the demos and i think is concerned

375
00:37:09,280 --> 00:37:14,049
and I think that we will see some
changes or at least some reactions he

376
00:37:14,049 --> 00:37:17,109
didn't have an official statement
because google doesn't do official

377
00:37:17,109 --> 00:37:23,828
statements but i think i think we will
see some changes coming soon rights are

378
00:37:23,829 --> 00:37:28,930
in conclusions we think this is serious
right we think is a serious but although

379
00:37:28,930 --> 00:37:33,339
it's very hard to convince the experts
because you don't have you don't have a

380
00:37:33,339 --> 00:37:39,940
buffer overflow to explain right it's
this is a design feature and it is

381
00:37:39,940 --> 00:37:41,260
easier to show

382
00:37:41,260 --> 00:37:47,230
oh yes you can do a rocket attack on
this very very cool modern software

383
00:37:47,890 --> 00:37:56,618
yes that's about but this it's not
really about feature right we got mixed

384
00:37:56,619 --> 00:37:59,049
reactions from google but we sure have

385
00:37:59,049 --> 00:38:04,690
if their attention and I do hope that
things will get better soon we look at

386
00:38:04,690 --> 00:38:10,180
iOS and Windows Phone they have similar
features to remotely install apps the

387
00:38:10,180 --> 00:38:20,950
phone right but so far we didn't really
find API to read messages yet right

388
00:38:20,950 --> 00:38:28,149
this may change in the future and there
is on easy easy fix that will work on

389
00:38:28,150 --> 00:38:33,490
all versions of Android red just have
explicit activation when your phone

390
00:38:33,490 --> 00:38:41,169
whenever you install app from your
browser for our I think that it is safe

391
00:38:41,170 --> 00:38:45,400
to say that mobile phone to have a at
this based on SMS seems to be tuned

392
00:38:45,400 --> 00:38:49,480
right and i also think that financial
institutions who come to the same

393
00:38:49,480 --> 00:38:49,999
conclusion

394
00:38:49,999 --> 00:38:54,948
and will over the next few years try to
phase out the use of mobile phone to

395
00:38:54,949 --> 00:38:55,759
fame

396
00:38:55,759 --> 00:39:00,949
finally the the one thing I learned from
is that the media's mostly clueless

397
00:39:00,949 --> 00:39:04,939
so if you ever have something that you
want to share with media make sure that

398
00:39:04,939 --> 00:39:10,428
you're very precise your statements make
sure you do your your various circuit

399
00:39:10,429 --> 00:39:18,259
also try to be as is as real as precise
as possible don't don't send them large

400
00:39:18,259 --> 00:39:22,099
videos are those presentations there
will only be interested for the first

401
00:39:22,099 --> 00:39:25,699
part minutes after that we will continue
with your work

402
00:39:26,779 --> 00:39:30,139
it's really hard to deal with the media
in this cases

403
00:39:30,139 --> 00:39:33,139
alright so that's it

404
00:39:33,139 --> 00:39:37,639
this is the link to our all the
four-hour rapids

405
00:39:39,079 --> 00:39:42,469
yeah so thank you very attention

406
00:39:50,080 --> 00:39:59,170
I thanks for the great talk

407
00:39:59,170 --> 00:40:04,510
it seems that people are moving away
from using pcs and mobile devices are

408
00:40:04,510 --> 00:40:09,190
becoming the standard endpoint devices
if someone solely using the mobile

409
00:40:09,190 --> 00:40:13,030
device to perform their banking
transactions i would that change this

410
00:40:13,030 --> 00:40:17,080
analysis so you mean that the rotten are
you have mobile app to do all the

411
00:40:17,080 --> 00:40:22,270
different software taken all year right
I guess right in your case the rankings

412
00:40:22,270 --> 00:40:26,770
being the U is being done on a personal
computer yes but if it's what if yes

413
00:40:26,770 --> 00:40:30,040
what are going to move on is not scared
they're just using their phone so i

414
00:40:30,040 --> 00:40:33,910
think one thing to notice is step that
all the people i think we'll still he

415
00:40:33,910 --> 00:40:37,779
was the computer for quite some time
instead of moving through device but yes

416
00:40:37,780 --> 00:40:42,940
I think one of my conclusions was that
while doing this work if you just use an

417
00:40:42,940 --> 00:40:47,860
app only to do all the transactions it's
actually safer than using a browser and

418
00:40:47,860 --> 00:40:52,690
the phone so its kinda contradiction but
i think it's true yes

419
00:40:52,690 --> 00:40:58,090
ok so you sort of saying that bc is easy
to compromise and someone can take over

420
00:40:58,090 --> 00:41:02,200
the web browser that I'm a phone it's
much more difficult to do that i'm not

421
00:41:02,200 --> 00:41:02,890
sure

422
00:41:02,890 --> 00:41:05,890
boxing I'm not sure that's really true

423
00:41:07,710 --> 00:41:12,869
I think yes so with the sandboxing on
mobiles is really hard for one app to

424
00:41:12,869 --> 00:41:18,720
access data from another app while the
pc if you have some point it's more easy

425
00:41:18,720 --> 00:41:23,189
to get the root on pc and do everything
you want right inset everything so yes I

426
00:41:23,190 --> 00:41:26,190
think that's think it's actually true
thanks

427
00:41:37,339 --> 00:41:43,489
easy two factor authentication coming
back with the mobile phone being the uid

428
00:41:43,489 --> 00:41:48,680
end . instead of being the second factor
sorry can you see with with that

429
00:41:48,680 --> 00:41:52,940
assumption of the mobile phone being
this real endpoint of the transaction is

430
00:41:52,940 --> 00:42:00,499
being started with what would you see as
the second factor coming back to that so

431
00:42:00,499 --> 00:42:07,038
I think for I think for banks just to
seduce a smart card reader or whatever

432
00:42:07,039 --> 00:42:12,920
right stuff something that's which is
only purpose to to deal with the second

433
00:42:12,920 --> 00:42:17,809
factor and not something that's also
used for for internet browsing forever

434
00:42:17,809 --> 00:42:27,589
in connection to the last question when
I want to make replace the to affect

435
00:42:27,589 --> 00:42:32,509
authentication for services to the unit
using everyday life like my login to

436
00:42:32,509 --> 00:42:37,279
Google at some pc what do you think
would be cool alternative student one

437
00:42:37,279 --> 00:42:42,289
that we currently use in our mobile
devices alternatives for a google

438
00:42:42,289 --> 00:42:46,009
authenticator you mean yes in everyday
life like not for the banking that I

439
00:42:46,009 --> 00:42:50,509
need a karen explicit card for $MONEY i
think i think google authenticator and

440
00:42:50,509 --> 00:42:54,979
also marks of Microsoft as your
authenticator is they're actually good

441
00:42:54,979 --> 00:42:59,598
things but the problem is with the
backup option right so what if you don't

442
00:42:59,599 --> 00:43:06,950
have your smartphone you can still send
an SMS message so that should probably

443
00:43:06,950 --> 00:43:12,739
find a way to get that out of the way so
yes there should be a backup option but

444
00:43:12,739 --> 00:43:16,640
make sure that this backup option is not
actually using SMS but a different

445
00:43:16,640 --> 00:43:23,538
communication general or send it to a
non non mobile phone on mobile

446
00:43:23,539 --> 00:43:26,539
smartphone

447
00:43:32,960 --> 00:43:38,270
so part of the problem with two factors
education he was using SMS the channel

448
00:43:38,270 --> 00:43:42,200
from browser to mobile phone so what do
you think about other channels between

449
00:43:42,200 --> 00:43:46,580
browser and mobile phones have seen
example QR codes which is again with

450
00:43:46,580 --> 00:43:51,500
your mobile phone camera which then
generate a code is something like that

451
00:43:51,500 --> 00:44:00,800
safer or do you see where i'm not sure
exactly so I think Nick was also seeing

452
00:44:00,800 --> 00:44:06,050
the same that the problem with SMS is
that it's it's like as shared data

453
00:44:06,050 --> 00:44:11,420
protocol right so everybody can exit so
yes if you can find other communication

454
00:44:11,420 --> 00:44:16,070
channels that narrow down the
availability then just think it's a a a

455
00:44:16,070 --> 00:44:24,080
good good approach this and thanks again

