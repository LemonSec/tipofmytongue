1
00:00:03,800 --> 00:00:08,100
thank you very much yeah my name is

2
00:00:06,270 --> 00:00:09,750
<font color="#E5E5E5">Matias</font><font color="#CCCCCC"> teak and in the next couple of</font>

3
00:00:08,100 --> 00:00:12,000
minutes I want to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about the</font>

4
00:00:09,750 --> 00:00:16,170
security of wireless desktop sets

5
00:00:12,000 --> 00:00:19,079
wireless mice and wireless keyboards so

6
00:00:16,170 --> 00:00:21,180
yeah a few<font color="#CCCCCC"> rosabel mean I work as an ITC</font>

7
00:00:19,079 --> 00:00:23,730
IT security consultant for a company

8
00:00:21,180 --> 00:00:25,140
<font color="#CCCCCC">called sis and yeah</font><font color="#E5E5E5"> it still pays the</font>

9
00:00:23,730 --> 00:00:28,919
rent and<font color="#CCCCCC"> I'm interested in information</font>

10
00:00:25,140 --> 00:00:31,200
security since my early days yeah and i

11
00:00:28,919 --> 00:00:33,510
still have fun doing this I did this

12
00:00:31,200 --> 00:00:35,730
research together with my colleague if

13
00:00:33,510 --> 00:00:38,129
you have<font color="#CCCCCC"> closed the meijer he couldn't</font>

14
00:00:35,730 --> 00:00:40,858
be here today yeah he's also very

15
00:00:38,129 --> 00:00:42,989
interested in information security and

16
00:00:40,859 --> 00:00:45,269
with it this research as i said before

17
00:00:42,989 --> 00:00:48,959
together over the last couple of months

18
00:00:45,269 --> 00:00:51,179
actually so the agenda<font color="#CCCCCC"> for this talk we</font>

19
00:00:48,960 --> 00:00:52,920
have a few points at<font color="#E5E5E5"> first I want to</font>

20
00:00:51,179 --> 00:00:56,600
shortly introduce you to the use

21
00:00:52,920 --> 00:00:59,850
technology<font color="#E5E5E5"> I will gonna talk about down</font>

22
00:00:56,600 --> 00:01:01,800
yeah I would mention the previous work

23
00:00:59,850 --> 00:01:04,769
of other researchers our research is

24
00:01:01,800 --> 00:01:08,429
actually based on then I will give a

25
00:01:04,769 --> 00:01:09,990
short overview of<font color="#CCCCCC"> our research talk</font>

26
00:01:08,430 --> 00:01:12,299
about the attack surface and a text

27
00:01:09,990 --> 00:01:14,908
scenario is concerning wireless desktop

28
00:01:12,299 --> 00:01:17,549
sets well as much polish keyboards then

29
00:01:14,909 --> 00:01:20,159
the interesting part is the phone

30
00:01:17,549 --> 00:01:24,299
security vulnerabilities there will

31
00:01:20,159 --> 00:01:26,700
hopefully be also live demos I have one

32
00:01:24,299 --> 00:01:28,520
<font color="#E5E5E5">set up here I hope it works and of</font>

33
00:01:26,700 --> 00:01:30,840
course there's conclusion and

34
00:01:28,520 --> 00:01:34,710
recommendation and if we have<font color="#E5E5E5"> still time</font>

35
00:01:30,840 --> 00:01:37,049
some Q & A<font color="#E5E5E5"> okay so what</font><font color="#CCCCCC"> are going to</font>

36
00:01:34,710 --> 00:01:39,119
<font color="#E5E5E5">talk about is wireless desktop sets so</font>

37
00:01:37,049 --> 00:01:40,680
you can see here on the upper side<font color="#CCCCCC"> of</font>

38
00:01:39,119 --> 00:01:42,539
the picture of wireless des obsessed<font color="#E5E5E5"> is</font>

39
00:01:40,680 --> 00:01:46,409
just a<font color="#CCCCCC"> combination of wireless keyboard</font>

40
00:01:42,539 --> 00:01:48,359
wireless mouse and a USB<font color="#E5E5E5"> dongle that is</font>

41
00:01:46,409 --> 00:01:51,359
working<font color="#CCCCCC"> as a receiver and gets connected</font>

42
00:01:48,359 --> 00:01:53,429
to a PC on the<font color="#E5E5E5"> lower side of the picture</font>

43
00:01:51,359 --> 00:01:57,538
you can see some of the devices we used

44
00:01:53,430 --> 00:01:58,920
for our research purposes so I<font color="#E5E5E5"> for</font>

45
00:01:57,539 --> 00:02:02,130
example use the heck are f1

46
00:01:58,920 --> 00:02:06,719
software-defined radio later on we used

47
00:02:02,130 --> 00:02:09,000
a crazy radio PA um<font color="#CCCCCC"> Garretson specific</font>

48
00:02:06,719 --> 00:02:12,239
device using the same technology as our

49
00:02:09,000 --> 00:02:13,910
target devices and nowadays you can also

50
00:02:12,240 --> 00:02:16,130
do

51
00:02:13,910 --> 00:02:18,079
these kinds of attacks I show you using

52
00:02:16,130 --> 00:02:19,910
low-cost devices like a Logitech

53
00:02:18,080 --> 00:02:21,920
unifying receiver thanks to the steel

54
00:02:19,910 --> 00:02:24,890
networks because<font color="#E5E5E5"> I found out that they</font>

55
00:02:21,920 --> 00:02:27,950
can you that<font color="#E5E5E5"> you can actually reprogram</font>

56
00:02:24,890 --> 00:02:31,459
these devices they cost about 16 euros

57
00:02:27,950 --> 00:02:33,519
16 to 20 euros and you can do all<font color="#CCCCCC"> the</font>

58
00:02:31,460 --> 00:02:38,360
kinds<font color="#CCCCCC"> of attacks you will see later on</font>

59
00:02:33,520 --> 00:02:41,030
using such a unifying receiver<font color="#CCCCCC"> okay so</font>

60
00:02:38,360 --> 00:02:43,850
how do wireless keyboards actually work

61
00:02:41,030 --> 00:02:46,700
what I'm talking about well you have

62
00:02:43,850 --> 00:02:50,239
wireless devices mouse and keyboard and

63
00:02:46,700 --> 00:02:51,890
yeah they're just sending keystrokes in

64
00:02:50,240 --> 00:02:53,510
the case of the keywords<font color="#E5E5E5"> to use be</font>

65
00:02:51,890 --> 00:02:55,339
Donell in the case of the mouse mouse

66
00:02:53,510 --> 00:02:57,530
actions like novice movements or mouse

67
00:02:55,340 --> 00:03:00,620
clicks and the communication actually is

68
00:02:57,530 --> 00:03:02,620
not unidirectional but<font color="#CCCCCC"> your golden bull</font>

69
00:03:00,620 --> 00:03:05,690
goes in both directions they are not

70
00:03:02,620 --> 00:03:09,920
acknowledgments but they are not that

71
00:03:05,690 --> 00:03:12,620
important here okay and our research

72
00:03:09,920 --> 00:03:14,450
actually is based on the research of

73
00:03:12,620 --> 00:03:20,330
other<font color="#CCCCCC"> risks researchers as mentioned</font>

74
00:03:14,450 --> 00:03:23,119
before back in 2009 and 27 2010 there

75
00:03:20,330 --> 00:03:26,510
was a kicker<font color="#CCCCCC"> aqui in version one version</font>

76
00:03:23,120 --> 00:03:29,720
to this project targeted for example

77
00:03:26,510 --> 00:03:31,790
microsoft wireless desktop sets and the

78
00:03:29,720 --> 00:03:34,100
guys doing it from dream like a dream

79
00:03:31,790 --> 00:03:36,260
life technologies also<font color="#CCCCCC"> reverse</font>

80
00:03:34,100 --> 00:03:38,269
engineered<font color="#CCCCCC"> some proprietary</font><font color="#E5E5E5"> encryption</font>

81
00:03:36,260 --> 00:03:41,530
of the wireless keyboard and they were

82
00:03:38,270 --> 00:03:44,810
able to<font color="#E5E5E5"> attack devices back then in</font>

83
00:03:41,530 --> 00:03:50,239
2011-12<font color="#CCCCCC"> is good speed published a paper</font>

84
00:03:44,810 --> 00:03:54,350
on a blog article about sniffing using a

85
00:03:50,239 --> 00:03:58,610
specific<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of transceiver</font><font color="#CCCCCC"> nemidi NRF</font>

86
00:03:54,350 --> 00:04:02,000
24 and last<font color="#E5E5E5"> year as part of the NSA</font>

87
00:03:58,610 --> 00:04:04,820
<font color="#E5E5E5">playset semi come car released the key</font>

88
00:04:02,000 --> 00:04:08,900
sweeper it's an improvement<font color="#E5E5E5"> to the</font>

89
00:04:04,820 --> 00:04:12,590
research done<font color="#E5E5E5"> by the Hickory key team</font>

90
00:04:08,900 --> 00:04:15,470
actually<font color="#E5E5E5"> add in February this year but</font>

91
00:04:12,590 --> 00:04:18,519
still networks released several

92
00:04:15,470 --> 00:04:24,229
vulnerabilities they called<font color="#CCCCCC"> mouse check</font>

93
00:04:18,519 --> 00:04:26,889
here and we<font color="#CCCCCC"> actually get something the</font>

94
00:04:24,229 --> 00:04:29,680
same so our research

95
00:04:26,889 --> 00:04:32,860
started way back in<font color="#CCCCCC"> April 2015 it</font>

96
00:04:29,680 --> 00:04:35,889
started as a customer project where we

97
00:04:32,860 --> 00:04:40,029
<font color="#E5E5E5">had a look at three specific IES</font>

98
00:04:35,889 --> 00:04:41,650
encrypted wireless desktop sense but we

99
00:04:40,029 --> 00:04:44,289
only had limited<font color="#CCCCCC"> time and</font><font color="#E5E5E5"> we were not</font>

100
00:04:41,650 --> 00:04:46,748
that content with<font color="#E5E5E5"> the results and we</font>

101
00:04:44,289 --> 00:04:48,370
thought there must be more to it so we

102
00:04:46,749 --> 00:04:50,439
started a research project over<font color="#E5E5E5"> the last</font>

103
00:04:48,370 --> 00:04:53,639
few<font color="#CCCCCC"> month it was a very</font><font color="#E5E5E5"> fragmented</font>

104
00:04:50,439 --> 00:04:56,080
research project because there were

105
00:04:53,639 --> 00:04:59,860
always more important things to do like

106
00:04:56,080 --> 00:05:02,109
earning money<font color="#E5E5E5"> okay on this picture you</font>

107
00:04:59,860 --> 00:05:05,050
<font color="#E5E5E5">can see the five devices we had a look</font>

108
00:05:02,110 --> 00:05:08,469
at it was money buys from cherry one

109
00:05:05,050 --> 00:05:12,219
from Microsoft fujitsu logitech and also

110
00:05:08,469 --> 00:05:15,279
<font color="#CCCCCC">perixx we have chosen</font><font color="#E5E5E5"> those devices by</font>

111
00:05:12,219 --> 00:05:18,520
the<font color="#E5E5E5"> project we initially did and then we</font>

112
00:05:15,279 --> 00:05:22,120
<font color="#E5E5E5">just did a research on emerson</font><font color="#CCCCCC"> germany</font>

113
00:05:18,520 --> 00:05:24,639
to see what can we find if we type

114
00:05:22,120 --> 00:05:28,599
wireless desktop site in aes and these

115
00:05:24,639 --> 00:05:32,560
<font color="#E5E5E5">were devices we could simply by there ok</font>

116
00:05:28,599 --> 00:05:35,710
so our test methodology was<font color="#CCCCCC"> three-step</font>

117
00:05:32,560 --> 00:05:37,960
actually first we did a simple hardware

118
00:05:35,710 --> 00:05:40,229
analysis so we opened<font color="#CCCCCC"> up the devices we</font>

119
00:05:37,960 --> 00:05:44,620
stared at<font color="#E5E5E5"> the printed circuit boards</font>

120
00:05:40,229 --> 00:05:48,580
identified chips did a lot of reading

121
00:05:44,620 --> 00:05:50,710
documentation yeah and then we<font color="#CCCCCC"> try to</font>

122
00:05:48,580 --> 00:05:54,370
find interesting test points for example

123
00:05:50,710 --> 00:05:57,210
for spy and we were also so luring some

124
00:05:54,370 --> 00:06:00,129
wires to some interesting test points

125
00:05:57,210 --> 00:06:02,888
next we did thermal analysis so we were

126
00:06:00,129 --> 00:06:06,250
capable to actually extract firmware of

127
00:06:02,889 --> 00:06:08,080
some of the devices under test<font color="#E5E5E5"> and we</font>

128
00:06:06,250 --> 00:06:10,899
loaded it dumped firmware it was

129
00:06:08,080 --> 00:06:13,210
actually an 8051 code of the

130
00:06:10,899 --> 00:06:16,539
microcontrollers of the specific

131
00:06:13,210 --> 00:06:18,638
transceiver to either and analyzed it we

132
00:06:16,539 --> 00:06:22,089
stare<font color="#CCCCCC"> at this assemblies we did</font><font color="#E5E5E5"> some</font>

133
00:06:18,639 --> 00:06:25,449
more reading of fine documentation we

134
00:06:22,089 --> 00:06:27,659
check the<font color="#E5E5E5"> Nordic semiconductors software</font>

135
00:06:25,449 --> 00:06:31,330
development<font color="#E5E5E5"> kit</font><font color="#CCCCCC"> which was</font><font color="#E5E5E5"> very useful</font>

136
00:06:27,659 --> 00:06:35,860
<font color="#CCCCCC">and we read some more code or wrote some</font>

137
00:06:31,330 --> 00:06:37,930
sample code and analyze this just to get

138
00:06:35,860 --> 00:06:39,930
<font color="#E5E5E5">a better understanding of</font><font color="#CCCCCC"> how these</font>

139
00:06:37,930 --> 00:06:42,120
devices actually work

140
00:06:39,930 --> 00:06:43,949
and lastly we also did radio based

141
00:06:42,120 --> 00:06:45,060
analysis because these devices are

142
00:06:43,949 --> 00:06:47,669
wireless and this is the most

143
00:06:45,060 --> 00:06:50,039
interesting<font color="#CCCCCC"> part yeah how do they work</font>

144
00:06:47,669 --> 00:06:52,380
actually<font color="#E5E5E5"> and what I personally did at</font>

145
00:06:50,039 --> 00:06:53,909
first I watched my<font color="#E5E5E5"> gosh moans as the</font><font color="#CCCCCC"> are</font>

146
00:06:52,380 --> 00:06:56,009
tutorials<font color="#CCCCCC"> this was actually my first</font>

147
00:06:53,910 --> 00:07:00,330
<font color="#E5E5E5">project working with a software-defined</font>

148
00:06:56,009 --> 00:07:03,479
radio and I learned a lot yeah I did

149
00:07:00,330 --> 00:07:05,909
some more reading of documentation

150
00:07:03,479 --> 00:07:09,508
browse the<font color="#CCCCCC"> web because</font><font color="#E5E5E5"> we found out that</font>

151
00:07:05,910 --> 00:07:12,330
these NRF 24 devices are very<font color="#CCCCCC"> popular in</font>

152
00:07:09,509 --> 00:07:14,070
<font color="#E5E5E5">the maker scene at least the</font>

153
00:07:12,330 --> 00:07:17,479
transmitters and receivers not a

154
00:07:14,070 --> 00:07:20,759
transceiver system-on-a-chip devices but

155
00:07:17,479 --> 00:07:24,930
many<font color="#CCCCCC"> people are using these transmitters</font>

156
00:07:20,759 --> 00:07:27,000
for different stuff here and then we

157
00:07:24,930 --> 00:07:30,000
also got started with a new radio and

158
00:07:27,000 --> 00:07:34,919
canoe radio companion we wrote some a

159
00:07:30,000 --> 00:07:37,169
<font color="#CCCCCC">Python scripts and yeah analyzed the</font>

160
00:07:34,919 --> 00:07:40,770
data communication using readily

161
00:07:37,169 --> 00:07:44,490
available tools from other projects and

162
00:07:40,770 --> 00:07:46,440
later on we changed our tools set to

163
00:07:44,490 --> 00:07:48,120
this<font color="#E5E5E5"> off still networks in febrile this</font>

164
00:07:46,440 --> 00:07:53,190
year because<font color="#CCCCCC"> it was just superior to</font>

165
00:07:48,120 --> 00:07:54,810
that one we have used up to them and on

166
00:07:53,190 --> 00:07:56,930
in this table you can see the

167
00:07:54,810 --> 00:08:01,620
transceivers we were able to<font color="#CCCCCC"> identify</font>

168
00:07:56,930 --> 00:08:03,120
and air four of the five devices as you

169
00:08:01,620 --> 00:08:07,260
can see are using the<font color="#CCCCCC"> Nordic</font>

170
00:08:03,120 --> 00:08:10,020
semiconductor transceiver and RF 24 kind

171
00:08:07,260 --> 00:08:13,139
and we<font color="#E5E5E5"> focus our research on these</font>

172
00:08:10,020 --> 00:08:15,840
<font color="#E5E5E5">devices so fujitsu it's still</font><font color="#CCCCCC"> a work in</font>

173
00:08:13,139 --> 00:08:17,669
progress it's another technology<font color="#E5E5E5"> and we</font>

174
00:08:15,840 --> 00:08:19,859
were<font color="#CCCCCC"> just able to</font><font color="#E5E5E5"> identify one</font>

175
00:08:17,669 --> 00:08:24,210
vulnerability in there<font color="#CCCCCC"> I will show you</font>

176
00:08:19,860 --> 00:08:26,659
later<font color="#E5E5E5"> on okay here on this slide I've</font>

177
00:08:24,210 --> 00:08:30,479
just compile some information about

178
00:08:26,659 --> 00:08:32,279
documentation it's just very important

179
00:08:30,479 --> 00:08:35,760
if you haven't done such a project

180
00:08:32,279 --> 00:08:38,880
before to read all the stuff too yeah

181
00:08:35,760 --> 00:08:40,919
just know what are you looking at and it

182
00:08:38,880 --> 00:08:44,219
is also helpful to do some research

183
00:08:40,919 --> 00:08:48,660
about available tools because it saves a

184
00:08:44,219 --> 00:08:52,230
lot<font color="#CCCCCC"> of time actually okay and on the</font>

185
00:08:48,660 --> 00:08:54,819
next<font color="#E5E5E5"> couple of slides I've just puts</font>

186
00:08:52,230 --> 00:08:56,439
excerpts from<font color="#CCCCCC"> the data sheet so this was</font>

187
00:08:54,819 --> 00:08:58,839
actually the<font color="#E5E5E5"> device</font><font color="#CCCCCC"> and this packed</font>

188
00:08:56,439 --> 00:09:01,779
package that we were dealing with the

189
00:08:58,839 --> 00:09:05,050
NRF 24 different versions in the

190
00:09:01,779 --> 00:09:07,569
<font color="#E5E5E5">keyboard and in the USB dongle and the</font>

191
00:09:05,050 --> 00:09:10,839
<font color="#CCCCCC">interesting pins for us were of course a</font>

192
00:09:07,569 --> 00:09:14,889
spy because while this serial interface

193
00:09:10,839 --> 00:09:18,329
we were able<font color="#E5E5E5"> to dump the firmware and we</font>

194
00:09:14,889 --> 00:09:20,709
could also reprogram some of the devices

195
00:09:18,329 --> 00:09:22,628
this was the first<font color="#E5E5E5"> interesting finding</font>

196
00:09:20,709 --> 00:09:24,128
<font color="#E5E5E5">because the anodic semiconductor</font>

197
00:09:22,629 --> 00:09:26,670
transceivers actually have a read back

198
00:09:24,129 --> 00:09:28,660
protection but three of the four

199
00:09:26,670 --> 00:09:31,089
manufacturers just don't use this

200
00:09:28,660 --> 00:09:33,519
feature and so you just have to find the

201
00:09:31,089 --> 00:09:35,740
correct test points and yeah you can

202
00:09:33,519 --> 00:09:40,149
modify the device or you can just dump

203
00:09:35,740 --> 00:09:43,089
the firmware for further analysis yeah

204
00:09:40,149 --> 00:09:45,610
when when it comes to data memory it<font color="#E5E5E5"> is</font>

205
00:09:43,089 --> 00:09:48,759
divided in two parts the non-volatile

206
00:09:45,610 --> 00:09:53,829
data not all memory is accessible it

207
00:09:48,759 --> 00:09:56,259
externally why aspire so for example for

208
00:09:53,829 --> 00:09:58,239
the Cherokee word keyboard we had to

209
00:09:56,259 --> 00:10:00,519
write our own firmware to extract all

210
00:09:58,240 --> 00:10:03,970
the data<font color="#E5E5E5"> that was on the devices so it</font>

211
00:10:00,519 --> 00:10:07,720
was not all externally addressable as

212
00:10:03,970 --> 00:10:09,939
you can see here on this slide<font color="#E5E5E5"> you can</font>

213
00:10:07,720 --> 00:10:12,339
see some information about the so-called

214
00:10:09,939 --> 00:10:15,519
enhanced shot burst protocol that is

215
00:10:12,339 --> 00:10:19,389
used for the radio communication we were

216
00:10:15,519 --> 00:10:23,259
mainly interested in the payload and not

217
00:10:19,389 --> 00:10:25,329
on<font color="#CCCCCC"> the other stuff yeah but if</font><font color="#E5E5E5"> you have</font>

218
00:10:23,259 --> 00:10:27,370
a look<font color="#CCCCCC"> at these devices and do the</font>

219
00:10:25,329 --> 00:10:29,170
analysis you<font color="#CCCCCC"> have to know how it</font>

220
00:10:27,370 --> 00:10:31,029
actually works was the preamble the

221
00:10:29,170 --> 00:10:33,399
address configuration fields control

222
00:10:31,029 --> 00:10:35,620
fields checksums all that stuff but<font color="#CCCCCC"> it's</font>

223
00:10:33,399 --> 00:10:37,660
all well documented<font color="#E5E5E5"> and what's also</font>

224
00:10:35,620 --> 00:10:40,269
interesting<font color="#CCCCCC"> shown on a lower part is</font>

225
00:10:37,660 --> 00:10:43,180
that<font color="#CCCCCC"> the non exami conducted transceiver</font>

226
00:10:40,269 --> 00:10:45,970
has support for<font color="#CCCCCC"> hardware</font><font color="#E5E5E5"> aes encryption</font>

227
00:10:43,180 --> 00:10:49,779
and it's actually used by the firmware

228
00:10:45,970 --> 00:10:52,540
we had a look at so on this slide you

229
00:10:49,779 --> 00:10:57,550
<font color="#CCCCCC">can see a microsoft keyboard or actually</font>

230
00:10:52,540 --> 00:10:59,290
PCB and what's nice from<font color="#CCCCCC"> microsoft is</font>

231
00:10:57,550 --> 00:11:01,540
they have labeled all the interesting

232
00:10:59,290 --> 00:11:03,939
test points for us so we do not have<font color="#CCCCCC"> to</font>

233
00:11:01,540 --> 00:11:05,199
<font color="#CCCCCC">search by our own so you can see ya BF</font>

234
00:11:03,939 --> 00:11:08,949
<font color="#CCCCCC">oldest by</font>

235
00:11:05,200 --> 00:11:12,370
things mesial<font color="#CCCCCC"> muzie chip select a clock</font>

236
00:11:08,950 --> 00:11:15,610
and we also have<font color="#CCCCCC"> the reset and proc test</font>

237
00:11:12,370 --> 00:11:17,680
points there so it was very easy to

238
00:11:15,610 --> 00:11:20,890
analyze this one and yeah<font color="#E5E5E5"> that's an</font>

239
00:11:17,680 --> 00:11:23,380
example set up we used just a buzz

240
00:11:20,890 --> 00:11:25,689
pirate that's a Cherokee board wired<font color="#CCCCCC"> and</font>

241
00:11:23,380 --> 00:11:28,390
the correct<font color="#E5E5E5"> sold at the</font><font color="#CCCCCC"> correct waters</font>

242
00:11:25,690 --> 00:11:34,060
on<font color="#CCCCCC"> the correct</font><font color="#E5E5E5"> test points and then you</font>

243
00:11:28,390 --> 00:11:36,189
just can modify and read the things<font color="#CCCCCC"> okay</font>

244
00:11:34,060 --> 00:11:39,699
and we do<font color="#E5E5E5"> not only have a look at the</font>

245
00:11:36,190 --> 00:11:41,710
keyboards but also enter<font color="#CCCCCC"> Donal's so my</font>

246
00:11:39,700 --> 00:11:45,040
colleague Alexander's first time did

247
00:11:41,710 --> 00:11:49,900
this one yeah and so we were also able

248
00:11:45,040 --> 00:11:55,569
to directly read the Donalds in this way

249
00:11:49,900 --> 00:11:57,850
using custom eights breakout boards okay

250
00:11:55,570 --> 00:11:59,710
yeah and concerning firmware analysis

251
00:11:57,850 --> 00:12:02,920
what we did as<font color="#CCCCCC"> I mentioned earlier we</font>

252
00:11:59,710 --> 00:12:07,120
just loaded tried a pro read the nautic

253
00:12:02,920 --> 00:12:10,030
semiconductor<font color="#E5E5E5"> SDK several times and by</font>

254
00:12:07,120 --> 00:12:11,520
having the<font color="#CCCCCC"> SDK it was rather easy to</font>

255
00:12:10,030 --> 00:12:13,720
identify the interesting spots

256
00:12:11,520 --> 00:12:16,110
concerning and friction for example so

257
00:12:13,720 --> 00:12:20,260
we could annotate the code section<font color="#CCCCCC"> dura</font>

258
00:12:16,110 --> 00:12:23,230
mainly interested in here and concerning

259
00:12:20,260 --> 00:12:26,290
radio based analysis we start with the

260
00:12:23,230 --> 00:12:29,070
new radio and radio companion and you

261
00:12:26,290 --> 00:12:32,410
have some self made scripts<font color="#E5E5E5"> just will</font>

262
00:12:29,070 --> 00:12:34,420
analyze what was going on over the air

263
00:12:32,410 --> 00:12:40,449
using the enhanced shop first

264
00:12:34,420 --> 00:12:43,000
communication protocol yeah and this is

265
00:12:40,450 --> 00:12:44,920
<font color="#CCCCCC">just</font><font color="#E5E5E5"> an example of our first rise using</font>

266
00:12:43,000 --> 00:12:47,260
the NRF<font color="#E5E5E5"> 2040 coda we modified a little</font>

267
00:12:44,920 --> 00:12:49,089
bit and here were able to see the

268
00:12:47,260 --> 00:12:52,200
encrypted traffic and some more

269
00:12:49,090 --> 00:12:55,030
information concerning addresses p<font color="#E5E5E5"> IDs</font>

270
00:12:52,200 --> 00:12:59,800
<font color="#E5E5E5">acknowledgement stuff like that so this</font>

271
00:12:55,030 --> 00:13:02,650
is<font color="#CCCCCC"> just a raw communication here and in</font>

272
00:12:59,800 --> 00:13:05,199
febrile februari this year we changed

273
00:13:02,650 --> 00:13:08,650
our own tool set a little<font color="#E5E5E5"> bit because</font>

274
00:13:05,200 --> 00:13:10,330
<font color="#CCCCCC">but still released their own tool set</font>

275
00:13:08,650 --> 00:13:12,040
they used for identifying the mouse

276
00:13:10,330 --> 00:13:15,060
check vulnerabilities and their tool set

277
00:13:12,040 --> 00:13:17,760
was just superior to ours so we also

278
00:13:15,060 --> 00:13:19,199
bought a crazy radio that

279
00:13:17,760 --> 00:13:23,310
surely a remote control for<font color="#E5E5E5"> a</font>

280
00:13:19,200 --> 00:13:25,830
quadrocopter and we used pastilles NS<font color="#E5E5E5"> n</font>

281
00:13:23,310 --> 00:13:28,439
<font color="#E5E5E5">RF research firmware and some of the</font>

282
00:13:25,830 --> 00:13:31,650
tools and all the tools we have

283
00:13:28,440 --> 00:13:35,250
<font color="#E5E5E5">developed so far are based on this tool</font>

284
00:13:31,650 --> 00:13:38,790
set here and of<font color="#CCCCCC"> course there were</font>

285
00:13:35,250 --> 00:13:41,010
different problems during our research

286
00:13:38,790 --> 00:13:43,410
<font color="#CCCCCC">project what</font><font color="#E5E5E5"> I've learned personally is</font>

287
00:13:41,010 --> 00:13:46,290
that software defined radio really has a

288
00:13:43,410 --> 00:13:49,170
steep learning curve so reproducing some

289
00:13:46,290 --> 00:13:51,390
things at the starters were really<font color="#CCCCCC"> easy</font>

290
00:13:49,170 --> 00:13:54,030
but later<font color="#CCCCCC"> under when there are some</font>

291
00:13:51,390 --> 00:13:56,670
issues you really have to<font color="#E5E5E5"> dig deep and</font>

292
00:13:54,030 --> 00:13:59,760
find out what's going<font color="#CCCCCC"> wrong and we are</font>

293
00:13:56,670 --> 00:14:02,219
the error is but it's fun so I will

294
00:13:59,760 --> 00:14:05,480
continue<font color="#E5E5E5"> doing SDR analysis in the</font>

295
00:14:02,220 --> 00:14:09,090
future<font color="#E5E5E5"> yeah and some things</font><font color="#CCCCCC"> just were</font>

296
00:14:05,480 --> 00:14:11,040
more difficult than<font color="#CCCCCC"> we first thought for</font>

297
00:14:09,090 --> 00:14:13,140
example simply replay attacks because

298
00:14:11,040 --> 00:14:17,490
there is a channel hopping their timing

299
00:14:13,140 --> 00:14:20,520
issues signal strength issues stuff like

300
00:14:17,490 --> 00:14:22,950
that<font color="#E5E5E5"> and what we</font><font color="#CCCCCC"> also found out is that</font>

301
00:14:20,520 --> 00:14:25,319
correctly identifying chips is not in

302
00:14:22,950 --> 00:14:27,090
itself because<font color="#E5E5E5"> we overlooked at first</font>

303
00:14:25,320 --> 00:14:29,490
that<font color="#E5E5E5"> there are also</font><font color="#CCCCCC"> one-time</font>

304
00:14:27,090 --> 00:14:32,580
programmable versions of some of the

305
00:14:29,490 --> 00:14:39,350
chips yes all we bricked one microsoft

306
00:14:32,580 --> 00:14:43,320
device yeah that was not<font color="#CCCCCC"> our intention</font>

307
00:14:39,350 --> 00:14:45,300
yeah and the other two points are rather

308
00:14:43,320 --> 00:14:46,680
general if you have a development kit or

309
00:14:45,300 --> 00:14:49,890
board where you can just<font color="#E5E5E5"> play around</font>

310
00:14:46,680 --> 00:14:52,229
without breaking and damaging it yeah

311
00:14:49,890 --> 00:14:56,569
you can save a lot of time<font color="#E5E5E5"> and having a</font>

312
00:14:52,230 --> 00:14:56,570
proper tools yet makes a huge difference

313
00:14:56,900 --> 00:15:01,949
<font color="#CCCCCC">okay so what actually</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the tech</font>

314
00:15:00,150 --> 00:15:06,030
surface and what our attack scenarios

315
00:15:01,950 --> 00:15:09,440
concerning wireless desktop sets and in

316
00:15:06,030 --> 00:15:12,720
our opinion there<font color="#CCCCCC"> are two attack</font>

317
00:15:09,440 --> 00:15:15,120
categories one with a whip physical

318
00:15:12,720 --> 00:15:17,280
access to the devices and one where

319
00:15:15,120 --> 00:15:19,470
you're remotely<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> the devices over</font>

320
00:15:17,280 --> 00:15:23,280
the<font color="#CCCCCC"> areas radio</font><font color="#E5E5E5"> signals concerning</font>

321
00:15:19,470 --> 00:15:24,900
<font color="#E5E5E5">physical access what could you possibly</font>

322
00:15:23,280 --> 00:15:27,420
do as an attacker you can of course

323
00:15:24,900 --> 00:15:30,180
<font color="#E5E5E5">extract firmware and</font><font color="#CCCCCC"> menu platform where</font>

324
00:15:27,420 --> 00:15:32,750
extract cryptographic keys and many of

325
00:15:30,180 --> 00:15:35,849
manipulate them

326
00:15:32,750 --> 00:15:38,940
concerning attacks over<font color="#CCCCCC"> the air what can</font>

327
00:15:35,850 --> 00:15:40,920
you do yeah you can exploit unencrypted

328
00:15:38,940 --> 00:15:44,190
nano 28 unauthenticated data

329
00:15:40,920 --> 00:15:46,260
communication you can<font color="#E5E5E5"> perform replay</font>

330
00:15:44,190 --> 00:15:49,020
attacks if there<font color="#E5E5E5"> is no protection you</font>

331
00:15:46,260 --> 00:15:52,380
can maybe perform keystroke injection

332
00:15:49,020 --> 00:15:55,319
attacks and you can also try<font color="#E5E5E5"> to decrypt</font>

333
00:15:52,380 --> 00:15:58,439
encrypted data communication so all the

334
00:15:55,320 --> 00:16:00,350
devices we looked at were encrypted so

335
00:15:58,440 --> 00:16:05,580
we<font color="#E5E5E5"> only had a look at aes encrypted</font>

336
00:16:00,350 --> 00:16:08,730
wireless desktop sense here and here<font color="#CCCCCC"> the</font>

337
00:16:05,580 --> 00:16:11,130
for the five<font color="#E5E5E5"> security vulnerabilities we</font>

338
00:16:08,730 --> 00:16:13,680
found actually<font color="#CCCCCC"> they are</font><font color="#E5E5E5"> only four</font>

339
00:16:11,130 --> 00:16:17,100
because we play attack the solicitor

340
00:16:13,680 --> 00:16:18,989
twice but what we<font color="#CCCCCC"> found is that some</font>

341
00:16:17,100 --> 00:16:22,580
devices just have an insufficient

342
00:16:18,990 --> 00:16:25,740
protection of code namely firmer and

343
00:16:22,580 --> 00:16:30,270
data cryptographic keys so we<font color="#E5E5E5"> were</font>

344
00:16:25,740 --> 00:16:33,810
simply<font color="#E5E5E5"> able to read and also write this</font>

345
00:16:30,270 --> 00:16:36,660
sensitive data and as seen before using

346
00:16:33,810 --> 00:16:39,300
spire then the second vulnerability we

347
00:16:36,660 --> 00:16:41,969
found was unencrypted and

348
00:16:39,300 --> 00:16:44,189
unauthenticated data communication and

349
00:16:41,970 --> 00:16:46,230
we found<font color="#E5E5E5"> this one in all</font><font color="#CCCCCC"> the mice we</font>

350
00:16:44,190 --> 00:16:48,210
have tested so only the keyboards are

351
00:16:46,230 --> 00:16:52,680
actually encrypted all the mice or

352
00:16:48,210 --> 00:16:54,960
unencrypted<font color="#E5E5E5"> and the next problem that he</font>

353
00:16:52,680 --> 00:16:59,160
was missing protection against replay

354
00:16:54,960 --> 00:17:00,840
attacks so most of<font color="#E5E5E5"> the devices had no</font>

355
00:16:59,160 --> 00:17:03,300
protection at all against replay attacks

356
00:17:00,840 --> 00:17:05,130
and the microsoft keyboard had some kind

357
00:17:03,300 --> 00:17:06,659
<font color="#E5E5E5">of protection zone that's point for</font>

358
00:17:05,130 --> 00:17:08,760
insufficient protection against<font color="#E5E5E5"> beep</font>

359
00:17:06,660 --> 00:17:12,570
<font color="#E5E5E5">latex but there is still an attack</font>

360
00:17:08,760 --> 00:17:14,220
window you can<font color="#CCCCCC"> actually exploit and the</font>

361
00:17:12,569 --> 00:17:18,389
last vulnerability is cryptographic

362
00:17:14,220 --> 00:17:23,180
issues that allowed for other attacks as

363
00:17:18,390 --> 00:17:25,880
we will see later on<font color="#CCCCCC"> okay so the first</font>

364
00:17:23,180 --> 00:17:29,010
vulnerability insufficient protection of

365
00:17:25,880 --> 00:17:32,700
code and<font color="#E5E5E5"> data it's rather obvious one so</font>

366
00:17:29,010 --> 00:17:36,180
<font color="#E5E5E5">I will rush to the slides here you can</font>

367
00:17:32,700 --> 00:17:40,500
<font color="#E5E5E5">see sample from</font><font color="#CCCCCC"> rarely used</font><font color="#E5E5E5"> to eat</font>

368
00:17:36,180 --> 00:17:43,050
extract<font color="#E5E5E5"> the so-called extended and be</font>

369
00:17:40,500 --> 00:17:44,110
flash memory from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> cherry keyboard</font>

370
00:17:43,050 --> 00:17:47,139
because

371
00:17:44,110 --> 00:17:49,678
in this way we<font color="#E5E5E5"> were able</font><font color="#CCCCCC"> to also get</font>

372
00:17:47,140 --> 00:17:54,309
access to the memory that<font color="#CCCCCC"> is not</font>

373
00:17:49,679 --> 00:17:56,500
externally addressable<font color="#E5E5E5"> why a spy and the</font>

374
00:17:54,309 --> 00:18:00,730
<font color="#E5E5E5">cherry keyboard for example stores the</font>

375
00:17:56,500 --> 00:18:03,540
<font color="#E5E5E5">AAS key in there yeah so you at first</font>

376
00:18:00,730 --> 00:18:06,160
have to dump have to reprogram a

377
00:18:03,540 --> 00:18:09,700
Cherokee word<font color="#CCCCCC"> our cherry</font><font color="#E5E5E5"> Donnell in</font>

378
00:18:06,160 --> 00:18:12,549
order to<font color="#E5E5E5"> actually get to</font><font color="#CCCCCC"> the ASX in this</font>

379
00:18:09,700 --> 00:18:14,770
case concern the other<font color="#E5E5E5"> devices for</font>

380
00:18:12,549 --> 00:18:17,320
example<font color="#CCCCCC"> parex or Microsoft you can just</font>

381
00:18:14,770 --> 00:18:23,020
connect to the correct test points for

382
00:18:17,320 --> 00:18:26,530
spy<font color="#E5E5E5"> andrejs key from</font><font color="#CCCCCC"> the device yeah and</font>

383
00:18:23,020 --> 00:18:28,059
here's an example of<font color="#E5E5E5"> to dance from</font><font color="#CCCCCC"> the</font>

384
00:18:26,530 --> 00:18:30,070
<font color="#CCCCCC">Jerry dongle and the Cherokee board</font><font color="#E5E5E5"> as</font>

385
00:18:28,059 --> 00:18:32,950
you can<font color="#E5E5E5"> see we have found the same 16</font>

386
00:18:30,070 --> 00:18:35,049
byte value in the<font color="#E5E5E5"> Donald flash memory</font>

387
00:18:32,950 --> 00:18:39,600
and in the<font color="#E5E5E5"> Cherry flash memory and this</font>

388
00:18:35,049 --> 00:18:42,220
is the actual key that it's used yeah so

389
00:18:39,600 --> 00:18:43,860
yeah embedded flash memory of several

390
00:18:42,220 --> 00:18:46,299
devices can be read and<font color="#E5E5E5"> written</font>

391
00:18:43,860 --> 00:18:48,280
concerning a nerf and<font color="#E5E5E5"> default on Seavers</font>

392
00:18:46,299 --> 00:18:52,030
there is a protection feature that is

393
00:18:48,280 --> 00:18:55,389
not be used by every manufacturer so it

394
00:18:52,030 --> 00:18:57,910
is rather easy to raise the bar for an

395
00:18:55,390 --> 00:19:00,010
attacker having physical access if this

396
00:18:57,910 --> 00:19:04,570
feature was used in the manufacturing

397
00:19:00,010 --> 00:19:06,100
process and yeah what<font color="#CCCCCC"> we also found</font><font color="#E5E5E5"> out</font>

398
00:19:04,570 --> 00:19:08,439
this that it's also possible to

399
00:19:06,100 --> 00:19:12,219
manipulate<font color="#E5E5E5"> one time programmable flash</font>

400
00:19:08,440 --> 00:19:14,679
memory because you can change a<font color="#E5E5E5"> 1-bit to</font>

401
00:19:12,220 --> 00:19:16,299
<font color="#E5E5E5">a zero bit but not vice versa so for</font>

402
00:19:14,679 --> 00:19:18,669
example<font color="#E5E5E5"> Microsoft the microsoft keyboard</font>

403
00:19:16,299 --> 00:19:21,070
uses a one-time programmable version of

404
00:19:18,669 --> 00:19:23,020
the<font color="#E5E5E5"> transceiver but you can still modify</font>

405
00:19:21,070 --> 00:19:27,668
the key or modify the firmware in a

406
00:19:23,020 --> 00:19:29,650
limited way yeah and what's<font color="#CCCCCC"> also</font>

407
00:19:27,669 --> 00:19:32,140
important is that some wireless

408
00:19:29,650 --> 00:19:36,760
keyboards<font color="#CCCCCC"> for example Microsoft is</font>

409
00:19:32,140 --> 00:19:39,250
paired at the factory so you have no

410
00:19:36,760 --> 00:19:40,929
chance as an end user to actually change

411
00:19:39,250 --> 00:19:44,320
<font color="#CCCCCC">the cryptographic keys you just have to</font>

412
00:19:40,929 --> 00:19:47,220
trust<font color="#E5E5E5"> Microsoft in this way we</font><font color="#CCCCCC"> are still</font>

413
00:19:44,320 --> 00:19:49,750
working on a software where you are able

414
00:19:47,220 --> 00:19:51,220
exploiting the spy access to change the

415
00:19:49,750 --> 00:19:53,640
cryptographic keys if<font color="#E5E5E5"> you don't trust</font>

416
00:19:51,220 --> 00:19:57,850
Microsoft but still work in progress

417
00:19:53,640 --> 00:20:00,100
yeah and concerning the generation of

418
00:19:57,850 --> 00:20:01,990
cryptographic keys none of the

419
00:20:00,100 --> 00:20:04,600
<font color="#CCCCCC">manufacturers told us how they actually</font>

420
00:20:01,990 --> 00:20:06,820
do it so it<font color="#CCCCCC"> can</font><font color="#E5E5E5"> be simply random it can</font>

421
00:20:04,600 --> 00:20:09,159
be derived from some serial number or I

422
00:20:06,820 --> 00:20:11,559
don't<font color="#CCCCCC"> know what so it's just it's a</font>

423
00:20:09,160 --> 00:20:14,440
secret and you have to trust<font color="#CCCCCC"> the</font>

424
00:20:11,559 --> 00:20:17,860
manufacturers that are<font color="#CCCCCC"> actually building</font>

425
00:20:14,440 --> 00:20:19,660
these devices yeah and what does it mean

426
00:20:17,860 --> 00:20:22,559
it means that non-technical is Alexis

427
00:20:19,660 --> 00:20:25,510
can change the cryptographic keys and

428
00:20:22,559 --> 00:20:27,940
the firmware and of course read it and

429
00:20:25,510 --> 00:20:30,010
when I hear this I<font color="#CCCCCC"> always have to think</font>

430
00:20:27,940 --> 00:20:34,120
of this<font color="#E5E5E5"> picture that was released I</font>

431
00:20:30,010 --> 00:20:37,390
think three years ago yeah so anybody

432
00:20:34,120 --> 00:20:39,399
who has access<font color="#CCCCCC"> to the device for a</font>

433
00:20:37,390 --> 00:20:41,470
couple<font color="#E5E5E5"> of minutes it depends on the</font>

434
00:20:39,400 --> 00:20:46,230
device so five to ten minutes can

435
00:20:41,470 --> 00:20:49,929
extract the<font color="#E5E5E5"> AES keys or it can actually</font>

436
00:20:46,230 --> 00:20:52,270
<font color="#E5E5E5">manipulate a firmware and here you can</font>

437
00:20:49,929 --> 00:20:55,960
think<font color="#E5E5E5"> of some specific key logger</font>

438
00:20:52,270 --> 00:20:58,420
scenarios for example yeah we<font color="#E5E5E5"> are just</font>

439
00:20:55,960 --> 00:21:00,220
<font color="#E5E5E5">extract the keys and then you're sitting</font>

440
00:20:58,420 --> 00:21:03,030
<font color="#E5E5E5">in the building on the opposite side of</font>

441
00:21:00,220 --> 00:21:05,679
the<font color="#CCCCCC"> street or on another</font><font color="#E5E5E5"> floor and just</font>

442
00:21:03,030 --> 00:21:07,030
sniffing the radio communication for a

443
00:21:05,679 --> 00:21:09,550
couple of weeks and<font color="#CCCCCC"> you're able</font><font color="#E5E5E5"> to</font>

444
00:21:07,030 --> 00:21:14,139
decrypt all the traffic somebody is

445
00:21:09,550 --> 00:21:17,139
generating using these devices<font color="#CCCCCC"> okay so</font>

446
00:21:14,140 --> 00:21:20,470
the next vulnerability and the tech that

447
00:21:17,140 --> 00:21:23,650
is possible our so-called<font color="#CCCCCC"> Mouse spoofing</font>

448
00:21:20,470 --> 00:21:26,940
attacks because yeah as mentioned

449
00:21:23,650 --> 00:21:30,160
earlier the communication of the mice is

450
00:21:26,940 --> 00:21:32,110
unencrypted an unauthenticated so the

451
00:21:30,160 --> 00:21:35,140
receiver cannot decide if it's authentic

452
00:21:32,110 --> 00:21:39,340
or not and so you can just poof devices

453
00:21:35,140 --> 00:21:45,340
and do whatever you want<font color="#CCCCCC"> okay so i will</font>

454
00:21:39,340 --> 00:21:47,459
show you a small demo video hopefully<font color="#CCCCCC"> it</font>

455
00:21:45,340 --> 00:21:47,459
works

456
00:21:59,759 --> 00:22:03,549
because<font color="#E5E5E5"> I was challenged by one of my</font>

457
00:22:01,929 --> 00:22:07,029
colleagues he said yeah but<font color="#E5E5E5"> it's not</font>

458
00:22:03,549 --> 00:22:09,549
reliable<font color="#E5E5E5"> exploitable in the real world</font>

459
00:22:07,029 --> 00:22:11,139
so<font color="#E5E5E5"> we just developed a small Python</font>

460
00:22:09,549 --> 00:22:14,820
software to convey your active mouths

461
00:22:11,139 --> 00:22:17,998
and I targeted in this proof-of-concept

462
00:22:14,820 --> 00:22:21,100
attack a Windows 7 operating system and

463
00:22:17,999 --> 00:22:23,169
Nia what<font color="#E5E5E5"> actually did is I opened the</font>

464
00:22:21,100 --> 00:22:26,918
virtual on-screen keyboard of the device

465
00:22:23,169 --> 00:22:29,980
and then you can just<font color="#E5E5E5"> yeah do virtual p</font>

466
00:22:26,919 --> 00:22:35,169
presses there<font color="#CCCCCC"> I sped it up so it's the</font>

467
00:22:29,980 --> 00:22:37,450
attacker is rather slow at least here in

468
00:22:35,169 --> 00:22:40,600
my proof<font color="#E5E5E5"> of concept too so I think the</font>

469
00:22:37,450 --> 00:22:42,730
complete attack has a duration of<font color="#CCCCCC"> 3</font>

470
00:22:40,600 --> 00:22:45,399
minutes<font color="#E5E5E5"> you can see a full demo on</font>

471
00:22:42,730 --> 00:22:50,080
youtube so i think<font color="#CCCCCC"> a couple of days ago</font>

472
00:22:45,399 --> 00:22:52,689
or weeks two weeks<font color="#E5E5E5"> ago we put a proof of</font>

473
00:22:50,080 --> 00:22:57,668
concept video on<font color="#E5E5E5"> youtube you can just</font>

474
00:22:52,690 --> 00:22:59,350
watch it<font color="#E5E5E5"> there yeah and what happens</font>

475
00:22:57,669 --> 00:23:02,799
here it's just virtual key presses it's

476
00:22:59,350 --> 00:23:06,340
a default Windows attack vector download

477
00:23:02,799 --> 00:23:08,289
and execute why a<font color="#CCCCCC"> PowerShell and when</font>

478
00:23:06,340 --> 00:23:10,570
the tech is completed yeah now<font color="#CCCCCC"> I</font><font color="#E5E5E5"> slowed</font>

479
00:23:08,289 --> 00:23:14,049
down<font color="#CCCCCC"> again and</font><font color="#E5E5E5"> press enter now the</font>

480
00:23:10,570 --> 00:23:16,899
PowerShell command is executed and if

481
00:23:14,049 --> 00:23:18,490
all goes well yeah melber just got

482
00:23:16,899 --> 00:23:21,610
installed on the system this kind it's

483
00:23:18,490 --> 00:23:24,600
just a mock-up ransomware yeah and it's

484
00:23:21,610 --> 00:23:27,248
just a demo for remote code execution

485
00:23:24,600 --> 00:23:40,748
wireless unencrypted mass communication

486
00:23:27,249 --> 00:23:42,340
yeah ok so we've seen this here yeah so

487
00:23:40,749 --> 00:23:44,649
the radio communication of all the

488
00:23:42,340 --> 00:23:47,559
<font color="#CCCCCC">tested Myers was unencrypted and</font>

489
00:23:44,649 --> 00:23:50,350
unauthenticated so if you know the mouse

490
00:23:47,559 --> 00:23:51,999
data protocol you can just do arbitrary

491
00:23:50,350 --> 00:23:55,629
mouth action mouse movements on mouse

492
00:23:51,999 --> 00:23:57,789
clicks here and you have control in an

493
00:23:55,629 --> 00:24:00,820
unauthorized way over the mouse cursor

494
00:23:57,789 --> 00:24:03,039
mouse pointer and this is really<font color="#E5E5E5"> old</font>

495
00:24:00,820 --> 00:24:04,470
news so back in two thousand nine and

496
00:24:03,039 --> 00:24:06,780
2010<font color="#E5E5E5"> the people</font>

497
00:24:04,470 --> 00:24:09,330
Dream labs the kicker Becky people they

498
00:24:06,780 --> 00:24:11,428
also had this happens information in

499
00:24:09,330 --> 00:24:13,530
their slides but<font color="#E5E5E5"> actually nobody cares</font>

500
00:24:11,429 --> 00:24:15,380
<font color="#E5E5E5">because all people say it's not reliable</font>

501
00:24:13,530 --> 00:24:19,049
exploitable and it's<font color="#CCCCCC"> actually true</font>

502
00:24:15,380 --> 00:24:21,030
because you need some heuristics<font color="#E5E5E5"> to</font>

503
00:24:19,049 --> 00:24:23,610
exploit this in the real world so you

504
00:24:21,030 --> 00:24:26,700
have trial and error educated guesses

505
00:24:23,610 --> 00:24:30,240
but in some cases you have remote code

506
00:24:26,700 --> 00:24:32,880
execution and heuristics concern they

507
00:24:30,240 --> 00:24:34,409
had a layout of<font color="#E5E5E5"> the screen actually then</font>

508
00:24:32,880 --> 00:24:37,020
the language settings you have to know

509
00:24:34,409 --> 00:24:40,590
if it's an English keyboard or wall rock

510
00:24:37,020 --> 00:24:42,120
or German for example<font color="#E5E5E5"> you have to know</font>

511
00:24:40,590 --> 00:24:43,939
some information about the mouse

512
00:24:42,120 --> 00:24:47,309
settings especially the mouse

513
00:24:43,940 --> 00:24:49,260
acceleration that is used and you have

514
00:24:47,309 --> 00:24:51,480
to know where the on-screen<font color="#CCCCCC"> keyboard can</font>

515
00:24:49,260 --> 00:24:54,480
be found so it is also changed with

516
00:24:51,480 --> 00:24:57,000
windows 8 8.1 and 10 but in Windows 8.1

517
00:24:54,480 --> 00:24:59,309
and 10 you have a split screen keyboard

518
00:24:57,000 --> 00:25:03,150
that you can also explore it rather

519
00:24:59,309 --> 00:25:06,559
reliably I'd say<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> and these</font><font color="#E5E5E5"> are the</font>

520
00:25:03,150 --> 00:25:09,030
defaults I used in my proof<font color="#E5E5E5"> of concept</font>

521
00:25:06,559 --> 00:25:11,190
just<font color="#CCCCCC"> a default mouse settings using</font>

522
00:25:09,030 --> 00:25:13,918
enhanced pointer precision there's a

523
00:25:11,190 --> 00:25:16,350
default<font color="#E5E5E5"> Mouse acceleration curve in the</font>

524
00:25:13,919 --> 00:25:19,340
registry and the on-screen keyboard

525
00:25:16,350 --> 00:25:21,928
actually has default position and

526
00:25:19,340 --> 00:25:24,959
default dimensions if you haven't used

527
00:25:21,929 --> 00:25:28,740
it before and moved it<font color="#E5E5E5"> and saved it so</font><font color="#CCCCCC"> I</font>

528
00:25:24,960 --> 00:25:31,830
think in most of the cases concerning

529
00:25:28,740 --> 00:25:34,590
<font color="#E5E5E5">Windows installations or Windows Office</font>

530
00:25:31,830 --> 00:25:37,740
installations in companies it's rather

531
00:25:34,590 --> 00:25:40,230
reliable and if you if you're<font color="#E5E5E5"> not only</font>

532
00:25:37,740 --> 00:25:43,590
targeting one device but several

533
00:25:40,230 --> 00:25:46,650
hundreds one is enough to get<font color="#E5E5E5"> access to</font>

534
00:25:43,590 --> 00:25:53,760
the company network if the next exploit

535
00:25:46,650 --> 00:25:56,159
is successful yeah and um what I

536
00:25:53,760 --> 00:25:58,379
couldn't achieve was pixel perfect

537
00:25:56,159 --> 00:26:00,090
control over the mouse pointer because

538
00:25:58,380 --> 00:26:03,510
there is some more research necessary

539
00:26:00,090 --> 00:26:07,740
because it's not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> easy as I have</font>

540
00:26:03,510 --> 00:26:09,570
thought at the beginning here and

541
00:26:07,740 --> 00:26:12,720
actually the mouse movement in Windows

542
00:26:09,570 --> 00:26:15,418
is still handled in the kernel and there

543
00:26:12,720 --> 00:26:16,930
<font color="#CCCCCC">is fixed point math involved and mouse</font>

544
00:26:15,419 --> 00:26:19,780
acceleration curves

545
00:26:16,930 --> 00:26:22,570
it's more<font color="#E5E5E5"> complicated than I actually</font>

546
00:26:19,780 --> 00:26:25,960
thought yeah and so the current state is

547
00:26:22,570 --> 00:26:27,460
<font color="#CCCCCC">that we are</font><font color="#E5E5E5"> using handcrafted mouse</font>

548
00:26:25,960 --> 00:26:31,120
movements that are actually slowed down

549
00:26:27,460 --> 00:26:34,150
to<font color="#E5E5E5"> avoid some issues concerning Mouse</font>

550
00:26:31,120 --> 00:26:38,790
acceleration yeah but it works rather

551
00:26:34,150 --> 00:26:42,760
library as we've seen in the<font color="#E5E5E5"> demo video</font>

552
00:26:38,790 --> 00:26:45,129
<font color="#CCCCCC">okay so the next vulnerability replay</font>

553
00:26:42,760 --> 00:26:47,470
attacks this is<font color="#E5E5E5"> also rather obvious and</font>

554
00:26:45,130 --> 00:26:52,060
actually<font color="#CCCCCC"> I was surprised that it works</font>

555
00:26:47,470 --> 00:26:56,020
on all keyboards i have also demo video

556
00:26:52,060 --> 00:26:58,870
here but i will also<font color="#E5E5E5"> try to do a live</font>

557
00:26:56,020 --> 00:27:02,940
demonstration in combination with

558
00:26:58,870 --> 00:27:08,560
another vulnerability and later on so

559
00:27:02,940 --> 00:27:11,350
yes repeat this one<font color="#E5E5E5"> okay i'll pause the</font>

560
00:27:08,560 --> 00:27:17,470
video for<font color="#CCCCCC"> a second this is just</font><font color="#E5E5E5"> a simple</font>

561
00:27:11,350 --> 00:27:19,929
know what no I cannot pause it okay this

562
00:27:17,470 --> 00:27:21,880
is just<font color="#E5E5E5"> as a simple</font><font color="#CCCCCC"> setup on the left</font>

563
00:27:19,930 --> 00:27:23,680
the laptop you can see the attacker

564
00:27:21,880 --> 00:27:28,150
there's running new radio you can see a

565
00:27:23,680 --> 00:27:31,180
software-defined radio and you can see

566
00:27:28,150 --> 00:27:32,740
<font color="#CCCCCC">the victim system running</font><font color="#E5E5E5"> Windows 7 that</font>

567
00:27:31,180 --> 00:27:36,730
is operated with one or both wireless

568
00:27:32,740 --> 00:27:38,830
desktop set and what I just said is here

569
00:27:36,730 --> 00:27:41,320
I recorded the radio communication on a

570
00:27:38,830 --> 00:27:47,790
specific channel in this case and now I

571
00:27:41,320 --> 00:27:53,169
simply do a replay of the recorded

572
00:27:47,790 --> 00:27:55,990
communication and as you can see<font color="#E5E5E5"> I can</font>

573
00:27:53,170 --> 00:27:58,450
unlock the<font color="#E5E5E5"> window screen remotely yeah</font>

574
00:27:55,990 --> 00:28:01,050
so there's no protection concern a

575
00:27:58,450 --> 00:28:01,050
replay attacks

576
00:28:02,880 --> 00:28:11,710
yeah and in this case I attacked the

577
00:28:08,560 --> 00:28:14,649
fujitsu keyboard and I don't know

578
00:28:11,710 --> 00:28:16,810
<font color="#CCCCCC">actually the protocol of the 52 keyboard</font>

579
00:28:14,650 --> 00:28:19,690
so I<font color="#E5E5E5"> did this using a black box approach</font>

580
00:28:16,810 --> 00:28:22,330
I just recorded the communication on a

581
00:28:19,690 --> 00:28:24,490
specific channel and replayed it I don't

582
00:28:22,330 --> 00:28:27,730
know what is actually going on but it is

583
00:28:24,490 --> 00:28:29,260
easy to reproduce as you've seen<font color="#CCCCCC"> okay</font>

584
00:28:27,730 --> 00:28:31,690
this<font color="#E5E5E5"> was just a setup we've seen it in</font>

585
00:28:29,260 --> 00:28:35,440
the video yeah and<font color="#E5E5E5"> actually this is</font><font color="#CCCCCC"> the</font>

586
00:28:31,690 --> 00:28:39,250
new radio flow graph it's one<font color="#E5E5E5"> of the</font>

587
00:28:35,440 --> 00:28:41,200
most simple flow graphs you can get this

588
00:28:39,250 --> 00:28:43,240
can be used for recording and for

589
00:28:41,200 --> 00:28:45,640
replaying<font color="#E5E5E5"> by yeah activating</font>

590
00:28:43,240 --> 00:28:48,430
deactivating some of the boxes but

591
00:28:45,640 --> 00:28:51,130
<font color="#E5E5E5">that's all it takes to perform replay</font>

592
00:28:48,430 --> 00:28:53,260
<font color="#CCCCCC">attacks and you can do this within a</font>

593
00:28:51,130 --> 00:28:55,270
couple of yeah seconds or minutes

594
00:28:53,260 --> 00:28:57,640
actually it took me<font color="#E5E5E5"> five minutes to</font>

595
00:28:55,270 --> 00:29:02,740
reproduce this on the<font color="#CCCCCC"> fidgets</font><font color="#E5E5E5"> to</font>

596
00:28:57,640 --> 00:29:07,480
<font color="#E5E5E5">keyboard</font><font color="#CCCCCC"> okay yeah and we have</font><font color="#E5E5E5"> also</font>

597
00:29:02,740 --> 00:29:10,510
written other software tools yeah simple

598
00:29:07,480 --> 00:29:13,720
replay python script that uses the newer

599
00:29:10,510 --> 00:29:17,560
toolchain the crazy radio PA and the NRF

600
00:29:13,720 --> 00:29:20,260
research member and you can just perform

601
00:29:17,560 --> 00:29:25,899
replay attacks using this and you have

602
00:29:20,260 --> 00:29:29,470
them better output<font color="#CCCCCC"> okay yeah so replay</font>

603
00:29:25,900 --> 00:29:31,540
attacks are rather obvious and simple

604
00:29:29,470 --> 00:29:35,170
and all the<font color="#CCCCCC"> keywords we've tested all</font>

605
00:29:31,540 --> 00:29:39,220
<font color="#E5E5E5">five of animals replay attacks</font><font color="#CCCCCC"> microsoft</font>

606
00:29:35,170 --> 00:29:42,670
was special because it has some kind<font color="#E5E5E5"> of</font>

607
00:29:39,220 --> 00:29:45,220
protection and there's a limited attack

608
00:29:42,670 --> 00:29:47,620
window because only a specific number<font color="#E5E5E5"> of</font>

609
00:29:45,220 --> 00:29:49,300
key presses should happen between the

610
00:29:47,620 --> 00:29:51,219
recording and the<font color="#E5E5E5"> replay if there are</font>

611
00:29:49,300 --> 00:29:54,010
too many key presses on a keyboard<font color="#E5E5E5"> I</font>

612
00:29:51,220 --> 00:29:55,810
think it's<font color="#E5E5E5"> about</font><font color="#CCCCCC"> 1000 then the replay</font>

613
00:29:54,010 --> 00:29:57,310
doesn't work but concerning all the

614
00:29:55,810 --> 00:29:59,290
other<font color="#E5E5E5"> devices we were able to replay</font>

615
00:29:57,310 --> 00:30:02,020
communication we've recorded the day

616
00:29:59,290 --> 00:30:04,540
before and it still<font color="#CCCCCC"> works perfectly so</font>

617
00:30:02,020 --> 00:30:07,240
no protection at all yeah as mentioned

618
00:30:04,540 --> 00:30:09,870
before simply player text can be done

619
00:30:07,240 --> 00:30:12,580
without knowing the actual protocol and

620
00:30:09,870 --> 00:30:15,250
you're more sophisticated text can be

621
00:30:12,580 --> 00:30:16,720
done using the<font color="#E5E5E5"> other tool set</font>

622
00:30:15,250 --> 00:30:19,380
and what<font color="#E5E5E5"> can you do with replay or text</font>

623
00:30:16,720 --> 00:30:21,820
you can gain gain unauthorized access to

624
00:30:19,380 --> 00:30:24,730
unattended screen lock computers as

625
00:30:21,820 --> 00:30:26,439
shown in the video and if<font color="#CCCCCC"> you can also</font>

626
00:30:24,730 --> 00:30:29,860
gain physical access to the<font color="#CCCCCC"> u.s. be</font>

627
00:30:26,440 --> 00:30:31,810
Donell the receiver of your victim you

628
00:30:29,860 --> 00:30:33,490
can just steal it<font color="#E5E5E5"> and replay the</font>

629
00:30:31,810 --> 00:30:35,620
communication on your own device and

630
00:30:33,490 --> 00:30:39,700
then you will get<font color="#CCCCCC"> all the clear text key</font>

631
00:30:35,620 --> 00:30:42,459
presses in this way so it's another kind

632
00:30:39,700 --> 00:30:44,410
of key logger scenario if you want it

633
00:30:42,460 --> 00:30:46,720
that<font color="#CCCCCC"> way so if you're</font><font color="#E5E5E5"> able to replace</font>

634
00:30:44,410 --> 00:30:49,480
all the wireless desktop sets at a

635
00:30:46,720 --> 00:30:51,250
specific facility cleaning personal

636
00:30:49,480 --> 00:30:53,320
nobody will notice that<font color="#CCCCCC"> you've just</font>

637
00:30:51,250 --> 00:30:56,560
<font color="#E5E5E5">replaced the original device and then</font>

638
00:30:53,320 --> 00:30:58,480
you can there replay communication you

639
00:30:56,560 --> 00:31:03,820
have recorded<font color="#CCCCCC"> the weeks or days before</font>

640
00:30:58,480 --> 00:31:06,250
and you can see for example passwords<font color="#CCCCCC"> ok</font>

641
00:31:03,820 --> 00:31:07,929
and<font color="#CCCCCC"> now the most interesting one the</font>

642
00:31:06,250 --> 00:31:14,290
keystroke injection attack and here i

643
00:31:07,930 --> 00:31:34,680
will try to do a live demo all i have to

644
00:31:14,290 --> 00:31:34,680
do a quick<font color="#E5E5E5"> setup so</font>

645
00:31:56,130 --> 00:32:05,309
so I'm just preparing my whole week Tim

646
00:31:59,380 --> 00:32:05,309
device but it's<font color="#E5E5E5"> only for test purposes I</font>

647
00:32:09,539 --> 00:32:33,690
know I try to do some picture-in-picture

648
00:32:11,830 --> 00:32:33,689
egg<font color="#E5E5E5"> okay</font>

649
00:32:43,900 --> 00:32:50,510
so what I've here is well I'll make<font color="#E5E5E5"> the</font>

650
00:32:47,150 --> 00:32:52,280
Pro running<font color="#CCCCCC"> Windows 7 as a victim system</font>

651
00:32:50,510 --> 00:32:55,910
so it's<font color="#E5E5E5"> not the ideal setup but I hope</font>

652
00:32:52,280 --> 00:32:58,460
<font color="#E5E5E5">that it works and what I have here is a</font>

653
00:32:55,910 --> 00:33:00,260
cherry keyboard wireless desktop set the

654
00:32:58,460 --> 00:33:03,980
USB dongle it's just plugged in to the

655
00:33:00,260 --> 00:33:08,570
device<font color="#E5E5E5"> I will turn it on and just see if</font>

656
00:33:03,980 --> 00:33:13,490
it actually works such device is working

657
00:33:08,570 --> 00:33:15,490
no I don't want to restart this<font color="#CCCCCC"> okay so</font>

658
00:33:13,490 --> 00:33:18,710
now this device is connected to my

659
00:33:15,490 --> 00:33:20,390
<font color="#CCCCCC">Victim system it's not necessary</font>

660
00:33:18,710 --> 00:33:23,450
necessary to see what is<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> a</font>

661
00:33:20,390 --> 00:33:29,510
typed here it's more important to see

662
00:33:23,450 --> 00:33:32,450
that<font color="#CCCCCC"> something</font><font color="#E5E5E5"> is happening ok so now I</font>

663
00:33:29,510 --> 00:33:35,780
<font color="#E5E5E5">will use a proof of concept</font><font color="#CCCCCC"> to are</font>

664
00:33:32,450 --> 00:33:38,450
called Jerry attack and I will try<font color="#CCCCCC"> to</font>

665
00:33:35,780 --> 00:33:41,240
live demonstrate two kinds of attack a

666
00:33:38,450 --> 00:33:44,870
combination attack replay and keystroke

667
00:33:41,240 --> 00:33:47,750
injection and i hope the demo<font color="#CCCCCC"> gods will</font>

668
00:33:44,870 --> 00:33:49,729
support me in this one<font color="#E5E5E5"> ok so what</font><font color="#CCCCCC"> I did</font>

669
00:33:47,750 --> 00:33:56,570
is<font color="#CCCCCC"> I just started to prove of concept to</font>

670
00:33:49,730 --> 00:34:02,230
and now I oh my fault i miss the most

671
00:33:56,570 --> 00:34:10,880
important step my radio without this

672
00:34:02,230 --> 00:34:12,199
well actually it should not work and as

673
00:34:10,880 --> 00:34:17,990
you can see here could not initialize

674
00:34:12,199 --> 00:34:22,989
young he also write it<font color="#E5E5E5"> there so this is</font>

675
00:34:17,989 --> 00:34:29,209
on the crazy radio PA it costs I think

676
00:34:22,989 --> 00:34:30,709
including the antenna 30 euros and now

677
00:34:29,210 --> 00:34:34,099
i'm good to go

678
00:34:30,710 --> 00:34:37,699
hope<font color="#CCCCCC"> okay so here's my pick tool now</font><font color="#E5E5E5"> I</font>

679
00:34:34,099 --> 00:34:41,030
press some keys here and as you<font color="#E5E5E5"> can see</font>

680
00:34:37,699 --> 00:34:42,348
i found a keyboard this one is easy

681
00:34:41,030 --> 00:34:44,000
because<font color="#E5E5E5"> it doesn't do any channel</font>

682
00:34:42,349 --> 00:34:47,119
hopping and there are no timing issues

683
00:34:44,000 --> 00:34:50,149
and you can also<font color="#E5E5E5"> see there is something</font>

684
00:34:47,119 --> 00:34:52,190
<font color="#CCCCCC">going on concerning crypto and yeah now</font>

685
00:34:50,149 --> 00:34:55,009
I'm ready for<font color="#E5E5E5"> the attack what I will do</font>

686
00:34:52,190 --> 00:34:58,960
now is I will try<font color="#E5E5E5"> to lock the windows</font>

687
00:34:55,010 --> 00:35:01,220
system to show the first kind of attack

688
00:34:58,960 --> 00:35:03,920
so now you can see<font color="#CCCCCC"> the window system is</font>

689
00:35:01,220 --> 00:35:06,410
locked and now i just press one<font color="#CCCCCC"> button</font>

690
00:35:03,920 --> 00:35:10,060
and now<font color="#E5E5E5"> i will record all the data</font>

691
00:35:06,410 --> 00:35:10,060
communication of this specific device

692
00:35:11,710 --> 00:35:18,770
<font color="#CCCCCC">okay so as you can see it was successful</font>

693
00:35:16,790 --> 00:35:22,869
<font color="#CCCCCC">the screen was unlocked now i will just</font>

694
00:35:18,770 --> 00:35:25,970
lock it again and try the replay attack

695
00:35:22,869 --> 00:35:28,820
hello it works so that's<font color="#E5E5E5"> the first one</font>

696
00:35:25,970 --> 00:35:33,830
the replay attack so you can simply

697
00:35:28,820 --> 00:35:35,960
remotely unlock screen lock systems we

698
00:35:33,830 --> 00:35:38,450
did not do any range test but the people

699
00:35:35,960 --> 00:35:42,200
from but still did they were<font color="#CCCCCC"> able to do</font>

700
00:35:38,450 --> 00:35:45,379
mouse check attacks I think up to 100

701
00:35:42,200 --> 00:35:51,710
meters using some special antennas not

702
00:35:45,380 --> 00:36:02,510
this one<font color="#CCCCCC"> but yeah it's possible okay now</font>

703
00:35:51,710 --> 00:36:05,570
we have so this just a virtual machine

704
00:36:02,510 --> 00:36:07,640
and what I try now is the other kind<font color="#E5E5E5"> of</font>

705
00:36:05,570 --> 00:36:12,020
attack the keystroke injection and let's

706
00:36:07,640 --> 00:36:13,720
see<font color="#E5E5E5"> if it</font><font color="#CCCCCC"> works yeah you can see</font>

707
00:36:12,020 --> 00:36:16,970
something<font color="#CCCCCC"> is happening on the device</font>

708
00:36:13,720 --> 00:36:23,640
there's a command channel it's actually

709
00:36:16,970 --> 00:36:27,230
a PowerShell<font color="#CCCCCC"> I</font><font color="#E5E5E5"> have all goes well</font>

710
00:36:23,640 --> 00:36:30,750
there should<font color="#CCCCCC"> be some malware popping up</font>

711
00:36:27,230 --> 00:36:34,200
yeah it worked so that's the<font color="#CCCCCC"> key stroke</font>

712
00:36:30,750 --> 00:36:37,140
injection so in this<font color="#CCCCCC"> way a combination</font>

713
00:36:34,200 --> 00:36:39,720
attack you can remotely unlock a

714
00:36:37,140 --> 00:36:42,230
computer system if<font color="#E5E5E5"> you have recorded the</font>

715
00:36:39,720 --> 00:36:45,390
<font color="#E5E5E5">password entry at the right time and</font>

716
00:36:42,230 --> 00:36:47,580
afterwards if the system is unlocked in

717
00:36:45,390 --> 00:36:49,259
an<font color="#E5E5E5"> unlocked state you can simply inject</font>

718
00:36:47,580 --> 00:36:51,060
<font color="#CCCCCC">arataura keystrokes and do whatever you</font>

719
00:36:49,260 --> 00:36:59,540
want for example installing malware as

720
00:36:51,060 --> 00:36:59,540
in this case<font color="#CCCCCC"> okay so back to the slides</font>

721
00:37:07,280 --> 00:37:12,030
yeah so<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> tool keystore</font>

722
00:37:09,570 --> 00:37:15,570
conjecture<font color="#E5E5E5"> I showed</font><font color="#CCCCCC"> you actually this</font>

723
00:37:12,030 --> 00:37:18,900
one and this attack works for the cherry

724
00:37:15,570 --> 00:37:21,300
keyboard we've tested the<font color="#CCCCCC"> parry keyboard</font>

725
00:37:18,900 --> 00:37:22,830
and also the<font color="#E5E5E5"> Logitech keyboard but we</font>

726
00:37:21,300 --> 00:37:26,190
did<font color="#E5E5E5"> not found a vulnerability concerning</font>

727
00:37:22,830 --> 00:37:30,509
logitech bacillus just before us and

728
00:37:26,190 --> 00:37:34,850
reported to logitech yeah and here you

729
00:37:30,510 --> 00:37:37,260
can<font color="#CCCCCC"> see an extract from the NRF SDK and</font>

730
00:37:34,850 --> 00:37:40,230
what we found there is that there are

731
00:37:37,260 --> 00:37:42,900
differences<font color="#E5E5E5"> between to an RF transceiver</font>

732
00:37:40,230 --> 00:37:45,120
versions concerning<font color="#CCCCCC"> the</font><font color="#E5E5E5"> AES counter mode</font>

733
00:37:42,900 --> 00:37:47,610
encryption and what we found out is that

734
00:37:45,120 --> 00:37:49,529
there is not<font color="#E5E5E5"> a counter used by the</font>

735
00:37:47,610 --> 00:37:51,870
random value and then we thought<font color="#E5E5E5"> hey how</font>

736
00:37:49,530 --> 00:37:53,610
are the device is sinking and the truth

737
00:37:51,870 --> 00:37:55,589
is they cannot sing they're just using

738
00:37:53,610 --> 00:37:58,890
random values for the counter mode and

739
00:37:55,590 --> 00:38:01,680
this actually is part of the problem um

740
00:37:58,890 --> 00:38:03,870
yeah it's just a source code using the

741
00:38:01,680 --> 00:38:07,490
pseudo-random number generator for

742
00:38:03,870 --> 00:38:10,710
generating these five bytes random value

743
00:38:07,490 --> 00:38:12,959
yeah and concerning the tested cherian

744
00:38:10,710 --> 00:38:16,320
<font color="#E5E5E5">perixx keyboard we found out that are</font>

745
00:38:12,960 --> 00:38:19,680
using 128-bit aes encryption in counter

746
00:38:16,320 --> 00:38:22,160
mode the counter generally consists of

747
00:38:19,680 --> 00:38:25,230
unknowns number is once and<font color="#CCCCCC"> a counter</font>

748
00:38:22,160 --> 00:38:27,750
and we also found out that the nons of

749
00:38:25,230 --> 00:38:30,410
the cherry keyboard was only null byte

750
00:38:27,750 --> 00:38:32,610
so we have 11<font color="#CCCCCC"> egg whites and five bytes</font>

751
00:38:30,410 --> 00:38:36,060
random value for the initialization

752
00:38:32,610 --> 00:38:37,200
vector and by manipulating<font color="#CCCCCC"> the cherry</font>

753
00:38:36,060 --> 00:38:39,779
firmware

754
00:38:37,200 --> 00:38:43,189
were<font color="#E5E5E5"> also able to</font><font color="#CCCCCC"> find out some more</font>

755
00:38:39,780 --> 00:38:46,550
details concerning the release packets

756
00:38:43,190 --> 00:38:49,650
so I released packet I mean if we

757
00:38:46,550 --> 00:38:52,050
release the key of the keyboard a

758
00:38:49,650 --> 00:38:53,820
specific packet is sent and we were able

759
00:38:52,050 --> 00:38:56,070
to<font color="#E5E5E5"> manipulate the firmware as mentioned</font>

760
00:38:53,820 --> 00:38:59,180
before using spy and analyze it using

761
00:38:56,070 --> 00:39:02,310
either pro and we were able actually to

762
00:38:59,180 --> 00:39:05,069
decrypt all the traffic on the cherry

763
00:39:02,310 --> 00:39:08,029
devices we had and we found<font color="#E5E5E5"> out hey if</font>

764
00:39:05,070 --> 00:39:11,820
he releases send it's just 11 non-whites

765
00:39:08,030 --> 00:39:13,920
so and on the bottom of the slides you

766
00:39:11,820 --> 00:39:17,520
can see how counter mode actually works

767
00:39:13,920 --> 00:39:20,849
for<font color="#E5E5E5"> all block ciphers in this case</font><font color="#CCCCCC"> also</font>

768
00:39:17,520 --> 00:39:24,359
mas and what we know is all the

769
00:39:20,849 --> 00:39:26,640
information<font color="#CCCCCC"> you I've circled in red we</font>

770
00:39:24,359 --> 00:39:29,069
know the complete initialization vector

771
00:39:26,640 --> 00:39:31,650
the nons we know because we<font color="#E5E5E5"> did a</font><font color="#CCCCCC"> firmly</font>

772
00:39:29,070 --> 00:39:33,180
analysis the counter actually is sent by

773
00:39:31,650 --> 00:39:35,430
the radio communication in clear text

774
00:39:33,180 --> 00:39:37,379
over the<font color="#E5E5E5"> air the ciphertext is also</font>

775
00:39:35,430 --> 00:39:38,640
sending clearly not in clear text<font color="#E5E5E5"> i'll</font>

776
00:39:37,380 --> 00:39:41,250
<font color="#E5E5E5">send over the air in the radio</font>

777
00:39:38,640 --> 00:39:43,440
communication protocol then we know the

778
00:39:41,250 --> 00:39:46,920
<font color="#E5E5E5">plaintext at least of some packets</font>

779
00:39:43,440 --> 00:39:49,890
mainly the key release packets and yeah

780
00:39:46,920 --> 00:39:54,290
due to the mode of operation of counter

781
00:39:49,890 --> 00:40:01,140
mode we also know the keystream block

782
00:39:54,290 --> 00:40:03,660
because something exclusive or<font color="#E5E5E5"> zero is</font>

783
00:40:01,140 --> 00:40:07,170
still<font color="#E5E5E5"> something yeah we have it on the</font>

784
00:40:03,660 --> 00:40:09,000
other slide here and what is also very

785
00:40:07,170 --> 00:40:11,490
useful is this that there is no reply

786
00:40:09,000 --> 00:40:14,099
protection so we simply have to find one

787
00:40:11,490 --> 00:40:17,578
valid key release packet and modify this

788
00:40:14,099 --> 00:40:19,619
in an arbitrary way so we have the

789
00:40:17,579 --> 00:40:23,010
replay attack possibility we can do this

790
00:40:19,619 --> 00:40:25,890
known plaintext attack and what we do

791
00:40:23,010 --> 00:40:27,990
next is we do some simple math namely

792
00:40:25,890 --> 00:40:30,299
exclusive or and then we can manipulate

793
00:40:27,990 --> 00:40:34,109
this key Willie's packet arbitrarily and

794
00:40:30,300 --> 00:40:35,790
inject whatever he<font color="#E5E5E5"> is we want we also</font>

795
00:40:34,109 --> 00:40:38,910
found out<font color="#CCCCCC"> that the Cherokee born also</font>

796
00:40:35,790 --> 00:40:42,089
<font color="#CCCCCC">parex and logitech are using the default</font>

797
00:40:38,910 --> 00:40:44,848
USB HID human interface device data

798
00:40:42,089 --> 00:40:46,109
formats so we have eight bytes at least

799
00:40:44,849 --> 00:40:48,119
in the case of<font color="#E5E5E5"> Jerry we have some</font>

800
00:40:46,109 --> 00:40:49,890
modifiers null byte and six key codes

801
00:40:48,119 --> 00:40:53,640
and here are<font color="#CCCCCC"> some</font>

802
00:40:49,890 --> 00:40:56,879
your examples of well it well used for

803
00:40:53,640 --> 00:40:59,359
these data fields and here's just a

804
00:40:56,880 --> 00:41:03,150
simple example<font color="#E5E5E5"> so we have an encrypted</font>

805
00:40:59,360 --> 00:41:05,580
release packet we have an exclusive or

806
00:41:03,150 --> 00:41:08,970
with our plaintext packet we are fortune

807
00:41:05,580 --> 00:41:11,009
in this case<font color="#E5E5E5"> it's shift</font><font color="#CCCCCC"> + a so</font><font color="#E5E5E5"> we want</font>

808
00:41:08,970 --> 00:41:13,109
<font color="#CCCCCC">to keep it</font><font color="#E5E5E5"> light and the injection</font>

809
00:41:11,010 --> 00:41:14,760
package you can see below and that is

810
00:41:13,110 --> 00:41:16,860
all you<font color="#E5E5E5"> have to do to have packet</font>

811
00:41:14,760 --> 00:41:20,910
injection unencrypted wireless desktop

812
00:41:16,860 --> 00:41:23,640
sets yeah and here keystroke injection

813
00:41:20,910 --> 00:41:27,720
in five easy steps you just have to find

814
00:41:23,640 --> 00:41:29,339
the target device using yeah radio you

815
00:41:27,720 --> 00:41:36,330
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find a key release packet this</font>

816
00:41:29,340 --> 00:41:39,930
is also<font color="#E5E5E5"> a heuristic but the last packet</font>

817
00:41:36,330 --> 00:41:41,610
somebody has pressed after all along the

818
00:41:39,930 --> 00:41:43,379
<font color="#CCCCCC">pause</font><font color="#E5E5E5"> for example two or three seconds</font>

819
00:41:41,610 --> 00:41:45,540
<font color="#E5E5E5">actually is</font><font color="#CCCCCC"> the key release packet so</font>

820
00:41:43,380 --> 00:41:47,670
you can find these packets with high

821
00:41:45,540 --> 00:41:49,140
reliability you do some simple math and

822
00:41:47,670 --> 00:41:50,790
then it concerns modified<font color="#E5E5E5"> cue release</font>

823
00:41:49,140 --> 00:41:53,009
packets as you want and<font color="#CCCCCC"> repeat it as</font>

824
00:41:50,790 --> 00:41:55,890
often as you<font color="#E5E5E5"> want and what</font><font color="#CCCCCC"> you gain is</font>

825
00:41:53,010 --> 00:41:57,990
remote code execution as we've seen ya

826
00:41:55,890 --> 00:42:00,299
on target systems that are actually

827
00:41:57,990 --> 00:42:03,299
operated with vulnerable devices here's

828
00:42:00,300 --> 00:42:05,100
an excerpt of<font color="#E5E5E5"> the demo code of the demo</font>

829
00:42:03,300 --> 00:42:07,050
tool you've seen before it's<font color="#CCCCCC"> just a few</font>

830
00:42:05,100 --> 00:42:09,420
lines<font color="#E5E5E5"> of Python it's just an exclusive</font>

831
00:42:07,050 --> 00:42:11,280
or actually yeah that's not otherwise

832
00:42:09,420 --> 00:42:14,400
we've built because my boss wanted to

833
00:42:11,280 --> 00:42:17,210
have a standalone device so yeah we had

834
00:42:14,400 --> 00:42:19,970
an old raspberry pi<font color="#CCCCCC"> Ryan lying around</font>

835
00:42:17,210 --> 00:42:22,710
developed a small raspberry pi shield

836
00:42:19,970 --> 00:42:24,629
here and put the radio in there and you

837
00:42:22,710 --> 00:42:28,170
can do it attack also<font color="#E5E5E5"> with this yeah</font>

838
00:42:24,630 --> 00:42:31,080
it's just a schematic you should not

839
00:42:28,170 --> 00:42:34,050
take such device in airplane because

840
00:42:31,080 --> 00:42:36,180
airport security yeah they have some

841
00:42:34,050 --> 00:42:38,520
questions so my boss did last week and

842
00:42:36,180 --> 00:42:43,620
he told<font color="#E5E5E5"> me not to put it in the hand</font>

843
00:42:38,520 --> 00:42:45,270
luggage yeah okay and here's some

844
00:42:43,620 --> 00:42:48,920
manufacture statement and feedback so no

845
00:42:45,270 --> 00:42:51,420
response from<font color="#CCCCCC"> parex at all</font><font color="#E5E5E5"> Microsoft</font>

846
00:42:48,920 --> 00:42:54,330
they are still<font color="#E5E5E5"> checking some of the</font>

847
00:42:51,420 --> 00:42:57,000
issues actually but some of the problems

848
00:42:54,330 --> 00:43:00,990
that just cannot fix or not in the

849
00:42:57,000 --> 00:43:01,750
products<font color="#CCCCCC"> that are already out there yeah</font>

850
00:43:00,990 --> 00:43:04,060
concern

851
00:43:01,750 --> 00:43:06,820
the mouse communication<font color="#CCCCCC"> I said it it is</font>

852
00:43:04,060 --> 00:43:09,490
by design so no fix for this concerning

853
00:43:06,820 --> 00:43:10,810
the physical access to say yeah if you

854
00:43:09,490 --> 00:43:13,810
have physical<font color="#CCCCCC"> access you can do anything</font>

855
00:43:10,810 --> 00:43:16,000
<font color="#E5E5E5">and it's</font><font color="#CCCCCC"> actually true and we are</font>

856
00:43:13,810 --> 00:43:19,509
concerning his of keystrokes injection

857
00:43:16,000 --> 00:43:21,940
replay attack they're still working on

858
00:43:19,510 --> 00:43:23,590
<font color="#E5E5E5">this one yeah logitech just said yeah</font>

859
00:43:21,940 --> 00:43:27,040
thank you very<font color="#E5E5E5"> much</font><font color="#CCCCCC"> and we are</font><font color="#E5E5E5"> working</font>

860
00:43:23,590 --> 00:43:29,620
on better products in the future fujitsu

861
00:43:27,040 --> 00:43:31,180
yet<font color="#CCCCCC"> i told us that these kind of replay</font>

862
00:43:29,620 --> 00:43:33,339
attacks are actually hard to reproduce

863
00:43:31,180 --> 00:43:37,210
and you need special<font color="#E5E5E5"> knowledge and stuff</font>

864
00:43:33,340 --> 00:43:39,280
like that yeah but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> also doesn't they</font>

865
00:43:37,210 --> 00:43:42,430
will not fix this but in future products

866
00:43:39,280 --> 00:43:46,510
they<font color="#CCCCCC"> will try</font><font color="#E5E5E5"> to do it better</font><font color="#CCCCCC"> and cherry</font>

867
00:43:42,430 --> 00:43:50,049
they just relabeled their product it was

868
00:43:46,510 --> 00:43:52,030
called unlimited be unlimited<font color="#CCCCCC"> aes and</font>

869
00:43:50,050 --> 00:43:54,340
now they just<font color="#E5E5E5"> don't promote it as a</font>

870
00:43:52,030 --> 00:43:57,220
secure wireless desktop set anymore and

871
00:43:54,340 --> 00:43:59,980
they will<font color="#CCCCCC"> also not fix these issues in</font>

872
00:43:57,220 --> 00:44:04,240
their product<font color="#CCCCCC"> they are still</font><font color="#E5E5E5"> selling</font>

873
00:43:59,980 --> 00:44:05,650
here<font color="#CCCCCC"> okay so the conclusion is that all</font>

874
00:44:04,240 --> 00:44:09,490
the test<font color="#CCCCCC"> devices had one or more</font>

875
00:44:05,650 --> 00:44:11,230
security issues in<font color="#E5E5E5"> my opinion you can</font>

876
00:44:09,490 --> 00:44:14,979
exploit all of them in<font color="#CCCCCC"> real world attack</font>

877
00:44:11,230 --> 00:44:18,610
scenarios yet a phone security issues

878
00:44:14,980 --> 00:44:20,620
cannot or will not be fixed so one level

879
00:44:18,610 --> 00:44:24,130
devices will stay one mobile in the

880
00:44:20,620 --> 00:44:26,049
future yeah it's just a short summary

881
00:44:24,130 --> 00:44:29,560
yet another summaries so what have<font color="#CCCCCC"> you</font>

882
00:44:26,050 --> 00:44:32,710
found<font color="#E5E5E5"> concern 25 wireless desktop sets</font>

883
00:44:29,560 --> 00:44:35,529
different vulnerabilities here and yeah

884
00:44:32,710 --> 00:44:37,960
our all the single recommendation is do

885
00:44:35,530 --> 00:44:39,940
not use wireless desktop sets with known

886
00:44:37,960 --> 00:44:43,330
security vulnerabilities in security

887
00:44:39,940 --> 00:44:45,520
related environments<font color="#E5E5E5"> okay here are some</font>

888
00:44:43,330 --> 00:44:47,980
references and thank you very<font color="#CCCCCC"> much for</font>

889
00:44:45,520 --> 00:44:50,710
<font color="#CCCCCC">your attention</font><font color="#E5E5E5"> and I think we don't</font><font color="#CCCCCC"> have</font>

890
00:44:47,980 --> 00:44:53,130
time for<font color="#CCCCCC"> questions</font><font color="#E5E5E5"> all right thank</font><font color="#CCCCCC"> you</font>

891
00:44:50,710 --> 00:44:53,130
my tears

