1
00:00:02,810 --> 00:00:07,920
thank you very much I'm out weeks and

2
00:00:06,450 --> 00:00:11,790
going to be<font color="#E5E5E5"> talked about credential</font>

3
00:00:07,920 --> 00:00:15,840
assessment so first of all<font color="#E5E5E5"> a little bit</font>

4
00:00:11,790 --> 00:00:18,779
of motivation I've<font color="#E5E5E5"> had the unique</font>

5
00:00:15,840 --> 00:00:20,849
experience of being able<font color="#E5E5E5"> to see into a</font>

6
00:00:18,779 --> 00:00:24,029
few of the different subfields of

7
00:00:20,849 --> 00:00:26,939
information security from working with

8
00:00:24,029 --> 00:00:30,270
exploit development and selling a few

9
00:00:26,939 --> 00:00:31,349
those in in college getting<font color="#CCCCCC"> a math</font>

10
00:00:30,270 --> 00:00:33,780
degree and looking at the cryptographic

11
00:00:31,349 --> 00:00:36,390
research side of things then I went into

12
00:00:33,780 --> 00:00:38,460
in the<font color="#E5E5E5"> Air Force I was in the forensics</font>

13
00:00:36,390 --> 00:00:41,219
lab<font color="#E5E5E5"> in reverse engineering I did a lot</font>

14
00:00:38,460 --> 00:00:43,649
of enterprises network operations so

15
00:00:41,219 --> 00:00:46,589
looking to find the network had been

16
00:00:43,649 --> 00:00:50,339
compromised<font color="#CCCCCC"> and then I still do red</font>

17
00:00:46,589 --> 00:00:54,960
teaming with CCDC I'm in my current

18
00:00:50,339 --> 00:00:56,010
position at<font color="#E5E5E5"> root not be I'm the in</font>

19
00:00:54,960 --> 00:01:00,199
<font color="#E5E5E5">charge of a group which is basically</font>

20
00:00:56,010 --> 00:01:04,860
developing software to detect malicious

21
00:01:00,199 --> 00:01:06,780
malware and and basically<font color="#E5E5E5"> software</font>

22
00:01:04,860 --> 00:01:07,649
development for security purposes so

23
00:01:06,780 --> 00:01:09,240
there<font color="#E5E5E5"> are a lot of people who have</font>

24
00:01:07,649 --> 00:01:11,700
focused in one area who are a lot more

25
00:01:09,240 --> 00:01:13,919
experience in a lot better<font color="#E5E5E5"> than I am in</font>

26
00:01:11,700 --> 00:01:15,360
one area<font color="#CCCCCC"> but it's interesting seeing a</font>

27
00:01:13,920 --> 00:01:17,399
couple different<font color="#E5E5E5"> other subfields of</font>

28
00:01:15,360 --> 00:01:20,100
information security because there's

29
00:01:17,399 --> 00:01:24,180
often times some significant disconnects

30
00:01:20,100 --> 00:01:27,059
there between how people view attacks

31
00:01:24,180 --> 00:01:29,490
and how other people see them occurring

32
00:01:27,060 --> 00:01:31,409
a lot<font color="#E5E5E5"> of times I'd</font><font color="#CCCCCC"> say most the time</font>

33
00:01:29,490 --> 00:01:33,810
it's just due<font color="#CCCCCC"> to a difference of focus</font>

34
00:01:31,409 --> 00:01:35,880
but sometimes especially when you're

35
00:01:33,810 --> 00:01:40,049
talking about us but particular types of

36
00:01:35,880 --> 00:01:42,210
vendors or or particular people<font color="#E5E5E5"> pursuing</font>

37
00:01:40,049 --> 00:01:43,860
research angle it might be there might

38
00:01:42,210 --> 00:01:45,390
be some bias in there as well<font color="#CCCCCC"> do do</font>

39
00:01:43,860 --> 00:01:46,590
financial incentive things like buy our

40
00:01:45,390 --> 00:01:49,109
product and<font color="#E5E5E5"> it will solve all your</font>

41
00:01:46,590 --> 00:01:51,450
problems and some of the other pitches

42
00:01:49,109 --> 00:01:53,158
there as well and<font color="#E5E5E5"> sometimes there's a</font>

43
00:01:51,450 --> 00:01:57,299
lot of focus on things that are<font color="#E5E5E5"> new and</font>

44
00:01:53,159 --> 00:01:58,679
<font color="#E5E5E5">exciting and over those which we already</font>

45
00:01:57,299 --> 00:02:00,750
know about which are kind<font color="#CCCCCC"> of old and</font>

46
00:01:58,679 --> 00:02:06,840
<font color="#E5E5E5">boring even</font><font color="#CCCCCC"> if the old and boring still</font>

47
00:02:00,750 --> 00:02:08,580
tends to be more impactful so keeping

48
00:02:06,840 --> 00:02:11,280
<font color="#E5E5E5">this in mind that is taking a look at a</font>

49
00:02:08,580 --> 00:02:15,030
lot of the<font color="#E5E5E5"> major breaches and from a</font>

50
00:02:11,280 --> 00:02:16,260
forensic perspective a big question on

51
00:02:15,030 --> 00:02:19,860
the minds of a lot<font color="#E5E5E5"> of big or</font>

52
00:02:16,260 --> 00:02:24,629
sations is well what what does it reach

53
00:02:19,860 --> 00:02:28,170
<font color="#CCCCCC">costs how does something become a major</font>

54
00:02:24,629 --> 00:02:30,720
breach and what is what is<font color="#E5E5E5"> the biggest</font>

55
00:02:28,170 --> 00:02:32,670
impact from that and the highest<font color="#E5E5E5"> impact</font>

56
00:02:30,720 --> 00:02:34,950
reaches tend to come from complete

57
00:02:32,670 --> 00:02:38,909
<font color="#E5E5E5">network compromise so you can look at a</font>

58
00:02:34,950 --> 00:02:41,040
<font color="#E5E5E5">lot</font><font color="#CCCCCC"> of different examples of huge</font><font color="#E5E5E5"> costs</font>

59
00:02:38,909 --> 00:02:44,129
<font color="#E5E5E5">being levied on an organization as a</font>

60
00:02:41,040 --> 00:02:46,349
result of just data stolen directly so

61
00:02:44,129 --> 00:02:49,709
for<font color="#E5E5E5"> example target home depot and</font>

62
00:02:46,349 --> 00:02:51,510
JPMorgan Chase we're all known for being

63
00:02:49,709 --> 00:02:54,060
compromised and having financial details

64
00:02:51,510 --> 00:02:56,190
like credit<font color="#CCCCCC"> cards stolen from you know</font>

65
00:02:54,060 --> 00:02:59,280
tens of thousands of<font color="#CCCCCC"> credit card</font>

66
00:02:56,190 --> 00:03:03,209
<font color="#E5E5E5">terminals point-of-sale devices or in JP</font>

67
00:02:59,280 --> 00:03:05,790
<font color="#CCCCCC">Morgan Chase more central systems we've</font>

68
00:03:03,209 --> 00:03:07,680
also seen destructive major breaches

69
00:03:05,790 --> 00:03:11,569
which in the past couple<font color="#E5E5E5"> of years have</font>

70
00:03:07,680 --> 00:03:15,870
started<font color="#CCCCCC"> to become</font><font color="#E5E5E5"> more common and more</font>

71
00:03:11,569 --> 00:03:18,690
more significant one of those<font color="#E5E5E5"> was with</font>

72
00:03:15,870 --> 00:03:21,060
the the owners of<font color="#CCCCCC"> the sands casino las</font>

73
00:03:18,690 --> 00:03:23,910
vegas sands entertainment another one

74
00:03:21,060 --> 00:03:26,970
was sony Sony Pictures enterprises so

75
00:03:23,910 --> 00:03:30,209
many<font color="#E5E5E5"> pictures was hit it was attributed</font>

76
00:03:26,970 --> 00:03:34,590
back to North Korea that<font color="#CCCCCC"> attack left all</font>

77
00:03:30,209 --> 00:03:37,410
of their systems offline and caused a

78
00:03:34,590 --> 00:03:39,660
lot of damage to to Sony and then Saudi

79
00:03:37,410 --> 00:03:41,489
Aramco I was also<font color="#E5E5E5"> hacked in a similar</font>

80
00:03:39,660 --> 00:03:44,790
type<font color="#CCCCCC"> of attack tens of thousands of</font>

81
00:03:41,489 --> 00:03:46,829
<font color="#E5E5E5">computers were wiped and generally</font>

82
00:03:44,790 --> 00:03:48,929
everything on them was was destroyed

83
00:03:46,829 --> 00:03:51,569
which took them a while to get back<font color="#E5E5E5"> up</font>

84
00:03:48,930 --> 00:03:55,199
<font color="#E5E5E5">and running so when you look at a</font><font color="#CCCCCC"> lot of</font>

85
00:03:51,569 --> 00:03:56,668
<font color="#E5E5E5">these major breaches you the question</font>

86
00:03:55,199 --> 00:04:01,549
naturally arises what exactly is

87
00:03:56,669 --> 00:04:04,139
happening and how and so the best

88
00:04:01,549 --> 00:04:05,699
<font color="#CCCCCC">after-the-fact</font><font color="#E5E5E5"> report on what has</font>

89
00:04:04,139 --> 00:04:07,290
happened in one of these breaches is

90
00:04:05,699 --> 00:04:09,900
probably the target reach where we have

91
00:04:07,290 --> 00:04:12,000
the most information about it and there

92
00:04:09,900 --> 00:04:14,159
was a great break down I've put<font color="#CCCCCC"> the link</font>

93
00:04:12,000 --> 00:04:16,649
here I'll have these slides up after

94
00:04:14,159 --> 00:04:18,570
<font color="#E5E5E5">after the talk and it went through each</font>

95
00:04:16,649 --> 00:04:21,149
of<font color="#CCCCCC"> the steps and</font><font color="#E5E5E5"> it broke it out into</font>

96
00:04:18,570 --> 00:04:23,789
about 11 complete steps but to summarize

97
00:04:21,149 --> 00:04:26,609
the first step was the attackers were

98
00:04:23,789 --> 00:04:28,169
able to compromise a vendor probably by

99
00:04:26,610 --> 00:04:29,920
using a social engineering email

100
00:04:28,169 --> 00:04:33,549
something like

101
00:04:29,920 --> 00:04:35,800
here open this macro here download this

102
00:04:33,550 --> 00:04:36,880
executable open this executable<font color="#CCCCCC"> in</font><font color="#E5E5E5"> a zip</font>

103
00:04:35,800 --> 00:04:39,910
file something<font color="#E5E5E5"> like that they</font>

104
00:04:36,880 --> 00:04:44,350
compromised a heating ventilation and

105
00:04:39,910 --> 00:04:46,600
air conditioning vendor that vendor was

106
00:04:44,350 --> 00:04:49,660
contracted to work at Target and had

107
00:04:46,600 --> 00:04:51,460
credentials had legitimate access to a

108
00:04:49,660 --> 00:04:54,400
<font color="#E5E5E5">particular web server which they were</font>

109
00:04:51,460 --> 00:04:57,159
using<font color="#E5E5E5"> to pass information back to target</font>

110
00:04:54,400 --> 00:04:59,289
and get<font color="#CCCCCC"> information from them having</font>

111
00:04:57,160 --> 00:05:01,150
stolen those credentials from the vendor

112
00:04:59,290 --> 00:05:04,170
the attackers were then able to use that

113
00:05:01,150 --> 00:05:06,549
access to exploit that web server and

114
00:05:04,170 --> 00:05:09,750
once they had control of that web server

115
00:05:06,550 --> 00:05:13,090
not just web interaction but an actual

116
00:05:09,750 --> 00:05:15,670
mount we're on<font color="#CCCCCC"> that web server they were</font>

117
00:05:13,090 --> 00:05:17,289
able<font color="#E5E5E5"> to see what security systems that</font>

118
00:05:15,670 --> 00:05:20,140
<font color="#E5E5E5">target was running what antivirus</font><font color="#CCCCCC"> II</font>

119
00:05:17,290 --> 00:05:22,000
were running and they took public mount

120
00:05:20,140 --> 00:05:24,630
<font color="#E5E5E5">where and they modified it to be</font>

121
00:05:22,000 --> 00:05:27,100
undetected by that particular antivirus

122
00:05:24,630 --> 00:05:28,719
and other public indicators of

123
00:05:27,100 --> 00:05:31,930
compromise that you may be looking<font color="#E5E5E5"> for</font>

124
00:05:28,720 --> 00:05:34,660
on that<font color="#CCCCCC"> web vendor or on that</font><font color="#E5E5E5"> web server</font>

125
00:05:31,930 --> 00:05:36,580
i should say the attackers were then

126
00:05:34,660 --> 00:05:39,100
able to steal credentials so they were

127
00:05:36,580 --> 00:05:41,620
able<font color="#E5E5E5"> to fountain find out that a target</font>

128
00:05:39,100 --> 00:05:43,870
admin had logged in to that server and

129
00:05:41,620 --> 00:05:45,850
then<font color="#CCCCCC"> using a tool like mini cats or</font>

130
00:05:43,870 --> 00:05:47,440
windows credential editor there are many

131
00:05:45,850 --> 00:05:50,770
<font color="#E5E5E5">different</font><font color="#CCCCCC"> ways to do this they stole</font>

132
00:05:47,440 --> 00:05:54,190
that credentials of that administrator

133
00:05:50,770 --> 00:05:56,229
and use that administrative credentials

134
00:05:54,190 --> 00:05:59,350
to take<font color="#E5E5E5"> control of all the point-of-sale</font>

135
00:05:56,230 --> 00:06:01,000
systems throughout<font color="#CCCCCC"> the network put their</font>

136
00:05:59,350 --> 00:06:04,600
mount<font color="#E5E5E5"> where which was known as black POS</font>

137
00:06:01,000 --> 00:06:05,830
on the network and launch it which then

138
00:06:04,600 --> 00:06:08,590
intercepted all the credit<font color="#CCCCCC"> card</font>

139
00:06:05,830 --> 00:06:11,740
information that was being collected

140
00:06:08,590 --> 00:06:13,179
from target at<font color="#CCCCCC"> that time at this time</font>

141
00:06:11,740 --> 00:06:14,980
they had done this attack target was

142
00:06:13,180 --> 00:06:18,040
still in the very early stages of

143
00:06:14,980 --> 00:06:21,310
<font color="#E5E5E5">planning out the chip rollout and so</font>

144
00:06:18,040 --> 00:06:23,080
everybody was using credit card swipes

145
00:06:21,310 --> 00:06:26,290
which were much<font color="#E5E5E5"> easier to steal from</font>

146
00:06:23,080 --> 00:06:28,960
<font color="#E5E5E5">memory so what was the critical flaw in</font>

147
00:06:26,290 --> 00:06:30,400
this entire process well some of the

148
00:06:28,960 --> 00:06:32,590
first reporting on the target breach

149
00:06:30,400 --> 00:06:34,599
came from<font color="#E5E5E5"> Brian Krebs and he wrote an</font>

150
00:06:32,590 --> 00:06:36,250
article first article is that home depot

151
00:06:34,600 --> 00:06:37,900
was hit by the same mount where his

152
00:06:36,250 --> 00:06:39,640
target<font color="#E5E5E5"> I should say this is the first</font>

153
00:06:37,900 --> 00:06:41,409
article in the home depot breach so he

154
00:06:39,640 --> 00:06:42,640
tended<font color="#CCCCCC"> to focus on hey look this is a</font>

155
00:06:41,410 --> 00:06:43,750
piece of malware that we knew about

156
00:06:42,640 --> 00:06:46,060
beforehand

157
00:06:43,750 --> 00:06:49,050
it was only modified slightly so why

158
00:06:46,060 --> 00:06:52,030
didn't<font color="#E5E5E5"> they catch the</font><font color="#CCCCCC"> mount where other</font>

159
00:06:49,050 --> 00:06:54,310
news papers such as<font color="#CCCCCC"> bloomberg posted</font>

160
00:06:52,030 --> 00:06:56,710
<font color="#CCCCCC">vist alarms and 40 million stolen credit</font>

161
00:06:54,310 --> 00:06:58,450
card numbers how target blew it so they

162
00:06:56,710 --> 00:07:00,460
focused on the fact as you<font color="#E5E5E5"> can see in</font>

163
00:06:58,450 --> 00:07:02,440
the headline<font color="#CCCCCC"> that target did have an</font>

164
00:07:00,460 --> 00:07:04,750
intrusion detection system it was<font color="#CCCCCC"> a fire</font>

165
00:07:02,440 --> 00:07:06,760
I system which<font color="#CCCCCC"> had thrown some alerts</font>

166
00:07:04,750 --> 00:07:09,880
during the process of this data

167
00:07:06,760 --> 00:07:13,420
exfiltration and exploitation and those

168
00:07:09,880 --> 00:07:15,340
alerts got lost in the barrage of data

169
00:07:13,420 --> 00:07:18,070
the typical security operations center

170
00:07:15,340 --> 00:07:20,190
<font color="#E5E5E5">seized and target was unable the the</font>

171
00:07:18,070 --> 00:07:22,210
people working<font color="#CCCCCC"> at Target were unable to</font>

172
00:07:20,190 --> 00:07:24,160
filter out the signal<font color="#E5E5E5"> from the noise and</font>

173
00:07:22,210 --> 00:07:28,560
figure out hey these alerts me there's

174
00:07:24,160 --> 00:07:33,400
actually something going on other

175
00:07:28,560 --> 00:07:35,470
another article posted that and I can

176
00:07:33,400 --> 00:07:36,729
get highlight<font color="#E5E5E5"> just the highlighted part</font>

177
00:07:35,470 --> 00:07:38,380
they said a bottomless budget for

178
00:07:36,730 --> 00:07:39,850
security software hardware and services

179
00:07:38,380 --> 00:07:41,290
means little if you don't have the

180
00:07:39,850 --> 00:07:43,000
<font color="#CCCCCC">empowered geeks to help</font><font color="#E5E5E5"> recognize the</font>

181
00:07:41,290 --> 00:07:44,620
breach early<font color="#CCCCCC"> on and so they were</font>

182
00:07:43,000 --> 00:07:46,360
<font color="#E5E5E5">pointing out the fact that even though</font>

183
00:07:44,620 --> 00:07:47,830
target had the money to spend on some of

184
00:07:46,360 --> 00:07:49,930
these expensive intrusion detection

185
00:07:47,830 --> 00:07:51,520
systems and some of the security

186
00:07:49,930 --> 00:07:53,440
operations center they still got

187
00:07:51,520 --> 00:07:55,960
compromised because they didn't have

188
00:07:53,440 --> 00:07:58,030
<font color="#E5E5E5">good people running it and they weren't</font>

189
00:07:55,960 --> 00:07:59,380
listening<font color="#E5E5E5"> to their people</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> making</font>

190
00:07:58,030 --> 00:08:03,070
changes<font color="#CCCCCC"> that</font><font color="#E5E5E5"> their people were asking</font>

191
00:07:59,380 --> 00:08:06,130
them to they did mention the the chip

192
00:08:03,070 --> 00:08:07,930
and pin update target was also

193
00:08:06,130 --> 00:08:09,909
interesting because<font color="#E5E5E5"> the United States</font>

194
00:08:07,930 --> 00:08:12,520
Senate<font color="#E5E5E5"> actually did their own report on</font>

195
00:08:09,910 --> 00:08:15,010
the breach and they called it a kill

196
00:08:12,520 --> 00:08:17,700
chain analysis of the 2013 target data

197
00:08:15,010 --> 00:08:20,229
breach they<font color="#E5E5E5"> identified four major areas</font>

198
00:08:17,700 --> 00:08:23,050
first of all<font color="#E5E5E5"> they talked about opening</font>

199
00:08:20,229 --> 00:08:26,140
access to the server from from the

200
00:08:23,050 --> 00:08:28,210
outside<font color="#CCCCCC"> from a contractor second they</font>

201
00:08:26,140 --> 00:08:31,780
mentioned missing the alerts third they

202
00:08:28,210 --> 00:08:33,370
mentioned moving between different

203
00:08:31,780 --> 00:08:35,079
sections<font color="#E5E5E5"> of targets</font><font color="#CCCCCC"> network and they're</font>

204
00:08:33,370 --> 00:08:37,150
wondering<font color="#E5E5E5"> why there wasn't a firewall or</font>

205
00:08:35,080 --> 00:08:40,089
segments blocking<font color="#E5E5E5"> off these two sections</font>

206
00:08:37,150 --> 00:08:41,740
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the network and forth they talked</font>

207
00:08:40,089 --> 00:08:43,330
<font color="#CCCCCC">about a different set of alerts</font><font color="#E5E5E5"> on which</font>

208
00:08:41,740 --> 00:08:49,630
their intrusion detection systems

209
00:08:43,330 --> 00:08:51,190
brought up and finally another<font color="#E5E5E5"> Krebs</font>

210
00:08:49,630 --> 00:08:55,330
<font color="#CCCCCC">oracle again pointed to some of the same</font>

211
00:08:51,190 --> 00:08:57,730
issues<font color="#E5E5E5"> all right so to summarize they</font>

212
00:08:55,330 --> 00:08:59,920
missed<font color="#CCCCCC"> the</font><font color="#E5E5E5"> malware alert they</font>

213
00:08:57,730 --> 00:09:03,160
lacked skilled incident responders to

214
00:08:59,920 --> 00:09:06,639
deal with that they had opened up access

215
00:09:03,160 --> 00:09:11,949
<font color="#E5E5E5">to a server to a vendor they didn't have</font>

216
00:09:06,639 --> 00:09:14,579
an encryption they they didn't have

217
00:09:11,949 --> 00:09:19,569
isolation between the network segments

218
00:09:14,579 --> 00:09:21,939
in<font color="#E5E5E5"> the sands casino another major breach</font>

219
00:09:19,570 --> 00:09:25,180
which then at this time was a very

220
00:09:21,940 --> 00:09:28,810
destructive breach if you've read any of

221
00:09:25,180 --> 00:09:31,388
the accounts<font color="#E5E5E5"> of this breach it's really</font>

222
00:09:28,810 --> 00:09:33,489
kind of shocking must have been<font color="#CCCCCC"> amazing</font>

223
00:09:31,389 --> 00:09:37,240
<font color="#E5E5E5">thing to to live through I'll just read</font>

224
00:09:33,490 --> 00:09:39,010
a tiny portion when the attack hit the

225
00:09:37,240 --> 00:09:40,839
computer engineers raised to figure out

226
00:09:39,010 --> 00:09:42,790
what was<font color="#CCCCCC"> happening within an hour they</font>

227
00:09:40,839 --> 00:09:45,160
had diagnosis<font color="#CCCCCC"> sans was under a withering</font>

228
00:09:42,790 --> 00:09:46,689
<font color="#CCCCCC">cyberattack pcs and servers were</font>

229
00:09:45,160 --> 00:09:48,550
shutting down in a cascading IT

230
00:09:46,690 --> 00:09:51,550
catastrophe with many of their hard

231
00:09:48,550 --> 00:09:53,219
drives wiped clean in an effort to save

232
00:09:51,550 --> 00:09:55,930
as many machines as they could IT

233
00:09:53,220 --> 00:09:57,850
staffers scrambled across the casino

234
00:09:55,930 --> 00:09:59,439
floors of<font color="#E5E5E5"> Sam's Vegas properties the</font>

235
00:09:57,850 --> 00:10:01,510
Venetian and its sister<font color="#CCCCCC"> Hotel</font><font color="#E5E5E5"> the</font>

236
00:09:59,440 --> 00:10:02,860
Palazzo ripping network cords out of

237
00:10:01,510 --> 00:10:04,959
every functioning computer they could

238
00:10:02,860 --> 00:10:07,149
find including the PCs used by pit

239
00:10:04,959 --> 00:10:08,888
bosses to track the gamblers and kiosks

240
00:10:07,149 --> 00:10:10,630
<font color="#CCCCCC">or the slot players cash in their</font>

241
00:10:08,889 --> 00:10:12,310
tickets so I can<font color="#E5E5E5"> only imagine people are</font>

242
00:10:10,630 --> 00:10:13,630
running down the hallways you know just

243
00:10:12,310 --> 00:10:17,349
pulling cords out of everything because

244
00:10:13,630 --> 00:10:20,220
<font color="#CCCCCC">everything was going down and it didn't</font>

245
00:10:17,350 --> 00:10:22,630
do a whole lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> a whole lot of good</font>

246
00:10:20,220 --> 00:10:25,149
because the attackers had already had

247
00:10:22,630 --> 00:10:26,850
access<font color="#E5E5E5"> to everything I say as the</font>

248
00:10:25,149 --> 00:10:29,170
article goes back into<font color="#E5E5E5"> the root cause</font>

249
00:10:26,850 --> 00:10:30,670
the attackers had initially compromised

250
00:10:29,170 --> 00:10:33,339
the system<font color="#CCCCCC"> that was</font><font color="#E5E5E5"> actually developer</font>

251
00:10:30,670 --> 00:10:35,680
system that a few<font color="#CCCCCC"> of the engineers</font>

252
00:10:33,339 --> 00:10:39,279
working on software development at<font color="#E5E5E5"> sams</font>

253
00:10:35,680 --> 00:10:40,779
entertainment were we're using and

254
00:10:39,279 --> 00:10:42,579
didn't have anything important on<font color="#CCCCCC"> it</font><font color="#E5E5E5"> so</font>

255
00:10:40,779 --> 00:10:44,439
it wasn't secured very well however what

256
00:10:42,579 --> 00:10:47,138
they used then was they were able<font color="#E5E5E5"> to</font>

257
00:10:44,440 --> 00:10:48,760
steal local credentials which enabled

258
00:10:47,139 --> 00:10:50,620
them to compromise other systems at the

259
00:10:48,760 --> 00:10:52,750
same site and then on one of those

260
00:10:50,620 --> 00:10:54,399
systems a highly privileged adamant was

261
00:10:52,750 --> 00:10:56,170
logged on they once again stole that

262
00:10:54,399 --> 00:10:59,050
administrators credentials and they were

263
00:10:56,170 --> 00:11:01,930
then able to move to the<font color="#CCCCCC"> the domain</font>

264
00:10:59,050 --> 00:11:04,569
controllers and domains taking over

265
00:11:01,930 --> 00:11:06,910
olive essentially<font color="#CCCCCC"> all of</font><font color="#E5E5E5"> the network of</font>

266
00:11:04,569 --> 00:11:08,829
Las<font color="#CCCCCC"> Vegas Sands entertainment which was</font>

267
00:11:06,910 --> 00:11:10,510
more<font color="#E5E5E5"> than just this one casino it was a</font>

268
00:11:08,829 --> 00:11:11,589
network of casinos and other

269
00:11:10,510 --> 00:11:16,240
entertainment properties are

270
00:11:11,590 --> 00:11:18,550
the world so again<font color="#E5E5E5"> Mitchell exploit via</font>

271
00:11:16,240 --> 00:11:22,570
web server exploit still passwords I'm

272
00:11:18,550 --> 00:11:24,760
in in a local sense then found a

273
00:11:22,570 --> 00:11:26,500
privilege domain password deployed the

274
00:11:24,760 --> 00:11:28,210
attack across the entire network in this

275
00:11:26,500 --> 00:11:31,180
<font color="#E5E5E5">case we don't see any example of any</font>

276
00:11:28,210 --> 00:11:33,820
alertness there were no examples of a

277
00:11:31,180 --> 00:11:35,819
<font color="#CCCCCC">third-party being granted access but</font>

278
00:11:33,820 --> 00:11:38,620
once again the same thing happen and

279
00:11:35,820 --> 00:11:40,330
sodium<font color="#E5E5E5"> sony and saudi aramco the</font>

280
00:11:38,620 --> 00:11:41,950
attackers were a little successful in

281
00:11:40,330 --> 00:11:45,550
wiping everything on the network and so

282
00:11:41,950 --> 00:11:47,080
in both of these cases it is not for

283
00:11:45,550 --> 00:11:49,240
certain what the initial access vector

284
00:11:47,080 --> 00:11:51,220
was what they do know in both<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these</font>

285
00:11:49,240 --> 00:11:52,930
<font color="#E5E5E5">attacks is that in order to deploy their</font>

286
00:11:51,220 --> 00:11:55,120
attack the attackers did use stolen

287
00:11:52,930 --> 00:11:57,189
haven't credentials to again compromise

288
00:11:55,120 --> 00:12:00,520
the entire network<font color="#E5E5E5"> distributed an attack</font>

289
00:11:57,190 --> 00:12:04,450
and destroy a lot of data on thousands

290
00:12:00,520 --> 00:12:06,550
of systems<font color="#CCCCCC"> alright so so</font><font color="#E5E5E5"> let's diagram</font>

291
00:12:04,450 --> 00:12:07,990
one of these breaches and talk about<font color="#CCCCCC"> how</font>

292
00:12:06,550 --> 00:12:10,390
the security industry is generally

293
00:12:07,990 --> 00:12:13,450
addressing this so this is<font color="#CCCCCC"> what it looks</font>

294
00:12:10,390 --> 00:12:14,920
like on a logarithmic scale of how<font color="#CCCCCC"> many</font>

295
00:12:13,450 --> 00:12:19,000
systems were compromised at each of

296
00:12:14,920 --> 00:12:20,380
those first<font color="#E5E5E5"> ten steps and so you have to</font>

297
00:12:19,000 --> 00:12:23,620
ask yourself again how do we how do we

298
00:12:20,380 --> 00:12:25,810
stop this well on the the first end of

299
00:12:23,620 --> 00:12:27,640
<font color="#E5E5E5">the graph here how do you</font><font color="#CCCCCC"> prevent them</font>

300
00:12:25,810 --> 00:12:29,680
from getting access to that one system

301
00:12:27,640 --> 00:12:31,510
we<font color="#CCCCCC"> have a phrase that we like to say</font>

302
00:12:29,680 --> 00:12:34,030
again and again in<font color="#E5E5E5"> the security industry</font>

303
00:12:31,510 --> 00:12:36,700
which is oh this<font color="#E5E5E5"> is how they got in and</font>

304
00:12:34,030 --> 00:12:39,010
once they're in then they're<font color="#CCCCCC"> in so how</font>

305
00:12:36,700 --> 00:12:42,550
did they get in well in this<font color="#E5E5E5"> case you</font>

306
00:12:39,010 --> 00:12:43,780
<font color="#CCCCCC">can restrict contractor accesses you can</font>

307
00:12:42,550 --> 00:12:45,310
try to find in<font color="#CCCCCC"> it all of the</font>

308
00:12:43,780 --> 00:12:47,920
vulnerabilities on your web servers

309
00:12:45,310 --> 00:12:49,660
there's a<font color="#E5E5E5"> lot of an entire industry of</font>

310
00:12:47,920 --> 00:12:53,410
vulnerability<font color="#CCCCCC"> assessment scanners</font>

311
00:12:49,660 --> 00:12:54,699
penetration testers to do this or as a

312
00:12:53,410 --> 00:12:55,930
lot of<font color="#E5E5E5"> people are talking about you can</font>

313
00:12:54,700 --> 00:12:57,250
hit<font color="#E5E5E5"> it on the other end of this graph</font>

314
00:12:55,930 --> 00:12:59,229
once they've deployed their malicious

315
00:12:57,250 --> 00:13:01,000
software everywhere and you can try to

316
00:12:59,230 --> 00:13:03,760
find that mount where the entire

317
00:13:01,000 --> 00:13:04,960
antivirus industry does this and you

318
00:13:03,760 --> 00:13:08,500
also have an entire threat intelligence

319
00:13:04,960 --> 00:13:10,390
industry to to attempt to discover what

320
00:13:08,500 --> 00:13:13,630
these indicators of compromise our and

321
00:13:10,390 --> 00:13:14,860
and stop them<font color="#E5E5E5"> and both of these are</font>

322
00:13:13,630 --> 00:13:18,700
<font color="#E5E5E5">really important parts</font><font color="#CCCCCC"> of a security</font>

323
00:13:14,860 --> 00:13:19,930
program but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> have to ask myself there's</font>

324
00:13:18,700 --> 00:13:21,280
kind of<font color="#E5E5E5"> something important in the</font>

325
00:13:19,930 --> 00:13:24,599
middle here<font color="#E5E5E5"> which kind of jumps out at</font>

326
00:13:21,280 --> 00:13:27,810
you and what<font color="#CCCCCC"> happened here in</font><font color="#E5E5E5"> this case</font>

327
00:13:24,600 --> 00:13:29,279
in all<font color="#CCCCCC"> of these cases</font><font color="#E5E5E5"> the attackers were</font>

328
00:13:27,810 --> 00:13:30,899
able to steal the credentials to a

329
00:13:29,279 --> 00:13:32,939
highly privileged domain admin account

330
00:13:30,899 --> 00:13:34,920
those credentials were left in this case

331
00:13:32,940 --> 00:13:37,230
on<font color="#CCCCCC"> a web server or on another</font><font color="#E5E5E5"> server</font>

332
00:13:34,920 --> 00:13:39,839
within an enclave and then they were

333
00:13:37,230 --> 00:13:41,940
able<font color="#E5E5E5"> to compromise everything in all of</font>

334
00:13:39,839 --> 00:13:44,100
these breaches I say all six the

335
00:13:41,940 --> 00:13:46,350
breaches that<font color="#E5E5E5"> we've talked about the</font>

336
00:13:44,100 --> 00:13:48,899
credential theft has typically granted

337
00:13:46,350 --> 00:13:50,670
an attacker and access to<font color="#E5E5E5"> thousands of</font>

338
00:13:48,899 --> 00:13:54,470
times more systems than any

339
00:13:50,670 --> 00:13:56,790
vulnerability exploitation or user I

340
00:13:54,470 --> 00:13:59,040
user<font color="#E5E5E5"> compromised social engineering</font>

341
00:13:56,790 --> 00:14:02,040
email and so malware detection

342
00:13:59,040 --> 00:14:04,949
vulnerable systems are both important

343
00:14:02,040 --> 00:14:08,040
issues but in<font color="#E5E5E5"> my opinion the biggest</font>

344
00:14:04,949 --> 00:14:09,689
<font color="#CCCCCC">enterprise problem is administrative</font>

345
00:14:08,040 --> 00:14:12,360
credentials lying around all over<font color="#E5E5E5"> the</font>

346
00:14:09,690 --> 00:14:13,769
domain or credentials lying around<font color="#E5E5E5"> the</font>

347
00:14:12,360 --> 00:14:17,790
domain which could be used<font color="#CCCCCC"> to</font><font color="#E5E5E5"> obtain</font>

348
00:14:13,769 --> 00:14:20,550
those credentials and so how so the

349
00:14:17,790 --> 00:14:22,410
first<font color="#E5E5E5"> of all ask ourselves is this a</font>

350
00:14:20,550 --> 00:14:24,719
problem that's really getting its do

351
00:14:22,410 --> 00:14:26,880
mention when you look at the coverage<font color="#E5E5E5"> of</font>

352
00:14:24,720 --> 00:14:29,250
these breaches guitar you start talking

353
00:14:26,880 --> 00:14:30,930
<font color="#E5E5E5">about the do a Google search</font><font color="#CCCCCC"> for the</font>

354
00:14:29,250 --> 00:14:33,870
initial access vector and you get almost

355
00:14:30,930 --> 00:14:36,839
500,000 results all the front page is

356
00:14:33,870 --> 00:14:38,639
talking about the the initial access in

357
00:14:36,839 --> 00:14:40,230
the<font color="#E5E5E5"> headlines if you search</font><font color="#CCCCCC"> for the</font>

358
00:14:38,639 --> 00:14:43,259
mount where you get another almost<font color="#E5E5E5"> half</font>

359
00:14:40,230 --> 00:14:44,699
million results again everything about

360
00:14:43,259 --> 00:14:46,319
the malware is in the headlines the

361
00:14:44,699 --> 00:14:49,459
title<font color="#CCCCCC"> of the page if you search for</font>

362
00:14:46,319 --> 00:14:51,839
domain admin or anything equivalent

363
00:14:49,459 --> 00:14:55,369
talking about the credential theft in

364
00:14:51,839 --> 00:14:59,519
the middle<font color="#E5E5E5"> you get vastly fewer results</font>

365
00:14:55,370 --> 00:15:01,100
none of the results are focusing on the

366
00:14:59,519 --> 00:15:03,569
credential theft in the headlines

367
00:15:01,100 --> 00:15:06,569
normally they're buried in<font color="#E5E5E5"> Step five of</font>

368
00:15:03,569 --> 00:15:08,329
the<font color="#CCCCCC"> 11th steps or somewhere else</font><font color="#E5E5E5"> in the</font>

369
00:15:06,569 --> 00:15:10,769
process so there's very little attention

370
00:15:08,329 --> 00:15:15,060
paid to this in terms of incident

371
00:15:10,769 --> 00:15:16,439
reports news coverage and not just

372
00:15:15,060 --> 00:15:21,060
incident reports the news coverage but

373
00:15:16,439 --> 00:15:23,099
also in in our area of security research

374
00:15:21,060 --> 00:15:25,939
there's often not a lot<font color="#CCCCCC"> of focus on</font>

375
00:15:23,100 --> 00:15:30,000
<font color="#E5E5E5">credentials and to illustrate that</font>

376
00:15:25,939 --> 00:15:32,969
starting in 2001 microsoft added

377
00:15:30,000 --> 00:15:35,850
something called w digest support which

378
00:15:32,970 --> 00:15:38,010
was a way to<font color="#CCCCCC"> use</font><font color="#E5E5E5"> windows integrated</font>

379
00:15:35,850 --> 00:15:38,440
authentication basically you sign<font color="#E5E5E5"> in to</font>

380
00:15:38,010 --> 00:15:40,480
your sister

381
00:15:38,440 --> 00:15:42,640
and then you can<font color="#E5E5E5"> with internet explorer</font>

382
00:15:40,480 --> 00:15:44,500
or another compatible browser go to a

383
00:15:42,640 --> 00:15:46,300
website it<font color="#E5E5E5"> will ask you for your</font>

384
00:15:44,500 --> 00:15:50,590
credentials and it will do a<font color="#E5E5E5"> challenge</font>

385
00:15:46,300 --> 00:15:52,630
in a response and and authenticate now

386
00:15:50,590 --> 00:15:54,820
it's been able to use ntlm for a long

387
00:15:52,630 --> 00:15:57,810
time what they<font color="#E5E5E5"> added in 2001 was w</font>

388
00:15:54,820 --> 00:16:03,190
digest now ntlm uses the<font color="#E5E5E5"> users</font><font color="#CCCCCC"> anti</font>

389
00:15:57,810 --> 00:16:06,640
password hash and<font color="#E5E5E5"> w digest used an md5</font>

390
00:16:03,190 --> 00:16:08,590
of the<font color="#CCCCCC"> users password and as a result of</font>

391
00:16:06,640 --> 00:16:11,530
implementing the support what Microsoft

392
00:16:08,590 --> 00:16:13,090
did was store that complete password it

393
00:16:11,530 --> 00:16:16,569
was a piece Kate but it was stored in

394
00:16:13,090 --> 00:16:19,210
<font color="#E5E5E5">the memory of the else SDXC process and</font>

395
00:16:16,570 --> 00:16:25,480
this was implied by documented features

396
00:16:19,210 --> 00:16:28,050
this is a page that was<font color="#E5E5E5"> upon in 2003 but</font>

397
00:16:25,480 --> 00:16:31,390
it was not exploited offensively until

398
00:16:28,050 --> 00:16:33,280
2012 almost<font color="#CCCCCC"> 10 years later when</font><font color="#E5E5E5"> Benjamin</font>

399
00:16:31,390 --> 00:16:35,620
<font color="#CCCCCC">delpy who is not a dedicated security</font>

400
00:16:33,280 --> 00:16:37,000
researcher released a hobby project mini

401
00:16:35,620 --> 00:16:38,890
cats where he was reverse engineering

402
00:16:37,000 --> 00:16:41,140
<font color="#E5E5E5">some windows and went huh you can get</font>

403
00:16:38,890 --> 00:16:44,260
somebody's password who's logged in by

404
00:16:41,140 --> 00:16:46,810
injecting into elsass following a few

405
00:16:44,260 --> 00:16:50,980
pointers and calling a function to<font color="#CCCCCC"> dfu</font>

406
00:16:46,810 --> 00:16:53,109
skate memory in these<font color="#CCCCCC"> breeches and</font>

407
00:16:50,980 --> 00:16:56,620
<font color="#E5E5E5">others the documented impact of memory</font>

408
00:16:53,110 --> 00:16:59,610
cats surpasses that of virtually any

409
00:16:56,620 --> 00:17:02,350
exploit released in the past five years

410
00:16:59,610 --> 00:17:04,720
these credential attacks tend to tend to

411
00:17:02,350 --> 00:17:07,870
lead in<font color="#CCCCCC"> real-world impact but</font><font color="#E5E5E5"> again they</font>

412
00:17:04,720 --> 00:17:10,800
receive very little research attention

413
00:17:07,869 --> 00:17:12,938
compared to a vulnerability exploitation

414
00:17:10,800 --> 00:17:18,819
and so<font color="#E5E5E5"> that's something that I think</font>

415
00:17:12,939 --> 00:17:20,740
that that we can fix also so you might

416
00:17:18,819 --> 00:17:24,159
ask yourself why is there such little

417
00:17:20,740 --> 00:17:25,870
interest in this topic and<font color="#E5E5E5"> I think</font>

418
00:17:24,160 --> 00:17:27,280
there's a number<font color="#E5E5E5"> of reasons the the</font>

419
00:17:25,869 --> 00:17:30,219
first thing is that<font color="#E5E5E5"> there's there's</font>

420
00:17:27,280 --> 00:17:33,310
often few visible alternatives this is

421
00:17:30,220 --> 00:17:35,320
the technique that is used by<font color="#E5E5E5"> Windows to</font>

422
00:17:33,310 --> 00:17:37,480
do single sign-on one administrator logs

423
00:17:35,320 --> 00:17:38,889
into his windows boxes want to sit<font color="#CCCCCC"> there</font>

424
00:17:37,480 --> 00:17:41,770
<font color="#CCCCCC">and type in</font><font color="#E5E5E5"> his password every time he</font>

425
00:17:38,890 --> 00:17:44,890
needs to<font color="#E5E5E5"> open up new policy or open up</font>

426
00:17:41,770 --> 00:17:47,100
<font color="#E5E5E5">his email or go access a file share that</font>

427
00:17:44,890 --> 00:17:49,000
all<font color="#E5E5E5"> needs to be a single sign on it so a</font>

428
00:17:47,100 --> 00:17:51,250
lot of<font color="#E5E5E5"> people look at this and they say</font>

429
00:17:49,000 --> 00:17:51,850
<font color="#E5E5E5">well you have to cash credentials some</font>

430
00:17:51,250 --> 00:17:55,450
kind<font color="#E5E5E5"> of</font>

431
00:17:51,850 --> 00:17:57,459
shows in memory for that<font color="#E5E5E5"> process so</font>

432
00:17:55,450 --> 00:17:59,740
there's a<font color="#E5E5E5"> lot of a lot of emphasis on</font>

433
00:17:57,460 --> 00:18:02,350
that a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> people say well you know</font>

434
00:17:59,740 --> 00:18:03,460
gee<font color="#CCCCCC"> you shouldn't have had a password</font>

435
00:18:02,350 --> 00:18:06,820
which could have been cracked you

436
00:18:03,460 --> 00:18:07,600
shouldn't have logged into a system you

437
00:18:06,820 --> 00:18:10,149
<font color="#E5E5E5">should have known that you should</font><font color="#CCCCCC"> have</font>

438
00:18:07,600 --> 00:18:11,199
put your password on that system<font color="#E5E5E5"> and a</font>

439
00:18:10,150 --> 00:18:12,460
lot of times<font color="#E5E5E5"> because I think there's a</font>

440
00:18:11,200 --> 00:18:17,500
<font color="#E5E5E5">little bit of lack</font><font color="#CCCCCC"> of imagination we</font>

441
00:18:12,460 --> 00:18:20,380
don't see any<font color="#CCCCCC"> other way to</font><font color="#E5E5E5"> do it so how</font>

442
00:18:17,500 --> 00:18:24,070
do we<font color="#E5E5E5"> how do we defend against this and</font>

443
00:18:20,380 --> 00:18:26,890
I'll show you what what we do as part of

444
00:18:24,070 --> 00:18:28,570
our credential assessments so we'll go

445
00:18:26,890 --> 00:18:30,850
in and assess<font color="#CCCCCC"> people</font><font color="#E5E5E5"> security like</font>

446
00:18:28,570 --> 00:18:32,470
probably<font color="#E5E5E5"> many of you work at security</font>

447
00:18:30,850 --> 00:18:33,879
companies where you<font color="#E5E5E5"> do security</font>

448
00:18:32,470 --> 00:18:36,880
assessments of companies red teaming

449
00:18:33,880 --> 00:18:38,830
contesting that kind of thing<font color="#E5E5E5"> I would</font>

450
00:18:36,880 --> 00:18:41,049
suggest<font color="#E5E5E5"> doing a credential assessment as</font>

451
00:18:38,830 --> 00:18:42,309
well as a vulnerability assessment so

452
00:18:41,049 --> 00:18:45,039
the first thing that<font color="#CCCCCC"> we'll do is we'll</font>

453
00:18:42,309 --> 00:18:48,340
identify the credential dissemination so

454
00:18:45,039 --> 00:18:50,440
figuring out where are all the

455
00:18:48,340 --> 00:18:52,959
credentials that we can find across all

456
00:18:50,440 --> 00:18:54,520
the systems on the network next thing

457
00:18:52,960 --> 00:18:57,039
that we do is we identify reused

458
00:18:54,520 --> 00:19:00,580
credentials this is a huge<font color="#CCCCCC"> initial</font>

459
00:18:57,039 --> 00:19:04,600
vector especially with things like local

460
00:19:00,580 --> 00:19:06,100
accounts you find the same often<font color="#CCCCCC"> the</font>

461
00:19:04,600 --> 00:19:08,530
same local administrator account is

462
00:19:06,100 --> 00:19:10,840
enabled<font color="#E5E5E5"> on every system across the</font>

463
00:19:08,530 --> 00:19:14,110
domain or across<font color="#E5E5E5"> a particular</font>

464
00:19:10,840 --> 00:19:15,340
organizational unit and so you can dump

465
00:19:14,110 --> 00:19:17,350
<font color="#E5E5E5">the hashes from one system if you</font>

466
00:19:15,340 --> 00:19:20,320
compromise that one system and then use

467
00:19:17,350 --> 00:19:22,870
it to go<font color="#E5E5E5"> on also you find this a lot</font>

468
00:19:20,320 --> 00:19:25,990
<font color="#CCCCCC">with domain accounts as well what we</font>

469
00:19:22,870 --> 00:19:29,530
tend<font color="#E5E5E5"> to find is that administrators have</font>

470
00:19:25,990 --> 00:19:31,780
a have a habit of using a particular

471
00:19:29,530 --> 00:19:33,730
password every time they set up a new

472
00:19:31,780 --> 00:19:34,960
user account and so maybe<font color="#E5E5E5"> this is one</font>

473
00:19:33,730 --> 00:19:36,039
that they use maybe this is one that

474
00:19:34,960 --> 00:19:38,020
ends up getting shared with other

475
00:19:36,039 --> 00:19:41,919
administrators or many that maybe this

476
00:19:38,020 --> 00:19:44,230
<font color="#E5E5E5">is one for users as well they'll</font><font color="#CCCCCC"> just</font>

477
00:19:41,919 --> 00:19:46,929
set up a every user account they'll set

478
00:19:44,230 --> 00:19:49,120
up they'll set up and use password 1234

479
00:19:46,929 --> 00:19:50,470
the password and then tell the user to

480
00:19:49,120 --> 00:19:53,289
change it later but then the user never

481
00:19:50,470 --> 00:19:57,250
does and so this happens for a lot of

482
00:19:53,289 --> 00:19:58,658
reasons the next thing that we do is

483
00:19:57,250 --> 00:20:00,850
after we've identified where these are

484
00:19:58,659 --> 00:20:02,710
<font color="#E5E5E5">and what the credentials are we'll look</font>

485
00:20:00,850 --> 00:20:05,530
at what the impact of the credentials

486
00:20:02,710 --> 00:20:09,280
are so basic

487
00:20:05,530 --> 00:20:11,379
who has what is what is<font color="#E5E5E5"> the group</font>

488
00:20:09,280 --> 00:20:13,720
membership what is what<font color="#CCCCCC"> are all the</font>

489
00:20:11,380 --> 00:20:15,100
groups that everyone is a member of what

490
00:20:13,720 --> 00:20:17,290
are all the privileges that those group

491
00:20:15,100 --> 00:20:18,879
have and what privileges have those

492
00:20:17,290 --> 00:20:20,710
groups been given on different systems

493
00:20:18,880 --> 00:20:22,150
and what is various configuration

494
00:20:20,710 --> 00:20:25,180
settings of those systems to figure out

495
00:20:22,150 --> 00:20:28,830
how you can who has rights over what

496
00:20:25,180 --> 00:20:31,360
systems and then once we once we do that

497
00:20:28,830 --> 00:20:35,230
went on to determine<font color="#CCCCCC"> recognize impose</font>

498
00:20:31,360 --> 00:20:37,090
tains then once we have that we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> help</font>

499
00:20:35,230 --> 00:20:39,370
the company clean up their credentials

500
00:20:37,090 --> 00:20:41,409
and determine changes to prevent it from

501
00:20:39,370 --> 00:20:43,300
happening again and then importantly

502
00:20:41,410 --> 00:20:45,340
continuing to audit<font color="#CCCCCC"> because a lot of</font>

503
00:20:43,300 --> 00:20:47,470
times these things tend to tend to

504
00:20:45,340 --> 00:20:52,600
revert and go back to to the way they

505
00:20:47,470 --> 00:20:56,620
<font color="#CCCCCC">were so first we scan collect data from</font>

506
00:20:52,600 --> 00:21:00,340
across the<font color="#E5E5E5"> network here's your simple</font>

507
00:20:56,620 --> 00:21:01,899
meaningless and wavy diagram we run a

508
00:21:00,340 --> 00:21:03,250
collector<font color="#E5E5E5"> on each of the boxes that all</font>

509
00:21:01,900 --> 00:21:05,770
comes<font color="#CCCCCC"> back into</font><font color="#E5E5E5"> a database than we do</font>

510
00:21:03,250 --> 00:21:09,610
queries on it to make the nice graphs

511
00:21:05,770 --> 00:21:13,210
and things so down a collection what we

512
00:21:09,610 --> 00:21:15,669
do on each of the systems is to as this

513
00:21:13,210 --> 00:21:17,860
this type of assessment works best as a

514
00:21:15,670 --> 00:21:20,440
white box assessment so we'll start<font color="#CCCCCC"> with</font>

515
00:21:17,860 --> 00:21:22,000
our credentials<font color="#CCCCCC"> and account</font><font color="#E5E5E5"> that someone</font>

516
00:21:20,440 --> 00:21:24,910
has already given us that we have rights

517
00:21:22,000 --> 00:21:26,560
to do this you can also do something

518
00:21:24,910 --> 00:21:28,840
<font color="#CCCCCC">like this in an offensive penetration</font>

519
00:21:26,560 --> 00:21:30,310
test where<font color="#CCCCCC"> you use only what you have</font>

520
00:21:28,840 --> 00:21:32,490
access to initially<font color="#E5E5E5"> and then try to</font>

521
00:21:30,310 --> 00:21:34,510
build up your access as you go along

522
00:21:32,490 --> 00:21:36,280
that<font color="#E5E5E5"> could be</font><font color="#CCCCCC"> a little more</font><font color="#E5E5E5"> intrusive</font>

523
00:21:34,510 --> 00:21:37,780
depending on what techniques you're

524
00:21:36,280 --> 00:21:41,320
using so we prefer<font color="#CCCCCC"> to do it as a white</font>

525
00:21:37,780 --> 00:21:43,680
box and so we have a small collector

526
00:21:41,320 --> 00:21:45,610
which runs then cleans up afterwards

527
00:21:43,680 --> 00:21:47,860
that will try to<font color="#E5E5E5"> find all the</font>

528
00:21:45,610 --> 00:21:49,959
credentials final so that's things like

529
00:21:47,860 --> 00:21:53,050
hashes on disk cache isn't memory

530
00:21:49,960 --> 00:21:55,480
Kerberos tickets passwords people saved

531
00:21:53,050 --> 00:21:58,540
passwords in<font color="#E5E5E5"> there Firefox and ie and</font>

532
00:21:55,480 --> 00:22:00,850
chrome<font color="#E5E5E5"> and you know all</font><font color="#CCCCCC"> that kind of</font>

533
00:21:58,540 --> 00:22:02,110
stuff<font color="#E5E5E5"> that we can find then what we'll</font>

534
00:22:00,850 --> 00:22:04,179
do is we'll find all the user counts on

535
00:22:02,110 --> 00:22:05,320
the<font color="#E5E5E5"> system all the local accounts if</font>

536
00:22:04,180 --> 00:22:06,820
it's a domain controller will pull all

537
00:22:05,320 --> 00:22:08,409
the domain accounts or you can remotely

538
00:22:06,820 --> 00:22:11,050
clear the domain controller using

539
00:22:08,410 --> 00:22:13,240
standard tools identify all the

540
00:22:11,050 --> 00:22:15,190
<font color="#CCCCCC">privileged assignments so this</font><font color="#E5E5E5"> is who's</font>

541
00:22:13,240 --> 00:22:17,290
<font color="#E5E5E5">all been granted what rights a lot of</font>

542
00:22:15,190 --> 00:22:18,670
<font color="#CCCCCC">times it's not necessarily clear because</font>

543
00:22:17,290 --> 00:22:19,539
the admins are seeing this from the

544
00:22:18,670 --> 00:22:23,350
perspective

545
00:22:19,539 --> 00:22:25,539
of group policy if you saw the talk a

546
00:22:23,350 --> 00:22:27,219
few hours<font color="#E5E5E5"> ago on on group policy there</font>

547
00:22:25,539 --> 00:22:28,779
can be<font color="#E5E5E5"> oftentimes</font><font color="#CCCCCC"> a lot of different</font>

548
00:22:27,220 --> 00:22:30,789
group policy objects and they can all be

549
00:22:28,779 --> 00:22:32,529
applied with different<font color="#E5E5E5"> settings to</font>

550
00:22:30,789 --> 00:22:33,460
different organizational units and all

551
00:22:32,529 --> 00:22:35,649
the times the administrators who are

552
00:22:33,460 --> 00:22:37,539
looking<font color="#E5E5E5"> at that console might think</font><font color="#CCCCCC"> that</font>

553
00:22:35,649 --> 00:22:39,758
one thing is is being applied to<font color="#CCCCCC"> a</font>

554
00:22:37,539 --> 00:22:40,899
system about when we scan the<font color="#E5E5E5"> actual</font>

555
00:22:39,759 --> 00:22:45,279
system we see what's actually been

556
00:22:40,899 --> 00:22:47,320
applied<font color="#CCCCCC"> and then we record all the</font>

557
00:22:45,279 --> 00:22:51,039
system configuration details which are

558
00:22:47,320 --> 00:22:53,470
relevant and and group memberships so

559
00:22:51,039 --> 00:22:56,229
then we try to we try to draw that<font color="#CCCCCC"> links</font>

560
00:22:53,470 --> 00:22:58,389
and what's interesting is that having

561
00:22:56,229 --> 00:23:00,159
<font color="#E5E5E5">started to do this and then tested our</font>

562
00:22:58,389 --> 00:23:03,248
results<font color="#E5E5E5"> against different configurations</font>

563
00:23:00,159 --> 00:23:07,299
and different systems we've found out in

564
00:23:03,249 --> 00:23:12,090
<font color="#E5E5E5">the wild we've gotten surprised a lot</font><font color="#CCCCCC"> of</font>

565
00:23:07,299 --> 00:23:14,320
times by how things work and and by how

566
00:23:12,090 --> 00:23:16,119
how they're different credentials can be

567
00:23:14,320 --> 00:23:18,070
<font color="#E5E5E5">used or can't be so for example this is</font>

568
00:23:16,119 --> 00:23:20,129
<font color="#E5E5E5">something we see commonly</font><font color="#CCCCCC"> we'll have two</font>

569
00:23:18,070 --> 00:23:22,509
different workstations Alice and<font color="#E5E5E5"> Bob</font>

570
00:23:20,129 --> 00:23:23,769
they have different local accounts but

571
00:23:22,509 --> 00:23:26,229
they both have the same administrator

572
00:23:23,769 --> 00:23:30,849
account and it has the same<font color="#E5E5E5"> password or</font>

573
00:23:26,229 --> 00:23:32,349
password hash in this case so oh you can

574
00:23:30,849 --> 00:23:34,689
steal the hash from Alice if you

575
00:23:32,349 --> 00:23:42,279
compromise that system and use it to

576
00:23:34,690 --> 00:23:43,869
compromise Bob but in reality nope our

577
00:23:42,279 --> 00:23:46,149
link is not<font color="#E5E5E5"> going to work so we're going</font>

578
00:23:43,869 --> 00:23:48,399
to skip<font color="#CCCCCC"> that we go</font><font color="#E5E5E5"> ahead</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> try to run</font>

579
00:23:46,149 --> 00:23:53,349
this attack using a<font color="#CCCCCC"> metasploit pass the</font>

580
00:23:48,399 --> 00:23:56,738
hash and we get exploit failed status

581
00:23:53,349 --> 00:23:59,649
<font color="#E5E5E5">logon failure but the administrators in</font>

582
00:23:56,739 --> 00:24:02,649
the administrators group so why could

583
00:23:59,649 --> 00:24:07,449
this fail well there's a number<font color="#E5E5E5"> of</font>

584
00:24:02,649 --> 00:24:09,189
reasons one<font color="#CCCCCC"> of the reasons is back in</font>

585
00:24:07,450 --> 00:24:10,599
the good old days you could if you had

586
00:24:09,190 --> 00:24:12,700
<font color="#E5E5E5">an account and it was in the</font>

587
00:24:10,599 --> 00:24:14,979
administrators group and it was enabled

588
00:24:12,700 --> 00:24:16,179
you have to check<font color="#E5E5E5"> their in able to then</font>

589
00:24:14,979 --> 00:24:20,279
you would be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to use</font><font color="#CCCCCC"> that to</font>

590
00:24:16,179 --> 00:24:23,169
remotely access this system Along Came

591
00:24:20,279 --> 00:24:27,009
Microsoft's user account control or UIC

592
00:24:23,169 --> 00:24:28,929
and they decided you know<font color="#CCCCCC"> what this</font>

593
00:24:27,009 --> 00:24:29,950
happens too much these are local counts

594
00:24:28,929 --> 00:24:31,960
they shouldn't be<font color="#E5E5E5"> used for remote</font>

595
00:24:29,950 --> 00:24:33,070
administration so we are<font color="#E5E5E5"> going to block</font>

596
00:24:31,960 --> 00:24:38,019
them

597
00:24:33,070 --> 00:24:39,580
privileged network logon and so starting

598
00:24:38,019 --> 00:24:43,840
in Windows Vista with default UAC

599
00:24:39,580 --> 00:24:45,309
settings it means it's the the default

600
00:24:43,840 --> 00:24:47,259
setting is called run all administrators

601
00:24:45,309 --> 00:24:49,750
in admin approval mode although<font color="#CCCCCC"> you can</font>

602
00:24:47,259 --> 00:24:52,299
change that default setting if that is

603
00:24:49,750 --> 00:24:55,960
set then the local administrators will

604
00:24:52,299 --> 00:24:57,250
not be able<font color="#E5E5E5"> to login except</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the 500</font>

605
00:24:55,960 --> 00:24:58,450
account or the built-in local

606
00:24:57,250 --> 00:25:00,880
administrator which has its own set<font color="#E5E5E5"> of</font>

607
00:24:58,450 --> 00:25:03,370
rules and so that local administrator

608
00:25:00,880 --> 00:25:07,299
will be able<font color="#E5E5E5"> to remotely control all the</font>

609
00:25:03,370 --> 00:25:09,100
other systems with network logon unless

610
00:25:07,299 --> 00:25:10,570
you<font color="#E5E5E5"> have another setting which by</font>

611
00:25:09,100 --> 00:25:12,070
default is turned off but if you have

612
00:25:10,570 --> 00:25:13,330
that setting called admin approval mode

613
00:25:12,070 --> 00:25:16,059
for the building administrator account

614
00:25:13,330 --> 00:25:19,779
enabled then that particular account

615
00:25:16,059 --> 00:25:21,428
will<font color="#E5E5E5"> be denied access and so okay you go</font>

616
00:25:19,779 --> 00:25:23,799
<font color="#CCCCCC">in and you see Oh in</font><font color="#E5E5E5"> this case I have</font>

617
00:25:21,429 --> 00:25:26,559
<font color="#E5E5E5">that account enabled what happens if i</font>

618
00:25:23,799 --> 00:25:28,360
disable them back to the default

619
00:25:26,559 --> 00:25:31,928
settings so we try our local

620
00:25:28,360 --> 00:25:35,979
administrator account again and<font color="#CCCCCC"> status</font>

621
00:25:31,929 --> 00:25:38,230
logon failure again so so now what we've

622
00:25:35,980 --> 00:25:40,210
we've got an account we've got the

623
00:25:38,230 --> 00:25:44,080
credentials the accounts enabled it

624
00:25:40,210 --> 00:25:47,919
shouldn't be UAC restricted as it turns

625
00:25:44,080 --> 00:25:49,809
out for non domain join systems we<font color="#CCCCCC"> have</font>

626
00:25:47,919 --> 00:25:52,840
a setting called forced<font color="#CCCCCC"> guest which is</font>

627
00:25:49,809 --> 00:25:54,789
enabled by default which means it has

628
00:25:52,840 --> 00:25:56,500
the same effect<font color="#CCCCCC"> to local administrators</font>

629
00:25:54,789 --> 00:25:58,950
they are blocked<font color="#E5E5E5"> and only given guest</font>

630
00:25:56,500 --> 00:26:02,110
access they're not given their

631
00:25:58,950 --> 00:26:05,409
administrator rights like they have been

632
00:26:02,110 --> 00:26:07,750
<font color="#E5E5E5">given before so on sanitation is</font>

633
00:26:05,409 --> 00:26:10,389
complicated you have special rights

634
00:26:07,750 --> 00:26:12,580
<font color="#E5E5E5">assignments such as this is just the</font>

635
00:26:10,389 --> 00:26:15,668
again non default settings can be

636
00:26:12,580 --> 00:26:17,799
applied you can use icd-9 network<font color="#E5E5E5"> logon</font>

637
00:26:15,669 --> 00:26:21,009
right to deny access to certain groups

638
00:26:17,799 --> 00:26:22,450
from the network or SD network logon

639
00:26:21,009 --> 00:26:25,149
right to grant access to certain groups

640
00:26:22,450 --> 00:26:28,860
from the<font color="#CCCCCC"> network you</font><font color="#E5E5E5"> have special</font><font color="#CCCCCC"> Sid</font>

641
00:26:25,149 --> 00:26:32,049
restrictions so if a particular account

642
00:26:28,860 --> 00:26:34,570
starting in I believe this<font color="#E5E5E5"> was an update</font>

643
00:26:32,049 --> 00:26:37,200
<font color="#E5E5E5">available for Windows 7 but starting in</font>

644
00:26:34,570 --> 00:26:39,970
Windows 8 by default you can<font color="#E5E5E5"> now apply</font>

645
00:26:37,200 --> 00:26:41,909
restrictions to a special<font color="#E5E5E5"> Sid which is</font>

646
00:26:39,970 --> 00:26:44,740
basically a special virtual account

647
00:26:41,909 --> 00:26:46,960
which encompasses all local accounts or

648
00:26:44,740 --> 00:26:48,760
all local council are members of<font color="#E5E5E5"> the</font>

649
00:26:46,960 --> 00:26:50,679
straighter group and you can for<font color="#CCCCCC"> example</font>

650
00:26:48,760 --> 00:26:51,669
specifically deny them access to<font color="#CCCCCC"> the</font>

651
00:26:50,679 --> 00:26:54,789
network if you want to lock down your

652
00:26:51,669 --> 00:26:55,990
systems which<font color="#E5E5E5"> I recommend and then you</font>

653
00:26:54,789 --> 00:26:58,390
have firewall policies which of course

654
00:26:55,990 --> 00:27:02,260
can can directly block inbound our

655
00:26:58,390 --> 00:27:05,679
communication and all of that applies

656
00:27:02,260 --> 00:27:07,000
and will restrict or enable someone who

657
00:27:05,679 --> 00:27:11,110
has an administrator<font color="#E5E5E5"> account on that</font>

658
00:27:07,000 --> 00:27:13,210
system from running processes with full

659
00:27:11,110 --> 00:27:14,678
system control via<font color="#E5E5E5"> wrote service</font>

660
00:27:13,210 --> 00:27:16,779
management this<font color="#E5E5E5"> is what the piece exact</font>

661
00:27:14,679 --> 00:27:20,340
tool does and the Metasploit module

662
00:27:16,779 --> 00:27:23,169
there or remote file share access so

663
00:27:20,340 --> 00:27:25,389
there's a<font color="#E5E5E5"> technique known as the wbem</font>

664
00:27:23,169 --> 00:27:27,159
MLF method where basically<font color="#CCCCCC"> you just drop</font>

665
00:27:25,390 --> 00:27:29,110
a file in a particular folder of a

666
00:27:27,159 --> 00:27:31,270
<font color="#E5E5E5">particular type that will be parsed by</font>

667
00:27:29,110 --> 00:27:34,178
windows management instrumentation back

668
00:27:31,270 --> 00:27:36,520
end and then executed with complete

669
00:27:34,179 --> 00:27:39,159
privileges and so if<font color="#E5E5E5"> you can drop that</font>

670
00:27:36,520 --> 00:27:41,379
file there then you can also take over

671
00:27:39,159 --> 00:27:44,370
the account or remote registry access

672
00:27:41,380 --> 00:27:46,750
such as<font color="#E5E5E5"> setting a run key or setting</font>

673
00:27:44,370 --> 00:27:49,689
different different other registry keys

674
00:27:46,750 --> 00:27:50,980
or remote<font color="#CCCCCC"> tap schedulers such as by</font>

675
00:27:49,690 --> 00:27:52,299
creating a scheduled<font color="#E5E5E5"> task and then</font>

676
00:27:50,980 --> 00:27:55,090
launching it which can also run with

677
00:27:52,299 --> 00:27:57,399
full system control or remote<font color="#E5E5E5"> wmi</font>

678
00:27:55,090 --> 00:27:59,289
windows management instrumentation runs

679
00:27:57,399 --> 00:28:01,539
its own remote procedure call server on

680
00:27:59,289 --> 00:28:02,950
a different port and you can use w my

681
00:28:01,539 --> 00:28:04,899
it's one of the most direct methods to

682
00:28:02,950 --> 00:28:05,980
execute a command on a remote system<font color="#E5E5E5"> and</font>

683
00:28:04,899 --> 00:28:08,139
then finally<font color="#CCCCCC"> there's windows remote</font>

684
00:28:05,980 --> 00:28:10,419
management which is the basis of

685
00:28:08,140 --> 00:28:11,770
PowerShell remoting so if you've<font color="#E5E5E5"> seen</font>

686
00:28:10,419 --> 00:28:14,919
some<font color="#E5E5E5"> of the new techniques that now</font>

687
00:28:11,770 --> 00:28:16,779
available<font color="#CCCCCC"> for Windows PowerShell</font>

688
00:28:14,919 --> 00:28:19,659
remoting it's a very nice way of

689
00:28:16,779 --> 00:28:23,679
managing systems that also uses the same

690
00:28:19,659 --> 00:28:25,480
authentication<font color="#CCCCCC"> backend however there's</font>

691
00:28:23,679 --> 00:28:28,779
an entirely different set<font color="#CCCCCC"> of rules for</font>

692
00:28:25,480 --> 00:28:31,350
remote desktop user account control it

693
00:28:28,779 --> 00:28:35,890
does not affect remote desktop which is

694
00:28:31,350 --> 00:28:39,189
another big kind<font color="#E5E5E5"> of hole in the in</font><font color="#CCCCCC"> the</font>

695
00:28:35,890 --> 00:28:40,659
process which<font color="#CCCCCC"> has been opened up by by</font>

696
00:28:39,190 --> 00:28:43,029
the settings so even though local

697
00:28:40,659 --> 00:28:44,559
<font color="#E5E5E5">accounts now are blocked</font><font color="#CCCCCC"> from remote</font>

698
00:28:43,029 --> 00:28:48,100
access by user account control by

699
00:28:44,559 --> 00:28:49,510
default if remote desktop is enabled<font color="#E5E5E5"> on</font>

700
00:28:48,100 --> 00:28:51,760
that system they can still remote

701
00:28:49,510 --> 00:28:53,169
<font color="#E5E5E5">desktop into that system however</font><font color="#CCCCCC"> to row</font>

702
00:28:51,760 --> 00:28:56,529
desktop in you need the actual password

703
00:28:53,169 --> 00:28:58,270
you can't just use a password hash but

704
00:28:56,529 --> 00:29:01,120
that can be changed<font color="#CCCCCC"> now with the</font>

705
00:28:58,270 --> 00:29:03,850
introduction of<font color="#E5E5E5"> restricted</font>

706
00:29:01,120 --> 00:29:07,689
in raw mode for remote desktop and this

707
00:29:03,850 --> 00:29:09,669
is a new a<font color="#E5E5E5"> new setting which</font><font color="#CCCCCC"> Microsoft</font>

708
00:29:07,690 --> 00:29:12,100
introduced not long ago about a year and

709
00:29:09,670 --> 00:29:14,380
<font color="#CCCCCC">half</font><font color="#E5E5E5"> ago to allow you to remotely</font>

710
00:29:12,100 --> 00:29:16,659
control a system without giving that

711
00:29:14,380 --> 00:29:20,500
your password or hash or Kerberos ticket

712
00:29:16,660 --> 00:29:22,270
so if you authenticate with a restricted

713
00:29:20,500 --> 00:29:23,950
admin remote desktop and restricted

714
00:29:22,270 --> 00:29:27,190
<font color="#CCCCCC">Edmond remote desktop is enabled</font><font color="#E5E5E5"> on that</font>

715
00:29:23,950 --> 00:29:29,020
system you will<font color="#E5E5E5"> just do a network level</font>

716
00:29:27,190 --> 00:29:30,580
authentication<font color="#E5E5E5"> you will not send your</font>

717
00:29:29,020 --> 00:29:32,260
password<font color="#CCCCCC"> to that system so it's a great</font>

718
00:29:30,580 --> 00:29:36,070
<font color="#E5E5E5">way of avoiding giving away your</font>

719
00:29:32,260 --> 00:29:38,710
credentials to these web servers but it

720
00:29:36,070 --> 00:29:41,500
also<font color="#CCCCCC"> opens up the ability</font><font color="#E5E5E5"> to pass the</font>

721
00:29:38,710 --> 00:29:48,610
hash to a remote desktop endpoint<font color="#E5E5E5"> and</font>

722
00:29:41,500 --> 00:29:49,929
bypass user account control and and the

723
00:29:48,610 --> 00:29:54,100
the<font color="#CCCCCC"> other thing which is interesting</font>

724
00:29:49,929 --> 00:29:56,080
about this is the documentation on msdn

725
00:29:54,100 --> 00:29:58,149
from<font color="#E5E5E5"> Microsoft is not always correct</font>

726
00:29:56,080 --> 00:30:01,300
either<font color="#E5E5E5"> so it's always important whenever</font>

727
00:29:58,150 --> 00:30:03,190
you have a particular<font color="#E5E5E5"> set of settings or</font>

728
00:30:01,300 --> 00:30:05,169
a particular configuration you want to

729
00:30:03,190 --> 00:30:06,340
test out always test it and make sure it

730
00:30:05,170 --> 00:30:09,250
<font color="#E5E5E5">actually does what you think it's</font><font color="#CCCCCC"> going</font>

731
00:30:06,340 --> 00:30:10,809
<font color="#CCCCCC">to do because sometimes especially</font><font color="#E5E5E5"> when</font>

732
00:30:09,250 --> 00:30:12,660
you have non default settings the

733
00:30:10,809 --> 00:30:14,590
interaction<font color="#CCCCCC"> between these things can</font>

734
00:30:12,660 --> 00:30:18,970
cannot work out<font color="#E5E5E5"> the way you think it</font>

735
00:30:14,590 --> 00:30:20,860
does finally if nothing is open so

736
00:30:18,970 --> 00:30:22,480
suppose you<font color="#E5E5E5"> have remote desktop disabled</font>

737
00:30:20,860 --> 00:30:25,300
you have forced<font color="#E5E5E5"> guest enable on the</font>

738
00:30:22,480 --> 00:30:27,220
system you have a<font color="#CCCCCC"> fart wall blocking all</font>

739
00:30:25,300 --> 00:30:29,950
remote connections in on all the ports

740
00:30:27,220 --> 00:30:31,450
so without targeting the user you know

741
00:30:29,950 --> 00:30:34,660
<font color="#CCCCCC">convincing the user to do something and</font>

742
00:30:31,450 --> 00:30:42,700
without using an exploit can you take

743
00:30:34,660 --> 00:30:45,730
<font color="#CCCCCC">over that system so how would I take</font>

744
00:30:42,700 --> 00:30:47,440
over<font color="#CCCCCC"> that system well if you are paying</font>

745
00:30:45,730 --> 00:30:49,720
<font color="#CCCCCC">attention to the talk a couple hours ago</font>

746
00:30:47,440 --> 00:30:51,850
the answer is of course yes you can take

747
00:30:49,720 --> 00:30:54,490
<font color="#E5E5E5">over the system and you can use group</font>

748
00:30:51,850 --> 00:30:56,290
policy to do that because if you have

749
00:30:54,490 --> 00:30:58,090
the rights to apply<font color="#E5E5E5"> group policy object</font>

750
00:30:56,290 --> 00:31:00,610
or modify a group policy object which is

751
00:30:58,090 --> 00:31:03,070
<font color="#E5E5E5">applied to the system you can have it</font>

752
00:31:00,610 --> 00:31:07,030
run a scheduled task and run whatever

753
00:31:03,070 --> 00:31:11,169
<font color="#E5E5E5">you want and so all</font><font color="#CCCCCC"> this is important</font>

754
00:31:07,030 --> 00:31:13,090
because we<font color="#E5E5E5"> basically we don't want to go</font>

755
00:31:11,170 --> 00:31:14,830
down the same route which has happened

756
00:31:13,090 --> 00:31:18,070
in<font color="#E5E5E5"> vulnerability scanners were when you</font>

757
00:31:14,830 --> 00:31:20,699
scan a web server for example you'll

758
00:31:18,070 --> 00:31:24,480
often get thousands of vulnerabilities

759
00:31:20,700 --> 00:31:26,860
in a particular PHP install for example

760
00:31:24,480 --> 00:31:29,110
but if you look closely all of these

761
00:31:26,860 --> 00:31:31,750
vulnerabilities are actually only a

762
00:31:29,110 --> 00:31:35,049
vulnerability if you allow untrusted

763
00:31:31,750 --> 00:31:37,960
users to run PHP code and rely on the

764
00:31:35,049 --> 00:31:41,019
PHP sandbox to prevent them<font color="#E5E5E5"> and so in</font>

765
00:31:37,960 --> 00:31:42,519
most installations where untrusted users

766
00:31:41,019 --> 00:31:44,679
are not allowed to execute code on the

767
00:31:42,519 --> 00:31:48,190
system none of<font color="#E5E5E5"> these are vulnerabilities</font>

768
00:31:44,679 --> 00:31:51,370
and so what happens is a<font color="#CCCCCC"> lot of times in</font>

769
00:31:48,190 --> 00:31:52,960
the security operations center or IT

770
00:31:51,370 --> 00:31:54,309
management they'll get one of these

771
00:31:52,960 --> 00:31:56,019
<font color="#CCCCCC">reports</font><font color="#E5E5E5"> it will plop down with a</font>

772
00:31:54,309 --> 00:31:59,260
thousand different vulnerabilities on a

773
00:31:56,019 --> 00:32:01,090
thousand<font color="#E5E5E5"> different systems and they'll</font>

774
00:31:59,260 --> 00:32:03,010
get ignored because they'll<font color="#CCCCCC"> all be</font>

775
00:32:01,090 --> 00:32:04,240
looked at as low priority or not

776
00:32:03,010 --> 00:32:07,269
something<font color="#E5E5E5"> important so it's very</font>

777
00:32:04,240 --> 00:32:09,610
important to to us to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that</font>

778
00:32:07,269 --> 00:32:11,110
when we're saying hey these credentials

779
00:32:09,610 --> 00:32:12,908
can be stolen<font color="#CCCCCC"> your entire network in</font>

780
00:32:11,110 --> 00:32:16,928
Domino down that that<font color="#CCCCCC"> actually happens</font>

781
00:32:12,909 --> 00:32:18,279
so to put<font color="#E5E5E5"> all together as an example we</font>

782
00:32:16,929 --> 00:32:19,870
have three systems here with the<font color="#E5E5E5"> domain</font>

783
00:32:18,279 --> 00:32:22,450
controller and domain join workstations

784
00:32:19,870 --> 00:32:26,320
and we're going<font color="#CCCCCC"> to say what happens if</font>

785
00:32:22,450 --> 00:32:29,130
<font color="#E5E5E5">Bill</font><font color="#CCCCCC"> Loney who is just a random user on</font>

786
00:32:26,320 --> 00:32:32,439
the system on the network opens up a

787
00:32:29,130 --> 00:32:35,169
phishing email and gets compromised his

788
00:32:32,440 --> 00:32:37,179
account compromised so the first thing

789
00:32:35,169 --> 00:32:40,600
<font color="#CCCCCC">that we do when we pull out this up</font>

790
00:32:37,179 --> 00:32:43,090
after having run a scan and collected

791
00:32:40,600 --> 00:32:45,158
all the information as we see Bill<font color="#E5E5E5"> Oni</font>

792
00:32:43,090 --> 00:32:46,720
has no rights to<font color="#E5E5E5"> anything so he there's</font>

793
00:32:45,159 --> 00:32:49,899
no<font color="#CCCCCC"> link from him to any of the systems</font>

794
00:32:46,720 --> 00:32:51,429
however<font color="#E5E5E5"> there is a link to reused</font>

795
00:32:49,899 --> 00:32:53,229
credential node which means he is

796
00:32:51,429 --> 00:32:54,730
sharing a password so who else is

797
00:32:53,230 --> 00:32:56,860
sharing that password well in this case

798
00:32:54,730 --> 00:32:59,980
six other accounts share the password

799
00:32:56,860 --> 00:33:02,110
<font color="#CCCCCC">and that</font><font color="#E5E5E5"> includes some local accounts I</font>

800
00:32:59,980 --> 00:33:04,480
meant some domain accounts on this

801
00:33:02,110 --> 00:33:08,019
frequently happens with local accounts

802
00:33:04,480 --> 00:33:09,580
because with domain accounts there's at

803
00:33:08,019 --> 00:33:12,070
least some visibility to the

804
00:33:09,580 --> 00:33:14,860
administrators they can see I do a query

805
00:33:12,070 --> 00:33:17,710
and see ah who has not<font color="#CCCCCC"> had a password</font>

806
00:33:14,860 --> 00:33:19,750
changed in the past 120 days or you know

807
00:33:17,710 --> 00:33:21,399
who hasn't<font color="#E5E5E5"> had a password set it they</font>

808
00:33:19,750 --> 00:33:23,080
can they can do all that that's not easy

809
00:33:21,399 --> 00:33:25,959
<font color="#E5E5E5">to find out for the local accounts on a</font>

810
00:33:23,080 --> 00:33:27,760
Windows domain who can who has these

811
00:33:25,960 --> 00:33:28,540
hasn't had their password changed it

812
00:33:27,760 --> 00:33:32,320
forever

813
00:33:28,540 --> 00:33:34,030
etc so to these local accounts have

814
00:33:32,320 --> 00:33:35,169
admin rights over their respective

815
00:33:34,030 --> 00:33:37,180
systems so these are probably<font color="#CCCCCC"> the</font>

816
00:33:35,170 --> 00:33:39,550
building a local administrator<font color="#E5E5E5"> account</font>

817
00:33:37,180 --> 00:33:42,220
on those systems so if you have

818
00:33:39,550 --> 00:33:46,210
compromised Bologna's account you could

819
00:33:42,220 --> 00:33:48,880
<font color="#E5E5E5">then use</font><font color="#CCCCCC"> that password or that hash two</font>

820
00:33:46,210 --> 00:33:49,900
then<font color="#CCCCCC"> compromised these other systems and</font>

821
00:33:48,880 --> 00:33:52,090
once you have compromised those other

822
00:33:49,900 --> 00:33:55,620
systems using these other accounts you

823
00:33:52,090 --> 00:33:58,060
could steal the I Kerberos ticket

824
00:33:55,620 --> 00:33:59,530
password hash or password from any of

825
00:33:58,060 --> 00:34:02,139
the people who are logged into those

826
00:33:59,530 --> 00:34:04,210
systems and so on one of those systems

827
00:34:02,140 --> 00:34:08,980
there was a token which means there's a

828
00:34:04,210 --> 00:34:11,710
password hash or or password or Kerberos

829
00:34:08,980 --> 00:34:14,199
ticket for sterling Archer and sterling

830
00:34:11,710 --> 00:34:15,580
Archer is a domain administrator and he

831
00:34:14,199 --> 00:34:17,139
has rights over the domain controller

832
00:34:15,580 --> 00:34:19,690
and once you have rights with a domain

833
00:34:17,139 --> 00:34:20,949
controller then you can control group

834
00:34:19,690 --> 00:34:22,360
policy and you<font color="#E5E5E5"> can control the entire</font>

835
00:34:20,949 --> 00:34:24,270
domain and all the accounts in it and

836
00:34:22,360 --> 00:34:26,919
then your entire network is compromised

837
00:34:24,270 --> 00:34:28,540
so this<font color="#E5E5E5"> is a pretty common pattern we've</font>

838
00:34:26,918 --> 00:34:30,310
simplified it here to<font color="#E5E5E5"> just a few tests</font>

839
00:34:28,540 --> 00:34:32,830
but in most of the networks<font color="#E5E5E5"> that we go</font>

840
00:34:30,310 --> 00:34:34,810
and we do a credential assessment on we

841
00:34:32,830 --> 00:34:37,270
can automatically find a path to domain

842
00:34:34,810 --> 00:34:39,730
admin from<font color="#E5E5E5"> 99% of the systems on the</font>

843
00:34:37,270 --> 00:34:43,120
network<font color="#CCCCCC"> and so</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is again a very</font>

844
00:34:39,730 --> 00:34:46,120
common layout of<font color="#E5E5E5"> what that</font><font color="#CCCCCC"> Network looks</font>

845
00:34:43,120 --> 00:34:48,819
like we also see a lot of non shortest

846
00:34:46,120 --> 00:34:52,359
paths as well throughout throughout the

847
00:34:48,820 --> 00:34:53,169
network and so one of the other<font color="#CCCCCC"> things</font>

848
00:34:52,360 --> 00:34:55,419
that we want<font color="#E5E5E5"> to do is wanna help people</font>

849
00:34:53,168 --> 00:34:57,549
remediate the action so we say well what

850
00:34:55,418 --> 00:34:59,470
happens if<font color="#CCCCCC"> we know this guy has</font><font color="#E5E5E5"> been</font>

851
00:34:57,550 --> 00:35:00,790
logging into some reiation what happens

852
00:34:59,470 --> 00:35:04,060
if we disable is account take him out of

853
00:35:00,790 --> 00:35:05,230
<font color="#CCCCCC">the picture well in that case your bills</font>

854
00:35:04,060 --> 00:35:07,960
fish still matters you<font color="#E5E5E5"> can still</font>

855
00:35:05,230 --> 00:35:09,940
compromise these local systems but<font color="#E5E5E5"> it's</font>

856
00:35:07,960 --> 00:35:11,470
<font color="#E5E5E5">not immediately catastrophic it doesn't</font>

857
00:35:09,940 --> 00:35:16,180
result in full demand compromise and it

858
00:35:11,470 --> 00:35:19,180
doesn't go past a few systems<font color="#CCCCCC"> all right</font>

859
00:35:16,180 --> 00:35:20,770
so having having<font color="#E5E5E5"> seen on this risk what</font>

860
00:35:19,180 --> 00:35:23,589
can you do to<font color="#CCCCCC"> help prevent</font><font color="#E5E5E5"> this from</font>

861
00:35:20,770 --> 00:35:24,730
happening on your<font color="#CCCCCC"> own network</font><font color="#E5E5E5"> so the</font>

862
00:35:23,590 --> 00:35:26,350
first<font color="#CCCCCC"> thing i'd recommend doing is</font>

863
00:35:24,730 --> 00:35:28,900
blocking local accounts from remote

864
00:35:26,350 --> 00:35:31,660
access to domain systems so use some of

865
00:35:28,900 --> 00:35:34,240
those local account special security

866
00:35:31,660 --> 00:35:36,430
identifier to<font color="#E5E5E5"> block network logon and</font>

867
00:35:34,240 --> 00:35:39,729
block remote desktop<font color="#CCCCCC"> logon make</font><font color="#E5E5E5"> sure you</font>

868
00:35:36,430 --> 00:35:41,950
get both of<font color="#E5E5E5"> them and then</font><font color="#CCCCCC"> I use some</font><font color="#E5E5E5"> of</font>

869
00:35:39,730 --> 00:35:46,060
the newer features in Windows 8.1 and

870
00:35:41,950 --> 00:35:47,560
2012 and Windows 10<font color="#CCCCCC"> and 2016 as well to</font>

871
00:35:46,060 --> 00:35:50,078
prevent<font color="#E5E5E5"> giving away domain credentials</font>

872
00:35:47,560 --> 00:35:54,400
so you can go into group policy and<font color="#CCCCCC"> you</font>

873
00:35:50,079 --> 00:35:55,900
can<font color="#CCCCCC"> actually prevent people from giving</font>

874
00:35:54,400 --> 00:35:59,079
away their credentials to remote system

875
00:35:55,900 --> 00:36:02,140
via remote desktop make sure you first

876
00:35:59,079 --> 00:36:03,280
enable restricted admin then test it out

877
00:36:02,140 --> 00:36:05,170
<font color="#CCCCCC">to make sure that will work for</font><font color="#E5E5E5"> your</font>

878
00:36:03,280 --> 00:36:06,670
administrators before you go on<font color="#E5E5E5"> to</font>

879
00:36:05,170 --> 00:36:08,880
forcing that because otherwise<font color="#CCCCCC"> a lot of</font>

880
00:36:06,670 --> 00:36:13,079
things<font color="#E5E5E5"> will will not work as expected</font>

881
00:36:08,880 --> 00:36:16,329
and so<font color="#E5E5E5"> this will help a lot with</font>

882
00:36:13,079 --> 00:36:17,829
preventing your administrators from

883
00:36:16,329 --> 00:36:21,369
giving away their password to different

884
00:36:17,829 --> 00:36:24,880
different systems another thing which I

885
00:36:21,369 --> 00:36:27,010
highly recommend is at least for your

886
00:36:24,880 --> 00:36:29,380
privileged administrator accounts don't

887
00:36:27,010 --> 00:36:33,820
use passwords<font color="#E5E5E5"> I'd recommend using smart</font>

888
00:36:29,380 --> 00:36:37,359
cards for those you can get tokens for

889
00:36:33,820 --> 00:36:39,339
about twenty twenty dollars and they can

890
00:36:37,359 --> 00:36:40,990
they<font color="#E5E5E5"> can help a lot because there are</font>

891
00:36:39,339 --> 00:36:43,900
simply so many attacks which rely on

892
00:36:40,990 --> 00:36:47,319
reuse passwords weak passwords guessable

893
00:36:43,900 --> 00:36:48,910
passwords and and most of the time when

894
00:36:47,319 --> 00:36:51,009
we<font color="#E5E5E5"> get into a network</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can crack a</font>

895
00:36:48,910 --> 00:36:52,930
very high percentage of<font color="#E5E5E5"> the hashes on</font>

896
00:36:51,010 --> 00:36:55,720
that network once you've done that I

897
00:36:52,930 --> 00:36:58,290
have a little<font color="#E5E5E5"> bit of a PowerShell script</font>

898
00:36:55,720 --> 00:37:01,660
here you can google<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is taken from</font>

899
00:36:58,290 --> 00:37:02,980
chris campbell who has a twitter handle

900
00:37:01,660 --> 00:37:04,810
obscure<font color="#E5E5E5"> sec and here's a little</font>

901
00:37:02,980 --> 00:37:07,359
powershell script which can enable you

902
00:37:04,810 --> 00:37:10,569
to randomize the hashes of all of your

903
00:37:07,359 --> 00:37:12,460
smart card users and what that will do

904
00:37:10,569 --> 00:37:14,050
just by toggling an attribute so that

905
00:37:12,460 --> 00:37:16,300
means<font color="#E5E5E5"> even if somebody did steal the</font>

906
00:37:14,050 --> 00:37:19,420
password hash they would quickly find it

907
00:37:16,300 --> 00:37:22,450
invalidated and this tends to<font color="#E5E5E5"> help with</font>

908
00:37:19,420 --> 00:37:24,190
things like backups if somebody found an

909
00:37:22,450 --> 00:37:25,180
old backup of a<font color="#E5E5E5"> domain controller or</font>

910
00:37:24,190 --> 00:37:27,730
something like that they were able<font color="#E5E5E5"> to</font>

911
00:37:25,180 --> 00:37:29,940
<font color="#CCCCCC">extract out password</font><font color="#E5E5E5"> hashes you would be</font>

912
00:37:27,730 --> 00:37:33,640
<font color="#CCCCCC">able to invalidate those credentials</font>

913
00:37:29,940 --> 00:37:35,589
then<font color="#E5E5E5"> I also recommend changing the curb</font>

914
00:37:33,640 --> 00:37:40,029
TGT account password on a regular basis

915
00:37:35,589 --> 00:37:41,170
this is again I persistence issue don't

916
00:37:40,030 --> 00:37:43,150
have a lot of time to go into it in

917
00:37:41,170 --> 00:37:46,300
<font color="#E5E5E5">detail but this is basically the the key</font>

918
00:37:43,150 --> 00:37:47,530
used for kerberos authentication within

919
00:37:46,300 --> 00:37:49,780
the<font color="#CCCCCC"> Windows domain</font><font color="#E5E5E5"> so if any attacker</font>

920
00:37:47,530 --> 00:37:52,270
has this and you don't<font color="#E5E5E5"> manually change</font>

921
00:37:49,780 --> 00:37:56,450
this at some<font color="#CCCCCC"> point they</font><font color="#E5E5E5"> will be</font><font color="#CCCCCC"> able to</font>

922
00:37:52,270 --> 00:37:59,040
<font color="#E5E5E5">use</font><font color="#CCCCCC"> that to regain access to your entire</font>

923
00:37:56,450 --> 00:38:02,879
finally authentication policies and

924
00:37:59,040 --> 00:38:04,500
silos you can now<font color="#CCCCCC"> use those to restrict</font>

925
00:38:02,880 --> 00:38:06,120
the source<font color="#E5E5E5"> of logged on and the past you</font>

926
00:38:04,500 --> 00:38:07,200
could only restrict the target of log on

927
00:38:06,120 --> 00:38:09,630
so you could say hey if<font color="#E5E5E5"> there's</font>

928
00:38:07,200 --> 00:38:11,669
countless discount shouldn't be able<font color="#E5E5E5"> to</font>

929
00:38:09,630 --> 00:38:12,930
<font color="#E5E5E5">log on to the system but if somebody</font>

930
00:38:11,670 --> 00:38:14,340
it's<font color="#CCCCCC"> Dylan that accounts credentials</font>

931
00:38:12,930 --> 00:38:16,710
they could log on from anywhere with

932
00:38:14,340 --> 00:38:18,210
<font color="#E5E5E5">authentication silos you can now</font>

933
00:38:16,710 --> 00:38:20,640
restrict the source of that as<font color="#CCCCCC"> well and</font>

934
00:38:18,210 --> 00:38:22,020
you can combine those two do to help

935
00:38:20,640 --> 00:38:23,879
prevent<font color="#E5E5E5"> people from giving away their</font>

936
00:38:22,020 --> 00:38:27,030
credentials to a place where<font color="#E5E5E5"> they</font>

937
00:38:23,880 --> 00:38:30,660
<font color="#E5E5E5">shouldn't and</font><font color="#CCCCCC"> blocking them from using</font>

938
00:38:27,030 --> 00:38:32,100
them if they were<font color="#E5E5E5"> stolen blocking ntlm</font>

939
00:38:30,660 --> 00:38:35,220
for domain servers is also something i

940
00:38:32,100 --> 00:38:38,759
recommend reduces the impact of stolen

941
00:38:35,220 --> 00:38:40,709
hashes and<font color="#E5E5E5"> you can use the privileged</font>

942
00:38:38,760 --> 00:38:43,050
access workstation model again something

943
00:38:40,710 --> 00:38:44,670
<font color="#E5E5E5">else to</font><font color="#CCCCCC"> Google which helps you logically</font>

944
00:38:43,050 --> 00:38:47,520
organized your network in a way where

945
00:38:44,670 --> 00:38:49,860
the highly privileged users will never

946
00:38:47,520 --> 00:38:51,120
be able to<font color="#CCCCCC"> log into the giveaway their</font>

947
00:38:49,860 --> 00:38:53,250
credentials to the<font color="#E5E5E5"> lower privileged</font>

948
00:38:51,120 --> 00:38:56,069
systems but they will<font color="#E5E5E5"> still be able to</font>

949
00:38:53,250 --> 00:38:58,230
manage them and<font color="#CCCCCC"> finally using tools to</font>

950
00:38:56,070 --> 00:39:00,090
continuously on it so with with

951
00:38:58,230 --> 00:39:02,790
metasploit you can do this manually you

952
00:39:00,090 --> 00:39:04,340
can compromise a system identify all the

953
00:39:02,790 --> 00:39:07,920
credentials you can find on that system

954
00:39:04,340 --> 00:39:09,510
<font color="#CCCCCC">test pass the hash to validate your</font>

955
00:39:07,920 --> 00:39:11,960
controls it's a little<font color="#CCCCCC"> bit clunky</font>

956
00:39:09,510 --> 00:39:14,640
because it's<font color="#E5E5E5"> really an interactive</font>

957
00:39:11,960 --> 00:39:18,810
system to use against 11 system at a

958
00:39:14,640 --> 00:39:22,460
time Bloodhound is a new release as of a

959
00:39:18,810 --> 00:39:25,259
few months<font color="#E5E5E5"> ago this is designed for</font>

960
00:39:22,460 --> 00:39:27,420
offensive use it uses information

961
00:39:25,260 --> 00:39:28,800
available to low privileged users to

962
00:39:27,420 --> 00:39:30,960
attempt to map out where different

963
00:39:28,800 --> 00:39:32,940
people are logged in from and so<font color="#E5E5E5"> where</font>

964
00:39:30,960 --> 00:39:34,080
their credentials are and then what

965
00:39:32,940 --> 00:39:36,360
those different accounts have

966
00:39:34,080 --> 00:39:37,980
administrative privileges over so it

967
00:39:36,360 --> 00:39:40,590
does a quick assessment it can't see all

968
00:39:37,980 --> 00:39:43,530
the details<font color="#E5E5E5"> of the privileges and all</font>

969
00:39:40,590 --> 00:39:46,320
that kind of stuff but<font color="#E5E5E5"> it is a very very</font>

970
00:39:43,530 --> 00:39:48,570
handy tool runs very fast it's great<font color="#E5E5E5"> for</font>

971
00:39:46,320 --> 00:39:53,190
pen testers and it is open source as

972
00:39:48,570 --> 00:39:57,120
<font color="#CCCCCC">well lastly we have</font><font color="#E5E5E5"> our own tool which</font>

973
00:39:53,190 --> 00:40:00,600
is<font color="#E5E5E5"> Orko's this one is a full disclosure</font>

974
00:39:57,120 --> 00:40:01,799
there's a commercial tool but<font color="#CCCCCC"> it doesn't</font>

975
00:40:00,600 --> 00:40:04,160
more comprehensive collection and

976
00:40:01,800 --> 00:40:07,260
<font color="#CCCCCC">intends to find all those other links</font>

977
00:40:04,160 --> 00:40:08,549
<font color="#E5E5E5">alright so in summary pay attention to</font>

978
00:40:07,260 --> 00:40:10,049
the credentials on your network

979
00:40:08,549 --> 00:40:11,609
make sure people are assessing your

980
00:40:10,049 --> 00:40:13,589
<font color="#E5E5E5">network for risks or mediate those</font>

981
00:40:11,609 --> 00:40:17,819
problems and try to prevent it from

982
00:40:13,589 --> 00:40:25,380
happening in the future and so with<font color="#E5E5E5"> that</font>

983
00:40:17,819 --> 00:40:27,979
do we have any questions any questions

984
00:40:25,380 --> 00:40:27,979
<font color="#CCCCCC">any way</font>

985
00:40:37,740 --> 00:40:44,279
could you give a few words on trusts and

986
00:40:41,310 --> 00:40:45,779
domain trusts when you have so bigger

987
00:40:44,280 --> 00:40:47,610
<font color="#E5E5E5">enterprise usually about the sub</font>

988
00:40:45,780 --> 00:40:49,680
companies or other things where you have

989
00:40:47,610 --> 00:40:52,080
trusted setups between different reason

990
00:40:49,680 --> 00:40:56,339
yeah yes so that's a very<font color="#CCCCCC"> good question</font>

991
00:40:52,080 --> 00:40:58,770
about<font color="#E5E5E5"> the main trusts the so the first</font>

992
00:40:56,340 --> 00:41:00,890
the<font color="#E5E5E5"> first thing you should remember and</font>

993
00:40:58,770 --> 00:41:03,930
this is I didn't cover it but the

994
00:41:00,890 --> 00:41:08,040
PowerShell team at Veras has done a

995
00:41:03,930 --> 00:41:11,700
<font color="#E5E5E5">great job of using trust with in a</font>

996
00:41:08,040 --> 00:41:13,940
forest<font color="#E5E5E5"> to if you have compromised any</font>

997
00:41:11,700 --> 00:41:16,230
domain in the forest you can basically

998
00:41:13,940 --> 00:41:17,820
tell any of the other domains that you

999
00:41:16,230 --> 00:41:20,760
have a Kerberos ticket valid for one of

1000
00:41:17,820 --> 00:41:22,200
their administrators and so using

1001
00:41:20,760 --> 00:41:23,910
something called Sid history and<font color="#CCCCCC"> cross</font>

1002
00:41:22,200 --> 00:41:27,689
tickets so it's important to<font color="#CCCCCC"> remember</font>

1003
00:41:23,910 --> 00:41:29,580
that that I and Microsoft acknowledges

1004
00:41:27,690 --> 00:41:31,890
this the the trust boundary is the

1005
00:41:29,580 --> 00:41:33,630
forest<font color="#E5E5E5"> itself so you cannot prevent</font>

1006
00:41:31,890 --> 00:41:35,759
someone who has control of one domain in

1007
00:41:33,630 --> 00:41:37,140
your forest from compromising everything

1008
00:41:35,760 --> 00:41:39,570
else in your forest so that's a very

1009
00:41:37,140 --> 00:41:41,220
important<font color="#CCCCCC"> thing to remember however</font>

1010
00:41:39,570 --> 00:41:42,660
<font color="#E5E5E5">between forests if you have trust</font>

1011
00:41:41,220 --> 00:41:45,089
between forests that's a<font color="#E5E5E5"> little bit</font>

1012
00:41:42,660 --> 00:41:48,390
different because those attacks don't

1013
00:41:45,090 --> 00:41:51,330
work between forests basically what you

1014
00:41:48,390 --> 00:41:53,069
really<font color="#CCCCCC"> have to do is look at what rights</font>

1015
00:41:51,330 --> 00:41:56,400
each of those user accounts has been

1016
00:41:53,070 --> 00:41:59,580
granted<font color="#CCCCCC"> and and follow this you know use</font>

1017
00:41:56,400 --> 00:42:03,240
something like<font color="#E5E5E5"> Orko's to identify or</font>

1018
00:41:59,580 --> 00:42:05,279
bloodhound to identify hey what are all

1019
00:42:03,240 --> 00:42:07,589
of the users who have access over this

1020
00:42:05,280 --> 00:42:10,470
system<font color="#E5E5E5"> and even if they're in another</font>

1021
00:42:07,590 --> 00:42:12,510
domain they should still work I'm and

1022
00:42:10,470 --> 00:42:14,100
tell you who has access<font color="#E5E5E5"> to that because</font>

1023
00:42:12,510 --> 00:42:21,660
they'll show up in the administrators

1024
00:42:14,100 --> 00:42:24,770
group any more questions<font color="#CCCCCC"> okay thanks</font>

1025
00:42:21,660 --> 00:42:24,770
very much Matt thank you

