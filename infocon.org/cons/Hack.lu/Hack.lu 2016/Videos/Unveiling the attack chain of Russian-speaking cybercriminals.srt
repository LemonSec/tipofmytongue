1
00:00:02,600 --> 00:00:09,889
the my hand hello hello<font color="#E5E5E5"> hey guys thank</font>

2
00:00:07,430 --> 00:00:11,719
<font color="#E5E5E5">you for coming my name is</font><font color="#CCCCCC"> Sam home i'm a</font>

3
00:00:09,889 --> 00:00:13,489
senior theories that you're a poop right

4
00:00:11,719 --> 00:00:15,829
<font color="#E5E5E5">i'm also pentester over 10 years</font>

5
00:00:13,490 --> 00:00:17,990
experience let's talk when will be

6
00:00:15,830 --> 00:00:27,320
presenter<font color="#E5E5E5"> i hope you guys enjoy his talk</font>

7
00:00:17,990 --> 00:00:33,699
thank you<font color="#CCCCCC"> okay thank you</font><font color="#E5E5E5"> son let me just</font>

8
00:00:27,320 --> 00:00:37,159
see if the clicker is working<font color="#CCCCCC"> okay cool</font>

9
00:00:33,699 --> 00:00:39,349
thank you for coming<font color="#E5E5E5"> through our talk so</font>

10
00:00:37,159 --> 00:00:42,890
today we're going to be talking about

11
00:00:39,350 --> 00:00:46,010
the<font color="#CCCCCC"> ass rocks group on and i</font><font color="#E5E5E5"> think one</font>

12
00:00:42,890 --> 00:00:51,249
key point of this talk is there as rocks

13
00:00:46,010 --> 00:00:53,870
was a pretty active it was launching

14
00:00:51,249 --> 00:00:56,389
campaigns with millions and millions of

15
00:00:53,870 --> 00:00:59,708
messages daily and then all of a sudden

16
00:00:56,389 --> 00:01:03,469
<font color="#E5E5E5">at end of 20 15 it just died away on</font>

17
00:00:59,709 --> 00:01:06,500
people many researchers believe that

18
00:01:03,469 --> 00:01:11,240
<font color="#CCCCCC">they have seized their operation and</font>

19
00:01:06,500 --> 00:01:13,670
<font color="#E5E5E5">well we'll talk today about how this is</font>

20
00:01:11,240 --> 00:01:15,949
not true they're still active they have

21
00:01:13,670 --> 00:01:19,909
<font color="#E5E5E5">just changed their ways of operation a</font>

22
00:01:15,950 --> 00:01:22,729
lot has been<font color="#E5E5E5"> published about how their</font>

23
00:01:19,909 --> 00:01:25,609
malware works and that's<font color="#E5E5E5"> not our focus</font>

24
00:01:22,729 --> 00:01:28,189
today our focus today is how they run

25
00:01:25,609 --> 00:01:35,390
their operations and how their tools

26
00:01:28,189 --> 00:01:38,719
work how do they infect people and we're

27
00:01:35,390 --> 00:01:43,700
a proof point sunday night wait we're at

28
00:01:38,719 --> 00:01:46,609
a<font color="#E5E5E5"> taiwan</font><font color="#CCCCCC"> Poupon office so we flew all</font>

29
00:01:43,700 --> 00:01:48,740
the way from taiwan year well do as

30
00:01:46,609 --> 00:01:53,380
proxy and pay overview how they spread

31
00:01:48,740 --> 00:01:56,560
malware strategy changes from 14 to<font color="#E5E5E5"> 16</font>

32
00:01:53,380 --> 00:02:00,350
will be dissecting their tds server and

33
00:01:56,560 --> 00:02:03,710
we'll talk about<font color="#E5E5E5"> their command and</font>

34
00:02:00,350 --> 00:02:06,109
<font color="#E5E5E5">control infrastructure economics of</font>

35
00:02:03,710 --> 00:02:11,150
their cyber black black market how

36
00:02:06,109 --> 00:02:14,030
they're able<font color="#E5E5E5"> to buy massively by admin</font>

37
00:02:11,150 --> 00:02:16,040
credentials from a black market that

38
00:02:14,030 --> 00:02:20,329
they operate themselves

39
00:02:16,040 --> 00:02:24,469
and we'll make a conclusion as<font color="#CCCCCC"> prox is a</font>

40
00:02:20,329 --> 00:02:27,109
well-known family of malware that's been

41
00:02:24,469 --> 00:02:31,280
used as far as we know by a single

42
00:02:27,109 --> 00:02:35,060
attacker by a single actor<font color="#CCCCCC"> that is</font>

43
00:02:31,280 --> 00:02:39,170
<font color="#E5E5E5">russian-speaking and they have been</font>

44
00:02:35,060 --> 00:02:42,709
<font color="#E5E5E5">around since 2007 it mostly targeting</font>

45
00:02:39,170 --> 00:02:45,858
<font color="#E5E5E5">Windows users they have had success</font>

46
00:02:42,709 --> 00:02:50,689
infecting<font color="#E5E5E5"> Android devices since 20 14</font>

47
00:02:45,859 --> 00:02:54,439
third quarter and<font color="#E5E5E5"> we have</font><font color="#CCCCCC"> been tracking</font>

48
00:02:50,689 --> 00:02:58,040
<font color="#E5E5E5">them since October 20 14 their</font>

49
00:02:54,439 --> 00:03:00,888
<font color="#E5E5E5">russian-speaking and Mallory's not focus</font>

50
00:02:58,040 --> 00:03:06,798
is not the focus today but it is really

51
00:03:00,889 --> 00:03:10,040
<font color="#E5E5E5">their operations and tools so this group</font>

52
00:03:06,799 --> 00:03:14,560
as I<font color="#E5E5E5"> believe many of you know what they</font>

53
00:03:10,040 --> 00:03:20,228
do is they try to infect endpoints<font color="#E5E5E5"> by</font>

54
00:03:14,560 --> 00:03:24,530
massively sending out email spams and

55
00:03:20,229 --> 00:03:27,739
usually with links embedded in these

56
00:03:24,530 --> 00:03:31,060
emails personalized links meaning<font color="#CCCCCC"> that</font>

57
00:03:27,739 --> 00:03:33,790
every<font color="#E5E5E5"> single email has a different URL</font>

58
00:03:31,060 --> 00:03:38,269
we call these personalized URLs and

59
00:03:33,790 --> 00:03:41,599
these URLs point2 compromised legitimate

60
00:03:38,269 --> 00:03:47,329
<font color="#E5E5E5">but compromised web servers that will</font>

61
00:03:41,599 --> 00:03:50,599
ultimately redirect to malware and they

62
00:03:47,329 --> 00:03:56,419
swam using a wide array of social

63
00:03:50,599 --> 00:03:59,478
<font color="#CCCCCC">engineering lures so DHL FedEx couriers</font>

64
00:03:56,419 --> 00:04:02,199
coupons gift certificates<font color="#E5E5E5"> court</font>

65
00:03:59,479 --> 00:04:05,349
notifications etc they have<font color="#E5E5E5"> about 30</font>

66
00:04:02,199 --> 00:04:16,139
email templates that they frequently use

67
00:04:05,349 --> 00:04:24,969
oops oh<font color="#E5E5E5"> okay</font>

68
00:04:16,139 --> 00:04:29,949
so um<font color="#E5E5E5"> okay so I'll use</font><font color="#CCCCCC"> that one I'll</font>

69
00:04:24,970 --> 00:04:36,550
just get over here but I can't<font color="#CCCCCC"> see my</font>

70
00:04:29,949 --> 00:04:40,630
<font color="#CCCCCC">slice um</font><font color="#E5E5E5"> okay they do they do delivery</font>

71
00:04:36,550 --> 00:04:43,240
testing which means that<font color="#E5E5E5"> for every eat</font>

72
00:04:40,630 --> 00:04:46,150
for every campaign before they launch

73
00:04:43,240 --> 00:04:49,690
they love to use these two<font color="#E5E5E5"> services skin</font>

74
00:04:46,150 --> 00:04:51,549
for you and AV detect and they'll use

75
00:04:49,690 --> 00:04:53,710
and this<font color="#E5E5E5"> is what we call delivery</font>

76
00:04:51,550 --> 00:04:55,979
testing so what they'll do is they'll

77
00:04:53,710 --> 00:04:59,859
use these services and make sure<font color="#E5E5E5"> that</font>

78
00:04:55,979 --> 00:05:02,550
<font color="#E5E5E5">their email template the domains that</font>

79
00:04:59,860 --> 00:05:05,410
they're using<font color="#E5E5E5"> all of the compromised</font>

80
00:05:02,550 --> 00:05:08,410
legitimate websites that they have

81
00:05:05,410 --> 00:05:11,110
purchased access to and have hosted

82
00:05:08,410 --> 00:05:14,710
malicious scripts on and the malicious

83
00:05:11,110 --> 00:05:18,010
scripts themselves all of these<font color="#E5E5E5"> are not</font>

84
00:05:14,710 --> 00:05:20,229
detected<font color="#E5E5E5"> by any antivirus and these are</font>

85
00:05:18,010 --> 00:05:23,500
the two services that that they love to

86
00:05:20,229 --> 00:05:27,940
use these are like<font color="#E5E5E5"> buyers total they</font>

87
00:05:23,500 --> 00:05:29,889
check scripts URLs domains to see if any

88
00:05:27,940 --> 00:05:35,139
of these are flagged by any of the

89
00:05:29,889 --> 00:05:38,710
<font color="#CCCCCC">well-known</font><font color="#E5E5E5"> antivirus so this is this</font>

90
00:05:35,139 --> 00:05:41,229
chart is basically how they operate they

91
00:05:38,710 --> 00:05:43,930
have the they have a set of tools which

92
00:05:41,229 --> 00:05:45,699
will show you will show you the

93
00:05:43,930 --> 00:05:49,810
screenshots of these tools they use

94
00:05:45,699 --> 00:05:51,370
these tools to pre-configure all of the

95
00:05:49,810 --> 00:05:54,520
<font color="#CCCCCC">campaign's that</font><font color="#E5E5E5"> they want to send out</font>

96
00:05:51,370 --> 00:05:58,030
and the time<font color="#E5E5E5"> frame they want to stand</font>

97
00:05:54,520 --> 00:06:01,299
out and it's very geo specific for every

98
00:05:58,030 --> 00:06:03,159
geolocation they have different email

99
00:06:01,300 --> 00:06:06,389
templates and they have different time

100
00:06:03,160 --> 00:06:10,060
frames where they'll and they have

101
00:06:06,389 --> 00:06:12,669
different volumes of messages<font color="#CCCCCC"> that they</font>

102
00:06:10,060 --> 00:06:16,810
want to send out they'll send<font color="#CCCCCC"> out these</font>

103
00:06:12,669 --> 00:06:20,198
email within every single message there

104
00:06:16,810 --> 00:06:23,050
is a personalized URL and these

105
00:06:20,199 --> 00:06:26,409
personalized<font color="#E5E5E5"> URLs point to legitimate</font>

106
00:06:23,050 --> 00:06:29,830
but compromised web servers and then

107
00:06:26,409 --> 00:06:32,440
massively<font color="#CCCCCC"> purchased these web servers</font>

108
00:06:29,830 --> 00:06:35,229
the admin credentials to these web

109
00:06:32,440 --> 00:06:39,130
servers from an underground<font color="#E5E5E5"> market that</font>

110
00:06:35,230 --> 00:06:41,740
they run themselves so when the user

111
00:06:39,130 --> 00:06:43,570
clicks on these<font color="#E5E5E5"> URLs they're actually go</font>

112
00:06:41,740 --> 00:06:46,840
into a legitimate website but

113
00:06:43,570 --> 00:06:49,590
compromised and inject<font color="#E5E5E5"> it with a PHP</font>

114
00:06:46,840 --> 00:06:53,530
script that's developed by this group

115
00:06:49,590 --> 00:06:57,280
the PHP script will validate<font color="#E5E5E5"> we'll do</font>

116
00:06:53,530 --> 00:07:01,239
some<font color="#E5E5E5"> validation and then for example if</font>

117
00:06:57,280 --> 00:07:03,969
a researcher tempers with a URL it

118
00:07:01,240 --> 00:07:07,570
wouldn't redirect if it's happy it will

119
00:07:03,970 --> 00:07:10,570
redirect to<font color="#CCCCCC"> a tds the tds server which</font>

120
00:07:07,570 --> 00:07:14,860
and we believe<font color="#CCCCCC"> that this tds script is</font>

121
00:07:10,570 --> 00:07:19,920
developed<font color="#E5E5E5"> by themselves and they didn't</font>

122
00:07:14,860 --> 00:07:24,000
get it from<font color="#E5E5E5"> off-the-shelf our stuff and</font>

123
00:07:19,920 --> 00:07:28,270
those tds will further verify the arm

124
00:07:24,000 --> 00:07:30,010
whether the visitor is someone that they

125
00:07:28,270 --> 00:07:32,530
do<font color="#E5E5E5"> want to infect whether you're coming</font>

126
00:07:30,010 --> 00:07:35,710
from the right geolocation whether your

127
00:07:32,530 --> 00:07:38,289
IP belongs to a crawler<font color="#E5E5E5"> a bot or a</font>

128
00:07:35,710 --> 00:07:40,780
security vendor things like that and

129
00:07:38,290 --> 00:07:43,330
whether<font color="#E5E5E5"> you have visited them more than</font>

130
00:07:40,780 --> 00:07:46,270
five<font color="#CCCCCC"> times and</font><font color="#E5E5E5"> if they're happy</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> all</font>

131
00:07:43,330 --> 00:07:48,250
of the above<font color="#E5E5E5"> they will</font><font color="#CCCCCC"> then serve you</font>

132
00:07:46,270 --> 00:07:50,789
the<font color="#CCCCCC"> tds server will come up with a file</font>

133
00:07:48,250 --> 00:07:54,820
<font color="#E5E5E5">name usually a zip file containing</font>

134
00:07:50,790 --> 00:07:59,040
malware and it will<font color="#E5E5E5"> give you that file</font>

135
00:07:54,820 --> 00:08:01,930
if the user then extract the zip

136
00:07:59,040 --> 00:08:07,720
installs and gets installs the excusable

137
00:08:01,930 --> 00:08:12,700
and gets infected then their bot will

138
00:08:07,720 --> 00:08:15,370
link back to the botnet in from well

139
00:08:12,700 --> 00:08:17,140
there come from the compromised endpoint

140
00:08:15,370 --> 00:08:19,360
will become a part of the botnet<font color="#E5E5E5"> and</font>

141
00:08:17,140 --> 00:08:21,370
we'll try<font color="#CCCCCC"> to link back to the command</font>

142
00:08:19,360 --> 00:08:25,330
and<font color="#E5E5E5"> control before the command and</font>

143
00:08:21,370 --> 00:08:29,830
<font color="#E5E5E5">control we have seen about more than 50</font>

144
00:08:25,330 --> 00:08:32,740
reverse proxies that are<font color="#E5E5E5"> trying to</font>

145
00:08:29,830 --> 00:08:35,319
shield the actual command and control

146
00:08:32,740 --> 00:08:39,070
servers which are only about one or two

147
00:08:35,320 --> 00:08:41,710
but they've got 50 of those engines

148
00:08:39,070 --> 00:08:44,050
based reverse proxies to shield the real

149
00:08:41,710 --> 00:08:46,750
<font color="#CCCCCC">sea to server address</font>

150
00:08:44,049 --> 00:08:49,229
and so will show you the entire

151
00:08:46,750 --> 00:08:52,420
infrastructure and all of the tools

152
00:08:49,230 --> 00:08:55,300
these are what their email campaigns

153
00:08:52,420 --> 00:09:00,610
look like and there's about<font color="#CCCCCC"> 30 templates</font>

154
00:08:55,300 --> 00:09:05,290
or so sending out spam how they send out

155
00:09:00,610 --> 00:09:09,670
these men<font color="#E5E5E5"> um what they used to do a lot</font>

156
00:09:05,290 --> 00:09:13,420
is through an<font color="#E5E5E5"> SMTP module on the</font>

157
00:09:09,670 --> 00:09:16,779
<font color="#E5E5E5">infected pc so they used to use infected</font>

158
00:09:13,420 --> 00:09:21,279
pcs to send out these spam so install an

159
00:09:16,779 --> 00:09:24,010
SMTP module on the<font color="#CCCCCC"> infected pcs nowadays</font>

160
00:09:21,279 --> 00:09:27,750
what they do because they<font color="#CCCCCC"> have since</font><font color="#E5E5E5"> the</font>

161
00:09:24,010 --> 00:09:31,510
<font color="#CCCCCC">since</font><font color="#E5E5E5"> to end of 205 they have stopped</font>

162
00:09:27,750 --> 00:09:34,600
spreading the<font color="#E5E5E5"> ASP rocks malware so now</font>

163
00:09:31,510 --> 00:09:38,829
they do not have they have a decreasing

164
00:09:34,600 --> 00:09:41,980
volume of infected pcs now these days

165
00:09:38,829 --> 00:09:48,300
they send<font color="#E5E5E5"> out these are spam emails</font>

166
00:09:41,980 --> 00:09:51,850
through a web shell and a phpmailer on

167
00:09:48,300 --> 00:09:55,089
the legitimate the compromised web

168
00:09:51,850 --> 00:09:58,570
servers so nowadays they send out<font color="#E5E5E5"> more</font>

169
00:09:55,089 --> 00:10:03,040
from the web servers before it was on

170
00:09:58,570 --> 00:10:05,410
<font color="#E5E5E5">infected pcs how do they send out once</font>

171
00:10:03,040 --> 00:10:08,529
they have these modules either these are

172
00:10:05,410 --> 00:10:11,649
<font color="#E5E5E5">just some smtp modules either on the pc</font>

173
00:10:08,529 --> 00:10:14,350
<font color="#E5E5E5">on the server both the same um they use</font>

174
00:10:11,649 --> 00:10:17,290
legitimate but compromise<font color="#E5E5E5"> email accounts</font>

175
00:10:14,350 --> 00:10:22,959
that they have purchased on for example

176
00:10:17,290 --> 00:10:25,180
<font color="#E5E5E5">um like these and some and they</font><font color="#CCCCCC"> send it</font>

177
00:10:22,959 --> 00:10:27,760
out this way<font color="#E5E5E5"> so the emails that are</font>

178
00:10:25,180 --> 00:10:32,680
sending these spam out are legitimate

179
00:10:27,760 --> 00:10:35,199
but compromised emails how much assets

180
00:10:32,680 --> 00:10:38,079
do they have there about two billion

181
00:10:35,199 --> 00:10:41,260
targeted email addresses that they

182
00:10:38,079 --> 00:10:45,609
<font color="#E5E5E5">purchased are they</font><font color="#CCCCCC"> owned almost a</font>

183
00:10:41,260 --> 00:10:48,370
million smtp accounts more<font color="#E5E5E5"> than a</font>

184
00:10:45,610 --> 00:10:52,089
million PHP web shells that support

185
00:10:48,370 --> 00:10:55,270
email sending so these<font color="#E5E5E5"> are PHP scripts</font>

186
00:10:52,089 --> 00:10:57,459
on back doors that they have injected

187
00:10:55,270 --> 00:10:57,930
into legitimate websites more than<font color="#E5E5E5"> a</font>

188
00:10:57,459 --> 00:11:00,969
million

189
00:10:57,930 --> 00:11:08,140
that that also helps them<font color="#E5E5E5"> send these out</font>

190
00:11:00,970 --> 00:11:10,480
<font color="#E5E5E5">and</font><font color="#CCCCCC"> 30 or so email templates um and here</font>

191
00:11:08,140 --> 00:11:15,780
you can<font color="#CCCCCC"> see the spam back end this is</font>

192
00:11:10,480 --> 00:11:19,150
the descender tasks so you can see<font color="#CCCCCC"> that</font>

193
00:11:15,780 --> 00:11:23,579
through the through this interface

194
00:11:19,150 --> 00:11:27,160
they're able<font color="#E5E5E5"> to pre-configure arm um</font>

195
00:11:23,580 --> 00:11:29,920
<font color="#E5E5E5">what what region to target what email</font>

196
00:11:27,160 --> 00:11:35,800
template to send out and you<font color="#CCCCCC"> can see</font>

197
00:11:29,920 --> 00:11:39,189
from the the very right column every

198
00:11:35,800 --> 00:11:41,530
campaign most of these campaigns are

199
00:11:39,190 --> 00:11:45,900
more than<font color="#E5E5E5"> a million messages per</font>

200
00:11:41,530 --> 00:11:53,079
campaign so this<font color="#CCCCCC"> is one of</font><font color="#E5E5E5"> their our</font>

201
00:11:45,900 --> 00:11:58,540
back end panels and here we can see that

202
00:11:53,080 --> 00:12:01,600
<font color="#E5E5E5">on it's very geo-targeted so so they</font>

203
00:11:58,540 --> 00:12:04,800
would configure their they<font color="#E5E5E5"> organize</font>

204
00:12:01,600 --> 00:12:07,630
their emails all<font color="#CCCCCC"> of that 1,000,000,000</font>

205
00:12:04,800 --> 00:12:12,670
targeted emails into<font color="#E5E5E5"> different databases</font>

206
00:12:07,630 --> 00:12:15,100
and every database contains emails for

207
00:12:12,670 --> 00:12:17,709
that particular region for them one for

208
00:12:15,100 --> 00:12:20,200
UK they've won for Australia they have

209
00:12:17,710 --> 00:12:21,820
one for North America things like<font color="#CCCCCC"> that</font>

210
00:12:20,200 --> 00:12:24,460
and this is where they configure all

211
00:12:21,820 --> 00:12:28,270
right from which so so they have this

212
00:12:24,460 --> 00:12:30,430
<font color="#E5E5E5">big big botnet right either from the pcs</font>

213
00:12:28,270 --> 00:12:33,850
<font color="#E5E5E5">or from the servers that they own it</font>

214
00:12:30,430 --> 00:12:38,500
will configure all right for this set of

215
00:12:33,850 --> 00:12:40,840
email for on this set of UK emails when

216
00:12:38,500 --> 00:12:44,830
do we when do<font color="#CCCCCC"> we want</font><font color="#E5E5E5"> to start when do</font>

217
00:12:40,840 --> 00:12:46,690
we<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to end on and so this</font><font color="#CCCCCC"> is how</font>

218
00:12:44,830 --> 00:12:48,310
they pre-configured all of the

219
00:12:46,690 --> 00:12:52,660
<font color="#E5E5E5">campaign's that they want to send out</font>

220
00:12:48,310 --> 00:12:55,560
they can<font color="#CCCCCC"> further go into detail as we</font>

221
00:12:52,660 --> 00:12:59,890
may have another screen to show you the

222
00:12:55,560 --> 00:13:06,099
thea for example the pause between every

223
00:12:59,890 --> 00:13:10,900
single email that they send out um and

224
00:13:06,100 --> 00:13:11,910
in order<font color="#CCCCCC"> to get the targeted email</font>

225
00:13:10,900 --> 00:13:17,439
addresses

226
00:13:11,910 --> 00:13:21,370
the<font color="#E5E5E5"> SMTP accounts that they used to send</font>

227
00:13:17,440 --> 00:13:24,070
and also the<font color="#E5E5E5"> college it emit but</font>

228
00:13:21,370 --> 00:13:26,890
compromise<font color="#E5E5E5"> web servers how do they buy</font>

229
00:13:24,070 --> 00:13:29,950
these credentials well they run their

230
00:13:26,890 --> 00:13:32,050
own marketplace and they have over<font color="#CCCCCC"> 1600</font>

231
00:13:29,950 --> 00:13:34,480
sellers currently registered on their

232
00:13:32,050 --> 00:13:39,219
marketplace a lot<font color="#E5E5E5"> of these as we later</font>

233
00:13:34,480 --> 00:13:41,970
found out are just hackers interested

234
00:13:39,220 --> 00:13:47,010
but not really<font color="#E5E5E5"> selling there are about</font>

235
00:13:41,970 --> 00:13:50,650
<font color="#E5E5E5">150 sellers that actually made a sale on</font>

236
00:13:47,010 --> 00:13:54,069
in this marketplace selling them the

237
00:13:50,650 --> 00:13:58,180
credentials so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> how the market</font>

238
00:13:54,070 --> 00:14:00,430
place looks like AWS 0 ftp account sells

239
00:13:58,180 --> 00:14:05,260
for about half a dollar to two dollars

240
00:14:00,430 --> 00:14:09,189
per account smtp account sell for twenty

241
00:14:05,260 --> 00:14:11,860
fifty dollars per<font color="#CCCCCC"> 1000 account sse true</font>

242
00:14:09,190 --> 00:14:15,820
is twenty dollars for account and ssh

243
00:14:11,860 --> 00:14:18,360
user is five bucks<font color="#E5E5E5"> per account and here</font>

244
00:14:15,820 --> 00:14:21,790
you can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this is how you sell</font>

245
00:14:18,360 --> 00:14:25,060
web shells to them by web shells we mean

246
00:14:21,790 --> 00:14:29,020
PHP back doors that so if I'm if I'm a

247
00:14:25,060 --> 00:14:33,640
hacker I massively hack into<font color="#E5E5E5"> ah let's</font>

248
00:14:29,020 --> 00:14:36,250
say ah<font color="#E5E5E5"> 1000 WordPress sites and so on</font>

249
00:14:33,640 --> 00:14:38,949
these 1000 wordpress site i<font color="#E5E5E5"> have my wso</font>

250
00:14:36,250 --> 00:14:42,310
back door how do<font color="#E5E5E5"> i sell it</font><font color="#CCCCCC"> to these guys</font>

251
00:14:38,950 --> 00:14:44,620
you have to upload a text file that

252
00:14:42,310 --> 00:14:50,140
complies with your format and their

253
00:14:44,620 --> 00:14:54,760
format is very simple URL of the web

254
00:14:50,140 --> 00:14:56,380
shell<font color="#E5E5E5"> Colin and the password right so</font>

255
00:14:54,760 --> 00:15:00,400
for each line so and they have a script

256
00:14:56,380 --> 00:15:02,820
that validates this calculates uh and

257
00:15:00,400 --> 00:15:04,810
then goes and test the login and

258
00:15:02,820 --> 00:15:07,030
calculates how much money they want to

259
00:15:04,810 --> 00:15:09,339
pay<font color="#E5E5E5"> you so it's fully automated you</font>

260
00:15:07,030 --> 00:15:14,260
comply with this format you can go<font color="#E5E5E5"> and</font>

261
00:15:09,340 --> 00:15:16,810
you can sell<font color="#E5E5E5"> these to them and so from</font>

262
00:15:14,260 --> 00:15:20,080
<font color="#E5E5E5">what we saw in their database about 150</font>

263
00:15:16,810 --> 00:15:22,119
active sellers that actually do business

264
00:15:20,080 --> 00:15:24,310
with<font color="#CCCCCC"> them we were able to monitor them</font>

265
00:15:22,120 --> 00:15:25,600
for about nine months and over which

266
00:15:24,310 --> 00:15:29,349
time they so

267
00:15:25,600 --> 00:15:30,880
they spend 135,000 USD just purely on

268
00:15:29,350 --> 00:15:34,920
buying these<font color="#CCCCCC"> accounts so they do have</font>

269
00:15:30,880 --> 00:15:37,300
<font color="#E5E5E5">pretty good budget to buy arm so there's</font>

270
00:15:34,920 --> 00:15:41,290
significant business on in this

271
00:15:37,300 --> 00:15:43,689
marketplace they have a dashboard from

272
00:15:41,290 --> 00:15:47,170
everything<font color="#CCCCCC"> that they buy so good</font>

273
00:15:43,690 --> 00:15:53,589
bookkeeping good accounting on their

274
00:15:47,170 --> 00:15:56,290
behalf uh so we we dug into how these

275
00:15:53,589 --> 00:16:01,269
sellers are able to massively in fact so

276
00:15:56,290 --> 00:16:03,430
many websites and it turns out<font color="#CCCCCC"> that it's</font>

277
00:16:01,269 --> 00:16:07,360
mostly<font color="#E5E5E5"> through open source</font>

278
00:16:03,430 --> 00:16:14,319
vulnerabilities to arm wordpress and

279
00:16:07,360 --> 00:16:18,370
drupal joomla and e-commerce<font color="#E5E5E5"> open source</font>

280
00:16:14,319 --> 00:16:21,370
infrastructure so the sellers what they

281
00:16:18,370 --> 00:16:23,920
do is whenever for example<font color="#CCCCCC"> wordpress</font>

282
00:16:21,370 --> 00:16:26,380
comes out with a patch they would<font color="#E5E5E5"> go and</font>

283
00:16:23,920 --> 00:16:28,300
study that<font color="#CCCCCC"> pat an update they were going</font>

284
00:16:26,380 --> 00:16:31,029
<font color="#E5E5E5">to study that update and say oh so we're</font>

285
00:16:28,300 --> 00:16:34,000
<font color="#E5E5E5">wordpress patch this vulnerability and</font>

286
00:16:31,029 --> 00:16:36,519
so they'll write a script to massively

287
00:16:34,000 --> 00:16:39,699
scan or wordpress websites for whichever

288
00:16:36,519 --> 00:16:41,980
website that didn't patch on during<font color="#E5E5E5"> that</font>

289
00:16:39,699 --> 00:16:46,529
same day didn't upgrade within that same

290
00:16:41,980 --> 00:16:46,529
day and then just inject the web show

291
00:16:46,709 --> 00:16:56,709
<font color="#E5E5E5">okay so their URLs the URLs inside the</font>

292
00:16:52,389 --> 00:16:59,490
emails<font color="#E5E5E5"> that point to the the PHP script</font>

293
00:16:56,709 --> 00:17:02,500
that they inject so once they have these

294
00:16:59,490 --> 00:17:05,890
wso<font color="#E5E5E5"> shells they will inject</font><font color="#CCCCCC"> the ASP</font>

295
00:17:02,500 --> 00:17:10,510
rocks PHP script into these websites

296
00:17:05,890 --> 00:17:13,270
right and the URLs or personalized<font color="#E5E5E5"> URLs</font>

297
00:17:10,510 --> 00:17:17,709
that's embedded inside emails that

298
00:17:13,270 --> 00:17:20,439
points to these injected PHP they

299
00:17:17,709 --> 00:17:21,850
frequently change PHP file names that

300
00:17:20,439 --> 00:17:25,780
they upload to these legitimate

301
00:17:21,849 --> 00:17:30,520
legitimate websites they are few skate

302
00:17:25,780 --> 00:17:35,200
and pack malware daily on their malware

303
00:17:30,520 --> 00:17:38,500
is the ultimate zip file that a visitor

304
00:17:35,200 --> 00:17:39,490
is prompted to download if all of the

305
00:17:38,500 --> 00:17:46,660
scripts were happy

306
00:17:39,490 --> 00:17:48,070
II with the visitor um and<font color="#CCCCCC"> they do a</font><font color="#E5E5E5"> lot</font>

307
00:17:46,660 --> 00:17:50,590
of checks for example of this check

308
00:17:48,070 --> 00:17:53,260
tricks if you're trying<font color="#E5E5E5"> if a single IP</font>

309
00:17:50,590 --> 00:17:58,330
tries to download file more than<font color="#E5E5E5"> five</font>

310
00:17:53,260 --> 00:18:02,290
times and<font color="#E5E5E5"> they reject it and this is</font>

311
00:17:58,330 --> 00:18:06,189
there this is<font color="#CCCCCC"> there PHP code um so as</font>

312
00:18:02,290 --> 00:18:09,159
you<font color="#CCCCCC"> can see they they threw out a 404</font>

313
00:18:06,190 --> 00:18:11,440
response page if they're<font color="#E5E5E5"> not happy with</font>

314
00:18:09,160 --> 00:18:15,000
the URL so for example if<font color="#E5E5E5"> the URLs been</font>

315
00:18:11,440 --> 00:18:18,940
tampered and because<font color="#E5E5E5"> this is on a</font>

316
00:18:15,000 --> 00:18:21,370
customized 404 page they wrote this code

317
00:18:18,940 --> 00:18:23,950
themselves and that's<font color="#E5E5E5"> why if you know</font>

318
00:18:21,370 --> 00:18:26,439
the code and for<font color="#E5E5E5"> us security vendors</font>

319
00:18:23,950 --> 00:18:32,980
when we get an HTTP response that looks

320
00:18:26,440 --> 00:18:37,780
like this we know<font color="#CCCCCC"> it's ass prox um and</font>

321
00:18:32,980 --> 00:18:41,200
um and very interestingly so so these

322
00:18:37,780 --> 00:18:43,330
are legitimate legitimate web servers

323
00:18:41,200 --> 00:18:47,140
right<font color="#CCCCCC"> and they're injecting PHP into it</font>

324
00:18:43,330 --> 00:18:49,780
so<font color="#E5E5E5"> sometimes the admin will discover</font>

325
00:18:47,140 --> 00:18:53,230
that<font color="#E5E5E5"> there's their website has rejected</font>

326
00:18:49,780 --> 00:18:56,139
with a piece of PHP code and so when the

327
00:18:53,230 --> 00:18:59,220
web's when the web admins find this file

328
00:18:56,140 --> 00:19:01,900
and they open it up they will see an IP

329
00:18:59,220 --> 00:19:04,240
right and you'll tend<font color="#E5E5E5"> to think that that</font>

330
00:19:01,900 --> 00:19:07,840
IP is the Ashcroft's I'd people that's a

331
00:19:04,240 --> 00:19:10,690
decoy IP it sits there it has no use

332
00:19:07,840 --> 00:19:12,159
it's there just to fake the<font color="#E5E5E5"> I so if you</font>

333
00:19:10,690 --> 00:19:14,650
<font color="#E5E5E5">look at it you sell here's the IP</font>

334
00:19:12,160 --> 00:19:16,570
address this must be the attacker what's

335
00:19:14,650 --> 00:19:19,630
the IP in China<font color="#E5E5E5"> that has nothing to do</font>

336
00:19:16,570 --> 00:19:21,520
with them um the real IP that their

337
00:19:19,630 --> 00:19:25,120
direct that they're redirecting the

338
00:19:21,520 --> 00:19:27,190
visitor to has to be decrypted and the

339
00:19:25,120 --> 00:19:29,020
decryption code is down there so you

340
00:19:27,190 --> 00:19:31,720
actually have<font color="#E5E5E5"> to go to a decryption</font>

341
00:19:29,020 --> 00:19:37,110
process to to know where they're

342
00:19:31,720 --> 00:19:41,730
directing<font color="#E5E5E5"> YouTube it's a simple xor ah</font>

343
00:19:37,110 --> 00:19:41,729
and it decodes to something like<font color="#E5E5E5"> this</font>

344
00:19:41,770 --> 00:19:48,310
and um the personalized URL is

345
00:19:45,370 --> 00:19:51,550
interesting because within every email

346
00:19:48,310 --> 00:19:55,899
right there is a different URL but this

347
00:19:51,550 --> 00:19:58,930
URL contains a<font color="#CCCCCC"> uuid that if you know the</font>

348
00:19:55,900 --> 00:20:02,620
algorithm and it's encrypted in base64

349
00:19:58,930 --> 00:20:04,690
and<font color="#CCCCCC"> AES but if you know their key and</font>

350
00:20:02,620 --> 00:20:08,379
you know the algorithm you decode it

351
00:20:04,690 --> 00:20:12,910
back then what you get out of<font color="#E5E5E5"> that uuid</font>

352
00:20:08,380 --> 00:20:15,430
is is the sender ID so which bot or

353
00:20:12,910 --> 00:20:20,830
compromised web server sent that email

354
00:20:15,430 --> 00:20:23,890
or the<font color="#E5E5E5"> URL ID the database ID so the</font>

355
00:20:20,830 --> 00:20:30,189
which database does the recipient email

356
00:20:23,890 --> 00:20:32,050
reside in and also<font color="#E5E5E5"> the mail ID</font><font color="#CCCCCC"> okay and</font>

357
00:20:30,190 --> 00:20:34,600
so it's very<font color="#CCCCCC"> useful when</font><font color="#E5E5E5"> you're studying</font>

358
00:20:32,050 --> 00:20:40,419
this group because that uuid actually

359
00:20:34,600 --> 00:20:45,280
contains all<font color="#CCCCCC"> of this information and if</font>

360
00:20:40,420 --> 00:20:47,950
the PHP script is happy with all of the

361
00:20:45,280 --> 00:20:50,490
attributes it will redirect you to their

362
00:20:47,950 --> 00:20:55,870
own tds server and this is how the

363
00:20:50,490 --> 00:20:57,520
reader redirected URL looks like um and

364
00:20:55,870 --> 00:21:01,179
within it there are several parameters

365
00:20:57,520 --> 00:21:04,960
the users IP the landing<font color="#E5E5E5"> file path the</font>

366
00:21:01,180 --> 00:21:11,070
victims uuid propagate it over and the

367
00:21:04,960 --> 00:21:17,080
user agent and then the tds since 20 14

368
00:21:11,070 --> 00:21:19,450
q3 the<font color="#E5E5E5"> tds other than validating if</font><font color="#CCCCCC"> if</font>

369
00:21:17,080 --> 00:21:22,149
the<font color="#E5E5E5"> IP is good if the geolocation is</font>

370
00:21:19,450 --> 00:21:24,640
good it will also use the user agent if

371
00:21:22,150 --> 00:21:26,140
you're coming from windows look it will

372
00:21:24,640 --> 00:21:28,600
give you a windows zip file to download

373
00:21:26,140 --> 00:21:30,820
if you're coming from<font color="#CCCCCC"> android it will</font>

374
00:21:28,600 --> 00:21:32,439
give you an APK to download and that's

375
00:21:30,820 --> 00:21:39,460
why they're<font color="#E5E5E5"> having a user agent string</font>

376
00:21:32,440 --> 00:21:42,480
there ah ok so the tds itself the

377
00:21:39,460 --> 00:21:46,110
tedious server generate a zip file arm

378
00:21:42,480 --> 00:21:49,780
log the victim data include IP and uuid

379
00:21:46,110 --> 00:21:52,510
<font color="#CCCCCC">being wanted user downloads based on</font>

380
00:21:49,780 --> 00:21:55,680
blacklist so they have a big big list of

381
00:21:52,510 --> 00:21:55,680
security vendor<font color="#E5E5E5"> eyepiece</font>

382
00:21:55,789 --> 00:21:59,749
some they were vulnerable to direct this

383
00:21:58,129 --> 00:22:04,119
<font color="#CCCCCC">teen</font><font color="#E5E5E5"> that's how we're able to study them</font>

384
00:21:59,749 --> 00:22:06,710
they fixed it in the end of 20 14 and

385
00:22:04,119 --> 00:22:11,408
they have this alert feature that

386
00:22:06,710 --> 00:22:14,690
notifies themselves through<font color="#E5E5E5"> jabber of</font>

387
00:22:11,409 --> 00:22:16,820
snooping security researchers so if you

388
00:22:14,690 --> 00:22:19,039
use the single IP you keep on hitting

389
00:22:16,820 --> 00:22:20,869
them they'll actually get notified

390
00:22:19,039 --> 00:22:22,820
through their jabber account that hey

391
00:22:20,869 --> 00:22:28,779
this IP is probably a security

392
00:22:22,820 --> 00:22:31,389
researcher is trying to probe us and

393
00:22:28,779 --> 00:22:36,429
that's your<font color="#E5E5E5"> code we got their code of</font>

394
00:22:31,389 --> 00:22:41,359
<font color="#E5E5E5">how they're leveraging jabber to do this</font>

395
00:22:36,429 --> 00:22:44,539
on their tds server change IP<font color="#E5E5E5"> six times</font>

396
00:22:41,359 --> 00:22:47,749
and the URL path four times in<font color="#E5E5E5"> the past</font>

397
00:22:44,539 --> 00:22:55,820
21 months so they don't change<font color="#E5E5E5"> the tds</font>

398
00:22:47,749 --> 00:22:58,070
IP a lot actually they have for actual

399
00:22:55,820 --> 00:23:00,678
and when you're infected the<font color="#CCCCCC"> Maverick</font>

400
00:22:58,070 --> 00:23:04,700
connects back to the sea to server

401
00:23:00,679 --> 00:23:07,999
through a layer of reverse proxies and

402
00:23:04,700 --> 00:23:10,759
<font color="#CCCCCC">Jenks reverse proxies and they actually</font>

403
00:23:07,999 --> 00:23:15,169
total we saw a total of four see two

404
00:23:10,759 --> 00:23:18,979
servers overall so only<font color="#CCCCCC"> four unique IPS</font>

405
00:23:15,169 --> 00:23:21,769
that<font color="#E5E5E5"> we saw and spreading about five</font>

406
00:23:18,979 --> 00:23:23,599
different<font color="#E5E5E5"> malware families and all of</font>

407
00:23:21,769 --> 00:23:30,919
these are located in<font color="#E5E5E5"> Russia or Ukraine</font>

408
00:23:23,599 --> 00:23:34,460
ah they use njic space reverse reverse

409
00:23:30,919 --> 00:23:38,720
proxies to hide<font color="#E5E5E5"> these eyepiece and they</font>

410
00:23:34,460 --> 00:23:42,559
also took some steps<font color="#CCCCCC"> to make sure</font><font color="#E5E5E5"> that</font>

411
00:23:38,720 --> 00:23:45,289
when these reverse IPS are found out and

412
00:23:42,559 --> 00:23:48,619
somebody goes in and look look at the

413
00:23:45,289 --> 00:23:50,629
engine servers that you cannot tell by

414
00:23:48,619 --> 00:23:54,259
the config file of the engine servers

415
00:23:50,629 --> 00:23:56,928
where<font color="#E5E5E5"> their real IP is and and they have</font>

416
00:23:54,259 --> 00:23:59,359
these decoy eyepiece so what they do is

417
00:23:56,929 --> 00:24:06,049
when they start these enging servers oh

418
00:23:59,359 --> 00:24:09,679
uh one theme first so one characteristic

419
00:24:06,049 --> 00:24:13,310
is if you look at their log files the

420
00:24:09,680 --> 00:24:14,930
a swap airlock and access log so that's

421
00:24:13,310 --> 00:24:17,139
<font color="#E5E5E5">one characteristics we don't know why</font>

422
00:24:14,930 --> 00:24:20,570
they do it but<font color="#E5E5E5"> in their configuration</font>

423
00:24:17,140 --> 00:24:22,700
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> non-typical their errors are locked</font>

424
00:24:20,570 --> 00:24:25,280
in access the lock and access is locked

425
00:24:22,700 --> 00:24:28,850
in area that lock now this<font color="#CCCCCC"> is how they</font>

426
00:24:25,280 --> 00:24:31,430
decoy they have the actual configuration

427
00:24:28,850 --> 00:24:34,100
file when they when they start the

428
00:24:31,430 --> 00:24:35,990
engine servers and if you look<font color="#CCCCCC"> at their</font>

429
00:24:34,100 --> 00:24:38,449
script right after they start the end

430
00:24:35,990 --> 00:24:41,000
drink servers they then delete that

431
00:24:38,450 --> 00:24:47,090
configuration file regenerate a

432
00:24:41,000 --> 00:24:49,970
configuration file with a decoy IP so if

433
00:24:47,090 --> 00:24:52,850
when we<font color="#E5E5E5"> go in let's say there's a</font>

434
00:24:49,970 --> 00:24:55,340
there's a server that's<font color="#E5E5E5"> compromised and</font>

435
00:24:52,850 --> 00:24:58,490
that's been used to ask their reverse

436
00:24:55,340 --> 00:25:00,709
proxy shield now we go in<font color="#CCCCCC"> and we look at</font>

437
00:24:58,490 --> 00:25:03,890
the configuration file will see a

438
00:25:00,710 --> 00:25:06,620
configuration file with a decoy IP that

439
00:25:03,890 --> 00:25:10,220
<font color="#E5E5E5">was generated after the engines proxy</font>

440
00:25:06,620 --> 00:25:20,209
has been launched after they start that

441
00:25:10,220 --> 00:25:23,030
process and um one way they monitor they

442
00:25:20,210 --> 00:25:25,700
they install these<font color="#E5E5E5"> BOTS right they used</font>

443
00:25:23,030 --> 00:25:29,450
to install these a sprog spots another

444
00:25:25,700 --> 00:25:32,600
way that they monetize is as<font color="#CCCCCC"> rocks later</font>

445
00:25:29,450 --> 00:25:35,480
Kim with euro viewer DOL and these they

446
00:25:32,600 --> 00:25:37,520
ll drive impressions so it's kind of

447
00:25:35,480 --> 00:25:39,980
<font color="#E5E5E5">like selling ass so when the browser</font>

448
00:25:37,520 --> 00:25:41,629
opens it will open<font color="#CCCCCC"> a new</font><font color="#E5E5E5"> tab and it will</font>

449
00:25:39,980 --> 00:25:45,020
load some web page that's paying them

450
00:25:41,630 --> 00:25:49,700
money and there they<font color="#CCCCCC"> get paid per</font>

451
00:25:45,020 --> 00:25:53,000
impression and this bot has its own

452
00:25:49,700 --> 00:25:55,880
command and control that's telling the

453
00:25:53,000 --> 00:25:59,630
<font color="#E5E5E5">bot which impressions</font><font color="#CCCCCC"> to load which a</font>

454
00:25:55,880 --> 00:26:05,480
web page to load and we found about

455
00:25:59,630 --> 00:26:08,020
32,000 BOTS and 167 tasks and the tasks

456
00:26:05,480 --> 00:26:13,660
are telling the boss which page to load

457
00:26:08,020 --> 00:26:18,980
and so<font color="#E5E5E5"> that's a different c2 server and</font>

458
00:26:13,660 --> 00:26:20,960
and and this server is different it's

459
00:26:18,980 --> 00:26:24,400
basically<font color="#E5E5E5"> telling the bots to load</font>

460
00:26:20,960 --> 00:26:30,350
whichever page that's paying them

461
00:26:24,400 --> 00:26:33,110
and starting from jun 20 14 we saw that

462
00:26:30,350 --> 00:26:36,770
they started to try on<font color="#CCCCCC"> android malware</font>

463
00:26:33,110 --> 00:26:39,469
and they did have some success so it

464
00:26:36,770 --> 00:26:42,260
used to be just<font color="#CCCCCC"> dip downloads and you</font>

465
00:26:39,470 --> 00:26:48,530
can see from 20 14 jun they started to

466
00:26:42,260 --> 00:26:52,820
have apks the APK support these five

467
00:26:48,530 --> 00:26:57,920
plugins steal device info get device

468
00:26:52,820 --> 00:27:04,970
contacts get your SMS get your<font color="#CCCCCC"> gps</font>

469
00:26:57,920 --> 00:27:06,410
location and record your calls during

470
00:27:04,970 --> 00:27:08,630
the four months that were able<font color="#CCCCCC"> to</font>

471
00:27:06,410 --> 00:27:11,960
monitor their android barnet we saw a

472
00:27:08,630 --> 00:27:14,840
total of five thousand or so android

473
00:27:11,960 --> 00:27:18,490
infections and this was when they first

474
00:27:14,840 --> 00:27:23,600
started<font color="#CCCCCC"> to experience with</font><font color="#E5E5E5"> android and</font>

475
00:27:18,490 --> 00:27:27,410
this was their their<font color="#E5E5E5"> android command and</font>

476
00:27:23,600 --> 00:27:30,500
control panel the interesting thing is

477
00:27:27,410 --> 00:27:33,830
<font color="#E5E5E5">click to a final conversion rate is 5.5</font>

478
00:27:30,500 --> 00:27:37,720
percent which is pretty high so starting

479
00:27:33,830 --> 00:27:41,419
from a click to uh if somebody clicks

480
00:27:37,720 --> 00:27:43,880
then five out of<font color="#E5E5E5"> hundred people click</font>

481
00:27:41,420 --> 00:27:50,360
actually get infected which from our

482
00:27:43,880 --> 00:27:52,820
experience is pretty high um and you can

483
00:27:50,360 --> 00:27:56,000
see you<font color="#CCCCCC"> can see for example on the lower</font>

484
00:27:52,820 --> 00:27:58,040
right corner are there once you get

485
00:27:56,000 --> 00:27:59,990
infected all of your SMS gets

486
00:27:58,040 --> 00:28:02,120
automatically sent to the server<font color="#E5E5E5"> and</font>

487
00:27:59,990 --> 00:28:04,250
they're displaying for every device if

488
00:28:02,120 --> 00:28:06,919
you<font color="#E5E5E5"> click if you click</font><font color="#CCCCCC"> on any of these</font>

489
00:28:04,250 --> 00:28:10,760
devices you get to<font color="#E5E5E5"> this screen were you</font>

490
00:28:06,920 --> 00:28:13,880
able to<font color="#E5E5E5"> see on their last three SMS you</font>

491
00:28:10,760 --> 00:28:16,790
can click for more arm and all of the

492
00:28:13,880 --> 00:28:23,660
modules that that is<font color="#E5E5E5"> running things like</font>

493
00:28:16,790 --> 00:28:26,510
that their<font color="#CCCCCC"> android see-through server is</font>

494
00:28:23,660 --> 00:28:29,660
also shielded by a layer of engines

495
00:28:26,510 --> 00:28:31,520
proxies just like their windows except

496
00:28:29,660 --> 00:28:33,890
they only have one see to server for

497
00:28:31,520 --> 00:28:36,920
their<font color="#CCCCCC"> android and their shielding it at</font>

498
00:28:33,890 --> 00:28:37,430
the time we<font color="#CCCCCC"> were studying them about nye</font>

499
00:28:36,920 --> 00:28:41,900
engine

500
00:28:37,430 --> 00:28:44,810
servers data stolen during<font color="#E5E5E5"> the four</font>

501
00:28:41,900 --> 00:28:49,430
months that we monitored them are seven

502
00:28:44,810 --> 00:28:52,520
a seven hundred<font color="#CCCCCC"> fifty two thousand</font>

503
00:28:49,430 --> 00:28:55,430
contacts more than a million SMS

504
00:28:52,520 --> 00:29:03,860
messages about a thousand location list

505
00:28:55,430 --> 00:29:07,850
and about 20,000 email addresses 60,000

506
00:29:03,860 --> 00:29:11,360
physical addresses 650,000 phone numbers

507
00:29:07,850 --> 00:29:15,830
and the phone numbers are important

508
00:29:11,360 --> 00:29:18,379
because they also started to SMS these

509
00:29:15,830 --> 00:29:20,780
phone numbers to further spread so

510
00:29:18,380 --> 00:29:23,150
rather<font color="#E5E5E5"> than</font><font color="#CCCCCC"> use email they also use them</font>

511
00:29:20,780 --> 00:29:26,360
SMS so that's why they need the phone

512
00:29:23,150 --> 00:29:30,830
numbers they love to steal all<font color="#CCCCCC"> of the</font>

513
00:29:26,360 --> 00:29:33,860
SMS messages and then they started to

514
00:29:30,830 --> 00:29:39,710
run a android bought rental service

515
00:29:33,860 --> 00:29:43,879
which<font color="#CCCCCC"> is you can actually query by by</font>

516
00:29:39,710 --> 00:29:49,130
place by city by operator so for<font color="#CCCCCC"> example</font>

517
00:29:43,880 --> 00:29:52,840
if<font color="#CCCCCC"> I want ah to</font><font color="#E5E5E5"> have a an Android to get</font>

518
00:29:49,130 --> 00:29:55,870
to have a control of an<font color="#E5E5E5"> Android device</font>

519
00:29:52,840 --> 00:29:59,060
here in Luxembourg I can query the

520
00:29:55,870 --> 00:30:02,179
region or the city Luxembourg and<font color="#E5E5E5"> I'll</font>

521
00:29:59,060 --> 00:30:05,360
get a list of infected devices and I can

522
00:30:02,180 --> 00:30:09,140
rent that device so then then i can ask

523
00:30:05,360 --> 00:30:13,429
<font color="#E5E5E5">that android device to send out SMS or</font>

524
00:30:09,140 --> 00:30:15,230
to do things for me so so they started

525
00:30:13,430 --> 00:30:20,240
to do it<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> it's 20 bucks an</font>

526
00:30:15,230 --> 00:30:23,720
hour the rental service click statistics

527
00:30:20,240 --> 00:30:27,520
um within the four months that we're

528
00:30:23,720 --> 00:30:31,840
able to study them you can see that the

529
00:30:27,520 --> 00:30:35,960
<font color="#CCCCCC">red ones are the blacklist it clicks and</font>

530
00:30:31,840 --> 00:30:38,810
the blue ones are the good clicks so as

531
00:30:35,960 --> 00:30:41,720
you<font color="#E5E5E5"> can see on Windows almost half of</font>

532
00:30:38,810 --> 00:30:43,879
the clicks are blocked they do not serve

533
00:30:41,720 --> 00:30:46,130
to half of the clip they don't like half

534
00:30:43,880 --> 00:30:49,340
of the clicks we believe this<font color="#E5E5E5"> is</font>

535
00:30:46,130 --> 00:30:51,340
probably because like for us<font color="#E5E5E5"> for poo</font>

536
00:30:49,340 --> 00:30:54,699
point every single

537
00:30:51,340 --> 00:30:57,459
<font color="#E5E5E5">male we skin with our sandbox right and</font>

538
00:30:54,700 --> 00:31:01,180
sometimes<font color="#E5E5E5"> we do get blocked and so if</font>

539
00:30:57,460 --> 00:31:03,730
<font color="#CCCCCC">you have</font><font color="#E5E5E5"> different security vendors you</font>

540
00:31:01,180 --> 00:31:05,770
have proof point you have Palo Alto you

541
00:31:03,730 --> 00:31:07,930
have fire I then actually when an email

542
00:31:05,770 --> 00:31:10,510
<font color="#E5E5E5">comes in a lot of security vendors go</font>

543
00:31:07,930 --> 00:31:13,810
skin that URL and some do get blocked

544
00:31:10,510 --> 00:31:16,480
and that's why I we think about half of

545
00:31:13,810 --> 00:31:19,330
the clicks get blocked according<font color="#CCCCCC"> to</font>

546
00:31:16,480 --> 00:31:22,090
their loss I'll<font color="#E5E5E5"> Android much less and</font>

547
00:31:19,330 --> 00:31:25,360
this may be because less researchers at

548
00:31:22,090 --> 00:31:30,850
that time<font color="#CCCCCC"> had android sandboxing or were</font>

549
00:31:25,360 --> 00:31:37,719
on using<font color="#CCCCCC"> android</font><font color="#E5E5E5"> VMs to study them so</font>

550
00:31:30,850 --> 00:31:39,429
much less blocked for for<font color="#CCCCCC"> Android click</font>

551
00:31:37,720 --> 00:31:44,560
the<font color="#CCCCCC"> Geo distribution they're very</font>

552
00:31:39,430 --> 00:31:47,980
targeted on so they they have specific

553
00:31:44,560 --> 00:31:51,370
databases for every region and they do

554
00:31:47,980 --> 00:31:55,060
not infect I think the only<font color="#E5E5E5"> infect no</font>

555
00:31:51,370 --> 00:31:57,310
more than two dozen regions so also<font color="#E5E5E5"> from</font>

556
00:31:55,060 --> 00:32:00,360
their logs you can this reflects where

557
00:31:57,310 --> 00:32:03,129
they're<font color="#E5E5E5"> infecting where there are</font>

558
00:32:00,360 --> 00:32:08,889
malware the down the malware downloads

559
00:32:03,130 --> 00:32:11,200
happen actually<font color="#CCCCCC"> not a lot their</font>

560
00:32:08,890 --> 00:32:16,060
strategies change we believe that<font color="#CCCCCC"> a</font>

561
00:32:11,200 --> 00:32:20,440
certain<font color="#E5E5E5"> investigation bureau took action</font>

562
00:32:16,060 --> 00:32:23,830
against<font color="#E5E5E5"> this group end of 20 15 and so</font>

563
00:32:20,440 --> 00:32:25,900
<font color="#E5E5E5">all of a sudden they disappeared but</font>

564
00:32:23,830 --> 00:32:30,639
<font color="#E5E5E5">actually they didn't disappear they</font>

565
00:32:25,900 --> 00:32:34,620
sharply stopped to spread any ass rocks

566
00:32:30,640 --> 00:32:37,570
are malware either on<font color="#CCCCCC"> Windows or on</font>

567
00:32:34,620 --> 00:32:40,810
<font color="#CCCCCC">Android he just stopped but the groove</font>

568
00:32:37,570 --> 00:32:43,720
didn't stop they<font color="#E5E5E5"> started to try for</font>

569
00:32:40,810 --> 00:32:46,210
alternative ways to make revenue the

570
00:32:43,720 --> 00:32:50,140
first thing they tried was the porn and

571
00:32:46,210 --> 00:32:52,420
weight loss schemes so they started to

572
00:32:50,140 --> 00:32:55,210
test out whether scams can make them

573
00:32:52,420 --> 00:32:58,150
<font color="#E5E5E5">money on but all</font><font color="#CCCCCC"> of a sudden they seized</font>

574
00:32:55,210 --> 00:33:02,470
the operation on building botnets but

575
00:32:58,150 --> 00:33:05,380
they still actively a acquire<font color="#CCCCCC"> compra of</font>

576
00:33:02,470 --> 00:33:11,500
purchase compromised websites

577
00:33:05,380 --> 00:33:15,700
choose to spam<font color="#CCCCCC"> LT schemes what they</font>

578
00:33:11,500 --> 00:33:18,850
figured out would work is a fraudulent

579
00:33:15,700 --> 00:33:23,020
dating sites so they wrote these chat

580
00:33:18,850 --> 00:33:26,260
BOTS themselves and so they built these

581
00:33:23,020 --> 00:33:28,300
these dating sites and if you pay them a

582
00:33:26,260 --> 00:33:31,360
fee you can chat with ladies but these

583
00:33:28,300 --> 00:33:33,610
are the boss that they wrote<font color="#CCCCCC"> ok so then</font>

584
00:33:31,360 --> 00:33:36,070
the ass<font color="#E5E5E5"> profs malware guys now run</font>

585
00:33:33,610 --> 00:33:38,770
dating<font color="#E5E5E5"> sites and they</font><font color="#CCCCCC"> have not</font>

586
00:33:36,070 --> 00:33:43,330
disappeared guys so this<font color="#E5E5E5"> is what they do</font>

587
00:33:38,770 --> 00:33:45,790
now they in order to prove that<font color="#E5E5E5"> you're</font>

588
00:33:43,330 --> 00:33:47,110
over 18 you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to verify your age to</font>

589
00:33:45,790 --> 00:33:49,690
verify<font color="#CCCCCC"> your age you have to give</font><font color="#E5E5E5"> them</font>

590
00:33:47,110 --> 00:33:53,260
your credit card that's one way to make

591
00:33:49,690 --> 00:33:56,980
money and there's a VIP membership

592
00:33:53,260 --> 00:33:59,850
charge a subscription auto we alter

593
00:33:56,980 --> 00:34:03,400
monthly renewed subscription<font color="#CCCCCC"> cells for</font>

594
00:33:59,850 --> 00:34:09,850
118 bucks to get you to talk to<font color="#E5E5E5"> their</font>

595
00:34:03,400 --> 00:34:13,179
robots so they are<font color="#CCCCCC"> not dead and they're</font>

596
00:34:09,850 --> 00:34:17,110
probably making good money from what we

597
00:34:13,179 --> 00:34:21,190
can see<font color="#E5E5E5"> and so they still a lot of</font>

598
00:34:17,110 --> 00:34:24,220
assets wsl web shows today by unique

599
00:34:21,190 --> 00:34:26,350
domains more than<font color="#E5E5E5"> 3 million out of which</font>

600
00:34:24,219 --> 00:34:30,158
we have some government and some

601
00:34:26,350 --> 00:34:35,049
military ones by web shells by unique

602
00:34:30,159 --> 00:34:38,169
<font color="#CCCCCC">file name almost eight million ftp</font>

603
00:34:35,050 --> 00:34:41,649
accounts half a million<font color="#CCCCCC"> ssh root access</font>

604
00:34:38,168 --> 00:34:46,929
a thousand or so as the<font color="#E5E5E5"> search users</font>

605
00:34:41,649 --> 00:34:50,319
50,000 conclusion um it's hard to track

606
00:34:46,929 --> 00:34:52,870
this group because they use a lot of

607
00:34:50,320 --> 00:34:56,370
decoy techniques and they shield their

608
00:34:52,870 --> 00:34:59,529
command-and-control they run their own

609
00:34:56,370 --> 00:35:01,660
market they have good budget to pay so

610
00:34:59,530 --> 00:35:04,480
they keep on acquiring new assets and

611
00:35:01,660 --> 00:35:08,109
building these up not by hacking but by

612
00:35:04,480 --> 00:35:11,100
buying them<font color="#CCCCCC"> uh they change strategy from</font>

613
00:35:08,110 --> 00:35:14,560
malware campaigns now to email scams

614
00:35:11,100 --> 00:35:16,089
mass answer just from the asset that

615
00:35:14,560 --> 00:35:18,130
they're able to buy from this

616
00:35:16,090 --> 00:35:19,150
underground market we do believe<font color="#E5E5E5"> that</font>

617
00:35:18,130 --> 00:35:21,819
<font color="#CCCCCC">maskell</font>

618
00:35:19,150 --> 00:35:24,549
web server<font color="#E5E5E5"> compromised through open</font>

619
00:35:21,819 --> 00:35:30,069
<font color="#E5E5E5">source vulnerabilities is still very</font>

620
00:35:24,549 --> 00:35:32,950
prevalent and remains widely used thats

621
00:35:30,069 --> 00:35:39,339
it for our talk today<font color="#CCCCCC"> I do we have time</font>

622
00:35:32,950 --> 00:35:48,308
<font color="#E5E5E5">for questions thank you we do have eight</font>

623
00:35:39,339 --> 00:35:53,069
minutes hi I mean how did<font color="#E5E5E5"> you get the</font>

624
00:35:48,309 --> 00:35:58,180
exact numbers of their assets yeah so

625
00:35:53,069 --> 00:36:01,829
these attackers usually when we start

626
00:35:58,180 --> 00:36:04,569
usually these attackers have a lot of

627
00:36:01,829 --> 00:36:08,460
misconfigured servers open directory

628
00:36:04,569 --> 00:36:11,770
access<font color="#CCCCCC"> a vulnerable open source software</font>

629
00:36:08,460 --> 00:36:16,180
so that allows<font color="#CCCCCC"> us to get access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> all</font>

630
00:36:11,770 --> 00:36:18,339
their databases and of course as as we

631
00:36:16,180 --> 00:36:21,640
start<font color="#CCCCCC"> to disclose them they will harden</font>

632
00:36:18,339 --> 00:36:23,558
these infrastructure up on and so we

633
00:36:21,640 --> 00:36:26,470
usually when we start to talk<font color="#CCCCCC"> about them</font>

634
00:36:23,559 --> 00:36:29,440
we lose access so you<font color="#E5E5E5"> will usually</font>

635
00:36:26,470 --> 00:36:31,868
monitor them for a time before<font color="#E5E5E5"> we start</font>

636
00:36:29,440 --> 00:36:33,960
to publish them yeah it's it's it's

637
00:36:31,869 --> 00:36:36,960
through miss configuration and

638
00:36:33,960 --> 00:36:36,960
vulnerabilities

639
00:36:43,420 --> 00:36:52,089
no further questions so you are

640
00:36:49,660 --> 00:36:56,980
<font color="#E5E5E5">basically taking the hackers do they</font>

641
00:36:52,089 --> 00:37:02,160
heck back to you um we try not<font color="#CCCCCC"> to let</font>

642
00:36:56,980 --> 00:37:04,510
them usually usually they know us some

643
00:37:02,160 --> 00:37:07,420
they know all<font color="#E5E5E5"> of the security vendors</font>

644
00:37:04,510 --> 00:37:09,339
very well because their command and

645
00:37:07,420 --> 00:37:12,790
control panel if you see their loss

646
00:37:09,339 --> 00:37:16,359
right half of like they would launch a

647
00:37:12,790 --> 00:37:19,930
campaign and you would see who you would

648
00:37:16,359 --> 00:37:24,040
see immediately tons of clicks all from

649
00:37:19,930 --> 00:37:26,859
similar IPS right us<font color="#CCCCCC"> Palo Alto just</font>

650
00:37:24,040 --> 00:37:31,420
security vendors so they<font color="#E5E5E5"> just know the</font>

651
00:37:26,859 --> 00:37:33,640
security vendors very well um and we try

652
00:37:31,420 --> 00:37:36,460
not not to let them know<font color="#E5E5E5"> that we're</font>

653
00:37:33,640 --> 00:37:41,650
studying them so we we anonymize our

654
00:37:36,460 --> 00:37:43,540
ip's when and and also not<font color="#CCCCCC"> only when we</font>

655
00:37:41,650 --> 00:37:47,109
research them but also when we try to

656
00:37:43,540 --> 00:37:49,299
scan them otherwise we wouldn't know

657
00:37:47,109 --> 00:37:52,119
that<font color="#CCCCCC"> it's ass prox but if they recognize</font>

658
00:37:49,299 --> 00:37:53,259
our IP we wouldn't get the malware so we

659
00:37:52,119 --> 00:37:55,630
<font color="#E5E5E5">don't know what malware they're</font>

660
00:37:53,260 --> 00:37:58,619
spreading you want to<font color="#E5E5E5"> know that so</font>

661
00:37:55,630 --> 00:38:01,359
actually<font color="#CCCCCC"> for security vendors today IP</font>

662
00:37:58,619 --> 00:38:07,960
anonymization is that is the big<font color="#E5E5E5"> thing</font>

663
00:38:01,359 --> 00:38:10,170
that<font color="#CCCCCC"> we have to</font><font color="#E5E5E5"> do well yeah one</font><font color="#CCCCCC"> last</font>

664
00:38:07,960 --> 00:38:10,170
question

665
00:38:17,530 --> 00:38:22,220
you mentioned a number<font color="#CCCCCC"> of notable</font>

666
00:38:20,059 --> 00:38:23,990
victims have you done any work in

667
00:38:22,220 --> 00:38:30,109
notifying victims especially with so

668
00:38:23,990 --> 00:38:31,970
many out there so we have a division at

669
00:38:30,109 --> 00:38:36,109
pro point that works with the

670
00:38:31,970 --> 00:38:38,419
investigation bureaus um and yes so we

671
00:38:36,109 --> 00:38:43,089
regularly just provide them with the

672
00:38:38,420 --> 00:38:46,460
Intel that we have so<font color="#CCCCCC"> we don't directly</font>

673
00:38:43,089 --> 00:38:50,299
notify them or participate in the

674
00:38:46,460 --> 00:38:52,609
takedowns ah but these barrows work with

675
00:38:50,300 --> 00:38:55,220
uh there there quite a few takedown

676
00:38:52,609 --> 00:38:59,779
vendors that do this and they do this

677
00:38:55,220 --> 00:39:02,990
professionally so so that<font color="#E5E5E5"> that's how the</font>

678
00:38:59,780 --> 00:39:05,270
process works we we hand the<font color="#E5E5E5"> Intel over</font>

679
00:39:02,990 --> 00:39:13,430
and I believe what those guys do is they

680
00:39:05,270 --> 00:39:16,190
work with the takedown vendors yeah<font color="#CCCCCC"> all</font>

681
00:39:13,430 --> 00:39:18,049
<font color="#CCCCCC">right well thank you a lot it's not the</font>

682
00:39:16,190 --> 00:39:21,410
<font color="#E5E5E5">first time we see someone at hag Lou</font>

683
00:39:18,050 --> 00:39:26,680
hacking the hackers back so good job and

684
00:39:21,410 --> 00:39:26,680
let's say thank you today I<font color="#E5E5E5"> too thanks</font>

