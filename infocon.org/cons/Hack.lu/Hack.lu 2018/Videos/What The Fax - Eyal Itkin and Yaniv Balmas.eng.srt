1
00:00:04,160 --> 00:00:09,000
hello everyone

2
00:00:07,319 --> 00:00:11,580
it's very nice being here<font color="#E5E5E5"> at a clue</font>

3
00:00:09,000 --> 00:00:14,219
again<font color="#E5E5E5"> and as Klaus mentioned this idea</font>

4
00:00:11,580 --> 00:00:16,018
<font color="#CCCCCC">actually came</font><font color="#E5E5E5"> to us after a bit too many</font>

5
00:00:14,220 --> 00:00:19,039
<font color="#E5E5E5">beers here in the bar so it's kind of a</font>

6
00:00:16,018 --> 00:00:22,918
closure for<font color="#CCCCCC"> us to present</font><font color="#E5E5E5"> it over here</font>

7
00:00:19,039 --> 00:00:25,019
<font color="#CCCCCC">let's</font><font color="#E5E5E5"> begin</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> first of all this is us</font>

8
00:00:22,919 --> 00:00:26,999
<font color="#E5E5E5">this is my name is ian is bulma's and i</font>

9
00:00:25,019 --> 00:00:29,848
am a security<font color="#CCCCCC"> researcher and i would</font>

10
00:00:26,999 --> 00:00:33,269
walk<font color="#E5E5E5"> a</font><font color="#CCCCCC"> checkpoint and so is</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> lit</font><font color="#E5E5E5"> kin my</font>

11
00:00:29,849 --> 00:00:35,340
colleague here and let's dive right<font color="#E5E5E5"> into</font>

12
00:00:33,270 --> 00:00:39,170
it<font color="#E5E5E5"> but just</font><font color="#CCCCCC"> a bit about facts history</font>

13
00:00:35,340 --> 00:00:41,780
before<font color="#CCCCCC"> we begin</font><font color="#E5E5E5"> so it all started at</font>

14
00:00:39,170 --> 00:00:45,269
1846<font color="#CCCCCC"> when a scientist</font><font color="#E5E5E5"> named</font><font color="#CCCCCC"> alex tomlin</font>

15
00:00:41,780 --> 00:00:47,879
<font color="#CCCCCC">alexander bane invented or managed to</font>

16
00:00:45,269 --> 00:00:50,399
send the<font color="#CCCCCC"> fax the first image of a wire</font>

17
00:00:47,879 --> 00:00:52,170
<font color="#CCCCCC">and fun</font><font color="#E5E5E5"> fact this happened around 20</font>

18
00:00:50,399 --> 00:00:55,559
<font color="#E5E5E5">years before</font><font color="#CCCCCC"> the invention</font><font color="#E5E5E5"> of the light</font>

19
00:00:52,170 --> 00:00:57,510
bulb<font color="#E5E5E5"> and then it continued and that was</font>

20
00:00:55,559 --> 00:00:59,428
the first something<font color="#CCCCCC"> that looks like a</font>

21
00:00:57,510 --> 00:01:01,649
fax machine<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we know today</font><font color="#CCCCCC"> again</font>

22
00:00:59,429 --> 00:01:02,339
<font color="#E5E5E5">around 20 years before</font><font color="#CCCCCC"> the invention of</font>

23
00:01:01,649 --> 00:01:04,710
<font color="#E5E5E5">the telephone</font>

24
00:01:02,339 --> 00:01:07,710
<font color="#E5E5E5">so humanity was sending fax before we</font>

25
00:01:04,709 --> 00:01:11,699
actually made phone calls<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then some</font>

26
00:01:07,710 --> 00:01:14,490
<font color="#E5E5E5">more advanced in in</font><font color="#CCCCCC"> fax</font><font color="#E5E5E5"> and mainly the</font>

27
00:01:11,700 --> 00:01:16,950
<font color="#E5E5E5">main ones is in 1966 a very small and</font>

28
00:01:14,490 --> 00:01:18,690
unknown company called<font color="#E5E5E5"> Xerox made the</font>

29
00:01:16,950 --> 00:01:22,500
<font color="#E5E5E5">first commercial fax machine that's the</font>

30
00:01:18,690 --> 00:01:26,490
that's the<font color="#E5E5E5"> commercial there and then at</font>

31
00:01:22,500 --> 00:01:28,890
1918 1980 an organization called<font color="#E5E5E5"> ITU</font>

32
00:01:26,490 --> 00:01:33,060
invented the de facto standards for fax

33
00:01:28,890 --> 00:01:35,040
namely<font color="#CCCCCC"> t30 84</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> t6</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is basically</font>

34
00:01:33,060 --> 00:01:37,260
the<font color="#E5E5E5"> same standards and the same</font>

35
00:01:35,040 --> 00:01:40,020
protocols that we still use<font color="#CCCCCC"> today</font><font color="#E5E5E5"> with</font>

36
00:01:37,260 --> 00:01:41,400
slight modifications<font color="#CCCCCC"> you know this was</font>

37
00:01:40,020 --> 00:01:44,310
all in<font color="#E5E5E5"> the past</font>

38
00:01:41,400 --> 00:01:45,960
right but today<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> we have better</font>

39
00:01:44,310 --> 00:01:47,520
<font color="#E5E5E5">ways</font><font color="#CCCCCC"> to send electronic documents for</font>

40
00:01:45,960 --> 00:01:49,949
one to the other<font color="#CCCCCC"> right let's try</font><font color="#E5E5E5"> to</font>

41
00:01:47,520 --> 00:01:51,750
compare fax to just one of<font color="#CCCCCC"> them on the</font>

42
00:01:49,950 --> 00:01:55,170
top<font color="#E5E5E5"> of my mind of the top</font><font color="#CCCCCC"> of my mind</font>

43
00:01:51,750 --> 00:01:59,280
<font color="#E5E5E5">email for example</font><font color="#CCCCCC"> so just to remind you</font>

44
00:01:55,170 --> 00:02:02,220
we<font color="#CCCCCC"> are comparing</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> to this</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so</font>

45
00:01:59,280 --> 00:02:04,230
in terms of quality<font color="#E5E5E5"> yes I guess you know</font>

46
00:02:02,220 --> 00:02:06,090
you just<font color="#E5E5E5"> saw those</font><font color="#CCCCCC"> pictures I have</font>

47
00:02:04,230 --> 00:02:08,729
nothing<font color="#CCCCCC"> more to</font><font color="#E5E5E5"> add in terms</font><font color="#CCCCCC"> of</font>

48
00:02:06,090 --> 00:02:11,039
accessibility<font color="#E5E5E5"> I'm pretty sure most of</font>

49
00:02:08,729 --> 00:02:12,960
you here or all<font color="#CCCCCC"> of you have 24 by</font><font color="#E5E5E5"> 7</font>

50
00:02:11,038 --> 00:02:14,609
<font color="#E5E5E5">access to email I'm not so sure you</font><font color="#CCCCCC"> are</font>

51
00:02:12,960 --> 00:02:16,569
carrying<font color="#E5E5E5"> around your fax machines with</font>

52
00:02:14,610 --> 00:02:18,159
you regarding<font color="#CCCCCC"> relay</font>

53
00:02:16,569 --> 00:02:21,518
<font color="#E5E5E5">leti</font><font color="#CCCCCC"> well when you send an email</font><font color="#E5E5E5"> you</font>

54
00:02:18,159 --> 00:02:23,530
know<font color="#CCCCCC"> that it gets sent</font><font color="#E5E5E5"> or not sent to or</font>

55
00:02:21,519 --> 00:02:26,019
received another received<font color="#E5E5E5"> by its</font>

56
00:02:23,530 --> 00:02:28,030
destination<font color="#E5E5E5"> but you know for</font><font color="#CCCCCC"> fax we have</font>

57
00:02:26,019 --> 00:02:30,099
nothing<font color="#E5E5E5"> so yes we have</font><font color="#CCCCCC"> this paper</font><font color="#E5E5E5"> saying</font>

58
00:02:28,030 --> 00:02:31,629
received<font color="#E5E5E5"> okay right but you know if</font>

59
00:02:30,099 --> 00:02:33,608
<font color="#E5E5E5">there</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> no papers in the receiving</font>

60
00:02:31,629 --> 00:02:35,888
printer for example you will still get

61
00:02:33,609 --> 00:02:37,659
<font color="#E5E5E5">this if the dog ate it</font><font color="#CCCCCC"> still absolutely</font>

62
00:02:35,889 --> 00:02:40,000
<font color="#E5E5E5">no reliability in</font><font color="#CCCCCC"> facts right and</font>

63
00:02:37,659 --> 00:02:41,888
<font color="#E5E5E5">regarding what</font><font color="#CCCCCC"> is authenticity</font>

64
00:02:40,000 --> 00:02:44,230
what we can argue<font color="#E5E5E5"> whether or not email</font>

65
00:02:41,889 --> 00:02:45,879
is authenticated<font color="#E5E5E5"> but we do have</font><font color="#CCCCCC"> public</font>

66
00:02:44,230 --> 00:02:47,918
key cryptography<font color="#CCCCCC"> you know and stuff like</font>

67
00:02:45,879 --> 00:02:50,048
that it<font color="#E5E5E5"> helps us with that what we don't</font>

68
00:02:47,919 --> 00:02:52,480
have is we<font color="#CCCCCC"> have nothing for fax</font>

69
00:02:50,049 --> 00:02:54,340
<font color="#E5E5E5">basically right absolutely notice it</font>

70
00:02:52,480 --> 00:02:57,548
looking at this table<font color="#CCCCCC"> one might think</font>

71
00:02:54,340 --> 00:02:59,859
<font color="#CCCCCC">okay so Fox</font><font color="#E5E5E5"> did its job</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> it was</font>

72
00:02:57,549 --> 00:03:02,939
really<font color="#E5E5E5"> good in the</font><font color="#CCCCCC"> past but obviously</font>

73
00:02:59,859 --> 00:03:05,919
nobody is<font color="#CCCCCC"> using fax today</font><font color="#E5E5E5"> right wrong</font>

74
00:03:02,939 --> 00:03:08,948
<font color="#E5E5E5">everybody</font><font color="#CCCCCC"> is using</font><font color="#E5E5E5"> fax</font><font color="#CCCCCC"> today it's being</font>

75
00:03:05,919 --> 00:03:10,719
<font color="#E5E5E5">used everywhere ships a maritime you</font>

76
00:03:08,949 --> 00:03:13,769
know it<font color="#E5E5E5"> open</font><font color="#CCCCCC"> seas receive these critical</font>

77
00:03:10,719 --> 00:03:16,659
telemetry<font color="#E5E5E5"> maps using fax fax over radio</font>

78
00:03:13,769 --> 00:03:17,949
Japan<font color="#CCCCCC"> ninety</font><font color="#E5E5E5"> but according to Wikipedia</font>

79
00:03:16,659 --> 00:03:20,439
at least<font color="#CCCCCC"> ninety percent</font><font color="#E5E5E5"> of the Japanese</font>

80
00:03:17,949 --> 00:03:22,689
<font color="#CCCCCC">population use fax they really love fax</font>

81
00:03:20,439 --> 00:03:25,870
in Japan<font color="#E5E5E5"> that's all I have to</font><font color="#CCCCCC"> say about</font>

82
00:03:22,689 --> 00:03:28,269
<font color="#E5E5E5">that and if you do a simple google combo</font>

83
00:03:25,870 --> 00:03:31,900
search like contact us and<font color="#E5E5E5"> fax you will</font>

84
00:03:28,269 --> 00:03:33,489
find<font color="#E5E5E5"> around 380 million fax numbers</font>

85
00:03:31,900 --> 00:03:35,109
published on<font color="#CCCCCC"> Google and that's only the</font>

86
00:03:33,489 --> 00:03:37,120
published numbers think about how<font color="#CCCCCC"> many</font>

87
00:03:35,109 --> 00:03:38,889
numbers are<font color="#E5E5E5"> not published it's</font>

88
00:03:37,120 --> 00:03:41,409
<font color="#E5E5E5">absolutely mind-blowing and you know</font>

89
00:03:38,889 --> 00:03:42,819
it's<font color="#E5E5E5"> not only about how many fax</font>

90
00:03:41,409 --> 00:03:45,578
machines are<font color="#CCCCCC"> out there but it's also</font>

91
00:03:42,819 --> 00:03:47,259
about<font color="#E5E5E5"> who is using fax and the thing is</font>

92
00:03:45,579 --> 00:03:50,590
<font color="#E5E5E5">that everybody is using</font><font color="#CCCCCC"> fax if you're a</font>

93
00:03:47,259 --> 00:03:53,138
small company<font color="#CCCCCC"> medium company a huge</font>

94
00:03:50,590 --> 00:03:55,509
<font color="#CCCCCC">cooperate you have a fax number you</font>

95
00:03:53,139 --> 00:03:58,180
don't necessarily receive any faxes over

96
00:03:55,509 --> 00:03:59,290
this<font color="#E5E5E5"> number but you do have a fax</font><font color="#CCCCCC"> number</font>

97
00:03:58,180 --> 00:04:02,079
and<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> a fax machine standing</font>

98
00:03:59,290 --> 00:04:04,358
<font color="#CCCCCC">behind the number and</font><font color="#E5E5E5"> now we're in</font>

99
00:04:02,079 --> 00:04:07,810
<font color="#E5E5E5">Luxembourg right so if you're a bank you</font>

100
00:04:04,359 --> 00:04:09,819
really love fax and this is Bank of

101
00:04:07,810 --> 00:04:12,459
China the biggest<font color="#CCCCCC"> bank in the world</font><font color="#E5E5E5"> and</font>

102
00:04:09,819 --> 00:04:14,649
this this is<font color="#CCCCCC"> fax number and I think last</font>

103
00:04:12,459 --> 00:04:17,738
but not least is<font color="#CCCCCC"> that if you're a</font>

104
00:04:14,650 --> 00:04:19,060
government<font color="#CCCCCC"> institution</font><font color="#E5E5E5"> you wake up in</font>

105
00:04:17,738 --> 00:04:21,310
the<font color="#E5E5E5"> morning and you want facts</font>

106
00:04:19,060 --> 00:04:23,169
<font color="#CCCCCC">then that's what you want and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

107
00:04:21,310 --> 00:04:25,300
the<font color="#CCCCCC"> fax for Donald Trump if you anybody</font>

108
00:04:23,169 --> 00:04:27,190
ever wants<font color="#CCCCCC"> to send a fax</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the White</font>

109
00:04:25,300 --> 00:04:28,010
House<font color="#E5E5E5"> so it's just there we just googled</font>

110
00:04:27,190 --> 00:04:30,020
it

111
00:04:28,010 --> 00:04:32,360
and we find it to be<font color="#CCCCCC"> very funny</font><font color="#E5E5E5"> and the</font>

112
00:04:30,020 --> 00:04:34,609
thing is that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think mostly banks and</font>

113
00:04:32,360 --> 00:04:37,580
government<font color="#CCCCCC"> institutions</font><font color="#E5E5E5"> they don't</font><font color="#CCCCCC"> only</font>

114
00:04:34,610 --> 00:04:39,770
allow you to send<font color="#CCCCCC"> fax but a lot of</font><font color="#E5E5E5"> times</font>

115
00:04:37,580 --> 00:04:41,659
it's<font color="#CCCCCC"> actually mandatory</font><font color="#E5E5E5"> to send fax</font>

116
00:04:39,770 --> 00:04:44,210
there is no other way<font color="#CCCCCC"> you can under use</font>

117
00:04:41,660 --> 00:04:45,950
postal mail or fax<font color="#E5E5E5"> that's it</font>

118
00:04:44,210 --> 00:04:48,530
they<font color="#E5E5E5"> haven't heard about any other</font>

119
00:04:45,950 --> 00:04:50,450
option it happens a lot<font color="#E5E5E5"> all around the</font>

120
00:04:48,530 --> 00:04:52,429
<font color="#E5E5E5">world and we were thinking</font><font color="#CCCCCC"> of this</font>

121
00:04:50,450 --> 00:04:55,789
actually here in<font color="#E5E5E5"> the bar as I said in in</font>

122
00:04:52,430 --> 00:04:58,190
in Luxembourg and<font color="#E5E5E5"> we said you</font><font color="#CCCCCC"> know what</font>

123
00:04:55,790 --> 00:05:02,090
the facts<font color="#E5E5E5"> how is it possible we live in</font>

124
00:04:58,190 --> 00:05:03,890
2018 and and we still<font color="#E5E5E5"> use this</font><font color="#CCCCCC"> 3040 year</font>

125
00:05:02,090 --> 00:05:06,429
old technology<font color="#CCCCCC"> there must</font><font color="#E5E5E5"> be something</font>

126
00:05:03,890 --> 00:05:09,349
<font color="#E5E5E5">that can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> done about</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> catastrophic</font>

127
00:05:06,430 --> 00:05:11,240
<font color="#CCCCCC">behavior and and that's what we</font><font color="#E5E5E5"> started</font>

128
00:05:09,350 --> 00:05:14,450
<font color="#CCCCCC">doing and just before</font><font color="#E5E5E5"> we tell you what</font>

129
00:05:11,240 --> 00:05:17,240
<font color="#E5E5E5">we did so I have to explain how this fax</font>

130
00:05:14,450 --> 00:05:18,890
<font color="#CCCCCC">lukla looks like today well today</font><font color="#E5E5E5"> fax is</font>

131
00:05:17,240 --> 00:05:20,810
not the same thing<font color="#CCCCCC"> that we had 30 years</font>

132
00:05:18,890 --> 00:05:22,640
ago 30<font color="#E5E5E5"> years ago we had</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> standalone</font>

133
00:05:20,810 --> 00:05:25,340
fax machines right and they were doing

134
00:05:22,640 --> 00:05:27,409
fax and only fax<font color="#E5E5E5"> but that's kind of not</font>

135
00:05:25,340 --> 00:05:29,780
the<font color="#E5E5E5"> situation today today fax is most of</font>

136
00:05:27,410 --> 00:05:32,540
the times it's like<font color="#E5E5E5"> 30 years is all</font>

137
00:05:29,780 --> 00:05:35,179
technology<font color="#CCCCCC"> wrapped</font><font color="#E5E5E5"> around like newer</font>

138
00:05:32,540 --> 00:05:37,820
technologies so for example we have<font color="#CCCCCC"> fax</font>

139
00:05:35,180 --> 00:05:40,220
<font color="#E5E5E5">to email</font><font color="#CCCCCC"> or email to fax we have fax</font>

140
00:05:37,820 --> 00:05:42,830
<font color="#E5E5E5">over radio in fax over satellite and I</font>

141
00:05:40,220 --> 00:05:44,840
think most commonly<font color="#E5E5E5"> we have this kind</font><font color="#CCCCCC"> of</font>

142
00:05:42,830 --> 00:05:46,940
these creatures<font color="#CCCCCC"> there lease printers</font>

143
00:05:44,840 --> 00:05:48,859
<font color="#E5E5E5">this all-in-one printers right</font><font color="#CCCCCC"> I mean</font>

144
00:05:46,940 --> 00:05:50,300
you see them everywhere<font color="#CCCCCC"> an organization</font>

145
00:05:48,860 --> 00:05:52,880
in homes<font color="#E5E5E5"> there there are like millions</font>

146
00:05:50,300 --> 00:05:55,760
<font color="#CCCCCC">of this</font><font color="#E5E5E5"> around the world</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> our</font>

147
00:05:52,880 --> 00:05:58,130
research actually<font color="#E5E5E5"> focused on those</font>

148
00:05:55,760 --> 00:06:00,260
devices<font color="#E5E5E5"> the all-in-one printers then I</font>

149
00:05:58,130 --> 00:06:02,540
mean if you<font color="#E5E5E5"> take a look at those devices</font>

150
00:06:00,260 --> 00:06:04,670
<font color="#CCCCCC">from a security point of</font><font color="#E5E5E5"> view then you</font>

151
00:06:02,540 --> 00:06:07,580
<font color="#E5E5E5">can consider them</font><font color="#CCCCCC"> to be black boxes</font>

152
00:06:04,670 --> 00:06:10,700
right<font color="#E5E5E5"> and on one</font><font color="#CCCCCC"> side</font><font color="#E5E5E5"> of this they have</font>

153
00:06:07,580 --> 00:06:12,680
interfaces<font color="#E5E5E5"> like Ethernet Bluetooth Wi-Fi</font>

154
00:06:10,700 --> 00:06:15,620
stuff like that and those interfaces

155
00:06:12,680 --> 00:06:17,480
connects the printer<font color="#E5E5E5"> basically to the</font>

156
00:06:15,620 --> 00:06:19,520
<font color="#E5E5E5">world right to the internal network the</font>

157
00:06:17,480 --> 00:06:21,830
external<font color="#CCCCCC"> network and</font><font color="#E5E5E5"> every everywhere</font>

158
00:06:19,520 --> 00:06:24,049
else<font color="#E5E5E5"> and then on the</font><font color="#CCCCCC"> other side of</font><font color="#E5E5E5"> this</font>

159
00:06:21,830 --> 00:06:26,840
<font color="#E5E5E5">black box</font><font color="#CCCCCC"> there is this nice</font><font color="#E5E5E5"> little</font>

160
00:06:24,050 --> 00:06:29,870
interface<font color="#E5E5E5"> that connects us to well</font>

161
00:06:26,840 --> 00:06:32,900
somewhere<font color="#E5E5E5"> to in</font><font color="#CCCCCC"> 1970s a to the of</font><font color="#E5E5E5"> course</font>

162
00:06:29,870 --> 00:06:35,120
<font color="#E5E5E5">to the phone line and and the thing is</font>

163
00:06:32,900 --> 00:06:36,859
<font color="#E5E5E5">that if you remember that these devices</font>

164
00:06:35,120 --> 00:06:39,200
at the end of the day there<font color="#CCCCCC"> are nothing</font>

165
00:06:36,860 --> 00:06:41,240
<font color="#CCCCCC">but computers you see they have</font><font color="#E5E5E5"> CPUs the</font>

166
00:06:39,200 --> 00:06:43,849
memories they have operating systems

167
00:06:41,240 --> 00:06:45,680
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> it's a computer</font><font color="#E5E5E5"> right and we</font>

168
00:06:43,850 --> 00:06:48,020
were<font color="#E5E5E5"> thinking to</font><font color="#CCCCCC"> ourselves okay so what</font>

169
00:06:45,680 --> 00:06:51,560
would happen<font color="#E5E5E5"> if an attacker</font><font color="#CCCCCC"> sitting</font>

170
00:06:48,020 --> 00:06:53,930
somewhere<font color="#CCCCCC"> in the world</font><font color="#E5E5E5"> with access only</font>

171
00:06:51,560 --> 00:06:56,930
to<font color="#CCCCCC"> the phone line</font><font color="#E5E5E5"> and equipped with it</font>

172
00:06:53,930 --> 00:06:59,270
with its targets<font color="#E5E5E5"> text number what will</font>

173
00:06:56,930 --> 00:07:02,030
happen if this guy will<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to send</font>

174
00:06:59,270 --> 00:07:04,280
a malicious fax right and then take over

175
00:07:02,030 --> 00:07:06,080
<font color="#E5E5E5">the printer using these facts if you'll</font>

176
00:07:04,280 --> 00:07:08,330
be able<font color="#E5E5E5"> to do that you can then</font>

177
00:07:06,080 --> 00:07:10,430
propagate<font color="#E5E5E5"> and pivot from from there</font>

178
00:07:08,330 --> 00:07:12,380
<font color="#E5E5E5">through any of these other interfaces</font>

179
00:07:10,430 --> 00:07:13,670
let's say the Internet<font color="#E5E5E5"> to the internal</font>

180
00:07:12,380 --> 00:07:15,890
<font color="#E5E5E5">network</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> because this thing is</font>

181
00:07:13,670 --> 00:07:17,330
<font color="#CCCCCC">connected both ways and</font><font color="#E5E5E5"> effectively</font>

182
00:07:15,890 --> 00:07:19,190
creating kind of<font color="#E5E5E5"> a bridge</font><font color="#CCCCCC"> between the</font>

183
00:07:17,330 --> 00:07:21,380
internal<font color="#E5E5E5"> network</font><font color="#CCCCCC"> and the external</font>

184
00:07:19,190 --> 00:07:25,100
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> just using the telephone line</font>

185
00:07:21,380 --> 00:07:26,870
but we're back<font color="#E5E5E5"> to the 1980s</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> so we</font>

186
00:07:25,100 --> 00:07:30,020
thought that<font color="#CCCCCC"> this would be</font><font color="#E5E5E5"> really really</font>

187
00:07:26,870 --> 00:07:33,680
<font color="#CCCCCC">cool</font><font color="#E5E5E5"> and we accepted the challenge and</font>

188
00:07:30,020 --> 00:07:36,710
<font color="#E5E5E5">and went for</font><font color="#CCCCCC"> it so then after</font><font color="#E5E5E5"> we got</font>

189
00:07:33,680 --> 00:07:38,300
excited<font color="#CCCCCC"> a bit</font><font color="#E5E5E5"> we sat down and talked</font>

190
00:07:36,710 --> 00:07:40,940
<font color="#E5E5E5">about this and it turns out</font><font color="#CCCCCC"> that we have</font>

191
00:07:38,300 --> 00:07:43,070
<font color="#CCCCCC">a lot of challenges ahead</font><font color="#E5E5E5"> let's call it</font>

192
00:07:40,940 --> 00:07:45,770
<font color="#E5E5E5">like that</font><font color="#CCCCCC"> really a lot</font><font color="#E5E5E5"> of challenges</font><font color="#CCCCCC"> and</font>

193
00:07:43,070 --> 00:07:47,780
<font color="#CCCCCC">most</font><font color="#E5E5E5"> of them look at least or they sound</font>

194
00:07:45,770 --> 00:07:51,020
really really<font color="#E5E5E5"> hard and let me just give</font>

195
00:07:47,780 --> 00:07:52,520
<font color="#CCCCCC">you some of them you</font><font color="#E5E5E5"> know so first we</font>

196
00:07:51,020 --> 00:07:54,469
have to<font color="#E5E5E5"> understand how to obtain the</font><font color="#CCCCCC"> few</font>

197
00:07:52,520 --> 00:07:57,200
<font color="#CCCCCC">more</font><font color="#E5E5E5"> of the printer we need to read the</font>

198
00:07:54,470 --> 00:07:59,210
<font color="#E5E5E5">code of this somehow and then after we</font>

199
00:07:57,200 --> 00:08:01,490
did that<font color="#CCCCCC"> how do</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> analyze this</font>

200
00:07:59,210 --> 00:08:04,700
<font color="#CCCCCC">framework</font><font color="#E5E5E5"> and what is this</font><font color="#CCCCCC"> thing even</font>

201
00:08:01,490 --> 00:08:06,710
even doing<font color="#E5E5E5"> what operating system</font><font color="#CCCCCC"> is this</font>

202
00:08:04,700 --> 00:08:09,260
thing running<font color="#CCCCCC"> we have no</font><font color="#E5E5E5"> idea when we</font>

203
00:08:06,710 --> 00:08:11,539
start this<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> and then how can</font><font color="#E5E5E5"> we</font>

204
00:08:09,260 --> 00:08:13,849
debug this thing it's a printer how the

205
00:08:11,540 --> 00:08:15,680
hell do you<font color="#E5E5E5"> the baguette printer</font><font color="#CCCCCC"> and</font>

206
00:08:13,850 --> 00:08:17,900
<font color="#E5E5E5">then how does fax even work</font>

207
00:08:15,680 --> 00:08:20,090
we know the<font color="#E5E5E5"> beeping sounds but we</font><font color="#CCCCCC"> have</font>

208
00:08:17,900 --> 00:08:21,770
no<font color="#E5E5E5"> idea how it works</font><font color="#CCCCCC"> and after we did</font>

209
00:08:20,090 --> 00:08:23,539
<font color="#CCCCCC">all that then we can start</font><font color="#E5E5E5"> discussing</font>

210
00:08:21,770 --> 00:08:25,070
<font color="#E5E5E5">about where we can find vulnerabilities</font>

211
00:08:23,540 --> 00:08:27,260
and<font color="#E5E5E5"> how we can find the vulnerabilities</font>

212
00:08:25,070 --> 00:08:29,270
<font color="#CCCCCC">and today in this talk</font><font color="#E5E5E5"> we're gonna take</font>

213
00:08:27,260 --> 00:08:32,000
you<font color="#CCCCCC"> through these challenges</font><font color="#E5E5E5"> one by one</font>

214
00:08:29,270 --> 00:08:34,789
<font color="#E5E5E5">as best as we</font><font color="#CCCCCC"> can until we'll be able</font><font color="#E5E5E5"> to</font>

215
00:08:32,000 --> 00:08:38,510
<font color="#CCCCCC">do</font><font color="#E5E5E5"> exactly what</font><font color="#CCCCCC"> we wanted to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> so first</font>

216
00:08:34,789 --> 00:08:40,280
<font color="#E5E5E5">challenge how to obtain the framework so</font>

217
00:08:38,510 --> 00:08:42,740
before we tell<font color="#E5E5E5"> you how to</font><font color="#CCCCCC"> obtain and</font>

218
00:08:40,280 --> 00:08:46,010
fewer let me show you this is<font color="#E5E5E5"> the very</font>

219
00:08:42,740 --> 00:08:49,490
pool printer that we abused for so so

220
00:08:46,010 --> 00:08:51,500
many<font color="#E5E5E5"> time</font><font color="#CCCCCC"> so much time and it's an HP</font>

221
00:08:49,490 --> 00:08:53,000
<font color="#CCCCCC">printer it's an HP Officejet printer</font>

222
00:08:51,500 --> 00:08:54,980
<font color="#E5E5E5">we chose HP</font>

223
00:08:53,000 --> 00:08:57,620
basically<font color="#E5E5E5"> not because we dislike HP but</font>

224
00:08:54,980 --> 00:08:59,449
because they have around<font color="#CCCCCC"> 40% of the</font>

225
00:08:57,620 --> 00:09:02,180
market share<font color="#E5E5E5"> so</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> just the</font><font color="#CCCCCC"> biggest</font>

226
00:08:59,449 --> 00:09:04,099
target<font color="#CCCCCC"> out there and this specific model</font>

227
00:09:02,180 --> 00:09:05,750
<font color="#E5E5E5">well you know I can say a lot of</font><font color="#CCCCCC"> things</font>

228
00:09:04,100 --> 00:09:09,350
<font color="#CCCCCC">about why we chose</font><font color="#E5E5E5"> this model but</font>

229
00:09:05,750 --> 00:09:11,990
practically<font color="#E5E5E5"> it's the cheapest one so</font>

230
00:09:09,350 --> 00:09:14,449
yeah we could afford buying like three

231
00:09:11,990 --> 00:09:16,819
or<font color="#CCCCCC"> four</font><font color="#E5E5E5"> of those and</font><font color="#CCCCCC"> just break them and</font>

232
00:09:14,449 --> 00:09:18,620
now we<font color="#E5E5E5"> wanted to break facts but just a</font>

233
00:09:16,819 --> 00:09:20,660
second before<font color="#E5E5E5"> we break facts we need to</font>

234
00:09:18,620 --> 00:09:22,939
break the printer<font color="#E5E5E5"> and I mean literally</font>

235
00:09:20,660 --> 00:09:24,709
<font color="#E5E5E5">break the printer</font><font color="#CCCCCC"> so that's the fun part</font>

236
00:09:22,939 --> 00:09:26,599
of the research we take it take

237
00:09:24,709 --> 00:09:28,579
everything open and<font color="#E5E5E5"> and take it out and</font>

238
00:09:26,600 --> 00:09:31,009
<font color="#CCCCCC">start</font><font color="#E5E5E5"> looking at that and and then we</font>

239
00:09:28,579 --> 00:09:32,810
start<font color="#E5E5E5"> netting what we see so that's the</font>

240
00:09:31,009 --> 00:09:34,699
main PCB<font color="#E5E5E5"> that's the brain behind the</font>

241
00:09:32,810 --> 00:09:39,170
printer<font color="#E5E5E5"> right and it has several</font>

242
00:09:34,699 --> 00:09:41,269
components<font color="#E5E5E5"> on it like flash</font><font color="#CCCCCC"> ROM and SRAM</font>

243
00:09:39,170 --> 00:09:43,399
and<font color="#E5E5E5"> it might look like not enough</font>

244
00:09:41,269 --> 00:09:45,230
components for a PCB of a printer and

245
00:09:43,399 --> 00:09:45,980
that's because this thing has two sides

246
00:09:45,230 --> 00:09:48,410
to<font color="#CCCCCC"> it</font>

247
00:09:45,980 --> 00:09:50,350
and on this side<font color="#CCCCCC"> there's all the</font>

248
00:09:48,410 --> 00:09:52,879
interesting stuff<font color="#E5E5E5"> like USB Wi-Fi</font>

249
00:09:50,350 --> 00:09:54,769
electricity some kind of strange battery

250
00:09:52,879 --> 00:09:56,029
that's used<font color="#CCCCCC"> for something</font><font color="#E5E5E5"> and SRAM and</font>

251
00:09:54,769 --> 00:09:59,240
specifically<font color="#E5E5E5"> two very interesting</font>

252
00:09:56,029 --> 00:10:01,399
<font color="#CCCCCC">components one is the CPU</font><font color="#E5E5E5"> this is a CPU</font>

253
00:09:59,240 --> 00:10:04,490
manufactured by<font color="#E5E5E5"> Marvel and it's</font>

254
00:10:01,399 --> 00:10:06,019
manufactured specifically for HP so<font color="#CCCCCC"> you</font>

255
00:10:04,490 --> 00:10:08,660
can't get this thing<font color="#E5E5E5"> on Aliexpress</font>

256
00:10:06,019 --> 00:10:10,699
earlier<font color="#E5E5E5"> Alibaba</font><font color="#CCCCCC"> or whatever only</font><font color="#E5E5E5"> HP</font><font color="#CCCCCC"> has</font>

257
00:10:08,660 --> 00:10:13,459
<font color="#E5E5E5">hex access to this thing and the other</font>

258
00:10:10,699 --> 00:10:16,099
component is this one and it's a fax

259
00:10:13,459 --> 00:10:18,050
modem right<font color="#E5E5E5"> and what what in what's</font>

260
00:10:16,100 --> 00:10:20,120
interesting to<font color="#CCCCCC"> us is specifically what's</font>

261
00:10:18,050 --> 00:10:21,769
going on<font color="#E5E5E5"> inside</font><font color="#CCCCCC"> those components and the</font>

262
00:10:20,120 --> 00:10:23,779
connection and<font color="#E5E5E5"> the relationship between</font>

263
00:10:21,769 --> 00:10:26,059
them<font color="#E5E5E5"> and that that</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> be our</font><font color="#CCCCCC"> focus</font>

264
00:10:23,779 --> 00:10:27,529
and<font color="#E5E5E5"> as I said</font><font color="#CCCCCC"> our main challenge at</font>

265
00:10:26,059 --> 00:10:29,540
<font color="#E5E5E5">least at the beginning is</font><font color="#CCCCCC"> to get the</font>

266
00:10:27,529 --> 00:10:32,509
<font color="#CCCCCC">filmer of this thing</font><font color="#E5E5E5"> and when we are</font>

267
00:10:29,540 --> 00:10:35,449
<font color="#E5E5E5">taking a closer</font><font color="#CCCCCC"> look at this PCB we find</font>

268
00:10:32,509 --> 00:10:37,670
<font color="#E5E5E5">two very promising interfaces one of</font>

269
00:10:35,449 --> 00:10:39,139
them is called<font color="#CCCCCC"> jtag and</font><font color="#E5E5E5"> another is</font>

270
00:10:37,670 --> 00:10:41,120
called serial debug it's really<font color="#E5E5E5"> clearly</font>

271
00:10:39,139 --> 00:10:42,949
marked<font color="#E5E5E5"> on the PCB and now we say okay so</font>

272
00:10:41,120 --> 00:10:44,629
it's gonna be really<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> you know there</font>

273
00:10:42,949 --> 00:10:46,670
is<font color="#E5E5E5"> this</font><font color="#CCCCCC"> a JTAG here it will give us</font><font color="#E5E5E5"> like</font>

274
00:10:44,629 --> 00:10:48,319
read access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the memory write access</font>

275
00:10:46,670 --> 00:10:50,870
to<font color="#E5E5E5"> memory basically</font><font color="#CCCCCC"> this that's all we</font>

276
00:10:48,319 --> 00:10:52,160
need<font color="#CCCCCC"> but it turns</font><font color="#E5E5E5"> out that it's</font><font color="#CCCCCC"> not</font>

277
00:10:50,870 --> 00:10:54,290
<font color="#E5E5E5">going to be that easy</font><font color="#CCCCCC"> you see because</font>

278
00:10:52,160 --> 00:10:55,399
<font color="#E5E5E5">the JTAG is completely disabled of</font>

279
00:10:54,290 --> 00:10:57,050
course it's disabled on the

280
00:10:55,399 --> 00:10:59,720
manufacturing<font color="#CCCCCC"> line so we can access it</font>

281
00:10:57,050 --> 00:11:01,939
and the serial debug well you know we

282
00:10:59,720 --> 00:11:05,029
managed<font color="#CCCCCC"> to connect to it but what we get</font>

283
00:11:01,939 --> 00:11:05,329
is this like a terminal but almost every

284
00:11:05,029 --> 00:11:07,519
<font color="#CCCCCC">com</font>

285
00:11:05,329 --> 00:11:09,709
<font color="#E5E5E5">that we try we get this like error I</font>

286
00:11:07,519 --> 00:11:12,379
don't understand<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> don't understand</font>

287
00:11:09,709 --> 00:11:13,969
either<font color="#CCCCCC"> what should we do now</font><font color="#E5E5E5"> so</font>

288
00:11:12,379 --> 00:11:16,639
<font color="#E5E5E5">obviously it's</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> the right</font><font color="#CCCCCC"> pest ago</font>

289
00:11:13,970 --> 00:11:18,920
and we need to find<font color="#E5E5E5"> like an alternative</font>

290
00:11:16,639 --> 00:11:21,049
<font color="#CCCCCC">fat for that and</font><font color="#E5E5E5"> luckily for</font><font color="#CCCCCC"> us we</font>

291
00:11:18,920 --> 00:11:23,769
<font color="#E5E5E5">browse the</font><font color="#CCCCCC"> internet and</font><font color="#E5E5E5"> we find this</font>

292
00:11:21,049 --> 00:11:27,079
wonderful wonderful<font color="#E5E5E5"> site FTP site</font><font color="#CCCCCC"> online</font>

293
00:11:23,769 --> 00:11:29,779
<font color="#CCCCCC">it's HP's</font><font color="#E5E5E5"> FTP site and this thing</font>

294
00:11:27,079 --> 00:11:31,729
contains every<font color="#E5E5E5"> filmer version for every</font>

295
00:11:29,779 --> 00:11:35,989
<font color="#E5E5E5">HP product ever produced in the history</font>

296
00:11:31,730 --> 00:11:38,509
of HP<font color="#CCCCCC"> and the humanity</font><font color="#E5E5E5"> this thing is so</font>

297
00:11:35,989 --> 00:11:40,959
huge<font color="#E5E5E5"> it took us</font><font color="#CCCCCC"> like about two weeks to</font>

298
00:11:38,509 --> 00:11:43,879
<font color="#E5E5E5">find</font><font color="#CCCCCC"> our film were inside this thing</font>

299
00:11:40,959 --> 00:11:45,559
yeah but but yeah feel free<font color="#CCCCCC"> to go and</font>

300
00:11:43,879 --> 00:11:47,209
<font color="#CCCCCC">write there's other</font><font color="#E5E5E5"> stuff other than</font>

301
00:11:45,559 --> 00:11:49,009
<font color="#E5E5E5">fever I think it's really it's</font><font color="#CCCCCC"> really</font>

302
00:11:47,209 --> 00:11:50,779
nice<font color="#E5E5E5"> and now okay</font><font color="#CCCCCC"> so we got</font><font color="#E5E5E5"> our file</font>

303
00:11:49,009 --> 00:11:52,910
<font color="#E5E5E5">this is like the</font><font color="#CCCCCC"> film or upgrade file</font>

304
00:11:50,779 --> 00:11:54,589
and now we need<font color="#E5E5E5"> to make sense out of it</font>

305
00:11:52,910 --> 00:11:55,699
<font color="#CCCCCC">because it's</font><font color="#E5E5E5"> not an executable it's</font>

306
00:11:54,589 --> 00:11:58,790
something we<font color="#CCCCCC"> need to understand</font>

307
00:11:55,699 --> 00:12:01,248
basically how<font color="#E5E5E5"> do we upgrade the printers</font>

308
00:11:58,790 --> 00:12:03,199
<font color="#CCCCCC">framework and I mean I have no idea I</font>

309
00:12:01,249 --> 00:12:05,029
never<font color="#E5E5E5"> done it before and how do you even</font>

310
00:12:03,199 --> 00:12:07,939
do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and it turns out that the answer</font>

311
00:12:05,029 --> 00:12:10,519
<font color="#CCCCCC">to this question is surprisingly funny</font>

312
00:12:07,939 --> 00:12:13,219
well you<font color="#E5E5E5"> just print it</font><font color="#CCCCCC"> it turns out that</font>

313
00:12:10,519 --> 00:12:15,559
the printer accepts<font color="#CCCCCC"> similar</font><font color="#E5E5E5"> average just</font>

314
00:12:13,220 --> 00:12:19,699
the same way<font color="#E5E5E5"> as it accepts print jobs</font>

315
00:12:15,559 --> 00:12:22,790
you see HP<font color="#CCCCCC"> defined this nice document</font>

316
00:12:19,699 --> 00:12:25,160
called bcl-xl feature reference protocol

317
00:12:22,790 --> 00:12:27,379
<font color="#E5E5E5">class 2.1 supplement that if you are</font>

318
00:12:25,160 --> 00:12:29,419
still sane after reading this thing<font color="#E5E5E5"> you</font>

319
00:12:27,379 --> 00:12:31,749
understand<font color="#CCCCCC"> that the HP defined something</font>

320
00:12:29,419 --> 00:12:34,489
called<font color="#E5E5E5"> a</font><font color="#CCCCCC"> pj l print job language that</font>

321
00:12:31,749 --> 00:12:37,639
over this protocol you send both print

322
00:12:34,489 --> 00:12:39,319
jobs and<font color="#E5E5E5"> up upgrades and our file really</font>

323
00:12:37,639 --> 00:12:41,629
is consistent with<font color="#E5E5E5"> it because you see it</font>

324
00:12:39,319 --> 00:12:43,699
starts with this like<font color="#CCCCCC"> pjl print job</font>

325
00:12:41,629 --> 00:12:45,649
<font color="#CCCCCC">language thing so</font><font color="#E5E5E5"> okay that's what we're</font>

326
00:12:43,699 --> 00:12:47,599
looking at<font color="#E5E5E5"> and now we kind of need</font><font color="#CCCCCC"> to</font>

327
00:12:45,649 --> 00:12:49,249
start opening<font color="#CCCCCC"> this thing</font><font color="#E5E5E5"> it's like an</font>

328
00:12:47,600 --> 00:12:51,110
<font color="#E5E5E5">onion and it has layers and we start</font>

329
00:12:49,249 --> 00:12:54,079
need to<font color="#E5E5E5"> start opening</font><font color="#CCCCCC"> those layers one</font>

330
00:12:51,110 --> 00:12:54,589
<font color="#CCCCCC">by one</font><font color="#E5E5E5"> and there's there's a lot of work</font>

331
00:12:54,079 --> 00:12:56,479
here

332
00:12:54,589 --> 00:12:57,829
tedious work really<font color="#E5E5E5"> not interesting I'll</font>

333
00:12:56,480 --> 00:12:59,989
just tell<font color="#E5E5E5"> it is the first part</font><font color="#CCCCCC"> of it is</font>

334
00:12:57,829 --> 00:13:01,279
composed of a lot of decoders<font color="#E5E5E5"> like</font>

335
00:12:59,989 --> 00:13:04,879
there's something<font color="#CCCCCC"> called</font><font color="#E5E5E5"> a null decoder</font>

336
00:13:01,279 --> 00:13:06,679
<font color="#CCCCCC">TIFF decoder Delta row decoder</font><font color="#E5E5E5"> really</font>

337
00:13:04,879 --> 00:13:08,929
not interesting but<font color="#E5E5E5"> the main concept</font><font color="#CCCCCC"> is</font>

338
00:13:06,679 --> 00:13:11,419
<font color="#E5E5E5">like saying something</font><font color="#CCCCCC"> like okay if the</font>

339
00:13:08,929 --> 00:13:13,519
<font color="#E5E5E5">previous line was all spaces then if</font>

340
00:13:11,419 --> 00:13:15,499
this line is<font color="#E5E5E5"> also all spaces just write</font>

341
00:13:13,519 --> 00:13:17,660
one instead of<font color="#CCCCCC"> the line</font><font color="#E5E5E5"> compression</font>

342
00:13:15,499 --> 00:13:19,160
right<font color="#E5E5E5"> now this makes perfect sense</font><font color="#CCCCCC"> when</font>

343
00:13:17,660 --> 00:13:21,230
<font color="#E5E5E5">you are sending a print job because</font>

344
00:13:19,160 --> 00:13:23,060
you know like print papers have a lot of

345
00:13:21,230 --> 00:13:25,370
<font color="#CCCCCC">spaces in them</font><font color="#E5E5E5"> but when you are sending</font>

346
00:13:23,060 --> 00:13:27,888
<font color="#CCCCCC">a binary file it makes</font><font color="#E5E5E5"> absolutely no</font>

347
00:13:25,370 --> 00:13:30,230
sense<font color="#CCCCCC"> completely useless but still they</font>

348
00:13:27,889 --> 00:13:32,240
do it<font color="#CCCCCC"> and we found</font><font color="#E5E5E5"> it pretty funny and</font>

349
00:13:30,230 --> 00:13:33,589
you know<font color="#E5E5E5"> we said to ourselves that when</font>

350
00:13:32,240 --> 00:13:35,269
you're a hammer<font color="#CCCCCC"> everything looks like a</font>

351
00:13:33,589 --> 00:13:36,860
nail<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so when you're a printer</font>

352
00:13:35,269 --> 00:13:39,319
everything looks like a print job and

353
00:13:36,860 --> 00:13:41,959
<font color="#E5E5E5">the</font><font color="#CCCCCC"> fumer</font><font color="#E5E5E5"> as well and we found it a bit</font>

354
00:13:39,319 --> 00:13:45,740
<font color="#E5E5E5">funny and</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so we managed to you know</font>

355
00:13:41,959 --> 00:13:49,128
<font color="#CCCCCC">peel off all this pieces</font><font color="#E5E5E5"> and now we have</font>

356
00:13:45,740 --> 00:13:51,589
a file<font color="#CCCCCC"> which looks like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> finger and</font>

357
00:13:49,129 --> 00:13:54,589
now we start need to<font color="#E5E5E5"> start analyzing it</font>

358
00:13:51,589 --> 00:13:56,480
<font color="#E5E5E5">and just when</font><font color="#CCCCCC"> we start analyzing it</font>

359
00:13:54,589 --> 00:13:57,920
right at<font color="#E5E5E5"> the beginning</font><font color="#CCCCCC"> of the file</font><font color="#E5E5E5"> we</font>

360
00:13:56,480 --> 00:14:00,829
find something<font color="#CCCCCC"> that looks</font><font color="#E5E5E5"> like a table</font>

361
00:13:57,920 --> 00:14:02,509
<font color="#E5E5E5">and we define it in</font><font color="#CCCCCC"> iodine</font><font color="#E5E5E5"> it really is</font>

362
00:14:00,829 --> 00:14:03,920
a table there's a really<font color="#CCCCCC"> easy table and</font>

363
00:14:02,509 --> 00:14:05,870
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> called the section</font>

364
00:14:03,920 --> 00:14:07,939
table<font color="#CCCCCC"> basically this big file that we</font>

365
00:14:05,870 --> 00:14:09,800
got now is composed of several sections

366
00:14:07,939 --> 00:14:11,449
and<font color="#E5E5E5"> this table</font><font color="#CCCCCC"> just explains those</font>

367
00:14:09,800 --> 00:14:13,519
<font color="#E5E5E5">sections so it states the loading</font>

368
00:14:11,449 --> 00:14:15,079
address the section name and then the

369
00:14:13,519 --> 00:14:16,970
location in binary<font color="#E5E5E5"> so we can now take</font>

370
00:14:15,079 --> 00:14:18,949
<font color="#E5E5E5">these files split it into several</font>

371
00:14:16,970 --> 00:14:20,329
sections<font color="#E5E5E5"> and inspect each and every</font>

372
00:14:18,949 --> 00:14:22,219
<font color="#CCCCCC">section</font><font color="#E5E5E5"> one of these sections</font>

373
00:14:20,329 --> 00:14:23,959
<font color="#E5E5E5">specifically</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think it was the biggest</font>

374
00:14:22,220 --> 00:14:25,790
<font color="#E5E5E5">one is</font><font color="#CCCCCC"> the one</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> interesting to us</font>

375
00:14:23,959 --> 00:14:27,319
and it's interesting to us because<font color="#E5E5E5"> we</font>

376
00:14:25,790 --> 00:14:29,000
can't understand<font color="#CCCCCC"> that we're looking</font><font color="#E5E5E5"> at</font>

377
00:14:27,319 --> 00:14:30,620
the film were itself<font color="#E5E5E5"> and how do we</font>

378
00:14:29,000 --> 00:14:32,360
understand<font color="#E5E5E5"> that I mean those are</font><font color="#CCCCCC"> just</font>

379
00:14:30,620 --> 00:14:35,360
snippets from this<font color="#E5E5E5"> section and take</font><font color="#CCCCCC"> a</font>

380
00:14:32,360 --> 00:14:36,829
look at this<font color="#E5E5E5"> yeah error I don't</font>

381
00:14:35,360 --> 00:14:38,779
understand so we are looking<font color="#E5E5E5"> at the same</font>

382
00:14:36,829 --> 00:14:40,430
serial protocol that's the code that's

383
00:14:38,779 --> 00:14:41,990
<font color="#E5E5E5">what we were</font><font color="#CCCCCC"> looking for</font><font color="#E5E5E5"> but it's not</font>

384
00:14:40,430 --> 00:14:43,758
<font color="#E5E5E5">completely there something is missing</font>

385
00:14:41,990 --> 00:14:46,550
<font color="#CCCCCC">you see there are</font><font color="#E5E5E5"> some letters</font><font color="#CCCCCC"> missing</font>

386
00:14:43,759 --> 00:14:48,410
there and those bytes are consistently

387
00:14:46,550 --> 00:14:50,359
missing<font color="#E5E5E5"> from the entire film</font><font color="#CCCCCC"> were filed</font>

388
00:14:48,410 --> 00:14:52,130
so although we know<font color="#CCCCCC"> that we are there</font>

389
00:14:50,360 --> 00:14:54,649
we're still not completely there<font color="#E5E5E5"> we need</font>

390
00:14:52,130 --> 00:14:56,509
<font color="#CCCCCC">to</font><font color="#E5E5E5"> find what was were these bytes</font>

391
00:14:54,649 --> 00:14:58,970
replaced with in<font color="#E5E5E5"> order for us to read</font>

392
00:14:56,509 --> 00:15:01,100
<font color="#E5E5E5">the film were and that's that's that's a</font>

393
00:14:58,970 --> 00:15:02,660
<font color="#CCCCCC">pretty big challenge</font><font color="#E5E5E5"> now first we need</font>

394
00:15:01,100 --> 00:15:05,000
<font color="#E5E5E5">to understand what is this thing why are</font>

395
00:15:02,660 --> 00:15:07,160
those white missing and we have a lot of

396
00:15:05,000 --> 00:15:09,170
<font color="#E5E5E5">assumptions</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> all of them are crazy</font>

397
00:15:07,160 --> 00:15:10,819
<font color="#E5E5E5">completely crazy but</font><font color="#CCCCCC"> I think that the</font>

398
00:15:09,170 --> 00:15:13,069
least craziest assumption would be that

399
00:15:10,819 --> 00:15:16,069
<font color="#E5E5E5">this is again another form of</font>

400
00:15:13,069 --> 00:15:18,050
compression<font color="#CCCCCC"> why</font><font color="#E5E5E5"> I have no idea but it's</font>

401
00:15:16,069 --> 00:15:19,639
a pointer<font color="#CCCCCC"> so I'm</font><font color="#E5E5E5"> not asking a lot of</font>

402
00:15:18,050 --> 00:15:21,889
questions<font color="#CCCCCC"> but the</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> that if this</font>

403
00:15:19,639 --> 00:15:23,839
<font color="#E5E5E5">is a compression it's really a bad</font>

404
00:15:21,889 --> 00:15:25,399
compression<font color="#E5E5E5"> because when we take</font><font color="#CCCCCC"> Z leap</font>

405
00:15:23,839 --> 00:15:27,050
for example and compress the same thing

406
00:15:25,399 --> 00:15:29,300
with<font color="#CCCCCC"> dilip like the most standard</font>

407
00:15:27,050 --> 00:15:29,900
compression<font color="#E5E5E5"> algorithm out there</font><font color="#CCCCCC"> a</font>

408
00:15:29,300 --> 00:15:32,839
compression

409
00:15:29,900 --> 00:15:34,730
yeah so we get<font color="#E5E5E5"> about</font><font color="#CCCCCC"> around 80%</font><font color="#E5E5E5"> better</font>

410
00:15:32,839 --> 00:15:36,290
compression<font color="#CCCCCC"> and we know that the printer</font>

411
00:15:34,730 --> 00:15:38,390
has<font color="#CCCCCC"> Ely because we can see the strings</font>

412
00:15:36,290 --> 00:15:41,120
for<font color="#CCCCCC"> Zillah minutes so why won't</font><font color="#E5E5E5"> they use</font>

413
00:15:38,390 --> 00:15:43,189
<font color="#CCCCCC">dilib I don't know</font><font color="#E5E5E5"> but still</font><font color="#CCCCCC"> we need to</font>

414
00:15:41,120 --> 00:15:44,870
do<font color="#E5E5E5"> something</font><font color="#CCCCCC"> with it</font><font color="#E5E5E5"> so let's</font><font color="#CCCCCC"> take you</font>

415
00:15:43,190 --> 00:15:48,110
<font color="#CCCCCC">through this challenge</font><font color="#E5E5E5"> and how to</font><font color="#CCCCCC"> decode</font>

416
00:15:44,870 --> 00:15:49,880
<font color="#E5E5E5">this crazy compression algorithm so this</font>

417
00:15:48,110 --> 00:15:52,310
is the snippet that<font color="#E5E5E5"> you just saw a</font>

418
00:15:49,880 --> 00:15:53,750
minute<font color="#CCCCCC"> ago and let's try</font><font color="#E5E5E5"> to decompress</font>

419
00:15:52,310 --> 00:15:55,579
this together<font color="#E5E5E5"> so that's what we have</font>

420
00:15:53,750 --> 00:15:57,620
<font color="#E5E5E5">here basically</font><font color="#CCCCCC"> it's composed</font><font color="#E5E5E5"> of two</font>

421
00:15:55,580 --> 00:15:59,810
types<font color="#CCCCCC"> of characters one is ASCII</font>

422
00:15:57,620 --> 00:16:01,940
characters stuff<font color="#E5E5E5"> that we can read right</font>

423
00:15:59,810 --> 00:16:03,709
<font color="#E5E5E5">and the other part is stuff</font><font color="#CCCCCC"> that we</font>

424
00:16:01,940 --> 00:16:05,839
can't<font color="#CCCCCC"> read non ASCII characters</font><font color="#E5E5E5"> right</font>

425
00:16:03,710 --> 00:16:08,960
and if you take<font color="#E5E5E5"> a look at this byte map</font>

426
00:16:05,839 --> 00:16:11,630
here<font color="#CCCCCC"> then you take off all the ASCII</font>

427
00:16:08,960 --> 00:16:13,430
characters those are our missing bytes

428
00:16:11,630 --> 00:16:14,960
basically right and if you start<font color="#E5E5E5"> if you</font>

429
00:16:13,430 --> 00:16:16,969
stir<font color="#E5E5E5"> this long enough you will start</font>

430
00:16:14,960 --> 00:16:18,950
<font color="#E5E5E5">seeing a</font><font color="#CCCCCC"> pattern</font><font color="#E5E5E5"> and let me make</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> a</font>

431
00:16:16,970 --> 00:16:21,020
bit clearer for<font color="#CCCCCC"> you you see there is</font>

432
00:16:18,950 --> 00:16:23,240
this one<font color="#E5E5E5"> single bytes there and then</font>

433
00:16:21,020 --> 00:16:25,189
there's double like<font color="#E5E5E5"> two bytes double</font>

434
00:16:23,240 --> 00:16:27,170
bytes right and the distance between<font color="#E5E5E5"> the</font>

435
00:16:25,190 --> 00:16:29,300
single bytes looks I would<font color="#E5E5E5"> say</font>

436
00:16:27,170 --> 00:16:30,800
suspiciously pattern is like<font color="#CCCCCC"> eight bytes</font>

437
00:16:29,300 --> 00:16:33,680
<font color="#CCCCCC">nine by</font><font color="#E5E5E5"> it's nine by it's eight bytes</font>

438
00:16:30,800 --> 00:16:34,579
<font color="#E5E5E5">but what does it mean</font><font color="#CCCCCC"> I mean if you</font><font color="#E5E5E5"> take</font>

439
00:16:33,680 --> 00:16:35,569
a look<font color="#E5E5E5"> at this from</font><font color="#CCCCCC"> a different</font>

440
00:16:34,580 --> 00:16:37,520
perspective

441
00:16:35,570 --> 00:16:40,430
maybe the pattern will<font color="#E5E5E5"> start being a bit</font>

442
00:16:37,520 --> 00:16:42,890
clearer<font color="#CCCCCC"> you see the f7 and</font><font color="#E5E5E5"> the f7 they</font>

443
00:16:40,430 --> 00:16:44,900
look the same<font color="#CCCCCC"> the FF and the</font><font color="#E5E5E5"> FF they</font>

444
00:16:42,890 --> 00:16:47,300
look the<font color="#CCCCCC"> same right now what does it</font>

445
00:16:44,900 --> 00:16:48,980
<font color="#CCCCCC">mean well in order to</font><font color="#E5E5E5"> answer this</font>

446
00:16:47,300 --> 00:16:51,380
question<font color="#CCCCCC"> you need to sharpen</font><font color="#E5E5E5"> your binary</font>

447
00:16:48,980 --> 00:16:53,839
<font color="#CCCCCC">view</font><font color="#E5E5E5"> a bit and if you understand that FF</font>

448
00:16:51,380 --> 00:16:55,459
is just<font color="#E5E5E5"> eight one bit right and if you</font>

449
00:16:53,839 --> 00:16:57,350
do this consistently<font color="#E5E5E5"> for all of these</font>

450
00:16:55,459 --> 00:16:59,689
things<font color="#E5E5E5"> then you will</font><font color="#CCCCCC"> see the pattern</font><font color="#E5E5E5"> and</font>

451
00:16:57,350 --> 00:17:02,390
the pattern is<font color="#CCCCCC"> that the</font><font color="#E5E5E5"> zero bit always</font>

452
00:16:59,690 --> 00:17:04,130
falls in the<font color="#E5E5E5"> two bytes hole so that's</font>

453
00:17:02,390 --> 00:17:05,780
<font color="#E5E5E5">perfect because that's kind of means</font>

454
00:17:04,130 --> 00:17:08,270
<font color="#E5E5E5">that the first byte that</font><font color="#CCCCCC"> we see is just</font>

455
00:17:05,780 --> 00:17:10,280
a bitmap<font color="#E5E5E5"> like describing the following</font>

456
00:17:08,270 --> 00:17:12,290
eight bytes wherever we have a<font color="#CCCCCC"> zero bit</font>

457
00:17:10,280 --> 00:17:14,420
there was a replacement<font color="#E5E5E5"> the replacement</font>

458
00:17:12,290 --> 00:17:18,020
is two bytes long<font color="#E5E5E5"> that's perfect now we</font>

459
00:17:14,420 --> 00:17:19,819
<font color="#E5E5E5">know what this one byte is and all we</font>

460
00:17:18,020 --> 00:17:22,309
need<font color="#CCCCCC"> to do is to understand those two</font>

461
00:17:19,819 --> 00:17:25,309
<font color="#E5E5E5">bytes and what were they replaced with</font>

462
00:17:22,309 --> 00:17:26,839
right and in<font color="#E5E5E5"> order to do that</font><font color="#CCCCCC"> if you</font>

463
00:17:25,309 --> 00:17:28,129
know anything<font color="#CCCCCC"> about compression you know</font>

464
00:17:26,839 --> 00:17:30,350
that<font color="#E5E5E5"> there's not a lot of options here</font>

465
00:17:28,130 --> 00:17:32,929
<font color="#CCCCCC">it could</font><font color="#E5E5E5"> be a forward or backward</font>

466
00:17:30,350 --> 00:17:34,969
pointer<font color="#CCCCCC"> it could be a dictionary</font><font color="#E5E5E5"> or it</font>

467
00:17:32,929 --> 00:17:37,190
could be a sliding window<font color="#E5E5E5"> now we know</font>

468
00:17:34,970 --> 00:17:39,020
it's<font color="#E5E5E5"> not a forward backward pointer and</font>

469
00:17:37,190 --> 00:17:41,000
we<font color="#CCCCCC"> know it's not a dictionary</font><font color="#E5E5E5"> because we</font>

470
00:17:39,020 --> 00:17:42,679
try<font color="#E5E5E5"> to reference it in our framework to</font>

471
00:17:41,000 --> 00:17:43,299
stuff that we know that should<font color="#CCCCCC"> be</font><font color="#E5E5E5"> there</font>

472
00:17:42,679 --> 00:17:46,090
<font color="#E5E5E5">and we</font>

473
00:17:43,299 --> 00:17:47,679
<font color="#E5E5E5">can so we will rule that out and then</font>

474
00:17:46,090 --> 00:17:49,600
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> left with a sliding</font><font color="#CCCCCC"> window so</font>

475
00:17:47,679 --> 00:17:52,090
<font color="#E5E5E5">that's probably what this thing is and</font>

476
00:17:49,600 --> 00:17:53,379
<font color="#CCCCCC">once we have this information we</font><font color="#E5E5E5"> go to</font>

477
00:17:52,090 --> 00:17:55,539
the<font color="#CCCCCC"> Internet and start looking</font><font color="#E5E5E5"> for</font>

478
00:17:53,379 --> 00:17:58,570
something that looks<font color="#CCCCCC"> similar</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> and</font>

479
00:17:55,539 --> 00:18:02,220
in<font color="#CCCCCC"> some very very very</font><font color="#E5E5E5"> dark corner</font><font color="#CCCCCC"> of</font>

480
00:17:58,570 --> 00:18:05,289
the<font color="#E5E5E5"> Internet</font><font color="#CCCCCC"> we find this</font><font color="#E5E5E5"> nice site here</font>

481
00:18:02,220 --> 00:18:09,639
something describing a softly soft disc

482
00:18:05,289 --> 00:18:12,220
<font color="#E5E5E5">library format</font><font color="#CCCCCC"> so have you anybody heard</font>

483
00:18:09,639 --> 00:18:13,840
about<font color="#E5E5E5"> this company</font><font color="#CCCCCC"> soft disc you</font>

484
00:18:12,220 --> 00:18:16,149
probably have but<font color="#E5E5E5"> you forgot that's</font>

485
00:18:13,840 --> 00:18:18,759
<font color="#E5E5E5">because we found here a compression</font>

486
00:18:16,149 --> 00:18:21,248
algorithm<font color="#CCCCCC"> that looks</font><font color="#E5E5E5"> exactly like our</font>

487
00:18:18,759 --> 00:18:23,109
compression exactly<font color="#E5E5E5"> bit by bit</font>

488
00:18:21,249 --> 00:18:26,200
and we found<font color="#E5E5E5"> it really funny because</font>

489
00:18:23,109 --> 00:18:28,299
this company is soft<font color="#CCCCCC"> discs actually</font>

490
00:18:26,200 --> 00:18:30,789
developed this algorithm somewhere in

491
00:18:28,299 --> 00:18:33,249
the 1980s<font color="#E5E5E5"> and it wasn't used I think</font>

492
00:18:30,789 --> 00:18:36,489
maybe at least<font color="#E5E5E5"> I haven't seen it used</font>

493
00:18:33,249 --> 00:18:38,679
anywhere<font color="#E5E5E5"> since but it's still used in HP</font>

494
00:18:36,489 --> 00:18:41,859
printers and you<font color="#CCCCCC"> have any guesses where</font>

495
00:18:38,679 --> 00:18:45,940
was this thing what is soft ISKCON where

496
00:18:41,859 --> 00:18:47,470
was this thing invented for what<font color="#E5E5E5"> yes it</font>

497
00:18:45,940 --> 00:18:50,470
was a<font color="#E5E5E5"> compression it was a compression</font>

498
00:18:47,470 --> 00:18:54,340
for<font color="#E5E5E5"> commander</font><font color="#CCCCCC"> King yeah the famous</font>

499
00:18:50,470 --> 00:18:57,369
computer<font color="#E5E5E5"> game so yeah that's the guys</font>

500
00:18:54,340 --> 00:18:59,590
who invented<font color="#CCCCCC"> this</font><font color="#E5E5E5"> did this thing get</font>

501
00:18:57,369 --> 00:19:01,449
into<font color="#CCCCCC"> HP printers I have no idea I</font><font color="#E5E5E5"> have a</font>

502
00:18:59,590 --> 00:19:04,600
lot of<font color="#E5E5E5"> speculations but I have no idea</font>

503
00:19:01,450 --> 00:19:06,340
<font color="#CCCCCC">but it did and now every HP</font><font color="#E5E5E5"> printer is</font>

504
00:19:04,600 --> 00:19:08,889
rendering a part of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Commander Keen</font>

505
00:19:06,340 --> 00:19:10,959
<font color="#E5E5E5">in</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so yeah that's pretty</font><font color="#CCCCCC"> funny</font><font color="#E5E5E5"> and</font>

506
00:19:08,889 --> 00:19:13,029
once we understand this<font color="#CCCCCC"> sliding-window</font>

507
00:19:10,960 --> 00:19:15,730
<font color="#E5E5E5">thing so now we have all the information</font>

508
00:19:13,029 --> 00:19:18,789
<font color="#E5E5E5">that we need in order to actually</font>

509
00:19:15,730 --> 00:19:21,159
decompress this thing and basically<font color="#E5E5E5"> it's</font>

510
00:19:18,789 --> 00:19:22,960
like we have we know that this<font color="#E5E5E5"> two bytes</font>

511
00:19:21,159 --> 00:19:24,340
are composed of<font color="#E5E5E5"> two</font><font color="#CCCCCC"> values</font><font color="#E5E5E5"> one is</font>

512
00:19:22,960 --> 00:19:25,929
<font color="#CCCCCC">window.location and the</font><font color="#E5E5E5"> other is data</font>

513
00:19:24,340 --> 00:19:27,908
<font color="#E5E5E5">length and that's basically what we</font><font color="#CCCCCC"> need</font>

514
00:19:25,929 --> 00:19:29,859
and let me give you an<font color="#CCCCCC"> example so</font><font color="#E5E5E5"> what</font>

515
00:19:27,909 --> 00:19:31,779
we have is an output<font color="#E5E5E5"> tags and input tags</font>

516
00:19:29,859 --> 00:19:34,600
<font color="#E5E5E5">and a sliding</font><font color="#CCCCCC"> window and let's try</font><font color="#E5E5E5"> to</font>

517
00:19:31,779 --> 00:19:37,359
compress this string here together right

518
00:19:34,600 --> 00:19:39,158
<font color="#CCCCCC">now okay so the first byte it's a bitmap</font>

519
00:19:37,359 --> 00:19:41,080
<font color="#CCCCCC">so we don't know what the value will be</font>

520
00:19:39,159 --> 00:19:43,299
<font color="#E5E5E5">we just</font><font color="#CCCCCC"> leave it open for now and then</font>

521
00:19:41,080 --> 00:19:45,580
we start with<font color="#E5E5E5"> a so a we write both in</font>

522
00:19:43,299 --> 00:19:47,980
the output<font color="#E5E5E5"> text and in the sliding</font>

523
00:19:45,580 --> 00:19:50,230
window<font color="#CCCCCC"> right</font><font color="#E5E5E5"> and then B and then C and</font>

524
00:19:47,980 --> 00:19:52,299
then D and then<font color="#E5E5E5"> we get</font><font color="#CCCCCC"> to a again but a</font>

525
00:19:50,230 --> 00:19:53,919
is what<font color="#CCCCCC"> I already</font><font color="#E5E5E5"> present in the sliding</font>

526
00:19:52,299 --> 00:19:55,779
window so we don't need<font color="#E5E5E5"> to write it</font><font color="#CCCCCC"> and</font>

527
00:19:53,919 --> 00:19:56,350
<font color="#E5E5E5">then B is just the character following</font>

528
00:19:55,779 --> 00:19:59,080
right

529
00:19:56,350 --> 00:20:01,090
and then when we get to<font color="#CCCCCC"> e</font><font color="#E5E5E5"> we write zero</font>

530
00:19:59,080 --> 00:20:03,100
<font color="#E5E5E5">zero zero two that means go to the</font>

531
00:20:01,090 --> 00:20:05,199
<font color="#E5E5E5">sliding</font><font color="#CCCCCC"> window at position zero</font><font color="#E5E5E5"> and take</font>

532
00:20:03,100 --> 00:20:07,990
the first<font color="#E5E5E5"> two bytes that's the</font>

533
00:20:05,200 --> 00:20:09,789
replacement<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we go on e FG right</font>

534
00:20:07,990 --> 00:20:11,350
<font color="#E5E5E5">and now that once we have that we have</font>

535
00:20:09,789 --> 00:20:13,929
<font color="#E5E5E5">our bitmap and we know that the value</font>

536
00:20:11,350 --> 00:20:15,789
here should be<font color="#E5E5E5"> EF and that's basically</font>

537
00:20:13,929 --> 00:20:17,440
<font color="#E5E5E5">it it's consistent you can decompress</font>

538
00:20:15,789 --> 00:20:19,059
the entire thing were using this<font color="#E5E5E5"> thing</font>

539
00:20:17,440 --> 00:20:22,929
<font color="#E5E5E5">it looks really easy when you look at it</font>

540
00:20:19,059 --> 00:20:26,710
that way<font color="#E5E5E5"> right but backwards is kind of</font>

541
00:20:22,929 --> 00:20:28,390
a bit more<font color="#E5E5E5"> complex</font><font color="#CCCCCC"> okay so now we</font><font color="#E5E5E5"> open</font>

542
00:20:26,710 --> 00:20:30,549
this<font color="#CCCCCC"> thing we</font><font color="#E5E5E5"> have a full team were at</font>

543
00:20:28,390 --> 00:20:32,320
least at last and now we can<font color="#E5E5E5"> start</font>

544
00:20:30,549 --> 00:20:34,270
analyzing this<font color="#E5E5E5"> framework it took us</font>

545
00:20:32,320 --> 00:20:36,340
actually a lot<font color="#E5E5E5"> of time to understand</font>

546
00:20:34,270 --> 00:20:38,340
what<font color="#CCCCCC"> is this thing running</font><font color="#E5E5E5"> and to</font>

547
00:20:36,340 --> 00:20:41,408
analyze everything<font color="#E5E5E5"> but let me make</font><font color="#CCCCCC"> it</font>

548
00:20:38,340 --> 00:20:43,959
shorter<font color="#CCCCCC"> for you so basically</font><font color="#E5E5E5"> the printer</font>

549
00:20:41,409 --> 00:20:46,570
<font color="#E5E5E5">is running</font><font color="#CCCCCC"> operating</font><font color="#E5E5E5"> system called tread</font>

550
00:20:43,960 --> 00:20:48,820
<font color="#E5E5E5">X and it's running over chip and arm</font>

551
00:20:46,570 --> 00:20:51,820
line chip<font color="#CCCCCC"> a</font><font color="#E5E5E5"> big-endian if it's</font>

552
00:20:48,820 --> 00:20:54,158
interesting to you<font color="#CCCCCC"> and it's it has</font>

553
00:20:51,820 --> 00:20:56,860
several<font color="#CCCCCC"> components like system and stuff</font>

554
00:20:54,159 --> 00:20:58,539
common libraries and tasks for system it

555
00:20:56,860 --> 00:21:00,158
has<font color="#CCCCCC"> two-stage</font><font color="#E5E5E5"> bootloader and some</font>

556
00:20:58,539 --> 00:21:01,929
networking libraries and stuff<font color="#CCCCCC"> like that</font>

557
00:21:00,159 --> 00:21:04,360
<font color="#E5E5E5">and then it has a lot of common</font>

558
00:21:01,929 --> 00:21:06,159
libraries<font color="#CCCCCC"> just common libraries and then</font>

559
00:21:04,360 --> 00:21:08,289
tasks now tasks are the rough equivalent

560
00:21:06,159 --> 00:21:10,179
<font color="#E5E5E5">of processes we know from normal</font>

561
00:21:08,289 --> 00:21:12,190
<font color="#E5E5E5">operating systems and once we have this</font>

562
00:21:10,179 --> 00:21:15,370
picture<font color="#E5E5E5"> it's pretty easy for us</font><font color="#CCCCCC"> to say</font>

563
00:21:12,190 --> 00:21:18,039
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> so these</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> the parts of the</font>

564
00:21:15,370 --> 00:21:19,719
operating system<font color="#E5E5E5"> that are using the fax</font>

565
00:21:18,039 --> 00:21:22,360
functionality and<font color="#E5E5E5"> we should concentrate</font>

566
00:21:19,720 --> 00:21:24,730
<font color="#E5E5E5">on those parts right</font><font color="#CCCCCC"> and we can leave</font>

567
00:21:22,360 --> 00:21:26,590
<font color="#E5E5E5">pretty much everything else aside and</font>

568
00:21:24,730 --> 00:21:29,470
that's nice but<font color="#CCCCCC"> just a second</font><font color="#E5E5E5"> before we</font>

569
00:21:26,590 --> 00:21:33,129
do<font color="#CCCCCC"> that we spot something</font><font color="#E5E5E5"> that doesn't</font>

570
00:21:29,470 --> 00:21:34,960
seem<font color="#E5E5E5"> right</font><font color="#CCCCCC"> we see this there's spider</font>

571
00:21:33,130 --> 00:21:36,309
monkey in there I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know if you're</font>

572
00:21:34,960 --> 00:21:38,230
<font color="#E5E5E5">familiar with spider monkey but spider</font>

573
00:21:36,309 --> 00:21:39,879
monkey is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> implementation of</font>

574
00:21:38,230 --> 00:21:42,909
<font color="#E5E5E5">Mozilla and we were thinking to</font>

575
00:21:39,880 --> 00:21:44,500
<font color="#E5E5E5">ourselves wait it's a printer why would</font>

576
00:21:42,909 --> 00:21:46,480
it be<font color="#E5E5E5"> using javascript</font><font color="#CCCCCC"> it makes</font>

577
00:21:44,500 --> 00:21:48,870
absolutely no sense<font color="#E5E5E5"> it's not a client</font>

578
00:21:46,480 --> 00:21:51,429
<font color="#E5E5E5">it's not it doesn't</font><font color="#CCCCCC"> have no J's so</font>

579
00:21:48,870 --> 00:21:53,799
what's going on<font color="#E5E5E5"> how why is this thing</font>

580
00:21:51,429 --> 00:21:55,299
<font color="#E5E5E5">running</font><font color="#CCCCCC"> JavaScript and we kinda were</font>

581
00:21:53,799 --> 00:21:58,120
intrigued<font color="#E5E5E5"> by</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> question and we</font>

582
00:21:55,299 --> 00:21:59,408
started you know<font color="#CCCCCC"> X</font><font color="#E5E5E5"> riffing back back</font>

583
00:21:58,120 --> 00:22:01,449
back<font color="#E5E5E5"> to see where is this functionality</font>

584
00:21:59,409 --> 00:22:03,400
<font color="#E5E5E5">used and it turns out that the</font><font color="#CCCCCC"> answer is</font>

585
00:22:01,450 --> 00:22:05,980
simple<font color="#CCCCCC"> it's used in a feature called</font><font color="#E5E5E5"> PAC</font>

586
00:22:03,400 --> 00:22:08,070
proxy<font color="#E5E5E5"> auto-configuration it's pretty</font>

587
00:22:05,980 --> 00:22:09,930
common<font color="#E5E5E5"> thing right and</font>

588
00:22:08,070 --> 00:22:13,710
it kind of you<font color="#E5E5E5"> know I'll to configure is</font>

589
00:22:09,930 --> 00:22:14,940
<font color="#E5E5E5">your your proxy when you do</font><font color="#CCCCCC"> when you</font>

590
00:22:13,710 --> 00:22:17,190
connect<font color="#CCCCCC"> to the network and stuff like</font>

591
00:22:14,940 --> 00:22:19,080
that<font color="#E5E5E5"> and it's pretty nice</font><font color="#CCCCCC"> and the thing</font>

592
00:22:17,190 --> 00:22:21,660
<font color="#E5E5E5">is that the top layer functionality of</font>

593
00:22:19,080 --> 00:22:23,879
<font color="#E5E5E5">this thing was</font><font color="#CCCCCC"> actually written by HP by</font>

594
00:22:21,660 --> 00:22:26,460
HP engineers<font color="#E5E5E5"> and we're looking at this</font>

595
00:22:23,880 --> 00:22:29,160
top layer<font color="#E5E5E5"> functionality we see this very</font>

596
00:22:26,460 --> 00:22:31,260
<font color="#CCCCCC">interesting thing you see just when it</font>

597
00:22:29,160 --> 00:22:33,570
<font color="#E5E5E5">begins this all</font><font color="#CCCCCC"> pack procedure it</font>

598
00:22:31,260 --> 00:22:35,700
connects<font color="#E5E5E5"> to this domain fake URL one two</font>

599
00:22:33,570 --> 00:22:37,800
<font color="#E5E5E5">three four</font><font color="#CCCCCC"> com</font><font color="#E5E5E5"> now it just connects this</font>

600
00:22:35,700 --> 00:22:39,570
<font color="#E5E5E5">domain does nothing with</font><font color="#CCCCCC"> it I don't know</font>

601
00:22:37,800 --> 00:22:41,639
why<font color="#E5E5E5"> maybe some kind of sanity test</font>

602
00:22:39,570 --> 00:22:43,530
<font color="#CCCCCC">that's my best guess at least</font><font color="#E5E5E5"> but that's</font>

603
00:22:41,640 --> 00:22:46,770
<font color="#CCCCCC">exactly</font><font color="#E5E5E5"> what it does and the interesting</font>

604
00:22:43,530 --> 00:22:48,960
<font color="#CCCCCC">thing here is do you</font><font color="#E5E5E5"> have any idea who</font>

605
00:22:46,770 --> 00:22:52,260
owns<font color="#CCCCCC"> this domain</font><font color="#E5E5E5"> fake URL</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> two three</font>

606
00:22:48,960 --> 00:22:58,200
<font color="#E5E5E5">four calm not it's not HP</font><font color="#CCCCCC"> if it was HP I</font>

607
00:22:52,260 --> 00:23:01,860
wouldn't be<font color="#CCCCCC"> asking who</font><font color="#E5E5E5"> no no knots of</font>

608
00:22:58,200 --> 00:23:04,350
this guy<font color="#E5E5E5"> I wish no knots of disk let me</font>

609
00:23:01,860 --> 00:23:06,360
give<font color="#CCCCCC"> you a hint</font>

610
00:23:04,350 --> 00:23:10,500
you all know him<font color="#E5E5E5"> or seen him at least</font>

611
00:23:06,360 --> 00:23:15,020
<font color="#E5E5E5">once that's because it's me the domain</font>

612
00:23:10,500 --> 00:23:15,020
wasn't registered yeah

613
00:23:15,330 --> 00:23:21,419
so I registered<font color="#E5E5E5"> this domain for</font><font color="#CCCCCC"> $5.00</font>

614
00:23:18,120 --> 00:23:26,489
<font color="#E5E5E5">and now every HP printer in the world is</font>

615
00:23:21,420 --> 00:23:28,560
connecting to<font color="#CCCCCC"> my domain so good</font><font color="#E5E5E5"> when we</font>

616
00:23:26,490 --> 00:23:31,170
<font color="#E5E5E5">told this to HP amazingly they left as</font>

617
00:23:28,560 --> 00:23:32,580
well but maybe if they<font color="#CCCCCC"> knew this now we</font>

618
00:23:31,170 --> 00:23:37,320
are<font color="#CCCCCC"> willing to sell</font><font color="#E5E5E5"> this for</font><font color="#CCCCCC"> a very</font><font color="#E5E5E5"> good</font>

619
00:23:32,580 --> 00:23:41,189
price for HP I am<font color="#CCCCCC"> okay so let's go on</font>

620
00:23:37,320 --> 00:23:45,260
with<font color="#CCCCCC"> a tech story so for that</font><font color="#E5E5E5"> I will</font>

621
00:23:41,190 --> 00:23:48,090
<font color="#E5E5E5">give it over to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> yell thank you</font>

622
00:23:45,260 --> 00:23:50,129
so after we finished messing<font color="#CCCCCC"> around with</font>

623
00:23:48,090 --> 00:23:53,459
<font color="#CCCCCC">SpiderMonkey we decided to focus back on</font>

624
00:23:50,130 --> 00:23:56,250
<font color="#CCCCCC">T</font><font color="#E5E5E5"> 30</font><font color="#CCCCCC"> T</font><font color="#E5E5E5"> 30 also known as itu-t</font>

625
00:23:53,460 --> 00:23:59,340
recommendation<font color="#E5E5E5"> T 30 is a senator defines</font>

626
00:23:56,250 --> 00:24:02,220
the fax protocol<font color="#E5E5E5"> it's a huge PDF</font>

627
00:23:59,340 --> 00:24:04,350
document<font color="#CCCCCC"> more</font><font color="#E5E5E5"> than 300 pages and defines</font>

628
00:24:02,220 --> 00:24:07,740
all<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> phases and messages we need</font>

629
00:24:04,350 --> 00:24:11,040
in order to<font color="#CCCCCC"> Senate receive</font><font color="#E5E5E5"> effects this</font>

630
00:24:07,740 --> 00:24:12,990
<font color="#CCCCCC">standard</font><font color="#E5E5E5"> was first</font><font color="#CCCCCC"> designed on 1985 and</font>

631
00:24:11,040 --> 00:24:17,940
was last updated and move in a decade

632
00:24:12,990 --> 00:24:19,860
ago<font color="#E5E5E5"> so it's a very old standard and that</font>

633
00:24:17,940 --> 00:24:21,480
<font color="#E5E5E5">good for us because we look for</font>

634
00:24:19,860 --> 00:24:23,750
vulnerabilities<font color="#CCCCCC"> in an old in</font>

635
00:24:21,480 --> 00:24:26,640
complicated<font color="#CCCCCC"> smile that's that's great</font>

636
00:24:23,750 --> 00:24:28,620
<font color="#E5E5E5">while we read through the standard we</font>

637
00:24:26,640 --> 00:24:30,630
started to reverse engineer<font color="#E5E5E5"> this is</font>

638
00:24:28,620 --> 00:24:35,159
<font color="#CCCCCC">ready state machine in the film itself</font>

639
00:24:30,630 --> 00:24:37,530
and it looked<font color="#E5E5E5"> like this after we</font><font color="#CCCCCC"> solve</font>

640
00:24:35,160 --> 00:24:40,290
this graph you we actually<font color="#CCCCCC"> were kind of</font>

641
00:24:37,530 --> 00:24:43,260
depressed<font color="#E5E5E5"> and after which we saw that</font>

642
00:24:40,290 --> 00:24:44,970
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a good graph view because most</font>

643
00:24:43,260 --> 00:24:47,370
of the code<font color="#CCCCCC"> locks you can see over there</font>

644
00:24:44,970 --> 00:24:49,200
<font color="#E5E5E5">contains</font><font color="#CCCCCC"> additional functions we have</font>

645
00:24:47,370 --> 00:24:52,020
additional<font color="#E5E5E5"> mini state machines inside</font>

646
00:24:49,200 --> 00:24:54,600
them<font color="#CCCCCC"> so it's a really</font><font color="#E5E5E5"> complex state</font>

647
00:24:52,020 --> 00:24:56,490
machine<font color="#CCCCCC"> and</font><font color="#E5E5E5"> if that wasn't enough it</font>

648
00:24:54,600 --> 00:24:59,189
turns<font color="#E5E5E5"> out that the few more heavily</font>

649
00:24:56,490 --> 00:25:02,010
<font color="#E5E5E5">relies on function pointers and global</font>

650
00:24:59,190 --> 00:25:04,590
<font color="#CCCCCC">variables</font><font color="#E5E5E5"> and it's going to be very</font>

651
00:25:02,010 --> 00:25:07,919
<font color="#E5E5E5">complicated to statically reverse</font>

652
00:25:04,590 --> 00:25:09,510
engineering this model usually<font color="#CCCCCC"> I prefer</font>

653
00:25:07,919 --> 00:25:12,510
to statically<font color="#CCCCCC"> reverse engineer a few</font>

654
00:25:09,510 --> 00:25:15,950
models<font color="#CCCCCC"> this time we had to change</font>

655
00:25:12,510 --> 00:25:20,340
<font color="#E5E5E5">tactics and go for more dynamic approach</font>

656
00:25:15,950 --> 00:25:23,250
<font color="#CCCCCC">we'll need</font><font color="#E5E5E5"> a a debugger but we have</font>

657
00:25:20,340 --> 00:25:27,120
another challenge<font color="#CCCCCC"> how can we debug a</font>

658
00:25:23,250 --> 00:25:31,740
<font color="#E5E5E5">pointer it's a box it outputs pages it's</font>

659
00:25:27,120 --> 00:25:33,989
not used to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> bugging so we have</font>

660
00:25:31,740 --> 00:25:36,990
several<font color="#CCCCCC"> challenges and inside it as</font>

661
00:25:33,990 --> 00:25:38,730
<font color="#CCCCCC">Geneva</font><font color="#E5E5E5"> mentioned earlier we had</font><font color="#CCCCCC"> JTAG</font><font color="#E5E5E5"> and</font>

662
00:25:36,990 --> 00:25:40,950
we have a serial port and but they

663
00:25:38,730 --> 00:25:43,500
weren't<font color="#CCCCCC"> very useful</font><font color="#E5E5E5"> we then tried to</font>

664
00:25:40,950 --> 00:25:45,179
<font color="#E5E5E5">search for</font><font color="#CCCCCC"> building gdb</font><font color="#E5E5E5"> stuff we could</font>

665
00:25:43,500 --> 00:25:48,270
connect<font color="#CCCCCC"> to and debug and we couldn't</font>

666
00:25:45,179 --> 00:25:50,940
<font color="#E5E5E5">find one either at this point we</font><font color="#CCCCCC"> should</font>

667
00:25:48,270 --> 00:25:53,160
remember<font color="#CCCCCC"> but I can't simply load a</font>

668
00:25:50,940 --> 00:25:56,610
debugger because this is have no control

669
00:25:53,160 --> 00:25:58,650
over<font color="#E5E5E5"> the execution</font><font color="#CCCCCC"> flow and another fact</font>

670
00:25:56,610 --> 00:26:02,189
is<font color="#E5E5E5"> that the printer uses a hardware</font>

671
00:25:58,650 --> 00:26:04,440
watchdog this watchdog will monitor the

672
00:26:02,190 --> 00:26:07,140
main CPU<font color="#E5E5E5"> and will trigger reboot</font>

673
00:26:04,440 --> 00:26:10,110
whenever the CPU halts<font color="#E5E5E5"> or enters an</font>

674
00:26:07,140 --> 00:26:13,980
endless loop essentially a breakpoint

675
00:26:10,110 --> 00:26:16,439
<font color="#E5E5E5">halts the program so we can't simply use</font>

676
00:26:13,980 --> 00:26:18,840
the debugger and<font color="#E5E5E5"> issues and break points</font>

677
00:26:16,440 --> 00:26:22,530
because the watchdog will reboot the

678
00:26:18,840 --> 00:26:24,750
printer and<font color="#CCCCCC"> that won't</font><font color="#E5E5E5"> be very</font><font color="#CCCCCC"> useful</font><font color="#E5E5E5"> we</font>

679
00:26:22,530 --> 00:26:26,790
<font color="#E5E5E5">decided to split up</font><font color="#CCCCCC"> the challenges one</font>

680
00:26:24,750 --> 00:26:29,610
by one<font color="#E5E5E5"> if you could find any</font>

681
00:26:26,790 --> 00:26:31,770
<font color="#E5E5E5">vulnerability to execute our own code on</font>

682
00:26:29,610 --> 00:26:35,520
the printer<font color="#E5E5E5"> we can try</font><font color="#CCCCCC"> to use it to load</font>

683
00:26:31,770 --> 00:26:37,980
a debugger for<font color="#CCCCCC"> on at this</font><font color="#E5E5E5"> point of our</font>

684
00:26:35,520 --> 00:26:41,490
we had a<font color="#E5E5E5"> stroke of luck</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's great</font>

685
00:26:37,980 --> 00:26:43,470
<font color="#E5E5E5">because we believe usually that</font><font color="#CCCCCC"> luck is</font>

686
00:26:41,490 --> 00:26:47,190
<font color="#E5E5E5">a fundamental part of every research we</font>

687
00:26:43,470 --> 00:26:49,860
do and here we have<font color="#CCCCCC"> our stroke of luck</font>

688
00:26:47,190 --> 00:26:53,160
<font color="#CCCCCC">on the 19th</font><font color="#E5E5E5"> of July</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> your published</font>

689
00:26:49,860 --> 00:26:55,020
vulnerability called<font color="#CCCCCC"> devil's IV Davis</font><font color="#E5E5E5"> IV</font>

690
00:26:53,160 --> 00:26:57,360
is a remote code execution vulnerability

691
00:26:55,020 --> 00:26:59,850
in the<font color="#CCCCCC"> juice of open source and</font><font color="#E5E5E5"> where</font>

692
00:26:57,360 --> 00:27:02,010
the devices<font color="#E5E5E5"> and</font><font color="#CCCCCC"> rp2 included tend to</font>

693
00:26:59,850 --> 00:27:03,899
implement embedded web servers inside

694
00:27:02,010 --> 00:27:07,170
them<font color="#E5E5E5"> used for</font><font color="#CCCCCC"> management and</font>

695
00:27:03,900 --> 00:27:10,440
configuration<font color="#E5E5E5"> and in our case this web</font>

696
00:27:07,170 --> 00:27:12,450
server used<font color="#CCCCCC"> gzip</font><font color="#E5E5E5"> after a further</font>

697
00:27:10,440 --> 00:27:14,790
examination we had a jackpot

698
00:27:12,450 --> 00:27:17,730
it turns out that<font color="#CCCCCC"> our printer is</font>

699
00:27:14,790 --> 00:27:21,750
<font color="#E5E5E5">vulnerable to Davis IV we have debugging</font>

700
00:27:17,730 --> 00:27:23,190
vulnerability we can continue on so

701
00:27:21,750 --> 00:27:25,650
those of you who<font color="#E5E5E5"> are not familiar with</font>

702
00:27:23,190 --> 00:27:31,140
<font color="#CCCCCC">David's IV he was the code and</font><font color="#E5E5E5"> here's a</font>

703
00:27:25,650 --> 00:27:33,270
vulnerable snippet decompile unfortunate

704
00:27:31,140 --> 00:27:35,460
for<font color="#CCCCCC"> us there</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> IV is</font><font color="#E5E5E5"> assigned</font>

705
00:27:33,270 --> 00:27:37,620
individual<font color="#E5E5E5"> underflow vulnerability</font><font color="#CCCCCC"> and</font>

706
00:27:35,460 --> 00:27:39,780
it<font color="#E5E5E5"> means we need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> send roughly</font><font color="#CCCCCC"> to</font>

707
00:27:37,620 --> 00:27:45,000
<font color="#CCCCCC">jjigae bytes of data in order to achieve</font>

708
00:27:39,780 --> 00:27:48,030
<font color="#CCCCCC">a stack-based buffer overflow HP pride</font>

709
00:27:45,000 --> 00:27:50,580
itself on the printing speed of the

710
00:27:48,030 --> 00:27:54,450
printers not on the<font color="#CCCCCC"> network speed</font><font color="#E5E5E5"> of the</font>

711
00:27:50,580 --> 00:27:57,840
printers so we had several optimization

712
00:27:54,450 --> 00:28:02,010
rounds and<font color="#CCCCCC"> it took us seven minutes for</font>

713
00:27:57,840 --> 00:28:03,750
each exploit attempt and this<font color="#E5E5E5"> point</font>

714
00:28:02,010 --> 00:28:06,390
signals the<font color="#CCCCCC"> end of a stroke of luck</font>

715
00:28:03,750 --> 00:28:09,330
<font color="#CCCCCC">because we soon found</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> that our</font>

716
00:28:06,390 --> 00:28:12,300
exploit had several<font color="#E5E5E5"> side effects one of</font>

717
00:28:09,330 --> 00:28:14,129
which<font color="#E5E5E5"> is after each successful expert</font>

718
00:28:12,300 --> 00:28:16,649
attempt we're going to have a grace

719
00:28:14,130 --> 00:28:19,650
period of three to<font color="#E5E5E5"> ten minutes and then</font>

720
00:28:16,650 --> 00:28:22,170
<font color="#CCCCCC">fill the crosses and then we need to</font>

721
00:28:19,650 --> 00:28:25,500
wait additional<font color="#E5E5E5"> seven minutes for one</font>

722
00:28:22,170 --> 00:28:27,990
more<font color="#CCCCCC"> ex-boy</font><font color="#E5E5E5"> so I had a lot of time to</font>

723
00:28:25,500 --> 00:28:32,580
check out my Twitter<font color="#E5E5E5"> account</font><font color="#CCCCCC"> during the</font>

724
00:28:27,990 --> 00:28:34,170
research<font color="#CCCCCC"> it's only</font><font color="#E5E5E5"> vulnerability we have</font>

725
00:28:32,580 --> 00:28:37,879
it's a remote code executed

726
00:28:34,170 --> 00:28:37,880
vulnerability we can't be picky

727
00:28:38,840 --> 00:28:44,100
initially we had missed several

728
00:28:42,300 --> 00:28:45,899
debugging<font color="#CCCCCC"> holidays but we wanted a</font>

729
00:28:44,100 --> 00:28:47,429
debugger so we could read<font color="#CCCCCC"> ram in right</font>

730
00:28:45,900 --> 00:28:49,290
<font color="#E5E5E5">round so we</font><font color="#CCCCCC"> could dynamically</font>

731
00:28:47,430 --> 00:28:51,930
reverse-engineer the fever

732
00:28:49,290 --> 00:28:55,530
and now that we<font color="#E5E5E5"> have our vulnerability</font>

733
00:28:51,930 --> 00:29:00,270
<font color="#CCCCCC">Devils Ivy</font><font color="#E5E5E5"> yeah we can use it</font><font color="#CCCCCC"> to load</font><font color="#E5E5E5"> a</font>

734
00:28:55,530 --> 00:29:03,149
debugger for on our debugger<font color="#CCCCCC"> will need</font>

735
00:29:00,270 --> 00:29:05,850
to be<font color="#E5E5E5"> executed we need to</font><font color="#CCCCCC"> bypass</font><font color="#E5E5E5"> several</font>

736
00:29:03,150 --> 00:29:07,890
memory protections of<font color="#CCCCCC"> the MPO</font><font color="#E5E5E5"> and the</font>

737
00:29:05,850 --> 00:29:09,990
most important thing is that<font color="#E5E5E5"> we want to</font>

738
00:29:07,890 --> 00:29:13,950
connect to this debugger<font color="#CCCCCC"> and we want the</font>

739
00:29:09,990 --> 00:29:16,350
printer to be<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so we need to somehow</font>

740
00:29:13,950 --> 00:29:19,290
blend<font color="#E5E5E5"> our debugger in the address space</font>

741
00:29:16,350 --> 00:29:21,540
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> femur</font><font color="#CCCCCC"> so the printer will behave</font>

742
00:29:19,290 --> 00:29:24,540
correctly<font color="#E5E5E5"> and we will have an additional</font>

743
00:29:21,540 --> 00:29:27,330
<font color="#E5E5E5">task</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> a debugger we couldn't find</font>

744
00:29:24,540 --> 00:29:30,210
any<font color="#CCCCCC"> built in known</font><font color="#E5E5E5"> open source debugger</font>

745
00:29:27,330 --> 00:29:32,939
<font color="#E5E5E5">what does it and my father usually tells</font>

746
00:29:30,210 --> 00:29:34,980
me to not reinvent the wheel and the

747
00:29:32,940 --> 00:29:38,910
wheel won't help me<font color="#E5E5E5"> debugger</font><font color="#CCCCCC"> printers</font><font color="#E5E5E5"> so</font>

748
00:29:34,980 --> 00:29:41,220
<font color="#CCCCCC">we reinvented</font><font color="#E5E5E5"> a debugger it said so this</font>

749
00:29:38,910 --> 00:29:42,960
<font color="#E5E5E5">is</font><font color="#CCCCCC"> Scout Scout is an instruction based</font>

750
00:29:41,220 --> 00:29:44,850
debugger<font color="#E5E5E5"> it currently supports</font><font color="#CCCCCC"> Intel</font>

751
00:29:42,960 --> 00:29:48,210
CPUs as well<font color="#CCCCCC"> as well</font><font color="#E5E5E5"> as arm</font>

752
00:29:44,850 --> 00:29:50,370
<font color="#E5E5E5">it supports arms thumb mode because the</font>

753
00:29:48,210 --> 00:29:52,950
<font color="#CCCCCC">frida uses it</font><font color="#E5E5E5"> so I had</font><font color="#CCCCCC"> to implement</font><font color="#E5E5E5"> it</font>

754
00:29:50,370 --> 00:29:55,530
<font color="#E5E5E5">and you get it as a bonus in a previous</font>

755
00:29:52,950 --> 00:29:59,310
research we used<font color="#E5E5E5"> prototype version of</font>

756
00:29:55,530 --> 00:30:02,520
<font color="#CCCCCC">Scout for Linux kernel research</font><font color="#E5E5E5"> so we</font>

757
00:29:59,310 --> 00:30:06,570
<font color="#E5E5E5">compile the Scout as a kernel driver we</font>

758
00:30:02,520 --> 00:30:08,570
loaded it up<font color="#CCCCCC"> and debug the kernel this</font>

759
00:30:06,570 --> 00:30:11,429
time we're going<font color="#CCCCCC"> to use caddy embedded</font>

760
00:30:08,570 --> 00:30:13,200
<font color="#E5E5E5">compilation mode this mode you compile</font>

761
00:30:11,430 --> 00:30:16,260
Scout to a fully position independent

762
00:30:13,200 --> 00:30:18,570
code<font color="#E5E5E5"> and I mean fully position in a</font>

763
00:30:16,260 --> 00:30:20,910
<font color="#CCCCCC">parent</font><font color="#E5E5E5"> it has its own global</font><font color="#CCCCCC"> off</font><font color="#E5E5E5"> the</font>

764
00:30:18,570 --> 00:30:24,210
table with addresses of useful<font color="#CCCCCC"> tremor</font>

765
00:30:20,910 --> 00:30:26,220
functions such as<font color="#CCCCCC"> socket Biden</font><font color="#E5E5E5"> M copy</font>

766
00:30:24,210 --> 00:30:28,200
<font color="#E5E5E5">your sleep so we could find them in its</font>

767
00:30:26,220 --> 00:30:30,300
own global<font color="#E5E5E5"> off the table and call them</font>

768
00:30:28,200 --> 00:30:33,710
once<font color="#CCCCCC"> compiled you've got a fully</font>

769
00:30:30,300 --> 00:30:36,360
position independent<font color="#E5E5E5"> global you simply</font>

770
00:30:33,710 --> 00:30:40,520
inject it to the<font color="#CCCCCC"> address</font><font color="#E5E5E5"> space using a</font>

771
00:30:36,360 --> 00:30:42,780
<font color="#E5E5E5">vulnerability and execute it being a</font>

772
00:30:40,520 --> 00:30:44,400
<font color="#E5E5E5">instruction based debugger Scott will</font>

773
00:30:42,780 --> 00:30:47,430
create a<font color="#E5E5E5"> TCP server</font>

774
00:30:44,400 --> 00:30:48,180
wait for connections<font color="#E5E5E5"> and we can use</font>

775
00:30:47,430 --> 00:30:51,450
<font color="#CCCCCC">scouts</font>

776
00:30:48,180 --> 00:30:54,240
<font color="#E5E5E5">Python agent to connect to the agent to</font>

777
00:30:51,450 --> 00:30:56,940
<font color="#CCCCCC">the server</font><font color="#E5E5E5"> send our instructions to read</font>

778
00:30:54,240 --> 00:30:59,190
<font color="#CCCCCC">RAM right now show a picture on the</font>

779
00:30:56,940 --> 00:31:01,950
<font color="#CCCCCC">screen of the printer whatever function</font>

780
00:30:59,190 --> 00:31:03,070
we<font color="#CCCCCC"> implemented you can</font><font color="#E5E5E5"> find Scout in a</font>

781
00:31:01,950 --> 00:31:05,470
bit of account

782
00:31:03,070 --> 00:31:08,620
it comes out with the<font color="#E5E5E5"> Linux kernel</font>

783
00:31:05,470 --> 00:31:12,250
driver and compilations<font color="#E5E5E5"> create tutorials</font>

784
00:31:08,620 --> 00:31:15,610
and everything you<font color="#E5E5E5"> want now that we</font>

785
00:31:12,250 --> 00:31:17,200
<font color="#E5E5E5">finally have</font><font color="#CCCCCC"> a debugger we can read the</font>

786
00:31:15,610 --> 00:31:19,120
most important thing<font color="#E5E5E5"> of them all</font>

787
00:31:17,200 --> 00:31:21,250
we covered many topics during<font color="#E5E5E5"> this talk</font>

788
00:31:19,120 --> 00:31:25,689
we haven't yet described to you how

789
00:31:21,250 --> 00:31:27,759
<font color="#CCCCCC">effects</font><font color="#E5E5E5"> actually works using</font><font color="#CCCCCC"> Scouty</font><font color="#E5E5E5"> were</font>

790
00:31:25,690 --> 00:31:29,590
able to<font color="#E5E5E5"> dynamically reverse-engineer the</font>

791
00:31:27,759 --> 00:31:32,580
<font color="#CCCCCC">female we learned how effects actually</font>

792
00:31:29,590 --> 00:31:36,340
<font color="#E5E5E5">works and let me now describe it to you</font>

793
00:31:32,580 --> 00:31:38,470
<font color="#E5E5E5">in order</font><font color="#CCCCCC"> to send a fax we need a modem</font>

794
00:31:36,340 --> 00:31:41,199
<font color="#E5E5E5">we needed to send something to the</font>

795
00:31:38,470 --> 00:31:43,179
receivers modem our packets are<font color="#E5E5E5"> going to</font>

796
00:31:41,200 --> 00:31:45,759
be<font color="#E5E5E5"> transferred to the main CPU to be</font>

797
00:31:43,179 --> 00:31:48,399
handled in a t30 same machine and later

798
00:31:45,759 --> 00:31:52,000
on the data<font color="#E5E5E5"> received will be processed</font>

799
00:31:48,399 --> 00:31:53,949
and<font color="#E5E5E5"> printed when we start the connection</font>

800
00:31:52,000 --> 00:31:56,769
between the two<font color="#E5E5E5"> modems we have several</font>

801
00:31:53,950 --> 00:31:59,230
phases in phase a we have network

802
00:31:56,769 --> 00:32:02,649
interaction we have probing and bridging

803
00:31:59,230 --> 00:32:04,899
we have echo canceller and training<font color="#E5E5E5"> we</font>

804
00:32:02,649 --> 00:32:07,809
have<font color="#E5E5E5"> additional training</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it should</font>

805
00:32:04,899 --> 00:32:10,090
be quite<font color="#CCCCCC"> familiar to you</font><font color="#E5E5E5"> we don't have</font>

806
00:32:07,809 --> 00:32:15,250
sound with<font color="#CCCCCC"> all so yeah</font><font color="#E5E5E5"> it's the beeping</font>

807
00:32:10,090 --> 00:32:17,320
sound you hear<font color="#E5E5E5"> when you send faxes these</font>

808
00:32:15,250 --> 00:32:19,960
phases are used in order<font color="#CCCCCC"> to</font><font color="#E5E5E5"> create an</font>

809
00:32:17,320 --> 00:32:23,080
<font color="#E5E5E5">hdl-c tunnel over this tunnel this</font>

810
00:32:19,960 --> 00:32:26,350
<font color="#E5E5E5">tunnel our t 30 messages will be</font><font color="#CCCCCC"> sent as</font>

811
00:32:23,080 --> 00:32:28,750
<font color="#E5E5E5">hdl-c datagrams from our and modem to</font>

812
00:32:26,350 --> 00:32:31,539
<font color="#E5E5E5">the receivers</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> so now we can actually</font>

813
00:32:28,750 --> 00:32:35,470
send T 30 messages<font color="#E5E5E5"> to be handled by the</font>

814
00:32:31,539 --> 00:32:37,870
CPU in<font color="#CCCCCC"> T 30 we</font><font color="#E5E5E5"> have they say which you</font>

815
00:32:35,470 --> 00:32:40,090
send the caller ID and<font color="#CCCCCC"> my phone number</font>

816
00:32:37,870 --> 00:32:42,399
or evil attacker<font color="#E5E5E5"> whatever string you</font>

817
00:32:40,090 --> 00:32:45,639
like in phase B we handshake

818
00:32:42,399 --> 00:32:48,789
capabilities so<font color="#CCCCCC"> we could support the</font>

819
00:32:45,639 --> 00:32:51,639
best<font color="#CCCCCC"> common capabilities for</font><font color="#E5E5E5"> the faxes</font>

820
00:32:48,789 --> 00:32:53,679
<font color="#CCCCCC">the vision</font><font color="#E5E5E5"> faces the most important</font>

821
00:32:51,639 --> 00:32:56,320
phase here is actually<font color="#E5E5E5"> send the data of</font>

822
00:32:53,679 --> 00:32:59,919
a fax document we<font color="#E5E5E5"> send it a line by line</font>

823
00:32:56,320 --> 00:33:02,049
page by page<font color="#E5E5E5"> and</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> face</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> we finished I</font>

824
00:32:59,919 --> 00:33:05,080
<font color="#E5E5E5">send</font><font color="#CCCCCC"> the akai receive</font><font color="#E5E5E5"> can we tear down</font>

825
00:33:02,049 --> 00:33:07,360
<font color="#E5E5E5">the connection let us now see</font><font color="#CCCCCC"> how a</font>

826
00:33:05,080 --> 00:33:09,789
<font color="#CCCCCC">normal black and white fax document is</font>

827
00:33:07,360 --> 00:33:11,559
going<font color="#CCCCCC"> to be sent over the protocol</font><font color="#E5E5E5"> we</font>

828
00:33:09,789 --> 00:33:14,470
have<font color="#CCCCCC"> our</font><font color="#E5E5E5"> document</font><font color="#CCCCCC"> is going to be</font>

829
00:33:11,559 --> 00:33:16,680
transferred over<font color="#E5E5E5"> the hdl-c tunnel sent</font>

830
00:33:14,470 --> 00:33:20,160
over<font color="#E5E5E5"> phase</font><font color="#CCCCCC"> c</font>

831
00:33:16,680 --> 00:33:23,160
<font color="#E5E5E5">a</font><font color="#CCCCCC"> final</font><font color="#E5E5E5"> result</font><font color="#CCCCCC"> will be this we</font><font color="#E5E5E5"> actually</font>

832
00:33:20,160 --> 00:33:26,070
sent data lines which are the data

833
00:33:23,160 --> 00:33:29,520
<font color="#CCCCCC">compares data of the</font><font color="#E5E5E5"> T file compressed</font>

834
00:33:26,070 --> 00:33:31,139
<font color="#E5E5E5">in g3 or g4 compression of teeth if you</font>

835
00:33:29,520 --> 00:33:33,690
think<font color="#CCCCCC"> that something here is missing</font>

836
00:33:31,140 --> 00:33:36,180
then you're correct<font color="#E5E5E5"> because we have no</font>

837
00:33:33,690 --> 00:33:37,800
header for the<font color="#E5E5E5"> T file the printer itself</font>

838
00:33:36,180 --> 00:33:39,960
<font color="#CCCCCC">order generates</font>

839
00:33:37,800 --> 00:33:43,080
the header of<font color="#CCCCCC"> the teeth</font><font color="#E5E5E5"> using data we</font>

840
00:33:39,960 --> 00:33:46,320
<font color="#E5E5E5">send in faces a and B of</font><font color="#CCCCCC"> the protocol</font>

841
00:33:43,080 --> 00:33:48,750
form an attackers perspective<font color="#E5E5E5"> that's</font>

842
00:33:46,320 --> 00:33:51,240
kind of bad news<font color="#CCCCCC"> TIFF parses tend to</font>

843
00:33:48,750 --> 00:33:53,490
have<font color="#CCCCCC"> owner abilities but usually need</font><font color="#E5E5E5"> to</font>

844
00:33:51,240 --> 00:33:56,100
<font color="#E5E5E5">control the teeth header to exploit them</font>

845
00:33:53,490 --> 00:33:56,630
<font color="#E5E5E5">and here we can only control the</font><font color="#CCCCCC"> data</font>

846
00:33:56,100 --> 00:33:59,428
itself

847
00:33:56,630 --> 00:34:02,280
after we finished building up if it's

848
00:33:59,429 --> 00:34:04,500
going<font color="#E5E5E5"> to be sent for printing because</font>

849
00:34:02,280 --> 00:34:08,969
that's what<font color="#CCCCCC"> normal people usually do</font>

850
00:34:04,500 --> 00:34:12,449
with<font color="#CCCCCC"> windows d30 like any other</font>

851
00:34:08,969 --> 00:34:14,549
<font color="#CCCCCC">protocols supports many extension and</font>

852
00:34:12,449 --> 00:34:17,638
extensions<font color="#E5E5E5"> and that's where it</font><font color="#CCCCCC"> becomes</font>

853
00:34:14,550 --> 00:34:21,980
really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> you know what kind</font>

854
00:34:17,639 --> 00:34:21,980
of<font color="#CCCCCC"> extensions the t30 protocol supports</font>

855
00:34:22,190 --> 00:34:29,668
well it turns out<font color="#CCCCCC"> the t30 supports color</font>

856
00:34:26,580 --> 00:34:31,770
extension well prior<font color="#CCCCCC"> to this research</font><font color="#E5E5E5"> I</font>

857
00:34:29,668 --> 00:34:34,109
<font color="#E5E5E5">didn't know that you can send</font><font color="#CCCCCC"> the</font>

858
00:34:31,770 --> 00:34:37,699
<font color="#E5E5E5">colorful fax in turns out that the</font>

859
00:34:34,110 --> 00:34:40,080
British DHS use it regularly to send

860
00:34:37,699 --> 00:34:44,699
<font color="#CCCCCC">high-quality documents of surgery</font>

861
00:34:40,080 --> 00:34:48,960
between<font color="#E5E5E5"> one hospital to another they can</font>

862
00:34:44,699 --> 00:34:51,299
<font color="#E5E5E5">use him in let us now see how colorful</font>

863
00:34:48,960 --> 00:34:53,940
fax is going to transfer<font color="#E5E5E5"> all the</font>

864
00:34:51,300 --> 00:34:57,990
protocol we have<font color="#E5E5E5"> our document</font><font color="#CCCCCC"> over the</font>

865
00:34:53,940 --> 00:35:01,050
<font color="#E5E5E5">hdl-c tunnel over</font><font color="#CCCCCC"> phase c</font><font color="#E5E5E5"> and the final</font>

866
00:34:57,990 --> 00:35:03,299
result is a dybbuk file this thing<font color="#CCCCCC"> will</font>

867
00:35:01,050 --> 00:35:06,300
<font color="#E5E5E5">control the entire</font><font color="#CCCCCC"> jpg file it's headers</font>

868
00:35:03,300 --> 00:35:10,260
and the data because a<font color="#CCCCCC"> colorful fax is</font>

869
00:35:06,300 --> 00:35:12,690
essentially a<font color="#CCCCCC"> David file and once</font>

870
00:35:10,260 --> 00:35:16,920
received<font color="#E5E5E5"> it's going to be processed and</font>

871
00:35:12,690 --> 00:35:19,890
printed now that we know how<font color="#E5E5E5"> t30 works</font>

872
00:35:16,920 --> 00:35:23,090
and how a fax works<font color="#CCCCCC"> where who should we</font>

873
00:35:19,890 --> 00:35:26,490
look for vulnerabilities<font color="#E5E5E5"> inside it well</font>

874
00:35:23,090 --> 00:35:29,730
<font color="#E5E5E5">we have a very complex for a car with</font>

875
00:35:26,490 --> 00:35:33,450
multiple layers multiple decompressions

876
00:35:29,730 --> 00:35:35,940
file formats<font color="#E5E5E5"> it exchanges strings it has</font>

877
00:35:33,450 --> 00:35:39,660
complex state machines<font color="#E5E5E5"> and essentially</font>

878
00:35:35,940 --> 00:35:42,000
the easiest layer is duplicative<font color="#E5E5E5"> one and</font>

879
00:35:39,660 --> 00:35:45,299
we chose<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> JPEG parser for</font>

880
00:35:42,000 --> 00:35:47,250
initial vulnerability research<font color="#E5E5E5"> we</font>

881
00:35:45,300 --> 00:35:49,170
control the<font color="#E5E5E5"> entire JPEG file it's much</font>

882
00:35:47,250 --> 00:35:52,050
better<font color="#E5E5E5"> than the TIFF file</font><font color="#CCCCCC"> let us now see</font>

883
00:35:49,170 --> 00:35:54,900
how JPEG looks like so those of<font color="#E5E5E5"> you who</font>

884
00:35:52,050 --> 00:35:58,830
<font color="#CCCCCC">are not familiar with JPEG here's</font><font color="#E5E5E5"> a 101</font>

885
00:35:54,900 --> 00:36:01,560
discussion<font color="#E5E5E5"> JPEG consists of markers you</font>

886
00:35:58,830 --> 00:36:05,509
<font color="#CCCCCC">have a start of image you have some</font>

887
00:36:01,560 --> 00:36:07,980
alkyl with its length field<font color="#E5E5E5"> and data</font>

888
00:36:05,510 --> 00:36:11,790
<font color="#E5E5E5">additional</font><font color="#CCCCCC"> markup with its length field</font>

889
00:36:07,980 --> 00:36:12,980
data additional<font color="#CCCCCC"> Malkiel data</font><font color="#E5E5E5"> and an end</font>

890
00:36:11,790 --> 00:36:16,320
of image module

891
00:36:12,980 --> 00:36:20,970
let's if<font color="#CCCCCC"> it's zoom in and want these</font>

892
00:36:16,320 --> 00:36:22,680
motors we can seal this our marker

893
00:36:20,970 --> 00:36:27,660
defines the forward for compression

894
00:36:22,680 --> 00:36:30,000
matrix we have our<font color="#CCCCCC"> markers opcode length</font>

895
00:36:27,660 --> 00:36:33,029
<font color="#E5E5E5">field for wave for compression matrix</font>

896
00:36:30,000 --> 00:36:39,359
and<font color="#CCCCCC"> original data</font><font color="#E5E5E5"> if we zoom in a bit</font>

897
00:36:33,030 --> 00:36:42,300
deeper we<font color="#CCCCCC"> can see that</font><font color="#E5E5E5"> we have a roughly</font>

898
00:36:39,359 --> 00:36:44,640
sparse matrix<font color="#E5E5E5"> the values of the matrix</font>

899
00:36:42,300 --> 00:36:48,030
<font color="#E5E5E5">are going to be accumulated into a</font>

900
00:36:44,640 --> 00:36:51,210
length field<font color="#E5E5E5"> and in this case it's</font><font color="#CCCCCC"> six</font>

901
00:36:48,030 --> 00:36:53,580
and<font color="#E5E5E5"> using this length field we know how</font>

902
00:36:51,210 --> 00:36:57,420
much data<font color="#E5E5E5"> we need to copy into a small</font>

903
00:36:53,580 --> 00:37:01,290
local stock<font color="#E5E5E5"> buffer and in action</font><font color="#CCCCCC"> six</font>

904
00:36:57,420 --> 00:37:03,960
bytes will be copied<font color="#CCCCCC"> to the local stock</font>

905
00:37:01,290 --> 00:37:07,050
buffer<font color="#E5E5E5"> and this point will like what</font>

906
00:37:03,960 --> 00:37:10,200
<font color="#E5E5E5">effects because we control the</font><font color="#CCCCCC"> entire</font>

907
00:37:07,050 --> 00:37:12,450
marker we can position large values in

908
00:37:10,200 --> 00:37:15,359
the matrix instead<font color="#E5E5E5"> of being sparse and</font>

909
00:37:12,450 --> 00:37:17,850
we have<font color="#E5E5E5"> 16</font><font color="#CCCCCC"> bytes</font><font color="#E5E5E5"> going to be accumulated</font>

910
00:37:15,359 --> 00:37:21,359
it's going to be roughly<font color="#CCCCCC"> 4 kilobytes</font><font color="#E5E5E5"> and</font>

911
00:37:17,850 --> 00:37:25,740
<font color="#E5E5E5">4 kilobytes of data will be copied</font><font color="#CCCCCC"> to a</font>

912
00:37:21,359 --> 00:37:30,810
small stock buffer<font color="#E5E5E5"> 256 and we have an</font>

913
00:37:25,740 --> 00:37:32,879
overflow we have a vulnerability<font color="#CCCCCC"> in the</font>

914
00:37:30,810 --> 00:37:34,710
trivial<font color="#CCCCCC"> stock-based</font><font color="#E5E5E5"> buffer overflow we</font>

915
00:37:32,880 --> 00:37:37,770
have no<font color="#CCCCCC"> constraints of our bytes</font>

916
00:37:34,710 --> 00:37:43,450
whatsoever we can use a non ASCII by its

917
00:37:37,770 --> 00:37:45,400
null by<font color="#CCCCCC"> its</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> IP</font><font color="#E5E5E5"> choose fork</font>

918
00:37:43,450 --> 00:37:48,009
<font color="#E5E5E5">veidt's of user control</font><font color="#CCCCCC"> ADA is woven</font>

919
00:37:45,400 --> 00:37:50,650
enough for in each a loader<font color="#E5E5E5"> and this</font>

920
00:37:48,010 --> 00:37:53,950
lawyer can later<font color="#CCCCCC"> on read more data</font><font color="#E5E5E5"> from</font>

921
00:37:50,650 --> 00:37:56,470
<font color="#E5E5E5">the file we sent the JPEG fax and load</font>

922
00:37:53,950 --> 00:38:00,160
whatever Molly<font color="#CCCCCC"> malware you want to the</font>

923
00:37:56,470 --> 00:38:02,140
printer when we exploit this

924
00:38:00,160 --> 00:38:03,670
vulnerability we need to bypass<font color="#E5E5E5"> several</font>

925
00:38:02,140 --> 00:38:08,859
operating<font color="#E5E5E5"> system and security</font>

926
00:38:03,670 --> 00:38:10,690
medications<font color="#E5E5E5"> um not really it's a</font>

927
00:38:08,860 --> 00:38:14,620
real-time<font color="#CCCCCC"> operating system it has a</font>

928
00:38:10,690 --> 00:38:17,820
fixed fixed<font color="#E5E5E5"> outer</font><font color="#CCCCCC"> space no</font><font color="#E5E5E5"> SLR no</font><font color="#CCCCCC"> annex</font>

929
00:38:14,620 --> 00:38:23,259
<font color="#CCCCCC">B - no</font><font color="#E5E5E5"> stack Canaries</font><font color="#CCCCCC"> it's an 80s party</font>

930
00:38:17,820 --> 00:38:26,260
<font color="#E5E5E5">school</font><font color="#CCCCCC"> really easy to exploit at this</font>

931
00:38:23,260 --> 00:38:29,140
point we contacted HP and had

932
00:38:26,260 --> 00:38:32,380
responsible disclosure process<font color="#E5E5E5"> HP issued</font>

933
00:38:29,140 --> 00:38:37,029
these two CVEs<font color="#E5E5E5"> rated as critical with a</font>

934
00:38:32,380 --> 00:38:39,340
CVC score of<font color="#CCCCCC"> 9.8 we actually flew over</font>

935
00:38:37,030 --> 00:38:42,610
to HP to help them fix it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> HP</font>

936
00:38:39,340 --> 00:38:47,110
initially<font color="#E5E5E5"> told us to fly to run to fly</font>

937
00:38:42,610 --> 00:38:49,720
to Portland<font color="#E5E5E5"> fly to Portland</font><font color="#CCCCCC"> to help them</font>

938
00:38:47,110 --> 00:38:53,440
and I couldn't<font color="#E5E5E5"> find any HP office in</font>

939
00:38:49,720 --> 00:38:55,240
Portland<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> talked to them again</font>

940
00:38:53,440 --> 00:38:58,000
<font color="#E5E5E5">and they told</font><font color="#CCCCCC"> Univ that I need to fly to</font>

941
00:38:55,240 --> 00:38:58,959
Vancouver<font color="#E5E5E5"> and we were like Vancouver</font><font color="#CCCCCC"> is</font>

942
00:38:58,000 --> 00:39:02,440
in Canada

943
00:38:58,960 --> 00:39:04,810
yeah it turns out that we need to line

944
00:39:02,440 --> 00:39:09,250
land in Portland<font color="#CCCCCC"> Drive to Vancouver</font>

945
00:39:04,810 --> 00:39:12,670
Washington<font color="#CCCCCC"> and we help</font><font color="#E5E5E5"> them fix them</font>

946
00:39:09,250 --> 00:39:16,090
vulnerable it is<font color="#CCCCCC"> past them so now it's</font>

947
00:39:12,670 --> 00:39:19,690
fixed<font color="#E5E5E5"> if you were to black hair to saw</font>

948
00:39:16,090 --> 00:39:21,550
HP's campaign the wolf<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know that HP</font>

949
00:39:19,690 --> 00:39:25,660
prides itself on the security<font color="#CCCCCC"> of its</font>

950
00:39:21,550 --> 00:39:28,420
printers and the<font color="#CCCCCC"> security</font><font color="#E5E5E5"> bulletins of</font>

951
00:39:25,660 --> 00:39:31,870
these vulnerability in states with more

952
00:39:28,420 --> 00:39:35,850
<font color="#CCCCCC">than</font><font color="#E5E5E5"> 300 different printers models are</font>

953
00:39:31,870 --> 00:39:40,210
affected many many millions of<font color="#CCCCCC"> readers</font>

954
00:39:35,850 --> 00:39:43,509
were updated<font color="#E5E5E5"> and we have a official</font>

955
00:39:40,210 --> 00:39:45,460
response from HP 1hp line of the issue

956
00:39:43,510 --> 00:39:47,440
they work<font color="#E5E5E5"> quickly to provide updates</font><font color="#CCCCCC"> or</font>

957
00:39:45,460 --> 00:39:49,420
mitigate risks HP take<font color="#E5E5E5"> secure video</font>

958
00:39:47,440 --> 00:39:51,370
seriously and<font color="#CCCCCC"> causes customer to keep</font>

959
00:39:49,420 --> 00:39:53,590
the<font color="#CCCCCC"> system updated</font><font color="#E5E5E5"> to protect against</font>

960
00:39:51,370 --> 00:39:57,769
potential vulnerabilities and that's a

961
00:39:53,590 --> 00:40:00,349
<font color="#E5E5E5">good time for our demo yes</font>

962
00:39:57,769 --> 00:40:04,038
this is this<font color="#CCCCCC"> vulnerability is working on</font>

963
00:40:00,349 --> 00:40:06,259
any HP Officejet printer<font color="#CCCCCC"> so if you have</font>

964
00:40:04,039 --> 00:40:09,049
an office jet printer at work or at home

965
00:40:06,259 --> 00:40:11,299
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> you should update and this is a</font>

966
00:40:09,049 --> 00:40:13,700
short demo<font color="#E5E5E5"> that we just made and</font><font color="#CCCCCC"> filmed</font>

967
00:40:11,299 --> 00:40:15,049
in the office so<font color="#E5E5E5"> excuse us for that the</font>

968
00:40:13,700 --> 00:40:17,930
<font color="#CCCCCC">exploit</font><font color="#E5E5E5"> is actually pretty</font><font color="#CCCCCC"> easy you just</font>

969
00:40:15,049 --> 00:40:20,509
buy a modem<font color="#CCCCCC"> in $20 in Amazon connected</font>

970
00:40:17,930 --> 00:40:23,390
<font color="#E5E5E5">press</font><font color="#CCCCCC"> enter and then the fax is sent and</font>

971
00:40:20,509 --> 00:40:26,059
this is the receiving printer<font color="#CCCCCC"> its</font>

972
00:40:23,390 --> 00:40:30,950
receiving the fax<font color="#E5E5E5"> it takes some time so</font>

973
00:40:26,059 --> 00:40:36,200
we cut the<font color="#CCCCCC"> frame here and yeah</font><font color="#E5E5E5"> fact is</font>

974
00:40:30,950 --> 00:40:41,239
received and now the<font color="#E5E5E5"> JPEG parsing is</font>

975
00:40:36,200 --> 00:40:47,450
going on here and basically that's<font color="#E5E5E5"> it</font>

976
00:40:41,239 --> 00:40:49,249
so<font color="#E5E5E5"> yeah received</font><font color="#CCCCCC"> ok yeah and we have</font>

977
00:40:47,450 --> 00:40:50,538
complete control over the window now

978
00:40:49,249 --> 00:40:52,339
that's not enough<font color="#E5E5E5"> because we wanted to</font>

979
00:40:50,539 --> 00:40:55,119
show<font color="#E5E5E5"> we can propagate</font><font color="#CCCCCC"> the network so</font>

980
00:40:52,339 --> 00:40:58,849
what we did is our fax actually included

981
00:40:55,119 --> 00:41:01,069
eternal blue in it<font color="#E5E5E5"> so once the printer</font>

982
00:40:58,849 --> 00:41:02,930
is infected<font color="#E5E5E5"> it looks for devices</font>

983
00:41:01,069 --> 00:41:04,729
connected to<font color="#E5E5E5"> it and if it finds it</font><font color="#CCCCCC"> it</font>

984
00:41:02,930 --> 00:41:10,808
will<font color="#CCCCCC"> just infect them and you will</font><font color="#E5E5E5"> see</font>

985
00:41:04,729 --> 00:41:10,808
shortly<font color="#CCCCCC"> iCal popping so yeah</font>

986
00:41:16,089 --> 00:41:20,690
yeah yeah yeah thank you<font color="#E5E5E5"> so we think</font>

987
00:41:19,190 --> 00:41:22,190
<font color="#E5E5E5">it's pretty nice as well but and now</font>

988
00:41:20,690 --> 00:41:24,770
some conclusions<font color="#E5E5E5"> and then we learn so</font>

989
00:41:22,190 --> 00:41:28,280
<font color="#CCCCCC">pstn is still</font><font color="#E5E5E5"> valid attack</font><font color="#CCCCCC"> vector in</font>

990
00:41:24,770 --> 00:41:29,930
2018<font color="#CCCCCC"> mind blowing all the outdated</font>

991
00:41:28,280 --> 00:41:32,569
protocols are probably bad<font color="#CCCCCC"> for you so</font>

992
00:41:29,930 --> 00:41:33,558
try<font color="#CCCCCC"> to</font><font color="#E5E5E5"> stay away from them and now what</font>

993
00:41:32,569 --> 00:41:35,779
can<font color="#CCCCCC"> you do first</font>

994
00:41:33,559 --> 00:41:37,250
HP issued patches<font color="#E5E5E5"> for that so if you</font>

995
00:41:35,780 --> 00:41:38,750
want<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use this link</font><font color="#E5E5E5"> and see if</font>

996
00:41:37,250 --> 00:41:40,640
your printer is<font color="#E5E5E5"> vulnerable and then</font>

997
00:41:38,750 --> 00:41:43,010
install the patches<font color="#CCCCCC"> and so on and so</font>

998
00:41:40,640 --> 00:41:45,020
forth<font color="#CCCCCC"> then you know if you</font><font color="#E5E5E5"> don't need</font>

999
00:41:43,010 --> 00:41:47,329
<font color="#CCCCCC">fax</font><font color="#E5E5E5"> don't connect it I mean it comes</font>

1000
00:41:45,020 --> 00:41:49,220
<font color="#E5E5E5">with this cable out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the box</font><font color="#CCCCCC"> you don't</font>

1001
00:41:47,329 --> 00:41:50,589
<font color="#E5E5E5">really need to connect it but if you do</font>

1002
00:41:49,220 --> 00:41:53,209
need<font color="#CCCCCC"> to connect it then maybe you know</font>

1003
00:41:50,589 --> 00:41:55,250
segregate<font color="#CCCCCC"> your printers so that if they</font>

1004
00:41:53,210 --> 00:41:57,260
will be attacked at least nobody will be

1005
00:41:55,250 --> 00:41:59,480
able<font color="#E5E5E5"> to propagate it the network and the</font>

1006
00:41:57,260 --> 00:42:01,609
attack will<font color="#CCCCCC"> be confined and now these</font>

1007
00:41:59,480 --> 00:42:03,890
<font color="#E5E5E5">are all pretty</font><font color="#CCCCCC"> good advices</font><font color="#E5E5E5"> but really</font>

1008
00:42:01,609 --> 00:42:08,598
today<font color="#E5E5E5"> the best advice I can give you is</font>

1009
00:42:03,890 --> 00:42:10,460
please stop using fax and you know I'll

1010
00:42:08,599 --> 00:42:12,140
just<font color="#E5E5E5"> finish</font><font color="#CCCCCC"> it just</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> I do I need</font>

1011
00:42:10,460 --> 00:42:13,069
to mention some friends who<font color="#E5E5E5"> really</font>

1012
00:42:12,140 --> 00:42:15,020
helped<font color="#CCCCCC"> us along the way</font>

1013
00:42:13,069 --> 00:42:17,329
they helped us<font color="#E5E5E5"> technically physically</font>

1014
00:42:15,020 --> 00:42:19,369
mentally<font color="#E5E5E5"> and they deserve some credit</font>

1015
00:42:17,329 --> 00:42:21,140
for<font color="#E5E5E5"> that so those are the guys</font><font color="#CCCCCC"> and one</font>

1016
00:42:19,369 --> 00:42:23,450
<font color="#E5E5E5">special guy</font><font color="#CCCCCC"> and I whipped us a lot with</font>

1017
00:42:21,140 --> 00:42:26,390
<font color="#E5E5E5">this thing and that's it you can follow</font>

1018
00:42:23,450 --> 00:42:29,950
us<font color="#CCCCCC"> on</font><font color="#E5E5E5"> Twitter and read out more stuff</font><font color="#CCCCCC"> on</font>

1019
00:42:26,390 --> 00:42:29,950
our<font color="#E5E5E5"> blog and thank you very much</font>

1020
00:42:33,760 --> 00:42:40,510
we went<font color="#E5E5E5"> up</font><font color="#CCCCCC"> it fantastic we're</font><font color="#E5E5E5"> we're in</font><font color="#CCCCCC"> a</font>

1021
00:42:37,810 --> 00:42:41,200
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> overtime here I think it was well</font>

1022
00:42:40,510 --> 00:42:43,750
worth it

1023
00:42:41,200 --> 00:42:45,279
let's see two<font color="#E5E5E5"> questions and then</font><font color="#CCCCCC"> we</font>

1024
00:42:43,750 --> 00:42:52,080
<font color="#E5E5E5">break for coffee which will be a short</font>

1025
00:42:45,280 --> 00:43:00,700
coffee<font color="#E5E5E5"> break</font><font color="#CCCCCC"> all Cyril questions</font>

1026
00:42:52,080 --> 00:43:01,210
<font color="#CCCCCC">everything was clear who paid</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> your</font>

1027
00:43:00,700 --> 00:43:04,210
fun

1028
00:43:01,210 --> 00:43:07,690
who paid<font color="#E5E5E5"> who paid for your fun our</font>

1029
00:43:04,210 --> 00:43:10,210
<font color="#E5E5E5">employees research over I guess a period</font>

1030
00:43:07,690 --> 00:43:19,570
of time<font color="#E5E5E5"> yes</font><font color="#CCCCCC"> and yeah</font><font color="#E5E5E5"> we have an employer</font>

1031
00:43:10,210 --> 00:43:22,780
<font color="#E5E5E5">that pays us</font><font color="#CCCCCC"> to do these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of</font>

1032
00:43:19,570 --> 00:43:25,480
these big embedded devices use a

1033
00:43:22,780 --> 00:43:27,970
software update aggregator or<font color="#E5E5E5"> service</font>

1034
00:43:25,480 --> 00:43:29,710
does HP<font color="#E5E5E5"> wanna use one</font><font color="#CCCCCC"> of these</font><font color="#E5E5E5"> that's</font>

1035
00:43:27,970 --> 00:43:32,350
what I thought<font color="#E5E5E5"> your</font><font color="#CCCCCC"> URL might be</font>

1036
00:43:29,710 --> 00:43:35,350
originally was like a place for pushing

1037
00:43:32,350 --> 00:43:36,640
firmware upgrades<font color="#E5E5E5"> so what software what</font>

1038
00:43:35,350 --> 00:43:37,900
do you mean<font color="#E5E5E5"> so like there are these</font>

1039
00:43:36,640 --> 00:43:39,190
services I can't think<font color="#E5E5E5"> of one I've</font>

1040
00:43:37,900 --> 00:43:40,900
<font color="#E5E5E5">stopped my head because I'm tired but</font>

1041
00:43:39,190 --> 00:43:42,970
<font color="#E5E5E5">they're</font><font color="#CCCCCC"> these services</font><font color="#E5E5E5"> that help you do</font>

1042
00:43:40,900 --> 00:43:45,880
upgrades<font color="#E5E5E5"> so HP would hire them and</font>

1043
00:43:42,970 --> 00:43:47,529
<font color="#E5E5E5">they've cash a lot of firmwares around</font>

1044
00:43:45,880 --> 00:43:48,730
the world and push it<font color="#E5E5E5"> onto the</font><font color="#CCCCCC"> device</font>

1045
00:43:47,530 --> 00:43:50,560
<font color="#E5E5E5">there you have no such thing they have</font>

1046
00:43:48,730 --> 00:43:52,660
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be sized it so the printer actually</font>

1047
00:43:50,560 --> 00:43:54,400
<font color="#E5E5E5">connects this FTP site download this</font>

1048
00:43:52,660 --> 00:43:55,960
file and<font color="#E5E5E5"> just does everything on its own</font>

1049
00:43:54,400 --> 00:43:58,630
there's not a couple of million printers

1050
00:43:55,960 --> 00:44:00,010
or a<font color="#E5E5E5"> couple hundred million printers I</font>

1051
00:43:58,630 --> 00:44:06,460
can tell you exactly<font color="#E5E5E5"> how many because</font>

1052
00:44:00,010 --> 00:44:09,520
they connect when they issue the<font color="#CCCCCC"> pet the</font>

1053
00:44:06,460 --> 00:44:11,440
<font color="#CCCCCC">FTP site fell down</font><font color="#E5E5E5"> because millions of</font>

1054
00:44:09,520 --> 00:44:18,280
<font color="#E5E5E5">printers contacted it to download the</font>

1055
00:44:11,440 --> 00:44:20,650
few megabytes<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right I think that's a</font>

1056
00:44:18,280 --> 00:44:27,910
<font color="#E5E5E5">very good place to end this fantastic</font>

1057
00:44:20,650 --> 00:44:30,460
talk so what are you<font color="#E5E5E5"> going to do with</font>

1058
00:44:27,910 --> 00:44:32,230
the<font color="#CCCCCC"> the IP addresses of printers</font>

1059
00:44:30,460 --> 00:44:34,780
connecting to you are you<font color="#E5E5E5"> going to share</font>

1060
00:44:32,230 --> 00:44:37,000
that for cleaning up because<font color="#CCCCCC"> I hear</font><font color="#E5E5E5"> not</font>

1061
00:44:34,780 --> 00:44:38,590
being completely<font color="#CCCCCC"> responds</font><font color="#E5E5E5"> I'm doing</font>

1062
00:44:37,000 --> 00:44:40,480
<font color="#E5E5E5">nothing with it the domain is there but</font>

1063
00:44:38,590 --> 00:44:44,320
we're<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> nothing but you could help</font>

1064
00:44:40,480 --> 00:44:44,800
<font color="#E5E5E5">in cleaning up I could do a lot of</font>

1065
00:44:44,320 --> 00:44:48,870
things but

1066
00:44:44,800 --> 00:44:48,870
just a joke<font color="#E5E5E5"> I'm doing</font><font color="#CCCCCC"> nothing with it</font>

