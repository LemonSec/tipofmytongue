1
00:00:00,208 --> 00:00:06,833
 So I will get them started but
I have to go on record just
being so honored that the stage

2
00:00:06,833 --> 00:00:12,708
is staring Dustin Hoffman
presenting for us today. Give
Dustin a round of applause. >>

3
00:00:12,708 --> 00:00:23,750
Thanks that never gets old. I'll
tell you. >> [Off mic]See, if
you were not a speaker, I’d say

4
00:00:23,750 --> 00:00:31,083
fuck you… >> You can still tell
me, dude. You can tell your
friends later. The only people

5
00:00:31,083 --> 00:00:36,750
that seem to get that are really
old bank tellers or people not
from this country. Like oh,

6
00:00:36,750 --> 00:00:42,875
that's a famous actor. Hey,
thanks for coming everybody. I
appreciate you being here. You

7
00:00:42,875 --> 00:00:47,500
can be at any other talk right
now but you chose mine so I am
thankful for that. This is What

8
00:00:47,500 --> 00:00:49,917
the Watchers see, Weaknesses in
Municipal Mesh Deployments. I’m
Dustin Hoffman. >> And I'm TK.

9
00:00:49,917 --> 00:00:55,917
>> Wait. I have to talk about
me. I am my own and also a
senior engineer at an IT

10
00:01:03,417 --> 00:01:09,417
services firm and principal of
various other concerns and I
also like to cross fit so we can

11
00:01:16,083 --> 00:01:23,250
compare times and this is my
colleague TK. >> Yeah, I guess
I'm a senior engineer. We don't

12
00:01:23,250 --> 00:01:29,250
do the title thing too much but
that one seems ‑‑ we make them
up pretty much every time. I

13
00:01:31,292 --> 00:01:38,792
don't have a whole lot to say
about that apart from being the
principal of research. >> How

14
00:01:38,792 --> 00:01:44,792
this got started for us was ‑‑
excuse me for a second. Oh shit.
>>Excuse me for a second we have

15
00:01:59,500 --> 00:02:03,125
a tradition here at DEF CON.
These are first time speakers.
>> We have one first time

16
00:02:03,125 --> 00:02:09,125
speaker so they're both taking
it. But the tradition is we have
a ‑‑ we welcome new speakers by

17
00:02:18,375 --> 00:02:24,375
allowing them to enjoy a shot
with us. >> I'm going to go on
record. You do a much better job

18
00:02:27,625 --> 00:02:32,500
of pouring than Proctor. >>
Cheers gentlemen. >> Cheers.
[Applause]. >> Oh, thank you. >>

19
00:02:32,500 --> 00:02:38,500
Thank you guys. >> Carry on. >>
Thanks. So how this all got
started for us obviously in the

20
00:02:52,792 --> 00:02:57,917
post 911 world a lot of
municipalities are taking
Homeland Security money or any

21
00:02:57,917 --> 00:03:04,667
moneys available when they have
shrinking budgets and using
technology and provide security

22
00:03:04,667 --> 00:03:10,667
or oversight or surveillance
throughout their city. We
started to see these camera pods

23
00:03:23,708 --> 00:03:28,542
and there will be pictures
later. Being the curious souls
that we are, we’re curious about

24
00:03:28,542 --> 00:03:34,542
that. In certain places, my
phone, it would be like hey,
there’s an open WiFi network

25
00:03:48,042 --> 00:03:55,417
available. And they had
interesting names like Police
Department [laughter] And this

26
00:03:55,417 --> 00:04:01,417
is before the era of you know,
FBI Surveillance Van 004. This
is 2008, 2009. >>So while

27
00:04:11,667 --> 00:04:17,125
drunkenly hanging around
downtown one night a few friends
and I were wondering around and

28
00:04:17,125 --> 00:04:24,292
we find this fountain. I decide
to climb on top of it which may
not have been the wisest thing

29
00:04:24,292 --> 00:04:29,542
in the world but I did that and
here I am acting like a clown
and a voice came from above and

30
00:04:29,542 --> 00:04:35,542
said, this is the police. Please
get off the fountain. And it
sounded like it was about the

31
00:04:38,417 --> 00:04:44,417
150th time the guy said that. I
see, oh, of course the camera
pod Dustin was talking about.

32
00:04:46,917 --> 00:04:52,625
And I don't know, I guess I
wasn't really all right with
being observed so it put me on

33
00:04:52,625 --> 00:04:58,625
wanting to look at these things
and see what it's all about. You
can see the network available

34
00:05:02,083 --> 00:05:08,083
even just walking by and a
number of things we'll cover. A
little creepy. So one of the

35
00:05:11,417 --> 00:05:15,792
first things I thought of after
thinking about the fact that
even in a relatively small town

36
00:05:15,792 --> 00:05:23,125
around 70,000 people by no means
a large city, I thought of this
article that I encourage you to

37
00:05:23,125 --> 00:05:28,125
read on Wired, called
Transparent Society. Has anyone
read it,Transparent Society?

38
00:05:28,125 --> 00:05:32,417
This short story described, two
societies. Both were surveyed.
In one basically the authorities

39
00:05:32,417 --> 00:05:37,625
have the camera. In the other
every citizen has equal access
to the video and it's an

40
00:05:37,625 --> 00:05:43,625
interesting experiment. One of
the things I think civil
libertarians and people like

41
00:05:57,958 --> 00:06:04,667
myself are concerned about with
this kind of thing is the
information is asymmetric and

42
00:06:04,667 --> 00:06:09,167
certain privileged people have
access to it but people like us
don't. There's no audit trail.

43
00:06:09,167 --> 00:06:13,917
We don't know how people are
using it. So those are some
issues that we'll cover along

44
00:06:13,917 --> 00:06:19,917
with the vulnerabilities. You
might ask why are municipalities
deploying such networks. Once

45
00:06:23,875 --> 00:06:27,917
you deploy a network it's like
building a road. All kinds of
other fantastic things can

46
00:06:27,917 --> 00:06:33,917
spring up alongside it. It's
like a utility. Cities are using
them to obviously monitor

47
00:06:37,375 --> 00:06:43,667
traffic in intersections and on
main and other roads. Monitor
public spaces. They have two way

48
00:06:43,667 --> 00:06:50,167
audio. I know in the city, the
specific city that we'll be
talking about in our talk today

49
00:06:50,167 --> 00:06:58,000
they used infrared sensors to
monitor parks after hours. So if
you go to a city park after dusk

50
00:06:58,000 --> 00:07:03,750
you will get the same voice,
city parks are closed at dusk.
>> They have a real nice video

51
00:07:03,750 --> 00:07:10,167
of some kid running away. You
see him looking then scatter. >>
Presumably that's what they're

52
00:07:10,167 --> 00:07:16,208
looking for. Frequently in the
RFP's for these things you will
see cities talk about we have a

53
00:07:16,208 --> 00:07:22,750
shrinking police budget, but it
let's us be everywhere. Whether
or not everyone is okay with

54
00:07:22,750 --> 00:07:28,750
them being everywhere is another
question. I think of the
audience mated speeding ticket

55
00:07:30,792 --> 00:07:34,833
robots if you will that they
deployed in Arizona that the
voters, you know, flipped out

56
00:07:34,833 --> 00:07:39,458
about. Maybe rightly so and
complained about. If you were
speeding these devices were on

57
00:07:39,458 --> 00:07:44,292
the side of the road. Your
current speed is this an if
you're going too fast it blinks

58
00:07:44,292 --> 00:07:50,292
at you. This would read your
license plate number if you were
going too fast and mail you a

59
00:07:53,458 --> 00:08:00,125
ticket. So that's one of the
reasons the cities are deploying
things like this. Implementation

60
00:08:00,125 --> 00:08:06,125
is almost universally a mesh
network. Why not a wire network?
Nobody wants to trench. Like I

61
00:08:08,333 --> 00:08:13,500
said the budgets are shrinking.
To wireless technology a city
council or other committee has a

62
00:08:13,500 --> 00:08:18,375
dramatically lower cost. I don't
know if you've been involved in
stringing fiber. The licensing

63
00:08:18,375 --> 00:08:25,000
process and the costs are
substantial. It will easily
exceed the cost of cameras and

64
00:08:25,000 --> 00:08:31,000
what not. You can deploy much
faster. Most of them operate on
2.4 gigahertz, 5 gHz. These are

65
00:08:40,167 --> 00:08:46,167
not special. Who actually does
the install? I think this will
be a key part of our talk. You

66
00:08:50,292 --> 00:08:54,750
have specialized companies that
really focus just on
municipalities and other kinds

67
00:08:54,750 --> 00:09:00,750
of government organizations. One
in particular Leverage IS they
have special qualifications and

68
00:09:02,750 --> 00:09:07,167
basically, basically they're
able to fill out a long RFP. So
these tend to become the prime

69
00:09:07,167 --> 00:09:13,167
vendors in installs like this.
They're not technical
qualifications as you will see.

70
00:09:15,667 --> 00:09:21,667
>> Not at all. >> First picture
on their website is a smartly
dressed police woman. Presumably

71
00:09:26,875 --> 00:09:33,833
providing real‑time response to
real‑time crime. Including
climbing on fountains. If you

72
00:09:33,833 --> 00:09:39,833
look at their Twitter site which
hasn't tweeted in a year or two
they only follow other police

73
00:09:48,125 --> 00:09:54,125
agencies. Implementation
hardware itself is not terribly
interesting. Things you already

74
00:09:56,875 --> 00:10:03,375
encountered. Maybe it's just
packaged differently.
Specifically we see a lot of

75
00:10:03,375 --> 00:10:09,375
fire tight vendor. Bosch
cameras, normal DVR's. Here is
some of the equipment we picked

76
00:10:23,792 --> 00:10:29,792
up off E bay. 2.4 giga hertz
antennas here. They usually
stick these in outdoor

77
00:10:35,417 --> 00:10:43,333
enclosures. There's plenty
available on E‑bay. We don't
have a big budget for DEF CON.

78
00:10:43,333 --> 00:10:49,333
You can even on E‑bay you can
buy some units I don't know if
you can use the license but they

79
00:10:51,792 --> 00:10:57,792
have radios to operate on
restricted public services
networks. I think it's 4.9. So

80
00:11:01,375 --> 00:11:06,042
information specific to
Firetide. You should talk. >>
Well basically they're just

81
00:11:06,042 --> 00:11:13,042
little boxes and as far as the
people using them are concerned
in one end you plug in the

82
00:11:13,042 --> 00:11:18,250
Ethernet cable and the other end
and magic happens and the
package makes it to the other

83
00:11:18,250 --> 00:11:24,250
side. We did a small amount and
I have to thank you guys from
another company I worked out for

84
00:11:27,250 --> 00:11:33,250
helping me out. Jordan Hays did
indeed attend the conference.
All these guys I don't know if I

85
00:11:33,250 --> 00:11:39,250
could have done it without them.
>> My favorite story is oh you
want help for this? Oh for DEF

86
00:11:46,750 --> 00:11:48,792
CON, sure. Like this one in a
couple weeks. So thanks for
that. >> Yeah they really pulled

87
00:11:48,792 --> 00:11:50,792
it out. Well really honestly,
you know, I'm losing my track
here. We were able to find out a

88
00:11:50,792 --> 00:11:52,792
little bit of information. It
kind of looks like these things
or using something like they're

89
00:11:52,792 --> 00:11:54,792
using ‑‑ what am I looking for?
Oh man. Automated source routing
or reverse sort‑‑ I don't

90
00:11:54,792 --> 00:11:56,792
remember the name of it. In any
case where in every packet
there's a header that contains

91
00:11:56,792 --> 00:11:58,792
every single hop that the packet
must take in order to go forward
and they added on bits as well.

92
00:11:58,792 --> 00:12:00,792
Signal strength to help with
their routing so they can make
sure it's a good system that

93
00:12:00,792 --> 00:12:02,792
automatically heals itself. In
this case I think they sort of
relied on the fact that Automesh

94
00:12:02,792 --> 00:12:04,792
is sort of a trade secret and I
don't know if it's really trade
secret but they deliberately

95
00:12:04,792 --> 00:12:10,792
made it hard to understand.
Rather than actually using
security. Um, I don't know if

96
00:12:42,875 --> 00:12:46,917
there's anything we didn't
already say. >> If you use any
embedded box, any small low

97
00:12:46,917 --> 00:12:51,083
power system it's going to be
similar to this. Really the only
unique thing about Firetide as a

98
00:12:51,083 --> 00:12:53,083
vendor is they have a patented
proprietary protocol they call
Automesh. It's derived from

99
00:12:53,083 --> 00:12:55,083
other actual documented
protocols. A large amount of our
time was spent as far as we know

100
00:12:55,083 --> 00:12:57,083
with the first decoding of the
protocol. A full decoding would
permit full inter-operability.

101
00:12:57,083 --> 00:12:59,083
Typically you will see with
these deployments 2.4 gigahertz,
open standards in this case with

102
00:12:59,083 --> 00:13:01,083
Firetide equipment and uses
Automesh which is not
documented. In all the city's

103
00:13:01,083 --> 00:13:03,083
documents which you know get on
the website 2.4 is used but it's
not mentioned. They only mention

104
00:13:03,083 --> 00:13:05,083
900 megahertz and 5 gigahertz.
So it makes me wonder if you see
the sloppy implementation they

105
00:13:05,083 --> 00:13:07,083
did if they're aware the 2.4
gigahertz radios are turned on.
When we talk about mission

106
00:13:07,083 --> 00:13:09,083
general, if you don't have a
clear understanding on this with
them ‑‑ with any other network

107
00:13:09,083 --> 00:13:11,083
let's say especially a WiFi or
wired network you assume a
client node let's say streaming

108
00:13:11,083 --> 00:13:13,083
video my phone has a path to the
switch or some other more
centralized distribution point.

109
00:13:13,083 --> 00:13:15,083
With mesh you don't. All the
nodes are peers, this peer may
be able to talk to the backhaul,

110
00:13:15,083 --> 00:13:17,083
whereas this one can’t. You
don't have to string fiber to
the city. So here in the first

111
00:13:17,083 --> 00:13:19,083
example with the wire you see
all 5 outer nodes presumably are
reliable, semireliable and

112
00:13:19,083 --> 00:13:21,083
linked to the center node in a
mesh nodes can route the traffic
through other peer nodes. This

113
00:13:21,083 --> 00:13:23,083
is actually if you are ever
going to do anything malicious
scroll the city's website

114
00:13:23,083 --> 00:13:25,083
because the information they
provide is incredibly useful if
you had ill intent. This image

115
00:13:25,083 --> 00:13:27,083
is right off their website. It
documents the specific antenna
replacement and buildings they

116
00:13:27,083 --> 00:13:29,083
route off of. Is it terribly
small? Oh it is. I'm sorry.
Things you can't know before you

117
00:13:29,083 --> 00:13:31,083
get here. My apologies for the
small images. You see the camera
pods described and all the hop

118
00:13:31,083 --> 00:13:33,083
locations. From this you can
derive which antennas go where.
Like I said Automesh, not

119
00:13:33,083 --> 00:13:35,083
documented. They claim they have
19 patents to date. There's
things you can assume that it

120
00:13:35,083 --> 00:13:37,083
will do; a lot of the things
that all the other mesh
protocols will do. Link from

121
00:13:37,083 --> 00:13:40,875
node to node. From reading many,
many technical documents we
discovered it embeds things like

122
00:13:40,875 --> 00:13:44,000
each node for a particular
altitude, GPS coordinates preset
during install, things like this

123
00:13:44,000 --> 00:13:47,750
which can contribute to the idea
that with Automesh you don't
have to do as much pre

124
00:13:47,750 --> 00:13:51,333
configuration. >> So we set up
and when we're looking at the
traffic that's actually going

125
00:13:51,333 --> 00:13:56,000
out over the air it starts out
with kind of standard ‑‑ I wish
I could point at it but I can't.

126
00:13:56,000 --> 00:13:59,542
You can see it beginning there.
There's a standard issue,
headers and all that stuff and

127
00:13:59,542 --> 00:14:03,333
additionally there's an IP
header which is standard and
that points to ‑‑ oh I can

128
00:14:03,333 --> 00:14:09,333
point. How about that? That
points to the mesh IP which
looks a little weird. As far as

129
00:14:22,833 --> 00:14:28,833
I know he everything is normal
about that. The protocol is set
to 134 which is allegedly for

130
00:14:57,542 --> 00:15:03,542
RSVP. I know what follows is not
in fact RSVP. Soon then we move
on to the header right here.

131
00:15:07,292 --> 00:15:13,292
This is what actually follow
that will last IP header and the
Automesh header. And this is

132
00:15:16,125 --> 00:15:22,125
what I think is the mesh ID.
There are only very few. >>
Automesh uses this to

133
00:15:24,958 --> 00:15:31,708
specifically identify which
mesh, say you have multiple
meshes deployed in the same

134
00:15:31,708 --> 00:15:37,708
geographic region, which mesh
this node is a part of. This is
part of the Automesh secret

135
00:15:40,542 --> 00:15:48,000
sauce. This is one of the things
you define prior to deployment.
We'll talk about it later in

136
00:15:48,000 --> 00:15:54,000
more detail we believe this is
part of what most of these
deployments believe provide some

137
00:16:05,000 --> 00:16:07,333
of the security they think they
have. Specifically that it's not
documented. You can't load up

138
00:16:07,333 --> 00:16:09,833
for example Wireshark and get
very far because it chokes on
Automesh. One of our goals was

139
00:16:09,833 --> 00:16:12,125
to help that along. How many
people use Wireshark? It's super
helpful. Right? It's great. It

140
00:16:12,125 --> 00:16:14,167
chokes on some of this.
Specifically because there's no
public definition. >> We haven't

141
00:16:14,167 --> 00:16:16,500
entirely decoded it here but you
can see there's a couple fields
that are probably flagged.

142
00:16:16,500 --> 00:16:19,125
Actually the next one is ‑‑ this
right here is a unicast frame
and there's just not very much

143
00:16:19,125 --> 00:16:21,583
information. This is a broadcast
frame and I think what they've
done here is they've attached a

144
00:16:21,583 --> 00:16:24,625
little bit of information but
maybe some flooding for getting
routes and stuff like that. And

145
00:16:24,625 --> 00:16:30,625
you can see this right after the
mesh ID the last bit is 1. I was
not able to find any packets

146
00:17:00,167 --> 00:17:05,208
that had that set at 1 that was
not broadcast and you have units
here. There are a couple values

147
00:17:05,208 --> 00:17:09,417
here. This is probably some
routing info. Then there's this
chunk that comes here. This

148
00:17:09,417 --> 00:17:13,958
looks like it might be IP
addresses and this here are
definitely the IP addresses of

149
00:17:13,958 --> 00:17:19,958
external ‑‑ they match the
external IP of that first IP
header we looked at. So I assume

150
00:17:58,042 --> 00:18:04,042
it represents the idea of the
node that we're entering. Then
it goes to a multicast address.

151
00:18:12,417 --> 00:18:18,417
Conveniently they've left for
us ‑‑ oops, conveniently they
left a marker at the end that

152
00:18:25,083 --> 00:18:32,333
you can use to sort of strip
this out entirely which when
they have it unencrypted which

153
00:18:32,333 --> 00:18:35,833
they sometimes do. There's an
easy way to skip all the auto
you mesh stuff so you can look

154
00:18:35,833 --> 00:18:39,375
like we were able to send a
package across the stuff and
pull it out of the air which

155
00:18:39,375 --> 00:18:42,708
takes away their safety there
then this is just an example of
something. This is a CDP packet.

156
00:18:42,708 --> 00:18:46,750
Not much to talk about here
other than you can see that it’s
in the clear. >> Our specific

157
00:18:46,750 --> 00:18:52,750
case ‑‑ thanks for sticking
through the background. I hate
to skip ahead and not have you

158
00:18:55,042 --> 00:19:01,042
appreciate what you see in these
things. In this specific city
you see we mapped out most ‑‑ a

159
00:19:05,833 --> 00:19:11,833
lot of ‑‑ there's apparently ‑‑
how many cameras are deployed?
>> 122 I think. >> And that's

160
00:19:15,542 --> 00:19:20,125
not including what they have to
put overall the school sites.
The city and school district

161
00:19:20,125 --> 00:19:23,292
apparently joined hands and they
kind of aggregated all their
cameras together. The primarily

162
00:19:23,292 --> 00:19:26,000
collection here is downtown.
This is kind of the downtown.
Oddly enough from the time the

163
00:19:26,000 --> 00:19:28,875
initial RFP was released in 2006
until 72 hours ago the entire
system was unencrypted. So no

164
00:19:28,875 --> 00:19:32,292
WEP, nothing. So friends there's
a lot of things we can't know in
life. Like one of the things I

165
00:19:32,292 --> 00:19:38,292
try to figure out is is it
actually supposed to look like a
Wu Tang clan? The world may

166
00:19:56,708 --> 00:20:02,708
never know. In this case I'm
going to try to put myself as
best I can from servicing other

167
00:20:34,875 --> 00:20:40,875
IT clients and put myself in the
shoes of the City Manager and
maybe the people that did the

168
00:20:47,083 --> 00:20:51,458
original install. My best guess
is the Automesh alone would
provide the security because it

169
00:20:51,458 --> 00:20:55,875
was obscured. Because you
couldn't just load it up and
read it right off without

170
00:20:55,875 --> 00:21:00,833
additional efforts. It was
secure enough. I think this is
part of the problem with when we

171
00:21:00,833 --> 00:21:05,792
use words like security. I don't
know about you but I think
security is over qualified. I

172
00:21:05,792 --> 00:21:11,917
think it was said best in the
books. There's two kinds of
encryption in it is world. The

173
00:21:11,917 --> 00:21:15,708
kind that keeps your kid from
reading your diary and one that
keeps companies and

174
00:21:15,708 --> 00:21:19,792
multinationals from reading your
diary. At the end of the install
the QA manager, I'm being

175
00:21:19,792 --> 00:21:24,583
generous that there is one, they
didn't look at the form and say
is it secure? Yeah it's secure.

176
00:21:24,583 --> 00:21:30,167
We can check that box. Or it's a
matter of well I turned the knob
and the door didn't open. If you

177
00:21:30,167 --> 00:21:35,500
lean on it a little it will pop
right out. It's kind of one of
those things and I think as

178
00:21:35,500 --> 00:21:39,792
taxpayers, especially with the
next slides you want to cringe
because this was all tax money.

179
00:21:39,792 --> 00:21:42,958
This is something you and I came
out of our pockets and here we
are frankly ill served by ‑‑ you

180
00:21:42,958 --> 00:21:44,958
know I was thinking of this the
morning. I thought of the Obama
care website. Shoddy government

181
00:21:44,958 --> 00:21:49,542
contractors took a lot of money
and provided not a great
product. I feel like you will

182
00:21:49,542 --> 00:21:56,083
have shades of that repeatedly
as we go through the slides. But
72 hours ago WEP was turned on.

183
00:21:56,083 --> 00:22:02,083
So yea for government
efficiency. Right? Was it
because of our talk that was ‑‑

184
00:22:18,042 --> 00:22:24,542
I don't know. I'm going to say
it was though. I'm going to take
credit for it. Moving the bar of

185
00:22:24,542 --> 00:22:28,125
security forward. One peg at a
time. >> You should read these
later. So here's what you'll

186
00:22:28,125 --> 00:22:31,333
commonly see. These are the
camera pods watching you. Here's
a loud speaker. Right? Here's

187
00:22:31,333 --> 00:22:34,917
the little all weather
enclosures. When you see things
like this I get nervous. I have

188
00:22:34,917 --> 00:22:37,667
to wonder if, you know, those
directional antennas will
provide security. Right? They

189
00:22:37,667 --> 00:22:41,292
only send the signal to one
other place. I wonder if ‑‑
think about when you didn't know

190
00:22:41,292 --> 00:22:45,750
as much as you know. If you did
things looking back you would be
like oh yeah that was a bad

191
00:22:45,750 --> 00:22:49,375
idea. That didn't work out as
well as I thought. I have
moments like that. When I

192
00:22:49,375 --> 00:22:53,625
started the company I run now I
thought that was a really bad
idea. Not at all safe or secure.

193
00:22:53,625 --> 00:22:57,917
Maybe you got by by the skin of
your teeth. That's what happened
here. We have Automesh. Then we

194
00:22:57,917 --> 00:23:03,917
can read the video screens. We
have directional antennas. No
one else is going to see the

195
00:25:28,250 --> 00:25:32,667
Redland's police pop up. And
there's one of the Firetides
right there. Having vendor names

196
00:25:32,667 --> 00:25:37,000
here, maybe not the best idea.
They were installing another pod
right by our office and they had

197
00:25:37,000 --> 00:25:41,667
some vendor out. Like a bucket
truck. And I stopped to take
pictures because he had the door

198
00:25:41,667 --> 00:25:47,667
open to this thing. And that guy
got upset. I was trying to take
pictures with my camera. Here's

199
00:26:17,000 --> 00:26:24,042
the highest point in the city.
This 8 story building. It has
cameras ‑‑ this is the high

200
00:26:24,042 --> 00:26:29,292
point they route it back to. You
can see these things are popping
up everywhere. This picture

201
00:26:29,292 --> 00:26:35,292
makes the city look really bad.
This is more cameras. More PA
devices. I'm not sure what I

202
00:26:37,625 --> 00:26:43,625
find more obnoxious is the
cameras or PA things. This makes
it okay though because of a

203
00:26:47,625 --> 00:26:52,292
notice it's under surveillance
by the police department. I
think they have run afoul. >>

204
00:26:52,292 --> 00:26:58,292
This was not sufficient. You
have to have notifications a lot
more places than they have them.

205
00:27:04,833 --> 00:27:09,167
>> It's not exactly downtown
either. It's kind of like on one
of the ways that you can get

206
00:27:09,167 --> 00:27:14,792
into downtown. But no where
else. >> I've never seen this
sign which is weird. So as it

207
00:27:14,792 --> 00:27:19,292
was until 27 hours ago which is
not fair that I got here and
they changed it right before we

208
00:27:19,292 --> 00:27:25,292
came. So I'm so smarting on
that. Here are the security
problems and potential issues

209
00:27:28,375 --> 00:27:36,292
with having it as is. And when
you have one vendor doing the
install, I'm confident you will

210
00:27:36,292 --> 00:27:42,292
look around, when they get a
government contract they're
going to tell everybody. It

211
00:27:45,583 --> 00:27:53,000
furthers their prestige the
small community they're in.
Santa Monica has a deployment by

212
00:27:53,000 --> 00:27:59,000
them. Other cities larger than
us. So assuming like smart
people like us do that

213
00:28:01,417 --> 00:28:04,125
directional antennas and network
protocol is not enough. At the
minimum ‑‑ and I'm going to date

214
00:28:04,125 --> 00:28:06,958
myself but I was saying this
back in 98 at my last corporate
gig people will deploy wireless

215
00:28:06,958 --> 00:28:12,958
network not knowing they reach
beyond their office building or
home. All of a sudden you have

216
00:28:19,708 --> 00:28:25,708
access to the transmission
media. With the wire you have to
put a tap on it. Wireless gets

217
00:28:34,625 --> 00:28:41,042
in places you didn't plan on.
That's exactly what we have
here. Another one, how many of

218
00:28:41,042 --> 00:28:46,833
you ‑‑ this is my favorite. I'm
not sure what to do about them.
I play along but how many of you

219
00:28:46,833 --> 00:28:52,833
got my call where it's like this
is your bank center calling. Can
you read me your 16 digit

220
00:28:52,833 --> 00:28:59,458
number? I have. I'm worried
there's fraud. Right? So I
probably give it to them. Was

221
00:28:59,458 --> 00:29:05,458
anyone here at the talk the
gentlemen gave ‑‑ it deserves
more recognition then I will

222
00:29:05,458 --> 00:29:11,417
give it but they impersonated a
cell tower and there are
warnings outside the door. None

223
00:29:11,417 --> 00:29:17,667
of you were here for that? Okay.
The lights are bright. Okay.
They don't call me eagle eyes.

224
00:29:17,667 --> 00:29:24,667
So yeah. Great talk. And what
was the key thing I took away
was you don't have both parties

225
00:29:24,667 --> 00:29:30,667
authenticating each other. You
have the same thing here. With
this set up E‑bay hardware you

226
00:29:39,750 --> 00:29:45,750
can do a simpler method and you
can become a node on their mesh.
You just have to know the mesh

227
00:29:49,458 --> 00:29:55,500
ID which can be read right off
the air. That mesh ID. There's
only 256 unique combinations

228
00:29:55,500 --> 00:30:02,417
here. You read it off and you
can join their network and
participate. What can you do

229
00:30:02,417 --> 00:30:09,333
with that? If you're a member of
the mesh flower a mesh
presumably because it's wireless

230
00:30:09,333 --> 00:30:15,333
the health of the network is
changing based on fog or all
kinds of weather conditions or

231
00:30:17,458 --> 00:30:23,458
magnetic transmissions. One node
can report hey I have a great
view to the back hall. You all

232
00:30:25,667 --> 00:30:31,667
should route your traffic
through me. A node on the
network unlike a wired network

233
00:30:35,125 --> 00:30:39,833
ruled to be in the right
position. Not so with a mesh
network. You can have the

234
00:30:39,833 --> 00:30:45,250
traffic routed through you by
issuing a favorable packet.
Saying I have a fantastic link

235
00:30:45,250 --> 00:30:51,250
to that last hop you need. I
don't have to sit and sniff just
with the cameras I'm in range

236
00:30:54,625 --> 00:31:00,625
of. I can actually request all
cameras. Or whatever other city
services is present on that

237
00:31:03,583 --> 00:31:10,083
network. All the equipment
presumably also supports
encryption of their own

238
00:31:10,083 --> 00:31:16,083
transmission. Cameras, the audio
transmitters, all those do.
Never turned on. Like I said

239
00:31:21,542 --> 00:31:26,917
using a directional antenna to
secure the medium simply not
sufficient. If I'm picking it up

240
00:31:26,917 --> 00:31:33,708
while driving around a round
something is wrong. Some of you
may have worked with optical

241
00:31:33,708 --> 00:31:41,208
transmitters where you shoot a
laser to another ‑‑ to make a
wireless link. You actually have

242
00:31:41,208 --> 00:31:46,667
to get literally in between the
two, the transmitter and
receiver to pick it up. Not so

243
00:31:46,667 --> 00:31:52,667
here. Antennas leak in
directions you're not prepared
for. I mentioned a fantastic

244
00:31:54,792 --> 00:32:00,792
feature of Firetide. I really
feel bad for the city and I'm
putting the blame on the vendor.

245
00:32:04,167 --> 00:32:10,167
Firetide actually supports mesh
node authentication. PKI via
certs, there's one node on the

246
00:32:15,917 --> 00:32:23,167
mesh to all the other nodes.
It's fantastic. Not turned on.
That box didn't get checked

247
00:32:23,167 --> 00:32:29,167
apparently. Again Automesh or
any other protocol ‑‑ don't look
at my typo. Simply not

248
00:32:37,792 --> 00:32:43,792
sufficient. So really what we've
seen a botched thing. Security
is hard is it not? What do we

249
00:32:46,917 --> 00:32:51,542
see? Is it actually broken?
Certainly not. What was broken?
Someone screwed up. Someone

250
00:32:51,542 --> 00:32:57,292
thought managing it that way was
a great idea and it wasn't.
Someone thought doing something

251
00:32:57,292 --> 00:32:59,292
a novel way instead of a proven
way was a good idea and it
wasn't. Someone here thought

252
00:32:59,292 --> 00:33:02,833
they could ‑‑ because of other
things in place that it was
sufficiently secure or they

253
00:33:02,833 --> 00:33:06,833
thought security wasn't a
concern at all. We'll never
know. So really this is really

254
00:33:06,833 --> 00:33:12,833
the integrator. In some ways
it's fun to knock your local
cities or governments or what

255
00:33:19,208 --> 00:33:25,208
not but really we put so much in
the hands of private companies
who take government money and

256
00:33:37,333 --> 00:33:43,125
are supposed to provide a
service. I presume the mayor pro
tem of a small city like the one

257
00:33:43,125 --> 00:33:48,917
we're doing up here that guy ‑‑
you have to feel bad for him.
He's in no position to evaluate

258
00:33:48,917 --> 00:33:53,833
the finished product even more
than my grandmother is; should
we knock her for saying oh honey

259
00:33:53,833 --> 00:34:00,125
you have the whole internet on
your phone. What do you expect
from her? What do you expect

260
00:34:00,125 --> 00:34:06,083
something from a city mayor or
manager? They depend on the
integrator. That's who they paid

261
00:34:06,083 --> 00:34:13,000
substantial sums of money for. A
near by city was paid half a
million dollars for something

262
00:34:13,000 --> 00:34:20,583
like a handful of cameras. It
wasn't really related but it was
a recent award or proposal, half

263
00:34:20,583 --> 00:34:26,583
a million dollars. Will they get
vendor security? It's 2014. I
hope so. Is anyone in the city

264
00:34:28,625 --> 00:34:34,625
capable of evaluating that
install? I doubt it. The city of
LA, city of Chicago, city of New

265
00:34:36,917 --> 00:34:43,750
York. Sure. I would imagine so.
Is there even an IT department.
Is there anyone that can do a

266
00:34:43,750 --> 00:34:50,083
post install test? One of the
things I talk about in terms of
providing IT service toss our

267
00:34:50,083 --> 00:34:56,083
clients is do we test it in
ways ‑‑ you know, here's
something from me. Back in the

268
00:34:58,125 --> 00:35:03,583
days of going desk to desk my
last corporate gig when I set up
a new computer for an employee I

269
00:35:03,583 --> 00:35:08,500
forgot to install the printers
probably because I don't print
anything. I don't have a need to

270
00:35:08,500 --> 00:35:14,542
print out paper. I never really
have. But these people do. I
don't understand. Our clients

271
00:35:14,542 --> 00:35:20,958
print more than anybody. If that
printer isn't there I will get a
call immediately. In the same

272
00:35:20,958 --> 00:35:28,958
way I feel like we often assume
in the security world, you know,
we ‑‑ here's another one.

273
00:35:28,958 --> 00:35:34,958
Filtering services based on IP.
Right? Certainly IP’s on the
network. Did anyone actually

274
00:35:37,042 --> 00:35:43,917
test it from an IP? Did anyone
actually test it? Thank you.
That sign was clear as day.

275
00:35:43,917 --> 00:35:47,917
Thank you. I was nervous about
missing that. Did anyone
actually test it? I presume ‑‑

276
00:35:47,917 --> 00:35:54,875
I'm guessing not. I think that's
what I call the IT people,
guilty here. If we do self

277
00:35:54,875 --> 00:35:59,333
reflection we will see. We know
what we're doing. We've done it
a few times. A lot of times

278
00:35:59,333 --> 00:36:05,333
maybe. It's worth checking. I
know residents are upset that
they're being monitored all the

279
00:36:12,375 --> 00:36:19,708
time. I saw a comic recently
that said how do you want to
sell this to the American

280
00:36:19,708 --> 00:36:25,708
people. Protecting children or
fighting terrorists? They sold
this in terms of public safety

281
00:36:27,917 --> 00:36:33,625
and from there the public was
calm enough, I'm guessing people
wouldn't be happy if they found

282
00:36:33,625 --> 00:36:39,625
out their sister's brother's kid
could watch the cameras too or
perhaps much worse going through

283
00:36:47,000 --> 00:36:53,000
these potential threats beyond
just security weakness. So here
are some of the things we

284
00:36:55,000 --> 00:37:00,958
theorized and tested. These
things work. Big warning here.
Federal and states are having

285
00:37:00,958 --> 00:37:07,542
lawsuits that may apply. I'm not
a lawyer or accountant. So seek
the advice of someone that would

286
00:37:07,542 --> 00:37:15,458
know about these things like the
EFF. Don't go running afoul of
wiretapping laws. So we've

287
00:37:15,458 --> 00:37:21,000
talked about implementation like
this one prior to 72 hours ago
observing video streams is

288
00:37:21,000 --> 00:37:27,000
trivial. Or because they're
multicast you can subscribe
yourself. Why not? Like with any

289
00:37:29,708 --> 00:37:35,708
wireless system but especially
one you can participate in the
network in a meaningful way.

290
00:37:38,875 --> 00:37:43,500
There's denial service
opportunities. Simply by
flooding, always subscribing.

291
00:37:43,500 --> 00:37:51,042
Like I said these are normal off
the shelf. Nothing special.
They're not prepared to have a

292
00:37:51,042 --> 00:37:57,042
thousand bogus subscriptions.
ARP spoofing… You can become a
node on the network or the

293
00:38:04,125 --> 00:38:11,708
network video recorder. Dirty.
Dirtyer though and totally
worthy of a Doge is joining the

294
00:38:11,708 --> 00:38:17,708
mesh legitimately. There's only
256ID's. All you have to do ‑‑
you can just read it and go oh

295
00:38:21,750 --> 00:38:27,750
this is mesh number 3. Now as
far as anyone can tell you're a
legitimate node on their

296
00:38:30,375 --> 00:38:36,375
network. I'm guessing that there
aren't a lot of separation.
There isn't a lot of separation

297
00:38:40,208 --> 00:38:46,208
between these ‑‑ the cameras,
the network DVR's and the rest
of the city's networks. Often

298
00:38:49,667 --> 00:38:55,792
they left themselves wide open
to anyone who can listen or
participate in the network with

299
00:38:55,792 --> 00:39:02,583
accessing services that they're
not prepared to have public
access to. Honestly guys for the

300
00:39:02,583 --> 00:39:07,208
police department you've got ‑‑
you have to start thinking about
things like reliability. I mean

301
00:39:07,208 --> 00:39:14,625
I'm not a lawyer but it would
concern me potentially evidence
could be tampered with from

302
00:39:14,625 --> 00:39:19,208
50 miles away. >> You're
basically plugged in. You might
as well walk in. >> Find a hot

303
00:39:19,208 --> 00:39:25,208
port in your office and you can
participate in the network.
Video manipulation. Think

304
00:39:27,208 --> 00:39:33,208
Ocean's 11. You have the
security guard with all the
monitors and it's in the middle

305
00:39:38,375 --> 00:39:44,375
of the night and he's watching
and the guys you are supposed to
root for takeover one of the

306
00:39:48,833 --> 00:39:55,542
cameras and play back a loop. I
call it all is well loop. An
empty corridor. Whereas in

307
00:39:55,542 --> 00:40:01,542
reality when the camera goes all
the good guys are making their
way down the corridor. Entirely

308
00:40:05,083 --> 00:40:11,083
impossible. Videos usually is
transmitted through packets.
This is how it looks. This is my

309
00:40:14,125 --> 00:40:20,125
illustration from this morning.
You have a municipal camera
connected to the municipal DVR.

310
00:40:24,833 --> 00:40:30,833
These are packet numbers. Which
are incremented as the next
packet is sent. With a malicious

311
00:40:33,417 --> 00:40:39,417
node, thank you, with a
malicious node your own stream
all we have to do is jump ahead.

312
00:40:46,000 --> 00:40:52,333
So if the highest packet they're
on is 106 I will jump to 200. My
video packet is 200, 201, 202,

313
00:40:52,333 --> 00:40:58,333
203. Think about what happens
next. The DVR goes whoa, I’m
getting ing packets out of

314
00:41:00,750 --> 00:41:08,042
order. They've expired. I can
ignore them. I've literally now
just by incrementing the count

315
00:41:08,042 --> 00:41:15,125
have taken over and the DVR has
no reason not to, right? It's
functioning as intended because

316
00:41:15,125 --> 00:41:22,000
we're using EDP we can throw
away all the packets ‑‑ now
these packets will continue to

317
00:41:22,000 --> 00:41:28,833
arrive and they're always
ignored because somewhere along
the line you watch the traffic

318
00:41:28,833 --> 00:41:34,708
and see this happen. Packets
arrive out of order. What do you
do? You discard them. So just

319
00:41:34,708 --> 00:41:41,250
with this, just by incrementing
the UDP count you can completely
takeover the network. Here is

320
00:41:41,250 --> 00:41:47,250
the other danger. The cameras
are trusted. I mean you can say
hey let's have Godzilla walk

321
00:41:49,375 --> 00:41:54,583
down the street. Or project all
is well at the city bank but in
reality it's being robbed. I'm

322
00:41:54,583 --> 00:42:01,208
getting calls but I don't know
Frank it looks fine from here.
There's also ‑‑ you can also do

323
00:42:01,208 --> 00:42:07,208
the opposite. Send resources
else where through injecting
false data like that. Not to

324
00:42:19,333 --> 00:42:24,875
mention look I have a friend ‑‑
I don't want to identify him. I
know someone that works at

325
00:42:24,875 --> 00:42:27,958
verizon wireless. He tells me
people look at all your dirty
texts. Someone has access to

326
00:42:27,958 --> 00:42:31,250
them all. Everyone can look at
everyone's dirty pictures. Who
do we trust to look at all this

327
00:42:31,250 --> 00:42:35,333
data that's collected that's
archived? These are privacy
implications along with the

328
00:42:35,333 --> 00:42:41,333
weaknesses that go along with
it. Things that maybe not
everyone thought deeply enough

329
00:42:48,042 --> 00:42:54,042
about. Security is complicated
and it interacts with other
government things. I think some

330
00:43:01,083 --> 00:43:07,917
times we think of ourselves as
tech people and not citizens
that have to participate in the

331
00:43:07,917 --> 00:43:13,917
2014 world. So our demo is sad
because of WEP. >> Because we
can't break it. >> The person

332
00:43:22,250 --> 00:43:26,833
who writes the check to us is
now actually thinking because we
ought not try because of

333
00:43:26,833 --> 00:43:32,833
potential liability. I know we
promised a demo and I'm very
sorry. But thank you for coming

334
00:43:35,333 --> 00:43:41,417
and filling this whole room. I
think it's always a speaker's
concern that, you know, when I

335
00:43:41,417 --> 00:43:45,333
spoke two years ago there was a
really, really, really great
talk at the same time as mine

336
00:43:45,333 --> 00:43:49,583
and I walked in and half the
people bailed before I started.
So thanks so much for your

337
00:43:49,583 --> 00:43:55,583
attention. If anyone has
questions we're going to be out
front. [Applause]

