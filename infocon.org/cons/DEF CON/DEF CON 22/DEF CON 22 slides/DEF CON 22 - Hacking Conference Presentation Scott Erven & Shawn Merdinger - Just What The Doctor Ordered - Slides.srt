1
00:00:00,042 --> 00:00:04,708
>>Thanks for skipping out of
Kaminsky's talk and coming to
see, see us, we really

2
00:00:04,708 --> 00:00:11,542
appreciate that. 	Um, just want
to introduce ourselves quick. My
name's Scott Erven, I do run a

3
00:00:11,542 --> 00:00:17,875
company called SecMedic and have
been involved in IT security for
just over 15 years, with a focus

4
00:00:17,875 --> 00:00:22,417
probably the last 3 years on
medical devices and security so
that's who I am. You want to hit

5
00:00:22,417 --> 00:00:27,542
me up on Twitter, you can try
that or maybe get a hold of me
after the talk and I'll give you

6
00:00:27,542 --> 00:00:32,292
contact info. 	>> Hi everyone.
My name's Shawn Merdinger and
I've been in security for about

7
00:00:32,292 --> 00:00:38,542
a little over a decade now.
Worked at some big companies
doing healthcare, I'm sorry,

8
00:00:38,542 --> 00:00:44,292
doing product security and then
moved into some consulting and
now I do healthcare and someone

9
00:00:44,292 --> 00:00:50,250
told me they were gonna save my
spot at the summit party, so
it's still, the line is still

10
00:00:50,250 --> 00:00:54,875
going, I think. (Laughter) So
hopefully they'll hold it for
me. God, I thought that would

11
00:00:54,875 --> 00:01:02,708
get a laugh! So I also run the
MedSedic LinkedIn group which is
on LinkedIn, it's got about 600

12
00:01:02,708 --> 00:01:07,958
folks. Anyone is welcome to join
and then I have a little Twitter
account here too which is

13
00:01:07,958 --> 00:01:13,958
focused on technical issues with
medical devices and healthcare
security in general. 	>> All

14
00:01:16,417 --> 00:01:20,417
right so first off we want to
start with, you know, why we did
we get involved in research in

15
00:01:20,417 --> 00:01:24,833
medical devices. Are we just
assholes that want to call out
people or do we really have a

16
00:01:24,833 --> 00:01:29,125
vested interest in this, in
seeing that our products are
more secure? So one of the big

17
00:01:29,125 --> 00:01:35,167
things for us, you know, we
realize that healthcare industry
is behind and this isn't just

18
00:01:35,167 --> 00:01:41,042
another Android bug when we get
into these things. It really has
patient safety consequences with

19
00:01:41,042 --> 00:01:46,042
these types of devices. They are
made to save lives, and
ultimately they do a very good

20
00:01:46,042 --> 00:01:51,708
job at that. But we think that
security can get better, can
improve. And so that's why we

21
00:01:51,708 --> 00:01:56,667
are looking into the research on
that. And we also, we know there
is a lot of healthcare

22
00:01:56,667 --> 00:02:01,833
organizations that this is kind
of new to. As an industry
healthcare security is quite a

23
00:02:01,833 --> 00:02:06,500
bit behind. We'll talk about
that later. But we want to equip
defenders especially in the

24
00:02:06,500 --> 00:02:13,000
healthcare space and make sure,
you know, that they can protect
those devices and ultimately if

25
00:02:13,000 --> 00:02:17,208
you look across, you know, any
healthcare organization out
there, I think if you are

26
00:02:17,208 --> 00:02:22,917
working for one, you're gonna
find something inside of their
missions and values, right? 	And

27
00:02:22,917 --> 00:02:29,792
this is what really got to me of
how can I, you know, affect
missions and values for

28
00:02:29,792 --> 00:02:34,875
healthcare organizations? And
they're going to have something
with, you know, patient safety,

29
00:02:34,875 --> 00:02:40,333
is going to be something, one of
their critical missions, one of
their critical values or core

30
00:02:40,333 --> 00:02:45,667
beliefs that they have. 	And so
that really came to me is: How
can I have a direct impact on

31
00:02:45,667 --> 00:02:49,458
that instead of sitting in the
background, you know, as a
security guy and kind of

32
00:02:49,458 --> 00:02:54,000
indirectly being able to help
folks out on the floor deliver
patient care? This is where we

33
00:02:54,000 --> 00:02:58,542
cross into, you know, IS
security folks really having a
direct contribution to that

34
00:02:58,542 --> 00:03:03,250
mission on patient safety for
organizations. 	So it's kind of
what we're doing, you know, why

35
00:03:03,250 --> 00:03:08,208
we do it. 	>> One thing I'd add,
too, is I think we have a shared
commonality too when it comes to

36
00:03:08,208 --> 00:03:15,167
healthcare and medical devices
so no matter who you are, no
matter how spooky you are, you

37
00:03:15,167 --> 00:03:19,875
know, what kind of surveillance
you're doing or afraid of, we're
all human, we all get sick, we

38
00:03:19,875 --> 00:03:26,167
all get people in need of
healthcare and I think there is
a truly shared commonality of,

39
00:03:26,167 --> 00:03:31,125
you know, when we check into a
hospital, when we go to a
clinic, no matter who you are,

40
00:03:31,125 --> 00:03:38,875
you want to make sure that that
device has some integrity and
that you can trust it. So real

41
00:03:38,875 --> 00:03:43,875
quick, I wanna get into some of
the disclosure, too. We just
want everyone to be aware that

42
00:03:43,875 --> 00:03:49,542
the stuff in our talk has been
disclosed and we'll talk about
some of the more detailed

43
00:03:49,542 --> 00:03:54,125
disclosure processes as we go
along. This is kind of a
high-level time line so as you

44
00:03:54,125 --> 00:03:59,333
can see, we are working really
hard to push our research
quickly and we are pushing

45
00:03:59,333 --> 00:04:03,625
really hard to get it out
quickly to the community and
especially the healthcare

46
00:04:03,625 --> 00:04:08,167
organizations that, and medical
device manufacturers that can
really make, you know, make a

47
00:04:08,167 --> 00:04:14,167
change here. 	So April 30th is
when we went into this SMV
finding disclosure that we're

48
00:04:16,375 --> 00:04:24,250
gonna talk about here. And that
was the first time we disclosed
this information at DHS. We had

49
00:04:24,250 --> 00:04:31,833
a detailed briefing with them
about a week later. And then we
went into after the SMV stuff we

50
00:04:31,833 --> 00:04:36,708
decided to look at direct,
public-facing internet-exposed
medical devices and

51
00:04:36,708 --> 00:04:43,500
infrastructure and some of those
were then disclosed in May. So
again it's really recent stuff

52
00:04:43,500 --> 00:04:47,958
we have been working hard to get
the disclosure process, so we
could talk to you about it. We

53
00:04:47,958 --> 00:04:52,792
have also been providing a lot
of ongoing assistance to both
federal organizations as well

54
00:04:52,792 --> 00:04:56,583
as, you know, healthcare
organizations and manufacturers
as we work through these things

55
00:04:56,583 --> 00:05:04,042
with them. 	So... 	>> So if you
are looking for zero days, you
are in the wrong room. So that's

56
00:05:04,042 --> 00:05:09,208
not how we do this. We try to be
really responsible in all our
disclosure and all of our

57
00:05:09,208 --> 00:05:12,875
communication with this. We
don't want to put people at
risk, there is already enough

58
00:05:12,875 --> 00:05:17,833
risk in these devices that
you'll see as we get further in
the talk. And that leads into

59
00:05:17,833 --> 00:05:25,042
many of these vulnerabilities
are old, in many respects this
is a new area, for medical

60
00:05:25,042 --> 00:05:29,667
device manufacturers, and this
type of exposure because of the
integration that's happenings

61
00:05:29,667 --> 00:05:36,792
across healthcare with EHRs,
going all the way to the
bedside, there's gonna be new

62
00:05:36,792 --> 00:05:43,458
pacs surfaces that emerge. 	So
Scott did some really great work
on threat modeling with uh, and

63
00:05:43,458 --> 00:05:50,208
he'll demonstrate how it's a
very simple vulnerability was
leveraged to impact potentially

64
00:05:50,208 --> 00:05:55,417
from an adversarial standpoint
an entire organization,
including their medical devices.

65
00:05:55,417 --> 00:05:59,750
So that should be a real wakeup
call. I was a little scared
about talking about that at

66
00:05:59,750 --> 00:06:06,958
first, more because it's such a
low-level vulnerability but then
he-- 	>> Woo-hoo! 	(Laughter)

67
00:06:06,958 --> 00:06:12,958
(Applause) 	>> Let's rock it!
	>> He--, I didn't even say
cyberyet. (Laughter) Then, so

68
00:06:19,583 --> 00:06:24,250
the other thing is the medical
device exposure from the public
Internet. So as I mentioned more

69
00:06:24,250 --> 00:06:27,708
of these are coming online,
there's greater integration and
there are medical devices on the

70
00:06:27,708 --> 00:06:33,083
public Internet. We are trying
to be responsible in disclosure
but at the same time creating

71
00:06:33,083 --> 00:06:39,083
more pressure to an awareness of
this, too. 	. 	>> All right.
Taking a timeout here. 	>>

72
00:06:44,667 --> 00:06:50,667
Excuse me. (Pause) (Laughter)
Raise your hand if you are a
brand new speaker at DEF CON.

73
00:06:53,958 --> 00:07:01,250
	>> Let's go! 	>> All right.
Welcome for the new speaker!
[Cheers and applause] 	>> All

74
00:07:01,250 --> 00:07:07,250
right. All right. Solid. 	>>
God, that's just awful!
	(Laughter) 	>> So these

75
00:07:11,625 --> 00:07:17,625
external findings pose a
significant risk -- (Laughter)
-- 	>> I'll work this a little

76
00:07:19,667 --> 00:07:25,667
more. 	>> You guys are done! 	>>
All right. Yeah, so what's the
bad news here, right, in all the

77
00:07:29,333 --> 00:07:35,167
findings? The external findings
we're gonna expose, you know, we
think it is a significant risk,

78
00:07:35,167 --> 00:07:39,917
the patient safety. The medical
devices, the supporting systems
and technology that interface

79
00:07:39,917 --> 00:07:46,208
with these medical devices. The
other bad news is most of these
we found within 30 minutes to an

80
00:07:46,208 --> 00:07:51,833
hour, so you know I'm not up
here to tell you I'm some elite
hacker or anything like that,

81
00:07:51,833 --> 00:07:55,708
there's much smarter people in
this audience and we'll get into
how you can help, you know, get

82
00:07:55,708 --> 00:08:01,458
into this area later but it was
very simple things we did and
threat modeling that we did here

83
00:08:01,458 --> 00:08:07,000
but they are definitely
significant threats to patient
safety. 	They also provide

84
00:08:07,000 --> 00:08:12,208
support, the healthcare industry
is very far behind other
industries, typical of what we

85
00:08:12,208 --> 00:08:16,167
see in, you know, financial or
retail sector which they are
getting breached every week as

86
00:08:16,167 --> 00:08:20,833
well so there's not much
difference but it's not just
your bank account. It is, you

87
00:08:20,833 --> 00:08:27,375
know, patient safety issues here
that are affected. I think in
our work, you know, one of the

88
00:08:27,375 --> 00:08:34,542
things that is coming to light,
and you know the folks over at
the agency, DHS and ICS will

89
00:08:34,542 --> 00:08:40,542
probably start to tell you now,
we always thought industrial
control systems and that whole

90
00:08:43,375 --> 00:08:48,250
industry was quite a ways behind
what we are seeing. But I think
it's safe to say now and with

91
00:08:48,250 --> 00:08:51,958
the research that we're showing,
that the healthcare industry is
probably five years behind what

92
00:08:51,958 --> 00:08:56,333
that is. So it's definitely a
good ten years, we've got a lot
of catchup to do and we probably

93
00:08:56,333 --> 00:09:00,000
need to do it fairly quickly
with some of the mobile health
and digital health stuff that's

94
00:09:00,000 --> 00:09:03,333
coming on the horizon which
we'll touch on later, but.
That's definitely some of the

95
00:09:03,333 --> 00:09:09,292
bad news. So let Shawn cover the
good stuff. He can be the good
guy. 	>> Yeah, for once. You

96
00:09:09,292 --> 00:09:14,542
know, one thing I'd add, too,
with the, it's almost like a
lost decade going on here, so,

97
00:09:14,542 --> 00:09:21,000
with medical devices. 	And also
healthcare security folks are
amongst the lowest paid in the

98
00:09:21,000 --> 00:09:26,375
industry so that vertical
itself, which is I think will
actually change in the coming

99
00:09:26,375 --> 00:09:29,958
years, because there's going to
be more breaches and there's
going to be more specialized

100
00:09:29,958 --> 00:09:36,042
expertise which is needed with
these devices. 	So, yeah, there
is good news. The external risk

101
00:09:36,042 --> 00:09:43,292
can be mitigated using your
existing infrastructure in many
cases so you want to follow

102
00:09:43,292 --> 00:09:49,750
those hardening guidelines that
are put out by like MIST and
other organizations and CSI,

103
00:09:49,750 --> 00:09:55,708
right, too? Didn't we talk about
that? CIS, rather. 	>> Yeah, CSI
is a TV show. (Laughter) 	>>

104
00:09:55,708 --> 00:10:03,042
Thank you, I'm really not a
drinker so this is already
getting to me! Damn goons! 	>>

105
00:10:03,042 --> 00:10:10,625
So, yeah, CIS, you know, they've
reached out. I think we'll talk
about it a little bit later. 	>>

106
00:10:10,625 --> 00:10:18,042
Ok, yeah, we'll do that. 	>>
Bear with me. (Speaking
off-mic). 	>> So just a show of

107
00:10:18,042 --> 00:10:23,958
hands here: Who has heard of
SHODAN? Oh, that's good. That's
encouraging. So, you know,

108
00:10:23,958 --> 00:10:30,042
SHODAN was one of the main tools
that we used in this and that's
a tool you can leverage in your

109
00:10:30,042 --> 00:10:37,917
own organization and John
Matherly, props out to him, this
is his project and so, you know,

110
00:10:37,917 --> 00:10:43,250
with using those types of tools,
you can discover what types of
exposure you have on your

111
00:10:43,250 --> 00:10:49,833
external network and then you
can start doing that mitigation.
	>> All right, so I just want to

112
00:10:49,833 --> 00:10:56,125
touch kinda quickly before we
get into, you know, some of the
new stuff here, on, you know,

113
00:10:56,125 --> 00:11:01,042
previous research, more so, you
know, previous device exposure,
you know, across platforms, the

114
00:11:01,042 --> 00:11:07,375
type of things that we see, the
types of issues in these types
of devices, so first is kind of

115
00:11:07,375 --> 00:11:14,583
lab and refrigeration systems.
So that environment -- and a lot
of these, they are not unique to

116
00:11:14,583 --> 00:11:20,208
a vendor so there is no value in
saying, oh it was this vendor or
it was that vendor, it's really

117
00:11:20,208 --> 00:11:26,083
across platforms. It's a
systemic issue, it's not, you
know, one versus the other here.

118
00:11:26,083 --> 00:11:30,208
So we'll talk about them
generically and kind of give you
some architectural background

119
00:11:30,208 --> 00:11:34,375
into how these things function,
where the flaws are in these
devices where an attacker could

120
00:11:34,375 --> 00:11:39,292
potentially, you know, cause
patient safety issues. 	So
refrigeration storage, these are

121
00:11:39,292 --> 00:11:45,250
anything from, you know, storing
just blood inside the laboratory
all the way up to like full

122
00:11:45,250 --> 00:11:52,542
cryogenic like freezer levels.
The types of issues we see on
these are they have unencrypted

123
00:11:52,542 --> 00:11:57,333
web services and they have
hard-coded credentials. So the
lab techs inside the healthcare

124
00:11:57,333 --> 00:12:00,958
organization, they'll actually
carry, most times, sometimes
they'll throw it in their desk,

125
00:12:00,958 --> 00:12:06,333
but usually they'll carry pagers
that are set up to alert them if
there is like a upper or a lower

126
00:12:06,333 --> 00:12:12,167
limit on these devices that gets
tripped. So if it loses power
and the temperature drops they

127
00:12:12,167 --> 00:12:15,250
get alerted so that they can go
respond and they can throw it
into another, you know,

128
00:12:15,250 --> 00:12:20,000
refrigeration system. Well
through these web interfaces,
which either have no

129
00:12:20,000 --> 00:12:25,583
authentication into them or they
very weak credentials into them,
you can go into those types of

130
00:12:25,583 --> 00:12:29,458
systems and you can alter
things. So first you can turn
off alerting or change the

131
00:12:29,458 --> 00:12:34,250
alerting to those pager systems.
Secondly you can change upper
and lower limits on the

132
00:12:34,250 --> 00:12:38,125
temperature controls. You can
even shut these units off. So
those are the type of risks

133
00:12:38,125 --> 00:12:43,583
there, you know, spoilage,
things like that, that you get
into with those devices. 	Pacs

134
00:12:43,583 --> 00:12:48,917
imaging. You know, that's not
really a patient safety issue
too much but this is where

135
00:12:48,917 --> 00:12:53,708
you're seeing when you get into
like the PHI stuff, not
necessarily patient safety, but

136
00:12:53,708 --> 00:12:58,750
this is where I feel a lot of
the exploitation of actual
patient documentation is coming

137
00:12:58,750 --> 00:13:02,667
out of healthcare organizations.
	All but one vendor that I
researched on the paces imaging

138
00:13:02,667 --> 00:13:08,208
side, how they operate is
through an application, through
that pacs application they call

139
00:13:08,208 --> 00:13:14,333
back-in storage for those
imaging systems. Through the
application they actually prompt

140
00:13:14,333 --> 00:13:19,125
and they use authentication and
they call it and they log if
you've accessed that PHI. The

141
00:13:19,125 --> 00:13:23,583
back-end storage unfortunately
happens to be in all but one
case that I've looked at

142
00:13:23,583 --> 00:13:28,458
completely unauthenticated
access into the Nas device or
the storage network where all of

143
00:13:28,458 --> 00:13:34,375
those, you know, patient records
and images, and, you know, PHI
type information. So that's a

144
00:13:34,375 --> 00:13:38,542
big one. I think we'll loop this
Pacs thing back in later when we
start talking about some more

145
00:13:38,542 --> 00:13:43,000
exposure and how I believe, you
know, a lot of our data is being
leaked out very easily outside

146
00:13:43,000 --> 00:13:47,917
of healthcare organizations to
sell people's medical
identities. 	>> MRI and CT

147
00:13:47,917 --> 00:13:55,375
systems, you get into like nuke
med systems as well, these are
interesting. They pretty much

148
00:13:55,375 --> 00:14:01,833
function similar across the
board when you get into CT, MRI
systems. If you look at all the

149
00:14:01,833 --> 00:14:07,417
documentation you'll find that
there isn't a whole lot of
difference on them. Nuke med

150
00:14:07,417 --> 00:14:10,875
machines, they actually have
work stations that directly talk
to it but when you get into the

151
00:14:10,875 --> 00:14:15,542
radiology space, the MRI, the
CT, that's when the RAD tech is
actually sitting in the room

152
00:14:15,542 --> 00:14:20,875
behind the, you know, behind the
enclosure and how those operate
is obviously the physician

153
00:14:20,875 --> 00:14:26,542
orders what imaging they want,
and they program that order into
the application and that

154
00:14:26,542 --> 00:14:31,042
actually gets sent down to like
the CT system. And so it kinda
sits there in like a holding

155
00:14:31,042 --> 00:14:37,208
pattern. It almost functions
like a queue inside those
devices. 	But unfortunately they

156
00:14:37,208 --> 00:14:41,083
use unencrypted web traffic as
well so you can man in the
middle that traffic, you can,

157
00:14:41,083 --> 00:14:45,500
you know, alter those types of
things. They do have a failsafe
which is actually really good in

158
00:14:45,500 --> 00:14:49,708
most cases. Like the nuke meds
are direct and they don't
function like that but that's

159
00:14:49,708 --> 00:14:54,958
not real radiation exposure. But
MRI and CTs, they kinda have
like a Staples Easy button over

160
00:14:54,958 --> 00:14:58,958
at the side where the Rad tech
actually has to, you know,
manually kind of hit and then it

161
00:14:58,958 --> 00:15:03,875
goes out to the work station and
takes that queue and then
processes that image. But

162
00:15:03,875 --> 00:15:08,625
because it's unencrypted and you
can man in the middle of it, you
can alter what's actually going

163
00:15:08,625 --> 00:15:13,625
on in there when they actually
execute that. Defibrillators,
this one's an interesting one,

164
00:15:13,625 --> 00:15:19,083
when you get into ICD
technology, if any of you know
who Kevin Fu is, he did a lot of

165
00:15:19,083 --> 00:15:26,083
great work, he actually
documented it out. And most of
these, they run, they run on

166
00:15:26,083 --> 00:15:31,667
telemetry so they run at like a
400k range. The problem with
these is the pacemaker

167
00:15:31,667 --> 00:15:36,417
controller systems, if you
access those, they don't require
authentication. And once you

168
00:15:36,417 --> 00:15:41,208
associate it to the implantable
defib, you can issue the command
and it will reprogram, it will

169
00:15:41,208 --> 00:15:46,500
set upper and lower sensing
limits for the device on, you
know, when to start shocking,

170
00:15:46,500 --> 00:15:51,000
you know, when to stop, when to
sense, you know, when there's a
cardiac event. And so those

171
00:15:51,000 --> 00:15:55,167
things you can also Man in the
Middle. I think Kevin Fu, if you
are really interested in the

172
00:15:55,167 --> 00:16:00,250
details of that, he did a great
job, you know, look it up. Take
a look at his research all the

173
00:16:00,250 --> 00:16:04,500
way back to 2008. There is
obviously a clinical need for
that, too, and I will bring that

174
00:16:04,500 --> 00:16:09,667
up and that's one of the
challenges that you get into
this space is you know you would

175
00:16:09,667 --> 00:16:14,000
hate for a patient to show up
and, oh, I forgot the passcode
in order to, you know, deliver a

176
00:16:14,000 --> 00:16:17,375
shot. I have to reprogram this
device. So that's the flip side
of it. It's definitely, you

177
00:16:17,375 --> 00:16:22,833
know, a challenging area.
	Externals? I'm not gonna talk
too much about those, we have a

178
00:16:22,833 --> 00:16:27,583
very detailed case example of a
specific manufacturer on
external cardiac defib that

179
00:16:27,583 --> 00:16:34,708
we're gonna release today. 	>>
It's awesome! 	(Laughter) 	>>
And infusion pumps. These are

180
00:16:34,708 --> 00:16:39,792
ones that they have web
interfaces on them, oftentimes,
you know, no authentication or

181
00:16:39,792 --> 00:16:46,542
weak credentials, they also have
accessible services. Medical
device integration, this is an

182
00:16:46,542 --> 00:16:52,125
interesting one. So
historically, you know, some of
the very critical, life-saving

183
00:16:52,125 --> 00:16:56,792
medical devices that were out
there. So ventilators,
anesthesia carts, things like

184
00:16:56,792 --> 00:17:01,500
that, they historically and for
a reason, weren't ever
networked, right? So they just

185
00:17:01,500 --> 00:17:07,500
did serial interfaces and things
like that; they weren't put on a
network. Well, Affordable Care

186
00:17:10,958 --> 00:17:14,500
Act and things like that, and
having to pump all this data to
a centralized location in order

187
00:17:14,500 --> 00:17:17,333
to do BigData analytics on
healthcare populations we have
decided that we needed to

188
00:17:17,333 --> 00:17:23,042
integrate life support equipment
so we have gone with medical
device integration vendors, a

189
00:17:23,042 --> 00:17:26,833
lot of healthcare organizations
are doing this now and it's
bringing in these critical

190
00:17:26,833 --> 00:17:30,792
devices onto the network,
reading those vital signs and
then ultimately transferring

191
00:17:30,792 --> 00:17:35,750
off. Again completely
unencrypted. No encryption. You
can Man in the Middle that. You

192
00:17:35,750 --> 00:17:40,500
can actually replay it. They do
use unique identifiers but you
can correlate it all the way

193
00:17:40,500 --> 00:17:47,250
through from the unique
identifier back to the patient.
Whoops. 	>> So these are pretty

194
00:17:47,250 --> 00:17:53,375
much the top risks that we've
identified so far. Just across
these systems and again there's

195
00:17:53,375 --> 00:17:58,542
nothing terribly sexy about
this, right? We've seen this for
years. A hard-coded privileged

196
00:17:58,542 --> 00:18:05,208
accounts. It never goes away.
It's gonna be here forever.
Unencrypted web apps and then

197
00:18:05,208 --> 00:18:10,750
all kinds of API calls and then
back-end services like Scott
mentioned earlier with the Pacs

198
00:18:10,750 --> 00:18:16,708
systems going to the storage
interfaces. 	And then, you know,
many of these systems are built

199
00:18:16,708 --> 00:18:20,333
off of COTS equipment, so
they're just using medical
device manufacturers, they're

200
00:18:20,333 --> 00:18:26,333
using your standard, maybe an
embedded Windows or VX works or
a Windows 2003 or 2008 server--

201
00:18:29,542 --> 00:18:35,542
	>> XP or 2000. We'll kind of
touch on that as we go through
examples too. (Speaking

202
00:18:40,417 --> 00:18:47,375
off-mic). 	>> Yeah, or embedded.
All over, yeah. Right. So
they're not OS experts and

203
00:18:47,375 --> 00:18:51,750
typically they are not removing
the excessive services that are
on these operating systems and

204
00:18:51,750 --> 00:18:56,250
then there's the patching. So
we'll talk about the patching
issues more but there's a real

205
00:18:56,250 --> 00:19:00,583
misconception out there about
there about hey you can't patch
medical devices and that is just

206
00:19:00,583 --> 00:19:06,667
is not true. 	The FDA, there's
no F.B.I. here, right, they
weren't invited so-- (Laughter)

207
00:19:06,667 --> 00:19:12,250
-- The FDA has issued guidance
for the past ten years
indicating that yes, you can

208
00:19:12,250 --> 00:19:16,167
patch medical devices. But we'll
get into that later about, you
know, how you do that or should

209
00:19:16,167 --> 00:19:22,542
you do that or what are the
risks associated with that. 	>>
Yeah so that's kind of the, you

210
00:19:22,542 --> 00:19:30,042
know, first round of research,
kind of dabbled into for the
last few years. And we were

211
00:19:30,042 --> 00:19:38,000
going to kinda stop there. But
there was a lot of outreach to
that and a lot of refutal of,

212
00:19:38,000 --> 00:19:45,458
you know, points that yes, you
know, you found these issues in
medical devices but they are in

213
00:19:45,458 --> 00:19:51,833
internal networks, they're
fire-walled off from everything
else. Well, you know I called BS

214
00:19:51,833 --> 00:19:58,500
on that. It's definitely not how
it is. And so I think we wanted
to show that, you know, the

215
00:19:58,500 --> 00:20:03,458
public was really unaware, I
think, and even a lot of IS
staff, inside of healthcare

216
00:20:03,458 --> 00:20:08,583
organizations, were really
unaware of this risk, and they
truly believed that all their

217
00:20:08,583 --> 00:20:12,000
devices were fire-walled off,
that you couldn't access them
directly from the Internet.

218
00:20:12,000 --> 00:20:19,083
	This is a blurb from a private
industry notice, note that I'm
not throwing off a private

219
00:20:19,083 --> 00:20:23,458
industry notice, this was off
Google and the media got a hold
of it so don't think I'm

220
00:20:23,458 --> 00:20:28,292
throwing out one of the F.B.I.'s
hints to you guys but this is a,
you know, a good quote that kind

221
00:20:28,292 --> 00:20:33,208
of shows the biggest
vulnerability was the perception
of IT professionals healthcare

222
00:20:33,208 --> 00:20:37,000
beliefs that their current
perimeter defense and compliance
strategy are working when

223
00:20:37,000 --> 00:20:42,625
clearly the data states
otherwise. So that is kind of, I
mean, that's on an F.B.I. pin,

224
00:20:42,625 --> 00:20:47,333
so they probably should start
listening, it's just not some,
you know, guy named Scott up

225
00:20:47,333 --> 00:20:51,083
there telling you. 	>> And
respect to the F.B.I. for doing
that. I mean, for stepping up,

226
00:20:51,083 --> 00:20:55,208
because if you really, you know,
cut to the chase, this is almost
kind of out of their purview

227
00:20:55,208 --> 00:21:01,000
until it gets into a criminal
matter, you know, I'm not a
lawyer but, you know, this is

228
00:21:01,000 --> 00:21:06,917
getting into the FDA and you
know, HHS and so who has
oversight of these issues? 	So

229
00:21:06,917 --> 00:21:12,083
it's great to see that the
F.B.I. is talking about this and
raising awareness. 	>> Yeah and

230
00:21:12,083 --> 00:21:16,250
physicians as well. I think
there needs to be more awareness
on that end across healthcare

231
00:21:16,250 --> 00:21:20,208
organizations, a lot of systems
get brought in from the
physicians for clinical care.

232
00:21:20,208 --> 00:21:26,000
Security is an afterthought of
that decision that's been made
and so we'll talk again a little

233
00:21:26,000 --> 00:21:30,333
further on, you know, some
involvement I have had now with,
you know, physicians in

234
00:21:30,333 --> 00:21:36,125
collaboration which is great and
we need to, you know, bring that
awareness up, all the physicians

235
00:21:36,125 --> 00:21:40,625
I talk to, they care, they just
don't know. 	>> I think really
that's where we're gonna see the

236
00:21:40,625 --> 00:21:44,833
rubber meet the road as far as
physicians, you know. They are
the ones handling and taking

237
00:21:44,833 --> 00:21:49,625
care of patients directly. They
are tremendously respected not
only in the community but within

238
00:21:49,625 --> 00:21:55,208
the organizations and they have
a lot of power. There were MD
students who were giving talks

239
00:21:55,208 --> 00:21:59,958
at this conference, we are
developing relationships with
them, we are seeing in academic

240
00:21:59,958 --> 00:22:05,750
medical centers an entire new
generation of tech-savvy
physicians getting trained so we

241
00:22:05,750 --> 00:22:10,000
need to bring these people into
the fold and explain the risks
to them and then get them on our

242
00:22:10,000 --> 00:22:16,000
side. 	>> You take this one,
Shawn. You're following this
awesome quote. 	22:21>> So

243
00:22:19,833 --> 00:22:24,667
everyone knows who Avi Rubin is,
right? I mean he's a
well-respected researcher,

244
00:22:24,667 --> 00:22:28,708
Independent Security Evaluators
, I think he's the president
there, he's definitely one of

245
00:22:28,708 --> 00:22:33,542
the founders. And I just thought
this was a wonderful quote. And,
you know, I have never seen an

246
00:22:33,542 --> 00:22:37,250
industry with more gaping holes,
if our financial industry, with
regard to security the way

247
00:22:37,250 --> 00:22:44,250
healthcare does, I would stuff
my cash in a mattress under my
bed. 	>> Yeah, so that says a

248
00:22:44,250 --> 00:22:49,333
whole lot, I think. 	>> And that
was in 2012, right, yeah, 12/25.
	>> Yeah, that was a couple

249
00:22:49,333 --> 00:22:54,250
years ago. All right. So let's
get into, like, first round of
some of the exposure when we

250
00:22:54,250 --> 00:23:00,583
started to look at
Internet-facing devices, direct
from Internet public IP. 	So we

251
00:23:00,583 --> 00:23:05,625
started to research that, right,
and we were doing some, you
know, custom really elite

252
00:23:05,625 --> 00:23:09,667
searches, like, for key words
like anesthesia that no one
would ever think of --

253
00:23:09,667 --> 00:23:15,667
(Laughter) -- and we happened to
right away within 30 minutes, we
came across something that I

254
00:23:18,958 --> 00:23:25,417
clearly knew wasn't an
anesthesia work station itself.
But we realized very quickly

255
00:23:25,417 --> 00:23:31,875
that it had SMV open and I know
who cares about SMV? I didn't
come to hear DEF CON talk about

256
00:23:31,875 --> 00:23:35,625
SMV just being open but I think
the threat modeling that we're
gonna show you is really where

257
00:23:35,625 --> 00:23:42,500
that risk is and the information
that we could extract related to
medical devices and supporting

258
00:23:42,500 --> 00:23:48,417
systems inside of the healthcare
organization. 	>> So this was
Scott's finding and we have been

259
00:23:48,417 --> 00:23:52,750
exchanging phone calls while
we're doing these searches and
I'm sure those are archived

260
00:23:52,750 --> 00:23:59,417
somewhere and perhaps someday
we'll listen to them but yeah it
was amazing, it was amazing to

261
00:23:59,417 --> 00:24:03,875
see this. Because he was like,
dude, send me this search --
he's like, did that finish

262
00:24:03,875 --> 00:24:08,208
downloading yet of off SHODAN?
I'm like, no, no, that still
hasn't finished downloading, so

263
00:24:08,208 --> 00:24:12,500
this is the results page of
what, you know, the system is
showing us. Like, no, no, so I

264
00:24:12,500 --> 00:24:17,875
had to jump on a VPS server that
has like a 10 gig or 10 meg
pipeline and you know, pull it

265
00:24:17,875 --> 00:24:25,500
down and got a quick page count
and it was like, you know, 1482
pages. 	>> Just that one of the

266
00:24:25,500 --> 00:24:30,958
thousands of organizations that
you talk about here. 	>> Yeah,
but this was one box off of one

267
00:24:30,958 --> 00:24:36,792
organization with one port open.
So it just shows, goes to show
that wow, just one exposure. 	>>

268
00:24:36,792 --> 00:24:40,500
So here is a little bit more
information on the initial
healthcare organization

269
00:24:40,500 --> 00:24:45,500
discovery. This was the first
one we found. I found it
probably like 10:30 at night and

270
00:24:45,500 --> 00:24:51,958
was calling DHS at like midnight
saying, hey, you know, we got an
issue here, took the day off the

271
00:24:51,958 --> 00:24:56,958
next day and worked all day to
find out, you know, was it just
an issue with one organization

272
00:24:56,958 --> 00:25:01,000
or was it really, you know, a
systemic issue across
healthcare, you know, and the

273
00:25:01,000 --> 00:25:05,500
hundreds and thousands of
healthcare organizations were
wide open externally? Well,

274
00:25:05,500 --> 00:25:11,458
turned out to be even though
we're using one example, the
first example that we found, you

275
00:25:11,458 --> 00:25:15,583
know, it's not just one
organization's issue. It is
across the world in many

276
00:25:15,583 --> 00:25:19,833
instances and we will show you
the statistics that we have on
that. 	But to give you an idea

277
00:25:19,833 --> 00:25:25,708
of size it was a very large U.S.
healthcare system. They had over
12,000 employees, 3,000

278
00:25:25,708 --> 00:25:30,417
physicians and you'll see when
we get into the actual medical
devices and the systems that

279
00:25:30,417 --> 00:25:34,792
communicate with these medical
devices, they did have a large
cardiovascular neuroscience

280
00:25:34,792 --> 00:25:41,833
institutions attached to those.
It exposed intelligence. When we
dump that 1500-page document

281
00:25:41,833 --> 00:25:46,583
after we finally got it
downloaded and extracted all the
raw data, it was over 68,000

282
00:25:46,583 --> 00:25:52,958
systems provided a direct attack
vector from externally anywhere
in the world, public IP, into

283
00:25:52,958 --> 00:25:58,542
those systems. Full control if
an attacker wanted it. 	It also
exposed one of the things that

284
00:25:58,542 --> 00:26:03,917
we found that, again, isn't, you
know, unique to this
organization. It's across the

285
00:26:03,917 --> 00:26:07,833
thing, is we've seen indicators
of, you know, third party
organizations that were

286
00:26:07,833 --> 00:26:12,083
connected and contracted for
certain services so, you know,
specialty services, things like

287
00:26:12,083 --> 00:26:18,542
that, that are contracted out by
other organizations. We have
seen those systems and, you

288
00:26:18,542 --> 00:26:22,625
know, names used that were
affiliated with those systems
inside of there. 	So it wasn't

289
00:26:22,625 --> 00:26:26,958
just these organizations had an
issue; they were also exposing
third party connections and

290
00:26:26,958 --> 00:26:32,083
security issues there as well.
	>> And ene thing, too, this
also exposed a lot of your

291
00:26:32,083 --> 00:26:39,083
internal business operations so
HR systems, payroll, what we
traditionally think of, of an

292
00:26:39,083 --> 00:26:44,292
attack vector and what attackers
were going for. Interestingly,
we were looking for healthcare

293
00:26:44,292 --> 00:26:50,083
and medical exposure here so
there was PHRs and all that but
it was, yeah, it was

294
00:26:50,083 --> 00:26:55,750
disconcerting to see all that
business process systems
exposure as well. 	>> Yeah, so I

295
00:26:55,750 --> 00:26:58,667
think that's a good point.
'Cause it definitely wasn't, you
know, our focus was on, you

296
00:26:58,667 --> 00:27:02,875
know, medical devices,
healthcare infrastructure,
things on patient safety but

297
00:27:02,875 --> 00:27:06,583
this was, you know, these 68,000
systems weren't just medical
devices. It was their entire

298
00:27:06,583 --> 00:27:11,250
infrastructure and so we can
give you an example on all those
medical devices and supporting

299
00:27:11,250 --> 00:27:15,250
systems that we found but we
also, if we were into talking
about that could've shown you

300
00:27:15,250 --> 00:27:19,375
just as many examples with
financial systems, payroll
systems, you know, employee-type

301
00:27:19,375 --> 00:27:25,250
confidential information as
well. 	>> So again, you know,
did we find only one? No, you

302
00:27:25,250 --> 00:27:28,542
know, we found hundreds. When
you link them together, when you
change the search term, so you

303
00:27:28,542 --> 00:27:34,542
can see right here this is a
screenshot inside of SHODAN, but
what we're doing is, so you can

304
00:27:37,167 --> 00:27:42,750
see the hits, so we are just
doing searches and then we're
using key words that would be

305
00:27:42,750 --> 00:27:46,542
associated with medical
facilities. So health stocks,
any type of like healthcare

306
00:27:46,542 --> 00:27:49,833
system that has that in their
organization name. Clinic,
hospital and medical and you can

307
00:27:49,833 --> 00:27:53,500
see the number of hits that have
this exposure. Well when you
change that into, you know,

308
00:27:53,500 --> 00:27:57,500
specialty things, like if you
change that search term to like
cardiology, or radiology, or

309
00:27:57,500 --> 00:28:02,750
urology, or pediatrics or
something like that, you're
gonna get all the organizations

310
00:28:02,750 --> 00:28:07,375
that have that inside their org
name, and then when you tie
those into the third parties

311
00:28:07,375 --> 00:28:12,667
that were affected inside of
those disclosures you end up
with, you know, thousands of

312
00:28:12,667 --> 00:28:16,375
healthcare systems that are
really affected. 	>> So what's
key to think about is, you know,

313
00:28:16,375 --> 00:28:21,875
there is a lot of specialty
small clinics so when we have
gone out and maybe got an MRI,

314
00:28:21,875 --> 00:28:26,583
you've got sent to a special,
small specialty clinic, and
these are all, you know, tied in

315
00:28:26,583 --> 00:28:31,750
with the healthcare systems,
too, and you know, the kinds of
searches we did here, with just

316
00:28:31,750 --> 00:28:36,417
the org name, if you are looking
for, you know, specific clinics
you can do those types of

317
00:28:36,417 --> 00:28:42,542
searches too, and really get
granular, even by geographic
areas. So SHODAN is a very very

318
00:28:42,542 --> 00:28:48,667
powerful tool, it's not the only
tool to use this but it was, it
was, it fit our needs and what

319
00:28:48,667 --> 00:28:54,708
we wanted to show at the time.
	>> And so here's some heat
maps. And if you haven't checked

320
00:28:54,708 --> 00:29:00,667
out SHODAN lately we had access
to the beta thanks to John, and
we actually have been able to

321
00:29:00,667 --> 00:29:05,000
work with him to do custom
searches for certain ports that
aren't publicly available just

322
00:29:05,000 --> 00:29:10,125
to dig into a little bit more
specific medical device exposure
across the Internet but these

323
00:29:10,125 --> 00:29:13,500
are some new heat maps that he
came out with so definitely go
in and, you know, check this

324
00:29:13,500 --> 00:29:18,167
out. It's kind of a neat
feature. 	It will not only show
you the heat map overlay but it

325
00:29:18,167 --> 00:29:24,375
will also show you top affected
domain names, organizations
across the world. So this is

326
00:29:24,375 --> 00:29:29,667
just some heat maps for key
words of what we did and kind of
the concentrations for high host

327
00:29:29,667 --> 00:29:36,125
down to low host count. You will
see kind of a theme here that it
is U.S.centric, I don't know how

328
00:29:36,125 --> 00:29:39,458
to spell health insurance in
Chinese if they put that in
their org name or things like

329
00:29:39,458 --> 00:29:44,750
that so I don't know if that has
to do with some of the disparate
information or not but the U.S.

330
00:29:44,750 --> 00:29:50,958
definitely is a big red dot on
all this stuff, so. 	This is one
for the clinic, as you can see.

331
00:29:50,958 --> 00:29:57,417
U.S. is still definitely top on
the list for organizations that
have this issue. Same with

332
00:29:57,417 --> 00:30:02,125
hospital. And here is the heat
map for medical. It starts
getting a little more

333
00:30:02,125 --> 00:30:08,125
interesting, China and stuff
starts getting big and red. 	One
thing we did do is we don't

334
00:30:10,333 --> 00:30:13,625
cover it in the talk but I'll
just talk about it, you know,
quickly is some of this

335
00:30:13,625 --> 00:30:17,875
customized stuff that we're
doing with SHODAN, and that was
just released as well, is X 11,

336
00:30:17,875 --> 00:30:23,208
so if you want to go and search
like Port 6,000 X 11, we did
that with John and he just

337
00:30:23,208 --> 00:30:28,708
released it publicly. So there's
a lot of unauthenticated X 11
devices. We weren't able to

338
00:30:28,708 --> 00:30:32,458
correlate it back to medical
devices so we are not talking
about it but he has released it.

339
00:30:32,458 --> 00:30:36,542
There's like 60,000 systems out
there, 30,000 of which are
completely unauthenticated

340
00:30:36,542 --> 00:30:43,708
across the Internet. 	So who
cares about SMV again? You know,
why did we skip Dan Kaminsky's

341
00:30:43,708 --> 00:30:49,083
talk to come watch a bunch of
posers talk about SMV, right?
But that's not it. It's really

342
00:30:49,083 --> 00:30:55,708
the threat model here. And why
does this matter? You know, who
cares? Well, this system and

343
00:30:55,708 --> 00:31:01,708
others like it also happen to be
Windows XP. And it's vulnerable
to MS08-067 and for those of you

344
00:31:05,292 --> 00:31:09,417
that weren't in the security
industry back then, that is you
know the exploit or the

345
00:31:09,417 --> 00:31:14,500
vulnerability that can configure
utilized. So this is old. This
is from 2008. Still have

346
00:31:14,500 --> 00:31:20,917
external-facing systems running
SMV. Also you can pop that box
direct. So this is kind of a

347
00:31:20,917 --> 00:31:25,375
host profile, the OS, just a
screen cap, obviously the
information is hidden on this

348
00:31:25,375 --> 00:31:30,375
organization. 	>> And I pushed
back against Scott on this, too,
when he first brought it to me.

349
00:31:30,375 --> 00:31:35,250
I was like this really isn't
that interesting. Once we
started looking more into the

350
00:31:35,250 --> 00:31:40,125
full exposure of this
organization and he painted the
picture for me then it became

351
00:31:40,125 --> 00:31:45,917
much clearer, and so that's what
is -- 	>> Yup, I think that's
what is coming here. So why does

352
00:31:45,917 --> 00:31:51,333
it matter and what, I'm gonna
show you here in the next slide
why does it matter. Well the SMV

353
00:31:51,333 --> 00:31:57,042
as we know, it by design is
gonna leak host names. Well who
really cares about host names

354
00:31:57,042 --> 00:32:03,167
necessarily? But what we also
realized with these healthcare
organizations is that not only

355
00:32:03,167 --> 00:32:08,542
was SMV open but read access,
anonymous read access to their
Active Directory infrastructure

356
00:32:08,542 --> 00:32:11,875
was also pulling through
directly to the internet and
exposing all this detailed

357
00:32:11,875 --> 00:32:17,083
information that allowed us to
identify, you know, specific
medical devices, not just

358
00:32:17,083 --> 00:32:21,417
medical devices themselves, but
the supporting technology
systems and applications. 	And I

359
00:32:21,417 --> 00:32:26,875
want to, I want to clarify on
that. Everyone talks to medical
devices and a lot of people may

360
00:32:26,875 --> 00:32:32,333
think that it's just, you know,
implantables or just the actual
device itself. You know, the CT

361
00:32:32,333 --> 00:32:37,042
scan or the MRI system. The
actual infusion pump. But
understand it's a large

362
00:32:37,042 --> 00:32:42,417
ecosystem here. No longer is it
just stand-alone systems. So
those work stations that they

363
00:32:42,417 --> 00:32:46,667
are using, they interact and
they have the application that
issues instructions to the

364
00:32:46,667 --> 00:32:51,042
medical device, to the patient.
So that's why, you know, all
these work stations and things

365
00:32:51,042 --> 00:32:55,042
like that are so important.
'Cause they do have direct
access to communicate with the

366
00:32:55,042 --> 00:33:01,208
medical devices through the
application. 	So leaked out host
names. And it oftentimes leaked

367
00:33:01,208 --> 00:33:06,458
out very specific information
that attacker could use. So
we'll show you some examples in

368
00:33:06,458 --> 00:33:13,667
here of, you know, the floor,
the office, physician names are
in here. And also AD policy was

369
00:33:13,667 --> 00:33:19,625
applied so like the ORs, by
design most healthcare
organizations set timeouts on

370
00:33:19,625 --> 00:33:26,250
ORs. 	>> Who are they? 	>> Yeah.
And, you know, the reason they
do that is 'cause they're all

371
00:33:26,250 --> 00:33:30,125
scrubbed up, right. I mean
that's the, you know, the reason
they don't want to be messing

372
00:33:30,125 --> 00:33:36,125
around with big clunky gloves
having to unlock it. You'll see
some examples here that shows us

373
00:33:38,417 --> 00:33:45,250
that the specific systems also
have timeout exemptions in
place. 	So let's get into, you

374
00:33:45,250 --> 00:33:48,958
know, what other systems we
found, show some examples here.
Why does this matter. Let's

375
00:33:48,958 --> 00:33:54,333
paint a picture of why, you
know, it's not just SMV but it's
really a threat model here. 	So

376
00:33:54,333 --> 00:33:59,542
over on the left you can see
those are the systems with the
lockout exemptions, so that is

377
00:33:59,542 --> 00:34:06,042
something where we know that the
screensaver time out isn't gonna
kick in so that matters, right,

378
00:34:06,042 --> 00:34:10,708
so especially in like a physical
attack scenario that we get into
later, that matters because you

379
00:34:10,708 --> 00:34:16,083
want to know what system has a
timeout exemption. 	Over on the
right, here's this customer

380
00:34:16,083 --> 00:34:20,833
happened to use Epic, please
note again this isn't a
manufacturer issue. This is just

381
00:34:20,833 --> 00:34:25,208
the organization and all these
organizations had a
misconfiguration. So this isn't

382
00:34:25,208 --> 00:34:29,500
anything that Epic or a
manufacturer can fix themselves
but this is just an example. You

383
00:34:29,500 --> 00:34:34,333
can see all their servers here,
these are used for everything
from the SQL server back end all

384
00:34:34,333 --> 00:34:39,958
the way into web servers, I
believe down there towards the
bottom, MyChart, MyChart is if

385
00:34:39,958 --> 00:34:45,375
anyone here goes as a patient to
a healthcare organization and
they use Epic, MyChart is your

386
00:34:45,375 --> 00:34:51,292
portal into all of your medical
record data. 	So that's this
organization's server. We now

387
00:34:51,292 --> 00:34:57,583
know we can hit it directly from
the net. 	All right. Let's talk
about a little bit more stuff.

388
00:34:57,583 --> 00:35:02,750
So pacs imaging. We talked about
those previously. We have seen
through our research that they

389
00:35:02,750 --> 00:35:07,000
don't require on the back end
authentication or the one
manufacturer I have ran across

390
00:35:07,000 --> 00:35:12,875
that does, the little kids over
in Roots could probably crack in
about three minutes, so it's not

391
00:35:12,875 --> 00:35:19,625
very difficult. 	So here is
radiology systems. Here is the
CT system. Pacs, you know, CT3

392
00:35:19,625 --> 00:35:25,458
right there. So that's some of
the radiology stuff. Down at the
bottom, telemetry. There's a

393
00:35:25,458 --> 00:35:31,125
couple use cases for telemetry
systems. We can't tell exactly
just off this what exactly that

394
00:35:31,125 --> 00:35:35,417
device is for. We can only
profile on this case. So
telemetry can be used for

395
00:35:35,417 --> 00:35:40,750
different things. It can be used
for infant induction systems or
wandering adult patients, those

396
00:35:40,750 --> 00:35:47,083
types of things. They use a
little armband to alert, you
know, if the mother, if the

397
00:35:47,083 --> 00:35:53,125
child are too far apart or if
one gets taken off the unit.
Telemetry is also obviously used

398
00:35:53,125 --> 00:35:57,000
and we'll show you some examples
of this, for pacemakers,
pacemaker controller type

399
00:35:57,000 --> 00:36:03,000
systems. Speaking of pacemakers,
here are some pacemakers and we
also had specific examples that

400
00:36:05,708 --> 00:36:12,250
were very labeled as pacemaker
controller. So we know that
those were the pacemaker

401
00:36:12,250 --> 00:36:16,917
controller systems inside of an
organization. We know that those
pacemaker controller systems

402
00:36:16,917 --> 00:36:23,333
don't require any type of
authentication to communicate
once they have associated to a

403
00:36:23,333 --> 00:36:28,625
implantable. You can also see
here, we have scrubbed it but
there's an example in here, of

404
00:36:28,625 --> 00:36:33,208
you can see doctor or whatever
that is and you can see those
types of examples. Specifically

405
00:36:33,208 --> 00:36:39,292
where they are at. 	Second one
there, there is pediatrics.
Nuclear medicine. Down at the

406
00:36:39,292 --> 00:36:44,042
bottom, this is when you get
into anesthesia, right.
Anesthesia OR, we know that this

407
00:36:44,042 --> 00:36:50,083
is an anesthesia work station.
The OR environment is very
controlled so thinking that you

408
00:36:50,083 --> 00:36:55,750
would have anesthesia OR labeled
separate from the anesthesia
work station that is directly

409
00:36:55,750 --> 00:37:00,042
attached to the anesthesia cart,
there is just no way, this is
definitely an anesthesia work

410
00:37:00,042 --> 00:37:04,583
station that is on the
anaesthesia cart inside of the
OR. You could hit it directly

411
00:37:04,583 --> 00:37:11,667
from the internet. 	So we found
a few of these devices, right,
you're giving us some examples,

412
00:37:11,667 --> 00:37:15,333
you're showing us some
screenshots, types of devices
that you found. 	Well, we

413
00:37:15,333 --> 00:37:21,000
didn't. We took that big log for
this specific organization of
the thousands that we found, we

414
00:37:21,000 --> 00:37:27,292
dumped out the raw data and we
started to extract that data and
we identified thousands of, you

415
00:37:27,292 --> 00:37:34,542
know, the medical devices and
those supporting systems and
those applications. 	So we used

416
00:37:34,542 --> 00:37:41,750
our favorite data extraction
tool called Excel 'cause we're
really sophisticated. 	>> He

417
00:37:41,750 --> 00:37:47,667
did. I haven't gotten my Excel
certification yet! 	(Laughter)
	>> Yeah. So this is a overview.

418
00:37:47,667 --> 00:37:52,667
So we took all that raw data, we
dumped it to Excel and then
basically what we did is we just

419
00:37:52,667 --> 00:37:56,750
did a search and a find for key
words on these types of devices.
So we did a search for

420
00:37:56,750 --> 00:38:01,625
anesthesia. There was 21 systems
that were affiliated with
anesthesia outside, inside this

421
00:38:01,625 --> 00:38:07,250
organization. Cardiology, 488.
Like I said before, they had a
very large cardiology

422
00:38:07,250 --> 00:38:13,000
institution and a nuclear
medicine, nuke med, neurology
institution as well. Infusion

423
00:38:13,000 --> 00:38:19,000
systems, found 133 systems.
MRIs, 97. The Pacs systems, 323.
So I think right here again it

424
00:38:22,833 --> 00:38:28,875
goes to the point that I don't
know, maybe healthcare security
is lax enough and poor enough

425
00:38:28,875 --> 00:38:33,917
right now that the attackers,
you know, are not using this
simple attack method to get in

426
00:38:33,917 --> 00:38:38,208
and get information on the
devices, maybe they are just
plastering everybody and they

427
00:38:38,208 --> 00:38:43,042
are able to go completely
undetected. But if not they
could do a little bit of

428
00:38:43,042 --> 00:38:47,833
research and they could find
out, hey, just this one
healthcare organization has 323

429
00:38:47,833 --> 00:38:54,958
you know, devices associated to
Pacs and imaging in some way or
another. Nuke med systems, 67,

430
00:38:54,958 --> 00:39:00,958
and ultimately on the cardiology
side 31 systems associated to
pacemakers. 	So potential

431
00:39:06,042 --> 00:39:11,833
attacks in this scenario. Threat
modeling for this SMV exposure
that leaks all of this

432
00:39:11,833 --> 00:39:17,417
information, right. We've got a
few of those. The lamest one but
still a viable option is, you

433
00:39:17,417 --> 00:39:21,208
know, physical attack. We now
know a lot of information, we
know what types of systems they

434
00:39:21,208 --> 00:39:27,083
are as a attacker. We know what
types of medical device they are
associated to. We know the

435
00:39:27,083 --> 00:39:31,500
healthcare organization and the
location, we know the floor and
the office number in lots of

436
00:39:31,500 --> 00:39:35,917
cases like I showed you and we
know if that system has a
lockout exemption. So we can now

437
00:39:35,917 --> 00:39:40,917
very strategically, right,
Shawn, we can walk in and kind
of pinpoint, we want to go to

438
00:39:40,917 --> 00:39:45,375
this floor, this office number,
we know it's a cardiology doc
that's seeing this patient, we

439
00:39:45,375 --> 00:39:49,250
want to go walk in, we know it's
got a timeout exemption, we can
probably sit down and never have

440
00:39:49,250 --> 00:39:53,750
to put in a password and get
access to that system. 	>> And
when it comes to healthcare

441
00:39:53,750 --> 00:39:58,000
organizations, you know, it's
not like walking into a finance
institution, financial

442
00:39:58,000 --> 00:40:02,375
institution where they're like a
beady-eyed banker looking at you
like you're gonna take his

443
00:40:02,375 --> 00:40:06,417
money. Healthcare organizations,
you walk in there and there's
people at the desk, hi, how can

444
00:40:06,417 --> 00:40:11,292
I help you, right? So they are
very susceptible to a number of
physical types of attacks. Plus

445
00:40:11,292 --> 00:40:16,708
you throw a lab coat on, put a
stethoscope around your neck,
you print up a badge, which you

446
00:40:16,708 --> 00:40:20,500
know, you can just easily do
just from trolling the halls and
looking to see what they look

447
00:40:20,500 --> 00:40:25,167
like, you know, it really opens
up a scary avenue of attack
because nobody really thinks

448
00:40:25,167 --> 00:40:31,875
about this. 	>> So what's the
next one that we can kind of
look at for an attack in this

449
00:40:31,875 --> 00:40:35,458
scenario on these organizations?
Obviously a phishing attack,
we're all very familiar with

450
00:40:35,458 --> 00:40:38,792
that, right? Agn, we know what
systems they are we want to
target. We know the healthcare

451
00:40:38,792 --> 00:40:43,000
organization, we know employee
names, and so we can just start
extracting email addresses for

452
00:40:43,000 --> 00:40:48,375
those employees. You know,
that's very simple to do. And we
know the host name and that's

453
00:40:48,375 --> 00:40:52,292
the key thing. We know the host
name and we know what type of
device it is. So we can write

454
00:40:52,292 --> 00:40:57,125
customized payload now that we
can deliver through a phishing
attack that once it's executed

455
00:40:57,125 --> 00:41:02,625
and once we have control on that
internal system or even from
that external-facing system that

456
00:41:02,625 --> 00:41:09,875
had MS08-067, we can directly
pivot to only hit the devices
that we want to hit. So an

457
00:41:09,875 --> 00:41:14,500
attacker can be very strategic
with this type of information,
right. They don't have to, you

458
00:41:14,500 --> 00:41:17,917
know, get a foothold and then
scan the entire network and
figure this out and be really

459
00:41:17,917 --> 00:41:23,125
noisy. They don't have to do
that. They can simply send a
phishing attack and then target

460
00:41:23,125 --> 00:41:27,875
directly toward those medical
devices. Pivot attack, this is
obviously external for those

461
00:41:27,875 --> 00:41:32,917
systems that had
vulnerabilities. MS08-067 is
just one of them. A lot of them

462
00:41:32,917 --> 00:41:38,333
are running vulnerable versions.
IIS 6 that are sitting out there
plus a lot of extra excessive

463
00:41:38,333 --> 00:41:44,125
services that are vulnerable as
well. 	We also know in this
pivot attack that's touching the

464
00:41:44,125 --> 00:41:47,792
back end network because it's
leaking all the data for
everyone of their things. It's

465
00:41:47,792 --> 00:41:52,792
also giving us read access in
the active directory. So we know
there is a hole and that there's

466
00:41:52,792 --> 00:41:57,292
a hop and that it's not
firewalled off. So again we can
create a custom payload directly

467
00:41:57,292 --> 00:42:04,833
and pivot internally. 	Targeted
attack, this one is, you know,
where you start to make the case

468
00:42:04,833 --> 00:42:11,292
for a targeted attack against a
targeted patient, those types of
scenarios, right. We can use the

469
00:42:11,292 --> 00:42:18,042
information we got over SMV so
we know the systems that are
associated. 	We also now know

470
00:42:18,042 --> 00:42:23,083
every single name of every one
of their medical record servers,
so all we have to do is

471
00:42:23,083 --> 00:42:27,583
strategically target those
specific systems once we have a
foothold in the network. So then

472
00:42:27,583 --> 00:42:31,375
an attacker can take that,
attack the medical record, get a
weak password, get a

473
00:42:31,375 --> 00:42:35,833
vulnerability and some legacy
application and we can start
correlating where the patients

474
00:42:35,833 --> 00:42:39,750
are gonna be when, and correlate
that with the SMV data of where
these devices are located and

475
00:42:39,750 --> 00:42:46,833
what type of devices they are,
and then, you know, launch an
attack. 	So, what's the good

476
00:42:46,833 --> 00:42:51,292
news out of this? I just want to
touch on this example of
healthcare organization. This

477
00:42:51,292 --> 00:42:57,292
was very positive. This is new
space DHS and ICS-CERT did
coordinate disclosure and with

478
00:43:00,500 --> 00:43:06,208
this healthcare organization
among others that we used in our
example, they did schedule a

479
00:43:06,208 --> 00:43:12,000
follow-up call. And so I did
talk with healthcare
organization and DHS. They

480
00:43:12,000 --> 00:43:19,417
actually, it was a very positive
exchange. So typically we are
dealing as security researchers,

481
00:43:19,417 --> 00:43:23,292
we are oftentimes dealing with
manufacturers, right, and we're
starting to get over those

482
00:43:23,292 --> 00:43:26,792
bounds as well, but initially,
and the first time with
everything, you know, there's a

483
00:43:26,792 --> 00:43:30,750
lot of legal land mines and pit
falls that you gotta get
through. So this was a big win

484
00:43:30,750 --> 00:43:36,292
for us, this is something that,
you know, I'm proud of. This is
the first time, you know, DHS

485
00:43:36,292 --> 00:43:39,292
says they've actually worked
with a security researcher and
an actual healthcare

486
00:43:39,292 --> 00:43:43,667
organization to expose these
risks and work through it. They
did -- (Inaudible) -- they

487
00:43:43,667 --> 00:43:47,875
showed good faith. I'm not gonna
speak to what it contains but
they did actually share their

488
00:43:47,875 --> 00:43:52,500
full incident response with me
and I went through that with
that organization so it was a

489
00:43:52,500 --> 00:43:57,167
very positive win overall in
that interaction so I want to
call that out. 	So next Shawn's

490
00:43:57,167 --> 00:44:03,167
going to talk on public Internet
facing systems and is there any
device that directly is on the

491
00:44:05,792 --> 00:44:11,042
net? 	>>I should have stayed
over there. I liked it much
better. 	So that was the first

492
00:44:11,042 --> 00:44:15,875
part. Kind of our talk here of
the SMV exposure and just bear
in mind we focused on one

493
00:44:15,875 --> 00:44:21,208
organization but we could have
done this with a number of
organizations. But just for the

494
00:44:21,208 --> 00:44:27,333
brevity and the exposure we just
did that one. So medical devices
on public Internet. I mean you

495
00:44:27,333 --> 00:44:31,583
really wouldn't think this is
the case, you know. So a public
IP address and then you have

496
00:44:31,583 --> 00:44:37,375
this medical device here, but it
is and some of these are by
design and on purpose. And what

497
00:44:37,375 --> 00:44:43,750
really makes this tricky is that
some are using cellular modems
so, and the reason is they may

498
00:44:43,750 --> 00:44:49,333
be remote clinics or they want
to separate that in some ways
from the other infrastructure,

499
00:44:49,333 --> 00:44:54,375
but what that does for, you
know, ethical researchers who
want to track down these devices

500
00:44:54,375 --> 00:44:59,417
and then ssociate that with the
healthcare organization, it
makes this very difficult for us

501
00:44:59,417 --> 00:45:05,417
to do that. So that's really
where we need to reach out, you
know, to the carriers and the

502
00:45:07,958 --> 00:45:15,250
FDA and HHS and even law
enforcement because they have
the capability to correlate

503
00:45:15,250 --> 00:45:22,375
those cellular modem addresses
and IPs to these medical
devices. 	So this is just four

504
00:45:22,375 --> 00:45:27,833
examples that we focused on of
what we found out there. And I
mean hese are publicly

505
00:45:27,833 --> 00:45:33,000
accessible on public IP,
defibrillators and those,
Scott's gonna really give you an

506
00:45:33,000 --> 00:45:40,000
excellent case study about that
later on. 	They're deployed in
ambulances and then these fetal

507
00:45:40,000 --> 00:45:45,167
infant monitoring systems which,
if you follow any of my SHODAN
talks over the past few years

508
00:45:45,167 --> 00:45:50,583
I've been yammering about, I'll
get into more of those. 	EEG
systems, so those are hooked up

509
00:45:50,583 --> 00:45:55,417
to folks at home and then
they're tied into a cellular
modem. And then of course Pacs

510
00:45:55,417 --> 00:45:59,667
and imaging systems, now the
really the interesting thing
about Pacs systems is when they

511
00:45:59,667 --> 00:46:04,833
take these MRI images of you,
they are gigantic files so
there's a storage back end, we

512
00:46:04,833 --> 00:46:09,500
talked about that, but then
transferring them is an issue
too. And then what's going on is

513
00:46:09,500 --> 00:46:14,750
there's consolidation in the
industry of analysts who are
specialized in doing this type

514
00:46:14,750 --> 00:46:21,167
of analysis. So there may be
someone working across the
country from home and doing all

515
00:46:21,167 --> 00:46:28,000
day long, you know, she's just
looking at these images and then
doing the analysis, writing up

516
00:46:28,000 --> 00:46:32,500
the report and sending that back
to the healthcare organization.
	So it makes it much easier,

517
00:46:32,500 --> 00:46:38,958
right, to just stick this out on
public IP. They can access it
directly over a web interface.

518
00:46:38,958 --> 00:46:44,375
You don't have to allocate a VPN
session to them. They are not
choking up your bandwidth and

519
00:46:44,375 --> 00:46:49,500
that kind of thing. 	More
traditional hardware
infrastructure that we found

520
00:46:49,500 --> 00:46:56,000
exposed was just your old
unauthenticated and
misconfigured Cisco devices and

521
00:46:56,000 --> 00:47:03,000
edge routers and these have been
known for years. They are really
easy to find. And then also like

522
00:47:03,000 --> 00:47:06,958
device manufacturer
infrastructure and then, you
know, these third party contract

523
00:47:06,958 --> 00:47:11,750
organizations. What I mean by
that and Scott's gonna talk a
little bit about this, too, if

524
00:47:11,750 --> 00:47:16,625
you want. But what I mean about
that is, hospitals are
tremendously complex

525
00:47:16,625 --> 00:47:20,958
organizations. So, you know,
just because there's a device on
a hospital or a healthcare

526
00:47:20,958 --> 00:47:25,833
network doesn't necessarily mean
they even own it. They may not
even know about it. And when you

527
00:47:25,833 --> 00:47:32,333
get into like academic medical
research centers you may have a
professor who is also a

528
00:47:32,333 --> 00:47:37,000
physician, so and then they have
somebody they are doing a
research project on and then

529
00:47:37,000 --> 00:47:43,000
they got this device and then
they allocate it to a public IP.
So, you know, the IT folks may

530
00:47:43,000 --> 00:47:48,500
not know about it. The security
folks typically will not know
about it at all. And so these

531
00:47:48,500 --> 00:47:53,583
things just show up on the
network. 	You have something to
say on this? 	>> Yeah, I think

532
00:47:53,583 --> 00:47:57,875
in the healthcare systems too,
understand, the one that we
found, the one that we disclosed

533
00:47:57,875 --> 00:48:03,417
to DHS, this wasn't a small
family clinic, this was a very
large healthcare organization.

534
00:48:03,417 --> 00:48:09,000
It was not the same organization
as the other example but it was
very large, they had over 13,000

535
00:48:09,000 --> 00:48:12,875
employees just to give you some
idea of size of the
organization. So it wasn't a

536
00:48:12,875 --> 00:48:17,667
small thing. Completely on/off
edge router just sitting out on
the net, all their

537
00:48:17,667 --> 00:48:23,500
infrastructure was exposed. A
lot of the manufacturer's side,
what we've seen and is

538
00:48:23,500 --> 00:48:29,583
accessible, a lot of those that
we found aren't necessarily you
know the fault of the

539
00:48:29,583 --> 00:48:35,833
manufacturer; it's really
implementation issues at the
location but some of those come

540
00:48:35,833 --> 00:48:41,042
back to poor documentation or
guidelines from the
manufacturer. 	We see some

541
00:48:41,042 --> 00:48:45,958
documentation out there that is
straight up for support reasons.
In their documentation it tells

542
00:48:45,958 --> 00:48:50,542
you open every single port on
the firewall for remote
connectivity from these vendors

543
00:48:50,542 --> 00:48:55,875
which obviously is a little
reckless. Not sure how they are
QA'g those documents, it's

544
00:48:55,875 --> 00:49:02,417
obviously not needed and some
folks are doing it. 	>> So we
got a few case studies that

545
00:49:02,417 --> 00:49:07,667
we're gonna walk through. And
this was the first reported
medical device, meaning reported

546
00:49:07,667 --> 00:49:13,292
to ICS-CERT. And I found this in
late 2012 and it was a Roche
glucose meter. So this is a

547
00:49:13,292 --> 00:49:19,333
portable glucose meter to take
blood sugar measurements and it
has this base station on there.

548
00:49:19,333 --> 00:49:23,417
And the base station just had
Telnet running but there was
authentication required for it

549
00:49:23,417 --> 00:49:28,625
but Telnet, I mean it's clear
textbook protocol. The vendor
response was awesome, hat tip to

550
00:49:28,625 --> 00:49:36,042
the Roche guys, they were all
over this, good communication,
and then really good DHS and ICS

551
00:49:36,042 --> 00:49:41,667
response on this, too. 	This
really gets more troubling. And
I alluded to the Pacs systems

552
00:49:41,667 --> 00:49:47,708
before and the reason why these
are exposed online and there are
hundreds, and even if you start

553
00:49:47,708 --> 00:49:54,000
doing different versions, really
thousands of them, and this is
just the Kodak ones. 	And so,

554
00:49:54,000 --> 00:49:59,083
you know, Scott talked about the
ecosystem before, right. So it's
easy just to think, oh the

555
00:49:59,083 --> 00:50:03,083
stand-alone medical device, and
what are the risks associated
with it? But there's a whole

556
00:50:03,083 --> 00:50:07,500
client infrastructure that comes
along with this and how do your
clients communicate with it?

557
00:50:07,500 --> 00:50:14,917
	And if you see here it's
required to use Internet
Explorer 6.0. On this system.

558
00:50:14,917 --> 00:50:18,542
	>> Yeah, that's not that
uncommon either by the way! 	>>
So it's not that uncommon but

559
00:50:18,542 --> 00:50:22,708
then you think about these
systems and okay are they
dedicating that box, you know,

560
00:50:22,708 --> 00:50:29,250
and that client browser just for
that system? Or is whomever is
using this gonna jump online and

561
00:50:29,250 --> 00:50:35,750
start looking at different sites
and get hit with a drive-by
browser attack or something bad

562
00:50:35,750 --> 00:50:42,458
through their Yahoo! e-mail. So
again, it's just perspective but
again, and these are on public

563
00:50:42,458 --> 00:50:49,542
IP. 	This fetal monitor, I've
been yakking about these for a
couple years now. And so I first

564
00:50:49,542 --> 00:50:56,542
reported these in about December
of 2012 and then there's also
been some media coverage. 	So

565
00:50:56,542 --> 00:51:02,542
these have been mentioned
specifically in mainstream media
and I haven't really had people

566
00:51:05,292 --> 00:51:10,250
reach out to me yet about these
which I was surprised because I
mean if there's one thing we can

567
00:51:10,250 --> 00:51:17,083
think about is fetal monitors,
my perspective is that you
should have the opportunity to

568
00:51:17,083 --> 00:51:23,708
be born before you get hacked,
right! 	(Laughter) That's not
too much to ask for. Okay. And

569
00:51:23,708 --> 00:51:29,708
these are the most severe, these
are the most vulnerable people
in our population. I mean you

570
00:51:29,708 --> 00:51:35,708
got a mom in bed expecting a
baby. Can't we do better than
what we're doing here with this?

571
00:51:38,042 --> 00:51:43,875
	So when Scott and I decided to
collude and do this talk I
really amped up. And I

572
00:51:43,875 --> 00:51:49,958
disclosured again to DHS, and
then went to the manufacturer
whom I'm not gonna mention the

573
00:51:49,958 --> 00:51:56,083
manufacturer, and I'm not gonna
mention the device specifics on
this but I also went to the FDA,

574
00:51:56,083 --> 00:52:00,792
the Office of Civil Rights and
the Joint Commission because I'd
gotten to the point that, you

575
00:52:00,792 --> 00:52:05,625
know, if you put these out
there, you put people at risk,
you deserve a fine. And that's

576
00:52:05,625 --> 00:52:11,625
the business side. Right. That's
when people start paying
attention. (Applause) Got to

577
00:52:15,083 --> 00:52:22,917
hit'em in the pocket. So here is
a SHODAN map of the fetal
monitors on public IP and it

578
00:52:22,917 --> 00:52:26,250
really doesn't disclose-- 	>>
That's a really crappy picture!
	>> It's a horrible picture but,

579
00:52:26,250 --> 00:52:30,875
you know, if you look in the
United States, right, you'll see
one big dot. And one big dot in

580
00:52:30,875 --> 00:52:36,917
the United States is there in
the center, you'll see a couple
down in Florida and down in

581
00:52:36,917 --> 00:52:40,000
Puerto Rico but the ones in the
U.S. you see a big dot there,
and that's because of the

582
00:52:40,000 --> 00:52:44,500
cellular modem issue, right. And
so it doesn't give you a geo--
SHODAN will not give you a

583
00:52:44,500 --> 00:52:48,042
ge0graphic location on that
cellular modem. So we got a
fetal monitor hooked up to a

584
00:52:48,042 --> 00:52:53,292
cellular modem, don't know the
organization it's affiliated
with, very very difficult to

585
00:52:53,292 --> 00:52:58,500
track that down. Anyone, and
that gets into a phone call I
had with the FDA. You know, the

586
00:52:58,500 --> 00:53:04,083
first question to the security
guy was like, oh, well, how do I
find these? I'm like, dude, call

587
00:53:04,083 --> 00:53:08,375
the F.B.I. 	>> Yeah it ends up
being just so you guys are kind
of doing your research, and are

588
00:53:08,375 --> 00:53:14,583
aware of that, it ends up in a
field like 10 miles northeast of
Potwin, Kansas, and so that

589
00:53:14,583 --> 00:53:19,000
field is actually a geographical
center of the United States. And
so anything that is not able to

590
00:53:19,000 --> 00:53:24,708
track a geolocation back to,
that is why you'll see a huge
influx outside of Potwin, Kansas

591
00:53:24,708 --> 00:53:29,042
in a field. It's not a bunch of
people out there with fetal
monitors and devices sitting.

592
00:53:29,042 --> 00:53:37,000
(Laughter) It's not a hacker
camp in the middle of the field.
	>> Kansas is so boring, you

593
00:53:37,000 --> 00:53:44,083
almost want to drive around it!
So here is some system details
on this. Now, so there's two

594
00:53:44,083 --> 00:53:48,625
different models out there
running. First is Windows 2003
server running it's running

595
00:53:48,625 --> 00:53:56,208
IIS6.0 right, 16 systems. So
doing my research on available
public documentation, you know,

596
00:53:56,208 --> 00:54:00,958
and that's another thing,
documentation control for this
on the vendor side, they get

597
00:54:00,958 --> 00:54:06,125
third party integrators, these
guys pop up an FTP server and
then the vendor documentation

598
00:54:06,125 --> 00:54:11,333
gets leaked out so then a guy
like me can come along and then
find it. Usually it's very

599
00:54:11,333 --> 00:54:16,833
tightly controlled so I knew
right away after documentation
that these 16 systems that are

600
00:54:16,833 --> 00:54:20,750
out there are behind on their
vendor updates. And props to the
vendor because on this

601
00:54:20,750 --> 00:54:24,875
particular system they are doing
a good job, they're actually
vetting the patches, they're

602
00:54:24,875 --> 00:54:29,375
upgrading systems and going up
CDs but then you get in the
situation where these are

603
00:54:29,375 --> 00:54:34,417
constantly in use and you have
to have an IT department,
upgrading them or you have to

604
00:54:34,417 --> 00:54:39,667
contract that out. You get
smaller healthcare clinics,
money is an issue. Think about

605
00:54:39,667 --> 00:54:45,250
how it is on like a Native
American reservation, right, you
know, these things are expensive

606
00:54:45,250 --> 00:54:52,500
to run. 	The second one was the
2008 server and that's IIS7.0,
by the way not all these systems

607
00:54:52,500 --> 00:54:57,292
are currently exposed online so
there's a historical context
here but over the past couple

608
00:54:57,292 --> 00:55:02,375
years I've just seen more and
more of them pop up online. So
some have been retired, some

609
00:55:02,375 --> 00:55:07,458
have been taken down. So the
remote access is done through
remote desktop web access, which

610
00:55:07,458 --> 00:55:12,333
is done through a browser or
there's a terminal services
client. And when I did raise the

611
00:55:12,333 --> 00:55:17,625
question and did get in touch
with FDA and vendor I couched
this 'cause I knew I could get

612
00:55:17,625 --> 00:55:23,667
their attention, couched it as a
HIPAA-compliant issue, not just
a public IP exposure but the way

613
00:55:23,667 --> 00:55:30,458
the communication happened with
the RDP clients. And there is
technically ways, I'm not a

614
00:55:30,458 --> 00:55:35,542
HIPAA expert, but ways to make
it HIPAA compliant, and using
the FIPS, correct FIPS, approved

615
00:55:35,542 --> 00:55:42,333
crypto levels, certificate
sharing and such but that really
wasn't documented. From what I

616
00:55:42,333 --> 00:55:46,917
saw and from other
documentation, what could have
been and, yes, so there were

617
00:55:46,917 --> 00:55:50,792
some questions about that. 	And
then again I'll give props to
the vendor, because they said

618
00:55:50,792 --> 00:55:57,042
that these should be deployed on
a secured connection, so
meaning, you know, with a VPN

619
00:55:57,042 --> 00:56:00,833
and I believe that they will be
updating their documentation.
	>> Yeah so that's one of the

620
00:56:00,833 --> 00:56:03,792
reasons we are not naming the
vendor. We don't feel that this
one is necessarily a

621
00:56:03,792 --> 00:56:10,250
manufacturer issue. If it was a
manufacturer issue and they were
actually recommending that we

622
00:56:10,250 --> 00:56:15,000
expose them, we probably would
drop their name as I will drop a
vendor name later in this

623
00:56:15,000 --> 00:56:19,250
discussion. 	>> Yeah stay tuned.
It's gonna get a little hairy.
That's all him. 	>> The FDA

624
00:56:19,250 --> 00:56:24,708
Module reports, so if you're not
familiar with the FDA, there is
a user event database that they

625
00:56:24,708 --> 00:56:29,833
have, and so what I did is
correlated, I didn't do
correlation. I went into FDA Mod

626
00:56:29,833 --> 00:56:34,417
and I was looking for anything
that could be tied to this
particular monitoring system,

627
00:56:34,417 --> 00:56:39,125
what kind of problems they've
had from the field that people
have reported. So some of those

628
00:56:39,125 --> 00:56:44,667
I saw that these alarm
capabilities have been muted or
disabled. And that led me to

629
00:56:44,667 --> 00:56:49,125
wonder, okay is this possible
that, you know, these particular
exposed devices, is there

630
00:56:49,125 --> 00:56:55,042
correlation with the FDA Mod
database in those reports that
perhaps there's an attack going

631
00:56:55,042 --> 00:57:01,667
on here that we don't know
about. It's hard to tell from
Mod and Mod reports are really,

632
00:57:01,667 --> 00:57:09,500
they're sanitized search
interfaces are horrible. 	So,
where we are today, is this is

633
00:57:09,500 --> 00:57:16,583
close to DHS. There's many on
public IP, many are running IIS
6.0. And by the way I'm able to

634
00:57:16,583 --> 00:57:21,708
tell all this from SHODAN so I
am not going to these individual
systems, I'm not connecting to

635
00:57:21,708 --> 00:57:26,458
them, I'm not looking at the
versions, I'm not scanning them.
I can derive all this

636
00:57:26,458 --> 00:57:30,875
information from SHODAN
including last scan date so
there's a historical record in

637
00:57:30,875 --> 00:57:36,208
SHODAN. The vendor did reach out
to me. We had a conference call.
They are interested in what they

638
00:57:36,208 --> 00:57:42,458
characterize as a customer
misuse case. And that is
completely accurate and really

639
00:57:42,458 --> 00:57:45,917
it's the beginning of security
researcher communication. You
know, one of their security

640
00:57:45,917 --> 00:57:50,958
people was like, yeah, I've
known about you for a few years,
you have the med sector group,

641
00:57:50,958 --> 00:57:54,333
you know, we get a little
apprehensive talking to you. And
the reason is 'cause they don't

642
00:57:54,333 --> 00:57:58,375
have have you locked in right,
I'm not a under an NDA, I'm not
an employee, I'm just a guy out

643
00:57:58,375 --> 00:58:03,042
here who is, you know,
interested in this, and wants to
improve public safety. 	So, you

644
00:58:03,042 --> 00:58:07,833
know, it's a wildcard, right.
How do you handle somebody like
that? And I can appreciate that,

645
00:58:07,833 --> 00:58:12,583
so. I believe that they might
have sent a folk or two here and
I hope we can rap up here later,

646
00:58:12,583 --> 00:58:17,250
you know, continue to build has
relationship because this is
where it's gonna count. 	>>

647
00:58:17,250 --> 00:58:22,750
Lessons learned: really, you
know, we need a better reporting
method. We need to have some

648
00:58:22,750 --> 00:58:27,500
teeth in something and a way to
track these formal government
levels, we need some

649
00:58:27,500 --> 00:58:31,833
coordination happening across
these different agencies. I'd
love to see like a task force

650
00:58:31,833 --> 00:58:36,750
that evolved out of this where
okay we found a device, we're
able to get the public IP

651
00:58:36,750 --> 00:58:42,917
correlated to a healthcare
provider, send the people in,
ask them to disable it. If

652
00:58:42,917 --> 00:58:49,833
there's a PHI leak or something
along those lines consider a
fine. Again, I'd hate to see a

653
00:58:49,833 --> 00:58:55,625
small poor hospital out in the
middle of nowhere get hammered
with a HIPAA fine but again it

654
00:58:55,625 --> 00:59:01,625
makes the news and hopefully
that drives change. 	>> So let's
talk about some adversary

655
00:59:03,875 --> 00:59:08,250
misconceptions and some e-mails
that I've gotten on our
research, public comments,

656
00:59:08,250 --> 00:59:13,792
people that I've had to deal
with. One of the things that I
get is: Well, who the heck would

657
00:59:13,792 --> 00:59:17,542
do this? They only care about
financial gain, right. They
don't care about anything else.

658
00:59:17,542 --> 00:59:21,083
All they care about is going
into those Pacs systems,
actually draining patient data,

659
00:59:21,083 --> 00:59:26,000
and selling it. And yeah that's
true, Russians, they're gonna
sell it right, that's what they

660
00:59:26,000 --> 00:59:32,042
do. But the other thing, the
other misconception, and
honestly there was this guy that

661
00:59:32,042 --> 00:59:38,042
posted on a recent article and
he actually said ignorant
people, he said that, hey, these

662
00:59:41,167 --> 00:59:46,000
people lives in caves and you're
giving them all the information
to get into the devices. And

663
00:59:46,000 --> 00:59:50,583
they're not smart enough to
figure this out on their own
'cause they live in caves. I had

664
00:59:50,583 --> 00:59:55,917
e-mail communications with this
guy like 30 times and he just
wouldn't give it up. He was so

665
00:59:55,917 --> 01:00:00,333
convinced that they aren't
technically adept enough to
carry this out. And as we showed

666
01:00:00,333 --> 01:00:07,125
you, this is not a technical
attack here. This is basic
Security 101 concepts that one

667
01:00:07,125 --> 01:00:12,000
thing gets missed and there is
kind of this cascading effect
for patient safety right, and it

668
01:00:12,000 --> 01:00:18,625
opens up this huge threat model
that we have to be aware of. 	>>
So who do we need to worry

669
01:00:18,625 --> 01:00:24,042
about? I think, you know,
terrorists and extremists,
technically adept, when you get

670
01:00:24,042 --> 01:00:30,208
into, you know, ISIS, when you
get into nation states, that's
kind of who we need to worry

671
01:00:30,208 --> 01:00:34,583
about and that's what I thought
about. And then Shawn, and he
can talk to this, he brought up

672
01:00:34,583 --> 01:00:39,500
this interesting article that
I'd never thought of, oh man, a
patient, maybe themselves could

673
01:00:39,500 --> 01:00:42,667
be an adversary in a way. So
I'll let you talk about this
article. 	>> I'll quickly run

674
01:00:42,667 --> 01:00:46,250
through this. So here is the
situation, you know. You've got
a patient in a hospital with a

675
01:00:46,250 --> 01:00:51,250
gunshot wound, guy's lying in
bed, he's got his laptop there,
and he's got-. 	>> This is

676
01:00:51,250 --> 01:00:56,500
awesome by the way. 	>>And he's
getting a morphine drip right
through an infusion pump. So

677
01:00:56,500 --> 01:01:02,167
obviously he's like I'm in pain,
I want more juice. How do I do
this? The guy went online.

678
01:01:02,167 --> 01:01:05,750
(Laughter) 	>> We didn't make
this up. There is the link. 	>>
Guy went online, found the

679
01:01:05,750 --> 01:01:12,583
manual for this infusion pump
and then was able to break into
it and then reprogram it and he

680
01:01:12,583 --> 01:01:16,958
ended up going into an overdose
and then it happened to a couple
guys in this healthcare

681
01:01:16,958 --> 01:01:24,917
organization in Australia. I'm
sorry, Austria, and, yeah, so
you know it's just something

682
01:01:24,917 --> 01:01:28,083
when you think about, it's like,
oh, we always think about, you
know, who is at risk and who is

683
01:01:28,083 --> 01:01:31,542
the adversary here. Well, you
know, the guy who's being
treated for this could very well

684
01:01:31,542 --> 01:01:36,958
be the adversary from a
healthcare standpoint. 	>> So
one of the things that really,

685
01:01:36,958 --> 01:01:44,000
you know, gets scary and this is
easy to kinda dismiss as a, just
theoretical or you're watching

686
01:01:44,000 --> 01:01:46,667
too much TV or reading too many
books, but think about these
Boston marathon bombings and the

687
01:01:46,667 --> 01:01:53,875
Tsarnaev brothers, right, and
think about if they had set off
ten bombs and then, you know,

688
01:01:53,875 --> 01:02:00,042
timed another ten to go off,
right, when all the emergency
personnel came in. This is what

689
01:02:00,042 --> 01:02:05,042
happens in countries like
Israel, when we see the first
bomb goes off, all the emergency

690
01:02:05,042 --> 01:02:09,333
personnel rush in there, then
the second one goes off. And
what I think we're going to need

691
01:02:09,333 --> 01:02:14,167
to start worrying about in the
future is gonna be the
electronic attacks against the

692
01:02:14,167 --> 01:02:19,667
critical infrastructure like
hospitals and power but more so
hospitals because they're such

693
01:02:19,667 --> 01:02:23,875
soft targets. Think about the
impact of a, you know, a bomb
goes off, all the EMT guys get

694
01:02:23,875 --> 01:02:27,167
hit with the second bomb, then
they're bringing everybody to
the hospital, and then

695
01:02:27,167 --> 01:02:33,333
everything shuts down in the
hospital. Even Boston Children's
recently got hit on their public

696
01:02:33,333 --> 01:02:41,042
website because of the Peletier
case which Anonymous picked up
on so we are seeing this already

697
01:02:41,042 --> 01:02:44,958
starting to manifest itself. And
it's all about capability,
right. The capability is there

698
01:02:44,958 --> 01:02:50,667
to do this. 	>> I think one
thing to add, too, I think this
is where, you know, historically

699
01:02:50,667 --> 01:02:55,583
DHS and ICS-CERT are the ones
issuing advisories, it wasn't
until April that the F.B.I. all

700
01:02:55,583 --> 01:03:00,333
of a sudden got involved and
they issued two privacy industry
notices last April. They kind of

701
01:03:00,333 --> 01:03:05,875
came out of left field, like why
the hell is the F.B.I. all of a
sudden issuing private industry

702
01:03:05,875 --> 01:03:09,458
notices about risks in medical
device exposure? This is one of
their fears, right, is the

703
01:03:09,458 --> 01:03:14,167
combined attack and that's the
type of thing that they are
looking at, that's why they are

704
01:03:14,167 --> 01:03:17,917
looking into the space a little
bit more closely and why
they've, you know, we started to

705
01:03:17,917 --> 01:03:23,500
work with them and build that
relationship up is really these
types of scenarios. 	>> Right,

706
01:03:23,500 --> 01:03:29,500
so the military term for this is
force multiply. 	>> So Ed on the
bottom here, Cybercity, they are

707
01:03:33,292 --> 01:03:37,167
already doing this, right. You
know, the government obviously
is looking at it and they think

708
01:03:37,167 --> 01:03:41,292
it's a risk, we should probably
take a look at it, I mean Ed has
been doing this for a few years

709
01:03:41,292 --> 01:03:45,375
now but Cybercity has basically,
they have all that critical
infrastructure. They have

710
01:03:45,375 --> 01:03:49,708
detailed all that critical
infrastructure, so they have the
healthcare, they have financial,

711
01:03:49,708 --> 01:03:54,917
they have the ICS stuff, they
have transportation, it's just a
big, you know, training lab for

712
01:03:54,917 --> 01:04:00,208
if a combined attack took place,
how would we be able to react
for it? So it is taking place

713
01:04:00,208 --> 01:04:06,708
already. 	>> So really, one of
the questions that comes into
this is, this is a whole new

714
01:04:06,708 --> 01:04:11,708
area of medical devices. How do
you even know that a, if a
medical device was hacked? You

715
01:04:11,708 --> 01:04:15,375
know, one of the first things
that you'll read about when you
start looking in this space in

716
01:04:15,375 --> 01:04:20,708
the articles is to say there's
no documented evidence of a
medical device attack happening.

717
01:04:20,708 --> 01:04:26,625
But how would you know? I mean
we don't have the forensics
capability really mature yet at

718
01:04:26,625 --> 01:04:31,250
all in this except for there
some is open source stuff,
right, that's built on cots

719
01:04:31,250 --> 01:04:35,583
equipment. But it's mostly
closed-source code. 	Vendors
aren't sharing this code. And

720
01:04:35,583 --> 01:04:39,292
then with these devices you need
specialized diagnostic
equipment, you're running

721
01:04:39,292 --> 01:04:44,792
proprietary protocols and code
so it's very very difficult and
you need specialized people and

722
01:04:44,792 --> 01:04:50,792
a vendor to help you with any
type of cyberforensics exercise.
	Then you get into the device

723
01:04:52,792 --> 01:04:57,542
experts so, you know, looking on
LinkedIn I only found two people
who really claimed any

724
01:04:57,542 --> 01:05:01,500
expertise. 	>> Definitely an
official source, way better than
Wikipedia! 	(Laughter) 	>> Yeah

725
01:05:01,500 --> 01:05:06,833
but only two people that I
found. And the first was you
know, a woman from the FDA,

726
01:05:06,833 --> 01:05:11,958
total track record. 	>> Not an
expert. 	>> Then the second was
a retired F.B.I. agent, who was

727
01:05:11,958 --> 01:05:18,458
one of the founding members of
their cybersquads, so those are
like two people, but. So those

728
01:05:18,458 --> 01:05:23,042
of you who are thinking about
forensics in the future and
maybe if you are in healthcare,

729
01:05:23,042 --> 01:05:26,917
this is something that is to
consider as far as a career
path. 	>> And one thing here on

730
01:05:26,917 --> 01:05:32,000
this last bullet point that is
important to understand, too,
when we talk about, you know, a

731
01:05:32,000 --> 01:05:35,292
low assurance that an attack,
either intentional or
unintentional, hasn't taken

732
01:05:35,292 --> 01:05:41,208
place against these devices with
adverse events. The FDA
adjudication process of a

733
01:05:41,208 --> 01:05:47,458
medical device related
malfunction that gets reported.
Healthcare organization has the

734
01:05:47,458 --> 01:05:51,875
responsibility in requirement to
report a medical device related
malfunction, and so they report

735
01:05:51,875 --> 01:05:56,125
that to the FDA. Well if you go
to the FDA's website it will
directly tell you and their

736
01:05:56,125 --> 01:06:02,625
quotes are several hundred
thousand of medical
device-related malfunctions. So

737
01:06:02,625 --> 01:06:07,042
they adjudicate this. If
something happens and there is
an adverse event for a patient

738
01:06:07,042 --> 01:06:11,708
they do a clinical adjudication
to say, oh, the patient died
from pneumonia on a ventilator

739
01:06:11,708 --> 01:06:16,208
or there's, you know, they died
of old age or that type of
thing. If not they don't really

740
01:06:16,208 --> 01:06:20,750
do, you know, security. They
don't look at forensics because
there's not a whole lot of

741
01:06:20,750 --> 01:06:25,625
information there to look at.
And so they throw it in this
generic button, or bucket of

742
01:06:25,625 --> 01:06:30,417
several hundred thousand medical
device-related adverse, you
know, deaths and serious

743
01:06:30,417 --> 01:06:36,583
injuries every year. We don't
know what they are. And then the
Mod reports suck and they're

744
01:06:36,583 --> 01:06:42,375
very specific and script out. So
we don't really have the
information and we don't have

745
01:06:42,375 --> 01:06:48,875
the forensic details so, you
know, how could we really prove
this at this point? 	>> So let's

746
01:06:48,875 --> 01:06:55,292
get us into HIPAA. I'm gonna
flip through this really quick.
Oh, you're switching with me.

747
01:06:55,292 --> 01:06:58,333
	>> You know, yeah, HIPAA. I'm
not gonna argue that it's
ineffective, but why are we in

748
01:06:58,333 --> 01:07:03,042
this space? Doesn't it protect
us? I get this too. I get all
these e-mails all day long, why

749
01:07:03,042 --> 01:07:08,292
isn't HIPAA doing something,
right? HIPAA focuses on patient
privacy, it's not focused on

750
01:07:08,292 --> 01:07:13,500
necessarily patient safety.
Human life is much more
irreplaceable than PHI. So I

751
01:07:13,500 --> 01:07:17,750
would encourage you guys to
start looking at that if you
work for healthcare

752
01:07:17,750 --> 01:07:24,500
organizations, definitely start
looking into that. It doesn't
focus on medical devices and it

753
01:07:24,500 --> 01:07:29,500
definitely doesn't focus on
adversarial resiliency testing
at all. 	Don't the federal

754
01:07:29,500 --> 01:07:34,333
agencies protect you? That's
another one. Shouldn't the FDA
be doing this, right? Well, it's

755
01:07:34,333 --> 01:07:38,708
ultimately your responsibility
as a manufacturer, as a
healthcare organization, they

756
01:07:38,708 --> 01:07:42,333
have told healthcare
organizations, they've told
manufacturers since last year

757
01:07:42,333 --> 01:07:48,333
when Billy Rios, Terry McCorkle
came out with the infamous 300
List and these are some of the

758
01:07:50,375 --> 01:07:55,458
alerts if you want to look them
up later, that came out
specifically telling healthcare

759
01:07:55,458 --> 01:07:59,917
organizations and medical device
manufacturers that they at this
point aren't gonna get involved,

760
01:07:59,917 --> 01:08:06,000
and that it's their
responsibility to take care of
it. 	So how did healthcare kinda

761
01:08:06,000 --> 01:08:12,833
get to the state that it's at,
you know, ten years behind? It's
back to HIPAA in my opinion. If

762
01:08:12,833 --> 01:08:17,833
you work in the industry,
information security programs in
healthcare were primarily funded

763
01:08:17,833 --> 01:08:23,542
and developed to comply with
HIPAA. So we all know security
is not compliance or information

764
01:08:23,542 --> 01:08:28,417
assurance but that's how these
programs have been built, they
have been built for check box

765
01:08:28,417 --> 01:08:32,125
security, and we buy this
appliance and we check this box,
and oh, hey, we are secure

766
01:08:32,125 --> 01:08:39,667
'cause HIPAA says we are secure.
	Where are the issues in the
manufacturers? Well we've never

767
01:08:39,667 --> 01:08:44,042
had, you know, this is kind of
the similar space, even in the
auto industry, right.

768
01:08:44,042 --> 01:08:48,500
Historically especially when you
look at, you know, life cycles
of these devices, that for

769
01:08:48,500 --> 01:08:53,458
implantables, if they're not on
expedited approval from the FDA
from prototype to, you know,

770
01:08:53,458 --> 01:08:59,708
market release, it could be 12
to 13 years. So we never have
had to design for adversarial

771
01:08:59,708 --> 01:09:03,833
threats and never really thought
about it. We took these medical
devices that existed and we just

772
01:09:03,833 --> 01:09:07,667
decided oh it would be great if
we could get data on this and
managed them remotely so we

773
01:09:07,667 --> 01:09:12,583
don't have to waste time, and be
more efficient but now we kinda
have the unintended consequences

774
01:09:12,583 --> 01:09:19,625
that we are seeing here in our
research across healthcare
organizations. 	And the other

775
01:09:19,625 --> 01:09:24,042
thing, you know, they haven't
fully embraced, this is getting
better, most of the large

776
01:09:24,042 --> 01:09:31,250
healthcare manufacturers are
starting to reach out, we're
starting to build those

777
01:09:31,250 --> 01:09:35,375
relationships, there is a lot of
one-offs, you'll get to one of
these examples, of a company

778
01:09:35,375 --> 01:09:41,375
that just will not talk to us
coming up here that we're gonna
show a use case on. But so if

779
01:09:44,625 --> 01:09:49,833
you reach out to us and actually
talk to us we probably won't be
as mean to ya! But no, you know,

780
01:09:49,833 --> 01:09:54,375
we are really there, we have a
combined effort and they are
starting to embrace it. We are

781
01:09:54,375 --> 01:09:58,125
doing a really good job, we're
making a lot of progress there
so I'm definitely hopeful, you

782
01:09:58,125 --> 01:10:03,625
know, that that will continue.
You know, it's not, when you
talk to the manufacturer and you

783
01:10:03,625 --> 01:10:08,708
know they don't care. You know,
to their benefit, I mean they
are very large, a lot of this

784
01:10:08,708 --> 01:10:14,458
does take time, it is a culture
change and so they are getting
there. They are building out

785
01:10:14,458 --> 01:10:19,250
these teams. They are hiring the
right people and giving them
internally the authority but

786
01:10:19,250 --> 01:10:23,083
this is just some of the larger
manufacturers, not these
one-offs, not to mention when we

787
01:10:23,083 --> 01:10:30,792
get into digital health and
mobile health things. 	So does
anyone work for healthcare

788
01:10:30,792 --> 01:10:37,708
organizations that wants to
admit it? Okay. All right. So
how many of you have been told

789
01:10:37,708 --> 01:10:43,583
by a manufacturer that you can't
patch your system, like your
medical devices, right? Exactly.

790
01:10:43,583 --> 01:10:48,833
It's a crutch. And here is the
link. I mean like Shawn said,
they've been telling you, the

791
01:10:48,833 --> 01:10:52,958
FDA, there is, you know,
cybersecurity clause for
patching. There is a very small

792
01:10:52,958 --> 01:10:57,208
percentage that would actually
have to go back through 510 k,
the only case is if it's

793
01:10:57,208 --> 01:11:03,375
clinical care issue, patient
safety issue on some types of
implantables. Who else has been

794
01:11:03,375 --> 01:11:07,292
told they can't change
hard-coded credentials that they
may have located for the

795
01:11:07,292 --> 01:11:11,833
manufacturer, right? All right.
So that gets into my next bullet
point. I want to, you know,

796
01:11:11,833 --> 01:11:17,167
spend a little time kind of
clarifying this. This is a big
point. Both sides need to

797
01:11:17,167 --> 01:11:21,333
understand this. So if you are
in healthcare, you know, please
listen to this. On the

798
01:11:21,333 --> 01:11:27,333
healthcare side, whose
biomedical teams are integrated
with IS? Oh my God, there is not

799
01:11:30,250 --> 01:11:34,792
a single hand that I can see.
But I'm a little blinded. 	>> We
have two over there. 	>>

800
01:11:34,792 --> 01:11:41,083
Awesome! That is great. So how
this works and where this
disconnect is, is you as someone

801
01:11:41,083 --> 01:11:46,625
in security, you find a bug or a
flaw in a device that you want
to report. You go to your Biomed

802
01:11:46,625 --> 01:11:52,500
technician, your Biomed tech
takes your report, interprets it
in his little Biomed language

803
01:11:52,500 --> 01:11:57,042
and who does he contact from the
manufacturer? He contacts the
support technician at the

804
01:11:57,042 --> 01:12:02,292
manufacturer. Well the support
technician is not their security
people, doesn't have any idea,

805
01:12:02,292 --> 01:12:06,833
so they get your report that
says we have a hard coded
credential, how it works on the

806
01:12:06,833 --> 01:12:12,250
manufacturer's side is that
field support tech goes to their
supervisor and says, hey, we

807
01:12:12,250 --> 01:12:17,708
have a report from a customer
that we need to change this. And
the supervisor is like, hey, how

808
01:12:17,708 --> 01:12:24,333
the hell are we gonna get into
the customer's systems if we
change the password, right? So

809
01:12:24,333 --> 01:12:29,250
it stops right there. And he's
not thinking security, right.
He's not their security person.

810
01:12:29,250 --> 01:12:32,833
But he tells that field support
tech to tell the Biomed person
that they can't change it. And

811
01:12:32,833 --> 01:12:36,333
so it comes back to the health
organization in a way as the
official response from that

812
01:12:36,333 --> 01:12:40,292
healthcare organization is
they're not gonna fix it and we
don't push it anymore. So

813
01:12:40,292 --> 01:12:44,000
there's a big disconnect there
on both sides, there's a
disconnect between Biomed and IS

814
01:12:44,000 --> 01:12:48,292
on the healthcare side and
there's a disconnect between how
do we inbound handle, you know,

815
01:12:48,292 --> 01:12:53,167
vulnerabilities at the
manufacturer to make sure that
the security folks at those

816
01:12:53,167 --> 01:12:57,250
organizations that have
implemented those programs can
effectively be aware of them

817
01:12:57,250 --> 01:13:01,750
first off, and then drive the
process behind that to make sure
they're resolved. 	And also I

818
01:13:01,750 --> 01:13:07,750
would highly encourage you to,
you know, know those information
security people so if you don't

819
01:13:07,750 --> 01:13:12,167
know especially at your big
vendors, the ones you spend lots
of money and have lots of

820
01:13:12,167 --> 01:13:18,042
equipment with, reach out and
find out who those folks are and
build up those relationships.

821
01:13:18,042 --> 01:13:24,208
'Cause it's very important. 	>>
So when it comes to patching,
you know, the question is: Yes,

822
01:13:24,208 --> 01:13:32,000
you can patch. But should you?
So there's a good eight, 10
years of FDA guidance saying

823
01:13:32,000 --> 01:13:36,250
that you can patch these systems
but this is something that you
really need to work on your

824
01:13:36,250 --> 01:13:42,292
vendors with and do coordination
because you have got a very
complex ecosystem going on here

825
01:13:42,292 --> 01:13:49,208
and then what if something that
you do in-house breaks the
device? So, you know, the vendor

826
01:13:49,208 --> 01:13:54,458
coordination has to happen with
this issue and there's gonna be
some smaller vendors who are not

827
01:13:54,458 --> 01:14:01,250
going to be ready to work with
you on this as well as a larger
vendor would be. So the other

828
01:14:01,250 --> 01:14:06,500
thing is many healthcare
organizations are reluctant to
patch just because of the

829
01:14:06,500 --> 01:14:11,083
complexity and the changes that
can happen in these systems. And
if we go back into the FDA Mod

830
01:14:11,083 --> 01:14:16,500
reports, there's many many
examples of patches that have
gone wrong or healthcare

831
01:14:16,500 --> 01:14:22,500
organizations that are
comfortable patching say the
computer PC that connects to the

832
01:14:22,500 --> 01:14:27,542
medical device that's running,
both are running Windows,
they'll patch one, the one you

833
01:14:27,542 --> 01:14:31,833
used to run the device but they
don't want to patch the device
itself that actually connects to

834
01:14:31,833 --> 01:14:37,833
the patient. Which is completely
understandable. 	The anti-virus
question is another one. And you

835
01:14:40,250 --> 01:14:46,000
know, we can get off on a side
tangent here with anti-virus but
the main points that I want to

836
01:14:46,000 --> 01:14:53,125
bring were that there are a lot
of reports of FDA MAUDE, in FDA
MAUDE of negative impact of

837
01:14:53,125 --> 01:14:59,042
anti-virus, and that's like
everything from, oh your 90-day
license expired and, you know,

838
01:14:59,042 --> 01:15:05,417
this is an OR situation and then
this pop up is coming up saying
license has expired. 	Everything

839
01:15:05,417 --> 01:15:11,417
to bad McAfee, that's not to
pick on McAfee at all, but if
you recall back in 21, April

840
01:15:13,417 --> 01:15:20,333
2010 this bad DAT went out and
it identified a core Windows
file as malicious and then all

841
01:15:20,333 --> 01:15:25,042
these machines, all these XP
machines just started going into
a continuous reboot. So if you

842
01:15:25,042 --> 01:15:29,833
were working in healthcare
organization at that time you
were running around manually

843
01:15:29,833 --> 01:15:36,375
hitting every single box and
fixing them. And just a small
example is a third of the

844
01:15:36,375 --> 01:15:41,917
hospitals in Rhode Island were
impacted by this, so many, many
people were, especially if you

845
01:15:41,917 --> 01:15:48,292
were, if you have been doing
this a while. 	There's also
direct events of AV deleting,

846
01:15:48,292 --> 01:15:55,792
fetal monitoring logs. 	>> When
they actually log. 	>> And it's
a, you know, this is a complex

847
01:15:55,792 --> 01:16:01,250
issue. And then, you know,
you'll have some clients or
customers that push back on

848
01:16:01,250 --> 01:16:06,208
vendors saying we have to run
antivirus on this so the vendors
are in a bad position and they

849
01:16:06,208 --> 01:16:10,583
may recommend one or they may
not recommend one and then the
other thing they'll do often,

850
01:16:10,583 --> 01:16:15,250
you'll see this in the
documentation is say disable
this particular feature of the

851
01:16:15,250 --> 01:16:21,708
antivirus so they'll say disable
on-demand scanning, which, okay,
now we have this antivirus on

852
01:16:21,708 --> 01:16:27,667
there. We have checked our happy
check box but then we have
basically hobbled a key

853
01:16:27,667 --> 01:16:33,083
protection mechanism and
function of this antivirus
itself. So, you know, again, it

854
01:16:33,083 --> 01:16:37,375
comes back to a risk basis here.
What are we really trying to
accomplish here? Are we just

855
01:16:37,375 --> 01:16:41,542
trying to check a check box or
are we trying to reduce risk
because there could be cases

856
01:16:41,542 --> 01:16:46,208
where, you know, many cases of
why would you even want
antivirus on there? But unless

857
01:16:46,208 --> 01:16:51,333
you are getting it directly from
the vendor you probably don't
want to run it. 	>> So solutions

858
01:16:51,333 --> 01:16:55,708
and recommendations, I'll just
touch these quick, right. I
mean, external attacks service

859
01:16:55,708 --> 01:17:00,583
and hardening, that's important,
we have obviously shown you that
it's not being done

860
01:17:00,583 --> 01:17:06,500
appropriately, right. Mitigate.
First you need to recognize and
you actually need to use a tool

861
01:17:06,500 --> 01:17:11,833
like SHODAN in your organization
and start recognizing those and
work to mitigate them. You know,

862
01:17:11,833 --> 01:17:17,208
you don't need to use SHODAN,
you can the API for automation.
You can, you know, use continual

863
01:17:17,208 --> 01:17:22,500
monitoring, mass scan, ZMAP,
those types of tools you can
also use, you don't need to use

864
01:17:22,500 --> 01:17:27,542
just SHODAN. You know, make the
external perimeter --
(Inaudible) -- proof, we don't

865
01:17:27,542 --> 01:17:31,375
see this in a lot healthcare
organizations, we don't see
these skill sets being employed,

866
01:17:31,375 --> 01:17:34,833
because again going back to
HIPAA we see compliance and
information assurance driving

867
01:17:34,833 --> 01:17:39,125
that budget but we need to get
these skill sets in there, you
need to look at it. We are

868
01:17:39,125 --> 01:17:45,375
clearly showing you that we are
way behind in the healthcare
sector. 	Stop the bleeding,

869
01:17:45,375 --> 01:17:51,542
right. Check and make sure SMV
isn't open, as simple as it
sounds. I mean look at the

870
01:17:51,542 --> 01:17:54,958
exposure, look at the
information attacker and get on
your systems through this, it's

871
01:17:54,958 --> 01:18:02,500
significant. It's your medical
devices that have to do with
patient safety issues. And

872
01:18:02,500 --> 01:18:06,875
resilience testing, right. Red
teaming. Start working on
building out those programs and

873
01:18:06,875 --> 01:18:11,917
really, you know, harden those
devices, don't leave them wide
open if you are a large

874
01:18:11,917 --> 01:18:17,875
healthcare organization or any
organization without any type of
password so please take a look

875
01:18:17,875 --> 01:18:22,625
at those. 	What do we need from
healthcare? Kind of talked on
that. You know, it's internal

876
01:18:22,625 --> 01:18:28,458
programs focused on medical
device security. We really need
to start looking at that. You

877
01:18:28,458 --> 01:18:32,833
need to start requiring security
testing during your vendor
selection. We'll talk about that

878
01:18:32,833 --> 01:18:35,875
a little bit later and how you
can implement that into your
procurement, your vendor

879
01:18:35,875 --> 01:18:40,167
selection process and really how
do you tie that in and how do
you get that inside the

880
01:18:40,167 --> 01:18:43,542
healthcare organization? Well
you've gotta tie it to your
mission and you've gotta tie it

881
01:18:43,542 --> 01:18:47,750
to patient safety. That's what
the board level, that's what the
executives are gonna care about.

882
01:18:47,750 --> 01:18:52,458
And it definitely, when it is
talking about securing medical
devices, is tied to that

883
01:18:52,458 --> 01:18:58,458
mission. 	>> So has anyone in
here has ever heard of a MDS2
form? A couple folks. 	>> All in

884
01:19:01,250 --> 01:19:07,542
healthcare who have heard of it!
	>> That's good. So an MDS2 form
is a form that came, I think

885
01:19:07,542 --> 01:19:12,208
came out of HEMS, it's been
around for several years,
basically it goes through some

886
01:19:12,208 --> 01:19:18,875
really good, almost a checklist
function. There is a place for
that. About authentication and

887
01:19:18,875 --> 01:19:24,125
you know, how accounts are used
and big vendors, major vendors
will have that form on hand for

888
01:19:24,125 --> 01:19:28,875
their systems. That's something
which you should be asking your
vendors for and then there's

889
01:19:28,875 --> 01:19:33,458
recently been some updates and
addendums to that and I think
that's a great form to start to

890
01:19:33,458 --> 01:19:38,667
build on. 	And then of course
you know, we need to have more
responsible disclosure and then,

891
01:19:38,667 --> 01:19:44,750
you know, HHS and OCR, bringing
in law enforcement because this
will be moving into a criminal

892
01:19:44,750 --> 01:19:50,167
realm, I think. People watch
"Homeland," there's a lot of
sexiness of these attacks,

893
01:19:50,167 --> 01:19:55,375
that's appealing to some of
these demented personalities out
there, so I think it's a

894
01:19:55,375 --> 01:20:01,208
possibility. 	And now really one
of the more interesting things
that I've seen coming over the

895
01:20:01,208 --> 01:20:06,750
past year has been some
healthcare organizations are
bringing in indemnification

896
01:20:06,750 --> 01:20:11,250
clauses into their contracts. So
what that means is you know,
security and biomedical need to

897
01:20:11,250 --> 01:20:16,417
get with legal in the
organization and then push back
on the vendors and say well, if

898
01:20:16,417 --> 01:20:21,000
something you know, really bad
does happen here and then who is
going to own the liability on

899
01:20:21,000 --> 01:20:27,000
this. 	 	>> Disclosure
reporting. This is pretty easy.
DHS, ICS-CERT, kind of the

900
01:20:33,917 --> 01:20:39,083
agencies. Manufacturers if
possible, I say if possible
because this example that I'm

901
01:20:39,083 --> 01:20:43,667
about to give you, they won't
return any of my calls. I won't
responsibly disclose it. But

902
01:20:43,667 --> 01:20:47,667
they won't talk to me. Or get
back to me. Apparently they
haven't gotten back to DHS

903
01:20:47,667 --> 01:20:51,625
either. 'Cause I have not heard
anything. Healthcare
organizations you know, you

904
01:20:51,625 --> 01:20:55,375
probably should go to your
manufacturer first, if you feel
they are not responding, know

905
01:20:55,375 --> 01:20:59,167
that it will take time but if
you feel they are not working on
it, not addressing it, you know,

906
01:20:59,167 --> 01:21:05,167
we need to start looking at
sending those over to ICS-CERT
as well as the FDA.

907
01:21:07,500 --> 01:21:12,167
	Accessibility to medical
devices, I think, Shawn, you can
kinda talk to the stereotypical

908
01:21:12,167 --> 01:21:16,083
why people don't get into
research involving medical
devices. 	>> Sure, so, you know,

909
01:21:16,083 --> 01:21:21,625
they're really hard to get a
hold of, right. So one of the
things is you know, these are Rx

910
01:21:21,625 --> 01:21:26,083
only, they're prescription only
and they're also very expensive.
You'r not gonna go out there and

911
01:21:26,083 --> 01:21:30,792
buy you know, a radiology
machine. You may not even be
able to, you can't get the

912
01:21:30,792 --> 01:21:35,833
permit for it you know. There's
a lot of hurdles to jump on
this. And then you see if you

913
01:21:35,833 --> 01:21:39,667
look at the security researchers
over the past years who have
been working on this, they have

914
01:21:39,667 --> 01:21:43,500
been hacking their own devices
right, so which also brings in a
whole other level of personal

915
01:21:43,500 --> 01:21:47,917
ownership and credibility to
this because they are not just
security researchers, they're

916
01:21:47,917 --> 01:21:53,792
patients. But you know, though,
you can buy these off of eBay,
you can go right online right

917
01:21:53,792 --> 01:21:58,208
now and even though it's against
eBay's technical terms of
services to sell medical

918
01:21:58,208 --> 01:22:02,792
devices, they sell'em on there
just like you can buy you know,
a fake Cisco router of off eBay,

919
01:22:02,792 --> 01:22:07,208
and I've been able to do that
for years. Medwow is another
site. But here is the problem

920
01:22:07,208 --> 01:22:11,875
with that, you know. These have
already been end-of-lifed, they
are recalled, it's not

921
01:22:11,875 --> 01:22:17,583
current-running software so it's
not really attacking you know,
the actual current software.

922
01:22:17,583 --> 01:22:22,417
	And then the other thing is you
know, there's gonna be a lot of,
this is a whole ecosystem as we

923
01:22:22,417 --> 01:22:26,208
continue to talk about, so
there's gonna be you know,
components you're gonna need to

924
01:22:26,208 --> 01:22:31,458
have to get that device even up
and running and get an IP
network and IP address and

925
01:22:31,458 --> 01:22:36,792
networked to even you know,
start to develop an attack
service. You want to talk about

926
01:22:36,792 --> 01:22:40,250
the consulting stuff? 	>> Yeah,
so consulting, I mean obviously,
if you are not doing independent

927
01:22:40,250 --> 01:22:45,458
research, and buying it, you're
in a lot of cases historically
you are gonna end up in NDA.

928
01:22:45,458 --> 01:22:51,625
What we're starting to see, we
have had a few clients that will
give access to non-identifiable

929
01:22:51,625 --> 01:22:55,875
data clauses so that we can talk
about it openly in
non-descriptive fashions so

930
01:22:55,875 --> 01:23:00,292
we're starting to see that. I
think there is more push to that
and more coordination in

931
01:23:00,292 --> 01:23:05,792
disclosure. So now Shawn kinda
talked about you know, hey this
is why people don't get involved

932
01:23:05,792 --> 01:23:10,000
in security research. We can't
get our hands on the devices. I
am going to give you a use case

933
01:23:10,000 --> 01:23:16,083
here that will hopefully paint
the picture that you know what,
you may not need your hands on

934
01:23:16,083 --> 01:23:20,042
these devices but a different
way to think. We need more
people looking at these issues.

935
01:23:20,042 --> 01:23:26,917
I can't do it by myself. So
please take a look at this. One
of the things is obviously

936
01:23:26,917 --> 01:23:31,042
service technician manuals. They
contain a lot of information
that we'll show you here, full

937
01:23:31,042 --> 01:23:36,000
architectural diagrams, another
thing is you can always do
patent searches, manufacturers

938
01:23:36,000 --> 01:23:42,958
love to put all the details on
their patent applications so
that nobody steals their idea or

939
01:23:42,958 --> 01:23:49,208
uses it. So start doing that and
I'm gonna show you an example
here of how that works. And it's

940
01:23:49,208 --> 01:23:53,875
gonna be on the defiable right,
so there's the vendor name. It's
Zoll. 	Some specific ones on the

941
01:23:53,875 --> 01:23:58,750
next series, I'll get into those
later on. These are defibs,
they're on the public IP space,

942
01:23:58,750 --> 01:24:03,917
they sit in an ambulance, they
have like a 12-vote lead and
then they transmit all that back

943
01:24:03,917 --> 01:24:08,167
to the ED before arrival. So
here they are sitting on public
IP space, they're running

944
01:24:08,167 --> 01:24:12,542
Verizon 'cause they're running
those other networks, well there
is also a web interface, so

945
01:24:12,542 --> 01:24:17,125
let's go to the web interface,
right. Oh God, I need a
certificate. Great. Root

946
01:24:17,125 --> 01:24:24,000
certificate right on the landing
page. Let's download it. Awesome
security, right? Well it's also

947
01:24:24,000 --> 01:24:30,000
the first defib and just out of
disclosure I've never actually
had my hands on this device, so

948
01:24:34,000 --> 01:24:38,042
I'm doing this to paint the
picture of the documentation.
	>> So wireless, it uses UR for

949
01:24:38,042 --> 01:24:45,125
communication in these systems.
The communication processor
talks back to the main system

950
01:24:45,125 --> 01:24:48,583
board, so that's the
architectural diagram right
there, so it's on the same

951
01:24:48,583 --> 01:24:53,500
server, with receive and
transmit. In order to import
config here is your config file

952
01:24:53,500 --> 01:24:58,250
out of the documention you need
to import in order to change the
configuration settings. All

953
01:24:58,250 --> 01:25:01,583
right. What are the critical
values that I need to change,
what would an attacker need to

954
01:25:01,583 --> 01:25:06,167
change to cause a patient harm,
right? Well, these are critical
values as you can see to our

955
01:25:06,167 --> 01:25:11,542
logging turned off by default.
Default patient mode, okay here
are some values inside of those

956
01:25:11,542 --> 01:25:17,083
configuration files. If I change
that adult to, one is set for
pediatric to adult, it's gonna

957
01:25:17,083 --> 01:25:22,167
change the default like joules
that are delivered from that
defib. Need to do factory

958
01:25:22,167 --> 01:25:28,167
resell, restore, right, it says
here oh I need an authorized
supervised passcode. Well, here

959
01:25:30,583 --> 01:25:34,167
is how you get to it through the
supervisor menu. As you can see
once you get to the supervisor

960
01:25:34,167 --> 01:25:38,250
menu, there's all the config
settings. Many of those relate
back to the critical settings

961
01:25:38,250 --> 01:25:43,292
that I just showed you. So we
still have the issue of how do
we get into the supervisor mode.

962
01:25:43,292 --> 01:25:49,292
Oh, there is your password,
1234. (Laughter and applause) So
that's all you, also you can

963
01:25:51,458 --> 01:25:55,917
clear logs. So you can
completely wipe any traces of
this happening. Before I get to

964
01:25:55,917 --> 01:26:01,708
this next slide here, I need to
say that I reached out to this
manufacturer numerous times.

965
01:26:01,708 --> 01:26:05,167
They won't return my calls. I
feel I have a responsibility to
disclose this. They have not

966
01:26:05,167 --> 01:26:11,167
gotten back to us and so here
are every one of Zoll's defib's
supervisor creds for every one

967
01:26:15,458 --> 01:26:21,458
of their products lines. 	>>
AUDIENCE MEMBER: We will have
your CDs by the end of the day.

968
01:26:25,875 --> 01:26:31,875
	>> Awesome! Here we go. There
they are. Throw the CDs, there
you go, 801234. So, vendors

969
01:26:35,917 --> 01:26:40,417
changing, yeah, they're getting
better other than that one
apparently won't reach out, so.

970
01:26:40,417 --> 01:26:44,500
All the baby care has reached
out to us, we are working with
them and I want to give a huge

971
01:26:44,500 --> 01:26:48,917
shoutout here to Philips really
quick. I actually went in and
worked with them completely pro

972
01:26:48,917 --> 01:26:53,000
bono, they invited me in to look
at vulnerability disclosure and
they have given me an official

973
01:26:53,000 --> 01:26:58,667
statement that they are going to
work on this and so this is
their positioning, they're going

974
01:26:58,667 --> 01:27:03,458
to come out with vulnerability
disclosure policy. This is gonna
be front and center for

975
01:27:03,458 --> 01:27:07,792
responsible disclosure on their
website so that as a researcher
you can actually go record these

976
01:27:07,792 --> 01:27:11,375
easily and even inside the
healthcare organization so you
don't have the disconnect with

977
01:27:11,375 --> 01:27:17,375
Biomed. So I want to give them a
big hand for that. (Applause) So
look for that because other

978
01:27:21,042 --> 01:27:26,042
organizations are gonna be doing
that. 	And lastly, you know, how
can you help us? If you are into

979
01:27:26,042 --> 01:27:30,417
Android iOS research, we want to
look at application security and
mobile device security, we are

980
01:27:30,417 --> 01:27:34,250
also looking with further
collaboration on physicians and
patients so if you're interested

981
01:27:34,250 --> 01:27:39,958
in that, you can get a hold of
us. Finally, last, you know,
greets to all these guys, you

982
01:27:39,958 --> 01:27:44,458
know, one for inspiring us, two
for helping us out and
collaborating with us, and you

983
01:27:44,458 --> 01:27:47,875
know, the federal agencies have
been great. Support has been
great there as well as you know,

984
01:27:47,875 --> 01:27:52,167
these two manufacturers, there's
other manufacturers that are
reaching out, not specifically

985
01:27:52,167 --> 01:27:57,375
on this talk but it's getting a
lot better. So thank you guys
for coming and have a good day!

986
01:27:57,375 --> 01:28:03,375
	>> Thank you! (Cheers and
applause)

