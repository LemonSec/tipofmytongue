1
00:00:00,000 --> 00:00:04,250
>>How is everybody how holding
up? Way better, okay.
[Applause]. Okay so this is

2
00:00:04,250 --> 00:00:07,542
Fatih and he's going to be
talking about Vio Wars, let's
give him a big DEF CON welcome.

3
00:00:07,542 --> 00:00:13,542
>> Thank you. I appreciate it,
for lasting and saying hello. My
name is Fatih Ozavci and I will

4
00:00:21,500 --> 00:00:29,125
talk about VoIP wars today. What
we need we kind of previously on
Voice over IP Wars. Because I

5
00:00:29,125 --> 00:00:36,333
had another presentation last
year and we had Voice over IP
wars, return of the SIP and we

6
00:00:36,333 --> 00:00:43,333
talked about session initiation
protocol attacks. I provided
Viproy; it's a kind of next

7
00:00:43,333 --> 00:00:48,750
generation Voice over IP testing
tool. It is developed for only
pan testing, not for attackers.

8
00:00:48,750 --> 00:00:56,333
So basically you cannot omit
your tasks but attackers may
not. I will not talk about SIP

9
00:00:56,333 --> 00:01:02,333
too much today because I already
talk and if you are curious
about SIP security, you can get

10
00:01:05,417 --> 00:01:13,125
the talk but I will talk about
Voice over IP solutions to your
security and some Cisco and

11
00:01:13,125 --> 00:01:18,625
voice solutions products and
newer novelties. I will provide
a few new techniques; I will

12
00:01:18,625 --> 00:01:25,542
provide a few new attack
services. A few new novelties
almost for you novelties and

13
00:01:25,542 --> 00:01:33,500
three of them still unpashed....
And I will provide new tools and
new features also developed new

14
00:01:33,500 --> 00:01:39,500
interface for you as well. >>Ah,
yeah, we are starting now. >>I
am Fatih Ozavci, Security

15
00:01:43,167 --> 00:01:50,500
Consultant and I am working for
Sense of Security. I'm proud to
be part of this team and thanks

16
00:01:50,500 --> 00:01:57,333
for them. Also my interests are
voice over IP mobile
applications, network

17
00:01:57,333 --> 00:02:02,583
infrastructure, I am a
penetration tester so I can pan
test anything, that's why I am

18
00:02:02,583 --> 00:02:10,542
pan testing voice over IP. I
missed some skills in this
presentation so the key word is

19
00:02:10,542 --> 00:02:18,375
combining and merging the
skills. I....voice over IP
penetration testing tool

20
00:02:18,375 --> 00:02:24,375
kit...it is actually a .....word
that means call, so this tool
will have new feature and those

21
00:02:29,292 --> 00:02:35,292
features are skinny attacks,
skinny libraries, voice special
attacks, STP features,

22
00:02:35,292 --> 00:02:42,333
encryption features, and vander
extensions. My agenda is talking
about host voice over IP

23
00:02:42,333 --> 00:02:49,750
services and giving some basic
information. I am sure you don't
need it but let me try.

24
00:02:49,750 --> 00:02:55,625
Furthermore we will talk about
network attacks, Cisco
inter...communication domain

25
00:02:55,625 --> 00:03:02,708
manager attacks, Cisco
inter...manager attacks. We will
have three different lines.

26
00:03:02,708 --> 00:03:08,292
First one is attacking SIP
services and we will talk about
Cisco specific SIP problems.

27
00:03:08,292 --> 00:03:14,375
Furthermore we will talk about
attacking lines and we will talk
about skinny attacks. This is a

28
00:03:14,375 --> 00:03:21,292
basic infrastructure for hosted
voice over IP services. Hosted
voice over IP services are multi

29
00:03:21,292 --> 00:03:26,500
talent environments. So,
basically multi talent
environments, pro-wide talent

30
00:03:26,500 --> 00:03:32,500
specific services. Sandbox items
and sandbox services are fully
dedicated to this talent. But

31
00:03:36,917 --> 00:03:43,458
shell services, they are
available for all talents, not
specific ones. So basically they

32
00:03:43,458 --> 00:03:51,292
may have IP phones, soft phones,
teleconference systems, some
other third party connections

33
00:03:51,292 --> 00:03:58,667
but they will use sandbox items,
sand box objects for all voice
over IP communication. Which are

34
00:03:58,667 --> 00:04:05,417
STP, RTP and SIP servers,
unified communication servers
and some CDR servers and data

35
00:04:05,417 --> 00:04:10,958
base servers, of course.
Furthermore, they have shell
services. Shell services are IP

36
00:04:10,958 --> 00:04:15,917
phone services, client
management, tent environment
management or PBX connections

37
00:04:15,917 --> 00:04:21,917
such as land line connections
and GSN connections.
Furthermore, they have shell...

38
00:04:24,125 --> 00:04:29,167
but it depends on the
infrastructure and
configuration. If we want to

39
00:04:29,167 --> 00:04:36,667
attack one single talent, we
should use sandbox items. If you
want to attack all the

40
00:04:36,667 --> 00:04:42,792
environments, if we want to
compromise all talents we should
attack directly to the shared

41
00:04:42,792 --> 00:04:49,250
services. I will show some jail
breaking attacks here. I will
talk about Cisco and Wahl

42
00:04:49,250 --> 00:04:55,250
solutions, Wahl solutions,
basically hosted a voice over IP
.......... Cisco is a partner so

43
00:04:58,458 --> 00:05:06,000
basically they will provide this
hosted voice over IP environment
for many customers. We will talk

44
00:05:06,000 --> 00:05:12,000
about Cisco and Wahl today but
these attacks can be cloned as
well. Also known as voice over

45
00:05:17,792 --> 00:05:23,792
...... as well, so you can use
this extension as well. We will
talk about these services.

46
00:05:27,042 --> 00:05:34,792
Services are basically separated
into two sections. First one is
web based services to support

47
00:05:34,792 --> 00:05:41,458
and manage all talent platforms.
The second one is Voice over IP
services to provide essential

48
00:05:41,458 --> 00:05:47,875
services. And we will attack
almost all of them. Our goal is
discovering the network, finding

49
00:05:47,875 --> 00:05:55,542
the box, defining the errors,
learning the design and
attacking those objects. They

50
00:05:55,542 --> 00:06:02,167
think host and voice over IP
environments are secure, it is
physically but they are not. We

51
00:06:02,167 --> 00:06:07,708
have physical pan testing and
they showed me, even military
grade operations, they are not

52
00:06:07,708 --> 00:06:13,708
secure. Their physical security
is kind of insufficient for
those services. We can use a

53
00:06:16,167 --> 00:06:22,167
talent connection, local form or
comprehensiary forms; we may
have PC port connections behind

54
00:06:25,625 --> 00:06:32,708
the forms. Furthermore we may
impersonate a technical guy or
another, a cable guy and we can

55
00:06:32,708 --> 00:06:37,750
get an access. Also we can
.....a physical access and we
can get a connection, a kind of

56
00:06:37,750 --> 00:06:43,750
access for voice re-land but we
should know voice re-land and
that is why we have CDP attacks,

57
00:06:48,083 --> 00:06:54,792
DDP attacks and Arc sweeping
attacks as well. I do hope to
raise a simple model for Viproy;

58
00:06:54,792 --> 00:07:00,292
it is called a discovery
protocol model. It is available
on Viproy package and you can

59
00:07:00,292 --> 00:07:06,292
use it on Metasploit, actually I
used Hopper .... too many times,
too many years. But I needed a

60
00:07:09,792 --> 00:07:14,708
cross path, a kind of
customization which is why I
loved this model so, if you have

61
00:07:14,708 --> 00:07:20,708
a Linux you should use ...., if
you do not have a customized
engagement, you should use this

62
00:07:23,000 --> 00:07:27,250
model to customize it. Also you
can use this model to far.....
And after all do you have

63
00:07:27,250 --> 00:07:33,250
voice...ID. And we will have a
kind of connection but we should
keep it persistent, we should

64
00:07:37,833 --> 00:07:43,833
add a kind of modified form or
wiretapping object. This is why
I think about Tapio Pi. Tapio Pi

65
00:07:47,417 --> 00:07:53,417
is basic... PI in the IP form.
This is Cisco IP form, 7940. I
disassembled it and I saw that

66
00:07:59,042 --> 00:08:04,667
there's another board on it and
this board is a basic board and
it provides broken actions.

67
00:08:04,667 --> 00:08:06,667
Those broken actions are PC port
connections, talent connection
and a kind of ancillary

68
00:08:06,667 --> 00:08:12,667
connection as well. Furthermore,
they have power source, when I
extract this board I saw that it

69
00:08:21,250 --> 00:08:26,500
is connected using a wide
circuit. You can use this
circuit to connect or

70
00:08:26,500 --> 00:08:32,500
disconnect. When I extracted I
saw that this internet
connection, RJ45 connection has

71
00:08:34,958 --> 00:08:40,958
pins behind the card. So
basically we can use these pins.
I used a basic cable kit 5 and I

72
00:08:47,500 --> 00:08:55,333
created a basic clone of the
transpart. If this phone will be
attached to the voice land we

73
00:08:55,333 --> 00:09:01,333
can create and connect ... to
the same network. And yeah,
there are two spaces inside the

74
00:09:03,417 --> 00:09:09,417
phone. First one is on this
board and the second one is
speaker space. I put my... to

75
00:09:12,917 --> 00:09:18,625
the speaker space and you can
use the other one as well. You
may need the other one for

76
00:09:18,625 --> 00:09:24,875
battery because power on the
internet may have to choose in
the same environment because it

77
00:09:24,875 --> 00:09:30,875
needs, actually the IP phone
will use electricity.
Furthermore ...needs electricity

78
00:09:33,125 --> 00:09:40,292
as well. But power over internet
may support only two power
supplies at the same time. And

79
00:09:40,292 --> 00:09:45,792
as you know IP phone needs more
electricity. This way you need
another power source. You can

80
00:09:45,792 --> 00:09:51,542
use a cell battery or you can
try your chance with a ... IP
phone. For example, if you

81
00:09:51,542 --> 00:09:58,250
extract speaker you will see a
battery connection right there.
And yes, it has electricity so

82
00:09:58,250 --> 00:10:03,833
you can use this electricity to
your supply. It is not completed
yet and I am still working on it

83
00:10:03,833 --> 00:10:11,375
and I will provide a blog on it.
Actually we will not talk about
hardware attacks we will talk

84
00:10:11,375 --> 00:10:17,708
about the modern protocol
attacks and service level
attacks. All of this environment

85
00:10:17,708 --> 00:10:25,000
must be managed. This is why we
have Cisco Host Calibration
suite. This Cisco Host

86
00:10:25,000 --> 00:10:30,000
Calibration suite contains Cisco
unified communication domain
manager. Also know as Wahl

87
00:10:30,000 --> 00:10:36,000
Solutions. It has IP phone
services, self care, talent
user's management and their

88
00:10:39,042 --> 00:10:44,625
services, furthermore talent
services management. The
difference is Talent uses will

89
00:10:44,625 --> 00:10:50,292
use self care. Talent
administrators will use Talent
Services administration.

90
00:10:50,292 --> 00:10:54,917
Furthermore, unified
communication manager will be
used for all voice over IP based

91
00:10:54,917 --> 00:11:00,917
services. We have reported
almost 40 novelties to Cisco.
Cisco reported that some of them

92
00:11:05,083 --> 00:11:12,542
they are not novelty, some of
them, yes they are novelty but
their impact is very limited.

93
00:11:12,542 --> 00:11:19,750
And yes, some of them are
novelty. And Cisco published a
few advisories. I will share

94
00:11:19,750 --> 00:11:25,750
those references at the end of
the presentation. But, here is
the thing, we have another

95
00:11:28,833 --> 00:11:34,833
security advisory. This security
advisory contains two different
unpatched novelties and one real

96
00:11:37,250 --> 00:11:43,875
novelty. Two unpatched ones are
novelties. We found them on Wahl
solutions IP phone examiner

97
00:11:43,875 --> 00:11:49,833
services. It is still unpatched
and will be patched in
September, maybe the second

98
00:11:49,833 --> 00:11:56,750
week. The other one is embedded,
maybe you already know that, but
the product is pretty expensive

99
00:11:56,750 --> 00:12:01,542
so you cannot get this product
easily. So, I have no priority
right now. If you have this

100
00:12:01,542 --> 00:12:07,542
product you can extract SSHT
easily using this exit file.
Cisco unified communication

101
00:12:13,375 --> 00:12:21,083
domain measure also for
embedded. Wahl ....is a basic
client platform and this

102
00:12:21,083 --> 00:12:26,458
platform contains some scripting
novelties and yeah they are
stored scripting novelties and

103
00:12:26,458 --> 00:12:32,458
you can affect other users of
the same talent. But domain
manager actually management

104
00:12:36,792 --> 00:12:43,833
services for talent it is a good
attack surface for us. We can
get an administrative user

105
00:12:43,833 --> 00:12:50,250
easily by using features.
Furthermore if we have a user we
can elevate our privileges as

106
00:12:50,250 --> 00:12:57,125
well. We have multiple privilege
escalations. Also we have some
stored scripting novelties. We

107
00:12:57,125 --> 00:13:04,000
have potential and software
escalations as well and we will
talk about them. A basic user is

108
00:13:04,000 --> 00:13:10,000
here, if you use device user you
will have a response and you can
create this easily. But if you

109
00:13:13,417 --> 00:13:19,417
use upload features and if you
send a bogus file which contains
injections or a few bogus

110
00:13:22,750 --> 00:13:28,875
contents as well you will have
this error message. This error
message contains some additional

111
00:13:28,875 --> 00:13:34,875
errors, for example, soft
errors. Cisco says that it takes
this bug but it is not a novelty

112
00:13:37,625 --> 00:13:43,625
because there is no injection
here . I could not test it
because all of them was a part

113
00:13:46,125 --> 00:13:53,125
of a project in an engagement.
During the engagement I had only
5 days to test all this

114
00:13:53,125 --> 00:13:59,667
environment. HCS, infrastructure
also unified communication
system as well. This is why I

115
00:13:59,667 --> 00:14:04,750
could not try SP injections. If
you believe Cisco it is fine but
if you do not believe you can

116
00:14:04,750 --> 00:14:10,750
try using insecure file out put
features. It leaks; it has CGI
tools so you can create the

117
00:14:13,833 --> 00:14:19,417
qualified inclusion attacks and
execution as well. But they are
potential attacks, you can

118
00:14:19,417 --> 00:14:25,417
attack. Escalation is easy, you
can modify a user if you have
basic access, you will be a kind

119
00:14:28,833 --> 00:14:35,542
of location administrator of the
talent. You can modify the
environment and modify the user

120
00:14:35,542 --> 00:14:43,167
and add a different role on it
and add role for example talent
administration, division

121
00:14:43,167 --> 00:14:49,792
administrator or infrastructure
administrator. Furthermore if
you want to add a user you can

122
00:14:49,792 --> 00:14:57,750
use user type as well. If you
use user type, you can use admin
user and you can add a new admin

123
00:14:57,750 --> 00:15:04,167
from scratch. Furthermore we can
manipulate number translation to
redirect all calls or all

124
00:15:04,167 --> 00:15:11,000
extensions to us. So, basically,
we have many attacks. However we
have another measure service

125
00:15:11,000 --> 00:15:18,917
here and the services are
perform management feature of
Wahl solutions. Wahl solutions

126
00:15:18,917 --> 00:15:24,917
provide IP phone examine
services. This service is a
shell service. It is a family, a

127
00:15:27,792 --> 00:15:33,792
basic tool set, but it is a
basic shell object for all
talents. All phones, IP phones

128
00:15:36,708 --> 00:15:42,792
or cell phones or teleconference
room phones, or devises, it
doesn't matter. They will use

129
00:15:42,792 --> 00:15:48,417
this service. So basically we
can attack the service to get
additional access or compromise

130
00:15:48,417 --> 00:15:56,000
all talents. We can use
additional attacks on it. For
example, call forwarding, speed

131
00:15:56,000 --> 00:16:02,000
dialing manipulation, voice mail
access, pin changing, it is
still unpatched. Second week of

132
00:16:04,417 --> 00:16:10,417
September it will be in use.
This URL is the basic attack
service; SRV is the service type

133
00:16:13,250 --> 00:16:20,458
and service name. Device ID,
make and address and you can
easily get it. An action may be

134
00:16:20,458 --> 00:16:26,458
called for rewriting or updating
basic speed dial. It is very
secure, binary, unrecordable

135
00:16:31,500 --> 00:16:37,500
protocol. So it does not need
any authentication authorization
feature. Who can't record a XML

136
00:16:40,000 --> 00:16:46,000
file, right? Basically this
service works on an XML content.
You can not record an XML file,

137
00:16:49,750 --> 00:16:56,625
right. This is why I developed
two different models to exploit
this novelty. I will not share

138
00:16:56,625 --> 00:17:02,625
this exploit on my software
package but I will share here.
Furthermore I will show the

139
00:17:05,333 --> 00:17:11,583
service in a different way.
First problem is this product is
expensive. I have mentioned yet?

140
00:17:11,583 --> 00:17:17,792
Okay. But the thing is I cannot
provide a live demo on this
product because I have no Cisco

141
00:17:17,792 --> 00:17:24,958
UCDM here, that's why I
developed a fact service for it.
So basically I will use my

142
00:17:24,958 --> 00:17:30,958
exploits to this fact service. I
hope it will work, I hope you do
as well. But, we will see. Okay,

143
00:17:35,167 --> 00:17:37,167
we have a cheat sheet here and
basic Wahl's demos. This service
provides MAC based

144
00:17:37,167 --> 00:17:39,167
identamanagement, after that it
all services such as call
forwarding or speed dial. At

145
00:17:39,167 --> 00:17:42,208
this demo I will use the call
forwarding feature. I have this
service here, probably one of

146
00:17:42,208 --> 00:17:46,667
them. Ahh, here. This is our
fact service. We can copy on
past our code. Basically we us a

147
00:17:46,667 --> 00:17:52,667
model call forwarding, 4.1 which
is me my port and action and it
seems we have a target. If the

148
00:18:24,583 --> 00:18:31,583
MAC address is valid we will
have a display name of the faint
number. Faint number is eunuch

149
00:18:31,583 --> 00:18:36,250
in this environment. But this
faint number is basically
exemption. If you want to

150
00:18:36,250 --> 00:18:42,250
redirect it you should update
this faint number. So basically,
we will update it. For example

151
00:18:45,333 --> 00:18:51,333
set action, forward two. See, it
seems okay. Our display name is
007. Furthermore, we are talking

152
00:19:02,250 --> 00:19:07,083
about Cisco environments. Right?
We are not talking about IP
phones. We are talking about

153
00:19:07,083 --> 00:19:13,750
everything which means we have
jeopardy interface as well.
Jeopardy interface provides

154
00:19:13,750 --> 00:19:21,292
additional connectivity for
third party items as well such
as Cisco Jabber or regular Cisco

155
00:19:21,292 --> 00:19:27,292
clients. Furthermore, SDK for
all other third party clients
such as Microsoft Link. At this

156
00:19:29,667 --> 00:19:36,792
point we can use forwarding just
like this as well. For example
set forward to James Bond. And

157
00:19:36,792 --> 00:19:42,792
we can use name, agency name is
updated. I am showing this
because Microsoft Link and other

158
00:19:47,958 --> 00:19:55,208
products may need a main address
to handle a message or call. So
this is basic call forwarding we

159
00:19:55,208 --> 00:20:01,208
can update all talents and we
can redirect all phones to us
and we can redirect just like a

160
00:20:04,000 --> 00:20:10,000
basic internet exchange server.
We have additional speed dials.
Those phones need a speed dial

161
00:20:12,750 --> 00:20:19,792
service because they have no
speed dial on SIP protocol. That
is why they need a kind of

162
00:20:19,792 --> 00:20:25,792
protocol to provide this speed
dial access. That's why we have
another model here. Viproy was

163
00:20:28,000 --> 00:20:34,000
speed dial. Okay? Here we go. We
have three different speed dials
for this MAC address. MAC

164
00:20:37,833 --> 00:20:45,042
address can be obtained using
scan attacks as well. So we can
get a kind of communication map

165
00:20:45,042 --> 00:20:51,042
of the talent or all talents. So
we will have a communication
path. We can add or remove a

166
00:20:53,208 --> 00:20:59,208
content for example, add Viproy
to third position. Set action
list and run. See, Viproy is in

167
00:21:06,292 --> 00:21:11,125
the third position. We can try
to add Viproy to a specific
position, for example one. That

168
00:21:17,208 --> 00:21:23,208
position is not available
because it is in use. But, we
can modify this as well. So, get

169
00:21:30,250 --> 00:21:36,250
the list again, Viproy is in the
position now. This service is a
kind of dangerous service but

170
00:21:40,500 --> 00:21:45,333
the thing is it has been used
for all talents, we can jail
bait all platforms here. We can

171
00:21:45,333 --> 00:21:51,333
redirect everybody, every user
of all talents. Okay, if we go
back. We have additional

172
00:21:56,583 --> 00:22:04,042
features. We talked about web
based attacks. But the thing is,
sorry; I should show the fact

173
00:22:04,042 --> 00:22:11,750
services card and my expert card
here. My expert is, actually it
is pretty complicated. Actually

174
00:22:11,750 --> 00:22:17,292
it has bypass and depth bypass
issues as well. So, basically
you should very careful. Agency

175
00:22:17,292 --> 00:22:23,292
this is the exploit part. This
is my shock cord and agency,
this is ASR bypass feature,

176
00:22:25,417 --> 00:22:31,917
provide their name, field number
and forward to. If you do not
use forward to, you will not

177
00:22:31,917 --> 00:22:37,667
bypass sandbox and AS alarm and
dep as well. So basically
exploit is very complicated. I

178
00:22:37,667 --> 00:22:44,417
will not share this exploit
because it can be pretty
dangerous. However, I can share

179
00:22:44,417 --> 00:22:50,417
my fact service so you can find
how it works. Right? It is
already available on Viproy so

180
00:22:53,417 --> 00:22:59,417
basically you can work on this
fake web service to understand
how it works. Okay. We should

181
00:23:02,042 --> 00:23:09,167
continue. Sufficiently attacks,
we have additional voice over
web attacks here. Those are

182
00:23:09,167 --> 00:23:15,417
unified communication attacks.
We have TDM, PSDM and they are
old they think SIP is next

183
00:23:15,417 --> 00:23:21,917
generation and they think SIP is
ready to use for all unified
communication systems. However,

184
00:23:21,917 --> 00:23:27,917
they do not agree about features
of SIP that's why they modified
SIP. Not even Cisco. Cisco,

185
00:23:31,792 --> 00:23:37,792
Microsoft and all third party
vendors, because SIP has message
metals. It has invite as well.

186
00:23:41,167 --> 00:23:47,167
But, the thing is they use
secure sharing, adding file
transfer or a kind of voice mail

187
00:23:50,583 --> 00:23:56,583
using sample, Wildfire, etc.
Those are very complicated
things. You cannot use SIP just

188
00:23:56,583 --> 00:24:02,583
like that. That's why they
modified it. But they modified
SIP, regular SIP protocol. They

189
00:24:02,583 --> 00:24:08,583
have additional exemptions. We
will talk about a few ones. The
thing is Cisco has

190
00:24:12,917 --> 00:24:19,292
authentication problems about
SIP. Microsoft has a few
additional features on SIP.

191
00:24:19,292 --> 00:24:25,125
Yeah, we will talk about Cisco
now but we can talk about
Microsoft later. It is basically

192
00:24:25,125 --> 00:24:30,917
a Linux operating system so if
you will first remove the Cisco
unified communication and if you

193
00:24:30,917 --> 00:24:36,792
have a novelty you can execute
the code on a regular Linux
server. Keep the same

194
00:24:36,792 --> 00:24:42,750
formations. We should discover
web services using our regular
features such as Viproy

195
00:24:42,750 --> 00:24:49,375
discovery features, registry,
other tools. Furthermore, .....
are in the group tool, it is in

196
00:24:49,375 --> 00:24:56,958
use and developed by Zander
Gucci, thanks to him I have used
this tool for many years. After

197
00:24:56,958 --> 00:25:01,667
that I developed Viproy because
I needed additional
authentication features because

198
00:25:01,667 --> 00:25:08,500
authenticating SIP services it
needs some kind of
authentication. After

199
00:25:08,500 --> 00:25:14,500
authentication you may have
additional features. For example
registration, yeah you can get

200
00:25:18,583 --> 00:25:24,208
that kind of access on this SIP
server. And we talked about SIP
service attacks last year, and I

201
00:25:24,208 --> 00:25:28,667
actually demonstrated a few
advance attacks. But the thing
is Cisco SIP authentication is

202
00:25:28,667 --> 00:25:34,667
somehow different. It needs
address, device type and
exzantion. Three of them must be

203
00:25:42,750 --> 00:25:48,750
valid to authenticate you as a
form. If you want to use user
name and password it is fine, it

204
00:25:51,083 --> 00:25:57,083
is supported for third party IP
phones as well. Furthermore,
Cisco suggests that security

205
00:25:57,083 --> 00:26:03,292
requirement is essential for
voice over IP environment. So,
they can use digital certificate

206
00:26:03,292 --> 00:26:09,458
base for authentication. Cisco
unified communication provides
additional user name and you can

207
00:26:09,458 --> 00:26:15,458
use these errors. Register and
subscribe it is very easy task.
You can use Viproy; you check my

208
00:26:19,167 --> 00:26:25,167
presentation last year. You can
use or change your phone number
and address or regular text and

209
00:26:27,833 --> 00:26:34,250
we can use them. Furthermore I
have demonstrated additional
advanced attacks such as SIPro

210
00:26:34,250 --> 00:26:40,250
advanced attack. We can use
remote SIPro, other services to
attack. It was what we

211
00:26:43,375 --> 00:26:49,417
demonstrated last year.
Furthermore, we can use it to
attack other servers. For

212
00:26:49,417 --> 00:26:55,417
example, they provide four or
three billion messages which is
too much. If you send a bogus

213
00:26:58,292 --> 00:27:04,292
message you have errors. If you
use IP spoofing you can use
basic service attacks. Also we

214
00:27:08,083 --> 00:27:14,083
can use hacking SIP trust
relationships. We can use IP
spoofing, we can get a

215
00:27:18,542 --> 00:27:25,500
communication. After that, we
can add IP addresses in the
field. Find which IP address and

216
00:27:25,500 --> 00:27:33,500
port is trusted. I demonstrated
this last year this, and we
initiated a base call. Also, we

217
00:27:33,500 --> 00:27:37,792
can attack mobile applications
using this as well. But the
thing is.... is somehow

218
00:27:37,792 --> 00:27:44,458
different in the same
environment. First of all Cisco
UCM accepts addresses as

219
00:27:44,458 --> 00:27:51,958
identity and it doesn't need
further authentication for many
SIP based IP phones, and our own

220
00:27:51,958 --> 00:27:57,958
skinny environment. Also, we can
find raw waste in the same
environment, it will provide for

221
00:28:01,750 --> 00:28:09,042
users, antennas and all the
other environments. However,
they need citrons connections,

222
00:28:09,042 --> 00:28:16,083
that's why they use additional,
some connections are looters.
That's why we can use them to

223
00:28:16,083 --> 00:28:22,583
initiate calls because they have
no identification by default. We
can use custom headers, we can

224
00:28:22,583 --> 00:28:29,833
add specific headers. Here is
the thing, remote party ID is
where generic header and Cisco

225
00:28:29,833 --> 00:28:35,833
accepts remote party ID because
it is a kind of compatibility
issue. So, if add a basic remote

226
00:28:41,208 --> 00:28:47,083
party ID in our current
connection, authenticated
connection, Cisco will accept

227
00:28:47,083 --> 00:28:53,083
remote party ID as an identity.
So we call everywhere with a
fake identity. Caller ID

228
00:28:57,083 --> 00:29:03,125
spoofing, yes, it bypasses the
billing features furthermore we
can access voice mail and third

229
00:29:03,125 --> 00:29:09,125
party operators. Here is the
thing; we have public real world
attacks such as caller ID fraud

230
00:29:11,292 --> 00:29:19,083
for all operators. If we had an
operator we could not initiate
our attack, caller ID spoofing

231
00:29:19,083 --> 00:29:25,083
attack. Initiate a call through
the land line connections to
call the third party GSM

232
00:29:27,625 --> 00:29:33,625
operator to access a voice mail
account without a pin. It's all
caller identity, it's an attack

233
00:29:36,500 --> 00:29:43,250
and it is in use. Also we can
send call back messages, we can
send fake messages, we can use

234
00:29:43,250 --> 00:29:49,250
spam, we can use this attack
against other operators and we
can use for other terms. And

235
00:29:51,667 --> 00:29:57,583
this is a basic demonstration of
an attack. I already
demonstrated other SIP attacks,

236
00:29:57,583 --> 00:30:03,583
you find my last presentation,
voice over IP, it is on you tube
as well. I will use a basic SIP

237
00:30:09,792 --> 00:30:15,792
connection here. We will use our
invite model and we have two
different clients here. First

238
00:30:22,125 --> 00:30:29,625
one and second one and they are
connected through a Cisco
server. It is a trial edition so

239
00:30:29,625 --> 00:30:35,625
basically we will have a trial
access and yes it works. I have
registered forms here and I will

240
00:30:39,458 --> 00:30:45,458
use invite model with proto TCP.
We have TCP on tailor support
now so we can use it.

241
00:30:47,875 --> 00:30:54,625
Furthermore we will use specific
phone number and log in
features, furthermore we have

242
00:30:54,625 --> 00:31:02,000
different log in metals, I
choose register. Furthermore, we
have vander extensions and it

243
00:31:02,000 --> 00:31:09,542
must be used. Vander extensions
first one is Cisco device. If
you want to register yourself as

244
00:31:09,542 --> 00:31:17,333
an IP phone such as 7940 or 41
you should use Cisco device with
application. If you want to use

245
00:31:17,333 --> 00:31:23,917
third party device such as third
party clients you should use
Cisco unification header, after

246
00:31:23,917 --> 00:31:29,917
that my user name and password.
This is not a novelty, see we
have a call. And yeah, the thing

247
00:31:31,958 --> 00:31:37,958
is it is one of thirteen. Let me
explain why. If I had set the
remote party header it will have

248
00:31:43,458 --> 00:31:49,458
a call from 2001 which is my
original one, right, see. But
the thing is we can set custom

249
00:31:54,792 --> 00:32:00,792
IDs. For example from James Bond
or we can use a current client
for example, 1013. Also we have

250
00:32:04,792 --> 00:32:10,792
additional features here, for
example sending a message. We
have no public tool to send a

251
00:32:19,958 --> 00:32:25,958
message. We should manipulate or
we should prepare our tools such
as SIP and after that we can

252
00:32:33,500 --> 00:32:37,875
send a message, right? But we
can manipulate message features
such as message tie or message

253
00:32:37,875 --> 00:32:44,208
content that is used for
additional sharing features of
third party clients such as

254
00:32:44,208 --> 00:32:50,208
Cisco jabber. So basically we
can change this content to
attack different clients using

255
00:32:52,708 --> 00:32:59,750
different scale. For example
message tie, fuzz 2000, it is
possible as well. But I will use

256
00:32:59,750 --> 00:33:05,750
this sample for a basic search
engine feature. Operators hack
the operator because bypassed

257
00:33:11,000 --> 00:33:18,542
identification. Furthermore, it
is the basic HTML feature, HTML
message. So basically we can

258
00:33:18,542 --> 00:33:26,542
send this message to the real
phone as well. If it receives
this message, if it is a smart

259
00:33:26,542 --> 00:33:32,542
phone as well, this can be good.
Furthermore, we can change
message content, for example

260
00:33:38,083 --> 00:33:44,083
message tie, it is still text
and plain but message content
could be fast 500, fast 5000. It

261
00:33:55,833 --> 00:34:03,333
depends on you. Some of the
clients they are really
vulnerable such as Cisco Jabber

262
00:34:03,333 --> 00:34:09,333
or for example XLight or you
know Microsoft Link. Yeah, we
will continue with other

263
00:34:15,750 --> 00:34:23,500
attacks, because we can attack
clients. I mentioned client
attacks last year so I will pass

264
00:34:23,500 --> 00:34:29,833
this slide I already provided
this slide on my presentation so
you can check them as well. And

265
00:34:29,833 --> 00:34:34,708
Cisco has different clients and
we can attack all of them we can
use attacks as well. And I have

266
00:34:34,708 --> 00:34:40,917
a tool for it. Reproxy is
another tool I have developed
for TCP, TNS interception.

267
00:34:40,917 --> 00:34:48,833
Furthermore, it supports custom
digital search features. It has
low feature it has multiple

268
00:34:48,833 --> 00:34:54,833
duplication as well. It is a
fork of proxy. So basically we
have used this tool to

269
00:34:57,667 --> 00:35:05,083
manipulate other clients. It has
multiple issues; sorry about
that but I will fix it in a few

270
00:35:05,083 --> 00:35:12,125
months. You can fix it as well,
it is available on Viproy. I
would appreciate a few patches.

271
00:35:12,125 --> 00:35:18,125
This is a basic SIP fishing demo
and I already showed it. Basic
client attack demos, we can use

272
00:35:20,375 --> 00:35:27,750
them as well. I have crashed an
IOS application last year using
only spoofing, so we can attack.

273
00:35:27,750 --> 00:35:35,000
But, this is not the case. We
should talk about skinny as
well. Skinny is a generic

274
00:35:35,000 --> 00:35:41,000
protocol. Cisco uses it for all
local environments. Even for
hosted voice over IP services.

275
00:35:43,625 --> 00:35:51,083
It is a kind of compatibility
requirement because they will
use SIP by default. They will

276
00:35:51,083 --> 00:35:57,083
use skinny for regular SIP
phones, regular Cisco IP phones.
It is a kind of protocol so

277
00:36:01,917 --> 00:36:09,542
basically you should use many
packages to register yourself.
We can use basic attacks, when I

278
00:36:09,542 --> 00:36:17,000
search, VoIP or SIP attacks or
skinny attacks; I sell always
one single name, Jace Nostrom.

279
00:36:17,000 --> 00:36:23,000
He has a pension about VoIP but
not only VoIP as well he helped
me too much for this

280
00:36:25,042 --> 00:36:31,042
presentation, thank you for him
again. Of course Viper and Spara
they have published some tools

281
00:36:33,083 --> 00:36:39,708
and novelties on skinny. I am
not sure about Viper 11 as
skinny support because I saw a

282
00:36:39,708 --> 00:36:45,708
communication but I am not sure
because there is no information
on their page and yeah. Also

283
00:36:48,167 --> 00:36:54,917
Felix found a few novelties on
skinny protocol. But we have no
public skinny analyzer or skinny

284
00:36:54,917 --> 00:37:00,917
tool. That is why I decoded this
protocol using Y Shock, just
like it. But the thing is it is

285
00:37:03,333 --> 00:37:09,333
different versions, such as 17,
19, 20, so some of the packages
and samples are not available on

286
00:37:12,625 --> 00:37:18,542
Y Shock consult. So basically
you cannot decode them. There is
one item of this library, right

287
00:37:18,542 --> 00:37:25,708
side basic skinny passer, it has
many different options for many
different responses from server

288
00:37:25,708 --> 00:37:31,708
and left side is a basic sample.
Signing the register, it is
pretty easy. Everybody develops

289
00:37:34,583 --> 00:37:41,208
a basic skinny model. But the
thing is, developing a skinny
model; yes it is easy, such as

290
00:37:41,208 --> 00:37:45,875
register or call. It is pretty
easy. But if you need more, you
can develop using same library

291
00:37:45,875 --> 00:37:51,875
as well, because I provide a
basic library through
Metasploit. So you can basically

292
00:37:57,417 --> 00:38:03,417
develop your own... on skinny. I
have a basic... but it is not
good right now. But, think about

293
00:38:05,708 --> 00:38:13,167
it, register needs no
authentication, right? First
register packages. So basically,

294
00:38:13,167 --> 00:38:19,167
many...but nobody...for example
button templates, or nobody ...
the remote server during a call.

295
00:38:23,792 --> 00:38:30,667
So you can do it because all
packages and all comments very
easy for example prep, open,

296
00:38:30,667 --> 00:38:36,667
receive channel. And you can use
a bogus device app here or a
port. So it's a kind of new

297
00:38:38,917 --> 00:38:46,458
attack surface for you. But I
have a demo as well. If you
register it to a specific mega

298
00:38:46,458 --> 00:38:52,750
address we can use regular
clients as well such as Cisco IP
Communicator, it supports device

299
00:38:52,750 --> 00:38:59,250
name, custom device name and you
can use your device name here,
if you have a registration. Here

300
00:38:59,250 --> 00:39:05,250
is the demo. I have Cisco
communicator right side. I have
Cisco UCM, I have Cisco UCM 912.

301
00:39:11,458 --> 00:39:17,458
But I tested all the novelties
on 10.5.1, 10.5.2 and lower
versions so it works with them.

302
00:39:19,625 --> 00:39:25,042
It has two different options
Cisco IP Communicator or regular
Cisco IP phone. You can use all

303
00:39:25,042 --> 00:39:30,833
of them. In this sample, I have
two different clients; let me
check they can call each other.

304
00:39:32,875 --> 00:39:38,875
They can call, good and they
called, and yeah. Now we will
use skinny attacks. This is a

305
00:39:44,250 --> 00:39:50,250
basic register plug in.
Basically we will use remote
target MAC address and IP

306
00:39:57,083 --> 00:40:02,750
address, that's all. IP
addresses, server IP address MAC
addresses, IP phones MAC

307
00:40:02,750 --> 00:40:08,750
address. After that we can
register. Agency, I can
attribute information of this

308
00:40:12,333 --> 00:40:19,542
MAC address such as line ID's.
But the thing is I am not using
MAC spoofing here. I am using

309
00:40:19,542 --> 00:40:24,333
MAC address in the connection as
an identity, that's all. There
is no MAC spoofing here. So, I

310
00:40:24,333 --> 00:40:30,333
can use other MAC addresses such
as this MAC address. When I use
this MAC address agency lift up

311
00:40:33,583 --> 00:40:39,583
our first line. It is
disconnected now. It's a kind of
service for older versions. I

312
00:40:41,958 --> 00:40:48,417
reviewed the information which
line is available for this MAC
address and I am one of them.

313
00:40:48,417 --> 00:40:55,625
But the thing is we can insure
the call here. For example, I
can call anyone. This is another

314
00:40:55,625 --> 00:41:01,625
model, Viproy skinny call and I
will use another MAC address and
my target is 1,013. When I use

315
00:41:09,250 --> 00:41:17,083
it, it will be registered first
and the Agency it is here. I do
not fix this error. It is

316
00:41:17,083 --> 00:41:23,125
necessary because if the other
client, real client, will try to
connect, re-connect, you will

317
00:41:23,125 --> 00:41:26,750
have this error. Because your
PTC connection will be
terminated, that will be only

318
00:41:26,750 --> 00:41:33,792
one single client. This is why I
keep this error. This says the
remote client is trying to

319
00:41:33,792 --> 00:41:39,792
reconnect. We will try it again,
see it will work. So, it is
registering now and we are

320
00:41:42,958 --> 00:41:48,958
getting confirmation and we are
calling, see from 1001. Okay,
register called we can

321
00:41:52,500 --> 00:41:59,083
additional features such as call
forwarding, it is more useable
one. It is still trying to

322
00:41:59,083 --> 00:42:05,083
register, but if you try to
redirect this phone number 1012,
1013, it will be really good for

323
00:42:08,625 --> 00:42:14,292
us, right? Because, we can
redirect all phones to us, after
that we can redirect them to

324
00:42:14,292 --> 00:42:20,292
anywhere. It is connected right?
When I try to register it is
disconnected again. It may try a

325
00:42:28,458 --> 00:42:34,458
few times but it will have
success. Lines open for call
forwarding, 1013 numbers dialed

326
00:42:38,542 --> 00:42:44,542
and see it is forwarded. This is
my skinny model and you can use
basic features such as register,

327
00:42:47,583 --> 00:42:54,417
call or call forwarding or you
can turn it as a kind of
advanced pauser so you can

328
00:42:54,417 --> 00:43:00,417
attack remote Cisco UCM's using
this attack. As you see I did
not talk about toll fraud too

329
00:43:02,542 --> 00:43:08,542
much because we have a good
speaker here. Patrick McNeil
provided a really good, maybe

330
00:43:10,708 --> 00:43:18,333
best toll fraud speech ever,
this afternoon, sorry this
morning. And it was really good

331
00:43:18,333 --> 00:43:25,875
and you should get a video or
presentation and please visit
our register 436. Am I right?

332
00:43:25,875 --> 00:43:32,208
Okay good. So he has a really
good toll fraud speech. And I am
talking about other attacks. So

333
00:43:32,208 --> 00:43:37,167
basically, we can attack
network, we can attack Cisco
UCM, we can attack Cisco Unified

334
00:43:37,167 --> 00:43:42,125
Communication Domain Manager
clients, skinny protocol, SIP,
we can attack everywhere.

335
00:43:42,125 --> 00:43:49,667
Solutions, our solutions
published by Cisco and we have
additional suggestions. First of

336
00:43:49,667 --> 00:43:57,417
all, IP phone examiner service
or remote party ID. This ..and
they are yeah, they are still

337
00:43:57,417 --> 00:44:02,750
unpatched and you can attack
these servers using remote party
ID or IP phone examiner

338
00:44:02,750 --> 00:44:08,750
services. Furthermore, you can
use other novelties and starting
from 3277 to 3283. Furthermore,

339
00:44:12,917 --> 00:44:18,917
a few additional novelties and
92, sorry 97 and 32 sorry 3302
and we have yeah, many novelties

340
00:44:22,792 --> 00:44:28,583
here almost twelfth series
assigned, some of them not here
because they are information

341
00:44:28,583 --> 00:44:35,458
level. And yeah, basically you
should secure your design we
have attack services on

342
00:44:35,458 --> 00:44:41,167
everywhere we can attack server,
we can attack protocols, we can
attack lines and we can attack

343
00:44:41,167 --> 00:44:47,167
web applications as well.
Basically security deployment
and good design they may help

344
00:44:49,708 --> 00:44:56,583
you to secure the network.
That's all. And yeah, I have
references that you can download

345
00:44:56,583 --> 00:45:03,625
that you were here. I have a 15
minute training video, also I
have another Def Con video you

346
00:45:03,625 --> 00:45:09,625
can use you tube to find it. And
we have agency attacks there.
Furthermore, I really

347
00:45:12,208 --> 00:45:18,208
appreciated a Sense of Security
team they supported me too much
actually. They encouraged me

348
00:45:20,875 --> 00:45:26,583
again and again here.
Furthermore Jeff Norstrom helped
me too much about this

349
00:45:26,583 --> 00:45:32,583
presentation. Furthermore, some
good suggestions about my point
of view. Also, Mark, Paul Henry

350
00:45:37,000 --> 00:45:44,958
and Sandra, of course. This is
my presentation, this is what I
have. Do you have any questions

351
00:45:44,958 --> 00:45:50,958
related with this topic? I
cannot see by the way. Do you
have any questions? No question?

352
00:45:55,583 --> 00:46:01,583
You do not give any questions
here, okay? Okay, thank you.
(Applause) 

