1
00:00:00,208 --> 00:00:05,625
 >> Hi There. I'm Paul Vixie.
Thank you all for coming. I'm
not use to seeing so many of you

2
00:00:05,625 --> 00:00:11,625
at 10:00 am but I guess it is
the first day so you haven't had
any parties yet. So, this is

3
00:00:15,292 --> 00:00:21,667
about DNS Problems and Solutions
and before you ask I will say,
this is not an exhausted list of

4
00:00:21,667 --> 00:00:29,583
all the DNS problems I have
caused nor every DNS solution.
Nor of the list of problems I

5
00:00:29,583 --> 00:00:35,042
have created by the list of
solutions I have created. So, if
you want to talk about why I

6
00:00:35,042 --> 00:00:40,875
used IP fragmentation and
RFC2671, the hallway is out
there and don't burn Q&AQ time

7
00:00:40,875 --> 00:00:46,875
stuff like that. Uhm, good. this
is a subset of DNS problems and
solutions which A, fits in a one

8
00:00:50,667 --> 00:00:56,667
hour slot B, is kind of selected
as of interest for this
audience. And in general I am

9
00:00:59,583 --> 00:01:06,417
going to talk about what DNS is
to me which might be a little
different than what it is to the

10
00:01:06,417 --> 00:01:12,417
average user or sys admin or
protocol engineer for that
matter. I'm going to talk about

11
00:01:14,458 --> 00:01:20,917
how DNS has affected the world
and what the world is doing
about it. And then I want to

12
00:01:20,917 --> 00:01:26,917
show you some cool shit.
Breidbart gave an off the cuff
answer to a question and his

13
00:01:38,500 --> 00:01:45,333
answer has been widely quoted.
He asked, what is the internet?
The point of discussion was yes,

14
00:01:45,333 --> 00:01:51,667
we all have a lot of IP
networks, they aren't all
connected to the big network.

15
00:01:51,667 --> 00:01:57,708
How do you differentiate? And he
came up with the definition.
Which simply says, the big one

16
00:01:57,708 --> 00:02:01,917
is the internet everything else
is just a little internet that's
disconnected and is just a toy.

17
00:02:01,917 --> 00:02:07,917
And what is most interesting is
what he said, the internet is
all about packets. So we may use

18
00:02:11,292 --> 00:02:19,167
it for all kinds of commerce
things or other communication
purposes but at it's root, it is

19
00:02:19,167 --> 00:02:26,167
bunch of wires, containing
information segments that are
packets and they are addresses.

20
00:02:26,167 --> 00:02:32,167
and the addresses are in an
autonomous system. So we overlay
a lot of other things on top of

21
00:02:34,583 --> 00:02:40,667
this packet structure. For
example we have routers and
swithches and as I mentioned we

22
00:02:40,667 --> 00:02:46,667
have IP address blocks,
autonomous system numbers. These
are just overlays, they are ways

23
00:02:46,667 --> 00:02:51,542
we glue certain collections of
addresses together in a way that
makes business sense, technical

24
00:02:51,542 --> 00:02:59,417
sense or philosophical sense to
us. To me, the most interesting
overlay is not the web, overlaid

25
00:02:59,417 --> 00:03:05,417
not he internet but rather DNS.
So, if the internet was a
territory, DNS really would be

26
00:03:10,917 --> 00:03:16,917
it's map. Unless you are using a
lot of peer to peer botnit
(msp.) or pure file system, file

27
00:03:19,042 --> 00:03:24,208
sharing system, I realize that's
common in this room. Pretty much
whatever you do will be a TCP

28
00:03:24,208 --> 00:03:31,083
session and any TCP session will
begin with 1 or more DNS
transaction. Luckily theres TCP

29
00:03:31,083 --> 00:03:37,542
sessions go pretty fast and they
are cached and you don't usually
notice them. But if you are in

30
00:03:37,542 --> 00:03:43,500
the DNS industry you are use to
dealing with the fire hose end
of that equation and can cause

31
00:03:43,500 --> 00:03:50,083
an awful lot of traffic and an
awful lot of electricity and
person hours to make it all

32
00:03:50,083 --> 00:03:56,083
work. Well, in any case DNS is
still there, even in mobile.
Right, and a lot of people are

33
00:04:01,833 --> 00:04:06,042
not writing domain names. If
someone wants to go somewhere
they are clicking on something

34
00:04:06,042 --> 00:04:12,583
or picking up their phones
saying, okay Google, take me to
a certain place. Every place you

35
00:04:12,583 --> 00:04:20,292
want to go, your mobile system
is actually through DNS, you
can't get there without. You may

36
00:04:20,292 --> 00:04:27,042
not see it but there are still
present even with the new
fangled StarTrek that we are

37
00:04:27,042 --> 00:04:32,750
starting to use our new smart
phones. And the great thing
about that with the DNS

38
00:04:32,750 --> 00:04:39,500
perspective is there is a
rigorous internal structure. You
can lie endlessly about who you

39
00:04:39,500 --> 00:04:45,708
are and where you are when you
are posting a comment on
someone's blog, send an email,

40
00:04:45,708 --> 00:04:51,708
steal credentials. But, if you
want to get work done, on the
internet, you're going to have

41
00:04:56,875 --> 00:05:02,875
your services on and available
in DNS. You can bend those rules
and you can do your best to

42
00:05:05,708 --> 00:05:11,708
hide, but you cannot entirely
hide. And that is why I, as a
traditional DNS from the late

43
00:05:14,542 --> 00:05:22,250
80's to now, really trended
towards security. It's such an
obvious overlay. If you want to

44
00:05:22,250 --> 00:05:27,917
know where the people are, where
their assets are and how they
attacked you and how and so

45
00:05:27,917 --> 00:05:33,917
forth. Studying the DNS is the
highest leverage way I know to
find out that stuff. Sorry,

46
00:05:37,792 --> 00:05:43,792
having trouble seeing my own
slides. So criminals have to use
DNS just like we do. They can

47
00:05:46,708 --> 00:05:54,167
buy cheap domain names. And they
can indeed use them for a short
period of time then throw them

48
00:05:54,167 --> 00:06:01,375
away. But whatever they hosted
them, wherever they were,
wherever they still are has to

49
00:06:01,375 --> 00:06:06,125
be visible. Otherwise their
criminal assets are not going to
be reachable by their victims

50
00:06:06,125 --> 00:06:12,042
which turns out to be necessary.
Once you are reachable, once you
have a specific location, then

51
00:06:12,042 --> 00:06:16,292
everything else that has a
related location starts to look
related to whatever you were

52
00:06:16,292 --> 00:06:23,917
doing. And that has turned out
to have huge value to those of
us who sort of spend our lives

53
00:06:23,917 --> 00:06:29,917
protecting things. And quoting
Frances Bacon here who said
nature to be commanded must be

54
00:06:32,500 --> 00:06:39,167
obeyed. That is true of DNS as
well. You can hide your who is,
either with who is privacy or

55
00:06:39,167 --> 00:06:46,375
using garbage addresses but you
cannot hide your DNS services.
The answers you gave and the

56
00:06:46,375 --> 00:06:52,375
server that's gave those answers
are a matter of more or less
public record. So, about that

57
00:06:54,667 --> 00:07:01,708
internal structure. Every domain
name is in a zone. I promise
this is the only slide in this

58
00:07:01,708 --> 00:07:07,708
presentation that will make your
eyes glaze over. For example com
is a zone and VIX.com is my name

59
00:07:11,417 --> 00:07:17,042
is at the bottom of that zone.
But is also at the top. In other
words, that's a delegation

60
00:07:17,042 --> 00:07:23,042
point. That's a point where
they've been told to register
the system that VIX.com is not

61
00:07:25,250 --> 00:07:31,250
part of the name. Basically it
is a delegation record set that
says from VIX.com down that is

62
00:07:36,167 --> 00:07:42,167
Paul's server, that's a zone
cut. Every zone cut has some
name servers. These name servers

63
00:07:44,917 --> 00:07:49,917
are designated by name. In other
words, name servers themselves
has fully qualified domain names

64
00:07:49,917 --> 00:07:56,042
identifying them. And every one
of those name servers has one or
more addresses. Some are IP

65
00:07:56,042 --> 00:08:03,167
four, A record, some are IP V
six, quad rules. Again, these
are the rules. This is as

66
00:08:03,167 --> 00:08:08,417
Frances Bacon would say
"nature." If you want to command
it through criminal enterprises,

67
00:08:08,417 --> 00:08:12,208
this is the part you have to
obey. You are not going to be
able to do anything online for

68
00:08:12,208 --> 00:08:18,208
good or evil without following
this. And fun stuff happens
after that. So in traditional

69
00:08:21,542 --> 00:08:27,958
DNS forensics, let's say you
have been spammed or worse and
you've got in your hand a domain

70
00:08:27,958 --> 00:08:33,958
name, you might want to know
what does that domain name point
at? Where was the server that

71
00:08:36,125 --> 00:08:41,333
sent it to me or where was the
server that my victim ended up
clicking on something that

72
00:08:41,333 --> 00:08:46,792
looked like their bank but
wasn't and so forth? What's the
answer? What you do,

73
00:08:46,792 --> 00:08:51,708
traditionally speaking is ask
the DNS question yourself that
you think your victim might have

74
00:08:51,708 --> 00:08:58,792
asked. What is the A record,
quad A record or MX record. What
is the record set of a certain

75
00:08:58,792 --> 00:09:06,458
type that corresponds to the
name that was used in the
attack. This has some

76
00:09:06,458 --> 00:09:10,958
disadvantages. First is, it may
already have been taken down by
the time you are doing your

77
00:09:10,958 --> 00:09:18,042
analysis. Second is, if it isn't
down, it's up. And the bad guy
who is presumably running the

78
00:09:18,042 --> 00:09:23,333
name server for that property
will see your query and will
know and be able to trace at

79
00:09:23,333 --> 00:09:28,542
least the outward edges of your
investigation. When did it
begin? What questions did you

80
00:09:28,542 --> 00:09:34,542
ask? And who are you? By the
way, this tendency we all have
to issue our DNS queries through

81
00:09:38,083 --> 00:09:45,000
the core system in order to
avoid, you know, having it be
known that yes we were the

82
00:09:45,000 --> 00:09:51,625
investigator either law
enforcement or private that was
looking this up. Because pretty

83
00:09:51,625 --> 00:09:55,042
much the criminals are not
sending queries through
(inaudible). So you might be

84
00:09:55,042 --> 00:09:58,750
able to stop them from knowing
which is looking them up, but
the fact it came from a Torax

85
00:09:58,750 --> 00:10:04,750
Gateway really tells the bad
guys they're being chased. Any
bad guy who doesn't want you to

86
00:10:12,708 --> 00:10:18,708
know what his home address is
going to use a stolen credit
card and use the home address

87
00:10:22,417 --> 00:10:28,125
that corresponds to the owner of
that credit card. Or they'll
just type ASDF into the who is

88
00:10:28,125 --> 00:10:34,042
fields and it will take a couple
years for the ICANN wheels to
grind that out. Or they can pay

89
00:10:34,042 --> 00:10:40,042
extra and get who is privacy.
And who is privacy is a whole
other topic. But the point is,

90
00:10:43,042 --> 00:10:46,917
who is not going to help you
very much. I realize there are
companies in the business of

91
00:10:46,917 --> 00:10:54,083
selling both who is data and
history and I don't want to say
they are lying about the utility

92
00:10:54,083 --> 00:10:59,208
of their services. I'm just
saying for my purposes, I have
never depended on who is. And I

93
00:10:59,208 --> 00:11:05,208
might look at it as a hint but I
won't count on it and neither
should you. So DNS has certain

94
00:11:09,500 --> 00:11:15,125
properties that have had certain
impacts. The world has reacted
in certain ways. We'll talk

95
00:11:15,125 --> 00:11:21,125
about that. When atomic power
was first announced to the
universe it was described as

96
00:11:24,167 --> 00:11:29,000
being too cheap to meter. The
idea was we were going to have
electricity in every home in

97
00:11:29,000 --> 00:11:35,000
America. That was so cheap there
wouldn't even be a power meter.
Nobody would worry about it.

98
00:11:43,833 --> 00:11:48,167
Obviously, this didn't happen.
And a lot of other things.
Turned out not to happen either.

99
00:11:48,167 --> 00:11:52,167
Like it's the distribution that
cost the money not the
generation. So difficult to know

100
00:11:52,167 --> 00:11:56,500
what they thought they were
saying. But this expression "too
cheap to meter" really is, I

101
00:11:56,500 --> 00:12:01,833
think, a great way to describe
the DNS industry today. You can
now buy a domain name with a

102
00:12:01,833 --> 00:12:08,250
stolen credit card from a
registrar in some fly over
country in old Europe and it

103
00:12:08,250 --> 00:12:16,250
will be active for the entire
world to be able to reach in
less than three minutes. I think

104
00:12:16,250 --> 00:12:21,875
that's an amazing set of
technical obstacles that had to
be overcome. I'm very impressed

105
00:12:21,875 --> 00:12:27,500
that we got it done. Any one
person, any good sys admin team
even can do something like that.

106
00:12:27,500 --> 00:12:32,542
To get the whole world to
cooperate on something like
that, that is a tough problem.

107
00:12:32,542 --> 00:12:39,500
It took about a decade. My
challenge is to try to imagine a
good purpose for that

108
00:12:39,500 --> 00:12:45,708
capability. Why does your
average person who is opening a
flower shop down on Third Avenue

109
00:12:45,708 --> 00:12:52,375
need to be able to create their
domain in less than three
minutes? Why is a stolen credit

110
00:12:52,375 --> 00:12:57,833
card good enough collateral to
be able to enable this global
resource to exist? The level of

111
00:12:57,833 --> 00:13:03,917
fluidity that we have in the
system really only has one
purpose and that is to annoy

112
00:13:03,917 --> 00:13:09,583
people. Either criminal purposes
or non‑criminal purposes. But
we're talking about a system

113
00:13:09,583 --> 00:13:16,125
fundamentally the DNS is
fundamentally a system that has
bilateral value. It is something

114
00:13:16,125 --> 00:13:21,125
we all contribute to, we all
sort of drink the Koolaid. We
speak the same protocol for the

115
00:13:21,125 --> 00:13:26,792
same set of name servers. We
describe more or less to the
same name space because we think

116
00:13:26,792 --> 00:13:33,083
it is a public good. We think
the good that comes to us will
outweigh whatever cost comes

117
00:13:33,083 --> 00:13:39,083
from us in order to support that
system. This is a unilateral
purpose. This is somebody who

118
00:13:49,875 --> 00:13:53,750
want as domain name so they can
spam you with it or they can
issue a phishing attack or

119
00:13:53,750 --> 00:13:57,208
pollute a search engine or
whatever. So, you know, please
jump out of your chair and rush

120
00:13:57,208 --> 00:14:00,625
to a microphone right now if you
can think of a non‑annoying
purpose for the fluidity that

121
00:14:00,625 --> 00:14:06,625
allows a domain name to be
created at a cost that is too
low to meter. So the revelation

122
00:14:09,750 --> 00:14:17,583
was that 90 percent of pretty
much any given thing is crap.
That just goes to .2, our

123
00:14:17,583 --> 00:14:21,292
pessimism. We are top ten
percenters. We look at the top
ten percent and say that's

124
00:14:21,292 --> 00:14:25,250
barely acceptable and the rest
is crap. It doesn't matter what
it was we were looking at,

125
00:14:25,250 --> 00:14:29,917
that's how we are going to feel
about it. That that was
twentieth century thinking but

126
00:14:29,917 --> 00:14:35,708
it seems to be continuing now. I
can tell you that 90 percent is
low when it comes to domain

127
00:14:35,708 --> 00:14:42,375
names. We have a feed I will
describe at the end of this a
newly observed domain feed and I

128
00:14:42,375 --> 00:14:48,375
pretty much see the domain name
system. I now know what it looks
like. What the creation rate of

129
00:14:50,542 --> 00:14:56,542
new domains are and what they
look like. And it is a lot
higher than 90 percent crud. So

130
00:15:00,750 --> 00:15:06,500
if you want to sort of put some
back pressure, -- remember this
is about DNS actions and

131
00:15:06,500 --> 00:15:12,500
reactions. If you want some back
pressure against that too cheap
to meter creation system so that

132
00:15:12,500 --> 00:15:18,000
the people who create most of
this crud can't use it to annoy
you, then you have a whole bunch

133
00:15:18,000 --> 00:15:23,958
of work that you have to do. And
this work has ‑‑ this is a
burden that's been shifted to us

134
00:15:23,958 --> 00:15:29,458
as recipients or as, you know,
people who would rather that all
of our communications be

135
00:15:29,458 --> 00:15:34,083
consensual and we're in kind of
a low level cold war against
people who think that

136
00:15:34,083 --> 00:15:40,083
non‑consensual communication is
better for them. So because we
can't prevent these names from

137
00:15:42,500 --> 00:15:47,667
being created we end up having a
whole bunch of cross burden
shifted to us that has to do

138
00:15:47,667 --> 00:15:55,417
with dealing with them. Coping
strategies for dealing with all
of this crud. And probably the

139
00:15:55,417 --> 00:16:01,583
most prevalent kind right now is
takedown. And there are a lot of
different kinds of takedown. I'm

140
00:16:01,583 --> 00:16:08,833
referring specifically to DNS
takedown rather than D peering
or taking somebody's IP address

141
00:16:08,833 --> 00:16:15,208
away or putting them in jail or
any other takedown efforts that
are also quite effective. You

142
00:16:15,208 --> 00:16:21,417
can now buy takedown as a
service. You can either buy this
from brand enforcement companies

143
00:16:21,417 --> 00:16:26,208
or you can just have somebody on
call, some security company and
I'm not going to name any names.

144
00:16:26,208 --> 00:16:31,292
There are some good ones but I
would be afraid of leaving any
out if I gave you an even

145
00:16:31,292 --> 00:16:37,292
partial list. A lot of security
companies now are in the
business of taking phone calls

146
00:16:37,292 --> 00:16:43,292
from you as a brand owner and
going after that domain name.
They've got a lot of private

147
00:16:46,125 --> 00:16:50,583
relationships among the
registrars and the registries of
the world. They can give a

148
00:16:50,583 --> 00:16:56,000
trusted phone call in place in a
few minutes that will probably
cause a domain name that is

149
00:16:56,000 --> 00:17:00,667
infringing on one of your
trademarks or maybe it's being
used in a phishing attack

150
00:17:00,667 --> 00:17:05,875
against you, they can probably
get that wiped out in a few
minutes. And that's incredibly

151
00:17:05,875 --> 00:17:10,917
impressive. I think by now we've
all learned the lesson that do
is who is on it, finding out the

152
00:17:10,917 --> 00:17:15,042
domain contact and sending them
mail saying please stop annoying
me is probably not going to

153
00:17:15,042 --> 00:17:21,042
work. So this is a great profit
center, in fact, for some domain
registries and registrars. In

154
00:17:27,208 --> 00:17:33,208
other words, they have created
some systems now, almost like an
RT ticketing system or similar

155
00:17:36,167 --> 00:17:43,958
automation that they will give
you an account that allows you
to put your high value

156
00:17:43,958 --> 00:17:50,500
complaints in against a domain
name which would cause it to be
very quickly reviewed and

157
00:17:50,500 --> 00:17:58,292
probably put spaces, put on hold
some way while they complete the
investigation and then just nuke

158
00:17:58,292 --> 00:18:05,708
it if it turns out to be what I
said, crud. The reason that
they're so happy to do this is

159
00:18:05,708 --> 00:18:12,417
because that means criminals
will come back and buy another
one. So this is the impact of

160
00:18:12,417 --> 00:18:17,292
being too cheap to meter is that
you want your volume to go up.
So take down is a way to

161
00:18:17,292 --> 00:18:23,750
artificially send your volume
up. So it's huge. It's
wonderful. But this turns, in my

162
00:18:23,750 --> 00:18:29,083
opinion, this turns the whole
thing into a game. It's
whack‑a‑mole as a service. And I

163
00:18:29,083 --> 00:18:35,500
really feel stupid when I'm
participating in whack‑a‑mole at
all let alone something that's

164
00:18:35,500 --> 00:18:41,125
institutionalized and sort of
now built into the DNA of the
DNS industry. I just think

165
00:18:41,125 --> 00:18:47,125
that's stupid. So what else can
you do? If you can't prevent it
from being created in the first

166
00:18:50,417 --> 00:18:57,708
place, and you don't want to
participate in whack‑a‑mole as a
service, then you have an option

167
00:18:57,708 --> 00:19:03,375
of firewalling it. Where you can
just say, I know these names are
going to be used, and I can't

168
00:19:03,375 --> 00:19:10,792
necessarily keep them from being
used, but I could somehow have a
reputation system built in to my

169
00:19:10,792 --> 00:19:17,333
infrastructure. Whether it is
your name server, your web
browser, web proxy or into your

170
00:19:17,333 --> 00:19:22,833
border firewall, whatever that
is going to be, where you can
just say, look, if it's an

171
00:19:22,833 --> 00:19:29,750
annoying name, then I will keep
it from working on my end.
Right. So this is what you think

172
00:19:29,750 --> 00:19:35,958
of as a near‑end solution as
opposed to the far‑end solution
of getting it taken down. And

173
00:19:35,958 --> 00:19:42,875
this works. And I have ‑‑ I am
not going to show you any demos
today, but I've participated in

174
00:19:42,875 --> 00:19:46,917
create something DNS firewalling
technology that does work. But
some things that you have

175
00:19:46,917 --> 00:19:54,583
noticed about firewalls is you
can't just configure one
manually. I don't think the

176
00:19:54,583 --> 00:20:01,167
people in this room have got
enough hours in the week to go
in and reprogram your firewall

177
00:20:01,167 --> 00:20:05,333
every time somebody annoys you
and you want to make sure that
can't happen again. So this

178
00:20:05,333 --> 00:20:10,000
becomes yet another profit
opportunity for somebody to go
do the research that you don't

179
00:20:10,000 --> 00:20:15,958
have time for and sell you the
reputation system of stuff that
you don't want. I created the

180
00:20:15,958 --> 00:20:21,417
first reputation system of this
kind called the RBL back at a
company called MAPS. Spam

181
00:20:21,417 --> 00:20:26,958
spelled backwards. We thought we
were clever. I stopped after a
few years because I had to sell

182
00:20:26,958 --> 00:20:34,750
the company to pay the lawyers
because what the spammers were
doing was legal and what I was

183
00:20:34,750 --> 00:20:40,750
doing by stopping them was not.
So that's me learning things the
hard way. But that sort of thing

184
00:20:44,750 --> 00:20:50,542
does work. Where you outsource
your research. And the other
thing that you've noticed as a

185
00:20:50,542 --> 00:20:55,417
firewall maintainer is if you
have to go around to each of
your firewalls assuming that you

186
00:20:55,417 --> 00:21:01,333
have more than one web proxy
that needs URL filtering or more
than one firewall that needs IP

187
00:21:01,333 --> 00:21:08,750
address, if you want to go to
each one manually and configure
it the error rate is high, the

188
00:21:08,750 --> 00:21:14,625
cost is high, the benefit
doesn't really change and it
turns into a stupid idea

189
00:21:14,625 --> 00:21:20,625
quickly. You really are seeing
in both the URL filtering and
firewall configuration a

190
00:21:23,000 --> 00:21:29,250
published subscribe industry
coming into existence. Where we
now have sort of these companies

191
00:21:29,250 --> 00:21:36,792
that will come up with not only
do the research for you but
present it to you in a

192
00:21:36,792 --> 00:21:41,917
mechanized format that your
equipment can directly subscribe
to. So you are essentially

193
00:21:41,917 --> 00:21:48,292
inviting your vendors to program
your filters for you. And to
program them all in parallel

194
00:21:48,292 --> 00:21:54,000
rather than have to give it to
you and go do the individual
changes on the individual

195
00:21:54,000 --> 00:22:01,250
firewalls and hope you get them
all and hope you get them right.
So all of these trends informed

196
00:22:01,250 --> 00:22:07,250
my work in DNS firewalling. And
I will have more to say about
that in a few minutes. But the

197
00:22:09,708 --> 00:22:16,292
point is this is not our first
choice. Our first choice is that
the bad domain names are not too

198
00:22:16,292 --> 00:22:21,958
cheap to meter. So they don't
get created in the first place.
Our second choice is to take

199
00:22:21,958 --> 00:22:27,542
them down at the far end so we
don't have to take individual
action at over attack surface

200
00:22:27,542 --> 00:22:33,917
edge to stop something that is
actually a point source problem.
So economically speaking, this

201
00:22:33,917 --> 00:22:39,917
is stupid. But it's what we've
been driven to. So let's talk
about some (inaudible). I

202
00:22:42,625 --> 00:22:48,625
mentioned that the traditional
DNS forensics methodology is to
issue a query. And in DNS when

203
00:22:51,375 --> 00:22:56,417
you issue a query you have to
supply the domain name and the
type. I mentioned that that's

204
00:22:56,417 --> 00:23:02,917
kind of a bad idea for criminal
forensics because the bad guys
are running the name servers

205
00:23:02,917 --> 00:23:08,083
that you will be talking to so
they will see your queries. Or
some take down as a service

206
00:23:08,083 --> 00:23:12,292
company will already have wiped
that domain off the map. So by
the time you are look at it you

207
00:23:12,292 --> 00:23:19,417
can't find anything about it
anyway. Either way, that doesn't
work. So there is a now vibrant

208
00:23:19,417 --> 00:23:26,917
industry of passive DNS database
providers. I am one. I am not
the only one. The protocol that

209
00:23:26,917 --> 00:23:33,333
we use in our system is
currently on its way to becoming
an ITF standard. Our system is

210
00:23:33,333 --> 00:23:40,208
free if the person using it
isn't getting paid to use it. If
you are an academic research or

211
00:23:40,208 --> 00:23:47,083
hobbyist or whatever you can
just come to us and we'll give
you access to our stuff. But if

212
00:23:47,083 --> 00:23:53,625
you are getting paid, we'd like
to get paid too. But here's an
example. Which is kind of

213
00:23:53,625 --> 00:24:00,167
similar to the normal DNS query.
I'm providing the name and the
type. The difference is I'm not

214
00:24:00,167 --> 00:24:06,667
just getting the current value.
In fact, this issued no queries
that the bad guy can see. We

215
00:24:06,667 --> 00:24:12,750
have a database that has stored
everything that we've seen from
a lot of name servers for the

216
00:24:12,750 --> 00:24:18,542
last four years. So we have
terabyte among terabyte of
stored DNS traffic. It's all

217
00:24:18,542 --> 00:24:22,875
indexed. And I'll show you some
of the other indexes. I want to
remind you this is just my

218
00:24:22,875 --> 00:24:30,292
product there are freebie that's
do this also. What you can see
is I listed my domain for sale

219
00:24:30,292 --> 00:24:36,292
last year. By the way, it's not
sold. If you are interested
contact me. You can see the

220
00:24:41,583 --> 00:24:48,958
history. So you can imagine if I
were a criminal DNS user, I
might have an interesting

221
00:24:48,958 --> 00:24:55,417
history of changing my NS
records every time I face take
down somewhere. So you would be

222
00:24:55,417 --> 00:25:01,208
able to see the entire history
of people getting chased from
one provider to another using

223
00:25:01,208 --> 00:25:06,750
this system. So, again, the same
thing you would in a DNS system.
Which is I have a name. I have a

224
00:25:06,750 --> 00:25:11,375
type. Tell me what you know. The
difference is what this thing
knows is history not the current

225
00:25:11,375 --> 00:25:17,375
value. Here we see an
interesting wild card capability
where I'm saying yeah show me

226
00:25:21,667 --> 00:25:27,458
all of the (inaudible). DNS
normally can only tell you a
single answer that matches the

227
00:25:27,458 --> 00:25:32,500
question you have asked. The
only wild card a normal DNS can
do is the wild card in the zone

228
00:25:32,500 --> 00:25:39,042
that will match some random
string of characters that you
type. And it will synthesize an

229
00:25:39,042 --> 00:25:44,792
answer that matches the wild
card record. Normal DNS has wild
card on the server side. We have

230
00:25:44,792 --> 00:25:49,292
it in the database. So it's
possible to now it rate
through ‑‑ iterate through ‑‑ I

231
00:25:49,292 --> 00:25:55,292
had to wipe out the Comcast
internet selections to fit it on
a slide. But you get the idea.

232
00:25:57,458 --> 00:26:04,875
You would normally be able to do
a zone transfer to see all of
somebody's names. What we've

233
00:26:04,875 --> 00:26:10,833
done here is to reconstruct that
zone, one response at a time
over a period of years. By the

234
00:26:10,833 --> 00:26:16,833
way, I want to do a shout out to
(inaudible) whose idea this was.
He invented this passive DNA

235
00:26:19,042 --> 00:26:26,000
logging and it was the target of
his master's thesis. So BFK
which was one of his

236
00:26:26,000 --> 00:26:32,000
post-graduation employers does
run a system like this that was
based on his work. Wrote it in

237
00:26:37,292 --> 00:26:43,292
Ada for whatever reason because
Ada isn't dead in Germany yet.
Anyway, he did this. His

238
00:26:46,042 --> 00:26:53,000
inspiration, he told me, was
that the German registry, the
top level domain hold for.DE

239
00:26:53,000 --> 00:26:57,458
which is the top level domain
for Germany closed off zone
transfer. For many years they

240
00:26:57,458 --> 00:27:04,458
allowed anybody in the world to
do a zone transfer then they
tried to limit it to just German

241
00:27:04,458 --> 00:27:10,458
citizens then they just turned
it off. He thought the .DE
domain was public property. So

242
00:27:13,417 --> 00:27:19,125
he resolved to make this his
thesis project so he could
reconstruct the domain. That is

243
00:27:19,125 --> 00:27:25,125
what civil libertarianism looks
like in Germany. And he has
really launched a thousand ships

244
00:27:28,750 --> 00:27:34,750
with this idea. So here's an
interesting case of right‑hand
wild carding. This is where I

245
00:27:39,125 --> 00:27:45,125
wanted to know not what answers
end in something but what
answers begin with something.

246
00:27:49,250 --> 00:27:55,042
Normally wild carding does not
work like it does when you do
the LS command in a Linux shell

247
00:27:55,042 --> 00:28:01,583
window. Normal wild carding DNS
is that the front part of the
domain name can vary but the

248
00:28:01,583 --> 00:28:05,917
back half has to be known. In
this case the front was known
and the back was allowed to

249
00:28:05,917 --> 00:28:11,917
vary. I actually discovered two
cousins by preparing this line.
So this is an example of

250
00:28:16,292 --> 00:28:22,292
discovering related resources. I
was updating my mail server
from, you know, old whatever to

251
00:28:24,917 --> 00:28:31,375
new whatever. You know, as we
do. And I had lost track of what
I had registered. I no longer

252
00:28:31,375 --> 00:28:36,875
knew what domains I owned or
what the mail server should be
able to respond to and treat as

253
00:28:36,875 --> 00:28:43,292
its own stock rather than going
into a mail loop. So I used DNS
DB to get a list. I said show me

254
00:28:43,292 --> 00:28:50,792
all the domain that's use my
mail server. And I should
mention in passing, I am a child

255
00:28:50,792 --> 00:28:56,792
of the cold war. In the 1960s, I
can remember having a job in a
public first grade classroom of

256
00:29:00,167 --> 00:29:04,708
pulling down the extra set of
shades when a certain type of
alarm would sound then we would

257
00:29:04,708 --> 00:29:10,708
all hide under our desks. That's
what we did to test for the fact
that an incoming A bomb had just

258
00:29:13,417 --> 00:29:20,625
landed off the coast of
San Francisco. So the idea of
being able to buy property in

259
00:29:20,625 --> 00:29:28,375
the Soviet Union appeals to me.
Which is why I moved VIX.com to
VIX.SU. I subsequently learned

260
00:29:28,375 --> 00:29:34,375
no dot mail server will accept
email from a dot SU. (Laughter).
So the point is I don't think I

261
00:29:42,500 --> 00:29:47,958
am a criminal. So this is not
the way that I clustered a
criminal's assets. But a lot of

262
00:29:47,958 --> 00:29:53,417
criminals do use the same MX
record for a lot of different
domains. And if it isn't an MX

263
00:29:53,417 --> 00:29:59,417
record it could be a serve
record, CMA record, maybe a name
server. And if what you want to

264
00:30:01,667 --> 00:30:07,042
know is what the police use to
refer to as the reverse
telephone directory where you

265
00:30:07,042 --> 00:30:10,500
start with the number and figure
out who has it rather than
starting with a person and

266
00:30:10,500 --> 00:30:15,458
finding out what their number
is, this is how you do it. You
just grab all the responses in

267
00:30:15,458 --> 00:30:22,417
transit for a long time and
index the hell out of them and
you can discover exactly what is

268
00:30:22,417 --> 00:30:27,583
related to what. Because
criminals are not usually going
to be able to create a different

269
00:30:27,583 --> 00:30:35,375
mail server name for every
criminal enterprise they
undertake. And if they could you

270
00:30:35,375 --> 00:30:41,125
will find them that way instead
of this way. That behavior turns
out to be an anomaly of its own.

271
00:30:41,125 --> 00:30:47,125
So, finally, let's check some IP
addresses. In this case, I
wanted to know ‑‑ well this is

272
00:30:55,708 --> 00:31:02,208
the FBI. I thought they did a
really good job of ‑‑ this is,
like, four‑year‑old history.

273
00:31:02,208 --> 00:31:08,750
They've had no turn at all. All
of these records have been there
the whole time. And that's a

274
00:31:08,750 --> 00:31:13,917
pretty clean system. Those of
you should be able to look at
that and say there's very little

275
00:31:13,917 --> 00:31:19,917
de‑bugging you have to do if you
keep it that system and that
stable. But then I noted they

276
00:31:22,667 --> 00:31:27,292
had a whole bunch of other
things in the same address
block. Because our indexes are

277
00:31:27,292 --> 00:31:33,000
not just on names they're also
on IP addresses. And this works
just fine on the IP four, IP V

278
00:31:33,000 --> 00:31:37,833
six and it doesn't have to be on
a slash 24 boundary. Any bit
boundary it will work. If you

279
00:31:37,833 --> 00:31:44,417
know the certain decider block
is owned by a certain internet
service provider who is writing

280
00:31:44,417 --> 00:31:52,042
a lot of pink contracts, they
are sheltering their customers
from complaints and keeping

281
00:31:52,042 --> 00:31:57,250
people online no matter what as
a contract term, you might want
to know, what are all of the

282
00:31:57,250 --> 00:32:01,750
domain names that points into
the address space that belongs
to this bastard so that you can

283
00:32:01,750 --> 00:32:08,958
go after them one at a time and
decide that maybe ‑‑ if you're
willing to do business with bad

284
00:32:08,958 --> 00:32:14,375
people, I'm betting you are not
doing business with very many
good ones. So you just become my

285
00:32:14,375 --> 00:32:21,208
menu, inventory list of other
people to investigate. The FBI
is not an example of that but I

286
00:32:21,208 --> 00:32:26,458
did want to just demonstrate to
them. I was talking to one of
their sys admins and I said you

287
00:32:26,458 --> 00:32:31,250
got a clean set‑up but let me
show you the information you
have been leak by putting things

288
00:32:31,250 --> 00:32:37,250
under Jason's address in the
name assess block. It was kind
of cool. By the way I Infraguard

289
00:32:41,542 --> 00:32:47,542
because they have 300. Okay. So
in examples I've shown you they
look like DNS output. Like I've

290
00:32:51,958 --> 00:32:57,958
been using the command. What you
will see here are two examples.
One without the dash J flag on

291
00:33:00,167 --> 00:33:06,208
my particular command level
tool. That is just an
adaptation. In other words the

292
00:33:06,208 --> 00:33:12,375
default for this tool is
converted to human readable
DNS‑like notation. But the

293
00:33:12,375 --> 00:33:18,000
actual database is taking
restful commands and giving you
adjacent answers. So the real

294
00:33:18,000 --> 00:33:23,333
use of this is not to run my
cheese bag little command line
tool but to wire this into your

295
00:33:23,333 --> 00:33:31,042
own Analytics so that you can do
this type of clustering and sort
of guilt by association or

296
00:33:31,042 --> 00:33:37,167
whatever else you want to do
from within your software. And,
again, the protocol, the

297
00:33:37,167 --> 00:33:43,167
particular restful protocol with
the results is the topic of ITF
RXC. This is no way propriety.

298
00:33:49,750 --> 00:33:55,750
We want everybody to
interoperate. Do not be afraid
of, you know, the possibility of

299
00:33:59,792 --> 00:34:04,750
maybe having to run on OP script
to parse the output from our
system. It really is Jason

300
00:34:04,750 --> 00:34:10,750
underneath. Right so let's
talk ‑‑ let me move away from
DNS database use. I mentioned

301
00:34:14,625 --> 00:34:20,625
pool ship. I don't intend to
focus on a single pool. There
are several interesting ones. So

302
00:34:24,292 --> 00:34:32,042
people can't be bothered. I hate
those people. What you are
seeing here is somebody who is

303
00:34:32,042 --> 00:34:37,625
packing that target, at the top
pack the guy on the left using
the guy on the bottom as a

304
00:34:37,625 --> 00:34:43,042
reflecting amplifier. The reason
this works is the guy on the top
is able to send a continuous

305
00:34:43,042 --> 00:34:46,750
stream of DNS request or
whatever it is. Can send a
continuous stream to this

306
00:34:46,750 --> 00:34:52,750
request forged to have come from
the victim on the left. And the
guy at the bottom, because of

307
00:34:55,417 --> 00:34:59,583
the way the internet is wired,
does not have any idea that that
is a forgery. By the time it

308
00:34:59,583 --> 00:35:06,792
reaches him, it looks completely
plausible and he will just
answer it. Obviously, the ISP

309
00:35:06,792 --> 00:35:12,625
for the guy on the top could
prevent this. I wish they would,
but they don't. Because that's a

310
00:35:12,625 --> 00:35:18,542
lot of cost on their part. Or at
least perceived costs. But the
only beneficiary will be their

311
00:35:18,542 --> 00:35:24,375
competitor on the left. So the
idea of spending money locally
so you can help people that you

312
00:35:24,375 --> 00:35:28,958
are competing against in
business seems a little bizarre
to your average board of

313
00:35:28,958 --> 00:35:34,500
directors. Nevertheless, the
internet requires that we all
somehow do this. Even though

314
00:35:34,500 --> 00:35:39,875
it's not in our direct best
interests. We will all boil
together like frogs if we don't

315
00:35:39,875 --> 00:35:45,875
do it. That's what's happening.
So if you are running a content
server, DNS authority server,

316
00:35:48,750 --> 00:35:53,708
then you have to massively over
provision it. You just do. You
need a much badder internet

317
00:35:53,708 --> 00:35:59,708
connection, server, RAM, you
need a lot more computational
resources at peak than you will

318
00:36:03,167 --> 00:36:09,708
actually use at average. That's
because you will be a target
often enough that you better be

319
00:36:09,708 --> 00:36:15,250
able to keep your internet
property online while you are
being attacked. So the fact

320
00:36:15,250 --> 00:36:20,958
there's a natural insensitive
for you guys to build really
over provisioned servers means

321
00:36:20,958 --> 00:36:26,375
you are building perfect
reflecting amplifiers for other
people to use not to attack you

322
00:36:26,375 --> 00:36:32,375
but to use you as a way to
attack others. So since other
people's networks, OPMs are

323
00:36:38,000 --> 00:36:42,583
really the least reliable
component of the internet, we
know we can't somehow call

324
00:36:42,583 --> 00:36:48,458
everybody and say could you
please validate the source
address so I can be sure that a

325
00:36:48,458 --> 00:36:54,333
spoof source attack is not
coming from your network? I
mean, who you are going to call

326
00:36:54,333 --> 00:37:01,292
and why would they take your
call and why would they say yes?
So we did a thing which is

327
00:37:01,292 --> 00:37:06,250
demonstrated here. It's response
late limiting. We added logic to
the name server which is the

328
00:37:06,250 --> 00:37:11,042
reflecting amplifier in that
picture, to say I think if we're
going to send pretty much the

329
00:37:11,042 --> 00:37:17,042
same response to pretty much the
same network more than, let's
say, a dozen times per second,

330
00:37:19,667 --> 00:37:24,417
that could be a DDOS. So let's
try suppressing some of that and
just try dropping a bunch of it

331
00:37:24,417 --> 00:37:31,750
on the floor. The exact method
you drop it and when you set it
(inaudible) are not the topic of

332
00:37:31,750 --> 00:37:37,500
today's discussion. I've got
some URLs at the end. But in
this picture what you see is

333
00:37:37,500 --> 00:37:44,250
(inaudible) who is the dot level
domain operator for dot info. If
you can ‑‑ I don't know if you

334
00:37:44,250 --> 00:37:51,667
can squint hard enough and see
it but there is an area below
the line and above the line. And

335
00:37:51,667 --> 00:37:58,750
this is usual sleazy graphing
trick that we use on a lot of
DNS related servers. The part in

336
00:37:58,750 --> 00:38:05,792
the negative region is the query
volume. By bit. And the part on
the top, the positive portion of

337
00:38:05,792 --> 00:38:11,792
this is your response volume by
bit. So they were being used as
a multi‑gigabit D‑DOS amplifier

338
00:38:13,917 --> 00:38:18,417
and people would call and
complain and say would you
please stop sending me so much

339
00:38:18,417 --> 00:38:23,542
traffic. And they would answer
by saying you are sending us all
these queries. You want to be

340
00:38:23,542 --> 00:38:28,125
block holed? No we want to be
able to reach real dot info
names. We just don't want you to

341
00:38:28,125 --> 00:38:33,667
answer the ones not from us.
Finally the Afilias guys
installed my patch. Which was

342
00:38:33,667 --> 00:38:39,208
Vernon's patch but it's my idea.
That's where you see on the
right‑hand side all of a sudden

343
00:38:39,208 --> 00:38:45,792
they stop answering all the
crap. And they posted this to
whatever DNS or some mailing

344
00:38:45,792 --> 00:38:51,792
list and within a month every
top level domain server had
logic like this. And the NSD

345
00:38:54,958 --> 00:39:00,792
people who are the other major
authority named server provider
in the world other than us, I

346
00:39:00,792 --> 00:39:05,333
worked in INC at that time on so
this was a BIND catch
originally, they added it too.

347
00:39:05,333 --> 00:39:10,875
So if you are running an
authority name server and not
running rate limiting, please

348
00:39:10,875 --> 00:39:16,083
investigate it. It is a simple
one line config change. I won't
cost you very much in memory. It

349
00:39:16,083 --> 00:39:22,250
will not cause people to call
you and say you are unreliable.
It is the thing to do. So

350
00:39:22,250 --> 00:39:28,250
there's a much simpler problem
solution coupling than what I've
given so far. A little bit about

351
00:39:30,625 --> 00:39:37,625
DNS fire walls. I mentioned that
I created the first reputation
system, distributor reputation

352
00:39:37,625 --> 00:39:43,792
system after DL. We kind of
wanted to do the same thing for
named servers that we had done

353
00:39:43,792 --> 00:39:49,792
there for mail servers. And it
is a published subscribed
mechanism and we are actually

354
00:39:52,333 --> 00:39:58,250
using a zone file as the
encoding of the rule set. Which
is you should recognize as a

355
00:39:58,250 --> 00:40:03,292
sleazy trick. But it means that
all the data paths that that
server has already allowed by

356
00:40:03,292 --> 00:40:09,375
its firewalls to do will carry
this information as well. So it
turned out to be ease of

357
00:40:09,375 --> 00:40:13,708
insertion thing. So the way you
actually program it ‑‑ again
we're not going to get into

358
00:40:13,708 --> 00:40:19,708
details here ‑‑ but there are
now about half a dozen providers
and there are hundreds, maybe

359
00:40:22,708 --> 00:40:28,083
thousands of subscribers. A lot
of reputation information is
being published and subscribed

360
00:40:28,083 --> 00:40:34,083
in this format. I have a very
short example I want to show
you. Let's see here. Right. So I

361
00:40:43,250 --> 00:40:48,708
noticed that newly observed
domains were crap and I decided
to come up with an RPZ that

362
00:40:48,708 --> 00:40:55,167
would do a rolling picture of
the last ten minutes of
new domains. And ten minutes is

363
00:40:55,167 --> 00:41:00,333
not the only window. Some people
want 30 minutes or 12 hours. But
the ten‑minute window is the one

364
00:41:00,333 --> 00:41:06,667
I use at my house. So if you
visit my house you will not be
able to reach any domain name

365
00:41:06,667 --> 00:41:11,375
that was first seen by far
sight, that's my day job in the
last ten minutes. What I

366
00:41:11,375 --> 00:41:18,875
discovered was a fair number of
domain names don't live to be
11 minutes old. By holding their

367
00:41:18,875 --> 00:41:24,875
head under water for the first
ten minutes you can avoid ever
dealing with them at all.

368
00:41:30,125 --> 00:41:34,542
(Applause) We did some
subsequent research because we
have a big spam feed as part of

369
00:41:34,542 --> 00:41:42,167
our realtime system. And we've
looked at spam, big spam and
found 60 percent of it used a

370
00:41:42,167 --> 00:41:47,708
domain name created in the last
24 hours. So this is kind of a
building block approach where

371
00:41:47,708 --> 00:41:51,917
first we created the fire
walling capability in one
company then we came over here

372
00:41:51,917 --> 00:41:56,708
with data feed and created this
interesting feed. There are a
lot of other RPZs. There's an

373
00:41:56,708 --> 00:42:02,667
RPZ full of domain generation
aloe rhythms. A ‑‑ algorithms.
There are RPZs full of various

374
00:42:02,667 --> 00:42:08,667
known bad reputation things. I
want to encourage you ‑‑ I am
going to skip most of this. But

375
00:42:11,042 --> 00:42:18,375
I want to encourage you to look
at the DNS RPZ.info website
because it will have a list of

376
00:42:18,375 --> 00:42:22,917
the other RPZs I know of. If you
are publishing one send an email
and we'll put you on the list.

377
00:42:22,917 --> 00:42:24,958
That's the short one hour
version of DNS problems and
solutions. Thank you for your

378
00:42:24,958 --> 00:42:31,250
time. I'll take questions for
about two minutes then they're
going give me the hook.

379
00:42:31,250 --> 00:42:34,458
(Applause)

