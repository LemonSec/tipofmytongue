1
00:00:00,375 --> 00:00:06,458
>> The speaker coming up right
now is Blake and cisc0ninja,
they are going to be talking

2
00:00:06,458 --> 00:00:13,708
about Don't DDoS Me Bro. Let's
give them a big hand, a Def Con
welcome, come on. 	>> Testing,

3
00:00:13,708 --> 00:00:21,292
1, 2, 3. Alright, first off I
want to apologize to you guys.
I've been sick for the past few

4
00:00:21,292 --> 00:00:27,042
days so my throat is kind of
jacked up. So, I know a lot of
you guys are having a good time

5
00:00:27,042 --> 00:00:31,333
out in Vegas. I know my good
times have been like hot totties
and cough drops but Blake is

6
00:00:31,333 --> 00:00:36,750
going to be doing most of the
talking so, you know, really out
of the two of us he is kind of

7
00:00:36,750 --> 00:00:43,125
like the better half so to speak
so you you'll be really glad
about him talking anyways. The

8
00:00:43,125 --> 00:00:49,667
bottom line for our talk is kind
of like, it's practically DDoS
defense. It's all about the

9
00:00:49,667 --> 00:00:55,583
cost, we want to drive the
attackers cost up without
driving your cost up. So, we're

10
00:00:55,583 --> 00:01:01,583
not actually trying to promote
and high cost stuff. It's like,
pretty much, open source so

11
00:01:03,750 --> 00:01:07,875
we're going to go and first off
we're going to start off by
showing you some of the attacks

12
00:01:07,875 --> 00:01:12,042
we've seen, we're going to show
you some of the mitigation
efforts and then if we have time

13
00:01:12,042 --> 00:01:17,583
for it, talk about some lulls
we've had in the process. I
never would have thought

14
00:01:17,583 --> 00:01:23,583
something of death would be
like, so popular and cause so
much damage. Now days it's been

15
00:01:23,583 --> 00:01:29,583
revamped with daedric armor and
the former get post request
coming from every bot net you

16
00:01:34,125 --> 00:01:40,375
can think of. In fact, there was
a guy that came up to us
yesterday and was more or less,

17
00:01:40,375 --> 00:01:47,292
man, you got on that soul direct
shirt, I DDoS'd the shit out of
those guys. I'm like, ok, what

18
00:01:47,292 --> 00:01:53,708
for? They had all my information
messed up, all that HDB and just
everything was all wrong. I was

19
00:01:53,708 --> 00:01:59,208
like, did you hit up the admin?
He's like, no man I just DDoS'd
them man. Ok. (Laughter). >> You

20
00:01:59,208 --> 00:02:07,167
didn't send an email or
anything, you know, we've got
IRC forms. No, man I was just

21
00:02:07,167 --> 00:02:14,333
DDoSing, it's all about the
DDoS. That's the mentality, I
guess, that some of our

22
00:02:14,333 --> 00:02:20,333
opponents have, so. >> Ok, so
here is a good idea on some of
the humor we're going to do.

23
00:02:25,917 --> 00:02:33,208
Show of hands, who's is actually
here to defend against DDoS? Ok,
and who is here like DDoS soul

24
00:02:33,208 --> 00:02:37,083
direct trying to figure out how,
maybe, a better way to hone
their craft? I didn't really see

25
00:02:37,083 --> 00:02:42,708
any Guy Fawkes masks so.
(Laughter). >> Ok, so anyways, I
always like humor so let's start

26
00:02:42,708 --> 00:02:45,875
out with a little bit of that.
So this is basically how
attackers visualize themselves,

27
00:02:45,875 --> 00:02:53,208
right? That's what they are
thinking so then what we're
going to try to do is give you

28
00:02:53,208 --> 00:03:00,167
different techniques to use so
then your web server should be
more like this. It's not enough

29
00:03:00,167 --> 00:03:06,542
to do anything. So, a little bit
of background he had touched, I
think at the time I was a senior

30
00:03:06,542 --> 00:03:09,333
security architect that I
applied for this. We had to
reorg so now I'm a principal

31
00:03:09,333 --> 00:03:14,208
senior architect. Fortune 500. I
was directly involved with
defending against Operation

32
00:03:14,208 --> 00:03:18,500
Ababil, probably a lot of you
guys have heard of that since
you're dealing with DDoS.

33
00:03:18,500 --> 00:03:23,250
Cisc0ninja works in threat
intelligence and has been a long
time member of Soldier X. I'm

34
00:03:23,250 --> 00:03:27,792
kind of like, I've been with
Soldier X a long time with doing
more of the back end stuff and

35
00:03:27,792 --> 00:03:31,458
I've also, I guess, kind of
known as the back in the 90's at
least, the only guy dumb enough

36
00:03:31,458 --> 00:03:34,625
to use his real name instead of
a handle in the group. Because,
you know, everybody has hacker

37
00:03:34,625 --> 00:03:41,042
aliases. A quick disclaimer;
opinions, ideas, solutions all
that stuff is from us it's not

38
00:03:41,042 --> 00:03:45,458
from our employers or
representative for them
whatsoever. Since we have Def

39
00:03:45,458 --> 00:03:51,542
Con kids now we do have some
explicit language and you know,
some pictures in some of the

40
00:03:51,542 --> 00:03:57,250
slides. So, just a heads up.
What we are going to cover,
course requirements, have a bit

41
00:03:57,250 --> 00:04:01,708
of introductions, show an attack
landscape, then we have
basically two parts we defend

42
00:04:01,708 --> 00:04:07,125
on. The network side and the web
defense side. So you can
actually try to protect the

43
00:04:07,125 --> 00:04:11,458
network layer or you can
actually do it on the web
server. I always think it's

44
00:04:11,458 --> 00:04:16,250
important for defense in depth,
especially depending on what
technologies you have or what

45
00:04:16,250 --> 00:04:19,917
your company will let you do.
Maybe your company says you
can't use snort inline or you

46
00:04:19,917 --> 00:04:25,167
can't have this or have that. So
basically we try to give you a
whole slew of things. You get

47
00:04:25,167 --> 00:04:29,417
enough of those and you'd be
good. We're also going to go
over reacting to an attack. It

48
00:04:29,417 --> 00:04:32,958
seems like a lot with these big
companies, you know, the website
goes down and everybody starts

49
00:04:32,958 --> 00:04:36,500
freaking out. Instead of
properly reacting everybody is
like, oh my god it's the end of

50
00:04:36,500 --> 00:04:42,083
the world, the website is down
what do we do? Then, at the end,
try to get some best practices;

51
00:04:42,083 --> 00:04:46,875
put everything together. If we
actually have time we want to
do, basically, story time, some

52
00:04:46,875 --> 00:04:51,792
fun that's happened with Solider
X. Obviously you put that at the
end so you guys get the

53
00:04:51,792 --> 00:04:56,750
information that's actually
useful to you since fun stories
aren't that useful to you. So

54
00:04:56,750 --> 00:05:01,458
for requirements, for our
examples. For soul direct we use
Linux, but you know, Linux,

55
00:05:01,458 --> 00:05:08,000
UNIX. Apache2 is the web server
we use, Python and Perl for the
scripts that we have. For our

56
00:05:08,000 --> 00:05:11,250
monitoring system it actually
runs on Raspberry Pi, because
you know, it's like five watts

57
00:05:11,250 --> 00:05:18,208
of power. We have a sixteen by
two LCD as you can see at the
bottom. It basically says

58
00:05:18,208 --> 00:05:22,750
Soldier X is up, Soldier X is
down. That monitoring tool is
actually, it should be on the

59
00:05:22,750 --> 00:05:28,292
Def Con CD. It's also in the –
if you look at the first slide
it has the Soldier X address;

60
00:05:28,292 --> 00:05:34,583
it's in that directory as well.
So, you should have Snort inline
if possible. There is also,

61
00:05:34,583 --> 00:05:38,625
we're going to give an example
with an F5; the F5 is kind of an
expensive load balancer so we

62
00:05:38,625 --> 00:05:42,167
aren't necessarily saying you
need to have that but I know
some people don't have Snort.

63
00:05:42,167 --> 00:05:45,458
Some of you might have
Surricata, we're not actually
giving examples for that but you

64
00:05:45,458 --> 00:05:51,500
should be using, like, you know
the stuff we show to build your
own Surricata rules as well.

65
00:05:51,500 --> 00:05:55,917
Network sniffer hardware if
possible. It's important a lot
of the time when these attacks

66
00:05:55,917 --> 00:06:01,583
are going on to see what's
coming in versus just
speculating. And then of course

67
00:06:01,583 --> 00:06:07,625
you need critical thinking
skills. DDoS is not, there is no
real silver bullet. You need to

68
00:06:07,625 --> 00:06:14,042
be able to adapt as your
attackers adapt. So, why this
talk is relevant that we fill?

69
00:06:14,042 --> 00:06:19,167
At least since from 2010 from
what I can see, Layer 7 is on
the rise. Operation Ababil, for

70
00:06:19,167 --> 00:06:24,000
those of you who are familiar,
was an attack from the Middle
East because there was a Youtube

71
00:06:24,000 --> 00:06:31,750
video that was offensive to some
of the Islamic people. Basically
they said, ok, Youtube has this

72
00:06:31,750 --> 00:06:36,208
video up and unless they take it
down we're going to attack all
of the financial infrastructure.

73
00:06:36,208 --> 00:06:39,875
They hit all the big banks in
the United States. Obviously,
the banks have no say so in what

74
00:06:39,875 --> 00:06:47,333
Youtube hosts but that was their
mentality. So basically there is
also DDoS seems to be one of the

75
00:06:47,333 --> 00:06:50,833
preferred methods of
hacktavists, or like he said,
somebody has an issue with

76
00:06:50,833 --> 00:06:54,750
something on the Soldier X site,
instead of emailing us, they are
like, I'm just going to DDoS the

77
00:06:54,750 --> 00:06:58,458
shit out of that site. You know,
this is how I'm going to react
and you're like, ok I'm being

78
00:06:58,458 --> 00:07:04,542
hit and you don't even know why
half of the time. So, what kind
of spawned this talk is I went

79
00:07:04,542 --> 00:07:09,917
to CloudFlare's talk last year
and they showed a lot of cool
attacks and then solution was

80
00:07:09,917 --> 00:07:15,125
get CloudFlare. I was like,
that's not what – that doesn't
really resonate with me so we

81
00:07:15,125 --> 00:07:19,042
actually did try that. We
actually did get CloudFlare. We
still even have our DNS going

82
00:07:19,042 --> 00:07:23,750
through CloudFlare and so, there
is a cost factor. There is also,
it's like, there is security

83
00:07:23,750 --> 00:07:28,542
through obscurity really. I
mean, if they know your IP
address then they just DDoS your

84
00:07:28,542 --> 00:07:33,292
IP address. For Soldier X, for
instance, the website will leak
the IP address. You know, you

85
00:07:33,292 --> 00:07:36,625
sign up for new accounts, it
sends and email out, you look at
the email and boom there is the

86
00:07:36,625 --> 00:07:40,417
IP address. Now, CloudFlare
could say, you need a separate
server, you need this, you need

87
00:07:40,417 --> 00:07:45,375
that, but we're basically a
non-profit security hobbyist. We
aren't trying to build this

88
00:07:45,375 --> 00:07:52,917
infrastructure to make sure it
works at CloudFlare. There is
also historical records that

89
00:07:52,917 --> 00:07:57,583
people could use for, let's say,
you're a big company and you
have Slash 16 where you're

90
00:07:57,583 --> 00:08:02,458
probably not just going to move
that because you need
CloudFlare. You've also got DNS

91
00:08:02,458 --> 00:08:05,750
brute force. I don't know if you
guys have heard of knock, that's
like a – I saw it on some

92
00:08:05,750 --> 00:08:12,000
Russian forums that actually
just brute force as a records.
And last but not least, an old

93
00:08:12,000 --> 00:08:17,292
technique is pointer record. You
get an IP range, scan all the
pointer records, if you have

94
00:08:17,292 --> 00:08:22,083
pointer records setup guess
what? They get your IP. So for
us it didn't really work. In one

95
00:08:22,083 --> 00:08:28,042
funny situation with our
interpiece server CloudFlare was
actually passing the – they were

96
00:08:28,042 --> 00:08:32,958
actually passing this get flood
going after large PDFs and
CloudFlare actually passed that

97
00:08:32,958 --> 00:08:37,750
traffic on to our server and so
the server is still going down
and you get this error, like,

98
00:08:37,750 --> 00:08:44,750
522. CloudFlare is fine but your
website is not. And last but not
least, privacy concerns. So,

99
00:08:44,750 --> 00:08:50,000
what this talk is, is it's a
real world look. All of these
are actual real world examples.

100
00:08:50,000 --> 00:08:55,500
None of this stuff is made up
for this talk. We actually take
Soldier X logs. The only thing

101
00:08:55,500 --> 00:09:00,167
we obfuscate is IP addresses of
non-attackers – we actually
obfuscate, they were not

102
00:09:00,167 --> 00:09:04,208
attacking our site, I don't want
to give their IPs during this
talk. We also have free code

103
00:09:04,208 --> 00:09:09,417
examples and of course a bit of
humor at DDoSers because we kind
of try to keep this interesting.

104
00:09:09,417 --> 00:09:16,000
I know defense can be a pretty
dry topic. So, what this talk is
not; a silver bullet to solve

105
00:09:16,000 --> 00:09:21,417
all DDoS attacks, a political
stance on DDoS, of course not a
cry for people to DDoS us even

106
00:09:21,417 --> 00:09:24,708
more. I'm sure people are going
to watch this on Youtube and be
like, screw these guys I'm

107
00:09:24,708 --> 00:09:30,708
DDoSing the shit out of this
site. We're not selling you a
product. So, let's see, the

108
00:09:33,167 --> 00:09:37,458
attack landscape. If you have
the amplification attacks, which
is basically the biggest pipe

109
00:09:37,458 --> 00:09:42,958
winds, we're not covering that,
if they have a bigger, more
bandwidth than you that's coming

110
00:09:42,958 --> 00:09:48,542
in then you go down. What we're
going after is the HTTP DDoS. I
guess you're about to get a shot

111
00:09:48,542 --> 00:09:54,542
for – nooo. Maybe I am too.
(Applause). >> You guys know the
drill. First time speakers do a

112
00:09:57,833 --> 00:10:04,708
shot. >> This is actually my
fourth time speaking. >> But
it's his first time, right? >>

113
00:10:04,708 --> 00:10:10,708
Wait, give me that. >> You
already gave it to me. >> Cheers
to Def Con. >> Cheers. >> So,

114
00:10:21,208 --> 00:10:28,833
back to the – the HTTP DDoS is
our focus. Usually in the form
of large GETPOST requests. They

115
00:10:28,833 --> 00:10:33,375
will go after large PDF files,
they'll try to hit expensive
queries. If you have search

116
00:10:33,375 --> 00:10:38,625
functionality or whatever in
your website they are going to
hit that. Of course, for Layer 7

117
00:10:38,625 --> 00:10:41,500
there is other application DDoS
attacks we aren't covering
those. Those are kind of future

118
00:10:41,500 --> 00:10:47,083
fun. If Soldier X starts getting
hit with that stuff maybe give a
talk on that stuff in the future

119
00:10:47,083 --> 00:10:52,208
but right now it's not going on.
So, why do they do it? This is
my stance; a lack of skill

120
00:10:52,208 --> 00:10:56,500
necessary to do an intrusion.
They can't break into our site
so they are like, I'm going to

121
00:10:56,500 --> 00:11:00,792
DDoS the shit out of that place.
It could be that some people
view it as political protest. I

122
00:11:00,792 --> 00:11:04,333
don't think it's peaceful
protest since you are actually
taking a site down but some

123
00:11:04,333 --> 00:11:08,833
people see it that way. I like
little slides because I don't
always participate in DDoS

124
00:11:08,833 --> 00:11:13,833
attacks but when I do I use
links meant to trick people into
joining. That's unwilling

125
00:11:13,833 --> 00:11:20,250
participation which actually has
happened. Or my favorite – for
you guys into the web comics –

126
00:11:20,250 --> 00:11:23,875
John Gabriel from Penny Arcade
who has the greater internet
fuckwad theory. Which is that

127
00:11:23,875 --> 00:11:28,042
you take a normal person, give
him anonymity, put an audience
in front of him and they become

128
00:11:28,042 --> 00:11:35,042
this total fuckwad. (Laughter).
>> So that's – we'll actually
get back to one of the methods

129
00:11:35,042 --> 00:11:38,792
with Soldier X is we've actually
publically shamed some of these
people if we can get

130
00:11:38,792 --> 00:11:43,542
attribution. It actually seems
to have worked really well which
kind of led me to say, you know

131
00:11:43,542 --> 00:11:50,750
this theory has a good point to
it. So, with Layer 7 DDoS it
drives down the cost of a DDoS.

132
00:11:50,750 --> 00:11:56,500
The attackers have a very high
return on investment. They don't
need a whole lot of bandwidth.

133
00:11:56,500 --> 00:12:01,875
It evades most current carrier
mitigations and they can really
take down your site with minimal

134
00:12:01,875 --> 00:12:06,167
effort. We've seen sites taken
down through (indiscernible)
which isn't all that fast. So,

135
00:12:06,167 --> 00:12:11,250
our goal then is drive up
attacker costs, reduce the
defensive costs, so we're trying

136
00:12:11,250 --> 00:12:16,375
to teach you technique rather
than sell you products. Mitigate
when possible. You may always be

137
00:12:16,375 --> 00:12:20,083
able to mitigate you can at
least drive up those costs. And
then just get people thinking

138
00:12:20,083 --> 00:12:24,250
about solutions to this problem.
Then we have the famous quote to
give a man fish, teach a man to

139
00:12:24,250 --> 00:12:31,208
fish. So, first let's get into
an example attack. Important
note with the Al Qassam cyber

140
00:12:31,208 --> 00:12:36,833
fighters, a lot of stuff I can't
tell you because of you know,
where I work and basically,

141
00:12:36,833 --> 00:12:40,375
agreements that I've made but if
there is people from the
financial section or something,

142
00:12:40,375 --> 00:12:43,917
you know, get a hold of me
afterwards and if I could verify
you I could give you a lot more

143
00:12:43,917 --> 00:12:49,708
information on this if you need
it. So basically Operation
Ababil is a large scale DDoS

144
00:12:49,708 --> 00:12:54,208
attack via a PHP based bot net,
which they called Brobot,
against American financial

145
00:12:54,208 --> 00:12:58,417
institutions. Now if you look
the first thing I don't know
probably pretty small but

146
00:12:58,417 --> 00:13:03,125
basically you have the
wordpress/joomla, some CMS site.
It was actually a really small,

147
00:13:03,125 --> 00:13:07,708
really clever back door where
you see like if they call the
PHP directly, JEXEC won't be

148
00:13:07,708 --> 00:13:13,042
defined so it will say hey, die
with restricted access. They
change it so if JEXEC is not

149
00:13:13,042 --> 00:13:19,042
defined then die by evaluating a
Base64 encoded blob on CID. So
you pass a Base64 encoded attack

150
00:13:21,042 --> 00:13:27,583
script and boom it goes; it does
your bidding. So there's a
couple pieces of example code

151
00:13:27,583 --> 00:13:33,958
you can kind of get an idea.
Like if you see the first
example it's not really a proper

152
00:13:33,958 --> 00:13:37,458
request the way it is set up. It
doesn't give a lot of data.
Then, as you see the second

153
00:13:37,458 --> 00:13:43,958
example they actually tried to
randomize the refer and the user
agent and try to do a more

154
00:13:43,958 --> 00:13:49,708
proper HTTP request, generated
some fake IP's for
(indiscernible, client IP's and

155
00:13:49,708 --> 00:13:56,125
stuff like that. On Soldier X
which we can basically give you
anything we want from Solider X.

156
00:13:56,125 --> 00:14:01,417
We have our usage policy is that
if you attack our site we can
share your information. If

157
00:14:01,417 --> 00:14:05,417
you're just visiting then we
won't but if you're attacking us
we will do whatever we want with

158
00:14:05,417 --> 00:14:10,417
it. So yeah so one was kind of
weird I thought. It was like,
critical mass. There's like

159
00:14:10,417 --> 00:14:15,167
dirty panties picture where
there's him and some girl from
Def Con back at Lexus Park so

160
00:14:15,167 --> 00:14:19,583
somebody actually did the DDoS
trying to grab that picture over
and over. There was this other

161
00:14:19,583 --> 00:14:25,583
one, like a seemingly random
just request with all these
characters then you have some

162
00:14:27,667 --> 00:14:32,208
other like (indiscernible) law
guy it says fuck you mother
fucker tango down and gives his

163
00:14:32,208 --> 00:14:38,208
Twitter address. Which could be
not him at all, it could be
somebody wanting to set him up

164
00:14:40,917 --> 00:14:47,500
but that's what was in there.
And last but not least you have
hitting a random slash node.

165
00:14:47,500 --> 00:14:51,708
This is my favorite though. This
doesn't have a whole lot of
purpose but I just liked it.

166
00:14:51,708 --> 00:14:57,250
Imma Firin' Mah Desu. This is
like a single request. Like look
at the log; what is this?

167
00:14:57,250 --> 00:15:04,583
(Laughter) >> Desu, desu, desu,
desu. (Laughter) >> I would
really like the guy who did this

168
00:15:04,583 --> 00:15:11,958
attack to give him a drink. It
made me laugh for so long. So
going in then the network

169
00:15:11,958 --> 00:15:17,375
defense your carrier has some
capabilities. So you can have a
black list malicious IP

170
00:15:17,375 --> 00:15:23,500
addresses and you can limit
packet sessions, band width, per
second IP that can be useful if

171
00:15:23,500 --> 00:15:29,417
they can do it. Black hole, a
protocol or port. A lot of times
if you see weird UDP floods I

172
00:15:29,417 --> 00:15:33,667
know that ends up being fairly
effective. It's not what we're
covering but I wanted to throw

173
00:15:33,667 --> 00:15:38,833
that in because we're trying to
be as exhaustive as we can on
this talk to give you guys like

174
00:15:38,833 --> 00:15:44,833
a good idea about this stuff.
You can use IPs like Snort or
CeraCotta. It's often ideal as

175
00:15:47,375 --> 00:15:52,958
long as they're not using SSL
you can drop that traffic before
it hits your web server. So

176
00:15:52,958 --> 00:15:57,833
that's pretty good. And load
balance of course, like F5 it's
pricey. I saw them at Black Hat,

177
00:15:57,833 --> 00:16:03,042
I guess now they're advertising
DDoS where before it was a load
balancer. But you can use the

178
00:16:03,042 --> 00:16:06,208
Irules, it supports regular
expressions, and end up blocking
that traffic there as well.

179
00:16:06,208 --> 00:16:12,208
Firewalls, iptables, black list
IP addresses. A lot of people
talk about geographic blocking.

180
00:16:15,542 --> 00:16:20,708
I've not really seen that work
very well but I mean depending
on who your attacker is maybe it

181
00:16:20,708 --> 00:16:26,500
might work for you. It really
depends on your adversary and
who is coming after you. We do

182
00:16:26,500 --> 00:16:32,875
block EGI Hosting, I don't know
if that hosting company is
really insecure or what but if I

183
00:16:32,875 --> 00:16:40,667
remove a block, like Soldier X
starts getting hit like crazy
and finally I think they've

184
00:16:40,667 --> 00:16:44,250
actually black listed from their
site as well to stop their
network from talking to ours.

185
00:16:44,250 --> 00:16:47,708
I'm like, I don't know what's
with you guys. I didn't block
you, just restart a server or

186
00:16:47,708 --> 00:16:53,542
something. Boom, here it comes
from EGI hosting. You can limit
your packet sessions, band width

187
00:16:53,542 --> 00:17:00,458
per second per IP on your level
too. So back to VoxLulz1, it may
not have been VoxLulz1 but we'll

188
00:17:00,458 --> 00:17:06,625
refer to him as. You see he's
got this nice fancy user agent,
fuck you mother fucker tango

189
00:17:06,625 --> 00:17:13,250
down. So, how we block with
Snort inline. You have a simple
Snort rule, you can go through.

190
00:17:13,250 --> 00:17:17,750
(Laughter) >> We had to have
humor to try to keep you awake.
Like I said, I always give

191
00:17:17,750 --> 00:17:22,000
offensive talks. I do reverse
engineering and exploitation. It
seems it would be kind of easy

192
00:17:22,000 --> 00:17:26,000
to keep people's attention but
this stuff, to me, is kind of
dry. So we will try to keep you

193
00:17:26,000 --> 00:17:32,542
a little entertained. So you
have the Snort inline and you
can stop them there. Then it

194
00:17:32,542 --> 00:17:38,292
doesn't reach the web server. If
you have F5 load balancer you
then see the Irules right there

195
00:17:38,292 --> 00:17:45,042
so you can block them at that
point. You've got also, he came
from EGI hosting so we have that

196
00:17:45,042 --> 00:17:50,000
block where you block the whole
slash 24 and you've also got the
limiting connections with IP

197
00:17:50,000 --> 00:17:56,792
tables. These are real world
examples you can copy and paste
or modify just to get you in the

198
00:17:56,792 --> 00:18:02,333
mind set how to do this stuff.
With network defense I also
wanted to mention Blocking TOR.

199
00:18:02,333 --> 00:18:08,833
Well isn't TOR too slow to take
you down? Actually, hack3r is a
group we used to do stuff with

200
00:18:08,833 --> 00:18:14,792
and they were taken down in 2013
then again in 2014 via TOR. So
we have a script, this is

201
00:18:14,792 --> 00:18:19,708
modified from another website.
All the stuff, anything borrowed
or used from anywhere will be at

202
00:18:19,708 --> 00:18:23,083
the end in the references
section, so all of this stuff is
referenced, we don't want to

203
00:18:23,083 --> 00:18:27,792
steal anyone's credit. This is
modified from the site and this
will basically go through, get a

204
00:18:27,792 --> 00:18:32,958
list from dan.me.uk. and then
build an iptables rule and block
it. I don't know how many

205
00:18:32,958 --> 00:18:38,583
companies have issues with TOR
but I know, at least the place I
work we see a ton of attacks

206
00:18:38,583 --> 00:18:45,792
coming from it. No real reason
for us to have it. Like I said,
TOR, people say it's a great

207
00:18:45,792 --> 00:18:50,458
thing. I don't disagree with
that but there may not be any
point. If you're a bank or you

208
00:18:50,458 --> 00:18:52,458
sell things I mean someone is
giving up their identity when
they buy something for you or

209
00:18:52,458 --> 00:18:54,792
when they log in to their bank
account so there isn't really a
reason to use TOR to do that.

210
00:18:54,792 --> 00:19:00,792
It's a question that I propose.
So aside from just the blocking
side it's important for a lot of

211
00:19:07,292 --> 00:19:13,042
people for network monitoring to
figure out am I under attack or
maybe your company might say,

212
00:19:13,042 --> 00:19:18,042
you know, I would like to know
if we're being attacked but I
don't trust you putting this in

213
00:19:18,042 --> 00:19:23,875
line and blocking customers and
whatever so you can just
basically, same snort rule you

214
00:19:23,875 --> 00:19:27,917
just have it do an alert instead
of a drop so that way, you know,
you just get notified of it.

215
00:19:27,917 --> 00:19:33,125
With the F5, what I always do is
I just common out the drop and
you can still go in and get the

216
00:19:33,125 --> 00:19:39,333
notification and see you're
being attacked. But it doesn't
actually drop it. Then next

217
00:19:39,333 --> 00:19:46,000
we'll get into for monitoring
software we have RoboAmp, which
Rat with Solier X wrote.

218
00:19:46,000 --> 00:19:49,375
Actually I'm surprised my phone
hasn't gone off, I really
expected when we announced the

219
00:19:49,375 --> 00:19:54,417
talk we started getting DDoS
like crazy. I really expect the
site to go down during this talk

220
00:19:54,417 --> 00:19:57,583
and my phone will start going
crazy and it will start telling
me, hey the site is down. But I

221
00:19:57,583 --> 00:20:05,208
don't know. I guess I'm lucky.
So, it runs on a Raspberry Pi.
It uses less or equal 5 watts of

222
00:20:05,208 --> 00:20:10,333
power. It displays the power and
little sixteen by two LCD, now
you don't need to have an LCD to

223
00:20:10,333 --> 00:20:16,208
do this. That's just if you want
the display. It actually sends
an SMS message to the SX staff

224
00:20:16,208 --> 00:20:20,792
that there's a disruption. You
have the options; basically you
have a ping check which probably

225
00:20:20,792 --> 00:20:25,917
isn't as useful in today's – you
know if you're talking Layer 7.
Your website is going to kind of

226
00:20:25,917 --> 00:20:29,417
-- or database will go down and
you will get an error message.
You aren't actually -- the ping

227
00:20:29,417 --> 00:20:32,875
check will not do a whole lot
for you but we left it in there
just in case you're worried

228
00:20:32,875 --> 00:20:37,625
about that whole massive attack
that takes down the network. The
deep check, actually what it

229
00:20:37,625 --> 00:20:43,917
does, it looks at the website
and you can specify regular
expression for like basically

230
00:20:43,917 --> 00:20:48,167
what that means if your site is
offline. Some companies don't
actually say we're offline. They

231
00:20:48,167 --> 00:20:52,125
say, oh we're doing a little bit
of maintenance we'll be right
back. They don't want to

232
00:20:52,125 --> 00:20:58,625
acknowledge they've been DDoS'd
so it supports that as well. So
then after that they go back to

233
00:20:58,625 --> 00:21:04,083
web defense or on to web defense
and like I said we use Apache2
at Soldier X so that's going to

234
00:21:04,083 --> 00:21:10,083
be our focus. You can use
.htaaccess for example. A lot of
people seem to like, oh, why do

235
00:21:10,083 --> 00:21:13,750
you use .htaaccess but can
actually protect files,
directory listings, you can

236
00:21:13,750 --> 00:21:18,625
block user agents There's other
clever things we will get into,
like, you can redirect a bad

237
00:21:18,625 --> 00:21:22,917
request back to themselves or
maybe you want to redirect them
to somewhere like FBI.gov.

238
00:21:22,917 --> 00:21:28,167
(Laughter) >> Like I said
Soldier X is basically a hobby
security group and we can do

239
00:21:28,167 --> 00:21:34,042
things as a company you wouldn't
want to do but it's all in good
fun. So mod_evasive is the

240
00:21:34,042 --> 00:21:38,375
equivalent if you're an IS shop,
dynamic IP restrictions for
Microsoft, essentially this is

241
00:21:38,375 --> 00:21:44,125
one of the critical things that
I would say to use because you
can actually use – you're

242
00:21:44,125 --> 00:21:49,958
throttling how they can hit your
site. At the end of the day
without looking into the traffic

243
00:21:49,958 --> 00:21:56,750
that's ultimately what you are
going to do to drive up attacker
cost. So say user agent seems

244
00:21:56,750 --> 00:22:01,875
weird and whatever. This
limiting seems weird. Does this
really work? You have to know

245
00:22:01,875 --> 00:22:08,583
your enemy. So why? You've got
these subset of anonymous with
an F5 armed against us. You've

246
00:22:08,583 --> 00:22:13,333
got basement dwelling 12 year
olds armed with GET flood script
posted to pastebin last Tuesday

247
00:22:13,333 --> 00:22:21,167
hitting us. This is pretty much
how we view our enemy at least
at Soldier X. So getting into

248
00:22:21,167 --> 00:22:27,958
some of those example directions
with .htaaccess that's an easy
way to block VoxLulz or get a

249
00:22:27,958 --> 00:22:33,750
little creative and use
mod_rewrite and redirect to
themselves, redirect them more

250
00:22:33,750 --> 00:22:38,250
interesting like the FBI.gov.
Like I said, it's the FBI party
van. Somehow it's a lot more

251
00:22:38,250 --> 00:22:44,708
funny when it's not parked in
your driveway. (Laughter) >>
Then we just give you a

252
00:22:44,708 --> 00:22:49,250
Mod_evasive sample config. A
thing I'd like to add is if any
of this stuff, if you and copy

253
00:22:49,250 --> 00:22:52,875
and paste it or whatever you
have issue with it I'm not going
to work for you for free or

254
00:22:52,875 --> 00:22:57,792
anything but I'd be happy to
give you stuff that I've already
written and put it on that

255
00:22:57,792 --> 00:23:01,750
directory on the site. If you
guys have access to that just,
you know, I'll give an email at

256
00:23:01,750 --> 00:23:07,292
the end of this as well as IRC
and what not just to try to help
you guys get started on this.

257
00:23:07,292 --> 00:23:13,750
So, then moving on to Fail2Ban.
It's actually designed to
protect against brute force

258
00:23:13,750 --> 00:23:19,625
attacks by looking at error
logs. What we've actually done
and this is by no means new,

259
00:23:19,625 --> 00:23:23,250
there are other people doing
this as well. Just not a lot of
people it seems. You can point

260
00:23:23,250 --> 00:23:28,250
it at your access logs for your
web server and use it for DDoS
defense. If you remember the

261
00:23:28,250 --> 00:23:35,250
random pattern from earlier you
notice the attacker didn't seed
it right. So you see that it is

262
00:23:35,250 --> 00:23:40,375
already repeated but then you
also see I highlighted the equal
mark. So when we get into that

263
00:23:40,375 --> 00:23:46,833
you can turn a randomized DDoS
attempt into a worthless
attempt. What we see with that

264
00:23:46,833 --> 00:23:53,250
is it's a capital letter A
through Z -- 99 of those then an
equals sign, then A to Z and

265
00:23:53,250 --> 00:24:00,792
another 99 of those. So you set
your regX and have your notes,
no DDoS for you and boom, blocks

266
00:24:00,792 --> 00:24:07,417
them with IP tables when they
hit you with that. Once it sees
those it puts them in the IP

267
00:24:07,417 --> 00:24:14,500
tables. I think we blocked them
for like 24 hours. You can do
however long you want but to add

268
00:24:14,500 --> 00:24:21,750
on some additional ideas you
have server caching or web
caching. A lot of the stuff

269
00:24:21,750 --> 00:24:28,792
turns out to be performance
enhancements so it's good anyway
but it actually ends up helping

270
00:24:28,792 --> 00:24:34,708
DDoS. I think a lot of issues
with Layer 7 DDoS is just nobody
was really hitting our websites.

271
00:24:34,708 --> 00:24:39,375
We had expensive inquiries or
this or that but it wasn't
really a problem for us. It was

272
00:24:39,375 --> 00:24:45,125
more or less like oh the search
is little slow but. And then
someone hits it and it's get,

273
00:24:45,125 --> 00:24:49,375
get, get, post, post, post it's
like oh crap the freaking
website is down. With Soldier X

274
00:24:49,375 --> 00:24:54,708
we use boost. I talked to people
that use squid proxy for
caching. They said that has

275
00:24:54,708 --> 00:24:58,833
worked well for them. There are
some other Apache tools that
other people have mentioned to

276
00:24:58,833 --> 00:25:03,500
me. Like I said, if we don't use
it then we don't give examples
so we're not going to make

277
00:25:03,500 --> 00:25:07,583
theoretical stuff up and say
this works and we don't know.
But you have mod_bwshare to

278
00:25:07,583 --> 00:25:11,875
throttle the bandwidth for IP,
you've got limit ip connection
to limit the number of

279
00:25:11,875 --> 00:25:16,625
simultaneous connections from
the IP and there's people using
Captcha, Javascript and those

280
00:25:16,625 --> 00:25:22,625
type of things to actually try
to detect is this a bot or is
this a person? Also for your

281
00:25:24,708 --> 00:25:30,250
programmers you really need if
you have a website that has
these different queries try to

282
00:25:30,250 --> 00:25:35,875
talk to your developers. They
need really get on to this stuff
with strict validation, filter

283
00:25:35,875 --> 00:25:40,750
user input, properly release
resources because you don't want
it eating up all of the memory.

284
00:25:40,750 --> 00:25:45,042
Set limits. So you have session
limits, token expiration, loop
counters, concurrent sessions

285
00:25:45,042 --> 00:25:51,042
per token for IP address,
expensive queries should be
limited per IP address. It

286
00:25:57,042 --> 00:26:01,125
doesn't make expense you know
you have a really expensive
query why would you let someone

287
00:26:01,125 --> 00:26:05,042
hit it 50 times a second. It
doesn't make sense. Cache the
results of those queries when

288
00:26:05,042 --> 00:26:09,000
possible, like what boost does.
It will – anything something
someone goes to that is PHP it

289
00:26:09,000 --> 00:26:13,167
generates an HTML file so boom
there they go. Let's get the
HTML file instead of running the

290
00:26:13,167 --> 00:26:17,208
query over and over and over.
Optimize your database structure
and like I always say I have a

291
00:26:17,208 --> 00:26:21,792
CS background, you should be
testing. You should be testing
your code against denial of

292
00:26:21,792 --> 00:26:26,792
service or distributed denial of
service and that should be part
of quality assurance in your

293
00:26:26,792 --> 00:26:32,083
organization. This is something
that seems to be just a mind set
of these guys they're just going

294
00:26:32,083 --> 00:26:36,292
to come in and DDoS you if they
do anything you don't like or do
it for fun. So it really should

295
00:26:36,292 --> 00:26:43,083
than part of your testing. If
anybody needs like some sample
code I can put it in that

296
00:26:43,083 --> 00:26:47,417
directory and you can use that
to help test in your
organization. >> Testing, ain't

297
00:26:47,417 --> 00:26:53,417
nobody got time for that. >>
That picture says  I don't know
when I use code I do it in

298
00:26:58,208 --> 00:27:03,625
production. [Laughing]. So on to
reacting to an attack. I always
say don't panic. When I've seen

299
00:27:03,625 --> 00:27:07,458
these attacks you have people
throwing their hands in the air.
Oh my God what's going on? The

300
00:27:07,458 --> 00:27:11,250
website is down. There is no
internet. So also verify it's an
attack. I'm not going to say

301
00:27:11,250 --> 00:27:17,250
which company but it was like oh
my God we're being DDoSed. It's
no it's just your employees

302
00:27:19,875 --> 00:27:25,875
watching FIFA via HD on YouTube.
>> 1080p. >> And read the logs.
It's amazing to me how many

303
00:27:36,417 --> 00:27:42,083
people don't actually read logs.
Web logs are good. They actually
give you a bit of insight into

304
00:27:42,083 --> 00:27:49,083
what people are doing. If you
see an IP pounding away it's a
good indication it's an attack

305
00:27:49,083 --> 00:27:55,500
instead of, you know, oh the web
site is down. So getting all the
top talkers and blocking the

306
00:27:55,500 --> 00:28:00,583
malicious ones, there's a quick
thing from the command line that
you can do to give you all the

307
00:28:00,583 --> 00:28:06,083
IPs and how many requests per
IP. If you're in Linux of course
like we said and you need some

308
00:28:06,083 --> 00:28:10,458
sort of reputation system.
Especially if you share with
other organizations. I know I've

309
00:28:10,458 --> 00:28:16,750
seen cases with financial sector
where data is being shared out
and you look in this top

310
00:28:16,750 --> 00:28:23,208
talker's block and it's oh it's
tax time and Intuit is in here.
Of course everybody is using

311
00:28:23,208 --> 00:28:31,000
Turbo Tax. They're not DDoSing
you. It's freaking tax time or
other organizations that query

312
00:28:31,000 --> 00:28:37,458
data from you. So we use a home
grown tool that we call
reputator. I will show you a

313
00:28:37,458 --> 00:28:45,458
little bit of output from that.
So, in a top talkers example, I
like this picture. Be mindful of

314
00:28:45,458 --> 00:28:51,458
that. Only one is a convicted
felon. [Laughing]. >> But how
this stuff goes people are

315
00:28:55,250 --> 00:29:00,458
taking this assumption. Oh,
whoever is generating all of
this traffic my web server must

316
00:29:00,458 --> 00:29:07,125
be malicious. It's not true. So
this is an example that we use
for the Desu attack as we go

317
00:29:07,125 --> 00:29:12,792
through. We're masking all the
IPs that aren't actually
attacking. And, you want to

318
00:29:12,792 --> 00:29:18,375
decide on a cut off. You see on
the left is the actual number of
requests they've done. On the

319
00:29:18,375 --> 00:29:23,833
right is the IP. So we decided
like a thousand is probably a
good cut off. You run it

320
00:29:23,833 --> 00:29:28,208
through, I don't know how well
you can see that but I'll try to
explain it. Run it through

321
00:29:28,208 --> 00:29:34,417
reputater. Also one thing that
reputator does is you grab the
list of TOR nodes, you like to

322
00:29:34,417 --> 00:29:40,417
know if somebody has TOR, it's
useful information. You get a
rating that we put between good

323
00:29:43,000 --> 00:29:49,000
and evil and if you look, like
of course, local is like Roboamp
which actually amp is in the

324
00:29:51,750 --> 00:29:56,708
audience if he wants to stand
up, raise his hand. The reason
his name is Roboamp is every

325
00:29:56,708 --> 00:30:01,208
time the site went down amp
would hit up everybody. Hey the
site is down. What's going on?

326
00:30:01,208 --> 00:30:06,833
It was like man this is crazy.
So when Rat wrote the tool he
named is Roboamp. It's like the

327
00:30:06,833 --> 00:30:14,458
robot version of him and he's
always texting so it's good that
it texts. But back to the top

328
00:30:14,458 --> 00:30:21,083
talkers. If you look  so we have
the good and the next highest
talker is rated as evil then we

329
00:30:21,083 --> 00:30:26,875
look back to the log and we see,
hey, that was the Desu attacker.
So it's pretty good and there's

330
00:30:26,875 --> 00:30:31,583
some other evils up there. Those
guys are actually  they're going
around the site trying to do

331
00:30:31,583 --> 00:30:37,917
stuff but it wasn't DDoS. I
still masked their IP but they
were still up to no good. Then

332
00:30:37,917 --> 00:30:43,750
of course reacting to an attack.
Read logs. Look for patterns
that you could use for Fail2Ban

333
00:30:43,750 --> 00:30:48,792
or whatever blocking system you
are going to have in place.
Often very early on blocking

334
00:30:48,792 --> 00:30:54,792
user agents and IPs, I'm not a
fan of black listing IPs but
early when the attack is going

335
00:31:00,875 --> 00:31:05,000
on sometimes that can be what
you need to do right away to
keep your site online. Then

336
00:31:05,000 --> 00:31:08,917
beyond that use sniffer and
wireshark if you can. SSL forces
an issue like if you're using

337
00:31:08,917 --> 00:31:13,000
RSA or if you're not using RSA
and you're using DSA that has
forward secrecy you can't see

338
00:31:13,000 --> 00:31:16,625
the traffic but if you are using
RSA in your organization are
they going to give you their

339
00:31:16,625 --> 00:31:23,917
private key? Maybe. But if you
can get that you can look at it.
And from that, you know, Snort

340
00:31:23,917 --> 00:31:29,167
F5, Surricata, etc you can block
at the network level which is
often a little more intensive

341
00:31:29,167 --> 00:31:36,500
work wise but it can have a
better payoff because it never
even reaches the web server. So,

342
00:31:36,500 --> 00:31:42,500
can you find the difference? I
love that picture. So this is 
yeah  a sniffer plus wireshark

343
00:31:47,000 --> 00:31:52,500
example. So the first one if you
see this has been blocked so
there's 3. The first is an

344
00:31:52,500 --> 00:31:58,250
actual legitimate web request.
You say okay pass the carriage
return the new line: The second

345
00:31:58,250 --> 00:32:03,667
one is a popular perl DDoS
application. If you look and it
doesn't have the carraige

346
00:32:03,667 --> 00:32:09,667
return, GET flood, HTTP1.1 it
basically has nothing. Pretty
easy to see that's not valid.

347
00:32:12,750 --> 00:32:18,750
After that you have an attack
tool that uses PI cURL, python
DDoS tool and that one it's

348
00:32:22,167 --> 00:32:28,083
better. It has a carraige return
a new line but if you look like
the variables don't quite match

349
00:32:28,083 --> 00:32:33,750
up what a browser would, they're
out of order. So they're all
these little things that really

350
00:32:33,750 --> 00:32:41,333
is like you look at and actually
use your head then get rules to
stop these attacks. So then

351
00:32:41,333 --> 00:32:47,708
after an attack if an attack was
effective why was it effective?
In the brainstorming

352
00:32:47,708 --> 00:32:52,792
organization you need to do a
lot of testing, deploy these
defenses, we're not going to

353
00:32:52,792 --> 00:32:58,375
work for your company for free
but happily anything here I will
put online and let you use that

354
00:32:58,375 --> 00:33:03,625
as a good base to get started
and test your network against a
similar attack until your

355
00:33:03,625 --> 00:33:08,708
defensive or effective. Don't
wait for the attacker to come to
you. This is part of like the

356
00:33:08,708 --> 00:33:13,542
Solider X stuff. Anytime we see
the stuff we write tools to
duplicate the attack and pound

357
00:33:13,542 --> 00:33:18,042
on the servers and make sure our
defenses actually work. The
controversial thing it keeps

358
00:33:18,042 --> 00:33:24,708
coming back up in the news.
Let's hack back. So we have some
form users that have hacked the

359
00:33:24,708 --> 00:33:28,667
DDoSers that we can get
attribution on with some
success. It's kind of amusing,

360
00:33:28,667 --> 00:33:32,042
some of the stories. I have a
quote from Jeff Barden, I'm not
actually going to read that one

361
00:33:32,042 --> 00:33:37,667
because I don't really think
hacking back is good but some
people may like it so I think

362
00:33:37,667 --> 00:33:42,125
it's not a good idea in general
and that's where I quote
Jericho, Brian Martin of

363
00:33:42,125 --> 00:33:45,250
Attrition. If a company can't do
the defense correctly why do you
think they can do offense right?

364
00:33:45,250 --> 00:33:51,250
And if you can easily and
positively attribute they
shouldn't have breached your

365
00:33:54,833 --> 00:34:00,500
differences. You have no
business attacking them when you
were negligent on defense 101. I

366
00:34:00,500 --> 00:34:06,500
agree. If you can 100 percent
say who is attacking you and why
they got through that doesn't

367
00:34:09,333 --> 00:34:16,042
make any sense. You should have
had defense in place. But shame;
back to the John Gabriel's

368
00:34:16,042 --> 00:34:22,833
theory. Shame has actually
worked really well on Soldier X.
It seems like we have these guys

369
00:34:22,833 --> 00:34:29,000
that hit the site hard and we
actually come in and we have a
really good guy that does data

370
00:34:29,000 --> 00:34:34,542
analytics and he has a data
analytics platform that runs on
the site and we actually can get

371
00:34:34,542 --> 00:34:39,667
positive attribution if you name
the people out it's like
instantaneously they stop

372
00:34:39,667 --> 00:34:44,500
attacking you. So I mean for
most companies you probably
can't do that but it's

373
00:34:44,500 --> 00:34:51,667
interesting to think about. So
then tying this stuff together
with best practices is like I

374
00:34:51,667 --> 00:34:56,042
said most important thing I
think is limiting connections.
Because when you do that you

375
00:34:56,042 --> 00:35:01,000
drive up costs. If somebody has
to have a botnet a size you
drive it up more. Have

376
00:35:01,000 --> 00:35:07,000
intelligent ways to block bad
traffic. Snort inline, Fail2Ban,
whatever. You need some way so

377
00:35:09,625 --> 00:35:15,250
if someone is actually brighter
and has some pretty good attack
you need to be able to identify

378
00:35:15,250 --> 00:35:20,000
that and block it. Have sniffers
in place. I've seen
organizations where they don't

379
00:35:20,000 --> 00:35:22,542
and it's like we're getting
attacked. Oh we have to get
sniffers in place and figure it

380
00:35:22,542 --> 00:35:29,042
out. You should already have
them in place. And tune your web
server and database for

381
00:35:29,042 --> 00:35:33,792
performance. One of the things
like log tuning, like what's log
tuning? It's like you should

382
00:35:33,792 --> 00:35:38,000
have where you're getting things
like client IP and
X-forwarded-for in your logs.

383
00:35:38,000 --> 00:35:44,667
You probably don't want to log
small static content like CSS,
JS, text, if it's PDF or large

384
00:35:44,667 --> 00:35:48,083
pictures you probably want to
log that because it can be used
in an attack but a CSS file, a

385
00:35:48,083 --> 00:35:52,958
JS file isn't so why log that?
All you are doing is making your
web server take up that many

386
00:35:52,958 --> 00:35:58,042
more resources trying to log all
of that. You should remove or
limit the search functionality

387
00:35:58,042 --> 00:36:03,333
if not needed. You can replace
it with Google search or it
requires loggers to log in. That

388
00:36:03,333 --> 00:36:08,458
is how hack3r was taken down.
People hit their search
functionality and held the site

389
00:36:08,458 --> 00:36:14,292
down for days and everyone is
laughing about it. Avoid hosting
large public files when you can

390
00:36:14,292 --> 00:36:20,208
like large PDF getrequests. It
still goes on so if you can have
those not public that is ideal,

391
00:36:20,208 --> 00:36:24,208
sometimes you have to. Having a
monitoring service like Roboamp.
I now a lot of you guys might

392
00:36:24,208 --> 00:36:28,542
pay for something but Roboamp is
free and you can set that up and
actually get notification if the

393
00:36:28,542 --> 00:36:33,000
site goes down. Instead of like
hearing about it from your boss.
And then sharing information. It

394
00:36:33,000 --> 00:36:39,000
has been good for the financial
sector. I think if you can you
have similar companies and if

395
00:36:41,792 --> 00:36:45,875
you can share that sort of
information everybody gets on
the same page and gets those

396
00:36:45,875 --> 00:36:51,542
defenses in place and these guys
will see this stuff doesn't work
anymore. So I don't have much

397
00:36:51,542 --> 00:36:56,375
time for questions but I want
time for questions. So, a little
bit of story time. So VB is the

398
00:36:56,375 --> 00:37:01,500
first guy to do this took the
site down for like 5 minutes.
This was before we had anything

399
00:37:01,500 --> 00:37:06,292
in place. He actually did it
from his IP that his user
account was from so we were able

400
00:37:06,292 --> 00:37:13,708
to do positive attribution. So
this guy hacker on the forum a
reformed criminal but the fixer

401
00:37:13,708 --> 00:37:18,750
got the IP we posted on the
forums and turned out that VB's
ISP was mikrotik routers, that's

402
00:37:18,750 --> 00:37:25,250
who the fixer used to work for,
he knew there was a back door in
the router so he got into the

403
00:37:25,250 --> 00:37:31,542
guy's ISP, turned on remote pcap
and basically lols ensued. All
sorts of stuff that VB was

404
00:37:31,542 --> 00:37:36,417
doing, who he was and it was a
good time. BenOwns is
interesting. This is a guy that

405
00:37:36,417 --> 00:37:39,375
wanted access to VIP forms to
use like a stolen credit card
and all this weird stuff. He was

406
00:37:39,375 --> 00:37:46,250
like oh I don't want you guys to
say that I did this. Well you
did do this so it's on the site.

407
00:37:46,250 --> 00:37:52,250
So he actually started to
threaten the site and blackmail
them and proceeded to DDoS. More

408
00:37:56,125 --> 00:38:00,833
shame happened. Once we said
this guy was DDoSing he took off
as well. There's been many

409
00:38:00,833 --> 00:38:05,375
stories of pizzas being ordered
when there's an attribution. The
EGI hosting stuff I already

410
00:38:05,375 --> 00:38:12,792
covered. Plexor was the guy that
when we announced this talk
immediately the site started

411
00:38:12,792 --> 00:38:19,458
getting DDoSed. Is this a friend
messing with us? It was a guy
that didn't like we were giving

412
00:38:19,458 --> 00:38:25,500
a talk on this and the last one
I'll much is Scorpion – was
Operation Ababil, Cisconinja did

413
00:38:25,500 --> 00:38:31,250
a lot of hacker database work so
he found some evidence that
Scorpion was involved in

414
00:38:31,250 --> 00:38:36,250
Operation Ababil. So that got
posted onto the hacker database
and all of the sudden we saw

415
00:38:36,250 --> 00:38:42,500
some hits where there was a
Black Hat Middle Eastern forum
and they were like what is this?

416
00:38:42,500 --> 00:38:48,125
These Soldier X guys are saying
Scorpion is involved in this.
All of a sudden the site was hit

417
00:38:48,125 --> 00:38:53,458
with Operation Ababil tools. It
was not actually hit from the
Brobot but it was hit from the

418
00:38:53,458 --> 00:38:56,792
same attack tools and since I
was actually defending it
against Operation Ababil I said

419
00:38:56,792 --> 00:39:04,583
you really are him and using
these tools so you gave yourself
away. A little bit of thanks.

420
00:39:04,583 --> 00:39:11,042
Anonymous network technicians
didn't want their names in here.
So if you talk about DDoS you

421
00:39:11,042 --> 00:39:18,333
will get DDoSed which may happen
but oh well. Rat, for writing
RoboAmp helped a lot with this,

422
00:39:18,333 --> 00:39:24,042
a lot of the rules and The
Fixer, lattera, spendor, sn4ggi,
Shinobi, Kohelet, EverestX,

423
00:39:24,042 --> 00:39:28,167
Jericho, Jeff Barden, Rhapsody
and the entire SoldierX.com
community to include the

424
00:39:28,167 --> 00:39:35,125
irc.soldierx.com and of course
the DDoS skids like honestly
it's a lot of entertainment for

425
00:39:35,125 --> 00:39:42,125
me. So I had a lot of fun at
your expense. References of
course for you guys to use then

426
00:39:42,125 --> 00:39:47,375
this is our contact information
if you want to reach out to us.
This is where the data is and I

427
00:39:47,375 --> 00:39:53,375
think we have a few minutes for
questions. [Applause].

