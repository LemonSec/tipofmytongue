1
00:00:00,042 --> 00:00:05,125
Thank you so much for being here
this early in the morning. A lot
of people think there are no

2
00:00:05,125 --> 00:00:11,458
mornings in Vegas. We're proving
them wrong consistently. And
anyway we're going to talk about

3
00:00:11,458 --> 00:00:16,167
measuring the IQ of your threat
intelligence feeds. If you are
from the internet and you do the

4
00:00:16,167 --> 00:00:22,500
Twitters we have, like, a
hashtag so you can hash tag the
talk and making fun of us.

5
00:00:22,500 --> 00:00:27,417
Please do because I want to
laugh at everything later
because I can't check Twitter

6
00:00:27,417 --> 00:00:32,875
here. It's kind of lame but
that's the way it is. I don't
like talking about myself. I

7
00:00:32,875 --> 00:00:38,417
just brought here a very special
guest. This is Wendy Nader. She
going to do the introductions

8
00:00:38,417 --> 00:00:44,417
for us. >> You didn't bring my
fez and my cup of rum. All
right. Good morning again

9
00:00:52,833 --> 00:00:57,792
everybody. I want to introduce
these awesome guys. I am a
little annoyed with them because

10
00:00:57,792 --> 00:01:02,750
in my analyst role I cover
threat intelligence and in this
talk is just something that I

11
00:01:02,750 --> 00:01:08,667
wanted to do. But they probably
did it a lot better anyway. We
have Alex Pinto otherwise known

12
00:01:08,667 --> 00:01:16,458
as the brain from Brazil. Is
that right? He's been giving
talks in all three conferences

13
00:01:16,458 --> 00:01:21,875
this week. And people just can't
get enough of him. And his
hacker spirit animal is

14
00:01:21,875 --> 00:01:27,875
decaffeinated Kathy Barra. Kyle
Maxwell, on the other hand, is a
math smuggler. His spirit animal

15
00:01:31,083 --> 00:01:37,042
is the axiomatic armadillo. I'm
here to tell you he is a
fugitive time traveling Karl

16
00:01:37,042 --> 00:01:43,042
Marxs and there's a reason why
his initials are KM. Sorry. I
had to out you like that. So

17
00:01:46,833 --> 00:01:52,833
enjoy the talk. (Applause) >>
Thank you so much. Anyway, we're
going to cover a bunch of stuff.

18
00:01:56,125 --> 00:02:02,125
We're just going to give a brief
introduction about threat intel
and really go into what is the

19
00:02:04,667 --> 00:02:08,875
crazy idea about measuring
threat intelligence. Anyway I'll
just ask Kyle to do his magic.

20
00:02:08,875 --> 00:02:14,875
>> Good morning everybody. So
we're going to talk real quick
about threat intel. We didn't

21
00:02:19,000 --> 00:02:24,250
want to do threat Intel 101 for
those who have thought about it
before. Honestly the stuff we

22
00:02:24,250 --> 00:02:29,125
talked about today, talk about
that what that really means.
When we talk about threat intel,

23
00:02:29,125 --> 00:02:35,125
or intel in general there's two
things we really actually care
about. It's not IP addresses.

24
00:02:39,500 --> 00:02:46,417
Its capability and intent,
right? What can your foes, I
hate the word "adversaries" and

25
00:02:46,417 --> 00:02:52,417
all of that. So I'm going to
bring it back Viking style. What
are your foes able to do and

26
00:02:52,417 --> 00:02:58,417
what do want to do? That's what
you really want to know so you
can prepare on your end for

27
00:03:00,750 --> 00:03:08,292
whatever it is that you need to
do. So that's the core idea that
what we're trying to measure,

28
00:03:08,292 --> 00:03:13,708
honestly most of the time what
we look at threat intel is
capability. What are they doing?

29
00:03:13,708 --> 00:03:19,792
What are they able to do? We
don't spend enough time looking
at what they can do or rather

30
00:03:19,792 --> 00:03:25,333
what they're planning to do. So
we'll talk about that a little
bit. There are a couple of key

31
00:03:25,333 --> 00:03:30,875
concepts that I want you to be
able to take away where there
are some dichotomies within this

32
00:03:30,875 --> 00:03:36,583
field. So we're going to talk
about kind of these cage match
between things that oppose each

33
00:03:36,583 --> 00:03:43,167
other. One of them signatures
versus indicators. So Dave Vital
for example has made the point

34
00:03:43,167 --> 00:03:48,917
very correctly that a lot of
times the way people use
indicators or indicators of

35
00:03:48,917 --> 00:03:53,667
compromise sounds like
signatures, right. But that
shouldn't be. If you are using

36
00:03:53,667 --> 00:03:58,542
them that way, you are doing it
wrong. 	The idea is that
indicators rather a signature

37
00:03:58,542 --> 00:04:03,000
says this is definitely
something that happened here.
It's, like, a fingerprint,

38
00:04:03,000 --> 00:04:09,375
right. You have a very, very
high degree of confidence that
this means X. Whereas an

39
00:04:09,375 --> 00:04:15,292
indicator says look over there,
there's something fishy going
on. And you may have different

40
00:04:15,292 --> 00:04:20,667
levels of confidence. You may
even have a pretty dang high
level. But the reality is that

41
00:04:20,667 --> 00:04:25,792
it's not supposed to be used for
blocking. It's not to be used
for complete confidence. It's

42
00:04:25,792 --> 00:04:30,833
supposed to indicate something
that you need to go look at. The
other thing I'm going kind of

43
00:04:30,833 --> 00:04:37,167
deflate a little bit here is the
difference between threat data
and threat intelligence and data

44
00:04:37,167 --> 00:04:42,667
and intelligence in general. Now
we talk about threat intel feeds
here because that's what vendors

45
00:04:42,667 --> 00:04:49,083
typically label them as. But
they're generally speaking
they're doing it wrong. It's not

46
00:04:49,083 --> 00:04:56,917
threat intel because it's data.
Data without context is UGH. If
you want Intel you need to do a

47
00:04:56,917 --> 00:05:02,875
lot of things, right. You need
to be able to establish some
context around it. You need to

48
00:05:02,875 --> 00:05:07,917
be able to add some of that
intent and capability understand
and we talked about it a minute

49
00:05:07,917 --> 00:05:14,333
ago. And as we're going to see
you kind of escalate up the
abstraction of what you are

50
00:05:14,333 --> 00:05:19,125
looking for. But since this is
what vendors sell it as we want
to make sure people know at

51
00:05:19,125 --> 00:05:24,167
least what we're coming to talk
about. There's also a difference
between tactical and strategic

52
00:05:24,167 --> 00:05:30,167
intel. Tactical you can think of
as the how and the what. Like
what they're attacks, how

53
00:05:33,125 --> 00:05:37,958
they're going about it. Whereas
strategic intel and this is a
continuum not a binary either

54
00:05:37,958 --> 00:05:44,500
or, towards the strategic end,
you have the who and why. Who
are my foes? Why do they care?

55
00:05:44,500 --> 00:05:50,333
And why do I care about them?
This continuum is important to
understand what type of Intel

56
00:05:50,333 --> 00:05:55,833
you are getting. And then very
briefly we talk about atomic
indicators versus composite.

57
00:05:55,833 --> 00:06:02,458
Atomic indicators are an IP
address. A packet stream you are
looking for. A hash And

58
00:06:02,458 --> 00:06:08,417
composite is when you pull these
things together and now you
start to get some value out of

59
00:06:08,417 --> 00:06:13,542
them because I really don't give
a SHIT about the IP address but
I do if I see it combined with

60
00:06:13,542 --> 00:06:17,583
other things. 	A colleague of
mine has a concept he calls the
pyramid of pain! And I always

61
00:06:17,583 --> 00:06:23,583
use it because I like to say it
like that. The pyramid of pain!
And the pyramid is basically

62
00:06:28,792 --> 00:06:35,750
this idea. At the bottom of the
pyramid and you can quibble and
Alex and I do, about what is

63
00:06:35,750 --> 00:06:42,000
easier and what's more trivial,
IPs or domain. The honest truth
is it really depends on content

64
00:06:42,000 --> 00:06:47,833
if you are talking about domain
generation algorithms versus
phishing. or what have you, but

65
00:06:47,833 --> 00:06:52,333
the idea is Either way they're
kind of at the bottom. It's
pretty easy to get a lot of IP

66
00:06:52,333 --> 00:07:00,292
addresses. Right? It's also easy
for foes to change their IP
address. As you move up this

67
00:07:00,292 --> 00:07:07,333
pyramid of pain you get network
artifacts that are a little
harder for you to analyze and

68
00:07:07,333 --> 00:07:11,083
figure out what to look for. And
a little bit harder for the
attack to be able to change on

69
00:07:11,083 --> 00:07:16,250
his end. Whereas now when you
start to get to specific tools
of TTP whic are tactics,

70
00:07:16,250 --> 00:07:22,708
techniques and procedures, how
these guys go about what they're
doing, that's much harder. It's

71
00:07:22,708 --> 00:07:28,000
much harder to change your
process than it is to flip a bit
and have the hash come out

72
00:07:28,000 --> 00:07:32,708
completely differently. Now,
that said, we talked about
simple, easy.and trivial We're

73
00:07:32,708 --> 00:07:39,542
going to see it's not always
they're simple and easy. But
relative to these other things,

74
00:07:39,542 --> 00:07:45,542
right. With that said, I'll hand
back over to my brother here to
go into his analysis. >> So, I

75
00:07:47,708 --> 00:07:51,917
mean, just a side note. I think
if you did like do the pyramid
of pain in a falsetto voice it

76
00:07:51,917 --> 00:07:58,750
would be much more funnier. But
that's just me. >> That would
hurt my throat. >> Okay it's

77
00:07:58,750 --> 00:08:04,750
your throat. I guess the point
here is like Kyle was talking
about, I mean, should we care

78
00:08:06,750 --> 00:08:12,333
more about the IP addresses and
domain names if that's all you
got? Ideally all of our

79
00:08:12,333 --> 00:08:19,333
intelligence would be a bunch of
contacts in it. We'd all have
animal names attached to all of

80
00:08:19,333 --> 00:08:26,042
them and it would be awesome. We
would really understand what
we're up against. I really want

81
00:08:26,042 --> 00:08:29,458
to work with IP addresses here.
They have a bunch of interesting
stuff we can look for. And the

82
00:08:29,458 --> 00:08:34,208
thing that is interesting for
me, it's finite resource people
are always bitching about iPv6

83
00:08:34,208 --> 00:08:40,292
stuff like that. The fact is
there is an intrinsic cost of
getting and changing an IP

84
00:08:40,292 --> 00:08:45,458
address. Some places it's easier
or less easy for you to get an
IP address to do that stuff.

85
00:08:45,458 --> 00:08:51,458
Right. So people are quite on to
it. Some data centers, some
providers, if you try to do

86
00:08:56,792 --> 00:09:00,958
something a little weird they'll
shut you down almost
immediately. Others you like to

87
00:09:00,958 --> 00:09:05,542
have to talk to them we've been
here for three months while
they're ignoring you and stuff

88
00:09:05,542 --> 00:09:13,208
stay there's forever. Maybe
there is some structure, some
patent there. I'm actually

89
00:09:13,208 --> 00:09:17,167
proposing that if we're getting
a bunch of these IP addresses
why don't we try some

90
00:09:17,167 --> 00:09:20,958
experiments in them to see if we
can learn a little bit more
about what thus threat

91
00:09:20,958 --> 00:09:27,250
intelligence landscape is, I
don't say that in the threat
intelligence landscape like all

92
00:09:27,250 --> 00:09:31,792
capital letters like what the
world is doing against the world
in cyber war. But who is

93
00:09:31,792 --> 00:09:38,125
actually trying to get to you.
That's the thing you should be
most concerned about. 	Anyway

94
00:09:38,125 --> 00:09:44,833
let's try to do some science
here. Can we measure how much a
specific feed is going to help?

95
00:09:44,833 --> 00:09:50,750
How it's going to help us in our
strategic defense of practice
we're trying to do in our

96
00:09:50,750 --> 00:09:55,250
organization. Can we actually
get something out of them. Are
they just a bunch of numbers

97
00:09:55,250 --> 00:10:01,708
with DOTS in them? How can we
actually measure? I have some
ideas and I wanted to share

98
00:10:01,708 --> 00:10:09,250
those ideas with you. 	 So
actually I put together all of
this is GPL3, a bunch of

99
00:10:09,250 --> 00:10:15,667
statistical tests and data
visualization that you can do,
You do have to use R. I almost

100
00:10:15,667 --> 00:10:20,917
did it on purpose so you guys
start to get to know some
statistical languages. Get with

101
00:10:20,917 --> 00:10:25,958
the times. In five years it's
all going to be data. I'm sorry
but that's pretty much it.

102
00:10:25,958 --> 00:10:32,000
There's some phyton dude beside
me who is just going to be
bothering me the rest of the

103
00:10:32,000 --> 00:10:39,333
talk. All the code is there. The
sample data that i used for the
talk is there. So you can rerun

104
00:10:39,333 --> 00:10:44,250
everything and say there is a
bug here youre such a stupid
guy, and stuff like that. But

105
00:10:44,250 --> 00:10:48,917
look how I know how to use this
library much better than you.
You can do all this awesome

106
00:10:48,917 --> 00:10:54,917
stuff. Also, all the graphs and
all the data that I show here is
in the mark down file. So it's

107
00:10:54,917 --> 00:10:59,250
pretty much here is blah, blah,
blah. Here is the code, the
results. you can actually follow

108
00:10:59,250 --> 00:11:04,250
thru if you like It's all in the
repository. There's a link to
everything. Let's get started. I

109
00:11:04,250 --> 00:11:10,250
think. 	Just for you to have a
general idea how did I structure
this data, how did I try to,

110
00:11:14,083 --> 00:11:18,750
like, create a sample database
or something like that? First of
all, I was trying to extract

111
00:11:18,750 --> 00:11:23,042
what I am calling the raw
information from this feed,
right. And I extract both IP

112
00:11:23,042 --> 00:11:29,042
addresses and host names. Just a
side note, all of this data is
publicly available, right. So

113
00:11:32,500 --> 00:11:37,542
all this stuff that I've
gathered, and I'm going to show
here, you might as well just

114
00:11:37,542 --> 00:11:42,000
gather. And we actually have a
treat for you by the end of the
talk that we might just need to

115
00:11:42,000 --> 00:11:49,708
help you a little bit with that.
But the point here is, okay, you
got your iPv4s you git your

116
00:11:49,708 --> 00:11:57,333
FQDNs I did this weird thing. It
may sound weird at first when I
am calling stuff inbound or

117
00:11:57,333 --> 00:12:03,417
outbound. And it's pretty much
I'm just trying to differentiate
very broadly between the types

118
00:12:03,417 --> 00:12:07,792
of threats, let's say, that
these IP addresses and domain
names provide me. not so much

119
00:12:07,792 --> 00:12:14,625
domain names for inbounds but
uuhhh So think about the way the
data flows from your

120
00:12:14,625 --> 00:12:20,125
organization or your IP or your
dingly tingly internety thingy
think about all the direction as

121
00:12:20,125 --> 00:12:26,125
things go in and go out, right.
So, if it's someone that is
spamming you I am calling that

122
00:12:28,792 --> 00:12:35,917
an inbound feed. If you have to
access this website to download
this malware or it's a dropper

123
00:12:35,917 --> 00:12:42,917
or CNC I am calling that
outbound. and thats pretty much
the list of the feeds that i am

124
00:12:42,917 --> 00:12:47,458
harvesting, There is a mistake
in this slide so you are free to
call me out on the internet if

125
00:12:47,458 --> 00:12:54,750
you figure it out. But the point
is, and all of this is
documented which feed is which

126
00:12:54,750 --> 00:12:58,333
but if you guys have been
playing around with this you
should recognize most of them

127
00:12:58,333 --> 00:13:05,833
almost immediately. How did we
prepare this data for the
experiments we're going to talk

128
00:13:05,833 --> 00:13:13,042
about? First of all, we I only
wanted to work with IP
addresses. First because there's

129
00:13:13,042 --> 00:13:20,250
more interesting topological
stuff that you can work with as
opposed to domain names. I do

130
00:13:20,250 --> 00:13:26,958
plan to do something similar to
this using who is data in a
future installment of this

131
00:13:26,958 --> 00:13:31,708
specifically for host names. But
I was only willing to work and
frankly only had time to work

132
00:13:31,708 --> 00:13:37,375
with IP addresses. So I just ran
all the domain names through the
passive DNS database.

133
00:13:37,375 --> 00:13:43,708
Particularly the far sight. For
that day that I got this
indicator, what were the IP

134
00:13:43,708 --> 00:13:49,708
addresses active that day,
right. Assuming you had the data
and were taking some measure of

135
00:13:53,333 --> 00:13:58,708
that data, that would be the IP
addresses you have been flagged
as weird, malicious or

136
00:13:58,708 --> 00:14:04,250
suspicious or however you take
this threat intelligence. So we
also removed non-public IPs we

137
00:14:04,250 --> 00:14:08,833
dont care if the IP address
results to local hosts that's
obviously a parking technique

138
00:14:08,833 --> 00:14:15,750
but it wasn't really conductive
to what we were trying to do
here. Anyway, we got this domain

139
00:14:15,750 --> 00:14:21,167
names and IP addresses and we
made them a bunch of IP
addresses. After we do that we

140
00:14:21,167 --> 00:14:26,333
went to do some enriching on
these guys. So we want to make
sure we were able to identify

141
00:14:26,333 --> 00:14:31,667
what were the ASs that was
associated with the IP addresses
on that specific day. So there's

142
00:14:31,667 --> 00:14:37,000
a period of time that we have
the data for and that's when we
did those, we did those

143
00:14:37,000 --> 00:14:41,125
enrichments right. Also country
from geo occasion databases. We
also resolved the remote host

144
00:14:41,125 --> 00:14:44,583
also using passive DNS at that
time. And I had some plans for
it but we didn't wasn't really

145
00:14:44,583 --> 00:14:50,583
interesting. The data was too
sparse. There was not a lot of
cool stuff to be shown. Just a

146
00:14:57,458 --> 00:15:05,000
side note as well. Although we
are doing geolocation there will
be no maps at this presentation.

147
00:15:05,000 --> 00:15:11,000
Maps are not a good way to look
at data. Please, stop doing
that. (Applause) I mean, if the

148
00:15:16,833 --> 00:15:22,833
country is big you think they're
more of a threat. That's how the
brain works. They look at stuff

149
00:15:22,833 --> 00:15:28,833
that's bigger and more
important. Stop using maps. Okay
let's move on So, yeah, this is

150
00:15:32,625 --> 00:15:38,625
a sample, right. And you can see
exactly how easy or not it is to
actually use the code that I put

151
00:15:43,417 --> 00:15:47,958
together to actually okay I'm
going to load in from my
database and I want to see it

152
00:15:47,958 --> 00:15:53,083
and see what data is in it, et
cetera, et cetera. You can see
there some examples of things

153
00:15:53,083 --> 00:15:58,417
that people thought to be bad in
a specific moment and time. All
right we got our data. So what

154
00:15:58,417 --> 00:16:04,833
are we going to do with it? I
propose three different
experiments here, right. I'm

155
00:16:04,833 --> 00:16:10,833
calling them novelty. It is a
pun because it has both
meanings. You can use it because

156
00:16:12,917 --> 00:16:20,250
that's how much this feed is
refreshing itself as time goes
by. Or maybe it's just like I am

157
00:16:20,250 --> 00:16:24,500
going to add a bunch of stuff
and take a bunch of stuff off.
and make it look really active

158
00:16:24,500 --> 00:16:29,333
But anyway you got to know how
your feeds are updating
themselves. You want to make

159
00:16:29,333 --> 00:16:34,542
sure that whomever you are
getting them from be them open
source or commercial, the guys

160
00:16:34,542 --> 00:16:40,042
actually putting some work into
it. Because, I mean, things move
around. There's an overlap test

161
00:16:40,042 --> 00:16:46,208
which is one that I mean, it's
the most simplest thing ever.
Just, like, let's compare

162
00:16:46,208 --> 00:16:51,875
everyone against everyone and
see how much they have the same
indicators, right. This is

163
00:16:51,875 --> 00:16:57,458
specifically useful if you are
trying to buy something, right.
Just get all the open source

164
00:16:57,458 --> 00:17:03,542
feed that you can handle,
compare them against the
commercial feed, and how much am

165
00:17:03,542 --> 00:17:10,250
I actually getting for X. I
completely lost it. But like
this ridiculously amount of

166
00:17:10,250 --> 00:17:16,917
money I am paying for this. The
one that is much more
exploratory there a little bit

167
00:17:16,917 --> 00:17:23,333
more math than the other ones
which I'm calling the population
test. Which is can the data

168
00:17:23,333 --> 00:17:28,167
we're getting actually teach us
something about our adversaries?
Can we actually learn something

169
00:17:28,167 --> 00:17:35,958
from them? Sorry. Sorry. Foes.
Foes. Can we actually learn
something from this? Can we

170
00:17:35,958 --> 00:17:42,917
actually find some patterns on
this attacks? Anyway, population
is tricky. I'm doing some

171
00:17:42,917 --> 00:17:48,333
examples here where I'm
comparing against the whole
population of IP addresses where

172
00:17:48,333 --> 00:17:53,958
they should be at least. And
also should ideally mean your
data. So get your data and

173
00:17:53,958 --> 00:18:01,625
compare how are the IP addresses
that your companies accesses or
accessed by your company against

174
00:18:01,625 --> 00:18:07,625
actual threat intel feeds.
Anyway, we'll get there. I was
looking for an IQ. I wanted a

175
00:18:10,333 --> 00:18:15,875
grade. No we're not going to get
there. Specifically, I want to
make sure that you guys

176
00:18:15,875 --> 00:18:22,333
understand that the idea here is
to make sure that you guys are
able to reach your own

177
00:18:22,333 --> 00:18:27,000
conclusion, right. Whatever I
think is right for my company as
far as the specific mix of

178
00:18:27,000 --> 00:18:32,000
threat intelligence or i should
be focusing on this or that is
going to be very, very different

179
00:18:32,000 --> 00:18:36,250
from whatever you are doing at
yours. I just want to make sure
that you understand, feel free

180
00:18:36,250 --> 00:18:42,792
to publish your own Metrics.
Feel free to tell X Y X sucks.
I'll try not do this because I

181
00:18:42,792 --> 00:18:48,792
kind of like data and I don't
want to piss of everyone at the
same time. I try to get on their

182
00:18:51,125 --> 00:18:57,125
good side. if you wanna meet and
do this work for you i can help
you out >> youre so nice. >>

183
00:18:59,458 --> 00:19:05,917
Well I don't know. Anyway, I do
intend to--I will do more
private research on this because

184
00:19:05,917 --> 00:19:12,500
there is all of this comes from
the other researching that I do.
So I actually had to go through

185
00:19:12,500 --> 00:19:17,792
all of this. I'm explaining
which were the threat intel
pieces I would use in my models.

186
00:19:17,792 --> 00:19:25,667
Just thought it would be
interesting to share. Anyway,
novelty test. So we're measuring

187
00:19:25,667 --> 00:19:31,375
pretty much added and drop
indicators, right. So how much
stuff is being added day by day

188
00:19:31,375 --> 00:19:35,917
and how much stuff is being
removed day by day, right? And
if you run this kind of thing

189
00:19:35,917 --> 00:19:40,792
you will get something like
this. This is specific for
inbound. So alienvault is

190
00:19:40,792 --> 00:19:46,792
actually divided because they
got both stuff in there. It's
majorly inbound. There's a lot

191
00:19:49,042 --> 00:19:56,208
of inbound stuff. And it's
because it's fairly easy to get
like you just run a couple of

192
00:19:56,208 --> 00:20:03,333
honey pods and suddely you are
like threat intelligence all the
way to the bank. That sounded

193
00:20:03,333 --> 00:20:11,042
worse than I meant it to sound.
But anyway. The point here is
you want to make sure that the

194
00:20:11,042 --> 00:20:15,542
stuff that you are doing is
actually refreshing itself with
something. So you can see there

195
00:20:15,542 --> 00:20:20,792
just like a 20 percent refresh
in one of them. Sometimes 50
percent. You definitely do not

196
00:20:20,792 --> 00:20:26,792
want the guy on the lower right.
I mean, they're not dropping any
IP addresses, right. The red

197
00:20:28,958 --> 00:20:33,667
line is how much it's being
dropped. So it's an upside down
and the blue graph is how much

198
00:20:33,667 --> 00:20:38,750
is being added. This guy is
adding a minimal ratio of stuff.
this is only percentage, this is

199
00:20:38,750 --> 00:20:43,708
not an absolute values And it's
not removing anything else. I'm
not sure the guy is doing the

200
00:20:43,708 --> 00:20:50,083
work. It looks abandoned to me.
So it might not be a good one to
actually keep using as you go

201
00:20:50,083 --> 00:20:56,083
forward. But not updating every
time does not mean it's bad,
right. So this is an example

202
00:20:58,750 --> 00:21:05,750
from outbound. Also you got
stuff moving up and down. You
got something adding or not. And

203
00:21:05,750 --> 00:21:13,125
as a rule of thumb if something
is being updated hourly or being
updated daily there's a lot of

204
00:21:13,125 --> 00:21:20,708
out related stuff going on there
and it's potentially getting
information from other sources

205
00:21:20,708 --> 00:21:27,708
as well. And it's being
presented to you with little or
no human interaction. If it's

206
00:21:27,708 --> 00:21:33,000
something that's more like
weekly or something like that,
maybe there's some people

207
00:21:33,000 --> 00:21:38,292
actually doing the work and
computing and everything. Of
course when I say all of this I

208
00:21:38,292 --> 00:21:42,875
mean specifically about open
source, right. If people are
getting paid to actually deliver

209
00:21:42,875 --> 00:21:48,375
this to you, they might as well
give me hourly. humanly created
feeds all the time otherwise i

210
00:21:48,375 --> 00:21:53,708
should not be paying for them at
least thats my opinion It's cool
because it can see patches. How

211
00:21:53,708 --> 00:21:59,625
malware domain list. and malware
domains they actually have a
huge spike in a specific day, If

212
00:21:59,625 --> 00:22:05,417
you guys are wondering that's
was right about the time we had
that no IP thing with Microsoft

213
00:22:05,417 --> 00:22:09,833
and people got to know, like, a
bunch of new domains and
everyone started sharing it. So

214
00:22:09,833 --> 00:22:17,208
you can actually see when stuff
happened in a way. It's kind of
cool. Anyway, do this test. Run

215
00:22:17,208 --> 00:22:22,625
this and see how much your feeds
are updating and see if yeah
does it sound right for the

216
00:22:22,625 --> 00:22:26,208
sizes of the company or for the
kind of data that your reading
that they are actually looking

217
00:22:26,208 --> 00:22:32,208
at it It is a lead indicator of
quality. It's not the last one.
We can talk about overlap,

218
00:22:36,167 --> 00:22:41,333
right. More data is better but
there's so much you can give
your hadoop vendor to actually

219
00:22:41,333 --> 00:22:48,083
store all the data. So let's try
to keep it only add data that is
not the same or it's useful. I

220
00:22:48,083 --> 00:22:54,750
mean, it's easy for me to say
that because I don't really
care. I do lot of summarization

221
00:22:54,750 --> 00:23:00,583
for people the way that i
consume threat intelligence some
people use the fact that

222
00:23:00,583 --> 00:23:07,958
something appeared in multiple
feeds as a quality issue. A
bunch of people read it. They

223
00:23:07,958 --> 00:23:13,625
might not have all done the
research. Or just want to leave
it out there. But I don't know.

224
00:23:13,625 --> 00:23:19,708
I honestly don't know. It's just
that you have to make sure what
you are looking for. So when you

225
00:23:19,708 --> 00:23:25,917
look at inbound you get stuff
like this. So the brighter the
square there's more overlap

226
00:23:25,917 --> 00:23:31,417
between those specific feeds.
And this was a specific day in
time. And you can rerun this

227
00:23:31,417 --> 00:23:38,083
test for all the 30 days that I
have on the data set. And you
can take your conclusions about,

228
00:23:38,083 --> 00:23:43,083
I mean, who is potentially
drawing this information from
the same kind of honey pod or

229
00:23:43,083 --> 00:23:48,500
some kind of research, right? I
have no idea what's going on in
the sense that this guy did

230
00:23:48,500 --> 00:23:54,000
that. And honestly I don't
really care. I just want to make
sure that if you are ingesting

231
00:23:54,000 --> 00:23:59,750
this and if you are working with
this you are not just, like, oh
yeah I got two minute indicators

232
00:23:59,750 --> 00:24:05,167
here. All the IP addresses in
the world. But it's, like, yeah
a bunch of duplicates and that's

233
00:24:05,167 --> 00:24:10,958
not really helping your bottom
line. Something that was
actually I found was very

234
00:24:10,958 --> 00:24:17,333
interesting and it actually
relates to information I heard
privately. Is that when you look

235
00:24:17,333 --> 00:24:25,042
at outbound, there's much,
significantly less overlap,
right. So it seems that peoples

236
00:24:25,042 --> 00:24:30,625
aren't doing their research or
work on some specific issues.
And specifically some people

237
00:24:30,625 --> 00:24:38,167
they will specialize in specific
threat. Oh yeah I'm specific
whatever hunter. And but okay.

238
00:24:38,167 --> 00:24:45,458
Sorry. And what we get here is a
little bit of the domain only
you do get a little bit of

239
00:24:45,458 --> 00:24:52,542
overlap. I just wanted to point
out that specific day that we
had that spike. On that day

240
00:24:52,542 --> 00:24:58,542
there was actually a 25 percent
of overlap of potential
indicators between malware

241
00:25:05,750 --> 00:25:11,750
domains and malware domain
lists. Because they all updated
quickly to add all that

242
00:25:14,917 --> 00:25:18,792
information. Which is very good,
very positive. Then you see that
result also represented here,

243
00:25:18,792 --> 00:25:22,708
right. Because you can measure
the overlap those feeds have.
And also you can also from this

244
00:25:22,708 --> 00:25:27,500
graph you can very easily see
that a lot of the stuff that the
WCH guys put on their Zeus feed

245
00:25:27,500 --> 00:25:32,375
is also being used by alienvault
as well. Which also I think is
good. I know a lot of people who

246
00:25:32,375 --> 00:25:38,375
use it and a lot of people who
use WCH stuff. Anyway let's get
to something which is a little

247
00:25:52,625 --> 00:26:00,250
more interesting I think which
is the population test. And I
guess it's interesting and this

248
00:26:00,250 --> 00:26:06,833
is kind of a cornerstone of the
research that I started doing a
couple of years ago. Which is,

249
00:26:06,833 --> 00:26:12,125
you know, maybe, maybe stuff
isn't random, right. Maybe it's
not like maybe we can actually

250
00:26:12,125 --> 00:26:18,375
track. There's some sort of
likelihood that some specific
corners of the internet are more

251
00:26:18,375 --> 00:26:23,042
likely to be targeting you or
not. And all the different
information that you get are

252
00:26:23,042 --> 00:26:30,542
from the providers, they will
give you different information.
And there is some sort of

253
00:26:30,542 --> 00:26:37,875
alignment that I believe that
you should be trying to reach
when you are talking about here

254
00:26:37,875 --> 00:26:44,375
is my data, right. These are all
the IPs address that im
communicating to. Potentially

255
00:26:44,375 --> 00:26:49,958
the threats that I have, the
people who are targeting me or
the people who maybe have

256
00:26:49,958 --> 00:26:54,875
already reached me, that are
exfiltrating data they are
probably from that pool. It's

257
00:26:54,875 --> 00:27:00,500
not going to be like an IP
teleporting thing. I am not talk
about which type of animal web

258
00:27:00,500 --> 00:27:04,167
or from the from the zoo you
come from. I am talking about at
the end of the day does it

259
00:27:04,167 --> 00:27:10,167
really matter. But there has to
be a way that the data is being
exfiltrated the IP address is

260
00:27:10,167 --> 00:27:15,542
there. The guy who is out to get
you, who is potentially messing
around with your data is on that

261
00:27:15,542 --> 00:27:22,250
list. So why don't you try to
tailor the threat intelligence
and the research you are doing

262
00:27:22,250 --> 00:27:28,708
through the specific countries
ans ASNs that actually make more
sense to your data, right. So

263
00:27:28,708 --> 00:27:34,375
then we start doing some
comparisons and doing some
tests, right. And we've come up

264
00:27:34,375 --> 00:27:39,708
with some interesting things. I
specifically separated the
domain, the outbound and inbound

265
00:27:39,708 --> 00:27:46,375
stuff here. Of course on the
inbound China all the way,
right. And I can see some people

266
00:27:46,375 --> 00:27:54,292
smiling here. Yeah. And at least
in my perspective the actual
penetration of those kind of

267
00:27:54,292 --> 00:28:00,292
things are people who are doing
SSH scans or they have, like,
this three year old joomla or

268
00:28:03,083 --> 00:28:07,208
exploits they're running against
the whole internet. I don't
think those guys are really

269
00:28:07,208 --> 00:28:12,917
going to get in. I mean, if they
do you shouldn't be in this talk
you should be in, like, 101 or

270
00:28:12,917 --> 00:28:19,750
something. But the point I am
trying to make is when you start
looking at the outbound data

271
00:28:19,750 --> 00:28:26,083
it's not that different from it
is different from some but the
fact that China wasn't the first

272
00:28:26,083 --> 00:28:32,708
one and the first one was the
U.S. actually made me chuckle.
Actually, if you squint you can

273
00:28:32,708 --> 00:28:37,167
see that the actual proportion
and I'll get there. The actual
proportion of Chinese IP

274
00:28:37,167 --> 00:28:42,042
addresses which are actually
distributing malware is less
than the actual Chinese

275
00:28:42,042 --> 00:28:48,167
proportion of IP addresses on
the internet. So, I mean, maybe
they're less likely to be

276
00:28:48,167 --> 00:28:54,167
posting malware than other
countries which I think is kind
of funny. Anyway, you can play

277
00:28:56,292 --> 00:29:04,083
the same game with ASN, right.
And the prevalence of Google
there obviously startled me. At

278
00:29:04,083 --> 00:29:08,625
first I was looking at that and
was, like, okay this is a bunch
of punk domains. Everybody knows

279
00:29:08,625 --> 00:29:14,625
that. When this stuff, domain
names they are they're not being
active and used, like, they're

280
00:29:16,750 --> 00:29:21,417
changing their infrastructure.
Someone just took the BOTnet
down and put something else

281
00:29:21,417 --> 00:29:29,375
together. just spark it all like
8.8.8.8 or 1.1.1.1.1 or
something like that and those

282
00:29:29,375 --> 00:29:35,750
are all owned by Google. So at
any moment in time like a very
high percentage of your domain

283
00:29:35,750 --> 00:29:40,542
names from these open threat
intelligence feeds will be
pointing at Google. Be aware of

284
00:29:40,542 --> 00:29:47,958
that. But, even so, I don't
know. dont be evil and all that,
im with them The thing is I

285
00:29:47,958 --> 00:29:54,333
guess the point I'm trying to
make here is this kind of
population test, they can also

286
00:29:54,333 --> 00:30:01,042
help you to key weigh your
feeds. Right. I'll get to the
specific of that. I just wanted

287
00:30:01,042 --> 00:30:07,000
to show you the graphs and now
I'm going to get to the math.
I'm sorry about this. But the

288
00:30:07,000 --> 00:30:13,000
point is I don't like to squint,
right. So let's do some
statistical entrance testing.

289
00:30:15,000 --> 00:30:21,917
Let's compare the proportion,
right. So, if I know the exact
proportion of IP addresses on

290
00:30:21,917 --> 00:30:29,500
the US, right, just get any geo
IP database and make sure you
are, like, keeping with it, make

291
00:30:29,500 --> 00:30:37,292
sure it doesn't enrich in one
database and use another one we
can do an exact binomial test

292
00:30:37,292 --> 00:30:42,458
which would be okay assuming
that the I can just choose
randomly the IP addresses that

293
00:30:42,458 --> 00:30:48,750
are going to attack me, is that
consistent with how the IP
addresses are distributed? Even

294
00:30:48,750 --> 00:30:55,167
if I don't have the full
population, right, and I'm only
like comparing my sample of my

295
00:30:55,167 --> 00:30:59,833
data against the sample of the
threat intelligence feeds, I can
use something that's the

296
00:30:59,833 --> 00:31:05,333
chi-squared proportion test
which is similar to the
independence test. Which pretty

297
00:31:05,333 --> 00:31:11,292
much ask the questions these are
two different samples of stuff.
Do they look like they came from

298
00:31:11,292 --> 00:31:17,375
the same population, right. And
it's a little bit more fuzzy and
fidgety than the other one.

299
00:31:17,375 --> 00:31:22,208
That's why the other one is
called exact, right. But it's a
statistical tool that you may

300
00:31:22,208 --> 00:31:28,208
have. So I really wanted to get
an idea of our error measures. I
wanted to get confidence

301
00:31:28,208 --> 00:31:35,667
intervals and say it's something
along this line. But at least I
can tell you I'm messing it up

302
00:31:35,667 --> 00:31:40,500
here in this calculation but
this is pretty much how much I
am messing up. I can also use

303
00:31:40,500 --> 00:31:46,750
p-values. I personally apologize
to Alex Hutton for using P
values and not like doing some

304
00:31:46,750 --> 00:31:54,458
bayesian evil shit. But he said
it was okay. So I'm allowed to
do this. Some people have to

305
00:31:54,458 --> 00:32:01,542
clear it with their lawyers I
have to clear it with Alex. 	So
the point is, if we're doing

306
00:32:01,542 --> 00:32:06,958
p-values we're being very
conservative. So for the number
of tests we do, so what does

307
00:32:06,958 --> 00:32:12,125
that look like? we're assuming
95 percent because it's pretty
much what everybody does. If

308
00:32:12,125 --> 00:32:18,750
we're doing multiple tests we're
actually dividing our critical
value or the value that we use

309
00:32:18,750 --> 00:32:23,625
to oh there's something
interesting here by the number
of tests that we do. So what

310
00:32:23,625 --> 00:32:31,000
does that look like? It looks
like something like this. So I
have this I'm using this

311
00:32:31,000 --> 00:32:37,667
functionally extracts the
population from a threat intel
feed. It's all there. And I'm

312
00:32:37,667 --> 00:32:43,667
comparing it to my known MMGU
database. And lo and behold, it
seems that Thailand is a winner

313
00:32:49,417 --> 00:32:56,000
right now. Which maybe the
proportion is five percent more
than the number than their

314
00:32:56,000 --> 00:33:02,042
actual proportions on the IP
addresses there, right. Followed
closely by the US. Russia is

315
00:33:02,042 --> 00:33:08,000
there. I'll give you guys that.
But you should go to China.
China is the second least likely

316
00:33:08,000 --> 00:33:13,833
to be hosting something.in
comparison to the random
proportion, I don't know maybe

317
00:33:13,833 --> 00:33:18,375
it was not these feeds. Maybe
these feeds were not tracking
specific addresses for there.

318
00:33:18,375 --> 00:33:22,792
But that's not the point. The
point is if that's the data that
you have and the data we should

319
00:33:22,792 --> 00:33:28,208
be comparing, that's what you
should be analyzing. You want to
add something? You were just

320
00:33:28,208 --> 00:33:32,958
gasping. Did I say something
wrong? >> No you are good. You
are good. just keep presenting

321
00:33:32,958 --> 00:33:38,042
knowledge bombs >> Co-presenting
is hard. The guy is judging me
right beside me. I can't really

322
00:33:38,042 --> 00:33:44,042
see you because of the lights.
Like, why did I get into this?
If the feed value is higher than

323
00:33:47,333 --> 00:33:54,708
critical value which is the last
one here it's pretty much we
can't really say anything. It

324
00:33:54,708 --> 00:34:00,708
looks like it's on par with the
randomness that we would get. A
challenge we got when we reached

325
00:34:02,708 --> 00:34:09,667
this conclusion is that hold on,
I don't know what to call these
countries yet, right. Come on. I

326
00:34:09,667 --> 00:34:15,667
mean, we do not have, like, ugly
animal names for all of them. So
we propose a guide. So as you

327
00:34:17,833 --> 00:34:21,500
are trying to create your own
and you are creating your own
threat intelligence with those

328
00:34:21,500 --> 00:34:27,917
statistical techniques you can
actually call people and
actually view people to what you

329
00:34:27,917 --> 00:34:34,042
are doing. Just clarification.
Capybara. is like south south of
brazil and toucan is more like

330
00:34:34,042 --> 00:34:39,375
the amazon part, its very very
different hacker spirit animal
just be consious about that.

331
00:34:39,375 --> 00:34:42,583
Where are my Texas people?
(Applause) >> This is not an
exhaustive list. So feel free to

332
00:34:42,583 --> 00:34:46,375
tweet your own suggestions at
the hash tag of the talk. We got
to catch them all. Anyway, then

333
00:34:46,375 --> 00:34:52,375
we get to the not exact test.
And this is just a little thing
that I did trying to compare how

334
00:35:09,417 --> 00:35:15,417
this feed evolved and changed
from the 11th of July to the
12th of July. Those are the same

335
00:35:17,792 --> 00:35:24,208
feeds. What did change from the
one day to the next? You see a
bunch are pretty much the time

336
00:35:24,208 --> 00:35:30,208
on the bottom side. Thailand
again, there's actually a trend
from this information you are

337
00:35:30,208 --> 00:35:35,125
getting from your threat
intelligence feeds. That
Thailand is getting more likely

338
00:35:35,125 --> 00:35:40,958
to attack. Based only on the
data and geo location. So, if
you got I can see some of you

339
00:35:40,958 --> 00:35:45,792
guys have got, like, the brain
thing going on and that's
exactly what I'm hoping for.

340
00:35:45,792 --> 00:35:50,042
There's a lot of interesting
stuff and a lot of interesting
conclusions you can get from

341
00:35:50,042 --> 00:35:54,542
your own data. Not so much the
threat intelligence feeds also
trying to do something like

342
00:35:54,542 --> 00:35:59,708
this. While you are at it at the
animal thing, we do need some
for Thailand. Because they're

343
00:35:59,708 --> 00:36:07,708
everywhere on this presentation.
theyre obviously up to something
bad Tweet it. Tweet it. We can't

344
00:36:07,708 --> 00:36:15,000
really hear you. So then I
wanted I was bothered by this
Google thing right and I wanted

345
00:36:15,000 --> 00:36:19,917
to make sure that I could
understand if this is all
(inaudible) or something

346
00:36:19,917 --> 00:36:27,125
different. So I ran the same
test, the same exact proportion
test on the AS information as

347
00:36:27,125 --> 00:36:32,250
well as the population
information. And yeah Google's
like ten percent proportion

348
00:36:32,250 --> 00:36:39,792
increase. That's crazy. That's
too much. That's way, way too
much. And then, what? >>

349
00:36:39,792 --> 00:36:45,792
(Inaudible). >> Okay. Where is
he? What we get there is if you
actually look into the data you

350
00:36:51,208 --> 00:36:56,333
will find that maybe not so
much, maybe it's not just park
data, there's some cleaning that

351
00:36:56,333 --> 00:37:03,333
needs to be done. I am not the
biggest fan of chrome but I'm
pretty sure it's not malware so

352
00:37:03,333 --> 00:37:08,333
probably we shouldn't have
chrome.google.chrome in our list
but Its alright, it happens

353
00:37:08,333 --> 00:37:15,125
sometimes. You just got to be
sure if you are consuming this
you need to look out for

354
00:37:15,125 --> 00:37:20,750
information like this. And maybe
they can help you do a little
bit of triage because no one is

355
00:37:20,750 --> 00:37:25,625
going to look through the whole
thing all the time. I am talking
about a bunch of stuff and I

356
00:37:25,625 --> 00:37:31,625
talked about my data. What about
your data? How can you get your
data to use those? For that I'd

357
00:37:39,042 --> 00:37:45,250
like to invite back my good
friend Kyle Maxwell. (Applause)
>> Oh my God thank you Alex. So

358
00:37:45,250 --> 00:37:50,667
as you are pulling in these
feeds you want to be able to do
this yourself. You want on going

359
00:37:50,667 --> 00:37:55,625
data in addition to be able to
run these analyses for
yourselves you may have other

360
00:37:55,625 --> 00:37:59,083
uses for the data. In this case
we did a lot of the work for
you. But ongoing we need

361
00:37:59,083 --> 00:38:05,500
something to help you with that.
So what we did is we are
releasing this week a tool

362
00:38:05,500 --> 00:38:13,333
called combine. You can get it
right now. its a TPO ver. 3 And
what it is, it is a tool for

363
00:38:13,333 --> 00:38:19,500
harvesting and processing these
types of feeds. >> I just want
to point out at the ML sec

364
00:38:19,500 --> 00:38:25,333
project we're very serious about
our needle in a haystack joke.
so this is why this is a

365
00:38:25,333 --> 00:38:31,958
combined harvester I am not
implying, well maybe I am,
that's all hay. >> So there's a

366
00:38:31,958 --> 00:38:37,875
few different components to it.
reaper pulls it in We really,
really like this metaphor here.

367
00:38:37,875 --> 00:38:44,875
so we reap it in that just pulls
in the data directly, We'll
normalize it to a very simple

368
00:38:44,875 --> 00:38:52,250
data model. we do a little bit
of validation We throw out all
the RFC 19, 18 shit stuff like

369
00:38:52,250 --> 00:38:59,708
that. Do the AS numbers, the DNS
look up. We transform the data
into CSV or J song. We haven't

370
00:38:59,708 --> 00:39:05,708
released the SY box or sim for
splunk As this is an open source
project, help us help you. Feel

371
00:39:07,917 --> 00:39:13,000
free to submit full requests for
it. That's another output form
that you want. We're constantly

372
00:39:13,000 --> 00:39:19,917
trying to feed more data into
it. This can be your own data
sources. There's a number of

373
00:39:19,917 --> 00:39:25,917
tools to bring in. CSV,XML,
parsing HTML, what have you. We
have a number of feed sources

374
00:39:29,042 --> 00:39:35,417
bundled in in terms of the URLs.
We're not saying clearly based
on the last half hour that any

375
00:39:35,417 --> 00:39:40,417
of these feeds are good or bad
these are just the ones that we
have and we'll add more as time

376
00:39:40,417 --> 00:39:46,708
goes on. When we do the
enrichment, if you are not
familiar with the term think

377
00:39:46,708 --> 00:39:52,708
metadata and metadata
accessories. So we're pulling
the autonomous system and geo

378
00:39:55,250 --> 00:40:00,750
location only down to country
level from the maxline database.
We do DNS resolution from the

379
00:40:00,750 --> 00:40:06,958
far site passive DNS database.
That requires an AP IP. If you
have one fantastic. Plug it

380
00:40:06,958 --> 00:40:12,000
right in. If you don't. Ask them
for one. Tell them Alex Pinto
sent you and he'll get you

381
00:40:12,000 --> 00:40:18,000
hooked up. >> Alex, really good
folks at far sight can help you
out with that. Again, all of

382
00:40:22,125 --> 00:40:28,333
this is open source software.
This is not commercial. This is
not us trying to make a buck off

383
00:40:28,333 --> 00:40:33,625
these tools. This is, you know,
us trying to make thing as
little better and help you pull

384
00:40:33,625 --> 00:40:39,417
in these feeds and pull in your
own data as well. >> And,
honestly, I don't think that's

385
00:40:39,417 --> 00:40:45,417
where the cool stuff really is.
And I we had to build a lot of
this as we were building out the

386
00:40:47,750 --> 00:40:53,792
research we were doing for MLSec
project. We just figured out
yeah but this is very

387
00:40:53,792 --> 00:41:00,208
commoditized stuff. or at least
it should be very commoditized
stuff, So we want to make sure

388
00:41:00,208 --> 00:41:06,250
that we are replacing our stuff
our internal stuff is being
replaced by open source versions

389
00:41:06,250 --> 00:41:11,542
and we will continue to support
them as we actually need to use
them in dot coding and all of

390
00:41:11,542 --> 00:41:16,667
that. Talk to us about the
project if you are interested.
If you like the specific

391
00:41:16,667 --> 00:41:22,333
TIQ-test you want to test your
data against it. oh but i dont
wanna publish my feed We can

392
00:41:22,333 --> 00:41:28,583
totally help you out. Either you
setting up your own stuff to do
that or we can help you out and

393
00:41:28,583 --> 00:41:33,833
do the test for you, right. And
I just want to very quick
takeaways before we are kicked

394
00:41:33,833 --> 00:41:40,458
out. Look at your data. That's
all I'm asking, right. That's
all you should be doing right

395
00:41:40,458 --> 00:41:47,833
now. And I will try and as much
as I can to keep banging this
point forward and actually

396
00:41:47,833 --> 00:41:53,792
providing helpful tool that
people can use for that, right.
i Also feel very strongly about

397
00:41:53,792 --> 00:41:59,625
the asymmetry of information.
So, if people tell you something
is good, don't take their word

398
00:41:59,625 --> 00:42:05,375
for it. Just try it, right. Just
test it. And make sure that it's
appropriate for what you are

399
00:42:05,375 --> 00:42:11,000
doing. Anyway, if you just got
data lying around, you know, we
can pick it up for some

400
00:42:11,000 --> 00:42:17,292
exercise. We can play some
games. >> Think about, like,
data sitting like with dot

401
00:42:17,292 --> 00:42:23,292
sitting. We can totally do some
data sitting for you guys.
Anyway, thank you very much.

402
00:42:33,375 --> 00:42:35,375
(Applause)

