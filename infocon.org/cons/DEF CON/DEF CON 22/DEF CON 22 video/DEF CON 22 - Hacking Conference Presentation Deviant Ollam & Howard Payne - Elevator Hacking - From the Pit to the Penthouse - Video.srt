1
00:00:00,000 --> 00:00:07,667
>>All right. DEF CON 22,
elevator hacking. I'm blown away
people are in here right now

2
00:00:07,667 --> 00:00:20,707
listening to us. >> [Applause] >> We love
you too. And we love that DEF CON
allowed us to do this, even

3
00:00:20,708 --> 00:00:26,667
though we were told it had to be
the last talk on the last day.
'Cause you know, breaking

4
00:00:26,667 --> 00:00:31,583
things. So why are we here? What
are we talking about? Why do we
do this? Some of you know me.

5
00:00:31,583 --> 00:00:37,750
I'm deviant. I own a pen testing
FRM. We break into buildings. We
do the physical side, many

6
00:00:37,750 --> 00:00:41,833
buildings, leverage their
elevators as part of the
security model. They should not

7
00:00:41,833 --> 00:00:48,573
do that. >> My name's Howard.
I'm not here representing pain
elevators despite the name. And

8
00:00:48,580 --> 00:00:57,040
I do have an employer who's
views and opinions I do not
express.   ‑ ‑ I drink bourbon,

9
00:00:57,040 --> 00:01:05,880
he drinks cheep beer. There are
a lot of thing that is can go
wrong with elevator hacking.

10
00:01:05,880 --> 00:01:11,500
>> Elevators are regarded as the
safest form of travel, based on
miles traveled. They virtually

11
00:01:11,500 --> 00:01:15,220
always work the way they're
expected to. Most people have
never been injured by an

12
00:01:15,220 --> 00:01:20,800
elevator. Probably entrapped but
not injured. Most injuries that 
happen are people who are 

13
00:01:20,805 --> 00:01:26,875
working in the mechanical
spaces such as the hoist way
or the shaftway, machine room. Pit.

14
00:01:26,875 --> 00:01:32,333
For guys like me. You can do
really bad things to yourself
with an elevator if you're a

15
00:01:32,333 --> 00:01:38,292
jack wagon. That leg was saved
though. >> Yeah this leg was
survived. Our concern is not

16
00:01:38,292 --> 00:01:42,892
that you're dumb enough to kill
yourselves, but that you're
going to break shit cause it's fun

17
00:01:49,000 --> 00:01:54,760
(Audio muffled) So yeah the
helicopter right? >> Escalator
helicopter, youtube. >> It's all

18
00:01:54,833 --> 00:02:04,292
fun until you cause a felony
criminal mischief. Thousands of
dollars in damage.

19
00:02:05,600 --> 00:02:14,240
Plus criminal penalties.
>> Don't do that. In
general, like you're going to

20
00:02:14,250 --> 00:02:18,583
look at elevators differently
after this talk. You're going to
spot little things in elevators.

21
00:02:18,583 --> 00:02:23,250
They'll tell you, if she doesn't
want to be touched don't touch
her. Leave it alone F. You don't

22
00:02:23,250 --> 00:02:30,740
know what something is, do not
turnkey, don't do it. We're
professionals. I'm just up here

23
00:02:30,740 --> 00:02:35,700
talking silly. The things you
see in this talk, we want you to
learn, we don't want you to try

24
00:02:35,708 --> 00:02:44,000
all of it unless you have a
really good scoping document
that legal prepared. >> So

25
00:02:44,000 --> 00:02:50,500
elevators broadly speaking fall
into two types of categories.
Some are hydraulic, piston

26
00:02:50,500 --> 00:02:58,960
driven from below. The other type
are traction. They are actually steel
cables. Traction elevator is usually

27
00:02:58,960 --> 00:03:02,700
propelled by a motor in the
motor room that's above the
cab and it's

28
00:03:02,700 --> 00:03:08,700
gaining traction on the ropes
and moving the cab and the
counterweight system. So

29
00:03:08,700 --> 00:03:14,700
elevators generally ride on two
rails with guide rollers like
this that you're seeing in this

30
00:03:14,700 --> 00:03:18,658
slide. They're not anchored in.
Sometimes you'll see shoes
instead of rollers like this

31
00:03:18,660 --> 00:03:27,800
but the principle is the
elevator is just guided up and
down on these rails. The lifting

32
00:03:27,800 --> 00:03:33,833
mechanism is just doing the
work, this is just the way it's
guided smoothly. Just think of

33
00:03:33,833 --> 00:03:38,542
it as sliding up and down a
track. Most people in this room,
their interaction to elevators

34
00:03:38,542 --> 00:03:47,662
is fixtures. Like you see here.
Left is a car operating
panel. When you push a button,

35
00:03:47,667 --> 00:03:51,917
you're doing what's registering
a cab call. You're telling the
elevator exactly where you

36
00:03:51,917 --> 00:03:57,125
want to go. Opposed to when
you're in a hallway, you press
the up and down button. You're

37
00:03:57,125 --> 00:04:00,700
registering a directional command
but you're not actually telling the
elevator where to go. That's

38
00:04:00,700 --> 00:04:07,160
called a hall call. There's
direction indicators that keep
you from being a jack wagon  ‑ ‑

39
00:04:07,167 --> 00:04:13,500
  ‑ ‑ please don't do that.
>> But again, all the power is
coming from the motor room above

40
00:04:13,500 --> 00:04:21,833
or below. So what you're seeing
here is gear lifts tractions. I
believe these are DC powered.

41
00:04:21,833 --> 00:04:27,733
They are usually used in higher
rised buildings to achieve the
speed that's necessary to travel

42
00:04:27,740 --> 00:04:33,460
effectively inside a high‑ rise.
On the other end of a spectrum,
you'll see motors that look like

43
00:04:33,460 --> 00:04:38,780
this. This is hydraulic. This is
a very simple system. There's a
programmer on the right side and

44
00:04:38,780 --> 00:04:44,980
there's a hydraulic pump which
lift it is elevators, you're
never going to see hydros taller

45
00:04:44,980 --> 00:04:55,900
than eight stories. >> No that
was actually a Dover hydraulic
HIGH (indiscernible). >> So he

46
00:04:55,900 --> 00:05:02,792
mention it had controller on the
wall. This is the brain of the
entire unit. So what you're

47
00:05:02,792 --> 00:05:07,072
going to learn throughout this
talk is elevators have
varieties of sensors that  ‑ ‑  

48
00:05:07,080 --> 00:05:12,760
provide input such as things
about its current velocity, current
position, doors open or closed.

49
00:05:12,760 --> 00:05:18,600
A myriad of things. Those inputs
all feedback to the controller
and the controller makes decisions--

50
00:05:18,600 --> 00:05:24,420
should I be driving the door
motor. Should I be driving hoist
motor up and down. >> We know

51
00:05:24,420 --> 00:05:31,480
we're talking really fast and
we're better speakers than this
but we want to get to all this stuff

52
00:05:31,480 --> 00:05:36,432
we're chattering through. The if
you're (indiscernible) and you
want to learn this stuff,

53
00:05:36,440 --> 00:05:40,960
download the slides later. But
we want to show you keys and
stuff. So one. >> One of the

54
00:05:40,960 --> 00:05:46,958
most primitive forms of input is
the limit switch. That's the top
and bottom of the voice wagon.

55
00:05:46,958 --> 00:05:53,738
And they're there to indicate
when the elevator is reaching
the end of its rung. The fourth

56
00:05:53,740 --> 00:06:02,120
roller mounted on that. As the
elevator is approaching the |top
floor, it'll trip the first slow

57
00:06:02,120 --> 00:06:07,920
down  ‑ ‑   ‑ ‑ the Ped speed of
the motor until it hit that is
third one, which is called the

58
00:06:07,920 --> 00:06:12,333
normal limit. When the
elevator's on the normal limit,
it's levelled on the |top floor.

59
00:06:12,340 --> 00:06:18,917
So now you're probably wondering
(speaking simultaneously).
>> That's to basically indicate

60
00:06:18,917 --> 00:06:23,837
when the elevator's about to run
off the rails. There's literally
New Orleans for it to go.

61
00:06:24,540 --> 00:06:30,160
>> Yeah if if the elevator hit
that, it's not an easy fix.
Although we saw people trying to

62
00:06:30,167 --> 00:06:43,833
do that in a mall. >> This is a
device that's called a motor
encoder. It also spins the

63
00:06:43,833 --> 00:06:49,750
indicator of the motor encoder
which allows the encoder to 
revolutions it's made in a

64
00:06:49,750 --> 00:06:55,083
certain amount of time. It will
then be able to determine how
fast it should travel. It'll

65
00:06:55,083 --> 00:07:00,958
match it up with other types of
information. Such as. >> The
position indicator, the elevator

66
00:07:00,958 --> 00:07:06,125
on the hoist way is magnetically
or on the means actually telling
where it is on the hoist way.

67
00:07:06,125 --> 00:07:13,760
It's a really funny freak out of
where it happens. If the
elevator gets lost  ‑ ‑ relearn

68
00:07:13,760 --> 00:07:18,500
where it went wrong so if you've
ever been in an elevator that
didn't go you were going. And

69
00:07:18,500 --> 00:07:24,740
went all the way up and down.
And you're like okay, it was
not, it didn't match up with

70
00:07:24,740 --> 00:07:29,620
what the controller thought. So
all these inputs come together
and if the inputs don't match,

71
00:07:29,625 --> 00:07:35,208
if the elevator panics, it'll
hit the breaks and all kinds of
things. So there are driving

72
00:07:35,208 --> 00:07:40,000
machine breaks which is sort of
the normal breaks that when the
elevator is at rest, the breaks

73
00:07:40,000 --> 00:07:44,667
will be applied. When the
elevator's moving, the breaks
will be dropped. There are other

74
00:07:44,667 --> 00:07:50,583
types of breaks. The safety.
People probably heard a elevator
can't free fall. That's

75
00:07:50,583 --> 00:07:55,542
generally true. Devices like
this on the left, it's something
called a governor. And it's a

76
00:07:55,542 --> 00:08:00,542
centrifugal device as the
elevator speeds up, that fly
wheel will spin faster and

77
00:08:00,542 --> 00:08:06,833
faster and eventually jaws will
fly out and trip and grab the
governor rope. That will stop

78
00:08:06,833 --> 00:08:14,753
the car. The device on the right is
called a rope gripper. It prevents
unexpected upward movement.

79
00:08:14,760 --> 00:08:20,120
People are afraid the elevator's
free fall you should be afraid
that it falls up. Because the

80
00:08:20,125 --> 00:08:28,665
counterweight  ‑ ‑ >> And didn't
stop and it crashed into the
over head. >> Yes, I believe it

81
00:08:28,667 --> 00:08:37,480
was from Chile This would
have stopped that. Chile. >> Is
understand that these mechanisms

82
00:08:37,480 --> 00:08:42,417
are easy to really just figure
out. You can see how they work
and you can see that they're

83
00:08:42,417 --> 00:08:48,167
really safe. This is a demo of
one of the rail gripper safety
mechanism. This is what made

84
00:08:48,167 --> 00:08:56,387
Elijah Graves Otis famous. If the
ropes are cut the elevator won't
plummet into free fall and this

85
00:08:56,387 --> 00:09:03,500
not on an American show, on
British TV, this man is hoisted
very very high and cutting rope.

86
00:09:03,500 --> 00:09:11,540
This man doesn't fall. The cab is fine.
Yeah. And that was a demo that
Otis would do at world fairs.

87
00:09:11,542 --> 00:09:15,458
Because until he came along,
elevatorses were unsafe. But
nowadays they're very, very

88
00:09:15,458 --> 00:09:21,750
safe. >> The principle behind
the elevator existed the last
2000  years. But there was no

89
00:09:21,750 --> 00:09:28,917
way to be safe. >> Your modern
system that you saw earlier with
the governor and such is, there

90
00:09:28,917 --> 00:09:34,833
are separate ropes as we called
them. There are metal cables.
There are separate roping

91
00:09:34,833 --> 00:09:40,113
systems traveling with
the car at all times, if that
governor jams and grabs, it'll

92
00:09:40,120 --> 00:09:46,740
pull up on breaking gripper
levels and plant levers. There's
all kinds of break shoes that

93
00:09:46,740 --> 00:09:55,620
keep you from dying If all else
fails, the pit has buffers in it
too. And the breaks don't work,

94
00:09:55,625 --> 00:10:00,125
if you're sliding through the
breaks, the pit will have spring
or oil piston buffers designed

95
00:10:00,125 --> 00:10:05,917
to absorb the full weight of
the car at full travel speed.
>> You probably won't die, very

96
00:10:05,917 --> 00:10:14,577
seriously injured, but you won't
die. >> Yeah you'll be back next
year. So elevators do the job

97
00:10:14,580 --> 00:10:21,620
really well on that mode if
you're riding in the elevator.
If you're not, this is where

98
00:10:21,625 --> 00:10:27,625
elevators get unsafe. When
you're riding like a
(indiscernible) in the car.

99
00:10:34,042 --> 00:10:40,042
>> Turn that light on.
(Inaudible) 

100
00:10:41,420 --> 00:10:46,960
(Tense music)

101
00:10:51,000 --> 00:10:55,080
People used to call it elevator
surfing. >> 

102
00:10:57,580 --> 00:11:03,160
(Screaming, ringing bell)

103
00:11:07,792 --> 00:11:12,417
that is a way elevator
mechanics have been fatally
injured in the past. We're not

104
00:11:12,417 --> 00:11:18,542
kidding. Don't do this. >> But
in you're in the car on
automatic operation, the

105
00:11:18,542 --> 00:11:22,292
elevator's going to keep you
very safe. Would you like to
learn about nonautomatic

106
00:11:22,292 --> 00:11:30,572
application? >>  (Applause.)
>> The most common thing I use
as a pen tester on jobs [S] flip

107
00:11:30,583 --> 00:11:35,875
an elevator out of group service
and into independent service.
When you register a hall call

108
00:11:35,875 --> 00:11:40,083
and you have a bank of
elevators, they don't all come
to your floor. The controller

109
00:11:40,083 --> 00:11:45,958
chooses one and dispatches that
to you because they're in group
operation. If you take that

110
00:11:45,958 --> 00:11:51,818
elevator up, the controller
knows I can't use that for a
while. An elevator in

111
00:11:51,820 --> 00:11:56,620
independent service as we see in
independent key switch here,
sometimes they're toggle

112
00:11:56,625 --> 00:12:02,250
switches hidden behind panels.
There's a lot of hidden panels.
If you flip to independent

113
00:12:02,250 --> 00:12:08,700
service mode, the elevator
becomes yours. It ignores all
the hall calls everything but

114
00:12:08,700 --> 00:12:18,040
what we're telling it. That
includes opening the doors if
you drive to a floor, you have

115
00:12:18,040 --> 00:12:25,875
to manually say, open door, or
close door. I have hidden in
target buildings for hours just

116
00:12:25,875 --> 00:12:29,417
on independent service because
it's not going anywhere. People
could call the elevators all

117
00:12:29,417 --> 00:12:36,583
day. No one ever notices how
come elevator passenger seven
hadn't been responding. No, you

118
00:12:36,583 --> 00:12:42,667
just get on the first one you
come to. If I wield an office
chair in an elevator once and

119
00:12:42,667 --> 00:12:47,367
sat there and waiting until
everybody went home. And we
rocked house all over data

120
00:12:47,367 --> 00:12:54,833
center. >> [Laugther] >> So yeah,
independent service is really useful if
you're a pen tester. Because it

121
00:12:54,833 --> 00:12:59,125
takes the elevator completely
out of the group and gives it
just to you. It becomes your

122
00:12:59,125 --> 00:13:04,708
elevator. So there's a
similar mode called
attendance service and it has

123
00:13:04,708 --> 00:13:10,958
its root in the history. Where
there actually was an attendant
who would drive the cab up or

124
00:13:10,958 --> 00:13:17,858
down using a hand crank like
here. So on an automatic system,
you'd see something like this

125
00:13:17,860 --> 00:13:22,458
behind a lock panel. There are
up and down controls to allow
the attendant to signal that the

126
00:13:22,460 --> 00:13:29,083
wants to reverse direction.
So they might have a cab full of
people or VIP and they decide

127
00:13:29,083 --> 00:13:34,917
let's stop collecting all the
calls in this direction and get
these people wherever they need

128
00:13:34,917 --> 00:13:40,417
to go. And then that bypass
button, sometimes it's called
the nonstop button, that allows

129
00:13:40,417 --> 00:13:46,375
the attendant to continue in the
same direction with the phone
car and skip all the calls. When

130
00:13:46,375 --> 00:13:54,000
he's done, all of those hall
calls are still registered. So
eventually it'll pick up those

131
00:13:54,000 --> 00:13:59,580
passengers that are waiting.
It's just a wait to signal that
the cab is full or whatever.

132
00:13:59,580 --> 00:14:04,375
>> It's like the close door hack
which doesn't fuck]ing work. So
everyone should stop repeating

133
00:14:04,375 --> 00:14:11,792
that all the time. >> Except
there's that one kind of. >>Ask
us about like, ask us about

134
00:14:11,792 --> 00:14:17,250
really logic controllers which
how. >> We think the origin of
that was independent. Somebody

135
00:14:17,250 --> 00:14:23,583
saw an elevator where the
operator was holding door close
to 'cause you have to on

136
00:14:23,583 --> 00:14:28,543
independent mode. And it's like
oh wow, you see what that guy
did? I'll do that later? No you

137
00:14:28,543 --> 00:14:33,603
won't. Unless you have a key
switch. What if you don't want
to have a high priority service

138
00:14:33,603 --> 00:14:41,300
but don't want to hire someone
to stand there >> So there are
two types of priority services.

139
00:14:41,300 --> 00:14:46,640
One is called express priority
mode, the other is executive
priority mode. We mentioned

140
00:14:46,640 --> 00:14:51,940
elevators will pick up calls
and demand in the same
direction it is already traveling.

141
00:14:51,940 --> 00:14:58,600
If there are passengers going
up they're going to collect every
up call on the way up as it goes.

142
00:14:58,600 --> 00:15:05,080
When it reaches the end it will
reverse direction. In this case
a user may have a key or badge

143
00:15:05,080 --> 00:15:12,500
to signal they are more important
than regular people. The difference
between the modes, one will actually

144
00:15:12,500 --> 00:15:18,840
reverse the direction the cab is
traveling to serve that person.
>> And what happens when VIP is

145
00:15:18,840 --> 00:15:25,640
served? >> In particular, it's
funny if you ever see this used 
‑ ‑ going up going down. And if

146
00:15:25,700 --> 00:15:31,840
an executive puts their key in,
it says this elevator is needed
for other reasons. Please exit

147
00:15:31,840 --> 00:15:39,420
the door immediately upon
opening. And it kicks you out of
the elevator. >> Maybe if you're

148
00:15:39,420 --> 00:15:45,417
the type of person whose seen
interesting communities and
their beliefs and other things,

149
00:15:45,417 --> 00:15:54,037
your maybe familiar with Sabbath
mode. Or you saw a movie with
bill March religiously. It is

150
00:15:54,040 --> 00:16:00,040
for people who believe they're
not allowed to interact with
certain systems which toggles

151
00:16:00,042 --> 00:16:08,000
Sabbath mode let's people get
around the billing by driving
all the way to the top floor and

152
00:16:08,000 --> 00:16:15,875
platforming automatically on
every single floor on the way
down. It's kind of like hacking

153
00:16:15,875 --> 00:16:24,195
god I guess. Ah, I found a
loophole in scripture. So I'm
smarter than you. So that's

154
00:16:24,200 --> 00:16:33,020
Sabbath service. A lot of other
there's a Sabbath mode there.
Ask us later about why it

155
00:16:33,020 --> 00:16:36,540
doesn't exactly do what some
people think it does. And SAB
some religious colors need to

156
00:16:36,542 --> 00:16:42,542
double check their notes.
Collars. Load by pass. Holy
shit. Elevators know how heavy

157
00:16:46,000 --> 00:16:52,875
they are. You put too much shit
in the elevator once and they
beeped at you and got angry.

158
00:16:52,875 --> 00:16:59,208
They can use that data to say
hum, I'm collecting all these
calls and I'm pretty full. I

159
00:16:59,208 --> 00:17:03,167
should not fucking stop at a
bunch of other floors right now
because it's going to be a bunch

160
00:17:03,167 --> 00:17:11,417
of this. Sorry no room. Sorry no
room. For like five more floors.
Yeah. Hope if you come to like

161
00:17:11,417 --> 00:17:17,167
the hope in New York, why this
isn't enabled more often is
beyond me. Why antinuance is not

162
00:17:17,167 --> 00:17:24,708
enabled. If you're a frickin'
derby bush and like the press
all buttons  ‑ ‑ >> More calls.

163
00:17:24,708 --> 00:17:33,580
Keep going. Wait hold on. Boom,
done. (Laughing) that's amazing
keep recording it. So we're

164
00:17:33,580 --> 00:17:41,700
going down, one to 23 and boom.
Out. It's like they know we're
here. >> Yeah that's called

165
00:17:41,708 --> 00:17:46,542
antinuance mode. There's peak
programming if you're a building
with workers come in the

166
00:17:46,542 --> 00:17:53,260
morning. Check out in a certain
hour. There's all kind of
optimization that you can do and

167
00:17:53,260 --> 00:17:58,540
that's something a confident
elevator consultant can do for
you. There's also if you want to

168
00:17:58,540 --> 00:18:02,700
have like extra special
considerations when people
shouldn't be coming and going.

169
00:18:02,708 --> 00:18:11,600
>> I saw a mode at museum and it
was called riot mode. I thought
what the heck is this. The

170
00:18:11,600 --> 00:18:17,792
building owners wanted a way,
they could lock the ground floor
out of the elevator system but

171
00:18:17,792 --> 00:18:23,625
still use it to access the other
floors. So again, somebody in
the security room would hit a

172
00:18:23,625 --> 00:18:31,083
button and say oh gosh, there's
a riot happening outside.
>> Occupy Tulsa. >> So it

173
00:18:31,083 --> 00:18:34,923
would just stop responding to
the ground floor because if
somebody was able to get in on

174
00:18:34,923 --> 00:18:40,580
the ground level, they could get
on an elevator and do bad
things. >> The basic part of the

175
00:18:40,583 --> 00:18:50,680
riot mode, the elevators keep,
WOG on the rest. Why can't the
99  percent be happy with the

176
00:18:50,680 --> 00:18:58,200
scraps we give them. You don't
care you just can't go to the
lobby. So also decide SIFK

177
00:18:58,208 --> 00:19:04,708
unrest there's also seismic
unrest. And you may never have
seen this. Or you might live in

178
00:19:04,708 --> 00:19:09,042
southern California where
there's a little jewel on the
elevator sometimes that says

179
00:19:09,042 --> 00:19:16,958
seismic. It's going to cause an
earthquake when you push it. No,
there's this indicator that in an

180
00:19:16,958 --> 00:19:22,125
earthquake you should exit the cab as
soon as possible. So a lot of
tiles it's very simple

181
00:19:22,125 --> 00:19:26,792
mechanical that might be a
ring on a string as
you call it. There's a [metal

182
00:19:26,792 --> 00:19:31,667
cable running up ask down. And
if the cab starts swinging side
to side, that ring might come in

183
00:19:31,667 --> 00:19:37,167
contact completing a circuit
indicating to the controller
that unexpected lateral movement

184
00:19:37,167 --> 00:19:43,458
is occurring. It's the one kind
of emergency mode that might
actually take you up. So it's a

185
00:19:43,458 --> 00:19:47,875
little counterintuitive. But if
you think about it, what can
happen, one of the risks during

186
00:19:47,875 --> 00:19:53,750
an earthquake, if the cab or the
counterweight actually becomes
displaced from the rail that is

187
00:19:53,750 --> 00:19:59,667
Supposed to guiding it.
You got a 2,500, 3,000‑ pound 
>> (Inaudible) with you.

188
00:19:59,667 --> 00:20:04,875
>> Yeah, so it moves you away
from the counterweight. Even if
it moves you in the wrong direction.

189
00:20:04,875 --> 00:20:08,750
>> How many people maybe work in a
hospital or medical facility,
you may have seen code [blue

190
00:20:08,750 --> 00:20:14,770
service. Right on. That's
medical priority. Imagine the
highest VIP priority where a

191
00:20:14,770 --> 00:20:19,500
doctor or an emergency
personnel will use a key
and they will seize an elevator

192
00:20:19,500 --> 00:20:25,500
the closest one responds and it
becomes their elevator until the
key comes back down. Hospital

193
00:20:25,500 --> 00:20:35,292
also has code pink. It's baby
theft mode. If the baby gets moved
unauthorized, the elevators can

194
00:20:35,292 --> 00:20:39,875
basically turn into security
recall devices which is its own
mode that you can program

195
00:20:39,875 --> 00:20:44,833
independent of a hospital. It
turns the elevator into a man
trap. It'll deliver the person

196
00:20:44,833 --> 00:20:50,333
to a floor of your designation
And keep the doors
shut. Or it'll psych it will

197
00:20:50,340 --> 00:20:55,458
doors manually so they can't
hide. There's all kinds of
fascinating things you can do

198
00:20:55,458 --> 00:20:59,458
with elevator security and
there's other things people try
to do and we're going to shit

199
00:20:59,458 --> 00:21:04,458
all over that in a minute.
There's also just modes you see,
if you start looking into this,

200
00:21:04,458 --> 00:21:09,833
you'll see security service.
This is kind of a catch all key
switch. It doesn't always mean

201
00:21:09,833 --> 00:21:14,083
what you think. Like all the key
switches in this photo are
actually the same keyway.

202
00:21:14,083 --> 00:21:19,333
Look at one of them that the
security service looks beat to
hell. So I asked the desk at

203
00:21:19,333 --> 00:21:25,292
this hotel, hay, I work with
elevators, I'm curious, are you
having security incidents every

204
00:21:25,292 --> 00:21:32,042
frickin' day? And he's like no.
The maid use that to go to the
basement. Just 'cause use see

205
00:21:32,042 --> 00:21:38,542
something, it doesn't actually
do what you think it does. One
of the most misunderstood modes

206
00:21:38,542 --> 00:21:43,000
is firefighters emergency
operation. You're seeing here
two key switches that are

207
00:21:43,000 --> 00:21:48,667
instrumental in the use of an
elevator during a fire. When the
heat or smoke condition is

208
00:21:48,667 --> 00:21:54,640
detected by the buildings's fire
alarm system there are contact
that is  ‑ ‑   ‑ ‑ controller

209
00:21:54,640 --> 00:21:59,360
which indicates that there is
such a condition and that it's
no longer safe to run the

210
00:21:59,360 --> 00:22:05,320
elevators. You've probably seen
signs. They're supposed to be at
every landing. That say  ‑ ‑

211
00:22:05,320 --> 00:22:09,120
>> You shouldn't be able to. The
elevator should go away from you
and sit] in the lobby. It

212
00:22:09,125 --> 00:22:16,840
should. >> But the smokes and
heats  are near the landing so the 
building can be in fire down there, and

213
00:22:16,840 --> 00:22:21,940
the elevator over there is still
working SDWL but if the elevator
has platformed in the lobby, the

214
00:22:21,940 --> 00:22:27,875
firefighter can take control of
it. And they can drive it in the
building and in a very powerful

215
00:22:27,875 --> 00:22:34,583
way. >> Just to be clear, phase
one is when the smoke and heat
detecters go off. It brings the

216
00:22:34,583 --> 00:22:40,300
elevators down to the lobby or
some other designated floor  ‑ ‑
  ‑ ‑ once the car is on phase

217
00:22:40,300 --> 00:22:48,120
one, then they can go in and use
their key to activate phase two
which allows them to run the

218
00:22:48,120 --> 00:22:53,500
car. Over riding the fact that
this other is logged out.
>> Over riding is pretty much

219
00:22:53,500 --> 00:22:59,083
everything. You think
independent mode is powerful?
Firefighter phase is way more

220
00:22:59,083 --> 00:23:07,420
powerful. Fuck you, I'm a
firefighter. >> By code it has
to be disabling any security

221
00:23:07,420 --> 00:23:11,833
systems. So that firefighters
can get to the floor they need
to go to. So there's one more

222
00:23:11,833 --> 00:23:17,375
mode that's even more powerful
than this. In the elevator
world, who can ever be more

223
00:23:17,375 --> 00:23:23,458
important than a firefighter?
>> Us. (Laughing) . >> Yeah,
elevator guys right? . So

224
00:23:23,458 --> 00:23:28,718
hoistway inspection, if
you can take command of the
elevator and get into the hoist

225
00:23:28,720 --> 00:23:34,458
way, which is superfuck]ing
dangerous. If you don't know
what you're doing, don't god dam

226
00:23:34,458 --> 00:23:41,542
do this. If you do, there are
all kinds of controls in there,
you should not have anything to

227
00:23:41,542 --> 00:23:46,162
do with because you don't know
what they are. >> Exactly. >> Oh
my God, you'll see something

228
00:23:46,162 --> 00:23:50,833
about that later maybe. So
plenty of buildings, try to use
elevators adds part of their

229
00:23:50,833 --> 00:23:55,458
security model. Maybe you seen a
building where you can't
register a haul call. Or you

230
00:23:55,458 --> 00:24:02,792
have to use a key. Maybe there's
no haul buttons, there's only a
key switch. Maybe you've been in

231
00:24:02,792 --> 00:24:08,917
situations where a badge reader
is used or hotel key card is
used. So not being able to make

232
00:24:08,917 --> 00:24:13,875
the elevator come to you and you
can drive it layer, we'll show
you an interesting trick about

233
00:24:13,875 --> 00:24:18,958
that. Maybe there have been
situations where you can get in
the elevator and certain floors

234
00:24:18,958 --> 00:24:23,958
are locked out. What kind of locks
are these? Anybody who's been in
the lock (inaudible).

235
00:24:25,980 --> 00:24:32,140
(Indiscernible) locks are shit
ones. Those are valid answers.
all the elevator key switches,

236
00:24:32,140 --> 00:24:35,792
almost all of them are way for
lock. Some of them are harder I
think. But you can pick them

237
00:24:35,792 --> 00:24:42,667
later if you want. This is not a
way for lock. That is a medical
lock. I'm very interested on

238
00:24:42,667 --> 00:24:48,458
floor seven. But anything like
lock outs or badge systems,
these are common ways that

239
00:24:48,458 --> 00:24:53,708
people try to treat the elevator
as restricting your movement.
They try to say, oh you know,

240
00:24:53,708 --> 00:24:58,792
someone couldn't get to floor
seven or 20, or whatever unless
they have the right credential.

241
00:24:58,792 --> 00:25:04,875
Duck FAUK bunch of that. That's
not how you should think of your
elevator. You want to secure a

242
00:25:04,875 --> 00:25:10,292
elevator? This is what your
doing. What's going on here.
>> Sure. We had a job WOUN time

243
00:25:10,292 --> 00:25:18,412
in a facility and we came across
this. I said gee, THS a
interesting way to secure a

244
00:25:18,420 --> 00:25:24,417
hallway. (Indiscernible) this
key. Let's just show them. >> It
was a jail. It's a giant cage in

245
00:25:24,417 --> 00:25:31,125
front of the elevator. Unless
you're doing this, think of your
elevators as a stairwell. Think

246
00:25:31,125 --> 00:25:37,083
of them as a stair way where
lazy people don't use their
legs. Everything we just showed

247
00:25:37,083 --> 00:25:43,375
you we'll just shit all over it.
Remember there was no haul call
buttons, you can't get the

248
00:25:43,375 --> 00:25:50,667
elevator to show up, I use my
magic hack haxor
paper. Well what happened there?

249
00:25:50,667 --> 00:25:55,833
Well the elevator happened to be
at the floor, so somebody
tripped the safety inch. And

250
00:25:55,833 --> 00:25:59,893
it's a really smart idea to
stick things through the hoist
way doors. >> No it's not.

251
00:26:01,380 --> 00:26:07,375
>> And also to be clear, that's
not a universal trick. In fact
that's unusual it did work.

252
00:26:07,375 --> 00:26:11,625
Those sensors should have been
disabled when the doors were
closed. But this kid somewhere

253
00:26:11,625 --> 00:26:18,500
on YouTube happened to find out
that it worked. >> Most of what
we do most of what we're going

254
00:26:18,500 --> 00:26:23,000
to talk to you about over riding
systems just by using the key
SWECHs. There's key switches

255
00:26:23,000 --> 00:26:30,000
inside all  ‑ ‑ how many people
have seen panels in elevators
that pop open. Some of those

256
00:26:30,000 --> 00:26:37,900
panels are locked. None of you
would have ever picked this.
Interesting point, there's

257
00:26:37,900 --> 00:26:45,375
something call add slam panel.
It's like a spring loaded latch.
You can just. (Making noise.)

258
00:26:45,375 --> 00:26:51,500
And it'll pop open. But inside
the panels, you'll see like look
independent service that we told

259
00:26:51,500 --> 00:26:55,667
you about. Hoist way service,
you shouldn't touch it. Card
reader disabled. Let me turn I

260
00:26:55,667 --> 00:27:02,333
don't have my key, let me turn
off my that function. The
industry is oh washed in

261
00:27:02,333 --> 00:27:07,375
different key SWIFs and
different keys that you'll start
to see in the industry they call

262
00:27:07,375 --> 00:27:12,208
it graffiti. In the motor rooms
and car panels, you'll see notes
from elevator guys and gals.

263
00:27:15,360 --> 00:27:19,500
You'll start to think that keys
are really different all over
the place. And yes, there's a

264
00:27:19,500 --> 00:27:25,000
lot of keys. If you're on a pen
test job, you might try to look
for the elevator keys. Sometimes

265
00:27:25,000 --> 00:27:31,042
you just find them. But if
you're on a legislate elevator
job, what this man has done for

266
00:27:31,042 --> 00:27:43,292
years now is catalog every key
he's ever seen on every job ever
ever. As far as I know, Howard's

267
00:27:43,292 --> 00:27:48,583
the only one that has a
collection of every elevator key
he's found SXN he knows what it

268
00:27:48,583 --> 00:27:54,333
does. This is not Howard's key
collection by the way. This is
Howard's key collection. >> [Applause] >>

269
00:28:02,060 --> 00:28:10,260
might notice this is actually an
old photo. Every elevator  ‑ ‑
there's all different brands and

270
00:28:10,260 --> 00:28:15,917
fixtures. And you can just spot
them. >> So when you have the
experience to look at something

271
00:28:15,917 --> 00:28:22,557
and say ah, I've seen that on
another job or I've seen the
catalog or company's flyers and

272
00:28:22,560 --> 00:28:29,500
visited the trade shows. It's
all the same. They use the same
things everywhere. And that is

273
00:28:29,500 --> 00:28:34,667
one of the main points to take
away from this. If they sold you
a key switch, the buttons look

274
00:28:34,667 --> 00:28:43,320
alike and the key switches look
alike. The buttons looks alike,
hay my elevator uses Adams,

275
00:28:43,320 --> 00:28:52,620
guess what, your key probably
operates that other Adams
elevator. >> There's modernizing

276
00:28:52,620 --> 00:28:59,120
that happens. We're in the
Rio right? Dover impulsion. How
many people seen those buttons a

277
00:28:59,125 --> 00:29:06,560
million times. >> When I started
to try to learn this, I'm on
jobs, I'm like holy shit, I'm

278
00:29:06,560 --> 00:29:14,160
pretty sure I have ooh key for
this. What is it? I'm like I
don't know what it is. How thick

279
00:29:14,167 --> 00:29:19,708
is the halo. What font is  ‑ ‑
they all look the same to you
until you start learning it. And

280
00:29:19,708 --> 00:29:24,917
you can type the fixtures just
by glancing at them and you know
what keys (indiscernible).

281
00:29:24,917 --> 00:29:31,292
>> That's totally hell vet KA.
>> Yeah, epiKA. >> And the other
is innovation. >> It says it on

282
00:29:31,292 --> 00:29:38,708
the slide. >> Like an article
narrow I think. >> I could do
this to him all day. Now if you

283
00:29:38,708 --> 00:29:43,667
want your own elevator keys,
like people sell them online.
Many people probably shouldn't

284
00:29:43,667 --> 00:29:47,958
be and you probably shouldn't
buy them because they're ripping
you off. Like this key set is

285
00:29:47,958 --> 00:29:52,875
almost $9 a key. >> And its
actually has to ship USB ground
because the smoke isn't the

286
00:29:52,875 --> 00:29:59,750
picture is included. So it's  ‑
‑ I don't know what half these
things are to tell you the

287
00:29:59,750 --> 00:30:06,020
truth. They took an KOOEL guy
that retired 20  years ago and
copied every single one, because

288
00:30:06,020 --> 00:30:12,380
the fixtures these are used for
are completely dead and long
gone. >> These are the most

289
00:30:12,380 --> 00:30:18,120
popular ones you can find
online  ‑ ‑ you can get 17 of
them in the set. >> Don't get me

290
00:30:18,125 --> 00:30:24,125
wrong though. The vendor did two
nice things, they took clear
straight on photos of the keys.

291
00:30:26,917 --> 00:30:31,833
With the labels visible. And
they really took care to make
sure this was going to be

292
00:30:31,833 --> 00:30:36,750
comprehensive. This was really
perfect for your fire department
as long as your fire department

293
00:30:36,750 --> 00:30:42,583
simultaneously the state of
Massachusetts  ‑ ‑   ‑ ‑ South
Carolina and Arizona. So if.

294
00:30:42,583 --> 00:30:47,833
>> So if that's what your tricks
are rolling through, that's your
job. Rock out. >> What probably

295
00:30:47,833 --> 00:30:55,167
happened of course is the vendor
had a contact. And someone kept
handing them keys and say I've

296
00:30:55,167 --> 00:31:01,042
seen this work or this is a
buyer key and they've had, well
we better put it on our set.

297
00:31:01,042 --> 00:31:05,708
>> So when you buy keys online,
from shitty sources, you don't
know what you're getting

298
00:31:05,708 --> 00:31:10,208
exactly. You might be getting a
key that's speed run on a
duplicator that kind of has the

299
00:31:10,208 --> 00:31:18,388
right bittings vs. a coat cut
and original factory key  ‑ ‑
and going on elevator keys.com.

300
00:31:19,458 --> 00:31:23,292
Is anyone going to sell them in
this room. How many people are
going to try to call elevator

301
00:31:23,292 --> 00:31:30,292
keys now? >> Don't bother, read
the verification requirements
they will not sell to you unless

302
00:31:30,292 --> 00:31:37,875
you are legitimate personnel >> The
guy AS I can D. I tried on the
phone a lot. (Laughing) . But in

303
00:31:37,875 --> 00:31:43,333
general, this a industry way
behind the times on security. So
WHOOND of key switch is this on

304
00:31:43,340 --> 00:31:50,740
the floor too? What kind is it?
you've been to the village.
>> Tubular. >> What'd the guy

305
00:31:50,740 --> 00:31:55,333
tell you. >> This is a true
story and I swear, it was a
casino, and the building's

306
00:31:55,333 --> 00:32:00,708
architect was present at a
meeting, he happened to mention
he had a personal investment

307
00:32:00,708 --> 00:32:07,167
in selecting the switches on the elevator.
And he made a comment to the
effect of no one would ever be

308
00:32:07,167 --> 00:32:13,250
able to pick that. >> That's a
tubular lock. >> Right. >> 
(Laughing) so yeah, it's an

309
00:32:13,250 --> 00:32:17,917
industry where like someone says
so MEDCO is a great brand. We'll
get tons and tons of MEDCO key

310
00:32:17,920 --> 00:32:25,340
switches. I asked Howard and
said let me see those keys. And
then I grabbed bob ex. And I

311
00:32:25,360 --> 00:32:30,440
lined them all up. It's a
mastered system where half the
bittings aren't even mastered

312
00:32:30,440 --> 00:32:34,000
and the rest is just a huge
sample size I was able to
determine the master fitting. I

313
00:32:34,000 --> 00:32:39,560
had Howard once send me a
picture. And it's a Dover
system. Yeah, a Dover DEE R key,

314
00:32:39,560 --> 00:32:46,292
but look where I found it.
There's all kind of reuse in the
industry because you think your

315
00:32:46,292 --> 00:32:51,417
keys are unique, and it's just a
supplier calling a supplier
calling a warehouse and shipping

316
00:32:51,417 --> 00:32:57,977
them thousands of the same
cylinder. Stock locks.
Whatever's cheeper. You also

317
00:32:57,980 --> 00:33:06,200
have industries where they try
to start enable shit online. So
MCE, it's like, oh, our, we have

318
00:33:06,208 --> 00:33:10,960
this box that you're going to
see later. Yeah, it's hooked up
and you put it on your network

319
00:33:10,960 --> 00:33:20,360
make sure you can fix it. Add
an account called MCE support
make user account MCE support

320
00:33:20,360 --> 00:33:26,792
‑ just make it all for the same
password everywhere. Because we
need to get in. This is the MCE

321
00:33:26,792 --> 00:33:31,458
system that they need to get
into remotely. This is supposed
to be forward facing from your

322
00:33:31,458 --> 00:33:37,250
net work. This is up here  ‑ ‑  
‑ ‑ attached to the controller
so you can do all kinds of

323
00:33:37,250 --> 00:33:45,875
remote management. Is this the
kind of thing you think is smart
to be publicly facing with a

324
00:33:45,875 --> 00:33:51,375
user and password on the router
of your building called MCE
support where you can access

325
00:33:51,375 --> 00:33:55,917
these features remotely? Raise
your hand if that's a good idea.
>> In this room a lot of hands

326
00:33:55,917 --> 00:34:02,000
are going up because we want
that to be a good idea. >> But
it's cool, they paid for

327
00:34:02,000 --> 00:34:10,860
extended support for X[P].
(Laughing) . >> There's also
things like Otis elite service.

328
00:34:10,860 --> 00:34:17,440
>> As your building requirements
change, you can customize your
elevator's operation, with a

329
00:34:17,440 --> 00:34:24,120
simple telephone call to our
elite engineers. >> It won't be
a problem. I'm going to take

330
00:34:24,125 --> 00:34:29,292
elevator number two from the
bank. >> JOU don't have the
independent key switch, just

331
00:34:29,292 --> 00:34:36,125
call the company up. I'm totally
bob Jones. This is my building.
On star for elevators. Bluff

332
00:34:36,125 --> 00:34:43,875
your way, and I'm sure you get
the elevator to do things. It's
all remote management. You have

333
00:34:43,875 --> 00:34:51,395
like this in the industry. This
fire keys we showed you. They
tried to push for a uniform fire

334
00:34:51,400 --> 00:35:01,040
key. >> Does anybody know what
[F]DOK is in. [F]DOK one was the
key that was adopteded in the

335
00:35:01,040 --> 00:35:05,560
2007 of the ASME A17.1 Safety
Code for Elevators & Escalators

336
00:35:05,560 --> 00:35:09,160
‑ ‑ they
wanted to eliminate firefighters
having to fire around keys that

337
00:35:09,160 --> 00:35:16,100
were over priced and weighed
pounds, they said let's just
make one standard key. Only you

338
00:35:16,100 --> 00:35:21,400
can have it. >> Yup, only
elevator and emergency personnel
can use this. >> So let's just

339
00:35:21,400 --> 00:35:28,300
publish the bitting. >> yeah
let's put that in the code right
there. Smart. >> [Applause] >>

340
00:35:31,540 --> 00:35:34,580
This is the
kind of thing you see in the
industry. It's a industry that

341
00:35:34,583 --> 00:35:40,583
hasn't had any security
background pushing on any of
these topics. Not to mention

342
00:35:40,583 --> 00:35:46,183
it's all circuits at the end of the 
day. It's all naked on the inside.
If you pop open the panel

343
00:35:46,183 --> 00:35:52,523
or if the panels just aren't secured
why are you messing with key
switches? You could just bridge

344
00:35:52,523 --> 00:35:57,792
the contacts (multiple voices)

345
00:35:57,792 --> 00:36:05,832
swing panel opens up. It's
insane. It's not secure at all.
>> This is not secured either.

346
00:36:05,840 --> 00:36:12,640
What's happening? I'm not a
(indiscernible) speaker. This is
his first time on a stage at DEF

347
00:36:12,640 --> 00:36:18,640
CON. >> It's very, very quiet,
they're hunting newbs. How many
glasses are you (inaudible) oh

348
00:36:41,280 --> 00:36:47,380
why thank you. >> Who was here
at the handcuff talk where goons
raided the stage with ninja

349
00:36:47,380 --> 00:36:54,460
swords and piracy. And I think
we handcuffed DeCode to a railing
and Ray had to get him out of the

350
00:36:54,460 --> 00:37:01,160
cuffs. This is why  ‑ ‑ people
have to bitch that DEF CON's
changing. It's BlackHat now.

351
00:37:01,160 --> 00:37:08,860
And BlackHat's RSA. This doesn't
happen at BlackHat >> To our 
new speakers! >> [Applause] >>

352
00:37:15,700 --> 00:37:26,480
Thank you fellas. >> This is the final
the editions of shot the newb for
this year. So I'd like to thank

353
00:37:26,480 --> 00:37:34,080
my shot new colleagues. You guys
like this? Should we do it again
next year? (Applause.) >> Right

354
00:37:34,080 --> 00:37:42,360
on. >> (Inaudible) your timing.
>> There's no talk after us.
We'll just keep talking and

355
00:37:42,360 --> 00:37:52,100
answering questions all night if
we want. If you want to see fun
crazy, award ceremonies are

356
00:37:52,140 --> 00:37:57,380
happening right now where other
people are speaking for us. So
yeah, we'll hang out until hotel

357
00:37:57,380 --> 00:38:03,700
throws us out of here if you
have crazy elevator questions.
Badge systems AUSHLGS kind of

358
00:38:03,700 --> 00:38:08,720
the key cards right. People use
those in a lot of buildings.
There's a lot of attacks about

359
00:38:08,720 --> 00:38:17,300
key cards. That could be its own
entire talk. Cloning
credentials, fortunately it's

360
00:38:17,380 --> 00:38:25,080
already been another talk. Mad
STREK research and years ago  ‑
‑   ‑ ‑ and educational where

361
00:38:25,080 --> 00:38:31,100
that look at mad STREK madness.
Look at a lot of his approximate
card stuff. If you want to be

362
00:38:31,160 --> 00:38:36,940
kind of that cloning. Or be like
us, turn off the card reader and
use independent mode. In

363
00:38:38,200 --> 00:38:45,100
general, that's what pen testers
do. If you're going to break
into a building and leverage the

364
00:38:45,180 --> 00:38:52,880
elevators what are you doing?
We're optimizing his giant key
ring and just using it for pen

365
00:38:52,880 --> 00:38:58,960
testing. His key ring's cool,
but I sat around with Howard and
I actually just took all of his

366
00:38:58,960 --> 00:39:02,700
key  ‑ ‑ here's your giant
database and and here's your
list. I was like okay, screw

367
00:39:02,700 --> 00:39:08,800
lights and fans. I'm not going
to turn off the lights or make
out with someone. But I'm like,

368
00:39:08,820 --> 00:39:14,600
okay, give me independent
service and floor cut outs and
then we spread all these keys

369
00:39:14,660 --> 00:39:20,400
out. Group these into how common
they are. So we have collections
of keys that are like this is

370
00:39:20,460 --> 00:39:25,600
70  percent of America. This is
the other like 20  percent. This
you'll basically never see.

371
00:39:25,640 --> 00:39:31,600
This, I wouldn't even buy. But
I'm crazy so I did. So yeah, we
grouped these up and if you are

372
00:39:31,640 --> 00:39:35,900
in the industry, maybe you speak
to us later if you want some
independent service keys and

373
00:39:35,980 --> 00:39:41,600
shit like that. Maybe you want
some fire keys. You can fuck
right off. Legal told us we

374
00:39:41,620 --> 00:39:48,100
could not give you those unless
we have J a special training
which maybe we'll write some

375
00:39:48,140 --> 00:39:53,680
day. I promise we're going to do
that at some point. But here,
you want an example, we have to

376
00:39:53,680 --> 00:39:58,000
show  ‑ ‑ this is my favorite
client story ever regarding use
of key switches. There

377
00:39:58,040 --> 00:40:02,900
was a building, and this building
everyone went in through the
front and at the front there was

378
00:40:02,920 --> 00:40:08,300
a guard desk, they had to show
credentials and they had to badge
in blah blah blah. There was

379
00:40:08,300 --> 00:40:17,300
an elevator system and it
serviced the back entrance. They
said okay, this door, you'd need

380
00:40:17,300 --> 00:40:21,000
a badge or something to get in.
But no one really  ‑ ‑ everyone
just used it to park their car

381
00:40:21,000 --> 00:40:26,400
out back. And this elevator,
even if you were in that lobby
that, rear lobby, the elevator

382
00:40:26,440 --> 00:40:31,600
wouldn't go anywhere because you
kneed a badge. If you didn't
have a badge, they said there's

383
00:40:31,600 --> 00:40:36,180
no reason to have a guard back
here. No one could take this
elevator somewhere else. If you

384
00:40:36,180 --> 00:40:43,020
seize control of this elevator and 
drive it somewhere they didn't
expect and pop out on another floor

385
00:40:43,020 --> 00:40:47,600
  ‑ ‑ the culture of this office
environment such no one
questioned us once we were in.

386
00:40:47,600 --> 00:40:52,720
And when when he showed what
you're about to see to the
building own, you'll love their

387
00:40:52,720 --> 00:40:59,400
reaction. It blew their mind. So
here we are in the parking deck
he's carrying a camera and

388
00:40:59,400 --> 00:41:10,380
got the security footage. The
door's locked. Not very well.
But now this elevator, we could

389
00:41:10,380 --> 00:41:18,220
call it, but we couldn't do
anything with it unless we had
our keys. >> On on. >> Phase

390
00:41:18,220 --> 00:41:26,680
one, phase two. >> Yeah, now, we
did that a little fast. The
elevator controller got a little

391
00:41:26,680 --> 00:41:31,600
mad at the order in which we did
that. >> Got very mad. We broke
the elevator. >> Yeah, we had to

392
00:41:31,600 --> 00:41:38,520
fuss with it for a while before
we got it working again. But you
know, we got upstairs, so

393
00:41:38,520 --> 00:41:46,020
there's that. And then there you
are. You're upstairs you're
outside. And we showed this

394
00:41:46,020 --> 00:41:52,540
footage. The client was like
holy crap, how'd you get in we
trained in engineering. And we

395
00:41:52,540 --> 00:42:00,240
were like I socialed your
elevator bro. And the response
literally, that can't happen. We

396
00:42:00,250 --> 00:42:09,625
were told that elevator can't go
up.  >> (Laughing) >> we're like what'd
you just say? It's an elevator.

397
00:42:09,625 --> 00:42:19,292
It has one job. Elevators go up.
(Laughing). But yeah yeah, you
have keys, if you can take over

398
00:42:19,292 --> 00:42:25,872
the key switches, this is why it
was such a big to do in New York
when this gentleman on Ebay  ‑ ‑

399
00:42:25,880 --> 00:42:30,417
most of these keys are old and
dusted any way, but this guy was
selling keys and the New York

400
00:42:30,417 --> 00:42:37,077
Post wanted to make a sky is
falling out of it. And a geting
a camera shoved in his face.

401
00:42:37,080 --> 00:42:42,580
Like oh my God you're selling
keys to the terrorists and then
they print a you a fucking

402
00:42:42,583 --> 00:42:50,700
article sh\owing the keys. And we
were like no we were told you
can't copy those keys.

403
00:42:50,700 --> 00:42:56,700
>> (Inaudible) all of those.
Exactly. So but the, in general,
yeah, these are like shitty

404
00:42:56,708 --> 00:43:02,583
bullshit bad versions of the
photos. Here's a nice photo of
that key. And you'll learn why

405
00:43:02,583 --> 00:43:07,042
it was not a security breech
that this is the New York City
key. This is like thee can that

406
00:43:07,042 --> 00:43:13,582
got all the curfuffle. It's called
the 2642 key. It's a Yale. It's an
unrestricted blank. Do you know why

407
00:43:13,582 --> 00:43:21,120
it's called that? the bitting code
is 2642. >> [Laughter] >>
And it's not really,

408
00:43:21,120 --> 00:43:27,120
because the first position isn't
used. So yeah, like you saw this
and filed it in an office blank

409
00:43:27,120 --> 00:43:32,460
and we were able to do that in
New York and things. Now that's
just one city. It's not like

410
00:43:32,460 --> 00:43:38,792
an entire three state region
would use another key. That's
also an unrestricted blank. And

411
00:43:38,792 --> 00:43:45,667
that also has a really easy code
to decode. We're just going to
drop a lot of FRIKing keys on

412
00:43:45,667 --> 00:43:54,000
you right now. We're going to
get through these slides fast.
>> I'm going to take this slide

413
00:43:54,000 --> 00:43:59,740
because there's an amazing story
behind this. I was buying keys
to make my key ring as complete

414
00:43:59,740 --> 00:44:05,490
as possible. And I came across
something very unusual. I was
purchasing some time for locks

415
00:44:05,500 --> 00:44:10,040
with a key. I found that was
easier to do. Sometimes people
would ask questions a little bit

416
00:44:10,040 --> 00:44:15,080
less. Ordering one key in
general  ‑ ‑ so I was sometimes
just buying the lock with the

417
00:44:15,083 --> 00:44:22,292
key. So in one case, I bought a
lock box. Like we're seeing right
here. One of these little red

418
00:44:22,292 --> 00:44:29,125
lock boxes. And the key  ‑ ‑ the
cylinder on the front is
operated by this exact key that

419
00:44:29,125 --> 00:44:35,167
you're seeing here. And I
ordered another one, it was
state of Tennessee key. It was

420
00:44:35,167 --> 00:44:39,458
keyed to the state of Tennessee.
Except it didn't come with
the key. I looked at ate and

421
00:44:39,458 --> 00:44:47,238
said it's just a flat key. And
it's open. Right? So how old is
this key? >> Probably like a

422
00:44:47,240 --> 00:44:51,620
hundred‑ year‑ old. >> This is
made by a company called game
well that made those fire

423
00:44:51,625 --> 00:44:56,458
boxes that you pull on the
street before everybody had
telephones and the firefighters

424
00:44:56,458 --> 00:45:03,978
would come and reset the boxes.
Somebody somewhere said let's
reuse the key. Here's the story.

425
00:45:03,980 --> 00:45:08,040
I called up the company and who
sold me the key box. I said wait
a minute you sold my one with T

426
00:45:08,042 --> 00:45:15,708
the key and  ‑ ‑ that's because
you asked for the Tennessee box.
They couldn't sell him  ‑ ‑ if

427
00:45:15,708 --> 00:45:20,583
you called and said I need the
Tennessee key, sorry you're not
authorized. I'm sorry, I had

428
00:45:20,583 --> 00:45:27,980
something crazy in my ear, I
need the game well Christmas
tree key. No problem. How about

429
00:45:27,980 --> 00:45:35,240
if you live in Indiana show of
hands. Anybody? You have good
gun laws. You don't have good

430
00:45:35,250 --> 00:45:41,167
fire service keys though  ‑ ‑
tubular keys. We couldn't buy
the key, we could pick the lock

431
00:45:41,167 --> 00:45:45,542
box that's siting up here after
we picked it. We measured the
bidding. Used a little HURDdy

432
00:45:45,542 --> 00:45:54,260
GURdy chop chop. We made a key.
It's open. There's your frickin'
Indiana key. Some states aren't

433
00:45:54,260 --> 00:46:00,320
using systems that are quite so
unrestricted. Kentucky. How many
people go to Derbycon. I should 

434
00:46:00,330 --> 00:46:08,800
see more hands. Derbycon
is great event >> [Applause] >>
Kentucky. Their keyboxes use

435
00:46:08,800 --> 00:46:14,120
use a MEDCO key. It's a classic,
but it's a MEDCO cam lock. You
can buy that you can't buy the

436
00:46:14,125 --> 00:46:23,380
key, just the cam lock. What can
you do to buy the box because it
ships open. If you take the tail

437
00:46:23,380 --> 00:46:29,375
piece off oh a MEDCO cam lock.
The front slides out. What
happens then? You peel off the

438
00:46:29,375 --> 00:46:34,542
top plait and have an [extra one
with you if you're doing it
nefariously. There's bob here

439
00:46:34,542 --> 00:46:42,020
he's helping to get this thing
apart. Holy crap. It's that
easy. There's the pins, there's

440
00:46:42,020 --> 00:46:47,400
the springs, let's put them on a
MEDCO tray. Let's do some
measurements. Let's compare that

441
00:46:47,400 --> 00:46:52,240
from what we know from our code
books. Let's put it back
together under five minutes you

442
00:46:52,250 --> 00:46:57,542
put a new brass plait on the
top. You're supposed to stamp
that down with a stamp tool. The

443
00:46:57,542 --> 00:47:05,400
lock Smith we got that from  ‑ ‑
  ‑ ‑ we had to stamp it down
with this. We just pounded on it

444
00:47:05,400 --> 00:47:14,240
with a (indiscernible) for a
while. But it's fine. And in the
end, there's your Cricken

445
00:47:14,240 --> 00:47:23,330
Kentucky key. >> [Applause] >> But
wait there's more. Florida divides
their states into zones. You

446
00:47:23,340 --> 00:47:31,380
can't buy the key, but you can
buy the lock. Little bit more
interesting, little bit harder

447
00:47:31,380 --> 00:47:38,240
to take apart. Not that hard. If
you have a pinning tray, it's
not a cam lock tray  ‑ ‑   ‑ ‑

448
00:47:38,250 --> 00:47:44,625
left right center. You can
completely check your code
books. Oh what's this? The zone

449
00:47:44,625 --> 00:47:53,200
four key. What's this? It's the
zone kick six key. So zone
seven. You want all of Florida

450
00:47:53,200 --> 00:47:59,880
K, seven keys instead of one.
And also we boughting the key
from Louisiana and decoded it.

451
00:47:59,880 --> 00:48:05,875
And we  ‑ ‑ ... and you can also
by  ‑ ‑ we could do this all
fucking day and we have all the

452
00:48:05,875 --> 00:48:18,655
god dam state keys in all the
states right now. (Applause.) So
we're not saying these are bad

453
00:48:18,667 --> 00:48:24,250
locks right? We're not
(indiscernible) up here. We're
not saying MEDCO is the worst

454
00:48:24,250 --> 00:48:29,167
cylinder ever and you should use
like get a (indiscernible) [F]
3D because you could try to take

455
00:48:29,167 --> 00:48:34,083
it apart it'll explode in your
face and you could never put it
together again. No we're saying

456
00:48:34,083 --> 00:48:38,792
you shouldn't think of your
mechanical key systems as a 
single point of

457
00:48:38,792 --> 00:48:44,833
resistance. They're not going to
provide you ironclad security.
They can take it apart and

458
00:48:44,833 --> 00:48:52,333
measure the pins. Sure they
fucking can. >> Also there's
implementation. If you're floor

459
00:48:52,333 --> 00:48:59,153
with the Knox box type of system
it's implemented a little bit
better. You can't buy the lock and

460
00:48:59,160 --> 00:49:04,820
take it apart. The fire
department is authorizing to
purchase and possess a cylinder

461
00:49:04,820 --> 00:49:08,400
itself. But that doesn't mean
the fire righters don't just
lose these things in the

462
00:49:08,400 --> 00:49:16,458
hundred  ‑ ‑ like really? Come
on. That was over like two or
three years too. >> And I'm

463
00:49:16,458 --> 00:49:21,792
talking like one a day. >> Now
this is all, again, this is fire
service operation. This is one

464
00:49:21,792 --> 00:49:26,917
of the most powerful modes. It's
actually not as hard as you
think to get the keys. No we

465
00:49:26,917 --> 00:49:31,583
won't just give them to you.
Maybe you'll like hack through
my laptop and get the biddings I

466
00:49:31,583 --> 00:49:41,240
redacted on the slides. But  ‑ ‑
  ‑ ‑ there's what can you do in
the hoist way, the answer is

467
00:49:41,240 --> 00:49:46,040
everything. What if you have a
building that you  ‑ ‑ you know
the fire key in the lobby that

468
00:49:46,042 --> 00:49:49,792
we used  ‑ ‑ if you're not in
the lobby, what if you want to
move around the building. Well

469
00:49:49,792 --> 00:49:56,167
if you seized control of the
elevator and you get on the car
top, and I don't mean you

470
00:49:56,167 --> 00:50:04,380
because you shouldn't. You could
do this. On the lower right you
see where we are. The upper

471
00:50:04,380 --> 00:50:08,833
right is where we want to be.
This is an elevator that is
driving itself down the hoist

472
00:50:08,833 --> 00:50:15,500
way because we sent some calls
down that way. If [we want to,
we can seize the car in a way

473
00:50:15,500 --> 00:50:19,083
that's completely out of
standard. You're not supposed
to do it. I've learned from

474
00:50:19,083 --> 00:50:24,500
Howard, there's three ways to do
things. There's the right way,
the wrong way and the elevator

475
00:50:24,500 --> 00:50:30,833
person way. >> Which is like the
wrong way faster basically.
>> So here we are  ‑ ‑ there's

476
00:50:30,833 --> 00:50:36,167
the car top, all right, we're on
a mode  ‑ ‑ we're not really going
to talk about any of this

477
00:50:36,167 --> 00:50:42,667
right now. But if we take
control of this elevator and we
get on to the car top, my mom

478
00:50:42,667 --> 00:50:48,417
hated this video. She almost
smacked me when she saw it. What
are you doing. You shouldn't be

479
00:50:48,417 --> 00:50:58,197
there. You're an idiot. So once
you're in the hoist way, you can
drive this car anywhere. It

480
00:50:58,208 --> 00:51:04,917
literally doesn't matter if this
is a fed facility, this one wasn't, but
in the hoist way, your risk of

481
00:51:04,917 --> 00:51:10,667
life is so great that you have
utter absolute control. You can
drive any direction. You can go

482
00:51:10,667 --> 00:51:16,500
to any other floor. What kind of
security do you think the hoist
way doors have on

483
00:51:16,500 --> 00:51:28,020
the other side? (Inaudible) 0.
There we are, thank you good
night. You can just send it

484
00:51:28,020 --> 00:51:35,660
down. So how do we do that?
>> You've seen that little hole
right SNG. >> Real quick

485
00:51:35,667 --> 00:51:40,833
disclaimer, there's another
video, where we are completely
out of control and almost

486
00:51:40,833 --> 00:51:46,042
crashed in the over head. Down
down down in the black and
jumping down in the grease in

487
00:51:46,042 --> 00:51:51,750
the elevator car top. Sometimes
thing can be unpredictable.
Sometimes out of your control.

488
00:51:51,750 --> 00:51:56,042
So if you see that hole in the
door, that's call add
(indiscernible) hole. That is

489
00:51:56,042 --> 00:52:01,940
the hole through which elevator
personnel that will  ‑ ‑ that
will usually flip a flag that

490
00:52:01,940 --> 00:52:08,660
release it is door interlock. It
does two things. It keeps the
doors mechanically closed and it

491
00:52:08,667 --> 00:52:13,167
also electrically signals to the
controller that the doors are
closed. So when an elevator

492
00:52:13,167 --> 00:52:18,347
mechanic sticks it key in and
turn it. It unlock it is door
and sends a signal to the

493
00:52:18,347 --> 00:52:23,580
controller that the door is
open, stop the cab. With that
being said, there's a million

494
00:52:23,583 --> 00:52:29,458
different kinds of key, but
there's a key for every door at
the end of the the day  ‑ ‑   ‑

495
00:52:29,458 --> 00:52:33,333
‑ sometimes it doesn't have a
hole, there are often ways of
interacting with the interlock

496
00:52:33,333 --> 00:52:41,833
that you might not expect. >> I
know how uber this talk is, I
really do. Unfortunately, you're

497
00:52:41,833 --> 00:52:49,667
trying to set up for final
ceremonies, and this track has
to end. Now I have a problem

498
00:52:49,667 --> 00:52:54,292
with usually we shot this
SPAEKers, that's nice for them.
But we have little tricks up our

499
00:52:54,292 --> 00:53:02,572
sleeves to lure the speakers off
stage. So I brought with me some
bait. Come on, come on speakers.

500
00:53:02,583 --> 00:53:08,875
>> I'm literally not going. Because
it is not the top of the hour.
We have seven minutes and we're

501
00:53:08,880 --> 00:53:17,740
going to use all seven minutes.
(Applause.) (Indiscernible)
really fast. You know people

502
00:53:17,740 --> 00:53:23,200
used to stash drugs in hoist
ways because they could pop
hole. They made a lock for it.

503
00:53:23,208 --> 00:53:27,958
The lock was interesting, it
would plug up the hole. The lock
had a problem in the way it was

504
00:53:27,958 --> 00:53:34,250
assembled. The lock screwed
together. So if the lock screws
together and you can just

505
00:53:34,250 --> 00:53:43,100
unscrew the collar, you don't
need the real key, what you can
do is say that's the speedy key.

506
00:53:43,100 --> 00:53:52,000
That it's fast key. If you don't
have that key, well what if you
had any other possible key ever?

507
00:53:55,625 --> 00:54:01,625
Yeah. Put a little torque on
that. Push a little harder. Oh
my, what happened there? Yeah

508
00:54:04,250 --> 00:54:11,167
just unscrew the (indiscernible)
lock. Pull it apart, whatever.
Fine. Come talk to us  ‑ ‑

509
00:54:11,167 --> 00:54:15,042
there's so  ‑ ‑ we're going to
skip a few slides. We're going
to show you some others. In the

510
00:54:15,042 --> 00:54:20,167
end, there are some really
common guidelines we can give
you right? >> First thing if

511
00:54:20,167 --> 00:54:26,320
you have an emergency phone in
the elevator that's answered by
your your security desk. This is

512
00:54:26,320 --> 00:54:33,792
a case where a guy got stuck in
an elevator for over 48 hours
because the phone didn't work.

513
00:54:33,792 --> 00:54:41,542
There ended up being a lawsuit.
Test your alarm bell. Make sure
it works too. >> (Speaking

514
00:54:41,542 --> 00:54:45,917
simultaneously) the hoist way
should never be accessible. No
one should be in there and ride

515
00:54:45,917 --> 00:54:52,625
the fucking counterweight. >> If
anybody recognizes this photo,
I'll buy you a drink at the bar.

516
00:54:52,625 --> 00:55:00,417
Your motor room, should be self‑
closing self‑ locking. This is
not self‑ closing or self‑

517
00:55:00,417 --> 00:55:05,597
locking and B is being operated
by a frickin' mall security
guard who shouldn't be in there

518
00:55:05,600 --> 00:55:09,660
because it's dangerous. Only
elevator people should be in
there. Because you know these

519
00:55:09,667 --> 00:55:15,667
guys are elevator guys. >> [Applause] >>
Know who your elevator staff is.
They are not your maintenance

520
00:55:22,292 --> 00:55:27,000
crew. They are very nice sir.
Know who your people are that
provide your maintenance vs.

521
00:55:27,000 --> 00:55:33,125
consulting. Know who your people
are and what they're doing. If
you have bullshit jobs and

522
00:55:33,125 --> 00:55:37,167
paperwork that's not being
filled out if you have
collusion or inspection

523
00:55:37,167 --> 00:55:42,292
that is don't make any sense,
what is this? There are test
tabs. It's a permanently affixed

524
00:55:42,292 --> 00:55:48,492
tab that after, every year,
every five years there is
performed they fill it out

525
00:55:48,500 --> 00:55:54,000
indicating the elevator passed
hopefully and it's left there so
if somebody ever has to come in

526
00:55:54,000 --> 00:56:01,667
and take a look and say when the
test was done and  ‑ ‑ let us
know that OETS performed the

527
00:56:01,667 --> 00:56:08,083
test, because that makes sense.
Unless the guy's name was Otis.
Elevator tests are important.

528
00:56:08,083 --> 00:56:17,042
Here's a final readiness
test. (machine noise.) Yeah
and the client didn't, no it's

529
00:56:17,042 --> 00:56:22,083
fine right? To be fair, the
elevator mechanic said there's
no way this is going to work.

530
00:56:22,083 --> 00:56:27,625
And he made his supervisor come
down he was the one recording
it. You want to run the test,

531
00:56:27,625 --> 00:56:35,250
you run the test, I'll record
it. So yeah, follow all of your
building procedures. How many

532
00:56:35,250 --> 00:56:41,500
times we've coasted in on oh I'm
the elevator guy I BLONG here. I
have a shirt I bought which you

533
00:56:41,500 --> 00:56:46,625
can't anymore. You can no longer
buy the uniforms forms we're
wearing right now. Pretty much

534
00:56:46,625 --> 00:56:53,625
thanks (inaudible). >> I believe
they did. >> So what do you do
now? If your elevators are maybe

535
00:56:53,625 --> 00:56:57,917
part of your security models and
you're like oh my God, what if
people are going to attack the

536
00:56:57,917 --> 00:57:04,083
elevators because they're not
actually doing what they think,
there is a difference between

537
00:57:04,083 --> 00:57:10,625
your parts oil and grease tech
at a security consultant. There
are people that do this. Not

538
00:57:10,625 --> 00:57:16,208
like a lot of them. He's kind of
the only ones we've ever Maine
but your elevator controller can

539
00:57:16,208 --> 00:57:22,083
actually do monitoring without
installing a fucking windows box
in the motor room. Your elevator

540
00:57:22,083 --> 00:57:28,040
controller can open or close
contacts if it gets flipped on
independent mode or inspection

541
00:57:28,040 --> 00:57:34,660
mode or fire mode. You could be
logging this with your access
control system or alarm system.

542
00:57:34,667 --> 00:57:40,208
There are add on boards, extra
modules that you can use to make
your system better. We're going

543
00:57:40,208 --> 00:57:44,167
to wrap it up in one minute with
some final tips they're useful
if you're a jackass and get

544
00:57:44,167 --> 00:57:51,780
stuck. First tip, don't panic.
You're not going to run out of
air. There's a fan. And just in

545
00:57:51,780 --> 00:57:58,860
general, there's oxygen. So just
relax. The second thing is, if
you're on a red team, you don't

546
00:57:58,860 --> 00:58:05,917
want to use the emergency phone.
But if the main light in the cab
are off, the power's out.

547
00:58:05,917 --> 00:58:10,833
There's nothing you can do. If
the cab lights are still on, you
might have a few options. .

548
00:58:10,833 --> 00:58:17,542
Let's just run through a few
scripts. They're going to tell
you to hit door open. Would you

549
00:58:17,542 --> 00:58:21,208
believe that happens all the
time. Someone's just siting
there. The cab is parked and

550
00:58:21,208 --> 00:58:27,420
they just don't think to hit
door open. They might tell you
to hit door close and then hit

551
00:58:27,420 --> 00:58:32,740
door open. This sometimes when
the door operator hadn't fully
closed the doors allows it to

552
00:58:32,750 --> 00:58:37,500
fully close and signalling to
the elevator that it's safe
run. Another option would be

553
00:58:37,500 --> 00:58:42,333
make sure you can register a
call to another floor. If you're
sitting there and staring at it

554
00:58:42,333 --> 00:58:48,813
and it's stuck, you're stuck.
But maybe you're stuck at a
floor you don't have access to.

555
00:58:48,820 --> 00:58:55,240
Badge in, etc. >> If you have a
badge, make sure it's in before
you're placing the callsment Ma.

556
00:58:55,250 --> 00:59:03,083
Maybe your a authorized user and
your key switches. >> Or e‑
mailed me and bought some keys.

557
00:59:03,083 --> 00:59:07,167
>> You could try the key switches
I've been stuck in elevators
where it didn't matter. And of

558
00:59:07,167 --> 00:59:11,875
course, the last thing is, keep
in mind the number one cause of
encrapments is that the doors

559
00:59:11,875 --> 00:59:17,542
have opened somewhere. It might
not be where you are, but it
might be. So I very hesitantly

560
00:59:17,542 --> 00:59:24,520
say this you can kind of
troubleshoot the doors in a safe
way. Don't stick your hand in

561
00:59:24,520 --> 00:59:30,380
the gap between the doors. Just
very gently put your palm on the
door, see if it's jiggling and

562
00:59:30,380 --> 00:59:39,458
try to close them with the flat
part of your hand somewhere
square on the door. And if all

563
00:59:39,458 --> 00:59:44,458
else fails, call for help.
>> I'll help you. >> Never ever
ever try to leave through the

564
00:59:44,458 --> 00:59:51,938
top hatch. It doesn't lead you
anywhere and it'll fuck other
shit up. Never ever exit a

565
00:59:51,940 --> 01:00:00,000
missed level car. If
you have to jump it's too far,
stay in the elevator. It's the

566
01:00:00,000 --> 01:00:05,000
safest place to be, the elevator
wants to keep you alive. We
wanted to keep you alive. We

567
01:00:05,000 --> 01:00:09,400
hope you learned something
today. Thank you for letting us
talk at DEF CON. (Applause.) 

