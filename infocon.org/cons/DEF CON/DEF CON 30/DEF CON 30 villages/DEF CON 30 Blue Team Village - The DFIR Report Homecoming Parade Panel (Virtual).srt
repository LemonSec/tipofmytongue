1
00:00:07,600 --> 00:00:08,400
okay

2
00:00:08,400 --> 00:00:11,440
hello everyone and welcome to the d for

3
00:00:11,440 --> 00:00:15,200
report homecoming parade panel

4
00:00:15,200 --> 00:00:18,240
so this year defcon has a theme and it

5
00:00:18,240 --> 00:00:20,480
is hacker homecoming

6
00:00:20,480 --> 00:00:24,000
and what better way to celebrate it than

7
00:00:24,000 --> 00:00:26,320
with our favorite threat intelligence

8
00:00:26,320 --> 00:00:27,439
report

9
00:00:27,439 --> 00:00:30,720
and a homecoming parade so with that

10
00:00:30,720 --> 00:00:32,800
welcome to the d4 report homecoming

11
00:00:32,800 --> 00:00:36,160
parade panel we have two special guests

12
00:00:36,160 --> 00:00:39,360
from the dfr report to share insights

13
00:00:39,360 --> 00:00:42,399
and behind the scenes info and

14
00:00:42,399 --> 00:00:45,760
to share their thoughts as analysts

15
00:00:45,760 --> 00:00:48,559
we also have an amazing lineup of

16
00:00:48,559 --> 00:00:51,120
non-differ report professionals with a

17
00:00:51,120 --> 00:00:53,360
range of experience from cyber threat

18
00:00:53,360 --> 00:00:57,280
intelligence to hunt to red to detection

19
00:00:57,280 --> 00:01:00,879
engineering and our goal with this panel

20
00:01:00,879 --> 00:01:04,000
is to share valuable insights you can

21
00:01:04,000 --> 00:01:07,360
implement at your organization and

22
00:01:07,360 --> 00:01:10,000
to have a discussion on the difa reports

23
00:01:10,000 --> 00:01:11,040
as if

24
00:01:11,040 --> 00:01:13,840
their homecoming parade floats

25
00:01:13,840 --> 00:01:16,479
so we will comment on four different

26
00:01:16,479 --> 00:01:18,799
diva reports during this talk or four

27
00:01:18,799 --> 00:01:21,200
different differ homecoming parade

28
00:01:21,200 --> 00:01:22,560
floats

29
00:01:22,560 --> 00:01:25,439
and at the end we'll have an overall

30
00:01:25,439 --> 00:01:28,479
discussion of the reports and vote for

31
00:01:28,479 --> 00:01:31,759
our favorite best float or bestie for

32
00:01:31,759 --> 00:01:35,200
report for the difer homecoming parade

33
00:01:35,200 --> 00:01:37,600
and with that we'll start with a brief

34
00:01:37,600 --> 00:01:39,920
round of introductions where people will

35
00:01:39,920 --> 00:01:40,880
share

36
00:01:40,880 --> 00:01:44,399
if they are red blue or purple a little

37
00:01:44,399 --> 00:01:47,119
tidbit about themselves and the general

38
00:01:47,119 --> 00:01:49,520
size of the organization that they have

39
00:01:49,520 --> 00:01:52,560
experience with and with that uh some

40
00:01:52,560 --> 00:01:54,880
one of the panelists please please step

41
00:01:54,880 --> 00:01:57,039
up

42
00:01:57,280 --> 00:01:59,040
i can go ahead and be brave uh jamie

43
00:01:59,040 --> 00:02:02,000
williams uh adversary emulation and lead

44
00:02:02,000 --> 00:02:04,320
for uh mitre attack for enterprise at

45
00:02:04,320 --> 00:02:07,920
the mitre corporation uh purple uh but

46
00:02:07,920 --> 00:02:10,720
by way of red so background is a lot of

47
00:02:10,720 --> 00:02:13,280
intel and adversary emulation red

48
00:02:13,280 --> 00:02:15,840
teaming work but recently focusing a lot

49
00:02:15,840 --> 00:02:17,440
on how do we actually translate that to

50
00:02:17,440 --> 00:02:19,120
defenses so you know exactly as you said

51
00:02:19,120 --> 00:02:21,680
taking those lessons that we can learn

52
00:02:21,680 --> 00:02:23,280
and applying that to detections and

53
00:02:23,280 --> 00:02:26,160
mitigations uh in terms of size of scope

54
00:02:26,160 --> 00:02:28,239
i always like to you know good analogy

55
00:02:28,239 --> 00:02:30,000
is we start small starting a single host

56
00:02:30,000 --> 00:02:31,599
and try to spread that to an entire

57
00:02:31,599 --> 00:02:33,760
enterprise of the entire world so happy

58
00:02:33,760 --> 00:02:35,360
to be here and obviously honored to be a

59
00:02:35,360 --> 00:02:38,560
part of this uh panel

60
00:02:39,599 --> 00:02:42,560
thank you next

61
00:02:42,560 --> 00:02:45,440
all right uh just nelsey i'm the cto at

62
00:02:45,440 --> 00:02:46,800
trusted sac

63
00:02:46,800 --> 00:02:48,959
i'm here from the red side

64
00:02:48,959 --> 00:02:52,160
um background in you know pen test uh

65
00:02:52,160 --> 00:02:54,160
some research a lot of red teaming in

66
00:02:54,160 --> 00:02:55,519
the last uh

67
00:02:55,519 --> 00:02:56,959
six seven years

68
00:02:56,959 --> 00:02:58,159
um

69
00:02:58,159 --> 00:03:00,319
and uh yeah my experience with

70
00:03:00,319 --> 00:03:02,319
organizations is from you know fortune

71
00:03:02,319 --> 00:03:03,280
10

72
00:03:03,280 --> 00:03:05,200
down to you know three 400 person

73
00:03:05,200 --> 00:03:07,280
organizations so um a little bit of

74
00:03:07,280 --> 00:03:10,000
everything um and i've also done some ir

75
00:03:10,000 --> 00:03:12,640
work for trusted tech as well

76
00:03:12,640 --> 00:03:14,239
wonderful

77
00:03:14,239 --> 00:03:16,400
well i will go next

78
00:03:16,400 --> 00:03:19,360
and nasser dean here known as nasbang

79
00:03:19,360 --> 00:03:21,280
i'm come from the blue side

80
00:03:21,280 --> 00:03:23,920
i am currently a threat researcher for a

81
00:03:23,920 --> 00:03:27,040
private company uh i have experience

82
00:03:27,040 --> 00:03:29,040
with an organization

83
00:03:29,040 --> 00:03:32,480
that has more than 20 000 end points

84
00:03:32,480 --> 00:03:35,040
i have a little bit background

85
00:03:35,040 --> 00:03:37,440
in red teaming i did what i did some pen

86
00:03:37,440 --> 00:03:39,599
testing i also have some background in

87
00:03:39,599 --> 00:03:41,840
incident response i currently do

88
00:03:41,840 --> 00:03:43,680
basically detection engineering and i

89
00:03:43,680 --> 00:03:47,040
focus on anything related to sigma

90
00:03:47,040 --> 00:03:48,959
yeah

91
00:03:48,959 --> 00:03:51,519
wonderful

92
00:03:51,599 --> 00:03:53,120
i can go next turn

93
00:03:53,120 --> 00:03:55,040
the class cases

94
00:03:55,040 --> 00:03:56,239
based in

95
00:03:56,239 --> 00:03:58,080
stockholm sweden but actually coming up

96
00:03:58,080 --> 00:04:00,000
from brazil right now to visit my friend

97
00:04:00,000 --> 00:04:02,319
tablets uh my wife's family

98
00:04:02,319 --> 00:04:05,360
uh i work at a company called trusec

99
00:04:05,360 --> 00:04:08,000
where i do malware analysis for our

100
00:04:08,000 --> 00:04:11,280
shopkins for our iot

101
00:04:11,280 --> 00:04:14,799
and i also am ics specialist i call from

102
00:04:14,799 --> 00:04:16,880
that background programming plc's

103
00:04:16,880 --> 00:04:18,478
critical infrastructure

104
00:04:18,478 --> 00:04:21,279
uh so that's that double industries um

105
00:04:21,279 --> 00:04:23,280
and i previously worked for the national

106
00:04:23,280 --> 00:04:25,199
startup as well so i have kind of worked

107
00:04:25,199 --> 00:04:28,479
from small enterprise up until then for

108
00:04:28,479 --> 00:04:30,080
the country as well so

109
00:04:30,080 --> 00:04:32,639
and i i spend my

110
00:04:32,639 --> 00:04:34,880
spare time helping the beef report

111
00:04:34,880 --> 00:04:37,759
analyzing stuff they they

112
00:04:37,759 --> 00:04:39,440
we find there as well to contribute to

113
00:04:39,440 --> 00:04:42,520
the community

114
00:04:46,120 --> 00:04:49,170
[Music]

115
00:04:50,160 --> 00:04:52,080
um

116
00:04:52,080 --> 00:04:54,639
i have a background

117
00:04:54,639 --> 00:04:58,240
in instant response and threat intel um

118
00:04:58,240 --> 00:04:59,520
currently

119
00:04:59,520 --> 00:05:01,120
i'm doing

120
00:05:01,120 --> 00:05:03,039
working for a security vendor as a

121
00:05:03,039 --> 00:05:05,440
threat researcher and threat hunter

122
00:05:05,440 --> 00:05:06,240
and

123
00:05:06,240 --> 00:05:08,880
by that's by day by night i'm a member

124
00:05:08,880 --> 00:05:11,199
of the dfi art board

125
00:05:11,199 --> 00:05:13,600
wonderful and thank you everyone for the

126
00:05:13,600 --> 00:05:16,400
intros and i am cheerio also known as

127
00:05:16,400 --> 00:05:19,360
xena olson i have a doctorate in cyber

128
00:05:19,360 --> 00:05:22,160
security and mba and i.t management 8 gx

129
00:05:22,160 --> 00:05:24,560
certifications currently i'm a lead

130
00:05:24,560 --> 00:05:27,680
cyber threat hunter for fortune 100

131
00:05:27,680 --> 00:05:29,039
and uh

132
00:05:29,039 --> 00:05:32,240
let's get started so what we're gonna do

133
00:05:32,240 --> 00:05:36,160
is go over the four differ reports oh um

134
00:05:36,160 --> 00:05:37,280
and

135
00:05:37,280 --> 00:05:39,440
uh with that we have some high level

136
00:05:39,440 --> 00:05:42,960
questions that we are going to attempt

137
00:05:42,960 --> 00:05:45,280
to address within the time allotted per

138
00:05:45,280 --> 00:05:47,840
report so just to give you a high level

139
00:05:47,840 --> 00:05:49,680
overview it's going to be more

140
00:05:49,680 --> 00:05:52,080
conversation and story based but these

141
00:05:52,080 --> 00:05:53,919
are kind of the high level points that

142
00:05:53,919 --> 00:05:56,160
we're going to try to hit her report so

143
00:05:56,160 --> 00:05:58,000
the first one is how would you

144
00:05:58,000 --> 00:06:01,600
operationalize this the second one is

145
00:06:01,600 --> 00:06:04,479
if you could do only one thing for this

146
00:06:04,479 --> 00:06:06,560
report what would it be

147
00:06:06,560 --> 00:06:09,039
the third one is do you perform

148
00:06:09,039 --> 00:06:11,520
supplementary research in addition to

149
00:06:11,520 --> 00:06:14,000
using the differ report the fourth one

150
00:06:14,000 --> 00:06:18,000
is besides iox indicators of compromise

151
00:06:18,000 --> 00:06:20,639
did anything stand out to you that you

152
00:06:20,639 --> 00:06:23,680
would prioritize over something else and

153
00:06:23,680 --> 00:06:26,639
then finally what advice would you give

154
00:06:26,639 --> 00:06:29,520
to newer analysts so with that we will

155
00:06:29,520 --> 00:06:32,240
start with the iced id report from

156
00:06:32,240 --> 00:06:34,639
october of 2021

157
00:06:34,639 --> 00:06:36,960
and who would be interested in kicking

158
00:06:36,960 --> 00:06:39,599
that off

159
00:06:42,479 --> 00:06:44,720
i can go ahead and toss one in um

160
00:06:44,720 --> 00:06:46,800
so i'm always fascinating these reports

161
00:06:46,800 --> 00:06:48,720
and obviously a lot of respect for you

162
00:06:48,720 --> 00:06:49,919
folks putting these together because it

163
00:06:49,919 --> 00:06:51,759
really does help us kind of um

164
00:06:51,759 --> 00:06:53,840
contextualize but also act on it like

165
00:06:53,840 --> 00:06:55,759
from my perspective we read these

166
00:06:55,759 --> 00:06:57,840
we kind of you know consume and see what

167
00:06:57,840 --> 00:06:59,280
techniques we're seeing but also is

168
00:06:59,280 --> 00:07:01,280
there something that i necessarily

169
00:07:01,280 --> 00:07:02,800
haven't seen before or haven't you

170
00:07:02,800 --> 00:07:04,240
really thought about

171
00:07:04,240 --> 00:07:06,800
the big one here for me at least was

172
00:07:06,800 --> 00:07:08,240
the tradecraft really didn't blow me

173
00:07:08,240 --> 00:07:10,080
away like i it's something that i think

174
00:07:10,080 --> 00:07:12,479
a lot of actors are abusing but honestly

175
00:07:12,479 --> 00:07:14,800
it was a lot of probably very you know

176
00:07:14,800 --> 00:07:17,360
we can even comment call it common uh

177
00:07:17,360 --> 00:07:19,360
practices but really what you know it's

178
00:07:19,360 --> 00:07:21,039
even in the title what separated this

179
00:07:21,039 --> 00:07:23,039
report from my other reports for me was

180
00:07:23,039 --> 00:07:24,960
the tempo and i think it really

181
00:07:24,960 --> 00:07:26,639
exaggerates and i think the big takeaway

182
00:07:26,639 --> 00:07:27,520
was

183
00:07:27,520 --> 00:07:29,280
you know from an i'm glad to hear some

184
00:07:29,280 --> 00:07:31,840
of so many ir people on this call is

185
00:07:31,840 --> 00:07:33,840
you know the need for you know i don't

186
00:07:33,840 --> 00:07:35,280
know how many alerts

187
00:07:35,280 --> 00:07:37,120
per a given org would fire on this but i

188
00:07:37,120 --> 00:07:39,039
imagine hopefully there's some but the

189
00:07:39,039 --> 00:07:41,120
need to actually triage those versus you

190
00:07:41,120 --> 00:07:42,400
know there's a lot of detection

191
00:07:42,400 --> 00:07:44,639
opportunities in this campaign but you

192
00:07:44,639 --> 00:07:46,639
know this is a really great use case for

193
00:07:46,639 --> 00:07:48,319
if you're not acting on those and

194
00:07:48,319 --> 00:07:49,840
actually you know remediating and

195
00:07:49,840 --> 00:07:50,960
responding

196
00:07:50,960 --> 00:07:52,639
this is kind of what could potentially

197
00:07:52,639 --> 00:07:54,879
happen

198
00:07:57,039 --> 00:07:59,840
that's a really great point and uh one

199
00:07:59,840 --> 00:08:01,759
of one of the things that i want to add

200
00:08:01,759 --> 00:08:04,960
is regarding the risk rule discovery so

201
00:08:04,960 --> 00:08:08,400
sometimes you know uh in here i will go

202
00:08:08,400 --> 00:08:12,520
to the discovery section

203
00:08:14,800 --> 00:08:17,120
if i can control f

204
00:08:17,120 --> 00:08:17,919
so

205
00:08:17,919 --> 00:08:20,720
responding to these individual uh

206
00:08:20,720 --> 00:08:22,319
commands

207
00:08:22,319 --> 00:08:23,840
let's see

208
00:08:23,840 --> 00:08:26,400
i think it's up here um

209
00:08:26,400 --> 00:08:29,280
it it might be difficult right so like

210
00:08:29,280 --> 00:08:31,120
trying to catch every single one of the

211
00:08:31,120 --> 00:08:33,039
discovery commands related to that but

212
00:08:33,039 --> 00:08:35,200
if you do a risk rule

213
00:08:35,200 --> 00:08:38,159
and spam that up

214
00:08:38,159 --> 00:08:39,200
it'll be

215
00:08:39,200 --> 00:08:42,559
it'll be better for analysts trying to

216
00:08:42,559 --> 00:08:44,880
trying to work this particular thing

217
00:08:44,880 --> 00:08:45,680
right

218
00:08:45,680 --> 00:08:47,839
instead of like an alert on this an

219
00:08:47,839 --> 00:08:49,760
alert on this an alert like it it

220
00:08:49,760 --> 00:08:51,360
doesn't make sense to do an alert on

221
00:08:51,360 --> 00:08:52,880
cmd.exe

222
00:08:52,880 --> 00:08:55,600
but if you aggregate this per host over

223
00:08:55,600 --> 00:08:58,160
time i believe that it could be a high

224
00:08:58,160 --> 00:08:59,440
fidelity

225
00:08:59,440 --> 00:09:01,440
type of detection that you have from

226
00:09:01,440 --> 00:09:02,560
initial

227
00:09:02,560 --> 00:09:04,880
access to the environment does anyone

228
00:09:04,880 --> 00:09:07,680
else have any thoughts on that

229
00:09:07,680 --> 00:09:08,959
i was just going to add that you know

230
00:09:08,959 --> 00:09:10,560
you'll see a theme across you know all

231
00:09:10,560 --> 00:09:12,160
of these reports is the

232
00:09:12,160 --> 00:09:13,920
discovery phase like you said has a lot

233
00:09:13,920 --> 00:09:15,920
of good detection opportunity because

234
00:09:15,920 --> 00:09:17,200
you know the way these commands are

235
00:09:17,200 --> 00:09:20,399
clustered like net domain admins uh nl

236
00:09:20,399 --> 00:09:22,480
tests things like that like you might

237
00:09:22,480 --> 00:09:24,080
see one or two of those fire because of

238
00:09:24,080 --> 00:09:26,240
some script or an install script but the

239
00:09:26,240 --> 00:09:28,000
the grouping of them and you know a time

240
00:09:28,000 --> 00:09:29,839
frame like you said a few minutes is you

241
00:09:29,839 --> 00:09:31,680
know kind of a common trend across all

242
00:09:31,680 --> 00:09:34,000
these reports and it's a you know

243
00:09:34,000 --> 00:09:35,519
somebody's got to run something and the

244
00:09:35,519 --> 00:09:37,600
thing that happens next is a great place

245
00:09:37,600 --> 00:09:40,080
to start so these are something

246
00:09:40,080 --> 00:09:41,839
from the red side we always try to avoid

247
00:09:41,839 --> 00:09:44,720
piping things through cmd.exe but on the

248
00:09:44,720 --> 00:09:46,480
you know ransomware side of the house

249
00:09:46,480 --> 00:09:47,600
and things like that this is still a

250
00:09:47,600 --> 00:09:50,320
very common practice

251
00:09:50,320 --> 00:09:52,160
yeah quick shout out to you folks are

252
00:09:52,160 --> 00:09:53,760
actually reporting that too because like

253
00:09:53,760 --> 00:09:55,920
just looking at like other like in

254
00:09:55,920 --> 00:09:57,839
general across like intel like sometimes

255
00:09:57,839 --> 00:09:59,519
just getting discovery commands and

256
00:09:59,519 --> 00:10:01,279
seeing that insight is kind of hard but

257
00:10:01,279 --> 00:10:02,560
i've noticed that across like this

258
00:10:02,560 --> 00:10:04,000
report and others like actually

259
00:10:04,000 --> 00:10:05,839
documenting that really does help us out

260
00:10:05,839 --> 00:10:07,440
quite a bit

261
00:10:07,440 --> 00:10:09,680
yeah it does and i think too you know

262
00:10:09,680 --> 00:10:12,079
speaking to the red side of it matt hand

263
00:10:12,079 --> 00:10:14,240
over at spectre ops i love them by the

264
00:10:14,240 --> 00:10:15,120
way

265
00:10:15,120 --> 00:10:17,519
uh they're awesome like trusted suck

266
00:10:17,519 --> 00:10:21,040
right um they matt hand put out a recent

267
00:10:21,040 --> 00:10:24,000
article regarding thinking about the

268
00:10:24,000 --> 00:10:26,640
execution right so we think it lands on

269
00:10:26,640 --> 00:10:29,200
the box and then we immediately expect

270
00:10:29,200 --> 00:10:32,640
the netcon and he was encouraging people

271
00:10:32,640 --> 00:10:34,880
to maybe move away from that mental

272
00:10:34,880 --> 00:10:37,920
model and expand how you think about

273
00:10:37,920 --> 00:10:40,000
when something lands on the box and the

274
00:10:40,000 --> 00:10:41,839
time frame involved

275
00:10:41,839 --> 00:10:44,800
so here he shows that where you know can

276
00:10:44,800 --> 00:10:47,680
land on the box and then it waits

277
00:10:47,680 --> 00:10:50,000
to make the network connection instead

278
00:10:50,000 --> 00:10:52,800
of immediately so when building

279
00:10:52,800 --> 00:10:55,360
when building the specific alerts uh

280
00:10:55,360 --> 00:10:57,600
related to this type of behavior

281
00:10:57,600 --> 00:10:59,200
regardless of which report you're

282
00:10:59,200 --> 00:11:00,399
looking at

283
00:11:00,399 --> 00:11:02,480
um take that into consideration when

284
00:11:02,480 --> 00:11:04,079
you're building out your detections as

285
00:11:04,079 --> 00:11:06,240
well for those sneaky quote unquote red

286
00:11:06,240 --> 00:11:09,120
teamers out there sorry justin

287
00:11:09,120 --> 00:11:11,839
they're so sneaky they're good

288
00:11:11,839 --> 00:11:14,800
so that was also part of it anyone else

289
00:11:14,800 --> 00:11:17,279
have anything that they want to share

290
00:11:17,279 --> 00:11:18,399
regarding that

291
00:11:18,399 --> 00:11:20,880
what i would like to add is uh these

292
00:11:20,880 --> 00:11:22,640
kind of commands we see

293
00:11:22,640 --> 00:11:24,399
we will see them and we are going still

294
00:11:24,399 --> 00:11:26,720
to see them every day in most attacks

295
00:11:26,720 --> 00:11:29,360
the difficult part that i found is the

296
00:11:29,360 --> 00:11:31,680
ability you say aggregation but it's

297
00:11:31,680 --> 00:11:33,200
kind of hard to do especially in

298
00:11:33,200 --> 00:11:35,839
non-homogenous environments as it is

299
00:11:35,839 --> 00:11:38,959
usually the case where uh everybody is

300
00:11:38,959 --> 00:11:42,399
writing script uh the way they like and

301
00:11:42,399 --> 00:11:44,079
these the these commands can be

302
00:11:44,079 --> 00:11:45,760
indistinguishable from a legitimate

303
00:11:45,760 --> 00:11:48,240
administrator so the challenge here is

304
00:11:48,240 --> 00:11:51,120
to find the correct way to be able to

305
00:11:51,120 --> 00:11:53,279
aggregate them and sometimes the tools

306
00:11:53,279 --> 00:11:56,480
don't offer that but is a very nice way

307
00:11:56,480 --> 00:11:58,880
to be able to to detect this kind of

308
00:11:58,880 --> 00:12:01,440
stuff if you find a way to aggregate

309
00:12:01,440 --> 00:12:02,160
and

310
00:12:02,160 --> 00:12:04,240
uh one of the best thing i've found is

311
00:12:04,240 --> 00:12:07,120
to to baseline your administrators at

312
00:12:07,120 --> 00:12:08,560
least if you can

313
00:12:08,560 --> 00:12:10,240
so

314
00:12:10,240 --> 00:12:11,760
one of one of the cool ways that the

315
00:12:11,760 --> 00:12:13,760
different report always starts off is if

316
00:12:13,760 --> 00:12:16,880
you will see that anal test cmd net

317
00:12:16,880 --> 00:12:18,000
and uh

318
00:12:18,000 --> 00:12:21,120
and the liking of those commands and uh

319
00:12:21,120 --> 00:12:22,880
if you can baseline them

320
00:12:22,880 --> 00:12:24,880
i believe you can find a lot of good

321
00:12:24,880 --> 00:12:26,720
stuff so

322
00:12:26,720 --> 00:12:28,000
that's a really good point because like

323
00:12:28,000 --> 00:12:29,519
i don't know how many admin like like

324
00:12:29,519 --> 00:12:31,519
you said like a lot of this might look

325
00:12:31,519 --> 00:12:33,600
very you know very common but like

326
00:12:33,600 --> 00:12:35,120
there's probably like depending on your

327
00:12:35,120 --> 00:12:36,959
environment like your admin might not be

328
00:12:36,959 --> 00:12:38,480
running like register of 32 like that

329
00:12:38,480 --> 00:12:40,160
just might or especially like connected

330
00:12:40,160 --> 00:12:42,320
to a download cradle and that kind of

331
00:12:42,320 --> 00:12:43,839
timeline but i think that's one of those

332
00:12:43,839 --> 00:12:44,959
things where

333
00:12:44,959 --> 00:12:46,800
like you said it's not necessarily like

334
00:12:46,800 --> 00:12:48,240
looking at the intel you're not going to

335
00:12:48,240 --> 00:12:50,320
be able to just like 100 drill on those

336
00:12:50,320 --> 00:12:51,519
it's really one of those opportunities

337
00:12:51,519 --> 00:12:53,040
you have to go and like apply it and

338
00:12:53,040 --> 00:12:54,240
learn which is

339
00:12:54,240 --> 00:12:56,000
um you know obviously a struggle but in

340
00:12:56,000 --> 00:12:58,240
the end like you said it's gonna pay off

341
00:12:58,240 --> 00:13:00,800
in terms of taking things that are very

342
00:13:00,800 --> 00:13:03,200
common and potentially benign and

343
00:13:03,200 --> 00:13:04,800
contextualizing them with you know

344
00:13:04,800 --> 00:13:07,839
actual data

345
00:13:11,440 --> 00:13:14,399
absolutely um

346
00:13:15,839 --> 00:13:16,800
as well

347
00:13:16,800 --> 00:13:18,560
you already

348
00:13:18,560 --> 00:13:20,959
you all spoke about you know aggregating

349
00:13:20,959 --> 00:13:23,200
those

350
00:13:23,200 --> 00:13:25,839
discovery commands we see them a lot

351
00:13:25,839 --> 00:13:28,240
across many reports

352
00:13:28,240 --> 00:13:30,079
um we see them

353
00:13:30,079 --> 00:13:31,920
from malware

354
00:13:31,920 --> 00:13:34,160
on the initial infection

355
00:13:34,160 --> 00:13:36,160
the first thing that we do usually is

356
00:13:36,160 --> 00:13:38,560
taking information about where they have

357
00:13:38,560 --> 00:13:40,480
landed and

358
00:13:40,480 --> 00:13:42,560
sending them over to the command control

359
00:13:42,560 --> 00:13:43,519
server

360
00:13:43,519 --> 00:13:46,639
and but we also see them later on on

361
00:13:46,639 --> 00:13:48,720
post exploitation where

362
00:13:48,720 --> 00:13:52,000
they have cobble strike beacons and

363
00:13:52,000 --> 00:13:54,800
they are using aggressor scripts for

364
00:13:54,800 --> 00:13:56,480
global strike to

365
00:13:56,480 --> 00:13:58,720
um

366
00:13:59,199 --> 00:14:01,920
in an automated fashion we have seen

367
00:14:01,920 --> 00:14:03,440
this with

368
00:14:03,440 --> 00:14:05,199
through the coding links for example we

369
00:14:05,199 --> 00:14:06,399
have

370
00:14:06,399 --> 00:14:08,160
we have seen them how they have

371
00:14:08,160 --> 00:14:10,560
everything documented and

372
00:14:10,560 --> 00:14:13,600
the operators many many times

373
00:14:13,600 --> 00:14:15,680
behind the keyboard

374
00:14:15,680 --> 00:14:16,959
are just

375
00:14:16,959 --> 00:14:17,839
you know

376
00:14:17,839 --> 00:14:20,240
running scripts um they're just pressing

377
00:14:20,240 --> 00:14:22,079
buttons they are not

378
00:14:22,079 --> 00:14:24,239
as

379
00:14:24,320 --> 00:14:26,720
maybe maybe they are not as

380
00:14:26,720 --> 00:14:30,360
as good as

381
00:14:34,160 --> 00:14:36,079
mentioned she

382
00:14:36,079 --> 00:14:38,000
he does

383
00:14:38,000 --> 00:14:41,519
you know they are avoiding this

384
00:14:42,240 --> 00:14:44,079
their focus is just to collect the

385
00:14:44,079 --> 00:14:46,079
information and they don't

386
00:14:46,079 --> 00:14:48,160
they don't mind about the noise

387
00:14:48,160 --> 00:14:51,279
they they will do and uh we can take

388
00:14:51,279 --> 00:14:53,760
advantage of that and detect on these

389
00:14:53,760 --> 00:14:56,399
discovery commands i would say

390
00:14:56,399 --> 00:14:58,480
i would say within seconds we even with

391
00:14:58,480 --> 00:15:00,480
it within two seconds if you see

392
00:15:00,480 --> 00:15:02,560
commands that's net the dxe and l test

393
00:15:02,560 --> 00:15:04,079
dxe who am i

394
00:15:04,079 --> 00:15:06,160
running within two seconds

395
00:15:06,160 --> 00:15:08,560
um of course you will have baseline as

396
00:15:08,560 --> 00:15:11,279
now said uh your environment but if you

397
00:15:11,279 --> 00:15:13,519
see those commands run

398
00:15:13,519 --> 00:15:15,440
it's a it's a very good indication to at

399
00:15:15,440 --> 00:15:18,720
least start digging data

400
00:15:22,079 --> 00:15:23,360
one of the other things that stands out

401
00:15:23,360 --> 00:15:25,519
in this report i guess to me

402
00:15:25,519 --> 00:15:26,560
is that

403
00:15:26,560 --> 00:15:28,480
some of these cobalt story profiles are

404
00:15:28,480 --> 00:15:30,560
the default jquery profile that's

405
00:15:30,560 --> 00:15:33,680
published to github so

406
00:15:33,680 --> 00:15:35,040
obviously there's a trend with a lot of

407
00:15:35,040 --> 00:15:36,320
people just pulling things straight off

408
00:15:36,320 --> 00:15:37,920
the internet and running them but if you

409
00:15:37,920 --> 00:15:39,120
were going to invest some time in

410
00:15:39,120 --> 00:15:40,800
running some detection rules right

411
00:15:40,800 --> 00:15:42,880
trying to write them for every single

412
00:15:42,880 --> 00:15:44,240
cobalt strike profile that's out there

413
00:15:44,240 --> 00:15:45,600
if you're able to look at proxy traffic

414
00:15:45,600 --> 00:15:47,680
might be a you know a waste of time

415
00:15:47,680 --> 00:15:49,920
however these jquery profiles are

416
00:15:49,920 --> 00:15:51,920
extremely common in these and

417
00:15:51,920 --> 00:15:53,199
it's a good place if you're going to

418
00:15:53,199 --> 00:15:54,639
build you know a couple detections i

419
00:15:54,639 --> 00:15:56,720
think i would jump in and focus on these

420
00:15:56,720 --> 00:15:58,160
because a lot of these are defaults that

421
00:15:58,160 --> 00:15:59,759
don't get changed at all

422
00:15:59,759 --> 00:16:00,880
you're going to keep using them because

423
00:16:00,880 --> 00:16:02,800
they work uh the other other thing like

424
00:16:02,800 --> 00:16:05,279
to xena's our cheerios old point was

425
00:16:05,279 --> 00:16:06,399
about time i thought was really

426
00:16:06,399 --> 00:16:08,160
interesting is looking at the timeline

427
00:16:08,160 --> 00:16:09,199
like

428
00:16:09,199 --> 00:16:11,519
a lot of this is stuff that it seems

429
00:16:11,519 --> 00:16:12,959
like like we can probably just speculate

430
00:16:12,959 --> 00:16:14,320
it's probably easier like you know

431
00:16:14,320 --> 00:16:16,160
commonly to detect but it looks like the

432
00:16:16,160 --> 00:16:17,839
adversary also had a really good idea of

433
00:16:17,839 --> 00:16:19,920
like pattern of life where like the um

434
00:16:19,920 --> 00:16:22,240
my utc math might be terrible but it

435
00:16:22,240 --> 00:16:23,680
looks like they were kind of later in

436
00:16:23,680 --> 00:16:24,560
the day

437
00:16:24,560 --> 00:16:26,399
playing exactly to that point where you

438
00:16:26,399 --> 00:16:28,320
know you know all this detection all

439
00:16:28,320 --> 00:16:31,120
this response is overlaid with like life

440
00:16:31,120 --> 00:16:32,639
so like this is probably like night

441
00:16:32,639 --> 00:16:34,160
shift and they're tired you know they're

442
00:16:34,160 --> 00:16:35,360
probably eating dinner and stuff and

443
00:16:35,360 --> 00:16:37,199
then like this is all happening the same

444
00:16:37,199 --> 00:16:38,800
time so they're kind of you know exactly

445
00:16:38,800 --> 00:16:40,880
that point the you know artifacts and

446
00:16:40,880 --> 00:16:42,000
their activities probably being

447
00:16:42,000 --> 00:16:43,120
collected

448
00:16:43,120 --> 00:16:44,880
but is it being acted on and you know

449
00:16:44,880 --> 00:16:46,959
how do we what lessons can we learn to

450
00:16:46,959 --> 00:16:49,120
kind of apply towards you know our

451
00:16:49,120 --> 00:16:50,800
adversaries are gonna you know think

452
00:16:50,800 --> 00:16:52,720
about you know what we you know the nine

453
00:16:52,720 --> 00:16:54,399
to five kind of pattern and maybe try to

454
00:16:54,399 --> 00:16:57,199
take advantage of that

455
00:16:58,399 --> 00:17:01,199
yeah definitely and then also too just

456
00:17:01,199 --> 00:17:02,880
out of curiosity you know if you're

457
00:17:02,880 --> 00:17:04,799
trying to operationalize this in the

458
00:17:04,799 --> 00:17:07,760
environment you know i know um from my

459
00:17:07,760 --> 00:17:09,359
from my understanding and some of the

460
00:17:09,359 --> 00:17:11,760
stuff that i've had exposure to there's

461
00:17:11,760 --> 00:17:14,640
generally really good detections around

462
00:17:14,640 --> 00:17:17,919
like lsas.exe and and you know elsas

463
00:17:17,919 --> 00:17:19,919
access and all of that but

464
00:17:19,919 --> 00:17:21,280
and uh

465
00:17:21,280 --> 00:17:23,520
like how would you you know out of all

466
00:17:23,520 --> 00:17:25,280
the things you know justin made a really

467
00:17:25,280 --> 00:17:27,119
good point about the

468
00:17:27,119 --> 00:17:30,480
uh default cobalt strike uh

469
00:17:30,480 --> 00:17:31,440
you know

470
00:17:31,440 --> 00:17:34,160
but i think um even with that right so

471
00:17:34,160 --> 00:17:37,120
cobalt strike is is is uh was really

472
00:17:37,120 --> 00:17:39,039
popular is still popular with some of

473
00:17:39,039 --> 00:17:41,200
the threat actors so there were already

474
00:17:41,200 --> 00:17:44,080
a lot of detections already available or

475
00:17:44,080 --> 00:17:46,559
created or pushed out by vendors

476
00:17:46,559 --> 00:17:48,720
so if you take away the things that

477
00:17:48,720 --> 00:17:49,840
you're

478
00:17:49,840 --> 00:17:51,440
fairly confident you know you ran a

479
00:17:51,440 --> 00:17:53,679
purple team or you had a red team test

480
00:17:53,679 --> 00:17:56,000
it and the lsas you know and then you

481
00:17:56,000 --> 00:17:58,080
have cobbled strike and that the default

482
00:17:58,080 --> 00:18:01,360
got detected so then so then now what so

483
00:18:01,360 --> 00:18:02,799
you go through it and you're like all

484
00:18:02,799 --> 00:18:05,360
right i'm i'm pretty solid that uh we

485
00:18:05,360 --> 00:18:08,080
have these type of detections like where

486
00:18:08,080 --> 00:18:10,320
would you focus your energy or effort at

487
00:18:10,320 --> 00:18:12,880
least specifically for this report that

488
00:18:12,880 --> 00:18:16,240
is not ioc based

489
00:18:23,120 --> 00:18:24,320
i think we

490
00:18:24,320 --> 00:18:26,320
try to provide

491
00:18:26,320 --> 00:18:28,799
a lot of detection opportunities with uh

492
00:18:28,799 --> 00:18:29,840
every

493
00:18:29,840 --> 00:18:32,320
technique

494
00:18:33,120 --> 00:18:37,120
every technique we are mentioning um

495
00:18:37,120 --> 00:18:39,200
we try to make sure that we highlight

496
00:18:39,200 --> 00:18:42,799
the individual event ids for security

497
00:18:42,799 --> 00:18:45,360
event logs for example um if the

498
00:18:45,360 --> 00:18:47,919
organization is using system

499
00:18:47,919 --> 00:18:51,200
we also have one

500
00:18:51,760 --> 00:18:54,720
for the individual event ids that

501
00:18:54,720 --> 00:18:57,120
someone could look into

502
00:18:57,120 --> 00:18:59,120
but

503
00:18:59,120 --> 00:19:01,120
all these come with um

504
00:19:01,120 --> 00:19:03,200
with some requirements

505
00:19:03,200 --> 00:19:04,880
which are

506
00:19:04,880 --> 00:19:07,760
the organization will have to have

507
00:19:07,760 --> 00:19:09,679
all these local mobiles

508
00:19:09,679 --> 00:19:13,039
and they will have to

509
00:19:13,280 --> 00:19:15,520
do a good job at aggregating all these

510
00:19:15,520 --> 00:19:20,160
logs into a central place for um

511
00:19:20,320 --> 00:19:23,760
to look over them or to create rules

512
00:19:23,760 --> 00:19:25,120
yes

513
00:19:25,120 --> 00:19:27,919
an easy way would be to get one of the

514
00:19:27,919 --> 00:19:29,360
leading aheads

515
00:19:29,360 --> 00:19:32,400
in the ar process but

516
00:19:32,400 --> 00:19:34,720
and let's be honest not every

517
00:19:34,720 --> 00:19:37,679
organization can do that and

518
00:19:37,679 --> 00:19:40,480
not every organization has the

519
00:19:40,480 --> 00:19:41,440
uh

520
00:19:41,440 --> 00:19:45,120
the resources to do that so

521
00:19:45,120 --> 00:19:46,880
i believe um

522
00:19:46,880 --> 00:19:47,840
the

523
00:19:47,840 --> 00:19:49,760
administrators

524
00:19:49,760 --> 00:19:53,200
could just enable those those

525
00:19:53,200 --> 00:19:55,760
logs into the environment

526
00:19:55,760 --> 00:19:57,280
and

527
00:19:57,280 --> 00:19:58,090
try to

528
00:19:58,090 --> 00:20:00,559
[Music]

529
00:20:00,559 --> 00:20:02,480
try to have them in one central place to

530
00:20:02,480 --> 00:20:05,679
create some basic rules i know even that

531
00:20:05,679 --> 00:20:08,000
it's a little bit uh hard

532
00:20:08,000 --> 00:20:08,960
um

533
00:20:08,960 --> 00:20:11,280
to do in a small

534
00:20:11,280 --> 00:20:14,000
businesses mostly but

535
00:20:14,000 --> 00:20:16,240
yeah there are some requirements needed

536
00:20:16,240 --> 00:20:17,600
um

537
00:20:17,600 --> 00:20:20,240
but we try to make sure that we provide

538
00:20:20,240 --> 00:20:23,200
detection opportunities for

539
00:20:23,200 --> 00:20:24,480
most of the techniques that we are

540
00:20:24,480 --> 00:20:25,679
mentioning

541
00:20:25,679 --> 00:20:28,480
we have the sigma rules that

542
00:20:28,480 --> 00:20:31,919
one can go and read but one will have to

543
00:20:31,919 --> 00:20:35,360
learn how sigma works

544
00:20:35,360 --> 00:20:38,720
and and then we have as simple as we can

545
00:20:38,720 --> 00:20:39,760
put it

546
00:20:39,760 --> 00:20:42,159
explaining the technique and what are

547
00:20:42,159 --> 00:20:43,919
the artifacts that this technique

548
00:20:43,919 --> 00:20:45,120
generates

549
00:20:45,120 --> 00:20:46,640
and what

550
00:20:46,640 --> 00:20:50,159
what people should be looking for

551
00:20:50,400 --> 00:20:53,120
yeah and actually if i might jump in

552
00:20:53,120 --> 00:20:55,280
this report contains a lot of uh command

553
00:20:55,280 --> 00:20:57,760
line execution which i'm a big fan of

554
00:20:57,760 --> 00:21:00,000
even if they can be bypassed as we all

555
00:21:00,000 --> 00:21:01,039
know

556
00:21:01,039 --> 00:21:03,200
but but uh this report

557
00:21:03,200 --> 00:21:05,840
proves a very good thing is that even if

558
00:21:05,840 --> 00:21:07,600
you don't have the very latest

559
00:21:07,600 --> 00:21:10,880
technologies as costa said if you enable

560
00:21:10,880 --> 00:21:12,720
for example process monitoring process

561
00:21:12,720 --> 00:21:14,640
command by monitoring you can get a lot

562
00:21:14,640 --> 00:21:16,799
of a lot of

563
00:21:16,799 --> 00:21:18,720
detections out of this report for

564
00:21:18,720 --> 00:21:21,360
example one of the things that's really

565
00:21:21,360 --> 00:21:23,440
stuck out is the

566
00:21:23,440 --> 00:21:25,200
when the threat actor is using for

567
00:21:25,200 --> 00:21:26,240
example

568
00:21:26,240 --> 00:21:27,679
the

569
00:21:27,679 --> 00:21:30,159
this this script to copy stuff from the

570
00:21:30,159 --> 00:21:32,559
c user's public folder or into the c

571
00:21:32,559 --> 00:21:34,320
users directly

572
00:21:34,320 --> 00:21:36,080
which is a very common thing because

573
00:21:36,080 --> 00:21:38,480
it's a publicly access folder

574
00:21:38,480 --> 00:21:39,760
so

575
00:21:39,760 --> 00:21:41,679
that would be one thing to focus on for

576
00:21:41,679 --> 00:21:43,919
example which is suspicious folder that

577
00:21:43,919 --> 00:21:47,039
attackers are used to execute stuff from

578
00:21:47,039 --> 00:21:49,280
so we know that updates are local or

579
00:21:49,280 --> 00:21:51,760
users public are very known to be used

580
00:21:51,760 --> 00:21:54,240
for these kind of things so one thing

581
00:21:54,240 --> 00:21:54,960
that

582
00:21:54,960 --> 00:21:58,159
any analyst to be honest can you with a

583
00:21:58,159 --> 00:21:59,679
little bit of effort if they have the

584
00:21:59,679 --> 00:22:02,240
log is to focus on suspicious locations

585
00:22:02,240 --> 00:22:05,360
and this report have a lot of those so

586
00:22:05,360 --> 00:22:07,360
that would be a very good place to start

587
00:22:07,360 --> 00:22:08,960
at least and then we can focus for

588
00:22:08,960 --> 00:22:09,919
example

589
00:22:09,919 --> 00:22:11,520
on the ability

590
00:22:11,520 --> 00:22:14,559
to to to to detect for example dll host

591
00:22:14,559 --> 00:22:16,640
without any command line or svc host

592
00:22:16,640 --> 00:22:18,960
without any command line which are very

593
00:22:18,960 --> 00:22:21,039
red flags let's say

594
00:22:21,039 --> 00:22:23,679
that attackers sometimes forget

595
00:22:23,679 --> 00:22:25,760
and i believe those are a very good

596
00:22:25,760 --> 00:22:27,600
starting place yeah

597
00:22:27,600 --> 00:22:29,600
oh that's wonderful and funny that you

598
00:22:29,600 --> 00:22:31,679
mentioned that there's there happens to

599
00:22:31,679 --> 00:22:34,640
be a really great write-up that you did

600
00:22:34,640 --> 00:22:36,240
on it

601
00:22:36,240 --> 00:22:37,360
and so

602
00:22:37,360 --> 00:22:39,840
with that we will move to the next

603
00:22:39,840 --> 00:22:41,200
report

604
00:22:41,200 --> 00:22:44,400
um let me start the timer again

605
00:22:44,400 --> 00:22:46,400
uh let's see

606
00:22:46,400 --> 00:22:49,280
and the second report that we have

607
00:22:49,280 --> 00:22:50,960
is uh

608
00:22:50,960 --> 00:22:52,320
let's see

609
00:22:52,320 --> 00:22:54,559
is the um

610
00:22:54,559 --> 00:22:58,000
gootkit one and gootloader would anyone

611
00:22:58,000 --> 00:23:00,000
be interested in talking about how they

612
00:23:00,000 --> 00:23:02,320
would operationalize this or maybe give

613
00:23:02,320 --> 00:23:03,840
a tip for

614
00:23:03,840 --> 00:23:06,159
new analysts in the industry of how they

615
00:23:06,159 --> 00:23:09,840
would review this particular report

616
00:23:12,400 --> 00:23:15,440
i can go ahead um so the like you know

617
00:23:15,440 --> 00:23:17,120
just kind of walking through

618
00:23:17,120 --> 00:23:18,880
the my process at least and hopefully

619
00:23:18,880 --> 00:23:20,159
this is helpful

620
00:23:20,159 --> 00:23:22,960
for new to even seasoned analyst is you

621
00:23:22,960 --> 00:23:24,559
know look for things that you know

622
00:23:24,559 --> 00:23:26,400
you're you're already doing in the

623
00:23:26,400 --> 00:23:28,000
basically you know as we're basically

624
00:23:28,000 --> 00:23:29,120
describing

625
00:23:29,120 --> 00:23:30,720
try to see yourself in this report like

626
00:23:30,720 --> 00:23:32,880
how do i how do i like stack up against

627
00:23:32,880 --> 00:23:34,240
this in terms of the where are my

628
00:23:34,240 --> 00:23:35,679
strengths you know mention like command

629
00:23:35,679 --> 00:23:38,240
line logging or certain you know even

630
00:23:38,240 --> 00:23:39,280
identifying weaknesses from the

631
00:23:39,280 --> 00:23:40,640
adversary in terms of things that they

632
00:23:40,640 --> 00:23:42,080
can't control in terms of events that

633
00:23:42,080 --> 00:23:43,919
might be produced or

634
00:23:43,919 --> 00:23:45,039
situational things like they're going to

635
00:23:45,039 --> 00:23:46,480
be putting

636
00:23:46,480 --> 00:23:48,400
payloads in certain file types based on

637
00:23:48,400 --> 00:23:51,279
access so basically figure out where or

638
00:23:51,279 --> 00:23:53,520
where's my best opportunity to detect

639
00:23:53,520 --> 00:23:55,440
but also i think what this report really

640
00:23:55,440 --> 00:23:56,640
highlighted that that was interesting

641
00:23:56,640 --> 00:23:58,880
was new ideas that i haven't considered

642
00:23:58,880 --> 00:24:00,640
like a good loader for example it's like

643
00:24:00,640 --> 00:24:02,640
okay like you know this problem is not

644
00:24:02,640 --> 00:24:04,960
necessarily directly in my space now i

645
00:24:04,960 --> 00:24:06,480
have to start thinking about you know

646
00:24:06,480 --> 00:24:08,320
what adversaries are doing before they

647
00:24:08,320 --> 00:24:10,880
even contact me like this seo poisoning

648
00:24:10,880 --> 00:24:12,400
i have to start worrying about you know

649
00:24:12,400 --> 00:24:14,880
that from an external threat perspective

650
00:24:14,880 --> 00:24:16,240
um two other things that really stood

651
00:24:16,240 --> 00:24:17,039
out to me and i love that you

652
00:24:17,039 --> 00:24:18,400
highlighted it really well in the report

653
00:24:18,400 --> 00:24:19,520
was

654
00:24:19,520 --> 00:24:20,400
um

655
00:24:20,400 --> 00:24:22,240
the javascript that was really cool to

656
00:24:22,240 --> 00:24:24,960
me the you know not necessarily you know

657
00:24:24,960 --> 00:24:26,559
i need to do everything by myself but

658
00:24:26,559 --> 00:24:27,919
there's a lot of resources out there in

659
00:24:27,919 --> 00:24:29,679
terms of you know microsoft already

660
00:24:29,679 --> 00:24:31,520
provides the means to maybe prevent

661
00:24:31,520 --> 00:24:33,679
javascript from you know downloading

662
00:24:33,679 --> 00:24:35,760
malicious files or executing those

663
00:24:35,760 --> 00:24:37,679
there's a lot of resources there but

664
00:24:37,679 --> 00:24:40,960
also uh my big kind of intel nerd uh

665
00:24:40,960 --> 00:24:43,120
lens every time i read a new report is

666
00:24:43,120 --> 00:24:44,480
what have i learned from this is

667
00:24:44,480 --> 00:24:46,400
something i've never like picked up on

668
00:24:46,400 --> 00:24:48,559
and the for this one for me was the what

669
00:24:48,559 --> 00:24:50,720
restricted admin like i'd never seen

670
00:24:50,720 --> 00:24:53,120
that but like conceptualizing that you

671
00:24:53,120 --> 00:24:54,880
know and seeing that that's a really

672
00:24:54,880 --> 00:24:57,120
good detection opportunity that you know

673
00:24:57,120 --> 00:24:58,840
i can't i'm depending on your

674
00:24:58,840 --> 00:25:01,120
environment there might be situations

675
00:25:01,120 --> 00:25:03,279
where you know that might be real but

676
00:25:03,279 --> 00:25:05,679
imagine you know just like just hunch

677
00:25:05,679 --> 00:25:07,039
would be a lot of environments that's

678
00:25:07,039 --> 00:25:08,960
going to stand out as like probably

679
00:25:08,960 --> 00:25:10,559
abuse and that's a really good detection

680
00:25:10,559 --> 00:25:11,840
opportunity that you can kind of add to

681
00:25:11,840 --> 00:25:14,640
your repository of things that you can

682
00:25:14,640 --> 00:25:15,679
detect

683
00:25:15,679 --> 00:25:17,520
maybe at scale with you know high

684
00:25:17,520 --> 00:25:19,520
confidence so you know that's that's

685
00:25:19,520 --> 00:25:21,520
kind of my lens in terms of you know

686
00:25:21,520 --> 00:25:23,679
seeing myself in the report but also

687
00:25:23,679 --> 00:25:25,520
teasing out you know where my best

688
00:25:25,520 --> 00:25:27,440
opportunities to actually

689
00:25:27,440 --> 00:25:30,000
affect this

690
00:25:30,640 --> 00:25:32,799
yeah thank you jamie and i just wanted

691
00:25:32,799 --> 00:25:34,559
to point out you know

692
00:25:34,559 --> 00:25:36,159
these reports at the end they were

693
00:25:36,159 --> 00:25:38,159
talking about uh there's there's usually

694
00:25:38,159 --> 00:25:39,520
sigma rules

695
00:25:39,520 --> 00:25:42,400
so one really great resource that i saw

696
00:25:42,400 --> 00:25:45,120
because um not every organization has

697
00:25:45,120 --> 00:25:47,520
sigma right they have different things

698
00:25:47,520 --> 00:25:49,919
so you can grab the sigma rule and you

699
00:25:49,919 --> 00:25:52,320
can use uncoder io

700
00:25:52,320 --> 00:25:54,320
and you can translate

701
00:25:54,320 --> 00:25:57,039
this into a search you have to modify it

702
00:25:57,039 --> 00:25:58,799
though because it doesn't get everything

703
00:25:58,799 --> 00:25:59,679
right

704
00:25:59,679 --> 00:26:02,400
um but you can you can modify the search

705
00:26:02,400 --> 00:26:04,240
and i believe crowdstrike is one of the

706
00:26:04,240 --> 00:26:07,279
top edr's that are used across uh just

707
00:26:07,279 --> 00:26:10,000
period so i use that one as an example

708
00:26:10,000 --> 00:26:11,760
but they have other languages that you

709
00:26:11,760 --> 00:26:13,600
can translate it to and make this a

710
00:26:13,600 --> 00:26:16,240
little bit easier to operationalize for

711
00:26:16,240 --> 00:26:19,520
people that might not have sigma rules

712
00:26:19,520 --> 00:26:22,159
so i wanted to point that out and jamie

713
00:26:22,159 --> 00:26:25,120
made a great point about seo poisoning

714
00:26:25,120 --> 00:26:27,120
um especially with that like

715
00:26:27,120 --> 00:26:29,919
malvertising is kind of a big deal from

716
00:26:29,919 --> 00:26:32,000
my perspective as far as actors being

717
00:26:32,000 --> 00:26:34,880
able to utilize that so if you don't

718
00:26:34,880 --> 00:26:37,919
need you know ad network access for your

719
00:26:37,919 --> 00:26:40,799
just users like why not block it in the

720
00:26:40,799 --> 00:26:43,200
proxy right anything that's categorized

721
00:26:43,200 --> 00:26:45,440
as that so that's also something to

722
00:26:45,440 --> 00:26:48,080
consider to try to get this

723
00:26:48,080 --> 00:26:49,840
uh before

724
00:26:49,840 --> 00:26:51,600
you know maybe not this one since it's

725
00:26:51,600 --> 00:26:53,600
seo poisoning but it makes me think

726
00:26:53,600 --> 00:26:55,679
about other things too of like what am i

727
00:26:55,679 --> 00:26:58,880
missing out and what can i ensure that i

728
00:26:58,880 --> 00:27:00,480
that i can implement within my

729
00:27:00,480 --> 00:27:02,720
organization to protect not just from

730
00:27:02,720 --> 00:27:05,039
this one but other like similar

731
00:27:05,039 --> 00:27:06,960
techniques whether that's malvertising

732
00:27:06,960 --> 00:27:09,360
that's used to deliver malware or seo

733
00:27:09,360 --> 00:27:12,159
poisoning or other other avenues

734
00:27:12,159 --> 00:27:15,279
um so for the newer analysts do you have

735
00:27:15,279 --> 00:27:17,679
does anyone have any suggestions

736
00:27:17,679 --> 00:27:20,240
for newer analysts like anna like taking

737
00:27:20,240 --> 00:27:21,440
a look at this

738
00:27:21,440 --> 00:27:23,520
like where would you suggest they start

739
00:27:23,520 --> 00:27:26,480
diving into this

740
00:27:28,159 --> 00:27:29,840
so one thing i was just going to throw

741
00:27:29,840 --> 00:27:31,279
out there is that

742
00:27:31,279 --> 00:27:33,200
they run invoke bloodhound with

743
00:27:33,200 --> 00:27:35,279
collection method all very early

744
00:27:35,279 --> 00:27:37,440
in this assessment which is extremely

745
00:27:37,440 --> 00:27:39,360
noisy from getting session data and

746
00:27:39,360 --> 00:27:41,760
doing a lot of different things so

747
00:27:41,760 --> 00:27:43,120
um i know everybody has different

748
00:27:43,120 --> 00:27:44,480
approach what they what they look for

749
00:27:44,480 --> 00:27:46,240
what they would go after but again this

750
00:27:46,240 --> 00:27:48,640
is another common trend across these and

751
00:27:48,640 --> 00:27:51,120
this collection method all is

752
00:27:51,120 --> 00:27:54,799
fairly noisy um compared to

753
00:27:54,799 --> 00:27:56,240
some of the other methods that people

754
00:27:56,240 --> 00:27:58,559
use so you know i hate building

755
00:27:58,559 --> 00:28:00,960
detections purely off of tools but this

756
00:28:00,960 --> 00:28:02,559
is one of those things that

757
00:28:02,559 --> 00:28:04,320
the amount of data and traffic it does

758
00:28:04,320 --> 00:28:06,480
and what it's looking for um

759
00:28:06,480 --> 00:28:09,120
is usually an indicator of something bad

760
00:28:09,120 --> 00:28:10,559
is happening specifically related to

761
00:28:10,559 --> 00:28:12,000
this tool

762
00:28:12,000 --> 00:28:14,640
okay and i found the invoke blood town

763
00:28:14,640 --> 00:28:18,159
with which y'all put in uh you decoded

764
00:28:18,159 --> 00:28:21,279
the powershell script using cyber chef

765
00:28:21,279 --> 00:28:22,880
and i just want to say something really

766
00:28:22,880 --> 00:28:25,200
quick about that like i love cyber chef

767
00:28:25,200 --> 00:28:27,919
it's super awesome for organizations the

768
00:28:27,919 --> 00:28:30,720
general recommendation is to try to get

769
00:28:30,720 --> 00:28:32,159
an in-house

770
00:28:32,159 --> 00:28:34,799
version of that stood up for your

771
00:28:34,799 --> 00:28:37,919
security analyst to be able to utilize

772
00:28:37,919 --> 00:28:40,159
um because as you can see it's very

773
00:28:40,159 --> 00:28:41,520
handy

774
00:28:41,520 --> 00:28:43,840
and that was a really great call out too

775
00:28:43,840 --> 00:28:45,760
as far as the noisiness of invoke

776
00:28:45,760 --> 00:28:49,039
bloodhound and honestly you know

777
00:28:49,039 --> 00:28:51,360
not being a red person you know like

778
00:28:51,360 --> 00:28:52,960
justin knows this and he has these

779
00:28:52,960 --> 00:28:55,440
really valuable insights so thank you

780
00:28:55,440 --> 00:28:57,360
very much for hearing that does anyone

781
00:28:57,360 --> 00:28:59,520
else have any input

782
00:28:59,520 --> 00:29:01,600
um and we'll move on to the next report

783
00:29:01,600 --> 00:29:03,600
just to catch up on time

784
00:29:03,600 --> 00:29:05,760
yeah well one one other thing that

785
00:29:05,760 --> 00:29:09,279
justin said is to not focus on the food

786
00:29:09,279 --> 00:29:11,039
and i don't like to focus on the truth

787
00:29:11,039 --> 00:29:12,960
except if they are famous but one

788
00:29:12,960 --> 00:29:15,679
interesting thing that a new analyst not

789
00:29:15,679 --> 00:29:17,840
so new but at least uh

790
00:29:17,840 --> 00:29:19,840
somewhat seasoned is to look at the

791
00:29:19,840 --> 00:29:21,039
tools from a

792
00:29:21,039 --> 00:29:23,840
a methodology perspective so for example

793
00:29:23,840 --> 00:29:26,000
instead of focusing on the command line

794
00:29:26,000 --> 00:29:27,760
or the technology but

795
00:29:27,760 --> 00:29:30,159
what what is the method being used and

796
00:29:30,159 --> 00:29:32,399
what are the things that will not change

797
00:29:32,399 --> 00:29:34,640
across tools for example in the case of

798
00:29:34,640 --> 00:29:35,760
bloodhound

799
00:29:35,760 --> 00:29:37,919
the method being used or for example in

800
00:29:37,919 --> 00:29:40,399
this report they use lazan which is used

801
00:29:40,399 --> 00:29:42,799
to to collect credentials for example

802
00:29:42,799 --> 00:29:44,880
instead of focusing on lazan for example

803
00:29:44,880 --> 00:29:47,120
focus on the ability to read specific

804
00:29:47,120 --> 00:29:49,039
files from google chrome or firefox

805
00:29:49,039 --> 00:29:51,039
folders which would be more interesting

806
00:29:51,039 --> 00:29:52,640
to to see if

807
00:29:52,640 --> 00:29:54,720
if if attackers are collecting those

808
00:29:54,720 --> 00:29:56,480
credentials instead of focusing on the

809
00:29:56,480 --> 00:29:59,279
tool so that would be an interesting for

810
00:29:59,279 --> 00:30:01,200
new newer analysts and even seasoned

811
00:30:01,200 --> 00:30:04,159
eyes so spectre ops have a

812
00:30:04,159 --> 00:30:06,159
a methodology called i believe

813
00:30:06,159 --> 00:30:08,559
capability abstraction which is very

814
00:30:08,559 --> 00:30:11,440
good in explaining this concept so that

815
00:30:11,440 --> 00:30:14,000
that would be a at least a medium place

816
00:30:14,000 --> 00:30:15,279
to start

817
00:30:15,279 --> 00:30:16,320
yeah

818
00:30:16,320 --> 00:30:18,240
oh wonderful okay thank you very much

819
00:30:18,240 --> 00:30:20,159
for that insight too

820
00:30:20,159 --> 00:30:23,120
uh so now okay

821
00:30:23,120 --> 00:30:25,039
can i have one one thing here though as

822
00:30:25,039 --> 00:30:26,720
well for this one i think is interesting

823
00:30:26,720 --> 00:30:27,679
uh

824
00:30:27,679 --> 00:30:29,440
uh since they are they want to have

825
00:30:29,440 --> 00:30:31,039
persistence as well which we haven't

826
00:30:31,039 --> 00:30:32,399
focused on yet

827
00:30:32,399 --> 00:30:34,880
and in this one case they use sort of a

828
00:30:34,880 --> 00:30:38,480
base64 encoded stuff a scheduled task

829
00:30:38,480 --> 00:30:40,799
and that's sort of yeah that's it's very

830
00:30:40,799 --> 00:30:42,559
rare that you have something

831
00:30:42,559 --> 00:30:44,399
something uh

832
00:30:44,399 --> 00:30:46,880
valid that should be base64 encoded as a

833
00:30:46,880 --> 00:30:48,159
scheduled task

834
00:30:48,159 --> 00:30:51,039
it's also like uh focus on the

835
00:30:51,039 --> 00:30:52,399
persistence part as well sort of the

836
00:30:52,399 --> 00:30:55,039
next next stage of the

837
00:30:55,039 --> 00:30:57,279
intrusion

838
00:30:57,279 --> 00:30:59,039
oh wonderful that's a really great call

839
00:30:59,039 --> 00:31:00,320
out too

840
00:31:00,320 --> 00:31:01,519
um

841
00:31:01,519 --> 00:31:04,960
so now let me reset the timer

842
00:31:04,960 --> 00:31:06,399
i'll say while we're waiting i do

843
00:31:06,399 --> 00:31:09,279
appreciate the live demos so uh

844
00:31:09,279 --> 00:31:12,720
big big shout out to cheerio for driving

845
00:31:12,720 --> 00:31:14,960
oh

846
00:31:14,960 --> 00:31:17,919
let's see so eight minutes so now we

847
00:31:17,919 --> 00:31:21,360
will go to the year in review

848
00:31:21,360 --> 00:31:24,720
um and this one i picked so that y'all

849
00:31:24,720 --> 00:31:25,600
could

850
00:31:25,600 --> 00:31:27,360
could talk about how you would

851
00:31:27,360 --> 00:31:29,840
operationalize this so here's here's

852
00:31:29,840 --> 00:31:32,399
this two-fold right so you get these

853
00:31:32,399 --> 00:31:34,720
like strategic reports that are like you

854
00:31:34,720 --> 00:31:36,960
know oh persistence is important you

855
00:31:36,960 --> 00:31:38,480
know or whatever and

856
00:31:38,480 --> 00:31:41,039
uh the general you know a newer analyst

857
00:31:41,039 --> 00:31:43,279
might be like cool story bro like what

858
00:31:43,279 --> 00:31:44,799
do i do with this

859
00:31:44,799 --> 00:31:47,200
and so i was hoping it's it's kind of

860
00:31:47,200 --> 00:31:50,080
like the more experience and the more

861
00:31:50,080 --> 00:31:53,360
exposure and the more um you know

862
00:31:53,360 --> 00:31:55,039
variation that you have with your

863
00:31:55,039 --> 00:31:57,600
experience like you can see things from

864
00:31:57,600 --> 00:31:59,440
different angles like with jamie with

865
00:31:59,440 --> 00:32:01,440
your red to the to the purple and then

866
00:32:01,440 --> 00:32:03,919
the blue and then the red and uh with

867
00:32:03,919 --> 00:32:06,399
all the panelists so i was hoping that

868
00:32:06,399 --> 00:32:09,120
this would be able to inspire

869
00:32:09,120 --> 00:32:11,279
other analysts that even if you're given

870
00:32:11,279 --> 00:32:12,880
a chart like this

871
00:32:12,880 --> 00:32:15,120
or um

872
00:32:15,120 --> 00:32:17,039
or let's see there's another like this

873
00:32:17,039 --> 00:32:19,840
one right here the persistence methods

874
00:32:19,840 --> 00:32:22,399
of like any desk scheduled tasks which

875
00:32:22,399 --> 00:32:24,880
is kind of a big deal right like

876
00:32:24,880 --> 00:32:26,320
like

877
00:32:26,320 --> 00:32:28,080
some people might just look over this

878
00:32:28,080 --> 00:32:29,840
and be like you know

879
00:32:29,840 --> 00:32:31,039
don't care

880
00:32:31,039 --> 00:32:33,519
but i'm saying like i feel like there

881
00:32:33,519 --> 00:32:35,519
could be some value in this you know

882
00:32:35,519 --> 00:32:38,080
like do you know your posture regarding

883
00:32:38,080 --> 00:32:39,840
any desk is it allowed on your end

884
00:32:39,840 --> 00:32:42,960
points like is it anomalous like you

885
00:32:42,960 --> 00:32:44,720
know just getting them to start thinking

886
00:32:44,720 --> 00:32:48,399
about how i can make use of this

887
00:32:48,399 --> 00:32:51,279
information that's more at a high level

888
00:32:51,279 --> 00:32:54,720
um so if anyone has any like tips of how

889
00:32:54,720 --> 00:32:56,640
they look at these reports or how they

890
00:32:56,640 --> 00:32:58,799
operationalize them whether you know

891
00:32:58,799 --> 00:33:01,360
this is just one of one of many examples

892
00:33:01,360 --> 00:33:03,519
like there's the um

893
00:33:03,519 --> 00:33:06,159
there's the verizon dbir is another good

894
00:33:06,159 --> 00:33:08,240
example or like the annual ransomware

895
00:33:08,240 --> 00:33:10,640
reports that come out sometimes

896
00:33:10,640 --> 00:33:12,399
um you know and they're like oh they use

897
00:33:12,399 --> 00:33:15,120
these tools and it's like okay uh you

898
00:33:15,120 --> 00:33:17,840
know teamviewer splashtop

899
00:33:17,840 --> 00:33:19,279
a tara

900
00:33:19,279 --> 00:33:20,080
um

901
00:33:20,080 --> 00:33:22,159
so please if anyone has any comments or

902
00:33:22,159 --> 00:33:24,640
thoughts on this like share away i think

903
00:33:24,640 --> 00:33:26,480
i'm we we kind of go with the exactly

904
00:33:26,480 --> 00:33:28,000
because as you said like every one of

905
00:33:28,000 --> 00:33:29,679
those reports and kind of big summaries

906
00:33:29,679 --> 00:33:30,960
is going to have their own perspective

907
00:33:30,960 --> 00:33:33,120
their own biases but you know exactly

908
00:33:33,120 --> 00:33:35,600
you said a really good exercise is we

909
00:33:35,600 --> 00:33:37,120
all have our priorities like there's

910
00:33:37,120 --> 00:33:39,440
only so many resources we can deploy so

911
00:33:39,440 --> 00:33:40,880
we have to make decisions in terms of

912
00:33:40,880 --> 00:33:42,720
what we focus on so being able to align

913
00:33:42,720 --> 00:33:43,919
with something like this is really

914
00:33:43,919 --> 00:33:46,720
powerful in terms of measuring like

915
00:33:46,720 --> 00:33:48,480
is what we're doing does that align with

916
00:33:48,480 --> 00:33:50,000
what's actually happening in this case

917
00:33:50,000 --> 00:33:51,760
like any desk was a really good example

918
00:33:51,760 --> 00:33:53,200
like i would have never guessed that

919
00:33:53,200 --> 00:33:54,960
would have been such a high percentage

920
00:33:54,960 --> 00:33:56,799
of persistence so it makes you rethink

921
00:33:56,799 --> 00:33:57,919
and you're like oh cool like i should

922
00:33:57,919 --> 00:33:59,600
maybe recalibrate

923
00:33:59,600 --> 00:34:00,960
and maybe take that more under

924
00:34:00,960 --> 00:34:03,760
consideration given how prevalent it is

925
00:34:03,760 --> 00:34:06,000
uh other really thing and you know in

926
00:34:06,000 --> 00:34:07,120
you know i'm gonna keep bringing this

927
00:34:07,120 --> 00:34:08,399
point up is

928
00:34:08,399 --> 00:34:10,719
uh as you're doing that there's always

929
00:34:10,719 --> 00:34:13,199
like that any desk or just like that

930
00:34:13,199 --> 00:34:15,599
calculus of where my priorities always

931
00:34:15,599 --> 00:34:18,000
looking for that what's next what's new

932
00:34:18,000 --> 00:34:20,239
um the one that really stood out um on

933
00:34:20,239 --> 00:34:22,320
this report to me was the operator goose

934
00:34:22,320 --> 00:34:23,839
i think it was kind of like a you know

935
00:34:23,839 --> 00:34:25,199
cheeky little thing but it's actually a

936
00:34:25,199 --> 00:34:27,280
really good idea in terms of watching

937
00:34:27,280 --> 00:34:29,520
people type like cobalt strike commands

938
00:34:29,520 --> 00:34:32,480
into cmd or the inverse it's like that

939
00:34:32,480 --> 00:34:34,399
like necessarily isn't going to be

940
00:34:34,399 --> 00:34:36,079
something you'd see an attack or see in

941
00:34:36,079 --> 00:34:38,000
a lot of like you know frameworks but

942
00:34:38,000 --> 00:34:39,520
that is like you know from a detection

943
00:34:39,520 --> 00:34:41,199
engineering perspective really powerful

944
00:34:41,199 --> 00:34:43,440
because as as we're talking about like i

945
00:34:43,440 --> 00:34:44,960
can't imagine a lot of users are going

946
00:34:44,960 --> 00:34:47,599
to be running like you know power pick

947
00:34:47,599 --> 00:34:49,199
that that doesn't make sense in like

948
00:34:49,199 --> 00:34:51,679
bash or cmd but the only reason they

949
00:34:51,679 --> 00:34:53,199
might be doing that is either they're

950
00:34:53,199 --> 00:34:54,560
playing around and doing some written

951
00:34:54,560 --> 00:34:56,399
research or we actually have an address

952
00:34:56,399 --> 00:34:58,640
area so there's always those like i love

953
00:34:58,640 --> 00:35:00,720
these in terms of taking a step back

954
00:35:00,720 --> 00:35:02,400
looking at the bigger picture

955
00:35:02,400 --> 00:35:04,240
and then figuring out like is there

956
00:35:04,240 --> 00:35:06,640
little winds that i can extract out of

957
00:35:06,640 --> 00:35:09,599
like so much like research and work and

958
00:35:09,599 --> 00:35:11,599
perspective like where can i actually

959
00:35:11,599 --> 00:35:12,800
like you know take this to my

960
00:35:12,800 --> 00:35:15,280
organization and maybe get a cheap win

961
00:35:15,280 --> 00:35:18,160
yeah that's that's a really great um

962
00:35:18,160 --> 00:35:21,359
input and and context for this as far as

963
00:35:21,359 --> 00:35:23,359
you know using it for storytelling

964
00:35:23,359 --> 00:35:24,960
backing the actions that you've taken at

965
00:35:24,960 --> 00:35:26,480
your organization

966
00:35:26,480 --> 00:35:27,359
and

967
00:35:27,359 --> 00:35:29,839
these novel or these ideas you know

968
00:35:29,839 --> 00:35:32,480
regarding like misspellings and and the

969
00:35:32,480 --> 00:35:34,960
commands for cobalt strike you know for

970
00:35:34,960 --> 00:35:38,000
newer ish operators or or threat actors

971
00:35:38,000 --> 00:35:40,240
behind the keyboard right messing

972
00:35:40,240 --> 00:35:42,400
messing up their upset right and i'm

973
00:35:42,400 --> 00:35:44,400
sorry justin was gonna say something

974
00:35:44,400 --> 00:35:45,920
oh i was just gonna say piggybacking on

975
00:35:45,920 --> 00:35:47,359
what jamie said the call out about the

976
00:35:47,359 --> 00:35:49,520
playbook thing is here here is nice uh

977
00:35:49,520 --> 00:35:50,560
same thing with the you know the

978
00:35:50,560 --> 00:35:51,680
previous reports where it showed the

979
00:35:51,680 --> 00:35:53,839
command lines that people ran but seeing

980
00:35:53,839 --> 00:35:56,560
like conti's playbook um seeing the

981
00:35:56,560 --> 00:35:58,000
steps that they took and understanding

982
00:35:58,000 --> 00:36:00,079
that you're not necessarily fighting you

983
00:36:00,079 --> 00:36:02,079
know the most advanced operators they're

984
00:36:02,079 --> 00:36:04,800
they're following steps um you know the

985
00:36:04,800 --> 00:36:06,640
ransomware actors are fairly similar

986
00:36:06,640 --> 00:36:08,240
among the steps they'll follow so really

987
00:36:08,240 --> 00:36:10,480
like being able to see that methodology

988
00:36:10,480 --> 00:36:11,920
from their perspective this past year

989
00:36:11,920 --> 00:36:13,839
when that playbook leaked was at least

990
00:36:13,839 --> 00:36:15,920
huge for my site because it's you know i

991
00:36:15,920 --> 00:36:17,920
it you would kind of see bits and pieces

992
00:36:17,920 --> 00:36:19,359
of this from these different reports but

993
00:36:19,359 --> 00:36:21,599
seeing the whole thing end the end

994
00:36:21,599 --> 00:36:23,119
was very insightful for me and it kind

995
00:36:23,119 --> 00:36:24,079
of helped

996
00:36:24,079 --> 00:36:26,560
you know put some guardrails around what

997
00:36:26,560 --> 00:36:28,240
these people do and don't do or their

998
00:36:28,240 --> 00:36:30,079
level of knowledge or you know what

999
00:36:30,079 --> 00:36:31,440
their their starting base level

1000
00:36:31,440 --> 00:36:32,960
knowledge is and you know what they can

1001
00:36:32,960 --> 00:36:36,079
actually do on their own

1002
00:36:36,560 --> 00:36:38,880
yeah that's a really great point

1003
00:36:38,880 --> 00:36:41,680
um and also too like getting that if you

1004
00:36:41,680 --> 00:36:42,880
don't

1005
00:36:42,880 --> 00:36:44,960
so you have you have it from two angles

1006
00:36:44,960 --> 00:36:47,119
right so you have the insider threat you

1007
00:36:47,119 --> 00:36:48,720
know essentially like why are you

1008
00:36:48,720 --> 00:36:50,720
downloading hacking tools

1009
00:36:50,720 --> 00:36:52,960
gee maybe we should create an alert or

1010
00:36:52,960 --> 00:36:55,040
something you know a detection for

1011
00:36:55,040 --> 00:36:56,880
insiders that are doing things that they

1012
00:36:56,880 --> 00:36:58,800
probably shouldn't be doing

1013
00:36:58,800 --> 00:37:00,800
um and then you also have the attacker's

1014
00:37:00,800 --> 00:37:03,119
standpoint too like you know justin and

1015
00:37:03,119 --> 00:37:05,440
jamie said regarding like wow they

1016
00:37:05,440 --> 00:37:07,200
actually have a playbook where they copy

1017
00:37:07,200 --> 00:37:08,960
paste and like

1018
00:37:08,960 --> 00:37:11,040
um leveraging that especially when they

1019
00:37:11,040 --> 00:37:13,280
get newer operators as you know

1020
00:37:13,280 --> 00:37:15,760
detection indicators to be able to drill

1021
00:37:15,760 --> 00:37:17,920
into behavior on the network

1022
00:37:17,920 --> 00:37:22,920
so i really i really love those points

1023
00:37:23,440 --> 00:37:25,520
i missed that chart until now but that's

1024
00:37:25,520 --> 00:37:27,040
actually really fascinating in the sense

1025
00:37:27,040 --> 00:37:28,960
of you can almost see

1026
00:37:28,960 --> 00:37:30,320
like you know

1027
00:37:30,320 --> 00:37:31,920
one of the things i like to commonly do

1028
00:37:31,920 --> 00:37:33,839
is like where what are adversary trends

1029
00:37:33,839 --> 00:37:35,680
you can start to pick up on like where

1030
00:37:35,680 --> 00:37:37,280
there's a lot of investment in terms of

1031
00:37:37,280 --> 00:37:39,040
you know what are they what goals are

1032
00:37:39,040 --> 00:37:40,640
they trying to satisfy and like even

1033
00:37:40,640 --> 00:37:41,440
that

1034
00:37:41,440 --> 00:37:44,000
um you know you know mimikatz is in

1035
00:37:44,000 --> 00:37:45,599
there lasagna like all these tools we're

1036
00:37:45,599 --> 00:37:46,960
familiar with but like it looks like

1037
00:37:46,960 --> 00:37:50,320
overwhelmingly a lot of the tools being

1038
00:37:50,320 --> 00:37:52,400
highlighted here are discovery and that

1039
00:37:52,400 --> 00:37:54,400
seems like you know it could be skewed

1040
00:37:54,400 --> 00:37:56,640
based on the actor but that's a really

1041
00:37:56,640 --> 00:37:58,400
good kind of insight and i think that's

1042
00:37:58,400 --> 00:37:59,520
one of the themes from the previous

1043
00:37:59,520 --> 00:38:01,680
reports is that is maybe where

1044
00:38:01,680 --> 00:38:03,440
adversaries are maybe investing a lot of

1045
00:38:03,440 --> 00:38:05,040
their time and attention that might be a

1046
00:38:05,040 --> 00:38:06,480
really good

1047
00:38:06,480 --> 00:38:08,240
kind of you know flipping that paradigm

1048
00:38:08,240 --> 00:38:10,079
that might be a really good opportunity

1049
00:38:10,079 --> 00:38:12,079
to invest our attention as defenders in

1050
00:38:12,079 --> 00:38:14,640
terms of hey you know 80 find and you

1051
00:38:14,640 --> 00:38:17,520
know doing these big ip scans and file

1052
00:38:17,520 --> 00:38:19,839
enumeration that aligns with you know

1053
00:38:19,839 --> 00:38:22,000
their bigger picture of their their

1054
00:38:22,000 --> 00:38:23,440
objective in this breach is to steal

1055
00:38:23,440 --> 00:38:24,800
data so they're obviously going to need

1056
00:38:24,800 --> 00:38:27,200
to find it maybe i can maybe tune what

1057
00:38:27,200 --> 00:38:29,119
i'm doing to maybe meet them the middle

1058
00:38:29,119 --> 00:38:30,960
or at least understand you know are

1059
00:38:30,960 --> 00:38:32,400
there really solid detection

1060
00:38:32,400 --> 00:38:35,760
opportunities along that path

1061
00:38:35,839 --> 00:38:37,359
yeah that's a that's a really great

1062
00:38:37,359 --> 00:38:38,440
point and

1063
00:38:38,440 --> 00:38:41,119
miraculously the deferred report put out

1064
00:38:41,119 --> 00:38:44,320
a wonderful report on ad find which we

1065
00:38:44,320 --> 00:38:47,599
can totally leverage to our benefit to

1066
00:38:47,599 --> 00:38:49,680
use within our organization and

1067
00:38:49,680 --> 00:38:52,480
prioritize activities regarding

1068
00:38:52,480 --> 00:38:54,320
detection and understanding the use of

1069
00:38:54,320 --> 00:38:56,160
that in our environment

1070
00:38:56,160 --> 00:38:57,280
right

1071
00:38:57,280 --> 00:38:58,800
where do they find the time it's it's

1072
00:38:58,800 --> 00:39:01,839
amazing i know they do they do say thank

1073
00:39:01,839 --> 00:39:04,640
you deeper report we love you

1074
00:39:04,640 --> 00:39:06,960
heart

1075
00:39:07,200 --> 00:39:08,720
um

1076
00:39:08,720 --> 00:39:10,560
let's see does anyone else have any

1077
00:39:10,560 --> 00:39:12,000
comments that they'd like to make

1078
00:39:12,000 --> 00:39:14,240
regarding this particular report with

1079
00:39:14,240 --> 00:39:16,720
the year in review

1080
00:39:16,720 --> 00:39:19,599
i would like to mention here that

1081
00:39:19,599 --> 00:39:22,720
we created this report bring everything

1082
00:39:22,720 --> 00:39:25,520
that we have seen over the past year

1083
00:39:25,520 --> 00:39:27,680
and just highlight

1084
00:39:27,680 --> 00:39:30,400
as uh other sudden is called

1085
00:39:30,400 --> 00:39:32,800
the most important tool

1086
00:39:32,800 --> 00:39:34,800
the tools that we see

1087
00:39:34,800 --> 00:39:37,359
the most and

1088
00:39:37,359 --> 00:39:39,839
most of the tools are you know you can

1089
00:39:39,839 --> 00:39:41,280
get um

1090
00:39:41,280 --> 00:39:43,599
from github

1091
00:39:43,599 --> 00:39:44,480
or

1092
00:39:44,480 --> 00:39:45,520
you know

1093
00:39:45,520 --> 00:39:50,079
they are just free to use and

1094
00:39:50,240 --> 00:39:51,839
maybe maybe this will help people

1095
00:39:51,839 --> 00:39:53,920
prioritize which

1096
00:39:53,920 --> 00:39:55,359
which tool

1097
00:39:55,359 --> 00:39:58,160
is used the most in

1098
00:39:58,160 --> 00:40:00,800
in the respective phase of the intrusion

1099
00:40:00,800 --> 00:40:03,119
that's why we have had that's why we

1100
00:40:03,119 --> 00:40:04,640
decided to

1101
00:40:04,640 --> 00:40:06,079
highlight

1102
00:40:06,079 --> 00:40:08,800
in the report style that we do

1103
00:40:08,800 --> 00:40:11,200
in every technique which

1104
00:40:11,200 --> 00:40:14,079
with the most prominent uh

1105
00:40:14,079 --> 00:40:16,400
technique that threat actors have used

1106
00:40:16,400 --> 00:40:18,960
so far and um

1107
00:40:18,960 --> 00:40:21,280
because

1108
00:40:22,640 --> 00:40:24,000
these tools

1109
00:40:24,000 --> 00:40:26,240
they will not change so often we see

1110
00:40:26,240 --> 00:40:28,720
them nowadays even this even though this

1111
00:40:28,720 --> 00:40:30,400
report

1112
00:40:30,400 --> 00:40:33,280
has been sometimes since this report and

1113
00:40:33,280 --> 00:40:35,359
uh and all the reports that from the

1114
00:40:35,359 --> 00:40:38,000
past year we still see the same tools we

1115
00:40:38,000 --> 00:40:40,319
still see the same techniques we still

1116
00:40:40,319 --> 00:40:43,599
we still say for example see resistance

1117
00:40:43,599 --> 00:40:46,000
by schedule tasks and execution of our

1118
00:40:46,000 --> 00:40:49,599
power cell very heavy uh

1119
00:40:49,599 --> 00:40:52,000
on parcel manual threat factors that we

1120
00:40:52,000 --> 00:40:52,800
see

1121
00:40:52,800 --> 00:40:53,760
so

1122
00:40:53,760 --> 00:40:56,079
you know this is what uh people can

1123
00:40:56,079 --> 00:40:58,400
prioritize and just

1124
00:40:58,400 --> 00:40:59,839
do

1125
00:40:59,839 --> 00:41:01,040
at least

1126
00:41:01,040 --> 00:41:03,280
to say that they can just pick these

1127
00:41:03,280 --> 00:41:05,520
easy wins and

1128
00:41:05,520 --> 00:41:08,480
protect their organization as uh as much

1129
00:41:08,480 --> 00:41:10,560
as possible

1130
00:41:10,560 --> 00:41:12,720
yeah and uh that that's a great point

1131
00:41:12,720 --> 00:41:15,680
kind of like here with the ransomware

1132
00:41:15,680 --> 00:41:17,560
uh operators using

1133
00:41:17,560 --> 00:41:20,480
ufile.ilo to upload the

1134
00:41:20,480 --> 00:41:22,640
lcs dump file so

1135
00:41:22,640 --> 00:41:25,520
you know maybe you can make that you

1136
00:41:25,520 --> 00:41:27,119
can't access that on the corporate

1137
00:41:27,119 --> 00:41:28,800
network if there isn't a business use

1138
00:41:28,800 --> 00:41:31,200
for it you know just quick really easy

1139
00:41:31,200 --> 00:41:33,599
wins that'll frustrate them because then

1140
00:41:33,599 --> 00:41:35,280
they'll have to change up where they put

1141
00:41:35,280 --> 00:41:36,960
their stuff right

1142
00:41:36,960 --> 00:41:39,040
um and that's more time that buys you

1143
00:41:39,040 --> 00:41:40,880
essentially from my perspective this

1144
00:41:40,880 --> 00:41:44,319
just my opinion it buys you more time

1145
00:41:44,319 --> 00:41:45,760
one more thing before we jump to the

1146
00:41:45,760 --> 00:41:48,160
next report is to to never forget the

1147
00:41:48,160 --> 00:41:50,160
easy wins so

1148
00:41:50,160 --> 00:41:52,400
we know that there are a lot of other

1149
00:41:52,400 --> 00:41:54,960
techniques that can be used and that can

1150
00:41:54,960 --> 00:41:57,599
be hard to detect but this i believe

1151
00:41:57,599 --> 00:41:59,440
this one is a very great report

1152
00:41:59,440 --> 00:42:01,680
especially for junior analysts who are

1153
00:42:01,680 --> 00:42:04,079
somewhat afraid by by by the word

1154
00:42:04,079 --> 00:42:05,520
detection who just imagine that

1155
00:42:05,520 --> 00:42:07,839
detection is very hard or whatever

1156
00:42:07,839 --> 00:42:10,319
but this is a great example

1157
00:42:10,319 --> 00:42:13,599
to to to not lose track and focus only

1158
00:42:13,599 --> 00:42:16,000
on the hardest part or forget about the

1159
00:42:16,000 --> 00:42:18,720
easy one so if you can win it against

1160
00:42:18,720 --> 00:42:20,720
them just go for it so write easy

1161
00:42:20,720 --> 00:42:21,920
detection

1162
00:42:21,920 --> 00:42:24,800
go for the tools and uh focus on what's

1163
00:42:24,800 --> 00:42:26,640
available and don't forget about the

1164
00:42:26,640 --> 00:42:28,160
rest of course but this is a great

1165
00:42:28,160 --> 00:42:30,319
report and i highly recommend any

1166
00:42:30,319 --> 00:42:32,880
analyst of any level to go for it

1167
00:42:32,880 --> 00:42:35,119
and analyze and just see if you have

1168
00:42:35,119 --> 00:42:37,440
detection for for most of the stuff here

1169
00:42:37,440 --> 00:42:39,839
you'll be surprised just like jamie said

1170
00:42:39,839 --> 00:42:43,280
any desk most people use that and it is

1171
00:42:43,280 --> 00:42:45,040
with a very high percentage on that

1172
00:42:45,040 --> 00:42:47,280
graph which is very surprising

1173
00:42:47,280 --> 00:42:48,319
yeah so

1174
00:42:48,319 --> 00:42:49,920
don't forget about the easy one that's

1175
00:42:49,920 --> 00:42:51,599
my take

1176
00:42:51,599 --> 00:42:53,520
yeah thank you that's that's definitely

1177
00:42:53,520 --> 00:42:55,440
an important takeaway especially for

1178
00:42:55,440 --> 00:42:57,680
people that have limited staff and

1179
00:42:57,680 --> 00:43:00,160
limited timing and effort limited

1180
00:43:00,160 --> 00:43:01,520
resources

1181
00:43:01,520 --> 00:43:04,720
so we will go on to our last report

1182
00:43:04,720 --> 00:43:08,000
which is cubot likes to move it move it

1183
00:43:08,000 --> 00:43:12,340
um this was back in february of 2020

1184
00:43:12,340 --> 00:43:13,920
[Music]

1185
00:43:13,920 --> 00:43:17,760
to 2022 wow 2022

1186
00:43:17,760 --> 00:43:21,119
um and this particular report i felt

1187
00:43:21,119 --> 00:43:23,839
like it was important to include in here

1188
00:43:23,839 --> 00:43:25,920
just because i remember there was a

1189
00:43:25,920 --> 00:43:28,079
twitter conversation a while back and

1190
00:43:28,079 --> 00:43:30,560
y'all please correct me if i'm wrong but

1191
00:43:30,560 --> 00:43:33,359
they were talking about how cubot 10

1192
00:43:33,359 --> 00:43:35,280
tended to lead more

1193
00:43:35,280 --> 00:43:38,000
from uh like the final stage payload

1194
00:43:38,000 --> 00:43:40,079
being ransomware and some of the other

1195
00:43:40,079 --> 00:43:42,880
more destructive type of behaviors

1196
00:43:42,880 --> 00:43:43,760
um

1197
00:43:43,760 --> 00:43:45,520
and so i'm like well maybe we should

1198
00:43:45,520 --> 00:43:47,520
just have a brief conversation about

1199
00:43:47,520 --> 00:43:48,560
this

1200
00:43:48,560 --> 00:43:50,800
uh you know if anyone has any thoughts

1201
00:43:50,800 --> 00:43:53,200
on this not only from the initial access

1202
00:43:53,200 --> 00:43:54,800
broker standpoint

1203
00:43:54,800 --> 00:43:57,839
of multiple initial access broker

1204
00:43:57,839 --> 00:44:00,480
actors threat activity groups utilizing

1205
00:44:00,480 --> 00:44:03,119
hubot for initial access

1206
00:44:03,119 --> 00:44:06,319
but any other insights you might have

1207
00:44:06,319 --> 00:44:08,560
regarding cuba

1208
00:44:08,560 --> 00:44:11,440
or quackbot

1209
00:44:12,960 --> 00:44:14,160
um

1210
00:44:14,160 --> 00:44:16,160
it's interesting because

1211
00:44:16,160 --> 00:44:17,119
i'm sorry

1212
00:44:17,119 --> 00:44:18,880
it's interesting because um

1213
00:44:18,880 --> 00:44:20,319
we didn't see

1214
00:44:20,319 --> 00:44:24,000
we didn't see any further activity uh we

1215
00:44:24,000 --> 00:44:26,160
didn't see cobalt strike we didn't see

1216
00:44:26,160 --> 00:44:28,800
them using uh rdg

1217
00:44:28,800 --> 00:44:32,800
um but with this we did see huge wood uh

1218
00:44:32,800 --> 00:44:35,839
moving laterally to other hosts and

1219
00:44:35,839 --> 00:44:38,160
spreading and stealing information

1220
00:44:38,160 --> 00:44:39,839
and

1221
00:44:39,839 --> 00:44:41,760
this information that was stolen could

1222
00:44:41,760 --> 00:44:43,359
be used against the organization that

1223
00:44:43,359 --> 00:44:44,319
was

1224
00:44:44,319 --> 00:44:48,000
a victim in this case for example um

1225
00:44:48,000 --> 00:44:50,640
but we see that depending on the

1226
00:44:50,640 --> 00:44:53,920
objectives uh threat actors could uh

1227
00:44:53,920 --> 00:44:56,400
either proceed with uh

1228
00:44:56,400 --> 00:44:58,720
um

1229
00:44:59,280 --> 00:45:00,960
somewhere declaring ransomware or

1230
00:45:00,960 --> 00:45:04,400
stealing information in in a more

1231
00:45:04,400 --> 00:45:06,400
automated fashion

1232
00:45:06,400 --> 00:45:09,520
in a more manual fashion opposed to how

1233
00:45:09,520 --> 00:45:12,160
cubot uh exfiltrated data in this

1234
00:45:12,160 --> 00:45:15,520
campaign in this uh in this situation so

1235
00:45:15,520 --> 00:45:16,880
um

1236
00:45:16,880 --> 00:45:20,319
we i it's very interesting that we saw

1237
00:45:20,319 --> 00:45:22,079
them um

1238
00:45:22,079 --> 00:45:23,280
go through

1239
00:45:23,280 --> 00:45:26,720
the whole inclusion pivot but

1240
00:45:26,720 --> 00:45:28,160
then they

1241
00:45:28,160 --> 00:45:29,680
installed the information that they

1242
00:45:29,680 --> 00:45:30,720
needed and

1243
00:45:30,720 --> 00:45:33,040
they left the environment

1244
00:45:33,040 --> 00:45:35,680
they didn't do further they didn't

1245
00:45:35,680 --> 00:45:37,280
do anything further

1246
00:45:37,280 --> 00:45:39,760
we don't know why but

1247
00:45:39,760 --> 00:45:42,800
it's uh it's very interesting to see and

1248
00:45:42,800 --> 00:45:43,760
it's

1249
00:45:43,760 --> 00:45:45,520
very interesting to know that uh

1250
00:45:45,520 --> 00:45:47,520
depending on the objective suggests

1251
00:45:47,520 --> 00:45:50,000
again of the threat actor they act

1252
00:45:50,000 --> 00:45:52,960
accordingly in the network

1253
00:45:52,960 --> 00:45:54,640
yeah this this whole like broker

1254
00:45:54,640 --> 00:45:57,520
affiliate model has literally broken how

1255
00:45:57,520 --> 00:45:58,880
we track groups in attack like we're

1256
00:45:58,880 --> 00:46:00,560
having to reshuffle and like introduce

1257
00:46:00,560 --> 00:46:02,400
the idea of campaigns just to capture

1258
00:46:02,400 --> 00:46:04,720
stuff like this where it's not as clean

1259
00:46:04,720 --> 00:46:06,560
as traditional attribution and exactly

1260
00:46:06,560 --> 00:46:08,960
as you said like it doesn't

1261
00:46:08,960 --> 00:46:11,599
um it doesn't flow it doesn't doesn't

1262
00:46:11,599 --> 00:46:13,440
kind of like fit into our traditional

1263
00:46:13,440 --> 00:46:15,359
systems other interesting i thought

1264
00:46:15,359 --> 00:46:17,280
about exactly to your point about like

1265
00:46:17,280 --> 00:46:21,200
kind of tracking a campaign end-to-end

1266
00:46:21,200 --> 00:46:22,720
the i think one of this really

1267
00:46:22,720 --> 00:46:24,079
highlights a really interesting point

1268
00:46:24,079 --> 00:46:26,160
and like traditionally like there used

1269
00:46:26,160 --> 00:46:27,520
to be a lot of you know we would call

1270
00:46:27,520 --> 00:46:29,440
like nuisance adversaries like crypto

1271
00:46:29,440 --> 00:46:30,640
miners and stuff where we would

1272
00:46:30,640 --> 00:46:32,800
potentially like oh like i don't really

1273
00:46:32,800 --> 00:46:34,319
it's not necessarily a big priority for

1274
00:46:34,319 --> 00:46:35,760
organization because they're just gonna

1275
00:46:35,760 --> 00:46:37,200
you know drop some weird payload that's

1276
00:46:37,200 --> 00:46:38,800
gonna try to steal some cryptocurrency i

1277
00:46:38,800 --> 00:46:41,200
don't really care like or if you don't

1278
00:46:41,200 --> 00:46:42,960
care it's not as big of a threat as

1279
00:46:42,960 --> 00:46:45,040
ransomware i think cubot really

1280
00:46:45,040 --> 00:46:47,040
highlights that fear and this report

1281
00:46:47,040 --> 00:46:49,119
really hides that fear because you know

1282
00:46:49,119 --> 00:46:50,880
you kind of have to treat all initial

1283
00:46:50,880 --> 00:46:53,200
access as equally problematic because

1284
00:46:53,200 --> 00:46:54,319
it's like you know i don't know where

1285
00:46:54,319 --> 00:46:56,000
this could go they could steal some data

1286
00:46:56,000 --> 00:46:57,680
they could leave they could drop

1287
00:46:57,680 --> 00:46:59,359
ransomware they could drop some little

1288
00:46:59,359 --> 00:47:00,720
tiny miner that's going to steal some

1289
00:47:00,720 --> 00:47:02,640
cycles like i

1290
00:47:02,640 --> 00:47:04,960
it's all under

1291
00:47:04,960 --> 00:47:07,440
kind of that same like oh crap moment

1292
00:47:07,440 --> 00:47:09,680
other interesting thing here is like

1293
00:47:09,680 --> 00:47:12,240
the actor also either way no matter

1294
00:47:12,240 --> 00:47:13,680
where they go like the one of the last

1295
00:47:13,680 --> 00:47:15,119
things that they did was or might have

1296
00:47:15,119 --> 00:47:16,240
been early on

1297
00:47:16,240 --> 00:47:18,800
um disabling defender like either way

1298
00:47:18,800 --> 00:47:20,559
like i don't even care if it was just a

1299
00:47:20,559 --> 00:47:23,040
crypto miner like i can't have that in

1300
00:47:23,040 --> 00:47:25,359
our environment so it kind of really

1301
00:47:25,359 --> 00:47:26,960
does start to you know like you said

1302
00:47:26,960 --> 00:47:29,599
even those unsophisticated kind of spray

1303
00:47:29,599 --> 00:47:31,760
and prey actors start to work your way

1304
00:47:31,760 --> 00:47:33,839
up your list because it's like i these

1305
00:47:33,839 --> 00:47:36,079
folks who knows it could just be right

1306
00:47:36,079 --> 00:47:38,000
time right place they could really

1307
00:47:38,000 --> 00:47:41,040
expose me to some really nasty uh really

1308
00:47:41,040 --> 00:47:43,839
nasty next steps

1309
00:47:43,839 --> 00:47:46,400
yes that's a really great point um and

1310
00:47:46,400 --> 00:47:49,200
it was in i think the the goo loader one

1311
00:47:49,200 --> 00:47:52,559
where they disabled windows defender and

1312
00:47:52,559 --> 00:47:56,559
i've heard uh some organizations utilize

1313
00:47:56,559 --> 00:47:59,200
that potentially as a detection

1314
00:47:59,200 --> 00:48:00,800
right whether or not they have windows

1315
00:48:00,800 --> 00:48:02,000
defender

1316
00:48:02,000 --> 00:48:05,280
um and that's that's that's a really

1317
00:48:05,280 --> 00:48:06,800
great point and

1318
00:48:06,800 --> 00:48:08,079
also too

1319
00:48:08,079 --> 00:48:11,119
think of like the high level wins like

1320
00:48:11,119 --> 00:48:12,960
not only you know you have your initial

1321
00:48:12,960 --> 00:48:14,960
access broker and it could lead to who

1322
00:48:14,960 --> 00:48:16,160
knows what

1323
00:48:16,160 --> 00:48:18,480
so what can you do at least with this

1324
00:48:18,480 --> 00:48:20,720
one right so instead of this the

1325
00:48:20,720 --> 00:48:23,440
javascript loading itself like have it

1326
00:48:23,440 --> 00:48:25,200
open up in notepad

1327
00:48:25,200 --> 00:48:26,559
right so

1328
00:48:26,559 --> 00:48:29,040
tackling those organizational

1329
00:48:29,040 --> 00:48:31,280
type issues to just be like all right

1330
00:48:31,280 --> 00:48:34,559
sucker like see how you can execute that

1331
00:48:34,559 --> 00:48:35,680
now

1332
00:48:35,680 --> 00:48:38,160
um you know and kind of going for for

1333
00:48:38,160 --> 00:48:40,800
the win i call it the ban hammer

1334
00:48:40,800 --> 00:48:43,520
like i i try to review these reports and

1335
00:48:43,520 --> 00:48:46,079
i'm like how can i ban hammer and like

1336
00:48:46,079 --> 00:48:48,880
make the actors like really pissed at me

1337
00:48:48,880 --> 00:48:49,920
so

1338
00:48:49,920 --> 00:48:52,720
that's how i read these too uh just as a

1339
00:48:52,720 --> 00:48:54,800
tip like what's a high level thing that

1340
00:48:54,800 --> 00:48:56,319
i can do

1341
00:48:56,319 --> 00:48:58,400
um regardless of what the end stage

1342
00:48:58,400 --> 00:49:01,520
payload is right to be able to

1343
00:49:01,520 --> 00:49:02,559
to

1344
00:49:02,559 --> 00:49:03,920
mitigate

1345
00:49:03,920 --> 00:49:06,000
uh decrease the risk

1346
00:49:06,000 --> 00:49:08,240
for like a multitude of behaviors

1347
00:49:08,240 --> 00:49:10,800
regardless of the end state so if you

1348
00:49:10,800 --> 00:49:14,240
guys have any insights on that too

1349
00:49:14,240 --> 00:49:17,720
that would be helpful

1350
00:49:18,800 --> 00:49:20,079
on that vein the one that stood out to

1351
00:49:20,079 --> 00:49:21,920
me is like this is a personal bias like

1352
00:49:21,920 --> 00:49:24,720
i always associate like macros with like

1353
00:49:24,720 --> 00:49:26,800
word docs so like even from the like

1354
00:49:26,800 --> 00:49:28,160
very beginning i was like oh crap like

1355
00:49:28,160 --> 00:49:30,000
yeah like they exist in excel they exist

1356
00:49:30,000 --> 00:49:32,000
in other formats like you know isos

1357
00:49:32,000 --> 00:49:34,000
there's all these different ways um and

1358
00:49:34,000 --> 00:49:35,760
these actors are thinking about that so

1359
00:49:35,760 --> 00:49:37,920
it's like oh like you can't really you

1360
00:49:37,920 --> 00:49:39,359
know even if we kind of get in those

1361
00:49:39,359 --> 00:49:41,200
like silos we think about our problem a

1362
00:49:41,200 --> 00:49:42,960
certain way you kind of have to always

1363
00:49:42,960 --> 00:49:44,400
like fact check yourself and make sure

1364
00:49:44,400 --> 00:49:46,319
you're not you know making assumptions

1365
00:49:46,319 --> 00:49:48,240
that could lead to something like this

1366
00:49:48,240 --> 00:49:51,520
maybe taking advantage of you

1367
00:49:51,680 --> 00:49:55,118
yeah that's a really great point

1368
00:49:56,640 --> 00:49:58,319
let's see if you're reviewing this

1369
00:49:58,319 --> 00:50:00,800
particular report

1370
00:50:00,800 --> 00:50:03,440
and let's say you don't have cis mon and

1371
00:50:03,440 --> 00:50:05,599
you don't have sigma rules

1372
00:50:05,599 --> 00:50:07,280
like how would you

1373
00:50:07,280 --> 00:50:11,720
engage this particular report

1374
00:50:14,319 --> 00:50:17,359
you close it and pray

1375
00:50:17,359 --> 00:50:19,839
wait what

1376
00:50:21,520 --> 00:50:23,200
unplug the internet

1377
00:50:23,200 --> 00:50:25,280
yeah

1378
00:50:25,280 --> 00:50:26,640
that's awesome

1379
00:50:26,640 --> 00:50:29,200
just unplug off

1380
00:50:29,200 --> 00:50:32,720
i think everybody has um

1381
00:50:32,720 --> 00:50:34,960
a firewall or a router that could

1382
00:50:34,960 --> 00:50:36,559
basically do some

1383
00:50:36,559 --> 00:50:39,680
they could just do some basic uh

1384
00:50:39,680 --> 00:50:40,559
you know

1385
00:50:40,559 --> 00:50:44,319
rules on there to

1386
00:50:44,319 --> 00:50:46,160
possibly

1387
00:50:46,160 --> 00:50:48,000
um

1388
00:50:48,000 --> 00:50:49,280
test

1389
00:50:49,280 --> 00:50:53,040
some free throat intelligence feats and

1390
00:50:53,040 --> 00:50:54,240
have uh

1391
00:50:54,240 --> 00:50:56,160
you know domains that are categorized

1392
00:50:56,160 --> 00:50:57,520
the small issues being blocked

1393
00:50:57,520 --> 00:50:58,960
automatically

1394
00:50:58,960 --> 00:51:01,520
that would for example block keyboards

1395
00:51:01,520 --> 00:51:04,079
from establishing a communication

1396
00:51:04,079 --> 00:51:06,800
channel with a command control server

1397
00:51:06,800 --> 00:51:08,800
that would be

1398
00:51:08,800 --> 00:51:11,119
some of the firewalls come already with

1399
00:51:11,119 --> 00:51:13,920
uh with a package of um you know

1400
00:51:13,920 --> 00:51:17,359
providing this information uh

1401
00:51:17,359 --> 00:51:21,359
these feeds into their hardware

1402
00:51:21,359 --> 00:51:23,040
now if the organization doesn't even

1403
00:51:23,040 --> 00:51:24,880
have a firewall

1404
00:51:24,880 --> 00:51:26,400
i mean

1405
00:51:26,400 --> 00:51:27,680
it it

1406
00:51:27,680 --> 00:51:30,240
it is it is difficult to because if they

1407
00:51:30,240 --> 00:51:33,119
don't have anything to that extent uh or

1408
00:51:33,119 --> 00:51:35,440
any cross-execution logs

1409
00:51:35,440 --> 00:51:37,520
it just becomes very difficult to deal

1410
00:51:37,520 --> 00:51:40,400
with those threats

1411
00:51:40,720 --> 00:51:43,040
we need we need administrator system

1412
00:51:43,040 --> 00:51:45,040
administrators to be on top of their

1413
00:51:45,040 --> 00:51:46,160
game and

1414
00:51:46,160 --> 00:51:48,240
make sure that security is integrated

1415
00:51:48,240 --> 00:51:50,559
into their day-to-day operations

1416
00:51:50,559 --> 00:51:52,400
and even though they're gonna cannot

1417
00:51:52,400 --> 00:51:55,599
afford security personnel they could at

1418
00:51:55,599 --> 00:51:57,599
least train their system administrators

1419
00:51:57,599 --> 00:51:59,760
to to deal with some of

1420
00:51:59,760 --> 00:52:01,760
the high-level security aspects of the

1421
00:52:01,760 --> 00:52:02,880
network

1422
00:52:02,880 --> 00:52:04,880
it doesn't scale well too but um i think

1423
00:52:04,880 --> 00:52:06,079
he did a really good job in this report

1424
00:52:06,079 --> 00:52:07,839
highlighting there's also like a lot of

1425
00:52:07,839 --> 00:52:09,440
adversary leave behind whether it's

1426
00:52:09,440 --> 00:52:11,680
files or registry keys where even if

1427
00:52:11,680 --> 00:52:13,440
it's not part of like a security

1428
00:52:13,440 --> 00:52:15,680
monitoring solution um just forensically

1429
00:52:15,680 --> 00:52:16,880
you could go to these hosts and try to

1430
00:52:16,880 --> 00:52:18,160
check for those artifacts and it might

1431
00:52:18,160 --> 00:52:19,839
not be exactly the same like you know

1432
00:52:19,839 --> 00:52:21,040
they might have changed the file name or

1433
00:52:21,040 --> 00:52:22,240
the path but

1434
00:52:22,240 --> 00:52:23,680
those type of trends where you know

1435
00:52:23,680 --> 00:52:25,280
cubot likes to put things in certain

1436
00:52:25,280 --> 00:52:27,359
places that might be a good place to

1437
00:52:27,359 --> 00:52:29,599
maybe circle back and maybe just do some

1438
00:52:29,599 --> 00:52:32,720
quick hunting remediation kind of work

1439
00:52:32,720 --> 00:52:34,960
oh also too

1440
00:52:34,960 --> 00:52:38,319
oh go ahead yes sorry yeah yeah um

1441
00:52:38,319 --> 00:52:40,079
also like i'm a big fan of network

1442
00:52:40,079 --> 00:52:43,200
security monitoring and and here we have

1443
00:52:43,200 --> 00:52:46,240
a creation of dlls and remote services

1444
00:52:46,240 --> 00:52:48,160
sort of that could be picked up on our

1445
00:52:48,160 --> 00:52:50,400
network security monitoring and

1446
00:52:50,400 --> 00:52:52,240
security online as a free tool that sort

1447
00:52:52,240 --> 00:52:53,119
of

1448
00:52:53,119 --> 00:52:55,280
picked this stuff up

1449
00:52:55,280 --> 00:52:58,319
uh like if if i sort of before i started

1450
00:52:58,319 --> 00:53:01,200
helping the ufi report i i use their

1451
00:53:01,200 --> 00:53:02,880
stuff for instance i was helping the

1452
00:53:02,880 --> 00:53:05,760
hospitals during the pandemic

1453
00:53:05,760 --> 00:53:07,839
and then we used to like these discovery

1454
00:53:07,839 --> 00:53:10,400
commands and did did

1455
00:53:10,400 --> 00:53:12,640
ids rule sets from them so we have to

1456
00:53:12,640 --> 00:53:15,520
try to attract react when they entered

1457
00:53:15,520 --> 00:53:17,520
so that sort of

1458
00:53:17,520 --> 00:53:20,400
sort of low-hanging fruits uh

1459
00:53:20,400 --> 00:53:23,440
use security onion and sort of try to

1460
00:53:23,440 --> 00:53:24,960
monitor your your because they always

1461
00:53:24,960 --> 00:53:29,119
run for the main the main controller

1462
00:53:29,119 --> 00:53:31,760
kind of mentality to it

1463
00:53:31,760 --> 00:53:34,079
yeah and i was thinking too so mitre

1464
00:53:34,079 --> 00:53:38,240
ingenuity has this really great um

1465
00:53:38,240 --> 00:53:41,040
has this really great blog on medium

1466
00:53:41,040 --> 00:53:43,839
where to begin prioritizing attack

1467
00:53:43,839 --> 00:53:45,280
techniques

1468
00:53:45,280 --> 00:53:47,599
so for cubot and even some of the other

1469
00:53:47,599 --> 00:53:50,160
reports if you go through this they talk

1470
00:53:50,160 --> 00:53:51,920
about a choke point

1471
00:53:51,920 --> 00:53:54,880
for um four techniques that are used

1472
00:53:54,880 --> 00:53:56,880
kind of that are dependent on other

1473
00:53:56,880 --> 00:53:58,720
behaviors within the environment and

1474
00:53:58,720 --> 00:53:59,760
they said

1475
00:53:59,760 --> 00:54:01,359
that the choke point at least for the

1476
00:54:01,359 --> 00:54:03,760
data set that they have and and the

1477
00:54:03,760 --> 00:54:05,839
review that they did it was process

1478
00:54:05,839 --> 00:54:07,040
injection

1479
00:54:07,040 --> 00:54:10,079
so if we come over here to the cubot

1480
00:54:10,079 --> 00:54:11,119
report

1481
00:54:11,119 --> 00:54:14,160
and let's say you have a way to detect

1482
00:54:14,160 --> 00:54:16,400
process injection

1483
00:54:16,400 --> 00:54:19,079
um here uh the

1484
00:54:19,079 --> 00:54:22,400
msra.exe was injected by the

1485
00:54:22,400 --> 00:54:25,359
cubot dll so that might be a great place

1486
00:54:25,359 --> 00:54:27,680
to start like any process injection

1487
00:54:27,680 --> 00:54:29,839
related to that binary

1488
00:54:29,839 --> 00:54:31,920
um and that service within your

1489
00:54:31,920 --> 00:54:34,480
environment and so from there start

1490
00:54:34,480 --> 00:54:35,359
there

1491
00:54:35,359 --> 00:54:37,520
and then branch out

1492
00:54:37,520 --> 00:54:39,599
to other parts of the report

1493
00:54:39,599 --> 00:54:42,400
so you know for me if i was doing the

1494
00:54:42,400 --> 00:54:44,720
miter ingenuity way as far as looking at

1495
00:54:44,720 --> 00:54:47,440
the choke point for other behaviors that

1496
00:54:47,440 --> 00:54:49,359
cubot might do that might be a great one

1497
00:54:49,359 --> 00:54:50,720
to start with and that's of course

1498
00:54:50,720 --> 00:54:53,760
contingent upon your particular security

1499
00:54:53,760 --> 00:54:56,400
environment being able to to detect on

1500
00:54:56,400 --> 00:55:00,000
that um that's just one idea as well

1501
00:55:00,000 --> 00:55:01,440
um

1502
00:55:01,440 --> 00:55:03,040
does anyone else have any thoughts on

1503
00:55:03,040 --> 00:55:06,839
this particular report

1504
00:55:13,760 --> 00:55:15,359
one of the four reports here but costas

1505
00:55:15,359 --> 00:55:18,400
did a great work on cobo strike

1506
00:55:18,400 --> 00:55:21,119
a really really want to emphasize his

1507
00:55:21,119 --> 00:55:23,119
work on that because if you find cobo

1508
00:55:23,119 --> 00:55:24,960
strike you will be secure kind of

1509
00:55:24,960 --> 00:55:26,240
because that's

1510
00:55:26,240 --> 00:55:27,920
almost 100 percent almost cover strike

1511
00:55:27,920 --> 00:55:29,440
comes in so yeah probably a solid

1512
00:55:29,440 --> 00:55:32,440
checkpoint

1513
00:55:34,720 --> 00:55:35,020
um

1514
00:55:35,020 --> 00:55:36,480
[Music]

1515
00:55:36,480 --> 00:55:39,680
i would like to ask justin from meredith

1516
00:55:39,680 --> 00:55:41,599
from being in the red team and that

1517
00:55:41,599 --> 00:55:43,200
perspective uh

1518
00:55:43,200 --> 00:55:45,599
what would you do if you didn't have uh

1519
00:55:45,599 --> 00:55:49,200
um boss execution logs or um some of the

1520
00:55:49,200 --> 00:55:51,760
basic security heights in that we expect

1521
00:55:51,760 --> 00:55:54,000
to see in a in an environment

1522
00:55:54,000 --> 00:55:56,240
um so what what would you yeah what

1523
00:55:56,240 --> 00:55:57,680
would you suggest to the customer for

1524
00:55:57,680 --> 00:56:00,079
example yeah so so this particular case

1525
00:56:00,079 --> 00:56:02,400
um this is probably not the best

1526
00:56:02,400 --> 00:56:03,839
suggestion but i would assume if you

1527
00:56:03,839 --> 00:56:06,000
have no security spend you're probably

1528
00:56:06,000 --> 00:56:07,520
small enough to a point that you could

1529
00:56:07,520 --> 00:56:08,640
get away with

1530
00:56:08,640 --> 00:56:10,799
you know using a gpo to block you know

1531
00:56:10,799 --> 00:56:12,400
macro execution or something like that

1532
00:56:12,400 --> 00:56:13,599
right because so many of these things

1533
00:56:13,599 --> 00:56:16,720
have started from macros i feel like you

1534
00:56:16,720 --> 00:56:17,920
might actually be able to get away with

1535
00:56:17,920 --> 00:56:19,520
turning it off at an organization that

1536
00:56:19,520 --> 00:56:20,559
size

1537
00:56:20,559 --> 00:56:21,920
once you start getting very large you

1538
00:56:21,920 --> 00:56:23,520
start finding out that you know finance

1539
00:56:23,520 --> 00:56:25,680
and certain random people run them but

1540
00:56:25,680 --> 00:56:27,760
i'm guessing if you're small enough not

1541
00:56:27,760 --> 00:56:29,680
to have any security spend maybe no edr

1542
00:56:29,680 --> 00:56:31,200
other things you might actually be able

1543
00:56:31,200 --> 00:56:32,960
to get away with the gpo for that and i

1544
00:56:32,960 --> 00:56:34,400
realize that's not a fix all because

1545
00:56:34,400 --> 00:56:36,559
people have moved on to like uh you know

1546
00:56:36,559 --> 00:56:38,160
iso files with links and things like

1547
00:56:38,160 --> 00:56:39,760
that but like so much of this over the

1548
00:56:39,760 --> 00:56:41,680
past couple years has been like macros

1549
00:56:41,680 --> 00:56:44,640
of varying kind um you know getting a

1550
00:56:44,640 --> 00:56:45,920
handle on that turning it off if you

1551
00:56:45,920 --> 00:56:47,040
don't need it it's the same thing that

1552
00:56:47,040 --> 00:56:49,280
was mentioned before with the bandhammer

1553
00:56:49,280 --> 00:56:53,839
on js like remapping hta remapping js to

1554
00:56:53,839 --> 00:56:55,920
open a notepad like those are some easy

1555
00:56:55,920 --> 00:56:57,839
wins and there's only so many initial

1556
00:56:57,839 --> 00:57:00,160
access vectors for the phishing side of

1557
00:57:00,160 --> 00:57:02,319
things so it's like if you can get you

1558
00:57:02,319 --> 00:57:04,240
know two factor on the outside you know

1559
00:57:04,240 --> 00:57:05,680
maybe try to kill somebody's initial

1560
00:57:05,680 --> 00:57:07,119
execution pass

1561
00:57:07,119 --> 00:57:08,720
okay maybe you can't afford an edr or

1562
00:57:08,720 --> 00:57:10,319
get it rolled out quickly but if you

1563
00:57:10,319 --> 00:57:11,520
look at where the bulk of these things

1564
00:57:11,520 --> 00:57:13,440
are coming from there's some easy ways

1565
00:57:13,440 --> 00:57:15,680
to at least get some wins there and that

1566
00:57:15,680 --> 00:57:18,640
would be the right i would go

1567
00:57:20,880 --> 00:57:22,240
okay i know we're coming on time but i'd

1568
00:57:22,240 --> 00:57:23,839
have a quick question for nick and uh

1569
00:57:23,839 --> 00:57:26,960
costas uh this report and amongst many

1570
00:57:26,960 --> 00:57:28,720
others highlights this like really well

1571
00:57:28,720 --> 00:57:30,400
like how do you folks come up with the

1572
00:57:30,400 --> 00:57:32,319
names because this one is like even

1573
00:57:32,319 --> 00:57:34,799
before going any further like i i just

1574
00:57:34,799 --> 00:57:35,920
like fell in love and i was like i'm

1575
00:57:35,920 --> 00:57:38,160
gonna love the report just based on uh

1576
00:57:38,160 --> 00:57:39,359
like the movement move it that's

1577
00:57:39,359 --> 00:57:41,680
fantastic

1578
00:57:41,680 --> 00:57:43,440
i personally leave it to others because

1579
00:57:43,440 --> 00:57:44,799
i'm not that

1580
00:57:44,799 --> 00:57:46,240
creative

1581
00:57:46,240 --> 00:57:48,960
coming up with titles um

1582
00:57:48,960 --> 00:57:51,520
i would contribute to

1583
00:57:51,520 --> 00:57:52,240
the

1584
00:57:52,240 --> 00:57:54,720
voting of

1585
00:57:54,720 --> 00:57:56,880
the title that other people suggest but

1586
00:57:56,880 --> 00:57:59,599
uh you know that they did i think nick

1587
00:57:59,599 --> 00:58:01,599
has come up with some very good titles

1588
00:58:01,599 --> 00:58:04,079
over the past year so

1589
00:58:04,079 --> 00:58:07,720
that's what i would do

1590
00:58:12,050 --> 00:58:14,319
[Music]

1591
00:58:14,319 --> 00:58:17,040
i mean i mean this this title is awesome

1592
00:58:17,040 --> 00:58:19,440
will there be i mean who who can read

1593
00:58:19,440 --> 00:58:21,119
that title without thinking about the

1594
00:58:21,119 --> 00:58:23,680
real slim shady right the song starts

1595
00:58:23,680 --> 00:58:25,760
playing in my head as i'm reading the

1596
00:58:25,760 --> 00:58:28,880
report that's a really great question

1597
00:58:28,880 --> 00:58:30,400
um

1598
00:58:30,400 --> 00:58:31,760
yeah so

1599
00:58:31,760 --> 00:58:34,799
we are at the closing point of this

1600
00:58:34,799 --> 00:58:36,400
particular panel

1601
00:58:36,400 --> 00:58:37,680
thank you everyone for your

1602
00:58:37,680 --> 00:58:40,640
participation and wonderful insights

1603
00:58:40,640 --> 00:58:43,440
and really quick so out of the reports

1604
00:58:43,440 --> 00:58:45,359
that we reviewed and other ones that we

1605
00:58:45,359 --> 00:58:48,960
pulled up which one do you feel wins

1606
00:58:48,960 --> 00:58:52,720
the difer report homecoming parade which

1607
00:58:52,720 --> 00:58:54,480
one was the best float or the best

1608
00:58:54,480 --> 00:58:58,079
report anyone chime in

1609
00:59:02,960 --> 00:59:07,040
i would say the 20 21 year in a review

1610
00:59:07,040 --> 00:59:09,359
okay just just because it has a lot of

1611
00:59:09,359 --> 00:59:11,920
things and it's very useful i believe

1612
00:59:11,920 --> 00:59:13,200
you could you could get a lot of

1613
00:59:13,200 --> 00:59:15,040
insights from this just just by reading

1614
00:59:15,040 --> 00:59:16,079
this and

1615
00:59:16,079 --> 00:59:18,640
doing some additional research

1616
00:59:18,640 --> 00:59:19,920
which is a thing that we didn't talk

1617
00:59:19,920 --> 00:59:21,599
about very much but additional research

1618
00:59:21,599 --> 00:59:23,839
is it's very cool with these reports so

1619
00:59:23,839 --> 00:59:25,200
you learn a thing

1620
00:59:25,200 --> 00:59:27,280
then you open the mitre attack website

1621
00:59:27,280 --> 00:59:29,280
and then you run another thing

1622
00:59:29,280 --> 00:59:32,400
and you you go down down the rabbit hole

1623
00:59:32,400 --> 00:59:33,839
but it's very interesting i believe this

1624
00:59:33,839 --> 00:59:36,000
report should be read by everyone and

1625
00:59:36,000 --> 00:59:38,319
should be hung on a wall

1626
00:59:38,319 --> 00:59:41,280
oh they did an amazing job and i think

1627
00:59:41,280 --> 00:59:43,760
i think uh you know just just from my

1628
00:59:43,760 --> 00:59:46,000
perspective we all love you know the

1629
00:59:46,000 --> 00:59:48,720
difa report and honestly i think all of

1630
00:59:48,720 --> 00:59:50,480
the reports win

1631
00:59:50,480 --> 00:59:51,280
so

1632
00:59:51,280 --> 00:59:53,280
i'm gonna i'm gonna throw my hat in the

1633
00:59:53,280 --> 00:59:56,079
ring and say that all of them win

1634
00:59:56,079 --> 00:59:56,960
um

1635
00:59:56,960 --> 00:59:59,760
and then and with that i also wanted to

1636
00:59:59,760 --> 01:00:01,920
close out this session and just let you

1637
01:00:01,920 --> 01:00:04,000
know that everyone on this panel we are

1638
01:00:04,000 --> 01:00:06,400
not speaking on behalf of our employers

1639
01:00:06,400 --> 01:00:08,319
and we're here in our own individual

1640
01:00:08,319 --> 01:00:10,799
capacity uh just to make the lawyers

1641
01:00:10,799 --> 01:00:13,200
happy so i had to throw that in there

1642
01:00:13,200 --> 01:00:15,119
i missed it at the beginning

1643
01:00:15,119 --> 01:00:17,200
other than that i hope you enjoy

1644
01:00:17,200 --> 01:00:19,920
defcon and have a great time for hacker

1645
01:00:19,920 --> 01:00:22,319
homecoming and thank you for joining us

1646
01:00:22,319 --> 01:00:28,759
on the d4 report homecoming parade panel

