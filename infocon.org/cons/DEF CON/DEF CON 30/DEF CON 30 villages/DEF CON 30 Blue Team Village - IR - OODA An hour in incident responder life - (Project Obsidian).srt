1
00:00:01,439 --> 00:00:02,560
welcome

2
00:00:02,560 --> 00:00:04,240
thanks for joining this session of

3
00:00:04,240 --> 00:00:06,879
bluetooth village project obsidian

4
00:00:06,879 --> 00:00:09,440
incident response and huda loop

5
00:00:09,440 --> 00:00:11,280
my name is julian and i will be your

6
00:00:11,280 --> 00:00:13,679
guide for this walkthrough

7
00:00:13,679 --> 00:00:15,839
it will focus on the udaloop and how to

8
00:00:15,839 --> 00:00:18,640
use it during security incident response

9
00:00:18,640 --> 00:00:21,119
and illustrated by two alert cases of

10
00:00:21,119 --> 00:00:23,840
the same incident

11
00:00:23,840 --> 00:00:25,840
this is part of a multiple walkthrough

12
00:00:25,840 --> 00:00:27,599
around incident response but also

13
00:00:27,599 --> 00:00:29,920
forensic threat intel and various other

14
00:00:29,920 --> 00:00:32,320
aspects of cyber defense we encourage

15
00:00:32,320 --> 00:00:34,640
you to at another session be it in real

16
00:00:34,640 --> 00:00:36,960
life or virtually

17
00:00:36,960 --> 00:00:39,040
one of those is around triage and

18
00:00:39,040 --> 00:00:41,360
scoping for which we will do a very

19
00:00:41,360 --> 00:00:44,680
quick reminder

20
00:00:47,680 --> 00:00:51,199
our agenda will be a quick introduction

21
00:00:51,199 --> 00:00:53,520
the udaloop some key questions for

22
00:00:53,520 --> 00:00:55,039
incident response

23
00:00:55,039 --> 00:00:57,120
or two alert case

24
00:00:57,120 --> 00:01:00,718
a lesson learned and conclusion

25
00:01:03,359 --> 00:01:06,000
for incident response

26
00:01:06,000 --> 00:01:07,600
you will start with the triage on

27
00:01:07,600 --> 00:01:09,200
scoping

28
00:01:09,200 --> 00:01:12,400
this is developed in a different session

29
00:01:12,400 --> 00:01:16,000
but as a reminder the sixth phase of a

30
00:01:16,000 --> 00:01:18,799
security incident are preparation

31
00:01:18,799 --> 00:01:22,640
identification contentment eradication

32
00:01:22,640 --> 00:01:25,520
recovery and lesson learned

33
00:01:25,520 --> 00:01:26,960
and

34
00:01:26,960 --> 00:01:28,960
as a fundamental part

35
00:01:28,960 --> 00:01:30,640
always keep in mind that you should

36
00:01:30,640 --> 00:01:33,360
document document and document what you

37
00:01:33,360 --> 00:01:35,920
are doing be it for your colleague bid

38
00:01:35,920 --> 00:01:38,960
for an auditor it for your management

39
00:01:38,960 --> 00:01:39,920
this is

40
00:01:39,920 --> 00:01:42,240
necessary for any security incident

41
00:01:42,240 --> 00:01:44,479
response

42
00:01:44,479 --> 00:01:46,479
please note also this presentation and

43
00:01:46,479 --> 00:01:48,000
the corresponding notebook will be

44
00:01:48,000 --> 00:01:51,520
available after defcon

45
00:01:52,880 --> 00:01:56,320
let's move to the ooda loop

46
00:01:56,799 --> 00:01:58,880
it's the huda loop has been developed by

47
00:01:58,880 --> 00:02:01,280
us colonel john boyd from the u.s air

48
00:02:01,280 --> 00:02:03,439
force in the 60s following his

49
00:02:03,439 --> 00:02:06,719
experience of co during the korean war

50
00:02:06,719 --> 00:02:08,959
it was initially for dogfight but the

51
00:02:08,959 --> 00:02:11,680
concept is widely applicable

52
00:02:11,680 --> 00:02:14,160
most notably for us to security and see

53
00:02:14,160 --> 00:02:16,319
that

54
00:02:16,319 --> 00:02:19,120
what does uda mean

55
00:02:19,120 --> 00:02:21,120
observe orient

56
00:02:21,120 --> 00:02:23,440
decide and act

57
00:02:23,440 --> 00:02:25,920
it's a quick sequence

58
00:02:25,920 --> 00:02:27,200
of

59
00:02:27,200 --> 00:02:29,680
steps that during a dog fight helps you

60
00:02:29,680 --> 00:02:32,959
to assess the situation and evaluate

61
00:02:32,959 --> 00:02:34,640
where you are what

62
00:02:34,640 --> 00:02:36,800
action you want to take and take the

63
00:02:36,800 --> 00:02:38,000
action

64
00:02:38,000 --> 00:02:38,959
and

65
00:02:38,959 --> 00:02:42,080
it's usually operated multiple times

66
00:02:42,080 --> 00:02:45,440
inside a dogfight to help you

67
00:02:45,440 --> 00:02:47,840
win against your attacker ideally

68
00:02:47,840 --> 00:02:49,680
because you are operating this loop

69
00:02:49,680 --> 00:02:52,560
faster than the attack

70
00:02:52,560 --> 00:02:54,720
it's kind of similar to the dimming

71
00:02:54,720 --> 00:02:58,560
wheel in iso standard the famous plane

72
00:02:58,560 --> 00:03:02,000
do check act but more at the micro level

73
00:03:02,000 --> 00:03:03,040
versus

74
00:03:03,040 --> 00:03:04,560
the macro

75
00:03:04,560 --> 00:03:08,560
level of iso standard

76
00:03:08,560 --> 00:03:10,480
obviously

77
00:03:10,480 --> 00:03:12,560
all the observation

78
00:03:12,560 --> 00:03:14,560
orientation decision

79
00:03:14,560 --> 00:03:17,360
will be based on the context

80
00:03:17,360 --> 00:03:20,720
of outside information of

81
00:03:20,720 --> 00:03:22,000
cultural

82
00:03:22,000 --> 00:03:25,200
information and past experience

83
00:03:25,200 --> 00:03:27,519
whatever has been analyzed during this

84
00:03:27,519 --> 00:03:30,519
event

85
00:03:33,680 --> 00:03:35,440
key question

86
00:03:35,440 --> 00:03:37,840
during an incident what is very

87
00:03:37,840 --> 00:03:40,000
important is identify

88
00:03:40,000 --> 00:03:42,959
what you know and what you don't know

89
00:03:42,959 --> 00:03:45,360
to quote donald trump cells they are

90
00:03:45,360 --> 00:03:48,640
known nouns they are known unknowns and

91
00:03:48,640 --> 00:03:50,560
they are unknown nouns and unknown

92
00:03:50,560 --> 00:03:53,120
unknowns

93
00:03:53,280 --> 00:03:55,120
the usual start

94
00:03:55,120 --> 00:03:58,200
is often is it a false positive is it a

95
00:03:58,200 --> 00:04:00,959
non-legitimate activity

96
00:04:00,959 --> 00:04:04,239
non-testing be it a pen testing or

97
00:04:04,239 --> 00:04:06,560
something else

98
00:04:06,560 --> 00:04:09,200
do we have enough visibility to assess

99
00:04:09,200 --> 00:04:11,519
the situation and at a sufficient

100
00:04:11,519 --> 00:04:13,439
confidence level

101
00:04:13,439 --> 00:04:14,400
that's

102
00:04:14,400 --> 00:04:16,880
very essential to say

103
00:04:16,880 --> 00:04:20,000
we are not making

104
00:04:20,000 --> 00:04:22,079
confirmation be a bias

105
00:04:22,079 --> 00:04:22,960
and

106
00:04:22,960 --> 00:04:25,360
mis-evaluating things because we have

107
00:04:25,360 --> 00:04:27,360
just for example one source of

108
00:04:27,360 --> 00:04:28,560
information

109
00:04:28,560 --> 00:04:29,680
which

110
00:04:29,680 --> 00:04:33,680
would maybe not be reliable

111
00:04:33,680 --> 00:04:35,840
we want to be sure that evidence can be

112
00:04:35,840 --> 00:04:37,199
preserved

113
00:04:37,199 --> 00:04:39,440
to be ensured that your colleague can do

114
00:04:39,440 --> 00:04:41,680
the same assessment or

115
00:04:41,680 --> 00:04:43,600
if things go to court

116
00:04:43,600 --> 00:04:45,919
that court can evaluate the same

117
00:04:45,919 --> 00:04:49,919
situation with the same information

118
00:04:50,400 --> 00:04:52,320
we want to know obviously which users

119
00:04:52,320 --> 00:04:53,759
are impacted

120
00:04:53,759 --> 00:04:56,720
which role and permissions they have

121
00:04:56,720 --> 00:04:59,840
same thing for system

122
00:04:59,840 --> 00:05:02,160
we want to know what stage of the attack

123
00:05:02,160 --> 00:05:04,479
it is and is it live

124
00:05:04,479 --> 00:05:06,880
active versus

125
00:05:06,880 --> 00:05:09,919
the attacker has left and you are only

126
00:05:09,919 --> 00:05:11,759
doing basically the cleaning or

127
00:05:11,759 --> 00:05:15,360
preventing the attacker to come back

128
00:05:16,000 --> 00:05:17,759
how did it start

129
00:05:17,759 --> 00:05:21,680
who or what is the patient zero

130
00:05:21,680 --> 00:05:23,919
the lateral movement occurred do we have

131
00:05:23,919 --> 00:05:27,039
just a single system impacted or are

132
00:05:27,039 --> 00:05:29,599
there many

133
00:05:30,639 --> 00:05:33,120
which data as accurate as access

134
00:05:33,120 --> 00:05:35,759
with some legal impact

135
00:05:35,759 --> 00:05:36,560
and

136
00:05:36,560 --> 00:05:38,880
last but not least what is the business

137
00:05:38,880 --> 00:05:40,320
impact

138
00:05:40,320 --> 00:05:42,639
where the service and availability some

139
00:05:42,639 --> 00:05:47,720
information disclosure or data tempering

140
00:05:52,080 --> 00:05:53,120
move to

141
00:05:53,120 --> 00:05:56,000
an earlier yet

142
00:05:56,080 --> 00:05:59,039
as part of project obsidian

143
00:05:59,039 --> 00:06:01,199
team has simulated

144
00:06:01,199 --> 00:06:04,880
different scenario and kill chain

145
00:06:04,880 --> 00:06:06,479
now we will see

146
00:06:06,479 --> 00:06:10,240
what happens is during an early level of

147
00:06:10,240 --> 00:06:12,400
this attack

148
00:06:12,400 --> 00:06:13,440
we got

149
00:06:13,440 --> 00:06:16,479
a notification

150
00:06:17,680 --> 00:06:20,560
in this case user brent sasham got an

151
00:06:20,560 --> 00:06:22,720
email notification that he logged in the

152
00:06:22,720 --> 00:06:26,160
company jam post but he didn't

153
00:06:26,160 --> 00:06:27,919
in a very good

154
00:06:27,919 --> 00:06:30,720
company member a notified security

155
00:06:30,720 --> 00:06:35,479
you are security what are you doing

156
00:06:38,080 --> 00:06:41,039
so identification phase

157
00:06:41,039 --> 00:06:43,039
i said for the huda loop

158
00:06:43,039 --> 00:06:45,199
we will do some question each question

159
00:06:45,199 --> 00:06:47,759
will result in one or maybe multiple

160
00:06:47,759 --> 00:06:50,240
observations those observations will

161
00:06:50,240 --> 00:06:52,400
orient investigation and result in

162
00:06:52,400 --> 00:06:55,679
decision and action

163
00:06:58,880 --> 00:07:02,720
one quick reminder as a start for any

164
00:07:02,720 --> 00:07:05,759
incident or alert

165
00:07:05,759 --> 00:07:07,840
have a ticket where you will document

166
00:07:07,840 --> 00:07:09,360
things

167
00:07:09,360 --> 00:07:11,919
acknowledge the alert to the user when

168
00:07:11,919 --> 00:07:14,479
it's a manual report and

169
00:07:14,479 --> 00:07:16,720
share the ticket reference

170
00:07:16,720 --> 00:07:19,360
depending on the context you might or

171
00:07:19,360 --> 00:07:22,560
might not share more information

172
00:07:22,560 --> 00:07:25,120
document what's known what's unknown

173
00:07:25,120 --> 00:07:27,280
what's your understanding of

174
00:07:27,280 --> 00:07:29,759
the initial reporting of the alert

175
00:07:29,759 --> 00:07:31,280
it's important

176
00:07:31,280 --> 00:07:34,000
to know that not all users are reporting

177
00:07:34,000 --> 00:07:37,280
things the same way and one user can say

178
00:07:37,280 --> 00:07:39,759
can share a lot of details when another

179
00:07:39,759 --> 00:07:41,280
will give you

180
00:07:41,280 --> 00:07:43,680
my computer is crashing and

181
00:07:43,680 --> 00:07:46,080
you you will have to ask the question to

182
00:07:46,080 --> 00:07:48,560
say yeah okay is it a secret incident

183
00:07:48,560 --> 00:07:51,120
and why

184
00:07:51,520 --> 00:07:56,400
what into you to make a security report

185
00:07:57,599 --> 00:08:00,479
following this documentation and as part

186
00:08:00,479 --> 00:08:02,800
of avoiding any bias

187
00:08:02,800 --> 00:08:07,120
you want to regularly have peer review

188
00:08:10,000 --> 00:08:12,479
first iteration of zeoda loop

189
00:08:12,479 --> 00:08:14,960
from an observation perspective

190
00:08:14,960 --> 00:08:15,840
we

191
00:08:15,840 --> 00:08:18,960
look at the ad authentication log

192
00:08:18,960 --> 00:08:20,479
which show

193
00:08:20,479 --> 00:08:22,720
a password spray attack has happened and

194
00:08:22,720 --> 00:08:25,599
multiple accounts were compromised

195
00:08:25,599 --> 00:08:28,240
we can orient ourselves by reaching out

196
00:08:28,240 --> 00:08:31,120
to it or lds to validate there is no

197
00:08:31,120 --> 00:08:34,080
related activity pen testing testing or

198
00:08:34,080 --> 00:08:36,320
similar that could be associated to this

199
00:08:36,320 --> 00:08:38,640
behavior

200
00:08:38,640 --> 00:08:40,880
after we want to decide do we want to

201
00:08:40,880 --> 00:08:43,200
move to the next phase or to more

202
00:08:43,200 --> 00:08:46,159
identification

203
00:08:49,200 --> 00:08:52,000
let's review how we can do this

204
00:08:52,000 --> 00:08:54,240
authentication

205
00:08:54,240 --> 00:08:56,959
as part of our jupiter notebook

206
00:08:56,959 --> 00:09:00,240
we are using mystic pi library to do a

207
00:09:00,240 --> 00:09:02,240
splunk query

208
00:09:02,240 --> 00:09:05,600
as an example we collect successful and

209
00:09:05,600 --> 00:09:07,360
failed logon

210
00:09:07,360 --> 00:09:11,680
per user account and source ip

211
00:09:13,120 --> 00:09:16,480
if we try to visualize this data we have

212
00:09:16,480 --> 00:09:17,920
a nice

213
00:09:17,920 --> 00:09:21,120
chart on the idiot identification

214
00:09:21,120 --> 00:09:22,959
by user

215
00:09:22,959 --> 00:09:24,000
and

216
00:09:24,000 --> 00:09:25,279
we can see

217
00:09:25,279 --> 00:09:27,360
this line

218
00:09:27,360 --> 00:09:29,920
which is

219
00:09:30,000 --> 00:09:30,959
nearly

220
00:09:30,959 --> 00:09:32,880
always associated with the password

221
00:09:32,880 --> 00:09:35,200
spread

222
00:09:35,200 --> 00:09:37,839
so normally this graph is interactive

223
00:09:37,839 --> 00:09:39,120
inside

224
00:09:39,120 --> 00:09:41,600
um the presentation mode it does not

225
00:09:41,600 --> 00:09:45,200
render as well as we want but

226
00:09:45,200 --> 00:09:47,600
we can change things

227
00:09:47,600 --> 00:09:48,880
let's see

228
00:09:48,880 --> 00:09:51,600
a snapshot of the rendering where we

229
00:09:51,600 --> 00:09:54,080
have more the user but we can see that

230
00:09:54,080 --> 00:09:56,399
all the user of the company basically

231
00:09:56,399 --> 00:09:57,440
has

232
00:09:57,440 --> 00:10:00,080
an attempt to log in

233
00:10:00,080 --> 00:10:02,880
on the chart we don't see if it's failed

234
00:10:02,880 --> 00:10:05,680
or successful

235
00:10:05,680 --> 00:10:06,480
but

236
00:10:06,480 --> 00:10:09,440
if we review another visualization

237
00:10:09,440 --> 00:10:11,120
per ip

238
00:10:11,120 --> 00:10:12,240
user

239
00:10:12,240 --> 00:10:14,000
versus ip

240
00:10:14,000 --> 00:10:15,040
we can

241
00:10:15,040 --> 00:10:16,240
see that

242
00:10:16,240 --> 00:10:19,600
all those logins are coming from

243
00:10:19,600 --> 00:10:22,399
a single ip address which for some

244
00:10:22,399 --> 00:10:24,640
reason i can't

245
00:10:24,640 --> 00:10:26,480
change in the presentation sorry for

246
00:10:26,480 --> 00:10:28,720
that

247
00:10:30,560 --> 00:10:32,640
with all the information it's easier to

248
00:10:32,640 --> 00:10:33,680
say

249
00:10:33,680 --> 00:10:35,040
from the log

250
00:10:35,040 --> 00:10:37,680
i want to get all successful login from

251
00:10:37,680 --> 00:10:41,600
this identified attacker source ip

252
00:10:41,600 --> 00:10:42,480
which

253
00:10:42,480 --> 00:10:44,240
from your

254
00:10:44,240 --> 00:10:46,640
security documentation and or uit

255
00:10:46,640 --> 00:10:48,480
documentation you can confirm if this

256
00:10:48,480 --> 00:10:51,040
source ip is related to your company or

257
00:10:51,040 --> 00:10:52,480
not

258
00:10:52,480 --> 00:10:55,040
in this case we can find that

259
00:10:55,040 --> 00:10:58,000
from a single ip we have five different

260
00:10:58,000 --> 00:11:00,480
users that have login and it's a public

261
00:11:00,480 --> 00:11:04,560
ip so it's likely that the attacker

262
00:11:04,560 --> 00:11:06,000
is using

263
00:11:06,000 --> 00:11:09,760
this as an entry point

264
00:11:11,360 --> 00:11:14,880
just with authentication log we know the

265
00:11:14,880 --> 00:11:17,600
attack vector is a password spread

266
00:11:17,600 --> 00:11:21,279
we have the source ip of the attacker

267
00:11:21,279 --> 00:11:23,519
maybe there is a single one maybe there

268
00:11:23,519 --> 00:11:24,959
is more

269
00:11:24,959 --> 00:11:26,880
and

270
00:11:26,880 --> 00:11:28,800
we have identified there is not just one

271
00:11:28,800 --> 00:11:31,279
account compromise but five

272
00:11:31,279 --> 00:11:34,160
it's important here to have not jumps

273
00:11:34,160 --> 00:11:38,160
again compared to the user report where

274
00:11:38,160 --> 00:11:40,079
if you had actions that directly you

275
00:11:40,079 --> 00:11:43,040
would have only one user

276
00:11:43,040 --> 00:11:45,200
contained or disabled

277
00:11:45,200 --> 00:11:46,079
and

278
00:11:46,079 --> 00:11:48,079
which would not have blocked the

279
00:11:48,079 --> 00:11:52,160
attacker because there were five access

280
00:11:52,160 --> 00:11:54,720
on a few things we don't know

281
00:11:54,720 --> 00:11:56,880
also account privilege

282
00:11:56,880 --> 00:11:59,440
are there any other entry point and

283
00:11:59,440 --> 00:12:03,920
what activity happened after that

284
00:12:05,839 --> 00:12:08,720
for further iteration of the udaloop

285
00:12:08,720 --> 00:12:10,959
we can check if there are

286
00:12:10,959 --> 00:12:13,680
where password reset if some mfa change

287
00:12:13,680 --> 00:12:15,519
happened if some

288
00:12:15,519 --> 00:12:18,079
cloud app token change

289
00:12:18,079 --> 00:12:20,240
we may want to collect more information

290
00:12:20,240 --> 00:12:22,240
be through a vm snapshot or more

291
00:12:22,240 --> 00:12:24,000
granular artifact collection like

292
00:12:24,000 --> 00:12:26,800
process activity network activity or

293
00:12:26,800 --> 00:12:28,880
tolerance

294
00:12:28,880 --> 00:12:31,120
depending on your environment we may

295
00:12:31,120 --> 00:12:34,639
want to add telemetry if it's missing

296
00:12:34,639 --> 00:12:37,440
host agent log collection network

297
00:12:37,440 --> 00:12:40,800
collection like ids ips

298
00:12:40,800 --> 00:12:42,160
and

299
00:12:42,160 --> 00:12:44,320
depending on your assessment of the

300
00:12:44,320 --> 00:12:45,440
incident

301
00:12:45,440 --> 00:12:47,519
notify management

302
00:12:47,519 --> 00:12:49,360
in depending on your company that may

303
00:12:49,360 --> 00:12:53,680
happen earlier that happen later

304
00:12:53,680 --> 00:12:56,800
depends on your process

305
00:12:56,880 --> 00:13:00,480
we won't dig further in this early alert

306
00:13:00,480 --> 00:13:02,160
case because

307
00:13:02,160 --> 00:13:06,920
we will review in the later last case

308
00:13:07,839 --> 00:13:10,720
now moving to the contentment

309
00:13:10,720 --> 00:13:12,320
contentment

310
00:13:12,320 --> 00:13:14,320
should be proportional to the type of

311
00:13:14,320 --> 00:13:16,880
incident and the business impact

312
00:13:16,880 --> 00:13:17,760
you

313
00:13:17,760 --> 00:13:20,399
are unlikely to stop a service that

314
00:13:20,399 --> 00:13:22,240
brings millions of revenue if you have a

315
00:13:22,240 --> 00:13:26,399
small phishing from a nigerian president

316
00:13:26,399 --> 00:13:27,200
and

317
00:13:27,200 --> 00:13:29,120
if you are if the attacker is

318
00:13:29,120 --> 00:13:31,519
exfoliating your customer data or your

319
00:13:31,519 --> 00:13:33,760
company intellectual property it's very

320
00:13:33,760 --> 00:13:35,600
likely that actions should be taken

321
00:13:35,600 --> 00:13:37,040
immediately

322
00:13:37,040 --> 00:13:39,440
those questions should be asking you to

323
00:13:39,440 --> 00:13:41,839
your leadership early on and ideally in

324
00:13:41,839 --> 00:13:44,160
preparation phase not during the

325
00:13:44,160 --> 00:13:47,160
incident

326
00:13:49,279 --> 00:13:51,120
first typical action for contentment

327
00:13:51,120 --> 00:13:55,279
lock disable the affected user account

328
00:13:56,240 --> 00:13:58,720
we may re-evaluate is it enough if it's

329
00:13:58,720 --> 00:13:59,920
not enough

330
00:13:59,920 --> 00:14:02,240
we can decide to content or isolate

331
00:14:02,240 --> 00:14:06,320
compromised system or suspicious one

332
00:14:06,320 --> 00:14:09,440
if email propagation is used we may want

333
00:14:09,440 --> 00:14:11,600
to freeze the mail server queue or

334
00:14:11,600 --> 00:14:15,279
recall or delete some email

335
00:14:15,279 --> 00:14:18,160
that's only a few of the actions that

336
00:14:18,160 --> 00:14:20,959
may happen or may be needed during an

337
00:14:20,959 --> 00:14:23,439
incident

338
00:14:25,680 --> 00:14:27,680
following contentment we are doing

339
00:14:27,680 --> 00:14:30,680
eradication

340
00:14:31,040 --> 00:14:33,199
normally we always want to rebuild

341
00:14:33,199 --> 00:14:34,959
compromised assets because from a

342
00:14:34,959 --> 00:14:36,800
security analyst perspective that's the

343
00:14:36,800 --> 00:14:40,160
only way to ensure that an asset is

344
00:14:40,160 --> 00:14:42,000
clean

345
00:14:42,000 --> 00:14:45,680
sometimes business will decide otherwise

346
00:14:45,680 --> 00:14:47,760
because

347
00:14:47,760 --> 00:14:49,440
the asset is a legacy it can't be

348
00:14:49,440 --> 00:14:52,079
rebuilt or it will take too much time

349
00:14:52,079 --> 00:14:54,639
ultimately that's an executive choice

350
00:14:54,639 --> 00:14:59,839
decision to balance between the risk

351
00:15:01,839 --> 00:15:05,519
after any rebuild you should ensure that

352
00:15:05,519 --> 00:15:08,639
the system is functional and protected

353
00:15:08,639 --> 00:15:10,480
depending on the assessment

354
00:15:10,480 --> 00:15:13,360
we ensure that patch or configuration

355
00:15:13,360 --> 00:15:15,519
has been fixed to ensure it can't be

356
00:15:15,519 --> 00:15:18,720
attacked and we obviously want to be

357
00:15:18,720 --> 00:15:20,480
sure that the business service is

358
00:15:20,480 --> 00:15:23,480
operational

359
00:15:27,360 --> 00:15:29,920
for recovery

360
00:15:29,920 --> 00:15:32,079
we declare return to normal service

361
00:15:32,079 --> 00:15:34,399
validate again that

362
00:15:34,399 --> 00:15:36,959
service are functional normal monitoring

363
00:15:36,959 --> 00:15:38,839
is functional no abnormal behavior

364
00:15:38,839 --> 00:15:41,519
observed for some

365
00:15:41,519 --> 00:15:43,279
grace period

366
00:15:43,279 --> 00:15:47,120
ensure attacker is not coming back

367
00:15:51,040 --> 00:15:55,000
let's move to the letter

368
00:15:55,040 --> 00:15:56,800
we are more at the end stage of the

369
00:15:56,800 --> 00:15:57,759
attack

370
00:15:57,759 --> 00:16:01,279
the previous alert has not happened or

371
00:16:01,279 --> 00:16:03,040
maybe was missed or

372
00:16:03,040 --> 00:16:06,000
misclassified

373
00:16:07,040 --> 00:16:09,440
we have an automated security alert

374
00:16:09,440 --> 00:16:12,399
raised on the company jam post

375
00:16:12,399 --> 00:16:17,279
titled mimikat's execution detection

376
00:16:17,759 --> 00:16:20,560
what are you doing

377
00:16:20,560 --> 00:16:23,279
let's do a quick reminder of what is

378
00:16:23,279 --> 00:16:26,399
mimikabs it's a very popular

379
00:16:26,399 --> 00:16:29,360
security tools that allow to extract

380
00:16:29,360 --> 00:16:32,160
plaintext password hash and value

381
00:16:32,160 --> 00:16:34,079
secrets from memory

382
00:16:34,079 --> 00:16:34,959
and

383
00:16:34,959 --> 00:16:37,440
it can perform various type of attack

384
00:16:37,440 --> 00:16:41,360
including puzzles as the ticket

385
00:16:41,360 --> 00:16:42,320
and

386
00:16:42,320 --> 00:16:43,600
it's very

387
00:16:43,600 --> 00:16:44,880
often

388
00:16:44,880 --> 00:16:50,680
used by attacker as an open source tool

389
00:16:53,920 --> 00:16:57,759
we start again from identification

390
00:16:58,079 --> 00:16:59,040
we talk

391
00:16:59,040 --> 00:17:04,160
about i.t staff or business staff

392
00:17:04,160 --> 00:17:06,240
it's very important that you have a good

393
00:17:06,240 --> 00:17:08,959
documentation between inventory identity

394
00:17:08,959 --> 00:17:11,439
matrix network matrix that will help you

395
00:17:11,439 --> 00:17:12,480
a lot

396
00:17:12,480 --> 00:17:13,439
but

397
00:17:13,439 --> 00:17:16,000
clearly it will never replace helpful

398
00:17:16,000 --> 00:17:17,679
stuff you still want to have

399
00:17:17,679 --> 00:17:19,599
documentations that will

400
00:17:19,599 --> 00:17:21,199
most often

401
00:17:21,199 --> 00:17:24,640
make your work easier and faster

402
00:17:24,640 --> 00:17:27,599
versus trying to wake up the engineering

403
00:17:27,599 --> 00:17:29,360
on call

404
00:17:29,360 --> 00:17:33,840
or wait somebody on a bridge

405
00:17:36,080 --> 00:17:38,799
first iteration of zoodalup again we try

406
00:17:38,799 --> 00:17:40,559
to validate is it a pen test or a

407
00:17:40,559 --> 00:17:43,039
legitimate activity

408
00:17:43,039 --> 00:17:46,799
by iit or buyers some non-user depending

409
00:17:46,799 --> 00:17:48,240
on your company

410
00:17:48,240 --> 00:17:50,799
you may have user

411
00:17:50,799 --> 00:17:53,840
more normal or more abnormal than others

412
00:17:53,840 --> 00:17:56,799
and doing some activity which may

413
00:17:56,799 --> 00:17:59,039
resemble

414
00:17:59,039 --> 00:18:00,480
an attacker

415
00:18:00,480 --> 00:18:01,360
it's

416
00:18:01,360 --> 00:18:03,200
part of the knowledge and the baselines

417
00:18:03,200 --> 00:18:05,679
that you build over time in preparation

418
00:18:05,679 --> 00:18:08,480
of incident

419
00:18:09,919 --> 00:18:13,039
next we confirm that the mimikats

420
00:18:13,039 --> 00:18:16,320
execution is not legitimate

421
00:18:16,320 --> 00:18:18,160
we want to know which credentials were

422
00:18:18,160 --> 00:18:21,600
stolen and are they reusable as is

423
00:18:21,600 --> 00:18:23,600
typically is it end user accounts

424
00:18:23,600 --> 00:18:27,520
service accounts some cloud accounts

425
00:18:27,760 --> 00:18:29,840
if it's local credential versus domain

426
00:18:29,840 --> 00:18:31,360
credential

427
00:18:31,360 --> 00:18:34,240
are the domain admin or are they

428
00:18:34,240 --> 00:18:36,000
standard user

429
00:18:36,000 --> 00:18:38,640
um are there some group policy object

430
00:18:38,640 --> 00:18:40,640
restrictions in place typically to

431
00:18:40,640 --> 00:18:41,760
prevent

432
00:18:41,760 --> 00:18:44,720
the use of a domain admin

433
00:18:44,720 --> 00:18:49,039
outside of certain system

434
00:18:49,200 --> 00:18:51,440
are you using labs which is a microsoft

435
00:18:51,440 --> 00:18:53,760
tool to ensure that

436
00:18:53,760 --> 00:18:55,360
only

437
00:18:55,360 --> 00:18:57,440
each local administrator password will

438
00:18:57,440 --> 00:18:59,600
be unique and this way they can't be

439
00:18:59,600 --> 00:19:03,678
reused to attack another system

440
00:19:03,760 --> 00:19:05,520
we want to know what attacker action

441
00:19:05,520 --> 00:19:09,200
occurred and whether data exfiltration

442
00:19:09,200 --> 00:19:11,840
active or not

443
00:19:15,679 --> 00:19:18,640
let's come back to our notebook and to a

444
00:19:18,640 --> 00:19:20,880
spline query we try to check

445
00:19:20,880 --> 00:19:23,360
the process activity

446
00:19:23,360 --> 00:19:26,160
here two example query with either event

447
00:19:26,160 --> 00:19:28,880
id 4688

448
00:19:28,880 --> 00:19:31,120
native process command line auditing in

449
00:19:31,120 --> 00:19:32,160
windows

450
00:19:32,160 --> 00:19:33,840
or with sysmon

451
00:19:33,840 --> 00:19:35,360
event id1

452
00:19:35,360 --> 00:19:37,919
which is an extra tool but often

453
00:19:37,919 --> 00:19:42,000
recommended by security people

454
00:19:44,160 --> 00:19:47,200
from a visualization perspective when we

455
00:19:47,200 --> 00:19:51,520
build the process tree of the jump pose

456
00:19:51,520 --> 00:19:54,320
we can see various activity

457
00:19:54,320 --> 00:19:57,440
attached to one of the user which is

458
00:19:57,440 --> 00:19:58,320
named

459
00:19:58,320 --> 00:20:01,280
pat resus

460
00:20:02,000 --> 00:20:03,200
sorry

461
00:20:03,200 --> 00:20:04,720
and

462
00:20:04,720 --> 00:20:07,600
you can see that there is a cascade of

463
00:20:07,600 --> 00:20:08,960
activity

464
00:20:08,960 --> 00:20:12,080
that's mostly related to

465
00:20:12,080 --> 00:20:14,320
poor shell but we will see other

466
00:20:14,320 --> 00:20:15,760
activity

467
00:20:15,760 --> 00:20:18,960
more on this screenshot where

468
00:20:18,960 --> 00:20:22,240
you can see some task list call some run

469
00:20:22,240 --> 00:20:23,760
dll32

470
00:20:23,760 --> 00:20:26,559
with the minidump argument

471
00:20:26,559 --> 00:20:30,320
some who am i common

472
00:20:32,960 --> 00:20:35,280
what we know from this process tree we

473
00:20:35,280 --> 00:20:36,559
can say

474
00:20:36,559 --> 00:20:39,200
reconnaissance activity has happened we

475
00:20:39,200 --> 00:20:41,679
we have some umi task list possibly

476
00:20:41,679 --> 00:20:43,679
other command

477
00:20:43,679 --> 00:20:46,720
we have a process memory dump

478
00:20:46,720 --> 00:20:50,320
which is unlikely to be any

479
00:20:50,320 --> 00:20:52,960
time legitimate the who am i your task

480
00:20:52,960 --> 00:20:55,440
is maybe your csi means can be

481
00:20:55,440 --> 00:20:56,960
responsible for it

482
00:20:56,960 --> 00:20:59,039
but doing a process memory dump

483
00:20:59,039 --> 00:21:01,120
very unlikely

484
00:21:01,120 --> 00:21:03,360
and we know that lateral movement

485
00:21:03,360 --> 00:21:04,880
occurred

486
00:21:04,880 --> 00:21:08,400
the cascading of powershell and csc with

487
00:21:08,400 --> 00:21:10,480
a computer list argument

488
00:21:10,480 --> 00:21:15,360
is a result of postploit invokport scan

489
00:21:15,360 --> 00:21:19,520
the csc is because powershell is

490
00:21:19,520 --> 00:21:22,480
calling a command let which is using

491
00:21:22,480 --> 00:21:26,720
c-sharp and as such each call is

492
00:21:26,720 --> 00:21:29,280
resulting in a csc

493
00:21:29,280 --> 00:21:30,799
children process

494
00:21:30,799 --> 00:21:31,600
that

495
00:21:31,600 --> 00:21:33,360
will

496
00:21:33,360 --> 00:21:35,360
do this

497
00:21:35,360 --> 00:21:38,080
live compilation

498
00:21:38,080 --> 00:21:40,639
of the blog

499
00:21:41,200 --> 00:21:43,039
one thing that we

500
00:21:43,039 --> 00:21:46,000
don't know or we don't see in

501
00:21:46,000 --> 00:21:48,799
this process three

502
00:21:48,799 --> 00:21:50,080
was

503
00:21:50,080 --> 00:21:51,440
mimi cats

504
00:21:51,440 --> 00:21:54,320
or some ps exec that

505
00:21:54,320 --> 00:21:59,158
you you can be in in the foreign

506
00:21:59,520 --> 00:22:02,000
there are there can be various reasons

507
00:22:02,000 --> 00:22:03,039
but

508
00:22:03,039 --> 00:22:04,880
one thing obviously the data can has

509
00:22:04,880 --> 00:22:06,960
been tempered by the attacker

510
00:22:06,960 --> 00:22:09,360
or inadvertently it can be a wrong

511
00:22:09,360 --> 00:22:11,679
filter by the analyst it can be a

512
00:22:11,679 --> 00:22:14,240
software bug or configuration is

513
00:22:14,240 --> 00:22:15,440
issue

514
00:22:15,440 --> 00:22:17,520
that's one reason you want to have

515
00:22:17,520 --> 00:22:20,480
multiple data source and validate they

516
00:22:20,480 --> 00:22:21,280
all

517
00:22:21,280 --> 00:22:25,799
goes into the same direction

518
00:22:28,159 --> 00:22:29,840
if we review another log we have

519
00:22:29,840 --> 00:22:31,520
identified that

520
00:22:31,520 --> 00:22:34,880
the activity is occurring on the rdp jam

521
00:22:34,880 --> 00:22:37,280
post

522
00:22:37,360 --> 00:22:40,320
sick was deployed in this environment we

523
00:22:40,320 --> 00:22:42,240
can try to filter

524
00:22:42,240 --> 00:22:44,159
some of the activity

525
00:22:44,159 --> 00:22:45,200
either

526
00:22:45,200 --> 00:22:48,000
by some top dns

527
00:22:48,000 --> 00:22:50,400
list top 1 million top

528
00:22:50,400 --> 00:22:52,799
10 000

529
00:22:52,799 --> 00:22:54,480
and say

530
00:22:54,480 --> 00:22:57,600
what are the domain left

531
00:22:57,600 --> 00:22:59,840
from some filtering action we can

532
00:22:59,840 --> 00:23:04,320
identify those domains interactsh.com

533
00:23:04,320 --> 00:23:07,360
file pizza financial magnum

534
00:23:07,360 --> 00:23:10,039
campusfinancial.com

535
00:23:10,039 --> 00:23:14,520
webwormhold.io transfer.sh

536
00:23:17,280 --> 00:23:18,960
what we know

537
00:23:18,960 --> 00:23:21,280
likely the attacker has done an

538
00:23:21,280 --> 00:23:23,679
excitation or maybe he's on

539
00:23:23,679 --> 00:23:26,080
doing it currently depending on on your

540
00:23:26,080 --> 00:23:28,639
timeline

541
00:23:28,880 --> 00:23:31,520
the only case and that's where it's

542
00:23:31,520 --> 00:23:33,760
important to know your company context

543
00:23:33,760 --> 00:23:36,000
is maybe there is a legitimate

544
00:23:36,000 --> 00:23:38,080
legitimate business use case

545
00:23:38,080 --> 00:23:39,120
but

546
00:23:39,120 --> 00:23:40,799
usually

547
00:23:40,799 --> 00:23:43,120
it will be for one series

548
00:23:43,120 --> 00:23:46,879
seeing four different service

549
00:23:47,760 --> 00:23:48,480
is

550
00:23:48,480 --> 00:23:51,679
less likely to be legitimate

551
00:23:51,679 --> 00:23:54,159
we also have seen some typo requests on

552
00:23:54,159 --> 00:23:58,080
company domain magnum tempus financial

553
00:23:58,080 --> 00:23:59,919
which suggests that the attacker was

554
00:23:59,919 --> 00:24:02,240
doing a manual execution

555
00:24:02,240 --> 00:24:05,200
sometimes it can be also

556
00:24:05,200 --> 00:24:07,760
a way to mislead the analyst by the

557
00:24:07,760 --> 00:24:08,960
attacker

558
00:24:08,960 --> 00:24:12,320
but at least as a first appreciation

559
00:24:12,320 --> 00:24:14,559
that seems the attacker was doing things

560
00:24:14,559 --> 00:24:17,039
manually not an automated or at least

561
00:24:17,039 --> 00:24:20,320
not a fully automated data

562
00:24:20,320 --> 00:24:21,919
you can review the forensic station

563
00:24:21,919 --> 00:24:25,440
walkthrough for more

564
00:24:28,159 --> 00:24:31,039
on containment

565
00:24:31,760 --> 00:24:32,960
depending on the pace of your

566
00:24:32,960 --> 00:24:35,600
investigation you may stop the attacker

567
00:24:35,600 --> 00:24:38,640
before during data exfiltration before

568
00:24:38,640 --> 00:24:42,960
data destruction and log wiping

569
00:24:44,480 --> 00:24:45,600
again

570
00:24:45,600 --> 00:24:48,400
we want to lock or disable affected user

571
00:24:48,400 --> 00:24:50,159
account

572
00:24:50,159 --> 00:24:52,320
we may also want to restrict network

573
00:24:52,320 --> 00:24:55,679
access bit by domain ip address to block

574
00:24:55,679 --> 00:24:57,440
command control

575
00:24:57,440 --> 00:24:59,520
access or to prevent exfiltration of

576
00:24:59,520 --> 00:25:00,640
data

577
00:25:00,640 --> 00:25:03,600
that will depend a lot of what are

578
00:25:03,600 --> 00:25:06,640
the options available in your company

579
00:25:06,640 --> 00:25:09,360
if for example you have a proxy or only

580
00:25:09,360 --> 00:25:12,760
an ids

581
00:25:15,360 --> 00:25:16,960
if you

582
00:25:16,960 --> 00:25:19,360
are arriving very late during the

583
00:25:19,360 --> 00:25:21,279
incident and

584
00:25:21,279 --> 00:25:23,200
you already observed that

585
00:25:23,200 --> 00:25:24,960
we are on a stage where the attacker is

586
00:25:24,960 --> 00:25:27,440
doing event log clearing

587
00:25:27,440 --> 00:25:29,440
on many servers including domain

588
00:25:29,440 --> 00:25:30,720
controller

589
00:25:30,720 --> 00:25:33,440
which means that they basically own most

590
00:25:33,440 --> 00:25:36,240
of your network

591
00:25:36,559 --> 00:25:39,520
it's time if not already to escalate to

592
00:25:39,520 --> 00:25:41,039
crisis team

593
00:25:41,039 --> 00:25:43,760
this will usually include someone from

594
00:25:43,760 --> 00:25:45,520
each executive branch legal

595
00:25:45,520 --> 00:25:47,440
communication hr

596
00:25:47,440 --> 00:25:49,520
potentially more

597
00:25:49,520 --> 00:25:51,679
if you have not already done so but

598
00:25:51,679 --> 00:25:53,520
hopefully it is done in formula

599
00:25:53,520 --> 00:25:56,520
management

600
00:25:56,640 --> 00:25:59,039
we may want to unplug from the network

601
00:25:59,039 --> 00:26:01,760
or shutdown impactor system

602
00:26:01,760 --> 00:26:03,520
unplugging from network is usually

603
00:26:03,520 --> 00:26:05,919
preferred as it will help to preserve

604
00:26:05,919 --> 00:26:08,799
evidence most notably in memory

605
00:26:08,799 --> 00:26:12,559
but it will depend a lot again on your

606
00:26:12,559 --> 00:26:14,720
context and what can you do especially

607
00:26:14,720 --> 00:26:15,840
in a re

608
00:26:15,840 --> 00:26:18,159
remote setup

609
00:26:18,159 --> 00:26:19,919
in worst case

610
00:26:19,919 --> 00:26:22,720
more global network shutdown typically

611
00:26:22,720 --> 00:26:26,240
at office or data center level maybe

612
00:26:26,240 --> 00:26:28,640
something needed

613
00:26:28,640 --> 00:26:30,960
you want to switch to out-of-band

614
00:26:30,960 --> 00:26:32,400
communication

615
00:26:32,400 --> 00:26:34,080
usually if an attacker has control on

616
00:26:34,080 --> 00:26:36,240
your domain controllers that means they

617
00:26:36,240 --> 00:26:38,880
also have control on

618
00:26:38,880 --> 00:26:42,159
your exchange or mail system your chat

619
00:26:42,159 --> 00:26:45,440
system likely

620
00:26:45,919 --> 00:26:48,640
you want to involve external partner

621
00:26:48,640 --> 00:26:50,320
your insurance

622
00:26:50,320 --> 00:26:54,480
your external returner which may be

623
00:26:54,480 --> 00:26:56,720
required or recommended by your

624
00:26:56,720 --> 00:26:58,480
insurance

625
00:26:58,480 --> 00:27:00,720
law enforcement

626
00:27:00,720 --> 00:27:03,520
information sharing and analytics center

627
00:27:03,520 --> 00:27:05,360
okay isac

628
00:27:05,360 --> 00:27:09,279
and nationals or sector cert

629
00:27:10,320 --> 00:27:12,559
those last two are

630
00:27:12,559 --> 00:27:14,720
very important because they help

631
00:27:14,720 --> 00:27:16,799
structure your the sharing of

632
00:27:16,799 --> 00:27:18,840
information and

633
00:27:18,840 --> 00:27:22,559
eventually share things in a way which

634
00:27:22,559 --> 00:27:25,039
are not

635
00:27:25,039 --> 00:27:27,279
liable for you and

636
00:27:27,279 --> 00:27:29,440
share this information in a way which is

637
00:27:29,440 --> 00:27:30,480
not

638
00:27:30,480 --> 00:27:34,200
necessarily identifiable

639
00:27:34,720 --> 00:27:37,600
it's important that you can help that if

640
00:27:37,600 --> 00:27:38,640
other

641
00:27:38,640 --> 00:27:41,120
companies have made similar threats you

642
00:27:41,120 --> 00:27:44,640
can get more input to react faster

643
00:27:44,640 --> 00:27:46,080
typically to

644
00:27:46,080 --> 00:27:50,080
to do the containment or to um

645
00:27:50,080 --> 00:27:53,200
know that this threat actor

646
00:27:53,200 --> 00:27:54,000
is

647
00:27:54,000 --> 00:27:56,399
respecting

648
00:27:56,399 --> 00:27:57,520
their

649
00:27:57,520 --> 00:28:00,080
engagement when you pay them or they are

650
00:28:00,080 --> 00:28:03,439
not respecting though

651
00:28:03,600 --> 00:28:05,760
you want to validate your backup

652
00:28:05,760 --> 00:28:08,799
normally that's an early recovery step

653
00:28:08,799 --> 00:28:09,840
but

654
00:28:09,840 --> 00:28:12,399
especially in a ransomware case it can

655
00:28:12,399 --> 00:28:15,279
influence contentment meaning results

656
00:28:15,279 --> 00:28:17,440
should be non-only early if your

657
00:28:17,440 --> 00:28:20,000
attacker has destroyed your backup or if

658
00:28:20,000 --> 00:28:22,240
your backup are corrupt or i've never

659
00:28:22,240 --> 00:28:23,679
been tested

660
00:28:23,679 --> 00:28:26,080
you probably have no backup and as a

661
00:28:26,080 --> 00:28:28,640
result you probably

662
00:28:28,640 --> 00:28:32,000
want to make more care on

663
00:28:32,000 --> 00:28:34,320
protecting system preservative evidence

664
00:28:34,320 --> 00:28:37,200
keep a copy of encrypted data if maybe a

665
00:28:37,200 --> 00:28:39,200
decryptor is found maybe in a month

666
00:28:39,200 --> 00:28:43,159
maybe in a year or whatever

667
00:28:44,720 --> 00:28:47,279
ultimately a very hard decision in a

668
00:28:47,279 --> 00:28:49,039
ransomware case is

669
00:28:49,039 --> 00:28:53,679
do you want or not pay around somewhere

670
00:28:53,679 --> 00:28:55,679
that's a very trolley problem or

671
00:28:55,679 --> 00:28:57,600
cornelian

672
00:28:57,600 --> 00:28:59,279
that you should think carefully and

673
00:28:59,279 --> 00:29:01,760
discuss with relevant parties

674
00:29:01,760 --> 00:29:04,159
there is no right answer from a security

675
00:29:04,159 --> 00:29:05,760
or law enforcement perspective the

676
00:29:05,760 --> 00:29:08,159
recommendation will be always

677
00:29:08,159 --> 00:29:10,159
not pay

678
00:29:10,159 --> 00:29:11,679
but obviously

679
00:29:11,679 --> 00:29:12,720
if

680
00:29:12,720 --> 00:29:17,200
your company's life is a stake

681
00:29:17,200 --> 00:29:20,159
that's a harder call especially if you

682
00:29:20,159 --> 00:29:23,919
are at risk to finance terrorism or

683
00:29:23,919 --> 00:29:27,240
cyber criminal

684
00:29:27,279 --> 00:29:29,760
you also want to monitor internet

685
00:29:29,760 --> 00:29:31,760
the different various media and forum to

686
00:29:31,760 --> 00:29:33,120
ensure that

687
00:29:33,120 --> 00:29:34,640
your incident

688
00:29:34,640 --> 00:29:36,799
is not leaked too early and that you

689
00:29:36,799 --> 00:29:39,279
have time to prepare

690
00:29:39,279 --> 00:29:41,840
communication

691
00:29:46,799 --> 00:29:50,000
eradication phase

692
00:29:50,799 --> 00:29:51,760
we want

693
00:29:51,760 --> 00:29:55,679
like previously we built assets but

694
00:29:55,679 --> 00:29:57,679
in ransomware case

695
00:29:57,679 --> 00:29:59,200
you have

696
00:29:59,200 --> 00:30:01,840
probably a very high number of system

697
00:30:01,840 --> 00:30:03,760
impacted and

698
00:30:03,760 --> 00:30:06,880
first you need if you have not already

699
00:30:06,880 --> 00:30:08,799
prepared it

700
00:30:08,799 --> 00:30:10,559
establish a priority for service

701
00:30:10,559 --> 00:30:13,760
recovery what should be repaired first

702
00:30:13,760 --> 00:30:15,679
is it your business system your payroll

703
00:30:15,679 --> 00:30:18,240
system your active directory whatever

704
00:30:18,240 --> 00:30:19,760
else

705
00:30:19,760 --> 00:30:22,320
ideally that's come from your disaster

706
00:30:22,320 --> 00:30:24,320
recovery plan or business continuity

707
00:30:24,320 --> 00:30:26,720
plan and it's done

708
00:30:26,720 --> 00:30:28,960
before any incident

709
00:30:28,960 --> 00:30:31,200
but if it's not the case that's your

710
00:30:31,200 --> 00:30:33,760
first step

711
00:30:34,159 --> 00:30:37,760
after rebuilding assets

712
00:30:37,760 --> 00:30:40,559
next like in the pre previous case we

713
00:30:40,559 --> 00:30:42,480
want to validate system are functional

714
00:30:42,480 --> 00:30:44,960
and protected we don't want the attacker

715
00:30:44,960 --> 00:30:47,600
to come back

716
00:30:48,960 --> 00:30:51,840
recovery

717
00:30:51,840 --> 00:30:53,840
stem done previously return to normal

718
00:30:53,840 --> 00:30:57,879
service validity

719
00:31:04,399 --> 00:31:07,679
finally the lesson learned

720
00:31:07,679 --> 00:31:11,039
you should have a final communication

721
00:31:11,039 --> 00:31:13,039
to close an incident

722
00:31:13,039 --> 00:31:15,039
and it should

723
00:31:15,039 --> 00:31:17,440
either include or be followed

724
00:31:17,440 --> 00:31:20,720
by the incident report

725
00:31:20,720 --> 00:31:23,120
this should include executive summary

726
00:31:23,120 --> 00:31:25,600
key findings with recommendation

727
00:31:25,600 --> 00:31:28,559
what went good what can we improve

728
00:31:28,559 --> 00:31:31,279
a high level timeline

729
00:31:31,279 --> 00:31:33,760
depending on your organization alignment

730
00:31:33,760 --> 00:31:36,320
with miter attack miter shield

731
00:31:36,320 --> 00:31:40,399
nist sp 853 or iso 27

732
00:31:40,399 --> 00:31:42,320
may be good addition

733
00:31:42,320 --> 00:31:44,720
and part of all recommendations should

734
00:31:44,720 --> 00:31:47,600
feed your org risk register and be

735
00:31:47,600 --> 00:31:48,960
visible to

736
00:31:48,960 --> 00:31:51,760
decision maker and executive

737
00:31:51,760 --> 00:31:54,320
you don't want to let an incident and

738
00:31:54,320 --> 00:31:55,600
use

739
00:31:55,600 --> 00:31:58,320
each incident is an opportunity for

740
00:31:58,320 --> 00:32:01,440
improvement if you are not using it you

741
00:32:01,440 --> 00:32:03,760
leave the door open to an attacker it

742
00:32:03,760 --> 00:32:05,600
could be the same one or it could be

743
00:32:05,600 --> 00:32:08,240
another one

744
00:32:08,399 --> 00:32:10,320
more will be developed in the final

745
00:32:10,320 --> 00:32:13,879
reporting walkthrough

746
00:32:18,240 --> 00:32:20,240
as a conclusion

747
00:32:20,240 --> 00:32:22,640
security incident response is very often

748
00:32:22,640 --> 00:32:24,000
a marathon

749
00:32:24,000 --> 00:32:26,000
you need to take care of your team and

750
00:32:26,000 --> 00:32:28,720
yourself plans for overload plans for

751
00:32:28,720 --> 00:32:33,519
helper be it internal or external

752
00:32:33,919 --> 00:32:36,720
preparation is key

753
00:32:36,720 --> 00:32:38,640
establishing process

754
00:32:38,640 --> 00:32:41,440
trust and collaboration take time train

755
00:32:41,440 --> 00:32:44,080
early train like you fight and fight

756
00:32:44,080 --> 00:32:46,799
like you train

757
00:32:47,760 --> 00:32:50,240
re-evaluate situation often during an

758
00:32:50,240 --> 00:32:51,360
incident

759
00:32:51,360 --> 00:32:53,519
if you have better situational awareness

760
00:32:53,519 --> 00:32:55,840
than the attacker the better know

761
00:32:55,840 --> 00:32:58,399
yourself know your enemy and you can

762
00:32:58,399 --> 00:33:02,240
fight 100 basel without disaster

763
00:33:02,240 --> 00:33:04,559
udalup is one method

764
00:33:04,559 --> 00:33:07,519
to structure this

765
00:33:08,000 --> 00:33:10,799
last make it easier for you and your

766
00:33:10,799 --> 00:33:13,519
team structure and automate

767
00:33:13,519 --> 00:33:16,399
the work so decision can be taken better

768
00:33:16,399 --> 00:33:18,159
and faster

769
00:33:18,159 --> 00:33:21,440
jupiter notebook is one way to structure

770
00:33:21,440 --> 00:33:24,320
to automate things and it helps to

771
00:33:24,320 --> 00:33:26,399
document and show the reasoning of

772
00:33:26,399 --> 00:33:30,320
investigation and avoid bias

773
00:33:35,279 --> 00:33:37,200
this is the end of this walkthrough

774
00:33:37,200 --> 00:33:39,200
thanks a lot for attending it

775
00:33:39,200 --> 00:33:41,360
i also want to thanks all the

776
00:33:41,360 --> 00:33:43,919
contributors to

777
00:33:43,919 --> 00:33:45,919
blog team village project obsidian and

778
00:33:45,919 --> 00:33:48,960
to project jupiter notebook panda mystic

779
00:33:48,960 --> 00:33:51,600
pie open source research

780
00:33:51,600 --> 00:33:53,600
enjoy blue team village and defcon be

781
00:33:53,600 --> 00:33:56,480
virtually or in real life

782
00:33:56,480 --> 00:33:58,880
thanks to you and

783
00:33:58,880 --> 00:34:00,960
join the conversation on

784
00:34:00,960 --> 00:34:04,120
all discord

