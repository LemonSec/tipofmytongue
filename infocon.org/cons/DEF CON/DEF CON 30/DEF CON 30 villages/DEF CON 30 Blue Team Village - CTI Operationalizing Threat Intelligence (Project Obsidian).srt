1
00:00:03,360 --> 00:00:05,840
all right

2
00:00:05,920 --> 00:00:07,680
welcome everyone

3
00:00:07,680 --> 00:00:11,280
this is module 4 operationalizing threat

4
00:00:11,280 --> 00:00:13,040
intelligence it's part of project

5
00:00:13,040 --> 00:00:16,040
obsidian

6
00:00:16,239 --> 00:00:18,720
so let's go ahead and

7
00:00:18,720 --> 00:00:21,359
kind of jump right in here

8
00:00:21,359 --> 00:00:22,080
so

9
00:00:22,080 --> 00:00:24,480
again we'll start with our objective

10
00:00:24,480 --> 00:00:26,160
for this module

11
00:00:26,160 --> 00:00:26,960
and

12
00:00:26,960 --> 00:00:28,320
we're going to

13
00:00:28,320 --> 00:00:31,119
sort of iterate over the cti life cycle

14
00:00:31,119 --> 00:00:32,000
here

15
00:00:32,000 --> 00:00:37,200
um touching on each phase as we go along

16
00:00:37,600 --> 00:00:39,360
um and yeah

17
00:00:39,360 --> 00:00:41,520
just want to point out to remember that

18
00:00:41,520 --> 00:00:44,399
opportunities for growth exist

19
00:00:44,399 --> 00:00:46,719
within each phase so

20
00:00:46,719 --> 00:00:49,039
just be mindful of that always keep an

21
00:00:49,039 --> 00:00:51,920
eye out for opportunities for growth as

22
00:00:51,920 --> 00:00:55,120
you're working your way through this

23
00:00:55,840 --> 00:00:59,039
all right so the objective here is

24
00:00:59,039 --> 00:01:00,320
short and sweet right we want to

25
00:01:00,320 --> 00:01:02,399
demonstrate how a report can be

26
00:01:02,399 --> 00:01:05,399
operationalized

27
00:01:07,439 --> 00:01:09,920
most organizations don't release

28
00:01:09,920 --> 00:01:12,720
intrusion reports and give all of the

29
00:01:12,720 --> 00:01:14,640
nitty-gritty details

30
00:01:14,640 --> 00:01:17,040
however there are some

31
00:01:17,040 --> 00:01:19,759
some companies and groups of people who

32
00:01:19,759 --> 00:01:20,640
do

33
00:01:20,640 --> 00:01:22,799
produce reports

34
00:01:22,799 --> 00:01:24,960
in-depth technical reports

35
00:01:24,960 --> 00:01:27,040
could be based on honeypot data or

36
00:01:27,040 --> 00:01:29,439
whatever the case might be

37
00:01:29,439 --> 00:01:32,000
so really this is an example

38
00:01:32,000 --> 00:01:36,079
of doing that very thing

39
00:01:37,600 --> 00:01:39,040
so

40
00:01:39,040 --> 00:01:41,200
planning and direction here

41
00:01:41,200 --> 00:01:43,520
um right so we want to establish goals

42
00:01:43,520 --> 00:01:45,920
and objectives during this phase

43
00:01:45,920 --> 00:01:48,240
um so hopefully that's done

44
00:01:48,240 --> 00:01:49,200
um

45
00:01:49,200 --> 00:01:50,640
and

46
00:01:50,640 --> 00:01:53,520
these goals and objectives

47
00:01:53,520 --> 00:01:54,960
can be

48
00:01:54,960 --> 00:01:58,000
separate and distinct from intelligence

49
00:01:58,000 --> 00:02:00,240
requirements or they can pair with

50
00:02:00,240 --> 00:02:03,040
intelligence requirements as well so

51
00:02:03,040 --> 00:02:05,920
no hard and fast rule there

52
00:02:05,920 --> 00:02:07,600
but all of this

53
00:02:07,600 --> 00:02:11,280
helps drive the work that we do as cti

54
00:02:11,280 --> 00:02:13,840
analysts

55
00:02:14,879 --> 00:02:17,280
for this demonstration some of our goals

56
00:02:17,280 --> 00:02:20,319
and objectives are to perform you know

57
00:02:20,319 --> 00:02:23,040
to sweep the environment for iocs

58
00:02:23,040 --> 00:02:24,239
um

59
00:02:24,239 --> 00:02:25,040
to

60
00:02:25,040 --> 00:02:27,280
present opportunities for blocks and

61
00:02:27,280 --> 00:02:31,200
detections to to our socket and it teams

62
00:02:31,200 --> 00:02:33,840
um we also want to see if we can come up

63
00:02:33,840 --> 00:02:35,680
with some new hunts some new threat

64
00:02:35,680 --> 00:02:36,959
hunts

65
00:02:36,959 --> 00:02:38,080
and

66
00:02:38,080 --> 00:02:40,640
to help see if we have

67
00:02:40,640 --> 00:02:43,120
detections and blocks in place we can

68
00:02:43,120 --> 00:02:45,920
create purple team test cases

69
00:02:45,920 --> 00:02:48,000
based on this incident

70
00:02:48,000 --> 00:02:50,879
so we'll touch on that a little bit and

71
00:02:50,879 --> 00:02:52,720
situational awareness is great for

72
00:02:52,720 --> 00:02:56,160
everybody across the board forensics

73
00:02:56,160 --> 00:03:00,319
team management and management team and

74
00:03:00,319 --> 00:03:04,040
executives as well

75
00:03:05,440 --> 00:03:08,159
um and so here's just a mind map of

76
00:03:08,159 --> 00:03:09,519
visualizing

77
00:03:09,519 --> 00:03:12,000
how our goals and objectives

78
00:03:12,000 --> 00:03:14,560
inform and engage with different teams

79
00:03:14,560 --> 00:03:18,120
across the organization

80
00:03:20,400 --> 00:03:22,159
all right so

81
00:03:22,159 --> 00:03:25,599
we'll get into collection here

82
00:03:25,599 --> 00:03:26,720
um

83
00:03:26,720 --> 00:03:28,640
so again just like we do in the real

84
00:03:28,640 --> 00:03:30,000
world

85
00:03:30,000 --> 00:03:33,599
we're using a report as our data source

86
00:03:33,599 --> 00:03:36,000
in our case we're using information

87
00:03:36,000 --> 00:03:39,920
gleaned from kill chain 3.

88
00:03:42,319 --> 00:03:44,239
if your organization is just starting

89
00:03:44,239 --> 00:03:48,080
out this information might be tracked

90
00:03:48,080 --> 00:03:51,200
on an internal wiki a spreadsheet

91
00:03:51,200 --> 00:03:54,670
something else or a combination of these

92
00:03:54,670 --> 00:03:55,760
[Music]

93
00:03:55,760 --> 00:03:58,159
so do what works best for you and again

94
00:03:58,159 --> 00:04:00,400
this is another opportunity for growth

95
00:04:00,400 --> 00:04:02,560
perhaps

96
00:04:02,560 --> 00:04:04,239
so we're going to review the report

97
00:04:04,239 --> 00:04:06,720
we're going to identify and extract all

98
00:04:06,720 --> 00:04:09,120
of the data and information that we find

99
00:04:09,120 --> 00:04:10,080
useful

100
00:04:10,080 --> 00:04:11,840
and we're going to store that tag it

101
00:04:11,840 --> 00:04:12,840
sort it

102
00:04:12,840 --> 00:04:14,799
etc

103
00:04:14,799 --> 00:04:17,680
sometimes this can be automated or parts

104
00:04:17,680 --> 00:04:19,759
of this could be automated

105
00:04:19,759 --> 00:04:21,600
so keep an eye out for for those

106
00:04:21,600 --> 00:04:23,759
opportunities as well if you're using a

107
00:04:23,759 --> 00:04:26,639
tip for example

108
00:04:26,880 --> 00:04:28,479
so

109
00:04:28,479 --> 00:04:30,800
moving around along

110
00:04:30,800 --> 00:04:32,800
processing

111
00:04:32,800 --> 00:04:35,759
um so yep so we're taking a report and

112
00:04:35,759 --> 00:04:38,560
we're going to identify the data pieces

113
00:04:38,560 --> 00:04:41,600
of data information and intelligence

114
00:04:41,600 --> 00:04:44,960
and pull all of that in

115
00:04:45,199 --> 00:04:46,880
and

116
00:04:46,880 --> 00:04:47,759
yeah

117
00:04:47,759 --> 00:04:49,600
automation of this

118
00:04:49,600 --> 00:04:51,680
can be useful

119
00:04:51,680 --> 00:04:53,840
especially if you're using a tip

120
00:04:53,840 --> 00:04:56,639
and integrating with a sim

121
00:04:56,639 --> 00:04:59,120
and again look for opportunities to

122
00:04:59,120 --> 00:05:02,000
develop this phase of the cti lifecycle

123
00:05:02,000 --> 00:05:03,600
as well

124
00:05:03,600 --> 00:05:06,800
yeah for example automating ioc sweeps

125
00:05:06,800 --> 00:05:09,440
so we can collect this data

126
00:05:09,440 --> 00:05:11,840
consume it and then just that have that

127
00:05:11,840 --> 00:05:13,919
automation on the back end send out to

128
00:05:13,919 --> 00:05:16,560
our sim to perform that that automated

129
00:05:16,560 --> 00:05:18,880
search

130
00:05:21,919 --> 00:05:24,800
analysis and production

131
00:05:24,800 --> 00:05:25,170
so

132
00:05:25,170 --> 00:05:27,280
[Music]

133
00:05:27,280 --> 00:05:28,560
for

134
00:05:28,560 --> 00:05:29,840
for this

135
00:05:29,840 --> 00:05:30,720
um

136
00:05:30,720 --> 00:05:33,280
we're really for this demonstration for

137
00:05:33,280 --> 00:05:34,880
this example we're really going to be

138
00:05:34,880 --> 00:05:37,120
focused on production

139
00:05:37,120 --> 00:05:39,280
more than analysis

140
00:05:39,280 --> 00:05:41,280
um

141
00:05:41,280 --> 00:05:43,280
so we're basing this off of a report

142
00:05:43,280 --> 00:05:44,160
from

143
00:05:44,160 --> 00:05:45,919
a peer organization

144
00:05:45,919 --> 00:05:48,000
um magnum tempest

145
00:05:48,000 --> 00:05:50,560
that's not us we're just taking a report

146
00:05:50,560 --> 00:05:53,039
from them and these are some of the

147
00:05:53,039 --> 00:05:55,199
things that we're going to include

148
00:05:55,199 --> 00:05:56,880
um

149
00:05:56,880 --> 00:05:59,440
it's a good place to get started

150
00:05:59,440 --> 00:06:01,680
um there's more things that you could

151
00:06:01,680 --> 00:06:04,319
include maybe you leave out one or two

152
00:06:04,319 --> 00:06:06,160
things

153
00:06:06,160 --> 00:06:08,560
so your mileage may vary here

154
00:06:08,560 --> 00:06:11,120
but this is at least a good place to

155
00:06:11,120 --> 00:06:13,520
start

156
00:06:17,840 --> 00:06:21,039
beyond the report it's

157
00:06:21,039 --> 00:06:24,400
worth mentioning um

158
00:06:24,400 --> 00:06:27,039
we want to get so the goal is to really

159
00:06:27,039 --> 00:06:29,600
get the data that we need to the teams

160
00:06:29,600 --> 00:06:32,800
that who need it right so we want to we

161
00:06:32,800 --> 00:06:34,560
want to be sure that whatever we're plot

162
00:06:34,560 --> 00:06:36,479
we're supplying defenders

163
00:06:36,479 --> 00:06:39,280
i.t the forensics team the threat hunt

164
00:06:39,280 --> 00:06:40,240
team

165
00:06:40,240 --> 00:06:42,400
that we're providing the appropriate

166
00:06:42,400 --> 00:06:43,520
data

167
00:06:43,520 --> 00:06:45,680
in the appropriate format

168
00:06:45,680 --> 00:06:48,160
or the required data i should say in the

169
00:06:48,160 --> 00:06:51,840
appropriate format for them

170
00:06:52,800 --> 00:06:54,639
in order to accomplish that data

171
00:06:54,639 --> 00:06:56,880
management is critical

172
00:06:56,880 --> 00:06:59,840
right how is data documented

173
00:06:59,840 --> 00:07:03,120
standardized and modeled

174
00:07:03,120 --> 00:07:05,759
across the different teams

175
00:07:05,759 --> 00:07:08,160
one team might might utilize this

176
00:07:08,160 --> 00:07:09,199
heavily

177
00:07:09,199 --> 00:07:11,039
and while another team might not and

178
00:07:11,039 --> 00:07:12,720
that's okay

179
00:07:12,720 --> 00:07:15,120
and also how is data quality measured

180
00:07:15,120 --> 00:07:17,950
that's that's important as well

181
00:07:17,950 --> 00:07:19,360
[Music]

182
00:07:19,360 --> 00:07:20,479
it's important

183
00:07:20,479 --> 00:07:22,400
someone should be in charge of this this

184
00:07:22,400 --> 00:07:23,759
shouldn't fall

185
00:07:23,759 --> 00:07:26,720
on any one team necessarily or one

186
00:07:26,720 --> 00:07:29,840
person to make it happen

187
00:07:29,840 --> 00:07:32,080
but

188
00:07:32,240 --> 00:07:34,560
someone should be in charge of this

189
00:07:34,560 --> 00:07:36,240
hopefully someone with with some data

190
00:07:36,240 --> 00:07:38,800
management background knowledge right

191
00:07:38,800 --> 00:07:40,960
this is a great resource all of these

192
00:07:40,960 --> 00:07:43,759
links link off to the threat hunter

193
00:07:43,759 --> 00:07:45,120
playbook

194
00:07:45,120 --> 00:07:48,000
so thank you cyberward dog for that

195
00:07:48,000 --> 00:07:50,160
again it's a great resource to to get

196
00:07:50,160 --> 00:07:52,000
started start thinking about this if

197
00:07:52,000 --> 00:07:53,840
you're not already

198
00:07:53,840 --> 00:07:56,879
it really is critical to

199
00:07:56,879 --> 00:07:59,120
to make sure every everyone has what

200
00:07:59,120 --> 00:08:00,400
they need

201
00:08:00,400 --> 00:08:02,160
and um

202
00:08:02,160 --> 00:08:03,840
yep so definitely want to call that out

203
00:08:03,840 --> 00:08:06,080
here

204
00:08:08,800 --> 00:08:10,479
and moving right along i'll go ahead and

205
00:08:10,479 --> 00:08:13,840
pass it over to lucid

206
00:08:17,840 --> 00:08:20,800
up your audio

207
00:08:20,800 --> 00:08:24,800
our first reset here perfect

208
00:08:24,800 --> 00:08:27,440
this is an ioc list that we've gotten

209
00:08:27,440 --> 00:08:30,160
from the report that we've been given

210
00:08:30,160 --> 00:08:32,719
based on the kill chain

211
00:08:32,719 --> 00:08:34,000
and we can see here that there's both

212
00:08:34,000 --> 00:08:37,200
urls and domains the urls look like they

213
00:08:37,200 --> 00:08:38,958
either point to

214
00:08:38,958 --> 00:08:40,559
tools that are commonly used in

215
00:08:40,559 --> 00:08:43,679
exploitation or

216
00:08:43,679 --> 00:08:46,880
other malicious files so a couple of

217
00:08:46,880 --> 00:08:47,920
domains

218
00:08:47,920 --> 00:08:50,240
that i recognize as

219
00:08:50,240 --> 00:08:53,600
kind of ephemeral file transfer services

220
00:08:53,600 --> 00:08:56,000
that might be used for exfiltration

221
00:08:56,000 --> 00:08:58,160
so these would be passed along in in a

222
00:08:58,160 --> 00:09:00,640
list format or some other format to the

223
00:09:00,640 --> 00:09:01,920
other teams

224
00:09:01,920 --> 00:09:03,760
the sock and the it teams might want to

225
00:09:03,760 --> 00:09:04,959
look through the environment look

226
00:09:04,959 --> 00:09:06,880
through firewall logs with a list like

227
00:09:06,880 --> 00:09:10,000
this and see

228
00:09:10,000 --> 00:09:12,399
is there any activity that matches this

229
00:09:12,399 --> 00:09:15,120
this ioc list

230
00:09:15,120 --> 00:09:17,200
and they might want to block things like

231
00:09:17,200 --> 00:09:20,080
these file transfer transfer services

232
00:09:20,080 --> 00:09:21,120
because there might not be any

233
00:09:21,120 --> 00:09:22,720
legitimate use in the environment for

234
00:09:22,720 --> 00:09:24,240
that kind of thing so you could quickly

235
00:09:24,240 --> 00:09:25,680
be able to pass

236
00:09:25,680 --> 00:09:28,640
a list a list that you got from a report

237
00:09:28,640 --> 00:09:31,120
like this on and immediately take action

238
00:09:31,120 --> 00:09:32,720
on it

239
00:09:32,720 --> 00:09:34,800
this could be a spreadsheet or a csv

240
00:09:34,800 --> 00:09:38,240
file sticks feeds

241
00:09:38,240 --> 00:09:40,399
or a stix feed could be another common

242
00:09:40,399 --> 00:09:43,200
way to capture and store iocs

243
00:09:43,200 --> 00:09:46,480
a lot of organizations would use a tip

244
00:09:46,480 --> 00:09:49,760
and then automate the distribution of

245
00:09:49,760 --> 00:09:52,399
a list like this to the various tools in

246
00:09:52,399 --> 00:09:55,040
the environment

247
00:09:55,839 --> 00:09:58,640
there's also

248
00:09:58,800 --> 00:10:01,360
in production you could have a report

249
00:10:01,360 --> 00:10:03,600
summary that used the diamond model of

250
00:10:03,600 --> 00:10:06,000
intrusion uh this

251
00:10:06,000 --> 00:10:08,399
visually and quickly shows uh the

252
00:10:08,399 --> 00:10:11,360
infrastructure that's been found

253
00:10:11,360 --> 00:10:14,240
the the kinds of victims

254
00:10:14,240 --> 00:10:16,079
or a specific victim in this case the

255
00:10:16,079 --> 00:10:18,320
kind of victim of financial organization

256
00:10:18,320 --> 00:10:21,120
or a financial organization too so

257
00:10:21,120 --> 00:10:23,760
this would be important

258
00:10:23,760 --> 00:10:27,279
and all the capabilities that were found

259
00:10:27,279 --> 00:10:29,519
and maybe it's possible also an

260
00:10:29,519 --> 00:10:30,959
adversarial threat that might have been

261
00:10:30,959 --> 00:10:33,200
identified this is a good good way to

262
00:10:33,200 --> 00:10:36,000
visualize a summary of the information

263
00:10:36,000 --> 00:10:37,760
but spreadsheets

264
00:10:37,760 --> 00:10:39,680
use a spreadsheet like this might not

265
00:10:39,680 --> 00:10:43,399
scale very well

266
00:10:46,000 --> 00:10:47,760
uh there's you could also

267
00:10:47,760 --> 00:10:49,760
pull a

268
00:10:49,760 --> 00:10:53,040
list of ttps uh that are laid out in the

269
00:10:53,040 --> 00:10:54,399
mitre attack

270
00:10:54,399 --> 00:10:56,800
that use the miter attack framework uh

271
00:10:56,800 --> 00:10:59,200
here we see lists of tactics techniques

272
00:10:59,200 --> 00:11:02,240
and procedures

273
00:11:03,360 --> 00:11:05,839
and it you can see some of these are sub

274
00:11:05,839 --> 00:11:08,720
techniques some of these are are not but

275
00:11:08,720 --> 00:11:10,160
anyway this is a quick

276
00:11:10,160 --> 00:11:12,000
visualization and list that could be

277
00:11:12,000 --> 00:11:13,839
consumed

278
00:11:13,839 --> 00:11:15,279
by

279
00:11:15,279 --> 00:11:19,120
other teams defense teams

280
00:11:22,480 --> 00:11:24,560
and this is a visualization

281
00:11:24,560 --> 00:11:28,000
of that same that same spreadsheet from

282
00:11:28,000 --> 00:11:29,360
before

283
00:11:29,360 --> 00:11:31,120
this shows

284
00:11:31,120 --> 00:11:32,959
areas

285
00:11:32,959 --> 00:11:35,680
for better visualization

286
00:11:35,680 --> 00:11:37,839
and detection

287
00:11:37,839 --> 00:11:40,240
and ways to harden the environment based

288
00:11:40,240 --> 00:11:44,640
on what you know about the techniques

289
00:11:44,640 --> 00:11:47,200
and this is a good visual to include

290
00:11:47,200 --> 00:11:49,600
good good thing to distribute

291
00:11:49,600 --> 00:11:51,760
this is basically off of the obsidian

292
00:11:51,760 --> 00:11:54,000
kill chain three this isn't all the

293
00:11:54,000 --> 00:11:55,839
details from kill chain 3 but this is a

294
00:11:55,839 --> 00:11:58,560
good visualization of some of the main

295
00:11:58,560 --> 00:12:00,160
things that happened during that kill

296
00:12:00,160 --> 00:12:02,399
chain

297
00:12:05,360 --> 00:12:06,720
there's another format that this could

298
00:12:06,720 --> 00:12:08,240
go in you could go ahead you could

299
00:12:08,240 --> 00:12:10,160
create a visualization like in the

300
00:12:10,160 --> 00:12:12,560
previous slide of the attack

301
00:12:12,560 --> 00:12:14,160
navigator layer

302
00:12:14,160 --> 00:12:15,760
and you could actually export that as a

303
00:12:15,760 --> 00:12:19,279
json file that could be useful

304
00:12:19,279 --> 00:12:20,160
to

305
00:12:20,160 --> 00:12:21,680
that could be preferred by one of the

306
00:12:21,680 --> 00:12:24,320
teams they could already have a way to

307
00:12:24,320 --> 00:12:25,440
consume

308
00:12:25,440 --> 00:12:28,399
json uh files and it would actually save

309
00:12:28,399 --> 00:12:30,880
them time

310
00:12:30,880 --> 00:12:32,720
and so that would be a reason to do it

311
00:12:32,720 --> 00:12:35,200
this way

312
00:12:37,519 --> 00:12:39,279
and we're also going to need a concise

313
00:12:39,279 --> 00:12:41,040
overview of the incident uh there may

314
00:12:41,040 --> 00:12:43,839
have been a summary of some kind in the

315
00:12:43,839 --> 00:12:46,720
uh the original uh report that we

316
00:12:46,720 --> 00:12:49,519
received uh we may want to take bits and

317
00:12:49,519 --> 00:12:51,680
pieces of that uh

318
00:12:51,680 --> 00:12:53,839
but for instance this could be a report

319
00:12:53,839 --> 00:12:56,160
intended for executives and it could

320
00:12:56,160 --> 00:12:57,200
uh

321
00:12:57,200 --> 00:12:59,279
answer some of the questions that we

322
00:12:59,279 --> 00:13:00,880
know that our executives are going to

323
00:13:00,880 --> 00:13:02,639
have

324
00:13:02,639 --> 00:13:04,399
you know this is important because it

325
00:13:04,399 --> 00:13:06,560
was another um

326
00:13:06,560 --> 00:13:08,959
financial institution another financial

327
00:13:08,959 --> 00:13:10,320
company

328
00:13:10,320 --> 00:13:11,279
um

329
00:13:11,279 --> 00:13:14,160
and it should go through all the how uh

330
00:13:14,160 --> 00:13:14,959
what

331
00:13:14,959 --> 00:13:16,160
how and

332
00:13:16,160 --> 00:13:17,760
why

333
00:13:17,760 --> 00:13:19,120
motivations

334
00:13:19,120 --> 00:13:21,040
uh you know of course every executive is

335
00:13:21,040 --> 00:13:23,120
going to ask how to prevent hey this

336
00:13:23,120 --> 00:13:24,480
happened to another company how are we

337
00:13:24,480 --> 00:13:26,320
going to prevent it from happening to to

338
00:13:26,320 --> 00:13:28,079
us

339
00:13:28,079 --> 00:13:33,000
include that in the executive summary

340
00:13:34,480 --> 00:13:37,040
dissemination

341
00:13:37,040 --> 00:13:38,959
this is just another

342
00:13:38,959 --> 00:13:41,920
map of all of the different

343
00:13:41,920 --> 00:13:45,440
stakeholders for dissemination

344
00:13:45,440 --> 00:13:46,800
and we

345
00:13:46,800 --> 00:13:49,360
want to have documented what the details

346
00:13:49,360 --> 00:13:51,680
that will be made of it what details

347
00:13:51,680 --> 00:13:53,600
will be made available to stakeholders

348
00:13:53,600 --> 00:13:56,160
just have this you know

349
00:13:56,160 --> 00:13:58,639
already defined uh for when we get

350
00:13:58,639 --> 00:14:02,440
reports like this

351
00:14:04,639 --> 00:14:05,680
and then

352
00:14:05,680 --> 00:14:09,680
as far as feedback and evaluation

353
00:14:11,360 --> 00:14:14,000
this is uh really defined during the fan

354
00:14:14,000 --> 00:14:16,880
during the planning and direction phase

355
00:14:16,880 --> 00:14:18,399
and it'll already have laid out a

356
00:14:18,399 --> 00:14:20,639
process for providing the feedback

357
00:14:20,639 --> 00:14:23,360
the cti team needs

358
00:14:23,360 --> 00:14:25,760
so people already know where to go

359
00:14:25,760 --> 00:14:28,000
if they have feedback on the product

360
00:14:28,000 --> 00:14:30,880
that gets produced or the the

361
00:14:30,880 --> 00:14:33,120
uh dissemination of the report that

362
00:14:33,120 --> 00:14:34,560
we've received

363
00:14:34,560 --> 00:14:35,600
um

364
00:14:35,600 --> 00:14:37,120
because this is critical you know it's

365
00:14:37,120 --> 00:14:40,399
critical uh that all of the the teams

366
00:14:40,399 --> 00:14:44,800
uh the stakeholders um can ask for what

367
00:14:44,800 --> 00:14:48,079
they need and help us to improve

368
00:14:48,079 --> 00:14:50,079
the the product that we're giving that

369
00:14:50,079 --> 00:14:52,480
the products that we're giving them

370
00:14:52,480 --> 00:14:56,760
that come from reports like these

371
00:14:58,480 --> 00:15:00,320
and we can use the

372
00:15:00,320 --> 00:15:03,600
cart model to evaluate cti

373
00:15:03,600 --> 00:15:06,480
and this is just is it complete is it

374
00:15:06,480 --> 00:15:11,800
accurate is it relevant is it timely

375
00:15:13,120 --> 00:15:16,000
and uh your resources you can

376
00:15:16,000 --> 00:15:19,040
use the miter attack navigator if you're

377
00:15:19,040 --> 00:15:21,519
working on something with kill chain 3

378
00:15:21,519 --> 00:15:22,480
you can

379
00:15:22,480 --> 00:15:25,040
use this tool to

380
00:15:25,040 --> 00:15:27,839
help you out or

381
00:15:27,920 --> 00:15:30,880
within your department

382
00:15:33,920 --> 00:15:37,600
all right great yeah um thank you lucid

383
00:15:37,600 --> 00:15:41,680
um thanks everyone for joining and

384
00:15:41,680 --> 00:15:44,079
um in the appendix here we do have an

385
00:15:44,079 --> 00:15:46,320
appendix going over uh the card model

386
00:15:46,320 --> 00:15:47,199
here

387
00:15:47,199 --> 00:15:49,680
um so this will be available

388
00:15:49,680 --> 00:15:51,920
um

389
00:15:52,480 --> 00:15:54,160
in the slides once we make those

390
00:15:54,160 --> 00:15:56,639
available again join the conversation

391
00:15:56,639 --> 00:15:59,759
there's link to our discord um

392
00:15:59,759 --> 00:16:02,079
yep we hope you enjoyed it and

393
00:16:02,079 --> 00:16:04,079
we'll see you um

394
00:16:04,079 --> 00:16:07,519
at def con if you see us feel free to uh

395
00:16:07,519 --> 00:16:10,560
pull us aside ask questions and yeah we

396
00:16:10,560 --> 00:16:11,759
look forward to continuing the

397
00:16:11,759 --> 00:16:12,959
conversation

398
00:16:12,959 --> 00:16:16,160
so thanks everyone

399
00:16:20,839 --> 00:16:25,040
cheers all right hey welcome to the demo

400
00:16:25,040 --> 00:16:27,600
um going to be covering

401
00:16:27,600 --> 00:16:29,519
maltego here

402
00:16:29,519 --> 00:16:32,160
using the community edition

403
00:16:32,160 --> 00:16:34,959
and just a quick overview of montego

404
00:16:34,959 --> 00:16:37,920
it is a link analysis tool and you'll

405
00:16:37,920 --> 00:16:40,079
see what i mean by that here in a minute

406
00:16:40,079 --> 00:16:40,959
um

407
00:16:40,959 --> 00:16:42,399
but it has these

408
00:16:42,399 --> 00:16:46,320
transforms here um so this is a way

409
00:16:46,320 --> 00:16:48,560
for us to

410
00:16:48,560 --> 00:16:50,399
um

411
00:16:50,399 --> 00:16:52,720
basically you know using an api here

412
00:16:52,720 --> 00:16:54,320
behind the scenes

413
00:16:54,320 --> 00:16:57,199
um we can use these

414
00:16:57,199 --> 00:16:59,279
um other services to find out more

415
00:16:59,279 --> 00:17:01,120
information about what we're looking at

416
00:17:01,120 --> 00:17:02,959
what we're what whatever it is we're

417
00:17:02,959 --> 00:17:04,400
investigating

418
00:17:04,400 --> 00:17:05,760
um

419
00:17:05,760 --> 00:17:07,119
for this example we're going to look at

420
00:17:07,119 --> 00:17:08,880
an ip address

421
00:17:08,880 --> 00:17:12,799
but here's a long list of um there more

422
00:17:12,799 --> 00:17:14,959
on the like paid version but

423
00:17:14,959 --> 00:17:15,919
um

424
00:17:15,919 --> 00:17:17,439
that that you can include yeah this is

425
00:17:17,439 --> 00:17:18,559
the community

426
00:17:18,559 --> 00:17:20,640
uh version here

427
00:17:20,640 --> 00:17:22,240
some of these are free many of them are

428
00:17:22,240 --> 00:17:24,880
you just need that api access so

429
00:17:24,880 --> 00:17:26,880
um you know if you're using hybrid

430
00:17:26,880 --> 00:17:29,280
analysis you need to have a an account

431
00:17:29,280 --> 00:17:32,720
on hybrid analysis and then link to it

432
00:17:32,720 --> 00:17:35,280
within here within multigo

433
00:17:35,280 --> 00:17:36,720
so

434
00:17:36,720 --> 00:17:38,640
that was just a quick super quick

435
00:17:38,640 --> 00:17:41,600
overview of montego

436
00:17:41,600 --> 00:17:44,240
here i have a graph

437
00:17:44,240 --> 00:17:46,960
and you see this ip address

438
00:17:46,960 --> 00:17:49,120
when i right click on this you'll see

439
00:17:49,120 --> 00:17:51,600
all the available transforms that can be

440
00:17:51,600 --> 00:17:52,880
executed

441
00:17:52,880 --> 00:17:54,799
so just for

442
00:17:54,799 --> 00:17:56,320
demonstration purposes i'm going to

443
00:17:56,320 --> 00:17:58,720
create a new graph so that opens up a

444
00:17:58,720 --> 00:18:00,480
new tab here

445
00:18:00,480 --> 00:18:02,240
and since i'm interested in

446
00:18:02,240 --> 00:18:04,320
investigating an ip address i'm going to

447
00:18:04,320 --> 00:18:05,760
drag this over

448
00:18:05,760 --> 00:18:07,840
and add it to the graph now this is just

449
00:18:07,840 --> 00:18:09,679
the default value here but i'm going to

450
00:18:09,679 --> 00:18:12,400
come over here

451
00:18:13,600 --> 00:18:16,799
copy pasta this

452
00:18:18,320 --> 00:18:20,400
all right

453
00:18:20,400 --> 00:18:22,960
um now i can just run all transforms and

454
00:18:22,960 --> 00:18:24,240
see what we get

455
00:18:24,240 --> 00:18:29,600
um or you can run them one at a time so

456
00:18:29,600 --> 00:18:32,959
let's just go ahead and run them all

457
00:18:38,799 --> 00:18:40,799
so that way we'll just get everything

458
00:18:40,799 --> 00:18:42,559
one fell swoop there all right so it

459
00:18:42,559 --> 00:18:44,799
looks like lots of stuff

460
00:18:44,799 --> 00:18:46,799
and when i zoom out here

461
00:18:46,799 --> 00:18:48,880
kind of see what's a little bit more of

462
00:18:48,880 --> 00:18:51,039
what's going on

463
00:18:51,039 --> 00:18:53,760
i can zoom in i'm here this number of

464
00:18:53,760 --> 00:18:54,960
results

465
00:18:54,960 --> 00:18:57,520
this is a nice feature

466
00:18:57,520 --> 00:19:00,400
you can knock this down to a low number

467
00:19:00,400 --> 00:19:02,320
and so then that way it'll it'll group

468
00:19:02,320 --> 00:19:04,320
all a bunch of these together all of the

469
00:19:04,320 --> 00:19:06,160
ones that are similar

470
00:19:06,160 --> 00:19:08,320
so

471
00:19:08,720 --> 00:19:12,080
right away we see some interesting um

472
00:19:12,080 --> 00:19:16,080
details here so this ip address is known

473
00:19:16,080 --> 00:19:16,880
to

474
00:19:16,880 --> 00:19:20,000
be used as a vpn it looks like

475
00:19:20,000 --> 00:19:21,919
uh potentially

476
00:19:21,919 --> 00:19:26,240
some bot used in bot activity

477
00:19:26,240 --> 00:19:28,080
so maybe some malware was reaching out

478
00:19:28,080 --> 00:19:29,440
to this

479
00:19:29,440 --> 00:19:33,600
a proxy potential there as well

480
00:19:33,840 --> 00:19:35,280
now we have

481
00:19:35,280 --> 00:19:36,480
javascript

482
00:19:36,480 --> 00:19:39,039
text xml

483
00:19:39,039 --> 00:19:41,600
more scrap javascript

484
00:19:41,600 --> 00:19:43,679
yeah we see something associated with

485
00:19:43,679 --> 00:19:45,919
advisory and that's

486
00:19:45,919 --> 00:19:48,640
understandable

487
00:19:49,440 --> 00:19:50,880
this is basically

488
00:19:50,880 --> 00:19:52,480
comes from a

489
00:19:52,480 --> 00:19:53,440
cisa

490
00:19:53,440 --> 00:19:55,600
alert this ip address

491
00:19:55,600 --> 00:19:56,960
um

492
00:19:56,960 --> 00:19:58,320
and

493
00:19:58,320 --> 00:19:59,600
there's something else interesting here

494
00:19:59,600 --> 00:20:01,440
here's a there's an executable there's a

495
00:20:01,440 --> 00:20:03,600
dll rather

496
00:20:03,600 --> 00:20:06,320
but it's a pe file

497
00:20:06,320 --> 00:20:08,880
um if we right click this and run the

498
00:20:08,880 --> 00:20:11,360
virus total transform let's see what

499
00:20:11,360 --> 00:20:13,760
happens

500
00:20:13,760 --> 00:20:15,760
all right great so we got

501
00:20:15,760 --> 00:20:17,120
we got some hits

502
00:20:17,120 --> 00:20:19,919
so let's see what was returned here all

503
00:20:19,919 --> 00:20:22,159
right we have some hash values

504
00:20:22,159 --> 00:20:24,400
additional ip addresses

505
00:20:24,400 --> 00:20:26,799
and some tags associated with it

506
00:20:26,799 --> 00:20:30,000
um being a pe

507
00:20:30,000 --> 00:20:31,280
assembly

508
00:20:31,280 --> 00:20:34,159
runtime modules

509
00:20:34,159 --> 00:20:37,200
64-bit all right

510
00:20:37,200 --> 00:20:38,799
so if we take

511
00:20:38,799 --> 00:20:40,799
so this is great right montego has

512
00:20:40,799 --> 00:20:42,080
provided us

513
00:20:42,080 --> 00:20:43,520
lots of additional information and

514
00:20:43,520 --> 00:20:46,400
context now

515
00:20:46,880 --> 00:20:48,640
so we know this

516
00:20:48,640 --> 00:20:52,159
ip address is malicious

517
00:20:52,159 --> 00:20:54,159
safe to say that or at least at one

518
00:20:54,159 --> 00:20:56,960
point in time it was

519
00:20:56,960 --> 00:20:59,760
and this dll is associated with that ip

520
00:20:59,760 --> 00:21:02,720
address could have been hosted on it

521
00:21:02,720 --> 00:21:04,080
um

522
00:21:04,080 --> 00:21:04,960
and

523
00:21:04,960 --> 00:21:06,960
well what is this dll

524
00:21:06,960 --> 00:21:10,000
not sure exactly um looks like some sort

525
00:21:10,000 --> 00:21:12,799
of virus looks like it's malicious right

526
00:21:12,799 --> 00:21:15,440
so let's this is where

527
00:21:15,440 --> 00:21:17,200
if we double click this

528
00:21:17,200 --> 00:21:20,240
we can find out more details about this

529
00:21:20,240 --> 00:21:22,320
entity here

530
00:21:22,320 --> 00:21:23,760
and

531
00:21:23,760 --> 00:21:26,559
so we can come in we can copy copy paste

532
00:21:26,559 --> 00:21:29,200
this hash here

533
00:21:29,200 --> 00:21:32,320
and i kind of can break out

534
00:21:32,320 --> 00:21:35,440
drop this at virustotal and do a search

535
00:21:35,440 --> 00:21:36,480
and

536
00:21:36,480 --> 00:21:38,400
see what the results are

537
00:21:38,400 --> 00:21:41,120
um so yeah wow

538
00:21:41,120 --> 00:21:43,440
trojan downloader

539
00:21:43,440 --> 00:21:47,200
trojan generic crypter x-gen

540
00:21:47,200 --> 00:21:50,880
cobalt strike trojan trojan trojan

541
00:21:50,880 --> 00:21:51,840
um

542
00:21:51,840 --> 00:21:54,000
oops

543
00:21:54,000 --> 00:21:56,159
didn't mean to do that so yeah clearly

544
00:21:56,159 --> 00:21:57,919
malicious right so now we can look at

545
00:21:57,919 --> 00:21:59,760
some of these other tabs and i hope this

546
00:21:59,760 --> 00:22:02,080
text is large enough i zoomed in quite a

547
00:22:02,080 --> 00:22:04,240
bit

548
00:22:04,240 --> 00:22:06,159
so we can kind of run through here yep

549
00:22:06,159 --> 00:22:08,480
it's associated with that dll

550
00:22:08,480 --> 00:22:10,720
okay

551
00:22:11,760 --> 00:22:14,000
we knew that but it's good to confirm

552
00:22:14,000 --> 00:22:16,240
that

553
00:22:16,799 --> 00:22:19,360
some other domains associated with this

554
00:22:19,360 --> 00:22:21,600
additional ip addresses as well these

555
00:22:21,600 --> 00:22:24,720
should have popped up in our graph here

556
00:22:24,720 --> 00:22:26,799
yes you can see those there so those

557
00:22:26,799 --> 00:22:30,080
were pulled in by maltigo

558
00:22:30,080 --> 00:22:32,240
behavior

559
00:22:32,240 --> 00:22:34,320
some interesting details perhaps here's

560
00:22:34,320 --> 00:22:37,440
some registry keys that are set

561
00:22:37,440 --> 00:22:40,400
um so yeah we could toss these over to

562
00:22:40,400 --> 00:22:42,720
our sock analysts

563
00:22:42,720 --> 00:22:43,670
perhaps

564
00:22:43,670 --> 00:22:45,200
[Music]

565
00:22:45,200 --> 00:22:47,919
if there's a an ongoing

566
00:22:47,919 --> 00:22:49,600
forensics investigation we could pass

567
00:22:49,600 --> 00:22:50,960
some of these details over to the

568
00:22:50,960 --> 00:22:53,120
forensics team

569
00:22:53,120 --> 00:22:55,440
give them potentially give them some

570
00:22:55,440 --> 00:22:56,640
information that they don't they're not

571
00:22:56,640 --> 00:22:57,760
aware of

572
00:22:57,760 --> 00:23:00,880
um so that's useful and

573
00:23:00,880 --> 00:23:03,360
some processes that were terminated

574
00:23:03,360 --> 00:23:05,840
uh which means these were also running

575
00:23:05,840 --> 00:23:07,840
when this occurred so that could be a

576
00:23:07,840 --> 00:23:10,320
useful clue there as well

577
00:23:10,320 --> 00:23:12,960
and you see this process stream

578
00:23:12,960 --> 00:23:14,000
or a

579
00:23:14,000 --> 00:23:16,880
couple processes one sort of tree there

580
00:23:16,880 --> 00:23:18,159
okay

581
00:23:18,159 --> 00:23:19,200
um

582
00:23:19,200 --> 00:23:22,080
so great we're finding more information

583
00:23:22,080 --> 00:23:24,080
after doing just a couple pivots there

584
00:23:24,080 --> 00:23:25,840
and

585
00:23:25,840 --> 00:23:28,320
look at this here we go it is associated

586
00:23:28,320 --> 00:23:30,640
with conti

587
00:23:30,640 --> 00:23:33,840
no surprise i knew that going into this

588
00:23:33,840 --> 00:23:35,600
because this provides that a good

589
00:23:35,600 --> 00:23:36,799
example

590
00:23:36,799 --> 00:23:37,760
um

591
00:23:37,760 --> 00:23:40,159
not everything leads to this or this

592
00:23:40,159 --> 00:23:42,480
deep or this rich

593
00:23:42,480 --> 00:23:44,240
but just want to demonstrate the

594
00:23:44,240 --> 00:23:46,400
possibilities that it can

595
00:23:46,400 --> 00:23:48,320
right and also the importance of

596
00:23:48,320 --> 00:23:51,679
utilizing different tools

597
00:23:51,679 --> 00:23:54,240
during our investigation no one tool is

598
00:23:54,240 --> 00:23:57,840
going to give us everything we want

599
00:23:58,080 --> 00:23:59,840
but you know that's why it's nice to

600
00:23:59,840 --> 00:24:01,200
have a

601
00:24:01,200 --> 00:24:02,240
you know

602
00:24:02,240 --> 00:24:04,640
a tool belt and we have a bunch of tools

603
00:24:04,640 --> 00:24:06,480
we can we can select and choose from

604
00:24:06,480 --> 00:24:07,760
depending on

605
00:24:07,760 --> 00:24:09,360
what it is we're we're trying to

606
00:24:09,360 --> 00:24:11,279
accomplish

607
00:24:11,279 --> 00:24:15,120
and what information what data we have

608
00:24:15,120 --> 00:24:17,120
so

609
00:24:17,120 --> 00:24:18,480
um and then

610
00:24:18,480 --> 00:24:21,120
we can kind of view this um in different

611
00:24:21,120 --> 00:24:23,360
ways here in matsugo

612
00:24:23,360 --> 00:24:24,480
so

613
00:24:24,480 --> 00:24:27,039
here's this is a nice view

614
00:24:27,039 --> 00:24:29,679
as it sort of centralizes things and you

615
00:24:29,679 --> 00:24:32,159
can see if there's overlap between

616
00:24:32,159 --> 00:24:34,720
entities

617
00:24:34,720 --> 00:24:38,400
there's another view as well

618
00:24:38,640 --> 00:24:40,080
so perhaps

619
00:24:40,080 --> 00:24:41,120
you know there's additional

620
00:24:41,120 --> 00:24:43,520
infrastructure that we can

621
00:24:43,520 --> 00:24:45,760
may want to investigate or additional

622
00:24:45,760 --> 00:24:47,440
pieces of malware

623
00:24:47,440 --> 00:24:49,840
or domains that we may want to

624
00:24:49,840 --> 00:24:52,879
investigate as well

625
00:24:53,840 --> 00:24:57,679
and go back to that original view here

626
00:24:57,679 --> 00:24:58,640
so

627
00:24:58,640 --> 00:25:02,320
started out with an ip address

628
00:25:02,320 --> 00:25:03,600
and

629
00:25:03,600 --> 00:25:06,000
we were able to pivot we were able to

630
00:25:06,000 --> 00:25:09,840
identify an executable or a dll

631
00:25:09,840 --> 00:25:11,840
and pivot on that

632
00:25:11,840 --> 00:25:14,799
um find it it's hash and find that it's

633
00:25:14,799 --> 00:25:17,919
associated with kanti

634
00:25:17,919 --> 00:25:20,000
all right hope you enjoy that just a

635
00:25:20,000 --> 00:25:23,279
brief overview of maltego and

636
00:25:23,279 --> 00:25:24,320
um

637
00:25:24,320 --> 00:25:26,559
brief overview on pivoting

638
00:25:26,559 --> 00:25:29,840
all right thank you

