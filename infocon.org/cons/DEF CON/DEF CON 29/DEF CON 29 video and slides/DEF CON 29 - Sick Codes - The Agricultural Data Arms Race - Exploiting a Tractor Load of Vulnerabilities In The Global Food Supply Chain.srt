1
00:00:01,770 --> 00:00:03,060
- Good afternoon, everyone.

2
00:00:03,060 --> 00:00:05,320
Welcome to The Agricultural
Data Arms Race.

3
00:00:05,320 --> 00:00:07,350
I'm your host, Sick.Codes,

4
00:00:07,350 --> 00:00:09,380
And today we'll be
exploiting a tractor load

5
00:00:09,380 --> 00:00:12,910
of vulnerabilities in the
global food supply chain

6
00:00:12,910 --> 00:00:13,863
in good faith.

7
00:00:14,730 --> 00:00:16,790
So I just want to start
off with a quick photo.

8
00:00:16,790 --> 00:00:18,290
It's from about the 1960s,

9
00:00:18,290 --> 00:00:20,723
and it's of a farmer using a hand tractor.

10
00:00:21,620 --> 00:00:25,640
This is a hand operated
tractor, as you can see.

11
00:00:25,640 --> 00:00:30,640
Compare that with the brand
new John Deere 7450 ProDrive

12
00:00:31,960 --> 00:00:35,710
Autonomous Forage Harvester
with GPS sensors all over it,

13
00:00:35,710 --> 00:00:38,100
a chainsaw, pretty much at the front

14
00:00:38,100 --> 00:00:41,560
and weighing over, 10 or 15 tons.

15
00:00:41,560 --> 00:00:43,510
So this is a monster of a device.

16
00:00:43,510 --> 00:00:45,350
Like I said, it's autonomous.

17
00:00:45,350 --> 00:00:48,860
So it can run off if
it's in the wrong hands.

18
00:00:48,860 --> 00:00:51,110
So I just want to start by
saying none of the research today

19
00:00:51,110 --> 00:00:53,600
was paid for, it's all done in good faith,

20
00:00:53,600 --> 00:00:55,160
and nothing today represents me

21
00:00:55,160 --> 00:00:56,320
or any of the people involved,

22
00:00:56,320 --> 00:00:59,270
our employers, past employers,
or future employers.

23
00:00:59,270 --> 00:01:01,130
We're not under any gag orders.

24
00:01:01,130 --> 00:01:03,530
The only thing we are sort of wary about

25
00:01:03,530 --> 00:01:05,280
is vulnerabilities that we can't mention

26
00:01:05,280 --> 00:01:07,040
that we would like to mention

27
00:01:07,040 --> 00:01:09,040
that's still going with some vendors

28
00:01:09,040 --> 00:01:12,970
and all the content in the
slides is Creative Commons Zero

29
00:01:12,970 --> 00:01:15,490
apart from any other stuff
that relates to other brands

30
00:01:15,490 --> 00:01:17,650
in that case, all
trademarks, logos and brands

31
00:01:17,650 --> 00:01:19,760
belong to them and remain the property

32
00:01:19,760 --> 00:01:21,722
of their respective owners.

33
00:01:21,722 --> 00:01:23,380
Just quickly on myself,

34
00:01:23,380 --> 00:01:26,180
I'm a good hackerman. I've
got a GitHub, a Twitter,

35
00:01:26,180 --> 00:01:27,480
a newly built LinkedIn.

36
00:01:27,480 --> 00:01:29,610
I've got a couple of massive projects.

37
00:01:29,610 --> 00:01:31,333
My biggest project is probably Docker-OSX,

38
00:01:31,333 --> 00:01:35,080
with 15k stars on GitHub
and 100k Docker pulls.

39
00:01:35,080 --> 00:01:37,490
So pretty much just QEMU Mac OS,

40
00:01:37,490 --> 00:01:40,030
but you can do a lot of stuff
with it, including iMessage,

41
00:01:40,030 --> 00:01:42,270
for security research purposes only.

42
00:01:42,270 --> 00:01:45,170
I just want to start by
showing you a quick map,

43
00:01:45,170 --> 00:01:49,920
emphasizing the amount
of brown little spots

44
00:01:49,920 --> 00:01:51,520
all over the place.

45
00:01:51,520 --> 00:01:54,050
And what these are, if
you don't know already,

46
00:01:54,050 --> 00:01:56,450
which a lot of you might
know, is they're farms.

47
00:01:57,700 --> 00:02:00,180
Yeah, you can actually zoom
right into those farms.

48
00:02:00,180 --> 00:02:05,180
And I don't want to obviously
dox to anyone, but yeah,

49
00:02:05,220 --> 00:02:07,230
if you were able to
access all those farms,

50
00:02:07,230 --> 00:02:08,790
you would be able to do things

51
00:02:08,790 --> 00:02:11,260
like over-spray chemicals on to the field.

52
00:02:11,260 --> 00:02:13,410
So if you were able to over
spray chemicals on the field,

53
00:02:13,410 --> 00:02:16,250
you could permanently denial
of service to that farm

54
00:02:16,250 --> 00:02:18,520
by simply over spraying one season,

55
00:02:18,520 --> 00:02:20,890
but literally loading
up the fertile ground

56
00:02:20,890 --> 00:02:22,330
with too many chemicals.

57
00:02:22,330 --> 00:02:24,850
And then the next year,
or even the next 50 years,

58
00:02:24,850 --> 00:02:27,150
it will be unfertile or
unsuitable ground for use.

59
00:02:27,150 --> 00:02:30,262
So you could permanently deny
service to a farmer's crop

60
00:02:30,262 --> 00:02:33,423
by literally a few
lines of malicious code.

61
00:02:34,290 --> 00:02:35,750
So that would, that's what
I'm trying to get out here,

62
00:02:35,750 --> 00:02:37,690
that denial of service is a huge impact

63
00:02:37,690 --> 00:02:41,760
for the agricultural industry
in that say, for example,

64
00:02:41,760 --> 00:02:45,390
coming to harvest season right
now is winter wheat harvest

65
00:02:45,390 --> 00:02:47,996
for some farmers, depending
on where you are in the US

66
00:02:47,996 --> 00:02:50,960
but you can actually denial
of service those farmers.

67
00:02:50,960 --> 00:02:53,544
And that also occurs during seeding time

68
00:02:53,544 --> 00:02:56,260
or planning time, and also spraying time,

69
00:02:56,260 --> 00:02:59,310
any one of these parts of the
supply chain of food and Ag,

70
00:02:59,310 --> 00:03:02,250
every single one of those
parts needs to be online,

71
00:03:02,250 --> 00:03:04,880
99.99999 SLA.

72
00:03:04,880 --> 00:03:07,470
If it does go down, farmers will tell you

73
00:03:07,470 --> 00:03:10,910
that they're pretty much
screwed for that season

74
00:03:10,910 --> 00:03:11,890
and they can lose crops.

75
00:03:11,890 --> 00:03:14,840
And some of the crops cost
hundreds of thousands of dollars.

76
00:03:14,840 --> 00:03:17,240
And if that information
or the login details

77
00:03:17,240 --> 00:03:19,200
or something like that was
provided to a third party,

78
00:03:19,200 --> 00:03:22,070
AKA state actor, they could do something

79
00:03:22,070 --> 00:03:23,730
like a malicious update to the tractor.

80
00:03:23,730 --> 00:03:24,850
They could play with the ECU,

81
00:03:24,850 --> 00:03:26,700
they could send it to overdrive,

82
00:03:26,700 --> 00:03:28,690
they could drive it
into the wrong location.

83
00:03:28,690 --> 00:03:31,433
They could send it in to
plant the wrong field.

84
00:03:32,470 --> 00:03:35,270
Most disturbingly, one of the guys

85
00:03:35,270 --> 00:03:37,890
mentioned this on my blog I did earlier

86
00:03:37,890 --> 00:03:40,170
is that they could offset the tractor

87
00:03:40,170 --> 00:03:43,330
by X amount of degrees or coordinates,

88
00:03:43,330 --> 00:03:45,210
and actually drive the
tractor onto the highway

89
00:03:45,210 --> 00:03:46,950
into a river, through a fence.

90
00:03:46,950 --> 00:03:49,430
And another example of
permanent denial of service.

91
00:03:49,430 --> 00:03:53,400
So what we consider downtime
in a website for five minutes

92
00:03:53,400 --> 00:03:56,950
might be the difference
between a tractor driving,

93
00:03:56,950 --> 00:03:59,306
auto track goes off,
tractor keeps driving,

94
00:03:59,306 --> 00:04:03,310
tractor hits a tree, or injures someone.

95
00:04:03,310 --> 00:04:04,420
And the big question here

96
00:04:04,420 --> 00:04:07,160
is why did we actually start
looking at agriculture,

97
00:04:07,160 --> 00:04:08,890
and why is it such a big issue,

98
00:04:08,890 --> 00:04:11,650
and why didn't a lot of
people start looking at it?

99
00:04:11,650 --> 00:04:12,940
The main reason was that nobody else

100
00:04:12,940 --> 00:04:13,940
was actually looking at it.

101
00:04:13,940 --> 00:04:16,260
So that's probably the biggest reason.

102
00:04:16,260 --> 00:04:18,707
And the biggest reason that
I started looking at it

103
00:04:18,707 --> 00:04:21,400
was someone who I know very
well named Paul Roberts

104
00:04:21,400 --> 00:04:23,487
from The Security Ledger
mentioned to me that,

105
00:04:23,487 --> 00:04:24,360
"Hey, it's really weird

106
00:04:24,360 --> 00:04:26,700
that there's no CVEs on
John Deere's products."

107
00:04:26,700 --> 00:04:28,880
And I go, what does John
Deere actually have?

108
00:04:28,880 --> 00:04:30,220
And then I thought about it for a bit

109
00:04:30,220 --> 00:04:31,770
and did a bit of research,

110
00:04:31,770 --> 00:04:33,707
and he introduced me to a couple of guys.

111
00:04:33,707 --> 00:04:36,080
One of the guys, namely
the first guy that I met

112
00:04:36,080 --> 00:04:37,910
was Willy Cade, and his grandfather

113
00:04:37,910 --> 00:04:40,630
was actually on the board
of directors at John Deere.

114
00:04:40,630 --> 00:04:44,647
And his grandfather actually
had a patent with John Deere.

115
00:04:44,647 --> 00:04:46,410
And that was including
this manure spreader

116
00:04:46,410 --> 00:04:48,290
that's down in bottom left.

117
00:04:48,290 --> 00:04:51,510
And Willy, obviously,
knows lot about farming

118
00:04:51,510 --> 00:04:54,500
and a lot about the
history of the activities

119
00:04:54,500 --> 00:04:57,120
of some of these farming
companies and all the way through

120
00:04:57,120 --> 00:05:01,040
to a fully autonomous
GPS controlled motherload

121
00:05:01,040 --> 00:05:04,700
of just steel and aluminium and danger.

122
00:05:04,700 --> 00:05:07,650
And also the emphasis of them
relying on all this equipment

123
00:05:07,650 --> 00:05:10,323
to feed every single one
of the people in the world.

124
00:05:12,350 --> 00:05:14,390
And not just that, but also feed

125
00:05:14,390 --> 00:05:16,180
all sorts of different industries,

126
00:05:16,180 --> 00:05:21,030
biofuels, biogas, carbon
emissions, et cetera.

127
00:05:21,030 --> 00:05:23,590
The second guy that I was
introduced to is Kevin Kenney,

128
00:05:23,590 --> 00:05:27,960
he's a big right to repair
enthusiast, as is Willie.

129
00:05:27,960 --> 00:05:32,960
Kevin lives out in Nebraska,
he's an engineer and a farmer,

130
00:05:33,340 --> 00:05:35,820
this photo is from a
Bloomberg article that he did

131
00:05:35,820 --> 00:05:37,510
in relation to how John Deere

132
00:05:37,510 --> 00:05:39,990
is screwing over a lot of farmers.

133
00:05:39,990 --> 00:05:43,570
And you can see he gets the
gravity of what's going on

134
00:05:43,570 --> 00:05:46,660
by the size of the wheel
that he's sitting in.

135
00:05:46,660 --> 00:05:48,465
These aren't ordinary wheels.

136
00:05:48,465 --> 00:05:50,493
They're not cheap to replace either.

137
00:05:51,610 --> 00:05:53,600
I'll just quickly breeze over the hackers.

138
00:05:53,600 --> 00:05:56,780
We've got myself, wabaf3t, D0rkerDevil,

139
00:05:56,780 --> 00:06:01,050
John Jackson, johnjhacking,
rej_ex, which is Robert Willis,

140
00:06:01,050 --> 00:06:05,080
we've got w0rmer, ChiefCoolArrow,
who is currently MIA,

141
00:06:05,080 --> 00:06:06,574
don't know where he is, and Kelly Kaoudis,

142
00:06:06,574 --> 00:06:10,381
who also helped us in a previous project.

143
00:06:10,381 --> 00:06:12,370
So every single farm is connected,

144
00:06:12,370 --> 00:06:14,778
whether it be through
5G, which is incoming.

145
00:06:14,778 --> 00:06:18,480
Obviously we have LTE
4G, we've got 2G and 3G,

146
00:06:18,480 --> 00:06:21,100
the older connections
or slower connections.

147
00:06:21,100 --> 00:06:23,820
LoRa works out in the field
because there's no obstructions

148
00:06:23,820 --> 00:06:25,940
and everyone can actually communicate

149
00:06:25,940 --> 00:06:27,160
over long, long distances,

150
00:06:27,160 --> 00:06:29,630
and there's no obstructions
usually on the farm.

151
00:06:29,630 --> 00:06:32,400
Obviously we have WiFi,
there's GPS involved,

152
00:06:32,400 --> 00:06:34,950
GPRS, which is still involved in Ukraine.

153
00:06:34,950 --> 00:06:36,840
And then we've got three different types

154
00:06:36,840 --> 00:06:38,470
of major corrections that I've mentioned

155
00:06:38,470 --> 00:06:42,321
called WAAS, RTK and NTRIP.

156
00:06:42,321 --> 00:06:45,170
So WAAs and RTK are radio-based,
but then there's NTRIP,

157
00:06:45,170 --> 00:06:47,610
which is kind of like NTP.

158
00:06:47,610 --> 00:06:51,750
So basically ping-based
location information.

159
00:06:51,750 --> 00:06:54,650
So pretty much pinging back
to servers or WiFi signals

160
00:06:54,650 --> 00:06:56,800
to be able to find your device

161
00:06:56,800 --> 00:06:59,792
based on triangulation of that ping time.

162
00:06:59,792 --> 00:07:04,400
This is a rough diagram, not
to scale in any way whatsoever,

163
00:07:04,400 --> 00:07:07,540
but that's GPS and then we
use GPS plus another one

164
00:07:07,540 --> 00:07:09,400
of those corrections signals
to actually triangulate

165
00:07:09,400 --> 00:07:11,590
the exact position of a device.

166
00:07:11,590 --> 00:07:13,960
And you can imagine planting

167
00:07:13,960 --> 00:07:16,680
and not having that sort
of accuracy and be planting

168
00:07:16,680 --> 00:07:18,670
every seed would be, for example,

169
00:07:18,670 --> 00:07:21,380
or every row might be
dipping into the next row

170
00:07:21,380 --> 00:07:23,160
or the row before it.

171
00:07:23,160 --> 00:07:24,964
And the data, what does it do?

172
00:07:24,964 --> 00:07:26,040
Well, it provides a price of corn.

173
00:07:26,040 --> 00:07:29,160
Corn is used in both ethanol production

174
00:07:29,160 --> 00:07:31,440
and it's also fed to
cows to make it livestock

175
00:07:31,440 --> 00:07:35,500
and other types of beef
and pork, et cetera.

176
00:07:35,500 --> 00:07:37,790
But it's also used in ethanol.

177
00:07:37,790 --> 00:07:39,570
And all of that data is also considered

178
00:07:39,570 --> 00:07:41,930
in some way or another trade secret.

179
00:07:41,930 --> 00:07:43,680
Considering all the
data that a farmer gets,

180
00:07:43,680 --> 00:07:46,059
which is, you can see in
the top left of the image

181
00:07:46,059 --> 00:07:48,669
that is actually the row with a overlay

182
00:07:48,669 --> 00:07:51,160
of the farm, again, it's quite dark,

183
00:07:51,160 --> 00:07:53,790
but it's an overlay of the
farm getting planted on to,

184
00:07:53,790 --> 00:07:57,410
and you can see that that data
is technically a trade secret

185
00:07:57,410 --> 00:07:59,890
and who has access to that data?

186
00:07:59,890 --> 00:08:02,560
Because all of that data at
the moment, as you can imagine,

187
00:08:02,560 --> 00:08:07,020
is getting shoved back
through a 4G or LTE connection

188
00:08:07,020 --> 00:08:08,730
or until the farmer gets back into range,

189
00:08:08,730 --> 00:08:11,170
if it gets sent back to
the operation center,

190
00:08:11,170 --> 00:08:13,160
which John Deere owns,

191
00:08:13,160 --> 00:08:15,450
and that's called the John
Deere operation center,

192
00:08:15,450 --> 00:08:17,940
which we hacked into, and
we're getting to that in a bit.

193
00:08:17,940 --> 00:08:20,660
So the biofuel sector is a sector

194
00:08:20,660 --> 00:08:23,400
of the agricultural industry that relies

195
00:08:23,400 --> 00:08:26,200
on amassing carbon dioxide
from the atmosphere

196
00:08:26,200 --> 00:08:28,620
and then burning it as biofuel.

197
00:08:28,620 --> 00:08:30,590
And this is the windows
XP background, obviously,

198
00:08:30,590 --> 00:08:32,390
and at the bottom, it's being used

199
00:08:32,390 --> 00:08:34,170
as a vineyard at some point in time.

200
00:08:34,170 --> 00:08:36,740
I don't know if it's exact
one, but it looks good.

201
00:08:36,740 --> 00:08:39,150
Other uses of the data
include carbon credits,

202
00:08:39,150 --> 00:08:42,520
the carbon offset market, and
a guy named Shannon Sedgwick

203
00:08:42,520 --> 00:08:44,280
who's a farmer in Australia
to a managing director

204
00:08:44,280 --> 00:08:46,370
of a couple of Ag security companies.

205
00:08:46,370 --> 00:08:47,410
He mentioned to me this,

206
00:08:47,410 --> 00:08:49,420
and I thought about it and
looked into it a bit more.

207
00:08:49,420 --> 00:08:51,440
And apparently it's
mandatory in some places,

208
00:08:51,440 --> 00:08:53,110
for example, Australia, depending on

209
00:08:53,110 --> 00:08:55,310
which industry you're in
and it can be voluntary.

210
00:08:55,310 --> 00:08:57,480
So if that data were to go missing, okay.

211
00:08:57,480 --> 00:08:58,780
So if that data was to go missing

212
00:08:58,780 --> 00:09:00,260
through some sort of attack,

213
00:09:00,260 --> 00:09:02,390
then that would be
catastrophic for that sort

214
00:09:02,390 --> 00:09:05,290
of government rebate-based
industry or mandatory industry.

215
00:09:06,910 --> 00:09:09,040
Now you can actually simulate,

216
00:09:09,040 --> 00:09:10,640
this is my developer
account at John Deere.

217
00:09:10,640 --> 00:09:13,230
You can simulate those devices
that I showed you earlier

218
00:09:13,230 --> 00:09:14,630
in the tractor cab.

219
00:09:14,630 --> 00:09:15,950
So you can simulate, for example,

220
00:09:15,950 --> 00:09:18,140
a self-propelled forage harvester

221
00:09:18,140 --> 00:09:20,120
I'll give you an example of one now.

222
00:09:20,120 --> 00:09:22,710
Now this is one, this is a big powerful,

223
00:09:22,710 --> 00:09:26,150
probably 300, 400, 500 horsepower machine.

224
00:09:26,150 --> 00:09:28,040
It just shreds, eats up everything

225
00:09:28,040 --> 00:09:30,210
that it comes into contact with.

226
00:09:30,210 --> 00:09:32,740
And that there gets used as forage,

227
00:09:32,740 --> 00:09:36,140
which forage is usually
used as feeding or biofuel

228
00:09:36,140 --> 00:09:38,550
or biomass and things like that.

229
00:09:38,550 --> 00:09:41,080
And basically you can have
look at the big teeth on it,

230
00:09:41,080 --> 00:09:43,943
it will shred anything that
it comes into contact with.

231
00:09:43,943 --> 00:09:47,062
That's an R thousand
series, it's got AutoTrac,

232
00:09:47,062 --> 00:09:49,940
so that will automatically
drive and steer the tractor

233
00:09:49,940 --> 00:09:52,688
for you, it'll stay in
line using AutoTrac,

234
00:09:52,688 --> 00:09:55,380
Auto Fill it will
automatically calculate how far

235
00:09:55,380 --> 00:09:58,060
it has to shoot the auger.

236
00:09:58,060 --> 00:10:01,780
And it's got a display it's
the 4640 based on Yocto Linux,

237
00:10:01,780 --> 00:10:03,460
which we'll get into later,

238
00:10:03,460 --> 00:10:05,670
and it's covered in sensors
and all this sort of stuff,

239
00:10:05,670 --> 00:10:08,420
and it will automatically
adjust and change speed.

240
00:10:08,420 --> 00:10:10,990
And it'll line up with the
cart next to it, grain cart,

241
00:10:10,990 --> 00:10:12,810
make sure it's all lined up.

242
00:10:12,810 --> 00:10:15,740
It's all autonomous and
see the big yellow dome.

243
00:10:15,740 --> 00:10:16,960
It's pretty small, it's on the top

244
00:10:16,960 --> 00:10:20,190
of the head of the tractor,
that's the GPS unit.

245
00:10:20,190 --> 00:10:22,430
I've got auto lock for staying in line.

246
00:10:22,430 --> 00:10:23,930
And then all that data gets sent back

247
00:10:23,930 --> 00:10:28,895
to your Windows 7 computer
at home, Windows Vista.

248
00:10:28,895 --> 00:10:30,860
And that gets translated through

249
00:10:30,860 --> 00:10:34,600
to someone on Windows 10 at the
John Deere operation center,

250
00:10:34,600 --> 00:10:37,210
someone manually handling the data.

251
00:10:37,210 --> 00:10:38,260
We've got some awesome features

252
00:10:38,260 --> 00:10:40,291
like John Deere connected support,

253
00:10:40,291 --> 00:10:42,160
where someone out in the middle of a field

254
00:10:42,160 --> 00:10:43,930
in a undisclosed location,

255
00:10:43,930 --> 00:10:45,820
you can actually log in to your tractor

256
00:10:45,820 --> 00:10:50,363
and control it remotely
per se, which is fantastic.

257
00:10:51,240 --> 00:10:52,880
As you can see, we've got remote access,

258
00:10:52,880 --> 00:10:55,880
so we just remote into
the tractor at any time.

259
00:10:55,880 --> 00:10:57,800
And that includes staff members.

260
00:10:57,800 --> 00:10:59,820
Those two massive things
I want to point out

261
00:10:59,820 --> 00:11:01,530
on that remote access display screen

262
00:11:01,530 --> 00:11:05,110
is that one, you can
send files to a tractor,

263
00:11:05,110 --> 00:11:07,843
two, it was copyright in
2014, so it's quite old,

264
00:11:07,843 --> 00:11:11,360
And three, you can remote
access the tractor.

265
00:11:11,360 --> 00:11:14,610
That's really important because
what we'll show you soon

266
00:11:14,610 --> 00:11:18,151
is that we were able to
manipulate this in some way.

267
00:11:18,151 --> 00:11:20,030
And then John Deere service support.

268
00:11:20,030 --> 00:11:22,260
Also, obviously there's a
threat actor on the inside.

269
00:11:22,260 --> 00:11:25,350
They can just automatically
access anyone's tractor

270
00:11:25,350 --> 00:11:28,910
through the master dealer
service admin portal,

271
00:11:28,910 --> 00:11:31,530
which is fantastically
set up so threat actors

272
00:11:31,530 --> 00:11:36,410
can do little amounts of
damage, hypothetically.

273
00:11:36,410 --> 00:11:40,270
So then I started to dip
my feet in and basically

274
00:11:40,270 --> 00:11:42,320
I'm just gonna quickly glance
over the first vulnerability,

275
00:11:42,320 --> 00:11:46,300
which was a username enumeration
one where I could obviously

276
00:11:46,300 --> 00:11:49,203
enumerate user names based on that.

277
00:11:49,203 --> 00:11:50,820
I've got the fortune 1000.

278
00:11:50,820 --> 00:11:52,110
I won't go into it cause
it's kind of boring,

279
00:11:52,110 --> 00:11:55,470
but I got the fortune 1000
CSV file, submitted that

280
00:11:55,470 --> 00:12:00,470
as a API request, and got
back 20% of the names, sorry,

281
00:12:01,370 --> 00:12:03,380
20% of those accounts being registered.

282
00:12:03,380 --> 00:12:05,440
This is me adding pieces
of equipment to my farm

283
00:12:05,440 --> 00:12:08,230
that I technically don't
own for research purposes,

284
00:12:08,230 --> 00:12:10,676
but I've just picked up these numbers

285
00:12:10,676 --> 00:12:13,940
from a auction website and
there's a lot of data involved.

286
00:12:13,940 --> 00:12:17,260
So all it'll say is this
machine has already been added,

287
00:12:17,260 --> 00:12:19,500
but in the response there's a ton of data.

288
00:12:19,500 --> 00:12:22,290
So all it will say is
equipment already exists.

289
00:12:22,290 --> 00:12:23,590
And I've had to skip a little bit here

290
00:12:23,590 --> 00:12:25,210
because there's a lot of PII,

291
00:12:25,210 --> 00:12:28,520
including first name, last
name, leasee, address line one,

292
00:12:28,520 --> 00:12:30,610
address line two, and
everything like that.

293
00:12:30,610 --> 00:12:33,460
And I've had to skip that
obviously, cause it's PII.

294
00:12:33,460 --> 00:12:37,000
So Vice covered this, writer
named Lorenzo, great guy.

295
00:12:37,000 --> 00:12:38,637
He covered it in a story,

296
00:12:38,637 --> 00:12:42,680
"Bugs Allowed Hackers to Dox
All John Deere Tractor Owners".

297
00:12:42,680 --> 00:12:44,683
So originally the article did say all,

298
00:12:44,683 --> 00:12:46,830
but John Deere apparently
reached out to them

299
00:12:46,830 --> 00:12:48,040
as opposed to reaching out to us

300
00:12:48,040 --> 00:12:50,370
and said that it's only some tractors

301
00:12:50,370 --> 00:12:54,957
and the actual conclusion there
is it's only new tractors,

302
00:12:54,957 --> 00:12:56,663
which is probably even worse.

303
00:12:57,530 --> 00:13:00,350
So shortly after that,
a hacker named wabaf3t

304
00:13:00,350 --> 00:13:01,720
reached out to me and told me

305
00:13:01,720 --> 00:13:06,416
he's got five XSS vulnerabilities
in the John Deere website.

306
00:13:06,416 --> 00:13:09,250
And I asked him if he could
reach out to me on signal,

307
00:13:09,250 --> 00:13:10,290
we can have a look.

308
00:13:10,290 --> 00:13:14,230
And that's when we found his
motive, so I said to him,

309
00:13:14,230 --> 00:13:17,007
there's a really funny
comment where I said, ah,

310
00:13:17,007 --> 00:13:19,117
"fuck doing this for free" where he said,

311
00:13:19,117 --> 00:13:19,950
"well, at the end of the day,

312
00:13:19,950 --> 00:13:22,777
I'd rather do this for
free than lose food".

313
00:13:23,660 --> 00:13:26,430
And someone's got to
save their dumb asses.

314
00:13:26,430 --> 00:13:28,400
And he obviously mentioned
it to John Deere.

315
00:13:28,400 --> 00:13:30,480
And he said that he's got
vulnerabilities to report

316
00:13:30,480 --> 00:13:32,860
and we try to report it to John Deere.

317
00:13:32,860 --> 00:13:35,260
So we got, we were granted safe harbor,

318
00:13:35,260 --> 00:13:37,840
which means we can do
whatever the hell we want,

319
00:13:37,840 --> 00:13:39,120
as long as it's in good faith

320
00:13:39,120 --> 00:13:42,020
and they won't do anything
in terms of legal issues.

321
00:13:42,020 --> 00:13:45,100
So once you click that link,
it brings you to their website

322
00:13:45,100 --> 00:13:47,090
and that allows you to submit a form,

323
00:13:47,090 --> 00:13:50,310
and then that form gets you
onto their hacker one program

324
00:13:50,310 --> 00:13:52,170
of which I was the first researcher in.

325
00:13:52,170 --> 00:13:53,590
And I've now since left the program

326
00:13:53,590 --> 00:13:55,660
because it's a NDA program.

327
00:13:55,660 --> 00:13:57,730
There's no bounties, they've
got swag apparently now,

328
00:13:57,730 --> 00:13:58,840
which I don't give a shit about

329
00:13:58,840 --> 00:14:01,050
because I don't want to
give my address to them.

330
00:14:01,050 --> 00:14:02,557
But here's the first
vulnerability, the XSS.

331
00:14:02,557 --> 00:14:05,140
So its basically just a DOM based XSS,

332
00:14:05,140 --> 00:14:07,520
which I'll get into
later, but this is just me

333
00:14:07,520 --> 00:14:09,800
pretty much showing you that it exists.

334
00:14:09,800 --> 00:14:12,080
Obviously XSS is a really
basic vulnerability,

335
00:14:12,080 --> 00:14:13,945
but what it does show you is that

336
00:14:13,945 --> 00:14:16,440
they're not taking into
consideration basic vulnerabilities.

337
00:14:16,440 --> 00:14:18,930
They're not taking into
consideration the fact that somebody

338
00:14:18,930 --> 00:14:23,930
can just literally produce
basic 2015 level XSS

339
00:14:24,380 --> 00:14:26,620
on one of their major password sites.

340
00:14:26,620 --> 00:14:29,510
What do I mean major, because
it's a Supply Network page

341
00:14:30,450 --> 00:14:33,150
and I could just log in as
a guest or not even log in,

342
00:14:33,150 --> 00:14:35,340
and we can also see the dev or QA part

343
00:14:35,340 --> 00:14:38,070
of the supply network, which
was even more exciting.

344
00:14:38,070 --> 00:14:41,210
So this is the John Deere
supply network page,

345
00:14:41,210 --> 00:14:43,190
where you can, due to new functionality,

346
00:14:43,190 --> 00:14:45,030
just supply a purchase order number

347
00:14:45,030 --> 00:14:49,071
and receive all the information
back related to a purchase

348
00:14:49,071 --> 00:14:51,989
it's for suppliers only,
but we were able access it,

349
00:14:51,989 --> 00:14:53,193
of course.

350
00:14:54,410 --> 00:14:59,083
And as you can see here, this
is me just putting in a star

351
00:14:59,083 --> 00:15:02,280
and then the response,
apparently, for some reason,

352
00:15:02,280 --> 00:15:06,350
it gives you a invoice number of 0106,

353
00:15:06,350 --> 00:15:08,870
which we then further
use to try and enumerate

354
00:15:08,870 --> 00:15:11,330
other invoice numbers in some way.

355
00:15:11,330 --> 00:15:14,480
And we ended up seeing that
it's an IBM Db2 database,

356
00:15:14,480 --> 00:15:16,774
which I didn't have much knowledge about,

357
00:15:16,774 --> 00:15:18,510
but what it did do in the response

358
00:15:18,510 --> 00:15:21,340
is give us a really nice
constructed error message

359
00:15:21,340 --> 00:15:23,250
that shows the offending query

360
00:15:23,250 --> 00:15:26,520
and showing that we were able
to inject it in some way,

361
00:15:26,520 --> 00:15:29,863
because that was not the
original query whatsoever.

362
00:15:29,863 --> 00:15:34,373
And some more errors from a
John Deere copyright 2011.

363
00:15:35,510 --> 00:15:37,720
And for some reason, they still had

364
00:15:37,720 --> 00:15:40,220
the 1999 version of their portal up

365
00:15:41,790 --> 00:15:44,290
with lots of cool different
buttons we could press

366
00:15:45,250 --> 00:15:47,470
and the single sign-on didn't work.

367
00:15:47,470 --> 00:15:49,060
So I don't know why it was still up

368
00:15:49,060 --> 00:15:50,140
or we didn't test it enough,

369
00:15:50,140 --> 00:15:52,140
but that probably should not be there.

370
00:15:52,140 --> 00:15:54,260
As you can tell, it's quite old.

371
00:15:54,260 --> 00:15:56,240
John Deere employee
access, which we obviously

372
00:15:56,240 --> 00:15:58,350
shouldn't be able to just enter.

373
00:15:58,350 --> 00:15:59,900
It's the John Deere University,

374
00:16:00,740 --> 00:16:03,080
that's the John Deere Machine Book.

375
00:16:03,080 --> 00:16:05,754
This is a really funny device, actually.

376
00:16:05,754 --> 00:16:07,730
This is the place where
you go to book machines,

377
00:16:07,730 --> 00:16:10,550
demo units to provide to
farmers, like YouTubers

378
00:16:10,550 --> 00:16:13,030
or something like that, like influencers,

379
00:16:13,030 --> 00:16:15,000
or demo units to whatever.

380
00:16:15,000 --> 00:16:16,810
And there's a little DOM based XSS

381
00:16:16,810 --> 00:16:18,353
that we put in the bottom
of the reservation page.

382
00:16:18,353 --> 00:16:20,710
You can see that it's got
the back tick then, sorry,

383
00:16:20,710 --> 00:16:23,010
it's got the double quote
and the right arrow.

384
00:16:24,000 --> 00:16:26,910
So not only that, but we
were able to book units

385
00:16:26,910 --> 00:16:29,570
and spec units, were able
to cancel appointments,

386
00:16:29,570 --> 00:16:32,320
reassign tractors to certain locations.

387
00:16:32,320 --> 00:16:34,870
It doesn't sound exciting, but we did do,

388
00:16:34,870 --> 00:16:37,290
which was kind of exciting was
we just injected the database

389
00:16:37,290 --> 00:16:40,539
and pulled out every single
row for every single session.

390
00:16:40,539 --> 00:16:42,530
But yeah, we could see every demo unit

391
00:16:42,530 --> 00:16:45,320
that was ever provided and
all the John Deere user names,

392
00:16:45,320 --> 00:16:48,343
email addresses that were
use to book those units.

393
00:16:50,285 --> 00:16:53,110
Then we found something specific, okay.

394
00:16:53,110 --> 00:16:57,920
So this is the Dere single
sign on SAML edge server

395
00:16:57,920 --> 00:17:00,100
instruction ReadMe file.

396
00:17:00,100 --> 00:17:05,100
So John Jackson and rej_ex
discovered a CVE end platform

397
00:17:05,220 --> 00:17:07,610
named Pega or Pega.

398
00:17:07,610 --> 00:17:10,720
And what it is is like a
default admin credential style.

399
00:17:10,720 --> 00:17:12,760
By the way, if you don't change it,

400
00:17:12,760 --> 00:17:15,100
you pretty much just give everyone access

401
00:17:15,100 --> 00:17:17,590
to your remote Pega server.

402
00:17:17,590 --> 00:17:20,516
That's what we did. It's
got a 6.6 for some reason,

403
00:17:20,516 --> 00:17:21,466
NIST gave it a 4.9.

404
00:17:22,490 --> 00:17:24,120
I'd probably give it a 7 or an 8

405
00:17:24,120 --> 00:17:27,220
depending on what the company is,

406
00:17:27,220 --> 00:17:29,940
but in this case, it completely destroyed

407
00:17:29,940 --> 00:17:33,850
integrity and confidentiality
of John Deere's one.

408
00:17:33,850 --> 00:17:36,630
As you can see, we had
access to the single sign on,

409
00:17:36,630 --> 00:17:40,630
the SAML, there's a John
Deere backup part there,

410
00:17:40,630 --> 00:17:42,750
we've got the request approval,

411
00:17:42,750 --> 00:17:44,930
we've got all sorts of cool stuff.

412
00:17:44,930 --> 00:17:46,560
There's the edge server we got from there.

413
00:17:46,560 --> 00:17:49,360
And then interestingly
from that information

414
00:17:49,360 --> 00:17:52,320
we got some administrative
Pega credentials,

415
00:17:52,320 --> 00:17:54,170
as you can see I've had to blur out

416
00:17:54,170 --> 00:17:57,198
the password and the system ID name

417
00:17:57,198 --> 00:18:00,330
and the time difference
and all this sort of stuff,

418
00:18:00,330 --> 00:18:02,570
just to make sure you can't,
I guess, replicate it,

419
00:18:02,570 --> 00:18:04,453
but it's the process Pega commander.

420
00:18:05,540 --> 00:18:08,170
Secondly, we've got a
portal admin server data,

421
00:18:08,170 --> 00:18:11,400
administrative account
credential password here as well,

422
00:18:11,400 --> 00:18:14,340
which is ridiculous,
we shouldn't have this.

423
00:18:14,340 --> 00:18:15,580
We've got a security audit log,

424
00:18:15,580 --> 00:18:19,503
which we should be not able to view.

425
00:18:20,430 --> 00:18:22,330
And we could see our own selves in there

426
00:18:22,330 --> 00:18:24,730
and then Pega admins
logging in for some reason.

427
00:18:25,750 --> 00:18:30,020
And then we had this gold piece
of whatever the heck it is.

428
00:18:30,020 --> 00:18:35,020
It is their Okta signing
certificate, I believe.

429
00:18:35,810 --> 00:18:38,900
So what we've got blurred
out is the ID number

430
00:18:38,900 --> 00:18:40,770
that relates to their Okta account.

431
00:18:40,770 --> 00:18:42,880
We've got the KMS, which is their,

432
00:18:42,880 --> 00:18:46,200
I guess is their the Pega
administrative Okta address URL

433
00:18:46,200 --> 00:18:48,700
that goes to signed tokens, et cetera.

434
00:18:48,700 --> 00:18:51,280
We've got the original
signature password blurred out.

435
00:18:51,280 --> 00:18:54,840
We've got the prod symbol
there, so you know it's in use.

436
00:18:54,840 --> 00:18:57,310
We've got the original decryption
password also blurred out

437
00:18:57,310 --> 00:19:00,140
for obvious reasons, with the
signing certificate details.

438
00:19:00,140 --> 00:19:02,380
And you can see clearly
that it's John Deere

439
00:19:02,380 --> 00:19:03,663
and it's Okta related.

440
00:19:04,730 --> 00:19:07,290
And furthermore, I've
only blurred it out once

441
00:19:07,290 --> 00:19:09,137
for some reason, and they've
get the single sign on,

442
00:19:09,137 --> 00:19:11,610
the SAML URL related
to the John Deere side.

443
00:19:11,610 --> 00:19:13,930
And then down the bottom, we've
got a decryption certificate

444
00:19:13,930 --> 00:19:16,810
and a beautiful expiry out of 2029.

445
00:19:16,810 --> 00:19:20,080
From this, just backtracking,
this can pretty much allow us

446
00:19:20,080 --> 00:19:24,460
to upload files to any
user, log in as any user,

447
00:19:24,460 --> 00:19:27,230
destroy any farm, run
any farm off the road,

448
00:19:27,230 --> 00:19:28,900
upload whatever we want,
download whatever we want,

449
00:19:28,900 --> 00:19:32,240
destroy any data, log in to
any third party accounts.

450
00:19:32,240 --> 00:19:34,560
We could literally do
whatever the heck we wanted

451
00:19:34,560 --> 00:19:35,640
with anything we wanted

452
00:19:35,640 --> 00:19:38,140
on the John Deere
operation center, period.

453
00:19:38,140 --> 00:19:39,500
And that's when we pretty much stopped

454
00:19:39,500 --> 00:19:44,430
because we pretty much had
rope on the whole organization.

455
00:19:44,430 --> 00:19:46,190
And, obviously we gave
all this information

456
00:19:46,190 --> 00:19:48,360
directly to John Deere in record time,

457
00:19:48,360 --> 00:19:49,890
we actually had to get CISA involved

458
00:19:49,890 --> 00:19:51,620
because they were not responsive.

459
00:19:51,620 --> 00:19:53,490
And CISA actually took over for a bit

460
00:19:53,490 --> 00:19:56,450
and helped them remediate
the vulnerabilities.

461
00:19:56,450 --> 00:19:58,160
Let me move on to the second manufacturer.

462
00:19:58,160 --> 00:20:00,120
So Case IH, this is the
last one we'll look at

463
00:20:00,120 --> 00:20:01,720
because I've only got 20 minutes

464
00:20:02,720 --> 00:20:04,000
and the other ones aren't
actually fixed yet,

465
00:20:04,000 --> 00:20:06,030
but Case IH is probably
the biggest competitor.

466
00:20:06,030 --> 00:20:08,820
So that's Case International
Harvesting + New Holland.

467
00:20:08,820 --> 00:20:11,260
They all amalgamated, they
like to buy each other out.

468
00:20:11,260 --> 00:20:13,360
And they're also super connected tractors.

469
00:20:14,380 --> 00:20:17,980
It's the Magnum series with
a customizable display,

470
00:20:17,980 --> 00:20:18,840
same sort of stuff,

471
00:20:18,840 --> 00:20:21,190
but that's an Android based one,

472
00:20:21,190 --> 00:20:23,350
Fantastically, again,
we've got remote access

473
00:20:23,350 --> 00:20:24,183
300 miles away.

474
00:20:24,183 --> 00:20:25,230
I think you can get access

475
00:20:25,230 --> 00:20:26,670
from a little bit farther away than that,

476
00:20:26,670 --> 00:20:31,670
but your Case IH dealer will
be able to access your account

477
00:20:32,070 --> 00:20:35,800
remotely from literally just
your ID of your account.

478
00:20:35,800 --> 00:20:37,200
And that's the guy, there.

479
00:20:37,200 --> 00:20:38,720
I'll just mention this briefly,

480
00:20:38,720 --> 00:20:41,254
cause he's got 24 pens
in his little pen holder.

481
00:20:41,254 --> 00:20:43,640
I just think that's funny, but yeah,

482
00:20:43,640 --> 00:20:46,613
he's controlling your
tractors, so, worry about that.

483
00:20:47,980 --> 00:20:51,416
This is the JavaMelody server
that we found with Case IH.

484
00:20:51,416 --> 00:20:54,530
Yeah, we could just browse
the JavaMelody server

485
00:20:54,530 --> 00:20:55,540
for your sessions.

486
00:20:55,540 --> 00:20:57,930
This was all Brazilian
data, for some reason.

487
00:20:57,930 --> 00:20:59,070
I forgot to blur out his IP,

488
00:20:59,070 --> 00:21:02,390
but basically he's a Chrome
user, I've got his session ID.

489
00:21:02,390 --> 00:21:05,240
So I can obviously just
replicate that session.

490
00:21:05,240 --> 00:21:07,570
I can just log in as
that user by duplicate,

491
00:21:07,570 --> 00:21:09,140
just copying that session
ID in the top left

492
00:21:09,140 --> 00:21:10,612
that I blurred out.

493
00:21:10,612 --> 00:21:13,330
When there's a list of
sessions and how old they are

494
00:21:13,330 --> 00:21:15,210
and all the attributes
allowed to them, or sorry,

495
00:21:15,210 --> 00:21:17,240
attributes assigned to them
like, you know, user name,

496
00:21:17,240 --> 00:21:19,320
first name, last name, et cetera.

497
00:21:19,320 --> 00:21:20,900
I'll just show you another
user we're looking at here.

498
00:21:20,900 --> 00:21:22,240
It's got the full name bottom right

499
00:21:22,240 --> 00:21:24,010
which I have to blur out, obviously,

500
00:21:24,010 --> 00:21:26,380
scope, so what they're allowed to use,

501
00:21:26,380 --> 00:21:28,720
and then they've got the session ID again

502
00:21:28,720 --> 00:21:29,900
and their IP address.

503
00:21:29,900 --> 00:21:32,830
And this is all publicly
assessable, which is ridiculous.

504
00:21:32,830 --> 00:21:34,630
And then the bottom of that JavaMelody,

505
00:21:34,630 --> 00:21:35,463
if you've used it before,

506
00:21:35,463 --> 00:21:36,520
there's a couple of cool functions.

507
00:21:36,520 --> 00:21:37,640
You can do all sorts of cool shit

508
00:21:37,640 --> 00:21:38,960
like invalidate all the sessions

509
00:21:38,960 --> 00:21:41,760
or execute the garbage collector,
or you can even reboot it,

510
00:21:41,760 --> 00:21:44,520
which we accidentally did,
for research purposes only.

511
00:21:44,520 --> 00:21:46,140
Or we killed one process
and then took a while,

512
00:21:46,140 --> 00:21:48,097
it came back on the next day.

513
00:21:48,097 --> 00:21:51,302
But yeah, just by having
that, just as an example,

514
00:21:51,302 --> 00:21:54,350
that's an example of a
denial of service loop

515
00:21:54,350 --> 00:21:55,400
that was done in good faith ops.

516
00:21:55,400 --> 00:21:56,520
It was accidental.

517
00:21:56,520 --> 00:21:59,860
We can see a lot of stuff
we can do with JavaMelody.

518
00:21:59,860 --> 00:22:02,200
First of all, it shouldn't be exposed.

519
00:22:02,200 --> 00:22:03,033
Second, we shouldn't be able

520
00:22:03,033 --> 00:22:05,010
to invalidate everyone's sessions

521
00:22:05,010 --> 00:22:07,600
and we shouldn't be
able to see them either.

522
00:22:07,600 --> 00:22:10,300
And then I'm just honing in
on the invalidation there.

523
00:22:11,370 --> 00:22:13,460
So we actually had a lot of hard times

524
00:22:13,460 --> 00:22:14,880
getting into contact with these companies.

525
00:22:14,880 --> 00:22:16,960
I'm talking like, we're talking like weeks

526
00:22:16,960 --> 00:22:18,130
to get in contact with these companies.

527
00:22:18,130 --> 00:22:20,257
Absolutely ridiculous.

528
00:22:20,257 --> 00:22:24,313
This is an email that we sent in April,

529
00:22:24,313 --> 00:22:27,560
printed out bound into a book by Willie

530
00:22:27,560 --> 00:22:31,040
and delivered, hand-delivered
to the John Deere headquarters

531
00:22:31,040 --> 00:22:32,700
because they wouldn't reply to us

532
00:22:32,700 --> 00:22:35,810
in any way, shape, or
form, just reminding them

533
00:22:35,810 --> 00:22:38,890
that we've identified a ton of risks,

534
00:22:38,890 --> 00:22:40,330
mainly that we can log in as anyone

535
00:22:40,330 --> 00:22:42,090
in John Deere's platform,

536
00:22:42,090 --> 00:22:44,990
and that should probably get looked into.

537
00:22:44,990 --> 00:22:46,260
And we hand-delivered this one.

538
00:22:46,260 --> 00:22:49,550
So this is a photo that Willy
took of the CNH headquarters

539
00:22:49,550 --> 00:22:51,853
up the road from his place in Illinois.

540
00:22:52,760 --> 00:22:54,440
And you can see there
it's got security office.

541
00:22:54,440 --> 00:22:56,360
So that's obviously
where we dropped it off,

542
00:22:56,360 --> 00:22:57,940
COVID restrictions were in place.

543
00:22:57,940 --> 00:22:59,610
So it was pretty hard to get
in touch with someone there

544
00:22:59,610 --> 00:23:02,040
Willy said, but he
eventually handed it off

545
00:23:02,040 --> 00:23:04,840
to someone who had no idea
what they were doing with it,

546
00:23:04,840 --> 00:23:08,100
and we didn't actually hear
back from them about this.

547
00:23:08,100 --> 00:23:10,370
So we ended up getting through to them

548
00:23:10,370 --> 00:23:12,950
in the compliance portal, weirdly enough.

549
00:23:12,950 --> 00:23:15,260
But the only way to get
in contact with Case,

550
00:23:15,260 --> 00:23:18,390
I rang them a few times and
they were extremely rude,

551
00:23:18,390 --> 00:23:20,770
I'll put the phone calls on
my website, they're hilarious.

552
00:23:20,770 --> 00:23:23,420
They're actually like bizarre
the way that they spoke to us.

553
00:23:23,420 --> 00:23:25,970
But the way that I got
into contact with him

554
00:23:25,970 --> 00:23:27,520
is through this weird link

555
00:23:27,520 --> 00:23:29,250
in their compliance and governance page

556
00:23:29,250 --> 00:23:31,270
called the
CNHIndustrialComplianceHelpline.com

557
00:23:33,400 --> 00:23:35,320
So when you read it, when
you go to that website,

558
00:23:35,320 --> 00:23:38,500
you get redirected to a third
party called Navix global,

559
00:23:38,500 --> 00:23:40,490
who's very popular in this sort of field.

560
00:23:40,490 --> 00:23:44,480
EthicsPoint it's called,
where you can get in touch

561
00:23:44,480 --> 00:23:46,640
with a third party that will relay info

562
00:23:46,640 --> 00:23:48,670
back to the manufacturer.

563
00:23:48,670 --> 00:23:51,387
And we ended up chatting
to them and asking them,

564
00:23:51,387 --> 00:23:53,800
"is it safe to provide the
reports over this channel?"

565
00:23:53,800 --> 00:23:55,160
They said, "we are Case."

566
00:23:55,160 --> 00:23:56,611
I said, "are you sure?

567
00:23:56,611 --> 00:23:57,450
It looks like Navix to me."

568
00:23:57,450 --> 00:23:59,550
But yeah, apparently that actually works

569
00:23:59,550 --> 00:24:00,960
and eventually we got
in contact with them.

570
00:24:00,960 --> 00:24:03,363
they fixed them, and then we
never heard from them again.

571
00:24:04,390 --> 00:24:06,260
Just back on John Deere.

572
00:24:06,260 --> 00:24:07,610
And I'll just finish with this unit.

573
00:24:07,610 --> 00:24:10,530
This is the MG 4G LTE gateway.

574
00:24:10,530 --> 00:24:11,393
This is the brains of the device.

575
00:24:11,393 --> 00:24:13,060
This is the brains of every tractor.

576
00:24:13,060 --> 00:24:15,447
It goes on every tractor and
apparently goes on buses,

577
00:24:15,447 --> 00:24:18,370
as you can see in the
top left-hand corner,

578
00:24:18,370 --> 00:24:22,470
this is a fully loaded
device, runs Yocto Linux,

579
00:24:22,470 --> 00:24:25,260
certified in 70 countries,
whatever that means.

580
00:24:25,260 --> 00:24:30,206
A full IP 67 container, so it
can run in snow or super heat.

581
00:24:30,206 --> 00:24:34,300
It's got SIM card, it's
got satellite connections,

582
00:24:34,300 --> 00:24:38,170
it's got WiFi connections,
it's got Bluetooth connections.

583
00:24:38,170 --> 00:24:39,520
And here's what it looks like

584
00:24:39,520 --> 00:24:42,104
with the IP 67 case all hooked up.

585
00:24:42,104 --> 00:24:43,170
And this is what it looks like

586
00:24:43,170 --> 00:24:45,542
with a JTAGulator hooked up to it.

587
00:24:45,542 --> 00:24:48,700
And we pretty much still hadn't
got access to this device.

588
00:24:48,700 --> 00:24:50,610
It's proving to be a little bit difficult

589
00:24:50,610 --> 00:24:53,100
and I actually spoke
to the guy, Joe Grant,

590
00:24:53,100 --> 00:24:54,450
who made the JTAGulator about it,

591
00:24:54,450 --> 00:24:56,000
and he gave me some pointers about it.

592
00:24:56,000 --> 00:24:57,780
The easiest way to get
around it would probably be

593
00:24:57,780 --> 00:25:00,040
just to ask John Deere
for the source code.

594
00:25:00,040 --> 00:25:01,680
So that's what's ongoing at the moment.

595
00:25:01,680 --> 00:25:04,570
Apparently we're allowed
to obtain a complete copy

596
00:25:04,570 --> 00:25:07,510
of the corresponding source
code for the entire device,

597
00:25:07,510 --> 00:25:09,310
which I've sent to them
about two months ago

598
00:25:09,310 --> 00:25:10,260
and I'm still waiting.

599
00:25:10,260 --> 00:25:11,910
And apparently it's in the works,

600
00:25:12,942 --> 00:25:15,020
and they've said to me that
I'm getting it in a few weeks

601
00:25:15,020 --> 00:25:17,400
and I don't understand how
it could take a few weeks

602
00:25:17,400 --> 00:25:20,610
to de-sanitize a source code project

603
00:25:20,610 --> 00:25:24,100
where someone prior to me has
probably has actually asked

604
00:25:24,100 --> 00:25:27,240
for the source code, so
they should be just on hand.

605
00:25:27,240 --> 00:25:29,050
I don't really understand
how it can take weeks

606
00:25:29,050 --> 00:25:31,563
to get a GPO request to them done.

607
00:25:32,550 --> 00:25:35,220
And secondly, it's valid
to anyone who receives

608
00:25:35,220 --> 00:25:36,570
this information, so
you don't even need it.

609
00:25:36,570 --> 00:25:38,490
And apparently they were
asking us for serial numbers

610
00:25:38,490 --> 00:25:40,260
and stuff, and what's our serial number,

611
00:25:40,260 --> 00:25:43,830
but I refer to the offer, which
says refer to their offer,

612
00:25:43,830 --> 00:25:47,468
which is valid for anyone in
receipt of this information.

613
00:25:47,468 --> 00:25:49,950
What I found actually,
delving into this device

614
00:25:49,950 --> 00:25:51,890
is it's got a Qualcomm chip in there.

615
00:25:51,890 --> 00:25:53,740
And we all know that
Qualcomm has serious problems

616
00:25:53,740 --> 00:25:57,920
at the moment, the MDM
9215 chips specifically,

617
00:25:57,920 --> 00:26:01,830
along with about 70
chips that run Snapdragon

618
00:26:01,830 --> 00:26:02,880
and things like that.

619
00:26:05,380 --> 00:26:08,210
Pretty much a monthly CVE
roster for these devices

620
00:26:08,210 --> 00:26:10,820
like critical, critical,
critical, and high ones.

621
00:26:10,820 --> 00:26:14,520
And so it says at the bottom
there, OEMs have been notified

622
00:26:14,520 --> 00:26:16,623
and encouraged to patch these issues.

623
00:26:17,740 --> 00:26:19,150
So I'd say if you're not being encouraged

624
00:26:19,150 --> 00:26:21,940
to patch the issues,
you're actually insane.

625
00:26:21,940 --> 00:26:25,450
Cause these are ridiculously
vulnerable bugs.

626
00:26:25,450 --> 00:26:27,070
You can see the top one there 2020,

627
00:26:27,070 --> 00:26:29,710
and the bug was actually
published in middle of 2021.

628
00:26:29,710 --> 00:26:32,440
So it's a serious, critical vulnerability

629
00:26:32,440 --> 00:26:33,890
that there's not much information about,

630
00:26:33,890 --> 00:26:36,020
but just patch, patch, patch.

631
00:26:36,020 --> 00:26:38,238
And I'll just say, thanks
for everyone for listening.

632
00:26:38,238 --> 00:26:40,121
This was originally a 45 minute talk.

633
00:26:40,121 --> 00:26:41,870
You can visit us all on Twitter.

634
00:26:41,870 --> 00:26:43,949
We've all got different
Twitters, but you can Google us.

635
00:26:43,949 --> 00:26:45,490
And thanks everyone for watching

636
00:26:45,490 --> 00:26:48,110
and hope you guys have a
great end of your DEFCON.

637
00:26:48,110 --> 00:26:50,900
And get involved with
the farming industry,

638
00:26:50,900 --> 00:26:52,270
there's no barrier to entry.

639
00:26:52,270 --> 00:26:54,020
It's a really cool industry
to get involved in.

640
00:26:54,020 --> 00:26:56,790
There's a lot of YouTube
videos about how things work

641
00:26:56,790 --> 00:26:58,670
and you can really find
out some interesting stuff

642
00:26:58,670 --> 00:27:00,720
and get some value out of hacking farms

643
00:27:00,720 --> 00:27:02,210
because all the work that you do

644
00:27:02,210 --> 00:27:04,620
is pretty much used to feed everyone.

645
00:27:04,620 --> 00:27:07,380
So thank you and have a
great night, everyone,

646
00:27:07,380 --> 00:27:09,230
and thanks for listening to the talk.

