1
00:00:00,860 --> 00:00:02,670
- Hello, I hope you're a psyched as I am

2
00:00:02,670 --> 00:00:06,440
for me to talk at you for
45 minutes all about wires.

3
00:00:06,440 --> 00:00:08,770
The hacker community has picked to bits

4
00:00:08,770 --> 00:00:11,630
many other aspects of
physical access control,

5
00:00:11,630 --> 00:00:13,340
but the communication lines themselves

6
00:00:13,340 --> 00:00:15,160
remain largely at black box,

7
00:00:15,160 --> 00:00:18,480
and that's despite them
being manifestly exploitable,

8
00:00:18,480 --> 00:00:20,860
which we'll look at today.

9
00:00:20,860 --> 00:00:23,250
So I'm sure you've seen
this particular trope,

10
00:00:23,250 --> 00:00:24,350
the laser hallway,

11
00:00:24,350 --> 00:00:26,090
where the protagonist does all sorts

12
00:00:26,090 --> 00:00:28,870
of incredible gymnastics
to get by these lasers

13
00:00:28,870 --> 00:00:30,050
without tripping them

14
00:00:30,050 --> 00:00:32,440
and get to whatever goal exists.

15
00:00:32,440 --> 00:00:33,970
That's one defeat mechanism,

16
00:00:33,970 --> 00:00:36,870
is avoiding the sensors entirely,

17
00:00:36,870 --> 00:00:39,230
but if we can access any part of the wire

18
00:00:39,230 --> 00:00:41,540
that connects the actual light detector

19
00:00:41,540 --> 00:00:43,720
to the upstream controller,

20
00:00:43,720 --> 00:00:45,830
we can then walk through all these lasers

21
00:00:45,830 --> 00:00:47,280
without a care in the world,

22
00:00:47,280 --> 00:00:50,490
knowing that our activity
will not be reported on.

23
00:00:50,490 --> 00:00:52,670
In a more real life example,

24
00:00:52,670 --> 00:00:53,980
you'll see these all over.

25
00:00:53,980 --> 00:00:54,980
And if you haven't yet,

26
00:00:54,980 --> 00:00:57,100
you will now that you
know to look for them.

27
00:00:57,100 --> 00:00:59,150
Magnetic door contact sensors,

28
00:00:59,150 --> 00:01:00,280
they might look like this,

29
00:01:00,280 --> 00:01:02,570
or they might be mounted inside the frame,

30
00:01:02,570 --> 00:01:05,170
and they will detect when
this door gets opened.

31
00:01:05,170 --> 00:01:06,240
The hackers among us

32
00:01:06,240 --> 00:01:08,997
will likely look at
this wire here and say,

33
00:01:08,997 --> 00:01:11,510
"There's gotta be something
we can do with that

34
00:01:11,510 --> 00:01:14,400
to avoid this device

35
00:01:14,400 --> 00:01:16,700
actually reporting where
the door gets opened.

36
00:01:16,700 --> 00:01:19,578
And, of course, there is.

37
00:01:19,578 --> 00:01:22,360
So this is a talk about
sensor communication wires.

38
00:01:22,360 --> 00:01:25,140
We'll give a brief high-level
overview of alarm systems

39
00:01:25,140 --> 00:01:26,850
and access control first.

40
00:01:26,850 --> 00:01:29,950
And then we'll talk about
two ways to defeat those

41
00:01:29,950 --> 00:01:31,610
and to defeat end of line resistors,

42
00:01:31,610 --> 00:01:33,790
which is the most common defense

43
00:01:33,790 --> 00:01:36,190
and anti-tamper mechanism applied.

44
00:01:36,190 --> 00:01:37,740
And then we'll talk about some defenses

45
00:01:37,740 --> 00:01:40,150
that work against these attacks.

46
00:01:40,150 --> 00:01:41,860
I encourage you to go try it yourself

47
00:01:41,860 --> 00:01:43,350
in the Lock Bypass Village.

48
00:01:43,350 --> 00:01:44,950
Everything that I'm talking about today

49
00:01:44,950 --> 00:01:46,000
and everything that I'm showing

50
00:01:46,000 --> 00:01:49,080
is available as hands-on demonstrations

51
00:01:49,080 --> 00:01:50,323
for you to go try.

52
00:01:51,290 --> 00:01:54,350
So let's look at a couple of
the sensors that are available.

53
00:01:54,350 --> 00:01:58,610
There are a lot of magnetic
contact-based sensors

54
00:01:58,610 --> 00:02:01,060
in attack door and window opening.

55
00:02:01,060 --> 00:02:03,050
You might also have an area sensor,

56
00:02:03,050 --> 00:02:04,990
such as passive infrared,

57
00:02:04,990 --> 00:02:08,240
or one that seismically detects
someone walking on ground,

58
00:02:08,240 --> 00:02:11,153
or that uses vibration
to detect fence climbing.

59
00:02:12,240 --> 00:02:13,073
In this example,

60
00:02:13,073 --> 00:02:15,700
we have the floor plan schematics

61
00:02:15,700 --> 00:02:18,860
for a number of different
ways to protect windows.

62
00:02:18,860 --> 00:02:20,760
So there is a contact sensor

63
00:02:20,760 --> 00:02:22,560
to detect the window being opened,

64
00:02:22,560 --> 00:02:25,000
and two different types
of glass break detectors

65
00:02:25,000 --> 00:02:27,430
to detect someone breaking
the glass through.

66
00:02:27,430 --> 00:02:29,660
If the window can be opened or broken,

67
00:02:29,660 --> 00:02:31,630
we might wanna have both.

68
00:02:31,630 --> 00:02:33,490
Now in days gone by,

69
00:02:33,490 --> 00:02:36,300
electronics were expensive
and difficult to build,

70
00:02:36,300 --> 00:02:38,910
and so we wouldn't wanna have
an input to the controller

71
00:02:38,910 --> 00:02:40,930
for each of these individual sensors

72
00:02:40,930 --> 00:02:43,370
when they're all on the same window.

73
00:02:43,370 --> 00:02:46,370
The way that was handled
was with alarm zones.

74
00:02:46,370 --> 00:02:49,050
So a zone is multiple
sensors wired together.

75
00:02:49,050 --> 00:02:50,510
If any of them get tripped,

76
00:02:50,510 --> 00:02:53,020
the alarm gets tripped for that zone.

77
00:02:53,020 --> 00:02:54,670
So a normally closed zone

78
00:02:54,670 --> 00:02:57,450
will have switches that
are normally connected,

79
00:02:57,450 --> 00:02:59,020
but they'll disconnect in the event

80
00:02:59,020 --> 00:03:02,180
that the sensor gets tripped.

81
00:03:02,180 --> 00:03:03,820
And then they're wired in series.

82
00:03:03,820 --> 00:03:06,337
So either disconnecting creates the alarm,

83
00:03:06,337 --> 00:03:09,260
and a normally open zone
are wired in parallel.

84
00:03:09,260 --> 00:03:11,240
So if either of them connect,

85
00:03:11,240 --> 00:03:13,960
then the alarm will go off.

86
00:03:13,960 --> 00:03:16,560
Zones are also often applied to rooms,

87
00:03:16,560 --> 00:03:17,860
and that's why they're called zones.

88
00:03:17,860 --> 00:03:20,570
So any sensor in a particular room

89
00:03:20,570 --> 00:03:23,140
will trigger a single
zone in the controller,

90
00:03:23,140 --> 00:03:25,690
and they'll all be wired
together in that way.

91
00:03:25,690 --> 00:03:28,050
So we might have all of these sensors

92
00:03:28,050 --> 00:03:30,210
for the door being
opened into the vestibule

93
00:03:30,210 --> 00:03:32,260
being wired into a single zone,

94
00:03:32,260 --> 00:03:35,800
or all the various window
glass break type detectors

95
00:03:35,800 --> 00:03:38,483
on this room being
wired into another zone.

96
00:03:42,270 --> 00:03:44,520
You can see an example of alarm zones

97
00:03:44,520 --> 00:03:46,550
with fire control systems.

98
00:03:46,550 --> 00:03:49,760
They are a lot more publicly
viewable than security systems.

99
00:03:49,760 --> 00:03:52,160
And in the foyer of many large buildings,

100
00:03:52,160 --> 00:03:55,730
particularly with western
hemisphere fire codes,

101
00:03:55,730 --> 00:03:58,760
you can look at what the
zones specifically are.

102
00:03:58,760 --> 00:04:02,700
So is stairwell number three
having a fire alarm in it?

103
00:04:02,700 --> 00:04:05,640
Are various other aspects that
this system use to monitor

104
00:04:05,640 --> 00:04:06,950
behaving correctly?

105
00:04:06,950 --> 00:04:08,890
And are the wires intact?

106
00:04:08,890 --> 00:04:11,593
And that is all going
to be displayable there.

107
00:04:12,555 --> 00:04:14,580
The second aspect where
these technologies get used

108
00:04:14,580 --> 00:04:16,710
is with access control systems.

109
00:04:16,710 --> 00:04:19,610
Alarms that we've just
talked about so far at least

110
00:04:19,610 --> 00:04:20,750
are relatively binary,

111
00:04:20,750 --> 00:04:23,120
they're trying to look for any person

112
00:04:23,120 --> 00:04:24,400
entering the perimeter,

113
00:04:24,400 --> 00:04:26,370
without discriminating who it might be.

114
00:04:26,370 --> 00:04:29,080
Access control systems will
make that determination

115
00:04:29,080 --> 00:04:30,910
of is it an authorized user,

116
00:04:30,910 --> 00:04:33,520
and it should only alarm when it's not.

117
00:04:33,520 --> 00:04:35,530
So the most basic access control system

118
00:04:35,530 --> 00:04:38,780
has an authentication device
such as a card reader.

119
00:04:38,780 --> 00:04:41,460
And it has some means
of physically allowing

120
00:04:41,460 --> 00:04:43,193
or denying the door to open.

121
00:04:44,420 --> 00:04:47,560
We might wanna add a
contact sensor to the door.

122
00:04:47,560 --> 00:04:49,270
So if the door gets opened,

123
00:04:49,270 --> 00:04:51,150
and there was not a card swiped,

124
00:04:51,150 --> 00:04:52,510
it can then trigger an alarm

125
00:04:52,510 --> 00:04:55,030
and indicate an unauthorized entry.

126
00:04:55,030 --> 00:04:57,560
If someone's leaving,
that creates a problem.

127
00:04:57,560 --> 00:04:59,730
So we also wanna have what's called

128
00:04:59,730 --> 00:05:01,760
a request to exit sensor,

129
00:05:01,760 --> 00:05:05,210
and this particular type
uses passive infrared

130
00:05:05,210 --> 00:05:08,340
to detect a person on the
secure side of the door

131
00:05:08,340 --> 00:05:09,450
waiting to leave.

132
00:05:09,450 --> 00:05:10,630
If it detects that

133
00:05:10,630 --> 00:05:12,430
and the door is subsequently opened,

134
00:05:12,430 --> 00:05:13,393
there's no alarm.

135
00:05:15,800 --> 00:05:17,610
We'll look at some of the
technologies available

136
00:05:17,610 --> 00:05:19,233
for these different systems.

137
00:05:20,730 --> 00:05:22,580
So the authentication can be done

138
00:05:22,580 --> 00:05:25,320
with various different
technologies of card readers.

139
00:05:25,320 --> 00:05:28,690
And there's lots of great talks so far

140
00:05:28,690 --> 00:05:29,990
about how to defeat those,

141
00:05:29,990 --> 00:05:32,048
which I won't go into anymore.

142
00:05:32,048 --> 00:05:34,010
It could also involve biometric

143
00:05:34,010 --> 00:05:36,460
or a code or even a video doorbell,

144
00:05:36,460 --> 00:05:39,620
where a human remotely makes
the go or no-go decision

145
00:05:39,620 --> 00:05:42,540
of whether this person should be admitted.

146
00:05:42,540 --> 00:05:43,940
In terms of allowing the door

147
00:05:43,940 --> 00:05:45,520
to open or keeping it locked,

148
00:05:45,520 --> 00:05:48,800
we can use magnetic
strikes or a magnetic lock

149
00:05:48,800 --> 00:05:52,030
that magnetically holds the door shut.

150
00:05:52,030 --> 00:05:55,170
We can also use hardware that
can be remotely controlled

151
00:05:55,170 --> 00:05:56,960
to lock or unlock,

152
00:05:56,960 --> 00:05:58,950
turnstile-based systems,

153
00:05:58,950 --> 00:06:01,423
or even a vehicle entry door.

154
00:06:03,030 --> 00:06:04,960
Detecting that the door is open

155
00:06:04,960 --> 00:06:08,530
is usually done with a
magnetic switch almost always,

156
00:06:08,530 --> 00:06:10,010
like these three here.

157
00:06:10,010 --> 00:06:11,940
It might be an optical
based switch though,

158
00:06:11,940 --> 00:06:13,550
or even a mechanical switch

159
00:06:13,550 --> 00:06:16,050
that is pushed in when the door is closed,

160
00:06:16,050 --> 00:06:19,570
and some hinges can detect
their position as well.

161
00:06:19,570 --> 00:06:21,630
And, finally, the request to exit

162
00:06:21,630 --> 00:06:23,480
is usually done with passive infrared.

163
00:06:23,480 --> 00:06:25,440
It might be a button that you press,

164
00:06:25,440 --> 00:06:28,130
or pressing on the egress hardware itself

165
00:06:28,130 --> 00:06:29,730
will trigger the request to accessing

166
00:06:29,730 --> 00:06:31,520
that there is someone on the far side,

167
00:06:31,520 --> 00:06:32,770
and in secure installations,

168
00:06:32,770 --> 00:06:34,720
it might be another card reader,

169
00:06:34,720 --> 00:06:36,713
so you have to badge in and out.

170
00:06:37,890 --> 00:06:40,600
Here's an example of one
of those in the wild.

171
00:06:40,600 --> 00:06:42,250
So it's a passive infrared detector

172
00:06:42,250 --> 00:06:43,520
mounted over the door,

173
00:06:43,520 --> 00:06:48,470
and we also see an in-frame
door contact sensor over here

174
00:06:48,470 --> 00:06:50,590
that will pair up with this magnet

175
00:06:50,590 --> 00:06:51,880
on the top of the door.

176
00:06:51,880 --> 00:06:53,440
And when the door is closed,

177
00:06:53,440 --> 00:06:55,260
those are going to be together,

178
00:06:55,260 --> 00:06:58,310
and it will detect that
the door is closed.

179
00:06:58,310 --> 00:06:59,740
There's a couple other pieces of hardware

180
00:06:59,740 --> 00:07:01,570
we can potentially exploit.

181
00:07:01,570 --> 00:07:02,930
One is if there's a key switch

182
00:07:02,930 --> 00:07:03,930
that tells the controller

183
00:07:03,930 --> 00:07:07,000
when it's supposed to be
building open and closed hours.

184
00:07:07,000 --> 00:07:09,280
Another is accessibility buttons,

185
00:07:09,280 --> 00:07:11,660
particularly the one on the
secure side of the door.

186
00:07:11,660 --> 00:07:12,540
If it gets pressed,

187
00:07:12,540 --> 00:07:15,710
that will usually also
trigger an unlocking sequence

188
00:07:15,710 --> 00:07:17,060
and disable the alarm

189
00:07:17,060 --> 00:07:19,940
from the door being detected to be open

190
00:07:19,940 --> 00:07:21,480
and the fire system.

191
00:07:21,480 --> 00:07:23,630
So when a mag lock is installed,

192
00:07:23,630 --> 00:07:26,520
if there's a fire situation,

193
00:07:26,520 --> 00:07:28,210
it has to unlock by code.

194
00:07:28,210 --> 00:07:31,060
Otherwise people will be stuck inside,

195
00:07:31,060 --> 00:07:32,830
because otherwise the security system

196
00:07:32,830 --> 00:07:34,490
would be keeping it locked.

197
00:07:34,490 --> 00:07:35,380
And so if we trick it

198
00:07:35,380 --> 00:07:38,240
into thinking that
there's a fire going on,

199
00:07:38,240 --> 00:07:40,780
that will also unlock the door for us.

200
00:07:40,780 --> 00:07:43,270
We won't look at these communication lines

201
00:07:43,270 --> 00:07:47,130
to the mag strike and the reader.

202
00:07:47,130 --> 00:07:48,890
That's a bit outside
the scope of this talk,

203
00:07:48,890 --> 00:07:51,660
but everything else that's
remaining on this screen

204
00:07:51,660 --> 00:07:53,840
is a binary communication line.

205
00:07:53,840 --> 00:07:56,120
It carries a yes or a no.

206
00:07:56,120 --> 00:07:59,590
And we can attack that
to disable the alarm

207
00:07:59,590 --> 00:08:01,460
and cause the door to open,

208
00:08:01,460 --> 00:08:04,060
and another way to defeat these systems.

209
00:08:04,060 --> 00:08:06,840
So we can attack the contact sensor itself

210
00:08:06,840 --> 00:08:08,580
to make it think the door remains closed

211
00:08:08,580 --> 00:08:11,130
when we've actually
opened it and gone inside.

212
00:08:11,130 --> 00:08:12,870
We can attack the request to exit sensor

213
00:08:12,870 --> 00:08:15,130
to make it think someone is exiting,

214
00:08:15,130 --> 00:08:18,120
and then we can safely enter
without triggering an alarm.

215
00:08:18,120 --> 00:08:21,720
We can attack the accessibility
button to make it unlock,

216
00:08:21,720 --> 00:08:24,370
open the door and disable the alarm.

217
00:08:24,370 --> 00:08:26,160
We can attack the key switch

218
00:08:26,160 --> 00:08:28,120
to make it think the building is open

219
00:08:28,120 --> 00:08:29,930
and the fire alarm,

220
00:08:29,930 --> 00:08:31,610
or the communication from the fire alarm

221
00:08:31,610 --> 00:08:33,160
to make the security controller

222
00:08:33,160 --> 00:08:35,860
think that we're in a
fire alarm situation,

223
00:08:35,860 --> 00:08:39,170
and then it will open
things up accordingly.

224
00:08:39,170 --> 00:08:42,400
So here's one relatively
straightforward example

225
00:08:42,400 --> 00:08:44,540
of where those wires can be accessed.

226
00:08:44,540 --> 00:08:46,210
So this key switch here,

227
00:08:46,210 --> 00:08:48,110
you can see that this
can just be unscrewed,

228
00:08:48,110 --> 00:08:50,720
but also anywhere up to this conduit

229
00:08:50,720 --> 00:08:51,940
will also have access

230
00:08:51,940 --> 00:08:55,263
to disable that alarm at the wire.

231
00:08:56,470 --> 00:08:59,720
The wires often run in conduits like this.

232
00:08:59,720 --> 00:09:01,470
And so we need to find those,

233
00:09:01,470 --> 00:09:03,650
and then determine which
ones contain the wires

234
00:09:03,650 --> 00:09:05,000
we're interested in.

235
00:09:05,000 --> 00:09:05,870
Well, how is that done?

236
00:09:05,870 --> 00:09:07,550
Sometimes it's labeled for us.

237
00:09:07,550 --> 00:09:09,560
This one says FA, means fire alarm,

238
00:09:09,560 --> 00:09:11,090
so that is generally not one

239
00:09:11,090 --> 00:09:13,920
that we'd want to be
looking at for this purpose.

240
00:09:13,920 --> 00:09:16,760
One that says door contacts
is much more interesting.

241
00:09:16,760 --> 00:09:18,920
This one also does
contain fire alarm wires,

242
00:09:18,920 --> 00:09:20,680
but also the door contacts.

243
00:09:20,680 --> 00:09:22,690
And this one, security junction box,

244
00:09:22,690 --> 00:09:24,890
is also a likely one
we'd want to look into.

245
00:09:25,800 --> 00:09:27,700
In this case, we can tell contextually,

246
00:09:27,700 --> 00:09:31,540
well, this conduit is going
to about the right position

247
00:09:31,540 --> 00:09:34,967
for a contact sensor to
be mounted on the door,

248
00:09:34,967 --> 00:09:37,030
but we can tell from this bolt pattern,

249
00:09:37,030 --> 00:09:39,210
that likely that's not what it's for.

250
00:09:39,210 --> 00:09:41,280
It's likely to a mag lock.

251
00:09:41,280 --> 00:09:42,530
And they generally get mounted

252
00:09:42,530 --> 00:09:43,880
with this type of bolt pattern.

253
00:09:43,880 --> 00:09:47,260
It might also have a
contact sensor here as well,

254
00:09:47,260 --> 00:09:49,030
and that can be defeated as well,

255
00:09:49,030 --> 00:09:51,560
but it's beyond the scope of this talk.

256
00:09:51,560 --> 00:09:53,627
Of course, sometimes it just tells us.

257
00:09:53,627 --> 00:09:54,460
"Do not unplug."

258
00:09:54,460 --> 00:09:55,370
Well, the wire's been caught,

259
00:09:55,370 --> 00:09:58,010
I guess that's technically not unplugging.

260
00:09:58,010 --> 00:10:01,210
And sometimes there's very
subtle contextual clues

261
00:10:01,210 --> 00:10:03,400
to tell us what general
area of the building

262
00:10:03,400 --> 00:10:06,013
contains the wires we're interested in.

263
00:10:07,400 --> 00:10:10,360
Sometimes we can find the sensor itself

264
00:10:10,360 --> 00:10:13,040
and just follow the conduits back from it

265
00:10:13,040 --> 00:10:15,660
to figure out which
wires we need to attack.

266
00:10:15,660 --> 00:10:18,450
And if we see a card reader

267
00:10:18,450 --> 00:10:21,110
or other access control type hardware

268
00:10:21,110 --> 00:10:21,943
that does tell us

269
00:10:21,943 --> 00:10:24,830
that there will likely be
intrusion detection sensors

270
00:10:24,830 --> 00:10:27,033
that we need to find and defeat.

271
00:10:28,680 --> 00:10:31,190
And then the last thing that
sometimes gives us access

272
00:10:31,190 --> 00:10:33,640
is when conduits run outside.

273
00:10:33,640 --> 00:10:37,010
It's a very bad idea to run
your security wiring outside,

274
00:10:37,010 --> 00:10:40,000
but it is seen particularly
in historical buildings

275
00:10:40,000 --> 00:10:43,050
where there's not adequate
duct space inside.

276
00:10:43,050 --> 00:10:45,610
And that's something that
we can open this right up

277
00:10:45,610 --> 00:10:48,253
and defeat the security
system from the outside.

278
00:10:49,150 --> 00:10:51,710
Here's a particularly egregious example,

279
00:10:51,710 --> 00:10:53,660
where we have the contact sensor,

280
00:10:53,660 --> 00:10:55,010
and this is actually all mounted

281
00:10:55,010 --> 00:10:57,810
on the unsecure side of the door.

282
00:10:57,810 --> 00:10:59,990
Definitely something to avoid.

283
00:10:59,990 --> 00:11:02,340
If we wanted to apply or attack,

284
00:11:02,340 --> 00:11:04,970
it might not make sense
to do it right here,

285
00:11:04,970 --> 00:11:06,890
because it's extremely obvious

286
00:11:06,890 --> 00:11:09,570
to anyone passing through this area.

287
00:11:09,570 --> 00:11:12,320
So how would we find way back on the line

288
00:11:12,320 --> 00:11:13,790
which one is the right one?

289
00:11:13,790 --> 00:11:15,597
If we follow it to a conduit,

290
00:11:15,597 --> 00:11:18,980
and that conduit might have
a rat's nest of cables in it,

291
00:11:18,980 --> 00:11:21,240
we need to determine which one is correct.

292
00:11:21,240 --> 00:11:23,630
Let's take a look at how to do that.

293
00:11:23,630 --> 00:11:26,040
Now, if we have access
to the wire at one point,

294
00:11:26,040 --> 00:11:27,490
we want to know where it goes,

295
00:11:27,490 --> 00:11:29,150
possibly a place for attack payload

296
00:11:29,150 --> 00:11:31,180
at a more desirable location,

297
00:11:31,180 --> 00:11:34,950
there is a tool we can use
called a toner and probe.

298
00:11:34,950 --> 00:11:36,680
So we'll take our toner

299
00:11:36,680 --> 00:11:39,733
and clip it onto the
line we want to follow.

300
00:11:42,350 --> 00:11:46,430
And it will put a tone down that line,

301
00:11:46,430 --> 00:11:49,425
which we can then listen
to with our probe device.

302
00:11:49,425 --> 00:11:51,350
(probe ringing)

303
00:11:51,350 --> 00:11:53,093
And so anywhere down the line,

304
00:11:54,010 --> 00:11:57,140
we can then tell that of these two,

305
00:11:57,140 --> 00:11:59,800
this is the one connected
to what we're toning

306
00:11:59,800 --> 00:12:01,103
and not the other one.

307
00:12:02,380 --> 00:12:04,477
So once we found the
correct wire to attack

308
00:12:04,477 --> 00:12:06,710
and a good place to apply the attack,

309
00:12:06,710 --> 00:12:08,370
how do we actually do it?

310
00:12:08,370 --> 00:12:11,140
So in the situation of a
normally closed sensor,

311
00:12:11,140 --> 00:12:13,480
so it's connected in the normal situation,

312
00:12:13,480 --> 00:12:16,640
and it disconnects when
there is an alarm condition,

313
00:12:16,640 --> 00:12:19,950
in that case, all we need
to do is jumper the line,

314
00:12:19,950 --> 00:12:22,890
and that will then simulate
the switch being connected,

315
00:12:22,890 --> 00:12:25,000
and no alarm will be raised.

316
00:12:25,000 --> 00:12:27,850
So in this case here, it's
a normally closed system.

317
00:12:27,850 --> 00:12:28,850
And we see that there

318
00:12:28,850 --> 00:12:31,950
is zero equivalent
resistance seen normally.

319
00:12:31,950 --> 00:12:34,310
When I open the door, it
becomes an open circuit,

320
00:12:34,310 --> 00:12:35,483
so it's disconnected.

321
00:12:36,550 --> 00:12:38,230
To defeat that,

322
00:12:38,230 --> 00:12:40,137
all we have to do is we'll cut the line,

323
00:12:40,137 --> 00:12:42,370
and that briefly causes an alarm,

324
00:12:42,370 --> 00:12:45,000
but we'll fix that momentarily.

325
00:12:45,000 --> 00:12:47,060
And then we'll strip the outer sheath,

326
00:12:47,060 --> 00:12:48,510
and then the inner sheaths.

327
00:12:48,510 --> 00:12:52,230
And we just need to jumper
from one to the other.

328
00:12:52,230 --> 00:12:53,220
And now the controller

329
00:12:53,220 --> 00:12:56,070
continues to see an
equivalent resistance of zero,

330
00:12:56,070 --> 00:12:58,070
and the door can be opened with abandon.

331
00:12:59,020 --> 00:13:01,100
Of course, that does
trigger the alarm initially.

332
00:13:01,100 --> 00:13:05,010
So a better way to do it is to
strip just the outer sheath,

333
00:13:05,010 --> 00:13:07,520
and then tap into the inner wires,

334
00:13:07,520 --> 00:13:09,363
but leaving them intact.

335
00:13:10,250 --> 00:13:11,340
And once that's done,

336
00:13:11,340 --> 00:13:15,000
we can now apply a jumper
wire between these two taps.

337
00:13:15,000 --> 00:13:16,520
And it has the same effect.

338
00:13:16,520 --> 00:13:17,803
When we open the door,

339
00:13:18,710 --> 00:13:21,720
it continues to see no
equivalent resistance

340
00:13:21,720 --> 00:13:23,603
and no alarm is triggered.

341
00:13:25,530 --> 00:13:28,100
The second case is a normally open switch.

342
00:13:28,100 --> 00:13:29,700
So in the normal situation,

343
00:13:29,700 --> 00:13:32,470
it is disconnected and
the switch will connect

344
00:13:32,470 --> 00:13:33,680
when the door gets opened.

345
00:13:33,680 --> 00:13:36,210
So to defeat that all we have to do

346
00:13:36,210 --> 00:13:37,500
is cut the line,

347
00:13:37,500 --> 00:13:40,730
and then it always sees an open circuit.

348
00:13:40,730 --> 00:13:41,563
So in this case,

349
00:13:41,563 --> 00:13:42,396
when we open the door,

350
00:13:42,396 --> 00:13:45,360
it goes from open circuit
to a short circuit.

351
00:13:45,360 --> 00:13:47,540
If I cut this line,

352
00:13:47,540 --> 00:13:50,153
it now always sees an open circuit.

353
00:13:55,630 --> 00:13:57,650
The defenses against this.

354
00:13:57,650 --> 00:14:01,620
So it's vulnerable to
have just simple high

355
00:14:01,620 --> 00:14:04,350
or low resistance listening for.

356
00:14:04,350 --> 00:14:05,880
Instead we're going to switch

357
00:14:05,880 --> 00:14:09,000
between two different resistance values.

358
00:14:09,000 --> 00:14:12,300
So this is what's called
an end of line resistor,

359
00:14:12,300 --> 00:14:13,740
and it's less vulnerable.

360
00:14:13,740 --> 00:14:15,080
It listens to see,

361
00:14:15,080 --> 00:14:17,900
is it the resistance one
for a normal situation

362
00:14:17,900 --> 00:14:20,360
or two for an alarm condition.

363
00:14:20,360 --> 00:14:22,130
If we detect an open circuit,

364
00:14:22,130 --> 00:14:24,360
so a cut line or a short circuit,

365
00:14:24,360 --> 00:14:25,980
it will then trigger a different alarm,

366
00:14:25,980 --> 00:14:27,960
indicating a tamper situation.

367
00:14:27,960 --> 00:14:29,730
And, of course, the best defense

368
00:14:29,730 --> 00:14:31,513
would be a well-designed,

369
00:14:32,350 --> 00:14:35,650
encrypted digital communication line.

370
00:14:35,650 --> 00:14:37,150
Those are much more expensive

371
00:14:37,150 --> 00:14:40,590
and have limitations for
the maximum wire run.

372
00:14:40,590 --> 00:14:42,690
So they're much less common to see.

373
00:14:42,690 --> 00:14:45,653
These end of line resistors
though are ubiquitous.

374
00:14:46,640 --> 00:14:50,080
So how do we defeat those?

375
00:14:50,080 --> 00:14:51,640
Well, before we get into that,

376
00:14:51,640 --> 00:14:56,173
we'll do some very brief
review of resistors in general.

377
00:14:57,030 --> 00:15:00,390
So it's only three slides, I promise.

378
00:15:00,390 --> 00:15:01,830
The first concept to remember

379
00:15:01,830 --> 00:15:04,830
is that resistance measured in ohms

380
00:15:04,830 --> 00:15:08,450
is how hard it is to put power through it.

381
00:15:08,450 --> 00:15:10,390
And by Ohm's Law,

382
00:15:10,390 --> 00:15:13,270
it is the voltage applied
across the resistor,

383
00:15:13,270 --> 00:15:16,653
divided by the current that
then gets flowing through.

384
00:15:17,860 --> 00:15:19,550
The second aspect to keep in mind

385
00:15:19,550 --> 00:15:22,130
is two resistors wired in series

386
00:15:22,130 --> 00:15:23,540
will have an equivalent resistance

387
00:15:23,540 --> 00:15:25,390
that's the sum of them.

388
00:15:25,390 --> 00:15:27,190
And when they're wired in parallel,

389
00:15:27,190 --> 00:15:29,330
it's going to be this harmonic sum,

390
00:15:29,330 --> 00:15:31,330
which makes some sense
when you think about it,

391
00:15:31,330 --> 00:15:34,870
one over resistance is how easy it is

392
00:15:34,870 --> 00:15:36,080
for power to pass through,

393
00:15:36,080 --> 00:15:37,887
just like resistance is how hard it is.

394
00:15:37,887 --> 00:15:41,170
And in fact, there's a
name for it, conductance.

395
00:15:41,170 --> 00:15:43,610
And so with resistors wired in parallel,

396
00:15:43,610 --> 00:15:45,363
the conductances add up.

397
00:15:46,490 --> 00:15:48,510
That's sort of a fun graphical computation

398
00:15:48,510 --> 00:15:50,090
available to us here.

399
00:15:50,090 --> 00:15:53,810
By taking three equal
scales at 60-degree angles,

400
00:15:53,810 --> 00:15:57,930
we can apply a line from
our two resistances.

401
00:15:57,930 --> 00:16:01,190
So if R1 and R2 are both 1000 ohms,

402
00:16:01,190 --> 00:16:04,645
the equivalent for them in
parallel will be 500 here,

403
00:16:04,645 --> 00:16:09,645
800 and 400 will then
give us about 267 ohms,

404
00:16:09,970 --> 00:16:12,030
equivalent in parallel.

405
00:16:12,030 --> 00:16:13,980
So that's kind of a cool tangent there.

406
00:16:14,980 --> 00:16:16,120
Keeping that in mind,

407
00:16:16,120 --> 00:16:18,260
we usually don't have switches that flip

408
00:16:18,260 --> 00:16:20,370
between two separate resistors.

409
00:16:20,370 --> 00:16:22,400
Instead we have a simple,

410
00:16:22,400 --> 00:16:24,640
normally closed or open switch

411
00:16:24,640 --> 00:16:26,910
that will engage one resistor,

412
00:16:26,910 --> 00:16:29,310
while the other is always connected.

413
00:16:29,310 --> 00:16:30,610
So in this case,

414
00:16:30,610 --> 00:16:32,570
when the switch gets closed,

415
00:16:32,570 --> 00:16:36,230
we now have the equivalent resistance

416
00:16:36,230 --> 00:16:38,343
of these two seen in parallel.

417
00:16:39,520 --> 00:16:41,720
But I'll continue to use
this style of diagram

418
00:16:41,720 --> 00:16:44,463
for clarity in the rest
of these demonstrations.

419
00:16:45,460 --> 00:16:47,080
The last part that we'll have to consider

420
00:16:47,080 --> 00:16:50,020
is how does the controller
measure resistance?

421
00:16:50,020 --> 00:16:52,790
So it can put a voltage across the line

422
00:16:52,790 --> 00:16:55,890
and measure the current
through based on Ohm's law.

423
00:16:55,890 --> 00:16:58,350
What's more common is
to have it put a voltage

424
00:16:58,350 --> 00:16:59,290
across the line

425
00:16:59,290 --> 00:17:01,830
and have some sort of internal resistance.

426
00:17:01,830 --> 00:17:03,720
And then it measures the voltage

427
00:17:03,720 --> 00:17:05,380
between that internal resistance

428
00:17:05,380 --> 00:17:07,590
and the end of line resistor.

429
00:17:07,590 --> 00:17:09,980
This is what's called a voltage divider.

430
00:17:09,980 --> 00:17:11,760
So there there's gonna
be a certain voltage

431
00:17:11,760 --> 00:17:13,570
applied by our power source,

432
00:17:13,570 --> 00:17:14,890
there's gonna be a voltage drop

433
00:17:14,890 --> 00:17:16,460
across the internal resistor,

434
00:17:16,460 --> 00:17:19,290
and a voltage drop across
the end of line resistors.

435
00:17:19,290 --> 00:17:21,550
The sum of those two
resistor voltage drops

436
00:17:21,550 --> 00:17:24,180
is going to equal the applied voltage,

437
00:17:24,180 --> 00:17:26,220
and how much of a voltage drop

438
00:17:26,220 --> 00:17:28,400
applies on each is going to be dependent

439
00:17:28,400 --> 00:17:31,830
on the relative resistance
values of those two,

440
00:17:31,830 --> 00:17:34,630
which we can then measure by
this voltage in the middle.

441
00:17:35,670 --> 00:17:38,930
So two special cases
that are relevant here,

442
00:17:38,930 --> 00:17:41,510
when we have an open circuit situation,

443
00:17:41,510 --> 00:17:42,750
no current flows,

444
00:17:42,750 --> 00:17:44,790
the ammeter will measure zero.

445
00:17:44,790 --> 00:17:45,980
And because no current

446
00:17:45,980 --> 00:17:48,230
is flowing through this internal resistor,

447
00:17:48,230 --> 00:17:51,830
it has no voltage drop
across it by Ohm's law,

448
00:17:51,830 --> 00:17:53,510
and therefore the voltage measured

449
00:17:53,510 --> 00:17:55,890
is equal to the source voltage.

450
00:17:55,890 --> 00:17:57,380
In the case of a short circuit,

451
00:17:57,380 --> 00:17:59,160
a lot of current will flow.

452
00:17:59,160 --> 00:18:00,043
If there's no internal resistor,

453
00:18:00,043 --> 00:18:02,410
it's gonna do some damage.

454
00:18:02,410 --> 00:18:05,490
And we're wiring now
the top and the bottom

455
00:18:05,490 --> 00:18:06,940
of our voltmeter together,

456
00:18:06,940 --> 00:18:10,980
and so the voltmeter was
going to measure zero volts.

457
00:18:10,980 --> 00:18:12,430
For instance,

458
00:18:12,430 --> 00:18:15,600
one commonly seen system is
Honeywell Design Systems,

459
00:18:15,600 --> 00:18:19,110
where there is a 2.8-kiloohm
internal resistor

460
00:18:19,110 --> 00:18:22,290
and two-kiloohm end of line resistors.

461
00:18:22,290 --> 00:18:25,180
When this circuit gets
closed or completed,

462
00:18:25,180 --> 00:18:26,800
we then have a voltage divider

463
00:18:26,800 --> 00:18:30,120
that creates five volts
measured by the controller.

464
00:18:30,120 --> 00:18:31,190
And when it gets opened,

465
00:18:31,190 --> 00:18:33,420
we have the full 12-volt source

466
00:18:33,420 --> 00:18:35,573
that is measured by the controller.

467
00:18:36,650 --> 00:18:39,320
What do these underlying
resistors look like?

468
00:18:39,320 --> 00:18:41,710
Well, there are a lot easier
to spot with fire systems,

469
00:18:41,710 --> 00:18:45,360
where they tend to be in
large, well-labeled boxes,

470
00:18:45,360 --> 00:18:48,530
such as these supervising the alarm bell,

471
00:18:48,530 --> 00:18:51,210
these end of line labeled devices,

472
00:18:51,210 --> 00:18:53,850
or this supervising a
firefighters telephone.

473
00:18:53,850 --> 00:18:57,170
This is called line supervision
in fire alarm systems.

474
00:18:57,170 --> 00:19:00,310
And it's done because if
the line gets accidentally

475
00:19:00,310 --> 00:19:02,040
or environmentally damaged,

476
00:19:02,040 --> 00:19:03,470
people could die,

477
00:19:03,470 --> 00:19:05,680
and they tend to be in
large well-labeled boxes,

478
00:19:05,680 --> 00:19:06,990
because for fire alarms,

479
00:19:06,990 --> 00:19:09,220
it's important that they
be easily accessible

480
00:19:09,220 --> 00:19:10,550
and inspectable.

481
00:19:10,550 --> 00:19:13,270
With security, the opposite is true.

482
00:19:13,270 --> 00:19:14,920
So security end of line resistors

483
00:19:14,920 --> 00:19:17,850
tend to be installed
directly inside the sensors

484
00:19:17,850 --> 00:19:19,530
that they're supervising.

485
00:19:19,530 --> 00:19:20,363
In this case,

486
00:19:20,363 --> 00:19:22,610
we have one installed
between these two leads here,

487
00:19:22,610 --> 00:19:26,260
which ends up being in
series with the tamper

488
00:19:26,260 --> 00:19:30,120
and the regular infrared detector relays.

489
00:19:30,120 --> 00:19:32,040
And that will then detect

490
00:19:32,040 --> 00:19:34,900
whether either of those gets tripped.

491
00:19:34,900 --> 00:19:36,630
And if they're both in the normal state,

492
00:19:36,630 --> 00:19:39,203
we will see this resistance
at the controller.

493
00:19:40,816 --> 00:19:43,523
And so we can see that a
little bit zoomed in here.

494
00:19:45,040 --> 00:19:47,120
So attacking these end of line resistors

495
00:19:47,120 --> 00:19:49,090
is a somewhat involved process,

496
00:19:49,090 --> 00:19:51,400
because we don't know from the outset

497
00:19:51,400 --> 00:19:54,100
what the end of line resistance value is,

498
00:19:54,100 --> 00:19:56,690
what the polarity is, et cetera.

499
00:19:56,690 --> 00:20:00,303
So let's take a look at how
that might get accomplished.

500
00:20:02,140 --> 00:20:05,320
So first we'll strip the line,

501
00:20:05,320 --> 00:20:07,530
and we'll tap it into places.

502
00:20:07,530 --> 00:20:08,880
And this is going to enable us

503
00:20:08,880 --> 00:20:11,833
to measure the voltage on this line.

504
00:20:13,060 --> 00:20:14,703
We'll install a voltmeter,

505
00:20:16,090 --> 00:20:17,383
and wire it up.

506
00:20:24,040 --> 00:20:27,870
And it now measures five
volts across this line.

507
00:20:27,870 --> 00:20:29,920
If we would open the door,

508
00:20:29,920 --> 00:20:32,053
we would now see 12 volts across.

509
00:20:33,510 --> 00:20:35,780
The second thing we need
to measure is the current.

510
00:20:35,780 --> 00:20:37,600
Once we have voltage and current,

511
00:20:37,600 --> 00:20:38,620
we can divide the two

512
00:20:38,620 --> 00:20:41,990
and get the equivalent
end of line resistance.

513
00:20:41,990 --> 00:20:43,310
And to measure current,

514
00:20:43,310 --> 00:20:46,230
it has to pass through our ammeter.

515
00:20:46,230 --> 00:20:49,023
So we'll tap this line in a second place,

516
00:20:50,440 --> 00:20:53,013
and install an ammeter here,

517
00:20:55,010 --> 00:20:59,760
and then we'll have the
current run into our ammeter,

518
00:20:59,760 --> 00:21:01,430
and we'll have it run through a switch.

519
00:21:01,430 --> 00:21:02,860
You'll see why in just a second.

520
00:21:02,860 --> 00:21:05,330
This is so that we'll be
able to engage your attack

521
00:21:05,330 --> 00:21:06,763
when we're ready to do that.

522
00:21:08,210 --> 00:21:11,920
And so I'll run the wire to the switch,

523
00:21:11,920 --> 00:21:15,623
and then from the switch
to our tap device.

524
00:21:17,310 --> 00:21:18,940
And now we're seeing zero current.

525
00:21:18,940 --> 00:21:19,773
This makes sense,

526
00:21:19,773 --> 00:21:22,390
because it's still passing
through the line right here.

527
00:21:22,390 --> 00:21:24,280
So I'm going to need to cut this line,

528
00:21:24,280 --> 00:21:27,730
and then we'll actually measure
the current passing through.

529
00:21:27,730 --> 00:21:32,723
And we now see that this is
2.5 milliamps, approximately.

530
00:21:34,490 --> 00:21:35,770
So what can we do here?

531
00:21:35,770 --> 00:21:37,130
Well, we have the voltage,

532
00:21:37,130 --> 00:21:38,440
it's about five volts,

533
00:21:38,440 --> 00:21:42,590
and the current, about 2.5 milliamps.

534
00:21:42,590 --> 00:21:44,130
And if we divide those two,

535
00:21:44,130 --> 00:21:48,490
we get 2000 ohms or two kiloohms,

536
00:21:48,490 --> 00:21:51,300
because this is milliamps.

537
00:21:51,300 --> 00:21:54,170
So we'll now find an appropriate resistor

538
00:21:54,170 --> 00:21:57,640
that's as close to two kiloohms as we can.

539
00:21:57,640 --> 00:22:01,020
And the one we have that's
closest is 1.96 kiloohms,

540
00:22:01,020 --> 00:22:04,000
which we'll install it right here.

541
00:22:04,000 --> 00:22:05,940
And now what we need to do is,

542
00:22:05,940 --> 00:22:07,800
on the other side of the switch,

543
00:22:07,800 --> 00:22:08,950
when we flip it,

544
00:22:08,950 --> 00:22:11,980
we'll instead route current
through this resistor

545
00:22:11,980 --> 00:22:14,620
and then over to the negative line.

546
00:22:14,620 --> 00:22:17,343
So let's install that now.

547
00:22:20,230 --> 00:22:22,283
So wire the switch to the resistor,

548
00:22:23,590 --> 00:22:26,513
and then the resistor
to the negative line.

549
00:22:27,690 --> 00:22:30,203
And so now when we flip this switch,

550
00:22:31,160 --> 00:22:33,950
current is now getting
routed through the resistor,

551
00:22:33,950 --> 00:22:36,970
so from this positive line,

552
00:22:36,970 --> 00:22:37,990
over through the switch,

553
00:22:37,990 --> 00:22:39,290
through the resistor,

554
00:22:39,290 --> 00:22:40,770
up to the negative line.

555
00:22:40,770 --> 00:22:44,010
And so now the controller
sees the same equivalent

556
00:22:44,010 --> 00:22:45,560
end of line resistance

557
00:22:45,560 --> 00:22:48,730
as it saw when the door was
in the normal situation.

558
00:22:48,730 --> 00:22:50,400
When we opened the door,

559
00:22:50,400 --> 00:22:53,780
the controller still sees
our attack resistance

560
00:22:53,780 --> 00:22:55,900
and no alarm is raised.

561
00:22:55,900 --> 00:22:58,580
Of course, if we flip the switch back,

562
00:22:58,580 --> 00:23:00,290
and when we open the door now,

563
00:23:00,290 --> 00:23:03,493
it's all systems as normal.

564
00:23:05,170 --> 00:23:07,900
So that's how that
attack gets implemented.

565
00:23:07,900 --> 00:23:10,110
To make this easier in the physical world,

566
00:23:10,110 --> 00:23:11,790
I've designed a couple of modifications

567
00:23:11,790 --> 00:23:14,010
to be made to a standard multi-meter

568
00:23:14,010 --> 00:23:16,910
to allow you to clip onto the positive

569
00:23:16,910 --> 00:23:19,080
and negative leads of the alarm wire,

570
00:23:19,080 --> 00:23:22,000
and then somewhere downstream
on the positive leads,

571
00:23:22,000 --> 00:23:24,610
so we can cut the line and
measure current in between.

572
00:23:24,610 --> 00:23:27,130
We can flip a switch
to measure the voltage.

573
00:23:27,130 --> 00:23:29,880
And we can measure then
the resistance value

574
00:23:29,880 --> 00:23:32,090
between the green and white switches.

575
00:23:32,090 --> 00:23:34,560
And then when that's all
set up and ready to go,

576
00:23:34,560 --> 00:23:36,600
we can flip this star switch here,

577
00:23:36,600 --> 00:23:38,480
and that will engage the attack

578
00:23:38,480 --> 00:23:39,840
and reroute power,

579
00:23:39,840 --> 00:23:42,550
so that the black is
connected to the yellow,

580
00:23:42,550 --> 00:23:43,700
through the resistor,

581
00:23:43,700 --> 00:23:46,220
and then green gets connected to red,

582
00:23:46,220 --> 00:23:47,633
and back to the controller.

583
00:23:48,950 --> 00:23:51,070
The schematic for this looks like this.

584
00:23:51,070 --> 00:23:52,660
I won't go into it in detail,

585
00:23:52,660 --> 00:23:54,050
but this should be enough for you

586
00:23:54,050 --> 00:23:56,500
to design and build your own.

587
00:23:56,500 --> 00:23:59,050
And the wiring is this rat's nest here,

588
00:23:59,050 --> 00:24:01,070
and we can see how it's wired directly

589
00:24:01,070 --> 00:24:03,910
into the measurement
ports of the multimeter,

590
00:24:03,910 --> 00:24:05,730
so that it can measure our voltage,

591
00:24:05,730 --> 00:24:07,120
current and resistance

592
00:24:07,120 --> 00:24:09,040
as we perform the attack,

593
00:24:09,040 --> 00:24:11,490
so let's look at what this
looks like physically.

594
00:24:12,980 --> 00:24:15,940
So I have here a system
simulating an alarm system.

595
00:24:15,940 --> 00:24:17,410
We have our controller,

596
00:24:17,410 --> 00:24:20,480
which measures the current
and voltage being provided,

597
00:24:20,480 --> 00:24:21,680
the transmission line,

598
00:24:21,680 --> 00:24:23,790
and then our door at the end.

599
00:24:23,790 --> 00:24:26,030
So here's our door contact sensor,

600
00:24:26,030 --> 00:24:27,880
the end of line resistor.

601
00:24:27,880 --> 00:24:29,423
When I open the door,

602
00:24:30,290 --> 00:24:32,890
it opens circuits it, so disconnects.

603
00:24:32,890 --> 00:24:34,180
And we then get no current

604
00:24:34,180 --> 00:24:36,070
and the full supply voltage of 10

605
00:24:36,070 --> 00:24:37,600
being read at the controller.

606
00:24:37,600 --> 00:24:38,680
When the door closes again,

607
00:24:38,680 --> 00:24:40,950
we get a one-to-one voltage divider.

608
00:24:40,950 --> 00:24:42,000
So the end of line resistor

609
00:24:42,000 --> 00:24:45,140
being the same as the internal
controller resistance,

610
00:24:45,140 --> 00:24:47,040
and we get half or five volts,

611
00:24:47,040 --> 00:24:49,870
and 50 milliamps flowing through.

612
00:24:49,870 --> 00:24:51,750
Let's see how we'll attack this.

613
00:24:51,750 --> 00:24:54,313
So this is a standard twisted pair wire.

614
00:24:56,080 --> 00:25:00,560
So we'll open it up and give
ourselves some room to work.

615
00:25:00,560 --> 00:25:03,930
And then I'm going to
use these devices here.

616
00:25:03,930 --> 00:25:06,810
They're made by Scotchlok by 3M.

617
00:25:06,810 --> 00:25:09,830
They're called the Scotchlok Tap devices.

618
00:25:09,830 --> 00:25:12,540
And I put one wire into here,

619
00:25:14,415 --> 00:25:19,137
and get that fully in past
the little plastic clips.

620
00:25:20,160 --> 00:25:22,650
I then take the other wire
that I want to connect

621
00:25:22,650 --> 00:25:25,080
to the line that I'm tapping into,

622
00:25:25,080 --> 00:25:30,080
and insert it into the other
port of our tap device,

623
00:25:31,410 --> 00:25:32,793
insert it all the way.

624
00:25:33,660 --> 00:25:37,920
And once I'm satisfied
that those are fully in,

625
00:25:37,920 --> 00:25:39,563
I'll clamp it down.

626
00:25:46,050 --> 00:25:48,700
So we've now tapped into this wire,

627
00:25:48,700 --> 00:25:51,603
we'll do the same on the other side.

628
00:26:03,600 --> 00:26:05,813
And clamp it down firmly.

629
00:26:10,580 --> 00:26:15,580
And we now have access to the
positive and ground lines.

630
00:26:16,930 --> 00:26:21,683
We can now use our homemade
alarm wire defeat device.

631
00:26:24,320 --> 00:26:27,753
And I'm going to clamp
one to each of these.

632
00:26:38,670 --> 00:26:40,863
And I can measure the voltage across now.

633
00:26:42,270 --> 00:26:44,480
So I'll put it in voltage mode,

634
00:26:44,480 --> 00:26:47,120
and then flip this switch to
send the red and the black

635
00:26:47,120 --> 00:26:48,580
to the leads of our multimeter,

636
00:26:48,580 --> 00:26:51,713
and we get about five volts.

637
00:26:52,860 --> 00:26:54,170
To measure the current,

638
00:26:54,170 --> 00:26:56,120
we need to tap it a second time,

639
00:26:56,120 --> 00:26:57,780
so I will on the hot wire.

640
00:26:57,780 --> 00:26:59,470
I know that this is the hot wire,

641
00:26:59,470 --> 00:27:02,530
because the voltage measured was positive.

642
00:27:02,530 --> 00:27:04,330
We'll take another tap,

643
00:27:04,330 --> 00:27:08,010
and we'll tap it a
second time on this line.

644
00:27:08,010 --> 00:27:09,970
This will then force all of the current

645
00:27:09,970 --> 00:27:13,310
to flow through our multi-meter.

646
00:27:13,310 --> 00:27:14,880
And we can measure the current

647
00:27:14,880 --> 00:27:17,063
when we cut the line in between.

648
00:27:22,220 --> 00:27:24,683
So make sure those are firmly on.

649
00:27:25,709 --> 00:27:27,323
Then we can clamp this down.

650
00:27:33,797 --> 00:27:35,940
And then I'll take this yellow lead.

651
00:27:35,940 --> 00:27:38,120
It's for measuring current.

652
00:27:38,120 --> 00:27:40,893
Make sure it's good and securely on there.

653
00:27:41,930 --> 00:27:45,753
I'll flip this into
current measuring mode,

654
00:27:46,720 --> 00:27:51,610
and flip the switch to
send the multimeter leads

655
00:27:51,610 --> 00:27:53,400
to red and yellow.

656
00:27:53,400 --> 00:27:55,550
We get zero, which makes sense.

657
00:27:55,550 --> 00:27:58,260
All the current is still
flowing through this line.

658
00:27:58,260 --> 00:28:00,950
So we now have to cut that line,

659
00:28:00,950 --> 00:28:03,713
at which point we'll be
able to measure the current.

660
00:28:06,530 --> 00:28:07,950
So we've done that.

661
00:28:07,950 --> 00:28:11,000
And we now measure 50 milliamps.

662
00:28:11,000 --> 00:28:12,090
With those two measurements,

663
00:28:12,090 --> 00:28:14,160
we can now calculate what resistance

664
00:28:14,160 --> 00:28:16,690
we need to attack this line.

665
00:28:16,690 --> 00:28:17,710
In this case,

666
00:28:17,710 --> 00:28:21,513
five volts divided by 50
milliamps is 100 ohms.

667
00:28:24,410 --> 00:28:26,730
And that's ohms, because it's milli amps,

668
00:28:26,730 --> 00:28:31,730
so we got our measure in
kilovolts and have to convert.

669
00:28:31,890 --> 00:28:34,210
So here is a 100 ohm resistor,

670
00:28:34,210 --> 00:28:37,123
and I'm going to use this
as my attack resistor.

671
00:28:38,640 --> 00:28:41,600
I'll clip it onto our
green and white leads.

672
00:28:41,600 --> 00:28:43,300
These are our attack leads.

673
00:28:43,300 --> 00:28:46,913
Again, making sure that it
is fully securely connected,

674
00:28:48,300 --> 00:28:51,030
and actually I'll clip
on right at the base,

675
00:28:51,030 --> 00:28:52,580
and you'll see why in a moment.

676
00:28:55,820 --> 00:28:57,840
And just to double check,

677
00:28:57,840 --> 00:29:00,343
flip it back out of
current measuring mode,

678
00:29:03,150 --> 00:29:05,570
turn it into resistance mode,

679
00:29:05,570 --> 00:29:08,420
and flip this switch to
send the green and the white

680
00:29:08,420 --> 00:29:09,280
to the leads,

681
00:29:09,280 --> 00:29:12,233
and we can measure that
this is indeed 100 ohms.

682
00:29:13,500 --> 00:29:15,460
With all that done, we're now ready.

683
00:29:15,460 --> 00:29:18,440
When I flip this switch
to actuate the attack,

684
00:29:18,440 --> 00:29:20,370
it's going to reroute power.

685
00:29:20,370 --> 00:29:24,330
Instead of going from
red through to yellow,

686
00:29:24,330 --> 00:29:26,400
through the door, back to black,

687
00:29:26,400 --> 00:29:27,643
and back to the controller,

688
00:29:27,643 --> 00:29:30,650
it's going to cut the line
between red and yellow,

689
00:29:30,650 --> 00:29:33,380
and send red to green
through the resistor,

690
00:29:33,380 --> 00:29:34,490
and white to black,

691
00:29:34,490 --> 00:29:35,973
and back to the controller.

692
00:29:36,940 --> 00:29:39,020
So I'll flip that switch now.

693
00:29:39,020 --> 00:29:41,350
We've now engaged the attack.

694
00:29:41,350 --> 00:29:45,010
At this point, the door
is no longer connected.

695
00:29:45,010 --> 00:29:48,290
All of the power is going
through our attack resistor,

696
00:29:48,290 --> 00:29:50,550
and I can safely open the door,

697
00:29:50,550 --> 00:29:53,053
and the controller is none the wiser.

698
00:29:54,100 --> 00:29:57,450
The last thing that we can do is,

699
00:29:57,450 --> 00:29:59,830
to make this a permanent setup,

700
00:29:59,830 --> 00:30:02,630
we can wire these in directly

701
00:30:02,630 --> 00:30:06,483
using these 3M Scotchlok joins.

702
00:30:07,660 --> 00:30:09,670
So I will insert.

703
00:30:09,670 --> 00:30:12,733
We need to match white to black,

704
00:30:15,100 --> 00:30:17,113
insert the wire all the way,

705
00:30:19,440 --> 00:30:22,090
insert the wire all the way,

706
00:30:22,090 --> 00:30:23,603
as far as it will go.

707
00:30:27,891 --> 00:30:30,257
And then I will clamp that down

708
00:30:33,650 --> 00:30:35,113
to connect those two.

709
00:30:37,610 --> 00:30:42,273
I can now safely remove the
white and the black leads,

710
00:30:43,230 --> 00:30:46,593
and I'll do the same to
connect red to green.

711
00:30:53,590 --> 00:30:54,833
Take another join.

712
00:30:56,630 --> 00:30:59,003
Insert that as far as it will go.

713
00:31:03,540 --> 00:31:06,350
Whoops, so you'll notice
that the controller

714
00:31:06,350 --> 00:31:08,680
just detected a short circuit,

715
00:31:08,680 --> 00:31:11,560
and that's because I
accidentally let these two wires

716
00:31:11,560 --> 00:31:14,030
touch on the wrong side of the resistor.

717
00:31:14,030 --> 00:31:16,150
So that would have been a fail

718
00:31:16,150 --> 00:31:20,443
had this been a real life
circumvention of an alarm.

719
00:31:21,960 --> 00:31:23,993
Make sure those don't touch again.

720
00:31:25,290 --> 00:31:29,493
And then I can safely
remove all of the leads.

721
00:31:30,580 --> 00:31:33,733
And we've now instituted an attack.

722
00:31:34,900 --> 00:31:36,460
The ground wire is still connected,

723
00:31:36,460 --> 00:31:37,293
but it doesn't need to be.

724
00:31:37,293 --> 00:31:38,810
And just to illustrate the point,

725
00:31:38,810 --> 00:31:40,233
I will cut that as well.

726
00:31:41,150 --> 00:31:44,150
And so now we've successfully measured

727
00:31:44,150 --> 00:31:46,330
what the end of line resistance is,

728
00:31:46,330 --> 00:31:49,160
and installed a new surrogate resistor

729
00:31:49,160 --> 00:31:50,970
that power is flowing through.

730
00:31:50,970 --> 00:31:53,010
And now, of course, it's disconnected.

731
00:31:53,010 --> 00:31:56,483
Opening the door does
not set off the alarm.

732
00:31:58,320 --> 00:32:00,900
So we can see in our schematic
what was happening there.

733
00:32:00,900 --> 00:32:03,130
When we flipped this
switch to measure voltage,

734
00:32:03,130 --> 00:32:04,880
it sends the red and the black wire

735
00:32:04,880 --> 00:32:06,420
to the leads of our multimeter,

736
00:32:06,420 --> 00:32:08,260
and it can then measure the voltage,

737
00:32:08,260 --> 00:32:09,460
likewise for the current,

738
00:32:09,460 --> 00:32:11,630
with the red and the yellow wire,

739
00:32:11,630 --> 00:32:15,390
and for the resistance
sending the multimeter ports

740
00:32:15,390 --> 00:32:16,670
to green and white,

741
00:32:16,670 --> 00:32:19,723
which is what contains
our attack resistor.

742
00:32:22,620 --> 00:32:24,330
So we can ask ourselves,

743
00:32:24,330 --> 00:32:26,010
can we do better than that?

744
00:32:26,010 --> 00:32:27,270
There were a number of problems

745
00:32:27,270 --> 00:32:29,200
with the resistor-based approach.

746
00:32:29,200 --> 00:32:31,400
One is measuring current
is incredibly tedious

747
00:32:31,400 --> 00:32:32,960
or requires cutting the line.

748
00:32:32,960 --> 00:32:34,960
If we can avoid having to cut the line,

749
00:32:34,960 --> 00:32:37,050
then we can potentially remove the attack

750
00:32:37,050 --> 00:32:39,240
and restore it to its original state,

751
00:32:39,240 --> 00:32:40,860
if that's necessary.

752
00:32:40,860 --> 00:32:42,650
And the second bigger problem

753
00:32:42,650 --> 00:32:46,750
is that when we flip the
switch to engage the attack,

754
00:32:46,750 --> 00:32:48,620
two pull switches, when you flip them,

755
00:32:48,620 --> 00:32:52,230
have a brief period of time
where neither pull is connected.

756
00:32:52,230 --> 00:32:53,310
And at that point,

757
00:32:53,310 --> 00:32:56,410
the controller would see an open circuit.

758
00:32:56,410 --> 00:32:57,610
It's very brief,

759
00:32:57,610 --> 00:32:59,410
and the vast majority of controllers

760
00:32:59,410 --> 00:33:00,900
would not be able to detect that,

761
00:33:00,900 --> 00:33:01,870
but some will,

762
00:33:01,870 --> 00:33:04,990
and so that's something
that we want to avoid.

763
00:33:04,990 --> 00:33:06,360
So what would be ideal

764
00:33:06,360 --> 00:33:08,950
is if we can tap each line once,

765
00:33:08,950 --> 00:33:10,810
and have something across it

766
00:33:10,810 --> 00:33:13,080
that maintains exactly the voltage

767
00:33:13,080 --> 00:33:14,940
that we need and just enforces that,

768
00:33:14,940 --> 00:33:17,990
and then we don't need to
worry about the current.

769
00:33:17,990 --> 00:33:20,480
Well, such a component
actually does exist,

770
00:33:20,480 --> 00:33:22,570
and it's called a Zener diode.

771
00:33:22,570 --> 00:33:24,330
So diodes, as you know,

772
00:33:24,330 --> 00:33:26,480
allow current to flow one way

773
00:33:26,480 --> 00:33:27,763
and block at the other.

774
00:33:28,770 --> 00:33:30,090
When it blocks the current,

775
00:33:30,090 --> 00:33:31,500
it acts as an insulator,

776
00:33:31,500 --> 00:33:33,570
and all insulators will break down

777
00:33:33,570 --> 00:33:36,540
when exposed to a high enough voltage.

778
00:33:36,540 --> 00:33:39,440
Zener diodes are designed
to do this at a lower

779
00:33:39,440 --> 00:33:42,030
and at a very specific voltage level.

780
00:33:42,030 --> 00:33:44,570
So when we reverse bias the Zener diode,

781
00:33:44,570 --> 00:33:48,260
i.e., apply a voltage in
the reverse direction,

782
00:33:48,260 --> 00:33:50,000
so it's an insulator,

783
00:33:50,000 --> 00:33:51,930
above a certain breakdown voltage,

784
00:33:51,930 --> 00:33:54,173
it turns into a very good conductor.

785
00:33:55,650 --> 00:33:57,450
So what that then lets us do,

786
00:33:57,450 --> 00:34:00,370
is when we open the door in a jump safe

787
00:34:00,370 --> 00:34:02,180
from five to 12 volts,

788
00:34:02,180 --> 00:34:05,000
if this is a five-volt
breakdowns Zener diode,

789
00:34:05,000 --> 00:34:05,833
it's now 12 volts,

790
00:34:05,833 --> 00:34:07,037
so it becomes a conductor,

791
00:34:07,037 --> 00:34:09,070
and it pulls that voltage down to five,

792
00:34:09,070 --> 00:34:11,410
at which point, it becomes
an insulator again,

793
00:34:11,410 --> 00:34:13,890
and it doesn't pull it down any further,

794
00:34:13,890 --> 00:34:15,030
we get a feedback system

795
00:34:15,030 --> 00:34:17,873
where this maintains exactly five volts.

796
00:34:18,940 --> 00:34:20,600
Let's apply this.

797
00:34:20,600 --> 00:34:22,650
So we have the same type of system.

798
00:34:22,650 --> 00:34:24,270
We can strip the wire.

799
00:34:24,270 --> 00:34:25,670
And right now it's five volts.

800
00:34:25,670 --> 00:34:26,640
When we open the door,

801
00:34:26,640 --> 00:34:27,830
it opens circuits it,

802
00:34:27,830 --> 00:34:30,560
and it's all the way up at 12 volts.

803
00:34:30,560 --> 00:34:33,330
And so we'll try to find a Zener diode

804
00:34:33,330 --> 00:34:36,293
that will adequately maintain that.

805
00:34:37,690 --> 00:34:41,093
First we'll tap each line once.

806
00:34:43,890 --> 00:34:46,140
Now, we can see the
controller in this game,

807
00:34:46,140 --> 00:34:47,250
but in real life,

808
00:34:47,250 --> 00:34:49,870
we would just have access to the line.

809
00:34:49,870 --> 00:34:51,660
So we'll have to add a voltmeter,

810
00:34:51,660 --> 00:34:54,780
so we can actually tell
what is the voltage.

811
00:34:54,780 --> 00:34:58,710
And so we'll wire that
into our tap devices

812
00:35:01,190 --> 00:35:03,530
and that tells us,
indeed, it's five volts.

813
00:35:03,530 --> 00:35:05,630
So we need a Zener diode with a breakdown

814
00:35:05,630 --> 00:35:08,350
as close to five volts as possible.

815
00:35:08,350 --> 00:35:10,690
Well, 5.1 is pretty close,

816
00:35:10,690 --> 00:35:12,290
and that should be within the parameters

817
00:35:12,290 --> 00:35:16,190
of what the controller deems acceptable.

818
00:35:16,190 --> 00:35:18,830
And we can wire that in as well.

819
00:35:18,830 --> 00:35:21,900
I have to wire it somewhat in reverse,

820
00:35:21,900 --> 00:35:23,870
because we need this
to be in reverse bias,

821
00:35:23,870 --> 00:35:27,313
so that's why criss-crosses
over itself there.

822
00:35:28,870 --> 00:35:30,180
But now that we've done that,

823
00:35:30,180 --> 00:35:31,633
when I open the door,

824
00:35:32,850 --> 00:35:35,510
it now only increases up to 5.1 volts,

825
00:35:35,510 --> 00:35:38,210
which is the breakdown
voltage of our Zener diode.

826
00:35:38,210 --> 00:35:39,227
Anything above that,

827
00:35:39,227 --> 00:35:40,970
and the diode begins conducting

828
00:35:40,970 --> 00:35:44,410
and pulls the voltage
back down to 5.1 volts,

829
00:35:44,410 --> 00:35:46,860
and that's well within
the acceptable range

830
00:35:46,860 --> 00:35:48,290
for our controller,

831
00:35:48,290 --> 00:35:50,463
so it does not trigger an alarm.

832
00:35:51,700 --> 00:35:55,600
We can make a one addition
to our multimeter adapter

833
00:35:55,600 --> 00:35:57,210
to help ease this process,

834
00:35:57,210 --> 00:35:59,300
and that is adding an
internal power source.

835
00:35:59,300 --> 00:36:00,980
So we can flip a switch

836
00:36:00,980 --> 00:36:03,920
that will then apply that
across the measuring leads

837
00:36:03,920 --> 00:36:05,200
of the multimeter

838
00:36:05,200 --> 00:36:09,150
and the green and white component leads,

839
00:36:09,150 --> 00:36:11,210
so that we can actually
test a Zener diode,

840
00:36:11,210 --> 00:36:14,500
and make sure that it pulls
down from the supplied voltage

841
00:36:14,500 --> 00:36:18,350
to what the Zener should
be pulling it down to.

842
00:36:18,350 --> 00:36:20,550
Now, let's take a look
at this in real life

843
00:36:20,550 --> 00:36:22,783
and applying to this Zener diode attack.

844
00:36:24,830 --> 00:36:28,090
So let's see how we'd apply
the Zener diode-based approach.

845
00:36:28,090 --> 00:36:30,280
We have the exact same set up here,

846
00:36:30,280 --> 00:36:33,110
and we're going to start
the exact same way,

847
00:36:33,110 --> 00:36:37,080
by tapping each wire,

848
00:36:37,080 --> 00:36:38,120
but only once this time.

849
00:36:38,120 --> 00:36:40,240
We only need to do two taps.

850
00:36:40,240 --> 00:36:42,220
Of course, if the door opens,

851
00:36:42,220 --> 00:36:43,683
we get the same behavior,

852
00:36:44,630 --> 00:36:48,660
and so we'll try to avoid
that happening this time,

853
00:36:48,660 --> 00:36:52,883
so we can perform the defeat
without setting off the alarm.

854
00:36:55,220 --> 00:36:58,223
So get that wire onto our tap device.

855
00:36:59,980 --> 00:37:02,823
Put in the other wire
as far as it will go.

856
00:37:05,205 --> 00:37:07,005
Then we're ready to clamp this down.

857
00:37:15,490 --> 00:37:17,070
That's now good and connected.

858
00:37:17,070 --> 00:37:19,513
We'll tap the other wire
in much the same way.

859
00:37:23,660 --> 00:37:25,163
Make sure that's fully on.

860
00:37:26,920 --> 00:37:29,193
Insert this as far as it will go.

861
00:37:32,850 --> 00:37:34,570
Make sure both are in place.

862
00:37:34,570 --> 00:37:37,793
We can then clamp this down as well.

863
00:37:41,690 --> 00:37:42,790
Of course, we wanna be careful

864
00:37:42,790 --> 00:37:44,000
that these two don't touch.

865
00:37:44,000 --> 00:37:46,720
If they do, we will short out the system.

866
00:37:46,720 --> 00:37:47,650
The current jumps up,

867
00:37:47,650 --> 00:37:49,220
and the voltage jumps down to zero,

868
00:37:49,220 --> 00:37:51,210
and the controller will detect that

869
00:37:51,210 --> 00:37:52,723
as we're seeing it does here.

870
00:37:53,750 --> 00:37:55,220
So in a real life scenario,

871
00:37:55,220 --> 00:37:57,230
we wanna make sure we don't do that,

872
00:37:57,230 --> 00:38:00,150
but now we can measure what the voltage is

873
00:38:00,150 --> 00:38:02,060
as measured by the controller.

874
00:38:02,060 --> 00:38:06,723
So we'll take our handy measuring device,

875
00:38:09,110 --> 00:38:10,343
clip it on,

876
00:38:12,190 --> 00:38:14,350
switch into voltage mode,

877
00:38:14,350 --> 00:38:16,940
and flip this switch to
send the red and the black

878
00:38:16,940 --> 00:38:19,390
to the two ports of the multimeter.

879
00:38:19,390 --> 00:38:21,663
And we read five volts.

880
00:38:23,810 --> 00:38:27,833
So we need a five volt
breakdown Zener diode,

881
00:38:29,490 --> 00:38:30,853
which I've got right here,

882
00:38:33,085 --> 00:38:36,097
and we'll clip it on
to our component leads.

883
00:38:44,670 --> 00:38:46,810
And we could perhaps also test that

884
00:38:46,810 --> 00:38:48,910
this is actually five volts.

885
00:38:48,910 --> 00:38:50,610
So to do that, first, I'll unclip,

886
00:38:51,500 --> 00:38:53,860
we'll leave it in voltage measuring mode,

887
00:38:53,860 --> 00:38:56,650
flip this switch to send these two leads

888
00:38:56,650 --> 00:38:59,890
to the ports of the multimeter.

889
00:38:59,890 --> 00:39:01,610
We get zero, which makes sense.

890
00:39:01,610 --> 00:39:02,710
I'll flip this last switch

891
00:39:02,710 --> 00:39:05,600
to apply an internal 12-volt supply.

892
00:39:05,600 --> 00:39:08,720
So we're reading 12 volts
when it's open circuited.

893
00:39:08,720 --> 00:39:11,170
If I connect it through the Zener diode,

894
00:39:11,170 --> 00:39:13,920
it then pulls it down to five volts,

895
00:39:13,920 --> 00:39:15,293
which is what we want.

896
00:39:17,300 --> 00:39:18,603
Turn off that measurement.

897
00:39:21,290 --> 00:39:24,320
We're now ready to apply the attack.

898
00:39:24,320 --> 00:39:27,300
And all we need to do is flip the switch

899
00:39:27,300 --> 00:39:28,663
to engage the attack.

900
00:39:29,960 --> 00:39:32,920
It then turns on that Zener diode.

901
00:39:32,920 --> 00:39:34,833
And now if I open the door,

902
00:39:35,810 --> 00:39:38,390
it will regulate the voltage accordingly.

903
00:39:38,390 --> 00:39:39,280
It isn't perfect.

904
00:39:39,280 --> 00:39:41,463
It's not a perfect match to five volts,

905
00:39:42,480 --> 00:39:44,190
but we see that this would be

906
00:39:44,190 --> 00:39:47,470
within the acceptable parameters
for the controller here.

907
00:39:47,470 --> 00:39:48,303
And, of course,

908
00:39:48,303 --> 00:39:50,920
if I flip the switch
back to disconnect it,

909
00:39:50,920 --> 00:39:53,683
it now operates as normal.

910
00:39:54,840 --> 00:39:57,380
I should note that this fancy setup

911
00:39:57,380 --> 00:39:58,900
is not actually required.

912
00:39:58,900 --> 00:40:01,160
Because we never cut the line,

913
00:40:01,160 --> 00:40:04,820
we do not need to switch quickly

914
00:40:04,820 --> 00:40:06,540
from connecting the yellow port,

915
00:40:06,540 --> 00:40:07,500
which isn't used,

916
00:40:07,500 --> 00:40:10,150
to our attack components.

917
00:40:10,150 --> 00:40:14,480
So all I really needed
was any old voltmeter

918
00:40:14,480 --> 00:40:16,370
that could've measured across here.

919
00:40:16,370 --> 00:40:17,920
And at that point,

920
00:40:17,920 --> 00:40:22,540
I can then connect these
up any old way I please.

921
00:40:22,540 --> 00:40:24,770
And with those connected,

922
00:40:24,770 --> 00:40:28,750
I'm free to open the door as well.

923
00:40:28,750 --> 00:40:31,463
And, of course, if they disconnect,

924
00:40:32,640 --> 00:40:34,530
it behaves as usual.

925
00:40:34,530 --> 00:40:37,320
And so in this case, as well as last,

926
00:40:37,320 --> 00:40:40,540
I could take some joins
and connect this in

927
00:40:40,540 --> 00:40:42,390
to leave it as a permanent fixture,

928
00:40:42,390 --> 00:40:43,723
defeating the alarm.

929
00:40:45,970 --> 00:40:47,560
After everything we've talked about,

930
00:40:47,560 --> 00:40:48,710
it may be tempting to say,

931
00:40:48,710 --> 00:40:50,157
well, wireless must be more secure,

932
00:40:50,157 --> 00:40:51,890
and we should use that instead.

933
00:40:51,890 --> 00:40:54,400
Here's why that's not the case.

934
00:40:54,400 --> 00:40:56,710
This particular example we have here

935
00:40:56,710 --> 00:40:59,210
communicates on 433 megahertz.

936
00:40:59,210 --> 00:41:00,660
So if we open the door,

937
00:41:00,660 --> 00:41:01,773
it will send a signal,

938
00:41:01,773 --> 00:41:04,150
(alarm rings)

939
00:41:04,150 --> 00:41:06,450
and the alarm is triggered.

940
00:41:06,450 --> 00:41:08,110
We can listen to what that signal is

941
00:41:08,110 --> 00:41:09,450
with our trusty BaoFeng.

942
00:41:09,450 --> 00:41:10,789
So we'll listen to

943
00:41:10,789 --> 00:41:13,094
433 megahertz.
- Four, three,

944
00:41:13,094 --> 00:41:15,210
three, zero,

945
00:41:15,210 --> 00:41:17,133
zero, zero.

946
00:41:18,087 --> 00:41:19,705
- And when we open the door,

947
00:41:19,705 --> 00:41:21,450
(device beating)

948
00:41:21,450 --> 00:41:22,760
we hear that signal.

949
00:41:22,760 --> 00:41:24,870
Of course, we can use the transmit feature

950
00:41:24,870 --> 00:41:26,919
to jam the signal.

951
00:41:26,919 --> 00:41:30,419
(security device beeping)

952
00:41:32,700 --> 00:41:34,617
And so now successfully opened the door

953
00:41:34,617 --> 00:41:37,433
and the controller has no idea.

954
00:41:38,569 --> 00:41:43,200
(security device beeps)
(device beats)

955
00:41:43,200 --> 00:41:44,930
Now any frequency it might use,

956
00:41:44,930 --> 00:41:46,510
not just 433 megahertz,

957
00:41:46,510 --> 00:41:49,050
is jammable, possibly not so easily.

958
00:41:49,050 --> 00:41:52,270
Wifi is another point that
has a known vulnerability,

959
00:41:52,270 --> 00:41:53,840
and that is deauthers.

960
00:41:53,840 --> 00:41:56,860
Here's one that I particularly
like made by Maltronics,

961
00:41:56,860 --> 00:41:58,250
but any will do.

962
00:41:58,250 --> 00:41:59,230
You can open it up

963
00:41:59,230 --> 00:42:01,860
and it'll take advantage
of the wifi protocol

964
00:42:01,860 --> 00:42:03,880
to listen for specific devices,

965
00:42:03,880 --> 00:42:06,610
and kick them off of the
network whenever they join.

966
00:42:06,610 --> 00:42:08,300
You can use the hardware Mac address

967
00:42:08,300 --> 00:42:10,240
to kick off specifically those devices

968
00:42:10,240 --> 00:42:12,313
made by alarm manufacturers.

969
00:42:14,430 --> 00:42:17,110
So if using wireless is
not a great solution,

970
00:42:17,110 --> 00:42:20,580
what can we do to defend
against these attacks?

971
00:42:20,580 --> 00:42:21,930
So the first thing is,

972
00:42:21,930 --> 00:42:23,340
anywhere we run these wires

973
00:42:23,340 --> 00:42:24,860
should be in armored conduits,

974
00:42:24,860 --> 00:42:28,100
and places where it's easy
to unscrew a junction box

975
00:42:28,100 --> 00:42:30,200
and access to the wires underneath

976
00:42:30,200 --> 00:42:31,340
should be placed high,

977
00:42:31,340 --> 00:42:32,173
or out of reach,

978
00:42:32,173 --> 00:42:33,170
or under your camera

979
00:42:33,170 --> 00:42:36,280
to deter the ability for
an attacker to do that.

980
00:42:36,280 --> 00:42:39,000
We might also consider
placing tamper switches

981
00:42:39,000 --> 00:42:40,320
in those junction boxes,

982
00:42:40,320 --> 00:42:41,833
where that is not possible.

983
00:42:42,710 --> 00:42:44,670
We obviously want to avoid doing this,

984
00:42:44,670 --> 00:42:47,980
having bare wires out right at hand level,

985
00:42:47,980 --> 00:42:50,220
easy for anyone to access.

986
00:42:50,220 --> 00:42:53,300
We also wanna install all the
critical security hardware

987
00:42:53,300 --> 00:42:56,280
and the wires for it on the
secure side of the door.

988
00:42:56,280 --> 00:42:58,700
So we should never have a contact sensor

989
00:42:58,700 --> 00:43:01,290
mounted on the unsecure side of the frame,

990
00:43:01,290 --> 00:43:02,150
like this,

991
00:43:02,150 --> 00:43:05,150
and the wires themselves
should be as well.

992
00:43:05,150 --> 00:43:06,840
In particular, we wanna give some thought

993
00:43:06,840 --> 00:43:09,380
to where the wires get routed
throughout the building,

994
00:43:09,380 --> 00:43:10,900
and references to the security levels

995
00:43:10,900 --> 00:43:12,780
at different areas in the building.

996
00:43:12,780 --> 00:43:16,250
For instance, rooms 103
to 105 are more secure

997
00:43:16,250 --> 00:43:17,940
in this case.

998
00:43:17,940 --> 00:43:21,420
The wires for them go to
this controller in room 103.

999
00:43:21,420 --> 00:43:24,020
We would want to run them
in the rooms themselves

1000
00:43:24,020 --> 00:43:27,570
and not in the hallway that
has a lower security level.

1001
00:43:27,570 --> 00:43:29,830
We also wanna give some thought to timing

1002
00:43:29,830 --> 00:43:32,030
as well as spatial aspects.

1003
00:43:32,030 --> 00:43:34,790
So if part of the building
is open to the public

1004
00:43:34,790 --> 00:43:35,660
during some hours,

1005
00:43:35,660 --> 00:43:36,630
but not others,

1006
00:43:36,630 --> 00:43:38,070
it might be possible for an attacker

1007
00:43:38,070 --> 00:43:40,910
to modify these systems during open hours,

1008
00:43:40,910 --> 00:43:42,750
and then come back afterwards.

1009
00:43:42,750 --> 00:43:45,890
And that's something that
needs to be considered as well.

1010
00:43:45,890 --> 00:43:47,740
We want to avoid at all costs

1011
00:43:47,740 --> 00:43:50,870
running security wires
outside of the building

1012
00:43:50,870 --> 00:43:53,170
or outside of all security perimeters.

1013
00:43:53,170 --> 00:43:56,040
And that's not just if this
is in your threat model.

1014
00:43:56,040 --> 00:43:56,900
And let's be honest,

1015
00:43:56,900 --> 00:43:58,700
for the vast majority of installations,

1016
00:43:58,700 --> 00:44:01,390
these types of attacks are
not in your threat model.

1017
00:44:01,390 --> 00:44:03,130
But also if the outside of your building

1018
00:44:03,130 --> 00:44:06,270
is ever exposed to weather.

1019
00:44:06,270 --> 00:44:08,030
It's a rare phenomenon, I know,

1020
00:44:08,030 --> 00:44:11,110
but it can wreak absolute
havoc on communications lines

1021
00:44:11,110 --> 00:44:13,320
when it infiltrates into there.

1022
00:44:13,320 --> 00:44:15,250
And, of course, the
ultimate of defense here

1023
00:44:15,250 --> 00:44:18,990
is to use a well-designed,
encrypted digital line.

1024
00:44:18,990 --> 00:44:20,800
So that would be one that uses nonces

1025
00:44:20,800 --> 00:44:22,410
to prevent replay attacks,

1026
00:44:22,410 --> 00:44:23,690
and has heartbeats

1027
00:44:23,690 --> 00:44:26,670
to detect denial of service, et cetera.

1028
00:44:26,670 --> 00:44:27,890
But that's very expensive

1029
00:44:27,890 --> 00:44:32,030
and often not justified
in terms of that cost.

1030
00:44:32,030 --> 00:44:33,350
So thank you very much for listening.

1031
00:44:33,350 --> 00:44:35,470
I hope this has been interesting

1032
00:44:35,470 --> 00:44:38,350
and a foray into an area
of physical security

1033
00:44:38,350 --> 00:44:40,540
that has not yet been
given a huge treatment

1034
00:44:40,540 --> 00:44:41,800
in this community.

1035
00:44:41,800 --> 00:44:43,490
I'd like to extend an enormous thank you

1036
00:44:43,490 --> 00:44:45,230
to Paul, Karen, Jenny, and Bobby

1037
00:44:45,230 --> 00:44:47,210
for their help preparing this talk,

1038
00:44:47,210 --> 00:44:49,290
in particular to Paul for his expertise

1039
00:44:49,290 --> 00:44:51,260
in the telecom industry.

1040
00:44:51,260 --> 00:44:53,830
I encourage you to go try it yourselves.

1041
00:44:53,830 --> 00:44:56,020
All of these games that
I've shown in this talk

1042
00:44:56,020 --> 00:44:57,220
are available for you to try

1043
00:44:57,220 --> 00:44:59,010
in the comfort of your own home.

1044
00:44:59,010 --> 00:45:01,600
Give that a try in the
Bypass Village at DEF CON

1045
00:45:01,600 --> 00:45:03,340
or at bypassvillage.org.

1046
00:45:03,340 --> 00:45:05,480
And I'd be happy to take any questions,

1047
00:45:05,480 --> 00:45:09,170
either in person at DEF CON
or over email or Twitter.

1048
00:45:09,170 --> 00:45:10,313
Thank you very much.

