1
00:00:01,570 --> 00:00:05,437
- Hi everyone, my name is Roy
Davis and welcome to my talk,

2
00:00:05,437 --> 00:00:08,720
"No Key? No PIN? No Combo? No Problem!

3
00:00:08,720 --> 00:00:10,967
P0wning ATMs for Fun and Profit."

4
00:00:12,190 --> 00:00:16,020
Shout out to all my homeys
at DC612 in Minnesota.

5
00:00:16,020 --> 00:00:17,910
And for anybody that wants
to get ahold of me about the

6
00:00:17,910 --> 00:00:19,890
content of this presentation,

7
00:00:19,890 --> 00:00:23,320
my contact information is
all on the screen there.

8
00:00:23,320 --> 00:00:24,920
Before we get too far into this,

9
00:00:24,920 --> 00:00:28,530
I've got to say this content
is provided for educational

10
00:00:28,530 --> 00:00:30,930
and entertainment purposes only.

11
00:00:30,930 --> 00:00:35,060
Unauthorized access of other
people's ATMs is illegal.

12
00:00:35,060 --> 00:00:36,490
Don't do it.

13
00:00:36,490 --> 00:00:37,323
Don't do it.

14
00:00:37,323 --> 00:00:39,060
You're gonna go to jail.

15
00:00:39,060 --> 00:00:39,893
Secondly,

16
00:00:39,893 --> 00:00:41,990
this presentation is not associated

17
00:00:41,990 --> 00:00:45,270
with my employer in any way,
except to say they've been very

18
00:00:45,270 --> 00:00:48,420
supportive of this opportunity and of me.

19
00:00:48,420 --> 00:00:49,870
And I really appreciate that.

20
00:00:51,050 --> 00:00:52,630
So why ATMs?

21
00:00:52,630 --> 00:00:54,580
There's several answers to this question.

22
00:00:54,580 --> 00:00:56,470
The first being when I was a kid,

23
00:00:56,470 --> 00:00:59,088
I used to go to the grocery
store with my mom and she'd walk

24
00:00:59,088 --> 00:01:00,633
up to this machine once in a while

25
00:01:00,633 --> 00:01:03,020
that said instant cash on the front.

26
00:01:03,020 --> 00:01:04,640
And I thought, man, this is great.

27
00:01:04,640 --> 00:01:05,950
How do I get a piece of this action?

28
00:01:05,950 --> 00:01:07,700
I want instant cash.

29
00:01:07,700 --> 00:01:10,760
And you know, a long time
went by, I graduated college,

30
00:01:10,760 --> 00:01:14,790
I got into security and
I got into pin testing.

31
00:01:14,790 --> 00:01:16,920
I never forgot about that childhood dream.

32
00:01:16,920 --> 00:01:20,740
I always wanted to learn how
those things work inside,

33
00:01:20,740 --> 00:01:23,450
How can they can be
configured or misconfigured?

34
00:01:23,450 --> 00:01:25,090
What does their network traffic look like,

35
00:01:25,090 --> 00:01:26,883
and how secure is that vault?

36
00:01:28,390 --> 00:01:31,603
In my opinion, cash is not
going away anytime soon.

37
00:01:32,600 --> 00:01:34,760
Cash still provides a level of anonymity

38
00:01:34,760 --> 00:01:39,760
to people who use it, that
cards just don't give you.

39
00:01:40,270 --> 00:01:42,220
They leave a paper trail.

40
00:01:42,220 --> 00:01:44,240
ATMs are everywhere all over the world

41
00:01:44,240 --> 00:01:47,570
and increasing in numbers,
as you can see in this chart

42
00:01:47,570 --> 00:01:52,570
between 2008 and 2019,
doubling of the number of ATMs.

43
00:01:55,780 --> 00:01:59,120
A lot of people think, that
own these machines in bars

44
00:01:59,120 --> 00:02:02,210
and restaurants and wherever,
that as long as this thing

45
00:02:02,210 --> 00:02:03,810
keeps working, it's good, right?

46
00:02:04,660 --> 00:02:07,500
The low levels of security
maintenance adoption

47
00:02:07,500 --> 00:02:09,200
for these machines is incredible.

48
00:02:09,200 --> 00:02:12,060
If you think it's hard
to get PC users or like

49
00:02:12,060 --> 00:02:16,050
an InfraOps team to apply
patches in production,

50
00:02:16,050 --> 00:02:18,100
imagine trying to get bar owners to update

51
00:02:18,100 --> 00:02:19,580
their ATM software.

52
00:02:19,580 --> 00:02:21,080
It's really, really difficult.

53
00:02:22,400 --> 00:02:25,240
Also a lot of ATM security seems to me,

54
00:02:25,240 --> 00:02:29,530
based on obscurity and lack
of design transparency.

55
00:02:29,530 --> 00:02:33,480
They're missing huge
amounts of documentation.

56
00:02:33,480 --> 00:02:36,330
Try searching in the internet
sometime for communications

57
00:02:36,330 --> 00:02:39,530
protocols or encryption implementations

58
00:02:39,530 --> 00:02:41,310
or main board pin layouts.

59
00:02:41,310 --> 00:02:44,160
It's really difficult to
find anything about that.

60
00:02:44,160 --> 00:02:46,690
This is a document I found from 2002,

61
00:02:46,690 --> 00:02:48,650
discussing the Triton com protocol.

62
00:02:48,650 --> 00:02:50,770
It's a preliminary
release and it's missing

63
00:02:50,770 --> 00:02:52,413
a lot of current info.

64
00:02:53,420 --> 00:02:55,700
I also believe that if honestly,
researchers continue to

65
00:02:55,700 --> 00:02:58,640
expose vulnerabilities in these devices,

66
00:02:58,640 --> 00:03:01,730
the increased awareness can
only serve to encourage the

67
00:03:01,730 --> 00:03:05,410
manufacturers of these devices
to make them more secure,

68
00:03:05,410 --> 00:03:07,673
which makes all of us
safer in the long run.

69
00:03:08,960 --> 00:03:11,430
The last reason I'm interested
in this kind of research,

70
00:03:11,430 --> 00:03:13,250
is really all of these folks.

71
00:03:13,250 --> 00:03:17,150
A huge shout out and thank you
to these pioneers in the ATM

72
00:03:17,150 --> 00:03:20,310
and electronic lock research field.

73
00:03:20,310 --> 00:03:23,340
They paved the way to
establishing safe harbor

74
00:03:23,340 --> 00:03:25,290
for ATM vulnerability research.

75
00:03:25,290 --> 00:03:30,290
And I greatly appreciate and
have enjoyed all of their work.

76
00:03:30,584 --> 00:03:34,000
I highly recommend watching
these previous presentations

77
00:03:34,000 --> 00:03:36,560
if you want to learn more
about things like ATM history,

78
00:03:36,560 --> 00:03:39,400
network attacks, firmware
attacks, power analysis,

79
00:03:39,400 --> 00:03:42,460
and spike attacks and malware attacks.

80
00:03:42,460 --> 00:03:46,060
All of these previous
researchers are brilliant.

81
00:03:46,060 --> 00:03:51,060
And in my estimation, most
of it is probably beyond

82
00:03:51,790 --> 00:03:54,430
the capabilities of your average criminal.

83
00:03:54,430 --> 00:03:57,300
Today, we're going to look
at something a bit more

84
00:03:57,300 --> 00:04:00,950
on the physical side of attacks on ATM.

85
00:04:00,950 --> 00:04:05,950
So our agenda here is all
about how I acquired my ATM.

86
00:04:06,813 --> 00:04:10,410
We'll look at some damage,
some ways people damage

87
00:04:10,410 --> 00:04:14,490
these things trying to get the
money, some general ATM info,

88
00:04:14,490 --> 00:04:16,410
how I became a licensed operator

89
00:04:16,410 --> 00:04:19,570
and how that went in, and why I did that.

90
00:04:19,570 --> 00:04:23,080
We're also gonna be
picking the ATM case lock,

91
00:04:23,080 --> 00:04:25,610
resetting the ATM password and bypassing

92
00:04:25,610 --> 00:04:27,420
the electronic vault block.

93
00:04:27,420 --> 00:04:30,210
And then at the end, we'll
have some time for Q and A.

94
00:04:31,320 --> 00:04:33,000
All right, so what was my goal?

95
00:04:33,000 --> 00:04:37,040
It was a fully functioning ATM in my home,

96
00:04:37,040 --> 00:04:38,850
which I had complete access to.

97
00:04:38,850 --> 00:04:42,040
It'll process ATM transactions,
just like in the wild.

98
00:04:42,040 --> 00:04:45,060
And I want to research and understand

99
00:04:45,060 --> 00:04:48,100
the entire tax surface,
including the network traffic,

100
00:04:48,100 --> 00:04:51,900
the internal serial comms,
the data stored on the device,

101
00:04:51,900 --> 00:04:54,780
the vault and the cash dispensing unit.

102
00:04:54,780 --> 00:04:58,980
And so what I have here
behind me is that device.

103
00:04:58,980 --> 00:05:01,880
It came true, and I'm going
to tell you how that happened.

104
00:05:03,180 --> 00:05:04,450
These things are expensive, right?

105
00:05:04,450 --> 00:05:05,750
How did I get this thing?

106
00:05:05,750 --> 00:05:06,720
If you look on the internet,

107
00:05:06,720 --> 00:05:09,050
this thing, probably $4,000 new.

108
00:05:09,050 --> 00:05:11,440
Couple of grand, two, 3000 used.

109
00:05:11,440 --> 00:05:14,640
That's too much for me if
I'm gonna do some research.

110
00:05:14,640 --> 00:05:18,690
So things like Craigslist
and eBay are your friends.

111
00:05:18,690 --> 00:05:20,990
I'd been looking for
an ATM for a long time,

112
00:05:20,990 --> 00:05:22,467
when I found this one in 2018.

113
00:05:22,467 --> 00:05:26,520
The set, 100 bucks for
both seemed like a deal.

114
00:05:26,520 --> 00:05:28,840
I quickly started researching
how they worked and what was

115
00:05:28,840 --> 00:05:31,030
inside them and how to
duplicate the attacks,

116
00:05:31,030 --> 00:05:33,773
Barnaby Jack had done in 2010.

117
00:05:34,770 --> 00:05:36,100
One of the things I found right away,

118
00:05:36,100 --> 00:05:38,650
default locks on these
machines are garbage,

119
00:05:38,650 --> 00:05:41,640
commonly available locks and
easy to pick with a rake.

120
00:05:41,640 --> 00:05:44,800
Also among other issues, I
found that the audit logs

121
00:05:44,800 --> 00:05:46,750
in these ATM's contain
a wealth of information,

122
00:05:46,750 --> 00:05:50,390
including full debit card
numbers and names of previous

123
00:05:50,390 --> 00:05:55,100
users in clear text and dates
and amounts of transactions.

124
00:05:55,100 --> 00:05:57,403
That was sort of surprising to me.

125
00:05:58,430 --> 00:06:01,230
And so I got bored of these
things as time went by.

126
00:06:01,230 --> 00:06:03,640
I really was interested in
getting my hands on an ATM

127
00:06:03,640 --> 00:06:07,600
that ran some flavor of Windows,
'cause Windows fun to hack

128
00:06:07,600 --> 00:06:10,340
and lots of known vaults.

129
00:06:10,340 --> 00:06:14,180
This saved search had an
alert that was turned on.

130
00:06:14,180 --> 00:06:17,163
Any auction or ATMs for sale in Minnesota.

131
00:06:18,060 --> 00:06:19,270
Lo and behold, I got a hit.

132
00:06:19,270 --> 00:06:21,610
So here's this auction
in Cambridge, Minnesota,

133
00:06:21,610 --> 00:06:23,250
about an hour and a half north of me.

134
00:06:23,250 --> 00:06:26,270
And they were selling
everything in this restaurant

135
00:06:26,270 --> 00:06:27,563
and gas station.

136
00:06:28,400 --> 00:06:31,880
This ATM was up for bid, and
this is all the details I got.

137
00:06:31,880 --> 00:06:33,370
If you've ever been on auctions like this,

138
00:06:33,370 --> 00:06:35,930
you know that there's a very
limited amount of information.

139
00:06:35,930 --> 00:06:38,290
I called the place and
inquired about the condition

140
00:06:38,290 --> 00:06:41,860
of the ATM asking, what does
unknown working condition mean?

141
00:06:41,860 --> 00:06:43,010
They had no idea.

142
00:06:43,010 --> 00:06:44,850
Everything is being sold as is.

143
00:06:44,850 --> 00:06:47,630
It's at foreclosure
auction, is all they said.

144
00:06:47,630 --> 00:06:51,020
I did ask if there was any money
in it, just kind of joking.

145
00:06:51,020 --> 00:06:52,640
The replies surprised me.

146
00:06:52,640 --> 00:06:54,140
There very well may be.

147
00:06:54,140 --> 00:06:56,360
This place got shut down
with food on the shelves,

148
00:06:56,360 --> 00:06:59,340
drinks in the coolers
and gas in the tanks.

149
00:06:59,340 --> 00:07:01,600
So at this point I have no idea.

150
00:07:01,600 --> 00:07:03,510
I think they're just trying
to get me to bid, right?

151
00:07:03,510 --> 00:07:05,120
Tell me whatever I want to hear.

152
00:07:05,120 --> 00:07:06,203
I bid a dollar.

153
00:07:07,250 --> 00:07:11,210
Now, I am quite competitive
when it comes to auctions

154
00:07:11,210 --> 00:07:12,840
and I don't like to lose.

155
00:07:12,840 --> 00:07:17,840
So of course I won with a bit
of a $220 at the last second.

156
00:07:18,990 --> 00:07:20,690
This is the first time I learned,

157
00:07:20,690 --> 00:07:22,250
this email, I learned that I won.

158
00:07:22,250 --> 00:07:24,920
I also learned there's
no code for the cash box.

159
00:07:24,920 --> 00:07:26,403
I assume they mean the vault.

160
00:07:28,100 --> 00:07:29,710
Well, what's going on here?

161
00:07:29,710 --> 00:07:30,543
I have no idea.

162
00:07:31,680 --> 00:07:32,830
What's this thing actually worth?

163
00:07:32,830 --> 00:07:33,930
Is it worth anything?

164
00:07:33,930 --> 00:07:35,250
Am I gonna be able to get into?

165
00:07:35,250 --> 00:07:36,540
Is it doesn't even work.

166
00:07:36,540 --> 00:07:37,490
Who knows?

167
00:07:37,490 --> 00:07:39,960
So I did a little digging and
found out that first of all,

168
00:07:39,960 --> 00:07:42,780
these machines are worth 10
times what I paid for them.

169
00:07:42,780 --> 00:07:47,780
It's a score, but maybe not
if I can't get into the vault

170
00:07:48,340 --> 00:07:50,200
and I can't get this thing working.

171
00:07:50,200 --> 00:07:52,190
Well, where did this thing come from?

172
00:07:52,190 --> 00:07:54,810
A gas station barbecue
sounded sort of interesting.

173
00:07:54,810 --> 00:07:58,860
Here's the place that was
auctioning off everything.

174
00:07:58,860 --> 00:08:03,090
It opened in 2018, February
1st, less than two years

175
00:08:03,090 --> 00:08:05,690
before I won this auction.

176
00:08:05,690 --> 00:08:07,400
Very strange.

177
00:08:07,400 --> 00:08:08,940
They're gonna have Dickey's Barbecue.

178
00:08:08,940 --> 00:08:10,750
If you've ever had it, it's fantastic.

179
00:08:10,750 --> 00:08:11,933
I highly recommend it.

180
00:08:13,330 --> 00:08:16,940
March 18, kind of a review of the place.

181
00:08:16,940 --> 00:08:19,790
But uh oh, just a little while later,

182
00:08:19,790 --> 00:08:23,320
assets 43K, liabilities 1.5 million.

183
00:08:23,320 --> 00:08:25,100
That's probably not
gonna work out long-term

184
00:08:25,100 --> 00:08:26,960
for any business owner.

185
00:08:26,960 --> 00:08:29,270
Things are starting to make sense here.

186
00:08:29,270 --> 00:08:31,970
So I hop in the car, hour
1/2 north to Cambridge,

187
00:08:31,970 --> 00:08:34,030
and this is what the place
looked like when I got there

188
00:08:34,030 --> 00:08:38,400
to pick up my ATM, a lot
different than opening day.

189
00:08:38,400 --> 00:08:41,260
I walk in and I'm at
check-in and I'm talking

190
00:08:41,260 --> 00:08:44,950
to the lady there, and I
say, what happened here?

191
00:08:44,950 --> 00:08:47,410
How did this place go
out of business so fast

192
00:08:47,410 --> 00:08:52,410
that you couldn't get the ATM
pin for the vault or the top?

193
00:08:53,550 --> 00:08:56,270
And she says, as I understand
it, there were some legal

194
00:08:56,270 --> 00:08:59,783
issues and the lender foreclosed
and shut the place down.

195
00:09:01,200 --> 00:09:02,180
Okay.

196
00:09:02,180 --> 00:09:03,330
I don't know anything about all that,

197
00:09:03,330 --> 00:09:05,610
but you know, that's what you say.

198
00:09:05,610 --> 00:09:07,510
So I go back over to the ATM.

199
00:09:07,510 --> 00:09:09,350
Let's get this thing going.

200
00:09:09,350 --> 00:09:12,030
Let's just get this thing in
the Jeep and get out of here.

201
00:09:12,030 --> 00:09:14,820
I was not anticipating that
it was going to be literally

202
00:09:14,820 --> 00:09:19,089
bolted to the floor and
completely immovable.

203
00:09:19,089 --> 00:09:19,922
Okay.

204
00:09:19,922 --> 00:09:23,100
So I can't get into the vault
to remove the nuts that are

205
00:09:23,100 --> 00:09:25,410
obviously holding this
thing down to the floor.

206
00:09:25,410 --> 00:09:26,820
It's in cement.

207
00:09:26,820 --> 00:09:28,620
So I call a locksmith and I said,

208
00:09:28,620 --> 00:09:30,930
hey, I'm at this gas station.

209
00:09:30,930 --> 00:09:32,340
I won this auction.

210
00:09:32,340 --> 00:09:35,240
Could you please come over and
help me break into this ATM

211
00:09:36,170 --> 00:09:37,263
to help me move it?

212
00:09:38,380 --> 00:09:41,560
The answer was a resounding no, no.

213
00:09:41,560 --> 00:09:44,900
So I asked the lady, how am I gonna get

214
00:09:44,900 --> 00:09:45,733
this thing out of here?

215
00:09:45,733 --> 00:09:47,740
What's gonna happen to this place?

216
00:09:47,740 --> 00:09:48,890
She said, I don't care.

217
00:09:48,890 --> 00:09:50,390
You gotta have that
thing outta here today.

218
00:09:50,390 --> 00:09:52,770
I don't care what you do to get it out.

219
00:09:52,770 --> 00:09:54,710
I said, what if I have
to damage the floor?

220
00:09:54,710 --> 00:09:55,543
No problem.

221
00:09:55,543 --> 00:09:57,870
They're going to bulldoze this
place at some point later.

222
00:09:57,870 --> 00:09:58,703
I don't care.

223
00:09:58,703 --> 00:10:00,600
I'm just here to auction stuff off.

224
00:10:00,600 --> 00:10:01,860
Okay.

225
00:10:01,860 --> 00:10:02,693
All right.

226
00:10:02,693 --> 00:10:05,180
Well, I want this thing on
damaged because I want to do

227
00:10:05,180 --> 00:10:08,430
research on it, and afterwards
I may want to use this thing

228
00:10:08,430 --> 00:10:11,890
and start a business, make
some money with an ATM.

229
00:10:11,890 --> 00:10:13,290
Who knows.

230
00:10:13,290 --> 00:10:16,120
So the only thing I can think
of is go down to Home Depot

231
00:10:16,120 --> 00:10:19,390
and rent this guy, the Bosch Brute Turbo.

232
00:10:19,390 --> 00:10:22,100
Up to this point, I'd never
used a jackhammer in my life,

233
00:10:22,100 --> 00:10:23,620
but how hard could it be, right?

234
00:10:23,620 --> 00:10:27,260
I've seen it done in cartoons. (chuckles)

235
00:10:27,260 --> 00:10:31,320
Well, so I start jackhammering
and hitting the ATM a couple

236
00:10:31,320 --> 00:10:34,390
of times there and jackhammering some more

237
00:10:34,390 --> 00:10:37,870
and I'm getting a little
further and jackhammering more.

238
00:10:37,870 --> 00:10:42,500
And it finally starts to come
out and lean a little bit.

239
00:10:42,500 --> 00:10:45,520
It finally did fall over and
I removed the concrete slab

240
00:10:45,520 --> 00:10:48,420
from the bottom, again,
with the jackhammer.

241
00:10:48,420 --> 00:10:51,740
For anyone wondering, it takes
a novice jackhammer user,

242
00:10:51,740 --> 00:10:55,550
roughly 40 minutes or so to get a ATM

243
00:10:55,550 --> 00:10:58,920
fully extracted from a cement floor.

244
00:10:58,920 --> 00:11:00,770
All right, here it is out on the curb.

245
00:11:00,770 --> 00:11:03,960
Into the Jeep it goes, and
magically now it's back

246
00:11:03,960 --> 00:11:07,310
that afternoon in my office.

247
00:11:07,310 --> 00:11:08,980
Mission accomplished.

248
00:11:08,980 --> 00:11:11,760
I plugged it in, booted it up and said,

249
00:11:11,760 --> 00:11:14,960
I'm staring at this thing
like, okay, so now what?

250
00:11:14,960 --> 00:11:17,350
What do I have to do to make
this thing fully operational?

251
00:11:17,350 --> 00:11:19,120
I want to stick my card in this thing

252
00:11:19,120 --> 00:11:20,910
and have it give me money.

253
00:11:20,910 --> 00:11:22,220
I have no idea.

254
00:11:22,220 --> 00:11:23,320
I have no idea what to do.

255
00:11:23,320 --> 00:11:25,070
Time to research.

256
00:11:25,070 --> 00:11:26,650
First thing I noticed
when I put this thing up

257
00:11:26,650 --> 00:11:28,490
is it's running Windows CE.

258
00:11:28,490 --> 00:11:29,930
That's pretty interesting to me.

259
00:11:29,930 --> 00:11:31,200
What could possibly go wrong?

260
00:11:31,200 --> 00:11:33,610
I was looking for a Windows box.

261
00:11:33,610 --> 00:11:36,380
So the next thing I do is
hook it up to my local LAN

262
00:11:36,380 --> 00:11:38,810
and run an Nmap scan.

263
00:11:38,810 --> 00:11:41,770
Now, you'll see on the
left here that I posted

264
00:11:41,770 --> 00:11:44,480
the Nmap scan, that Trey and Brenda So,

265
00:11:44,480 --> 00:11:48,733
Brenda did last year of Trey Gowden.

266
00:11:50,830 --> 00:11:55,130
Keown, sorry, and Brenda
So at last year's DEFCON.

267
00:11:55,130 --> 00:11:57,780
So they had a lot of open
ports on this exact same model.

268
00:11:57,780 --> 00:12:02,470
I only had 5555 open, which
I learned from their talk

269
00:12:02,470 --> 00:12:04,770
is the remote management agent.

270
00:12:04,770 --> 00:12:07,250
I did install the remote
management software

271
00:12:07,250 --> 00:12:11,360
and connect to it, but
I did not do any sort of

272
00:12:11,360 --> 00:12:13,750
penetration testing
against that end point.

273
00:12:13,750 --> 00:12:17,200
It was very intriguing and
very attractive to do that,

274
00:12:17,200 --> 00:12:20,313
but it was not the focus
of my research at the time.

275
00:12:21,310 --> 00:12:24,280
Trey and Brenda also
demonstrated an overflow attack

276
00:12:24,280 --> 00:12:28,070
against this port that allowed
modification of settings

277
00:12:28,070 --> 00:12:28,993
within the ATM.

278
00:12:29,870 --> 00:12:31,480
I would love to learn more about that

279
00:12:31,480 --> 00:12:33,470
and try that attack here.

280
00:12:33,470 --> 00:12:37,530
Okay, so here is the screen
when I boot up the machine,

281
00:12:37,530 --> 00:12:38,510
when I first boot it up.

282
00:12:38,510 --> 00:12:40,590
Apologies for the terrible photo.

283
00:12:40,590 --> 00:12:42,470
After booting, I get this thing.

284
00:12:42,470 --> 00:12:44,680
It says the encrypted
pin pad has gone bad.

285
00:12:44,680 --> 00:12:46,520
I have no idea what that means.

286
00:12:46,520 --> 00:12:48,670
It needs to be replaced, I learned.

287
00:12:48,670 --> 00:12:52,370
Error is codes 97999 EPP Error.

288
00:12:52,370 --> 00:12:54,333
Alright, what's this going to cost me?

289
00:12:55,800 --> 00:12:59,250
So 320 bucks later, I've
got a refurbished one

290
00:12:59,250 --> 00:13:02,260
and things are getting
a little bit expensive.

291
00:13:02,260 --> 00:13:06,630
And so at this point,
I've got to install an EPP

292
00:13:06,630 --> 00:13:09,490
in a machine that I've
never really taken apart

293
00:13:09,490 --> 00:13:14,490
or worked on, but at least I
know how to get into the top,

294
00:13:14,850 --> 00:13:16,563
which we'll see here shortly.

295
00:13:18,240 --> 00:13:20,350
First thing I needed to
do was a little research

296
00:13:20,350 --> 00:13:21,660
on the inside of this machine.

297
00:13:21,660 --> 00:13:24,510
And along the way, I kind
of put together this,

298
00:13:24,510 --> 00:13:27,630
a few slides about how ATMs work.

299
00:13:27,630 --> 00:13:28,920
So before we get too far,

300
00:13:28,920 --> 00:13:31,120
let's just take a couple of minutes here.

301
00:13:31,120 --> 00:13:33,420
So there's two main categories of ATM's,

302
00:13:33,420 --> 00:13:37,260
with the distinguishing factors
being the level of security

303
00:13:37,260 --> 00:13:40,940
the housing provides for the
electronics and the money.

304
00:13:40,940 --> 00:13:43,370
The banking features available
to users and the amount of

305
00:13:43,370 --> 00:13:46,960
money with in the machine itself.

306
00:13:46,960 --> 00:13:49,760
Drive up ATMs are typically
associated directly with banks

307
00:13:49,760 --> 00:13:52,300
and are mounted in an
external wall of a bank,

308
00:13:52,300 --> 00:13:54,850
especially built enclosure like this one,

309
00:13:54,850 --> 00:13:59,120
or as a standalone unit,
like out in a parking lot.

310
00:13:59,120 --> 00:14:00,890
There's really no easy access to the money

311
00:14:00,890 --> 00:14:02,490
or the electronics and
the front of this machine.

312
00:14:02,490 --> 00:14:05,410
You really have to get into
the building or get, you know,

313
00:14:05,410 --> 00:14:06,960
into the back somehow.

314
00:14:06,960 --> 00:14:09,390
A stealthy, undetectable,
access takes time, knowledge,

315
00:14:09,390 --> 00:14:13,080
and skill or granted
access as an employee.

316
00:14:13,080 --> 00:14:15,050
The second type of ATM is
the one you're probably most

317
00:14:15,050 --> 00:14:18,270
familiar with, and it's the
type I bought for my research.

318
00:14:18,270 --> 00:14:21,190
These are much less expensive
and there's far less security

319
00:14:21,190 --> 00:14:23,880
built into them because they're
designed to be installed

320
00:14:23,880 --> 00:14:26,150
where people are present and are working,

321
00:14:26,150 --> 00:14:28,040
like gas stations and such.

322
00:14:28,040 --> 00:14:29,790
They usually are not directly associated

323
00:14:29,790 --> 00:14:32,590
with any sort of bank, but
they're owner operated.

324
00:14:32,590 --> 00:14:36,093
So the gas station owner probably
owns that machine as well.

325
00:14:36,940 --> 00:14:39,460
It changes the threat model
a little bit here because

326
00:14:39,460 --> 00:14:42,840
there's much less oversight
to detect modifications

327
00:14:42,840 --> 00:14:45,230
to the ATM software housing
or network connection.

328
00:14:45,230 --> 00:14:48,940
If this thing is
installed in a hotel lobby

329
00:14:48,940 --> 00:14:52,980
or a big long hallway at
a hotel conference center

330
00:14:52,980 --> 00:14:55,290
or somewhere, you know, a bowling
alley, maybe where there's

331
00:14:55,290 --> 00:14:56,923
not a lot of supervision.

332
00:14:58,770 --> 00:15:00,710
As we've seen, these things can be bolted

333
00:15:00,710 --> 00:15:03,380
directly to the floor, but
many times they're not because

334
00:15:03,380 --> 00:15:06,360
it's a temporary use location
or it's going to be a limited

335
00:15:06,360 --> 00:15:08,600
time there or they move it around a lot,

336
00:15:08,600 --> 00:15:12,230
or for whatever reason, maybe
they just can't do that.

337
00:15:12,230 --> 00:15:14,570
They can't bolt it to the floor.

338
00:15:14,570 --> 00:15:17,570
People trying to get access to
the money in these machines,

339
00:15:17,570 --> 00:15:22,510
do a lot of damage, typically
with various devices

340
00:15:22,510 --> 00:15:27,210
like blow torches, crowbars.

341
00:15:27,210 --> 00:15:30,266
This is actually the
same machine I bought.

342
00:15:30,266 --> 00:15:32,583
And this one, this Triton 9100 looks like,

343
00:15:34,160 --> 00:15:35,890
somebody used some sort of a cutting tool.

344
00:15:35,890 --> 00:15:39,130
I'm not sure why they chose that spot.

345
00:15:39,130 --> 00:15:41,100
You can't actually get to the money

346
00:15:41,100 --> 00:15:43,030
going through the side there.

347
00:15:43,030 --> 00:15:46,410
So they were probably very
disappointed or caused more

348
00:15:46,410 --> 00:15:49,453
damage to the CDU unit in there.

349
00:15:50,520 --> 00:15:52,560
So during my research,
I see all this damage

350
00:15:52,560 --> 00:15:55,290
and I'm thinking, is this
really what it takes to get into

351
00:15:55,290 --> 00:15:56,323
one of these things?

352
00:15:57,600 --> 00:16:00,780
Can you do it any other way,
and can you do it in a way

353
00:16:00,780 --> 00:16:03,140
that doesn't leave obvious evidence?

354
00:16:03,140 --> 00:16:05,850
Maybe the answer is no.

355
00:16:05,850 --> 00:16:06,683
I don't know.

356
00:16:08,910 --> 00:16:12,040
So this one's my personal favorite

357
00:16:12,040 --> 00:16:14,400
because I like 4th of July.

358
00:16:14,400 --> 00:16:17,200
And so, anytime you go with
explosives, I'm gonna watch.

359
00:16:18,140 --> 00:16:20,770
I'm not attracting any
attention here for sure.

360
00:16:20,770 --> 00:16:25,400
So here we stick the
incendiary device in the output

361
00:16:25,400 --> 00:16:28,773
of where the cash comes out,
which is an interesting choice.

362
00:16:30,000 --> 00:16:33,720
And it just basically
destroys the entire top,

363
00:16:33,720 --> 00:16:37,580
but the cash box remains intact.

364
00:16:37,580 --> 00:16:42,213
So that is not a good way
to try and get into an ATM.

365
00:16:44,442 --> 00:16:45,620
I would be really surprised if anyone here

366
00:16:45,620 --> 00:16:46,570
has never used an ATM.

367
00:16:46,570 --> 00:16:49,100
So I'm sure you're all familiar
with these external parts

368
00:16:49,100 --> 00:16:49,970
that I've highlighted here.

369
00:16:49,970 --> 00:16:51,990
We're gonna go past this.

370
00:16:51,990 --> 00:16:54,910
All of the ATM's that you'll
see essentially have the same

371
00:16:54,910 --> 00:16:57,960
internal parts and external parts.

372
00:16:57,960 --> 00:17:01,270
One thing you can see
here is the false door,

373
00:17:01,270 --> 00:17:03,120
the safe door cover.

374
00:17:03,120 --> 00:17:05,340
That is protected by a cylinder lock,

375
00:17:05,340 --> 00:17:08,700
which is typically keyed
the same as the lock

376
00:17:08,700 --> 00:17:10,870
that protects the electronics.

377
00:17:10,870 --> 00:17:13,070
Behind that false door is the electronic

378
00:17:13,070 --> 00:17:15,860
lock key pad and the lock bolt handle.

379
00:17:15,860 --> 00:17:17,580
And you can see a wire
coming out of the door here.

380
00:17:17,580 --> 00:17:20,270
That's a power cable for the
light over the cash dispensing

381
00:17:20,270 --> 00:17:22,903
portal on the vault's door.

382
00:17:23,740 --> 00:17:27,110
All right, so let's take
a look inside the vault.

383
00:17:27,110 --> 00:17:32,070
Here, we can see the door
where the money comes out,

384
00:17:32,070 --> 00:17:33,800
and dust below that.

385
00:17:33,800 --> 00:17:37,750
We can see the bolt action
lever that lifts these huge

386
00:17:37,750 --> 00:17:40,550
teeth that interlock
with the frame to keep

387
00:17:40,550 --> 00:17:41,890
the safe door shut.

388
00:17:41,890 --> 00:17:44,100
The safe door, by the
way is about 70 pounds.

389
00:17:44,100 --> 00:17:47,120
It weighs more than anything
else on the machine.

390
00:17:47,120 --> 00:17:51,350
There's a look at the electric
lock inside and there is

391
00:17:51,350 --> 00:17:54,080
what's called the cash dispensing unit.

392
00:17:54,080 --> 00:17:58,210
Mounted on the cash dispensing
unit is also a reject bin.

393
00:17:58,210 --> 00:18:00,600
And then there is the cash cassette,

394
00:18:00,600 --> 00:18:05,600
which plugs basically into a
slot underneath the reject bin.

395
00:18:06,370 --> 00:18:07,400
So we're going to take a look,

396
00:18:07,400 --> 00:18:09,910
a closer look at all of
these different things.

397
00:18:09,910 --> 00:18:13,760
Inside here, you can see the
belt-driven device that brings

398
00:18:13,760 --> 00:18:18,740
the money up and out of
the cash dispensing unit.

399
00:18:18,740 --> 00:18:19,573
All right.

400
00:18:19,573 --> 00:18:21,210
So the next thing we're
going to look at here

401
00:18:21,210 --> 00:18:23,640
is the reject bin.

402
00:18:23,640 --> 00:18:25,700
Not very exciting, but
I thought you guys might

403
00:18:25,700 --> 00:18:27,220
just like to look in there.

404
00:18:27,220 --> 00:18:29,560
This is where, you know,
crumpled money goes,

405
00:18:29,560 --> 00:18:32,730
things that can't go through the CDU.

406
00:18:32,730 --> 00:18:34,230
Oh, this is the back of the CDU.

407
00:18:34,230 --> 00:18:37,320
You can see the serial interface
that goes up to the main

408
00:18:37,320 --> 00:18:40,500
board and also the power
supply, which also goes up

409
00:18:40,500 --> 00:18:43,740
to the power supply in
the main compartment.

410
00:18:43,740 --> 00:18:46,050
This here is the cash cassette.

411
00:18:46,050 --> 00:18:50,135
It also is locked with a
tubular key to the lock.

412
00:18:50,135 --> 00:18:55,135
And inside, we can see the
pressure driven dispenser.

413
00:18:56,630 --> 00:18:58,090
It's spring loaded.

414
00:18:58,090 --> 00:18:59,450
You can see a few bills in there.

415
00:18:59,450 --> 00:19:03,870
This is where a 1000 bills
can fit, if you so desire.

416
00:19:03,870 --> 00:19:06,900
Now this same machine that I
have, even though it right now

417
00:19:06,900 --> 00:19:08,410
is configured with one cassette,

418
00:19:08,410 --> 00:19:12,070
it can be configured with three cassettes.

419
00:19:12,070 --> 00:19:14,730
So, the module just plugs right in.

420
00:19:14,730 --> 00:19:16,670
It's really not a big deal.

421
00:19:16,670 --> 00:19:20,270
Giving this machine a
cash capacity of $300,000

422
00:19:20,270 --> 00:19:23,530
because each cassette can be
configured to hold hundreds.

423
00:19:23,530 --> 00:19:25,350
So as we're going to see, you know,

424
00:19:25,350 --> 00:19:28,220
you make the call at the
end of this presentation,

425
00:19:28,220 --> 00:19:31,230
do you think that the locks
and everything that are

426
00:19:31,230 --> 00:19:34,190
protecting 300,000, you
know, potentially $300,000,

427
00:19:34,190 --> 00:19:37,360
do you think they're adequate or not?

428
00:19:37,360 --> 00:19:40,750
Moving onto the top of the
device, this lock is like I said,

429
00:19:40,750 --> 00:19:43,040
usually keyed the same as the front

430
00:19:43,040 --> 00:19:45,430
and as mentioned can be picked.

431
00:19:45,430 --> 00:19:49,260
I'm showing you there that
the lock is indeed locked

432
00:19:49,260 --> 00:19:52,690
and I'm showing you there
a cylinder lock pick.

433
00:19:52,690 --> 00:19:55,490
So these, these cylinder locks
have seven or eight pins.

434
00:19:55,490 --> 00:19:58,010
This one's particularly has eight pins.

435
00:19:58,010 --> 00:20:02,250
So I insert the pick and I start
jiggling it back and forth,

436
00:20:02,250 --> 00:20:06,000
which moves the pics up
into the right position,

437
00:20:06,000 --> 00:20:08,650
which moves the pins
into the right position

438
00:20:08,650 --> 00:20:10,580
and unlocks the lock.

439
00:20:10,580 --> 00:20:12,933
So it didn't take very long at all.

440
00:20:13,990 --> 00:20:16,650
You could also just buy this key on eBay.

441
00:20:16,650 --> 00:20:21,460
So if you are lucky enough
to get your hands on an ATM,

442
00:20:21,460 --> 00:20:24,040
like I did for cheap, and
you don't have the key,

443
00:20:24,040 --> 00:20:24,873
here you go.

444
00:20:24,873 --> 00:20:25,706
Go buy a key.

445
00:20:26,760 --> 00:20:27,940
Okay.

446
00:20:27,940 --> 00:20:32,630
Now let's have a look
inside here, inside the top.

447
00:20:32,630 --> 00:20:34,180
Not many people get to look in here.

448
00:20:34,180 --> 00:20:36,040
I figured I'd give you
a look here as well.

449
00:20:36,040 --> 00:20:39,940
Here are all the wires
that go down to the CDU,

450
00:20:39,940 --> 00:20:43,750
and these come up and
there's the printer module.

451
00:20:43,750 --> 00:20:47,100
There's the power supply,
straight five-volt power supply,

452
00:20:47,100 --> 00:20:51,070
I believe, to the board and
12 volts everywhere else.

453
00:20:51,070 --> 00:20:52,980
Here is the receipt printer.

454
00:20:52,980 --> 00:20:55,360
It has its own board
and a serial connection

455
00:20:55,360 --> 00:20:57,090
and power cables there.

456
00:20:57,090 --> 00:21:00,160
All of these cables come
up through a junction,

457
00:21:00,160 --> 00:21:02,340
right at the base of the main unit,

458
00:21:02,340 --> 00:21:04,470
and there we see the main board.

459
00:21:04,470 --> 00:21:06,510
The main board here has an SD card,

460
00:21:06,510 --> 00:21:09,170
a lot of DIP switches that change modes

461
00:21:09,170 --> 00:21:11,040
and do various things.

462
00:21:11,040 --> 00:21:14,870
And we see any HDMI cable connector

463
00:21:14,870 --> 00:21:16,680
and a couple of USB ports.

464
00:21:16,680 --> 00:21:18,490
And then over here on the other side,

465
00:21:18,490 --> 00:21:22,320
we will see all of the different
serial ports that drive

466
00:21:22,320 --> 00:21:25,570
the different pieces and
parts of the ATM itself.

467
00:21:25,570 --> 00:21:27,130
There's the ethernet cable.

468
00:21:27,130 --> 00:21:29,560
There's the modem and the printer port.

469
00:21:29,560 --> 00:21:33,560
And down here, we have the card reader.

470
00:21:33,560 --> 00:21:35,800
That's where all the money
comes out and right below there

471
00:21:35,800 --> 00:21:39,050
is the electronic, the encrypting pin pad,

472
00:21:39,050 --> 00:21:41,980
the EPP that I replaced.

473
00:21:41,980 --> 00:21:44,190
All right, wonderful.

474
00:21:44,190 --> 00:21:49,190
So we see the inside and I
mentioned the ethernet port.

475
00:21:49,210 --> 00:21:51,660
So this thing is obviously
talking to the internet

476
00:21:51,660 --> 00:21:54,560
and it's obviously somehow
doing transactions.

477
00:21:54,560 --> 00:21:55,580
So how does that work?

478
00:21:55,580 --> 00:21:59,570
Well, whether it's through a
modem or it's through a NIC

479
00:21:59,570 --> 00:22:03,100
or something, we get an
internet connection to the PPH,

480
00:22:03,100 --> 00:22:06,400
the payment processing
host using something called

481
00:22:06,400 --> 00:22:07,930
the Triton Protocol.

482
00:22:07,930 --> 00:22:12,010
And then from there, we're
going to go to what's called

483
00:22:12,010 --> 00:22:13,170
the interbank network.

484
00:22:13,170 --> 00:22:14,063
So what is that?

485
00:22:15,210 --> 00:22:18,320
First of all, the processing
host provides the connection

486
00:22:18,320 --> 00:22:20,850
information and encryption
keys, which are configured

487
00:22:20,850 --> 00:22:22,860
in the ATM computer.

488
00:22:22,860 --> 00:22:26,110
They take a small percentage,
the processor does

489
00:22:26,110 --> 00:22:28,540
of the transaction fee, which you know,

490
00:22:28,540 --> 00:22:30,640
is determined by the owner and charged

491
00:22:30,640 --> 00:22:33,490
to the user for each transaction.

492
00:22:33,490 --> 00:22:36,530
There's hundreds of processing
companies to pick from.

493
00:22:36,530 --> 00:22:39,220
I just threw up a few brands here.

494
00:22:39,220 --> 00:22:40,370
An interbank network.

495
00:22:40,370 --> 00:22:43,590
The next step is also
known as the ATM consortium

496
00:22:43,590 --> 00:22:44,650
or the ATM network.

497
00:22:44,650 --> 00:22:48,000
And it's a computer network
that enables ATM cards

498
00:22:48,000 --> 00:22:51,280
that are issued by a financial
institution that is a member

499
00:22:51,280 --> 00:22:56,280
of the network to be used in
ATM's that belong to another

500
00:22:58,230 --> 00:23:01,093
member of that same ATM consortium.

501
00:23:02,050 --> 00:23:06,680
And so the way that the banking
industry came up in America,

502
00:23:06,680 --> 00:23:07,810
was very fragmented.

503
00:23:07,810 --> 00:23:09,550
So there was a lot of
little mom and pop shops

504
00:23:09,550 --> 00:23:12,000
and a lot of little networks everywhere.

505
00:23:12,000 --> 00:23:14,937
In the 2000s, of like 2003,

506
00:23:14,937 --> 00:23:19,700
by then we had a consolidation resulting

507
00:23:19,700 --> 00:23:21,540
in three major interbank networks.

508
00:23:21,540 --> 00:23:25,270
And now about 70% of the
volume in the United States

509
00:23:25,270 --> 00:23:26,820
goes over those three networks.

510
00:23:27,860 --> 00:23:30,940
Past talks on ATM hacking have
discussed building a dummy

511
00:23:30,940 --> 00:23:34,320
backend for the ATM network
for the ATM to connect to,

512
00:23:34,320 --> 00:23:37,440
that would pretend to be
the payment processing host.

513
00:23:37,440 --> 00:23:40,140
But I really wanted to see
what the real thing was like.

514
00:23:40,140 --> 00:23:44,103
So to do this, I had to become
a licensed ATM operator.

515
00:23:45,090 --> 00:23:46,710
So why did I do that?

516
00:23:46,710 --> 00:23:50,490
Well, I really want the
full, real experience.

517
00:23:50,490 --> 00:23:53,920
I want to understand
exactly what does it take

518
00:23:53,920 --> 00:23:58,600
to take an ATM to full
functioning and operate it

519
00:23:58,600 --> 00:23:59,433
after the fact.

520
00:23:59,433 --> 00:24:02,760
After my research has done, I
want to put this thing in use.

521
00:24:02,760 --> 00:24:04,420
Minnesota is about to legalize weed,

522
00:24:04,420 --> 00:24:06,770
so maybe I'll put it at a dispensary.

523
00:24:06,770 --> 00:24:07,603
I don't know.

524
00:24:08,470 --> 00:24:10,330
So why do I have to be licensed?

525
00:24:10,330 --> 00:24:15,050
Well, the primary reason these
laws exist in these licenses

526
00:24:15,050 --> 00:24:17,910
exists is to prevent money
laundering and funding

527
00:24:17,910 --> 00:24:20,060
of nefarious activities.

528
00:24:20,060 --> 00:24:23,810
This is really tied to
the Patriot Act of 2001.

529
00:24:23,810 --> 00:24:27,373
So you can imagine what I
mean by nefarious activities.

530
00:24:28,610 --> 00:24:30,570
The licensing is done through NMLS

531
00:24:30,570 --> 00:24:33,383
or the National Multistate
Licensing System.

532
00:24:34,700 --> 00:24:37,520
I provide, you know,
processor information.

533
00:24:37,520 --> 00:24:38,990
There's a background check.

534
00:24:38,990 --> 00:24:40,930
I have to fill out a bunch of paperwork.

535
00:24:40,930 --> 00:24:43,300
I have to show them my bank statements

536
00:24:43,300 --> 00:24:45,730
and let my bank know what I'm doing.

537
00:24:45,730 --> 00:24:49,250
I have to pay a couple hundred
and license fees and it takes

538
00:24:49,250 --> 00:24:52,550
about four weeks or so, and
you're gonna do something wrong

539
00:24:52,550 --> 00:24:56,210
because no matter what you
do, you're gonna do it wrong

540
00:24:56,210 --> 00:24:57,650
and fill out the paperwork
wrong, and you're gonna to have

541
00:24:57,650 --> 00:25:00,770
to do it back and forth a
few times and sit on hold

542
00:25:00,770 --> 00:25:03,280
with the state and whatever,
but sooner or later,

543
00:25:03,280 --> 00:25:08,100
you will become a licensed
financial terminal owner.

544
00:25:08,100 --> 00:25:10,400
All right, so I've got
this thing on the network.

545
00:25:10,400 --> 00:25:11,320
I have my license.

546
00:25:11,320 --> 00:25:14,710
I can connect to the ATM
network, the real thing.

547
00:25:14,710 --> 00:25:15,590
How am I going to do that?

548
00:25:15,590 --> 00:25:17,980
Well, I'm going to use a LAN tap

549
00:25:17,980 --> 00:25:21,190
because I want to do
this very transparently.

550
00:25:21,190 --> 00:25:26,053
And not in any way that somebody
can know what I'm doing.

551
00:25:27,060 --> 00:25:29,870
There's no opportunity for
traffic manipulation here.

552
00:25:29,870 --> 00:25:33,680
It's really just sniffing, and
I'm sniffing my own traffic.

553
00:25:33,680 --> 00:25:37,890
So as I run my own
transactions with my own card,

554
00:25:37,890 --> 00:25:39,483
I can see what's happening.

555
00:25:40,730 --> 00:25:43,070
Now, the way a land tap works
is there's a pass-through

556
00:25:43,070 --> 00:25:45,870
that goes directly
through and is transparent

557
00:25:45,870 --> 00:25:49,790
to the server and the client.

558
00:25:49,790 --> 00:25:51,580
These other two ports that you can see

559
00:25:51,580 --> 00:25:53,080
are outbound from the ATM.

560
00:25:53,080 --> 00:25:55,340
So outbound traffic,
which goes to my laptop

561
00:25:55,340 --> 00:25:58,190
and then inbound traffic
coming inbound to the ATM,

562
00:25:58,190 --> 00:26:00,720
also goes to my laptop.

563
00:26:00,720 --> 00:26:04,320
And so if I spin up
Wireshark and attach to both

564
00:26:04,320 --> 00:26:08,890
of those ethernet devices,
I can see both way traffic.

565
00:26:08,890 --> 00:26:12,610
The problem is, it's
encrypted with TLS 1.2.

566
00:26:12,610 --> 00:26:17,610
But the ATM provides you a
way to upload your own signing

567
00:26:17,930 --> 00:26:20,940
certificate, which I
found very interesting.

568
00:26:20,940 --> 00:26:25,630
If you put a self-signed cert
on a USB and stick it into

569
00:26:25,630 --> 00:26:28,930
the back where we saw before,
and you go to this screen,

570
00:26:28,930 --> 00:26:30,950
it says, download cert from USB.

571
00:26:30,950 --> 00:26:35,450
So I'm not really sure
how that all makes sense,

572
00:26:35,450 --> 00:26:37,290
but it's there.

573
00:26:37,290 --> 00:26:38,123
All right.

574
00:26:39,110 --> 00:26:40,960
So we've taken a little
look at the inside.

575
00:26:40,960 --> 00:26:42,810
We've taken a look at the network.

576
00:26:42,810 --> 00:26:46,810
With EPP replaced, I can
now successfully boot

577
00:26:46,810 --> 00:26:49,180
the ATM and insert some data.

578
00:26:49,180 --> 00:26:50,540
One side note here.

579
00:26:50,540 --> 00:26:53,210
Anytime I see a big red
thing that says warning,

580
00:26:53,210 --> 00:26:55,820
and then do not, you know, do something.

581
00:26:55,820 --> 00:26:59,880
I always pay special attention to that.

582
00:26:59,880 --> 00:27:02,221
I like to do things that
I'm not supposed to do.

583
00:27:02,221 --> 00:27:04,720
So this one says, don't remove the cover.

584
00:27:04,720 --> 00:27:06,230
Bad things will happen.

585
00:27:06,230 --> 00:27:08,270
At some point, I'm gonna
go look exactly into

586
00:27:08,270 --> 00:27:11,860
what that bad stuff is and
see how this is implemented.

587
00:27:11,860 --> 00:27:14,500
It sounds like a really
interesting research project.

588
00:27:14,500 --> 00:27:15,920
So anyway, booting this time,

589
00:27:15,920 --> 00:27:19,260
I get this great error
message says, FFFFFF.

590
00:27:19,260 --> 00:27:23,770
That means that I need to
to provide some more set up

591
00:27:23,770 --> 00:27:26,273
information into the machine.

592
00:27:28,070 --> 00:27:28,940
All right.

593
00:27:28,940 --> 00:27:30,883
So to access the admin screen,

594
00:27:31,750 --> 00:27:34,690
I'll do enter, clear,
cancel, one, two, three.

595
00:27:34,690 --> 00:27:35,820
All right.

596
00:27:35,820 --> 00:27:40,820
And so this gives me this
nice enter password UI, right?

597
00:27:43,450 --> 00:27:45,693
But I don't know the password.

598
00:27:46,540 --> 00:27:49,599
This is the pin I need to
get to the admin interface.

599
00:27:49,599 --> 00:27:52,560
I tried multiple times to
reach anyone associated

600
00:27:52,560 --> 00:27:54,240
with the previous owner.

601
00:27:54,240 --> 00:27:55,840
Still no luck.

602
00:27:55,840 --> 00:27:57,610
So I have no idea.

603
00:27:57,610 --> 00:28:00,830
The pin is stored in memory
somewhere on that board.

604
00:28:00,830 --> 00:28:02,420
I have no idea how to get to it.

605
00:28:02,420 --> 00:28:03,970
I don't know if it's encrypted.

606
00:28:04,910 --> 00:28:07,310
It's good to note that
this password is different

607
00:28:07,310 --> 00:28:09,620
than the safe combination.

608
00:28:09,620 --> 00:28:14,320
The safe vault lock does
not have any idea that this

609
00:28:14,320 --> 00:28:16,670
interface or this computer even exists.

610
00:28:16,670 --> 00:28:18,570
They're completely separate.

611
00:28:18,570 --> 00:28:21,470
This is just to get access to
the admin operator interface.

612
00:28:21,470 --> 00:28:24,240
The default password here is 555555.

613
00:28:24,240 --> 00:28:27,310
I know that because it's
in their documentation,

614
00:28:27,310 --> 00:28:30,270
but unfortunately for
me, that didn't work.

615
00:28:30,270 --> 00:28:33,600
I tried and I tried and I
tried, and I was up very late.

616
00:28:33,600 --> 00:28:35,090
The UI does give you three chances

617
00:28:35,090 --> 00:28:37,080
to enter the correct password,
but then it'll send you back

618
00:28:37,080 --> 00:28:39,220
to the start screen again,
and then you have to do

619
00:28:39,220 --> 00:28:41,460
enter, clear, cancel, one, two, three.

620
00:28:41,460 --> 00:28:44,710
After a few days of guessing
and falling asleep in my chair,

621
00:28:44,710 --> 00:28:48,933
after guessing I gave up
and looked for other ways.

622
00:28:49,924 --> 00:28:51,550
So it turns out after a lot
of Googling and reading,

623
00:28:51,550 --> 00:28:55,150
I found that in recent
versions of the software,

624
00:28:55,150 --> 00:28:57,430
Hyosung has implemented a security feature

625
00:28:57,430 --> 00:29:01,210
where the operator function
passwords cannot be reset

626
00:29:01,210 --> 00:29:03,890
to factory default unless
performed during the machines

627
00:29:03,890 --> 00:29:06,973
first boot after reloading the software.

628
00:29:07,890 --> 00:29:09,560
If there's any way around
this, I have no idea.

629
00:29:09,560 --> 00:29:10,920
I couldn't find it.

630
00:29:10,920 --> 00:29:12,480
The search continues.

631
00:29:12,480 --> 00:29:16,000
All right, so how does the
software re-install work?

632
00:29:16,000 --> 00:29:18,810
Well, various versions of
the ATM software available

633
00:29:18,810 --> 00:29:20,200
if you search around.

634
00:29:20,200 --> 00:29:22,460
I found this one and downloaded it.

635
00:29:22,460 --> 00:29:24,590
I would love to find some
older versions of this.

636
00:29:24,590 --> 00:29:26,610
If anybody knows where I can
get my hands on some older

637
00:29:26,610 --> 00:29:30,630
versions of the software
for the Triton 2700 CE,

638
00:29:30,630 --> 00:29:32,080
I would really appreciate it.

639
00:29:33,280 --> 00:29:37,730
This set that I found was, I
think the most recent version.

640
00:29:39,383 --> 00:29:41,163
And so I put it on an SD card.

641
00:29:42,210 --> 00:29:43,250
There's various files here.

642
00:29:43,250 --> 00:29:47,260
If you want to know what
they do, I think Brenda So

643
00:29:47,260 --> 00:29:50,200
talked about that in last year's talk.

644
00:29:50,200 --> 00:29:52,420
I did delve into the
update folder where I found

645
00:29:52,420 --> 00:29:56,150
a master zip file, and
opening that is super fun.

646
00:29:56,150 --> 00:29:58,430
There's lots of fun
stuff to play with here.

647
00:29:58,430 --> 00:30:02,370
I'm not sure if the bat files
or some of these other files,

648
00:30:02,370 --> 00:30:06,413
the icons and the backgrounds
have any sort of CRC

649
00:30:08,090 --> 00:30:10,390
associated with them, if
there's anything run on those,

650
00:30:10,390 --> 00:30:13,390
if you can modify those and
put them back on this disc

651
00:30:13,390 --> 00:30:16,380
and stick it in the machine
and have it do some fun stuff.

652
00:30:16,380 --> 00:30:20,350
That's a another research topic
altogether that I wish I had

653
00:30:20,350 --> 00:30:23,360
time for and we'll
probably do in the future.

654
00:30:23,360 --> 00:30:26,740
So my SD card goes in this slot.

655
00:30:26,740 --> 00:30:29,330
I have to push down
DIP switch number four,

656
00:30:29,330 --> 00:30:32,660
to make it boot into diagnostic mode.

657
00:30:32,660 --> 00:30:35,540
And this is where the computer
will do all kinds of fun

658
00:30:35,540 --> 00:30:37,483
stuff and read things off the SD card.

659
00:30:38,800 --> 00:30:42,890
So pick SD card, and now
we're doing a software update.

660
00:30:42,890 --> 00:30:44,300
This takes about 10 minutes or so.

661
00:30:44,300 --> 00:30:45,640
That's what this install looks like.

662
00:30:45,640 --> 00:30:48,880
And after you do that, it will reboot,

663
00:30:48,880 --> 00:30:51,550
and now you'll get the same screen,

664
00:30:51,550 --> 00:30:54,970
and we can reset the master password.

665
00:30:54,970 --> 00:30:57,050
All right, so here's how we do that.

666
00:30:57,050 --> 00:31:02,050
We reboot again, and during
the initializing screen,

667
00:31:02,150 --> 00:31:05,690
we get out our old Nintendo
fingers and do left, right,

668
00:31:05,690 --> 00:31:09,490
clear, left, right, clear,
clear, cancel clear, left, right,

669
00:31:09,490 --> 00:31:10,930
clear, clear, cancel.

670
00:31:10,930 --> 00:31:14,280
If successfully recognized,
the machine will ask you

671
00:31:14,280 --> 00:31:16,703
if you want to reset the master password.

672
00:31:17,600 --> 00:31:21,343
And then it will be set back to 555555.

673
00:31:22,480 --> 00:31:23,710
There's one caveat to this.

674
00:31:23,710 --> 00:31:26,313
It's not gonna happen unless
the safe door is open.

675
00:31:28,552 --> 00:31:30,710
If the safe door's not
open, you're just gonna

676
00:31:30,710 --> 00:31:31,570
get back to this screen.

677
00:31:31,570 --> 00:31:34,573
And so, at this point,
the safe door is not open,

678
00:31:36,040 --> 00:31:37,160
but I need to open it.

679
00:31:37,160 --> 00:31:39,380
I need to open it and to
complete the password reset

680
00:31:39,380 --> 00:31:42,130
for the computer, and I
need to get into it to see

681
00:31:42,130 --> 00:31:44,493
if there's any cash in there, right.

682
00:31:44,493 --> 00:31:47,190
I really don't want to destroy
the door in the process.

683
00:31:47,190 --> 00:31:48,850
I've already explained why.

684
00:31:48,850 --> 00:31:51,020
So the first question
that I have is, you know,

685
00:31:51,020 --> 00:31:54,350
how does this computer
know the door's closed?

686
00:31:54,350 --> 00:31:56,720
There must be a sensor somewhere in there

687
00:31:56,720 --> 00:31:59,723
connected to the door,
connected to the main board.

688
00:32:00,690 --> 00:32:02,710
I have access to the main board.

689
00:32:02,710 --> 00:32:03,740
I should be able to do this.

690
00:32:03,740 --> 00:32:07,530
So I reached for my favorite
tool, the borescope.

691
00:32:07,530 --> 00:32:09,930
This here is a DEPSTECH unit.

692
00:32:09,930 --> 00:32:14,050
Five megapixels, HD resolution,
the rechargeable battery,

693
00:32:14,050 --> 00:32:15,610
wireless connectivity, it's great.

694
00:32:15,610 --> 00:32:16,910
Wired is rigid.

695
00:32:16,910 --> 00:32:18,397
You can bend it around corners, you know,

696
00:32:18,397 --> 00:32:20,290
and it's 50 bucks on Amazon.

697
00:32:20,290 --> 00:32:22,000
How could you go wrong?

698
00:32:22,000 --> 00:32:27,000
As we'll see later in this
talk, I did use this other tool,

699
00:32:27,160 --> 00:32:29,980
this other smaller scope
called an otoscope.

700
00:32:29,980 --> 00:32:32,410
It's made to stick in your ear.

701
00:32:32,410 --> 00:32:34,810
This has a diameter of 5.5 millimeters,

702
00:32:34,810 --> 00:32:37,523
much smaller than the previous one.

703
00:32:38,660 --> 00:32:41,320
It's about 50 bucks for
this camera as well.

704
00:32:41,320 --> 00:32:45,430
So I got the scope inside
the ATM using the corners

705
00:32:45,430 --> 00:32:48,680
of the cash dispensing
tray, and also that hole

706
00:32:48,680 --> 00:32:52,633
where the wire came off
of the lining of the door.

707
00:32:53,542 --> 00:32:55,340
This is what I see inside.

708
00:32:55,340 --> 00:32:56,220
It's the reject bin.

709
00:32:56,220 --> 00:32:58,760
I can see the lock, the
electronic safe lock down there.

710
00:32:58,760 --> 00:33:01,823
I can also see some wires
over far down there.

711
00:33:02,700 --> 00:33:06,340
If I turn the borescope a
little bit, I can see a rigid.

712
00:33:06,340 --> 00:33:11,277
I can see the wire, or I
can see the safe switch,

713
00:33:13,079 --> 00:33:16,270
the momentary switch is
the word I was looking for.

714
00:33:16,270 --> 00:33:19,130
This momentary switch which
is connected to the door

715
00:33:19,130 --> 00:33:21,510
and the door is pushing it
in, and it's basically telling

716
00:33:21,510 --> 00:33:24,060
the computer the door is open or closed.

717
00:33:24,060 --> 00:33:28,360
Following this wire up away
from the momentary switch

718
00:33:28,360 --> 00:33:32,740
and across through some
portion of the ATM,

719
00:33:32,740 --> 00:33:35,890
it finally does surface through this hole,

720
00:33:35,890 --> 00:33:37,890
up to where the main board is.

721
00:33:37,890 --> 00:33:39,040
It comes over to this junction

722
00:33:39,040 --> 00:33:41,550
where it's conveniently labeled front.

723
00:33:41,550 --> 00:33:43,800
And then it goes on over to the board

724
00:33:43,800 --> 00:33:45,823
where it's labeled CN16.

725
00:33:47,470 --> 00:33:49,180
So if I unplugged this, the question is,

726
00:33:49,180 --> 00:33:51,253
does it fail open or closed?

727
00:33:52,140 --> 00:33:55,460
Well, let's do an experiment to find out.

728
00:33:55,460 --> 00:33:57,830
I recorded this demo after
I had the vault door open

729
00:33:57,830 --> 00:34:00,000
and the ATM was all
set up and operational.

730
00:34:00,000 --> 00:34:02,920
But the results are the same
because the door's closed now,

731
00:34:02,920 --> 00:34:06,750
and the ATM is operational
because of the door is closed.

732
00:34:06,750 --> 00:34:09,430
If I pull the door sensor plug,

733
00:34:09,430 --> 00:34:12,730
then the computer should think
that the door is open and it

734
00:34:12,730 --> 00:34:15,260
should become not operational.

735
00:34:15,260 --> 00:34:20,020
So what happens is, I pull
out the plug and it says,

736
00:34:20,020 --> 00:34:23,770
the door is open, the ATM is
temporarily out of service.

737
00:34:23,770 --> 00:34:25,440
But it's not, right?

738
00:34:25,440 --> 00:34:26,918
We just saw the doors closed,

739
00:34:26,918 --> 00:34:28,370
but this is exactly what
we needed in this case.

740
00:34:28,370 --> 00:34:31,000
So I pull out the plug, I reboot.

741
00:34:31,000 --> 00:34:33,340
And while initializing,
we do clear, left, right,

742
00:34:33,340 --> 00:34:35,290
clear, clear, cancel.

743
00:34:35,290 --> 00:34:38,593
And we get to this screen,
Reset Master Password.

744
00:34:39,540 --> 00:34:41,010
Reset master password.

745
00:34:41,010 --> 00:34:42,650
Click, yes.

746
00:34:42,650 --> 00:34:43,483
All right.

747
00:34:43,483 --> 00:34:44,480
It reboots one more time.

748
00:34:44,480 --> 00:34:47,748
I get here, I do 555555.

749
00:34:47,748 --> 00:34:52,748
And here I am as an administrator
inside the computer.

750
00:34:54,600 --> 00:34:55,433
All right.

751
00:34:55,433 --> 00:34:56,266
So at least one of you is wondering

752
00:34:56,266 --> 00:34:59,250
what was that QR code back there?

753
00:34:59,250 --> 00:35:00,530
Well, it's nothing.

754
00:35:00,530 --> 00:35:01,800
I'm not sure why that's there.

755
00:35:01,800 --> 00:35:05,450
It does not seem to be
something that is alterable

756
00:35:05,450 --> 00:35:09,150
through the configuration
and it just leads to nothing.

757
00:35:09,150 --> 00:35:10,490
A Google search, I guess.

758
00:35:10,490 --> 00:35:11,460
I have no idea.

759
00:35:11,460 --> 00:35:13,920
Alright, so now the password's reset.

760
00:35:13,920 --> 00:35:14,980
I can get to the ATM.

761
00:35:14,980 --> 00:35:17,320
Inside, I can configure it as I wish,

762
00:35:17,320 --> 00:35:20,210
but we really need to get into
the safe to make this thing

763
00:35:20,210 --> 00:35:22,980
fully operational and, well,
see what's in there, right?

764
00:35:22,980 --> 00:35:24,530
So, how?

765
00:35:24,530 --> 00:35:25,590
Well, first things first.

766
00:35:25,590 --> 00:35:26,853
What lock is this thing?

767
00:35:27,940 --> 00:35:30,500
Back to the borescope for some recon.

768
00:35:30,500 --> 00:35:31,760
I can see the lock.

769
00:35:31,760 --> 00:35:34,570
I can see some writing on it.

770
00:35:34,570 --> 00:35:35,960
It turns out with a little Googling,

771
00:35:35,960 --> 00:35:40,080
I find that all the ATMs,
all of this particular type

772
00:35:40,080 --> 00:35:43,530
of ATM uses this LaGard
LG Basic Electronic Lock,

773
00:35:43,530 --> 00:35:45,130
and this is what it looks like.

774
00:35:45,130 --> 00:35:49,010
Now, in 2016 at DEFCON 24,
Plourde did a great talk about

775
00:35:49,010 --> 00:35:52,210
side channel attacks on this type of lock.

776
00:35:52,210 --> 00:35:54,760
He used the side channel
attacks to deduce the correct

777
00:35:54,760 --> 00:35:57,743
combination of this Sargent
& Greenleaf Titan PivotBolt,

778
00:35:58,780 --> 00:36:01,167
very similar to the lock that I have,

779
00:36:01,167 --> 00:36:03,773
the LaGard Basic, but
not exactly the same one.

780
00:36:04,890 --> 00:36:08,660
However, this YouTube
video by EEVBlog attempting

781
00:36:08,660 --> 00:36:12,150
the same attack on LaGard
lock, but without success.

782
00:36:12,150 --> 00:36:14,890
So I decided to come up with another way.

783
00:36:14,890 --> 00:36:17,770
To figure out how these
things work, I ordered one.

784
00:36:17,770 --> 00:36:21,980
And I also found out that
there's another option,

785
00:36:21,980 --> 00:36:24,460
which I assume works the same sort of way,

786
00:36:24,460 --> 00:36:26,730
along the same lines as Plourde's attack.

787
00:36:26,730 --> 00:36:28,640
This is called a Little Black Box,

788
00:36:28,640 --> 00:36:32,823
and this device as well
as this Phoenix device,

789
00:36:34,040 --> 00:36:37,140
they basically can reset the safe combo.

790
00:36:37,140 --> 00:36:41,387
So you take the cord
that goes into the safe

791
00:36:45,350 --> 00:36:48,610
from the key pad and you
hook it up to this device.

792
00:36:48,610 --> 00:36:52,730
It determines what lock
you have hooked up to,

793
00:36:52,730 --> 00:36:54,350
and then you click reset.

794
00:36:54,350 --> 00:36:57,680
And what it's gonna do now
is some sort of an attack

795
00:36:57,680 --> 00:37:00,410
against the lock itself.

796
00:37:00,410 --> 00:37:04,000
I believe it basically
guesses every combination

797
00:37:04,000 --> 00:37:06,450
in less than 15 minutes.

798
00:37:06,450 --> 00:37:09,500
And once it guesses the combination,

799
00:37:09,500 --> 00:37:11,100
I guess somehow it resets it.

800
00:37:11,100 --> 00:37:14,050
I really don't know how this thing works.

801
00:37:14,050 --> 00:37:16,640
You can only buy this if
you're law enforcement

802
00:37:16,640 --> 00:37:21,640
or if you own a bank or
are a licensed locksmith.

803
00:37:21,780 --> 00:37:25,470
So it costs about $3,000, and
I don't know that much money,

804
00:37:25,470 --> 00:37:27,133
so I need a another way.

805
00:37:28,169 --> 00:37:29,210
So I take off the cover.

806
00:37:29,210 --> 00:37:31,280
We see the circuit board.

807
00:37:31,280 --> 00:37:32,720
If you take the circuit board out,

808
00:37:32,720 --> 00:37:36,570
then you can see like the
lock mechanism with the bolt

809
00:37:36,570 --> 00:37:39,840
and the rotation axis of the bolt.

810
00:37:39,840 --> 00:37:42,930
The main volt handle
forces down and rotates

811
00:37:42,930 --> 00:37:45,000
it in a clockwise direction.

812
00:37:45,000 --> 00:37:47,570
There is an anti force mechanism here.

813
00:37:47,570 --> 00:37:49,870
There's a spring and a notch on the lock.

814
00:37:49,870 --> 00:37:52,242
And the bolt, if you push down too hard,

815
00:37:52,242 --> 00:37:56,133
that notch basically engages
and you can't push anymore.

816
00:37:57,120 --> 00:38:01,960
If we are able to rotate
that lock fully clockwise,

817
00:38:01,960 --> 00:38:06,960
then it will push that secondary
bolt over into the notch,

818
00:38:06,970 --> 00:38:08,220
into that linchpin.

819
00:38:08,220 --> 00:38:10,630
Now that linchpin will stop
the secondary bolt from going

820
00:38:10,630 --> 00:38:14,040
over there, unless we
type in the correct code,

821
00:38:14,040 --> 00:38:19,040
which then provides a nine
volt DC charge to the little

822
00:38:19,510 --> 00:38:21,840
motor attached to the linchpin.

823
00:38:21,840 --> 00:38:24,360
The motor runs, the linchpin is moved

824
00:38:24,360 --> 00:38:25,450
and we can open the lock.

825
00:38:25,450 --> 00:38:26,283
All right.

826
00:38:26,283 --> 00:38:28,120
So now we know how this thing works.

827
00:38:28,120 --> 00:38:31,250
Here's a closeup of the
DC motor in the linchpin.

828
00:38:31,250 --> 00:38:35,310
And again, if we, if we
apply a charge to the motor,

829
00:38:35,310 --> 00:38:36,143
then it'll open.

830
00:38:36,143 --> 00:38:39,280
So basically all the money
in this vault, $300,000

831
00:38:39,280 --> 00:38:41,670
potentially is protected
by the lack of voltage

832
00:38:41,670 --> 00:38:43,290
to this DC motor.

833
00:38:43,290 --> 00:38:46,010
So is there a way from the
outside of the vault to get

834
00:38:46,010 --> 00:38:49,540
voltage to this DC motor,
without anyone knowing,

835
00:38:49,540 --> 00:38:52,870
or without destroying the
lock or destroying the vault,

836
00:38:52,870 --> 00:38:54,830
or just throwing the case?

837
00:38:54,830 --> 00:38:56,560
Let's have a look.

838
00:38:56,560 --> 00:38:58,550
This is a short video
of the lock-in action.

839
00:38:58,550 --> 00:39:01,840
Look in the middle of the
lock at that linchpin,

840
00:39:01,840 --> 00:39:05,220
and you'll see, after I type
in the code, the motor turns,

841
00:39:05,220 --> 00:39:09,270
the linchpin goes up, which
would allow the bolt to turn

842
00:39:09,270 --> 00:39:10,810
and the lock to open.

843
00:39:10,810 --> 00:39:13,090
All right, so here's
a look at the key pad.

844
00:39:13,090 --> 00:39:17,290
And another interesting thought
that I had was, you know,

845
00:39:17,290 --> 00:39:21,170
there's a lot of space inside
this keypad thing that mounts

846
00:39:21,170 --> 00:39:26,170
on the front, and it doesn't
appear to me just doing some

847
00:39:26,680 --> 00:39:31,680
cursory research that there's
any encryption of the numbers

848
00:39:32,160 --> 00:39:35,200
that are pressed on the
keypad as it's being

849
00:39:35,200 --> 00:39:37,070
sent into the lock.

850
00:39:37,070 --> 00:39:39,680
And so what you see here
is a small experiment

851
00:39:39,680 --> 00:39:44,680
with an Arduino Nano in which
I'm hitting keypad presses on,

852
00:39:46,190 --> 00:39:49,900
pressing on the keypad and
recording the key presses

853
00:39:49,900 --> 00:39:53,450
into an Arduino Nano, and then passing

854
00:39:53,450 --> 00:39:56,133
that back on out to the lock.

855
00:39:57,390 --> 00:40:00,150
Very interesting research
can be done here.

856
00:40:00,150 --> 00:40:02,640
I believe this is a successful
man-in-the-middle attack

857
00:40:02,640 --> 00:40:05,283
against this particular lock.

858
00:40:06,490 --> 00:40:10,910
So, yeah, moving on from
that, we can see that

859
00:40:12,100 --> 00:40:14,940
I wasn't gonna be able to use that attack

860
00:40:14,940 --> 00:40:16,180
to get into my safe.

861
00:40:16,180 --> 00:40:18,050
I had to continue on.

862
00:40:18,050 --> 00:40:19,250
Here are the power wires.

863
00:40:19,250 --> 00:40:21,950
They pass directly under the circuit board

864
00:40:21,950 --> 00:40:23,420
on the door side of the lock.

865
00:40:23,420 --> 00:40:26,060
So the metal you see in this
picture would be actually

866
00:40:26,060 --> 00:40:30,630
against the door, and the
locks sits directly behind

867
00:40:30,630 --> 00:40:35,110
this keypad and the keypad is removable.

868
00:40:35,110 --> 00:40:37,460
And if we do remove the keypad,

869
00:40:37,460 --> 00:40:41,320
we can see through the hole
where the wire goes to the lock,

870
00:40:41,320 --> 00:40:42,797
that it is indeed the back of the lock.

871
00:40:42,797 --> 00:40:45,740
And it gives us this little
nice landmark to know exactly

872
00:40:45,740 --> 00:40:49,970
where on the lock we are
because of this little silver,

873
00:40:49,970 --> 00:40:51,230
solid silver dial.

874
00:40:51,230 --> 00:40:53,840
I have no idea what it
does, why it's there,

875
00:40:53,840 --> 00:40:56,540
but it is there and it
gives us a landmark.

876
00:40:56,540 --> 00:41:00,030
That little red X you see is
exactly where those wires are

877
00:41:00,030 --> 00:41:02,320
that we need to get access to.

878
00:41:02,320 --> 00:41:03,153
All right.

879
00:41:03,153 --> 00:41:05,950
So I need the right tool for
the job to get access to this.

880
00:41:05,950 --> 00:41:07,970
Something I've always wanted,

881
00:41:07,970 --> 00:41:09,990
an electromagnetic drill press.

882
00:41:09,990 --> 00:41:11,820
All right, so you're probably
saying, wait a second,

883
00:41:11,820 --> 00:41:13,300
this is cheating, right.

884
00:41:13,300 --> 00:41:15,230
Well, hear me out, hear me out.

885
00:41:15,230 --> 00:41:17,450
I figure if I can just get
a visual on those wires

886
00:41:17,450 --> 00:41:18,950
from the outside, I can come up with a way

887
00:41:18,950 --> 00:41:20,820
to supply current to them.

888
00:41:20,820 --> 00:41:23,660
And there just happens to be
an existing hole in the door

889
00:41:23,660 --> 00:41:26,700
from the factory that
allows for a different

890
00:41:26,700 --> 00:41:28,770
orientation of the keypad if you want.

891
00:41:28,770 --> 00:41:31,040
The hole is a quarter inch in diameter,

892
00:41:31,040 --> 00:41:32,610
and it's exactly where I needed to be.

893
00:41:32,610 --> 00:41:34,780
And it's there from the factory.

894
00:41:34,780 --> 00:41:37,840
I need this to be a little
bit bigger, but not too much.

895
00:41:37,840 --> 00:41:39,500
I went with a half inch carbide bit.

896
00:41:39,500 --> 00:41:42,850
So I made the hole diameter
a quarter inch bigger.

897
00:41:42,850 --> 00:41:43,683
All right.

898
00:41:45,000 --> 00:41:49,350
Well, I put this bit in and
I get my drill hooked up.

899
00:41:49,350 --> 00:41:53,720
Now this drill has a
binding capacity of about

900
00:41:53,720 --> 00:41:56,360
3000 pounds per square inch.

901
00:41:56,360 --> 00:41:58,720
It's not going anywhere
once you turn it on.

902
00:41:58,720 --> 00:42:02,030
And the RPMs of this drill is about 1200.

903
00:42:02,030 --> 00:42:06,100
A carbide tipped drill bit,

904
00:42:06,100 --> 00:42:09,850
really no match for this safe door.

905
00:42:09,850 --> 00:42:12,760
It really only takes a couple
of minutes to get in there.

906
00:42:12,760 --> 00:42:13,940
It takes me a little bit longer,

907
00:42:13,940 --> 00:42:15,910
'cause I'm not exactly
sure what the depth is.

908
00:42:15,910 --> 00:42:19,390
But suffice to say, I
get into the lock without

909
00:42:19,390 --> 00:42:21,150
damaging it in any way.

910
00:42:21,150 --> 00:42:25,170
And now we can see the wires of interest.

911
00:42:25,170 --> 00:42:28,680
And now keep in mind if
I put the keypad back on,

912
00:42:28,680 --> 00:42:32,500
our mischief is fully concealed
and nobody is the wiser.

913
00:42:32,500 --> 00:42:33,940
All right, so the last
piece of the puzzle.

914
00:42:33,940 --> 00:42:36,530
How do I get power to these
wires through this half-inch

915
00:42:36,530 --> 00:42:39,010
hole without breaking the lock?

916
00:42:39,010 --> 00:42:40,730
After a lot of thinking
and digging around,

917
00:42:40,730 --> 00:42:43,000
I figured out that there's this tool

918
00:42:43,000 --> 00:42:44,650
called a puncture probe.

919
00:42:44,650 --> 00:42:46,700
It's exactly what I needed.

920
00:42:46,700 --> 00:42:47,660
This is how it works.

921
00:42:47,660 --> 00:42:51,900
The idea, you retract the
probe, the puncture pin,

922
00:42:51,900 --> 00:42:54,250
you get the wire in there
and you release the pin into

923
00:42:54,250 --> 00:42:56,650
the wire and you have connectivity

924
00:42:56,650 --> 00:43:00,080
and you can connect a wire
down at the base of the probe.

925
00:43:00,080 --> 00:43:02,510
So this is kind of what that looks like.

926
00:43:02,510 --> 00:43:04,600
I built my own probes because those

927
00:43:04,600 --> 00:43:06,830
plastic ones were far too big.

928
00:43:06,830 --> 00:43:10,100
So what I'm doing here is I've
punctured these wires on my

929
00:43:10,100 --> 00:43:14,440
work bench and I'm applying
a nine volt charge to them,

930
00:43:14,440 --> 00:43:16,363
and you can see that it is opening.

931
00:43:17,510 --> 00:43:19,610
Again, the problem was
that these were way too big

932
00:43:19,610 --> 00:43:20,960
for the access port that I had drilled,

933
00:43:20,960 --> 00:43:22,950
and I certainly didn't
want to cheat anymore

934
00:43:22,950 --> 00:43:24,890
by making the hole bigger.

935
00:43:24,890 --> 00:43:26,830
So I designed something smaller.

936
00:43:26,830 --> 00:43:29,830
At the time I used this
little piece of wire

937
00:43:29,830 --> 00:43:31,860
with a hook on the end.

938
00:43:31,860 --> 00:43:36,560
And here you can see that, you know,

939
00:43:36,560 --> 00:43:38,690
this is what it looks
like when it's all set up.

940
00:43:38,690 --> 00:43:41,650
I hooked up the nine-volt
battery and nothing happened.

941
00:43:41,650 --> 00:43:44,630
I was a little worried that
my nine-volt battery was bad,

942
00:43:44,630 --> 00:43:47,460
so I hooked it up to a DC power supply,

943
00:43:47,460 --> 00:43:49,250
and I gave it 17 volts, just, you know,

944
00:43:49,250 --> 00:43:51,693
in case it needed a
little more extra juice.

945
00:43:52,950 --> 00:43:55,510
Here's the full scene
when the vault was opened

946
00:43:55,510 --> 00:43:59,610
for the first time back in, I believe,

947
00:43:59,610 --> 00:44:02,050
the end of March, early April.

948
00:44:02,050 --> 00:44:07,050
And yeah, so you can see the scope there,

949
00:44:07,937 --> 00:44:11,370
and you can see my tool,
the tool that I use,

950
00:44:11,370 --> 00:44:12,837
the puncture probe.

951
00:44:12,837 --> 00:44:15,810
You can see the wire tool that I created,

952
00:44:15,810 --> 00:44:17,787
the inside through the borescope.

953
00:44:17,787 --> 00:44:21,130
And then here we go, the door
is open for the first time

954
00:44:21,130 --> 00:44:22,363
and we can see inside.

955
00:44:23,200 --> 00:44:26,580
So here's a demo of what just happened.

956
00:44:26,580 --> 00:44:31,030
As you can see, the lock is
locked as I pushed down on it

957
00:44:31,030 --> 00:44:34,640
and attaching the probes
and applying voltage,

958
00:44:34,640 --> 00:44:37,500
and the lock opens.

959
00:44:37,500 --> 00:44:39,951
I'm gonna skip forward
because I'm running out of,

960
00:44:39,951 --> 00:44:42,093
I'm a little bit,
running out of time here.

961
00:44:43,900 --> 00:44:48,270
So we're just gonna go pass this one to...

962
00:44:49,440 --> 00:44:52,370
Again, if I put the keypad in place,

963
00:44:52,370 --> 00:44:54,883
there is no evidence of intrusion.

964
00:44:54,883 --> 00:44:58,700
And as an added bonus, if you
want to go the extra mile,

965
00:44:58,700 --> 00:44:59,860
you can cover the access hole

966
00:44:59,860 --> 00:45:01,603
with this half inch plastic cover.

967
00:45:02,720 --> 00:45:05,140
Barely noticeable, right, right?

968
00:45:05,140 --> 00:45:06,272
All right.

969
00:45:06,272 --> 00:45:08,670
So again, not as satisfied
with the smaller probe.

970
00:45:08,670 --> 00:45:12,070
There must have been a way
to do it with a smaller hole.

971
00:45:12,070 --> 00:45:13,700
So I started taking these pros apart.

972
00:45:13,700 --> 00:45:17,940
I pulled off the plastic sheeting
and saw the probe inside.

973
00:45:17,940 --> 00:45:22,350
I went and grabbed a stainless
steel, three mil tube.

974
00:45:22,350 --> 00:45:25,710
I put a little notch in it,
in the end and heated up

975
00:45:25,710 --> 00:45:28,740
the tube to melt into
the plastic of the probe.

976
00:45:28,740 --> 00:45:31,620
And this is what it looks
like when it's all together.

977
00:45:31,620 --> 00:45:33,530
And it's a lot smaller.

978
00:45:33,530 --> 00:45:36,380
It's 6.2 mil versus 2.9.

979
00:45:36,380 --> 00:45:38,630
So a lot smaller, which means
I can now do this attack

980
00:45:38,630 --> 00:45:41,073
with a much smaller hole.

981
00:45:41,990 --> 00:45:43,740
All right, some loose ends quickly.

982
00:45:45,210 --> 00:45:49,490
I sent dormakaba this
letter to let them know some

983
00:45:49,490 --> 00:45:51,513
pre disclosure, pre-talk disclosure.

984
00:45:52,410 --> 00:45:55,370
I never got any response from this.

985
00:45:55,370 --> 00:45:59,200
Here is my email to
security at Hyosung America.

986
00:45:59,200 --> 00:46:02,480
I never got a response to this one either.

987
00:46:02,480 --> 00:46:05,393
So I got a delivery
failure notice, instead.

988
00:46:06,280 --> 00:46:09,443
As far as the money, there
was money in the ATM.

989
00:46:10,960 --> 00:46:13,270
I'm a trusted source, advice.

990
00:46:13,270 --> 00:46:15,760
I am not gonna tell you
exactly how much it was.

991
00:46:15,760 --> 00:46:18,700
I will not disclose that, but
there was enough to pay for

992
00:46:18,700 --> 00:46:22,980
the research project and the
ATM and a little bit leftover.

993
00:46:22,980 --> 00:46:25,460
All right, some follow up research.

994
00:46:25,460 --> 00:46:27,830
ATM Wi-Fi, really cool, I think.

995
00:46:27,830 --> 00:46:30,450
The vault lock,
man-in-the-middle I showed,

996
00:46:30,450 --> 00:46:32,993
ATM software modifications
we talked about.

997
00:46:34,390 --> 00:46:37,860
Maybe the USD and SD card
could be fun to mess with.

998
00:46:37,860 --> 00:46:41,250
Internal serial comms between
the top and the bottom,

999
00:46:41,250 --> 00:46:43,850
right between the CDU and the computer.

1000
00:46:43,850 --> 00:46:45,150
Can we capture and replay?

1001
00:46:46,150 --> 00:46:48,890
How about EPP deconstruction analysis?

1002
00:46:48,890 --> 00:46:51,240
That warning message we saw.

1003
00:46:51,240 --> 00:46:53,570
All of those topics, I
think are fascinating,

1004
00:46:53,570 --> 00:46:54,990
and I will continue research.

1005
00:46:54,990 --> 00:46:58,110
If anybody else wants to join
me, please reach out to me.

1006
00:46:58,110 --> 00:47:03,110
So in conclusion, no key, no
pin, no combo, no problem.

1007
00:47:04,450 --> 00:47:06,250
Thanks for watching.

1008
00:47:06,250 --> 00:47:07,150
Have a great day.

1009
00:47:07,150 --> 00:47:09,050
And I hope you have a fabulous DEFCON.

1010
00:47:10,540 --> 00:47:11,373
Bye-bye.

