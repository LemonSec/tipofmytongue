1
00:00:05,440 --> 00:00:06,720
hi everyone

2
00:00:06,720 --> 00:00:09,120
my name is nick roy and this is oscent

3
00:00:09,120 --> 00:00:11,040
and the hermit kingdom

4
00:00:11,040 --> 00:00:12,160
learning more about the world's most

5
00:00:12,160 --> 00:00:14,559
secretive nation

6
00:00:14,559 --> 00:00:16,079
so just a quick introduction about

7
00:00:16,079 --> 00:00:18,080
myself i've been in security for a

8
00:00:18,080 --> 00:00:18,720
little over

9
00:00:18,720 --> 00:00:20,800
eight nine years now i've worked for

10
00:00:20,800 --> 00:00:22,400
automation companies i've done some app

11
00:00:22,400 --> 00:00:24,640
development vulnerability management

12
00:00:24,640 --> 00:00:27,439
uh based out of boston my online is

13
00:00:27,439 --> 00:00:28,560
super duptos

14
00:00:28,560 --> 00:00:31,039
and we think all good presentations need

15
00:00:31,039 --> 00:00:32,320
to start off with a picture of

16
00:00:32,320 --> 00:00:35,200
uh cats so this is a picture of my cat

17
00:00:35,200 --> 00:00:35,760
frank

18
00:00:35,760 --> 00:00:37,440
and generally the look he gives me

19
00:00:37,440 --> 00:00:40,879
whenever i'm working on something

20
00:00:41,360 --> 00:00:43,440
so let's get right into it uh what is

21
00:00:43,440 --> 00:00:45,039
ocean i'm sure everyone here is familiar

22
00:00:45,039 --> 00:00:45,760
with this

23
00:00:45,760 --> 00:00:47,760
so just a brief introduction it's really

24
00:00:47,760 --> 00:00:49,600
data collected from any kind of publicly

25
00:00:49,600 --> 00:00:51,039
available sources

26
00:00:51,039 --> 00:00:53,199
uh it's not related to any kind of open

27
00:00:53,199 --> 00:00:54,719
source software or collective

28
00:00:54,719 --> 00:00:56,320
intelligence

29
00:00:56,320 --> 00:00:57,280
and really there's a lot of paid

30
00:00:57,280 --> 00:00:59,039
services out there but today we're going

31
00:00:59,039 --> 00:01:00,000
to be looking at

32
00:01:00,000 --> 00:01:01,520
uh what's free and what can be found

33
00:01:01,520 --> 00:01:02,960
from the comfort of sitting on our home

34
00:01:02,960 --> 00:01:05,358
couch

35
00:01:06,000 --> 00:01:07,920
so what are the benefits of ocean it is

36
00:01:07,920 --> 00:01:09,439
less risky

37
00:01:09,439 --> 00:01:11,280
we're just going out and essentially uh

38
00:01:11,280 --> 00:01:13,200
doing some really creative searches

39
00:01:13,200 --> 00:01:14,880
to find some different piece of

40
00:01:14,880 --> 00:01:17,200
information that we might be looking for

41
00:01:17,200 --> 00:01:19,280
it is cost effective i think uh the

42
00:01:19,280 --> 00:01:20,640
grand total that i've spent on all of

43
00:01:20,640 --> 00:01:21,920
this has been about

44
00:01:21,920 --> 00:01:24,479
20 over the last uh probably two years

45
00:01:24,479 --> 00:01:25,759
two and a half years it took to put all

46
00:01:25,759 --> 00:01:26,000
this

47
00:01:26,000 --> 00:01:28,479
together it is pretty easy to gather

48
00:01:28,479 --> 00:01:30,240
they did all this from the comfort of my

49
00:01:30,240 --> 00:01:32,079
couch while watching uh the stanley cup

50
00:01:32,079 --> 00:01:33,360
playoffs

51
00:01:33,360 --> 00:01:35,119
and certainly i am not a lawyer by any

52
00:01:35,119 --> 00:01:36,400
means uh but

53
00:01:36,400 --> 00:01:38,079
everything's already online that we're

54
00:01:38,079 --> 00:01:40,960
looking for

55
00:01:40,960 --> 00:01:42,560
now some of the challenges of ocean that

56
00:01:42,560 --> 00:01:44,960
we might run into this is something that

57
00:01:44,960 --> 00:01:46,479
i'm sure everyone has faced at one point

58
00:01:46,479 --> 00:01:48,640
or another there is a lot of data out

59
00:01:48,640 --> 00:01:49,200
there

60
00:01:49,200 --> 00:01:50,720
especially if we're not really sure what

61
00:01:50,720 --> 00:01:52,960
we're looking for a lot of the times

62
00:01:52,960 --> 00:01:54,000
when i started this they really

63
00:01:54,000 --> 00:01:55,680
didn't have anything in mind for

64
00:01:55,680 --> 00:01:57,840
something specific i was looking for

65
00:01:57,840 --> 00:01:59,439
i was really just kind of doing some

66
00:01:59,439 --> 00:02:01,360
general searches to get an idea of uh

67
00:02:01,360 --> 00:02:02,399
what was out there and

68
00:02:02,399 --> 00:02:04,399
what i could find and then i could start

69
00:02:04,399 --> 00:02:06,000
to narrow it down from there

70
00:02:06,000 --> 00:02:08,399
but i never really started out with any

71
00:02:08,399 --> 00:02:09,038
kind of

72
00:02:09,038 --> 00:02:11,840
uh plan or any kind of kind of

73
00:02:11,840 --> 00:02:15,520
hypothesis that i wanted to prove

74
00:02:15,599 --> 00:02:17,440
so there is a lot of data out there

75
00:02:17,440 --> 00:02:19,280
sometimes reliability is something we

76
00:02:19,280 --> 00:02:20,319
need to worry about

77
00:02:20,319 --> 00:02:21,760
again this isn't data that we're

78
00:02:21,760 --> 00:02:23,920
actually uh going out and creating

79
00:02:23,920 --> 00:02:25,200
ourselves we're gathering this from

80
00:02:25,200 --> 00:02:27,360
available sources

81
00:02:27,360 --> 00:02:28,959
and then certainly reviewing all this

82
00:02:28,959 --> 00:02:30,480
data can be a challenge

83
00:02:30,480 --> 00:02:32,560
uh i still have tons of data related to

84
00:02:32,560 --> 00:02:33,599
this project

85
00:02:33,599 --> 00:02:35,120
that i just haven't had a chance to get

86
00:02:35,120 --> 00:02:37,519
through yet it's pretty easy to

87
00:02:37,519 --> 00:02:39,760
automatically gather this data

88
00:02:39,760 --> 00:02:41,120
but kind of piecing things together and

89
00:02:41,120 --> 00:02:43,360
making sense of it is where we can start

90
00:02:43,360 --> 00:02:44,560
to

91
00:02:44,560 --> 00:02:47,680
run into some challenges

92
00:02:49,040 --> 00:02:51,360
now live north korea uh this is a a

93
00:02:51,360 --> 00:02:52,720
question that's come up a couple of

94
00:02:52,720 --> 00:02:53,519
times

95
00:02:53,519 --> 00:02:56,400
since i i've done this talk now um i

96
00:02:56,400 --> 00:02:57,680
always like to make the joke it's fun to

97
00:02:57,680 --> 00:02:58,560
tell my mom

98
00:02:58,560 --> 00:03:00,560
uh but really it started probably about

99
00:03:00,560 --> 00:03:01,599
10 years ago

100
00:03:01,599 --> 00:03:03,440
i saw a video on youtube the vice guide

101
00:03:03,440 --> 00:03:04,800
to north korea

102
00:03:04,800 --> 00:03:06,640
and i i thought it was interesting

103
00:03:06,640 --> 00:03:08,319
purely from the perspective of they went

104
00:03:08,319 --> 00:03:09,120
on a tour

105
00:03:09,120 --> 00:03:11,360
and you got to see a little bit of just

106
00:03:11,360 --> 00:03:13,680
day-to-day lives of everyone there

107
00:03:13,680 --> 00:03:16,239
so this is really not anything related

108
00:03:16,239 --> 00:03:16,720
to

109
00:03:16,720 --> 00:03:20,400
any kind of apt activity this isn't

110
00:03:20,400 --> 00:03:22,959
related to anything malware or political

111
00:03:22,959 --> 00:03:25,200
this is really just looking to see what

112
00:03:25,200 --> 00:03:26,159
can we learn about

113
00:03:26,159 --> 00:03:28,560
the internet in north korea sitting on

114
00:03:28,560 --> 00:03:33,440
our own couch

115
00:03:33,440 --> 00:03:35,440
so let's start to gather some

116
00:03:35,440 --> 00:03:37,280
information and see what we can find

117
00:03:37,280 --> 00:03:38,720
now there's a couple of ways that we can

118
00:03:38,720 --> 00:03:40,799
start to gather this data

119
00:03:40,799 --> 00:03:42,319
today we're going to focus on really the

120
00:03:42,319 --> 00:03:44,000
first two items here

121
00:03:44,000 --> 00:03:46,879
passive and semi-passive data passive is

122
00:03:46,879 --> 00:03:48,799
anything that we can find online

123
00:03:48,799 --> 00:03:50,480
semi-passive is where maybe i'm going to

124
00:03:50,480 --> 00:03:51,840
go out and

125
00:03:51,840 --> 00:03:55,200
use this website to go scan a target for

126
00:03:55,200 --> 00:03:55,840
me

127
00:03:55,840 --> 00:03:57,840
but i'm still keeping my uh that site

128
00:03:57,840 --> 00:03:59,040
between myself and whatever i'm

129
00:03:59,040 --> 00:04:00,799
researching

130
00:04:00,799 --> 00:04:02,879
and we really want to avoid active i

131
00:04:02,879 --> 00:04:06,400
don't want to just run an map scan and

132
00:04:06,400 --> 00:04:08,560
do all of my discovery that way i want

133
00:04:08,560 --> 00:04:12,000
to rely on what's publicly available

134
00:04:12,000 --> 00:04:13,120
and today what we want to start to

135
00:04:13,120 --> 00:04:15,439
identify uh we want to see

136
00:04:15,439 --> 00:04:18,160
what's on the north korean ip space uh

137
00:04:18,160 --> 00:04:19,358
we want to start to define

138
00:04:19,358 --> 00:04:22,160
what the north korean ips base is what

139
00:04:22,160 --> 00:04:23,840
kind of services are running there

140
00:04:23,840 --> 00:04:26,720
kind of operating systems can we find

141
00:04:26,720 --> 00:04:28,080
and we'll start to branch out from there

142
00:04:28,080 --> 00:04:29,840
and see what else we can learn

143
00:04:29,840 --> 00:04:32,639
as we do start to find more and more

144
00:04:32,639 --> 00:04:36,240
pieces of data that we can work with

145
00:04:38,880 --> 00:04:40,880
so to start off we need to define our

146
00:04:40,880 --> 00:04:44,800
scope and this one's pretty easy

147
00:04:45,199 --> 00:04:48,080
there is four class c networks that are

148
00:04:48,080 --> 00:04:49,759
assigned to north korea

149
00:04:49,759 --> 00:04:54,960
we can see it here 175 45.176 to 179.

150
00:04:54,960 --> 00:04:56,240
this is really what we're going to focus

151
00:04:56,240 --> 00:04:58,560
on today there are a couple of other ip

152
00:04:58,560 --> 00:05:00,479
address ranges that

153
00:05:00,479 --> 00:05:03,759
we can see and there's never really been

154
00:05:03,759 --> 00:05:06,400
anything too interesting on them

155
00:05:06,400 --> 00:05:07,840
and quite honestly it's there's always a

156
00:05:07,840 --> 00:05:09,039
little bit of a debate about whether or

157
00:05:09,039 --> 00:05:10,080
not they're actually used

158
00:05:10,080 --> 00:05:12,479
by north korea so we're really just

159
00:05:12,479 --> 00:05:13,759
going to focus on

160
00:05:13,759 --> 00:05:16,000
what we know is actively used and

161
00:05:16,000 --> 00:05:19,280
maintained by north korea

162
00:05:19,840 --> 00:05:21,120
but what do we do if there's not a

163
00:05:21,120 --> 00:05:22,880
wikipedia article

164
00:05:22,880 --> 00:05:24,240
well there's a couple of things we can

165
00:05:24,240 --> 00:05:25,919
do we can pick a domain that we know

166
00:05:25,919 --> 00:05:26,960
about

167
00:05:26,960 --> 00:05:30,080
in this case i'm looking at apple.com as

168
00:05:30,080 --> 00:05:31,039
an example

169
00:05:31,039 --> 00:05:33,440
we can use the dig command that's going

170
00:05:33,440 --> 00:05:35,120
to give me the ip addresses

171
00:05:35,120 --> 00:05:38,960
for this the server that's responding

172
00:05:38,960 --> 00:05:41,440
and then i can do a who is look up here

173
00:05:41,440 --> 00:05:42,320
where i can get the

174
00:05:42,320 --> 00:05:44,880
asn or the autonomous system number uh

175
00:05:44,880 --> 00:05:46,080
this is how we

176
00:05:46,080 --> 00:05:48,160
essentially register ip addresses to our

177
00:05:48,160 --> 00:05:50,160
an organization

178
00:05:50,160 --> 00:05:53,680
i can look up asn 714 i can see that it

179
00:05:53,680 --> 00:05:55,680
is owned by apple and all the ip ranges

180
00:05:55,680 --> 00:05:58,240
that they own

181
00:05:58,560 --> 00:06:00,560
and this is something we can easily do

182
00:06:00,560 --> 00:06:02,319
for our north korean rangers

183
00:06:02,319 --> 00:06:03,840
so even if we think that someone might

184
00:06:03,840 --> 00:06:06,000
have edited the wikipedia article

185
00:06:06,000 --> 00:06:07,520
we can still go in and validate this

186
00:06:07,520 --> 00:06:09,680
information and we can confirm that

187
00:06:09,680 --> 00:06:10,479
those four

188
00:06:10,479 --> 00:06:12,560
class c networks are where we want to

189
00:06:12,560 --> 00:06:16,240
start looking and see what we can find

190
00:06:19,199 --> 00:06:22,080
so how many servers are online uh this

191
00:06:22,080 --> 00:06:23,280
is what we want to start to

192
00:06:23,280 --> 00:06:25,840
answer next what's actually active out

193
00:06:25,840 --> 00:06:29,039
of these 1024 ip addresses

194
00:06:29,039 --> 00:06:31,199
now this was something i found from back

195
00:06:31,199 --> 00:06:32,840
in

196
00:06:32,840 --> 00:06:35,840
2010 this was the earliest example i

197
00:06:35,840 --> 00:06:37,680
could find of anyone actually scanning

198
00:06:37,680 --> 00:06:39,919
north korea's ip space

199
00:06:39,919 --> 00:06:42,000
at the time it looks like they had about

200
00:06:42,000 --> 00:06:45,199
12 servers online

201
00:06:45,280 --> 00:06:46,479
so we have a little bit of a starting

202
00:06:46,479 --> 00:06:48,400
point but we want to start to understand

203
00:06:48,400 --> 00:06:50,240
what's changed over the years

204
00:06:50,240 --> 00:06:53,199
what's online now

205
00:06:53,599 --> 00:06:54,880
and there's a couple of places we can

206
00:06:54,880 --> 00:06:57,599
turn to one of my favorite places to

207
00:06:57,599 --> 00:06:58,319
search

208
00:06:58,319 --> 00:06:59,440
because you can find a lot of

209
00:06:59,440 --> 00:07:01,599
interesting information there

210
00:07:01,599 --> 00:07:04,960
is searching github so this is where i

211
00:07:04,960 --> 00:07:06,479
found actually a number of people who

212
00:07:06,479 --> 00:07:06,880
are

213
00:07:06,880 --> 00:07:09,919
scanning north korea

214
00:07:09,919 --> 00:07:11,440
and they're publishing all their results

215
00:07:11,440 --> 00:07:14,160
online so they're running nmap scans

216
00:07:14,160 --> 00:07:16,000
they have nice repo set up where you can

217
00:07:16,000 --> 00:07:18,160
easily search through these

218
00:07:18,160 --> 00:07:19,440
so there's a lot of different projects

219
00:07:19,440 --> 00:07:20,880
out there that are actually just

220
00:07:20,880 --> 00:07:22,080
scanning the internet

221
00:07:22,080 --> 00:07:23,520
and interesting targets and making it

222
00:07:23,520 --> 00:07:26,000
available on github

223
00:07:26,000 --> 00:07:27,440
and we'll talk about github again

224
00:07:27,440 --> 00:07:28,720
there's a couple of other fun things

225
00:07:28,720 --> 00:07:30,240
that i found on there as well related to

226
00:07:30,240 --> 00:07:31,360
north korea

227
00:07:31,360 --> 00:07:32,800
but you can find all sorts of things on

228
00:07:32,800 --> 00:07:34,720
github that

229
00:07:34,720 --> 00:07:37,360
maybe people uh aren't actually putting

230
00:07:37,360 --> 00:07:38,639
their own purpose

231
00:07:38,639 --> 00:07:40,960
i've found company api keys i've

232
00:07:40,960 --> 00:07:42,800
reported them i've seen

233
00:07:42,800 --> 00:07:46,000
entire dev repose just deleted because

234
00:07:46,000 --> 00:07:47,199
of things that were left there

235
00:07:47,199 --> 00:07:49,120
accidentally there's a lot of good

236
00:07:49,120 --> 00:07:52,879
information that you can find on github

237
00:07:54,240 --> 00:07:55,520
now there's a couple of other places

238
00:07:55,520 --> 00:07:57,360
that you can check

239
00:07:57,360 --> 00:07:59,360
the internet wide scanning project is a

240
00:07:59,360 --> 00:08:00,879
great place to check

241
00:08:00,879 --> 00:08:04,000
if you do have your black friday key or

242
00:08:04,000 --> 00:08:06,000
if you haven't purchased that yet it's

243
00:08:06,000 --> 00:08:08,080
the best five dollars i've ever spent i

244
00:08:08,080 --> 00:08:10,400
think i've bought it a few times now

245
00:08:10,400 --> 00:08:12,879
but this is a way where we can start to

246
00:08:12,879 --> 00:08:14,400
just see what showdan knows about these

247
00:08:14,400 --> 00:08:16,000
various devices

248
00:08:16,000 --> 00:08:17,360
we can find that there's a number of

249
00:08:17,360 --> 00:08:20,319
them reporting here

250
00:08:20,400 --> 00:08:22,639
and again we want to try to just

251
00:08:22,639 --> 00:08:24,800
validate our data as much as possible

252
00:08:24,800 --> 00:08:26,400
we have some nmap scans we have showed

253
00:08:26,400 --> 00:08:29,280
in data census is another internet wide

254
00:08:29,280 --> 00:08:31,680
scanning project that we can look at

255
00:08:31,680 --> 00:08:33,919
so between all these different services

256
00:08:33,919 --> 00:08:36,320
this information that we can find online

257
00:08:36,320 --> 00:08:38,080
we can generally get a good idea of

258
00:08:38,080 --> 00:08:40,399
what's available online anytime

259
00:08:40,399 --> 00:08:43,919
and the north korean id space

260
00:08:45,040 --> 00:08:46,880
so this is my very crude drawing that i

261
00:08:46,880 --> 00:08:49,120
did uh but we can see that there's

262
00:08:49,120 --> 00:08:51,760
really three subnets that are in use the

263
00:08:51,760 --> 00:08:54,800
176 subnet is

264
00:08:54,800 --> 00:08:56,959
where most of the activity is happening

265
00:08:56,959 --> 00:08:59,040
where most of these servers are deployed

266
00:08:59,040 --> 00:09:02,480
uh 77 and 78 there's a couple of things

267
00:09:02,480 --> 00:09:03,600
here and there

268
00:09:03,600 --> 00:09:05,200
sometimes these numbers fluctuate a

269
00:09:05,200 --> 00:09:08,080
little bit 79

270
00:09:08,080 --> 00:09:09,920
really don't see anything uh happening

271
00:09:09,920 --> 00:09:11,440
there too much ever

272
00:09:11,440 --> 00:09:13,040
if you do ever see traffic connecting to

273
00:09:13,040 --> 00:09:15,279
there usually it's not a good thing

274
00:09:15,279 --> 00:09:17,440
uh there's been a couple of reports uh

275
00:09:17,440 --> 00:09:19,040
for various pieces of malware that are

276
00:09:19,040 --> 00:09:20,320
connecting back to

277
00:09:20,320 --> 00:09:23,920
that 179 space now but this at least

278
00:09:23,920 --> 00:09:25,440
starts to narrow down what we're looking

279
00:09:25,440 --> 00:09:28,160
at and now we have a pretty decent idea

280
00:09:28,160 --> 00:09:29,200
of where we're

281
00:09:29,200 --> 00:09:31,839
we're starting

282
00:09:34,720 --> 00:09:37,200
so now that we know what's alive uh

283
00:09:37,200 --> 00:09:39,600
we've narrowed down our 1024 ip

284
00:09:39,600 --> 00:09:40,800
addresses

285
00:09:40,800 --> 00:09:42,880
to just 20 to 30 different hosts

286
00:09:42,880 --> 00:09:44,399
depending on

287
00:09:44,399 --> 00:09:46,240
what's online and what's resolving that

288
00:09:46,240 --> 00:09:48,320
day

289
00:09:48,320 --> 00:09:49,519
so the next thing we want to do is we

290
00:09:49,519 --> 00:09:50,800
want to start to get a better

291
00:09:50,800 --> 00:09:52,480
understanding of what's actually running

292
00:09:52,480 --> 00:09:54,720
on these devices

293
00:09:54,720 --> 00:09:56,240
and this is one of the only times we'll

294
00:09:56,240 --> 00:09:57,839
actually go ahead and do any kind of

295
00:09:57,839 --> 00:09:59,680
active probing uh we're just going to

296
00:09:59,680 --> 00:10:02,320
put that ip address into our browser

297
00:10:02,320 --> 00:10:04,320
and we can see some interesting

298
00:10:04,320 --> 00:10:05,440
information here

299
00:10:05,440 --> 00:10:08,720
we see that it's running apache 480 but

300
00:10:08,720 --> 00:10:10,720
we can see that the operating system is

301
00:10:10,720 --> 00:10:13,920
redstar 4.0

302
00:10:14,160 --> 00:10:15,839
now if you're not familiar with the red

303
00:10:15,839 --> 00:10:18,320
star operating system uh this is a

304
00:10:18,320 --> 00:10:20,320
state sponsored operating system

305
00:10:20,320 --> 00:10:22,079
developed in north korea

306
00:10:22,079 --> 00:10:23,760
uh there's two different versions of it

307
00:10:23,760 --> 00:10:26,480
there's a desktop and a server version

308
00:10:26,480 --> 00:10:28,560
uh there's a couple guys in germany that

309
00:10:28,560 --> 00:10:29,600
did some great work

310
00:10:29,600 --> 00:10:31,200
uh really digging into the desktop

311
00:10:31,200 --> 00:10:33,760
version they found all sorts of nasty

312
00:10:33,760 --> 00:10:34,959
things in there

313
00:10:34,959 --> 00:10:37,760
one that deletes files if there are

314
00:10:37,760 --> 00:10:38,240
certain

315
00:10:38,240 --> 00:10:40,399
strings of text in there those get

316
00:10:40,399 --> 00:10:42,320
deleted automatically

317
00:10:42,320 --> 00:10:43,839
another one that actually watermarks

318
00:10:43,839 --> 00:10:45,360
files in the background and the

319
00:10:45,360 --> 00:10:47,839
watermarks actually stack so you can see

320
00:10:47,839 --> 00:10:49,760
who made changes and who had ownership

321
00:10:49,760 --> 00:10:51,680
of a file at any time as it's being

322
00:10:51,680 --> 00:10:54,640
changed and shared

323
00:10:55,839 --> 00:10:58,000
so they have a great github repo if you

324
00:10:58,000 --> 00:10:59,519
do want to take a look at some of their

325
00:10:59,519 --> 00:11:01,360
research some of the tools that they've

326
00:11:01,360 --> 00:11:02,880
published for

327
00:11:02,880 --> 00:11:04,800
disabling a lot of these malicious

328
00:11:04,800 --> 00:11:05,920
components

329
00:11:05,920 --> 00:11:07,200
you can find that online they have a

330
00:11:07,200 --> 00:11:10,399
great talk about it as well

331
00:11:10,560 --> 00:11:11,839
but if you haven't seen what red star

332
00:11:11,839 --> 00:11:14,320
looks like version one had the nice

333
00:11:14,320 --> 00:11:16,880
windows xp theme to it

334
00:11:16,880 --> 00:11:18,880
version two changed it up a little bit a

335
00:11:18,880 --> 00:11:20,959
little more the the traditional

336
00:11:20,959 --> 00:11:25,599
linux linux flavor to the desktop

337
00:11:25,920 --> 00:11:27,600
version three was an interesting change

338
00:11:27,600 --> 00:11:28,959
because around this time

339
00:11:28,959 --> 00:11:30,399
we started seeing pictures come out from

340
00:11:30,399 --> 00:11:32,959
north korea where they actually had

341
00:11:32,959 --> 00:11:35,519
apple computers in the country so

342
00:11:35,519 --> 00:11:37,760
naturally the operating system

343
00:11:37,760 --> 00:11:41,279
needed to change to reflect that

344
00:11:41,680 --> 00:11:43,920
uh now we know that version 4 is

345
00:11:43,920 --> 00:11:46,000
available inside of north korea

346
00:11:46,000 --> 00:11:47,519
if you do want to try versions two or

347
00:11:47,519 --> 00:11:49,200
three you can find them online you can

348
00:11:49,200 --> 00:11:49,839
find them on

349
00:11:49,839 --> 00:11:51,600
archive.org it's it's pretty easy to

350
00:11:51,600 --> 00:11:54,240
download them and get them going

351
00:11:54,240 --> 00:11:56,399
we know version 4 is available one

352
00:11:56,399 --> 00:11:58,639
because well we saw it reported when we

353
00:11:58,639 --> 00:12:01,279
browse to that ip address but again even

354
00:12:01,279 --> 00:12:02,880
if we don't want to trust that

355
00:12:02,880 --> 00:12:04,320
uh maybe we don't trust the banner that

356
00:12:04,320 --> 00:12:06,320
we're looking at

357
00:12:06,320 --> 00:12:08,639
this is from a magazine called foreign

358
00:12:08,639 --> 00:12:10,560
trade of the dprk

359
00:12:10,560 --> 00:12:13,360
they published this magazine online on

360
00:12:13,360 --> 00:12:14,320
one of their

361
00:12:14,320 --> 00:12:16,880
commerce websites and if you're looking

362
00:12:16,880 --> 00:12:17,680
for some really

363
00:12:17,680 --> 00:12:19,360
interesting things that you might be

364
00:12:19,360 --> 00:12:22,079
interested in buying a lot of

365
00:12:22,079 --> 00:12:23,519
interesting things in here

366
00:12:23,519 --> 00:12:24,720
but there was an article in there a

367
00:12:24,720 --> 00:12:27,120
couple of months ago about how red star

368
00:12:27,120 --> 00:12:28,240
4.0 was

369
00:12:28,240 --> 00:12:30,959
uh developed and released in the country

370
00:12:30,959 --> 00:12:32,639
how great it is how many people love it

371
00:12:32,639 --> 00:12:33,920
in the country

372
00:12:33,920 --> 00:12:36,320
so we do know that it is it is generally

373
00:12:36,320 --> 00:12:37,040
in use

374
00:12:37,040 --> 00:12:39,040
and it's being put to use inside the

375
00:12:39,040 --> 00:12:41,040
country uh it hasn't made its way

376
00:12:41,040 --> 00:12:42,240
outside yet

377
00:12:42,240 --> 00:12:44,959
but we do know that it exists and

378
00:12:44,959 --> 00:12:46,240
typically development

379
00:12:46,240 --> 00:12:48,959
uh it does seem to be like something

380
00:12:48,959 --> 00:12:49,519
that's in

381
00:12:49,519 --> 00:12:50,880
in development and work done pretty

382
00:12:50,880 --> 00:12:53,839
frequently

383
00:12:55,279 --> 00:12:56,959
i did mention that there's two different

384
00:12:56,959 --> 00:12:59,200
versions of redstar there's the desktop

385
00:12:59,200 --> 00:12:59,839
version

386
00:12:59,839 --> 00:13:01,920
then there's the server version i

387
00:13:01,920 --> 00:13:03,360
haven't seen a lot of people really look

388
00:13:03,360 --> 00:13:05,440
at the server version too closely

389
00:13:05,440 --> 00:13:07,279
so i started digging into it a little

390
00:13:07,279 --> 00:13:10,079
bit i haven't had a lot of time yet

391
00:13:10,079 --> 00:13:12,079
as far as i can tell there really isn't

392
00:13:12,079 --> 00:13:13,680
the same kind of monitoring or

393
00:13:13,680 --> 00:13:16,160
surveillance tools available on here but

394
00:13:16,160 --> 00:13:17,200
there are some

395
00:13:17,200 --> 00:13:18,480
some interesting things that you can

396
00:13:18,480 --> 00:13:20,800
find on here beam

397
00:13:20,800 --> 00:13:22,560
in rss mod which we'll talk about in a

398
00:13:22,560 --> 00:13:23,839
minute

399
00:13:23,839 --> 00:13:26,560
se tools which is a nice graphical

400
00:13:26,560 --> 00:13:28,240
interface for

401
00:13:28,240 --> 00:13:31,440
managing se linux and then

402
00:13:31,440 --> 00:13:33,120
probably the most curious thing is you

403
00:13:33,120 --> 00:13:34,800
run as the root user

404
00:13:34,800 --> 00:13:36,160
but you're still lacking certain

405
00:13:36,160 --> 00:13:38,719
privileges

406
00:13:39,839 --> 00:13:41,920
and this was something that really

407
00:13:41,920 --> 00:13:43,600
caused me some some headaches for a

408
00:13:43,600 --> 00:13:44,560
while

409
00:13:44,560 --> 00:13:47,120
i knew that i was the root user but when

410
00:13:47,120 --> 00:13:48,000
i started trying to dig

411
00:13:48,000 --> 00:13:49,279
through the file system i was still

412
00:13:49,279 --> 00:13:51,199
getting permission denied errors

413
00:13:51,199 --> 00:13:52,880
uh still getting these messages popping

414
00:13:52,880 --> 00:13:55,360
up asking for a password

415
00:13:55,360 --> 00:13:56,639
uh what i learned was it's actually

416
00:13:56,639 --> 00:13:59,519
using the belt libau model for enforcing

417
00:13:59,519 --> 00:14:00,880
access control

418
00:14:00,880 --> 00:14:01,920
if you're not familiar with this

419
00:14:01,920 --> 00:14:04,079
essentially the concept is you have

420
00:14:04,079 --> 00:14:07,199
various classification for different

421
00:14:07,199 --> 00:14:09,040
files and directories on your system so

422
00:14:09,040 --> 00:14:11,600
you can have secret top secret

423
00:14:11,600 --> 00:14:14,399
and that's similar styles enforcing who

424
00:14:14,399 --> 00:14:16,639
has access to things

425
00:14:16,639 --> 00:14:18,160
and essentially this is applied here so

426
00:14:18,160 --> 00:14:20,399
even though i was the root user

427
00:14:20,399 --> 00:14:21,839
i still don't have enough permissions to

428
00:14:21,839 --> 00:14:23,519
access certain things on the

429
00:14:23,519 --> 00:14:26,480
operating system

430
00:14:27,839 --> 00:14:31,199
so this is where we need to find a way

431
00:14:31,199 --> 00:14:33,920
that we can essentially escalate our

432
00:14:33,920 --> 00:14:35,199
privileges from here

433
00:14:35,199 --> 00:14:37,680
uh how do we elevate this i wasn't too

434
00:14:37,680 --> 00:14:39,839
familiar with bell lapajola

435
00:14:39,839 --> 00:14:41,440
but what i found here was i started

436
00:14:41,440 --> 00:14:43,199
googling this is actually red star in

437
00:14:43,199 --> 00:14:44,399
russian

438
00:14:44,399 --> 00:14:45,839
sometimes if you google in other

439
00:14:45,839 --> 00:14:47,920
languages you get some

440
00:14:47,920 --> 00:14:50,480
some cool things that you can find so

441
00:14:50,480 --> 00:14:51,199
this was from

442
00:14:51,199 --> 00:14:53,279
a russian forum i found people were

443
00:14:53,279 --> 00:14:55,519
sharing pictures and dvds that they were

444
00:14:55,519 --> 00:14:57,760
buying on vacation in north korea

445
00:14:57,760 --> 00:15:00,399
and putting them online i actually found

446
00:15:00,399 --> 00:15:01,199
all of the

447
00:15:01,199 --> 00:15:04,560
os manuals for red star on there

448
00:15:04,560 --> 00:15:07,839
now everything is in korean i do not

449
00:15:07,839 --> 00:15:09,199
speak korean

450
00:15:09,199 --> 00:15:11,680
google translate is very great though

451
00:15:11,680 --> 00:15:13,360
but what i found was the actual steps

452
00:15:13,360 --> 00:15:13,839
for

453
00:15:13,839 --> 00:15:16,639
how to modify my permissions for my root

454
00:15:16,639 --> 00:15:18,240
user

455
00:15:18,240 --> 00:15:19,839
everything was nicely documented in

456
00:15:19,839 --> 00:15:22,160
there it's about three manuals long

457
00:15:22,160 --> 00:15:23,120
actually

458
00:15:23,120 --> 00:15:24,880
and it does have some guides in there

459
00:15:24,880 --> 00:15:26,639
similar to the cis benchmarks if you

460
00:15:26,639 --> 00:15:28,959
want to harden your redstar server

461
00:15:28,959 --> 00:15:30,320
still working my way through these to

462
00:15:30,320 --> 00:15:32,720
see what else i can find in here

463
00:15:32,720 --> 00:15:34,639
but at this point i did have full access

464
00:15:34,639 --> 00:15:37,199
to everything

465
00:15:37,680 --> 00:15:38,959
so we started digging through a lot of

466
00:15:38,959 --> 00:15:41,519
the files on here

467
00:15:41,519 --> 00:15:42,959
start to talk about the differences

468
00:15:42,959 --> 00:15:44,800
between random and

469
00:15:44,800 --> 00:15:48,160
devious random for generating random

470
00:15:48,160 --> 00:15:48,720
numbers

471
00:15:48,720 --> 00:15:51,440
on the system

472
00:15:52,160 --> 00:15:55,680
they wrote their own method for

473
00:15:55,680 --> 00:15:57,920
blocking users so instead of using

474
00:15:57,920 --> 00:15:59,600
something like fail to ban

475
00:15:59,600 --> 00:16:01,360
uh there's actually some code in there

476
00:16:01,360 --> 00:16:02,720
that'll actually just

477
00:16:02,720 --> 00:16:05,920
block you if you fail the password a

478
00:16:05,920 --> 00:16:09,839
certain amount of times

479
00:16:10,160 --> 00:16:12,480
and really all of this this code as i

480
00:16:12,480 --> 00:16:13,759
started digging through it

481
00:16:13,759 --> 00:16:15,120
and i was able to start getting some of

482
00:16:15,120 --> 00:16:17,279
these applications running as well

483
00:16:17,279 --> 00:16:19,759
this is from the program called beam

484
00:16:19,759 --> 00:16:22,399
once i was able to get this set up now

485
00:16:22,399 --> 00:16:24,079
essentially it's just a graphical

486
00:16:24,079 --> 00:16:26,560
interface for managing your red star

487
00:16:26,560 --> 00:16:27,680
deployment

488
00:16:27,680 --> 00:16:28,800
so this is where you can start to

489
00:16:28,800 --> 00:16:31,199
configure all your services

490
00:16:31,199 --> 00:16:33,199
you can create and modify your users on

491
00:16:33,199 --> 00:16:34,240
here

492
00:16:34,240 --> 00:16:36,240
it's actually really nice kind of set up

493
00:16:36,240 --> 00:16:37,920
an interface to use

494
00:16:37,920 --> 00:16:39,440
it's pretty easy to configure your

495
00:16:39,440 --> 00:16:40,959
server from here

496
00:16:40,959 --> 00:16:42,800
and it really made it nice and easy to

497
00:16:42,800 --> 00:16:44,720
get things going once i had access to

498
00:16:44,720 --> 00:16:46,880
this

499
00:16:48,000 --> 00:16:50,399
but the other thing i found i did find a

500
00:16:50,399 --> 00:16:51,839
vulnerability in here

501
00:16:51,839 --> 00:16:53,519
uh where you can actually steal session

502
00:16:53,519 --> 00:16:55,600
information from other users

503
00:16:55,600 --> 00:16:58,320
uh so this was just my uh my site where

504
00:16:58,320 --> 00:17:00,199
i was trying to post my request to

505
00:17:00,199 --> 00:17:02,959
webhook.site i had my session id from

506
00:17:02,959 --> 00:17:04,559
another user that i created there that i

507
00:17:04,559 --> 00:17:06,079
was able to

508
00:17:06,079 --> 00:17:09,359
uh to post off to the site

509
00:17:09,359 --> 00:17:11,039
and i do have a website where i keep

510
00:17:11,039 --> 00:17:12,480
track of a lot of this uh

511
00:17:12,480 --> 00:17:14,000
try to update it a number of times a

512
00:17:14,000 --> 00:17:16,640
year i get one comment maybe every five

513
00:17:16,640 --> 00:17:18,880
years on here i posted that screenshot

514
00:17:18,880 --> 00:17:19,359
and i

515
00:17:19,359 --> 00:17:22,799
got a comment about 30 minutes later

516
00:17:22,799 --> 00:17:24,319
that they were interested in the issue

517
00:17:24,319 --> 00:17:26,240
they wanted more details

518
00:17:26,240 --> 00:17:28,400
uh they even sent me an email with one

519
00:17:28,400 --> 00:17:30,160
of the most suspicious email addresses

520
00:17:30,160 --> 00:17:31,520
i've ever seen

521
00:17:31,520 --> 00:17:33,840
and uh i still haven't actually replied

522
00:17:33,840 --> 00:17:34,880
to this one

523
00:17:34,880 --> 00:17:37,039
but i i thought it was a little a little

524
00:17:37,039 --> 00:17:38,640
curious to see this come in

525
00:17:38,640 --> 00:17:42,480
when i posted that that image

526
00:17:45,200 --> 00:17:47,520
that's a little bit of a sidetrack about

527
00:17:47,520 --> 00:17:50,640
what the red star operating system is

528
00:17:50,640 --> 00:17:52,080
but now what we want to do is we want to

529
00:17:52,080 --> 00:17:53,679
start to

530
00:17:53,679 --> 00:17:55,600
see how many domains we can find that

531
00:17:55,600 --> 00:17:58,000
are in use by north korea

532
00:17:58,000 --> 00:18:00,480
so now that we know there's uh however

533
00:18:00,480 --> 00:18:01,919
many uh

534
00:18:01,919 --> 00:18:04,480
servers online at any given time again

535
00:18:04,480 --> 00:18:05,600
roughly

536
00:18:05,600 --> 00:18:08,720
20 to 30 depending on what's accessible

537
00:18:08,720 --> 00:18:09,840
at the time

538
00:18:09,840 --> 00:18:11,919
but now we want to start to enumerate

539
00:18:11,919 --> 00:18:14,160
some of these north korean domains

540
00:18:14,160 --> 00:18:15,760
maybe we can find something outside of

541
00:18:15,760 --> 00:18:17,919
that ip space

542
00:18:17,919 --> 00:18:20,000
and really we just want to see what we

543
00:18:20,000 --> 00:18:22,480
can find

544
00:18:22,559 --> 00:18:24,320
now a couple of years ago we learned

545
00:18:24,320 --> 00:18:26,240
that there were just 28 websites

546
00:18:26,240 --> 00:18:27,679
registered to

547
00:18:27,679 --> 00:18:31,360
north korea their top level domain is kp

548
00:18:31,360 --> 00:18:33,360
there was a misconfiguration on one of

549
00:18:33,360 --> 00:18:35,760
their dns servers that allowed

550
00:18:35,760 --> 00:18:38,480
global zone transfers and so this is

551
00:18:38,480 --> 00:18:40,160
where someone found this

552
00:18:40,160 --> 00:18:42,080
and published the entire list of all the

553
00:18:42,080 --> 00:18:45,199
north korean websites

554
00:18:45,600 --> 00:18:48,719
so since that day

555
00:18:48,799 --> 00:18:52,799
i've tried to keep a list up to date

556
00:18:53,440 --> 00:18:56,160
we now know that there are 32 websites

557
00:18:56,160 --> 00:18:58,000
that are publicly accessible

558
00:18:58,000 --> 00:19:00,799
there's 34 different domains two of them

559
00:19:00,799 --> 00:19:01,679
are

560
00:19:01,679 --> 00:19:04,720
essentially duplicates

561
00:19:04,720 --> 00:19:06,880
but again we want to start to enumerate

562
00:19:06,880 --> 00:19:08,160
all of these domains

563
00:19:08,160 --> 00:19:09,520
because we want to see what else can we

564
00:19:09,520 --> 00:19:11,840
learn uh what else can we find about

565
00:19:11,840 --> 00:19:14,480
this infrastructure can we find anything

566
00:19:14,480 --> 00:19:17,520
outside of this ip space

567
00:19:17,520 --> 00:19:19,280
and this is uh another great way where

568
00:19:19,280 --> 00:19:21,760
we can use some of these various sources

569
00:19:21,760 --> 00:19:22,400
of

570
00:19:22,400 --> 00:19:24,960
open source intelligence this screenshot

571
00:19:24,960 --> 00:19:26,960
here is from air coryo which is the

572
00:19:26,960 --> 00:19:29,440
national airline of north korea and if

573
00:19:29,440 --> 00:19:30,960
you look on there the flight status on

574
00:19:30,960 --> 00:19:32,160
any given day

575
00:19:32,160 --> 00:19:34,640
everything is always on time or ahead of

576
00:19:34,640 --> 00:19:35,679
schedule

577
00:19:35,679 --> 00:19:37,840
but if you look at something like flight

578
00:19:37,840 --> 00:19:39,760
radar for example

579
00:19:39,760 --> 00:19:41,679
a lot of times it's a little bit

580
00:19:41,679 --> 00:19:43,200
different some of these flights aren't

581
00:19:43,200 --> 00:19:44,880
exactly always on time

582
00:19:44,880 --> 00:19:48,480
or even running that day

583
00:19:51,360 --> 00:19:52,640
but what do we do if we don't have

584
00:19:52,640 --> 00:19:55,039
something a nice article where we know

585
00:19:55,039 --> 00:19:57,280
all of the domains well there's a couple

586
00:19:57,280 --> 00:19:59,679
of sources of data we can turn to

587
00:19:59,679 --> 00:20:01,679
we can take the whois data and start to

588
00:20:01,679 --> 00:20:02,960
search off of that

589
00:20:02,960 --> 00:20:05,120
we can do reverse dns lookups based off

590
00:20:05,120 --> 00:20:07,120
of ip addresses

591
00:20:07,120 --> 00:20:09,600
again if i look at something like

592
00:20:09,600 --> 00:20:11,600
apple.com where i can use domains at

593
00:20:11,600 --> 00:20:13,840
apple.com

594
00:20:13,840 --> 00:20:16,480
using that to look up my whois data and

595
00:20:16,480 --> 00:20:18,720
doing some reverse dns lookups

596
00:20:18,720 --> 00:20:20,240
we can find all sorts of interesting

597
00:20:20,240 --> 00:20:22,799
domains that are owned by apple

598
00:20:22,799 --> 00:20:25,760
my favorite in there is animoji.etf a

599
00:20:25,760 --> 00:20:27,039
lot of these last i checked didn't

600
00:20:27,039 --> 00:20:28,799
really seem to be in use

601
00:20:28,799 --> 00:20:30,320
but again it gives us a good way now

602
00:20:30,320 --> 00:20:32,000
where we can start to

603
00:20:32,000 --> 00:20:33,760
maybe find some different sites maybe

604
00:20:33,760 --> 00:20:36,240
some dev instances that

605
00:20:36,240 --> 00:20:38,159
maybe shouldn't be accessible anymore or

606
00:20:38,159 --> 00:20:41,440
things that have been long forgotten

607
00:20:41,440 --> 00:20:43,120
so we can really use this data to start

608
00:20:43,120 --> 00:20:44,880
to further map out our target we're

609
00:20:44,880 --> 00:20:48,080
looking at

610
00:20:48,080 --> 00:20:49,520
uh we can also look at things like

611
00:20:49,520 --> 00:20:51,520
passive dns data there's a number of

612
00:20:51,520 --> 00:20:53,039
services out there that provide this for

613
00:20:53,039 --> 00:20:54,159
free for

614
00:20:54,159 --> 00:20:56,799
uh limited searching and again this is

615
00:20:56,799 --> 00:20:57,520
where

616
00:20:57,520 --> 00:20:59,360
now we can start to search different ap

617
00:20:59,360 --> 00:21:00,640
addresses

618
00:21:00,640 --> 00:21:02,080
and just see what kind of domains that

619
00:21:02,080 --> 00:21:04,320
are known to resolve to them as well

620
00:21:04,320 --> 00:21:07,280
based off of all these dns requests that

621
00:21:07,280 --> 00:21:08,159
are being made by

622
00:21:08,159 --> 00:21:16,480
by users around the globe

623
00:21:16,480 --> 00:21:18,080
and then we can also start to look at

624
00:21:18,080 --> 00:21:19,919
things like the certificates for our

625
00:21:19,919 --> 00:21:21,440
websites

626
00:21:21,440 --> 00:21:24,240
census is a great tool that we can use

627
00:21:24,240 --> 00:21:25,120
you can take the

628
00:21:25,120 --> 00:21:27,919
fingerprint of a certificate and you can

629
00:21:27,919 --> 00:21:29,679
search it there to see if it was reused

630
00:21:29,679 --> 00:21:32,080
anywhere

631
00:21:32,240 --> 00:21:33,600
you can also just actually read the

632
00:21:33,600 --> 00:21:36,240
certificates in the case of

633
00:21:36,240 --> 00:21:38,640
north korea we can see down the bottom

634
00:21:38,640 --> 00:21:40,080
here they actually list out where the

635
00:21:40,080 --> 00:21:41,840
certificate is being used under the alt

636
00:21:41,840 --> 00:21:42,880
names

637
00:21:42,880 --> 00:21:45,280
so i found some of the domains listed in

638
00:21:45,280 --> 00:21:46,240
there i

639
00:21:46,240 --> 00:21:47,840
haven't found anything new this way in a

640
00:21:47,840 --> 00:21:50,799
long time but it still is a nice way to

641
00:21:50,799 --> 00:21:52,480
make sure that we are

642
00:21:52,480 --> 00:21:54,240
aware of what's there and maybe what's

643
00:21:54,240 --> 00:21:58,960
not being used anymore

644
00:21:58,960 --> 00:22:00,320
and then one of my favorite things that

645
00:22:00,320 --> 00:22:02,000
was published uh this was published

646
00:22:02,000 --> 00:22:03,360
about maybe two and a half three years

647
00:22:03,360 --> 00:22:03,919
ago

648
00:22:03,919 --> 00:22:07,360
uh this is the website dprkportal.kp

649
00:22:07,360 --> 00:22:08,559
i'm always convinced that this was

650
00:22:08,559 --> 00:22:10,880
published uh in response to

651
00:22:10,880 --> 00:22:13,679
uh just trying to stay on top of all the

652
00:22:13,679 --> 00:22:15,120
active domains

653
00:22:15,120 --> 00:22:17,039
this was published by north korea where

654
00:22:17,039 --> 00:22:18,640
they actually publish a list of all of

655
00:22:18,640 --> 00:22:20,080
their websites

656
00:22:20,080 --> 00:22:21,440
and anytime there is something new

657
00:22:21,440 --> 00:22:23,120
published the last new

658
00:22:23,120 --> 00:22:25,600
site published with the top level north

659
00:22:25,600 --> 00:22:26,640
korean domain was

660
00:22:26,640 --> 00:22:29,919
in december 2020 so this was the first

661
00:22:29,919 --> 00:22:31,679
time i've ever actually seen it updated

662
00:22:31,679 --> 00:22:34,000
with a new site so it seems like they

663
00:22:34,000 --> 00:22:36,640
are keeping it up to date here

664
00:22:36,640 --> 00:22:38,080
for the most part for anything that they

665
00:22:38,080 --> 00:22:40,000
want to be publicly

666
00:22:40,000 --> 00:22:43,120
accessible and known about

667
00:22:48,400 --> 00:22:51,919
so we have a list of these domains now

668
00:22:51,919 --> 00:22:53,679
we know what's actually active inside of

669
00:22:53,679 --> 00:22:55,520
this ip space

670
00:22:55,520 --> 00:22:57,120
we know what kind of operating systems

671
00:22:57,120 --> 00:22:58,720
are running on these uh these various

672
00:22:58,720 --> 00:22:59,919
devices

673
00:22:59,919 --> 00:23:01,440
now the last thing we want to understand

674
00:23:01,440 --> 00:23:03,039
is what's actually running on these

675
00:23:03,039 --> 00:23:04,880
devices

676
00:23:04,880 --> 00:23:06,720
so in our case again there's a number of

677
00:23:06,720 --> 00:23:08,720
different ways that we can gather this

678
00:23:08,720 --> 00:23:09,919
data

679
00:23:09,919 --> 00:23:12,320
this is from some of the internet wide

680
00:23:12,320 --> 00:23:13,520
scanning sites

681
00:23:13,520 --> 00:23:15,600
this was one that's actually uh it scans

682
00:23:15,600 --> 00:23:17,120
from china

683
00:23:17,120 --> 00:23:19,360
but we can see there the banner from

684
00:23:19,360 --> 00:23:22,799
their dns servers reporting that it is

685
00:23:22,799 --> 00:23:25,679
running on red hat

686
00:23:26,159 --> 00:23:27,760
now we can find some other fun things on

687
00:23:27,760 --> 00:23:29,520
there as well i've seen things like

688
00:23:29,520 --> 00:23:30,640
vmware pop up

689
00:23:30,640 --> 00:23:33,919
from time to time i've seen media

690
00:23:33,919 --> 00:23:36,240
streaming servers pop up on there

691
00:23:36,240 --> 00:23:38,640
there is a cisco device that always

692
00:23:38,640 --> 00:23:40,000
seems to be present

693
00:23:40,000 --> 00:23:43,760
in the north korean ip space

694
00:23:44,880 --> 00:23:46,640
and again if there is something that

695
00:23:46,640 --> 00:23:48,480
maybe just doesn't make sense to us

696
00:23:48,480 --> 00:23:50,559
or maybe it's something we think this is

697
00:23:50,559 --> 00:23:52,000
maybe wrong

698
00:23:52,000 --> 00:23:53,520
we want to try to validate this data as

699
00:23:53,520 --> 00:23:55,440
much as possible so

700
00:23:55,440 --> 00:23:56,960
yes they can reference this through a

701
00:23:56,960 --> 00:23:58,799
couple of different sites and people who

702
00:23:58,799 --> 00:24:00,240
are scanning the internet

703
00:24:00,240 --> 00:24:02,480
i can verify that everyone is reporting

704
00:24:02,480 --> 00:24:04,799
this as a

705
00:24:04,799 --> 00:24:08,159
cisco ios device so i feel pretty

706
00:24:08,159 --> 00:24:09,600
confident that

707
00:24:09,600 --> 00:24:12,320
this is uh this is correct and we can

708
00:24:12,320 --> 00:24:14,080
mark this off as

709
00:24:14,080 --> 00:24:16,400
something that maybe isn't as suspicious

710
00:24:16,400 --> 00:24:17,840
as we we thought it was

711
00:24:17,840 --> 00:24:20,480
originally

712
00:24:24,000 --> 00:24:25,919
so to recap a little bit of what we

713
00:24:25,919 --> 00:24:27,360
found uh

714
00:24:27,360 --> 00:24:28,559
what's actually running on all these

715
00:24:28,559 --> 00:24:29,520
hosts we're not going to go through

716
00:24:29,520 --> 00:24:30,559
everything

717
00:24:30,559 --> 00:24:32,000
but there's a couple of different web

718
00:24:32,000 --> 00:24:34,640
servers out there your standard dns

719
00:24:34,640 --> 00:24:37,840
ntp smtp servers

720
00:24:37,840 --> 00:24:41,440
vmware server there's an ftp server

721
00:24:41,440 --> 00:24:45,760
and then a mix of red hat and red

722
00:24:45,760 --> 00:24:47,919
a couple of windows servers we have our

723
00:24:47,919 --> 00:24:49,840
one cisco device

724
00:24:49,840 --> 00:24:51,600
and then i left it at the very bottom on

725
00:24:51,600 --> 00:24:53,440
the left hand side there's 20 services

726
00:24:53,440 --> 00:24:55,360
running on port 8080

727
00:24:55,360 --> 00:24:58,480
they actually have no idea what this is

728
00:24:58,480 --> 00:25:00,480
within the last couple of weeks most of

729
00:25:00,480 --> 00:25:02,400
these actually seem to have gone away

730
00:25:02,400 --> 00:25:04,320
they were always open for a couple of

731
00:25:04,320 --> 00:25:06,879
years but

732
00:25:07,520 --> 00:25:09,120
for whatever reason they're not in use

733
00:25:09,120 --> 00:25:11,039
anymore

734
00:25:11,039 --> 00:25:13,279
i will talk about those in a minute

735
00:25:13,279 --> 00:25:14,640
about trying to see if we can find some

736
00:25:14,640 --> 00:25:16,400
more information

737
00:25:16,400 --> 00:25:17,919
but really why do we want to identify

738
00:25:17,919 --> 00:25:20,080
this information again just looking at

739
00:25:20,080 --> 00:25:22,080
some of this banner information

740
00:25:22,080 --> 00:25:23,840
maybe it's it's not the most reliable

741
00:25:23,840 --> 00:25:26,000
information but it still gives us really

742
00:25:26,000 --> 00:25:27,200
good starting point

743
00:25:27,200 --> 00:25:28,559
for understanding what's on these

744
00:25:28,559 --> 00:25:30,400
targets and what's inside this

745
00:25:30,400 --> 00:25:32,960
environment

746
00:25:36,240 --> 00:25:37,840
so like i mentioned most of what we're

747
00:25:37,840 --> 00:25:40,080
going to do is is all passive gathering

748
00:25:40,080 --> 00:25:43,440
a couple of things we do want to gather

749
00:25:43,440 --> 00:25:44,960
semi-passive this is where we're going

750
00:25:44,960 --> 00:25:46,640
to use some different websites

751
00:25:46,640 --> 00:25:48,720
uh to actually go out and maybe gather a

752
00:25:48,720 --> 00:25:50,480
bit of information for us

753
00:25:50,480 --> 00:25:52,720
uh this is something that someone sent

754
00:25:52,720 --> 00:25:53,760
last year

755
00:25:53,760 --> 00:25:55,360
one of these websites used for actually

756
00:25:55,360 --> 00:25:56,919
testing your mail server to find any

757
00:25:56,919 --> 00:25:58,720
misconfigurations

758
00:25:58,720 --> 00:26:00,480
they found this against a north korean

759
00:26:00,480 --> 00:26:02,240
mail server and they found out that it

760
00:26:02,240 --> 00:26:03,279
was actually

761
00:26:03,279 --> 00:26:07,120
operating as an open smtp relay

762
00:26:07,120 --> 00:26:09,360
apparently you could only send emails to

763
00:26:09,360 --> 00:26:12,480
any of the other top level.kp domains

764
00:26:12,480 --> 00:26:14,559
but this was something that was publicly

765
00:26:14,559 --> 00:26:15,520
accessible

766
00:26:15,520 --> 00:26:18,080
for a while

767
00:26:18,880 --> 00:26:22,480
another website we can use proxy checker

768
00:26:22,480 --> 00:26:24,880
seems like a good way to see uh maybe

769
00:26:24,880 --> 00:26:26,960
poor 8080 on some of these systems was

770
00:26:26,960 --> 00:26:27,440
uh

771
00:26:27,440 --> 00:26:30,480
functioning as a proxy in some way in

772
00:26:30,480 --> 00:26:31,120
this case

773
00:26:31,120 --> 00:26:33,120
didn't seem like that was the case i

774
00:26:33,120 --> 00:26:35,200
still don't have any idea what it is

775
00:26:35,200 --> 00:26:36,720
looking through the manuals they do talk

776
00:26:36,720 --> 00:26:39,120
about tomcat a lot and

777
00:26:39,120 --> 00:26:41,840
using board 8080 for management so my

778
00:26:41,840 --> 00:26:43,360
new guess is it's something to do with

779
00:26:43,360 --> 00:26:44,080
that

780
00:26:44,080 --> 00:26:46,720
but unfortunately those services don't

781
00:26:46,720 --> 00:26:48,559
seem to be online anymore

782
00:26:48,559 --> 00:26:50,159
so it's kind of hard to tell exactly

783
00:26:50,159 --> 00:26:53,840
what they were

784
00:26:54,080 --> 00:26:56,240
and then uh we can start to turn some

785
00:26:56,240 --> 00:26:58,320
other unusual tools as well

786
00:26:58,320 --> 00:27:00,159
we can use things like seo tools to go

787
00:27:00,159 --> 00:27:01,600
out and gather information about our

788
00:27:01,600 --> 00:27:02,640
site

789
00:27:02,640 --> 00:27:03,919
this will tell us what the site was

790
00:27:03,919 --> 00:27:06,240
built with it'll follow links

791
00:27:06,240 --> 00:27:08,320
tell us what's broken what's uh what's

792
00:27:08,320 --> 00:27:10,720
valid

793
00:27:11,360 --> 00:27:12,720
and one of the things that it found that

794
00:27:12,720 --> 00:27:14,559
i thought was pretty interesting on one

795
00:27:14,559 --> 00:27:16,720
of the north korean websites

796
00:27:16,720 --> 00:27:19,279
we can see it here down in the developer

797
00:27:19,279 --> 00:27:21,760
view there was a broken link

798
00:27:21,760 --> 00:27:26,559
that was pointing to a 172.200 address

799
00:27:26,559 --> 00:27:28,000
a couple of slides we'll talk about why

800
00:27:28,000 --> 00:27:30,720
that's kind of exciting to see

801
00:27:30,720 --> 00:27:32,000
but there's a lot of different tools we

802
00:27:32,000 --> 00:27:33,360
can use we don't have to think about our

803
00:27:33,360 --> 00:27:35,120
traditional security tools

804
00:27:35,120 --> 00:27:36,399
we can get a little creative and use

805
00:27:36,399 --> 00:27:38,640
some other things to find out some of

806
00:27:38,640 --> 00:27:39,840
this information that we might be

807
00:27:39,840 --> 00:27:42,399
looking for

808
00:27:47,360 --> 00:27:49,360
so we spent some time talking about uh

809
00:27:49,360 --> 00:27:50,399
what's running on this

810
00:27:50,399 --> 00:27:52,880
north korean public ip space uh i kind

811
00:27:52,880 --> 00:27:54,399
of wanted to flip this around though as

812
00:27:54,399 --> 00:27:55,919
i was working on this and i wanted to

813
00:27:55,919 --> 00:27:56,559
know

814
00:27:56,559 --> 00:27:58,960
uh can we find any activity of north

815
00:27:58,960 --> 00:28:02,080
korea online anywhere

816
00:28:02,080 --> 00:28:03,120
and if you're not familiar with the

817
00:28:03,120 --> 00:28:05,200
internet in north korea it started in

818
00:28:05,200 --> 00:28:07,600
2001 it was really just an email

819
00:28:07,600 --> 00:28:10,640
relay between north korea and china but

820
00:28:10,640 --> 00:28:12,159
inside of north korea there are

821
00:28:12,159 --> 00:28:14,640
essentially two different networks

822
00:28:14,640 --> 00:28:17,039
there's the intranet which is what most

823
00:28:17,039 --> 00:28:18,880
people have access to

824
00:28:18,880 --> 00:28:21,600
and then there's the official kind of

825
00:28:21,600 --> 00:28:22,880
internet for

826
00:28:22,880 --> 00:28:25,520
high-ranking party members college

827
00:28:25,520 --> 00:28:27,120
students do have access to it inside of

828
00:28:27,120 --> 00:28:28,320
north korea

829
00:28:28,320 --> 00:28:31,600
and this is access to the full internet

830
00:28:31,600 --> 00:28:33,120
uh this picture here on the right is

831
00:28:33,120 --> 00:28:34,720
taken from an internet cafe in north

832
00:28:34,720 --> 00:28:35,440
korea

833
00:28:35,440 --> 00:28:37,039
where we can see screenshots of some of

834
00:28:37,039 --> 00:28:38,720
the internal only

835
00:28:38,720 --> 00:28:41,200
north korean websites uh looking through

836
00:28:41,200 --> 00:28:42,000
flickr

837
00:28:42,000 --> 00:28:44,000
for tour groups to north korea is a

838
00:28:44,000 --> 00:28:45,679
hobby of mine

839
00:28:45,679 --> 00:28:47,360
this is actually where i found this on a

840
00:28:47,360 --> 00:28:49,200
flickr page where someone had taken this

841
00:28:49,200 --> 00:28:50,000
picture

842
00:28:50,000 --> 00:28:51,679
and i cropped it a little bit to make it

843
00:28:51,679 --> 00:28:53,520
a little bit easier to see

844
00:28:53,520 --> 00:28:55,360
but there's again a lot of different

845
00:28:55,360 --> 00:28:57,279
places we can turn to

846
00:28:57,279 --> 00:28:59,679
to find some of this information that

847
00:28:59,679 --> 00:29:03,279
maybe we don't always have access to

848
00:29:05,760 --> 00:29:07,760
now some of the domains they do actually

849
00:29:07,760 --> 00:29:10,240
come up from time to time if you are

850
00:29:10,240 --> 00:29:12,559
researching north korea domains a couple

851
00:29:12,559 --> 00:29:14,799
of them here are on the left-hand side

852
00:29:14,799 --> 00:29:17,520
none of them are publicly accessible uh

853
00:29:17,520 --> 00:29:19,279
but i've talked to a few people

854
00:29:19,279 --> 00:29:20,799
where they seem to think that they are

855
00:29:20,799 --> 00:29:22,480
used internally for

856
00:29:22,480 --> 00:29:24,799
uh email one of them is a portal used

857
00:29:24,799 --> 00:29:26,640
inside the

858
00:29:26,640 --> 00:29:29,840
hotel for accessing the internet

859
00:29:29,840 --> 00:29:31,440
and then the other third one seems to be

860
00:29:31,440 --> 00:29:34,640
a social network of some kind

861
00:29:34,640 --> 00:29:41,840
inside of north korea as well

862
00:29:43,200 --> 00:29:44,799
and really uh one of the other things

863
00:29:44,799 --> 00:29:46,399
that kind of prompted this idea of can

864
00:29:46,399 --> 00:29:47,120
we find

865
00:29:47,120 --> 00:29:48,720
uh north korea online or any kind of

866
00:29:48,720 --> 00:29:50,799
activity uh this is a map steam

867
00:29:50,799 --> 00:29:52,720
published a number of years ago

868
00:29:52,720 --> 00:29:55,120
showing where all of their their users

869
00:29:55,120 --> 00:29:56,799
were connecting from

870
00:29:56,799 --> 00:29:59,360
um if you look really closely there in

871
00:29:59,360 --> 00:30:00,240
the circle

872
00:30:00,240 --> 00:30:03,360
you'll see one dot inside of north korea

873
00:30:03,360 --> 00:30:05,600
so i was really curious to see can we

874
00:30:05,600 --> 00:30:09,840
find any north korean activity online

875
00:30:09,840 --> 00:30:11,919
so one of the first things they did was

876
00:30:11,919 --> 00:30:12,960
just using

877
00:30:12,960 --> 00:30:14,880
some of these different google doors to

878
00:30:14,880 --> 00:30:16,480
search for

879
00:30:16,480 --> 00:30:18,320
different things this one's actually

880
00:30:18,320 --> 00:30:20,159
pretty simple we're just searching for

881
00:30:20,159 --> 00:30:22,640
a any of the log files that google might

882
00:30:22,640 --> 00:30:24,000
have indexed

883
00:30:24,000 --> 00:30:25,600
just searching for different ip

884
00:30:25,600 --> 00:30:27,039
addresses

885
00:30:27,039 --> 00:30:29,840
so this was on a russian oil website i

886
00:30:29,840 --> 00:30:30,720
found

887
00:30:30,720 --> 00:30:32,320
some north korean ip addresses that were

888
00:30:32,320 --> 00:30:36,640
browsing this site

889
00:30:36,640 --> 00:30:38,640
uh i'm sure everyone knows about public

890
00:30:38,640 --> 00:30:41,039
pastes uh pasteban any of these sites

891
00:30:41,039 --> 00:30:43,440
where we can search information uh this

892
00:30:43,440 --> 00:30:44,080
was it

893
00:30:44,080 --> 00:30:46,559
looked like it's from a minecraft server

894
00:30:46,559 --> 00:30:47,600
uh but there was a

895
00:30:47,600 --> 00:30:49,279
user that was connecting from an ip

896
00:30:49,279 --> 00:30:53,600
address inside of north korea

897
00:30:55,120 --> 00:30:57,200
you can also search wikipedia especially

898
00:30:57,200 --> 00:30:58,640
since i've talked about it a lot

899
00:30:58,640 --> 00:31:00,880
now if you don't have an account it'll

900
00:31:00,880 --> 00:31:02,799
record your ip address

901
00:31:02,799 --> 00:31:03,840
so we can see where there were some

902
00:31:03,840 --> 00:31:05,919
changes made to

903
00:31:05,919 --> 00:31:08,559
different books some of them were for

904
00:31:08,559 --> 00:31:10,480
content management system

905
00:31:10,480 --> 00:31:12,000
uh there's actually a lot of changes

906
00:31:12,000 --> 00:31:13,919
coming out of north korea they seem to

907
00:31:13,919 --> 00:31:15,840
have stopped about four years ago maybe

908
00:31:15,840 --> 00:31:18,480
five years ago at this point but

909
00:31:18,480 --> 00:31:19,919
we can see some activity there from

910
00:31:19,919 --> 00:31:22,000
north korean ip addresses

911
00:31:22,000 --> 00:31:23,919
making some changes to these different

912
00:31:23,919 --> 00:31:27,120
wikipedia articles

913
00:31:31,120 --> 00:31:33,039
and again we want to get creative with

914
00:31:33,039 --> 00:31:35,120
our searching uh this is a website

915
00:31:35,120 --> 00:31:37,279
called i know what you download.com

916
00:31:37,279 --> 00:31:39,440
where they're essentially just

917
00:31:39,440 --> 00:31:41,039
monitoring all these uh

918
00:31:41,039 --> 00:31:43,279
torrent trackers and all the ip

919
00:31:43,279 --> 00:31:45,279
addresses that are connecting

920
00:31:45,279 --> 00:31:46,799
they have a nice interface that you can

921
00:31:46,799 --> 00:31:49,600
use to kind of search this data

922
00:31:49,600 --> 00:31:51,279
so these were some of the top movies in

923
00:31:51,279 --> 00:31:53,519
north korea my modern family is actually

924
00:31:53,519 --> 00:31:56,480
really popular there

925
00:31:56,559 --> 00:31:58,000
but one of the things they did was i

926
00:31:58,000 --> 00:32:00,000
wrote a script to just

927
00:32:00,000 --> 00:32:02,000
query i know what you download to find

928
00:32:02,000 --> 00:32:03,840
any north korean ip addresses that were

929
00:32:03,840 --> 00:32:05,600
active and torrenting

930
00:32:05,600 --> 00:32:07,360
and then i went in and started searching

931
00:32:07,360 --> 00:32:09,200
based off of these

932
00:32:09,200 --> 00:32:10,880
again what's interesting is we see a lot

933
00:32:10,880 --> 00:32:13,679
of it coming out of the 76 177 and

934
00:32:13,679 --> 00:32:17,360
178 networks but what i thought was even

935
00:32:17,360 --> 00:32:18,799
more interesting was

936
00:32:18,799 --> 00:32:21,360
looking into not just the the movies and

937
00:32:21,360 --> 00:32:23,360
tv shows being downloaded

938
00:32:23,360 --> 00:32:25,600
but things like device drivers we can

939
00:32:25,600 --> 00:32:28,240
see different uh graphics cards in there

940
00:32:28,240 --> 00:32:30,559
devices for cameras and different types

941
00:32:30,559 --> 00:32:32,720
of laptops

942
00:32:32,720 --> 00:32:34,240
so it's a good way where we can maybe

943
00:32:34,240 --> 00:32:35,840
get an idea of some of the other devices

944
00:32:35,840 --> 00:32:37,440
inside the country

945
00:32:37,440 --> 00:32:39,919
that maybe we we don't have first-hand

946
00:32:39,919 --> 00:32:41,760
access to see from

947
00:32:41,760 --> 00:32:43,679
different pictures or things like that

948
00:32:43,679 --> 00:32:46,480
being published

949
00:32:50,000 --> 00:32:51,760
and then since i had a list of all of

950
00:32:51,760 --> 00:32:54,080
the north korean domains

951
00:32:54,080 --> 00:32:56,240
i got the idea what happens if uh since

952
00:32:56,240 --> 00:32:58,720
most of them are dot com.kp or dot org

953
00:32:58,720 --> 00:33:01,360
ap uh what happens if i bought just the

954
00:33:01,360 --> 00:33:03,039
dot com version

955
00:33:03,039 --> 00:33:05,279
uh so i had i found two north korean

956
00:33:05,279 --> 00:33:06,799
domains that were available

957
00:33:06,799 --> 00:33:09,360
i bought those i found one that was in

958
00:33:09,360 --> 00:33:11,200
the os manual

959
00:33:11,200 --> 00:33:12,880
that was listed in there that was

960
00:33:12,880 --> 00:33:14,720
available and then

961
00:33:14,720 --> 00:33:16,480
one of them kept popping up in different

962
00:33:16,480 --> 00:33:17,919
thread intel feeds

963
00:33:17,919 --> 00:33:19,279
from a couple of years ago and it

964
00:33:19,279 --> 00:33:21,279
actually just became available

965
00:33:21,279 --> 00:33:24,080
so i bought that as well i don't want to

966
00:33:24,080 --> 00:33:24,640
say

967
00:33:24,640 --> 00:33:27,519
what i bought but just threw some google

968
00:33:27,519 --> 00:33:28,960
analytics on it just to see if i would

969
00:33:28,960 --> 00:33:31,039
get anyone connecting to it

970
00:33:31,039 --> 00:33:33,120
and they did get some traffic over the

971
00:33:33,120 --> 00:33:36,399
last uh year year and a half

972
00:33:36,399 --> 00:33:38,799
no traffic from north korea and these

973
00:33:38,799 --> 00:33:40,159
domains aren't something that you can

974
00:33:40,159 --> 00:33:41,840
accidentally just type in

975
00:33:41,840 --> 00:33:44,080
i'm assuming you would have to really go

976
00:33:44,080 --> 00:33:45,600
here on purpose

977
00:33:45,600 --> 00:33:47,279
so it was interesting to see some of the

978
00:33:47,279 --> 00:33:49,120
connections that were coming in

979
00:33:49,120 --> 00:33:53,840
to these domains that i bought

980
00:33:56,559 --> 00:33:58,320
and then lastly as we are trying to

981
00:33:58,320 --> 00:34:00,240
understand can we find

982
00:34:00,240 --> 00:34:03,519
north korea online this is an article i

983
00:34:03,519 --> 00:34:04,880
saw last year about

984
00:34:04,880 --> 00:34:07,200
linkedin becoming a social media of

985
00:34:07,200 --> 00:34:09,359
choice for north korea's elite

986
00:34:09,359 --> 00:34:11,040
i haven't gotten any friend requests on

987
00:34:11,040 --> 00:34:13,599
there as far as i know

988
00:34:13,599 --> 00:34:16,239
but we can find a lot of things on

989
00:34:16,239 --> 00:34:18,320
social media that maybe we shouldn't

990
00:34:18,320 --> 00:34:21,440
be posting i've found things like

991
00:34:21,440 --> 00:34:23,280
people's badge and their schedule and

992
00:34:23,280 --> 00:34:25,119
information that they've post

993
00:34:25,119 --> 00:34:27,599
hashtag new job is a great way to find

994
00:34:27,599 --> 00:34:30,399
information about different companies

995
00:34:30,399 --> 00:34:32,639
uh hashtag visitor badge is another fun

996
00:34:32,639 --> 00:34:33,440
one

997
00:34:33,440 --> 00:34:34,800
i guess people are really excited about

998
00:34:34,800 --> 00:34:36,879
that they post their video badges from

999
00:34:36,879 --> 00:34:37,839
different companies

1000
00:34:37,839 --> 00:34:40,799
when they go to visit

1001
00:34:41,280 --> 00:34:44,320
so what can we find about north korea

1002
00:34:44,320 --> 00:34:46,960
well there is a brewery inside of north

1003
00:34:46,960 --> 00:34:47,440
korea

1004
00:34:47,440 --> 00:34:51,199
apparently they're working on mini kegs

1005
00:34:51,199 --> 00:34:53,679
this is a manual inside of the north

1006
00:34:53,679 --> 00:34:54,960
korean hotel

1007
00:34:54,960 --> 00:34:57,440
that i always just giggle when i read

1008
00:34:57,440 --> 00:34:59,920
the title

1009
00:35:00,160 --> 00:35:02,560
i've found things like visas long-term

1010
00:35:02,560 --> 00:35:03,680
stay cards

1011
00:35:03,680 --> 00:35:07,759
for people going to visit on tours

1012
00:35:08,400 --> 00:35:09,680
and then one of my favorite ones the

1013
00:35:09,680 --> 00:35:11,680
palace of the sun if you go on a tour of

1014
00:35:11,680 --> 00:35:12,960
north korea

1015
00:35:12,960 --> 00:35:14,240
this is somewhere that they'll take you

1016
00:35:14,240 --> 00:35:15,440
and they they stress that you're not

1017
00:35:15,440 --> 00:35:16,720
allowed to take pictures

1018
00:35:16,720 --> 00:35:18,400
uh for that you have to take your shoes

1019
00:35:18,400 --> 00:35:19,920
off you go through the

1020
00:35:19,920 --> 00:35:21,359
uh the machines that kind of blow all

1021
00:35:21,359 --> 00:35:23,760
the dust particles off of you

1022
00:35:23,760 --> 00:35:25,680
but it's actually geotagged on instagram

1023
00:35:25,680 --> 00:35:27,520
uh someone's taking some sneaky pictures

1024
00:35:27,520 --> 00:35:28,640
in there

1025
00:35:28,640 --> 00:35:31,040
so again even in a country like north

1026
00:35:31,040 --> 00:35:31,839
korea where

1027
00:35:31,839 --> 00:35:34,079
cameras aren't allowed in certain places

1028
00:35:34,079 --> 00:35:35,680
uh we can still

1029
00:35:35,680 --> 00:35:37,359
find some information and get an idea of

1030
00:35:37,359 --> 00:35:39,839
what's there

1031
00:35:41,040 --> 00:35:43,119
but we can also look at things like

1032
00:35:43,119 --> 00:35:45,040
what's running on their computers

1033
00:35:45,040 --> 00:35:47,440
if you look in the background you see

1034
00:35:47,440 --> 00:35:49,280
that windows xp is still very popular

1035
00:35:49,280 --> 00:35:52,240
inside of north korea

1036
00:35:52,320 --> 00:35:53,920
and again we want to verify our

1037
00:35:53,920 --> 00:35:55,760
information as much as possible

1038
00:35:55,760 --> 00:35:58,079
this comes from the official north

1039
00:35:58,079 --> 00:36:00,160
korean media website

1040
00:36:00,160 --> 00:36:01,680
and other pictures look just a little

1041
00:36:01,680 --> 00:36:04,160
too perfect in the background

1042
00:36:04,160 --> 00:36:06,079
so we can use a website like photo

1043
00:36:06,079 --> 00:36:09,040
forensics which we'll try to highlight

1044
00:36:09,040 --> 00:36:10,560
anything that's essentially any kind of

1045
00:36:10,560 --> 00:36:12,160
errors in the picture

1046
00:36:12,160 --> 00:36:13,760
so it seems like a lot of times pictures

1047
00:36:13,760 --> 00:36:15,280
are just posted onto that generic

1048
00:36:15,280 --> 00:36:16,560
background

1049
00:36:16,560 --> 00:36:19,119
to make it look a little a little more

1050
00:36:19,119 --> 00:36:21,440
bright and blue skies and sunshine

1051
00:36:21,440 --> 00:36:27,839
for a lot of these outdoor pictures

1052
00:36:29,119 --> 00:36:31,440
and we can also start to turn to some

1053
00:36:31,440 --> 00:36:32,720
different places as well

1054
00:36:32,720 --> 00:36:35,040
uh strava is a fitness tracker similar

1055
00:36:35,040 --> 00:36:36,560
to fitbit

1056
00:36:36,560 --> 00:36:39,119
they actually publish all their data

1057
00:36:39,119 --> 00:36:40,640
online

1058
00:36:40,640 --> 00:36:42,320
so if you want to find new places to run

1059
00:36:42,320 --> 00:36:44,079
or hike is the idea

1060
00:36:44,079 --> 00:36:45,920
when i found out about this i

1061
00:36:45,920 --> 00:36:47,359
immediately started browsing through

1062
00:36:47,359 --> 00:36:48,800
north korea

1063
00:36:48,800 --> 00:36:50,800
we can actually see some of the actual

1064
00:36:50,800 --> 00:36:52,320
lines on here where

1065
00:36:52,320 --> 00:36:54,160
assuming people are going on tours in

1066
00:36:54,160 --> 00:36:55,520
the country

1067
00:36:55,520 --> 00:36:57,280
um and if you really zoom in you can

1068
00:36:57,280 --> 00:36:59,040
start to see individual buildings that

1069
00:36:59,040 --> 00:37:00,560
they're going into

1070
00:37:00,560 --> 00:37:02,240
the next thing i want to do is start to

1071
00:37:02,240 --> 00:37:03,839
overlay this with something like google

1072
00:37:03,839 --> 00:37:05,839
maps to see if we can get an idea of

1073
00:37:05,839 --> 00:37:09,359
what these buildings actually are

1074
00:37:09,359 --> 00:37:12,079
but one of the things i also noticed was

1075
00:37:12,079 --> 00:37:13,680
in the north there's two very faint

1076
00:37:13,680 --> 00:37:15,359
lines in these mountains

1077
00:37:15,359 --> 00:37:16,880
and i was really curious to know what

1078
00:37:16,880 --> 00:37:18,720
these were so i

1079
00:37:18,720 --> 00:37:20,160
switched over to google using these

1080
00:37:20,160 --> 00:37:22,000
coordinates looks like

1081
00:37:22,000 --> 00:37:25,280
it's some kind of ski lodge here

1082
00:37:25,280 --> 00:37:26,720
but the interesting thing is it's not

1083
00:37:26,720 --> 00:37:28,160
the one that's shown in most of the

1084
00:37:28,160 --> 00:37:29,200
official

1085
00:37:29,200 --> 00:37:32,640
uh north korean media which is this uh

1086
00:37:32,640 --> 00:37:35,359
looks like it's a different one so you

1087
00:37:35,359 --> 00:37:36,880
haven't found too much information about

1088
00:37:36,880 --> 00:37:37,599
that

1089
00:37:37,599 --> 00:37:39,680
but again just different ways where we

1090
00:37:39,680 --> 00:37:41,520
can find some of these

1091
00:37:41,520 --> 00:37:42,960
new things that we can investigate

1092
00:37:42,960 --> 00:37:45,359
further

1093
00:37:46,880 --> 00:37:48,960
and then as we start to wrap this up

1094
00:37:48,960 --> 00:37:50,000
silly vaccine

1095
00:37:50,000 --> 00:37:51,760
is another one that's interesting this

1096
00:37:51,760 --> 00:37:54,480
is a north korean anti-virus program

1097
00:37:54,480 --> 00:37:57,920
checkpoint did a great paper on this

1098
00:37:57,920 --> 00:38:00,000
but one of the things that i found was

1099
00:38:00,000 --> 00:38:01,920
if we look back to github

1100
00:38:01,920 --> 00:38:04,000
the shadow brokers leak the the cia

1101
00:38:04,000 --> 00:38:05,200
tools

1102
00:38:05,200 --> 00:38:06,880
a lot of people mirrored these tools to

1103
00:38:06,880 --> 00:38:08,800
github and the source for them

1104
00:38:08,800 --> 00:38:11,280
but as i started searching some of the

1105
00:38:11,280 --> 00:38:12,880
silly vaccine strings

1106
00:38:12,880 --> 00:38:15,280
i found that they are actually in use in

1107
00:38:15,280 --> 00:38:17,760
the shadow brokers leak as well

1108
00:38:17,760 --> 00:38:18,960
so some of these tools are actually

1109
00:38:18,960 --> 00:38:20,880
scanning the endpoint to see

1110
00:38:20,880 --> 00:38:22,240
what kind of protections running on

1111
00:38:22,240 --> 00:38:24,880
there so it appears that

1112
00:38:24,880 --> 00:38:27,440
whoever is building these tools is aware

1113
00:38:27,440 --> 00:38:29,599
of silly vaccine inside of north korea

1114
00:38:29,599 --> 00:38:31,119
and actually checking for that to see if

1115
00:38:31,119 --> 00:38:32,960
it's present before

1116
00:38:32,960 --> 00:38:35,040
executing the next step of their their

1117
00:38:35,040 --> 00:38:37,520
programs

1118
00:38:39,280 --> 00:38:41,520
we've also found some other fun things

1119
00:38:41,520 --> 00:38:43,280
this is on a north korean website

1120
00:38:43,280 --> 00:38:45,440
looking at the source

1121
00:38:45,440 --> 00:38:47,280
we can start to find uh just different

1122
00:38:47,280 --> 00:38:48,880
fonts being used

1123
00:38:48,880 --> 00:38:50,400
and when i googled those i found out

1124
00:38:50,400 --> 00:38:53,200
they are north korean fonts

1125
00:38:53,200 --> 00:38:55,680
developed inside the country but i've

1126
00:38:55,680 --> 00:38:56,720
also found

1127
00:38:56,720 --> 00:39:00,480
on different sandboxes where those

1128
00:39:00,480 --> 00:39:03,280
fonts are available and i really just

1129
00:39:03,280 --> 00:39:05,040
always love this comment no idea what it

1130
00:39:05,040 --> 00:39:07,920
is i found it on my laptop

1131
00:39:07,920 --> 00:39:09,280
haven't looked into it more personally

1132
00:39:09,280 --> 00:39:10,960
have no idea if it is anything related

1133
00:39:10,960 --> 00:39:12,400
to north korea or if they're just using

1134
00:39:12,400 --> 00:39:13,680
that font

1135
00:39:13,680 --> 00:39:15,599
but again different ways where we can

1136
00:39:15,599 --> 00:39:17,839
start to maybe find some new things to

1137
00:39:17,839 --> 00:39:20,480
investigate

1138
00:39:20,800 --> 00:39:22,640
and as we are looking at this different

1139
00:39:22,640 --> 00:39:24,640
pieces of software

1140
00:39:24,640 --> 00:39:27,359
a lot of times sandboxes different

1141
00:39:27,359 --> 00:39:28,480
things like that

1142
00:39:28,480 --> 00:39:30,320
a lot of people aren't aware that this

1143
00:39:30,320 --> 00:39:32,640
information is publicly searchable

1144
00:39:32,640 --> 00:39:35,280
so this is how i've found a lot of north

1145
00:39:35,280 --> 00:39:36,720
korean software online just

1146
00:39:36,720 --> 00:39:38,800
searching the name then i have a hash

1147
00:39:38,800 --> 00:39:41,200
and more information about it

1148
00:39:41,200 --> 00:39:42,720
gives me all sorts of new rabbit holes

1149
00:39:42,720 --> 00:39:44,400
to go down to try to find a lot of this

1150
00:39:44,400 --> 00:39:45,680
software

1151
00:39:45,680 --> 00:39:47,280
but just starting with some basic

1152
00:39:47,280 --> 00:39:50,000
information we can really start to

1153
00:39:50,000 --> 00:39:52,079
get a lot more information about what

1154
00:39:52,079 --> 00:39:56,160
this software is

1155
00:39:56,160 --> 00:39:57,920
uh so i want to start to wrap this up

1156
00:39:57,920 --> 00:39:59,280
here a little bit

1157
00:39:59,280 --> 00:40:01,720
a lot of people ask what i use for tools

1158
00:40:01,720 --> 00:40:03,760
osintframework.com is a nice tree that

1159
00:40:03,760 --> 00:40:05,200
we can use to really search all this

1160
00:40:05,200 --> 00:40:07,200
data

1161
00:40:07,200 --> 00:40:08,839
i have a website

1162
00:40:08,839 --> 00:40:10,480
nkinternet.wordpress.com

1163
00:40:10,480 --> 00:40:13,119
i try to keep it sort of up to date as i

1164
00:40:13,119 --> 00:40:14,800
find new things

1165
00:40:14,800 --> 00:40:16,560
uh and one last thing i want to end on

1166
00:40:16,560 --> 00:40:18,000
here this is a

1167
00:40:18,000 --> 00:40:19,440
website that i found a couple of years

1168
00:40:19,440 --> 00:40:21,440
ago i found it

1169
00:40:21,440 --> 00:40:23,599
early on a sunday morning i was looking

1170
00:40:23,599 --> 00:40:24,960
at this it seems

1171
00:40:24,960 --> 00:40:26,720
pretty uh pretty interesting signature

1172
00:40:26,720 --> 00:40:28,319
of this detection system in the top

1173
00:40:28,319 --> 00:40:31,040
command and control server and as i was

1174
00:40:31,040 --> 00:40:33,359
looking this i got a phone call

1175
00:40:33,359 --> 00:40:35,200
the number was zero zero zero zero zero

1176
00:40:35,200 --> 00:40:37,520
zero zero i picked up said hello and

1177
00:40:37,520 --> 00:40:39,520
nobody was there granted it was six in

1178
00:40:39,520 --> 00:40:40,640
the morning at the time when i was

1179
00:40:40,640 --> 00:40:42,079
looking at this

1180
00:40:42,079 --> 00:40:44,960
so i put my phone down phone rings again

1181
00:40:44,960 --> 00:40:46,800
a few minutes later same number

1182
00:40:46,800 --> 00:40:48,880
no one's on the end of the line i start

1183
00:40:48,880 --> 00:40:50,240
thinking that i need to

1184
00:40:50,240 --> 00:40:51,920
pack up my house i need to wake up my

1185
00:40:51,920 --> 00:40:53,359
wife we need to move

1186
00:40:53,359 --> 00:40:56,160
outside the country as i'm pacing the

1187
00:40:56,160 --> 00:40:57,599
room a little bit trying to figure out

1188
00:40:57,599 --> 00:40:59,359
if these phone calls and if this website

1189
00:40:59,359 --> 00:41:00,240
is related

1190
00:41:00,240 --> 00:41:01,839
i get a third phone call from the same

1191
00:41:01,839 --> 00:41:03,599
number

1192
00:41:03,599 --> 00:41:06,000
zero zero zero zero zero zero uh they

1193
00:41:06,000 --> 00:41:07,599
pick up they say hello hello

1194
00:41:07,599 --> 00:41:10,640
uh someone says mr roy

1195
00:41:10,640 --> 00:41:13,839
yes i said uh mr roy uh this is steve

1196
00:41:13,839 --> 00:41:15,359
from enterprise sorry our phone system

1197
00:41:15,359 --> 00:41:16,240
isn't working

1198
00:41:16,240 --> 00:41:17,599
they've been trying to tell you that

1199
00:41:17,599 --> 00:41:19,440
your rental car is ready

1200
00:41:19,440 --> 00:41:22,640
thanks steve for the heart attack again

1201
00:41:22,640 --> 00:41:24,000
always interesting things that you can

1202
00:41:24,000 --> 00:41:25,760
find he did actually reach out because

1203
00:41:25,760 --> 00:41:27,440
there was a certificate to see if they

1204
00:41:27,440 --> 00:41:29,040
had any information

1205
00:41:29,040 --> 00:41:30,400
they told me that they're not a software

1206
00:41:30,400 --> 00:41:32,160
company

1207
00:41:32,160 --> 00:41:34,000
could be a whole conspiracy theory still

1208
00:41:34,000 --> 00:41:35,359
not too sure on that

1209
00:41:35,359 --> 00:41:37,200
uh but again always keeps me up at night

1210
00:41:37,200 --> 00:41:38,400
wondering what this was

1211
00:41:38,400 --> 00:41:41,440
uh it's not online anymore uh but thank

1212
00:41:41,440 --> 00:41:42,720
you everyone for listening

1213
00:41:42,720 --> 00:41:44,640
i had a great time presenting uh

1214
00:41:44,640 --> 00:41:46,720
certainly any questions feel free to

1215
00:41:46,720 --> 00:41:48,640
reach out or always happy to talk more

1216
00:41:48,640 --> 00:41:49,920
about this and share

1217
00:41:49,920 --> 00:41:52,480
any other kind of data or information

1218
00:41:52,480 --> 00:41:53,440
that i have so

1219
00:41:53,440 --> 00:42:03,200
thank you very much

