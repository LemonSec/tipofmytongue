1
00:00:01,120 --> 00:00:04,080
so hello everyone i'm sarah and i'm one

2
00:00:04,080 --> 00:00:04,839
of the

3
00:00:04,839 --> 00:00:08,559
co-organizers of the top 20 secure plc

4
00:00:08,559 --> 00:00:10,639
coding practices project

5
00:00:10,639 --> 00:00:14,880
and vivek ponata my co-organizer and i

6
00:00:14,880 --> 00:00:16,800
will give you an introduction

7
00:00:16,800 --> 00:00:18,560
to our project today and why it's

8
00:00:18,560 --> 00:00:19,840
important and

9
00:00:19,840 --> 00:00:24,000
to why we did it and how we did it

10
00:00:24,000 --> 00:00:26,240
well the secure coding practice project

11
00:00:26,240 --> 00:00:28,400
project is about

12
00:00:28,400 --> 00:00:30,400
writing secure coding practices for

13
00:00:30,400 --> 00:00:31,519
plc's

14
00:00:31,519 --> 00:00:34,079
so for programmable logic logic

15
00:00:34,079 --> 00:00:35,440
controllers

16
00:00:35,440 --> 00:00:39,680
and it actually was sparked or inspired

17
00:00:39,680 --> 00:00:40,640
by

18
00:00:40,640 --> 00:00:43,280
jake brodsky who gave a presentation at

19
00:00:43,280 --> 00:00:44,399
s4

20
00:00:44,399 --> 00:00:48,160
in 2020 in miami and the presentation

21
00:00:48,160 --> 00:00:50,320
was on secure plc programming

22
00:00:50,320 --> 00:00:52,559
obviously and on a few hints and tips

23
00:00:52,559 --> 00:00:53,520
and tricks

24
00:00:53,520 --> 00:00:55,440
how someone who's been working in the

25
00:00:55,440 --> 00:00:58,239
field for a lot of years uh

26
00:00:58,239 --> 00:01:01,760
programs of pse to be more reliable more

27
00:01:01,760 --> 00:01:05,040
um and and more secure in the end

28
00:01:05,040 --> 00:01:06,960
the video is available on youtube and

29
00:01:06,960 --> 00:01:10,000
it's become a classic by now

30
00:01:10,000 --> 00:01:13,119
and after this talk um

31
00:01:13,119 --> 00:01:15,600
a couple of people came together and

32
00:01:15,600 --> 00:01:17,040
said well we need to make something out

33
00:01:17,040 --> 00:01:17,759
of it

34
00:01:17,759 --> 00:01:20,320
because one of jake's main statements

35
00:01:20,320 --> 00:01:21,680
was

36
00:01:21,680 --> 00:01:24,479
secure plc programming really no one

37
00:01:24,479 --> 00:01:26,560
knows this at school and what he meant

38
00:01:26,560 --> 00:01:27,920
was that the engineers

39
00:01:27,920 --> 00:01:30,960
who program plc's do not learn anything

40
00:01:30,960 --> 00:01:32,560
about security at school

41
00:01:32,560 --> 00:01:35,119
first but then also they don't learn

42
00:01:35,119 --> 00:01:36,159
anything about

43
00:01:36,159 --> 00:01:39,680
how to securely program a psc at school

44
00:01:39,680 --> 00:01:42,399
and the simple reason for this is was

45
00:01:42,399 --> 00:01:43,439
that

46
00:01:43,439 --> 00:01:47,040
there is nothing to teach because unlike

47
00:01:47,040 --> 00:01:49,920
for normal i.t software where we have a

48
00:01:49,920 --> 00:01:50,479
lot of

49
00:01:50,479 --> 00:01:52,720
secure practices coding principles

50
00:01:52,720 --> 00:01:55,600
secure coding practices

51
00:01:55,600 --> 00:01:57,600
published by microsoft published by

52
00:01:57,600 --> 00:01:58,640
universities

53
00:01:58,640 --> 00:02:02,320
that are normal to learn for programmers

54
00:02:02,320 --> 00:02:04,960
for prc there is nothing you could teach

55
00:02:04,960 --> 00:02:05,680
there are no

56
00:02:05,680 --> 00:02:08,239
secure prc program practice programming

57
00:02:08,239 --> 00:02:09,758
practices

58
00:02:09,758 --> 00:02:11,599
and after that talk a couple of people

59
00:02:11,599 --> 00:02:13,440
said okay let's change that different by

60
00:02:13,440 --> 00:02:16,560
dave peterson who's organizing s4

61
00:02:16,560 --> 00:02:19,280
we said okay let's create something from

62
00:02:19,280 --> 00:02:20,400
a community

63
00:02:20,400 --> 00:02:23,599
from engineers for engineers

64
00:02:23,599 --> 00:02:26,239
and let's try to define how to securely

65
00:02:26,239 --> 00:02:26,720
program

66
00:02:26,720 --> 00:02:30,560
a plc and the reason why it was

67
00:02:30,560 --> 00:02:31,519
important

68
00:02:31,519 --> 00:02:33,840
was pretty obvious because we all knew

69
00:02:33,840 --> 00:02:35,599
for at least a decade

70
00:02:35,599 --> 00:02:38,720
maybe even longer that plc's

71
00:02:38,720 --> 00:02:42,319
are vulnerable there was a a project at

72
00:02:42,319 --> 00:02:44,000
a sport called project base camp

73
00:02:44,000 --> 00:02:46,800
uh about a decade ago showing plc

74
00:02:46,800 --> 00:02:48,720
vulnerabilities and a lot of things have

75
00:02:48,720 --> 00:02:49,599
followed

76
00:02:49,599 --> 00:02:52,959
for virtually all plc vendors their

77
00:02:52,959 --> 00:02:55,760
plc's are are insecure by design and

78
00:02:55,760 --> 00:02:56,400
that's

79
00:02:56,400 --> 00:02:58,560
not always used to be a bad thing

80
00:02:58,560 --> 00:02:59,599
because somehow

81
00:02:59,599 --> 00:03:02,159
some parts of these psc vulnerabilities

82
00:03:02,159 --> 00:03:03,200
are actually plc

83
00:03:03,200 --> 00:03:06,400
features they just haven't been uh built

84
00:03:06,400 --> 00:03:08,720
and programmed with security in mind so

85
00:03:08,720 --> 00:03:09,200
it's no

86
00:03:09,200 --> 00:03:11,760
no surprise that they're vulnerable and

87
00:03:11,760 --> 00:03:12,959
all these

88
00:03:12,959 --> 00:03:15,920
um advisories and all these news that

89
00:03:15,920 --> 00:03:18,480
there are new variables found in plcs

90
00:03:18,480 --> 00:03:20,000
keep coming

91
00:03:20,000 --> 00:03:24,720
leaving engineers more or less

92
00:03:24,720 --> 00:03:27,599
in despair or at least with nowhere to

93
00:03:27,599 --> 00:03:29,280
start because

94
00:03:29,280 --> 00:03:30,959
all these vulnerabilities keep coming

95
00:03:30,959 --> 00:03:32,799
but we don't really

96
00:03:32,799 --> 00:03:36,560
develop things a a so what so we develop

97
00:03:36,560 --> 00:03:38,560
ideas how to fix certain vulnerability

98
00:03:38,560 --> 00:03:40,400
we don't really develop something

99
00:03:40,400 --> 00:03:43,440
to make plcs more secure in general

100
00:03:43,440 --> 00:03:46,000
so there are so many problems we all

101
00:03:46,000 --> 00:03:48,239
know prcs are somehow

102
00:03:48,239 --> 00:03:50,959
the hills here of a plant one of the

103
00:03:50,959 --> 00:03:52,959
most vulnerable part of a plant

104
00:03:52,959 --> 00:03:54,720
and we don't really have anything in our

105
00:03:54,720 --> 00:03:56,640
hands that can hand over to engineers

106
00:03:56,640 --> 00:03:57,599
and say well

107
00:03:57,599 --> 00:03:59,840
if you do it like this it even gets it

108
00:03:59,840 --> 00:04:01,360
gets better at least it doesn't get

109
00:04:01,360 --> 00:04:02,080
worse

110
00:04:02,080 --> 00:04:03,439
and you don't build in all these

111
00:04:03,439 --> 00:04:05,840
vulnerabilities

112
00:04:05,840 --> 00:04:09,280
so and there's one big argument

113
00:04:09,280 --> 00:04:12,840
um or one big understanding in the

114
00:04:12,840 --> 00:04:14,560
industry saying

115
00:04:14,560 --> 00:04:17,680
well pcs and security that just

116
00:04:17,680 --> 00:04:21,440
doesn't fit you know plc's they

117
00:04:21,440 --> 00:04:23,040
they are just not made for security

118
00:04:23,040 --> 00:04:25,280
they're insecure by design

119
00:04:25,280 --> 00:04:28,240
and so many of these standard well-known

120
00:04:28,240 --> 00:04:30,240
secure coding practices that we know for

121
00:04:30,240 --> 00:04:31,120
other software

122
00:04:31,120 --> 00:04:33,440
that's not even applicable to psc's we

123
00:04:33,440 --> 00:04:35,840
don't know how to do that for plc's

124
00:04:35,840 --> 00:04:37,360
and there's very much truth in it

125
00:04:37,360 --> 00:04:39,199
because it doesn't really doesn't make

126
00:04:39,199 --> 00:04:41,040
sense to simply take the secure

127
00:04:41,040 --> 00:04:42,800
programming practices

128
00:04:42,800 --> 00:04:46,400
you see from it and try to

129
00:04:46,400 --> 00:04:48,800
try to implement them on on a pse the

130
00:04:48,800 --> 00:04:50,800
same way that that won't work

131
00:04:50,800 --> 00:04:53,440
uh it's the same way if you able to ask

132
00:04:53,440 --> 00:04:54,560
ask a fish

133
00:04:54,560 --> 00:04:56,240
to climb a tree the same way that the

134
00:04:56,240 --> 00:04:58,160
monkey does just not made for it

135
00:04:58,160 --> 00:04:59,600
it doesn't make much sense for it to

136
00:04:59,600 --> 00:05:01,680
climb a tree at all

137
00:05:01,680 --> 00:05:04,320
but that doesn't really mean that plc's

138
00:05:04,320 --> 00:05:06,800
are not made for security after all

139
00:05:06,800 --> 00:05:09,680
they just need to um you just need to

140
00:05:09,680 --> 00:05:10,880
rethink uh

141
00:05:10,880 --> 00:05:14,240
how to achieve security for plc's using

142
00:05:14,240 --> 00:05:16,240
its characteristics

143
00:05:16,240 --> 00:05:20,400
because a plc um you would even say

144
00:05:20,400 --> 00:05:23,120
or some people would say many it people

145
00:05:23,120 --> 00:05:24,880
would say well plc is just too dumb

146
00:05:24,880 --> 00:05:28,240
for security and i can understand where

147
00:05:28,240 --> 00:05:30,240
that comes from because in a way a plc

148
00:05:30,240 --> 00:05:31,039
is dumb

149
00:05:31,039 --> 00:05:32,960
um in a way you could describe

150
00:05:32,960 --> 00:05:34,960
everything that a pc does with well

151
00:05:34,960 --> 00:05:38,320
you have one job or to be

152
00:05:38,320 --> 00:05:40,560
a bit more fair you had four jobs but

153
00:05:40,560 --> 00:05:43,919
that's it so a plc has a recurring scan

154
00:05:43,919 --> 00:05:44,479
cycle

155
00:05:44,479 --> 00:05:47,199
that it does over and over again so it

156
00:05:47,199 --> 00:05:48,240
reads inputs

157
00:05:48,240 --> 00:05:51,360
from a sensor so in this example here

158
00:05:51,360 --> 00:05:54,000
we've got a fluid level sensor so it

159
00:05:54,000 --> 00:05:54,479
reads

160
00:05:54,479 --> 00:05:57,360
where the fluid is maybe water or oil or

161
00:05:57,360 --> 00:05:58,639
anything

162
00:05:58,639 --> 00:06:00,400
and it reads that input from an input

163
00:06:00,400 --> 00:06:02,319
through an input interface

164
00:06:02,319 --> 00:06:05,280
processes it and it's in the cpu and

165
00:06:05,280 --> 00:06:07,840
stores its memory and then it loads

166
00:06:07,840 --> 00:06:09,919
a program from memory and executes the

167
00:06:09,919 --> 00:06:12,080
logic it loads and the logic looks way

168
00:06:12,080 --> 00:06:14,639
different than it would look in a normal

169
00:06:14,639 --> 00:06:17,360
computer program and then it maybe

170
00:06:17,360 --> 00:06:19,199
communicates with some kind of external

171
00:06:19,199 --> 00:06:20,160
component like an

172
00:06:20,160 --> 00:06:23,199
hmi or a programming laptop and then

173
00:06:23,199 --> 00:06:26,400
it writes output so if the level uh the

174
00:06:26,400 --> 00:06:28,880
fluid level here is too low it might say

175
00:06:28,880 --> 00:06:30,800
well start the pump and pop some fluid

176
00:06:30,800 --> 00:06:32,240
in there

177
00:06:32,240 --> 00:06:34,240
and all these four steps it repeats

178
00:06:34,240 --> 00:06:36,400
endlessly that's the scan cycle

179
00:06:36,400 --> 00:06:38,880
and does it always the same way and

180
00:06:38,880 --> 00:06:40,479
always in the same time

181
00:06:40,479 --> 00:06:43,840
and that's it so a plc has certain

182
00:06:43,840 --> 00:06:45,039
characteristics

183
00:06:45,039 --> 00:06:47,840
um it's a process expert it really

184
00:06:47,840 --> 00:06:50,000
communicates directly to the process

185
00:06:50,000 --> 00:06:51,440
directly with process

186
00:06:51,440 --> 00:06:53,520
it knows what the process is about it

187
00:06:53,520 --> 00:06:54,560
doesn't have to do

188
00:06:54,560 --> 00:06:57,759
a lot of fancy anomaly analysis because

189
00:06:57,759 --> 00:07:00,319
it's own job it's it's very job and its

190
00:07:00,319 --> 00:07:02,400
only job is to know about the process

191
00:07:02,400 --> 00:07:03,199
and to

192
00:07:03,199 --> 00:07:05,680
keep track of certain process values and

193
00:07:05,680 --> 00:07:06,479
keep them

194
00:07:06,479 --> 00:07:10,240
keep them on track and yes it's true a

195
00:07:10,240 --> 00:07:13,360
plc mostly has limited resources

196
00:07:13,360 --> 00:07:15,520
because it has a very designated task

197
00:07:15,520 --> 00:07:16,880
and that doesn't change much

198
00:07:16,880 --> 00:07:18,400
and you don't need all the resources in

199
00:07:18,400 --> 00:07:20,240
the world for it

200
00:07:20,240 --> 00:07:23,440
but instead it's very important that

201
00:07:23,440 --> 00:07:24,639
it's reliable

202
00:07:24,639 --> 00:07:27,280
so that you know if you if you give it a

203
00:07:27,280 --> 00:07:28,000
value

204
00:07:28,000 --> 00:07:30,319
and after a certain time there is an

205
00:07:30,319 --> 00:07:31,199
output

206
00:07:31,199 --> 00:07:34,000
and you you can it can absolutely

207
00:07:34,000 --> 00:07:34,720
guarantee

208
00:07:34,720 --> 00:07:36,639
that that output comes within a certain

209
00:07:36,639 --> 00:07:38,720
time that that's what we call

210
00:07:38,720 --> 00:07:41,840
uh real it's real time capable so the

211
00:07:41,840 --> 00:07:42,319
pump

212
00:07:42,319 --> 00:07:44,960
absolutely relies on the pse giving it

213
00:07:44,960 --> 00:07:47,039
the output it needs to be deterministic

214
00:07:47,039 --> 00:07:47,759
so

215
00:07:47,759 --> 00:07:50,240
when you put something in an input in it

216
00:07:50,240 --> 00:07:51,840
always returns the same

217
00:07:51,840 --> 00:07:54,000
output and all i see people know that

218
00:07:54,000 --> 00:07:55,360
that's totally not normal

219
00:07:55,360 --> 00:07:57,360
in for normal devices and for ethernet

220
00:07:57,360 --> 00:07:58,800
networks

221
00:07:58,800 --> 00:08:01,680
so a psc really is not dump it's just

222
00:08:01,680 --> 00:08:02,240
different

223
00:08:02,240 --> 00:08:05,440
it has one job four jobs and is really

224
00:08:05,440 --> 00:08:08,000
really well at doing these jobs

225
00:08:08,000 --> 00:08:10,319
and this is the setup that we need to

226
00:08:10,319 --> 00:08:12,400
live with and that we need to

227
00:08:12,400 --> 00:08:14,479
accept and that we need to look for

228
00:08:14,479 --> 00:08:16,560
strength

229
00:08:16,560 --> 00:08:20,160
that we can use for security benefits

230
00:08:20,160 --> 00:08:23,120
so what we wondered at the beginning of

231
00:08:23,120 --> 00:08:24,960
our project was

232
00:08:24,960 --> 00:08:27,840
what does it mean after all to securely

233
00:08:27,840 --> 00:08:29,280
program a plc

234
00:08:29,280 --> 00:08:32,159
we all know security is important and we

235
00:08:32,159 --> 00:08:34,320
all know that plc's are vulnerable and

236
00:08:34,320 --> 00:08:36,399
we want to make them more secure

237
00:08:36,399 --> 00:08:39,440
but what does a securely program

238
00:08:39,440 --> 00:08:43,039
program plc mean and what is a secure

239
00:08:43,039 --> 00:08:44,000
plc

240
00:08:44,000 --> 00:08:46,880
so these were the two leading questions

241
00:08:46,880 --> 00:08:49,120
that we tried to answer

242
00:08:49,120 --> 00:08:51,120
with the top 20 secure coding practices

243
00:08:51,120 --> 00:08:52,959
list or at least

244
00:08:52,959 --> 00:08:55,040
we try to give a first basis for

245
00:08:55,040 --> 00:08:56,720
discussion

246
00:08:56,720 --> 00:08:59,920
for these questions um i'll give you a

247
00:08:59,920 --> 00:09:01,360
short introduction of

248
00:09:01,360 --> 00:09:03,200
how this list looks and what how it's

249
00:09:03,200 --> 00:09:05,279
structured and what our assumptions were

250
00:09:05,279 --> 00:09:07,360
and then we will give you a deep dive

251
00:09:07,360 --> 00:09:09,120
into a couple of practices

252
00:09:09,120 --> 00:09:11,920
to give you a better feeling so the top

253
00:09:11,920 --> 00:09:13,600
20 list

254
00:09:13,600 --> 00:09:15,120
if you download it you can go to the

255
00:09:15,120 --> 00:09:17,279
project website we show that at the end

256
00:09:17,279 --> 00:09:19,839
um you can download it for free it has

257
00:09:19,839 --> 00:09:21,839
the most permissive license so you can

258
00:09:21,839 --> 00:09:22,560
virtually do

259
00:09:22,560 --> 00:09:24,800
anything with it we want it to spread we

260
00:09:24,800 --> 00:09:27,839
want to spread to engineers

261
00:09:27,839 --> 00:09:36,720
anyway if you download

262
00:09:36,720 --> 00:09:39,120
and they all have a title they all have

263
00:09:39,120 --> 00:09:40,399
a short description and they have a

264
00:09:40,399 --> 00:09:41,680
number and that's it

265
00:09:41,680 --> 00:09:44,240
and the number that's important to note

266
00:09:44,240 --> 00:09:45,920
is not a ranking

267
00:09:45,920 --> 00:09:49,279
so a practice with number one is not

268
00:09:49,279 --> 00:09:50,080
more important

269
00:09:50,080 --> 00:09:52,640
or or anything than the practice with

270
00:09:52,640 --> 00:09:54,880
number 20.

271
00:09:54,880 --> 00:09:57,519
and then if you keep on reading there's

272
00:09:57,519 --> 00:10:00,080
about 40 more pages with details on all

273
00:10:00,080 --> 00:10:02,240
the secure coding practices

274
00:10:02,240 --> 00:10:05,519
so here is a an example um on what the

275
00:10:05,519 --> 00:10:07,200
details look like and the example

276
00:10:07,200 --> 00:10:09,120
practice we're taking here is validate

277
00:10:09,120 --> 00:10:11,360
inputs based on physical plausibility

278
00:10:11,360 --> 00:10:13,680
which is one of my favorite practices to

279
00:10:13,680 --> 00:10:14,880
explain because it

280
00:10:14,880 --> 00:10:17,600
really is a practice that uses the

281
00:10:17,600 --> 00:10:18,720
characteristics

282
00:10:18,720 --> 00:10:21,440
the superpowers that naturally come to a

283
00:10:21,440 --> 00:10:24,079
psc that appears he's really good at

284
00:10:24,079 --> 00:10:27,760
like fishes at swimming and

285
00:10:27,760 --> 00:10:29,680
that's of course because the plc as we

286
00:10:29,680 --> 00:10:31,440
said as a process expert it's really

287
00:10:31,440 --> 00:10:32,720
good at knowing

288
00:10:32,720 --> 00:10:35,040
what values what process values are

289
00:10:35,040 --> 00:10:36,640
normal

290
00:10:36,640 --> 00:10:40,000
and are good and are acceptable

291
00:10:40,000 --> 00:10:43,680
so if you for example have a gate

292
00:10:43,680 --> 00:10:45,519
and the gate takes a certain time to

293
00:10:45,519 --> 00:10:47,680
open physically it always takes five

294
00:10:47,680 --> 00:10:49,200
seconds until it's open because it

295
00:10:49,200 --> 00:10:51,600
physically can't be done more quickly

296
00:10:51,600 --> 00:10:54,079
and the plc gets a value from a sensor

297
00:10:54,079 --> 00:10:55,760
which says where gate is closed but it's

298
00:10:55,760 --> 00:10:58,079
only half a second

299
00:10:58,079 --> 00:10:59,920
since since it asked just since the gate

300
00:10:59,920 --> 00:11:01,839
starts to close then the plc knows

301
00:11:01,839 --> 00:11:03,600
something is wrong or at least can know

302
00:11:03,600 --> 00:11:05,360
something is wrong you can ask a poc

303
00:11:05,360 --> 00:11:06,399
about that

304
00:11:06,399 --> 00:11:09,440
so that is something that you can use

305
00:11:09,440 --> 00:11:12,320
to validate uh plc inputs and that's

306
00:11:12,320 --> 00:11:13,760
something

307
00:11:13,760 --> 00:11:15,760
very unusual because it's not something

308
00:11:15,760 --> 00:11:17,680
how it could validate an input for a

309
00:11:17,680 --> 00:11:19,360
normal software because normal software

310
00:11:19,360 --> 00:11:22,079
usually doesn't have physical

311
00:11:22,079 --> 00:11:24,480
inputs or physical outputs but the plc

312
00:11:24,480 --> 00:11:25,120
does

313
00:11:25,120 --> 00:11:26,640
so there are things where you really

314
00:11:26,640 --> 00:11:28,959
don't need a fancy security monitoring

315
00:11:28,959 --> 00:11:29,760
tool

316
00:11:29,760 --> 00:11:33,519
and you don't need a ki by

317
00:11:33,519 --> 00:11:36,160
ai based anomaly detection or anything

318
00:11:36,160 --> 00:11:38,079
but you just need

319
00:11:38,079 --> 00:11:40,880
a plc whose job it is to know the

320
00:11:40,880 --> 00:11:42,800
process

321
00:11:42,800 --> 00:11:44,560
and for this practice we've got the

322
00:11:44,560 --> 00:11:46,240
title we've got the short description

323
00:11:46,240 --> 00:11:48,320
that basically summarizes what i just

324
00:11:48,320 --> 00:11:49,120
said

325
00:11:49,120 --> 00:11:51,279
and then for each practice we have a

326
00:11:51,279 --> 00:11:52,800
security objective

327
00:11:52,800 --> 00:11:55,200
and that summarizes in a quickly in a

328
00:11:55,200 --> 00:11:56,079
quick way

329
00:11:56,079 --> 00:11:59,120
as a tag if you so well

330
00:11:59,120 --> 00:12:02,399
what the main security objective is that

331
00:12:02,399 --> 00:12:04,480
practice fulfills and that could be

332
00:12:04,480 --> 00:12:05,920
either integrity

333
00:12:05,920 --> 00:12:08,399
a lot of times it's integrity for pse of

334
00:12:08,399 --> 00:12:09,519
psc logic

335
00:12:09,519 --> 00:12:12,480
of i o values or of pse variables in

336
00:12:12,480 --> 00:12:15,519
this case it's integrity of i o values

337
00:12:15,519 --> 00:12:17,279
but it could also be something hardening

338
00:12:17,279 --> 00:12:19,040
or resilience or monitoring

339
00:12:19,040 --> 00:12:23,040
look at that at a minute and then

340
00:12:23,040 --> 00:12:26,240
we also define target group because not

341
00:12:26,240 --> 00:12:27,360
all practices

342
00:12:27,360 --> 00:12:30,079
can be implemented by the same tag group

343
00:12:30,079 --> 00:12:30,800
we use

344
00:12:30,800 --> 00:12:34,240
the isa 62 443 tag groups you may know

345
00:12:34,240 --> 00:12:36,160
them it's product suppliers

346
00:12:36,160 --> 00:12:37,920
it's integration and maintenance service

347
00:12:37,920 --> 00:12:40,079
providers and its asset owners

348
00:12:40,079 --> 00:12:43,760
and truth is that a lot of practices

349
00:12:43,760 --> 00:12:45,519
always depending on who programs the

350
00:12:45,519 --> 00:12:46,959
plcs of course but

351
00:12:46,959 --> 00:12:49,600
a lot of practices cannot really be

352
00:12:49,600 --> 00:12:51,600
integrated be implemented by asset

353
00:12:51,600 --> 00:12:53,360
owners because a lot of

354
00:12:53,360 --> 00:12:55,440
um especially low level programming

355
00:12:55,440 --> 00:12:56,560
happens at

356
00:12:56,560 --> 00:12:58,320
product suppliers in the integration of

357
00:12:58,320 --> 00:13:01,519
maintenance service providers side

358
00:13:01,519 --> 00:13:03,040
and then we've got a section called

359
00:13:03,040 --> 00:13:05,680
guidance where really

360
00:13:05,680 --> 00:13:07,440
everything goes into that helps

361
00:13:07,440 --> 00:13:08,959
implementing the practices

362
00:13:08,959 --> 00:13:12,079
b is screenshots um be it cooking

363
00:13:12,079 --> 00:13:13,200
recipes for

364
00:13:13,200 --> 00:13:16,240
for different makes or models of pfcs be

365
00:13:16,240 --> 00:13:17,839
it background information that you need

366
00:13:17,839 --> 00:13:19,360
to know in order to implement the

367
00:13:19,360 --> 00:13:20,079
practice

368
00:13:20,079 --> 00:13:23,360
whatever goes into the guidance

369
00:13:23,360 --> 00:13:24,720
and then we've got a section called

370
00:13:24,720 --> 00:13:26,720
examples which

371
00:13:26,720 --> 00:13:29,440
can be implementation scenarios or it

372
00:13:29,440 --> 00:13:31,360
can be scenario examples for certain

373
00:13:31,360 --> 00:13:33,839
industries or products

374
00:13:33,839 --> 00:13:35,680
or it can also be examples of what could

375
00:13:35,680 --> 00:13:36,880
happen if

376
00:13:36,880 --> 00:13:38,720
a practice is not implemented which is

377
00:13:38,720 --> 00:13:40,160
important to understand the security

378
00:13:40,160 --> 00:13:42,639
benefit

379
00:13:42,880 --> 00:13:44,800
talking of security benefit that's

380
00:13:44,800 --> 00:13:46,800
another very important sections we have

381
00:13:46,800 --> 00:13:48,000
in our for each of

382
00:13:48,000 --> 00:13:51,760
our plc programming practices um

383
00:13:51,760 --> 00:13:55,199
and these sections involve the y section

384
00:13:55,199 --> 00:13:58,160
so why is this programming practice

385
00:13:58,160 --> 00:13:59,040
important

386
00:13:59,040 --> 00:14:01,040
and of course it's secure pse

387
00:14:01,040 --> 00:14:02,639
programming practices

388
00:14:02,639 --> 00:14:06,000
so it's actually

389
00:14:06,000 --> 00:14:07,600
all of these practices are beneficial

390
00:14:07,600 --> 00:14:10,320
for security obviously

391
00:14:10,320 --> 00:14:13,600
but then also many of these practices

392
00:14:13,600 --> 00:14:15,120
and that's a very important point to

393
00:14:15,120 --> 00:14:17,519
make so let that sink in

394
00:14:17,519 --> 00:14:19,680
a lot of these practices also have

395
00:14:19,680 --> 00:14:21,600
benefits for reliability

396
00:14:21,600 --> 00:14:24,079
and they also have practice benefits for

397
00:14:24,079 --> 00:14:26,880
maintenance for example

398
00:14:26,880 --> 00:14:30,079
if you take this example here so

399
00:14:30,079 --> 00:14:32,560
um validating inputs based on physical

400
00:14:32,560 --> 00:14:34,160
plausibility of course that's good

401
00:14:34,160 --> 00:14:36,000
because it can validate

402
00:14:36,000 --> 00:14:40,079
um if an attica has uh manipulated value

403
00:14:40,079 --> 00:14:42,320
tempered with a sensor or anything so

404
00:14:42,320 --> 00:14:43,920
that's that's that's good you can give

405
00:14:43,920 --> 00:14:44,720
an alert

406
00:14:44,720 --> 00:14:47,040
but you can also use that validation for

407
00:14:47,040 --> 00:14:49,040
reliability purposes so

408
00:14:49,040 --> 00:14:50,720
if something doesn't work if some

409
00:14:50,720 --> 00:14:52,880
something may be broken mechanically

410
00:14:52,880 --> 00:14:56,000
um the same the same feature can

411
00:14:56,000 --> 00:14:57,519
can give you a hint that something like

412
00:14:57,519 --> 00:14:59,360
this is wrong so that is

413
00:14:59,360 --> 00:15:02,959
things where um that statement that we

414
00:15:02,959 --> 00:15:03,760
often read

415
00:15:03,760 --> 00:15:05,519
that there's always trade-off between

416
00:15:05,519 --> 00:15:07,519
security and comfort between security

417
00:15:07,519 --> 00:15:08,880
and operability

418
00:15:08,880 --> 00:15:11,040
uh between security and usability

419
00:15:11,040 --> 00:15:12,959
between security and operations

420
00:15:12,959 --> 00:15:15,360
that there's always a trade-off that's

421
00:15:15,360 --> 00:15:16,480
actually

422
00:15:16,480 --> 00:15:18,800
not always true at least for the secure

423
00:15:18,800 --> 00:15:20,800
prc coding practices

424
00:15:20,800 --> 00:15:23,440
that's actually not the case for every

425
00:15:23,440 --> 00:15:25,519
single practice that we have here

426
00:15:25,519 --> 00:15:27,680
we've got not only a security benefit

427
00:15:27,680 --> 00:15:28,560
but also

428
00:15:28,560 --> 00:15:31,360
a benefit unfortunate realm of

429
00:15:31,360 --> 00:15:32,399
operations

430
00:15:32,399 --> 00:15:35,360
and that's very important point to make

431
00:15:35,360 --> 00:15:36,000
because

432
00:15:36,000 --> 00:15:41,120
that's often the case in in ot because

433
00:15:41,120 --> 00:15:44,079
security uh with having processes and

434
00:15:44,079 --> 00:15:44,880
having

435
00:15:44,880 --> 00:15:47,680
pse characteristics in mind is often

436
00:15:47,680 --> 00:15:48,480
about

437
00:15:48,480 --> 00:15:51,120
reducing complexity it's often about

438
00:15:51,120 --> 00:15:54,560
better monitoring it's often about

439
00:15:54,560 --> 00:15:56,880
better structuring of code it's often

440
00:15:56,880 --> 00:15:57,680
about

441
00:15:57,680 --> 00:15:59,440
better documentation and all these

442
00:15:59,440 --> 00:16:01,040
things are actually things

443
00:16:01,040 --> 00:16:04,240
that mostly do not stand in the way

444
00:16:04,240 --> 00:16:06,399
of usability like long passwords would

445
00:16:06,399 --> 00:16:07,600
do

446
00:16:07,600 --> 00:16:11,279
but they really help operations

447
00:16:13,920 --> 00:16:16,000
last we also have references uh we have

448
00:16:16,000 --> 00:16:17,519
references to existing standards and

449
00:16:17,519 --> 00:16:19,120
frameworks and that could be for two

450
00:16:19,120 --> 00:16:20,160
courses

451
00:16:20,160 --> 00:16:23,440
so first we we reference attacks or

452
00:16:23,440 --> 00:16:25,199
weaknesses or vulnerabilities

453
00:16:25,199 --> 00:16:28,000
that a certain practice could prevent

454
00:16:28,000 --> 00:16:28,720
that would be

455
00:16:28,720 --> 00:16:31,040
mitre attack or mitral cwe in these

456
00:16:31,040 --> 00:16:32,000
cases here

457
00:16:32,000 --> 00:16:34,959
and we could we do we also reference

458
00:16:34,959 --> 00:16:36,639
security requirements

459
00:16:36,639 --> 00:16:39,040
that the practice under consideration

460
00:16:39,040 --> 00:16:40,959
could help to fulfill

461
00:16:40,959 --> 00:16:44,160
and these are in these cases here isa 62

462
00:16:44,160 --> 00:16:45,920
for three requirements

463
00:16:45,920 --> 00:16:51,120
and that could be extended of course

464
00:16:51,120 --> 00:16:54,959
small look at the security objective um

465
00:16:54,959 --> 00:16:56,720
what can we expect from a security

466
00:16:56,720 --> 00:17:00,160
program plc and what can't we expect

467
00:17:00,160 --> 00:17:02,560
looking at the objectives we see a

468
00:17:02,560 --> 00:17:05,119
pretty clear

469
00:17:05,119 --> 00:17:07,679
structure here so we see that most of

470
00:17:07,679 --> 00:17:09,199
our 20

471
00:17:09,199 --> 00:17:11,839
secure programming practices have

472
00:17:11,839 --> 00:17:13,520
integrity benefits

473
00:17:13,520 --> 00:17:15,039
and that's actually not a surprise

474
00:17:15,039 --> 00:17:18,000
because what a plc does is

475
00:17:18,000 --> 00:17:20,880
making sure that values process values

476
00:17:20,880 --> 00:17:23,280
io values

477
00:17:23,280 --> 00:17:25,359
stay on track and the most important

478
00:17:25,359 --> 00:17:26,319
thing that you could

479
00:17:26,319 --> 00:17:27,919
imagine the most important threat

480
00:17:27,919 --> 00:17:29,520
scenario you could imagine doing to a

481
00:17:29,520 --> 00:17:31,039
psc of course is

482
00:17:31,039 --> 00:17:35,440
tampering with its integrity and then

483
00:17:35,440 --> 00:17:38,240
the other part would be monitoring

484
00:17:38,240 --> 00:17:40,160
because as we said before

485
00:17:40,160 --> 00:17:42,400
a big issue with prcs and the big

486
00:17:42,400 --> 00:17:44,880
benefit of prcs is

487
00:17:44,880 --> 00:17:46,960
that they are process experts they know

488
00:17:46,960 --> 00:17:48,720
about the process so much better than

489
00:17:48,720 --> 00:17:51,679
all your fancy security tools can learn

490
00:17:51,679 --> 00:17:54,160
in a long time so for some cases for

491
00:17:54,160 --> 00:17:55,520
some monitoring purposes

492
00:17:55,520 --> 00:17:58,160
pfcs can actually do a kind of work and

493
00:17:58,160 --> 00:17:59,919
also they can help with resilience and

494
00:17:59,919 --> 00:18:00,480
hardening

495
00:18:00,480 --> 00:18:03,840
if you have a few practices for these

496
00:18:03,840 --> 00:18:07,120
one very important point to make is uh

497
00:18:07,120 --> 00:18:10,160
securely programming a prc

498
00:18:10,160 --> 00:18:13,520
is most likely not the first step you

499
00:18:13,520 --> 00:18:15,360
would take

500
00:18:15,360 --> 00:18:18,240
in a security program it's not the most

501
00:18:18,240 --> 00:18:19,200
important

502
00:18:19,200 --> 00:18:21,520
and of course no these practices would

503
00:18:21,520 --> 00:18:23,360
not have prevented stuxnet at least not

504
00:18:23,360 --> 00:18:24,320
alone

505
00:18:24,320 --> 00:18:28,000
um but it's simply and that's the the

506
00:18:28,000 --> 00:18:31,440
whole goal of all this turning a pse

507
00:18:31,440 --> 00:18:33,039
which or which has always been one of

508
00:18:33,039 --> 00:18:35,039
the most vulnerable components in a

509
00:18:35,039 --> 00:18:36,160
plant

510
00:18:36,160 --> 00:18:39,280
the the oculus here in a plant turn

511
00:18:39,280 --> 00:18:40,480
these

512
00:18:40,480 --> 00:18:43,440
vulnerable components at least to one

513
00:18:43,440 --> 00:18:45,919
more layer of security to a last line of

514
00:18:45,919 --> 00:18:46,720
defense

515
00:18:46,720 --> 00:18:49,200
that stands like bodyguard in front of

516
00:18:49,200 --> 00:18:49,919
your

517
00:18:49,919 --> 00:18:56,160
most important processes in a plant

518
00:18:56,160 --> 00:18:59,360
last two questions that we often hear

519
00:18:59,360 --> 00:19:01,360
when we talk about prc secure coding

520
00:19:01,360 --> 00:19:02,559
practices

521
00:19:02,559 --> 00:19:06,080
is why is a certain practice

522
00:19:06,080 --> 00:19:08,960
not on the list and the most important

523
00:19:08,960 --> 00:19:10,080
answer the most popular

524
00:19:10,080 --> 00:19:12,000
answer is probably because it's not in

525
00:19:12,000 --> 00:19:13,679
scope because

526
00:19:13,679 --> 00:19:16,480
uh we got a this was a humidity

527
00:19:16,480 --> 00:19:18,480
community project we had about 900

528
00:19:18,480 --> 00:19:18,880
people

529
00:19:18,880 --> 00:19:21,120
registered on a discourse platform who

530
00:19:21,120 --> 00:19:22,000
collaborated

531
00:19:22,000 --> 00:19:25,520
on on this and who

532
00:19:26,080 --> 00:19:29,280
submitted potential plc coding practices

533
00:19:29,280 --> 00:19:31,039
and we had to limit the scope at some

534
00:19:31,039 --> 00:19:32,960
point we had to make sure

535
00:19:32,960 --> 00:19:36,640
that our top 20 sql plc coding practices

536
00:19:36,640 --> 00:19:39,679
actually kept the coding practices

537
00:19:39,679 --> 00:19:41,760
so we have the scope that's that's lined

538
00:19:41,760 --> 00:19:42,799
out here

539
00:19:42,799 --> 00:19:44,400
everything is the scope anything that

540
00:19:44,400 --> 00:19:46,640
includes changes to the prc itself

541
00:19:46,640 --> 00:19:50,160
so this one here what's not in scope is

542
00:19:50,160 --> 00:19:51,919
and that's a potential second scope that

543
00:19:51,919 --> 00:19:53,360
we could be doing

544
00:19:53,360 --> 00:19:56,320
um as top 20 secure plc environment

545
00:19:56,320 --> 00:19:57,919
practices as a working title so

546
00:19:57,919 --> 00:19:59,840
everything that involves architecture

547
00:19:59,840 --> 00:20:01,520
that involves hmi

548
00:20:01,520 --> 00:20:03,280
programming and device or io

549
00:20:03,280 --> 00:20:05,520
requirements or documentation

550
00:20:05,520 --> 00:20:07,840
could be on a second list second

551
00:20:07,840 --> 00:20:08,720
question

552
00:20:08,720 --> 00:20:12,159
that we get a lot of times is why is

553
00:20:12,159 --> 00:20:14,159
this practice on the list at all it's so

554
00:20:14,159 --> 00:20:16,720
basic but there are actually three cases

555
00:20:16,720 --> 00:20:18,960
why someone would say it's so basic

556
00:20:18,960 --> 00:20:22,480
first is a security person says that

557
00:20:22,480 --> 00:20:24,720
the prc super practice is really too

558
00:20:24,720 --> 00:20:26,559
basic for security people everyone knows

559
00:20:26,559 --> 00:20:28,000
about that

560
00:20:28,000 --> 00:20:29,840
but a simple answer why it's on the list

561
00:20:29,840 --> 00:20:32,000
anyway is because security people don't

562
00:20:32,000 --> 00:20:33,919
program plc's it doesn't help if

563
00:20:33,919 --> 00:20:36,240
security people know about it

564
00:20:36,240 --> 00:20:38,080
plc programmers need to know about it

565
00:20:38,080 --> 00:20:40,720
and that's the target group of our list

566
00:20:40,720 --> 00:20:42,960
and also security people may know about

567
00:20:42,960 --> 00:20:45,200
this practice but do they know about how

568
00:20:45,200 --> 00:20:47,679
about its implementation on a plc the

569
00:20:47,679 --> 00:20:49,760
quiet requirement may be basic but not

570
00:20:49,760 --> 00:20:51,280
its implementation

571
00:20:51,280 --> 00:20:53,919
and then we also wanted to do something

572
00:20:53,919 --> 00:20:54,880
against the myth

573
00:20:54,880 --> 00:20:58,400
that security practices are simple

574
00:20:58,400 --> 00:21:00,960
but plcs are simply to dump to implement

575
00:21:00,960 --> 00:21:02,000
them

576
00:21:02,000 --> 00:21:04,400
that is true for some practices but it's

577
00:21:04,400 --> 00:21:06,400
not true for others and we want to put

578
00:21:06,400 --> 00:21:08,320
the practices explicitly

579
00:21:08,320 --> 00:21:10,159
explicitly on the list that can be

580
00:21:10,159 --> 00:21:12,080
implemented on a pc

581
00:21:12,080 --> 00:21:14,080
so that's the first one the second is

582
00:21:14,080 --> 00:21:15,360
pse programmers say

583
00:21:15,360 --> 00:21:18,720
well that's so basic it's that

584
00:21:18,720 --> 00:21:21,440
this i've been doing that for years

585
00:21:21,440 --> 00:21:23,840
every plc programmer knows about that

586
00:21:23,840 --> 00:21:26,880
and that may be true they maybe

587
00:21:26,880 --> 00:21:28,960
they they maybe know that it's a good

588
00:21:28,960 --> 00:21:31,760
practice but they they may not know

589
00:21:31,760 --> 00:21:33,679
it in fact has a security benefit and

590
00:21:33,679 --> 00:21:35,440
then they also should do it because for

591
00:21:35,440 --> 00:21:36,640
security reasons

592
00:21:36,640 --> 00:21:38,480
and that becomes important first when

593
00:21:38,480 --> 00:21:40,559
you want to talk about what a secure plc

594
00:21:40,559 --> 00:21:41,360
is of course

595
00:21:41,360 --> 00:21:43,600
but also it becomes important because it

596
00:21:43,600 --> 00:21:44,960
adds one more reason

597
00:21:44,960 --> 00:21:47,200
why you should do a certain practice so

598
00:21:47,200 --> 00:21:49,600
if you decide not to do it because

599
00:21:49,600 --> 00:21:51,360
it's just for efficiency reasons and

600
00:21:51,360 --> 00:21:52,799
efficiency is not as important

601
00:21:52,799 --> 00:21:54,880
it's important that plc programmers know

602
00:21:54,880 --> 00:21:56,559
that this practice they may be leaving

603
00:21:56,559 --> 00:21:56,880
out

604
00:21:56,880 --> 00:21:59,919
also has security benefits and they

605
00:21:59,919 --> 00:22:01,679
on the other hand on the other way

606
00:22:01,679 --> 00:22:03,520
around they also have a

607
00:22:03,520 --> 00:22:05,600
security problem if they don't implement

608
00:22:05,600 --> 00:22:07,440
them

609
00:22:07,440 --> 00:22:11,600
and then lastly there are practices

610
00:22:11,600 --> 00:22:14,480
just say well it's it's basic because

611
00:22:14,480 --> 00:22:15,919
everyone knows and everyone has been

612
00:22:15,919 --> 00:22:17,440
doing this for years anyway

613
00:22:17,440 --> 00:22:20,480
well if anyone everyone has been doing a

614
00:22:20,480 --> 00:22:22,320
certain practice in order to securely

615
00:22:22,320 --> 00:22:23,840
program plc's

616
00:22:23,840 --> 00:22:27,039
for years i hope we can

617
00:22:27,039 --> 00:22:28,720
we can agree that it absolutely belongs

618
00:22:28,720 --> 00:22:30,960
on a top 20 secure psc coding list so

619
00:22:30,960 --> 00:22:32,400
that's why it's on there

620
00:22:32,400 --> 00:22:34,880
and also there's always rookies there's

621
00:22:34,880 --> 00:22:36,960
always newbies there's always new people

622
00:22:36,960 --> 00:22:38,880
that do not fall under everyone and they

623
00:22:38,880 --> 00:22:40,240
don't do not know

624
00:22:40,240 --> 00:22:44,000
and i want to remind you of our

625
00:22:44,000 --> 00:22:46,320
true leading questions that i mentioned

626
00:22:46,320 --> 00:22:47,600
in the beginning

627
00:22:47,600 --> 00:22:50,799
which were we want to answer we want to

628
00:22:50,799 --> 00:22:54,799
put up a list which which defines

629
00:22:54,799 --> 00:22:57,360
what it means to secure the program plc

630
00:22:57,360 --> 00:22:58,960
and we want to have a list

631
00:22:58,960 --> 00:23:01,120
that answers the questions what is

632
00:23:01,120 --> 00:23:03,919
secure psc so we want to be basic be

633
00:23:03,919 --> 00:23:06,840
basic is really one of our lists

634
00:23:06,840 --> 00:23:08,640
purposes

635
00:23:08,640 --> 00:23:11,280
so now that we've answered most of your

636
00:23:11,280 --> 00:23:13,280
questions hopefully that arise that

637
00:23:13,280 --> 00:23:15,120
could arise while looking at that list

638
00:23:15,120 --> 00:23:17,360
and you have a small i have an idea of

639
00:23:17,360 --> 00:23:19,760
what it's all about i hope you're ready

640
00:23:19,760 --> 00:23:21,120
i'm hoping you're ready for

641
00:23:21,120 --> 00:23:23,600
the deep dive into a couple of questions

642
00:23:23,600 --> 00:23:25,600
practices

643
00:23:25,600 --> 00:23:27,200
that we've actually introduced to you

644
00:23:27,200 --> 00:23:31,200
now be backstage is yours

645
00:23:31,200 --> 00:23:34,320
hey ics village folks at defcon hope you

646
00:23:34,320 --> 00:23:36,480
are enjoying the conference so far

647
00:23:36,480 --> 00:23:38,559
i'm here with sarah flutes to talk about

648
00:23:38,559 --> 00:23:41,679
secure coding practices for plc's

649
00:23:41,679 --> 00:23:44,880
a little bit about me viveknada

650
00:23:44,880 --> 00:23:47,120
after 23 plus years experience in

651
00:23:47,120 --> 00:23:48,880
industrial control systems

652
00:23:48,880 --> 00:23:51,279
i've been doing ics ot cyber security

653
00:23:51,279 --> 00:23:53,440
for the past eight plus years

654
00:23:53,440 --> 00:23:55,039
my background is electronics and

655
00:23:55,039 --> 00:23:56,559
communications engineering

656
00:23:56,559 --> 00:23:59,520
i have an mba in finance and the gicsp

657
00:23:59,520 --> 00:24:01,520
search from sans

658
00:24:01,520 --> 00:24:02,960
i started off as a controls and

659
00:24:02,960 --> 00:24:04,559
instrumentation technician

660
00:24:04,559 --> 00:24:07,520
calibrated valves transmitters

661
00:24:07,520 --> 00:24:09,039
configuring plcs

662
00:24:09,039 --> 00:24:11,360
i became a field engineer commissioned

663
00:24:11,360 --> 00:24:13,200
gas turbines and steam turbines control

664
00:24:13,200 --> 00:24:14,320
systems

665
00:24:14,320 --> 00:24:16,880
around the world for utilities and oil

666
00:24:16,880 --> 00:24:18,400
and gas customers

667
00:24:18,400 --> 00:24:20,880
then went back to business school after

668
00:24:20,880 --> 00:24:22,400
that became a sales and business

669
00:24:22,400 --> 00:24:23,760
development manager

670
00:24:23,760 --> 00:24:25,679
and currently i serve as a service

671
00:24:25,679 --> 00:24:28,000
manager for canada fleet

672
00:24:28,000 --> 00:24:32,159
my company covering all utility and oil

673
00:24:32,159 --> 00:24:33,679
and gas customers

674
00:24:33,679 --> 00:24:36,559
within canada and i've worked in several

675
00:24:36,559 --> 00:24:37,440
countries

676
00:24:37,440 --> 00:24:39,440
my contact information is below or

677
00:24:39,440 --> 00:24:41,200
linkedin and twitter

678
00:24:41,200 --> 00:24:43,200
all right now that sarah's giving you

679
00:24:43,200 --> 00:24:44,320
the background

680
00:24:44,320 --> 00:24:46,640
let's take a deep dive into a few

681
00:24:46,640 --> 00:24:49,679
practices to learn more

682
00:24:49,679 --> 00:24:51,679
let's pick something straightforward for

683
00:24:51,679 --> 00:24:52,960
our first one

684
00:24:52,960 --> 00:24:56,559
practice 13 says disable unneeded

685
00:24:56,559 --> 00:24:59,760
unused communication force and protocols

686
00:24:59,760 --> 00:25:01,760
so the controllers that we are used to

687
00:25:01,760 --> 00:25:03,039
generally support

688
00:25:03,039 --> 00:25:06,400
multiple communication protocols because

689
00:25:06,400 --> 00:25:08,880
they are used in various applications

690
00:25:08,880 --> 00:25:11,200
now most of these protocols are

691
00:25:11,200 --> 00:25:12,159
unfortunately

692
00:25:12,159 --> 00:25:14,480
enabled by default even if you're not

693
00:25:14,480 --> 00:25:15,440
using them

694
00:25:15,440 --> 00:25:18,480
as an example telnet or ftp you have to

695
00:25:18,480 --> 00:25:20,000
actively go disable them

696
00:25:20,000 --> 00:25:22,720
if you're not using them now the best

697
00:25:22,720 --> 00:25:24,000
practice recommendation

698
00:25:24,000 --> 00:25:26,960
is to develop a data flow diagram that

699
00:25:26,960 --> 00:25:28,320
clearly shows all the required

700
00:25:28,320 --> 00:25:29,520
communications

701
00:25:29,520 --> 00:25:32,000
what ports are required to be open and

702
00:25:32,000 --> 00:25:34,559
how the logical network segmentation is

703
00:25:34,559 --> 00:25:37,120
what protocols are used so that it's

704
00:25:37,120 --> 00:25:37,919
clear

705
00:25:37,919 --> 00:25:39,760
as to why certain ports and protocols

706
00:25:39,760 --> 00:25:42,720
are in use and why the others aren't

707
00:25:42,720 --> 00:25:45,039
now every additional port every

708
00:25:45,039 --> 00:25:47,279
additional protocol that's enabled

709
00:25:47,279 --> 00:25:51,600
adds to the plc's attack surface and

710
00:25:51,600 --> 00:25:53,440
the attackers can't use if a certain

711
00:25:53,440 --> 00:25:55,520
port is disabled or a protocol is

712
00:25:55,520 --> 00:25:56,960
disabled

713
00:25:56,960 --> 00:25:59,679
and you can typically alert for

714
00:25:59,679 --> 00:26:01,279
something that's being enabled

715
00:26:01,279 --> 00:26:03,679
or perhaps you need to download to the

716
00:26:03,679 --> 00:26:05,840
controller to re-enable the port

717
00:26:05,840 --> 00:26:08,720
or the enable that particular protocol

718
00:26:08,720 --> 00:26:10,000
so that gives you

719
00:26:10,000 --> 00:26:12,320
ways to find out that something is going

720
00:26:12,320 --> 00:26:13,679
on right

721
00:26:13,679 --> 00:26:15,840
in addition perhaps you have a network

722
00:26:15,840 --> 00:26:17,679
sensor or firewall

723
00:26:17,679 --> 00:26:21,120
that can detect if a particular protocol

724
00:26:21,120 --> 00:26:22,080
is in use

725
00:26:22,080 --> 00:26:24,400
and if you have previously disabled that

726
00:26:24,400 --> 00:26:25,200
you can

727
00:26:25,200 --> 00:26:28,320
get a sensor that way but even natively

728
00:26:28,320 --> 00:26:30,159
there are ways to find out if a certain

729
00:26:30,159 --> 00:26:34,080
disabled protocol or report is enabled

730
00:26:34,080 --> 00:26:37,360
now following this practice of disabling

731
00:26:37,360 --> 00:26:38,000
unused

732
00:26:38,000 --> 00:26:40,799
force and protocols you can also reduce

733
00:26:40,799 --> 00:26:41,760
the potential for

734
00:26:41,760 --> 00:26:45,200
malformed traffic to affect the plc

735
00:26:45,200 --> 00:26:48,559
so most plc's don't

736
00:26:48,559 --> 00:26:50,840
really do well when there is a

737
00:26:50,840 --> 00:26:52,640
malfunction

738
00:26:52,640 --> 00:26:54,640
and if a particular protocol is not in

739
00:26:54,640 --> 00:26:56,640
use any malformed

740
00:26:56,640 --> 00:26:59,760
traffic from a malicious actor

741
00:26:59,760 --> 00:27:01,600
for on that protocol is not going to

742
00:27:01,600 --> 00:27:04,000
affect the plc

743
00:27:04,000 --> 00:27:05,919
now following the practice also reduces

744
00:27:05,919 --> 00:27:07,919
the overall complexity because

745
00:27:07,919 --> 00:27:10,080
what's not there what's not enabled is

746
00:27:10,080 --> 00:27:12,159
not necessary to be maintained and

747
00:27:12,159 --> 00:27:14,720
mastered updated

748
00:27:14,720 --> 00:27:16,880
these days you hear a lot about s-bombs

749
00:27:16,880 --> 00:27:18,559
software with the materials

750
00:27:18,559 --> 00:27:21,520
the idea being vulnerability is found in

751
00:27:21,520 --> 00:27:23,279
the network stack

752
00:27:23,279 --> 00:27:26,480
from your vendor go investigate and find

753
00:27:26,480 --> 00:27:27,200
out

754
00:27:27,200 --> 00:27:30,159
if it's a relevant threat for your

755
00:27:30,159 --> 00:27:31,200
application

756
00:27:31,200 --> 00:27:33,520
and then follow the mitigation path

757
00:27:33,520 --> 00:27:34,559
however

758
00:27:34,559 --> 00:27:36,799
if those force of protocols are not in

759
00:27:36,799 --> 00:27:38,240
use

760
00:27:38,240 --> 00:27:40,399
that just reduces the attack surface and

761
00:27:40,399 --> 00:27:43,840
you are at a lower risk

762
00:27:43,840 --> 00:27:46,880
next step is practice five again another

763
00:27:46,880 --> 00:27:48,559
pretty straightforward one

764
00:27:48,559 --> 00:27:51,840
using cryptographic checks or check some

765
00:27:51,840 --> 00:27:55,120
integrity checks for the plc code

766
00:27:55,120 --> 00:27:57,600
now some plcs have a built-in mechanism

767
00:27:57,600 --> 00:27:59,120
for a checksum feature

768
00:27:59,120 --> 00:28:01,840
and if that's available by all means

769
00:28:01,840 --> 00:28:04,000
write that to register

770
00:28:04,000 --> 00:28:06,799
log it asterize it alarm or alert it

771
00:28:06,799 --> 00:28:07,760
when it's changed

772
00:28:07,760 --> 00:28:10,159
so you can verify the integrity of the

773
00:28:10,159 --> 00:28:11,440
code in the plc

774
00:28:11,440 --> 00:28:13,039
pretty much pretty much straightforward

775
00:28:13,039 --> 00:28:14,640
manner now

776
00:28:14,640 --> 00:28:16,720
most plcs do not have the processing

777
00:28:16,720 --> 00:28:19,760
capacity to generate or check hashes

778
00:28:19,760 --> 00:28:21,919
in that case you can use ews the

779
00:28:21,919 --> 00:28:23,200
engineering workstation

780
00:28:23,200 --> 00:28:25,279
to generate the hash or checksum of the

781
00:28:25,279 --> 00:28:26,799
compile software

782
00:28:26,799 --> 00:28:29,279
and then you upload the binary back from

783
00:28:29,279 --> 00:28:30,960
the plc you can compare that with that

784
00:28:30,960 --> 00:28:32,399
in the ews

785
00:28:32,399 --> 00:28:35,440
that way verify the integrity

786
00:28:35,440 --> 00:28:37,919
now knowing if the plc code was tampered

787
00:28:37,919 --> 00:28:39,600
with is essential for

788
00:28:39,600 --> 00:28:41,919
a few things so number one it will help

789
00:28:41,919 --> 00:28:43,039
you notice

790
00:28:43,039 --> 00:28:45,440
the compromise so if the integrity of

791
00:28:45,440 --> 00:28:46,399
the code

792
00:28:46,399 --> 00:28:50,159
is suspect compare and find out that

793
00:28:50,159 --> 00:28:52,080
what's in the plc is not what you

794
00:28:52,080 --> 00:28:54,000
expected to be that you know you've been

795
00:28:54,000 --> 00:28:55,679
compromised

796
00:28:55,679 --> 00:28:58,799
also after compromise

797
00:28:58,799 --> 00:29:01,600
the file that you have the environment

798
00:29:01,600 --> 00:29:03,440
that you have that you verify

799
00:29:03,440 --> 00:29:06,000
uh with this cross check can then help

800
00:29:06,000 --> 00:29:06,960
you understand

801
00:29:06,960 --> 00:29:10,080
if plc safe to operate after a potential

802
00:29:10,080 --> 00:29:11,840
compromise because you can download that

803
00:29:11,840 --> 00:29:13,600
binary that you know is good

804
00:29:13,600 --> 00:29:16,559
and then done with it and then finally

805
00:29:16,559 --> 00:29:18,559
it's also a means to verify the plc

806
00:29:18,559 --> 00:29:20,159
still running the code approved by the

807
00:29:20,159 --> 00:29:22,080
integrator or the manufacturer

808
00:29:22,080 --> 00:29:24,080
because sometimes that's necessary for

809
00:29:24,080 --> 00:29:25,440
warranty purposes

810
00:29:25,440 --> 00:29:27,919
or perhaps for compliance where you have

811
00:29:27,919 --> 00:29:30,159
to run a particular version of code

812
00:29:30,159 --> 00:29:32,559
and you can confirm by using this

813
00:29:32,559 --> 00:29:35,279
integrity check

814
00:29:37,600 --> 00:29:39,600
going a little bit deeper into some of

815
00:29:39,600 --> 00:29:41,360
the more

816
00:29:41,360 --> 00:29:44,399
interesting ones leave operational logic

817
00:29:44,399 --> 00:29:45,279
in the plc

818
00:29:45,279 --> 00:29:48,720
wherever feasible practice three so

819
00:29:48,720 --> 00:29:51,840
on the right side you see the hmi here

820
00:29:51,840 --> 00:29:54,799
plc here this practice says you know

821
00:29:54,799 --> 00:29:56,880
don't put a lot of code in the hdmi here

822
00:29:56,880 --> 00:29:58,799
but put all the operational code in the

823
00:29:58,799 --> 00:30:00,240
plc

824
00:30:00,240 --> 00:30:03,200
so the operator visualization software

825
00:30:03,200 --> 00:30:04,159
in the hdmi

826
00:30:04,159 --> 00:30:05,919
these days has a lot of coding

827
00:30:05,919 --> 00:30:07,440
capability

828
00:30:07,440 --> 00:30:10,640
initially it was to add a few alarms ad

829
00:30:10,640 --> 00:30:11,360
hoc

830
00:30:11,360 --> 00:30:13,039
maybe change some limits for those

831
00:30:13,039 --> 00:30:15,120
alarms or

832
00:30:15,120 --> 00:30:18,080
give some lower level access to an

833
00:30:18,080 --> 00:30:18,880
operator

834
00:30:18,880 --> 00:30:21,600
to get some kind of code in there

835
00:30:21,600 --> 00:30:23,919
without necessarily touching the plc or

836
00:30:23,919 --> 00:30:25,600
download the controller

837
00:30:25,600 --> 00:30:28,480
however over time some programmers

838
00:30:28,480 --> 00:30:29,039
started

839
00:30:29,039 --> 00:30:31,200
utilizing hmi code because it's just

840
00:30:31,200 --> 00:30:33,440
easy to work with sometimes

841
00:30:33,440 --> 00:30:36,880
however calculating values like

842
00:30:36,880 --> 00:30:38,240
totalizers

843
00:30:38,240 --> 00:30:40,240
if you do that in the hmi versus doing

844
00:30:40,240 --> 00:30:41,279
the plc

845
00:30:41,279 --> 00:30:42,720
uh it's going to be a lot more accurate

846
00:30:42,720 --> 00:30:44,399
than the plc because

847
00:30:44,399 --> 00:30:47,200
uh plc is much closer to the field the i

848
00:30:47,200 --> 00:30:49,600
o is connected to dlc

849
00:30:49,600 --> 00:30:51,919
the latency in communication between the

850
00:30:51,919 --> 00:30:53,520
hmi and the plc

851
00:30:53,520 --> 00:30:55,279
that's a big deal because the hmi is

852
00:30:55,279 --> 00:30:57,519
typically pulling once per second

853
00:30:57,519 --> 00:31:00,799
or every other second or as needed so

854
00:31:00,799 --> 00:31:03,279
if the hmi is not getting enough updates

855
00:31:03,279 --> 00:31:04,960
it's not in a good position to do a

856
00:31:04,960 --> 00:31:07,120
totalizer or a timer

857
00:31:07,120 --> 00:31:10,399
uh based on you know what the plc can do

858
00:31:10,399 --> 00:31:12,399
versus hmi

859
00:31:12,399 --> 00:31:15,840
and then the hdmi usually

860
00:31:15,840 --> 00:31:18,000
deputing in hmi shouldn't cause any

861
00:31:18,000 --> 00:31:19,200
process

862
00:31:19,200 --> 00:31:22,320
upset shouldn't affect the plc operation

863
00:31:22,320 --> 00:31:25,440
however if you use the hdmi for these

864
00:31:25,440 --> 00:31:28,559
datas or updates or values or totalizers

865
00:31:28,559 --> 00:31:30,000
and that's a problem because if you

866
00:31:30,000 --> 00:31:33,039
remove the hmi those gets reset

867
00:31:33,039 --> 00:31:35,360
similarly uh if you're doing a windows

868
00:31:35,360 --> 00:31:37,760
patch or if you're taking a backup

869
00:31:37,760 --> 00:31:39,519
that periods of availability or

870
00:31:39,519 --> 00:31:41,840
unavailability of the hmi

871
00:31:41,840 --> 00:31:44,480
might affect those values which you do

872
00:31:44,480 --> 00:31:46,000
not want

873
00:31:46,000 --> 00:31:48,640
so anything safety or protection layered

874
00:31:48,640 --> 00:31:49,519
is better off

875
00:31:49,519 --> 00:31:52,640
being held by the plc as an example

876
00:31:52,640 --> 00:31:55,679
enable or disable actions i've seen

877
00:31:55,679 --> 00:31:59,279
rare operator clicks on enable button

878
00:31:59,279 --> 00:32:02,480
and that click is shown visualized

879
00:32:02,480 --> 00:32:04,240
to the operator as if the action is

880
00:32:04,240 --> 00:32:06,240
being performed and then the

881
00:32:06,240 --> 00:32:09,440
command is sent to the plc however

882
00:32:09,440 --> 00:32:12,000
what if the plc cannot execute that

883
00:32:12,000 --> 00:32:12,799
command

884
00:32:12,799 --> 00:32:16,960
what if the plc has some force items

885
00:32:16,960 --> 00:32:19,919
that is stopping it from executing it

886
00:32:19,919 --> 00:32:21,679
those are not visible to the operator

887
00:32:21,679 --> 00:32:22,799
because this code is

888
00:32:22,799 --> 00:32:26,159
in the hui similarly uh

889
00:32:26,159 --> 00:32:28,399
if you have a time delay for a motor

890
00:32:28,399 --> 00:32:29,840
restart and you should put that in the

891
00:32:29,840 --> 00:32:31,120
hmi code

892
00:32:31,120 --> 00:32:33,440
what if because of coms issues or any

893
00:32:33,440 --> 00:32:34,880
other problems

894
00:32:34,880 --> 00:32:37,279
uh the hmi cannot calculate the timer

895
00:32:37,279 --> 00:32:38,320
properly that

896
00:32:38,320 --> 00:32:40,159
it's not a safe situation for the order

897
00:32:40,159 --> 00:32:42,240
to restart or not to

898
00:32:42,240 --> 00:32:45,440
start when you wanted to

899
00:32:46,320 --> 00:32:48,559
four signals they're typically visible

900
00:32:48,559 --> 00:32:50,960
only in the plc and not in the hdmi

901
00:32:50,960 --> 00:32:53,519
so you can't really put some safeguards

902
00:32:53,519 --> 00:32:55,120
in the hmi code

903
00:32:55,120 --> 00:32:58,240
as much as you can in the plc

904
00:32:58,240 --> 00:33:01,039
similarly inconsistent visualization or

905
00:33:01,039 --> 00:33:01,840
status

906
00:33:01,840 --> 00:33:04,000
when the hmi values are not populated

907
00:33:04,000 --> 00:33:05,279
back to the plc

908
00:33:05,279 --> 00:33:07,360
so if you configure something new some

909
00:33:07,360 --> 00:33:08,559
new points

910
00:33:08,559 --> 00:33:10,720
some new alarms but they're not

911
00:33:10,720 --> 00:33:12,080
represented in the plc

912
00:33:12,080 --> 00:33:14,159
then you have some inconsistency and

913
00:33:14,159 --> 00:33:15,760
also the plc doesn't know that these

914
00:33:15,760 --> 00:33:17,760
other things exist

915
00:33:17,760 --> 00:33:20,240
and then finally consistency in code

916
00:33:20,240 --> 00:33:20,960
maintenance

917
00:33:20,960 --> 00:33:23,200
audit and change management because you

918
00:33:23,200 --> 00:33:25,440
split the code into two different places

919
00:33:25,440 --> 00:33:29,360
these become difficult furthermore

920
00:33:29,360 --> 00:33:32,399
if you unify your code in the plc you're

921
00:33:32,399 --> 00:33:34,240
reducing the attack surface

922
00:33:34,240 --> 00:33:36,559
you all can imagine more scenarios where

923
00:33:36,559 --> 00:33:37,840
the hmi

924
00:33:37,840 --> 00:33:42,559
is uh open to more public facing maybe

925
00:33:42,559 --> 00:33:45,039
internet and someone is able to access

926
00:33:45,039 --> 00:33:46,559
and move the mouse around

927
00:33:46,559 --> 00:33:48,399
we've seen that for example in the

928
00:33:48,399 --> 00:33:50,159
florida

929
00:33:50,159 --> 00:33:52,799
water situation where they were able to

930
00:33:52,799 --> 00:33:53,200
even

931
00:33:53,200 --> 00:33:57,200
enter some values um much higher than

932
00:33:57,200 --> 00:34:00,399
what the water should contain

933
00:34:00,399 --> 00:34:02,720
those kind of attack scenarios you all

934
00:34:02,720 --> 00:34:03,600
can imagine

935
00:34:03,600 --> 00:34:06,720
in the hmi level however if the code is

936
00:34:06,720 --> 00:34:09,918
in the plc then there's a lot less risk

937
00:34:09,918 --> 00:34:11,119
because

938
00:34:11,119 --> 00:34:13,520
the third actor needs to be a lot more

939
00:34:13,520 --> 00:34:16,480
sophisticated a lot more focused on

940
00:34:16,480 --> 00:34:18,879
preceding the attack versus randomly

941
00:34:18,879 --> 00:34:20,079
moving the mouse around

942
00:34:20,079 --> 00:34:22,719
and enabling disabling anything that

943
00:34:22,719 --> 00:34:25,199
they can see

944
00:34:26,800 --> 00:34:29,280
next up is practice 11 which is

945
00:34:29,280 --> 00:34:32,079
instrument for possibility checks

946
00:34:32,079 --> 00:34:34,879
now i've given an example here for you

947
00:34:34,879 --> 00:34:36,239
all to kind of imagine

948
00:34:36,239 --> 00:34:38,000
some of the examples i'm going to talk

949
00:34:38,000 --> 00:34:40,639
about we have a couple of tanks

950
00:34:40,639 --> 00:34:44,000
some pumps and some instruments here

951
00:34:44,000 --> 00:34:47,599
so this practice is about comparing

952
00:34:47,599 --> 00:34:49,918
integrated and time independent

953
00:34:49,918 --> 00:34:51,040
measurements

954
00:34:51,040 --> 00:34:54,079
to confirm if the measurement that

955
00:34:54,079 --> 00:34:54,960
you're seeing

956
00:34:54,960 --> 00:34:58,400
is accurate for example a meter pump and

957
00:34:58,400 --> 00:34:59,440
tank level

958
00:34:59,440 --> 00:35:02,320
the volumetric change in the time should

959
00:35:02,320 --> 00:35:02,880
equal

960
00:35:02,880 --> 00:35:04,720
or be proportional to the integrated

961
00:35:04,720 --> 00:35:06,240
flow

962
00:35:06,240 --> 00:35:08,640
if it's not then you raise an alert

963
00:35:08,640 --> 00:35:11,040
similarly burner in a boiler

964
00:35:11,040 --> 00:35:13,920
the added caloric heat from the fuel

965
00:35:13,920 --> 00:35:14,400
should

966
00:35:14,400 --> 00:35:16,400
equal or be proportional to the

967
00:35:16,400 --> 00:35:17,920
temperature increase

968
00:35:17,920 --> 00:35:21,680
and if it's not you raise an alert

969
00:35:21,680 --> 00:35:23,520
the idea being compare different

970
00:35:23,520 --> 00:35:24,800
measurement sources

971
00:35:24,800 --> 00:35:26,960
so measuring for example the same

972
00:35:26,960 --> 00:35:28,880
phenomena different ways

973
00:35:28,880 --> 00:35:31,839
another example a compressor stall is

974
00:35:31,839 --> 00:35:33,440
typically

975
00:35:33,440 --> 00:35:36,400
visualized by a reversal of flow however

976
00:35:36,400 --> 00:35:38,720
it will also have increased vibration

977
00:35:38,720 --> 00:35:40,880
so those two are measuring the same

978
00:35:40,880 --> 00:35:43,359
phenomenon in different ways

979
00:35:43,359 --> 00:35:45,920
and also not necessarily different

980
00:35:45,920 --> 00:35:48,079
sensors but maybe the same value coming

981
00:35:48,079 --> 00:35:49,520
from two different communication

982
00:35:49,520 --> 00:35:50,400
channels

983
00:35:50,400 --> 00:35:52,560
maybe that plc has a back brain

984
00:35:52,560 --> 00:35:54,800
communication and the markers out

985
00:35:54,800 --> 00:35:58,000
to the dcs and then also 40 20 milliamps

986
00:35:58,000 --> 00:36:00,800
to uh the dcs or some other equipment

987
00:36:00,800 --> 00:36:02,240
where you can compare

988
00:36:02,240 --> 00:36:05,680
and if it so happens that whoever is

989
00:36:05,680 --> 00:36:06,720
manipulated

990
00:36:06,720 --> 00:36:09,520
one did not leave the other you will get

991
00:36:09,520 --> 00:36:11,520
an alert that something is wrong

992
00:36:11,520 --> 00:36:14,320
so the idea behind this practice is to

993
00:36:14,320 --> 00:36:15,920
facilitate monitoring for

994
00:36:15,920 --> 00:36:18,560
manipulative values as long as not all

995
00:36:18,560 --> 00:36:20,800
sensors are needed at the same time

996
00:36:20,800 --> 00:36:23,680
just another level a layer of protection

997
00:36:23,680 --> 00:36:24,079
uh

998
00:36:24,079 --> 00:36:27,359
in a plc with existed before

999
00:36:27,359 --> 00:36:29,200
now it also prevents acceptance or

1000
00:36:29,200 --> 00:36:31,440
identifies wrong measurements like we

1001
00:36:31,440 --> 00:36:32,960
talked about before

1002
00:36:32,960 --> 00:36:35,280
uh the tank level suddenly shows much

1003
00:36:35,280 --> 00:36:36,000
higher than

1004
00:36:36,000 --> 00:36:38,079
what it should be in correlation with

1005
00:36:38,079 --> 00:36:40,960
the volumetric or the

1006
00:36:40,960 --> 00:36:44,400
flow coming from the flow meter then you

1007
00:36:44,400 --> 00:36:46,400
can identify that some measurement is

1008
00:36:46,400 --> 00:36:47,920
wrong

1009
00:36:47,920 --> 00:36:51,119
also able to rule out the physical

1010
00:36:51,119 --> 00:36:54,160
causes for failures more quickly if you

1011
00:36:54,160 --> 00:36:56,079
do believe that tank level for example

1012
00:36:56,079 --> 00:36:57,040
you might think that

1013
00:36:57,040 --> 00:36:59,359
this particular valve has failed uh

1014
00:36:59,359 --> 00:37:01,200
however if you're comparing that with

1015
00:37:01,200 --> 00:37:03,280
flow you kind of know that the value is

1016
00:37:03,280 --> 00:37:04,560
okay because

1017
00:37:04,560 --> 00:37:06,960
you know based on that flow you could

1018
00:37:06,960 --> 00:37:08,960
not have have this level

1019
00:37:08,960 --> 00:37:11,599
for example

1020
00:37:12,240 --> 00:37:14,320
all right next up is practice seven

1021
00:37:14,320 --> 00:37:16,640
which is validate an alert for paired

1022
00:37:16,640 --> 00:37:17,200
inputs

1023
00:37:17,200 --> 00:37:19,839
and outputs now paired inputs and

1024
00:37:19,839 --> 00:37:22,160
outputs of those that are physically

1025
00:37:22,160 --> 00:37:24,640
not able to happen at the same time for

1026
00:37:24,640 --> 00:37:26,640
example a motor could be

1027
00:37:26,640 --> 00:37:30,079
running or not running so it could be

1028
00:37:30,079 --> 00:37:31,680
started it could be stopped but

1029
00:37:31,680 --> 00:37:34,960
not both at the same time similarly a

1030
00:37:34,960 --> 00:37:36,320
conveyor belt could be

1031
00:37:36,320 --> 00:37:39,040
forward or reverse not both at the same

1032
00:37:39,040 --> 00:37:39,920
time

1033
00:37:39,920 --> 00:37:42,160
and of course the valve could be open or

1034
00:37:42,160 --> 00:37:42,960
closed

1035
00:37:42,960 --> 00:37:45,920
but not both at the same time so the

1036
00:37:45,920 --> 00:37:48,000
pair signals cannot be asserted at the

1037
00:37:48,000 --> 00:37:48,960
same time

1038
00:37:48,960 --> 00:37:52,880
unless there is a failure for example

1039
00:37:52,880 --> 00:37:54,640
uh there's open limits which is working

1040
00:37:54,640 --> 00:37:56,800
fine but the close limits each field

1041
00:37:56,800 --> 00:37:58,960
also shows close uh so that's an

1042
00:37:58,960 --> 00:38:00,320
instrument failure

1043
00:38:00,320 --> 00:38:02,800
or a malicious activity where someone is

1044
00:38:02,800 --> 00:38:04,320
trying to force a bunch of things

1045
00:38:04,320 --> 00:38:06,720
and they also have to force both the

1046
00:38:06,720 --> 00:38:08,000
open and close

1047
00:38:08,000 --> 00:38:09,760
uh or also the clones when those

1048
00:38:09,760 --> 00:38:12,079
actually open

1049
00:38:12,079 --> 00:38:13,839
now some additional recommendations as

1050
00:38:13,839 --> 00:38:15,200
part of this practice

1051
00:38:15,200 --> 00:38:17,359
is to configure start and stop has

1052
00:38:17,359 --> 00:38:18,560
distinct outputs

1053
00:38:18,560 --> 00:38:21,359
as long as the mcc is capable of

1054
00:38:21,359 --> 00:38:22,000
receiving

1055
00:38:22,000 --> 00:38:24,240
receiving those outputs instead of a

1056
00:38:24,240 --> 00:38:26,320
single output that can be toggled on and

1057
00:38:26,320 --> 00:38:27,040
off

1058
00:38:27,040 --> 00:38:29,119
because it's way more complicated to

1059
00:38:29,119 --> 00:38:30,880
rapidly toggle

1060
00:38:30,880 --> 00:38:32,720
two distinct outputs especially if

1061
00:38:32,720 --> 00:38:34,720
they're pretty set a certain way

1062
00:38:34,720 --> 00:38:37,520
it's very difficult in the plc versus

1063
00:38:37,520 --> 00:38:38,320
just one out

1064
00:38:38,320 --> 00:38:42,640
that you can switch on and off

1065
00:38:42,640 --> 00:38:44,960
and then also consider adding a timer or

1066
00:38:44,960 --> 00:38:46,000
restart after

1067
00:38:46,000 --> 00:38:48,880
stop is issued this again helps in

1068
00:38:48,880 --> 00:38:50,720
avoiding rapid targeting of the start

1069
00:38:50,720 --> 00:38:52,079
stop signals

1070
00:38:52,079 --> 00:38:57,599
whether due to errors or bad intent

1071
00:38:57,760 --> 00:38:59,599
and finally uh let's take a look at

1072
00:38:59,599 --> 00:39:00,960
practice 16

1073
00:39:00,960 --> 00:39:03,920
which is summarize plc cycle times and

1074
00:39:03,920 --> 00:39:06,560
turn them on the hmi

1075
00:39:06,560 --> 00:39:08,560
so cycle time is the time it takes to

1076
00:39:08,560 --> 00:39:10,640
compute each iteration of the logic from

1077
00:39:10,640 --> 00:39:13,359
plc and these cycle times should be

1078
00:39:13,359 --> 00:39:15,040
fairly constant in the plc

1079
00:39:15,040 --> 00:39:16,880
unless there are changes to that

1080
00:39:16,880 --> 00:39:19,440
environment or the plc logic

1081
00:39:19,440 --> 00:39:22,480
or the process as an example here

1082
00:39:22,480 --> 00:39:26,160
you see um the time over here and then

1083
00:39:26,160 --> 00:39:27,359
the cycle times

1084
00:39:27,359 --> 00:39:30,800
so the expected fluctuation

1085
00:39:30,800 --> 00:39:32,320
a little bit here but then every so

1086
00:39:32,320 --> 00:39:34,079
often you get the spike which

1087
00:39:34,079 --> 00:39:36,960
could be malicious code now unusual

1088
00:39:36,960 --> 00:39:38,800
cycle time changes can be an indicator

1089
00:39:38,800 --> 00:39:41,280
that the plc logic has changed has been

1090
00:39:41,280 --> 00:39:42,880
added

1091
00:39:42,880 --> 00:39:45,359
visualizing these values over time draws

1092
00:39:45,359 --> 00:39:47,839
attention to these anomalies

1093
00:39:47,839 --> 00:39:49,359
because let's say you have a threshold

1094
00:39:49,359 --> 00:39:51,359
somewhere here none of these

1095
00:39:51,359 --> 00:39:54,160
trigger of it but visualizing it this

1096
00:39:54,160 --> 00:39:54,480
way

1097
00:39:54,480 --> 00:39:57,520
this manner can help you understand that

1098
00:39:57,520 --> 00:39:59,440
something is going on

1099
00:39:59,440 --> 00:40:02,560
so many plcs have this maximum cycle

1100
00:40:02,560 --> 00:40:04,960
time monitoring at the hardware level

1101
00:40:04,960 --> 00:40:08,319
so in this graph the number of cycles at

1102
00:40:08,319 --> 00:40:10,000
the time for the cycle

1103
00:40:10,000 --> 00:40:13,040
so if it exceeds a maximum value

1104
00:40:13,040 --> 00:40:16,240
usually the cpu issues a stop so at this

1105
00:40:16,240 --> 00:40:17,119
tmax

1106
00:40:17,119 --> 00:40:20,160
is number five uh the cpu would stop

1107
00:40:20,160 --> 00:40:22,400
so attackers will know this so they

1108
00:40:22,400 --> 00:40:24,880
typically don't add code that much they

1109
00:40:24,880 --> 00:40:27,200
typically keep their code so that you

1110
00:40:27,200 --> 00:40:28,880
never reach that threshold

1111
00:40:28,880 --> 00:40:31,760
however if you happen to create these

1112
00:40:31,760 --> 00:40:32,800
boundaries have

1113
00:40:32,800 --> 00:40:35,119
these acceptable thresholds so one and

1114
00:40:35,119 --> 00:40:36,319
three would be okay

1115
00:40:36,319 --> 00:40:39,200
but anything about would be alerted uh

1116
00:40:39,200 --> 00:40:41,119
this would be based on the application

1117
00:40:41,119 --> 00:40:42,400
the process engineers

1118
00:40:42,400 --> 00:40:44,560
understanding of the process and the plc

1119
00:40:44,560 --> 00:40:45,839
controls engineer

1120
00:40:45,839 --> 00:40:47,520
working with the process engineer

1121
00:40:47,520 --> 00:40:48,960
defined these thresholds

1122
00:40:48,960 --> 00:40:50,839
but the idea being about these

1123
00:40:50,839 --> 00:40:52,720
thresholds uh if you have some

1124
00:40:52,720 --> 00:40:55,599
uh alerts then if and when some

1125
00:40:55,599 --> 00:40:56,720
malicious traffic

1126
00:40:56,720 --> 00:41:00,800
once you scroll and plc uh cycle time is

1127
00:41:00,800 --> 00:41:01,280
higher

1128
00:41:01,280 --> 00:41:05,280
than what it should be you get over it

1129
00:41:05,280 --> 00:41:07,359
all right now i headed over to sarah to

1130
00:41:07,359 --> 00:41:08,640
talk further

1131
00:41:08,640 --> 00:41:10,640
about what the expectations are on the

1132
00:41:10,640 --> 00:41:12,319
project

1133
00:41:12,319 --> 00:41:15,440
so yeah that's me again and

1134
00:41:15,440 --> 00:41:20,400
actually um my last words are about

1135
00:41:20,400 --> 00:41:23,599
the outlook what what do we have to

1136
00:41:23,599 --> 00:41:25,040
what what do we do we do with this

1137
00:41:25,040 --> 00:41:26,880
project in the future because obviously

1138
00:41:26,880 --> 00:41:28,720
we're not done yet uh we've worked on

1139
00:41:28,720 --> 00:41:30,560
this for about a year

1140
00:41:30,560 --> 00:41:33,680
um we put our first document out and we

1141
00:41:33,680 --> 00:41:35,359
don't have got a lot of things that we

1142
00:41:35,359 --> 00:41:37,280
that we need to do and the important

1143
00:41:37,280 --> 00:41:38,560
thing to know is

1144
00:41:38,560 --> 00:41:42,720
there's a core team um that meets every

1145
00:41:42,720 --> 00:41:45,760
couple of weeks um and that has a few

1146
00:41:45,760 --> 00:41:47,280
things on its to-do list

1147
00:41:47,280 --> 00:41:49,839
so one is we are thinking about doing

1148
00:41:49,839 --> 00:41:52,400
top 20 secure plc environment practices

1149
00:41:52,400 --> 00:41:54,640
for example we're thinking about

1150
00:41:54,640 --> 00:41:56,400
building a playground so building

1151
00:41:56,400 --> 00:41:57,359
virtual

1152
00:41:57,359 --> 00:42:00,400
prc's where you can try out practices

1153
00:42:00,400 --> 00:42:01,040
virtually

1154
00:42:01,040 --> 00:42:02,800
where there are demonstrators that could

1155
00:42:02,800 --> 00:42:06,480
download or try out online

1156
00:42:06,720 --> 00:42:09,200
of course we're thinking about improving

1157
00:42:09,200 --> 00:42:10,319
the practices

1158
00:42:10,319 --> 00:42:13,920
or publishing a version 2.0 based on

1159
00:42:13,920 --> 00:42:17,359
comments that come in if you go to our

1160
00:42:17,359 --> 00:42:19,359
website that i'll show you in a minute

1161
00:42:19,359 --> 00:42:21,119
you can download the comment form and

1162
00:42:21,119 --> 00:42:22,720
leave us any comment you want and

1163
00:42:22,720 --> 00:42:25,040
they're really all welcome

1164
00:42:25,040 --> 00:42:28,000
and we want to improve these practices

1165
00:42:28,000 --> 00:42:29,280
comments can be

1166
00:42:29,280 --> 00:42:31,040
this practice doesn't make sense it can

1167
00:42:31,040 --> 00:42:32,720
be i implemented this and this could be

1168
00:42:32,720 --> 00:42:34,079
a good example

1169
00:42:34,079 --> 00:42:36,800
it can be i don't understand this uh we

1170
00:42:36,800 --> 00:42:38,720
could explain that better this way

1171
00:42:38,720 --> 00:42:40,800
or it can be i've got a completely new

1172
00:42:40,800 --> 00:42:42,960
practice that needs to be on that list

1173
00:42:42,960 --> 00:42:44,720
that i want to propose we've got a

1174
00:42:44,720 --> 00:42:46,960
template for that

1175
00:42:46,960 --> 00:42:49,119
we're also working on translations to

1176
00:42:49,119 --> 00:42:50,720
other languages because

1177
00:42:50,720 --> 00:42:53,119
obviously we want engineers to adopt

1178
00:42:53,119 --> 00:42:54,079
that list

1179
00:42:54,079 --> 00:42:56,079
and the easiest way to adopt something

1180
00:42:56,079 --> 00:42:57,520
that is

1181
00:42:57,520 --> 00:42:59,599
in your languages in your language it's

1182
00:42:59,599 --> 00:43:01,839
just just way easier

1183
00:43:01,839 --> 00:43:04,560
and we're also thinking about training

1184
00:43:04,560 --> 00:43:05,599
template for

1185
00:43:05,599 --> 00:43:07,760
prc coding practices how to involve them

1186
00:43:07,760 --> 00:43:09,599
in purchasing specifications because

1187
00:43:09,599 --> 00:43:10,480
that's one

1188
00:43:10,480 --> 00:43:13,200
easy application that could be a lot of

1189
00:43:13,200 --> 00:43:14,560
use for

1190
00:43:14,560 --> 00:43:17,839
for users for asset owners

1191
00:43:17,839 --> 00:43:20,560
and that's the core team we've got

1192
00:43:20,560 --> 00:43:21,920
commenters so

1193
00:43:21,920 --> 00:43:24,880
i said that before uh everyone is is

1194
00:43:24,880 --> 00:43:26,560
really invited to comment it's not a lot

1195
00:43:26,560 --> 00:43:28,640
of work and we're looking forward to

1196
00:43:28,640 --> 00:43:31,119
talking about your comments um we've got

1197
00:43:31,119 --> 00:43:33,440
supporters who build trainings

1198
00:43:33,440 --> 00:43:36,560
who write articles and podcasts and uh

1199
00:43:36,560 --> 00:43:38,560
we're thinking about collaborations

1200
00:43:38,560 --> 00:43:41,760
which is a an important part so we are

1201
00:43:41,760 --> 00:43:44,640
collaborating with mitre cwe in order to

1202
00:43:44,640 --> 00:43:45,760
maybe

1203
00:43:45,760 --> 00:43:49,440
um put a module for plc's

1204
00:43:49,440 --> 00:43:51,680
in cwe because it doesn't have something

1205
00:43:51,680 --> 00:43:52,839
like this not

1206
00:43:52,839 --> 00:43:56,000
yet but we really really really and

1207
00:43:56,000 --> 00:43:57,839
that's one of the most important points

1208
00:43:57,839 --> 00:43:59,599
that i want to make in the end

1209
00:43:59,599 --> 00:44:02,319
we we want to get this list seen by

1210
00:44:02,319 --> 00:44:03,040
engineers

1211
00:44:03,040 --> 00:44:06,319
used by engineers trained for

1212
00:44:06,319 --> 00:44:08,800
engineers we want to get this list out

1213
00:44:08,800 --> 00:44:09,920
there

1214
00:44:09,920 --> 00:44:13,040
and we're really looking into

1215
00:44:13,040 --> 00:44:14,880
how to best reach engineers because

1216
00:44:14,880 --> 00:44:16,640
security bubble knows about this

1217
00:44:16,640 --> 00:44:19,119
but we need engineers to know about this

1218
00:44:19,119 --> 00:44:20,319
so we're looking for engineers

1219
00:44:20,319 --> 00:44:22,000
associations we're really interested

1220
00:44:22,000 --> 00:44:24,480
in what plc vendors says say we're

1221
00:44:24,480 --> 00:44:27,119
really interested into plc user groups

1222
00:44:27,119 --> 00:44:30,000
um if you have contact in there contact

1223
00:44:30,000 --> 00:44:30,319
us

1224
00:44:30,319 --> 00:44:32,079
we can get these slides there we can get

1225
00:44:32,079 --> 00:44:34,319
a presentation organized we can get

1226
00:44:34,319 --> 00:44:36,240
trainings organized we can we can get

1227
00:44:36,240 --> 00:44:37,440
you in there

1228
00:44:37,440 --> 00:44:39,280
we collaborate with you in order to

1229
00:44:39,280 --> 00:44:40,480
bring these

1230
00:44:40,480 --> 00:44:43,680
knowledge into your communities locally

1231
00:44:43,680 --> 00:44:45,599
regionally we have people all around the

1232
00:44:45,599 --> 00:44:47,760
world in the project that are happy to

1233
00:44:47,760 --> 00:44:49,040
do that

1234
00:44:49,040 --> 00:44:51,119
and lastly what's very important

1235
00:44:51,119 --> 00:44:52,720
important in this slide is the green

1236
00:44:52,720 --> 00:44:53,440
bubbles

1237
00:44:53,440 --> 00:44:55,520
so this is not a close club it's a

1238
00:44:55,520 --> 00:44:57,839
community project and we really

1239
00:44:57,839 --> 00:45:00,800
want and need everyone who is interested

1240
00:45:00,800 --> 00:45:01,280
uh

1241
00:45:01,280 --> 00:45:04,079
and passionate about making plcs more

1242
00:45:04,079 --> 00:45:05,760
secure you don't have to be as

1243
00:45:05,760 --> 00:45:07,920
a pse programmer you don't have to be a

1244
00:45:07,920 --> 00:45:09,520
security expert

1245
00:45:09,520 --> 00:45:11,680
if you're passionate enough you can

1246
00:45:11,680 --> 00:45:12,720
totally

1247
00:45:12,720 --> 00:45:15,839
um use your knowledge and your

1248
00:45:15,839 --> 00:45:18,400
engagement and it really in each of

1249
00:45:18,400 --> 00:45:19,200
these groups

1250
00:45:19,200 --> 00:45:21,760
there's not a lot of space for for

1251
00:45:21,760 --> 00:45:23,599
taking up new people and we welcome you

1252
00:45:23,599 --> 00:45:25,839
with open arms

1253
00:45:25,839 --> 00:45:29,119
lastly here's the project website

1254
00:45:29,119 --> 00:45:31,040
and here's our are all our contact

1255
00:45:31,040 --> 00:45:33,760
details if you want to

1256
00:45:33,760 --> 00:45:35,920
contribute if you want to become part of

1257
00:45:35,920 --> 00:45:37,040
any of the teams

1258
00:45:37,040 --> 00:45:39,839
of the core team shoot an email to plc

1259
00:45:39,839 --> 00:45:41,079
security at

1260
00:45:41,079 --> 00:45:43,599
nurizia.de uh we've got a twitter

1261
00:45:43,599 --> 00:45:45,200
account you can follow

1262
00:45:45,200 --> 00:45:47,119
both vivec and io on twitter and on

1263
00:45:47,119 --> 00:45:48,880
linkedin

1264
00:45:48,880 --> 00:45:51,920
and there's also

1265
00:45:51,920 --> 00:45:54,400
a comment form on that website here you

1266
00:45:54,400 --> 00:45:56,000
can download and send to that email

1267
00:45:56,000 --> 00:45:58,000
address

1268
00:45:58,000 --> 00:46:00,000
you would be very very happy to hear

1269
00:46:00,000 --> 00:46:01,760
from you i hope you learned something

1270
00:46:01,760 --> 00:46:03,680
about secure plcs today

1271
00:46:03,680 --> 00:46:06,720
and i hope you continue enjoying defcon

1272
00:46:06,720 --> 00:46:10,640
thank you

