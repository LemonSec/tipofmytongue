1
00:00:00,160 --> 00:00:06,160
hello everybody welcome to this talk

2
00:00:03,040 --> 00:00:08,320
um my name is jose garduno and the title

3
00:00:06,160 --> 00:00:10,559
of the talk is c2 centipede

4
00:00:08,320 --> 00:00:12,880
it's actually the name of a tool i made

5
00:00:10,559 --> 00:00:17,600
to try to evade certain type

6
00:00:12,880 --> 00:00:20,640
of blue team detection strategies

7
00:00:17,600 --> 00:00:24,160
um a little bit about me

8
00:00:20,640 --> 00:00:27,279
um okay i was born in mexico

9
00:00:24,160 --> 00:00:30,320
i took a small detour um i

10
00:00:27,279 --> 00:00:33,760
ended up in switzerland after 15 years

11
00:00:30,320 --> 00:00:36,399
of wandering around um i'm a

12
00:00:33,760 --> 00:00:38,000
senior security consultant for dream lab

13
00:00:36,399 --> 00:00:41,280
technologies

14
00:00:38,000 --> 00:00:44,480
and i have been in the aldi team

15
00:00:41,280 --> 00:00:45,520
since uh the year 2014 so basically pen

16
00:00:44,480 --> 00:00:48,640
testing

17
00:00:45,520 --> 00:00:51,120
infrastructure applications

18
00:00:48,640 --> 00:00:51,920
and so on i have been a speaker

19
00:00:51,120 --> 00:00:54,960
previously in

20
00:00:51,920 --> 00:00:57,600
other conferences i would actually

21
00:00:54,960 --> 00:00:58,000
recommend you um especially the ones in

22
00:00:57,600 --> 00:01:01,680
latin

23
00:00:58,000 --> 00:01:04,720
america um very nice

24
00:01:01,680 --> 00:01:08,000
and uh fun places to be

25
00:01:04,720 --> 00:01:09,360
okay so let's start why are you here why

26
00:01:08,000 --> 00:01:12,479
are you watching this

27
00:01:09,360 --> 00:01:14,960
so you are a red teamer and you know

28
00:01:12,479 --> 00:01:17,520
and you want to know how your tools work

29
00:01:14,960 --> 00:01:20,960
so you use metasploit or empire

30
00:01:17,520 --> 00:01:24,560
and a little bit of how it works

31
00:01:20,960 --> 00:01:27,280
it's magic to you like how do you

32
00:01:24,560 --> 00:01:29,439
get the shell what's happening behind

33
00:01:27,280 --> 00:01:32,320
the scenes

34
00:01:29,439 --> 00:01:33,119
also it could be that you are not an apt

35
00:01:32,320 --> 00:01:36,400
but you want to

36
00:01:33,119 --> 00:01:39,840
emulate more advanced scenarios

37
00:01:36,400 --> 00:01:41,920
than what the default vanilla metasploit

38
00:01:39,840 --> 00:01:44,720
or empire can give you

39
00:01:41,920 --> 00:01:46,560
and also you want interactive shell

40
00:01:44,720 --> 00:01:49,680
without getting detected by your

41
00:01:46,560 --> 00:01:51,360
tools beaconing okay so this is one

42
00:01:49,680 --> 00:01:54,240
reason for the red teamers

43
00:01:51,360 --> 00:01:54,560
and for the blue team of course how can

44
00:01:54,240 --> 00:01:58,000
you

45
00:01:54,560 --> 00:01:58,560
catch the bad guys now i will talk about

46
00:01:58,000 --> 00:02:00,880
some

47
00:01:58,560 --> 00:02:02,719
techniques how you can do it right now

48
00:02:00,880 --> 00:02:06,560
and of course uh

49
00:02:02,719 --> 00:02:10,479
with the techniques presented here um

50
00:02:06,560 --> 00:02:13,360
what's maybe coming next um

51
00:02:10,479 --> 00:02:14,959
so you can see um what the bad guys are

52
00:02:13,360 --> 00:02:18,160
planning

53
00:02:14,959 --> 00:02:19,200
so the context of these um basically i

54
00:02:18,160 --> 00:02:20,879
just approached the

55
00:02:19,200 --> 00:02:22,720
the blue team the sub team at dream

56
00:02:20,879 --> 00:02:24,640
dreamlab because i

57
00:02:22,720 --> 00:02:26,400
i wanted to learn uh their techniques

58
00:02:24,640 --> 00:02:29,120
basically i'm a little bit uh

59
00:02:26,400 --> 00:02:29,920
maybe sometimes too focused on the

60
00:02:29,120 --> 00:02:33,040
offensive

61
00:02:29,920 --> 00:02:36,080
part and yeah you just

62
00:02:33,040 --> 00:02:38,480
hope they don't catch you or yeah

63
00:02:36,080 --> 00:02:39,200
so so so this was a little bit of

64
00:02:38,480 --> 00:02:42,400
finding out

65
00:02:39,200 --> 00:02:44,239
what the blue team uh is doing now uh

66
00:02:42,400 --> 00:02:44,959
what techniques they use what tools i

67
00:02:44,239 --> 00:02:49,280
use and

68
00:02:44,959 --> 00:02:50,959
maybe how i could evade them

69
00:02:49,280 --> 00:02:52,879
the talk is about this journey to try to

70
00:02:50,959 --> 00:02:54,480
evade the blue team detection on the

71
00:02:52,879 --> 00:02:57,440
network only so

72
00:02:54,480 --> 00:02:58,959
i will not talk about antivirus evasion

73
00:02:57,440 --> 00:03:03,120
or any other

74
00:02:58,959 --> 00:03:03,120
host based evasion

75
00:03:03,200 --> 00:03:07,200
in this tool i implemented some

76
00:03:04,800 --> 00:03:10,319
techniques new techniques used by

77
00:03:07,200 --> 00:03:12,000
apts um and i will briefly

78
00:03:10,319 --> 00:03:14,080
go over some vulnerabilities i

79
00:03:12,000 --> 00:03:17,360
discovered along the way

80
00:03:14,080 --> 00:03:20,159
um okay so uh

81
00:03:17,360 --> 00:03:21,120
the basic objectives as an adversary

82
00:03:20,159 --> 00:03:24,480
especially

83
00:03:21,120 --> 00:03:27,840
uh let's say a red team adversary is

84
00:03:24,480 --> 00:03:31,760
to maintain access in the organization

85
00:03:27,840 --> 00:03:35,120
and to to have this interactive command

86
00:03:31,760 --> 00:03:38,720
with the hosts inside the organization

87
00:03:35,120 --> 00:03:40,720
and maybe exfiltrate some data

88
00:03:38,720 --> 00:03:42,000
you also you also want to have a

89
00:03:40,720 --> 00:03:44,239
resilient

90
00:03:42,000 --> 00:03:46,319
command and control infrastructure so

91
00:03:44,239 --> 00:03:48,159
basically um

92
00:03:46,319 --> 00:03:49,440
maybe the blue team will try to block

93
00:03:48,159 --> 00:03:52,480
you or

94
00:03:49,440 --> 00:03:56,319
um they will try to bring down your

95
00:03:52,480 --> 00:03:59,760
infrastructure as well um

96
00:03:56,319 --> 00:04:02,640
and then how can you do this

97
00:03:59,760 --> 00:04:04,159
while staying as anonymous as possible

98
00:04:02,640 --> 00:04:08,239
so we will discuss

99
00:04:04,159 --> 00:04:11,200
that as well so basically uh

100
00:04:08,239 --> 00:04:11,760
i just started surveying what techniques

101
00:04:11,200 --> 00:04:15,599
are

102
00:04:11,760 --> 00:04:19,759
ipts using using most of them are used

103
00:04:15,599 --> 00:04:21,680
with botnets so like fast flux networks

104
00:04:19,759 --> 00:04:23,199
where there is a domain name that

105
00:04:21,680 --> 00:04:26,880
responds with

106
00:04:23,199 --> 00:04:28,960
several or very many ips to to every

107
00:04:26,880 --> 00:04:30,960
request they get so this is why they get

108
00:04:28,960 --> 00:04:33,600
the the name fast flux

109
00:04:30,960 --> 00:04:34,800
uh and basically they they both nets for

110
00:04:33,600 --> 00:04:37,120
example have

111
00:04:34,800 --> 00:04:38,080
um or they install like a proxy so they

112
00:04:37,120 --> 00:04:41,520
can use uh

113
00:04:38,080 --> 00:04:44,639
all of these um all of this uh

114
00:04:41,520 --> 00:04:47,840
infected hosts to um

115
00:04:44,639 --> 00:04:49,919
to proxy the uh the traffic

116
00:04:47,840 --> 00:04:51,759
from the victim to the command and

117
00:04:49,919 --> 00:04:55,280
control server

118
00:04:51,759 --> 00:04:56,880
um also the use um especially for

119
00:04:55,280 --> 00:04:58,560
for botnets as well uh the main

120
00:04:56,880 --> 00:05:02,560
generation algorithms

121
00:04:58,560 --> 00:05:03,759
so basically um adversaries don't have

122
00:05:02,560 --> 00:05:07,919
too

123
00:05:03,759 --> 00:05:10,320
hard hard code um a domain name

124
00:05:07,919 --> 00:05:11,199
that maybe if they do reverse

125
00:05:10,320 --> 00:05:14,960
engineering

126
00:05:11,199 --> 00:05:18,960
they can maybe sinkhole it or if they

127
00:05:14,960 --> 00:05:21,840
uh add some hard coded ips

128
00:05:18,960 --> 00:05:24,080
they can just perform some maybe a

129
00:05:21,840 --> 00:05:26,160
sandbox analysis or something like this

130
00:05:24,080 --> 00:05:27,840
and get the ip and then just block it

131
00:05:26,160 --> 00:05:31,199
right so this is why they use

132
00:05:27,840 --> 00:05:34,400
domain generation algorithms also

133
00:05:31,199 --> 00:05:37,600
a very common technique for hiding

134
00:05:34,400 --> 00:05:40,560
malicious traffic is domain fronting

135
00:05:37,600 --> 00:05:41,120
and yeah well i will talk about that and

136
00:05:40,560 --> 00:05:44,400
how

137
00:05:41,120 --> 00:05:46,639
all of this is somehow integrated in the

138
00:05:44,400 --> 00:05:46,639
tool

139
00:05:47,039 --> 00:05:50,479
so uh let's talk about shells so

140
00:05:49,360 --> 00:05:54,160
basically a shell

141
00:05:50,479 --> 00:05:57,280
allows you to execute interactive

142
00:05:54,160 --> 00:05:57,600
commands in a host right that you you

143
00:05:57,280 --> 00:06:00,800
have

144
00:05:57,600 --> 00:06:03,840
already um owned via fishing or

145
00:06:00,800 --> 00:06:07,759
an exploit or something like this

146
00:06:03,840 --> 00:06:10,479
there are basically two types of shells

147
00:06:07,759 --> 00:06:12,000
the bind shell which listens on the

148
00:06:10,479 --> 00:06:14,639
target

149
00:06:12,000 --> 00:06:16,160
or on the victim basically the malware

150
00:06:14,639 --> 00:06:19,440
opens a court

151
00:06:16,160 --> 00:06:20,080
on the on the victim host and then the

152
00:06:19,440 --> 00:06:23,600
attacker

153
00:06:20,080 --> 00:06:26,560
uh connects to the victim in that port

154
00:06:23,600 --> 00:06:27,600
and uh starts executing uh commands

155
00:06:26,560 --> 00:06:30,880
there

156
00:06:27,600 --> 00:06:34,080
um this works when there is

157
00:06:30,880 --> 00:06:37,360
not a firewall here or maybe

158
00:06:34,080 --> 00:06:40,880
maybe this user is not it so the

159
00:06:37,360 --> 00:06:44,000
attacker has uh difficulty reaching

160
00:06:40,880 --> 00:06:44,639
the the victim inside this network

161
00:06:44,000 --> 00:06:47,759
network

162
00:06:44,639 --> 00:06:50,880
or through this firewall

163
00:06:47,759 --> 00:06:51,680
so the alternative is a reverse shell a

164
00:06:50,880 --> 00:06:54,080
reverse shell

165
00:06:51,680 --> 00:06:55,759
uh is the other way around instead of

166
00:06:54,080 --> 00:06:58,400
the attacker connecting

167
00:06:55,759 --> 00:06:59,120
um to the victim the the roles are

168
00:06:58,400 --> 00:07:02,800
inversed

169
00:06:59,120 --> 00:07:04,560
so the attacker um open support in his

170
00:07:02,800 --> 00:07:07,919
machine or in a server he

171
00:07:04,560 --> 00:07:09,199
controls and then um the malware he

172
00:07:07,919 --> 00:07:12,400
executes on the victim

173
00:07:09,199 --> 00:07:16,080
makes the connection back to his

174
00:07:12,400 --> 00:07:18,639
server some types of reverse shells

175
00:07:16,080 --> 00:07:20,000
with a basic simple tcp connection like

176
00:07:18,639 --> 00:07:23,840
i just talked about

177
00:07:20,000 --> 00:07:27,280
with netcut or like this very simple

178
00:07:23,840 --> 00:07:30,560
very typical vash uh reverse shell

179
00:07:27,280 --> 00:07:31,280
another way is to have a http reverse

180
00:07:30,560 --> 00:07:34,479
shell

181
00:07:31,280 --> 00:07:36,479
so basically here the attacker hosts an

182
00:07:34,479 --> 00:07:40,400
http service

183
00:07:36,479 --> 00:07:43,280
and the victim connects to it asking for

184
00:07:40,400 --> 00:07:44,000
commands to execute so basically the

185
00:07:43,280 --> 00:07:46,639
victim connect

186
00:07:44,000 --> 00:07:47,360
says uh do i have something to execute

187
00:07:46,639 --> 00:07:50,560
and the

188
00:07:47,360 --> 00:07:53,680
um the server says then

189
00:07:50,560 --> 00:07:54,080
yes you you can execute this the victim

190
00:07:53,680 --> 00:07:56,879
will

191
00:07:54,080 --> 00:07:58,400
execute it and will send the result back

192
00:07:56,879 --> 00:08:01,599
to the attacker

193
00:07:58,400 --> 00:08:04,560
why choose uh reverse http shells

194
00:08:01,599 --> 00:08:06,639
so outgoing http traffic is usually

195
00:08:04,560 --> 00:08:09,280
allowed in enterprise networks

196
00:08:06,639 --> 00:08:09,919
um a lot there is a lot of traffic to

197
00:08:09,280 --> 00:08:14,080
blend

198
00:08:09,919 --> 00:08:17,360
in um there are also different

199
00:08:14,080 --> 00:08:20,560
very wide variety of content

200
00:08:17,360 --> 00:08:23,280
inside this http uh traffic where

201
00:08:20,560 --> 00:08:25,520
um where you can hide your command

202
00:08:23,280 --> 00:08:27,039
control communications

203
00:08:25,520 --> 00:08:28,560
additionally techniques like domain

204
00:08:27,039 --> 00:08:33,760
fronting can help you

205
00:08:28,560 --> 00:08:37,200
hide this traffic this malicious traffic

206
00:08:33,760 --> 00:08:40,479
then let's look at a specific example on

207
00:08:37,200 --> 00:08:43,599
how metasploit reverse shell

208
00:08:40,479 --> 00:08:46,720
payload works so basically you have here

209
00:08:43,599 --> 00:08:48,320
the metasploit handler and

210
00:08:46,720 --> 00:08:50,000
in the other side you have a interpreter

211
00:08:48,320 --> 00:08:53,600
or the metasploit

212
00:08:50,000 --> 00:08:57,120
trojan when you execute it

213
00:08:53,600 --> 00:09:00,480
trojan it makes a request

214
00:08:57,120 --> 00:09:01,600
a get request to the server asking if

215
00:09:00,480 --> 00:09:03,760
there are any commands

216
00:09:01,600 --> 00:09:05,040
that it needs to execute if they are

217
00:09:03,760 --> 00:09:07,760
known the

218
00:09:05,040 --> 00:09:08,560
the server responds with the http

219
00:09:07,760 --> 00:09:11,200
response

220
00:09:08,560 --> 00:09:12,399
there is nothing you should execute the

221
00:09:11,200 --> 00:09:15,760
trojan then waits

222
00:09:12,399 --> 00:09:18,959
for 10 seconds and it asks

223
00:09:15,760 --> 00:09:19,920
again the same thing in the meanwhile an

224
00:09:18,959 --> 00:09:23,839
attacker can say

225
00:09:19,920 --> 00:09:24,560
okay i want these uh trojan to actually

226
00:09:23,839 --> 00:09:27,360
execute

227
00:09:24,560 --> 00:09:28,240
this command so the next time the

228
00:09:27,360 --> 00:09:31,040
meterpreter

229
00:09:28,240 --> 00:09:31,360
goes to the http server and asks do you

230
00:09:31,040 --> 00:09:34,480
got

231
00:09:31,360 --> 00:09:36,720
a command for me the um

232
00:09:34,480 --> 00:09:38,880
this http server will actually respond

233
00:09:36,720 --> 00:09:39,760
yes i have a command that i need you to

234
00:09:38,880 --> 00:09:42,800
execute

235
00:09:39,760 --> 00:09:43,200
so the trojan will execute it and then

236
00:09:42,800 --> 00:09:47,040
will

237
00:09:43,200 --> 00:09:50,560
post with the http post request

238
00:09:47,040 --> 00:09:51,200
will post the result so as you can see

239
00:09:50,560 --> 00:09:54,959
there are

240
00:09:51,200 --> 00:09:58,320
like this a very continuous

241
00:09:54,959 --> 00:10:00,080
request this is called a beacon

242
00:09:58,320 --> 00:10:02,480
how is actually the beginning

243
00:10:00,080 --> 00:10:03,200
implemented in metasploit so i said 10

244
00:10:02,480 --> 00:10:06,320
seconds

245
00:10:03,200 --> 00:10:08,160
before it's a little bit more

246
00:10:06,320 --> 00:10:11,279
complicated than that but uh

247
00:10:08,160 --> 00:10:12,800
not so much so when metasploit con or

248
00:10:11,279 --> 00:10:14,079
when the trojan of metaplay the

249
00:10:12,800 --> 00:10:18,160
meterpreter connects

250
00:10:14,079 --> 00:10:21,519
uh to the server the initial interval

251
00:10:18,160 --> 00:10:23,279
between each connection is about

252
00:10:21,519 --> 00:10:24,800
one tenth of a second so 100

253
00:10:23,279 --> 00:10:28,000
milliseconds and

254
00:10:24,800 --> 00:10:28,480
every time the trojan doesn't get any

255
00:10:28,000 --> 00:10:31,920
task

256
00:10:28,480 --> 00:10:32,959
to execute it adds another 100

257
00:10:31,920 --> 00:10:36,560
milliseconds

258
00:10:32,959 --> 00:10:38,880
so the interval starts growing

259
00:10:36,560 --> 00:10:40,720
until it's 10 seconds after it's 10

260
00:10:38,880 --> 00:10:43,360
seconds it just keeps

261
00:10:40,720 --> 00:10:44,000
the interval at 10 seconds so it just

262
00:10:43,360 --> 00:10:46,880
asks

263
00:10:44,000 --> 00:10:47,760
um do you have a test for me no do you

264
00:10:46,880 --> 00:10:51,440
have a test for me

265
00:10:47,760 --> 00:10:54,399
no and so on uh every 10 seconds

266
00:10:51,440 --> 00:10:55,680
when it actually has a task for uh for

267
00:10:54,399 --> 00:10:59,760
for destroying

268
00:10:55,680 --> 00:11:02,240
then the delay becomes again

269
00:10:59,760 --> 00:11:02,959
milliseconds and then starts uh

270
00:11:02,240 --> 00:11:05,920
increasing

271
00:11:02,959 --> 00:11:07,120
the interval uh you can see how it's in

272
00:11:05,920 --> 00:11:09,760
implemented actually

273
00:11:07,120 --> 00:11:10,320
and in the python interpreter in the

274
00:11:09,760 --> 00:11:14,160
java

275
00:11:10,320 --> 00:11:17,600
interpreter and so on

276
00:11:14,160 --> 00:11:19,120
so how do you detect these with very

277
00:11:17,600 --> 00:11:22,240
simple statistics

278
00:11:19,120 --> 00:11:22,880
so uh there is a great project called

279
00:11:22,240 --> 00:11:26,079
rita

280
00:11:22,880 --> 00:11:27,120
a tool um to detect this beaconing

281
00:11:26,079 --> 00:11:30,399
behavior

282
00:11:27,120 --> 00:11:33,279
so they use uh

283
00:11:30,399 --> 00:11:34,079
basically just statistics uh with this

284
00:11:33,279 --> 00:11:37,120
interval

285
00:11:34,079 --> 00:11:39,680
the sizes and so on uh

286
00:11:37,120 --> 00:11:41,440
it's made by active counter measures

287
00:11:39,680 --> 00:11:43,040
they they have some

288
00:11:41,440 --> 00:11:45,040
threat hunting labs where you can

289
00:11:43,040 --> 00:11:48,640
actually

290
00:11:45,040 --> 00:11:51,920
test all of this and you can install

291
00:11:48,640 --> 00:11:55,040
a security onion which is a distribution

292
00:11:51,920 --> 00:11:56,639
that i could say is like the kali for

293
00:11:55,040 --> 00:12:00,079
blue team so if you want to

294
00:11:56,639 --> 00:12:04,160
test all of these tools like rita

295
00:12:00,079 --> 00:12:06,560
kivana and all of that it's a very easy

296
00:12:04,160 --> 00:12:08,839
way to test it actually if you want to

297
00:12:06,560 --> 00:12:12,000
learn a little bit more about

298
00:12:08,839 --> 00:12:16,800
beaconing uh you should really check uh

299
00:12:12,000 --> 00:12:16,800
this um these resources

300
00:12:16,959 --> 00:12:21,200
so the beginning detection in rita

301
00:12:19,839 --> 00:12:23,360
actually the

302
00:12:21,200 --> 00:12:24,959
the source code it's in github and it's

303
00:12:23,360 --> 00:12:26,000
very well documented actually you can

304
00:12:24,959 --> 00:12:29,760
see here

305
00:12:26,000 --> 00:12:33,440
how they are um basically scoring

306
00:12:29,760 --> 00:12:36,480
the the the b cons uh

307
00:12:33,440 --> 00:12:38,959
they do a scoring based on

308
00:12:36,480 --> 00:12:40,560
interval of each of the connections the

309
00:12:38,959 --> 00:12:45,680
number of the connections

310
00:12:40,560 --> 00:12:47,920
between two hosts the data size of the

311
00:12:45,680 --> 00:12:49,519
of the data in these connections the

312
00:12:47,920 --> 00:12:51,519
dispersion which is like

313
00:12:49,519 --> 00:12:53,600
okay you have intervals of 10 seconds

314
00:12:51,519 --> 00:12:56,560
but maybe you vary by

315
00:12:53,600 --> 00:12:58,160
maybe plus minus 2 seconds around this

316
00:12:56,560 --> 00:13:00,800
10 second interval

317
00:12:58,160 --> 00:13:01,760
so that's a dispersion er the the really

318
00:13:00,800 --> 00:13:04,800
great thing is

319
00:13:01,760 --> 00:13:07,760
that it's protocol independent so

320
00:13:04,800 --> 00:13:08,560
you can have a trojan that connects via

321
00:13:07,760 --> 00:13:11,519
dns

322
00:13:08,560 --> 00:13:11,940
or one that connects via http or a

323
00:13:11,519 --> 00:13:13,760
custom

324
00:13:11,940 --> 00:13:16,880
[Music]

325
00:13:13,760 --> 00:13:20,240
tcp or whatever protocol

326
00:13:16,880 --> 00:13:23,519
and it will be still detected by

327
00:13:20,240 --> 00:13:26,560
a reta because they just

328
00:13:23,519 --> 00:13:28,320
uh focus on on the connections not in

329
00:13:26,560 --> 00:13:30,720
the

330
00:13:28,320 --> 00:13:31,519
in the content of the connections so the

331
00:13:30,720 --> 00:13:34,560
thing is uh

332
00:13:31,519 --> 00:13:37,839
i i saw that the that rita focuses

333
00:13:34,560 --> 00:13:40,800
on ip players so basically you have

334
00:13:37,839 --> 00:13:41,920
a source of the communication and then a

335
00:13:40,800 --> 00:13:45,680
destination

336
00:13:41,920 --> 00:13:50,079
so this is uh basically saying that

337
00:13:45,680 --> 00:13:54,079
you will have your compromised

338
00:13:50,079 --> 00:13:56,399
host on one side and then just one

339
00:13:54,079 --> 00:13:57,600
command and control server this is the

340
00:13:56,399 --> 00:14:00,959
usual case actually

341
00:13:57,600 --> 00:14:03,760
so this is where the whole idea

342
00:14:00,959 --> 00:14:06,079
of implementing this tool was born

343
00:14:03,760 --> 00:14:06,079
actually

344
00:14:06,240 --> 00:14:09,519
so what are the possible evasion

345
00:14:08,560 --> 00:14:13,279
strategies

346
00:14:09,519 --> 00:14:17,120
um for rita so i thought

347
00:14:13,279 --> 00:14:20,320
maybe if i become less often i can

348
00:14:17,120 --> 00:14:20,320
reduce the

349
00:14:20,399 --> 00:14:27,279
score also if i modify

350
00:14:24,000 --> 00:14:29,120
the interval and add some jitter

351
00:14:27,279 --> 00:14:31,680
which is the deviation of the periodic

352
00:14:29,120 --> 00:14:36,160
signal i could also

353
00:14:31,680 --> 00:14:39,360
affect it you can modify the interval

354
00:14:36,160 --> 00:14:42,720
of your normal uh let's say

355
00:14:39,360 --> 00:14:45,920
command and control interaction if

356
00:14:42,720 --> 00:14:47,120
you just uh in metasploit you just use a

357
00:14:45,920 --> 00:14:49,920
command sleep

358
00:14:47,120 --> 00:14:51,199
this will just stop all the connections

359
00:14:49,920 --> 00:14:54,399
and then resume them

360
00:14:51,199 --> 00:14:57,680
after the number of seconds that you

361
00:14:54,399 --> 00:15:00,480
specify then i thought

362
00:14:57,680 --> 00:15:01,839
okay so if rita is making the analysis

363
00:15:00,480 --> 00:15:05,199
on

364
00:15:01,839 --> 00:15:08,240
ip pairs maybe i should distribute

365
00:15:05,199 --> 00:15:11,199
the the all the connections

366
00:15:08,240 --> 00:15:12,000
that the infected host makes to the c2

367
00:15:11,199 --> 00:15:15,519
to go

368
00:15:12,000 --> 00:15:18,399
through several or many um

369
00:15:15,519 --> 00:15:20,240
command control addresses you can do

370
00:15:18,399 --> 00:15:23,600
this also with metasploit

371
00:15:20,240 --> 00:15:26,720
transports but i wanted to make a

372
00:15:23,600 --> 00:15:30,880
more generic and a little bit more

373
00:15:26,720 --> 00:15:33,040
dynamic way of doing it

374
00:15:30,880 --> 00:15:34,160
so where can we get multiple ip

375
00:15:33,040 --> 00:15:37,839
addresses for

376
00:15:34,160 --> 00:15:40,399
our command control well the first

377
00:15:37,839 --> 00:15:41,199
thing i thought about was using reverse

378
00:15:40,399 --> 00:15:44,720
http

379
00:15:41,199 --> 00:15:47,040
and reverse tcp proxies so i started

380
00:15:44,720 --> 00:15:48,720
by doing a survey of reverse http and

381
00:15:47,040 --> 00:15:51,120
reverse tcp software

382
00:15:48,720 --> 00:15:51,959
and services some of the services i

383
00:15:51,120 --> 00:15:55,519
found was

384
00:15:51,959 --> 00:15:58,639
localhost.run which is basically a ssh

385
00:15:55,519 --> 00:15:59,839
service that you can do a reverse tunnel

386
00:15:58,639 --> 00:16:02,560
with it

387
00:15:59,839 --> 00:16:04,000
and rock which is also a very popular

388
00:16:02,560 --> 00:16:06,800
service

389
00:16:04,000 --> 00:16:08,320
where you can do http and tcp proxy and

390
00:16:06,800 --> 00:16:11,199
page kite

391
00:16:08,320 --> 00:16:11,839
local tunnel is very interesting because

392
00:16:11,199 --> 00:16:14,880
they

393
00:16:11,839 --> 00:16:14,880
also um

394
00:16:15,120 --> 00:16:19,440
they also have the the the code in

395
00:16:17,519 --> 00:16:22,160
github so you can host your own

396
00:16:19,440 --> 00:16:22,959
server for local tunnel and you can also

397
00:16:22,160 --> 00:16:26,800
use

398
00:16:22,959 --> 00:16:29,839
their service and then frp

399
00:16:26,800 --> 00:16:30,800
and venom frp and venom i found in the

400
00:16:29,839 --> 00:16:33,839
mitre

401
00:16:30,800 --> 00:16:37,360
attack page

402
00:16:33,839 --> 00:16:39,120
so i started by searching how many frp

403
00:16:37,360 --> 00:16:40,480
which is fast reverse proxy actually the

404
00:16:39,120 --> 00:16:44,959
name um

405
00:16:40,480 --> 00:16:47,120
i found uh 15 731

406
00:16:44,959 --> 00:16:49,120
from those uh well the majority was

407
00:16:47,120 --> 00:16:51,839
hosted in china actually then the united

408
00:16:49,120 --> 00:16:55,519
states and hong kong

409
00:16:51,839 --> 00:16:58,800
of all of those i found 810 that were

410
00:16:55,519 --> 00:17:02,240
um open meaning no authentication

411
00:16:58,800 --> 00:17:06,000
uh to establish a

412
00:17:02,240 --> 00:17:09,120
tcp uh reverse tunnel

413
00:17:06,000 --> 00:17:12,880
and 416 for establishing

414
00:17:09,120 --> 00:17:15,120
uh reverse http uh connections

415
00:17:12,880 --> 00:17:15,919
well this was actually fantastic news

416
00:17:15,120 --> 00:17:19,600
for me uh

417
00:17:15,919 --> 00:17:22,240
because i i said okay if i wanted uh

418
00:17:19,600 --> 00:17:23,439
more ips to send the traffic of my

419
00:17:22,240 --> 00:17:25,199
command and control

420
00:17:23,439 --> 00:17:27,280
well now i have more than one thousand

421
00:17:25,199 --> 00:17:29,760
ips on my on my

422
00:17:27,280 --> 00:17:30,640
disposal so that this was great news

423
00:17:29,760 --> 00:17:35,039
actually

424
00:17:30,640 --> 00:17:38,480
then local tunnel um i found 290

425
00:17:35,039 --> 00:17:39,280
and you can do reverse http proxy

426
00:17:38,480 --> 00:17:42,400
through it

427
00:17:39,280 --> 00:17:43,200
uh the c2 centipede features that i

428
00:17:42,400 --> 00:17:45,600
implemented

429
00:17:43,200 --> 00:17:46,720
is uh the modification of the beaconing

430
00:17:45,600 --> 00:17:49,760
interval

431
00:17:46,720 --> 00:17:50,480
uh that the type of trojan detection so

432
00:17:49,760 --> 00:17:53,840
it detects

433
00:17:50,480 --> 00:17:56,559
if you are using an interpreter

434
00:17:53,840 --> 00:17:57,280
or if you are using an empire agent or

435
00:17:56,559 --> 00:18:00,240
any

436
00:17:57,280 --> 00:18:03,440
other well not any other but other

437
00:18:00,240 --> 00:18:07,440
generic responses

438
00:18:03,440 --> 00:18:11,120
the fox flux part is just

439
00:18:07,440 --> 00:18:14,240
sending let's say many ips

440
00:18:11,120 --> 00:18:15,679
to the client so it can

441
00:18:14,240 --> 00:18:17,679
not directly send the request to the

442
00:18:15,679 --> 00:18:21,039
commander control but through these

443
00:18:17,679 --> 00:18:23,840
many ips the multi-fronting is just

444
00:18:21,039 --> 00:18:24,559
the main fronting but that is not

445
00:18:23,840 --> 00:18:28,240
actually

446
00:18:24,559 --> 00:18:31,440
just um

447
00:18:28,240 --> 00:18:34,240
using one domain so you can send

448
00:18:31,440 --> 00:18:35,840
many domains that you want to uh front

449
00:18:34,240 --> 00:18:38,880
through

450
00:18:35,840 --> 00:18:42,080
in one cdn or two or an

451
00:18:38,880 --> 00:18:43,600
amount of cdns i also

452
00:18:42,080 --> 00:18:46,640
implemented the the main generation

453
00:18:43,600 --> 00:18:49,679
algorithm of a flu bot

454
00:18:46,640 --> 00:18:53,600
uh and uh dga

455
00:18:49,679 --> 00:18:56,720
uh kind of thing for uh generating the

456
00:18:53,600 --> 00:18:57,679
the the virtual hosts for the frp

457
00:18:56,720 --> 00:18:59,760
reverse

458
00:18:57,679 --> 00:19:00,720
proxy you don't have to configure

459
00:18:59,760 --> 00:19:03,120
everything uh

460
00:19:00,720 --> 00:19:04,000
before uh sending the trojan so the

461
00:19:03,120 --> 00:19:06,160
trojan can

462
00:19:04,000 --> 00:19:07,440
establish one connection on let's say

463
00:19:06,160 --> 00:19:10,480
one uh

464
00:19:07,440 --> 00:19:13,520
of all of these ways and then

465
00:19:10,480 --> 00:19:16,640
it can just alter like

466
00:19:13,520 --> 00:19:17,760
add more ip addresses or change the

467
00:19:16,640 --> 00:19:21,919
beaconing interval

468
00:19:17,760 --> 00:19:25,280
or all of this stuff dynamically

469
00:19:21,919 --> 00:19:27,760
so how do we change the uh

470
00:19:25,280 --> 00:19:30,000
beaconing interval we have seen for

471
00:19:27,760 --> 00:19:30,960
example the metasploit case that it has

472
00:19:30,000 --> 00:19:34,400
its own

473
00:19:30,960 --> 00:19:38,080
um beaconing uh strategy let's say

474
00:19:34,400 --> 00:19:40,799
sending a beacon every 10 seconds so uh

475
00:19:38,080 --> 00:19:41,360
what we're doing in the c2 centipede is

476
00:19:40,799 --> 00:19:44,720
just

477
00:19:41,360 --> 00:19:48,960
uh faking the response of what

478
00:19:44,720 --> 00:19:52,320
uh metasploit handler would say to say

479
00:19:48,960 --> 00:19:55,200
there are no tasks for you to execute so

480
00:19:52,320 --> 00:19:56,160
it connects 10 times and you can say

481
00:19:55,200 --> 00:19:58,880
okay

482
00:19:56,160 --> 00:20:00,080
instead of sending 10 times which is a

483
00:19:58,880 --> 00:20:04,000
lot of beginning

484
00:20:00,080 --> 00:20:06,880
for for my taste just fake

485
00:20:04,000 --> 00:20:07,760
20 times saying that there are no tasks

486
00:20:06,880 --> 00:20:10,880
and then

487
00:20:07,760 --> 00:20:12,480
uh the 21st attempt that you want to

488
00:20:10,880 --> 00:20:14,240
communicate with the commando control

489
00:20:12,480 --> 00:20:17,280
then you actually send it

490
00:20:14,240 --> 00:20:18,320
and then the rest again 20 you don't

491
00:20:17,280 --> 00:20:20,799
send it and then

492
00:20:18,320 --> 00:20:23,520
and so on so the beaconing gets reduced

493
00:20:20,799 --> 00:20:23,520
uh a lot

494
00:20:23,840 --> 00:20:27,120
the fox flux as i was saying is

495
00:20:26,559 --> 00:20:29,120
basically

496
00:20:27,120 --> 00:20:32,159
not using dns because i don't have a

497
00:20:29,120 --> 00:20:32,159
botnet available

498
00:20:33,120 --> 00:20:37,919
but uh i do want to use many ips so we

499
00:20:36,960 --> 00:20:41,679
are using

500
00:20:37,919 --> 00:20:42,320
the uh let's say uh reverse open reverse

501
00:20:41,679 --> 00:20:46,559
proxy

502
00:20:42,320 --> 00:20:50,960
approach and so there is a

503
00:20:46,559 --> 00:20:53,440
kind of a dga

504
00:20:50,960 --> 00:20:54,720
that is used on both the client and the

505
00:20:53,440 --> 00:20:58,880
server

506
00:20:54,720 --> 00:20:58,880
when the server requests um

507
00:20:59,679 --> 00:21:05,840
reverse http tunnel from

508
00:21:02,799 --> 00:21:09,600
frp server it converts the

509
00:21:05,840 --> 00:21:12,640
ip of this server into a host so you can

510
00:21:09,600 --> 00:21:16,320
you can see here news.biohub.io

511
00:21:12,640 --> 00:21:19,360
is generated by this ip that is here so

512
00:21:16,320 --> 00:21:22,159
uh when the c2 centipede server

513
00:21:19,360 --> 00:21:22,799
tells the client okay now which you

514
00:21:22,159 --> 00:21:26,080
should uh

515
00:21:22,799 --> 00:21:30,000
send um your your request

516
00:21:26,080 --> 00:21:33,679
through this uh frp proxy

517
00:21:30,000 --> 00:21:37,919
both server and client know

518
00:21:33,679 --> 00:21:41,840
how to set up the the proxy by telling

519
00:21:37,919 --> 00:21:44,880
frp i want to use this host and then

520
00:21:41,840 --> 00:21:47,919
the the client also has the same

521
00:21:44,880 --> 00:21:51,120
algorithm so knows what host

522
00:21:47,919 --> 00:21:54,880
to send in the http request

523
00:21:51,120 --> 00:21:58,240
so that the the http request goes

524
00:21:54,880 --> 00:22:02,799
from the from this

525
00:21:58,240 --> 00:22:02,799
c to centipede client to the server

526
00:22:03,039 --> 00:22:11,120
so multi-domain fronting uh basically

527
00:22:08,320 --> 00:22:13,760
domain fronting abuses the routing

528
00:22:11,120 --> 00:22:17,159
scheme in content delivery networks

529
00:22:13,760 --> 00:22:18,320
to hide the intended destination of the

530
00:22:17,159 --> 00:22:21,200
https

531
00:22:18,320 --> 00:22:21,919
traffic so basically uh let's say that

532
00:22:21,200 --> 00:22:25,200
the

533
00:22:21,919 --> 00:22:29,120
tls out or wrapping

534
00:22:25,200 --> 00:22:32,159
is saying hey i want to go to uh

535
00:22:29,120 --> 00:22:35,440
amazon or whatever but inside

536
00:22:32,159 --> 00:22:37,120
uh the http header is saying uh

537
00:22:35,440 --> 00:22:39,440
not really i don't want to go to amazon

538
00:22:37,120 --> 00:22:43,039
i want to go to evil server dot

539
00:22:39,440 --> 00:22:46,240
whatever in the same cdn so the cdn

540
00:22:43,039 --> 00:22:49,840
uh actually like unwraps this tls stuff

541
00:22:46,240 --> 00:22:53,520
and then just uh routes um

542
00:22:49,840 --> 00:22:55,919
the request to the um

543
00:22:53,520 --> 00:22:56,720
specif to the server specified in the

544
00:22:55,919 --> 00:23:00,480
http

545
00:22:56,720 --> 00:23:03,919
host header this is very

546
00:23:00,480 --> 00:23:06,960
easily um implemented in in the tool

547
00:23:03,919 --> 00:23:10,159
you just need to send uh um

548
00:23:06,960 --> 00:23:10,960
like this front it and then the domain

549
00:23:10,159 --> 00:23:14,080
you want to

550
00:23:10,960 --> 00:23:16,559
front through and then you specify

551
00:23:14,080 --> 00:23:17,919
the host uh that you have assigned in

552
00:23:16,559 --> 00:23:21,440
that cdn

553
00:23:17,919 --> 00:23:24,320
you can use uh one two

554
00:23:21,440 --> 00:23:24,320
as as you wish

555
00:23:25,360 --> 00:23:28,480
then the domain generation algorithm i

556
00:23:27,760 --> 00:23:30,799
already talked

557
00:23:28,480 --> 00:23:31,760
a little bit about it i implemented the

558
00:23:30,799 --> 00:23:35,280
flu bot

559
00:23:31,760 --> 00:23:39,120
actually based a lot on this

560
00:23:35,280 --> 00:23:42,720
blog post on switch dot ch uh

561
00:23:39,120 --> 00:23:45,679
basically flu bot has a algorithm

562
00:23:42,720 --> 00:23:48,559
that you provide the seed then you say

563
00:23:45,679 --> 00:23:51,120
how many domains you want to generate

564
00:23:48,559 --> 00:23:51,760
and here in the c2 centipede you specify

565
00:23:51,120 --> 00:23:54,799
to what

566
00:23:51,760 --> 00:23:56,480
port you want to connect on those

567
00:23:54,799 --> 00:23:58,960
generated

568
00:23:56,480 --> 00:23:58,960
domains

569
00:24:00,240 --> 00:24:05,200
and then the dynamic configuration uh

570
00:24:02,159 --> 00:24:08,400
basically you have um

571
00:24:05,200 --> 00:24:11,120
every time the trojan wants to connect

572
00:24:08,400 --> 00:24:11,840
to the c2 server it connects to the

573
00:24:11,120 --> 00:24:15,600
actually to the

574
00:24:11,840 --> 00:24:19,039
c2 centipede uh proxy first

575
00:24:15,600 --> 00:24:20,080
and then the the c2 centipede uh let's

576
00:24:19,039 --> 00:24:23,120
say

577
00:24:20,080 --> 00:24:27,760
protocol is piggybacked on this call

578
00:24:23,120 --> 00:24:30,640
um the original uh

579
00:24:27,760 --> 00:24:31,200
request from the trojan it's kind of

580
00:24:30,640 --> 00:24:35,200
wrapped

581
00:24:31,200 --> 00:24:38,799
and then sent to the c2 centipede uh

582
00:24:35,200 --> 00:24:41,679
server where it's unwrapped then uh

583
00:24:38,799 --> 00:24:42,559
the the original request is passed to

584
00:24:41,679 --> 00:24:45,679
the

585
00:24:42,559 --> 00:24:49,279
metasploit handler or the empire handler

586
00:24:45,679 --> 00:24:52,960
and then the control data for

587
00:24:49,279 --> 00:24:56,000
the c2c ntp

588
00:24:52,960 --> 00:24:58,840
application it's uh embedded and

589
00:24:56,000 --> 00:25:00,000
wrapped and sent to the c2 centipede

590
00:24:58,840 --> 00:25:02,240
client

591
00:25:00,000 --> 00:25:04,080
then so this means that the operator can

592
00:25:02,240 --> 00:25:06,559
add more c2 addresses

593
00:25:04,080 --> 00:25:08,559
uh change the encryption key also this

594
00:25:06,559 --> 00:25:10,960
uh this whole thing is encrypted

595
00:25:08,559 --> 00:25:13,120
uh on top of the encryption of

596
00:25:10,960 --> 00:25:15,600
metasploit if you're using metasploit

597
00:25:13,120 --> 00:25:18,200
um you can change the the number of fake

598
00:25:15,600 --> 00:25:19,279
answers it sends at any moment

599
00:25:18,200 --> 00:25:21,279
[Music]

600
00:25:19,279 --> 00:25:22,640
so so you can change it while it's

601
00:25:21,279 --> 00:25:24,320
running

602
00:25:22,640 --> 00:25:26,400
here we have the c2 centipede

603
00:25:24,320 --> 00:25:28,640
architecture uh well

604
00:25:26,400 --> 00:25:29,520
this is the the normal architecture that

605
00:25:28,640 --> 00:25:33,480
you use

606
00:25:29,520 --> 00:25:36,320
uh in in when when you have a normal

607
00:25:33,480 --> 00:25:37,279
metabolion that connects directly to the

608
00:25:36,320 --> 00:25:39,520
handler

609
00:25:37,279 --> 00:25:40,400
then this connection is repeated every

610
00:25:39,520 --> 00:25:43,919
10 seconds

611
00:25:40,400 --> 00:25:47,520
every time to the same server

612
00:25:43,919 --> 00:25:51,200
what we want to achieve uh is connect

613
00:25:47,520 --> 00:25:54,720
through many uh ips

614
00:25:51,200 --> 00:25:57,679
let's say and to alter the the

615
00:25:54,720 --> 00:25:59,200
beaconing interval so basically the

616
00:25:57,679 --> 00:26:00,000
interpreter instead of connecting

617
00:25:59,200 --> 00:26:03,440
directly

618
00:26:00,000 --> 00:26:03,919
to the handler it connects to this sort

619
00:26:03,440 --> 00:26:07,440
of

620
00:26:03,919 --> 00:26:11,440
um proxy the c2 centipede

621
00:26:07,440 --> 00:26:14,640
proxy then it has like an internal

622
00:26:11,440 --> 00:26:18,000
routing uh table and it decides

623
00:26:14,640 --> 00:26:21,279
on the um desired uh route

624
00:26:18,000 --> 00:26:24,559
route it wants to take to reach the

625
00:26:21,279 --> 00:26:27,520
handler so uh the trojan

626
00:26:24,559 --> 00:26:28,559
sends the request to the localhost uh

627
00:26:27,520 --> 00:26:31,679
and then

628
00:26:28,559 --> 00:26:32,320
uh the centipede client chooses one of

629
00:26:31,679 --> 00:26:34,000
this

630
00:26:32,320 --> 00:26:36,480
can be through the main fronting or

631
00:26:34,000 --> 00:26:38,720
through a reverse frp reverse

632
00:26:36,480 --> 00:26:40,240
tunnel and then it reaches the c2

633
00:26:38,720 --> 00:26:43,279
centipede server

634
00:26:40,240 --> 00:26:46,320
the c2cp server kind of uh

635
00:26:43,279 --> 00:26:49,520
unwraps the original uh call

636
00:26:46,320 --> 00:26:52,880
and sends it to the destination

637
00:26:49,520 --> 00:26:54,880
metaexploit http handler then

638
00:26:52,880 --> 00:26:56,159
it obtains the response and sends it

639
00:26:54,880 --> 00:26:59,039
back to

640
00:26:56,159 --> 00:26:59,520
the c2 centipede client and then from

641
00:26:59,039 --> 00:27:03,039
there

642
00:26:59,520 --> 00:27:06,240
to the interpreter client

643
00:27:03,039 --> 00:27:07,919
we'll do the interpreter trojan

644
00:27:06,240 --> 00:27:11,200
you can also have this configuration

645
00:27:07,919 --> 00:27:14,480
where you have one host

646
00:27:11,200 --> 00:27:17,679
um with an interpreter and

647
00:27:14,480 --> 00:27:18,080
also with the c2 centipede client and

648
00:27:17,679 --> 00:27:21,120
then

649
00:27:18,080 --> 00:27:24,240
you can have other compromised hosts

650
00:27:21,120 --> 00:27:27,840
in that same network connecting to these

651
00:27:24,240 --> 00:27:28,399
one only uh host with the c2 centipede

652
00:27:27,840 --> 00:27:31,760
client

653
00:27:28,399 --> 00:27:34,880
so that all the traffic goes through uh

654
00:27:31,760 --> 00:27:37,360
this uh host and does all this routing

655
00:27:34,880 --> 00:27:37,360
for them

656
00:27:38,720 --> 00:27:42,720
so this is the c2 centipede operation

657
00:27:41,600 --> 00:27:45,919
basically you need

658
00:27:42,720 --> 00:27:48,720
first to set up the metaexploit empire

659
00:27:45,919 --> 00:27:49,840
or whatever you're using a handler so

660
00:27:48,720 --> 00:27:53,440
basically this is uh

661
00:27:49,840 --> 00:27:54,080
the command to uh to set up a metasploit

662
00:27:53,440 --> 00:27:57,520
handler

663
00:27:54,080 --> 00:28:00,480
you set the payload for uh whatever

664
00:27:57,520 --> 00:28:02,399
whatever payload you want it has to be

665
00:28:00,480 --> 00:28:06,640
reverse http

666
00:28:02,399 --> 00:28:09,679
here i'm using a stageless http shell

667
00:28:06,640 --> 00:28:12,000
then you set up the port of the handler

668
00:28:09,679 --> 00:28:12,960
and then the host you want to bind to

669
00:28:12,000 --> 00:28:15,919
and you run

670
00:28:12,960 --> 00:28:16,559
the metasploit handler then you need to

671
00:28:15,919 --> 00:28:19,279
configure

672
00:28:16,559 --> 00:28:20,640
on the server as well um the c2

673
00:28:19,279 --> 00:28:24,240
centipede server

674
00:28:20,640 --> 00:28:27,440
you need to specify a port and then

675
00:28:24,240 --> 00:28:31,279
the destination where all the

676
00:28:27,440 --> 00:28:33,760
um requests that it gets will be uh

677
00:28:31,279 --> 00:28:36,799
forwarded to so this will be the

678
00:28:33,760 --> 00:28:41,600
metasploit or empire

679
00:28:36,799 --> 00:28:44,640
handler then on the client

680
00:28:41,600 --> 00:28:47,679
you need to set up the

681
00:28:44,640 --> 00:28:51,279
c2 centipede client you specify the

682
00:28:47,679 --> 00:28:53,679
on what interface you want to bind and

683
00:28:51,279 --> 00:28:54,559
this is in the case of just having it in

684
00:28:53,679 --> 00:28:57,679
one host

685
00:28:54,559 --> 00:28:58,799
not anyone else connecting to it you

686
00:28:57,679 --> 00:29:00,720
specify the port

687
00:28:58,799 --> 00:29:02,159
that you want to run the c2 centipede

688
00:29:00,720 --> 00:29:05,360
client on uh

689
00:29:02,159 --> 00:29:06,159
then the list of c2 centipede servers

690
00:29:05,360 --> 00:29:09,919
let's say

691
00:29:06,159 --> 00:29:13,279
either domain fronted or um

692
00:29:09,919 --> 00:29:15,840
or through frp proxies

693
00:29:13,279 --> 00:29:16,480
or you can also give with the minus s

694
00:29:15,840 --> 00:29:20,640
you can

695
00:29:16,480 --> 00:29:20,640
give the individual servers

696
00:29:21,039 --> 00:29:25,520
of course then you need to generate the

697
00:29:22,960 --> 00:29:25,520
trojan

698
00:29:25,679 --> 00:29:30,399
and then uh yeah you just need to

699
00:29:29,440 --> 00:29:33,760
execute

700
00:29:30,399 --> 00:29:36,960
uh the trojan in the same

701
00:29:33,760 --> 00:29:39,520
host that you are executing the

702
00:29:36,960 --> 00:29:40,159
c2 centipede client uh of course you you

703
00:29:39,520 --> 00:29:43,520
can also

704
00:29:40,159 --> 00:29:46,880
compile it for windows um

705
00:29:43,520 --> 00:29:50,559
and then just run it there

706
00:29:46,880 --> 00:29:54,159
uh okay so right now we will um

707
00:29:50,559 --> 00:29:58,000
test um okay a shell with

708
00:29:54,159 --> 00:30:01,200
c2 centipede so we will

709
00:29:58,000 --> 00:30:04,000
actually fire up a windows machine

710
00:30:01,200 --> 00:30:04,880
uh we will set up the c2 centipede

711
00:30:04,000 --> 00:30:09,200
server

712
00:30:04,880 --> 00:30:11,360
uh we will set up at the port in 1993

713
00:30:09,200 --> 00:30:12,559
and then we will say that the meta

714
00:30:11,360 --> 00:30:16,640
exploit handler

715
00:30:12,559 --> 00:30:18,159
will be in these host and ip

716
00:30:16,640 --> 00:30:20,399
in this case it's on the same machine

717
00:30:18,159 --> 00:30:23,440
but you can also uh

718
00:30:20,399 --> 00:30:26,320
let's say point to a metasploit handler

719
00:30:23,440 --> 00:30:26,320
in another machine

720
00:30:28,080 --> 00:30:32,480
so here i will um with metasploit i will

721
00:30:31,600 --> 00:30:35,440
run a handler

722
00:30:32,480 --> 00:30:36,000
so i will use the exploit multihandler

723
00:30:35,440 --> 00:30:38,960
and then set

724
00:30:36,000 --> 00:30:39,600
the payload for windows meterpreter

725
00:30:38,960 --> 00:30:43,360
reverse

726
00:30:39,600 --> 00:30:46,480
http this is a stageless

727
00:30:43,360 --> 00:30:49,919
http um payload

728
00:30:46,480 --> 00:30:50,559
and we set the port to eight eight eight

729
00:30:49,919 --> 00:30:54,240
eight

730
00:30:50,559 --> 00:30:54,960
then we set the host to all interfaces

731
00:30:54,240 --> 00:31:00,000
and then

732
00:30:54,960 --> 00:31:04,760
just run and we can start as well

733
00:31:00,000 --> 00:31:07,760
the c2 centipede server

734
00:31:04,760 --> 00:31:07,760
1993

735
00:31:08,159 --> 00:31:10,399
okay

736
00:31:11,200 --> 00:31:17,679
so we already have the multihander

737
00:31:15,039 --> 00:31:19,039
listening on on that port with this

738
00:31:17,679 --> 00:31:23,840
payload

739
00:31:19,039 --> 00:31:23,840
we can charge the c2cp client

740
00:31:27,039 --> 00:31:34,000
we need to specify um to what interface

741
00:31:32,720 --> 00:31:37,039
we're binding to

742
00:31:34,000 --> 00:31:40,559
and then the port

743
00:31:37,039 --> 00:31:42,240
let's use port 2233 because i already

744
00:31:40,559 --> 00:31:45,679
generated

745
00:31:42,240 --> 00:31:46,720
a stageless interpreter pointing to

746
00:31:45,679 --> 00:31:50,640
localhost

747
00:31:46,720 --> 00:31:50,640
and port 2233

748
00:31:51,440 --> 00:31:55,200
and then we will connect it specifying

749
00:31:54,799 --> 00:32:01,840
the

750
00:31:55,200 --> 00:32:01,840
c2 centipede server

751
00:32:04,080 --> 00:32:08,240
it was running on port 1993

752
00:32:11,679 --> 00:32:15,840
okay that should be running

753
00:32:16,399 --> 00:32:20,320
we can test the connection all the way

754
00:32:19,120 --> 00:32:29,840
to the handler

755
00:32:20,320 --> 00:32:29,840
by issuing a crawl command to localhost

756
00:32:33,360 --> 00:32:40,240
so this is the actual response from

757
00:32:36,880 --> 00:32:43,760
the metasploit http handler

758
00:32:40,240 --> 00:32:46,240
it actually emulates an apache server

759
00:32:43,760 --> 00:32:46,799
but you can see that the connection

760
00:32:46,240 --> 00:32:51,360
actually

761
00:32:46,799 --> 00:32:55,519
was sent through the c2 centipede client

762
00:32:51,360 --> 00:32:58,399
and to send to the c2 centipede server

763
00:32:55,519 --> 00:32:58,399
as you can see here

764
00:32:58,480 --> 00:33:02,080
we execute the curl again then you get

765
00:33:01,200 --> 00:33:05,360
the connection again

766
00:33:02,080 --> 00:33:11,840
through the same route

767
00:33:05,360 --> 00:33:11,840
and here you can see the connections

768
00:33:12,159 --> 00:33:18,240
okay so let's now execute

769
00:33:15,200 --> 00:33:20,799
the interpreter

770
00:33:18,240 --> 00:33:21,840
but what you hear is every connection

771
00:33:20,799 --> 00:33:25,120
that gets to

772
00:33:21,840 --> 00:33:28,240
the c2 centipede server

773
00:33:25,120 --> 00:33:31,360
so you will see how much

774
00:33:28,240 --> 00:33:39,840
the meta ploid or the interpreter

775
00:33:31,360 --> 00:33:39,840
trojan connects to the handler

776
00:33:42,020 --> 00:33:51,120
[Laughter]

777
00:33:47,519 --> 00:33:55,039
every beep is a connection

778
00:33:51,120 --> 00:33:55,039
an http request action

779
00:33:55,120 --> 00:33:59,360
and as you can hear the interval between

780
00:33:58,320 --> 00:34:04,080
each call

781
00:33:59,360 --> 00:34:04,080
it's little by little growing

782
00:34:04,240 --> 00:34:10,320
so if we continue we could um

783
00:34:07,279 --> 00:34:13,599
see that the interval grows until

784
00:34:10,320 --> 00:34:16,879
10 seconds and then it just keeps

785
00:34:13,599 --> 00:34:17,440
being 10 seconds long but what happens

786
00:34:16,879 --> 00:34:20,800
when we

787
00:34:17,440 --> 00:34:24,240
interact with the trojan we said

788
00:34:20,800 --> 00:34:25,440
that it goes back to 100 milliseconds

789
00:34:24,240 --> 00:34:28,560
and then

790
00:34:25,440 --> 00:34:30,240
it it it does like this growing of the

791
00:34:28,560 --> 00:34:35,839
interval again

792
00:34:30,240 --> 00:34:35,839
so let's interact with it

793
00:34:36,240 --> 00:34:41,679
as you can see there are more

794
00:34:38,879 --> 00:34:41,679
connections now

795
00:34:45,679 --> 00:34:49,839
okay i will execute something again

796
00:34:51,359 --> 00:34:55,679
so this is all the noise that you are

797
00:34:54,879 --> 00:34:59,599
generating

798
00:34:55,679 --> 00:35:02,720
every time that your

799
00:34:59,599 --> 00:35:03,599
metabolic connects to your handler so

800
00:35:02,720 --> 00:35:07,040
it's not

801
00:35:03,599 --> 00:35:10,240
a magic it generates a lot of noise and

802
00:35:07,040 --> 00:35:13,440
actually quite very nice

803
00:35:10,240 --> 00:35:14,800
looking beacons all the time so this is

804
00:35:13,440 --> 00:35:18,880
very easy

805
00:35:14,800 --> 00:35:23,520
for the blue team to detect

806
00:35:18,880 --> 00:35:23,520
with a tool like rita actually

807
00:35:26,400 --> 00:35:33,839
so this is where we come and try

808
00:35:29,520 --> 00:35:33,839
to do things a little bit different

809
00:35:40,800 --> 00:35:47,280
this is the c2 centipede operator

810
00:35:44,240 --> 00:35:50,400
interface we

811
00:35:47,280 --> 00:35:52,480
say to what server we are connecting to

812
00:35:50,400 --> 00:35:55,440
and then we can see the client that are

813
00:35:52,480 --> 00:35:55,440
currently connected

814
00:35:56,839 --> 00:35:59,839
okay

815
00:36:00,640 --> 00:36:06,960
we can set up another route

816
00:36:03,839 --> 00:36:10,839
right we will set up uh

817
00:36:06,960 --> 00:36:13,760
or let's first fake

818
00:36:10,839 --> 00:36:16,320
the the responses

819
00:36:13,760 --> 00:36:17,119
okay i will just execute one more

820
00:36:16,320 --> 00:36:20,800
command to

821
00:36:17,119 --> 00:36:20,800
get a faster beacon

822
00:36:21,040 --> 00:36:27,760
and then i will send the command

823
00:36:24,560 --> 00:36:40,960
to fake for

824
00:36:27,760 --> 00:36:44,320
request the responses for four weeks

825
00:36:40,960 --> 00:36:46,880
as you can see here is now one

826
00:36:44,320 --> 00:36:48,240
two three you don't hear anything

827
00:36:46,880 --> 00:36:50,720
because nothing is going through the

828
00:36:48,240 --> 00:36:53,920
network here you will also see the gap

829
00:36:50,720 --> 00:36:54,720
now it sends again the the the request

830
00:36:53,920 --> 00:36:57,839
so you see

831
00:36:54,720 --> 00:37:01,359
this was the original beaconing and with

832
00:36:57,839 --> 00:37:01,359
the c2 centipede we are now

833
00:37:01,440 --> 00:37:05,040
adding this gap so adding to the

834
00:37:04,160 --> 00:37:08,320
interval

835
00:37:05,040 --> 00:37:11,760
we are now only faking four responses

836
00:37:08,320 --> 00:37:14,880
but we can do of course more

837
00:37:11,760 --> 00:37:16,480
we can go back to zero if we want more

838
00:37:14,880 --> 00:37:19,599
interactivity

839
00:37:16,480 --> 00:37:23,119
here you can see how many times

840
00:37:19,599 --> 00:37:26,720
it has faked right so it starts again

841
00:37:23,119 --> 00:37:32,000
fake one fake two

842
00:37:26,720 --> 00:37:32,000
out of four fake three out of four

843
00:37:32,480 --> 00:37:36,640
fake four after four and then it will go

844
00:37:34,480 --> 00:37:40,720
again out

845
00:37:36,640 --> 00:37:43,599
as you can see now so uh let's say

846
00:37:40,720 --> 00:37:44,240
uh you want more interactivity ah of

847
00:37:43,599 --> 00:37:48,839
course

848
00:37:44,240 --> 00:37:51,440
i can show that you can still retain

849
00:37:48,839 --> 00:37:52,800
uh

850
00:37:51,440 --> 00:37:54,240
let's see it will take a little bit

851
00:37:52,800 --> 00:37:55,359
longer because not all requests are

852
00:37:54,240 --> 00:37:58,160
coming but now

853
00:37:55,359 --> 00:37:58,160
it will execute

854
00:37:58,400 --> 00:38:06,640
so you can still execute commands

855
00:38:03,280 --> 00:38:06,640
so now let's add some

856
00:38:07,359 --> 00:38:11,359
proxies so let's try

857
00:38:13,680 --> 00:38:17,119
so we will set up some

858
00:38:17,200 --> 00:38:21,040
let's try it three or four

859
00:38:28,560 --> 00:38:34,880
so these are open on the internet

860
00:38:31,599 --> 00:38:34,880
i will just press setup

861
00:38:37,440 --> 00:38:41,920
and then it will establish the

862
00:38:40,400 --> 00:38:44,320
connections

863
00:38:41,920 --> 00:38:45,200
as you can see these two are not no

864
00:38:44,320 --> 00:38:48,800
longer

865
00:38:45,200 --> 00:38:48,800
working 59

866
00:38:48,960 --> 00:38:52,880
so we can actually remove them

867
00:38:54,990 --> 00:39:02,079
[Music]

868
00:38:57,920 --> 00:39:02,079
okay remove that one

869
00:39:09,680 --> 00:39:15,839
so let's add some other ones

870
00:39:18,800 --> 00:39:21,760
and it worked

871
00:39:27,359 --> 00:39:33,680
okay so let's send it to the c2

872
00:39:31,040 --> 00:39:36,640
client let's see two centipede class so

873
00:39:33,680 --> 00:39:36,640
i will press send

874
00:39:39,839 --> 00:39:43,599
so the next time it connects because now

875
00:39:41,520 --> 00:39:44,640
it's faking so when it connects it will

876
00:39:43,599 --> 00:39:47,680
get the servers

877
00:39:44,640 --> 00:39:48,240
added to its routing table and then it

878
00:39:47,680 --> 00:39:51,599
will

879
00:39:48,240 --> 00:39:57,839
actually use it to route the traffic

880
00:39:51,599 --> 00:39:57,839
through them

881
00:40:11,280 --> 00:40:17,680
you can see i still have command over

882
00:40:15,040 --> 00:40:17,680
the trojan

883
00:40:19,359 --> 00:40:25,280
and actually the frequency of the beeps

884
00:40:22,240 --> 00:40:28,319
means that it's using

885
00:40:25,280 --> 00:40:30,800
like each ip generates a different

886
00:40:28,319 --> 00:40:30,800
frequency

887
00:40:34,000 --> 00:40:38,640
so here if we see it will be using like

888
00:40:38,160 --> 00:40:41,440
these

889
00:40:38,640 --> 00:40:43,839
ips we added so this is going through

890
00:40:41,440 --> 00:40:47,040
china

891
00:40:43,839 --> 00:40:47,040
and the us

892
00:40:47,760 --> 00:40:53,920
and so on okay so we can also use uh the

893
00:40:52,160 --> 00:40:57,520
main fronting

894
00:40:53,920 --> 00:40:59,340
as we saw previously i will just um

895
00:40:57,520 --> 00:41:00,960
again using

896
00:40:59,340 --> 00:41:07,839
[Music]

897
00:41:00,960 --> 00:41:07,839
this tool i will send multiple servers

898
00:41:09,280 --> 00:41:13,200
i will add them here with the format i

899
00:41:12,480 --> 00:41:15,359
was

900
00:41:13,200 --> 00:41:17,119
telling you before front it and then the

901
00:41:15,359 --> 00:41:19,680
domain you want to front through

902
00:41:17,119 --> 00:41:22,319
and then the host it should actually

903
00:41:19,680 --> 00:41:22,319
redirect

904
00:41:22,720 --> 00:41:26,400
so there it will send it

905
00:41:28,000 --> 00:41:35,520
it adds the to the routing table

906
00:41:31,920 --> 00:41:49,200
and then it will use them

907
00:41:35,520 --> 00:41:52,079
so here it's sent through this one

908
00:41:49,200 --> 00:41:53,040
there are some debugging uh things uh

909
00:41:52,079 --> 00:41:56,079
going on

910
00:41:53,040 --> 00:41:59,680
so at some point it uh

911
00:41:56,079 --> 00:42:02,400
stops but then it continues

912
00:41:59,680 --> 00:42:02,960
as you can see here the domains that is

913
00:42:02,400 --> 00:42:06,480
using

914
00:42:02,960 --> 00:42:06,480
to front

915
00:42:06,640 --> 00:42:15,440
here okay so that's the demo

916
00:42:11,040 --> 00:42:18,720
i hope you liked it and we'll continue

917
00:42:15,440 --> 00:42:22,880
with the presentation okay

918
00:42:18,720 --> 00:42:25,920
so um how does uh the traffic looks

919
00:42:22,880 --> 00:42:29,599
for the blue team here uh

920
00:42:25,920 --> 00:42:33,359
i executed uh the interpreter against

921
00:42:29,599 --> 00:42:37,839
this host only only one host

922
00:42:33,359 --> 00:42:41,359
using no sleeping let's say or faking

923
00:42:37,839 --> 00:42:42,480
uh just direct connections as you saw

924
00:42:41,359 --> 00:42:45,599
here um

925
00:42:42,480 --> 00:42:48,240
there are six uh

926
00:42:45,599 --> 00:42:49,440
all of this is uh one minute uh

927
00:42:48,240 --> 00:42:52,560
intervals

928
00:42:49,440 --> 00:42:56,240
so uh there is uh six

929
00:42:52,560 --> 00:42:56,880
uh requests per minute you have here uh

930
00:42:56,240 --> 00:42:58,800
this

931
00:42:56,880 --> 00:43:00,240
big peak when you execute the whois

932
00:42:58,800 --> 00:43:01,920
command

933
00:43:00,240 --> 00:43:03,440
so you can see there are like many many

934
00:43:01,920 --> 00:43:08,880
more uh

935
00:43:03,440 --> 00:43:11,680
connections in a in a in a minute

936
00:43:08,880 --> 00:43:12,960
and then it uses that algorithm from

937
00:43:11,680 --> 00:43:16,640
metasploit and then just

938
00:43:12,960 --> 00:43:20,240
reaches 10 per um

939
00:43:16,640 --> 00:43:24,319
at one request every 10 seconds so six

940
00:43:20,240 --> 00:43:27,040
per minute and here rita this is already

941
00:43:24,319 --> 00:43:30,319
the output from rita it gives a score of

942
00:43:27,040 --> 00:43:33,520
70 percent um

943
00:43:30,319 --> 00:43:36,400
to that ip that we were beaconing to

944
00:43:33,520 --> 00:43:37,440
here we have to to specify that this is

945
00:43:36,400 --> 00:43:40,560
just like

946
00:43:37,440 --> 00:43:42,880
half an hour of it running er

947
00:43:40,560 --> 00:43:44,400
of course when you do this uh beaconing

948
00:43:42,880 --> 00:43:47,680
detection with rita you want

949
00:43:44,400 --> 00:43:49,200
much bigger uh amounts of time like the

950
00:43:47,680 --> 00:43:52,960
traffic for a day or

951
00:43:49,200 --> 00:43:54,640
more uh here just for the experiment

952
00:43:52,960 --> 00:43:56,800
and for the proof of concept we just

953
00:43:54,640 --> 00:44:00,240
have a nine

954
00:43:56,800 --> 00:44:03,200
uh sorry half half an hour

955
00:44:00,240 --> 00:44:03,200
period of time

956
00:44:05,440 --> 00:44:10,400
so this is the normal way and then how

957
00:44:08,560 --> 00:44:13,680
does it look when we do it

958
00:44:10,400 --> 00:44:14,079
with the c2 centipede so we for this

959
00:44:13,680 --> 00:44:17,920
test

960
00:44:14,079 --> 00:44:21,040
we added 10 ips

961
00:44:17,920 --> 00:44:26,160
these are 10 frp

962
00:44:21,040 --> 00:44:29,119
http reverse proxies and then

963
00:44:26,160 --> 00:44:31,760
we set some faking of the responses so

964
00:44:29,119 --> 00:44:35,599
that it doesn't become so often

965
00:44:31,760 --> 00:44:39,440
okay so the result is this

966
00:44:35,599 --> 00:44:44,319
that sometimes uh you have many more

967
00:44:39,440 --> 00:44:46,640
well not that many actually but um

968
00:44:44,319 --> 00:44:48,720
at some point you you have some request

969
00:44:46,640 --> 00:44:51,920
and then it doesn't fake for a while

970
00:44:48,720 --> 00:44:53,760
and then you have periods of time

971
00:44:51,920 --> 00:44:55,359
that for five minutes for example you

972
00:44:53,760 --> 00:44:58,960
don't have any decon

973
00:44:55,359 --> 00:45:01,680
and then you can see that at this

974
00:44:58,960 --> 00:45:03,280
point of time it uses one server then

975
00:45:01,680 --> 00:45:05,760
here maybe it uses the same

976
00:45:03,280 --> 00:45:07,680
maybe here it uses another one and then

977
00:45:05,760 --> 00:45:09,680
use the green one the blue one the green

978
00:45:07,680 --> 00:45:12,880
one the pink one and so on

979
00:45:09,680 --> 00:45:16,000
so uh the beaconing

980
00:45:12,880 --> 00:45:19,040
is not a perfect beaconing so that

981
00:45:16,000 --> 00:45:23,839
tools like rita don't uh

982
00:45:19,040 --> 00:45:23,839
see these perfect beacons

983
00:45:25,680 --> 00:45:30,000
okay so uh the results from rita also by

984
00:45:29,119 --> 00:45:33,280
this uh

985
00:45:30,000 --> 00:45:37,920
half an hour period of time is

986
00:45:33,280 --> 00:45:40,560
that it doesn't see a beaconing

987
00:45:37,920 --> 00:45:41,680
pattern basically because there are less

988
00:45:40,560 --> 00:45:44,960
beacons and because

989
00:45:41,680 --> 00:45:48,880
it is routed through several um

990
00:45:44,960 --> 00:45:51,200
c c to ips so we can

991
00:45:48,880 --> 00:45:52,079
conclude at least for this very small

992
00:45:51,200 --> 00:45:55,520
experiment

993
00:45:52,079 --> 00:45:56,160
that it is uh like mission accomplished

994
00:45:55,520 --> 00:45:59,520
at this

995
00:45:56,160 --> 00:46:00,480
at least for this so the conclusion is

996
00:45:59,520 --> 00:46:03,599
basically that the

997
00:46:00,480 --> 00:46:05,280
beaconing is of course not the only

998
00:46:03,599 --> 00:46:08,640
threat hunting technique

999
00:46:05,280 --> 00:46:12,079
but one that blue teams should be doing

1000
00:46:08,640 --> 00:46:15,520
so if you are using the default vanilla

1001
00:46:12,079 --> 00:46:19,280
metasploit uh empire

1002
00:46:15,520 --> 00:46:22,560
know that if the blue team is doing

1003
00:46:19,280 --> 00:46:26,480
beaconing detection it will jump

1004
00:46:22,560 --> 00:46:29,200
right at the blue team it's very visible

1005
00:46:26,480 --> 00:46:29,839
but also if you use uh thousands of

1006
00:46:29,200 --> 00:46:33,440
servers

1007
00:46:29,839 --> 00:46:34,000
uh to proxy uh to your uh command and

1008
00:46:33,440 --> 00:46:37,040
control

1009
00:46:34,000 --> 00:46:38,880
uh server of course because it's not the

1010
00:46:37,040 --> 00:46:41,280
only thread hunting technique this

1011
00:46:38,880 --> 00:46:42,400
weakening detection uh you will be

1012
00:46:41,280 --> 00:46:44,880
detected

1013
00:46:42,400 --> 00:46:45,599
because a host is connecting to this so

1014
00:46:44,880 --> 00:46:48,640
many

1015
00:46:45,599 --> 00:46:49,599
servers so you need to balance it's a

1016
00:46:48,640 --> 00:46:52,640
balancing act

1017
00:46:49,599 --> 00:46:56,880
of how often you

1018
00:46:52,640 --> 00:47:01,440
want to be gone and so uh

1019
00:46:56,880 --> 00:47:05,119
how how much interactivity you are

1020
00:47:01,440 --> 00:47:08,560
willing to to lose

1021
00:47:05,119 --> 00:47:12,480
and also how stealthy you want to be

1022
00:47:08,560 --> 00:47:14,640
uh if you use really many uh

1023
00:47:12,480 --> 00:47:15,680
servers then you will be more visible so

1024
00:47:14,640 --> 00:47:19,280
you have to

1025
00:47:15,680 --> 00:47:22,960
uh balance this uh all of these

1026
00:47:19,280 --> 00:47:26,319
things okay so that was

1027
00:47:22,960 --> 00:47:29,359
all i would like to to thank you uh

1028
00:47:26,319 --> 00:47:31,520
it's a shame that i of course uh

1029
00:47:29,359 --> 00:47:33,680
most of us could not be there in

1030
00:47:31,520 --> 00:47:34,960
deathcore actually i wished it was my

1031
00:47:33,680 --> 00:47:38,160
first time there

1032
00:47:34,960 --> 00:47:41,680
um but that's how it goes i wish

1033
00:47:38,160 --> 00:47:45,119
you are safe and that

1034
00:47:41,680 --> 00:47:47,760
you can maybe contact me give me

1035
00:47:45,119 --> 00:47:48,480
a little bit of feedback and maybe a

1036
00:47:47,760 --> 00:47:50,400
chat or

1037
00:47:48,480 --> 00:47:54,800
something like that okay thank you very

1038
00:47:50,400 --> 00:47:54,800
much see you later

