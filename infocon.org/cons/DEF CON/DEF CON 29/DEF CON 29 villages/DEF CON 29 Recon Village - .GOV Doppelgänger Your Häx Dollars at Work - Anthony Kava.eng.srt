1
00:00:01,040 --> 00:00:03,760
is this thing on

2
00:00:04,480 --> 00:00:07,600
hello there good morning afternoon or

3
00:00:07,600 --> 00:00:09,599
evening uh wherever you're at

4
00:00:09,599 --> 00:00:12,240
and uh welcome to the the virtual recon

5
00:00:12,240 --> 00:00:14,320
village at defcon 29.

6
00:00:14,320 --> 00:00:15,920
thanks very much for listening i'm glad

7
00:00:15,920 --> 00:00:17,279
you're here i'm going to start off with

8
00:00:17,279 --> 00:00:18,400
a disclaimer first off

9
00:00:18,400 --> 00:00:21,439
that's most important my opinions

10
00:00:21,439 --> 00:00:23,119
are not my employers what you're going

11
00:00:23,119 --> 00:00:25,359
to hear are personal opinions

12
00:00:25,359 --> 00:00:27,599
i'm not going to lie to you all i ask is

13
00:00:27,599 --> 00:00:28,480
that you please help me

14
00:00:28,480 --> 00:00:30,320
not get fired or sued because i happen

15
00:00:30,320 --> 00:00:32,399
to love my job i also love not getting

16
00:00:32,399 --> 00:00:33,200
sued

17
00:00:33,200 --> 00:00:35,600
thank you for that i want to start off

18
00:00:35,600 --> 00:00:37,040
with a quick shout out

19
00:00:37,040 --> 00:00:39,600
first to defcon 402 that's the local

20
00:00:39,600 --> 00:00:42,320
omaha metropolitan area defcon group

21
00:00:42,320 --> 00:00:44,160
they heard the beta version of this talk

22
00:00:44,160 --> 00:00:45,600
they didn't throw a lot of stuff at me

23
00:00:45,600 --> 00:00:47,360
very supportive thank you for that

24
00:00:47,360 --> 00:00:49,600
i want to say thanks again to the apsec

25
00:00:49,600 --> 00:00:51,520
village and skytalks

26
00:00:51,520 --> 00:00:53,920
both of whom took a chance on me as a

27
00:00:53,920 --> 00:00:56,399
first time village speaker at dc27

28
00:00:56,399 --> 00:00:59,039
and of course biggest thank you to recon

29
00:00:59,039 --> 00:00:59,600
village

30
00:00:59,600 --> 00:01:01,039
uh for accepting this talk and for

31
00:01:01,039 --> 00:01:02,879
letting me take part and uh

32
00:01:02,879 --> 00:01:05,119
you know i really appreciate being part

33
00:01:05,119 --> 00:01:06,400
of your tradition

34
00:01:06,400 --> 00:01:08,560
traditions are important uh traditional

35
00:01:08,560 --> 00:01:10,400
traditions and internet traditions

36
00:01:10,400 --> 00:01:12,640
like wednesdays they're important and

37
00:01:12,640 --> 00:01:14,159
it's going to be a recurring topic

38
00:01:14,159 --> 00:01:16,880
that we talk about here but first i want

39
00:01:16,880 --> 00:01:17,920
to go back to winter

40
00:01:17,920 --> 00:01:20,320
the winter of 2020 and 2021. it's a

41
00:01:20,320 --> 00:01:21,119
bleak

42
00:01:21,119 --> 00:01:22,960
harsh winter especially harsh if you

43
00:01:22,960 --> 00:01:24,720
live in iowa like i do

44
00:01:24,720 --> 00:01:27,040
it's located conveniently in the middle

45
00:01:27,040 --> 00:01:28,240
smack dab of

46
00:01:28,240 --> 00:01:30,640
the contiguous united states and it gets

47
00:01:30,640 --> 00:01:31,759
very cold

48
00:01:31,759 --> 00:01:33,119
nobody wants to go outside and do

49
00:01:33,119 --> 00:01:34,799
anything

50
00:01:34,799 --> 00:01:36,400
for some reason the red army acquires

51
00:01:36,400 --> 00:01:38,479
things but anyway

52
00:01:38,479 --> 00:01:41,759
setting that aside i'm at work and i'm

53
00:01:41,759 --> 00:01:42,079
uh

54
00:01:42,079 --> 00:01:45,200
down in my office in storage b and

55
00:01:45,200 --> 00:01:47,439
i am taking the pandemic seriously and

56
00:01:47,439 --> 00:01:49,840
doing my duties so i am wearing a mask

57
00:01:49,840 --> 00:01:52,000
and i was probably listening uh to my

58
00:01:52,000 --> 00:01:53,759
favorite kind of music at the same time

59
00:01:53,759 --> 00:01:54,240
too

60
00:01:54,240 --> 00:01:56,799
but anyway i'm at my computer and i'm

61
00:01:56,799 --> 00:01:57,920
doing some of the

62
00:01:57,920 --> 00:01:59,759
mission critical work that my employer

63
00:01:59,759 --> 00:02:01,680
requires of me

64
00:02:01,680 --> 00:02:05,040
so as i'm reading emails i notice that i

65
00:02:05,040 --> 00:02:06,320
get one email

66
00:02:06,320 --> 00:02:09,280
that is uh it's addressed to me and it's

67
00:02:09,280 --> 00:02:11,200
copying a number of other people

68
00:02:11,200 --> 00:02:12,640
one of the addresses that copies doesn't

69
00:02:12,640 --> 00:02:14,319
have the right domain name so

70
00:02:14,319 --> 00:02:16,720
uh my domain name our our official one

71
00:02:16,720 --> 00:02:17,760
enzyme.gov

72
00:02:17,760 --> 00:02:20,720
i work at a county government but in

73
00:02:20,720 --> 00:02:22,400
this case the email was also addressed

74
00:02:22,400 --> 00:02:24,560
to somebody at the same exact name

75
00:02:24,560 --> 00:02:29,440
except editon.org easy mistake to make

76
00:02:29,680 --> 00:02:31,120
the question is though where does that

77
00:02:31,120 --> 00:02:32,879
email go i was curious you know

78
00:02:32,879 --> 00:02:35,920
who got that.org email it's easy enough

79
00:02:35,920 --> 00:02:36,640
to check

80
00:02:36,640 --> 00:02:38,400
i went and looked up mx records turns

81
00:02:38,400 --> 00:02:39,680
out nobody owned

82
00:02:39,680 --> 00:02:43,360
that dot org domain and

83
00:02:43,360 --> 00:02:45,920
for about eight dollars i or anyone else

84
00:02:45,920 --> 00:02:47,440
on the internet could buy that domain

85
00:02:47,440 --> 00:02:48,080
name

86
00:02:48,080 --> 00:02:50,160
and you know suddenly once you own the

87
00:02:50,160 --> 00:02:51,120
domain

88
00:02:51,120 --> 00:02:52,879
and you set up the dns and you can

89
00:02:52,879 --> 00:02:54,640
decide where the email goes and where

90
00:02:54,640 --> 00:02:56,959
web traffic goes and that sort of thing

91
00:02:56,959 --> 00:02:59,280
you're a hacker now uh you can start

92
00:02:59,280 --> 00:03:00,800
receiving emails you weren't supposed to

93
00:03:00,800 --> 00:03:02,080
be privy to

94
00:03:02,080 --> 00:03:03,599
and uh that's something we're going to

95
00:03:03,599 --> 00:03:05,840
talk about so

96
00:03:05,840 --> 00:03:07,519
how does somebody type a dot org instead

97
00:03:07,519 --> 00:03:09,519
of a gov i mean we're a county

98
00:03:09,519 --> 00:03:10,879
government or a government entity you'd

99
00:03:10,879 --> 00:03:13,200
expect gov is what people think but

100
00:03:13,200 --> 00:03:15,599
that's not always the case and again the

101
00:03:15,599 --> 00:03:17,440
answer is because of tradition

102
00:03:17,440 --> 00:03:20,879
because because across the united states

103
00:03:20,879 --> 00:03:23,599
uh local governments cities and counties

104
00:03:23,599 --> 00:03:24,720
for years and years

105
00:03:24,720 --> 00:03:28,480
have have used dot orgs and dot coms and

106
00:03:28,480 --> 00:03:29,200
dot u s

107
00:03:29,200 --> 00:03:32,480
domains uh instead of govs

108
00:03:32,480 --> 00:03:34,319
and uh it's only recently that local

109
00:03:34,319 --> 00:03:35,360
governments have started to move more

110
00:03:35,360 --> 00:03:36,400
into the the

111
00:03:36,400 --> 00:03:38,000
gub domain space i remember a time

112
00:03:38,000 --> 00:03:39,760
before the web was invented

113
00:03:39,760 --> 00:03:41,840
when uh dot us was actually a pretty big

114
00:03:41,840 --> 00:03:43,519
deal for public institutions and a lot

115
00:03:43,519 --> 00:03:44,560
of people were using it

116
00:03:44,560 --> 00:03:46,879
uh you know americans are stubborn they

117
00:03:46,879 --> 00:03:48,640
didn't standardize it on it

118
00:03:48,640 --> 00:03:50,560
like they did in the uk or in germany

119
00:03:50,560 --> 00:03:51,840
and places like that

120
00:03:51,840 --> 00:03:54,080
anyway that means that local government

121
00:03:54,080 --> 00:03:55,680
entities are using all sorts of

122
00:03:55,680 --> 00:03:58,840
different domains.coms.net.org.us

123
00:03:58,840 --> 00:04:00,080
domains

124
00:04:00,080 --> 00:04:01,519
and that makes it tough to know which is

125
00:04:01,519 --> 00:04:03,439
the the real deal but then there's

126
00:04:03,439 --> 00:04:06,080
the.gov top level domain it's a special

127
00:04:06,080 --> 00:04:07,519
top-level domain

128
00:04:07,519 --> 00:04:09,200
available only to government entities in

129
00:04:09,200 --> 00:04:11,200
the united states

130
00:04:11,200 --> 00:04:12,560
how do you get one of these and why

131
00:04:12,560 --> 00:04:15,040
would somebody not use one well

132
00:04:15,040 --> 00:04:16,399
getting one you have to apply to the

133
00:04:16,399 --> 00:04:18,238
federal government to get to get your

134
00:04:18,238 --> 00:04:19,839
gov domain and a couple years ago i

135
00:04:19,839 --> 00:04:21,440
guess it was a little bit too easy to do

136
00:04:21,440 --> 00:04:22,320
because uh

137
00:04:22,320 --> 00:04:23,759
brian krebs ran an article there was a

138
00:04:23,759 --> 00:04:25,520
fellow who

139
00:04:25,520 --> 00:04:28,080
was able to get a gov domain and all he

140
00:04:28,080 --> 00:04:28,639
had to do

141
00:04:28,639 --> 00:04:32,160
was download the logos from a town in

142
00:04:32,160 --> 00:04:33,120
rhode island

143
00:04:33,120 --> 00:04:35,040
put them on letterhead and say i'm the

144
00:04:35,040 --> 00:04:37,040
mayor give me a gov and it

145
00:04:37,040 --> 00:04:40,479
worked out so that wasn't good

146
00:04:40,960 --> 00:04:42,400
i don't recommend that by the way i just

147
00:04:42,400 --> 00:04:44,000
want to be clear that uh forging

148
00:04:44,000 --> 00:04:45,199
documents and you know

149
00:04:45,199 --> 00:04:46,880
getting.gov domain you're not supposed

150
00:04:46,880 --> 00:04:48,400
to that's fraud or forgery that's

151
00:04:48,400 --> 00:04:49,520
illegal stuff

152
00:04:49,520 --> 00:04:51,919
don't do crimes stay in school kids uh

153
00:04:51,919 --> 00:04:52,880
but

154
00:04:52,880 --> 00:04:55,280
back then the gov registry was run by

155
00:04:55,280 --> 00:04:57,280
gsa if you've ever if you've ever worked

156
00:04:57,280 --> 00:04:57,680
for

157
00:04:57,680 --> 00:04:59,919
with or in the us federal government you

158
00:04:59,919 --> 00:05:01,759
probably had dealings with gsa and they

159
00:05:01,759 --> 00:05:03,600
had a whole bunch of different rules

160
00:05:03,600 --> 00:05:05,680
and they did do work to try to verify

161
00:05:05,680 --> 00:05:07,199
those domains but obviously some

162
00:05:07,199 --> 00:05:09,840
slipped through nowadays the.gov

163
00:05:09,840 --> 00:05:10,880
registry is run

164
00:05:10,880 --> 00:05:12,960
under cisa it was moved over it was kind

165
00:05:12,960 --> 00:05:14,280
of part of the fallout from the

166
00:05:14,280 --> 00:05:16,400
2016-2020 elections

167
00:05:16,400 --> 00:05:19,520
um and now it's free to get a

168
00:05:19,520 --> 00:05:20,720
gov domain it's free for local

169
00:05:20,720 --> 00:05:22,479
governments to register those it used to

170
00:05:22,479 --> 00:05:23,280
be a 400

171
00:05:23,280 --> 00:05:25,039
a year fee that doesn't seem like very

172
00:05:25,039 --> 00:05:27,120
much and it's not if you're in the

173
00:05:27,120 --> 00:05:28,160
federal government

174
00:05:28,160 --> 00:05:29,919
but if you are a uh you know town with

175
00:05:29,919 --> 00:05:31,680
500 or a thousand people or something a

176
00:05:31,680 --> 00:05:32,639
400

177
00:05:32,639 --> 00:05:34,000
expenditure is actually a pretty big

178
00:05:34,000 --> 00:05:36,080
expenditure it's free now they

179
00:05:36,080 --> 00:05:38,560
they want you to go to it in part for

180
00:05:38,560 --> 00:05:40,400
election security but also just to make

181
00:05:40,400 --> 00:05:41,759
it clear that you are a government

182
00:05:41,759 --> 00:05:42,479
entity

183
00:05:42,479 --> 00:05:45,120
and so local governments are moving in

184
00:05:45,120 --> 00:05:45,840
droves

185
00:05:45,840 --> 00:05:48,080
to gov domains and there are good

186
00:05:48,080 --> 00:05:49,759
reasons for doing that

187
00:05:49,759 --> 00:05:52,000
the gov domain carries a certain cachet

188
00:05:52,000 --> 00:05:53,440
when you see it you know it's got to be

189
00:05:53,440 --> 00:05:54,720
a government entity because no one else

190
00:05:54,720 --> 00:05:56,800
should be able to get one

191
00:05:56,800 --> 00:05:58,319
it's trusted more whether that's the

192
00:05:58,319 --> 00:06:00,319
right way to do it or not employees and

193
00:06:00,319 --> 00:06:01,919
citizens trust it

194
00:06:01,919 --> 00:06:03,280
and yet there are still a lot of

195
00:06:03,280 --> 00:06:04,840
governments out there that use

196
00:06:04,840 --> 00:06:06,720
dotcoms.net

197
00:06:06,720 --> 00:06:09,759
and us domains and

198
00:06:09,759 --> 00:06:12,240
why do they do that again it's tradition

199
00:06:12,240 --> 00:06:14,720
it's as old as star wars

200
00:06:14,720 --> 00:06:17,759
themed weddings the tradition i mean

201
00:06:17,759 --> 00:06:20,479
look at multnomah county in oregon

202
00:06:20,479 --> 00:06:22,319
they've been using a.u.s domain for

203
00:06:22,319 --> 00:06:24,560
20 years so their citizens and employees

204
00:06:24,560 --> 00:06:25,440
know to go there

205
00:06:25,440 --> 00:06:28,400
that's the place they go to syracuse in

206
00:06:28,400 --> 00:06:29,680
in new york

207
00:06:29,680 --> 00:06:31,919
that city has a net domain a little bit

208
00:06:31,919 --> 00:06:33,039
unusual but

209
00:06:33,039 --> 00:06:34,240
they've been using it for a number of

210
00:06:34,240 --> 00:06:36,880
years as well

211
00:06:37,199 --> 00:06:38,560
we're going to talk about using

212
00:06:38,560 --> 00:06:41,440
look-alike domains and specifically

213
00:06:41,440 --> 00:06:45,240
using impersonations of.gov domains

214
00:06:45,240 --> 00:06:47,440
and.us.org whatever local governments

215
00:06:47,440 --> 00:06:49,680
are using because it's it's dangerous

216
00:06:49,680 --> 00:06:52,080
and also because uh you know it works

217
00:06:52,080 --> 00:06:52,720
and so

218
00:06:52,720 --> 00:06:54,400
those of you who are red teamers for a

219
00:06:54,400 --> 00:06:56,080
living you you probably are hearing this

220
00:06:56,080 --> 00:06:56,720
and you think

221
00:06:56,720 --> 00:06:58,880
this isn't super advanced and you are

222
00:06:58,880 --> 00:06:59,919
right it's not

223
00:06:59,919 --> 00:07:02,960
but it is effective um and it's a form

224
00:07:02,960 --> 00:07:04,240
of typo squatting

225
00:07:04,240 --> 00:07:05,680
so i'm sure everyone knows what type of

226
00:07:05,680 --> 00:07:07,120
squatting is you type facebook wrong or

227
00:07:07,120 --> 00:07:08,639
gmail wrong you end up at the wrong site

228
00:07:08,639 --> 00:07:09,840
i hope you don't get you know loaded

229
00:07:09,840 --> 00:07:11,840
down malware when that happens

230
00:07:11,840 --> 00:07:13,919
there's a term cyber squatting that's

231
00:07:13,919 --> 00:07:15,520
used now to cover typo squatting and

232
00:07:15,520 --> 00:07:16,479
other types of

233
00:07:16,479 --> 00:07:18,639
lookalike domains and things like that

234
00:07:18,639 --> 00:07:20,000
it sounds cooler because it has the word

235
00:07:20,000 --> 00:07:21,360
cyber in it plus when you put it in your

236
00:07:21,360 --> 00:07:22,880
title it doubles your pay

237
00:07:22,880 --> 00:07:25,840
so that's good we're going to talk a

238
00:07:25,840 --> 00:07:27,440
little bit about doppelganger domains

239
00:07:27,440 --> 00:07:29,599
and so their look-alike domains imposter

240
00:07:29,599 --> 00:07:30,639
domains

241
00:07:30,639 --> 00:07:32,800
that are missing a dot pretty easy to do

242
00:07:32,800 --> 00:07:34,000
an easy mistake for

243
00:07:34,000 --> 00:07:37,520
somebody to make but we can also you

244
00:07:37,520 --> 00:07:37,919
know

245
00:07:37,919 --> 00:07:39,840
that's doppelganger's a german term we

246
00:07:39,840 --> 00:07:41,039
can also go back to

247
00:07:41,039 --> 00:07:43,039
greek because there are some lovely

248
00:07:43,039 --> 00:07:44,400
things you can do to set up

249
00:07:44,400 --> 00:07:46,639
look-alike domains uh using techniques

250
00:07:46,639 --> 00:07:48,479
like homophones those are words that are

251
00:07:48,479 --> 00:07:50,240
spelled differently but sound the same

252
00:07:50,240 --> 00:07:52,960
you can trick users that way um everyone

253
00:07:52,960 --> 00:07:55,440
loves unicode i'm sure you do

254
00:07:55,440 --> 00:07:57,680
and dealing with uh yeah dealing with

255
00:07:57,680 --> 00:07:59,599
that unicode offers a whole bunch of

256
00:07:59,599 --> 00:08:00,560
different alphabets

257
00:08:00,560 --> 00:08:02,400
and there are alphabets like cyrillic

258
00:08:02,400 --> 00:08:03,840
that have letters that look similar to

259
00:08:03,840 --> 00:08:04,720
the latin ones

260
00:08:04,720 --> 00:08:07,280
but aren't the same and they make lovely

261
00:08:07,280 --> 00:08:09,440
lovely imposter domains

262
00:08:09,440 --> 00:08:11,919
bit squatting this one you may have read

263
00:08:11,919 --> 00:08:13,840
there's a paper out recently on this and

264
00:08:13,840 --> 00:08:15,759
some amazing stuff and basically every

265
00:08:15,759 --> 00:08:16,240
now and

266
00:08:16,240 --> 00:08:18,240
again a computer accidentally changes a

267
00:08:18,240 --> 00:08:19,280
one to a zero

268
00:08:19,280 --> 00:08:20,879
apparently it's done by space rays and

269
00:08:20,879 --> 00:08:22,720
possibly aliens are behind it whatever

270
00:08:22,720 --> 00:08:24,720
it is it's really really cool

271
00:08:24,720 --> 00:08:27,199
we don't need any of that we have very

272
00:08:27,199 --> 00:08:27,919
simple

273
00:08:27,919 --> 00:08:30,960
very simple attacks to do just by

274
00:08:30,960 --> 00:08:33,519
substituting dot org or dot com for

275
00:08:33,519 --> 00:08:36,159
gov and once you can get someone to go

276
00:08:36,159 --> 00:08:37,599
to your lookalike domain

277
00:08:37,599 --> 00:08:39,440
you control what their experience is you

278
00:08:39,440 --> 00:08:41,599
control what website they go to for real

279
00:08:41,599 --> 00:08:42,320
and

280
00:08:42,320 --> 00:08:45,360
you control where email goes so

281
00:08:45,360 --> 00:08:47,040
that's all we need all we need to do is

282
00:08:47,040 --> 00:08:48,640
rely on

283
00:08:48,640 --> 00:08:50,880
human nature and human nature says that

284
00:08:50,880 --> 00:08:51,920
somebody is going to

285
00:08:51,920 --> 00:08:53,680
who's been used to typing.org for 20

286
00:08:53,680 --> 00:08:55,920
years is going to keep typing.org even

287
00:08:55,920 --> 00:08:56,760
when

288
00:08:56,760 --> 00:08:59,519
governmentswitches.gov why do i care

289
00:08:59,519 --> 00:09:01,600
about this why am i

290
00:09:01,600 --> 00:09:03,760
talking to you about this today well

291
00:09:03,760 --> 00:09:04,640
i've worked

292
00:09:04,640 --> 00:09:08,080
in county government for about 20 years

293
00:09:08,080 --> 00:09:09,839
and you know when i started i actually

294
00:09:09,839 --> 00:09:11,519
had a lot more hair and probably a

295
00:09:11,519 --> 00:09:13,440
little bit more sanity

296
00:09:13,440 --> 00:09:16,720
and uh i i'm still going strong but i

297
00:09:16,720 --> 00:09:18,160
care about the security

298
00:09:18,160 --> 00:09:21,200
of our local governments and i started

299
00:09:21,200 --> 00:09:22,399
out in our county's i.t

300
00:09:22,399 --> 00:09:25,200
department i spent 15 years there during

301
00:09:25,200 --> 00:09:25,680
the last

302
00:09:25,680 --> 00:09:28,320
eight years i dur by day i was a

303
00:09:28,320 --> 00:09:29,360
mild-mannered

304
00:09:29,360 --> 00:09:32,240
i.t professional and by night i fought

305
00:09:32,240 --> 00:09:33,040
crime

306
00:09:33,040 --> 00:09:34,560
as a reserve deputy in our sheriff's

307
00:09:34,560 --> 00:09:36,320
office and i started doing digital

308
00:09:36,320 --> 00:09:38,800
forensics that way

309
00:09:38,800 --> 00:09:41,279
and and i i guess i don't really have a

310
00:09:41,279 --> 00:09:42,560
cv slide but

311
00:09:42,560 --> 00:09:44,640
my favorite accomplishment is that i

312
00:09:44,640 --> 00:09:45,920
think i am federally

313
00:09:45,920 --> 00:09:48,399
considered a porn expert because i was

314
00:09:48,399 --> 00:09:49,680
at a federal trial once

315
00:09:49,680 --> 00:09:52,000
testifying and uh the defense attorney

316
00:09:52,000 --> 00:09:53,279
came up and

317
00:09:53,279 --> 00:09:56,240
i was ready uh to uh it was ready to

318
00:09:56,240 --> 00:09:57,120
examine me and

319
00:09:57,120 --> 00:09:58,640
uh in his line of questioning he started

320
00:09:58,640 --> 00:10:00,399
off deputy cava

321
00:10:00,399 --> 00:10:03,360
you're an expert in pornography and

322
00:10:03,360 --> 00:10:04,959
there was this pause and it was empty

323
00:10:04,959 --> 00:10:06,000
and so i just said

324
00:10:06,000 --> 00:10:08,240
thank you and uh stenographer typed it

325
00:10:08,240 --> 00:10:10,160
down it went into the transcript and now

326
00:10:10,160 --> 00:10:12,720
i think federally i am recognized as a

327
00:10:12,720 --> 00:10:14,399
porn expert so there's that

328
00:10:14,399 --> 00:10:17,680
um i i've been on the i've been on our

329
00:10:17,680 --> 00:10:18,240
state's

330
00:10:18,240 --> 00:10:19,920
internet crimes against children task

331
00:10:19,920 --> 00:10:23,040
force since 2009 and so when i explain

332
00:10:23,040 --> 00:10:25,360
it to students i tell them that you know

333
00:10:25,360 --> 00:10:27,040
we go after bad guys on the internet who

334
00:10:27,040 --> 00:10:28,480
go after kids so

335
00:10:28,480 --> 00:10:29,920
you know we're the good guys marty for

336
00:10:29,920 --> 00:10:32,880
those of you of a certain age

337
00:10:32,880 --> 00:10:36,160
i am a hacker and i carry a badge and i

338
00:10:36,160 --> 00:10:37,360
don't think those things are mutually

339
00:10:37,360 --> 00:10:39,360
exclusive in fact i think we need more

340
00:10:39,360 --> 00:10:40,959
of that i think we need more people

341
00:10:40,959 --> 00:10:43,839
who subscribe to the hacker ethos who

342
00:10:43,839 --> 00:10:46,079
who believe in transparency uh who

343
00:10:46,079 --> 00:10:47,519
believe in privacy

344
00:10:47,519 --> 00:10:49,279
who believe in you know judging people

345
00:10:49,279 --> 00:10:51,040
by who they are not by you know who

346
00:10:51,040 --> 00:10:52,640
their parents were where they came from

347
00:10:52,640 --> 00:10:53,600
what they look like

348
00:10:53,600 --> 00:10:54,800
i think we need more of that in law

349
00:10:54,800 --> 00:10:56,640
enforcement um and i

350
00:10:56,640 --> 00:10:58,720
i want to just so you've got something

351
00:10:58,720 --> 00:11:00,079
hopeful hopeful message to come out of

352
00:11:00,079 --> 00:11:00,560
this

353
00:11:00,560 --> 00:11:02,160
i want to let you know there are

354
00:11:02,160 --> 00:11:04,079
literally dozens of us out there

355
00:11:04,079 --> 00:11:05,839
and we are infiltrating law enforcement

356
00:11:05,839 --> 00:11:07,440
all over the united states and elsewhere

357
00:11:07,440 --> 00:11:09,279
so uh

358
00:11:09,279 --> 00:11:10,720
i'm hoping that we can affect some sort

359
00:11:10,720 --> 00:11:12,720
of change but

360
00:11:12,720 --> 00:11:15,680
my job and i work in a sheriff's office

361
00:11:15,680 --> 00:11:16,560
is uh

362
00:11:16,560 --> 00:11:18,560
investigating cyber crime and and that

363
00:11:18,560 --> 00:11:19,920
can mean you know looking into facebook

364
00:11:19,920 --> 00:11:21,200
accounts that means uh

365
00:11:21,200 --> 00:11:23,680
doing forensic examination so i also uh

366
00:11:23,680 --> 00:11:25,519
you know will dump cell phones i look at

367
00:11:25,519 --> 00:11:27,040
computers that sort of thing

368
00:11:27,040 --> 00:11:28,640
i do all those and then i also have a

369
00:11:28,640 --> 00:11:30,240
cyber security role and i've had

370
00:11:30,240 --> 00:11:32,079
that kind of role ever since my days in

371
00:11:32,079 --> 00:11:34,160
it

372
00:11:34,160 --> 00:11:36,320
we have at the local government level

373
00:11:36,320 --> 00:11:38,000
the same kind of challenges that you

374
00:11:38,000 --> 00:11:39,680
have at any organization we have a

375
00:11:39,680 --> 00:11:41,120
domain to protect

376
00:11:41,120 --> 00:11:44,320
and we want to do that and

377
00:11:44,320 --> 00:11:46,880
that also means looking out for our you

378
00:11:46,880 --> 00:11:48,480
know actual domain names

379
00:11:48,480 --> 00:11:51,040
so i work for a place called potawatomi

380
00:11:51,040 --> 00:11:51,519
county

381
00:11:51,519 --> 00:11:53,200
there'll be a spelling test later on so

382
00:11:53,200 --> 00:11:54,959
don't worry about it for now but

383
00:11:54,959 --> 00:11:57,839
nobody our citizens can hardly spell it

384
00:11:57,839 --> 00:11:59,839
and so we don't use that name spelled

385
00:11:59,839 --> 00:12:00,639
out we uh

386
00:12:00,639 --> 00:12:02,240
for years and years about almost 20

387
00:12:02,240 --> 00:12:04,880
years uh used potcounty.com with two t's

388
00:12:04,880 --> 00:12:05,360
as our

389
00:12:05,360 --> 00:12:07,920
as our domain name when i was in i.t i

390
00:12:07,920 --> 00:12:09,920
registered the 1t variant just to make

391
00:12:09,920 --> 00:12:11,360
sure that nobody could grab that away

392
00:12:11,360 --> 00:12:12,399
from us

393
00:12:12,399 --> 00:12:14,079
before it was cool and before it was

394
00:12:14,079 --> 00:12:15,760
free we switched over to a

395
00:12:15,760 --> 00:12:19,200
gov domain and back then i didn't think

396
00:12:19,200 --> 00:12:21,120
i didn't think to register the dot com

397
00:12:21,120 --> 00:12:23,519
or dot org they go along with that

398
00:12:23,519 --> 00:12:25,600
so i missed out on an opportunity there

399
00:12:25,600 --> 00:12:27,120
which brings me back to this email this

400
00:12:27,120 --> 00:12:28,399
email that's going

401
00:12:28,399 --> 00:12:29,839
nowhere it's going to a dot org that

402
00:12:29,839 --> 00:12:32,399
doesn't exist i started looking into it

403
00:12:32,399 --> 00:12:33,920
and then i thought well i wonder where

404
00:12:33,920 --> 00:12:35,440
else in the state of iowa this could be

405
00:12:35,440 --> 00:12:36,320
happening because i

406
00:12:36,320 --> 00:12:37,839
you know work with other counties and so

407
00:12:37,839 --> 00:12:39,279
on there are 98 other counties in the

408
00:12:39,279 --> 00:12:40,240
state of iowa

409
00:12:40,240 --> 00:12:43,440
and it turns out a lot of them had

410
00:12:43,440 --> 00:12:44,959
this potential vulnerability they had

411
00:12:44,959 --> 00:12:46,800
domains available that were very similar

412
00:12:46,800 --> 00:12:48,639
to their real domain

413
00:12:48,639 --> 00:12:51,600
and as i looked at those you know i got

414
00:12:51,600 --> 00:12:52,639
to thinking

415
00:12:52,639 --> 00:12:54,800
state of iowa is not very big it's not

416
00:12:54,800 --> 00:12:56,160
not a very populous place

417
00:12:56,160 --> 00:12:57,920
there got to be bigger fish in the sea

418
00:12:57,920 --> 00:12:59,440
there's got to be you know bigger

419
00:12:59,440 --> 00:13:01,120
targets out there and

420
00:13:01,120 --> 00:13:03,279
where do you find them well thankfully

421
00:13:03,279 --> 00:13:04,560
the sum

422
00:13:04,560 --> 00:13:06,639
total of human knowledge is now out on

423
00:13:06,639 --> 00:13:09,200
the internet under wikipedia.org so

424
00:13:09,200 --> 00:13:10,560
you can find them there there's a list

425
00:13:10,560 --> 00:13:13,440
of cities and counties listed by

426
00:13:13,440 --> 00:13:14,959
their populations and so if you want to

427
00:13:14,959 --> 00:13:17,040
find the most populous ones the best

428
00:13:17,040 --> 00:13:19,360
biggest targets to look at that's one

429
00:13:19,360 --> 00:13:21,360
way to do it

430
00:13:21,360 --> 00:13:23,920
and that led to an experiment that led

431
00:13:23,920 --> 00:13:24,639
to

432
00:13:24,639 --> 00:13:26,800
some research i decided i want to find

433
00:13:26,800 --> 00:13:28,800
out what other counties are out there

434
00:13:28,800 --> 00:13:30,240
what other cities are out there

435
00:13:30,240 --> 00:13:31,760
that could fall victim to this sort of

436
00:13:31,760 --> 00:13:34,399
thing and what can we do about it

437
00:13:34,399 --> 00:13:37,440
like all of life's hardest problems this

438
00:13:37,440 --> 00:13:40,000
one was solved with pearl

439
00:13:40,000 --> 00:13:42,639
and i wrote some pearl code to go out to

440
00:13:42,639 --> 00:13:43,680
wikipedia

441
00:13:43,680 --> 00:13:45,360
scrape that list of most populous

442
00:13:45,360 --> 00:13:47,040
counties and cities and then go

443
00:13:47,040 --> 00:13:49,279
a level deeper and find the websites for

444
00:13:49,279 --> 00:13:50,959
them out of the individual articles

445
00:13:50,959 --> 00:13:53,279
there's probably an api for it but i was

446
00:13:53,279 --> 00:13:54,720
too lazy to learn it so i just did it

447
00:13:54,720 --> 00:13:55,839
with regex's

448
00:13:55,839 --> 00:13:58,399
i put that into a database did some dns

449
00:13:58,399 --> 00:14:00,160
queries did some who is queries

450
00:14:00,160 --> 00:14:01,600
figured out which of those domains were

451
00:14:01,600 --> 00:14:04,079
available made a nice list of targets

452
00:14:04,079 --> 00:14:06,320
and i didn't do anything super fancy

453
00:14:06,320 --> 00:14:07,440
there's no uh

454
00:14:07,440 --> 00:14:09,920
you know raise from space involved here

455
00:14:09,920 --> 00:14:11,519
if they had a dot gov i looked at the

456
00:14:11,519 --> 00:14:12,320
dot com and

457
00:14:12,320 --> 00:14:13,839
org that were similar if they had a dot

458
00:14:13,839 --> 00:14:17,279
us same thing and

459
00:14:17,279 --> 00:14:19,279
as i was doing this i thought why limit

460
00:14:19,279 --> 00:14:21,440
ourselves to uh to the united states i

461
00:14:21,440 --> 00:14:21,839
mean

462
00:14:21,839 --> 00:14:23,440
and every other country has governments

463
00:14:23,440 --> 00:14:26,000
too and what about the uk we've got our

464
00:14:26,000 --> 00:14:27,199
special relationship with them they

465
00:14:27,199 --> 00:14:28,639
should like us they haven't invaded us

466
00:14:28,639 --> 00:14:30,399
in 207 years that things were going

467
00:14:30,399 --> 00:14:31,600
really well i thought it was about time

468
00:14:31,600 --> 00:14:33,279
to shake things up

469
00:14:33,279 --> 00:14:35,440
so i looked at gov.uk to see what else

470
00:14:35,440 --> 00:14:37,600
was available for them

471
00:14:37,600 --> 00:14:39,199
that's their equivalent to our.gov

472
00:14:39,199 --> 00:14:41,839
domain yada yada yada

473
00:14:41,839 --> 00:14:45,199
i ended up with 42 look-alike domains

474
00:14:45,199 --> 00:14:46,160
that looked like

475
00:14:46,160 --> 00:14:49,600
local governments from here and abroad

476
00:14:49,600 --> 00:14:53,279
and basically if they had a.gov i looked

477
00:14:53,279 --> 00:14:53,680
for the

478
00:14:53,680 --> 00:14:56,240
similar coms or orgs if they had a dot

479
00:14:56,240 --> 00:14:58,160
u.s i looked for doppelganger

480
00:14:58,160 --> 00:15:00,000
opportunities

481
00:15:00,000 --> 00:15:02,720
we in my county and this is that's how

482
00:15:02,720 --> 00:15:03,519
you spell it

483
00:15:03,519 --> 00:15:06,360
i have one of these official

484
00:15:06,360 --> 00:15:08,320
co.countyname.state.us domains

485
00:15:08,320 --> 00:15:10,800
and those are rife for um for

486
00:15:10,800 --> 00:15:12,000
doppelganger attacks too

487
00:15:12,000 --> 00:15:14,079
drop that dot out of there so look to

488
00:15:14,079 --> 00:15:15,120
some of those

489
00:15:15,120 --> 00:15:17,440
and gov.uk as i mentioned it's their

490
00:15:17,440 --> 00:15:19,199
equivalent to our.gov

491
00:15:19,199 --> 00:15:21,760
and people will miss that last stop

492
00:15:21,760 --> 00:15:22,959
before the gov and so

493
00:15:22,959 --> 00:15:26,079
i registered a couple of those and this

494
00:15:26,079 --> 00:15:27,519
isn't something limited just to

495
00:15:27,519 --> 00:15:30,079
you know the uk and the u.s there are

496
00:15:30,079 --> 00:15:31,360
domains that are

497
00:15:31,360 --> 00:15:33,440
parked or domains that are available for

498
00:15:33,440 --> 00:15:35,360
countries all over the world

499
00:15:35,360 --> 00:15:37,839
and uh one interesting thing that came

500
00:15:37,839 --> 00:15:39,600
out of this was i found out that the uk

501
00:15:39,600 --> 00:15:41,199
actually has a safety net in place to

502
00:15:41,199 --> 00:15:41,759
protect

503
00:15:41,759 --> 00:15:42,959
to prevent this sort of thing from

504
00:15:42,959 --> 00:15:44,399
happening something we don't have in the

505
00:15:44,399 --> 00:15:45,360
u.s

506
00:15:45,360 --> 00:15:49,279
um they have read they have a registrar

507
00:15:49,279 --> 00:15:51,120
with regulations that say that you

508
00:15:51,120 --> 00:15:52,639
cannot register a domain

509
00:15:52,639 --> 00:15:53,839
if you're going to use it for phishing

510
00:15:53,839 --> 00:15:55,920
or illegal stuff i mean it's it's a good

511
00:15:55,920 --> 00:15:56,639
idea

512
00:15:56,639 --> 00:15:58,160
and they didn't actually let me register

513
00:15:58,160 --> 00:15:59,920
the domain at first they said this looks

514
00:15:59,920 --> 00:16:00,560
hinky

515
00:16:00,560 --> 00:16:03,680
and they uh sent me a an instagram by

516
00:16:03,680 --> 00:16:04,320
email

517
00:16:04,320 --> 00:16:06,240
and asked what that guy was up to i told

518
00:16:06,240 --> 00:16:07,839
him doing some research i promise i'm

519
00:16:07,839 --> 00:16:09,040
not doing anything bad if he can't give

520
00:16:09,040 --> 00:16:10,000
me the domain

521
00:16:10,000 --> 00:16:13,199
no big deal um the appeal went up i

522
00:16:13,199 --> 00:16:14,560
assumed at the highest levels of

523
00:16:14,560 --> 00:16:15,120
government

524
00:16:15,120 --> 00:16:17,440
and it went through i was able to

525
00:16:17,440 --> 00:16:18,959
actually register the domains i wanted

526
00:16:18,959 --> 00:16:19,360
so

527
00:16:19,360 --> 00:16:21,759
somehow i got away with it just barely

528
00:16:21,759 --> 00:16:22,720
and so

529
00:16:22,720 --> 00:16:25,519
no international incident there good

530
00:16:25,519 --> 00:16:26,079
thing

531
00:16:26,079 --> 00:16:28,720
let's get back to the experiment so the

532
00:16:28,720 --> 00:16:29,839
goals of the experiment we're going to

533
00:16:29,839 --> 00:16:31,120
do something good we're going to try to

534
00:16:31,120 --> 00:16:32,320
take some of these domains out of

535
00:16:32,320 --> 00:16:34,160
circulation so that an attacker can't

536
00:16:34,160 --> 00:16:34,720
use them

537
00:16:34,720 --> 00:16:35,920
we're also going to try to increase

538
00:16:35,920 --> 00:16:37,279
awareness that's actually part of what

539
00:16:37,279 --> 00:16:39,920
this talk is about

540
00:16:39,920 --> 00:16:41,920
i've got these 42 look-alike domains

541
00:16:41,920 --> 00:16:44,160
ready to go so i set them up

542
00:16:44,160 --> 00:16:46,560
to redirect their web traffic to the

543
00:16:46,560 --> 00:16:48,959
real site that they're that they're

544
00:16:48,959 --> 00:16:50,480
that they look like to the actual

545
00:16:50,480 --> 00:16:52,639
government sites just as a 302 it

546
00:16:52,639 --> 00:16:53,680
doesn't say that

547
00:16:53,680 --> 00:16:55,519
you know our lookalike is the actual

548
00:16:55,519 --> 00:16:57,519
site we just redirected the real one

549
00:16:57,519 --> 00:17:01,279
um also started bouncing emails

550
00:17:01,279 --> 00:17:03,759
so set up mx record and anybody who

551
00:17:03,759 --> 00:17:05,599
emails one of these lookalike domains

552
00:17:05,599 --> 00:17:08,000
they immediately get a bounce message

553
00:17:08,000 --> 00:17:09,839
back so we're looking at the email

554
00:17:09,839 --> 00:17:11,520
for research purposes to figure out you

555
00:17:11,520 --> 00:17:14,000
know how bad this problem could be

556
00:17:14,000 --> 00:17:15,760
but we're also telling them this is not

557
00:17:15,760 --> 00:17:17,199
the right address and

558
00:17:17,199 --> 00:17:18,880
usually after the second or third try

559
00:17:18,880 --> 00:17:21,119
they figured that out

560
00:17:21,119 --> 00:17:23,119
they're at no point did we do anything

561
00:17:23,119 --> 00:17:24,959
to try to entice people

562
00:17:24,959 --> 00:17:26,959
to use these lookalike domains so at no

563
00:17:26,959 --> 00:17:28,400
point was i taking a domain and putting

564
00:17:28,400 --> 00:17:29,840
it out there on google or whatever and

565
00:17:29,840 --> 00:17:31,600
saying this is the official one

566
00:17:31,600 --> 00:17:34,000
anything that came in was unsolicited

567
00:17:34,000 --> 00:17:35,360
and i decided to take

568
00:17:35,360 --> 00:17:37,039
you know i used the prime directive and

569
00:17:37,039 --> 00:17:38,960
decided not to interfere with anything

570
00:17:38,960 --> 00:17:40,720
that happened here obviously if i saw an

571
00:17:40,720 --> 00:17:42,160
email that said you know somebody was in

572
00:17:42,160 --> 00:17:43,440
immediate danger i would have taken

573
00:17:43,440 --> 00:17:43,919
action

574
00:17:43,919 --> 00:17:45,280
right away but that never came up

575
00:17:45,280 --> 00:17:47,600
thankfully so no problem

576
00:17:47,600 --> 00:17:49,520
this sounds kind of sleazy people you

577
00:17:49,520 --> 00:17:50,880
know registering domains that look like

578
00:17:50,880 --> 00:17:52,480
someone else's domain there ought to be

579
00:17:52,480 --> 00:17:52,960
a law

580
00:17:52,960 --> 00:17:55,440
right and it turns out there is since

581
00:17:55,440 --> 00:17:57,520
1999 there's the anti-cyber squatting

582
00:17:57,520 --> 00:17:58,160
consumer

583
00:17:58,160 --> 00:18:00,559
protection act and it's uh it's not

584
00:18:00,559 --> 00:18:01,520
criminal so you're not going to go to

585
00:18:01,520 --> 00:18:02,320
jail for it

586
00:18:02,320 --> 00:18:04,720
but it gives companies a way to sue if

587
00:18:04,720 --> 00:18:06,080
somebody tries to water down their

588
00:18:06,080 --> 00:18:07,520
trademark by registering something or

589
00:18:07,520 --> 00:18:08,880
just you know squats on one of their

590
00:18:08,880 --> 00:18:10,160
names

591
00:18:10,160 --> 00:18:11,760
we're not going to run a follow that

592
00:18:11,760 --> 00:18:13,919
because we are not going after first off

593
00:18:13,919 --> 00:18:15,919
anything in private private sector or

594
00:18:15,919 --> 00:18:17,440
you know private industry

595
00:18:17,440 --> 00:18:19,679
but second our motivations are good

596
00:18:19,679 --> 00:18:22,080
we're not doing anything wrong

597
00:18:22,080 --> 00:18:23,919
here's the intent we want to deny the

598
00:18:23,919 --> 00:18:25,120
best real estate

599
00:18:25,120 --> 00:18:27,600
to the baddies we want to bounce emails

600
00:18:27,600 --> 00:18:28,960
to make it obvious to anyone who sends

601
00:18:28,960 --> 00:18:30,400
an email that they got the wrong address

602
00:18:30,400 --> 00:18:32,000
so that they fix their stuff

603
00:18:32,000 --> 00:18:34,240
um and then we want to at the end of

604
00:18:34,240 --> 00:18:35,919
this and this is actually in progress

605
00:18:35,919 --> 00:18:36,480
now

606
00:18:36,480 --> 00:18:38,320
give these domains away to the the

607
00:18:38,320 --> 00:18:40,160
potential victims that could use them

608
00:18:40,160 --> 00:18:42,400
so if you know if there was a county

609
00:18:42,400 --> 00:18:44,160
somewhere and and one of their domains

610
00:18:44,160 --> 00:18:45,440
was one of these 42

611
00:18:45,440 --> 00:18:47,520
or where there's a look-alike i wanted

612
00:18:47,520 --> 00:18:48,960
to give them the domain and i've done

613
00:18:48,960 --> 00:18:49,280
that

614
00:18:49,280 --> 00:18:52,080
now with seven or eight counties so far

615
00:18:52,080 --> 00:18:52,880
the beauty

616
00:18:52,880 --> 00:18:55,039
of this kind of attack of this these

617
00:18:55,039 --> 00:18:57,120
look-alike domains

618
00:18:57,120 --> 00:18:58,880
there's a lot going for it first off

619
00:18:58,880 --> 00:19:00,160
it's difficult to detect

620
00:19:00,160 --> 00:19:01,840
there are companies you can pay to go

621
00:19:01,840 --> 00:19:03,120
look for these things or you can buy

622
00:19:03,120 --> 00:19:03,679
feeds

623
00:19:03,679 --> 00:19:05,600
you know newly registered domains but

624
00:19:05,600 --> 00:19:07,200
it's it's kind of tricky and you got to

625
00:19:07,200 --> 00:19:08,080
remember

626
00:19:08,080 --> 00:19:10,240
that there are 3 000 counties in the

627
00:19:10,240 --> 00:19:12,160
united states you know give or take

628
00:19:12,160 --> 00:19:13,760
and some of them don't even have it

629
00:19:13,760 --> 00:19:15,280
departments they've got an auditor's

630
00:19:15,280 --> 00:19:16,640
clerk or whatever that's doing their

631
00:19:16,640 --> 00:19:17,760
stuff and so

632
00:19:17,760 --> 00:19:19,120
they aren't going to be able to keep an

633
00:19:19,120 --> 00:19:21,360
eye out for this it can be very silent

634
00:19:21,360 --> 00:19:23,360
if you're just passively accepting email

635
00:19:23,360 --> 00:19:24,799
and accepting web traffic

636
00:19:24,799 --> 00:19:26,559
nobody may even you know see that this

637
00:19:26,559 --> 00:19:27,840
is happening

638
00:19:27,840 --> 00:19:30,080
you can also do uh meddling with the

639
00:19:30,080 --> 00:19:31,360
traffic you can do man in the middle

640
00:19:31,360 --> 00:19:33,039
attack if somebody is visiting

641
00:19:33,039 --> 00:19:35,120
the wrong website you can proxy them to

642
00:19:35,120 --> 00:19:36,880
the right one inject some javascript or

643
00:19:36,880 --> 00:19:37,760
whatever you want to do there's

644
00:19:37,760 --> 00:19:39,440
dangerous stuff that can happen

645
00:19:39,440 --> 00:19:41,679
there's a ton of intel you can get on

646
00:19:41,679 --> 00:19:43,679
this if you're a red teamer or an actual

647
00:19:43,679 --> 00:19:44,559
attacker

648
00:19:44,559 --> 00:19:46,640
if you are watching the email traffic if

649
00:19:46,640 --> 00:19:48,160
you end up in one of these email chains

650
00:19:48,160 --> 00:19:49,679
where you're cc'd

651
00:19:49,679 --> 00:19:51,760
you can you can jump right into it you

652
00:19:51,760 --> 00:19:52,880
could reply and it's going to have the

653
00:19:52,880 --> 00:19:54,559
right thread id it's going to look right

654
00:19:54,559 --> 00:19:56,400
or you can sit back and just collect the

655
00:19:56,400 --> 00:19:58,559
data you can build a beautiful dossier

656
00:19:58,559 --> 00:20:00,880
on somebody that you are after a target

657
00:20:00,880 --> 00:20:02,000
because you're going to you're going to

658
00:20:02,000 --> 00:20:03,520
see their actual email signature you can

659
00:20:03,520 --> 00:20:04,640
get phone numbers you're going to know

660
00:20:04,640 --> 00:20:06,000
who they're talking to what business

661
00:20:06,000 --> 00:20:07,280
they're doing i mean there's tons of

662
00:20:07,280 --> 00:20:09,360
intel there and you cannot use all that

663
00:20:09,360 --> 00:20:10,559
for phishing

664
00:20:10,559 --> 00:20:12,720
and you'll even know you know what the

665
00:20:12,720 --> 00:20:15,039
best topics are and you may know what a

666
00:20:15,039 --> 00:20:16,320
banner is going to look like if you're

667
00:20:16,320 --> 00:20:17,760
going to hit one of those external email

668
00:20:17,760 --> 00:20:19,039
banners

669
00:20:19,039 --> 00:20:20,799
the lifespan on this thing could be

670
00:20:20,799 --> 00:20:22,240
indefinite because if you're not

671
00:20:22,240 --> 00:20:23,919
outright breaking the law or it can't be

672
00:20:23,919 --> 00:20:25,840
proven that you are then

673
00:20:25,840 --> 00:20:27,120
you can just sit there silently with

674
00:20:27,120 --> 00:20:28,960
that domain for years and years and

675
00:20:28,960 --> 00:20:30,240
there may not be anything somebody can

676
00:20:30,240 --> 00:20:31,600
do

677
00:20:31,600 --> 00:20:34,799
so 42 domains they're set up

678
00:20:34,799 --> 00:20:36,880
first few days already there were

679
00:20:36,880 --> 00:20:38,640
results and i want to share those with

680
00:20:38,640 --> 00:20:39,360
you

681
00:20:39,360 --> 00:20:42,159
um instant results the one of the very

682
00:20:42,159 --> 00:20:44,080
first emails that i saw come across

683
00:20:44,080 --> 00:20:46,320
was from a lawyer and had a disclaimer

684
00:20:46,320 --> 00:20:47,120
at the end that said

685
00:20:47,120 --> 00:20:49,760
email is not secure a little bit of an

686
00:20:49,760 --> 00:20:51,120
understatement

687
00:20:51,120 --> 00:20:53,200
and then there were the secure emails so

688
00:20:53,200 --> 00:20:54,159
you've seen the

689
00:20:54,159 --> 00:20:57,440
zix emails in office 365 and virtru

690
00:20:57,440 --> 00:20:59,600
those were coming in and how do you

691
00:20:59,600 --> 00:21:01,440
authenticate yourself you click the link

692
00:21:01,440 --> 00:21:02,159
and say

693
00:21:02,159 --> 00:21:04,080
i own this email they send you a code

694
00:21:04,080 --> 00:21:05,520
and you're in the email so

695
00:21:05,520 --> 00:21:08,159
not very secure in that case then there

696
00:21:08,159 --> 00:21:10,080
were the zoom invites

697
00:21:10,080 --> 00:21:12,720
zoom invite after zoom in fight there

698
00:21:12,720 --> 00:21:14,480
were just so many of them you probably i

699
00:21:14,480 --> 00:21:16,400
know everybody zoomed out after 2020

700
00:21:16,400 --> 00:21:18,400
2021 here but

701
00:21:18,400 --> 00:21:19,760
anyway there were a ton of those if you

702
00:21:19,760 --> 00:21:21,280
wanted to bomb a meeting wouldn't be too

703
00:21:21,280 --> 00:21:23,120
hard to do

704
00:21:23,120 --> 00:21:25,440
invoices financial information sometimes

705
00:21:25,440 --> 00:21:26,720
there's financial information on the

706
00:21:26,720 --> 00:21:28,159
documents that we're coming across

707
00:21:28,159 --> 00:21:29,760
sometimes it's just a useful invoice

708
00:21:29,760 --> 00:21:31,760
again if you wanted to send a false

709
00:21:31,760 --> 00:21:33,360
invoice to someone you know exactly what

710
00:21:33,360 --> 00:21:34,720
it should look like and who it should go

711
00:21:34,720 --> 00:21:36,159
to

712
00:21:36,159 --> 00:21:38,320
people citizens are sending in their

713
00:21:38,320 --> 00:21:39,440
paperwork they're sending in their

714
00:21:39,440 --> 00:21:41,039
vehicle registration stuff like that

715
00:21:41,039 --> 00:21:42,840
trying to get to the department of motor

716
00:21:42,840 --> 00:21:44,960
vehicles and

717
00:21:44,960 --> 00:21:47,200
some there were just weird uh off the

718
00:21:47,200 --> 00:21:48,640
you know off the wall stuff you wouldn't

719
00:21:48,640 --> 00:21:49,600
have expected

720
00:21:49,600 --> 00:21:52,159
like um notifications about new

721
00:21:52,159 --> 00:21:54,080
toxicology reports from autopsies that

722
00:21:54,080 --> 00:21:55,520
just started pouring in because they

723
00:21:55,520 --> 00:21:57,679
were automated

724
00:21:57,679 --> 00:21:59,919
oh and and a coupon for subway so

725
00:21:59,919 --> 00:22:01,600
there's that

726
00:22:01,600 --> 00:22:03,840
is anybody doing this it was a question

727
00:22:03,840 --> 00:22:05,039
that comes up if you're looking at the

728
00:22:05,039 --> 00:22:06,320
stuff you're thinking wow an attacker

729
00:22:06,320 --> 00:22:07,360
could actually do this who

730
00:22:07,360 --> 00:22:08,799
who's actually doing this well i've got

731
00:22:08,799 --> 00:22:10,559
an example and i don't have to go very

732
00:22:10,559 --> 00:22:11,919
far because it's actually our county

733
00:22:11,919 --> 00:22:12,480
seat

734
00:22:12,480 --> 00:22:14,159
council bluffs iowa is the seat of

735
00:22:14,159 --> 00:22:15,919
pottawattamie county it's where i live

736
00:22:15,919 --> 00:22:17,120
it's where i work

737
00:22:17,120 --> 00:22:19,200
and they have a website it's a gov

738
00:22:19,200 --> 00:22:20,159
they've been on a

739
00:22:20,159 --> 00:22:22,720
dot gov for a number of years but

740
00:22:22,720 --> 00:22:25,039
somebody else has the dot-com

741
00:22:25,039 --> 00:22:27,600
who has the com and why do they have it

742
00:22:27,600 --> 00:22:29,520
what are they doing with it

743
00:22:29,520 --> 00:22:31,919
well if you look it up i looked up the

744
00:22:31,919 --> 00:22:33,520
name servers and you can see the real

745
00:22:33,520 --> 00:22:35,520
one uses a company called civic plus

746
00:22:35,520 --> 00:22:36,559
that makes sense

747
00:22:36,559 --> 00:22:39,400
uh the fake one the dot com uses

748
00:22:39,400 --> 00:22:40,960
keystonepack.com

749
00:22:40,960 --> 00:22:42,400
and the servers are bernie and hillary

750
00:22:42,400 --> 00:22:43,919
which is interesting interesting pairing

751
00:22:43,919 --> 00:22:44,799
too but

752
00:22:44,799 --> 00:22:47,400
what does that mean well if you look up

753
00:22:47,400 --> 00:22:49,440
keystonepack.com you'll find out

754
00:22:49,440 --> 00:22:52,159
that it resolves the same ip address

755
00:22:52,159 --> 00:22:52,880
they both have

756
00:22:52,880 --> 00:22:54,559
they both have mx records so they can

757
00:22:54,559 --> 00:22:56,320
receive mail uh they

758
00:22:56,320 --> 00:22:58,559
must be the same company if you look up

759
00:22:58,559 --> 00:23:00,400
that ip you'll find that it's hosted out

760
00:23:00,400 --> 00:23:01,840
of new york

761
00:23:01,840 --> 00:23:03,360
and if you go to the websites you just

762
00:23:03,360 --> 00:23:05,440
get this placeholder park domain kind of

763
00:23:05,440 --> 00:23:06,960
thing it just says this is whatever the

764
00:23:06,960 --> 00:23:08,760
domain name is

765
00:23:08,760 --> 00:23:11,600
keystonepack.com however is very similar

766
00:23:11,600 --> 00:23:13,520
to keystonepac.org which is a real

767
00:23:13,520 --> 00:23:15,679
political website so it sounds like

768
00:23:15,679 --> 00:23:18,640
their parking domains lookalike domains

769
00:23:18,640 --> 00:23:19,120
for

770
00:23:19,120 --> 00:23:23,280
political or government agencies

771
00:23:23,280 --> 00:23:25,440
dig a little deeper make an smtp

772
00:23:25,440 --> 00:23:26,480
connection and you can get

773
00:23:26,480 --> 00:23:28,880
another domain now bigfission.com you

774
00:23:28,880 --> 00:23:30,960
dig into that and it turns out to be

775
00:23:30,960 --> 00:23:34,080
a remailer in the netherlands it's been

776
00:23:34,080 --> 00:23:36,240
operating since the 90s so a little bit

777
00:23:36,240 --> 00:23:37,679
of a rabbit hole there that's as far as

778
00:23:37,679 --> 00:23:39,679
we'll go down it but somebody is

779
00:23:39,679 --> 00:23:41,120
using that.com and they could be

780
00:23:41,120 --> 00:23:42,480
receiving email because they've got mx

781
00:23:42,480 --> 00:23:43,600
records going

782
00:23:43,600 --> 00:23:45,760
i noticed at the time when i was looking

783
00:23:45,760 --> 00:23:47,360
into that that nobody had the dot org so

784
00:23:47,360 --> 00:23:49,200
i did register that and did hand it over

785
00:23:49,200 --> 00:23:50,559
to the city of council bluffs so that

786
00:23:50,559 --> 00:23:52,400
they can hang onto it for safekeeping

787
00:23:52,400 --> 00:23:53,840
they may never get that dot com back

788
00:23:53,840 --> 00:23:56,080
without they've got the dot org

789
00:23:56,080 --> 00:23:58,480
what about states our state state of

790
00:23:58,480 --> 00:23:59,120
iowa

791
00:23:59,120 --> 00:24:01,279
iowa.gov is their official domain they

792
00:24:01,279 --> 00:24:02,640
have lots of subdomains in there

793
00:24:02,640 --> 00:24:05,039
including for counties

794
00:24:05,039 --> 00:24:07,760
who has iowa.com it's parked somebody

795
00:24:07,760 --> 00:24:09,679
wants fifty thousand dollars for it

796
00:24:09,679 --> 00:24:11,520
at any point they could register or they

797
00:24:11,520 --> 00:24:12,799
could put up mx records and start

798
00:24:12,799 --> 00:24:15,840
receiving emails from peopletype.com.gov

799
00:24:15,840 --> 00:24:18,159
who has the dot org this guy named yan

800
00:24:18,159 --> 00:24:19,600
he's had it since the 90s in fact his

801
00:24:19,600 --> 00:24:21,039
website doesn't seem to have changed too

802
00:24:21,039 --> 00:24:22,559
much since the 90s which is

803
00:24:22,559 --> 00:24:25,679
cool but anyway if he wanted to he could

804
00:24:25,679 --> 00:24:27,360
start publishing mx records and stealing

805
00:24:27,360 --> 00:24:27,919
emails

806
00:24:27,919 --> 00:24:30,480
the same way anyone else could scary

807
00:24:30,480 --> 00:24:31,679
stuff

808
00:24:31,679 --> 00:24:34,080
so we're getting emails we're we're

809
00:24:34,080 --> 00:24:34,960
getting uh hits

810
00:24:34,960 --> 00:24:38,000
to uh these look-alike websites uh what

811
00:24:38,000 --> 00:24:40,640
are the results or anything useful

812
00:24:40,640 --> 00:24:42,080
well i told you a little bit about

813
00:24:42,080 --> 00:24:43,520
things seen in the first three days but

814
00:24:43,520 --> 00:24:44,080
there were

815
00:24:44,080 --> 00:24:45,840
even weirder more cringe-worthy things

816
00:24:45,840 --> 00:24:47,360
coming after that

817
00:24:47,360 --> 00:24:49,679
after a while i started seeing it looked

818
00:24:49,679 --> 00:24:51,520
like a driver's license every day or two

819
00:24:51,520 --> 00:24:53,440
people are sending their pictures their

820
00:24:53,440 --> 00:24:54,799
driver's license in

821
00:24:54,799 --> 00:24:56,640
there were all those invoices again and

822
00:24:56,640 --> 00:24:59,039
bills and quotes and all sorts of

823
00:24:59,039 --> 00:25:01,200
lovely financial information good for

824
00:25:01,200 --> 00:25:02,480
fraud use

825
00:25:02,480 --> 00:25:05,520
over over 200 pdf documents attached to

826
00:25:05,520 --> 00:25:06,720
emails that came in

827
00:25:06,720 --> 00:25:08,400
there were over 170 photos that were

828
00:25:08,400 --> 00:25:11,360
sent including those drivers licenses

829
00:25:11,360 --> 00:25:13,600
just here's a quick chart on dns but

830
00:25:13,600 --> 00:25:14,880
basically there are over 4

831
00:25:14,880 --> 00:25:17,360
000 queries against these 42 domains

832
00:25:17,360 --> 00:25:19,520
every day

833
00:25:19,520 --> 00:25:21,840
web traffic over 1300 hits every day a

834
00:25:21,840 --> 00:25:23,279
lot of those are automated but some of

835
00:25:23,279 --> 00:25:23,600
them

836
00:25:23,600 --> 00:25:26,000
are people that hit the wrong domain and

837
00:25:26,000 --> 00:25:28,000
you can control where they go i

838
00:25:28,000 --> 00:25:30,320
ended up over almost four month period

839
00:25:30,320 --> 00:25:32,240
getting 2 500 emails

840
00:25:32,240 --> 00:25:34,960
that's over 23 a day to these 42 domains

841
00:25:34,960 --> 00:25:35,520
you've got

842
00:25:35,520 --> 00:25:37,520
mail and and what if i told you there

843
00:25:37,520 --> 00:25:39,679
was some really scary stuff in there

844
00:25:39,679 --> 00:25:40,960
you know you'd believe it i mean i

845
00:25:40,960 --> 00:25:42,400
assume from what you've seen so far

846
00:25:42,400 --> 00:25:43,919
there was one email that came in that

847
00:25:43,919 --> 00:25:44,640
had

848
00:25:44,640 --> 00:25:46,080
the trifecta not just the driver's

849
00:25:46,080 --> 00:25:48,080
license but also social security card

850
00:25:48,080 --> 00:25:50,559
and a certificate of birth all in one

851
00:25:50,559 --> 00:25:51,120
email

852
00:25:51,120 --> 00:25:54,080
so that was good there's a largest uh

853
00:25:54,080 --> 00:25:55,440
large-ish

854
00:25:55,440 --> 00:25:58,559
city in california that has a credit

855
00:25:58,559 --> 00:25:59,440
card form

856
00:25:59,440 --> 00:26:01,279
they use for permitting and they said go

857
00:26:01,279 --> 00:26:03,279
ahead and email it to us with your cvv2

858
00:26:03,279 --> 00:26:06,240
and everything so that was cool

859
00:26:06,240 --> 00:26:09,200
ended up getting automated notifications

860
00:26:09,200 --> 00:26:10,480
like this one

861
00:26:10,480 --> 00:26:13,120
whenever there's a city that was buying

862
00:26:13,120 --> 00:26:14,400
water from a neighbor

863
00:26:14,400 --> 00:26:16,400
and every time that they did that their

864
00:26:16,400 --> 00:26:18,000
ics system or whatever would trigger

865
00:26:18,000 --> 00:26:19,520
this and you would get a receipt

866
00:26:19,520 --> 00:26:21,600
so that was kind of interesting to read

867
00:26:21,600 --> 00:26:23,440
or this wire transfer notice

868
00:26:23,440 --> 00:26:25,120
coming from a pretty big city in the

869
00:26:25,120 --> 00:26:27,279
midwest every time they did a wire

870
00:26:27,279 --> 00:26:28,080
transfer

871
00:26:28,080 --> 00:26:31,440
i was getting information about it

872
00:26:31,440 --> 00:26:33,679
thankfully not everything was so scary

873
00:26:33,679 --> 00:26:35,039
in fact i think the majority of the

874
00:26:35,039 --> 00:26:36,400
emails were people trying to get out of

875
00:26:36,400 --> 00:26:39,120
jury service which makes some sense

876
00:26:39,120 --> 00:26:41,200
there was a little bit of police

877
00:26:41,200 --> 00:26:42,880
intelligence involved because

878
00:26:42,880 --> 00:26:45,200
a cop at some time had gotten signed up

879
00:26:45,200 --> 00:26:46,320
on a list serve

880
00:26:46,320 --> 00:26:48,960
with the wrong address and now for years

881
00:26:48,960 --> 00:26:49,840
even though the email

882
00:26:49,840 --> 00:26:51,120
wasn't going anywhere until the domain

883
00:26:51,120 --> 00:26:53,039
was registered they were getting

884
00:26:53,039 --> 00:26:54,640
bulletins with all the latest you know

885
00:26:54,640 --> 00:26:56,880
criminal information in there so

886
00:26:56,880 --> 00:26:59,840
passwords people signing up their

887
00:26:59,840 --> 00:27:01,520
colleagues or their workers

888
00:27:01,520 --> 00:27:03,120
for different websites they put the

889
00:27:03,120 --> 00:27:04,320
wrong address in and you get their

890
00:27:04,320 --> 00:27:05,440
initial password

891
00:27:05,440 --> 00:27:07,440
also some two-factor action i'm seeing

892
00:27:07,440 --> 00:27:08,880
codes coming in when people are trying

893
00:27:08,880 --> 00:27:10,400
to log into their you know google

894
00:27:10,400 --> 00:27:13,279
accounts or apple accounts

895
00:27:13,279 --> 00:27:15,679
too long didn't read summary here this

896
00:27:15,679 --> 00:27:17,200
attack is cheap

897
00:27:17,200 --> 00:27:19,679
it's simple it's hard to stop once it

898
00:27:19,679 --> 00:27:20,480
starts and

899
00:27:20,480 --> 00:27:22,720
it works it works and it doesn't require

900
00:27:22,720 --> 00:27:24,159
a lot in terms of uh

901
00:27:24,159 --> 00:27:26,720
you know capabilities uh how do we help

902
00:27:26,720 --> 00:27:27,200
with this

903
00:27:27,200 --> 00:27:28,799
well like i said registering the domains

904
00:27:28,799 --> 00:27:30,240
is good getting the word out there and

905
00:27:30,240 --> 00:27:32,159
getting awareness up is good too and so

906
00:27:32,159 --> 00:27:33,440
i gave a talk to

907
00:27:33,440 --> 00:27:36,080
iowa counties and told them about this i

908
00:27:36,080 --> 00:27:37,520
put some other things out to

909
00:27:37,520 --> 00:27:40,720
national counties groups and i set up a

910
00:27:40,720 --> 00:27:42,279
website i made this website called

911
00:27:42,279 --> 00:27:43,520
imposter.domains

912
00:27:43,520 --> 00:27:45,120
and if you go there you can do a search

913
00:27:45,120 --> 00:27:47,279
for any domain name you want

914
00:27:47,279 --> 00:27:49,440
and you can go do this now and it will

915
00:27:49,440 --> 00:27:51,600
give you just a couple of hints as to

916
00:27:51,600 --> 00:27:54,080
what some similar domain names might

917
00:27:54,080 --> 00:27:54,720
look like

918
00:27:54,720 --> 00:27:56,000
and tell you whether they're taken or

919
00:27:56,000 --> 00:27:57,840
not and there's a frequently asked

920
00:27:57,840 --> 00:27:59,200
questions that explains how all this

921
00:27:59,200 --> 00:28:00,399
stuff works so if somebody's not

922
00:28:00,399 --> 00:28:01,679
familiar with domains that works there's

923
00:28:01,679 --> 00:28:02,159
all

924
00:28:02,159 --> 00:28:04,159
there's even a nerd mode you can turn on

925
00:28:04,159 --> 00:28:05,919
and you can see a little bit of dns

926
00:28:05,919 --> 00:28:07,520
information

927
00:28:07,520 --> 00:28:09,919
for these domains too if you want to so

928
00:28:09,919 --> 00:28:11,000
feel free to check it out

929
00:28:11,000 --> 00:28:12,799
imposter.domains

930
00:28:12,799 --> 00:28:14,480
if you spell it with an er by mistake

931
00:28:14,480 --> 00:28:15,840
that also works because it's a look like

932
00:28:15,840 --> 00:28:16,880
domain right

933
00:28:16,880 --> 00:28:18,960
anyway the results of this are the

934
00:28:18,960 --> 00:28:21,279
concepts confirmed this attack works

935
00:28:21,279 --> 00:28:22,960
everybody knew you could do it it's not

936
00:28:22,960 --> 00:28:24,799
a surprise it's nothing new

937
00:28:24,799 --> 00:28:27,039
but i'm just telling you that uh from a

938
00:28:27,039 --> 00:28:28,480
proof of concept

939
00:28:28,480 --> 00:28:31,520
it's it's f it's uh feasible it works uh

940
00:28:31,520 --> 00:28:33,120
the awareness is expanded we

941
00:28:33,120 --> 00:28:34,960
between talks and that site trying to

942
00:28:34,960 --> 00:28:36,640
get the word out so that all these local

943
00:28:36,640 --> 00:28:37,760
governments that are uh

944
00:28:37,760 --> 00:28:39,840
now moving to govs make sure that they

945
00:28:39,840 --> 00:28:41,200
protect themselves

946
00:28:41,200 --> 00:28:43,440
and we're transferring domains getting

947
00:28:43,440 --> 00:28:45,679
them out to the individuals who could

948
00:28:45,679 --> 00:28:47,200
use them so we make sure they never go

949
00:28:47,200 --> 00:28:49,520
back into circulation

950
00:28:49,520 --> 00:28:50,960
and that is it that's all the

951
00:28:50,960 --> 00:28:52,559
information i had to share with you now

952
00:28:52,559 --> 00:28:54,320
you know it's half the battle

953
00:28:54,320 --> 00:28:56,000
thanks so much for listening if you've

954
00:28:56,000 --> 00:28:57,440
got questions there's going to be q

955
00:28:57,440 --> 00:29:00,000
a on defcon's discord the links down

956
00:29:00,000 --> 00:29:00,960
there if you

957
00:29:00,960 --> 00:29:02,000
need to get in there you're probably

958
00:29:02,000 --> 00:29:05,520
already logged in thank you for that

959
00:29:05,679 --> 00:29:08,880
and that is it if you want to reach out

960
00:29:08,880 --> 00:29:10,840
my website with my contact info is

961
00:29:10,840 --> 00:29:12,320
forensic.coffee

962
00:29:12,320 --> 00:29:13,919
and i really appreciate you listening

963
00:29:13,919 --> 00:29:15,520
and thanks so much recon village for

964
00:29:15,520 --> 00:29:27,840
giving me a chance to take part

965
00:29:32,720 --> 00:29:49,780
[Music]

966
00:29:50,399 --> 00:29:52,479
you

