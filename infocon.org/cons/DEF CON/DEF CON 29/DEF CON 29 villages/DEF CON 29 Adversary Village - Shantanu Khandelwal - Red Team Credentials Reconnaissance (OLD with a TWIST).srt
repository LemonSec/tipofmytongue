1
00:00:00,160 --> 00:00:04,799
hello everyone

2
00:00:01,680 --> 00:00:06,640
welcome to the talk red team credentials

3
00:00:04,799 --> 00:00:10,400
old with a twist

4
00:00:06,640 --> 00:00:13,440
this talk is presented in defcon 29

5
00:00:10,400 --> 00:00:13,440
adversary village

6
00:00:13,840 --> 00:00:18,080
about me

7
00:00:15,440 --> 00:00:22,000
my name is shantanu khandelwal

8
00:00:18,080 --> 00:00:25,199
i am a cyber security manager at kpmg

9
00:00:22,000 --> 00:00:27,680
i enjoy working in cyber security and

10
00:00:25,199 --> 00:00:30,720
have been working in this industry for

11
00:00:27,680 --> 00:00:33,040
almost five years now

12
00:00:30,720 --> 00:00:35,600
my journey started with my master's

13
00:00:33,040 --> 00:00:36,719
degree in cyber security and incident

14
00:00:35,600 --> 00:00:39,600
response

15
00:00:36,719 --> 00:00:45,120
i also have some certifications like

16
00:00:39,600 --> 00:00:47,280
osep osce oscp etc

17
00:00:45,120 --> 00:00:50,960
this is my first talk at defcon so

18
00:00:47,280 --> 00:00:53,120
hopefully everything will go fine

19
00:00:50,960 --> 00:00:56,320
uh so the disclaimer here uh the

20
00:00:53,120 --> 00:01:00,079
opinions expressed in this presentation

21
00:00:56,320 --> 00:01:02,960
and on the following slides are solely

22
00:01:00,079 --> 00:01:06,000
those of the presenter that's me

23
00:01:02,960 --> 00:01:07,280
and not necessarily those of kpmg

24
00:01:06,000 --> 00:01:08,720
private limited

25
00:01:07,280 --> 00:01:10,799
kpmg

26
00:01:08,720 --> 00:01:12,799
does not guarantee the accuracy or

27
00:01:10,799 --> 00:01:15,119
reliability of the information provided

28
00:01:12,799 --> 00:01:15,119
here

29
00:01:15,439 --> 00:01:19,280
okay so that's done in this talk we are

30
00:01:18,320 --> 00:01:22,640
going

31
00:01:19,280 --> 00:01:24,400
to walk through some of the basic

32
00:01:22,640 --> 00:01:27,280
introduction of github

33
00:01:24,400 --> 00:01:28,640
a description and a small walkthrough of

34
00:01:27,280 --> 00:01:30,720
current github reconnaissance

35
00:01:28,640 --> 00:01:33,360
methodologies

36
00:01:30,720 --> 00:01:36,159
we will also discuss some drawbacks of

37
00:01:33,360 --> 00:01:38,560
these methodologies

38
00:01:36,159 --> 00:01:42,000
then i am going to introduce a tool

39
00:01:38,560 --> 00:01:44,720
which i wrote named as credit stroller

40
00:01:42,000 --> 00:01:46,720
we'll also do a walkthrough of it

41
00:01:44,720 --> 00:01:48,960
we'll also talk about some of the future

42
00:01:46,720 --> 00:01:51,680
work that can be done to improve the

43
00:01:48,960 --> 00:01:51,680
tool as well

44
00:01:52,320 --> 00:01:57,759
so why are we here and before we

45
00:01:55,680 --> 00:02:01,119
and before we start this talk i want to

46
00:01:57,759 --> 00:02:03,119
go over the reconnaissance quickly

47
00:02:01,119 --> 00:02:05,439
and how it fits inside

48
00:02:03,119 --> 00:02:06,719
an adversary simulation or emulation

49
00:02:05,439 --> 00:02:08,879
methodology

50
00:02:06,719 --> 00:02:10,479
reconnaissance is the first step in kill

51
00:02:08,879 --> 00:02:12,720
chain as we know

52
00:02:10,479 --> 00:02:14,879
as a red teamer we often do it before

53
00:02:12,720 --> 00:02:16,640
the initial compromise phase and

54
00:02:14,879 --> 00:02:18,560
everyone in infosec keeps saying

55
00:02:16,640 --> 00:02:22,760
information gathering or reconnaissance

56
00:02:18,560 --> 00:02:22,760
is the most critical steps

57
00:02:22,879 --> 00:02:28,319
is one of the most critical steps okay

58
00:02:26,000 --> 00:02:30,480
what is reconnaissance okay

59
00:02:28,319 --> 00:02:33,360
so in generally we referred

60
00:02:30,480 --> 00:02:37,120
reconnaissance as to find emails

61
00:02:33,360 --> 00:02:39,920
subdomains ip ranges leaked passwords

62
00:02:37,120 --> 00:02:41,440
etc for the target organization in this

63
00:02:39,920 --> 00:02:45,040
talk we are going to focus on the

64
00:02:41,440 --> 00:02:48,400
sensitive data exposure by github

65
00:02:45,040 --> 00:02:51,280
so what is github as per wiki it is a

66
00:02:48,400 --> 00:02:54,800
provider of internet hosting for

67
00:02:51,280 --> 00:02:57,360
software development and version control

68
00:02:54,800 --> 00:02:58,800
using command line tool called

69
00:02:57,360 --> 00:03:01,440
git

70
00:02:58,800 --> 00:03:04,480
developers use github for storage

71
00:03:01,440 --> 00:03:08,159
sharing projects collaboration

72
00:03:04,480 --> 00:03:08,159
data transfer etc

73
00:03:10,560 --> 00:03:16,080
from an adversary's perspective github

74
00:03:13,440 --> 00:03:17,440
is a gold mine

75
00:03:16,080 --> 00:03:22,159
it is

76
00:03:17,440 --> 00:03:23,760
mass used and its mass usage makes it a

77
00:03:22,159 --> 00:03:25,850
prime target

78
00:03:23,760 --> 00:03:28,000
and developers use often

79
00:03:25,850 --> 00:03:30,159
[Music]

80
00:03:28,000 --> 00:03:32,799
and developers often use this

81
00:03:30,159 --> 00:03:35,680
often use github

82
00:03:32,799 --> 00:03:37,680
and they unknowingly commit proprietary

83
00:03:35,680 --> 00:03:40,400
source code or credentials to the github

84
00:03:37,680 --> 00:03:40,400
repository

85
00:03:42,400 --> 00:03:46,799
interesting information in repository so

86
00:03:44,480 --> 00:03:48,799
we can find several critical information

87
00:03:46,799 --> 00:03:52,080
inside github repositories like

88
00:03:48,799 --> 00:03:53,519
usernames passwords keys email addresses

89
00:03:52,080 --> 00:03:55,760
subdomains

90
00:03:53,519 --> 00:03:57,760
proprietary source code even we can also

91
00:03:55,760 --> 00:03:58,879
find software stack from there as well

92
00:03:57,760 --> 00:04:01,360
right

93
00:03:58,879 --> 00:04:02,239
in this report in this talk we are going

94
00:04:01,360 --> 00:04:05,920
to

95
00:04:02,239 --> 00:04:05,920
focus on the credentials part

96
00:04:07,280 --> 00:04:13,200
so one of the ways which we do github

97
00:04:09,760 --> 00:04:16,479
reconnaissance is manual reconnaissance

98
00:04:13,200 --> 00:04:18,639
uh searching for the company and then

99
00:04:16,479 --> 00:04:20,400
password will find stored passwords and

100
00:04:18,639 --> 00:04:22,479
configuration file

101
00:04:20,400 --> 00:04:24,560
searching for company

102
00:04:22,479 --> 00:04:26,080
connection string will find database

103
00:04:24,560 --> 00:04:28,560
credentials

104
00:04:26,080 --> 00:04:31,040
you can also look for ssh passwords

105
00:04:28,560 --> 00:04:32,080
using the keyword ssh 2 underscore auth

106
00:04:31,040 --> 00:04:34,479
right

107
00:04:32,080 --> 00:04:37,120
send keys is my personal favorite it can

108
00:04:34,479 --> 00:04:38,639
find you automation scripts used by the

109
00:04:37,120 --> 00:04:41,120
testers

110
00:04:38,639 --> 00:04:43,120
who are also sometimes not security

111
00:04:41,120 --> 00:04:45,919
savvy and commit passwords to the git

112
00:04:43,120 --> 00:04:45,919
repositories

113
00:04:47,520 --> 00:04:52,720
there are some talks which you can use

114
00:04:50,000 --> 00:04:56,560
to find sensitive information as well

115
00:04:52,720 --> 00:04:58,639
many researchers have blog posts on it

116
00:04:56,560 --> 00:05:00,800
here is one of the list

117
00:04:58,639 --> 00:05:03,840
which you can use you can find other

118
00:05:00,800 --> 00:05:06,160
lists as well

119
00:05:03,840 --> 00:05:07,199
so here is the first

120
00:05:06,160 --> 00:05:09,199
demo

121
00:05:07,199 --> 00:05:13,199
hopefully it will go well and then we

122
00:05:09,199 --> 00:05:13,199
can you know move forward from there

123
00:05:13,280 --> 00:05:19,120
so if i if i go to uh github and search

124
00:05:17,440 --> 00:05:23,000
for um

125
00:05:19,120 --> 00:05:23,000
red team dot cafe

126
00:05:26,320 --> 00:05:32,560
you can see that there is 21 results and

127
00:05:29,680 --> 00:05:33,600
there are several repositories like test

128
00:05:32,560 --> 00:05:34,520
1

129
00:05:33,600 --> 00:05:36,320
test 2

130
00:05:34,520 --> 00:05:40,160
[Music]

131
00:05:36,320 --> 00:05:42,800
domain fronts um etc okay so let's see

132
00:05:40,160 --> 00:05:47,120
if we can use a team.cafe and then the

133
00:05:42,800 --> 00:05:47,120
keyword password to look for passwords

134
00:05:47,440 --> 00:05:52,880
so if i search for passwords now we have

135
00:05:50,479 --> 00:05:56,560
come down from 21 results

136
00:05:52,880 --> 00:05:58,639
to five results okay so we see that

137
00:05:56,560 --> 00:06:00,400
you see passwords here we see some

138
00:05:58,639 --> 00:06:03,680
passwords here

139
00:06:00,400 --> 00:06:06,080
uh some form passwords here

140
00:06:03,680 --> 00:06:09,120
we also see some send keys passwords

141
00:06:06,080 --> 00:06:11,360
here in the in the automation scripts

142
00:06:09,120 --> 00:06:13,919
and we also see one of these results

143
00:06:11,360 --> 00:06:15,280
where the tindo cafe is here and then we

144
00:06:13,919 --> 00:06:17,440
also see

145
00:06:15,280 --> 00:06:19,520
a word password but of course this one

146
00:06:17,440 --> 00:06:22,080
is not related to the credentials

147
00:06:19,520 --> 00:06:22,960
because it does not lists any passwords

148
00:06:22,080 --> 00:06:24,000
right

149
00:06:22,960 --> 00:06:26,160
okay

150
00:06:24,000 --> 00:06:29,280
so this is the manual searching you can

151
00:06:26,160 --> 00:06:32,479
use password or api

152
00:06:29,280 --> 00:06:34,479
or or any other keywords which you like

153
00:06:32,479 --> 00:06:37,440
to search for

154
00:06:34,479 --> 00:06:40,160
passwords or secrets right i don't see

155
00:06:37,440 --> 00:06:42,479
any api keys being

156
00:06:40,160 --> 00:06:43,360
exposed here so

157
00:06:42,479 --> 00:06:45,199
uh

158
00:06:43,360 --> 00:06:47,680
there's none here but you cannot

159
00:06:45,199 --> 00:06:49,440
actually use other keywords here as well

160
00:06:47,680 --> 00:06:50,960
like those dogs which we mentioned

161
00:06:49,440 --> 00:06:53,280
previously

162
00:06:50,960 --> 00:06:53,280
okay

163
00:06:53,599 --> 00:06:58,160
i just want to bring your attention to

164
00:06:55,840 --> 00:07:01,440
one to one thing which i mentioned very

165
00:06:58,160 --> 00:07:03,599
briefly last time is that there are

166
00:07:01,440 --> 00:07:04,950
two three repositories which are coming

167
00:07:03,599 --> 00:07:06,160
up test one

168
00:07:04,950 --> 00:07:06,940
[Music]

169
00:07:06,160 --> 00:07:08,479
test two

170
00:07:06,940 --> 00:07:09,840
[Music]

171
00:07:08,479 --> 00:07:11,840
okay and then there are some other

172
00:07:09,840 --> 00:07:13,919
repositories as well okay so keep in

173
00:07:11,840 --> 00:07:16,720
mind these test one as says two

174
00:07:13,919 --> 00:07:19,120
repositories as these have been uploaded

175
00:07:16,720 --> 00:07:20,240
and designed to showcase you the real

176
00:07:19,120 --> 00:07:21,599
impact

177
00:07:20,240 --> 00:07:23,759
of the

178
00:07:21,599 --> 00:07:26,080
credit stroller plug-in which we

179
00:07:23,759 --> 00:07:28,400
discussed later

180
00:07:26,080 --> 00:07:30,880
so that's the end of the first manual

181
00:07:28,400 --> 00:07:34,960
reconnaissance demo

182
00:07:30,880 --> 00:07:37,280
so coming back to our slides again

183
00:07:34,960 --> 00:07:38,960
so in the manual reconnaissance we saw

184
00:07:37,280 --> 00:07:42,240
that we can find

185
00:07:38,960 --> 00:07:43,520
uh so that we can find passwords like

186
00:07:42,240 --> 00:07:45,919
here

187
00:07:43,520 --> 00:07:48,080
we see that there are uh send keys

188
00:07:45,919 --> 00:07:50,560
passwords there are web config passwords

189
00:07:48,080 --> 00:07:52,800
and then there are ftp passwords

190
00:07:50,560 --> 00:07:52,800
here

191
00:07:53,360 --> 00:07:57,840
okay

192
00:07:54,960 --> 00:07:58,879
so uh moving forward and then so

193
00:07:57,840 --> 00:08:02,400
basically

194
00:07:58,879 --> 00:08:05,520
uh a question comes to my mind that

195
00:08:02,400 --> 00:08:07,599
are we losing some of the data or are we

196
00:08:05,520 --> 00:08:09,599
getting all of these passwords which are

197
00:08:07,599 --> 00:08:10,560
leaked by our team not red team or cafe

198
00:08:09,599 --> 00:08:11,360
right

199
00:08:10,560 --> 00:08:13,520
so

200
00:08:11,360 --> 00:08:15,680
just thinking um

201
00:08:13,520 --> 00:08:18,400
how github search works is that if you

202
00:08:15,680 --> 00:08:21,280
put two keywords such as company name

203
00:08:18,400 --> 00:08:23,360
and password in the search bar

204
00:08:21,280 --> 00:08:26,639
we are actually finding

205
00:08:23,360 --> 00:08:29,599
the results in which both the keywords

206
00:08:26,639 --> 00:08:33,599
the company name and passwords

207
00:08:29,599 --> 00:08:36,080
are uh are inside so one part one file

208
00:08:33,599 --> 00:08:38,560
will have these both keywords company

209
00:08:36,080 --> 00:08:40,479
name and password okay

210
00:08:38,560 --> 00:08:42,800
there were also results

211
00:08:40,479 --> 00:08:45,040
which had just the word password but it

212
00:08:42,800 --> 00:08:47,760
contains no passwords so just keep that

213
00:08:45,040 --> 00:08:52,000
in mind okay

214
00:08:47,760 --> 00:08:54,560
okay so another approach to search for

215
00:08:52,000 --> 00:08:56,640
passwords is using automated approach

216
00:08:54,560 --> 00:08:59,200
which is for which is using the current

217
00:08:56,640 --> 00:09:00,560
tools name namely truffle hog git

218
00:08:59,200 --> 00:09:03,600
secrets

219
00:09:00,560 --> 00:09:04,399
git scan etc

220
00:09:03,600 --> 00:09:05,279
the

221
00:09:04,399 --> 00:09:07,760
uh

222
00:09:05,279 --> 00:09:08,800
the disadvantage of using these tools is

223
00:09:07,760 --> 00:09:11,680
that

224
00:09:08,800 --> 00:09:15,360
these tools will only search for the

225
00:09:11,680 --> 00:09:18,000
repositories within an organization

226
00:09:15,360 --> 00:09:20,959
for a specific user

227
00:09:18,000 --> 00:09:23,839
or in a specific repository

228
00:09:20,959 --> 00:09:27,120
why this is the case is because

229
00:09:23,839 --> 00:09:28,640
github does not currently allow you to

230
00:09:27,120 --> 00:09:32,480
search

231
00:09:28,640 --> 00:09:34,880
all of its repositories using api

232
00:09:32,480 --> 00:09:37,839
previously it was allowed

233
00:09:34,880 --> 00:09:40,320
but now it is it has been disallowed

234
00:09:37,839 --> 00:09:43,200
because of the abuse

235
00:09:40,320 --> 00:09:48,800
of searching passwords inside

236
00:09:43,200 --> 00:09:51,310
repositories using apis okay so this api

237
00:09:48,800 --> 00:09:53,440
for searching passwords or any keywords

238
00:09:51,310 --> 00:09:56,160
[Music]

239
00:09:53,440 --> 00:09:58,399
on github has been discontinued i think

240
00:09:56,160 --> 00:09:59,279
since two years now

241
00:09:58,399 --> 00:10:01,440
okay

242
00:09:59,279 --> 00:10:04,320
and why these are working is because

243
00:10:01,440 --> 00:10:05,600
github only provides searches inside an

244
00:10:04,320 --> 00:10:08,079
organization

245
00:10:05,600 --> 00:10:10,720
inside a user repositories or inside one

246
00:10:08,079 --> 00:10:13,440
specific repository

247
00:10:10,720 --> 00:10:15,279
okay so let's quickly do an automated

248
00:10:13,440 --> 00:10:18,079
reconnaissance demo

249
00:10:15,279 --> 00:10:19,680
and then we can go to our new tool which

250
00:10:18,079 --> 00:10:22,640
i have developed

251
00:10:19,680 --> 00:10:24,160
and uh look look at that as well so

252
00:10:22,640 --> 00:10:26,399
quickly let's do an automated

253
00:10:24,160 --> 00:10:30,240
reconnaissance uh demo

254
00:10:26,399 --> 00:10:33,440
so here um here i have uh

255
00:10:30,240 --> 00:10:35,680
him using truffle hog okay and in

256
00:10:33,440 --> 00:10:39,200
truffle hog we can go

257
00:10:35,680 --> 00:10:41,600
and see uh how and we can search for

258
00:10:39,200 --> 00:10:42,640
credentials here so how do

259
00:10:41,600 --> 00:10:44,640
truffle

260
00:10:42,640 --> 00:10:46,640
is

261
00:10:44,640 --> 00:10:51,360
is stressful hog

262
00:10:46,640 --> 00:10:53,760
and then if i provide the keyword regex

263
00:10:51,360 --> 00:10:55,920
and then i can go and take one

264
00:10:53,760 --> 00:10:57,920
repository so let's say i'll take test

265
00:10:55,920 --> 00:11:01,600
one

266
00:10:57,920 --> 00:11:03,680
and then i can pass in the uh argument

267
00:11:01,600 --> 00:11:05,120
and if i click enter

268
00:11:03,680 --> 00:11:06,480
it will search

269
00:11:05,120 --> 00:11:09,360
inside that

270
00:11:06,480 --> 00:11:12,240
repository and find me passwords okay

271
00:11:09,360 --> 00:11:15,600
so i can see that it has only found me

272
00:11:12,240 --> 00:11:18,560
one password here which is also not very

273
00:11:15,600 --> 00:11:19,760
visible and it only shows high entropy

274
00:11:18,560 --> 00:11:22,000
etc

275
00:11:19,760 --> 00:11:24,000
you can already see that in in the

276
00:11:22,000 --> 00:11:27,440
manual reconnaissance

277
00:11:24,000 --> 00:11:30,160
we find we found more passwords

278
00:11:27,440 --> 00:11:32,959
i may be running this tool wrong uh i'm

279
00:11:30,160 --> 00:11:35,600
not too sure but i can definitely tell

280
00:11:32,959 --> 00:11:38,640
you that i i've used many

281
00:11:35,600 --> 00:11:41,200
other tools they will never always find

282
00:11:38,640 --> 00:11:43,760
you all of these results some of some of

283
00:11:41,200 --> 00:11:47,200
them will miss something or the other

284
00:11:43,760 --> 00:11:49,200
okay so this was a very small demo of

285
00:11:47,200 --> 00:11:50,320
the current tools

286
00:11:49,200 --> 00:11:52,720
uh

287
00:11:50,320 --> 00:11:55,440
if truffle hog author is watching me

288
00:11:52,720 --> 00:11:57,839
please uh do let me know how to use this

289
00:11:55,440 --> 00:11:59,680
tool um

290
00:11:57,839 --> 00:12:00,880
but moving forward

291
00:11:59,680 --> 00:12:02,079
uh so

292
00:12:00,880 --> 00:12:04,079
um

293
00:12:02,079 --> 00:12:05,279
so we saw in automated reconnaissance

294
00:12:04,079 --> 00:12:07,600
that it

295
00:12:05,279 --> 00:12:09,760
it barely finds one

296
00:12:07,600 --> 00:12:11,600
password but even if it find all the

297
00:12:09,760 --> 00:12:14,560
passwords we have to give

298
00:12:11,600 --> 00:12:15,519
all of these repositories uh line by

299
00:12:14,560 --> 00:12:17,760
line

300
00:12:15,519 --> 00:12:19,519
uh and then it will it will become

301
00:12:17,760 --> 00:12:21,440
difficult for you to find all of these

302
00:12:19,519 --> 00:12:23,279
repositories because if you're searching

303
00:12:21,440 --> 00:12:25,440
for a very big organization you will

304
00:12:23,279 --> 00:12:27,519
have hundreds of repositories and

305
00:12:25,440 --> 00:12:29,200
providing that hundreds of repositories

306
00:12:27,519 --> 00:12:31,760
and then passing it as command line will

307
00:12:29,200 --> 00:12:34,000
actually be very difficult

308
00:12:31,760 --> 00:12:36,800
and then finding passwords like this

309
00:12:34,000 --> 00:12:38,399
which is not very highlightable as well

310
00:12:36,800 --> 00:12:42,160
uh will prove

311
00:12:38,399 --> 00:12:45,920
more will have more difficulty as well

312
00:12:42,160 --> 00:12:48,639
okay so there's so this brings us to

313
00:12:45,920 --> 00:12:50,959
credit stroller yet another github

314
00:12:48,639 --> 00:12:53,040
search too

315
00:12:50,959 --> 00:12:54,480
so credit stroller as i mentioned is

316
00:12:53,040 --> 00:12:56,480
developed by me

317
00:12:54,480 --> 00:12:59,680
it it is an automated

318
00:12:56,480 --> 00:13:02,959
reconnaissance tool it's a chrome plugin

319
00:12:59,680 --> 00:13:02,959
made in javascript

320
00:13:05,120 --> 00:13:09,920
uh so credit stroller searches for the

321
00:13:08,079 --> 00:13:12,639
company name first

322
00:13:09,920 --> 00:13:14,720
and then after the search completes it

323
00:13:12,639 --> 00:13:17,279
will actually go inside each of the

324
00:13:14,720 --> 00:13:19,920
repositories which mentions the company

325
00:13:17,279 --> 00:13:21,600
name and then it will try to search for

326
00:13:19,920 --> 00:13:24,399
the password

327
00:13:21,600 --> 00:13:26,560
inside that repository

328
00:13:24,399 --> 00:13:28,000
credstroller also allows you to do a

329
00:13:26,560 --> 00:13:30,720
reject search

330
00:13:28,000 --> 00:13:33,200
the reject search is mentioned as lucky

331
00:13:30,720 --> 00:13:33,200
results

332
00:13:33,440 --> 00:13:37,680
so why do we need credit stroller right

333
00:13:35,920 --> 00:13:40,639
so great stroller is searching for

334
00:13:37,680 --> 00:13:42,560
credentials using regex github does not

335
00:13:40,639 --> 00:13:44,399
allow you to search reject so this is

336
00:13:42,560 --> 00:13:46,639
one of the major

337
00:13:44,399 --> 00:13:50,320
advantages

338
00:13:46,639 --> 00:13:51,760
it allows search inside the repositories

339
00:13:50,320 --> 00:13:53,360
uh after

340
00:13:51,760 --> 00:13:55,519
after matching the company name and then

341
00:13:53,360 --> 00:13:56,720
you can go and search for the keywords

342
00:13:55,519 --> 00:13:59,279
it has

343
00:13:56,720 --> 00:14:01,120
two types of results all results and

344
00:13:59,279 --> 00:14:03,279
lucky results

345
00:14:01,120 --> 00:14:06,720
the lucky results are based out of

346
00:14:03,279 --> 00:14:09,519
rejects which is a customizable project

347
00:14:06,720 --> 00:14:12,639
it is very easy to deploy and does not

348
00:14:09,519 --> 00:14:16,560
need any expertise it's a chrome plugin

349
00:14:12,639 --> 00:14:18,959
so it's very easy to use as well

350
00:14:16,560 --> 00:14:21,120
both blue teams and red teams can use it

351
00:14:18,959 --> 00:14:23,839
blue teams can use it to monitor

352
00:14:21,120 --> 00:14:26,560
credentials for their organization

353
00:14:23,839 --> 00:14:28,720
while red tanks can use it to search for

354
00:14:26,560 --> 00:14:32,240
the leaked credentials

355
00:14:28,720 --> 00:14:33,600
inside very of inside many repositories

356
00:14:32,240 --> 00:14:34,880
of this

357
00:14:33,600 --> 00:14:37,839
this search is

358
00:14:34,880 --> 00:14:39,440
is in depth and it will have

359
00:14:37,839 --> 00:14:42,000
more passwords

360
00:14:39,440 --> 00:14:44,160
than just searching for two or three

361
00:14:42,000 --> 00:14:45,600
keywords

362
00:14:44,160 --> 00:14:47,600
it also has a

363
00:14:45,600 --> 00:14:49,600
advantage that it runs in background so

364
00:14:47,600 --> 00:14:51,600
once it starts you can

365
00:14:49,600 --> 00:14:54,079
actually come back at a later stage and

366
00:14:51,600 --> 00:14:56,320
see all the results this is particularly

367
00:14:54,079 --> 00:14:59,440
useful if the search results for your

368
00:14:56,320 --> 00:15:00,639
company name which you are searching are

369
00:14:59,440 --> 00:15:02,639
very

370
00:15:00,639 --> 00:15:05,519
large

371
00:15:02,639 --> 00:15:08,000
okay so how can solar work so uh so

372
00:15:05,519 --> 00:15:10,399
think of this as a browser so once you

373
00:15:08,000 --> 00:15:12,320
open your browser and use the correct

374
00:15:10,399 --> 00:15:14,880
stroller the credit stroller will search

375
00:15:12,320 --> 00:15:17,519
the github using the ui

376
00:15:14,880 --> 00:15:19,839
and it will try to get the repositories

377
00:15:17,519 --> 00:15:23,279
okay so so searching for the ui is for

378
00:15:19,839 --> 00:15:26,160
the is for the company keyword okay and

379
00:15:23,279 --> 00:15:29,120
once you once it gets the repositories

380
00:15:26,160 --> 00:15:30,959
and now the repositories are basically

381
00:15:29,120 --> 00:15:33,040
sent to the api

382
00:15:30,959 --> 00:15:34,160
to search for the keywords so this

383
00:15:33,040 --> 00:15:36,880
section

384
00:15:34,160 --> 00:15:39,199
is all for the keywords so once we get

385
00:15:36,880 --> 00:15:41,120
the repositories

386
00:15:39,199 --> 00:15:44,560
these repositories are now sent to the

387
00:15:41,120 --> 00:15:46,880
api to search for the keywords

388
00:15:44,560 --> 00:15:48,720
so the keywords are searched and once

389
00:15:46,880 --> 00:15:49,759
the keywords are searched they are all

390
00:15:48,720 --> 00:15:51,279
the

391
00:15:49,759 --> 00:15:54,000
search results

392
00:15:51,279 --> 00:15:54,959
are stored in all results okay so till

393
00:15:54,000 --> 00:15:58,240
here

394
00:15:54,959 --> 00:16:01,680
no regular expression uh regex has been

395
00:15:58,240 --> 00:16:03,759
applied so if the file contains a

396
00:16:01,680 --> 00:16:04,959
get password method

397
00:16:03,759 --> 00:16:07,440
so all

398
00:16:04,959 --> 00:16:11,440
all results will have a get password

399
00:16:07,440 --> 00:16:13,600
method in uh in its output okay

400
00:16:11,440 --> 00:16:16,000
uh after all of all of these results are

401
00:16:13,600 --> 00:16:17,120
gathered all of these results are now

402
00:16:16,000 --> 00:16:19,759
filtered

403
00:16:17,120 --> 00:16:22,000
using the rejects and then we get the

404
00:16:19,759 --> 00:16:24,720
lucky results

405
00:16:22,000 --> 00:16:27,680
so lucky results are basically

406
00:16:24,720 --> 00:16:29,519
a subset of all the results

407
00:16:27,680 --> 00:16:31,519
and it is uh

408
00:16:29,519 --> 00:16:33,920
and it is

409
00:16:31,519 --> 00:16:36,000
and it comes from

410
00:16:33,920 --> 00:16:39,120
all the results after applying the

411
00:16:36,000 --> 00:16:39,120
regular expressions

412
00:16:39,839 --> 00:16:44,399
uh so a lot of talk already let's see

413
00:16:43,199 --> 00:16:47,519
the demo

414
00:16:44,399 --> 00:16:47,519
and hope it works

415
00:16:49,199 --> 00:16:53,759
okay so let's go back to

416
00:16:51,519 --> 00:16:55,839
github again i hope everything is

417
00:16:53,759 --> 00:16:56,800
visible maybe i can increase some font

418
00:16:55,839 --> 00:16:57,839
size

419
00:16:56,800 --> 00:17:01,759
okay

420
00:16:57,839 --> 00:17:04,160
uh so if you click on the credits roller

421
00:17:01,759 --> 00:17:05,199
uh plugin which is which i've installed

422
00:17:04,160 --> 00:17:08,240
here

423
00:17:05,199 --> 00:17:09,919
uh there are many buttons here uh i'll

424
00:17:08,240 --> 00:17:12,720
go through all of these buttons here as

425
00:17:09,919 --> 00:17:15,360
well so of course submit search is for

426
00:17:12,720 --> 00:17:17,679
the searching all results are as i

427
00:17:15,360 --> 00:17:20,319
mentioned previously all of the results

428
00:17:17,679 --> 00:17:21,919
and i am feeling lucky button is for the

429
00:17:20,319 --> 00:17:23,839
lucky results

430
00:17:21,919 --> 00:17:25,679
uh you have these two buttons for

431
00:17:23,839 --> 00:17:26,640
clearing the results and the lucky

432
00:17:25,679 --> 00:17:28,880
results

433
00:17:26,640 --> 00:17:30,840
you have the save configuration and the

434
00:17:28,880 --> 00:17:33,919
load configuration as

435
00:17:30,840 --> 00:17:37,520
well uh these two fields are for the

436
00:17:33,919 --> 00:17:39,600
tokens uh i'll share with you later uh

437
00:17:37,520 --> 00:17:42,240
what these tokens are or maybe you know

438
00:17:39,600 --> 00:17:45,120
github tokens and github username

439
00:17:42,240 --> 00:17:48,640
these two buttons are basically default

440
00:17:45,120 --> 00:17:52,000
search keywords and default rejects

441
00:17:48,640 --> 00:17:53,120
uh you can modify it as per your liking

442
00:17:52,000 --> 00:17:56,000
uh

443
00:17:53,120 --> 00:17:57,280
today i've modified it to use uh only

444
00:17:56,000 --> 00:17:58,320
two keywords

445
00:17:57,280 --> 00:18:01,760
and

446
00:17:58,320 --> 00:18:05,600
and i have kept the same regex

447
00:18:01,760 --> 00:18:06,400
uh and i'll put red team cafe here

448
00:18:05,600 --> 00:18:08,160
so

449
00:18:06,400 --> 00:18:08,960
if you uh so

450
00:18:08,160 --> 00:18:11,840
what

451
00:18:08,960 --> 00:18:14,160
uh so this what this will do is it will

452
00:18:11,840 --> 00:18:15,840
search for a theme.cafe

453
00:18:14,160 --> 00:18:18,799
as a company name

454
00:18:15,840 --> 00:18:21,280
in all of the github repositories

455
00:18:18,799 --> 00:18:23,919
once it finds those repositories it will

456
00:18:21,280 --> 00:18:26,559
go and search for all these keywords

457
00:18:23,919 --> 00:18:29,520
which i have separated by comma

458
00:18:26,559 --> 00:18:32,720
and then it will uh find these keywords

459
00:18:29,520 --> 00:18:35,360
inside all of the files which we found

460
00:18:32,720 --> 00:18:38,400
uh in the repositories

461
00:18:35,360 --> 00:18:40,559
and then it will parse it with this uh

462
00:18:38,400 --> 00:18:43,280
with this rejects and see if there are

463
00:18:40,559 --> 00:18:45,600
any lucky results those lucky results

464
00:18:43,280 --> 00:18:48,400
will be saved in the

465
00:18:45,600 --> 00:18:52,160
lucky file which we can see later

466
00:18:48,400 --> 00:18:54,559
so let's quickly submit the search

467
00:18:52,160 --> 00:18:55,679
the search takes a bit of time so it

468
00:18:54,559 --> 00:18:59,120
will

469
00:18:55,679 --> 00:19:02,320
go automatically to all of the pages

470
00:18:59,120 --> 00:19:04,720
uh and then once all of the searching

471
00:19:02,320 --> 00:19:07,200
finishes it will stop so so the

472
00:19:04,720 --> 00:19:10,640
searching from the ui has stopped but

473
00:19:07,200 --> 00:19:13,039
the background mode is still working

474
00:19:10,640 --> 00:19:15,600
to see how it works and background mode

475
00:19:13,039 --> 00:19:17,840
working we can come back to the

476
00:19:15,600 --> 00:19:21,679
credits roller plug-in

477
00:19:17,840 --> 00:19:23,360
we can click on show all results so all

478
00:19:21,679 --> 00:19:26,160
results are basically as i told you

479
00:19:23,360 --> 00:19:26,960
previously all of the results

480
00:19:26,160 --> 00:19:30,000
uh

481
00:19:26,960 --> 00:19:32,000
so if there's a password word anywhere

482
00:19:30,000 --> 00:19:34,880
you can see the password here

483
00:19:32,000 --> 00:19:36,799
of course this is too much overwhelming

484
00:19:34,880 --> 00:19:38,799
and

485
00:19:36,799 --> 00:19:40,720
there are so many results here you can

486
00:19:38,799 --> 00:19:43,440
keep scrolling and these are these are

487
00:19:40,720 --> 00:19:46,400
being still added so there are so many

488
00:19:43,440 --> 00:19:48,960
results you can uh you can find so much

489
00:19:46,400 --> 00:19:50,840
data here okay

490
00:19:48,960 --> 00:19:54,240
wow okay we found some

491
00:19:50,840 --> 00:19:57,840
uh usernames and passwords here as well

492
00:19:54,240 --> 00:19:57,840
so basically as i told you uh

493
00:19:58,240 --> 00:20:02,559
all results are

494
00:19:59,919 --> 00:20:04,559
definitely all of the results which cred

495
00:20:02,559 --> 00:20:06,880
stroller can come up with

496
00:20:04,559 --> 00:20:08,240
we are also interested in the lucky

497
00:20:06,880 --> 00:20:13,360
results

498
00:20:08,240 --> 00:20:15,440
so lucky results are the results which

499
00:20:13,360 --> 00:20:18,480
are parsed and

500
00:20:15,440 --> 00:20:20,320
and you know uh are retrieved from all

501
00:20:18,480 --> 00:20:21,520
the visuals after using the regular

502
00:20:20,320 --> 00:20:24,400
expressions

503
00:20:21,520 --> 00:20:27,039
i think this one is still populating

504
00:20:24,400 --> 00:20:29,520
so let's wait for a few minutes

505
00:20:27,039 --> 00:20:32,559
and come back to it

506
00:20:29,520 --> 00:20:34,559
once all of the results are populated

507
00:20:32,559 --> 00:20:36,080
okay but you can see here in the medium

508
00:20:34,559 --> 00:20:38,320
you can see here that it has already

509
00:20:36,080 --> 00:20:40,960
populated one

510
00:20:38,320 --> 00:20:44,400
one result which has uh which was not

511
00:20:40,960 --> 00:20:47,520
popular or which was not shown to us

512
00:20:44,400 --> 00:20:49,679
in the first manual search where we

513
00:20:47,520 --> 00:20:52,159
searched for

514
00:20:49,679 --> 00:20:52,960
uh retrieve.cafe and the password so

515
00:20:52,159 --> 00:20:54,159
this

516
00:20:52,960 --> 00:20:57,120
specific

517
00:20:54,159 --> 00:20:58,320
keyword and password was not

518
00:20:57,120 --> 00:21:00,240
shown there

519
00:20:58,320 --> 00:21:03,280
okay uh

520
00:21:00,240 --> 00:21:05,679
let's see and let's hope if this is uh

521
00:21:03,280 --> 00:21:08,320
already updated

522
00:21:05,679 --> 00:21:13,559
it is not updated yet

523
00:21:08,320 --> 00:21:13,559
so let's wait for a few more minutes

524
00:21:17,679 --> 00:21:20,679
um

525
00:21:56,559 --> 00:22:00,880
now

526
00:21:58,880 --> 00:22:02,400
okay so all of the results have been

527
00:22:00,880 --> 00:22:04,480
populated now

528
00:22:02,400 --> 00:22:05,760
and we can see that it has found a lot

529
00:22:04,480 --> 00:22:08,960
of passwords

530
00:22:05,760 --> 00:22:11,039
um it has also uh it has also found some

531
00:22:08,960 --> 00:22:13,200
password which we were which we didn't

532
00:22:11,039 --> 00:22:15,200
find the last time

533
00:22:13,200 --> 00:22:18,320
like these ones okay

534
00:22:15,200 --> 00:22:20,080
and it has also fine found passwords uh

535
00:22:18,320 --> 00:22:21,360
which i didn't intend to find in the

536
00:22:20,080 --> 00:22:24,080
first place

537
00:22:21,360 --> 00:22:25,039
but okay as long as it works i'm i'm

538
00:22:24,080 --> 00:22:26,559
great

539
00:22:25,039 --> 00:22:28,480
okay so

540
00:22:26,559 --> 00:22:31,120
uh of course you can see that there are

541
00:22:28,480 --> 00:22:33,360
some false positives like these

542
00:22:31,120 --> 00:22:36,400
but this actually tells me that there is

543
00:22:33,360 --> 00:22:38,240
some automation scripts which i can

544
00:22:36,400 --> 00:22:41,679
go and see inside this specific

545
00:22:38,240 --> 00:22:43,520
repository so it is still useful i'll

546
00:22:41,679 --> 00:22:45,600
now say this is completely useful but

547
00:22:43,520 --> 00:22:48,159
this does gives me

548
00:22:45,600 --> 00:22:49,760
an idea of what may be inside this

549
00:22:48,159 --> 00:22:51,039
repository

550
00:22:49,760 --> 00:22:53,600
okay

551
00:22:51,039 --> 00:22:55,600
so we come back to the results here and

552
00:22:53,600 --> 00:22:57,200
we can see that it has found some

553
00:22:55,600 --> 00:22:59,039
passwords here

554
00:22:57,200 --> 00:23:00,640
now this password was definitely not

555
00:22:59,039 --> 00:23:03,440
found in the first

556
00:23:00,640 --> 00:23:06,400
manual search why because this specific

557
00:23:03,440 --> 00:23:09,440
file if i go to this file

558
00:23:06,400 --> 00:23:12,799
you can see that there is no mention of

559
00:23:09,440 --> 00:23:15,200
a theme.cafe okay so if there is no

560
00:23:12,799 --> 00:23:17,600
mention of the teamwork cafe the

561
00:23:15,200 --> 00:23:20,000
combined search the combined manual

562
00:23:17,600 --> 00:23:22,720
search of the team no cafe space

563
00:23:20,000 --> 00:23:24,720
password will definitely not find this

564
00:23:22,720 --> 00:23:27,280
file because there is no mention of a

565
00:23:24,720 --> 00:23:29,520
theme.cafe in this specific file

566
00:23:27,280 --> 00:23:32,240
so i can say this is the

567
00:23:29,520 --> 00:23:35,280
best scenario of why you should use

568
00:23:32,240 --> 00:23:37,919
quest stroller because crestroller is

569
00:23:35,280 --> 00:23:39,919
actually able to find these passwords

570
00:23:37,919 --> 00:23:40,880
which are hidden inside configuration

571
00:23:39,919 --> 00:23:44,000
files

572
00:23:40,880 --> 00:23:46,240
and may not have the company name inside

573
00:23:44,000 --> 00:23:47,760
those files okay

574
00:23:46,240 --> 00:23:49,600
um

575
00:23:47,760 --> 00:23:52,640
so coming back

576
00:23:49,600 --> 00:23:53,760
to the slides

577
00:23:52,640 --> 00:23:54,960
so

578
00:23:53,760 --> 00:23:56,480
as you

579
00:23:54,960 --> 00:23:59,440
can think

580
00:23:56,480 --> 00:24:00,480
this can also be abused

581
00:23:59,440 --> 00:24:03,120
for

582
00:24:00,480 --> 00:24:05,520
mass credential gathering i will not

583
00:24:03,120 --> 00:24:07,919
deep dive into that because that's that

584
00:24:05,520 --> 00:24:09,919
is something i live up leave it up to

585
00:24:07,919 --> 00:24:11,039
your imagination

586
00:24:09,919 --> 00:24:13,360
um

587
00:24:11,039 --> 00:24:17,039
if you provide right uh rejects then you

588
00:24:13,360 --> 00:24:20,000
can do anything you want from this tool

589
00:24:17,039 --> 00:24:21,279
uh for the future improvements uh

590
00:24:20,000 --> 00:24:23,200
there are some

591
00:24:21,279 --> 00:24:25,520
there are some uh github api

592
00:24:23,200 --> 00:24:29,840
restrictions which we think we should

593
00:24:25,520 --> 00:24:29,840
bypass or we should try to uh you know

594
00:24:31,279 --> 00:24:34,240
which we should you know

595
00:24:32,960 --> 00:24:37,440
overcome

596
00:24:34,240 --> 00:24:39,279
uh so that's why we were using two keys

597
00:24:37,440 --> 00:24:42,960
we can use

598
00:24:39,279 --> 00:24:46,480
many keys so as men so the more keys you

599
00:24:42,960 --> 00:24:48,799
use more faster is the search we are

600
00:24:46,480 --> 00:24:50,960
definitely thinking to add or i am

601
00:24:48,799 --> 00:24:53,760
definitely thinking to add the cron job

602
00:24:50,960 --> 00:24:56,000
functionality because this will greatly

603
00:24:53,760 --> 00:24:56,880
increase the usability of the tool so i

604
00:24:56,000 --> 00:24:58,880
can

605
00:24:56,880 --> 00:25:01,760
i can run it in the background and then

606
00:24:58,880 --> 00:25:05,200
if even and and it will keep searching

607
00:25:01,760 --> 00:25:07,440
after every one hour for for example and

608
00:25:05,200 --> 00:25:10,240
anytime there is a

609
00:25:07,440 --> 00:25:12,960
there is a credit leak i can quickly get

610
00:25:10,240 --> 00:25:14,320
a notification on my tech store

611
00:25:12,960 --> 00:25:16,640
uh

612
00:25:14,320 --> 00:25:18,080
we can have an export to csv because

613
00:25:16,640 --> 00:25:19,279
that's very

614
00:25:18,080 --> 00:25:22,400
important

615
00:25:19,279 --> 00:25:24,159
and because sometimes we need csv to you

616
00:25:22,400 --> 00:25:26,480
know show it to the management

617
00:25:24,159 --> 00:25:27,600
uh we can also think of adding more

618
00:25:26,480 --> 00:25:30,480
rejects

619
00:25:27,600 --> 00:25:32,480
so if community wants they can you know

620
00:25:30,480 --> 00:25:34,400
add more rejects and the keywords and

621
00:25:32,480 --> 00:25:36,480
then we can have multiple

622
00:25:34,400 --> 00:25:40,000
uh keywords and rejects

623
00:25:36,480 --> 00:25:40,000
for people to use in the future

624
00:25:40,880 --> 00:25:46,159
if you have any questions uh please let

625
00:25:43,600 --> 00:25:49,039
us know or please let me know using the

626
00:25:46,159 --> 00:25:49,039
difficult channel

627
00:25:49,200 --> 00:25:54,000
uh

628
00:25:50,880 --> 00:25:56,400
so that's it um thank you um you can

629
00:25:54,000 --> 00:25:57,760
contact me if you have any questions

630
00:25:56,400 --> 00:26:00,400
after this talk

631
00:25:57,760 --> 00:26:03,360
you can contact me on twitter

632
00:26:00,400 --> 00:26:06,559
uh at shantung hyundai that's my handle

633
00:26:03,360 --> 00:26:07,520
and you can also find me on my website

634
00:26:06,559 --> 00:26:10,559
um

635
00:26:07,520 --> 00:26:13,559
that's it thank you have a nice day

636
00:26:10,559 --> 00:26:13,559
bye

