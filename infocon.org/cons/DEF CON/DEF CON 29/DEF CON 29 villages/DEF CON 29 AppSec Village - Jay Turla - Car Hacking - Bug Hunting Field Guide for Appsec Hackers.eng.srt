1
00:00:00,399 --> 00:00:03,600
all right um hello guys this is my talk

2
00:00:03,600 --> 00:00:04,720
about

3
00:00:04,720 --> 00:00:07,200
car hacking plus bug hunting field guide

4
00:00:07,200 --> 00:00:07,839
for

5
00:00:07,839 --> 00:00:10,480
application security hackers uh my name

6
00:00:10,480 --> 00:00:16,079
is jay turla and i'm from bug crowd

7
00:00:16,079 --> 00:00:20,320
who am i um

8
00:00:20,480 --> 00:00:23,199
i'm also known as ship code and twitter

9
00:00:23,199 --> 00:00:24,240
and

10
00:00:24,240 --> 00:00:27,359
uh jetman and rudkon and i'm a security

11
00:00:27,359 --> 00:00:29,039
operations manager

12
00:00:29,039 --> 00:00:31,679
at the philippines or bug crowd and i'm

13
00:00:31,679 --> 00:00:32,079
also

14
00:00:32,079 --> 00:00:34,480
a root can goon or a cfp review board

15
00:00:34,480 --> 00:00:36,239
for the san conference

16
00:00:36,239 --> 00:00:38,559
which is a hacker conference in the

17
00:00:38,559 --> 00:00:39,920
philippines

18
00:00:39,920 --> 00:00:43,280
i am not the author of turtle malware

19
00:00:43,280 --> 00:00:45,520
which is a you know it's a russian

20
00:00:45,520 --> 00:00:46,480
malware

21
00:00:46,480 --> 00:00:49,760
i'm not russian i'm filipino i'm also

22
00:00:49,760 --> 00:00:50,559
one of the

23
00:00:50,559 --> 00:00:52,640
main organizers of the car hacking

24
00:00:52,640 --> 00:00:54,239
village in return and

25
00:00:54,239 --> 00:00:57,039
the philippines which is car hack

26
00:00:57,039 --> 00:01:00,960
village page as the hashtag for twitter

27
00:01:00,960 --> 00:01:04,000
i also contribute to metasploit

28
00:01:04,000 --> 00:01:07,040
for auxiliary and exploit modules but

29
00:01:07,040 --> 00:01:10,080
not much ready unlike before my

30
00:01:10,080 --> 00:01:13,840
my last auxiliary module is related to

31
00:01:13,840 --> 00:01:15,840
the hardware bridge

32
00:01:15,840 --> 00:01:18,640
which can be used for interacting with

33
00:01:18,640 --> 00:01:21,360
the canvas

34
00:01:22,400 --> 00:01:27,360
as a summary this talk will teach you

35
00:01:27,360 --> 00:01:29,759
the secrets or techniques and succeeding

36
00:01:29,759 --> 00:01:31,840
in a car hacking blog bash

37
00:01:31,840 --> 00:01:34,799
bone to own or any hacking contest that

38
00:01:34,799 --> 00:01:35,920
of course

39
00:01:35,920 --> 00:01:39,200
involves about hacking cars

40
00:01:39,200 --> 00:01:42,880
and as what you can see from the video

41
00:01:42,880 --> 00:01:46,320
it's actually a

42
00:01:46,560 --> 00:01:51,920
picture of two successful hackers that i

43
00:01:52,840 --> 00:01:54,399
know

44
00:01:54,399 --> 00:01:57,360
this is a sample

45
00:01:57,520 --> 00:02:00,320
picture from the car hacking blog bash

46
00:02:00,320 --> 00:02:01,920
sample payout

47
00:02:01,920 --> 00:02:05,200
wherein this is the total uh scoreboard

48
00:02:05,200 --> 00:02:07,680
and the total of bounties paid

49
00:02:07,680 --> 00:02:10,959
for car hacking or should i say the car

50
00:02:10,959 --> 00:02:13,840
hacking bug bash

51
00:02:14,160 --> 00:02:17,440
this is a sample clipping from cdnet and

52
00:02:17,440 --> 00:02:18,000
um

53
00:02:18,000 --> 00:02:21,200
for the pawn to own contest a tesla car

54
00:02:21,200 --> 00:02:22,239
was hacked

55
00:02:22,239 --> 00:02:25,840
at the sad contest and the duo

56
00:02:25,840 --> 00:02:28,560
uh was able to win the competition's

57
00:02:28,560 --> 00:02:29,680
overall standings

58
00:02:29,680 --> 00:02:32,560
they also get to keep the car which is a

59
00:02:32,560 --> 00:02:33,760
very good

60
00:02:33,760 --> 00:02:37,440
uh reward and

61
00:02:37,440 --> 00:02:40,239
they use the git bug in the browser

62
00:02:40,239 --> 00:02:41,599
render process

63
00:02:41,599 --> 00:02:43,519
to execute code on the car's firmware

64
00:02:43,519 --> 00:02:45,840
and show a message

65
00:02:45,840 --> 00:02:47,680
on its entertainment system or

66
00:02:47,680 --> 00:02:49,200
infotainment system

67
00:02:49,200 --> 00:02:52,400
so the duo was able to keep the car and

68
00:02:52,400 --> 00:02:54,640
they were also

69
00:02:54,640 --> 00:02:58,319
receive 35 000 us dollars

70
00:02:58,319 --> 00:03:02,480
as a bounty or a one so yep

71
00:03:02,480 --> 00:03:06,319
now how how do i start to be a

72
00:03:06,319 --> 00:03:10,080
to be a car hacker right if

73
00:03:10,080 --> 00:03:12,879
i'm an application security hacker that

74
00:03:12,879 --> 00:03:14,080
usually focuses

75
00:03:14,080 --> 00:03:17,760
on mobile application security bugs

76
00:03:17,760 --> 00:03:20,400
web applications security bugs so how do

77
00:03:20,400 --> 00:03:22,400
i get involved with car hacking

78
00:03:22,400 --> 00:03:25,040
in order to get some bounties as well

79
00:03:25,040 --> 00:03:25,920
from

80
00:03:25,920 --> 00:03:29,599
hacking cars or automobiles

81
00:03:30,080 --> 00:03:33,040
the first thing uh my favorite book of

82
00:03:33,040 --> 00:03:33,840
course

83
00:03:33,840 --> 00:03:35,920
the car hackers handbook a guide for the

84
00:03:35,920 --> 00:03:37,360
penetration tester

85
00:03:37,360 --> 00:03:39,280
written by craig smith there's a

86
00:03:39,280 --> 00:03:41,840
paperback version and ebook version

87
00:03:41,840 --> 00:03:43,920
and there's the online version rendered

88
00:03:43,920 --> 00:03:45,040
on html

89
00:03:45,040 --> 00:03:47,920
of course it's for free the one on the

90
00:03:47,920 --> 00:03:49,360
online version but if you want to buy

91
00:03:49,360 --> 00:03:50,319
the book

92
00:03:50,319 --> 00:03:53,120
there is a paperback version and there

93
00:03:53,120 --> 00:03:54,239
is also

94
00:03:54,239 --> 00:03:57,599
an ebook version i also have one

95
00:03:57,599 --> 00:04:00,959
which is the ebook version i mean i have

96
00:04:00,959 --> 00:04:02,239
two copies

97
00:04:02,239 --> 00:04:05,280
one for the ebook version and one for

98
00:04:05,280 --> 00:04:07,439
the

99
00:04:08,080 --> 00:04:10,720
paperback version which has a signature

100
00:04:10,720 --> 00:04:14,319
of craig smith

101
00:04:14,319 --> 00:04:16,478
here are some good car hacking research

102
00:04:16,478 --> 00:04:18,000
resources that

103
00:04:18,000 --> 00:04:21,358
i always you know give out to folks who

104
00:04:21,358 --> 00:04:24,000
asked me about where's where to start

105
00:04:24,000 --> 00:04:24,639
about

106
00:04:24,639 --> 00:04:26,960
hacking cars first thing first we have

107
00:04:26,960 --> 00:04:28,800
the nano can how you can

108
00:04:28,800 --> 00:04:31,919
create your low cost can sniffer

109
00:04:31,919 --> 00:04:33,759
or carbon hacking tool for just five

110
00:04:33,759 --> 00:04:36,160
dollars so

111
00:04:36,160 --> 00:04:39,680
get that github link from internet

112
00:04:39,680 --> 00:04:41,600
and then there's also getting started

113
00:04:41,600 --> 00:04:43,080
with car hacking from the car

114
00:04:43,080 --> 00:04:45,440
hackingvillage.com website

115
00:04:45,440 --> 00:04:49,520
which uh teaches you how to

116
00:04:49,520 --> 00:04:52,560
play with canutils or how to use it

117
00:04:52,560 --> 00:04:54,639
and then there's also can bus basics

118
00:04:54,639 --> 00:04:56,560
with hands-on fuzzing

119
00:04:56,560 --> 00:04:59,759
by ian sabor ian sabor is also the guy

120
00:04:59,759 --> 00:05:01,440
who made the nano can

121
00:05:01,440 --> 00:05:04,800
and he's my mentor there's also

122
00:05:04,800 --> 00:05:07,600
a curated list of awesome resources

123
00:05:07,600 --> 00:05:08,800
books

124
00:05:08,800 --> 00:05:11,919
hardware software applications uh

125
00:05:11,919 --> 00:05:14,080
people to follow and also more cool

126
00:05:14,080 --> 00:05:17,120
stuff about vehicle security car hacking

127
00:05:17,120 --> 00:05:18,880
and tinkering with the functionality of

128
00:05:18,880 --> 00:05:20,160
your car

129
00:05:20,160 --> 00:05:23,360
it's on github by jared the coder under

130
00:05:23,360 --> 00:05:26,400
awesome vehicle security there's tons of

131
00:05:26,400 --> 00:05:28,080
information there

132
00:05:28,080 --> 00:05:30,639
that you might want to follow or you

133
00:05:30,639 --> 00:05:32,320
know grab on

134
00:05:32,320 --> 00:05:35,440
there's also car hacking village videos

135
00:05:35,440 --> 00:05:38,240
uploaded especially the ones presented

136
00:05:38,240 --> 00:05:39,680
in defcon

137
00:05:39,680 --> 00:05:43,120
and of course if you are in a hacker

138
00:05:43,120 --> 00:05:44,160
conference

139
00:05:44,160 --> 00:05:46,240
i know that most of you guys here love

140
00:05:46,240 --> 00:05:47,360
the appsec village

141
00:05:47,360 --> 00:05:50,720
as well as i do um but also please don't

142
00:05:50,720 --> 00:05:52,720
forget to visit the

143
00:05:52,720 --> 00:05:55,919
visit the car hacking village which has

144
00:05:55,919 --> 00:05:56,560
you know

145
00:05:56,560 --> 00:05:58,880
if you go to carhackingvillage.com

146
00:05:58,880 --> 00:05:59,759
events

147
00:05:59,759 --> 00:06:02,240
you get to know the events um the

148
00:06:02,240 --> 00:06:04,000
nearest events or

149
00:06:04,000 --> 00:06:06,800
when is the next car hacking village

150
00:06:06,800 --> 00:06:08,000
expo

151
00:06:08,000 --> 00:06:10,800
and then the last one is of course made

152
00:06:10,800 --> 00:06:11,360
by

153
00:06:11,360 --> 00:06:14,560
techmaker ua adventures in building a

154
00:06:14,560 --> 00:06:17,360
canvas sniffer if you want to have a

155
00:06:17,360 --> 00:06:19,840
good hardware that you could start i

156
00:06:19,840 --> 00:06:22,400
mean start after building your nanogun

157
00:06:22,400 --> 00:06:25,120
you might want to build a a better

158
00:06:25,120 --> 00:06:26,400
canvas sniffer

159
00:06:26,400 --> 00:06:30,160
which i also like i have a my own

160
00:06:30,160 --> 00:06:33,600
for that and this guy the guys from

161
00:06:33,600 --> 00:06:34,800
techmaker

162
00:06:34,800 --> 00:06:38,400
gave a presentation about it

163
00:06:39,360 --> 00:06:41,199
so how did i started back in the day

164
00:06:41,199 --> 00:06:44,560
aside from the resources

165
00:06:45,120 --> 00:06:48,720
i mostly noticed that people teach

166
00:06:48,720 --> 00:06:51,199
teach car hacking in other countries

167
00:06:51,199 --> 00:06:52,240
without hardware

168
00:06:52,240 --> 00:06:55,199
and they usually focus on virtual can

169
00:06:55,199 --> 00:06:56,160
bus

170
00:06:56,160 --> 00:06:59,599
emulators there's no it's not bad if you

171
00:06:59,599 --> 00:07:00,639
try down one

172
00:07:00,639 --> 00:07:03,199
but please uh i would i would urge you

173
00:07:03,199 --> 00:07:05,440
or advise you to also pick up your own

174
00:07:05,440 --> 00:07:06,319
hardware

175
00:07:06,319 --> 00:07:08,000
uh you can buy your own instrument

176
00:07:08,000 --> 00:07:10,960
cluster which is usually 20 to 30

177
00:07:10,960 --> 00:07:12,400
dollars or

178
00:07:12,400 --> 00:07:14,639
you know if you have a car you can also

179
00:07:14,639 --> 00:07:16,319
play with your infotainment system

180
00:07:16,319 --> 00:07:18,400
i was able to play with my own

181
00:07:18,400 --> 00:07:19,680
infotainment and also

182
00:07:19,680 --> 00:07:24,240
was able to execute command execution

183
00:07:24,240 --> 00:07:27,840
via the usb flash drive and then

184
00:07:27,840 --> 00:07:30,400
from the left image you can actually see

185
00:07:30,400 --> 00:07:31,759
that

186
00:07:31,759 --> 00:07:34,080
i was able to fuzz my instrument cluster

187
00:07:34,080 --> 00:07:36,240
by sending canned messages

188
00:07:36,240 --> 00:07:38,960
on the panel using nanocan which is just

189
00:07:38,960 --> 00:07:40,319
a five dollar

190
00:07:40,319 --> 00:07:44,479
card hacking tool you only need an mcp25

191
00:07:44,479 --> 00:07:47,599
then you hook it up with an arduino nano

192
00:07:47,599 --> 00:07:51,039
so that's why it's called nano cam

193
00:07:52,240 --> 00:07:55,199
like i said there are also some

194
00:07:55,199 --> 00:07:56,960
simulators if you don't have a hardware

195
00:07:56,960 --> 00:07:58,879
yet you can

196
00:07:58,879 --> 00:08:02,080
clone the repository

197
00:08:02,080 --> 00:08:05,199
from craig smith which has

198
00:08:05,199 --> 00:08:07,840
his repository about the uds server

199
00:08:07,840 --> 00:08:08,960
which is free

200
00:08:08,960 --> 00:08:11,440
and also the instrument cluster simulat

201
00:08:11,440 --> 00:08:12,000
simulator

202
00:08:12,000 --> 00:08:15,360
which is the ic sim and if you want to

203
00:08:15,360 --> 00:08:17,680
have an easy a hardware based ecu

204
00:08:17,680 --> 00:08:18,720
simulator

205
00:08:18,720 --> 00:08:21,440
there is available in cindy but i would

206
00:08:21,440 --> 00:08:22,800
advise to

207
00:08:22,800 --> 00:08:26,000
you know to build your

208
00:08:26,000 --> 00:08:28,720
own ecu kit but if you don't have one

209
00:08:28,720 --> 00:08:30,800
you can have the ecu simulator

210
00:08:30,800 --> 00:08:33,919
available in cindy.com or other stores

211
00:08:33,919 --> 00:08:36,640
like amazon

212
00:08:38,159 --> 00:08:41,519
so my my main inspiration is the car

213
00:08:41,519 --> 00:08:43,200
hacking village really so

214
00:08:43,200 --> 00:08:46,000
uh i've learned a lot from visiting the

215
00:08:46,000 --> 00:08:47,760
car hacking village i've learned a lot

216
00:08:47,760 --> 00:08:48,480
from

217
00:08:48,480 --> 00:08:50,080
playing with some of the test benches

218
00:08:50,080 --> 00:08:52,640
that were in the venue

219
00:08:52,640 --> 00:08:55,920
i've also you know got inspired

220
00:08:55,920 --> 00:08:59,200
into not just opening a car

221
00:08:59,200 --> 00:09:01,200
but playing with a canvas network as

222
00:09:01,200 --> 00:09:03,440
well

223
00:09:04,360 --> 00:09:05,519
[Music]

224
00:09:05,519 --> 00:09:08,640
my other advice really is when you

225
00:09:08,640 --> 00:09:11,120
uh aside from the information you need

226
00:09:11,120 --> 00:09:13,519
to have practical demos or practical

227
00:09:13,519 --> 00:09:15,760
usage of the tools that you have or some

228
00:09:15,760 --> 00:09:16,880
of the

229
00:09:16,880 --> 00:09:19,120
information that you were able to read

230
00:09:19,120 --> 00:09:21,120
on the internet or the resources that i

231
00:09:21,120 --> 00:09:23,519
gave you i would advise to

232
00:09:23,519 --> 00:09:25,440
invest or acquire some tools required

233
00:09:25,440 --> 00:09:27,200
for interacting with can or other

234
00:09:27,200 --> 00:09:29,120
protocols like flex ray

235
00:09:29,120 --> 00:09:33,440
uh i bought a machina p1

236
00:09:33,519 --> 00:09:37,680
i was given by um internet with

237
00:09:37,680 --> 00:09:40,640
besides scotland badge which is actually

238
00:09:40,640 --> 00:09:41,519
a nano can

239
00:09:41,519 --> 00:09:43,920
from before i think that was like three

240
00:09:43,920 --> 00:09:45,440
or four years ago

241
00:09:45,440 --> 00:09:48,880
and then i also bought from uh

242
00:09:48,880 --> 00:09:51,519
from defcon the cantack tool and then

243
00:09:51,519 --> 00:09:54,160
the techmaker guys gave me

244
00:09:54,160 --> 00:09:58,240
the uh their own kanba sniffer

245
00:09:58,240 --> 00:10:00,160
during a car hacking bug bash uh the

246
00:10:00,160 --> 00:10:02,480
good thing about car hacking bug bash is

247
00:10:02,480 --> 00:10:05,760
aside from being able to meet car

248
00:10:05,760 --> 00:10:07,120
hackers

249
00:10:07,120 --> 00:10:10,320
you also get to you know get some free

250
00:10:10,320 --> 00:10:11,120
stuff that

251
00:10:11,120 --> 00:10:14,399
maybe they might have and then i also

252
00:10:14,399 --> 00:10:14,959
bought the

253
00:10:14,959 --> 00:10:17,600
value can four during the second to the

254
00:10:17,600 --> 00:10:19,040
last derbycon

255
00:10:19,040 --> 00:10:22,800
from car or the founder of

256
00:10:22,800 --> 00:10:25,839
the car hacking village and

257
00:10:25,839 --> 00:10:27,839
all i can say is you know you need to

258
00:10:27,839 --> 00:10:29,519
have some of your collection of can

259
00:10:29,519 --> 00:10:33,440
hacking tools

260
00:10:33,440 --> 00:10:35,680
there is also an open source uh github

261
00:10:35,680 --> 00:10:36,959
repo

262
00:10:36,959 --> 00:10:40,240
put up together by jay gamblin and

263
00:10:40,240 --> 00:10:42,959
it's called the car hacking tools it is

264
00:10:42,959 --> 00:10:44,399
a collection of scripts

265
00:10:44,399 --> 00:10:46,640
to help you jump start your car research

266
00:10:46,640 --> 00:10:47,839
and hacking

267
00:10:47,839 --> 00:10:49,600
all the scripts are designed to run on

268
00:10:49,600 --> 00:10:52,399
ubuntu debian and cali

269
00:10:52,399 --> 00:10:55,040
you can just install the repo we had a

270
00:10:55,040 --> 00:10:58,719
command line that is presented on the

271
00:10:58,839 --> 00:11:00,079
screen

272
00:11:00,079 --> 00:11:03,360
next up uh i've seen these tools

273
00:11:03,360 --> 00:11:06,240
as always in car hacking bug batches by

274
00:11:06,240 --> 00:11:08,800
the way to let you know uh my experience

275
00:11:08,800 --> 00:11:09,920
is usually on

276
00:11:09,920 --> 00:11:12,959
free edging box all right but while i'm

277
00:11:12,959 --> 00:11:14,640
there i'm also there to

278
00:11:14,640 --> 00:11:17,200
observe the car hackers and also you

279
00:11:17,200 --> 00:11:17,839
know

280
00:11:17,839 --> 00:11:20,880
play with some of the targets that are

281
00:11:20,880 --> 00:11:24,399
that are there during the bug bash so

282
00:11:24,399 --> 00:11:26,880
most of the tools these are software

283
00:11:26,880 --> 00:11:27,519
tools

284
00:11:27,519 --> 00:11:30,560
or applications uh these are the common

285
00:11:30,560 --> 00:11:31,600
enterprise tools

286
00:11:31,600 --> 00:11:33,680
that i see that were used by some of the

287
00:11:33,680 --> 00:11:34,880
car hackers

288
00:11:34,880 --> 00:11:38,240
that we have uh we have the vehicle spy

289
00:11:38,240 --> 00:11:41,279
which you can see from the left image

290
00:11:41,279 --> 00:11:42,160
and from the right

291
00:11:42,160 --> 00:11:45,680
image you can see the uh canoe

292
00:11:45,680 --> 00:11:48,880
which is also a good tool

293
00:11:48,880 --> 00:11:52,560
and then we also have uh aside from

294
00:11:52,560 --> 00:11:54,560
investing some

295
00:11:54,560 --> 00:11:57,600
you know uh can hacking tools or tools

296
00:11:57,600 --> 00:11:59,360
for car hacking you need to have some of

297
00:11:59,360 --> 00:12:01,519
your hardware hacking tools or

298
00:12:01,519 --> 00:12:03,920
network penetration tools i i even have

299
00:12:03,920 --> 00:12:06,000
my own toolbox that contains my alpha

300
00:12:06,000 --> 00:12:06,959
card

301
00:12:06,959 --> 00:12:10,720
uh some of my can sniffers my hack rf

302
00:12:10,720 --> 00:12:13,120
my wi-fi pineapple because car hacking

303
00:12:13,120 --> 00:12:13,839
is

304
00:12:13,839 --> 00:12:16,240
not just about hacking the can okay what

305
00:12:16,240 --> 00:12:17,360
if there's

306
00:12:17,360 --> 00:12:20,560
uh i um what if the car

307
00:12:20,560 --> 00:12:24,000
of course modern cars nowadays have um

308
00:12:24,000 --> 00:12:26,399
hardware that allows it to interface

309
00:12:26,399 --> 00:12:27,360
with

310
00:12:27,360 --> 00:12:29,040
the internet take for example the

311
00:12:29,040 --> 00:12:31,760
telematics unit or also the infotainment

312
00:12:31,760 --> 00:12:34,880
or entertainment system most of them

313
00:12:34,880 --> 00:12:37,519
are hookup via via bluetooth or wi-fi so

314
00:12:37,519 --> 00:12:39,680
you might want to bring your

315
00:12:39,680 --> 00:12:43,440
bluetooth hardware hacking tools or your

316
00:12:43,440 --> 00:12:47,279
wi-fi penetration tools

317
00:12:47,839 --> 00:12:51,360
okay next up we have

318
00:12:51,360 --> 00:12:56,959
the um sample ratings

319
00:13:02,240 --> 00:13:05,440
um are for that pause

320
00:13:05,440 --> 00:13:07,839
these are the sample ratings or common

321
00:13:07,839 --> 00:13:09,760
classifications

322
00:13:09,760 --> 00:13:12,240
uh which can be used as a guide for

323
00:13:12,240 --> 00:13:13,360
hunting

324
00:13:13,360 --> 00:13:16,720
common bugs and car hacking and so that

325
00:13:16,720 --> 00:13:18,880
you may be able to know

326
00:13:18,880 --> 00:13:22,560
uh what do we look for

327
00:13:23,040 --> 00:13:26,079
during the bug bash and so that you will

328
00:13:26,079 --> 00:13:27,440
be informed

329
00:13:27,440 --> 00:13:30,880
the ratings for um automotive security

330
00:13:30,880 --> 00:13:31,680
bugs like

331
00:13:31,680 --> 00:13:35,680
for example p1 is for critical

332
00:13:35,680 --> 00:13:39,760
p5 is informational p4 is low

333
00:13:39,760 --> 00:13:43,360
p3 is medium and then p2 is high

334
00:13:43,360 --> 00:13:46,399
so p1 of course you get

335
00:13:46,399 --> 00:13:49,839
the most uh highest payout if you get

336
00:13:49,839 --> 00:13:53,120
a p1 a p1 bug and it's usually

337
00:13:53,120 --> 00:13:55,920
you know 25 to 35 000 us dollars so

338
00:13:55,920 --> 00:13:56,399
imagine

339
00:13:56,399 --> 00:13:59,760
getting two p ones uh pretty much like

340
00:13:59,760 --> 00:14:00,399
you earn

341
00:14:00,399 --> 00:14:03,920
50 50 u.s dollars

342
00:14:03,920 --> 00:14:06,560
to six thousand sixty thousand us

343
00:14:06,560 --> 00:14:07,440
dollars

344
00:14:07,440 --> 00:14:09,920
and just you know for the duration of

345
00:14:09,920 --> 00:14:11,600
the car hacking bug bash

346
00:14:11,600 --> 00:14:14,839
which is pretty much like a week or five

347
00:14:14,839 --> 00:14:16,880
days

348
00:14:16,880 --> 00:14:19,600
and then maybe you have some questions

349
00:14:19,600 --> 00:14:20,399
about

350
00:14:20,399 --> 00:14:23,360
why why is there a classification what

351
00:14:23,360 --> 00:14:24,880
if i can just you know

352
00:14:24,880 --> 00:14:27,760
uh do a command execution so when we

353
00:14:27,760 --> 00:14:30,320
when you try to look on the sample vrt

354
00:14:30,320 --> 00:14:32,240
that i've also helped together with our

355
00:14:32,240 --> 00:14:34,000
client or a partner

356
00:14:34,000 --> 00:14:36,560
you can see from there that there's a p3

357
00:14:36,560 --> 00:14:37,199
wherein

358
00:14:37,199 --> 00:14:39,199
even though it's code execution it's

359
00:14:39,199 --> 00:14:40,399
only p3

360
00:14:40,399 --> 00:14:42,839
that's because there is no can bus

361
00:14:42,839 --> 00:14:46,639
private but if you can

362
00:14:47,040 --> 00:14:50,399
execute commands and be able to send

363
00:14:50,399 --> 00:14:53,519
canned messages uh through your code

364
00:14:53,519 --> 00:14:54,959
execution

365
00:14:54,959 --> 00:14:57,600
that's considered a can bus pivot which

366
00:14:57,600 --> 00:14:58,880
is p2

367
00:14:58,880 --> 00:15:03,040
so why why is it that this bug

368
00:15:03,040 --> 00:15:06,399
is rated as p3 and then

369
00:15:06,399 --> 00:15:09,120
this other bug is rated as p2 that's

370
00:15:09,120 --> 00:15:10,240
because

371
00:15:10,240 --> 00:15:13,600
we need to consider in car hacking um

372
00:15:13,600 --> 00:15:16,959
we usually rely on the terra we

373
00:15:16,959 --> 00:15:19,120
we didn't apply this before but we've

374
00:15:19,120 --> 00:15:20,480
seen that

375
00:15:20,480 --> 00:15:23,839
almost all of the automotive companies

376
00:15:23,839 --> 00:15:26,800
right now rely on tara and

377
00:15:26,800 --> 00:15:29,600
for that we usually focus on the kind of

378
00:15:29,600 --> 00:15:30,560
bug

379
00:15:30,560 --> 00:15:32,959
based on the impact of the bug uh how

380
00:15:32,959 --> 00:15:34,079
high can you go

381
00:15:34,079 --> 00:15:36,320
how high can you elevate your privileges

382
00:15:36,320 --> 00:15:38,639
is it only code execution without can

383
00:15:38,639 --> 00:15:38,959
bus

384
00:15:38,959 --> 00:15:42,079
pivot or can you send

385
00:15:42,079 --> 00:15:44,639
messages on the dirty side right and the

386
00:15:44,639 --> 00:15:45,759
exploitability

387
00:15:45,759 --> 00:15:48,560
uh what kind of exploit is it uh how far

388
00:15:48,560 --> 00:15:50,000
you can go as well

389
00:15:50,000 --> 00:15:52,399
and what are the things that you could

390
00:15:52,399 --> 00:15:54,000
do oh what is the attack

391
00:15:54,000 --> 00:15:57,120
surface what kind of proof of concept

392
00:15:57,120 --> 00:15:59,040
can you can you apply for the

393
00:15:59,040 --> 00:16:00,720
exploitability of the bug

394
00:16:00,720 --> 00:16:02,800
uh the proximity how near are you in the

395
00:16:02,800 --> 00:16:04,480
vehicle uh do you need to be connected

396
00:16:04,480 --> 00:16:05,519
to the internet

397
00:16:05,519 --> 00:16:07,040
uh do you need the vehicle to be

398
00:16:07,040 --> 00:16:08,959
connected to the gsm or

399
00:16:08,959 --> 00:16:12,000
to the radio station or the radio

400
00:16:12,000 --> 00:16:13,120
frequency

401
00:16:13,120 --> 00:16:16,800
and of course um just like any cvss

402
00:16:16,800 --> 00:16:20,000
it also relies on the cia triad

403
00:16:20,000 --> 00:16:22,440
not the mafia but it's all about

404
00:16:22,440 --> 00:16:23,680
confidentiality

405
00:16:23,680 --> 00:16:26,880
integrity and availability so

406
00:16:26,880 --> 00:16:31,439
it's pretty much like plc jpfl

407
00:16:31,839 --> 00:16:34,560
so what are the some common checklists

408
00:16:34,560 --> 00:16:35,440
that

409
00:16:35,440 --> 00:16:37,920
are submitted in the book or i mean in

410
00:16:37,920 --> 00:16:39,040
the bug

411
00:16:39,040 --> 00:16:42,160
bug bug bash event and then some common

412
00:16:42,160 --> 00:16:42,560
issue

413
00:16:42,560 --> 00:16:45,120
issues that are submitted when you say

414
00:16:45,120 --> 00:16:48,000
common issues

415
00:16:48,000 --> 00:16:50,880
these are some of the bugs that are

416
00:16:50,880 --> 00:16:52,639
submitted to us

417
00:16:52,639 --> 00:16:55,920
at first or common bugs submitted to us

418
00:16:55,920 --> 00:16:59,040
and are duplicated uh for other car

419
00:16:59,040 --> 00:16:59,680
hackers

420
00:16:59,680 --> 00:17:03,199
because you know it's really common bugs

421
00:17:03,199 --> 00:17:04,000
and it's the

422
00:17:04,000 --> 00:17:07,199
most common uh things that or

423
00:17:07,199 --> 00:17:10,480
bugs that researchers look for

424
00:17:10,480 --> 00:17:13,199
so next up

425
00:17:13,520 --> 00:17:16,480
we'll get to know about this so one one

426
00:17:16,480 --> 00:17:17,280
of the most

427
00:17:17,280 --> 00:17:19,199
common checklists or bugs that are

428
00:17:19,199 --> 00:17:20,400
submitted

429
00:17:20,400 --> 00:17:22,400
and in fact some of this could be p1 as

430
00:17:22,400 --> 00:17:25,359
well or p2 or v3

431
00:17:25,359 --> 00:17:27,679
one of this is being able to send

432
00:17:27,679 --> 00:17:28,720
messages

433
00:17:28,720 --> 00:17:31,200
from the dirty side to the clean side

434
00:17:31,200 --> 00:17:32,000
take for example

435
00:17:32,000 --> 00:17:33,700
being able to

436
00:17:33,700 --> 00:17:35,679
[Music]

437
00:17:35,679 --> 00:17:38,320
do an easy reset or airbag deployment

438
00:17:38,320 --> 00:17:40,000
via the obd2

439
00:17:40,000 --> 00:17:45,039
the infotainment the radio consoles etc

440
00:17:45,039 --> 00:17:47,600
and then are you able to inject uh

441
00:17:47,600 --> 00:17:49,520
disallowed messages in the can bus

442
00:17:49,520 --> 00:17:52,640
uh what if it's not that kind of can

443
00:17:52,640 --> 00:17:53,600
messages

444
00:17:53,600 --> 00:17:55,520
is not really allowed so if you can do

445
00:17:55,520 --> 00:17:59,120
that then it's also rewardable

446
00:17:59,360 --> 00:18:01,679
other common things for iot devices in

447
00:18:01,679 --> 00:18:02,559
the car

448
00:18:02,559 --> 00:18:04,400
are you know of course format string

449
00:18:04,400 --> 00:18:06,559
vulnerabilities to the infotainment

450
00:18:06,559 --> 00:18:09,200
to the radio head unit the bluetooth or

451
00:18:09,200 --> 00:18:12,320
the wi-fi and the radio

452
00:18:12,320 --> 00:18:14,720
and then of course because these are iot

453
00:18:14,720 --> 00:18:17,200
boxes

454
00:18:17,360 --> 00:18:21,200
you might want to check the services

455
00:18:21,200 --> 00:18:23,440
that the these boxes have or these

456
00:18:23,440 --> 00:18:25,120
computer boxes have

457
00:18:25,120 --> 00:18:27,440
um for the telematics the infotainment

458
00:18:27,440 --> 00:18:29,360
or the radiohead unit

459
00:18:29,360 --> 00:18:31,840
if you connect to your car and then you

460
00:18:31,840 --> 00:18:35,520
try to scan the ports or the services

461
00:18:35,520 --> 00:18:39,520
running maybe you can find some

462
00:18:39,679 --> 00:18:42,400
services where you can just get shell

463
00:18:42,400 --> 00:18:44,160
without authentication

464
00:18:44,160 --> 00:18:48,320
we've seen bugs like that previously

465
00:18:48,320 --> 00:18:51,760
telnet ftp ssh

466
00:18:51,760 --> 00:18:55,440
or any apis that you could

467
00:18:55,440 --> 00:18:58,559
connect to and then denial service on

468
00:18:58,559 --> 00:19:01,280
the can bus network using can bus floods

469
00:19:01,280 --> 00:19:05,280
um the common fire fire hose attack

470
00:19:05,280 --> 00:19:08,799
there are a lot of fuzzers out there

471
00:19:08,799 --> 00:19:13,120
dedicated to conducting

472
00:19:13,120 --> 00:19:15,200
their own service on the can bus there's

473
00:19:15,200 --> 00:19:17,280
also a metasploit module related to it

474
00:19:17,280 --> 00:19:18,240
or there's also

475
00:19:18,240 --> 00:19:19,919
a common bash script that i'll be

476
00:19:19,919 --> 00:19:21,600
sharing later on

477
00:19:21,600 --> 00:19:24,960
to do this kind of attack replay or

478
00:19:24,960 --> 00:19:26,400
relay

479
00:19:26,400 --> 00:19:28,320
and roll gem attacks on the key fob can

480
00:19:28,320 --> 00:19:29,520
you do this

481
00:19:29,520 --> 00:19:32,240
sometimes this kind of bug is out of

482
00:19:32,240 --> 00:19:34,880
scope or it's informational because it's

483
00:19:34,880 --> 00:19:36,480
really common

484
00:19:36,480 --> 00:19:40,080
back then but right now because of um

485
00:19:40,080 --> 00:19:42,880
you know some of these attacks are

486
00:19:42,880 --> 00:19:44,480
getting common so sometimes it's out of

487
00:19:44,480 --> 00:19:47,200
scope ready

488
00:19:47,440 --> 00:19:50,480
and then we also have ota firmware

489
00:19:50,480 --> 00:19:51,600
manipulation

490
00:19:51,600 --> 00:19:54,000
which also is related to the

491
00:19:54,000 --> 00:19:56,000
infotainment can you try to reverse

492
00:19:56,000 --> 00:19:58,320
engineer it and replace it with

493
00:19:58,320 --> 00:20:00,240
your own reverse engineered firmware

494
00:20:00,240 --> 00:20:01,840
with malicious

495
00:20:01,840 --> 00:20:06,000
information or code execution

496
00:20:06,000 --> 00:20:09,200
also have k5 cloning are you able to

497
00:20:09,200 --> 00:20:12,559
clone the k-pop then

498
00:20:12,559 --> 00:20:16,240
source code dump of the hardware

499
00:20:16,240 --> 00:20:18,480
that's also one of the common issues

500
00:20:18,480 --> 00:20:19,280
that

501
00:20:19,280 --> 00:20:23,039
researchers are submitting as well and

502
00:20:23,039 --> 00:20:26,799
you are rewarded with a pretty handsome

503
00:20:26,799 --> 00:20:31,280
reward for it it's usually p2

504
00:20:31,679 --> 00:20:34,400
of course the common bluetooth stack

505
00:20:34,400 --> 00:20:36,559
buffer overflow which could

506
00:20:36,559 --> 00:20:40,240
lead to code execution or sometimes just

507
00:20:40,240 --> 00:20:42,000
deny of service or the breaking of the

508
00:20:42,000 --> 00:20:43,760
device

509
00:20:43,760 --> 00:20:45,200
it's also rewardable the breaking of

510
00:20:45,200 --> 00:20:48,080
device of the device is usually p4 but

511
00:20:48,080 --> 00:20:49,679
if you could escalate it to code

512
00:20:49,679 --> 00:20:52,080
execution being able to

513
00:20:52,080 --> 00:20:55,280
run code on it and then being able to

514
00:20:55,280 --> 00:20:57,039
send messages from other decide and

515
00:20:57,039 --> 00:20:57,520
that's

516
00:20:57,520 --> 00:21:01,039
of course a p1

517
00:21:01,039 --> 00:21:04,080
and then uh tencent security la

518
00:21:04,080 --> 00:21:07,039
keenlab has a lot of pocs relating to

519
00:21:07,039 --> 00:21:09,360
this one

520
00:21:09,360 --> 00:21:12,400
there's also uh code execution via the

521
00:21:12,400 --> 00:21:12,880
usb

522
00:21:12,880 --> 00:21:16,080
drive the sd card or the cd drive so

523
00:21:16,080 --> 00:21:19,200
any of the attack surfaces that maybe

524
00:21:19,200 --> 00:21:20,880
your car has

525
00:21:20,880 --> 00:21:24,400
if you can do code execution via this

526
00:21:24,400 --> 00:21:31,360
input devices that's also rewardable

527
00:21:31,360 --> 00:21:34,480
and then of course uh

528
00:21:34,480 --> 00:21:37,200
the sample this is a sample for being

529
00:21:37,200 --> 00:21:38,799
able to send uh

530
00:21:38,799 --> 00:21:41,440
frames on a dirty side via the obd2 or

531
00:21:41,440 --> 00:21:43,200
the onboard diagnostics from the

532
00:21:43,200 --> 00:21:44,720
infotainment system

533
00:21:44,720 --> 00:21:48,559
or other dirty side

534
00:21:50,000 --> 00:21:54,159
the radiohead unit so if if you can then

535
00:21:54,159 --> 00:21:56,559
it might be considered as a broken off

536
00:21:56,559 --> 00:21:58,640
or secure gateway bypass

537
00:21:58,640 --> 00:22:01,120
if the car has a firewall and in fact

538
00:22:01,120 --> 00:22:04,159
some of the cars have firewall nowadays

539
00:22:04,159 --> 00:22:08,480
actually 2018 vehicles from above from

540
00:22:08,480 --> 00:22:11,520
a certain company that i can't disclose

541
00:22:11,520 --> 00:22:14,080
but of course some of you might know

542
00:22:14,080 --> 00:22:14,640
what

543
00:22:14,640 --> 00:22:17,039
what brand is this so if you can send up

544
00:22:17,039 --> 00:22:18,640
this two frames

545
00:22:18,640 --> 00:22:21,840
two frames from the cdf or seven e1 or

546
00:22:21,840 --> 00:22:22,799
any

547
00:22:22,799 --> 00:22:27,840
uh known uds messages

548
00:22:28,559 --> 00:22:31,120
if it gets successful uh the positive

549
00:22:31,120 --> 00:22:33,120
reply from the frame should be zero two

550
00:22:33,120 --> 00:22:36,400
five one zero one if you can do that

551
00:22:36,400 --> 00:22:40,000
it's rewardable so you can get a

552
00:22:40,000 --> 00:22:42,480
a reward for it which is really good as

553
00:22:42,480 --> 00:22:43,440
well

554
00:22:43,440 --> 00:22:46,400
negative responses usually starts with

555
00:22:46,400 --> 00:22:46,960
zero

556
00:22:46,960 --> 00:22:49,600
three which is negative zero two five

557
00:22:49,600 --> 00:22:52,240
one zero one that's the positive

558
00:22:52,240 --> 00:22:54,880
and as an information these two frames

559
00:22:54,880 --> 00:22:57,360
do ecu hard reset so you can

560
00:22:57,360 --> 00:23:00,240
uh do a hard reset to the ecu by sending

561
00:23:00,240 --> 00:23:00,640
to

562
00:23:00,640 --> 00:23:03,679
these two ken frames um

563
00:23:03,679 --> 00:23:06,159
even even though just one one of this

564
00:23:06,159 --> 00:23:08,000
frames from the 7df with it which

565
00:23:08,000 --> 00:23:11,440
is a common arbitration id for uds if

566
00:23:11,440 --> 00:23:13,919
you can do that then

567
00:23:13,919 --> 00:23:15,840
you should be able to do an ecu hard

568
00:23:15,840 --> 00:23:18,240
reset

569
00:23:19,039 --> 00:23:21,600
there's also some of this unauthorized

570
00:23:21,600 --> 00:23:22,640
scan access so

571
00:23:22,640 --> 00:23:26,240
if you are able to find uh twisted wires

572
00:23:26,240 --> 00:23:27,280
that you can

573
00:23:27,280 --> 00:23:30,000
sniff or send can messages and then you

574
00:23:30,000 --> 00:23:31,360
are able to open the car

575
00:23:31,360 --> 00:23:34,400
or do an ecu hard reset

576
00:23:34,400 --> 00:23:37,679
bypass for the firewall then of course

577
00:23:37,679 --> 00:23:40,159
uh that's also rewardable but take note

578
00:23:40,159 --> 00:23:41,919
of the proximity so

579
00:23:41,919 --> 00:23:44,480
uh it might have to be a p1 anymore

580
00:23:44,480 --> 00:23:45,919
because you need to rip off something

581
00:23:45,919 --> 00:23:47,039
but if the war

582
00:23:47,039 --> 00:23:49,039
is something that you could just plug

583
00:23:49,039 --> 00:23:51,520
directly on the back of the card and

584
00:23:51,520 --> 00:23:54,159
you know it varies on the proximity of

585
00:23:54,159 --> 00:23:56,559
the car

586
00:23:57,600 --> 00:24:00,799
this is a sample of a fire hose attack

587
00:24:00,799 --> 00:24:03,679
which is of course a can injection dos

588
00:24:03,679 --> 00:24:06,400
it's a bash grip and then you know send

589
00:24:06,400 --> 00:24:07,039
this

590
00:24:07,039 --> 00:24:10,400
message uh consecutively

591
00:24:10,400 --> 00:24:13,440
under arbitration id 0 0 and then with 8

592
00:24:13,440 --> 00:24:14,640
bytes of data

593
00:24:14,640 --> 00:24:18,080
so what if it works and you're able to

594
00:24:18,080 --> 00:24:19,200
dos the canvas

595
00:24:19,200 --> 00:24:22,720
that's rewardable under p4

596
00:24:23,039 --> 00:24:26,480
and then um of course just like

597
00:24:26,480 --> 00:24:29,919
attacking a web application or a net

598
00:24:29,919 --> 00:24:31,760
network

599
00:24:31,760 --> 00:24:34,240
network on your client you might want to

600
00:24:34,240 --> 00:24:35,679
do recon right

601
00:24:35,679 --> 00:24:39,679
so if you are able to uh do a recon

602
00:24:39,679 --> 00:24:43,360
you can achieve more attack so you can

603
00:24:43,360 --> 00:24:46,799
able to understand what are the possible

604
00:24:46,799 --> 00:24:48,320
attack services

605
00:24:48,320 --> 00:24:50,880
right of the scope so i would advise to

606
00:24:50,880 --> 00:24:52,240
use carrying caribou

607
00:24:52,240 --> 00:24:55,840
which is a python tool a car

608
00:24:55,840 --> 00:24:58,080
security exploration tool that i love

609
00:24:58,080 --> 00:25:00,240
and if you do if you want to do a uds

610
00:25:00,240 --> 00:25:01,200
discovery

611
00:25:01,200 --> 00:25:04,120
uh you can just uh run this tool with

612
00:25:04,120 --> 00:25:05,679
cc.py

613
00:25:05,679 --> 00:25:08,960
uds discovery so you can

614
00:25:08,960 --> 00:25:12,000
uh for this kind of module that carrying

615
00:25:12,000 --> 00:25:13,120
caribou has

616
00:25:13,120 --> 00:25:16,400
i'm actually sending diagnostic session

617
00:25:16,400 --> 00:25:18,400
control to this

618
00:25:18,400 --> 00:25:21,840
uh uds arbitration ids

619
00:25:21,840 --> 00:25:25,360
and that's what you can see

620
00:25:25,360 --> 00:25:27,520
i was able to discover on the ece

621
00:25:27,520 --> 00:25:30,919
simulator that it has 710

622
00:25:30,919 --> 00:25:34,559
7df7e0 as

623
00:25:34,559 --> 00:25:37,760
uds arbitration id and then the reply

624
00:25:37,760 --> 00:25:42,240
for the diagnostic session control is

625
00:25:42,240 --> 00:25:46,559
77a so these are the responses

626
00:25:46,559 --> 00:25:50,799
for the said arbitration ids when i send

627
00:25:50,799 --> 00:25:53,520
something on it

628
00:25:54,240 --> 00:25:56,640
there's also a couple of metasploit

629
00:25:56,640 --> 00:25:57,840
modules

630
00:25:57,840 --> 00:26:00,960
that are available

631
00:26:00,960 --> 00:26:04,240
and of course metasploit is free so

632
00:26:04,240 --> 00:26:06,720
one of them is of course for interfacing

633
00:26:06,720 --> 00:26:07,520
with

634
00:26:07,520 --> 00:26:09,679
the can network you have the hardware

635
00:26:09,679 --> 00:26:11,120
bridge server

636
00:26:11,120 --> 00:26:15,039
and then from there you have

637
00:26:15,039 --> 00:26:16,480
if you're already connected to the can

638
00:26:16,480 --> 00:26:18,480
you can launch canon flood

639
00:26:18,480 --> 00:26:23,520
you might want to do this you also have

640
00:26:23,520 --> 00:26:26,000
a module called pdt which allows you to

641
00:26:26,000 --> 00:26:27,120
check for

642
00:26:27,120 --> 00:26:29,120
and prep the pyrotechnic devices like

643
00:26:29,120 --> 00:26:30,720
the airbag so if you can

644
00:26:30,720 --> 00:26:33,840
actually do this execute this module and

645
00:26:33,840 --> 00:26:35,520
then you're on the obd2

646
00:26:35,520 --> 00:26:38,000
it's pretty much like a gateway bypass

647
00:26:38,000 --> 00:26:38,799
because you were

648
00:26:38,799 --> 00:26:41,840
able to send um messages to the dirty

649
00:26:41,840 --> 00:26:42,400
side

650
00:26:42,400 --> 00:26:44,240
to the clean side so imagine if you

651
00:26:44,240 --> 00:26:47,120
could pop up the airbags or

652
00:26:47,120 --> 00:26:48,880
the battery clumps you can do something

653
00:26:48,880 --> 00:26:50,320
to interact with it

654
00:26:50,320 --> 00:26:52,640
with just the obd2 yeah that's a bug of

655
00:26:52,640 --> 00:26:53,440
course

656
00:26:53,440 --> 00:26:56,799
and then there's also a module called

657
00:26:56,799 --> 00:27:01,440
uh malibu overheat which is a sample

658
00:27:01,440 --> 00:27:03,039
module to flood a temp gauge

659
00:27:03,039 --> 00:27:06,559
on a 2000 2006 malibu and what if

660
00:27:06,559 --> 00:27:09,919
this kind um this kind of

661
00:27:09,919 --> 00:27:13,679
module also affects other cars so

662
00:27:13,679 --> 00:27:15,919
and then cause a denial of service

663
00:27:15,919 --> 00:27:17,600
that's also rewardable

664
00:27:17,600 --> 00:27:20,399
then there's also identified modules for

665
00:27:20,399 --> 00:27:21,600
scanning the can bus

666
00:27:21,600 --> 00:27:25,039
for diagnostic modules then there's also

667
00:27:25,039 --> 00:27:26,720
a module for getting the vehicle

668
00:27:26,720 --> 00:27:28,559
information just as the bin

669
00:27:28,559 --> 00:27:30,640
from the target module and then of

670
00:27:30,640 --> 00:27:31,919
course

671
00:27:31,919 --> 00:27:33,600
a module that allows you to probe

672
00:27:33,600 --> 00:27:37,279
different data points in a can packet

673
00:27:38,320 --> 00:27:41,360
this is a menace button action and i'm

674
00:27:41,360 --> 00:27:42,960
connected to the hardware bridge

675
00:27:42,960 --> 00:27:46,559
i was able to execute the auxiliary

676
00:27:46,559 --> 00:27:50,240
module for the can flood targeting the

677
00:27:50,240 --> 00:27:51,600
uh

678
00:27:51,600 --> 00:27:55,200
virtual can zero just as a poc

679
00:27:55,200 --> 00:27:59,360
and you know it executed the module

680
00:27:59,360 --> 00:28:03,200
and i tried to dump

681
00:28:03,200 --> 00:28:06,320
on the virtual can network and

682
00:28:06,320 --> 00:28:09,919
i see tons of arbitration ids that were

683
00:28:09,919 --> 00:28:10,799
sent

684
00:28:10,799 --> 00:28:14,480
together with their data so

685
00:28:14,480 --> 00:28:17,520
if if you want to practice with the

686
00:28:17,520 --> 00:28:18,559
hardware bridge

687
00:28:18,559 --> 00:28:21,520
uh metasploit modules you can do so with

688
00:28:21,520 --> 00:28:22,159
just

689
00:28:22,159 --> 00:28:26,159
you know um snipping your virtual can

690
00:28:26,159 --> 00:28:26,880
bus

691
00:28:26,880 --> 00:28:28,960
and then targeting the virtual canvas

692
00:28:28,960 --> 00:28:30,559
with the metal switch modules already

693
00:28:30,559 --> 00:28:33,039
available

694
00:28:35,760 --> 00:28:38,559
there's also a good hardware hacking

695
00:28:38,559 --> 00:28:39,600
cheat sheet

696
00:28:39,600 --> 00:28:44,559
by m aaron magesh from payattu labs

697
00:28:44,559 --> 00:28:47,679
this is also very useful when you know

698
00:28:47,679 --> 00:28:49,440
you have test benches that you can

699
00:28:49,440 --> 00:28:50,640
actually rip off

700
00:28:50,640 --> 00:28:53,039
during the car hacking block bash and

701
00:28:53,039 --> 00:28:53,840
you know

702
00:28:53,840 --> 00:28:56,159
especially getting with the ui rt uh

703
00:28:56,159 --> 00:28:56,880
uart

704
00:28:56,880 --> 00:29:00,080
shell uh the open cd and some debug

705
00:29:00,080 --> 00:29:03,200
debuggers so this is some of the this is

706
00:29:03,200 --> 00:29:06,080
really a good guide

707
00:29:06,080 --> 00:29:10,559
and there's also a good uh reference

708
00:29:10,559 --> 00:29:12,240
pretty much like iot hacking on an

709
00:29:12,240 --> 00:29:15,919
infotainment so there's a

710
00:29:15,919 --> 00:29:18,880
there's a good link for massdepweeks.com

711
00:29:18,880 --> 00:29:19,840
serial

712
00:29:19,840 --> 00:29:21,279
i actually have this kind of

713
00:29:21,279 --> 00:29:23,360
infotainment so that's why i

714
00:29:23,360 --> 00:29:26,559
i just you know posted this as a slide

715
00:29:26,559 --> 00:29:27,919
as well

716
00:29:27,919 --> 00:29:32,240
and i was able to get the urt shell

717
00:29:32,880 --> 00:29:37,120
for the shell i mean so

718
00:29:37,120 --> 00:29:39,120
there are some misconceptions that car

719
00:29:39,120 --> 00:29:41,120
hacking is just for car hackers

720
00:29:41,120 --> 00:29:44,320
it's actually not the case okay that's

721
00:29:44,320 --> 00:29:46,080
actually not true

722
00:29:46,080 --> 00:29:48,880
it's not just about iot even hacking

723
00:29:48,880 --> 00:29:50,960
it's not just about hardware hacking

724
00:29:50,960 --> 00:29:53,600
it's not just about radio it's not just

725
00:29:53,600 --> 00:29:55,520
about flex ray hacking it's not just

726
00:29:55,520 --> 00:29:57,200
about canvas attacks

727
00:29:57,200 --> 00:29:59,279
um the sample can bus attacks that i've

728
00:29:59,279 --> 00:30:00,559
actually uh

729
00:30:00,559 --> 00:30:03,120
you know presented a while ago some of

730
00:30:03,120 --> 00:30:03,840
the mess

731
00:30:03,840 --> 00:30:06,080
images that you were able to see as a

732
00:30:06,080 --> 00:30:09,200
proof of concept

733
00:30:09,200 --> 00:30:11,919
it's not just about that web and mobile

734
00:30:11,919 --> 00:30:13,200
hacking

735
00:30:13,200 --> 00:30:16,799
skills are also essential skills

736
00:30:16,799 --> 00:30:19,520
there are android and io ios apps

737
00:30:19,520 --> 00:30:20,080
connected

738
00:30:20,080 --> 00:30:22,080
through telemetry or for interfacing

739
00:30:22,080 --> 00:30:23,279
with the info

740
00:30:23,279 --> 00:30:25,919
infotainment or entertainment system

741
00:30:25,919 --> 00:30:26,559
there are

742
00:30:26,559 --> 00:30:28,880
also update servers when you try to

743
00:30:28,880 --> 00:30:30,559
update your infotainment

744
00:30:30,559 --> 00:30:34,720
or some of the telematics in your unit

745
00:30:34,720 --> 00:30:36,480
so there's firmware updates and maybe

746
00:30:36,480 --> 00:30:37,919
you could try to sniff

747
00:30:37,919 --> 00:30:41,919
or you know perform sql injection

748
00:30:41,919 --> 00:30:45,679
or buzzing on the web

749
00:30:46,720 --> 00:30:50,159
the most common thoughts here are are

750
00:30:50,159 --> 00:30:53,360
how connected is your car does it have

751
00:30:53,360 --> 00:30:55,919
api endpoints so you need to do a recon

752
00:30:55,919 --> 00:30:57,519
and identify

753
00:30:57,519 --> 00:30:59,919
attack services that have web servers

754
00:30:59,919 --> 00:31:01,279
and apis

755
00:31:01,279 --> 00:31:04,080
and all what's top 10 is your friend for

756
00:31:04,080 --> 00:31:06,320
this

757
00:31:06,640 --> 00:31:08,880
web hacking essential skills uh take for

758
00:31:08,880 --> 00:31:11,120
example the os top 10 vulnerabilities

759
00:31:11,120 --> 00:31:15,200
like i said does it have api server

760
00:31:15,200 --> 00:31:17,679
is your car running on a web server so

761
00:31:17,679 --> 00:31:19,919
you might want to try the os top 10

762
00:31:19,919 --> 00:31:21,279
checklist for that

763
00:31:21,279 --> 00:31:25,200
and then burp and os zap is a friend

764
00:31:25,200 --> 00:31:28,159
um you just need to intercept the

765
00:31:28,159 --> 00:31:30,399
request from the mobile app as well if

766
00:31:30,399 --> 00:31:32,640
you have a mobile app and then

767
00:31:32,640 --> 00:31:34,559
you need to check on the update servers

768
00:31:34,559 --> 00:31:36,399
and the pki bridge

769
00:31:36,399 --> 00:31:39,360
i would highly recommend although this

770
00:31:39,360 --> 00:31:41,360
is not related to car hacking

771
00:31:41,360 --> 00:31:45,519
the sqli py burp extension

772
00:31:45,519 --> 00:31:48,960
which allows you to interact with

773
00:31:48,960 --> 00:31:53,360
the sql map api to your birth so

774
00:31:53,360 --> 00:31:56,799
like i said web hacking is an essential

775
00:31:56,799 --> 00:31:58,240
skill so you need to check

776
00:31:58,240 --> 00:31:59,840
if you can manipulate some vehicle

777
00:31:59,840 --> 00:32:02,240
functions with some of the unprotected

778
00:32:02,240 --> 00:32:03,840
apis that maybe your

779
00:32:03,840 --> 00:32:07,200
car is hanging is connecting to or

780
00:32:07,200 --> 00:32:09,600
running

781
00:32:10,240 --> 00:32:12,000
mobile hacking is also an essential

782
00:32:12,000 --> 00:32:15,279
skill um you might want to decompile the

783
00:32:15,279 --> 00:32:18,240
binaries the apk or the ipa

784
00:32:18,240 --> 00:32:19,679
which allows you to interface with the

785
00:32:19,679 --> 00:32:21,760
infotainment or the entertainment system

786
00:32:21,760 --> 00:32:24,960
you might want to use the

787
00:32:24,960 --> 00:32:27,279
genie motion for android emulation and

788
00:32:27,279 --> 00:32:28,000
burp proxy

789
00:32:28,000 --> 00:32:31,200
to intercept the request and then check

790
00:32:31,200 --> 00:32:33,519
for possible clear text database storage

791
00:32:33,519 --> 00:32:36,559
uh like the sqlite database and then you

792
00:32:36,559 --> 00:32:37,279
know

793
00:32:37,279 --> 00:32:39,919
check for the api host intercepted of

794
00:32:39,919 --> 00:32:41,519
course for this os

795
00:32:41,519 --> 00:32:44,640
applies and then what uh there are also

796
00:32:44,640 --> 00:32:47,360
android devices being deployed as

797
00:32:47,360 --> 00:32:49,120
entertainment system or some system

798
00:32:49,120 --> 00:32:50,559
connected to the car

799
00:32:50,559 --> 00:32:52,720
so you might want to check if you could

800
00:32:52,720 --> 00:32:54,720
execute adb shell on it

801
00:32:54,720 --> 00:32:56,960
then you can check for hard-coded api

802
00:32:56,960 --> 00:32:58,320
keys

803
00:32:58,320 --> 00:33:01,440
and it's pretty much like hacking any

804
00:33:01,440 --> 00:33:03,120
other apk files

805
00:33:03,120 --> 00:33:06,880
or you know mobile devices

806
00:33:06,880 --> 00:33:09,120
so repeat and check how the app

807
00:33:09,120 --> 00:33:11,760
interfaces with the car

808
00:33:11,760 --> 00:33:14,000
being able to understand that one that's

809
00:33:14,000 --> 00:33:15,279
a very essential

810
00:33:15,279 --> 00:33:19,360
essential skill you know

811
00:33:19,360 --> 00:33:23,679
for knowledge uh one of the examples

812
00:33:23,679 --> 00:33:26,799
why i always say this is because um one

813
00:33:26,799 --> 00:33:27,679
example is the

814
00:33:27,679 --> 00:33:30,240
nissan leaf fiasco wherein the bin was

815
00:33:30,240 --> 00:33:30,799
used for

816
00:33:30,799 --> 00:33:33,360
authorization purposes in controlling

817
00:33:33,360 --> 00:33:34,799
some of the features

818
00:33:34,799 --> 00:33:36,840
take for example the czech climate

819
00:33:36,840 --> 00:33:38,240
control

820
00:33:38,240 --> 00:33:41,200
the website is is actually reducted for

821
00:33:41,200 --> 00:33:42,240
this one

822
00:33:42,240 --> 00:33:45,519
but the vin number

823
00:33:45,519 --> 00:33:47,919
allows you to check the climate control

824
00:33:47,919 --> 00:33:49,840
and if

825
00:33:49,840 --> 00:33:51,679
you know the other vin numbers of the

826
00:33:51,679 --> 00:33:53,440
car which you can just actually

827
00:33:53,440 --> 00:33:56,720
see from behind the window

828
00:33:56,720 --> 00:33:59,200
and you know check for the vid number so

829
00:33:59,200 --> 00:34:00,559
you can control their

830
00:34:00,559 --> 00:34:04,080
check climate control or you know maybe

831
00:34:04,080 --> 00:34:06,480
control some of the vehicle features so

832
00:34:06,480 --> 00:34:07,519
the whole api

833
00:34:07,519 --> 00:34:10,560
is unauthenticated for this one and only

834
00:34:10,560 --> 00:34:12,480
required event to target the vehicle so

835
00:34:12,480 --> 00:34:13,520
any vehicles

836
00:34:13,520 --> 00:34:17,839
for the nissan leaf uh during uh before

837
00:34:17,839 --> 00:34:19,679
and i give credits to troy hunt for

838
00:34:19,679 --> 00:34:20,879
writing

839
00:34:20,879 --> 00:34:24,399
um this kind of article for controlling

840
00:34:24,399 --> 00:34:25,119
vehicles

841
00:34:25,119 --> 00:34:27,918
vehicle features of a nissan leaf so

842
00:34:27,918 --> 00:34:28,480
yeah

843
00:34:28,480 --> 00:34:31,040
it's not just about can bus attacks

844
00:34:31,040 --> 00:34:32,560
right

845
00:34:32,560 --> 00:34:35,918
mobile mobile and web hacking are also

846
00:34:35,918 --> 00:34:38,799
essential skills

847
00:34:39,119 --> 00:34:41,440
so right all right what if during the

848
00:34:41,440 --> 00:34:42,639
event right now

849
00:34:42,639 --> 00:34:45,839
what if you were uh you're in the bug

850
00:34:45,839 --> 00:34:46,719
bash right now

851
00:34:46,719 --> 00:34:49,440
what's next it's already day zero or day

852
00:34:49,440 --> 00:34:50,239
one

853
00:34:50,239 --> 00:34:53,440
so first you need to read the program

854
00:34:53,440 --> 00:34:55,520
brief or rules in a blog bash

855
00:34:55,520 --> 00:34:59,520
uh take note because um

856
00:34:59,520 --> 00:35:01,760
you need to get to know the scope of the

857
00:35:01,760 --> 00:35:03,280
program and the exclusions of the

858
00:35:03,280 --> 00:35:04,160
program

859
00:35:04,160 --> 00:35:07,119
uh one of the most exclusions there are

860
00:35:07,119 --> 00:35:08,640
the kind of bugs that will be reported

861
00:35:08,640 --> 00:35:10,400
that should not be reported take for

862
00:35:10,400 --> 00:35:11,119
example

863
00:35:11,119 --> 00:35:14,320
uh jps spoofing uh does vs

864
00:35:14,320 --> 00:35:17,599
via can injection so

865
00:35:17,599 --> 00:35:21,200
those are actually uh

866
00:35:21,200 --> 00:35:22,880
you know some of the things that you

867
00:35:22,880 --> 00:35:26,079
might not want to report

868
00:35:27,119 --> 00:35:29,040
and then you need to check on what

869
00:35:29,040 --> 00:35:30,640
security bugs

870
00:35:30,640 --> 00:35:33,680
are of interest to the program so

871
00:35:33,680 --> 00:35:36,079
you might want to check if they really

872
00:35:36,079 --> 00:35:37,920
want to check on the authentication or

873
00:35:37,920 --> 00:35:38,880
firewall bar

874
00:35:38,880 --> 00:35:42,960
firewall bypass can injection attacks

875
00:35:42,960 --> 00:35:45,839
code execution and then what can

876
00:35:45,839 --> 00:35:47,440
messages can you send from the dirty

877
00:35:47,440 --> 00:35:48,560
side so

878
00:35:48,560 --> 00:35:51,599
there are also it's also possible that

879
00:35:51,599 --> 00:35:53,920
in the program brief you can see some of

880
00:35:53,920 --> 00:35:55,440
the known issues that were reported

881
00:35:55,440 --> 00:35:57,200
before and maybe you can find

882
00:35:57,200 --> 00:36:00,480
some bypasses for it

883
00:36:00,800 --> 00:36:03,280
next is do you have any more questions

884
00:36:03,280 --> 00:36:04,320
regarding

885
00:36:04,320 --> 00:36:07,280
the scope or you know you have any

886
00:36:07,280 --> 00:36:08,240
questions regarding

887
00:36:08,240 --> 00:36:11,680
the target vehicles you can probably ask

888
00:36:11,680 --> 00:36:13,200
the program owners

889
00:36:13,200 --> 00:36:16,320
for dbc files which are proprietary

890
00:36:16,320 --> 00:36:18,160
format that describes the data over a

891
00:36:18,160 --> 00:36:19,280
can bus

892
00:36:19,280 --> 00:36:22,160
then maybe you might want to to get the

893
00:36:22,160 --> 00:36:23,440
known issues from before

894
00:36:23,440 --> 00:36:25,599
if it's not set in the program brief and

895
00:36:25,599 --> 00:36:26,880
of course

896
00:36:26,880 --> 00:36:29,359
the vehicle network architecture and

897
00:36:29,359 --> 00:36:30,640
from there

898
00:36:30,640 --> 00:36:34,400
hack the planet so do you have friends

899
00:36:34,400 --> 00:36:36,560
in the event do you know someone

900
00:36:36,560 --> 00:36:40,480
who who you met online from twitter um

901
00:36:40,480 --> 00:36:42,560
or you met them during any other car

902
00:36:42,560 --> 00:36:44,000
hacking conference and you know that

903
00:36:44,000 --> 00:36:45,119
this guy has

904
00:36:45,119 --> 00:36:47,599
a talent same as you or maybe this guy

905
00:36:47,599 --> 00:36:48,960
could help you with some of the tools

906
00:36:48,960 --> 00:36:50,000
that you have

907
00:36:50,000 --> 00:36:52,800
so how about you team up or collaborate

908
00:36:52,800 --> 00:36:54,960
and i've seen a lot of car hackers who

909
00:36:54,960 --> 00:36:55,920
have succeeded by

910
00:36:55,920 --> 00:36:59,760
doing so so there was this uh

911
00:36:59,760 --> 00:37:02,079
one hacker wherein he doesn't have this

912
00:37:02,079 --> 00:37:03,839
kind of tool

913
00:37:03,839 --> 00:37:06,880
and then so he team up with that guy

914
00:37:06,880 --> 00:37:09,760
and they work on together and they were

915
00:37:09,760 --> 00:37:10,960
able to

916
00:37:10,960 --> 00:37:15,280
open something from the car right

917
00:37:15,280 --> 00:37:17,920
they were rewarded with 25 000 us

918
00:37:17,920 --> 00:37:19,520
dollars for that

919
00:37:19,520 --> 00:37:23,040
okay so yeah like i said uh it's all

920
00:37:23,040 --> 00:37:24,640
about collaboration

921
00:37:24,640 --> 00:37:27,920
or helping each other okay

922
00:37:27,920 --> 00:37:30,400
if you want to chain about together then

923
00:37:30,400 --> 00:37:31,280
yeah

924
00:37:31,280 --> 00:37:36,800
team collaboration is great so

925
00:37:36,800 --> 00:37:39,520
next up is red you already found a bug

926
00:37:39,520 --> 00:37:41,680
so how do you write a good report

927
00:37:41,680 --> 00:37:43,680
so you need to write clear reproduction

928
00:37:43,680 --> 00:37:45,280
steps

929
00:37:45,280 --> 00:37:47,359
here's a sample so you need to describe

930
00:37:47,359 --> 00:37:49,599
what is the vulnerability

931
00:37:49,599 --> 00:37:52,079
sample the infotainment is vulnerable to

932
00:37:52,079 --> 00:37:52,880
a dos brick

933
00:37:52,880 --> 00:37:55,280
caused by format string values via

934
00:37:55,280 --> 00:37:55,920
bluetooth

935
00:37:55,920 --> 00:37:59,200
here are the reproduction steps step one

936
00:37:59,200 --> 00:38:00,560
rename your phone to

937
00:38:00,560 --> 00:38:04,000
person p person p percent p

938
00:38:04,000 --> 00:38:06,240
person p blah blah blah blah then

939
00:38:06,240 --> 00:38:07,119
connect your uh

940
00:38:07,119 --> 00:38:09,440
second step connect you or pair your

941
00:38:09,440 --> 00:38:11,760
phone to the infotainment via bluetooth

942
00:38:11,760 --> 00:38:13,760
uh third use the navigation buttons to

943
00:38:13,760 --> 00:38:15,440
control the infotainment

944
00:38:15,440 --> 00:38:18,720
and it should remain stuck which means

945
00:38:18,720 --> 00:38:20,800
you were able to break the infotainment

946
00:38:20,800 --> 00:38:21,760
system

947
00:38:21,760 --> 00:38:26,320
okay then give more information

948
00:38:26,320 --> 00:38:28,720
like i also tried restarting the

949
00:38:28,720 --> 00:38:30,720
infotainment and this does not resolve

950
00:38:30,720 --> 00:38:31,119
this

951
00:38:31,119 --> 00:38:33,920
this issue it only works fine after

952
00:38:33,920 --> 00:38:35,520
doing a hard reset

953
00:38:35,520 --> 00:38:38,480
and of course attach a screenshot or a

954
00:38:38,480 --> 00:38:40,880
video

955
00:38:42,000 --> 00:38:44,839
i would like to give a shout out because

956
00:38:44,839 --> 00:38:46,240
uh

957
00:38:46,240 --> 00:38:49,599
you know credit to this people

958
00:38:49,599 --> 00:38:51,520
for my inspiration of this stuff so i

959
00:38:51,520 --> 00:38:52,800
would like to give a shout

960
00:38:52,800 --> 00:38:55,839
shouts to carnhacking village craig

961
00:38:55,839 --> 00:38:57,119
smith

962
00:38:57,119 --> 00:39:00,160
for the book of course uh ian sabor car

963
00:39:00,160 --> 00:39:01,280


964
00:39:01,280 --> 00:39:05,440
uh will corona fronders techmaker ua

965
00:39:05,440 --> 00:39:08,160
asrg or automotive security research

966
00:39:08,160 --> 00:39:09,240
group

967
00:39:09,240 --> 00:39:12,839
asrjsyn or asrg singapore and of course

968
00:39:12,839 --> 00:39:14,000
spectres

969
00:39:14,000 --> 00:39:17,400
jammy and semprix and of course the uh

970
00:39:17,400 --> 00:39:21,520
cdp.com for the article that i rip off

971
00:39:21,520 --> 00:39:25,280
uh you know just a proof that

972
00:39:25,280 --> 00:39:28,960
you know tesla actually gave out 35 000

973
00:39:28,960 --> 00:39:29,760
usd

974
00:39:29,760 --> 00:39:32,320
to hackers at the phone to own event and

975
00:39:32,320 --> 00:39:33,040
also

976
00:39:33,040 --> 00:39:37,920
rewarded the duo with a car

977
00:39:37,920 --> 00:39:40,720
if you have any questions just message

978
00:39:40,720 --> 00:39:42,079
me on twitter i'm on twitter

979
00:39:42,079 --> 00:39:46,960
at chip code and then you know

980
00:39:46,960 --> 00:39:50,160
or if you're my friend at facebook you

981
00:39:50,160 --> 00:39:51,680
could also message me

982
00:39:51,680 --> 00:39:55,760
so stay tuned for defcon and

983
00:39:55,760 --> 00:39:57,599
you know i hope that you will enjoy

984
00:39:57,599 --> 00:39:58,880
other apsec

985
00:39:58,880 --> 00:40:02,640
uh villages uh talks

986
00:40:02,640 --> 00:40:07,200
as well

