1
00:00:00,560 --> 00:00:02,560
hi everyone my name is dan gunner and

2
00:00:02,560 --> 00:00:04,080
today i'm here to present to you

3
00:00:04,080 --> 00:00:06,080
consider the data source a journey

4
00:00:06,080 --> 00:00:07,930
through an industrial attack

5
00:00:07,930 --> 00:00:10,719
[Music]

6
00:00:10,719 --> 00:00:12,960
disclaimer up front on this the there

7
00:00:12,960 --> 00:00:14,400
are a few companies brands and

8
00:00:14,400 --> 00:00:15,920
trademarks in here the views are

9
00:00:15,920 --> 00:00:17,119
completely my own

10
00:00:17,119 --> 00:00:19,119
and all information is used at your own

11
00:00:19,119 --> 00:00:21,439
risk

12
00:00:21,439 --> 00:00:23,359
so every information security journey

13
00:00:23,359 --> 00:00:25,359
really starts with preparation and when

14
00:00:25,359 --> 00:00:26,320
you think about it

15
00:00:26,320 --> 00:00:29,840
preparation is the calm before the storm

16
00:00:29,840 --> 00:00:31,279
when you're dealing with an event or

17
00:00:31,279 --> 00:00:33,120
with an intrusion

18
00:00:33,120 --> 00:00:34,960
and during preparation there's obvio

19
00:00:34,960 --> 00:00:36,559
there's tons of different controls you

20
00:00:36,559 --> 00:00:38,079
can do there's things like host and

21
00:00:38,079 --> 00:00:41,360
network monitoring data centralization

22
00:00:41,360 --> 00:00:43,680
all of the standard things we're used to

23
00:00:43,680 --> 00:00:46,160
there's offensive analysis and stem

24
00:00:46,160 --> 00:00:49,200
simulation red teaming penetration

25
00:00:49,200 --> 00:00:51,039
testing all of the other

26
00:00:51,039 --> 00:00:54,000
similar services there and you know

27
00:00:54,000 --> 00:00:55,760
there's the process side too

28
00:00:55,760 --> 00:00:59,359
so security is people process technology

29
00:00:59,359 --> 00:01:02,239
but all of this makes up really that

30
00:01:02,239 --> 00:01:03,920
range of events you can do

31
00:01:03,920 --> 00:01:08,159
during preparation um but at some point

32
00:01:08,159 --> 00:01:10,320
you know stuff's going to happen and

33
00:01:10,320 --> 00:01:12,240
when stuff does happen

34
00:01:12,240 --> 00:01:15,119
you know preparation is still worth it

35
00:01:15,119 --> 00:01:16,880
you have to be ready though for

36
00:01:16,880 --> 00:01:18,799
hey there's a lot you can plan for

37
00:01:18,799 --> 00:01:20,240
there's things you can model

38
00:01:20,240 --> 00:01:23,439
there's approaches that you can kind of

39
00:01:23,439 --> 00:01:24,560
run through

40
00:01:24,560 --> 00:01:27,600
and scenarios you can run through but

41
00:01:27,600 --> 00:01:29,280
there's never certainty that that's

42
00:01:29,280 --> 00:01:30,400
going to cover

43
00:01:30,400 --> 00:01:32,560
what you know the full scope of what you

44
00:01:32,560 --> 00:01:33,600
think it will

45
00:01:33,600 --> 00:01:36,240
um this is a quote from a while back

46
00:01:36,240 --> 00:01:36,640
right

47
00:01:36,640 --> 00:01:39,600
um but you know it's it's held true

48
00:01:39,600 --> 00:01:40,000
whether

49
00:01:40,000 --> 00:01:41,920
it's been something digital or whether

50
00:01:41,920 --> 00:01:43,280
it's something now

51
00:01:43,280 --> 00:01:45,600
um you can plan for kind of that first

52
00:01:45,600 --> 00:01:46,479
encounter

53
00:01:46,479 --> 00:01:48,320
but once you get past that first

54
00:01:48,320 --> 00:01:50,079
encounter there's always going to be

55
00:01:50,079 --> 00:01:50,399
those

56
00:01:50,399 --> 00:01:53,520
unknowns and those details um that'll

57
00:01:53,520 --> 00:01:56,560
catch you by surprise

58
00:01:56,560 --> 00:01:59,119
and so you know it's kind of easy to say

59
00:01:59,119 --> 00:02:01,280
as you're planning for that first

60
00:02:01,280 --> 00:02:03,520
kind of for that first iteration to say

61
00:02:03,520 --> 00:02:04,799
okay well

62
00:02:04,799 --> 00:02:07,280
you know i'm going to i'm going to put

63
00:02:07,280 --> 00:02:09,199
all of my eggs in this basket right i'm

64
00:02:09,199 --> 00:02:10,479
going to

65
00:02:10,479 --> 00:02:12,720
you know come up for really focus on

66
00:02:12,720 --> 00:02:13,920
this one control

67
00:02:13,920 --> 00:02:16,480
and just kind of stick with that because

68
00:02:16,480 --> 00:02:18,239
hey you know no matter what i do to

69
00:02:18,239 --> 00:02:19,360
prepare

70
00:02:19,360 --> 00:02:22,480
it doesn't matter there's also risk

71
00:02:22,480 --> 00:02:23,200
though to

72
00:02:23,200 --> 00:02:25,520
not always constantly improving or to

73
00:02:25,520 --> 00:02:26,879
doing that because

74
00:02:26,879 --> 00:02:29,040
you know while there is risks and cost

75
00:02:29,040 --> 00:02:31,440
action i mean you're risking sometimes

76
00:02:31,440 --> 00:02:33,519
your reputation you could be risking

77
00:02:33,519 --> 00:02:35,280
your job if you get

78
00:02:35,280 --> 00:02:37,680
breached and someone gets fired over it

79
00:02:37,680 --> 00:02:39,519
but in the long run you know there's

80
00:02:39,519 --> 00:02:42,319
really this belief that you know far

81
00:02:42,319 --> 00:02:42,879
less

82
00:02:42,879 --> 00:02:46,000
or the the risks of long-range fixing

83
00:02:46,000 --> 00:02:47,120
things

84
00:02:47,120 --> 00:02:50,000
is actually less than the risks of not

85
00:02:50,000 --> 00:02:51,599
doing anything

86
00:02:51,599 --> 00:02:54,640
particularly in our space right i mean

87
00:02:54,640 --> 00:02:56,879
there have been industrial intrusions

88
00:02:56,879 --> 00:02:58,640
for a while on the screen is

89
00:02:58,640 --> 00:03:01,360
really just a handful of even the ones

90
00:03:01,360 --> 00:03:02,840
we know about there's a lot of

91
00:03:02,840 --> 00:03:04,080
intrusions

92
00:03:04,080 --> 00:03:06,239
that likely we don't know about we

93
00:03:06,239 --> 00:03:08,000
haven't heard about either companies

94
00:03:08,000 --> 00:03:08,640
have

95
00:03:08,640 --> 00:03:11,760
kept it in for reputation um or just

96
00:03:11,760 --> 00:03:13,519
honestly we don't know about it it was

97
00:03:13,519 --> 00:03:16,080
never detected

98
00:03:16,080 --> 00:03:19,360
and you know sometimes um so stuff can

99
00:03:19,360 --> 00:03:20,159
happen

100
00:03:20,159 --> 00:03:22,159
and sometimes literal stuff can happen i

101
00:03:22,159 --> 00:03:24,159
mean here's an example that

102
00:03:24,159 --> 00:03:25,680
some people talk about if you've been

103
00:03:25,680 --> 00:03:27,680
around the community for a while

104
00:03:27,680 --> 00:03:30,000
um but others don't know about this so

105
00:03:30,000 --> 00:03:32,959
back in 2000 and marucci shire

106
00:03:32,959 --> 00:03:36,080
there was an inside threat um he

107
00:03:36,080 --> 00:03:38,640
this uh person wasn't happy because they

108
00:03:38,640 --> 00:03:39,920
weren't hired

109
00:03:39,920 --> 00:03:41,760
for a position there was some kind of

110
00:03:41,760 --> 00:03:43,200
some

111
00:03:43,200 --> 00:03:46,239
employment drama between them

112
00:03:46,239 --> 00:03:48,080
and you know with his technical

113
00:03:48,080 --> 00:03:50,239
knowledge and with his abilities he

114
00:03:50,239 --> 00:03:51,440
actually ended up

115
00:03:51,440 --> 00:03:53,439
doing a series of wireless a series of

116
00:03:53,439 --> 00:03:55,200
rf attacks um against

117
00:03:55,200 --> 00:03:57,920
this public sewage it ended up spilling

118
00:03:57,920 --> 00:04:00,159
sewage a lot of places

119
00:04:00,159 --> 00:04:02,239
this ended up in kind of a knife fight

120
00:04:02,239 --> 00:04:04,400
actually between him and other operators

121
00:04:04,400 --> 00:04:06,959
on site that we'll talk about

122
00:04:06,959 --> 00:04:08,720
a little later some of the outcomes for

123
00:04:08,720 --> 00:04:11,040
that but really what happened

124
00:04:11,040 --> 00:04:13,599
is you know he he had the equipment he

125
00:04:13,599 --> 00:04:15,760
had the knowledge to access this

126
00:04:15,760 --> 00:04:18,639
system remotely so what he would do is

127
00:04:18,639 --> 00:04:19,918
drive

128
00:04:19,918 --> 00:04:22,400
you know he was driving up to different

129
00:04:22,400 --> 00:04:23,280
sites

130
00:04:23,280 --> 00:04:25,680
connecting wirelessly there was some

131
00:04:25,680 --> 00:04:27,280
stuff and if you read through the court

132
00:04:27,280 --> 00:04:29,040
documents there was stuff that he had to

133
00:04:29,040 --> 00:04:30,639
know to actually connect

134
00:04:30,639 --> 00:04:33,680
um his inside knowledge did help some um

135
00:04:33,680 --> 00:04:35,120
but what's interesting when you look

136
00:04:35,120 --> 00:04:35,759
through this

137
00:04:35,759 --> 00:04:38,479
is actually you know the knife portion

138
00:04:38,479 --> 00:04:39,360
was

139
00:04:39,360 --> 00:04:40,800
you know through this network he was

140
00:04:40,800 --> 00:04:43,759
just using uh legitimate applications to

141
00:04:43,759 --> 00:04:45,440
generate the traffic well

142
00:04:45,440 --> 00:04:47,280
they'd be like okay well this traffic's

143
00:04:47,280 --> 00:04:48,960
coming from site

144
00:04:48,960 --> 00:04:51,919
14 and so he would emulate okay i'm

145
00:04:51,919 --> 00:04:52,560
going to

146
00:04:52,560 --> 00:04:55,199
configure this hot my my software to

147
00:04:55,199 --> 00:04:56,000
pretend to be

148
00:04:56,000 --> 00:04:59,199
site 14 and mess with the pumps um

149
00:04:59,199 --> 00:05:00,960
and so an operator was like hey this

150
00:05:00,960 --> 00:05:02,639
isn't right someone might be messing

151
00:05:02,639 --> 00:05:03,759
with us well

152
00:05:03,759 --> 00:05:06,800
they changed to site three um

153
00:05:06,800 --> 00:05:08,720
in changing to site three they noticed

154
00:05:08,720 --> 00:05:11,680
hey well the actual plants now

155
00:05:11,680 --> 00:05:13,919
um you know site three is now trying to

156
00:05:13,919 --> 00:05:15,360
do it and i still have this

157
00:05:15,360 --> 00:05:18,800
rogue site 14 off in the corner

158
00:05:18,800 --> 00:05:20,639
how this was actually and you know

159
00:05:20,639 --> 00:05:22,240
what's interesting there is that's kind

160
00:05:22,240 --> 00:05:24,080
of really the first known example of

161
00:05:24,080 --> 00:05:25,199
where we

162
00:05:25,199 --> 00:05:28,240
see an operator that's actually um

163
00:05:28,240 --> 00:05:30,720
you know detecting these events um but

164
00:05:30,720 --> 00:05:32,639
this is all to say that

165
00:05:32,639 --> 00:05:35,440
stuff literally happens in this domain

166
00:05:35,440 --> 00:05:37,680
and it has for a while i mean 2000

167
00:05:37,680 --> 00:05:39,680
is 21 years ago if you do the simple

168
00:05:39,680 --> 00:05:41,280
math there so

169
00:05:41,280 --> 00:05:44,400
um this is all to say that

170
00:05:44,400 --> 00:05:47,680
response is inevitable and this isn't to

171
00:05:47,680 --> 00:05:49,360
i mean i'm not saying this to sound

172
00:05:49,360 --> 00:05:51,440
hopeless i'm saying that

173
00:05:51,440 --> 00:05:54,639
in today's world there's not an if

174
00:05:54,639 --> 00:05:56,639
um you don't control the if and you

175
00:05:56,639 --> 00:05:58,240
don't control the wind

176
00:05:58,240 --> 00:06:00,240
but what you can control if you're on

177
00:06:00,240 --> 00:06:01,840
the defense side of this

178
00:06:01,840 --> 00:06:04,880
is how fast you can detect it and how

179
00:06:04,880 --> 00:06:06,080
fast you can respond

180
00:06:06,080 --> 00:06:08,639
to it and so we're going to really focus

181
00:06:08,639 --> 00:06:10,639
on those two areas as we talk through

182
00:06:10,639 --> 00:06:12,960
the attack

183
00:06:12,960 --> 00:06:16,080
there are many models for for

184
00:06:16,080 --> 00:06:19,520
modeling attacks one of the popular

185
00:06:19,520 --> 00:06:21,919
adversary actions one of the popular

186
00:06:21,919 --> 00:06:23,680
ones and hot ones today we're going to

187
00:06:23,680 --> 00:06:25,280
use this miter attack

188
00:06:25,280 --> 00:06:27,360
um i'm sure most of you are probably

189
00:06:27,360 --> 00:06:29,520
familiar with miter attack for the

190
00:06:29,520 --> 00:06:31,680
people that might not be what it is is

191
00:06:31,680 --> 00:06:33,680
miter attack breaks down

192
00:06:33,680 --> 00:06:37,120
adversary tactics and techniques

193
00:06:37,120 --> 00:06:39,199
into a series of buckets so what they do

194
00:06:39,199 --> 00:06:40,560
is they've taken

195
00:06:40,560 --> 00:06:43,360
events in the past modeled them out and

196
00:06:43,360 --> 00:06:44,639
tried to kind of

197
00:06:44,639 --> 00:06:47,919
cluster the activity or the intent

198
00:06:47,919 --> 00:06:50,560
throughout the whole attack cycle so

199
00:06:50,560 --> 00:06:51,599
attack definitely

200
00:06:51,599 --> 00:06:54,720
google it look it up it's a pretty

201
00:06:54,720 --> 00:06:57,280
big knowledge base there that you can

202
00:06:57,280 --> 00:06:58,639
use

203
00:06:58,639 --> 00:07:01,120
what recently happened specific to the

204
00:07:01,120 --> 00:07:02,319
industrial community

205
00:07:02,319 --> 00:07:04,960
was the triton evaluation so for those

206
00:07:04,960 --> 00:07:07,919
now familiar with crisis and triton

207
00:07:07,919 --> 00:07:10,960
there was a breach into middle eastern

208
00:07:10,960 --> 00:07:11,520
oil

209
00:07:11,520 --> 00:07:16,479
site the compromise to safety system

210
00:07:16,479 --> 00:07:18,720
you know a year or two back here maybe

211
00:07:18,720 --> 00:07:20,240
three years

212
00:07:20,240 --> 00:07:23,280
back what mitre did

213
00:07:23,280 --> 00:07:25,280
and miter does these attack valuations

214
00:07:25,280 --> 00:07:26,800
where they bring in different vendor

215
00:07:26,800 --> 00:07:28,240
products

216
00:07:28,240 --> 00:07:30,880
they um run the same scenario through

217
00:07:30,880 --> 00:07:31,280
them

218
00:07:31,280 --> 00:07:33,039
there's technically no winner but what

219
00:07:33,039 --> 00:07:34,479
they do do what they do

220
00:07:34,479 --> 00:07:37,199
is publish out the results to kind of

221
00:07:37,199 --> 00:07:38,560
show hey you know

222
00:07:38,560 --> 00:07:41,039
here's kind of this central mitre

223
00:07:41,039 --> 00:07:42,319
created scenario

224
00:07:42,319 --> 00:07:44,639
um and here's what we saw each of the

225
00:07:44,639 --> 00:07:45,520
tools

226
00:07:45,520 --> 00:07:47,520
um they don't declare a winner they say

227
00:07:47,520 --> 00:07:48,879
hey you should

228
00:07:48,879 --> 00:07:51,520
declare you it's up for people to decide

229
00:07:51,520 --> 00:07:53,280
basically how people do

230
00:07:53,280 --> 00:07:55,199
um and so what miner did here is they

231
00:07:55,199 --> 00:07:56,639
calculated

232
00:07:56,639 --> 00:08:00,400
or they uh they emulated the behaviors

233
00:08:00,400 --> 00:08:01,840
of what was known about

234
00:08:01,840 --> 00:08:03,840
um that intrusion into that middle

235
00:08:03,840 --> 00:08:05,840
eastern um

236
00:08:05,840 --> 00:08:09,280
uh gas and oil site

237
00:08:09,599 --> 00:08:12,160
and how they did this is they they had

238
00:08:12,160 --> 00:08:12,960
real hardware

239
00:08:12,960 --> 00:08:14,960
doing this so they set up the control

240
00:08:14,960 --> 00:08:17,199
system it was a rockwell control system

241
00:08:17,199 --> 00:08:17,599
uh

242
00:08:17,599 --> 00:08:19,440
the burner management environment the

243
00:08:19,440 --> 00:08:21,360
graph you see there is from the miter

244
00:08:21,360 --> 00:08:22,240
site

245
00:08:22,240 --> 00:08:24,639
um they set up the control system

246
00:08:24,639 --> 00:08:26,080
components there

247
00:08:26,080 --> 00:08:28,720
and they did simulate some of the

248
00:08:28,720 --> 00:08:31,199
physical process so obviously they might

249
00:08:31,199 --> 00:08:33,760
they weren't um producing barrels of oil

250
00:08:33,760 --> 00:08:35,519
i don't think but what they were doing

251
00:08:35,519 --> 00:08:36,799
they had the real

252
00:08:36,799 --> 00:08:39,279
software connected to a simulator there

253
00:08:39,279 --> 00:08:40,640
to try to get

254
00:08:40,640 --> 00:08:42,799
you know as accurate as you can within

255
00:08:42,799 --> 00:08:44,640
you know a reasonable budget

256
00:08:44,640 --> 00:08:47,120
um while still exercising those security

257
00:08:47,120 --> 00:08:49,040
tools

258
00:08:49,040 --> 00:08:51,040
what you have there what this shows is

259
00:08:51,040 --> 00:08:53,120
that bingo card and again we talked

260
00:08:53,120 --> 00:08:53,519
about

261
00:08:53,519 --> 00:08:56,560
attack being that the collection of

262
00:08:56,560 --> 00:08:58,320
tactics and techniques

263
00:08:58,320 --> 00:09:00,320
um you know this is kind of that bingo

264
00:09:00,320 --> 00:09:02,320
card and green is what they exercised

265
00:09:02,320 --> 00:09:04,000
and we'll talk through

266
00:09:04,000 --> 00:09:06,240
different ones of these shortly um but

267
00:09:06,240 --> 00:09:08,160
as you can see they picked

268
00:09:08,160 --> 00:09:10,880
really a portion of the attack

269
00:09:10,880 --> 00:09:12,000
techniques

270
00:09:12,000 --> 00:09:14,320
tactics and techniques to choose against

271
00:09:14,320 --> 00:09:16,240
this

272
00:09:16,240 --> 00:09:18,560
you know as we get into the scenario of

273
00:09:18,560 --> 00:09:20,480
what they emulated and again this was

274
00:09:20,480 --> 00:09:22,880
based on that trisys flow if you look at

275
00:09:22,880 --> 00:09:25,680
the link at the bottom of this slide

276
00:09:25,680 --> 00:09:28,480
it talks through um you know how they

277
00:09:28,480 --> 00:09:30,480
throughout this scenario

278
00:09:30,480 --> 00:09:32,080
we're going to start from the attacker

279
00:09:32,080 --> 00:09:34,160
point of view so as a defender

280
00:09:34,160 --> 00:09:36,640
you might catch the initial compromise

281
00:09:36,640 --> 00:09:38,000
as the route into it

282
00:09:38,000 --> 00:09:39,760
chances are as a defender you'll see

283
00:09:39,760 --> 00:09:41,200
later on we're going to go with the

284
00:09:41,200 --> 00:09:43,120
attacker perspective just because it's

285
00:09:43,120 --> 00:09:44,800
more chronological

286
00:09:44,800 --> 00:09:47,360
um and so the one of the early things

287
00:09:47,360 --> 00:09:48,320
that they

288
00:09:48,320 --> 00:09:50,480
that miter emulated through this was an

289
00:09:50,480 --> 00:09:52,000
attacker using

290
00:09:52,000 --> 00:09:53,600
you know valid credentials that they

291
00:09:53,600 --> 00:09:55,519
stole right so maybe they spearfish

292
00:09:55,519 --> 00:09:58,240
these maybe they got these um

293
00:09:58,240 --> 00:09:59,920
through watering hole through other

294
00:09:59,920 --> 00:10:02,320
means but what they did is they jumped

295
00:10:02,320 --> 00:10:04,079
from the intersect enterprise

296
00:10:04,079 --> 00:10:07,360
side into the industrial side of the

297
00:10:07,360 --> 00:10:10,079
plant they used rdp over 33.89

298
00:10:10,079 --> 00:10:13,600
pretty common this can still be enabled

299
00:10:13,600 --> 00:10:15,600
at a lot of sites a lot of people allow

300
00:10:15,600 --> 00:10:16,079
this

301
00:10:16,079 --> 00:10:19,519
over the firewall still and they said as

302
00:10:19,519 --> 00:10:20,320
this that it

303
00:10:20,320 --> 00:10:23,279
is you know standard operating behavior

304
00:10:23,279 --> 00:10:25,040
um what they did with this was they did

305
00:10:25,040 --> 00:10:26,320
a program upload

306
00:10:26,320 --> 00:10:29,360
um save some files um and we'll talk

307
00:10:29,360 --> 00:10:32,959
about this a bit more in there

308
00:10:32,959 --> 00:10:34,720
you know one of the first things that

309
00:10:34,720 --> 00:10:36,640
we're going to point out as we look at

310
00:10:36,640 --> 00:10:38,560
this and the importance of data

311
00:10:38,560 --> 00:10:41,760
is out of the bat you might say hey well

312
00:10:41,760 --> 00:10:43,839
you know going from one network trust

313
00:10:43,839 --> 00:10:45,279
zone to another

314
00:10:45,279 --> 00:10:47,519
um maybe i can just do this with bass

315
00:10:47,519 --> 00:10:48,560
lines right um

316
00:10:48,560 --> 00:10:52,560
it's rdp and that's true bass lines can

317
00:10:52,560 --> 00:10:53,760
be helpful

318
00:10:53,760 --> 00:10:55,920
um but it depends on those thresholds

319
00:10:55,920 --> 00:10:57,120
right um

320
00:10:57,120 --> 00:11:00,240
you get a lot of rdp from the box a to

321
00:11:00,240 --> 00:11:01,279
box b

322
00:11:01,279 --> 00:11:04,880
if box a has no reason to talk to box b

323
00:11:04,880 --> 00:11:08,000
then yeah that's really good baseline um

324
00:11:08,000 --> 00:11:09,680
you know if box a though is an

325
00:11:09,680 --> 00:11:12,480
engineering station inbox b is a j or an

326
00:11:12,480 --> 00:11:13,839
engineer station on the corporate

327
00:11:13,839 --> 00:11:14,640
network

328
00:11:14,640 --> 00:11:17,519
and box b is actually the jump server

329
00:11:17,519 --> 00:11:18,480
inside

330
00:11:18,480 --> 00:11:20,720
you know it's going to be harder to just

331
00:11:20,720 --> 00:11:21,600
do a

332
00:11:21,600 --> 00:11:23,760
you know matter of fact well an engineer

333
00:11:23,760 --> 00:11:25,839
talk to a jump host okay cool

334
00:11:25,839 --> 00:11:27,680
was it done out of business hours was it

335
00:11:27,680 --> 00:11:29,839
done when that engineer was off shift

336
00:11:29,839 --> 00:11:32,399
you know um you know you have to

337
00:11:32,399 --> 00:11:33,680
consider

338
00:11:33,680 --> 00:11:36,160
what actually is inside of that baseline

339
00:11:36,160 --> 00:11:37,360
and how you drive it

340
00:11:37,360 --> 00:11:39,279
you know after hours is actually really

341
00:11:39,279 --> 00:11:42,079
cool and if you can find a way to

342
00:11:42,079 --> 00:11:44,079
get your shift schedule into there you

343
00:11:44,079 --> 00:11:46,000
can get better baselines right and what

344
00:11:46,000 --> 00:11:47,839
i mean by getting your shift schedule in

345
00:11:47,839 --> 00:11:48,560
is

346
00:11:48,560 --> 00:11:51,120
trying to remove it to where you can do

347
00:11:51,120 --> 00:11:52,560
it human-wise you're going to have

348
00:11:52,560 --> 00:11:54,000
problems scaling

349
00:11:54,000 --> 00:11:55,920
but if you can get your baselines better

350
00:11:55,920 --> 00:11:58,560
by hey let me go ahead and import a csv

351
00:11:58,560 --> 00:12:01,760
of my operator schedules um you can

352
00:12:01,760 --> 00:12:03,920
begin to get better baselines and

353
00:12:03,920 --> 00:12:05,920
this is where it can be futile other

354
00:12:05,920 --> 00:12:08,000
futile otherwise because

355
00:12:08,000 --> 00:12:10,639
if if the attacker is acting within that

356
00:12:10,639 --> 00:12:12,560
mathematical baseline or within the

357
00:12:12,560 --> 00:12:13,360
logical

358
00:12:13,360 --> 00:12:15,680
the logic of that baseline you're going

359
00:12:15,680 --> 00:12:18,399
to struggle with this

360
00:12:18,399 --> 00:12:20,399
and you know another important thing to

361
00:12:20,399 --> 00:12:22,639
say on this is and we'll see this later

362
00:12:22,639 --> 00:12:23,600
in there

363
00:12:23,600 --> 00:12:26,880
is um host sources can provide

364
00:12:26,880 --> 00:12:28,959
details that the network sources can't

365
00:12:28,959 --> 00:12:31,920
see this is a really important takeaway

366
00:12:31,920 --> 00:12:34,399
from the miter attack eval as we push

367
00:12:34,399 --> 00:12:35,440
through

368
00:12:35,440 --> 00:12:36,800
and definitely something you should

369
00:12:36,800 --> 00:12:39,680
investigate both from miter's results

370
00:12:39,680 --> 00:12:42,079
but also just as you evaluate products

371
00:12:42,079 --> 00:12:45,760
and look through what people are doing

372
00:12:45,760 --> 00:12:47,920
when we talk about data sources today

373
00:12:47,920 --> 00:12:49,680
we're going to really talk about three

374
00:12:49,680 --> 00:12:51,360
areas we're going to are three different

375
00:12:51,360 --> 00:12:53,279
types um this is how we're bucketing

376
00:12:53,279 --> 00:12:53,760
them

377
00:12:53,760 --> 00:12:55,440
we're going to talk about process

378
00:12:55,440 --> 00:12:57,680
network data this is a lot of

379
00:12:57,680 --> 00:12:59,440
when you look at the industrial market

380
00:12:59,440 --> 00:13:01,760
what you see so passive network analysis

381
00:13:01,760 --> 00:13:02,079
this

382
00:13:02,079 --> 00:13:04,320
includes people that are doing kind of

383
00:13:04,320 --> 00:13:05,519
netflow style

384
00:13:05,519 --> 00:13:08,240
summarizations your five tuple of you

385
00:13:08,240 --> 00:13:09,440
know source and desk

386
00:13:09,440 --> 00:13:12,480
ip and port and then protocol

387
00:13:12,480 --> 00:13:14,320
including down into some of the

388
00:13:14,320 --> 00:13:16,000
summarization so

389
00:13:16,000 --> 00:13:18,399
when you get into looking deeper into

390
00:13:18,399 --> 00:13:19,519
the protocol

391
00:13:19,519 --> 00:13:22,720
process network data is that really

392
00:13:22,720 --> 00:13:23,600
efficient

393
00:13:23,600 --> 00:13:26,639
way of um you know digging into

394
00:13:26,639 --> 00:13:28,320
some of the fields that they decide to

395
00:13:28,320 --> 00:13:30,480
extract why it's the process side as the

396
00:13:30,480 --> 00:13:32,399
vendors decided like hey

397
00:13:32,399 --> 00:13:33,839
you know we're going to write logic on

398
00:13:33,839 --> 00:13:36,000
this field or it might not be a vendor

399
00:13:36,000 --> 00:13:38,560
vendor or open source product decided

400
00:13:38,560 --> 00:13:40,480
hey let's summarize this

401
00:13:40,480 --> 00:13:43,120
specific field in the protocol when we

402
00:13:43,120 --> 00:13:45,199
talk about process network data the

403
00:13:45,199 --> 00:13:48,480
efficiency here is analysis and storage

404
00:13:48,480 --> 00:13:51,440
um there's only so much processing power

405
00:13:51,440 --> 00:13:51,920
um

406
00:13:51,920 --> 00:13:54,320
that you have and especially as you you

407
00:13:54,320 --> 00:13:56,079
know ruggedize a box and you push it

408
00:13:56,079 --> 00:13:57,600
forward in a plant

409
00:13:57,600 --> 00:14:00,560
you know you can't often have racks and

410
00:14:00,560 --> 00:14:03,680
racks of servers looking at a single tap

411
00:14:03,680 --> 00:14:04,320
point

412
00:14:04,320 --> 00:14:07,760
at some point um you know you have to

413
00:14:07,760 --> 00:14:10,880
you have to cut data down in the storage

414
00:14:10,880 --> 00:14:11,600
size too

415
00:14:11,600 --> 00:14:14,800
obviously storage also can take up quite

416
00:14:14,800 --> 00:14:16,000
a few racks um

417
00:14:16,000 --> 00:14:18,160
if it's not process data depending on

418
00:14:18,160 --> 00:14:19,680
the flow of that

419
00:14:19,680 --> 00:14:23,120
the con on on this is encryption so

420
00:14:23,120 --> 00:14:26,320
you know with the 3389 and with

421
00:14:26,320 --> 00:14:29,440
like tls with https um

422
00:14:29,440 --> 00:14:31,839
if the data is actually encrypted you

423
00:14:31,839 --> 00:14:35,120
can see the fact of communications

424
00:14:35,120 --> 00:14:37,120
but it's going to limit you later on if

425
00:14:37,120 --> 00:14:38,320
you actually want to see

426
00:14:38,320 --> 00:14:40,000
what was communicated what was the

427
00:14:40,000 --> 00:14:42,639
context inside of it

428
00:14:42,639 --> 00:14:45,040
and also protocol support so like we

429
00:14:45,040 --> 00:14:48,240
said for summarization it can depend on

430
00:14:48,240 --> 00:14:51,839
you know how deep and what um

431
00:14:51,839 --> 00:14:53,519
you know in a protocol that's actually

432
00:14:53,519 --> 00:14:55,920
pulled out that the logic is written on

433
00:14:55,920 --> 00:14:57,920
protocol support's really important

434
00:14:57,920 --> 00:14:59,839
especially in the industrial field when

435
00:14:59,839 --> 00:15:01,199
you're dealing with

436
00:15:01,199 --> 00:15:03,440
very proprietary protocols some that are

437
00:15:03,440 --> 00:15:05,120
known about and the whole spec might not

438
00:15:05,120 --> 00:15:06,079
be known

439
00:15:06,079 --> 00:15:08,959
um or there might be you know protocols

440
00:15:08,959 --> 00:15:10,480
with products that you don't

441
00:15:10,480 --> 00:15:12,800
even know about and vendors don't talk

442
00:15:12,800 --> 00:15:14,800
about much

443
00:15:14,800 --> 00:15:16,720
process host data is the next one right

444
00:15:16,720 --> 00:15:17,920
so this is

445
00:15:17,920 --> 00:15:19,839
things that come after endpoint agent

446
00:15:19,839 --> 00:15:22,240
collection this could be things like

447
00:15:22,240 --> 00:15:24,560
windows host logs this could be things

448
00:15:24,560 --> 00:15:25,279
like

449
00:15:25,279 --> 00:15:27,839
you know av logs your endpoint

450
00:15:27,839 --> 00:15:28,800
protection

451
00:15:28,800 --> 00:15:32,560
um application logs really anything you

452
00:15:32,560 --> 00:15:34,079
can pull off the disk

453
00:15:34,079 --> 00:15:36,720
where this is processed again is it's a

454
00:15:36,720 --> 00:15:37,600
log source

455
00:15:37,600 --> 00:15:40,320
so um you know there might be some

456
00:15:40,320 --> 00:15:41,440
filtering in there

457
00:15:41,440 --> 00:15:43,920
like you filter on the network side to

458
00:15:43,920 --> 00:15:44,639
extract

459
00:15:44,639 --> 00:15:48,079
out the data of interest um so again

460
00:15:48,079 --> 00:15:50,480
the pro here is it's not network events

461
00:15:50,480 --> 00:15:52,560
and what i mean by that and i don't mean

462
00:15:52,560 --> 00:15:54,959
to that sound like a really vague

463
00:15:54,959 --> 00:15:55,759
inverse of

464
00:15:55,759 --> 00:15:58,399
network data what it is is you can begin

465
00:15:58,399 --> 00:15:59,360
to see like hey

466
00:15:59,360 --> 00:16:01,920
here's information on here's a processes

467
00:16:01,920 --> 00:16:03,279
command line you're not going to see

468
00:16:03,279 --> 00:16:05,040
that on the network here's

469
00:16:05,040 --> 00:16:08,639
you know other other um you know file or

470
00:16:08,639 --> 00:16:09,519
process

471
00:16:09,519 --> 00:16:11,759
metadata when you look like sys

472
00:16:11,759 --> 00:16:13,600
internals and other tools

473
00:16:13,600 --> 00:16:15,600
um some of the cons here are

474
00:16:15,600 --> 00:16:17,920
configurations so when you get into host

475
00:16:17,920 --> 00:16:18,639
data

476
00:16:18,639 --> 00:16:21,199
as the number of hosts grow you kind of

477
00:16:21,199 --> 00:16:22,959
have this maintenance tail that you have

478
00:16:22,959 --> 00:16:24,399
to deal with um

479
00:16:24,399 --> 00:16:26,000
and also making sure that your

480
00:16:26,000 --> 00:16:28,000
configuration um

481
00:16:28,000 --> 00:16:30,079
and even managing your configuration can

482
00:16:30,079 --> 00:16:31,360
be a challenge

483
00:16:31,360 --> 00:16:35,600
um and then integrity right so

484
00:16:35,600 --> 00:16:37,440
you know when you're listening to data

485
00:16:37,440 --> 00:16:38,800
over tap point

486
00:16:38,800 --> 00:16:41,759
there are things an attacker can do to

487
00:16:41,759 --> 00:16:42,639
try to

488
00:16:42,639 --> 00:16:45,360
screw with the data you're getting with

489
00:16:45,360 --> 00:16:48,000
host data if the attacker is on the host

490
00:16:48,000 --> 00:16:50,399
indicator removal is its own actual

491
00:16:50,399 --> 00:16:51,680
miter

492
00:16:51,680 --> 00:16:55,519
ics ttp attack ics ttp there

493
00:16:55,519 --> 00:16:57,360
so with host data you do have to

494
00:16:57,360 --> 00:16:58,800
consider hey is

495
00:16:58,800 --> 00:17:01,120
is root getting involved am i hooked

496
00:17:01,120 --> 00:17:02,399
somewhere

497
00:17:02,399 --> 00:17:04,319
what are the issues is this data i'm

498
00:17:04,319 --> 00:17:06,000
getting the true data or could it be

499
00:17:06,000 --> 00:17:07,359
manipulated

500
00:17:07,359 --> 00:17:09,439
um third data source we'll talk through

501
00:17:09,439 --> 00:17:12,000
is our will uses raw host and net

502
00:17:12,000 --> 00:17:13,119
network data

503
00:17:13,119 --> 00:17:15,520
unlike its process friends this is your

504
00:17:15,520 --> 00:17:16,480
packet capture

505
00:17:16,480 --> 00:17:19,199
your disk and memory image the pro on

506
00:17:19,199 --> 00:17:20,240
this is it's not

507
00:17:20,240 --> 00:17:22,959
filter limited so you're not getting the

508
00:17:22,959 --> 00:17:24,640
opinion of the uh

509
00:17:24,640 --> 00:17:27,439
you know open source project or of the

510
00:17:27,439 --> 00:17:29,360
vendor of what they decided to put in

511
00:17:29,360 --> 00:17:30,400
there

512
00:17:30,400 --> 00:17:32,640
the con on here we talked about the

513
00:17:32,640 --> 00:17:34,799
processing space and

514
00:17:34,799 --> 00:17:38,160
um you know um yeah the processing

515
00:17:38,160 --> 00:17:40,400
capacity and disk space needed

516
00:17:40,400 --> 00:17:42,799
um the con here is you do need a mature

517
00:17:42,799 --> 00:17:45,280
analysis pipeline because the more data

518
00:17:45,280 --> 00:17:46,640
you bring in

519
00:17:46,640 --> 00:17:49,840
you have to be ready to officially deal

520
00:17:49,840 --> 00:17:51,440
with that

521
00:17:51,440 --> 00:17:54,960
that is kind of the pro con of

522
00:17:54,960 --> 00:17:57,039
not dealing with filtered data but the

523
00:17:57,039 --> 00:17:59,200
real pro again to go back to that

524
00:17:59,200 --> 00:18:02,000
is there's a lot more analysis

525
00:18:02,000 --> 00:18:05,600
opportunities as you dig into that

526
00:18:05,600 --> 00:18:09,039
so digging farther into miter end of the

527
00:18:09,039 --> 00:18:10,960
miter eval

528
00:18:10,960 --> 00:18:13,520
starting with initial compromising more

529
00:18:13,520 --> 00:18:15,600
than network data is often needed to

530
00:18:15,600 --> 00:18:18,960
dissect behavior is the takeaway here

531
00:18:18,960 --> 00:18:21,120
the criteria down at the bottom so the

532
00:18:21,120 --> 00:18:23,679
criteria to score on this minor point

533
00:18:23,679 --> 00:18:24,559
was

534
00:18:24,559 --> 00:18:27,600
seeing tcp 3389

535
00:18:27,600 --> 00:18:29,760
so again you know if we talk about

536
00:18:29,760 --> 00:18:31,600
process network data towards the top of

537
00:18:31,600 --> 00:18:34,400
the slide that's something i can see

538
00:18:34,400 --> 00:18:37,600
i'm going to see that tcp on udp traffic

539
00:18:37,600 --> 00:18:38,880
potentially

540
00:18:38,880 --> 00:18:41,600
and i might see the username with rdp

541
00:18:41,600 --> 00:18:43,520
you can get the rdp cookie that

542
00:18:43,520 --> 00:18:45,679
sometimes includes username

543
00:18:45,679 --> 00:18:48,720
depending on if the network tool you're

544
00:18:48,720 --> 00:18:50,480
using is actually extracting that and

545
00:18:50,480 --> 00:18:51,840
you actually have to see

546
00:18:51,840 --> 00:18:55,120
a certain part of the rdp handshake to

547
00:18:55,120 --> 00:18:56,960
get that

548
00:18:56,960 --> 00:18:58,480
that can answer the first part of

549
00:18:58,480 --> 00:19:01,280
scoring but to completely have scored on

550
00:19:01,280 --> 00:19:01,600
this

551
00:19:01,600 --> 00:19:03,919
and you actually had to have the second

552
00:19:03,919 --> 00:19:05,280
part which is

553
00:19:05,280 --> 00:19:08,320
you know via the ms via that specific

554
00:19:08,320 --> 00:19:11,760
process and having the user

555
00:19:11,760 --> 00:19:14,320
may or may not be present this is where

556
00:19:14,320 --> 00:19:15,919
the network data helps but

557
00:19:15,919 --> 00:19:17,919
you need that host data to say okay

558
00:19:17,919 --> 00:19:19,760
here's the process information here's

559
00:19:19,760 --> 00:19:21,679
the login record with my

560
00:19:21,679 --> 00:19:24,160
with the username if you go through the

561
00:19:24,160 --> 00:19:25,919
miter results you'll see some of that in

562
00:19:25,919 --> 00:19:27,200
there

563
00:19:27,200 --> 00:19:29,440
third one on there raw host and network

564
00:19:29,440 --> 00:19:30,960
you can of course pull this

565
00:19:30,960 --> 00:19:32,640
out of memory out of disk out of the

566
00:19:32,640 --> 00:19:34,080
pcap

567
00:19:34,080 --> 00:19:36,799
it's also going to be there but again

568
00:19:36,799 --> 00:19:38,000
you're going to have to

569
00:19:38,000 --> 00:19:40,240
um you know be dealing with a tool that

570
00:19:40,240 --> 00:19:41,440
either processes

571
00:19:41,440 --> 00:19:44,559
that for you efficiently um or it might

572
00:19:44,559 --> 00:19:45,840
take you a bit of time

573
00:19:45,840 --> 00:19:47,760
um or you keep if you're doing it

574
00:19:47,760 --> 00:19:49,840
manually you're going to have to keep

575
00:19:49,840 --> 00:19:51,520
the number of boxes you're doing on it

576
00:19:51,520 --> 00:19:53,840
low

577
00:19:54,000 --> 00:19:56,400
as we get outside of initial compromise

578
00:19:56,400 --> 00:19:58,880
and we start to talk about persistence

579
00:19:58,880 --> 00:20:01,760
um i'm not going to go through every

580
00:20:01,760 --> 00:20:03,039
step of the miter

581
00:20:03,039 --> 00:20:05,760
of the attack we actually only chose the

582
00:20:05,760 --> 00:20:07,600
few that we wanted to talk about to

583
00:20:07,600 --> 00:20:08,159
really

584
00:20:08,159 --> 00:20:10,960
bring out some salem points on this but

585
00:20:10,960 --> 00:20:13,039
for employing persistence what was done

586
00:20:13,039 --> 00:20:13,760
in the attack

587
00:20:13,760 --> 00:20:16,320
value eval was installing a scheduled

588
00:20:16,320 --> 00:20:17,600
task

589
00:20:17,600 --> 00:20:19,360
and then what this scheduled task did

590
00:20:19,360 --> 00:20:20,960
was initiate it or

591
00:20:20,960 --> 00:20:24,000
reverse shell and they did this ssh

592
00:20:24,000 --> 00:20:25,200
reverse shell over

593
00:20:25,200 --> 00:20:28,480
port 445. why they did this was to get

594
00:20:28,480 --> 00:20:30,720
past firewalls so if a firewall is not

595
00:20:30,720 --> 00:20:33,360
actually application aware if it's just

596
00:20:33,360 --> 00:20:35,600
doing it off the port number

597
00:20:35,600 --> 00:20:38,000
this would get past it they were trying

598
00:20:38,000 --> 00:20:38,880
to guide it as

599
00:20:38,880 --> 00:20:41,120
smb traffic and we'll talk about this in

600
00:20:41,120 --> 00:20:43,520
a minute

601
00:20:43,600 --> 00:20:46,559
when we hop into this um you know let's

602
00:20:46,559 --> 00:20:48,320
go into the first criteria right so a

603
00:20:48,320 --> 00:20:50,320
scheduled task was created

604
00:20:50,320 --> 00:20:52,640
it's not legitimate it was imported into

605
00:20:52,640 --> 00:20:54,159
the task manager

606
00:20:54,159 --> 00:20:56,400
for to score on this and the minor

607
00:20:56,400 --> 00:20:57,679
attack eval

608
00:20:57,679 --> 00:21:00,159
you would not have gotten this point

609
00:21:00,159 --> 00:21:02,320
right if you were just going off process

610
00:21:02,320 --> 00:21:03,440
network data

611
00:21:03,440 --> 00:21:05,120
um and this is where i think mitre

612
00:21:05,120 --> 00:21:06,880
actually does a pretty good job because

613
00:21:06,880 --> 00:21:07,679
if you

614
00:21:07,679 --> 00:21:09,440
you can look through now the results and

615
00:21:09,440 --> 00:21:11,360
say okay well who's actually

616
00:21:11,360 --> 00:21:14,000
processing host data um the link at the

617
00:21:14,000 --> 00:21:14,960
bottom actually

618
00:21:14,960 --> 00:21:18,000
i'll point out um should point you

619
00:21:18,000 --> 00:21:20,559
straight to this employee persistence um

620
00:21:20,559 --> 00:21:22,080
to where you can see how the different

621
00:21:22,080 --> 00:21:23,919
vendors did but in this case

622
00:21:23,919 --> 00:21:27,039
to score here it's like wait okay who's

623
00:21:27,039 --> 00:21:29,280
looking at cessnon file create a lot of

624
00:21:29,280 --> 00:21:30,240
the

625
00:21:30,240 --> 00:21:32,159
vendors that scored on this were using

626
00:21:32,159 --> 00:21:34,159
sysmon file create or they were doing

627
00:21:34,159 --> 00:21:36,480
some type of command line analysis

628
00:21:36,480 --> 00:21:38,480
command line analysis coming out of the

629
00:21:38,480 --> 00:21:40,960
fact that the windows event logs do give

630
00:21:40,960 --> 00:21:42,240
you the command line

631
00:21:42,240 --> 00:21:44,640
all of the competitors were scored out

632
00:21:44,640 --> 00:21:46,320
of windows um

633
00:21:46,320 --> 00:21:48,640
out of the windows event logs um again

634
00:21:48,640 --> 00:21:50,720
this is where raw host and network data

635
00:21:50,720 --> 00:21:51,679
comes in

636
00:21:51,679 --> 00:21:54,159
but it raises the question and really

637
00:21:54,159 --> 00:21:54,720
you know

638
00:21:54,720 --> 00:21:56,640
brings to the point what if no network

639
00:21:56,640 --> 00:21:59,360
data is generated by the tactic

640
00:21:59,360 --> 00:22:02,480
definitely something to consider and

641
00:22:02,480 --> 00:22:05,520
also something to consider here is you

642
00:22:05,520 --> 00:22:07,360
know if all you're responding with

643
00:22:07,360 --> 00:22:10,720
is network data how are you going to see

644
00:22:10,720 --> 00:22:12,000
this right and what i mean by

645
00:22:12,000 --> 00:22:15,360
that is okay cool i have a network alert

646
00:22:15,360 --> 00:22:17,120
um you know maybe from initial

647
00:22:17,120 --> 00:22:18,640
compromise maybe from a

648
00:22:18,640 --> 00:22:21,440
later step well i'm going to want to

649
00:22:21,440 --> 00:22:23,679
correlate this persistence and so how do

650
00:22:23,679 --> 00:22:26,080
i correlate this persistence to

651
00:22:26,080 --> 00:22:28,240
that network event that i got on either

652
00:22:28,240 --> 00:22:30,240
side of this tactic

653
00:22:30,240 --> 00:22:32,240
the approach i offer for this and the

654
00:22:32,240 --> 00:22:34,080
approach of mitre showed is

655
00:22:34,080 --> 00:22:36,000
definitely consider those windows event

656
00:22:36,000 --> 00:22:37,919
logs

657
00:22:37,919 --> 00:22:39,919
the point we want to show here is low

658
00:22:39,919 --> 00:22:42,640
collection diversity creates blind spots

659
00:22:42,640 --> 00:22:44,640
like we said to correlate the whole

660
00:22:44,640 --> 00:22:46,159
stream of attack

661
00:22:46,159 --> 00:22:48,320
you're going to need window or you're

662
00:22:48,320 --> 00:22:49,520
going to need network

663
00:22:49,520 --> 00:22:53,280
and host data and

664
00:22:53,280 --> 00:22:55,440
you're going to need um the process and

665
00:22:55,440 --> 00:22:56,799
capability to

666
00:22:56,799 --> 00:23:00,480
um be able to analyze that moving on

667
00:23:00,480 --> 00:23:02,799
so we talked about that reverse shell

668
00:23:02,799 --> 00:23:03,840
being created

669
00:23:03,840 --> 00:23:06,880
um and it going over port 445 um and

670
00:23:06,880 --> 00:23:08,080
that passing of firewall

671
00:23:08,080 --> 00:23:10,960
rules this is something to where you

672
00:23:10,960 --> 00:23:11,360
might

673
00:23:11,360 --> 00:23:12,960
see it on the network side right so

674
00:23:12,960 --> 00:23:15,440
there is an app player mismatch um

675
00:23:15,440 --> 00:23:18,799
sara cotto one of the attack um

676
00:23:18,799 --> 00:23:20,720
participants caught it via seracotta

677
00:23:20,720 --> 00:23:22,000
rule you might

678
00:23:22,000 --> 00:23:24,400
catch this by just saying hey i'm

679
00:23:24,400 --> 00:23:26,400
looking at the protocol going over this

680
00:23:26,400 --> 00:23:29,120
port and it doesn't look like smb

681
00:23:29,120 --> 00:23:32,400
it looks like ssh that might have caught

682
00:23:32,400 --> 00:23:35,679
it at the process network data level

683
00:23:35,679 --> 00:23:37,919
on the host side the windows event logs

684
00:23:37,919 --> 00:23:39,760
and specifically what was scored in here

685
00:23:39,760 --> 00:23:42,320
was event 4672

686
00:23:42,320 --> 00:23:44,799
um that's you know that's that's where

687
00:23:44,799 --> 00:23:47,440
the participants found it in here

688
00:23:47,440 --> 00:23:50,240
again you can do it with ron um raw host

689
00:23:50,240 --> 00:23:51,520
and network

690
00:23:51,520 --> 00:23:53,679
there's lots you can do there again the

691
00:23:53,679 --> 00:23:55,520
same scout

692
00:23:55,520 --> 00:23:58,000
scaling issues apply but this is where

693
00:23:58,000 --> 00:23:59,039
details matter

694
00:23:59,039 --> 00:24:01,279
because you know this might be a weak

695
00:24:01,279 --> 00:24:03,279
signal where you're like hey i get a

696
00:24:03,279 --> 00:24:04,080
whole lot of

697
00:24:04,080 --> 00:24:07,200
app layer mismatches on my network side

698
00:24:07,200 --> 00:24:09,360
and in hindsight i can see okay yeah

699
00:24:09,360 --> 00:24:11,520
this was part of persistence

700
00:24:11,520 --> 00:24:14,000
but you have to be ready to deal with

701
00:24:14,000 --> 00:24:14,640
okay

702
00:24:14,640 --> 00:24:17,760
you know what's my threshold of dealing

703
00:24:17,760 --> 00:24:18,000
with

704
00:24:18,000 --> 00:24:20,240
app layer mismatches if i'm just using

705
00:24:20,240 --> 00:24:21,679
network security

706
00:24:21,679 --> 00:24:25,120
or if i'm using both or network data

707
00:24:25,120 --> 00:24:26,880
or if i'm using both network and host

708
00:24:26,880 --> 00:24:29,600
data i can say hey there's a mismatch

709
00:24:29,600 --> 00:24:31,360
and there's this really weird command

710
00:24:31,360 --> 00:24:33,200
line down here um

711
00:24:33,200 --> 00:24:36,080
you know that's that might be a more

712
00:24:36,080 --> 00:24:37,679
that might be a better threshold where

713
00:24:37,679 --> 00:24:41,440
you're like hey this clearly isn't right

714
00:24:42,080 --> 00:24:44,240
you know another example where details

715
00:24:44,240 --> 00:24:46,159
matter is when we got into collection

716
00:24:46,159 --> 00:24:47,760
and discovery or when you look at the

717
00:24:47,760 --> 00:24:48,320
collection

718
00:24:48,320 --> 00:24:51,039
discovery on here so again an attacker

719
00:24:51,039 --> 00:24:53,279
used a custom executable for a stealth

720
00:24:53,279 --> 00:24:55,320
scan on the network

721
00:24:55,320 --> 00:24:58,880
44818 is a port associated with rockwell

722
00:24:58,880 --> 00:25:01,600
for those not familiar with rockwell and

723
00:25:01,600 --> 00:25:03,600
what they were doing here was uh

724
00:25:03,600 --> 00:25:06,720
identifying devices talking enip

725
00:25:06,720 --> 00:25:09,360
which is the protocol that these devices

726
00:25:09,360 --> 00:25:11,279
talks they did this multiple hours to

727
00:25:11,279 --> 00:25:13,760
limit detection

728
00:25:13,760 --> 00:25:15,919
process network data right your baseline

729
00:25:15,919 --> 00:25:17,760
again going to the baseline threshold

730
00:25:17,760 --> 00:25:18,400
thing

731
00:25:18,400 --> 00:25:20,400
the baseline threshold might have helped

732
00:25:20,400 --> 00:25:22,480
you here

733
00:25:22,480 --> 00:25:24,880
the other interesting thing to point out

734
00:25:24,880 --> 00:25:25,600
here and

735
00:25:25,600 --> 00:25:28,080
a little trices knowledge and where

736
00:25:28,080 --> 00:25:29,039
mitre

737
00:25:29,039 --> 00:25:31,440
did a good job evaluating or uh

738
00:25:31,440 --> 00:25:33,760
emulating prices was uh the attackers

739
00:25:33,760 --> 00:25:34,080
did

740
00:25:34,080 --> 00:25:37,120
use uh what's called pi installer pi dxe

741
00:25:37,120 --> 00:25:39,039
basically it's a way to turn

742
00:25:39,039 --> 00:25:41,279
python scripts into cross-platform

743
00:25:41,279 --> 00:25:42,880
capable

744
00:25:42,880 --> 00:25:46,720
binaries you can if you look at the

745
00:25:46,720 --> 00:25:47,360
filed

746
00:25:47,360 --> 00:25:49,760
metadata going over the wire of how pi

747
00:25:49,760 --> 00:25:52,480
dxe and pi installer works

748
00:25:52,480 --> 00:25:54,480
there's you can there are yara rules and

749
00:25:54,480 --> 00:25:56,000
there are certain rules out

750
00:25:56,000 --> 00:25:58,400
there to look for these flying over the

751
00:25:58,400 --> 00:25:59,760
network so

752
00:25:59,760 --> 00:26:01,760
in dealing with this and process network

753
00:26:01,760 --> 00:26:02,880
data space that's

754
00:26:02,880 --> 00:26:05,760
definitely something to look for in a

755
00:26:05,760 --> 00:26:08,240
detail that certainly matters there

756
00:26:08,240 --> 00:26:11,200
on the hosts on the hosts data side

757
00:26:11,200 --> 00:26:11,840
again this

758
00:26:11,840 --> 00:26:14,559
is one to where command lines can be

759
00:26:14,559 --> 00:26:15,600
super important

760
00:26:15,600 --> 00:26:18,720
um you might do actually a baseline of

761
00:26:18,720 --> 00:26:22,279
command line deviations in this case if

762
00:26:22,279 --> 00:26:25,440
logixmaps.exe is an existing good

763
00:26:25,440 --> 00:26:27,440
binary and you know the command lines

764
00:26:27,440 --> 00:26:29,200
that are normally run with that

765
00:26:29,200 --> 00:26:32,159
if the command line changes and the

766
00:26:32,159 --> 00:26:34,559
network behavior changes

767
00:26:34,559 --> 00:26:36,159
you know that might be in a more

768
00:26:36,159 --> 00:26:38,000
advanced threshold

769
00:26:38,000 --> 00:26:40,720
that you decide to go out and look at it

770
00:26:40,720 --> 00:26:42,159
when you go down to the raw

771
00:26:42,159 --> 00:26:44,080
host and network data side we talked

772
00:26:44,080 --> 00:26:45,840
about yara for process

773
00:26:45,840 --> 00:26:47,600
this would be the same deal if you pull

774
00:26:47,600 --> 00:26:49,840
a hard drive in it or if you pull a disk

775
00:26:49,840 --> 00:26:51,440
image or if you

776
00:26:51,440 --> 00:26:53,200
pull files out of memory and start

777
00:26:53,200 --> 00:26:55,279
running yara against it

778
00:26:55,279 --> 00:26:57,600
you know if the process is running you

779
00:26:57,600 --> 00:26:58,880
might actually

780
00:26:58,880 --> 00:27:02,880
catch um you might catch this tactic

781
00:27:02,880 --> 00:27:06,159
um you know also in raw disk

782
00:27:06,159 --> 00:27:09,039
that way but this is another case where

783
00:27:09,039 --> 00:27:11,279
details really do matter because again

784
00:27:11,279 --> 00:27:12,159
it's

785
00:27:12,159 --> 00:27:14,559
you know here's a here's a binary that's

786
00:27:14,559 --> 00:27:15,440
named uh

787
00:27:15,440 --> 00:27:18,480
or binary name that i accept but wait

788
00:27:18,480 --> 00:27:20,399
it's pi installer where's pi installer

789
00:27:20,399 --> 00:27:20,880
used

790
00:27:20,880 --> 00:27:24,000
um there are vendors out there um

791
00:27:24,000 --> 00:27:25,600
there are industrial vendors that are

792
00:27:25,600 --> 00:27:27,919
using python um i don't know of many

793
00:27:27,919 --> 00:27:28,480
using

794
00:27:28,480 --> 00:27:31,760
pi installer or pi dxe at this point um

795
00:27:31,760 --> 00:27:34,159
and so that's where there is you know

796
00:27:34,159 --> 00:27:35,919
kind of those baselines or

797
00:27:35,919 --> 00:27:40,880
um d opportunities to apply detail to it

798
00:27:40,880 --> 00:27:44,159
as we move on um you know details at

799
00:27:44,159 --> 00:27:45,600
that network

800
00:27:45,600 --> 00:27:48,480
level don't just matter as we get into

801
00:27:48,480 --> 00:27:51,200
expanding access um here an attacker

802
00:27:51,200 --> 00:27:55,360
um you know did scp over 2223

803
00:27:55,360 --> 00:27:58,799
to move some tools um and then uh

804
00:27:58,799 --> 00:28:01,919
um yeah yeah and so when we talk about

805
00:28:01,919 --> 00:28:03,600
process network data

806
00:28:03,600 --> 00:28:06,799
our challenge here is going to be

807
00:28:06,799 --> 00:28:09,039
um the data's encrypted so there is the

808
00:28:09,039 --> 00:28:10,720
protocol mismatch again

809
00:28:10,720 --> 00:28:13,440
if you understand enough of the protocol

810
00:28:13,440 --> 00:28:16,720
going over port 2223 you might catch it

811
00:28:16,720 --> 00:28:18,240
that way you're not going to see the

812
00:28:18,240 --> 00:28:20,559
file contents so like the sarah cotton

813
00:28:20,559 --> 00:28:23,760
yar rule here won't work as much

814
00:28:23,760 --> 00:28:26,720
um on the process host data side and

815
00:28:26,720 --> 00:28:28,559
this was interesting to my

816
00:28:28,559 --> 00:28:31,200
to the attack eval there were a ton of

817
00:28:31,200 --> 00:28:32,559
file creation events

818
00:28:32,559 --> 00:28:34,880
i know hold on uh what you might be

819
00:28:34,880 --> 00:28:36,159
thinking on that

820
00:28:36,159 --> 00:28:38,559
um but file creation events are there

821
00:28:38,559 --> 00:28:40,080
and if you look through the results

822
00:28:40,080 --> 00:28:41,120
you'll see

823
00:28:41,120 --> 00:28:43,120
a lot of file creation events were

824
00:28:43,120 --> 00:28:45,600
created on the raw side you'll see a lot

825
00:28:45,600 --> 00:28:46,000
of

826
00:28:46,000 --> 00:28:49,600
or you could do this via file metadata

827
00:28:49,600 --> 00:28:51,600
let's go back to that file creation

828
00:28:51,600 --> 00:28:53,120
events um

829
00:28:53,120 --> 00:28:55,039
certainly depending on the size of your

830
00:28:55,039 --> 00:28:57,200
network and depending on the capability

831
00:28:57,200 --> 00:28:59,440
of your collection stack and your

832
00:28:59,440 --> 00:29:01,840
ability to analyze that

833
00:29:01,840 --> 00:29:03,919
file creation events are definitely

834
00:29:03,919 --> 00:29:05,120
interesting

835
00:29:05,120 --> 00:29:07,600
that being said you have to filter them

836
00:29:07,600 --> 00:29:09,039
because the next question

837
00:29:09,039 --> 00:29:12,799
on that is can you track every file and

838
00:29:12,799 --> 00:29:14,559
registry right to this system without

839
00:29:14,559 --> 00:29:15,760
being flooded

840
00:29:15,760 --> 00:29:19,279
um again certainly um

841
00:29:19,279 --> 00:29:21,360
it's it's valuable to bring those logs

842
00:29:21,360 --> 00:29:23,200
in it's certainly valuable to log those

843
00:29:23,200 --> 00:29:23,520
but

844
00:29:23,520 --> 00:29:26,000
you need to consider that those

845
00:29:26,000 --> 00:29:28,320
baselines and thresholds that you say

846
00:29:28,320 --> 00:29:30,480
hey wait this file right shouldn't

847
00:29:30,480 --> 00:29:33,120
happen here maybe it's a file right to

848
00:29:33,120 --> 00:29:35,919
um a weirdly named directory directory

849
00:29:35,919 --> 00:29:37,440
maybe it's a file right to something

850
00:29:37,440 --> 00:29:38,159
like c

851
00:29:38,159 --> 00:29:40,480
windows you know system32 that would

852
00:29:40,480 --> 00:29:42,000
definitely be

853
00:29:42,000 --> 00:29:45,520
potentially a weird file right um but

854
00:29:45,520 --> 00:29:47,120
you know context things like that

855
00:29:47,120 --> 00:29:50,559
because tracking every file and registry

856
00:29:50,559 --> 00:29:51,039
right

857
00:29:51,039 --> 00:29:52,640
won't scale you're going to flood

858
00:29:52,640 --> 00:29:55,679
yourself out with that

859
00:29:55,679 --> 00:29:59,120
where where you know what is important

860
00:29:59,120 --> 00:30:01,360
is and we've said this a few times

861
00:30:01,360 --> 00:30:02,399
throughout

862
00:30:02,399 --> 00:30:04,720
you know as you as you turn up your

863
00:30:04,720 --> 00:30:06,880
automation and as you

864
00:30:06,880 --> 00:30:10,080
dig your baselines deeper

865
00:30:10,080 --> 00:30:12,159
you know you're going to need context to

866
00:30:12,159 --> 00:30:16,000
scale scale requires context

867
00:30:16,000 --> 00:30:18,240
some of this can be done on the industry

868
00:30:18,240 --> 00:30:19,600
level some of this

869
00:30:19,600 --> 00:30:21,520
might be done specific down to your

870
00:30:21,520 --> 00:30:23,039
plant level but

871
00:30:23,039 --> 00:30:25,679
at the end of the day to scale this and

872
00:30:25,679 --> 00:30:27,679
to really detect

873
00:30:27,679 --> 00:30:29,919
sophisticated adversary like was seen in

874
00:30:29,919 --> 00:30:31,279
trisys in this

875
00:30:31,279 --> 00:30:36,399
that scale is going to require context

876
00:30:36,399 --> 00:30:39,520
and and even that that context might not

877
00:30:39,520 --> 00:30:40,399
just be

878
00:30:40,399 --> 00:30:43,120
technical context so as we moved into

879
00:30:43,120 --> 00:30:44,960
infecting the safety system control

880
00:30:44,960 --> 00:30:45,760
logic

881
00:30:45,760 --> 00:30:49,200
um in this case um you know an adversary

882
00:30:49,200 --> 00:30:52,799
initiated a program upload action um

883
00:30:52,799 --> 00:30:55,440
and for those not familiar program

884
00:30:55,440 --> 00:30:57,679
uploads and downloads are actually

885
00:30:57,679 --> 00:31:00,320
um a little counter-intuitive to people

886
00:31:00,320 --> 00:31:01,679
first in the industry so an

887
00:31:01,679 --> 00:31:04,080
upload is actually going from a

888
00:31:04,080 --> 00:31:06,159
programmable logic device to your

889
00:31:06,159 --> 00:31:07,519
computer

890
00:31:07,519 --> 00:31:09,200
in the challenge you can see here they

891
00:31:09,200 --> 00:31:11,200
did it between the safety plc and the

892
00:31:11,200 --> 00:31:14,240
safety ews

893
00:31:14,240 --> 00:31:16,640
download is actually pushing the program

894
00:31:16,640 --> 00:31:18,159
logic from the

895
00:31:18,159 --> 00:31:20,480
engineering workstation is what an ews

896
00:31:20,480 --> 00:31:22,559
is it's pushing it from the engineering

897
00:31:22,559 --> 00:31:23,919
downloads pushing the engineering

898
00:31:23,919 --> 00:31:26,159
workstation to the programmable logic

899
00:31:26,159 --> 00:31:27,840
controller

900
00:31:27,840 --> 00:31:30,320
in this case right we have two boxes

901
00:31:30,320 --> 00:31:31,200
that

902
00:31:31,200 --> 00:31:33,120
should be communicating this really

903
00:31:33,120 --> 00:31:35,919
right so the the engineering workstation

904
00:31:35,919 --> 00:31:38,159
it's probably in the established

905
00:31:38,159 --> 00:31:40,320
threshold that it should be talking to a

906
00:31:40,320 --> 00:31:41,600
plc

907
00:31:41,600 --> 00:31:44,480
um so in process network data you're

908
00:31:44,480 --> 00:31:47,120
going to see this file upload

909
00:31:47,120 --> 00:31:49,039
at least in this case you will so this

910
00:31:49,039 --> 00:31:50,240
use the the

911
00:31:50,240 --> 00:31:53,360
protocol rockwell uses is called sip

912
00:31:53,360 --> 00:31:55,600
sip you can buy this spec there's also

913
00:31:55,600 --> 00:31:57,600
versions of the spec that float around

914
00:31:57,600 --> 00:31:58,799
the internet

915
00:31:58,799 --> 00:32:01,440
this is a known protocol not all devices

916
00:32:01,440 --> 00:32:03,120
will you know the protocols

917
00:32:03,120 --> 00:32:05,840
used for file uploads some of the

918
00:32:05,840 --> 00:32:08,559
advantages of some of the vendors is

919
00:32:08,559 --> 00:32:10,559
they do actually dissect some of these

920
00:32:10,559 --> 00:32:12,720
very proprietary protocols a lot of the

921
00:32:12,720 --> 00:32:13,760
major

922
00:32:13,760 --> 00:32:16,320
vendors do have support on this but you

923
00:32:16,320 --> 00:32:17,760
know you might see

924
00:32:17,760 --> 00:32:20,240
on process network data you might see

925
00:32:20,240 --> 00:32:22,480
evidence of the proprietary file upload

926
00:32:22,480 --> 00:32:23,279
command

927
00:32:23,279 --> 00:32:25,120
um in this case again it might not

928
00:32:25,120 --> 00:32:28,080
trigger a threshold because these are

929
00:32:28,080 --> 00:32:30,720
computers that should talk it um you

930
00:32:30,720 --> 00:32:31,440
know but

931
00:32:31,440 --> 00:32:33,279
maybe you have multiple thresholds maybe

932
00:32:33,279 --> 00:32:34,720
this happened in the middle of the night

933
00:32:34,720 --> 00:32:36,320
when engineers aren't there maybe you're

934
00:32:36,320 --> 00:32:39,440
doing more correlation on there

935
00:32:39,440 --> 00:32:41,919
where this is also helpful can again be

936
00:32:41,919 --> 00:32:43,679
in where people are scoring on this and

937
00:32:43,679 --> 00:32:44,399
the challenge

938
00:32:44,399 --> 00:32:46,080
is the windows event logs with the

939
00:32:46,080 --> 00:32:48,320
process information

940
00:32:48,320 --> 00:32:50,159
and when you get down into this some of

941
00:32:50,159 --> 00:32:51,360
this does

942
00:32:51,360 --> 00:32:53,200
begin to get into getting into packet

943
00:32:53,200 --> 00:32:56,320
captures with the industrial traffic

944
00:32:56,320 --> 00:32:58,399
this does you know depending on the

945
00:32:58,399 --> 00:32:59,760
protocol again

946
00:32:59,760 --> 00:33:01,600
you might need reverse engineering

947
00:33:01,600 --> 00:33:03,679
skills you might need to

948
00:33:03,679 --> 00:33:05,279
figure out what the protocol actually

949
00:33:05,279 --> 00:33:07,519
looks for and do things like riding a

950
00:33:07,519 --> 00:33:10,720
lua or um you know a lewis dissector for

951
00:33:10,720 --> 00:33:12,240
wireshark or other things if you're

952
00:33:12,240 --> 00:33:13,679
trying to do this manually

953
00:33:13,679 --> 00:33:16,799
um but in this case too the point to

954
00:33:16,799 --> 00:33:18,000
prove here is outside

955
00:33:18,000 --> 00:33:20,799
validation might be required an easier

956
00:33:20,799 --> 00:33:22,720
thing is to just say

957
00:33:22,720 --> 00:33:24,799
hey engineering team we saw a program

958
00:33:24,799 --> 00:33:26,000
upload go between

959
00:33:26,000 --> 00:33:28,480
you know this is kind of weird you know

960
00:33:28,480 --> 00:33:29,200
with or

961
00:33:29,200 --> 00:33:30,880
you know we thought this was kind of

962
00:33:30,880 --> 00:33:32,640
weird did you do this

963
00:33:32,640 --> 00:33:34,799
um and you can say and they might say oh

964
00:33:34,799 --> 00:33:36,720
well no we weren't there

965
00:33:36,720 --> 00:33:38,240
and you can double check that with you

966
00:33:38,240 --> 00:33:40,720
know closed circuit tv if it's if it's a

967
00:33:40,720 --> 00:33:42,159
monitored site

968
00:33:42,159 --> 00:33:44,399
um you know door access readers you

969
00:33:44,399 --> 00:33:45,600
could do it actually with the windows

970
00:33:45,600 --> 00:33:47,200
event logs of who

971
00:33:47,200 --> 00:33:49,440
who logged in when and trace it down if

972
00:33:49,440 --> 00:33:51,840
someone on vacation did it um

973
00:33:51,840 --> 00:33:53,279
and you know either their accounts

974
00:33:53,279 --> 00:33:55,440
compromised or it's not them

975
00:33:55,440 --> 00:33:57,760
but the point here is outside validation

976
00:33:57,760 --> 00:33:59,760
might be required to

977
00:33:59,760 --> 00:34:03,039
prove these out with certainty

978
00:34:03,039 --> 00:34:05,760
um you know moving into the last two

979
00:34:05,760 --> 00:34:07,840
steps of what we'll talk about today

980
00:34:07,840 --> 00:34:10,800
um protocol depth doesn't matter until

981
00:34:10,800 --> 00:34:11,520
it does

982
00:34:11,520 --> 00:34:13,440
and when we get into the disabling the

983
00:34:13,440 --> 00:34:16,000
safety function again we are in

984
00:34:16,000 --> 00:34:19,040
very specific operations very specific

985
00:34:19,040 --> 00:34:22,879
tags or data fields within the device

986
00:34:22,879 --> 00:34:24,800
in process network data when we're

987
00:34:24,800 --> 00:34:26,079
dealing with

988
00:34:26,079 --> 00:34:28,159
you know in this case it's an adversary

989
00:34:28,159 --> 00:34:29,599
initiating a right tag

990
00:34:29,599 --> 00:34:31,199
action they're writing to a very

991
00:34:31,199 --> 00:34:32,879
specific

992
00:34:32,879 --> 00:34:35,119
part pardon memory of that device with a

993
00:34:35,119 --> 00:34:36,239
very specific

994
00:34:36,239 --> 00:34:39,440
value to get down to this level um

995
00:34:39,440 --> 00:34:42,159
you have to do deep packet inspection of

996
00:34:42,159 --> 00:34:42,960
the protocol

997
00:34:42,960 --> 00:34:45,520
in this case it was a sip and ethernet

998
00:34:45,520 --> 00:34:46,399
ip

999
00:34:46,399 --> 00:34:49,839
um again it's important to understand um

1000
00:34:49,839 --> 00:34:51,839
the protocols in your environment and

1001
00:34:51,839 --> 00:34:54,320
what um you actually have visibility

1002
00:34:54,320 --> 00:34:54,960
over because

1003
00:34:54,960 --> 00:34:57,280
even if you take a big product line like

1004
00:34:57,280 --> 00:35:00,560
a you know honeywell experience like uh

1005
00:35:00,560 --> 00:35:03,359
emerson delta v or mrs innovation

1006
00:35:03,359 --> 00:35:04,880
there's a lot of protocols

1007
00:35:04,880 --> 00:35:07,920
and so just saying like hey we cover

1008
00:35:07,920 --> 00:35:09,760
we cover this product line no you need

1009
00:35:09,760 --> 00:35:11,280
to know like hey

1010
00:35:11,280 --> 00:35:13,200
does this product line is this product

1011
00:35:13,200 --> 00:35:14,880
line the one that does my program

1012
00:35:14,880 --> 00:35:16,880
uploads is this product line

1013
00:35:16,880 --> 00:35:19,440
you know or yeah is this protocol the

1014
00:35:19,440 --> 00:35:20,800
one that does my

1015
00:35:20,800 --> 00:35:23,680
program uploads is this protocol the one

1016
00:35:23,680 --> 00:35:26,240
that's writing tags to the device um

1017
00:35:26,240 --> 00:35:27,920
and even what's enabled on the device

1018
00:35:27,920 --> 00:35:30,079
right so you know i've worked with

1019
00:35:30,079 --> 00:35:31,520
devices to wear both

1020
00:35:31,520 --> 00:35:34,480
enip was enabled and modbus so you know

1021
00:35:34,480 --> 00:35:36,400
even if you're watching enop over here i

1022
00:35:36,400 --> 00:35:38,320
can do it via modbus over here and if

1023
00:35:38,320 --> 00:35:39,680
you're not watching you're not going to

1024
00:35:39,680 --> 00:35:40,480
see it

1025
00:35:40,480 --> 00:35:43,119
um so understanding the deep packet

1026
00:35:43,119 --> 00:35:44,160
inspection to

1027
00:35:44,160 --> 00:35:47,040
understand these rights to tags is very

1028
00:35:47,040 --> 00:35:48,880
very very important

1029
00:35:48,880 --> 00:35:51,920
this is a case where host data

1030
00:35:51,920 --> 00:35:53,760
a process host data isn't going to help

1031
00:35:53,760 --> 00:35:55,040
you so

1032
00:35:55,040 --> 00:35:56,720
some of the vendors do use the

1033
00:35:56,720 --> 00:35:58,640
application logs if they use the windows

1034
00:35:58,640 --> 00:35:59,920
api for logging

1035
00:35:59,920 --> 00:36:02,160
you might be able to go into the windows

1036
00:36:02,160 --> 00:36:03,119
event logs

1037
00:36:03,119 --> 00:36:05,760
into the application log or um into the

1038
00:36:05,760 --> 00:36:08,000
logs they write to and find that

1039
00:36:08,000 --> 00:36:10,079
you can certainly do this with raw data

1040
00:36:10,079 --> 00:36:12,160
but or with raw

1041
00:36:12,160 --> 00:36:14,240
packet capture but again you're going to

1042
00:36:14,240 --> 00:36:16,320
need um

1043
00:36:16,320 --> 00:36:18,079
to either have a dissector to have a

1044
00:36:18,079 --> 00:36:20,480
little bit of reverse engineering skills

1045
00:36:20,480 --> 00:36:23,680
um depending um on the protocol and how

1046
00:36:23,680 --> 00:36:25,359
the tool was written

1047
00:36:25,359 --> 00:36:29,040
but protocol depth does matter

1048
00:36:29,040 --> 00:36:31,040
uh finally the last one that we'll talk

1049
00:36:31,040 --> 00:36:33,200
about is really the last step

1050
00:36:33,200 --> 00:36:35,520
when you were looking at the ics eval

1051
00:36:35,520 --> 00:36:38,560
this was on a burner management network

1052
00:36:38,560 --> 00:36:40,320
these tag rights towards the end is

1053
00:36:40,320 --> 00:36:43,280
actually how mitre was emulating the

1054
00:36:43,280 --> 00:36:46,640
um effect on target phase of this

1055
00:36:46,640 --> 00:36:50,560
um towards the end there was another um

1056
00:36:50,560 --> 00:36:52,640
group of tag rights that happened um

1057
00:36:52,640 --> 00:36:54,880
very specific changes to the

1058
00:36:54,880 --> 00:36:57,599
devices what we see here is air damper

1059
00:36:57,599 --> 00:36:58,720
settings and

1060
00:36:58,720 --> 00:37:01,599
cascade control removal again process

1061
00:37:01,599 --> 00:37:02,480
network data

1062
00:37:02,480 --> 00:37:05,599
shines here assuming you have that

1063
00:37:05,599 --> 00:37:06,320
deepak and

1064
00:37:06,320 --> 00:37:09,040
inspection and you can see the tag data

1065
00:37:09,040 --> 00:37:09,520
and

1066
00:37:09,520 --> 00:37:11,200
you know what's interesting when you go

1067
00:37:11,200 --> 00:37:12,800
through the uh miter

1068
00:37:12,800 --> 00:37:15,520
eval results on their site miter does

1069
00:37:15,520 --> 00:37:17,599
include these screenshots of what

1070
00:37:17,599 --> 00:37:19,680
the vendors showed in their uh in their

1071
00:37:19,680 --> 00:37:21,520
uis

1072
00:37:21,520 --> 00:37:23,119
and you know it's definitely interesting

1073
00:37:23,119 --> 00:37:24,960
because one of the things you can do is

1074
00:37:24,960 --> 00:37:26,240
see hey well

1075
00:37:26,240 --> 00:37:29,119
what vendors were actually able to see

1076
00:37:29,119 --> 00:37:31,119
the values that were written in and the

1077
00:37:31,119 --> 00:37:33,359
tag names that they were written to

1078
00:37:33,359 --> 00:37:35,440
um you know that's that's definitely

1079
00:37:35,440 --> 00:37:36,960
something when you look at mitre to

1080
00:37:36,960 --> 00:37:38,240
consider to do

1081
00:37:38,240 --> 00:37:39,760
or if you're just doing your own

1082
00:37:39,760 --> 00:37:42,000
evaluation or process um

1083
00:37:42,000 --> 00:37:44,000
but in this case even if you're not

1084
00:37:44,000 --> 00:37:45,680
evaluating a product

1085
00:37:45,680 --> 00:37:48,640
um to see this type of impact um you're

1086
00:37:48,640 --> 00:37:50,079
going to need to go down here so

1087
00:37:50,079 --> 00:37:52,000
if if you're doing it yourself it's

1088
00:37:52,000 --> 00:37:53,920
still important to say okay

1089
00:37:53,920 --> 00:37:56,079
with whatever i'm home rolling to do

1090
00:37:56,079 --> 00:37:59,599
this i need to be ready to do this um

1091
00:37:59,599 --> 00:38:01,520
you could also do this with static and

1092
00:38:01,520 --> 00:38:03,440
dynamic analysis as you're going through

1093
00:38:03,440 --> 00:38:05,200
stuff so throw it in the same box throw

1094
00:38:05,200 --> 00:38:07,520
it on your digital twin or range or if

1095
00:38:07,520 --> 00:38:09,520
you have a device

1096
00:38:09,520 --> 00:38:12,240
but protocol depth at this point really

1097
00:38:12,240 --> 00:38:12,800
does

1098
00:38:12,800 --> 00:38:16,000
um matter and at first you might not say

1099
00:38:16,000 --> 00:38:16,640
well

1100
00:38:16,640 --> 00:38:18,160
you know why would i care about this

1101
00:38:18,160 --> 00:38:20,640
specific tag and again this goes back to

1102
00:38:20,640 --> 00:38:21,680
filtering well

1103
00:38:21,680 --> 00:38:23,440
i'm going to filter out tag names

1104
00:38:23,440 --> 00:38:25,520
because that's like if i track every tag

1105
00:38:25,520 --> 00:38:27,280
there's no way i'll store this

1106
00:38:27,280 --> 00:38:29,520
that's right and you know that's right

1107
00:38:29,520 --> 00:38:31,200
to a point it's right to the point to

1108
00:38:31,200 --> 00:38:33,119
where you need it like in this case

1109
00:38:33,119 --> 00:38:33,839
where

1110
00:38:33,839 --> 00:38:35,680
you know the protocol depth does start

1111
00:38:35,680 --> 00:38:38,160
to matter

1112
00:38:38,640 --> 00:38:40,560
you know something we want to wrap up

1113
00:38:40,560 --> 00:38:42,160
and something you know i want you to

1114
00:38:42,160 --> 00:38:43,280
leave with with this

1115
00:38:43,280 --> 00:38:46,720
is when you look at the ics attack valve

1116
00:38:46,720 --> 00:38:49,040
it's really easy to enter this with

1117
00:38:49,040 --> 00:38:50,880
hindsight bias and you know

1118
00:38:50,880 --> 00:38:53,359
kahneman quote hindsight bias makes

1119
00:38:53,359 --> 00:38:55,200
surprises vanish

1120
00:38:55,200 --> 00:38:56,880
what you see here on the right of the

1121
00:38:56,880 --> 00:38:59,599
slide is the scada system faults

1122
00:38:59,599 --> 00:39:02,160
at marucci shire so that sewage plant

1123
00:39:02,160 --> 00:39:02,960
that

1124
00:39:02,960 --> 00:39:05,839
overflowed um in a normal state so

1125
00:39:05,839 --> 00:39:07,440
before those february

1126
00:39:07,440 --> 00:39:10,320
before the january february sites this

1127
00:39:10,320 --> 00:39:11,760
site had about two

1128
00:39:11,760 --> 00:39:15,839
two to four alarms a day was the average

1129
00:39:15,839 --> 00:39:19,359
when the insider started um the wireless

1130
00:39:19,359 --> 00:39:21,440
attack they went from

1131
00:39:21,440 --> 00:39:24,640
two to four events a day you know up

1132
00:39:24,640 --> 00:39:25,359
into 10

1133
00:39:25,359 --> 00:39:28,079
15 20 you know you see a spike over 40

1134
00:39:28,079 --> 00:39:28,720
there

1135
00:39:28,720 --> 00:39:31,280
in addition they were having pumps that

1136
00:39:31,280 --> 00:39:32,560
weren't turning on

1137
00:39:32,560 --> 00:39:34,880
they were having pumps that are pumps

1138
00:39:34,880 --> 00:39:36,480
not turning on when they should they

1139
00:39:36,480 --> 00:39:37,680
have pumps

1140
00:39:37,680 --> 00:39:39,680
um you know they were turning on when

1141
00:39:39,680 --> 00:39:41,440
they shouldn't there was a lot of

1142
00:39:41,440 --> 00:39:42,079
weirdness

1143
00:39:42,079 --> 00:39:44,880
um and if you look in there this unknown

1144
00:39:44,880 --> 00:39:46,960
system faults are red and it's about

1145
00:39:46,960 --> 00:39:47,359
from

1146
00:39:47,359 --> 00:39:50,880
january to the end of april all of that

1147
00:39:50,880 --> 00:39:53,200
time there was a lot of weird going on

1148
00:39:53,200 --> 00:39:55,440
and there wasn't this correlation

1149
00:39:55,440 --> 00:39:58,160
um that this was that this was an

1150
00:39:58,160 --> 00:39:59,520
insider that was uh

1151
00:39:59,520 --> 00:40:01,280
you know connecting in and causing these

1152
00:40:01,280 --> 00:40:03,359
faults on there um

1153
00:40:03,359 --> 00:40:06,240
only when did only when that operator

1154
00:40:06,240 --> 00:40:07,839
started getting suspicious

1155
00:40:07,839 --> 00:40:10,560
and getting in that knife fight um you

1156
00:40:10,560 --> 00:40:13,200
know were they able to say okay well

1157
00:40:13,200 --> 00:40:14,880
we know this guy we know he has the

1158
00:40:14,880 --> 00:40:17,520
knowledge ultimately they ended up um

1159
00:40:17,520 --> 00:40:19,440
you know suspecting it was that guy they

1160
00:40:19,440 --> 00:40:21,280
hired private investigators to

1161
00:40:21,280 --> 00:40:23,839
follow him they found out he was

1162
00:40:23,839 --> 00:40:24,880
actually park near

1163
00:40:24,880 --> 00:40:26,560
sites uh they sent the police and

1164
00:40:26,560 --> 00:40:28,880
arrested him found the stuff in his car

1165
00:40:28,880 --> 00:40:31,599
um he was sentenced i think to two years

1166
00:40:31,599 --> 00:40:32,720
in jail and

1167
00:40:32,720 --> 00:40:36,400
like a 13 or 15 000 fine um

1168
00:40:36,400 --> 00:40:38,960
but you know it's a prime example of

1169
00:40:38,960 --> 00:40:41,119
it's easy in hindsight bias to say oh

1170
00:40:41,119 --> 00:40:42,880
well yeah my threshold would have been

1171
00:40:42,880 --> 00:40:43,520
there

1172
00:40:43,520 --> 00:40:46,160
um but in cases like this um you know it

1173
00:40:46,160 --> 00:40:48,000
really was the operator that saved the

1174
00:40:48,000 --> 00:40:48,960
day

1175
00:40:48,960 --> 00:40:52,720
and it was a non a non-um

1176
00:40:52,720 --> 00:40:56,400
you know a non-technical um

1177
00:40:56,400 --> 00:40:58,480
it was a non-technical trigger that even

1178
00:40:58,480 --> 00:40:59,520
caused

1179
00:40:59,520 --> 00:41:02,160
um you know the due diligence to look at

1180
00:41:02,160 --> 00:41:04,480
that it's important to consider as you

1181
00:41:04,480 --> 00:41:06,160
look across this

1182
00:41:06,160 --> 00:41:08,720
where um you know those alerts might

1183
00:41:08,720 --> 00:41:10,720
come in

1184
00:41:10,720 --> 00:41:12,560
and where those alerts that actually get

1185
00:41:12,560 --> 00:41:14,560
you to

1186
00:41:14,560 --> 00:41:17,040
you know figuring out where the event

1187
00:41:17,040 --> 00:41:19,440
starts and how to respond to it

1188
00:41:19,440 --> 00:41:20,960
all of this at the end of the day the

1189
00:41:20,960 --> 00:41:23,119
success depends on detection of the

1190
00:41:23,119 --> 00:41:24,480
chain of events um

1191
00:41:24,480 --> 00:41:26,400
you know you might say well you know

1192
00:41:26,400 --> 00:41:28,160
we'll start with network because with

1193
00:41:28,160 --> 00:41:30,000
network i just have to find one of the

1194
00:41:30,000 --> 00:41:31,359
links of the chain

1195
00:41:31,359 --> 00:41:33,599
and that's true you might find some of

1196
00:41:33,599 --> 00:41:35,359
the links that chain just going network

1197
00:41:35,359 --> 00:41:37,040
you might find some of the links of the

1198
00:41:37,040 --> 00:41:39,599
chain just going disk

1199
00:41:39,599 --> 00:41:41,920
but you have to have enough of the chain

1200
00:41:41,920 --> 00:41:43,359
of events

1201
00:41:43,359 --> 00:41:46,800
to properly isolate to properly contain

1202
00:41:46,800 --> 00:41:50,240
and eradicate um because if you don't um

1203
00:41:50,240 --> 00:41:52,160
you know ultimately you won't actually

1204
00:41:52,160 --> 00:41:53,839
secure your network on that

1205
00:41:53,839 --> 00:41:56,720
um and the correlation of events right

1206
00:41:56,720 --> 00:41:57,119
um

1207
00:41:57,119 --> 00:41:58,880
if you can't correlate events together

1208
00:41:58,880 --> 00:42:01,040
like we saw there were multiple steps

1209
00:42:01,040 --> 00:42:02,160
where both

1210
00:42:02,160 --> 00:42:05,200
post and network data was needed if you

1211
00:42:05,200 --> 00:42:07,119
can't correlate you're really going to

1212
00:42:07,119 --> 00:42:09,359
struggle

1213
00:42:09,359 --> 00:42:11,280
the right data is going to put the

1214
00:42:11,280 --> 00:42:13,520
dumpster fire out quicker and i put

1215
00:42:13,520 --> 00:42:15,359
right in quotes

1216
00:42:15,359 --> 00:42:17,359
because like right there's no solid

1217
00:42:17,359 --> 00:42:19,119
definition to what the right data is

1218
00:42:19,119 --> 00:42:20,480
there's a lot of difference between

1219
00:42:20,480 --> 00:42:21,440
networks between

1220
00:42:21,440 --> 00:42:25,520
plants but not having the right data can

1221
00:42:25,520 --> 00:42:26,640
limit your detection

1222
00:42:26,640 --> 00:42:30,319
entirely um you know if you if you don't

1223
00:42:30,319 --> 00:42:31,920
have the data like you can't

1224
00:42:31,920 --> 00:42:34,240
you can't collect data from the past

1225
00:42:34,240 --> 00:42:35,760
that you didn't collect before

1226
00:42:35,760 --> 00:42:38,400
um you might have some metadata or other

1227
00:42:38,400 --> 00:42:40,079
options um but

1228
00:42:40,079 --> 00:42:43,359
i mean um you can't go back in the past

1229
00:42:43,359 --> 00:42:44,079
and get data

1230
00:42:44,079 --> 00:42:46,720
you never got so it's really important

1231
00:42:46,720 --> 00:42:48,640
to consider both the host and network

1232
00:42:48,640 --> 00:42:51,280
data that you use as you go across

1233
00:42:51,280 --> 00:42:53,119
how you can improve your success

1234
00:42:53,119 --> 00:42:54,560
conditions we

1235
00:42:54,560 --> 00:42:56,640
offer kind of six steps or six

1236
00:42:56,640 --> 00:42:58,560
recommendations for that

1237
00:42:58,560 --> 00:42:59,760
you know what do you know about your

1238
00:42:59,760 --> 00:43:01,280
environment and your visibility how

1239
00:43:01,280 --> 00:43:03,520
reliant are you on host only or network

1240
00:43:03,520 --> 00:43:05,119
only how deep are you going in the

1241
00:43:05,119 --> 00:43:06,960
protocols how do you know your

1242
00:43:06,960 --> 00:43:08,960
devices how they behave how your

1243
00:43:08,960 --> 00:43:11,760
operators work in the plant

1244
00:43:11,760 --> 00:43:14,000
understanding the people process the

1245
00:43:14,000 --> 00:43:16,240
technology the full scope of everything

1246
00:43:16,240 --> 00:43:16,720
you do

1247
00:43:16,720 --> 00:43:19,359
is really important because it's really

1248
00:43:19,359 --> 00:43:21,200
hard to set good baselines if you don't

1249
00:43:21,200 --> 00:43:23,200
understand yourself

1250
00:43:23,200 --> 00:43:25,520
and you know you can work with you know

1251
00:43:25,520 --> 00:43:27,040
you can work with a lot of people to try

1252
00:43:27,040 --> 00:43:27,839
to do it but

1253
00:43:27,839 --> 00:43:29,440
ultimately you're going to know more

1254
00:43:29,440 --> 00:43:32,640
about yourself than they will

1255
00:43:32,640 --> 00:43:34,079
and then it goes into constantly

1256
00:43:34,079 --> 00:43:36,800
improving right so how quickly

1257
00:43:36,800 --> 00:43:38,880
can you dig into those data sources if

1258
00:43:38,880 --> 00:43:40,160
you need to

1259
00:43:40,160 --> 00:43:41,839
and if you find out you can't dig into

1260
00:43:41,839 --> 00:43:43,440
those quickly you need to go back and do

1261
00:43:43,440 --> 00:43:44,079
it

1262
00:43:44,079 --> 00:43:47,920
or figure out how to solve that um if

1263
00:43:47,920 --> 00:43:50,000
if going through the miter ics eval

1264
00:43:50,000 --> 00:43:51,359
results um

1265
00:43:51,359 --> 00:43:53,280
you know you say oh yeah we would not

1266
00:43:53,280 --> 00:43:55,119
have seen that or hey you know there's

1267
00:43:55,119 --> 00:43:56,560
good opportunities here

1268
00:43:56,560 --> 00:43:59,520
um definitely use those preparation

1269
00:43:59,520 --> 00:44:01,200
level things to

1270
00:44:01,200 --> 00:44:02,960
improve before the event actually

1271
00:44:02,960 --> 00:44:05,440
happens redundant sources right

1272
00:44:05,440 --> 00:44:08,079
so you know we talked about host logs

1273
00:44:08,079 --> 00:44:09,760
the risk being that someone can mess

1274
00:44:09,760 --> 00:44:10,960
with them but

1275
00:44:10,960 --> 00:44:12,800
you know you need to have redundant data

1276
00:44:12,800 --> 00:44:14,640
sources to have that failure margin

1277
00:44:14,640 --> 00:44:17,040
um you know i've been multiple places to

1278
00:44:17,040 --> 00:44:18,000
where

1279
00:44:18,000 --> 00:44:20,079
during an incident or before an incident

1280
00:44:20,079 --> 00:44:21,040
someone

1281
00:44:21,040 --> 00:44:23,119
you know lost their entire splunk stack

1282
00:44:23,119 --> 00:44:25,040
or they lost their entire seam

1283
00:44:25,040 --> 00:44:27,920
um you know if you lose your entire seam

1284
00:44:27,920 --> 00:44:29,359
or if you lose a part

1285
00:44:29,359 --> 00:44:31,200
of what you're responding with or what

1286
00:44:31,200 --> 00:44:33,040
your visibility is

1287
00:44:33,040 --> 00:44:35,280
you know if you lose enough visibility

1288
00:44:35,280 --> 00:44:37,200
or network you need to address that you

1289
00:44:37,200 --> 00:44:39,599
need to have situational awareness

1290
00:44:39,599 --> 00:44:42,240
even through a failure margin the

1291
00:44:42,240 --> 00:44:42,800
process

1292
00:44:42,800 --> 00:44:45,520
side is designed for failure to a point

1293
00:44:45,520 --> 00:44:47,680
you need to design your security side

1294
00:44:47,680 --> 00:44:48,000
for

1295
00:44:48,000 --> 00:44:50,480
failure collecting the right data like

1296
00:44:50,480 --> 00:44:52,000
we said you need to understand your

1297
00:44:52,000 --> 00:44:54,400
collection limits um

1298
00:44:54,400 --> 00:44:56,640
you know you might not be able to you

1299
00:44:56,640 --> 00:44:58,240
might have

1300
00:44:58,240 --> 00:45:00,960
a very high throughput bandwidth channel

1301
00:45:00,960 --> 00:45:02,480
you might have

1302
00:45:02,480 --> 00:45:04,560
um you know collection challenges

1303
00:45:04,560 --> 00:45:06,079
because it's out in the field and you

1304
00:45:06,079 --> 00:45:08,480
can only use rugged options that don't

1305
00:45:08,480 --> 00:45:10,480
that limit the uh processing or

1306
00:45:10,480 --> 00:45:12,400
collection power you have

1307
00:45:12,400 --> 00:45:15,040
you need to understand what right data

1308
00:45:15,040 --> 00:45:16,319
is for you

1309
00:45:16,319 --> 00:45:18,640
both for how you analyze data and for

1310
00:45:18,640 --> 00:45:21,119
the realities of your operations

1311
00:45:21,119 --> 00:45:22,640
um you need to understand your tool

1312
00:45:22,640 --> 00:45:24,560
limits so you know

1313
00:45:24,560 --> 00:45:27,680
how you use your products right you know

1314
00:45:27,680 --> 00:45:29,440
every product's great when it's getting

1315
00:45:29,440 --> 00:45:30,880
sold to you but how are you

1316
00:45:30,880 --> 00:45:33,119
actually using that for analysis and how

1317
00:45:33,119 --> 00:45:34,800
does that make you better and fit in

1318
00:45:34,800 --> 00:45:36,720
that overall strategy

1319
00:45:36,720 --> 00:45:38,880
and then challenging your status quo

1320
00:45:38,880 --> 00:45:41,440
right look at your baselines constantly

1321
00:45:41,440 --> 00:45:43,119
validate them and check them you know

1322
00:45:43,119 --> 00:45:46,400
use you know tabletop exercises use red

1323
00:45:46,400 --> 00:45:48,160
team assessments use

1324
00:45:48,160 --> 00:45:50,800
you know um use the smart operators i

1325
00:45:50,800 --> 00:45:52,640
mean we've had cases to where

1326
00:45:52,640 --> 00:45:54,640
we've worked with customers and talked

1327
00:45:54,640 --> 00:45:56,319
with them um

1328
00:45:56,319 --> 00:45:58,880
and you know just in a conversation with

1329
00:45:58,880 --> 00:46:01,280
a customer on being like well how would

1330
00:46:01,280 --> 00:46:02,720
you do this you know

1331
00:46:02,720 --> 00:46:05,040
the whole chain of events and the whole

1332
00:46:05,040 --> 00:46:06,720
chain of success starts with a

1333
00:46:06,720 --> 00:46:08,640
five-minute conversation because they

1334
00:46:08,640 --> 00:46:09,440
know

1335
00:46:09,440 --> 00:46:11,359
what the status quo of the environment

1336
00:46:11,359 --> 00:46:13,839
is better always challenge the status

1337
00:46:13,839 --> 00:46:14,880
quo both

1338
00:46:14,880 --> 00:46:17,200
you know of your technical um you know

1339
00:46:17,200 --> 00:46:18,160
of your

1340
00:46:18,160 --> 00:46:19,839
you know technical stack but also your

1341
00:46:19,839 --> 00:46:23,520
baselines and how you do things

1342
00:46:23,520 --> 00:46:26,079
so the takeaway here preparation matters

1343
00:46:26,079 --> 00:46:28,560
so it's not a panacea it does accelerate

1344
00:46:28,560 --> 00:46:29,920
response and gets you

1345
00:46:29,920 --> 00:46:32,240
to you know that faster mean time to

1346
00:46:32,240 --> 00:46:34,319
detection mean time to response which is

1347
00:46:34,319 --> 00:46:34,960
important

1348
00:46:34,960 --> 00:46:38,079
um but you need to also prepare for when

1349
00:46:38,079 --> 00:46:39,359
you have to act

1350
00:46:39,359 --> 00:46:42,240
um silver bullets can breed complacency

1351
00:46:42,240 --> 00:46:43,680
right it's important to

1352
00:46:43,680 --> 00:46:47,599
validate that the tools that you know

1353
00:46:47,599 --> 00:46:49,760
what you think your tools do actually do

1354
00:46:49,760 --> 00:46:51,440
what they do and that you can use them

1355
00:46:51,440 --> 00:46:53,040
in the way that

1356
00:46:53,040 --> 00:46:55,440
they're being advertised to you response

1357
00:46:55,440 --> 00:46:56,560
is inevitable right

1358
00:46:56,560 --> 00:46:59,839
you don't choose if and when you respond

1359
00:46:59,839 --> 00:47:02,480
but you can control the speed as we said

1360
00:47:02,480 --> 00:47:04,400
data diversity matters right we saw

1361
00:47:04,400 --> 00:47:06,880
multiple cases to where both the host

1362
00:47:06,880 --> 00:47:09,040
and network side was needed

1363
00:47:09,040 --> 00:47:12,000
to um to get to the conclusion or to in

1364
00:47:12,000 --> 00:47:13,760
the minor case to actually score the

1365
00:47:13,760 --> 00:47:14,640
point

1366
00:47:14,640 --> 00:47:18,560
um context is key right

1367
00:47:18,800 --> 00:47:21,280
tracking every file right you won't i

1368
00:47:21,280 --> 00:47:23,280
mean if you if it's a small network you

1369
00:47:23,280 --> 00:47:24,960
might be able to do that

1370
00:47:24,960 --> 00:47:26,720
if it's a big network you know you're

1371
00:47:26,720 --> 00:47:28,319
going to have a big storage bill so if

1372
00:47:28,319 --> 00:47:30,400
you're putting that up in aws it's going

1373
00:47:30,400 --> 00:47:32,559
to be a big aws bill

1374
00:47:32,559 --> 00:47:34,319
you need to think about the data life

1375
00:47:34,319 --> 00:47:36,640
cycle though around your data to say

1376
00:47:36,640 --> 00:47:37,359
okay

1377
00:47:37,359 --> 00:47:39,280
you know let's store file rights of this

1378
00:47:39,280 --> 00:47:41,200
subset of data let's store

1379
00:47:41,200 --> 00:47:43,200
command lines of this subset of data if

1380
00:47:43,200 --> 00:47:44,640
they start to and we'll store them for

1381
00:47:44,640 --> 00:47:46,240
this long and this

1382
00:47:46,240 --> 00:47:48,400
you know in this area and you know this

1383
00:47:48,400 --> 00:47:49,920
how you'll access them especially if

1384
00:47:49,920 --> 00:47:51,200
you're using cloud you can

1385
00:47:51,200 --> 00:47:53,680
consider well we'll hot store these cold

1386
00:47:53,680 --> 00:47:55,440
store these you know you can go all day

1387
00:47:55,440 --> 00:47:57,680
with the design on that but

1388
00:47:57,680 --> 00:47:58,880
at the end of the day what it's

1389
00:47:58,880 --> 00:48:01,119
important to do is not flood an

1390
00:48:01,119 --> 00:48:04,079
analyst while also making sure that your

1391
00:48:04,079 --> 00:48:04,720
um

1392
00:48:04,720 --> 00:48:05,920
you know the analytics if they're

1393
00:48:05,920 --> 00:48:07,680
automated are able to run over that

1394
00:48:07,680 --> 00:48:09,440
corpus of data

1395
00:48:09,440 --> 00:48:11,599
an analysis step doesn't matter until it

1396
00:48:11,599 --> 00:48:13,440
does you know we talked about

1397
00:48:13,440 --> 00:48:15,599
both the file context and the network

1398
00:48:15,599 --> 00:48:18,400
context mattering

1399
00:48:18,400 --> 00:48:20,640
analyzing sophisticated attackers are

1400
00:48:20,640 --> 00:48:21,839
going to challenge some of your

1401
00:48:21,839 --> 00:48:24,240
collection and analysis limits um

1402
00:48:24,240 --> 00:48:26,400
like we saw in the impact stage of miter

1403
00:48:26,400 --> 00:48:27,359
attack

1404
00:48:27,359 --> 00:48:30,319
um you had to dig deep in deeper into

1405
00:48:30,319 --> 00:48:30,800
this hip

1406
00:48:30,800 --> 00:48:33,680
protocol you know as you take this kind

1407
00:48:33,680 --> 00:48:35,520
of into the production world it's going

1408
00:48:35,520 --> 00:48:36,960
to be a challenge

1409
00:48:36,960 --> 00:48:38,079
because again you're dealing with

1410
00:48:38,079 --> 00:48:40,400
proprietary protocols depending on

1411
00:48:40,400 --> 00:48:44,160
how often tags are written how often um

1412
00:48:44,160 --> 00:48:47,359
you know how often how loud the network

1413
00:48:47,359 --> 00:48:48,000
is you know

1414
00:48:48,000 --> 00:48:49,359
you have things like you go into a

1415
00:48:49,359 --> 00:48:51,440
refinery it's not just one data bus

1416
00:48:51,440 --> 00:48:53,440
there's two data buses

1417
00:48:53,440 --> 00:48:55,200
i've seen even seen even more

1418
00:48:55,200 --> 00:48:57,040
complicated networks out there

1419
00:48:57,040 --> 00:49:00,079
um your analysis step and your

1420
00:49:00,079 --> 00:49:03,359
breadth of analysis all matters

1421
00:49:03,359 --> 00:49:04,880
and you should constantly be

1422
00:49:04,880 --> 00:49:06,319
understanding and stretching those

1423
00:49:06,319 --> 00:49:08,319
limits

1424
00:49:08,319 --> 00:49:09,920
so i want to say thanks for attending

1425
00:49:09,920 --> 00:49:11,599
the talk it was

1426
00:49:11,599 --> 00:49:13,200
it's really great this is actually my

1427
00:49:13,200 --> 00:49:15,280
first defcon talk to do

1428
00:49:15,280 --> 00:49:18,079
and it's great to do it with ics village

1429
00:49:18,079 --> 00:49:19,520
definitely stay in touch

1430
00:49:19,520 --> 00:49:21,040
that's our twitter and if you want to

1431
00:49:21,040 --> 00:49:22,559
work or if you want to work together

1432
00:49:22,559 --> 00:49:24,480
feel free to reach out um

1433
00:49:24,480 --> 00:49:26,559
you know there's always fun stuff going

1434
00:49:26,559 --> 00:49:28,880
on so again thanks and have a great rest

1435
00:49:28,880 --> 00:49:31,760
of the day

