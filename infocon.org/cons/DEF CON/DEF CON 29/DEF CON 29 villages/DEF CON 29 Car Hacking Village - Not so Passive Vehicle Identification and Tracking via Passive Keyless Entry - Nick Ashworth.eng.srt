1
00:00:15,040 --> 00:00:16,640
hello everyone um

2
00:00:16,640 --> 00:00:19,119
my name is nick ashworth i am a graduate

3
00:00:19,119 --> 00:00:20,880
student here at the university of tulsa

4
00:00:20,880 --> 00:00:24,320
in tulsa oklahoma uh and i am presenting

5
00:00:24,320 --> 00:00:24,880
today

6
00:00:24,880 --> 00:00:28,000
my research on tracking and identifying

7
00:00:28,000 --> 00:00:28,480
people

8
00:00:28,480 --> 00:00:31,039
and vehicles via the passive keyless

9
00:00:31,039 --> 00:00:32,880
entry system

10
00:00:32,880 --> 00:00:37,200
uh yeah it's gonna be a thing

11
00:00:37,200 --> 00:00:40,800
um so before we begin uh a couple quick

12
00:00:40,800 --> 00:00:42,079
like explanation

13
00:00:42,079 --> 00:00:44,640
the vulnerabilities in the attacks that

14
00:00:44,640 --> 00:00:45,760
i've done

15
00:00:45,760 --> 00:00:48,640
uh i've tested on seven vehicles so far

16
00:00:48,640 --> 00:00:49,039
uh

17
00:00:49,039 --> 00:00:52,000
ranging from a 2013 ford explorer all

18
00:00:52,000 --> 00:00:54,399
the way up to a 2020 lexus

19
00:00:54,399 --> 00:00:57,280
uh everything that you see in this

20
00:00:57,280 --> 00:00:58,320
presentation

21
00:00:58,320 --> 00:01:02,399
today so all of the

22
00:01:02,399 --> 00:01:05,840
waterfall graph images all of the image

23
00:01:05,840 --> 00:01:06,880
captures

24
00:01:06,880 --> 00:01:09,280
all of the description of the like

25
00:01:09,280 --> 00:01:11,040
individual message formats

26
00:01:11,040 --> 00:01:13,600
and even the demo at the end will

27
00:01:13,600 --> 00:01:14,240
involve

28
00:01:14,240 --> 00:01:17,600
this wonderful 2014 toyota prius

29
00:01:17,600 --> 00:01:19,680
that as you can tell by the snow on the

30
00:01:19,680 --> 00:01:21,360
ground in the current 90 degree weather

31
00:01:21,360 --> 00:01:22,000
outside

32
00:01:22,000 --> 00:01:25,040
this is a very recent image

33
00:01:25,040 --> 00:01:26,799
and if you also didn't notice with the

34
00:01:26,799 --> 00:01:28,159
target uh

35
00:01:28,159 --> 00:01:30,960
trash bag over the front door handle we

36
00:01:30,960 --> 00:01:32,479
take great care of this car

37
00:01:32,479 --> 00:01:34,640
honestly it's perfectly fine and happy

38
00:01:34,640 --> 00:01:37,119
here i promise me and the other graduate

39
00:01:37,119 --> 00:01:38,960
students don't do anything harmful to it

40
00:01:38,960 --> 00:01:41,119
at all

41
00:01:41,119 --> 00:01:42,960
but okay getting into the meat of this

42
00:01:42,960 --> 00:01:46,000
stuff uh passive keyless entry

43
00:01:46,000 --> 00:01:47,439
for those of you who aren't familiar

44
00:01:47,439 --> 00:01:49,119
there's two ways that you can use your

45
00:01:49,119 --> 00:01:49,840
key fob

46
00:01:49,840 --> 00:01:52,560
to get into your vehicle the first and

47
00:01:52,560 --> 00:01:53,920
most common way that everyone knows

48
00:01:53,920 --> 00:01:55,759
active keyless entry this is where

49
00:01:55,759 --> 00:01:59,040
i push a button the key fob generates

50
00:01:59,040 --> 00:02:02,479
a message the car receives that message

51
00:02:02,479 --> 00:02:05,680
if everything is correct it unlocks the

52
00:02:05,680 --> 00:02:08,800
relatively newer way and manure in this

53
00:02:08,800 --> 00:02:09,440
case i mean

54
00:02:09,440 --> 00:02:12,480
starting from 20 from 2003 on

55
00:02:12,480 --> 00:02:14,640
is a technique called passive keyless

56
00:02:14,640 --> 00:02:15,680
entry

57
00:02:15,680 --> 00:02:17,440
like its name implies in a passive

58
00:02:17,440 --> 00:02:18,959
keyless entry system

59
00:02:18,959 --> 00:02:20,640
you just happen to have you just have to

60
00:02:20,640 --> 00:02:22,879
have your key fob on you

61
00:02:22,879 --> 00:02:25,360
and whenever you either touch the door

62
00:02:25,360 --> 00:02:26,800
handle to enter the car

63
00:02:26,800 --> 00:02:28,319
or push the start button on the vehicle

64
00:02:28,319 --> 00:02:31,519
to begin to uh turn the engine on

65
00:02:31,519 --> 00:02:34,560
the vehicle will generate a message that

66
00:02:34,560 --> 00:02:36,640
forces the key fob to respond

67
00:02:36,640 --> 00:02:38,560
and it is then able to tell whether or

68
00:02:38,560 --> 00:02:40,239
not the key fob is present

69
00:02:40,239 --> 00:02:42,000
and whether or not that key fob is the

70
00:02:42,000 --> 00:02:43,200
key fob that has been paired to the

71
00:02:43,200 --> 00:02:44,480
vehicle without you

72
00:02:44,480 --> 00:02:47,200
the driver doing anything this has

73
00:02:47,200 --> 00:02:49,200
gotten very very popular

74
00:02:49,200 --> 00:02:52,080
over 90 of the vehicles sold in the us

75
00:02:52,080 --> 00:02:52,560
uh

76
00:02:52,560 --> 00:02:56,480
in 2020 had uh pass a keyless entry

77
00:02:56,480 --> 00:02:58,720
it's really useful from a consumer

78
00:02:58,720 --> 00:03:00,800
standpoint for a lot of reasons

79
00:03:00,800 --> 00:03:02,879
because the vehicle was able to check to

80
00:03:02,879 --> 00:03:05,040
see if the key fob is nearby

81
00:03:05,040 --> 00:03:06,480
the vehicle can automatically alert you

82
00:03:06,480 --> 00:03:07,840
if you're about to leave your keys in

83
00:03:07,840 --> 00:03:09,920
the car because it can check to see

84
00:03:09,920 --> 00:03:11,599
if the keys are present inside before

85
00:03:11,599 --> 00:03:13,120
you go to lock the door or whenever you

86
00:03:13,120 --> 00:03:15,680
press the door lock button

87
00:03:15,680 --> 00:03:18,239
it also is easier on the person because

88
00:03:18,239 --> 00:03:19,599
it's one less thing to carry for doing

89
00:03:19,599 --> 00:03:21,040
groceries

90
00:03:21,040 --> 00:03:23,440
yada yada yada the classic game of

91
00:03:23,440 --> 00:03:25,440
convenience for security

92
00:03:25,440 --> 00:03:28,319
um and so it's something that's here to

93
00:03:28,319 --> 00:03:29,680
stay

94
00:03:29,680 --> 00:03:32,959
excuse me the basics of uh passive

95
00:03:32,959 --> 00:03:35,120
helicopter being broken down into three

96
00:03:35,120 --> 00:03:36,080
protocols

97
00:03:36,080 --> 00:03:38,080
that handle all the heavy lifting of

98
00:03:38,080 --> 00:03:40,080
this of this whole system

99
00:03:40,080 --> 00:03:43,280
the first is the pairing protocol this

100
00:03:43,280 --> 00:03:45,360
is the protocol that is used

101
00:03:45,360 --> 00:03:48,799
to match your key fob with your car

102
00:03:48,799 --> 00:03:50,879
this is a very vendor specific protocol

103
00:03:50,879 --> 00:03:52,560
i'll be honest i wasn't able to get that

104
00:03:52,560 --> 00:03:54,080
much info on it

105
00:03:54,080 --> 00:03:57,519
but the basics of it are as a part of pk

106
00:03:57,519 --> 00:03:59,280
as a part of the pke system there is a

107
00:03:59,280 --> 00:04:00,959
unique id for your car

108
00:04:00,959 --> 00:04:02,640
and there is a unique id for your key

109
00:04:02,640 --> 00:04:04,799
fob and doing the pairing protocol

110
00:04:04,799 --> 00:04:06,640
those two ids are exchanged between the

111
00:04:06,640 --> 00:04:09,360
vehicles so that your car now knows this

112
00:04:09,360 --> 00:04:10,400
key fob id

113
00:04:10,400 --> 00:04:12,000
me is the key fob that it's supposed to

114
00:04:12,000 --> 00:04:14,400
listen to and your key fob now knows

115
00:04:14,400 --> 00:04:15,360
that car id

116
00:04:15,360 --> 00:04:17,918
is the car id it's supposed to listen to

117
00:04:17,918 --> 00:04:19,600
pretty straightforward

118
00:04:19,600 --> 00:04:21,519
the second one and one of the more

119
00:04:21,519 --> 00:04:23,120
interesting ones is a thing called the

120
00:04:23,120 --> 00:04:25,120
zero battery protocol

121
00:04:25,120 --> 00:04:27,520
i suppose i should also clarify because

122
00:04:27,520 --> 00:04:29,360
all these documentations are proprietary

123
00:04:29,360 --> 00:04:30,160
i don't

124
00:04:30,160 --> 00:04:32,800
know the actual formal name of these

125
00:04:32,800 --> 00:04:34,479
protocols these are just what i call

126
00:04:34,479 --> 00:04:36,240
them for convenience

127
00:04:36,240 --> 00:04:37,759
feel free to use or reject those names

128
00:04:37,759 --> 00:04:39,840
at your own at your own discretion

129
00:04:39,840 --> 00:04:42,320
the zero battery protocol is the pro is

130
00:04:42,320 --> 00:04:43,919
the emergency protocol used when the

131
00:04:43,919 --> 00:04:46,320
battery inside the key fob dies

132
00:04:46,320 --> 00:04:50,240
uh so if your key fob dies you can use

133
00:04:50,240 --> 00:04:52,800
the backup key that's inside most of

134
00:04:52,800 --> 00:04:53,600
these spots

135
00:04:53,600 --> 00:04:56,639
to get into the to get into the car but

136
00:04:56,639 --> 00:04:57,520
because the car

137
00:04:57,520 --> 00:04:59,840
uses a push to start system in the in

138
00:04:59,840 --> 00:05:02,800
the whenever it's enabled with pke

139
00:05:02,800 --> 00:05:04,400
there's nowhere to use this to actually

140
00:05:04,400 --> 00:05:07,199
turn the ignition on and so instead

141
00:05:07,199 --> 00:05:09,520
what happens is the car transmits a very

142
00:05:09,520 --> 00:05:10,720
very long

143
00:05:10,720 --> 00:05:14,000
like 150 millisecond long message that

144
00:05:14,000 --> 00:05:16,400
powers up and energizes the encryption

145
00:05:16,400 --> 00:05:16,720
ship

146
00:05:16,720 --> 00:05:19,280
inside the key fob and allows it to

147
00:05:19,280 --> 00:05:20,960
operate and send a quick message that

148
00:05:20,960 --> 00:05:23,919
yes i'm here and yes i'm i'm your fob

149
00:05:23,919 --> 00:05:24,400
even

150
00:05:24,400 --> 00:05:26,479
when the battery is not present and or

151
00:05:26,479 --> 00:05:28,479
dead

152
00:05:28,479 --> 00:05:31,120
uh we'll get into a little bit more of

153
00:05:31,120 --> 00:05:32,240
how it does that and why

154
00:05:32,240 --> 00:05:34,000
he does it at the specific frequency

155
00:05:34,000 --> 00:05:35,520
later the other one

156
00:05:35,520 --> 00:05:36,880
and the main thing that we'll be

157
00:05:36,880 --> 00:05:39,520
focusing on and the main thing that uh

158
00:05:39,520 --> 00:05:41,199
the main protocol that you actually use

159
00:05:41,199 --> 00:05:42,720
when you're using your car

160
00:05:42,720 --> 00:05:44,160
is a protocol called the four-way

161
00:05:44,160 --> 00:05:45,759
handshake protocol

162
00:05:45,759 --> 00:05:47,919
this is the protocol that is used every

163
00:05:47,919 --> 00:05:49,600
time you touch a door handle

164
00:05:49,600 --> 00:05:51,759
every time you use the push start system

165
00:05:51,759 --> 00:05:53,759
every time you try to do the trunk

166
00:05:53,759 --> 00:05:56,240
and 99 of the time this is the protocol

167
00:05:56,240 --> 00:05:58,000
you will use whenever interacting with

168
00:05:58,000 --> 00:05:59,039
your car

169
00:05:59,039 --> 00:06:02,319
um this protocol is interesting

170
00:06:02,319 --> 00:06:05,120
because unlike the zero battery protocol

171
00:06:05,120 --> 00:06:06,000
where the car

172
00:06:06,000 --> 00:06:08,800
is powering up the key fob by enabling

173
00:06:08,800 --> 00:06:10,319
it transmit

174
00:06:10,319 --> 00:06:13,600
the four-way handshake protocol uses

175
00:06:13,600 --> 00:06:15,520
the battery inside the keypad the same

176
00:06:15,520 --> 00:06:16,960
battery that's used for your active

177
00:06:16,960 --> 00:06:19,120
keyless entry system

178
00:06:19,120 --> 00:06:20,960
this means that the messages that it

179
00:06:20,960 --> 00:06:22,479
generates

180
00:06:22,479 --> 00:06:24,960
are relatively high power at least

181
00:06:24,960 --> 00:06:26,560
compared to pretty much everything else

182
00:06:26,560 --> 00:06:28,000
that your car is transmitting

183
00:06:28,000 --> 00:06:31,039
such as like uh tpms or some of those

184
00:06:31,039 --> 00:06:32,240
other systems

185
00:06:32,240 --> 00:06:34,720
and so you have a really long range with

186
00:06:34,720 --> 00:06:35,360
this

187
00:06:35,360 --> 00:06:38,080
um if you do the free space loss

188
00:06:38,080 --> 00:06:39,759
calculations you're talking up to 90

189
00:06:39,759 --> 00:06:40,720
meters

190
00:06:40,720 --> 00:06:43,280
of range if you're looking at like a

191
00:06:43,280 --> 00:06:44,800
real world scenario you're going to cut

192
00:06:44,800 --> 00:06:46,479
that in half and do anywhere from 30 to

193
00:06:46,479 --> 00:06:47,280
40 meters

194
00:06:47,280 --> 00:06:49,919
of range but either way all of a sudden

195
00:06:49,919 --> 00:06:50,800
you can

196
00:06:50,800 --> 00:06:53,039
identify this over rf from really far

197
00:06:53,039 --> 00:06:54,240
away

198
00:06:54,240 --> 00:06:57,039
uh the other key thing to know and will

199
00:06:57,039 --> 00:06:58,479
become very important

200
00:06:58,479 --> 00:07:00,800
is that the passive keyless entry system

201
00:07:00,800 --> 00:07:02,639
on your vehicle side

202
00:07:02,639 --> 00:07:05,919
transmits at 134 kilohertz now your key

203
00:07:05,919 --> 00:07:07,759
fob itself will transmit at anywhere

204
00:07:07,759 --> 00:07:09,440
from 315

205
00:07:09,440 --> 00:07:12,479
megahertz 434 megahertz some of them

206
00:07:12,479 --> 00:07:15,440
will even go up to 900 900 megahertz

207
00:07:15,440 --> 00:07:17,120
um and those are all relatively high

208
00:07:17,120 --> 00:07:18,960
frequencies

209
00:07:18,960 --> 00:07:21,599
134 kilohertz is incredibly low

210
00:07:21,599 --> 00:07:22,960
frequency for those of you who aren't

211
00:07:22,960 --> 00:07:24,479
familiar with rf

212
00:07:24,479 --> 00:07:27,039
and it causes a problem in this space

213
00:07:27,039 --> 00:07:28,639
which is honestly the biggest challenge

214
00:07:28,639 --> 00:07:30,240
in all live research

215
00:07:30,240 --> 00:07:33,440
that i like to refer to as the 134

216
00:07:33,440 --> 00:07:34,319
kilohertz

217
00:07:34,319 --> 00:07:38,160
problem so nrf

218
00:07:38,160 --> 00:07:40,240
um and i will just really admit i am an

219
00:07:40,240 --> 00:07:41,919
idiot with an sdr

220
00:07:41,919 --> 00:07:45,199
so take all this great stuff but then

221
00:07:45,199 --> 00:07:46,800
the basics of doing radio frequency

222
00:07:46,800 --> 00:07:48,479
analysis when you are designing

223
00:07:48,479 --> 00:07:52,560
an antenna to work at a given frequency

224
00:07:52,560 --> 00:07:57,680
you design that antenna to basically be

225
00:07:57,680 --> 00:08:00,080
um either on the half wavelength or the

226
00:08:00,080 --> 00:08:01,680
quarter wavelength

227
00:08:01,680 --> 00:08:04,319
of the of the of the wavelength you're

228
00:08:04,319 --> 00:08:05,199
trying to track

229
00:08:05,199 --> 00:08:06,800
so you want it to be an even multiple of

230
00:08:06,800 --> 00:08:08,400
either that half wavelength or that

231
00:08:08,400 --> 00:08:09,919
quarter wavelength

232
00:08:09,919 --> 00:08:12,879
now for 99 of the signals you and i

233
00:08:12,879 --> 00:08:14,720
interact with every day

234
00:08:14,720 --> 00:08:18,160
that is not a big deal um wi-fi is at

235
00:08:18,160 --> 00:08:21,039
2.4 gigahertz or 5 gigahertz depending

236
00:08:21,039 --> 00:08:22,160
on

237
00:08:22,160 --> 00:08:24,639
um what freq which channel you're

238
00:08:24,639 --> 00:08:27,360
listening on uh the new five gigahertz

239
00:08:27,360 --> 00:08:28,560
signal that your cell phones are gonna

240
00:08:28,560 --> 00:08:31,360
use go all the way to 60 gigahertz

241
00:08:31,360 --> 00:08:33,679
very very high frequency which means

242
00:08:33,679 --> 00:08:36,240
very very small wavelengths on the

243
00:08:36,240 --> 00:08:38,559
verge of like you know anywhere from

244
00:08:38,559 --> 00:08:41,120
meters to centimeters

245
00:08:41,120 --> 00:08:44,000
and thus you know an antenna even for a

246
00:08:44,000 --> 00:08:45,440
relatively

247
00:08:45,440 --> 00:08:48,000
low frequency signal like ais which

248
00:08:48,000 --> 00:08:49,839
ships used for identification

249
00:08:49,839 --> 00:08:54,000
that operates at 162 uh megahertz

250
00:08:54,000 --> 00:08:57,600
your antenna length is still you know

251
00:08:57,600 --> 00:08:59,440
something you you or i could easily

252
00:08:59,440 --> 00:09:00,640
carry

253
00:09:00,640 --> 00:09:03,600
134 kilohertz though is a really low

254
00:09:03,600 --> 00:09:05,040
frequency

255
00:09:05,040 --> 00:09:08,000
uh to give you an idea of how low the

256
00:09:08,000 --> 00:09:09,680
wavelength of this signal

257
00:09:09,680 --> 00:09:13,519
is over 2000 meters which means the half

258
00:09:13,519 --> 00:09:14,399
wavelength

259
00:09:14,399 --> 00:09:16,160
is a thousand meters and the quarter

260
00:09:16,160 --> 00:09:18,800
wavelength 500 meters

261
00:09:18,800 --> 00:09:21,200
having an antenna that's 500 meters long

262
00:09:21,200 --> 00:09:22,000
is a bit of a

263
00:09:22,000 --> 00:09:24,160
problem unless you're somebody like the

264
00:09:24,160 --> 00:09:25,279
government

265
00:09:25,279 --> 00:09:28,320
or you just have a ton of property

266
00:09:28,320 --> 00:09:31,440
uh it it's like absurdly huge

267
00:09:31,440 --> 00:09:35,200
for this space now what's cool is

268
00:09:35,200 --> 00:09:37,680
because this frequency is so low you can

269
00:09:37,680 --> 00:09:39,680
do a lot of things with it

270
00:09:39,680 --> 00:09:42,800
um this frequency travels

271
00:09:42,800 --> 00:09:45,120
forever and has very little free space

272
00:09:45,120 --> 00:09:48,000
loss because of how low it is

273
00:09:48,000 --> 00:09:51,360
for example the picture on the right

274
00:09:51,360 --> 00:09:54,560
the little candy stripe towers that is

275
00:09:54,560 --> 00:09:57,519
a time keeping system in colorado that

276
00:09:57,519 --> 00:09:59,760
the actual antenna is a thin cable that

277
00:09:59,760 --> 00:10:00,640
runs across

278
00:10:00,640 --> 00:10:04,320
all those poles and it radiates a signal

279
00:10:04,320 --> 00:10:07,600
down into into the earth that bounces

280
00:10:07,600 --> 00:10:09,200
off the earth and then kind of glides

281
00:10:09,200 --> 00:10:11,839
along the ground across the entire us

282
00:10:11,839 --> 00:10:14,640
and if you ever had any one of those old

283
00:10:14,640 --> 00:10:16,560
radio controlled atomic clocks from like

284
00:10:16,560 --> 00:10:18,800
the 90s or early 2000s

285
00:10:18,800 --> 00:10:20,880
this was the frequency it was listening

286
00:10:20,880 --> 00:10:21,839
to

287
00:10:21,839 --> 00:10:25,279
no matter where in the us you were

288
00:10:25,279 --> 00:10:28,320
that is like stupidly cool range

289
00:10:28,320 --> 00:10:30,160
um the counter to that is you need

290
00:10:30,160 --> 00:10:32,399
really really big antennas

291
00:10:32,399 --> 00:10:35,360
um and in addition to that you need a

292
00:10:35,360 --> 00:10:37,040
lot of hoops to jump through if you're

293
00:10:37,040 --> 00:10:37,920
trying to talk

294
00:10:37,920 --> 00:10:41,360
on this frequency as a civilian the fcc

295
00:10:41,360 --> 00:10:44,399
only recently um and by recently i mean

296
00:10:44,399 --> 00:10:46,640
like 2017

297
00:10:46,640 --> 00:10:49,839
allowed uh amateur radio to begin

298
00:10:49,839 --> 00:10:51,519
operating near this frequency

299
00:10:51,519 --> 00:10:53,120
technically the amateur radio band is

300
00:10:53,120 --> 00:10:55,800
136 kilohertz

301
00:10:55,800 --> 00:10:59,200
13634 is close enough to not matter

302
00:10:59,200 --> 00:11:02,240
for our conversation

303
00:11:02,240 --> 00:11:04,720
because of that a lot of your

304
00:11:04,720 --> 00:11:05,680
traditional

305
00:11:05,680 --> 00:11:10,560
sdrs like your hack rf1s your rtl sdrs

306
00:11:10,560 --> 00:11:13,600
um even your blade rfs

307
00:11:13,600 --> 00:11:15,440
don't operate at this low frequency most

308
00:11:15,440 --> 00:11:17,680
of them cap out at anywhere from like

309
00:11:17,680 --> 00:11:18,560
one megahertz

310
00:11:18,560 --> 00:11:20,720
to 75 megahertz for example if you're

311
00:11:20,720 --> 00:11:22,720
using an ssdr

312
00:11:22,720 --> 00:11:26,560
uh the only one that really will go this

313
00:11:26,560 --> 00:11:28,000
low natively without using

314
00:11:28,000 --> 00:11:30,800
up converter is the lime sdr made by

315
00:11:30,800 --> 00:11:32,560
lime micro systems

316
00:11:32,560 --> 00:11:34,480
and again that's a relatively new sdr

317
00:11:34,480 --> 00:11:38,720
that came out in around 2017

318
00:11:38,720 --> 00:11:41,519
at the same time finding antennas that

319
00:11:41,519 --> 00:11:42,640
will operate

320
00:11:42,640 --> 00:11:45,760
in in this frequency range that you can

321
00:11:45,760 --> 00:11:47,600
just commercially buy is also

322
00:11:47,600 --> 00:11:50,959
a bit of a nightmare uh while there are

323
00:11:50,959 --> 00:11:52,560
a lot of hand groups that listen in at

324
00:11:52,560 --> 00:11:54,160
this frequency

325
00:11:54,160 --> 00:11:55,680
and so you can find receive only

326
00:11:55,680 --> 00:11:57,680
antennas fairly fairly easily

327
00:11:57,680 --> 00:12:00,480
finding a transmit cable uh yeah sorry

328
00:12:00,480 --> 00:12:02,480
finding a transmit capable antenna

329
00:12:02,480 --> 00:12:05,360
is a bit of a nightmare uh and that's

330
00:12:05,360 --> 00:12:08,079
kind of because the fcc again

331
00:12:08,079 --> 00:12:10,160
uh gets to be everybody's best friend

332
00:12:10,160 --> 00:12:12,639
because as a part of being authorized to

333
00:12:12,639 --> 00:12:14,399
transmit in this band

334
00:12:14,399 --> 00:12:16,079
if you are one of the ham radio groups

335
00:12:16,079 --> 00:12:17,360
that actually can talk on these

336
00:12:17,360 --> 00:12:18,959
frequencies

337
00:12:18,959 --> 00:12:21,519
you don't get a normal license your

338
00:12:21,519 --> 00:12:23,120
license is geo-locked

339
00:12:23,120 --> 00:12:25,360
to a specific antenna that you will be

340
00:12:25,360 --> 00:12:26,560
using to transmit

341
00:12:26,560 --> 00:12:29,760
and you must give the fcc the exact

342
00:12:29,760 --> 00:12:31,680
the exact gps coordinates of that

343
00:12:31,680 --> 00:12:32,880
antenna

344
00:12:32,880 --> 00:12:35,040
having some mobile antenna that you can

345
00:12:35,040 --> 00:12:36,079
move around

346
00:12:36,079 --> 00:12:38,160
completely breaks all those rules and so

347
00:12:38,160 --> 00:12:40,480
most people haven't designed one

348
00:12:40,480 --> 00:12:43,680
uh i did eventually find one and

349
00:12:43,680 --> 00:12:45,839
uh i have on the github page that

350
00:12:45,839 --> 00:12:47,120
explains this attack

351
00:12:47,120 --> 00:12:48,560
kind of little kind of a little bit of

352
00:12:48,560 --> 00:12:50,240
running out of it and it's called the uh

353
00:12:50,240 --> 00:12:51,360
you loop

354
00:12:51,360 --> 00:12:55,040
loop antenna uh this is the antenna that

355
00:12:55,040 --> 00:12:57,120
i use to get all of my captures and i'll

356
00:12:57,120 --> 00:12:59,760
be using for the attack demo

357
00:12:59,760 --> 00:13:01,839
it's what's known as a small magnetic

358
00:13:01,839 --> 00:13:03,360
loop antenna

359
00:13:03,360 --> 00:13:05,839
which basically means it is a loop of

360
00:13:05,839 --> 00:13:07,040
wire

361
00:13:07,040 --> 00:13:09,200
in this case i've looped it around twice

362
00:13:09,200 --> 00:13:12,000
you can kind of see that

363
00:13:12,000 --> 00:13:15,200
and what that does is a bunch of demon

364
00:13:15,200 --> 00:13:16,079
magic

365
00:13:16,079 --> 00:13:19,519
that lets you bypass not having to be

366
00:13:19,519 --> 00:13:21,519
a quarter wavelength or half wavelength

367
00:13:21,519 --> 00:13:23,200
of the signal you're trying to receive

368
00:13:23,200 --> 00:13:24,720
or transmit

369
00:13:24,720 --> 00:13:27,839
now the downside of that demon magic

370
00:13:27,839 --> 00:13:29,839
that allows it to happen

371
00:13:29,839 --> 00:13:32,800
is the system doesn't work very well as

372
00:13:32,800 --> 00:13:34,880
a transmit antenna

373
00:13:34,880 --> 00:13:37,440
while those big giant poles the size of

374
00:13:37,440 --> 00:13:38,959
small houses

375
00:13:38,959 --> 00:13:40,959
uh will let you transmit across the

376
00:13:40,959 --> 00:13:42,399
continental us

377
00:13:42,399 --> 00:13:44,399
and if you're in a military system fun

378
00:13:44,399 --> 00:13:45,760
fact this is

379
00:13:45,760 --> 00:13:48,399
a similar frequency to what the navy

380
00:13:48,399 --> 00:13:50,320
uses to talk to submarines

381
00:13:50,320 --> 00:13:53,360
at the bottom of the ocean again this

382
00:13:53,360 --> 00:13:54,480
thing

383
00:13:54,480 --> 00:13:56,560
there is no free space loss you can talk

384
00:13:56,560 --> 00:13:57,839
for miles and miles

385
00:13:57,839 --> 00:14:01,760
it's really crazy a little guy like this

386
00:14:01,760 --> 00:14:03,519
will not get you that range

387
00:14:03,519 --> 00:14:07,120
um and even if you go to a larger

388
00:14:07,120 --> 00:14:10,399
like uh meter meter

389
00:14:10,399 --> 00:14:13,519
uh long loop and add on an up converter

390
00:14:13,519 --> 00:14:14,560
everything else

391
00:14:14,560 --> 00:14:17,839
you're still only getting like 20

392
00:14:17,839 --> 00:14:21,199
30 meters of transmission range with it

393
00:14:21,199 --> 00:14:24,320
uh in theory if you were to design your

394
00:14:24,320 --> 00:14:26,079
own antenna for this space

395
00:14:26,079 --> 00:14:29,440
you would probably have better luck

396
00:14:29,440 --> 00:14:32,720
my background is not antenna design i

397
00:14:32,720 --> 00:14:35,680
so i don't really know how to do that if

398
00:14:35,680 --> 00:14:37,120
you do please feel free to get in

399
00:14:37,120 --> 00:14:38,639
contact i would love to talk

400
00:14:38,639 --> 00:14:40,959
and learn more because i think there's a

401
00:14:40,959 --> 00:14:42,160
lot of cool things that you can do

402
00:14:42,160 --> 00:14:44,240
even with the limits that we have which

403
00:14:44,240 --> 00:14:45,360
we'll go over

404
00:14:45,360 --> 00:14:49,360
soon so with that uh side discretion of

405
00:14:49,360 --> 00:14:50,800
the wonderful world of rf

406
00:14:50,800 --> 00:14:52,800
out of the way let's get into how the

407
00:14:52,800 --> 00:14:53,839
four-way handshake

408
00:14:53,839 --> 00:14:57,040
actually works so before we handshake

409
00:14:57,040 --> 00:15:00,000
as its name kind of implies consists of

410
00:15:00,000 --> 00:15:01,839
four messages

411
00:15:01,839 --> 00:15:04,240
a wake-up message uh an acknowledgement

412
00:15:04,240 --> 00:15:06,000
message a challenge message and a

413
00:15:06,000 --> 00:15:08,240
response

414
00:15:08,240 --> 00:15:10,800
your basically how this works is

415
00:15:10,800 --> 00:15:12,399
whenever you go to we'll say touch the

416
00:15:12,399 --> 00:15:13,040
door handle

417
00:15:13,040 --> 00:15:15,360
so i am trying to enter the car i touch

418
00:15:15,360 --> 00:15:16,399
the door handle

419
00:15:16,399 --> 00:15:18,240
there is a capacitive sensor in that

420
00:15:18,240 --> 00:15:19,839
driver's side door handle that alerts

421
00:15:19,839 --> 00:15:21,040
the vehicle that someone is

422
00:15:21,040 --> 00:15:24,000
trying to enter that then causes the

423
00:15:24,000 --> 00:15:26,639
vehicle to generate a wake-up message

424
00:15:26,639 --> 00:15:28,560
a wake-up message as its name kind of

425
00:15:28,560 --> 00:15:32,000
implies tells the key fob to wake up

426
00:15:32,000 --> 00:15:36,320
it is a static message this means that

427
00:15:36,320 --> 00:15:38,560
the data inside the message is always

428
00:15:38,560 --> 00:15:40,480
the same in the case of

429
00:15:40,480 --> 00:15:42,320
the 2014 toyota prius that we'll be

430
00:15:42,320 --> 00:15:44,399
using as our demo for today

431
00:15:44,399 --> 00:15:48,079
that wake up message is f-f-e-a-b-a

432
00:15:48,079 --> 00:15:50,399
if i remember correctly and it will be

433
00:15:50,399 --> 00:15:51,360
that way

434
00:15:51,360 --> 00:15:54,160
for every 2014 toyota prius you run

435
00:15:54,160 --> 00:15:54,800
across

436
00:15:54,800 --> 00:15:57,440
or every uh i believe it's generation

437
00:15:57,440 --> 00:15:58,000
three

438
00:15:58,000 --> 00:16:00,480
is the vehicle model our is the vehicle

439
00:16:00,480 --> 00:16:02,320
family of the 2014 model toyota

440
00:16:02,320 --> 00:16:03,120
precision

441
00:16:03,120 --> 00:16:05,279
so in theory every one of that vehicle

442
00:16:05,279 --> 00:16:06,399
model

443
00:16:06,399 --> 00:16:08,079
will use will generate this wake up

444
00:16:08,079 --> 00:16:10,079
message um

445
00:16:10,079 --> 00:16:11,839
and that will become useful to know

446
00:16:11,839 --> 00:16:12,720
later on we're going to get one of the

447
00:16:12,720 --> 00:16:13,920
texts

448
00:16:13,920 --> 00:16:16,720
the key fob if it is within range to

449
00:16:16,720 --> 00:16:18,880
receive this wake up message

450
00:16:18,880 --> 00:16:20,399
will respond with an acknowledgement

451
00:16:20,399 --> 00:16:22,160
message at whatever frequency it

452
00:16:22,160 --> 00:16:23,279
transmits on

453
00:16:23,279 --> 00:16:25,600
in our case for today that is 315

454
00:16:25,600 --> 00:16:27,040
megahertz

455
00:16:27,040 --> 00:16:29,120
so the acknowledgement message is also a

456
00:16:29,120 --> 00:16:30,720
static message

457
00:16:30,720 --> 00:16:32,160
that basically just tells the vehicle

458
00:16:32,160 --> 00:16:35,759
that yes there is a key fob in range

459
00:16:35,759 --> 00:16:39,120
that match or that is a toyota prius

460
00:16:39,120 --> 00:16:40,880
keep up

461
00:16:40,880 --> 00:16:43,120
now you might be wondering why both of

462
00:16:43,120 --> 00:16:44,160
these messages

463
00:16:44,160 --> 00:16:47,120
are static after all it seems kind of

464
00:16:47,120 --> 00:16:49,360
useless to have them there

465
00:16:49,360 --> 00:16:52,320
well the advantage of having two static

466
00:16:52,320 --> 00:16:53,759
messages to start this out

467
00:16:53,759 --> 00:16:56,480
is a static message is both very easy to

468
00:16:56,480 --> 00:16:58,000
generate

469
00:16:58,000 --> 00:17:01,199
and very power efficient because you're

470
00:17:01,199 --> 00:17:03,920
not dynamically doing any calculations

471
00:17:03,920 --> 00:17:04,319
or

472
00:17:04,319 --> 00:17:06,799
changing anything on the fly you can

473
00:17:06,799 --> 00:17:07,760
transmit this

474
00:17:07,760 --> 00:17:10,079
signal without draining your battery

475
00:17:10,079 --> 00:17:11,119
that much

476
00:17:11,119 --> 00:17:13,119
and because the car is sitting there and

477
00:17:13,119 --> 00:17:14,720
using its car battery and because your

478
00:17:14,720 --> 00:17:15,679
key fob

479
00:17:15,679 --> 00:17:17,359
is sitting here using your little tiny

480
00:17:17,359 --> 00:17:19,280
coin cell battery that's in here

481
00:17:19,280 --> 00:17:21,439
battery drains kind of a big deal on on

482
00:17:21,439 --> 00:17:23,119
the engineering side and so that's why

483
00:17:23,119 --> 00:17:24,959
they decided to make this first half

484
00:17:24,959 --> 00:17:26,880
static

485
00:17:26,880 --> 00:17:30,000
to reduce that battery consumption now

486
00:17:30,000 --> 00:17:32,400
once your car knows that there's a key

487
00:17:32,400 --> 00:17:33,360
fob nearby

488
00:17:33,360 --> 00:17:36,320
that could possibly be its key fob it

489
00:17:36,320 --> 00:17:37,520
generates the challenge

490
00:17:37,520 --> 00:17:40,640
message uh the challenge message is a

491
00:17:40,640 --> 00:17:44,400
much longer message so for comparison

492
00:17:44,400 --> 00:17:45,760
the wake up message on most of the

493
00:17:45,760 --> 00:17:47,600
vehicles i tested was around five

494
00:17:47,600 --> 00:17:48,480
milliseconds

495
00:17:48,480 --> 00:17:50,880
in like total transmission time the

496
00:17:50,880 --> 00:17:51,840
challenge message

497
00:17:51,840 --> 00:17:55,280
is about 50 milliseconds it's a big boy

498
00:17:55,280 --> 00:17:57,760
uh that challenge message contains your

499
00:17:57,760 --> 00:17:59,280
car id

500
00:17:59,280 --> 00:18:02,640
a challenge seed which the

501
00:18:02,640 --> 00:18:04,799
key fob will use to solve to validate

502
00:18:04,799 --> 00:18:07,600
that it is the key pop it claims to be

503
00:18:07,600 --> 00:18:09,919
and a simple little crc to just kind of

504
00:18:09,919 --> 00:18:12,400
do data validation

505
00:18:12,400 --> 00:18:15,039
so what happens is then after that

506
00:18:15,039 --> 00:18:16,960
challenge has been transmitted

507
00:18:16,960 --> 00:18:19,679
your key fob will receive that challenge

508
00:18:19,679 --> 00:18:20,400
message

509
00:18:20,400 --> 00:18:23,280
we'll look at the car id first and see

510
00:18:23,280 --> 00:18:24,480
if that car id

511
00:18:24,480 --> 00:18:28,400
matches its key fob id if it does great

512
00:18:28,400 --> 00:18:29,840
it further decodes the message

513
00:18:29,840 --> 00:18:31,679
if it not it throws it away and it

514
00:18:31,679 --> 00:18:33,200
laughs and doesn't care

515
00:18:33,200 --> 00:18:36,559
um it will then take that challenge seed

516
00:18:36,559 --> 00:18:39,120
from the uh from the challenge message

517
00:18:39,120 --> 00:18:40,559
and attempt to solve it

518
00:18:40,559 --> 00:18:43,440
and it's a pretty simple cipher like

519
00:18:43,440 --> 00:18:44,559
okay we're saying

520
00:18:44,559 --> 00:18:47,679
it's encrypted but this isn't like an

521
00:18:47,679 --> 00:18:48,320
aes

522
00:18:48,320 --> 00:18:50,720
kind of game this is like the challenge

523
00:18:50,720 --> 00:18:52,080
word is is a

524
00:18:52,080 --> 00:18:55,600
the password is apple the challenge is b

525
00:18:55,600 --> 00:18:59,760
the password is banana um again

526
00:18:59,760 --> 00:19:02,320
battery is a huge issue doing a ton of

527
00:19:02,320 --> 00:19:04,320
calculations and computations takes a

528
00:19:04,320 --> 00:19:05,840
lot of battery power

529
00:19:05,840 --> 00:19:09,039
so things are kind of this this isn't

530
00:19:09,039 --> 00:19:12,080
your normal your normal kind of game

531
00:19:12,080 --> 00:19:15,200
but it's also operating in a space where

532
00:19:15,200 --> 00:19:16,640
it's not really expected to get that

533
00:19:16,640 --> 00:19:18,080
many hits

534
00:19:18,080 --> 00:19:21,280
um and so when your key fob generates

535
00:19:21,280 --> 00:19:22,720
that response

536
00:19:22,720 --> 00:19:25,919
your car will look at the key fob id to

537
00:19:25,919 --> 00:19:27,840
validate that it is correct it will look

538
00:19:27,840 --> 00:19:29,919
at the actual response message to

539
00:19:29,919 --> 00:19:32,240
validate that is correct

540
00:19:32,240 --> 00:19:34,559
and then it lets you in and these all

541
00:19:34,559 --> 00:19:36,240
four of these messages happen in the

542
00:19:36,240 --> 00:19:37,919
time span of you touching the door

543
00:19:37,919 --> 00:19:41,280
handle and pulling it open

544
00:19:41,360 --> 00:19:43,039
or pushing the start button and waiting

545
00:19:43,039 --> 00:19:45,600
for the engine to actually start

546
00:19:45,600 --> 00:19:48,000
so it's relatively quick quick

547
00:19:48,000 --> 00:19:49,360
happenings

548
00:19:49,360 --> 00:19:51,679
um it's fairly straightforward it works

549
00:19:51,679 --> 00:19:53,440
the way you think it should because

550
00:19:53,440 --> 00:19:55,600
honestly it's not that badly engineered

551
00:19:55,600 --> 00:19:57,120
of a system it's actually pretty good

552
00:19:57,120 --> 00:19:58,640
and useful

553
00:19:58,640 --> 00:20:01,440
uh there is one key point uh that will

554
00:20:01,440 --> 00:20:04,159
become very important very very soon

555
00:20:04,159 --> 00:20:07,679
on the four-way handshake and that is

556
00:20:07,679 --> 00:20:09,600
there's actually a couple different

557
00:20:09,600 --> 00:20:11,200
implementations of the four-way

558
00:20:11,200 --> 00:20:12,159
handshake

559
00:20:12,159 --> 00:20:14,960
and not all of them are four-way because

560
00:20:14,960 --> 00:20:16,080
again

561
00:20:16,080 --> 00:20:19,039
cars why why do we have standards who

562
00:20:19,039 --> 00:20:20,080
needs that

563
00:20:20,080 --> 00:20:22,720
no one wants to make life easy or nice

564
00:20:22,720 --> 00:20:24,080
um

565
00:20:24,080 --> 00:20:25,679
in the traditional implementation this

566
00:20:25,679 --> 00:20:27,840
is what we have shown on the screen

567
00:20:27,840 --> 00:20:30,480
and this is what a majority of the cars

568
00:20:30,480 --> 00:20:32,000
that i've tested

569
00:20:32,000 --> 00:20:34,720
have used and based on like reading the

570
00:20:34,720 --> 00:20:36,559
literature of some of the other reports

571
00:20:36,559 --> 00:20:37,919
of people doing

572
00:20:37,919 --> 00:20:40,159
more traditional exploits on fifa on uh

573
00:20:40,159 --> 00:20:41,760
the pke system such as doing really

574
00:20:41,760 --> 00:20:42,960
style attacks

575
00:20:42,960 --> 00:20:44,799
this is the kind of system they run into

576
00:20:44,799 --> 00:20:46,880
too so i'm fairly certain

577
00:20:46,880 --> 00:20:50,640
this is kind of the the main

578
00:20:50,640 --> 00:20:53,120
more universal of the two but it is

579
00:20:53,120 --> 00:20:54,559
important to know that there is an

580
00:20:54,559 --> 00:20:55,200
alternative

581
00:20:55,200 --> 00:20:57,679
implementation of this that consists

582
00:20:57,679 --> 00:20:59,200
only of the challenge and response

583
00:20:59,200 --> 00:21:00,880
messages

584
00:21:00,880 --> 00:21:03,039
of the vehicles that i tested two of

585
00:21:03,039 --> 00:21:05,600
them the 2018 buick encore and the 2020

586
00:21:05,600 --> 00:21:07,120
ford expedition

587
00:21:07,120 --> 00:21:09,840
uh both used the alternative this

588
00:21:09,840 --> 00:21:11,840
alternative implementation

589
00:21:11,840 --> 00:21:15,200
of the four-way handshake now there's

590
00:21:15,200 --> 00:21:17,440
a lot of reasons why you would use the

591
00:21:17,440 --> 00:21:19,280
alternative implementation

592
00:21:19,280 --> 00:21:21,919
uh especially on newer vehicles where

593
00:21:21,919 --> 00:21:23,360
the key fob will respond

594
00:21:23,360 --> 00:21:26,640
back rather in like rather instead of

595
00:21:26,640 --> 00:21:28,080
like a very simple

596
00:21:28,080 --> 00:21:30,640
am on off keying or like a simple little

597
00:21:30,640 --> 00:21:31,440
fs case

598
00:21:31,440 --> 00:21:33,919
fsk transmission maybe they're using

599
00:21:33,919 --> 00:21:35,679
z-wave or bluetooth

600
00:21:35,679 --> 00:21:38,320
or zigbee um up at like the 900

601
00:21:38,320 --> 00:21:39,679
megahertz span

602
00:21:39,679 --> 00:21:42,880
well those data links already have a way

603
00:21:42,880 --> 00:21:45,200
built into them to determine

604
00:21:45,200 --> 00:21:48,960
how close a transmitter is to a receiver

605
00:21:48,960 --> 00:21:50,720
and so the wake up and acknowledgement

606
00:21:50,720 --> 00:21:53,120
messages can be kind of supplanted

607
00:21:53,120 --> 00:21:56,640
by that built-in capability there's also

608
00:21:56,640 --> 00:21:59,200
the general case of maybe you just used

609
00:21:59,200 --> 00:22:00,640
a really large

610
00:22:00,640 --> 00:22:03,200
um or not really large but like really

611
00:22:03,200 --> 00:22:05,360
high capacity coin cell battery

612
00:22:05,360 --> 00:22:06,880
and so therefore you're not quite as

613
00:22:06,880 --> 00:22:09,039
worried as it running out of charge

614
00:22:09,039 --> 00:22:11,280
both of those are completely viable both

615
00:22:11,280 --> 00:22:12,640
of these systems work

616
00:22:12,640 --> 00:22:14,960
um we do have attacks for both of them

617
00:22:14,960 --> 00:22:16,720
and i'll explain those later on

618
00:22:16,720 --> 00:22:19,440
but it is important to know uh that you

619
00:22:19,440 --> 00:22:20,480
will sometimes see a difference

620
00:22:20,480 --> 00:22:21,679
especially if you're doing

621
00:22:21,679 --> 00:22:24,080
this research on your own and you're

622
00:22:24,080 --> 00:22:24,720
sitting there

623
00:22:24,720 --> 00:22:27,120
and you're getting your captures and

624
00:22:27,120 --> 00:22:28,480
you're wondering why you're only seeing

625
00:22:28,480 --> 00:22:28,799
two

626
00:22:28,799 --> 00:22:31,600
instead of four messages this is why it

627
00:22:31,600 --> 00:22:33,200
just means the vehicle you're testing

628
00:22:33,200 --> 00:22:35,520
uses an alternative message

629
00:22:35,520 --> 00:22:38,400
or alternative four-way handshake set up

630
00:22:38,400 --> 00:22:39,280
and so

631
00:22:39,280 --> 00:22:40,720
the message from the vehicle was just

632
00:22:40,720 --> 00:22:42,320
the challenge message and the

633
00:22:42,320 --> 00:22:43,679
response from the key fob is the

634
00:22:43,679 --> 00:22:45,360
response

635
00:22:45,360 --> 00:22:48,400
so now let's get into the fun stuff

636
00:22:48,400 --> 00:22:50,559
how do we actually hack and attack this

637
00:22:50,559 --> 00:22:52,320
system and what can we do

638
00:22:52,320 --> 00:22:56,000
with the key fob that we care about so

639
00:22:56,000 --> 00:22:57,760
before we get too deep into it let's

640
00:22:57,760 --> 00:22:59,520
talk about radar

641
00:22:59,520 --> 00:23:02,240
um most people are familiar with

642
00:23:02,240 --> 00:23:03,919
traditional radar

643
00:23:03,919 --> 00:23:08,159
where you have a big giant antenna dish

644
00:23:08,159 --> 00:23:10,480
and it transmits this crazy weird

645
00:23:10,480 --> 00:23:11,600
frequency thing

646
00:23:11,600 --> 00:23:14,480
at really high power and it hits an

647
00:23:14,480 --> 00:23:15,600
airplane

648
00:23:15,600 --> 00:23:17,120
and it reflects off the skin of the

649
00:23:17,120 --> 00:23:18,720
airplane and then based off those

650
00:23:18,720 --> 00:23:20,960
reflections the dish receives it

651
00:23:20,960 --> 00:23:22,480
and does a bunch of calculations and

652
00:23:22,480 --> 00:23:24,720
math and says oh there's somebody at

653
00:23:24,720 --> 00:23:26,559
that altitude in that angle

654
00:23:26,559 --> 00:23:28,080
and they're possibly moving at this

655
00:23:28,080 --> 00:23:30,559
speed as i track them

656
00:23:30,559 --> 00:23:33,360
that's traditional radar uh that's the

657
00:23:33,360 --> 00:23:35,360
radar that the military uses

658
00:23:35,360 --> 00:23:37,600
for like everything because they're the

659
00:23:37,600 --> 00:23:39,280
military gay

660
00:23:39,280 --> 00:23:41,919
um but it's not the only form of radar

661
00:23:41,919 --> 00:23:43,120
that exists

662
00:23:43,120 --> 00:23:44,720
one of the forms of radar that's

663
00:23:44,720 --> 00:23:46,080
especially more common on the civilian

664
00:23:46,080 --> 00:23:46,799
side

665
00:23:46,799 --> 00:23:48,840
is a type of radar called cooperative

666
00:23:48,840 --> 00:23:50,000
radar

667
00:23:50,000 --> 00:23:52,240
now in cooperative radar you have the

668
00:23:52,240 --> 00:23:53,760
same kind of equipment but everything's

669
00:23:53,760 --> 00:23:55,120
just slightly different

670
00:23:55,120 --> 00:23:58,799
so for example rather than my radar

671
00:23:58,799 --> 00:24:01,279
generating a weird signal and watching

672
00:24:01,279 --> 00:24:02,080
the reflections

673
00:24:02,080 --> 00:24:03,200
it generates what's called an

674
00:24:03,200 --> 00:24:05,919
interrogation which is a simple message

675
00:24:05,919 --> 00:24:08,080
that can be surmised as shouting out

676
00:24:08,080 --> 00:24:09,679
into the into the darkness

677
00:24:09,679 --> 00:24:12,960
is anybody out there um

678
00:24:12,960 --> 00:24:15,440
and the aircraft that is receiving this

679
00:24:15,440 --> 00:24:16,640
interrogation

680
00:24:16,640 --> 00:24:18,320
rather than just letting it reflect off

681
00:24:18,320 --> 00:24:20,559
of its skin and using the backscatter

682
00:24:20,559 --> 00:24:22,159
and all that other crazy physics to

683
00:24:22,159 --> 00:24:23,440
figure out where it is

684
00:24:23,440 --> 00:24:25,360
receives the message decodes it and

685
00:24:25,360 --> 00:24:26,960
sends a message back that says

686
00:24:26,960 --> 00:24:30,159
yes i am here uh if you're familiar with

687
00:24:30,159 --> 00:24:30,960
aviation

688
00:24:30,960 --> 00:24:35,120
this is iff uh iff or adsb are both

689
00:24:35,120 --> 00:24:36,799
wonderful examples of a cooperative

690
00:24:36,799 --> 00:24:38,720
radar system that works

691
00:24:38,720 --> 00:24:40,480
if you're not familiar with aviation

692
00:24:40,480 --> 00:24:42,080
you're actually also probably still

693
00:24:42,080 --> 00:24:44,320
familiar with cooperative radar

694
00:24:44,320 --> 00:24:45,919
just in the form of the pool game marco

695
00:24:45,919 --> 00:24:47,679
polo um

696
00:24:47,679 --> 00:24:49,360
so for those of you who never played it

697
00:24:49,360 --> 00:24:50,880
or who haven't had kids who played it or

698
00:24:50,880 --> 00:24:51,760
whatever or

699
00:24:51,760 --> 00:24:54,960
are scared of the water uh marco polo is

700
00:24:54,960 --> 00:24:56,159
a very popular

701
00:24:56,159 --> 00:24:59,279
childhood pool game where one player who

702
00:24:59,279 --> 00:24:59,520
is

703
00:24:59,520 --> 00:25:02,400
it uh covers their eyes and has to shout

704
00:25:02,400 --> 00:25:03,600
marco

705
00:25:03,600 --> 00:25:06,559
uh and he the that players in the pool

706
00:25:06,559 --> 00:25:08,720
uh shouts out marco every so often to

707
00:25:08,720 --> 00:25:10,080
try to figure out where

708
00:25:10,080 --> 00:25:14,240
everyone else is um the

709
00:25:14,240 --> 00:25:17,520
other players in the pool uh are able to

710
00:25:17,520 --> 00:25:18,960
move around

711
00:25:18,960 --> 00:25:21,120
and every time the player that is it

712
00:25:21,120 --> 00:25:22,159
shouts marco

713
00:25:22,159 --> 00:25:25,279
they have to shout polo so because the

714
00:25:25,279 --> 00:25:27,120
player that is it has their

715
00:25:27,120 --> 00:25:29,679
has their eyes covered uh they have to

716
00:25:29,679 --> 00:25:32,080
use the sound of everyone's response to

717
00:25:32,080 --> 00:25:33,840
figure out where they are and try to

718
00:25:33,840 --> 00:25:36,159
navigate towards them and tag them

719
00:25:36,159 --> 00:25:39,039
this is cooperative radar um this is the

720
00:25:39,039 --> 00:25:40,240
basics of it

721
00:25:40,240 --> 00:25:43,279
this is also why i decided to name my

722
00:25:43,279 --> 00:25:44,400
toolkit

723
00:25:44,400 --> 00:25:47,520
uh marco after the pull after the pool

724
00:25:47,520 --> 00:25:48,320
game

725
00:25:48,320 --> 00:25:51,200
um also because marco polo with an sdr

726
00:25:51,200 --> 00:25:53,039
looks really really funny

727
00:25:53,039 --> 00:25:56,480
but it is what it is um so

728
00:25:56,480 --> 00:25:58,080
that's what we're going to use to keep

729
00:25:58,080 --> 00:25:59,600
up for in these attacks

730
00:25:59,600 --> 00:26:03,120
is we're going to basically turn this

731
00:26:03,120 --> 00:26:05,200
into a cooperative radar system

732
00:26:05,200 --> 00:26:08,400
where uh i or you or

733
00:26:08,400 --> 00:26:10,000
really who any anyone who downloads the

734
00:26:10,000 --> 00:26:12,480
toolkit will use an sdr to generate a

735
00:26:12,480 --> 00:26:14,320
series of interrogations

736
00:26:14,320 --> 00:26:16,000
that will then force the key fob to

737
00:26:16,000 --> 00:26:17,360
respond

738
00:26:17,360 --> 00:26:20,000
like it was a transponder uh either an

739
00:26:20,000 --> 00:26:20,720
aircraft

740
00:26:20,720 --> 00:26:23,200
or a kid shouting polo if you're playing

741
00:26:23,200 --> 00:26:25,440
the pool game

742
00:26:25,440 --> 00:26:28,159
we have two attacks that we'll go over

743
00:26:28,159 --> 00:26:30,880
that i have that work with this

744
00:26:30,880 --> 00:26:32,559
the first is what's called a zero

745
00:26:32,559 --> 00:26:34,960
knowledge identification attack

746
00:26:34,960 --> 00:26:37,679
so in this attack we are targeting the

747
00:26:37,679 --> 00:26:39,520
wake up and acknowledgement messages of

748
00:26:39,520 --> 00:26:41,600
the four-way handshake

749
00:26:41,600 --> 00:26:44,799
and how this works is the attacker just

750
00:26:44,799 --> 00:26:46,480
basically has to generate a bunch of

751
00:26:46,480 --> 00:26:47,919
wake-up messages

752
00:26:47,919 --> 00:26:51,360
very very quickly and the key fob will

753
00:26:51,360 --> 00:26:52,080
then respond

754
00:26:52,080 --> 00:26:55,440
with its acknowledgement now this sounds

755
00:26:55,440 --> 00:26:56,400
simple

756
00:26:56,400 --> 00:27:00,159
and spoiler it is but what you can do

757
00:27:00,159 --> 00:27:01,440
with this attack is actually really

758
00:27:01,440 --> 00:27:02,799
really cool

759
00:27:02,799 --> 00:27:04,799
so remember how i said earlier that both

760
00:27:04,799 --> 00:27:06,480
of these messages are static

761
00:27:06,480 --> 00:27:09,520
and thus they don't change for

762
00:27:09,520 --> 00:27:12,080
any of the vehicles of that given make

763
00:27:12,080 --> 00:27:14,000
model generation

764
00:27:14,000 --> 00:27:15,600
well that means that you could attack a

765
00:27:15,600 --> 00:27:17,679
vehicle and identify

766
00:27:17,679 --> 00:27:20,159
it or identify the driver if the person

767
00:27:20,159 --> 00:27:22,720
is walking around outside their vehicle

768
00:27:22,720 --> 00:27:24,480
without having to know what the key fob

769
00:27:24,480 --> 00:27:26,159
is ahead of time

770
00:27:26,159 --> 00:27:28,799
because if you are here and you have a

771
00:27:28,799 --> 00:27:29,520
library

772
00:27:29,520 --> 00:27:32,960
of a lot of car samples we'll say

773
00:27:32,960 --> 00:27:35,840
like a couple hundred you can generate

774
00:27:35,840 --> 00:27:37,760
every one of those wake up messages

775
00:27:37,760 --> 00:27:40,480
and just run through that list and

776
00:27:40,480 --> 00:27:42,399
whenever you finally get a response from

777
00:27:42,399 --> 00:27:43,240
the key fob

778
00:27:43,240 --> 00:27:45,200
congratulations you now know that the

779
00:27:45,200 --> 00:27:47,120
key fob is a make x

780
00:27:47,120 --> 00:27:50,799
model y generation z whatever

781
00:27:50,799 --> 00:27:54,080
um that's a really cool feature in this

782
00:27:54,080 --> 00:27:56,240
where you don't have to have any not any

783
00:27:56,240 --> 00:27:58,080
specific knowledge of the vehicle you're

784
00:27:58,080 --> 00:27:59,840
trying to attack ahead of time

785
00:27:59,840 --> 00:28:02,080
which is why we call this a zero

786
00:28:02,080 --> 00:28:04,320
knowledge identification attack

787
00:28:04,320 --> 00:28:06,320
i'm able to identify the vehicle on the

788
00:28:06,320 --> 00:28:09,840
fly as it pops up or as i care about it

789
00:28:09,840 --> 00:28:13,120
now as cool as this technique is

790
00:28:13,120 --> 00:28:16,240
it has a couple flaws

791
00:28:16,240 --> 00:28:18,480
first off the acknowledgement message is

792
00:28:18,480 --> 00:28:19,440
also

793
00:28:19,440 --> 00:28:22,159
a static message which means if i have

794
00:28:22,159 --> 00:28:23,200
say

795
00:28:23,200 --> 00:28:26,559
two toyota priuses right beside each

796
00:28:26,559 --> 00:28:29,520
other the same make model generation

797
00:28:29,520 --> 00:28:31,520
i'll know that there are two because for

798
00:28:31,520 --> 00:28:33,440
every wake-up message i transmit i'll

799
00:28:33,440 --> 00:28:34,080
get

800
00:28:34,080 --> 00:28:36,559
two acknowledgement responses but i

801
00:28:36,559 --> 00:28:37,600
won't be able to know

802
00:28:37,600 --> 00:28:41,200
which one is which so say for example

803
00:28:41,200 --> 00:28:43,279
uh we are driving down we are driving

804
00:28:43,279 --> 00:28:45,039
down the road and i have my friend bob

805
00:28:45,039 --> 00:28:46,880
driving because i'm going to be sitting

806
00:28:46,880 --> 00:28:48,159
on the laptop

807
00:28:48,159 --> 00:28:50,720
and we are following two uh we'll stick

808
00:28:50,720 --> 00:28:53,279
with toyota priuses just for the example

809
00:28:53,279 --> 00:28:56,559
one of them is red one of them is blue

810
00:28:56,559 --> 00:28:58,320
i'm sitting here i'm generating my

811
00:28:58,320 --> 00:29:01,120
interrogation i have my antenna running

812
00:29:01,120 --> 00:29:02,880
i'm seeing the acknowledgements

813
00:29:02,880 --> 00:29:04,799
everything's great i can validate that

814
00:29:04,799 --> 00:29:05,200
yes

815
00:29:05,200 --> 00:29:07,200
these are both generation three toyota

816
00:29:07,200 --> 00:29:09,200
priuses because they're responding to

817
00:29:09,200 --> 00:29:11,200
that wake-up message

818
00:29:11,200 --> 00:29:12,960
all of a sudden one of the toyota

819
00:29:12,960 --> 00:29:14,320
priuses turns left

820
00:29:14,320 --> 00:29:17,679
and the other turns right now

821
00:29:17,679 --> 00:29:20,080
i have no way of knowing using this

822
00:29:20,080 --> 00:29:21,200
technique

823
00:29:21,200 --> 00:29:24,399
which one went which way because all i

824
00:29:24,399 --> 00:29:25,919
know is that there are two toyota

825
00:29:25,919 --> 00:29:27,520
priuses based off the acknowledgement

826
00:29:27,520 --> 00:29:28,559
message

827
00:29:28,559 --> 00:29:30,880
i can't tell you which one is the red

828
00:29:30,880 --> 00:29:32,559
one and which one is the blue one

829
00:29:32,559 --> 00:29:35,679
and thus even if i um so

830
00:29:35,679 --> 00:29:36,880
these loop antennas are slightly

831
00:29:36,880 --> 00:29:38,399
directional so even if i spin it and are

832
00:29:38,399 --> 00:29:39,200
like okay

833
00:29:39,200 --> 00:29:41,520
one is to the left one is to the right

834
00:29:41,520 --> 00:29:43,039
i'll still know where they are

835
00:29:43,039 --> 00:29:45,360
but i'm not able to identify them at a

836
00:29:45,360 --> 00:29:46,720
granular level

837
00:29:46,720 --> 00:29:50,000
of which prius is which one

838
00:29:50,000 --> 00:29:53,120
it would be a flat guess um

839
00:29:53,120 --> 00:29:56,240
you so that's kind of the the cost

840
00:29:56,240 --> 00:29:59,279
of this setup is you can

841
00:29:59,279 --> 00:30:02,880
identify everything on the fly but

842
00:30:02,880 --> 00:30:05,440
you're limited on your granularity of

843
00:30:05,440 --> 00:30:06,880
how much you can look at

844
00:30:06,880 --> 00:30:09,200
you're also limited of being only being

845
00:30:09,200 --> 00:30:10,960
able to identify stuff based off how big

846
00:30:10,960 --> 00:30:13,120
the library is

847
00:30:13,120 --> 00:30:15,600
and then as if it wasn't bad enough for

848
00:30:15,600 --> 00:30:16,880
our poor little zero knowledge

849
00:30:16,880 --> 00:30:18,080
identification attack

850
00:30:18,080 --> 00:30:20,080
there's a third thing he has to he has

851
00:30:20,080 --> 00:30:21,279
to deal with

852
00:30:21,279 --> 00:30:22,720
remember how i said earlier that there

853
00:30:22,720 --> 00:30:25,120
were two implementations of the four-way

854
00:30:25,120 --> 00:30:26,640
handshake

855
00:30:26,640 --> 00:30:28,799
well if you happen to be one of the

856
00:30:28,799 --> 00:30:30,720
lucky users that uses an alternative

857
00:30:30,720 --> 00:30:32,240
version of the four-way handshake and

858
00:30:32,240 --> 00:30:33,039
thus

859
00:30:33,039 --> 00:30:36,320
does not have a wake-up message or an

860
00:30:36,320 --> 00:30:38,559
acknowledgement message as a part of

861
00:30:38,559 --> 00:30:40,600
your activation process

862
00:30:40,600 --> 00:30:43,039
congratulations this attack won't affect

863
00:30:43,039 --> 00:30:44,799
you at all

864
00:30:44,799 --> 00:30:47,600
uh so what this ends up meaning is that

865
00:30:47,600 --> 00:30:48,799
while it is true

866
00:30:48,799 --> 00:30:50,559
90 plus percent of the vehicles on the

867
00:30:50,559 --> 00:30:52,880
road use passive keyless entry

868
00:30:52,880 --> 00:30:55,360
and while it's true this kind of zero

869
00:30:55,360 --> 00:30:56,720
information attack will work on a

870
00:30:56,720 --> 00:30:59,039
passive keyless entry system

871
00:30:59,039 --> 00:31:00,880
uh you're not going to be hitting 90

872
00:31:00,880 --> 00:31:02,960
plus percent of the vehicles on the road

873
00:31:02,960 --> 00:31:04,559
my best guess is you're looking at

874
00:31:04,559 --> 00:31:06,960
something around 50

875
00:31:06,960 --> 00:31:09,440
um again i've only unfortunately been

876
00:31:09,440 --> 00:31:11,840
able to test seven vehicles for this

877
00:31:11,840 --> 00:31:14,559
partly because of covid and then like

878
00:31:14,559 --> 00:31:15,360
you know

879
00:31:15,360 --> 00:31:17,120
going over to random people to mess with

880
00:31:17,120 --> 00:31:19,279
their car wasn't really kosher with code

881
00:31:19,279 --> 00:31:20,720
restrictions and then

882
00:31:20,720 --> 00:31:22,559
all the rental car companies sold all

883
00:31:22,559 --> 00:31:24,320
their cars so you couldn't just

884
00:31:24,320 --> 00:31:26,000
go to a lot and hop from one to the

885
00:31:26,000 --> 00:31:27,519
other aisle to aisle

886
00:31:27,519 --> 00:31:29,279
uh so again if you have a vehicle you

887
00:31:29,279 --> 00:31:30,880
wanna help out on this please let me

888
00:31:30,880 --> 00:31:33,600
know i'd love to i'd love to talk to you

889
00:31:33,600 --> 00:31:37,039
um but while the

890
00:31:37,039 --> 00:31:38,960
zero knowledge guy is kind of hit or

891
00:31:38,960 --> 00:31:41,039
miss of having a lot of really cool

892
00:31:41,039 --> 00:31:41,919
functionality

893
00:31:41,919 --> 00:31:45,039
and not requiring a setup he's not able

894
00:31:45,039 --> 00:31:47,120
to hit that many people

895
00:31:47,120 --> 00:31:49,360
the alternative is what i call a

896
00:31:49,360 --> 00:31:51,679
targeted tracking attack

897
00:31:51,679 --> 00:31:54,720
so in this attack we are targeting the

898
00:31:54,720 --> 00:31:56,559
challenge and response messages

899
00:31:56,559 --> 00:31:59,200
which means does not matter whether

900
00:31:59,200 --> 00:32:01,200
you're using alternative passive keyless

901
00:32:01,200 --> 00:32:01,840
entry

902
00:32:01,840 --> 00:32:03,440
or you're using or sorry alternative

903
00:32:03,440 --> 00:32:05,039
four-way handshake or traditional

904
00:32:05,039 --> 00:32:06,320
four-way handshake

905
00:32:06,320 --> 00:32:09,200
this attack will work on you so this is

906
00:32:09,200 --> 00:32:11,200
the attack that will track everyone

907
00:32:11,200 --> 00:32:14,640
and everything everywhere which is great

908
00:32:14,640 --> 00:32:18,799
right fantastic well again their

909
00:32:18,799 --> 00:32:20,720
great power comes great responsibility

910
00:32:20,720 --> 00:32:22,000
and in this case great

911
00:32:22,000 --> 00:32:25,279
responsibility comes with a slight cost

912
00:32:25,279 --> 00:32:27,279
unlike the previous attack where we

913
00:32:27,279 --> 00:32:28,880
didn't need to know anything about the

914
00:32:28,880 --> 00:32:29,919
target ahead of time

915
00:32:29,919 --> 00:32:32,559
we could just basically point an antenna

916
00:32:32,559 --> 00:32:34,159
at them and keep trying

917
00:32:34,159 --> 00:32:36,640
things until they responded and be like

918
00:32:36,640 --> 00:32:38,960
yep that's who they are

919
00:32:38,960 --> 00:32:40,960
this attack requires knowledge of the

920
00:32:40,960 --> 00:32:43,919
vehicle before you're able to spoof it

921
00:32:43,919 --> 00:32:46,159
to be specific recall that the challenge

922
00:32:46,159 --> 00:32:47,600
message contains

923
00:32:47,600 --> 00:32:50,799
the car's unique id that is used by the

924
00:32:50,799 --> 00:32:51,279
k-pop

925
00:32:51,279 --> 00:32:54,399
validate that it's its vehicle

926
00:32:54,399 --> 00:32:57,440
because we are pretending to be the car

927
00:32:57,440 --> 00:33:00,799
uh we have to use that id

928
00:33:00,799 --> 00:33:03,440
but that means we have to solve for it

929
00:33:03,440 --> 00:33:05,279
now there are two ways

930
00:33:05,279 --> 00:33:08,640
one can get this information an easy way

931
00:33:08,640 --> 00:33:11,840
and a hard way the hard way is to

932
00:33:11,840 --> 00:33:13,840
reverse engineer the algorithm

933
00:33:13,840 --> 00:33:15,440
of the specific vehicle that you're

934
00:33:15,440 --> 00:33:17,279
trying to that you're trying to

935
00:33:17,279 --> 00:33:20,159
spoof there have been previous papers

936
00:33:20,159 --> 00:33:21,760
that have done this in some form or

937
00:33:21,760 --> 00:33:22,960
another

938
00:33:22,960 --> 00:33:25,600
mainly looking at the cryptographic chip

939
00:33:25,600 --> 00:33:26,720
used

940
00:33:26,720 --> 00:33:29,120
by the key fob which is the digital

941
00:33:29,120 --> 00:33:30,960
signature transponder

942
00:33:30,960 --> 00:33:33,120
people figured out that a lot of these

943
00:33:33,120 --> 00:33:34,480
ids are based

944
00:33:34,480 --> 00:33:37,600
off of the serial number of the car

945
00:33:37,600 --> 00:33:39,679
but you still have an issue of every

946
00:33:39,679 --> 00:33:40,720
different vehicle is going to have a

947
00:33:40,720 --> 00:33:42,080
slightly different implementation

948
00:33:42,080 --> 00:33:43,120
and so you're going to have to do a lot

949
00:33:43,120 --> 00:33:46,399
of math the easier option

950
00:33:46,399 --> 00:33:49,279
and the option i use doing my research

951
00:33:49,279 --> 00:33:51,360
is you just have to capture

952
00:33:51,360 --> 00:33:54,480
a single message

953
00:33:54,480 --> 00:33:56,159
all you need is a single challenge

954
00:33:56,159 --> 00:33:58,559
message and you are good

955
00:33:58,559 --> 00:34:00,480
this is because the challenge message is

956
00:34:00,480 --> 00:34:03,360
what we like to call deterministic

957
00:34:03,360 --> 00:34:06,159
a deterministic algorithm means that if

958
00:34:06,159 --> 00:34:07,600
i pass you

959
00:34:07,600 --> 00:34:12,000
a value or a key your answer will always

960
00:34:12,000 --> 00:34:14,320
be the exact same it doesn't matter how

961
00:34:14,320 --> 00:34:17,440
often i pass you that same key or

962
00:34:17,440 --> 00:34:21,040
what i passed you beforehand everything

963
00:34:21,040 --> 00:34:25,839
is discrete hence it's deterministic

964
00:34:26,000 --> 00:34:27,760
recall earlier that i said that this

965
00:34:27,760 --> 00:34:29,679
challenge response algorithm is fairly

966
00:34:29,679 --> 00:34:30,560
simple

967
00:34:30,560 --> 00:34:32,159
compared to a lot of the stuff we're

968
00:34:32,159 --> 00:34:33,679
used to in

969
00:34:33,679 --> 00:34:36,399
like the web or an ip based system or

970
00:34:36,399 --> 00:34:38,560
something like that

971
00:34:38,560 --> 00:34:42,159
as a part of this your key fob doesn't

972
00:34:42,159 --> 00:34:44,159
have any way to validate that a

973
00:34:44,159 --> 00:34:46,000
challenge message

974
00:34:46,000 --> 00:34:48,639
actually came from the car that is

975
00:34:48,639 --> 00:34:50,000
claiming

976
00:34:50,000 --> 00:34:53,839
um to be to or that that the person who

977
00:34:53,839 --> 00:34:55,599
claims to be effectively

978
00:34:55,599 --> 00:34:57,760
reason for this is remember all that

979
00:34:57,760 --> 00:34:59,520
challenge message has

980
00:34:59,520 --> 00:35:03,200
is the car id your seed

981
00:35:03,200 --> 00:35:06,560
and your checksum to validate

982
00:35:06,560 --> 00:35:08,880
i can just as easily steal bob's name

983
00:35:08,880 --> 00:35:09,839
tag

984
00:35:09,839 --> 00:35:13,520
pop it on i'm bob now the challenge is

985
00:35:13,520 --> 00:35:16,560
a and you know validate that the message

986
00:35:16,560 --> 00:35:18,240
is correctly

987
00:35:18,240 --> 00:35:21,200
because in in this case of this attack

988
00:35:21,200 --> 00:35:22,480
in particular

989
00:35:22,480 --> 00:35:24,320
i'm only really interested in the key

990
00:35:24,320 --> 00:35:25,760
fob id

991
00:35:25,760 --> 00:35:28,800
i don't care what the response is so i

992
00:35:28,800 --> 00:35:30,880
don't need to pass it some different

993
00:35:30,880 --> 00:35:32,880
challenge every time i can pass it the

994
00:35:32,880 --> 00:35:34,640
exact same challenge

995
00:35:34,640 --> 00:35:36,400
in fact it's easier for me to pass the

996
00:35:36,400 --> 00:35:37,760
exact same challenge because then the

997
00:35:37,760 --> 00:35:39,520
crc value won't change and it's just

998
00:35:39,520 --> 00:35:41,119
going to be the exact same message

999
00:35:41,119 --> 00:35:43,760
every time and all i have to look then

1000
00:35:43,760 --> 00:35:44,560
is

1001
00:35:44,560 --> 00:35:47,040
uh do i get a response and does that

1002
00:35:47,040 --> 00:35:47,680
response

1003
00:35:47,680 --> 00:35:50,160
match my uh key fob id that i'm

1004
00:35:50,160 --> 00:35:51,920
interested in

1005
00:35:51,920 --> 00:35:55,040
so this is the attack that i think is

1006
00:35:55,040 --> 00:35:56,720
kind of like the most useful from a

1007
00:35:56,720 --> 00:35:58,320
practical standpoint

1008
00:35:58,320 --> 00:36:00,240
because while it's true it does require

1009
00:36:00,240 --> 00:36:01,680
some previous knowledge

1010
00:36:01,680 --> 00:36:05,119
it works on everything

1011
00:36:05,119 --> 00:36:07,440
and getting the knowledge needed to

1012
00:36:07,440 --> 00:36:08,640
attack it

1013
00:36:08,640 --> 00:36:11,599
is pretty simple there are plenty of

1014
00:36:11,599 --> 00:36:12,240
attacks on

1015
00:36:12,240 --> 00:36:14,800
active keyless entry systems for example

1016
00:36:14,800 --> 00:36:17,200
where the attacker is sitting there

1017
00:36:17,200 --> 00:36:19,760
and waiting for the victim to press a

1018
00:36:19,760 --> 00:36:21,359
button on their keyboard so that they

1019
00:36:21,359 --> 00:36:23,040
can capture the rolling code message

1020
00:36:23,040 --> 00:36:26,160
into it this is similar but we're not

1021
00:36:26,160 --> 00:36:29,520
even have but actually it's similar but

1022
00:36:29,520 --> 00:36:31,520
it's even more simple

1023
00:36:31,520 --> 00:36:34,160
in that we're not even having to reverse

1024
00:36:34,160 --> 00:36:34,960
the message

1025
00:36:34,960 --> 00:36:36,960
like there's no encryption code that we

1026
00:36:36,960 --> 00:36:38,320
care about on this

1027
00:36:38,320 --> 00:36:40,800
we just need to know the formatting and

1028
00:36:40,800 --> 00:36:42,160
so by ripping out

1029
00:36:42,160 --> 00:36:44,240
a message that works and knowing that

1030
00:36:44,240 --> 00:36:46,800
all that data is good and valid

1031
00:36:46,800 --> 00:36:49,119
we can then go in at any point that we

1032
00:36:49,119 --> 00:36:51,280
want after we have that data

1033
00:36:51,280 --> 00:36:54,480
whether it be today tomorrow two years

1034
00:36:54,480 --> 00:36:56,320
from now 10 years from now even assuming

1035
00:36:56,320 --> 00:36:56,640
the

1036
00:36:56,640 --> 00:36:59,200
battery somehow is still working we can

1037
00:36:59,200 --> 00:37:01,119
track that key fob

1038
00:37:01,119 --> 00:37:03,200
wherever and whenever we want as long as

1039
00:37:03,200 --> 00:37:05,119
it's in transmission range

1040
00:37:05,119 --> 00:37:08,160
and that's pretty cool i think

1041
00:37:08,160 --> 00:37:10,480
um suppose i should also be nice and

1042
00:37:10,480 --> 00:37:12,960
mentioned that i drive 2009 toyota yars

1043
00:37:12,960 --> 00:37:14,880
that doesn't have a key fob at all

1044
00:37:14,880 --> 00:37:17,040
so therefore i'm not affected by this

1045
00:37:17,040 --> 00:37:18,160
research

1046
00:37:18,160 --> 00:37:20,480
uh for those of you panicking right now

1047
00:37:20,480 --> 00:37:22,480
i'm sorry

1048
00:37:22,480 --> 00:37:26,160
but uh with that said uh let's

1049
00:37:26,160 --> 00:37:28,880
take a step back and talk about what are

1050
00:37:28,880 --> 00:37:29,760
the other ways

1051
00:37:29,760 --> 00:37:32,400
to identify vehicles so it's great that

1052
00:37:32,400 --> 00:37:34,000
we're doing all this stuff with the key

1053
00:37:34,000 --> 00:37:34,480
fob

1054
00:37:34,480 --> 00:37:37,760
and like yeah it's cool and okay most of

1055
00:37:37,760 --> 00:37:39,359
us just kind of assume that all you

1056
00:37:39,359 --> 00:37:40,960
would care about a key fob is spoofing

1057
00:37:40,960 --> 00:37:41,920
to steal a car

1058
00:37:41,920 --> 00:37:45,280
so this is like new and crazy

1059
00:37:45,280 --> 00:37:48,240
but we have other ways to track vehicles

1060
00:37:48,240 --> 00:37:49,280
um

1061
00:37:49,280 --> 00:37:51,040
we have a lot of ways actually to track

1062
00:37:51,040 --> 00:37:53,839
vehicles the most common way that you're

1063
00:37:53,839 --> 00:37:55,040
probably familiar with

1064
00:37:55,040 --> 00:37:57,920
is a license plate reader camera um

1065
00:37:57,920 --> 00:37:59,760
these are camera setups that you can get

1066
00:37:59,760 --> 00:38:00,160
for

1067
00:38:00,160 --> 00:38:02,079
anywhere from a thousand dollars give or

1068
00:38:02,079 --> 00:38:05,040
take or sometimes a little less

1069
00:38:05,040 --> 00:38:08,079
they sit on your either your vehicle

1070
00:38:08,079 --> 00:38:10,640
or on your property you aim them in a

1071
00:38:10,640 --> 00:38:12,320
car and basically they do

1072
00:38:12,320 --> 00:38:15,119
like an open cv excuse me they do an

1073
00:38:15,119 --> 00:38:16,880
open cv algorithm

1074
00:38:16,880 --> 00:38:20,160
to grab the license plate number

1075
00:38:20,160 --> 00:38:22,240
look it up in a database and tell you

1076
00:38:22,240 --> 00:38:23,920
who it is and because

1077
00:38:23,920 --> 00:38:26,320
every car legally legally driven in the

1078
00:38:26,320 --> 00:38:28,160
u.s has to have a license plate

1079
00:38:28,160 --> 00:38:30,880
this works really well these tend to

1080
00:38:30,880 --> 00:38:32,000
have a range of

1081
00:38:32,000 --> 00:38:35,839
around 30 meters give or take

1082
00:38:35,839 --> 00:38:38,560
um license plates readers can be really

1083
00:38:38,560 --> 00:38:41,119
delicate and sensitive to light

1084
00:38:41,119 --> 00:38:44,320
to angle because obviously all they care

1085
00:38:44,320 --> 00:38:45,839
about is the license plate itself they

1086
00:38:45,839 --> 00:38:47,920
don't care about everything else

1087
00:38:47,920 --> 00:38:49,760
um and so they can be a little bit but

1088
00:38:49,760 --> 00:38:51,839
you're looking at at least

1089
00:38:51,839 --> 00:38:54,720
the ones that i saw on amazon they were

1090
00:38:54,720 --> 00:38:56,960
reporting ranges of around 30 meters as

1091
00:38:56,960 --> 00:38:59,520
their maximum expected range

1092
00:38:59,520 --> 00:39:01,040
the other main competition that we're

1093
00:39:01,040 --> 00:39:02,560
competing against

1094
00:39:02,560 --> 00:39:05,440
is uh tpms to your tire pressure

1095
00:39:05,440 --> 00:39:06,720
monitoring system

1096
00:39:06,720 --> 00:39:09,440
this is a very simple data link it's in

1097
00:39:09,440 --> 00:39:10,800
every one of your tires

1098
00:39:10,800 --> 00:39:12,880
mandated since 2008 it's completely

1099
00:39:12,880 --> 00:39:14,240
universal

1100
00:39:14,240 --> 00:39:17,040
and basically as you're driving along

1101
00:39:17,040 --> 00:39:19,040
your tires will periodically broadcast

1102
00:39:19,040 --> 00:39:19,920
to your car

1103
00:39:19,920 --> 00:39:23,280
what their pressure is um this happens

1104
00:39:23,280 --> 00:39:24,960
roughly every 30 seconds when you're

1105
00:39:24,960 --> 00:39:26,560
moving at speed

1106
00:39:26,560 --> 00:39:28,880
at speed in this case tends to mean any

1107
00:39:28,880 --> 00:39:31,680
above either 30 or 35 miles per hour

1108
00:39:31,680 --> 00:39:33,200
and so as you're rolling along the roads

1109
00:39:33,200 --> 00:39:34,800
your tires are periodically telling your

1110
00:39:34,800 --> 00:39:35,920
car what the pressure

1111
00:39:35,920 --> 00:39:38,079
is this is useful because it can give

1112
00:39:38,079 --> 00:39:40,560
you a heads up that a tire is deflating

1113
00:39:40,560 --> 00:39:42,400
um it'll also happen whenever you first

1114
00:39:42,400 --> 00:39:44,079
turn your car on so you'll know if your

1115
00:39:44,079 --> 00:39:45,599
tires are under inflated need to

1116
00:39:45,599 --> 00:39:47,040
reinflate them

1117
00:39:47,040 --> 00:39:48,720
and the whole point of it was to stop

1118
00:39:48,720 --> 00:39:50,800
people from basically ignoring their

1119
00:39:50,800 --> 00:39:52,800
tire pressure and having blowouts on the

1120
00:39:52,800 --> 00:39:55,359
side of the road

1121
00:39:55,359 --> 00:39:57,760
because of where a tpms sensor is

1122
00:39:57,760 --> 00:40:00,320
located at inside the tire itself

1123
00:40:00,320 --> 00:40:03,839
um it's actually really hard to get

1124
00:40:03,839 --> 00:40:07,359
captures of it uh because depending upon

1125
00:40:07,359 --> 00:40:09,359
what side of the road you're standing on

1126
00:40:09,359 --> 00:40:10,720
or if you're above the vehicle

1127
00:40:10,720 --> 00:40:12,880
or something like that that signal has

1128
00:40:12,880 --> 00:40:14,480
to go through the entire car

1129
00:40:14,480 --> 00:40:16,960
well cars are kind of big heavy bulky

1130
00:40:16,960 --> 00:40:18,400
metal objects

1131
00:40:18,400 --> 00:40:20,480
and you know a lot of signals don't

1132
00:40:20,480 --> 00:40:22,000
travel through solid metal

1133
00:40:22,000 --> 00:40:25,280
that well or even mostly solid metal

1134
00:40:25,280 --> 00:40:28,640
um add to that that tpms is

1135
00:40:28,640 --> 00:40:30,319
time independent you're only operating

1136
00:40:30,319 --> 00:40:31,920
once every 30 seconds so it's kind of

1137
00:40:31,920 --> 00:40:34,160
random whenever you get somebody

1138
00:40:34,160 --> 00:40:37,280
and these signals because they're being

1139
00:40:37,280 --> 00:40:39,280
generated by the tire are very very low

1140
00:40:39,280 --> 00:40:41,119
power here you're only looking at a

1141
00:40:41,119 --> 00:40:42,079
range of about

1142
00:40:42,079 --> 00:40:46,560
10 meters so relatively short

1143
00:40:46,560 --> 00:40:48,720
now on the testing that i have done here

1144
00:40:48,720 --> 00:40:50,079
at the university

1145
00:40:50,079 --> 00:40:53,280
uh which is basically consisted of me

1146
00:40:53,280 --> 00:40:55,280
the wonderful toyota prius that you saw

1147
00:40:55,280 --> 00:40:57,040
earlier that is in totally drivable

1148
00:40:57,040 --> 00:40:58,960
conditions and is not completely stuck

1149
00:40:58,960 --> 00:41:00,640
on the parking spot that it is currently

1150
00:41:00,640 --> 00:41:01,599
residing in

1151
00:41:01,599 --> 00:41:05,119
and will reside into the end of time

1152
00:41:05,119 --> 00:41:06,880
i just basically walked around and used

1153
00:41:06,880 --> 00:41:09,280
parking uh space lines as a measurement

1154
00:41:09,280 --> 00:41:10,240
indicator

1155
00:41:10,240 --> 00:41:12,319
so full disclosure this is not a super

1156
00:41:12,319 --> 00:41:13,680
scientifically accurate test

1157
00:41:13,680 --> 00:41:16,160
because it's me out of the sun carrying

1158
00:41:16,160 --> 00:41:17,440
this laptop around

1159
00:41:17,440 --> 00:41:19,359
intra and then using google earth to

1160
00:41:19,359 --> 00:41:21,440
measure how far away i am from where i

1161
00:41:21,440 --> 00:41:24,160
from where i think i'm at uh and that

1162
00:41:24,160 --> 00:41:24,800
got me

1163
00:41:24,800 --> 00:41:28,000
uh roughly 30 to 40 meters depending

1164
00:41:28,000 --> 00:41:29,359
upon the trial run

1165
00:41:29,359 --> 00:41:33,119
of range using um the targeted tracking

1166
00:41:33,119 --> 00:41:34,160
attack

1167
00:41:34,160 --> 00:41:37,520
so basically setting the key fob up

1168
00:41:37,520 --> 00:41:40,480
um i was not using this antenna i was

1169
00:41:40,480 --> 00:41:41,200
using

1170
00:41:41,200 --> 00:41:44,560
a meter i was using the

1171
00:41:44,560 --> 00:41:46,480
full size version of the u-loop antenna

1172
00:41:46,480 --> 00:41:48,319
which is about a meter

1173
00:41:48,319 --> 00:41:51,440
diameter loop also with a

1174
00:41:51,440 --> 00:41:55,280
uh with a preamp attached to it to aim

1175
00:41:55,280 --> 00:41:58,480
to power up the signal

1176
00:41:59,119 --> 00:42:01,040
the reason why i'm not using that gear

1177
00:42:01,040 --> 00:42:02,960
for this demo is because i wanted to a

1178
00:42:02,960 --> 00:42:04,160
have the antenna on

1179
00:42:04,160 --> 00:42:06,240
on screen and so doing something that

1180
00:42:06,240 --> 00:42:08,240
was the size of me was just too bulky

1181
00:42:08,240 --> 00:42:11,520
and b i general rule of rf whenever

1182
00:42:11,520 --> 00:42:13,280
you're transmitting something at power

1183
00:42:13,280 --> 00:42:14,960
it's a really bad idea to have them that

1184
00:42:14,960 --> 00:42:16,560
close so that's why we're using this

1185
00:42:16,560 --> 00:42:18,400
antenna today

1186
00:42:18,400 --> 00:42:21,440
but using that range i was able to get

1187
00:42:21,440 --> 00:42:24,640
close to a really good

1188
00:42:24,640 --> 00:42:27,680
uh really good uh line uh

1189
00:42:27,680 --> 00:42:30,720
license plate camera range without

1190
00:42:30,720 --> 00:42:32,880
having to see the license plate unlike

1191
00:42:32,880 --> 00:42:34,800
the license plate reader

1192
00:42:34,800 --> 00:42:36,480
this attack works in any in all

1193
00:42:36,480 --> 00:42:37,920
directions because it's rf

1194
00:42:37,920 --> 00:42:39,400
and your key fob radiates

1195
00:42:39,400 --> 00:42:41,440
omnidirectionally

1196
00:42:41,440 --> 00:42:43,040
omnidirectionally just means in all

1197
00:42:43,040 --> 00:42:45,760
directions um

1198
00:42:45,760 --> 00:42:48,400
so you know this attack also has a

1199
00:42:48,400 --> 00:42:49,200
unique feature

1200
00:42:49,200 --> 00:42:51,359
in that it works whether you're carrying

1201
00:42:51,359 --> 00:42:53,440
your key fob in your car

1202
00:42:53,440 --> 00:42:55,839
or whether you have it on your person

1203
00:42:55,839 --> 00:42:58,000
like in your purse or your pocket

1204
00:42:58,000 --> 00:43:00,560
which is what we all do with our keys

1205
00:43:00,560 --> 00:43:03,839
when we're out walking around

1206
00:43:04,079 --> 00:43:07,280
so with that said

1207
00:43:07,280 --> 00:43:10,640
i have a quick demo that i'm going to do

1208
00:43:10,640 --> 00:43:12,160
that will basically just

1209
00:43:12,160 --> 00:43:14,640
show you uh the generation of the

1210
00:43:14,640 --> 00:43:15,920
challenge message

1211
00:43:15,920 --> 00:43:19,359
i have two key fobs here this is the key

1212
00:43:19,359 --> 00:43:21,520
fob that is paired to our 2014 toyota

1213
00:43:21,520 --> 00:43:22,720
yaris

1214
00:43:22,720 --> 00:43:25,760
this is a 2014 200 yards key fob that i

1215
00:43:25,760 --> 00:43:26,000
bought

1216
00:43:26,000 --> 00:43:28,160
off amazon that is not paired and so

1217
00:43:28,160 --> 00:43:29,359
i'll show you how

1218
00:43:29,359 --> 00:43:31,920
they behave with the challenge message

1219
00:43:31,920 --> 00:43:32,560
um

1220
00:43:32,560 --> 00:43:34,000
and then we'll also talk about what you

1221
00:43:34,000 --> 00:43:35,839
can do to protect yourself

1222
00:43:35,839 --> 00:43:39,280
against this attack so

1223
00:43:39,280 --> 00:43:42,640
i'm going to stop sharing here

1224
00:43:42,640 --> 00:43:46,079
i am going to start sharing

1225
00:43:46,079 --> 00:43:50,160
uh and so you should

1226
00:43:50,160 --> 00:43:53,520
now see a waterfall graph

1227
00:43:53,520 --> 00:43:56,560
so this is sdr sharp this is a open

1228
00:43:56,560 --> 00:43:58,880
source

1229
00:43:58,880 --> 00:44:00,400
waterfall generator for those you're not

1230
00:44:00,400 --> 00:44:02,560
familiar with rf a waterfall graph is

1231
00:44:02,560 --> 00:44:04,400
just a representation

1232
00:44:04,400 --> 00:44:08,000
of rf power over time you can see it's

1233
00:44:08,000 --> 00:44:09,359
normally blue

1234
00:44:09,359 --> 00:44:11,040
whenever i go here and push the button

1235
00:44:11,040 --> 00:44:12,880
and force the key fob to transmit

1236
00:44:12,880 --> 00:44:15,520
you see we have that nice little little

1237
00:44:15,520 --> 00:44:16,480
spike

1238
00:44:16,480 --> 00:44:18,000
at the frequency it's transmitting it

1239
00:44:18,000 --> 00:44:19,839
and you can see how the the color

1240
00:44:19,839 --> 00:44:20,880
changes

1241
00:44:20,880 --> 00:44:23,119
based off the power level uh that this

1242
00:44:23,119 --> 00:44:25,200
that the key fob is transmitting at

1243
00:44:25,200 --> 00:44:27,920
so we put those over there uh i'm now

1244
00:44:27,920 --> 00:44:28,800
going to go

1245
00:44:28,800 --> 00:44:32,160
into uh i have a little vm running

1246
00:44:32,160 --> 00:44:34,720
that has all this set up make sure

1247
00:44:34,720 --> 00:44:37,839
everything is connected

1248
00:44:38,640 --> 00:44:41,598
that is on

1249
00:44:42,319 --> 00:44:44,400
um i suppose i should also mention at

1250
00:44:44,400 --> 00:44:45,760
this point uh

1251
00:44:45,760 --> 00:44:48,240
i have the marco code all online it is

1252
00:44:48,240 --> 00:44:49,599
on github it is

1253
00:44:49,599 --> 00:44:51,440
publicly available for you and anyone

1254
00:44:51,440 --> 00:44:53,200
else who wants to to download and use

1255
00:44:53,200 --> 00:44:54,480
this toolkit

1256
00:44:54,480 --> 00:44:57,920
um it's at uh z tulsa

1257
00:44:57,920 --> 00:45:01,040
pke is the github link it's written in

1258
00:45:01,040 --> 00:45:03,359
python and uses canoe radio

1259
00:45:03,359 --> 00:45:05,040
for those of you who have never used gnu

1260
00:45:05,040 --> 00:45:07,359
radio before congratulations you sweet

1261
00:45:07,359 --> 00:45:08,480
summer child

1262
00:45:08,480 --> 00:45:11,119
uh for those of you who have yeah it's a

1263
00:45:11,119 --> 00:45:12,720
little hit or miss to work but

1264
00:45:12,720 --> 00:45:15,440
marco acts as a python script that runs

1265
00:45:15,440 --> 00:45:16,640
on top of that

1266
00:45:16,640 --> 00:45:18,880
and allows you to dynamically generate

1267
00:45:18,880 --> 00:45:20,640
messages

1268
00:45:20,640 --> 00:45:23,119
where a gnu radio module that i wrote

1269
00:45:23,119 --> 00:45:26,480
converts those into the pke format

1270
00:45:26,480 --> 00:45:28,160
and this allows you to do a bunch of

1271
00:45:28,160 --> 00:45:30,960
different cars very very easily

1272
00:45:30,960 --> 00:45:34,079
in our case we are going to do a demo

1273
00:45:34,079 --> 00:45:35,599
configs

1274
00:45:35,599 --> 00:45:39,599
and we are going to do a demo message

1275
00:45:39,599 --> 00:45:42,400
that all looks good this is going to

1276
00:45:42,400 --> 00:45:43,839
transmit a message

1277
00:45:43,839 --> 00:45:47,520
once every second and so if i hold it up

1278
00:45:47,520 --> 00:45:47,920
here

1279
00:45:47,920 --> 00:45:51,599
like this hopefully you should both

1280
00:45:51,599 --> 00:45:53,440
be able to see the little red light

1281
00:45:53,440 --> 00:45:55,119
flashing every second

1282
00:45:55,119 --> 00:45:56,800
and you'll see the waterfall graph going

1283
00:45:56,800 --> 00:45:58,960
on now

1284
00:45:58,960 --> 00:46:01,440
this gets into a weakness that i forgot

1285
00:46:01,440 --> 00:46:02,319
to mention

1286
00:46:02,319 --> 00:46:05,520
when discussing the targeted attack so

1287
00:46:05,520 --> 00:46:09,520
your key fob contains a a really simple

1288
00:46:09,520 --> 00:46:13,040
cryptographic um chipset in it called a

1289
00:46:13,040 --> 00:46:14,400
digital signature transponder they're

1290
00:46:14,400 --> 00:46:15,920
made by texas instruments

1291
00:46:15,920 --> 00:46:18,240
texas instruments is like very paranoid

1292
00:46:18,240 --> 00:46:20,000
about letting data about this

1293
00:46:20,000 --> 00:46:23,040
chipset out and that chipset is what is

1294
00:46:23,040 --> 00:46:24,880
tied to your led

1295
00:46:24,880 --> 00:46:26,319
on your key fob for those of you that

1296
00:46:26,319 --> 00:46:28,240
have an led on your key fob

1297
00:46:28,240 --> 00:46:31,359
um that means that anything that

1298
00:46:31,359 --> 00:46:34,400
causes that chipset to activate will

1299
00:46:34,400 --> 00:46:35,920
cause the led to light up

1300
00:46:35,920 --> 00:46:37,520
so in this case because we're generating

1301
00:46:37,520 --> 00:46:39,040
a challenge message

1302
00:46:39,040 --> 00:46:41,040
and forcing a response message to

1303
00:46:41,040 --> 00:46:42,720
generate

1304
00:46:42,720 --> 00:46:45,839
that is that causes the led to light up

1305
00:46:45,839 --> 00:46:47,920
by comparison if i were to only generate

1306
00:46:47,920 --> 00:46:49,520
the wake up message

1307
00:46:49,520 --> 00:46:51,440
and not generate the challenge message

1308
00:46:51,440 --> 00:46:53,119
the led would not light up and you would

1309
00:46:53,119 --> 00:46:54,880
have no way of knowing that the attack

1310
00:46:54,880 --> 00:46:55,200
was

1311
00:46:55,200 --> 00:46:57,520
was happening if you were the victim but

1312
00:46:57,520 --> 00:46:59,599
again the crux of that is

1313
00:46:59,599 --> 00:47:02,079
when i'm only targeting wake up i can't

1314
00:47:02,079 --> 00:47:03,760
identify you uniquely

1315
00:47:03,760 --> 00:47:07,440
now by comparison

1316
00:47:07,440 --> 00:47:10,800
if i go over here and now use

1317
00:47:10,800 --> 00:47:13,920
oh shoot hold on sorry i had that

1318
00:47:13,920 --> 00:47:16,160
still pointed at it uh the beam pattern

1319
00:47:16,160 --> 00:47:17,040
for this guy

1320
00:47:17,040 --> 00:47:25,520
is why is that still going on

1321
00:47:25,520 --> 00:47:29,119
there we go okay um my apologies for

1322
00:47:29,119 --> 00:47:30,400
thinking

1323
00:47:30,400 --> 00:47:32,480
the beam powder on this guy is such that

1324
00:47:32,480 --> 00:47:33,839
he's not going to be activating which is

1325
00:47:33,839 --> 00:47:35,280
why if you see

1326
00:47:35,280 --> 00:47:38,960
the led doesn't light up on him uh

1327
00:47:38,960 --> 00:47:41,359
so he is not generating signals right

1328
00:47:41,359 --> 00:47:42,319
now

1329
00:47:42,319 --> 00:47:44,000
we have someone else transmitting don't

1330
00:47:44,000 --> 00:47:46,000
know who but

1331
00:47:46,000 --> 00:47:49,119
yeah that's the uh targeted attack

1332
00:47:49,119 --> 00:47:52,160
um that's the basics of it

1333
00:47:52,160 --> 00:47:55,839
so again this guy

1334
00:47:55,839 --> 00:47:57,760
will transmit and respond if i don't

1335
00:47:57,760 --> 00:47:59,440
have anything nearby him he doesn't

1336
00:47:59,440 --> 00:48:02,000
if i put it nearby him he's now

1337
00:48:02,000 --> 00:48:03,760
transmitting and talking

1338
00:48:03,760 --> 00:48:07,599
and you can see it uh no he's not

1339
00:48:07,599 --> 00:48:09,599
now if you are wanting to protect

1340
00:48:09,599 --> 00:48:10,960
yourself against this attack it's

1341
00:48:10,960 --> 00:48:11,520
actually

1342
00:48:11,520 --> 00:48:15,119
super easy uh so fun fact

1343
00:48:15,119 --> 00:48:19,200
when you go to turn on your car

1344
00:48:19,200 --> 00:48:24,079
your car doesn't actually care um

1345
00:48:24,079 --> 00:48:27,040
whether one or all right look up your

1346
00:48:27,040 --> 00:48:28,240
car doesn't care

1347
00:48:28,240 --> 00:48:30,480
once it started if the key fob is

1348
00:48:30,480 --> 00:48:32,240
present or not

1349
00:48:32,240 --> 00:48:36,000
this means that you can just basically

1350
00:48:36,000 --> 00:48:38,240
turn the car on and put the key fob in

1351
00:48:38,240 --> 00:48:40,079
like a really simple copper bag

1352
00:48:40,079 --> 00:48:41,680
like the uh thing that they ship

1353
00:48:41,680 --> 00:48:44,400
passports in and you're fine

1354
00:48:44,400 --> 00:48:46,160
because you're in effectively a faraday

1355
00:48:46,160 --> 00:48:49,359
bag the data won't get transmitted out

1356
00:48:49,359 --> 00:48:51,119
or get transmitted in the keypad won't

1357
00:48:51,119 --> 00:48:53,520
respond and you're safe

1358
00:48:53,520 --> 00:48:55,760
but that requires remembering to put a

1359
00:48:55,760 --> 00:48:57,280
key fob that you normally just leave in

1360
00:48:57,280 --> 00:48:59,520
your pocket or purse and never touch

1361
00:48:59,520 --> 00:49:03,040
into a bag and so let's be honest odds

1362
00:49:03,040 --> 00:49:06,000
are 99 of people aren't going to do it

1363
00:49:06,000 --> 00:49:09,280
um but yeah that is the uh

1364
00:49:09,280 --> 00:49:12,400
basics of my research with key fobs in

1365
00:49:12,400 --> 00:49:14,640
passive keyless entry systems

1366
00:49:14,640 --> 00:49:17,760
uh again this is a kind of really cool

1367
00:49:17,760 --> 00:49:18,240
space

1368
00:49:18,240 --> 00:49:21,119
because we're using key fobs in a way

1369
00:49:21,119 --> 00:49:22,000
that like

1370
00:49:22,000 --> 00:49:24,720
most people have kind of ignored uh we

1371
00:49:24,720 --> 00:49:26,240
also have the advantage

1372
00:49:26,240 --> 00:49:30,000
of being able to go in

1373
00:49:30,000 --> 00:49:34,160
and turn these things into a radar

1374
00:49:34,160 --> 00:49:35,119
system which

1375
00:49:35,119 --> 00:49:37,280
they were totally never designed to be

1376
00:49:37,280 --> 00:49:38,880
which i consider like

1377
00:49:38,880 --> 00:49:43,280
super cool um so if you want to

1378
00:49:43,280 --> 00:49:45,359
download the source code it's on my

1379
00:49:45,359 --> 00:49:46,480
github repo

1380
00:49:46,480 --> 00:49:51,520
z tulsa pke please feel free to

1381
00:49:57,040 --> 00:49:59,520
have download couple tutorials on how to

1382
00:49:59,520 --> 00:50:01,839
do captures of your own

1383
00:50:01,839 --> 00:50:04,480
unfortunately i don't get great radar

1384
00:50:04,480 --> 00:50:06,000
sorry great wi-fi reception in the

1385
00:50:06,000 --> 00:50:07,599
parking lot so i apologize for not being

1386
00:50:07,599 --> 00:50:09,760
able to show that as a part of this

1387
00:50:09,760 --> 00:50:12,559
tutorial it's really really simple i

1388
00:50:12,559 --> 00:50:13,040
promise

1389
00:50:13,040 --> 00:50:14,720
all you need is just like one or two

1390
00:50:14,720 --> 00:50:16,480
sdrs to set up in there to capture your

1391
00:50:16,480 --> 00:50:17,680
signals and then to go through the

1392
00:50:17,680 --> 00:50:19,119
analysis

1393
00:50:19,119 --> 00:50:22,000
um so yeah thank you for watching i hope

1394
00:50:22,000 --> 00:50:23,280
you enjoyed

1395
00:50:23,280 --> 00:50:27,839
uh and have fun at defcon

1396
00:50:38,839 --> 00:50:41,839
bye

1397
00:50:42,800 --> 00:50:44,880
you

