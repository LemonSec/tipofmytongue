1
00:00:09,280 --> 00:00:10,000
all right

2
00:00:10,000 --> 00:00:12,559
so hello bluetooth village and welcome

3
00:00:12,559 --> 00:00:13,360
to my talk

4
00:00:13,360 --> 00:00:15,920
so i'll be discussing for today a title

5
00:00:15,920 --> 00:00:18,320
called forensicating endpoint artifacts

6
00:00:18,320 --> 00:00:20,640
in the world of cloud storage services

7
00:00:20,640 --> 00:00:22,000
my name is friends and crews

8
00:00:22,000 --> 00:00:25,199
and then i'll be starting and sharing my

9
00:00:25,199 --> 00:00:27,599
screen

10
00:00:28,160 --> 00:00:31,679
i hope you can see my screen

11
00:00:31,679 --> 00:00:35,600
there you go okay let's start

12
00:00:35,600 --> 00:00:39,120
so again my name is renzon cruz i'm

13
00:00:39,120 --> 00:00:42,079
a dfir guy i'm doing digital forensics

14
00:00:42,079 --> 00:00:44,160
and incident response on my work in one

15
00:00:44,160 --> 00:00:45,840
of the companies in uk

16
00:00:45,840 --> 00:00:48,719
uh but i'm based here in dubai i'm also

17
00:00:48,719 --> 00:00:50,559
an ex-security consultant

18
00:00:50,559 --> 00:00:53,840
ir i'm part of the ncsa or they call it

19
00:00:53,840 --> 00:00:54,800
a national

20
00:00:54,800 --> 00:00:56,719
cyber security agency in one of the

21
00:00:56,719 --> 00:00:58,480
countries in middle east

22
00:00:58,480 --> 00:01:01,680
i'm also a co-founder of gaidem so we do

23
00:01:01,680 --> 00:01:02,399
specialize

24
00:01:02,399 --> 00:01:05,840
in a training program for aspiring um

25
00:01:05,840 --> 00:01:08,880
cyber security professionals and we do

26
00:01:08,880 --> 00:01:09,360
offer

27
00:01:09,360 --> 00:01:12,240
like cyber defense threat hunting vapt

28
00:01:12,240 --> 00:01:13,520
kind of thing

29
00:01:13,520 --> 00:01:16,720
and also i got accepted um by various

30
00:01:16,720 --> 00:01:17,920
conferences

31
00:01:17,920 --> 00:01:21,360
um such as besides london vancouver doha

32
00:01:21,360 --> 00:01:23,680
root call in philippines uh recently we

33
00:01:23,680 --> 00:01:24,799
had the north sec

34
00:01:24,799 --> 00:01:27,920
couple of months ago in montreal and now

35
00:01:27,920 --> 00:01:28,400
here

36
00:01:28,400 --> 00:01:31,040
in bluton village at defcon so thank you

37
00:01:31,040 --> 00:01:32,159
so much

38
00:01:32,159 --> 00:01:35,759
for those btv folks and

39
00:01:35,759 --> 00:01:40,079
for the councils who accepted my top

40
00:01:40,079 --> 00:01:43,119
and just a caveat there that this is

41
00:01:43,119 --> 00:01:46,079
not a talk primarily related to the big

42
00:01:46,079 --> 00:01:46,560
three

43
00:01:46,560 --> 00:01:49,439
or uh the the big three cloud service

44
00:01:49,439 --> 00:01:51,360
providers such as aws

45
00:01:51,360 --> 00:01:54,720
from amazon gcp or google cloud

46
00:01:54,720 --> 00:01:57,200
platform and also microsoft azure so if

47
00:01:57,200 --> 00:01:58,000
you're here

48
00:01:58,000 --> 00:01:59,680
uh just to learn more about this stuff

49
00:01:59,680 --> 00:02:02,159
so this is not the talk for you

50
00:02:02,159 --> 00:02:05,360
i'm particularly discussing

51
00:02:05,360 --> 00:02:08,318
uh the cloud storage services and maybe

52
00:02:08,318 --> 00:02:08,800
some

53
00:02:08,800 --> 00:02:11,038
maybe probably in the near future i'll

54
00:02:11,038 --> 00:02:12,239
be discussing this

55
00:02:12,239 --> 00:02:15,120
and um we'll talk about cloud forensics

56
00:02:15,120 --> 00:02:16,239
and ir

57
00:02:16,239 --> 00:02:19,440
um that and also um the things that you

58
00:02:19,440 --> 00:02:20,160
have to do

59
00:02:20,160 --> 00:02:22,480
when there's an incident but for now uh

60
00:02:22,480 --> 00:02:23,840
we're just going to discuss

61
00:02:23,840 --> 00:02:25,360
the cloud storage and also the

62
00:02:25,360 --> 00:02:27,840
footprints leaving behind on the

63
00:02:27,840 --> 00:02:29,840
endpoints

64
00:02:29,840 --> 00:02:33,280
and this is what i'm saying i will be

65
00:02:33,280 --> 00:02:36,000
analyzing the footprints related to the

66
00:02:36,000 --> 00:02:36,640
box

67
00:02:36,640 --> 00:02:39,920
dropbox um google drive mega

68
00:02:39,920 --> 00:02:43,440
and also uh onedrive okay so these are

69
00:02:43,440 --> 00:02:45,360
the primary cloud storage apps that we

70
00:02:45,360 --> 00:02:46,239
have today

71
00:02:46,239 --> 00:02:47,920
uh there are a couple of versions or two

72
00:02:47,920 --> 00:02:50,000
versions that we have

73
00:02:50,000 --> 00:02:52,000
for this so number one is the personal

74
00:02:52,000 --> 00:02:53,920
drive which typically used by the

75
00:02:53,920 --> 00:02:54,959
consumers

76
00:02:54,959 --> 00:02:57,440
and there is also a second one which is

77
00:02:57,440 --> 00:02:59,120
the business version

78
00:02:59,120 --> 00:03:01,519
okay so on the business versions the the

79
00:03:01,519 --> 00:03:03,360
main difference there is the added

80
00:03:03,360 --> 00:03:04,720
features such as

81
00:03:04,720 --> 00:03:07,040
file on demands uh there's also a

82
00:03:07,040 --> 00:03:09,120
different retention policy that you can

83
00:03:09,120 --> 00:03:09,840
extend

84
00:03:09,840 --> 00:03:12,560
from 90 days up to whatever you want

85
00:03:12,560 --> 00:03:13,519
depends on

86
00:03:13,519 --> 00:03:16,480
the storage that you have and also more

87
00:03:16,480 --> 00:03:17,440
robust lagging

88
00:03:17,440 --> 00:03:19,440
but on this stuff we're just gonna focus

89
00:03:19,440 --> 00:03:20,480
and showcase

90
00:03:20,480 --> 00:03:23,840
more on the personal version itself now

91
00:03:23,840 --> 00:03:26,879
the question is in the world where the

92
00:03:26,879 --> 00:03:28,560
most important data is

93
00:03:28,560 --> 00:03:30,879
only present on probably third party

94
00:03:30,879 --> 00:03:33,519
systems how do we effectively accomplish

95
00:03:33,519 --> 00:03:36,239
our analysis and investigations is there

96
00:03:36,239 --> 00:03:37,120
anything left

97
00:03:37,120 --> 00:03:39,519
on the endpoint that can be used for

98
00:03:39,519 --> 00:03:41,040
forensics

99
00:03:41,040 --> 00:03:43,200
so that is the topic that i'm going to

100
00:03:43,200 --> 00:03:44,159
discuss

101
00:03:44,159 --> 00:03:46,560
mainly to to have a forensic goodness

102
00:03:46,560 --> 00:03:47,599
and showcase this

103
00:03:47,599 --> 00:03:49,920
uh forensic goodness of these five

104
00:03:49,920 --> 00:03:52,239
predominate cloud storage apps

105
00:03:52,239 --> 00:03:55,040
that we have and i also have um a logo

106
00:03:55,040 --> 00:03:55,439
here

107
00:03:55,439 --> 00:03:58,799
in icloud but basically um it's quite

108
00:03:58,799 --> 00:03:59,439
popular

109
00:03:59,439 --> 00:04:01,360
especially for those apple fanboys out

110
00:04:01,360 --> 00:04:03,519
there but it tends to be used

111
00:04:03,519 --> 00:04:07,200
by smaller organizations

112
00:04:07,200 --> 00:04:09,280
and here's going to be the agenda for

113
00:04:09,280 --> 00:04:10,879
today why do we care

114
00:04:10,879 --> 00:04:13,599
okay some use cases some incidents that

115
00:04:13,599 --> 00:04:14,000
we do

116
00:04:14,000 --> 00:04:16,079
have from the past um what are the

117
00:04:16,079 --> 00:04:17,680
forensics value and

118
00:04:17,680 --> 00:04:19,918
the metadata the the informations that

119
00:04:19,918 --> 00:04:20,880
we can get

120
00:04:20,880 --> 00:04:23,199
by analyzing the metadata or the

121
00:04:23,199 --> 00:04:24,240
evidence

122
00:04:24,240 --> 00:04:27,520
and also i'll be showing you um a quick

123
00:04:27,520 --> 00:04:29,440
rundown of how we can perform an

124
00:04:29,440 --> 00:04:31,040
evidence acquisitions

125
00:04:31,040 --> 00:04:34,400
using couple of tools

126
00:04:35,040 --> 00:04:38,720
all right so now is this so

127
00:04:38,720 --> 00:04:41,919
we have a problem and uh these cloud

128
00:04:41,919 --> 00:04:42,560
storage

129
00:04:42,560 --> 00:04:45,360
are being used by most of the adversary

130
00:04:45,360 --> 00:04:46,400
nowadays

131
00:04:46,400 --> 00:04:49,680
so you may be familiar with miter so you

132
00:04:49,680 --> 00:04:50,240
may

133
00:04:50,240 --> 00:04:52,639
see on on the right of my screen that

134
00:04:52,639 --> 00:04:53,280
there is

135
00:04:53,280 --> 00:04:55,440
um a screenshot related to miter

136
00:04:55,440 --> 00:04:56,479
techniques

137
00:04:56,479 --> 00:04:58,880
uh that talks about exfiltration over

138
00:04:58,880 --> 00:05:00,080
web services

139
00:05:00,080 --> 00:05:02,560
exfiltration to cloud storage so that is

140
00:05:02,560 --> 00:05:03,440
exactly

141
00:05:03,440 --> 00:05:06,960
a technique id 1567.002

142
00:05:06,960 --> 00:05:09,360
which consists of subtechnics so

143
00:05:09,360 --> 00:05:11,280
adversaries keeps on using this to

144
00:05:11,280 --> 00:05:12,720
accelerate data

145
00:05:12,720 --> 00:05:15,759
and also to store those stolen data from

146
00:05:15,759 --> 00:05:18,800
their victim and we have here also a

147
00:05:18,800 --> 00:05:19,680
couple of

148
00:05:19,680 --> 00:05:21,919
adversaries that keeps on using it

149
00:05:21,919 --> 00:05:23,120
number one here is

150
00:05:23,120 --> 00:05:26,639
the camera so chimera abuses cloud

151
00:05:26,639 --> 00:05:27,199
service

152
00:05:27,199 --> 00:05:29,360
services to exfiltrate data they are

153
00:05:29,360 --> 00:05:30,400
actually using

154
00:05:30,400 --> 00:05:33,199
uh onedrive accounts to exfiltrate those

155
00:05:33,199 --> 00:05:34,479
stolen data

156
00:05:34,479 --> 00:05:38,160
purila which is um been here for a

157
00:05:38,160 --> 00:05:40,560
couple of years already it's not new

158
00:05:40,560 --> 00:05:43,840
but they also use a one drive and four

159
00:05:43,840 --> 00:05:44,800
shared

160
00:05:44,800 --> 00:05:47,680
the latest one uh which we do have a

161
00:05:47,680 --> 00:05:49,680
couple of months ago from microsoft

162
00:05:49,680 --> 00:05:52,720
which is the half new so hafnium as per

163
00:05:52,720 --> 00:05:53,360
the reports

164
00:05:53,360 --> 00:05:55,520
based from the threat intelligence uh

165
00:05:55,520 --> 00:05:57,600
they also exfiltrates data

166
00:05:57,600 --> 00:06:00,880
on file sharing sites like mega or mega

167
00:06:00,880 --> 00:06:01,759
sin

168
00:06:01,759 --> 00:06:04,080
and last thing is empire so there is

169
00:06:04,080 --> 00:06:05,680
this kind of module

170
00:06:05,680 --> 00:06:08,080
which is particularly for c2 that

171
00:06:08,080 --> 00:06:08,800
leverage

172
00:06:08,800 --> 00:06:13,199
dropbox to perform data exfiltration

173
00:06:13,199 --> 00:06:16,800
um so now the question is why do we care

174
00:06:16,800 --> 00:06:19,039
of course we do care so cloud storage

175
00:06:19,039 --> 00:06:21,039
can be used uh to perform the

176
00:06:21,039 --> 00:06:22,880
x fill so we need to look for those

177
00:06:22,880 --> 00:06:25,360
remnants and also artifacts that could

178
00:06:25,360 --> 00:06:26,000
lead us

179
00:06:26,000 --> 00:06:28,960
to more granular information and more

180
00:06:28,960 --> 00:06:29,759
data

181
00:06:29,759 --> 00:06:32,560
it can also be used or heavily used by

182
00:06:32,560 --> 00:06:34,080
insider threat especially if your

183
00:06:34,080 --> 00:06:34,960
company

184
00:06:34,960 --> 00:06:37,600
doesn't have proper policy or even like

185
00:06:37,600 --> 00:06:39,600
uh data loss prevention tools

186
00:06:39,600 --> 00:06:42,080
uh to detect those internal documents

187
00:06:42,080 --> 00:06:43,120
being shared

188
00:06:43,120 --> 00:06:45,360
uh being uploaded being downloaded by

189
00:06:45,360 --> 00:06:47,199
someone by your employees

190
00:06:47,199 --> 00:06:50,720
then you will be on a mass condition

191
00:06:50,720 --> 00:06:53,199
extremely useful of course especially

192
00:06:53,199 --> 00:06:54,880
when we are doing some analysis

193
00:06:54,880 --> 00:06:57,120
as it leaves tons of trails and also

194
00:06:57,120 --> 00:06:58,000
artifacts

195
00:06:58,000 --> 00:06:59,599
that can be used to track down the

196
00:06:59,599 --> 00:07:01,599
activities uh what are

197
00:07:01,599 --> 00:07:03,520
the tasks that are being done by your

198
00:07:03,520 --> 00:07:05,280
employees or by the adversary by just

199
00:07:05,280 --> 00:07:06,000
looking

200
00:07:06,000 --> 00:07:09,199
into these footprints um

201
00:07:09,199 --> 00:07:11,840
so these are the things that we have um

202
00:07:11,840 --> 00:07:13,360
collect or we can collect from the

203
00:07:13,360 --> 00:07:14,639
evidence standpoint

204
00:07:14,639 --> 00:07:16,479
so we can collect local files or even

205
00:07:16,479 --> 00:07:18,880
the cloud files uh the sync files on the

206
00:07:18,880 --> 00:07:19,759
local drive

207
00:07:19,759 --> 00:07:22,800
or even on the cloud file itself

208
00:07:22,800 --> 00:07:25,840
so we have here something like

209
00:07:25,840 --> 00:07:28,319
databases and cloud and logs so

210
00:07:28,319 --> 00:07:30,160
databases and logs can be beneficial

211
00:07:30,160 --> 00:07:32,560
to get most of the metadata that we need

212
00:07:32,560 --> 00:07:34,479
especially the the modified time the

213
00:07:34,479 --> 00:07:35,360
timestamp

214
00:07:35,360 --> 00:07:37,280
um the different hashes you will be

215
00:07:37,280 --> 00:07:38,560
surprised that there are a couple of

216
00:07:38,560 --> 00:07:40,080
hashes that are available

217
00:07:40,080 --> 00:07:41,919
depending on the cloud storage that we

218
00:07:41,919 --> 00:07:43,120
are using so there are

219
00:07:43,120 --> 00:07:44,879
storages that are using xiao one there's

220
00:07:44,879 --> 00:07:46,400
a storage that is using

221
00:07:46,400 --> 00:07:49,440
md5 hashes and also the file names of

222
00:07:49,440 --> 00:07:52,160
the file itself other thing that is also

223
00:07:52,160 --> 00:07:53,120
useful for us

224
00:07:53,120 --> 00:07:55,919
is the deleted items so of course every

225
00:07:55,919 --> 00:07:58,319
forensic examiner loves to examine

226
00:07:58,319 --> 00:08:01,280
deleted items especially in ir we would

227
00:08:01,280 --> 00:08:03,199
like to know what are those files that

228
00:08:03,199 --> 00:08:05,120
they're trying to hide for us

229
00:08:05,120 --> 00:08:07,680
and last thing is the operating systems

230
00:08:07,680 --> 00:08:08,479
artifacts

231
00:08:08,479 --> 00:08:09,680
this could be a bunch of windows

232
00:08:09,680 --> 00:08:12,319
artifacts such as lnk files

233
00:08:12,319 --> 00:08:15,039
prefetch files registry entries and even

234
00:08:15,039 --> 00:08:16,319
event logs

235
00:08:16,319 --> 00:08:19,599
jump lists uh and also memory dump so if

236
00:08:19,599 --> 00:08:20,080
ever

237
00:08:20,080 --> 00:08:23,120
you guys are using uh these kind of

238
00:08:23,120 --> 00:08:24,400
cloud storage apps

239
00:08:24,400 --> 00:08:26,160
then once you execute this once you use

240
00:08:26,160 --> 00:08:27,919
this this will be existing

241
00:08:27,919 --> 00:08:31,199
almost everywhere almost um everywhere

242
00:08:31,199 --> 00:08:32,479
on the os

243
00:08:32,479 --> 00:08:36,159
uh artifacts that we have known

244
00:08:36,159 --> 00:08:38,719
next is the endpoint footprint so

245
00:08:38,719 --> 00:08:40,399
technically cloud storage

246
00:08:40,399 --> 00:08:43,120
applications leave large footprints on

247
00:08:43,120 --> 00:08:43,919
the endpoint

248
00:08:43,919 --> 00:08:46,480
so by checking the local systems you can

249
00:08:46,480 --> 00:08:48,240
see a lot of artifacts

250
00:08:48,240 --> 00:08:51,040
that can be useful for our analysis so

251
00:08:51,040 --> 00:08:51,600
one thing

252
00:08:51,600 --> 00:08:54,320
is account details so what file success

253
00:08:54,320 --> 00:08:56,000
currently being shared with the user

254
00:08:56,000 --> 00:08:58,080
uh what files may be available not on

255
00:08:58,080 --> 00:09:00,560
the system but available potentially

256
00:09:00,560 --> 00:09:02,560
in the cloud storage what is also the

257
00:09:02,560 --> 00:09:04,480
files that are being downloaded

258
00:09:04,480 --> 00:09:07,760
being transferred what are the accounts

259
00:09:07,760 --> 00:09:08,080
that

260
00:09:08,080 --> 00:09:10,480
they've used to share these files so in

261
00:09:10,480 --> 00:09:12,240
addition to that we have also a bunch of

262
00:09:12,240 --> 00:09:13,279
timestamps

263
00:09:13,279 --> 00:09:15,600
um that we can correlate with the user's

264
00:09:15,600 --> 00:09:16,560
activities

265
00:09:16,560 --> 00:09:18,880
so other thing is like the hashes that's

266
00:09:18,880 --> 00:09:20,080
what i've mentioned

267
00:09:20,080 --> 00:09:22,480
um depending on the cloud storage it

268
00:09:22,480 --> 00:09:24,720
gives us the information of the hash

269
00:09:24,720 --> 00:09:27,120
uh that we can use uh to perform some

270
00:09:27,120 --> 00:09:28,160
comparison

271
00:09:28,160 --> 00:09:30,959
uh that they can use for being stored or

272
00:09:30,959 --> 00:09:32,240
being transferred

273
00:09:32,240 --> 00:09:36,720
uh from different um recipients

274
00:09:36,720 --> 00:09:39,279
now let's start so welcome to dropbox

275
00:09:39,279 --> 00:09:40,720
this is one of my favorite

276
00:09:40,720 --> 00:09:43,519
and uh not favorite when it comes to

277
00:09:43,519 --> 00:09:45,760
investigations but one of the first

278
00:09:45,760 --> 00:09:47,680
stories that i've used so a couple of

279
00:09:47,680 --> 00:09:50,080
years ago but this is also the worst

280
00:09:50,080 --> 00:09:52,080
cloud storage not in terms of the

281
00:09:52,080 --> 00:09:55,120
features of scalability and the ui

282
00:09:55,120 --> 00:09:57,760
it's actually awesome it's actually good

283
00:09:57,760 --> 00:09:58,880
it's just that

284
00:09:58,880 --> 00:10:02,399
it's hard when it comes to analysis and

285
00:10:02,399 --> 00:10:05,680
investigations because um

286
00:10:05,680 --> 00:10:07,600
it is difficult cloud storage because of

287
00:10:07,600 --> 00:10:09,440
the primary databases

288
00:10:09,440 --> 00:10:12,160
are encrypted using windows dp api so

289
00:10:12,160 --> 00:10:13,440
you have to decrypt it

290
00:10:13,440 --> 00:10:15,120
so you have to use some tools you have

291
00:10:15,120 --> 00:10:16,959
to get the keys for you to decrypt it

292
00:10:16,959 --> 00:10:18,320
but once you decrypted it

293
00:10:18,320 --> 00:10:20,320
it will be easy to navigate because it

294
00:10:20,320 --> 00:10:21,600
is also using um

295
00:10:21,600 --> 00:10:25,440
a normal um type of database

296
00:10:25,440 --> 00:10:27,680
which is on an sqlite so if you have

297
00:10:27,680 --> 00:10:29,279
like an sqlite viewer

298
00:10:29,279 --> 00:10:30,959
then you can easily see this kind of

299
00:10:30,959 --> 00:10:32,560
format they used to be pretty

300
00:10:32,560 --> 00:10:34,079
straightforward a couple of years ago

301
00:10:34,079 --> 00:10:34,640
but

302
00:10:34,640 --> 00:10:37,440
uh they changed how they did things um

303
00:10:37,440 --> 00:10:38,000
so there

304
00:10:38,000 --> 00:10:40,480
is one metadata here which is what we

305
00:10:40,480 --> 00:10:42,640
call the file cache that dbx

306
00:10:42,640 --> 00:10:44,959
so this is the most important artifacts

307
00:10:44,959 --> 00:10:46,560
that you can have in dropbox

308
00:10:46,560 --> 00:10:49,440
as it contains most of the metadata that

309
00:10:49,440 --> 00:10:51,279
is locally synchronized

310
00:10:51,279 --> 00:10:55,680
files um also uh the file cache and the

311
00:10:55,680 --> 00:10:56,720
config again

312
00:10:56,720 --> 00:10:58,720
these are actually encrypted but there

313
00:10:58,720 --> 00:11:00,560
is an open source tool that we can use

314
00:11:00,560 --> 00:11:01,600
to decrypt this

315
00:11:01,600 --> 00:11:03,920
uh using the api toolkit made by

316
00:11:03,920 --> 00:11:05,040
francesco

317
00:11:05,040 --> 00:11:07,839
picasso okay so he's a researcher and

318
00:11:07,839 --> 00:11:09,760
then he created this turkey to decrypt

319
00:11:09,760 --> 00:11:11,200
this kind of stuff

320
00:11:11,200 --> 00:11:14,160
so i have also mentioned here uh one of

321
00:11:14,160 --> 00:11:15,839
the good talk

322
00:11:15,839 --> 00:11:19,519
a couple of years ago since year 2012

323
00:11:19,519 --> 00:11:21,519
so during 2012 there was a talk in

324
00:11:21,519 --> 00:11:23,839
hectatlou which is a conference in

325
00:11:23,839 --> 00:11:25,120
luxembourg

326
00:11:25,120 --> 00:11:27,200
by two grade gens in the topic of a

327
00:11:27,200 --> 00:11:28,160
critical analysis

328
00:11:28,160 --> 00:11:31,120
of dropbox software security so they

329
00:11:31,120 --> 00:11:32,000
discovered

330
00:11:32,000 --> 00:11:35,440
that the encryption key used for the dbx

331
00:11:35,440 --> 00:11:37,519
files that are encrypted

332
00:11:37,519 --> 00:11:39,600
is kept in the registry and it's

333
00:11:39,600 --> 00:11:42,079
protected by again the dp api

334
00:11:42,079 --> 00:11:45,360
so i just mentioned here the link so you

335
00:11:45,360 --> 00:11:46,000
can just

336
00:11:46,000 --> 00:11:49,040
visit this and look at the paper it's

337
00:11:49,040 --> 00:11:51,200
kind of interesting

338
00:11:51,200 --> 00:11:54,000
next is onedrive which is the most

339
00:11:54,000 --> 00:11:55,120
popular

340
00:11:55,120 --> 00:11:56,959
due to the windows having it as

341
00:11:56,959 --> 00:11:59,040
installed by default started

342
00:11:59,040 --> 00:12:02,079
um on windows 8 plus version

343
00:12:02,079 --> 00:12:04,160
so in most cases you may see this on the

344
00:12:04,160 --> 00:12:05,200
default old

345
00:12:05,200 --> 00:12:07,519
folder onedrive but sometimes it can

346
00:12:07,519 --> 00:12:08,480
also be

347
00:12:08,480 --> 00:12:11,200
as skydrive so if you're examining uh

348
00:12:11,200 --> 00:12:12,160
let's say

349
00:12:12,160 --> 00:12:13,920
uh a case and then you can see that

350
00:12:13,920 --> 00:12:16,079
there's a skydrive that is actually a

351
00:12:16,079 --> 00:12:17,120
onedrive so

352
00:12:17,120 --> 00:12:19,440
skydrive was the old name of onedrive

353
00:12:19,440 --> 00:12:20,880
which is microsoft

354
00:12:20,880 --> 00:12:24,160
acquired for from years ago

355
00:12:24,160 --> 00:12:26,320
and uh as what i mentioned there is a

356
00:12:26,320 --> 00:12:27,680
two variants of this

357
00:12:27,680 --> 00:12:30,720
um one is the personal and the second is

358
00:12:30,720 --> 00:12:33,519
the business variant of onedrive so the

359
00:12:33,519 --> 00:12:35,600
good thing about the business one is

360
00:12:35,600 --> 00:12:39,040
that gives you um a log called unified

361
00:12:39,040 --> 00:12:39,839
unified

362
00:12:39,839 --> 00:12:43,040
audit logs or ual so ual is

363
00:12:43,040 --> 00:12:45,600
enabled by default now for every user in

364
00:12:45,600 --> 00:12:48,399
the corporate which gives you a 90 days

365
00:12:48,399 --> 00:12:51,440
retention by default okay so once

366
00:12:51,440 --> 00:12:54,160
you extract certain of certain logs uh

367
00:12:54,160 --> 00:12:55,040
in ual

368
00:12:55,040 --> 00:12:57,440
like for example you are investigating a

369
00:12:57,440 --> 00:12:58,480
user on your

370
00:12:58,480 --> 00:13:00,959
um company and then if you extract the

371
00:13:00,959 --> 00:13:01,839
report could be

372
00:13:01,839 --> 00:13:03,839
via csv or it could be the web ui that

373
00:13:03,839 --> 00:13:05,440
they have there then you can get the

374
00:13:05,440 --> 00:13:06,320
audit logs

375
00:13:06,320 --> 00:13:08,639
like the user's iap address um the

376
00:13:08,639 --> 00:13:09,839
account itself

377
00:13:09,839 --> 00:13:12,560
and the file stats whether the the user

378
00:13:12,560 --> 00:13:13,760
modified an account

379
00:13:13,760 --> 00:13:15,279
or modify the certain file on the

380
00:13:15,279 --> 00:13:17,760
sharepoint if he deleted something

381
00:13:17,760 --> 00:13:20,079
if he accessed something or even a copy

382
00:13:20,079 --> 00:13:21,120
so that is

383
00:13:21,120 --> 00:13:25,120
existing on a uil or unified audit logs

384
00:13:25,120 --> 00:13:27,200
but for this talk i'll be just focusing

385
00:13:27,200 --> 00:13:28,639
on the personal

386
00:13:28,639 --> 00:13:31,680
variant of onedrive so

387
00:13:31,680 --> 00:13:34,800
we also have here a metadata called

388
00:13:34,800 --> 00:13:38,480
that d80 file a user seed that d80 file

389
00:13:38,480 --> 00:13:41,120
which basically gives us the list of

390
00:13:41,120 --> 00:13:42,240
local files

391
00:13:42,240 --> 00:13:45,680
and cloud files names so

392
00:13:45,680 --> 00:13:48,959
here these are the three types of the

393
00:13:48,959 --> 00:13:49,920
states

394
00:13:49,920 --> 00:13:53,360
when onedrive

395
00:13:53,440 --> 00:13:56,000
do some files on demand so one of the

396
00:13:56,000 --> 00:13:57,360
cool things about this

397
00:13:57,360 --> 00:13:59,360
onedrive is the concept of this the

398
00:13:59,360 --> 00:14:00,480
files on demand

399
00:14:00,480 --> 00:14:03,519
so only a subset of available files

400
00:14:03,519 --> 00:14:06,079
are likely resident in the local file

401
00:14:06,079 --> 00:14:07,040
systems

402
00:14:07,040 --> 00:14:10,079
so as you may see here on my screenshots

403
00:14:10,079 --> 00:14:12,639
that there are three types so number one

404
00:14:12,639 --> 00:14:15,040
the first one the cloud icon that states

405
00:14:15,040 --> 00:14:15,839
that

406
00:14:15,839 --> 00:14:19,040
the file or folder that is only existing

407
00:14:19,040 --> 00:14:21,120
on the cloud itself okay so it's not

408
00:14:21,120 --> 00:14:22,079
existing

409
00:14:22,079 --> 00:14:24,720
on your local drive the second thing is

410
00:14:24,720 --> 00:14:26,320
the green check mark states

411
00:14:26,320 --> 00:14:29,440
that it is temporarily cached so

412
00:14:29,440 --> 00:14:32,880
if a user um go to this directory and

413
00:14:32,880 --> 00:14:33,199
then

414
00:14:33,199 --> 00:14:35,839
when when they open it then that

415
00:14:35,839 --> 00:14:38,079
actually gives them a temporary cache of

416
00:14:38,079 --> 00:14:39,440
the file itself

417
00:14:39,440 --> 00:14:40,959
and then the last thing which has the

418
00:14:40,959 --> 00:14:44,000
white check icon inside the green circle

419
00:14:44,000 --> 00:14:46,240
that states that the file has been

420
00:14:46,240 --> 00:14:48,399
always kept on this device or

421
00:14:48,399 --> 00:14:51,440
it is stored locally so if you right

422
00:14:51,440 --> 00:14:52,880
click a certain file

423
00:14:52,880 --> 00:14:55,120
then that gives you an option of always

424
00:14:55,120 --> 00:14:56,240
kept on the device

425
00:14:56,240 --> 00:14:57,839
so that means that this will be

426
00:14:57,839 --> 00:14:59,519
available on the local file

427
00:14:59,519 --> 00:15:02,800
as well as on the cloud file but uh

428
00:15:02,800 --> 00:15:06,560
most of the time when you see this cloud

429
00:15:06,560 --> 00:15:08,560
icon on the first one this is being

430
00:15:08,560 --> 00:15:10,160
called as reports point

431
00:15:10,160 --> 00:15:11,600
so these are actually just a

432
00:15:11,600 --> 00:15:13,920
placeholders so the files is not

433
00:15:13,920 --> 00:15:15,600
existing on the hard disk

434
00:15:15,600 --> 00:15:19,040
but you can get the metadata and it is

435
00:15:19,040 --> 00:15:22,560
um um it will be the reference

436
00:15:22,560 --> 00:15:25,279
uh file to the existing file on the

437
00:15:25,279 --> 00:15:27,040
cloud okay so sometimes

438
00:15:27,040 --> 00:15:29,440
once you image a certain hard disk then

439
00:15:29,440 --> 00:15:30,800
you'll be surprised that

440
00:15:30,800 --> 00:15:32,560
the file is not existing but this is

441
00:15:32,560 --> 00:15:33,920
existing on the cloud

442
00:15:33,920 --> 00:15:36,240
because of that because the reason why

443
00:15:36,240 --> 00:15:37,360
is this is just

444
00:15:37,360 --> 00:15:40,480
a reports point unless the user click

445
00:15:40,480 --> 00:15:44,480
the available um put this as

446
00:15:44,480 --> 00:15:46,240
available or always kept this on the

447
00:15:46,240 --> 00:15:47,920
device or on the local file

448
00:15:47,920 --> 00:15:49,839
then once you image your machine then

449
00:15:49,839 --> 00:15:52,000
you will get the exact file and not just

450
00:15:52,000 --> 00:15:54,800
the metadata

451
00:15:54,800 --> 00:15:58,639
another metadata or artifacts that

452
00:15:58,639 --> 00:16:00,959
we can use for our investigations here

453
00:16:00,959 --> 00:16:01,839
are the dot

454
00:16:01,839 --> 00:16:05,040
ina file because that gives us the

455
00:16:05,040 --> 00:16:08,240
one rev location information also

456
00:16:08,240 --> 00:16:10,079
there's also a time stamp like a last

457
00:16:10,079 --> 00:16:10,639
time

458
00:16:10,639 --> 00:16:12,560
that one drive was synchronized with the

459
00:16:12,560 --> 00:16:13,839
cloud and

460
00:16:13,839 --> 00:16:16,639
also the bytes transfer the request sent

461
00:16:16,639 --> 00:16:18,480
which is the amount of activity

462
00:16:18,480 --> 00:16:20,959
during the sync file there is also a

463
00:16:20,959 --> 00:16:22,000
text file here

464
00:16:22,000 --> 00:16:25,040
as you can see on my screen the profile

465
00:16:25,040 --> 00:16:27,759
service response.txt file this is

466
00:16:27,759 --> 00:16:29,519
actually in the json format

467
00:16:29,519 --> 00:16:31,759
and it gives us the information of the

468
00:16:31,759 --> 00:16:33,519
first and the last name of the user

469
00:16:33,519 --> 00:16:35,600
plus their microsoft account okay and

470
00:16:35,600 --> 00:16:37,199
the email address

471
00:16:37,199 --> 00:16:38,639
and the last one thing here which

472
00:16:38,639 --> 00:16:40,320
doesn't have the red box

473
00:16:40,320 --> 00:16:43,360
so there is this file called um that

474
00:16:43,360 --> 00:16:47,040
d8t file so it shows the active file on

475
00:16:47,040 --> 00:16:48,079
the sync folders

476
00:16:48,079 --> 00:16:50,160
including the local files and the files

477
00:16:50,160 --> 00:16:52,639
available on the cloud

478
00:16:52,639 --> 00:16:55,040
so here what i did here is to perform a

479
00:16:55,040 --> 00:16:56,079
b strings

480
00:16:56,079 --> 00:16:58,720
or a tool from eric zimmerman so i think

481
00:16:58,720 --> 00:17:00,320
they call it better strings

482
00:17:00,320 --> 00:17:02,560
so once you perform a b strings here on

483
00:17:02,560 --> 00:17:04,000
a d80 file

484
00:17:04,000 --> 00:17:06,720
then that gives us a result of all the

485
00:17:06,720 --> 00:17:08,400
files that exist

486
00:17:08,400 --> 00:17:11,439
on our local local drive

487
00:17:11,439 --> 00:17:15,039
okay so um that identifies also

488
00:17:15,039 --> 00:17:18,799
whoever the user is and also

489
00:17:18,799 --> 00:17:21,520
uh the file names itself and on the

490
00:17:21,520 --> 00:17:23,520
right side of my screenshot you can see

491
00:17:23,520 --> 00:17:24,880
there the notepad

492
00:17:24,880 --> 00:17:27,199
that i've just opened which basically

493
00:17:27,199 --> 00:17:28,400
gives you the name

494
00:17:28,400 --> 00:17:30,960
and also the last name of the user as

495
00:17:30,960 --> 00:17:33,039
well as his microsoft account so you may

496
00:17:33,039 --> 00:17:33,679
see there

497
00:17:33,679 --> 00:17:35,919
that my user email that i've used there

498
00:17:35,919 --> 00:17:37,760
is cruise runs on

499
00:17:37,760 --> 00:17:40,240
gmail.com this is based on the json

500
00:17:40,240 --> 00:17:42,640
format

501
00:17:42,720 --> 00:17:44,880
next is box which is the most

502
00:17:44,880 --> 00:17:46,320
forensically uh

503
00:17:46,320 --> 00:17:48,240
and friendly app that we can deal with

504
00:17:48,240 --> 00:17:50,160
okay so this is one of my favorite

505
00:17:50,160 --> 00:17:52,799
when it comes to performing an analysis

506
00:17:52,799 --> 00:17:55,120
because it's easy to navigate and also

507
00:17:55,120 --> 00:17:55,840
it's easy

508
00:17:55,840 --> 00:17:58,080
to investigate they're also using an

509
00:17:58,080 --> 00:17:59,280
sqlite

510
00:17:59,280 --> 00:18:02,240
databases that provides the metadata

511
00:18:02,240 --> 00:18:04,400
like timestamps the sha one

512
00:18:04,400 --> 00:18:07,919
and for online and offline files okay

513
00:18:07,919 --> 00:18:10,320
so also the the directories that you can

514
00:18:10,320 --> 00:18:11,760
find the local files

515
00:18:11,760 --> 00:18:15,039
are residing on the user profile

516
00:18:15,039 --> 00:18:17,039
and then box so this is by default but

517
00:18:17,039 --> 00:18:19,600
this can be um changed by the adversary

518
00:18:19,600 --> 00:18:21,200
too

519
00:18:21,200 --> 00:18:23,360
so on the box file you can see here that

520
00:18:23,360 --> 00:18:25,360
there's a database called sync

521
00:18:25,360 --> 00:18:29,280
that db so this is um

522
00:18:29,280 --> 00:18:31,679
this contains more of the identifying

523
00:18:31,679 --> 00:18:33,760
the items currently tracked by the box

524
00:18:33,760 --> 00:18:35,039
drive application

525
00:18:35,039 --> 00:18:36,720
you can see here that there are tons of

526
00:18:36,720 --> 00:18:38,160
useful information

527
00:18:38,160 --> 00:18:41,280
uh when you go to box item column or

528
00:18:41,280 --> 00:18:43,919
table from the sync.db database

529
00:18:43,919 --> 00:18:46,160
um you can see there that there is a

530
00:18:46,160 --> 00:18:47,440
parent item

531
00:18:47,440 --> 00:18:50,640
column there's also a file name there's

532
00:18:50,640 --> 00:18:51,440
also

533
00:18:51,440 --> 00:18:54,080
um the checksum you can see there that

534
00:18:54,080 --> 00:18:56,480
this is on a show one

535
00:18:56,480 --> 00:18:59,280
there's also uh some time stamp which

536
00:18:59,280 --> 00:19:02,960
you need to convert in an ewatch time

537
00:19:03,600 --> 00:19:06,799
next thing is google drive uh there are

538
00:19:06,799 --> 00:19:08,240
two types of google drive that we need

539
00:19:08,240 --> 00:19:10,160
to consider here

540
00:19:10,160 --> 00:19:12,720
there is a google drive or google backup

541
00:19:12,720 --> 00:19:13,679
and sync

542
00:19:13,679 --> 00:19:16,000
so that is the new term now which they

543
00:19:16,000 --> 00:19:17,520
replaced the original google drive

544
00:19:17,520 --> 00:19:18,640
applications

545
00:19:18,640 --> 00:19:21,280
uh on the year 2018 so this is the

546
00:19:21,280 --> 00:19:22,080
default

547
00:19:22,080 --> 00:19:24,559
desktop applications for consumer that

548
00:19:24,559 --> 00:19:25,120
uses

549
00:19:25,120 --> 00:19:27,520
google drive okay so the other one is

550
00:19:27,520 --> 00:19:29,679
when let's say when you are when your

551
00:19:29,679 --> 00:19:31,440
company is using an enterprise version

552
00:19:31,440 --> 00:19:32,799
of that then

553
00:19:32,799 --> 00:19:35,039
they call it google workspace or they

554
00:19:35,039 --> 00:19:35,919
call it g

555
00:19:35,919 --> 00:19:40,080
suite or g-suite fs or g-suite file

556
00:19:40,080 --> 00:19:40,880
stream

557
00:19:40,880 --> 00:19:42,400
so it is available on the g-suite

558
00:19:42,400 --> 00:19:44,160
customers always the same

559
00:19:44,160 --> 00:19:47,280
features or backup and sync with the

560
00:19:47,280 --> 00:19:48,480
additions of

561
00:19:48,480 --> 00:19:51,760
files on demand like the box and the

562
00:19:51,760 --> 00:19:54,799
one drive okay so still the databases of

563
00:19:54,799 --> 00:19:55,120
this

564
00:19:55,120 --> 00:19:57,760
google drive or the google backup and

565
00:19:57,760 --> 00:19:59,440
sync uses the form of

566
00:19:59,440 --> 00:20:03,150
sql sqlite version of database

567
00:20:03,150 --> 00:20:04,480
[Music]

568
00:20:04,480 --> 00:20:07,919
and we do have here some metadata uh

569
00:20:07,919 --> 00:20:11,360
which are useful databases uh so it's

570
00:20:11,360 --> 00:20:13,840
not encrypted so you can see here

571
00:20:13,840 --> 00:20:16,960
um the cloud grub dot db

572
00:20:16,960 --> 00:20:19,679
so you will get tons of information such

573
00:20:19,679 --> 00:20:21,360
as a modified time which is

574
00:20:21,360 --> 00:20:24,480
again in unix epoch time we can also get

575
00:20:24,480 --> 00:20:26,400
here the md5 hashes of the files

576
00:20:26,400 --> 00:20:28,400
so we can run some comparison of the

577
00:20:28,400 --> 00:20:29,520
existing files

578
00:20:29,520 --> 00:20:31,280
whether there is a file that has been

579
00:20:31,280 --> 00:20:32,720
changed modified

580
00:20:32,720 --> 00:20:35,120
by the adversary or maybe if it's being

581
00:20:35,120 --> 00:20:36,159
deleted

582
00:20:36,159 --> 00:20:38,799
uh by someone okay so there is also a

583
00:20:38,799 --> 00:20:40,240
shared column here which is kind of

584
00:20:40,240 --> 00:20:40,960
interesting

585
00:20:40,960 --> 00:20:44,320
okay shade column here um means if it's

586
00:20:44,320 --> 00:20:47,280
one then it is being shared but if it's

587
00:20:47,280 --> 00:20:49,039
zero if it's the data

588
00:20:49,039 --> 00:20:51,760
um have zero value then it means that

589
00:20:51,760 --> 00:20:53,280
this is not shared

590
00:20:53,280 --> 00:20:55,039
another column here that is kind of

591
00:20:55,039 --> 00:20:57,120
interesting to me is the dot type

592
00:20:57,120 --> 00:20:59,760
okay you can see there that the doc type

593
00:20:59,760 --> 00:21:02,159
consists of two values on my screenshots

594
00:21:02,159 --> 00:21:04,720
there is a zero and one so if the

595
00:21:04,720 --> 00:21:05,840
doctype

596
00:21:05,840 --> 00:21:08,640
has a value of zero it means that that

597
00:21:08,640 --> 00:21:10,000
is a folder

598
00:21:10,000 --> 00:21:12,720
but if the doctype has a value of one

599
00:21:12,720 --> 00:21:14,240
that means that these are

600
00:21:14,240 --> 00:21:17,280
real files like if it's a pdf it could

601
00:21:17,280 --> 00:21:18,000
be a text

602
00:21:18,000 --> 00:21:20,799
it could be a document or powerpoint

603
00:21:20,799 --> 00:21:21,679
excel

604
00:21:21,679 --> 00:21:25,120
etc okay next

605
00:21:25,120 --> 00:21:27,360
is or the last thing that we'll be

606
00:21:27,360 --> 00:21:28,400
discussing right now

607
00:21:28,400 --> 00:21:32,400
is mega sync okay so mega heavily used

608
00:21:32,400 --> 00:21:33,679
by adversary

609
00:21:33,679 --> 00:21:36,960
because they said that mega is one of

610
00:21:36,960 --> 00:21:38,320
the most secured

611
00:21:38,320 --> 00:21:40,720
applications or cloud storage services

612
00:21:40,720 --> 00:21:42,159
that are being used

613
00:21:42,159 --> 00:21:46,000
by the people okay so mega so

614
00:21:46,000 --> 00:21:49,440
mega actually is um having a word or

615
00:21:49,440 --> 00:21:52,240
it stands for mega encrypted global

616
00:21:52,240 --> 00:21:52,960
access

617
00:21:52,960 --> 00:21:54,880
so they are claiming that they are

618
00:21:54,880 --> 00:21:57,039
focused um

619
00:21:57,039 --> 00:22:00,159
uh that um i mean their service is

620
00:22:00,159 --> 00:22:02,720
focused heavily on security and they are

621
00:22:02,720 --> 00:22:04,640
using an end-to-end encryption

622
00:22:04,640 --> 00:22:06,400
and they are also the one who is

623
00:22:06,400 --> 00:22:08,080
claiming that they're using a zero

624
00:22:08,080 --> 00:22:08,960
knowledge

625
00:22:08,960 --> 00:22:10,880
encryption okay so zero knowledge

626
00:22:10,880 --> 00:22:12,240
encryption means that

627
00:22:12,240 --> 00:22:15,200
uh in this case uh there's no one

628
00:22:15,200 --> 00:22:16,559
besides you

629
00:22:16,559 --> 00:22:18,880
has the keys to your data and not even

630
00:22:18,880 --> 00:22:19,760
the service

631
00:22:19,760 --> 00:22:21,760
you're starting your files with so they

632
00:22:21,760 --> 00:22:22,880
are claiming

633
00:22:22,880 --> 00:22:25,520
that we don't have any access to the

634
00:22:25,520 --> 00:22:26,799
keys that you have there

635
00:22:26,799 --> 00:22:29,280
so you only have you are the one who

636
00:22:29,280 --> 00:22:30,159
only have

637
00:22:30,159 --> 00:22:32,559
the access to your files so if you lose

638
00:22:32,559 --> 00:22:33,200
the keys

639
00:22:33,200 --> 00:22:36,320
or if you lose uh some sort of the pass

640
00:22:36,320 --> 00:22:37,679
price that they gave to you once you

641
00:22:37,679 --> 00:22:38,880
register your account

642
00:22:38,880 --> 00:22:42,480
then they don't have any um

643
00:22:42,480 --> 00:22:46,080
a way to recover it okay so that's why

644
00:22:46,080 --> 00:22:48,880
attackers love using mega because of

645
00:22:48,880 --> 00:22:51,039
this claim

646
00:22:51,039 --> 00:22:53,440
and some of the local files that you can

647
00:22:53,440 --> 00:22:54,799
see from the window sides

648
00:22:54,799 --> 00:22:58,080
is uh existing on the user profile app

649
00:22:58,080 --> 00:22:58,720
data

650
00:22:58,720 --> 00:23:01,760
mega limited mega sync slash lags

651
00:23:01,760 --> 00:23:04,400
as you can see on my screenshot that you

652
00:23:04,400 --> 00:23:05,360
can see there

653
00:23:05,360 --> 00:23:08,400
the log files if you open it you can see

654
00:23:08,400 --> 00:23:08,960
there

655
00:23:08,960 --> 00:23:11,039
uh what was the file that has been

656
00:23:11,039 --> 00:23:12,320
recently

657
00:23:12,320 --> 00:23:15,120
downloaded from my mega account and also

658
00:23:15,120 --> 00:23:16,000
in mega

659
00:23:16,000 --> 00:23:18,159
on the web ui you can see there that

660
00:23:18,159 --> 00:23:19,840
they also stored

661
00:23:19,840 --> 00:23:22,960
deleted files on the rubbish bins

662
00:23:22,960 --> 00:23:26,240
so i'm not sure how they started

663
00:23:26,240 --> 00:23:30,720
um i think um for 30 or 90 days as well

664
00:23:30,720 --> 00:23:33,200
like the same cloud storage apps there

665
00:23:33,200 --> 00:23:33,760
but

666
00:23:33,760 --> 00:23:35,919
once you delete a file then that would

667
00:23:35,919 --> 00:23:38,640
be stored on the rubbish bin

668
00:23:38,640 --> 00:23:43,600
it acts like the recycle bin on windows

669
00:23:43,600 --> 00:23:45,919
there's also this local folder and a

670
00:23:45,919 --> 00:23:47,679
cloud folder where you can just drop

671
00:23:47,679 --> 00:23:49,200
anything there so

672
00:23:49,200 --> 00:23:51,279
i have here a test folder existing on my

673
00:23:51,279 --> 00:23:52,320
local drive

674
00:23:52,320 --> 00:23:54,400
so if ever i drop anything there then

675
00:23:54,400 --> 00:23:56,320
that will automatically upload

676
00:23:56,320 --> 00:23:58,320
on my mega account as long as i have my

677
00:23:58,320 --> 00:24:00,320
internet

678
00:24:00,320 --> 00:24:03,840
and um like what we have on other cloud

679
00:24:03,840 --> 00:24:04,640
storage apps

680
00:24:04,640 --> 00:24:07,440
you can also see most of these once you

681
00:24:07,440 --> 00:24:08,240
execute this

682
00:24:08,240 --> 00:24:11,600
in most of the os artifacts such as lnk

683
00:24:11,600 --> 00:24:13,520
and even in event logs as you can see on

684
00:24:13,520 --> 00:24:14,720
my screenshots

685
00:24:14,720 --> 00:24:16,799
prefetch files this that will

686
00:24:16,799 --> 00:24:18,559
automatically exist

687
00:24:18,559 --> 00:24:20,240
of course because that's an artifact for

688
00:24:20,240 --> 00:24:22,159
executions and also on the

689
00:24:22,159 --> 00:24:23,919
master file table you can see that

690
00:24:23,919 --> 00:24:25,760
there's a lot of mega

691
00:24:25,760 --> 00:24:28,799
applications or traces that

692
00:24:28,799 --> 00:24:31,679
i'm i'm the one or the user is using

693
00:24:31,679 --> 00:24:32,000
mega

694
00:24:32,000 --> 00:24:35,200
sync cloud storage apps so that would be

695
00:24:35,200 --> 00:24:36,240
the last one

696
00:24:36,240 --> 00:24:39,360
and now let's have a discussions on

697
00:24:39,360 --> 00:24:42,240
how can we perform an acquisition okay

698
00:24:42,240 --> 00:24:42,640
so

699
00:24:42,640 --> 00:24:45,600
on the cloud storage uh collections most

700
00:24:45,600 --> 00:24:46,159
of these

701
00:24:46,159 --> 00:24:49,919
are uh leveraging the api functions so

702
00:24:49,919 --> 00:24:53,440
you need to um you need to to give them

703
00:24:53,440 --> 00:24:55,120
the credentials so that they can perform

704
00:24:55,120 --> 00:24:57,039
the activities such as evidence

705
00:24:57,039 --> 00:24:58,720
acquisition acquisitions

706
00:24:58,720 --> 00:25:00,960
so there are a couple of stuff here so i

707
00:25:00,960 --> 00:25:03,120
have here another github repo that could

708
00:25:03,120 --> 00:25:03,440
be

709
00:25:03,440 --> 00:25:06,400
good to perform um evidence acquisitions

710
00:25:06,400 --> 00:25:08,080
on the g suite platform

711
00:25:08,080 --> 00:25:11,600
uh so it's free there's also a default

712
00:25:11,600 --> 00:25:15,120
um take out from google over in you can

713
00:25:15,120 --> 00:25:16,320
dump

714
00:25:16,320 --> 00:25:18,880
most of the logs that you need from your

715
00:25:18,880 --> 00:25:21,520
investigation

716
00:25:21,520 --> 00:25:26,000
and on the predominant

717
00:25:26,000 --> 00:25:28,559
enterprise um applications that you can

718
00:25:28,559 --> 00:25:29,600
find uh

719
00:25:29,600 --> 00:25:31,679
from the collection sites which are the

720
00:25:31,679 --> 00:25:32,720
f response

721
00:25:32,720 --> 00:25:35,840
uh celebrite so celebrate has this

722
00:25:35,840 --> 00:25:39,760
um cloud forensics um analysis module

723
00:25:39,760 --> 00:25:40,320
two

724
00:25:40,320 --> 00:25:42,880
and of course magnet forensics so magnet

725
00:25:42,880 --> 00:25:43,600
axiom

726
00:25:43,600 --> 00:25:46,159
so useful i've used this before um they

727
00:25:46,159 --> 00:25:47,279
are

728
00:25:47,279 --> 00:25:49,760
very good when it comes to providing and

729
00:25:49,760 --> 00:25:50,559
parsing

730
00:25:50,559 --> 00:25:52,880
um a lot of fields artifacts that you

731
00:25:52,880 --> 00:25:53,600
can find

732
00:25:53,600 --> 00:25:56,640
on any cloud storage that you are using

733
00:25:56,640 --> 00:25:59,120
so these are um the things that are

734
00:25:59,120 --> 00:26:00,559
commonly being seen

735
00:26:00,559 --> 00:26:02,960
that investigators are using so just

736
00:26:02,960 --> 00:26:04,559
check it out

737
00:26:04,559 --> 00:26:06,480
and this is the summary of the cloud

738
00:26:06,480 --> 00:26:08,480
storage um

739
00:26:08,480 --> 00:26:10,640
files that we can get on each um

740
00:26:10,640 --> 00:26:11,840
applications

741
00:26:11,840 --> 00:26:14,640
so it would be better to have this as a

742
00:26:14,640 --> 00:26:16,640
reference guide

743
00:26:16,640 --> 00:26:20,320
and right now what if we need to get

744
00:26:20,320 --> 00:26:20,720
this

745
00:26:20,720 --> 00:26:22,960
from the endpoint so let's say we need

746
00:26:22,960 --> 00:26:25,039
to get the artifacts the footprints

747
00:26:25,039 --> 00:26:27,279
um that we can get from from the host

748
00:26:27,279 --> 00:26:29,520
level so what could be the tool that we

749
00:26:29,520 --> 00:26:30,400
can use

750
00:26:30,400 --> 00:26:32,240
so if you're not familiar with cape so

751
00:26:32,240 --> 00:26:34,799
this is an absolutely amazing tool

752
00:26:34,799 --> 00:26:38,240
made and written by eric zimmerman so

753
00:26:38,240 --> 00:26:40,000
there are two modules from cape there is

754
00:26:40,000 --> 00:26:42,320
a target and and then there's also

755
00:26:42,320 --> 00:26:45,840
a module which could be done by parsing

756
00:26:45,840 --> 00:26:48,559
all of the files and gives you a result

757
00:26:48,559 --> 00:26:49,520
on an x

758
00:26:49,520 --> 00:26:52,640
an excel format or csv format

759
00:26:52,640 --> 00:26:55,520
which i will be performing in demo so

760
00:26:55,520 --> 00:26:56,159
again this

761
00:26:56,159 --> 00:26:59,200
is free you just have to

762
00:26:59,200 --> 00:27:01,440
subscribe to crawl go to the crawl

763
00:27:01,440 --> 00:27:02,400
website

764
00:27:02,400 --> 00:27:04,799
and then you just have to supply your

765
00:27:04,799 --> 00:27:05,600
email

766
00:27:05,600 --> 00:27:07,120
and then they will just give the link to

767
00:27:07,120 --> 00:27:08,640
you okay so there are a couple of

768
00:27:08,640 --> 00:27:09,679
modules here

769
00:27:09,679 --> 00:27:11,919
which is entirely for cloud storage

770
00:27:11,919 --> 00:27:12,880
contents and

771
00:27:12,880 --> 00:27:15,120
metadata so that is an absolutely

772
00:27:15,120 --> 00:27:16,240
amazing tool

773
00:27:16,240 --> 00:27:19,360
um all you have to do is just just click

774
00:27:19,360 --> 00:27:21,279
uh like few clicks and then you have to

775
00:27:21,279 --> 00:27:23,760
wait for it to finish

776
00:27:23,760 --> 00:27:27,120
now it's demo time i will be just uh

777
00:27:27,120 --> 00:27:30,240
be presenting it to you let me just

778
00:27:30,240 --> 00:27:35,840
um share my screen again

779
00:27:40,000 --> 00:27:43,120
okay so now this

780
00:27:43,120 --> 00:27:47,279
is the video that i'll be showing to you

781
00:27:47,279 --> 00:27:49,679
so here this is my um computer this is

782
00:27:49,679 --> 00:27:50,720
my desktop so

783
00:27:50,720 --> 00:27:52,559
what we'll be doing is to perform an

784
00:27:52,559 --> 00:27:54,080
evidence acquisitions

785
00:27:54,080 --> 00:27:55,919
based on the footprints based on those

786
00:27:55,919 --> 00:27:57,760
artifacts those locations

787
00:27:57,760 --> 00:28:00,080
directories that we have just discussed

788
00:28:00,080 --> 00:28:02,320
by using a tool called cape by eric

789
00:28:02,320 --> 00:28:03,200
zimmerman

790
00:28:03,200 --> 00:28:05,919
okay so i will be launching here cape uh

791
00:28:05,919 --> 00:28:07,120
on my

792
00:28:07,120 --> 00:28:11,679
um desktop and then

793
00:28:11,679 --> 00:28:13,520
after a few seconds it will be appearing

794
00:28:13,520 --> 00:28:15,919
here so i'll be using your target which

795
00:28:15,919 --> 00:28:16,960
is basically

796
00:28:16,960 --> 00:28:20,399
uh where should i get those evidences

797
00:28:20,399 --> 00:28:23,760
so i just have to put um my c drive here

798
00:28:23,760 --> 00:28:26,880
and the next thing is where should i put

799
00:28:26,880 --> 00:28:30,240
uh the output or where it will dump most

800
00:28:30,240 --> 00:28:31,679
of those artifacts that

801
00:28:31,679 --> 00:28:33,919
it will be collecting and the next is

802
00:28:33,919 --> 00:28:36,399
getting um the modules or getting

803
00:28:36,399 --> 00:28:38,960
um the or putting the cloud storage

804
00:28:38,960 --> 00:28:39,520
there

805
00:28:39,520 --> 00:28:42,960
so as you can see there that if i click

806
00:28:42,960 --> 00:28:45,360
that option then that gives me the

807
00:28:45,360 --> 00:28:47,279
artifacts from the dropbox

808
00:28:47,279 --> 00:28:49,600
from the onedrive from the google drive

809
00:28:49,600 --> 00:28:52,240
and also there's the sugar sync here

810
00:28:52,240 --> 00:28:55,360
okay so after confirming

811
00:28:55,360 --> 00:28:57,440
that this will be the options that i

812
00:28:57,440 --> 00:28:59,120
need to do

813
00:28:59,120 --> 00:29:02,240
i just have to convert and also put a

814
00:29:02,240 --> 00:29:03,760
container in the hdx

815
00:29:03,760 --> 00:29:06,799
so that i can easily just open it into

816
00:29:06,799 --> 00:29:09,679
whatever computers that i have

817
00:29:09,679 --> 00:29:11,279
and then i'll be putting a cloud base

818
00:29:11,279 --> 00:29:13,200
name which is a cloud storage

819
00:29:13,200 --> 00:29:16,399
um underscore artifacts okay so

820
00:29:16,399 --> 00:29:19,600
once i'm done then that's it you just

821
00:29:19,600 --> 00:29:21,279
have to click the execute

822
00:29:21,279 --> 00:29:25,039
and then let's wait for this to finish

823
00:29:25,039 --> 00:29:28,799
okay so um so this would take me

824
00:29:28,799 --> 00:29:32,080
um less than a minute i think and

825
00:29:32,080 --> 00:29:34,799
um after that then it will be dropped on

826
00:29:34,799 --> 00:29:36,240
the folder that we have just stated on

827
00:29:36,240 --> 00:29:37,760
the target destinations

828
00:29:37,760 --> 00:29:39,440
and then we can start our investigation

829
00:29:39,440 --> 00:29:42,159
so this will ease us because sometimes

830
00:29:42,159 --> 00:29:43,360
we tend to forget

831
00:29:43,360 --> 00:29:46,480
where are the artifacts located um

832
00:29:46,480 --> 00:29:49,120
where are the default path where are the

833
00:29:49,120 --> 00:29:50,960
database being located

834
00:29:50,960 --> 00:29:53,120
then this could be so um this could

835
00:29:53,120 --> 00:29:54,159
solve our

836
00:29:54,159 --> 00:29:57,120
problems and it's very easy and it's

837
00:29:57,120 --> 00:29:57,840
very

838
00:29:57,840 --> 00:30:01,360
um fast as well as you can see here it's

839
00:30:01,360 --> 00:30:02,480
already done

840
00:30:02,480 --> 00:30:04,799
and uh it took us only 40 seconds to

841
00:30:04,799 --> 00:30:05,840
finish

842
00:30:05,840 --> 00:30:09,440
and now let's extract what are the files

843
00:30:09,440 --> 00:30:10,320
that we just got

844
00:30:10,320 --> 00:30:12,559
using

845
00:30:13,600 --> 00:30:16,799
okay so now so i just dump

846
00:30:16,799 --> 00:30:19,679
everything on the cape output target as

847
00:30:19,679 --> 00:30:20,880
you can see here

848
00:30:20,880 --> 00:30:24,000
that those files are

849
00:30:24,000 --> 00:30:27,840
copied already on my directory

850
00:30:27,840 --> 00:30:30,000
so you can see here the app data if you

851
00:30:30,000 --> 00:30:31,760
go to that

852
00:30:31,760 --> 00:30:34,080
you can see here the box the dropbox the

853
00:30:34,080 --> 00:30:36,320
google drive and also the microsoft

854
00:30:36,320 --> 00:30:39,360
or the onedrive so if you go to the box

855
00:30:39,360 --> 00:30:40,159
you can see here

856
00:30:40,159 --> 00:30:41,520
oh most of the logs that we've just

857
00:30:41,520 --> 00:30:43,919
discussed on the data you can see there

858
00:30:43,919 --> 00:30:45,200
the databases

859
00:30:45,200 --> 00:30:48,159
where we can extract a couple of

860
00:30:48,159 --> 00:30:50,720
evidences and information

861
00:30:50,720 --> 00:30:54,080
and yeah

862
00:30:54,080 --> 00:30:56,480
and dropbox you can see here here the

863
00:30:56,480 --> 00:30:57,679
sync history

864
00:30:57,679 --> 00:31:00,799
the config dbx files and

865
00:31:00,799 --> 00:31:05,840
things like that

866
00:31:06,320 --> 00:31:09,440
okay so that's how you perform evidence

867
00:31:09,440 --> 00:31:10,720
acquisitions by using

868
00:31:10,720 --> 00:31:13,679
cape as a tool which is a free tool and

869
00:31:13,679 --> 00:31:15,440
uh it took us only a minute

870
00:31:15,440 --> 00:31:17,760
to get those artifacts that we need are

871
00:31:17,760 --> 00:31:19,519
based on the cloud storage apps that we

872
00:31:19,519 --> 00:31:21,039
are using

873
00:31:21,039 --> 00:31:24,880
and uh that's it for me that's my demo

874
00:31:24,880 --> 00:31:28,640
and let's go back to my slides and uh

875
00:31:28,640 --> 00:31:33,120
actually that's it um

876
00:31:33,120 --> 00:31:36,959
is there any question

877
00:31:37,919 --> 00:31:40,240
right

878
00:31:41,120 --> 00:31:45,039
so that's it for me that is my talk

879
00:31:45,039 --> 00:31:48,320
and if ever you have um questions

880
00:31:48,320 --> 00:31:51,120
uh related to the topic please do let me

881
00:31:51,120 --> 00:31:51,919
know

882
00:31:51,919 --> 00:31:54,880
um and these are a couple of the

883
00:31:54,880 --> 00:31:56,000
references

884
00:31:56,000 --> 00:32:00,320
related to this stock and

885
00:32:00,320 --> 00:32:02,399
yeah these are my handles are my twitter

886
00:32:02,399 --> 00:32:03,919
handler a runzeck

887
00:32:03,919 --> 00:32:07,200
and my link in uh and also my email so

888
00:32:07,200 --> 00:32:08,640
if you have any questions

889
00:32:08,640 --> 00:32:11,120
please do let me know please reach out

890
00:32:11,120 --> 00:32:12,080
and that's it

891
00:32:12,080 --> 00:32:15,120
thank you so much bluton village for

892
00:32:15,120 --> 00:32:18,960
um having me here of course and um

893
00:32:18,960 --> 00:32:20,960
i'll be opening the floor for any

894
00:32:20,960 --> 00:32:25,440
questions that we have from the audience

