1
00:00:03,840 --> 00:00:06,480
hello everyone thank you for joining us

2
00:00:06,480 --> 00:00:09,760
today in threat report roulette

3
00:00:09,760 --> 00:00:13,120
we have some amazing guests today and

4
00:00:13,120 --> 00:00:14,639
i'm gonna go through the list really

5
00:00:14,639 --> 00:00:15,440
quick

6
00:00:15,440 --> 00:00:17,680
uh we have chris russell and he's the

7
00:00:17,680 --> 00:00:20,160
head of information security for t zero

8
00:00:20,160 --> 00:00:20,960
group

9
00:00:20,960 --> 00:00:24,320
we have koran and he's a cti analyst for

10
00:00:24,320 --> 00:00:27,039
a big four consulting cyber security

11
00:00:27,039 --> 00:00:29,439
firm we have will thomas with us

12
00:00:29,439 --> 00:00:32,079
and he is a security researcher

13
00:00:32,079 --> 00:00:35,840
for psyjax uh we have me zena olsen or

14
00:00:35,840 --> 00:00:38,719
cheerio and i am a senior cyber security

15
00:00:38,719 --> 00:00:41,040
analyst at a fortune 500

16
00:00:41,040 --> 00:00:43,680
and we have the stakeholders we have the

17
00:00:43,680 --> 00:00:47,280
blind hacker he's representing red team

18
00:00:47,280 --> 00:00:49,520
and he's an infosec enthusiast and

19
00:00:49,520 --> 00:00:51,520
all-around awesome dude

20
00:00:51,520 --> 00:00:54,239
we have danny d henderson and he hails

21
00:00:54,239 --> 00:00:55,199
from

22
00:00:55,199 --> 00:00:57,760
being previously a cti analyst but

23
00:00:57,760 --> 00:00:59,359
moving more indeed first so he's going

24
00:00:59,359 --> 00:01:02,960
to represent the defer slash cti angle

25
00:01:02,960 --> 00:01:05,920
of threat report roulette we have jorge

26
00:01:05,920 --> 00:01:08,320
and he is the most awesome

27
00:01:08,320 --> 00:01:10,720
unicorn joining us from scythe he

28
00:01:10,720 --> 00:01:13,920
represents red and purple he's the cto

29
00:01:13,920 --> 00:01:16,240
and the co-creator of the c2 matrix

30
00:01:16,240 --> 00:01:17,600
which i love

31
00:01:17,600 --> 00:01:20,240
um and also a ton of other stuff and i'm

32
00:01:20,240 --> 00:01:23,520
a huge i stan jorge like honestly i do i

33
00:01:23,520 --> 00:01:25,280
can't help it he's awesome

34
00:01:25,280 --> 00:01:27,680
um and then finally we have ricky banda

35
00:01:27,680 --> 00:01:29,920
and he has a really fancy title he's the

36
00:01:29,920 --> 00:01:32,799
incident commander for amazon security

37
00:01:32,799 --> 00:01:35,200
incident response team so

38
00:01:35,200 --> 00:01:37,680
all of these people are a big deal super

39
00:01:37,680 --> 00:01:38,720
awesome

40
00:01:38,720 --> 00:01:41,200
uh seasoned professionals coming in to

41
00:01:41,200 --> 00:01:43,520
share their knowledge and wisdom

42
00:01:43,520 --> 00:01:45,200
for the threat reports that we have

43
00:01:45,200 --> 00:01:47,439
selected and for the purposes of this

44
00:01:47,439 --> 00:01:50,240
talk they are all tlp white so we will

45
00:01:50,240 --> 00:01:53,280
not be discussing any tlp amber anything

46
00:01:53,280 --> 00:01:56,399
or tlp red or tlp green so

47
00:01:56,399 --> 00:01:59,040
um and also too the focus of this talk

48
00:01:59,040 --> 00:02:01,280
is and panel is more

49
00:02:01,280 --> 00:02:03,280
actionable takeaways taking the

50
00:02:03,280 --> 00:02:06,000
information to the next level and

51
00:02:06,000 --> 00:02:08,479
um you know we wanted to bring

52
00:02:08,479 --> 00:02:10,720
vegas to you in case you're not there in

53
00:02:10,720 --> 00:02:13,520
person so threat report roulette

54
00:02:13,520 --> 00:02:16,080
and as you can see on the screen we have

55
00:02:16,080 --> 00:02:19,360
a threat report roulette wheel and what

56
00:02:19,360 --> 00:02:20,879
we're gonna do we're gonna spin the

57
00:02:20,879 --> 00:02:23,840
wheel uh we'll call on an analyst

58
00:02:23,840 --> 00:02:25,840
and then they will give their insights

59
00:02:25,840 --> 00:02:28,319
for a couple of minutes and then

60
00:02:28,319 --> 00:02:30,239
from there uh we will have our

61
00:02:30,239 --> 00:02:32,319
stakeholders and the reason why we have

62
00:02:32,319 --> 00:02:34,400
stakeholders is because

63
00:02:34,400 --> 00:02:36,879
well they're the consumers of all of the

64
00:02:36,879 --> 00:02:37,840
info

65
00:02:37,840 --> 00:02:38,800
and

66
00:02:38,800 --> 00:02:40,640
if they don't like it

67
00:02:40,640 --> 00:02:42,640
that's bad so we want to make things

68
00:02:42,640 --> 00:02:44,879
that they like and want to consume

69
00:02:44,879 --> 00:02:47,599
and are actionable within their org

70
00:02:47,599 --> 00:02:49,599
and for the sake of debate and all of

71
00:02:49,599 --> 00:02:51,280
that all of the reports we're going to

72
00:02:51,280 --> 00:02:54,000
assume are actionable and relevant to

73
00:02:54,000 --> 00:02:55,760
their organization as their as the

74
00:02:55,760 --> 00:02:58,319
analysts are performing their analysis

75
00:02:58,319 --> 00:03:01,040
all right so is everyone ready to get

76
00:03:01,040 --> 00:03:04,400
started for threat report roulette yep

77
00:03:04,400 --> 00:03:07,840
we are good again yay okay so and uh

78
00:03:07,840 --> 00:03:10,480
audience just just be forewarned i have

79
00:03:10,480 --> 00:03:13,280
a timer and so i'm going to be timing

80
00:03:13,280 --> 00:03:15,440
the participants responses

81
00:03:15,440 --> 00:03:18,080
and uh they have approximately five

82
00:03:18,080 --> 00:03:20,720
minutes to respond so if they

83
00:03:20,720 --> 00:03:23,440
meet time i'm gonna yell time

84
00:03:23,440 --> 00:03:26,720
so uh don't just be forewarned that i

85
00:03:26,720 --> 00:03:29,360
will be uh very vocal in

86
00:03:29,360 --> 00:03:32,400
moving the session along so i am going

87
00:03:32,400 --> 00:03:36,159
to spin the wheel

88
00:03:37,200 --> 00:03:39,680
oh what's it gonna be the defer report

89
00:03:39,680 --> 00:03:41,360
number two

90
00:03:41,360 --> 00:03:44,000
so i'm going to the github gonna look at

91
00:03:44,000 --> 00:03:46,480
the default report number two oh that's

92
00:03:46,480 --> 00:03:49,680
soda no kibi um and rival and in case

93
00:03:49,680 --> 00:03:51,200
you guys want to play along in the

94
00:03:51,200 --> 00:03:52,239
audience

95
00:03:52,239 --> 00:03:56,080
it is at bitly or it's a bitly link dc

96
00:03:56,080 --> 00:03:58,159
29 roulette

97
00:03:58,159 --> 00:04:00,959
dc 29 roulette and that takes you to the

98
00:04:00,959 --> 00:04:02,720
github page

99
00:04:02,720 --> 00:04:03,760
so

100
00:04:03,760 --> 00:04:06,560
uh let's see defer report two

101
00:04:06,560 --> 00:04:09,120
and that goes to crewster

102
00:04:09,120 --> 00:04:10,560
[Music]

103
00:04:10,560 --> 00:04:13,519
and you have 15 seconds to organize your

104
00:04:13,519 --> 00:04:14,959
thoughts and i'm going to start the

105
00:04:14,959 --> 00:04:17,839
countdown right now

106
00:04:17,839 --> 00:04:20,798
sure excellent

107
00:04:20,880 --> 00:04:22,400
so um

108
00:04:22,400 --> 00:04:24,639
right off the bat these dfi reports are

109
00:04:24,639 --> 00:04:26,800
very extensive these are the type of

110
00:04:26,800 --> 00:04:28,320
things that multiple consumers and your

111
00:04:28,320 --> 00:04:30,240
org can use from the technical and

112
00:04:30,240 --> 00:04:32,639
strategic side so among the reports

113
00:04:32,639 --> 00:04:33,680
we've gone through i found these to be

114
00:04:33,680 --> 00:04:35,280
the most beneficial for the widest

115
00:04:35,280 --> 00:04:36,240
audience

116
00:04:36,240 --> 00:04:37,840
but in this particular report i went

117
00:04:37,840 --> 00:04:39,120
through and looked and saw some

118
00:04:39,120 --> 00:04:41,600
particular things that i would key on on

119
00:04:41,600 --> 00:04:43,680
for kind of creating some custom

120
00:04:43,680 --> 00:04:46,400
indicators aside from just static hashes

121
00:04:46,400 --> 00:04:48,479
and ips and domains that we all know

122
00:04:48,479 --> 00:04:49,600
change

123
00:04:49,600 --> 00:04:52,080
pretty pretty rapidly so for this one

124
00:04:52,080 --> 00:04:53,440
with revo

125
00:04:53,440 --> 00:04:55,040
uh one of the things i noticed during

126
00:04:55,040 --> 00:04:57,440
the process is that they have excel

127
00:04:57,440 --> 00:05:01,080
calling wmic.exe

128
00:05:01,360 --> 00:05:02,639
now if you're not familiar with that

129
00:05:02,639 --> 00:05:04,240
process that's a kind of information

130
00:05:04,240 --> 00:05:06,400
kind of system gathering process there's

131
00:05:06,400 --> 00:05:08,479
really no reason why an excel

132
00:05:08,479 --> 00:05:10,320
document should ever be calling that in

133
00:05:10,320 --> 00:05:13,039
a normal environment uh maybe you have a

134
00:05:13,039 --> 00:05:15,680
developer or a sysadmin that built their

135
00:05:15,680 --> 00:05:17,199
own custom tool but in that case you'd

136
00:05:17,199 --> 00:05:18,320
know about that this would be something

137
00:05:18,320 --> 00:05:20,080
that would be you know whitelisted in

138
00:05:20,080 --> 00:05:21,759
some way but right off the bat if you

139
00:05:21,759 --> 00:05:24,440
have an excel document calling

140
00:05:24,440 --> 00:05:26,320
wmic.exe right off the bat if you create

141
00:05:26,320 --> 00:05:27,759
an alert for that that's one of the

142
00:05:27,759 --> 00:05:29,520
early stages of this kind of kicking off

143
00:05:29,520 --> 00:05:31,280
you can get an indicator there

144
00:05:31,280 --> 00:05:32,400
um

145
00:05:32,400 --> 00:05:34,160
but again there will be fringe case here

146
00:05:34,160 --> 00:05:35,280
and there with an admin that may be

147
00:05:35,280 --> 00:05:36,720
built in excel spreadsheet with other

148
00:05:36,720 --> 00:05:38,639
scripts it's possible

149
00:05:38,639 --> 00:05:40,720
another thing here i noticed is that um

150
00:05:40,720 --> 00:05:42,400
as we know with any of these uh with

151
00:05:42,400 --> 00:05:44,880
revo and even malware ransomware samples

152
00:05:44,880 --> 00:05:46,240
they're going to want to

153
00:05:46,240 --> 00:05:47,600
maintain persistence so they're going to

154
00:05:47,600 --> 00:05:48,720
try and do some registry key

155
00:05:48,720 --> 00:05:51,199
modifications and whatnot for this

156
00:05:51,199 --> 00:05:53,280
they're gonna they they created a a run

157
00:05:53,280 --> 00:05:55,120
once key

158
00:05:55,120 --> 00:05:56,560
and that's something that's you know

159
00:05:56,560 --> 00:05:58,000
pretty common for programs that want to

160
00:05:58,000 --> 00:06:00,319
boot up every time the system starts but

161
00:06:00,319 --> 00:06:02,560
they use an asterisk meaning that it is

162
00:06:02,560 --> 00:06:05,280
it is also boots up in safe mode

163
00:06:05,280 --> 00:06:06,639
so if you think about it what other

164
00:06:06,639 --> 00:06:08,800
applications do you have users that want

165
00:06:08,800 --> 00:06:11,120
to have to open up during safe mode so

166
00:06:11,120 --> 00:06:13,199
right off the bat if someone you know

167
00:06:13,199 --> 00:06:14,880
makes a registry modification for one

168
00:06:14,880 --> 00:06:16,960
what's key and uses the asterisk that

169
00:06:16,960 --> 00:06:19,120
means it has to be open during safe mode

170
00:06:19,120 --> 00:06:20,080
and that would be another thing i

171
00:06:20,080 --> 00:06:22,080
learned on because again what what user

172
00:06:22,080 --> 00:06:24,080
what what normal circumstance in your

173
00:06:24,080 --> 00:06:26,400
environment is that is that necessary um

174
00:06:26,400 --> 00:06:28,800
if this is like a custom server that has

175
00:06:28,800 --> 00:06:30,400
software that has to boot up during safe

176
00:06:30,400 --> 00:06:31,680
mode this is all going to be done during

177
00:06:31,680 --> 00:06:34,319
configuration this is all going to be

178
00:06:34,319 --> 00:06:36,319
created while you're not in an alerting

179
00:06:36,319 --> 00:06:38,080
mode so

180
00:06:38,080 --> 00:06:39,680
while these things are in the wild and

181
00:06:39,680 --> 00:06:40,880
people interacting with servers this

182
00:06:40,880 --> 00:06:42,160
isn't something a user an admin is going

183
00:06:42,160 --> 00:06:43,440
to make changes to they're not going to

184
00:06:43,440 --> 00:06:44,880
they're not going to have it boot up in

185
00:06:44,880 --> 00:06:46,080
safe mode unless they're in some sort of

186
00:06:46,080 --> 00:06:48,639
change window or configuration menu uh

187
00:06:48,639 --> 00:06:50,080
period where you would know and if you

188
00:06:50,080 --> 00:06:51,280
saw the story you wouldn't be concerned

189
00:06:51,280 --> 00:06:53,360
about it with it

190
00:06:53,360 --> 00:06:56,160
um another thing they do again changes

191
00:06:56,160 --> 00:06:58,000
to schedule tasks although you know

192
00:06:58,000 --> 00:06:59,199
changes are scheduled to task isn't

193
00:06:59,199 --> 00:07:00,880
always an indicator that's a key thing

194
00:07:00,880 --> 00:07:02,400
to look at because how many of your

195
00:07:02,400 --> 00:07:04,240
common users are making changes to

196
00:07:04,240 --> 00:07:05,680
scheduled tasks on their own it's just

197
00:07:05,680 --> 00:07:07,680
not that common so you find that the

198
00:07:07,680 --> 00:07:09,199
situations where

199
00:07:09,199 --> 00:07:11,520
and the you know certain key value pairs

200
00:07:11,520 --> 00:07:13,120
that kind of indicate the scheduled task

201
00:07:13,120 --> 00:07:14,639
is something that keeps persistence and

202
00:07:14,639 --> 00:07:16,639
it's another good indicator

203
00:07:16,639 --> 00:07:20,000
um let's see oh another thing is so

204
00:07:20,000 --> 00:07:21,520
prior to executing the ransomware the

205
00:07:21,520 --> 00:07:23,120
threat actors created gpo disabled

206
00:07:23,120 --> 00:07:25,039
windows defender across your system if

207
00:07:25,039 --> 00:07:26,639
you don't have some sort of alert that

208
00:07:26,639 --> 00:07:28,160
that alerts when your antivirus is

209
00:07:28,160 --> 00:07:30,160
turned off then you know that's kind of

210
00:07:30,160 --> 00:07:31,599
table stakes but that's another key one

211
00:07:31,599 --> 00:07:34,160
right there aside from you know gpos

212
00:07:34,160 --> 00:07:35,360
being pushed in general they should be

213
00:07:35,360 --> 00:07:37,039
getting some sort of change window so if

214
00:07:37,039 --> 00:07:39,199
it's being pushed from a non-admin or a

215
00:07:39,199 --> 00:07:41,120
new account or something

216
00:07:41,120 --> 00:07:44,000
so those are some of the you know aside

217
00:07:44,000 --> 00:07:45,599
from the obvious ones that i picked up

218
00:07:45,599 --> 00:07:48,560
on from this document

219
00:07:51,039 --> 00:07:52,879
anyone have any thoughts oh right

220
00:07:52,879 --> 00:07:55,599
awesome so that is actually perfect

221
00:07:55,599 --> 00:07:58,960
within the time so now our stakeholders

222
00:07:58,960 --> 00:08:00,800
will be able to comment on this

223
00:08:00,800 --> 00:08:02,560
particular report for the next five

224
00:08:02,560 --> 00:08:05,199
minutes and i am going to start the

225
00:08:05,199 --> 00:08:08,160
timer and jorge is raising his hand so

226
00:08:08,160 --> 00:08:10,000
please feel free

227
00:08:10,000 --> 00:08:11,360
awesome

228
00:08:11,360 --> 00:08:14,800
awesome uh review there um chris i wanna

229
00:08:14,800 --> 00:08:17,199
touch on something you said very briefly

230
00:08:17,199 --> 00:08:19,440
at the beginning that uh

231
00:08:19,440 --> 00:08:20,960
some of you might not have caught and

232
00:08:20,960 --> 00:08:24,160
that is that the defer report is a great

233
00:08:24,160 --> 00:08:28,160
resource and uh goes to the widest

234
00:08:28,160 --> 00:08:29,919
audience i think we're going to see this

235
00:08:29,919 --> 00:08:31,440
as we go through

236
00:08:31,440 --> 00:08:33,360
the roulette here there are going to be

237
00:08:33,360 --> 00:08:35,279
some reports that target different

238
00:08:35,279 --> 00:08:37,440
audience some are targeted to people in

239
00:08:37,440 --> 00:08:39,440
the detection world some are targeted to

240
00:08:39,440 --> 00:08:42,958
red teams some are targeted um to uh

241
00:08:42,958 --> 00:08:45,120
analysts looking up iocs and things like

242
00:08:45,120 --> 00:08:47,040
that right so um

243
00:08:47,040 --> 00:08:50,320
plus one on that we love the d4 report

244
00:08:50,320 --> 00:08:52,640
uh sponsor them if you can i definitely

245
00:08:52,640 --> 00:08:54,399
sponsor them out of pocket they're

246
00:08:54,399 --> 00:08:57,440
amazing um and yes this report right

247
00:08:57,440 --> 00:09:00,720
everyone's heard about uh rival right um

248
00:09:00,720 --> 00:09:03,920
especially after uh

249
00:09:03,920 --> 00:09:06,000
and uh

250
00:09:06,000 --> 00:09:08,160
i i like the the intro right you can

251
00:09:08,160 --> 00:09:09,839
read the first couple paragraphs without

252
00:09:09,839 --> 00:09:12,560
being that technical and still get

253
00:09:12,560 --> 00:09:14,720
something out of this report but once

254
00:09:14,720 --> 00:09:17,519
you dive deeper into it we get all the

255
00:09:17,519 --> 00:09:20,120
way to the point where we have actual

256
00:09:20,120 --> 00:09:21,839
procedures

257
00:09:21,839 --> 00:09:23,680
and one that you touched on right now

258
00:09:23,680 --> 00:09:27,120
was adding a registry key that has an

259
00:09:27,120 --> 00:09:30,000
asterisk in it um i was actually today

260
00:09:30,000 --> 00:09:32,399
days old so first five minutes of uh

261
00:09:32,399 --> 00:09:34,160
roulette you taught me something i did

262
00:09:34,160 --> 00:09:37,680
not know that an asterisk in front of a

263
00:09:37,680 --> 00:09:40,800
registry key meant that it could start

264
00:09:40,800 --> 00:09:42,720
in safe mode so thank you for that bit

265
00:09:42,720 --> 00:09:44,800
of knowledge and again shout out to the

266
00:09:44,800 --> 00:09:46,959
default report i'll let someone else uh

267
00:09:46,959 --> 00:09:48,240
weigh in

268
00:09:48,240 --> 00:09:51,040
oh i just want to say i i was today

269
00:09:51,040 --> 00:09:53,440
years old as well when i heard that so

270
00:09:53,440 --> 00:09:55,519
thank you so much for your insights this

271
00:09:55,519 --> 00:09:57,120
is why i love this

272
00:09:57,120 --> 00:10:00,000
and uh i wanted to add too besides me

273
00:10:00,000 --> 00:10:02,480
being a sponsor of the d4 report as well

274
00:10:02,480 --> 00:10:04,399
or i pay out of pocket

275
00:10:04,399 --> 00:10:06,079
because i think it's awesome

276
00:10:06,079 --> 00:10:10,240
and uh you know i give them my money so

277
00:10:10,240 --> 00:10:12,880
um is actually the community involvement

278
00:10:12,880 --> 00:10:15,600
with the deferred report too like beyond

279
00:10:15,600 --> 00:10:17,760
beyond analysts using it

280
00:10:17,760 --> 00:10:19,279
something that i thought was really

281
00:10:19,279 --> 00:10:22,160
interesting was black matter 23

282
00:10:22,160 --> 00:10:24,880
and he he tweeted out

283
00:10:24,880 --> 00:10:28,000
eight detection ideas and 18 rules 18

284
00:10:28,000 --> 00:10:31,120
rules and so he has a whole github with

285
00:10:31,120 --> 00:10:34,240
detection ideas detection rules based

286
00:10:34,240 --> 00:10:36,959
solely on the differ report and so i

287
00:10:36,959 --> 00:10:38,640
just really love

288
00:10:38,640 --> 00:10:40,959
to see the positive impact that the

289
00:10:40,959 --> 00:10:42,640
differ report is having within the

290
00:10:42,640 --> 00:10:45,279
community and all of these amazing

291
00:10:45,279 --> 00:10:47,279
professionals around the world kind of

292
00:10:47,279 --> 00:10:48,800
like the people on this panel they're

293
00:10:48,800 --> 00:10:50,560
people from around the world

294
00:10:50,560 --> 00:10:52,640
coming together and discussing cyber

295
00:10:52,640 --> 00:10:55,519
security and protecting organizations

296
00:10:55,519 --> 00:10:58,079
so thank you anyone else want to comment

297
00:10:58,079 --> 00:11:00,160
on this

298
00:11:00,160 --> 00:11:01,519
okay danny

299
00:11:01,519 --> 00:11:02,480
okay

300
00:11:02,480 --> 00:11:04,320
so for me as

301
00:11:04,320 --> 00:11:05,360
a

302
00:11:05,360 --> 00:11:08,720
incident responders l3 sock analyst some

303
00:11:08,720 --> 00:11:11,120
of the things that i like about this is

304
00:11:11,120 --> 00:11:13,440
that it tells me what it gives me

305
00:11:13,440 --> 00:11:16,800
information of what to look for if i'm

306
00:11:16,800 --> 00:11:19,279
trying to find the intrusion

307
00:11:19,279 --> 00:11:21,440
so talk about where the files could be

308
00:11:21,440 --> 00:11:22,959
located

309
00:11:22,959 --> 00:11:24,560
there are some things that will change

310
00:11:24,560 --> 00:11:25,839
but there are some things that are

311
00:11:25,839 --> 00:11:28,320
static based on how the adversary likes

312
00:11:28,320 --> 00:11:30,959
to place things so finding things in say

313
00:11:30,959 --> 00:11:34,560
a public folder is out of the ordinary

314
00:11:34,560 --> 00:11:36,560
so those are artifacts that i will look

315
00:11:36,560 --> 00:11:38,399
for

316
00:11:38,399 --> 00:11:41,440
and furthermore some things that i would

317
00:11:41,440 --> 00:11:43,120
also try

318
00:11:43,120 --> 00:11:45,680
we usually get we usually respond to

319
00:11:45,680 --> 00:11:48,240
alerts and so some of the alerts is

320
00:11:48,240 --> 00:11:51,920
generally when a phishing occurs

321
00:11:51,920 --> 00:11:54,480
but finding uh finding any sort of

322
00:11:54,480 --> 00:11:56,480
registry

323
00:11:56,480 --> 00:11:58,959
key such as the

324
00:11:58,959 --> 00:12:01,760
safe mode is definitely a um

325
00:12:01,760 --> 00:12:04,240
definitely a interesting indicator to

326
00:12:04,240 --> 00:12:07,040
look into so looking into the

327
00:12:07,040 --> 00:12:09,440
auto runs

328
00:12:09,440 --> 00:12:11,360
so the uh so the default report is

329
00:12:11,360 --> 00:12:12,959
definitely a good one for incident

330
00:12:12,959 --> 00:12:14,720
responders

331
00:12:14,720 --> 00:12:17,600
okay thank you and will any comments

332
00:12:17,600 --> 00:12:20,720
uh just as a quick one is i i believe

333
00:12:20,720 --> 00:12:23,200
that this was one of the first instances

334
00:12:23,200 --> 00:12:26,160
of iced id being used as the initial

335
00:12:26,160 --> 00:12:29,040
access vector for um our evil which was

336
00:12:29,040 --> 00:12:31,519
a which was an interesting evolution for

337
00:12:31,519 --> 00:12:33,279
that particular malware family because

338
00:12:33,279 --> 00:12:34,959
it has is associated with other

339
00:12:34,959 --> 00:12:37,680
ransomware actors so it's definitely a

340
00:12:37,680 --> 00:12:39,920
now our family want to prioritize if

341
00:12:39,920 --> 00:12:41,440
you're worried about being targeted by

342
00:12:41,440 --> 00:12:43,200
ransomware operators

343
00:12:43,200 --> 00:12:45,519
oh yes i i totally agree with this

344
00:12:45,519 --> 00:12:48,000
initial access brokers like that's where

345
00:12:48,000 --> 00:12:50,480
the money's at right

346
00:12:50,480 --> 00:12:53,440
okay so i if everyone's okay uh we're

347
00:12:53,440 --> 00:12:55,360
gonna move on to

348
00:12:55,360 --> 00:12:59,360
the next threat report thumbs up good

349
00:12:59,360 --> 00:13:00,399
all right

350
00:13:00,399 --> 00:13:02,480
so

351
00:13:02,480 --> 00:13:07,160
i'm going to spin the wheel

352
00:13:08,800 --> 00:13:11,920
and secure list so

353
00:13:11,920 --> 00:13:14,480
this one

354
00:13:14,480 --> 00:13:18,399
goes to who wants it who wants it first

355
00:13:18,399 --> 00:13:20,560
is this the black kingdom

356
00:13:20,560 --> 00:13:22,959
yes do you want this one danny

357
00:13:22,959 --> 00:13:25,360
yeah i'll take this one okay it's all

358
00:13:25,360 --> 00:13:27,680
yours and i'm starting the timer right

359
00:13:27,680 --> 00:13:29,040
now

360
00:13:29,040 --> 00:13:30,880
okay so

361
00:13:30,880 --> 00:13:34,079
black um black kingdom that one was one

362
00:13:34,079 --> 00:13:37,440
of the more interesting ones

363
00:13:37,440 --> 00:13:38,560
uh

364
00:13:38,560 --> 00:13:40,160
i don't remember

365
00:13:40,160 --> 00:13:43,839
i took notes on this one

366
00:13:45,120 --> 00:13:48,120
kingdom

367
00:13:48,160 --> 00:13:50,639
shoot

368
00:13:52,959 --> 00:13:54,000
okay

369
00:13:54,000 --> 00:13:56,639
so this one was actually using pipe um

370
00:13:56,639 --> 00:13:59,040
python for the entries especially web

371
00:13:59,040 --> 00:14:00,240
shells

372
00:14:00,240 --> 00:14:02,240
since this one deals with web shelves um

373
00:14:02,240 --> 00:14:04,399
this one the web shelves are generally

374
00:14:04,399 --> 00:14:06,560
targeting on forward-facing

375
00:14:06,560 --> 00:14:09,519
public-facing servers

376
00:14:09,519 --> 00:14:12,160
so the as far as the public-facing

377
00:14:12,160 --> 00:14:15,199
servers go these are

378
00:14:15,199 --> 00:14:19,440
some ways that we want to take a look at

379
00:14:19,440 --> 00:14:20,800
one

380
00:14:20,800 --> 00:14:24,240
finding out that there's no

381
00:14:24,240 --> 00:14:26,560
no out of the ordinary

382
00:14:26,560 --> 00:14:30,959
php files or any sort within our servers

383
00:14:30,959 --> 00:14:32,800
and especially the

384
00:14:32,800 --> 00:14:35,519
for this one this one targeted the

385
00:14:35,519 --> 00:14:38,079
microsoft exchange server which

386
00:14:38,079 --> 00:14:40,160
was one of the big

387
00:14:40,160 --> 00:14:43,839
big events back in a couple months ago

388
00:14:43,839 --> 00:14:46,800
once that was out we did

389
00:14:46,800 --> 00:14:50,079
in fact thinking of my last

390
00:14:50,079 --> 00:14:52,639
people i worked for

391
00:14:52,639 --> 00:14:54,720
we had to

392
00:14:54,720 --> 00:14:56,959
go around making sure that no one made

393
00:14:56,959 --> 00:15:01,120
any authentications and uploads into the

394
00:15:01,120 --> 00:15:03,600
exchange servers

395
00:15:03,600 --> 00:15:06,880
but the way that this was

396
00:15:06,880 --> 00:15:09,279
interestingly done

397
00:15:09,279 --> 00:15:11,680
they hard coded

398
00:15:11,680 --> 00:15:15,680
some when some folders to exclude rather

399
00:15:15,680 --> 00:15:18,720
than using regex

400
00:15:18,720 --> 00:15:22,000
but for me as an incident responder i

401
00:15:22,000 --> 00:15:24,320
would be looking for

402
00:15:24,320 --> 00:15:27,680
any sort of anomalous php files or

403
00:15:27,680 --> 00:15:29,680
executions within

404
00:15:29,680 --> 00:15:32,079
the exchange servers that the client

405
00:15:32,079 --> 00:15:34,479
owns

406
00:15:38,240 --> 00:15:41,040
and that's pretty much about it this one

407
00:15:41,040 --> 00:15:41,950
was um

408
00:15:41,950 --> 00:15:43,759
[Music]

409
00:15:43,759 --> 00:15:45,920
this one went more into depth and how it

410
00:15:45,920 --> 00:15:48,160
was programmed but from a ttp

411
00:15:48,160 --> 00:15:49,440
perspective

412
00:15:49,440 --> 00:15:50,240
it's

413
00:15:50,240 --> 00:15:54,320
what it would generally upload in

414
00:15:54,320 --> 00:15:56,959
and so that for me is where i would be

415
00:15:56,959 --> 00:15:58,399
focusing on

416
00:15:58,399 --> 00:16:00,800
to make sure the client does not have

417
00:16:00,800 --> 00:16:01,759
any

418
00:16:01,759 --> 00:16:05,920
anomalous uploads into their servers

419
00:16:05,920 --> 00:16:07,519
no that's great that's great and

420
00:16:07,519 --> 00:16:09,120
definitely um

421
00:16:09,120 --> 00:16:11,759
uh you know look at patching those cves

422
00:16:11,759 --> 00:16:14,160
that are in the report too right yeah

423
00:16:14,160 --> 00:16:16,800
yeah like um and prioritizing them if

424
00:16:16,800 --> 00:16:18,959
they aren't already done and any

425
00:16:18,959 --> 00:16:20,720
stakeholders that are interested in

426
00:16:20,720 --> 00:16:24,160
commenting on this particular report

427
00:16:24,160 --> 00:16:26,639
i'll be glad to take that okay thanks

428
00:16:26,639 --> 00:16:27,600
joe

429
00:16:27,600 --> 00:16:29,360
so um

430
00:16:29,360 --> 00:16:32,639
from um the explanation here um you know

431
00:16:32,639 --> 00:16:35,120
again so as a red teamer uh my my job

432
00:16:35,120 --> 00:16:37,920
with uh the most of these reports is to

433
00:16:37,920 --> 00:16:39,519
either uh

434
00:16:39,519 --> 00:16:42,639
because this report does uh is not as uh

435
00:16:42,639 --> 00:16:45,120
in-depth as the you know dfir reports

436
00:16:45,120 --> 00:16:47,519
thiefer reports which are again plus one

437
00:16:47,519 --> 00:16:50,240
fantastic um this report is pretty

438
00:16:50,240 --> 00:16:52,079
in-depth though but they do uh the

439
00:16:52,079 --> 00:16:54,560
specific report the cti channel that you

440
00:16:54,560 --> 00:16:56,240
know we're getting it from um here on

441
00:16:56,240 --> 00:16:58,399
the stakeholders panel um is really

442
00:16:58,399 --> 00:17:00,320
telling me you know the the things that

443
00:17:00,320 --> 00:17:02,000
i do as a red team with these is i

444
00:17:02,000 --> 00:17:04,000
either have to try to write the same

445
00:17:04,000 --> 00:17:06,079
ransomware they are the same tactics

446
00:17:06,079 --> 00:17:08,319
ttps they have to help try to break into

447
00:17:08,319 --> 00:17:11,359
the network to again help write iocs um

448
00:17:11,359 --> 00:17:12,880
take it to my detection and engineering

449
00:17:12,880 --> 00:17:15,199
team say have you guys seen these things

450
00:17:15,199 --> 00:17:16,959
we're about to run these things for you

451
00:17:16,959 --> 00:17:20,000
guys to help you see if we can commit to

452
00:17:20,000 --> 00:17:21,679
creating better detections and better

453
00:17:21,679 --> 00:17:23,119
iocs

454
00:17:23,119 --> 00:17:25,280
uh for the indicators of compromise so

455
00:17:25,280 --> 00:17:27,359
uh while writing these things uh this

456
00:17:27,359 --> 00:17:29,200
report is

457
00:17:29,200 --> 00:17:31,280
thorough enough that um i could take it

458
00:17:31,280 --> 00:17:33,600
and then from a cti perspective um you

459
00:17:33,600 --> 00:17:34,799
know it's one of the things that i have

460
00:17:34,799 --> 00:17:36,640
to ask though is is looking at this

461
00:17:36,640 --> 00:17:38,720
report um

462
00:17:38,720 --> 00:17:40,960
you know am i even a potential affected

463
00:17:40,960 --> 00:17:43,280
uh uh you know

464
00:17:43,280 --> 00:17:45,520
an affected client am i a target of this

465
00:17:45,520 --> 00:17:47,760
report you know i want to spend the time

466
00:17:47,760 --> 00:17:50,559
that i have an in a 9 to 5 40 hour work

467
00:17:50,559 --> 00:17:52,160
week making sure that i'm writing the

468
00:17:52,160 --> 00:17:55,200
right defenses here for my

469
00:17:55,200 --> 00:17:58,480
my company for the company here um so

470
00:17:58,480 --> 00:18:00,799
when it comes to this report

471
00:18:00,799 --> 00:18:02,559
some of that stuff is here uh anybody

472
00:18:02,559 --> 00:18:04,000
getting in some of the ttps are

473
00:18:04,000 --> 00:18:05,919
definitely here and i can see that the

474
00:18:05,919 --> 00:18:08,720
cves they're attacking so i can again

475
00:18:08,720 --> 00:18:11,200
try to reverse engineer find pocs proof

476
00:18:11,200 --> 00:18:13,200
of concepts that'll work

477
00:18:13,200 --> 00:18:16,320
and then develop again a um

478
00:18:16,320 --> 00:18:19,280
a single executable or a string or an

479
00:18:19,280 --> 00:18:22,400
individual poc that mimics this specific

480
00:18:22,400 --> 00:18:23,440
kind of

481
00:18:23,440 --> 00:18:27,280
um ransomware malware

482
00:18:27,280 --> 00:18:29,360
okay thank you very much and

483
00:18:29,360 --> 00:18:31,760
uh oh it looks like uh we have ricky

484
00:18:31,760 --> 00:18:33,039
chiming in

485
00:18:33,039 --> 00:18:34,320
do you want to chime in really quick

486
00:18:34,320 --> 00:18:35,760
ricky

487
00:18:35,760 --> 00:18:37,600
uh yeah yeah

488
00:18:37,600 --> 00:18:39,200
um

489
00:18:39,200 --> 00:18:41,360
so

490
00:18:41,600 --> 00:18:43,760
looking at the report

491
00:18:43,760 --> 00:18:45,679
listening to uh

492
00:18:45,679 --> 00:18:48,160
what we have folks saying right i look

493
00:18:48,160 --> 00:18:49,760
at something like this

494
00:18:49,760 --> 00:18:52,400
and i'm thinking

495
00:18:53,760 --> 00:18:56,000
this is impacting me or this isn't

496
00:18:56,000 --> 00:18:59,039
affecting anywhere i work or

497
00:18:59,039 --> 00:19:01,039
an organization i'm responsible for

498
00:19:01,039 --> 00:19:02,160
business

499
00:19:02,160 --> 00:19:04,080
something like to that effect

500
00:19:04,080 --> 00:19:05,280
and

501
00:19:05,280 --> 00:19:08,840
i have to be able to look at these uh

502
00:19:08,840 --> 00:19:10,960
reports and

503
00:19:10,960 --> 00:19:12,960
take action

504
00:19:12,960 --> 00:19:13,760
right

505
00:19:13,760 --> 00:19:16,559
so i'm looking at something like this

506
00:19:16,559 --> 00:19:19,200
and uh

507
00:19:19,919 --> 00:19:22,480
i have multiple lines of pipelines of

508
00:19:22,480 --> 00:19:25,280
work kind of already kind of going out

509
00:19:25,280 --> 00:19:26,720
of my mind right now

510
00:19:26,720 --> 00:19:29,280
i'm thinking okay

511
00:19:29,280 --> 00:19:31,440
we have this scenario

512
00:19:31,440 --> 00:19:33,520
are we prepared from a

513
00:19:33,520 --> 00:19:35,679
insurance perspective are we prepared

514
00:19:35,679 --> 00:19:36,840
from a pr

515
00:19:36,840 --> 00:19:39,679
perspective uh do i know my stakeholders

516
00:19:39,679 --> 00:19:41,919
in these areas meanwhile i'm assigning

517
00:19:41,919 --> 00:19:43,760
two to three incident response engineers

518
00:19:43,760 --> 00:19:46,240
to go into log dives into the network

519
00:19:46,240 --> 00:19:47,679
our endpoints making sure that we have

520
00:19:47,679 --> 00:19:50,080
detections and engaging with the service

521
00:19:50,080 --> 00:19:52,240
owners and service teams to go and get

522
00:19:52,240 --> 00:19:54,880
me you know data

523
00:19:54,880 --> 00:19:56,400
so i can also make those types of

524
00:19:56,400 --> 00:19:58,799
assessments in the interim probably also

525
00:19:58,799 --> 00:20:01,360
on the phone with our legal team

526
00:20:01,360 --> 00:20:02,799
you know uh

527
00:20:02,799 --> 00:20:03,760
you know

528
00:20:03,760 --> 00:20:04,840
people who

529
00:20:04,840 --> 00:20:07,120
are uh also

530
00:20:07,120 --> 00:20:08,960
um

531
00:20:08,960 --> 00:20:10,640
in charge you know like executives

532
00:20:10,640 --> 00:20:14,000
directors and i'm thinking

533
00:20:14,000 --> 00:20:16,480
i have no [ __ ]

534
00:20:16,480 --> 00:20:18,159
i have a

535
00:20:18,159 --> 00:20:20,000
you know

536
00:20:20,000 --> 00:20:22,480
a um

537
00:20:23,280 --> 00:20:25,520
potential right for exfiltration within

538
00:20:25,520 --> 00:20:27,280
an environment i own or you know

539
00:20:27,280 --> 00:20:29,360
something that

540
00:20:29,360 --> 00:20:31,760
is uh going to impact the business in

541
00:20:31,760 --> 00:20:34,240
some way shape or form

542
00:20:34,240 --> 00:20:35,520
and so i don't of course i don't want to

543
00:20:35,520 --> 00:20:36,400
take up

544
00:20:36,400 --> 00:20:37,440
too much time

545
00:20:37,440 --> 00:20:39,600
but the thought process when i look at

546
00:20:39,600 --> 00:20:41,520
something that's uh

547
00:20:41,520 --> 00:20:43,840
related to

548
00:20:43,840 --> 00:20:46,959
ransomware or

549
00:20:47,280 --> 00:20:49,360
excellent date or anything like that is

550
00:20:49,360 --> 00:20:51,120
i have to think through

551
00:20:51,120 --> 00:20:52,159
what the

552
00:20:52,159 --> 00:20:54,400
actions on objective are what the impact

553
00:20:54,400 --> 00:20:56,320
is going to be

554
00:20:56,320 --> 00:20:57,200
and

555
00:20:57,200 --> 00:20:59,440
that i am collecting the right people in

556
00:20:59,440 --> 00:21:00,640
the room

557
00:21:00,640 --> 00:21:01,679
to

558
00:21:01,679 --> 00:21:03,360
make sure that we have an appropriate

559
00:21:03,360 --> 00:21:04,720
response

560
00:21:04,720 --> 00:21:07,280
to handle everything from pr

561
00:21:07,280 --> 00:21:09,600
to legal to

562
00:21:09,600 --> 00:21:12,400
financial to investigation

563
00:21:12,400 --> 00:21:14,080
risks all in kind of the same room and

564
00:21:14,080 --> 00:21:17,360
organizing all of these cats

565
00:21:17,360 --> 00:21:19,600
no that's great and so ricky makes a

566
00:21:19,600 --> 00:21:21,520
really great point um that i need to

567
00:21:21,520 --> 00:21:23,679
point out especially for people in the

568
00:21:23,679 --> 00:21:24,960
audience that are in larger

569
00:21:24,960 --> 00:21:26,640
organizations

570
00:21:26,640 --> 00:21:28,799
building those relationships ahead of

571
00:21:28,799 --> 00:21:30,799
time so that you know the product owners

572
00:21:30,799 --> 00:21:32,000
and you know the people and you

573
00:21:32,000 --> 00:21:34,559
understand their their backup schedule

574
00:21:34,559 --> 00:21:36,400
let's say your go-to person is on

575
00:21:36,400 --> 00:21:37,600
vacation

576
00:21:37,600 --> 00:21:39,840
and you don't know who to contact other

577
00:21:39,840 --> 00:21:41,760
than that you know and just

578
00:21:41,760 --> 00:21:43,840
understanding who to contact building

579
00:21:43,840 --> 00:21:45,919
the relationships and forming those

580
00:21:45,919 --> 00:21:47,600
connections before

581
00:21:47,600 --> 00:21:49,760
something horrible happens

582
00:21:49,760 --> 00:21:51,919
um i know it sounds simple but it's

583
00:21:51,919 --> 00:21:54,320
definitely been very beneficial in my

584
00:21:54,320 --> 00:21:57,520
experience to be able to just be like yo

585
00:21:57,520 --> 00:21:59,440
uh i need your help with something and

586
00:21:59,440 --> 00:22:02,559
already have that report established

587
00:22:02,559 --> 00:22:05,600
um so if everyone's okay i'm going to

588
00:22:05,600 --> 00:22:07,360
click on another report unless anyone

589
00:22:07,360 --> 00:22:10,479
else has something to add

590
00:22:11,039 --> 00:22:13,200
we're good thumbs up

591
00:22:13,200 --> 00:22:15,600
all right

592
00:22:17,280 --> 00:22:19,840
and i'm spinning the wheel

593
00:22:19,840 --> 00:22:22,960
ooh bc security two let's see which one

594
00:22:22,960 --> 00:22:25,280
that one is

595
00:22:25,280 --> 00:22:28,880
let's see that one is the overview of

596
00:22:28,880 --> 00:22:32,480
empire 4.0 c-sharp

597
00:22:32,480 --> 00:22:35,760
and let's see who wants to take that one

598
00:22:35,760 --> 00:22:37,200
we have

599
00:22:37,200 --> 00:22:38,799
uh

600
00:22:38,799 --> 00:22:41,840
you want that one well

601
00:22:42,400 --> 00:22:44,480
um could i

602
00:22:44,480 --> 00:22:46,480
pass for the next one

603
00:22:46,480 --> 00:22:51,440
okay uh let's see who wants this one

604
00:22:51,840 --> 00:22:56,559
no takers i i can take it okay go for it

605
00:22:56,559 --> 00:22:59,520
all right so uh bc security are the

606
00:22:59,520 --> 00:23:02,559
makers of empire empire

607
00:23:02,559 --> 00:23:04,320
what was originally called powershell

608
00:23:04,320 --> 00:23:07,919
empire uh is one of the most popular

609
00:23:07,919 --> 00:23:10,400
command and control frameworks i know

610
00:23:10,400 --> 00:23:12,320
that because of a project called the c2

611
00:23:12,320 --> 00:23:17,679
matrix um i also chose empire as the c2

612
00:23:17,679 --> 00:23:20,000
to teach people red team in my security

613
00:23:20,000 --> 00:23:22,720
564 class um the sans right team

614
00:23:22,720 --> 00:23:24,960
exercise and adversary emulation course

615
00:23:24,960 --> 00:23:27,280
because in a classroom environment you

616
00:23:27,280 --> 00:23:29,679
want a tool that is consistent and

617
00:23:29,679 --> 00:23:33,200
reliable and does what you tell it to do

618
00:23:33,200 --> 00:23:36,320
every time and with a lot of c2s that's

619
00:23:36,320 --> 00:23:39,200
just not the case but empire is one of

620
00:23:39,200 --> 00:23:42,720
those so uh back in july 2019

621
00:23:42,720 --> 00:23:45,840
the original creators of empire said

622
00:23:45,840 --> 00:23:48,080
that they were ending development and

623
00:23:48,080 --> 00:23:51,600
the folks over at bc security took over

624
00:23:51,600 --> 00:23:54,880
development which is fantastic um

625
00:23:54,880 --> 00:23:57,360
in this case we're gonna talk about in

626
00:23:57,360 --> 00:23:59,520
this blog post it's talking about the

627
00:23:59,520 --> 00:24:02,559
latest version of empire which is 4.0

628
00:24:02,559 --> 00:24:05,120
and c sharp and

629
00:24:05,120 --> 00:24:07,840
uh right off the bat in the intro

630
00:24:07,840 --> 00:24:11,440
uh you can see that a lot of the new c2s

631
00:24:11,440 --> 00:24:13,760
are popping up and the way to create

632
00:24:13,760 --> 00:24:16,480
implants actual payload or the stager

633
00:24:16,480 --> 00:24:18,640
that runs in your environment

634
00:24:18,640 --> 00:24:19,760
is

635
00:24:19,760 --> 00:24:22,960
before was powershell right um now lots

636
00:24:22,960 --> 00:24:24,720
of people say powershell's dead

637
00:24:24,720 --> 00:24:26,640
sometimes it was python but we're

638
00:24:26,640 --> 00:24:29,520
definitely seeing an uptick in c sharp

639
00:24:29,520 --> 00:24:32,720
um and c sharp is a language you can

640
00:24:32,720 --> 00:24:34,400
anyone can actually write c sharp code

641
00:24:34,400 --> 00:24:36,799
you can download a version of visual

642
00:24:36,799 --> 00:24:39,520
studio community and

643
00:24:39,520 --> 00:24:43,520
compile your own uh c sharp uh code so

644
00:24:43,520 --> 00:24:46,480
uh in this case we take a look at

645
00:24:46,480 --> 00:24:49,520
how empire works the the latest updates

646
00:24:49,520 --> 00:24:52,080
to it how to run it so c2 framework so

647
00:24:52,080 --> 00:24:54,080
you have the server component which is

648
00:24:54,080 --> 00:24:57,039
your listener listens on a particular uh

649
00:24:57,039 --> 00:24:58,480
uh port

650
00:24:58,480 --> 00:25:01,120
we can see that empire has uh

651
00:25:01,120 --> 00:25:04,159
mostly http listeners so

652
00:25:04,159 --> 00:25:07,120
we we know the the c2 will be over uh

653
00:25:07,120 --> 00:25:11,760
http and https you set the uh delay and

654
00:25:11,760 --> 00:25:14,480
jitter which is how often that uh

655
00:25:14,480 --> 00:25:16,320
endpoints gonna call out

656
00:25:16,320 --> 00:25:19,360
and then you have to create a payload

657
00:25:19,360 --> 00:25:22,240
what they call a stager um so the net

658
00:25:22,240 --> 00:25:24,320
new here is the ability of creating this

659
00:25:24,320 --> 00:25:27,440
c sharp stager it's just the code used

660
00:25:27,440 --> 00:25:30,880
to compile that payload and get it to

661
00:25:30,880 --> 00:25:34,799
execute on a windows system um as we see

662
00:25:34,799 --> 00:25:36,159
this just like powershell when

663
00:25:36,159 --> 00:25:38,559
powershell was starting to be used the

664
00:25:38,559 --> 00:25:39,679
infamous

665
00:25:39,679 --> 00:25:42,880
derby contact or def con talk by dave

666
00:25:42,880 --> 00:25:44,159
kennedy

667
00:25:44,159 --> 00:25:46,480
there was no detections right and even

668
00:25:46,480 --> 00:25:49,760
today powershell is tough to catch but

669
00:25:49,760 --> 00:25:52,240
essentially what what we're seeing is

670
00:25:52,240 --> 00:25:55,520
the move to c sharp because of that same

671
00:25:55,520 --> 00:25:57,760
thing right it's able to execute a lot

672
00:25:57,760 --> 00:26:00,279
of antivirus and anti-malware and

673
00:26:00,279 --> 00:26:03,200
anti-exploit solutions aren't catching a

674
00:26:03,200 --> 00:26:05,760
lot of c-sharp code so that's really the

675
00:26:05,760 --> 00:26:08,880
the biggest uh net new here in this case

676
00:26:08,880 --> 00:26:11,120
if you haven't tested or used empire by

677
00:26:11,120 --> 00:26:12,480
all means

678
00:26:12,480 --> 00:26:14,720
check them out um they're free there's a

679
00:26:14,720 --> 00:26:17,679
whole bunch of c2s out there um and

680
00:26:17,679 --> 00:26:19,840
understand how these work right um a lot

681
00:26:19,840 --> 00:26:21,840
of these are are open source they're

682
00:26:21,840 --> 00:26:24,960
used by um red teamers and adversaries

683
00:26:24,960 --> 00:26:27,760
alike and the ability to understand and

684
00:26:27,760 --> 00:26:31,039
be able to see how those stagers execute

685
00:26:31,039 --> 00:26:33,200
on the target system connect to the c2

686
00:26:33,200 --> 00:26:35,279
server and

687
00:26:35,279 --> 00:26:36,799
look at it is

688
00:26:36,799 --> 00:26:39,440
is going to be important uh so

689
00:26:39,440 --> 00:26:41,600
definitely more of a

690
00:26:41,600 --> 00:26:43,200
red team uh

691
00:26:43,200 --> 00:26:46,880
cti report uh not much talk on detection

692
00:26:46,880 --> 00:26:49,200
or anything like that so back over to

693
00:26:49,200 --> 00:26:52,000
you so the reason why i included this

694
00:26:52,000 --> 00:26:55,120
one is because powershell empire empire

695
00:26:55,120 --> 00:26:58,400
as jorge said it's really popular uh

696
00:26:58,400 --> 00:27:00,960
with the threat actors and

697
00:27:00,960 --> 00:27:03,120
so uh before the new release of

698
00:27:03,120 --> 00:27:05,440
powershell empire there was a paper

699
00:27:05,440 --> 00:27:07,679
called disrupting the empire

700
00:27:07,679 --> 00:27:10,159
identifying powershell empire c2

701
00:27:10,159 --> 00:27:13,600
activity and it's a sans white paper

702
00:27:13,600 --> 00:27:15,840
that's available on the sans website

703
00:27:15,840 --> 00:27:18,640
under their resources and paper section

704
00:27:18,640 --> 00:27:21,200
just fyi and so in it they talk about

705
00:27:21,200 --> 00:27:23,679
http request behavior

706
00:27:23,679 --> 00:27:26,559
they talk about uh anomalous uris and a

707
00:27:26,559 --> 00:27:28,640
bunch of other network-based indicators

708
00:27:28,640 --> 00:27:30,240
to be able to

709
00:27:30,240 --> 00:27:33,360
detect powershell empire and so there's

710
00:27:33,360 --> 00:27:35,360
even whole githubs with like uh

711
00:27:35,360 --> 00:27:37,919
detection rules that are uh for those

712
00:27:37,919 --> 00:27:40,960
specific configurations of empire so now

713
00:27:40,960 --> 00:27:43,200
that they released a new version

714
00:27:43,200 --> 00:27:45,600
uh you know i wanted to highlight this

715
00:27:45,600 --> 00:27:47,520
report to bring attention that we need

716
00:27:47,520 --> 00:27:49,360
some defenders to come in here and be

717
00:27:49,360 --> 00:27:50,159
like

718
00:27:50,159 --> 00:27:52,399
to do another sans white paper on this

719
00:27:52,399 --> 00:27:53,200
new

720
00:27:53,200 --> 00:27:55,760
edition of powershell empire and to

721
00:27:55,760 --> 00:27:58,720
perform security research and to

722
00:27:58,720 --> 00:28:00,720
try to find a way to

723
00:28:00,720 --> 00:28:03,039
find those unique tool marks

724
00:28:03,039 --> 00:28:05,360
um i believe key dot

725
00:28:05,360 --> 00:28:08,240
89 let me let me get his proper twitter

726
00:28:08,240 --> 00:28:10,159
handle so i don't uh

727
00:28:10,159 --> 00:28:12,080
misquote here

728
00:28:12,080 --> 00:28:14,639
stand by

729
00:28:15,440 --> 00:28:16,600
key um

730
00:28:17,919 --> 00:28:20,480
89

731
00:28:20,480 --> 00:28:22,159
uh

732
00:28:22,159 --> 00:28:24,320
he changed his name so i'll have to look

733
00:28:24,320 --> 00:28:26,559
it up later anyways i'll put it in the

734
00:28:26,559 --> 00:28:28,960
chat and i'll put it in the github but

735
00:28:28,960 --> 00:28:31,279
he's a big proponent of something called

736
00:28:31,279 --> 00:28:32,720
tool marks

737
00:28:32,720 --> 00:28:36,159
so um trying to detect the custom out of

738
00:28:36,159 --> 00:28:39,120
the box and i'm horribly paraphrasing it

739
00:28:39,120 --> 00:28:41,360
but detecting custom out of the box

740
00:28:41,360 --> 00:28:43,440
features of like you know cobalt strike

741
00:28:43,440 --> 00:28:45,840
or powershell empire or a lot of the

742
00:28:45,840 --> 00:28:47,600
other really popular tools that

743
00:28:47,600 --> 00:28:50,080
ransomware actors and cyber criminals

744
00:28:50,080 --> 00:28:52,960
and all of that use um and they just use

745
00:28:52,960 --> 00:28:54,640
it straight out the box and they don't

746
00:28:54,640 --> 00:28:57,520
try to reconfigure stuff sometimes so

747
00:28:57,520 --> 00:29:00,000
like taking that low hanging fruit

748
00:29:00,000 --> 00:29:01,760
essentially building detections around

749
00:29:01,760 --> 00:29:04,080
it of course it's easy whatever but

750
00:29:04,080 --> 00:29:05,760
getting it out of the way so that at

751
00:29:05,760 --> 00:29:07,760
least you have that as an alert in the

752
00:29:07,760 --> 00:29:09,600
event they decide not to modify any of

753
00:29:09,600 --> 00:29:12,000
the settings so i wanted to bring that

754
00:29:12,000 --> 00:29:14,720
to people's attention does anyone else

755
00:29:14,720 --> 00:29:16,640
want to comment on this particular

756
00:29:16,640 --> 00:29:19,200
report oh danny yes and then in the

757
00:29:19,200 --> 00:29:20,799
meantime i'll look up what he changed

758
00:29:20,799 --> 00:29:23,679
his name to on twitter

759
00:29:23,679 --> 00:29:24,720
so

760
00:29:24,720 --> 00:29:27,600
with this one it's definitely looking

761
00:29:27,600 --> 00:29:30,080
for network-based

762
00:29:30,080 --> 00:29:32,559
indicators at this point

763
00:29:32,559 --> 00:29:33,919
so some of the signatures that we've

764
00:29:33,919 --> 00:29:38,720
i've seen before was going to news.php

765
00:29:38,720 --> 00:29:41,360
now whether is that change or not for

766
00:29:41,360 --> 00:29:43,200
this one

767
00:29:43,200 --> 00:29:45,120
i would have to start looking for

768
00:29:45,120 --> 00:29:47,200
indicators that is

769
00:29:47,200 --> 00:29:48,880
by netflow

770
00:29:48,880 --> 00:29:50,559
or

771
00:29:50,559 --> 00:29:52,480
any of the themes that's letting me know

772
00:29:52,480 --> 00:29:55,760
that there's rapid connections going on

773
00:29:55,760 --> 00:29:56,480
to

774
00:29:56,480 --> 00:30:00,399
a certain ip or domain

775
00:30:00,799 --> 00:30:02,640
and really quick i did find the person's

776
00:30:02,640 --> 00:30:05,200
name i just spelled it wrong i apologize

777
00:30:05,200 --> 00:30:06,960
it is

778
00:30:06,960 --> 00:30:08,159
t k-e-y-d-e-t-89

779
00:30:08,159 --> 00:30:11,039
harlan carvey he is an author of books

780
00:30:11,039 --> 00:30:13,600
and super smart and he talks about tool

781
00:30:13,600 --> 00:30:15,760
marks and he's a d4 professional sorry

782
00:30:15,760 --> 00:30:17,360
for interrupting thank you dan no no

783
00:30:17,360 --> 00:30:18,399
worries

784
00:30:18,399 --> 00:30:20,880
and then from there i can pivot to the

785
00:30:20,880 --> 00:30:24,720
host that is emitting um that connection

786
00:30:24,720 --> 00:30:26,960
and try to find any other indicators

787
00:30:26,960 --> 00:30:28,240
from there

788
00:30:28,240 --> 00:30:31,039
that may be agnostic of

789
00:30:31,039 --> 00:30:34,000
the c2 but for now with this one

790
00:30:34,000 --> 00:30:35,200
especially

791
00:30:35,200 --> 00:30:37,360
with the update i'm gonna have to rely

792
00:30:37,360 --> 00:30:39,760
on network indicators

793
00:30:39,760 --> 00:30:41,039
that uh

794
00:30:41,039 --> 00:30:41,919
that

795
00:30:41,919 --> 00:30:44,960
indicators are beaconing

796
00:30:45,360 --> 00:30:48,240
okay anyone else so i'll quickly say so

797
00:30:48,240 --> 00:30:50,240
the you know tool marks uh there's

798
00:30:50,240 --> 00:30:51,440
there's a lovely tool out there for

799
00:30:51,440 --> 00:30:54,320
cobalt strike called jarm j-a-r-m

800
00:30:54,320 --> 00:30:56,240
um if you think you're being targeted by

801
00:30:56,240 --> 00:30:58,960
a cobalt strike uh tool server

802
00:30:58,960 --> 00:31:01,039
you can turn around and use jarm to scan

803
00:31:01,039 --> 00:31:02,799
the endpoint and it will literally see

804
00:31:02,799 --> 00:31:05,039
if it can find like the proper files

805
00:31:05,039 --> 00:31:06,799
that you usually cobalt strike use

806
00:31:06,799 --> 00:31:09,440
running so tool marking be a real valid

807
00:31:09,440 --> 00:31:11,279
way to detect these things because again

808
00:31:11,279 --> 00:31:12,960
empire when it boots up there are

809
00:31:12,960 --> 00:31:15,360
certain ports that need to be open when

810
00:31:15,360 --> 00:31:18,880
you are executing from a external source

811
00:31:18,880 --> 00:31:21,120
and um as uh

812
00:31:21,120 --> 00:31:24,000
georgia said that uh there's uh a lot of

813
00:31:24,000 --> 00:31:26,080
uh a lot of these things the reason that

814
00:31:26,080 --> 00:31:26,960
they

815
00:31:26,960 --> 00:31:28,799
became popular was because the power

816
00:31:28,799 --> 00:31:29,919
shell and then when people said

817
00:31:29,919 --> 00:31:32,480
powershell was dead people were like not

818
00:31:32,480 --> 00:31:34,240
really but sort of and then so they were

819
00:31:34,240 --> 00:31:36,240
like but here's the c sharp thing that

820
00:31:36,240 --> 00:31:37,200
you know you've been worried about

821
00:31:37,200 --> 00:31:38,799
powershell so long

822
00:31:38,799 --> 00:31:40,399
you've missed this entire construct

823
00:31:40,399 --> 00:31:43,679
that's been here all along um and then

824
00:31:43,679 --> 00:31:46,320
uh you know again using the c2 matrix

825
00:31:46,320 --> 00:31:47,519
this will tell you that this is one of

826
00:31:47,519 --> 00:31:49,440
the most popular ones and i love empire

827
00:31:49,440 --> 00:31:50,880
myself so

828
00:31:50,880 --> 00:31:52,080
thank you

829
00:31:52,080 --> 00:31:54,159
yeah i know it's a great it's a great

830
00:31:54,159 --> 00:31:55,840
tool um

831
00:31:55,840 --> 00:31:58,640
okay so are we good to move on to the

832
00:31:58,640 --> 00:32:00,480
next threat report and i have just real

833
00:32:00,480 --> 00:32:02,240
quick a couple host space indicators i

834
00:32:02,240 --> 00:32:03,679
came up with for that one that i'll slip

835
00:32:03,679 --> 00:32:06,480
in real quick so first of all uh csi.exe

836
00:32:06,480 --> 00:32:08,799
fsi.exe without any command line

837
00:32:08,799 --> 00:32:09,840
arguments that's going to be an

838
00:32:09,840 --> 00:32:12,480
indication of interactive session

839
00:32:12,480 --> 00:32:14,559
any sort of uh arguments being passed

840
00:32:14,559 --> 00:32:16,399
from those two executables renamed

841
00:32:16,399 --> 00:32:18,080
instances those binaries network

842
00:32:18,080 --> 00:32:20,080
connections from those binaries

843
00:32:20,080 --> 00:32:21,120
um

844
00:32:21,120 --> 00:32:22,320
you know file creations from those

845
00:32:22,320 --> 00:32:24,399
binaries and

846
00:32:24,399 --> 00:32:25,919
um you know that's

847
00:32:25,919 --> 00:32:27,120
you know in certain environments where

848
00:32:27,120 --> 00:32:28,960
people are heavily using crf that's

849
00:32:28,960 --> 00:32:30,799
obviously loud but you just have to go

850
00:32:30,799 --> 00:32:32,799
through and see if it's present and if

851
00:32:32,799 --> 00:32:34,240
and then you know white list what your

852
00:32:34,240 --> 00:32:35,919
developers or whatever is doing but

853
00:32:35,919 --> 00:32:37,279
other than that the average user is not

854
00:32:37,279 --> 00:32:38,960
going to be using either one of these so

855
00:32:38,960 --> 00:32:40,159
simply the the presence of those

856
00:32:40,159 --> 00:32:41,679
executables without any command line

857
00:32:41,679 --> 00:32:43,120
arguments right off the back should be

858
00:32:43,120 --> 00:32:44,720
indicator that someone is not on the

859
00:32:44,720 --> 00:32:47,120
host running that

860
00:32:47,120 --> 00:32:49,600
okay thank you so much

861
00:32:49,600 --> 00:32:50,799
are we good

862
00:32:50,799 --> 00:32:53,600
anyone else we're good oh okay

863
00:32:53,600 --> 00:32:57,840
i will move on and spin the wheel

864
00:32:59,440 --> 00:33:03,120
okay what's gonna land on

865
00:33:03,120 --> 00:33:05,840
d for report number one

866
00:33:05,840 --> 00:33:10,720
let's see what that one is and who

867
00:33:10,720 --> 00:33:13,120
iced idea and cobalt strike versus

868
00:33:13,120 --> 00:33:15,840
antivirus ooh

869
00:33:15,840 --> 00:33:18,320
let's see

870
00:33:18,320 --> 00:33:20,960
who wants to speak to that one who wants

871
00:33:20,960 --> 00:33:25,000
to start on that one

872
00:33:25,440 --> 00:33:27,679
any takers

873
00:33:27,679 --> 00:33:31,919
danny all right danny go for it

874
00:33:33,919 --> 00:33:35,679
let me get myself mentally prepared for

875
00:33:35,679 --> 00:33:38,720
this one yeah you have 15 seconds so

876
00:33:38,720 --> 00:33:40,799
yep thank you

877
00:33:40,799 --> 00:33:42,799
i can jump in on that one afterwards too

878
00:33:42,799 --> 00:33:43,840
okay

879
00:33:43,840 --> 00:33:44,840
i was just muted

880
00:33:44,840 --> 00:33:47,840
[Laughter]

881
00:33:47,840 --> 00:33:50,000
all

882
00:33:50,840 --> 00:33:53,840
right so based on what i was reading on

883
00:33:53,840 --> 00:33:56,559
this report this one that um this one is

884
00:33:56,559 --> 00:33:57,279
a

885
00:33:57,279 --> 00:33:59,679
resurgence of the use of ice

886
00:33:59,679 --> 00:34:01,440
ice id

887
00:34:01,440 --> 00:34:04,559
and some big interesting key points is

888
00:34:04,559 --> 00:34:06,880
the use of not only the cobalt strike

889
00:34:06,880 --> 00:34:09,840
but wmi

890
00:34:10,639 --> 00:34:13,359
and from what i've seen they were trying

891
00:34:13,359 --> 00:34:16,480
to use the it start to start off with

892
00:34:16,480 --> 00:34:18,079
the

893
00:34:18,079 --> 00:34:21,199
with the word of spear phishing word doc

894
00:34:21,199 --> 00:34:24,480
which will release an hta file and

895
00:34:24,480 --> 00:34:27,119
includes a jpeg

896
00:34:27,119 --> 00:34:28,399
that

897
00:34:28,399 --> 00:34:31,440
is actually a library

898
00:34:31,440 --> 00:34:34,560
that's supposed to be executed by run

899
00:34:34,560 --> 00:34:35,918
deal

900
00:34:35,918 --> 00:34:39,040
32 or reg

901
00:34:39,040 --> 00:34:41,040
serve 32

902
00:34:41,040 --> 00:34:43,440
and then it tries to do it tries to do

903
00:34:43,440 --> 00:34:45,440
the host discovery

904
00:34:45,440 --> 00:34:50,399
as well as encoder powershell payloads

905
00:34:50,879 --> 00:34:52,239
for mo

906
00:34:52,239 --> 00:34:55,119
what i like about this default report is

907
00:34:55,119 --> 00:34:57,440
the fact that it goes through the

908
00:34:57,440 --> 00:35:00,160
various stages of how it operates its

909
00:35:00,160 --> 00:35:03,760
credential accesses it's

910
00:35:03,760 --> 00:35:06,160
how it tries to do a host discovery in

911
00:35:06,160 --> 00:35:09,599
the actual manipulation of

912
00:35:09,599 --> 00:35:11,920
wmic

913
00:35:11,920 --> 00:35:15,359
other processes and it also shows that

914
00:35:15,359 --> 00:35:16,640
the

915
00:35:16,640 --> 00:35:19,040
antivirus that's already installed can

916
00:35:19,040 --> 00:35:22,720
detect some of those anomalies

917
00:35:22,720 --> 00:35:25,030
but it's also a good to know of

918
00:35:25,030 --> 00:35:26,480
[Music]

919
00:35:26,480 --> 00:35:30,320
what wmic's that should not be coming

920
00:35:30,320 --> 00:35:32,720
consecutively

921
00:35:32,720 --> 00:35:34,320
in the environment

922
00:35:34,320 --> 00:35:36,480
especially when it's trying to do

923
00:35:36,480 --> 00:35:38,320
a view in the domain

924
00:35:38,320 --> 00:35:41,599
uh trust domain admins and

925
00:35:41,599 --> 00:35:42,800
trying to find

926
00:35:42,800 --> 00:35:45,839
your domain list

927
00:35:49,920 --> 00:35:53,440
and just see some um visible monolateral

928
00:35:53,440 --> 00:35:55,839
movement some other

929
00:35:55,839 --> 00:35:58,880
key takeaways with this one that i do

930
00:35:58,880 --> 00:35:59,760
like

931
00:35:59,760 --> 00:36:02,480
is for me as

932
00:36:02,480 --> 00:36:06,480
a sock analyst not only am i looking for

933
00:36:06,480 --> 00:36:11,119
any strange wmic activities

934
00:36:11,119 --> 00:36:15,119
but processes ran by services or

935
00:36:15,119 --> 00:36:18,160
certain power shell

936
00:36:18,640 --> 00:36:20,079
activities

937
00:36:20,079 --> 00:36:21,520
especially when

938
00:36:21,520 --> 00:36:25,520
i ex is used which is trying to execute

939
00:36:25,520 --> 00:36:27,839
something

940
00:36:28,240 --> 00:36:29,920
no that's crazy

941
00:36:29,920 --> 00:36:31,680
um are you are you good danny are you

942
00:36:31,680 --> 00:36:32,880
ready chris

943
00:36:32,880 --> 00:36:34,960
christie yeah okay so and i have a

944
00:36:34,960 --> 00:36:37,119
little bit of comment too uh and then

945
00:36:37,119 --> 00:36:39,280
well it looks like

946
00:36:39,280 --> 00:36:41,680
yeah so uh you know danny mentioned

947
00:36:41,680 --> 00:36:42,720
pretty much a lot of stuff i'm gonna

948
00:36:42,720 --> 00:36:44,240
cover i'm just gonna kind of get a

949
00:36:44,240 --> 00:36:45,680
little specific on a couple of them so

950
00:36:45,680 --> 00:36:47,680
right off the bat uh if you see me me

951
00:36:47,680 --> 00:36:50,320
cat's bad so anytime that pops up

952
00:36:50,320 --> 00:36:51,520
you should have some sort of learning

953
00:36:51,520 --> 00:36:54,240
for that uh second jpeg making any sort

954
00:36:54,240 --> 00:36:56,480
of uh process command line arguments

955
00:36:56,480 --> 00:36:57,920
that should be some sort of indicator

956
00:36:57,920 --> 00:36:59,440
there there's no reason why jpeg ever

957
00:36:59,440 --> 00:37:00,640
needs to

958
00:37:00,640 --> 00:37:02,880
do call for system info ipconfig

959
00:37:02,880 --> 00:37:05,359
anything like that so um although you

960
00:37:05,359 --> 00:37:07,200
know it would be hard to basically do

961
00:37:07,200 --> 00:37:08,560
every single file type that does that

962
00:37:08,560 --> 00:37:10,400
they may not use jpeg they may kind of

963
00:37:10,400 --> 00:37:12,160
pivot you should probably figure out you

964
00:37:12,160 --> 00:37:12,960
know

965
00:37:12,960 --> 00:37:14,560
what what file types you can include in

966
00:37:14,560 --> 00:37:17,359
some sort of list to do an su recon next

967
00:37:17,359 --> 00:37:19,599
the adf continued intel and scanning

968
00:37:19,599 --> 00:37:20,480
piece

969
00:37:20,480 --> 00:37:21,200
so

970
00:37:21,200 --> 00:37:23,119
calling the adf.bat to do again more

971
00:37:23,119 --> 00:37:24,880
system gathering information that's not

972
00:37:24,880 --> 00:37:26,160
something that any user does it's not

973
00:37:26,160 --> 00:37:27,119
something your assist admins are going

974
00:37:27,119 --> 00:37:28,720
to do they've got tools to gather

975
00:37:28,720 --> 00:37:30,079
information they've got all sorts of

976
00:37:30,079 --> 00:37:31,040
other things that you're never going to

977
00:37:31,040 --> 00:37:32,960
sit in there and gather it that way so

978
00:37:32,960 --> 00:37:35,599
if adf dot bad is calling any sort of

979
00:37:35,599 --> 00:37:37,040
process and command line that's

980
00:37:37,040 --> 00:37:38,240
information gathering that should be

981
00:37:38,240 --> 00:37:39,760
some sort of ioc

982
00:37:39,760 --> 00:37:41,680
uh last thing uh lateral movement

983
00:37:41,680 --> 00:37:44,079
registry value set we're using encoded

984
00:37:44,079 --> 00:37:45,359
powershell

985
00:37:45,359 --> 00:37:46,640
there's never a time where you're gonna

986
00:37:46,640 --> 00:37:48,560
have any users that need to hop to

987
00:37:48,560 --> 00:37:51,200
another device using registry value set

988
00:37:51,200 --> 00:37:53,520
and with imported encoded powershell go

989
00:37:53,520 --> 00:37:54,880
to powershell as we know you're going to

990
00:37:54,880 --> 00:37:56,079
use that if there's some sort of escape

991
00:37:56,079 --> 00:37:57,119
character in there or something that

992
00:37:57,119 --> 00:37:58,800
will make the code not run there's

993
00:37:58,800 --> 00:38:00,400
nothing that you would need as a normal

994
00:38:00,400 --> 00:38:02,480
host or a normal user that can pivot to

995
00:38:02,480 --> 00:38:04,079
another host legally in an environment

996
00:38:04,079 --> 00:38:05,200
there's never an argument you'd have to

997
00:38:05,200 --> 00:38:06,880
run that would require you to use

998
00:38:06,880 --> 00:38:08,640
encoded power shell except for some

999
00:38:08,640 --> 00:38:10,560
really rare edge cases in which case

1000
00:38:10,560 --> 00:38:11,440
there's probably some sort of change

1001
00:38:11,440 --> 00:38:13,200
window

1002
00:38:13,200 --> 00:38:14,880
no that's great unless you're in some

1003
00:38:14,880 --> 00:38:16,640
environments where the where the people

1004
00:38:16,640 --> 00:38:18,240
like to use encoded commands all the

1005
00:38:18,240 --> 00:38:20,480
time oh i know people just like doing it

1006
00:38:20,480 --> 00:38:24,079
for for for you know walls yeah

1007
00:38:24,079 --> 00:38:25,440
but like you know sentinel one all these

1008
00:38:25,440 --> 00:38:26,880
tools now they'll they'll decode it for

1009
00:38:26,880 --> 00:38:28,800
you they'll check through it you can you

1010
00:38:28,800 --> 00:38:30,240
can still dig into it but yeah you're

1011
00:38:30,240 --> 00:38:31,440
right people use it when they don't even

1012
00:38:31,440 --> 00:38:32,400
need to

1013
00:38:32,400 --> 00:38:34,800
yes and will did you want to comment on

1014
00:38:34,800 --> 00:38:36,720
this one

1015
00:38:36,720 --> 00:38:38,160
did i get uh

1016
00:38:38,160 --> 00:38:40,800
right okay yeah so um

1017
00:38:40,800 --> 00:38:43,520
this another another blog piece on iced

1018
00:38:43,520 --> 00:38:46,960
id uh attacks and as we know it's it's

1019
00:38:46,960 --> 00:38:49,119
associated with ransomware but

1020
00:38:49,119 --> 00:38:50,800
it's it's another

1021
00:38:50,800 --> 00:38:53,920
important piece because um i study so in

1022
00:38:53,920 --> 00:38:56,480
this specific one the iso d variant is

1023
00:38:56,480 --> 00:38:58,400
using a loader called

1024
00:38:58,400 --> 00:39:00,640
what the researchers dub photo loader so

1025
00:39:00,640 --> 00:39:03,599
it uses a jpeg file to to sort of deploy

1026
00:39:03,599 --> 00:39:05,200
a hidden payload

1027
00:39:05,200 --> 00:39:07,040
um

1028
00:39:07,040 --> 00:39:09,520
strategically like following ice id and

1029
00:39:09,520 --> 00:39:12,160
the overall campaign that so it's been

1030
00:39:12,160 --> 00:39:14,240
it began as a banking trojan and turned

1031
00:39:14,240 --> 00:39:16,560
into an access broker but more recently

1032
00:39:16,560 --> 00:39:18,880
in like the last maybe six to nine

1033
00:39:18,880 --> 00:39:21,040
months it has been pushed by a spam

1034
00:39:21,040 --> 00:39:23,760
botnet called the shatak botnet linked

1035
00:39:23,760 --> 00:39:27,200
to a threat actor called ta 551 and it's

1036
00:39:27,200 --> 00:39:29,119
distributed a range of payloads but more

1037
00:39:29,119 --> 00:39:31,280
recently it's it's iced id has been it's

1038
00:39:31,280 --> 00:39:34,320
primarily primary payload so

1039
00:39:34,320 --> 00:39:35,599
it's

1040
00:39:35,599 --> 00:39:36,880
it's another

1041
00:39:36,880 --> 00:39:39,760
example of what to expect if your if one

1042
00:39:39,760 --> 00:39:40,960
of your endpoints is infected with

1043
00:39:40,960 --> 00:39:43,680
device id but i mean the the main point

1044
00:39:43,680 --> 00:39:45,920
that an analyst should be bringing home

1045
00:39:45,920 --> 00:39:47,839
if they decide to write this report up

1046
00:39:47,839 --> 00:39:49,599
and you know document it as an instant

1047
00:39:49,599 --> 00:39:50,880
report they should be

1048
00:39:50,880 --> 00:39:53,040
sort of explaining why ice id is an

1049
00:39:53,040 --> 00:39:55,200
important threat and it's it's basically

1050
00:39:55,200 --> 00:39:57,680
taking over from emo tech the emote

1051
00:39:57,680 --> 00:40:00,079
botnet that got shut down in january by

1052
00:40:00,079 --> 00:40:02,480
the uh europol and ukrainian police and

1053
00:40:02,480 --> 00:40:05,280
things it's there's been a vacuum and

1054
00:40:05,280 --> 00:40:07,599
iced id and quackport have basically

1055
00:40:07,599 --> 00:40:09,760
taken over and pushed in parallel

1056
00:40:09,760 --> 00:40:11,839
campaigns between them

1057
00:40:11,839 --> 00:40:14,720
so it's and then you know cobalt strike

1058
00:40:14,720 --> 00:40:16,480
that's what we normally see with with a

1059
00:40:16,480 --> 00:40:18,640
lot of these malware families so it's

1060
00:40:18,640 --> 00:40:21,440
the two two sort of staple

1061
00:40:21,440 --> 00:40:24,079
threats to be aware or be around be

1062
00:40:24,079 --> 00:40:26,000
aware of and

1063
00:40:26,000 --> 00:40:28,560
as as the guys have explained some

1064
00:40:28,560 --> 00:40:30,079
good detection rules that you should be

1065
00:40:30,079 --> 00:40:33,520
using to alert on

1066
00:40:33,520 --> 00:40:36,079
okay great thanks well and the little

1067
00:40:36,079 --> 00:40:38,560
comment that i wanted to add and we'll

1068
00:40:38,560 --> 00:40:40,720
hop on over to the stakeholders uh

1069
00:40:40,720 --> 00:40:41,839
really quick

1070
00:40:41,839 --> 00:40:44,240
is from a hunt perspective i saw the

1071
00:40:44,240 --> 00:40:47,359
discovery and i saw wmic ipconfig system

1072
00:40:47,359 --> 00:40:50,480
info net nl test net

1073
00:40:50,480 --> 00:40:53,760
um and a bunch of other uh

1074
00:40:53,760 --> 00:40:56,079
other related uh processes that would

1075
00:40:56,079 --> 00:40:58,480
need to execute within a short amount of

1076
00:40:58,480 --> 00:40:59,359
time

1077
00:40:59,359 --> 00:41:02,079
and so if you're performing a hunt for

1078
00:41:02,079 --> 00:41:04,640
this type of thing instead of making it

1079
00:41:04,640 --> 00:41:06,800
per se specific about command line

1080
00:41:06,800 --> 00:41:07,920
arguments

1081
00:41:07,920 --> 00:41:10,720
uh grouping the processes you know of

1082
00:41:10,720 --> 00:41:12,720
like all of these all of these within

1083
00:41:12,720 --> 00:41:14,640
this particular report that are used and

1084
00:41:14,640 --> 00:41:16,480
then you time bound it

1085
00:41:16,480 --> 00:41:19,040
by like you know 24 hours or even an

1086
00:41:19,040 --> 00:41:21,200
hour or whatever right because they move

1087
00:41:21,200 --> 00:41:22,400
very quick

1088
00:41:22,400 --> 00:41:24,000
and so um

1089
00:41:24,000 --> 00:41:26,640
i believe if you do that it'll cut down

1090
00:41:26,640 --> 00:41:28,240
on false positives within your

1091
00:41:28,240 --> 00:41:30,640
organization of you know the random

1092
00:41:30,640 --> 00:41:34,400
person just doing uh

1093
00:41:34,480 --> 00:41:36,000
because you don't want to alert on that

1094
00:41:36,000 --> 00:41:38,800
because that'll that'll create a lot of

1095
00:41:38,800 --> 00:41:40,720
traffic a lot of alerts to look through

1096
00:41:40,720 --> 00:41:41,520
so

1097
00:41:41,520 --> 00:41:44,640
aggregating the whole report as a whole

1098
00:41:44,640 --> 00:41:47,040
and then creating a hunt around that

1099
00:41:47,040 --> 00:41:48,880
specifically and then

1100
00:41:48,880 --> 00:41:51,119
investigating any potential anomalous

1101
00:41:51,119 --> 00:41:53,680
activity of any uh matching results if

1102
00:41:53,680 --> 00:41:55,200
you do have any

1103
00:41:55,200 --> 00:41:56,000
which

1104
00:41:56,000 --> 00:41:58,720
i'm hoping you don't

1105
00:41:58,720 --> 00:42:02,279
that was my contribution

1106
00:42:03,280 --> 00:42:06,160
anyone else want to say anything

1107
00:42:06,160 --> 00:42:08,720
i'll uh as a stakeholder i'll say uh you

1108
00:42:08,720 --> 00:42:11,680
know again another uh from from my cti

1109
00:42:11,680 --> 00:42:13,359
panel if you guys were feeding me this

1110
00:42:13,359 --> 00:42:16,400
information again um as a red teamer i

1111
00:42:16,400 --> 00:42:19,200
can definitely help you recreate

1112
00:42:19,200 --> 00:42:21,520
the actual ioc's actual detections with

1113
00:42:21,520 --> 00:42:23,200
our tools

1114
00:42:23,200 --> 00:42:25,200
the the dfir report and what you guys

1115
00:42:25,200 --> 00:42:27,359
have explained is again one of the like

1116
00:42:27,359 --> 00:42:29,599
uh the the level of detail they go into

1117
00:42:29,599 --> 00:42:31,520
that then comes to you guys that can

1118
00:42:31,520 --> 00:42:33,280
then come to me

1119
00:42:33,280 --> 00:42:34,880
and then i can take to the operations

1120
00:42:34,880 --> 00:42:39,280
team is just phenomenal but uh the the

1121
00:42:39,280 --> 00:42:41,520
the tooling here again being things that

1122
00:42:41,520 --> 00:42:45,200
are free simple easy to use um

1123
00:42:45,200 --> 00:42:47,760
and and but good news is it's highly

1124
00:42:47,760 --> 00:42:49,200
detailed so we can write the right

1125
00:42:49,200 --> 00:42:51,599
detections and build the right tooling

1126
00:42:51,599 --> 00:42:53,520
to emulate it

1127
00:42:53,520 --> 00:42:56,560
okay thank you and uh i want to throw a

1128
00:42:56,560 --> 00:42:59,520
little bit of a mix in and have karan

1129
00:42:59,520 --> 00:43:02,400
speak about our mystery threat report

1130
00:43:02,400 --> 00:43:04,000
that we picked

1131
00:43:04,000 --> 00:43:06,960
um so karan's gonna have three minutes

1132
00:43:06,960 --> 00:43:09,760
to speak to this mystery threat report

1133
00:43:09,760 --> 00:43:12,400
and then we're gonna close on out with

1134
00:43:12,400 --> 00:43:16,000
jorge and the rest of us commenting on a

1135
00:43:16,000 --> 00:43:18,640
scythe threat thursday

1136
00:43:18,640 --> 00:43:21,920
because a i love it and b i warned y'all

1137
00:43:21,920 --> 00:43:25,839
that i'm a huge fan of jorge

1138
00:43:25,839 --> 00:43:27,200
okay so

1139
00:43:27,200 --> 00:43:30,319
karan has the floor and you have three

1140
00:43:30,319 --> 00:43:32,160
minutes

1141
00:43:32,160 --> 00:43:33,760
okay um

1142
00:43:33,760 --> 00:43:36,800
okay so this report mystery report is

1143
00:43:36,800 --> 00:43:40,480
basically for the recent uh bazaar

1144
00:43:40,480 --> 00:43:43,119
bazaar backdoor campaign

1145
00:43:43,119 --> 00:43:44,640
bazaar call

1146
00:43:44,640 --> 00:43:47,599
it's the report in in terms of you know

1147
00:43:47,599 --> 00:43:49,680
how it's reporting is done it's it's

1148
00:43:49,680 --> 00:43:50,880
very good

1149
00:43:50,880 --> 00:43:54,000
but i feel that it's not very accessible

1150
00:43:54,000 --> 00:43:56,720
because some stakeholders for example

1151
00:43:56,720 --> 00:43:59,040
uh dfir they would like quick access to

1152
00:43:59,040 --> 00:44:00,880
the ttps they would like quick access to

1153
00:44:00,880 --> 00:44:02,960
the iocs uh

1154
00:44:02,960 --> 00:44:07,520
the ttps and iocs uh it's generally

1155
00:44:07,520 --> 00:44:10,160
like you need to siphon off by reading

1156
00:44:10,160 --> 00:44:12,640
there's a lot of reading involved so

1157
00:44:12,640 --> 00:44:14,960
but the the good thing about it like

1158
00:44:14,960 --> 00:44:16,640
this has good content this has good

1159
00:44:16,640 --> 00:44:19,119
screenshots diagrams explaining the

1160
00:44:19,119 --> 00:44:21,839
attack chain screenshots about the email

1161
00:44:21,839 --> 00:44:22,880
even the

1162
00:44:22,880 --> 00:44:25,200
uh you could say the the unique uh

1163
00:44:25,200 --> 00:44:28,079
unique ids that the attackers use to

1164
00:44:28,079 --> 00:44:30,240
identify all of the victims

1165
00:44:30,240 --> 00:44:32,560
uh and uh another good point about this

1166
00:44:32,560 --> 00:44:34,480
are there there are hunting rules where

1167
00:44:34,480 --> 00:44:36,400
which which can be used with microsoft

1168
00:44:36,400 --> 00:44:39,680
365 defender it's pretty good

1169
00:44:39,680 --> 00:44:41,599
the only disadvantage as i said before

1170
00:44:41,599 --> 00:44:43,920
is which heavily relies on actually

1171
00:44:43,920 --> 00:44:46,400
reading the report and some stakeholders

1172
00:44:46,400 --> 00:44:48,640
might not like it

1173
00:44:48,640 --> 00:44:51,440
in terms of key takeaways this is

1174
00:44:51,440 --> 00:44:53,599
particularly very interesting because i

1175
00:44:53,599 --> 00:44:55,680
think microsoft has been

1176
00:44:55,680 --> 00:44:58,319
tracking this for around a month and

1177
00:44:58,319 --> 00:45:00,880
this is like one of the newer campaigns

1178
00:45:00,880 --> 00:45:03,200
so and due to it resulting into a

1179
00:45:03,200 --> 00:45:06,079
ransomware which is i i think it's kanti

1180
00:45:06,079 --> 00:45:08,480
or ryok uh it's definitely interesting

1181
00:45:08,480 --> 00:45:11,119
in that sense because bazaar loader is a

1182
00:45:11,119 --> 00:45:13,520
prolific mother and any updates on their

1183
00:45:13,520 --> 00:45:16,000
ttps their new campaigns is particularly

1184
00:45:16,000 --> 00:45:17,040
interesting

1185
00:45:17,040 --> 00:45:20,079
uh in terms of speaking about the

1186
00:45:20,079 --> 00:45:21,119
um

1187
00:45:21,119 --> 00:45:22,240
the

1188
00:45:22,240 --> 00:45:24,880
detection rules the detection rules uh

1189
00:45:24,880 --> 00:45:26,640
particularly provided by them are

1190
00:45:26,640 --> 00:45:29,040
extremely good because it provides

1191
00:45:29,040 --> 00:45:30,960
tracking for the uh you know hunting for

1192
00:45:30,960 --> 00:45:33,839
the emails it even includes uh hunting

1193
00:45:33,839 --> 00:45:35,440
for the exfiltration tool of the

1194
00:45:35,440 --> 00:45:37,680
ransomware which is i think our clone

1195
00:45:37,680 --> 00:45:38,720
yeah

1196
00:45:38,720 --> 00:45:41,839
and uh other than that there's very

1197
00:45:41,839 --> 00:45:43,440
particular interesting thing and i want

1198
00:45:43,440 --> 00:45:44,160
to

1199
00:45:44,160 --> 00:45:47,680
like focus on this is the use of social

1200
00:45:47,680 --> 00:45:50,400
engineering uh in in like this whole

1201
00:45:50,400 --> 00:45:52,880
campaign because the highlight of this

1202
00:45:52,880 --> 00:45:54,960
is they used the attackers the threat

1203
00:45:54,960 --> 00:45:56,720
actors used like a

1204
00:45:56,720 --> 00:46:00,720
fraudulent call center to in case uh the

1205
00:46:00,720 --> 00:46:03,920
victim decides to call uh that number

1206
00:46:03,920 --> 00:46:06,000
which is provided in the email that can

1207
00:46:06,000 --> 00:46:07,599
actually

1208
00:46:07,599 --> 00:46:09,280
lead to like a

1209
00:46:09,280 --> 00:46:11,599
person over the other call center and

1210
00:46:11,599 --> 00:46:14,400
social engineer the vic victim into

1211
00:46:14,400 --> 00:46:17,200
you know uh malicious execution link

1212
00:46:17,200 --> 00:46:19,200
attachment whatever it can cause more

1213
00:46:19,200 --> 00:46:20,319
harm

1214
00:46:20,319 --> 00:46:23,200
that is very interesting in my opinion

1215
00:46:23,200 --> 00:46:24,800
and

1216
00:46:24,800 --> 00:46:26,319
other than that nothing else for this

1217
00:46:26,319 --> 00:46:28,240
report it's a good report but i feel

1218
00:46:28,240 --> 00:46:29,680
like they they could have included the

1219
00:46:29,680 --> 00:46:32,079
tdps and the ics like a particular table

1220
00:46:32,079 --> 00:46:34,640
in the last to make it easier for people

1221
00:46:34,640 --> 00:46:36,640
who are researching it

1222
00:46:36,640 --> 00:46:38,560
okay and the comment that i would like

1223
00:46:38,560 --> 00:46:40,839
to add to this is

1224
00:46:40,839 --> 00:46:45,839
um unit 42 palo alto's unit 42 recently

1225
00:46:45,839 --> 00:46:49,520
came out with a report 729 2021 on

1226
00:46:49,520 --> 00:46:50,800
baseloader

1227
00:46:50,800 --> 00:46:53,200
and so in it they have like uh they have

1228
00:46:53,200 --> 00:46:54,640
a bitly link

1229
00:46:54,640 --> 00:46:57,200
that has a bunch of iocs and stuff like

1230
00:46:57,200 --> 00:46:59,520
that it may not necessarily be tied to

1231
00:46:59,520 --> 00:47:01,440
the basic call campaign

1232
00:47:01,440 --> 00:47:03,520
um you know i would need to perform

1233
00:47:03,520 --> 00:47:05,520
analysis to see the difference between

1234
00:47:05,520 --> 00:47:07,440
the microsoft report that was the

1235
00:47:07,440 --> 00:47:10,319
mystery report it was called uh

1236
00:47:10,319 --> 00:47:12,079
basically

1237
00:47:12,079 --> 00:47:13,760
let me go to the top of the report

1238
00:47:13,760 --> 00:47:16,000
basically phony call centers lead to

1239
00:47:16,000 --> 00:47:18,880
exfiltration and ransomware

1240
00:47:18,880 --> 00:47:21,119
so i would have to compare the basic

1241
00:47:21,119 --> 00:47:23,760
call report to the one that was produced

1242
00:47:23,760 --> 00:47:27,280
by palo alto with the iocs but the point

1243
00:47:27,280 --> 00:47:29,680
is that it both that both of them

1244
00:47:29,680 --> 00:47:31,760
involve baseloader

1245
00:47:31,760 --> 00:47:34,480
so um i would look at that and take a

1246
00:47:34,480 --> 00:47:37,520
look at those iocs as well as you know

1247
00:47:37,520 --> 00:47:40,160
that's bau activity but the whole point

1248
00:47:40,160 --> 00:47:42,240
of this is that if you get a report and

1249
00:47:42,240 --> 00:47:44,319
they don't have the ttps or iocs or

1250
00:47:44,319 --> 00:47:45,280
whatever

1251
00:47:45,280 --> 00:47:47,920
um pivoting on that and looking for

1252
00:47:47,920 --> 00:47:50,079
other organizations that may have done

1253
00:47:50,079 --> 00:47:52,400
reporting such as palo alto

1254
00:47:52,400 --> 00:47:55,680
unit 42 they do some awesome work too

1255
00:47:55,680 --> 00:47:57,599
and uh supplementing the reports that

1256
00:47:57,599 --> 00:47:59,119
come out for that

1257
00:47:59,119 --> 00:47:59,920
so

1258
00:47:59,920 --> 00:48:01,680
anyone else want to comment on that

1259
00:48:01,680 --> 00:48:04,480
before we move over to jorge

1260
00:48:04,480 --> 00:48:07,280
okay will and then danny

1261
00:48:07,280 --> 00:48:10,480
uh yeah so the bazzalota bizarre cool

1262
00:48:10,480 --> 00:48:12,800
campaign is uh is a really interesting

1263
00:48:12,800 --> 00:48:15,440
one to me um it's linked to the infamous

1264
00:48:15,440 --> 00:48:17,760
riok and conti gang which i think

1265
00:48:17,760 --> 00:48:20,720
crowdstrike tracks as wizard spider

1266
00:48:20,720 --> 00:48:22,880
this group is

1267
00:48:22,880 --> 00:48:25,200
very well known for using like a range

1268
00:48:25,200 --> 00:48:27,760
of delivery techniques that purposely

1269
00:48:27,760 --> 00:48:30,319
are designed to evade detection i wrote

1270
00:48:30,319 --> 00:48:31,440
a blog about all the different

1271
00:48:31,440 --> 00:48:33,599
techniques they use and our call is the

1272
00:48:33,599 --> 00:48:35,760
one that currently running and the thing

1273
00:48:35,760 --> 00:48:37,200
that makes it so interesting is there's

1274
00:48:37,200 --> 00:48:39,280
no malicious links inside the email

1275
00:48:39,280 --> 00:48:41,119
itself it's just the phone number that

1276
00:48:41,119 --> 00:48:43,599
you call and are guided to and then once

1277
00:48:43,599 --> 00:48:45,760
you reach the fake website that they've

1278
00:48:45,760 --> 00:48:48,160
created you have to enter a code to be

1279
00:48:48,160 --> 00:48:50,000
able to download like the spreadsheet

1280
00:48:50,000 --> 00:48:51,760
that they give you so there's so many

1281
00:48:51,760 --> 00:48:54,160
different ways to thwart researchers

1282
00:48:54,160 --> 00:48:56,000
like myself and

1283
00:48:56,000 --> 00:48:58,720
methods to evade detection it just makes

1284
00:48:58,720 --> 00:49:00,480
this gang a really

1285
00:49:00,480 --> 00:49:02,240
prolific threat and and one to

1286
00:49:02,240 --> 00:49:04,480
definitely you know actively hunt for

1287
00:49:04,480 --> 00:49:06,160
because there's a chance your tools

1288
00:49:06,160 --> 00:49:08,240
won't won't pick them up

1289
00:49:08,240 --> 00:49:10,079
thank you so much for stating that and

1290
00:49:10,079 --> 00:49:11,440
danny

1291
00:49:11,440 --> 00:49:14,319
okay so this one is a very interesting

1292
00:49:14,319 --> 00:49:16,240
one because this one actually involves

1293
00:49:16,240 --> 00:49:18,240
more than just going into

1294
00:49:18,240 --> 00:49:20,319
the network and trying to hunt this one

1295
00:49:20,319 --> 00:49:22,720
involves working with

1296
00:49:22,720 --> 00:49:27,119
your organization to put out a message

1297
00:49:27,119 --> 00:49:29,280
as far as dealing with um fake call

1298
00:49:29,280 --> 00:49:32,559
centers just a reminder to the in to the

1299
00:49:32,559 --> 00:49:36,000
cohort to the employees hey you are you

1300
00:49:36,000 --> 00:49:37,680
have a call center

1301
00:49:37,680 --> 00:49:39,599
in the organization

1302
00:49:39,599 --> 00:49:42,960
you this is an external email that's out

1303
00:49:42,960 --> 00:49:44,480
you're not using that

1304
00:49:44,480 --> 00:49:47,599
you're using this particular one and i

1305
00:49:47,599 --> 00:49:50,160
bring this up because there's been cases

1306
00:49:50,160 --> 00:49:52,400
where there's been

1307
00:49:52,400 --> 00:49:55,839
fake um calls acting as microsoft trying

1308
00:49:55,839 --> 00:49:59,920
to help with situation with uh computer

1309
00:49:59,920 --> 00:50:01,119
issues

1310
00:50:01,119 --> 00:50:03,440
by running commands there was a fake

1311
00:50:03,440 --> 00:50:05,520
call center

1312
00:50:05,520 --> 00:50:08,319
a little similar but not quite it was

1313
00:50:08,319 --> 00:50:10,559
involving running scripts which

1314
00:50:10,559 --> 00:50:14,400
inevitably effect infected the host

1315
00:50:14,400 --> 00:50:16,319
so this is where you want to leverage

1316
00:50:16,319 --> 00:50:18,319
your departments to help put out a

1317
00:50:18,319 --> 00:50:19,839
message

1318
00:50:19,839 --> 00:50:22,720
now from the forensic side i see a

1319
00:50:22,720 --> 00:50:24,640
couple of things of

1320
00:50:24,640 --> 00:50:28,000
say the use of cert util

1321
00:50:28,000 --> 00:50:31,119
depending up especially when cert utils

1322
00:50:31,119 --> 00:50:34,960
being used to do url cache to

1323
00:50:34,960 --> 00:50:37,119
grab things from

1324
00:50:37,119 --> 00:50:39,599
another location

1325
00:50:39,599 --> 00:50:42,880
do you want to watch out for

1326
00:50:43,200 --> 00:50:46,480
okay great and now we will take it over

1327
00:50:46,480 --> 00:50:49,200
to the final report uh just an

1328
00:50:49,200 --> 00:50:51,520
overarching discussion of

1329
00:50:51,520 --> 00:50:54,240
threat thursday um i had the wonderful

1330
00:50:54,240 --> 00:50:56,880
opportunity through independent research

1331
00:50:56,880 --> 00:50:58,559
to speak with some really awesome

1332
00:50:58,559 --> 00:51:01,400
professionals and they've actually

1333
00:51:01,400 --> 00:51:04,640
operationalized uh this threat thursday

1334
00:51:04,640 --> 00:51:06,480
where every thursday it comes out they

1335
00:51:06,480 --> 00:51:09,359
mobilize their team to like perform an

1336
00:51:09,359 --> 00:51:12,000
actual real purple team exercise related

1337
00:51:12,000 --> 00:51:12,880
to

1338
00:51:12,880 --> 00:51:14,800
this particular report that they put out

1339
00:51:14,800 --> 00:51:17,040
and we happen to have jorge with us

1340
00:51:17,040 --> 00:51:19,680
so i thought um it would be nice if he

1341
00:51:19,680 --> 00:51:22,480
could just speak to it really quick and

1342
00:51:22,480 --> 00:51:23,760
another

1343
00:51:23,760 --> 00:51:25,920
reason why i really really like this is

1344
00:51:25,920 --> 00:51:27,440
that they include

1345
00:51:27,440 --> 00:51:30,000
not only uh community uh based

1346
00:51:30,000 --> 00:51:32,960
information uh sourced information but

1347
00:51:32,960 --> 00:51:35,599
they also have like a detect and respond

1348
00:51:35,599 --> 00:51:38,400
section as well which i feel is

1349
00:51:38,400 --> 00:51:41,440
exceedingly exceedingly important so

1350
00:51:41,440 --> 00:51:43,680
thank you very much jorge take us take

1351
00:51:43,680 --> 00:51:47,200
us out oh yeah no just real quick um

1352
00:51:47,200 --> 00:51:49,599
so this was something that i started

1353
00:51:49,599 --> 00:51:51,359
early when i joined scythe i've been

1354
00:51:51,359 --> 00:51:53,520
there for about a year um essentially

1355
00:51:53,520 --> 00:51:56,640
was to make some of these uh threat

1356
00:51:56,640 --> 00:51:59,040
intel reports and reports from instant

1357
00:51:59,040 --> 00:52:01,280
responses more actionable and bring

1358
00:52:01,280 --> 00:52:03,680
value to organizations so we do kind of

1359
00:52:03,680 --> 00:52:06,160
what we did here right which is consume

1360
00:52:06,160 --> 00:52:08,160
these cyber threat intel reports and

1361
00:52:08,160 --> 00:52:11,680
make them actionable um for the purposes

1362
00:52:11,680 --> 00:52:14,400
of adversary emulation and essentially

1363
00:52:14,400 --> 00:52:16,559
what we're now calling attack detect and

1364
00:52:16,559 --> 00:52:19,359
respond right essentially everything we

1365
00:52:19,359 --> 00:52:22,000
talked about today was something post

1366
00:52:22,000 --> 00:52:24,319
initial access i think all organizations

1367
00:52:24,319 --> 00:52:26,559
nowadays are working under that assumed

1368
00:52:26,559 --> 00:52:28,800
breach of you know whether it was an o

1369
00:52:28,800 --> 00:52:31,680
day which we've heard a lot of or um you

1370
00:52:31,680 --> 00:52:33,440
know some iced tea or trick bar or

1371
00:52:33,440 --> 00:52:34,480
whatever

1372
00:52:34,480 --> 00:52:37,440
what happens next right so

1373
00:52:37,440 --> 00:52:39,280
we take these reports the default report

1374
00:52:39,280 --> 00:52:42,720
is a fun one uh right and actually get

1375
00:52:42,720 --> 00:52:45,040
those procedures and that's i think

1376
00:52:45,040 --> 00:52:47,599
something where the cti world can

1377
00:52:47,599 --> 00:52:49,520
improve on is actually providing the

1378
00:52:49,520 --> 00:52:51,280
procedures the deeper report being a

1379
00:52:51,280 --> 00:52:53,920
great example of that because then uh

1380
00:52:53,920 --> 00:52:56,800
people like myself like uh joe blind

1381
00:52:56,800 --> 00:53:00,000
hacker uh right we grabbed those actual

1382
00:53:00,000 --> 00:53:02,640
procedures and then we can create these

1383
00:53:02,640 --> 00:53:04,880
emulation plans and of course we build

1384
00:53:04,880 --> 00:53:06,400
these emulation plans and share them

1385
00:53:06,400 --> 00:53:08,400
with everyone uh we share them with our

1386
00:53:08,400 --> 00:53:11,040
customers uh in json format they can

1387
00:53:11,040 --> 00:53:13,200
simply import it but of course we want

1388
00:53:13,200 --> 00:53:15,359
to contribute to the community as well

1389
00:53:15,359 --> 00:53:18,559
so we publish them um as uh attack

1390
00:53:18,559 --> 00:53:21,520
navigator heat maps as well um we give

1391
00:53:21,520 --> 00:53:23,359
the actual procedure so if you just want

1392
00:53:23,359 --> 00:53:25,040
to copy and paste them or use something

1393
00:53:25,040 --> 00:53:27,040
like atomic red team you can still get

1394
00:53:27,040 --> 00:53:29,040
value out of it right we don't force you

1395
00:53:29,040 --> 00:53:31,760
to to have to use site um and things

1396
00:53:31,760 --> 00:53:34,240
like that but um here's a perfect

1397
00:53:34,240 --> 00:53:36,800
example of uh the the one you're sharing

1398
00:53:36,800 --> 00:53:38,480
is um

1399
00:53:38,480 --> 00:53:40,559
microsoft published

1400
00:53:40,559 --> 00:53:43,920
how uh a nobelium was getting around

1401
00:53:43,920 --> 00:53:47,040
defenses uh leveraging this attack chain

1402
00:53:47,040 --> 00:53:48,880
and what we read through the attractions

1403
00:53:48,880 --> 00:53:51,359
hey wait there's a new procedure here

1404
00:53:51,359 --> 00:53:53,119
and i looked it up on atomic red team it

1405
00:53:53,119 --> 00:53:55,040
wasn't there said all right let's play

1406
00:53:55,040 --> 00:53:57,040
with this figured it out and then of

1407
00:53:57,040 --> 00:53:58,800
course contributed it back and this

1408
00:53:58,800 --> 00:54:02,160
particular case um actually ended up um

1409
00:54:02,160 --> 00:54:04,400
printing it into atomic red team as well

1410
00:54:04,400 --> 00:54:05,839
but of course if you want to do it

1411
00:54:05,839 --> 00:54:07,760
manually i showed how you can create an

1412
00:54:07,760 --> 00:54:10,480
iso file with malicious payload in it

1413
00:54:10,480 --> 00:54:12,559
and uh then just through twitter kind of

1414
00:54:12,559 --> 00:54:15,359
purple teamed it with uh cyber monk and

1415
00:54:15,359 --> 00:54:18,800
uh florian and black matter um

1416
00:54:18,800 --> 00:54:20,720
essentially just finding ways to to do

1417
00:54:20,720 --> 00:54:23,280
the detections i believe uh ryan also

1418
00:54:23,280 --> 00:54:26,400
was uh pragman was on there so uh so

1419
00:54:26,400 --> 00:54:27,839
yeah it's a lot of fun i it's probably

1420
00:54:27,839 --> 00:54:29,520
one of the funnest things that i do is

1421
00:54:29,520 --> 00:54:31,200
get to read some of these reports and

1422
00:54:31,200 --> 00:54:33,119
build these adversary emulation plans

1423
00:54:33,119 --> 00:54:35,280
and share them with the community and uh

1424
00:54:35,280 --> 00:54:37,200
yeah they're they're all free like i

1425
00:54:37,200 --> 00:54:39,119
said you don't have to use psych for

1426
00:54:39,119 --> 00:54:41,119
this we're big believers in giving back

1427
00:54:41,119 --> 00:54:42,880
to the community and doing purple

1428
00:54:42,880 --> 00:54:45,119
teaming so thank you for for a little

1429
00:54:45,119 --> 00:54:47,440
for that shout out i i appreciate it and

1430
00:54:47,440 --> 00:54:48,880
like i said just trying to give back to

1431
00:54:48,880 --> 00:54:50,240
the community

1432
00:54:50,240 --> 00:54:52,079
yeah thank you so much and thank you to

1433
00:54:52,079 --> 00:54:54,400
all the panelists too um i really

1434
00:54:54,400 --> 00:54:55,839
appreciate you

1435
00:54:55,839 --> 00:54:58,160
uh coming to share your insights and

1436
00:54:58,160 --> 00:55:00,799
wisdom and knowledge i learned something

1437
00:55:00,799 --> 00:55:02,720
i hope the audience learns something as

1438
00:55:02,720 --> 00:55:03,680
well

1439
00:55:03,680 --> 00:55:06,240
and um thank you very much i hope you

1440
00:55:06,240 --> 00:55:08,319
enjoy the rest of defcon i believe this

1441
00:55:08,319 --> 00:55:10,079
airs on the last day

1442
00:55:10,079 --> 00:55:12,799
so uh thanks for taking time out to

1443
00:55:12,799 --> 00:55:15,920
watch threat report roulette

1444
00:55:15,920 --> 00:55:19,920
and once again the bitly link is bitly

1445
00:55:19,920 --> 00:55:23,520
slash dc 29 roulette

1446
00:55:23,520 --> 00:55:25,599
and that's how you can get it or you can

1447
00:55:25,599 --> 00:55:27,839
find it on my github it's on cheerio and

1448
00:55:27,839 --> 00:55:28,960
it's called

1449
00:55:28,960 --> 00:55:33,359
uh defcon 29 bt btv threat report

1450
00:55:33,359 --> 00:55:36,400
roulette and it provides the list of all

1451
00:55:36,400 --> 00:55:38,160
the threat reports the

1452
00:55:38,160 --> 00:55:40,640
threat report roulette wheel as well as

1453
00:55:40,640 --> 00:55:42,240
our favorite resources and more

1454
00:55:42,240 --> 00:55:44,160
information if you want to contact any

1455
00:55:44,160 --> 00:55:45,520
of the panelists

1456
00:55:45,520 --> 00:55:49,440
so thank you very much and have a great

1457
00:55:49,440 --> 00:55:52,440
summer

