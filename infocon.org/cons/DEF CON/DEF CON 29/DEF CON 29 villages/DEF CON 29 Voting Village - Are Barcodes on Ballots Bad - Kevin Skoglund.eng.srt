1
00:00:00,240 --> 00:00:02,960
and welcome to our bar codes on balance

2
00:00:02,960 --> 00:00:04,240
bad

3
00:00:04,240 --> 00:00:06,319
my name is kevin skoglund i'm a voting

4
00:00:06,319 --> 00:00:08,240
system security researcher who's studied

5
00:00:08,240 --> 00:00:10,080
barcodes for several years and reported

6
00:00:10,080 --> 00:00:12,000
vulnerabilities i've found

7
00:00:12,000 --> 00:00:13,599
today i'm going to discuss how voting

8
00:00:13,599 --> 00:00:16,239
systems store votes and barcodes explain

9
00:00:16,239 --> 00:00:17,520
how to decode them

10
00:00:17,520 --> 00:00:19,359
and explore their attack surface from a

11
00:00:19,359 --> 00:00:21,600
security perspective

12
00:00:21,600 --> 00:00:23,199
there are many places where barcodes may

13
00:00:23,199 --> 00:00:24,640
be used in elections

14
00:00:24,640 --> 00:00:26,000
you may see them in the margins of

15
00:00:26,000 --> 00:00:27,680
ballots where they tell the tabulator

16
00:00:27,680 --> 00:00:29,599
how to map ovals to a set of contests

17
00:00:29,599 --> 00:00:30,800
and candidates

18
00:00:30,800 --> 00:00:33,040
you may see them on mail-in ballots poll

19
00:00:33,040 --> 00:00:35,440
books or to keep track of equipment

20
00:00:35,440 --> 00:00:37,760
these barcodes may have vulnerabilities

21
00:00:37,760 --> 00:00:39,760
maybe even ones that we'll discuss

22
00:00:39,760 --> 00:00:42,000
but we aren't going to focus on them we

23
00:00:42,000 --> 00:00:44,079
will focus on barcodes on ballots

24
00:00:44,079 --> 00:00:47,120
that store vote selections

25
00:00:47,120 --> 00:00:50,000
in 2004 the populex slate was the first

26
00:00:50,000 --> 00:00:51,760
ballot marking device to store vote

27
00:00:51,760 --> 00:00:52,320
selections

28
00:00:52,320 --> 00:00:54,640
inside a barcode but it was not widely

29
00:00:54,640 --> 00:00:56,000
used

30
00:00:56,000 --> 00:00:57,520
barcodes on ballots really took off a

31
00:00:57,520 --> 00:00:59,440
decade later with the introduction of

32
00:00:59,440 --> 00:01:00,399
the esns

33
00:01:00,399 --> 00:01:02,879
express vote it was quickly adopted by

34
00:01:02,879 --> 00:01:04,319
many states

35
00:01:04,319 --> 00:01:06,320
like many ballot marking devices it was

36
00:01:06,320 --> 00:01:08,320
used by voters with disabilities

37
00:01:08,320 --> 00:01:10,960
but esns also marketed it to a wider

38
00:01:10,960 --> 00:01:13,680
audience for use in early voting centers

39
00:01:13,680 --> 00:01:16,080
and for universal use where every voter

40
00:01:16,080 --> 00:01:18,960
in a precinct votes on a touch screen

41
00:01:18,960 --> 00:01:21,280
you can see in the photo that the ballot

42
00:01:21,280 --> 00:01:23,280
has a section of barcodes at the top

43
00:01:23,280 --> 00:01:24,960
and a list of the selected candidates

44
00:01:24,960 --> 00:01:27,520
printed below

45
00:01:27,520 --> 00:01:29,439
since then similar products have been

46
00:01:29,439 --> 00:01:31,040
introduced by other vendors

47
00:01:31,040 --> 00:01:32,880
this category of voting systems is still

48
00:01:32,880 --> 00:01:35,040
new but it's spread quickly

49
00:01:35,040 --> 00:01:37,040
they are used by several whole states

50
00:01:37,040 --> 00:01:39,600
and a number of populous cities

51
00:01:39,600 --> 00:01:41,360
there are many pros and cons to using

52
00:01:41,360 --> 00:01:43,520
these devices but i want to spend our

53
00:01:43,520 --> 00:01:45,439
time on the security issues around the

54
00:01:45,439 --> 00:01:48,960
bar codes specifically

55
00:01:49,439 --> 00:01:51,040
for anyone who's not familiar with

56
00:01:51,040 --> 00:01:52,960
ballot marking devices it may help to

57
00:01:52,960 --> 00:01:54,399
have a quick overview of how they're

58
00:01:54,399 --> 00:01:55,439
used

59
00:01:55,439 --> 00:01:57,119
a voter would use a touch screen

60
00:01:57,119 --> 00:01:58,880
computer known as a ballot marking

61
00:01:58,880 --> 00:02:01,119
device or bmd for short

62
00:02:01,119 --> 00:02:03,680
to make vote selections the voter prints

63
00:02:03,680 --> 00:02:05,280
those selections on a printer

64
00:02:05,280 --> 00:02:07,119
the printer outputs a paper ballot which

65
00:02:07,119 --> 00:02:09,598
contains barcodes and a text summary

66
00:02:09,598 --> 00:02:11,840
of the selections the voter has an

67
00:02:11,840 --> 00:02:13,760
opportunity to examine the text summary

68
00:02:13,760 --> 00:02:15,920
and then cast the ballot by feeding it

69
00:02:15,920 --> 00:02:18,000
into a tabulator

70
00:02:18,000 --> 00:02:19,920
the tabulator reads the barcodes and

71
00:02:19,920 --> 00:02:22,000
attributes votes to candidates

72
00:02:22,000 --> 00:02:23,599
then the ballot is impounded into the

73
00:02:23,599 --> 00:02:26,000
ballot box there are variations

74
00:02:26,000 --> 00:02:29,280
but this is the general process now that

75
00:02:29,280 --> 00:02:30,319
we have some background

76
00:02:30,319 --> 00:02:32,160
let's learn how to decode the barcodes

77
00:02:32,160 --> 00:02:34,319
on a few different systems

78
00:02:34,319 --> 00:02:36,640
we will look at the esns express vote in

79
00:02:36,640 --> 00:02:38,239
expressvote xl

80
00:02:38,239 --> 00:02:41,040
the dominion image cast x and the unison

81
00:02:41,040 --> 00:02:43,200
freedom vote tablet

82
00:02:43,200 --> 00:02:44,959
i picked these as popular examples that

83
00:02:44,959 --> 00:02:46,879
illustrate three different ways barcodes

84
00:02:46,879 --> 00:02:47,680
are used

85
00:02:47,680 --> 00:02:49,519
they make good case studies and they can

86
00:02:49,519 --> 00:02:51,440
act as stand-ins for other systems that

87
00:02:51,440 --> 00:02:52,800
use similar concepts

88
00:02:52,800 --> 00:02:54,319
maybe even systems that are not yet on

89
00:02:54,319 --> 00:02:56,080
the market

90
00:02:56,080 --> 00:02:58,720
the sns expressvote ballot uses bar

91
00:02:58,720 --> 00:02:59,840
codes in the code

92
00:02:59,840 --> 00:03:03,120
128 c format the long

93
00:03:03,120 --> 00:03:04,720
code at the top contains the ballot

94
00:03:04,720 --> 00:03:06,879
style which sets which contests and

95
00:03:06,879 --> 00:03:08,560
candidates are being voted on

96
00:03:08,560 --> 00:03:10,480
it also contains a count of the number

97
00:03:10,480 --> 00:03:12,640
of barcodes that follow in the three

98
00:03:12,640 --> 00:03:13,920
columns below it

99
00:03:13,920 --> 00:03:16,480
those are the vote selections this

100
00:03:16,480 --> 00:03:18,080
ballot has 15 barcodes

101
00:03:18,080 --> 00:03:20,560
in five rows if you look at the text

102
00:03:20,560 --> 00:03:21,840
below the barcodes

103
00:03:21,840 --> 00:03:24,720
you'll find that there are 16 contests

104
00:03:24,720 --> 00:03:26,959
one contest had no selection

105
00:03:26,959 --> 00:03:30,319
so no barcode is stored for it

106
00:03:30,319 --> 00:03:32,000
the barcodes can be scanned by any

107
00:03:32,000 --> 00:03:33,920
barcode reader however

108
00:03:33,920 --> 00:03:35,920
smartphones have difficulty because

109
00:03:35,920 --> 00:03:37,599
there's so many barcodes and they're so

110
00:03:37,599 --> 00:03:39,280
close together that it can't pick out

111
00:03:39,280 --> 00:03:40,319
just one

112
00:03:40,319 --> 00:03:42,000
there are other obstacles to decoding

113
00:03:42,000 --> 00:03:43,519
these barcodes

114
00:03:43,519 --> 00:03:44,959
for one thing the barcodes are not

115
00:03:44,959 --> 00:03:47,200
printed in the same order as the contest

116
00:03:47,200 --> 00:03:49,519
in the text for example the sixth

117
00:03:49,519 --> 00:03:50,319
barcode

118
00:03:50,319 --> 00:03:52,000
is a vote for the second candidate in

119
00:03:52,000 --> 00:03:54,000
the summary that makes it difficult to

120
00:03:54,000 --> 00:03:56,400
match them up and account for them all

121
00:03:56,400 --> 00:03:58,720
and the barcodes do not decode to text

122
00:03:58,720 --> 00:04:00,720
they contain six digit numbers

123
00:04:00,720 --> 00:04:04,000
like 093411

124
00:04:04,000 --> 00:04:06,480
that number is a candidate identifier

125
00:04:06,480 --> 00:04:08,159
the tabulator which processes the

126
00:04:08,159 --> 00:04:09,040
barcode

127
00:04:09,040 --> 00:04:10,720
will match that identifier to a

128
00:04:10,720 --> 00:04:13,280
candidate's tally and record a vote

129
00:04:13,280 --> 00:04:15,760
the candidate identifier also matches

130
00:04:15,760 --> 00:04:18,079
the ovals on a marked sense ballot

131
00:04:18,079 --> 00:04:20,079
which you may know is a full ballot or a

132
00:04:20,079 --> 00:04:21,680
handmarked paper ballot

133
00:04:21,680 --> 00:04:23,680
i'm going to call it a mark sense ballot

134
00:04:23,680 --> 00:04:25,440
because the scanner senses the marks

135
00:04:25,440 --> 00:04:27,520
that are in the ovals

136
00:04:27,520 --> 00:04:29,520
with that ballot in hand we can work out

137
00:04:29,520 --> 00:04:31,680
the meaning behind the identifier

138
00:04:31,680 --> 00:04:34,240
the timing marks around the outside edge

139
00:04:34,240 --> 00:04:36,080
create a grid of coordinates

140
00:04:36,080 --> 00:04:38,400
and we can locate the ovals by those

141
00:04:38,400 --> 00:04:39,759
coordinates

142
00:04:39,759 --> 00:04:42,160
the six digits follow a pattern two

143
00:04:42,160 --> 00:04:43,759
digits for column number

144
00:04:43,759 --> 00:04:46,080
two digits for row number one digit for

145
00:04:46,080 --> 00:04:46,960
page number

146
00:04:46,960 --> 00:04:49,759
and one digit for side number and so on

147
00:04:49,759 --> 00:04:50,800
the grid

148
00:04:50,800 --> 00:04:54,479
09 1011 would be the ninth column

149
00:04:54,479 --> 00:04:57,199
the tenth row of page one side one which

150
00:04:57,199 --> 00:04:58,560
is the candidate hope s

151
00:04:58,560 --> 00:05:01,680
lost two positions lower on the grid

152
00:05:01,680 --> 00:05:04,479
is candidate id o nine one two one one

153
00:05:04,479 --> 00:05:07,360
which is rufus lee king

154
00:05:07,360 --> 00:05:11,840
below that is a write in at 09 1411

155
00:05:11,840 --> 00:05:14,080
write-in votes would store the number

156
00:05:14,080 --> 00:05:16,479
only not the candidate's name

157
00:05:16,479 --> 00:05:18,560
the barcodes are strictly six-digit

158
00:05:18,560 --> 00:05:20,160
numbers

159
00:05:20,160 --> 00:05:22,400
overall it's a clever way to allow the

160
00:05:22,400 --> 00:05:23,280
tabulator

161
00:05:23,280 --> 00:05:25,120
to scan two very different types of

162
00:05:25,120 --> 00:05:27,280
ballots but only work with one set of

163
00:05:27,280 --> 00:05:28,800
identifiers

164
00:05:28,800 --> 00:05:30,479
scanning a mark since ballot returns

165
00:05:30,479 --> 00:05:33,120
grid positions and scanning barcodes

166
00:05:33,120 --> 00:05:36,720
also returns grid positions

167
00:05:37,199 --> 00:05:39,360
on the dominion imagecast x palette the

168
00:05:39,360 --> 00:05:42,160
barcode is in the qr code format

169
00:05:42,160 --> 00:05:43,840
the bmd version prints on an eight and a

170
00:05:43,840 --> 00:05:45,440
half by eleven sheet of paper

171
00:05:45,440 --> 00:05:47,759
the vvpap version prints on a narrow

172
00:05:47,759 --> 00:05:50,240
spool of paper inside a box

173
00:05:50,240 --> 00:05:53,199
the qr code includes the ballot style

174
00:05:53,199 --> 00:05:55,280
like the long barcode did on the esns

175
00:05:55,280 --> 00:05:56,319
ballot

176
00:05:56,319 --> 00:05:58,880
it contains the vote selections it

177
00:05:58,880 --> 00:06:00,880
encodes any write-in candidate names

178
00:06:00,880 --> 00:06:03,759
and it has an hmac signature for long

179
00:06:03,759 --> 00:06:05,840
ballots it can print more than one qr

180
00:06:05,840 --> 00:06:08,479
code if it needs to

181
00:06:08,479 --> 00:06:11,199
most barcode scanners and smartphones

182
00:06:11,199 --> 00:06:13,520
will not read these barcodes

183
00:06:13,520 --> 00:06:15,840
most qr codes contain an identifier

184
00:06:15,840 --> 00:06:17,360
that's for an application to use

185
00:06:17,360 --> 00:06:19,600
such as for package tracking or they may

186
00:06:19,600 --> 00:06:21,039
contain a url

187
00:06:21,039 --> 00:06:22,720
you may have used one in a restaurant in

188
00:06:22,720 --> 00:06:24,880
order to look up the menu

189
00:06:24,880 --> 00:06:26,800
these qr codes are not standard because

190
00:06:26,800 --> 00:06:28,560
they contain binary data with a

191
00:06:28,560 --> 00:06:29,759
different structure

192
00:06:29,759 --> 00:06:32,080
instead of just characters if you want

193
00:06:32,080 --> 00:06:32,960
to decode them

194
00:06:32,960 --> 00:06:35,199
you can use a couple of websites or a

195
00:06:35,199 --> 00:06:36,479
unix program called

196
00:06:36,479 --> 00:06:40,000
zbar image any reader needs to extract

197
00:06:40,000 --> 00:06:42,319
raw bytes either as binary or

198
00:06:42,319 --> 00:06:43,199
hexadecimal

199
00:06:43,199 --> 00:06:46,080
in order to work with them if we take a

200
00:06:46,080 --> 00:06:48,000
dominion ballot barcode

201
00:06:48,000 --> 00:06:50,080
and we run it through z bar image it

202
00:06:50,080 --> 00:06:52,479
will return bytes of data as hexadecimal

203
00:06:52,479 --> 00:06:53,440
numbers

204
00:06:53,440 --> 00:06:56,160
every two hex digits is one byte or

205
00:06:56,160 --> 00:06:57,440
eight bits

206
00:06:57,440 --> 00:07:00,560
the spaces separate those bytes

207
00:07:00,560 --> 00:07:02,000
to understand the vote selections we

208
00:07:02,000 --> 00:07:04,800
need the binary so i used some ruby code

209
00:07:04,800 --> 00:07:06,960
to convert the hex digits to binary two

210
00:07:06,960 --> 00:07:08,400
at a time

211
00:07:08,400 --> 00:07:10,160
i colored the first four bytes

212
00:07:10,160 --> 00:07:12,160
differently so you can see how the two

213
00:07:12,160 --> 00:07:13,520
versions line up

214
00:07:13,520 --> 00:07:15,120
it's really just condensing and

215
00:07:15,120 --> 00:07:17,759
expanding the same information

216
00:07:17,759 --> 00:07:20,000
now that we have binary data what does

217
00:07:20,000 --> 00:07:21,680
it mean

218
00:07:21,680 --> 00:07:24,080
we can parse it into several sections

219
00:07:24,080 --> 00:07:25,280
the green parts

220
00:07:25,280 --> 00:07:27,199
are metadata many of them are just

221
00:07:27,199 --> 00:07:28,639
separators

222
00:07:28,639 --> 00:07:30,720
the blue parts are the precinct and

223
00:07:30,720 --> 00:07:32,000
ballot style

224
00:07:32,000 --> 00:07:33,840
if you convert them to decimal numbers

225
00:07:33,840 --> 00:07:36,400
you might recognize them

226
00:07:36,400 --> 00:07:38,240
the red part contains the vote

227
00:07:38,240 --> 00:07:39,520
selections

228
00:07:39,520 --> 00:07:42,240
and the gray part is a 32 byte hmac

229
00:07:42,240 --> 00:07:44,960
which is a hash of the selections data

230
00:07:44,960 --> 00:07:46,400
you can think of the hmac like a

231
00:07:46,400 --> 00:07:48,639
fingerprint for this set of selections

232
00:07:48,639 --> 00:07:49,840
it's not a fingerprint for this

233
00:07:49,840 --> 00:07:52,240
particular ballot but any ballot with

234
00:07:52,240 --> 00:07:53,360
the same choices

235
00:07:53,360 --> 00:07:56,879
would have the same fingerprint

236
00:07:57,360 --> 00:08:00,319
let's focus on the vote selections as

237
00:08:00,319 --> 00:08:01,759
with the esns ballot

238
00:08:01,759 --> 00:08:03,759
we need a marked sense ballot or similar

239
00:08:03,759 --> 00:08:06,560
reference to make sense of this encoding

240
00:08:06,560 --> 00:08:08,720
if we made a list of the contests and

241
00:08:08,720 --> 00:08:10,400
then a list of the candidates in each

242
00:08:10,400 --> 00:08:11,039
contest

243
00:08:11,039 --> 00:08:13,360
in order it would line up perfectly with

244
00:08:13,360 --> 00:08:15,360
the list of zeros and ones

245
00:08:15,360 --> 00:08:17,280
i just took away the spaces and added

246
00:08:17,280 --> 00:08:19,199
line returns

247
00:08:19,199 --> 00:08:21,840
each one indicates a vote each zero

248
00:08:21,840 --> 00:08:23,599
represents no vote

249
00:08:23,599 --> 00:08:26,160
for example the court clerk contest has

250
00:08:26,160 --> 00:08:27,599
three candidates

251
00:08:27,599 --> 00:08:29,599
the binary tells us that the first one

252
00:08:29,599 --> 00:08:32,640
has a vote and the second two do not

253
00:08:32,640 --> 00:08:34,320
this is a straightforward example they

254
00:08:34,320 --> 00:08:36,320
get more complicated with ballot sheets

255
00:08:36,320 --> 00:08:38,240
and write-ins and rank-choice voting

256
00:08:38,240 --> 00:08:41,360
but the basic pattern is the same

257
00:08:41,360 --> 00:08:43,200
let's look at our last example the

258
00:08:43,200 --> 00:08:44,880
ballot from the unison freedom boat

259
00:08:44,880 --> 00:08:45,760
tablet

260
00:08:45,760 --> 00:08:48,320
it has a non-standard barcode at the

261
00:08:48,320 --> 00:08:50,080
very bottom you see a barcode that's in

262
00:08:50,080 --> 00:08:51,839
the code 128 format

263
00:08:51,839 --> 00:08:54,800
which contains the ballot style above

264
00:08:54,800 --> 00:08:55,120
that

265
00:08:55,120 --> 00:08:57,519
the vote selections are marked in a grid

266
00:08:57,519 --> 00:08:58,399
pattern

267
00:08:58,399 --> 00:09:00,160
this is similar to the punch cards of

268
00:09:00,160 --> 00:09:01,920
the past or to a system called

269
00:09:01,920 --> 00:09:05,279
inca vote which is how i refer to these

270
00:09:05,279 --> 00:09:07,120
you can also think of them as compressed

271
00:09:07,120 --> 00:09:08,320
vote targets

272
00:09:08,320 --> 00:09:09,920
vote targets are what we call the ovals

273
00:09:09,920 --> 00:09:11,839
or boxes on a full ballot

274
00:09:11,839 --> 00:09:13,600
imagine removing all the text from a

275
00:09:13,600 --> 00:09:15,440
full ballot and then compressing the

276
00:09:15,440 --> 00:09:16,720
remaining boxes down

277
00:09:16,720 --> 00:09:19,440
to a small bit of real estate to

278
00:09:19,440 --> 00:09:20,720
illustrate

279
00:09:20,720 --> 00:09:23,120
here's a unison mark sense ballot on the

280
00:09:23,120 --> 00:09:25,600
left alongside the grid of selections

281
00:09:25,600 --> 00:09:28,640
and the text summary the outermost marks

282
00:09:28,640 --> 00:09:29,600
in the grid

283
00:09:29,600 --> 00:09:31,680
are timing marks just the same as the

284
00:09:31,680 --> 00:09:33,680
timing marks around the full ballot

285
00:09:33,680 --> 00:09:35,519
in both cases they help the scanner

286
00:09:35,519 --> 00:09:37,920
locate the vote targets

287
00:09:37,920 --> 00:09:39,920
the vote selections are inside the

288
00:09:39,920 --> 00:09:41,279
orange box

289
00:09:41,279 --> 00:09:43,519
there are four of them the text summary

290
00:09:43,519 --> 00:09:44,880
lists five contests

291
00:09:44,880 --> 00:09:46,480
but the governor's contest had no

292
00:09:46,480 --> 00:09:48,000
selection

293
00:09:48,000 --> 00:09:50,080
it helps a lot if i add boxes to the

294
00:09:50,080 --> 00:09:51,920
grid to show you the vote choices that

295
00:09:51,920 --> 00:09:53,279
were not marked

296
00:09:53,279 --> 00:09:54,959
the votes are recorded starting in the

297
00:09:54,959 --> 00:09:56,800
upper left and moving down

298
00:09:56,800 --> 00:09:59,920
each column the first box is empty it

299
00:09:59,920 --> 00:10:01,600
corresponds to the straight party

300
00:10:01,600 --> 00:10:04,000
republican vote on the full ballot

301
00:10:04,000 --> 00:10:06,560
the second box is filled we can look at

302
00:10:06,560 --> 00:10:07,920
the full ballot and see that this is a

303
00:10:07,920 --> 00:10:09,519
vote for the straight party democratic

304
00:10:09,519 --> 00:10:10,160
choice

305
00:10:10,160 --> 00:10:11,600
and that's what the text summary shows

306
00:10:11,600 --> 00:10:14,399
too we move to the next column

307
00:10:14,399 --> 00:10:16,480
the box is filled on the full ballot

308
00:10:16,480 --> 00:10:18,480
that would be a vote for daniel boone

309
00:10:18,480 --> 00:10:20,399
which is also what the summary shows and

310
00:10:20,399 --> 00:10:21,920
so on

311
00:10:21,920 --> 00:10:23,920
notice that the text summary also

312
00:10:23,920 --> 00:10:25,440
includes position numbers

313
00:10:25,440 --> 00:10:29,120
that match the positions in the barcode

314
00:10:29,120 --> 00:10:31,519
so is this even a barcode well

315
00:10:31,519 --> 00:10:33,360
technically probably not

316
00:10:33,360 --> 00:10:36,079
but it is one for our purposes it

317
00:10:36,079 --> 00:10:37,440
encodes the vote selections

318
00:10:37,440 --> 00:10:40,160
in a machine readable format that voters

319
00:10:40,160 --> 00:10:42,160
cannot read or verify

320
00:10:42,160 --> 00:10:44,560
and it can be attacked we'll get to see

321
00:10:44,560 --> 00:10:46,320
how a custom roll-your-own barcode

322
00:10:46,320 --> 00:10:49,040
stands up to those attacks

323
00:10:49,040 --> 00:10:51,279
here's the table that compares the key

324
00:10:51,279 --> 00:10:53,920
features of these three examples

325
00:10:53,920 --> 00:10:55,600
none of the barcodes that we examined

326
00:10:55,600 --> 00:10:57,040
are readable by a voter with a

327
00:10:57,040 --> 00:10:59,120
smartphone in the voting booth

328
00:10:59,120 --> 00:11:00,880
and even if they have a fancier barcode

329
00:11:00,880 --> 00:11:03,360
scanner all of them need a full ballot

330
00:11:03,360 --> 00:11:06,320
to use as a reference when decoding

331
00:11:06,320 --> 00:11:08,480
none of them are encrypted and they vary

332
00:11:08,480 --> 00:11:10,079
widely in their use of integrity

333
00:11:10,079 --> 00:11:12,959
protection measures

334
00:11:13,519 --> 00:11:15,360
now let's talk about potential attacks

335
00:11:15,360 --> 00:11:18,720
on barcodes and on barcode scanners

336
00:11:18,720 --> 00:11:20,399
in this section i'm not claiming

337
00:11:20,399 --> 00:11:23,200
vulnerabilities in any specific systems

338
00:11:23,200 --> 00:11:24,959
i will point out characteristics of some

339
00:11:24,959 --> 00:11:26,880
systems to illustrate how issues might

340
00:11:26,880 --> 00:11:28,160
be handled

341
00:11:28,160 --> 00:11:30,160
i'm not examining the feasibility or the

342
00:11:30,160 --> 00:11:32,000
likelihood of exploitation which are

343
00:11:32,000 --> 00:11:33,760
very important considerations

344
00:11:33,760 --> 00:11:35,200
for one thing i'm not looking at what

345
00:11:35,200 --> 00:11:36,880
other defenses may exist

346
00:11:36,880 --> 00:11:38,160
and i'm not planning to give enough

347
00:11:38,160 --> 00:11:40,240
information to perform an attack

348
00:11:40,240 --> 00:11:41,760
this will be an examination of the

349
00:11:41,760 --> 00:11:44,000
attack surface and the areas that have

350
00:11:44,000 --> 00:11:45,519
potential risks

351
00:11:45,519 --> 00:11:47,120
you can think of it as advice that i'd

352
00:11:47,120 --> 00:11:49,200
give to a pen tester who's been tasked

353
00:11:49,200 --> 00:11:50,959
with examining a system that uses

354
00:11:50,959 --> 00:11:52,160
barcodes

355
00:11:52,160 --> 00:11:53,839
these are the places that i would look

356
00:11:53,839 --> 00:11:56,399
here are the rocks that i'd turn over

357
00:11:56,399 --> 00:11:58,399
i also hope to surface some of the risks

358
00:11:58,399 --> 00:12:00,639
so that manufacturers can consider them

359
00:12:00,639 --> 00:12:03,440
mitigate them and build better systems

360
00:12:03,440 --> 00:12:04,959
and i'd like to help jurisdictions know

361
00:12:04,959 --> 00:12:06,560
what to ask during purchasing

362
00:12:06,560 --> 00:12:08,160
and to help them to secure the systems

363
00:12:08,160 --> 00:12:09,760
that they already own

364
00:12:09,760 --> 00:12:12,160
my overall goal is to help the defenders

365
00:12:12,160 --> 00:12:13,839
not the attackers

366
00:12:13,839 --> 00:12:15,519
i believe we can be mature and talk

367
00:12:15,519 --> 00:12:17,120
about how to lower risk in critical

368
00:12:17,120 --> 00:12:17,760
systems

369
00:12:17,760 --> 00:12:19,440
without panicking and weaving things

370
00:12:19,440 --> 00:12:22,639
into conspiracy theories

371
00:12:22,639 --> 00:12:24,560
the process diagram is also a good

372
00:12:24,560 --> 00:12:26,720
diagram of the attack surface

373
00:12:26,720 --> 00:12:29,279
every point has attack potential

374
00:12:29,279 --> 00:12:30,079
obviously

375
00:12:30,079 --> 00:12:32,399
it's better to attack closer to the left

376
00:12:32,399 --> 00:12:34,880
side before barcodes are printed

377
00:12:34,880 --> 00:12:36,480
but there are attack opportunities to

378
00:12:36,480 --> 00:12:38,399
edit or destroy barcodes later

379
00:12:38,399 --> 00:12:40,240
even after the ballot has been tabulated

380
00:12:40,240 --> 00:12:41,839
and stored

381
00:12:41,839 --> 00:12:43,839
note that some systems perform ballot

382
00:12:43,839 --> 00:12:44,880
creation inside

383
00:12:44,880 --> 00:12:46,880
one device while others use separate

384
00:12:46,880 --> 00:12:47,920
devices

385
00:12:47,920 --> 00:12:49,920
position number two could represent a

386
00:12:49,920 --> 00:12:51,920
usb cable between the tablet and the

387
00:12:51,920 --> 00:12:53,120
printer

388
00:12:53,120 --> 00:12:54,959
and some systems combine tabulation and

389
00:12:54,959 --> 00:12:56,480
storage into one device

390
00:12:56,480 --> 00:12:58,000
while others such as central count

391
00:12:58,000 --> 00:13:00,320
tabulation split it up

392
00:13:00,320 --> 00:13:01,920
and some all-in-one hybrid systems

393
00:13:01,920 --> 00:13:03,760
contain everything from one to seven

394
00:13:03,760 --> 00:13:06,320
inside a single device there are many

395
00:13:06,320 --> 00:13:07,760
ways that we might launch attacks on

396
00:13:07,760 --> 00:13:08,720
these areas

397
00:13:08,720 --> 00:13:10,079
i won't spend time explaining them

398
00:13:10,079 --> 00:13:11,120
because you've likely heard them

399
00:13:11,120 --> 00:13:11,839
elsewhere

400
00:13:11,839 --> 00:13:13,680
they include supply chain attacks

401
00:13:13,680 --> 00:13:15,680
hardware tampering malware

402
00:13:15,680 --> 00:13:17,440
machine in the middle attacks and remote

403
00:13:17,440 --> 00:13:19,519
access

404
00:13:19,519 --> 00:13:21,040
one important gradient in many of the

405
00:13:21,040 --> 00:13:22,959
attacks we'll look at is access to a

406
00:13:22,959 --> 00:13:24,320
printer

407
00:13:24,320 --> 00:13:26,320
positions one through three are before

408
00:13:26,320 --> 00:13:29,120
printing and have access to that printer

409
00:13:29,120 --> 00:13:31,440
at position four usually the ballot is

410
00:13:31,440 --> 00:13:32,800
under the voter's control

411
00:13:32,800 --> 00:13:34,320
but there may be an opportunity for poll

412
00:13:34,320 --> 00:13:36,079
workers to handle the ballot or the

413
00:13:36,079 --> 00:13:37,680
voter may insert the ballot into a

414
00:13:37,680 --> 00:13:39,600
device to verify their selections

415
00:13:39,600 --> 00:13:42,639
as one vendor routinely demonstrates at

416
00:13:42,639 --> 00:13:43,839
position 5

417
00:13:43,839 --> 00:13:46,320
most tabulators do not have a printer

418
00:13:46,320 --> 00:13:47,760
though some may add one to support

419
00:13:47,760 --> 00:13:49,600
post-election audits by printing ballot

420
00:13:49,600 --> 00:13:50,880
identifiers

421
00:13:50,880 --> 00:13:52,399
ideally that printing would be in a

422
00:13:52,399 --> 00:13:54,079
different color and restricted to the

423
00:13:54,079 --> 00:13:56,000
margins

424
00:13:56,000 --> 00:13:58,000
most tabulators scan a ballot and drop

425
00:13:58,000 --> 00:13:59,519
it into storage immediately

426
00:13:59,519 --> 00:14:01,360
but several all-in-one hybrid machines

427
00:14:01,360 --> 00:14:02,880
have a single paper path

428
00:14:02,880 --> 00:14:05,440
so the cast ballot passes a software

429
00:14:05,440 --> 00:14:06,639
controlled printer

430
00:14:06,639 --> 00:14:10,079
at position 6 on the way and finally

431
00:14:10,079 --> 00:14:11,839
a printer isn't the only way to mark on

432
00:14:11,839 --> 00:14:13,440
these ballots several

433
00:14:13,440 --> 00:14:16,079
print on thermal paper applying heat

434
00:14:16,079 --> 00:14:17,360
friction or scraping

435
00:14:17,360 --> 00:14:19,360
will mark on those ballots you can make

436
00:14:19,360 --> 00:14:21,040
a mark by swiping a fingernail across

437
00:14:21,040 --> 00:14:21,920
them

438
00:14:21,920 --> 00:14:23,760
and just like with any type of paper

439
00:14:23,760 --> 00:14:25,600
ballot there may be opportunities for

440
00:14:25,600 --> 00:14:27,440
manipulation during transport

441
00:14:27,440 --> 00:14:31,600
storage and post-election audits

442
00:14:31,600 --> 00:14:33,279
the first attack that we'll look at is

443
00:14:33,279 --> 00:14:34,639
the most straightforward

444
00:14:34,639 --> 00:14:37,360
printing a different barcode this is an

445
00:14:37,360 --> 00:14:38,800
attack during creation

446
00:14:38,800 --> 00:14:41,199
that applies to every type of barcode

447
00:14:41,199 --> 00:14:42,560
it's the strongest attack

448
00:14:42,560 --> 00:14:43,920
because the attacker has the most

449
00:14:43,920 --> 00:14:45,920
flexibility about what gets printed

450
00:14:45,920 --> 00:14:48,639
and has the least chance of detection a

451
00:14:48,639 --> 00:14:49,839
hacked bmd

452
00:14:49,839 --> 00:14:51,920
would be the ideal target because the

453
00:14:51,920 --> 00:14:54,160
bmd has everything it needs to generate

454
00:14:54,160 --> 00:14:54,880
barcodes

455
00:14:54,880 --> 00:14:57,519
that's its regular job whereas the

456
00:14:57,519 --> 00:14:58,079
printer

457
00:14:58,079 --> 00:14:59,920
or a machine in the middle attack would

458
00:14:59,920 --> 00:15:01,680
need to know the barcode format

459
00:15:01,680 --> 00:15:03,600
the data structure and possibly

460
00:15:03,600 --> 00:15:05,360
additional data to create ballots that

461
00:15:05,360 --> 00:15:06,480
appear authentic

462
00:15:06,480 --> 00:15:08,880
and pass any integrity checking measures

463
00:15:08,880 --> 00:15:10,160
if the attacker replaced

464
00:15:10,160 --> 00:15:12,160
only the barcode the voter would have no

465
00:15:12,160 --> 00:15:13,279
way of detecting it

466
00:15:13,279 --> 00:15:16,320
it would cast the ballot or the attacker

467
00:15:16,320 --> 00:15:18,240
could create a much better forgery

468
00:15:18,240 --> 00:15:20,639
by modifying both the barcode and the

469
00:15:20,639 --> 00:15:21,360
text

470
00:15:21,360 --> 00:15:23,040
since studies show that voters rarely

471
00:15:23,040 --> 00:15:24,480
check the text

472
00:15:24,480 --> 00:15:26,399
either way it's the barcode that gets

473
00:15:26,399 --> 00:15:29,279
counted on election night

474
00:15:29,279 --> 00:15:31,920
next we have a replay attack during

475
00:15:31,920 --> 00:15:33,120
creation of a ballot

476
00:15:33,120 --> 00:15:34,800
an attacker takes a barcode that they

477
00:15:34,800 --> 00:15:36,720
don't like and they replace it with one

478
00:15:36,720 --> 00:15:38,240
that they do like

479
00:15:38,240 --> 00:15:39,759
this is different than printing any

480
00:15:39,759 --> 00:15:42,000
barcode because the attacker

481
00:15:42,000 --> 00:15:43,519
doesn't have to navigate all the

482
00:15:43,519 --> 00:15:45,920
complexities of building a barcode

483
00:15:45,920 --> 00:15:48,000
it's just mimicry of a known valid

484
00:15:48,000 --> 00:15:49,199
barcode

485
00:15:49,199 --> 00:15:50,959
one doesn't need to know the structure

486
00:15:50,959 --> 00:15:52,240
or any secrets

487
00:15:52,240 --> 00:15:54,720
it just has to know that one barcode is

488
00:15:54,720 --> 00:15:55,600
favorable

489
00:15:55,600 --> 00:15:57,920
and then recognize unfavorable ones to

490
00:15:57,920 --> 00:15:59,839
swap out

491
00:15:59,839 --> 00:16:02,240
but attack number two is suitable for

492
00:16:02,240 --> 00:16:04,160
printer or machine in the middle attacks

493
00:16:04,160 --> 00:16:06,320
at positions two and three where you may

494
00:16:06,320 --> 00:16:08,160
not possess all the information that the

495
00:16:08,160 --> 00:16:10,880
bmd has

496
00:16:11,040 --> 00:16:12,959
next we'll look at two similar attacks

497
00:16:12,959 --> 00:16:14,160
together

498
00:16:14,160 --> 00:16:15,920
first if there's an undervote in a

499
00:16:15,920 --> 00:16:18,480
contest where the voter has not voted

500
00:16:18,480 --> 00:16:20,399
or has not voted as many votes as

501
00:16:20,399 --> 00:16:22,800
they're allowed the attacker can add

502
00:16:22,800 --> 00:16:26,240
their preferred vote to that contest

503
00:16:26,240 --> 00:16:28,000
in these examples you'll see that the

504
00:16:28,000 --> 00:16:29,839
voter could have voted for one

505
00:16:29,839 --> 00:16:32,320
more candidate in each of these contests

506
00:16:32,320 --> 00:16:33,360
as barcodes

507
00:16:33,360 --> 00:16:35,360
those could be opportunities to steal an

508
00:16:35,360 --> 00:16:36,399
undervote

509
00:16:36,399 --> 00:16:38,000
it would net one vote for a favored

510
00:16:38,000 --> 00:16:39,920
candidate or many votes

511
00:16:39,920 --> 00:16:43,199
for a straight party contest

512
00:16:43,199 --> 00:16:44,800
an attacker could also add a surplus

513
00:16:44,800 --> 00:16:46,880
vote to create an overvote

514
00:16:46,880 --> 00:16:48,720
if too many candidates are picked all

515
00:16:48,720 --> 00:16:50,000
the votes in the contest may

516
00:16:50,000 --> 00:16:52,160
become invalid in the example you can

517
00:16:52,160 --> 00:16:54,160
see that each contest has one vote too

518
00:16:54,160 --> 00:16:55,360
many

519
00:16:55,360 --> 00:16:57,120
it would not net any new votes for a

520
00:16:57,120 --> 00:16:59,279
favored candidate but it could subtract

521
00:16:59,279 --> 00:17:01,600
votes for unfavored candidates

522
00:17:01,600 --> 00:17:04,720
these examples use boxes not barcodes so

523
00:17:04,720 --> 00:17:07,439
how would barcodes be affected

524
00:17:07,439 --> 00:17:09,039
the inca vote that we saw with the

525
00:17:09,039 --> 00:17:11,679
freedom vote tablet it's very vulnerable

526
00:17:11,679 --> 00:17:13,439
adding a vote is as simple as adding a

527
00:17:13,439 --> 00:17:14,720
square to the grid

528
00:17:14,720 --> 00:17:16,240
on thermal paper i might be able to do

529
00:17:16,240 --> 00:17:18,079
it with a small scraper

530
00:17:18,079 --> 00:17:20,160
and because of their similarity mark

531
00:17:20,160 --> 00:17:21,520
sense ballots have this same

532
00:17:21,520 --> 00:17:22,959
vulnerability

533
00:17:22,959 --> 00:17:24,240
one difference though is that marks

534
00:17:24,240 --> 00:17:26,079
sense ballots have context

535
00:17:26,079 --> 00:17:28,240
around the marks so the voter may notice

536
00:17:28,240 --> 00:17:31,600
the change with barcodes they don't

537
00:17:31,600 --> 00:17:34,000
code 128 may be vulnerable depending on

538
00:17:34,000 --> 00:17:35,520
the implementation

539
00:17:35,520 --> 00:17:37,120
it helps that each bar code is an

540
00:17:37,120 --> 00:17:38,559
individual vote

541
00:17:38,559 --> 00:17:40,480
the expressvote style of ballot may

542
00:17:40,480 --> 00:17:42,559
leave blank spaces if rows are not

543
00:17:42,559 --> 00:17:44,799
evenly divisible by 3.

544
00:17:44,799 --> 00:17:47,120
esns has reportedly mitigated this in

545
00:17:47,120 --> 00:17:48,240
future software

546
00:17:48,240 --> 00:17:51,600
by filling in a row of x's esns also

547
00:17:51,600 --> 00:17:53,600
records a count of the barcodes on the

548
00:17:53,600 --> 00:17:54,400
ballot

549
00:17:54,400 --> 00:17:55,919
i don't think that's a strong integrity

550
00:17:55,919 --> 00:17:57,360
measure but it does offer a basic

551
00:17:57,360 --> 00:17:59,360
defense

552
00:17:59,360 --> 00:18:01,039
adding votes to the qr code would be

553
00:18:01,039 --> 00:18:03,520
more difficult the format has a complex

554
00:18:03,520 --> 00:18:04,240
structure

555
00:18:04,240 --> 00:18:06,799
and each vote is not as distinct the

556
00:18:06,799 --> 00:18:08,400
imagecast x implementation

557
00:18:08,400 --> 00:18:11,120
also includes an hmac so changing

558
00:18:11,120 --> 00:18:12,960
selections would change the expected

559
00:18:12,960 --> 00:18:14,799
hmac and honestly

560
00:18:14,799 --> 00:18:16,960
if an attacker has enough access to

561
00:18:16,960 --> 00:18:18,480
create a matching hmac

562
00:18:18,480 --> 00:18:20,400
then it's no longer distinct from attack

563
00:18:20,400 --> 00:18:22,240
number one where an attacker can print

564
00:18:22,240 --> 00:18:24,880
any barcode at all

565
00:18:24,880 --> 00:18:26,720
instead of adding a vote an attacker

566
00:18:26,720 --> 00:18:28,000
could modify a printed

567
00:18:28,000 --> 00:18:30,880
barcode to have different values this is

568
00:18:30,880 --> 00:18:31,840
not possible

569
00:18:31,840 --> 00:18:34,720
with inca vote or qr codes one reason is

570
00:18:34,720 --> 00:18:36,320
that modification must be

571
00:18:36,320 --> 00:18:39,039
additive you can add a black mark to one

572
00:18:39,039 --> 00:18:39,679
box

573
00:18:39,679 --> 00:18:41,679
but you can't take away an existing

574
00:18:41,679 --> 00:18:42,720
black mark

575
00:18:42,720 --> 00:18:44,640
and we've already seen how qr code has a

576
00:18:44,640 --> 00:18:46,000
complex format

577
00:18:46,000 --> 00:18:48,240
and may have integrity checking on those

578
00:18:48,240 --> 00:18:49,520
selections

579
00:18:49,520 --> 00:18:52,080
however code 128 is potentially

580
00:18:52,080 --> 00:18:53,280
vulnerable

581
00:18:53,280 --> 00:18:55,039
the express vote implementation confirms

582
00:18:55,039 --> 00:18:56,480
the count of the barcodes

583
00:18:56,480 --> 00:18:58,799
but not their content let's look at a

584
00:18:58,799 --> 00:19:00,799
code 128 barcode

585
00:19:00,799 --> 00:19:03,520
it has a start character the data a

586
00:19:03,520 --> 00:19:06,000
check character and a stop character

587
00:19:06,000 --> 00:19:07,919
the six digit candidate identifier is

588
00:19:07,919 --> 00:19:09,919
stored in pairs as three barcode

589
00:19:09,919 --> 00:19:11,120
characters

590
00:19:11,120 --> 00:19:15,760
in 093411 this is the 34 character

591
00:19:15,760 --> 00:19:17,679
don't think of barcodes as being fat and

592
00:19:17,679 --> 00:19:19,200
thin lines or spaces

593
00:19:19,200 --> 00:19:21,120
think of them as 11 positions that can

594
00:19:21,120 --> 00:19:23,200
either be black or white

595
00:19:23,200 --> 00:19:24,960
two of the same color together looks

596
00:19:24,960 --> 00:19:27,360
like a thicker line

597
00:19:27,360 --> 00:19:29,760
34 is a good candidate for editing

598
00:19:29,760 --> 00:19:31,520
because it has a lot of white space

599
00:19:31,520 --> 00:19:36,320
where we can add black lines in 093011

600
00:19:36,320 --> 00:19:38,480
the 30 character is not a good candidate

601
00:19:38,480 --> 00:19:40,400
for editing because it has lots of black

602
00:19:40,400 --> 00:19:41,440
lines already

603
00:19:41,440 --> 00:19:43,840
and modification is additive we can't

604
00:19:43,840 --> 00:19:46,000
remove those lines

605
00:19:46,000 --> 00:19:49,280
but we can change 34 into 30 just by

606
00:19:49,280 --> 00:19:51,280
adding two lines

607
00:19:51,280 --> 00:19:54,000
but this new barcode won't be valid

608
00:19:54,000 --> 00:19:55,840
after the data portion of the barcode

609
00:19:55,840 --> 00:19:58,880
is a check character and its purpose is

610
00:19:58,880 --> 00:20:00,559
to ensure that the barcode scanner

611
00:20:00,559 --> 00:20:03,120
read the data correctly the scanner

612
00:20:03,120 --> 00:20:05,039
passes the data into a fast algorithm

613
00:20:05,039 --> 00:20:06,240
and gets a value between

614
00:20:06,240 --> 00:20:09,360
0 and 102 which it encodes as the check

615
00:20:09,360 --> 00:20:10,880
character

616
00:20:10,880 --> 00:20:12,320
if the data doesn't match the checks

617
00:20:12,320 --> 00:20:15,280
character then the scan fails

618
00:20:15,280 --> 00:20:18,320
the check character for 093411 is

619
00:20:18,320 --> 00:20:22,320
9. the check character for 09 3011

620
00:20:22,320 --> 00:20:25,520
is 1. so if we modify the 34 to become

621
00:20:25,520 --> 00:20:28,000
30 the expected check character would be

622
00:20:28,000 --> 00:20:28,559
1

623
00:20:28,559 --> 00:20:30,960
and it's not but the check character may

624
00:20:30,960 --> 00:20:32,720
also be modified

625
00:20:32,720 --> 00:20:34,960
if we add two lines to the nine it

626
00:20:34,960 --> 00:20:36,000
becomes a one

627
00:20:36,000 --> 00:20:39,039
and the resulting barcode becomes valid

628
00:20:39,039 --> 00:20:41,520
if every row of candidate names is plus

629
00:20:41,520 --> 00:20:42,640
two on the grid

630
00:20:42,640 --> 00:20:44,559
the odds are good that these two

631
00:20:44,559 --> 00:20:46,240
coordinate positions will be candidates

632
00:20:46,240 --> 00:20:48,720
in the same contest

633
00:20:48,720 --> 00:20:50,240
i wrote a program that runs through all

634
00:20:50,240 --> 00:20:52,400
the editing possibilities around 31

635
00:20:52,400 --> 00:20:54,240
percent of grid positions are editable

636
00:20:54,240 --> 00:20:55,679
like this

637
00:20:55,679 --> 00:20:57,679
of course not all columns in the grid

638
00:20:57,679 --> 00:20:59,280
are used frequently

639
00:20:59,280 --> 00:21:01,520
column one is often filled with ballot

640
00:21:01,520 --> 00:21:02,799
instructions

641
00:21:02,799 --> 00:21:05,039
column 9 is frequently used for the

642
00:21:05,039 --> 00:21:06,559
first set of contests

643
00:21:06,559 --> 00:21:09,760
and on page 1 side 1 48 out of the 99

644
00:21:09,760 --> 00:21:10,240
rows

645
00:21:10,240 --> 00:21:12,880
are editable to different positions some

646
00:21:12,880 --> 00:21:14,640
positions have several possible edits

647
00:21:14,640 --> 00:21:16,120
that could be made

648
00:21:16,120 --> 00:21:18,960
093411 can be changed to 9 other grid

649
00:21:18,960 --> 00:21:20,840
positions

650
00:21:20,840 --> 00:21:23,760
1.0811 can be changed to 26

651
00:21:23,760 --> 00:21:27,039
others have one or none

652
00:21:27,039 --> 00:21:30,000
modifying barcode 128 barcodes has

653
00:21:30,000 --> 00:21:30,799
constraints

654
00:21:30,799 --> 00:21:33,600
but it is possible i found one example

655
00:21:33,600 --> 00:21:35,039
at the bottom of the first column

656
00:21:35,039 --> 00:21:36,559
where a straight party vote for one

657
00:21:36,559 --> 00:21:38,400
party could be changed to a completely

658
00:21:38,400 --> 00:21:39,760
different party

659
00:21:39,760 --> 00:21:41,840
one modified barcode could change the

660
00:21:41,840 --> 00:21:45,679
votes in many contests

661
00:21:45,679 --> 00:21:47,440
a less refined attack would be to

662
00:21:47,440 --> 00:21:49,039
invalidate barcodes

663
00:21:49,039 --> 00:21:50,960
they could be printed as invalid but

664
00:21:50,960 --> 00:21:52,720
appear perfectly real

665
00:21:52,720 --> 00:21:54,320
they could be modified so they become

666
00:21:54,320 --> 00:21:57,760
invalid or they could simply be defaced

667
00:21:57,760 --> 00:21:59,840
the result might be that the barcode is

668
00:21:59,840 --> 00:22:00,799
ignored

669
00:22:00,799 --> 00:22:03,120
the ballot might be rejected or it might

670
00:22:03,120 --> 00:22:05,039
create an undervote opportunity

671
00:22:05,039 --> 00:22:06,559
imagine if you could invalidate one

672
00:22:06,559 --> 00:22:08,559
whole qr code while adding an alternate

673
00:22:08,559 --> 00:22:09,840
qr code

674
00:22:09,840 --> 00:22:11,360
or it could even be used to hide

675
00:22:11,360 --> 00:22:13,600
evidence of manipulation

676
00:22:13,600 --> 00:22:15,679
we'll now shift our focus to attacks on

677
00:22:15,679 --> 00:22:17,039
barcode scanners

678
00:22:17,039 --> 00:22:19,600
using barcodes an attacker could

679
00:22:19,600 --> 00:22:20,880
introduce a barcode

680
00:22:20,880 --> 00:22:24,000
which modifies the scanner settings

681
00:22:24,000 --> 00:22:26,400
commercial off-the-shelf scanners often

682
00:22:26,400 --> 00:22:28,559
allow configuration by scanning special

683
00:22:28,559 --> 00:22:29,520
barcodes

684
00:22:29,520 --> 00:22:31,039
these barcodes are not secret they're

685
00:22:31,039 --> 00:22:32,240
usually printed at the back of the

686
00:22:32,240 --> 00:22:33,280
manual

687
00:22:33,280 --> 00:22:35,280
these might be handheld scanners or

688
00:22:35,280 --> 00:22:37,200
fixed mount scanners

689
00:22:37,200 --> 00:22:39,679
thankfully most if not all of the voting

690
00:22:39,679 --> 00:22:41,760
machine tabulators on the market today

691
00:22:41,760 --> 00:22:43,760
make a full image of the ballot and then

692
00:22:43,760 --> 00:22:45,679
use software to read the barcodes from

693
00:22:45,679 --> 00:22:46,880
the image

694
00:22:46,880 --> 00:22:48,640
software can be configured in other ways

695
00:22:48,640 --> 00:22:50,480
so it has no need of these configuration

696
00:22:50,480 --> 00:22:51,679
barcodes

697
00:22:51,679 --> 00:22:53,440
so while a scanner reconfiguration

698
00:22:53,440 --> 00:22:54,960
attack on ballot tabulation

699
00:22:54,960 --> 00:22:57,760
is possible better targets would be on

700
00:22:57,760 --> 00:22:59,200
other parts of the system

701
00:22:59,200 --> 00:23:00,720
like the built-in scanners used for

702
00:23:00,720 --> 00:23:02,240
ballot activation

703
00:23:02,240 --> 00:23:04,240
or the ones used to transfer ballot

704
00:23:04,240 --> 00:23:08,000
selections from a phone

705
00:23:08,000 --> 00:23:10,000
what could be reconfigured there may be

706
00:23:10,000 --> 00:23:12,400
as many as 50 different settings

707
00:23:12,400 --> 00:23:14,000
an attacker could create denial of

708
00:23:14,000 --> 00:23:16,640
service allow additional barcode types

709
00:23:16,640 --> 00:23:18,000
to be scanned

710
00:23:18,000 --> 00:23:20,480
change how duplicate or invalid barcodes

711
00:23:20,480 --> 00:23:21,600
are handled

712
00:23:21,600 --> 00:23:24,720
allow data to span several barcodes or

713
00:23:24,720 --> 00:23:26,640
enable user-defined triggers so that

714
00:23:26,640 --> 00:23:27,760
scanning a barcode

715
00:23:27,760 --> 00:23:31,039
triggers an action like a macro

716
00:23:31,039 --> 00:23:32,880
reconfiguration might help with our next

717
00:23:32,880 --> 00:23:35,120
attack injection attacks

718
00:23:35,120 --> 00:23:36,640
many of you are familiar with other

719
00:23:36,640 --> 00:23:38,720
types of injection attacks an attacker

720
00:23:38,720 --> 00:23:40,000
sends malicious input

721
00:23:40,000 --> 00:23:42,640
that gets interpreted by the system a

722
00:23:42,640 --> 00:23:44,240
barcode is a keyboard

723
00:23:44,240 --> 00:23:46,720
as hari herste has frequently said

724
00:23:46,720 --> 00:23:48,880
barcodes can include characters commonly

725
00:23:48,880 --> 00:23:50,559
used for injections

726
00:23:50,559 --> 00:23:52,000
they can shift to different character

727
00:23:52,000 --> 00:23:54,799
sets to access special characters

728
00:23:54,799 --> 00:23:57,360
unlike reconfiguration attacks injection

729
00:23:57,360 --> 00:23:59,919
applies equally to any computer process

730
00:23:59,919 --> 00:24:02,080
that doesn't fully sanitize or allow

731
00:24:02,080 --> 00:24:04,080
list the data input

732
00:24:04,080 --> 00:24:06,080
both hardware scanners and software

733
00:24:06,080 --> 00:24:09,440
scanners may be vulnerable

734
00:24:09,440 --> 00:24:12,080
one might be able to use code 128 with

735
00:24:12,080 --> 00:24:13,520
less than 10 characters

736
00:24:13,520 --> 00:24:15,520
to send the keystrokes that are needed

737
00:24:15,520 --> 00:24:17,360
to exit the running program and launch a

738
00:24:17,360 --> 00:24:18,000
command line

739
00:24:18,000 --> 00:24:21,360
interface qr code and other formats

740
00:24:21,360 --> 00:24:23,279
may hold hundreds of characters enough

741
00:24:23,279 --> 00:24:24,880
for a small program

742
00:24:24,880 --> 00:24:26,480
this is an attack that could have a lot

743
00:24:26,480 --> 00:24:29,039
of impact

744
00:24:29,440 --> 00:24:31,120
the last set of attacks we'll look at

745
00:24:31,120 --> 00:24:33,440
are disinformation attacks

746
00:24:33,440 --> 00:24:35,520
disinformation comes in all shapes and

747
00:24:35,520 --> 00:24:37,919
sizes but barcodes are vulnerable

748
00:24:37,919 --> 00:24:40,159
because of their lack of transparency

749
00:24:40,159 --> 00:24:42,080
they're not verifiable by the voter

750
00:24:42,080 --> 00:24:43,840
even if the voter has a barcode reader

751
00:24:43,840 --> 00:24:45,200
in hand

752
00:24:45,200 --> 00:24:47,360
certainly some voters ignore them or

753
00:24:47,360 --> 00:24:48,559
just accept them

754
00:24:48,559 --> 00:24:51,039
but many voters routinely express fear

755
00:24:51,039 --> 00:24:53,279
uncertainty and doubt about them

756
00:24:53,279 --> 00:24:55,200
the seed for disinformation to latch

757
00:24:55,200 --> 00:24:56,320
onto is

758
00:24:56,320 --> 00:24:58,400
if your vote was in a barcode and the

759
00:24:58,400 --> 00:25:00,480
bar codes are what the system counts

760
00:25:00,480 --> 00:25:03,039
how do you know your ballot was cast and

761
00:25:03,039 --> 00:25:05,120
counted as you intended

762
00:25:05,120 --> 00:25:07,600
now my opinion which is only backed by

763
00:25:07,600 --> 00:25:09,679
subjective and anecdotal evidence

764
00:25:09,679 --> 00:25:12,559
is that bar codes provoke mistrust more

765
00:25:12,559 --> 00:25:15,120
than paperless dre systems do

766
00:25:15,120 --> 00:25:16,799
that's odd since paperless systems

767
00:25:16,799 --> 00:25:18,640
should be less trustworthy

768
00:25:18,640 --> 00:25:21,039
but paperless dre systems don't wave any

769
00:25:21,039 --> 00:25:23,360
red flags during the voting process

770
00:25:23,360 --> 00:25:25,440
a voter is not provoked to consider how

771
00:25:25,440 --> 00:25:27,440
the voting machine does its work

772
00:25:27,440 --> 00:25:29,440
barcodes raise the question of trust

773
00:25:29,440 --> 00:25:31,679
with a prominently placed visual

774
00:25:31,679 --> 00:25:34,080
voters can't help but notice unreadable

775
00:25:34,080 --> 00:25:35,440
glyphs on their ballot

776
00:25:35,440 --> 00:25:36,880
and they have to decide how they feel

777
00:25:36,880 --> 00:25:38,880
about them it sets the stage for

778
00:25:38,880 --> 00:25:43,120
disinformation attacks all right

779
00:25:43,120 --> 00:25:44,880
let's look now at how defenders can

780
00:25:44,880 --> 00:25:46,720
detect and mitigate these types of

781
00:25:46,720 --> 00:25:48,799
attacks

782
00:25:48,799 --> 00:25:49,760
we'll start with some things

783
00:25:49,760 --> 00:25:52,559
manufacturers of voting systems could do

784
00:25:52,559 --> 00:25:54,400
manufacturers can improve the overall

785
00:25:54,400 --> 00:25:56,480
security of bmds protect

786
00:25:56,480 --> 00:25:58,400
barcode scanners like they would any

787
00:25:58,400 --> 00:26:01,279
other port and sanitize and allow list

788
00:26:01,279 --> 00:26:03,039
all data from barcodes to protect

789
00:26:03,039 --> 00:26:04,720
against injection attacks

790
00:26:04,720 --> 00:26:06,080
and they can prevent scanner

791
00:26:06,080 --> 00:26:08,559
reconfiguration in the field

792
00:26:08,559 --> 00:26:10,320
their systems should not re-expose

793
00:26:10,320 --> 00:26:12,000
printed ballots to printers

794
00:26:12,000 --> 00:26:13,760
there should not be a single paper path

795
00:26:13,760 --> 00:26:15,679
that gets reused

796
00:26:15,679 --> 00:26:17,840
most importantly they should design

797
00:26:17,840 --> 00:26:20,080
systems to confirm the integrity and

798
00:26:20,080 --> 00:26:21,840
authenticity of data coming from

799
00:26:21,840 --> 00:26:22,960
barcodes

800
00:26:22,960 --> 00:26:25,120
and in a strong way that considers

801
00:26:25,120 --> 00:26:26,880
adversarial attacks

802
00:26:26,880 --> 00:26:29,279
that may mean public key cryptography

803
00:26:29,279 --> 00:26:31,120
and it may require working out good key

804
00:26:31,120 --> 00:26:33,120
management practices

805
00:26:33,120 --> 00:26:34,559
and working to make barcodes more

806
00:26:34,559 --> 00:26:36,320
transparent and interoperable

807
00:26:36,320 --> 00:26:39,520
would help to make them more trustworthy

808
00:26:39,520 --> 00:26:41,039
jurisdictions can do a lot to protect

809
00:26:41,039 --> 00:26:42,960
the systems they already have

810
00:26:42,960 --> 00:26:44,720
they should think first about resilience

811
00:26:44,720 --> 00:26:47,120
planning a huge vulnerability

812
00:26:47,120 --> 00:26:48,799
is that a malfunctioning ballot marking

813
00:26:48,799 --> 00:26:50,640
device can't write barcodes

814
00:26:50,640 --> 00:26:52,400
and a malfunctioning tabulator can't

815
00:26:52,400 --> 00:26:54,880
read them if a machine needs to be taken

816
00:26:54,880 --> 00:26:55,919
out of service

817
00:26:55,919 --> 00:26:57,840
jurisdictions should have a backup plan

818
00:26:57,840 --> 00:26:59,679
that's ready to go

819
00:26:59,679 --> 00:27:01,200
jurisdiction should ensure that ballot

820
00:27:01,200 --> 00:27:02,799
marking devices have good physical

821
00:27:02,799 --> 00:27:04,960
security and chain of custody measures

822
00:27:04,960 --> 00:27:06,400
especially during voting machine

823
00:27:06,400 --> 00:27:08,320
sleepovers and a polling place

824
00:27:08,320 --> 00:27:09,919
don't assume that the bmd is less

825
00:27:09,919 --> 00:27:11,919
critical than the tabulator

826
00:27:11,919 --> 00:27:14,080
they should encourage voter verification

827
00:27:14,080 --> 00:27:15,919
of all bmd printed ballots

828
00:27:15,919 --> 00:27:18,480
to detect errors and anomalies this can

829
00:27:18,480 --> 00:27:20,000
be done with signage and with poll

830
00:27:20,000 --> 00:27:21,200
worker prompting

831
00:27:21,200 --> 00:27:23,440
they can't and won't detect everything

832
00:27:23,440 --> 00:27:26,000
but studies show that it does help

833
00:27:26,000 --> 00:27:27,679
poll workers can be trained on potential

834
00:27:27,679 --> 00:27:30,000
barcode issues and jurisdictions can

835
00:27:30,000 --> 00:27:32,240
advocate for legislation and policies

836
00:27:32,240 --> 00:27:34,720
that define the official vote this is

837
00:27:34,720 --> 00:27:36,399
important because one issue barcodes

838
00:27:36,399 --> 00:27:36,960
create

839
00:27:36,960 --> 00:27:39,279
which hasn't existed previously is that

840
00:27:39,279 --> 00:27:41,279
a single piece of paper contains

841
00:27:41,279 --> 00:27:43,600
two separate representations of a vote

842
00:27:43,600 --> 00:27:44,720
the barcode version

843
00:27:44,720 --> 00:27:46,640
and the text version if they match

844
00:27:46,640 --> 00:27:48,320
there's not a problem but if the

845
00:27:48,320 --> 00:27:49,919
barcodes in the human readable text

846
00:27:49,919 --> 00:27:50,799
don't match

847
00:27:50,799 --> 00:27:52,720
it needs to be legally clear which one

848
00:27:52,720 --> 00:27:54,720
should govern in most places the law

849
00:27:54,720 --> 00:27:57,360
doesn't consider that possibility yet

850
00:27:57,360 --> 00:28:00,000
and accordingly any recounts of the

851
00:28:00,000 --> 00:28:00,640
ballots

852
00:28:00,640 --> 00:28:03,840
should use the text as the official vote

853
00:28:03,840 --> 00:28:06,000
and by far the best way to mitigate any

854
00:28:06,000 --> 00:28:07,760
attacks that change election outcomes

855
00:28:07,760 --> 00:28:09,840
is with post-election audits they

856
00:28:09,840 --> 00:28:12,640
prevent tabulation errors of all kinds

857
00:28:12,640 --> 00:28:14,559
the gold standard is risk limiting

858
00:28:14,559 --> 00:28:16,000
audits which are efficient

859
00:28:16,000 --> 00:28:17,919
but also tied to the margin of victory

860
00:28:17,919 --> 00:28:19,440
so that you test more ballots when a

861
00:28:19,440 --> 00:28:21,360
race is close than when it's not

862
00:28:21,360 --> 00:28:23,200
any audit of ballots with barcodes

863
00:28:23,200 --> 00:28:25,200
should examine the human readable text

864
00:28:25,200 --> 00:28:26,320
on the paper

865
00:28:26,320 --> 00:28:28,840
by the hand-eye method and not the

866
00:28:28,840 --> 00:28:30,960
barcodes the more contests that are

867
00:28:30,960 --> 00:28:31,600
audited

868
00:28:31,600 --> 00:28:34,640
the more protection an election has

869
00:28:34,640 --> 00:28:37,360
so in conclusion are barcodes on ballots

870
00:28:37,360 --> 00:28:38,399
bad

871
00:28:38,399 --> 00:28:40,480
as we've seen barcodes introduce new

872
00:28:40,480 --> 00:28:42,640
attack surface and new risks

873
00:28:42,640 --> 00:28:44,720
many of those risks can be mitigated or

874
00:28:44,720 --> 00:28:46,640
managed but we have to actually do it

875
00:28:46,640 --> 00:28:48,559
and there are gaps at the moment

876
00:28:48,559 --> 00:28:50,240
the hardest issue to mitigate is the

877
00:28:50,240 --> 00:28:51,840
lack of transparency

878
00:28:51,840 --> 00:28:53,200
this is the primary reason i'm

879
00:28:53,200 --> 00:28:55,279
personally not in favor of barcodes

880
00:28:55,279 --> 00:28:57,520
it's not the risks or the attacks

881
00:28:57,520 --> 00:28:59,440
barcodes make voters uneasy

882
00:28:59,440 --> 00:29:01,279
i've heard it from many voters they

883
00:29:01,279 --> 00:29:02,720
worry that the system could be doing

884
00:29:02,720 --> 00:29:04,559
slight of hand or pulling a fast one on

885
00:29:04,559 --> 00:29:05,039
them

886
00:29:05,039 --> 00:29:07,120
you may have that gut feeling yourself i

887
00:29:07,120 --> 00:29:08,240
understand it

888
00:29:08,240 --> 00:29:10,159
to me that runs counter to our goal of

889
00:29:10,159 --> 00:29:12,960
building trust in elections

890
00:29:12,960 --> 00:29:14,080
there are two voting system

891
00:29:14,080 --> 00:29:16,399
manufacturers who do not put votes in

892
00:29:16,399 --> 00:29:17,120
barcodes

893
00:29:17,120 --> 00:29:19,360
heart and clear ballot so barcodes

894
00:29:19,360 --> 00:29:21,520
aren't a necessity

895
00:29:21,520 --> 00:29:24,080
in 2019 the state of colorado announced

896
00:29:24,080 --> 00:29:25,679
that after 2021

897
00:29:25,679 --> 00:29:27,520
they would no longer certify voting

898
00:29:27,520 --> 00:29:30,480
systems that tabulate using barcodes

899
00:29:30,480 --> 00:29:32,480
as a result dominion modified the image

900
00:29:32,480 --> 00:29:34,720
cast x bmd used in colorado

901
00:29:34,720 --> 00:29:36,720
so that it fills in the ovals on a mark

902
00:29:36,720 --> 00:29:37,840
sense ballot

903
00:29:37,840 --> 00:29:39,760
instead of using a qr code like the

904
00:29:39,760 --> 00:29:42,080
ballot that we deconstructed

905
00:29:42,080 --> 00:29:43,679
i realized security is not the only

906
00:29:43,679 --> 00:29:45,279
consideration in making a choice like

907
00:29:45,279 --> 00:29:46,320
colorado's

908
00:29:46,320 --> 00:29:48,880
but with one action it took barcodes off

909
00:29:48,880 --> 00:29:49,679
of the ballots

910
00:29:49,679 --> 00:29:51,200
and reduced all of the risks that we've

911
00:29:51,200 --> 00:29:53,360
looked at today

912
00:29:53,360 --> 00:29:57,678
thank you very much

