1
00:00:44,960 --> 00:00:53,600
[Music]

2
00:00:53,600 --> 00:00:54,399
everyone

3
00:00:54,399 --> 00:00:56,800
this is my first defcon but i'm not a

4
00:00:56,800 --> 00:00:59,680
youngling so please don't be gentle

5
00:00:59,680 --> 00:01:01,199
i need to touch a frying pan at least

6
00:01:01,199 --> 00:01:02,800
twice to confirm it's hot

7
00:01:02,800 --> 00:01:04,319
the second time to confirm that the

8
00:01:04,319 --> 00:01:06,880
first wasn't a trick or an illusion

9
00:01:06,880 --> 00:01:08,320
i'm gonna be totally blunt about

10
00:01:08,320 --> 00:01:10,159
something right now

11
00:01:10,159 --> 00:01:12,720
there is zero new information in this

12
00:01:12,720 --> 00:01:13,760
talk

13
00:01:13,760 --> 00:01:16,960
none at all killer intro right

14
00:01:16,960 --> 00:01:19,759
well at one point in history clocks were

15
00:01:19,759 --> 00:01:21,840
a very commonplace item

16
00:01:21,840 --> 00:01:24,479
bells were also a very commonplace item

17
00:01:24,479 --> 00:01:25,520
someone eventually

18
00:01:25,520 --> 00:01:28,000
put a bell on a clock and the modern

19
00:01:28,000 --> 00:01:29,759
alarm clock emerged

20
00:01:29,759 --> 00:01:32,400
nothing new suddenly as common folks are

21
00:01:32,400 --> 00:01:34,880
able to wake up on time for our lives

22
00:01:34,880 --> 00:01:36,479
the jury is still out whether that was a

23
00:01:36,479 --> 00:01:38,400
net benefit to humanity or not

24
00:01:38,400 --> 00:01:40,079
but you can't argue that it's an

25
00:01:40,079 --> 00:01:41,759
extremely useful artifact to come

26
00:01:41,759 --> 00:01:45,200
come from combining two household items

27
00:01:45,200 --> 00:01:46,560
but today i want to talk to you about

28
00:01:46,560 --> 00:01:48,720
some creative munching

29
00:01:48,720 --> 00:01:51,600
there are incredibly gnarly see i'm not

30
00:01:51,600 --> 00:01:52,720
young

31
00:01:52,720 --> 00:01:55,040
instances of innovation by combination

32
00:01:55,040 --> 00:01:56,479
throughout history

33
00:01:56,479 --> 00:01:58,560
at one point someone wondered why we

34
00:01:58,560 --> 00:02:00,960
push around pineapples and bags of flour

35
00:02:00,960 --> 00:02:03,040
and grocery store and wheeled buggies

36
00:02:03,040 --> 00:02:04,399
like royalty

37
00:02:04,399 --> 00:02:06,960
but we carry our equally heavy or

38
00:02:06,960 --> 00:02:09,520
heavier suitcases while traveling

39
00:02:09,520 --> 00:02:11,120
and now it's hard to find a suitcase

40
00:02:11,120 --> 00:02:12,879
without wheels recently

41
00:02:12,879 --> 00:02:14,400
really smart people have basically

42
00:02:14,400 --> 00:02:16,800
combined wifi and cellular tech to give

43
00:02:16,800 --> 00:02:18,319
us 5g

44
00:02:18,319 --> 00:02:21,280
going back a lot further in the 1400s a

45
00:02:21,280 --> 00:02:22,000
german hacker

46
00:02:22,000 --> 00:02:24,000
named johannes gutenberg probably

47
00:02:24,000 --> 00:02:25,840
unrelated to our founder leonard coopman

48
00:02:25,840 --> 00:02:26,400
but

49
00:02:26,400 --> 00:02:27,840
we'll just assume the hacking community

50
00:02:27,840 --> 00:02:29,440
in germany is pretty tight so they're

51
00:02:29,440 --> 00:02:30,879
probably descendants or time travel

52
00:02:30,879 --> 00:02:32,160
buddies or something

53
00:02:32,160 --> 00:02:35,599
anyway 600 years ago german hacker

54
00:02:35,599 --> 00:02:38,400
combined a coin punch device with the

55
00:02:38,400 --> 00:02:39,120
concept

56
00:02:39,120 --> 00:02:42,319
of setting type from a winepress machine

57
00:02:42,319 --> 00:02:44,000
and this led to the mechanical printing

58
00:02:44,000 --> 00:02:47,040
press this means humanity went from

59
00:02:47,040 --> 00:02:50,319
printing 40 pages a day by hand copying

60
00:02:50,319 --> 00:02:53,040
exactly only a few pages per day

61
00:02:53,040 --> 00:02:55,360
so now we're capable of 3 600 pages per

62
00:02:55,360 --> 00:02:56,959
day the dawn of the information

63
00:02:56,959 --> 00:02:59,840
age back then when you can print a book

64
00:02:59,840 --> 00:03:00,159
at

65
00:03:00,159 --> 00:03:03,120
speed at scale obviously you print the

66
00:03:03,120 --> 00:03:04,400
bible

67
00:03:04,400 --> 00:03:05,519
the rest of that story is actually

68
00:03:05,519 --> 00:03:07,440
pretty fascinating as well so like any

69
00:03:07,440 --> 00:03:07,840
good

70
00:03:07,840 --> 00:03:12,080
researcher he disclosed his year 1450

71
00:03:12,080 --> 00:03:14,800
zero day mechanical printing press

72
00:03:14,800 --> 00:03:18,720
thought exploit bible churning machine

73
00:03:18,720 --> 00:03:21,440
and his investors took over the company

74
00:03:21,440 --> 00:03:22,560
and nose-dived it

75
00:03:22,560 --> 00:03:24,480
to the ground they even brought him back

76
00:03:24,480 --> 00:03:25,920
on board like halfway through that nose

77
00:03:25,920 --> 00:03:27,519
dive just to make sure he was also

78
00:03:27,519 --> 00:03:31,040
financially wrecked so yeah cool tech

79
00:03:31,040 --> 00:03:33,040
vc's flocked in everyone gets high on

80
00:03:33,040 --> 00:03:34,400
the smell of money

81
00:03:34,400 --> 00:03:36,000
they come down harshly from that high

82
00:03:36,000 --> 00:03:38,400
and now there's no cool tech anymore

83
00:03:38,400 --> 00:03:39,840
clearly this move wasn't invented in the

84
00:03:39,840 --> 00:03:41,760
valley crappy ending for gutenberg but a

85
00:03:41,760 --> 00:03:43,040
cool story either way so we got the

86
00:03:43,040 --> 00:03:44,879
printing press

87
00:03:44,879 --> 00:03:46,879
innovation through confirmation has been

88
00:03:46,879 --> 00:03:48,159
a really cool part of our technical

89
00:03:48,159 --> 00:03:49,280
history

90
00:03:49,280 --> 00:03:51,200
i just said hour and i haven't even

91
00:03:51,200 --> 00:03:52,480
mentioned who i am

92
00:03:52,480 --> 00:03:55,439
hi my name is abe i am in charge of

93
00:03:55,439 --> 00:03:56,799
making sure that everyone has a good

94
00:03:56,799 --> 00:03:58,239
time with greylog after they've joined

95
00:03:58,239 --> 00:03:59,439
the greylog family

96
00:03:59,439 --> 00:04:00,480
in other words i run the training

97
00:04:00,480 --> 00:04:02,879
department i wasn't always just a

98
00:04:02,879 --> 00:04:04,480
meat-based instructional video though

99
00:04:04,480 --> 00:04:05,920
i've actually been in cyber security for

100
00:04:05,920 --> 00:04:06,720
quite a while now

101
00:04:06,720 --> 00:04:08,720
i got my start in the 90s the same way

102
00:04:08,720 --> 00:04:10,319
that most people did

103
00:04:10,319 --> 00:04:12,000
with an internet connection a gross

104
00:04:12,000 --> 00:04:13,360
underestimation of authority and a

105
00:04:13,360 --> 00:04:15,280
misspent youth

106
00:04:15,280 --> 00:04:17,279
i'm always so glad my mom kept newspaper

107
00:04:17,279 --> 00:04:18,720
clippings

108
00:04:18,720 --> 00:04:21,519
you know pixar didn't happen right so as

109
00:04:21,519 --> 00:04:23,199
i grew up those exact character traits

110
00:04:23,199 --> 00:04:26,000
led to a segment of organized crime

111
00:04:26,000 --> 00:04:27,680
a very particular branch of organized

112
00:04:27,680 --> 00:04:30,479
crime where i did some cyber insecurity

113
00:04:30,479 --> 00:04:31,600
things for big brother

114
00:04:31,600 --> 00:04:33,440
really though it's it's canadian big

115
00:04:33,440 --> 00:04:34,960
brother so it's really charming with

116
00:04:34,960 --> 00:04:37,280
above average quality of music

117
00:04:37,280 --> 00:04:38,880
after that i worked in i.t and

118
00:04:38,880 --> 00:04:40,560
operations for another government entity

119
00:04:40,560 --> 00:04:41,680
local government

120
00:04:41,680 --> 00:04:44,320
than in true i.t fashion as we always

121
00:04:44,320 --> 00:04:45,759
plan for our senior engineers and

122
00:04:45,759 --> 00:04:47,440
analysts getting hit by a bus

123
00:04:47,440 --> 00:04:49,360
but in reality they get hit by a better

124
00:04:49,360 --> 00:04:51,280
offer so it was my turn to get hit and

125
00:04:51,280 --> 00:04:52,160
here i am

126
00:04:52,160 --> 00:04:53,680
i'll let the young and hungry keep their

127
00:04:53,680 --> 00:04:55,440
pagers or slack dms or whatever you

128
00:04:55,440 --> 00:04:56,960
carry now for late night operations

129
00:04:56,960 --> 00:04:57,680
calls

130
00:04:57,680 --> 00:04:59,360
i'll build terrible power points like a

131
00:04:59,360 --> 00:05:01,199
proper manager talk me down on the

132
00:05:01,199 --> 00:05:02,560
socials if you have any questions about

133
00:05:02,560 --> 00:05:04,240
my history that you want me to ignore or

134
00:05:04,240 --> 00:05:06,639
to send me memes memes days muse for

135
00:05:06,639 --> 00:05:08,240
games memes for days

136
00:05:08,240 --> 00:05:09,600
led the internet okay i'm off track

137
00:05:09,600 --> 00:05:11,759
again hi i'm abe from graylog i'm the

138
00:05:11,759 --> 00:05:12,560
trainer there

139
00:05:12,560 --> 00:05:15,680
there enough introductions

140
00:05:15,759 --> 00:05:19,039
i've titled this talk log jamming log

141
00:05:19,039 --> 00:05:20,880
jamming means a couple different things

142
00:05:20,880 --> 00:05:22,880
first it's a bunch of logs jammed

143
00:05:22,880 --> 00:05:25,039
together literally

144
00:05:25,039 --> 00:05:27,360
since i work for a software company that

145
00:05:27,360 --> 00:05:28,800
earns revenue

146
00:05:28,800 --> 00:05:30,960
when you send in more logs yep go ahead

147
00:05:30,960 --> 00:05:32,479
and literally send them all until it's

148
00:05:32,479 --> 00:05:33,600
jammed and we'll figure it out and make

149
00:05:33,600 --> 00:05:34,639
it bigger

150
00:05:34,639 --> 00:05:37,759
second it means an impasse or a deadlock

151
00:05:37,759 --> 00:05:39,120
in other words you've encountered a

152
00:05:39,120 --> 00:05:41,840
situation that simply can't be overcome

153
00:05:41,840 --> 00:05:44,000
in the famous words of walt disney it's

154
00:05:44,000 --> 00:05:46,080
kind of fun to do the impossible

155
00:05:46,080 --> 00:05:46,880
well we're not going to do the

156
00:05:46,880 --> 00:05:48,960
impossible today but so we'll walk it

157
00:05:48,960 --> 00:05:50,320
back to another quote this one's from

158
00:05:50,320 --> 00:05:51,360
steve jobs

159
00:05:51,360 --> 00:05:54,479
creativity is just connecting things

160
00:05:54,479 --> 00:05:56,000
in our case we're going to use log

161
00:05:56,000 --> 00:05:57,840
jamming to overcome

162
00:05:57,840 --> 00:06:00,720
our log jamming this talk is breaking

163
00:06:00,720 --> 00:06:02,240
down some of the highlight reel over my

164
00:06:02,240 --> 00:06:03,360
last few years

165
00:06:03,360 --> 00:06:04,560
dealing with security analytics

166
00:06:04,560 --> 00:06:06,800
platforms centralized event management

167
00:06:06,800 --> 00:06:07,919
i'm going to reiterate the challenge of

168
00:06:07,919 --> 00:06:10,000
this talk to show you stuff without

169
00:06:10,000 --> 00:06:11,280
really showing you anything new or

170
00:06:11,280 --> 00:06:12,160
groundbreaking at all

171
00:06:12,160 --> 00:06:14,639
just different uses of old i'll start

172
00:06:14,639 --> 00:06:15,840
with my first tale it's one of my

173
00:06:15,840 --> 00:06:17,120
favorite tales actually

174
00:06:17,120 --> 00:06:19,280
sadly it's a project and the project

175
00:06:19,280 --> 00:06:21,280
kind of fell apart for sort of unrelated

176
00:06:21,280 --> 00:06:22,639
lawyering reasons

177
00:06:22,639 --> 00:06:24,560
and the motivated entities on both sides

178
00:06:24,560 --> 00:06:26,160
parted ways but the good bits are what

179
00:06:26,160 --> 00:06:27,360
i'll focus on

180
00:06:27,360 --> 00:06:30,000
so the backdrop a former employer had a

181
00:06:30,000 --> 00:06:31,840
program called teaching cities

182
00:06:31,840 --> 00:06:33,680
part of a much larger provincial or

183
00:06:33,680 --> 00:06:35,120
federal initiative incurring

184
00:06:35,120 --> 00:06:37,440
encouraging local government bodies to

185
00:06:37,440 --> 00:06:38,400
enable

186
00:06:38,400 --> 00:06:41,199
their local government things to be used

187
00:06:41,199 --> 00:06:42,639
helping academics in the future

188
00:06:42,639 --> 00:06:43,919
generations

189
00:06:43,919 --> 00:06:45,600
in other words the school kids get their

190
00:06:45,600 --> 00:06:47,680
hands dirty great initiative i think

191
00:06:47,680 --> 00:06:48,560
it's super

192
00:06:48,560 --> 00:06:51,199
mega cool engineering students go out

193
00:06:51,199 --> 00:06:52,720
and do their engineers

194
00:06:52,720 --> 00:06:55,520
sorcery on wastewater management or

195
00:06:55,520 --> 00:06:58,720
civil construction projects etc

196
00:06:58,720 --> 00:07:00,319
there's a technical university with a

197
00:07:00,319 --> 00:07:02,720
really solid future leaning reputation

198
00:07:02,720 --> 00:07:03,919
in the same city as

199
00:07:03,919 --> 00:07:06,240
my former employer this particular

200
00:07:06,240 --> 00:07:08,160
school has quite a blossoming security

201
00:07:08,160 --> 00:07:08,639
program

202
00:07:08,639 --> 00:07:10,319
actually set of programs at a variety of

203
00:07:10,319 --> 00:07:12,639
levels associates bachelors masters

204
00:07:12,639 --> 00:07:13,440
whatever

205
00:07:13,440 --> 00:07:15,199
you can go get your degree and hack the

206
00:07:15,199 --> 00:07:17,039
planetology and do your thesis

207
00:07:17,039 --> 00:07:19,280
on on cracking gibsons or you know

208
00:07:19,280 --> 00:07:20,319
nerdery ah

209
00:07:20,319 --> 00:07:21,840
ahs on a loop whatever happens behind

210
00:07:21,840 --> 00:07:24,080
the curtains i haven't gone so

211
00:07:24,080 --> 00:07:25,520
so we have teaching cities encouraging

212
00:07:25,520 --> 00:07:27,520
the use of city resources and a hacker

213
00:07:27,520 --> 00:07:28,720
school across town

214
00:07:28,720 --> 00:07:31,440
this sounds awesome the institution

215
00:07:31,440 --> 00:07:32,720
approached us with the idea of putting

216
00:07:32,720 --> 00:07:34,880
some dirty rusty old

217
00:07:34,880 --> 00:07:36,720
box on the outer edge of our network and

218
00:07:36,720 --> 00:07:39,039
and seeing if if they can come at it

219
00:07:39,039 --> 00:07:42,639
cool concept but a single made dupont

220
00:07:42,639 --> 00:07:44,639
server just sounds boring right

221
00:07:44,639 --> 00:07:47,120
ctf with a single flag come on it was

222
00:07:47,120 --> 00:07:48,319
very little work but had very little

223
00:07:48,319 --> 00:07:49,919
gain i'm a much bigger fan of like the

224
00:07:49,919 --> 00:07:51,680
train like you fight model

225
00:07:51,680 --> 00:07:54,240
so my response was hey university

226
00:07:54,240 --> 00:07:55,919
institution people

227
00:07:55,919 --> 00:07:57,280
why don't you just poke around our

228
00:07:57,280 --> 00:07:59,520
perimeter network use the public ip

229
00:07:59,520 --> 00:08:01,039
space and in exchange for this

230
00:08:01,039 --> 00:08:02,400
program and this relationship staying

231
00:08:02,400 --> 00:08:04,560
alive give me a report on anything you

232
00:08:04,560 --> 00:08:05,599
find

233
00:08:05,599 --> 00:08:07,360
basically it's like using interns in a

234
00:08:07,360 --> 00:08:09,199
bug bounty program

235
00:08:09,199 --> 00:08:11,280
anyone who smashes through a perimeter

236
00:08:11,280 --> 00:08:13,360
during an introductory university level

237
00:08:13,360 --> 00:08:14,400
hacker course

238
00:08:14,400 --> 00:08:16,160
is a person that we should be handing a

239
00:08:16,160 --> 00:08:18,720
job offer to

240
00:08:18,720 --> 00:08:21,039
my first pitch was met with resistance

241
00:08:21,039 --> 00:08:22,160
actually a hilarious amount of

242
00:08:22,160 --> 00:08:23,120
resistance like

243
00:08:23,120 --> 00:08:25,199
bug bound user and established practice

244
00:08:25,199 --> 00:08:26,800
abusing interns is an established

245
00:08:26,800 --> 00:08:27,759
practice

246
00:08:27,759 --> 00:08:29,919
i mean they even get paid in exposure or

247
00:08:29,919 --> 00:08:31,360
whatever we call nothing tokens these

248
00:08:31,360 --> 00:08:32,399
days

249
00:08:32,399 --> 00:08:34,320
bug bounties exist internships exist but

250
00:08:34,320 --> 00:08:36,159
nope we absolutely cannot use interns in

251
00:08:36,159 --> 00:08:37,760
our bug bounty program

252
00:08:37,760 --> 00:08:40,479
so let me get this straight we let

253
00:08:40,479 --> 00:08:41,440
inexperienced

254
00:08:41,440 --> 00:08:43,200
untrained university students build

255
00:08:43,200 --> 00:08:45,600
bridges over water and expand gas lines

256
00:08:45,600 --> 00:08:46,080
and run

257
00:08:46,080 --> 00:08:48,240
full ecological maintenance cycles on

258
00:08:48,240 --> 00:08:50,320
forests and park lands

259
00:08:50,320 --> 00:08:51,920
but letting them poke at a segmented web

260
00:08:51,920 --> 00:08:53,440
server is too risky huh

261
00:08:53,440 --> 00:08:57,200
what because cyber and no one knows what

262
00:08:57,200 --> 00:08:58,000
we do here

263
00:08:58,000 --> 00:09:00,240
fair enough we've all been there so

264
00:09:00,240 --> 00:09:01,760
myself a couple of the profs some of the

265
00:09:01,760 --> 00:09:03,440
teaching cities folks anyway we all

266
00:09:03,440 --> 00:09:04,880
listened to the concerns addressed them

267
00:09:04,880 --> 00:09:06,880
like adults and got underway

268
00:09:06,880 --> 00:09:08,399
the first run of the program went

269
00:09:08,399 --> 00:09:10,080
exactly like this like the point is the

270
00:09:10,080 --> 00:09:12,320
proof of concept my phone rings at my

271
00:09:12,320 --> 00:09:14,000
desk one random afternoon

272
00:09:14,000 --> 00:09:17,920
and i'll i'll put on my prop at prop

273
00:09:17,920 --> 00:09:20,720
okay group one is going to run a basic

274
00:09:20,720 --> 00:09:23,519
vulnerability scan

275
00:09:23,519 --> 00:09:26,959
cool all right i'll watch the logs

276
00:09:31,360 --> 00:09:33,440
oh i see it i see it oh oh no never mind

277
00:09:33,440 --> 00:09:34,640
that's just some

278
00:09:34,640 --> 00:09:36,880
some you know internet wide scanner in

279
00:09:36,880 --> 00:09:38,320
france

280
00:09:38,320 --> 00:09:40,240
oh i see it now i see no nope that's

281
00:09:40,240 --> 00:09:42,160
that shady printer and accounting that

282
00:09:42,160 --> 00:09:43,839
port scans the lan every time it prints

283
00:09:43,839 --> 00:09:45,600
for some reason

284
00:09:45,600 --> 00:09:48,080
hang on

285
00:09:49,040 --> 00:09:50,959
oh there oh no that's that's not it

286
00:09:50,959 --> 00:09:52,160
either

287
00:09:52,160 --> 00:09:53,200
and then i promptly forgot what i was

288
00:09:53,200 --> 00:09:54,160
working on and walked away into a

289
00:09:54,160 --> 00:09:55,760
meeting sorry group one

290
00:09:55,760 --> 00:09:58,000
later on that day phone rings profit oh

291
00:09:58,000 --> 00:09:59,360
i guess we lost you group

292
00:09:59,360 --> 00:10:01,519
two is going to go now ah excellent yeah

293
00:10:01,519 --> 00:10:03,839
let's do this i'm watching the logs oh

294
00:10:03,839 --> 00:10:04,880
group 2 isn't

295
00:10:04,880 --> 00:10:08,240
quite ready yet okay waiting they're

296
00:10:08,240 --> 00:10:10,399
having issues running their 8th and 9th

297
00:10:10,399 --> 00:10:12,720
windows server vm on this refurbished

298
00:10:12,720 --> 00:10:15,200
chromebook

299
00:10:16,839 --> 00:10:19,200
okay i know this time i walked away on

300
00:10:19,200 --> 00:10:20,160
purpose

301
00:10:20,160 --> 00:10:21,920
bone rings again later we'll get it

302
00:10:21,920 --> 00:10:23,680
sorted for group three yeah sorry dude

303
00:10:23,680 --> 00:10:24,880
it's coffee time i'm out

304
00:10:24,880 --> 00:10:27,200
no work on break time you get the idea

305
00:10:27,200 --> 00:10:28,880
from like my crystal clear

306
00:10:28,880 --> 00:10:31,360
acting like crystal clear acting so like

307
00:10:31,360 --> 00:10:32,640
hollywood if you're watching i'll stand

308
00:10:32,640 --> 00:10:34,320
in for the rock or jason mamoa whatever

309
00:10:34,320 --> 00:10:35,200
you need

310
00:10:35,200 --> 00:10:36,640
but uh the summary of this initial

311
00:10:36,640 --> 00:10:38,240
experiment there were technical

312
00:10:38,240 --> 00:10:39,200
limitations on

313
00:10:39,200 --> 00:10:41,680
on mostly on the college student side

314
00:10:41,680 --> 00:10:43,040
with equipment difficulties and

315
00:10:43,040 --> 00:10:44,399
networking difficulties from time to

316
00:10:44,399 --> 00:10:44,800
time

317
00:10:44,800 --> 00:10:46,480
the occasional disinterested student

318
00:10:46,480 --> 00:10:47,920
group and really what

319
00:10:47,920 --> 00:10:49,760
like the ultimate way on the project was

320
00:10:49,760 --> 00:10:51,360
that it turned into a huge time

321
00:10:51,360 --> 00:10:52,800
commitment on my end

322
00:10:52,800 --> 00:10:55,839
for what was largely a pet project so

323
00:10:55,839 --> 00:10:57,760
i had actual things to manage and actual

324
00:10:57,760 --> 00:10:59,040
security stuff to do

325
00:10:59,040 --> 00:11:01,360
so this was not going to keep the higher

326
00:11:01,360 --> 00:11:03,440
ups at the office happy for very long

327
00:11:03,440 --> 00:11:06,000
this needed to improve

328
00:11:06,000 --> 00:11:07,760
i actually kind of you know sitting back

329
00:11:07,760 --> 00:11:09,279
and doing like a problem analysis i saw

330
00:11:09,279 --> 00:11:10,800
two big problems with this

331
00:11:10,800 --> 00:11:12,640
one i was the broker for the actual

332
00:11:12,640 --> 00:11:14,160
information they needed this meant i was

333
00:11:14,160 --> 00:11:15,120
basically stuck

334
00:11:15,120 --> 00:11:18,320
sitting there being a live analyst as i

335
00:11:18,320 --> 00:11:19,680
was the one with the access to the log

336
00:11:19,680 --> 00:11:21,040
data and could interpret it

337
00:11:21,040 --> 00:11:23,440
so i could potentially expose the entire

338
00:11:23,440 --> 00:11:25,040
stream of log data to the classroom or

339
00:11:25,040 --> 00:11:26,720
whatever but that would probably have

340
00:11:26,720 --> 00:11:28,399
some pretty far-reaching and

341
00:11:28,399 --> 00:11:32,320
obvious information concerns second

342
00:11:32,320 --> 00:11:34,000
i need to actually isolate the campus

343
00:11:34,000 --> 00:11:36,160
data you know the from the the public

344
00:11:36,160 --> 00:11:37,839
scanner from france or whatever i need

345
00:11:37,839 --> 00:11:39,279
to i need to

346
00:11:39,279 --> 00:11:41,920
keep those people out and separate in

347
00:11:41,920 --> 00:11:43,120
one way or another so i wasn't doing

348
00:11:43,120 --> 00:11:45,120
analysis on the entire public internet

349
00:11:45,120 --> 00:11:47,760
while trying to give them feedback and

350
00:11:47,760 --> 00:11:49,120
when i say all of this

351
00:11:49,120 --> 00:11:50,399
most of the people watching this video

352
00:11:50,399 --> 00:11:52,560
from defcon there's a ton of noise on an

353
00:11:52,560 --> 00:11:54,079
internet-facing system even at just the

354
00:11:54,079 --> 00:11:55,279
firewall level

355
00:11:55,279 --> 00:11:57,440
and 20 of that noise is probably from

356
00:11:57,440 --> 00:12:00,800
people attending these talks right now

357
00:12:00,959 --> 00:12:02,399
more than half of that being actual

358
00:12:02,399 --> 00:12:04,079
exploitation definitely coming from

359
00:12:04,079 --> 00:12:04,639
people

360
00:12:04,639 --> 00:12:07,600
at this event anyway the uh you all

361
00:12:07,600 --> 00:12:09,519
caused that noise the hackers ruined my

362
00:12:09,519 --> 00:12:10,079
day

363
00:12:10,079 --> 00:12:11,360
at least when i was a fed or a

364
00:12:11,360 --> 00:12:12,800
rent-a-cop version of a fed silly

365
00:12:12,800 --> 00:12:14,000
hackers

366
00:12:14,000 --> 00:12:16,639
so i needed to conjure up the relevant

367
00:12:16,639 --> 00:12:17,680
data

368
00:12:17,680 --> 00:12:19,680
and separate it from the fluff and i

369
00:12:19,680 --> 00:12:21,680
needed to communicate that effectively

370
00:12:21,680 --> 00:12:22,000
and

371
00:12:22,000 --> 00:12:24,480
preferably asynchronously to my own life

372
00:12:24,480 --> 00:12:25,920
and and commitments

373
00:12:25,920 --> 00:12:27,680
in other words i needed to automate that

374
00:12:27,680 --> 00:12:29,200
shiz

375
00:12:29,200 --> 00:12:30,959
the problem one was kind of half solved

376
00:12:30,959 --> 00:12:32,160
with something as easy as a slack

377
00:12:32,160 --> 00:12:33,440
channel so that's halfway through

378
00:12:33,440 --> 00:12:34,240
problem one

379
00:12:34,240 --> 00:12:35,920
easy enough now i can ignore boring

380
00:12:35,920 --> 00:12:37,519
actual work meetings and you know

381
00:12:37,519 --> 00:12:39,120
chat away to cool baby call it hacker

382
00:12:39,120 --> 00:12:40,880
college kids so we're halfway through

383
00:12:40,880 --> 00:12:42,000
problem one with this little slack

384
00:12:42,000 --> 00:12:42,399
channel

385
00:12:42,399 --> 00:12:45,440
cool problem two is a bit trickier the

386
00:12:45,440 --> 00:12:47,200
solution was largely made possible

387
00:12:47,200 --> 00:12:48,880
actually by cleverly abusing

388
00:12:48,880 --> 00:12:51,040
scheduled policies on a firewall or

389
00:12:51,040 --> 00:12:52,320
gates before you ask

390
00:12:52,320 --> 00:12:54,880
most utms have the ability to schedule

391
00:12:54,880 --> 00:12:56,000
policy rules

392
00:12:56,000 --> 00:12:58,720
if they don't cron and ssh can step in

393
00:12:58,720 --> 00:12:59,519
but most do

394
00:12:59,519 --> 00:13:01,120
especially large sized you know

395
00:13:01,120 --> 00:13:03,440
perimeter gear so i used schedule

396
00:13:03,440 --> 00:13:04,480
policies to just

397
00:13:04,480 --> 00:13:06,959
crank up the logging and schedule a

398
00:13:06,959 --> 00:13:08,320
window for the students

399
00:13:08,320 --> 00:13:10,399
i could dial the logging up to 11 i

400
00:13:10,399 --> 00:13:12,320
could narrow it into you know either geo

401
00:13:12,320 --> 00:13:13,680
band or whatever

402
00:13:13,680 --> 00:13:15,839
dial that all up to 11. this meant i

403
00:13:15,839 --> 00:13:17,279
didn't actually have to use any specific

404
00:13:17,279 --> 00:13:18,320
wan ips either

405
00:13:18,320 --> 00:13:20,079
they could simply work from wherever

406
00:13:20,079 --> 00:13:21,680
just do it between 7 and 9 pm or

407
00:13:21,680 --> 00:13:22,639
whatever

408
00:13:22,639 --> 00:13:24,160
so another added benefit was having

409
00:13:24,160 --> 00:13:25,760
specific policy numbers now

410
00:13:25,760 --> 00:13:27,600
so with that new scheduled policy i now

411
00:13:27,600 --> 00:13:30,079
have you know rule number 510

412
00:13:30,079 --> 00:13:33,279
rule number 512 or rule 500 through 600

413
00:13:33,279 --> 00:13:34,720
which makes searching through the noise

414
00:13:34,720 --> 00:13:36,720
data a lot quicker and a lot easier

415
00:13:36,720 --> 00:13:38,399
basically the firewall itself is

416
00:13:38,399 --> 00:13:40,079
tattooing the relevant data for me just

417
00:13:40,079 --> 00:13:41,519
with that policy number

418
00:13:41,519 --> 00:13:44,560
that's fantastic so now i've got policy

419
00:13:44,560 --> 00:13:45,680
numbers it can actually trigger the

420
00:13:45,680 --> 00:13:47,040
logic and eventually at auto

421
00:13:47,040 --> 00:13:48,959
communication so simple alerts based on

422
00:13:48,959 --> 00:13:51,120
hitting those new schedule policies

423
00:13:51,120 --> 00:13:52,480
really cleaned it up it also kind of

424
00:13:52,480 --> 00:13:54,240
helped them see

425
00:13:54,240 --> 00:13:56,720
if if there was internet mess mixed in

426
00:13:56,720 --> 00:13:58,320
there as soon as i was communicating to

427
00:13:58,320 --> 00:13:59,519
the slack channel as well they could see

428
00:13:59,519 --> 00:14:00,800
what they're up against you were trying

429
00:14:00,800 --> 00:14:02,480
something that people are trying

430
00:14:02,480 --> 00:14:05,279
every five minutes think a little wider

431
00:14:05,279 --> 00:14:06,800
than that right

432
00:14:06,800 --> 00:14:10,240
so feeding even the the generic noise

433
00:14:10,240 --> 00:14:11,519
back into the channel during their

434
00:14:11,519 --> 00:14:13,040
scheduled window help them really see

435
00:14:13,040 --> 00:14:14,480
what noise looked like so if they wanted

436
00:14:14,480 --> 00:14:16,000
to either look like noise

437
00:14:16,000 --> 00:14:17,519
or be completely different than the

438
00:14:17,519 --> 00:14:18,720
stuff that's already got a lot of rules

439
00:14:18,720 --> 00:14:19,440
against it

440
00:14:19,440 --> 00:14:22,320
they have that feedback now so this

441
00:14:22,320 --> 00:14:24,800
shiny new scheduled traffic all flowed

442
00:14:24,800 --> 00:14:25,360
through a

443
00:14:25,360 --> 00:14:27,920
totally non-denominational vendor

444
00:14:27,920 --> 00:14:28,639
agnostic

445
00:14:28,639 --> 00:14:30,560
monochromatic blank box product of

446
00:14:30,560 --> 00:14:32,800
course

447
00:14:33,199 --> 00:14:34,880
actually wait no we're a sponsor right

448
00:14:34,880 --> 00:14:36,240
now we're a sponsor okay screw that this

449
00:14:36,240 --> 00:14:37,120
all went through greylock

450
00:14:37,120 --> 00:14:39,519
it all went through gray log super easy

451
00:14:39,519 --> 00:14:40,399
parsing engine

452
00:14:40,399 --> 00:14:41,839
simple and effective event engine and

453
00:14:41,839 --> 00:14:43,040
great output logic like slack

454
00:14:43,040 --> 00:14:44,399
notifications

455
00:14:44,399 --> 00:14:47,360
so after the first run with live ips av

456
00:14:47,360 --> 00:14:48,959
and firewall event data all being dumped

457
00:14:48,959 --> 00:14:50,399
into the slack channel just the utm

458
00:14:50,399 --> 00:14:51,440
rules

459
00:14:51,440 --> 00:14:54,320
adding new logic fine tuning granularity

460
00:14:54,320 --> 00:14:55,279
it blew up

461
00:14:55,279 --> 00:14:57,839
so fast it was crazy within a few more

462
00:14:57,839 --> 00:14:59,519
weekly sessions we had

463
00:14:59,519 --> 00:15:01,199
the spam filter logs for phishing

464
00:15:01,199 --> 00:15:03,680
simulation including a link clicking

465
00:15:03,680 --> 00:15:05,199
sandbox that the students actually built

466
00:15:05,199 --> 00:15:06,160
which is super cool

467
00:15:06,160 --> 00:15:07,279
if i remember right it was some sort of

468
00:15:07,279 --> 00:15:10,079
imap voodoo running into cuckoo

469
00:15:10,079 --> 00:15:11,680
all spun out of containers but i could

470
00:15:11,680 --> 00:15:13,279
easily be screwing that up

471
00:15:13,279 --> 00:15:14,880
anyway they had an auto link clicking

472
00:15:14,880 --> 00:15:16,880
thing that we ran and if they sent in

473
00:15:16,880 --> 00:15:18,000
links it would click on it and we could

474
00:15:18,000 --> 00:15:18,959
see how the rest of it

475
00:15:18,959 --> 00:15:20,160
played out which is cool we actually got

476
00:15:20,160 --> 00:15:21,360
a lot of really good intelligence out of

477
00:15:21,360 --> 00:15:22,240
that

478
00:15:22,240 --> 00:15:23,600
we eventually also had a one-to-one

479
00:15:23,600 --> 00:15:25,279
replica of a production platform that

480
00:15:25,279 --> 00:15:27,279
allowed an authenticated file upload

481
00:15:27,279 --> 00:15:29,040
so all feeding their locks so you know

482
00:15:29,040 --> 00:15:30,000
if they're uploading a whole bunch of

483
00:15:30,000 --> 00:15:31,920
shady.js files or whatever

484
00:15:31,920 --> 00:15:34,639
that php and we could see that putting

485
00:15:34,639 --> 00:15:36,320
all these various layers in the gray log

486
00:15:36,320 --> 00:15:37,759
being parlayed back to the students

487
00:15:37,759 --> 00:15:39,279
themselves as they're trying the

488
00:15:39,279 --> 00:15:40,560
exploits

489
00:15:40,560 --> 00:15:41,759
we could even indeed you know we'd

490
00:15:41,759 --> 00:15:43,519
simulate it at times oh you got the ban

491
00:15:43,519 --> 00:15:45,120
for an hour you got the ban for an hour

492
00:15:45,120 --> 00:15:46,079
great

493
00:15:46,079 --> 00:15:48,320
or 30 days that's a nasty one you

494
00:15:48,320 --> 00:15:51,759
triggered the ips on a critical that's

495
00:15:51,920 --> 00:15:54,079
stop halt and i never did we have any

496
00:15:54,079 --> 00:15:55,040
any issues

497
00:15:55,040 --> 00:15:58,079
so parliament back to the students

498
00:15:58,079 --> 00:16:00,079
as they were trying it i mean the more i

499
00:16:00,079 --> 00:16:01,360
thought about it later and as kind of

500
00:16:01,360 --> 00:16:02,959
times gone by the more we realized we're

501
00:16:02,959 --> 00:16:04,399
basically describing

502
00:16:04,399 --> 00:16:06,560
more or less the automated feedlot back

503
00:16:06,560 --> 00:16:08,880
loop from purple team exercises

504
00:16:08,880 --> 00:16:10,639
except done in a way that i felt most

505
00:16:10,639 --> 00:16:12,480
comfortable myself

506
00:16:12,480 --> 00:16:13,680
in other words it was done completely

507
00:16:13,680 --> 00:16:14,880
unprofessionally and totally hacked

508
00:16:14,880 --> 00:16:16,720
together but it was awesome

509
00:16:16,720 --> 00:16:18,320
lots of fun with the college kids so

510
00:16:18,320 --> 00:16:19,519
that was my first adventure that i

511
00:16:19,519 --> 00:16:20,560
wanted to bring up nothing earth

512
00:16:20,560 --> 00:16:21,920
shattering technique technique-wise

513
00:16:21,920 --> 00:16:23,040
but rather than throwing hands in the

514
00:16:23,040 --> 00:16:25,600
air and giving up at our log jam

515
00:16:25,600 --> 00:16:27,519
see the loopback we methodically

516
00:16:27,519 --> 00:16:28,800
attacked the root of our problems and

517
00:16:28,800 --> 00:16:30,320
blended the solution together

518
00:16:30,320 --> 00:16:32,079
scheduled firewall policies made for

519
00:16:32,079 --> 00:16:33,519
straightforward alert logic

520
00:16:33,519 --> 00:16:35,920
into a chat program for feedback this

521
00:16:35,920 --> 00:16:37,519
actually made for a really fun poc for

522
00:16:37,519 --> 00:16:38,959
baby hackers

523
00:16:38,959 --> 00:16:40,480
no idea where this project is now but

524
00:16:40,480 --> 00:16:42,079
hopefully someone found my shoddy

525
00:16:42,079 --> 00:16:44,079
documentation blew the dust off and

526
00:16:44,079 --> 00:16:45,040
tried again

527
00:16:45,040 --> 00:16:47,199
baby hacker school so i've never before

528
00:16:47,199 --> 00:16:48,959
never seen since

529
00:16:48,959 --> 00:16:50,560
scheduled policies abused that way

530
00:16:50,560 --> 00:16:52,560
outside of maintenance windows or

531
00:16:52,560 --> 00:16:54,720
internet restricted machines or blocking

532
00:16:54,720 --> 00:16:55,920
internet hours because

533
00:16:55,920 --> 00:16:57,199
someone works a late night shift and

534
00:16:57,199 --> 00:17:00,320
likes to abuse the internet anyway

535
00:17:00,320 --> 00:17:01,839
so that was uh that was that was old

536
00:17:01,839 --> 00:17:04,480
tech used in a new way

537
00:17:04,480 --> 00:17:07,679
speaking of internet abuse however story

538
00:17:07,679 --> 00:17:09,359
number two

539
00:17:09,359 --> 00:17:12,559
once upon a time in a land far far away

540
00:17:12,559 --> 00:17:14,240
i worked for an organization that was

541
00:17:14,240 --> 00:17:16,240
building a large equipment

542
00:17:16,240 --> 00:17:18,400
operation depot the building was all

543
00:17:18,400 --> 00:17:19,359
done

544
00:17:19,359 --> 00:17:22,079
but nobody was really working in it yet

545
00:17:22,079 --> 00:17:23,760
we went in and suited up a bunch of

546
00:17:23,760 --> 00:17:26,640
at the time state of the art wi-fi it

547
00:17:26,640 --> 00:17:26,959
was

548
00:17:26,959 --> 00:17:29,600
going to be so exciting these particular

549
00:17:29,600 --> 00:17:30,400
aps had

550
00:17:30,400 --> 00:17:32,559
all kinds of cool tech it was the first

551
00:17:32,559 --> 00:17:33,679
you know walkabout

552
00:17:33,679 --> 00:17:36,640
roaming ap to ap wi-fi uh where you can

553
00:17:36,640 --> 00:17:38,000
go one to the next without dropping

554
00:17:38,000 --> 00:17:39,120
connection that i had been part of

555
00:17:39,120 --> 00:17:40,160
deploying

556
00:17:40,160 --> 00:17:41,440
it was the first one that i'd been on

557
00:17:41,440 --> 00:17:43,440
that had you know heat maps density maps

558
00:17:43,440 --> 00:17:45,120
from estimated foot traffic et cetera it

559
00:17:45,120 --> 00:17:46,160
was cool

560
00:17:46,160 --> 00:17:49,360
and speaking of bells and whistles these

561
00:17:49,360 --> 00:17:52,080
aps had some pretty groovy security tech

562
00:17:52,080 --> 00:17:53,120
baked into them

563
00:17:53,120 --> 00:17:55,520
now caveat i believe this particular

564
00:17:55,520 --> 00:17:57,120
protection has been patched out for a

565
00:17:57,120 --> 00:17:58,320
couple of reasons but

566
00:17:58,320 --> 00:17:59,679
i won't name and blame the vendor do

567
00:17:59,679 --> 00:18:00,960
your googling you'll find it from the

568
00:18:00,960 --> 00:18:02,080
story

569
00:18:02,080 --> 00:18:03,360
anyway there was this really cool

570
00:18:03,360 --> 00:18:05,679
security protection against evil twin

571
00:18:05,679 --> 00:18:07,280
attacks it got our attention

572
00:18:07,280 --> 00:18:08,640
how do you protect against that we

573
00:18:08,640 --> 00:18:10,559
didn't know what it was or how it worked

574
00:18:10,559 --> 00:18:13,039
or anything it was just two check boxes

575
00:18:13,039 --> 00:18:15,200
evil twin attack detection

576
00:18:15,200 --> 00:18:17,840
and evil twin attack protection or

577
00:18:17,840 --> 00:18:18,720
prevention

578
00:18:18,720 --> 00:18:20,240
i think it said even said beta or you

579
00:18:20,240 --> 00:18:21,919
know this feature is incomplete and

580
00:18:21,919 --> 00:18:23,440
dangerous or something anyway

581
00:18:23,440 --> 00:18:26,160
we rolled it out since this building was

582
00:18:26,160 --> 00:18:26,960
kind of far like

583
00:18:26,960 --> 00:18:28,720
geographically far from us we were doing

584
00:18:28,720 --> 00:18:30,320
everything remotely

585
00:18:30,320 --> 00:18:32,080
but it couldn't shake like what does

586
00:18:32,080 --> 00:18:34,320
this actually do out of my head

587
00:18:34,320 --> 00:18:36,240
so we remotely activated some laptop and

588
00:18:36,240 --> 00:18:38,320
a dock and and played with its wi-fi to

589
00:18:38,320 --> 00:18:39,120
broadcast

590
00:18:39,120 --> 00:18:40,640
a network with the same name you know

591
00:18:40,640 --> 00:18:42,240
basically simulating actually

592
00:18:42,240 --> 00:18:45,760
technically doing an evil twin attack

593
00:18:45,760 --> 00:18:49,440
so that's what we're working on

594
00:18:50,799 --> 00:18:52,640
it should have been like like an easy

595
00:18:52,640 --> 00:18:54,080
detection right like

596
00:18:54,080 --> 00:18:56,799
no but nothing like we got nothing

597
00:18:56,799 --> 00:18:58,240
nothing came out of that

598
00:18:58,240 --> 00:19:00,720
there was no cool evil twin protection

599
00:19:00,720 --> 00:19:01,679
no

600
00:19:01,679 --> 00:19:04,320
logs even showing the detection no like

601
00:19:04,320 --> 00:19:05,200
tiny

602
00:19:05,200 --> 00:19:07,039
cannons popping out of the access point

603
00:19:07,039 --> 00:19:09,280
or flamethrowers

604
00:19:09,280 --> 00:19:11,760
no bill murray riding a dinosaur that

605
00:19:11,760 --> 00:19:13,679
shot lasers out of his eyes nothing like

606
00:19:13,679 --> 00:19:16,799
total bomber dad it was just ah we were

607
00:19:16,799 --> 00:19:17,840
so disheartened

608
00:19:17,840 --> 00:19:20,000
anyway most people would let that go but

609
00:19:20,000 --> 00:19:21,440
like i had to know like the checkbox is

610
00:19:21,440 --> 00:19:23,360
here somebody deved this

611
00:19:23,360 --> 00:19:24,960
i want to see what they deved and what

612
00:19:24,960 --> 00:19:27,280
it does so i jumped in a car

613
00:19:27,280 --> 00:19:29,520
we drove down there let's see this thing

614
00:19:29,520 --> 00:19:31,440
in action there's a knob that seems

615
00:19:31,440 --> 00:19:32,559
irrelevant i'm

616
00:19:32,559 --> 00:19:35,039
all for thoroughly testing it on company

617
00:19:35,039 --> 00:19:37,360
time way over scope of the project

618
00:19:37,360 --> 00:19:38,960
so we walked around broadcasting our

619
00:19:38,960 --> 00:19:40,960
wi-fi range nothing not a thing

620
00:19:40,960 --> 00:19:43,440
no idea why maybe it was propagation

621
00:19:43,440 --> 00:19:44,720
time who knows

622
00:19:44,720 --> 00:19:47,440
whatever we did nothing worked oh well

623
00:19:47,440 --> 00:19:48,960
evil twin protection wasn't

624
00:19:48,960 --> 00:19:50,799
actually in the deployment scope as i

625
00:19:50,799 --> 00:19:52,240
kept getting reminded so

626
00:19:52,240 --> 00:19:54,400
i had to give up and walk away we did

627
00:19:54,400 --> 00:19:56,320
packed up went home

628
00:19:56,320 --> 00:19:59,200
exhaustingly we were eventually able to

629
00:19:59,200 --> 00:20:01,039
trigger the detection

630
00:20:01,039 --> 00:20:02,400
pretty much by using a few other

631
00:20:02,400 --> 00:20:04,960
commercial aps and and the evil twin

632
00:20:04,960 --> 00:20:06,080
protection

633
00:20:06,080 --> 00:20:08,799
was simply cranking the antenna power

634
00:20:08,799 --> 00:20:09,919
out of any ap

635
00:20:09,919 --> 00:20:12,320
that detects the malicious ssid to 11 or

636
00:20:12,320 --> 00:20:13,440
whatever max power

637
00:20:13,440 --> 00:20:15,679
is for for a configurable amount of time

638
00:20:15,679 --> 00:20:16,880
so in other words you

639
00:20:16,880 --> 00:20:19,200
you have your wi-fi named super ultimate

640
00:20:19,200 --> 00:20:20,080
hacker

641
00:20:20,080 --> 00:20:21,840
and you set up an ssid called super

642
00:20:21,840 --> 00:20:24,320
ultimate hacker the ap is to detect that

643
00:20:24,320 --> 00:20:24,960
just just

644
00:20:24,960 --> 00:20:26,880
crank their juice to 11 for 3 600

645
00:20:26,880 --> 00:20:28,480
seconds or whatever it is

646
00:20:28,480 --> 00:20:30,480
so that's all it was an hour or two was

647
00:20:30,480 --> 00:20:32,159
the default it was boring

648
00:20:32,159 --> 00:20:33,760
and nothing space space-age at all i

649
00:20:33,760 --> 00:20:35,120
really wanted tiny cannons out of the

650
00:20:35,120 --> 00:20:36,159
access point

651
00:20:36,159 --> 00:20:38,720
anyway as with any test that led us to

652
00:20:38,720 --> 00:20:40,559
complete disappointment

653
00:20:40,559 --> 00:20:42,159
we literally packed up our gear left it

654
00:20:42,159 --> 00:20:43,679
enabled and didn't turn it off who cares

655
00:20:43,679 --> 00:20:45,440
it's boring anyway

656
00:20:45,440 --> 00:20:48,720
well it does do something so a few days

657
00:20:48,720 --> 00:20:49,600
later

658
00:20:49,600 --> 00:20:51,679
our test alarms light up like christmas

659
00:20:51,679 --> 00:20:54,240
tree about an evil twin attack

660
00:20:54,240 --> 00:20:57,840
yes awesome it's not even one of our

661
00:20:57,840 --> 00:20:59,039
test systems

662
00:20:59,039 --> 00:21:01,919
this is a legit real hacker in our

663
00:21:01,919 --> 00:21:03,919
parking lot

664
00:21:03,919 --> 00:21:07,440
yeah the entire security team is feeling

665
00:21:07,440 --> 00:21:08,000
like a

666
00:21:08,000 --> 00:21:09,919
badass level somewhere between hackers

667
00:21:09,919 --> 00:21:11,919
and sons of anarchy right now

668
00:21:11,919 --> 00:21:14,720
someone is going down and we are the

669
00:21:14,720 --> 00:21:17,679
super humans that are causing this

670
00:21:17,679 --> 00:21:19,280
i don't think anyone really stepped back

671
00:21:19,280 --> 00:21:20,720
and thought too deeply

672
00:21:20,720 --> 00:21:23,360
about how much energy we're putting into

673
00:21:23,360 --> 00:21:25,039
an alarm that we couldn't even manually

674
00:21:25,039 --> 00:21:26,480
trigger on the test day

675
00:21:26,480 --> 00:21:28,000
but uh that's not really important right

676
00:21:28,000 --> 00:21:31,360
now we have a live hacker on the hook

677
00:21:31,360 --> 00:21:34,080
we dove into those logs head first with

678
00:21:34,080 --> 00:21:35,919
furious faces

679
00:21:35,919 --> 00:21:38,480
and started looking around we quickly

680
00:21:38,480 --> 00:21:40,960
learned a few key pieces of information

681
00:21:40,960 --> 00:21:43,520
first the mac address was not a

682
00:21:43,520 --> 00:21:44,799
well-known vendor address

683
00:21:44,799 --> 00:21:46,480
it was an actual known vendor just none

684
00:21:46,480 --> 00:21:48,159
of us recognized the name it was in the

685
00:21:48,159 --> 00:21:51,679
thing we're just what is that second

686
00:21:51,679 --> 00:21:54,000
the ap in the parking lot had the

687
00:21:54,000 --> 00:21:56,000
greatest signal strength by far

688
00:21:56,000 --> 00:21:59,039
with the next two being roughly equal in

689
00:21:59,039 --> 00:22:00,559
other words our macgyver

690
00:22:00,559 --> 00:22:03,200
super ultra genius napkin math

691
00:22:03,200 --> 00:22:04,799
triangulation

692
00:22:04,799 --> 00:22:05,919
told us that the hacker should be out in

693
00:22:05,919 --> 00:22:08,559
the parking lot so

694
00:22:08,559 --> 00:22:10,480
it's most likely at this point a nation

695
00:22:10,480 --> 00:22:12,559
state team in a series of black panel

696
00:22:12,559 --> 00:22:13,520
vans

697
00:22:13,520 --> 00:22:15,120
the special forces strike force all

698
00:22:15,120 --> 00:22:16,480
around us in the bushes and along the

699
00:22:16,480 --> 00:22:17,520
neighboring fence line

700
00:22:17,520 --> 00:22:19,280
it's a privacy fence so this is entirely

701
00:22:19,280 --> 00:22:21,120
possible they could just come

702
00:22:21,120 --> 00:22:23,200
tenth mountain over the hill in tanks or

703
00:22:23,200 --> 00:22:26,000
whatever probably north korea russia and

704
00:22:26,000 --> 00:22:28,000
china all charging over the fence at the

705
00:22:28,000 --> 00:22:29,600
same time to attack our parking lot for

706
00:22:29,600 --> 00:22:31,600
some reason at least our wi-fi

707
00:22:31,600 --> 00:22:33,440
we detected an evil twin attack what

708
00:22:33,440 --> 00:22:36,480
other scenarios could there possibly be

709
00:22:36,480 --> 00:22:37,840
we eventually remembered in all of our

710
00:22:37,840 --> 00:22:38,720
excitement that we actually have

711
00:22:38,720 --> 00:22:40,000
security cameras

712
00:22:40,000 --> 00:22:43,039
so we pulled them up and as it's loading

713
00:22:43,039 --> 00:22:44,559
we're all waiting we're all waiting

714
00:22:44,559 --> 00:22:46,799
looking at the parking lot you wouldn't

715
00:22:46,799 --> 00:22:48,320
believe what we saw

716
00:22:48,320 --> 00:22:52,080
you ready nothing

717
00:22:52,080 --> 00:22:55,120
not a single vehicle no black van no

718
00:22:55,120 --> 00:22:56,400
special forces team

719
00:22:56,400 --> 00:22:58,720
literally straight up 100 nothing

720
00:22:58,720 --> 00:23:00,480
completely barebones empty parking lot

721
00:23:00,480 --> 00:23:03,440
an empty stretch of concrete

722
00:23:03,440 --> 00:23:05,200
we actually saw the same protection pop

723
00:23:05,200 --> 00:23:06,720
on and off a few times over the stretch

724
00:23:06,720 --> 00:23:07,679
of an hour or two

725
00:23:07,679 --> 00:23:11,520
that was it never a vehicle showed up

726
00:23:11,520 --> 00:23:14,559
so a small team of security and i.t

727
00:23:14,559 --> 00:23:16,159
operation nerds

728
00:23:16,159 --> 00:23:17,679
put their tails between their legs and

729
00:23:17,679 --> 00:23:19,520
went home that night

730
00:23:19,520 --> 00:23:21,679
with completely broken hearts i'm sure

731
00:23:21,679 --> 00:23:23,360
there was at least one pair

732
00:23:23,360 --> 00:23:25,440
of superhero pajamas worn to bed just to

733
00:23:25,440 --> 00:23:27,120
feel better

734
00:23:27,120 --> 00:23:30,880
well redemption was still possible

735
00:23:30,880 --> 00:23:33,360
about three times three days later the

736
00:23:33,360 --> 00:23:33,919
alert

737
00:23:33,919 --> 00:23:38,159
occurred again this time plot twist

738
00:23:38,159 --> 00:23:41,760
parking lot wasn't empty however

739
00:23:41,760 --> 00:23:43,679
after driving around doing some range

740
00:23:43,679 --> 00:23:45,200
checks some strength testing we

741
00:23:45,200 --> 00:23:47,120
confirmed this evil twin attack

742
00:23:47,120 --> 00:23:49,120
had to happen within the area of the

743
00:23:49,120 --> 00:23:50,640
parking lot at least

744
00:23:50,640 --> 00:23:52,000
within a couple feet of the area of the

745
00:23:52,000 --> 00:23:54,400
parking lot it was empty on the screen

746
00:23:54,400 --> 00:23:55,120
every time

747
00:23:55,120 --> 00:23:57,919
or verifiably not belonging to one of

748
00:23:57,919 --> 00:23:59,919
the vehicles in the parking lot

749
00:23:59,919 --> 00:24:03,039
we were complex totally complexed we did

750
00:24:03,039 --> 00:24:04,640
have one new piece of information though

751
00:24:04,640 --> 00:24:07,440
the mac address was the same vendor id

752
00:24:07,440 --> 00:24:08,880
but a different mac

753
00:24:08,880 --> 00:24:12,080
the same weird vendor well we got that

754
00:24:12,080 --> 00:24:13,520
alarm a day or two later

755
00:24:13,520 --> 00:24:15,520
and then again and then again one more

756
00:24:15,520 --> 00:24:16,720
time

757
00:24:16,720 --> 00:24:19,200
so now we're nowhere near as excited but

758
00:24:19,200 --> 00:24:20,400
we've just kind of you know still

759
00:24:20,400 --> 00:24:21,919
telling all of our friends and family

760
00:24:21,919 --> 00:24:23,440
that we have an ultra patient

761
00:24:23,440 --> 00:24:26,080
you know apt-level mac address spoofing

762
00:24:26,080 --> 00:24:27,520
campaign going on

763
00:24:27,520 --> 00:24:29,600
but these international criminal

764
00:24:29,600 --> 00:24:31,360
supervillain spies

765
00:24:31,360 --> 00:24:35,039
were not going to outsmart us

766
00:24:35,120 --> 00:24:37,120
one of our group had the genius idea of

767
00:24:37,120 --> 00:24:38,640
seeing if we've ever seen this mac

768
00:24:38,640 --> 00:24:40,720
address or vendor before

769
00:24:40,720 --> 00:24:43,360
we actually have that vendor ids popped

770
00:24:43,360 --> 00:24:44,240
up at one or two other sites

771
00:24:44,240 --> 00:24:45,279
occasionally

772
00:24:45,279 --> 00:24:47,360
in these other instances though the mac

773
00:24:47,360 --> 00:24:49,039
address didn't change

774
00:24:49,039 --> 00:24:50,480
same device had a history of

775
00:24:50,480 --> 00:24:51,840
occasionally connecting to our public

776
00:24:51,840 --> 00:24:52,799
wi-fi

777
00:24:52,799 --> 00:24:55,120
now just to remind this is a public

778
00:24:55,120 --> 00:24:56,559
wi-fi network

779
00:24:56,559 --> 00:24:58,159
that spans across one of the larger

780
00:24:58,159 --> 00:25:00,080
cities in canada so it's not a tiny

781
00:25:00,080 --> 00:25:00,799
network

782
00:25:00,799 --> 00:25:02,880
we had no idea what these devices did

783
00:25:02,880 --> 00:25:05,120
and still no idea what it was

784
00:25:05,120 --> 00:25:06,720
the nature of our logging infrastructure

785
00:25:06,720 --> 00:25:08,400
meant we didn't have records of what

786
00:25:08,400 --> 00:25:10,080
traffic these devices were generating

787
00:25:10,080 --> 00:25:10,960
when they connected

788
00:25:10,960 --> 00:25:12,400
none of them were recent enough for that

789
00:25:12,400 --> 00:25:14,960
logging the ips were all long recycled

790
00:25:14,960 --> 00:25:16,400
other devices

791
00:25:16,400 --> 00:25:18,559
another interesting note these devices

792
00:25:18,559 --> 00:25:20,240
the ones that we had previously seen

793
00:25:20,240 --> 00:25:22,240
hadn't connected in months this is

794
00:25:22,240 --> 00:25:23,600
springtime so that actually becomes an

795
00:25:23,600 --> 00:25:25,760
important fact of the story

796
00:25:25,760 --> 00:25:27,919
we enabled some pretty detailed layer 2

797
00:25:27,919 --> 00:25:29,360
logging and filtered it down for that

798
00:25:29,360 --> 00:25:31,360
particular vendor id across our whole

799
00:25:31,360 --> 00:25:32,960
infrastructure

800
00:25:32,960 --> 00:25:34,720
now remember not everyone's from network

801
00:25:34,720 --> 00:25:35,840
operations but remember if you're

802
00:25:35,840 --> 00:25:37,520
running a homogeneous network is in

803
00:25:37,520 --> 00:25:38,720
everything from the same brand and

804
00:25:38,720 --> 00:25:40,159
product line which really

805
00:25:40,159 --> 00:25:42,320
nobody is then it's actually a pretty

806
00:25:42,320 --> 00:25:43,679
big challenge unless you're doing that

807
00:25:43,679 --> 00:25:44,720
then it's actually a pretty big

808
00:25:44,720 --> 00:25:45,600
challenge

809
00:25:45,600 --> 00:25:47,600
to monitor traffic from layer two filter

810
00:25:47,600 --> 00:25:49,039
in other words you know

811
00:25:49,039 --> 00:25:52,480
a specific series of mac addresses

812
00:25:52,480 --> 00:25:54,240
on to what actual traffic they're

813
00:25:54,240 --> 00:25:55,679
they're doing what is what is the actual

814
00:25:55,679 --> 00:25:56,000
traffic

815
00:25:56,000 --> 00:25:58,159
they're generating web traffic or h you

816
00:25:58,159 --> 00:25:59,919
know api whatever else it is

817
00:25:59,919 --> 00:26:01,440
we can do packet capture which is

818
00:26:01,440 --> 00:26:03,840
ungodly expensive resource wise

819
00:26:03,840 --> 00:26:06,000
or we can use a netflow variant which is

820
00:26:06,000 --> 00:26:07,120
spotty at best that's

821
00:26:07,120 --> 00:26:09,760
sampling we wanted to know the traffic

822
00:26:09,760 --> 00:26:11,279
being caused by a specific

823
00:26:11,279 --> 00:26:12,880
brand of network card in the end we

824
00:26:12,880 --> 00:26:14,400
finally had it we tagged

825
00:26:14,400 --> 00:26:17,279
the dhcp logs and added some additional

826
00:26:17,279 --> 00:26:18,640
information so we pulled a lot of stuff

827
00:26:18,640 --> 00:26:20,080
off our wi-fi controller

828
00:26:20,080 --> 00:26:21,760
add a little bit to kind of generate our

829
00:26:21,760 --> 00:26:23,440
own sessions

830
00:26:23,440 --> 00:26:24,880
and then tagging those sessions from the

831
00:26:24,880 --> 00:26:26,400
first level of nat device so as soon as

832
00:26:26,400 --> 00:26:27,279
they go from you know

833
00:26:27,279 --> 00:26:29,520
one brand of wi-fi controller across a

834
00:26:29,520 --> 00:26:31,200
router you've now lost that mac address

835
00:26:31,200 --> 00:26:32,159
information which is what makes this

836
00:26:32,159 --> 00:26:33,440
challenging you've now lost that so we

837
00:26:33,440 --> 00:26:35,279
had to kind of give them a fake session

838
00:26:35,279 --> 00:26:36,480
that carried over to the next set of

839
00:26:36,480 --> 00:26:38,080
logs hey if you've seen this session add

840
00:26:38,080 --> 00:26:38,960
it again

841
00:26:38,960 --> 00:26:42,000
great and uh

842
00:26:42,000 --> 00:26:43,679
so we were able to carry that on so we

843
00:26:43,679 --> 00:26:46,080
now have traffic logs the traffic

844
00:26:46,080 --> 00:26:50,080
from these highly advanced adversaries

845
00:26:50,080 --> 00:26:52,799
when we finally got it when we finally

846
00:26:52,799 --> 00:26:53,600
got it

847
00:26:53,600 --> 00:26:57,840
we couldn't believe it the traffic

848
00:26:57,840 --> 00:26:59,440
was to i don't remember the exact url

849
00:26:59,440 --> 00:27:02,799
but something along the lines of

850
00:27:03,480 --> 00:27:05,360
api.webersmartgrilling.com

851
00:27:05,360 --> 00:27:07,520
our enemy that was gonna roll over in

852
00:27:07,520 --> 00:27:09,039
tanks

853
00:27:09,039 --> 00:27:13,039
was a handful of smart barbecues

854
00:27:13,039 --> 00:27:15,360
our nation-state level threat actor was

855
00:27:15,360 --> 00:27:16,720
a tool used to not

856
00:27:16,720 --> 00:27:20,080
burn chicken given how much we had hyped

857
00:27:20,080 --> 00:27:21,919
up this whole thing in our heads it was

858
00:27:21,919 --> 00:27:24,960
definitely a solid laugh cry moment

859
00:27:24,960 --> 00:27:26,799
followed by days of uncontrollable

860
00:27:26,799 --> 00:27:28,240
giggling like because seriously we had

861
00:27:28,240 --> 00:27:29,360
this hyped up in the office it was

862
00:27:29,360 --> 00:27:29,919
pretty good

863
00:27:29,919 --> 00:27:31,440
we were all pretty convinced we were

864
00:27:31,440 --> 00:27:33,440
going to completely uncover some huge

865
00:27:33,440 --> 00:27:36,240
like like the illuminati at the least

866
00:27:36,240 --> 00:27:37,200
nope

867
00:27:37,200 --> 00:27:39,520
nope completely overpriced hot dog

868
00:27:39,520 --> 00:27:41,840
cooking tech had us baffled for weeks

869
00:27:41,840 --> 00:27:43,440
the rest of the pieces started instantly

870
00:27:43,440 --> 00:27:45,520
making sense other folks

871
00:27:45,520 --> 00:27:47,520
who lived close enough to our facilities

872
00:27:47,520 --> 00:27:49,279
to leach free wi-fi

873
00:27:49,279 --> 00:27:51,600
simply hadn't uh uh simply hadn't

874
00:27:51,600 --> 00:27:54,240
barbecued yet this season

875
00:27:54,240 --> 00:27:57,039
and and now that we had all the we did

876
00:27:57,039 --> 00:27:58,640
have one piece of the mystery left to

877
00:27:58,640 --> 00:27:59,600
solve though

878
00:27:59,600 --> 00:28:01,679
this all started with an evil twin

879
00:28:01,679 --> 00:28:03,440
detection on our access points

880
00:28:03,440 --> 00:28:05,679
that means someone publishing our wi-fi

881
00:28:05,679 --> 00:28:07,360
name on their device

882
00:28:07,360 --> 00:28:08,960
i mean now we're kind of we've narrowed

883
00:28:08,960 --> 00:28:10,480
it down to someone publishing our wi-fi

884
00:28:10,480 --> 00:28:11,120
name on a

885
00:28:11,120 --> 00:28:13,440
freaking barbecue but we actually went

886
00:28:13,440 --> 00:28:15,679
as far as using our security camera

887
00:28:15,679 --> 00:28:17,919
zoomed all the way in to find the right

888
00:28:17,919 --> 00:28:20,799
brand of barbecue in the nearby backyard

889
00:28:20,799 --> 00:28:22,640
because you'd see it from the top of our

890
00:28:22,640 --> 00:28:24,320
building over the fence

891
00:28:24,320 --> 00:28:26,399
so we politely knocked on the door and

892
00:28:26,399 --> 00:28:28,159
explained our situation

893
00:28:28,159 --> 00:28:30,320
the particular barbecue user found the

894
00:28:30,320 --> 00:28:31,919
whole story

895
00:28:31,919 --> 00:28:34,799
side-splitting hilarious we asked them

896
00:28:34,799 --> 00:28:35,919
you know how are they configuring their

897
00:28:35,919 --> 00:28:36,799
barbecue

898
00:28:36,799 --> 00:28:38,080
after assuring them we're not pulling

899
00:28:38,080 --> 00:28:39,440
the plug on your free internet continue

900
00:28:39,440 --> 00:28:40,320
to reach

901
00:28:40,320 --> 00:28:42,159
leech-free wi-fi we barely scratch our

902
00:28:42,159 --> 00:28:43,840
bandwidth capabilities we just wanted to

903
00:28:43,840 --> 00:28:45,360
know what happened

904
00:28:45,360 --> 00:28:47,120
so it turns out some of the variants of

905
00:28:47,120 --> 00:28:48,399
the smart barbecue

906
00:28:48,399 --> 00:28:50,559
act an awful lot like a chromecast they

907
00:28:50,559 --> 00:28:52,000
can both connect to wi-fi

908
00:28:52,000 --> 00:28:53,760
and use cloud services to push your

909
00:28:53,760 --> 00:28:55,760
grill notifications back and forth

910
00:28:55,760 --> 00:28:57,360
or they can be configured kind of

911
00:28:57,360 --> 00:29:00,320
non-cloudy as a local wi-fi ap

912
00:29:00,320 --> 00:29:02,480
so this particular user decided to name

913
00:29:02,480 --> 00:29:04,399
their local barbecue wi-fi

914
00:29:04,399 --> 00:29:06,559
with the same network name as our public

915
00:29:06,559 --> 00:29:07,600
wi-fi

916
00:29:07,600 --> 00:29:08,720
so they didn't have to switch their

917
00:29:08,720 --> 00:29:10,799
phone settings back and forth they could

918
00:29:10,799 --> 00:29:12,080
just sit near the barbecue and it should

919
00:29:12,080 --> 00:29:14,640
work that was the thought in their head

920
00:29:14,640 --> 00:29:16,480
whenever they tried setting that up they

921
00:29:16,480 --> 00:29:17,679
then complained that this actually

922
00:29:17,679 --> 00:29:19,120
screwed up the wi-fi all over their

923
00:29:19,120 --> 00:29:19,679
house

924
00:29:19,679 --> 00:29:21,120
all of their devices went completely

925
00:29:21,120 --> 00:29:22,320
haywire so they would take the

926
00:29:22,320 --> 00:29:23,679
motherboard of their barbecue back to

927
00:29:23,679 --> 00:29:25,120
the hardware store and get a replacement

928
00:29:25,120 --> 00:29:26,320
for another

929
00:29:26,320 --> 00:29:28,880
changing mac addresses so we've now

930
00:29:28,880 --> 00:29:30,320
narrowed down why we had changing mac

931
00:29:30,320 --> 00:29:32,080
addresses and the evil twin attack

932
00:29:32,080 --> 00:29:33,440
tried it several more times until

933
00:29:33,440 --> 00:29:34,799
eventually gave up and just gave it a

934
00:29:34,799 --> 00:29:36,240
proper local name

935
00:29:36,240 --> 00:29:37,840
and and away it went so we never saw

936
00:29:37,840 --> 00:29:39,360
them again

937
00:29:39,360 --> 00:29:41,279
and then some folks from the city

938
00:29:41,279 --> 00:29:42,559
started knocking on their door asking

939
00:29:42,559 --> 00:29:45,440
about their smart barbecue so

940
00:29:45,440 --> 00:29:49,120
ah that was that was the fun one

941
00:29:49,120 --> 00:29:51,120
they're uh their potentially clever way

942
00:29:51,120 --> 00:29:52,720
of of just not having to switch your

943
00:29:52,720 --> 00:29:54,240
phone's wi-fi it didn't

944
00:29:54,240 --> 00:29:56,080
didn't quite work but the moral of the

945
00:29:56,080 --> 00:29:58,399
story is leeching public wi-fi for your

946
00:29:58,399 --> 00:29:59,520
barbecue

947
00:29:59,520 --> 00:30:01,279
might end up with advanced persistent

948
00:30:01,279 --> 00:30:02,799
civil servants knocking on your door

949
00:30:02,799 --> 00:30:04,559
asking questions

950
00:30:04,559 --> 00:30:07,120
so to summarize we combine dhcp logs to

951
00:30:07,120 --> 00:30:08,240
summarize the tech at least

952
00:30:08,240 --> 00:30:11,760
we combine dhcp logs to not device logs

953
00:30:11,760 --> 00:30:14,480
to weapon web traffic and dns logs to

954
00:30:14,480 --> 00:30:14,960
make

955
00:30:14,960 --> 00:30:17,520
uh it took some pretty serious finesse

956
00:30:17,520 --> 00:30:18,640
to get those all talking to each other

957
00:30:18,640 --> 00:30:20,399
but it was it was doable

958
00:30:20,399 --> 00:30:21,919
and eventually were able to filter on

959
00:30:21,919 --> 00:30:23,760
vendor mac ids and uh

960
00:30:23,760 --> 00:30:25,279
and any other aspect of that change is

961
00:30:25,279 --> 00:30:26,799
totally possible

962
00:30:26,799 --> 00:30:29,279
albeit if you wanted to drastically cut

963
00:30:29,279 --> 00:30:30,880
down on some time and effort in doing it

964
00:30:30,880 --> 00:30:31,679
in gray log

965
00:30:31,679 --> 00:30:33,919
you'll want the mongodb lookup table so

966
00:30:33,919 --> 00:30:35,279
if you're small scale check out the

967
00:30:35,279 --> 00:30:36,640
small business or

968
00:30:36,640 --> 00:30:38,000
or or upgrade if you're doing this at

969
00:30:38,000 --> 00:30:40,720
the office so anyway

970
00:30:40,720 --> 00:30:42,880
that was uh that was one that was uh

971
00:30:42,880 --> 00:30:44,159
that was a big case for how

972
00:30:44,159 --> 00:30:46,159
how before i got to greylock i we ended

973
00:30:46,159 --> 00:30:47,840
up on enterprise

974
00:30:47,840 --> 00:30:50,399
on my last tale now this one isn't even

975
00:30:50,399 --> 00:30:52,480
so much as a tail

976
00:30:52,480 --> 00:30:55,360
as an entire category of fun shenanigans

977
00:30:55,360 --> 00:30:56,720
this concept actually came from a

978
00:30:56,720 --> 00:30:58,320
portion of the greylock analyst class

979
00:30:58,320 --> 00:30:58,960
where i asked

980
00:30:58,960 --> 00:31:01,519
guests to just tell me stories like the

981
00:31:01,519 --> 00:31:03,279
ones i've told you now

982
00:31:03,279 --> 00:31:05,840
one of the better ones by far was a

983
00:31:05,840 --> 00:31:06,320
fellow

984
00:31:06,320 --> 00:31:08,559
who really enjoyed playing tricks on his

985
00:31:08,559 --> 00:31:10,960
relatively non-techie family

986
00:31:10,960 --> 00:31:12,799
so this last story is a pretty simple

987
00:31:12,799 --> 00:31:14,320
premise

988
00:31:14,320 --> 00:31:16,240
when you have a security analytics

989
00:31:16,240 --> 00:31:17,519
platform

990
00:31:17,519 --> 00:31:20,080
that can also execute code in other

991
00:31:20,080 --> 00:31:21,919
words one of the event notifications for

992
00:31:21,919 --> 00:31:22,880
greylog is

993
00:31:22,880 --> 00:31:25,600
running a script we have a security

994
00:31:25,600 --> 00:31:27,440
analytics platform that can also execute

995
00:31:27,440 --> 00:31:28,799
code run that script

996
00:31:28,799 --> 00:31:31,039
you now have something that can monitor

997
00:31:31,039 --> 00:31:32,720
for events

998
00:31:32,720 --> 00:31:36,159
then take actions the scripting part

999
00:31:36,159 --> 00:31:39,600
allows you to take any action what this

1000
00:31:39,600 --> 00:31:40,240
means

1001
00:31:40,240 --> 00:31:43,279
is you actually have a giant if this

1002
00:31:43,279 --> 00:31:46,799
than that engine when something happens

1003
00:31:46,799 --> 00:31:49,840
do something else the world is your

1004
00:31:49,840 --> 00:31:50,480
oyster

1005
00:31:50,480 --> 00:31:53,279
and this is how we abuse oysters this

1006
00:31:53,279 --> 00:31:55,200
particularly shifty student

1007
00:31:55,200 --> 00:31:57,600
had his usual home network monitoring

1008
00:31:57,600 --> 00:31:58,559
going on

1009
00:31:58,559 --> 00:32:00,399
it was actually just syslog from a

1010
00:32:00,399 --> 00:32:02,559
really boring you know commercial

1011
00:32:02,559 --> 00:32:04,880
wi-fi router he started parsing the

1012
00:32:04,880 --> 00:32:06,799
syslog events at one point and tagging

1013
00:32:06,799 --> 00:32:08,559
the dhcp records with the owner of the

1014
00:32:08,559 --> 00:32:09,600
devices

1015
00:32:09,600 --> 00:32:11,200
we started building up a bit of an

1016
00:32:11,200 --> 00:32:14,640
impromptu active asset management system

1017
00:32:14,640 --> 00:32:16,640
so when the kids will call them phoenix

1018
00:32:16,640 --> 00:32:17,760
and phalanx

1019
00:32:17,760 --> 00:32:20,000
or whatever their names were came home

1020
00:32:20,000 --> 00:32:21,679
he had a field he added a field to the

1021
00:32:21,679 --> 00:32:23,039
log saying

1022
00:32:23,039 --> 00:32:26,000
phoenix apple watch or phalanx's xbox

1023
00:32:26,000 --> 00:32:27,279
most of this stuff is kind of in there

1024
00:32:27,279 --> 00:32:28,480
unless they've renamed it something

1025
00:32:28,480 --> 00:32:30,080
silly

1026
00:32:30,080 --> 00:32:31,840
at one point or another he was trying to

1027
00:32:31,840 --> 00:32:33,120
build a bit of a

1028
00:32:33,120 --> 00:32:36,000
digital notification system a vendor

1029
00:32:36,000 --> 00:32:37,279
agnostic version

1030
00:32:37,279 --> 00:32:40,399
of the zoom attendee announcement kyle

1031
00:32:40,399 --> 00:32:42,399
has joined the meeting

1032
00:32:42,399 --> 00:32:45,600
but instead being balance has

1033
00:32:45,600 --> 00:32:48,000
entered the building that was the end

1034
00:32:48,000 --> 00:32:49,360
goal

1035
00:32:49,360 --> 00:32:51,360
while testing it out across his you know

1036
00:32:51,360 --> 00:32:53,360
sono system or google speaker group

1037
00:32:53,360 --> 00:32:55,440
whatever it was i believe his with sonos

1038
00:32:55,440 --> 00:32:58,640
he used some sample mp3 files before

1039
00:32:58,640 --> 00:33:00,000
working on the text to speak

1040
00:33:00,000 --> 00:33:03,440
speech component so you use these

1041
00:33:03,440 --> 00:33:05,279
sample mp3s you just kind of grabbed and

1042
00:33:05,279 --> 00:33:08,080
used this as part of it instead

1043
00:33:08,080 --> 00:33:10,399
it never made it to the text-to-speech

1044
00:33:10,399 --> 00:33:11,760
phase

1045
00:33:11,760 --> 00:33:14,159
he happened to choose some sample mp3s

1046
00:33:14,159 --> 00:33:14,880
that kind of

1047
00:33:14,880 --> 00:33:17,360
randomly match the personalities of his

1048
00:33:17,360 --> 00:33:19,519
family members

1049
00:33:19,519 --> 00:33:22,480
he by total accident using his log

1050
00:33:22,480 --> 00:33:23,840
management tool

1051
00:33:23,840 --> 00:33:26,799
a python script and some household tech

1052
00:33:26,799 --> 00:33:28,799
gave his entire family

1053
00:33:28,799 --> 00:33:39,840
wrestling style anthems

1054
00:33:40,570 --> 00:33:41,900
[Music]

1055
00:33:41,900 --> 00:33:42,560
[Applause]

1056
00:33:42,560 --> 00:33:43,080
[Music]

1057
00:33:43,080 --> 00:33:45,919
[Applause]

1058
00:33:45,919 --> 00:33:47,519
when they walked in the door and their

1059
00:33:47,519 --> 00:33:49,679
device is connected to the wi-fi

1060
00:33:49,679 --> 00:33:53,360
how perfect is that

1061
00:33:53,360 --> 00:33:55,360
no i don't want to simply regurgitate

1062
00:33:55,360 --> 00:33:56,960
someone else's story

1063
00:33:56,960 --> 00:33:59,200
so i obviously had to set up some poc

1064
00:33:59,200 --> 00:34:00,320
for this myself

1065
00:34:00,320 --> 00:34:03,440
great scot this was fun

1066
00:34:03,440 --> 00:34:07,039
check out my test sample video

1067
00:34:07,039 --> 00:34:11,040
my kids are really weird

1068
00:34:11,040 --> 00:34:13,839
now unfortunately due to calendar

1069
00:34:13,839 --> 00:34:15,520
getting snafus i had to ship this talk

1070
00:34:15,520 --> 00:34:17,119
before i could see this

1071
00:34:17,119 --> 00:34:19,679
all the way through to my end goal of

1072
00:34:19,679 --> 00:34:21,040
every time the word

1073
00:34:21,040 --> 00:34:24,159
minecraft was googled in my house

1074
00:34:24,159 --> 00:34:28,159
play this sample video on every tv

1075
00:34:28,159 --> 00:34:29,679
i did however get the latter part going

1076
00:34:29,679 --> 00:34:31,520
without any issue and so

1077
00:34:31,520 --> 00:34:34,159
and evil even able to run persistently

1078
00:34:34,159 --> 00:34:35,119
through the house

1079
00:34:35,119 --> 00:34:37,918
so here it is pleasantly interrupting an

1080
00:34:37,918 --> 00:34:39,119
unsuspecting

1081
00:34:39,119 --> 00:34:42,480
innocent child who was politely asked to

1082
00:34:42,480 --> 00:34:43,679
lower the volume

1083
00:34:43,679 --> 00:34:47,599
on their youtube videos several times

1084
00:34:47,599 --> 00:34:51,040
now they get some geek dad wrath

1085
00:34:51,040 --> 00:34:53,119
movie file set up properly hopefully

1086
00:34:53,119 --> 00:34:54,800
that worked it's a one-liner

1087
00:34:54,800 --> 00:34:57,680
we're serving it up just python http

1088
00:34:57,680 --> 00:34:58,720
server

1089
00:34:58,720 --> 00:35:01,440
and behind my lovely face is the folder

1090
00:35:01,440 --> 00:35:03,839
so

1091
00:35:04,320 --> 00:35:07,200
there we go already set it up let's see

1092
00:35:07,200 --> 00:35:10,480
what we got when we run it

1093
00:35:10,960 --> 00:35:17,839
quick hijack of the chromecast

1094
00:35:20,800 --> 00:35:25,230
[Laughter]

1095
00:35:26,880 --> 00:35:29,520
if that isn't modern day parenting at

1096
00:35:29,520 --> 00:35:30,320
its finest

1097
00:35:30,320 --> 00:35:33,839
i don't know what is i wish i had more

1098
00:35:33,839 --> 00:35:34,320
time

1099
00:35:34,320 --> 00:35:35,520
and that we could talk about stories

1100
00:35:35,520 --> 00:35:37,599
like this all day

1101
00:35:37,599 --> 00:35:40,320
one more time i'm abe find me posting

1102
00:35:40,320 --> 00:35:42,079
nonsense on twitter linkedin github you

1103
00:35:42,079 --> 00:35:43,280
can follow me

1104
00:35:43,280 --> 00:35:45,920
at big ab20 follow at greylog for

1105
00:35:45,920 --> 00:35:47,359
awesome stuff

1106
00:35:47,359 --> 00:35:49,760
big thanks to everyone at blue team

1107
00:35:49,760 --> 00:35:50,480
village

1108
00:35:50,480 --> 00:35:52,240
more shout outs to everyone at def con

1109
00:35:52,240 --> 00:35:54,800
29 you've put on a really awesome show

1110
00:35:54,800 --> 00:35:55,680
this year

1111
00:35:55,680 --> 00:35:59,520
despite the um learning opportunities

1112
00:35:59,520 --> 00:36:02,000
see always a manager and thanks to my

1113
00:36:02,000 --> 00:36:03,760
team at greylog for always moving the

1114
00:36:03,760 --> 00:36:05,839
finish line and making a great tool

1115
00:36:05,839 --> 00:36:08,480
last and most important thanks for

1116
00:36:08,480 --> 00:36:09,920
checking out my talk and staying right

1117
00:36:09,920 --> 00:36:11,280
to the end i will see you

1118
00:36:11,280 --> 00:36:16,079
all around enjoy devcon

