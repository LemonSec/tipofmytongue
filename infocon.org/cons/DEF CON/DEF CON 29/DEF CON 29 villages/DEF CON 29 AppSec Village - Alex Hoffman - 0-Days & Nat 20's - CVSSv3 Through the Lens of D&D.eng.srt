1
00:00:01,280 --> 00:00:03,360
all right good morning defcon

2
00:00:03,360 --> 00:00:05,359
appsec village i am here today to talk

3
00:00:05,359 --> 00:00:06,560
to you about something near and dear to

4
00:00:06,560 --> 00:00:07,200
my heart

5
00:00:07,200 --> 00:00:08,720
something that makes pen testers jump

6
00:00:08,720 --> 00:00:10,719
for joy blue teamers just sitting on the

7
00:00:10,719 --> 00:00:12,240
edge of their seat and i.t

8
00:00:12,240 --> 00:00:14,160
professionals just do their happy dance

9
00:00:14,160 --> 00:00:15,759
that's right i am talking today about

10
00:00:15,759 --> 00:00:16,079
the

11
00:00:16,079 --> 00:00:20,639
common vulnerability scoring system

12
00:00:23,199 --> 00:00:24,640
okay this is pre-recorded so i don't

13
00:00:24,640 --> 00:00:25,840
have any real-time feedback but i'm

14
00:00:25,840 --> 00:00:26,880
going to go ahead and assume everybody's

15
00:00:26,880 --> 00:00:27,920
just jumping up and down

16
00:00:27,920 --> 00:00:30,640
super excited and cheering wildly and

17
00:00:30,640 --> 00:00:32,320
okay look i get it

18
00:00:32,320 --> 00:00:34,079
vulnerability scoring metrics is not the

19
00:00:34,079 --> 00:00:35,360
most exciting topic

20
00:00:35,360 --> 00:00:36,880
what i'd like to do today is take an

21
00:00:36,880 --> 00:00:39,200
opportunity to present it in a fun

22
00:00:39,200 --> 00:00:41,680
and unique light and hopefully you'll be

23
00:00:41,680 --> 00:00:43,360
able to gain a better understanding of

24
00:00:43,360 --> 00:00:43,680
how

25
00:00:43,680 --> 00:00:46,960
cvss and scoring metrics can work for

26
00:00:46,960 --> 00:00:47,440
you

27
00:00:47,440 --> 00:00:48,879
and bring back your organizations to

28
00:00:48,879 --> 00:00:51,039
help better assess

29
00:00:51,039 --> 00:00:53,760
vulnerabilities and their severity a

30
00:00:53,760 --> 00:00:56,079
little bit about myself before we begin

31
00:00:56,079 --> 00:00:59,120
my name is alex hoffman or red wedge x i

32
00:00:59,120 --> 00:01:01,039
am a pen tester red teamer at

33
00:01:01,039 --> 00:01:03,600
viasat a cyber security instructor at

34
00:01:03,600 --> 00:01:04,720
california state

35
00:01:04,720 --> 00:01:06,960
university long beach a ham radio

36
00:01:06,960 --> 00:01:07,760
enthusiast

37
00:01:07,760 --> 00:01:09,520
i'm a husband a father to three great

38
00:01:09,520 --> 00:01:12,159
kids a d d player and dungeon master in

39
00:01:12,159 --> 00:01:13,920
my spare time when i do have spare time

40
00:01:13,920 --> 00:01:15,600
which is not often

41
00:01:15,600 --> 00:01:17,439
also on staff of cactus con which is

42
00:01:17,439 --> 00:01:19,439
arizona's infosec conference

43
00:01:19,439 --> 00:01:22,000
and an admin at the vetcon discord which

44
00:01:22,000 --> 00:01:23,119
is for veterans in

45
00:01:23,119 --> 00:01:25,600
infosec and in general i'm an all-around

46
00:01:25,600 --> 00:01:27,480
great guy if i do say so myself

47
00:01:27,480 --> 00:01:30,400
[Laughter]

48
00:01:30,400 --> 00:01:32,159
and clearly i also have access to

49
00:01:32,159 --> 00:01:33,520
buttons with sound effects and i'm not

50
00:01:33,520 --> 00:01:35,600
afraid to use them so apologies

51
00:01:35,600 --> 00:01:38,240
in advance for that uh i'll go ahead and

52
00:01:38,240 --> 00:01:39,759
throw out the obligatory presentation

53
00:01:39,759 --> 00:01:41,360
and opinions are my own

54
00:01:41,360 --> 00:01:43,280
and have not been vetted or approved by

55
00:01:43,280 --> 00:01:45,119
my employers

56
00:01:45,119 --> 00:01:46,640
okay so we need to have a basic

57
00:01:46,640 --> 00:01:49,119
understanding first about what cbss is

58
00:01:49,119 --> 00:01:50,880
so cvss or the common vulnerability

59
00:01:50,880 --> 00:01:52,720
scoring system is a free and open

60
00:01:52,720 --> 00:01:54,320
industry standard

61
00:01:54,320 --> 00:01:56,560
it's been around since 2005 and the goal

62
00:01:56,560 --> 00:01:57,680
is to measure severity of a

63
00:01:57,680 --> 00:01:59,360
vulnerability while taking into account

64
00:01:59,360 --> 00:02:00,640
risk

65
00:02:00,640 --> 00:02:02,399
you know as a tool that can be used by

66
00:02:02,399 --> 00:02:03,840
both security professionals

67
00:02:03,840 --> 00:02:05,360
and system administrators or product

68
00:02:05,360 --> 00:02:07,360
owners as a pen tester i use it to

69
00:02:07,360 --> 00:02:09,360
provide accurate measurable findings to

70
00:02:09,360 --> 00:02:10,479
my customers

71
00:02:10,479 --> 00:02:11,760
as a defender you can use it to

72
00:02:11,760 --> 00:02:13,440
understand risk as it applies to your

73
00:02:13,440 --> 00:02:14,160
environment

74
00:02:14,160 --> 00:02:16,959
and to triage defense and remediation

75
00:02:16,959 --> 00:02:18,239
recommendations

76
00:02:18,239 --> 00:02:19,760
as a system administrator network

77
00:02:19,760 --> 00:02:21,280
engineer you can use it to prioritize

78
00:02:21,280 --> 00:02:22,000
patching

79
00:02:22,000 --> 00:02:24,080
or better understand ways to reduce risk

80
00:02:24,080 --> 00:02:25,520
using the temporal and environmental

81
00:02:25,520 --> 00:02:28,319
scores that we'll talk about later

82
00:02:28,319 --> 00:02:29,920
so cvss is owned and managed by

83
00:02:29,920 --> 00:02:31,760
first.org i've got a link up on the

84
00:02:31,760 --> 00:02:32,319
screen

85
00:02:32,319 --> 00:02:35,519
to the calculator on first.org for cvss

86
00:02:35,519 --> 00:02:37,440
you can go ahead and pop that into a

87
00:02:37,440 --> 00:02:39,440
browser or just google search for cvss

88
00:02:39,440 --> 00:02:40,560
calculator it's going to be the first or

89
00:02:40,560 --> 00:02:42,160
second thing that comes up

90
00:02:42,160 --> 00:02:43,680
but i will be using screenshots from

91
00:02:43,680 --> 00:02:44,879
that calculator throughout this

92
00:02:44,879 --> 00:02:46,319
presentation

93
00:02:46,319 --> 00:02:48,239
one more caveat i will not be talking

94
00:02:48,239 --> 00:02:50,640
today about the algorithms or formulas

95
00:02:50,640 --> 00:02:52,480
or the math that goes into determining

96
00:02:52,480 --> 00:02:53,519
scores

97
00:02:53,519 --> 00:02:55,680
honestly i'm just a simple caveman so

98
00:02:55,680 --> 00:02:56,879
numbers bigger than 10

99
00:02:56,879 --> 00:02:59,120
confuse and frighten me but we will be

100
00:02:59,120 --> 00:03:00,560
talking about the metrics that go into

101
00:03:00,560 --> 00:03:02,239
the scores and how to use them but not

102
00:03:02,239 --> 00:03:05,360
the math involved specifically

103
00:03:05,360 --> 00:03:07,200
all right so when i mention cvss i'm

104
00:03:07,200 --> 00:03:08,560
guessing the first thing that pops into

105
00:03:08,560 --> 00:03:09,599
everybody's mind

106
00:03:09,599 --> 00:03:11,680
are the qualitative severity ratings

107
00:03:11,680 --> 00:03:12,720
these are those big

108
00:03:12,720 --> 00:03:15,680
red or orange or yellow words like

109
00:03:15,680 --> 00:03:16,159
critical

110
00:03:16,159 --> 00:03:18,800
high medium things that you see on the

111
00:03:18,800 --> 00:03:20,400
top of an executive summary or

112
00:03:20,400 --> 00:03:22,560
in briefings to leadership or even on

113
00:03:22,560 --> 00:03:24,239
your your expos and

114
00:03:24,239 --> 00:03:26,879
nessus output reports and those are

115
00:03:26,879 --> 00:03:28,480
great and they are often accompanied by

116
00:03:28,480 --> 00:03:30,640
a cvss score like 4.2

117
00:03:30,640 --> 00:03:33,120
9.8 and like i said those are really

118
00:03:33,120 --> 00:03:34,879
good to brief to executives

119
00:03:34,879 --> 00:03:36,640
because an executive will look at a

120
00:03:36,640 --> 00:03:38,239
critical 9.8 and go oh

121
00:03:38,239 --> 00:03:41,120
that's really bad we should fix it or a

122
00:03:41,120 --> 00:03:43,440
2.4 low and go that's not so bad i think

123
00:03:43,440 --> 00:03:44,480
we're okay

124
00:03:44,480 --> 00:03:46,319
and that's fine and that's great for

125
00:03:46,319 --> 00:03:48,239
those particular subset

126
00:03:48,239 --> 00:03:50,480
of people looking at them but it's

127
00:03:50,480 --> 00:03:51,360
lacking a

128
00:03:51,360 --> 00:03:54,000
good bit of context and what i mean by

129
00:03:54,000 --> 00:03:55,760
that is the question i get asked

130
00:03:55,760 --> 00:03:59,360
often when i'm briefing the qsrs and the

131
00:03:59,360 --> 00:04:00,720
cvss score is

132
00:04:00,720 --> 00:04:02,959
how did you get that number because i

133
00:04:02,959 --> 00:04:04,400
could just say yeah it's a critical

134
00:04:04,400 --> 00:04:06,239
and you know people are going to look at

135
00:04:06,239 --> 00:04:08,319
me and say why is it critical how did

136
00:04:08,319 --> 00:04:09,599
you determine it's a critical

137
00:04:09,599 --> 00:04:11,200
did you just pull that number out of

138
00:04:11,200 --> 00:04:12,400
thin air is there some sort of

139
00:04:12,400 --> 00:04:14,000
super-secret rubric

140
00:04:14,000 --> 00:04:15,519
that you're using to try to determine

141
00:04:15,519 --> 00:04:17,839
that and so the piece that's missing

142
00:04:17,839 --> 00:04:18,560
here

143
00:04:18,560 --> 00:04:21,519
is what's called the cvss vector string

144
00:04:21,519 --> 00:04:23,280
the cvss vector string

145
00:04:23,280 --> 00:04:26,080
is a text representation of a set of cvs

146
00:04:26,080 --> 00:04:26,800
metrics

147
00:04:26,800 --> 00:04:29,919
it looks like this and it's used to

148
00:04:29,919 --> 00:04:30,479
impart

149
00:04:30,479 --> 00:04:32,479
to the person that's that's receiving

150
00:04:32,479 --> 00:04:33,759
the report person on the other side of

151
00:04:33,759 --> 00:04:34,720
the table

152
00:04:34,720 --> 00:04:37,520
everything that went into your decision

153
00:04:37,520 --> 00:04:38,720
as an assessor

154
00:04:38,720 --> 00:04:40,880
on why you decided this was critical

155
00:04:40,880 --> 00:04:43,199
high medium or whatever score it was

156
00:04:43,199 --> 00:04:46,240
so you're able to give the person more

157
00:04:46,240 --> 00:04:48,479
details than just it's bad and explain

158
00:04:48,479 --> 00:04:50,320
what made you come to the decision it's

159
00:04:50,320 --> 00:04:51,680
bad or not bad

160
00:04:51,680 --> 00:04:54,720
what about it specifically is bad why is

161
00:04:54,720 --> 00:04:56,320
this vulnerability severe

162
00:04:56,320 --> 00:04:59,360
why isn't it how can you understand it

163
00:04:59,360 --> 00:05:00,560
better

164
00:05:00,560 --> 00:05:02,400
and here's another interesting tidbit

165
00:05:02,400 --> 00:05:04,960
according to the user's guide for cvss

166
00:05:04,960 --> 00:05:07,520
whenever you publish a score and a qsr

167
00:05:07,520 --> 00:05:09,840
you're actually required to also provide

168
00:05:09,840 --> 00:05:11,280
the scoring vector string

169
00:05:11,280 --> 00:05:12,720
so that others can understand how the

170
00:05:12,720 --> 00:05:14,880
score was derived

171
00:05:14,880 --> 00:05:16,639
and and to be quite frank i've looked at

172
00:05:16,639 --> 00:05:18,240
a lot of pen test reports and a lot of

173
00:05:18,240 --> 00:05:19,360
tool outputs

174
00:05:19,360 --> 00:05:22,560
and i rarely see the cdss vector string

175
00:05:22,560 --> 00:05:25,360
you know published with the scores and

176
00:05:25,360 --> 00:05:27,199
and i think that's that's a vital thing

177
00:05:27,199 --> 00:05:28,880
yeah it's required but it's also pretty

178
00:05:28,880 --> 00:05:31,199
vital in order to better

179
00:05:31,199 --> 00:05:33,840
like i said impart the reasons behind

180
00:05:33,840 --> 00:05:34,720
the scoring

181
00:05:34,720 --> 00:05:38,080
to the consumer of the score okay so

182
00:05:38,080 --> 00:05:39,840
quick little story time i was playing

183
00:05:39,840 --> 00:05:41,120
dungeons dragons at work

184
00:05:41,120 --> 00:05:43,440
with some co-workers during lunch like

185
00:05:43,440 --> 00:05:44,800
you know like we do

186
00:05:44,800 --> 00:05:46,880
and i headed back to my office after the

187
00:05:46,880 --> 00:05:48,880
game and i started working on a pen test

188
00:05:48,880 --> 00:05:50,000
report

189
00:05:50,000 --> 00:05:52,080
and as i'm going through writing cvss

190
00:05:52,080 --> 00:05:53,440
vector strings and scores

191
00:05:53,440 --> 00:05:56,000
it dawned on me the similarities between

192
00:05:56,000 --> 00:05:57,440
what i was looking at on the cvss

193
00:05:57,440 --> 00:05:58,319
calculator

194
00:05:58,319 --> 00:06:00,800
and at dungeons dragons character sheet

195
00:06:00,800 --> 00:06:02,479
so what i did is i took

196
00:06:02,479 --> 00:06:05,360
that you know the standard stats block

197
00:06:05,360 --> 00:06:06,560
from d and d

198
00:06:06,560 --> 00:06:08,479
and i formatted it in the same way as a

199
00:06:08,479 --> 00:06:10,240
cvss vector string and it looks

200
00:06:10,240 --> 00:06:12,240
something like this

201
00:06:12,240 --> 00:06:13,680
so if you're a dungeons and dragons

202
00:06:13,680 --> 00:06:16,000
player and i show you this line

203
00:06:16,000 --> 00:06:17,600
you immediately know what i'm trying to

204
00:06:17,600 --> 00:06:19,520
say we're playing dungeons dragons

205
00:06:19,520 --> 00:06:21,600
there's a version number fifth edition

206
00:06:21,600 --> 00:06:23,280
and the characters strength dexterity

207
00:06:23,280 --> 00:06:25,120
constitution intelligence wisdom and

208
00:06:25,120 --> 00:06:26,560
charisma scores right there on the

209
00:06:26,560 --> 00:06:27,680
screen

210
00:06:27,680 --> 00:06:29,600
now as a d d player i'm not going to be

211
00:06:29,600 --> 00:06:31,600
able to give you that single line

212
00:06:31,600 --> 00:06:32,800
and you'll be able to go play that

213
00:06:32,800 --> 00:06:34,800
character you're missing a lot of pieces

214
00:06:34,800 --> 00:06:36,560
of information

215
00:06:36,560 --> 00:06:39,919
things like your initiative bonus

216
00:06:39,919 --> 00:06:43,280
or armor class

217
00:06:43,280 --> 00:06:45,280
weapons all of those things are are

218
00:06:45,280 --> 00:06:46,560
missing from this

219
00:06:46,560 --> 00:06:48,560
but as a d d player if you look at this

220
00:06:48,560 --> 00:06:50,720
you could know a little bit about

221
00:06:50,720 --> 00:06:52,720
this character and why they're capable

222
00:06:52,720 --> 00:06:54,000
of what they're capable of

223
00:06:54,000 --> 00:06:55,599
for example this character is relatively

224
00:06:55,599 --> 00:06:57,039
strong

225
00:06:57,039 --> 00:06:59,520
he has a very high constitution he's

226
00:06:59,520 --> 00:07:00,880
pretty dumb

227
00:07:00,880 --> 00:07:03,440
uh like i said that gives you an

228
00:07:03,440 --> 00:07:04,800
understanding of how they're able to

229
00:07:04,800 --> 00:07:06,880
play the character how the character

230
00:07:06,880 --> 00:07:09,919
thinks acts and does what they do

231
00:07:09,919 --> 00:07:11,759
so what i thought would be a cool way to

232
00:07:11,759 --> 00:07:14,319
figure out how to learn cvss and make it

233
00:07:14,319 --> 00:07:16,000
fun and exciting was to step

234
00:07:16,000 --> 00:07:18,240
through a dungeon adventure we'll

235
00:07:18,240 --> 00:07:20,000
actually play a game of d and d

236
00:07:20,000 --> 00:07:22,400
but instead of using a character sheet

237
00:07:22,400 --> 00:07:24,560
we're going to use a cdss vector string

238
00:07:24,560 --> 00:07:25,120
to step

239
00:07:25,120 --> 00:07:28,319
through this dungeon encounter okay so

240
00:07:28,319 --> 00:07:30,000
i'm going to go ahead and take off my

241
00:07:30,000 --> 00:07:31,840
infosec professional and defcon

242
00:07:31,840 --> 00:07:33,759
presenter hat and put on my dungeon

243
00:07:33,759 --> 00:07:35,919
master robes for a moment

244
00:07:35,919 --> 00:07:37,360
and let's go ahead and introduce you to

245
00:07:37,360 --> 00:07:40,880
our character for this dungeon crawl

246
00:07:40,880 --> 00:07:44,000
this is confluentis he is a dwarf bard

247
00:07:44,000 --> 00:07:45,919
a historian and capable fighter who

248
00:07:45,919 --> 00:07:48,319
travels the realm adventuring

249
00:07:48,319 --> 00:07:50,560
thirsting for knowledge combat and a

250
00:07:50,560 --> 00:07:53,199
good cup of java

251
00:07:53,199 --> 00:07:54,400
all right so we'll meet up with

252
00:07:54,400 --> 00:07:57,120
confluentis and find out about our story

253
00:07:57,120 --> 00:07:59,840
so far

254
00:07:59,840 --> 00:08:02,879
our hero confluentis has wandered the

255
00:08:02,879 --> 00:08:04,080
land of internetia

256
00:08:04,080 --> 00:08:07,360
for 15 years he has traversed at the

257
00:08:07,360 --> 00:08:09,280
sub-oceanic light ways

258
00:08:09,280 --> 00:08:12,319
the series of elven tubes and adventured

259
00:08:12,319 --> 00:08:14,960
beyond the stars and back he has

260
00:08:14,960 --> 00:08:15,599
collected

261
00:08:15,599 --> 00:08:18,240
vast libraries of knowledge and the

262
00:08:18,240 --> 00:08:20,319
monks of the devops monastery

263
00:08:20,319 --> 00:08:23,520
in the land of jura have taken him

264
00:08:23,520 --> 00:08:27,120
as their foretold champion but today

265
00:08:27,120 --> 00:08:30,000
he faces his greatest threat yet he has

266
00:08:30,000 --> 00:08:30,879
ventured far

267
00:08:30,879 --> 00:08:32,958
from home to a place feared by

268
00:08:32,958 --> 00:08:34,240
professionals

269
00:08:34,240 --> 00:08:37,440
today he encounters the tomb

270
00:08:37,440 --> 00:08:41,599
of zero day

271
00:08:41,599 --> 00:08:43,599
confluent is triumphantly storms from

272
00:08:43,599 --> 00:08:45,839
room to room destroying all that stands

273
00:08:45,839 --> 00:08:46,959
in his way

274
00:08:46,959 --> 00:08:51,680
he stands tall uninjured undamaged

275
00:08:51,680 --> 00:08:55,040
he feels it he knows he must be close

276
00:08:55,040 --> 00:08:57,880
the prize will be his the cloak of

277
00:08:57,880 --> 00:08:59,120
invulnerability

278
00:08:59,120 --> 00:09:02,000
must be through this last door he bursts

279
00:09:02,000 --> 00:09:02,560
in

280
00:09:02,560 --> 00:09:06,719
and finds himself face to face with our

281
00:09:06,839 --> 00:09:09,240
villain

282
00:09:09,240 --> 00:09:12,279
cryptokids666 who is

283
00:09:12,279 --> 00:09:15,120
cryptokids666 we don't know

284
00:09:15,120 --> 00:09:16,959
could be a chaotic neutral kid just

285
00:09:16,959 --> 00:09:18,959
trying to see what they can see

286
00:09:18,959 --> 00:09:20,800
could be a lawful evil state actor

287
00:09:20,800 --> 00:09:22,959
trying to bring glory to their homeland

288
00:09:22,959 --> 00:09:25,040
or a corporate entity with nefarious

289
00:09:25,040 --> 00:09:26,000
intentions

290
00:09:26,000 --> 00:09:28,080
trying to steal trade secrets or raise

291
00:09:28,080 --> 00:09:29,760
stock prices

292
00:09:29,760 --> 00:09:32,480
who knows

293
00:09:34,440 --> 00:09:36,560
cryptokid666 quickly thumbs through the

294
00:09:36,560 --> 00:09:37,279
spell book

295
00:09:37,279 --> 00:09:40,399
a rise smile creeping across thin lips

296
00:09:40,399 --> 00:09:43,279
in a long dead language the words flow

297
00:09:43,279 --> 00:09:45,120
casting the ancient spell

298
00:09:45,120 --> 00:09:51,120
of cve 2019-3396

299
00:09:51,120 --> 00:09:56,560
confluence server before 6.6.12

300
00:09:56,560 --> 00:09:59,120
i achieve path traversal via a

301
00:09:59,120 --> 00:10:01,839
server-side template injection weakness

302
00:10:01,839 --> 00:10:05,200
in your wizard connect component

303
00:10:05,200 --> 00:10:07,440
confluentist feels weak and falls to his

304
00:10:07,440 --> 00:10:08,920
knees

305
00:10:08,920 --> 00:10:13,199
cryptokids666 rolls for damage

306
00:10:14,720 --> 00:10:16,320
all right so that brings us to the

307
00:10:16,320 --> 00:10:18,800
attack roll or in cvss terms we are

308
00:10:18,800 --> 00:10:21,120
talking about the base scores

309
00:10:21,120 --> 00:10:23,440
the cvss base score reflects severity

310
00:10:23,440 --> 00:10:24,720
according to its intrinsic

311
00:10:24,720 --> 00:10:26,000
characteristics

312
00:10:26,000 --> 00:10:29,519
it's a worst case scenario in a vacuum

313
00:10:29,519 --> 00:10:31,120
these scores are typically produced and

314
00:10:31,120 --> 00:10:32,640
provided by the organization maintaining

315
00:10:32,640 --> 00:10:33,920
the votable product

316
00:10:33,920 --> 00:10:36,000
or someone on their behalf but the thing

317
00:10:36,000 --> 00:10:38,160
to know about cvss base scores is they

318
00:10:38,160 --> 00:10:39,519
do not change

319
00:10:39,519 --> 00:10:41,200
again these are worst case scenario

320
00:10:41,200 --> 00:10:43,519
scores it does not take into account

321
00:10:43,519 --> 00:10:46,079
the existence of patches or published

322
00:10:46,079 --> 00:10:47,040
pocs

323
00:10:47,040 --> 00:10:49,200
it doesn't matter about your environment

324
00:10:49,200 --> 00:10:51,120
how your system has it deployed

325
00:10:51,120 --> 00:10:53,200
what sort of protections in place the

326
00:10:53,200 --> 00:10:54,320
base score will not

327
00:10:54,320 --> 00:10:56,800
change based on who is assessing the

328
00:10:56,800 --> 00:10:57,440
system

329
00:10:57,440 --> 00:10:58,880
the base score would be the same if this

330
00:10:58,880 --> 00:11:01,279
is an air gap system sitting in a vault

331
00:11:01,279 --> 00:11:03,040
or if it's public facing the internet

332
00:11:03,040 --> 00:11:04,720
with no protections whatsoever

333
00:11:04,720 --> 00:11:08,000
the base score does not change

334
00:11:08,000 --> 00:11:09,120
all right so let's go through each of

335
00:11:09,120 --> 00:11:10,720
these metrics real quick and try and get

336
00:11:10,720 --> 00:11:12,160
an understanding of how they work and

337
00:11:12,160 --> 00:11:13,360
then we'll go ahead and throw our

338
00:11:13,360 --> 00:11:14,000
situation

339
00:11:14,000 --> 00:11:18,399
onto the calculator so the attack vector

340
00:11:18,399 --> 00:11:21,120
is how the attacker would be able to

341
00:11:21,120 --> 00:11:22,800
exploit this vulnerability what path

342
00:11:22,800 --> 00:11:24,480
would they need to take

343
00:11:24,480 --> 00:11:26,560
if it's network it means it's obviously

344
00:11:26,560 --> 00:11:28,640
over a network up to and including the

345
00:11:28,640 --> 00:11:29,920
entire internet

346
00:11:29,920 --> 00:11:31,519
adjacent means it will be limited to

347
00:11:31,519 --> 00:11:32,959
adjacent network topology

348
00:11:32,959 --> 00:11:34,480
like a shared physical or logical

349
00:11:34,480 --> 00:11:36,240
network or secure limited environment

350
00:11:36,240 --> 00:11:38,240
like a vpn

351
00:11:38,240 --> 00:11:39,839
local means i need to have some access

352
00:11:39,839 --> 00:11:42,560
to run commands on the box so think ssh

353
00:11:42,560 --> 00:11:43,120
session

354
00:11:43,120 --> 00:11:46,480
or remote desktop or even reverse shell

355
00:11:46,480 --> 00:11:47,920
and physical means i have to have

356
00:11:47,920 --> 00:11:49,920
physical access to the vulnerable

357
00:11:49,920 --> 00:11:51,600
component i have to be able to touch it

358
00:11:51,600 --> 00:11:53,120
with my hands

359
00:11:53,120 --> 00:11:56,000
and execute things physically being

360
00:11:56,000 --> 00:11:58,240
there

361
00:11:58,240 --> 00:11:59,839
attack complexity these are the things

362
00:11:59,839 --> 00:12:01,279
that the attacker can't control

363
00:12:01,279 --> 00:12:03,839
if something is low complexity it means

364
00:12:03,839 --> 00:12:05,519
it's going to work every time regardless

365
00:12:05,519 --> 00:12:07,680
of extenuating circumstances

366
00:12:07,680 --> 00:12:09,600
where a high complexity means that

367
00:12:09,600 --> 00:12:10,959
there's things beyond the attacker's

368
00:12:10,959 --> 00:12:12,399
control that already have to be in place

369
00:12:12,399 --> 00:12:12,959
or done

370
00:12:12,959 --> 00:12:14,560
before the attacker can exploit the

371
00:12:14,560 --> 00:12:16,399
vulnerability so

372
00:12:16,399 --> 00:12:18,000
it's like a specific component must be

373
00:12:18,000 --> 00:12:19,760
enabled or configured in a very certain

374
00:12:19,760 --> 00:12:21,680
way to make the attack possible

375
00:12:21,680 --> 00:12:23,279
since enabling those components is

376
00:12:23,279 --> 00:12:24,800
beyond the attacker's control

377
00:12:24,800 --> 00:12:28,000
it's considered high complexity

378
00:12:28,000 --> 00:12:29,519
and privileges required these are the

379
00:12:29,519 --> 00:12:31,600
things the attacker already has to have

380
00:12:31,600 --> 00:12:32,240
before

381
00:12:32,240 --> 00:12:34,320
being able to exploit the vulnerability

382
00:12:34,320 --> 00:12:36,320
so none is self-explanatory this is an

383
00:12:36,320 --> 00:12:38,320
unauthenticated vulnerability

384
00:12:38,320 --> 00:12:39,920
low means the attacker already has to

385
00:12:39,920 --> 00:12:42,399
have some user level permissions

386
00:12:42,399 --> 00:12:43,519
like a privilege escalation

387
00:12:43,519 --> 00:12:44,880
vulnerability typically would be low

388
00:12:44,880 --> 00:12:46,240
privileges required

389
00:12:46,240 --> 00:12:47,839
whereas high means they already have to

390
00:12:47,839 --> 00:12:49,360
have privileged access

391
00:12:49,360 --> 00:12:51,519
either root admin nt authority system

392
00:12:51,519 --> 00:12:53,040
things like that

393
00:12:53,040 --> 00:12:54,560
and that's the the difference between

394
00:12:54,560 --> 00:12:58,319
none low and high in privileges required

395
00:12:59,120 --> 00:13:01,760
all right so user interaction basically

396
00:13:01,760 --> 00:13:02,720
this means

397
00:13:02,720 --> 00:13:06,079
does the attack rely on a

398
00:13:06,079 --> 00:13:08,320
user on the system to do something in

399
00:13:08,320 --> 00:13:09,920
order for you to exploit it

400
00:13:09,920 --> 00:13:12,639
so your choices are none or required if

401
00:13:12,639 --> 00:13:13,760
it's required it means

402
00:13:13,760 --> 00:13:15,360
you need them to click a link visit a

403
00:13:15,360 --> 00:13:17,920
website

404
00:13:18,240 --> 00:13:19,920
enable macros on a word document things

405
00:13:19,920 --> 00:13:21,680
like that have to be in

406
00:13:21,680 --> 00:13:24,000
done have to be in place for the attack

407
00:13:24,000 --> 00:13:26,240
to work you're required to have the user

408
00:13:26,240 --> 00:13:28,639
do something

409
00:13:28,639 --> 00:13:31,120
okay and that brings us to scope scope

410
00:13:31,120 --> 00:13:32,399
in my opinion is probably the most

411
00:13:32,399 --> 00:13:33,440
misunderstood

412
00:13:33,440 --> 00:13:37,279
misused and miss scored metric in cvss

413
00:13:37,279 --> 00:13:40,000
it's relatively complicated and so much

414
00:13:40,000 --> 00:13:42,000
so that in the most recent revision 3.1

415
00:13:42,000 --> 00:13:43,279
of cbss

416
00:13:43,279 --> 00:13:44,800
it was actually rewritten to try and

417
00:13:44,800 --> 00:13:47,120
make it easier to understand

418
00:13:47,120 --> 00:13:48,880
so i want to go take a few extra minutes

419
00:13:48,880 --> 00:13:50,399
and talk about scope so we kind of get a

420
00:13:50,399 --> 00:13:51,839
better understanding of how to use it

421
00:13:51,839 --> 00:13:52,480
properly

422
00:13:52,480 --> 00:13:54,320
because i've seen it misused and miss

423
00:13:54,320 --> 00:13:55,680
scored so many times

424
00:13:55,680 --> 00:13:57,680
because as a pen tester when i think of

425
00:13:57,680 --> 00:13:59,120
the word scope i'm thinking of the

426
00:13:59,120 --> 00:14:00,720
things i'm allowed to hack

427
00:14:00,720 --> 00:14:02,560
you know i can get into this box and if

428
00:14:02,560 --> 00:14:04,079
i get into this box i have changed my

429
00:14:04,079 --> 00:14:05,760
scope i've broken scope

430
00:14:05,760 --> 00:14:07,040
or you know the other thing that comes

431
00:14:07,040 --> 00:14:08,800
to mind when i think of scope as far as

432
00:14:08,800 --> 00:14:10,160
vulnerability is

433
00:14:10,160 --> 00:14:12,480
if i can pivot to another host that must

434
00:14:12,480 --> 00:14:14,320
be a change in scope because i've now

435
00:14:14,320 --> 00:14:15,839
gone out of this box

436
00:14:15,839 --> 00:14:18,399
none of that matters in cvss scope

437
00:14:18,399 --> 00:14:19,519
scoring

438
00:14:19,519 --> 00:14:20,480
all right there's some things you need

439
00:14:20,480 --> 00:14:23,600
to identify first before you score scope

440
00:14:23,600 --> 00:14:25,120
you need to identify the vulnerable

441
00:14:25,120 --> 00:14:27,600
component and the impacted component

442
00:14:27,600 --> 00:14:28,880
the vulnerable component is what it

443
00:14:28,880 --> 00:14:30,560
sounds like it's the thing that has the

444
00:14:30,560 --> 00:14:31,600
vulnerability

445
00:14:31,600 --> 00:14:33,680
the impacting component is the thing

446
00:14:33,680 --> 00:14:34,720
that gets pwned

447
00:14:34,720 --> 00:14:37,440
popped denial of service or whatever

448
00:14:37,440 --> 00:14:39,120
once you are able to exploit the

449
00:14:39,120 --> 00:14:40,399
vulnerable component

450
00:14:40,399 --> 00:14:42,000
sometimes those are the same sometimes

451
00:14:42,000 --> 00:14:43,680
they're different all right so once

452
00:14:43,680 --> 00:14:44,000
we've

453
00:14:44,000 --> 00:14:45,600
identified the vulnerable component in

454
00:14:45,600 --> 00:14:48,000
the impact component we need to identify

455
00:14:48,000 --> 00:14:50,320
the security authority for each of them

456
00:14:50,320 --> 00:14:52,079
the security authority is the thing that

457
00:14:52,079 --> 00:14:54,079
controls security for that particular

458
00:14:54,079 --> 00:14:55,120
component

459
00:14:55,120 --> 00:14:57,040
and once we've identified the security

460
00:14:57,040 --> 00:14:58,560
authority for each of those two

461
00:14:58,560 --> 00:15:00,240
different things we compare them

462
00:15:00,240 --> 00:15:02,000
if the if they are under the same

463
00:15:02,000 --> 00:15:03,440
security authority

464
00:15:03,440 --> 00:15:05,760
the scope is unchanged if the security

465
00:15:05,760 --> 00:15:07,040
authority are different they're in

466
00:15:07,040 --> 00:15:08,560
different security scopes

467
00:15:08,560 --> 00:15:11,120
then the scope is changed and we mark it

468
00:15:11,120 --> 00:15:12,800
as such in cbss

469
00:15:12,800 --> 00:15:13,680
all right so let's go through some

470
00:15:13,680 --> 00:15:16,320
examples to make sure that makes sense

471
00:15:16,320 --> 00:15:19,760
um let's go with a vm escape

472
00:15:19,760 --> 00:15:22,160
you're able to escape a virtual machine

473
00:15:22,160 --> 00:15:22,800
that is a

474
00:15:22,800 --> 00:15:25,120
changed scope because the vulnerable

475
00:15:25,120 --> 00:15:27,040
component is the virtual machine

476
00:15:27,040 --> 00:15:30,079
the impact component is the host os and

477
00:15:30,079 --> 00:15:31,360
both of them are controlled by different

478
00:15:31,360 --> 00:15:33,440
security scopes the vm itself has its

479
00:15:33,440 --> 00:15:33,759
own

480
00:15:33,759 --> 00:15:37,199
intrinsic uh authority which would be

481
00:15:37,199 --> 00:15:38,560
the you know the operating system of the

482
00:15:38,560 --> 00:15:39,040
guest

483
00:15:39,040 --> 00:15:40,959
in the vm has its own authentication

484
00:15:40,959 --> 00:15:43,040
mechanism and the host has its own

485
00:15:43,040 --> 00:15:44,800
authentication mechanism as well

486
00:15:44,800 --> 00:15:46,000
and because they have separate

487
00:15:46,000 --> 00:15:48,320
authentication mechanisms if

488
00:15:48,320 --> 00:15:51,040
that becomes a change scope another

489
00:15:51,040 --> 00:15:51,519
example

490
00:15:51,519 --> 00:15:53,440
authentication bypress on a wordpress

491
00:15:53,440 --> 00:15:54,800
site

492
00:15:54,800 --> 00:15:56,639
if the attacker was able to gain

493
00:15:56,639 --> 00:15:58,079
privileges and go from an authenticated

494
00:15:58,079 --> 00:16:00,079
user to an authenticated one

495
00:16:00,079 --> 00:16:01,920
okay the vulnerable component here is

496
00:16:01,920 --> 00:16:04,160
the wordpress site the impact component

497
00:16:04,160 --> 00:16:06,560
is also the wordpress site

498
00:16:06,560 --> 00:16:08,320
since they both have the same security

499
00:16:08,320 --> 00:16:09,759
authority in this case

500
00:16:09,759 --> 00:16:12,320
the wordpress authentication mechanism

501
00:16:12,320 --> 00:16:12,800
it is an

502
00:16:12,800 --> 00:16:15,279
unchanged scope even though you now have

503
00:16:15,279 --> 00:16:17,199
more privileges the scope is still

504
00:16:17,199 --> 00:16:20,399
unchanged conversely a directory

505
00:16:20,399 --> 00:16:22,240
traversal on a wordpress site

506
00:16:22,240 --> 00:16:24,240
that enables you to pop etsy shadow or

507
00:16:24,240 --> 00:16:25,759
etsy password

508
00:16:25,759 --> 00:16:26,959
the vulnerable component is the

509
00:16:26,959 --> 00:16:28,480
wordpress site but the impacted

510
00:16:28,480 --> 00:16:29,759
component is the host

511
00:16:29,759 --> 00:16:32,160
os because you were able to manipulate

512
00:16:32,160 --> 00:16:34,079
or access files on the host

513
00:16:34,079 --> 00:16:36,399
therefore the scope has changed because

514
00:16:36,399 --> 00:16:37,279
wordpress

515
00:16:37,279 --> 00:16:38,800
and the host operating system have

516
00:16:38,800 --> 00:16:41,360
separate security authorities

517
00:16:41,360 --> 00:16:42,639
let's look at a couple more examples

518
00:16:42,639 --> 00:16:45,040
like shell shock the vulnerable

519
00:16:45,040 --> 00:16:46,880
component is the bash shell

520
00:16:46,880 --> 00:16:48,480
the impact component is the operating

521
00:16:48,480 --> 00:16:49,920
system that it lives on

522
00:16:49,920 --> 00:16:51,759
since access to both the operating

523
00:16:51,759 --> 00:16:53,680
system and the bash shell on that host

524
00:16:53,680 --> 00:16:55,120
are controlled by the host

525
00:16:55,120 --> 00:16:57,519
os itself they have the same security

526
00:16:57,519 --> 00:16:59,199
authority they're in the same security

527
00:16:59,199 --> 00:16:59,759
scope

528
00:16:59,759 --> 00:17:02,399
so the scope is unchanged one more

529
00:17:02,399 --> 00:17:03,120
example

530
00:17:03,120 --> 00:17:05,520
reflected cross-site scripting

531
00:17:05,520 --> 00:17:06,720
vulnerable component

532
00:17:06,720 --> 00:17:08,640
is the website with the vulnerability

533
00:17:08,640 --> 00:17:10,079
the impacting component here

534
00:17:10,079 --> 00:17:12,640
is the web browser of the visitor to the

535
00:17:12,640 --> 00:17:14,640
site so that's the victim

536
00:17:14,640 --> 00:17:16,559
since the victim's browser is controlled

537
00:17:16,559 --> 00:17:18,079
by the security scope of the victim's

538
00:17:18,079 --> 00:17:19,039
computer

539
00:17:19,039 --> 00:17:21,039
and the website is controlled by the web

540
00:17:21,039 --> 00:17:22,480
server security scope

541
00:17:22,480 --> 00:17:24,079
those are separate so reflected

542
00:17:24,079 --> 00:17:25,839
cross-site scripting would be a changed

543
00:17:25,839 --> 00:17:28,000
scope i hope that makes sense and if it

544
00:17:28,000 --> 00:17:29,200
doesn't feel free to ask me some

545
00:17:29,200 --> 00:17:30,960
questions later on or if you have

546
00:17:30,960 --> 00:17:32,000
specific use cases

547
00:17:32,000 --> 00:17:34,240
you want want me to look at i'm

548
00:17:34,240 --> 00:17:35,200
available you can

549
00:17:35,200 --> 00:17:36,640
hit me up after this and we can figure

550
00:17:36,640 --> 00:17:38,640
that out

551
00:17:38,640 --> 00:17:41,919
okay so moving on past scope into

552
00:17:41,919 --> 00:17:43,679
the impact metrics these are still part

553
00:17:43,679 --> 00:17:45,039
of the base scores

554
00:17:45,039 --> 00:17:47,679
and these are covering the impact to

555
00:17:47,679 --> 00:17:49,280
confidentiality integrity and

556
00:17:49,280 --> 00:17:50,559
availability

557
00:17:50,559 --> 00:17:51,840
now i'm guessing most of the people

558
00:17:51,840 --> 00:17:53,280
watching this talk have a basic

559
00:17:53,280 --> 00:17:54,960
understanding of the cia triangle

560
00:17:54,960 --> 00:17:56,240
so i'm not going to go into too much

561
00:17:56,240 --> 00:17:58,000
detail about what those mean

562
00:17:58,000 --> 00:17:59,520
but the big question for each of these

563
00:17:59,520 --> 00:18:01,039
metrics to ask yourself is

564
00:18:01,039 --> 00:18:04,559
can the attacker affect cia on some

565
00:18:04,559 --> 00:18:06,240
or all of the data that the system

566
00:18:06,240 --> 00:18:07,600
protects if

567
00:18:07,600 --> 00:18:09,679
the answer is some then it's low if the

568
00:18:09,679 --> 00:18:10,960
answer is all

569
00:18:10,960 --> 00:18:14,320
it's high also if the data they obtain

570
00:18:14,320 --> 00:18:17,679
is privileged or critical data and that

571
00:18:17,679 --> 00:18:19,200
it's considered high even if they can't

572
00:18:19,200 --> 00:18:21,200
attain all of it

573
00:18:21,200 --> 00:18:25,200
um yep so that is the impact metrics

574
00:18:25,200 --> 00:18:27,520
so let's go ahead and take our attack

575
00:18:27,520 --> 00:18:28,400
role

576
00:18:28,400 --> 00:18:30,720
and throw on the specifics of this

577
00:18:30,720 --> 00:18:32,320
vulnerability on the base score

578
00:18:32,320 --> 00:18:33,200
calculator

579
00:18:33,200 --> 00:18:35,039
we've got attack vector network

580
00:18:35,039 --> 00:18:36,320
complexity low

581
00:18:36,320 --> 00:18:38,240
privilege is required none user

582
00:18:38,240 --> 00:18:39,440
interaction none

583
00:18:39,440 --> 00:18:41,039
the scope is changed because the

584
00:18:41,039 --> 00:18:42,559
security authority of the confluence

585
00:18:42,559 --> 00:18:44,000
server is separate from the security

586
00:18:44,000 --> 00:18:45,200
authority of the host

587
00:18:45,200 --> 00:18:46,480
where you're able to do the directory

588
00:18:46,480 --> 00:18:48,240
traversal

589
00:18:48,240 --> 00:18:49,679
confidentiality integrity and

590
00:18:49,679 --> 00:18:52,320
availability impacts are all high

591
00:18:52,320 --> 00:18:55,360
and that brings us to a 10.0 critical on

592
00:18:55,360 --> 00:18:57,200
the cvss calculator

593
00:18:57,200 --> 00:18:59,280
you'll also notice i published the cvs

594
00:18:59,280 --> 00:19:01,280
vector cvss vector string on the bottom

595
00:19:01,280 --> 00:19:02,240
of your screen

596
00:19:02,240 --> 00:19:03,919
you can actually take that string head

597
00:19:03,919 --> 00:19:05,440
to the first.org calculator

598
00:19:05,440 --> 00:19:06,960
put a pound sign at the end of the url

599
00:19:06,960 --> 00:19:08,640
and paste that entire thing starting

600
00:19:08,640 --> 00:19:10,320
with cvss and press

601
00:19:10,320 --> 00:19:12,080
enter and it will load that into the

602
00:19:12,080 --> 00:19:13,360
calculator and it will look like what

603
00:19:13,360 --> 00:19:14,480
you see on your screen

604
00:19:14,480 --> 00:19:15,840
so that's a cool way to be able to share

605
00:19:15,840 --> 00:19:17,120
those strings and if someone gives you a

606
00:19:17,120 --> 00:19:18,240
vector string you can just take it to

607
00:19:18,240 --> 00:19:19,919
the calculator and visualize it pretty

608
00:19:19,919 --> 00:19:22,080
easily

609
00:19:22,080 --> 00:19:23,679
all right so let's step back into our

610
00:19:23,679 --> 00:19:26,559
battle shall we

611
00:19:28,320 --> 00:19:31,039
confluentist feels the exploit land its

612
00:19:31,039 --> 00:19:32,880
crushing blow

613
00:19:32,880 --> 00:19:35,360
penetrating his outer armor and

614
00:19:35,360 --> 00:19:36,960
executing itself deep

615
00:19:36,960 --> 00:19:39,600
into his operating system he calls out

616
00:19:39,600 --> 00:19:43,199
to his maker praying for help

617
00:19:43,760 --> 00:19:47,039
oh great and beautiful atlassian bless

618
00:19:47,039 --> 00:19:48,160
me and heal me

619
00:19:48,160 --> 00:19:50,880
protect me from this evil chat with my

620
00:19:50,880 --> 00:19:51,280
hip

621
00:19:51,280 --> 00:19:53,360
turn the gaze of your fish eye upon your

622
00:19:53,360 --> 00:19:55,280
faithful servant

623
00:19:55,280 --> 00:19:57,360
intervene on my behalf and stride down

624
00:19:57,360 --> 00:19:58,880
to my side o great

625
00:19:58,880 --> 00:20:01,919
and all-powerful collaborator

626
00:20:01,919 --> 00:20:05,200
suddenly a light shines down from above

627
00:20:05,200 --> 00:20:08,480
confluentis feels the healing word of

628
00:20:08,480 --> 00:20:12,000
official fix as his creator atlassia

629
00:20:12,000 --> 00:20:14,159
blesses him

630
00:20:14,159 --> 00:20:17,520
it's coming he hears an ethereal whisper

631
00:20:17,520 --> 00:20:19,520
hold strong child for the patch will be

632
00:20:19,520 --> 00:20:22,799
published after testing

633
00:20:23,919 --> 00:20:25,600
and that brings us to the temporal

634
00:20:25,600 --> 00:20:27,520
scores or temporal scores depending on

635
00:20:27,520 --> 00:20:28,880
how you pronounce it

636
00:20:28,880 --> 00:20:30,640
the temporal scores as the names suggest

637
00:20:30,640 --> 00:20:32,159
are specific factors related to the

638
00:20:32,159 --> 00:20:34,400
vulnerability at a point in time

639
00:20:34,400 --> 00:20:35,840
if you remember we talked about the base

640
00:20:35,840 --> 00:20:37,760
scores the base scores will never change

641
00:20:37,760 --> 00:20:40,159
they stay static the temporal scores

642
00:20:40,159 --> 00:20:41,440
will change based on

643
00:20:41,440 --> 00:20:43,919
industry-wide situations again we're not

644
00:20:43,919 --> 00:20:44,799
taking into account

645
00:20:44,799 --> 00:20:46,799
specific use cases specific deployments

646
00:20:46,799 --> 00:20:49,200
patching versions anything like that

647
00:20:49,200 --> 00:20:51,120
the temporal scores take into account

648
00:20:51,120 --> 00:20:52,240
the situation

649
00:20:52,240 --> 00:20:53,919
of the vulnerability and availability of

650
00:20:53,919 --> 00:20:55,440
exploit right now

651
00:20:55,440 --> 00:20:57,600
as we're scoring it there's three

652
00:20:57,600 --> 00:20:59,120
metrics in the temporal score so let's

653
00:20:59,120 --> 00:21:01,760
go through each of them

654
00:21:01,760 --> 00:21:05,200
exploit code maturity is based on

655
00:21:05,200 --> 00:21:08,559
how prevalent this poc or exploit is and

656
00:21:08,559 --> 00:21:10,720
if it's being exploited in the wild

657
00:21:10,720 --> 00:21:13,760
so a u or

658
00:21:13,760 --> 00:21:15,520
unproven exploit would be it's

659
00:21:15,520 --> 00:21:17,039
theoretical or there's no publicly

660
00:21:17,039 --> 00:21:18,799
available exploit code

661
00:21:18,799 --> 00:21:21,039
p is proof of concept proof of concept

662
00:21:21,039 --> 00:21:22,320
code that's not functional in all

663
00:21:22,320 --> 00:21:24,480
situations or may require substantial

664
00:21:24,480 --> 00:21:25,440
modifications

665
00:21:25,440 --> 00:21:28,000
by someone with a high level of skill f

666
00:21:28,000 --> 00:21:29,679
is functional which means exploit code

667
00:21:29,679 --> 00:21:32,240
is available and it works in most cases

668
00:21:32,240 --> 00:21:33,840
and h or high means that there's

669
00:21:33,840 --> 00:21:35,840
functional autonomous code available

670
00:21:35,840 --> 00:21:38,080
basically this is push button get bacon

671
00:21:38,080 --> 00:21:39,679
there's a reliable exploit that works

672
00:21:39,679 --> 00:21:41,679
every time with easy to use tools like a

673
00:21:41,679 --> 00:21:43,360
metasploit module

674
00:21:43,360 --> 00:21:45,440
things like that this is when when your

675
00:21:45,440 --> 00:21:47,360
unskilled attackers are able to use it

676
00:21:47,360 --> 00:21:48,000
easily

677
00:21:48,000 --> 00:21:49,679
it is considered high exploit code

678
00:21:49,679 --> 00:21:51,919
maturity

679
00:21:51,919 --> 00:21:53,840
all right remediation level this takes

680
00:21:53,840 --> 00:21:56,240
into account the availability of

681
00:21:56,240 --> 00:21:59,440
how to fix it patching hotfixes things

682
00:21:59,440 --> 00:22:00,159
like that

683
00:22:00,159 --> 00:22:01,840
it does not take into account whether or

684
00:22:01,840 --> 00:22:03,200
not you've applied them

685
00:22:03,200 --> 00:22:05,440
just the fact that they exist will lower

686
00:22:05,440 --> 00:22:07,760
the score

687
00:22:07,760 --> 00:22:09,200
things like unavailable workaround

688
00:22:09,200 --> 00:22:10,960
temporary fix or official fix change the

689
00:22:10,960 --> 00:22:12,240
score

690
00:22:12,240 --> 00:22:14,159
report confidence is the degree of

691
00:22:14,159 --> 00:22:15,520
confidence that this vulnerability

692
00:22:15,520 --> 00:22:17,039
actually exists

693
00:22:17,039 --> 00:22:19,200
is it unknown is it reasonable to assume

694
00:22:19,200 --> 00:22:20,799
or is it confirmed that this

695
00:22:20,799 --> 00:22:23,919
component is vulnerable so let's go

696
00:22:23,919 --> 00:22:26,080
ahead and throw the official fix from

697
00:22:26,080 --> 00:22:28,640
our creator atlassia onto the board

698
00:22:28,640 --> 00:22:30,960
if you recall we were at a 10.0 critical

699
00:22:30,960 --> 00:22:34,159
and we have now lowered it to a 9.5

700
00:22:34,159 --> 00:22:36,240
just the fact that there is an official

701
00:22:36,240 --> 00:22:39,120
fix has lowered the overall severity of

702
00:22:39,120 --> 00:22:40,400
the vulnerability

703
00:22:40,400 --> 00:22:43,120
and again we have the updated cvss 3.1

704
00:22:43,120 --> 00:22:46,399
vector string down below

705
00:22:49,840 --> 00:22:52,880
but all is still not well confluentis

706
00:22:52,880 --> 00:22:55,760
is damaged and broken weak and on his

707
00:22:55,760 --> 00:22:56,320
knees

708
00:22:56,320 --> 00:22:59,120
barely able to stand the blessing from

709
00:22:59,120 --> 00:23:00,480
his maker helped a bit

710
00:23:00,480 --> 00:23:03,440
but he is still in critical condition he

711
00:23:03,440 --> 00:23:04,240
is not long

712
00:23:04,240 --> 00:23:06,480
for this world he feels the imminent

713
00:23:06,480 --> 00:23:08,320
shutdown of his functions

714
00:23:08,320 --> 00:23:11,600
and the denial of his service but then

715
00:23:11,600 --> 00:23:14,400
just as his eyes close he hears his

716
00:23:14,400 --> 00:23:17,520
friends approach in the distance

717
00:23:17,520 --> 00:23:20,320
hold the line cisco flame hand screams

718
00:23:20,320 --> 00:23:21,600
as she casts firewall

719
00:23:21,600 --> 00:23:23,120
segregating confluentists from the

720
00:23:23,120 --> 00:23:25,600
internet

721
00:23:25,600 --> 00:23:27,520
we just need to hold until the patch

722
00:23:27,520 --> 00:23:28,720
army arrives

723
00:23:28,720 --> 00:23:30,960
docker bellows enveloping confluence in

724
00:23:30,960 --> 00:23:32,720
a container protecting him from scope

725
00:23:32,720 --> 00:23:34,000
change

726
00:23:34,000 --> 00:23:36,240
ted roberts taps away at his keyboard

727
00:23:36,240 --> 00:23:38,080
casting sanitize pii

728
00:23:38,080 --> 00:23:40,159
removing any sensitive information from

729
00:23:40,159 --> 00:23:43,600
confluentism's backend

730
00:23:44,799 --> 00:23:46,559
and that brings us to the environmental

731
00:23:46,559 --> 00:23:47,919
scores uh so

732
00:23:47,919 --> 00:23:49,840
to recap a little bit base scores will

733
00:23:49,840 --> 00:23:50,960
never change

734
00:23:50,960 --> 00:23:52,640
temporal scores change based on the

735
00:23:52,640 --> 00:23:54,640
situation industry-wide at any given

736
00:23:54,640 --> 00:23:55,279
time

737
00:23:55,279 --> 00:23:56,320
or now when we're creating the

738
00:23:56,320 --> 00:23:59,279
vulnerability uh calculations

739
00:23:59,279 --> 00:24:01,679
the environmental scores are your chance

740
00:24:01,679 --> 00:24:02,799
as the assessor

741
00:24:02,799 --> 00:24:04,240
to take into account specific

742
00:24:04,240 --> 00:24:06,720
deployments versions protections

743
00:24:06,720 --> 00:24:09,520
network situations all of these things

744
00:24:09,520 --> 00:24:11,679
that are specific to your environment or

745
00:24:11,679 --> 00:24:12,320
the environment

746
00:24:12,320 --> 00:24:15,200
the system is deployed in so one thing i

747
00:24:15,200 --> 00:24:15,840
hear a lot

748
00:24:15,840 --> 00:24:19,039
when i talk to people about cvss is that

749
00:24:19,039 --> 00:24:21,120
everything is a 10.0 critical hair on

750
00:24:21,120 --> 00:24:23,679
fire and it just skews so high every

751
00:24:23,679 --> 00:24:25,360
time that everything is an emergency and

752
00:24:25,360 --> 00:24:26,720
when everything's an emergency nothing

753
00:24:26,720 --> 00:24:27,440
is

754
00:24:27,440 --> 00:24:29,440
and i get that and i understand that and

755
00:24:29,440 --> 00:24:31,279
i have seen it but i'll be honest i'm

756
00:24:31,279 --> 00:24:33,120
pretty sure that's on purpose

757
00:24:33,120 --> 00:24:35,440
because again base scores are in a

758
00:24:35,440 --> 00:24:36,960
vacuum they're designed

759
00:24:36,960 --> 00:24:38,880
to be the worst case hair on fire

760
00:24:38,880 --> 00:24:41,279
scenario but using the environmental

761
00:24:41,279 --> 00:24:41,919
scores

762
00:24:41,919 --> 00:24:43,360
the assessor is able to take into

763
00:24:43,360 --> 00:24:46,000
account specifics of a situation

764
00:24:46,000 --> 00:24:48,240
and what that means is that you can

765
00:24:48,240 --> 00:24:49,520
lower the score to

766
00:24:49,520 --> 00:24:52,080
the reasonable and accurate level based

767
00:24:52,080 --> 00:24:52,799
on

768
00:24:52,799 --> 00:24:54,960
how the system is in use currently or

769
00:24:54,960 --> 00:24:56,960
deployed in the environment

770
00:24:56,960 --> 00:24:58,960
okay so let's go through each of these

771
00:24:58,960 --> 00:25:00,640
on the left hand side of the screen

772
00:25:00,640 --> 00:25:02,960
we've got the confidentiality integrity

773
00:25:02,960 --> 00:25:05,360
and availability requirements

774
00:25:05,360 --> 00:25:07,120
these are separate from the impact this

775
00:25:07,120 --> 00:25:08,400
is how important

776
00:25:08,400 --> 00:25:10,720
is the data that the system is

777
00:25:10,720 --> 00:25:11,520
protecting

778
00:25:11,520 --> 00:25:13,919
again specific to your environment so

779
00:25:13,919 --> 00:25:16,159
let's like for example confidentiality

780
00:25:16,159 --> 00:25:18,159
if the if it's a database we're talking

781
00:25:18,159 --> 00:25:19,760
about that contains the social security

782
00:25:19,760 --> 00:25:22,080
numbers of every employee in a company

783
00:25:22,080 --> 00:25:23,760
that has a high requirement for

784
00:25:23,760 --> 00:25:25,600
confidentiality that is not something we

785
00:25:25,600 --> 00:25:26,400
want leaked

786
00:25:26,400 --> 00:25:28,080
or if it's a database that contains all

787
00:25:28,080 --> 00:25:29,520
the intellectual property from our

788
00:25:29,520 --> 00:25:30,240
company

789
00:25:30,240 --> 00:25:32,400
those have a high confidentiality

790
00:25:32,400 --> 00:25:33,440
requirement

791
00:25:33,440 --> 00:25:35,039
but if it's a database that holds the

792
00:25:35,039 --> 00:25:36,880
menus from the last two months of meals

793
00:25:36,880 --> 00:25:38,640
at the corporate cafeteria

794
00:25:38,640 --> 00:25:40,559
the confidentiality requirement is

795
00:25:40,559 --> 00:25:42,080
probably pretty low

796
00:25:42,080 --> 00:25:44,000
so you could change that and that lowers

797
00:25:44,000 --> 00:25:45,760
the overall score because it's not as

798
00:25:45,760 --> 00:25:47,840
big of a deal

799
00:25:47,840 --> 00:25:48,960
and and this is applied to both

800
00:25:48,960 --> 00:25:50,480
confidentiality integrity and

801
00:25:50,480 --> 00:25:51,440
availability

802
00:25:51,440 --> 00:25:53,200
this is not the impact or how bad it

803
00:25:53,200 --> 00:25:54,640
would be if it gets lost but how

804
00:25:54,640 --> 00:25:57,679
important is this information to protect

805
00:25:57,679 --> 00:26:00,480
do we need to be have a strong

806
00:26:00,480 --> 00:26:02,000
requirement to protect confidentiality

807
00:26:02,000 --> 00:26:04,880
integrity availability or not

808
00:26:04,880 --> 00:26:07,279
the other section here is the modified

809
00:26:07,279 --> 00:26:08,159
base metrics

810
00:26:08,159 --> 00:26:10,320
again the main base metrics don't change

811
00:26:10,320 --> 00:26:12,400
but this is your chance to make those

812
00:26:12,400 --> 00:26:14,559
changes to the base matrix metrics

813
00:26:14,559 --> 00:26:17,600
based on the situation so if the system

814
00:26:17,600 --> 00:26:18,799
we're talking about

815
00:26:18,799 --> 00:26:21,760
is you know it was rated high the attack

816
00:26:21,760 --> 00:26:22,960
vector was network because it was over

817
00:26:22,960 --> 00:26:24,400
the internet in the base score

818
00:26:24,400 --> 00:26:26,400
but when you tell me that this system is

819
00:26:26,400 --> 00:26:28,000
air gapped and is sitting in a fault

820
00:26:28,000 --> 00:26:29,039
somewhere

821
00:26:29,039 --> 00:26:31,919
the attack vector is local or physical

822
00:26:31,919 --> 00:26:33,440
because you have to physically have

823
00:26:33,440 --> 00:26:35,279
access to the box to attack an air gap

824
00:26:35,279 --> 00:26:35,919
system

825
00:26:35,919 --> 00:26:38,240
so you would modify the attack vector

826
00:26:38,240 --> 00:26:39,600
down to

827
00:26:39,600 --> 00:26:41,679
physical and that would lower the

828
00:26:41,679 --> 00:26:43,600
overall score

829
00:26:43,600 --> 00:26:46,240
so let's go ahead and take our situation

830
00:26:46,240 --> 00:26:46,640
and

831
00:26:46,640 --> 00:26:49,679
throw it up on the calculator

832
00:26:49,679 --> 00:26:51,600
we have modified the attack vector to

833
00:26:51,600 --> 00:26:53,120
adjacent network by throwing up that

834
00:26:53,120 --> 00:26:54,559
firewall

835
00:26:54,559 --> 00:26:56,000
we have changed the confidentiality

836
00:26:56,000 --> 00:26:58,000
requirement to low by removing all the

837
00:26:58,000 --> 00:27:00,320
important data from the database

838
00:27:00,320 --> 00:27:01,919
and we've made the attack complexity

839
00:27:01,919 --> 00:27:04,000
high and the scope unchanged

840
00:27:04,000 --> 00:27:07,200
by enveloping it in a container so we've

841
00:27:07,200 --> 00:27:08,799
taken what was originally a 10.0

842
00:27:08,799 --> 00:27:10,240
critical

843
00:27:10,240 --> 00:27:13,200
it was lowered down to a 9.5 when we

844
00:27:13,200 --> 00:27:14,640
brought in the temporal metrics

845
00:27:14,640 --> 00:27:16,960
which again is still critical but by

846
00:27:16,960 --> 00:27:18,880
making these changes we have lowered the

847
00:27:18,880 --> 00:27:20,799
overall severity of this vulnerability

848
00:27:20,799 --> 00:27:23,520
for our specific deployment to a 6.9

849
00:27:23,520 --> 00:27:24,559
medium

850
00:27:24,559 --> 00:27:26,399
does that mean we shouldn't fix it of

851
00:27:26,399 --> 00:27:28,399
course not does it mean that it's not

852
00:27:28,399 --> 00:27:29,279
vulnerable

853
00:27:29,279 --> 00:27:31,840
no does it mean we've put protections in

854
00:27:31,840 --> 00:27:32,640
place

855
00:27:32,640 --> 00:27:35,360
that allow us to effectively say our

856
00:27:35,360 --> 00:27:37,600
residual severity is lower and therefore

857
00:27:37,600 --> 00:27:40,000
our residual risk is not as severe

858
00:27:40,000 --> 00:27:42,559
yes that is what we did here the other

859
00:27:42,559 --> 00:27:43,360
thing you can do with these

860
00:27:43,360 --> 00:27:44,399
environmental scores

861
00:27:44,399 --> 00:27:46,720
is if you're given a vulnerability you

862
00:27:46,720 --> 00:27:48,480
can play with them on the calculator and

863
00:27:48,480 --> 00:27:49,679
try and find

864
00:27:49,679 --> 00:27:51,279
what things you can do like putting a

865
00:27:51,279 --> 00:27:53,360
firewall in place or removing data

866
00:27:53,360 --> 00:27:55,600
to lower that overall severity and use

867
00:27:55,600 --> 00:27:57,520
it kind of as a triage tool

868
00:27:57,520 --> 00:27:58,640
and that allows you to figure out the

869
00:27:58,640 --> 00:28:00,960
best return on investment for your time

870
00:28:00,960 --> 00:28:02,240
or the defender's time system

871
00:28:02,240 --> 00:28:03,760
administrator's time in trying to

872
00:28:03,760 --> 00:28:05,039
remediate this

873
00:28:05,039 --> 00:28:06,559
so there's lots of ways we can use the

874
00:28:06,559 --> 00:28:08,080
cvss calculator

875
00:28:08,080 --> 00:28:10,240
to lower our overall severity and thus

876
00:28:10,240 --> 00:28:12,159
lower risk for our organization

877
00:28:12,159 --> 00:28:16,480
in this system

878
00:28:16,480 --> 00:28:18,880
the army has arrived and they've brought

879
00:28:18,880 --> 00:28:19,840
with them

880
00:28:19,840 --> 00:28:22,960
the patch this holy object

881
00:28:22,960 --> 00:28:25,840
when applied to confluentis protects him

882
00:28:25,840 --> 00:28:30,320
from the evil of cve 2019-3396

883
00:28:30,320 --> 00:28:33,760
they make quick work of cryptokid666

884
00:28:33,760 --> 00:28:37,360
who falls to the ground defeated

885
00:28:37,360 --> 00:28:39,918
for now

886
00:28:41,279 --> 00:28:43,840
all right so some takeaways here cvss

887
00:28:43,840 --> 00:28:45,840
isn't just overall scores and pretty

888
00:28:45,840 --> 00:28:47,440
qualitative severity rankings

889
00:28:47,440 --> 00:28:49,440
those things are important and i'm not

890
00:28:49,440 --> 00:28:51,279
saying you shouldn't use those or rely

891
00:28:51,279 --> 00:28:51,840
on them

892
00:28:51,840 --> 00:28:53,600
but there's more to it than that having

893
00:28:53,600 --> 00:28:55,679
a good understanding of the cvss vector

894
00:28:55,679 --> 00:28:56,320
string

895
00:28:56,320 --> 00:28:57,840
allows everybody involved to have a

896
00:28:57,840 --> 00:28:58,880
better understanding of the

897
00:28:58,880 --> 00:28:59,919
vulnerability

898
00:28:59,919 --> 00:29:01,919
and what went into the decision to make

899
00:29:01,919 --> 00:29:03,120
it considered severe

900
00:29:03,120 --> 00:29:05,840
critical high medium low whatever it is

901
00:29:05,840 --> 00:29:07,679
and again it professionals can use these

902
00:29:07,679 --> 00:29:08,640
scores

903
00:29:08,640 --> 00:29:10,000
play with the calculator to try and

904
00:29:10,000 --> 00:29:12,159
adjust what they could best do to lower

905
00:29:12,159 --> 00:29:15,279
the overall severity and residual risk

906
00:29:15,279 --> 00:29:16,240
one more time there's a link to the

907
00:29:16,240 --> 00:29:18,880
first.org calculator up on the screen

908
00:29:18,880 --> 00:29:22,159
feel free to use that and that is just

909
00:29:22,159 --> 00:29:23,679
about it for me

910
00:29:23,679 --> 00:29:25,919
i appreciate everybody's time you can

911
00:29:25,919 --> 00:29:27,120
find me on twitter

912
00:29:27,120 --> 00:29:30,799
redwedgex i'll be on discord immediately

913
00:29:30,799 --> 00:29:31,600
after this

914
00:29:31,600 --> 00:29:34,279
in the defcon discord server at

915
00:29:34,279 --> 00:29:35,840
redwayjax0404

916
00:29:35,840 --> 00:29:37,440
i'm going to throw my slides up this

917
00:29:37,440 --> 00:29:39,200
afternoon on github you're free to use

918
00:29:39,200 --> 00:29:40,880
them with attribution

919
00:29:40,880 --> 00:29:42,960
and you can reach me via email at

920
00:29:42,960 --> 00:29:45,679
redwedgex protonmail.com

921
00:29:45,679 --> 00:29:46,960
a couple quick thank yous i want to

922
00:29:46,960 --> 00:29:49,039
shout out i appreciate defcon absec

923
00:29:49,039 --> 00:29:50,240
village it's been an honor and a

924
00:29:50,240 --> 00:29:51,600
pleasure to be here and speak to

925
00:29:51,600 --> 00:29:53,520
everybody today

926
00:29:53,520 --> 00:29:56,000
thanks to my my esteemed voice actors or

927
00:29:56,000 --> 00:29:56,799
my friends jeff

928
00:29:56,799 --> 00:29:59,279
jeremy and fletcher my wife shira and my

929
00:29:59,279 --> 00:30:00,159
ten-year-old daughter

930
00:30:00,159 --> 00:30:03,440
ziva who voiced the goddess atlassia

931
00:30:03,440 --> 00:30:05,520
and one more thanks to digital overdose

932
00:30:05,520 --> 00:30:06,960
khan where i

933
00:30:06,960 --> 00:30:09,200
workshop this talk earlier this year and

934
00:30:09,200 --> 00:30:10,799
got some great feedback and mentorship i

935
00:30:10,799 --> 00:30:12,960
really appreciate everything from that

936
00:30:12,960 --> 00:30:15,120
and uh yeah i'll be around defcon in

937
00:30:15,120 --> 00:30:16,799
person feel free to look for me

938
00:30:16,799 --> 00:30:19,039
yell at me tell me my talk was garbage

939
00:30:19,039 --> 00:30:20,480
or ask me questions

940
00:30:20,480 --> 00:30:22,080
here or in the live q a immediately

941
00:30:22,080 --> 00:30:23,919
following it and once again thanks

942
00:30:23,919 --> 00:30:27,840
everyone for your time and have a good

