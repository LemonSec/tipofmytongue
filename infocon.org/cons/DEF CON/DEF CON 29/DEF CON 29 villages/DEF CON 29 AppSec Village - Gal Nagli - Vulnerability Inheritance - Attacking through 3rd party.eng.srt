1
00:00:01,360 --> 00:00:03,360
hey everyone thanks for tuning in

2
00:00:03,360 --> 00:00:05,600
for my talk today about vulnerability

3
00:00:05,600 --> 00:00:06,640
inheritance

4
00:00:06,640 --> 00:00:08,720
finding bugs is calling bounties and

5
00:00:08,720 --> 00:00:10,320
third-party integrations

6
00:00:10,320 --> 00:00:12,400
so let's go along to conduct my session

7
00:00:12,400 --> 00:00:14,080
on the deathcon absolute village

8
00:00:14,080 --> 00:00:16,640
and i hope you all will enjoy it and

9
00:00:16,640 --> 00:00:17,680
learn some stuff

10
00:00:17,680 --> 00:00:20,000
for the future about bounty hunting

11
00:00:20,000 --> 00:00:22,480
experience

12
00:00:23,680 --> 00:00:26,320
who am i my name is danielle and what is

13
00:00:26,320 --> 00:00:27,599
three years old

14
00:00:27,599 --> 00:00:29,119
i'm an absolute researcher at anti

15
00:00:29,119 --> 00:00:31,519
security i'm a bsc computer science

16
00:00:31,519 --> 00:00:32,479
student

17
00:00:32,479 --> 00:00:34,719
i'm doug monty hunter by guerrillas of

18
00:00:34,719 --> 00:00:36,320
natalie on haka one

19
00:00:36,320 --> 00:00:39,520
background and cena and then my personal

20
00:00:39,520 --> 00:00:40,160
blog

21
00:00:40,160 --> 00:00:42,840
will post like apps on at the

22
00:00:42,840 --> 00:00:45,440
gardner.com

23
00:00:45,440 --> 00:00:48,480
so please for the session today

24
00:00:48,480 --> 00:00:52,000
how will this session benefit you

25
00:00:52,879 --> 00:00:55,360
we'll talk about cell party integrations

26
00:00:55,360 --> 00:00:56,879
i'll give you examples of subpart

27
00:00:56,879 --> 00:00:58,000
integrations

28
00:00:58,000 --> 00:00:59,440
why should we find programs and

29
00:00:59,440 --> 00:01:01,600
sometimes integrations and how to

30
00:01:01,600 --> 00:01:03,359
identify assets running

31
00:01:03,359 --> 00:01:06,640
self-doubt integrations later

32
00:01:06,640 --> 00:01:09,040
we'll go over the concepts improve your

33
00:01:09,040 --> 00:01:10,880
sub number of currencies flow

34
00:01:10,880 --> 00:01:13,040
locate all bounty targets running a

35
00:01:13,040 --> 00:01:15,840
certain volatile component

36
00:01:15,840 --> 00:01:18,880
and create nuclear templates for mass

37
00:01:18,880 --> 00:01:22,158
figure heating tasks

38
00:01:22,799 --> 00:01:25,200
after the reconnaissance fund we will

39
00:01:25,200 --> 00:01:26,000
look over

40
00:01:26,000 --> 00:01:28,560
a short overview of the attack vectors

41
00:01:28,560 --> 00:01:30,240
enchanting olympia

42
00:01:30,240 --> 00:01:32,560
and some proof of concept for my own

43
00:01:32,560 --> 00:01:35,680
background experience

44
00:01:37,040 --> 00:01:40,079
approaching the mountains in 2021 the

45
00:01:40,079 --> 00:01:41,840
number of lag monthly programs

46
00:01:41,840 --> 00:01:44,399
is a never-ending list there are so many

47
00:01:44,399 --> 00:01:45,119
problems

48
00:01:45,119 --> 00:01:49,040
with so many assets to test and explore

49
00:01:49,040 --> 00:01:51,280
which assets should be focused on after

50
00:01:51,280 --> 00:01:52,640
the economic phase

51
00:01:52,640 --> 00:01:55,280
is a question often often been asked by

52
00:01:55,280 --> 00:01:55,840
background

53
00:01:55,840 --> 00:01:58,479
hunters a possible solution for this

54
00:01:58,479 --> 00:01:59,040
question

55
00:01:59,040 --> 00:02:01,040
would be targeting the assets maintained

56
00:02:01,040 --> 00:02:04,479
by self-taught integrations

57
00:02:04,880 --> 00:02:09,199
let's go to the cell county integration

58
00:02:09,199 --> 00:02:11,760
first there are html based self-help

59
00:02:11,760 --> 00:02:12,879
integrations

60
00:02:12,879 --> 00:02:15,360
such as intel from live chat analytics

61
00:02:15,360 --> 00:02:16,640
of marquette

62
00:02:16,640 --> 00:02:19,839
and billing of stripe

63
00:02:20,400 --> 00:02:23,120
secondly and this is the part we will

64
00:02:23,120 --> 00:02:25,200
focus more on the session today

65
00:02:25,200 --> 00:02:27,840
our dns based integrations such as

66
00:02:27,840 --> 00:02:29,920
customer service of zendesk

67
00:02:29,920 --> 00:02:33,840
e-commerce shopify marketing of overcame

68
00:02:33,840 --> 00:02:37,280
problems service blogs webinar teaching

69
00:02:37,280 --> 00:02:39,120
and basically there are a lot more

70
00:02:39,120 --> 00:02:40,480
self-party vendors

71
00:02:40,480 --> 00:02:42,400
who offer integrations of certain

72
00:02:42,400 --> 00:02:46,560
functionality for our websites

73
00:02:47,120 --> 00:02:48,959
what are the benefits of targeting and

74
00:02:48,959 --> 00:02:51,920
celebrant integrations

75
00:02:51,920 --> 00:02:55,120
first the writing shows there are many

76
00:02:55,120 --> 00:02:57,519
vendors around different angles

77
00:02:57,519 --> 00:03:00,400
so there are many more many vendors to

78
00:03:00,400 --> 00:03:01,599
find bugs on

79
00:03:01,599 --> 00:03:03,920
there are many types of them they are

80
00:03:03,920 --> 00:03:05,360
all in different niches

81
00:03:05,360 --> 00:03:08,000
so we can find some specific business

82
00:03:08,000 --> 00:03:09,040
projects around

83
00:03:09,040 --> 00:03:11,120
on different vendors which will affect

84
00:03:11,120 --> 00:03:12,319
the target we are

85
00:03:12,319 --> 00:03:14,319
targeting with our background team

86
00:03:14,319 --> 00:03:16,400
hunting

87
00:03:16,400 --> 00:03:17,840
second we'll be deploying forget

88
00:03:17,840 --> 00:03:20,080
strategy offer the blind spot for the

89
00:03:20,080 --> 00:03:20,720
target

90
00:03:20,720 --> 00:03:23,440
after the initial configuration so after

91
00:03:23,440 --> 00:03:23,760
our

92
00:03:23,760 --> 00:03:26,879
target implements his help disposal for

93
00:03:26,879 --> 00:03:27,920
example

94
00:03:27,920 --> 00:03:29,280
he will go over the initial

95
00:03:29,280 --> 00:03:31,599
configuration but he won't monitor it

96
00:03:31,599 --> 00:03:32,000
from

97
00:03:32,000 --> 00:03:34,720
any emerging cves or vulnerabilities

98
00:03:34,720 --> 00:03:36,319
which are not assigned cvds

99
00:03:36,319 --> 00:03:38,640
but are considered a web zero days or

100
00:03:38,640 --> 00:03:39,440
one day

101
00:03:39,440 --> 00:03:41,920
which have been published on expert dbo

102
00:03:41,920 --> 00:03:42,799
on twitter

103
00:03:42,799 --> 00:03:46,959
it can affect the target

104
00:03:46,959 --> 00:03:49,040
the cell phone will be one bug many more

105
00:03:49,040 --> 00:03:50,000
of the assets

106
00:03:50,000 --> 00:03:51,599
it will find the bug or set but even

107
00:03:51,599 --> 00:03:53,920
though every asset on the internet

108
00:03:53,920 --> 00:03:57,280
who uses this vendor is affected

109
00:03:57,280 --> 00:03:58,879
the final point would be defense

110
00:03:58,879 --> 00:04:00,480
mechanisms are not enforced

111
00:04:00,480 --> 00:04:02,879
on dns integrations if we have strict

112
00:04:02,879 --> 00:04:04,239
one of csp

113
00:04:04,239 --> 00:04:07,200
on our main critical assets it will

114
00:04:07,200 --> 00:04:07,920
probably

115
00:04:07,920 --> 00:04:11,360
not imply on the subdomain that we are

116
00:04:11,360 --> 00:04:12,239
hosting

117
00:04:12,239 --> 00:04:15,120
which actually talia said a self-party

118
00:04:15,120 --> 00:04:16,079
vendor

119
00:04:16,079 --> 00:04:17,839
so if we host the submarine with the

120
00:04:17,839 --> 00:04:19,600
scenic third party integration

121
00:04:19,600 --> 00:04:22,320
it will most likely not have the strict

122
00:04:22,320 --> 00:04:23,680
workforce thing

123
00:04:23,680 --> 00:04:26,840
but we've set to protect our main

124
00:04:26,840 --> 00:04:28,639
website

125
00:04:28,639 --> 00:04:30,479
in this session we'll be focusing on the

126
00:04:30,479 --> 00:04:34,719
dns based cell targeting preventions

127
00:04:35,759 --> 00:04:38,320
first let's go over how does dns based

128
00:04:38,320 --> 00:04:41,120
integration work

129
00:04:41,120 --> 00:04:44,560
so we have c name and a reports

130
00:04:44,560 --> 00:04:46,720
before diving into the integration flow

131
00:04:46,720 --> 00:04:48,160
let's take a look at the following

132
00:04:48,160 --> 00:04:48,800
example

133
00:04:48,800 --> 00:04:52,320
about c name and a records so this is an

134
00:04:52,320 --> 00:04:54,160
example from wikipedia

135
00:04:54,160 --> 00:04:56,320
and for example we have dna zone as the

136
00:04:56,320 --> 00:04:58,479
following we have bothered the subdomain

137
00:04:58,479 --> 00:04:59,840
for example.com

138
00:04:59,840 --> 00:05:02,639
with a scenario and we have the full

139
00:05:02,639 --> 00:05:03,360
submarine

140
00:05:03,360 --> 00:05:06,880
with an airport to a certain iphone

141
00:05:06,880 --> 00:05:09,360
what we actually do when we send to uofl

142
00:05:09,360 --> 00:05:10,720
the browser tab

143
00:05:10,720 --> 00:05:12,800
we actually issue an a record lookup for

144
00:05:12,800 --> 00:05:14,320
the bounce underneath

145
00:05:14,320 --> 00:05:16,320
the resultant looks of a record for an

146
00:05:16,320 --> 00:05:18,160
ip to display the contents of our

147
00:05:18,160 --> 00:05:19,120
website

148
00:05:19,120 --> 00:05:20,639
but because it actually points to a

149
00:05:20,639 --> 00:05:23,120
ceiling icon it will check again

150
00:05:23,120 --> 00:05:25,840
if foo have an arrow for the island he

151
00:05:25,840 --> 00:05:27,840
will go there or the c name

152
00:05:27,840 --> 00:05:30,800
until he finds an ipads when we are

153
00:05:30,800 --> 00:05:32,000
looking at full

154
00:05:32,000 --> 00:05:34,400
we will find the idea that specified we

155
00:05:34,400 --> 00:05:35,520
can know the content

156
00:05:35,520 --> 00:05:39,440
for bob for the initial search

157
00:05:39,440 --> 00:05:42,000
let's have another example of support

158
00:05:42,000 --> 00:05:42,639
subdomain

159
00:05:42,639 --> 00:05:45,440
example.com to be help desk and exam

160
00:05:45,440 --> 00:05:47,600
disk

161
00:05:47,600 --> 00:05:50,800
so the flow is in the form we have the

162
00:05:50,800 --> 00:05:54,880
customer to visit the support subdomain

163
00:05:54,880 --> 00:05:56,720
the result will be new for the support

164
00:05:56,720 --> 00:05:58,720
subdomain a records

165
00:05:58,720 --> 00:06:02,400
or its dns account it will find

166
00:06:02,400 --> 00:06:04,720
that it has a cnn record to extend this

167
00:06:04,720 --> 00:06:05,520
subdomain

168
00:06:05,520 --> 00:06:09,120
named example now

169
00:06:09,120 --> 00:06:11,440
we know the example subdomain and

170
00:06:11,440 --> 00:06:12,319
zendesk

171
00:06:12,319 --> 00:06:15,199
actually have an error called display so

172
00:06:15,199 --> 00:06:15,600
what

173
00:06:15,600 --> 00:06:17,840
the resolver will do now it will look

174
00:06:17,840 --> 00:06:20,160
for the dns records of the example in

175
00:06:20,160 --> 00:06:20,880
subdomain

176
00:06:20,880 --> 00:06:24,240
and zendesk it will find that it has an

177
00:06:24,240 --> 00:06:25,919
error code which will display the

178
00:06:25,919 --> 00:06:26,800
contents

179
00:06:26,800 --> 00:06:29,360
of the example some domain at our

180
00:06:29,360 --> 00:06:30,080
support

181
00:06:30,080 --> 00:06:32,840
subdomain at the main website we look

182
00:06:32,840 --> 00:06:34,720
for

183
00:06:34,720 --> 00:06:36,479
so the main takeaway would be the

184
00:06:36,479 --> 00:06:38,000
supports of the way that example the

185
00:06:38,000 --> 00:06:38,479
phone

186
00:06:38,479 --> 00:06:40,639
is aliasing the example domain and

187
00:06:40,639 --> 00:06:42,000
zendesk

188
00:06:42,000 --> 00:06:43,600
the contents presented with the target

189
00:06:43,600 --> 00:06:45,440
subdomain are exactly as in the

190
00:06:45,440 --> 00:06:49,840
understand banking integrity website

191
00:06:51,360 --> 00:06:53,280
so now let's go over the reconnaissance

192
00:06:53,280 --> 00:06:55,679
parts

193
00:06:56,639 --> 00:06:58,960
the flow will be divided into two key

194
00:06:58,960 --> 00:06:59,759
areas

195
00:06:59,759 --> 00:07:01,919
the first will beat on the scanner's set

196
00:07:01,919 --> 00:07:02,880
fundamentals

197
00:07:02,880 --> 00:07:05,440
integrated with our tablet we'll do

198
00:07:05,440 --> 00:07:07,199
subdomains lookup for it

199
00:07:07,199 --> 00:07:10,080
passive active permutation we will

200
00:07:10,080 --> 00:07:11,759
resolve the subdomains

201
00:07:11,759 --> 00:07:13,759
and we will extract the name of the

202
00:07:13,759 --> 00:07:16,319
result domains

203
00:07:16,319 --> 00:07:18,160
the second phase would be to discover

204
00:07:18,160 --> 00:07:19,360
assets maintained

205
00:07:19,360 --> 00:07:21,759
by self-party vendor we will use google

206
00:07:21,759 --> 00:07:24,080
notes reversing and lookup

207
00:07:24,080 --> 00:07:27,120
customer space and past fingerprinting

208
00:07:27,120 --> 00:07:30,800
with nuclei so friends

209
00:07:30,800 --> 00:07:33,120
let's discover windows integrated with

210
00:07:33,120 --> 00:07:34,560
our target

211
00:07:34,560 --> 00:07:37,599
we will take wildcard.example.com

212
00:07:37,599 --> 00:07:40,960
with our example target

213
00:07:41,280 --> 00:07:42,840
so we'll start with some numbering

214
00:07:42,840 --> 00:07:44,800
policies

215
00:07:44,800 --> 00:07:48,000
first we'll do passive standards

216
00:07:48,000 --> 00:07:50,319
these are the tools that i use when i do

217
00:07:50,319 --> 00:07:52,000
passive atomic super

218
00:07:52,000 --> 00:07:55,440
sample finder chaos hamas robot

219
00:07:55,440 --> 00:07:58,319
github sandalwoods and the cure rates

220
00:07:58,319 --> 00:08:00,080
they all have in common that those are

221
00:08:00,080 --> 00:08:02,000
passive supplements look up tools

222
00:08:02,000 --> 00:08:04,319
we don't issue any active requests to

223
00:08:04,319 --> 00:08:05,520
our target

224
00:08:05,520 --> 00:08:07,440
they are collecting data from different

225
00:08:07,440 --> 00:08:09,599
resources on the internet

226
00:08:09,599 --> 00:08:11,520
the expected output for these bosses

227
00:08:11,520 --> 00:08:13,280
would be generic subunits

228
00:08:13,280 --> 00:08:16,479
such as hem admin david trump

229
00:08:16,479 --> 00:08:18,639
many bad monkey hunters stopped at this

230
00:08:18,639 --> 00:08:20,639
phase they think they found all the

231
00:08:20,639 --> 00:08:22,560
available sentiments on the internet our

232
00:08:22,560 --> 00:08:23,280
target

233
00:08:23,280 --> 00:08:24,800
and they continued their hunting for

234
00:08:24,800 --> 00:08:26,960
this point this is a huge mistake

235
00:08:26,960 --> 00:08:29,199
because this they miss a lot of demands

236
00:08:29,199 --> 00:08:31,199
but relying only on passing something

237
00:08:31,199 --> 00:08:35,839
soccer the second phase would be active

238
00:08:35,839 --> 00:08:38,399
which is wood boxing i use pure dns for

239
00:08:38,399 --> 00:08:39,519
the botox

240
00:08:39,519 --> 00:08:42,640
and acetone list for the longest

241
00:08:42,640 --> 00:08:44,399
the expected output will be unique

242
00:08:44,399 --> 00:08:47,360
sergeants such as administered

243
00:08:47,360 --> 00:08:50,560
suv assets internal debt

244
00:08:50,560 --> 00:08:54,320
and test stage the cell

245
00:08:54,320 --> 00:08:56,160
and another important phase would be

246
00:08:56,160 --> 00:08:58,000
permuted saturated

247
00:08:58,000 --> 00:09:00,560
which has dnsg for the permutated

248
00:09:00,560 --> 00:09:02,399
generation of the substance

249
00:09:02,399 --> 00:09:04,480
the expected output would be unique to

250
00:09:04,480 --> 00:09:06,000
rooted subjects

251
00:09:06,000 --> 00:09:09,680
such such as int advanced then qa

252
00:09:09,680 --> 00:09:13,600
test then dash assets or panel dash s

253
00:09:13,600 --> 00:09:16,480
we take the entire sub that we found

254
00:09:16,480 --> 00:09:17,839
after this point

255
00:09:17,839 --> 00:09:19,600
and the editing critical and

256
00:09:19,600 --> 00:09:20,959
non-internal

257
00:09:20,959 --> 00:09:24,000
sub domain names to those endpoints to

258
00:09:24,000 --> 00:09:24,720
see if there are

259
00:09:24,720 --> 00:09:27,600
some variations to specifically to our

260
00:09:27,600 --> 00:09:28,959
target

261
00:09:28,959 --> 00:09:32,000
leaving one of these steps aside will

262
00:09:32,000 --> 00:09:33,839
will leave you with less arguments than

263
00:09:33,839 --> 00:09:35,120
your competitors

264
00:09:35,120 --> 00:09:36,800
and you will surely find less of the

265
00:09:36,800 --> 00:09:38,959
rest of your target so it's critical to

266
00:09:38,959 --> 00:09:40,240
follow each of these steps

267
00:09:40,240 --> 00:09:42,000
when you're doing about multi-hunting

268
00:09:42,000 --> 00:09:43,680
and especially with the reconnaissance

269
00:09:43,680 --> 00:09:46,000
phase

270
00:09:46,320 --> 00:09:48,000
the next step would be to resolve the

271
00:09:48,000 --> 00:09:49,519
collected subjects

272
00:09:49,519 --> 00:09:52,320
we reduce fuel dns for it we will ask

273
00:09:52,320 --> 00:09:53,360
you to resolve

274
00:09:53,360 --> 00:09:55,360
the list of subdomains which we found

275
00:09:55,360 --> 00:09:56,800
after this point

276
00:09:56,800 --> 00:09:59,519
we will use the resolvence text file we

277
00:09:59,519 --> 00:10:00,800
will save the results

278
00:10:00,800 --> 00:10:04,880
on the resolve subdomains dot txt

279
00:10:04,880 --> 00:10:06,720
later we will extract the ceiling

280
00:10:06,720 --> 00:10:09,120
records for the result submarines

281
00:10:09,120 --> 00:10:12,000
using http install we will issue the

282
00:10:12,000 --> 00:10:12,959
ceiling plan

283
00:10:12,959 --> 00:10:15,680
the regret for closing bracket to

284
00:10:15,680 --> 00:10:16,160
display

285
00:10:16,160 --> 00:10:18,399
only the submarines which end the scenic

286
00:10:18,399 --> 00:10:19,680
record

287
00:10:19,680 --> 00:10:22,240
as we can look on halfway one subdomains

288
00:10:22,240 --> 00:10:24,079
we can see that there are a few cell

289
00:10:24,079 --> 00:10:25,680
party integrations

290
00:10:25,680 --> 00:10:28,000
that they are using like zendesk cloud

291
00:10:28,000 --> 00:10:30,480
for from hosting the gs link centering

292
00:10:30,480 --> 00:10:32,880
google flip for the resources and

293
00:10:32,880 --> 00:10:36,720
details for some of the documentation

294
00:10:37,680 --> 00:10:39,920
now we'll go for exploitation after we

295
00:10:39,920 --> 00:10:41,680
extend the senior records and the result

296
00:10:41,680 --> 00:10:42,320
domains

297
00:10:42,320 --> 00:10:44,480
we should opt to ignore the following

298
00:10:44,480 --> 00:10:46,000
defense will be exploitation on the

299
00:10:46,000 --> 00:10:47,360
scene in providing instance

300
00:10:47,360 --> 00:10:49,360
to find the required communities there

301
00:10:49,360 --> 00:10:51,440
will be more to follow in the circles

302
00:10:51,440 --> 00:10:54,640
and the second will be for the subways

303
00:10:54,640 --> 00:10:57,279
for non-syrian related wonders such as

304
00:10:57,279 --> 00:10:58,320
on exodb

305
00:10:58,320 --> 00:11:00,560
or twitter to see someone that reported

306
00:11:00,560 --> 00:11:01,760
the unique

307
00:11:01,760 --> 00:11:03,760
effect in certain window you need to

308
00:11:03,760 --> 00:11:05,920
check if any of the adventures you found

309
00:11:05,920 --> 00:11:07,519
actually have some bugs published on the

310
00:11:07,519 --> 00:11:09,920
internet

311
00:11:10,240 --> 00:11:12,000
the second phase will be to discover

312
00:11:12,000 --> 00:11:15,680
assets maintained by vendor

313
00:11:15,680 --> 00:11:18,000
let's take our demo set part integration

314
00:11:18,000 --> 00:11:19,040
willian.com

315
00:11:19,040 --> 00:11:22,640
as an example so what we'll do now

316
00:11:22,640 --> 00:11:25,360
will strengthen the internet utilizing

317
00:11:25,360 --> 00:11:27,200
certain google drives such as the in

318
00:11:27,200 --> 00:11:28,640
your way of intent

319
00:11:28,640 --> 00:11:30,720
will look for the first c name for the

320
00:11:30,720 --> 00:11:32,000
customer's page

321
00:11:32,000 --> 00:11:35,760
and for the past campaign so then

322
00:11:35,760 --> 00:11:38,959
let's detect patterns is google document

323
00:11:38,959 --> 00:11:40,640
the first pattern to detect will be

324
00:11:40,640 --> 00:11:42,079
common subordinated

325
00:11:42,079 --> 00:11:44,480
for example if our vendor is providing a

326
00:11:44,480 --> 00:11:45,600
learning area

327
00:11:45,600 --> 00:11:48,320
as well.com most of the assets which

328
00:11:48,320 --> 00:11:50,160
will be the customers apart

329
00:11:50,160 --> 00:11:52,880
will create a new level subdomain to

330
00:11:52,880 --> 00:11:54,639
host the contents of it

331
00:11:54,639 --> 00:11:56,560
so we can use the site keyword of the

332
00:11:56,560 --> 00:11:59,200
google docs to look for every website

333
00:11:59,200 --> 00:12:01,279
which have the learning keyword and

334
00:12:01,279 --> 00:12:02,320
submarine

335
00:12:02,320 --> 00:12:04,079
we will issue this request from google

336
00:12:04,079 --> 00:12:06,320
cell we will find all submarines

337
00:12:06,320 --> 00:12:08,560
all assets on the internet which ever

338
00:12:08,560 --> 00:12:11,279
learn something

339
00:12:11,279 --> 00:12:13,279
second you can use the credits of the

340
00:12:13,279 --> 00:12:14,720
html page

341
00:12:14,720 --> 00:12:17,200
often vendors love to present power by

342
00:12:17,200 --> 00:12:17,760
section

343
00:12:17,760 --> 00:12:20,399
or power by line by the end of the html

344
00:12:20,399 --> 00:12:21,120
page

345
00:12:21,120 --> 00:12:23,519
we can use this to find more instances

346
00:12:23,519 --> 00:12:24,639
of the same vendor

347
00:12:24,639 --> 00:12:28,000
with the in-text hero of the woman

348
00:12:28,000 --> 00:12:31,120
the cell would be with the page title

349
00:12:31,120 --> 00:12:33,519
similarly before many vendors love to

350
00:12:33,519 --> 00:12:34,959
put on the title

351
00:12:34,959 --> 00:12:37,200
the name so we can use the entitled

352
00:12:37,200 --> 00:12:38,959
keyword of google

353
00:12:38,959 --> 00:12:40,959
to search for every asset that google

354
00:12:40,959 --> 00:12:42,000
knows that

355
00:12:42,000 --> 00:12:46,800
ended in its title window platform

356
00:12:48,000 --> 00:12:50,639
the second step to go would be to find

357
00:12:50,639 --> 00:12:53,040
the dell series

358
00:12:53,040 --> 00:12:55,760
when we look for targets we can know

359
00:12:55,760 --> 00:12:56,480
which of our

360
00:12:56,480 --> 00:12:59,040
what are the scenarios of our targets

361
00:12:59,040 --> 00:13:00,880
but we can't do it the other way around

362
00:13:00,880 --> 00:13:04,079
we can't ask our c name who points to it

363
00:13:04,079 --> 00:13:06,240
the only way to do it would be to look

364
00:13:06,240 --> 00:13:08,240
on some online crawlers

365
00:13:08,240 --> 00:13:10,320
which scan the entire internet and

366
00:13:10,320 --> 00:13:11,519
scroll the data

367
00:13:11,519 --> 00:13:14,639
of their websites on the databases doing

368
00:13:14,639 --> 00:13:15,440
so

369
00:13:15,440 --> 00:13:17,519
they have a list of websites and the

370
00:13:17,519 --> 00:13:18,720
senior records

371
00:13:18,720 --> 00:13:20,160
so what we can actually do we can

372
00:13:20,160 --> 00:13:21,839
navigate one of these sites

373
00:13:21,839 --> 00:13:24,000
and we will ask it do you know any

374
00:13:24,000 --> 00:13:25,120
senior record

375
00:13:25,120 --> 00:13:28,320
with the record of willem.com

376
00:13:28,320 --> 00:13:30,079
then it will display from the database

377
00:13:30,079 --> 00:13:31,440
all the assets

378
00:13:31,440 --> 00:13:33,680
that they found before that have a

379
00:13:33,680 --> 00:13:35,200
senior record

380
00:13:35,200 --> 00:13:37,839
to a vulnerable event so i gave you a

381
00:13:37,839 --> 00:13:38,800
few examples

382
00:13:38,800 --> 00:13:41,519
like spicy rapid seven shonen profile

383
00:13:41,519 --> 00:13:42,639
and sundays

384
00:13:42,639 --> 00:13:46,320
we provide such

385
00:13:47,600 --> 00:13:49,600
the services will be customers page

386
00:13:49,600 --> 00:13:51,680
often vendors have to present their big

387
00:13:51,680 --> 00:13:54,560
customers on the trusted buy pages when

388
00:13:54,560 --> 00:13:56,160
you go to the marketing websites at the

389
00:13:56,160 --> 00:13:57,120
double down

390
00:13:57,120 --> 00:13:59,920
you can find it if you scroll down below

391
00:13:59,920 --> 00:14:02,160
the customers drafted by

392
00:14:02,160 --> 00:14:04,160
often some of these will advance the

393
00:14:04,160 --> 00:14:06,160
programs and it makes the job easier for

394
00:14:06,160 --> 00:14:06,639
us

395
00:14:06,639 --> 00:14:09,839
finding one of their assets

396
00:14:10,639 --> 00:14:12,160
the final point will be past

397
00:14:12,160 --> 00:14:14,160
fingerprinting we will be weaponizing

398
00:14:14,160 --> 00:14:15,440
nuclear

399
00:14:15,440 --> 00:14:16,639
let's take a look on the real world

400
00:14:16,639 --> 00:14:19,279
scenario that i found six months ago

401
00:14:19,279 --> 00:14:21,440
of open redirect on all singletrip

402
00:14:21,440 --> 00:14:22,399
instances

403
00:14:22,399 --> 00:14:25,680
which is a teaching platform

404
00:14:25,920 --> 00:14:28,320
the signatures that indicates the

405
00:14:28,320 --> 00:14:29,360
vulnerability

406
00:14:29,360 --> 00:14:31,360
will be a synonym record pointing to

407
00:14:31,360 --> 00:14:34,240
anything under thinkific.com

408
00:14:34,240 --> 00:14:37,519
and that the first of the url is api sso

409
00:14:37,519 --> 00:14:39,440
v2 sso jwt

410
00:14:39,440 --> 00:14:41,920
go to android.com will actually direct

411
00:14:41,920 --> 00:14:44,800
us to apple.com

412
00:14:44,800 --> 00:14:48,000
so now we found that every asset which

413
00:14:48,000 --> 00:14:50,399
operates under thinkific is affected so

414
00:14:50,399 --> 00:14:52,079
we want to find all assets

415
00:14:52,079 --> 00:14:54,160
affected by the vulnerability we don't

416
00:14:54,160 --> 00:14:55,760
want to go over each subdomain

417
00:14:55,760 --> 00:14:58,000
and try on the set browser central the

418
00:14:58,000 --> 00:14:58,959
following path

419
00:14:58,959 --> 00:15:01,279
to see for the redirection so we'll use

420
00:15:01,279 --> 00:15:04,639
nuclei for our help

421
00:15:05,440 --> 00:15:07,360
let's look for them how to create a

422
00:15:07,360 --> 00:15:08,720
nuclear template

423
00:15:08,720 --> 00:15:10,959
we'll go over each field and the step

424
00:15:10,959 --> 00:15:12,800
this is the yaman file for the single to

425
00:15:12,800 --> 00:15:14,560
be the leg i've shown before

426
00:15:14,560 --> 00:15:16,160
and now we'll get a little bit deeper

427
00:15:16,160 --> 00:15:18,639
into it

428
00:15:19,120 --> 00:15:22,160
first we have the id which is their

429
00:15:22,160 --> 00:15:22,959
length name

430
00:15:22,959 --> 00:15:25,120
when match is found when you found when

431
00:15:25,120 --> 00:15:26,560
you find a vulnerable website

432
00:15:26,560 --> 00:15:27,920
the tool will be telling us in the

433
00:15:27,920 --> 00:15:30,160
result the id contents

434
00:15:30,160 --> 00:15:33,120
in our example think it to the direct

435
00:15:33,120 --> 00:15:35,360
the second part of the yaml file

436
00:15:35,360 --> 00:15:38,720
would be the infrared we have

437
00:15:38,720 --> 00:15:41,279
the also feel the awesome key is the

438
00:15:41,279 --> 00:15:43,839
awesome name

439
00:15:46,639 --> 00:15:49,040
the severity key is the severity we set

440
00:15:49,040 --> 00:15:50,399
for our vulnerability

441
00:15:50,399 --> 00:15:52,839
it will be printed out when we find

442
00:15:52,839 --> 00:15:55,839
image

443
00:15:55,920 --> 00:15:58,480
and with the simple networks it does as

444
00:15:58,480 --> 00:16:00,079
i said here is regulate

445
00:16:00,079 --> 00:16:01,440
because if you want to scan for all

446
00:16:01,440 --> 00:16:03,920
opening direct on all our assets

447
00:16:03,920 --> 00:16:06,959
or every template that actually provides

448
00:16:06,959 --> 00:16:08,399
operator

449
00:16:08,399 --> 00:16:10,800
uh open event opportunities so we can

450
00:16:10,800 --> 00:16:12,160
issue a scan

451
00:16:12,160 --> 00:16:14,959
to scan only for templates with the

452
00:16:14,959 --> 00:16:16,240
direct tag

453
00:16:16,240 --> 00:16:19,600
this is what is used next we have the

454
00:16:19,600 --> 00:16:20,839
request

455
00:16:20,839 --> 00:16:24,880
route when to specify the method we

456
00:16:24,880 --> 00:16:25,680
won't do it

457
00:16:25,680 --> 00:16:27,920
we want our request to lose in our

458
00:16:27,920 --> 00:16:31,199
example will be get

459
00:16:33,519 --> 00:16:35,600
now we need to specify the vulnerable

460
00:16:35,600 --> 00:16:37,440
path which will indicate that the

461
00:16:37,440 --> 00:16:39,440
vulnerability actually exists

462
00:16:39,440 --> 00:16:41,519
in our case it's the same example as

463
00:16:41,519 --> 00:16:44,160
i've shown before

464
00:16:46,720 --> 00:16:49,519
now we want to specify our matches we

465
00:16:49,519 --> 00:16:50,399
want to

466
00:16:50,399 --> 00:16:52,720
we want the tool to alert us if there is

467
00:16:52,720 --> 00:16:53,519
vulnerability

468
00:16:53,519 --> 00:16:54,880
so we need to tell it what to look for

469
00:16:54,880 --> 00:16:56,639
what html is formed

470
00:16:56,639 --> 00:16:58,399
to indicate that there is an actual

471
00:16:58,399 --> 00:17:00,720
vulnerable instance in front of us

472
00:17:00,720 --> 00:17:03,199
so i want to use two matches here so i

473
00:17:03,199 --> 00:17:05,039
use the matches condition key

474
00:17:05,039 --> 00:17:08,079
with the end value

475
00:17:10,160 --> 00:17:12,160
i want the first matcher to be a status

476
00:17:12,160 --> 00:17:14,559
point i want the statistic to be

477
00:17:14,559 --> 00:17:19,839
co2 which indicates the direction

478
00:17:19,839 --> 00:17:22,720
the next matcher should be a word i want

479
00:17:22,720 --> 00:17:23,839
a certain word

480
00:17:23,839 --> 00:17:26,559
in the http response to indicate to me

481
00:17:26,559 --> 00:17:26,880
that

482
00:17:26,880 --> 00:17:29,440
the request actually directed us to the

483
00:17:29,440 --> 00:17:30,640
website i specified

484
00:17:30,640 --> 00:17:32,559
but it wasn't as simple as neo2

485
00:17:32,559 --> 00:17:34,720
direction to another subdomain

486
00:17:34,720 --> 00:17:38,559
but it was interaction to every.com

487
00:17:39,280 --> 00:17:42,400
so we specify the words the value that

488
00:17:42,400 --> 00:17:44,080
it tells to us when the redirection

489
00:17:44,080 --> 00:17:45,440
actually occurred

490
00:17:45,440 --> 00:17:47,120
so when there is a singer to be the leg

491
00:17:47,120 --> 00:17:48,799
he issues the following message

492
00:17:48,799 --> 00:17:51,679
on the a h return with everything.com

493
00:17:51,679 --> 00:17:53,600
and certain qualifiers like shown in the

494
00:17:53,600 --> 00:17:54,640
picture

495
00:17:54,640 --> 00:17:57,120
so it corresponds the request we send to

496
00:17:57,120 --> 00:18:00,000
the past we've said about

497
00:18:00,000 --> 00:18:02,320
includes the following wall we have

498
00:18:02,320 --> 00:18:05,200
default we found a volatile asset

499
00:18:05,200 --> 00:18:07,679
and we specify that we want the response

500
00:18:07,679 --> 00:18:15,840
to be on the body part of the html

501
00:18:16,000 --> 00:18:18,480
now we want to execute the template on

502
00:18:18,480 --> 00:18:20,400
our http prompt server

503
00:18:20,400 --> 00:18:23,520
so you start for the node http segment

504
00:18:23,520 --> 00:18:25,600
we specify nuclei with the template of

505
00:18:25,600 --> 00:18:27,280
synthetic direct

506
00:18:27,280 --> 00:18:30,240
and as you can see in the results it

507
00:18:30,240 --> 00:18:31,360
alerts to us

508
00:18:31,360 --> 00:18:33,760
that we found a significant which is the

509
00:18:33,760 --> 00:18:34,880
id

510
00:18:34,880 --> 00:18:37,039
and this is one subdomain of my

511
00:18:37,039 --> 00:18:38,480
background in target

512
00:18:38,480 --> 00:18:39,840
that is actually affected by the

513
00:18:39,840 --> 00:18:42,559
vulnerability so if i will copy the link

514
00:18:42,559 --> 00:18:44,799
that i got as a result from the nokia

515
00:18:44,799 --> 00:18:46,000
and based on the page

516
00:18:46,000 --> 00:18:49,679
you will direct me to every dot com

517
00:18:55,200 --> 00:18:56,960
that's important the concepts part we

518
00:18:56,960 --> 00:18:58,720
will see some of this example practical

519
00:18:58,720 --> 00:19:00,000
in the publish concept

520
00:19:00,000 --> 00:19:02,720
section now let's go to the attack

521
00:19:02,720 --> 00:19:05,200
networks

522
00:19:05,200 --> 00:19:07,520
so we found the cell phone integration

523
00:19:07,520 --> 00:19:11,039
what volume type should we look for

524
00:19:11,039 --> 00:19:13,840
i suggest focusing on rotation attention

525
00:19:13,840 --> 00:19:15,600
to client-side vulnerabilities

526
00:19:15,600 --> 00:19:18,160
such as excesses and open elements for

527
00:19:18,160 --> 00:19:19,840
the following reasons

528
00:19:19,840 --> 00:19:23,360
one they are easier to discover two

529
00:19:23,360 --> 00:19:25,440
the cell then belongs to the vendor we

530
00:19:25,440 --> 00:19:26,960
need to remember that if we attach a

531
00:19:26,960 --> 00:19:28,880
cell party integration as a c name or

532
00:19:28,880 --> 00:19:30,320
with an iq

533
00:19:30,320 --> 00:19:33,679
the iprs is actually the vendors what we

534
00:19:33,679 --> 00:19:34,000
find

535
00:19:34,000 --> 00:19:36,880
rce or ssr it's a legitimate

536
00:19:36,880 --> 00:19:39,520
vulnerability but it affects the vendor

537
00:19:39,520 --> 00:19:42,640
we want to find the abilities to change

538
00:19:42,640 --> 00:19:44,799
to affect our boundary target and not

539
00:19:44,799 --> 00:19:45,840
the vendor

540
00:19:45,840 --> 00:19:47,440
so it's better to focus on climate

541
00:19:47,440 --> 00:19:48,880
cycles

542
00:19:48,880 --> 00:19:50,960
the third point will be changing but so

543
00:19:50,960 --> 00:19:52,000
we want to find a small

544
00:19:52,000 --> 00:19:54,559
band that will help us to have greater

545
00:19:54,559 --> 00:19:55,200
impact

546
00:19:55,200 --> 00:19:58,480
on the target we are hunting

547
00:19:59,360 --> 00:20:01,360
so let's look at the attack vectors and

548
00:20:01,360 --> 00:20:04,000
chaining for impact

549
00:20:04,000 --> 00:20:07,280
first we have dns configurations such as

550
00:20:07,280 --> 00:20:08,880
subdomain takeover

551
00:20:08,880 --> 00:20:11,600
and done in data circuits something we

552
00:20:11,600 --> 00:20:13,039
take over the codes

553
00:20:13,039 --> 00:20:15,280
when we add a subdomain that points to

554
00:20:15,280 --> 00:20:16,159
an instance

555
00:20:16,159 --> 00:20:19,760
like shopify s3 bucket

556
00:20:19,760 --> 00:20:23,280
in the azure instances which the record

557
00:20:23,280 --> 00:20:24,559
is no longer claimed

558
00:20:24,559 --> 00:20:27,440
by the organization but on the register

559
00:20:27,440 --> 00:20:29,280
the settlement still points to that

560
00:20:29,280 --> 00:20:30,320
record

561
00:20:30,320 --> 00:20:31,840
what we will do when we get to the

562
00:20:31,840 --> 00:20:33,600
server rain and then the content

563
00:20:33,600 --> 00:20:34,320
presented

564
00:20:34,320 --> 00:20:36,559
on the target sun domain will be in our

565
00:20:36,559 --> 00:20:38,159
control

566
00:20:38,159 --> 00:20:40,320
then in dns regardless is actually

567
00:20:40,320 --> 00:20:41,520
really similar

568
00:20:41,520 --> 00:20:44,640
we can take for example eip fade aws

569
00:20:44,640 --> 00:20:47,039
if our target used on this registrar to

570
00:20:47,039 --> 00:20:48,559
point on an eip

571
00:20:48,559 --> 00:20:51,600
supplement on an elastic ip and then

572
00:20:51,600 --> 00:20:53,760
he released the elastic ip from his

573
00:20:53,760 --> 00:20:55,120
adwords account

574
00:20:55,120 --> 00:20:58,240
we didn't change his records we can move

575
00:20:58,240 --> 00:21:00,559
off for elastic repeat until we get the

576
00:21:00,559 --> 00:21:02,159
match our target

577
00:21:02,159 --> 00:21:04,320
and the impact is actually the same as

578
00:21:04,320 --> 00:21:07,120
other rectangle

579
00:21:07,280 --> 00:21:09,120
the second part would be plant side

580
00:21:09,120 --> 00:21:10,400
vulnerabilities

581
00:21:10,400 --> 00:21:12,880
such as corset flipping and openly

582
00:21:12,880 --> 00:21:14,559
direct

583
00:21:14,559 --> 00:21:16,559
now the chain for these vulnerabilities

584
00:21:16,559 --> 00:21:18,480
on our main asset the main template

585
00:21:18,480 --> 00:21:20,480
mental multi target

586
00:21:20,480 --> 00:21:23,120
will be what business logic errors for

587
00:21:23,120 --> 00:21:23,840
example

588
00:21:23,840 --> 00:21:26,559
we can take over shopify subdomain and

589
00:21:26,559 --> 00:21:28,559
put our credit card on it

590
00:21:28,559 --> 00:21:30,960
so customers will make purchases on the

591
00:21:30,960 --> 00:21:32,640
sound domain of the target thinking

592
00:21:32,640 --> 00:21:34,720
it's in legitimate websites to make

593
00:21:34,720 --> 00:21:35,760
shopping website

594
00:21:35,760 --> 00:21:39,440
for target but the money will go to us

595
00:21:39,440 --> 00:21:42,640
where of course bypasses if the main if

596
00:21:42,640 --> 00:21:44,240
our target on his main

597
00:21:44,240 --> 00:21:46,480
asset functionality relies on the

598
00:21:46,480 --> 00:21:47,600
requesting issue

599
00:21:47,600 --> 00:21:50,159
from one of his subdomains even when

600
00:21:50,159 --> 00:21:51,280
consequently

601
00:21:51,280 --> 00:21:54,159
or any dns configuration we can send we

602
00:21:54,159 --> 00:21:55,440
can send requests

603
00:21:55,440 --> 00:21:57,840
for the subdomain of the target so we

604
00:21:57,840 --> 00:21:59,200
can bypass the course

605
00:21:59,200 --> 00:22:01,200
protections which look forward

606
00:22:01,200 --> 00:22:02,320
originating

607
00:22:02,320 --> 00:22:06,400
for one subdomain from target

608
00:22:06,400 --> 00:22:08,799
cook is expectation we can exfiltrate

609
00:22:08,799 --> 00:22:09,840
cookies called

610
00:22:09,840 --> 00:22:11,840
the main dimensional target that can

611
00:22:11,840 --> 00:22:14,880
lead to account therefore

612
00:22:14,880 --> 00:22:17,360
sslv microsoft if we have certain

613
00:22:17,360 --> 00:22:18,559
functionality

614
00:22:18,559 --> 00:22:21,679
which issue requests for central missile

615
00:22:21,679 --> 00:22:23,120
same of our target

616
00:22:23,120 --> 00:22:26,400
and it only allows to put subdomains for

617
00:22:26,400 --> 00:22:27,440
target

618
00:22:27,440 --> 00:22:29,840
if we end openly direct or of course

619
00:22:29,840 --> 00:22:30,880
expecting

620
00:22:30,880 --> 00:22:32,960
dns records we can actually convert the

621
00:22:32,960 --> 00:22:34,559
middle action to another

622
00:22:34,559 --> 00:22:37,280
internal resources of our target by

623
00:22:37,280 --> 00:22:38,720
doing so we can write us

624
00:22:38,720 --> 00:22:42,640
ssr protections and almost like i said

625
00:22:42,640 --> 00:22:45,280
if we direct you again to any allowed

626
00:22:45,280 --> 00:22:46,720
subdomain for target

627
00:22:46,720 --> 00:22:48,799
and we control the intellectual center

628
00:22:48,799 --> 00:22:50,400
for a certain subdomain

629
00:22:50,400 --> 00:22:52,400
you can issue a direct which will

630
00:22:52,400 --> 00:22:53,520
possibly lick the

631
00:22:53,520 --> 00:22:58,640
oscar from victim 12 controlled instance

632
00:22:58,640 --> 00:23:00,559
so these are the attack methods and the

633
00:23:00,559 --> 00:23:01,919
chance we can do

634
00:23:01,919 --> 00:23:03,679
and i hope it will be more clear with

635
00:23:03,679 --> 00:23:06,480
the proof of concept

636
00:23:06,840 --> 00:23:11,840
section so now let's look at some plc

637
00:23:11,840 --> 00:23:14,320
the first one will be ssrn f6e stored

638
00:23:14,320 --> 00:23:15,840
xss and open iterate

639
00:23:15,840 --> 00:23:17,760
on the central webinars window which

640
00:23:17,760 --> 00:23:19,600
would be that for the stock

641
00:23:19,600 --> 00:23:21,600
although the vulnerabilities are already

642
00:23:21,600 --> 00:23:22,640
fixed

643
00:23:22,640 --> 00:23:26,080
our target was events.haploid.com

644
00:23:26,080 --> 00:23:27,679
and the three reports are already

645
00:23:27,679 --> 00:23:29,760
distraught for my account for about four

646
00:23:29,760 --> 00:23:30,559
months

647
00:23:30,559 --> 00:23:32,559
and you can look at the links that are

648
00:23:32,559 --> 00:23:36,080
provided after the talk is made

649
00:23:36,080 --> 00:23:37,760
so what i actually did i wanted to find

650
00:23:37,760 --> 00:23:39,679
some ads on hockey one cell

651
00:23:39,679 --> 00:23:42,919
so i did a standalone sense and i found

652
00:23:42,919 --> 00:23:44,559
events.happyone.com as one of the

653
00:23:44,559 --> 00:23:45,760
saturdays

654
00:23:45,760 --> 00:23:48,000
it looked actually it looked actually a

655
00:23:48,000 --> 00:23:49,039
little weird for me

656
00:23:49,039 --> 00:23:52,159
because it doesn't look like the actual

657
00:23:52,159 --> 00:23:54,240
development that everyone uses on the

658
00:23:54,240 --> 00:23:55,760
main website or

659
00:23:55,760 --> 00:23:58,480
other summaries so i had the suspicion

660
00:23:58,480 --> 00:23:59,120
that it

661
00:23:59,120 --> 00:24:01,520
it's actually a ceiling so when i'm in

662
00:24:01,520 --> 00:24:03,279
the scene and open it

663
00:24:03,279 --> 00:24:05,279
i've actually seen the response with the

664
00:24:05,279 --> 00:24:09,919
ceiling totally ducted webinars vendor

665
00:24:09,919 --> 00:24:12,159
later i wanted to perform endpoints

666
00:24:12,159 --> 00:24:13,120
before the sense

667
00:24:13,120 --> 00:24:16,799
on the scenery to do that i used way to

668
00:24:16,799 --> 00:24:18,000
kill accumulates tool

669
00:24:18,000 --> 00:24:21,120
by tom longnong which fetches the same

670
00:24:21,120 --> 00:24:24,000
endpoints file target for weighted

671
00:24:24,000 --> 00:24:26,480
archive

672
00:24:28,159 --> 00:24:32,000
i looked for any url param welcome

673
00:24:32,000 --> 00:24:35,760
follow to it to find opening delay sslf

674
00:24:35,760 --> 00:24:38,480
it's something that i usually do after i

675
00:24:38,480 --> 00:24:42,159
search for endpoints on a certain target

676
00:24:42,159 --> 00:24:45,440
and in that sponsor request i've seen

677
00:24:45,440 --> 00:24:46,000
the following

678
00:24:46,000 --> 00:24:48,960
day facts conferences get recorded

679
00:24:48,960 --> 00:24:50,880
slides xmln.xml

680
00:24:50,880 --> 00:24:53,360
will create around few of them it sounds

681
00:24:53,360 --> 00:24:55,840
really bonus

682
00:24:55,840 --> 00:24:57,679
so the question is will the endpoint

683
00:24:57,679 --> 00:25:00,159
fetch external assets or xml files and

684
00:25:00,159 --> 00:25:03,039
render those if he does i can achieve

685
00:25:03,039 --> 00:25:03,760
exercise

686
00:25:03,760 --> 00:25:06,320
on hacker once update i thought there is

687
00:25:06,320 --> 00:25:06,960
no chance

688
00:25:06,960 --> 00:25:08,400
to happen because we're talking about

689
00:25:08,400 --> 00:25:10,720
haka one here and finding a subdomain

690
00:25:10,720 --> 00:25:13,120
wallet really hard

691
00:25:13,120 --> 00:25:17,120
although it actually worked the vendor

692
00:25:17,120 --> 00:25:19,120
with the conferences get recorded inside

693
00:25:19,120 --> 00:25:21,600
xml url

694
00:25:21,600 --> 00:25:23,679
fetched the contents at presenting on

695
00:25:23,679 --> 00:25:24,760
attacking.com

696
00:25:24,760 --> 00:25:28,080
x67 or you can see in the ipfree myself

697
00:25:28,080 --> 00:25:31,440
this exercise payload on an xml file

698
00:25:31,440 --> 00:25:33,200
and i managed to achieve a process

699
00:25:33,200 --> 00:25:37,279
scripting on hacker one server

700
00:25:37,600 --> 00:25:41,039
i reported this to haka one and several

701
00:25:41,039 --> 00:25:41,520
other

702
00:25:41,520 --> 00:25:43,919
programs from happy one in background

703
00:25:43,919 --> 00:25:47,360
and they got a few bunches from it

704
00:25:48,240 --> 00:25:49,919
the next one will be stored openly

705
00:25:49,919 --> 00:25:52,159
direct on a teaching platform

706
00:25:52,159 --> 00:25:54,080
they tell this on twitter snapchat

707
00:25:54,080 --> 00:25:55,600
amazon facebook

708
00:25:55,600 --> 00:25:58,879
and the vendor was intended

709
00:26:04,559 --> 00:26:06,559
so what i've done was looking for bugs

710
00:26:06,559 --> 00:26:10,400
on twitter so i did several concepts on

711
00:26:10,400 --> 00:26:13,039
later i found that slice for twitter.com

712
00:26:13,039 --> 00:26:14,400
that takes lightsaber

713
00:26:14,400 --> 00:26:17,200
and twitterflightschool.com itself i'll

714
00:26:17,200 --> 00:26:18,640
point you with a cinnamon record

715
00:26:18,640 --> 00:26:21,840
to intel.com we can look on the page

716
00:26:21,840 --> 00:26:24,000
rendered under twitterclasscool.com we

717
00:26:24,000 --> 00:26:25,520
can actually see the power by

718
00:26:25,520 --> 00:26:28,720
signature that we discussed earlier with

719
00:26:28,720 --> 00:26:31,520
internal valuement

720
00:26:31,520 --> 00:26:32,960
so what i did i was calling the

721
00:26:32,960 --> 00:26:35,440
application for any vulnerable airports

722
00:26:35,440 --> 00:26:37,440
and i found the following widgets

723
00:26:37,440 --> 00:26:39,919
experience destination url

724
00:26:39,919 --> 00:26:43,440
which accepted any external asset

725
00:26:43,440 --> 00:26:46,000
that have put at the destination neural

726
00:26:46,000 --> 00:26:46,480
key

727
00:26:46,480 --> 00:26:49,919
value and redirected to it what actually

728
00:26:49,919 --> 00:26:50,720
happened

729
00:26:50,720 --> 00:26:54,400
is if the victim visited the url before

730
00:26:54,400 --> 00:26:57,360
whenever he tries to navigate to any

731
00:26:57,360 --> 00:26:59,520
endpoint on twitterslifeschool.com

732
00:26:59,520 --> 00:27:01,679
or the other twitter subdomains it will

733
00:27:01,679 --> 00:27:02,960
issue a request to get

734
00:27:02,960 --> 00:27:06,159
student and redirects him with co2

735
00:27:06,159 --> 00:27:06,799
status

736
00:27:06,799 --> 00:27:10,240
to every dot com so it's actually stored

737
00:27:10,240 --> 00:27:10,960
open direct

738
00:27:10,960 --> 00:27:12,320
he can't navigate to any other

739
00:27:12,320 --> 00:27:14,640
functionality on the italian website

740
00:27:14,640 --> 00:27:15,919
he's navigated on

741
00:27:15,919 --> 00:27:17,679
and every time he hits research

742
00:27:17,679 --> 00:27:19,279
navigates to another endpoint

743
00:27:19,279 --> 00:27:21,600
you will then be directed to our control

744
00:27:21,600 --> 00:27:24,320
domain in this case to emmy.com

745
00:27:24,320 --> 00:27:26,240
the only way to fight out for me was to

746
00:27:26,240 --> 00:27:28,080
clean the cookies or close the browser

747
00:27:28,080 --> 00:27:30,399
session

748
00:27:30,559 --> 00:27:32,799
so after i found out the vulnerability

749
00:27:32,799 --> 00:27:34,399
and i've seen that it's actually running

750
00:27:34,399 --> 00:27:35,200
on the tail room

751
00:27:35,200 --> 00:27:38,320
i wanted to do the velocity lookup

752
00:27:38,320 --> 00:27:41,440
i used spicy for this particular cave

753
00:27:41,440 --> 00:27:43,039
and i looked for any c name which

754
00:27:43,039 --> 00:27:45,679
includes internal or isreco

755
00:27:45,679 --> 00:27:48,480
i found out two results one from amazon

756
00:27:48,480 --> 00:27:49,760
the one for facebook

757
00:27:49,760 --> 00:27:51,279
which offers lag monty programs

758
00:27:51,279 --> 00:27:53,520
themselves as well so it was nice to see

759
00:27:53,520 --> 00:27:54,880
the vulnerability that i found from

760
00:27:54,880 --> 00:27:56,240
hannibal twitter

761
00:27:56,240 --> 00:27:58,640
affecting facebook and amazon from the

762
00:27:58,640 --> 00:28:01,120
same hunting session

763
00:28:01,120 --> 00:28:03,520
so we posted this to twitter and the

764
00:28:03,520 --> 00:28:05,120
report is already disclosed

765
00:28:05,120 --> 00:28:07,200
and uploaded to several other followers

766
00:28:07,200 --> 00:28:09,039
and made some nice launches for it as

767
00:28:09,039 --> 00:28:11,200
well

768
00:28:12,159 --> 00:28:14,159
the next one will be stored in success

769
00:28:14,159 --> 00:28:16,080
through email marketing innovation

770
00:28:16,080 --> 00:28:18,159
there are many private formats affected

771
00:28:18,159 --> 00:28:22,240
and the vendor is oracle responses

772
00:28:23,360 --> 00:28:25,440
the viewing browser feature allows

773
00:28:25,440 --> 00:28:27,200
customers to view their emails on the

774
00:28:27,200 --> 00:28:27,840
browser

775
00:28:27,840 --> 00:28:30,640
with a dedicated dedicated sideway of

776
00:28:30,640 --> 00:28:32,159
our target

777
00:28:32,159 --> 00:28:33,520
so as you can see from the pictures in

778
00:28:33,520 --> 00:28:35,600
the right there are some emails after we

779
00:28:35,600 --> 00:28:35,919
sign

780
00:28:35,919 --> 00:28:37,919
up that allow us to view the view in

781
00:28:37,919 --> 00:28:39,039
browser

782
00:28:39,039 --> 00:28:42,640
or can see this email click here html

783
00:28:42,640 --> 00:28:44,320
injection handling or images is quite

784
00:28:44,320 --> 00:28:45,039
common

785
00:28:45,039 --> 00:28:47,919
but considered as a low impact issue as

786
00:28:47,919 --> 00:28:49,840
you can see from the image of the right

787
00:28:49,840 --> 00:28:51,600
therefore targeting bounty targets

788
00:28:51,600 --> 00:28:53,679
utilizing responses in the templates

789
00:28:53,679 --> 00:28:55,279
which provides the viewing problem

790
00:28:55,279 --> 00:28:57,600
functionality will help us escalate the

791
00:28:57,600 --> 00:28:58,320
html

792
00:28:58,320 --> 00:29:00,399
injection issue to start whatsapp

793
00:29:00,399 --> 00:29:03,679
scripting on the targets

794
00:29:03,679 --> 00:29:06,080
so what i did i found that responsive

795
00:29:06,080 --> 00:29:08,000
uses certain pattern for the urls

796
00:29:08,000 --> 00:29:09,679
displaying the client emails

797
00:29:09,679 --> 00:29:12,080
which includes the following string pad

798
00:29:12,080 --> 00:29:12,799
it says

799
00:29:12,799 --> 00:29:15,520
short link i'll use the following google

800
00:29:15,520 --> 00:29:16,000
though

801
00:29:16,000 --> 00:29:19,200
with the in url google key and it helped

802
00:29:19,200 --> 00:29:20,880
me locate some interesting targets

803
00:29:20,880 --> 00:29:22,480
when you prone to installed and

804
00:29:22,480 --> 00:29:25,360
successful mobility

805
00:29:25,360 --> 00:29:27,520
what i did i supplied first and last

806
00:29:27,520 --> 00:29:29,679
name inputs on silent phones

807
00:29:29,679 --> 00:29:32,559
of anytime any bounty target who uses

808
00:29:32,559 --> 00:29:33,679
responses

809
00:29:33,679 --> 00:29:36,640
with an xss payload like shown below of

810
00:29:36,640 --> 00:29:38,559
image slc

811
00:29:38,559 --> 00:29:41,120
and i waited to receive emails like the

812
00:29:41,120 --> 00:29:42,000
following structure

813
00:29:42,000 --> 00:29:44,000
for the instance of the email i wanted

814
00:29:44,000 --> 00:29:46,320
to see only the closing time

815
00:29:46,320 --> 00:29:48,480
it means that there might be a rendering

816
00:29:48,480 --> 00:29:50,320
of my email

817
00:29:50,320 --> 00:29:53,039
and after we see some indication like

818
00:29:53,039 --> 00:29:53,919
the picture shown

819
00:29:53,919 --> 00:29:57,360
and clicked on viewing browser

820
00:29:58,159 --> 00:29:59,919
clicking on the view and browser button

821
00:29:59,919 --> 00:30:01,360
will direct using the expected time

822
00:30:01,360 --> 00:30:01,919
domain

823
00:30:01,919 --> 00:30:03,919
for the target so as you can see from

824
00:30:03,919 --> 00:30:05,840
the pictures i found center installed

825
00:30:05,840 --> 00:30:06,960
excesses

826
00:30:06,960 --> 00:30:09,039
after clicking on the view involved

827
00:30:09,039 --> 00:30:11,200
because the page rendered our first last

828
00:30:11,200 --> 00:30:11,840
name

829
00:30:11,840 --> 00:30:14,320
with the crosstalk scripting page so

830
00:30:14,320 --> 00:30:16,720
reported it with several parts of guns

831
00:30:16,720 --> 00:30:18,960
and got some bounties from it so it was

832
00:30:18,960 --> 00:30:22,000
very nice

833
00:30:22,000 --> 00:30:24,320
the next one it's not public yet but

834
00:30:24,320 --> 00:30:26,000
it's important to start already

835
00:30:26,000 --> 00:30:27,840
it's an opening director on staff

836
00:30:27,840 --> 00:30:31,520
network 7.8

837
00:30:32,000 --> 00:30:33,919
the targets are many programs and the

838
00:30:33,919 --> 00:30:36,399
vendor is set

839
00:30:36,399 --> 00:30:38,960
so the discovery as i was testing a new

840
00:30:38,960 --> 00:30:39,600
program

841
00:30:39,600 --> 00:30:42,880
and manually manually went to something

842
00:30:42,880 --> 00:30:44,720
and found an interesting endpoint which

843
00:30:44,720 --> 00:30:46,000
indicated this

844
00:30:46,000 --> 00:30:48,240
actually running itself so i was

845
00:30:48,240 --> 00:30:50,000
authenticated to some functionality

846
00:30:50,000 --> 00:30:51,520
of the submarine and they wanted to log

847
00:30:51,520 --> 00:30:54,000
off the following point was accepted

848
00:30:54,000 --> 00:30:56,640
through a post request simply changing

849
00:30:56,640 --> 00:30:57,679
it to a get

850
00:30:57,679 --> 00:31:00,000
and setting my website at the redirect

851
00:31:00,000 --> 00:31:01,440
url value

852
00:31:01,440 --> 00:31:03,919
resulted in an open indirect within more

853
00:31:03,919 --> 00:31:05,440
than ten thousand websites

854
00:31:05,440 --> 00:31:08,159
we didn't suffer so when i tried to log

855
00:31:08,159 --> 00:31:08,559
off

856
00:31:08,559 --> 00:31:10,960
from the subdomain it issued a post

857
00:31:10,960 --> 00:31:11,600
request

858
00:31:11,600 --> 00:31:14,720
for a change to get and put my own blog

859
00:31:14,720 --> 00:31:17,519
at the directory and i hadn't

860
00:31:17,519 --> 00:31:19,279
vulnerability

861
00:31:19,279 --> 00:31:21,200
so what i did i created the nuclear

862
00:31:21,200 --> 00:31:23,360
template to skyrocket

863
00:31:23,360 --> 00:31:26,159
i want to alert for a vulnerability with

864
00:31:26,159 --> 00:31:28,080
the response in exchange to our request

865
00:31:28,080 --> 00:31:28,399
on

866
00:31:28,399 --> 00:31:30,799
any subdomain that i had in my records

867
00:31:30,799 --> 00:31:32,960
by providing the following path

868
00:31:32,960 --> 00:31:35,120
we'll return the status for the co2 to

869
00:31:35,120 --> 00:31:36,399
the direction

870
00:31:36,399 --> 00:31:38,880
and the location header of my blog

871
00:31:38,880 --> 00:31:40,399
gallery.com

872
00:31:40,399 --> 00:31:42,880
so i ran it on my targets and i found

873
00:31:42,880 --> 00:31:44,320
several of these

874
00:31:44,320 --> 00:31:47,120
which elected big the subway direct with

875
00:31:47,120 --> 00:31:49,760
the link of the vulnerable instance

876
00:31:49,760 --> 00:31:53,039
so i actually found 142 times affected

877
00:31:53,039 --> 00:31:55,039
and reported several of these i

878
00:31:55,039 --> 00:31:57,039
discovered these nest mines

879
00:31:57,039 --> 00:31:59,519
so they are probably long time affected

880
00:31:59,519 --> 00:32:02,559
that i didn't scan

881
00:32:03,360 --> 00:32:07,039
let's go over the summary of the talk

882
00:32:07,039 --> 00:32:08,960
so the key takeaways i wanted to take

883
00:32:08,960 --> 00:32:10,399
from this session

884
00:32:10,399 --> 00:32:12,159
is about one attacking surprise

885
00:32:12,159 --> 00:32:14,480
integration is profitable

886
00:32:14,480 --> 00:32:17,200
and it's fun finding a single bag that

887
00:32:17,200 --> 00:32:18,960
affects many assets

888
00:32:18,960 --> 00:32:21,279
gives you more profit and more value for

889
00:32:21,279 --> 00:32:22,880
the work you dedicate

890
00:32:22,880 --> 00:32:24,960
instead of finding single single

891
00:32:24,960 --> 00:32:27,279
specific bugs on tablets

892
00:32:27,279 --> 00:32:29,600
the second point would be the constant

893
00:32:29,600 --> 00:32:30,799
it's a critical part

894
00:32:30,799 --> 00:32:33,039
of successful backpacking you can't rely

895
00:32:33,039 --> 00:32:34,640
on your possible sources you want to

896
00:32:34,640 --> 00:32:35,279
find as

897
00:32:35,279 --> 00:32:38,320
much subdomains as possible scaling

898
00:32:38,320 --> 00:32:41,360
up equals saving time you can't navigate

899
00:32:41,360 --> 00:32:42,080
to medium

900
00:32:42,080 --> 00:32:45,039
submarines with a certain stream to

901
00:32:45,039 --> 00:32:46,399
search it it's vulnerable

902
00:32:46,399 --> 00:32:48,240
you have to use no clearing of other

903
00:32:48,240 --> 00:32:50,000
tools as long as you send

904
00:32:50,000 --> 00:32:52,399
hundreds of requests a second to many

905
00:32:52,399 --> 00:32:53,279
subdomains

906
00:32:53,279 --> 00:32:56,159
instead of doing the manual work the

907
00:32:56,159 --> 00:32:57,679
sell will be impact

908
00:32:57,679 --> 00:32:59,919
always opt for chaining bugs there's

909
00:32:59,919 --> 00:33:01,039
nothing wrong with toting

910
00:33:01,039 --> 00:33:03,440
law or medium bugs too many problems as

911
00:33:03,440 --> 00:33:04,720
long as it is in scope

912
00:33:04,720 --> 00:33:07,200
and you get value from it and the last

913
00:33:07,200 --> 00:33:09,519
point is anyone can do it

914
00:33:09,519 --> 00:33:11,200
not nonsense the vulnerabilities that

915
00:33:11,200 --> 00:33:12,640
presented in this session

916
00:33:12,640 --> 00:33:15,679
was really complex to find we just need

917
00:33:15,679 --> 00:33:16,159
to know

918
00:33:16,159 --> 00:33:20,080
what to look at so i thank you very much

919
00:33:20,080 --> 00:33:21,039
for tuning in

920
00:33:21,039 --> 00:33:22,880
you can hit me up with feedback or

921
00:33:22,880 --> 00:33:24,880
follow questions on my twitter

922
00:33:24,880 --> 00:33:27,760
at nebula and i thank you all and i wish

923
00:33:27,760 --> 00:33:28,000
you

924
00:33:28,000 --> 00:33:31,200
a very happy and successful event going

925
00:33:31,200 --> 00:33:32,240
forward

926
00:33:32,240 --> 00:33:36,080
thank you very much

