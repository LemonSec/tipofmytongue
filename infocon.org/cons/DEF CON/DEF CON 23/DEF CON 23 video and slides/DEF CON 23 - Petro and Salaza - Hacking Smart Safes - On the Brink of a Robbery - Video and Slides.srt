00:00:00.534 --> 00:00:05.939
 >> We're going to be talking
about hacking smart safes today.

00:00:05.939 --> 00:00:10.777
I've said the words safe hacking
before and people are always

00:00:10.777 --> 00:00:13.413
like what are you talking about?
Are you talking about practicing

00:00:13.413 --> 00:00:16.817
safe hacking. I'm not sure what
that means. >> Not related to

00:00:16.817 --> 00:00:20.621
that whatsoever. >> These are
physical safes that have smart

00:00:20.621 --> 00:00:24.591
devices on them. >> So really
quick as a matter of

00:00:24.591 --> 00:00:27.394
introduction. I'm Dan Petro.
This is Oscar Salazar. We're

00:00:27.394 --> 00:00:30.797
both associates at Bishop fox.
We do pen testing for a number

00:00:30.797 --> 00:00:33.133
of things. These are the
internet of thing, devices

00:00:33.133 --> 00:00:35.135
included. Without further adieu
we can get into the meat of the

00:00:35.135 --> 00:00:37.137
talk. >> This is the CompuSafe
Galileo. It's a similar brand of

00:00:37.137 --> 00:00:39.139
smart safe that we happen to
come across. I wanted to start

00:00:39.139 --> 00:00:44.244
this off with an apology I
guess. We tried really, really

00:00:44.244 --> 00:00:50.250
hard to get one of these things
here on stage at DEFCON. But the

00:00:56.657 --> 00:00:59.860
thing is a tank and logistically
would not have worked out

00:00:59.860 --> 00:01:02.896
whatsoever. It's 380 pounds.
It's actually not that big. It's

00:01:02.896 --> 00:01:06.900
only like maybe 3 feet tall or
something like that. For 380

00:01:06.900 --> 00:01:09.569
pounds for such a small object,
it's completely immense. You

00:01:09.569 --> 00:01:12.839
cannot lift it basically. You
have to like roll it around. And

00:01:12.839 --> 00:01:15.976
these things don't have ramps if
you notice, like these stages.

00:01:15.976 --> 00:01:19.846
It was going to cost like $400
from the labor union to carry

00:01:19.846 --> 00:01:24.217
onto the stage and another $400
to carry it off. Not to mention

00:01:24.217 --> 00:01:27.087
like shipping costs, it was a
complete nightmare and we

00:01:27.087 --> 00:01:29.423
eventually had to give up on it.
So just really sorry. We wanted

00:01:29.423 --> 00:01:32.960
to have one here on stage but it
was not in the cards. That tells

00:01:32.960 --> 00:01:37.331
you a little bit about what this
safe is. Just like -- it can

00:01:37.331 --> 00:01:40.267
legitimately withstand a bomb
blast. The think is a tank. >>

00:01:40.267 --> 00:01:43.904
And essentially this thing
handles money. You put money

00:01:43.904 --> 00:01:48.775
into the slot reader or the
money dispenser thing at the

00:01:48.775 --> 00:01:52.312
top. It's like a reverse ATM
essentially. You put money in.

00:01:52.312 --> 00:01:57.584
The money then is no longer
yours. If you don't own that

00:01:57.584 --> 00:02:01.621
money it gets deposited into
your bank account. And so

00:02:01.621 --> 00:02:07.094
because of that process, the
safe itself can't be opened by

00:02:07.094 --> 00:02:11.231
the managers. It has a set of
authentication and authorization

00:02:11.231 --> 00:02:15.068
where the manage can have,
create new users and employees

00:02:15.068 --> 00:02:21.408
can put money in. This is meant
to be kind of in retail stores.

00:02:21.408 --> 00:02:23.443
>> It's not meant to be
something that you as a consumer

00:02:23.443 --> 00:02:26.146
can have in your house. It's
like a cash management solution

00:02:26.146 --> 00:02:29.650
for a business like retail
outlets. This is something

00:02:29.650 --> 00:02:33.086
sitting underneath the cash
register at stores you probably

00:02:33.086 --> 00:02:37.224
go to. Like they're out there in
the wild. This is something that

00:02:37.224 --> 00:02:40.927
take money from the till like
after an employee has too much

00:02:40.927 --> 00:02:43.730
money rather than leaving it in
the till or having them count

00:02:43.730 --> 00:02:46.666
it. That way they have lots of
accounting problems, and you

00:02:46.666 --> 00:02:50.404
insert the money into the safe
and it waits there until the

00:02:50.404 --> 00:02:54.908
carrier service carries it away.
>> So the carrier service will

00:02:54.908 --> 00:02:59.179
come and pick up the money at a
designated amount of time or

00:02:59.179 --> 00:03:01.748
when the safe reach as certain
amount of money. And they'll

00:03:01.748 --> 00:03:05.986
take it away. In order for them
to take the money out of the

00:03:05.986 --> 00:03:08.655
safe it requires both the
manager and the armored carrier

00:03:08.655 --> 00:03:13.026
service, the car service to both
sign into the application. >>

00:03:13.026 --> 00:03:16.029
That's important point to
mention. Is that because the

00:03:16.029 --> 00:03:20.734
money for the safe is deposited
into the store's account once

00:03:20.734 --> 00:03:23.904
money is inserted into it, then
it informs two thing. One it

00:03:23.904 --> 00:03:26.373
informs the security model
behind the safe. Like as Oscar

00:03:26.373 --> 00:03:30.811
said, the store manager is not
allowed to open the top drawer

00:03:30.811 --> 00:03:33.080
of the safe where the cash is
because the cash is no longer

00:03:33.080 --> 00:03:36.083
his money. Once the cash is
inside that safe, it's already

00:03:36.083 --> 00:03:38.085
deposited into the bank's
account and that's the bank's

00:03:38.085 --> 00:03:41.621
money. Just temporarily sitting
around inside of that safe. So

00:03:41.621 --> 00:03:44.658
the way that the security model
is worked out is it's like a

00:03:44.658 --> 00:03:48.028
nuclear launch facility. Two
people have to simultaneously

00:03:48.028 --> 00:03:52.365
put in their keys and turn them.
So both the carrier service have

00:03:52.365 --> 00:03:55.135
to authenticate to the safe,
they have to type in their code

00:03:55.135 --> 00:03:57.737
or in practice they have a touch
memory thing that we'll talk

00:03:57.737 --> 00:04:00.107
about. And in addition to that
the store manager also has to

00:04:00.107 --> 00:04:06.113
put in their code. >> So we did
this assessment as part of

00:04:08.548 --> 00:04:11.218
essentially a customer came to
us, they had a point of sale

00:04:11.218 --> 00:04:14.321
system they wanted us to review
and this safe was part of that

00:04:14.321 --> 00:04:21.495
point of sale system. We worked
with the vendors to disclose the

00:04:21.495 --> 00:04:27.300
vulnerability and brinks has
informs us they are in the

00:04:27.300 --> 00:04:32.172
process of releasing a patch and
we actually tested the patch

00:04:32.172 --> 00:04:36.743
that fire king created that
fixes one of the specific issues

00:04:36.743 --> 00:04:41.915
that was used to create this
attack chain. >> Yeah, let's

00:04:41.915 --> 00:04:47.921
see, also -- so we have a safe
that we had purchased off E-bay.

00:04:50.991 --> 00:04:55.262
With remarkably no questions
asked. And that was the one that

00:04:55.262 --> 00:04:57.831
we were trying to bring here in
person. I guess at another

00:04:57.831 --> 00:05:00.967
little anecdote to share with
you about just how crazy and

00:05:00.967 --> 00:05:04.271
massive the thing is. We got
this thing shipped. It has to

00:05:04.271 --> 00:05:07.674
ship via freight and it gets to
our office over at bishop fox

00:05:07.674 --> 00:05:10.777
and I'm all super-happy and like
finally the safe is here. I'm

00:05:10.777 --> 00:05:14.181
going to get to mess with it.
And the dude comes around the

00:05:14.181 --> 00:05:17.717
side and says okay, we have this
big package for you, go ahead

00:05:17.717 --> 00:05:20.453
and bring around your forklift.
And bring it off the truck. I'm

00:05:20.453 --> 00:05:24.925
like a forklift? I don't have a
god dam forklift? Why would you

00:05:24.925 --> 00:05:27.861
expect me to have a forklift? I
didn't expect to need a

00:05:27.861 --> 00:05:31.798
forklift. So we had to schedule
a completely different truck

00:05:31.798 --> 00:05:33.867
with a pneumatic lift that has
to come by and it was a complete

00:05:33.867 --> 00:05:38.271
nightmare. Even getting it like
10 feet from the truck into our

00:05:38.271 --> 00:05:43.310
office. So nothing about this
has been easy basically? >> And

00:05:43.310 --> 00:05:47.514
so we're kind of disclosing all
this information for educational

00:05:47.514 --> 00:05:50.784
purposes and informational
purposes only. Don't try this at

00:05:50.784 --> 00:05:54.120
home. This is -- >> Definitely
don't try this at your

00:05:54.120 --> 00:05:57.557
neighbor's home. >> You can try
it in your own home if you own

00:05:57.557 --> 00:06:02.963
your own safe maybe. All right.
We're actually going to go ahead

00:06:02.963 --> 00:06:10.136
and do a demonstration. >> This
is where we hope we have audio.

00:06:10.136 --> 00:06:14.441
We don't. Let's see. I'm
definitely plugged in. Let's see

00:06:14.441 --> 00:06:17.711
if we can get audio. I hear it
now. Okay. Let's play this and

00:06:17.711 --> 00:06:23.717
see if we don't blow everyone's
ears out. That's a reasonable

00:06:27.020 --> 00:06:33.026
level? >> Traditional safes like
just about everything these days

00:06:36.096 --> 00:06:39.466
have technologically evolved
into computerized smart safes

00:06:39.466 --> 00:06:42.135
which are currently being used
by countless businesses across

00:06:42.135 --> 00:06:44.904
the country. A safe by
definition is inherently safe.

00:06:44.904 --> 00:06:47.674
People trust them with their
most valuable possessions and

00:06:47.674 --> 00:06:51.044
businesses trust them with cash.
Large amounts of cash. You would

00:06:51.044 --> 00:06:54.447
think that smart safes are even
more trustworthy and secure than

00:06:54.447 --> 00:06:57.817
the old fashioned kind, right?
But how smart are they really?

00:06:57.817 --> 00:07:01.621
For the most part smart safes
seem pretty secure. However one

00:07:01.621 --> 00:07:04.624
particular model has a sees you
design flaw. The brinks

00:07:04.624 --> 00:07:08.361
CompuSafe Galileo has a USB port
on the safe's exterior. This

00:07:08.361 --> 00:07:11.364
enables a malicious user to
automate an attack on the safe's

00:07:11.364 --> 00:07:15.035
computer and quickly opens its
doors. All someone needs to do

00:07:15.035 --> 00:07:17.837
is plug a programmed thumb drive
into that port and viol‡. To

00:07:17.837 --> 00:07:23.843
learn more visit your website at
WWW.bishop fox.COM? >> That was

00:07:31.618 --> 00:07:33.920
an awesome video. That is
totally on our You Tube channel.

00:07:33.920 --> 00:07:37.090
Some company named Gravic or
Gravok, I'm not sure exactly how

00:07:37.090 --> 00:07:40.527
to say it made that. They do
like graphic design and info

00:07:40.527 --> 00:07:45.131
sec. Seriously. That is awesome.
Cheers to those guys. They made

00:07:45.131 --> 00:07:48.835
that suite cartoon and
everything for it. So we -- that

00:07:48.835 --> 00:07:51.871
goes really quickly through the
major vulnerabilities that we

00:07:51.871 --> 00:07:55.608
identified in the safe. We're
going to talk individually about

00:07:55.608 --> 00:07:58.812
every single step along that
like. If you freeze frame that

00:07:58.812 --> 00:08:05.452
video you can see the exploit
chain as it were. We'll go

00:08:05.452 --> 00:08:07.487
through it in more depth here?
>> So what we want to talk about

00:08:07.487 --> 00:08:11.124
a little bit is how this is a
combination of a bunch of

00:08:11.124 --> 00:08:16.496
different issues this. Is a long
attack chain that ends with the

00:08:16.496 --> 00:08:20.867
safe opening. But each
individual piece by itself

00:08:20.867 --> 00:08:25.972
doesn't lead to a full
compromise. This is kind of --

00:08:25.972 --> 00:08:30.143
hardware, software,
configurations, networking, all

00:08:30.143 --> 00:08:33.880
of those things kind of are
required in order to form this

00:08:33.880 --> 00:08:38.017
type of exploit. >> I think that
is maybe something worth

00:08:38.017 --> 00:08:40.553
mentioning in terms of the
internet of things. These are

00:08:40.553 --> 00:08:42.722
all areas that we as hackers are
used to, right. These are the

00:08:42.722 --> 00:08:48.461
issues that we're used to
dealing with. Now that you have

00:08:48.461 --> 00:08:51.398
these other devices that are
coming out with people that are

00:08:51.398 --> 00:08:53.767
very used to making toasters,
right and they're not used to

00:08:53.767 --> 00:08:56.770
making toasters that are secure
against attacks over the

00:08:56.770 --> 00:08:59.105
internet. These are all issues
that are going to come up in

00:08:59.105 --> 00:09:01.207
other data devices that we
didn't used to have to care

00:09:01.207 --> 00:09:04.811
about. So all these sorts of
issues. It may seem obvious and

00:09:04.811 --> 00:09:08.381
laughable to us, right, but keep
in mind that these are sort of

00:09:08.381 --> 00:09:11.451
issues that are going to be
coming forward more often. >>

00:09:11.451 --> 00:09:13.953
These are the types of things
that we see across all types of

00:09:13.953 --> 00:09:17.424
internet of things devices.
Right. The cars that can be

00:09:17.424 --> 00:09:22.495
hacked. That is something that
was a space before that never

00:09:22.495 --> 00:09:25.965
had to worry about security in
that fashion other than a car

00:09:25.965 --> 00:09:28.968
alarm and now you have to
protect against hacks and

00:09:28.968 --> 00:09:33.006
attacks. >> And obviously big
whiz bang objects like cars and

00:09:33.006 --> 00:09:35.508
airplanes get a lot of press.
And maybe they should, right.

00:09:35.508 --> 00:09:38.978
But every day objects and things
planted inside of businesses and

00:09:38.978 --> 00:09:45.285
homes also get a lot of
attention as well. So this is a

00:09:45.285 --> 00:09:48.354
picture of the outside of the
safe. The front panel has a

00:09:48.354 --> 00:09:52.192
touch screen. This is on the
left panel of that touch screen.

00:09:52.192 --> 00:09:56.129
The way that the service pick up
authenticate to it. Say if

00:09:56.129 --> 00:10:00.099
you're going to be picking up
cash, you have this little

00:10:00.099 --> 00:10:04.471
contact memory key. Actually I
have no idea what this was. I

00:10:04.471 --> 00:10:09.175
had to Google it because I had
no idea what this connector was.

00:10:09.175 --> 00:10:12.779
And like it's a magnetic things
that talks over some

00:10:12.779 --> 00:10:15.682
cryptographic protocol or
something like that. And that's

00:10:15.682 --> 00:10:18.718
how like the drivers
authenticate to the safe to say,

00:10:18.718 --> 00:10:21.588
hey, I'm here to pick up cash.
>> I really wish we were up here

00:10:21.588 --> 00:10:24.023
talking about how we reverse
engineered some really cool

00:10:24.023 --> 00:10:28.127
thing and like we were doing
stuff with this contact key. But

00:10:28.127 --> 00:10:31.030
that is not what this talk is
about. This talk is about the

00:10:31.030 --> 00:10:34.534
exposed USB port on the side of
the safe. >> Right next to it.

00:10:34.534 --> 00:10:38.671
>> Immediately right next to it.
>> That port is not like -- it's

00:10:38.671 --> 00:10:42.041
not behind a panel of some kind.
It's not like hidden underneath

00:10:42.041 --> 00:10:45.445
something. You don't need to
open the door to get it to. It's

00:10:45.445 --> 00:10:50.717
like right on the side of the
safe. >> So having the ebbing

00:10:50.717 --> 00:10:56.189
posed USB is a pretty big deal
in terms of being able to plug

00:10:56.189 --> 00:10:58.758
into the device, we saw this, we
immediately plugged in a mouse

00:10:58.758 --> 00:11:03.897
and saw a curser pop up on the
screen. Like all right, I like

00:11:03.897 --> 00:11:06.666
where this is going. >>
Immediately liked where that was

00:11:06.666 --> 00:11:10.970
going. >> And we're like, okay,
we're plugging in a mouse,

00:11:10.970 --> 00:11:14.841
moving it around, and plugging
and unplugging that and plugging

00:11:14.841 --> 00:11:17.310
in a keyboard and typing some
stuff. And unplug that and plug

00:11:17.310 --> 00:11:20.680
in the mouse again and it gets
quite cumbersome. So we make

00:11:20.680 --> 00:11:23.950
like a quick trip, we got to
solve this problem. We go to

00:11:23.950 --> 00:11:29.022
Best Buy and we buy a USB
dongle, like a hub. That allows

00:11:29.022 --> 00:11:32.458
us to connect multiple devices.
Problem solved. Great news. So

00:11:32.458 --> 00:11:38.031
we plugged that in and start
working our way through. Shortly

00:11:38.031 --> 00:11:41.301
afterwards we removed the four
Phillip's head screws from the

00:11:41.301 --> 00:11:44.237
side of the display. >> What
you're seeing here is the front

00:11:44.237 --> 00:11:47.874
panel, the entire touch screen
unhinges and moves forward.

00:11:47.874 --> 00:11:52.645
There is four Phillip's head
screws not like security screws,

00:11:52.645 --> 00:11:57.083
not like epoxyed in. Just
regular Phillip's head screwed.

00:11:57.083 --> 00:11:59.886
Unhinged the whole thing, you
can get access to some computer

00:11:59.886 --> 00:12:02.989
innards there as well. >> This
is like a picture from the top

00:12:02.989 --> 00:12:06.359
down. They also had the same
epiphany as we did. They bought

00:12:06.359 --> 00:12:10.396
a USB hub and Velcrod it into
the inside of the safe as well.

00:12:10.396 --> 00:12:13.633
>> It's literally Velcrod in.
This is like a microcosm of what

00:12:13.633 --> 00:12:19.939
happened with the safe. I have
this mental picture in my head

00:12:19.939 --> 00:12:24.410
of the safe being designed and
manufactured and come the time

00:12:24.410 --> 00:12:27.246
that somebody is putting it all
together they're like, oh shit,

00:12:27.246 --> 00:12:31.017
we needed two USB ports in the
front and we only ran one in.

00:12:31.017 --> 00:12:37.190
They're like, oh, shit. Um, run
out to best buy, Velcro in a USB

00:12:37.190 --> 00:12:44.397
hub and just call it a day. So
this is really important because

00:12:44.397 --> 00:12:47.166
the touch screen itself is just
a USB hit device. Like a --

00:12:47.166 --> 00:12:52.005
that's what it is. The fact that
like you can unhinge this and

00:12:52.005 --> 00:12:55.675
get direct access to that USB is
really important. That's like

00:12:55.675 --> 00:12:59.145
built into the design of the
safe. It's not like you can just

00:12:59.145 --> 00:13:02.015
easily remove that. There has to
be a USB port leading out to the

00:13:02.015 --> 00:13:04.484
front of this panel and if you
can just unhinge the front panel

00:13:04.484 --> 00:13:08.655
and get access to that USB it's
like, good hardware access right

00:13:08.655 --> 00:13:15.728
there. That one is not showing
up. Even more slightly less

00:13:15.728 --> 00:13:20.099
exposed USB port. On the back of
the safe, like in the complete

00:13:20.099 --> 00:13:24.570
rear of it, the lower left hand
corner there is a hole with an

00:13:24.570 --> 00:13:29.909
ethernet Jack coming out, serial
port and another USB port. This

00:13:29.909 --> 00:13:32.979
one is like -- this is the third
USB port basically coming out of

00:13:32.979 --> 00:13:36.049
the side of the safe, this one
is less important because like

00:13:36.049 --> 00:13:38.317
it's in the back and these
things are not meant to be

00:13:38.317 --> 00:13:41.888
easily accessed. They're bolted
to the ground so it's not like

00:13:41.888 --> 00:13:44.857
you can pull it out to move it.
It's probably in some sort of an

00:13:44.857 --> 00:13:48.061
enclosure. >> And if you're
getting to the point where

00:13:48.061 --> 00:13:52.665
you're kind of pulling the whole
safe out to connect to the USB,

00:13:52.665 --> 00:13:54.901
it's going to be pretty obvious
you're going to have to do that

00:13:54.901 --> 00:14:01.908
in a sneaky fashion. >> These
USB drives had full drivers

00:14:01.908 --> 00:14:06.946
enabled. It had the ability to
plug in a keyboard and a mouse

00:14:06.946 --> 00:14:08.948
and it immediately recognized
it. We had, we were able to plug

00:14:08.948 --> 00:14:14.187
in a thumb drive as well to get
access to the storage. >> USB

00:14:14.187 --> 00:14:17.924
mass storage, USB hid. Basically
full drivers enabled. Nothing

00:14:17.924 --> 00:14:20.827
restricted in any way. There
wasn't a USB device white

00:14:20.827 --> 00:14:26.532
listing or like nothing like
that basically. You just plug it

00:14:26.532 --> 00:14:29.368
in and it works. >> One of the
big things is you can boot up

00:14:29.368 --> 00:14:34.407
both off the USB. At the bottom
of the touch panel there is a

00:14:34.407 --> 00:14:39.579
button that allows you to reboot
the device. >> A big red button.

00:14:39.579 --> 00:14:42.548
Right like underneath. If you're
looking at the touch screen it's

00:14:42.548 --> 00:14:46.552
right underneath it and as soon
as you get the big windows XP,

00:14:46.552 --> 00:14:51.624
would you like to log out,
reboot, or turn off comes up. >>

00:14:51.624 --> 00:14:54.060
Before we pressed it, we're like
is it going to eject the money?

00:14:54.060 --> 00:14:56.996
What is this? What does the red
button do. It's unlabeled and

00:14:56.996 --> 00:15:01.734
there is a big red button. It
was beautiful. So from there you

00:15:01.734 --> 00:15:04.070
can reboot the machine. You
don't need to get access or

00:15:04.070 --> 00:15:07.173
authenticate. You can touch the
button and reboot the machine

00:15:07.173 --> 00:15:10.676
right from there. And then
plugging in a USB hard drive you

00:15:10.676 --> 00:15:14.580
boot from USB and do whatever
you want to the safe from there

00:15:14.580 --> 00:15:19.252
basically. That's actually a
really important attack combined

00:15:19.252 --> 00:15:23.156
with this. >> So the whole
database or the whole safe

00:15:23.156 --> 00:15:28.694
essentially works off this one
database, it's a MS access

00:15:28.694 --> 00:15:32.899
database 4.0 which is a little
old. >> I hear rumblings in the

00:15:32.899 --> 00:15:38.871
crowd, oh. >> It's password
protected but not encrypted. If

00:15:38.871 --> 00:15:44.343
you try to access it using MS
access, then you'll get prompted

00:15:44.343 --> 00:15:47.480
with a password. It's like an
opt-in password policy. If you

00:15:47.480 --> 00:15:53.219
open it on mac or Linux it
doesn't prompt you at all. >>

00:15:53.219 --> 00:15:56.122
That is access' fault basically.
That's like how the old

00:15:56.122 --> 00:15:59.225
versioned worked. They just
decided to stick a password in

00:15:59.225 --> 00:16:02.628
plain text and cross their
fingers and hope no one reads

00:16:02.628 --> 00:16:05.565
it. >> The very, very early
versions had a plain text

00:16:05.565 --> 00:16:09.101
password and header and they
started encoding it more and

00:16:09.101 --> 00:16:12.572
more and more. 4.0 is encoded
but completely reversible as

00:16:12.572 --> 00:16:15.641
well so you can get the plain
text password. >> You cannot use

00:16:15.641 --> 00:16:19.679
windows and it opens up the file
just fine. >> This also handles,

00:16:19.679 --> 00:16:23.115
this database handles all the
authentication and

00:16:23.115 --> 00:16:28.020
authorization. It's where all of
your user information is stored.

00:16:28.020 --> 00:16:31.958
Has credentials in there. It
stores all the logs about access

00:16:31.958 --> 00:16:34.827
to the safe. When you go in and
put money in and make a deposit

00:16:34.827 --> 00:16:38.598
and when the armored car people
come and pull the money out, all

00:16:38.598 --> 00:16:42.268
of that is logged into this
database. Gaining access to this

00:16:42.268 --> 00:16:46.439
database is basically the keys
to the castle. Once you have

00:16:46.439 --> 00:16:50.243
that database, you can modify
this database. You're able to

00:16:50.243 --> 00:16:53.713
essentially open the door? >>
You can imagine a world where

00:16:53.713 --> 00:16:57.617
like a safe were designed with a
CryptoChip on the inside of it.

00:16:57.617 --> 00:17:01.087
A piece of hardware that can't
be modified where it would do

00:17:01.087 --> 00:17:03.256
some sort of cryptographic
challenge response like

00:17:03.256 --> 00:17:07.260
protocol. That way if the
computer were to be hijacked it

00:17:07.260 --> 00:17:11.297
would like, you couldn't man in
the middle that connection and

00:17:11.297 --> 00:17:15.501
plan retacks or whatever. That
is not how this works. That is

00:17:15.501 --> 00:17:19.038
not how this works at all. The
safe is essentially a COM port

00:17:19.038 --> 00:17:23.075
attached to the XP box that is
beneath this thing and just

00:17:23.075 --> 00:17:26.379
sends the unlock command and it
just unlocks. >> The compromise

00:17:26.379 --> 00:17:30.249
of the OS itself. >> If you
compromise the OS, you

00:17:30.249 --> 00:17:33.920
compromise the whole thing. So
we have a second demonstration

00:17:33.920 --> 00:17:39.125
here. >> This is just a break
out. I'm used to the slides.

00:17:39.125 --> 00:17:42.929
Sorry. I'm getting ahead of
myself. Go ahead. >> When we

00:17:42.929 --> 00:17:45.831
first plugged in the keyboard
and mouse we're in this kiosk

00:17:45.831 --> 00:17:48.768
mode for this safe. We're trying
to break out the kiosk mode. We

00:17:48.768 --> 00:17:52.505
try the regular things, we try
control/shift/escape. We try

00:17:52.505 --> 00:17:57.076
alt/tab. Alt/F4. The windows
key, a couple combinations and

00:17:57.076 --> 00:18:01.948
nothing seems to work. So we
start feeling frustrated and

00:18:01.948 --> 00:18:05.351
decide that the hulk smash
technique will work and just

00:18:05.351 --> 00:18:09.622
start pounding on the keyboard.
>> Highly manual keyboard

00:18:09.622 --> 00:18:13.759
fuzzing. Technical firm. >> And
it actually works. So something

00:18:13.759 --> 00:18:17.797
pops up and just to break out of
the sand box we're like this is

00:18:17.797 --> 00:18:23.002
awesome. The kiosk mode on the
application reasserts itself

00:18:23.002 --> 00:18:25.004
every once in a while. So like
pushing in front -- >> It's like

00:18:25.004 --> 00:18:28.107
60 seconds where it forces
itself back to the foreground.

00:18:28.107 --> 00:18:30.710
>> So we're half way into
breaking out of this sand box,

00:18:30.710 --> 00:18:34.981
we have explorer running and
everything falls behind the

00:18:34.981 --> 00:18:39.151
kiosk mode again. Oh. So we try
smashing on the keyboard again.

00:18:39.151 --> 00:18:42.288
Probably look like a bunch of
idiots sitting in front of this

00:18:42.288 --> 00:18:48.160
thing. >> This is how we hack.
>> Just like the movies. And

00:18:48.160 --> 00:18:50.563
unfortunately we can't get it to
reproduce. So we have to find a

00:18:50.563 --> 00:18:53.766
more reliable exploit. And so
this is what we ended up coming

00:18:53.766 --> 00:18:59.772
up with. So the way this safe
works is ... There's a tutorial

00:19:06.712 --> 00:19:11.083
system on the safe. If you want
to add a user or learn about how

00:19:11.083 --> 00:19:14.253
to deposit money into the safe.
There is a tutorial button. So

00:19:14.253 --> 00:19:16.655
you click on this tutorial
button. It brings you to a bunch

00:19:16.655 --> 00:19:20.292
of videos that will allow you to
learn how to properly operate

00:19:20.292 --> 00:19:24.430
the safe. However they're all
flash videos. So right clicking

00:19:24.430 --> 00:19:29.035
on the flash object there allows
you to pull up flash settings.

00:19:29.035 --> 00:19:32.905
You go to about configuration?
>> Something worth mentioning on

00:19:32.905 --> 00:19:35.908
the flash videos, one of the
awesome things, they have help

00:19:35.908 --> 00:19:39.111
to help you do basically
anything with the safe including

00:19:39.111 --> 00:19:45.117
like how to login as a manager.
And in the how to login as a

00:19:49.422 --> 00:19:55.094
manager video that is on the
safe, it says half way through

00:19:55.094 --> 00:19:58.097
it, don't forget, if you forget
your password the password is

00:19:58.097 --> 00:20:01.400
12345. I'm like ... Our safes
still have that enabled on it.

00:20:01.400 --> 00:20:04.403
Though importantly this is just
a store manager who doesn't have

00:20:04.403 --> 00:20:07.673
access to the safe door, so even
though that's there, it doesn't

00:20:07.673 --> 00:20:13.879
really get us anything. >> So
once we were able to go to the

00:20:13.879 --> 00:20:15.981
internet explorer, the about con
fig for Adobe it pops up

00:20:15.981 --> 00:20:20.119
internet explorer. >> So it
tries to go to Adobe.com in

00:20:20.119 --> 00:20:24.957
internet explorer 4 or 6. >> And
from there you're able to kind

00:20:24.957 --> 00:20:28.694
of go through the motions right.
Internet explorer to explorer

00:20:28.694 --> 00:20:31.697
and explorer to CMD and you're
running as the administrator. >>

00:20:31.697 --> 00:20:34.633
Once you get up to internet
explorer you can break into the

00:20:34.633 --> 00:20:37.269
operating system and it's pretty
much game over from there. It is

00:20:37.269 --> 00:20:42.074
running windows XP, like an
embedded version of XP so at

00:20:42.074 --> 00:20:45.544
least hypothetically it's
getting remote back ports. But

00:20:45.544 --> 00:20:48.881
like still probably not great.
Though it should be worth

00:20:48.881 --> 00:20:51.917
mentioning that windows 10 would
not have saved the safe. There

00:20:51.917 --> 00:20:55.988
are a lot of other issues. The
fact that it was XP tended not

00:20:55.988 --> 00:20:59.792
to be terribly important to the
exploit chain. But there could

00:20:59.792 --> 00:21:02.761
have been a lot of other
permissions maybe. Maybe the

00:21:02.761 --> 00:21:04.797
application could have been
running as a lower privileged

00:21:04.797 --> 00:21:07.466
user, that way you couldn't
break out and run other

00:21:07.466 --> 00:21:11.904
commands. So that was helpful.
The fact that we could modify

00:21:11.904 --> 00:21:17.176
arbitrary things in the
operating system? >> So opening

00:21:17.176 --> 00:21:20.713
the internet explorer is what
fire king did as the patch to

00:21:20.713 --> 00:21:25.451
break the exploit chain to
prevent this from going through

00:21:25.451 --> 00:21:31.423
the process of escaping the
kiosk mode. So once you have

00:21:31.423 --> 00:21:35.261
access to the command line
you're able to do things like

00:21:35.261 --> 00:21:41.033
add users to the database. Since
we have the credentials for the

00:21:41.033 --> 00:21:44.336
MS access database that are
stored in the headers. We're

00:21:44.336 --> 00:21:49.074
able to add on service accounts.
And service accounts don't have

00:21:49.074 --> 00:21:52.411
the same requirements as a
manager. If you're a service

00:21:52.411 --> 00:21:54.780
technician and you come, you
have to work on the safe. You're

00:21:54.780 --> 00:21:59.685
the only person that needs to be
logging in? >> There aren't any

00:21:59.685 --> 00:22:03.122
service accounts already enabled
on the safe by default. So we

00:22:03.122 --> 00:22:06.592
just have to add ourselves like
two new service accounts into

00:22:06.592 --> 00:22:09.662
the safe and call them hack one
and hack two. Curiously you

00:22:09.662 --> 00:22:13.432
still need two service accounts
presumably because they don't

00:22:13.432 --> 00:22:16.135
want just one service person to
be able to open up the safe. You

00:22:16.135 --> 00:22:19.305
need two people simultaneously
go, fine, we'll just add two

00:22:19.305 --> 00:22:22.107
accounts and login with both
accounts. >> Which is strange.

00:22:22.107 --> 00:22:26.011
In the video you'll see that.
You have to login with two

00:22:26.011 --> 00:22:29.782
different accounts. >> If you're
going to work on one of these

00:22:29.782 --> 00:22:33.385
safes, you have to add your on
account anyways. So there is no

00:22:33.385 --> 00:22:39.491
reason why you couldn't add two
I guess. We're going to play

00:22:39.491 --> 00:22:42.962
through the video of the actual
exploit now. We'll kind of pause

00:22:45.231 --> 00:22:49.802
it every once in a while and
describe what is going on. >> We

00:22:49.802 --> 00:22:56.642
need audio on the computer
again. It works, suite. >> This

00:22:56.642 --> 00:23:02.581
is the safe. Essentially we
created a script abnormal a

00:23:08.487 --> 00:23:11.223
TINSI. I don't know if you're
familiar with it. >> Speaking of

00:23:11.223 --> 00:23:14.793
printed materials we said USB
rubber ducky. Turns out that the

00:23:14.793 --> 00:23:17.896
ducky doesn't do mouse
movements. It's only keyboard.

00:23:17.896 --> 00:23:21.300
So we had to (inaudible) from
that. The printed materials are

00:23:21.300 --> 00:23:25.671
out of date and we couldn't fix
them in time. It's no big deal.

00:23:25.671 --> 00:23:29.708
Basically we had to switch to a
TINSI which is our ADWINO board

00:23:29.708 --> 00:23:32.811
instead. That does mouse and
keyboard. >> And so basically

00:23:32.811 --> 00:23:37.182
the way this works is we wrote
up a script that's a macro, a

00:23:37.182 --> 00:23:39.985
blind macro essentially. The
code is move to these

00:23:39.985 --> 00:23:41.987
coordinates, click, move to
these coordinates, right click,

00:23:41.987 --> 00:23:46.025
type in this stuff and
essentially created a macro that

00:23:46.025 --> 00:23:49.428
had no feed back from the
system. And when we're recording

00:23:49.428 --> 00:23:54.066
this video we ran the recording
software on the safe itself and

00:23:54.066 --> 00:23:58.671
it slowed everything down so
much that we had to rewrite the

00:23:58.671 --> 00:24:02.675
whole script because all the
timings were off at that point.

00:24:02.675 --> 00:24:07.413
So yes, this is essentially the
way the breakout works. Went

00:24:07.413 --> 00:24:12.151
into the tutorial section,
opened up the flash. >> Right

00:24:12.151 --> 00:24:15.788
click on that guy. Internet
explorer comes up. It's running

00:24:15.788 --> 00:24:18.490
real slow because it's trying to
run video through software like

00:24:18.490 --> 00:24:26.432
from the safe as well. >> So
then we opened up a new page and

00:24:26.432 --> 00:24:32.104
make it system 32 directory. And
from here, you know, open up

00:24:32.104 --> 00:24:34.106
[indiscernible] >> This is
awesome by the way. The TINSI

00:24:34.106 --> 00:24:38.544
doesn't have capability to store
files on it. If we have to run

00:24:38.544 --> 00:24:43.615
something we have to open up
note pad and type out a script

00:24:43.615 --> 00:24:51.357
in VB. That is what it's doing
now. >> The script basically

00:24:51.357 --> 00:24:54.727
creates the new users on the
database, it closes up all the

00:24:54.727 --> 00:24:57.363
applications that were running
that we used to break out of the

00:24:57.363 --> 00:25:01.834
kiosk mode and finally deletes
itself off the file system.

00:25:03.969 --> 00:25:07.639
Right after that's completed the
TINSI finishes the open, types

00:25:07.639 --> 00:25:10.943
in the passwords for the
accounts that we put in. >> The

00:25:10.943 --> 00:25:15.314
primary thing that all this is
doing is having the VD script

00:25:15.314 --> 00:25:18.217
that interfaces with the MS
access database and adds two new

00:25:18.217 --> 00:25:21.053
service accounts into the back
end of this. And all this is

00:25:21.053 --> 00:25:24.022
without us touching the safe.
It's plug in the TINSI, walk

00:25:24.022 --> 00:25:29.294
away. And 60 seconds later. >>
All the drivers for interfacing

00:25:29.294 --> 00:25:32.731
with MS access from VD is like
totally already enabled on the

00:25:32.731 --> 00:25:38.737
safe. So this is the door
opening. Those are the canisters

00:25:46.545 --> 00:25:52.551
that hold the money. >> So that
was the main exploit chain that

00:26:04.263 --> 00:26:07.266
we used. There are other things
that we had while looking

00:26:07.266 --> 00:26:14.406
through the system. So passwords
were stored. Patched in the

00:26:14.406 --> 00:26:18.777
database with another column
immediately beside it with a

00:26:18.777 --> 00:26:23.382
plain text credentials. >> That
was a really. I just have this

00:26:23.382 --> 00:26:26.985
mental picture in my head of the
developers writing the safe

00:26:26.985 --> 00:26:30.589
software and they have plain
text passwords in the database

00:26:30.589 --> 00:26:33.091
and the manager comes by and
says, like you can't do that,

00:26:33.091 --> 00:26:36.962
that's insecure. And so they're
like all right, hit new column,

00:26:36.962 --> 00:26:41.066
add half passwords and calls it
a day. Fixed that problem.

00:26:41.066 --> 00:26:45.304
Patched password is done. The
ones that are not terrible

00:26:45.304 --> 00:26:48.207
relevant to our exploit chain to
get access to it because all the

00:26:48.207 --> 00:26:50.476
credentials that are in there
that you would steal are like

00:26:50.476 --> 00:26:55.514
the store manager accounts and
like cashier accounts that don't

00:26:55.514 --> 00:26:58.183
have access to where the cash
is. >> The armored car guys do

00:26:58.183 --> 00:27:01.553
not have credentials stored in
these diabetics. They use their

00:27:01.553 --> 00:27:04.223
authentication keys. >>
Magnetic. >> So you would only

00:27:04.223 --> 00:27:11.763
have access to manager accounts
and that wouldn't open the safe.

00:27:11.763 --> 00:27:15.667
So also kind of turns out you
don't need a mouse, you can

00:27:15.667 --> 00:27:18.504
perform all this because it's a
touch screen after all. But

00:27:18.504 --> 00:27:22.341
right click is a click and hold
which I think is the feature of

00:27:22.341 --> 00:27:25.611
the touch display and not so
much a feature of the software

00:27:25.611 --> 00:27:28.981
itself? >> If you really wanted
to you can do the whole thing

00:27:28.981 --> 00:27:32.918
from the touch screen. Just go
to the flash and hold and press

00:27:32.918 --> 00:27:35.888
and pull up on an screen
keyboard. It would be horrible.

00:27:35.888 --> 00:27:38.724
We didn't ever bother to go
through that chain because it

00:27:38.724 --> 00:27:41.026
would take like a day or
something. I can imagine trying

00:27:41.026 --> 00:27:44.696
to automate that by putting some
device on top of the safe and

00:27:44.696 --> 00:27:46.932
press the buttons for it. It
would be horrible. >> It would

00:27:46.932 --> 00:27:51.036
be horrible. >> The USB port is
there to help streamline the

00:27:51.036 --> 00:27:58.043
entire exploit. >> So I think
Dan touched on this earlier. The

00:27:58.043 --> 00:28:04.850
way that the safe operates is
there is essentially a COM port

00:28:04.850 --> 00:28:10.656
that sends the open door command
to the solenoids or whatever

00:28:10.656 --> 00:28:17.262
connects to the safe doors. So
if you were to kind of use that

00:28:17.262 --> 00:28:20.399
instead, you could just have
easily hooked into the DLL and

00:28:20.399 --> 00:28:24.002
issued the open door command. >>
There is literally a DLL with an

00:28:24.002 --> 00:28:27.472
open door as a function. We
didn't even bother with it,

00:28:27.472 --> 00:28:30.909
didn't need to as it turned out.
The way we exploited it was by

00:28:30.909 --> 00:28:34.012
adding an account and logging in
ask using the application. But

00:28:34.012 --> 00:28:38.417
of course one could simply send
direct COM port traffic. That,

00:28:38.417 --> 00:28:41.753
like, implement your own comport
driver. That is cleaner perhaps

00:28:41.753 --> 00:28:47.993
as an exploit but it sounded
hard and we didn't feel like

00:28:47.993 --> 00:28:53.765
doing a hard thing. >> I guess
we kind of touched on this

00:28:53.765 --> 00:28:57.402
earlier as well. The internet of
things is this happening.

00:28:57.402 --> 00:28:59.404
They're smart devices or devices
that typically haven't been

00:28:59.404 --> 00:29:06.244
connected to the internet that
are in this rush to become smart

00:29:06.244 --> 00:29:10.182
get connected to the network,
get connected to your home, give

00:29:10.182 --> 00:29:14.319
you feedback. The idea is I
think we have to make this work

00:29:14.319 --> 00:29:17.389
as soon as possible, everyone is
doing this. We got to get this

00:29:17.389 --> 00:29:20.559
out before anybody else does? >>
To be perfectly fair that is the

00:29:20.559 --> 00:29:23.295
state of most large software
developing houses. Right.

00:29:23.295 --> 00:29:27.165
They're just barely struggling
to get things to work let alone

00:29:27.165 --> 00:29:31.436
getting them to work well and
let alone getting them to fail

00:29:31.436 --> 00:29:34.973
well. As like this moves forward
to every day household or

00:29:34.973 --> 00:29:37.676
business devices this is only
something we're going to see

00:29:37.676 --> 00:29:40.412
even more of. >> And a lot of it
is hardware companies moving

00:29:40.412 --> 00:29:43.782
into the space of software. They
typically have been working on

00:29:43.782 --> 00:29:47.052
these safes that have been
aren't for centuries around cars

00:29:47.052 --> 00:29:53.425
or a lightbulb or a toaster or
whatever that never had to have

00:29:53.425 --> 00:29:59.164
a development team and security
team. So as that starts to

00:29:59.164 --> 00:30:05.170
happen more and more, I think
that we'll be seeing a lot ...

00:30:09.041 --> 00:30:11.043
>> I think it's easy to be
flippant about it and think,

00:30:11.043 --> 00:30:13.779
come on, do we really need a
smart safe. Like the old

00:30:13.779 --> 00:30:16.615
mechanical ones were doing just
fine. That is kind of being a

00:30:16.615 --> 00:30:19.418
prude about it, right. This is
going to happen. This is the

00:30:19.418 --> 00:30:22.254
future whether you like it or
not. Right. So we as secure

00:30:22.254 --> 00:30:25.057
people can either help or not.
These smart devices were in a

00:30:25.057 --> 00:30:27.893
way like the promise that we as
technology people made to the

00:30:27.893 --> 00:30:30.929
rest of the world and we said
all this technology was going to

00:30:30.929 --> 00:30:33.298
transform like households and
devices in the world. This is

00:30:33.298 --> 00:30:36.101
partly what that means, right.
So let's not try to shut that

00:30:36.101 --> 00:30:38.937
down. Instead try to help these
devices out as we go forward

00:30:38.937 --> 00:30:41.640
into that world? >> I think
that's everything. >> That is

00:30:41.640 --> 00:30:45.343
about it. Thanks
...(applause)... >> I am told

00:30:45.343 --> 00:30:52.084
that we have a microphone that
we're going to do for questions.

00:30:52.084 --> 00:30:59.658
I don't know where that is. I
expect to see a goon frantically

00:30:59.658 --> 00:31:04.129
running around with a microphone
any minute now. Until that maybe

00:31:04.129 --> 00:31:06.498
I could just like repeat the
question. I saw a question here

00:31:06.498 --> 00:31:12.504
and I can repeat the question to
the crowd. >> Autorun. There's a

00:31:14.740 --> 00:31:18.543
difference between autorun and
autoplay as it turns out. The

00:31:18.543 --> 00:31:22.748
question is about USB autorun.
If you plug in like a USB device

00:31:22.748 --> 00:31:26.918
it will come up with a prompt
that is autoplay. What would you

00:31:26.918 --> 00:31:31.189
like to do with this device. It
doesn't do autorun which is run

00:31:31.189 --> 00:31:34.726
the first executable you see on
this CD. That would be really

00:31:34.726 --> 00:31:38.196
easy. That was the first thing
we tried. But no, that did not

00:31:38.196 --> 00:31:42.200
work unfortunately. The pop up
when it says what executable

00:31:42.200 --> 00:31:45.203
would you like to run on here,
that comes up behind the

00:31:45.203 --> 00:31:48.707
application. So you still need a
way to exit out of the full

00:31:48.707 --> 00:31:52.778
screen application or for that
to happen. Looks like we have a

00:31:52.778 --> 00:31:54.880
microphone. It's in the front
here if you want to ask a

00:31:54.880 --> 00:32:01.353
question. >> Hello my name is
Fred Smith and I was wondering

00:32:01.353 --> 00:32:06.091
if you had a written, if
everything you talked about in a

00:32:06.091 --> 00:32:09.861
written format or online that I
could access? Like this entire

00:32:09.861 --> 00:32:15.667
presentation, is it written down
somewhere that I could access?

00:32:15.667 --> 00:32:19.404
>> Oh the content of the
presentation? >> Yes. >> I think

00:32:19.404 --> 00:32:26.077
they've been writing it over
there. I'm sure it will be

00:32:26.077 --> 00:32:31.683
available on the DEFCON website.
>> I hope so. >> You mentioned

00:32:31.683 --> 00:32:34.786
the USB port on the back that
you said was hard to access

00:32:34.786 --> 00:32:38.056
because of the physical access.
Did you ever try your ITC board

00:32:38.056 --> 00:32:41.259
on that port to see if it would
work? >> Yes that one works as

00:32:41.259 --> 00:32:44.696
well. The rear USB port seems to
be powered a bit more. Like if I

00:32:44.696 --> 00:32:48.099
have a regular USB device lice a
concert keyboard, that works

00:32:48.099 --> 00:32:51.369
fine on the front port. If you
try giving it like an entire USB

00:32:51.369 --> 00:32:54.739
hard drive that sucks out more
power, the front port just

00:32:54.739 --> 00:32:57.876
doesn't work. I think the back
one has more power. They're

00:32:57.876 --> 00:33:00.312
otherwise completely hooked up.
>> Can you connect to the

00:33:00.312 --> 00:33:03.415
network ports to see what those
do? >> No. We never hooked it up

00:33:03.415 --> 00:33:08.854
to the network. At least the one
that we have sitting around the

00:33:08.854 --> 00:33:14.826
office. >> We saw a talk
yesterday where they used a twin

00:33:14.826 --> 00:33:18.296
duct, a rubber duck in twin duck
mode so you could amass storage

00:33:18.296 --> 00:33:22.901
and keyboard stuff. So basically
like you stick it in the laptop

00:33:22.901 --> 00:33:26.938
and set up a new wireless access
profile and all this crazy stuff

00:33:26.938 --> 00:33:28.940
on the machine. To basically
pull in the machine. Do you

00:33:28.940 --> 00:33:30.942
think that would have worked as
well for this. [indiscernible]

00:33:30.942 --> 00:33:34.713
clone. >> Yes. So once you
bypass the kiosk you're running

00:33:34.713 --> 00:33:40.252
as administrator. You can easily
think of a scenario where

00:33:40.252 --> 00:33:44.089
instead of having it immediately
open the safe, you up load a

00:33:44.089 --> 00:33:48.827
piece of software that will open
a door later or run any

00:33:48.827 --> 00:33:51.529
configuration files that you
want. >> For our purposes we

00:33:51.529 --> 00:33:53.531
just wanted to demonstrate
opening the door, so that was

00:33:53.531 --> 00:33:57.636
the first thing that we did. >>
Thanks. >> First of all thanks

00:33:57.636 --> 00:33:59.638
for an excellent presentation,
it looked like it was a lot of

00:33:59.638 --> 00:34:03.108
fun to tinker with. Did you, you
mentioned brink's safe. You

00:34:03.108 --> 00:34:05.210
mentioned another company along
the way, fire something that

00:34:05.210 --> 00:34:11.283
worked around and closed -- used
the exploit chain if you will by

00:34:11.283 --> 00:34:15.253
breaking internet explorer. You
demonstrated or alluded to there

00:34:15.253 --> 00:34:17.822
are several other avenues by
which you could compromise this

00:34:17.822 --> 00:34:22.193
ridiculously poorly designed
safe. Did they attempt to

00:34:22.193 --> 00:34:25.397
address the rest of the obvious
low-hanging fruit there. Are we

00:34:25.397 --> 00:34:28.066
going to see you next year doing
this talk again about how you

00:34:28.066 --> 00:34:33.872
loaded the DLL and called ... >>
You're definitely not going to

00:34:33.872 --> 00:34:36.975
see us next year. At least not
for this. Maybe something else.

00:34:36.975 --> 00:34:39.878
>> Next week? >> No, we -- we
worked with the vendors involved

00:34:39.878 --> 00:34:45.016
to try to get a fix for that
exact exploit chain. >> Ask

00:34:45.016 --> 00:34:50.121
they've been informed of the
other things and they're working

00:34:50.121 --> 00:34:55.927
on it. >> It's on their to-do
list somewhere. Eventually. >>

00:34:55.927 --> 00:34:58.697
Fun. >> Hi, you had mentioned
the possibility of like replan

00:34:58.697 --> 00:35:03.335
attacks over the COM port to the
safe. Do you look at that

00:35:03.335 --> 00:35:07.772
protocol and say is it the same
commands for all of the safes?

00:35:07.772 --> 00:35:10.976
Is there an actual key for each
one? Or a key for one do you

00:35:10.976 --> 00:35:14.646
break all of them? >> There is
-- we didn't -- we tried looking

00:35:14.646 --> 00:35:18.083
at the COM port traffic a bit
and I was crossing my fingers

00:35:18.083 --> 00:35:21.252
and hoping there would be a 4
byte message that said unlock,

00:35:21.252 --> 00:35:24.422
but it was not that easy. It was
back-and-forth protocol and it

00:35:24.422 --> 00:35:27.759
was hard. You have to look into
it basically. >> The COM port

00:35:27.759 --> 00:35:34.032
communication ends up being a
ping and like response. And like

00:35:34.032 --> 00:35:38.503
-- it's on a timer and there are
variables as well. It's

00:35:38.503 --> 00:35:41.272
something that presumably could
be done but we didn't really

00:35:41.272 --> 00:35:44.409
look into it. >> Presumably
there is not a key involved

00:35:44.409 --> 00:35:47.078
there or if there is, they're
the same. I don't really know.

00:35:47.078 --> 00:35:51.983
>> Thanks. >> I wasn't sure if I
heard it correctly. It sounded

00:35:51.983 --> 00:35:54.352
like in the beginning you
mentioned this thing having

00:35:54.352 --> 00:35:57.622
full-time network connectivity
and normal operation like cell

00:35:57.622 --> 00:36:00.759
data or anything like that or
just hardware? >> It's just hard

00:36:00.759 --> 00:36:03.928
wired. It's meant to talk back
to the bank, right, so it knows

00:36:03.928 --> 00:36:07.165
how much money you have at any
given time. As you deposit money

00:36:07.165 --> 00:36:10.502
into it the money is deposited
into your bank account. Because

00:36:10.502 --> 00:36:13.371
of that it's always connected.
>> Was there any evidence of

00:36:13.371 --> 00:36:16.808
support for other network
methods like cell modems, that

00:36:16.808 --> 00:36:21.279
sort of thing? >> No. Cell
phone. It's all wired. Like a

00:36:21.279 --> 00:36:24.883
phone Jack for old dial up as
well if you had that in your

00:36:24.883 --> 00:36:30.522
store. But I didn't see any
evidence of any cell phone or

00:36:30.522 --> 00:36:32.757
other ... >> A lot of point of
sale systems still run off phone

00:36:32.757 --> 00:36:34.759
Jack basically. So they have
that option. But primarily it's

00:36:34.759 --> 00:36:37.662
ethernet. >> Did you get the
impression that if the network

00:36:37.662 --> 00:36:40.298
connection was in place, it
would have reported your actions

00:36:40.298 --> 00:36:45.837
as you were functioning? >> Logs
and such are sent out over the

00:36:45.837 --> 00:36:47.906
network. They could
hypothetically. If you have

00:36:47.906 --> 00:36:50.842
complete control over the
operating system, you could

00:36:50.842 --> 00:36:55.146
modify that to not report you're
open open the safe, or not

00:36:55.146 --> 00:36:57.716
report opening the door. >>
You're running it as

00:36:57.716 --> 00:37:01.586
administrator, once you break
out of the kiosk mode that

00:37:01.586 --> 00:37:05.523
wouldn't be logged. And you
should shut down the network

00:37:05.523 --> 00:37:07.959
while you worked on whatever you
wanted to and then plug it back

00:37:07.959 --> 00:37:13.998
in afterwards if you wanted to.
>> Thanks. >> Hi, did the

00:37:13.998 --> 00:37:18.069
vendor, seems like the USB
facilitated everything. Did the

00:37:18.069 --> 00:37:20.739
vendor say there was a business
need for the USB port on the

00:37:20.739 --> 00:37:23.675
front? >> There is definitely
something to be said about

00:37:23.675 --> 00:37:26.344
usability versus security in
that respect. Because it's

00:37:26.344 --> 00:37:29.414
useful, right. Especially if
you're a service technician

00:37:29.414 --> 00:37:34.686
being able to have a mouse and
keyboard present there. And so

00:37:34.686 --> 00:37:38.123
there's also something that came
up a bunch is what happens with

00:37:38.123 --> 00:37:42.393
the hard drive crashing. Or like
what happens if the computer

00:37:42.393 --> 00:37:46.998
melts down and you're locked out
of your safe. Having like an

00:37:46.998 --> 00:37:50.468
external device that you can
reboot into the bios is handy.

00:37:50.468 --> 00:37:54.939
You can then recover from that
situation. So you kind of have a

00:37:54.939 --> 00:37:57.709
trade off between security and
usability there. Do you want to

00:37:57.709 --> 00:38:00.979
have a safe that fails open in
this sense, like if the hard

00:38:00.979 --> 00:38:04.149
drive fails you can still open
it anyway, or do you want a safe

00:38:04.149 --> 00:38:07.085
that fails closed. And that's
kind of the business decision to

00:38:07.085 --> 00:38:13.858
be made. >> Thank you. >> Since
the -- gives provisional credit

00:38:13.858 --> 00:38:16.961
to the financial institution,
can you see customer

00:38:16.961 --> 00:38:20.365
information, like account
numbers? >> I didn't hear that.

00:38:20.365 --> 00:38:24.068
>> When they put the money in
the safe the provisional credit

00:38:24.068 --> 00:38:27.772
transmits. >> Right. >> To the
bank. Could you see account

00:38:27.772 --> 00:38:30.575
numbers? >> Account numbers? I
don't remember. >> The customer

00:38:30.575 --> 00:38:34.612
account number. >> We didn't
look too much into the actual

00:38:34.612 --> 00:38:38.983
mechanism of how it like
specifically sends your money.

00:38:38.983 --> 00:38:42.921
Like they very well could be
some web server that says

00:38:42.921 --> 00:38:45.890
deposit this money into this
account and if you change the

00:38:45.890 --> 00:38:50.795
account bad things ... No idea.
That is pure speculation

00:38:50.795 --> 00:38:53.131
basically. I would assume that
it would have something baked

00:38:53.131 --> 00:38:56.434
into there. Like we would know
what account you are. It has to

00:38:56.434 --> 00:39:00.338
know what account you are? >>
What was the fix offered by the

00:39:00.338 --> 00:39:05.310
vendor? >> So they essentially
broke the attack chain by

00:39:05.310 --> 00:39:08.613
preventing internet explorer
from opening. So it's a

00:39:08.613 --> 00:39:12.050
blacklisted explorer. You go to
flash and right click and go

00:39:12.050 --> 00:39:16.321
about configuration wouldn't
pull up that portion and

00:39:16.321 --> 00:39:19.157
wouldn't have an escape out that
way. >> But would you still be

00:39:19.157 --> 00:39:21.793
able to do something with the
USB drive in that case or does

00:39:21.793 --> 00:39:25.730
that completely block it. >>
Yes. The same attacks where you

00:39:25.730 --> 00:39:31.636
plug in a USB and boot from it
and do that kind of attack would

00:39:31.636 --> 00:39:35.373
still be possible. But you have
to figure out how to reverse

00:39:35.373 --> 00:39:38.376
engineer the software first. >>
You could just reboot it with

00:39:38.376 --> 00:39:44.916
the red button, right? >> Yes.
You can reboot the device. Yes.

00:39:44.916 --> 00:39:47.986
>> You do need physical access,
right. >> Yes. That's true you

00:39:47.986 --> 00:39:49.988
need physical access to do the
entire hack but at the same time

00:39:49.988 --> 00:39:52.123
you need physical access to
actually carry away the cash. So

00:39:52.123 --> 00:39:58.796
like that's kind of required
anyway. >> I'm just saying if

00:39:58.796 --> 00:40:01.899
you can plug in the you saidyou
can also click that red button,

00:40:01.899 --> 00:40:05.436
right. >> Correct. There are
other fixes that would be able

00:40:05.436 --> 00:40:09.974
to help against a boot from USB
attack. Trying to put a password

00:40:09.974 --> 00:40:14.345
on a bios to lock down the bios.
Maybe encrypting the file

00:40:14.345 --> 00:40:17.682
system. A whole number of
things, right. >> That again

00:40:17.682 --> 00:40:21.919
plays into the usability of the
safe. Right. If everybody has to

00:40:21.919 --> 00:40:27.458
boot into bios and plug in a
keyboard and type in a password

00:40:27.458 --> 00:40:32.430
and all that stuff, then that
might be a reasonable solution.

00:40:32.430 --> 00:40:35.333
>> Since they're embedded
devices it's not necessarily

00:40:35.333 --> 00:40:39.871
easy to update the software as
well. >> Thank you. >>

00:40:39.871 --> 00:40:45.243
Especially at the bios level. >>
I see -- any other questions? >>

00:40:45.243 --> 00:40:49.247
So if you have like the USB
drive that can act as keyboard

00:40:49.247 --> 00:40:53.151
or a mouse or whatever, why do
you actually need to open

00:40:53.151 --> 00:40:57.989
internet explorer, why can't you
send commands as a keyboard and

00:40:57.989 --> 00:41:01.959
do it in the background without
any visible. >> There are some

00:41:01.959 --> 00:41:05.563
things on lock down. If you try
to hit alt/tab like it doesn't

00:41:05.563 --> 00:41:09.967
work. That is in the window's
registry as a keyboard. So going

00:41:09.967 --> 00:41:13.404
to internet explorer is a way of
escaping out of the kiosk sand

00:41:13.404 --> 00:41:16.474
box of the application. Their
application is just a regular

00:41:16.474 --> 00:41:19.277
windows program running in
full-screen mode. So there is no

00:41:19.277 --> 00:41:22.647
way to run arbitrary commands
just because there is no button

00:41:22.647 --> 00:41:25.316
to press to get there. The first
step in being able to run

00:41:25.316 --> 00:41:28.519
arbitrary commands is escaping
out of the sand box, pulling up

00:41:28.519 --> 00:41:32.390
internet explorer which then
runs regular explorer which runs

00:41:32.390 --> 00:41:36.561
a command prompt? >> If you try
to type commands, the

00:41:36.561 --> 00:41:39.697
application itself would
register all the typing so you

00:41:39.697 --> 00:41:43.868
can't run it in the background.
You can use the keyboard to like

00:41:43.868 --> 00:41:48.306
type many the user name and
password if you were to plug in

00:41:48.306 --> 00:41:51.242
the keyboard, that's how you
login as well. >> I assume you

00:41:51.242 --> 00:41:56.047
can do the run commands to
execute? >> Yes. You can't use

00:41:56.047 --> 00:42:00.351
the windows button, the windows
button is disabled as well. So

00:42:00.351 --> 00:42:05.156
you can't just hit the run
command. Yes. >> Do you guys

00:42:05.156 --> 00:42:09.560
have any plans on researching
how the one you guys deposited

00:42:09.560 --> 00:42:13.898
at the bank and what kind of
issues can happen with the -- >>

00:42:13.898 --> 00:42:17.602
I'm sorry can you repeat the
question. >> Do you have plans

00:42:17.602 --> 00:42:23.341
on researching how the money or
the cash gets deposited to the

00:42:23.341 --> 00:42:26.944
actual bank through the network?
I don't know if we're going to

00:42:26.944 --> 00:42:30.848
be doing too much additional
research on that. I think we'll

00:42:30.848 --> 00:42:33.918
probably be moving onto
something else pretty soon. But

00:42:33.918 --> 00:42:36.954
we're still working with the
vendors to address the rest of

00:42:36.954 --> 00:42:43.394
the issues. >> Because with
stealing the cash, there is only

00:42:43.394 --> 00:42:49.200
this much cash you can steal.
But if you can replay and keep

00:42:49.200 --> 00:42:54.138
adding money to the account. >>
Right. Are you saying if you

00:42:54.138 --> 00:42:58.876
were, were to essentially false
fie how much money was in the

00:42:58.876 --> 00:43:03.247
account? >> Right. >> Since you
have access add the

00:43:03.247 --> 00:43:06.284
administrator, you're able to
essentially get access to the

00:43:06.284 --> 00:43:11.923
operating system, the security
of the safe itself is at that

00:43:11.923 --> 00:43:16.027
point compromised. The security
is based on keeping you in the

00:43:16.027 --> 00:43:20.898
kiosk mode and so, yes. >>
Right. >> So if the hard drive

00:43:20.898 --> 00:43:25.403
isn't encrypted and you can boot
from USB, couldn't you just move

00:43:25.403 --> 00:43:30.675
to a wired registry and break
out of the same box? >> Yes, you

00:43:30.675 --> 00:43:34.779
can boot from Linux, like that
is something that is pretty

00:43:34.779 --> 00:43:38.182
straightforward. We thought
really hard about making a mine

00:43:38.182 --> 00:43:42.653
craft server that would run on
the safe or something like that.

00:43:42.653 --> 00:43:46.057
But the specks on it aren't good
enough. Certainly not a client.

00:43:46.057 --> 00:43:50.695
Maybe a server. You can run
arbitrary software, like boot

00:43:50.695 --> 00:43:53.431
from other device and run a
non-windows operating system.

00:43:53.431 --> 00:43:57.902
Even if the hard drive were
encrypted, clobber the hard

00:43:57.902 --> 00:44:01.639
drive with an entirely new
image. That's why things like

00:44:01.639 --> 00:44:06.344
this encryption you want
something like bios level

00:44:06.344 --> 00:44:11.716
password, on the bios. At that
point usually bios passwords are

00:44:11.716 --> 00:44:14.919
chuckled at because you remove
the Cmoss battery or something

00:44:14.919 --> 00:44:19.156
like that. In this situation the
computer is inside the safe, so

00:44:19.156 --> 00:44:25.263
you can't just do that. It would
be a reasonable defense. >>

00:44:25.263 --> 00:44:31.469
Cool. Thanks. >> Considering the
whole complicated solution, the

00:44:31.469 --> 00:44:36.407
safe, the manufacturer just
locking, wasn't it simple just

00:44:36.407 --> 00:44:41.412
to place all the innards just be
hind lock and key and that's it.

00:44:41.412 --> 00:44:43.414
Why not [indiscernible] just
lock it in. >> Again it boils

00:44:43.414 --> 00:44:49.420
down to usability it seems like.
Having access to an exposed USB

00:44:53.891 --> 00:44:56.661
port makes it easier for a
technician to come in and do

00:44:56.661 --> 00:45:00.064
their work. But they could have
just as easily had the

00:45:00.064 --> 00:45:02.400
technician remove the front
panel and plug it into the back

00:45:02.400 --> 00:45:07.171
USB or do something else. >> Or
give them just a key to which --

00:45:07.171 --> 00:45:12.643
[indiscernible] that's it. >>
Yes. >> Thank you. >> Real quick

00:45:12.643 --> 00:45:15.880
I'm hoping you sort of thought
this out in the fantasy world,

00:45:15.880 --> 00:45:20.318
what would be your fantasy of
real-world heist involving this

00:45:20.318 --> 00:45:24.555
capability and what if anything
can you extrapolate. >> We want

00:45:24.555 --> 00:45:30.928
to emphasize we're not trying to
like enable theft. We're

00:45:30.928 --> 00:45:36.167
providing the information for
pen testers. If you were a pen

00:45:36.167 --> 00:45:38.970
tester and you have one of these
safes I think it's abundantly

00:45:38.970 --> 00:45:44.542
clear how to reproduce our
findings to be able to do this

00:45:44.542 --> 00:45:48.779
on your own but like, going
through some actual, that

00:45:48.779 --> 00:45:54.418
scenario isn't something we want
to encourage. Okay. We're out of

00:45:54.418 --> 00:45:57.655
time. Thanks a lot.

