00:00:00.000 --> 00:00:05.072
Raise their right hand. And
point to people standing against

00:00:05.072 --> 00:00:12.145
the aisle. We appreciate
everybody accommodating all the

00:00:12.145 --> 00:00:18.151
changes and hope you are having
a good time so thank guys. >> So

00:00:26.994 --> 00:00:33.000
that thing over there is that
translating everything I said.

00:00:37.604 --> 00:00:43.610
Does it do naughty words at all?
Welcome. So wow. There are a lot

00:00:52.452 --> 00:00:58.458
of people. This is a lot bigger
than their first 101 track. Made

00:01:06.166 --> 00:01:12.172
me nervous. So I'm Dennis some
of you know me most you don't.

00:01:19.947 --> 00:01:25.953
So let's get right into it are
we really safe. Hacking access

00:01:32.926 --> 00:01:36.964
control systems so I will talk
about access control systems

00:01:36.964 --> 00:01:42.970
that matter to you guys you see
it up here and you see these in

00:01:51.545 --> 00:01:56.249
your apartments every where so
just let's drive in. I am

00:01:56.249 --> 00:02:00.887
security consultant and we do
security stuff. My job is to

00:02:00.887 --> 00:02:06.460
hack things. This is one of
those things. So you will hear a

00:02:06.460 --> 00:02:12.032
lot about what I have done in
the past year with my research

00:02:12.032 --> 00:02:18.438
of this and you can keep me up
in Twitter. I am also for those

00:02:18.438 --> 00:02:22.275
that are interested I am
cofounder of (indiscernible) my

00:02:22.275 --> 00:02:27.848
other cofounders are here with
me. We drink beers. I was told I

00:02:27.848 --> 00:02:33.854
was going to get heckled. And I
am. I am rebooting haw. So if

00:02:33.854 --> 00:02:41.762
you in the Houston area come
talk to me. I will talk about

00:02:41.762 --> 00:02:46.800
the what physical access control
is. Then I will talk about a

00:02:46.800 --> 00:02:51.872
specific vendor that I have been
doing research on and reason I

00:02:51.872 --> 00:02:56.943
will talk about this one vendor
because of time and money. This

00:02:56.943 --> 00:03:01.515
thing cost $1700 and I don't
have enough money to buy

00:03:01.515 --> 00:03:07.020
everyone out there and after we
talk about how they work we will

00:03:07.020 --> 00:03:12.492
talk attacks and local mode and
I have tool that I might release

00:03:12.492 --> 00:03:16.296
and then device and some
recommendations because I had

00:03:16.296 --> 00:03:20.767
to. So let's get started,
physical access control systems,

00:03:20.767 --> 00:03:25.172
so first what are they? They are
system was the purpose of

00:03:25.172 --> 00:03:29.509
limiting access to a physical
resource. They are outside many

00:03:29.509 --> 00:03:35.816
things that you guys have seen.
They secure areas by hooking up

00:03:35.816 --> 00:03:42.122
with (audio drop) door magnet or
door strike and use gates for

00:03:42.122 --> 00:03:46.326
apartment communities and
barrier arms for parking spaces.

00:03:46.326 --> 00:03:52.132
How do they work? You have many
different ways of authenticating

00:03:52.132 --> 00:03:58.972
a access control system, a lot
of you guys that do liven gated

00:03:58.972 --> 00:04:06.246
communities have a key file like
this and opens up a door and you

00:04:06.246 --> 00:04:14.154
can go to this key pad and use a
button. So I will talk about

00:04:14.154 --> 00:04:20.994
what the demo is. Here I have a
linear access controller and set

00:04:20.994 --> 00:04:27.300
up how it would be in a large
apartment complex. You see

00:04:27.300 --> 00:04:32.038
picture frames with lights
underneath and every time you

00:04:32.038 --> 00:04:38.879
see a picture frame light up
that means door two in this case

00:04:38.879 --> 00:04:44.417
or door three has opened so
imagine that. But you will never

00:04:44.417 --> 00:04:50.423
see door one open during my
mentation I blue up -- where are

00:04:55.729 --> 00:05:01.668
they used? They are used in
gated communities parking

00:05:15.048 --> 00:05:21.054
garages office buildings and
even used in commercial

00:05:32.232 --> 00:05:38.238
facilities. Walking in downtown
Austin I will see it guarding a

00:05:55.922 --> 00:06:03.597
post office or something so they
are pretty much every where. You

00:06:03.597 --> 00:06:09.603
can walk up to them. Here is
just some different things I

00:06:17.677 --> 00:06:20.480
have seen. So you may recognize
some of these. Lift master. I

00:06:20.480 --> 00:06:23.049
will go back -- now they are
calling themselves nor text

00:06:23.049 --> 00:06:26.319
control. So we will talk about
this one more in a bit. Here is

00:06:26.319 --> 00:06:29.322
some picture that I took walking
around you have a bunch of these

00:06:29.322 --> 00:06:32.359
mounted on the buildings. These
were I think this one was in a

00:06:32.359 --> 00:06:34.928
nursing home. You have one next
to elevator because they can

00:06:34.928 --> 00:06:36.930
control them. They can
authenticate whether somebody

00:06:36.930 --> 00:06:39.833
can be in a elevator. You see P
gray boxes and they are head

00:06:39.833 --> 00:06:42.636
list. They don't have key pads
or anything. They are used for

00:06:42.636 --> 00:06:44.638
expanding existing installation
or just installations that only

00:06:44.638 --> 00:06:46.640
require RFD readers. Doesn't
require key pad or anything.

00:06:46.640 --> 00:06:49.142
Here is what they look like
inside. Just without a keyboard

00:06:49.142 --> 00:06:51.945
without a big display. This is
pointed on the wall you will

00:06:51.945 --> 00:06:54.981
never guess where I found this
one. So I wanted to use the

00:06:54.981 --> 00:06:58.585
bathroom and very curious inside
that gray box. So I took a peek

00:06:58.585 --> 00:07:04.524
and access control. It was
protecting the doors for that

00:07:07.827 --> 00:07:12.899
building. That was pretty funny.
So let's talk about linear

00:07:12.899 --> 00:07:17.370
access control. The vendor
linear they have a few different

00:07:17.370 --> 00:07:22.008
models of commercial access
control systems. 8301000 and APP

00:07:22.008 --> 00:07:28.748
plus is that toilet one I showed
you. They are all pretty much

00:07:28.748 --> 00:07:34.954
the same way. The 1000 and 2000
has a bigger screen. Much

00:07:34.954 --> 00:07:40.627
bigger. That is only difference.
AM3 doesn't have a keyboard or

00:07:40.627 --> 00:07:46.833
anything but they all do the
same thing so anything we talk

00:07:46.833 --> 00:07:54.040
about is bone the apply to all
of those. So let's go deeper in

00:07:54.040 --> 00:08:00.180
this. So this controller is
pretty fancy. Has a lot of cool

00:08:00.180 --> 00:08:04.317
features and great for
installation and uses telephone

00:08:04.317 --> 00:08:11.658
line so one can go up there and
presses a director code. So it

00:08:11.658 --> 00:08:14.494
can also -- it supports
thousands of users so great for

00:08:14.494 --> 00:08:18.198
any big installation. So you can
these can only control four

00:08:18.198 --> 00:08:21.568
doors at a time. If you want
more doors you add more. And the

00:08:21.568 --> 00:08:27.574
best part they can be controlled
through a PC. Can be networked

00:08:32.846 --> 00:08:35.815
so apartment management in a
different state can manages

00:08:35.815 --> 00:08:41.354
these small communities so this
is kit. So these things -- they

00:08:41.354 --> 00:08:47.227
are require I will installed
just by themselves because they

00:08:47.227 --> 00:08:54.868
are pretty expensive. So to do
that they use this kit TCPI kit

00:08:54.868 --> 00:09:01.274
that turns the serial connection
into a connection and that will

00:09:01.274 --> 00:09:07.147
allow the management of
community to manages it from a

00:09:07.147 --> 00:09:13.620
computer whether it be on the
network locally or online. So

00:09:13.620 --> 00:09:20.693
that is example of company at
the different state. So let talk

00:09:20.693 --> 00:09:25.398
about architecture so the
controller here, 81 --> 000 blues

00:09:25.398 --> 00:09:30.670
interfaces through serial and
connects through a serial cable

00:09:30.670 --> 00:09:37.143
and convert connection which is
then plugged into a network and

00:09:37.143 --> 00:09:43.750
management PC can connect to it.
It is pretty much simple as

00:09:43.750 --> 00:09:50.156
that. To refer to that
controller you refer to specific

00:09:50.156 --> 00:09:55.728
IP port. This is default. So
here is the same diagram but

00:09:55.728 --> 00:10:01.734
this came from the documents o
the documentation does encourage

00:10:01.734 --> 00:10:07.740
that you hook that up to
internet device so that you can

00:10:11.978 --> 00:10:17.984
control this from the internet.
So that is pretty cool. Well

00:10:21.354 --> 00:10:27.360
pretty cool for some people. So
how does the computer

00:10:29.896 --> 00:10:37.570
communicate with the controller
they use the software access

00:10:37.570 --> 00:10:43.576
base 2000. It is pretty good
software. Any transmitted or

00:10:46.112 --> 00:10:52.519
things like this you can control
the controller or toggle the

00:10:52.519 --> 00:10:58.525
relays and open the doors
remotely or lock them to keep

00:11:01.794 --> 00:11:06.766
them closed and view log
reports. Or even opens the door

00:11:06.766 --> 00:11:11.337
right here the controller. It
logs all of it. It does

00:11:11.337 --> 00:11:17.343
communicate through serial but
when you have TCP converter then

00:11:23.483 --> 00:11:26.719
it is TCP connection in your
eyes and does require a

00:11:26.719 --> 00:11:30.823
password. I hope you can see
what you see here you see do you

00:11:30.823 --> 00:11:34.360
need to type in a password to
use the software to controller

00:11:34.360 --> 00:11:37.330
but pretty interesting because
the password is just six

00:11:37.330 --> 00:11:42.735
characters no less and no more
and numbers only. You can

00:11:42.735 --> 00:11:48.107
imagine the key space. 1 million
password that's it. May be a

00:11:48.107 --> 00:11:53.713
problem. Let's look into that.
We will look to that in the

00:11:53.713 --> 00:11:58.384
attacks. So how does it
communicate just how does it

00:11:58.384 --> 00:12:02.989
communicate with the controller.
So first when someone is using

00:12:02.989 --> 00:12:08.595
the soft wire in computer you
have someone senting a string to

00:12:08.595 --> 00:12:14.667
the controller whether it be a
string to open a door or request

00:12:14.667 --> 00:12:19.839
to logs or anything like that.
And the controller (audio drop)

00:12:19.839 --> 00:12:24.510
with another string and the
string is consistent and will

00:12:24.510 --> 00:12:28.248
acknowledge the channeled or
could be not acknowledged

00:12:28.248 --> 00:12:33.853
meaning the channel was a bad
command. This does use the check

00:12:33.853 --> 00:12:40.393
to ensure data -- so if message
is wrong it will spit back and

00:12:40.393 --> 00:12:45.531
do no response. If you didn't
prior put the correct password

00:12:45.531 --> 00:12:51.137
first you won't get a responser
at all so you are not

00:12:51.137 --> 00:12:55.842
authenticated. So let's break
down the message. This is hex

00:12:55.842 --> 00:13:01.381
encoded and sent to controller
so the first two bytes is going

00:13:01.381 --> 00:13:06.986
be packet header. The packet
header is also going to be A5

00:13:06.986 --> 00:13:13.059
and next header is -- data in
yellow so when you send a

00:13:13.059 --> 00:13:18.665
command the minimum length can
be zero and the next byte that

00:13:18.665 --> 00:13:25.672
could be in this case 0A and for
those that know hex that is 10

00:13:25.672 --> 00:13:32.712
in decimal so length of the data
can be 10 and then you have net

00:13:32.712 --> 00:13:39.585
node and so what that is that is
just identification number of

00:13:39.585 --> 00:13:43.289
the controller relative to any
other controller on network so

00:13:43.289 --> 00:13:48.061
it 11 in this case. Then you
have the command and this string

00:13:48.061 --> 00:13:54.867
is password command so this is
01 all bunch of others like

00:13:54.867 --> 00:14:00.206
pulling the logs pulling status,
doing a particular firmware

00:14:00.206 --> 00:14:06.846
update so bunch of different
channels which is 15. One of

00:14:06.846 --> 00:14:12.852
those numbers and the next -- in
this case six bytes this is data

00:14:15.254 --> 00:14:21.260
so like I said this is password
request so what I am doing I'm

00:14:23.696 --> 00:14:29.702
saying is 123,456 the password
that is 123,456 hex coded and

00:14:38.678 --> 00:14:44.684
then reversed and wants to
reverse the data so that

00:15:01.134 --> 00:15:07.140
translates to 123,456 the last
two checks integrity. And that

00:15:23.656 --> 00:15:29.662
checks from the beginning of net
node to end of data and if

00:15:49.949 --> 00:15:54.520
correct all systems go. So we
have talked about how this works

00:15:54.520 --> 00:15:58.124
you have good understanding.
Let's talk about attacks. How

00:15:58.124 --> 00:16:04.063
can we target these controllers.
They have number pads and

00:16:06.699 --> 00:16:12.071
displays and you walk up to them
at a gate community so you have

00:16:12.071 --> 00:16:15.942
physical access what happened
can you do with physical access

00:16:15.942 --> 00:16:20.546
like make local programs because
some of these things can below

00:16:20.546 --> 00:16:24.417
-- you can do local programming.
And a serial inside these

00:16:24.417 --> 00:16:28.654
devices so let's talk since we
have physical access so first

00:16:28.654 --> 00:16:33.292
this is 81 --> 000 right on this
desk and there AE500 and similar

00:16:33.292 --> 00:16:37.530
to these and only supports two
doors and done allow for

00:16:37.530 --> 00:16:40.199
computer configuration because
meant for much smaller

00:16:40.199 --> 00:16:44.437
installation. Meant for one or
two doors so you have those.

00:16:44.437 --> 00:16:48.708
Those have a default -- those
can be programmed locally from

00:16:48.708 --> 00:16:54.080
the key pad. So to great to that
part where you start typing the

00:16:54.080 --> 00:16:58.718
password you hold zero and two
and that will hold up the

00:16:58.718 --> 00:17:02.121
password prompt and in the
documentation this all available

00:17:02.121 --> 00:17:06.359
online but the default password
is 123,456 and who changes that.

00:17:06.359 --> 00:17:10.963
The lowest bid contractor they
are not going to care about the

00:17:10.963 --> 00:17:15.201
password they are going D leave
it like that and default

00:17:15.201 --> 00:17:19.839
password is 123,456 regard less
of what you entry code is. So

00:17:19.839 --> 00:17:24.477
try it and see what happens.
Pound is just to enter button.

00:17:24.477 --> 00:17:28.714
Press point and see it the
works. Once you're in because

00:17:28.714 --> 00:17:32.952
you're going to get in, input
the following commands you have

00:17:32.952 --> 00:17:37.957
all that string, and what that
does is input own back door and

00:17:37.957 --> 00:17:42.962
own entry code so when you walk
up to device and access granted

00:17:42.962 --> 00:17:47.600
so let's talk about what we just
did. (CLAPPING) We have more.

00:17:47.600 --> 00:17:51.837
123,456 just typed default
password and we are in. Three is

00:17:51.837 --> 00:17:56.075
password that is entry code
enter mode then 999 entry code

00:17:56.075 --> 00:18:01.013
and you can do whatever you
want. No one has that then you

00:18:01.013 --> 00:18:06.786
do it again 999 just to confirm
it because it wants you to do it

00:18:06.786 --> 00:18:11.424
twice and going back to normal
functionality and you are in. I

00:18:11.424 --> 00:18:16.829
forgot I did that. So what is
summary so I will show you how

00:18:16.829 --> 00:18:24.003
quick to do that. So you will
see how quick it is. This you go

00:18:24.003 --> 00:18:27.974
access granted. That is where
the applaud should come in.

00:18:27.974 --> 00:18:33.980
(CLAPPING) That was done in less
than 10 seconds so if I find one

00:18:40.086 --> 00:18:44.390
of these devises do my thing and
walk off and now I have full

00:18:44.390 --> 00:18:50.663
access because there is no way
that I found where you can list

00:18:50.663 --> 00:18:55.501
the entry codes. You just have
to if you just erase everything

00:18:55.501 --> 00:19:00.039
and start over. So what else can
be do. Master key. This is

00:19:00.039 --> 00:19:06.879
interesting. So I bought this my
company brought this for me and

00:19:06.879 --> 00:19:12.885
it came with a key and turns out
company I found this out I was

00:19:15.454 --> 00:19:21.293
flabbergasted same key for every
device. This 1000 plus you see

00:19:21.293 --> 00:19:27.299
here some of you have seen this
this one of most common ones

00:19:39.345 --> 00:19:46.619
that I have seen in the United
States the key that it came with

00:19:46.619 --> 00:19:50.990
like here. Works for this but
also works for all of my other

00:19:50.990 --> 00:19:54.126
apartments that I have may or
may not have tried. It works for

00:19:54.126 --> 00:19:58.831
someone that has never changed
the lot. The same one that was

00:19:58.831 --> 00:20:05.304
on the toilet works for that
too. May work for 8500 never

00:20:05.304 --> 00:20:12.611
tried it but why wasn't it so.
You can purchase them on E-bay.

00:20:12.611 --> 00:20:20.486
You could pay $1700 and get the
key but the AM3 blues find the

00:20:20.486 --> 00:20:27.226
enclose alone. It is a hundred
bucks and now you have access

00:20:27.226 --> 00:20:34.767
but buy the key you don't need
it. It is a fairly simple lock.

00:20:34.767 --> 00:20:40.773
And gives you full access to the
device so let's talk about that

00:20:43.109 --> 00:20:49.615
but first. For those that are
into key making keys (audio

00:20:49.615 --> 00:20:53.052
drop) they may or may not be the
bidding code. So PowerPoints

00:20:53.052 --> 00:20:58.157
will be online. Physical access,
so what does that get you. For

00:20:58.157 --> 00:21:04.096
you able to open up this device,
in this device 1000 there is

00:21:08.334 --> 00:21:14.340
relay latch. So when the relay
is triggered the door is open

00:21:16.408 --> 00:21:22.915
and if something is wrong, if
the software is not working main

00:21:22.915 --> 00:21:29.421
tension can open up it and leave
the gait manually open so there

00:21:29.421 --> 00:21:36.428
is buttons in there to open all
the doors so let me show you

00:21:36.428 --> 00:21:43.936
real quick. So if I were to open
this and I don't have a entry

00:21:43.936 --> 00:21:51.911
code or anything all I have to
do is open it and boom -- I am

00:21:51.911 --> 00:21:58.417
in and if I were mean and locked
this up everything stays open.

00:21:58.417 --> 00:22:04.356
Because all the button stay
locked open so that cool way of

00:22:04.356 --> 00:22:10.329
entering if you want to enter
with the key. Let's turn those

00:22:10.329 --> 00:22:13.933
off. So like I said you can lock
the states or leave the gate

00:22:13.933 --> 00:22:18.737
open and have that cool house
part but didn't want to break

00:22:18.737 --> 00:22:21.941
the lease. I mentioned relay one
exploded literally there is

00:22:21.941 --> 00:22:23.943
bunch f of suit around the
capacitors next the relay one.

00:22:23.943 --> 00:22:29.949
That was fun. I had to fan out
the house for that. What else

00:22:34.854 --> 00:22:41.660
does physical access get you.
Programming buttons. Other

00:22:41.660 --> 00:22:45.831
versus located somewhere else
you can program the device or if

00:22:45.831 --> 00:22:53.439
you want to be a Dick you can
erase the memory. There is

00:22:53.439 --> 00:22:58.143
active phone line for us -- find
the phone number and put it back

00:22:58.143 --> 00:23:02.548
and maybe you can call it or do
some pin testing and there is

00:23:02.548 --> 00:23:06.118
serial connection and all the
remote attacks that we're going

00:23:06.118 --> 00:23:11.891
to talk about work on serial
connection. So last thing I

00:23:11.891 --> 00:23:17.129
wanted to mention a monitor
switch a magneton the corner

00:23:17.129 --> 00:23:24.470
that will detect when the case
is open or closed so in the logs

00:23:24.470 --> 00:23:31.277
you will see tamper switched
open or closed so that is to see

00:23:31.277 --> 00:23:37.549
no one is messing with the
device but the problem is no

00:23:37.549 --> 00:23:43.555
active alerts and go to bunch of
these buttons and view a log o

00:23:45.924 --> 00:23:51.397
of someone opening and closing
it but no alert and you will

00:23:51.397 --> 00:23:54.466
never know it happened until
much later when you decide to

00:23:54.466 --> 00:24:00.039
download the -- really temper
monitoring. So for those that

00:24:00.039 --> 00:24:07.513
defuse a bomb competition next
door you can use a magnet to

00:24:07.513 --> 00:24:13.719
bypass this tamper switch. You
will see the screen tamper

00:24:13.719 --> 00:24:19.725
switch open and then closed so
what I will do is grab my

00:24:21.827 --> 00:24:27.833
magnets, put it there where it
is and be careful not to put it

00:24:30.569 --> 00:24:36.575
in is wrong place and I open it
and when I open it you will see

00:24:40.512 --> 00:24:47.386
nothing logs you will see the
two existing log entries from

00:24:47.386 --> 00:24:52.991
earlier but nothing new. So
tamper switch avoided. We're

00:24:52.991 --> 00:24:59.498
going to need more of that time
so we talked about physical

00:24:59.498 --> 00:25:03.602
access so what the next. The fun
stuff. Remote access. Can be

00:25:03.602 --> 00:25:08.841
done dependent on the
configuration so say you have

00:25:08.841 --> 00:25:15.214
leasing off and someone is
looking for a new apartment so

00:25:15.214 --> 00:25:21.620
you plug in behind their desk
and then you have external

00:25:21.620 --> 00:25:26.859
access and some people have it
available on internet.

00:25:26.859 --> 00:25:32.664
Everything works over IP and
usually default port. Can be

00:25:32.664 --> 00:25:39.071
changed but who does. So let's
talk about remote attacks. Let

00:25:39.071 --> 00:25:46.612
me show you the software. Let's
see if this works. You have this

00:25:46.612 --> 00:25:52.050
software here and you press this
little button and you connect

00:25:52.050 --> 00:25:57.823
and you get the message wrong
password so we don't have the

00:25:57.823 --> 00:26:03.762
password to authenticate so how
can by the fix this. Like our I

00:26:07.366 --> 00:26:14.973
told you guys earlier, six
character numbers only, tiny key

00:26:14.973 --> 00:26:19.378
space so 1 million password so
you only limited by the

00:26:19.378 --> 00:26:24.683
connection speed so you can
guess as much as you want. And

00:26:24.683 --> 00:26:30.289
this is script able so this is
the backbone is all serial you

00:26:30.289 --> 00:26:32.991
can script all of this you don't
have the touch the application.

00:26:32.991 --> 00:26:38.997
So let me show you that. So we
don't have password here but I

00:26:42.000 --> 00:26:47.172
write a python script. So what
you see now is brute forcing and

00:26:47.172 --> 00:26:51.276
giving the common codes and if
it doesn't find it will it rate

00:26:51.276 --> 00:26:57.282
you are seeing more than once on
the same password, if doesn't

00:26:59.952 --> 00:27:06.825
get a proper response just keeps
guessing it serial response is

00:27:06.825 --> 00:27:12.831
not very reliable and that is
why. Master code. 00 --> 051. So it

00:27:18.837 --> 00:27:26.445
found it and we are done. I am
connected now. All four doors

00:27:26.445 --> 00:27:32.451
are open. I will show you here
and I just downloaded the logs

00:27:53.238 --> 00:27:59.244
and so you see these are the
logs that I just downloaded

00:28:06.351 --> 00:28:11.590
certain people have access. So I
just wanted to show you guys.

00:28:11.590 --> 00:28:17.696
What is cool so we have the
password but did we need it a

00:28:17.696 --> 00:28:22.034
parentally not. So normal way
you have to authenticate first.

00:28:22.034 --> 00:28:27.706
Is when I sent this device a
command I would not get a

00:28:27.706 --> 00:28:31.610
response but turns out it will
just run the command anyway. It

00:28:31.610 --> 00:28:35.480
will not tell me it did it so I
will not get think response but

00:28:35.480 --> 00:28:40.485
it will still work so any
command or most channels work

00:28:40.485 --> 00:28:45.824
that way so what can we do that.
We can send a simple command

00:28:45.824 --> 00:28:51.830
that is opens a specific relay
and sent it over and it

00:28:54.166 --> 00:28:56.602
processes that command and
executes whatever it is sum

00:28:56.602 --> 00:29:02.040
posed to do. So still good. And
it great for movie style scenes.

00:29:02.040 --> 00:29:09.014
Say you have a hacker in the van
so when the hacker is ready

00:29:09.014 --> 00:29:14.019
presses something on the
computer and opens up the door

00:29:14.019 --> 00:29:18.490
and everyone goes and steels the
declaration of independence.

00:29:18.490 --> 00:29:25.464
Great for scenes like that. So
that is what we can do there. We

00:29:25.464 --> 00:29:31.937
can lock doors open and close.
And that will keep the doors or

00:29:31.937 --> 00:29:38.910
gates open if u wanted to have
the house party or closed if I

00:29:38.910 --> 00:29:45.450
want to prevent from anyone from
getting in so that will once the

00:29:45.450 --> 00:29:49.021
rely is locked in a specific
state it will not respond to any

00:29:49.021 --> 00:29:55.394
key fobs or any legitimate
access after that until I unlock

00:29:55.394 --> 00:30:01.400
it or the device reboots. Those
fancy logs you can delete all of

00:30:38.904 --> 00:30:43.675
them. Because the controller has
limited space when they are

00:30:43.675 --> 00:30:47.779
downloaded they are deleted from
the controller. We have hidden

00:30:47.779 --> 00:30:52.718
the evidence of us doing
anything. If you so want to use

00:30:52.718 --> 00:30:57.255
the access space 2000 software
you change the password you can

00:30:57.255 --> 00:31:02.527
submit it data base update and
it will just say okay and it

00:31:02.527 --> 00:31:07.866
will change the password back to
default and now we can get in

00:31:07.866 --> 00:31:12.804
with the default password. You
can up load anything. You can up

00:31:12.804 --> 00:31:17.342
load directory codes any back
door you want. So pretty much

00:31:17.342 --> 00:31:22.681
that and then the last thing I
would like to talk about service

00:31:22.681 --> 00:31:29.287
which you can if you want to be
a dick about it when you get a

00:31:29.287 --> 00:31:35.026
data base update -- it will just
keep flashing and when it is in

00:31:35.026 --> 00:31:40.398
progress it locks itself. And
the only way to fix that is to

00:31:40.398 --> 00:31:45.337
stop the data base update and
there is commando stop or just

00:31:45.337 --> 00:31:49.441
reboot the device. You can
override the device firmware. Be

00:31:49.441 --> 00:31:55.213
a dick and make it use less to
everyone or like we talked about

00:31:55.213 --> 00:32:00.485
earlier you lock the relays or
keep the door shut so that no

00:32:00.485 --> 00:32:05.023
one can get in. All those
attacks that we talked about

00:32:05.023 --> 00:32:10.362
what I have done is I have
developed a simple tool to show

00:32:10.362 --> 00:32:15.300
these attacks so I called it
access control. But neat I can

00:32:15.300 --> 00:32:20.639
say you guy go download a cat
off of the internet. Let's show

00:32:20.639 --> 00:32:25.043
off this tool. I have this
python scripts and works on

00:32:25.043 --> 00:32:29.714
windows and Linux. 10 You can go
through IP address so let's do

00:32:29.714 --> 00:32:34.252
that. So here is my tool you
just type whatever you want and

00:32:34.252 --> 00:32:40.258
have a bunch of options here so
try toe trigger relay and this

00:32:45.530 --> 00:32:51.536
will trigger two seconds by
default and so let's open all of

00:32:55.974 --> 00:33:01.480
them. One, three, four and so
this python script opens all

00:33:01.480 --> 00:33:07.485
four doors and thought was sent.
I walked up to my lab top and

00:33:10.889 --> 00:33:16.895
sent these. So relies are now
open and another thing you can

00:33:19.531 --> 00:33:25.537
do is lock them open. So all
four are locked. So let's lock

00:33:28.874 --> 00:33:34.880
two closed. So two is now locked
close and if I try to use the

00:33:39.651 --> 00:33:46.825
normal transmitter. Nothing
happens. No one can get in with

00:33:46.825 --> 00:33:52.831
relay two or any of relays so
let's unlock them again. It

00:33:55.467 --> 00:34:01.406
works again. So that is a cool
thing. So this is the one that

00:34:05.443 --> 00:34:13.351
sometimes doesn't work but we
will hope it works so everything

00:34:13.351 --> 00:34:19.925
we just did was python script or
transmitter that I am holding or

00:34:19.925 --> 00:34:25.230
opening and closing that and it
is being logged in the internal

00:34:25.230 --> 00:34:31.102
memory. So what I will do is
start a download and what the

00:34:31.102 --> 00:34:37.008
going to do download the logs
but going to be deleted from the

00:34:37.008 --> 00:34:42.881
controller so it trying to see
if it gets any feedback back so

00:34:42.881 --> 00:34:46.051
let's exit here and let's see if
that works so I'm going to go

00:34:46.051 --> 00:34:51.723
here and connect and this use
down of logs. Through show a

00:34:51.723 --> 00:34:54.926
dialogue box. Six, so it worked.
But what I did notice is when

00:34:54.926 --> 00:35:02.067
this device has been rebooted
and I did do that earlier there

00:35:02.067 --> 00:35:09.240
are six log entries that never
get deleted for some reason so

00:35:09.240 --> 00:35:15.246
just take my word for it that it
worked and you can applaud for

00:35:17.649 --> 00:35:23.655
that too. So if you did look at
log you would not see access

00:35:26.057 --> 00:35:33.264
granted stuff. So let's connect
back. So the next thing you can

00:35:33.264 --> 00:35:39.204
do is let's do up load - so we
connect to this with password of

00:35:39.204 --> 00:35:46.444
0 --> 000 --> 051. I am being attacked.
I guess we are good. So we are

00:35:46.444 --> 00:35:51.549
connecting with brute force
earlier. So let's go back to

00:35:51.549 --> 00:35:57.656
default password. So I up loaded
default password to device so if

00:35:57.656 --> 00:36:02.627
icon they believe with existing
password it should fail. Wrong

00:36:02.627 --> 00:36:06.765
password there you go so let's
go back to using default

00:36:06.765 --> 00:36:12.771
password. How's it going. Excuse
me. Okay have fun. >> So you are

00:36:30.622 --> 00:36:36.628
giving me your computer that is
awesome. So you want -- I'm sure

00:36:43.401 --> 00:36:48.673
you something happened. You all
know how this works. How is he

00:36:48.673 --> 00:36:54.679
doing as a new speaker?
(CLAPPING). Are you hung over?

00:36:58.016 --> 00:37:03.955
Nope. You will be. (laughter).
Lost audio. You're giving me

00:37:08.326 --> 00:37:14.332
that. Has to be something better
than that. After you drink that

00:37:20.772 --> 00:37:26.778
I will be back with something
better. >> To Def Con and new

00:37:34.252 --> 00:37:40.258
speakers. Clap. You still want
that next one. Thank you very

00:37:45.630 --> 00:37:51.636
much. I'm not used to that I
don't do shots so that is

00:37:54.606 --> 00:37:58.943
burning my insides. Speak of
burning my insides, download

00:37:58.943 --> 00:38:05.517
service. Thank you very much.
I'm going the ride this out. The

00:38:05.517 --> 00:38:13.258
last thing I want to show you
that the tool can do you have

00:38:13.258 --> 00:38:17.562
functionality -- I something
just broke but this one lights

00:38:17.562 --> 00:38:23.568
up so people that are going into
the gate -- controller has been

00:38:28.740 --> 00:38:35.013
lost. So I will take your word
for it but what wrote see on the

00:38:35.013 --> 00:38:40.351
screen should show data base
progress. Not working. Let try

00:38:40.351 --> 00:38:46.357
again. DOS no longer works. In
the same script you can stop it

00:38:49.994 --> 00:38:56.000
and everything is back the
normal so that is pretty much

00:39:03.808 --> 00:39:07.545
the extent of my tool. I will
give you one more try. So still

00:39:07.545 --> 00:39:13.551
doesn't work. It is getting hot
in here. Okay. So now that we

00:39:27.799 --> 00:39:31.736
have talked about attacking
these controllers, let's talk

00:39:31.736 --> 00:39:36.341
about locating these. How do we
find these? One thing you can do

00:39:36.341 --> 00:39:42.947
is scan these on the network.
Look for any COM port

00:39:42.947 --> 00:39:48.353
re-directors. There is specific
one that the brand linear.

00:39:48.353 --> 00:39:56.194
Anyone will work so you scan the
network and you send UDP pod

00:39:56.194 --> 00:40:03.401
cast and if I devices on the
network it will respond. So

00:40:03.401 --> 00:40:10.608
attacker can sent UDP pod cast
and with that specific port and

00:40:10.608 --> 00:40:18.416
the -- and go back to person
started that pod cast so that

00:40:18.416 --> 00:40:25.623
how you identify any of devices
on the network and once you

00:40:25.623 --> 00:40:32.964
found it you can send a password
request string so regardless if

00:40:32.964 --> 00:40:36.434
you authenticated it or not you
will get a response back whether

00:40:36.434 --> 00:40:41.940
a password you tried to guess is
valid or in valid and if linear

00:40:41.940 --> 00:40:48.646
box it will respond back whether
it a valid or in valid password.

00:40:48.646 --> 00:40:54.852
So you sent it something and it
responds back. So let's demo

00:40:54.852 --> 00:41:00.992
another tools what this will do
a sent a broadcast packet and

00:41:00.992 --> 00:41:07.031
listen for any responses and it
will find them. If it finds

00:41:07.031 --> 00:41:10.101
response it will take it step
further and send a password

00:41:10.101 --> 00:41:16.974
request and check if it is
linear controller. So did find a

00:41:16.974 --> 00:41:22.980
device. And will make sure it is
linear and hundred percent

00:41:25.350 --> 00:41:31.356
confirmed that it linear and if
you see the as risk it is using

00:41:35.960 --> 00:41:40.331
the default password. So that is
what that tool does and that may

00:41:40.331 --> 00:41:46.104
get released. So cool. We talked
about all the fun stuff now we

00:41:46.104 --> 00:41:50.541
have go to this stuff.
Recommendations, so I'm not

00:41:50.541 --> 00:41:56.748
really going to talk about how
the specific vendor can fix

00:41:56.748 --> 00:42:01.786
these issues I will talk how you
for a example a apartment

00:42:01.786 --> 00:42:09.293
manager can fix these. Change
the password. I would love the

00:42:09.293 --> 00:42:15.299
say use a complex password but
that doesn't exist. Wow it is

00:42:17.468 --> 00:42:24.475
really fighting back and I can't
burp for some reason. So change

00:42:24.475 --> 00:42:29.714
physical locks. The master key
works so change the lock. You

00:42:29.714 --> 00:42:36.421
have ability to change. You
don't want the manager next door

00:42:36.421 --> 00:42:44.262
having the same access to your
apartment as he does their

00:42:44.262 --> 00:42:50.268
apartment so change the locks
and another thing you can do is

00:42:52.804 --> 00:43:00.578
use a direct serial connection.
Instead of having this on the

00:43:00.578 --> 00:43:06.284
network connection these
vulnerables are not done. Do

00:43:06.284 --> 00:43:14.125
allow for authentication no one
every uses it is not intuitive

00:43:14.125 --> 00:43:20.131
to use but learn how to use it
and use that authentication so

00:43:22.967 --> 00:43:27.572
not anyone can connect the IP
address of the device and resist

00:43:27.572 --> 00:43:33.311
the urge to connect to internet
like don't have it online just

00:43:33.311 --> 00:43:38.583
don't forward the port and like
anything keep it off the

00:43:38.583 --> 00:43:42.753
internet unless it really need
to be. Final thoughts so I

00:43:42.753 --> 00:43:48.926
didn't write this talk to crap
allover one vender. There is 1I

00:43:48.926 --> 00:43:55.900
had time and money to invest
research in but I wanted to open

00:43:55.900 --> 00:44:00.471
the door and open people's eye
to find that if all these issue

00:44:00.471 --> 00:44:05.109
exist on one vendor they will
exist on other vendors. So be

00:44:05.109 --> 00:44:08.779
caution out there and I will do
some more research on this so I

00:44:08.779 --> 00:44:14.785
do plan on doing more research
on this device and others when

00:44:19.357 --> 00:44:25.363
every I can get my hands on this
thing. So these are prototype

00:44:30.334 --> 00:44:36.874
tools. More work is needed. One
has already failed. But tool is

00:44:36.874 --> 00:44:40.611
a already up loaden a located on
gate hub and open source

00:44:40.611 --> 00:44:46.984
whatever license I will put some
open source license to it. It is

00:44:46.984 --> 00:44:49.954
called access control attack
tool and I do intent on

00:44:49.954 --> 00:44:55.393
furthering it to do with other
controllers as well so feel free

00:44:55.393 --> 00:45:03.134
to mess with it and I need over
hall it. So if but want to help

00:45:03.134 --> 00:45:09.140
me with that that great. I want
to work on M map script and that

00:45:15.446 --> 00:45:22.253
is get for red team assessment.
And last but not least the

00:45:22.253 --> 00:45:24.855
slides are on slide share and
have you can download the full

00:45:24.855 --> 00:45:27.325
version you will have to
download to slide share to

00:45:27.325 --> 00:45:34.899
videos but it is all there. So
that is all I have. Any

00:45:34.899 --> 00:45:40.905
questions? In the physical
location. So you see it. >>

00:45:46.744 --> 00:45:53.517
(inaudible). >> So most of time
unless they are configured

00:45:53.517 --> 00:45:59.523
properly you will not be able to
tell where it is people up load

00:46:02.927 --> 00:46:08.532
this device a named this but
that is sometimes not case and

00:46:08.532 --> 00:46:12.503
another thing you can do those
director there is specific UDP

00:46:12.503 --> 00:46:18.409
packet and what that will do if
you can see the device somewhere

00:46:18.409 --> 00:46:24.382
it be beep so you can locate it.
So you I doing want to talk

00:46:24.382 --> 00:46:30.655
about it but what's one way to
find it. Other than that you

00:46:30.655 --> 00:46:35.926
screwed from there. One more
question because I only have one

00:46:35.926 --> 00:46:42.199
minute then you can talk to me
later. CT FR read the fucking

00:46:42.199 --> 00:46:47.038
manual. I was hooking up is test
light and I didn't read the

00:46:47.038 --> 00:46:53.044
manual so rely was for 30-volts
not 120. (CLAPPING) You can hit

00:46:59.250 --> 00:47:05.189
me up on Twitter or e-mail me or
find me at Def Con. Thank you.

