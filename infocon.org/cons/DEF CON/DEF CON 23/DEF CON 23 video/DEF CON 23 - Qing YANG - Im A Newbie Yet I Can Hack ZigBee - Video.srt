00:00:00.167 --> 00:00:05.839
>> So today, I will introduce
you guys that how to hack video

00:00:05.839 --> 00:00:11.845
device and it seems you guys are
tired so I make this quick,

00:00:16.817 --> 00:00:22.823
yeah. >>And, uh, yeah in the
speaker room, somebody invited

00:00:25.325 --> 00:00:31.331
me to drink beer, so Im a
little bit high. 	Yeah.

00:00:34.668 --> 00:00:40.674
	(Applause). 	So I'm from the
UNICORN team, 3 topics in this

00:00:44.011 --> 00:00:49.883
DEF CON, so. 	And okay. 	So,
Unicorn Team, and focus hardware

00:00:49.883 --> 00:00:55.889
and success of security and
research. 	We contain a lot of

00:00:58.325 --> 00:01:03.797
Peruvian peoples, we focus on
anything that uses radio,

00:01:03.797 --> 00:01:08.168
technologies and from any small
things like tablets, something

00:01:08.168 --> 00:01:14.174
like that. GPS, use the
research, we hack it, we let

00:01:16.209 --> 00:01:21.882
them land in the you know page,
such as audio ware in

00:01:21.882 --> 00:01:27.888
America, the White House. We do
our research and we make a lot

00:01:30.090 --> 00:01:35.629
of products and, [indiscernible]
and actually -- [indiscernible]

00:01:35.629 --> 00:01:41.635
maybe you can buy it as well.
And I have this speck. 	And what

00:01:46.406 --> 00:01:51.178
is this, why this is talk
relevant relevant to you.

00:01:51.178 --> 00:01:57.417
	Maybe you guys are hackers and,
might be able to, control these

00:01:57.417 --> 00:02:02.723
devices and without
authorization and this talk,

00:02:02.723 --> 00:02:06.727
will teach you how to package
it. Such as your your smoke

00:02:06.727 --> 00:02:12.733
sensor, your HIV test system,
well if you can choose them, not

00:02:16.236 --> 00:02:23.577
yours, well you can do
everything. 	What is Zigbee?

00:02:23.577 --> 00:02:28.081
Zigbee is the only global
wireless standard that provides

00:02:28.081 --> 00:02:35.489
the foundation of Internet of
Things. 	By, embedding a simple

00:02:35.489 --> 00:02:39.326
and smart object to work
together, maybe you, prove the

00:02:39.326 --> 00:02:44.564
comfort and efficiency of the
test. Maybe you guys use some

00:02:44.564 --> 00:02:48.935
IOT devices and if you dissemble
it and you find oh, this is

00:02:48.935 --> 00:02:56.476
[indiscernible]. 	So its just
a word is language I read that

00:02:56.476 --> 00:03:01.181
device used to connect one from
another. And they connect the

00:03:01.181 --> 00:03:05.452
person will be able to work from
you home right now. So maybe

00:03:05.452 --> 00:03:12.459
someone buy a smoker alert, well
it if disassembles it, you might

00:03:12.459 --> 00:03:19.633
buy another one. 	Blah, blah,
blah. 	[Laughter] 	I was told

00:03:19.633 --> 00:03:24.337
that maybe you guys, that
somebody don't know Zigbee

00:03:24.337 --> 00:03:32.212
design so I introduce it. Zigbee
is already using Internet of

00:03:32.212 --> 00:03:35.415
Things, and adapted
[indiscernible], and it requires

00:03:35.415 --> 00:03:41.421
low power computer consuming
machine. It will flex fold and

00:03:45.325 --> 00:03:50.797
typology. 	And, so this is,
Zigbees networker. You can

00:03:50.797 --> 00:03:55.035
stray, you can mash, you can
[indiscernible]. 	It's very

00:03:55.035 --> 00:03:59.940
different. [Indiscernible] to
each letter. 	So, the most

00:03:59.940 --> 00:04:04.711
important thing in Zigbee is
this talk. What is this? Its

00:04:04.711 --> 00:04:09.082
the specification of the
implement of Zigbee. Start from

00:04:09.082 --> 00:04:15.088
the Texas instructamentor.
	2530, yeah. 	Point 15 and point

00:04:22.696 --> 00:04:27.267
4 in baggage chip. Well in other
words Zigbee standard is right

00:04:27.267 --> 00:04:33.273
-- this stack is writing code.
	So here is chip and you can buy

00:04:37.043 --> 00:04:42.782
it on the Texas instructament.
Well you can actually get it

00:04:42.782 --> 00:04:48.788
free online. 	So, actually, a
lot of people research security

00:04:53.793 --> 00:05:00.667
program in Zigbee have done a
lot of things. Zigbee is

00:05:00.667 --> 00:05:04.871
[indiscernible]. 	Thank you,
Zigbee security, is best on

00:05:04.871 --> 00:05:10.977
smash security, [indiscernible]
and the recipient of

00:05:10.977 --> 00:05:17.851
[indiscernible] through a stem
key.. a stem pool key, its

00:05:17.851 --> 00:05:23.857
changing so, if you're want to
know more details, download the

00:05:26.259 --> 00:05:32.265
documents and do research on it.
	So, the key distribution thing.

00:05:34.668 --> 00:05:41.541
	You can pre install it,
transport it, you can

00:05:41.541 --> 00:05:45.345
establishment. 	There are 3 key
types. The Master Key, The

00:05:45.345 --> 00:05:50.283
Linder Key, and The Literal Key.
	So, hacking Zigbee

00:05:50.283 --> 00:05:55.355
step-by-step, here is what I
want to say. What I want to

00:05:55.355 --> 00:06:01.628
teach you guys. 	And, you know
here is the map that how Zigbee

00:06:01.628 --> 00:06:07.634
transfer the information from
one to one. I think they so,

00:06:10.337 --> 00:06:16.843
share with them the think
process, the polling it

00:06:16.843 --> 00:06:22.849
background, yeah. A smart system
that that's one of better

00:06:25.619 --> 00:06:31.625
qualities. [Indiscernible] 	We
bought it from the Internet.

00:06:34.661 --> 00:06:42.202
	Here is step 3. No more
[indiscernible] flows. 	Phone

00:06:42.202 --> 00:06:46.906
connect with IOT get away. And
the connector will flow. Or your

00:06:46.906 --> 00:06:51.244
phone will connect with the
wireless router and the router

00:06:51.244 --> 00:06:56.182
will connect with the IOT away.
	And connecter both. 	And,

00:06:56.182 --> 00:07:02.122
phone, 4 G, 3 G or 2 G, the
Internet, connects to server

00:07:07.594 --> 00:07:13.600
and, connects wireless router
and connects to IOG away. 	So,

00:07:18.705 --> 00:07:24.711
what do we want, is directly
choose our own Zigbee note,

00:07:27.647 --> 00:07:32.619
Zigbee note and choose the
phone. 	That's how we hack it

00:07:32.619 --> 00:07:39.893
(losing sound). 	So, the whole
translation is encrypted. 	What

00:07:39.893 --> 00:07:47.200
do we do to try to find
encryption key from the phone.

00:07:47.200 --> 00:07:54.207
If you want to find it. 	The
first thing you do is download

00:07:54.207 --> 00:07:56.209
the firmware the key are stored
in every node in the network.

00:07:56.209 --> 00:07:58.211
	The firm is harder to assemble,
so we chose to straggler key

00:07:58.211 --> 00:08:00.146
from the get away. 	So, the I
try to disassemble, actually, I

00:08:00.146 --> 00:08:06.152
find out -- well, so I use a
hand to smash it, WOW, this is

00:08:16.363 --> 00:08:22.369
shit, it doesn't work, its
broken. 	Before I smash it,

00:08:31.544 --> 00:08:37.550
yeah, I tried to disassemble the
get away. 	So we dissemble the

00:08:44.891 --> 00:08:50.897
get away, and try to find, we
try to dump the firmware. Okay.

00:08:53.666 --> 00:08:58.171
[Indiscernible] the debugging
test is right there, so you

00:08:58.171 --> 00:09:01.975
know, [indiscernible] were
connecting our debugger, and we

00:09:01.975 --> 00:09:04.210
use a GI smart I, a fresh
program to do the dump of the

00:09:04.210 --> 00:09:10.984
firmware. 	So if you guys want
to dump some firmware from your

00:09:10.984 --> 00:09:16.990
device. 	Well, this is
necessary. 	Okay, here is screen

00:09:21.161 --> 00:09:28.835
shot of it. 	And programmer
software. 	Well, we got it from

00:09:28.835 --> 00:09:33.540
here, it's a lot of minutes to
stand, so what should we do

00:09:33.540 --> 00:09:38.912
so, if you just trying to find
encrypted key, what you do is

00:09:38.912 --> 00:09:44.918
just trying to find wedding ring
from the garbage. 	So, here is

00:09:47.887 --> 00:09:52.459
the way I try to find the
inquiry key. 	First, we set the

00:09:52.459 --> 00:09:54.794
keys to the distinguished
structure [indiscernible] We

00:09:54.794 --> 00:10:00.800
can see if we discover something
interesting. So as the keys used

00:10:04.070 --> 00:10:09.075
to encrypt the packaging. 	So
why do we not find the

00:10:09.075 --> 00:10:15.949
instruction that the key so
lets try to reverse. So we

00:10:15.949 --> 00:10:20.487
find that the instructions
reserve key that has

00:10:20.487 --> 00:10:25.058
relunctanctly has a fixed part.
	And showing you the next slide,

00:10:25.058 --> 00:10:31.064
the whole concept with more
instruction could be used as

00:10:36.836 --> 00:10:40.907
[indiscernible] or second nature
to hold the address of the key.

00:10:42.942 --> 00:10:48.882
So here is most important
instruction that.. I dont

00:10:48.882 --> 00:10:51.417
know if you guys can see. If you
you can't see, maybe you can

00:10:51.417 --> 00:10:57.423
download if you can't see
clearly. 	Okay. 	Yeah. 	So, in

00:11:00.126 --> 00:11:06.132
this right, yeah. 	You see it.
	So, you can see the structures

00:11:13.606 --> 00:11:19.779
and values that's the flow of
how I tried to find out the key.

00:11:19.779 --> 00:11:25.785
	And actually there are 2 keys.
	Yes. The stored and the

00:11:29.522 --> 00:11:33.960
exchange key. 	So if you guys
want to hack it, you guys need

00:11:33.960 --> 00:11:39.966
to find the 2 keys to decrypt
the package. 	So, we do this to,

00:11:43.836 --> 00:11:50.176
second enter, and in the upper
right corner the instructions to

00:11:50.176 --> 00:11:56.583
magnify the Nano key. The OX 31,
on the OX 80. Its the memory

00:11:56.583 --> 00:12:02.522
adjust that stores the keys. So
in the lower left corner. 	So,

00:12:06.059 --> 00:12:13.233
on upper right corner is
instructions that magnify the

00:12:13.233 --> 00:12:19.238
nano key, so it should oh
because it's really messy.

00:12:21.507 --> 00:12:28.881
	Something going wrong with my
laptop. 	I'm sorry. thats

00:12:28.881 --> 00:12:35.955
embarrassing, yeah. Just junked
up, yeah. 	So, then use the

00:12:35.955 --> 00:12:41.127
code, [indiscernible] there are
more instructions, corresponding

00:12:41.127 --> 00:12:44.163
motion and motion code and
[indiscernible] For numbers, as

00:12:44.163 --> 00:12:50.036
its harder to search through
the memory through the premiere

00:12:50.036 --> 00:12:55.608
or [indiscernible]. 	So you guys
can know where the keys are used

00:12:55.608 --> 00:13:02.048
and how to find it and how to
encrypt it. 	So that's the

00:13:02.048 --> 00:13:08.054
screen shot of this. 	Address of
the keys. 	So, we were verify

00:13:11.391 --> 00:13:16.229
this keys, is that what we want?
Verify this, we title it you

00:13:16.229 --> 00:13:20.600
know, messaging integrated,
check, contents in package, and

00:13:20.600 --> 00:13:26.606
if the desired package pass
through MIC, yeah, so we can be

00:13:30.343 --> 00:13:35.214
sure that we find the right key.
So let's, you can just just

00:13:35.214 --> 00:13:40.119
write simple script to verify
it, and put all keys to where

00:13:40.119 --> 00:13:43.389
you can find, password,
password, bingo, that's it. 	So

00:13:43.389 --> 00:13:49.395
that's our snipper used to
capture the package. 	Yeah so we

00:13:53.800 --> 00:14:01.107
just, yeah we buy time so we
change a little -- so the

00:14:01.107 --> 00:14:05.078
following screen shot shows
process that a new code joins a

00:14:05.078 --> 00:14:10.750
network. 	As the speaker, its
quite self explanatory. The

00:14:10.750 --> 00:14:16.889
network key is extending from
coding nature to join the device

00:14:16.889 --> 00:14:23.863
and [indiscernible]. 	After
receiving the keys, the

00:14:23.863 --> 00:14:28.134
communication is immediate
immediately encrypted. So if it

00:14:28.134 --> 00:14:33.606
is encrypted we can use the key
that we find to decrypt it.

00:14:33.606 --> 00:14:39.612
	Here is screen shot. 	So, I
want to say is that after we

00:14:45.885 --> 00:14:50.356
find the key we could do some
data-mining, to find the habit

00:14:50.356 --> 00:14:56.629
of it because there are going
to be a little but of factors

00:14:56.629 --> 00:15:02.168
but the foreign are some very
particular attacks that we can

00:15:02.168 --> 00:15:07.740
perform. 	We can manifest the
starter data, we can repair and

00:15:07.740 --> 00:15:13.746
spoof, we can intercept it,
yeah, we can just

00:15:16.415 --> 00:15:20.119
[indiscernible] attack. 	So,
what matters of data where

00:15:20.119 --> 00:15:23.856
we after we decipher the
data, we will take control over

00:15:23.856 --> 00:15:29.862
the target device. We have the
nemesis the applied data. And

00:15:33.633 --> 00:15:40.873
the result is following. 	You
can see, the, if you want to

00:15:40.873 --> 00:15:45.845
control this, you know how to,
you know, the device you can

00:15:45.845 --> 00:15:53.753
turn a different color. 	Here is
the things that you can, you can

00:15:53.753 --> 00:15:59.559
know how to control it yet, this
is a bit, so the penalty

00:15:59.559 --> 00:16:05.498
[indiscernible]. 	The last pace
being SOR stand of the

00:16:07.967 --> 00:16:09.969
[indiscernible] bytes, byte one
and byte two of the

00:16:09.969 --> 00:16:16.943
[indiscernible] of the target
device. [Indiscernible] 	Okay,

00:16:16.943 --> 00:16:19.979
so, we can control this,
[indiscernible] While this is

00:16:19.979 --> 00:16:22.548
the device that we use, it's
actually about our own, we just,

00:16:22.548 --> 00:16:24.550
you know, use the echo
[indiscernible] and we to just

00:16:24.550 --> 00:16:26.619
print it out. 	So, we can
reprint this both. 	If you know

00:16:26.619 --> 00:16:28.654
the piece that we use, to
incorporate that we can just

00:16:28.654 --> 00:16:31.591
generate, the stem package to
join the network and we can send

00:16:31.591 --> 00:16:33.593
to the exactly send instructions
to control this device. 	Yes,

00:16:33.593 --> 00:16:35.595
[indiscernible] well, you guys
are the get away, so now you

00:16:35.595 --> 00:16:37.597
control me. 	So, this is the
text flow. This distance is

00:16:37.597 --> 00:16:39.599
really hard, so yeah. So we know
that, the double k to send

00:16:39.599 --> 00:16:41.601
instructions to the make and
product returns, yeah, so you

00:16:41.601 --> 00:16:43.603
can now just, you know the
question so generate exactly

00:16:43.603 --> 00:16:45.605
same questions to control it.
	So, how do we protect or just

00:16:45.605 --> 00:16:47.607
you know, prevent our device is
hacked by this way. 	So, you

00:16:47.607 --> 00:16:49.609
can, know, just know, if, so you
can adjust, [indiscernible]

00:16:49.609 --> 00:16:55.615
encryption keys in your
firmware, its not safe. So

00:17:02.555 --> 00:17:08.561
you can just store a
[indiscernible] of the

00:17:13.566 --> 00:17:19.572
encryption key instead of the
[indiscernible] and you know,

00:18:06.218 --> 00:18:12.224
dont joke [indiscernible]
	And use pre install of key,

00:18:26.772 --> 00:18:33.446
look to attach instead. 	Blow
the fuse, to prevent from being

00:18:33.446 --> 00:18:40.519
dumped. Such as use some
security water, use special

00:18:40.519 --> 00:18:47.293
protection to, basically you
guys don't have to leave

00:18:47.293 --> 00:18:51.063
[indiscernible] on either. so
every hacker seems to think well

00:18:51.063 --> 00:18:53.065
I can hack it. 	So the employee
of the, [ indiscernible]

00:18:53.065 --> 00:18:55.067
employee of the, some light
weight encryption on the

00:18:55.067 --> 00:18:57.803
application type just to
manifest the [indiscernible]

00:18:57.803 --> 00:19:01.774
its harder of the key
comprise 	Actually, I would like

00:19:01.774 --> 00:19:05.811
to say something. Actually this
presentation is not mine, it's

00:19:05.811 --> 00:19:08.781
my colleague. 	But
unfortunately, his visa got

00:19:08.781 --> 00:19:14.787
rejected so he could not make
it, so I just, I am familiar

00:19:41.047 --> 00:19:47.053
with his work, always says, take
laptop and do something.

00:19:49.288 --> 00:19:51.290
Actually I dont know, what
are you guys doing? 	He says, no

00:19:51.290 --> 00:19:56.996
you can replace me, you can
speak for me. I don't know what

00:19:56.996 --> 00:20:03.002
you do, so how do I do it for
you, so I'm really sorry for

00:20:09.608 --> 00:20:16.348
that. >> Youre doing fine.
	(Applause) 	[Laughter] >>yeah,

00:20:16.348 --> 00:20:22.354
I did my, already done my
presentation yesterday, so yeah.

00:20:24.757 --> 00:20:29.128
	I actually, Im familiar with
my work, not his. 	So, actually,

00:20:29.128 --> 00:20:36.969
here is the, you know, here is
the work that my colleague,

00:20:36.969 --> 00:20:42.975
former colleague help him a lot,
and actually, this, is, you

00:20:50.783 --> 00:20:55.754
know, you guys want to know more
details, you can contact with

00:20:55.754 --> 00:21:02.495
tweet or e-mail. 	I'm sorry
about him. 	Last thing, I should

00:21:02.495 --> 00:21:08.501
ask him, you want me to do
lunch? No. 	I did a lot. 	I'm

00:21:12.138 --> 00:21:19.445
really nervous. 	Because this
isn't my work. 	Yeah. 	I'm

00:21:19.445 --> 00:21:25.484
sorry. 	So, thank you, if you
guys have questions, I think I

00:21:25.484 --> 00:21:28.120
can't answer you, I'm sorry,
(Laughter). 	(Applause) Thank

00:21:28.120 --> 00:21:34.126
you. 	I appreciate it. 

