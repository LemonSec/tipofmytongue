00:00:00.000 --> 00:00:03.504
These guys are going to give a
fantastic talk and it's going to

00:00:03.504 --> 00:00:08.575
be really entertaining, yeah? >>
Thanks for your faith. >> I got

00:00:08.575 --> 00:00:15.249
a meeting to go to so whatever.
>> All right. Let's give them a

00:00:15.249 --> 00:00:20.020
round of applause. [Applause]
[CHEERS] >> Wow! Is this a

00:00:20.020 --> 00:00:24.791
Thursday at DEFCON? This place
is packed. Thank you, everybody,

00:00:24.791 --> 00:00:29.263
for coming. Welcome to sorry,
wrong number, mysteries of the

00:00:29.263 --> 00:00:33.100
phone system, past and present.
My name is Patrick McNeil or

00:00:33.100 --> 00:00:40.941
Unregistered 436 on Twitter. I
work for RadWare as a Security

00:00:40.941 --> 00:00:44.544
Solutions Architect and I got
about 15 years telecom

00:00:44.544 --> 00:00:47.681
experience about half of which
has been in security. >>So Im

00:00:47.681 --> 00:00:50.751
Owen. Im @[indiscernible] on
Twitter.I pretty much started

00:00:50.751 --> 00:00:55.355
out in development work. Then I
moved on. I liked breaking stuff

00:00:55.355 --> 00:01:00.327
more so I moved into security
and did a little bit of lacks

00:01:00.327 --> 00:01:03.463
DevOps, and eventually
pentesting so. >> So we fully

00:01:03.463 --> 00:01:07.768
embraced the fil noire aspect
of this conference, so pretty

00:01:07.768 --> 00:01:12.105
black and white deck here so we
can read it. >> That's why we're

00:01:12.105 --> 00:01:16.076
wearing these silver shirts. >>
So first a brief word from our

00:01:16.076 --> 00:01:19.379
lawyer. Obviously everything
that we say up here is our

00:01:19.379 --> 00:01:22.516
opinion only and doesn't
represent that of our employers

00:01:22.516 --> 00:01:26.119
and all trademarks, service
marks, et cetera, belong to

00:01:26.119 --> 00:01:29.189
their holders. We tried to use
creative comments where we

00:01:29.189 --> 00:01:32.893
could, but sometimes you run a
file and it's all fair use at

00:01:32.893 --> 00:01:36.663
this point. >> Should be in the
slide notice. >> Yeah, most of

00:01:36.663 --> 00:01:42.169
the slide we attributed. >> So
some of what we're going to show

00:01:42.169 --> 00:01:47.207
you today could be used from the
Nefarious purposes or evil. Some

00:01:47.207 --> 00:01:50.610
audio. [Audio clip.] So
something like that could

00:01:50.610 --> 00:01:56.083
happen. >> Could choose a life
of crime. >>So I want to thank

00:01:56.083 --> 00:02:00.287
DEFCON organizers for letting us
speak. Great, great turn out

00:02:00.287 --> 00:02:04.958
here today. Why are we doing
this? Messing around with stuff

00:02:04.958 --> 00:02:09.162
that's unfamiliar, stuff that's
new, so it's a good opportunity

00:02:09.162 --> 00:02:13.800
to learn, learn a lot,
especially from this guy and I

00:02:13.800 --> 00:02:18.438
know why you're doing it. >>
Well, I mean, obviously we

00:02:18.438 --> 00:02:23.510
wouldn't be up here if we
weren't having a good time, and

00:02:23.510 --> 00:02:29.850
I sought to learn as much about
stuff from him as he has for me

00:02:29.850 --> 00:02:33.620
because I don't really have his
[indiscernible] background and

00:02:33.620 --> 00:02:37.858
he doesn't really have telecom
background so we did something

00:02:37.858 --> 00:02:42.929
together. You know, plus a lot
of people forgotten the roots of

00:02:42.929 --> 00:02:46.299
freaking and hacking. And the
original hackers were

00:02:46.299 --> 00:02:50.103
essentially the freaks long
before there was the internet,

00:02:50.103 --> 00:02:55.008
golden board systems and all
that. They were the first ones

00:02:55.008 --> 00:02:58.245
that said, something electronic
to mess with it. They were the

00:02:58.245 --> 00:03:02.249
ones if you were the hacker
Ethos. We wanted to highlight

00:03:02.249 --> 00:03:06.453
that some of the things that
hackers used to do, or, excuse

00:03:06.453 --> 00:03:10.624
me, some of the things that
freakers used to do are still

00:03:10.624 --> 00:03:14.795
somewhat relevant, the mind set,
the approach to things, and even

00:03:14.795 --> 00:03:17.597
potentially some of the attacks
and you can look at some of the

00:03:17.597 --> 00:03:20.967
freaking attacks in a slightly
different way and now they're

00:03:20.967 --> 00:03:26.106
relevant for voice over IP and
voiceover IP as many people know

00:03:26.106 --> 00:03:30.510
wasn't really designed initially
to be secure. It was designed to

00:03:30.510 --> 00:03:34.848
work. Designed to generate a
source of revenue. And, you

00:03:34.848 --> 00:03:37.651
know, potentially reduce the
number of lines you needed in

00:03:37.651 --> 00:03:41.021
the offices and things like
that. So we're not going to talk

00:03:41.021 --> 00:03:44.591
about everything. We're going to
talk about maybe what's likely

00:03:44.591 --> 00:03:49.262
to happen and we wanted to kind
of educate a little bit about

00:03:49.262 --> 00:03:53.200
ways to defend networks rather
than just the pin testing and

00:03:53.200 --> 00:03:57.170
attacking role. >> So kind of
learn a bit about freaking

00:03:57.170 --> 00:04:01.842
backgrounds too. So we have to
have a pie chart. I always love

00:04:01.842 --> 00:04:04.711
having pie charts in
presentations. Not reflective at

00:04:04.711 --> 00:04:07.914
all of what is in the
presentation. The percentages

00:04:07.914 --> 00:04:12.219
are off and you have the history
information and do some

00:04:12.219 --> 00:04:19.526
exploitation stuff and there's a
little bit of a tool. So we'll

00:04:19.526 --> 00:04:22.295
just move on. >> All right. So
before users were actually

00:04:22.295 --> 00:04:26.266
allowed to dial before the
little rotary phone, operators

00:04:26.266 --> 00:04:29.269
were in control of the dialing
process. So if you wanted to

00:04:29.269 --> 00:04:31.404
call somebody else, you had to
pick up the phone and talk to

00:04:31.404 --> 00:04:36.042
the operator and they would --
you'd tell them an exchange. The

00:04:36.042 --> 00:04:39.579
exchanges were normally the
street name or the intersection

00:04:39.579 --> 00:04:42.849
where the phone switch is
located and then each of those

00:04:42.849 --> 00:04:47.787
exchanges had anywhere from 3 to
5 digit that is were used for

00:04:47.787 --> 00:04:50.590
the subscriber. So we have a
video clip for you. This example

00:04:50.590 --> 00:04:53.527
is from a movie called Sorry,
Wrong Number, which is the

00:04:53.527 --> 00:04:57.631
inspiration for our talk from
1948. >> Play the video. >>

00:04:57.631 --> 00:05:01.168
Operator! Operator! Operator! >>
Your call please. >> Operator,

00:05:01.168 --> 00:05:06.273
I've been ringing number 3 5097
for the last half hour. The line

00:05:06.273 --> 00:05:11.811
is always busy. Can you ring it
for me please. >> In this movie

00:05:11.811 --> 00:05:16.516
she's supposed to be a... >>
Should have been home hours ago.

00:05:16.516 --> 00:05:21.254
I can't think of what's keeping
him or why that ridiculous line

00:05:21.254 --> 00:05:25.192
is busy. It's 6 o'clock. >>
350-97... (Busy tone) >>Having

00:05:25.192 --> 00:05:28.728
conversations with the operator
and explaining the situation. >>

00:05:28.728 --> 00:05:32.666
Thank you. >> Hello, Mr.
Stevenson, please. I want to

00:05:32.666 --> 00:05:37.003
speak to Mr. Henry Stevenson.
Hello. Who is this. What number

00:05:37.003 --> 00:05:41.708
am I calling? >> Everything's
okay at -- >> Excuse me. What's

00:05:41.708 --> 00:05:46.046
going on here.. Im using
>> 11:15 is good, 11:15 is

00:05:46.046 --> 00:05:51.151
right. Get off >> So it's a
little hard to hear but they're

00:05:51.151 --> 00:05:55.889
actually talking about a murder
plot and that's sort of thing --

00:05:55.889 --> 00:05:59.826
while >> Unlike todays
movies, you know, you see people

00:05:59.826 --> 00:06:04.531
grabbing stuff and putting it on
the other side and that's a

00:06:04.531 --> 00:06:09.669
depiction of hacking and I don't
know if believe this. >> It is

00:06:09.669 --> 00:06:13.607
something that could actually
happen across wire basically, so

00:06:13.607 --> 00:06:16.743
-- So user dialing...user
dialing and getting away from

00:06:16.743 --> 00:06:20.914
the operator actually came from
a relatively unlikely source.

00:06:20.914 --> 00:06:26.386
Almin Stroman was an undertaker
and he was under the impression

00:06:26.386 --> 00:06:30.090
that somebody was stealing his
business and he figured out that

00:06:30.090 --> 00:06:33.593
one of the operators in town was
married to the other undertaker

00:06:33.593 --> 00:06:38.865
in town so when somebody would
call and say I want to talk to

00:06:38.865 --> 00:06:41.968
the undertaker it was his
impression that they were

00:06:41.968 --> 00:06:47.274
putting that call through to --
or the operator was putting him

00:06:47.274 --> 00:06:52.912
through to her husband instead.
So he came up with this thing

00:06:52.912 --> 00:06:57.884
called the Stroger switch which
is essentially a cylinder and it

00:06:57.884 --> 00:07:01.521
would use alternating current
pulses to rotate the cylinder

00:07:01.521 --> 00:07:06.192
and there would be one per digit
dialed. So the phone that he

00:07:06.192 --> 00:07:09.396
came up with, essentially had
three buttons on it and there

00:07:09.396 --> 00:07:12.699
was one button for the 100s
place, one for the 10s and one

00:07:12.699 --> 00:07:15.502
for the ones and you had to
repeatedly press that button

00:07:15.502 --> 00:07:18.171
with no indication with how many
times you pressed it so you

00:07:18.171 --> 00:07:21.408
better be counting when you did
it and it would turn the

00:07:21.408 --> 00:07:25.078
cylinder and there would be a
little armature that would click

00:07:25.078 --> 00:07:31.084
in when you did it and they
ended up calling step by step

00:07:45.932 --> 00:07:47.934
and eventually acquired by the
Bell system. So as implemented

00:07:47.934 --> 00:07:49.936
by the Bell system, however,
they got away from those little

00:07:49.936 --> 00:07:51.938
buttons that you has to press.
That's when we first started

00:07:51.938 --> 00:07:53.940
seeing actual rotary dial and
when you would turn the rotary

00:07:53.940 --> 00:07:55.942
and it would go click, click,
click, click all the way back,

00:07:55.942 --> 00:07:57.944
well, that's what was sending
the current pulses and turning

00:07:57.944 --> 00:07:59.946
the switch. The problem was that
was only good within one

00:07:59.946 --> 00:08:03.350
exchange. And those switches
were tied up for the duration,

00:08:03.350 --> 00:08:07.754
the entire duration of the call.
So eventually they got around to

00:08:07.754 --> 00:08:10.724
dialing from exchange to
exchange adding more digits on

00:08:10.724 --> 00:08:16.730
to the front of the number. But
in order to dial from exchange

00:08:19.866 --> 00:08:22.202
to exchange, you no longer could
reference the name of the

00:08:22.202 --> 00:08:25.372
exchange. So they had to come up
with a way for them to do that

00:08:25.372 --> 00:08:27.374
and basically they said well
well abbreviate the exchange

00:08:27.374 --> 00:08:31.711
names and convert those letters
into digits and that's how they

00:08:31.711 --> 00:08:37.283
came up with the letters that
were assigned to every number

00:08:37.283 --> 00:08:44.724
around the phone dial. Now, of
course nothing really changes

00:08:44.724 --> 00:08:50.897
without a motivating event. And
the motivating event for AT&T

00:08:50.897 --> 00:08:56.036
was really a combination of
workforce growth, the need for

00:08:56.036 --> 00:09:00.073
efficiencies, cost of running a
network. All those, you know,

00:09:00.073 --> 00:09:03.476
switches that were tied up. So
they ended up having to work on

00:09:03.476 --> 00:09:10.383
an electronic switch, and the
switch that they came up with

00:09:10.383 --> 00:09:13.953
was the panel and cross bar
which introduced common control.

00:09:13.953 --> 00:09:17.057
And when you dialed they would
actually build up the number

00:09:17.057 --> 00:09:19.893
that you dialed in something
called the sender before it

00:09:19.893 --> 00:09:23.830
would send it on for processing.
That was good enough for local

00:09:23.830 --> 00:09:28.168
dialing, but now we had to get
to long distance. And long

00:09:28.168 --> 00:09:31.504
distance dialing they developed
something called the 4A cross

00:09:31.504 --> 00:09:37.477
bar switch. That was something
that used, it was very similar

00:09:37.477 --> 00:09:41.881
to an old computer punch card
that was made out of metal and

00:09:41.881 --> 00:09:44.784
there were punches in that that
represented the routes from city

00:09:44.784 --> 00:09:49.489
to city. And there were
alternate paths, so you would

00:09:49.489 --> 00:09:53.093
follow the punches to figure out
how to get from one city to the

00:09:53.093 --> 00:09:57.764
other and now of course we had
to introduce the area code so

00:09:57.764 --> 00:10:02.569
you knew -- or that the system
knew when you dialed which

00:10:02.569 --> 00:10:07.440
exchange you were trying to get
to. Unfortunately there was a

00:10:07.440 --> 00:10:11.845
big design flaw that they didn't
think about. And a lot of us are

00:10:11.845 --> 00:10:16.449
familiar with 2600. The reason
2600 is called that is because

00:10:16.449 --> 00:10:21.354
of the 2600 megahertz tone,
supervisory tone. Essentially

00:10:21.354 --> 00:10:25.692
the flaw was they were using
inband signaling so the signal

00:10:25.692 --> 00:10:29.529
was actually being carried over
the same audio path or the path

00:10:29.529 --> 00:10:33.600
that the subscriber was using.
What that meant was if you

00:10:33.600 --> 00:10:37.570
dialed a toll-free number, long
distance number, you could then

00:10:37.570 --> 00:10:42.442
send the 2600 hertz, supervisory
tone and the long distance

00:10:42.442 --> 00:10:46.980
switch would think that you'd
actually hung up the call. You

00:10:46.980 --> 00:10:50.617
could then send either a signal
or multifrequency tones

00:10:50.617 --> 00:10:53.753
depending on what that long
distance switch supported and

00:10:53.753 --> 00:10:56.890
dial another number. So that's
how people were able to make

00:10:56.890 --> 00:11:02.896
free long distance phone calls.
Let's see. There you go.

00:11:10.770 --> 00:11:18.411
Thats it. >> All right.
So...one more slide back.

00:11:18.411 --> 00:11:24.417
Because you did that one, didn't
you? >> Yeah, I just did that.

00:11:29.422 --> 00:11:35.428
>> So -- Oh I guess I wasnt
paying attention. >> It's not

00:11:43.202 --> 00:11:49.209
our first time, I swear. >> So
when we're looking in the future

00:11:58.151 --> 00:12:04.157
you see a lot of VoIP, lot of
VoIP -- yeah, I see it. So when

00:12:16.502 --> 00:12:22.508
you're looking in the future
with the VoIP, what could happen

00:12:29.148 --> 00:12:35.154
with -- we have a lot of
technology driving innovation,

00:12:40.627 --> 00:12:46.633
watches and phones have been
added in the Android web, I

00:12:53.239 --> 00:12:59.245
dont know why they do that.
Or about web, webRTC. We're

00:13:05.885 --> 00:13:11.891
going to see more people fishing
for one-time passwords or

00:13:17.363 --> 00:13:23.369
credentials. We dont have
crystal balls. We're not going

00:13:27.707 --> 00:13:33.713
to show you any new exploits and
cover attacks that are still

00:13:41.487 --> 00:13:47.493
relevant today based on the
phone system. Still effective

00:13:51.831 --> 00:13:57.837
and need to be defended against
and show you this and come sit

00:14:04.243 --> 00:14:09.482
at our table and mostly created
for AGI scripts and we'll get a

00:14:09.482 --> 00:14:15.154
bit more into that a bit later.
So many of you if you're

00:14:15.154 --> 00:14:20.393
familiar with VoIP at all would
have heard of the asterisk scan

00:14:20.393 --> 00:14:26.532
and it was created 99 so it has
been around a long time. It's

00:14:26.532 --> 00:14:31.771
created by Mark Spencer and is
now made by well maintained by

00:14:31.771 --> 00:14:36.576
Digium. There is a confusing
number of releases. You have got

00:14:36.576 --> 00:14:41.848
long-term support and latest DPR
and a bunch of books. You know

00:14:41.848 --> 00:14:47.086
you have a product when you have
a Dummies book published after

00:14:47.086 --> 00:14:51.457
you. So the AMI and AGI, the
asterisk management interface

00:14:51.457 --> 00:14:55.828
and the asterisk gateway
interface. Avi can be thought of

00:14:55.828 --> 00:15:01.501
for like a CGI for phone systems
and you can write scrips and

00:15:01.501 --> 00:15:07.206
they will do stuff for you and
it's really cool. You can do

00:15:07.206 --> 00:15:11.144
some really cool stuff,
so...from this you create this

00:15:11.144 --> 00:15:16.382
cool system and now you have all
these variances. Some of these

00:15:16.382 --> 00:15:20.753
are real popular. Just making it
easier. So asterisks for

00:15:20.753 --> 00:15:26.025
abbreviations and crypt box are
really big, the one that runs on

00:15:26.025 --> 00:15:30.396
the [indiscernible] is really
cool but the problem is it

00:15:30.396 --> 00:15:34.333
doesn't necessarily take
security into mind. It takes it

00:15:34.333 --> 00:15:39.572
a while to catch up with the
latest branch from asterisk so

00:15:39.572 --> 00:15:44.377
what happens is you keep on
building stuff and you cant

00:15:44.377 --> 00:15:51.384
keep up with it you end up with
a big pile of trash and some of

00:15:51.384 --> 00:15:56.189
them maintain, 2013 was the
latest update for one of them.

00:15:56.189 --> 00:16:02.495
Eventually that trash my fall
over and anyones web server can

00:16:02.495 --> 00:16:06.632
see you and you know trash could
fall into a lawyers apartment.

00:16:06.632 --> 00:16:09.302
So we're going to go for some
attacking defense. >> So attack

00:16:09.302 --> 00:16:11.304
and defense were several
categories of threats and we

00:16:11.304 --> 00:16:13.973
used Al Capone on all the slides
for the attacker, the famous

00:16:13.973 --> 00:16:16.409
gangster and J Edgar Hoover, the
original director and good guy

00:16:16.409 --> 00:16:19.545
as our defender so you can see
the little icon at the top right

00:16:19.545 --> 00:16:22.448
and see which one we're talking
about. >> It used to be red

00:16:22.448 --> 00:16:25.551
versus blue but we decided to..
>> It didn't work for film ware.

00:16:25.551 --> 00:16:28.454
>> Black Hat versus White Hat I
guess. >> So we're not going to

00:16:28.454 --> 00:16:31.123
cover every voice threat, right?
There is a lot that we could

00:16:31.123 --> 00:16:33.559
cover but we're going to cover
the most likely stuff. >>

00:16:33.559 --> 00:16:35.561
Possible but not probable. >>
Information leakage...when a

00:16:35.561 --> 00:16:37.797
system that is designed to be
used by only authorized parties

00:16:37.797 --> 00:16:40.700
gives you stuff you can work
with so you can use it. All

00:16:40.700 --> 00:16:42.935
right. So, you know, the freaks
with the original phone

00:16:42.935 --> 00:16:45.137
enthusiasts and they like to
explore the phone system. They

00:16:45.137 --> 00:16:47.139
took advantage of information
leaking because it was not

00:16:47.139 --> 00:16:49.141
designed to be secure,
confidential. You know, the very

00:16:49.141 --> 00:16:51.377
first thing that they could do
is socially engineer operators.

00:16:51.377 --> 00:16:54.046
The operators were mostly female
so some of them, believe it or

00:16:54.046 --> 00:16:56.048
not, would actually use
girlfriends and get their

00:16:56.048 --> 00:16:58.050
girlfriends to call the operator
and say they were another

00:16:58.050 --> 00:17:00.519
operator and could you put me
through to this number. Yes,

00:17:00.519 --> 00:17:02.755
hackers were freakers in this
case actually had girlfriends. (

00:17:02.755 --> 00:17:05.858
LAUGHTER ) >> So the other thing
to do is they could pretend to

00:17:05.858 --> 00:17:08.761
be one of the mail workers. One
of the test line operators, I'm

00:17:08.761 --> 00:17:11.197
trying to test this particular
number. Put me through here and

00:17:11.197 --> 00:17:13.666
of course the operator was more
than willing to oblige. Phone

00:17:13.666 --> 00:17:16.335
techs were also very proud to
work for the company so they

00:17:16.335 --> 00:17:18.771
could say, hey, jeez, how does
this particular thing work? And

00:17:18.771 --> 00:17:21.674
in most cases they were willing
to share. I mean, anybody who is

00:17:21.674 --> 00:17:24.544
proud to be part of their job
might be willing to talk about

00:17:24.544 --> 00:17:26.779
it, especially if you're not
told any of this is

00:17:26.779 --> 00:17:29.015
confidential. And then of course
was the really obvious stuff,

00:17:29.015 --> 00:17:31.450
you're picking up the phone and
dialing and you're hearing all

00:17:31.450 --> 00:17:35.254
kinds of clicks and dial a long
distance number and hear a tone

00:17:35.254 --> 00:17:39.125
and you start to wonder what are
those things if you're our type

00:17:39.125 --> 00:17:41.127
of mentality and they started
recording them on tapes and

00:17:41.127 --> 00:17:43.129
slicing up the tapes and figured
out we could build something

00:17:43.129 --> 00:17:45.131
called the blue box and
replicate those tones by

00:17:45.131 --> 00:17:47.133
pressing a button. And of course
I would say the biggest gift to

00:17:47.133 --> 00:17:49.135
the freakers was actually 1960
technical journal, Bell

00:17:49.135 --> 00:17:51.137
technical journal. They
published these on a regular

00:17:51.137 --> 00:17:53.139
basis and actually published the
single frequency and multi

00:17:53.139 --> 00:17:55.141
frequency tones that were
required to send from exchange

00:17:55.141 --> 00:17:57.143
-- or from one long distance
switch to the other. So they

00:17:57.143 --> 00:17:59.145
basically said, oh, yeah, by the
way, if you want to control our

00:17:59.145 --> 00:18:01.147
long distance switches, here are
the exact frequencies you need

00:18:01.147 --> 00:18:03.149
to send. Perfect if you're
trying to put together a blue

00:18:03.149 --> 00:18:05.151
box, right? And then of course
exhaustive dialing of numbers.

00:18:05.151 --> 00:18:07.153
Quickly figured out the dials
were abusive on your fingers so

00:18:07.153 --> 00:18:09.155
they used pencils and dialed all
sorts of numbers that were

00:18:09.155 --> 00:18:11.157
outside of the normal phone
range and there are special

00:18:11.157 --> 00:18:13.159
codeings that you can use for
routing and accessing certain

00:18:13.159 --> 00:18:15.161
features. And then of course
there's something called a loop

00:18:15.161 --> 00:18:17.163
round which was really supposed
to be for testing by the field

00:18:17.163 --> 00:18:19.165
technicians and freakers figured
out that if you could stand to

00:18:19.165 --> 00:18:21.167
listen to the annoying tone on
the loop round, you could get

00:18:21.167 --> 00:18:23.169
people together and just chat.
Just have an exchange of

00:18:23.169 --> 00:18:25.171
information. >> You said the
annoying tone. >> Yeah, the

00:18:25.171 --> 00:18:27.173
superrise retone that would
play. >> Yes. Yeah, they

00:18:27.173 --> 00:18:29.175
accepted collect calls. So the
world was largely oblivious to

00:18:29.175 --> 00:18:31.177
the freaking community and they
really found out in this 1971

00:18:31.177 --> 00:18:33.179
Esquire article called Secrets
of Little Blue Box and some of

00:18:33.179 --> 00:18:35.181
the people that were made famous
or infamous in that including

00:18:35.181 --> 00:18:37.183
Joe, Mark, and John Draper, AKA,
Captain Crunch, they were

00:18:37.183 --> 00:18:39.185
certainly not the first freakers
as we kind of seen because

00:18:39.185 --> 00:18:41.187
freaking was around for a long
time but they certainly became

00:18:41.187 --> 00:18:43.189
the more popular ones. On a bit
of a side note, AT&T was at the

00:18:43.189 --> 00:18:45.191
time a monopoly owner of the
phone system and they had a

00:18:45.191 --> 00:18:47.193
policy in terms of service that
said you couldn't hook anything

00:18:47.193 --> 00:18:49.195
to the phone system that was not
sold by them. So freakers

00:18:49.195 --> 00:18:51.197
decided well that's no fun and
we want to have some jokes so

00:18:51.197 --> 00:18:53.199
basically the first answering
machine was made -- didn't

00:18:53.199 --> 00:18:55.201
actually record anything but it
would play jokes. Joke lines

00:18:55.201 --> 00:18:59.939
became really popular. So that's
pretty much the bulk of the

00:18:59.939 --> 00:19:05.511
history that I'm going to try to
dump on you today. So I would

00:19:05.511 --> 00:19:10.716
definitely recommend exploiting
the phone by Phil Lapsy and it's

00:19:10.716 --> 00:19:17.056
a great read and he's done a lot
of great research. So the phone

00:19:17.056 --> 00:19:20.793
companies eventually stopped
blue boxing by moving to

00:19:20.793 --> 00:19:24.096
something called common channel
interoffice signal. What they

00:19:24.096 --> 00:19:27.666
did essentially was they put in
another line from office to

00:19:27.666 --> 00:19:31.570
office using a modem so they
could digitally signal the calls

00:19:31.570 --> 00:19:39.478
so you no longer had the
signaling over the call path. As

00:19:39.478 --> 00:19:46.952
freakers figured out what was
going on there, like, well wait

00:19:46.952 --> 00:19:48.988
a minute, the phone company can
use modems to send information

00:19:48.988 --> 00:19:51.190
digitally from point to point.
Maybe we can with these new, you

00:19:51.190 --> 00:19:53.192
know, personal computers that
we're discovering. And very

00:19:53.192 --> 00:19:56.395
quickly they figured out that
they could now connect over

00:19:56.395 --> 00:20:00.833
things like a bolding board
service so they're having to do

00:20:00.833 --> 00:20:06.038
it over the phone so this is
where we're starting to see a

00:20:06.038 --> 00:20:10.042
little bit of segmentation
between the PC hackers and or

00:20:10.042 --> 00:20:14.080
course the protocols they used
to communicate over these modem

00:20:14.080 --> 00:20:18.484
lines was eventually IP and that
started the downhill roll. It

00:20:18.484 --> 00:20:23.722
turned into, let's make an IP
card that you can jam into the

00:20:23.722 --> 00:20:27.860
back of your old switch and
eventually well, let's make it

00:20:27.860 --> 00:20:31.330
all IP so it performs better and
we'll just have a Gateway that

00:20:31.330 --> 00:20:36.035
goes on to the DDM network and
of course the subsequent step

00:20:36.035 --> 00:20:39.772
from that is, hey, now we have
virtualization. Let's just make

00:20:39.772 --> 00:20:45.511
a virtual thing that we can run
on a lap top and, you know, use

00:20:45.511 --> 00:20:52.985
a soft client instead of an
actual phone. So nowadays

00:20:52.985 --> 00:20:55.921
information leakage, I mean, you
can do a lot of stuff that you

00:20:55.921 --> 00:20:59.925
would normally do with any sort
of scan or pin test. You know,

00:20:59.925 --> 00:21:06.232
your basic port scanning, send a
message and see what comes back

00:21:06.232 --> 00:21:09.502
for your fingerprinting.
Extension enumeration where

00:21:09.502 --> 00:21:14.106
you're just sending like a
register message or an invite

00:21:14.106 --> 00:21:17.209
message to every possible phone
number that you think might be

00:21:17.209 --> 00:21:22.047
in that range and just see what
comes back. And of course if

00:21:22.047 --> 00:21:26.085
you're actually looking at the
SSP signaling, SSP in and of

00:21:26.085 --> 00:21:30.256
itself leaks information like
crazy. The user agent might tell

00:21:30.256 --> 00:21:35.728
you what type of software is
being run on the PBX or the end

00:21:35.728 --> 00:21:39.565
point you're talking to. The
methods that are supported by

00:21:39.565 --> 00:21:44.904
the end point, may tell you a
little bit more about what it

00:21:44.904 --> 00:21:51.043
is. >> It's very similar if you
take a look to the way TTP works

00:21:51.043 --> 00:21:55.848
and the interesting path is in
yellow. >> It's text based. So

00:21:55.848 --> 00:21:58.117
what does that mean? We can man
in the middle of that because we

00:21:58.117 --> 00:22:00.953
can easily write in a script
that says if I see this, do this

00:22:00.953 --> 00:22:06.959
to it instead. And unfortunately
SSP still using the C.R.Y.P.T.O.

00:22:12.565 --> 00:22:18.771
that...MD-5. So you can cram
anything over TLS and SRTP and

00:22:18.771 --> 00:22:23.676
hopefully make it more secure,
but oh my God, they're hard and

00:22:23.676 --> 00:22:27.513
nobody wants to issue client
certificates and basically yes

00:22:27.513 --> 00:22:32.151
you can get some integrity and
maybe a little bit of

00:22:32.151 --> 00:22:36.422
confidentiality out of having
that flow, but there are still

00:22:36.422 --> 00:22:41.694
TLS attacks, so I'll get into
later what I recommend here but

00:22:41.694 --> 00:22:44.430
obviously having TLS doesn't
guarantee security. >> Its

00:22:44.430 --> 00:22:48.701
really no good. The MD-5 doesn't
change. It's the same for every

00:22:48.701 --> 00:22:53.472
phone call that session makes
and I asked well why don't just

00:22:53.472 --> 00:22:58.944
change it to a more security
algorithm and it can't be that

00:22:58.944 --> 00:23:04.683
hard. >> SRTS man. Go argue with
the ITF. So when actually

00:23:04.683 --> 00:23:09.054
gathering information on a phone
system, start with the basic

00:23:09.054 --> 00:23:12.391
stuff. Don't think of this as a
phone system. Do your Google

00:23:12.391 --> 00:23:18.297
searches. Scan, you know, the
DNS queries, scan job boards and

00:23:18.297 --> 00:23:21.700
figure out what somebody is
running through a side channel

00:23:21.700 --> 00:23:26.338
basically and you could actually
make phone calls and listen to

00:23:26.338 --> 00:23:29.842
the voice mail prompts for
people that aren't there and you

00:23:29.842 --> 00:23:32.578
can usually figure out about
what phone system they might be

00:23:32.578 --> 00:23:35.614
running just because there are
standard prompts. >> Or the

00:23:35.614 --> 00:23:38.717
voice they use. >> Yeah,
exactly. And of course if you're

00:23:38.717 --> 00:23:43.289
internet connected, SIP options
generally used by many scanners

00:23:43.289 --> 00:23:50.062
to try to defect the presence of
a PBX but a lot of vendors have

00:23:50.062 --> 00:23:53.899
either patched against that or
put in rules that say don't

00:23:53.899 --> 00:23:57.403
allow options from anybody
except the specific end point so

00:23:57.403 --> 00:24:02.041
use something like an invite or
even a cancel message. Something

00:24:02.041 --> 00:24:07.946
that will evade that. And then
of course you can look for X

00:24:07.946 --> 00:24:13.919
headers which are unique to
particular vendors. You know, do

00:24:13.919 --> 00:24:18.724
your extension enumeration by
sending lots of registered

00:24:18.724 --> 00:24:24.697
messages, basically just see
everything you can get to come

00:24:24.697 --> 00:24:29.401
back. When you're doing your
port scans, remember that the --

00:24:29.401 --> 00:24:33.872
at least most people use NMAP.
>>You have to change your

00:24:33.872 --> 00:24:38.777
default options. >>Yeah, you got
to mess up a default option or

00:24:38.777 --> 00:24:43.248
add in new options so definitely
scan your EDP because it's

00:24:43.248 --> 00:24:47.720
generally sent over EDP. Include
the ports for AMI and AGI

00:24:47.720 --> 00:24:53.025
interface that is are not part
of the port range. You will miss

00:24:53.025 --> 00:24:58.731
them if you don't add in those
ports so you don't get picked up

00:24:58.731 --> 00:25:03.202
by something that's looking at
rate base. When you're using a

00:25:03.202 --> 00:25:06.305
tool and I think this goes
without saying but understand

00:25:06.305 --> 00:25:09.508
what the tool is doing rather
than just accepting it and

00:25:09.508 --> 00:25:14.847
running it. A good example is
this that's used by about 99% of

00:25:14.847 --> 00:25:19.251
the people for scanner SIP
services has a default agent

00:25:19.251 --> 00:25:23.122
string that everybody is patched
against now so you'll see a

00:25:23.122 --> 00:25:27.326
friendly scanner come in, not.
And you know that's Subficious.

00:25:27.326 --> 00:25:30.829
>> Didnt Subfucious make a
bunch of peoples phones ring in

00:25:30.829 --> 00:25:35.100
Korea? >> Yeah, exactly. So scan
with a different tool name, a

00:25:35.100 --> 00:25:38.804
different username. Scan with a
different method like an invite

00:25:38.804 --> 00:25:42.174
or cancel. The Medi plate
scanner is pretty good because

00:25:42.174 --> 00:25:45.878
it randomizeed everything but it
doesn't do -- at least the

00:25:45.878 --> 00:25:50.749
modules that I have seen doesn't
do credential cracking. And also

00:25:50.749 --> 00:25:54.319
not many of the VoIP scanners
around today are being actively

00:25:54.319 --> 00:25:58.857
maintained. The two exceptions.
One is Viproi and if you go to

00:25:58.857 --> 00:26:00.859
the VoIP hacking seminar or
whatever, the session being held

00:26:00.859 --> 00:26:02.861
by Fatee, he actually maintains
that and Blue Box and MG is also

00:26:02.861 --> 00:26:04.863
maintained. >>[Indiscernible]
still works. >> Yeah, for the

00:26:04.863 --> 00:26:06.865
most part. >> There is an
exercise, Patrick looked at the

00:26:06.865 --> 00:26:08.867
Rapid 7 Z map data and came up
with this interesting analysis.

00:26:08.867 --> 00:26:10.869
>> Yeah, I noticed that they
basically just collected SSP

00:26:10.869 --> 00:26:12.871
UDP. They had just initial
options response so if I was

00:26:12.871 --> 00:26:14.873
doing it, I might have used a
different method just to maybe

00:26:14.873 --> 00:26:16.875
get some more information back.
But it is what it is. It's a big

00:26:16.875 --> 00:26:18.877
data set, and what was
interesting was the numbers that

00:26:18.877 --> 00:26:20.879
came back weren't as big as I
thought they were going to be

00:26:20.879 --> 00:26:22.881
because there is an awful lot of
SSP stuff out there that's

00:26:22.881 --> 00:26:28.887
connected to the internet so
maybe people put in ACLs to

00:26:40.499 --> 00:26:46.505
block their scanner or something
but we got 52- to 53 --> 000 that

00:27:01.587 --> 00:27:07.926
came back as generic asterisk
and nearly 11 --> 00 that said

00:27:07.926 --> 00:27:11.029
asterisk PDX. And the
interesting one for us which

00:27:11.029 --> 00:27:15.501
you'll see later is this
asterisk PDX. What is it, phone

00:27:15.501 --> 00:27:20.472
cord that's actually Trix box
which is asterisk installed on a

00:27:20.472 --> 00:27:24.510
PC [ indiscernible]. >>
[Indiscernible] as part of a

00:27:24.510 --> 00:27:29.448
machine. >>Yeah, it's sold as
sort of a quick start-up. >>

00:27:29.448 --> 00:27:33.952
Like an LM-1 point click
configure type thing. >> Yeah,

00:27:33.952 --> 00:27:40.225
and of course as I expected we
saw a lot of small to medium

00:27:40.225 --> 00:27:44.663
business systems. Lots of old
MTAs software releases and the

00:27:44.663 --> 00:27:47.633
stuff that totally blew me away
was the couple of instances like

00:27:47.633 --> 00:27:55.407
a Nortel DNS 100, this is like a
big, big switch. We put that on

00:27:55.407 --> 00:28:02.180
the internet. A lot of user
agents that just said camera and

00:28:02.180 --> 00:28:05.717
they all seem to be based in
China, which was kind of weird.

00:28:05.717 --> 00:28:10.055
And then lots of MTAs that are
being deployed in Germany.

00:28:10.055 --> 00:28:14.359
There's been a really active
push for that and lots of

00:28:14.359 --> 00:28:18.664
Plowway in Iran and I'm guessing
not many American companies are

00:28:18.664 --> 00:28:23.368
going to be selling in Iran. >>
What's the Fritz. Fritz OS. >>

00:28:23.368 --> 00:28:30.075
Yeah Fritz OS was the MTA
deployed in Germany. All right.

00:28:30.075 --> 00:28:32.644
So what can you do to defend
yourself against this

00:28:32.644 --> 00:28:38.417
information leakage? Number one,
security by obscurity. Change

00:28:38.417 --> 00:28:42.321
your user default agent. There's
no reason that you have it. It's

00:28:42.321 --> 00:28:46.024
not really used by anything so
call it asterisk when you're on

00:28:46.024 --> 00:28:50.829
a system or something else,
right? So it's not used. >> You

00:28:50.829 --> 00:28:55.634
can try that. It may work.
[Laughter] >> Block known bad

00:28:55.634 --> 00:29:00.906
user agents...we have a bunch of
known bad user agents that are

00:29:00.906 --> 00:29:07.012
in IP tables on our Github. I
did some research for a while so

00:29:07.012 --> 00:29:12.684
I have about three years of data
that I just parsed through and

00:29:12.684 --> 00:29:18.156
here is a list of them for you.
And especially if you're on

00:29:18.156 --> 00:29:22.628
asterisk, use this. Always Auth
reject. Essentially the area

00:29:22.628 --> 00:29:24.630
code that's returned is usually
different if an extension exists

00:29:24.630 --> 00:29:26.665
versus if you have got a bad
password and returns the same

00:29:26.665 --> 00:29:29.034
error message for everything so
you can't quite tell. [Inaudible

00:29:29.034 --> 00:29:31.036
question from audience] So the
question was are you setting

00:29:31.036 --> 00:29:37.042
that for every SSP computer?
Yes. There's no reason -- yeah,

00:29:46.618 --> 00:29:54.359
there's no reason to have it
otherwise. >> Fail to block IPs

00:29:54.359 --> 00:30:00.365
that were repeated heavily. >>
What happened to the video? >>

00:30:06.938 --> 00:30:14.046
Da-Da-Da. Thanks a lot Master
Shin. >> Tried plugging it back

00:30:14.046 --> 00:30:20.052
in. >> Before I even get to the
good stuff too. >> Oh, my God. I

00:30:27.859 --> 00:30:33.865
saw something happen. >> All
right. There we go. >> That is

00:30:38.203 --> 00:30:43.608
weird. >> Okay. And then lastly
user security appliance that

00:30:43.608 --> 00:30:48.914
will block such scans. >>
Exploitation, we dont really

00:30:48.914 --> 00:30:53.719
need a definition for this,
usernet something for greatest

00:30:53.719 --> 00:30:58.857
possible advantage or the
selfish users. [indiscernible]

00:30:58.857 --> 00:31:02.227
>> Yeah. So exploitation usually
has this connotation of being

00:31:02.227 --> 00:31:06.498
malicious, but for the most part
a lot of the freaks was similar

00:31:06.498 --> 00:31:11.136
to the medical profession. Do
not harm. It was all about just

00:31:11.136 --> 00:31:16.174
exploration. It was fairly
innocent for the most part. >>

00:31:16.174 --> 00:31:20.812
Nowadays it's pretty much
anything you can imagine. You

00:31:20.812 --> 00:31:24.583
got fraud, Bobnets, profit,
whatever you want to do. The bad

00:31:24.583 --> 00:31:29.755
guys use it to however they
want. We take a look at the Trix

00:31:29.755 --> 00:31:33.458
folks we were talking about
earlier. There's 1200 on there.

00:31:33.458 --> 00:31:37.195
Quality software. Last updated
and what's that, June 18, 2013.

00:31:37.195 --> 00:31:42.367
Five stars in the search so we
know it's good. This is a little

00:31:42.367 --> 00:31:47.205
bit of the freak theme but kind
of an example of what happens

00:31:47.205 --> 00:31:49.808
when you keep building
technologies upon technologies

00:31:49.808 --> 00:31:53.145
and without taking security into
consideration. These are the

00:31:53.145 --> 00:31:57.582
vulnerabilities for asterisk as
of a few months ago. You can see

00:31:57.582 --> 00:32:00.919
there's one for every category,
denial of service, code

00:32:00.919 --> 00:32:04.623
execution, overflows. You name
it. I like the one, bypass

00:32:04.623 --> 00:32:08.727
something. That's cool. There's
more and you can look into it

00:32:08.727 --> 00:32:12.430
depends on what version you're
running. So this one's actually

00:32:12.430 --> 00:32:16.868
written by a guy called Attack
Terrorist. If he's here, we want

00:32:16.868 --> 00:32:22.808
to buy you a few beers. >> We
want to give you a hug. >> He

00:32:22.808 --> 00:32:26.511
made a cross site scripting
that's against the help module.

00:32:26.511 --> 00:32:29.915
Its basic cross side
scripting that did a pop-up and

00:32:29.915 --> 00:32:34.686
that's real cool, right? Doesn't
work in the Chrome, Firefox is

00:32:34.686 --> 00:32:39.024
honorable to it. I didn't test
[indiscernible] because who runs

00:32:39.024 --> 00:32:44.663
that. We also can be found in a
CBAF, local filing where you

00:32:44.663 --> 00:32:48.200
could pretty much include any
file you wanted to. You can't

00:32:48.200 --> 00:32:52.771
read all files on the system
because some people know that if

00:32:52.771 --> 00:32:56.942
you include PROC slash FD, which
is your file prescriptors you

00:32:56.942 --> 00:33:01.480
can write files and put PHP
filters which can allow you to

00:33:01.480 --> 00:33:06.017
read PHP code. But once you get
LFI asterisk systems, it's just

00:33:06.017 --> 00:33:09.454
one of the ones you can pretty
much go around reading

00:33:09.454 --> 00:33:13.658
configuration files. User.com,
if you can read those, the

00:33:13.658 --> 00:33:17.829
permission is on properly which
will generally on. You can read

00:33:17.829 --> 00:33:21.233
the extensions on there. The
port configuration is great

00:33:21.233 --> 00:33:25.804
because it has your my SQL
password in it and what's going

00:33:25.804 --> 00:33:30.108
in, going out, whats happening
on the network. >> And was that

00:33:30.108 --> 00:33:32.110
authenticated or
unauthenticated? >> This was

00:33:32.110 --> 00:33:38.116
authenticated so you have to be
an admin so you can do the

00:34:01.873 --> 00:34:04.643
functionality anyway if you're
an admin. But it's still a

00:34:04.643 --> 00:34:06.878
vulnerability correct? So
there's also a remote code

00:34:06.878 --> 00:34:09.648
execution. This example though
there is some PHP code into

00:34:09.648 --> 00:34:12.717
shell and then we call that
shell and execute pen test

00:34:12.717 --> 00:34:15.754
monkeys python shell. Pretty
cool. And we have a video for

00:34:15.754 --> 00:34:18.823
that one. So this is the shell
execution. This is also

00:34:18.823 --> 00:34:21.893
authenticated. Space bar once
more. There you go. And here is

00:34:21.893 --> 00:34:25.230
the video. So, you know, I'm on
the server right there. I

00:34:25.230 --> 00:34:28.266
removed the shell, no funny
business going on and this is

00:34:28.266 --> 00:34:30.502
the authenticated again. And its
loading echo [indiscernible]

00:34:30.502 --> 00:34:34.105
bash. It's not rocket science,
but it works so we go back to

00:34:34.105 --> 00:34:37.742
the server and LS again and hey,
there's the shell. So the video

00:34:37.742 --> 00:34:40.812
gets a little funky. There's the
listener. Listener on my local

00:34:40.812 --> 00:34:45.750
host and there's the call to the
shell. >> Sort of anticlimactic

00:34:45.750 --> 00:34:50.188
because it doesn't really do
anything. But bam, right there.

00:34:50.188 --> 00:34:56.661
>> [Indiscernible] So yeah, you
can kind of do whatever you want

00:34:56.661 --> 00:35:04.636
there. So that was cool. And
this makes -- this one gets a

00:35:04.636 --> 00:35:08.840
little tricky so this is using
the same L file we saw earlier

00:35:08.840 --> 00:35:12.777
but we do remote code execution
by reading the asterisk log

00:35:12.777 --> 00:35:20.085
using a SSP message. If I can
read the log maybe I can inject

00:35:20.085 --> 00:35:25.323
something, so play this one. So
again this is authenticated but

00:35:25.323 --> 00:35:27.726
you wouldn't necessarily need to
be authenticated well, you would

00:35:27.726 --> 00:35:32.397
to execute it, the local file
inclusion, but not to submit the

00:35:32.397 --> 00:35:39.070
script to it. So there's your
local file. Read the passwords

00:35:39.070 --> 00:35:46.478
file. I did Prox CPU for fun. [
Indiscernible] Just to make sure

00:35:46.478 --> 00:35:52.083
its working and all that. And
then this is the asterisk log

00:35:52.083 --> 00:35:58.089
refresh that. So there you go.
The next step what we do is this

00:35:58.089 --> 00:36:02.560
is SSP SAC and I just sent a
text message. That's not even a

00:36:02.560 --> 00:36:06.998
valid user by the way thats just
the users dog and you'll see

00:36:06.998 --> 00:36:11.669
that the text message shows up
at the bottom, somewhere. So I

00:36:11.669 --> 00:36:18.043
go ahead and do the PHP in
there. >> So basically injecting

00:36:18.043 --> 00:36:23.048
stuff right into the file. >>
Which you can do with Apache too

00:36:23.048 --> 00:36:29.487
if theres an LFL file in apache.
And then there is your PHP. So

00:36:29.487 --> 00:36:35.460
you can execute a PHP code as
you wish. Next slide. So that's

00:36:35.460 --> 00:36:40.065
cool, but those are
authenticated so what I would do

00:36:40.065 --> 00:36:44.202
is take the unauthenticated
cross side scripting and then

00:36:44.202 --> 00:36:49.274
use the remote code execution
which is authenticated and do a

00:36:49.274 --> 00:36:56.181
phish. So this is the one that
gets kind of, makes me confused.

00:36:56.181 --> 00:37:01.486
It used cross scripting and use
this in height of frame and

00:37:01.486 --> 00:37:07.592
replace the window location with
this base 64 decoded stuff and

00:37:07.592 --> 00:37:13.465
then you do your shell eco in
there and we got a video to show

00:37:13.465 --> 00:37:16.067
this. This one took a little bit
of time to get right. But it

00:37:16.067 --> 00:37:20.305
works. This is the window that's
authentication required and we

00:37:20.305 --> 00:37:24.976
need to press that. And that's
the phish showing that it

00:37:24.976 --> 00:37:29.247
doesn't work, unauthenticated
user so you were going to want

00:37:29.247 --> 00:37:34.753
to send that payload to somebody
you know who has access to the

00:37:34.753 --> 00:37:37.755
system. I can't do it because I
don't have credentials.[

00:37:37.755 --> 00:37:45.196
Indiscernible] This is the
logged-in user and this is phish

00:37:45.196 --> 00:37:51.202
reloader and I did twice just to
make sure it works. What is

00:37:54.873 --> 00:37:59.978
going on here. >> As most people
probably would, they're moving

00:37:59.978 --> 00:38:02.881
their mouse around. >> You
probably changed this so it

00:38:02.881 --> 00:38:10.789
isnt that cheesy but you put
an RF frame. But on the popular

00:38:10.789 --> 00:38:15.393
side its only in the network. Do
the same thing. So there's your

00:38:15.393 --> 00:38:18.863
own and that's from
unauthenticated. That's why it's

00:38:18.863 --> 00:38:22.767
dangerous to, oh, I don't care
about unauthenticated. What

00:38:22.767 --> 00:38:27.539
could you possibly do with it?
Well, you could do something

00:38:27.539 --> 00:38:30.708
pretty malicious. So how do you
defend against this? That's

00:38:30.708 --> 00:38:34.646
really easy for the cross L file
and the execution it's all the

00:38:34.646 --> 00:38:41.352
same. You make an array of what
you want and you... >> You want

00:38:41.352 --> 00:38:45.690
us to sanitize input? >> Yeah.
Don't just say what language do

00:38:45.690 --> 00:38:50.595
you want? Oh, I'm going to try
and read that file now. English,

00:38:50.595 --> 00:38:56.301
French, Spanish, whatever you
want. Don't take anything else.

00:38:56.301 --> 00:38:59.938
So never trust any input from
the end user and it's not the

00:38:59.938 --> 00:39:05.343
end user's fault. It's because
you can't trust bad people. So

00:39:05.343 --> 00:39:10.148
it's more defense. So avoid all
in one distributions. Update

00:39:10.148 --> 00:39:16.421
custom built. It's not hard to
do a custom built if you built

00:39:16.421 --> 00:39:21.726
and you don't build what you
don't know and configure it

00:39:21.726 --> 00:39:26.531
properly. Like some other slides
thorough your firewall. >> All

00:39:26.531 --> 00:39:31.970
right, so fraud and abuse, you
know, my definition was fraud is

00:39:31.970 --> 00:39:34.906
when you have no intention to
pay for using the services that

00:39:34.906 --> 00:39:39.043
you're using, potentially causes
loss damage to the owner,

00:39:39.043 --> 00:39:43.414
enables criminals to make a
profit and, yeah, I guess you

00:39:43.414 --> 00:39:46.985
could say abuse. Manipulative
phone network to do something

00:39:46.985 --> 00:39:51.756
maybe fun or unintended... yeah,
I'm going to skip these for now.

00:39:51.756 --> 00:39:57.695
I had some little Q&As you want
to get to the slide and we want

00:39:57.695 --> 00:40:02.834
to get to the good stuff. So
making money is a top motivation

00:40:02.834 --> 00:40:06.804
for phone fraud. International
revenue sharing fraud is the top

00:40:06.804 --> 00:40:10.375
fraud scheme where you
compromise a phone system and

00:40:10.375 --> 00:40:14.746
make lots of calls to a foreign
destination and the owner of the

00:40:14.746 --> 00:40:17.548
switch at that foreign
destination splits the profits

00:40:17.548 --> 00:40:20.818
with you because of
international telecom revenue

00:40:20.818 --> 00:40:24.422
agreements, phone companies are
forced to pay the peer who

00:40:24.422 --> 00:40:29.160
delivered the call and >> And we
talked about that last year. >>

00:40:29.160 --> 00:40:33.498
Yeah, we talked about it last
year at Sky Talks, caller I.D.

00:40:33.498 --> 00:40:37.135
spoofing or back spoofing which
is a social engineering vector

00:40:37.135 --> 00:40:41.839
where you can make a phone
number that you don't own pop up

00:40:41.839 --> 00:40:46.210
on the caller I.D. display and
it has implications for the name

00:40:46.210 --> 00:40:50.581
that also shows up. We're going
to show a demo of that.

00:40:50.581 --> 00:40:53.818
Telephony denial of service
where you basically just target

00:40:53.818 --> 00:40:57.488
somebody either for purposes of
extortion or just maliciousness

00:40:57.488 --> 00:41:01.159
and keep cramming calls at them.
They can't get a call through.

00:41:01.159 --> 00:41:07.832
>> And the last one was
phishing. >> Yeah, so fraud and

00:41:07.832 --> 00:41:13.671
abuse demo...when a number comes
into your phone, the person

00:41:13.671 --> 00:41:19.043
sending that call doesn't
actually send along the caller

00:41:19.043 --> 00:41:22.513
I.D. display or the "see name"
display. That is actually in a

00:41:22.513 --> 00:41:25.783
database that the phone
companies use and your phone

00:41:25.783 --> 00:41:29.954
company does a dip to the
database and then says hey this

00:41:29.954 --> 00:41:34.792
is what you need to display on
your phone. >> Could be useful.

00:41:34.792 --> 00:41:38.329
>> Yeah. So most companies that
offer SSP trunking do not allow

00:41:38.329 --> 00:41:41.132
you to set the number that
you're sending as part of the

00:41:41.132 --> 00:41:45.603
call. You have to tell them, you
know, this is my phone number or

00:41:45.603 --> 00:41:49.140
they'll assign you the number
and that's all you can send. It

00:41:49.140 --> 00:41:52.043
is useful to be able to send a
different number especially in

00:41:52.043 --> 00:41:56.948
something like a call center but
usually agreements are made so

00:41:56.948 --> 00:42:00.351
that they know what numbers will
be coming through. However some

00:42:00.351 --> 00:42:04.022
smaller providers looking at
terms of service experiment with

00:42:04.022 --> 00:42:07.125
it, you can set the caller I.D.
information on a SSP trunk. And

00:42:09.394 --> 00:42:14.799
by the way it is illegal to
cause loss or damage as part of

00:42:14.799 --> 00:42:19.704
spoofing -- >> Well with an
intent to to cause harm. >>

00:42:19.704 --> 00:42:24.976
While you might not intent to
cause harm if you spoof a law

00:42:24.976 --> 00:42:28.646
enforcement number, I generally
wouldn't recommend it. >> So

00:42:28.646 --> 00:42:33.151
this is how you set caller I.D.
and asterisk with extension.com

00:42:33.151 --> 00:42:38.823
and this is another way this is
used in a project we'll show you

00:42:38.823 --> 00:42:44.662
in a .com file but it is worth
noting. But you have to find a

00:42:44.662 --> 00:42:49.767
provider that will send this so
these are just two ways we have

00:42:49.767 --> 00:42:54.439
used in this demo. >> So, hey,
look who's calling me. >> So

00:42:54.439 --> 00:42:56.641
hey, look whos calling me. So
Im sitting on my couch

00:42:56.641 --> 00:43:02.847
watching Jurassic Park... >> As
you do. (Phone ringing) >>

00:43:02.847 --> 00:43:10.755
Everybody knows who Jeff Moss
is, right? He's the reason why

00:43:10.755 --> 00:43:14.459
we're here. >> That's enough of
that. Lets focus on real

00:43:14.459 --> 00:43:19.630
stuff. Say so I have this
idea that we're sitting around

00:43:19.630 --> 00:43:25.269
the table and we're saying what
if you spoof voice mail? What

00:43:25.269 --> 00:43:29.240
would happen? Would you answer
your phone? I was originally

00:43:29.240 --> 00:43:33.544
thinking if you had your caller
I.D. set to voice mail, would

00:43:33.544 --> 00:43:37.782
people call them back if you
randomly called them. Yeah, so

00:43:37.782 --> 00:43:42.386
we... >> Thinking about it. >>
So and here are some scenarios

00:43:42.386 --> 00:43:48.125
we came up with. >> So you get a
call from your voice mail system

00:43:48.125 --> 00:43:54.765
and it says we have been
acquired. Punch in your security

00:43:54.765 --> 00:43:56.767
number now for security reasons
to listen to this message. >>

00:43:56.767 --> 00:43:59.637
Heres another one, the tech
support fast track. >> Yeah,

00:43:59.637 --> 00:44:01.839
tech support fast track,
exerting your date of birth, you

00:44:01.839 --> 00:44:04.542
know things that you would want
to collect, maybe getting

00:44:04.542 --> 00:44:08.212
through your password challenge.
>> So I created -- it's not

00:44:08.212 --> 00:44:12.183
really an IBI, interactive voice
-- because I punch in the

00:44:12.183 --> 00:44:16.854
number. >> Yeah, as far as IBI
systems go, you just press the

00:44:16.854 --> 00:44:20.124
buttons right? >>So we did
continuous SSP trunk in

00:44:20.124 --> 00:44:24.328
variables PHP and set up a
recording of scenarios we were

00:44:24.328 --> 00:44:28.533
just talking about, create a
target list, a hex list of phone

00:44:28.533 --> 00:44:32.370
numbers or you can go single
number just for fun. Record

00:44:32.370 --> 00:44:36.240
everything and make sure it
works. You can test against your

00:44:36.240 --> 00:44:39.810
local phone number. >> And the
key here is you dial into the

00:44:39.810 --> 00:44:43.347
system. You run the key from
your phone. You designate the

00:44:43.347 --> 00:44:46.717
targets from your phone. >> So
the caller is making the web app

00:44:46.717 --> 00:44:50.521
to do it but the web app -- >>
It's a little more old school

00:44:50.521 --> 00:44:57.628
freaker than just doing it from
a script. >> And they make a web

00:44:57.628 --> 00:45:04.202
app for it just because. So this
is go, press space twice. This

00:45:04.202 --> 00:45:11.309
is kind of what happens when you
dial in. >> Main menu. Menu to

00:45:11.309 --> 00:45:16.380
turn on press start. (beep) >>
Top menu zero [indiscernible]

00:45:16.380 --> 00:45:22.954
after the beep return to main
menu. Press zero. >> Record.

00:45:22.954 --> 00:45:25.990
[Indiscernible] >> Please enter
your password. >>[Indiscernible]

00:45:25.990 --> 00:45:31.062
>> Listen to a special broadcast
from our CEO. For security

00:45:31.062 --> 00:45:36.634
reasons, please enter your voice
mail pin now. Phone number fast

00:45:36.634 --> 00:45:41.706
track verification system is
being rolled out. You must be

00:45:41.706 --> 00:45:47.278
enrolled to the service. Please
enter your date of birth and

00:45:47.278 --> 00:45:51.349
two-digit month, two-digit day
and four-digit year for

00:45:51.349 --> 00:45:56.420
verification now. >> And it
beeps afterwards. >> The top

00:45:56.420 --> 00:46:01.492
menu. [Indiscernible] After the
beep to return to main menu,

00:46:01.492 --> 00:46:08.566
press zero. (beep) >> All right.
You can skip. You get the idea.

00:46:08.566 --> 00:46:14.639
>> Yeah. >> So basically note
that when a call comes into this

00:46:14.639 --> 00:46:20.244
mobile phone, it's showing up as
the voice mail number that's

00:46:20.244 --> 00:46:27.952
already stored in the phone. >>
So we get to the video. >> This

00:46:27.952 --> 00:46:31.689
one starts off really loud.
(Music Playing - Video Starts]

00:46:31.689 --> 00:46:36.594
>> Might want to shut it down a
little bit. Turn it down a

00:46:36.594 --> 00:46:41.098
little bit. [Video Playing] >>
So then you hear when it was

00:46:41.098 --> 00:46:44.135
recording, the we selected...
[Indiscernible] >> That's good.

00:46:44.135 --> 00:46:49.040
So he enters a pin number and
there is the -- it's contour

00:46:49.040 --> 00:46:53.577
based at this point. I just
finished making it so you could

00:46:53.577 --> 00:46:57.515
dial in and it would tell you
and there is the pin number he

00:46:57.515 --> 00:47:02.787
entered. So -- It's cool. Let's
see if it works. So why do we

00:47:02.787 --> 00:47:06.724
care? I was thinking when I read
this oh, you can get people's

00:47:06.724 --> 00:47:10.328
voice mail passwords and you can
get their pins and read their

00:47:10.328 --> 00:47:13.364
voicemails and delete stuff and
apparently there's more risk to

00:47:13.364 --> 00:47:17.268
it. >> You get that pin number
and some voice mail systems will

00:47:17.268 --> 00:47:20.604
let you forward calls, let you
originate calls and make an

00:47:20.604 --> 00:47:23.908
original broadcast to the entire
company. What would you do if

00:47:23.908 --> 00:47:27.845
you had that power? >> You could
also adapt it to get one-time

00:47:27.845 --> 00:47:32.383
passwords or conference in
information. >> Right. So I have

00:47:32.383 --> 00:47:34.919
a bunch of fraud and abuse
defense stuff that you can see

00:47:34.919 --> 00:47:37.254
in the slides. I know we're
running out of time here, but

00:47:37.254 --> 00:47:39.724
one of the things that I really
wanted to point out as part of

00:47:39.724 --> 00:47:42.560
this is if you're trying to
block international numbers,

00:47:42.560 --> 00:47:46.997
those revenue-sharing number,
you cannot just block 0-11 for

00:47:46.997 --> 00:47:50.968
your international dialing codes
at least within the North

00:47:50.968 --> 00:47:54.205
American numbering plan. There
is a lot of Caribbean

00:47:54.205 --> 00:47:57.875
destinations that are also
considered high cost and if you

00:47:57.875 --> 00:48:03.714
look out and it's just a regular
10-digit, a regular U.S. number.

00:48:03.714 --> 00:48:07.818
>> There's some more stuff. >>
Yep. Set pins on long distance

00:48:07.818 --> 00:48:13.190
trunks, et cetera, and -- oh, we
got to that already. Oh, thanks.

00:48:13.190 --> 00:48:19.196
That's a Github. Thanks a lot,
everybody. >> We'll be around.

00:48:24.034 --> 00:48:26.036
[Applause]. 

