00:00:00.934 --> 00:00:03.770
[applause] >> Despite the fact
that Charlie is a Saint Louis

00:00:03.770 --> 00:00:09.776
fan. We will talk about break
into a jeep and doing bad things

00:00:12.346 --> 00:00:16.950
to a jeep. Let's give them a big
hand [ applause ] >> Awesome.

00:00:16.950 --> 00:00:24.024
How's everyone doing. Fantastic.
10 minutes to get the sound on

00:00:24.024 --> 00:00:31.732
that was not nervous racking.
I'm raiser and this is blade. We

00:00:31.732 --> 00:00:38.238
are here to talk about hacking a
car. What this is not. This is

00:00:38.238 --> 00:00:41.341
not going to be every detail we
have. We will drop our 90 some

00:00:41.341 --> 00:00:47.347
pages later. We will go fast and
loose. >> And also don't be

00:00:53.553 --> 00:00:57.824
disappointed the Chrysler
representative will not be

00:00:57.824 --> 00:01:03.764
coming in. >> LL Cool J was our
rep. Psa before we get going on,

00:01:07.534 --> 00:01:13.240
stop saying unhackable. You are
going to look silly and give

00:01:13.240 --> 00:01:19.246
people incentive to look at. >>
You have a control gateway you

00:01:25.986 --> 00:01:31.725
have to go through and
apparently they have found a

00:01:31.725 --> 00:01:34.928
secret way for writing a
software. When they say you

00:01:34.928 --> 00:01:40.934
can't hack it, you can't hack it
unless you can hack the gateway

00:01:50.877 --> 00:01:53.246
then you can hack it. We are
going to go through all the

00:01:53.246 --> 00:01:58.919
wireless vector. Talk about how
we got cellar. Hack a car of a

00:01:58.919 --> 00:02:03.757
cell. And go through some
payloads to do the cool stuff

00:02:03.757 --> 00:02:06.293
and really fast this section
about [ inaudible ] those parts

00:02:06.293 --> 00:02:08.495
while super boring to talk about
still took us three and a half

00:02:08.495 --> 00:02:11.198
months. The whole talk is that.
That's how you go from wireless

00:02:11.198 --> 00:02:14.334
portion to having physical
control. And it's super

00:02:14.334 --> 00:02:16.737
difficult at least for us. >> So
let's talk about why it means to

00:02:16.737 --> 00:02:20.374
even remotely attack a vehicle
and what you need to look for

00:02:20.374 --> 00:02:26.380
and that sort of thing. The
first thing you need remote

00:02:38.959 --> 00:02:46.366
attack or cold running on it
somehow. Look at the attack

00:02:46.366 --> 00:02:52.372
service on the vehicle. Most
vehicles will have these attack

00:02:55.942 --> 00:03:01.882
service. Hooked up through
cellar, bluetooth or apps. You

00:03:04.518 --> 00:03:09.456
are actually have a little chip
key talking back and forth to

00:03:09.456 --> 00:03:15.462
the receiver of the car. Tpm,
and some cars it's wifi hot

00:03:19.332 --> 00:03:24.404
spot. >> When people think
remotely hacking a car. That's

00:03:24.404 --> 00:03:27.274
how you get in. We will show you
that's really one small step in

00:03:27.274 --> 00:03:33.280
a whole series of events. >> So
what's next? The part the heart

00:03:38.251 --> 00:03:44.257
of getting the code and talk to
the can network that's where the

00:03:47.828 --> 00:03:54.334
network of the car lives. Step
three is figuring out can

00:03:54.334 --> 00:03:57.304
message to send to make it do
physical stuff. Every vehicle

00:03:57.304 --> 00:04:01.875
manufacturer will have different
messages you have to figure that

00:04:01.875 --> 00:04:07.447
out. The thing to care about the
abs system the transmission and

00:04:07.447 --> 00:04:11.918
other stuff that you eventually
want to control. We heard you

00:04:11.918 --> 00:04:14.688
can buy these databases you buy
a car, look for sniffer that's

00:04:14.688 --> 00:04:19.759
what you need to do. >>
Shockingly they wouldn't sell

00:04:19.759 --> 00:04:25.766
that to us. And you send the
messages. You only need 1 car

00:04:35.342 --> 00:04:39.746
and the messages will work for
other cars. When you send the

00:04:39.746 --> 00:04:47.120
messages if the car has more
advanced feature, more things

00:04:47.120 --> 00:04:54.494
you can control. Jam on the
brake, self-park whatever. >>

00:04:54.494 --> 00:05:00.433
That's why we pick the self-park
cars. >> Let's talk about the

00:05:03.270 --> 00:05:09.276
car we have. >> So the car was a
white 2014 Jeep Cherokee. >>

00:05:13.580 --> 00:05:19.586
This is a car in unfortunate
situation where the brake is not

00:05:22.422 --> 00:05:28.428
working. The brake lights are on
but not braking. >> Hamam known

00:05:31.264 --> 00:05:37.270
for speakers. You connect the
system from this car from them.

00:05:39.339 --> 00:05:45.345
They make killer speakers. >>
You see what I did there. >>

00:05:48.181 --> 00:05:54.621
Killer speakers. >> If you buy
one of these or few like we did,

00:05:54.621 --> 00:06:01.361
we rip them apart. If you look
at the board inside, connected

00:06:01.361 --> 00:06:06.900
to the lcd portion. The a 55 r
zero it has a carrier printed on

00:06:06.900 --> 00:06:12.906
it. The other section had a
renaissance 530 when dealing

00:06:21.248 --> 00:06:26.820
with can control. If you looked
at this board, hey, there's air

00:06:26.820 --> 00:06:32.926
between these two section. That
would be air gap by definition.

00:06:32.926 --> 00:06:38.932
But that's not essentially true.
>> We are currently air gapped.

00:06:42.502 --> 00:06:48.508
>> So you connect the system.
Chip runs arm. 32 bits. The

00:06:51.244 --> 00:06:57.250
operating system is qnx. Command
like, it's an environment we are

00:06:59.953 --> 00:07:07.127
comfortable working in. There's
a bunch of different chips,

00:07:07.127 --> 00:07:12.132
different operating type system
on this thing it's not one os

00:07:12.132 --> 00:07:18.138
with one chip. So we jail broke
the jeep. We showed that last

00:07:20.840 --> 00:07:27.147
year. The main purpose of doing
this was exploit the system.

00:07:27.147 --> 00:07:31.451
This is not needed. I repeat not
for the remote stuff needed this

00:07:31.451 --> 00:07:33.920
time but if you want to
investigate the system you want

00:07:33.920 --> 00:07:40.160
to have a live example, jail
brake it, shell. >> We will show

00:07:40.160 --> 00:07:45.999
you how to remotely brake these
cars. No physical access needed.

00:07:45.999 --> 00:07:49.402
On your own car you can do this.
Stick in super special usb

00:07:49.402 --> 00:07:55.008
stick, upgrade. >> It doesn't
really say jail broken. >> Next

00:07:55.008 --> 00:07:58.511
step is wifi. Am I doing this
particular car and other cars

00:07:58.511 --> 00:08:03.116
that have the system offer hot
spot capability. And this is

00:08:03.116 --> 00:08:09.122
something you can turn on and
it's like the default is wpa 2

00:08:18.064 --> 00:08:22.535
and you can talk to it. It's
super cool. If you are jamming

00:08:22.535 --> 00:08:28.174
down the road and be online. >>
When we were doing the research

00:08:28.174 --> 00:08:34.114
I can get on twitter and online
stuff. >> I'll be driving on

00:08:34.114 --> 00:08:39.552
hallway and on twitter. >> It's
great. It's the future. >> It

00:08:39.552 --> 00:08:44.224
was the future. Anyway so that
was our first plan of attack was

00:08:44.224 --> 00:08:49.362
go after the wifi. Why get wifi,
I don't know how wireless tire

00:08:49.362 --> 00:08:55.168
pressure censer works. I have no
idea. If you could attack the

00:08:55.168 --> 00:08:59.639
wifi portion it's not that cool
because it's not own by default.

00:08:59.639 --> 00:09:03.510
You have to pay and it's quite
expensive. $35 a month. So most

00:09:03.510 --> 00:09:09.149
people will not have that on.
And even if they do, you have to

00:09:09.149 --> 00:09:13.586
figure out how to join the
network. It's random p h2

00:09:13.586 --> 00:09:19.592
password. Not easy to get on. >>
I so I paid this. >> We are

00:09:25.031 --> 00:09:32.639
taking donation. Charlie needs
$350. >> I'm the only one.

00:09:32.639 --> 00:09:38.645
Whenever I have problem I would
call. And they would say oh, Mr.

00:09:42.549 --> 00:09:49.656
Miller. You can look at this
code and if you read it, it

00:09:49.656 --> 00:09:57.297
tells time and gets random
values. Figures out the link 8

00:09:57.297 --> 00:10:04.471
to 12 password and pix random
ascii passwords. That's random.

00:10:04.471 --> 00:10:10.243
Hard to guess at. But it is
seeded on the time. If you know

00:10:10.243 --> 00:10:16.850
what second it's seeded on, so
you can get an idea of what

00:10:16.850 --> 00:10:22.956
started on. >> The car 2014 so
you would assume it's made

00:10:22.956 --> 00:10:27.360
before that and after 2012.
Limited space. >> Right. When

00:10:27.360 --> 00:10:33.366
you first turn it on, you get
some idea. And you can do the

00:10:35.902 --> 00:10:40.473
math and figure out that if you
start to figure out how

00:10:40.473 --> 00:10:44.110
passwords are based on the time
it's based on 15 million, 7

00:10:44.110 --> 00:10:47.113
million guesses. And if you know
what you are doing which we

00:10:47.113 --> 00:10:53.753
don't. You can imagine doing
this in about an hour. Attack,

00:10:53.753 --> 00:11:01.394
cruising on a hallway, you spot
a jeep. >> Super creepy. >> So

00:11:01.394 --> 00:11:07.300
then if you eventually join the
network and if there's

00:11:07.300 --> 00:11:14.407
vulnerability you can attack it.
>> I feel bad driving green bird

00:11:14.407 --> 00:11:20.413
off the road. >> So there are
other ways to do a lot easier.

00:11:22.715 --> 00:11:28.855
Here's a code to show what to do
when you try to figure out what

00:11:28.855 --> 00:11:32.158
time it is. When it's first on,
you don't know what time it was.

00:11:32.158 --> 00:11:38.164
That's the chip that talks to
the cellar connection. So they

00:11:40.466 --> 00:11:46.005
can get the time accurately
through cell tower. If there's a

00:11:46.005 --> 00:11:52.178
code if that fails and I don't
know the time that this other

00:11:52.178 --> 00:11:58.885
network I just default to
January 1, 2013. Some I looked

00:11:58.885 --> 00:12:06.159
at my password and head unit,
please don't join mine. And you

00:12:06.159 --> 00:12:11.931
can figure out what time it
corresponds to. It turns out

00:12:11.931 --> 00:12:16.936
that time correspond January 1,
201332 seconds after that. >> So

00:12:16.936 --> 00:12:20.740
you can imagine car factory,
coming out the same time. Most

00:12:20.740 --> 00:12:24.410
of them, limited set of
passwords that you need to try

00:12:24.410 --> 00:12:30.416
if anyone didn't reset it. >> So
when you turn the car on it took

00:12:34.253 --> 00:12:38.257
32 seconds for the wifi to come
on. Set the password, I don't

00:12:38.257 --> 00:12:44.263
know. January 1, so ten or 20
passwords you can expect. So you

00:12:48.868 --> 00:12:53.973
can join the wifi network the
problem is no one has it on

00:12:53.973 --> 00:12:58.911
except for me. Nonetheless we
will continue on let's say if

00:12:58.911 --> 00:13:04.350
you could join what can you do
something bad. Wifi is better

00:13:04.350 --> 00:13:12.225
than connected. So we are making
progress. You will see some open

00:13:12.225 --> 00:13:18.231
ports. Some are in the paper.
They are mostly crazy stuff. But

00:13:20.433 --> 00:13:26.439
really cool is they are irc
server. It's something called

00:13:33.479 --> 00:13:40.053
debus. So debus is important 167
on all these vehicles it's an

00:13:40.053 --> 00:13:44.957
inner process communication, the
idea is one process sends

00:13:44.957 --> 00:13:51.064
message on other process and it
does that. >> These can require

00:13:51.064 --> 00:13:54.967
authentication but on jeep it
allows anonymous connections and

00:13:54.967 --> 00:13:58.971
ipc stuff. So we used a program
called defeat, which is a gui.

00:13:58.971 --> 00:14:06.312
And debug python for writing all
out scripts and stuff like that.

00:14:06.312 --> 00:14:14.153
>> Just in print it seems like
it's a bad idea. >> Seems not

00:14:14.153 --> 00:14:21.394
the best idea. >> It's not
design for outside thing to be

00:14:21.394 --> 00:14:28.634
talking to it. So we were pretty
sure that we could find

00:14:28.634 --> 00:14:35.875
something here. If you load the
dv program, list on the side

00:14:35.875 --> 00:14:43.116
services available. Dot service.
Dot tuner and so on. For each of

00:14:43.116 --> 00:14:49.422
these there are certain methods
you can call. It will give you

00:14:49.422 --> 00:14:51.557
all these methods. And you'll
see things like for the service

00:14:51.557 --> 00:14:58.531
come there's a method called
view black screen or screw

00:14:58.531 --> 00:15:00.466
dtvhmiq and stuff. >> There's
everything. >> There's a huge

00:15:00.466 --> 00:15:02.835
attack services available. >> We
sure hope so. >> And there was.

00:15:02.835 --> 00:15:05.004
These services and methods and
stuff are backed by lua script

00:15:05.004 --> 00:15:07.774
and I have to learn that. The
first thing I look for is there

00:15:07.774 --> 00:15:09.776
a memory corruption. >> Memory
corruption, it's hard. Let's go

00:15:09.776 --> 00:15:11.778
shopping and that means lua. >>
We look at command-line

00:15:11.778 --> 00:15:13.946
instruction first. We found
several. So this is one if you

00:15:13.946 --> 00:15:16.315
are trying to remove a track
from that, I think it's for

00:15:16.315 --> 00:15:18.684
navigating. If you pass a file
name, if you say please remove

00:15:18.684 --> 00:15:20.853
the track semicolon. >> So we
ran that quick looking for

00:15:20.853 --> 00:15:22.855
command-line injection. There
were so many of them. We have

00:15:22.855 --> 00:15:25.224
one. So theoretically we can
attack this thing. >> So if you

00:15:25.224 --> 00:15:27.794
can join wifi network through
this you can do it, but -- so

00:15:27.794 --> 00:15:30.196
anyway I was like super proud.
I've been a computer hacking for

00:15:30.196 --> 00:15:32.198
15 years. I knew there was
command-line injection. I kept

00:15:32.198 --> 00:15:34.600
looking for more methods called
execute. Execute stuff. So this

00:15:34.600 --> 00:15:40.606
method takes in parameter and
that parameter is shell command

00:16:23.282 --> 00:16:29.288
you want to execute. >> So if
you look below four line python

00:17:07.393 --> 00:17:12.598
script that's 4 line of python.
We thought we have to do

00:17:12.598 --> 00:17:18.604
something super cool. Give hand
to python [ applause ] And if

00:17:21.874 --> 00:17:27.880
you see in python script, net
cat it was already on there.

00:17:31.150 --> 00:17:39.125
It's great. >> Just to show what
talented speaker we are. Here's

00:17:39.125 --> 00:17:46.098
a screenshot from our talk last
year on remote attack services.

00:17:46.098 --> 00:17:53.806
That's actually the
vulnerability of this year's

00:17:53.806 --> 00:18:00.046
talk. This is accidental
disclosure. >> I don't know what

00:18:00.046 --> 00:18:04.517
the terms are these days. >> If
you are on the wifi network, if

00:18:04.517 --> 00:18:08.354
they paid for it, and join, you
can get code running on their

00:18:08.354 --> 00:18:14.360
head unit. What can you do,
Chris. >> We wrote a thing

00:18:16.696 --> 00:18:23.336
called gps 3000. It tracks gps.
It's got the car to spit out gps

00:18:23.336 --> 00:18:29.008
coordinates. Web server and
upload google map. And I tell

00:18:29.008 --> 00:18:31.877
when Charlie is going faster, or
slower, and put on the nice map

00:18:31.877 --> 00:18:37.883
package that up and sell to NASA
and track everyone in here. >>

00:18:49.061 --> 00:18:53.566
In the complex of that he's no
problem tracking me but not

00:18:53.566 --> 00:18:59.572
drive next to me. This is not
like we get code running and

00:19:04.777 --> 00:19:08.347
inject something in the process,
this is just into this

00:19:08.347 --> 00:19:14.353
unauthenticated rtp service. >>
This is like hey, where are you?

00:19:17.023 --> 00:19:23.029
Here I am. >> This is the
feature of debug. >> We can do

00:19:28.067 --> 00:19:34.073
other stuff. You can just turn
it on. Pass a number and it

00:19:38.310 --> 00:19:44.316
goes. Additionally, you can turn
the radio and volume up. [ video

00:19:49.321 --> 00:19:54.427
] >> Nothing. No wires. No
computers. Hey, Charlie give

00:19:54.427 --> 00:19:59.698
this car some style. Change the
channel for me, if you could.

00:19:59.698 --> 00:20:05.704
There's some hip-hop. Turn that
up. >> It's so loud that you

00:20:25.591 --> 00:20:30.896
can't even hear yourself
thinking in the car [music

00:20:30.896 --> 00:20:36.669
playing]. >> So he turns it off.
It goes back to normal. >> Hot

00:20:36.669 --> 00:20:44.643
103 it is. >> So that's what you
can do through the radio. We

00:20:44.643 --> 00:20:46.645
haven't talk about physical
control. You can't do it yet. It

00:20:46.645 --> 00:20:53.152
takes more work. We were jazzed
but you still need to do with

00:20:53.152 --> 00:21:00.659
joining wifi. Can you do this
with other interface instead.

00:21:00.659 --> 00:21:06.665
Other services actually bound to
other interfaces not just wifi

00:21:09.268 --> 00:21:14.507
ones. So maybe we can do it over
cellar. First thing first, to

00:21:14.507 --> 00:21:20.513
see we can do it we need to find
out the jeep ipo address is and

00:21:24.750 --> 00:21:30.756
see if we can talk to it. Ip
address is on the sprint

00:21:33.092 --> 00:21:40.766
network. And the other is at
internet. >> If this jeep is

00:21:40.766 --> 00:21:48.440
connected to your web server. >>
The first thing is the cell

00:21:48.440 --> 00:21:56.148
tower will block access. >> I
tried to buy but it's register

00:21:56.148 --> 00:22:02.087
add stolen. I had to sign up for
sprint contract to get another

00:22:04.390 --> 00:22:10.396
cell I can use. >> So once we
are on the sensor cell. We can

00:22:13.999 --> 00:22:20.005
actually talk to that port, 687.
This is like a huge win. Now we

00:22:23.142 --> 00:22:28.714
don't need to talk over this
wifi. Every car is on has an ip

00:22:28.714 --> 00:22:35.654
address and cellar turned on. >>
You may not even know you have

00:22:35.654 --> 00:22:39.592
it, it's on. The cool thing is
only thing we have to change in

00:22:39.592 --> 00:22:43.929
the exploit is ip. Doing it over
cellar instead of wifi. The same

00:22:43.929 --> 00:22:49.134
python but now we need on the
cellar. There was no

00:22:49.134 --> 00:22:55.140
re-factoring, our test case were
good and no additional

00:22:55.140 --> 00:22:59.178
regression were needed. >> So
cool it's working on that. I

00:22:59.178 --> 00:23:05.117
tried on my cell phone from the
same cell tower. So that thing

00:23:08.220 --> 00:23:15.261
we bought, throw into garbage.
>> The sprint contract, don't

00:23:15.261 --> 00:23:21.267
need it. >> So let's see,
probably we were on the same

00:23:23.669 --> 00:23:29.675
cell tower, it might block it if
it's different tower. So I drove

00:23:32.811 --> 00:23:38.817
far. >> I don't know. >> So
Chris tries it from Pittsburgh.

00:23:41.921 --> 00:23:49.662
>> From the windows' phone. >>
He's making excuse. So he tried

00:23:49.662 --> 00:23:58.437
from Pittsburgh. Doesn't work.
There's some sort of, the amount

00:23:58.437 --> 00:24:04.677
of car you can attack less than
Pittsburgh and within certain

00:24:04.677 --> 00:24:16.655
range. You turn your car on and
you start driving. An hour away

00:24:16.655 --> 00:24:23.095
from house, I tried, and still
works. If you notice some people

00:24:23.095 --> 00:24:29.635
gassing up there, we are hacking
the cars. It still works. >> Can

00:24:29.635 --> 00:24:42.748
you try computing better? I was
doing from the phone with some

00:24:42.748 --> 00:24:47.653
shit from windows phone. Instead
I had to pay more money to

00:24:47.653 --> 00:24:56.528
sprint to make the hot spot
work. I can test Charlie's car

00:24:56.528 --> 00:25:06.839
from Pittsburgh and we found out
later nationwide. >> So now you

00:25:06.839 --> 00:25:10.275
can hit any car on this
vulnerable port from the whole

00:25:10.275 --> 00:25:18.450
country. Way better than wifi.
So that was fun. And a little

00:25:18.450 --> 00:25:25.591
scary. By then we had told
Chrysler about this. They didn't

00:25:25.591 --> 00:25:29.828
tell us how many cars out there.
So let's find this for

00:25:29.828 --> 00:25:40.839
ourselves. >> So we start mask
scan was really good. Basically

00:25:40.839 --> 00:25:46.145
we saw that every time the car
booted up it was on one or two

00:25:46.145 --> 00:25:50.749
class a. 21.25. So we started
scanning those things. >> Either

00:25:50.749 --> 00:25:56.722
thousands on sprint network or a
lot of vulnerable cars. So then

00:25:56.722 --> 00:26:06.899
remember debug service it's just
like a web server. We made a

00:26:06.899 --> 00:26:13.839
couple requests for these cars.
Every time you turn on your car,

00:26:13.839 --> 00:26:19.845
maybe it's just like five cars
some dude [ inaudible ] so we,

00:26:19.845 --> 00:26:26.351
you can get gps info like you
have described on the tracker

00:26:26.351 --> 00:26:29.288
and vin number. That's technique
you can start figuring out how

00:26:29.288 --> 00:26:34.960
many cars there are. So we built
one scanner called "shut up

00:26:34.960 --> 00:26:45.337
dave." So dave likes to talk
about junk hacking. It's so

00:26:45.337 --> 00:26:57.749
easy. No impact. So shut up
dave. It's a scanner. It looks

00:26:57.749 --> 00:27:03.455
up the vin to see what kind of
car it is. And then you find

00:27:03.455 --> 00:27:09.928
other vulnerable cars. Here's
the cars that we found on the

00:27:09.928 --> 00:27:15.634
internet that were vulnerable to
this particular attack. >>

00:27:15.634 --> 00:27:29.815
Anything from dodge viper to
your pedestrians Chrysler 200.

00:27:29.815 --> 00:27:38.624
>> It took all 7 white hat not
to hit a viper. I didn't do it

00:27:38.624 --> 00:27:48.233
because we are ethical. At the
time Chrysler told us it was

00:27:48.233 --> 00:27:58.143
only 2014. >> So we tried to
figure out how many vehicles

00:27:58.143 --> 00:28:03.048
were out there. >> So one day I
was out running and we should

00:28:03.048 --> 00:28:08.654
figure out based on repeat of
vins we see. If we see tons of

00:28:08.654 --> 00:28:12.858
vehicles and they are almost all
duplicates of each other, if you

00:28:12.858 --> 00:28:18.163
don't see duplicates there's
ton. There must be formula for

00:28:18.163 --> 00:28:25.470
this. I googled. Biologist had
something to track owl. So the

00:28:25.470 --> 00:28:40.686
population. So our estimate to
be 400 thousand. >> Which we

00:28:40.686 --> 00:28:45.657
were way off and there's 1.4
million. >> So the owl thing

00:28:45.657 --> 00:28:52.965
didn't work very well. >> But we
want to be conservative with our

00:28:52.965 --> 00:28:59.738
estimate. >> At this point we
can do stuff on the radio and we

00:28:59.738 --> 00:29:08.347
should be ready to go. >> Not
the case. >> From this diagram.

00:29:08.347 --> 00:29:11.049
>> I made this diagram and now I
have to call myself a lier. The

00:29:11.049 --> 00:29:18.190
radio does stuff the both can
buzz and community with the

00:29:18.190 --> 00:29:22.060
outside world. You have to get
on the o mass chip. How do you

00:29:22.060 --> 00:29:30.702
physically control this car? The
air gap was an air gap with a

00:29:30.702 --> 00:29:43.081
spy line serial line between it.
So all the car that we've ever

00:29:43.081 --> 00:29:48.453
talked about there's always
separation. When car company

00:29:48.453 --> 00:29:53.659
says, our entertainment tell mac
system is separate. They mean

00:29:53.659 --> 00:30:01.133
that it's going to take two
steps. >> It's two separate chip

00:30:01.133 --> 00:30:05.971
but not actually separate. >>
From the o mac chip you can't

00:30:05.971 --> 00:30:13.645
send the information. >> Or we
gave up. >> I'll state it's

00:30:13.645 --> 00:30:20.752
impossible. But it can relay
information. Hey, you know that

00:30:20.752 --> 00:30:25.057
5th can message, send that one.
But not send arbitrary one. >>

00:30:25.057 --> 00:30:32.397
You look at the stuff and
architecture and figure out

00:30:32.397 --> 00:30:37.636
maybe you can update the
firmware on this. Luckily for us

00:30:37.636 --> 00:30:42.808
we knew it existed, you can
download. >> When you get the

00:30:42.808 --> 00:30:49.648
usb stick to update your car, it
can update wa 50 chip. O map

00:30:49.648 --> 00:30:57.155
chip can update the a 50 chip.
>> And on the head unit there's

00:30:57.155 --> 00:31:02.327
ioc update it takes firmware
image. There's no code signing.

00:31:02.327 --> 00:31:17.309
Maybe you backdoor. Do whatever.
>> So we backdoor it. You can

00:31:17.309 --> 00:31:24.883
talk to it and send messages. >>
The next is reading data sheet

00:31:24.883 --> 00:31:31.056
for data sheets on data sheets.
You get that firmware you want

00:31:31.056 --> 00:31:39.464
to look at, find base address,
create segments. So this took a

00:31:39.464 --> 00:31:42.400
really, really long time. We are
breezing through it because the

00:31:42.400 --> 00:31:47.405
paper covers it and nobody wants
to watch screenshots. We

00:31:47.405 --> 00:31:56.114
eventually found out here is
where you can send can messages.

00:31:56.114 --> 00:32:04.055
You can send the can message.
All the code region do that but

00:32:04.055 --> 00:32:11.563
there's no region to call o map
chip. We found spy parser and

00:32:11.563 --> 00:32:21.106
over wrote that code to jump
over and down to handwritten

00:32:21.106 --> 00:32:25.577
shellcode that would take chip
from spy line and interpret them

00:32:25.577 --> 00:32:31.850
as can messages and sends them
to can bus. >> On the side. We

00:32:31.850 --> 00:32:41.560
cough still gotten arbitrary
code. >> There's bunch of he did

00:32:41.560 --> 00:32:47.766
not shellcode that we wrote. Put
in rom. And that way we can

00:32:47.766 --> 00:32:56.775
command on spy and send
arbitrary can command. >> It's

00:32:56.775 --> 00:33:03.982
not design to update and drive
around. It's supposed to be

00:33:03.982 --> 00:33:11.690
people hitting stuff. It's all
in the paper. I wasn't perfect

00:33:11.690 --> 00:33:15.460
if you screw up the flash, the
second chip, you are under to

00:33:15.460 --> 00:33:23.501
the dealer. >> Luckily we bought
the car brand new so under

00:33:23.501 --> 00:33:29.841
warranty. Customer service was
amazing. >> I never lied to

00:33:29.841 --> 00:33:38.049
them. The screen doesn't turn on
anymore. >> That's true. Because

00:33:38.049 --> 00:33:45.056
I broke the firmware. >> They
say we will start over a couple

00:33:45.056 --> 00:33:52.497
of times. And we know that's not
going to work. >> Disconnect the

00:33:52.497 --> 00:33:58.570
battery. Anyway, couple of
mistakes and couple times at the

00:33:58.570 --> 00:34:04.209
dealer but it's all good. So
we've gave you all the pieces to

00:34:04.209 --> 00:34:13.852
do that. Let's go over it again.
First, you find ip address for a

00:34:13.852 --> 00:34:17.589
jeep. If you would want to find
on your girlfriend's jeep,

00:34:17.589 --> 00:34:26.765
that's harder. You tether to a
sprint phone and exploit the o

00:34:26.765 --> 00:34:39.844
map chip. >> You spend three
months rewrote. >> You only have

00:34:39.844 --> 00:34:51.623
to do that one time. And then tm
messages. This isn't actually in

00:34:51.623 --> 00:34:55.860
Greenberg. He was in crash zone.
Let's see what this looks like

00:34:55.860 --> 00:35:02.233
in its full glory. That's
computer hacking right there. So

00:35:02.233 --> 00:35:15.113
you'll look right now the
exploit is running, download the

00:35:15.113 --> 00:35:26.625
modified firmware. Flashing the
chip. The screen goes black. So

00:35:26.625 --> 00:35:38.903
you wait. And go for it. There.
Now, it's rebooting. [

00:35:38.903 --> 00:35:52.150
overlapping video audio ] >>
Right now that's over the air

00:35:52.150 --> 00:35:53.952
firmware update, and mitigate
the car and send can messages.

00:35:53.952 --> 00:35:57.389
>> Hold on. I'm going to hit
hack and another hack. It didn't

00:35:57.389 --> 00:36:00.258
work. Put that on csn cyber.
They should. So there. >> And

00:36:00.258 --> 00:36:10.568
then windshield wipers go. >>
Now you may applaud. >> Another

00:36:10.568 --> 00:36:12.937
thing to notice there's snow on
the ground. It's not a

00:36:12.937 --> 00:36:26.751
hack-a-thon. We are responsible.
>> The mechanics tool cost us

00:36:26.751 --> 00:36:38.663
$7 --> 000. It was all java. There
was encrypted fails. Luckily it

00:36:38.663 --> 00:36:45.637
was java. They use awesome
password. So that's how decrypt

00:36:45.637 --> 00:36:59.851
their file. The fouls lesson
learn if you are putting that

00:36:59.851 --> 00:37:02.821
stuff on the mechanics's
computer, it will always figure

00:37:02.821 --> 00:37:11.096
out. In the paper it says the
commercial they use. >> That's

00:37:11.096 --> 00:37:17.702
not going to stand out. >> Come
sum, we didn't know what they

00:37:17.702 --> 00:37:23.408
did. When you don't know, you
reverse engineering. You put in

00:37:23.408 --> 00:37:34.319
c, python, and that's what you
do. Now you can send messages by

00:37:34.319 --> 00:37:41.292
putting our own data bytes in
them. Now we can at arbitrary

00:37:41.292 --> 00:37:45.730
volume. Et cetera. You need to
figure this out if you want to

00:37:45.730 --> 00:37:49.834
send can messages on the bus. >>
We know passwords authenticating

00:37:49.834 --> 00:38:01.179
it. We need to figure out what
message to send. Last talk we

00:38:01.179 --> 00:38:10.255
did pre-collision system to
engage. We piled a bunch of box.

00:38:10.255 --> 00:38:20.165
Resend them later to get the
brake engage. >> And this is car

00:38:20.165 --> 00:38:29.007
hacking. The engagement did not
engage. >> After the talk people

00:38:29.007 --> 00:38:38.249
said that system will engage
only when it's metal. So you set

00:38:38.249 --> 00:38:50.195
your trash canna empty parking
lot. But the problem is random

00:38:50.195 --> 00:38:58.570
people walking by. So we found
another place slightly more

00:38:58.570 --> 00:39:08.479
abandon. And we did it again. So
the camera cuts out here for

00:39:08.479 --> 00:39:13.318
some reason which you will find
out. Notice how fast we came

00:39:13.318 --> 00:39:20.658
around this corner. This is in
front of a school. Charlie's kid

00:39:20.658 --> 00:39:22.861
school. I send a lot of money to
send my kid to school. And you

00:39:22.861 --> 00:39:31.202
will see why the camera blocked.
[ video ] Pre-collision system

00:39:31.202 --> 00:39:45.850
does not work with metal trash
can. The camera was destroyed.

00:39:45.850 --> 00:39:53.024
So now we know, we got the
messages different way. We start

00:39:53.024 --> 00:40:03.768
to do stuff. And that's our lua
script looks like. So we can do

00:40:03.768 --> 00:40:10.108
things like turn on the spray,
wind shield wiper turns on. And

00:40:10.108 --> 00:40:20.051
you can do things like turn
signal. Speedometer. Going 70, I

00:40:20.051 --> 00:40:25.623
make it say 40. I swear I'm
going 40 miles an hour. I

00:40:25.623 --> 00:40:32.196
literally have video that I was
not speeding, officer. You can

00:40:32.196 --> 00:40:47.946
do the locks. Charlie locked the
car. And over the cell, hacked

00:40:47.946 --> 00:40:53.518
it, unlock the door. I figured
Charlie bought my coffee. And

00:40:53.518 --> 00:41:01.025
then I stole everything from the
car as well. You send the

00:41:01.025 --> 00:41:11.769
message to make the transmission
stop working. The gear indicator

00:41:11.769 --> 00:41:22.780
light is blinking which it
shouldn't. Anyway I'm stuck. So

00:41:22.780 --> 00:41:30.588
there are other kinds of
messages you can send. Let's

00:41:30.588 --> 00:41:32.423
just watch the movie. >>
Everyone loves movie. >> There's

00:41:32.423 --> 00:41:45.203
brake. But it's not going to
work. So when we were driving we

00:41:45.203 --> 00:41:49.007
don't line up with a ditch. We
haven't be able to do that

00:41:49.007 --> 00:41:56.581
speed. There's more details
about how to send more

00:41:56.581 --> 00:42:03.454
complicated stuff on the can
network. >> Wend messages and

00:42:03.454 --> 00:42:08.393
only get the messages and
there's no arguing sending the

00:42:08.393 --> 00:42:11.062
right stuff. >> The other one,
it listens to who was loudest.

00:42:11.062 --> 00:42:26.844
Chris was always the loudest.
Here me. And Chris watching. >>

00:42:26.844 --> 00:42:35.520
You can see the granularity of
the control. Parallel park it.

00:42:35.520 --> 00:42:51.803
There it is. >> I missed. We are
almost done. >> Braking again.

00:42:51.803 --> 00:43:04.415
We had preconditions. We already
did this once before with cars.

00:43:04.415 --> 00:43:14.325
>> Here's the brakes go off. So
we are super responsible. We

00:43:14.325 --> 00:43:24.302
disclosed everything. We
disclose in October. Super

00:43:24.302 --> 00:43:32.477
coincidence and recall happened
on that same day. >> We made to

00:43:32.477 --> 00:43:36.113
organizations that were not
working well. But this forced

00:43:36.113 --> 00:43:46.023
them to work together. >> Recall
stuck but when you block on

00:43:46.023 --> 00:43:56.767
sprint, no car is vulnerable. We
found this on internet, it's a

00:43:56.767 --> 00:43:59.937
rendition or recreation of us
disclosing to Chrysler in a

00:43:59.937 --> 00:44:09.213
boardroom. [ video ] >> I am
super pissed and those guys

00:44:09.213 --> 00:44:18.823
looked super scary. We tried to
test on more cars. Our friends

00:44:18.823 --> 00:44:29.133
wouldn't let us borrow their
jeep. >> Awesome job. This is

00:44:29.133 --> 00:44:33.804
what hacking and getting things
fix is all about. >> As of right

00:44:33.804 --> 00:44:41.679
now we can't hack these cars. On
the wifi you can't no longer buy

00:44:41.679 --> 00:44:46.751
wifi from rip off place for $30
if your car is not updated with

00:44:46.751 --> 00:44:51.989
the patch. So no car is
vulnerable. That's what we want

00:44:51.989 --> 00:45:01.098
[ applause ] >> Impact, recall
has ever been done this big.

00:45:01.098 --> 00:45:04.502
Hacker makes a difference this
is a cool time to be part of

00:45:04.502 --> 00:45:10.508
this. You can effect government,
business and not just tech

00:45:10.508 --> 00:45:15.112
companies or info sec companies.
>> This legislation was

00:45:15.112 --> 00:45:21.018
introduced the same day wire
video. >> Sometimes you can make

00:45:21.018 --> 00:45:24.088
a company drop $40 million in
market cap in a afternoon. If we

00:45:24.088 --> 00:45:30.161
were lessen we would have short
it. >> We didn't. The point is

00:45:30.161 --> 00:45:36.367
that they are not going to
listen to us but they are going

00:45:36.367 --> 00:45:39.604
to listen to stakeholders when
they are losing money. Those

00:45:39.604 --> 00:45:49.647
kind of bug don't do anything to
stock guy. >> And they will

00:45:49.647 --> 00:45:56.220
follow you on twitter after the
article. >> So if you want one

00:45:56.220 --> 00:45:58.990
more twitter follower, hack a
car, and that company will

00:45:58.990 --> 00:46:06.998
follow you. >> Hacker needs to
hack but now we can make a

00:46:06.998 --> 00:46:12.703
difference in other sectors that
isn't ours. Hackers make a

00:46:12.703 --> 00:46:16.607
difference. Everyone give
yourself a round of applause to

00:46:16.607 --> 00:46:19.343
be in the industry for changing
the world. [ applause ] >>

00:46:19.343 --> 00:00:00.000
Thanks

