00:00:00.567 --> 00:00:04.004
All right. Good afternoon.
Speaking about audience

00:00:04.004 --> 00:00:07.808
participation and the audience
helping out, I want to thank

00:00:07.808 --> 00:00:11.144
everybody that's been here this
week so cooperative. New hotel

00:00:11.144 --> 00:00:15.382
and new challenges. It was great
to have everybody being so

00:00:15.382 --> 00:00:19.086
cooperative in trying to fill
the rooms, dealing with it

00:00:19.086 --> 00:00:21.722
whenever we had to rearrange
where the tracks were. You guys

00:00:21.722 --> 00:00:27.728
have been fantastic. Why don't
you give yourselves a hand. So

00:00:30.430 --> 00:00:33.400
there's really, really
interesting malware and

00:00:33.400 --> 00:00:36.737
different intelligence platforms
that have been unveiled in the

00:00:36.737 --> 00:00:42.809
past couple years, and this talk
will break down what it will do

00:00:42.809 --> 00:00:49.583
on networks, not just on
processes. The stuff they're

00:00:49.583 --> 00:00:51.585
doing on boxes is fascinating
enough, but this is a you new

00:00:51.585 --> 00:00:57.591
area of research. Let's get Omer
a big hand. ( Applause ) >> So

00:01:11.705 --> 00:01:14.641
hello. Thank you very much for
coming out to listen to my talk.

00:01:14.641 --> 00:01:19.346
Today I'm going to present you
the network security research

00:01:19.346 --> 00:01:24.251
related to the state attacks
targeting telecommunication

00:01:24.251 --> 00:01:31.191
networks. My name is Omer. I
just basically start with what

00:01:31.191 --> 00:01:35.062
we are going to cover is
introduction to the telco

00:01:35.062 --> 00:01:39.900
architecture, and the network
protocols that are targeted such

00:01:39.900 --> 00:01:43.337
as the architect and the seven
-- server protocol and look the

00:01:43.337 --> 00:01:49.343
practical scenarios. Once you
establish a basic understanding

00:01:57.918 --> 00:02:03.857
of the geometric protocols, this
is the main concern of the talk.

00:02:09.296 --> 00:02:15.302
The government has the malware.
Before delving into the

00:02:17.604 --> 00:02:23.810
capabilities, I will try to
briefly remind you of techniques

00:02:23.810 --> 00:02:31.084
for the long-term intelligence
covering it. Afterwards we will

00:02:31.084 --> 00:02:36.123
talk about the capabilities and
then analyze how it could be

00:02:36.123 --> 00:02:41.194
weaponized in the offensive
network hacking as recently

00:02:41.194 --> 00:02:45.999
there are more technically
complex implants discovered by

00:02:45.999 --> 00:02:52.806
the searches. We will briefly
take a look at them. Finally,

00:02:52.806 --> 00:02:57.644
I'm going to present you how
some of the techniques employed

00:02:57.644 --> 00:03:03.050
by the malware could be
implanted by a high level

00:03:03.050 --> 00:03:09.056
programming language. Talking
about Windows driver and the API

00:03:13.560 --> 00:03:19.566
programming with Windows
systems. So just briefly myself,

00:03:23.537 --> 00:03:30.477
my name is Omer. My academical
background is political science

00:03:30.477 --> 00:03:37.384
and I studied at the university
on artificial intelligence. I'm

00:03:37.384 --> 00:03:40.720
currently employed with KP Royal
Dutch telecom in the

00:03:40.720 --> 00:03:46.726
Netherlands. I work for a
company like IBM and Verizon. I

00:03:49.129 --> 00:03:54.134
perform security assessments on
my day-to-day work, and I'm very

00:03:54.134 --> 00:04:00.073
interested in malware and
techniques in these areas. We're

00:04:06.480 --> 00:04:09.249
based in Amsterdam, and (
inaudible ). This is an

00:04:09.249 --> 00:04:15.255
attraction center known as the
red-light district. If you're at

00:04:23.230 --> 00:04:29.236
Amsterdam visit us to have a
beer and do some stuff together

00:04:37.310 --> 00:04:43.416
with us. What inspired us to
carry out this research was to

00:04:43.416 --> 00:04:49.422
analyze and determine the
service of the DNS networks.

00:04:52.359 --> 00:04:57.931
Governments are not only hacking
there but they spy on each other

00:04:57.931 --> 00:05:03.036
like taking corporations with
tools like Regin and sell

00:05:03.036 --> 00:05:09.042
malwares. So they reach a crazy
level, and the recent leaks are

00:05:12.112 --> 00:05:18.652
confident that the telecom
networks are victims. Pretty

00:05:18.652 --> 00:05:26.359
much each and every
telecommunications company got

00:05:26.359 --> 00:05:31.998
paranoid and tried to make sure
sure they haven't been affected

00:05:31.998 --> 00:05:39.506
by the same attack. It requires
a lot to learn about operating

00:05:39.506 --> 00:05:44.778
the system internal, the
internal working principles and

00:05:44.778 --> 00:05:49.616
computer architecture. So I'm
sure not only understanding but

00:05:49.616 --> 00:05:56.723
also to be able to produce and
assimilate would mean a lot to

00:05:56.723 --> 00:06:03.630
those who do day-to-day systems,
especially such as the I.T.

00:06:03.630 --> 00:06:11.671
members. So just very briefly
the architecture looks like

00:06:11.671 --> 00:06:17.510
this. It's a very complex
network architecture. I tried to

00:06:17.510 --> 00:06:26.920
break it down for this. The
network is looking for the

00:06:26.920 --> 00:06:33.193
digital or wireless and voice
communication, GPS is an

00:06:33.193 --> 00:06:39.599
extension of GSM network that
provides wireless and data

00:06:39.599 --> 00:06:46.072
communication. UMTS stands for
the telecommunications system,

00:06:46.072 --> 00:06:51.878
an extension of GPLS network
that is on our IP network by

00:06:51.878 --> 00:06:57.183
delivering broadband information
including commerce and

00:06:57.183 --> 00:07:06.893
entertainment services for
mobile users. UMT pays for the

00:07:06.893 --> 00:07:20.106
interfaces for the red unit for
controllers. To our

00:07:20.106 --> 00:07:25.912
communications they're based
over functions in GPS networks

00:07:25.912 --> 00:07:31.384
and GSM networks. Adjacent
network consist of following

00:07:31.384 --> 00:07:42.095
constants like mobile stations
based at a station, base station

00:07:42.095 --> 00:07:47.901
control systems, mobile
switching center, authentication

00:07:47.901 --> 00:07:53.306
center, communication register
and visitor location and

00:07:53.306 --> 00:07:57.777
registers. These are the most
important companies of the GSM

00:07:57.777 --> 00:08:05.752
network. It is being argued in
these Regin-related attacks. So

00:08:05.752 --> 00:08:09.989
very briefly I tried to explain
what I -- what the functionality

00:08:09.989 --> 00:08:18.298
is of the competence, and it
will delve into how it can be

00:08:18.298 --> 00:08:31.177
targeted by the government in an
SPNH campaign. The mobile

00:08:31.177 --> 00:08:38.084
station is this starting point
of the mobile wireless network.

00:08:38.084 --> 00:08:45.291
So it can contain a mobile
terminal and terminal. The base

00:08:45.291 --> 00:08:53.800
station is a station when a
subscriber uses a mobile station

00:08:53.800 --> 00:09:00.673
to make a call to the network,
the mobile station transfers the

00:09:00.673 --> 00:09:07.080
call to the base from the
receiver. The base station

00:09:07.080 --> 00:09:14.020
transfer includes acutements
like antennas, signalling,

00:09:14.020 --> 00:09:18.491
processing Internet and things
necessary for transmission

00:09:18.491 --> 00:09:33.573
within the geographical area. I
like to tell very briefly about

00:09:33.573 --> 00:09:46.719
the GSM network units. This is
important information such as

00:09:46.719 --> 00:09:56.596
accouterment is a database
looking for identities known as

00:09:56.596 --> 00:10:01.101
IMEIs. With the mobile situation
in the network, this is

00:10:01.101 --> 00:10:05.638
accouterment are found by the
manufacturering of the mobile

00:10:05.638 --> 00:10:12.712
station. That provides security
features such as blocking calls

00:10:12.712 --> 00:10:20.787
from the handset and that have
been stolen like stolen phones

00:10:20.787 --> 00:10:26.726
within the network and attached
to the mobile network. HLI is

00:10:26.726 --> 00:10:34.367
the home location register. It's
where you have the network, and

00:10:34.367 --> 00:10:38.471
first you have the information
about the subscriber such as

00:10:38.471 --> 00:10:43.443
international mobile subscriber
identities, subscriber services

00:10:43.443 --> 00:10:50.016
and a key for authentication
subscribers. Another important

00:10:50.016 --> 00:10:58.625
is the authentication center,
and the authentication center

00:10:58.625 --> 00:11:06.165
database contains things about
subscribers through the

00:11:06.165 --> 00:11:15.275
necessary keys for the
encryption for this. This is

00:11:15.275 --> 00:11:21.781
VLR, visitor location register.
It temporarily stores

00:11:21.781 --> 00:11:26.085
information about the mobile
stations and the activity in the

00:11:26.085 --> 00:11:45.705
geographic area, which is being
allowed. And the architecture

00:11:45.705 --> 00:11:51.644
has released interfaces for the
network elements. The mobile

00:11:51.644 --> 00:11:59.953
transmits the BTS and the BTS to
the BSC. And the communication

00:11:59.953 --> 00:12:04.757
also appears to go to the phases
of the databases. So HLR and ELR

00:12:04.757 --> 00:12:14.167
in the unit. These are the key
elements that can be targeted by

00:12:14.167 --> 00:12:31.017
the attackers over either
protocol. We're concerns about

00:12:31.017 --> 00:12:39.692
the malware playing a role in
such attacks. It specifically

00:12:39.692 --> 00:12:44.597
targets to the GSM networks.
They stay that the Regin has

00:12:44.597 --> 00:12:56.776
been designed to be a low that
can be used as Danish confines,

00:12:56.776 --> 00:13:00.380
and according to claims of
antivirus companies, it has been

00:13:00.380 --> 00:13:08.888
active since 2008. It's a good
demonstration. The picture was

00:13:08.888 --> 00:13:14.694
taken in Germany. They've put it
against GCHQ, and they have to

00:13:14.694 --> 00:13:18.665
get their data from the
databases. I was also one of the

00:13:18.665 --> 00:13:27.273
participants of the
demonstration. So our work

00:13:27.273 --> 00:13:40.186
pretty much looked like this.
Since our competitors, actually

00:13:40.186 --> 00:13:47.393
enemies are high-profile
organizations like GCHQ and NSA,

00:13:47.393 --> 00:13:54.367
which always listen to their
customers. It very much looked

00:13:54.367 --> 00:14:01.874
like this. Like using old school
techniques on bring them to

00:14:01.874 --> 00:14:13.419
their knees, but we didn't give
up and take a try. So in order

00:14:13.419 --> 00:14:15.888
to determine the scenarios, we
decided to get a large service

00:14:15.888 --> 00:14:23.696
innovation from the base
stations. For these reasons we

00:14:23.696 --> 00:14:27.500
have possibly attempted the GSM
communication from the ready

00:14:27.500 --> 00:14:32.472
base stations, and we greatly
utilized the passive network

00:14:32.472 --> 00:14:37.477
tapping into the research. I
would like to thank him. I think

00:14:37.477 --> 00:14:43.249
he's in one of the audiences. He
left yesterday, I think, and we

00:14:43.249 --> 00:14:50.623
talked about this. We tried to
collect as much information as

00:14:50.623 --> 00:14:54.227
possible from different end
points of the 2G and 4G

00:14:54.227 --> 00:15:00.566
services. There were those
reachable from the base station

00:15:00.566 --> 00:15:09.609
and the metro reaches. You would
definitely be shocked what we

00:15:09.609 --> 00:15:16.616
discovered on the assessments.
So the absence of the physical

00:15:16.616 --> 00:15:24.190
introduction to the devices that
if a device is altered or

00:15:24.190 --> 00:15:26.092
changed, most GSM companies
don't care about the possible of

00:15:26.092 --> 00:15:32.598
it and they don't take into
account it. We found less

00:15:32.598 --> 00:15:36.669
vulnerable services running and
are typical from the base

00:15:36.669 --> 00:15:42.175
stations and reachable
interfaces with default

00:15:42.175 --> 00:15:49.215
passwords, public/private key
for different communications.

00:15:49.215 --> 00:15:52.185
The absence of the temporary
distance and the axis

00:15:52.185 --> 00:16:01.561
prediction, the network tapping
shouldn't be possible otherwise.

00:16:01.561 --> 00:16:06.165
And improper network
segmentation in the nonroutable

00:16:06.165 --> 00:16:13.673
segments of the teleco company
could be accessible. The core

00:16:13.673 --> 00:16:24.116
GPS network and metro substation
could be exploited as well. So

00:16:24.116 --> 00:16:28.287
since the base station saw one
of the most network companies,

00:16:28.287 --> 00:16:32.091
we wanted to see where it is
possible to upload other inner

00:16:32.091 --> 00:16:35.361
companies and they stored
information such as access

00:16:35.361 --> 00:16:44.203
control, HLV, VLR. If you ever
have a similar assessment, you

00:16:44.203 --> 00:16:47.540
could see that the stations,
especially the segmentations are

00:16:47.540 --> 00:16:58.985
not correctly implemented. To
it's practically possible, so

00:16:58.985 --> 00:17:02.655
let's take a look on the network
companies that could be targeted

00:17:02.655 --> 00:17:09.862
by locally and remotely. GPS
roaming exchange acts as a hub

00:17:09.862 --> 00:17:16.969
for the GPS communications from
roaming users with the need of

00:17:16.969 --> 00:17:20.706
the link between GPIS and the
service provider. That's

00:17:20.706 --> 00:17:29.982
appearing enter connecting the
units. So the main are located

00:17:29.982 --> 00:17:35.488
to Europe in Amsterdam or for
Asia in Singapore. Then you

00:17:35.488 --> 00:17:43.663
travel abroad. You're from --
regardless of your location, so

00:17:43.663 --> 00:17:55.608
the communication is being held
or utilized by the network. So

00:17:55.608 --> 00:17:59.078
what networks? It's a German
exchange, and it's for your

00:17:59.078 --> 00:18:07.420
local GFM provider. It's a
trust-based network that made

00:18:07.420 --> 00:18:16.329
sharing possible. Any malicious
activity would affect multiple

00:18:16.329 --> 00:18:30.309
connective machines. GPSI is a
group of protocols to core

00:18:30.309 --> 00:18:36.382
regular radio services within
the GSN in the LT networks. It

00:18:36.382 --> 00:18:43.122
can be composed to separate
protocols like satellite GPTC,

00:18:43.122 --> 00:18:52.698
GPTU, and GPT. GPTC is used for
signalling between the support

00:18:52.698 --> 00:19:03.042
nodes known as GGSI and serving
the support. So these active

00:19:03.042 --> 00:19:11.117
stations are on the user's
behalf to the activation to the

00:19:11.117 --> 00:19:19.925
quality of the service. It's an
updated station for subscribers

00:19:19.925 --> 00:19:27.767
who have just arrived from
another SGNCM. GTP can be used,

00:19:27.767 --> 00:19:42.081
it's an monitored ( inaudible )
inversion zero. GTP is running

00:19:42.081 --> 00:19:51.891
lose only on the BP protocol. So
one of the most important

00:19:51.891 --> 00:20:00.433
features is the DNS is used for
resolving a PS to set up a GPT

00:20:00.433 --> 00:20:08.040
tunnel, and an access point is
known as the gate for between 3G

00:20:08.040 --> 00:20:14.580
and 4G network and another
network for the public Internet.

00:20:14.580 --> 00:20:22.555
So there are some network dumps,
and how and what this looks

00:20:22.555 --> 00:20:35.034
like. There's a lot of
information here. ( Inaudible )

00:20:35.034 --> 00:20:41.507
the GP packet has a lot of
information like the subscriber

00:20:41.507 --> 00:20:48.614
network information. This might
be correlated with the person

00:20:48.614 --> 00:20:58.891
and she's active to the rest of
the world. As you can see here,

00:20:58.891 --> 00:21:03.929
here is the API/APM access
networks and the DNS

00:21:03.929 --> 00:21:12.838
information. So I will tell you
all the communication

00:21:12.838 --> 00:21:18.677
intercepted and looked at
including the physical location.

00:21:18.677 --> 00:21:24.583
It can be possible in such cases
because it's providing an

00:21:24.583 --> 00:21:35.594
exchange within the trust-based
networks globally. This is a 7

00:21:35.594 --> 00:21:41.367
and 6 run. 7 signals a protocol
which was built like 30 years

00:21:41.367 --> 00:21:47.072
ago, and widely commonly used
protocol and other

00:21:47.072 --> 00:21:56.816
vulnerabilities. This is a
procedure for user identity,

00:21:56.816 --> 00:22:05.424
routing, billing and management.
It looks like as in the picture,

00:22:05.424 --> 00:22:14.900
did they link to NPT layers, PT
2 and 3 layers. Some of the

00:22:14.900 --> 00:22:24.577
features if you look at what we
are really interested in, this

00:22:24.577 --> 00:22:28.080
is the flow that transfers the
information, traffic congestion

00:22:28.080 --> 00:22:39.692
and there's a measurement.
Everything on the protocol like

00:22:39.692 --> 00:22:48.767
voice-over IP and interconnected
IP networking and lots of new

00:22:48.767 --> 00:22:57.977
networks within the GSM network
utilizes a certain protocol. It

00:22:57.977 --> 00:23:07.186
simply looks like this. It's
utilized as a certain protocol.

00:23:07.186 --> 00:23:18.897
So with this protocol analysis,
it revealed in a sense

00:23:18.897 --> 00:23:23.202
information is being transmitted
between different nodes in the

00:23:23.202 --> 00:23:28.974
network. For instance, Microsoft
interesting information could be

00:23:28.974 --> 00:23:36.181
related to the ( inaudible )
code number and code status.

00:23:36.181 --> 00:23:43.088
There are some public tools that
are available that you can

00:23:43.088 --> 00:23:50.896
analyze the network, and we also
created a script to honor and

00:23:50.896 --> 00:23:57.036
tap into all the network flow
information. Lately I found that

00:23:57.036 --> 00:24:03.976
here on the slide. You can
download it on the XS-7 network

00:24:03.976 --> 00:24:15.554
flow. So this is a certain
protocol and loss. The

00:24:15.554 --> 00:24:20.392
information is being
transmitted, and the protocol is

00:24:20.392 --> 00:24:30.536
enough to feed into our giant
database. So practical

00:24:30.536 --> 00:24:38.677
scenarios. This is something
that you can work things out

00:24:38.677 --> 00:24:41.680
communicating and talking to
each other from the subscriber

00:24:41.680 --> 00:24:53.692
line. So it's possible to
introduce a change in the ELR

00:24:53.692 --> 00:25:00.632
and MSC database. It introduces
a conference call type of

00:25:00.632 --> 00:25:13.312
mechanism to intercept calls to
victims. It's also possible to

00:25:13.312 --> 00:25:20.052
get a subscriber service change.
For example, it was introduced

00:25:20.052 --> 00:25:31.130
as a decoy database. The GSM
network that he's supposed to

00:25:31.130 --> 00:25:37.603
reach to do a certain protocol,
so he can do much more attacks

00:25:37.603 --> 00:25:42.775
with an interception of MSS
calls and outgoing calls and the

00:25:42.775 --> 00:25:48.514
direction of incoming and
outgoing calls. In other words,

00:25:48.514 --> 00:25:58.390
anything including final. During
my research I was cooperating

00:25:58.390 --> 00:26:03.695
with the researchers from
Finland. So I was informed that

00:26:03.695 --> 00:26:10.402
they have found another
vulnerability in S-7, and the

00:26:10.402 --> 00:26:12.438
vulnerability is simply
exploiting the relationship

00:26:12.438 --> 00:26:19.745
between MA and use AR access
module within the GSM network.

00:26:19.745 --> 00:26:28.954
So they are able to look at the
stolen mobile devices without

00:26:28.954 --> 00:26:42.801
requiring a GSM cart attached to
it. So attacks look like this.

00:26:42.801 --> 00:26:58.484
Simply modified in my
information sent the database

00:26:58.484 --> 00:27:06.792
and the change and that's the
verification of the DLR data. So

00:27:06.792 --> 00:27:20.172
it's simply communicating to the
GSM network there. If you like

00:27:20.172 --> 00:27:29.214
to read more about this academic
paper will be presented on IE

00:27:29.214 --> 00:27:37.923
conference in August. So it will
be available. So this is a is

00:27:37.923 --> 00:27:43.896
network not only targeted bid
good guys or the government but

00:27:43.896 --> 00:27:55.574
also that's after this (
inaudible ). This is the mail

00:27:55.574 --> 00:28:01.380
exchange between one of their
customers, so they were trying

00:28:01.380 --> 00:28:12.491
to implement malware that are
targeting 7 signalling protocol.

00:28:12.491 --> 00:28:18.196
So they were after victims to
locate the phone location.

00:28:18.196 --> 00:28:26.872
According to the main exchange,
the location information and how

00:28:26.872 --> 00:28:34.646
they're going to obtain the
location information is just

00:28:34.646 --> 00:28:51.663
requiring it and signalling
protocol. The mobile phone

00:28:51.663 --> 00:29:03.575
location could be obtained by
such it requires. These are the

00:29:03.575 --> 00:29:10.115
brief techniques, so I think --
I hope it's nation-state

00:29:10.115 --> 00:29:19.124
interested in attacking
networks. I will briefly cover

00:29:19.124 --> 00:29:24.963
the techniques. We mentioned and
talked about the root case could

00:29:24.963 --> 00:29:26.665
be analyzing two categories and
using those internal notes and

00:29:26.665 --> 00:29:35.273
the root kit. We're referring to
an executable or DLL. And there

00:29:35.273 --> 00:29:42.714
are techniques, and then they
say the internal route kit. We

00:29:42.714 --> 00:29:51.089
are simply referring to the
Windows driver that can install

00:29:51.089 --> 00:30:07.572
a system with a table and et
cetera. So this is simply able

00:30:07.572 --> 00:30:14.179
to intercept a function, alter
it, and change the content and

00:30:14.179 --> 00:30:25.657
sometimes intercept it the way
you want. There's the motion (

00:30:25.657 --> 00:30:33.865
inaudible ) implementing it.
You're simply monitoring the

00:30:33.865 --> 00:30:38.870
calls into the system, and
you're simply logging into the

00:30:38.870 --> 00:30:49.081
function that corresponding to
the calls and logging it. The

00:30:49.081 --> 00:30:56.388
techniques can be used, for
instance, on the firewall for

00:30:56.388 --> 00:31:04.696
the ( inaudible ). For instance,
let's assume that malware

00:31:04.696 --> 00:31:13.572
affected your computer and
you're looking for activities by

00:31:13.572 --> 00:31:24.816
simply monitoring the calls and
how it behaves. So some of the

00:31:24.816 --> 00:31:31.890
basic root techniques like if
you analyze it on the user mode,

00:31:31.890 --> 00:31:38.230
for instance the ELL injections
are very stable hooking or

00:31:38.230 --> 00:31:44.903
in-line hooking techniques. The
level will get a driver that can

00:31:44.903 --> 00:31:54.646
employ ( inaudible ). You can
find quite a lot of information

00:31:54.646 --> 00:32:02.454
from the calls on the Internet.
I do not go into these much

00:32:02.454 --> 00:32:12.197
details. Well, once I stumbled
from Regin malware, and after

00:32:12.197 --> 00:32:18.537
completing an analysis on the
network, the research I have, my

00:32:18.537 --> 00:32:26.745
next goal was to analyze every
single malware and simulate it.

00:32:26.745 --> 00:32:35.854
So the companies really did a
great job on analyzing tomorrow,

00:32:35.854 --> 00:32:42.060
but they didn't dive into what
actually being targeted and

00:32:42.060 --> 00:32:49.000
achieved by the malware. So we
have to understand the malware

00:32:49.000 --> 00:32:54.639
and produce it and reimplement
it. That might help it to be

00:32:54.639 --> 00:33:03.548
understandable by the GSM
providers, so Regin malware

00:33:03.548 --> 00:33:09.721
looked like complex malware. I
have everything. It's consisting

00:33:09.721 --> 00:33:21.433
of different modules. It uses
very specific features of an

00:33:21.433 --> 00:33:27.839
operating system called
Orchestrator. It's the oriented

00:33:27.839 --> 00:33:33.645
architecture, and they were
being organized and prioritizing

00:33:33.645 --> 00:33:42.721
depending on the RPC calls. So
this simply shows the stages

00:33:42.721 --> 00:33:47.425
like we can break down the
malware into five different

00:33:47.425 --> 00:33:55.567
stages they're stage four there
and simply state it first

00:33:55.567 --> 00:34:10.649
request extracting to the next
stage and decrypting it. So

00:34:10.649 --> 00:34:18.156
distinguishing the detection of
antiviruses. There are quite the

00:34:18.156 --> 00:34:24.930
challenges while analyzing this
malware from the first module.

00:34:24.930 --> 00:34:29.968
It's still a little bit unclear
how the systems were affected,

00:34:29.968 --> 00:34:36.041
and initially infected by the
malware. As the Regin targeted

00:34:36.041 --> 00:34:42.981
multiple institutions and GSM
networks, it's still unclear.

00:34:42.981 --> 00:34:53.058
However, another challenge was
multi-stage and encrypted

00:34:53.058 --> 00:35:01.066
structure, so it was really hard
to find samples, even if you

00:35:01.066 --> 00:35:10.508
have the sample, you don't have
the next stage correctly it

00:35:10.508 --> 00:35:16.348
could be a problem to extract
it. So the modules were invoked

00:35:16.348 --> 00:35:21.586
by the architecture. Malware
data is stored inside it and the

00:35:21.586 --> 00:35:28.760
research of the GSM network had
no indication of compromise,

00:35:28.760 --> 00:35:36.801
which is good. So my solution
was to Orchestrator and use the

00:35:36.801 --> 00:35:43.608
memory available on the Internet
and look at the analysis for the

00:35:43.608 --> 00:35:54.686
similar tools to maintain the
costs and the analysis. So from

00:35:54.686 --> 00:36:01.726
stage 1 to 2 I will go through a
little bit quicker because we're

00:36:01.726 --> 00:36:07.599
about to run out of time. I want
to do a demonstration that I

00:36:07.599 --> 00:36:12.170
have implemented. The one was
simply extracting to the next

00:36:12.170 --> 00:36:15.573
stage from first to three if you
can look at this system cost.

00:36:15.573 --> 00:36:22.480
There are simply having a memory
in the internal space and the

00:36:22.480 --> 00:36:31.489
next stage and extracting it.
Stage 2 is a little bit

00:36:31.489 --> 00:36:36.294
different because it implements
and extracts the next stage.

00:36:36.294 --> 00:36:45.170
There's a block. So it will
really very specific feature of

00:36:45.170 --> 00:37:02.754
the Regin malware. It's similar
to it you can see the details of

00:37:02.754 --> 00:37:06.991
it. It just searchings it, and
there's a big function from the

00:37:06.991 --> 00:37:10.728
calls. Stage 3 and 4 could be
the most interesting one because

00:37:10.728 --> 00:37:18.236
stage 3 is simply the brain of
the Regin malware. It simply

00:37:18.236 --> 00:37:32.484
accepting Orchestrator calls and
executing them. For instance, it

00:37:32.484 --> 00:37:38.690
was in the internal module,
criminal and module calls and

00:37:38.690 --> 00:37:42.260
executing them within the
process memory of the

00:37:42.260 --> 00:37:48.867
executable. So how could we
recognize it. I simply said what

00:37:48.867 --> 00:37:58.743
it does in the Orchestrator call
and try to implant them using

00:37:58.743 --> 00:38:04.315
driver kits. You can take a look
at them. The code will be

00:38:04.315 --> 00:38:12.824
available. So just this
compilation might be a little

00:38:12.824 --> 00:38:22.934
bit subjective, but according to
the complexity, it's the most

00:38:22.934 --> 00:38:30.375
complex ( inaudible ) that has
ever been seen. Each one

00:38:30.375 --> 00:38:38.550
implements a very specific
features. So after the reverse

00:38:38.550 --> 00:38:43.588
engineering can do the technical
analysis, I implemented the

00:38:43.588 --> 00:38:49.360
region so state 3 and stage 4 a
little bit tighter course. So

00:38:49.360 --> 00:38:58.169
such features like data
extraction or running a threat

00:38:58.169 --> 00:39:04.142
of applications in the space,
the Orchestrator hasn't finished

00:39:04.142 --> 00:39:12.450
yet but simply orchestrates it.
There's network calls with the

00:39:12.450 --> 00:39:44.816
category module. There's a
utility there. You can see the

00:39:44.816 --> 00:39:53.091
changes of the system within the
system. For example, (

00:39:53.091 --> 00:40:10.575
inaudible). Right now there's no
et cetera. What I have

00:40:10.575 --> 00:40:16.681
implemented is simply a Turner
module and driver. This

00:40:16.681 --> 00:40:25.556
corresponding to the Regin stage
4, and it may be stage 3 or 2 or

00:40:25.556 --> 00:40:34.565
a combination. What it simply
does is simulates for malicious

00:40:34.565 --> 00:40:42.874
activities in the system. So I
will show you demonstrate it

00:40:42.874 --> 00:40:52.283
very quickly. This is batch
file. It hasn't been weaponized

00:40:52.283 --> 00:40:55.086
yet, so it's simply around the
system to transfer the driver

00:40:55.086 --> 00:41:09.767
and is executable. >> Can I
interrupt? Go ahead and hit

00:41:09.767 --> 00:41:16.407
next. All right. You all know
this work. Is he doing a good

00:41:16.407 --> 00:41:22.914
job? ( Applause ) We have
ourselves a new speaker, and

00:41:22.914 --> 00:41:27.952
he's doing demos and they're
working. That never happens. I

00:41:27.952 --> 00:41:41.065
feel it at DEF CON. ( Applause )
All right. Demos, trust me. >>

00:41:41.065 --> 00:42:16.934
Thank you. >> I have a little
gift here for you. Somebody

00:42:16.934 --> 00:42:20.505
dropped it off in the speaker
room. It appears to plug into

00:42:20.505 --> 00:42:23.941
the USB in your computer. It has
a lot of Chinese writing on it.

00:42:23.941 --> 00:42:37.855
You know what? Good luck. >> I
would not use that. >> I'm

00:42:37.855 --> 00:42:48.933
simply executing the batch file
that will run. I will show you.

00:42:48.933 --> 00:42:55.907
Registered a little small region
like the root kit in the system

00:42:55.907 --> 00:43:01.679
and then run it in the system
and then execute through stage

00:43:01.679 --> 00:43:56.367
1. It's running now. Okay. All
right. So it's executed. As you

00:43:56.367 --> 00:44:02.106
can see, I implemented the root
kit using very simple techniques

00:44:02.106 --> 00:44:06.143
for the beginning. It simply
allows us to look at the simple

00:44:06.143 --> 00:44:14.886
system but efficient, and stage
1 is also executed but it's

00:44:14.886 --> 00:44:25.396
executable and has some hooks
from to hide from the registry.

00:44:25.396 --> 00:44:57.395
I will briefly demonstrate what
it is. I will try to delay this

00:44:57.395 --> 00:45:10.474
one. I also show you a very
specific one. I'll a stand-up

00:45:10.474 --> 00:45:20.017
user now. As a client I have
implemented so you can simply

00:45:20.017 --> 00:45:32.129
connect back to the affected
system. You can do some things

00:45:32.129 --> 00:45:58.456
like executing commands from the
system, for example. It says

00:45:58.456 --> 00:46:02.560
something about the malicious
features like encrypting the

00:46:02.560 --> 00:46:11.936
entire Windows partition. It's
cueing the system and writing it

00:46:11.936 --> 00:46:24.548
and the structure. And I also
want to show you, for example,

00:46:24.548 --> 00:46:29.086
it protects the stage 1
executable. For example, you say

00:46:29.086 --> 00:46:34.492
it couldn't find it, but
actually they practice it to

00:46:34.492 --> 00:46:41.832
execute and it is there. For
example when I tried to show

00:46:41.832 --> 00:46:50.007
another executable which doesn't
exist, it gives it there. It's

00:46:50.007 --> 00:47:03.454
simply intercepts calls, and
there's the international calls

00:47:03.454 --> 00:00:00.000
and it simply has it. Thank you
very much. ( Applause )

