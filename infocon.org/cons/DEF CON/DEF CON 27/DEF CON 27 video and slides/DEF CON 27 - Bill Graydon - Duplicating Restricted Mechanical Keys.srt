00:00:00.200,00:00:05.005
>>We are here to hear about a
little bit of physical security
stuff. Uh, how many people have

00:00:05.005,00:00:10.010
seen those uh those uh keys that
say, "do not duplicate"? Say,
oooh, well in that case, I'm

00:00:12.145,00:00:15.082
definitely not going to
duplicate that. [laughter].
These guys apparently have a

00:00:15.082,00:00:20.420
different philosophy on this.
Let's give uh Billy and Bobby a
great uh welcome to uh Fancy

00:00:20.420,00:00:25.425
Track. [applause] Have a good
time, gentlemen. >>Thank you.
>>Alright, so uh welcome,

00:00:28.395,00:00:32.666
everyone. This is duplicating
restricted keys. I'm Bobby and
this is my brother Billy

00:00:32.666,00:00:39.306
Graydon. So first I want you all
to take a look at your key ring.
And almost all of you are gonna

00:00:39.306,00:00:44.845
notice one of them looks like
one of the keys that's on this
uh screen here and— >>Go ahead,

00:00:44.845,00:00:49.850
pull them out! >>[laughs] And uh
so these these are some of the
most common keys that you'll

00:00:49.850,00:00:54.855
find in North America. Um and
they're relatively easy to copy.
So if you wanna copy them, uh

00:00:57.524,00:01:03.330
basically you go to any
locksmith, corner store, and um
they're gonna be showing you,

00:01:03.330,00:01:09.036
sorry, we're gonna be showing
you a video, if you can get that
up. So what this machine is

00:01:09.036,00:01:13.974
called is a profile cutter. And
essentially how it works is it
has a little probe that rides

00:01:13.974,00:01:18.478
along the uh the key that you
want copied and then a cutter on
the right side that you can see

00:01:18.478,00:01:23.483
here, um and that's what
actually cuts the bitting in the
key. Get that going. >>Yeah. So

00:01:25.752,00:01:31.124
you can see there on the bottom
is the probe following the key
and on the top is the cutter,

00:01:31.124,00:01:36.129
and that's going to create the
exact same profile on the
duplicate. >>Come on, open up

00:01:41.835,00:01:46.840
for. Nope. Alright. Sorry,
folks. [laughs] There we go.
>>Okay, just for an example of

00:02:04.524,00:02:09.196
one of the simple keys that you
might be able to get copied with
this technique. Um, there's just

00:02:09.196,00:02:14.634
regular keys like this here,
which is uh one of the keys for
the Titan II nuclear missiles

00:02:14.634,00:02:19.706
and you'd be able to walk into
any corner store with this thing
and they'd cut if for you.

00:02:19.706,00:02:25.479
>>Thankfully, high security keys
have come a long way since then.
>>And for any of you who don't

00:02:25.479,00:02:31.051
have a background kind of on how
a lock works, um if you take a
look at the bottom, you can see

00:02:31.051,00:02:36.456
how there's two tints
essentially in each column
there. And the line between them

00:02:36.456,00:02:40.527
is called the shear line and
when the key's in there those
are lined up, which allows the

00:02:40.527,00:02:45.432
key to turn, and when it's out
at the top there, you can see
they're not lined up and uh

00:02:45.432,00:02:50.437
that's why you need the key in
there for it to actually work.
And so next we're gonna be

00:02:53.473,00:02:57.811
showing you a video of, you
know, when you bring a key in to
be copied, you already have that

00:02:57.811,00:03:04.584
key, and that's what the profile
cutter can do to copy it. Um how
do you get the first one? So

00:03:04.584,00:03:09.489
this is called origination. And
essentially how it works is
similar to the other one.

00:03:09.489,00:03:13.827
There's a cutting wheel there,
however, with this one you can
very, very specifically move the

00:03:13.827,00:03:18.832
key forwards to take out little
bites of the key. And that will
create the bitting. And so you

00:03:23.770,00:03:30.043
can see there's a wheel being
turned there. And so that's 1 of
2 that lets you precisely move

00:03:30.043,00:03:35.048
the key, side to side, and in
and out to get those cuts right.
So again I'm going to ask you,

00:03:47.627,00:03:52.332
take out your key ring. Um, take
a look on it. Or some of you
might even recognize these

00:03:52.332,00:03:57.404
immediately. These are gonna be
less common, but all of these
that you see here are high

00:03:57.404,00:04:02.409
security keys, which means good
luck going into any random
corner store or locksmith and

00:04:02.409,00:04:07.414
getting these copied. Uh they
won't be able to do it or they
won't do it for you. >>So we're

00:04:11.084,00:04:16.089
gonna talk about how you can
make that happen. When you take
a restricted key into a

00:04:16.089,00:04:20.894
locksmith, and the locksmith
says, sorry I can't cut this for
you. The number 1 reason for

00:04:20.894,00:04:25.766
that is going to be the
locksmith simply does not have
the blank. So the 2 videos we

00:04:25.766,00:04:30.170
showed before of profile cutting
and code cutting, or origination
of the key, we've started with

00:04:30.170,00:04:35.175
an uncut blank and we added the
cuts into it um that would then
operate the lock. More, the most

00:04:37.344,00:04:42.182
important part of a blank is
what's called the keyway. So
that's the specific shape that

00:04:42.182,00:04:47.687
that blank has. So the
manufacturing process of a key
blank is, we start like image

00:04:47.687,00:04:52.993
number 1 with the rectangular
piece of metal, and then we're
going to mill along or mill out

00:04:52.993,00:04:58.832
uh some hole or some grooves
long the side of that key, and
you'll end up with something

00:04:58.832,00:05:03.570
like image 3 over there. And so
if you look at your keys, if you
look at them head on, you'll see

00:05:03.570,00:05:09.643
a pattern similar to image 3 and
that's going to match up with
the lock similar to image 5. Uh

00:05:09.643,00:05:14.981
just for some terminology, in
image 2 where we're cutting out
the grooves along the key,

00:05:14.981,00:05:19.853
that's called millings. And
image 4, those pieces of metal
that are put in the lock to

00:05:19.853,00:05:24.824
prevent the wrong key from going
in, that's called warding. So uh
we'll try to remind you, but uh

00:05:24.824,00:05:30.797
keep that terminology in mind.
The purpose of this is all sorts
of lock manufacturers have their

00:05:30.797,00:05:35.802
own keyways and they try to make
it unique amongst different lock
manufacturers so you can't say

00:05:35.802,00:05:41.508
take a Schlage key and stick it
in a Weiser lock. It won't even
fit. Let's cover our first

00:05:41.508,00:05:48.281
keyway exploit. So here we have
what's called a master keyway
system. You're all familiar with

00:05:48.281,00:05:52.819
master keys, I'm sure, and that
uses the bitting on the top of
the key. You can also do it with

00:05:52.819,00:05:59.159
keyways. So we have at the top
the Schlage SC1, probably
arguably the most common in

00:05:59.159,00:06:05.165
North America, um but you have a
whole bunch in its family. So
third from the left on the top,

00:06:05.165,00:06:12.038
we have the SC8, and those 2
will not fit in each other's
locks. However, circles in blue

00:06:12.038,00:06:17.978
just below it, we have the H
keyway, and that's a master
keyway; it's going to fit into

00:06:17.978,00:06:24.618
both the SC1 and SC8 lock. So
very large facilities or poorly
designed locking systems, as

00:06:24.618,00:06:30.757
we'll go into, um you can do
mastering with that. So let's
say I have room A that's an SC1

00:06:30.757,00:06:37.697
key and room B that's SC8 key,
same bitting on top, and then
the master key is that H keyway

00:06:37.697,00:06:43.770
there that's gonna enter both
locks. The exploit you can even
do unintentionally. And this is

00:06:43.770,00:06:47.674
the real problem is if I take,
let's say I'm in room B, I have
a key to room B, and I take that

00:06:47.674,00:06:52.679
into a locksmith. Now that
locksmith might not stock all of
these blanks we see up here. He

00:06:55.548,00:07:00.186
might say, hey, well at the very
bottom there, there's SC19,
that's gonna enter all these

00:07:00.186,00:07:06.493
locks. So I can save some supply
chain cost and just stock that
and I can cut everyone's on

00:07:06.493,00:07:12.232
that. So he cuts me a key, a
duplicate, on SC19, it works
perfectly fine on my lock, but

00:07:12.232,00:07:18.505
it's also gonna work now in room
A because it's a more, higher
level master keyway it's gonna

00:07:18.505,00:07:23.510
enter that. Um so that's the
first exploit people could do
completely unintentionally. The

00:07:27.280,00:07:33.353
main focus of this talk though
is on restricted keys. So this,
some folks might recognize, is a

00:07:33.353,00:07:38.358
3D computer model of the Medeco
M3 key blank and because they're
just pieces of metal, you can

00:07:40.660,00:07:44.898
___ them up, 07:41 you can make
models for them. So here's one
for Biaxial and here's that one

00:07:44.898,00:07:49.436
that we 3D printed, and this is
now a functional blank we can
add cuts to that and it works

00:07:49.436,00:07:55.542
just fine in the lock. If you
wanna make it out of metal,
you'd be using a machine like

00:07:55.542,00:07:59.913
this, and this is very similar
to what happens in the mass
production system for all the

00:07:59.913,00:08:04.484
keys that you'll have in your
pocket right now. At the top,
you'll see that circular cutter

00:08:04.484,00:08:08.855
wheel and that's what's gonna
mill those grooves along the key
and you put it in the clamp

00:08:08.855,00:08:15.161
there and mill the specific
shapes out, as we see here. So
in diagram 2 it would be taking

00:08:15.161,00:08:20.166
out that rectangle at the top
and those 2 triangles at the
bottom. A talk about restricted

00:08:22.302,00:08:25.872
keys and restricted keyways
wouldn't be complete without
mentioning the easy entry. That

00:08:25.872,00:08:31.244
effectively does all of that for
you. It's um a complete black
box, or pink box as the case may

00:08:31.244,00:08:36.216
be. Um most people don't have
access to them. They're very
expensive and a lot of the

00:08:36.216,00:08:40.687
functionality is restricted um,
and finally because it's a black
box, you don't really understand

00:08:40.687,00:08:46.693
what's going on within them. So
for that reason, we won't say
anything more about that. Keyway

00:08:46.693,00:08:51.698
research. So finding keyways
that fit in locks they're not
supposed to and doing various

00:08:51.698,00:08:56.703
other things with that, used to
be very tedious process. And you
ask any locksmith about this, if

00:08:56.703,00:09:00.407
you have a lock and you need to
find the right keyway for it,
you're kind of looking at it, oh

00:09:00.407,00:09:04.644
I recognize this as close to
that, nope, not quite, take your
hand, file out, file it away,

00:09:04.644,00:09:09.549
nope, file the wrong place, and
then you just get mad about it.
We've gone and automated that

00:09:09.549,00:09:14.621
process. So we rented some
software that takes hundreds of
different key blanks and we've

00:09:14.621,00:09:18.691
brought them into a digital
database and we've written a
little scripting language, um

00:09:18.691,00:09:22.695
with a UI similar to uh MIT's
scratch, for those of you who've
heard of it, you might recognize

00:09:22.695,00:09:26.399
those blocks on the bottom. So
what they were doing is first,
we're drawing out the Schlage

00:09:26.399,00:09:31.838
SC1, you can see in the top
right there, and then we're
comparing the SC1 with the SC8.

00:09:31.838,00:09:37.377
Those are the 2 we talked about
before on the master keyways.
And you can see in red where the

00:09:37.377,00:09:43.450
SC8 is and the SC1 isn't and
blue where the SC1 is and the
SC8 isn't. Those are the pieces

00:09:43.450,00:09:48.455
of metal that prevents 1 key
from entering the other's lock.
So we add a bit more

00:09:50.657,00:09:55.094
functionality to it. So taking
the reverse of a keyway, as you
can see in the very top block

00:09:55.094,00:10:01.367
there, and so we can see that
the Sargent RA and LA keyway are
the same when reversed. And you

00:10:01.367,00:10:05.305
can tell that because it's
completely purple, there's no
metal that's unique to one or

00:10:05.305,00:10:11.911
the other. You can also compare,
say, how much uh a or how thick
a flat piece of metal has to be

00:10:11.911,00:10:18.118
to fit into that lock. So in
this case we have the Medeco 9S
blank that's a Biaxial blank

00:10:18.118,00:10:22.288
restricted, you're not supposed
to be able to get them anywhere,
but you can get a piece of uh a

00:10:22.288,00:10:28.261
flat, metal 32 thousandth of an
inch thick and that'll work just
fine as we can see here. We

00:10:28.261,00:10:33.700
added binary operations in as
well. So to sort of math with
keyways rather than adding and

00:10:33.700,00:10:37.670
subtracting them, we're
intersecting them and taking the
union of them. So we have the

00:10:37.670,00:10:43.476
Schlage C, E, and F keyway. By
the way, C and E are another
name for SC1 and SC8 and so

00:10:43.476,00:10:48.448
that's what we're seeing in the
first 3 there. Uh the
intersection of those is the

00:10:48.448,00:10:53.686
masterkey or master keyway
that's going to enter all of
those locks. And so we can

00:10:53.686,00:10:57.790
calculate the intersection
there. And the union is the lock
that will accept all of those

00:10:57.790,00:11:02.729
keys. So that's a much wider
open keyway. We uh considered
how you can machine and modify

00:11:07.634,00:11:12.505
these keyways. So in this case,
we have milling with a ball
cutter so that creates a nice,

00:11:12.505,00:11:18.344
circular groove along the key.
And so for instance, if we have
a best L keyway and that's what

00:11:18.344,00:11:23.349
we see up at the top, and we
wanted to enter both an L and an
M lock. Well we first start by

00:11:25.718,00:11:31.724
comparing them and you notice
that red there, that's where the
L has metal where the M doesn't,

00:11:31.724,00:11:36.930
so that's what's gonna prevent
it from entering that uh that
lock. We can go ahead and play

00:11:36.930,00:11:43.136
around with where we have to
mill off and if we mill off with
a uh 32 sorry, a 16th inch ball

00:11:43.136,00:11:48.241
cutter, we can take away that
red and we see that in the image
on the right and that will now

00:11:48.241,00:11:52.946
enter uh that lock. Those of you
who are familiar with scripting
will notice that we're using

00:11:52.946,00:11:59.018
variables for that as well. So
in red we have the milled best L
and we keep modifying it to be

00:11:59.018,00:12:03.957
itself with some uh some taken
off on the mill. We went one
step further, built in control

00:12:06.459,00:12:11.698
structures, for loops, S, etc.
and made a Turing complete QA
analysis language. Um so in this

00:12:11.698,00:12:16.436
particular case, we're looping
through every QA in our database
and we're checking to see, is

00:12:16.436,00:12:22.041
that key very similar to itself
upside down? And if so, we're
going to dump it out. This is a

00:12:22.041,00:12:28.748
small sample of the output when
we ran that script. And we get a
whole bunch of keyways that uh

00:12:28.748,00:12:33.753
that are symmetric either way.
So let's apply this to actually
create restricted keys. So we

00:12:37.223,00:12:42.962
see here the Medeco 1515, uh
that's what's shown in red
there, um and that's a

00:12:42.962,00:12:45.999
restricted keyway that's for
Medeco class. You're not
supposed to be able to buy those

00:12:45.999,00:12:52.939
anywhere. But you can buy a BEST
A anywhere. Most common BEST
keyway out there. If you look at

00:12:52.939,00:12:56.643
these this comparison here,
you'll see that they're the same
in the bottom half of the

00:12:56.643,00:13:02.315
keyway. Well what sort of key
only uses the bottom half? Well
a bump key. So we can take that

00:13:02.315,00:13:07.754
BEST A and cut it to be a Medeco
bump key and otherwise
completely unmodified in terms

00:13:07.754,00:13:13.726
of the keyway and that's going
to enter that Medeco lock and
function as a bump key. Going

00:13:13.726,00:13:18.898
back to our comparison, we see
that if we need to make uh make
it a full-height key that's

00:13:18.898,00:13:23.202
going to work as a full-fledged
key, we just have to take a
little bit off the top there.

00:13:25.571,00:13:32.545
Course, you can do it with hand
files. We also made a little
adapter that's gonna fit on our

00:13:32.545,00:13:37.550
code cutting machine and uh that
will allow us to mill it out as
well. And this also demonstrates

00:13:39.619,00:13:44.624
for you what the keyway milling
process looks like. Alright, so
we have our blank clamped in at

00:13:50.596,00:13:56.469
the bottom there, we're starting
at the wheel. And then we're
moving it in so that it's

00:13:56.469,00:14:02.675
cutting the right depth of the
groove, and now we're moving the
blank up slowly. And that's

00:14:02.675,00:14:09.082
milling out a longitudinal
groove along that key. And so
that being a code cutter, that

00:14:09.082,00:14:14.087
lets us very precisely position
where along the XY that groove
is gonna be as well as how deep

00:14:16.989,00:14:21.994
that groove is gonna be. You can
also use an end mill. So this is
a uh picture of modifying a Yale

00:14:28.301,00:14:33.306
Y1 blank on a milling machine.
Um this is a much more common
piece of machinery than a keyway

00:14:35.708,00:14:42.315
modifier horizontal mill or a uh
coat cutter. Um so anyone that
has access to hacker spaces,

00:14:42.315,00:14:46.986
makers spaces, etc, you got 50
bucks for a month, you can get
access to one of these and they

00:14:46.986,00:14:52.825
can modify your keyway for you
as well. So we took one of these
BEST blanks and we modified it

00:14:52.825,00:14:57.730
accordingly. Um this blank that
you're about to see was actually
the one that was shown in that

00:14:57.730,00:15:02.668
video on the HPC machine. And we
added the Medeco cuts to it. And
it's now a functioning Medeco

00:15:04.837,00:15:09.842
key cut on one of the most
common blanks in the country. We
can get even stupider. So if we

00:15:13.880,00:15:19.318
look at the bottom left here we
see the Medeco 1515's the far
left and the Schlage E, which is

00:15:19.318,00:15:24.123
also SC8, right beside it. They
don't look similar at first
glance until you notice that

00:15:24.123,00:15:28.327
they're mirror images of one
another. Well we live in 3
dimensions not 4, so you can't

00:15:28.327,00:15:34.767
flip a key mirror wise,
unfortunately. Um but what you
can do is put it backwards. So

00:15:34.767,00:15:39.205
if you stick it in the back of
the lock, it actually fits, that
gets you your mirror image, and

00:15:39.205,00:15:43.176
we've chopped the head off of
the key so you can see uh
exactly how nicely it fits.

00:15:43.176,00:15:47.313
That's completely unmodified.
How do you fit it in the front
'cause usually you don't have

00:15:47.313,00:15:51.818
access to the back? Well you
chop the head off. And so we
made these cute little key

00:15:51.818,00:15:57.957
nuggets that you stick in
backwards. So you get the mirror
image of the keyway and of

00:15:57.957,00:16:01.527
course it works. And you might
say, well that's that's kind of
cheating. You don't have the

00:16:01.527,00:16:05.198
head, you can't remove the key,
you can only use this once. Well
if you're a criminal, do you

00:16:05.198,00:16:08.367
really need to use it twice, do
you really need to remove that
key? So this should be

00:16:08.367,00:16:15.041
considered a security
vulnerability. You don't even
necessarily even need the blank.

00:16:15.041,00:16:19.779
So high security lock
manufacturers tightly control
the blanks because the blanks

00:16:19.779,00:16:24.917
can be used to create any key.
Once it's a cut key, it goes to
the end user and they can lose

00:16:24.917,00:16:29.822
it, sell it, whatever with it,
and uh it's completely
uncontrolled. So if you can get

00:16:29.822,00:16:35.261
a cut key that happens to be the
same keyway, it possibly has
similar security features as the

00:16:35.261,00:16:39.131
key you're trying to duplicate,
you can cut it down, where it's
higher than the key you're

00:16:39.131,00:16:44.036
trying to duplicate, and where
it's lower, you can just add
metal to bring it up. So this

00:16:44.036,00:16:48.808
one you see here, it's uh a
little hard to see, so we have
that closeup in the bottom, but

00:16:48.808,00:16:53.613
that's actually been added some
metal to with some simple
electrical solder. Um fits

00:16:53.613,00:16:58.084
really well, you can get a good
100 uses of that out, out of
that key before it wears down

00:16:58.084,00:17:02.822
too much because solder is very
soft. Um but because it's so
soft, it's real easy to hand

00:17:02.822,00:17:06.726
file out the grooves so that it
fits, so well you can just stick
it in the lock a few times and

00:17:06.726,00:17:12.665
the lock will uh do that
machining for you. Another
interesting key we have here is

00:17:12.665,00:17:18.537
the USPS arrow key. So this is
what your mailman will carry to
get into your mailbox um to

00:17:18.537,00:17:24.310
retrieve mail, etc. Some
enterprising criminals in L.A.
found a good way to copy these,

00:17:24.310,00:17:30.316
which that blank of course,
you're not supposed to be able
to get anywhere. Isn't that

00:17:30.316,00:17:35.755
ingenious? You can see on the
left some of the uh useless
trinkets that they stole from

00:17:35.755,00:17:40.760
the mail, but um but that's
that's an example of instead of
using a keyway um that isn't

00:17:43.062,00:17:46.699
supposed to be for the lock
using a completely different
household object. There's

00:17:46.699,00:17:50.670
something else interesting about
these arrow keys though. And
that's that if you look at it,

00:17:50.670,00:17:55.174
it hasn't been milled out. It's
different than most of the keys
you'll have in your wallet. It's

00:17:55.174,00:17:57.176
been pressed out of a flat piece
of metal.[clears throat] Here's
an example of the dies, [coughs]

00:17:57.176,00:17:59.178
excuse me [drinks water]. Here's
an example of the dies that are
used to press something like

00:17:59.178,00:18:01.113
that. So we made those on the
mill and you can go ahead and
put a flat piece of metal in

00:18:01.113,00:18:06.118
between them and press down on
it and it's gonna bend that flat
piece of metal into a

00:18:13.926,00:18:18.931
functioning blank that can then
be cut and turned into a
functioning arrow key. Of

00:18:22.802,00:18:28.841
course, we didn't cut that
because that would be extremely
illegal. That got us thinking

00:18:28.841,00:18:34.347
though. What about the keys that
are normally milled? Can we use
this technique on those and

00:18:34.347,00:18:40.353
press them um in a likewise
fashion? And the answer is yes.
And you can go a step further.

00:18:40.353,00:18:45.725
'Cause let's think about it,
right? Those milling or those
pressing blocks that we made, we

00:18:45.725,00:18:51.964
can just use the lock for that
because the lock has the keyway
built into it, it is a perfectly

00:18:51.964,00:18:57.970
shaped die that can be used to
press flat metal into that
keyway. So we've taken a lock

00:18:57.970,00:19:02.041
here, in this case it's a
Schlage SC1. And we're cutting
it in half and in this case on a

00:19:02.041,00:19:05.778
mill you can do with a dremel if
you have more time. You get
something like this. So that's

00:19:05.778,00:19:10.349
what a lock looks like on the
inside. Kinda cool eh? Uh but
you can see how we had the top

00:19:10.349,00:19:16.188
and bottom forms that can be
used to press a flat piece of
metal into a functioning blank.

00:19:16.188,00:19:21.661
So we go ahead and do that. Put
a flat piece of metal in between
'em, press down hard, and now we

00:19:21.661,00:19:27.333
have a blank. We can put it on
the profile cutter, copy the
bitting, and we have a

00:19:27.333,00:19:32.338
duplicated key pressed out of
the lock that it's supposed to
open. And of course it works.

00:19:37.476,00:19:42.748
For a really paracentric keyways
like this, really a nasty
keyways, this is a heck of a lot

00:19:42.748,00:19:47.853
easier than milling so it's a
good tool to have in your
toolbox. Now you might ask, can

00:19:47.853,00:19:52.258
you do that with uh something
that's access restricted and the
answer is, of course you can. So

00:19:52.258,00:19:56.662
here's a Medeco lock cut in
half. Two interesting
differences. The yellow arrow up

00:19:56.662,00:20:00.366
there, you can see that
anti-drill pin, different
colored metal. That's to prevent

00:20:00.366,00:20:05.371
you from drilling into the lock
or cutting it in half, but
apparently not. Um and the red

00:20:07.573,00:20:12.678
arrow's there, you see those
rectangular holes, that's what
the sidebar enters in. So for

00:20:12.678,00:20:19.051
those who know how Medeco works,
uh that's where the sidebar goes
and that gives it its high

00:20:19.051,00:20:24.056
security properties. And we use
that to press a functioning
Medeco restricted blank. This is

00:20:26.759,00:20:31.764
particularly concerning. Because
if you lose a key, usually
you're gonna go rekey your lock.

00:20:33.999,00:20:38.504
If you lose a master key, you
have to rekey your whole
facility. And that's created

00:20:38.504,00:20:42.942
some uh major incidents in the
news because sometimes that can
be a very very expensive

00:20:42.942,00:20:48.781
process. Well what happens if
you lose a lock? Most of the
time, you don't care. Most of

00:20:48.781,00:20:53.819
the time you don't even know. So
let's say you have a padlock on
one of your perimeter gates,

00:20:53.819,00:20:58.858
someone snips it off. Most
people don't care. Well what you
can do with that is if that was

00:20:58.858,00:21:03.729
a criminal that took it off,
they can open it up, look at the
pin lengths and create a key

00:21:03.729,00:21:07.767
that fits that lock. Well you
might say, well that's fine
'cause we use a restricted

00:21:07.767,00:21:13.105
keyway, so so they can't make a
key for that lock. Well they can
go ahead and cut it in half. And

00:21:13.105,00:21:18.344
use the lock itself to press a
blank that they can then cut
with the bitting for that key

00:21:18.344,00:21:24.150
and they now have a key to your
facility. In the case of a
master key system, it's a little

00:21:24.150,00:21:28.621
bit more complicated. So you can
see the red arrow pointing there
to the master wavers. That's

00:21:28.621,00:21:32.691
what allows both the master key
to work in the lock as well as
the key that's only supposed to

00:21:32.691,00:21:38.664
be for that single lock. It's a
little bit more complicated from
there to figure out which is the

00:21:38.664,00:21:42.501
master key. But if you have a
little bit of information about
the system you can do it. So

00:21:42.501,00:21:45.738
you've taken the lock apart, you
now where the shear lines are,
that seriously reduces your

00:21:45.738,00:21:50.809
system. In this case, we know
it's a very large Medeco system
so that lowers the difference

00:21:50.809,00:21:55.247
that's allowable between
adjacent cuts. We know that
there's some IC cores in the

00:21:55.247,00:22:00.286
system, let's say we've found a
random key that works on some
other singular lock in that

00:22:00.286,00:22:05.291
system. We can put all that
information together. And uh and
come up with just 2 possible

00:22:07.560,00:22:11.397
keys to try and it's very easy
to try the first one and if it
doesn't work, bring it down to

00:22:11.397,00:22:15.768
the second one. We have a whole
other talk about this coming
soon to a conference near you,

00:22:15.768,00:22:20.773
um but the point is it's
possible. So if you lose a lock
that's on a master system, you

00:22:23.008,00:22:29.248
should consider that as being
that you've lost that master
key. Let's talk about key mark.

00:22:29.248,00:22:34.253
It's sort of a uh compromise
solution by Medeco that has uh a
ostensibly restricted keyways

00:22:37.389,00:22:43.596
but none of the high security
Medeco angle cuts. If you take a
look at this picture here, you

00:22:43.596,00:22:48.601
can see that the pins in KeyMark
in the KeyMark lock only go into
that nice, straight, flat part

00:22:51.203,00:22:57.910
at the top. That nasty keyway at
the bottom never actually
interacts with those pins. So if

00:22:57.910,00:23:01.780
you want to create a KeyMark
blank, of course you can press
it. It's a really good lock for

00:23:01.780,00:23:06.285
doing that, but you don't even
need to. You just need a flat
piece of metal that's a little

00:23:06.285,00:23:09.955
bit shorter than what the blank
is supposed to be. And that will
operate the lock just fine.

00:23:12.391,00:23:17.396
Let's talk about uh Medeco's
mainline products. So we see
here an M3 key and the M3 keyway

00:23:20.266,00:23:24.937
that we've generated on our
computer program to the far
right there. This is the code

00:23:24.937,00:23:29.375
that does it, quote unquote
code, and that's just taking a
rectangular piece of barstock

00:23:29.375,00:23:33.646
and we're milling out those
rectangles in the top and the
various holes, er the various

00:23:33.646,00:23:38.651
grooves along the lock, the
edge. Here's an example of what
different M3 l— um keyways look

00:23:41.120,00:23:46.125
like. So what we've found, this
is purely empirical so I'm uh
open to being uh shown a counter

00:23:48.227,00:23:53.232
example, but what we've found is
that for the vast majority of M3
locks, the wards or the milling

00:23:55.301,00:23:59.538
at the top and the milling at
the very bottom doesn't change.
The milling at the middle stays

00:23:59.538,00:24:03.776
the exact same geometry, it just
moves up and down a little bit.
And that's what lets Medeco

00:24:03.776,00:24:08.781
create so many different M3
locks or M3 keyways. So we just
went ahead and removed metal

00:24:11.884,00:24:16.889
from everywhere that metal could
possibly be removed from. And we
now have a master M3 blank. But

00:24:19.892,00:24:25.030
it gets worse than that, folks.
It gets worse than that because
we have this master M3 blank, we

00:24:25.030,00:24:31.870
went ahead and took our database
of common keyways that exist out
there that you can get for 20

00:24:31.870,00:24:37.676
cents unrestricted. And we
looked through it and we looked
to see which keyways have the

00:24:37.676,00:24:42.681
least metal you have to file off
to make it fit into that master
M3 uh keyway. And this is what

00:24:44.983,00:24:49.988
we found. [audience laughs].
Master lock. [audience claps.]
Most common padlock in the

00:24:59.231,00:25:04.169
country. Most common padlock
keyway in the country fits
unmodified in a Medeco M3 lock.

00:25:11.543,00:25:16.382
Not quite all of them, of the
ones we tested, about
two-thirds, but that's a bit of

00:25:16.382,00:25:22.654
a problem. So we took a master
lock blank. We used an M19,
which is a little bit longer

00:25:22.654,00:25:27.659
than an M1 because of Medeco's
long lock. And we filed away to
uh allow it to operate with the

00:25:29.895,00:25:34.900
M3 slider and we added the
Medeco cuts to it and we created
a functioning Medeco M3 key on a

00:25:38.704,00:25:43.709
master, unrestricted, 19 cents
m19 blank. Let's talk about
facilities that use proprietary

00:25:49.114,00:25:55.387
keyways. Very high security
facilities, they're going to
bulk purchase a keyway that's

00:25:55.387,00:26:00.526
only used on that facility.
Well, what can we do about that?
If we can access a lock, and

00:26:00.526,00:26:04.730
presumably we can if we're a
criminal trying to break in, um
we're gonna go and take a

00:26:04.730,00:26:09.468
photograph of that lock. And
it's very easy image
manipulation to then get that

00:26:09.468,00:26:14.640
into uh a program that you can
analyze. And so in this
particular example, we run

00:26:14.640,00:26:19.278
through that same analytics. And
as case preliminating ourselves
to Medeco blanks that are

00:26:19.278,00:26:24.483
available on the aftermarket
because everything before M3 is
out of patent so you can. And we

00:26:24.483,00:26:30.055
find Medeco 19S, a very small
amount that has to be filed off
to make that work. Or Medeco

00:26:30.055,00:26:35.928
17S, upside down. So when we're
analyzing through all the
different keyways out there,

00:26:35.928,00:26:41.733
turning it upside down
effectively doubles um
possibilities that might work.

00:26:41.733,00:26:46.038
We also have this little nifty
tool. If you have access to the
key physically, you stick it in

00:26:46.038,00:26:52.444
here, push those metal bits in
to form along the grooves of the
key, and now we have what

00:26:52.444,00:26:57.916
emulates the lock itself. So if
we have access to that key for a
brief second on a pen testing

00:26:57.916,00:27:04.857
job, we can push that in, get
that um get that keyway and then
take it back to our shop and see

00:27:04.857,00:27:10.696
which blank actually fits in
there. If you don't have
physical access to the key, you

00:27:10.696,00:27:15.968
can still get the keyway from
photographing it. So if you look
at the keys in your wallet, or

00:27:15.968,00:27:20.706
in your in your pocket, whatever
you have on you, you'll notice
that at the very top of the

00:27:20.706,00:27:26.745
grooves, there's these artifacts
that are left by the milling
process. Those artifacts there

00:27:26.745,00:27:31.083
tell you how deep that milling
is. So the photograph on the
side of the key, it's hard to

00:27:31.083,00:27:35.787
tell depth but that gives it to
you in fact amplified. Um and
that just comes from the fact

00:27:35.787,00:27:41.226
that milling is done with a
circular cutting wheel and do a
little bit of math, Pythagorean

00:27:41.226,00:27:46.899
theorem there, and it tells us
that the amount it goes up
beyond the end of the deepest

00:27:46.899,00:27:51.770
part of the groove is related
using the Pythagorean theorem to
the depth of that groove. So

00:27:51.770,00:27:58.210
what can we do with that? Well
in this uh terrible um security
decision here, we have the

00:27:58.210,00:28:04.316
master keys for a facility I
will leave nameless um hanging
on a wall behind the public

00:28:04.316,00:28:09.454
security guard's desk. It's been
presented in research already
that you can photograph a key

00:28:09.454,00:28:15.894
and get the bitting from it. You
can also photograph a key and
now get the wards for one side.

00:28:15.894,00:28:20.265
So we now know what one side of
the keyway looks like and it's
real simple at that point to do

00:28:20.265,00:28:26.338
some analysis and figure out
what keyway it is because for
the most part, one side's uh is

00:28:26.338,00:28:32.744
fairly unique. So that's all you
can do with keyways and that's
uh forgetting a blank that's

00:28:32.744,00:28:37.482
restricted will not fit in a
lock it's not supposed to. Let's
now talk about all the other

00:28:37.482,00:28:42.788
stuff that uh different lock
manufacturers do to prevent you
from duplicating their

00:28:42.788,00:28:47.793
restricted keys. I'll start by
mentioning that for the most
part, keys are just pieces of

00:28:50.028,00:28:54.900
metal. We're gonna try to hammer
that home. And so you don't need
any of this fancy equipment.

00:28:54.900,00:29:00.038
Just about every duplication
process you could need, you can
do with hand files. And in fact

00:29:00.038,00:29:03.909
our sister was recently in
India. And the first thing she
said when she got back is, hey

00:29:03.909,00:29:08.981
guys, guess how they cut keys
there? And so on the left you
see that gentlemen in blue

00:29:08.981,00:29:12.818
sitting down, and he just has
some hand files and a set of
blanks and the gentleman

00:29:12.818,00:29:19.224
standing behind er in front of
him is getting his key copied
and he gets very very good at

00:29:19.224,00:29:25.197
that and without, whoopsies, and
with that level of skill you can
copy standard keys and just

00:29:25.197,00:29:32.070
about any high security variant.
With that said, let's talk about
Medeco. >> So there's a few

00:29:32.070,00:29:37.442
different variations of um
Medeco that exist. At the top,
you can see Medeco classic. In

00:29:37.442,00:29:44.449
the middle there uh is Medeco
Biaxial, and at the bottom is
Medeco M3. So just for

00:29:44.449,00:29:49.321
background here, uh you can see
that the cuts at the bottom of
those valleys there, some of

00:29:49.321,00:29:53.892
them are straight. Some of them
do have angles to them and
that's one of the big uh

00:29:53.892,00:29:58.664
security features that Medeco
has. And one of the challenges
when you would be trying to copy

00:29:58.664,00:30:04.002
it. So we've already talked
about filing, that's one of
those options. Another one is

00:30:04.002,00:30:09.041
anyone with access to a hacker
space, you'd have access to a
lathe. So here we have the

00:30:09.041,00:30:14.913
Medeco cutting wheel, which you
can buy online relatively cheap,
60 bucks. Um and we have it set

00:30:14.913,00:30:21.753
up in the lathe there, we have a
key set up, and this can be used
to cut those quite easily. And

00:30:21.753,00:30:27.192
another one that you would find
at a uh hacker space is the mill
and that's pretty easy as well

00:30:27.192,00:30:31.596
to do copying with. You
basically clamp the uh blank
down onto the mill and then you

00:30:31.596,00:30:36.601
can rotate the head and just use
a regular end mill to get those
angled valleys for the cuts. So

00:30:39.705,00:30:45.477
another one that's really uh
it's been documented pretty
thoroughly but we'll just

00:30:45.477,00:30:50.415
mention here is casting and this
process is essentially, you take
your blank or your key that you

00:30:50.415,00:30:55.854
wanna copy, you press it into a
material that will take its
form, and then you would pour in

00:30:55.854,00:31:00.759
something that would basically
set in there and it would create
a copy. So kind of a novelty

00:31:00.759,00:31:05.764
here. Um this is a carbon fibre
Medeco Biaxial that we cast. And
one of the important things to

00:31:09.167,00:31:15.474
know with Medeco is even with
the M3, um the blank is 1 solid
piece. What you often see on

00:31:15.474,00:31:19.411
high security keys is called an
interactive element, which is
where you essentially have a

00:31:19.411,00:31:25.150
piece inside of it that moves
independently. And that defeats
the casting attack here, uh

00:31:25.150,00:31:29.421
because you can't cast something
with two separate pieces inside
of it that are moving freely.

00:31:29.421,00:31:34.159
You can only do really one solid
object. And that brings us to
Mul-T-Lock, which is one of

00:31:34.159,00:31:40.098
those where you do need to
consider the interactive
element. >>Alright. Let's talk

00:31:40.098,00:31:46.671
about Mul-T-Locks. We see here
the 3 generations of Mul-T-Lock
key, classic at the top, and

00:31:46.671,00:31:51.309
Mul-T-Lock is what's known as a
dimple key, so the cuts are made
on the side of the key, rather

00:31:51.309,00:31:56.248
than the top, otherwise the
operation is exactly the same.
Setting pins uh to the rights

00:31:56.248,00:32:00.418
height. As well as it has what
is called telescoping pins. So
you have an outer pin and an

00:32:00.418,00:32:02.420
inner pin inside of it. Other
than it is a um standard pin
tumbler lock. Mul-T-Lock

00:32:02.420,00:32:04.422
interactive has that little
black piece um on the second pin
from the left and that actually

00:32:04.422,00:32:09.427
moves within the key. So that's
going to push itself up and um
one of the pins is actually too

00:32:20.372,00:32:26.978
short, so it will push that pin
up and allow it to reach the uh
shear line, and MT5 which is

00:32:26.978,00:32:30.515
their latest generation that
just changes the interactive
element around slightly to

00:32:30.515,00:32:35.520
maintain patent protection. We
went ahead and figured out a way
to duplicate a Mul-T-Lock on a

00:32:38.824,00:32:43.829
standard drill press. So you can
buy these Mul-T-Lock uh cutting
bits online for about 20 bucks

00:32:47.098,00:32:52.337
and most many people have a
drill press, if not a hacker
space surely will. And the first

00:32:52.337,00:32:57.442
thing we do is we take the key
we want to copy and we put it in
our vise and we index on the

00:32:57.442,00:33:02.914
cutting uh cutting head, we
index where exactly that key
should be placed by putting the

00:33:02.914,00:33:07.319
vise at the right position.
Index how deep the drill should
go and you can set that once

00:33:07.319,00:33:13.391
it's at the right depth so it'll
only drill to that right depth.
And we can go ahead and use a

00:33:13.391,00:33:18.396
common drill press to copy a
Mul-T-Lock key. There we go. So
we can see here that cutting

00:33:24.736,00:33:29.841
head. Now that everything's been
indexed, we've replaced it out
and swapped in a blank uh for

00:33:29.841,00:33:34.846
that particular key. And there
it goes. And then when it
reaches the bottom stock, that's

00:33:37.649,00:33:43.922
as far as we know we have to
drill down um 'cause the depth's
what's important here. And you

00:33:43.922,00:33:49.427
can see that nice uh channel
there or that nice there uh hole
there that will work for that

00:33:49.427,00:33:54.432
outer pin. So here's the copy. A
little bit messy but it works.
We can get stupider than that.

00:33:58.336,00:34:03.275
We can copy a key by mitosis. So
Mul-T-Lock, you can insert it
either way. And because of that

00:34:05.877,00:34:10.682
it completely duplicates all
locking ele—or all important
elements on the key so we can

00:34:10.682,00:34:16.488
just cut 'em in half, end up
with 2 functioning Mul-T-Lock
keys that have everything you

00:34:16.488,00:34:21.493
need to make it work. Course it
works, and by the way, um this
one that we cut in half, we cut

00:34:24.496,00:34:29.501
on a drill press using blanks we
bought on eBay. [laughter] Let's
talk about Abloy. >>Abloy's

00:34:32.504,00:34:37.142
probably one of the most
well-known names in terms of
high security locks and it's for

00:34:37.142,00:34:43.114
good reason. So here we're
showing uh 3 of the main, most
common uh generations that they

00:34:43.114,00:34:48.353
have. There's the classic up in
the top, uh the Protec in the
middle here, and the Protec 2 in

00:34:48.353,00:34:52.590
the bottom. And something
important to note is the Protect
2, you can see the arrow

00:34:52.590,00:34:57.462
pointing to that little sort of
circle there and that's the
interactive er the interactive

00:34:57.462,00:35:04.302
element of Protec 2 and it's
essentially a ball bearing
that's captive in that key. So

00:35:04.302,00:35:09.607
how these work um is we've
already covered a lot of pin
tumbler, where you have a lock

00:35:09.607,00:35:13.345
that has pins in it and the key
will raise those to the right
height. Similar to how you would

00:35:13.345,00:35:19.718
have a shear line for that. Um,
instead here we have discs. And
when the key's inserted into the

00:35:19.718,00:35:24.789
lock, it's gonna go inside of
that disc stack, which is in the
red rectangle, and when you

00:35:24.789,00:35:29.694
rotate it, depending on the
notches in the side of the key,
it's gonna rotate those discs

00:35:29.694,00:35:35.567
different amounts and if they
are rotated correctly, then the
key will be able to open. And

00:35:35.567,00:35:40.405
here you can just see similar to
how you would have different
length pins for uh the bitting

00:35:40.405,00:35:45.810
on a pin tumbler lock that would
correspond to depths on a key.
Here you have discs with those

00:35:45.810,00:35:51.850
notches and depending on the
radius and the angle of the cuts
on the uh key, it'll hit it

00:35:51.850,00:35:58.423
after rotating a certain amount
and those little notches on the
outside at the top of each disc,

00:35:58.423,00:36:03.361
uh those all need to be lined up
perfectly for it to open. So
let's talk about the uh keyway

00:36:06.531,00:36:11.536
of Abloy. Here what we're
showing is a view of the uh
keyway on a common Abloy blank.

00:36:13.938,00:36:18.910
And you can see in the red
rectangle there that's
essentially all that you have in

00:36:18.910,00:36:25.750
terms of actual warding that's
gonna be uh restricting this.
Above that, those two points

00:36:25.750,00:36:31.523
below and above are what contact
the discs and so what we can
essentially do here is, looking

00:36:31.523,00:36:35.760
at that, that's pretty thick in
the middle, right? So we can
take off all of the material

00:36:35.760,00:36:40.465
where Abloy has sort of
accounted having that there for
their warding. And what we end

00:36:40.465,00:36:45.937
up with is on the right there,
that's a master blank for Abloy.
It has enough clearance that it

00:36:45.937,00:36:51.509
can fit past any of the warding
that they have and it still has
those 2 uh sides there that you

00:36:51.509,00:36:58.416
would put the cuts on for the
discs. And so for cutting this,
they have real fancy machines in

00:36:58.416,00:37:03.822
the locksmith shop. We don't
have any of those. So again, go
out to your hacker space or

00:37:03.822,00:37:09.260
wherever um and all you need is
just a mill here. And we have
that blank mounted and just a

00:37:09.260,00:37:15.400
cutter there and you can easily
get the cuts working with that.
And so casting we discussed

00:37:15.400,00:37:21.439
before. Uh this would also work
for Protect 1 because it doesn't
have the interactive element.

00:37:21.439,00:37:26.444
However, Protec 2 has that so we
are gonna have to think of
something else. So in the red

00:37:28.780,00:37:35.253
rectangle there, that's
basically one of the only
important new features on Protec

00:37:35.253,00:37:39.657
when it comes to what we're
thinking about, and that's
called the disc controller. And

00:37:39.657,00:37:44.028
so a close up of that here. How
that works is with the
interactive element, there's a

00:37:44.028,00:37:49.000
ball bearing with a spring that
you can see on the right side
and when the key's inserted all

00:37:49.000,00:37:53.104
the way, that ball bearing can
be pressed into the key, it
pushes that captive bearing

00:37:53.104,00:37:58.009
over, which in turn pushes the
blue pin you can see there, And
that pin needs to be pushed

00:37:58.009,00:38:03.848
outwards all the way for the
lock to actually be able to
rotate. So how do we defeat

00:38:03.848,00:38:10.455
that? Well, here we have a
Protec 2 key up top, a Protec 1
key down below. Both of them we

00:38:10.455,00:38:16.161
have cut to the same bitting.
And you can see it's kind of
little bit disfigured there. The

00:38:16.161,00:38:20.532
Protec 1 there at the bottom.
And that's because we've milled
out a recess that allows us to

00:38:20.532,00:38:26.237
put in a pick, a piece of wire,
really anything, and it's not
hard to get that interactive

00:38:26.237,00:38:31.609
element to set. And again with
the master blank there, there's
more than enough clearance to

00:38:31.609,00:38:38.416
insert that pick or piece of
wire to interact with that. And
here's just a little piece of uh

00:38:38.416,00:38:42.620
metal that's we've made as a
tool that makes it incredibly
easy to get that interactive

00:38:42.620,00:38:47.625
piece set. And so now we're
gonna show you a video. This is
a Protec 2 lock that you see.

00:38:49.861,00:38:56.034
And it's a Protec 1 key and
normally there's no chance
that's gonna work. Here we show

00:38:56.034,00:39:01.306
just how incredibly quick it is
using that pick to get that to
actually work. >> Let's play

00:39:01.306,00:39:06.311
that again. That was uh uh,
never mind. My mouse is hidden.
Let's play that again. That was

00:39:09.347,00:39:15.853
a real quick video. >>You can
see we're inserting that pick in
there and that's how easy it is.

00:39:15.853,00:39:20.391
It's low tolerance, there's
really nothing challenging about
setting that interactive

00:39:20.391,00:39:25.396
element. So let's talk about the
symmetry of Abloy. Similar to
Mul-T-Lock, um Abloy if you look

00:39:29.100,00:39:33.404
at it down the middle, you'll
realize it's entirely
symmetrical. And in this case,

00:39:33.404,00:39:38.943
it's not so that you can have it
uh similar to Mul-T-Lock. But
it's because it needs to

00:39:38.943,00:39:45.850
interact with the disc on both
sides. Or so you'd think. Turns
out you can cut it half, just

00:39:45.850,00:39:49.888
like the Mul-T-Lock that we
showed, and you now have 2
working keys for Abloy. Now

00:39:52.557,00:39:58.196
Abloy arguably I would say, if I
had to trust something to one
lock, Abloy's the company I

00:39:58.196,00:40:03.268
would go with. So let's talk
briefly about the 2-man rule.
I'm sure a lot of you know what

00:40:03.268,00:40:08.139
this is. But it's essentially
for very, very high security
applications, we're talking

00:40:08.139,00:40:14.445
nuclear missiles, uh similar
things to that. You have to have
2 people to turn 2 separate

00:40:14.445,00:40:19.450
keys, and that would initiate a
launch. Now let's say you have
an Abloy securing uh your 2

00:40:21.452,00:40:26.457
locks with a 2-man rule, and you
only need 1 of those keys and 2
random people and they could set

00:40:29.227,00:40:34.232
that off. So this is a pretty
significant exploit. So one
thing we haven't covered yet, uh

00:40:38.670,00:40:44.142
tip warding is similar to the
warding on the blank of a
regular key. Abloy also has

00:40:44.142,00:40:48.946
warding on the tip of their key
where when you insert it, it can
go almost all the way in but if

00:40:48.946,00:40:53.618
that warding isn't correct, it
won't be able to go fully in,
and the bitting won't line up

00:40:53.618,00:40:58.923
with the discs, and the
interactive element won't line
up so it won't work. So you

00:40:58.923,00:41:03.895
know, this one's pretty simple
um but some of them can be
complex looking. So you'd wonder

00:41:03.895,00:41:10.435
how do we uh how do we uh how do
we throw it. Oh. Okay so we have
a bit of a snowstorm here.

00:41:10.435,00:41:16.274
Alright so let's use this one
then. So um what you can see
here basically is this disc is

00:41:16.274,00:41:21.012
the tip warding disc, it's at
the end of the lock and when the
key goes in, you can see on the

00:41:21.012,00:41:27.285
top left of that there's little
bit of an indent going into the
key. And that's the tip warding.

00:41:27.285,00:41:33.124
And both of these keys here were
handmade by us. The left one
we've followed fairly closely

00:41:33.124,00:41:37.528
what the tip warding would be
and you can see how it fits in
nicely but you don't need to.

00:41:37.528,00:41:41.733
That one on the right there is
the master blank we've created.
And it turns out it doesn't

00:41:41.733,00:41:48.673
matter if you file off a lot
more than normal. It still's
gonna work in that lock. And

00:41:48.673,00:41:54.178
this is one of the keys that we
created. And so then we'll
briefly talk about uh these uh

00:41:54.178,00:41:59.183
side bitted keys. So this is
Primus and Assa and you can see
those ridges along the side and

00:42:01.519,00:42:07.325
those are their high security
feature. In terms of copying
those, we have a machine, 100

00:42:07.325,00:42:12.497
bucks online on eBay, and it
essentially has a probe that's
on the right there that goes

00:42:12.497,00:42:16.401
into any key that you already
have and that could be any other
key for the facility or even

00:42:16.401,00:42:20.671
from the same locksmith that set
up that facility. The side
bitting is usually exactly the

00:42:20.671,00:42:26.944
same, regardless of the key. And
then it's just copied onto this
regular SC1 blank on the left,

00:42:26.944,00:42:33.217
and what you end up with is a
blank for Primus. And that can
be applied to Assa as well. And

00:42:33.217,00:42:38.055
then also we have, how do you
get it properly copied, right?
We're telling you all these ways

00:42:38.055,00:42:42.627
to do it unauthorized. Um the
way that you're supposed to do
it is you have this card that

00:42:42.627,00:42:46.531
you bring into an authorized
locksmith, you show it to them,
they'll look up that code, and

00:42:46.531,00:42:52.069
they'll cut it for you. Well,
this card you see here doesn't
actually exist. We created

00:42:52.069,00:42:56.541
software where you can input at
the top what you want your
bitting to be and it'll generate

00:42:56.541,00:43:01.779
an image with the code that
corresponds to that. And a lot
of online locksmiths will accept

00:43:01.779,00:43:06.784
these and all you really need is
just 1 to and this essentially a
cut key. And here we have

00:43:13.724,00:43:19.096
[applause]. So here we have just
the Abloy one, again that's even
simpler paper and there's just

00:43:19.096,00:43:25.603
the codes there. Um patent,
that's basically what prevents
regular locksmiths from normally

00:43:25.603,00:43:30.608
copying it uh because legally
they can't. >>Alrighty. So have
about 2 minutes left to talk

00:43:33.377,00:43:39.016
about what the blue team can do
to remediate against all of
this. Uh, first off is mastered

00:43:39.016,00:43:43.588
or sectional keyways, they're
great as an additional security
uh feature, not as the only one.

00:43:43.588,00:43:48.359
Restricted keyways, exactly the
same thing. Great as additional
not as the only security

00:43:48.359,00:43:54.065
feature. If you've lost a lock,
you have lost the grand master
key. Many people say well,

00:43:54.065,00:43:59.070
physical keys are dead hurr durr
because of all, of all of these
exploits. We don't really agree

00:44:02.073,00:44:06.777
with that. You need to
understand your threat model.
Number 1, most criminals aren't

00:44:06.777,00:44:12.483
going to be picking that lock,
making duplicated keys, etc.
Locks are generally accepted in

00:44:12.483,00:44:16.787
the security community. They
keep honest people honest. Um
and so if you're using them for

00:44:16.787,00:44:23.628
that purpose, it's just fine.
The other thing you need to keep
in mind is, your security, in

00:44:23.628,00:44:29.600
order to be truly robust, should
be uh airtight even if someone
has the master key to your

00:44:29.600,00:44:33.638
facility. So here we have the
basement of the Toronto City
Hall. We hail from Toronto, go

00:44:33.638,00:44:38.643
Raptors. And um let's say
someone wants to steal the key
to the city. Well, they're going

00:44:42.179,00:44:47.218
to go in. They've got to bypass
2 doors. This is the uh the um
the path we're most concerned

00:44:47.218,00:44:52.657
about. After bypassing the first
door, 5 seconds with the key,
sets off a motion sensor. Now

00:44:52.657,00:44:56.894
sets the guard in motion. So
he's got to follow through what
he has to do to get there.

00:44:56.894,00:45:03.634
First, he has to finish his
donut. And then travel to
intercept, meanwhile the

00:45:03.634,00:45:09.040
intruder is taking some time to
break through er to key through
the second door, travel a 120

00:45:09.040,00:45:13.844
feet, crack the safe, etc. If he
can get through to that safe
before your guard gets there, um

00:45:13.844,00:45:19.884
you you have failed security
wise and your system is not
robust. If you can add enough

00:45:19.884,00:45:26.157
delays and sense intruders early
enough, you can make your system
robust even if a master key is

00:45:26.157,00:45:30.294
lost. And that's what you should
really be aiming for. Because
locks only keep honest people

00:45:30.294,00:45:36.667
honest. The last remediation is
of course forensics. Um so all
of these techniques leave marks

00:45:36.667,00:45:42.106
on the pins, they leave slight
chemical residue they can be
tested for. If you suspect that

00:45:42.106,00:45:46.110
something has happened to you
facility there are tests that
can be done to tell what it was.

00:45:46.110,00:45:51.115
So in short, we have defeated a
number of uh fairly well-known,
big um key types out there. And

00:45:57.288,00:46:03.327
um and we we just want everyone
to be aware of uh the sort of
exploits that are out there.

00:46:03.327,00:46:07.865
Thank you very much. We welcome
questions in Lock Bypass
Village, which we are running

00:46:07.865,00:46:12.870
right after this right now.
Thank you very much, folks.
[applause]

